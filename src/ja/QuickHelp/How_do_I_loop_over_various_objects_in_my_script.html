<h1 class="firstheading">FAQ-369 さまざまなオブジェクトをループするスクリプトを作成するには?</h1><p class='urlname' style='display: none'>Loop-Over-Objects-Doc</p>
<p class='faqID'>最終更新日:2015/02/04</p>
<p><a class="external text" href="../../LabTalk/LabTalk/Document_(command).html">document</a>コマンドを使ってオブジェクトをループできます。&ndash;e スイッチを使うとループしたい<i>オブジェクト </i>を指定することができます。-ef スイッチはループを現在のフォルダ内で限定します。
</p><p>この例では、すべてのワークブック、すべてのワークシート（レイヤ）をループして、特定のロングネームを持つ列の特定の行を取得します。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 全てのブックをループします</span>
doc <span style="color: #000080;">-</span>e W <span style="color: #000000;">{</span>
   <span style="color: #008000;">// ブック名を文字列変数として入力します - 単に%hを使う事もできます</span>
   book<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">%</span>h;
   type <span style="color: #ff00ff;">&quot;Book is:%(book$)&quot;</span>;
   <span style="color: #008000;">// 全てのシートをループします</span>
   doc <span style="color: #000080;">-</span>e LW <span style="color: #000000;">{</span>
      <span style="color: #008000;">// シート名を変数に入力します</span>
      sheet<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> layer.<span style="color: #000080;">name</span><span style="color: #000080;">$</span>;
      type <span style="color: #ff00ff;">&quot;Sheet is:%(sheet$)&quot;</span>;
      <span style="color: #008000;">// ロングネームを持つ列の利用範囲を（再）定義します</span>
      <span style="color: #008000;">// &quot;system pressure&quot;</span>
      range r <span style="color: #000080;">=</span> <span style="color: #000000;">[</span><span style="color: #000080;">%</span><span style="color: #000000;">(</span>book<span style="color: #000080;">$</span><span style="color: #000000;">)</span><span style="color: #000000;">]</span><span style="color: #000080;">%</span><span style="color: #000000;">(</span>sheet<span style="color: #000080;">$</span><span style="color: #000000;">)</span><span style="color: #000080;">!</span>col<span style="color: #000000;">(</span>system pressure<span style="color: #000000;">)</span>;
      <span style="color: #008000;">// 現在のブック内の現在のシートで列&quot;system pressure&quot; </span>
      <span style="color: #008000;">// から5行目を入手します</span>
      double d <span style="color: #000080;">=</span> r<span style="color: #000000;">[</span><span style="color: #0000dd;">5</span><span style="color: #000000;">]</span>;
      <span style="color: #008000;">// 欠損値か否かを確認します</span>
      if<span style="color: #000000;">(</span> d <span style="color: #000080;">!</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #000080;">/</span><span style="color: #0000dd;">0</span> <span style="color: #000000;">)</span>
         type <span style="color: #ff00ff;">&quot;system pressure row 5 = $(d)&quot;</span>;
   <span style="color: #000000;">}</span>
<span style="color: #000000;">}</span></pre>

<hr class='keywordshr'><p><span class='keywords'>キーワード:</span> <span class='keywordsInput'>ページ, レイヤ, 列, 行, フォルダ, ワークシート, ワークブック, 行列</span></p>





    