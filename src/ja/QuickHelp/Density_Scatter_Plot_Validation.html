<h1 class="firstheading">FAQ-1032 密度散布図の検証</h1>
<p class='urlname' style='display: none'>density-dots-validation</p>
<p class='faqID'>最終更新日：2019/12/16</p>
<p><br /></p>
<p>密度ドットプロットは、データ密度を示す散布図で、ポイントはデータ密度でカラーマップされます。密度はカーネル密度推定を使用して計算されます。</p>
<p>カーネル密度推定を計算するために、Originは2Dビン近似と2D補間を利用する高速アルゴリズムを使用します。最初の2Dビン化が（x、y）ポイントで実行され、ビンカウントの行列を取得します。次に、2D高速フーリエ変換を使用して、各グリッドの密度値を計算するための離散畳み込みを実行します。密度値の4乗根は、密度スケールをカラースケールにマッピングするために計算されます。</p>
<p>Originは同じデータセットからRと同様の結果を生成できます。</p>
<h3><a name="Comparison_of_R_and_Origin_Results" id="Comparison_of_R_and_Origin_Results"></a><span class="mw-headline">RとOriginの結果の比較</span></h3>
<dl>
<dd><a class="image"><img alt="Density Plot Origin R Comparison.png" src="../images/Density_Scatter_Plot_Validation/800px-Density_Plot_Origin_R_Comparison.png" width="800" /></a></dd>
</dl>
<h3><a name="Reference" id="Reference"></a><span class="mw-headline">リファレンス</span></h3>
<p><b>データ</b>:<br />
1つの応答変数(y), 1つの予測変数(x)<br />
観測数100000<br />
生成されたデータ<br />
<a class="external text" href="http://blog.originlab.com/ftp/graph_gallery/DP.csv" target="_blank"><b>データファイル： DP.csv</b></a></p>
<p><b>Originプロジェクトファイル</b>: <a class="external text" href="http://blog.originlab.com/ftp/graph_gallery/density_dots_validation_sample.opju" target="_blank">density_dots_validation_sample.opju</a></p>
<p><b>このグラフを作成するRコード</b></p>
<pre class="lt" style="font-family:monospace;">
xx<span style="color: #000080;">=</span> read.<span style="color: #000080;">csv</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"DP.csv"</span>,header<span style="color: #000080;">=</span>FALSE<span style="color: #000000;">)</span>
as.<span style="color: #000080;">list</span><span style="color: #000000;">(</span>body<span style="color: #000000;">(</span>smoothScatter<span style="color: #000000;">)</span><span style="color: #000000;">)</span>
trace<span style="color: #000000;">(</span><span style="color: #ff00ff;">"smoothScatter"</span>,quote<span style="color: #000000;">(</span>browser<span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>,at<span style="color: #000080;">=</span><span style="color: #0000dd;">19</span><span style="color: #000000;">)</span>
w<span style="color: #000080;">&lt;</span><span style="color: #000080;">-</span>c<span style="color: #000000;">(</span><span style="color: #0000dd;">0.056990976577602</span>, <span style="color: #0000dd;">0.13442535086237</span><span style="color: #000000;">)</span>
smoothScatter<span style="color: #000000;">(</span>xx, nrpoints <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>,nbin<span style="color: #000080;">=</span><span style="color: #0000dd;">151</span>,bandwidth<span style="color: #000080;">=</span>w<span style="color: #000000;">)</span>
#Debug and run following script
#Type <span style="color: #ff00ff;">"n"</span> to enter line <span style="color: #0000dd;">19</span>
stopifnot<span style="color: #000000;">(</span><span style="color: #000000;">(</span>nx <span style="color: #000080;">&lt;</span><span style="color: #000080;">-</span> length<span style="color: #000000;">(</span>xm<span style="color: #000000;">)</span><span style="color: #000000;">)</span> <span style="color: #000080;">==</span> nrow<span style="color: #000000;">(</span>dens<span style="color: #000000;">)</span>,
                  <span style="color: #000000;">(</span>ny <span style="color: #000080;">&lt;</span><span style="color: #000080;">-</span> length<span style="color: #000000;">(</span>ym<span style="color: #000000;">)</span><span style="color: #000000;">)</span> <span style="color: #000080;">==</span> ncol<span style="color: #000000;">(</span>dens<span style="color: #000000;">)</span><span style="color: #000000;">)</span>
ixm <span style="color: #000080;">&lt;</span><span style="color: #000080;">-</span> 1L <span style="color: #000080;">+</span> as.<span style="color: #000080;">integer</span><span style="color: #000000;">(</span><span style="color: #000000;">(</span>nx<span style="color: #000080;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span><span style="color: #000080;">*</span><span style="color: #000000;">(</span>x<span style="color: #000000;">[</span>,<span style="color: #0000dd;">1</span><span style="color: #000000;">]</span><span style="color: #000080;">-</span>xm<span style="color: #000000;">[</span><span style="color: #0000dd;">1</span><span style="color: #000000;">]</span><span style="color: #000000;">)</span><span style="color: #000080;">/</span><span style="color: #000000;">(</span>xm<span style="color: #000000;">[</span>nx<span style="color: #000000;">]</span><span style="color: #000080;">-</span>xm<span style="color: #000000;">[</span><span style="color: #0000dd;">1</span><span style="color: #000000;">]</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>
iym <span style="color: #000080;">&lt;</span><span style="color: #000080;">-</span> 1L <span style="color: #000080;">+</span> as.<span style="color: #000080;">integer</span><span style="color: #000000;">(</span><span style="color: #000000;">(</span>ny<span style="color: #000080;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span><span style="color: #000080;">*</span><span style="color: #000000;">(</span>x<span style="color: #000000;">[</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">]</span><span style="color: #000080;">-</span>ym<span style="color: #000000;">[</span><span style="color: #0000dd;">1</span><span style="color: #000000;">]</span><span style="color: #000000;">)</span><span style="color: #000080;">/</span><span style="color: #000000;">(</span>ym<span style="color: #000000;">[</span>ny<span style="color: #000000;">]</span><span style="color: #000080;">-</span>ym<span style="color: #000000;">[</span><span style="color: #0000dd;">1</span><span style="color: #000000;">]</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>
z<span style="color: #000080;">&lt;</span><span style="color: #000080;">-</span>dens<span style="color: #000000;">[</span>cbind<span style="color: #000000;">(</span>ixm, iym<span style="color: #000000;">)</span><span style="color: #000000;">]</span>
df<span style="color: #000080;">&lt;</span><span style="color: #000080;">-</span>data.<span style="color: #000080;">frame</span><span style="color: #000000;">(</span>x<span style="color: #000080;">=</span>x<span style="color: #000000;">[</span>,<span style="color: #0000dd;">1</span><span style="color: #000000;">]</span>,y<span style="color: #000080;">=</span>x<span style="color: #000000;">[</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">]</span>,z<span style="color: #000080;">=</span>z<span style="color: #000000;">)</span>
library<span style="color: #000000;">(</span>ggplot2<span style="color: #000000;">)</span>
sp<span style="color: #000080;">&lt;</span><span style="color: #000080;">-</span>ggplot<span style="color: #000000;">(</span>df, aes<span style="color: #000000;">(</span>x,y,colour<span style="color: #000080;">=</span>z<span style="color: #000000;">)</span><span style="color: #000000;">)</span> <span style="color: #000080;">+</span>  geom_point<span style="color: #000000;">(</span>shape<span style="color: #000080;">=</span><span style="color: #ff00ff;">"."</span><span style="color: #000000;">)</span><span style="color: #000080;">+</span> 
        theme<span style="color: #000000;">(</span>panel.<span style="color: #000080;">background</span> <span style="color: #000080;">=</span> element_rect<span style="color: #000000;">(</span>fill <span style="color: #000080;">=</span> <span style="color: #ff00ff;">'black'</span><span style="color: #000000;">)</span>,
        panel.<span style="color: #000080;">grid</span>.<span style="color: #000080;">major</span> <span style="color: #000080;">=</span> element_blank<span style="color: #000000;">(</span><span style="color: #000000;">)</span>,
        panel.<span style="color: #000080;">grid</span>.<span style="color: #000080;">minor</span> <span style="color: #000080;">=</span> element_blank<span style="color: #000000;">(</span><span style="color: #000000;">)</span>,
        panel.<span style="color: #000080;">border</span> <span style="color: #000080;">=</span> element_blank<span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>
sp
cval<span style="color: #000080;">&lt;</span><span style="color: #000080;">-</span>seq<span style="color: #000000;">(</span><span style="color: #0000dd;">0</span>,<span style="color: #0000dd;">1</span>,length.<span style="color: #000080;">out</span><span style="color: #000080;">=</span><span style="color: #0000dd;">6</span><span style="color: #000000;">)</span>
sp<span style="color: #000080;">+</span>scale_color_gradientn<span style="color: #000000;">(</span>values <span style="color: #000080;">=</span> cval,colours <span style="color: #000080;">=</span> rainbow<span style="color: #000000;">(</span><span style="color: #0000dd;">20</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>
</pre>
<hr class='keywordshr' />
<p><span class='keywords'>キーワード:</span><span class='keywordsInput'>検証, Rとの比較</span></p>
