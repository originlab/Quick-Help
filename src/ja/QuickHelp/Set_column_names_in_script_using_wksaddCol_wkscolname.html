<h1 class="firstheading">FAQ-872 なぜスクリプト内にwks.addCol や wks.col.nameなどを使用した列名を設定できないのですか？</h1>
<p class='urlname' style='display: none'>Set-column-names-in-script</p>
<p class='faqID'>最終更新：2018/09/25</p>
<p>Origin 2017から新たに、MS Excelと同様のスプレッドシートセル表記がサポートされました。このセル表記が有効になっている場合（ワークブックページの左上にアイコン<a class="image"><img alt="Spreadsheet cell notation mode.png" src="../images/Set_column_names_in_script_using_wks.addCol_wks.col.name/Spreadsheet_cell_notation_mode.png" width="20" /></a>があるとき）、<a class="external text" href="../../UserGuide/UserGuide/Column_Short_Name_Restriction.html">列ショートネームは<i><b>編集できず、順序変更もできません。</b></i></a></p>
<p><b>Origin 2017</b>、<b>Origin 2018</b>、および<b>Origin 2018b</b>では、<code>win -t</code>やX-Function <code>newbook</code>のようなLabTalkコマンドで作成されたワークブックは、デフォルトでこの列の命名制限が無効になっています。しかし、<b>Origin 2019</b>以降、これらのワークブックはデフォルトで列の命名制限が<b>有効</b>になります。これは、LabTalkスクリプタが注意しなければならない動作上の変更です。</p>
<p>この制限を無効にして、<code>win -t</code>コマンドまたは<code>newbook</code> X-Functionによって作成されたブックの列ショートネームを変更できるようにするには、次の行コードを実行する必要があります（新しいブックがアクティブであると仮定します）。</p>
<pre class="lt" style="font-family:monospace;">
page.<span style="color: #000080;">XLColName</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>; <span style="color: #008000;">// 列ショートネームの制限解除</span>
</pre>
<p>2017より前のOriginバージョンで同じコードを使用する必要がある場合は、名前を変更するコードの前に以下のように挿入します。</p>
<pre class="lt" style="font-family:monospace;">
if<span style="color: #000000;">(</span>@v<span style="color: #000080;">&gt;=</span><span style="color: #0000dd;">9.4</span><span style="color: #000000;">)</span> page.<span style="color: #000080;">xlcolname</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;
</pre>
<table class="noborder">
<tr>
<td style="vertical-align:top" width="60"><img src="../images/Set_column_names_in_script_using_wks.addCol_wks.col.name/Tip_icon.png" width="57" border="0" alt="" /></td>
<td>
<p><b>Origin 2019以降を使用していて、それぞれのスクリプトを変更せずに、<code>win -t</code> または<code>newbook</code> を呼び出すすべての呼び出しで列の名前付け制限がオフになっていることを確認したい場合は、システム変数ダイアログで<code>@RCN=7</code>というシステム変数を設定できます。</b></p>
</td>
</tr>
</table>
<p><br />
<br />
<i><b>関連FAQ:</b></i></p>
<ul>
<li><a href="../../QuickHelp/QuickHelp/Why_column_formula_not_update.html" title="列の式がアップデートされないのはなぜですか？">FAQ-847: 列を挿入したり削除したりすると、列の式がアップデートされません。解決方法はありますか？</a></li>
<li><a href="../../QuickHelp/QuickHelp/Turn_off_spreadsheet_cell_notation.html" title="スプレッドシートセル表記を全体で無効にする">FAQ-849: ワークブックでスプレッドシートセル表記を無効にしたり、選択して利用するにはどのようにしたらよいでしょうか？</a></li>
</ul>
<hr class='keywordshr' />
<p><span class='keywords'>キーワード:</span><span class='keywordsInput'>ショートネーム制限, スプレッドシートセル表記, 並べ替え</span></p>
