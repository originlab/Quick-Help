<h1 class="firstheading">FAQ-808 ユーザ定義のピークフィットを行うと、遅くなるのはなぜでしょうか？どのようにしたらスピードアップできるでしょうか？</h1><p class='urlname' style='display: none'>Speedup-UserDefined-PeakFit</p>
<p class='faqID'>最終更新: 2018/07/29</p>
<p><b>ピークアナライザ</b>ダイアログの「ピークフィット」のページにある<b>結果: レポート構成の設定: ピーク属性</b>の<b>ピークの重心</b>の設定が主な原因で、このように遅くなります。このオプションは、デフォルトで選択されています。組込ピークフィット関数では、解析して<b>ピークの重心</b>が計算されます。ところが、ユーザ定義関数ではこの解析解がないため、<b>ピークの重心</b>を数値計算するためフィット処理が遅くなります。
</p><p>また、ピークフィットページにある<b>結果: レポート構成の設定: ピーク属性</b>の<b>ピーク面積</b>にも遅くなる原因があります。Originでは、解析領域の計算に、ゼロモーメントを使っているため、時間がかかってしまいます。
</p><p>このフィット処理のスピードを上げるには、<b>ピークアナライザ</b>にある<b>ピークの重心</b>と<b>ピーク面積</b>のチェックを外します。このようにすると、とても速くなります。<b>ピークの重心</b>と<b>ピーク面積</b>の解析解が分かっている場合、FDFファイルにセクションを手動で加えることができます。例えば、以下のフィット関数を試してみてください。
<img src="../images/How_to_speed_up_peak_fit_with_user_defined_function/math-2ff2101feb19c319629768bbefb6dab5.png" title="y = y0+ f \frac{A}{\frac{2w}{1+e^{s(x-x_c)}}}*\sqrt{4\frac{Ln2}{\pi}}*e^{-4Ln({\frac{x-x_c}{\frac{2w}{1+e^{s(x-x_c)}}})^2}}+
(1-f)\frac{\frac{2A}{\pi*(\frac{2w}{1+e^{s(x-x_c)}})}}
{1+4(\frac{x-x_c}{\frac{2w}{1+e^{s(x-x_c)}}})^2}" alt="y = y0+ f \frac{A}{\frac{2w}{1+e^{s(x-x_c)}}}*\sqrt{4\frac{Ln2}{\pi}}*e^{-4Ln({\frac{x-x_c}{\frac{2w}{1+e^{s(x-x_c)}}})^2}}+
(1-f)\frac{\frac{2A}{\pi*(\frac{2w}{1+e^{s(x-x_c)}})}}
{1+4(\frac{x-x_c}{\frac{2w}{1+e^{s(x-x_c)}}})^2}" class="tex"/>
</p><p><b>ピークの重心</b>と<b>ピーク面積</b>は、それぞれ、<i>x_c</i>と<i>A</i> になります。FDFの最後に、以下のセクションを追加できます。 
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">[</span>Moments<span style="color: #000000;">]</span> 
mz0 <span style="color: #000080;">=</span> A 
mz1 <span style="color: #000080;">=</span> xc
mc2 <span style="color: #000080;">=</span> N.<span style="color: #000080;">A</span>.
<span style="color: #000080;">mc3</span> <span style="color: #000080;">=</span> N.<span style="color: #000080;">A</span>.
<span style="color: #000080;">mc4</span> <span style="color: #000080;">=</span> N.<span style="color: #000080;">A</span>.</pre>
<p><br />
</p>
<table class="note">
<tr>
<td><b>Notes:</b>ピークのプロパティ内で、<b>ピークのゆがみ</b>、 <b>ピーク過剰</b>, <b>3次モーメント</b>、 <b>4次モーメント</b>でも処理が遅くなる恐れがあります。ユーザ定義の機能をお使いの際は、ご注意ください。
</td></tr></table>
<hr class='keywordshr'><p><span class='keywords'>キーワード:</span><span class='keywordsInput'>ユーザ定義関数、遅い、ピークアナライザ、スピードアップ</span></p>




    