<h1 class="firstheading">FAQ-810 Origin Cにウォーターフォールグラフをインポートするには？</h1>

  <p class='urlname' style='display: none'>waterfall-by-OC</p>

  <p class='faqID'>最終更新：2016/01/04</p>

  <p>以下のサンプルコードを参照してください。</p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #008000;">//以下の関数で、ウォーターフォールグラフを作成します</span>
<span style="color: #008000;">//「bYColMap = TRUE」の場合、Yにウォーターフォールカラーマップを作成します</span>
<span style="color: #008000;">//「bYColMap = FALSE」の場合、Zにウォーターフォールカラーマップを作成します</span>

<span style="color: #0000ff;">void</span> plot_waterfall<span style="color: #000000;">(</span><span style="color: #0000ff;">BOOL</span> bYColMap <span style="color: #000080;">=</span> <span style="color: #0000ff;">TRUE</span>, <span style="color: #0000ff;">int</span> nEndYCol <span style="color: #000080;">=</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
        Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #000040;">!</span>wks <span style="color: #000000;">)</span>
                <span style="color: #0000ff;">return</span>;    
        
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> nEndYCol <span style="color: #000080;">&lt;</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">)</span> <span style="color: #008000;">// 「-1」は列の末尾の意味です</span>
                nEndYCol <span style="color: #000080;">=</span> wks.<span style="color: #000000;">GetNumCols</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000040;">-</span> <span style="color: #0000dd;">1</span>;  
        
        <span style="color: #008000;">// グラフウィンドウを作成します</span>
        GraphPage gp;
        gp.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Waterfal&quot;</span><span style="color: #000000;">)</span>;
        GraphLayer gl <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// 最初のレイヤを作成します   </span>
        
        <span style="color: #008000;">// データ範囲を用意します</span>
        DataRange dr;
        dr.<span style="color: #000000;">Add</span><span style="color: #000000;">(</span>wks, <span style="color: #0000dd;">0</span>, <span style="color: #ff00ff;">&quot;X&quot;</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// col(1): x列      </span>
        <span style="color: #0000ff;">for</span><span style="color: #000000;">(</span><span style="color: #0000ff;">int</span> nYCol <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; nYCol <span style="color: #000080;">&lt;=</span> nEndYCol; nYCol<span style="color: #000040;">++</span><span style="color: #000000;">)</span>               
                dr.<span style="color: #000000;">Add</span><span style="color: #000000;">(</span>wks, nYCol, <span style="color: #ff00ff;">&quot;Y&quot;</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// データ範囲drにy列を追加します         </span>
        
        <span style="color: #008000;">// プロットします</span>
        gl.<span style="color: #000000;">AddPlot</span><span style="color: #000000;">(</span>dr, IDM_PLOT_LINE<span style="color: #000000;">)</span>;   
        
        <span style="color: #008000;">// カラーマップをセットします  </span>
        GroupPlot group;
        group <span style="color: #000080;">=</span> gl.<span style="color: #000000;">Groups</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> group <span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
                Tree tr;                
                tr.<span style="color: #000000;">Line</span>.<span style="color: #000000;">Color</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> bYColMap ? 0x60FFFF <span style="color: #000000;">:</span> 0x500000 <span style="color: #000040;">|</span> <span style="color: #000000;">(</span> ModifyColBeg <span style="color: #000040;">+</span> <span style="color: #0000dd;">1</span> <span style="color: #000000;">)</span>;
        
                <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> group.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">(</span>tr<span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
                        group.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">(</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>;
        <span style="color: #000000;">}</span>
        
        gl.<span style="color: #000000;">Rescale</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span>
</pre>

  <p> </p>
  <hr class='keywordshr'>

  <p><span class='keywords'>キーワード:</span><span class='keywordsInput'>ウォータフォール、Origin C</span></p>
