<h1 class="firstheading">FAQ-375 自分で作成したスクリプトを実行するツールバーボタンを作成するには、どうしたらよいでしょうか?</h1><p class='urlname' style='display: none'>Button-to-Run-LT-Script</p>
<p class='faqID'>最終更新日:2015/02/04</p>
<p>ツールバーにボタンがあるとLabTalkスクリプトを実行するのに便利です。自分のボタンを作成するには3つのファイルが必要になります。1つ目のファイルは、ユーザがボタンをクリックしたときに実行されるスクリプトを含むLabTalkスクリプトファイルです。2つ目のファイルは、ボタンを表示するための画像を含むビットマップファイルです。3つ目のファイルは、自動的に作成されるINIファイルです。
</p><p>INIファイルはボタングループの名前、グループを作るのに使用されているビットマップファイルとボタンの数を保存しています。
</p><p>OPXファイルにエクスポートするカスタムボタングループを作成する時には、ユーザファイルフォルダの中にサブフォルダを作成し、そこにボタングループの設定ファイル、ビットマップファイル、スクリプトファイル、他のサポートファイルを保存することをお勧めします。他のOriginユーザが、そのOPXファイルをインストールする時に、ユーザファイルフォルダ内に、同じサブフォルダが自動的に作成されます。そして、このサブフォルダ内に、カスタムボタングループに関するファイルがコピーされます。この方法でOriginサブフォルダを使用すれば、自分で作成したファイルとOriginのファイルを分けておくことができます。 
</p><p>次のステップを実行して、すべてのファイルを一緒にします。
</p>
<ol><li> <B>コードビルダ</B>を使って自分のLabTalkスクリプトOGSファイルを開発します。これには、セクションで分けられたいくつかのスクリプトがあり、それぞれのセクションは1つのボタンと結びついています。
</li><li> Windowsのペイントのようなビットマップ作成用のプログラムを使ってビットマップファイルを作成します。
</li><li> Windowsのペイントを使用し、組込みユーザ定義ビットマップツールバーで起動します。ユーザファイルフォルダ内にある<b>Userdef.bmp</b>を開きます。  
</li><li> 画像の高さは16のままである必要があるので変更しないでください。画像の幅はボタンに必要な数の16倍に設定します。各ボタンは16x16ピクセルになります。
</li><li> 必要に応じて編集を加えてください。
</li><li> BMPを<B>16色ビットマップ</B>として保存します。
</li><li> Originで<B>表示：</B><b>ツールバー</b>を選び、ツールバーのカスタム化ダイアログを開きます。
</li><li> <B>ボタングループ</B>タブをアクティブにします。
</li><li> <B>ボタングループ</B>にある<B>新規</B>ボタンをクリックし、ボタングループの作成ダイアログを開きます。
</li><li> グループ名を入力します。
</li><li> この新しいグループに対するボタンの数を入力します。
</li><li> 参照ボタンをクリックし、ビットマップファイルの場所に移動します。このファイルは、ユーザフォルダに置いておくほうが良いでしょう。
</li><li> <b>OK</b>をクリックします。
</li><li> 名前を付けて保存ダイアログが開きます。ビットマップファイルと同じ名前を入力します。<B>OK</B>をクリックしてINIファイルを保存します。作成したグループがグループリストに追加され、ボタンが表示されます。
</li><li> ボタンの1つをクリックして選択します。
</li><li> 設定ボタンをクリックし、ボタン設定ダイアログを開きます。
</li><li> 参照ボタンをクリックし、OGSファイルのある場所に移動します。
</li><li> OGSファイルのセクション名を、引数リストに引数入力します。
</li><li> ツールチップテキストボックスに簡単な説明を入力します。
</li><li> ステータスバーテキストボックスにステータスバーに出力するメッセージを入力します。
</li><li> <b>OK</b>をクリックします。
</li><li> ボタングループの各ボタンに対して15-21のステップを繰り返します。
</li><li> 初めのボタンをOriginのワークスペースにドラッグします。ツールバーが作成されます。これでほかのボタン全てをツールバーにドラッグできます。 
</li></ol>

<hr class='keywordshr'><p><span class='keywords'>キーワード:</span> <span class='keywordsInput'>自動化, クリック, 繰り返し</span></p>





    