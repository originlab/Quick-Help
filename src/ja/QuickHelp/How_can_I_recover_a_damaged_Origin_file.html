<h1 class="firstheading">FAQ-464 破損したOriginファイルを修復するにはどうしたら良いですか?</h1><p class='urlname' style='display: none'>Recover-Damaged-OPJ</p>
<p class='faqID'>最終更新日：2020/10/10</p>
<p>Originプロジェクトファイルを保存すると、Origin はファイルのコピーを、最後に保存されたときと同じようにバックアップに保存します。ファイルが壊れた場合は、以前保存したバージョンをバックアップから開くことで回復できます。
</p>
<ul><li> Origin 2018bからは、プロジェクトファイルごとにバックアップファイルが作成されるようになりました。  このバックアップファイルはMyProject-1234567.opjuというような名前で、<b>\Backup</b> folder (e.g. at C:\Users\<i>user</i>\Documents\OriginLab\Backup)に保存されます。</li>
<li> 旧バージョンのOriginでは、バックアップファイルはBackup.OPJという名前で、<b>User Files Folder</b> (例えば、C:\Users\<i>user</i>\Documents\OriginLab\2017\User Files)に保存されていました。</li></ul>
<h4><a name="1._Locating_and_Opening_your_Backup_Project_File"></a><span class="mw-headline">1.バックアップファイルの配置と利用</span></h4>
<ul><li> Origin 2018bでは、<b>ヘルプ: フォルダを開く: バックアッププロジェクトフォルダ</b>を選択するか、または、<b>ツール: オプション</b>を選び、<b>システムパス</b>のタブをクリックして<b>\Backup</b>のファイルパスをコピーして、Windowsファイルエクスプローラのアドレス欄に貼り付けます。</li>
<li> Origin 2018以前のバージョンでは、<a class="external text" href="../../UserGuide/UserGuide/The_User_Files_Folder.html">ユーザファイルフォルダ</a>内に.Backup.OPJファイルが1つだけ保存されています。<b>ツール: オプション</b>を開き、<b>システムパス</b>のタブをクリックして、<b>ユーザファイルフォルダ</b>のファイルパスをコピーして、Windowsファイルエクスプローラのアドレス欄に貼り付けます。</li></ul>
<p><br />
バックアップファイルの位置を確認したら、それをOriginで開きます。見つかったファイルが目的のものであれば：
</p>
<ul><li> Origin 2018b以降をお使いの場合：ファイルを新しい位置で保存します。</li>
<li> Origin 2018以前をお使いの場合：ファイルを新しい名前を付けて、新しい位置に保存します。（ファイル名はBackup.OPJ以外）</li></ul>
<h4><a name="2._Recovering_Datasets_from_a_Corrupted_Project"></a><span class="mw-headline">2.破損したプロジェクトファイルからデータセットを回復させる</span></h4>
<p>もし方法1がうまくいかない場合、次の操作を試します。まず破損しているプロジェクトファイルを開き、スクリプトウィンドウ(<b>ウィンドウ: スクリプトウィンドウ</b>)を開き、次のように入力します。
</p>
<pre class="lt" style="font-family:monospace;">list s</pre>
<p>Enterキーを押します。もしファイルの損傷が軽度であれば、データセットを回復させることができます。リストは以下の例のように表示されます。
</p>
<pre class="lt" style="font-family:monospace;"> <span style="color: #0000dd;">1</span>	MyData_Time
 <span style="color: #0000dd;">2</span><span style="color: #000080;">*</span>	MyData_Sample1
 <span style="color: #0000dd;">3</span><span style="color: #000080;">*</span>	MyData_Sample2
 <span style="color: #0000dd;">4</span>	Data2_A
 <span style="color: #0000dd;">5</span><span style="color: #000080;">*</span>	Data2_B
 <span style="color: #0000dd;">6</span><span style="color: #000080;">*</span>	Data2_C</pre>
<p>リストは<b>MyData</b>と<b>Data2</b>の2つのワークシートを含んでいることがわかります。これらのデータセットを復旧するためには、エディットコマンドを使用して、すべてのワークシートを1つずつ再作成します。例えば、以下を実行します。
</p>
<pre class="lt" style="font-family:monospace;">Edit MyData_Sample1;</pre> 
<p>Enterキーを押します。MyDataと関連する3つのデータセットを呼び出します。 
</p><p>Origin 2021以降では、次のコマンドを使用して、1回の実行ですべてのワークシートを再作成できます。  
</p>
<pre class="lt" style="font-family:monospace;">run <span style="color: #000080;">-</span>oc EditAllSeries;</pre>
<p>グラフウィンドウを回復させることは出来ません。
</p><p>ワークシートをエディットしたら、新しくOriginを起動し、破損したファイルからコピー＆ペーストします。もしくは、破損したファイルのデータをエクスポートして(メニューの<b>ファイル: エクスポート: ASCII</b>を選択して)、新しいOriginでこのASCIIファイルをインポートします。
</p><p><br />
<i><b>関連情報：</b></i>
</p>
<ul><li> <a class="external text" href="../../UserGuide/UserGuide/Opening_Closing_and_Backing_Up_the_Origin_Project_File.html">Originのプロジェクトファイルを開く、閉じる、バックアップする</a>.</li>
<li> <a href="../../QuickHelp/QuickHelp/Is_there_an_auto_save_feature_for_projects.html" title="クイックヘルプ：プロジェクトの自動保存機能はありますか?">FAQ-466 プロジェクトの自動保存機能はありますか?</a></li></ul>
<hr class='keywordshr'><p><span class='keywords'>キーワード:</span> <span class='keywordsInput'>破損したファイル, 修復, 損傷</span></p>







    