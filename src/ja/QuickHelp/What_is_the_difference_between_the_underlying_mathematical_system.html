<h1 class="firstheading">FAQ-283 日付データをExcelからOriginに変換するにはどのようにしたらよいでしょうか。</h1>
<p class="urlname" style="display: none;">Date_Conversion_Origin_Excel</p>
<p class="faqID">最終更新日:2016/09/20</p>
<p>Originが内部的に使用している日付と時間のデータは、天文暦のユリウス通日に基づいています。これは天文暦-4712年1月1日12時をグリニッジ平均時間を0としています。経度による時刻帯や、夏時間などによる時間シフトは行ないません。例えば、1998年6月11日21:23:01は、Originのユリウス日では、2450975.890984となります。</p>
<p>Excelは、1900 年から計算する日付システムと 1904 年から計算する日付システム の2つの日付をサポートしています。WindowsのExcelのデフォルトの日付システムは1900年から計算します。これは1900/01/01を数字の1としています。MacintoshのExcelのデフォルトの日付システムは1904年から計算します。これは1904年1月2日を数字の1としています。</p>
<p>下表は日付データの異なる形式をOriginに持ち込む方法です。</p>
<table class="simple">
<tr>
<th>Excelでのデータ形式(1900データシステム)</th>
<th>1900/2/28あるいはそれ以前</th>
<th>1900/3/1あるいはそれ以降</th>
</tr>
<tr>
<td>数値</td>
<td>2415019 を追加</td>
<td>2415018 を追加</td>
</tr>
<tr>
<td>テキスト</td>
<td>変換の必要なし</td>
<td>変換の必要なし</td>
</tr>
<tr>
<td>日付</td>
<td>1 日追加</td>
<td>変換の必要なし</td>
</tr>
</table>
<p><br /></p>
<table class="simple">
<tr>
<th>Excelでのデータ形式(1904データシステム)</th>
<th>1904/03/01あるいはそれ以前</th>
<th>1904/03/02あるいはそれ以降</th>
</tr>
<tr>
<td>数値</td>
<td>2416480 を追加</td>
<td>2416480 を追加</td>
</tr>
<tr>
<td>テキスト</td>
<td>変換の必要なし</td>
<td>変換の必要なし</td>
</tr>
<tr>
<td>日付</td>
<td>4年と2日を追加</td>
<td>4年と1日を追加</td>
</tr>
</table>
<p><br /></p>
<table class="note">
<tr>
<td><b style="font-weight: bold;">Note:</b> この２つの変換理由は、Excelが実際には閏年ではないのに、1900年を閏年として数えているためです。</td>
</tr>
</table>
<table class="noborder">
<tr>
<td style="vertical-align: top;" width="60"><img src="../images/What_is_the_difference_between_the_underlying_mathematical_system/Tip_icon.png" alt="" width="57" height="57" border="0"></td>
<td>
<p>1904年のシステムのExcelから日付形式で日付データをコピーしてOriginに貼りつけると、誤りがあります。正しくするためには、以下の２種類の方法があります。</p>
<h5><a name="1._Correcting_the_Date_data_in_Origin"></a><span class="mw-headline">1.Originでデータを修正する。</span></h5>
<p>この場合、表に示されている年と日付を手動で追加するか、1462を日付データに加えます。1462を追加して、日付データを自動で修正する場合には、<br /></p>
<dl>
<dd>
<table class="note">
<tr>
<td><b style="font-weight: bold;">Note:</b> Excelから貼り付ける前にOriginでデータ列のフォーマットを<b>日付</b>形式に設定すると、<b>ステップ5</b>と<b>ステップ6</b>を省略することができます。</td>
</tr>
</table>
</dd>
</dl>
<ol>
<li>日付データの列を選択し、右クリックすると表示されるコンテキストメニューから<b>列値の設定...</b>を選択します。</li>
<li><b style="font-weight: bold;">値の設定</b>ダイアログで以下のようにスクリプトを入力します。ここで、<b>C</b>は列のショートネームです。
<dl>
<dd><a class="image" style="color: #0000ff; text-decoration: underline;"><img alt="How do I convert date data from Excel to Origin.png" src="../images/What_is_the_difference_between_the_underlying_mathematical_system/How_do_I_convert_date_data_from_Excel_to_Origin.png" width="640" height="283" border="0"></a></dd>
</dl>
</li>
<li><b style="font-weight: bold;">OK</b>ボタンをクリックして、日付データに1462を加え、<b>テキスト&amp;数値</b>フォーマットにします。</li>
<li>日付データの列を再度選択し、右クリックすると表示されるコンテキストメニューから<b>プロパティ</b>を選択します。</li>
<li><b style="font-weight: bold;">列のプロパティ</b>ダイアログで、<b>オプション</b>項目にある<b>フォーマット</b>のドロップダウンリストから、<b>日付</b>を選択して、</li>
<li><b style="font-weight: bold;">OK</b>ボタンをクリックして、日付データを修正します。</li>
</ol>
<h5><a name="2._Changing_the_date_system_in_Excel"></a><span class="mw-headline">2.Excelで日付システムを変更する</span></h5>
<p>この場合、<b>ファイル： Excelのメニューのオプション</b>から、<b>Excelオプション</b>ダイアログを開き、左のパネルから<b>詳細</b>を選択して、<b>このワークブックを計算する場合</b>にスクロールします。この場合、<b>1904データシステムを使う</b>のチェックを外して、データシステムを変更します。</p>
</td>
</tr>
</table>
<hr class="keywordshr" align="center">
<p><span class="keywords">キーワード:</span> <span class="keywordsInput">ユリウス通日, 数値日付, 日付の通し番号, Excel</span></p>
<p><br /></p>
