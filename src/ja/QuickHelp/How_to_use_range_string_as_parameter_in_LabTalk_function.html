<h1 class="firstheading">FAQ-1145 LabTalk関数のパラメータとして範囲文字列を使用するには？</h1>
<p class='urlname' style='display: none'>Recognize_Range_String_in_LT_Function</p>
<p class='faqID'>最終更新日：2022/8/11</p>
<p><a class="external text" href="../../LabTalk/LabTalk/Total_(function).html">total()</a>のようなLabTalk関数の多くは、範囲文字列を引数とすることができません。ワークシート名と列のインデックスがそれぞれcol(A)とcol(B)であったとすると、以下の式で<i>i</i> 番目の列の合計を直接計算することはできません。</p>
<pre class="lt" style="font-family:monospace;">
total<span style="color: #000000;">(</span>A<span style="color: #000080;">$</span> <span style="color: #000080;">+</span> “<span style="color: #000080;">!</span>”<span style="color: #000080;">+</span> B<span style="color: #000080;">$</span><span style="color: #000000;">)</span>
</pre>
<p>Origin 2023では、LabTalkローカル関数<i><b>mkrng</b></i>で範囲変数を生成できます。上述の例の場合、代替として以下の式を使用できます。</p>
<pre class="lt" style="font-family:monospace;">
total<span style="color: #000000;">(</span>mkrng<span style="color: #000000;">(</span>A<span style="color: #000080;">$</span> <span style="color: #000080;">+</span> “<span style="color: #000080;">!</span>”<span style="color: #000080;">+</span> B<span style="color: #000080;">$</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>
</pre>
<p>Origin 2023よりも前のバージョンでは、以下の<i><b>mkrng</b></i>関数を自身で定義する必要があります。</p>
<pre class="lt" style="font-family:monospace;">
function range mkrng<span style="color: #000000;">(</span>string str<span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
    range rr <span style="color: #000080;">=</span> str<span style="color: #000080;">$</span>;
    return rr;
<span style="color: #000000;">}</span>
</pre>
<hr class='keywordshr' />
<p><span class='keywords'>キーワード:</span><span class='keywordsInput'>LabTalk, 範囲, 文字列</span></p>
