<h1 class="firstheading">FAQ-286 グローバルな関数や変数、定数を定義するにはどうしたら良いでしょうか?</h1><p class='urlname' style='display: none'>Global-Constants</p>
<p class='faqID'>最終更新日：2021/03/02</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Global_Functions_for_use_across_Origin_sessions"><span class="tocnumber">1</span> <span class="toctext">Originセッションで使用できる関数</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Global_Constants_and_Variables_for_use_across_Origin_sessions"><span class="tocnumber">2</span> <span class="toctext">Originセッションで使用できる定数と変数</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Constants_and_Variables_in_the_current_Origin_Session"><span class="tocnumber">3</span> <span class="toctext">現Originセッションの定数と変数</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Constants_and_Variables_specific_to_an_Origin_Project"><span class="tocnumber">4</span> <span class="toctext">特定のOriginプロジェクトの定数と変数</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Variables_specific_to_a_Worksheet"><span class="tocnumber">5</span> <span class="toctext">特定ワークシートの変数</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Constants_in_a_Fitting_Function"><span class="tocnumber">6</span> <span class="toctext">フィット関数での定数</span></a></li>
</ul>
</div>

<h2><a name="Global_Functions_for_use_across_Origin_sessions"></a><span class="mw-headline">Originセッションで使用できる関数</span></h2>
<p>Originセッションで使用できるグローバル関数を定義するには、<a class="external text" href="http://www.originlab.com/doc/LabTalk/guide/On-Starting-Origin#Defining_a_global_function" target="_blank">このページ</a>をご覧ください。
</p><p>関数のスコープの詳細については、<a class="external text" href="http://www.originlab.com/doc/LabTalk/guide/Functions#Scope_of_Functionsscope_of_a_function" target="_blank">このページ</a>をご覧ください。
</p>
<h2><a name="Global_Constants_and_Variables_for_use_across_Origin_sessions"></a><span class="mw-headline">Originセッションで使用できる定数と変数</span></h2>
<p>Originを起動すると、ユーザファイルフォルダのORGSYS.CNFというテキストファイルが読み込まれます。もし、通常使用する数学的な定数がある場合、CONST.CNFでそれを定義すれば、Originを起動するたびに利用可能になります。
</p>
<ol>
<li>もしOriginが起動していたら、プログラムから出ます。</li>
<li>ユーザファイルフォルダの下にあるCONST.CNFファイルを開くか、テキストエディタ（メモ帳など）で新しいページを開始して、次の情報を入力します。</li>
<pre class="lt" style="font-family:monospace;">const e <span style="color: #000080;">=</span> <span style="color: #0000dd;">2.718281828459045</span> <span style="color: #008000;">//Euler&apos;s number</span></pre>
<li>CONST.CNFに名前を付けて、ファイルを<a href="../../QuickHelp/QuickHelp/What_is_the_User_Files_Folder.html" title="クイックヘルプ：User Filesフォルダとはなんですか？">User Filesフォルダ(UFF)</a>に保存します。 
<li>設定した定数や変数を確認するには、Originを起動してスクリプトウィンドウを開き、定数または変数の名前を入力し、＝を付けてEnterを押します。
</ol>
<h2><a name="Constants_and_Variables_in_the_current_Origin_Session"></a><span class="mw-headline">現Originセッションの定数と変数</span></h2>
<p>現在のOriginセッションのための定数や変数を定義するには、スクリプトウィンドウを使用して単純に定義します。
</p>
<ol>
<li>
メニューから次のように選択します。<b><b>ウィンドウ: スクリプトウィンドウ</b></b>
</li>
<li>
次のように希望の定数や変数を入力し、それぞれの行の終端で<i>Enter</i>キーを押します。
<pre>
const myconst = 1.234;
double myvar = 12.34;
int mynum = 127;
</pre>
</li>
</ol>
<p>実行後、スクリプトウィンドウや、<b><b>列値の設定</b></b>ダイアログ等のスクリプト入力欄で、これらの定数と変数にアクセスできます。
</p>
<h2><a name="Constants_and_Variables_specific_to_an_Origin_Project"></a><span class="mw-headline">特定のOriginプロジェクトの定数と変数</span></h2>
<p>プロジェクト固有の定数や変数を定義するためには、プロジェクトに付加された<b>ProjectEvents.OGS</b>ファイル内で定義します。
</p>
<ol><li> Originメニューから<b>表示：コードビルダ</b>を選択して<b><b>コードビルダ</b></b>を開き、左パネルで、<b>Project</b> ツリーを開いて<b>ProjectEvents.ogs</b>をダブルクリックして開きます。</li>
<li>  <b>AfterOpenDoc</b>セクションで以下のコードを追加し、このファイルを保存して、Originのプロジェクトファイルも保存します。
<ul><li> @global=1;</li>
<li> 変数や定数を定義</li></ul></li></ol>
<p>これで、定義内容はプロジェクトに保存されます。
</p><p>次のチュートリアルは、Originのプロジェクトレベルにユーザ定義変数を追加し、その変数を使う方法を示しています。
</p>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_do_I_define_global_constants/Tutorial_icon.png" width="57"  border="0" />
	</td>
	<td><ol>
<li> 新しいプロジェクトを開き、Originメニューから<b>表示：コードビルダ</b>を選択して<b>コードビルダ</b>を開きます。</li>
<li> 左パネルでプロジェクトのブランチを開き、ダブルクリックで<b>ProjectEvents.OGS</b>ファイルを開きます。このファイルは、デフォルトで新しいプロジェクトに存在します。 </li>
<li> <b>[AfterOpenDoc]</b> セクションの下に次のコード行を追加します。
<pre class="lt" style="font-family:monospace;">@global<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
double myconst <span style="color: #000080;">=</span> <span style="color: #0000dd;">20</span>;</pre> </li>
<li> ファイルを保存し、コードビルダを閉じます。</li>
<li> Origin内で、好きなフォルダ位置にプロジェクトを保存してください。OGSファイルはプロジェクトとともに保存されるため、ユーザ定義変数はそのプロジェクトで使えるようになります。</li>
<li> いま保存したプロジェクトをもう一度開いてください。<b>[AfterOpenDoc]</b> セクションが実行されmyconstが定義されます。</li>
<li> ワークシートをアクティブにし、Samples\Signal Processing\fftfilter1.DATファイルを開きます。 </li>
<li> ワークシートに1列追加します。 </li>
<li> 3番目の列のヘッダをクリックし、右クリックして開くコンテキストメニューから、<b><b>列値の設定</b></b>を選択します。 </li>
<li> <b>値の設定</b>ダイアログで、編集ボックスに下記を入力します。:<br />wcol(2)*myconst </li>
<li> ここでプロジェクトをもう一度保存して、開き直します。Originメニューの<b><b>ウィンドウ：スクリプトウィンドウ</b></b>を選択します。 </li>
<li> <b><b><b>スクリプトウィンドウ</b></b></b>で以下のスクリプトを入力してEnterを押すと、myconstの値が変わり、再計算が行われます。 
<pre class="lt" style="font-family:monospace;">myconst <span style="color: #000080;">=</span> <span style="color: #0000dd;">30</span>;; <span style="color: #008000;">//myconstの値をこのセッションに限り変更Not saved in project</span>
run <span style="color: #000080;">-</span>auf <span style="color: #0000dd;">2</span> <span style="color: #0000dd;">1</span>; <span style="color: #008000;">//計算を更新</span></pre> </li>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_do_I_define_global_constants/Tip_icon.png" width="57"  border="0" /></td><td><p><i>run -auf</i>コマンドについての詳細は、<a class="external text" href="../../LabTalk/LabTalk/Run_(command).html#-auf.3B_Trigger_all_recalculation">こちら</a>をご覧ください。
</p></td></tr></table>
</ol>
</td></tr></table>
<h2><a name="Variables_specific_to_a_Worksheet"></a><span class="mw-headline">特定ワークシートの変数</span></h2>
<p>ワークシート固有の変数を定義し、この変数を変更することでほかの列の結果を更新する必要がある場合、次のように操作します。
</p>
<ol><li> 現在のシートか、新しいシートに2つの列を追加し、1列目に変数名、2列目に値を入力します。変数名は参照可能です。</li>
<li> 他の列の値を計算するために、<b>値の設定</b>ダイアログを使用するとき、<b>実行前のスクリプト</b>パネルを使用して、変数列の特定セルを指定するためのスクリプトでローカル変数を定義し、上部パネルの列式に含めます。再計算モードが自動か手動にセットされていれば、変数の値を変更するだけで、計算結果も更新されます。より詳細は情報は、<a class="external text" href="../../UserGuide/Category/Using_Formulae_to_Set_or_Transform_Worksheet_Column_Values.html">値の設定</a>ダイアログのヘルプファイルをご確認ください。</li></ol>
<h2><a name="Constants_in_a_Fitting_Function"></a><span class="mw-headline">フィット関数での定数</span></h2>
<p><b><b>フィット関数ビルダ</b></b>の<b>変数とパラメータ</b>のページに、定数を定義するための編集ボックスがあります。関数本体とパラメータを定義するページの<b>定数</b>タブを開き、定数に値を割り当てることができます。
</p><p>詳細は、<a class="external text" href="../../LabTalk/LabTalk/Data_Types_and_Variables.html#Scope_of_Variables">変数のスコープ</a>を参照してください。
</p><p><br />
</p>
<hr class='keywordshr'><p><span class='keywords'>キーワード：</span><span class='keywordsInput'>変数, 変数を定義, 定数, グローバル変数, @glob, @global, プロジェクト変数, ORGSYS.CNF, 値の設定, 実行前の処理スクリプト, ProjectEvents.OGS, スクリプトウィンドウ</span></p>



    