<h1 class="firstheading">FAQ-858 総和フィット関数または二重積分フィット関数を作成するにはどのようにしたらよいですか？</h1><p class='urlname' style='display: none'>Summation-DoubleIntegral-Func</p>
<p class='faqID'>最終更新日:2017/6/23</p>
<p>ツール：フィット関数オーガナイザーで、LabTalkスクリプトかOrigin Cコードを使用してユーザ定義の総和または二重積分フィット関数を作成できます。</p>
<h2><a name="summation_fitting_function"></a><span class="mw-headline">総和フィット関数</span></h2>
<p>関数定義ボックスで<b>For</b>ループを組み込んだフィット関数を定義できます。以下関数をサンプルとして考えてみます。</p><p><img src="../images/How_to_build_up_summation_or_double_integral_fitting_funtion/math-45e5bd7a44a0155e3ee7419c9d48fd72.png" title="y=\sum_{i=1}^{10}a \cdot x^2" alt="y=\sum_{i=1}^{10}a \cdot x^2" class="tex"/></p><p>このフィット関数を、<b>関数</b>ボックスで以下のように定義したとします。</p>
<pre class="lt" style="font-family:monospace;">y <span style="color: #000080;">=</span> sum<span style="color: #000000;">(</span>x, a, n<span style="color: #000000;">)</span>; <span style="color: #008000;">//nは定数でn=10</span></pre>
<p>次に、ユーザ定義のLabTalk関数<i>sum</i> は、<b>LabTalk関数の定義と初期化</b>ボックスで以下のようにして定義します。</p>
<pre class="lt" style="font-family:monospace;">function double sum<span style="color: #000000;">(</span>double x, double a, int n<span style="color: #000000;">)</span> <span style="color: #000000;">{</span> double bb <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; for<span style="color: #000000;">(</span>ii <span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>; ii<span style="color: #000080;">&lt;=</span>n; ii<span style="color: #000080;">++</span><span style="color: #000000;">)</span> <span style="color: #000000;">{</span> bb <span style="color: #000080;">=</span> a <span style="color: #000080;">*</span> x <span style="color: #000080;">*</span> x <span style="color: #000080;">+</span> bb; <span style="color: #000000;">}</span> return bb; <span style="color: #000000;">}</span></pre>
<h2><a name="double_integral_fitting_function"></a><span class="mw-headline">二重積分フィット関数</span></h2>
<p>積分を実行するNAG関数を呼び出すOrigin Cフィット関数を定義できます。以下関数をサンプルとして考えてみます。</p><p><img src="../images/How_to_build_up_summation_or_double_integral_fitting_funtion/math-96f39de0f0b38c57d21e5dc984043c20.png" title="y=\int_{Amp}^x \int_{Amp}^x (t+k)dtdk" alt="y=\int_{Amp}^x \int_{Amp}^x (t+k)dtdk" class="tex"/></p>
<ol>
<li><b>関数</b>ボックスの横にあるボタンをクリックして、<b>コードビルダ</b>を開きます。<li>スクロールして次の行まで移動します。<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//add the header file for the NAG functions here.</span></pre>
<p>そして、この行の下にNAG関数のヘッダファイルを追加します。</p>
<pre class="lt" style="font-family:monospace;">#include <span style="color: #000080;">&lt;</span>OC_nag.<span style="color: #000080;">h</span><span style="color: #000080;">&gt;</span></pre>
<li>フィットモデルを定義します。<pre class="lt" style="font-family:monospace;">static double NAG_CALL f<span style="color: #000000;">(</span>int n, double z<span style="color: #000000;">[</span><span style="color: #000000;">]</span>, Nag_User <span style="color: #000080;">*</span>comm<span style="color: #000000;">)</span> <span style="color: #000000;">{</span> double tmp_pwr; tmp_pwr <span style="color: #000080;">=</span> z<span style="color: #000000;">[</span><span style="color: #0000dd;">0</span><span style="color: #000000;">]</span><span style="color: #000080;">+</span>z<span style="color: #000000;">[</span><span style="color: #0000dd;">1</span><span style="color: #000000;">]</span>; return tmp_pwr; <span style="color: #000000;">}</span></pre>
<li>フィット関数を編集します。<pre class="lt" style="font-family:monospace;">void _nlsfnag_double_integral_fitting<span style="color: #000000;">(</span> <span style="color: #008000;">// Fit Parameter(s):</span> double amp, <span style="color: #008000;">// Independent Variable(s):</span> double x, <span style="color: #008000;">// Dependent Variable(s):</span> double<span style="color: #000080;">&amp;</span> y<span style="color: #000000;">)</span> <span style="color: #000000;">{</span> <span style="color: #008000;">// Beginning of editable part</span> int ndim <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;  <span style="color: #008000;">// 積分次元</span> int maxpts <span style="color: #000080;">=</span> <span style="color: #0000dd;">1000</span><span style="color: #000080;">*</span><span style="color: #0000dd;">2</span>;  <span style="color: #008000;">// 関数評価の最大数 </span> double a<span style="color: #000000;">[</span><span style="color: #0000dd;">2</span><span style="color: #000000;">]</span>, b<span style="color: #000000;">[</span><span style="color: #0000dd;">2</span><span style="color: #000000;">]</span>; int k; static NagError fail; double finval; int minpts; double acc, eps; Nag_User comm; for <span style="color: #000000;">(</span>k<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>; k <span style="color: #000080;">&lt;</span> <span style="color: #0000dd;">2</span>; <span style="color: #000080;">++</span>k<span style="color: #000000;">)</span>  <span style="color: #008000;">// 積分区間</span> <span style="color: #000000;">{</span> a<span style="color: #000000;">[</span>k<span style="color: #000000;">]</span> <span style="color: #000080;">=</span> amp; b<span style="color: #000000;">[</span>k<span style="color: #000000;">]</span> <span style="color: #000080;">=</span> x; <span style="color: #000000;">}</span> eps <span style="color: #000080;">=</span> <span style="color: #0000dd;">0.0001</span>; <span style="color: #008000;">// 精度設定</span> minpts <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; d01wcc<span style="color: #000000;">(</span>ndim, f, a, b, <span style="color: #000080;">&amp;</span>minpts, maxpts, eps, <span style="color: #000080;">&amp;</span>finval, <span style="color: #000080;">&amp;</span>acc, <span style="color: #000080;">&amp;</span>comm, <span style="color: #000080;">&amp;</span>fail<span style="color: #000000;">)</span>; y <span style="color: #000080;">=</span> finval; <span style="color: #008000;">// End of editable part</span> <span style="color: #000000;">}</span></pre>
<li><b>コンパイル</b>ボタンをクリックしてコンパイルします。</ol>
<p><br /> ユーザ定義の積分関数についてのチュートリアルがいくつかあります。必要に応じて関連するトピックで詳細な操作を参照してください。</p><ul><li><a href="../../Tutorial/Tutorial/Fitting_with_Integral_using_NAG_Library.html" title="チュートリアル:NAGライブラリを使った積分フィット">OriginCとNAGライブラリを使用した関数</a></li>
<li><a href="../../Tutorial/Tutorial/Fitting_with_Integral_using_LabTalk_Function.html" title="チュートリアル:LabTalk関数を使用して積分フィットをする">LabTalkスクリプトを使う</a></li>
<li><a href="../../Tutorial/Tutorial/Fitting_with_Two_Integrals_using_LabTalk_Function.html" title="チュートリアル:LabTalk関数を使って2つの積分を含む関数でフィット">LabTalk関数を使って2つの積分を含む関数でフィット</a></li>

<li><a href="../../Tutorial/Tutorial/Fitting_with_Summation.html" title="チュートリアル:フィットしながら総和を求める">フィットしながら総和を求める</a></li></ul><hr class='keywordshr'><p><span class='keywords'>キーワード:</span> <span class='keywordsInput'>積分する, 積分, フィット, OriginC, LabTalk, NAG, 総和, 二重積分</span></p>







    