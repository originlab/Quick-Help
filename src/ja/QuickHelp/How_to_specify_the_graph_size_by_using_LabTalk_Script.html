<h1 class="firstheading">FAQ-663 LabTalkスクリプトを使用してグラフサイズを指定するには？</h1><p class='urlname' style='display: none'>Specify-Graph-Size </p>
<p class='faqID'>最終更新日:2015/08/03</p>
<p>このページではプロットの物理的寸法を制御する方法を紹介します。
</p><p>グラフウィンドウの物理的サイズに関連し、現在のプリンターからOriginが取得するページプロパティには4つあります。
</p>
<ul>
<li>PAGE.WIDTH - プリンタドットでのページの物理的幅
<li>PAGE.HEIGHT - プリンタドットでのページの物理的高さ
<li>PAGE.RESX - プリンタの水平のDPI(ドット毎インチ)解像度
<li>PAGE.RESY - プリンタの垂直のDPI(ドット毎インチ)解像度
</ul>
<p>これらのプロパティを使用して、ページの物理的サイズを決定できます。
</p>
<ul>
<li>WidthInInches = PAGE.WIDTH/PAGE.RESX;
<li>HeightInInches = PAGE.HEIGHT/PAGE.RESY;
</ul>
<p>レイヤは以下の単位で設定できます。
</p>
<ul>
<li>ページに対する%
<li>インチ
<li>cm
<li>mm
<li>ピクセル
<li>ポイント
<li>Windowsの設定
</ul>
<p>レイヤの指定の確認や上書きが可能です。
</p>
<pre class="lt" style="font-family:monospace;">layer.<span style="color: #000080;">unit</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>; <span style="color: #008000;">// Set a layer to units of cm</span>
WidthInCM <span style="color: #000080;">=</span> layer.<span style="color: #000080;">width</span>; <span style="color: #008000;">// Read the width in cm</span>
layer.<span style="color: #000080;">unit</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>; <span style="color: #008000;">// Set a layer to units of Inches</span>
layer.<span style="color: #000080;">height</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">6.5</span>; <span style="color: #008000;">// Set a layer to 6.5 inches tall</span>
<span style="color: #008000;">//Combining this information, we can set a graph to unit aspect ratio with this script:</span>
layer.<span style="color: #000080;">unit</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
dwidth <span style="color: #000080;">=</span> x2 <span style="color: #000080;">-</span> x1;
dheight <span style="color: #000080;">=</span> y2 <span style="color: #000080;">-</span> y1;
if<span style="color: #000000;">(</span>dwidth<span style="color: #000080;">/</span>dheight <span style="color: #000080;">&gt;</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
layer.<span style="color: #000080;">height</span> <span style="color: #000080;">=</span> layer.<span style="color: #000080;">width</span> <span style="color: #000080;">*</span> dheight <span style="color: #000080;">/</span> dwidth;
<span style="color: #000000;">}</span>
else
<span style="color: #000000;">{</span>
layer.<span style="color: #000080;">width</span> <span style="color: #000080;">=</span> layer.<span style="color: #000080;">height</span> <span style="color: #000080;">*</span> dwidth <span style="color: #000080;">/</span> dheight;
<span style="color: #000000;">}</span>
&nbsp;
<span style="color: #008000;">//Here is code which 'centers' a layer:</span>
layer.<span style="color: #000080;">top</span> <span style="color: #000080;">=</span> <span style="color: #000000;">(</span>page.<span style="color: #000080;">height</span> <span style="color: #000080;">/</span> page.<span style="color: #000080;">resy</span> <span style="color: #000080;">-</span> layer.<span style="color: #000080;">height</span><span style="color: #000000;">)</span><span style="color: #000080;">/</span><span style="color: #0000dd;">2</span>; 
layer.<span style="color: #000080;">left</span> <span style="color: #000080;">=</span> <span style="color: #000000;">(</span>page.<span style="color: #000080;">width</span> <span style="color: #000080;">/</span> page.<span style="color: #000080;">resx</span> <span style="color: #000080;">-</span> layer.<span style="color: #000080;">width</span><span style="color: #000000;">)</span> <span style="color: #000080;">/</span> <span style="color: #0000dd;">2</span>;</pre>
<p>これらの操作で、正しい寸法及び正確なスケールでグラフを生成できます。
</p>

<hr class='keywordshr'><p><span class='keywords'>キーワード:</span> <span class='keywordsInput'>グラフサイズ</span></p>





    