<h1 class="firstheading">FAQ-666 LabTalkスクリプトを使用してダイアログを開くには？</h1><p class='urlname' style='display: none'>Dialog-Labtalk</p>
<p class='faqID'>最終更新: 2018/07/12</p>
<p>Originのグラフィカルユーザインターフェース(GUI)には数多くのメニューコマンドとツールバーボタンがあり、これらはLabTalkスクリプトで実行できます。メニューアイテムやボタンを選択するとき実行されるスクリプトを表示させるのは簡単です。OriginGUIがサンプルLabTalkスクリプトのソースを表示します。これらのスクリプトファイルはサンプルとして確認し、カスタムスクリプトとして使用できます。Originのスクリプトファイルは、Originも同様に使用しているので、直接修正しないようにしてください。Originスクリプトファイルを編集したい場合に一番安全な方法は、スクリプトを自身のファイルにコピー/貼り付けして編集する方法です。
</p><p>スクリプトウィンドウを開き、メニューアイテムやボタンをCTRL と SHIFT キーを押しながら選択します。Originはスクリプトウィンドウに、選択されたメニューアイテムやボタンのメニューIDとスクリプト（通常はrun.sectionコマンド）を表示します。選択されたメニューアイテムまたはボタンを実行されません。Originでは、多くの場合、LabTalkコマンドmenu -e IDでメニューIDを実行できます。menu -e ID コマンドについては、<a class="external text" href="../../LabTalk/LabTalk/Menu_(command).html#-e.3B_Execute_the_menu_command_with_the_specified_ID">LabTalkヘルプ</a>またはLabTalkマニュアルで詳細を確認してください。なお、メニューIDはバージョンごとに異なりますので、互換性を保つためには使用しないでください。
</p><p>以下のコマンドを使用します。
</p>
<pre class="lt" style="font-family:monospace;">run.<span style="color: #000080;">section</span><span style="color: #000000;">(</span>fileName, section<span style="color: #000000;">)</span></pre>
<p>コマンドは、メニューアイテムやボタンが選択された時に実行されるスクリプトの場所を識別します。引数 fileName はスクリプトファイルのパスとファイル名を指定し、引数 section は実行するコードのセクションを指定します。パスが指定されないと、Originフォルダとみなされ、拡張子の指定がない場合は.OGS ファイルとみなされます。テキストエディタでファイルを開き、[section]のように角括弧で囲まれたセクション名を探します。
</p><p>メニューIDと run.section コマンドはスクリプトウィンドウに表示されます。また、関連するOGSファイルはコードビルダで開かれ、実行されるセクションにカーソルが置かれます。
</p><p>例えば、CTRL と SHIFTキーを押しながらファイル：開くメニューを選択すると、スクリプトウィンドウには以下のように表示されます。
</p>
<pre class="lt" style="font-family:monospace;">Menu id<span style="color: #000080;">=</span><span style="color: #0000dd;">33996</span> <span style="color: #000000;">(</span>0x84cc<span style="color: #000000;">)</span>
run.<span style="color: #000080;">section</span><span style="color: #000000;">(</span>FILE,Open<span style="color: #000000;">)</span></pre>
<p>実際に実行されるスクリプトは、OriginフォルダのFILE.OGSファイルの [Open] セクションであることがわかります。Origin 7.5以降のバージョンでは、コードビルダでFILE.OGSファイルが開き、[Open] セクションのはじめにカーソルが置かれます。
</p>
<hr class='keywordshr'><p><span class='keywords'>キーワード:</span><span class='keywordsInput'>LabTalk</span></p>




    