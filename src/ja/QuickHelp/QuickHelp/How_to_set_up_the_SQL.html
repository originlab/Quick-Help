<h1 class="firstheading">FAQ-800 SQLをセットアップするには、どのようにしたらよいでしょうか?</h1>
<p class="urlname" style="display: none;">set-up-sql</p>
<p class="faqID">最終更新: 2018/07/18</p>
<p>データベースにアクセスする簡単なツールをご紹介するチュートリアルがいくつかございます。これらのチュートリアルをPCで行うには、AdventureWorksデータベースを利用します。以下に、SQLの設定方法と、SQL 
 ServerでAdventureWorksデータベースに接続してからOriginと連携する方法を示します。 </p>
<div id="toc" class="toc">
	<div id="toctitle">
		<h2>目次</h2>
	</div>
	<ul>
		<li class="toclevel-1 tocsection-1"><a href="#Download_the_AdventureWorks_database"><span 
		 class="tocnumber">1</span> <span class="toctext">AdventureWorksデータベースのダウンロード</span></a></li>
		<li class="toclevel-1 tocsection-2"><a href="#Set_up_your_SQL_Server"><span 
		 class="tocnumber">2</span> <span class="toctext">SQL Serverの設定</span></a></li>
		<li class="toclevel-1 tocsection-3"><a href="#Configure_the_Data_Sources_.28ODBC.29"><span 
		 class="tocnumber">3</span> <span class="toctext">データソース (ODBC)の設定</span></a></li>
		<li class="toclevel-1 tocsection-4"><a href="#Connect_the_database_in_Origin"><span 
		 class="tocnumber">4</span> <span class="toctext">Originのデータベースに接続</span></a></li>
	</ul>
</div>
<h3><a name="Download_the_AdventureWorks_database"></a><span class="mw-headline">AdventureWorksデータベースのダウンロード</span></h3>
<p>AdventureWorksデータベースを<a class="external text" href="https://msftdbprodsamples.codeplex.com/releases/view/125550" 
							 target="_blank">リンク</a>からダウンロードします。ダウンロードの際に、<a 
	 class="external text" href="https://msftdbprodsamples.codeplex.com/downloads/get/880661" 
	 target="_blank">Adventure Works 2014 Full Database Backup.zip</a>を選択して、<i>E:\</i>などのPCのハードディスクに解凍してください。解凍ファイル<i>AdventureWorks2014.bak</i>になります。 
 </p>
<h3><a name="Set_up_your_SQL_Server"></a><span class="mw-headline">SQL 
 Serverの設定</span></h3>
<p>AdventureWorksデータベースのインストール前に、SQL ServerインスタンスをPCにインストールする必要があります。Microsoft 
 SQL Server 2014 Expressのインストール手順は、次の通りです。 </p>
<p><b>Note:</b>OSは<b>Windows 7</b>か、それ以上のバージョンをお使いください。 </p>
<ol>
	<li><a class="external text" href="https://www.microsoft.com/en-us/download/details.aspx?id=42299" 
			 target="_blank">ダウンロード</a>を開き、ご自身のMicrosoftのアカウントで ログインして、「ダウンロード」をクリックします。</li>
	<li><b>ExpressAdv 32BIT\SQLEXPRADV_x86_ENU.exe</b>(32bit用)、または、<b>ExpressAdv 
	 64BIT\SQLEXPRADV_x64_ENU.exe</b> (64bit用)を選択して、<b>次へ</b>をクリックしてダウンロードを開始します。</li>
	<li>ダウンロードページの<b>インストール方法</b>をご参照ください。インストールの際には、デフォルト設定をすべて承認可能です。</li>
	<li>インストールが完了したら、Windowsの<b>スタート</b>メニューで<b>すべてのプログラム</b> を選択して、<b>Microsoft 
	 SQL Server 2014: SQL Server 2014 Management Studio</b>をブラウズして、SQL 
	 Serverを開きます。</li>
	<li>ポップアップの<b>サーバーへの接続</b>ダイアログで、接続の設定を指定します。以下のグラフのように<b>サーバーの種類</b>と<b>認証</b>を選択して、<b>接続</b>をクリックします。 
	 
	<dl>
		<dd><a class="image"><img alt="SQL initialize.png" src="../images/How_to_set_up_the_SQL/SQL_initialize.png" 
									 width="426" border="0" /></a></dd>
	</dl></li>
	<li><b>オブジェクト エクスプローラー</b>パネルの<b>データベース</b>を右クリックして、「データベースの復元」を選択し、ダイアログを開きます。 
	 
	<dl>
		<dd><a class="image"><img alt="SQL restore.png" src="../images/How_to_set_up_the_SQL/SQL_restore.png" 
									 width="386" border="0" /></a></dd>
	</dl></li>
	<li>元のセクションのデバイスを選択して、ダウンロードしてある<i>AdventureWorks2014.bak</i>というファイルをブラウズして、追加します。OK 
	 をクリックします。</li>
</ol>
<p><a class="image"><img alt="SQL database.png" src="../images/How_to_set_up_the_SQL/SQL_database.png" 
						 width="878" border="0" /></a> 8. これで、データベースのインポートが完了です。 
 </p>
<h3><a name="Configure_the_Data_Sources_.28ODBC.29"></a><span class="mw-headline">データソース 
 (ODBC)の設定</span></h3>
<ol>
	<li>Windowsの<b>スタート</b>ボタンをクリックして、<b>プログラムとファイルの検索</b>で<b>データソース</b>と入力します。表示されたリストから、このアプリケーションを見つけ、クリックしてダイアログを開きます。 
	 
	<dl>
		<dd><a class="image"><img alt="SQL source.png" src="../images/How_to_set_up_the_SQL/SQL_source.png" 
									 width="228" border="0" /></a></dd>
	</dl></li>
	<li>ダイアログにある<b>システム DSN</b>タブで 、<b>追加</b>をクリックして、 <b>データソースの新規作成</b>ダイアログを開きます。<b>ODBC 
	 Driver 11 for SQL Server</b>を選択して、 
	<dl>
		<dd><a class="image"><img alt="SQL odbc.png" src="../images/How_to_set_up_the_SQL/SQL_odbc.png" 
									 width="478" border="0" /></a></dd>
	</dl></li>
	<li><b>完了</b>をクリックします。新しいダイアログが開くので、「名前」を「New_test」と指定して、サーバーとして選択します。 
	 
	<dl>
		<dd><a class="image"><img alt="SQL odbc2.png" src="../images/How_to_set_up_the_SQL/SQL_odbc2.png" 
									 width="580" border="0" /></a></dd>
	</dl></li>
	<li><b>完了</b>をクリックすると、ODBC Microsoft SQL Serverセットアップダイアログが開き、<b>データソースのテスト</b>ボタンをクリックできるようになります。 
	 
	<dl>
		<dd><a class="image"><img alt="SQL odbc3.png" src="../images/How_to_set_up_the_SQL/SQL_odbc3.png" 
									 width="408" border="0" /></a></dd>
		<dd>ここまで上手くいった場合、メッセージダイアログに「テストは無事に完了しました。」と表示されます。各ダイアログで、「OK」 
		 をクリックして、設定を適用します。</dd>
		<dd><a class="image"><img alt="SQL odbc4.png" src="../images/How_to_set_up_the_SQL/SQL_odbc4.png" 
									 width="378" border="0" /></a></dd>
	</dl></li>
</ol>
<h3><a name="Connect_the_database_in_Origin"></a><span class="mw-headline">Originのデータベースに接続</span></h3>
<ol>
	<li>Originを開き、データアクセスツールボックスの<a class="image"><img alt="Button Open SQL Editer.png" 
														 src="../images/How_to_set_up_the_SQL/Button_Open_SQL_Editer.png" 
														 width="24" border="0" /></a>をクリックして、SQLエディタを開きます。<a 
	 class="image"><img alt="Db editor connect.png" src="../images/How_to_set_up_the_SQL/Db_editor_connect.png" 
						 width="23" border="0" /></a>をクリックして、<b>データリンクプロパティ</b>ダイアログを開き、<b>Microsoft 
	 OLE DB Provider for ODBC Drivers</b>を選択します。 
	<dl>
		<dd><a class="image"><img alt="SQL odbc5.png" src="../images/How_to_set_up_the_SQL/SQL_odbc5.png" 
									 width="377" border="0" /></a></dd>
	</dl></li>
</ol>
<p><b>次へ</b>をクリックして、<b>接続</b>を選択します。「データソース名を使用する」の項目で<b>New_test</b>を選択して、「使用する初期カタログを入力します」の項目で<b>AdventureWorks2014</b>を選択します。 
 </p>
<ol>
	<li><dl>
		<dd><a class="image"><img alt="SQL odbc6.png" src="../images/How_to_set_up_the_SQL/SQL_odbc6.png" 
									 width="377" border="0" /></a></dd>
	</dl></li>
	<li><b>接続のテスト</b>ボタンをクリックすると、接続が成功している場合は、「接続のテストが成功しました」というメッセージが表示されます。</li>
	<li>OK をクリックします。ログインのウィンドウで「OK」をクリックするのみです。ダイアログの右のパネルに表示されている表を確認できます。 
	 
	<dl>
		<dd><a class="image"><img alt="SQL odbc7.png" src="../images/How_to_set_up_the_SQL/SQL_odbc7.png" 
									 width="476" border="0" /></a></dd>
	</dl></li>
	<li>テストで、左のインプットボックスに、SQLクエリを入力します。</li>
</ol>
<pre class="sql" style="font-family: monospace;">
<span style="color: #993333; font-weight: bold;">SELECT</span> 
&#160;&#160;&#160;&#160;e<span style="color: #66cc66;">.</span>BusinessEntityID<span style="color: #66cc66;">,</span> p<span style="color: #66cc66;">.</span>FirstName<span style="color: #66cc66;">,</span> p<span style="color: #66cc66;">.</span>MiddleName<span style="color: #66cc66;">,</span> p<span style="color: #66cc66;">.</span>LastName<span style="color: #993333; font-weight: bold;">
FROM</span> 
&#160;&#160;&#160;HumanResources<span style="color: #66cc66;">.</span>Employee <span style="color: #993333; font-weight: bold;">AS</span> e <span style="color: #993333; font-weight: bold;">INNER</span> <span style="color: #993333; font-weight: bold;">JOIN</span> 
&#160;&#160;&#160;Person<span style="color: #66cc66;">.</span>Person <span style="color: #993333; font-weight: bold;">AS</span> p <span style="color: #993333; font-weight: bold;">ON</span> p<span style="color: #66cc66;">.</span>BusinessEntityID <span style="color: #66cc66;">=</span> e<span style="color: #66cc66;">.</span>BusinessEntityID
</pre>
<ol>
	<li><b>結果のプレビュー</b>ボタン<a class="image"><img alt="SQL editor preview.png" 
												 src="../images/How_to_set_up_the_SQL/SQL_editor_preview.png" 
												 width="25" border="0" /></a>をクリックしてデータをプレビューします。プレビューが良ければ、<b>ワークシートにデータをインポート</b>ボタン<a 
	 class="image"><img alt="Button db Import Data.png" src="../images/How_to_set_up_the_SQL/Button_db_Import_Data.png" 
						 width="25" border="0" /></a>をクリックし、データをインポートします。次のようになります。 
	 
	<dl>
		<dd><a class="image"><img alt="SQL odbc8.png" src="../images/How_to_set_up_the_SQL/SQL_odbc8.png" 
									 width="481" border="0" /></a></dd>
	</dl></li>
</ol>
