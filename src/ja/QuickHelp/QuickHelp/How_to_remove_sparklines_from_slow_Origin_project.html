<h1 class="firstheading">FAQ-839 より多くのデータがインポートされるにつれてOriginが遅くなった場合はどうすればよいですか?</h1><p class='urlname' style='display: none'>Large-Dataset-Import-Project-Speedup</p>
<p class='faqID'>最終更新日：2022/02/20</p>
<p><br />
(<b>データ：ファイルからインポート</b>で)多くのファイルをインポートすると、インポートデータが増えるにつれてOriginの動作が遅くなることがあります。これはLabTalkまたはOriginCスクリプトを使用して多数のデータファイルをインポートする場合によく発生します。原因は下記が挙げられます。
</p>
<dl><dd><ul><li> ワークシート内の<a href="../../QuickHelp/QuickHelp/What_is_a_Sparkline_and_how_do_I_customize_it.html" title="クイックヘルプ：スパークラインとは何ですか、どのようにカスタマイズしますか?">スパークライン</a>（表示や非表示）</li>
<li> <b>再インポート</b>を有効にするために、ワークブックに記録されるファイル情報（インポート後に<a class="external text" href="../../UserGuide/UserGuide/The_Workbook_Organizer.html"><b>ワークブックオーガナイザ</b></a>にリストされているすべてのインポートされたファイルパスと名前を見つけることができます）</li>
<li> インポートの取り消しを有効にするメカニズム（OriginCまたはLabTalkを使用してループ内の複数のファイルをインポートする場合）</li></ul></dd></dl>
<p>動作を高速化するには、次の方法をお試しください。
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Turn_off_Sparklines"><span class="tocnumber">1</span> <span class="toctext">スパークラインを削除する</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Turn_off_Save_File_Info_in_Workbook"><span class="tocnumber">2</span> <span class="toctext">ワークブック内のファイル情報の保存をオフにする</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Turn_off_Undo_Temporarily"><span class="tocnumber">3</span> <span class="toctext">一時的に「元に戻す」機能をオフにする</span></a></li>
</ul>
</div>
<h3><a name="Turn_off_Sparklines"></a><span class="mw-headline">スパークラインを削除する</span></h3>
<dl><dd><a  class="image"><img alt="FAQ1070 turnoff sparkline.png" src="../images/How_to_remove_sparklines_from_slow_Origin_project/FAQ1070_turnoff_sparkline.png" width="652"  /></a></dd></dl>
<p><br />
<i><b>LabTalkスクリプトを実行している場合、</b></i> 
</p><p><a class="external text" href="../../XFunction/X-Function/Details_of_TreeNodes_in_Import_ASCII.html#Options">次のオプション</a>をインポートコードに追加します。
</p>
<pre class="lt" style="font-family:monospace;">options.<span style="color: #000080;">Sparklines</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span></pre>
<p><br />
<i><b>既にスパークラインを有効にしてデータファイルをインポートしている場合</b></i>
</p><p>次のスクリプトを実行してすべてのスパークライングラフを削除してから、プロジェクトを再保存します。
</p>
<pre class="lt" style="font-family:monospace;">StringArray sa;
doc <span style="color: #000080;">-</span>e P
<span style="color: #000000;">{</span>
	if <span style="color: #000000;">(</span><span style="color: #000080;">%</span>H <span style="color: #000080;">==</span> <span style="color: #ff00ff;">&quot;sparkline*&quot;</span><span style="color: #000000;">)</span>
		sa.<span style="color: #000080;">Add</span><span style="color: #000000;">(</span><span style="color: #000080;">%</span>H<span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span>
int nn <span style="color: #000080;">=</span> sa.<span style="color: #000080;">GetSize</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
for <span style="color: #000000;">(</span>int ii<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>; ii<span style="color: #000080;">&lt;=</span>nn; ii<span style="color: #000080;">++</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
	win <span style="color: #000080;">-</span>c <span style="color: #000080;">%</span><span style="color: #000000;">(</span>sa.<span style="color: #000080;">GetAt</span><span style="color: #000000;">(</span>ii<span style="color: #000000;">)</span><span style="color: #000080;">$</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span></pre>
<p><br />
</p>
<h3><a name="Turn_off_Save_File_Info_in_Workbook"></a><span class="mw-headline">ワークブック内のファイル情報の保存をオフにする</span></h3>
<dl><dd><a  class="image"><img alt="FAQ1070 turnoff save file info in wkb.png" src="../images/How_to_remove_sparklines_from_slow_Origin_project/FAQ1070_turnoff_save_file_info_in_wkb.png" width="493"  /></a></dd></dl>
<p><i>または、</i>
</p>
<dl><dd>システム変数<a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#N">@npi</a>を1に設定して、インポートファイル情報がワークブックに記録されないようにします。システム変数の値を変更する詳細な手順については、<a href="../../QuickHelp/QuickHelp/How_do_I_permanently_change_the_value_of_a_system_variable.html" title="クイックヘルプ: システム変数の値を永続的に変更するには？">このページ</a>を参照してください。</dd></dl>
<p><br />
<i><b>LabTalkのコードを実行している場合、</b></i> 
</p><p><a class="external text" href="../../XFunction/X-Function/Details_of_TreeNodes_in_Import_ASCII.html#Miscs">次のオプション</a>をインポートコードに追加します。
</p>
<pre class="lt" style="font-family:monospace;">options.<span style="color: #000080;">Miscs</span>.<span style="color: #000080;">SaveFileInfo</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span></pre>
<p><br />
<b>Note</b>:インポート情報を保存しないと、<a class="external text" href="../../GettingStarted/OriginLab/Import_Data.html#Re-Importing_Data_Files"><b>データ: 再インポート</b>メニュー</a>を使用してデータを再インポートすることはできません。「ファイル情報をワークブックに保存」をオフにするときは、このことに注意してください。
</p>
<h3><a name="Turn_off_Undo_Temporarily"></a><span class="mw-headline">一時的に「元に戻す」機能をオフにする</span></h3>
<p>インポートする前にシステム変数<a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#U.2CV.2CW">@UN</a>を0に設定し、後で復元します。 
</p><p><i><b>Origin Cのコードを実行している場合、</b></i>
</p><p>この例と同様の関数を使用します。
</p>
<pre class="lt" style="font-family:monospace;">void DoImport<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
    <span style="color: #008000;">// このクラスはシステム変数の古い値を格納しておきながら、</span>
    <span style="color: #008000;">// システム変数を新しい値に設定します。</span>
    <span style="color: #008000;">// クラスのインスタンスがスコープ外になると、</span>
    <span style="color: #008000;">// インスタンスは破棄され、</span>
    <span style="color: #008000;">// システム変数は以前の値に復元されます。</span>
 
   LTVarTempChange junk<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;@UN&quot;</span>, <span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;

   <span style="color: #008000;">// 完了するまで上記のクラスインスタンスと同じスコープですべてのインポートを実行します。</span>
<span style="color: #000000;">}</span></pre>
<p><i><b>LabTalkのコードを実行している場合、</b></i>
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 現在の@UNの値を保存します。</span>
int nOld <span style="color: #000080;">=</span> @UN;
<span style="color: #008000;">// 「元に戻す」機能を無効にします。</span>
@UN <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;

<span style="color: #008000;">// 完了まで全てのインポートを実行します。</span>
<span style="color: #008000;">// 最後に@UNを元の値に戻します。</span>
@UN <span style="color: #000080;">=</span> nOld;</pre>
<p><br />
</p>
<hr class='keywordshr'><p><span class='keywords'>キーワード：</span><span class='keywordsInput'>impasc、 遅い、インポートファイル、フリーズ、時間がかかる、データインポート、ASCIIインポート、プロジェクト、遅さ、OPJ、保存、 開く、スパークライン、LT、OC、インポート、複数、 多い、ファイル、ループ、速さ、メモリ、インポート、再インポート</span></p>




    