<h1 class="firstheading">FAQ-656 コマンドラインからOriginを起動するには？</h1><p class='urlname' style='display: none'>run-from-command-line</p>
<p class='faqID'>最終更新日:2017/7/17</p>
<p><br /> プログラムの自動化の方法の1つとして、コマンドラインでプログラムを実行し、式数を渡す方法があります。プログラムはそれらの引数を読み、適宜処理します。</p><p>ここでは、コマンドラインを使用してOriginを自動化する方法のサンプルを紹介します。<a class="external text" href="../../UserGuide/UserGuide/Adjusting_How_Origin_Starts_by_Modifying_the_Command_Line.html#Switchesswitch"><b>Originのコマンドラインスイッチ</b></a>を参照してください。</p>
<h4><a name="Command_Line"></a><span class="mw-headline">コマンドライン</span></h4>
<p>Originのコマンドライン含めるオプション(限定なし)：</p><ul><li>プロジェクト名またはウィンドウ名を指定します。パスを含め、ファイル拡張子を指定する必要があります。<dl><dd><code><i>&lt;Origin.EXE path and name&gt;</i> &quot;D:\My Documents\MyGraph.OGG&quot;</code></li></dd></dl>
<li>スタートアップで読み込むワークブックテンプレートを指定します。ファイルは<a class="external text" href="../../UserGuide/UserGuide/The_User_Files_Folder.html">ユーザファイルフォルダ</a>にあり、OTW拡張子である必要があります。パスとOTW拡張子は指定する必要ありません。2016年9月9日現在、テンプレート名はファイル拡張子を除いて8文字に制限されています。<dl><dd><code><i>&lt;Origin.EXE path and name&gt;</i> -tw MyWKB</code></li></dd></dl>
<li>構成ファイルを指定します。ファイルは<a class="external text" href="../../UserGuide/UserGuide/The_User_Files_Folder.html">ユーザファイルフォルダ</a>にあり、CNF拡張子である必要があります。パスとCNF拡張子は指定する必要ありません。<dl><dd><code><i>&lt;Origin.EXE path and name&gt;</i> -a MyCNF</code></li></dd>
<dd>構成ファイルはLabTalkコマンドを含めることができますが、大体はメニューコマンドやマクロ定義を含みます。追加のコマンドラインオプションは初期化ファイルとメニューレベルをコントロールします。便利ではありますが、それらのファイルを使用する場合ここで紹介しているサンプルより複雑になります。詳細情報は、 <a class="external text" href="CodeBuilderUsersGuide.chm::/CodeBuilder/Working_With_Files.html">ファイルとの操作</a>をご覧下さい。</li></dd></dl></ul><h4><a name="Automation"></a><span class="mw-headline">自動化</span></h4>
<p>Originには、どのコマンドラインの引数が通ったか読み込む方法はなく、自動化は開かれているファイルで制御する必要があります。このファイルは、特定の条件下で実行するようにOriginのマクロの定義、あるいは、特定のエベントで実行されるスクリプトを持つオブジェクトを含みます。</p><p>以下は各メソッドの操作の概要です。</p>
<h5><a name="Macro"></a><span class="mw-headline">マクロ</span></h5>
<p>(定義されている場合)AUTOEXECマクロは、Originを開始時および<b>ファイル：新規</b>または<b>ファイル：閉じる</b>メニューを選択したときに実行されます。AUTOEXECを定義する構成ファイルを通すことで、Originはスクリプトを実行することができます。スクリプトがOriginを閉じないまたは、AUTOEXECを再定義しない場合、ユーザは<b>ファイル：新規：プロジェクト</b>または<b>ファイル：閉じる</b>を選択してスクリプトを実行します。</p>
<h5><a name="Object_Event"></a><span class="mw-headline">オブジェクトイベント</span></h5>
<p>グラフィックオブジェクトを含むプロジェクトファイル、子ウィンドウ、テンプレートファイルを開くと、グラフィックオブジェクトは特定のイベントで実行するスクリプトを含めることができます。通常は、このスクリプトは「ウィンドウ作成」に設定され、より複雑な対話が可能です。</p>
<h4><a name="Example"></a><span class="mw-headline">例</span></h4>
<p>COMMAND.CNF というテキストファイルを作成し、ユーザファイルフォルダの中に保存します。テキストファイルには以下を含めます。</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">[</span>Main<span style="color: #000000;">]</span> string bkPath<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Curve Fitting\Linear Regression.OGW&quot;</span>; doc <span style="color: #000080;">-</span>o <span style="color: #000080;">%</span><span style="color: #000000;">(</span>bkPath<span style="color: #000080;">$</span><span style="color: #000000;">)</span>; string dataPath<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Curve Fitting\Sensor01.dat&quot;</span>; impasc fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>dataPath<span style="color: #000080;">$</span>; sec <span style="color: #000080;">-</span>p <span style="color: #0000dd;">3</span>; save <span style="color: #000080;">%</span>YSensor01.<span style="color: #000080;">opj</span>; type <span style="color: #000080;">-</span>b Automation complete.; <span style="color: #008000;">// 完全な自動化にはこの行は削除します</span> doc <span style="color: #000080;">-</span>s; exit;</pre>
<p>Windows Run(STARTで始まるコマンドプロンプト)または、コマンドシェルへのアプリケーションの呼び出しを使用して、Originを開始し、引数として上のファイルを渡します。例えば、以下のコマンドを実行します。</p>
<dl><dd><code><i>&lt;Origin.EXE path and name&gt;</i> -r run.section(command.cnf, Main)</code></dd></dl>
<p>このサンプルは、Originの分析テンプレートをロードし、サンプルデータをインポートして結果OPJを<i>&lt;UFF path&gt;</i>Sensor01.opjに保存します（run.sectionでパスを指定しないと、<a class="external text" href="../../UserGuide/UserGuide/The_User_Files_Folder.html">ユーザファイルフォルダ</a>が使用されます）。スクリプトが完了したことがメッセージに表示されます。OKをクリックすると、Originが終了します。</p>

<hr class='keywordshr'><p><span class='keywords'>キーワード:</span><span class='keywordsInput'>コマンドウィンドウ, LabTalk, Originのセットアップ</span></p>







    