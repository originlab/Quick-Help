<h1 class="firstheading">FAQ-782 エラーバーが大きく変更されたときにパラメータの標準誤差が変わらないのはなぜですか？</h1>
<p class="urlname" style="display: none;">Chi-Se-Remain</p>
<p class="faqID">最終更新: 2018/08/08</p>
<p>フィットパラメータの標準誤差（SE）および関連結果もついて、他のソフトウェアと互換性を保つために、<a class="external text" href="../../UserGuide/UserGuide/Settings_Tab_Upper_Panel.html#Advanced"><b>sqrt(補正カイ2乗値）のスケールエラー</b>のボックス</a>にデフォルトでチェックが入っています。このチェックボックスをオンにすると、エラーバーが大きく変更されても、パラメータのSEは変わりません。<a class="external text" href="../../UserGuide/UserGuide/Fitting_with_Errors_and_Weighting.html"><b>機械的、任意データセットあるいは直接重み付け</b></a>でデータをフィットする場合は、パラメータの標準誤差が重みに影響するため、このオプションのチェックを外して無効にすることをお勧めします。</p>
<p><b style="font-weight: bold;">sqrt(補正カイ2乗値）のスケールエラー</b>オプションは、</p>
<dl>
<dd>
<ul>
<li><b style="font-weight: bold;">NLFit</b>ダイアログの<a class="external text" href="../../UserGuide/UserGuide/Settings_Tab_Upper_Panel.html#Advanced">詳細タブ：フィット制御</a> または、</li>
<li><b style="font-weight: bold;">線形多重回帰</b>ダイアログの<a class="external text" href="../../UserGuide/UserGuide/Linear_Regression_Dialog.html#Fit_Control">フィット制御</a>タブにあります。</li>
</ul>
</dd>
</dl>
<table class="note">
<tr>
<td><b style="font-weight: bold;">Note:</b>
<p>このチェックボックスは、フィットしたパラメータのSEにのみ影響します。フィッティング処理やパラメータ値には全く影響しません。</p>
</td>
</tr>
</table>
<h2><a name="Simple_theory_explanation" id="Simple_theory_explanation"></a><span class="mw-headline">簡単な理論の説明</span></h2>
<p>以下では、<i>j</i>番目のフィットパラメータのSEが、<b>sqrt(補正カイ2乗値）のスケールエラー</b>のチェックの有無によってどのように変化するかを議論します。簡略化のため、エラーバー<img src="../images/Why_Parameters_SE_remains_unchanged_when_error_bar_is_scaled/math-bf1c4cadc58df0f89c72d60e09326611.png" title="\sigma_{yi}" alt="\sigma_{yi}" class="tex" border="0">は定数<i>k</i>を掛けたものであると仮定します。より詳細なアルゴリズムと解説については、<a class="external text" href="../../UserGuide/Category/Theory_of_Nonlinear_Curve_Fitting.html#Parameter_Standard_Errors">非線形曲線フィットの理論</a>を参照してください。</p>
<p>デフォルトでは、<b>sqrt(補正カイ2乗値）のスケールエラー</b>が有効のとき、パラメータ<img src="../images/Why_Parameters_SE_remains_unchanged_when_error_bar_is_scaled/math-3a69d07d2adf42061942779219a83d19.png" title="\hat \theta" alt="\hat \theta" class="tex" border="0">の分散 - 共分散行列<img src="../images/Why_Parameters_SE_remains_unchanged_when_error_bar_is_scaled/math-0d61f8370cad1d412f80b84d143e1257.png" title="C" alt="C" class="tex" border="0">は<img src="../images/Why_Parameters_SE_remains_unchanged_when_error_bar_is_scaled/math-a51470e10c536e93611fecd435c07013.png" title="F&amp;apos;F" alt="F&amp;apos;F" class="tex" border="0">と<img src="../images/Why_Parameters_SE_remains_unchanged_when_error_bar_is_scaled/math-10e16c6a764d367ca5077a54bf156f7e.png" title="\sigma^2" alt="\sigma^2" class="tex" border="0">に依存します。</p>
<table class="formula">
<tr>
<th><img src="../images/Why_Parameters_SE_remains_unchanged_when_error_bar_is_scaled/math-712b1e66b51431627b0566c6493c9d53.png" title="C=(F&amp;apos;F)^{-1}\sigma^2" alt="C=(F&amp;apos;F)^{-1}\sigma^2" class="tex" border="0"></th>
<td>
<p>(1)</p>
</td>
</tr>
</table>
<p>ここで、<img src="../images/Why_Parameters_SE_remains_unchanged_when_error_bar_is_scaled/math-800618943025315f869e4e1f09471012.png" title="F" alt="F" class="tex" border="0">は、<i>i</i>行と<i>j</i>列の編微分の行列です。</p>
<table class="formula">
<tr>
<th><img src="../images/Why_Parameters_SE_remains_unchanged_when_error_bar_is_scaled/math-fdcde880333e1fcb4143a0047bcb658d.png" title="F_{ij}=\frac{\partial f(X, \boldsymbol{\theta})}{\sigma _{yi}\partial \theta _j}" alt="F_{ij}=\frac{\partial f(X, \boldsymbol{\theta})}{\sigma _{yi}\partial \theta _j}" class="tex" border="0"></th>
<td>
<p>(2)</p>
</td>
</tr>
</table>
<p>そして、<img src="../images/Why_Parameters_SE_remains_unchanged_when_error_bar_is_scaled/math-10e16c6a764d367ca5077a54bf156f7e.png" title="\sigma^2" alt="\sigma^2" class="tex" border="0">は平均残留分散であり、これは補正カイ二乗によって推定されます。</p>
<table class="formula">
<tr>
<th><img src="../images/Why_Parameters_SE_remains_unchanged_when_error_bar_is_scaled/math-b54f8fb4db112d83dc2ea2282d3ac805.png" title="\sigma^2 = \sum_{i=1}^n \frac{1}{{\sigma_{yi}}^2} \left[Y_i-f(X, \boldsymbol{\theta}) \right ]^2/df_{Error}" alt="\sigma^2 = \sum_{i=1}^n \frac{1}{{\sigma_{yi}}^2} \left[Y_i-f(X, \boldsymbol{\theta}) \right ]^2/df_{Error}" class="tex" border="0"></th>
<td>
<p>(3)</p>
</td>
</tr>
</table>
<p><img src="../images/Why_Parameters_SE_remains_unchanged_when_error_bar_is_scaled/math-cb0e17d96e58d55d1eb06dc1b14b7a7b.png" title="\theta_j" alt="\theta_j" class="tex" border="0">のSEは、行列の主対角値の平方根<img src="../images/Why_Parameters_SE_remains_unchanged_when_error_bar_is_scaled/math-0d61f8370cad1d412f80b84d143e1257.png" title="C" alt="C" class="tex" border="0">です。</p>
<table class="formula">
<tr>
<th><img src="../images/Why_Parameters_SE_remains_unchanged_when_error_bar_is_scaled/math-6b1dadac7ac34439ceb90c5f051afeab.png" title="\sigma_{\theta_j}=\sqrt{c_{jj}}\,\!" alt="\sigma_{\theta_j}=\sqrt{c_{jj}}\,\!" class="tex" border="0"></th>
<td>
<p>(4)</p>
</td>
</tr>
</table>
<p>エラーバー<img src="../images/Why_Parameters_SE_remains_unchanged_when_error_bar_is_scaled/math-bf1c4cadc58df0f89c72d60e09326611.png" title="\sigma_{yi}" alt="\sigma_{yi}" class="tex" border="0">は、kの因子により変わる場合、<img src="../images/Why_Parameters_SE_remains_unchanged_when_error_bar_is_scaled/math-a51470e10c536e93611fecd435c07013.png" title="F&amp;apos;F" alt="F&amp;apos;F" class="tex" border="0">と<img src="../images/Why_Parameters_SE_remains_unchanged_when_error_bar_is_scaled/math-98e76a752712c23c971df5a1d327a27a.png" title="sigma^2" alt="sigma^2" class="tex" border="0">の両方は因子<img src="../images/Why_Parameters_SE_remains_unchanged_when_error_bar_is_scaled/math-82095e9f7da27f5ee19fb1c82d1be1d3.png" title="1/k^2" alt="1/k^2" class="tex" border="0">によって変わり、kはSEの計算を打ち消します。したがって、エラーバーがスケールされたときに、SEは変わりません。</p>
<p><b style="font-weight: bold;">sqrt(補正カイ2乗値）のスケールエラー</b>がチェックされていない場合は、 <img src="../images/Why_Parameters_SE_remains_unchanged_when_error_bar_is_scaled/math-bf1c4cadc58df0f89c72d60e09326611.png" title="\sigma_{yi}" alt="\sigma_{yi}" class="tex" border="0">は分散 - 共分散行列を計算する際に除外されることを意味し、行列<img src="../images/Why_Parameters_SE_remains_unchanged_when_error_bar_is_scaled/math-0d61f8370cad1d412f80b84d143e1257.png" title="C" alt="C" class="tex" border="0">は<img src="../images/Why_Parameters_SE_remains_unchanged_when_error_bar_is_scaled/math-de1cb387b7e4df1801ac403d6d695c4d.png" title="(F&amp;apos;F)^{-1}" alt="(F&amp;apos;F)^{-1}" class="tex" border="0">のみに依存します。</p>
<table class="formula">
<tr>
<th><img src="../images/Why_Parameters_SE_remains_unchanged_when_error_bar_is_scaled/math-da354fed6c7186ffd18d96073171c7ef.png" title="C=(F&amp;apos;F)^{-1}" alt="C=(F&amp;apos;F)^{-1}" class="tex" border="0"></th>
<td>
<p>(5)</p>
</td>
</tr>
</table>
<p>SEはこのようになります</p>
<table class="formula">
<tr>
<th><img src="../images/Why_Parameters_SE_remains_unchanged_when_error_bar_is_scaled/math-b723811c7c0ffbc5194ecda68d218588.png" title="\sigma&amp;apos;_{\theta_j}=\frac{\sigma_{\theta_j}}{\sigma}" alt="\sigma&amp;apos;_{\theta_j}=\frac{\sigma_{\theta_j}}{\sigma}" class="tex" border="0"></th>
<td>
<p>(6)</p>
</td>
</tr>
</table>
<p>エラーバーに<i>k</i>を掛けた場合、 SEも<i>k</i>倍になります。</p>
<p>モデルをフィットした後、補正カイ二乗値を使って、重みが真のYエラーを表現しているかどうかを確認できます。<b>sqrt(補正カイ二乗値)のスケールエラー</b>オプションにチェックを入れた時と外した時とで、パラメータの標準誤差が大きく異なる場合は、重みは真のYエラーを表現していません。詳細は、<a class="external text" href="../../QuickHelp/QuickHelp/Why_is_my_Reduced_Chi-Sqr_value_very_different_from_1.html">このページ</a> をご覧下さい。</p>
<h2><a name="Quick_Example" id="Quick_Example"></a><span class="mw-headline">クイックサンプル</span></h2>
<p>以下の簡単なサンプルで、<b>sqrt(補正カイ二乗値)のスケールエラー</b>がフィットパラメータのSEにのみ影響を与えることを確認します。</p>
<ol>
<li><a href="#Sample_data">このデータ</a>をコピーしてワークシートに貼り付けます。</li>
<li>列Cで右クリックして、<b>列XY属性の設定：Yエラーバーエラー</b>を選択します。</li>
<li>ワークシートのすべての列を選択し、<b>解析：フィット：非線形曲線フィット</b>を選択して、ダイアログを開きます。</li>
<li><b style="font-weight: bold;">関数</b>ドロップダウンリストから、Gaussを選択します。<b>詳細</b>タブを選択して、<b>フィット制御</b>のブランチを開きます。<b>sqrt(補正カイ二乗値)のスケールエラー</b>にチェックが付いていることを確認します。<br />
<a class="image"><img alt="Scale Error with sqrt 001.png" src="../images/Why_Parameters_SE_remains_unchanged_when_error_bar_is_scaled/Scale_Error_with_sqrt_001.png" width="732" height="215" border="0"></a><br />
<b>フィット</b>をクリックして、パラメータ値とSEが含まれるフィットレポートを作成します。<br />
<a class="image"><img alt="Scale Error with sqrt 002.png" src="../images/Why_Parameters_SE_remains_unchanged_when_error_bar_is_scaled/Scale_Error_with_sqrt_002.png" width="446" height="140" border="0"></a></li>
<li>緑の鍵のアイコンをクリックして、<b>パラメータを変更</b>を選択します。 <b>NLFit</b>ダイアログが開いたら、<b>sqrt(補正カイ二乗値)のスケールエラー</b>のチェックを外します。<br />
<a class="image"><img alt="Scale Error with sqrt 003.png" src="../images/Why_Parameters_SE_remains_unchanged_when_error_bar_is_scaled/Scale_Error_with_sqrt_003.png" width="732" height="215" border="0"></a><br />
<b>フィット</b>ボタンをクリックします。パラメータのSEは変化しましたが、フィット値は変化していません。<br />
<a class="image"><img alt="Scale Error with sqrt 004.png" src="../images/Why_Parameters_SE_remains_unchanged_when_error_bar_is_scaled/Scale_Error_with_sqrt_004.png" width="449" height="139" border="0"></a></li>
<li>今度はエラーをスケーリングして、<b>sqrt(補正カイ二乗値)のスケールエラー</b>のチェックの有無がSEにどのような影響があるかを見てみましょう。<b>パラメータを変更</b>から<b>NLFit</b>ダイアログを開きます。<b>sqrt(補正カイ二乗値)のスケールエラー</b>のチェックを付けフィットを実行してから、鍵のアイコンのメニューから<b>再計算モード：自動</b>に変更します。</li>
<li>エラー列Cを10倍します。レポートシートが自動で更新されます。パラメータのSEは、操作4で得られた結果と同じことがわかります。<br />
<a class="image"><img alt="Scale Error with sqrt 005.png" src="../images/Why_Parameters_SE_remains_unchanged_when_error_bar_is_scaled/Scale_Error_with_sqrt_005.png" width="443" height="137" border="0"></a></li>
<li><b style="font-weight: bold;">パラメータを変更</b>から、再度<b>NLFit</b>ダイアログを開きます。<b>sqrt(補正カイ二乗値)のスケールエラー</b>のチェックを外します。<b>フィット</b>ボタンをクリックします。操作5で得られたSEの10倍の値が得られます。<br />
<a class="image"><img alt="Scale Error with sqrt 006.png" src="../images/Why_Parameters_SE_remains_unchanged_when_error_bar_is_scaled/Scale_Error_with_sqrt_006.png" width="446" height="138" border="0"></a></li>
</ol>
<h5><a name="Sample_data" id="Sample_data"></a><span class="mw-headline">サンプルデータ</span></h5>
<table class="simple" width="120">
<tr>
<th>X</th>
<th>Y</th>
<th>Y Error</th>
</tr>
<tr>
<td>11</td>
<td>5</td>
<td>0.4472</td>
</tr>
<tr>
<td>13</td>
<td>10</td>
<td>0.6324</td>
</tr>
<tr>
<td>15</td>
<td>19</td>
<td>0.8718</td>
</tr>
<tr>
<td>17</td>
<td>27</td>
<td>1.0392</td>
</tr>
<tr>
<td>19</td>
<td>49</td>
<td>1.4</td>
</tr>
<tr>
<td>21</td>
<td>65</td>
<td>1.6124</td>
</tr>
<tr>
<td>23</td>
<td>77</td>
<td>1.755</td>
</tr>
<tr>
<td>25</td>
<td>80</td>
<td>1.7888</td>
</tr>
<tr>
<td>27</td>
<td>77</td>
<td>1.755</td>
</tr>
<tr>
<td>29</td>
<td>59</td>
<td>1.5362</td>
</tr>
<tr>
<td>31</td>
<td>44</td>
<td>1.3266</td>
</tr>
<tr>
<td>33</td>
<td>24</td>
<td>0.9798</td>
</tr>
<tr>
<td>35</td>
<td>11</td>
<td>0.6634</td>
</tr>
<tr>
<td>37</td>
<td>14</td>
<td>0.7484</td>
</tr>
<tr>
<td>39</td>
<td>4</td>
<td>0.4</td>
</tr>
</table>
<hr class="keywordshr" align="center">
<p><span class="keywords">キーワード:</span><span class="keywordsInput">フィット、標準誤差、補正カイ二乗値、誤差分散</span></p>
