<h1 class="firstheading">FAQ-705 セルのブロックをコピーするには?</h1>

  <p class='urlname' style='display: none'>Copy_Range_Cells</p>

  <p class='faqID'>最終更新日:2015/06/16</p>

  <p>LabTalkには、セルのブロックをプログラミングでコピーするいくつかの方法があります（<a class="external text" href="../../XFunction/X-Function/Copydata.html">copydata Xファンクション</a>など）。スピードと柔軟性において、<a class="external text" href="../../LabTalk/LabTalk/Range_Notation.html#Option_Switch_-vOption_Switches">range -v オプションスイッチ</a>を使用するのが良いでしょう。-vスイッチを使用して、単位値ブロックを範囲とし、-vを使用して定義した他の範囲に値を割り当てます。ブロックは同じ形状、要素の数である必要はありません（割り当てる前に目的のブロックが存在している必要があります）。</p>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">// 新しいブックにサンプルデータをインポート</span>
fname<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;\Samples\Statistics\abrasion_raw.dat&quot;</span>; 
newbook;
impasc;
<span style="color: #008000;">// 列A、Bの前列をブロックとする</span>
range <span style="color: #000080;">-</span>v ra1 <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">[</span><span style="color: #0000dd;">1</span><span style="color: #000000;">]</span><span style="color: #000000;">:</span><span style="color: #0000dd;">2</span><span style="color: #000000;">[</span>end<span style="color: #000000;">]</span>;
<span style="color: #008000;">// 新しいシートを作成</span>
newsheet;
<span style="color: #008000;">// ra1 ブロックサイズを使用してブロックを1列として定義</span>
range <span style="color: #000080;">-</span>v ra2 <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">[</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span>ra1.<span style="color: #000080;">GetSize</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">]</span>;
<span style="color: #008000;">// 最初のブロックの値を2番目のブロックに割り当て</span>
ra2 <span style="color: #000080;">=</span> ra1;
col<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span><span style="color: #000000;">[</span>L<span style="color: #000000;">]</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Combined;
</pre>

  <p>range -v の他の利点は、新しいセルのブロックにコピーする際、データでの数学操作を実行できることです。</p>
  <pre class="lt" style="font-family:monospace;">
range <span style="color: #000080;">-</span>v rs<span style="color: #000080;">=</span><span style="color: #000000;">[</span>Book2<span style="color: #000000;">]</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">3</span>;
range <span style="color: #000080;">-</span>v rt<span style="color: #000080;">=</span><span style="color: #000000;">[</span>Book1<span style="color: #000000;">]</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">3</span>;
 
rt<span style="color: #000080;">=</span>rs<span style="color: #000080;">*</span><span style="color: #0000dd;">10</span> <span style="color: #008000;">//rsの要素に10を掛け、rtに出力</span>
</pre>
  <hr class='keywordshr'>


  <p><span class='keywords'>キーワード:</span><span class='keywordsInput'>コピー, copydata, 範囲, 値の設定, 数学</span></p>

  <p class="version">必要なOriginのバージョン:9.1SR0</p>
