<h1 class="firstheading">FAQ-428 データをインポートした後にLabTalkスクリプトを実行するには？</h1><p class='urlname' style='display: none'>run-script-after-import</p>
<p class='faqID'>最終更新日: 2019/1/6</p>
<p><br />
データの後処理（計算、フォーマット化、解析、作図）をインポートした後、LabTalkのスクリプトを実行するオプションはいくつかあります。
</p>
<ul><li> Origin 2016から、<b>データ：ファイルからインポート：ASCII、CSV、SPCまたはExce</b>lを選択して<b>ファイルをインポート</b>ダイアログを開き、LabTalkスクリプトを設定するオプションで追加ことが出来、さらに<a class="external text" href="../../UserGuide/UserGuide/Dialog_Themes.html">ダイアログテーマ</a>として保存することができます。</li>
<li> 別のオプションでは、LabTalkスクリプトを直接ワークシートに保存します。LabTalkスクリプトを<a class="external text" href="../../UserGuide/UserGuide/Script_tab_of_Worksheet_Properties.html"><b>スクリプト</b>タブ<b>ワークシートプロパティ</b>ダイアログ </a>に入力して、<b>After Import</b>を実行できます。この方法では、ファイルタイプによらず、インポートしたデータで実行できます。ワークブックやプロジェクトファイルにスクリプトを保存できるので、大変便利です。</li>
<li> 通常のファイルタイプについて、<a class="external text" href="../../UserGuide/UserGuide/Introduction_to_Import_Filters_Manager.html"><b>iwfilter</b>ダイアログボックス</a>を使って、ドラッグ&amp;ドロップでインポートするフィルタにスクリプトを追加できます。サンプルとしてExcelインポートを取り上げます。<b>環境設定：インポートマネージャー</b>   を選択し、ダイアログの<b>フィルタ</b>列から<b>Excel</b>を選択します。ドラッグ&amp;ドロップのサポートのチェックが付いていることを確認します。  <b>編集</b>ボタンをクリックして、<b>Import and Export: iwfilter</b> ダイアログを開き、<b><b>一般のインポート設定</b></b>の項目にある、<b><b>インポート後に実行するLabTalkスクリプト</b></b>にLabTalkスクリプトを入力します。<b>名前を付けて保存</b>のボタンをクリックして、 <b>&lt;Origin User File Folder&gt;\Filters</b>のパスにファイルを保存します。インポートフィルタを再利用するには、ExcelファイルをOriginにドラッグ&amp;ドロップします。すると、<b><b>フィルタを選択してください</b></b>というダイアログが開きます。保存したフィルタを選択して、<b>OK</b>をクリックします。「インポート後に実行するLabTalkスクリプト」ボックスにあるスクリプトが自動で実行されます。(下記の <b>Note1</b>を参照ください)。この手順で追加されたインポートフィルタは、<b>ファイル：開</b>くダイアログからのインポート時、または<a class="external text" href="../../UserGuide/UserGuide/Batch_Processing.html">バッチ処理</a> のインポート操作中にも使用できます（batchProcessダイアログ自体にスクリプト作成オプションがあります）。</li>
<li> <a class="external text" href="../../UserGuide/UserGuide/Import_Wizard_Save_Filters_Page_(All_Data_Types).html">インポートフィルタの保存</a>と<a class="external text" href="../../UserGuide/UserGuide/Import_Wizard_Advanced_Options_Page.html">インポートウィザードでインポート後のスクリプト</a>の追加も可能です。このオプションはASCIIファイルをインポートする際に有効であるが、複雑な構造のファイルタイプの場合、バイナリデータと「ユーザ定義」データ形式に使うことができます。</li></ul>
<p><br />
<b>Note 1</b>:この操作は<b>Famos</b>, <b>MDF</b>, <b>pClamp</b> のインポートでは行えません。<br />
データをインポートする際には、Iwfilterダイアログボックスの<b>一般のインポート設定</b>セクションにある<b>Open XF ダイアログ</b>ボックスをチェックして、関連するインポートダイアログを開くことができます。
</p>
<hr class='keywordshr'><p><span class='keywords'>キーワード:</span><span class='keywordsInput'>LabTalkスクリプト 後処理, データのインポート, インポートフィルタ, iwfilter, ワークシートスクリプト, ワークシートプロパティ, バッチ処理</span></p>




    