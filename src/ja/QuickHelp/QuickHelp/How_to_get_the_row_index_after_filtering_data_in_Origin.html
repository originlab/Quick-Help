<h1 class="firstheading">FAQ-1059 Originでデータをフィルタリングした後、表示セルの行番号と値を取得するには？</h1>
<p class='urlname' style='display: none'>Get-Visible-Row-Index</p>
<p class='faqID'>最終更新日：2020/6/17</p>
<p>Originでデータをフィルタリングした後、表示セルの行番号と値を取得したいというお問い合わせがよくあります。例えば、下の画像を参照してください。 <a class="image"><img alt="GetNextVisibleRow1.png" src="../images/How_to_get_the_row_index_after_filtering_data_in_Origin/GetNextVisibleRow1.png" width="541" /></a></p>
<p><b>wks.GetNextVisibleRow(N)</b> は、Origin 2016から追加された<a class="external text" href="https://www.originlab.com/doc/LabTalk/ref/Wks-obj#Methods" target="_blank">ワークシートプロパティ</a>で、与えられた行<b>N</b>の次の表示行番号を返します。</p>
<pre>
   例えば、<b>wks.GetNextVisibleRow(0)=</b> は、最初の表示行番号<b>38</b>を返します。 
</pre>
<p><b>col(Name)[wks.GetNextVisibleRow(N)]</b> は、<b>N</b>行目の後の指定された列の次の表示値を参照します。例えば、上図において列式に、<b>D/C[wks.GetNextVisibleRow(i)]</b> と入力して、列Dの値を次に表示される行のC値で除算し、ニューヨーク州の陽性ケースの日次増加率を取得します。以前のバージョンでは、<b>col(D)/col(C)[wks.GetNextVisibleRow(i)]</b>とします。</p>
<p>Note:</p>
<ul>
<li>Wks.GetNextVisibleRow(1)=, .... wks.GetNextVisibleRow(37)= は、上図の例では、1-37行の後の最初の表示行である38を返します。</li>
<li>テキスト列には、col(Name)[wks.GetNextVisibleRow(N)]$ を使用します。</li>
<li>col(Name)[N]/col(Name)[N]$ は、行が非表示であるかどうかに関係なく、<b>N番目</b>の行の値/テキストを参照します。行が非表示の場合、欠損値が返されます。</li>
</ul>
<p><br /></p>
<hr class='keywordshr' />
<p><span class='keywords'>キーワード:</span><span class='keywordsInput'>フィルタ, 行番号, 表示行</span></p>
<p><br /></p>
