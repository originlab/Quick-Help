<h1 class="firstheading">FAQ-633 2点間を結んだ線を引き、傾きとy切片を求めるには？</h1><p class='urlname' style='display: none'>Two-Points-Slope</p>
<p class='faqID'>最終更新日:2015/02/04</p>
<p>このLabTalkスクリプトは2つのデータポイントをグラフィカルに選択できます。2点選択すると、間に線が引かれ、傾きとy切片の値がグラフ上のテキストラベルに表示されます。
</p>
<pre class="lt" style="font-family:monospace;">def EndToolbox <span style="color: #000000;">{</span>
   <span style="color: #000080;">%</span>A<span style="color: #000080;">=</span>getpts.<span style="color: #000080;">xdata</span><span style="color: #000080;">$</span>;
   <span style="color: #000080;">%</span>B<span style="color: #000080;">=</span>getpts.<span style="color: #000080;">data</span><span style="color: #000080;">$</span>;
   slope<span style="color: #000080;">=</span><span style="color: #000000;">(</span><span style="color: #000080;">%</span>B<span style="color: #000000;">(</span><span style="color: #000080;">%</span>A<span style="color: #000000;">[</span><span style="color: #0000dd;">2</span><span style="color: #000000;">]</span><span style="color: #000000;">)</span><span style="color: #000080;">-%</span>B<span style="color: #000000;">(</span><span style="color: #000080;">%</span>A<span style="color: #000000;">[</span><span style="color: #0000dd;">1</span><span style="color: #000000;">]</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span><span style="color: #000080;">/</span><span style="color: #000000;">(</span><span style="color: #000080;">%</span>A<span style="color: #000000;">[</span><span style="color: #0000dd;">2</span><span style="color: #000000;">]</span><span style="color: #000080;">-%</span>A<span style="color: #000000;">[</span><span style="color: #0000dd;">1</span><span style="color: #000000;">]</span><span style="color: #000000;">)</span>;
   yintercept<span style="color: #000080;">=</span><span style="color: #000080;">%</span>B<span style="color: #000000;">(</span><span style="color: #000080;">%</span>A<span style="color: #000000;">[</span><span style="color: #0000dd;">2</span><span style="color: #000000;">]</span><span style="color: #000000;">)</span><span style="color: #000080;">-</span>slope<span style="color: #000080;">*%</span>A<span style="color: #000000;">[</span><span style="color: #0000dd;">2</span><span style="color: #000000;">]</span>;
   <span style="color: #000080;">%</span>Z<span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;slope=$(slope)
yintercept=$(yintercept)&quot;</span>;
   label <span style="color: #000080;">-</span>p <span style="color: #0000dd;">10</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">-</span>s <span style="color: #000080;">-</span>sa <span style="color: #000080;">-</span>n Ltext <span style="color: #000080;">%</span>Z;
   Ltext.<span style="color: #000080;">background</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
   xb1<span style="color: #000080;">=</span><span style="color: #000080;">%</span>A<span style="color: #000000;">[</span><span style="color: #0000dd;">1</span><span style="color: #000000;">]</span>;xb2<span style="color: #000080;">=</span><span style="color: #000080;">%</span>A<span style="color: #000000;">[</span><span style="color: #0000dd;">2</span><span style="color: #000000;">]</span>;yb1<span style="color: #000080;">=</span><span style="color: #000080;">%</span>B<span style="color: #000000;">(</span><span style="color: #000080;">%</span>A<span style="color: #000000;">[</span><span style="color: #0000dd;">1</span><span style="color: #000000;">]</span><span style="color: #000000;">)</span>;yb2<span style="color: #000080;">=</span><span style="color: #000080;">%</span>B<span style="color: #000000;">(</span><span style="color: #000080;">%</span>A<span style="color: #000000;">[</span><span style="color: #0000dd;">2</span><span style="color: #000000;">]</span><span style="color: #000000;">)</span>;
   draw <span style="color: #000080;">-</span>n Lline <span style="color: #000080;">-</span>l <span style="color: #000000;">{</span>xb1,yb1,xb2,yb2<span style="color: #000000;">}</span>;  
   Lline.<span style="color: #000080;">color</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>;  <span style="color: #008000;">// 色を赤に設定</span>
   delete <span style="color: #000080;">-</span>v xb1;delete <span style="color: #000080;">-</span>v xb2;delete <span style="color: #000080;">-</span>v yb1;delete <span style="color: #000080;">-</span>v yb2;
   delete <span style="color: #000080;">-</span>v slope;delete <span style="color: #000080;">-</span>v yintercept;
   doc <span style="color: #000080;">-</span>uw;  <span style="color: #008000;">// ウィンドウリフレッシュ</span>
<span style="color: #000000;">}</span>
getpts <span style="color: #0000dd;">2</span>; <span style="color: #008000;">// 2点選択のためにデータリーダを使用</span></pre>
<p>このスクリプトはスクリプトウィンドウで実行するか、OGSファイルを置いてツールバーボタンに結び付けます。
</p>
<table class="note">

<tr>
<td><b>Note:</b>このスクリプトは、データセットを関数として使用し、与えられたX値に対応するY値を検索します。複数のX値がある場合、最初に検索されたX値に対応するY値が返されます。
</td></tr></table>

<hr class='keywordshr'><p><span class='keywords'>キーワード:</span><span class='keywordsInput'>LabTalk, 線形フィット</span></p>





    