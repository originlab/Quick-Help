<h1 class="firstheading">FAQ-870 ファイル名を拡張子なしで列コメントに抽出するにはどうしたらよいでしょうか？</h1><p class='urlname' style='display: none'>extract-filename-without-extension</p>
<p class='faqID'>最終更新：2019/01/06</p>
<h2><a name="Origin_2017_SR2_and_higher"></a><span class="mw-headline">Origin 2017 SR2 以降</span></h2>
<p>Origin 2017 SR2から、どのインポートツールにおいても、<b>ワークシート/ブックの名前を付ける/変更する</b>の項目にある、<b>ワークシートのコメントにファイル名を付加</b>にチェックをつけ、<b>ファイル名の付加にファイルパスを含める</b>のチェックを外すと、拡張子なしのファイル名を列コメントに抽出できます。 
</p>
<dl><dd> <a class="image"><img alt="Qh870 1.png" src="../images/How_to_extract_file_name_without_extension_to_column_comments/300px-Qh870_1.png" width="401"></a></dd></dl>
<table class="note">
<tr>
<td><b>Note:</b>.拡張子を含めたファイル名を列コメントに付加したい場合、<a class="external text" href="../../UserGuide/UserGuide/Set_System_Variables_Dialog_Box.html"><b>システム変数を設定</b>ダイアログ</a>を使用します。メニューから<b>環境設定：システム変数</b>を選択してダイアログを開きます。IFEを<b>0</b>にセットします。
</td></tr></table>
<h2><a name="Origin_2017_SR1_and_older"></a><span class="mw-headline">Origin 2017 SR1 以前</span></h2>
<p>古いバージョンでは、「列コメントにファイル名を付加」にチェックがついている場合デフォルトで拡張子を含めます。したがって、インポートウィザードを使用してデータをインポートする必要があり、ファイル拡張子のないファイル名を指定する新しいパラメータをブックに作成し、パラメータ行から列コメントにファイル名をコピーします。 
</p>
<ol><li> <b>データ：ファイルからインポート：インポートウィザード</b>を選択します。</li>
<li> <b>データソース</b>で、データを選択します。<b>インポートモード</b>を指定します。<b>進む</b>をクリックします。</li>
<li> ヘッダ行ページで必要に応じてヘッダの設定をします。<b>進む</b>をクリックします。</li>
<li> <b>ファイル名とファイルヘッダからの変数抽出</b>で、<b>区切りを使って変数名とその値の位置を指定する</b>にチェックをつけ、<b>各変数のユーザパラメータの行を作成する</b>にチェックをつけて、<b>進む</b>をクリックします。 
<dl><dd> <a class="image"><img alt="Qh870 2.png" src="../images/How_to_extract_file_name_without_extension_to_column_comments/350px-Qh870_2.png" width="383"></a></dd></dl></li>
<li> 次のページでは、上部パネルに拡張子あり、なしのファイル名がリストで表示されます。<b>変数</b>グループで、追加したい行を選択し、<b>変数名を入力</b>を選択して、名前を指定します。<b>追加</b>をクリックします。これで、下部パネルで新しい変数を指定できました。<b>進む</b>をクリックします。
<dl><dd> <a class="image"><img alt="Qh870 3.png" src="../images/How_to_extract_file_name_without_extension_to_column_comments/450px-Qh870_3.png" width="701"></a></dd></dl></li>
<li> データ列をカスタマイズし、表示されるように列の設定をスキップします。フィルタの保存ページまで<b>進む</b>ボタンをクリックします。</li>
<li> <b>フィルタの保存</b>ページを開いたら、このインポート設定を保存して、同様のファイルをインポートする際に繰り返し同じ操作をしなくていいようにします。<b>フィルタを保存する</b>にチェックをつけ、<b>ファイル名</b>を指定します。 </li>
<li> 新しいパラメータ行に入力されたファイル名をコメント行に移動するには、<b>フィルタ詳細オプションの指定</b>にチェックをつけます。<b>進む</b>をクリックします。</li>
<li> <b>全てのファイルをインポートした後に実行するスクリプト</b>で、以下のスクリプトを入力して、<b>完了</b>をクリックします。ここで、<i>fname</i>は、新しく作成したパラメータ行の名前です。 </li></ol>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// このループの目的は、1）fname行の内容をコメント行に移動し、2）fname行を非表示にすることです</span> loop <span style="color: #000000;">(</span>j,<span style="color: #0000dd;">1</span>,wks.<span style="color: #000080;">ncols</span><span style="color: #000000;">)</span> <span style="color: #000000;">{</span> wcol<span style="color: #000000;">(</span>j<span style="color: #000000;">)</span><span style="color: #000000;">[</span>C<span style="color: #000000;">]</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span>wcol<span style="color: #000000;">(</span>j<span style="color: #000000;">)</span><span style="color: #000000;">[</span>fname<span style="color: #000000;">]</span><span style="color: #000080;">$</span>; <span style="color: #008000;">//fnameをコメントに移動</span> <span style="color: #000000;">}</span> wks.<span style="color: #000080;">UserParam1</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>; <span style="color: #008000;">//fname行を非表示にする</span></pre>
<p><br />
このフィルタ設定を再度使用するには、<b>インポートウィザード</b>の最初のページで、<b>インポートフィルタ</b>の項目にある、<b>データタイプとファイル名の両方に適用可能なフィルタを表示</b>にチェックを付け、<b>現在のデータタイプのインポートフィルタ</b>ドロップダウンで、使用したいフィルタ名を選択します。 
</p><p>操作8と9を行わない場合、ファイル名は新しいパラメータ行にインポートされます。データを作図した場合、コメントの内容が自動で凡例として使用されます。凡例の内容をファイル名に変更したい場合、以下のいずれかの操作をします。 
</p>
<ul><li> 凡例で表示する項目を新しいパラメータに変更する。 </li></ul>
<p>または、  
</p>
<ul><li> 新しいパラメータ行の内容をコメントに手動でコピーする。 </li></ul>
<hr class='keywordshr'><p><span class='keywords'>キーワード:</span><span class='keywordsInput'>ファイル名抽出, 拡張子を除く</span></p>
    