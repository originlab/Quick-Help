<h1 class="firstheading">FAQ-988 データのインポート中に列ラベル行にセル式を追加する方法</h1>
<p class='urlname' style='display: none'>Add-Cell-Formula-during-Import</p>
<p class='faqID'>最終更新：2019/01/09</p>
<p>データインポートの後処理にセル式を使用して列ラベル行を設定するのは一般的な考え方です。ただし、Originはインポート中にセル式を無効にします。これは、データに "="で始まるテキストが含まれる可能性があるためです。 インポート中にセル式を本当に使用する場合は、インポート後のスクリプトを実行する前に@ESCを1に設定してセル式を有効にすることができます。インポート中にセル式を本当に使用する場合は、インポート後のスクリプトを実行する前に<a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#E">@ESC</a> を1に設定してセル式を有効にすることができます。</p>
<p>例えば、<b>ASCIIのインポート</b>ツールでデータをインポートし、その列の最大値と最小値の差を「コメント」に設定する場合は、impASCダイアログの<b>各ファイルのインポート後に実行するスクリプト</b>ボックスに次のスクリプトを追加できます。</p>
<pre class="lt" style="font-family:monospace;">
int nOld <span style="color: #000080;">=</span> @ESC; <span style="color: #008000;">//@ESCの元の値を記録します</span>
@ESC <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; <span style="color: #008000;">//セル式を有効にする</span>
<span style="color: #008000;">//インポート処理後にコードを開始する</span>
for<span style="color: #000000;">(</span>int ii<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>; ii<span style="color: #000080;">&lt;=</span>wks.<span style="color: #000080;">ncols</span>; ii<span style="color: #000080;">++</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
Col<span style="color: #000000;">(</span><span style="color: #000080;">$</span><span style="color: #000000;">(</span>ii<span style="color: #000000;">)</span><span style="color: #000000;">)</span><span style="color: #000000;">[</span>C<span style="color: #000000;">]</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">"=Max(This)-Min(This)"</span>;
<span style="color: #000000;">}</span>
@ESC <span style="color: #000080;">=</span> nOld; <span style="color: #008000;">//@ESCを元の値に戻す</span>
</pre>
<p><b>Note</b>：Originはインポート中に一時的に2に設定されるので（セル式を無効にするため）、@ ESCの値を1に設定する必要があります。</p>
<hr class='keywordshr' />
<p>キーワード：セル式、パラメータ行、インポート中の計算、ラベル行、セットラベル</p>
