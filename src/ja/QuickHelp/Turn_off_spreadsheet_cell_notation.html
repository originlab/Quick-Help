<h1 class="firstheading">FAQ-849 ワークブックでスプレッドシートセル表記を無効にしたり、選択して利用するにはどのようにしたらよいでしょうか？</h1>
<p class="urlname" style="display: none;">スプレッドシートセル表記を無効にするには、</p>
<p class="faqID">最終更新：2019/01/08</p>
<p><br />
</p>
<p>Origin 2017では、<a class="external text" href="../../UserGuide/UserGuide/Column_Short_Name_Restriction.html">「スプレッドシートセル表記」（SNC）</a>が<a 
	 class="external text" href="../../UserGuide/UserGuide/Quick_Start_SetColumnValues.html">列値の設定</a>と<a 
	 class="external text" href="../../UserGuide/UserGuide/Displaying_Supporting_Data_in_Worksheet_header_Rows.html#F.28x.29.3D">F(x)=</a>列の式で、簡単にご利用いただけるようになりました。この表記は、列の式を簡単に記述し、<a 
	 class="external text" href="../../UserGuide/UserGuide/Quick_Start_SetColumnValues.html#Spreadsheet_Cell_Notation_References_to_Other_Sheets_and_Books">その他のシートやブックを参照する</a>ことができます。しかし、古い 
 &quot;col（）/ wcol（）&quot;記法を使いたい場合があるかもしれません（例えば、カラムのショートネームをリネームするスクリプトがあります）。このFAQでは、ワークブックとプロジェクトで、スプレッドシートセル表記をどのように編集するのかについてまとめています。 
 </p>
<h2><a name="How_to_turn_spreadsheet_cell_notation_off_.28or_on.29_for_a_single_workbook"></a><span 
	 class="mw-headline">単一のワークブックについて、スプレッドシートセル表記を有効、無効にするには、</span></h2>
<p>導入以来、SCNは新しいワークブックに対してデフォルトで有効になっています。<b>Origin 2017</b>から<b>Origin 
 2019</b>では、このアイコン<a class="image"><img alt="Spreadsheet cell notation mode.png" 
										 src="../images/Turn_off_spreadsheet_cell_notation/Spreadsheet_cell_notation_mode.png" 
										 width="20" border="0" /></a>がワークシートの左上隅に表示され、SCNが有効になったことを示します。Origin 
 <b>2019b</b>以降、アイコンはデフォルトで非表示になり、新機能のためのスペースを確保しています。ただし、以前のバージョンと同様に、SCNは、新しいワークブックに対してデフォルトで有効になっています。 
 </p>
<p><br />
<i><b>ユーザーインターフェイスを介してセル表記をオフにするには...</b></i> </p>
<p>ワークブックウィンドウのタイトルバーを右クリックして、<a class="external text" href="../../UserGuide/UserGuide/Folder_and_Window_Properties_Dialog.html#Window_Properties_dialog"><b>プロパティ</b></a>.を選択します。<b>プロパティ</b>タブで、<b>スプレッドシートのセル表記</b>チェックボックスをオフにします（ダイアログの中央近くになります）。 
 </p>
<p><br />
<i><b>LabTalk経由でこれを制御するには、次を使用します。</b></i> </p>
<pre class="lt" style="font-family: monospace;">
page.<span style="color: #000080;">xlcolname</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; <span style="color: #008000;">// 0 = off, 1 = on.</span>
</pre>
<h2><a name="Using_the_.40RCN_LabTalk_System_Variable_to_control_spreadsheet_cell_notation"></a><span 
	 class="mw-headline">@RCN LabTalkシステム変数を使って、スプレッドシートセル表記をコントロールします。</span></h2>
<p><b>Origin 2017</b>では、@ RCN = <i>7</i> （デフォルト）：スプレッドシートのセル表記は、<b>新規ワークブック</b> 
 <a class="image"><img alt="Button New Workbook.png" src="../images/Turn_off_spreadsheet_cell_notation/Button_New_Workbook.png" 
						 width="23" border="0" /></a>のツールバーボタンから作成された新規ブックに対して、デフォルトでオンになっています。 
 アクティブブックでSCNがオンになっている場合は、ファイルのインポート時に新規ブックが作成されます。さらに、アクティブワークブック(分析するデータが含まれているワークブック)のSCN無効であっても、分析ダイアログボックスをベースとした多くのXファンクションにより新しく作成されるワークブックはSCNが有効になっています。 
 </p>
<p><b>Origin 2019</b>では、@RCN = <i>15</i> (デフォルト): Origin2017で表記していたケースに加えて、Origin 
 2019以降のバージョンでは、<code>win -t</code> または <code>newbook</code> で作成されたウィンドウに対してSCNは有効となります。この新しいデフォルトの動きは良くない場合があります。 
 - 例えば、あなたがカラムのショートネームを変えるスクリプトを持っている状況では（例えば、<a href="../../QuickHelp/QuickHelp/Set_column_names_in_script_using_wksaddCol_wkscolname.html" 
												 title="クイックヘルプ：wks.addColを使用してスクリプトで列名を設定します。"><b>FAQ-872</b></a>をご覧ください）。 
 </p>
<p><i><b>したがって、</b></i> <code>win -t</code> or <code>newbook</code> で新しいウィンドウを作成するときにSCNをオンにしたくない場合は、<a 
	 class="external text" href="../../UserGuide/UserGuide/Customizing_Origin_using_System_Variables.html#Changing_the_Value_of_a_System_Variable"><b>システム変数を設定</b> 
 ダイアログボックス</a> で <b>@RCN=7</b>の値を設定する必要があります。Originを起動するたび、@RCN 値は読み取られ、<code>win 
 -t</code> または <code>newbook</code> によりウィンドウが作成されます。Origin 2017でも同様に行われます。 
 </p>
<p><br />
<i><b>@RCNのビット値:</b></i> </p>
<ul>
	<li>0 = セル表記が全ての新規ブックで無効。</li>
	<li>1 = セル表記が新規ワークブックツールバーを使って作成した新規ワークブックで有効。</li>
	<li>2 = インポートの際に、セル表記の設定がアクティブなブックに有効。セル表記が無効の場合、全ての新規ブックで無効。セル表記がアクティブなブックで有効の場合、全ての新規ブックで有効。</li>
	<li>4 = ほとんどの分析Xファンクションが<a class="external text" href="../../UserGuide/UserGuide/Other_Tree_View_controls.html">ツリービューモード</a>で表示される<b>新しいブックで自動スプレッドセル表記</b>のチェックボックスを持っています。このボックスにチェックがついていて、このビットが有効な場合、Xファンクション出力で作成された新しいワークブックは、アクティブブックのSCN有無に関らずスプレッドシートセル表記が有効になります(<a 
	 class="external text" href="../../XFunction/X-Function/Wsplit.html">wsplit</a>、<a 
	 class="external text" href="../../XFunction/X-Function/Wsplit_book.html">wsplit_book</a>、<a 
	 class="external text" href="../../XFunction/X-Function/Merge_book.html">merge_book</a>、<a 
	 class="external text" href="../../XFunction/X-Function/Wmove_sheet.html">wmove_sheet</a>では適用されません)。</li>
	<li>8 = Origin2019で追加次のLabTalkコマンド<code>win -t </code>またはXファンクション<code>newbook</code>で、作成されたワークブックのセル表記をONにします。 
	 </li>
</ul>
<table class="note">
	<tr>
		<td><b>Note:</b> ビット値は付加的なものです (例： デフォルト値@RCN = 7は、セル表記が分析ツールでは自動でオン(+4)、アクティブブックにしたがってインポート(+2)、ツールバーからの新しいワークシートはSCNが有効(+1))。しかし、次のLabTalkコマンド<code>win 
		 -t </code>またはXファンクション<code>newbook</code>で、作成されたワークブックのセル表記をONにします。 
		 </td>
	</tr>
</table>
<h2><a name="Globally_turn_off_spreadsheet_cell_notation"></a><span class="mw-headline">スプレッドシートセル表記を全体で無効にするには、</span></h2>
<p>@RCNの値を操作して、<i>新規</i>ブックのスプレッドシートセル表記をコントロールします。プロジェクト内の<i>全ての</i>既存ブックについてスプレッドシートセル表記を無効にし、さらに、全ての<i>新規</i>ブックについてスプレッドシートセル表記を無効にする方法もあります。 
 </p>
<p><i><b>プロジェクト内の全てのブックのスプレッドシートセル表記を無効</b></i><br />
スクリプトウィンドウかコマンドウィンドウを開き、下記を入力して「Enter」を押します。 </p>
<pre class="lt" style="font-family: monospace;">
doc <span style="color: #000080;">-</span>e WW <span style="color: #000000;">{</span>page.<span style="color: #000080;">xlcolname</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span><span style="color: #000000;">}</span>
</pre>
<p><code>page.xlcolname=1</code>を使って、<i>有効</i>にすることができます。<a class="external text" 
															 href="../../LabTalk/LabTalk/Page_(object).html#Properties:Page_Property">LT 
 page.xlcolnameオブジェクトプロパティ</a>をご覧ください。 </p>
<p><i><b>このプロジェクトの全ブックとプロジェクトで作成した全ての新規ブックのセル表記を無効</b></i><br />
スクリプトウィンドウかコマンドウィンドウを開き、下記を入力して「Enter」を押します。 </p>
<pre class="lt" style="font-family: monospace;">
ClrX</pre>
<p><code>ClrX</code> マクロを実行すると以下の2つが実行されます。 </p>
<dl>
	<dd><ul>
		<li>上述の<code>doc -e WW {page.xlcolname=0}</code> スクリプトを実行。この場合、プロジェクト内の全てのワークブックのスプレッドシートセル表記を無効にします。</li>
		<li><a class="external text" href="../../UserGuide/UserGuide/Set_System_Variables_Dialog_Box.html#Adding_and_Setting_Values_of_System_Variables_by_LabTalk_Script"><b>システム変数の設定</b>ダイアログボックス</a>に<a 
		 class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#R">@RCN 
		 LTシステム変数</a>を追加して、値に<i>0</i>を設定します。この場合、（「システム変数の設定」ダイアログボックスで、@RCN 
		 を削除するか、この値を変更しなければ、）全ての新規ワークブックについてスプレッドシートセル表記が無効になり、全てのOriginセッションに適用されます。</li>
	</ul></dd>
</dl>
<table class="noborder">
	<tr>
		<td style="vertical-align: top;" width="60"><img src="../images/Turn_off_spreadsheet_cell_notation/Tip_icon.png" 
														 alt="" width="57" 
														 border="0" /></td>
		<td><p>このマクロを実行した結果は、次の方法で元に戻すことができます： </p>
		<ol>
			<li><code>doc -e WW {page.xlcolname=1}</code> コマンドを実行</li>
			<li><b>システム変数の設定</b> ダイアログボックスを開く、または<code>@RCN</code> の削除、設定値を 
			 <i>1</i> にする。</li>
		</ol></td>
	</tr>
</table>
<p><br />
<i><b>詳細は、こちらを確認してください：</b></i> </p>
<ul>
	<li><a class="external text" href="../../LabTalk/LabTalk/ClrX_(macro).html">LT 
	 ClrX マクロ</a></li>
	<li><a href="../../QuickHelp/QuickHelp/Set_column_names_in_script_using_wksaddCol_wkscolname.html" 
			 title="クイックヘルプ：wks.addColを使用してスクリプトで列名を設定します。">FAQ-872 なぜスクリプト内にwks.addCol 
	 や wks.col.nameなどを使用した列名を設定できないのですか？</a></li>
</ul>
<hr class="keywordshr" align="center" />
<p><span class="keywords">キーワード:</span><span class="keywordsInput">ショートネーム, 
 値の設定, 列値の設定, 列式, ワークシート, 新規ブック</span></p>
