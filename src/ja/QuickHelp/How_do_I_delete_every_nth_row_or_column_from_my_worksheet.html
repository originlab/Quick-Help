<h1 class="firstheading">FAQ-367 ワークシートを何行か毎または何列か毎に削除するには?</h1>
<p class="urlname" style="display: none;">Del-Every-nth-Row-or-Col</p>
<p class="faqID">最終更新: 2018/08/09</p>
<div id="toc" class="toc">
<div id="toctitle">
<h2>目次</h2>
</div>
<ol>
<li class="toclevel-1 tocsection-1"><a href="#Delete_every_nth_row_or_column"><span class="tocnumber">1</span> <span class="toctext">nごとの列・行を削除する</span></a>
<ol>
<li class="toclevel-2 tocsection-2"><a href="#by_Reduce_Columns.2FRows_dialog"><span class="tocnumber">1.1</span> <span class="toctext">列・行の削減ダイアログを利用する</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#by_looping"><span class="tocnumber">1.2</span> <span class="toctext">ループ処理を利用する</span></a></li>
</ol>
</li>
<li class="toclevel-1 tocsection-4"><a href="#Delete_every_nth_columns_using_Select_dialog"><span class="tocnumber">2</span> <span class="toctext">指定ダイアログを利用してnごとの列・行を削除する</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Delete_every_nth_row_using_the_Worksheet_Query_dialog"><span class="tocnumber">3</span> <span class="toctext">ワークシートクエリダイアログを利用してnごとの列・行を削除する</span></a></li>
</ol>
</div>
<h2><a name="Delete_every_nth_row_or_column" id="Delete_every_nth_row_or_column"></a><span class="mw-headline">nごとの列・行を削除する</span></h2>
<h3><a name="by_Reduce_Columns.2FRows_dialog" id="by_Reduce_Columns.2FRows_dialog"></a><span class="mw-headline">列・行の削減ダイアログを利用する</span></h3>
<p>列を削除するには、<b>ワークシート: 列の削減</b>を選択します。これでX-Functionの<a class="external text" href="../../XFunction/X-Function/Wreducecols.html">wreducecols</a>が開きます。</p>
<p>例えば、以下のスクリーンショットのように設定すると、アクティブなワークブック中の列を5列ごとに削除します（5列目から削除を開始し、1列削除し4列スキップ）。</p>
<dl>
<dd><a class="image" style="color: #0000ff; text-decoration: underline;"><img alt="FQA367 Reduce Columns.png" src="../images/How_do_I_delete_every_nth_row_or_column_from_my_worksheet/400px-FQA367_Reduce_Columns.png" width="413" height="322" border="0"></a></dd>
</dl>
<p>または、<b>コマンドウィンドウ</b>で以下のスクリプトを実行します。</p>
<pre class="lt" style="font-family: monospace;">
wreducecols skip<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span> start<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">5</span>;
</pre>
<p>行を削除するには、<b>ワークシート: 行の削減</b>を選択します。これでX-Functionの<b>wreducerows</b>が開きます。</p>
<p>例えば、以下のスクリーンショットのように設定すると、アクティブなワークブック中の行を4行ごとに削除します（4列目から削除を開始し、1列削除し3列スキップ）。</p>
<dl>
<dd><a class="image" style="color: #0000ff; text-decoration: underline;"><img alt="FQA367 Reduce Rows.png" src="../images/How_do_I_delete_every_nth_row_or_column_from_my_worksheet/400px-FQA367_Reduce_Rows.png" width="420" height="334" border="0"></a></dd>
</dl>
<p>または、<b>コマンドウィンドウ</b>で以下のスクリプトを実行します。</p>
<pre class="lt" style="font-family: monospace;">
wreducerows nrows<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> skip<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span> start<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span>;
</pre>
<h3><a name="by_looping" id="by_looping"></a><span class="mw-headline">ループ処理を利用する：</span></h3>
<p>ワークシートをアクティブにして、<b>スクリプトウィンドウ</b> (メニュー: <b>ウィンドウ: スクリプトウィンドウ</b>)を開き、以下のコードをコピー＆ペーストし、エンターを押します。</p>
<p>列を削除：</p>
<pre class="lt" style="font-family: monospace;">
<span style="color: #008000;">// 上から数え始めて、n番ごとの列を削除します</span>
int ndel <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>; <span style="color: #008000;">// 必要に応じて数字を変更してください</span>
 
int ncols <span style="color: #000080;">=</span> wks.<span style="color: #000080;">ncols</span>;
int nlast <span style="color: #000080;">=</span> ncols <span style="color: #000080;">-</span> mod<span style="color: #000000;">(</span>ncols, ndel<span style="color: #000000;">)</span>;
 <span style="color: #008000;">
// 下から上に向けて削除していきます</span>
for<span style="color: #000000;">(</span>int ii <span style="color: #000080;">=</span> nlast; ii <span style="color: #000080;">&gt;</span> <span style="color: #0000dd;">0</span>; ii <span style="color: #000080;">-</span><span style="color: #000080;">=</span> ndel<span style="color: #000000;">)</span><span style="color: #000000;">
{</span>
   delete wcol<span style="color: #000000;">(</span>ii<span style="color: #000000;">)</span>;<span style="color: #000000;">
}</span>
</pre>
<p>行を削除：</p>
<pre class="lt" style="font-family: monospace;">
<span style="color: #008000;">// 上から数え始めて、n番ごとの列を削除します</span>
int ndel <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>; <span style="color: #008000;">// 必要に応じて数字を変更してください</span>
 
int ncols <span style="color: #000080;">=</span> wks.<span style="color: #000080;">ncols</span>;
int nlast <span style="color: #000080;">=</span> ncols <span style="color: #000080;">-</span> mod<span style="color: #000000;">(</span>ncols, ndel<span style="color: #000000;">)</span>;
 <span style="color: #008000;">
// 下から上に向けて削除していきます</span>
for<span style="color: #000000;">(</span>int ii <span style="color: #000080;">=</span> nlast; ii <span style="color: #000080;">&gt;</span> <span style="color: #0000dd;">0</span>; ii <span style="color: #000080;">-</span><span style="color: #000080;">=</span> ndel<span style="color: #000000;">)</span><span style="color: #000000;">
{</span>
   delete wcol<span style="color: #000080;">(</span>ii<span style="color: #000000;">)</span>;<span style="color: #000000;">
}</span>
</pre>
<h2><a name="Delete_every_nth_columns_using_Select_dialog" id="Delete_every_nth_columns_using_Select_dialog"></a><span class="mw-headline">2 指定ダイアログを利用してnごとの列・行を削除する</span></h2>
<ol>
<li>ワークシートをアクティブにして、メインメニューから<b>編集: 選択</b>を選びます。</li>
<li>開いた<b>選択</b>ダイアログで、<b>モード</b>のドロップダウンリストから<b>N列選択しM列をスキップ</b>を選び、<b>N</b>と<b>M</b>を指定します。</li>
<li><b style="font-weight: bold;">テスト--条件に合えば選択</b>ボタンをクリックして検索された外れ値を選択します。<b>非表示</b>をクリックしてダイアログを閉じます。</li>
<li>ワークシート上で右クリックし、列を選択して<b>削除</b>を選びます。</li>
</ol>
<p>例えば、以下のスクリプトはアクティブウィンドウの列を5列ごとに削除します（5列目から削除を開始し、1列削除し4列スキップ）。</p>
<dl>
<dd><a class="image" style="color: #0000ff; text-decoration: underline;"><img alt="FQA367 Select.png" src="../images/How_do_I_delete_every_nth_row_or_column_from_my_worksheet/300px-FQA367_Select.png" width="343" height="206" border="0"></a></dd>
</dl>
<p><b style="font-weight: bold;">テスト - 条件に合えば選択</b>をクリックし、<b>非表示</b>ボタンを押します。ワークシートに戻り、右クリックで列を選択して<b>削除</b>を行います。これで5番目の列ごとに削除が行われます。</p>
<h2><a name="Delete_every_nth_row_using_the_Worksheet_Query_dialog" id="Delete_every_nth_row_using_the_Worksheet_Query_dialog"></a><span class="mw-headline">ワークシートクエリダイアログを利用してnごとの列・行を削除する</span></h2>
<ol>
<li>ワークシートをアクティブにして、<b>ワークシート: ワークシートクエリ</b>から<a class="external text" href="../../Tutorial/Tutorial/Extract_Worksheet_Data.html">ワークシートクエリ</a>ダイアログ を開きます。</li>
<li>選択条件ボックスに mod(i,3)==0 (<a class="external text" href="../../LabTalk/LabTalk/Mod_(function).html">mod function</a>参照) と入力します。これは、3行毎に選択するということです。そして、「<b>テスト--条件に合えば選択</b>」ボタンをクリックして、これらの行を選択します。
<dl>
<dd><a class="image" style="color: #0000ff; text-decoration: underline;"><img alt="FQA367 Worksheet Query.png" src="../images/How_do_I_delete_every_nth_row_or_column_from_my_worksheet/400px-FQA367_Worksheet_Query.png" width="531" height="505" border="0"></a></dd>
</dl>
</li>
<li>このダイアログを閉じ、右クリックメニューから<b>削除</b>を選択して、ワークシートからこれらの行を選択します。</li>
</ol>
<hr class="keywordshr" align="center">
<p><span class="keywords">キーワード:</span> <span class="keywordsInput">削除, 削減</span></p>
<p class="version">必要なOriginのバージョン: 2016 SR0以降</p>
