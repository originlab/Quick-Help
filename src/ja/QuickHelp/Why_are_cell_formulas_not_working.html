<h1 class="firstheading">FAQ-941 セルの関数が機能しないときはどうすればよいでしょうか?</h1><p class='urlname' style='display: none'>Why-are-cell-formulas-not-working</p>
<p class='faqID'>最終更新：2019/01/08</p>
<p><br />
Origin 2017では(列)値の設定ダイアログボックスで列ベースの計算が使用できる<a class="external text" href="../../UserGuide/UserGuide/Column_Short_Name_Restriction.html">スプレッドシートセル表記</a>が導入されました。Origin 2018ではスプレッドシートのような表記法をセル式（セルレベルの計算）に拡張しました。 
</p><p>一部のユーザーは、GUIまたはLabTalkコマンドを使用してセル式の機能のすべてまたは一部を無効にし、それを行ったことを忘れてしまう場合があります。その後、彼らはセル式を利用しようとしてそれからそれらが機能しないことに気付きます。 
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>内容</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Spreadsheet_Cell_Notation_Must_be_Enabled_in_the_Workbook"><span class="tocnumber">1</span> <span class="toctext">スプレッドシートセル表記をワークブックで有効にする必要があります</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Controlling_Cell_Formulas_via_the_GUI_or_LabTalk_Command"><span class="tocnumber">2</span> <span class="toctext">セル式をGUIやLabTalkコマンドで制御する</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Controlling_Cell_Formulas_via_the_GUI"><span class="tocnumber">2.1</span> <span class="toctext">セル式をGUIで制御する</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Controlling_Cell_Formulas_via_LabTalk_Command"><span class="tocnumber">2.2</span> <span class="toctext">セル式をLabTalkコマンドで制御する</span></a></li>
</ul>
</li>
</ul>
</div>
<h3><a name="Spreadsheet_Cell_Notation_Must_be_Enabled_in_the_Workbook"></a><span class="mw-headline">スプレッドシートセル表記をワークブックで有効にする必要があります</span></h3>
<ul><li> セル式の計算を有効にするには、<a class="external text" href="../../UserGuide/UserGuide/Column_Short_Name_Restriction.html">スプレッドシートセル表記</a>をワークブックで有効にする必要があります。</li>
<li> <b>Origin 2017</b>から<b>Origin 2019</b>までのバージョンでは、新しいワークブックではSCNがデフォルトでオンになっており、SCNがオンのときにこのアイコン<a class="image"><img alt="Spreadsheet cell notation mode.png" src="../images/Why_are_cell_formulas_not_working/Spreadsheet_cell_notation_mode.png" width="20"  /></a> がワークシートの左上隅に表示されます。Origin <b>2019b</b>以降、このアイコンは非表示になっていますが、新しいワークブックではデフォルトでSCNはオンのままです。</li>
<li> もしスプレッドシートセル表記のアイコン<a class="image"><img alt="Button SCN OFF.png" src="../images/Why_are_cell_formulas_not_working/Button_SCN_OFF.png" width="22"  /></a>がワークブックの左上に見つからない場合は、ワークブックのタイトルバーを右クリックして<b>プロパティ</b>を選択します。<b>プロパティ</b>タブで、<b>スプレッドシートセル表記</b>チェックボックスにチェックを入れて<b>OK</b>をクリックします。</li>
<li> スプレッドシートのセル表記は、Origin 2017以前に作成されたものであっても、どの本やプロジェクトでもオンにすることができます。ウィンドウのタイトルバーを右クリックして、<b>プロパティ</b>を選びます。<b>プロパティ</b>タブで、<b>スプレッドシートセル表記</b>チェックボックスにチェックを入れて<b>OK</b>をクリックします。 </li></ul>
<p><br />
1冊のブックに対してスプレッドシートのセル表記を無効にし、新しいブックを含むプロジェクト内の既存のすべてのブックに対して無効にするためのLabTalk（スクリプト）メソッドがあります。こちらもご参照ください。FAQ-849: ワークブックでスプレッドシートセル表記を無効にしたり、選択して利用するにはどのようにしたらよいでしょうか？
</p>
<h3><a name="Controlling_Cell_Formulas_via_the_GUI_or_LabTalk_Command"></a><span class="mw-headline">セル式をGUIやLabTalkコマンドで制御する</span></h3>
<p>Originのプロジェクトでセル式を一部または全体で無効にする方法はいくつかあります。(詳細は<a href="../../QuickHelp/QuickHelp/Turn_off_cell_formula.html" title="クイックヘルプ：スプレッドシートセルのフォーマットをリセットする">FAQ-939</a>を参照してください。)
</p>
<h4><a name="Controlling_Cell_Formulas_via_the_GUI"></a><span class="mw-headline">セル式をGUIで制御する</span></h4>
<p><b>編集モード</b>が有効になっていないことを確認します：
</p>
<ol><li>メニューから<b>編集: 編集モード</b>を確認します。</li>
<li><b>編集モード</b>の横にチェックマークがある場合は、その項目をクリックしてマークを外します。</li></ol>
<dl><dd><dl><dd><a class="image"><img alt="Edit menu edit mode enabled.png" src="../images/Why_are_cell_formulas_not_working/Edit_menu_edit_mode_enabled.png" width="290"  /></a></dd></dl></dd></dl>
<h4><a name="Controlling_Cell_Formulas_via_LabTalk_Command"></a><span class="mw-headline">セル式をLabTalkコマンドで制御する</span></h4>
<p>LabTalkのシステム変数<code>@ESC = 1</code>.を確認します。<code>@ESC=0</code>の場合、セル式(例：「=A1+B1」)は単純なテキストとして扱われ、式は解決されません。これは、ワークブックの<b>スプレッドシートセル表記</b>ボックスが有効になっていて、Originの<b>編集モード</b>が無効になっていても発生します。 
</p>
<ol>
<li>メニューから<b>ウィンドウ：スクリプトウィンドウ</b>を選択し、以下のように入力してEnterキーを押します：</li>
<pre class="lt" style="font-family:monospace;">@esc<span style="color: #000080;">=</span></pre>
<li>Originが値0 (@esc=0)を返す場合は、以下のように入力してEnterキーを押します：</li>
<pre class="lt" style="font-family:monospace;">@esc<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span></pre>
</ol>
<p><br />
それでも<code>@ESC</code>が値0を返す場合は、<a href="../../QuickHelp/QuickHelp/How_do_I_permanently_change_the_value_of_a_system_variable.html" title="クイックヘルプ:システム変数の値を永続的に変更するには"><b>システム変数の設定</b>ダイアログ</a>を確認して0に設定された「ESC」項目があるかどうかをチェックします：
</p>
<ol><li> メニューから<b>Preference: システム変数</b>を選択してシステム変数の設定ダイアログボックスを開きます。</li></ol>
<hr class='keywordshr'><p><span class='keywords'>キーワード</span><span class='keywordsInput'>計算、スプレッドシート、@RCN、@ESC、page.xlcolname、ClrX</span></p>

    