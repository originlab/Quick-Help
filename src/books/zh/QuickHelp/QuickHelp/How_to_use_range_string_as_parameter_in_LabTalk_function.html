<h1 class="firstHeading">4.70 FAQ-1145 如何在 LabTalk 函数中使用范围字符串作为参数？</h1><p class='urlname' style='display: none'>Recognize_Range_String_in_LT_Function</p>
<p class='faqID'>Last Update: 10/27/2022</p>
<p>许多 LabTalk 函数，例如<a class="external text" href="../../LabTalk/LabTalk/Total_(function).html">total()</a>，不能接受范围字符串作为参数。 假设我们在 Col(A) 和 col(B) 中分别有工作表名称和列索引，我们不能使用下面的公式直接计算第 <i>i</i> 列的总和。
</p>
<pre class="lt" style="font-family:monospace;">total<span style="color: #000000;">&#40;</span>A<span style="color: #000080;">$</span> <span style="color: #000080;">+</span> “<span style="color: #000080;">!</span>” <span style="color: #000080;">+</span> B<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span></pre>
<p>所以从 Origin 2023 开始，我们包含了一个 LabTalk 本地函数 <i><b>mkrng</b></i> 来生成范围变量。对于上面的示例，您可以改用以下公式。
</p>
<pre class="lt" style="font-family:monospace;">total<span style="color: #000000;">&#40;</span>mkrng<span style="color: #000000;">&#40;</span>A<span style="color: #000080;">$</span> <span style="color: #000080;">+</span> “<span style="color: #000080;">!</span>” <span style="color: #000080;">+</span> B<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span></pre>
<p>Origin 2023 之前的版本则需要你自己定义 <i><b>mkrng</b></i> 函数。
</p>
<pre class="lt" style="font-family:monospace;">function range mkrng<span style="color: #000000;">&#40;</span>string str<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    range rr <span style="color: #000080;">=</span> str<span style="color: #000080;">$</span>;
    return rr;
<span style="color: #000000;">&#125;</span></pre>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>LabTalk, range, string, 范围, 字符串</span></p>






