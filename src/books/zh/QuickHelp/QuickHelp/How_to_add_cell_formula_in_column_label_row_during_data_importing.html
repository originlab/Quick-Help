<h1 class="firstHeading">2.103 FAQ-988 在导入数据过程中，如何在列标签添加单元格公式？</h1><p class='urlname' style='display: none'>Add-Cell-Formula-during-Import</p>
<p class='faqID'>Last Update: 4/9/2019</p>
<p>通常情况下，我们会在数据导入后，通过单元格公式设置列标签行。由于考虑到你的数据种可能包含有 "=" 开头的文本， 因此在导入过程中， Origin 禁用单元格公式。 如果你确实希望在导入数据的过程中使用单元格公式，你可以将 <a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#E">@ESC</a>  设置为1，在执行任何导入后运行脚本之前，打开单元格公式。
</p><p>例如，如果通过<b>导入 ASCII</b> 工具导入数据，并将注释设置为列的最大值和最小值的差值，那么可以将以下脚本放在 <b>impASC</b> 对话框的 <b>每个文件导入后运行脚本</b> 框下。
</p>
<pre class="lt" style="font-family:monospace;">int nOld <span style="color: #000080;">=</span> @ESC; <span style="color: #008000;">//keep record of original value of @ESC</span>
@ESC <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;  <span style="color: #008000;">//force cell formula enable</span>
<span style="color: #008000;">//start your code for after import process</span>
for<span style="color: #000000;">&#40;</span>int ii<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>; ii<span style="color: #000080;">&lt;=</span>wks.<span style="color: #000080;">ncols</span>; ii<span style="color: #000080;">++</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
Col<span style="color: #000000;">&#40;</span><span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>ii<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span>C<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;=Max(This)-Min(This)&quot;</span>;
<span style="color: #000000;">&#125;</span>
@ESC <span style="color: #000080;">=</span> nOld; <span style="color: #008000;">//restore @ESC to original value</span></pre>
<p><b>注意</b>: 我们必须将 @ESC 的值设为1，即使它当前值已经为1，因为在导入过程中，Origin 会在内部将其临时设置为2 （以禁用单元格公式）。
</p>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>cell fomula, parameter row, calculation during import, label row, set label, 单元格公式，参数行，导入时计算，标签行，设置标签</span></p>






