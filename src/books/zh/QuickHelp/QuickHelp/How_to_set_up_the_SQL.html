<h1 class="firstHeading">2.72 FAQ-800 如何设置 SQL？</h1><p class='urlname' style='display: none'>set-up-sql</p>
<p class='faqID'>Last Update: 7/19/2018</p>
<p>在这个文档中，以 AdventureWorks 数据库为例，Origin 提供了几个教程来介绍了易于使用的数据库访问工具。下面一节将介绍如何配置 SQL 服务，以及如何连上 AdventureWorks 数据库并将其连接到 Origin。
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#.E4.B8.8B.E8.BD.BD_AdventureWorks_.E6.95.B0.E6.8D.AE.E5.BA.93"><span class="tocnumber">1</span> <span class="toctext">下载 AdventureWorks 数据库</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#.E8.AE.BE.E7.BD.AE_SQL_.E6.9C.8D.E5.8A.A1"><span class="tocnumber">2</span> <span class="toctext">设置 SQL 服务</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#.E9.85.8D.E7.BD.AE.E6.95.B0.E6.8D.AE.E6.BA.90_.28ODBC.29"><span class="tocnumber">3</span> <span class="toctext">配置数据源 (ODBC)</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#.E5.9C.A8_Origin_.E4.B8.AD.E8.BF.9E.E6.8E.A5.E5.88.B0.E6.95.B0.E6.8D.AE.E5.BA.93"><span class="tocnumber">4</span> <span class="toctext">在 Origin 中连接到数据库</span></a></li>
</ul>
</div>

<h3><a name=".E4.B8.8B.E8.BD.BD_AdventureWorks_.E6.95.B0.E6.8D.AE.E5.BA.93"></a><span class="mw-headline">下载 AdventureWorks 数据库</span></h3>
<p>点击<a class="external text" href="https://msftdbprodsamples.codeplex.com/releases/view/125550" target="_blank">此链接</a>下载 AdventureWorks 数据库，并选择 <a class="external text" href="https://msftdbprodsamples.codeplex.com/downloads/get/880661" target="_blank">Adventure Works 2014 Full Database Backup.zip</a> 进行下载，然后解压到电脑的本地磁盘中，例如 <i>E:\</i>。解压后的文件应该是 <i>AdventureWorks2014.bak</i>。
</p>
<h3><a name=".E8.AE.BE.E7.BD.AE_SQL_.E6.9C.8D.E5.8A.A1"></a><span class="mw-headline">设置 SQL 服务</span></h3>
<p>在安装 AdventureWorks 数据库之前，必须在本地计算机上安装了 SQL 服务器。以下步骤将介绍如何安装 Microsoft SQL server 2014 Express：
</p><p><b>注意：</b> 所使用的操作系统必须是 <b>Windows 7</b> 或更高的版本。
</p>
<ol><li> 打开<a class="external text" href="https://www.microsoft.com/en-us/download/details.aspx?id=42299" target="_blank">下载页面</a>，并使用微软账号进行登陆，然后点击 DOWNLOAD。</li>
<li>双击安装包下面的 <b>ExpressAdv 32BIT\SQLEXPRADV_x86_ENU.exe</b>(针对 32 位操作系统) 或者 <b>ExpressAdv 64BIT\SQLEXPRADV_x64_ENU.exe</b> (针对 64 位操作系统)，然后点击 <b>Next</b> 开始下载。</li>
<li> 下载页面中有一个简短的 <b>Install Instructions</b> 以供进行设置参考。可以在安装的时候接受所有的默认设置。</li>
<li> 完成安装后，前转到 Windows 的 <b>Start</b> 菜单，点击 <b>All Programs</b>，然后找到 <b>Microsoft SQL Server 2014: SQL Server 2014 Management Studio</b> 并打开 SQL 服务器。</li>
<li>将弹出一个 <b>Connect to Server</b> 对话框来指定连接设置，请按下图所示选择 <b>Server type</b> 和 <b>Authentication</b> ，然后点击 <b>Connect</b>。
<dl><dd><a  class="image"><img alt="SQL initialize.png" src="../images/How_to_set_up_the_SQL/SQL_initialize.png?v=4913" width="426"  /></a></dd></dl></li>
<li>在 <b>Object Explorer</b> 面板中右击 <b>Database</b> ，然后选择 Restore Database 以打开对话框。
<dl><dd><a  class="image"><img alt="SQL restore.png" src="../images/How_to_set_up_the_SQL/SQL_restore.png?v=4914" width="386"  /></a></dd></dl></li>
<li>在 Source 组中选择 Device，并添加之前下载的 <i>AdventureWorks2014.bak</i> 文件。然后点击 OK 来应用设置。</li></ol>
<p><a  class="image"><img alt="SQL database.png" src="../images/How_to_set_up_the_SQL/SQL_database.png?v=4915" width="878"  /></a>
8.  至此，我们成功的导入了数据库。
</p>
<h3><a name=".E9.85.8D.E7.BD.AE.E6.95.B0.E6.8D.AE.E6.BA.90_.28ODBC.29"></a><span class="mw-headline">配置数据源 (ODBC)</span></h3>
<ol><li>点击 Windows 中的 <b>Start</b> 按钮，并在 <b>Search programs and files</b> 框中输入 <b>Data Sources</b> ，将会在列表中找到这个应用，然后点击以打开的对话框。
<dl><dd><a  class="image"><img alt="SQL source.png" src="../images/How_to_set_up_the_SQL/SQL_source.png?v=4916" width="228"  /></a></dd></dl></li>
<li> 转到对话框中的 <b>System DSN</b> 选项卡，点击 <b>Add</b> 以打开 <b>Create New Data Source</b> 对话框，选择 <b>ODBC Driver 11 for SQL Server</b>。如下图所示：
<dl><dd><a  class="image"><img alt="SQL odbc.png" src="../images/How_to_set_up_the_SQL/SQL_odbc.png?v=4917" width="478"  /></a></dd></dl></li>
<li>点击 <b>Finish</b>。然后将会弹出一个新的对话框，并根据需要指定名称，如下图中的 New_test，然后选择连接到本地 (local) 服务器。
<dl><dd><a  class="image"><img alt="SQL odbc2.png" src="../images/How_to_set_up_the_SQL/SQL_odbc2.png?v=4918" width="580"  /></a></dd></dl></li>
<li>点击 <b>Finish</b>，然后将会弹出 ODBC Microsoft SQL Server Setup 对话框，点击底部的 <b>Test Data Source</b> 按钮。
<dl><dd><a  class="image"><img alt="SQL odbc3.png" src="../images/How_to_set_up_the_SQL/SQL_odbc3.png?v=4919" width="408"  /></a></dd>
<dd>如果一切顺利，则在消息对话框中将会显示: Test completed Successfully! 点击每个对话框中的 OK 按钮应用所有设置。</dd>
<dd><a  class="image"><img alt="SQL odbc4.png" src="../images/How_to_set_up_the_SQL/SQL_odbc4.png?v=4920" width="378"  /></a></dd></dl></li></ol>
<h3><a name=".E5.9C.A8_Origin_.E4.B8.AD.E8.BF.9E.E6.8E.A5.E5.88.B0.E6.95.B0.E6.8D.AE.E5.BA.93"></a><span class="mw-headline">在 Origin 中连接到数据库</span></h3>
<ol><li>打开 Origin，点击数据连接工具栏中的 <a  class="image"><img alt="Button Open SQL Editer.png" src="../images/How_to_set_up_the_SQL/Button_Open_SQL_Editer.png?v=4867" width="24"  /></a> 按钮以打开 SQL 编辑器。点击 <a  class="image"><img alt="Db editor connect.png" src="../images/How_to_set_up_the_SQL/Db_editor_connect.png?v=4921" width="23"  /></a> 以打开 <b>Data Link Properties</b> 对话框，选择 <b>Microsoft OLE DB Provider for ODBC Drivers</b>:
<dl><dd><a  class="image"><img alt="SQL odbc5.png" src="../images/How_to_set_up_the_SQL/SQL_odbc5.png?v=4922" width="377"  /></a></dd></dl></li></ol>
<p>点击 <b>Next</b> 来指定 <b>Connection</b>，在 Use data source name 中选择 <b>New_test</b>，然后在 Enter the initial catalog to use 中选择 <b>AdventureWorks2014</b>。
</p>
<ol><li><dl><dd><a  class="image"><img alt="SQL odbc6.png" src="../images/How_to_set_up_the_SQL/SQL_odbc6.png?v=4923" width="377"  /></a></dd></dl></li>
<li>设置完成后可以点击 <b>Test Connection</b> 按钮来测试连接，如果连接成功，则会弹出提示消息: Test Connection Succeed!</li>
<li>点击 OK 来应用设置。在登陆窗口中直接点击 OK 。此时将会在对话框的右侧面板中看到一组表格。
<dl><dd><a  class="image"><img alt="SQL odbc7.png" src="../images/How_to_set_up_the_SQL/SQL_odbc7.png?v=4924" width="476"  /></a></dd></dl></li>
<li>在左侧输入框中输入 SQL 查询进行测试:</li></ol>
<pre class="sql" style="font-family:monospace;"><span style="color: #993333; font-weight: bold;">SELECT</span> 
    e<span style="color: #66cc66;">.</span>BusinessEntityID<span style="color: #66cc66;">,</span> p<span style="color: #66cc66;">.</span>FirstName<span style="color: #66cc66;">,</span> p<span style="color: #66cc66;">.</span>MiddleName<span style="color: #66cc66;">,</span> p<span style="color: #66cc66;">.</span>LastName
<span style="color: #993333; font-weight: bold;">FROM</span> 
   HumanResources<span style="color: #66cc66;">.</span>Employee <span style="color: #993333; font-weight: bold;">AS</span> e <span style="color: #993333; font-weight: bold;">INNER</span> <span style="color: #993333; font-weight: bold;">JOIN</span> 
   Person<span style="color: #66cc66;">.</span>Person <span style="color: #993333; font-weight: bold;">AS</span> p <span style="color: #993333; font-weight: bold;">ON</span> p<span style="color: #66cc66;">.</span>BusinessEntityID <span style="color: #66cc66;">=</span> e<span style="color: #66cc66;">.</span>BusinessEntityID</pre>
<ol><li>点击 <b>Preview the result data</b> 按钮 <a  class="image"><img alt="SQL editor preview.png" src="../images/How_to_set_up_the_SQL/SQL_editor_preview.png?v=4925" width="25"  /></a> 对数据进行预览。如果预览结果满意，则点击 <b>Import data to worksheet</b> 按钮 <a  class="image"><img alt="Button db Import Data.png" src="../images/How_to_set_up_the_SQL/Button_db_Import_Data.png?v=4926" width="25"  /></a> 来导入这些数据。则结果如下所示:
<dl><dd><a  class="image"><img alt="SQL odbc8.png" src="../images/How_to_set_up_the_SQL/SQL_odbc8.png?v=4927" width="481"  /></a></dd></dl></li></ol>






