<h1 class="firstHeading">2.73 FAQ-806 如何在数据集中查找接近的日期/时间值？</h1><p class='urlname' style='display: none'>find-closest-date</p>
<p class='faqID'>Last Update: 7/14/2018</p>
<h4><a name=".E6.96.B9.E6.B3.95.E4.B8.80"></a><span class="mw-headline">方法一</span></h4>
<p>通过 <b>Edit:Find</b> 菜单查找距离我想找的日期最集接近的日期/时间值
</p>
<ol>
<li>使用 <b>date()</b> 函数可以获取想找日期的儒略日期(Julian date)。例如，如果想要查找一个接近于 <i>2004-02-01 09:39:54</i> 的日期值，首先通过如下脚本语句获得此日期的儒略日期(Julian date)（把脚本复制粘贴到 <b>Script Window</b> 后选中按 <b>Enter</b> 执行）：
<br />
<pre class="lt" style="font-family:monospace;">date<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2004</span><span style="color: #000080;">-</span>02<span style="color: #000080;">-</span>01 09<span style="color: #000000;">:</span><span style="color: #0000dd;">39</span><span style="color: #000000;">:</span><span style="color: #0000dd;">54.500</span>,<span style="color: #ff00ff;">&quot;yyyy''MM''dd HH':'mm':'ss'.'###&quot;</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>;</pre>
<li>选择 <b>Edit:Find in Sheets</b>。将 <b>Data Type</b> 设置为 <b>Numeric</b> ，然后在 <b>Find what</b> 编辑框中输入上一步中得到的数值(通过 <b>date()</b> 函数计算的儒略日期(Julian date))。根据需要修改其它设置，然后点击 <b>Find Next</b> 按钮。
</ol>
<table class="note">

<tr>
<td><b>注意：</b> 需要适当的调整 <b>Tolerance</b> 以找到最接近的值。
</td></tr></table>
<p><br />
</p>
<h4><a name=".E6.96.B9.E6.B3.95.E4.BA.8C"></a><span class="mw-headline">方法二</span></h4>
<p>通过 <b>Edit: Go to</b> 菜单查找距离我想找的日期最集接近的日期/时间值
</p>
<ol>
<li>通过 <b>index()</b> 函数找到最接近的日期值所在的行，命令如下（把脚本复制粘贴到 <b>Script Window</b> 后选中按 <b>Enter</b> 执行）：<br />
<pre class="lt" style="font-family:monospace;">mydate<span style="color: #000080;">=</span>date<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2004</span><span style="color: #000080;">-</span>02<span style="color: #000080;">-</span>01 09<span style="color: #000000;">:</span><span style="color: #0000dd;">40</span><span style="color: #000000;">:</span><span style="color: #0000dd;">00.000</span>,<span style="color: #ff00ff;">&quot;yyyy'-'MM'-'dd HH':'mm':'ss'.'###&quot;</span><span style="color: #000000;">&#41;</span>;
index<span style="color: #000000;">&#40;</span>mydate,col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>,<span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>;</pre>
</li>
<li>然后使用 <b>Edit: Go to...</b> 菜单定位到所在的行。
</li>
</ol>
<p><br />
</p>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>Date, Time, Find, closest date value，时间，日期，查找，最接近的日期值</span></p>






