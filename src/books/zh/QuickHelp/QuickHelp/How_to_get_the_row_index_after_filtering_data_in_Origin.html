<h1 class="firstHeading">2.60 FAQ-1059 在Origin中筛选数据后，如何获得可见单元格的行索引和值？</h1><p class='urlname' style='display: none'>Get-Visible-Row-Index</p>
<p class='faqID'>Last Update: 10/15/2020</p>
<p>有用户问到，在Origin中筛选数据后，如何获得可见单元格的行索引和值？如下面的图片所示： 
<a  class="image"><img alt="GetNextVisibleRow1.png" src="../images/How_to_get_the_row_index_after_filtering_data_in_Origin/GetNextVisibleRow1.png?v=9826" width="600"  /></a>
</p><p>自Origin2016，<a class="external text" href="https://www.originlab.com/doc/LabTalk/ref/Wks-obj#Methods" target="_blank">工作表属性</a>添加了<b>wks.GetNextVisibleRow(N)</b>，用于返回从给定的行<b>N</b>开始计算的下一个可见行索引。
</p>
<pre>   例如 <b>wks.GetNextVisibleRow(0)=</b> 会返回第一个可见行索引<b>38</b>。
</pre>
<p><b>col(Name)[wks.GetNextVisibleRow(N)]</b>所得到的值为指定列的第<b>N</b>行后的下一个可见行对应的值。如上图所示，在列公式中使用<b>D/C[wks.GetNextVisibleRow(i)]</b>，这是D列的数据除以C列的下一个可见行的数值，这样可以计算NY州阳性病例的日增量百分比。如果在老的版本中，使用<b>col(D)/col(C)[wks.GetNextVisibleRow(i)]</b>。 
</p><p>注意：
</p>
<ul><li> Wks.GetNextVisibleRow(1)=, .... wks.GetNextVisibleRow(37)= 在上图的例子中，都会返回38，因为1-37行后的第一个可见行都为38。</li>
<li> 对于文本列，使用col(Name)[wks.GetNextVisibleRow(N)]$。</li>
<li> col(Name)[N]/col(Name)[N]$会返回第<b>N</b>行的值/文本，不管此行隐藏与否。如果此行隐藏，则会返回缺失值。</li></ul>
<p><br />
</p>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>filter, row index, visible row，筛选，过滤，行索引，可见行</span></p>






