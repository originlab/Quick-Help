<h1 class="firstHeading">4.50 FAQ-689 什么是用户界面模块（UIM）以及如何编辑 UIM 对象和为其编写程序？</h1><p class='urlname' style='display: none'>UIM-editing-programming</p>
<p class='faqID'>Last Update: 7/26/2018</p>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/What_is_UIM_and_How_Do_I_Edit_and_Program_Object/Alert_icon.png?v=0" width="57"  border="0" /></td><td><p><font color="red"><b>重要提示!!! </b> </font>
<p>UIM 是一个非常古老的工具。现在，Origin 已经有了更好用更强大的工具可以用来创建用户自定义界面，运行脚本完成某项操作。因此，<font color="red">UIM 已经不再推荐使用。</font>从 Origin2018b 开始，UIM 工具栏在 Edit Mode 的状态下默认也是不显示出来的。在新版本的 Origin 中，
</p>
</p>
<ul><li>你可以创建自定义按钮和工具栏来运行 LabTalk 脚本。要了解更多信息，请参阅 <a class="external text" href="../../UserGuide/UserGuide/User_Defined_and_Custom_Toolbars_and_Toolbar_Buttons.html">User-Defined and Custom Toolbars and Toolbar Buttons</a> 这个文档。</li>
<li>要创建自定义用户界面，使用 <b>X-Function Builder</b> 是一个简便有效的方法。要了解更多信息，请参阅 <a class="external text" href="../../XFunction/X-Function/X-Function_Builder.html">X-Function Builder document</a> 这个文档。</li>
<li>如果您还想要做更复杂的编程来完成更复杂的任务，运用 OriginC 使之成为可能。OriginC 中的多种工具，诸如 GetN 宏命令, GetNBox 对话框等都可以使用，甚至连外部 DLL 和 Python 都可以被调用。要了解更多信息，请参阅 <a class="external text" href="../../OriginC/Category/Dialog.html">OriginC document</a> 这个文档。</li>
<li>最后，从 Origin2017 开始，我们支持了 HTML 和 JavaScript，使得用户自定义界面的交互性大大增加。要了解更多信息，请参阅 <a class="external text" href="../../OriginC/Category/HTML_Dialog.html">Origin C HTML Dialog with JavaScript Support</a> 这个文档。</li></ul>
<p><br /><br />
如果您还是想使用 UIM，您可以将系统变量 @UIM 设为1，这可以在 Edit Mode 模式下打开 UIM 工具栏。然后请继续阅读以下文档来学习如何使用 UIM。
</p><p><span class='headerInParagraph'>要设置 @UIM = 1:</span>
</p>
<dl><dd><ol><li>选择菜单 <b>Tools: System Variables</b> </li>
<li>在打开的 <b>Set System Variables</b> 对话框中，在 <b>Variable</b> 列输入 <i>@UIM</i> 然后在 <b>Value</b> 列输入 1</li></ol></dd></dl>
	</td>
	</tr>
	</table>
<h2><a name=".E6.A6.82.E5.86.B5"></a><span class="mw-headline">概况</span></h2>
<p><b>User Interface Module</b>（UIM）由一组可用于开发自定义工具的对象组成。这14个对象通常被添加到模板中，并且可以为其编写程序使其能运行 LabTalk 脚本。UIM 对象有各种类型，其中包括位图按钮，复选框控件，单选按钮等。您可以编辑这些控件甚至为其编写程序，并通过它们来组建您的自定义界面。
</p><p>UIM 在过去很长一段时间内都是 OriginPro 的功能。直到 Origin 2015 SR1 开始才被纳入到 Origin 中。如有兴趣，您可以到 Origin 官网（www.originlab.com） <a class="external text" href="http://cloud.originlab.com/pdfs/UIM_Manual.pdf" target="_blank">下载 UIM 文档的 PDF 文件</a>。
</p>
<dl><dd><dl><dd><a  class="image"><img alt="UIM toolbar.png" src="../images/What_is_UIM_and_How_Do_I_Edit_and_Program_Object/UIM_toolbar.png?v=5035" width="84"  /></a></dd></dl></dd></dl>
<ul><li> <b>添加 UIM 对象到模板:</b></li></ul>
<ol><li> 打开一个您将用于作为分析模板的 Origin 子窗口（如工作簿，矩阵簿，图形和布局等）。</li>
<li> 在菜单中打开 <b>Edit: Button Edit Mode</b> 并点击 <b>Button Edit Mode</b> (此时在 <b>Button Edit Mode</b> 的旁边将出现一个勾，表示您已进入 <b>Button Edit Mode</b>)。</li>
<li> 在 <b>UIM</b> 工具栏上点击您想添加的控件。</li>
<li> 在要添加对象的位置，使用鼠标拖出一个矩形。那么即可成功地添加一个 UIM 对象。</li>
<li> 在 <b>Button Edit Mode</b> 下，您可以选择对象并根据需求移动或者为其重新设置大小。</li></ol>
<ul><li> <b>重新命名 UIM 对象:</b></li></ul>
<ol><li> 在 <b>Button Edit Mode</b>, 右键点击 UIM 对象并选择 <b>Programming Control</b>。</li>
<li> 编辑 <b>Object Name</b> 并点击 <b>OK</b> 按钮关闭对话框。</li></ol>
<ul><li> <b> 自定义 UIM 对象:</b></li></ul>
<ol><li> 可利用 <b>UIM Object</b> 对话框自定义控件, 布局和背景。您可点击 <b>Titles...</b>, <b>Values...</b> 和 <b>Special...</b> 按钮获取更多的选项。 这些按钮将会为不同类型的 UIM 对象打开不同的对话框。</li>
<li> 如果需要打开 <b>UIM Object</b> 对话框, 可在 <b>Button Edit Mode</b> 下双击 UIM 对象. 如果不在 <b>Button Edit Mode</b> 下，则需要按住 <b>Ctrl</b> 键并双击该对象.</li></ol>
<ul><li> <b> 为 UIM 对象添加代码:</b></li></ul>
<ol><li> 利用 <b>Programming Control</b> 对话框可为 UIM 对象添加可执行的 LabTalk 脚本。</li>
<li> 若要打开 <b>Programming Control</b> 对话框：在 <b>Button Edit Mode</b>，右键点击并选择 <b>Programming Control</b>。若不在 <b>Button Edit Mode</b>, 按住 <b>Alt</b> 键并双击该对象。</li>
<li> 若需要利用脚本访问该 UIM 对象，使用 <i><b>ObjectName.ControlName</b></i> 表示符。如果控件的名称具有空格符，那么在利用代码调用这些控件时，您需要删减名称中的空格符。</li></ol>
<p><br />
</p>
<table class="note">

<tr>
<td><b>注:</b> 当访问当前 UIM 对象中的控件时，您可以使用 <b>this.<i>ControlName</i></b>。
</td></tr></table>
<h2><a name=".E7.A4.BA.E4.BE.8B"></a><span class="mw-headline">示例</span></h2>
<p>在这个例子中，我们将创建一个简单的 UIM 对象，并且该对象可获取用户输入的 <b>From</b>, <b>To</b> 和 <b>Step Length</b> 的值，当用户点击 <b>Generate Col(A)</b> 按钮时将会利用 LabTalk 脚本在 A 列填充数据。
</p>
<dl><dd><dl><dd><a  class="image"><img alt="UIM sample preview.png" src="../images/What_is_UIM_and_How_Do_I_Edit_and_Program_Object/UIM_sample_preview.png?v=5036" width="483"  /></a></dd></dl></dd></dl>
<ol><li> 选择 <b>Edit: Button Edit Mode</b>，即可看见 <b>UIM</b> 工具栏。</li>
<li> 点击 <b>Status</b> 按钮 <a  class="image"><img alt="UIM STATUS.png" src="../images/What_is_UIM_and_How_Do_I_Edit_and_Program_Object/UIM_STATUS.png?v=5037" width="32"  /></a>。</li>
<li> 在工作簿空白区域利用鼠标拖动出一个矩形框，那么一个标注为 STATUS 的对象即会被添加到工作簿中。</li>
<li> 双击该对象打开 <b>UIM Object</b> 对话框。</li>
<li> 如下图所示编辑该对象：
<dl><dd><a  class="image"><img alt="UIM OBJECT STATUS CONTROLS1.png" src="../images/What_is_UIM_and_How_Do_I_Edit_and_Program_Object/UIM_OBJECT_STATUS_CONTROLS1.png?v=5038" width="385"  /></a></dd></dl></li>
<li> 点击 <b>Special</b> 按钮打开 <b>Status Object</b> 对话框。</li>
<li> 按照下图编辑设置。为 <b>From</b> 输入 <b>0.00</b>；为 <b>To</b> 输入 <b>100.00</b>；为 <b>Step Length</b> 输入 <b>5.00</b>。
<dl><dd><a  class="image"><img alt="UIM Status Object.png" src="../images/What_is_UIM_and_How_Do_I_Edit_and_Program_Object/UIM_Status_Object.png?v=5039" width="318"  /></a></dd></dl></li>
<li> 点击 <b>OK</b> 按钮两次关闭 <b>Status Object</b> 对话框和 <b>UIM Object</b> 对话框。 </li>
<li> 右键点击 STATUS 对象并选择 <b>Programming Control</b>。</li>
<li> 在 <b>Script Box</b> 内, 输入以下脚本:
<dl><dd> <pre class="lt" style="font-family:monospace;">col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> data<span style="color: #000000;">&#40;</span>this.<span style="color: #000080;">From</span>, this.<span style="color: #000080;">To</span>, this.<span style="color: #000080;">StepLength</span><span style="color: #000000;">&#41;</span>;</pre></dd></dl></li>
<li> 从 <b>Script, Run After</b> 下拉列表选择 <b>Button Up</b>。</li>
<li> 点击 <b>OK</b> 按钮关闭对话框。</li>
<li> 从菜单中点击 <b>Edit: Button Edit Mode</b> 退出 Button Edit Mode. </li>
<li> 点击 <b>Generate Col(A)</b> 按钮在 A 列填充数据。</li></ol>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>UIM, User Interface Module, custom routine, custom tool, custom application, GUI, LabTalk, 用户界面模块，自定义操作，自定义工具，自定义应用</span></p>


