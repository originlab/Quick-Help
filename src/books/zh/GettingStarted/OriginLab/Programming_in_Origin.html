<h1 class="firstHeading">19 Origin 编程</h1><p class='urlname' style='display: none'>Programming-in-Origin</p>
<p><br />
</p>
<dl><dd><a  class="image"><img alt="Programming image connectivity CN.png" src="../images/Programming_in_Origin/Programming_image_connectivity_CN.png?v=4158" width="637"  /></a></dd></dl>
<p>当您习惯使用Origin之后，您可以能会希望通过编程来使用Origin，创建自己所需的工具和进行任务，又或者希望从别的软件连接和调用Origin。这一章将讨论Origin提供的编程语言和环境。如果希望更进一步了解相关知识，您还可以学习下面的帮助材料：
</p>
<ul><li> 编程相关的帮助文档，包括指南，语言参考，例子等 (通过Origin的<b>帮助</b>菜单即可打开)</li>
<li> 在线帮助文档：<b>www.originlab.com/doc</b> </li>
<li> 您可以在浏览器上通过搜索精确定位到您所需的页面，例如搜索：<b>labtalk importing</b>，<b>originc interpolate</b>，或者<b>labview origin send data</b>。</li>
<li> Origin的编程相关论坛：<b>www.originlab.com/forum</b>。</li>
<li> Labtalk，Python，自动化服务器及服务端等编程语言的各种例子：Origin安装目录中的<b>\Sample</b>子目录</li></ul>
<p><span class="OIndex" style="display:none">Origin编程</span>
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#LabTalk"><span class="tocnumber">1</span> <span class="toctext">LabTalk</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Python"><span class="tocnumber">2</span> <span class="toctext">Python</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#R"><span class="tocnumber">3</span> <span class="toctext">R</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#MATLAB"><span class="tocnumber">4</span> <span class="toctext">MATLAB</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Origin_C"><span class="tocnumber">5</span> <span class="toctext">Origin C</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#X-Function"><span class="tocnumber">6</span> <span class="toctext">X-Function</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#.E8.87.AA.E5.8A.A8.E5.8C.96.E6.9C.8D.E5.8A.A1.E5.99.A8"><span class="tocnumber">7</span> <span class="toctext">自动化服务器</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#LabVIEW"><span class="tocnumber">8</span> <span class="toctext">LabVIEW</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Orglab"><span class="tocnumber">9</span> <span class="toctext">Orglab</span></a></li>
</ul>
</div>

<h2><a name="LabTalk"></a><span class="mw-headline">LabTalk</span></h2>
<p><span class="OIndex" style="display:none">Origin编程, LabTalk</span>
<span class="OIndex" style="display:none">LabTalk</span>
<span class="OIndex" style="display:none">脚本语言</span>
</p><p><b>LabTalk</b> 是Origin专有的脚本语言，支持大部分Origin的功能。通过调用Labtalk，您可以访问和改变Origin中各种对象的属性，例如工作簿，列，图层，图等。LabTalk还可以通过调用X-Function在进一步实现各种高级的数据操作和分析。
</p><p>有很多种方法可以用来运行Labtalk语言，例如您可以把多行脚本存为脚本文件的一节，然后在界面上的<b>脚本窗口</b>或者<b>命令窗口</b>运行脚本文件节对应的命令来调用该节。也可以把命令做成按钮用在图中或者工作表中，也可以作为工具栏中新按键以及自定义菜单项使用。
</p>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Programming_in_Origin/Tutorial_icon.png?v=0" width="57"  border="0" />
	</td>
	<td><p>下面这个"小教程"将会向您展示如何为工作表添加一个按钮，并用这个按钮调用Labtalk脚本语言来对工作表的数据进行基本的统计计算：
</p>
<ol>
<li>运行Origin，在<b>标准工具栏</b>上点选<b>新建项目</b>按钮新建一个项目。</li>
<li>点选菜单<b>数据：从文件导入：单个ASCII文件</b>，浏览找到文件\Samples\Graphing\Box Chart.dat。选定该文件，点选<b>打开</b>按钮。该文件会被导入到当前工作表中。</li>
<li>确认这个工作簿为当前工作窗口，点选菜单<b>格式：工作表</b>，在<b>工作表属性</b>窗口中，点选<b>大小</b>选项卡，把<b>顶部的间距</b>设为<i>25</i>。点选<b>确定</b>键。在工作表的顶部就增加了一块区域。</li>
<li>在<b>工具</b>工具栏中点选<b>文本</b> 按钮。然后在新添加区域中单击一下以添加文本框并键入"Add Mean Label Row"。在文本对象外点击一下退出编辑模式。 </li>
<li>右键单击文本框，在右键菜单中选择<b>属性</b>，在打开对话框中的<b>程序控制</b>选项中，把<b>在此之后运行命令</b>设为<b>点击按钮</b>。把下面的脚本语言复制黏贴到对话框中：
<pre class="lt" style="font-family:monospace;">wks.<span style="color: #000080;">userParam1</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
wks.<span style="color: #000080;">userParam1</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Mean&quot;</span>;
for <span style="color: #000000;">&#40;</span>int ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>; ii <span style="color: #000080;">&lt;=</span> wks.<span style="color: #000080;">ncols</span>; ii<span style="color: #000080;">++</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	range rr <span style="color: #000080;">=</span> <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>ii<span style="color: #000000;">&#41;</span>;
	Col<span style="color: #000000;">&#40;</span><span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>ii<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span>D1<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>mean<span style="color: #000000;">&#40;</span>rr<span style="color: #000000;">&#41;</span>,.2<span style="color: #000080;">*</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
</li>
<li>点选<b>OK</b>键应用设置和关闭<b>文本对象</b> 对话框。注意到您的文本对象现在变成了一个按钮。</li>
<li>点击那个按钮，可以看到工作表中新添加了一个标签行 <b>Mean</b>，工作表中每一列的均值都被计算并写入到该列所对应的这个标签行中。 </li>
</ol>
</td></tr></table>
<table class="note">

<tr>
<td>
<p><b>提示：</b> 如果您想进一步学习Labtalk，这种Origin专有的脚本语言，可以参考我们的文档：<strong><a class="external text" href="../../LabTalk/Category/LT_Guide.html">帮助：编程：LabTalk</a></strong>.
</p><p>在您的Origin安装目录下\Samples\LabTalk Script Examples子文件夹, 您还可以找到范例文件。
</p>
</td></tr></table>
<h2><a name="Python"></a><span class="mw-headline">Python</span></h2>
<p><span class="OIndex" style="display:none">Origin编程, Python</span><span class="OIndex" style="display:none">PyOrigin 模块</span><span class="OIndex" style="display:none">Python</span>
</p><p>Origin 提供了内置的 Python 开发环境，您可以在 Origin 中运行 Python。Origin 支持在 <b>Python 控制台</b> 或 Origin 的 <b>代码编译器</b> IDE 中运行 Python 命令行。截止到2022年12月，Origin 内置的 Python 是 <a class="external text" href="https://www.python.org/downloads/release/python-383/" target="_blank">3.11 版本</a>。
或者执行 .py 文件. Origin也提供了 PyOrigin 模块使得您可以从 Python 中访问 Origin.
</p>
<table class="note">

<tr>
<td>
<p><b>注意：</b> 有关 Origin 和 Python 的集成使用的更多信息，请参阅 Python 文档中的这些主题：
</p>
<ul><li> <a class="external text" href="../../Python/Category/Python_(Python).html"><b>Introduction to Python in Origin</b></a></li>
<li> <a class="external text" href="../../Python/Python/RunPython_(Python).html"><b>Embedded Python</b></a></li>
<li> <a class="external text" href="../../Python/Python/Sample_Projects_with_Attached_Python_Codes.html"><b>Sample Projects with attached Python Code</b></a>.</li></ul>
</td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Programming_in_Origin/Tip_icon.png?v=0" width="57"  border="0" /></td><td><ul><li>Origin 提供了一个API用于从 Python 调用 Origin， 详情可以看下面的<b>自动化服务器</b>部分。</li>
<li>为了防止 Python 包版本间的冲突，Origin 现支持多个 PyPackage 文件夹（设置系统变量 <b>@PYP</b>）。</li></ul>
</td></tr></table>
<h2><a name="R"></a><span class="mw-headline">R</span></h2>
<p><span class="OIndex" style="display:none">Origin编程, R</span><span class="OIndex" style="display:none">R</span>
在 Origin 中可以调用 R 语言. 您可以在<b>脚本窗口</b>或内置的<b>R控制台</b>中执行 R 命令或者运行 .R 文件. 支持至3.6的所有 R 的发行版本。
</p><p>从 Origin, 您可以用两种方法跟 R 链接: 
</p>
<ul><li><a class="external text" href="../../UserGuide/UserGuide/R_Console.html"><b>R</b></a>. 装在本地计算机上. </li>
<li><a class="external text" href="../../UserGuide/UserGuide/R_Server.html"><b>Rserve</b></a>. 装在远程 PC 上.</li></ul>
<table class="note">

<tr>
<td>
<p><b>提示:</b> 想了解更多的 Origin 和 R 的相互调用, 请参考 Origin 的帮助文件 (<a class="external text" href="../../UserGuide/UserGuide/R_Console.html"><b>R Console</b></a> 和 <a class="external text" href="../../UserGuide/UserGuide/R_Server.html"><b>Rserve Console</b></a>) 和 LabTalk 编程指南 (<a class="external text" href="../../LabTalk/Category/LT_Running_R_in_Origin.html"><b>Running R in Origin</b></a>, <a class="external text" href="../../LabTalk/LabTalk/R_(object).html"><b>R Objects</b></a>, <a class="external text" href="../../LabTalk/LabTalk/Rserve_(object).html"><b>Rserve Objects</b></a>).
</p><p>您也可以在您 Origin安装目录下的 \Samples\R 子文件夹找到更多的示例文件.
</p>
</td></tr></table>
<h2><a name="MATLAB"></a><span class="mw-headline">MATLAB</span></h2>
<p>MATLAB控制台让Origin用户可以在Origin端运行MATLAB命令，并且提供了图形化界面或命令行方式在Origin与MATLAB间交换数据。
</p>
<ul><li> MATLAB控制台的使用需要Origin和MATLAB都安装在同一台电脑。</li>
<li> Origin也支持导入硬盘里的MATLAB (MAT)的数据，并提供了两种方式来导入。旧的方式是通过菜单<a class="external text" href="../../UserGuide/UserGuide/Importing_Third_Party_Files.html"><b>数据: 从文件导入</b></a>，而新的连接器方式则通过菜单<a class="external text" href="../../UserGuide/UserGuide/Connecting_to_File.html#JSON.5CMATLAB_file"><b>数据: 连接到文件: MATLAB</b></a>。导入MAT文件数据不需要安装MATLAB。</li></ul>
<table class="note">

<tr>
<td>
<p><b>注意：</b> 要了解更多关于MATLAB控制台的信息，请参考Origin的帮助文档(<a class="external text" href="../../UserGuide/Category/MATLAB_console.html"><b>MATLAB控制台</b></a>。
</p><p>在&lt;<i>Origin安装目录</i>&gt;\Samples\COM Server and Client\MATLAB子目录下有一个例子（CreatePlotInOrigin.m, CreatePlotInOrigin.OPJ），这个例子演示了如何在MATLAB端（需要安装MATLAB）连接Origin的COM服务器。
</p>
</td></tr></table>
<h2><a name="Origin_C"></a><span class="mw-headline">Origin C</span></h2>
<p><span class="OIndex" style="display:none">Origin 编程, Origin C</span><span class="OIndex" style="display:none">NAG 函数库</span>
<b>Origin C</b> 是 Origin 中基于 ANSI C 的高级编程语言. <span class="OIndex">Origin C</span> 支持所有 ANSI C 的语法, 同时还支持部分 C++ 和 C# 的功能. Origin C 能够调用Origin中所有的功能, 包括数据导入,数据操作, 画图, 分析, 还有导出等. 你还可以使用 Labtalk 脚本在按钮, 工具栏和菜单上调用 Origin C 函数。
</p><p>Origin C由一系列可传递参数的函数组成, Origin C 函数可以编译为目标代码后在Origin中加载和执行。 Origin C为开发和调试更庞大复杂的代码提供了高可靠性和易管理性。
</p><p>Origin 中包含完整的 <b>NAG 函数库</b>. 该库提供大量不同领域的数值计算函数, 如统
计，线性代数，傅立叶变换和多元分析等领域, 所有功能都能用 Origin C 调用。Origin目前支持的 NAG 函数库版本为 <b>Mark 26.1</b>。
</p><p><br />
</p>
<table class="note">

<tr>
<td>
<p><b>提示:</b> 想了解更多的 Origin C 的编程知识, 请参考Origin C 帮助文档: 
</p><p><b>帮助: 编程: <a class="external text" href="../../OriginC/Category/Origin_C_Programming_Guide.html">Origin C</a></b>
</p><p>在那里你可以了解到 Origin C 的使用信息, 语言参考, 开发者提示, 例子等.
</p><p>你还可以在 Origin 安装目录下的 \Samples\Origin C Examples 子目录夹找到更多的范例.
</p>
</td></tr></table>
<h2><a name="X-Function"></a><span class="mw-headline">X-Function</span></h2>
<p><span class="OIndex" style="display:none">X-Function</span><span class="OIndex" style="display:none">Origin 编程, X-Function</span>
一个X-Function是一个自包含的 XML 文件, 它可以作为一个特殊类型的全局函数来加载到Origin中. X-Function是由 Origin C 创建的. X-Function使得用户自己定制工具进行数据处理， 扩展Origin的功能更为方便. Origin 中很多内置的工具也是基于X-Function来实现的. 一旦一个X-Function被创建，它可以在 Origin 界面用由 LabTalk 脚本命令访问, 例如通过脚本窗口, 工具栏按钮, 甚至是成为菜单中的一项。
</p>
<table class="note">

<tr>
<td>
<p><b>提示:</b> 如果您想进一步学习 X-Function, 可以参考我们的帮助文档: 
</p><p><b>帮助: 编程: <a class="external text" href="../../XFunction/Category/X-Function_Programming_Guide.html">X-Functions</a></b>
</p><p>在那里你可以了解到如何创建和使用X-Function, 语言参考, 还有相关详细教程等。
</p>
</td></tr></table>
<h2><a name=".E8.87.AA.E5.8A.A8.E5.8C.96.E6.9C.8D.E5.8A.A1.E5.99.A8"></a><span class="mw-headline">自动化服务器</span></h2>
<p><span class="OIndex" style="display:none">自动化服务器, Origin as</span><span class="OIndex" style="display:none">Visual Basic/Visual C/C#</span>
<span class="OIndex" style="display:none">Excel</span>
Origin可以作为<b>自动化服务器</b>被 <b>LabVIEW™</b>,   <b>Excel</b>, <b>Python</b>, 或基于 VB/VC/C# 的自定义工具等的客户端应用程序访问. 客户端应用程序可以跟Origin进行数据交换， 也可以把发送命令到Origin中执行. 
</p>
<table class="note">

<tr>
<td>
<p><b>提示:</b> 想了解如何把Origin作为自动化服务器使用及相关功能, 请参考我们的帮助文档
<b>帮助: 编程: <a class="external text" href="../../AutomationServer/Category/COM_Server.html">Automation Server</a></b>. 
</p><p>在那里你可以了解 Origin 作为自动化服务器的使用信息, 语言参考, 例子等.
</p><p>你还可以在 Origin 安装目录下的 Samples\COM Server and Client 子目录夹找到更多的范例.
</p>
</td></tr></table>
<h2><a name="LabVIEW"></a><span class="mw-headline">LabVIEW</span></h2>
<p><span class="OIndex">美国国家仪器™公司研制开发的LabVIEW™</span> 被广泛地用于采集数据. 例如, 许多仪器和传感器供应商都提供了用于获取数据的 <span class="OIndex">LabVIEW</span><span class="OIndex HasShownIndex" style="display:none">LabVIEW™</span> 驱动. 当数据采集完毕后, 最终用户会需要对这些数据进行分析, 画图和报告. Origin则提供了强大的数据分析和绘图工具, 包括分析模板功能, 使得新采集到的数据能很容易地被执行类似操作进行分析. Origin 提供了LabVIEW 的的接口, 使得分析和报告等数据的后处理工作能更有效率地在Origin中完成. 
</p><p>Origin 软件包含了一系列定制的 LabVIEW 软件的子虚拟组件(VI)。LabVIEW 软件用户可将这些定制的子虚拟组件结合到他
们的LabVIEW软件的主应用程序中以便其与Origin软件无缝地进行数据交换
</p>
<table class="note">

<tr>
<td>
<p><b>提示:</b> 想了解更多 Origin-LabVIEW 的接口, 请参考我们的帮助文档: 
</p><p><b>帮助: 编程: <a class="external text" href="../../LabVIEW/Category/LabVIEW_VI.html">LabVIEW VI</a></b>
</p><p>里面有详细的例子和教程. 
</p>
</td></tr></table>
<h2><a name="Orglab"></a><span class="mw-headline">Orglab</span></h2>
<p><span class="OIndex">Orglab</span>是一个免费发布的DLL组件，可以用于直接创建或阅读Origin项目文件(.opj)和Origin数据文件(.ogg,.ogw和.ogm)。使用Orglab是免费的，不需要Origin的许可证，这使得设备制造商和其他第三方供应商能够将自己的数据保存为Origin的文件。
</p>
<table class="note">

<tr>
<td>
<p>Orglab 组件支持64位系统. 想更进一步了解或者下载 Orglab 组件, 请浏览我们的网站
</p><p><b>www.originlab.com</b>: <b>Products &gt; <a class="external text" href="http://originlab.com/index.aspx?go=Products/Orglab" target="_blank">Orglab</a></b> .
</p>
</td></tr></table>


