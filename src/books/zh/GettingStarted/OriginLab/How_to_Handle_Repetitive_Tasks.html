<h1 class="firstHeading">16 如何处理重复性任务</h1><p class='urlname' style='display: none'>Handling-Repetitive-Tasks</p>
<p><span class="OIndex" style="display:none">自动化Origin</span>
<span class="OIndex" style="display:none">批处理</span>
</p><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#.E5.88.86.E6.9E.90.E6.8A.A5.E5.91.8A.E8.A1.A8"><span class="tocnumber">1</span> <span class="toctext">分析报告表</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#.E9.87.8D.E6.96.B0.E8.AE.A1.E7.AE.97"><span class="tocnumber">2</span> <span class="toctext">重新计算</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#.E5.AF.B9.E8.AF.9D.E6.A1.86.E4.B8.BB.E9.A2.98"><span class="tocnumber">3</span> <span class="toctext">对话框主题</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#.E9.A1.B9.E7.9B.AE.E5.92.8C.E5.B7.A5.E4.BD.9C.E8.96.84.E6.A8.A1.E6.9D.BF"><span class="tocnumber">4</span> <span class="toctext">项目和工作薄模板</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="#.E5.B0.86.E5.B7.A5.E4.BD.9C.E8.96.84.E4.BD.9C.E4.B8.BA.E6.A8.A1.E6.9D.BF"><span class="tocnumber">4.1</span> <span class="toctext">将工作薄作为模板</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#.E5.B0.86.E9.A1.B9.E7.9B.AE.E4.BD.9C.E4.B8.BA.E6.A8.A1.E6.9D.BF"><span class="tocnumber">4.2</span> <span class="toctext">将项目作为模板</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-7"><a href="#.E6.89.B9.E9.87.8F.E7.BB.98.E5.9B.BE"><span class="tocnumber">5</span> <span class="toctext">批量绘图</span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="#.E4.BD.BF.E7.94.A8.E5.85.B6.E4.BB.96.E5.B7.A5.E4.BD.9C.E8.96.84.2F.E5.B7.A5.E4.BD.9C.E8.A1.A8.2F.E6.95.B0.E6.8D.AE.E5.88.97.E5.86.85.E6.95.B0.E6.8D.AE.E5.A4.8D.E5.88.B6.E5.9B.BE.E5.BD.A2"><span class="tocnumber">5.1</span> <span class="toctext">使用其他工作薄/工作表/数据列内数据复制图形</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#.E5.B7.A5.E4.BD.9C.E8.96.84.E4.BD.9C.E4.B8.BA.E6.A8.A1.E6.9D.BF.E5.8E.BB.E5.A4.84.E7.90.86.E5.A4.9A.E4.B8.AA.E6.96.87.E4.BB.B6"><span class="tocnumber">5.2</span> <span class="toctext">工作薄作为模板去处理多个文件</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-10"><a href="#.E6.89.B9.E9.87.8F.E5.88.86.E6.9E.90"><span class="tocnumber">6</span> <span class="toctext">批量分析</span></a>
<ul>
<li class="toclevel-2 tocsection-11"><a href="#.E5.AF.B9.E8.AF.9D.E6.A1.86.E5.86.85.E5.88.86.E6.9E.90.E5.A4.9A.E4.B8.AA.E6.95.B0.E6.8D.AE"><span class="tocnumber">6.1</span> <span class="toctext">对话框内分析多个数据</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#.E4.BD.BF.E7.94.A8.E5.BF.AB.E6.8D.B7.E5.88.86.E6.9E.90.E5.B7.A5.E5.85.B7.E5.88.86.E6.9E.90.E5.A4.9A.E6.9D.A1.E6.9B.B2.E7.BA.BF"><span class="tocnumber">6.2</span> <span class="toctext">使用快捷分析工具分析多条曲线</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#.E4.BD.BF.E7.94.A8.E5.88.86.E6.9E.90.E6.A8.A1.E6.9D.BF.E6.89.B9.E9.87.8F.E5.88.86.E6.9E.90"><span class="tocnumber">6.3</span> <span class="toctext">使用分析模板批量分析</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-14"><a href="#.E5.AF.B9.E5.85.B6.E4.BB.96.E6.95.B0.E6.8D.AE.E6.88.96.E7.BB.98.E5.9B.BE.E9.87.8D.E5.A4.8D.E5.88.86.E6.9E.90.E6.93.8D.E4.BD.9C"><span class="tocnumber">7</span> <span class="toctext">对其他数据或绘图重复分析操作</span></a></li>
<li class="toclevel-1 tocsection-15"><a href="#.E9.87.8D.E5.A4.8D.E6.AD.A4.E6.93.8D.E4.BD.9C"><span class="tocnumber">8</span> <span class="toctext">重复此操作</span></a></li>
<li class="toclevel-1 tocsection-16"><a href="#.E4.BD.BF.E7.94.A8.E6.95.B0.E6.8D.AE.E7.AD.9B.E9.80.89.E5.99.A8.E9.87.8D.E5.A4.8D.E5.88.86.E6.9E.90"><span class="tocnumber">9</span> <span class="toctext">使用数据筛选器重复分析</span></a></li>
<li class="toclevel-1 tocsection-17"><a href="#.E7.BC.96.E7.A8.8B.E8.BF.9B.E8.A1.8C.E8.87.AA.E5.8A.A8.E5.8C.96.E4.BB.BB.E5.8A.A1"><span class="tocnumber">10</span> <span class="toctext">编程进行自动化任务</span></a></li>
<li class="toclevel-1 tocsection-18"><a href="#.E7.9F.A5.E8.AF.86.E7.82.B9.E6.89.A9.E5.B1.95"><span class="tocnumber">11</span> <span class="toctext">知识点扩展</span></a></li>
</ul>
</div>

<h2><a name=".E5.88.86.E6.9E.90.E6.8A.A5.E5.91.8A.E8.A1.A8"></a><span class="mw-headline">分析报告表</span></h2>
<dl><dd><a  class="image"><img alt="UG Analysis Report Sheet.png" src="../images/How_to_Handle_Repetitive_Tasks/UG_Analysis_Report_Sheet.png?v=9418" width="799"  /></a></dd></dl>
<p>分析操作，比如执行列在<a href="../../GettingStarted/OriginLab/Data_Analysis.html" title="OriginLab:Data Analysis">分析</a>或者<a href="../../GettingStarted/OriginLab/Statistics.html" title="OriginLab:Statistics">统计</a>章节的工具，都会产生详细的<b>分析报告表</b>。
</p>
<ul><li> 分析报告表包含组织成树状结构的表格。</li>
<li> 表格内容可以通过展开或折叠分支分别显示或隐藏。</li>
<li> 表格并不是静态的报告。这些表格是使用占位符的方式，每个占位符都链接到一个分析结果，因此，当输入数据或分析参数改变时，结果是可以<a href="../../GettingStarted/OriginLab/How_to_Handle_Repetitive_Tasks.html#Recalculation" title="OriginLab:How to Handle Repetitive Tasks">重计算的</a>。</li>
<li> 您可以给这些表格添加注释，或者复制，然后粘贴到其它窗口，或者只是粘贴这个表格的链接。</li>
<li> 分析报告表经常会嵌入一些图形，比如拟合曲线图或残差图。如果要自定义这些绘图，双击该图即可。这样就在另一个窗口打开这个嵌入的图，然后就可以用迷你工具栏或绘图细节对话框来设置图。完成设置后，点击关闭<a  class="image"><img alt="Button close embedded.png" src="../images/How_to_Handle_Repetitive_Tasks/Button_close_embedded.png?v=9419" width="32"  /></a>按钮，修改好的图又会回到报告表对应的位置。</li></ul>
<p>更多关于<b>分析报告表</b>内容，请参阅<a class="external text" href="../../UserGuide/UserGuide/Analysis_Report_Sheets_and_Columns.html">Origin 帮助文件</a>。
</p>
<h2><a name=".E9.87.8D.E6.96.B0.E8.AE.A1.E7.AE.97"></a><span class="mw-headline">重新计算</span></h2>
<p><span class="OIndex" style="display:none">结果重新计算</span>
所有的分析和大多数的数据处理对话框都有一个<a class="external text" href="../../UserGuide/UserGuide/Recalculating_Analysis_Results.html">重新计算</a> <b><span class="OIndex" style="display:none">重新计算</span></b>控件。此控件允许您将当前操作的输出与源数据绑定起来，以便源数据发生任何更改时，都可以触发输出结果的更新。这样你便可以分析多个数据，比如通过接续导入新的数据去替换已存在的数据。这个功能也是创建<b>分析模板</b>的基础。分析模板的概念会在下方详细介绍。
<span class="OIndex" style="display:none">自动重算</span>
<span class="OIndex" style="display:none">手动重算</span>
<span class="OIndex" style="display:none">锁，重新计算</span>
<br /> 
</p>
<dl><dd><a  class="image"><img alt="LR dialog recalc 1.png" src="../images/How_to_Handle_Repetitive_Tasks/LR_dialog_recalc_1.png?v=4126" width="450"  /></a></dd></dl>
<p><br />
<b>重新计算</b>控件包含3个选项：
</p>
<table class="simple">
<tr>
<th style="width: 10%">无
</th>
<td>
<ul><li> 结果中不会显示锁状图标。</li>
<li> 更改输入数据不会导致输出结果的更新。</li></ul>
</td></tr>
<tr>
<th> 自动
</th>
<td>
<ul><li> 一个 <b>自动</b> 绿锁图标<a  class="image"><img alt="Operation lock auto.png" src="../images/How_to_Handle_Repetitive_Tasks/Operation_lock_auto.png?v=4127" width="14"  /></a>会显示在输出列和包含输出数据的图形窗口上。当输出结果为多列时，最左侧的输出列上会显示主操作锁<a  class="image"><img alt="Operation lock auto.png" src="../images/How_to_Handle_Repetitive_Tasks/Operation_lock_auto.png?v=4127" width="14"  /></a>，而在其右侧的所有相关操作列上均显示 "+" 图标<a  class="image"><img alt="Operation lock auto related.png" src="../images/How_to_Handle_Repetitive_Tasks/Operation_lock_auto_related.png?v=9873" width="11"  /></a>。</li>
<li> 当输入数据变化时，输出会自动更新。</li>
<li> 你也可以点击绿锁重新打开对话框去变更分析设置。</li></ul>
</td></tr>
<tr>
<th> 手动
</th>
<td>
<ul><li> 一个 <b>手动</b> 绿锁图标<a  class="image"><img alt="Operation lock manual.png" src="../images/How_to_Handle_Repetitive_Tasks/Operation_lock_manual.png?v=4128" width="13"  /></a>会显示在输出列和包含输出数据的图形窗口上。当输出结果为多列时，最左侧的输出列上会显示主操作锁<a  class="image"><img alt="Operation lock manual.png" src="../images/How_to_Handle_Repetitive_Tasks/Operation_lock_manual.png?v=4128" width="13"  /></a>，而在其右侧的所有相关操作列上均显示 "+" 图标<a  class="image"><img alt="Operation lock auto related.png" src="../images/How_to_Handle_Repetitive_Tasks/Operation_lock_auto_related.png?v=9873" width="11"  /></a>。</li>
<li> 当输入数据改变时，锁状图标会变成黄色<a  class="image"><img alt="Operation lock manual pending.png" src="../images/How_to_Handle_Repetitive_Tasks/Operation_lock_manual_pending.png?v=4129" width="14"  /></a>。你可以手动的触发更新每个操作，或者项目文件中所有等待的操作。</li>
<li> 你也可以点击绿锁重新打开对话框去变更分析设置。</li></ul>
</td></tr></table>
<p><br />
<span class='headerInParagraph'>如何管理重新计算操作</span>
</p>
<ul><li> 左击锁状图标会显示一个菜单，这个菜单提供了很多选项，包括更改分析参数，打开源数据，切换到结果表，和控制操作的状态（比如将手动更新变为自动更新）。</li>
<li> 在 <b>标准</b> 工具栏有一个 <b>重新计算</b> 按钮。当所有项目操作都是最新的时候， 显示为绿色  <a  class="image"><img alt="Button Recalculate Auto.png" src="../images/How_to_Handle_Repetitive_Tasks/Button_Recalculate_Auto.png?v=4179" width="22"  /></a> 。 当有待处理的重计算操作时，显示为黄色  <a  class="image"><img alt="Button Recalculate Manual.png" src="../images/How_to_Handle_Repetitive_Tasks/Button_Recalculate_Manual.png?v=4180" width="22"  /></a>。当您打开项目文件， 看到 <b>重新计算</b> 按钮是黄色的时候， 说明有操作是待计算状态的， 您所看到的图或者数据结果并不是最新的。 </li>
<li> 如果锁图标显示为深灰色 <a  class="image"><img alt="Gray lock pro only.png" src="../images/How_to_Handle_Repetitive_Tasks/Gray_lock_pro_only.png?v=4974" width="15"  /></a>, 这说明相关的操作是在 <a class="external text" href="https://www.originlab.com/index.aspx?go=Products/Origin" target="_blank">OriginPro</a> 中执行的。但这项目文件目前在 Origin 标准版中打开。Origin 标准版不支持该操作。，如果希望修改或重新运行这个分析工具. 您需要在 OriginPro 中使用这个项目文件。</li>
<li> 如果锁图标是红色的 <a  class="image"><img alt="Broken operation lock.png" src="../images/How_to_Handle_Repetitive_Tasks/Broken_operation_lock.png?v=7915" width="15"  /></a> ， 一定是发生了问题， 导致重计算操作无法进行。 这种情况并不常见但也还是会发生， 例如如果您把一个包含用户自定义曲线拟合操作的项目文件分享给了同事，但又没有提供给他自定义的那个曲线函数。就会发生这种情况。</li>
<li> 在项目文件中有许多重新计算操作会减慢您的工作速度。从 Origin 2019 开始, 您可以通过单击锁图标并从弹出菜单中选择 <b>阻止重算</b> 来阻止重新计算 (包括 <b>手动</b> 和 <b>自动</b> 重计算)。当有待处理的重计算操作时，会显示为黄色的“阻止”图标 <a  class="image"><img alt="Button block recalculation manual.png" src="../images/How_to_Handle_Repetitive_Tasks/Button_block_recalculation_manual.png?v=7916" width="15"  /></a> ，当所有操作都是最新的时候， 这个"阻止"图标显示为绿色 <a  class="image"><img alt="Button block recalculation auto.png" src="../images/How_to_Handle_Repetitive_Tasks/Button_block_recalculation_auto.png?v=7917" width="15"  /></a> 。如果希望清除 "阻止重算" 状态, 点击"阻止"图标然后在菜单那反选 <b>阻止重选</b> (注意， 如果您设置了阻止重算， 当您点选 <b>重新计算</b> 按钮 </li></ul>
<p><a  class="image"><img alt="Button Recalculate Manual.png" src="../images/How_to_Handle_Repetitive_Tasks/Button_Recalculate_Manual.png?v=4180" width="22"  /></a> 时， 被阻止的操作是不会被重算的。)
</p>
<ul><li> 要暂停所有重新计算，请按“Ctrl+0”，选择<b>分析：暂停自动重新计算</b>（仅限工作表）或单击标准栏上<b>暂停自动重新计算</b>按钮<a  class="image"><img alt="Button pause recalculation.png" src="../images/How_to_Handle_Repetitive_Tasks/Button_pause_recalculation.png?v=11064" width="25"  /></a>。</li>
<li> 您可以在图形窗口隐藏重新计算的锁图标。方法是， 单击图，然后从主菜单中选择 <b>查看: 显示: 锁图标</b> 这个操作只会隐藏锁图标， 并不会影响或移除所有图中相关的重计算操作。如果希望重新显示锁图标， 重新点选一下上述菜单。</li></ul>
<h2><a name=".E5.AF.B9.E8.AF.9D.E6.A1.86.E4.B8.BB.E9.A2.98"></a><span class="mw-headline">对话框主题</span></h2>
<p><span class="OIndex" style="display:none">对话框主题</span>
<span class="OIndex" style="display:none">主题，对话框</span>
分析对话框和很多数据处理对话框的设置可以被保存在<b>对话框主题</b>文件中。一旦保存，这些包含自定义设置的主题文件可以根据需要重新调用。一个对话框可以保存多个主题文件，这样你便可以对需要不同分析设置的数据，简单快捷的进行重复性分析。
</p><p>最后使用的对话框设置会自动保存到<b>&lt;上次使用的&gt;</b>主题中。Origin也允许用户保存自己自定义的设置为<b>默认</b>主题。默认主题，上次使用的主题和有保存并命名的主题可以通过对话框的<b>主题</b>弹出式菜单被调用。这些类似的主题在可在与分析对话框相对应的主菜单中被调用。<br />
</p><p><a  class="image"><img alt="Analysis themes menu.png" src="../images/How_to_Handle_Repetitive_Tasks/Analysis_themes_menu.png?v=4130" width="600"  /></a><br />
</p><p>对话框主题可以使用<b>主题管理器</b>（<b>工具：主题管理器</b>）工具进行管理。
</p>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_to_Handle_Repetitive_Tasks/Tutorial_icon.png?v=0" width="57"  border="0" />
	</td>
	<td><p><b> 教程：保存和重新使用对话框主题</b>
</p>
<ol><li> 导入文件<b>Linear Fit.dat</b>，它位于<b>Samples\Curve Fitting\</b>子文件夹。</li>
<li> 选中列B，然后选择<b>分析：拟合：线性拟合...</b>。</li>
<li> 在<b>线性拟合</b>对话框中，勾选<b>固定截距</b>复选框（位于<b>拟合控制</b>选项卡下），然后在<b>固定截距为</b>文本框输入<b>0</b>。</li>
<li> 点击<b>对话框主题</b>控件旁的按钮<a  class="image"><img alt="Button Save Theme.png" src="../images/How_to_Handle_Repetitive_Tasks/Button_Save_Theme.png?v=3787" width="21"  /></a>，选择<b>另存为</b>，然后在<b>主题名称</b>框内输入<b>零截距</b>，按下确认键。再次按下确认键去关闭线性拟合对话框，从而执行分析操作。<b>FitLinear1</b>和<b>FitLinearCurve1</b>这两个分析结果表会被添加到工作薄。</li>
<li> 回到源数据所在的工作表，选中列C，然后选择<b>分析：拟合：线性拟合...</b>菜单，你会看到弹出菜单中有多个主题选项，包括你之前保存的<b>零截距</b>主题。 </li>
<li> 选择这个你保存的主题，Origin会根据你保存在主题中的设置，对列C做同样的分析操作。注意，这次<b>线性拟合</b>对话框不会打开。</li></ol>
</td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_to_Handle_Repetitive_Tasks/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p><b>关于主题的一些提示:</b>
</p>
<ul><li> 按住<b>SHIFT</b>键同时点击主菜单中你的主题，相应的对话框将会被打开，同时你选择的主题中的设置也会被载入到对话框内。</li>
<li> Origin自带的默认主题叫做<b>系统默认</b>。你可以在分析对话框内点击弹出菜单，并选择<b>系统默认</b>去载入它。</li>
<li> 点击分析对话框中的弹出菜单，选择<b>删除</b>去删掉你创建的主题，包括自定义的&lt;默认&gt;主题。</li>
<li> 所有对话框的自定义&lt;默认&gt;主题被保存在用户文件夹的Defaults.xml文件中。删掉该文件以恢复系统默认设置。 </li></ul>
</td></tr></table>
<h2><a name=".E9.A1.B9.E7.9B.AE.E5.92.8C.E5.B7.A5.E4.BD.9C.E8.96.84.E6.A8.A1.E6.9D.BF"></a><span class="mw-headline">项目和工作薄模板</span></h2>
<p><span class="OIndex" style="display:none">Templates, Workbook</span>
<span class="OIndex" style="display:none">Templates, Project</span>
将单个工作簿或整个项目保存为“模板”文件有很多原因，以下是一些典型方案：
</p>
<ul><li>您可能始终需要导入具有固定数量的列的数据文件以及列指定的重复模式（例如XYYError，XYYError等），因此您只需为导入这些文件创建自定义工作簿（<b>文件:将模板另存为</b>）。</li>
<li>您定期导入类似结构的数据文件，并对数据执行一些例行图形和分析操作，然后使用嵌入了工作表或工作簿的Notes窗口生成报告。这将是<a href="../../GettingStarted/OriginLab/How_to_Handle_Repetitive_Tasks.html#Batch_Analysis_Using_an_Analysis_Template" title="OriginLab:How to Handle Repetitive Tasks">分析模板</a>（<b>文件：保存工作簿为分析模板</b>）的典型示例。</li>
<li>您执行的操作类似于上一个示例中描述的操作，但您无法将工作簿保存为分析模板，因为所有数据都会在保存时从工作簿中清除，这会破坏您依赖一组参考值的分析。相反，您可以选择仅清除导入的数据并将工作簿另存为窗口文件（<b>文件：保存窗口为</b>）。这样可以保留参考数据表，就像分析模板一样，可以使用工作簿保存分析和绘图操作。</li>
<li>您经常导入数据，进行一些分析并生成报告，并希望使用分析模板概念（如第二个项所示），但您的项目中有多个窗口，包括无法嵌入工作簿的布局窗口。因此，单个工作簿分析模板将无法完成工作。在这种情况下，您可以通过“克隆”它来保存没有数据的项目（<b>文件：克隆当前项目</b>）。</li></ul>
<h3><a name=".E5.B0.86.E5.B7.A5.E4.BD.9C.E8.96.84.E4.BD.9C.E4.B8.BA.E6.A8.A1.E6.9D.BF"></a><span class="mw-headline">将工作薄作为模板</span></h3>
<p>一个工作簿可以包含多个工作表，工作表中可以包含有数据、元数据、浮动或嵌入的图形、嵌入矩阵以及嵌入备注窗口， 还可以有脚本、变量或其他支持数据. <span class="OIndex" style="display:none">嵌入图, 模板</span> <span class="OIndex" style="display:none">Embed Graphs, Origin Templates</span>
</p><p>我们可以把一个工作簿存为模板， 以便进行重复性绘图和/或分析任务。根据我们的需求， 有三种不同的方式保存工作簿 -- <b>工作簿</b> (OGWU), <b>模板</b> (OTWU) 或者 <b>分析模板</b> (OGWU):
</p>
<ul><li> <b>工作簿 (OGWU)</b>: 选择 <b>文件: 保存窗口为</b> ， 这将保存工作簿中所有的内容.</li>
<li> <b>分析模板 (OGWU)</b>: 选择 <b>文件: 保存工作簿为分析模板</b> 这将在保存工作簿时清除掉所有用于分析操作的源数据并保留所有的分析（重计算）操作. 注意，如果数据跟分析操作无关时， 这些数据也会被保留。<span class="OIndex" style="display:none">Analysis Templates</span><span class="OIndex" style="display:none">Templates, Analysis</span> <span class="OIndex" style="display:none">分析模板</span><span class="OIndex" style="display:none">模板, 分析</span> </li>
<li> <b>模板 (OTWU)</b>: 选择 <b>文件: 保存模板为</b>，这将保留工作簿的结构， 以及所有的分析操作， 但所有的数据， 无论跟分析是否关联，都会被清除。</li></ul>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_to_Handle_Repetitive_Tasks/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p><b>新工作簿</b> 对话框是一个升级版的模板库，用于管理工作簿、矩阵簿和分析模板。请参阅<a href="../../GettingStarted/OriginLab/Workbooks_Worksheets_Columns.html#Workbooks" title="OriginLab:Workbooks Worksheets Columns">工作簿</a> 获得此对话框的特性概览。
</p></td></tr></table>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_to_Handle_Repetitive_Tasks/Tutorial_icon.png?v=0" width="57"  border="0" />
	</td>
	<td><p><b>教程：创建一个分析模板</b>
</p>
<ol><li> 创建一个新工作薄，并导入数据<b>Samples\Curve Fitting\Sensor01.dat</b>。</li>
<li> 选择列B，然后使用<b>分析：拟合：线性拟合</b>打开<b>线性拟合</b>对话框。</li>
<li> 将<b>重新计算</b>设为<b>自动</b>。</li>
<li> 在<b>拟合控制</b>选项卡中，勾选<b>固定截距</b>复选框，在<b>固定截距为</b>文本框内输入<b>0</b>。</li>
<li> 点击确认以关掉对话框，并对源数据进行线性回归。</li>
<li> 去到<b>FitLinear1</b>结果报表查看结果，包括含有最终拟合曲线和残余的图形。 </li>
<li> 回到原始数据表，导入文件<b>Samples\Curve Fitting\Sensor02.dat</b>。分析结果会自动更新。你可以继续使用该工作薄去分析其他数据。或者，右击工作薄窗口的标题，选择<b>不带数据复制</b>去创建一个新的包含线性回归操作的工作薄。然后导入新的数据到这个新的工作薄，然后将多个这样的工作薄保存到项目中。</li>
<li> 当工作薄处于激活状态，选择菜单<b>文件：保存工作薄为分析模板...</b>，再在打开的对话框内，输入一个名字，比如<b>Linear Fit of Sensor Data</b>，然后点击<b>保存</b>按钮。</li>
<li> 选择<b>文件：最近使用的工作薄</b>菜单项，选择前一步中保存的模板，则工作薄会被打开，其数据表为空。</li>
<li> 导入文件<b>Samples\Curve Fitting\Sensor3.dat</b>到空的数据表中（第一个表）。分析结果会根据新导入数据而更新。</li></ol>
</td></tr></table>
<p><i>分析模板'</i>可以包括摘要表和自定义报告表（<a class="external text" href="../../Tutorial/Tutorial/Creating_a_Custom_Report_Sheet.html">基于工作表</a>或<a href="../../GettingStarted/OriginLab/Publishing_and_Export.html#HTML_Reports_from_Notes_Windows" title="OriginLab:Publishing and Export">HTML</a>），它们可以成为导入，分析，绘制和报告常规分析结果的理想媒介。 当与<a class="external text" href="../../UserGuide/UserGuide/Batch_Processing.html"><b>批处理</b>工具</a>结合使用时，您可以重复任意数量数据文件的分析和绘图操作，并在处理时为每个文件创建PDF摘要报告。 查看本章的[[OriginLab:How_to_Handle_Repetitive_Tasks#Batch_Plotting|<b>批量绘图</b>]和<a href="../../GettingStarted/OriginLab/How_to_Handle_Repetitive_Tasks.html#Batch_Analysis" title="OriginLab:How to Handle Repetitive Tasks">'<i>批量分析</i></a>部分，以获取使用工作簿作为模板处理重复性任务的实例。
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_to_Handle_Repetitive_Tasks/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>备注窗口支持对 <b>HTML</b> 格式。 您可以将这些 Notes 窗口添加到工作簿中（右键单击工作表选项卡并选择 <b>添加备注为新的工作表</b>），从而可以非常轻松地将 HTML 报告合并到分析模板中。 有关详细信息，请参阅<a href="../../GettingStarted/OriginLab/Publishing_and_Export.html#HTML_Reports_from_Notes_Windows" title="OriginLab:Publishing and Export"><b>来自Notes窗口的HTML报告</b></a>。
</p></td></tr></table>
<h3><a name=".E5.B0.86.E9.A1.B9.E7.9B.AE.E4.BD.9C.E4.B8.BA.E6.A8.A1.E6.9D.BF"></a><span class="mw-headline">将项目作为模板</span></h3>
<p>Origin项目文件也可以用作执行重复绘图和分析任务的“模板” - 尤其是当您的分析和绘图任务无法在单个工作簿中完成时。
</p><p>创建“项目模板”的基本步骤如下：
</p>
<ol>
<li>从工作簿中的数据创建所需的图形和/或分析结果，然后保存项目。 </li>
<li>保存项目后，选择<b>文件：克隆当前项目</b>。将打开一个对话框，用于配置克隆项目：
<dl><dd><dl><dd><a  class="image"><img alt="ClrAllData Dialog.png" src="../images/How_to_Handle_Repetitive_Tasks/ClrAllData_Dialog.png?v=8763" width="326"  /></a></dd></dl></dd></dl>
</li>
<ul>
<li>'<i>添加数据连接器<b>：选中此框可将克隆项目中的</b>数据连接器</i>添加到已保存的项目中。每个克隆的工作表都将与已保存项目中的原始工作表建立连接。如果您计划从克隆项目中的其他类似文件导入数据，则应清除此框。</li>
<li><b>全部清除</b>：仅清除导入的数据。分析操作保留在克隆的项目中。 </li>
<li><b>清除导入的数据和删除计算</b>：清除导入的数据和分析操作。</li>
</ul>
<li>点击“确定”以创建克隆项目。清除选定的数据，并将名为UNTITLED的克隆项目添加到工作区。</li>
<li>命名并保存克隆项目，当您准备处理更多数据文件时，可以打开它并导入新数据：</li>
<ul>
<li>如果您的分析和图形操作链接到定期更新的特定数据文件，则不一定需要使用连接器。您只需重新导入文件（'<i>数据：重到数据...<b>或</b>直接重导数据</i>。）</li>
<li>如果使用<a href="../../GettingStarted/OriginLab/Import_Data.html#Data_Connectors" title="OriginLab:Import Data">数据连接器</a>链接您的操作，请单击连接器图标<a  class="image"><img alt="DC Icon Live.png" src="../images/How_to_Handle_Repetitive_Tasks/DC_Icon_Live.png?v=10100" width="18"  /></a>，然后从弹出菜单中选择<b>导入</b>（此仅限连接器）或<b>全部导入</b>（工作薄中的所有连接器）。</li>
<li>一种可能的情况是您将所有数据存储在单个Origin项目文件中。如果已将克隆项目中的数据连接器添加到原始项目，则可以选择性地仅导入执行图形和分析操作所需的数据。完成后，您可以将文件保存为新名称，保留克隆的项目以便重复使用。</li>
</ul>
</ol>
<h2><a name=".E6.89.B9.E9.87.8F.E7.BB.98.E5.9B.BE"></a><span class="mw-headline">批量绘图</span></h2>
<p><span class="OIndex" style="display:none">批量绘图</span>
Origin提供了多种批量绘图的方法，这些图的原始数据可能来自多个数据或者文件。以下两个章节大概描述了怎样创建多幅图，通过使用（1）已经在工作表中的数据和（2）多个数据文件。除了这两个方法，你也可以使用LabTalk和OriginC脚本去程序化批量绘图。 
</p>
<h3><a name=".E4.BD.BF.E7.94.A8.E5.85.B6.E4.BB.96.E5.B7.A5.E4.BD.9C.E8.96.84.2F.E5.B7.A5.E4.BD.9C.E8.A1.A8.2F.E6.95.B0.E6.8D.AE.E5.88.97.E5.86.85.E6.95.B0.E6.8D.AE.E5.A4.8D.E5.88.B6.E5.9B.BE.E5.BD.A2"></a><span class="mw-headline">使用其他工作薄/工作表/数据列内数据复制图形</span></h3>
<p>如果你有多个工作薄，工作表或者数据列，它们与你用于绘制图形的数据具有相同的数据结构，你可以使用Origin克隆图形，通过对新数据使用<b>窗口：复制（批量绘图）</b>菜单。这里，分两种情况：
</p>
<ul><li> 如果你使用了某个数据画了一个图，然后做了一些自定义设置，然后想要使用同一个工作表中的其他数据去克隆该图形：选择<b>窗口：复制（批量绘图）：选择新列复制...</b>菜单，然后选择你需要绘制的其他数据（列）. 每个数据列都会被绘制成一个新图。</li>
<li> 如果你使用同一个工作表或者工作薄的数据进行绘图，然后做了一些自定义设置，然后想要使用其它具有相同数据结构的工作表或者工作薄去克隆该图形：选择<b>窗口：复制（批量绘图）：选择新工作薄复制/选择新工作表复制</b>菜单。Origin会将所有具有相似结构的工作表或者工作薄列出来。选择你想用于绘图的工作表或者工作薄。每个工作表或者工作薄会被绘制成一个新图。<span class="OIndex" style="display:none">图形，使用数据克隆</span></li></ul>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_to_Handle_Repetitive_Tasks/Tutorial_icon.png?v=0" width="57"  border="0" />
	</td>
	<td><p><b>教程：使用其它工作薄/工作表数据复制图形</b>
</p>
<ol><li> 在<b>标准</b>工具栏点击<b>新建项目</b>按钮<a  class="image"><img alt="Button New Project.png" src="../images/How_to_Handle_Repetitive_Tasks/Button_New_Project.png?v=4907" width="22"  /></a>。</li>
<li> 点击<b>导入向导</b>按钮<a  class="image"><img alt="Button Import Wizard.png" src="../images/How_to_Handle_Repetitive_Tasks/Button_Import_Wizard.png?v=4864" width="25"  /></a>去打开导入向导对话框。</li>
<li> 点击<b>文件</b>框右边的浏览按钮<a  class="image"><img alt="Button Browse.png" src="../images/How_to_Handle_Repetitive_Tasks/Button_Browse.png?v=4798" width="20"  /></a>去到文件夹<b>Import and Export</b>选择文件<b>S15-125-03.dat</b>，<b>S21-235-07.dat</b>和<b>S32-014-04.dat</b>。点击<b>添加文件</b>，然后按下<b>确认</b>键。在导入向导中，点击<b>完成</b>键。文件将会被导入到三个不同的工作薄。 </li>
<li> 拖动以选择其中一个工作薄中的所有三列数据，然后选择菜单<b>绘图&gt;2D:多Y轴图：3Ys Y-YY</b>去创建一个共用X轴多个Y轴的图形。对图形做一些想要的自定义设置。 </li>
<li> 右击图形窗口的标题栏，选择<b>复制（批量绘图）：选择新工作薄复制...'</b>或者<b>复制（批量绘图）：选择新工作表复制...'</b>快捷菜单。</li>
<li> 在打开的对话框中，选择其他两个工作薄/工作表，然后按下确认键关闭对话框。另外两个图像会被绘制，它们使用你选择的那两个工作薄/工作表。 </li></ol>
</td></tr></table>
<h3><a name=".E5.B7.A5.E4.BD.9C.E8.96.84.E4.BD.9C.E4.B8.BA.E6.A8.A1.E6.9D.BF.E5.8E.BB.E5.A4.84.E7.90.86.E5.A4.9A.E4.B8.AA.E6.96.87.E4.BB.B6"></a><span class="mw-headline">工作薄作为模板去处理多个文件</span></h3>
<p>如果你想对多个文件绘图，但又不想在绘图之前将它们导入工作薄，你可以先导入一个文件，将其绘图，然后将图形加到你的工作薄，保存工作薄成一个模板。使用这个模板你可以处理多个文件，每个文件会生成一个包含相应图形的工作薄。
</p>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_to_Handle_Repetitive_Tasks/Tutorial_icon.png?v=0" width="57"  border="0" />
	</td>
	<td><p><b>教程：从多个数据文件创建图形</b>
</p>
<ol><li> 激活一个新工作薄，选择<b>文件：导入：单个ASCII文件</b>菜单，然后从Origin安装文件夹下子文件夹<b>Samples\Curve Fitting</b>中导入文件<b>Sensor01.dat</b>。</li>
<li> 选中列B，创建一个点线图。</li>
<li> 双击X轴打开<b>坐标轴</b>对话框。确保<b>刻度</b>选项卡被激活，然后选择左面板的<b>水平</b>和<b>垂直</b>图标，将<b>缩放</b>设为<i>自动</i>。这样，图形的刻度会基于数据自动更新。 </li>
<li> 在工作薄中，右击工作表选项卡，选择<b>添加图形为新的工作表</b>右键菜单项，然后选择上一步创建的图形。这样一个新的工作表将被创建，其中包含了一个迁入的图形。</li>
<li> 回到数据所在的工作表，双击选项卡重命名为<b>Data</b>。</li>
<li> 选择<b>工作表：清除工作表</b>菜单去清除工作表中的数据。注意，这一步不是必需的。清掉数据会大大减小模板文件（在下一步将会保存该文件）的大小。注意，你只能清掉数据工作表，而不能对其他工作表（比如包含嵌入式图片的那些工作表）进行此操作。</li>
<li> 选择<b>文件：保存窗口为...</b>菜单项，将其命名为<b>Sensor Data and Graph</b>，然后点击<b>保存</b>。</li>
<li> 现在，我们可以调用这个模板去处理多个文件。选择<b>文件：批处理</b>菜单。</li>
<li> 在打开的对话框中，将<b>批处理模式</b>设置为<b>加载分析模板</b>，然后将你刚刚保存的模板为<b>分析模板</b>。</li>
<li> 将<b>数据源</b>设为<b>从文件导入</b>，然后选择<b>Samples\Curve Fitting</b>文件夹下的这三个文件<b>Sensor01.dat</b>，<b>Sensor02.dat</b>和<b>Sensor03.dat</b>。</li>
<li> 将<b>数据表</b>设为<b>Data</b>将<b>结果表</b>设为<b>无</b>。 </li>
<li> 按下确认键，关闭对话框。你应该会得到三个工作薄，它们中数据被导入到第一个工作表，图形在第二个工作表中，会自动更新。如需进一步编辑图形，在工作表中双击它就可以进入可编辑页面。</li></ol>
</td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_to_Handle_Repetitive_Tasks/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>如果你的数据需要一些自定义导入设置，你可以在导入对话框中将这些设置保存到数据表中（在<b>对话框主题</b>菜单中选择<b>保存到&lt;表&gt;</b>）。这样，当你将工作薄作为模板去批处理多个文件时，这些被保存到工作表的设置会被用于导入数据。
</p></td></tr></table>
<h2><a name=".E6.89.B9.E9.87.8F.E5.88.86.E6.9E.90"></a><span class="mw-headline">批量分析</span></h2>
<p>Origin提供了多种方法对多个文件，多个数据列或者多个数据图线进行批量分析。 
</p>
<h3><a name=".E5.AF.B9.E8.AF.9D.E6.A1.86.E5.86.85.E5.88.86.E6.9E.90.E5.A4.9A.E4.B8.AA.E6.95.B0.E6.8D.AE"></a><span class="mw-headline">对话框内分析多个数据</span></h3>
<p>很多分析对话框，比如线性拟合和非线性拟合，支持分析多个数据。这样的对话框生成的报告表会包含一个汇总报表，列出每个数据的所有的参数值和其他相关的结果，比如拟合优度指标。这个综合报表可以被复制到一个外部的工作表以便进行进一步处理。
<br />
</p>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_to_Handle_Repetitive_Tasks/Tutorial_icon.png?v=0" width="57"  border="0" />
	</td>
	<td><p><b>教程：拟合多个数据</b>
</p>
<ol><li> 新建一个工作薄，导入Origin安装文件下这个文件，<b>Samples\Curve Fitting\Multiple Gaussians.dat</b>。</li>
<li> 将4个Y列的长名称分别设为<b>Peak 1</b>，<b>Peak 2</b>，<b>Peak 3</b>和<b>Peak 4</b>。</li>
<li> 选择这4个Y数据列，使用<b>分析：拟合：非线性曲线拟合...</b>菜单去打开<b>NLFit</b>对话框。</li>
<li> 在<b>函数</b>下拉菜单中选择<b>Gauss</b>，然后按下<b>拟合</b>按钮去执行拟合，并关闭对话框。</li>
<li> 切换到<b>FitNL1</b>结果报表。你可以看到一个名为<b>汇总</b>的表格，它里面列出了所有的数据的拟合参数值和拟合统计值。 
<dl><dd><a  class="image"><img alt="GSB Batch NLFit Summary.png" src="../images/How_to_Handle_Repetitive_Tasks/GSB_Batch_NLFit_Summary.png?v=4132" width="700"  /></a></dd></dl></li></ol>
</td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_to_Handle_Repetitive_Tasks/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>在NLFit结果报表中，点击表格<b>汇总</b>旁边的向下箭头按钮<a  class="image"><img alt="Button Extract Worksheet DropDown.png" src="../images/How_to_Handle_Repetitive_Tasks/Button_Extract_Worksheet_DropDown.png?v=4133" width="16"  /></a>选择<b>创建副本为新表</b>。这样会创建一个表格的副本，其所有单元格会链接回这个<b>汇总</b>表。 任何对于拟合的更新/改变会自动触发复制的表格的更新。这个表可以随后用于绘图或者执行进一步对于拟合参数的分析。
</p></td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_to_Handle_Repetitive_Tasks/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>如果需要枚举类是第二步中的列长名称，在第一个单元格输入一个字符串(比如，Peak 1)，选择这个单元格，将鼠标悬在右下角。当光标变为"<b>+</b>", 拖动至其他单元格，第一个单元格的内容就会被扩展到其他格。
</p>
<dl><dd><dl><dd><a  class="image"><img alt="Extend string to other cells.png" src="../images/How_to_Handle_Repetitive_Tasks/Extend_string_to_other_cells.png?v=4134" width="301"  /></a></dd></dl></dd></dl>
</td></tr></table>
<h3><a name=".E4.BD.BF.E7.94.A8.E5.BF.AB.E6.8D.B7.E5.88.86.E6.9E.90.E5.B7.A5.E5.85.B7.E5.88.86.E6.9E.90.E5.A4.9A.E6.9D.A1.E6.9B.B2.E7.BA.BF"></a><span class="mw-headline">使用快捷分析工具分析多条曲线</span></h3>
<p><span class="OIndex" style="display:none">快捷分析工具</span><span class="OIndex" style="display:none">感兴趣区域(ROI)</span>
Origin包含了多个快捷分析工具，用于对绘制的曲线进行交互式的分析。快捷分析工具提供了一系列的功能，包含选择一个感兴趣的数据区间，切换到另一个数据， 对当前的分析任务设置不同的首选项。
</p><p>大多数快捷分析工具提供了一个对当前图层所有数据线或者图像中的所有数据线进行分析的选项。这样，我们便可以利用这个选项对多个数据进行重复性分析，然后生成一个跨数据的结果列表。
</p>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_to_Handle_Repetitive_Tasks/Tutorial_icon.png?v=0" width="57"  border="0" />
	</td>
	<td><p><span class="OIndex" style="display:none">感兴趣区域(ROI)</span>
<p><b>教程：使用积分快捷工具对多个曲线积分</b>
</p>
</p>
<ol><li> 打开项目文件"Samples\Spectroscopy\Absorbance Spectra.opj"。</li>
<li> 激活图形窗口，选择<b>快捷分析：积分..."主菜单项。</b></li>
<li> 在打开的对话框中，点击<b>基线</b>选项卡，将<b>模式</b>设为<b>直线</b>。</li>
<li> 点击<b>输出</b>选项卡，展开<b>输出量到</b>节点，然后勾选<b>追加到工作表</b>。点击<b>确认</b>关闭对话框。</li>
<li> 一个感兴趣区域(ROI)框会被放置在图形上。如果需要，点击这个ROI框，调节其大小去覆盖图形的整个数据区间。积分面积会被填充为阴影。</li>
<li> 点击ROI右上部的箭头键<a  class="image"><img alt="Right arrow menu button.png" src="../images/How_to_Handle_Repetitive_Tasks/Right_arrow_menu_button.png?v=4090" width="17"  /></a> ，在菜单中选择<b>更改数据</b>切换到图层中的其他数据线。当前的基线设置对图层中的其它曲线也适用。</li>
<li> 点击箭头键<a  class="image"><img alt="Right arrow menu button.png" src="../images/How_to_Handle_Repetitive_Tasks/Right_arrow_menu_button.png?v=4090" width="17"  /></a>，选择<b>为所有曲线新建输出(N)</b>或者直接按下N字母键。所有的曲线会被积分。</li>
<li> 再次点击箭头键<a  class="image"><img alt="Right arrow menu button.png" src="../images/How_to_Handle_Repetitive_Tasks/Right_arrow_menu_button.png?v=4090" width="17"  /></a>选择<b>转到报告表</b>。展开结果数据表去查看所有曲线的积分结果。</li></ol>
<p><a  class="image"><img alt="GSB BatchAnalysis Gadget.png" src="../images/How_to_Handle_Repetitive_Tasks/GSB_BatchAnalysis_Gadget.png?v=4135" width="550"  /></a>
</p></td></tr></table>
<h3><a name=".E4.BD.BF.E7.94.A8.E5.88.86.E6.9E.90.E6.A8.A1.E6.9D.BF.E6.89.B9.E9.87.8F.E5.88.86.E6.9E.90"></a><span class="mw-headline">使用分析模板批量分析</span></h3>
<p><span class="OIndex" style="display:none">分析模板</span>
<span class="OIndex" style="display:none">模板，分析</span>
<span class="OIndex" style="display:none">分析报表</span>
<span class="OIndex" style="display:none">报表，分析</span>
<b>批处理</b>工具允许你使用分析模板处理多个文件。你可以先简单的对其中一个数据进行分析，将所有想要的结果和报表包含在一个工作薄中，然后将这个工作薄存为分析模板。然后使用这个模板在<b>批处理</b>工具中去处理所有其他的数据。你可以选择对每个文件/数据生成一个工作薄，同时你也可以选择将分析模板中的你预先配置的分析参数和其他元数据创建一个汇总报表。
</p>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_to_Handle_Repetitive_Tasks/Tutorial_icon.png?v=0" width="57"  border="0" />
	</td>
	<td><p><b>教程：使用分析模板批量分析多个文件</b>
</p>
<ol><li> 在主菜单中选择<b>文件：批处理...</b>。<b>批处理</b>对话框会被打开。</li>
<li> 将<b>批处理模式</b>设置为<b>加载分析模板</b>.</li>
<li> 按下<b>分析模板</b>框旁边的浏览键<a  class="image"><img alt="Button Browse.png" src="../images/How_to_Handle_Repetitive_Tasks/Button_Browse.png?v=4798" width="20"  /></a>去选择位于Origin安装目录中的文件夹<b>Samples\Batch Processing</b>中的文件<b>Sensor Analysis.OGW</b>。这个分析模板包含多个工作表，分别保存了线性拟合分析，报告和汇总表格。</li>
<li> 将<b>数据源</b>设为<b>从文件导入</b>，然后按下<b>文件表</b>右侧的浏览键<a  class="image"><img alt="Button Browse.png" src="../images/How_to_Handle_Repetitive_Tasks/Button_Browse.png?v=4798" width="20"  /></a>选择位于Origin安装文件夹中<b>Samples\Curve Fitting</b>子文件夹中的<b>Sensor01.dat</b>，<b>Sensor02.dat</b>和<b>Sensor03.dat</b>。</li>
<li> 将<b>数据集标识符</b>设为<b>文件名</b>。将<b>数据表</b>设为<b>Data</b>，<b>结果表</b>设为<b>Result</b>，也就是选择模板中对应的工作表。</li>
<li> 清掉<b>删除中间工作薄</b>项。</li>
<li> 点击确认键关闭对话框。这三个文件会被处理。三个包含数据，分析结果，报表的的工作薄，和第四个包含汇总报表的工作薄（包含所有数据的分析结果）会生成。</li></ol>
<p><a  class="image"><img alt="GSB BatchAnalysis Files.png" src="../images/How_to_Handle_Repetitive_Tasks/GSB_BatchAnalysis_Files.png?v=9414" width="547"  /></a>
</p></td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_to_Handle_Repetitive_Tasks/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>将初始工作簿保存为分析模板是可选的。您也可以简单地保存Origin项目（.opj），之后可以通过更换工作簿中的数据来更新所有结果和图表。 <b>批处理</b>工具有另一个选项，用于重复导入文件到活动窗口中。您可以简单的重复使用项目文件中的一个工作薄（包含了想要的分析和图形）实时更新的去批量分析。
</p></td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_to_Handle_Repetitive_Tasks/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>您可以使用自定义的“ MS Word”模板批量生成分析报告，并可以选择为每个报告输出 <b>PDF</b> 和/或 <b>MS Word</b> 格式的文件。另外还支持将多个报告合并为一个文件。想要了解有关于 <b>批处理并使用 Word 模板生成结果报告</b> 的更多信息，请参见 <a class="external text" href="../../Tutorial/Tutorial/Batch_Processing_with_Word_Template_for_Reporting.html">这个教程</a>.
</p></td></tr></table>
<h2><a name=".E5.AF.B9.E5.85.B6.E4.BB.96.E6.95.B0.E6.8D.AE.E6.88.96.E7.BB.98.E5.9B.BE.E9.87.8D.E5.A4.8D.E5.88.86.E6.9E.90.E6.93.8D.E4.BD.9C"></a><span class="mw-headline">对其他数据或绘图重复分析操作</span></h2>
<p>对于有一些分析操作，你可以先对一个数据或数据图线进行分析，然后对所有的其他的数据重复此分析操作。这个功能可以通过点击分析操作对应的锁状图标，从快捷菜单中选择一个特定的条目进行调用。在工作表数据列或者报表，点击锁状图标，菜单命令<b>对所有Y列重复此操作</b>会出现。选择它，将对原数据表中的所有Y列重复此分析操作。在图形中，点击锁状图标，菜单项<b>对所有绘图重复此操作</b>会出现。选择它，将对当前图形页中所有数据线重复此分析操作，即使图线分布在不同的图层。
</p><p>这个功能对一些只支持单数据输入的分析工具（比如<b>平滑</b>或者<b>积分</b>等等）非常有用。只要数据都包含在同一工作表中或绘制在同一图表中，就可以对所有其他数据集重复分析操作。
</p>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_to_Handle_Repetitive_Tasks/Alert_icon.png?v=0" width="57"  border="0" /></td><td><p>这个功能在 <b>Origin 2022b</b> 中有一个改动：在之前的版本中，如果在执行分析命令时，您指定了为输出结果创建一个新的工作表或工作簿，则 <b>对所有Y列重复此操作</b> 命令将为其余的 Y 列或图形都分别创建新的结果工作表或工作簿。然而，对于大多数用户而已，他们更希望将所有的结果输出到同一工作表或工作簿中，无论原来是如何指定输出结果的形式的。如果输入列共享同一列 X，则 X 列将仅在结果工作表中输出一次。若要恢复到以前的输出行为，请设置 <a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#R"><b>@RAO</b> = <i>0</i></a>（默认为 <i>1 </i>）。
</p>
	</td>
	</tr>
	</table>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_to_Handle_Repetitive_Tasks/Tutorial_icon.png?v=0" width="57"  border="0" />
	</td>
	<td><p><b>教程：对工作表中多个列进行平滑处理</b>
</p>
<ol><li> 导入文件<b>Samples\Curve Fitting\Multiple Gaussians.dat</b>到一个空的工作薄。</li>
<li> 选择B，然后选择菜单<b>分析：信号处理：平滑</b>打开<b>平滑</b>对话框。</li>
<li> 接受所有的默认设置，点击确认键执行平滑操作。一个新的列会被添加，它包含了平滑结果。</li>
<li> 在该结果输出列上，点击锁状图标<a  class="image"><img alt="Operation lock manual.png" src="../images/How_to_Handle_Repetitive_Tasks/Operation_lock_manual.png?v=4128" width="13"  /></a>，选择<b>对所有Y列重复此操作</b>。另外3个数据列会被添加，它们包含列C到列E的采用同样设置的平滑结果数据。</li></ol>
</td></tr></table>
<h2><a name=".E9.87.8D.E5.A4.8D.E6.AD.A4.E6.93.8D.E4.BD.9C"></a><span class="mw-headline">重复此操作</span></h2>
<p>通过特定的分析和一组特定的分析参数，Origin 的分析操作产生的输出结果是与源数据关联在一起的。这种关联通过分析输出结果的<a href="../../GettingStarted/OriginLab/How_to_Handle_Repetitive_Tasks.html#Recalculation" title="OriginLab:How to Handle Repetitive Tasks">“操作锁”</a>来标明。除非用户把这个操作的重计算关闭了，否则，这样的输出结果通常是被“锁定”而不能编辑的。通过阅读这一章的介绍部分的<a href="../../GettingStarted/OriginLab/How_to_Handle_Repetitive_Tasks.html#Analysis_Report_Sheets" title="OriginLab:How to Handle Repetitive Tasks">分析报告表</a>和<a href="../../GettingStarted/OriginLab/How_to_Handle_Repetitive_Tasks.html#Recalculation" title="OriginLab:How to Handle Repetitive Tasks">重计算</a>，您可以找到更多关于“操作锁”的信息。
</p><p>点击放在分析输出结果里的锁图标可以打开一个菜单，您可以通过此菜单来再次查看分析的参数或其它操作。通过点击 <b>更改参数</b>，可以再次打开对话框，对参数进行修改。
</p><p>在这个菜单的底部你将看到 <b>重复此操作</b> 选项。
</p>
<dl><dd><a  class="image"><img alt="UG lock dujplicate this operation.png" src="../images/How_to_Handle_Repetitive_Tasks/UG_lock_dujplicate_this_operation.png?v=10398" width="433"  /></a></dd></dl>
<p>这个特性的适用场景是这样的：
</p>
<ol><li> 用户对一个绘画进行了分析操作，比如，使用非线性拟合器（NLFit）进行了拟合操作。</li>
<li> 但用户不确定哪个拟合函数更加适合数据，因此尝试了一个可能适合的函数。</li>
<li> 用户点击操作结果的锁，然后选择 <b>重复此操作</b>。</li>
<li> 另一个同样的分析运作，在图形上添加了第二把操作锁。</li>
<li> 用户点击第二把操作锁，选择 <b>更改参数</b>，然后 NLFit 对话框打开，接着就可以替换拟合函数进行一个新的拟合操作。新的拟合操作产生新的输出结果，可用于与第一次的拟合函数产生的结果进行对比。</li></ol>
<dl><dd><dl><dd><a  class="image"><img alt="UG duplicate this operation nlfit.png" src="../images/How_to_Handle_Repetitive_Tasks/UG_duplicate_this_operation_nlfit.png?v=10399" width="487"  /></a></dd></dl></dd></dl>
<h2><a name=".E4.BD.BF.E7.94.A8.E6.95.B0.E6.8D.AE.E7.AD.9B.E9.80.89.E5.99.A8.E9.87.8D.E5.A4.8D.E5.88.86.E6.9E.90"></a><span class="mw-headline">使用数据筛选器重复分析</span></h2>
<p><span class="OIndex" style="display:none">用数据筛选器进行重复分析任务</span><span class="OIndex" style="display:none">重复分析，筛选器</span>
多列的大数据可以通过对一列或者多列数据使用筛选器而减小。这个<a class="external text" href="../../UserGuide/UserGuide/Data_Filter.html">数据筛选器功能</a>可以与<a class="external text" href="../../UserGuide/UserGuide/Copy_Columns_to_New_Destination.html">colcopy (复制列) X-Function</a>结合起来使用，这样对同一数据源，可以通过设置不同的筛选器条件得到多个图形。也可以对筛选得到的数据进行分析，然后调整筛选条件来比较得到的图形和分析结果。
</p><p>在原数据表中选中的数据列进行复制，进而创建一个子表去粘贴这些数据，子表的筛选条件与父表保持同步或者被锁定。当原数据表被更新，所有的子表，相关的图形和分析结果都将自动更新使用各自的筛选条件。另外，特定子表的筛选条件可以在任何时候被回推到父表。
</p><p>下图显示了原数据工作薄，包含了多个汽车制造商的数据。两个工作薄也被创建，它们包含了源数据列的子集和一个数据筛选器用于去筛选特定汽车制造商的数据。然后，对筛选后的数据进行了线性拟合，这样便可以比较两个筛选器使用后不同分析结果。
</p><p><a  class="image"><img alt="GSB DataFilter Locked.png" src="../images/How_to_Handle_Repetitive_Tasks/GSB_DataFilter_Locked.png?v=4137" width="650"  /></a>
</p>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_to_Handle_Repetitive_Tasks/Tutorial_icon.png?v=0" width="57"  border="0" />
	</td>
	<td><p><b>教程：对复制的数据列锁定一个筛选器条件</b>
</p>
<ol><li> 导入文件<b>Samples\Statistics\Automobile.dat</b>。</li>
<li> 点击列<b>Make</b>然后点击工作表数据 工具栏上的 <b>添加/移除数据筛选器</b> 图标<a  class="image"><img alt="Button Add Or Remove Data Filter.png" src="../images/How_to_Handle_Repetitive_Tasks/Button_Add_Or_Remove_Data_Filter.png?v=4138" width="23"  /></a> on the Worksheet Data toolbar.。</li>
<li> 点击该列上的筛选器图标<a  class="image"><img alt="Button Add Or Remove Data Filter.png" src="../images/How_to_Handle_Repetitive_Tasks/Button_Add_Or_Remove_Data_Filter.png?v=4138" width="23"  /></a>，在筛选器中清除除了Honda之外的所有制造商（选择<b>选择全部</b>去反选所有制造商，然后再选择Honda）。点击确认。</li>
<li> 按住CTRL键，然后选择<b>Make</b>，<b>Power</b>和<b>Engine Displacement</b>数据列。然后右击选择<b>复制列到...</b>菜单项。</li>
<li> 在打开的对话框中，展开 <b>复制标签</b> 节点，勾选 <b>长名称</b> 和 <b>单位</b>，点击 <b>确定</b>。一个新的工作表会加到工作薄。它仅包含了 Honda 的 <b>Power</b> 和 <b>Engine Displacement</b> 数据。</li>
<li> 点击并按住新工作表的选项卡,将它拖到Origin工作区域的空白处，去创建一个单独的工作薄。</li>
<li> 点击这个复制工作表上任意列的锁状图标，选择<b>工作表筛选：锁定</b>。筛选器的筛选条件会被锁定到当前工作表。如果你在原始数据工作表中更改筛选条件，那这个复制生成的工作表不会受影响。</li>
<li> 你可以回到<b>automobile</b>工作薄，点击筛选器图标并修改筛选条件为 Toyota，然后使用<b>复制列到</b>去创建一个新工作表。</li>
<li> 在Honda工作薄，选中列B，然后右击去选择<b>设置为 ：X</b>。对Toyota工作薄做同样的事情。</li>
<li> 在Honda工作薄，选择列C，点击2D图工具栏的<b>散点图</b>按钮<a  class="image"><img alt="Button Scatter Plot.png" src="../images/How_to_Handle_Repetitive_Tasks/Button_Scatter_Plot.png?v=4486" width="25"  /></a>。对Toyota工作薄做同样的事情。这样将得到两张Power vs Engine Displacement的图，一个是Honda，一个是Toyota。</li>
<li> 点击Honda图，选择 <b>分析: 拟合: 线性拟合</b>。接受对话框默认值，点击 <b>确定</b>。对 Toyata 进行同样的拟合操作。分别生成线性拟合结果报告。</li>
<li> 比较两个汽车制造商数据的拟合结果。</li></ol>
</td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_to_Handle_Repetitive_Tasks/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>默认情况下，当数据筛选器应用于分析操作的输入数据时，分析计算将自动忽略删选掉的数据（即隐藏的行）。若想要在分析计算中包括删选掉的数据，请单击绿色的锁图标，在弹出菜单中设置 <b>忽略隐藏的行</b> = <b>否</b>。
</p>
<dl><dd><dl><dd><a  class="image"><img alt="UG Ignore Hidden Rows ShortMenu.png" src="../images/How_to_Handle_Repetitive_Tasks/UG_Ignore_Hidden_Rows_ShortMenu.png?v=9040" width="439"  /></a></dd></dl></dd></dl>
</td></tr></table>
<h2><a name=".E7.BC.96.E7.A8.8B.E8.BF.9B.E8.A1.8C.E8.87.AA.E5.8A.A8.E5.8C.96.E4.BB.BB.E5.8A.A1"></a><span class="mw-headline">编程进行自动化任务</span></h2>
<p><span class="OIndex" style="display:none">Origin编程</span>
</p><p>除了上述使用用户面板自动执行任务的方法之外，图形和分析功能还可以使用LabTalk脚本语言或从Origin C或者从Python(internal或 external)以编程方式调用。由于可以使用程序调用图形主题，模板，和分析模板。你可以预先手动创建包含所有流程的模板 (图形模板，Analysis Templates&#8482; 等等)，然后根据需要，写脚本去调用这些模板。
</p><p>您可以通过浏览本用户指南的编程章节来了解Origin中可用的编程选项。 从那一章节，你可以链接到一些更深入的编程有关的帮助信息。
</p>
<h2><a name=".E7.9F.A5.E8.AF.86.E7.82.B9.E6.89.A9.E5.B1.95"></a><span class="mw-headline">知识点扩展</span></h2>
<ul><li> <a class="external text" href="../../UserGuide/UserGuide/Recalculating_Analysis_Results.html">基于数据和参数改变的分析结果重新计算</a></li>
<li> <a class="external text" href="../../UserGuide/UserGuide/Dialog_Themes.html">将分析对话框的设置保存为主体</a></li>
<li> <a class="external text" href="../../UserGuide/UserGuide/Theme_Organizer.html#The_Dialog_Themes_Tab">主题管理器，对话框主题</a></li>
<li> <a class="external text" href="../../UserGuide/UserGuide/Analysis_Templates.html">分析模板</a></li>
<li> <a class="external text" href="../../UserGuide/UserGuide/Batch_Processing.html">批处理和分析模板</a></li>
<li> <a class="external text" href="../../UserGuide/UserGuide/Copy_Paste_Operation.html">复制粘贴操作</a></li>
<li> <a class="external text" href="../../UserGuide/UserGuide/Data_Filter.html">使用数据筛选器获得不同的数据显示</a></li>
<li> <a class="external text" href="../../UserGuide/UserGuide/Analysis_Report_Sheets_and_Columns.html">分析报告表和列</a></li>
<li> <a class="external text" href="http://www.originlab.com/doc/Tutorials/Batch-Processing" target="_blank">教程：批处理</a></li>
<li> <a class="external text" href="http://originlab.com/index.aspx?go=Support/VideoTutorials&amp;ss=chm&amp;pid=1559" target="_blank">视频：批处理</a></li>
<li> <a class="external text" href="http://www.originlab.com/doc/Tutorials/Combine-QuickPeakGadget-PA" target="_blank">教程：<b>快速寻峰</b>快捷工具与<b>峰值分析</b>结合使用</a></li></ul>


