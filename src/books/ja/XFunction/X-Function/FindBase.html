<h1 class="\&quot;firstheading\&quot;">findBase</h1>
<table id="toc" class="toc" summary="Contents">
<tr>
<td>
<div id="toctitle">
<h2>内容</h2>
</div>
<ol>
<li class="kadov-p"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">メニュー情報</span></a></li>
<li class="kadov-p"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">概要</span></a></li>
<li class="kadov-p"><a href="#Additional_Information"><span class="tocnumber">3</span> <span class="toctext">追加の情報</span></a></li>
<li class="kadov-p"><a href="#Command_Line_Usage"><span class="tocnumber">4</span> <span class="toctext">コマンドラインでの使用法</span></a></li>
<li class="kadov-p"><a href="#Variables"><span class="tocnumber">5</span> <span class="toctext">変数</span></a></li>
<li class="kadov-p"><a href="#Description"><span class="tocnumber">6</span> <span class="toctext">説明</span></a></li>
<li class="kadov-p"><a href="#Example"><span class="tocnumber">7</span> <span class="toctext">サンプル</span></a></li>
<li class="kadov-p"><a href="#Algorithm"><span class="tocnumber">8</span> <span class="toctext">アルゴリズム</span></a></li>
<li class="kadov-p"><a href="#References"><span class="tocnumber">9</span> <span class="toctext">参考文献</span></a></li>
<li class="kadov-p"><a href="#Related_X-Functions"><span class="tocnumber">10</span> <span class="toctext">関連のXファンクション</span></a></li>
</ol>
</td>
</tr>
</table>
<a name="Menu_Information" id="Menu_Information"></a>
<h2><span class="mw-headline">メニュー情報</span></h2>
<a name="Brief_Information" id="Brief_Information"></a>
<h2><span class="mw-headline">概要</span></h2>
<p>XYデータ領域の基線を探します。</p>
<a name="Additional_Information" id="Additional_Information"></a>
<h2><span class="mw-headline">追加の情報</span></h2>
<p>Origin Version: 8.0 SR5</p>
<a name="Command_Line_Usage" id="Command_Line_Usage"></a>
<h2><span class="mw-headline">コマンドラインでの使用法</span></h2>
<p><code style="font-family: monospace;">findBase iy:=(1,2) pts:=4 max:=0.5;</code></p>
<a name="Variables" id="Variables"></a>
<h2><span class="mw-headline">変数</span></h2>
<table class="xfvar">
<tr>
<th style="width: 8%;">表示<br />
名</th>
<th style="width: 8%;">変数<br />
名</th>
<th style="width: 8%;">I/O<br />
と<br />
データ型</th>
<th style="width: 8%;">デフォルト<br />
値</th>
<th>説明</th>
</tr>
<tr>
<td>入力データ</td>
<td>iy</td>
<td>
<p>入力</p>
<p>XYRange</p>
</td>
<td>
<p style="text-align: center;">&lt;active&gt;</p>
</td>
<td>入力データを指定します</td>
</tr>
<tr>
<td>最小の連続する均一なポイント ( 0.5 =半分, 5 = 5ポイント)</td>
<td>flat</td>
<td>
<p>入力</p>
<p>double</p>
</td>
<td>
<p style="text-align: center;">15</p>
</td>
<td>これは実際には、<b>dir</b> が0にセットされているときのみ使われます。これを使って、基線の最小長さを定義することができます。平坦な区分がこの変数より長い場合、そのセクションは基線と見なされます。値が1より小さい場合、これは入力曲線全体の長さに対する基線長さの比として見なされ、そうでない場合、ポイント単位での基線の最小長さとして見なされます。</td>
</tr>
<tr>
<td>領域オプション(0=すべて, &gt;0 開始から, &lt;0 最後から)</td>
<td>dir</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">0</p>
</td>
<td>このオプションを使って基線の位置を決めることができます。値が0の場合、基線を曲線のどの位置にでも表示することができます。値が正の場合、基線は曲線の開始位置になります。値が負の場合、基線は曲線の終了位置になります。値がゼロでない場合、この絶対値は、基線を探す最初のポイント(または区間の線形フィットが開始する最初の点)および曲線の開始ポイント(値が正の場合)または終了ポイント(値が負の場合)の間の位置として使用されます。</td>
</tr>
<tr>
<td>勾配のしきい値</td>
<td>h</td>
<td>
<p>入力</p>
<p>double</p>
</td>
<td>
<p style="text-align: center;">0</p>
</td>
<td>勾配のしきい値を指定します。勾配の基線はこの値より小さくする必要があります。</td>
</tr>
<tr>
<td>初期ポイント(0.01=1%, 5 = 5ポイント)</td>
<td>pts</td>
<td>
<p>入力</p>
<p>double</p>
</td>
<td>
<p style="text-align: center;">4</p>
</td>
<td><b style="font-weight: bold;">dir</b> が0の場合に基線を探す時、線形フィットを実行する最初の区間のポイント数を指定します。 <b>dir</b> = 0の場合、これはすべての線形フィットに対するサイズになります。</td>
</tr>
<tr>
<td>線形の許容値のチェック</td>
<td>tol</td>
<td>
<p>入力</p>
<p>double</p>
</td>
<td>
<p style="text-align: center;">10</p>
</td>
<td>連続した線形のテストに対する勾配/切片のエラー値に掛け算する許容値を指定します。</td>
</tr>
<tr>
<td>検索ポイントの最大数(0.5 = 半分, 50 = 50ポイント)</td>
<td>max</td>
<td>
<p>入力</p>
<p>double</p>
</td>
<td>
<p style="text-align: center;">0.5</p>
</td>
<td>基線を検索するのに使用する最大ポイント数を指定します。値が1より小さい場合、その値は曲線全体のサイズに対する最大ポイント数のパーセントと見なされます。そうでない場合、この値は基線を検索するのに使用する最大ポイント数と見なされます。</td>
</tr>
<tr>
<td>検索する増分のポイント数</td>
<td>step</td>
<td>
<p>入力</p>
<p>double</p>
</td>
<td>
<p style="text-align: center;">0</p>
</td>
<td><b style="font-weight: bold;">dir</b> = 0の場合、この変数は何も影響しません。そうでない場合、これは、線形の区間の終了する場所を探すために、線形フィットが実行される2つの隣り合う区間の距離を使用するのに使用されます。</td>
</tr>
<tr>
<td>基線領域の開始インデックス</td>
<td>i1</td>
<td>
<p>出力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">&lt;&gt;</p>
</td>
<td>基線の開始インデックスの出力を指定します。</td>
</tr>
<tr>
<td>基線領域の終了インデックス</td>
<td>i2</td>
<td>
<p>出力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">&lt;&gt;</p>
</td>
<td>基線の終了インデックスの出力を指定します。</td>
</tr>
<tr>
<td>切片</td>
<td>a</td>
<td>
<p>出力</p>
<p>double</p>
</td>
<td>
<p style="text-align: center;">&lt;&gt;</p>
</td>
<td>基線の切片の出力を指定します。</td>
</tr>
<tr>
<td>勾配</td>
<td>b</td>
<td>
<p>出力</p>
<p>double</p>
</td>
<td>
<p style="text-align: center;">&lt;&gt;</p>
</td>
<td>基線の勾配の出力を指定します。</td>
</tr>
<tr>
<td>切片の誤差</td>
<td>aerr</td>
<td>
<p>出力</p>
<p>double</p>
</td>
<td>
<p style="text-align: center;">&lt;&gt;</p>
</td>
<td>基線の切片の誤差の出力を指定します。</td>
</tr>
<tr>
<td>勾配の誤差</td>
<td>berr</td>
<td>
<p>出力</p>
<p>double</p>
</td>
<td>
<p style="text-align: center;">&lt;&gt;</p>
</td>
<td>基線の勾配の誤差の出力を指定します。</td>
</tr>
<tr>
<td>Pearson r (相関係数)</td>
<td>r</td>
<td>
<p>出力</p>
<p>double</p>
</td>
<td>
<p style="text-align: center;">&lt;&gt;</p>
</td>
<td>基線を検索するのに使用される線形フィットの補正残差二乗和の出力を指定します。</td>
</tr>
<tr>
<td>フィット曲線</td>
<td>oy</td>
<td>
<p>出力</p>
<p>XYRange</p>
</td>
<td>
<p style="text-align: center;">&lt;optional&gt;</p>
</td>
<td>フィットした基線データの出力範囲を指定します。</td>
</tr>
<tr>
<td>1=内部メッセージを表示</td>
<td>cntrl</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">0</p>
</td>
<td>内部メッセージを表示するかどうかを指定します。</td>
</tr>
</table>
<a name="Description" id="Description"></a>
<h2><span class="mw-headline">説明</span></h2>
<p>この関数はピークを持つ基線領域を探すのに使用されます。データ区間に線形フィットを実行し、線形領域が変化し始めたかどうかを決めるために誤差を見積もり、勾配の変化を比較します。</p>
<a name="Example" id="Example"></a>
<h2><span class="mw-headline">サンプル</span></h2>
<p>以下は、基線を探すこのXファンクションの使用方法を示すものです。</p>
<ol>
<li class="kadov-p">「標準」ツールバーの「<b>新規ワークブック</b>」ボタン<a href=""><img alt="Image:Button_New_Workbook.png" src="../images/FindBase/Button_New_Workbook.png" title="Image:Button_New_Workbook.png" width="23" height="23" border="0" /></a>をクリックして新しいワークブックを作成します。</li>
<li class="kadov-p">&lt;Origin Program Folder&gt;\Samples\Curve Fitting\Gaussian.datファイルをインポートします。</li>
<li class="kadov-p">「<b>新しい列の追加</b>」ボタン<a href=""><img alt="Image:Button_Add_New_Columns.png" src="../images/FindBase/Button_Add_New_Columns.png" title="Image:Button_Add_New_Columns.png" width="23" height="23" border="0" /></a> を2回クリックして2列追加します。</li>
<li class="kadov-p">列Dを選択します。メニューから「<b>列：X列として設定</b>」を選択します。</li>
<li class="kadov-p">列Aと列Bを選択し、「<b>作図：線＋シンボル図：線＋シンボル</b>」を選択し、グラフを作成します。</li>
<li class="kadov-p"><b style="font-weight: bold;">コマンドウィンドウ</b>に <b>findBase -d</b> と入力し、<b>Fitting: findBase</b> ダイアログボックスを開きます。</li>
<li class="kadov-p">「<b>最小の連続する均一なポイント</b>」ボックスに<b>0.1</b>を入力し、「<b>初期ポイント</b>」に<b>4</b>を入力します。</li>
<li class="kadov-p"><b style="font-weight: bold;">フィット曲線</b>の右にあるボタンをクリックします。ソースデータがあるワークブックに移動します。列Dと列Eを選択します。ダイアログボックスに戻ります。</li>
<li class="kadov-p"><b style="font-weight: bold;">OK</b> ボタンをクリックします。</li>
</ol>
<p><b style="font-weight: bold;">コマンドウィンドウ</b>に結果を表示して、グラフにフィット曲線が追加されます。</p>
<a name="Algorithm" id="Algorithm"></a>
<h2><span class="mw-headline">アルゴリズム</span></h2>
<p><b style="font-weight: bold;">dir &gt; 0のとき</b></p>
<p>これは、連続な線形区間である基線が入力曲線の開始位置に現れるということです。</p>
<p>Xファンクションは区間毎に線形フィットを実行し、連続した線形区間を探します。線形フィットはデータの区間を実行します。そして、勾配の変化は、線形の領域が終了したかどうかを判定するのに使用します。</p>
<p>次のように設定しましょう。</p>
<p>n = npts + step;</p>
<p>piece_size = 3 * step;</p>
<p>m = n + piece_size;</p>
<p>ここで <b>dir</b>, <b>pts</b> , <b>step</b> は、Xファンクションの変数です。</p>
<p>最初に、Xファンクションは、最初の<b>pts</b> ポイントに対して線形フィットを実行します。勾配の値は、 <b>v0</b>にセットされます。そして、n番目から m番目のデータポイントに対して、線形フィットが実行されます。 勾配の値は、 <b>vn</b> にセットされ、勾配の誤差は <b>vErr</b>にセットされます。そして、Xファンクションは次の式が成り立つかをチェックします。</p>
<p><a href=""><img alt="Image:math-2fc3594637ccb4241ca20fc8fe122c82.png" src="../images/FindBase/math-2fc3594637ccb4241ca20fc8fe122c82.png" width="190" height="18" border="0" /></a>ここで dR は、<b>tol</b> 変数で指定される許容値です。</p>
<p>これが成立する場合、線形の領域は終わりです。最初の<b>npts</b> ポイントを含むセクションのみが線形の部分です。そして、この部分は基線と見なされます。</p>
<p>これが成立しない場合、線形の領域が2番目の区間にも続くということになります。Xファンクションは、その線形部分の最後の位置を探すために、続けて実行されます。 <b>v0</b> は、 <b>vn</b>とセットされます。線形フィットが、現在の区間の右側の<b>step</b> ポイントの次の区間で実行されます。新しい <b>vn</b> がこの線形フィットの勾配値にセットされます。また、<b>vErr</b> は新しい勾配エラーにセットされます。また、Xファンクションは、線形部分が次の式で終了するかどうかをチェックします。</p>
<p><a href=""><img alt="Image:math-2fc3594637ccb4241ca20fc8fe122c82.png" src="../images/FindBase/math-2fc3594637ccb4241ca20fc8fe122c82.png" width="190" height="18" border="0" /></a></p>
<p>これは、線形部分が終わるか、または区間線形フィットに実行される最大ポイントに達するまで繰り返されます。入力曲線の開始位置から始まる連続した線形領域は基線の候補と見なされます。最後に、この候補の基線が十分良いものかどうかを見るためにチェックされます。下記の「<b>基線の候補のチェック</b>」をご覧下さい。</p>
<p><b style="font-weight: bold;">dir &lt; 0のとき</b></p>
<p>これは、連続な線形区間である基線が入力曲線の開始位置に現れるということです。この連続した線形区間を探すという基本的な考えは、実際には、区間線形フィットが入力曲線の最右端から開始するという点を除けば、「dir &gt; 0」の場合のものと同じです。</p>
<p><b style="font-weight: bold;">dir = 0のとき</b></p>
<p>これは、基線が入力曲線のどの位置にでも現れます。</p>
<p>Xファンクションは、「dir&gt;0」の場合に使われる方法で、左から右に向かって連続した線形区間を探します。基線の最小長さよりも大きい長さを持つ連続した線形区間 <b>flat</b>変数で決められた場合、検索は中止され、この線形区間は基線の候補と見なされます。そして、この候補の基線が十分良いものかどうかを見るためにチェックされます。下記の「<b>基線の候補のチェック</b>」をご覧下さい。</p>
<p><b style="font-weight: bold;">基線の候補のチェック</b></p>
<p>候補の基線が十分良いものかどうかを見るためにチェックされます。そこにあるすべての線形部分が見つけられます。そして、Xファンクションの<b>h</b>変数によって指定される勾配のしきい値より小さい勾配を持つ部分が最終的な基線として使われます。</p>
<a name="References" id="References"></a>
<h2><span class="mw-headline">参考文献</span></h2>
<a name="Related_X-Functions" id="Related_X-Functions"></a>
<h2><span class="mw-headline">関連のXファンクション</span></h2>
