<h1 class="firstheading">CSVインポートのツリーノードに関する詳細</h1>
<p><br /></p>
<div id="toc" class="toc">
<div id="toctitle">
<h2>内容</h2>
</div>
<ol>
<li class="toclevel-1 tocsection-1"><a href="#options"><span class="tocnumber">1</span> <span class="toctext">オプション</span></a>
<ol>
<li class="toclevel-2 tocsection-2"><a href="#Names"><span class="tocnumber">1.1</span> <span class="toctext">ワークシート/ブックの名前を付ける/変更する(Names)</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#headerLines"><span class="tocnumber">1.2</span> <span class="toctext">ヘッダ行</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#partial"><span class="tocnumber">1.3</span> <span class="toctext">部分インポート</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Script"><span class="tocnumber">1.4</span> <span class="toctext">スクリプト</span></a></li>
</ol>
</li>
</ol>
</div>
<h2><a name="options" id="options"></a><span class="mw-headline">オプション</span></h2>
<p><b style="font-weight: bold;">オプション</b>ツリーは、 <b>impCSV</b> Xファンクションのインポートオプションを全て指定します。</p>
<p>シンタックス：<b>Options.<i>Treenode</i>:=&lt;value&gt;</b></p>
<p>例：<b>Options.decimal:=1</b></p>
<table class="treetable">
<tr>
<th>ツリーノード</th>
<th>ラベル</th>
<th>スケール・タイプ</th>
<th>デフォルト</th>
<th>説明</th>
</tr>
<tr>
<td>decimal</td>
<td>Delimiter</td>
<td>int</td>
<td>0</td>
<td>区切り文字を指定します。以下のオプションがあります。
<ul>
<li>0:コンマ
<dl>
<dd>データ列はコンマによって区切られています。</dd>
</dl>
</li>
<li>1:セミコロン
<dl>
<dd>データ列はセミコロンによって区切られています。</dd>
</dl>
</li>
<li>2:自動
<dl>
<dd>データ列は自動区切り文字によって区切られています。</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr>
<td>FirstMode</td>
<td>第１ファイルインポートモード</td>
<td>int</td>
<td>0</td>
<td>1番目のファイルのインポートモードを指定します。以下のオプションがあります。
<ul>
<li>0:既存データを置き換える
<dl>
<dd>目的のウィンドウに存在するデータは消去します。新しいデータがその中にインポートされます。</dd>
</dl>
</li>
<li>3:ブックを新たに作って読み込む
<dl>
<dd>インポートする各ファイルに対して新しいブックを作成します。</dd>
</dl>
</li>
<li>4:シートを新たに作って読み込む
<dl>
<dd>インポートするファイルに対して新しいシートを作成します。</dd>
</dl>
</li>
<li>1:列を追加して読み込む
<dl>
<dd>目的のウィンドウに新しい列を追加し、新しい列にデータをインポートします。</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr>
<td>Mode</td>
<td>複数ファイルのインポートモード(第1ファイル以外)</td>
<td>int</td>
<td>4</td>
<td>1番目以外のファイルに対してリストからインポートモードを指定します。以下のオプションがあります。
<ul>
<li>3:ブックを新たに作って読み込む
<dl>
<dd>インポートする各ファイルに対して新しいブックを作成します。</dd>
</dl>
</li>
<li>4:シートを新たに作って読み込む
<dl>
<dd>インポートするファイルに対して新しいシートを作成します。</dd>
</dl>
</li>
<li>1:列を追加して読み込む
<dl>
<dd>目的のウィンドウに新しい列を追加し、新しい列にデータをインポートします。</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr>
<td>WinTemplate</td>
<td>テンプレート名</td>
<td>String</td>
<td>&lt;default&gt;</td>
<td>このオプションは<b>インポートモード</b>が<b>シートを新たに作って読み込む</b>か<b>ブックを新たに作って読み込む</b>に設定されている時に利用できます。新しいワークブックかワークシートにインポートする時のテンプレートを指定します。特別なテンプレート<i><b>&lt;クローン&gt;</b></i> は現在のワークブックまたは行列ブックをインポートファイルのテンプレートとして使用します。</td>
</tr>
<tr>
<td>nAutoSize</td>
<td>Auto Resize Cells</td>
<td>int</td>
<td>1</td>
<td>ワークシートのセルのサイズを自動で変更します。
<p>以下のオプションがあります。</p>
<ul>
<li>0:No
<dl>
<dd>セルサイズを変更しない</dd>
</dl>
</li>
<li>1:太さ
<dl>
<dd>セルの幅のみ自動変更する</dd>
</dl>
</li>
<li>2:高さ
<dl>
<dd>セルの高さのみ自動変更する</dd>
</dl>
</li>
<li>3:幅と高さ
<dl>
<dd>セルの幅と高さを自動で変更する</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr>
<td>DateFormat</td>
<td>カスタム日付フォーマット</td>
<td>double</td>
<td>&#160;</td>
<td>ドロップダウンリストから日付フォーマットを選択、またはカスタム日付フォーマット文字列に入力します。詳細は、 <b>カスタム日時フォーマット</b>ページをご覧下さい。
<p>以下のオプションがあります。</p>
<ul>
<li>&lt;なし&gt;</li>
<li>yyyy'-'MM'-'dd HH':'mm':'ss</li>
<li>yyyy'-'MM'-'dd HH':'mm':'ss'.'###</li>
<li>yyyy'-'MM'-'dd hh':'mm':'ss tt</li>
<li>dd'/'MM'/'yyyy</li>
<li>dd'-'MM'-'yy</li>
<li>MM'/'dd'/'yyyy</li>
<li>MM'-'dd'-'yy</li>
<li>yy'/'MM'/'dd</li>
<li>yy'.'MM'.'dd</li>
<li>dd'.'MM'.'yy</li>
<li>yyyyMMdd</li>
<li>dd'-'MMM'-'yy</li>
</ul>
</td>
</tr>
<tr>
<td>KeepDestColFmt</td>
<td>ターゲット列フォーマットを保存する</td>
<td>int</td>
<td>0</td>
<td>目的の列のフォーマットを維持するかどうかを指定します。</td>
</tr>
</table>
<h3><a name="Names" id="Names"></a><span class="mw-headline">名前を付ける</span></h3>
<p><b style="font-weight: bold;">オプション</b>ツリーの<b>ワークシート/ブックの名前を付ける/変更する</b>ブランチはワークシートとワークブックの名づけについて指定します。</p>
<p>シンタックス：<b>Options.Names.<i>Treenode:= &lt;value&gt;</i></b></p>
<p>例：</p>
<dl>
<dd><b style="font-weight: bold;">Options.Names.FNameToSht:=1</b></dd>
<dd><b style="font-weight: bold;">Options.Names.FNameToShtFrom:=1</b></dd>
<dd><b style="font-weight: bold;">Options.Names.FNameToShtTo:=4</b></dd>
</dl>
<table class="treetable">
<tr>
<th>ツリーノード</th>
<th>ラベル</th>
<th>スケール・タイプ</th>
<th>デフォルト</th>
<th>説明</th>
</tr>
<tr>
<td>AutoNames</td>
<td>ファイル名による自動名前変更</td>
<td>int</td>
<td>0</td>
<td>チェックが付いていると、Originはデフォルト設定を使って、ワークシートとワークブックの名前を変更します。
<ul>
<li>ファイル名全体(拡張子を含まない)をワークシート名として使用します。</li>
<li>ワークブックが空の場合またはインポートモードが<b>既存データの置き換え</b>の場合、ファイル名全体(拡張子を含む)をワークブック名として使用します。</li>
</ul>
</td>
</tr>
<tr>
<td>FNameToSht</td>
<td>シート名を(部分)ファイル名に変更する</td>
<td>int</td>
<td>1</td>
<td>これにチェックが付いていると、ワークシート名にファイル名の一部を使います。</td>
</tr>
<tr>
<td>FNameToShtFrom</td>
<td>短縮開始位置</td>
<td>int</td>
<td>1</td>
<td>ブック名の開始位置</td>
</tr>
<tr>
<td>FNameToShtTo</td>
<td>短縮終了位置</td>
<td>int</td>
<td>0</td>
<td>ブック名の終了位置</td>
</tr>
<tr>
<td>FNameToBk</td>
<td>ブック名を(部分)ファイル名に変更する</td>
<td>int</td>
<td>1</td>
<td>これにチェックが付いていると、ワークブック名にファイル名の一部を使います。</td>
</tr>
<tr>
<td>FNameToBkFrom</td>
<td>短縮開始位置</td>
<td>int</td>
<td>1</td>
<td>ブック名の開始位置</td>
</tr>
<tr>
<td>FNameToBkTo</td>
<td>短縮終了位置</td>
<td>int</td>
<td>0</td>
<td>ブック名の終了位置</td>
</tr>
<tr>
<td>FNameToBkLnOnly</td>
<td>ブックのロングネームのみを変更する</td>
<td>int</td>
<td>0</td>
<td>これにチェックを付けると、ワークブックのロングネームのみ名前を変更します。</td>
</tr>
<tr>
<td>FPathToBk</td>
<td>ブック名の変更時にファイルパスを含める</td>
<td>int</td>
<td>0</td>
<td>ファイルパスをワークブック名に含めるかどうかを指定します。</td>
</tr>
<tr>
<td>FNameToBkComm</td>
<td>ワークブックコメントにファイル名を追加</td>
<td>int</td>
<td>1</td>
<td>ワークブックコメントにファイル名を追加するかどうか指定します。</td>
</tr>
<tr>
<td>FNameToColComm</td>
<td>列コメントにファイル名を追加</td>
<td>int</td>
<td>0</td>
<td>ワークブックコメントにファイル名を追加するかどうか指定します。</td>
</tr>
<tr>
<td>FPathToComm</td>
<td>ファイル名を追加するときにファイルパスを含める</td>
<td>int</td>
<td>1</td>
<td>これにチェックが付いていると、ワークブックのコメントとコメント行にインポートファイルパスが追加されます。</td>
</tr>
</table>
<table class="note">
<tr>
<td><b style="font-weight: bold;">Note:</b>
<p>Origin8.6以降、マイナス値(－)が<b>FNameToBkFrom</b> と<b>FNameToBkTo</b> に追加されました。これは、ファイル名の最後の文字からカウントするためです。ワークブックの名前を変更する場合、ファイルの拡張子をトリミングする際にも使用できます。例えば、<i>sample.csv</i>という名前のcsvデータファイルをインポートする場合、以下のように拡張子「<i>.csv</i>」をトリミングする設定に指定する事ができます。</p>
<dl>
<dd>Options.Names.FNameToBkFrom:=1</dd>
<dd>Options.Names.FNameToBkTo:=-4</dd>
</dl>
</td>
</tr>
</table>
<h3><a name="headerLines" id="headerLines"></a><span class="mw-headline">ヘッダ行</span></h3>
<p><b style="font-weight: bold;">オプション</b>ツリー内の<b>ヘッダ行</b>ブランチはインポートするファイルのヘッダ情報を指定します。</p>
<p>シンタックス：<b>Options.headerLines.<i>Treenode:= &lt;value&gt;</i></b></p>
<p>例:<b>Options.headerLines.SNames:= 1</b></p>
<table class="treetable">
<tr>
<th>ツリーノード</th>
<th>ラベル</th>
<th>スケール・タイプ</th>
<th>デフォルト</th>
<th>説明</th>
</tr>
<tr>
<td>MainHdrLns</td>
<td>メインヘッダの行数(サブヘッダを除く)</td>
<td>int</td>
<td>0</td>
<td>特に測定器から出力されたいくつかのファイルは、ファイルの先頭にヘッダ情報を含んでおり、これは機器を識別したり、作業者、日付、データ数などの情報で、これらはメインヘッダ行となります。これはメインのヘッダ行がどこにあるか示すのに使用します。</td>
</tr>
<tr>
<td>サブヘッダ行</td>
<td>サブヘッダの行数</td>
<td>int</td>
<td>0</td>
<td>これはファイル内にあるサブヘッダ数を指定するのに使用します。</td>
</tr>
<tr>
<td>ショートネーム</td>
<td>ショートネーム</td>
<td>int</td>
<td>0</td>
<td>ファイルヘッダのどの行をワークシートのショートネームとして使用するかを指定します。この数字はサブヘッダ行の最初から始まり、ヘッダ行の開始値ではありません。同じ事が下の設定でもいえます。</td>
</tr>
<tr>
<td>ロングネーム</td>
<td>ロングネーム</td>
<td>int</td>
<td>0</td>
<td>ロングネームの行を指定します。</td>
</tr>
<tr>
<td>Units</td>
<td>単位</td>
<td>int</td>
<td>0</td>
<td>単位の行を指定します。</td>
</tr>
<tr>
<td>コメント(開始行)</td>
<td>コメント(開始行)</td>
<td>int</td>
<td>0</td>
<td>コメントが開始する行を指定します。</td>
</tr>
<tr>
<td>コメント(最終行)</td>
<td>コメント(最終行)</td>
<td>int</td>
<td>0</td>
<td>コメントが終了する行を指定します。</td>
</tr>
<tr>
<td>ParamsFrom</td>
<td>システムパラメータ(開始行)</td>
<td>int</td>
<td>0</td>
<td>システムパラメータの開始行を指定します。</td>
</tr>
<tr>
<td>ParamsTo</td>
<td>システムパラメータ(最終行)</td>
<td>int</td>
<td>0</td>
<td>システムパラメータの終了行を指定します。</td>
</tr>
<tr>
<td>ユーザパラメータ(開始行)</td>
<td>ユーザパラメータ(開始行)</td>
<td>int</td>
<td>0</td>
<td>ユーザパラメータの開始行を指定します。</td>
</tr>
<tr>
<td>ユーザパラメータ(最終行)</td>
<td>ユーザパラメータ(最終行)</td>
<td>int</td>
<td>0</td>
<td>ユーザパラメータの終了行を指定します。</td>
</tr>
</table>
<h3><a name="partial" id="partial"></a><span class="mw-headline">部分インポート</span></h3>
<p><b style="font-weight: bold;">オプション</b>ツリー内の<b>部分インポート</b>ブランチは、部分的にインポートする方法を指定します。</p>
<p>シンタックス：<b>Options.PartImp.<i>Treenode:= &lt;value&gt;</i></b></p>
<p>例:</p>
<dl>
<dd><b style="font-weight: bold;">Options.partial.Partial:=1</b></dd>
<dd><b style="font-weight: bold;">Options.partial.FirstCol:=1</b></dd>
<dd><b style="font-weight: bold;">Options.partial.FirstCol:=3</b></dd>
</dl>
<table class="treetable">
<tr>
<th>ツリーノード</th>
<th>ラベル</th>
<th>スケール・タイプ</th>
<th>デフォルト</th>
<th>説明</th>
</tr>
<tr>
<td>Partial</td>
<td>部分インポート</td>
<td>int</td>
<td>0</td>
<td>0は部分インポートせず、1または2は部分インポートを有効にします。1は全てのファイルに部分インポートの設定を適用し、2は最初のファイル以外の全てのファイルに部分インポートを適用します。</td>
</tr>
<tr>
<td>FirstCol</td>
<td>開始列</td>
<td>int</td>
<td>1</td>
<td><i style="font-style: italic;">Partial</i> が有効なとき(1または2)に利用できます。部分インポートの開始列を指定します。</td>
</tr>
<tr>
<td>LastCol</td>
<td>最終列</td>
<td>int</td>
<td>0</td>
<td><i style="font-style: italic;">Partial</i> が有効なとき(1または2)に利用できます。部分インポートの最終列を指定します。</td>
</tr>
<tr>
<td>SkipSamples</td>
<td>Skip Points</td>
<td>int</td>
<td>1</td>
<td>設定に応じていくつかのポイントをとばすことができます。<i>Partial</i> が有効なとき(1または2)に利用できます。</td>
</tr>
<tr>
<td>FirstSample</td>
<td>開始ポイント</td>
<td>int</td>
<td>1</td>
<td>インポートするファイルの開始点を指定できます。<i>Partial</i> が有効なとき(1または2)に利用できます。</td>
</tr>
<tr>
<td>ReadSamples</td>
<td>読み込みポイント</td>
<td>int</td>
<td>0</td>
<td>これは<b>ポイントスキップ</b>と一緒に動作します。Partialが有効(1または2)で、<b>ポイントスキップ</b>が0より大きいときに利用できます。
<p><b style="font-weight: bold;">読み込みポイント</b>に値lを指定し<b>スキップポイント</b>に値kを入力すると、 l+k列毎にl 列がインポートされ、k 列が読み飛ばされます。</p>
</td>
</tr>
<tr>
<td>LastSample</td>
<td>最終ポイント</td>
<td>int</td>
<td>0</td>
<td>インポートするファイルの最終点を指定できます。<i>Partial</i> が有効なとき(1または2)に利用できます。</td>
</tr>
</table>
<h3><a name="Script" id="Script"></a><span class="mw-headline">スクリプト</span></h3>
<p><b style="font-weight: bold;">オプション</b>ツリーの<b>スクリプト</b>は、ファイルがインポートされた後に実行するLabTalkスクリプトを指定します。</p>
<p>シンタックス：<b>Options.Script.Treenode:= &lt;<i>string</i>&gt;</b></p>
<p>例:<br />
//各ファイルをインポートした後に2列目をプロット:<br />
<b>Options.Script.RunScriptAfterEachImport:="plotxy 2;";</b><br /></p>
<p>//全てのファイルがインポートされたときに、ワークブック内の全てのシートをループして、列1から4の最初の500行を削除する<br />
<b>Options.Script.RunScriptAfterAllImport:=" doc -ef W { doc -e LW { range aa =1[1]:4[500]; del aa;}}";<br /></b></p>
<p><br /></p>
<table class="treetable">
<tr>
<th>ツリーノード</th>
<th>ラベル</th>
<th>データ型</th>
<th>デフォルト</th>
<th>説明</th>
</tr>
<tr>
<td>RunScriptAfterEachImport</td>
<td>それぞれの各ファイルインポート後のスクリプト</td>
<td>string</td>
<td>"?"</td>
<td>各ファイルインポート後に実行されるLabTalkスクリプトを指定します。</td>
</tr>
<tr>
<td>RunScriptAfterAllImport</td>
<td>全てのファイルインポート後のスクリプト</td>
<td>string</td>
<td>"?"</td>
<td>全ファイルがインポートされた後に実行されるLabTalkスクリプトを指定します。</td>
</tr>
</table>
