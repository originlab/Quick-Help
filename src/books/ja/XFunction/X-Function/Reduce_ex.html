<h1 class="firstheading">reduce_ex</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">メニュー情報</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span class="tocnumber">2</span><span class="toctext">概要</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Additional_Information"><span class="tocnumber">3</span> <span class="toctext">追加の情報</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Command_Line_Usage"><span class="tocnumber">4</span><span class="toctext">コマンドラインでの使用法</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#X-Function_Execution_Options"><span class="tocnumber">5</span> <span class="toctext">Xファンクションの実行オプション</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Variables"><span class="tocnumber">6</span> <span class="toctext">変数</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Description"><span class="tocnumber">7</span> <span class="toctext">説明</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Example"><span class="tocnumber">8</span> <span class="toctext">サンプル</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Algorithm"><span class="tocnumber">9</span> <span class="toctext">アルゴリズム</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#Related_X-Functions"><span class="tocnumber">10</span><span class="toctext">関連するXファンクション</span></a></li>
</ul>
</div>

<h2><a name="Menu_Information"></a><span class="mw-headline">メニュー情報</span></h2>
<ul><li>ワークブックがアクティブな場合</li></ul>
<dl><dd><b>ワークシート：データ削減：等間隔X</b></dd></dl>
<ul><li>グラフがアクティブな場合</li></ul>
<dl><dd><b>解析：データ操作：データ削減：等間隔X</b></dd></dl>
<h2><a name="Brief_Information"></a><span class="mw-headline">概要</span></h2>
<p>Xで再サンプリングを使用してXYデータを削減します
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">追加の情報</span></h2>
<p><b>必要なOriginのバージョン</b>: 8.1 SR0以降
</p><p><br />
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">コマンドラインでの使用法</span></h2>
<p><code>
reduce_ex subgroup:=inter bins:=5 method:=yfirstxfirst
</code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">Xファンクションの実行オプション</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">スクリプトからXファンクションにアクセスする場合、追加のオプションスイッチについてのページを参照してください。</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">変数</span></h2>
<table class="xfvar">
<tr>
<th width="8%">表示<br />名
</th>
<th width="8%">変数<br />名
</th>
<th width="8%">I/O<br />と<br />データ型
</th>
<th width="8%">デフォルト<br />値
</th>
<th>説明
</th></tr>
<tr>
<td>入力
</td>
<td>iy
</td>
<td>
<p>入力
</p><p>XYRange
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> 入力データ範囲を指定します。
</td></tr>
<tr>
<td>サブグループ
</td>
<td>subgroup
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> 元データをサブグループに分ける方法を指定します。分割後、データポイントの各グループは単一データポイントに統合されます。
<p>オプションリスト：
</p>
<ul><li><i>ratio: N点毎</i>
<dl><dd>入力範囲のN個のデータポイントごとに一つのデータポイントに統合します。<b>rfactor</b> 変数でN数を指定できます。</dd></dl></li>
<li><i>inter:サンプリング間隔による </i>
<dl><dd>サンプリング間隔に従って、データポイントを統合します。<b>dx</b> 変数でサンプリング間隔を指定することができます。</dd></dl></li>
<li><i>bins:インターバル数による</i>
<dl><dd>インターバル数に従って、データポイントを統合します。<b>bins</b> 変数でインターバル数を指定することができます。</dd></dl></li>
<li><i>Freq: 周波数による</i>
<dl><dd>周波数に従って、データポイントを統合します。<b>rfre</b> 変数で度数を指定できます。</dd></dl></li></ul>
</td></tr>
<tr>
<td>サンプリング間隔
</td>
<td>dx
</td>
<td>
<p>入力
</p><p>double
</p>
</td>
<td> <center>0.25</center>
</td>
<td> これは、<b>サブグループ</b>で<b>サンプリング間隔による</b>が選択されているときのみ利用できます。サンプリング間隔の値を指定します。
</td></tr>
<tr>
<td>間隔の数
</td>
<td>bins
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>10</center>
</td>
<td> これは、<b>サブグループ</b>で<b>インターバル数による</b>が選択されているときのみ利用できます。間隔（インターバル）の数を指定します。
</td></tr>
<tr>
<td>再サンプリングファクター
</td>
<td>rfactor
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>4</center>
</td>
<td> これは、<b>サブグループ</b>で<b>N点毎</b>が選択されているときのみ利用できます。Nの値を指定します。
</td></tr>
<tr>
<td>再サンプリング周波数
</td>
<td>rfre
</td>
<td>
<p>入力
</p><p>double
</p>
</td>
<td> <center>8</center>
</td>
<td> これは、<b>サブグループ</b>で<b>周波数による</b>が選択されているときのみ利用できます。再サンプリング周波数を指定します。
</td></tr>
<tr>
<td>開始X
</td>
<td>start
</td>
<td>
<p>入力
</p><p>double
</p>
</td>
<td> <center>&lt;自動&gt;</center>
</td>
<td> これは、<b>サブグループ</b>で<b>サンプリング間隔による</b>、<b>インターバル数による</b>、<b>周波数による</b>が選択されているときのみ利用できます。グループ化を開始するX値を指定します。
</td></tr>
<tr>
<td>終了X
</td>
<td>end
</td>
<td>
<p>入力
</p><p>double
</p>
</td>
<td> <center>&lt;自動&gt;</center>
</td>
<td> これは、<b>サブグループ</b>で<b>サンプリング間隔による</b>、<b>インターバル数による</b>、<b>周波数による</b>が選択されているときのみ利用できます。グループ化を終了するX値を指定します。
</td></tr>
<tr>
<td>サンプリング手法
</td>
<td>method
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> 各グループで統合されたデータポイントのY値の取得方法を指定します。
<p>オプションリスト：
</p>
<ul><li><i>yfirstxfirst: 最初のポイント </i>
<dl><dd>各グループ内の最初のデータポイントのY値を取得します。</dd></dl></li>
<li><i>ymeanxbinc:Y平均</i>
<dl><dd>各グループ内のデータポイントのY値の平均値を取得します。 </dd></dl></li>
<li><i>yranxbinc: ランダムY(X平均)</i>
<dl><dd>ランダムな数を取得します。</dd></dl></li></ul>
</td></tr>
<tr>
<td>等サンプリング間隔許容値(%)
</td>
<td>variation
</td>
<td>
<p>入力
</p><p>double
</p>
</td>
<td> <center>5</center>
</td>
<td> <b>サブグループ</b>で<b>N点毎</b>が選択されているとき利用できます。これを使って、入力X値が等間隔かどうかをチェックするのに使用する許容値を指定します。詳細については、以下の<a href="../../XFunction/X-Function/Reduce_ex.html#Algorithm" title="Xファンクション:Reduce ex">アルゴリズム</a>セクションを参照してください。
</td></tr>
<tr>
<td>FFTプレビューの表示
</td>
<td>plot
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> プレビューパネルに元のデータとともに削減したデータのFFTの結果をプロットするかどうかを指定します。
</td></tr>
<tr>
<td>出力
</td>
<td>oy
</td>
<td>
<p>出力
</p><p>XYRange
</p>
</td>
<td> <center>(&lt;autoX&gt;,&lt;new&gt;)</center>
</td>
<td> 出力範囲を指定します。<a class="external text" href="../../XFunction/X-Function/Output_Notations.html">出力表記</a>のシンタックスを参照してください。
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">説明</span></h2>
<p>このXファンクションは、XYデータを削減して等間隔X値でサイズの小さいデータにします。
</p>
<h2><a name="Example"></a><span class="mw-headline">サンプル</span></h2>
<p><i><b>EX1</b></i>
</p><p>X値が等間隔でないデータセットがあります。データセットには1000ポイントのデータが含まれています。 
</p>
<dl><dd><a  class="image"><img alt="Reduce ex1.png" src="../images/Reduce_ex/Reduce_ex1.png" width="394"  /></a></dd></dl>
<p>次のステップを実行してデータポイントを100個にします。出力データは等間隔になります。
</p>
<ol><li>データは、既にワークブックに存在するものとします。データ列を選択し、<b>作図：基本の2Dグラフ：散布図</b>を選択してグラフを作図します。
<dl><dd><a  class="image"><img alt="Reduce ex2.png" src="../images/Reduce_ex/Reduce_ex2.png" width="421"  /></a></dd></dl></li>
<li>グラフをアクティブにします。メニューから、<b>解析：データ操作：データ削減：等間隔X</b>を選択し、reduce_ex Xファンクションダイアログを開きます。 </li>
<li>ダイアログボックス下側にある<b>自動プレビュー</b>にチェックを付けます。</li>
<li><b>サブグループ</b>ドロップダウンリストで<b>インターバル数ごと</b>を選択します。そして、<b>間隔の数</b>の隣にある<b>自動</b>のチェックを外し、<b>100</b> と入力します。</li>
<li><b>サンプリング手法</b>ドロップダウンリストで<b>最初のポイント</b> を選択します。</li>
<li><b>FFTプレビューの表示</b>にチェックを付けます。元データと削減データの両方のFFT結果を確認できます。</li>
<li>出力として<b>(&lt;新規&gt;, &lt;新規&gt;)</b> を設定します。
<dl><dd><a  class="image"><img alt="Reduce ex3.png" src="../images/Reduce_ex/Reduce_ex3.png" width="752"  /></a></dd></dl></li>
<li><b>OK</b>ボタンをクリックすると、グラフに結果が表示されます。削減したデータは入力ワークシートの元のデータの隣にあります。そして、X値が等間隔になっているのが分かります。
<dl><dd><a  class="image"><img alt="Reduce ex4.png" src="../images/Reduce_ex/Reduce_ex4.png" width="394"  /></a></dd></dl></li>
<li> このワークブックのX2 および Y2を選択し、Originメニューから<b>作図：基本の2Dグラフ：散布図</b>を選択して、グラフを作成します。データの形状が元のデータと同様であることが分かります。
<dl><dd><a  class="image"><img alt="Reduce ex5.png" src="../images/Reduce_ex/Reduce_ex5.png" width="421"  /></a></dd></dl></li></ol>
<p>また、次のスクリプトコマンドを使ってデータポイントを削減することもできます。(スクリプトを実行する前に入力データが選択されているものとします。) 
</p>
<pre class="lt" style="font-family:monospace;">reduce_ex subgroup<span style="color: #000000;">:</span><span style="color: #000080;">=</span>bins bins<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">100</span> method<span style="color: #000000;">:</span><span style="color: #000080;">=</span>yfirstxfirst oy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">(</span><span style="color: #000080;">&lt;</span>new<span style="color: #000080;">&gt;</span>,<span style="color: #000080;">&lt;</span>new<span style="color: #000080;">&gt;</span><span style="color: #000000;">)</span>;</pre>
<p><i><b>EX2</b></i>
</p><p>以下のLabTalkスクリプトを実行して、サンプルデータ<i>fitConv.dat</i> をインポートし、周波数で削減します。
</p>
<pre class="lt" style="font-family:monospace;">newbook&nbsp;;
fname<span style="color: #000080;">$</span><span style="color: #000080;">=</span>  system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span><span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Curve Fitting\fitConv.dat&quot;</span>&nbsp;;
impASC;
worksheet <span style="color: #000080;">-</span>s <span style="color: #0000dd;">2</span>;
reduce_ex <span style="color: #000080;">-</span>r <span style="color: #0000dd;">2</span> subgroup<span style="color: #000000;">:</span><span style="color: #000080;">=</span>freq;</pre>
<h2><a name="Algorithm"></a><span class="mw-headline">アルゴリズム</span></h2>
<ul><li> <b>等サンプリング間隔許容値の定義</b></li></ul>
<p>入力X値に等間隔のチェックがついているとき、等しいサンプリング間隔に対する許容値 (0から1) を指定する必要があります。以下のように定義します。
</p>
<ol><li> 昇順にソートされたX値を<img src="../images/Reduce_ex/math-324a4134393132d8cf5ce9cf50a56026.png" title="\left (x_1, x_2, x_3, ..., x_n \right )" alt="\left (x_1, x_2, x_3, ..., x_n \right )" class="tex"/>とします。 ここで <img src="../images/Reduce_ex/math-7b8b965ad4bca0e41ab51de7b31363a1.png" title="n" alt="n" class="tex"/> はベクトルのサイズです。そして、指定した許容値は <img src="../images/Reduce_ex/math-d9734757e2e9d7363d18a5d238f419b4.png" title="tol" alt="tol" class="tex"/> です。</li>
<li> それぞれ隣り合う値の増分の平均を <img src="../images/Reduce_ex/math-ffe7fa9316fe6c5be16cdc20066ea8d3.png" title="M_I = \frac {\sum_{k=2}^n \left ( x_k - x_{k-1} \right )}{n - 1}" alt="M_I = \frac {\sum_{k=2}^n \left ( x_k - x_{k-1} \right )}{n - 1}" class="tex"/> で計算します。ここで <img src="../images/Reduce_ex/math-f7a282bc81977a2a56781648ca1bfb35.png" title="k = 2, 3, ..., n \," alt="k = 2, 3, ..., n \," class="tex"/> です。</li>
<li> <img src="../images/Reduce_ex/math-d785af7e2ea08dd224ca61179851f283.png" title="M_I * \left ( 1 - tol \right )" alt="M_I * \left ( 1 - tol \right )" class="tex"/> および<img src="../images/Reduce_ex/math-06d0e72ef19a110aee239e58ed8b66f7.png" title="M_I * \left ( 1 + tol \right )" alt="M_I * \left ( 1 + tol \right )" class="tex"/> で範囲を取得し、テストの範囲は、両方の境界を含む <img src="../images/Reduce_ex/math-b2214c3f900d5c281f7e854aabf331aa.png" title="[M_I * \left ( 1 - tol \right ) , M_I * \left ( 1 + tol \right ) ]" alt="[M_I * \left ( 1 - tol \right ) , M_I * \left ( 1 + tol \right ) ]" class="tex"/> です。</li>
<li> すべてがステップ3で計算した範囲にあるかどうかを見るため、それぞれ隣り合う値のすべての増加をテストします。つまり、すべての増分に対して、 <img src="../images/Reduce_ex/math-6ebf5179090ed2c1ffbbb0bda69085ad.png" title="M_I * \left ( 1 - tol \right ) \le x_k - x_{k-1} \le M_I * \left ( 1 + tol \right )" alt="M_I * \left ( 1 - tol \right ) \le x_k - x_{k-1} \le M_I * \left ( 1 + tol \right )" class="tex"/> を満たす場合( <img src="../images/Reduce_ex/math-f7a282bc81977a2a56781648ca1bfb35.png" title="k = 2, 3, ..., n \," alt="k = 2, 3, ..., n \," class="tex"/>)、入力X値が等間隔であるということができます。</li></ol>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">関連するXファンクション</span></h2>
<p><a href="../../XFunction/X-Function/Stats.html" title="Xファンクション:Stats">stats</a>, <a href="../../XFunction/X-Function/Reducexy.html" title="Xファンクション:Reducexy">reducexy</a>
</p>
<hr class='keywordshr'><p><span class='keywords'>キーワード:</span><span class='keywordsInput'>データ削減, サンプリング間隔, 周波数</span></p>







    