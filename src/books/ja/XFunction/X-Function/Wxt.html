<h1 class="firstheading">wxt</h1><div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Brief_Information"><span class="tocnumber">1</span> <span class="toctext">概要</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Command_Line_Usage"><span class="tocnumber">2</span> <span class="toctext">コマンドラインでの使用法</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#X-Function_Execution_Options"><span class="tocnumber">3</span> <span class="toctext">Xファンクションの実行オプション</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Variables"><span class="tocnumber">4</span> <span class="toctext">変数</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Examples"><span class="tocnumber">5</span> <span class="toctext">サンプル</span></a></li>
</ul>
</div>

<h2><a name="Brief_Information"></a><span class="mw-headline">概要</span></h2>
<p>条件を使用してワークシートデータを抽出
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">コマンドラインでの使用法</span></h2>
<pre>
1. wxt test:=&quot;mod(col(c),2)==1&quot; ow:=&lt;new&gt;;
2. wxt test:=&quot;col(1)&lt;5&quot; sel:=1;
</pre>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">Xファンクションの実行オプション</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">スクリプトからXファンクションにアクセスする場合、追加のオプションスイッチについてのページを参照してください。</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">変数</span></h2>
<table class="xfvar">
<tr>
<th width="8%">表示<br />名
</th>
<th width="8%">変数<br />名
</th>
<th width="8%">I/O<br />と<br />データ型
</th>
<th width="8%">デフォルト<br />値
</th>
<th>説明
</th></tr>
<tr>
<td>テストする条件
</td>
<td>test
</td>
<td>
<p>入力
</p><p>string
</p>
</td>
<td> <center></center>
</td>
<td> テスト条件文字列を指定します。
</td></tr>
<tr>
<td>抽出するワークシート
</td>
<td>iw
</td>
<td>
<p>入力
</p><p>Worksheet
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> 入力ワークシートを指定します。
</td></tr>
<tr>
<td>開始列
</td>
<td>c1
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> 抽出する範囲の開始列を指定します。
</td></tr>
<tr>
<td>終了列
</td>
<td>c2
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>-1</center>
</td>
<td> 抽出する範囲の終了列を指定します。
</td></tr>
<tr>
<td>開始行
</td>
<td>r1
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> 抽出する範囲の開始行を指定します。
</td></tr>
<tr>
<td>終了行
</td>
<td>r2
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>-1</center>
</td>
<td> 抽出する範囲の終了行を指定します。
</td></tr>
<tr>
<td>テスト条件を満たしたセルの選択
</td>
<td>sel
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> テスト条件を満たすセルのブロックをマークする方法を指定します。
<p>オプションリスト：
</p>
<ul><li><i>none:なし</i>
<dl><dd>セルのブロックを選択またはマークしません。</dd></dl></li>
<li><i>sel:選択セル</i>
<dl><dd>条件を満たすセルを選択/強調表示します。 </dd></dl></li>
<li><i>mask:マスクセル</i>
<dl><dd>条件を満たすセルをマスクします。</dd></dl></li></ul>
</td></tr>
<tr>
<td>抽出
</td>
<td>ow
</td>
<td>
<p>出力
</p><p>Worksheet
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td> 出力するワークシートを指定します。
<p><a class="external text" href="../../XFunction/X-Function/Output_Notations.html">このシンタックス</a>を参照してください。
</p>
</td></tr>
<tr>
<td>テスト条件のオン/オフ
</td>
<td>val
</td>
<td>
<p>出力
</p><p>ベクター
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td> Xファンクションで、入力ワークシートの各行の条件が満たされているかどうかを示すベクトルを出力できます。真は1、偽は0です。たとえば、このベクトルに1と0の 2つの要素がある場合、入力ワークシートの最初の行はテスト条件を満たし、2番目の行は満たさないことを意味します。このベクトルは<b>val</b>変数で指定できます。
</td></tr>
<tr>
<td>テスト条件を満たしたセルのインデックス
</td>
<td>pass
</td>
<td>
<p>出力
</p><p>ベクター
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td> テスト条件を満たした行のインデックスを保持するベクトルを指定します。
</td></tr>
<tr>
<td>テスト条件を満たした行数
</td>
<td>num
</td>
<td>
<p>出力
</p><p>int
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td> テスト条件を満たした行の数を出力するか指定します。
<p><br />
</p>
</td></tr></table>
<h2><a name="Examples"></a><span class="mw-headline">サンプル</span></h2>
<ul><li> コードサンプル1</li></ul>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//条件にテキストが含まれる時には、注意が必要です。次のサンプルでは、テキスト列と数値列の両方を選択するための複雑な条件を使用します。</span>
<span style="color: #008000;">//自動車のメーカー、車種ごとの特性が入力されたデータをインポート</span>
fname<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Statistics\automobile.dat&quot;</span>;
newbook;
impasc options.<span style="color: #000080;">sparklines</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;
<span style="color: #008000;">// ワークシート内で make=Acura かつ Gas Mileage &gt; 11 の行をすべて選択</span>
<span style="color: #008000;">// range変数を使用して、クエリを&quot;col(Make)[i]$&quot;より読みやすく記述</span>
range car<span style="color: #000080;">=</span>col<span style="color: #000000;">(</span>Make<span style="color: #000000;">)</span>;
<span style="color: #008000;">// 文字列変数を使用して&quot; &quot;の中に文字列を記述しなくていいようにする</span>
string str<span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Acura&quot;</span>;

<span style="color: #008000;">//wxt は &quot;=&quot; を &quot;==&quot;、&quot;and&quot; を &quot;&amp;&amp;&quot; として扱う</span>
wxt <span style="color: #ff00ff;">&quot;car=str$ and col(Gas Mileage)&gt;11&quot;</span> sel<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>; <span style="color: #008000;">// 行を選択</span>
wcellcolor c<span style="color: #000000;">:</span><span style="color: #000080;">=</span>color<span style="color: #000000;">(</span>green<span style="color: #000000;">)</span>; <span style="color: #008000;">// 選択行を色付け</span>
wcellsel; <span style="color: #008000;">// 選択をクリア</span></pre>
<ul><li> コードサンプル2</li></ul>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000; font-style: regular;">/*
この例では、wxt Xファンクションを使用して、14歳の女性の記録を抽出
1.Originのブックにサンプルデータをインポート
2.見つかった行を新しいシートに抽出し、行番号を出力して
これらの行の総数を数える
*/</span>
<span style="color: #008000;">//新規ワークブックを作成</span>
newbook result<span style="color: #000000;">:</span><span style="color: #000080;">=</span>bkname<span style="color: #000080;">$</span>;	
<span style="color: #008000;">//ファイルをインポート</span>
path<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Statistics\&quot;</span>;
fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> path<span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;body.dat&quot;</span>;
impasc;
<span style="color: #008000;">//age列と gender列の2つの範囲を定義</span>
range a<span style="color: #000080;">=</span>col<span style="color: #000000;">(</span>age<span style="color: #000000;">)</span>, g<span style="color: #000080;">=</span>col<span style="color: #000000;">(</span>gender<span style="color: #000000;">)</span>;

<span style="color: #008000;">//ワークシートデータ抽出</span>
wxt test<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;g==&quot;</span>F<span style="color: #ff00ff;">&quot; &amp; a==14&quot;</span> ow<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>new<span style="color: #000080;">&gt;</span> pass<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>new<span style="color: #000080;">&gt;</span> num<span style="color: #000000;">:</span><span style="color: #000080;">=</span>PassCount;

type <span style="color: #000080;">-</span>b Number of found rows is <span style="color: #000080;">$</span><span style="color: #000000;">(</span>PassCount<span style="color: #000000;">)</span>;</pre>







    