<h1 class="firstheading">impExcel</h1>
<div id="toc" class="toc">
<div id="toctitle">
<h2>内容</h2>
</div>
<ol>
<li class="toclevel-1 tocsection-1"><a href="#Brief_Information"><span class="tocnumber">1</span> <span class="toctext">概要</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Command_Line_Usage"><span class="tocnumber">2</span> <span class="toctext">コマンドラインの使用法</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Variables"><span class="tocnumber">3</span> <span class="toctext">変数</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Description"><span class="tocnumber">4</span> <span class="toctext">説明</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Examples"><span class="tocnumber">5</span> <span class="toctext">サンプル</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Related_X-Functions"><span class="tocnumber">6</span> <span class="toctext">関連するXファンクション</span></a></li>
</ol>
</div>
<h2><a name="Brief_Information" id="Brief_Information"></a><span class="mw-headline">概要</span></h2>
<p>Excel 97-2003ファイルは直接インポートし、Excel 2007/2010のファイルはCOMコンポーネントでインポートします</p>
<p>Origin 2016以降、新しく"COM-フリー"のExcelインポートが可能です（<a href="../../XFunction/X-Function/ImpMSExcel.html" title="Xファンクション: ImpMSExcel">impMSExcel</a>参照）。この新しいXファンクションは、MS ExcelがインストールされていなくてもOriginにXLSX および XLSM ファイルをインポートできます。</p>
<h2><a name="Command_Line_Usage" id="Command_Line_Usage"></a><span class="mw-headline">コマンドラインでの使用法</span></h2>
<p><code style="font-family: monospace;">1. fname$="sample.xls"; impExcel; // sample.xlsファイルをインポート</code></p>
<p><code style="font-family: monospace;">2. dlgfile g:=*.xls;impExcel cell:=0 l:=1 d:=NN; //フォーマットなしでインポート、1行目をロングネームとし、全ての列を属性なしにする</code></p>
<p><code style="font-family: monospace;">3. impExcel fname:="E:\Sample.xls" template:=MyTemplate.ogw; // 分析テンプレート MyTemplate にsample.xlsファイルをインポートする</code></p>
<h2><a name="Variables" id="Variables"></a><span class="mw-headline">変数</span></h2>
<table class="TableGrid" style="border-collapse: separate; border-collapse: separate;" border="1">
<tr>
<td>
<p style="text-align: center;"><b style="font-weight: bold;">表示名</b></p>
</td>
<td>
<p style="text-align: center;"><b style="font-weight: bold;">変数名</b></p>
</td>
<td>
<p style="text-align: center;"><b style="font-weight: bold;">I/O</b> <b>と</b> <b>データ型</b></p>
</td>
<td>
<p style="text-align: center;"><b style="font-weight: bold;">デフォルト値</b></p>
</td>
<td>
<p style="text-align: center;"><b style="font-weight: bold;">説明</b></p>
</td>
</tr>
<tr>
<td>
<p style="text-align: center;">ファイル名</p>
</td>
<td>
<p style="text-align: center;">fname</p>
</td>
<td>
<p>入力</p>
<p>string</p>
</td>
<td>
<p style="text-align: center;">fname$</p>
</td>
<td>
<p>インポートするファイルのファイル名</p>
</td>
</tr>
<tr>
<td>
<p style="text-align: center;">ファイル情報とデータ選択</p>
</td>
<td>
<p style="text-align: center;">info</p>
</td>
<td>
<p>入力</p>
<p>TreeNode</p>
</td>
<td>
<p style="text-align: center;">&lt;unassigned&gt;</p>
</td>
<td>
<p>ファイルの基本情報を表示するためにダイアログで使用されます。</p>
</td>
</tr>
<tr>
<td>
<p style="text-align: center;">第１ファイルインポートモード</p>
</td>
<td>
<p style="text-align: center;">firstmode</p>
</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">0</p>
</td>
<td>
<p>最初にインポートするファイルのインポートモードを指定します。</p>
<p>オプションリスト</p>
<ul>
<li><i style="font-style: italic;">replace{0}:既存データを置き換える</i></li>
</ul>
<dl>
<dd>目的のウィンドウ内にある既存のデータを置き換えてインポートします。
<dl>
<dd><b style="font-weight: bold;">Note:</b> 目的のワークブックに以前Excelファイルがインポートされたことがるか、Originは検出します。もし以前インポートした事がある場合、最初のワークシートは新しいデータで置き換えられます(繰り返しのあるシートは削除されます。既存のシートの数が足りない場合はシートが追加されます)。以前、そのファイルにインポートをしたことが無い場合は、アクティブなワークシートだけがインポートするExcelファイルで置き換えられます。他のワークシートはそのままの状態で保存され、Excelファイルの他のシートは新しいシートにインポートされます。</dd>
</dl>
</dd>
</dl>
<ul>
<li><i style="font-style: italic;">column{1}:列を追加して読み込む</i></li>
</ul>
<dl>
<dd>インポートされた、最初のExcelファイルの各シートに新しい列を作成します。</dd>
</dl>
<ul>
<li><i style="font-style: italic;">book{3}:ブックを新たに作って読み込む</i></li>
</ul>
<dl>
<dd>最初のExcelファイルのために新しいブックを作成します。</dd>
</dl>
<ul>
<li><i style="font-style: italic;">sheet{4}:シートを新たに作って読み込む</i></li>
</ul>
<dl>
<dd>最初のExcelファイルのために新しいシートを作成します。</dd>
</dl>
</td>
</tr>
<tr>
<td>
<p style="text-align: center;">複数ファイルのインポートモード(第１ファイル以外)</p>
</td>
<td>
<p style="text-align: center;">impmode</p>
</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">3</p>
</td>
<td>
<p>最初のファイル以外のExcelファイルをインポートする時に使用します。</p>
<p>オプションリスト</p>
<ul>
<li><i style="font-style: italic;">column{1}:列を追加して読み込む</i></li>
</ul>
<dl>
<dd>インポートされた、Excelファイルの各シートに新しい列を作成します。</dd>
</dl>
<ul>
<li><i style="font-style: italic;">book{3}:ブックを新たに作って読み込む</i></li>
</ul>
<dl>
<dd>インポートする各ファイルに対して新しいブックを作成します。Excelファイルが複数シートをもつ場合、各シートは同じブックの新しいシートにインポートされます。</dd>
</dl>
<ul>
<li><i style="font-style: italic;">sheet{4}:シートを新たに作って読み込む</i></li>
</ul>
<dl>
<dd>インポートする各シートに対して新しいブックを作成します。</dd>
</dl>
</td>
</tr>
<tr>
<td>
<p style="text-align: center;">テンプレート名</p>
</td>
<td>
<p style="text-align: center;">template</p>
</td>
<td>
<p>入力</p>
<p>string</p>
</td>
<td>
<p style="text-align: center;">&lt;default&gt;</p>
</td>
<td>
<p>データインポートにおいて、ワークブックテンプレート (*.otw) または分析テンプレート (*.ogw) を使用できます。このフィールドにテンプレートを入力することができ、参照ボタンをクリックして1つを選択します。デフォルトでは、Originのワークブックテンプレート<i><b>&lt;default&gt;</b></i> が使用されます。アクティブなワークシート/ワークブックから、インポートしたデータをクローン複製することが出来る、<b>&lt;Clone&gt;</b>という特別なテンプレートを提供します。<b>Note</b>: 空のワークシートを含む特定のワークブックテンプレートに複数のエクセルシートをインポートするときは、インポート挙動を追加制御するための <a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#H.2CI.2CJ.2CK">システム変数 @ISE</a> を参照することが出来ます。</p>
</td>
</tr>
<tr>
<td>
<p style="text-align: center;">Excel COMコンポートネントを使用してインポート</p>
</td>
<td>
<p style="text-align: center;">excel</p>
</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">1</p>
</td>
<td>
<p>Excelで提供しているCOMコンポーネントを使ってインポートするかどうかを指定します。このオプションを使用するには、Excelがインストールされている必要があります。</p>
</td>
</tr>
<tr>
<td>
<p style="text-align: center;">インポートセルフォーマット</p>
</td>
<td>
<p style="text-align: center;">cellformats</p>
</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">1</p>
</td>
<td>
<p>これはインポートしたセルの形式をExcelのセルと同じように維持するオプションです。このオプションはCOMモード使用中でExcelがコンピュータにインストールされる必要が無い場合には使用できません。このオプションは.XLSX または .XLSMファイルをインポートしようとすると失敗します。これらのファイルはCOMを使用しないとインポートできません。</p>
</td>
</tr>
<tr>
<td>
<p style="text-align: center;">空白列の最大数 (すべてを指定するには-1)</p>
</td>
<td>
<p style="text-align: center;">emptycols</p>
</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">0</p>
</td>
<td>
<p>これは空白列の最大数を指定します。</p>
</td>
</tr>
<tr>
<td>
<p style="text-align: center;">空のシートを削除</p>
</td>
<td>
<p style="text-align: center;">excludeempty</p>
</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">1</p>
</td>
<td>
<p>対象のウィンドウに空のシートを入力するかどうかを指定してください。チェックがついている場合、空のシートは<b>ファイル情報とデータ選択</b>ブランチの<b>ファイルシート</b>ブランチに表示されません。</p>
</td>
</tr>
<tr>
<td>
<p style="text-align: center;">メインヘッダの行数</p>
</td>
<td>
<p style="text-align: center;">mainheader</p>
</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">0</p>
</td>
<td>
<p>メインヘッダ行の数を指定します。メインヘッダはインポート時にスキップすることもできます。</p>
</td>
</tr>
<tr>
<td>
<p style="text-align: center;">サブヘッダの行数</p>
</td>
<td>
<p style="text-align: center;">subheader</p>
</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">&lt;auto&gt;</p>
</td>
<td>
<p>サブヘッダ行の数を指定します。&lt;自動&gt;の時は、以下のノードで決定されたサブヘッダの合計数を意味します。</p>
<ul>
<li>ショートネームに対する行のインデックス</li>
<li>ロングネームに対する行のインデックス</li>
<li>単位に対する行のインデックス</li>
<li>コメント行の開始インデックス</li>
<li>コメント行の終了インデックス</li>
</ul>
</td>
</tr>
<tr>
<td>
<p style="text-align: center;">ショートネームに対する行のインデックス</p>
</td>
<td>
<p style="text-align: center;">sname</p>
</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">&lt;none&gt;</p>
</td>
<td>
<p>列のショートネームの行インデックスを指定します。</p>
<p><b style="font-weight: bold;">Note:</b></p>
<p>Origin 2017から、列のショートネームは、アルファベット順に制限されます。初期設定ではこれは編集出来ません。<b>ショートネーム用行番号</b> オプションはGUIでは非表示です。インポートの際に列ショートネームを設定したい場合、目的のワークブックで、<a class="external text" href="../../UserGuide/UserGuide/Folder_and_Window_Properties_Dialog.html#The_Properties_tab"><b>ウィンドウプロパティ</b>ダイアログの<b>プロパティ</b>タブ</a>にある、<b>スプレッドシートセル表記</b>のチェックを外し、列ショートネームの編集を可能にします。</p>
</td>
</tr>
<tr>
<td>
<p style="text-align: center;">ロングネームに対する行のインデックス</p>
</td>
<td>
<p style="text-align: center;">lname</p>
</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">&lt;none&gt;</p>
</td>
<td>
<p>列のロングネームの行インデックスを指定します。</p>
</td>
</tr>
<tr>
<td>
<p style="text-align: center;">単位に対する行のインデックス</p>
</td>
<td>
<p style="text-align: center;">unit</p>
</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">&lt;none&gt;</p>
</td>
<td>
<p>列の単位の行インデックスを指定します。</p>
</td>
</tr>
<tr>
<td>
<p style="text-align: center;">コメント行の開始インデックス</p>
</td>
<td>
<p style="text-align: center;">cmt1</p>
</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">&lt;none&gt;</p>
</td>
<td>
<p>列のコメント行の開始行のインデックスを指定します。</p>
</td>
</tr>
<tr>
<td>
<p style="text-align: center;">コメント行の終了インデックス</p>
</td>
<td>
<p style="text-align: center;">cmt2</p>
</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">&lt;none&gt;</p>
</td>
<td>
<p>列のコメント行の終了行のインデックスを指定します。</p>
</td>
</tr>
<tr>
<td>
<p style="text-align: center;">パラメータの開始インデックス</p>
</td>
<td>
<p style="text-align: center;">para1</p>
</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">&lt;none&gt;</p>
</td>
<td>
<p>システムパラメータの開始行のインデックスを指定します。</p>
</td>
</tr>
<tr>
<td>
<p style="text-align: center;">パラメータの終了インデックス</p>
</td>
<td>
<p style="text-align: center;">para2</p>
</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">&lt;none&gt;</p>
</td>
<td>
<p>システムパラメータの終了行のインデックスを指定します。</p>
</td>
</tr>
<tr>
<td>
<p style="text-align: center;">ユーザパラメータの開始インデックス</p>
</td>
<td>
<p style="text-align: center;">udp1</p>
</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">&lt;none&gt;</p>
</td>
<td>
<p>ユーザパラメータの開始行のインデックスを指定します。</p>
</td>
</tr>
<tr>
<td>
<p style="text-align: center;">ユーザパラメータの終了インデックス</p>
</td>
<td>
<p style="text-align: center;">udp2</p>
</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">&lt;none&gt;</p>
</td>
<td>
<p>ユーザパラメータの終了行のインデックスを指定します。</p>
</td>
</tr>
<tr>
<td>
<p style="text-align: center;">余分な行の削除</p>
</td>
<td>
<p style="text-align: center;">removerow</p>
</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">1</p>
</td>
<td>
<p>ヘッダ行(ショートネーム、ロングネーム、単位、コメント)をデータ行から取り除くか指定します。これが選択されると、ヘッダ行はデータとしてインポートされず、データ行の設定としてのみ機能します。サブヘッダの数が&lt;自動&gt;でないとき、このコントロールは無視されます。</p>
</td>
</tr>
<tr>
<td>
<p style="text-align: center;">列のXY属性</p>
</td>
<td>
<p style="text-align: center;">desig</p>
</td>
<td>
<p>入力</p>
<p>string</p>
</td>
<td>&#160;</td>
<td>
<p>列の属性を指定します。指定された属性は、全てのシートに自動で適用されます。</p>
</td>
</tr>
<tr>
<td>
<p style="text-align: center;">ヘッダを全てのシートに適用</p>
</td>
<td>
<p style="text-align: center;">allsheets</p>
</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">0</p>
</td>
<td>
<p>ヘッダを全てのExcelシートに適用するか指定します。</p>
</td>
</tr>
<tr>
<td>
<p style="text-align: center;">インポートオプション</p>
</td>
<td>
<p style="text-align: center;"><a href="../../XFunction/X-Function/Details_of_TreeNodes_in_Import_Excel.html" title="Xファンクション: Excelインポートのツリーノードに関する詳細" style="color: #0000ff; text-decoration: underline;">options</a></p>
</td>
<td>
<p>入力</p>
<p>TreeNode</p>
</td>
<td>
<p style="text-align: center;">&lt;unassigned&gt;</p>
</td>
<td>
<p><b style="font-weight: bold;">ワークシート/ブックの名前を付ける/変更する</b>(<a href="../../XFunction/X-Function/Details_of_TreeNodes_in_Import_ASCII.html#Names" title="Xファンクション: ASCIIインポートのツリーノードに関する詳細">Options.Names</a>) の項目は、ワークシートとワークブックの名前の付け方を指定するのに使用します。<br />
<b>部分インポート</b>(<a href="../../XFunction/X-Function/Details_of_TreeNodes_in_Import_ASCII.html#PartImp" title="Xファンクション: ASCIIインポートのツリーノードに関する詳細">Options.PartImp</a>) の項目では、Excelファイルをどのように部分インポートするか指定します。このXファンクションには、サブツリーノードが利用できます：<i>partial</i>, <i>FirstCol</i>, <i>ReadCols</i>, <i>SkipCols</i>,<i>LastCol</i></p>
</td>
</tr>
<tr>
<td>
<p style="text-align: center;">出力</p>
</td>
<td>
<p style="text-align: center;">orng</p>
</td>
<td>
<p>出力</p>
<p>Range</p>
</td>
<td>
<p style="text-align: center;">&lt;active&gt;</p>
</td>
<td>
<p>これは出力範囲を指定するのに使用します。</p>
</td>
</tr>
<tr>
<td>
<p style="text-align: center;">ヘッダ情報</p>
</td>
<td>
<p style="text-align: center;">finfo</p>
</td>
<td>
<p>出力</p>
<p>TreeNode</p>
</td>
<td>
<p style="text-align: center;">&lt;optional&gt;</p>
</td>
<td>
<p>ヘッダ情報出力のオプションです。GUIでは表示されません。ユーザが、この変数を使用することはお勧めできません。</p>
</td>
</tr>
<tr>
<td>
<p>シート名またはインデックス</p>
</td>
<td>
<p style="text-align: center;">sheet</p>
</td>
<td>
<p>入力</p>
<p>string</p>
</td>
<td>&#160;</td>
<td>
<p>インポートするExcelシートを指定します。コロンを使用してシート名を分けます。GUIでは表示されません。この変数の使用はお勧めされません。</p>
</td>
</tr>
<tr>
<td>
<p>繰り返しインポート</p>
</td>
<td>
<p style="text-align: center;">reimp</p>
</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">0</p>
</td>
<td>
<p>現在のインポートが再インポートの処理かどうか指定します。GUIでは表示されません。この変数の使用はお勧めされません。</p>
</td>
</tr>
</table>
<h2><a name="Description" id="Description"></a><span class="mw-headline">説明</span></h2>
<p>このXファンクションはMicrosoft Excelファイルをインポートするのに使います。このインポートはExcelがインストールされていなくても.XLSファイルのインポートはできます。この場合、COM は使われません。新しいファイル形式( .XLSX &amp; .XLSM )のインポートはExcelが必要です。</p>
<p>- メニューから操作：<b>ファイル：インポート：Excel(XLS,XLSX,XLSM)</b>を選びます。</p>
<p>- コマンドウィンドウで操作：コマンドウィンドウに <b>impExcel</b> <b>-d</b>と入力します。</p>
<p>インポートしたExcelウィンドウには1シート以上がある可能性があります。全てのシートは目的のワークブックで別々のワークシートに、同じインポートの設定でインポートされます。</p>
<p>インポートしたExcelの最初の数行はOriginのワークシートでショートネーム、ロングネーム、単位、コメントとしてインポートできます。これらの行を指定する場合は、0以外のインデックス番号を入力してください。</p>
<p>Origin 2015では、ExcelからOriginに複数のシートを再インポートできます。Excel再インポートの間、Originが最新のデータを使用するためにリンクは維持されます。</p>
<p>Excelファイルを再インポートするには、メニューから<b>ファイル: 即時再インポート</b>を選択するか、ショートカットキーCtrl+4 で、以前の同じ設定でExcelシートをインポートできます。あるいは、メニューから<b>ファイル： 再インポート...</b>を選択して、再インポートのためのファイルのインポート設定を変更します。</p>
<p>また、コマンドウィンドウで、<b>reimport -d</b> というコマンドを実行してExcelファイルを再インポートできます。</p>
<p>Origin2016から、用意したワークブックテンプレートまたは分析テンプレートに、Excelブックのカスタマイズ/分析データを一括処理するためにExcelワークブックをインポートすることが出来ます。</p>
<h2><a name="Examples" id="Examples"></a><span class="mw-headline">サンプル</span></h2>
<p><b style="font-weight: bold;">サンプル 1</b></p>
<p>以下のサンプルはExcelファイルを工場出荷時のデフォルト設定でインポートします。</p>
<ol>
<li>コマンドウィンドウで、次のコマンドを入力します。
<pre class="lt" style="font-family: monospace;">
impExcel <span style="color: #000080;">-</span>d;
        
</pre>
これは<b>Excel</b> ダイアログを開き、インポートファイルを選択します。</li>
<li>データファイルの場所に移動します。ファイルを選択して<b>ファイルの追加</b>ボタンをクリックします。<b>OK</b> をクリックして、ダイアログを閉じます。</li>
<li>c. <b>impExcel</b>ダイアログではテーマとして<b>&lt;システムデフォルト&gt;</b>を選びます。<b>OK</b> をクリックしてダイアログを閉じます。</li>
</ol>
<p><b style="font-weight: bold;">サンプル 2</b></p>
<p>以下のコマンドはExcelファイル(c:\test.xls)をダイアログを開くことなくインポートするスクリプトです。</p>
<pre class="lt" style="font-family: monospace;">
fname<span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">"c:\test.xls"</span>; impexcel;
</pre>
<h2><a name="Related_X-Functions" id="Related_X-Functions"></a><span class="mw-headline">関連 X ファンクション</span></h2>
<p><a href="../../XFunction/X-Function/ImpFile.html" title="Xファンクション:ImpFile">impfile</a>, <a href="../../XFunction/X-Function/Impinfo.html" title="Xファンクション:Impinfo">impinfo</a></p>
