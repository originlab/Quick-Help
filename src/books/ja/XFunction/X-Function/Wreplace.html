<h1 class="firstheading">wreplace</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Brief_Information"><span class="tocnumber">1</span><span class="toctext">概要</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Command_Line_Usage"><span class="tocnumber">2</span> <span class="toctext">コマンドラインでの使用法</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#X-Function_Execution_Options"><span class="tocnumber">3</span> <span class="toctext">Xファンクションの実行オプション</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Variables"><span class="tocnumber">4</span> <span class="toctext">変数</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Description"><span class="tocnumber">5</span> <span class="toctext">説明</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Examples"><span class="tocnumber">6</span> <span class="toctext">サンプル</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Related_X-Functions"><span class="tocnumber">7</span><span class="toctext">関連するXファンクション</span></a></li>
</ul>
</div>

<h2><a name="Brief_Information"></a><span class="mw-headline">概要</span></h2>
<p>ワークシート内のセル値の検索と置換
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">コマンドラインでの使用法</span></h2>
<pre>
1. wreplace find_value:=0 replace_value:=0 cond_value:=lt;
2. wreplace rng:=col(1) type:=str find_str:=&quot;a*c&quot; replace_str:=&quot;abc&quot; wildcards:=1;
3. wreplace col(A)[1]:end[40] find_value:=-- replace_value:=0;
</pre>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">Xファンクションの実行オプション</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">スクリプトからXファンクションにアクセスする場合、追加のオプションスイッチについてのページを参照してください。</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">変数</span></h2>
<table class="xfvar">
<tr>
<th width="8%">表示<br />名
</th>
<th width="8%">変数<br />名
</th>
<th width="8%">I/O<br />と<br />データ型
</th>
<th width="8%">デフォルト<br />値
</th>
<th>説明
</th></tr>
<tr>
<td>入力
</td>
<td>rng
</td>
<td>
<p>入力/出力
</p><p>Range
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> 置き換えを実行する範囲を指定します。
</td></tr>
<tr>
<td>データの種類
</td>
<td>type
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> 検索および置換するデータのタイプを指定します。
<p>オプションリスト：
</p>
<ul><li><i>num:数値 </i>
<dl><dd>数値データを検索して置換します。</dd></dl></li>
<li><i>str:文字列</i>
<dl><dd>文字列を検索して置換します。</dd></dl></li></ul>
</td></tr>
<tr>
<td>検索対象(--は欠損値)
</td>
<td>find_value
</td>
<td>
<p>入力
</p><p>double
</p>
</td>
<td> <center></center>
</td>
<td> これは、<b>データの種類</b>（<b>type</b> 変数）で<b>数値</b>（num）が選択されている場合にのみ使用できます。<b>条件</b>変数で選択した演算子と組み合わせると、この変数の値は、置換する値を見つけるために使用される条件を定義します。&quot;--&quot;は、欠損している値を表します。
</td></tr>
<tr>
<td>検索対象
</td>
<td>find_str
</td>
<td>
<p>入力
</p><p>string
</p>
</td>
<td> <center></center>
</td>
<td> これは、<b>データの種類</b>（<b>type</b> 変数）で<b>文字列</b>（str）が選択されている場合にのみ使用できます。検索する文字列の指定に使用します。
</td></tr>
<tr>
<td>条件
</td>
<td>cond_value
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> これは、<b>データの種類</b>（<b>type</b> 変数）で<b>数値</b>（num）が選択されている場合にのみ使用できます。演算子を指定します。<b>検索対象</b>で指定された値(<b>find_value</b>変数)と組み合わせることで、置換するデータの検索に使用する条件を定義できます。
<p>オプションリスト：
</p>
<ul><li><i>eq:データ=</i>
<dl><dd><i>検索対象</i> の値と等しいデータを検索します。 </dd></dl></li>
<li><i>lt:データ&lt;</i>
<dl><dd><i>検索対象</i>の値より小さいデータを検索します。</dd></dl></li>
<li><i>le:データ&lt;=</i>
<dl><dd><i>検索対象</i>の値以下のデータを検索します。 </dd></dl></li>
<li><i>gt:データ&gt;</i>
<dl><dd><i>検索対象</i>の値よりも大きいデータを検索します。 </dd></dl></li>
<li><i>ge:データ&gt;=</i>
<dl><dd><i>検索対象</i>の値以上のデータを検索します。 </dd></dl></li>
<li><i>ne:データ&lt;&gt;</i>
<dl><dd><i>検索対象</i>の値と等しくないデータを検索します。 </dd></dl></li></ul>
</td></tr>
<tr>
<td>置き換え
</td>
<td>replace_value
</td>
<td>
<p>入力
</p><p>double
</p>
</td>
<td> <center></center>
</td>
<td> これは、<b>データの種類</b>（<b>type</b> 変数）で<b>数値</b>（num）が選択されている場合にのみ使用できます。見つかったすべてのセルが置換される新しい値を指定します。
</td></tr>
<tr>
<td>置き換え
</td>
<td>replace_str
</td>
<td>
<p>入力
</p><p>string
</p>
</td>
<td> <center></center>
</td>
<td> これは、<b>データの種類</b>（<b>type</b> 変数）で<b>文字列</b>（str）が選択されている場合にのみ使用できます。見つかったすべての文字列が置換される新しい文字列を指定します。
</td></tr>
<tr>
<td>許容値
</td>
<td>tolerance
</td>
<td>
<p>入力
</p><p>double
</p>
</td>
<td> <center>1E-8</center>
</td>
<td> これは、<b>データの種類</b>（<b>type</b> 変数）で<b>数値</b>（num）が選択されている場合にのみ使用できます。置換するワークシートデータの検索に使用される許容値を指定します。ワークシートのデータ値と<b>検索対象</b>の値の絶対差が許容範囲より小さい場合、これら2つの値は等しいと見なされます。
</td></tr>
<tr>
<td>絶対値を使う
</td>
<td>use_abs
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> これは、<b>データの種類</b>（<b>type</b> 変数）で<b>数値</b>（num）が選択されている場合にのみ使用できます。ワークシートデータの絶対値を使用して特定の条件をテストするかどうかを指定します。<b>条件</b>が「&gt;」または「&lt;」または「&lt;&gt;」の場合、これは無効になります。
</td></tr>
<tr>
<td>条件が真の場合符号を保持
</td>
<td>keep_sign
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> これは、<b>データの種類</b>（<b>type</b> 変数）で<b>数値</b>（num）が選択されている場合にのみ使用できます。条件が真で、ワークシートデータが置換された場合に、元の値の符号を保持するかどうかを指定します。
</td></tr>
<tr>
<td>条件が偽の場合欠落値として設定
</td>
<td>set_missing
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> これは、<b>データの種類</b>（<b>type</b> 変数）で<b>数値</b>（num）が選択されている場合にのみ使用できます。元の値が条件を満たさないセルに欠落値を設定するかどうかを指定します。
</td></tr>
<tr>
<td>完全一致
</td>
<td>cond_str
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> これは、<b>データの種類</b>（<b>type</b> 変数）で<b>文字列</b>（str）が選択されている場合にのみ使用できます。検索する文字列が、入力した文字列全体と完全に一致するかどうかを指定します。
</td></tr>
<tr>
<td>大文字小文字の区別
</td>
<td>con_case
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> これは、<b>データの種類</b>（<b>type</b> 変数）で<b>文字列</b>（str）が選択されている場合にのみ使用できます。文字列検索で大文字と小文字を区別するかどうかを指定します。
</td></tr>
<tr>
<td>リンクセルをスキップ
</td>
<td>skip_link
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> リンクを含むセルをスキップするかどうかを指定します。
</td></tr>
<tr>
<td>ワイルドカード文字を使う
</td>
<td>wildcards
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> ワイルドカードを使用するかどうかを指定します。ワイルドカードを使用する場合、&quot;*&quot;は任意の文字列を表し、&quot;?&quot;は任意の文字を表すことができます。
</td></tr>
<tr>
<td>ラベル行を含める
</td>
<td>label
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> 列ラベル行（ロングネーム、単位、コメントなど）を検索対象に含めるかどうかを指定します。
</td></tr>
<tr>
<td>
</td>
<td> undo
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Origin 2024bで廃止されました。代わりにXFスイッチ「-u」を使用してください。
</td></tr>
<tr>
<td>検索場所
</td>
<td>lookin
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>6</center>
</td>
<td> 指定した値または文字列を検索する場所を指定します。
<p>オプションリスト：
</p>
<ul><li><i>active_sheet:アクティブワークシート</i>
<dl><dd>アクティブなワークシートが検索されます。</dd></dl></li>
<li><i>active_book:アクティブワークブック</i>
<dl><dd>アクティブなワークブックが検索されます。</dd></dl></li>
<li><i>all_in_active_folder:アクティブフォルダ中の全ワークブック</i>
<dl><dd>アクティブフォルダ内のすべてのブックが検索されます。ただし、サブフォルダのワークブックは検索されません。</dd></dl></li>
<li><i>recursive_in_active_folder:アクティブフォルダ中の全ワークブック（サブフォルダ適用）</i>
<dl><dd>サブフォルダ内を含む、アクティブフォルダ内の全てのワークブックが検索されます。</dd></dl></li>
<li><i>open_in_active_folder:アクティブフォルダ中の全てのワークブック（オープンのもの）</i>
<dl><dd>アクティブフォルダ内の非表示でないワークブックがすべて検索されます。ただし、サブフォルダのワークブックは検索されません。</dd></dl></li>
<li><i>all_in_project:プロジェクト内の全ワークブック</i>
<dl><dd>プロジェクト内の全てのワークブックが検索されます。</dd></dl></li>
<li><i>Specified:特定範囲</i>
<dl><dd><b>rng</b>変数で指定された範囲が検索されます。</dd></dl></li></ul>
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">説明</span></h2>
<p>このXファンクションは、ワークシートセル内のテキストや数値を検索して置換することができます。
</p>
<h2><a name="Examples"></a><span class="mw-headline">サンプル</span></h2>
<ul><li> コードサンプル</li></ul>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000; font-style: regular;">/*
この例では、Xファンクションwreplaceを使用して負の値を見つけ、それらをゼロに置き換えます。
1.Originのブックにサンプルデータをインポート
2.アクティブシート内の負の値を検索してゼロに置き換えます。
*/</span>
<span style="color: #008000;">// 新たらしいブックを作成</span>
newbook;
<span style="color: #008000;">// ファイルインポート</span>
string fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Curve Fitting\Multiple Peaks.dat&quot;</span>;
impasc;
<span style="color: #008000;">// 負の値を検索して置き換え</span>
wreplace type<span style="color: #000000;">:</span><span style="color: #000080;">=</span>num find_value<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> cond_value<span style="color: #000000;">:</span><span style="color: #000080;">=</span>lt replace_value<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> lookin<span style="color: #000000;">:</span><span style="color: #000080;">=</span>active_sheet;
<span style="color: #008000; font-style: regular;">/*
次の例では、Xファンクション wreplace を使用して、
欠損値を1250に置き換えます。
1.Originのブックにサンプルデータをインポート
2.欠落値を1250に置き換えます。
*/</span>
<span style="color: #008000;">// 新しいブックを作成</span>
newbook;
<span style="color: #008000;">// ファイルをインポート</span>
string fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Graphing\Box Chart.dat&quot;</span>;
impasc;

<span style="color: #008000;">// 欠損値を1250に置き換え</span>
wreplace rng<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">(</span>a<span style="color: #000000;">)</span><span style="color: #000000;">[</span><span style="color: #0000dd;">1</span><span style="color: #000000;">]</span><span style="color: #000000;">:</span>end<span style="color: #000000;">[</span><span style="color: #0000dd;">31</span><span style="color: #000000;">]</span> find_value<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000080;">--</span> replace_value<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1250</span>;</pre>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">関連するXファンクション</span></h2>
<p><a href="../../XFunction/X-Function/Mreplace.html" title="Xファンクション:Mreplace">mreplace</a>
</p>






    