<h1 class="firstheading">w2m</h1>
<div id="toc" class="toc">
<div id="toctitle">
<h2>内容</h2>
</div>
<ol>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">メニュー情報</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">概要</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Additional_Information"><span class="tocnumber">3</span> <span class="toctext">追加の情報</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Command_Line_Usage"><span class="tocnumber">4</span> <span class="toctext">コマンドラインでの使用法</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Variables"><span class="tocnumber">5</span> <span class="toctext">変数</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Description"><span class="tocnumber">6</span> <span class="toctext">説明</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Examples"><span class="tocnumber">7</span> <span class="toctext">サンプル</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Related_X-Functions"><span class="tocnumber">8</span> <span class="toctext">関連するXファンクション</span></a></li>
</ol>
</div>
<h2><a name="Menu_Information" id="Menu_Information"></a><span class="mw-headline">メニュー情報</span></h2>
<p>ワークシート：行列に変換：直接</p>
<h2><a name="Brief_Information" id="Brief_Information"></a><span class="mw-headline">概要</span></h2>
<p>ワークシートのデータを直接行列に変換します。ここで、X,Y 座標はワークシートの最初の列/行または行ヘッダラベルで指定します</p>
<h2><a name="Additional_Information" id="Additional_Information"></a><span class="mw-headline">追加の情報</span></h2>
<p>この機能はOrigin8.0 SR4で更新されています。詳細は、<a class="external text" href="http://www.originlab.com/doc/ReleaseNotes" target="_blank">リリースノート</a> のセクションをご覧下さい。</p>
<h2><a name="Command_Line_Usage" id="Command_Line_Usage"></a><span class="mw-headline">コマンドラインでの使用法</span></h2>
<p><code style="font-family: monospace;">1. w2m iw:=[Book1]Sheet1! xy:=noxy;</code></p>
<p><code style="font-family: monospace;">2. w2m trim:=1;</code></p>
<p><code style="font-family: monospace;">3. w2m iw:=[Book1]Sheet2;</code></p>
<p><code style="font-family: monospace;">4. w2m om:=[MBook1]MSheet2;</code></p>
<p><code style="font-family: monospace;">5. w2m [Book2]1 [MBook3]MSheet2!Mat(1);</code></p>
<p><code style="font-family: monospace;">6. w2m iw:=[book1]sheet1! xy:=xcol xlabel:=param param:=L;</code></p>
<h2><a name="Variables" id="Variables"></a><span class="mw-headline">変数</span></h2>
<table class="xfvar">
<tr>
<th style="width: 8%;">表示<br />
名</th>
<th style="width: 8%;">変数<br />
名</th>
<th style="width: 8%;">I/O<br />
と<br />
データ型</th>
<th style="width: 8%;">デフォルト<br />
値</th>
<th>説明</th>
</tr>
<tr>
<td>ワークシートの入力</td>
<td>iw</td>
<td>
<p>入力</p>
<p>Worksheet</p>
</td>
<td>
<p style="text-align: center;">&lt;active&gt;</p>
</td>
<td>変換するワークシートを指定します。</td>
</tr>
<tr>
<td>データフォーマット</td>
<td>xy</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">noxy</p>
</td>
<td>X と Y 座標を指定します。
<p>オプションリスト</p>
<ul>
<li><i style="font-style: italic;">xcol:列方向のX</i></li>
</ul>
<dl>
<dd>0.X座標が元のワークシートの行の値から、列をまたぐときに指定します。</dd>
</dl>
<ul>
<li><i style="font-style: italic;">ycol:列方向のY</i></li>
</ul>
<dl>
<dd>1.Y座標が元のワークシートの行の値から、列をまたぐときに指定します。</dd>
</dl>
<ul>
<li><i style="font-style: italic;">noxy:X、Yなし</i></li>
</ul>
<dl>
<dd>2.X、Y座標を指定せずにワークシート全体を直接変換します。XとYの座標は整数値です。</dd>
</dl>
</td>
</tr>
<tr>
<td>Xデータの場所</td>
<td>xlabel</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>&#160;</td>
<td><b style="font-weight: bold;">データフォーマット</b>として<b>列方向のX</b>が選択されているときに利用可能です。ワークシートの最初の行または、列ラベル行を選択できます。
<p>オプションリスト</p>
<ul>
<li><i style="font-style: italic;">none:なし</i></li>
</ul>
<dl>
<dd>X座標として行列の列インデックスを使用します。</dd>
</dl>
<ul>
<li><i style="font-style: italic;">row1:第1データ行</i></li>
</ul>
<dl>
<dd>1行目のデータ行をX座標として使用します。</dd>
</dl>
<ul>
<li><i style="font-style: italic;">param:列ラベル</i></li>
</ul>
<dl>
<dd>列ラベル行の値をX座標として使用します。</dd>
</dl>
</td>
</tr>
<tr>
<td>第1列がYデータ</td>
<td>ycol</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">0</p>
</td>
<td><b style="font-weight: bold;">データフォーマット</b>として<b>列方向のX</b>が選択されているときに利用可能です。チェックを付けると最初の列の値をY座標とします。</td>
</tr>
<tr>
<td>Yデータの場所</td>
<td>ylabel</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>&#160;</td>
<td><b style="font-weight: bold;">データフォーマット</b>として<b>列方向のY</b>が選択されているときに利用可能です。ワークシートの最初の行または、列ラベル行を選択できます。
<p>オプションリスト</p>
<ul>
<li><i style="font-style: italic;">none:なし</i></li>
</ul>
<dl>
<dd>Y座標として行列の行インデックスを使用します。</dd>
</dl>
<ul>
<li><i style="font-style: italic;">row1:第1データ行</i></li>
</ul>
<dl>
<dd>1行目のデータ行をY座標として使用します。</dd>
</dl>
<ul>
<li><i style="font-style: italic;">param:列ラベル</i></li>
</ul>
<dl>
<dd>列ラベル行の値をY座標として使用します。</dd>
</dl>
</td>
</tr>
<tr>
<td>第1列にX値</td>
<td>xcol</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">0</p>
</td>
<td><b style="font-weight: bold;">データフォーマット</b>として<b>列方向のY</b>が選択されているときに利用可能です。チェックを付けると最初の列の値をX座標とします。</td>
</tr>
<tr>
<td>列ラベル</td>
<td>param</td>
<td>
<p>入力</p>
<p>string</p>
</td>
<td>&#160;</td>
<td><b style="font-weight: bold;">Xデータの場所</b>または<b>Yデータの場所</b>として、<i>列ラベル</i> が選択されているときに利用可能です。XまたはY座標として使用するラベル行を指定します。各列ラベル行を表す文字については<a class="external text" href="../../LabTalk/LabTalk/Column_Label_Row_Characters.html">列ラベル行の文字</a> を参照してください。</td>
</tr>
<tr>
<td>等間隔判定の許容値(%)</td>
<td>tol</td>
<td>
<p>入力</p>
<p>double</p>
</td>
<td>
<p style="text-align: center;">5</p>
</td>
<td>等間隔かチェックするのに使用する許容値です。</td>
</tr>
<tr>
<td>座標に対する線形フィットでの予測値を使用</td>
<td>lr</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">0</p>
</td>
<td>このチェックボックスは座標に線形フィット推定を使用するかを指定します。</td>
</tr>
<tr>
<td>欠損値の調整</td>
<td>trim</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">1</p>
</td>
<td>欠損行または列を取り除くか決定します。</td>
</tr>
<tr>
<td>出力行列</td>
<td>om</td>
<td>
<p>出力</p>
<p>MatrixObject</p>
</td>
<td>
<p style="text-align: center;">&lt;新規&gt;</p>
</td>
<td>出力行列を指定します。
<p><a class="external text" href="../../XFunction/X-Function/Output_Notations.html">出力表記</a>シンタックスをご覧ください。</p>
</td>
</tr>
</table>
<h2><a name="Description" id="Description"></a><span class="mw-headline">説明</span></h2>
<p>このXファンクションは、ワークシートデータを行列に変換します。</p>
<p>行列は1つのＺ値のデータセットを表示し、次のように配置されます。</p>
<dl>
<dd>
<ul>
<li><i style="font-style: italic;">線形</i> で等間隔なX値にマッピングされた番号付き列</li>
<li><i style="font-style: italic;">線形</i> で等間隔なY値にマッピングされた番号付き行</li>
</ul>
</dd>
</dl>
<p><br />
デフォルトで、Originは行列の列番号や行番号を行や列の見出しに表示します。(下図の左)XおよびY値を表示するには(下図の右)、メニューから<b>表示:X/Yを表示</b>を選択します。</p>
<dl>
<dd><a class="image" style="color: #0000ff; text-decoration: underline;"><img alt="W2m help English files image002.png" src="../images/W2m/W2m_help_English_files_image002.png" width="352" height="156" border="0" /></a> <a class="image"><img alt="W2m help English files image004.png" src="../images/W2m/W2m_help_English_files_image004.png" width="352" height="156" border="0" /></a></dd>
</dl>
<p><br />
XまたはY値を指定せずにワークシートを変換する場合、Originはワークシート値を直接行列に変換し、自動的に行列の座標を割り当てます。座標をリセットするには、<b>行列：次数/ラベルの設定</b>とメニューから操作します。ワークシートのセルまたはラベルにXまたはY座標の情報が含まれる場合、次のように構成されます。</p>
<dl>
<dd><a class="image" style="color: #0000ff; text-decoration: underline;"><img alt="W2m help English files image18.png" src="../images/W2m/W2m_help_English_files_image18.png" width="450" height="177" border="0" /></a></dd>
</dl>
<p><br />
新しい行列のXおよびY座標は、これらの値でセットされます。(Note: XおよびY座標値は等間隔になります。)</p>
<p>例えば、</p>
<ol>
<li>Xデータが1行目にあり、Yデータが1列目にある場合、Xファンクションは、次のような (<i>列数</i> -1) × (<i>行数</i> -1) のZ値行列を作成します。
<dl>
<dd><a class="image" style="color: #0000ff; text-decoration: underline;"><img alt="W2m help English files image19.png" src="../images/W2m/W2m_help_English_files_image19.png" width="550" height="659" border="0" /></a></dd>
</dl>
</li>
<li>ワークシートラベルにY値があり、X値が指定されていない場合、このXファンクションは、次のような行列を作成します。
<dl>
<dd><a class="image" style="color: #0000ff; text-decoration: underline;"><img alt="W2m help English files image20.png" src="../images/W2m/W2m_help_English_files_image20.png" width="546" height="669" border="0" /></a></dd>
</dl>
</li>
</ol>
<p>この場合、出力行列は変換時に転置されます。</p>
<p>ワークシートの行全体または列全体に対して欠損値がある場合、<b>欠損値の調整</b>ボックスにチェックを付けると、欠損値の行または列を調整します。</p>
<h2><a name="Examples" id="Examples"></a><span class="mw-headline">サンプル</span></h2>
<ul>
<li>コードサンプル</li>
</ul>
<pre class="lt" style="font-family: monospace;">
<span style="color: #008000; font-style: regular;">/* このサンプルでは、ワークシートデータを行列に変換する方法を示します。サンプルデータは、exe_パス\Samples\Matrix Conversion and Gridding\DirectXY.dat です。1.新しく作成したワークブックにデータをロード2.最初の行をXとし、最初の列をYとしてワークシートデータを行列に変換 */</span> <span style="color: #008000;">// サンプルデータ取得</span> fn<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">"Samples\Matrix Conversion and Gridding\DirectXY.dat"</span>; newbook; impASC fn<span style="color: #000080;">$</span>; <span style="color: #008000;">// 最初の行をXとし、最初の列をYとしてワークシートデータを行列に変換</span> w2m xy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> xlabel<span style="color: #000000;">:</span><span style="color: #000080;">=</span>row1 ycol<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
</pre>
<h2><a name="Related_X-Functions" id="Related_X-Functions"></a><span class="mw-headline">関連 X ファンクション</span></h2>
<p><a href="../../XFunction/X-Function/M2w.html" title="Xファンクション:M2w">m2w</a>, <a href="../../XFunction/X-Function/R2m.html" title="Xファンクション:R2m">r2m</a>, <a href="../../XFunction/X-Function/Wexpand2m.html" title="Xファンクション:Wexpand2m">wexpand2m</a></p>
