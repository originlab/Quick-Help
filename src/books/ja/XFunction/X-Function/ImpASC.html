<h1 class="firstheading">impASC</h1>
<table id="toc" class="toc" summary="Contents">
<tr>
<td>
<div id="toctitle">
<h2>内容</h2>
</div>
<ol>
<li class="toclevel-1"><a href="#Brief_Description"><span class="tocnumber">1</span> <span class="toctext">説明</span></a></li>
<li class="toclevel-1"><a href="#Additional_Information"><span class="tocnumber">2</span> <span class="toctext">追加の情報</span></a></li>
<li class="toclevel-1"><a href="#Command_Line_Usage"><span class="tocnumber">3</span> <span class="toctext">コマンドラインでの使用法</span></a></li>
<li class="toclevel-1"><a href="#Variables"><span class="tocnumber">4</span> <span class="toctext">変数</span></a></li>
<li class="toclevel-1"><a href="#Description"><span class="tocnumber">5</span> <span class="toctext">説明</span></a>
<ol>
<li class="toclevel-2"><a href="#When_to_use_this_function.3F"><span class="tocnumber">5.1</span> <span class="toctext">この関数を使用するタイミング</span></a></li>
<li class="toclevel-2"><a href="#Options_Tree_Details"><span class="tocnumber">5.2</span> <span class="toctext">オプションツリーの詳細</span></a></li>
</ol>
</li>
<li class="toclevel-1"><a href="#Examples"><span class="tocnumber">6</span> <span class="toctext">サンプル</span></a></li>
<li class="toclevel-1"><a href="#Related_X-Functions"><span class="tocnumber">7</span> <span class="toctext">関連のXファンクション</span></a></li>
</ol>
</td>
</tr>
</table>
<a name="Brief_Description" id="Brief_Description"></a>
<h2><span class="mw-headline">説明</span></h2>
<p>ASCIIファイルをインポートします。</p>
<a name="Additional_Information" id="Additional_Information"></a>
<h2><span class="mw-headline">追加の情報</span></h2>
<p>この機能は Origin 8.5 SR0で更新されました。</p>
<a name="Command_Line_Usage" id="Command_Line_Usage"></a>
<h2><span class="mw-headline">コマンドラインでの使用法</span></h2>
<ol>
<li style="font-family: monospace;"><code style="font-family: monospace;">impASC fname:="c:\nitrogen.txt" options.sparklines:=0;</code></li>
<li style="font-family: monospace;"><code style="font-family: monospace;">impasc fname:="c:\vartest1.dat%(crlf)c:\vartest2.dat" options.impmode:=4;</code></li>
</ol>
<a name="Variables" id="Variables"></a>
<h2><span class="mw-headline">変数</span></h2>
<table class="xfvar">
<tr>
<th style="width: 8%;">表示<br />
名</th>
<th style="width: 8%;">変数<br />
名</th>
<th style="width: 8%;">I/O<br />
と<br />
データ型</th>
<th style="width: 8%;">デフォルト<br />
値</th>
<th>説明</th>
</tr>
<tr>
<td>ファイル名</td>
<td>fname</td>
<td>
<p>入力</p>
<p>string</p>
</td>
<td>
<p style="text-align: center;">fname$</p>
</td>
<td>インポートするファイルの名前を指定します。</td>
</tr>
<tr>
<td>起動オプション</td>
<td>menu</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">1</p>
</td>
<td>この変数は、メニューを制御するもので、実際にはこのXファンクションは使いません。
<p><br />
オプションリスト:</p>
<ul>
<li><i style="font-style: italic;">single:単一ASCII(&amp;S)</i>
<dl>
<dd>単一ASCII</dd>
</dl>
</li>
<li><i style="font-style: italic;">multiple:複数ASCII</i>
<dl>
<dd>複数ASCII</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr>
<td>ファイル情報</td>
<td>trfiles</td>
<td>
<p>入力</p>
<p>TreeNode</p>
</td>
<td>
<p style="text-align: center;">&lt;unassigned&gt;</p>
</td>
<td>これはファイルの基本情報を表示するダイアログボックス内で使われます。情報はOriginが自動的に検出します。</td>
</tr>
<tr>
<td>インポートオプション</td>
<td><a href="../../XFunction/X-Function/Details_of_TreeNodes_in_Import_ASCII.html" title="X-Function:Details of TreeNodes in Import ASCII" style="color: #0000ff; text-decoration: underline;">options</a></td>
<td>
<p>入力</p>
<p>TreeNode</p>
</td>
<td>
<p style="text-align: center;">&lt;unassigned&gt;</p>
</td>
<td>ダイアログのインポートオプションを指定します。詳細は以下の説明をご覧下さい。</td>
</tr>
<tr>
<td>出力</td>
<td>orng</td>
<td>
<p>出力</p>
<p>Range</p>
</td>
<td>
<p style="text-align: center;">&lt;active&gt;</p>
</td>
<td>これは出力範囲を指定するのに使用します。
<p><a href="../../XFunction/X-Function/Output_Notations.html" title="http://wiki.originlab.com/~originla/wiki2/index.php?title=X-Function:Output_Notations" rel="nofollow">ここに記載されている</a>シンタックスをご覧ください。</p>
</td>
</tr>
<tr>
<td>ヘッダ情報</td>
<td>trheader</td>
<td>
<p>出力</p>
<p>TreeNode</p>
</td>
<td>
<p style="text-align: center;">&lt;unassigned&gt;</p>
</td>
<td>出力ヘッダ情報この変数は内部的に使用されます。使わないでください。</td>
</tr>
<tr>
<td>インポートフィルタ</td>
<td>trFilter</td>
<td>
<p>入力</p>
<p>TreeNode</p>
</td>
<td>
<p style="text-align: center;">&lt;optional&gt;</p>
</td>
<td>ダイアログのフィルターオプションを指定します。この変数は内部的に使用されます。使わないでください。</td>
</tr>
<tr>
<td>ファイル情報保存インデックス</td>
<td>findex</td>
<td>
<p>出力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">&lt;optional&gt;</p>
</td>
<td>目的のワークブックのファイル情報保存のインデックス番号を指定します。</td>
</tr>
<tr>
<td>繰り返しインポート</td>
<td>reimp</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">0</p>
</td>
<td>現在のインポートが再インポートの処理かどうか指定します。この変数の使用はお勧めしません。</td>
</tr>
</table>
<a name="Description" id="Description"></a>
<h2><span class="mw-headline">説明</span></h2>
<p>この関数は、ダイアログのオプションを設定することで、ASCIIファイルをインポートします。これは、メニュー、ツールバーまたはコマンドウィンドウから実行できます。</p>
<a name="When_to_use_this_function.3F" id="When_to_use_this_function.3F"></a>
<h3><span class="mw-headline">この関数を使用するタイミング</span></h3>
<p>Originは、ASCIIファイルをインポートする3つのツールを提供します。<b>インポートウィザード</b>, <b>単一ASCIIインポート</b>, <b>複数ASCIIインポート</b>.</p>
<p>インポートするファイルのデータ構造を知っている場合には、<b>単一ASCIIインポート</b>と<b>複数ASCIIインポート</b>が役に立ちます。</p>
<p>ファイルの構造について詳細に分からない場合、<b>インポートウィザード</b>を選択するのが良いです。<b>インポートウィザード</b>は、強力で、多用途であり、設定の確認のためのプレビュー領域だけでなく、多くのオプションを提供しています。</p>
<a name="Options_Tree_Details" id="Options_Tree_Details"></a>
<h3><span class="mw-headline">オプションツリーの詳細</span></h3>
<dl>
<dd>
<ul>
<li><b style="font-weight: bold;">インポートオプションツリー</b></li>
</ul>
<dl>
<dd>利用可能な多くのインポートオプションについての詳細は、 <a href="../../XFunction/X-Function/Details_of_TreeNodes_in_Import_ASCII.html" title="http://wiki.originlab.com/~originla/wiki2/index.php?title=X-Function:Details_of_TreeNodes_in_Import_ASCII" rel="nofollow">impASC オプションのツリーノード情報のページ</a> をご覧ください。</dd>
</dl>
</dd>
</dl>
<a name="Examples" id="Examples"></a>
<h2><span class="mw-headline">サンプル</span></h2>
<p>ASCIIファイルをインポートするオプションは多くあるので、この関数にはダイアログを通してアクセスすることがほとんどです。しかし、自動的にファイルをインポートするスクリプトからアクセスすることもできます。このセクションでは、ダイアログとスクリプトの両方で<b>impAsc</b>にアクセスする方法を説明します。</p>
<ul>
<li><b style="font-weight: bold;">ダイアログを使って</b>impAscにアクセスする</li>
</ul>
<dl>
<dd>以下のステップは、ヘッダ行を自動で判断してファイルをインポートする方法についてです。
<ol>
<li>新規ワークブックを作成します。</li>
<li>次のどちらかの方法でimpASC ダイアログを開きます。コマンドに <i><code>impASC -d;</code></i> を入力する。標準ツールバーで<b>複数ASCIIのインポート</b>をクリックする。メインメニューで、<b>ファイル：</b><b>インポート：</b><b>M複数ASCII</b>を選びます。</li>
<li>インポートしたいファイルを選びます。(この場合、<i>&lt;Origin Installation Folder&gt;</i>;\<b>Samples\Import and Export\S15-125-03.dat</b>).<b>OK</b>をクリックします。</li>
<li>impASCダイアログで、 <b>ダイアログテーマ</b>の隣にある<b>矢印ボタン</b>をクリックして、<b>システムデフォルト</b>を選択します。</li>
<li><b style="font-weight: bold;">インポートオプション</b>で、<b>ヘッダ行</b>ノードを開きます。<b>サブヘッダ行の自動決定</b>が選択されていることを確認します。</li>
<li><b style="font-weight: bold;">OK</b>をクリックして、ファイルをインポートします。ファイルがワークブックにインポートされ、ロングネーム、単位、スパークラインが正しくセットされます。</li>
</ol>
</dd>
</dl>
<ul>
<li><b style="font-weight: bold;">スクリプトから impASC にアクセス</b></li>
</ul>
<ol>
<li>基本的な使用法
<dl>
<dd><code style="font-family: monospace;">impASC fname:= system.path.program$+"Samples\Import and Export\S15-125-03.dat";</code></dd>
</dl>
</li>
<li>次のスクリプトは、最初にXファンクションdlgFileを使って、1つのファイルを探すためにファイルを開くダイアログを開き、ファイル名を文字列変数<b>fname$</b>に保存します。そして、impASCはパラメータ<b>fname</b>を指定せずに使用することができます。
<dl>
<dd><code style="font-family: monospace;">dlgFile;</code></dd>
<dd><code style="font-family: monospace;">impASC;</code></dd>
</dl>
</li>
<li>impASCは、複数ファイルのインポートをサポートしているので、 通常この関数は、Xファンクションfindfilesと一緒に使うことができます。
<dl>
<dd>//データフォルダをセットします</dd>
<dd><code style="font-family: monospace;">string path$ = system.path.program$+"Samples\Import and Export";</code></dd>
<dd>// dlgPathを使って、フォルダのパスを参照し、パスをpath$に保存できます。</dd>
<dd>// dlgPath;</dd>
<dd>// データフォルダに移動</dd>
<dd><code style="font-family: monospace;">cd path$;</code></dd>
<dd>// s*.datに合致するすべてのファイルを見つける</dd>
<dd><code style="font-family: monospace;">findFiles ext:=s*.dat;</code></dd>
<dd>// ファイルのインポート</dd>
<dd><code style="font-family: monospace;">impASC;</code></dd>
</dl>
</li>
</ol>
<a name="Related_X-Functions" id="Related_X-Functions"></a>
<h2><span class="mw-headline">関連するXファンクション</span></h2>
<p><a href="../../XFunction/X-Function/ImpFile.html" title="X-Function:ImpFile">impFile</a>, <a href="../../XFunction/X-Function/Impinfo.html" title="X-Function:Impinfo">impinfo</a>, <a href="../../XFunction/X-Function/DlgPath.html" title="X-Function:DlgPath">dlgPath</a>, <a href="../../XFunction/X-Function/DlgFile.html" title="X-Function:DlgFile">dlgFile</a>, <a href="../../XFunction/X-Function/FindFiles.html" title="X-Function:FindFiles">findFiles</a>, <a href="../../XFunction/X-Function/Cd.html" title="X-Function:Cd">cd</a></p>
