<h1 class="firstheading">グラフブラウザダイアログをXファンクションで開く</h1>
<p><span class="OIndex" style="display: none;">Xファンクション, グラフブラウザダイアログを作成する</span></p>
<h2><span class="mw-headline" id="Summary">サマリー</span></h2>
<p>このサンプルでは、XファンクションのGetNダイアログでグラフを指定する<span class="OIndex">グラフブラウザ</span>ダイアログを開くボタンを追加します。そして、フィルタ関数でグラフブラウザダイアログをカスタマイズする方法を示します。</p>
<h2><span class="mw-headline" id="You_will_learn">学習する項目</span></h2>
<ol>
<li>Xファンクションダイアログでグラフブラウザを開くボタンを追加する方法</li>
<li>フィルタ関数でグラフブラウザダイアログをカスタマイズする方法</li>
</ol>
<h2><span class="mw-headline" id="Steps">ステップ</span></h2>
<p>次の3つのステップは、Xファンクションダイアログで、フィルタ関数を使用しないでグラフブラウザダイアログを開くボタンを追加する方法を示します。これは、最も簡単な処理で、グラフブラウザのすべての設定がデフォルトにセットされます。</p>
<ol start="1">
<li><b style="font-weight: bold;">ツール：Xファンクションビル</b>をメニューから選択します。次のように、Xファンクション <b>GraphFilterTest</b> を作成します。<br />
<a class="image"><img alt="XFProgramming Control Graph Browser.png" src="../images/Open_Graph_Browser_Dialog_in_X-Function/XFProgramming_Control_Graph_Browser.png" width="573" height="265" border="0" /></a><br />
制御文字列は「<i>...Graph GraphBrowserFilter</i>」です。</li>
<li>コードビルダボタンをクリックしてコードビルダに移動し、メイン関数 GraphFilterTestで<i>out_str(pages);</i> を入力します。コンパイルボタンをクリックし、ダイアログに戻るをクリックします。</li>
<li>OXFファイルを保存するボタンをクリックして保存します。コマンドウィンドウで「<i>GraphFilterTest -d</i>」を実行し、ダイアログが表示されたら、 参照ボタンをクリックします。そこでグラフを選択し、OKをクリックしてダイアログを閉じます。選択したグラフウィンドウの名前は、コマンドウィンドウに出力されます。</li>
<li>グラフブラウザダイアログをカスタマイズしたくない場合、以下を続ける必要はありません。以下のステップは、例えばデフォルトビューモードをツリービューにセットするなど、すべてグラフブラウザダイアログをカスタマイズする方法です。MyGraphFilter.cを作成し、<i>&lt;Origin インストールフォルダ&gt;\OriginC\OriginLab</i>に保存します。※Windows Vista/7/8をご利用の方はOriginを「管理者として実行」してからこのファイルを保存してください。ソースファイルは以下のコードを含みます。
<pre class="oc" style="font-family: monospace;">
#include <span style="color: #000080;">&lt;</span>..\Originlab\GraphFilter.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span> <span style="color: #008000;">// Originの組み込みファイル</span>
int GraphBrowserFilter<span style="color: #000000;">(</span>int nMsg, Page<span style="color: #000040;">&amp;</span> pg <span style="color: #000080;">=</span> NULL<span style="color: #000000;">)</span> <span style="color: #000000;">
{</span> 
        switch<span style="color: #000000;">(</span>nMsg<span style="color: #000000;">)</span> 
        <span style="color: #000000;">{</span> 
        case GBFM_IS_USE_PAGE<span style="color: #000000;">:</span> <span style="color: #008000;">// Trueに対して1を返す</span>
                if<span style="color: #000000;">(</span><span style="color: #000040;">!</span>pg<span style="color: #000000;">)</span> 
                        return <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>; 
                <span style="color: #008000;">// 複数レイヤを含むフィルタページ </span>
                return pg.<span style="color: #000000;">Layers</span>.<span style="color: #000000;">Count</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000080;">&gt;</span> <span style="color: #0000dd;">1</span>?<span style="color: #0000dd;">0</span> <span style="color: #000000;">:</span> <span style="color: #0000dd;">1</span>; 
 
        case GBFM_SHOW_EMBED_PAGE_CHKBOX<span style="color: #000000;">:</span> 
                <span style="color: #008000;">// GraphFilter.hの別のオプションを参照</span>
                return EMBED_CHECKBOX_ENABLE; 
 
        case GBFM_SHOW_SWITCH_MODE<span style="color: #000000;">:</span> 
                <span style="color: #008000;">// GraphFilter.hの別のオプションを参照       </span>
                return VIEW_MODE_BOTH_WITH_TREE_DEFAULT; 
 
        case GBFM_SORT_PAGES<span style="color: #000000;">:</span>
                return <span style="color: #0000dd;">1</span>; <span style="color: #008000;">// 0 または1を返す</span>
        <span style="color: #000000;">}</span> 
        return <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>; <span style="color: #008000;">// エラー </span><span style="color: #000000;">
}</span>
</pre></li>
<li>MyGraphFilter.hを作成し、<i>&lt;Origin インストールフォルダ&gt;\OriginC\OriginLab</i>に保存します。</li>
<li>Xファンクションビルダで<i>GraphFilterTest</i> Xファンクションを開き、コードビルダボタンをクリックし、上記で新しく作成したヘッダファイルを含めます。MyGraphFilter.c および MyGraphFilter.h は、別のフォルダに配置できますが、それぞれが同じフォルダ内に存在する必要があります。それらが別のフォルダにある場合、次のようにヘッダファイルをインクルードするのに絶対パスを使用する必要があります。
<pre class="oc" style="font-family: monospace;">
<span style="color: #008000;">//Case 1. ヘッダファイルがOriginC\Originlab\ フォルダにある場合</span><span style="color: #008000;">
//追加のインクルードファイルをここに記述</span>
#include <span style="color: #000080;">&lt;</span>..\Originlab\MyGraphFilter.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span> 
 <span style="color: #008000;">
//Case 2. ヘッダファイルがOriginC\Originlab\ フォルダにない場合</span><span style="color: #008000;">
//追加のインクルードファイルをここに記述</span>
#include <span style="color: #ff00ff;">"D:<span style="color: #666666; font-weight: bold;">\M</span>yFolder<span style="color: #666666; font-weight: bold;">\M</span>yGraphFilter.h"</span>
        
</pre></li>
<li>コマンドウィンドウで、「<i>GraphFilterTest -d</i> 」を実行し、GraphFilterTestダイアログで参照ボタンをクリックします。<i>埋め込みグラフを表示</i>チェックボックスが有効で、選択されていることが分かります。そして、埋め込みグラフがツリービューに一覧表示されます。<br />
<a class="image"><img alt="XFProgramming Control Graph Browser2.png" src="../images/Open_Graph_Browser_Dialog_in_X-Function/XFProgramming_Control_Graph_Browser2.png" width="600" height="252" border="0" /></a></li>
<li>コードビルダで、<i>&lt;Origin インストールフォルダ&gt;\OriginC\OriginLab</i>からMyGraphFilter.cを開きます。GBFM_SHOW_EMBED_PAGE_CHKBOXに対して、戻り値を「EMBED_CHECKBOX_ENABLE」から「EMBED_CHECKBOX_DISABLE_EMBEDDING_PAGE_NEVER_ENABLE」に変更します。コンパイルボタンをクリックしてMyGraphFilter.cをコンパイルします。コマンドウィンドウで「<i>GraphFilterTest -d</i> 」を再度実行します。<i>埋め込みグラフを表示</i>チェックボックスが無効になり、グレーアウトされていることが分かります。そして、埋め込みグラフがツリービューに表示されません。<br />
<a class="image"><img alt="XFProgramming Control Graph Browser3.png" src="../images/Open_Graph_Browser_Dialog_in_X-Function/XFProgramming_Control_Graph_Browser3.png" width="600" height="252" border="0" /></a></li>
<li>MyGraphFilter.cの他の場合に対しても、戻り値として <i>&lt;Originインストールフォルダ&gt;\OriginC\Originlab\MyGraphFilter.h</i> の他の値を使うことができます。それぞれを変更したら、忘れずにMyGraphFilter.cをコンパイルしてください。</li>
<li>グラフブラウザを含む組込みのXファンクション(インポートとエクスポートのXファンクション <b>expGraph</b>等) も同じ方法でカスタマイズすることができます。</li>
</ol>


