<h1 class="firstheading">Wextractインポートのツリーノードに関する詳細</h1>
<p><br /></p>
<table id="toc" class="toc" summary="Contents">
<tr>
<td>
<div id="toctitle">
<h2>内容</h2>
</div>
<ol>
<li class="kadov-p"><a href="#settings"><span class="tocnumber">1</span> <span class="toctext">設定</span></a>
<ol>
<li class="kadov-p"><a href="#stAlias"><span class="tocnumber">1.1</span> <span class="toctext">stAlias</span></a></li>
<li class="kadov-p"><a href="#stCondition"><span class="tocnumber">1.2</span> <span class="toctext">stCondition</span></a></li>
<li class="kadov-p"><a href="#stMethod"><span class="tocnumber">1.3</span> <span class="toctext">stMethod</span></a></li>
<li class="kadov-p"><a href="#stRowRange"><span class="tocnumber">1.4</span> <span class="toctext">stRowRange</span></a></li>
</ol>
</li>
</ol>
</td>
</tr>
</table>
<a name="settings" id="settings"></a>
<h2><span class="mw-headline">設定</span></h2>
<p><b style="font-weight: bold;">設定</b>ツリーは、<b>wextract</b> Xファンクションでの、すべての設定を指定します。</p>
<p>シンタックス: <b>Options.<i>Treenode</i>:=&lt;value&gt;</b></p>
<p>例:</p>
<ul>
<li class="kadov-p"><b style="font-weight: bold;">settings.Cols:=0</b> <b>settings.RecalMode:=0</b></li>
</ul>
<table class="treenode">
<tr>
<th style="width: 4%;">ツリーノード</th>
<th style="width: 4%;">ラベル</th>
<th style="width: 4%;">データ型</th>
<th style="width: 4%;">デフォルト</th>
<th style="width: 32%;">説明</th>
</tr>
<tr>
<td>Cols</td>
<td>列</td>
<td>string</td>
<td>
<p>&#160;</p>
</td>
<td>抽出される列を指定します。これは、settings.stMethod.Methodが0でない場合に、指定しなければなりません。列インデックスは0から始まり、複数列を指定する場合、それぞれ"|"で区切ります。サンプル
<ul>
<li class="kadov-p">settings.cols:=0 //最初の列を抽出</li>
<li class="kadov-p">settings.cols:="0|1" //最初、2番目の列を抽出</li>
</ul>
</td>
</tr>
<tr>
<td>RecalMode</td>
<td>再計算</td>
<td>int</td>
<td>0</td>
<td>再計算モードを指定します。
<ul>
<li class="kadov-p">0: 無し</li>
<li class="kadov-p">1: 自動</li>
<li class="kadov-p">2: 手動</li>
</ul>
</td>
</tr>
</table>
<a name="stAlias" id="stAlias"></a>
<h3><span class="mw-headline">stAlias</span></h3>
<p><b style="font-weight: bold;">設定</b>ツリーの<b>stAlias</b> ブランチは、列の別名を定義します。そして、これらの別名を使って、If testの条件を構築します。</p>
<p>シンタックス: <b>settings.stAlias.<i>Treenode</i>:= &lt;value&gt;</b></p>
<p>サンプル</p>
<ul>
<li class="kadov-p"><b style="font-weight: bold;">settings.stAlias.Cols:=1 settings.stAlias.AliasNames:=A</b></li>
<li class="kadov-p"><b style="font-weight: bold;">settings.stAlias.Cols:="1|2" settings.stAlias.AliasNames:="V|A"</b></li>
</ul>
<table class="treetable">
<tr>
<th style="width: 4%;">ツリーノード</th>
<th style="width: 4%;">ラベル</th>
<th style="width: 4%;">データ型</th>
<th style="width: 4%;">デフォルト</th>
<th style="width: 32%;">説明</th>
</tr>
<tr>
<td>Cols</td>
<td>列</td>
<td>string</td>
<td>
<p>&#160;</p>
</td>
<td>別名を定義した列のインデックスを指定します。列インデックスは1から開始します。複数列に対して別名を定義する場合、そのインデックス番号を "|"で分けます。サンプル
<ul>
<li class="kadov-p">settings.stAlias.cols:="1" //最初の列</li>
<li class="kadov-p">settings.stAlias.cols:="1|2" //最初、2番目の列</li>
</ul>
</td>
</tr>
<tr>
<td>AliasNames</td>
<td>別名</td>
<td>string</td>
<td>
<p>&#160;</p>
</td>
<td>settings.stAlias.Cols stringで選択した列に対する別名を指定します。複数の別名が定義されている場合、"|"で分けます。サンプル
<ul>
<li class="kadov-p">settings.stAlias.AliasNames:="A" //選択した列に対する別名は "A".</li>
<li class="kadov-p">settings.stAlias.AliasNames:="A|B" //選択した列に対する別名は、それぞれ "A" と "B"</li>
</ul>
</td>
</tr>
</table>
<a name="stCondition" id="stCondition"></a>
<h3><span class="mw-headline">stCondition</span></h3>
<p><b style="font-weight: bold;">設定</b>ツリーの <b>stCondition</b> ブランチは、ある行が抽出されるかどうかのテストの条件を指定し、データがループされる前、条件がテストされる前にスクリプトが実行されます。</p>
<p>シンタックス: <b>settings.stCondition.<i>Treenode</i>:= &lt;value&gt;</b></p>
<p>サンプル</p>
<dl>
<dd><b style="font-weight: bold;">settings.stCondition.Condition:="A&lt;5"</b></dd>
<dd><b style="font-weight: bold;">settings.stCondition.BeforeLoop:="j=1;"</b></dd>
<dd><b style="font-weight: bold;">settings.stCondition.BeforeIfCondition:="j=j+1;"</b></dd>
</dl>
<table class="treetable">
<tr>
<th style="width: 5%;">ツリーノード</th>
<th style="width: 10%;">ラベル</th>
<th style="width: 5%;">データ型</th>
<th style="width: 5%;">デフォルト</th>
<th style="width: 32%;">説明</th>
</tr>
<tr>
<td>Condition</td>
<td>条件</td>
<td>string</td>
<td>
<p>&#160;</p>
</td>
<td>行が抽出されるかどうかをテストする条件を指定します。データ行が条件に合うと、抽出されます。</td>
</tr>
<tr>
<td>BeforeLoop</td>
<td>データループ選択前に実行するスクリプト:</td>
<td>string</td>
<td>
<p>&#160;</p>
</td>
<td>選択したデータ行が条件に合うかどうかテストされる前に実行するスクリプトを指定します。詳細は、 <a href="../../UserGuide/UserGuide/Extract_Worksheet_Data.html#Scripts" title="http://docwiki.originlab.com/index.php?title=UserGuide:Extract_Worksheet_Data#Scripts" rel="nofollow">ここを</a>ご覧ください。</td>
</tr>
<tr>
<td>BeforeIfCondition</td>
<td>IF条件前に実行するスクリプト:</td>
<td>string</td>
<td>
<p>&#160;</p>
</td>
<td>行が条件に合っているかをテストする前に、ループで実行するスクリプトを指定します。詳細は、 <a href="../../UserGuide/UserGuide/Extract_Worksheet_Data.html#Scripts" title="http://docwiki.originlab.com/index.php?title=UserGuide:Extract_Worksheet_Data#Scripts" rel="nofollow">ここを</a>ご覧ください。</td>
</tr>
</table>
<a name="stMethod" id="stMethod"></a>
<h3><span class="mw-headline">stMethod</span></h3>
<p><b style="font-weight: bold;">設定</b>ツリーの <b>stMethod</b> ブランチは、出力の方法を指定します。</p>
<p>シンタックス: <b>settings.stMethod.<i>Treenode</i>:= &lt;value&gt;</b></p>
<p>サンプル</p>
<dl>
<dd><b style="font-weight: bold;">settings.stMethod.Method:=2</b></dd>
<dd><b style="font-weight: bold;">settings.stMethod.ColFilter:=1</b></dd>
<dd><b style="font-weight: bold;">settings.stMethod.WksSpecified:=[Book1]Sheet2!</b></dd>
<dd><b style="font-weight: bold;">settings.stMethod.ColFrom:=1</b></dd>
<dd><b style="font-weight: bold;">settings.stMethod.ColTo:=2</b></dd>
<dd><b style="font-weight: bold;">settings.stMethod.Color:=1</b></dd>
</dl>
<table class="treetable">
<tr>
<th style="width: 4%;">ツリーノード</th>
<th style="width: 4%;">ラベル</th>
<th style="width: 4%;">データ型</th>
<th style="width: 4%;">デフォルト</th>
<th style="width: 32%;">説明</th>
</tr>
<tr>
<td>Method</td>
<td>出力方法</td>
<td>int</td>
<td>2</td>
<td>出力の方法を指定します。以下のオプションがあります。
<ul>
<li class="kadov-p">-2:条件に合致したセルをハイライトします。</li>
<li class="kadov-p">-1:条件に合致したセルをマスクします。</li>
<li class="kadov-p">0:条件が各行で合うかどうかを示す列を使います(1=true, 0=false)。</li>
<li class="kadov-p">1:新しいワークシートに抽出</li>
<li class="kadov-p">2:新しいワークブックに抽出</li>
<li class="kadov-p">3:指定したワークシートに抽出</li>
<li class="kadov-p">4:条件に合ったセルを指定した色で塗ります。</li>
</ul>
</td>
</tr>
<tr>
<td>ColFilter</td>
<td>列フィルタ</td>
<td>int</td>
<td>-1</td>
<td>これは、settings.stMethod.Method:=0のときのみ有効です。この変数を使って、フィット結果を出力する列を指定できます。(0=false, 1=true).列のインデックスは0から開始します。"-1"が使われる場合、新しい列が元の列に追加され、フィルタリングした結果を出力するのに使用されます。</td>
</tr>
<tr>
<td>WksSpecified</td>
<td>ワークシート</td>
<td>range</td>
<td>
<p>&#160;</p>
</td>
<td>これは、settings.stMethod.Method:=1のときのみ有効です。抽出した行を出力するワークシートを指定するのに使われます。Xファンクションのoy変数が指定されると、WksSpecifiedが何であってもoyは出力範囲として使われます。</td>
</tr>
<tr>
<td>ColFrom</td>
<td>開始列</td>
<td>int</td>
<td>-1</td>
<td>これは、settings.stMethod.Method:=1 または 2 または 3のときのみ有効です。これは抽出データを出力する開始列を指定します。列のインデックスは0から開始します。Xファンクションのoy変数が指定されると、ColFromが何であってもoyは出力範囲として使われます。サンプル
<ul>
<li class="kadov-p">settings.stMethod.ColFrom:=0 //最初の列</li>
<li class="kadov-p">settings.stMethod.ColFrom:-1 //出力ワークシートの最初の空の列</li>
</ul>
</td>
</tr>
<tr>
<td>ColTo</td>
<td>終了列</td>
<td>int</td>
<td>-1</td>
<td>これは過剰パラメータです。使わないでください。</td>
</tr>
<tr>
<td>Color</td>
<td>色</td>
<td>int</td>
<td>1</td>
<td>これは、settings.stMethod.Method:=4のときのみ有効です。条件に合致したセルを塗りつぶす色のインデックスを (<a href="../../LabTalk/LabTalk/List_of_Colors.html" title="http://wiki.originlab.com/~originla/wiki/index.php?title=LabTalk:List_of_Colors" rel="nofollow">カラーリストで</a>)指定します。 列のインデックスは0から開始します。サンプル
<ul>
<li class="kadov-p">settings.stMethod.color:=0 //黒</li>
<li class="kadov-p">settings.stMethod.color:=1 //赤</li>
</ul>
</td>
</tr>
</table>
<a name="stRowRange" id="stRowRange"></a>
<h3><span class="mw-headline">stRowRange</span></h3>
<p><b style="font-weight: bold;">設定</b>ツリーの<b>stRowRange</b> ブランチは、抽出したデータから行範囲をを指定します。</p>
<p>シンタックス: <b>settings.stRowRange.<i>Treenode</i>:= &lt;value&gt;</b></p>
<p>例:</p>
<dl>
<dd><b style="font-weight: bold;">settings.stRowRange.RowFrom:=0</b></dd>
<dd><b style="font-weight: bold;">settings.stRowRange.RowTo:=10</b></dd>
</dl>
<table class="treetable">
<tr>
<th style="width: 4%;">ツリーノード</th>
<th style="width: 4%;">ラベル</th>
<th style="width: 4%;">データ型</th>
<th style="width: 4%;">デフォルト</th>
<th style="width: 32%;">説明</th>
</tr>
<tr>
<td>RowFrom</td>
<td>開始行</td>
<td>int</td>
<td>0</td>
<td>データを抽出するのに開始行を指定します。行のインデックスは0から開始します。サンプル
<ul>
<li class="kadov-p">settings.stRowRange.RowFrom:=0 //最初の行</li>
<li class="kadov-p">settings.stRowRange.RowFrom:=2: //3番目の行</li>
</ul>
</td>
</tr>
<tr>
<td>RowTo</td>
<td>終了行</td>
<td>int</td>
<td>-1</td>
<td>データを抽出するのに終了行を指定します。行のインデックスは0から開始します。例えば:
<ul>
<li class="kadov-p">settings.stRowRange.RowTo:=3 //4番目の行</li>
<li class="kadov-p">settings.stRowRange.RowTo:=-1 //最後の行</li>
</ul>
</td>
</tr>
</table>
