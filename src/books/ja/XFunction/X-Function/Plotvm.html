<h1 class="firstheading">plotvm</h1><div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Brief_Information"><span class="tocnumber">1</span><span class="toctext">概要</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Additional_Information"><span class="tocnumber">2</span> <span class="toctext">追加の情報</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Command_Line_Usage"><span class="tocnumber">3</span> <span class="toctext">コマンドラインでの使用法</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#X-Function_Execution_Options"><span class="tocnumber">4</span> <span class="toctext">Xファンクションの実行オプション</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Variables"><span class="tocnumber">5</span> <span class="toctext">変数</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Description"><span class="tocnumber">6</span> <span class="toctext">説明</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Example"><span class="tocnumber">7</span> <span class="toctext">サンプル</span></a></li>
</ul>
</div>

<h2><a name="Brief_Information"></a><span class="mw-headline">概要</span></h2>
<p>ワークシートセルの範囲から等高線図、イメージプロット、ヒートマップを作成
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">追加の情報</span></h2>
<p><b>必要なOriginのバージョン</b>: 8.5 SR0<br />
結果グラフを非表示にするオプションはバージョン9.0から利用できます。
vmname、coltype、rowtype変数はOrigin 2015で追加されています。
動的終了列/行をサポートするdendは、Origin 2018bから使用できます。
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">コマンドラインでの使用法</span></h2>
<p><code>
1. plotvm irng:=1!!5:dend;
</p><p>2. plotvm irng:=1! rowpos:=2 colpos:=2;
</p><p>3. plotvm irng:=1!2[3]:4[5] rowpos:=4 rowrng:=[1]:[1] colpos:=4 colrng:=1;
</p><p>4. plotvm irng:=1! ztitle:=&quot;VSurface 1&quot; type:=242 ogl:=[&lt;new template:=cmap&gt;];
</p><p>5. plotvm irng:=1! rowpos:=label label:=L rowtype:=T0 colpos:=selcol1 coltype:=D0 ogl:=&lt;new template:=heatmap&gt;;
</p><p>6. plotvm irng:=VM1; //仮想行列&quot;vm1&quot;を使用して等高線図を作成。
</p><p>7. plotvm irng:=1! rowpos:=2 colpos:=2 xtitle:=&lt;[&lt;%(%@H, 1, L)&gt;]&gt; ytitle:=&lt;[&lt;%(%@H, 1, U)&gt;]&gt; ztitle:=&lt;[&lt;%(%@H, 1, C)&gt;]&gt;;
</code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">Xファンクション実行オプション</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">スクリプトからXファンクションにアクセスする場合、追加のオプションスイッチについてのページを参照してください。</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">変数</span></h2>
<table class="xfvar">
<tr>
<th width="8%">表示<br />名
</th>
<th width="8%">変数<br />名
</th>
<th width="8%">I/O<br />と<br />データ型
</th>
<th width="8%">デフォルト<br />値
</th>
<th>説明
</th></tr>
<tr>
<td>入力
</td>
<td>irng
</td>
<td>
<p>入力
</p><p>Range
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td>
<p>プロットするZ値または既存の仮想行列を指定します。<i>dend</i>を使用して、動的な終了列/行を指定できます。
</p>
</td></tr>
<tr>
<td>データフォーマット
</td>
<td>format
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>XおよびY値を設定する方法を指定します。
</p>
<dl><dd><ul><li> 0: 列を横断するY</li></ul></dd></dl>
<p>Y値として一行を使用し、X値として一列を使用します。
</p>
<dl><dd><ul><li> 1: 列を横断するX</li></ul></dd></dl>
<p>X値として一行を使用し、Y値として一列を使用します。
</p>
</td></tr>
<tr>
<td>X値/Y値
</td>
<td>rowpos
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>&lt;自動&gt;</center>
</td>
<td>
<p>Y（またはX)値の行を指定します。YまたはX値が指定されているかどうかは、<b>データフォーマット</b>の値で決まります。
</p><p>行のY（またはX）値は、降順または昇順にする必要があります。
</p>
<dl><dd><ul><li> 0: なし</li></ul>
<dl><dd> Y値としてワークシートセルの選択範囲の列番号（開始は1）を使用します。</dd></dl>
<ul><li> 1: 選択中の第1行</li></ul>
<dl><dd> 選択中の最初の行をY（またはX）値として使用します。</dd></dl>
<ul><li> 2: ワークシート中の第1行</li></ul>
<dl><dd> ワークシートの最初の行をY（またはX）値として使用します。<b>irng</b>でワークシートの範囲のみ指定した場合は、ワークシートの最初の行の対応する部分のみが Y(または X) 値として使用されることに注意してください。</dd></dl>
<ul><li> 3: 列ラベル</li></ul>
<dl><dd> ワークシートの列ラベル行をY（またはX）値として使用します。列ラベル行は<b>label</b>で指定します。ワークシートの部分範囲だけが<b>irng</b>で指定されていると、ワークシートの列ラベル行に対応している部分だけがY（またはX）値として使用されます。</dd></dl>
<ul><li> 4: カスタム</li></ul>
<dl><dd> ワークシート内の行を指定します。</dd></dl></dd></dl>
</td></tr>
<tr>
<td>Y範囲
</td>
<td>rowrng
</td>
<td>
<p>入力
</p><p>Range
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td>
<dl><dd>Y（またはX）値の行を指定します。<b>rowpos</b>が4の時のみ<b>rowrng</b>が指定されます。</dd>
<dd><b>rowng</b> は<b>irng</b>の同じワークシートに含まれている必要があります。</dd></dl>
</td></tr>
<tr>
<td>列ラベル
</td>
<td>label
</td>
<td>
<p>入力
</p><p>string
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td>
<p>X(もしくはY)値として使用する列ラベル行の文字列を指定します。<b>label</b>は<b>rowpos</b>が3に設定されているときのみ指定する必要があります。
</p>
<dl><dd><ul><li>&quot;Long Name&quot;{L}:ロングネーム
<dl><dd>Y（またはX）値としてロングネーム行を使用します。</dd></dl></li>
<li>&quot;Units&quot;{U}:単位
<dl><dd>Y（またはX）値として単位行を使用します。</dd></dl></li>
<li>&quot;Comments&quot;{C}:コメント
<dl><dd>Y（またはX）値としてコメント行を使用します。</dd></dl></li>
<li>&lt;custom&gt;:パラメータ1
<dl><dd>Y（またはX）値としてパラメータ1行を使用します。</dd></dl></li></ul></dd></dl>
<p>Note: スクリプトでは、列ラベル行を指定する一文字を使用します。各列ラベル行を示す文字については<a class="external text" href="../../LabTalk/LabTalk/Column_Label_Row_Characters.html">Column Label Row Characters</a>を参照してください。
</p>
</td></tr>
<tr>
<td>Y/Xのフォーマット
</td>
<td>rowtype
</td>
<td>
<p>入力
</p><p>string
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td>
<p>X/Yデータの表示形式を指定します。この変数は、<b>rowpos</b>変数が 0 (なし) に設定されていない場合にのみアクセスできます。詳細は、サポートされる<a class="external text" href="../../UserGuide/UserGuide/Numbers_in_Origin.html#Custom_Display_Format">Originフォーマット表記</a>をご覧ください。
</p>
</td></tr>
<tr>
<td>X値/Y値
</td>
<td>colpos
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>&lt;自動&gt;</center>
</td>
<td>
<p>X（またはY）値の列を指定します。XまたはY値が指定されているかどうかは、<b>データフォーマット</b>の値で決まります。
</p><p>列内では、X（またはY）値は、昇順か降順である必要があります。
</p>
<dl><dd><ul><li> 0: なし</li></ul>
<dl><dd> X（またはY）値としてワークシートセルの選択範囲の行番号（開始は1）を使用します。</dd></dl>
<ul><li> 1: 選択中の第1列</li></ul>
<dl><dd> 選択中の最初の列をX（またはY）値として使用します。</dd></dl>
<ul><li> 2: ワークシート中の第1列</li></ul>
<dl><dd> ワークシート中の最初の列をX（またはY）値として使用します。ワークシートの部分範囲が<b>irng</b>で指定されていると、ワークシートの最初の列に対応している部分だけがY（またはX）値として使用されます。</dd></dl>
<ul><li> 3: 選択の左にあるX列</li></ul>
<dl><dd> <b>irng</b>の範囲の左側のから一番近いX列をX (または Y) 値として使用します。<b>irng</b> の範囲の左側にX列が1つ以上ある場合にのみ指定できます。</dd></dl>
<ul><li> 4: カスタム</li></ul>
<dl><dd> ワークシート内の列を指定します。</dd></dl></dd></dl>
</td></tr>
<tr>
<td>X範囲
</td>
<td>colrng
</td>
<td>
<p>入力
</p><p>Range
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td>
<dl><dd>X(もしくはY)値の列を指定します。<b>colrng</b>は<b>colpos</b>が<b>4</b>に設定されているときのみ指定する必要があります。</dd>
<dd><b>colrng</b>は<b>irng</b>の同じワークシート内にある必要があります。</dd></dl>
</td></tr>
<tr>
<td>X/Yデータフォーマット
</td>
<td>coltype
</td>
<td>
<p>入力
</p><p>string
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td>
<p>X/Yデータの表示形式を指定します。この変数は、<b>colpos</b>変数が 0 (なし) に設定されていない場合にのみアクセスできます。詳細は、サポートされる<a class="external text" href="../../UserGuide/UserGuide/Numbers_in_Origin.html#Custom_Display_Format">Originフォーマット表記</a>をご覧ください。
</p>
</td></tr>
<tr>
<td>Xタイトル
</td>
<td>xtitle
</td>
<td>
<p>入力
</p><p>string
</p>
</td>
<td> <center>Xタイトル</center>
</td>
<td>
<p>X軸タイトルを指定します。 
</p>
<dl><dd><ul><li> ロングネームと単位: <i>&lt;[&lt;%(%@H, 1, LG)&gt;]&gt;</i></li>
<li> ロングネーム: <i>&lt;[&lt;%(%@H, 1, L)&gt;]&gt;</i></li>
<li> 単位: <i>&lt;[&lt;%(%@H, 1, U)&gt;]&gt;</i></li>
<li> コメント: <i>&lt;[&lt;%(%@H, 1, C)&gt;]&gt;</i></li>
<li> 第一パラメータ: <i>&lt;[&lt;%(%@H, 1, P1)&gt;]&gt;</i></li>
<li> 第一ユーザパラメータ: <i>&lt;[&lt;%(%@H, 1, D1)&gt;]&gt;</i></li>
<li> 第一ユーザパラメータ名: <i>&lt;[&lt;%(%@H, @LH1)&gt;]&gt;</i></li>
<li> シート名: <i>&lt;[&lt;%(%@H, @SN)&gt;]&gt;</i></li>
<li> ブックロングネーム: <i>&lt;[&lt;%(%@H, @PNL)&gt;]&gt;</i></li>
<li> ユーザーカスタム </li></ul></dd></dl>
</td></tr>
<tr>
<td>Yタイトル
</td>
<td>ytitle
</td>
<td>
<p>入力
</p><p>string
</p>
</td>
<td> <center>Yタイトル</center>
</td>
<td>
<p>Y 軸タイトルを指定します。
</p>
<dl><dd><ul><li> ロングネームと単位: <i>&lt;[&lt;%(%@H, 1, LG)&gt;]&gt;</i></li>
<li> ロングネーム: <i>&lt;[&lt;%(%@H, 1, L)&gt;]&gt;</i></li>
<li> 単位: <i>&lt;[&lt;%(%@H, 1, U)&gt;]&gt;</i></li>
<li> コメント: <i>&lt;[&lt;%(%@H, 1, C)&gt;]&gt;</i></li>
<li> 第一パラメータ: <i>&lt;[&lt;%(%@H, 1, P1)&gt;]&gt;</i></li>
<li> 第一ユーザパラメータ: <i>&lt;[&lt;%(%@H, 1, D1)&gt;]&gt;</i></li>
<li> 第一ユーザパラメータ名: <i>&lt;[&lt;%(%@H, @LH1)&gt;]&gt;</i></li>
<li> シート名: <i>&lt;[&lt;%(%@H, @SN)&gt;]&gt;</i></li>
<li> ブックロングネーム: <i>&lt;[&lt;%(%@H, @PNL)&gt;]&gt;</i></li>
<li> ユーザーカスタム </li></ul></dd></dl>
</td></tr>
<tr>
<td>Zタイトル
</td>
<td>ztitle
</td>
<td>
<p>入力
</p><p>string
</p>
</td>
<td> <center>Zタイトル</center>
</td>
<td>
<p>Z 軸タイトルを指定します。
</p>
<dl><dd><ul><li> ロングネームと単位: <i>&lt;[&lt;%(%@H, 1, LG)&gt;]&gt;</i></li>
<li> ロングネーム: <i>&lt;[&lt;%(%@H, 1, L)&gt;]&gt;</i></li>
<li> 単位: <i>&lt;[&lt;%(%@H, 1, U)&gt;]&gt;</i></li>
<li> コメント: <i>&lt;[&lt;%(%@H, 1, C)&gt;]&gt;</i></li>
<li> 第一パラメータ: <i>&lt;[&lt;%(%@H, 1, P1)&gt;]&gt;</i></li>
<li> 第一ユーザパラメータ: <i>&lt;[&lt;%(%@H, 1, D1)&gt;]&gt;</i></li>
<li> 第一ユーザパラメータ名: <i>&lt;[&lt;%(%@H, @LH1)&gt;]&gt;</i></li>
<li> シート名: <i>&lt;[&lt;%(%@H, @SN)&gt;]&gt;</i></li>
<li> ブックロングネーム: <i>&lt;[&lt;%(%@H, @PNL)&gt;]&gt;</i></li>
<li> ユーザーカスタム </li></ul></dd></dl>
</td></tr>
<tr>
<td>仮想行列名
</td>
<td>vmname
</td>
<td>
<p>入力
</p><p>string
</p>
</td>
<td> <center>VM1</center>
</td>
<td>
<p>仮想行列の名前を指定します。
</p>
</td></tr>
<tr>
<td>プロットタイプ
</td>
<td>type
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>226</center>
</td>
<td>
<p>3Dまたは等高線グラフのプロットタイプを指定します。
</p><p>プロットタイプの詳細については、<a class="external text" href="../../LabTalk/LabTalk/Worksheet_(command).html#-p.3B_Plot_the_current_worksheet_selection_in_the_nth_graph_type_into_the_template">LabTalkのプロットタイプ</a>を参照してください。
</p>
</td></tr>
<tr>
<td>新しく作成したグラフを非表示
</td>
<td>hide
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>新しく作成したグラフを非表示にするかどうかを指定します。このオプションはダイアログでは非表示です。Labtalkスクリプトを使うばあいのみ値を割り当てることができます。
</p>
</td></tr>
<tr>
<td>
</td>
<td>ogl
</td>
<td>
<p>出力
</p><p>グラフレイヤ
</p>
</td>
<td> <center>[&lt;new template:=contour&gt;]</center>
</td>
<td>
<p>プロットを追加するグラフレイヤを指定します。
<a class="external text" href="../../XFunction/X-Function/Output_Notations.html">このシンタックス</a>を参照してください。
</p>
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">説明</span></h2>
<p>このXファンクションは、ワークシート内のセル範囲を仮想行列として3Dグラフまたは等高線図を作図します。Y（またはX）値を定義するためのいくつかのオプションを利用できます。
</p><p><b>plotvm</b>では、3Dグラフまたは等高線図をプロットするためのxまたはy値の間隔が不均一でも作図可能です。
</p><p>Originメニューでの<b>plotvm</b>ダイアログの使用についての詳細は、 <a class="external text" href="../../UserGuide/UserGuide/Creating_3D_and_Contour_Graphs_from_Virtual_Matrix.html">仮想行列から3Dおよび等高線グラフを作成する</a>をご覧ください。
</p>
<h2><a name="Example"></a><span class="mw-headline">サンプル</span></h2>
<p>次のスクリプトは、Xファンクション<b>plotvm</b> を使用して、最初の行にY値、最初の列にX値をもつワークシートから等高線図を作図します。
</p>
<pre class="lt" style="font-family:monospace;">impASC fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span><span style="color: #000080;">+</span><span style="color: #ff00ff;">&quot;Samples\Graphing\VSurface 1.dat&quot;</span>;
plotvm irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span> rowpos<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span> colpos<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>;</pre>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>仮想行列</span></p>







    