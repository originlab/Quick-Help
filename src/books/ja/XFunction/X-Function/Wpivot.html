<h1 class="firstheading">wpivot</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">メニュー情報</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">概要</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Additional_Information"><span class="tocnumber">3</span> <span class="toctext">追加の情報</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Command_Line_Usage"><span class="tocnumber">4</span><span class="toctext">コマンドラインでの使用法</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#X-Function_Execution_Options"><span class="tocnumber">5</span> <span class="toctext">Xファンクションの実行オプション</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Variables"><span class="tocnumber">6</span> <span class="toctext">変数</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Description"><span class="tocnumber">7</span> <span class="toctext">説明</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Examples"><span class="tocnumber">8</span> <span class="toctext">サンプル</span></a></li>
</ul>
</div>

<h2><a name="Menu_Information"></a><span class="mw-headline">メニュー情報</span></h2>
<p>データ整形：ピボットテーブル
</p>
<h2><a name="Brief_Information"></a><span class="mw-headline">概要</span></h2>
<p>ピボットテーブルを作成してデータを要約します
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">追加の情報</span></h2>
<p class="version" >必要なOriginのバージョン:Origin 2015 SR0以降 </p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">コマンドラインでの使用法</span></h2>
<p><code>
wpivot row:=col(4) col:=col(6) data:=col(11) method:=sum total:=1 sort_total:=descend sum:=1;
</p><p>wpivot row:=(col(4):col(5)) col:=col(8) data:=col(9) method:=sum total:=1 sort_total:=no sum:=1 sort_col:=des;
</p><p>wpivot row:=(col(4),col(6)) col:=col(8) method:=count dir:=col vmode:=limitValTotal threshold:=3;
</code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">Xファンクションの実行オプション</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">スクリプトからXファンクションにアクセスする場合、追加のオプションスイッチについてのページを参照してください。</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">変数</span></h2>
<table class="xfvar">
<tr>
<th width="8%">表示<br />名
</th>
<th width="8%">変数<br />名
</th>
<th width="8%">I/O<br />と<br />データ型
</th>
<th width="8%">デフォルト<br />値
</th>
<th>説明
</th></tr>
<tr>
<td>ピボットテーブルの行ソース
</td>
<td>row
</td>
<td>
<p>入力
</p><p>Range
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> ピボットテーブルの行ソースとして使用される範囲を指定します。選択した範囲のそれぞれの明確な値は、ピボットテーブルの行に対応しています。例えば、表の行ソースに5つのセルがあり、その値が&quot;East&quot;, &quot;South&quot;, &quot;West&quot;, &quot;South&quot; , &quot;East&quot;の場合、ピボットテーブルは3行になります。この分析を行うには、行ソース用に少なくとも1列をアクティブにするか指定する必要があります。
<p>一般的なオプションが以下の3つあります。
</p>
<ul><li> col(1)
<dl><dd> 行ソースとして列1を選択します。</dd></dl></li>
<li> (col(1):col(3))
<dl><dd> 行ソースとして列1から列3を選択します。</dd></dl></li>
<li> (col(1), col(3))
<dl><dd> 行ソースとして列1と列3の2列を選択します。</dd></dl></li></ul>
</td></tr>
<tr>
<td>ピボットテーブルの列ソース
</td>
<td>col
</td>
<td>
<p>入力
</p><p>Range
</p>
</td>
<td> <center></center>
</td>
<td> ピボットテーブルの列ソースとして使用される範囲を指定します。選択した範囲のそれぞれの明確な値は、ピボットテーブルの列に対応しています。この分析を行うには、列ソースのために少なくとも1列を指定する必要があります。オプションのシンタックスは、ピボットテーブルの行ソースと同じです。
</td></tr>
<tr>
<td>ピボットテーブルのデータソース
</td>
<td>data
</td>
<td>
<p>入力
</p><p>Range
</p>
</td>
<td> <center></center>
</td>
<td> これは<b>サマリー出力タイプ</b>で<b>カウント</b>が選択されて<b>いない</b>場合にのみ有効です(Method 変数)。サマリーデータ値が提供されます。
</td></tr>
<tr>
<td>サマリー出力タイプ
</td>
<td>method
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> データを要約する方法を指定します。
<p>オプションリスト：
</p>
<ul><li><i>count:カウント</i> {0}
<dl><dd>各行/列の組み合わせのカウントを出力します。 </dd></dl></li></ul>
<dl><dd></dd></dl>
<ul><li><i>sum:合計</i> {1}
<dl><dd>各行/列の組み合わせの合計を出力します。 </dd></dl></li></ul>
<dl><dd></dd></dl>
<ul><li><i>mean:平均</i> {2}
<dl><dd>各行/列の組み合わせの平均を出力します。</dd></dl></li>
<li><i>min:最小</i> {3}
<dl><dd>各行/列の組み合わせの最小値を出力します。</dd></dl></li>
<li><i>max:最大</i> {4}
<dl><dd>各行/列の組み合わせの最大値を出力します。 </dd></dl></li></ul>
<dl><dd></dd></dl>
</td></tr>
<tr>
<td>方向の統合
</td>
<td>dir
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> この変数は、小さい値のカウント/合計/平均/最小/最大を「その他」の列/行にまとめるか決定します。
<p><br />
オプションリスト：
</p>
<ul><li><i>none:なし</i> {0}
<dl><dd>どの値もまとめません。</dd></dl></li>
<li><i>col:列</i> {1}
<dl><dd>小さな値の列をまとめます。 </dd></dl></li>
<li><i>row:行</i> {2}
<dl><dd>小さな値の行をまとめます。 </dd></dl></li></ul>
<dl><dd></dd></dl>
</td></tr>
<tr>
<td>モード
</td>
<td>vmode
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> 小さな値のまとめ方を指定します。このオプションは<i>dir</i>が列(1)または行(2)の時に利用できます。
<p><br />
オプションリスト：
</p>
<ul><li><i>perTotal:総和に対するパーセント{0}</i>
<dl><dd>合計値が<i>threshold </i>で指定した総和のしきい値パーセントより小さい列/行を統合します。 </dd></dl></li></ul>
<dl><dd></dd></dl>
<ul><li><i>perRefRow:参照行/列のパーセント{1}</i>
<dl><dd>値が<i>threshold</i> で指定した参照行/列(<i>refrow</i> )のしきい値パーセントより小さい列/行を統合します。</dd></dl></li></ul>
<dl><dd></dd></dl>
<ul><li><i>limitValTotal:総計の上位n{2}</i>
<dl><dd>合計値が上位N値の中に<b>ない</b>列/行を統合します。つまり、上位N値を表示し、他のすべてを統合します。</dd></dl></li></ul>
<dl><dd></dd></dl>
<ul><li><i>limitValRefRow:参照行/列の上位N件{3}</i>
<dl><dd>参照行/列の値が、上位N中に<b>ない</b>列/行を統合します。 </dd></dl></li></ul>
<dl><dd></dd></dl>
</td></tr>
<tr>
<td>参照行/列
</td>
<td>refrow
</td>
<td>
<p>入力
</p><p>string
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td> モードで<b>参照行/列のパーセント</b>または<b>参照行/列の上位N件</b>が選択されている時に、参照行/列を指定します。
</td></tr>
<tr>
<td>しきい値
</td>
<td>threshold
</td>
<td>
<p>入力
</p><p>double
</p>
</td>
<td> <center></center>
</td>
<td> <b>総和に対するパーセント</b>または<b>参照行/列のパーセント</b>が選択されている時に、より小さな値をまとめるパーセントまたは数を指定します。
</td></tr>
<tr>
<td>値のラベル
</td>
<td>label
</td>
<td>
<p>入力
</p><p>string
</p>
</td>
<td> <center>その他</center>
</td>
<td> より小さな値の列/行の統合で形成される列/行のラベルを指定します。
</td></tr>
<tr>
<td>行合計の列追加
</td>
<td>total
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> <b>行合計</b>の列を追加するか指定します。この列の各セルは同じ行にデータの合計を含みます。
</td></tr>
<tr>
<td>合計列のソート
</td>
<td>sort_total
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> ピボットテーブルで行をソートする手法を指定します。
<p>オプションリスト：
</p>
<ul><li><i>no:行ラベルの昇順{0}</i>
<dl><dd>行ラベルに従って、行を昇順でソートします。 </dd></dl></li></ul>
<dl><dd></dd></dl>
<ul><li><i>descend:行合計による降順{1}</i>
<dl><dd>行合計を降順でソートします。 </dd></dl></li></ul>
<dl><dd></dd></dl>
<ul><li><i>ascend:行合計による昇順{2}</i>
<dl><dd>行合計を昇順でソートします。 </dd></dl></li></ul>
<dl><dd></dd></dl>
<ul><li><i>ldescend:行ラベルの降順{3}</i>
<dl><dd>行ラベルに従って、行を降順でソートします。 </dd></dl></li></ul>
<dl><dd></dd></dl>
<ul><li><i>none:なし{4}</i>
<dl><dd>行をソートしません。 </dd></dl></li></ul>
</td></tr>
<tr>
<td>列合計の行追加
</td>
<td>sum
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> <b>列合計</b>の行を追加するか指定します。この行の各セルは同じ列にデータの合計を含みます。
</td></tr>
<tr>
<td>出力列のソート
</td>
<td>sort_col
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> ピボットテーブルで列をソートする手法を指定します。
<p>オプションリスト：
</p>
<ul><li><i>lasc:列ラベルの昇順{0}</i>
<dl><dd>列ベルに従って、列を昇順でソートします。 </dd></dl></li></ul>
<dl><dd></dd></dl>
<ul><li><i>ldes:列ラベルの降順{1}</i>
<dl><dd>列ベルに従って、列を降順でソートします。 </dd></dl></li>
<li><i>asc:列合計による昇順{2}</i>
<dl><dd><b>列合計</b>を昇順でソートします。 </dd></dl></li></ul>
<dl><dd></dd></dl>
<ul><li><i>des:列合計による降順{3}</i>
<dl><dd><b>列合計</b>を降順でソートします。 </dd></dl></li></ul>
<dl><dd></dd></dl>
<ul><li><i>no:なし{4}</i>
<dl><dd>列をソートしません。</dd></dl></li></ul>
</td></tr>
<tr>
<td>列の合計を正規化
</td>
<td>normalize
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> <b>列の合計</b>で出力データを正規化するかどうかを指定します。
<p>オプションリスト：
</p>
<ul><li><i>no:なし{0}</i>
<dl><dd>データを正規化しません。</dd></dl></li>
<li><i>frac:小数{1}</i>
<dl><dd>列合計によって各列のデータを正規化し、率表記でレポートします。 </dd></dl></li></ul>
<dl><dd></dd></dl>
<ul><li><i>perc:パーセント{2}</i>
<dl><dd>列合計によって各列のデータを正規化し、パーセント表記でレポートします。 </dd></dl></li></ul>
<dl><dd></dd></dl>
</td></tr>
<tr>
<td>空白時ゼロを表示
</td>
<td>zero
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> ピボットテーブルの欠損値を0で表示するかどうかを指定します。
</td></tr>
<tr>
<td>行ソースの追加値
</td>
<td>exrow
</td>
<td>
<p>入力
</p><p>string
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td>&apos; 文字。これは、標準レポートにしなければならない場合に役立ちますが、データには値が入りません。
</td></tr>
<tr>
<td>列ソースの追加値
</td>
<td>excol
</td>
<td>
<p>入力
</p><p>string
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td>&apos; 文字。これは、標準レポートにしなければならない場合に役立ちますが、データには値が入りません。
</td></tr>
<tr>
<td>列情報を加える
</td>
<td>pos
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> ピボットテーブルに列ソースの情報を出力するか指定します。
<p>オプションリスト
</p>
<ul><li><i>name:ロングネーム{0}</i>
<dl><dd>ロングネーム行にソース情報を出力します。</dd></dl></li>
<li><i>comments:コメント{1}</i>
<dl><dd> コメント行にソース情報を出力します。</dd></dl></li>
<li><i>append:列のロングネームに追加する{2}</i>
<dl><dd> 現在の列のロングネームにソース情報を追加します。 </dd></dl></li>
<li><i>udl:ユーザ定義パラメータ{3}</i>
<dl><dd> ユーザ定義パラメータ行にソース情報を出力します。この項目を選択すると、<b>列ラベル行</b>に表示される &quot;ユーザ定義のパラメータ&quot;の文字を置き換えるドロップダウンリストで識別情報を指定することができます。</dd></dl></li></ul>
</td></tr>
<tr>
<td>列から
</td>
<td>udlabel
</td>
<td>
<p>入力 
</p><p>string
</p>
</td>
<td>&lt;unassigned&gt;
</td>
<td>
<p>ピボットテーブル列ラベル行の識別子を指定します。pos:=3 または udl のとき利用できます。
オプションリスト：
</p>
<ul><li><i>G: ショートネーム</i></li>
<li><i>L: ロングネーム</i></li>
<li><i>C: コメント</i></li>
<li><i>U: 単位</i></li>
<li><i>&lt;カスタム&gt;</i></li></ul>
<p>&lt;カスタム&gt; は、ユーザ定義パラメータ名を示します。
</p>
</td></tr>

<tr>
<td>結果テーブルの出力先
</td>
<td>rd
</td>
<td>
<p>出力
</p><p>ReportData
</p>
</td>
<td> <center>[&lt;入力&gt;]&lt;新規&gt;</center>
</td>
<td>結果テーブルを出力する場所を指定します。
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">説明</span></h2>
<p>このXファンクションは、2つ以上の列を指定してピボットテーブルを作成し、3番目の列の統計量を含む多くのオプションによってデータのサマリーを視覚化します。
</p>
<h2><a name="Examples"></a><span class="mw-headline">サンプル</span></h2>
<p>詳細なサンプルは、<a class="external text" href="../../Tutorial/Tutorial/Pivot_Table.html">ピボットテーブルのチュートリアル</a>ページをご覧ください。
</p>






    