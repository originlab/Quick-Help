<h1 class="firstheading">mreplace</h1>
<table id="toc" class="toc" summary="Contents">
<tr>
<td>
<div id="toctitle">
<h2>内容</h2>
</div>
<ol>
<li class="kadov-p"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">メニュー情報</span></a></li>
<li class="kadov-p"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">概要</span></a></li>
<li class="kadov-p"><a href="#Command_Line_Usage"><span class="tocnumber">3</span> <span class="toctext">コマンドラインでの使用法</span></a></li>
<li class="kadov-p"><a href="#Variables"><span class="tocnumber">4</span> <span class="toctext">変数</span></a></li>
<li class="kadov-p"><a href="#Description"><span class="tocnumber">5</span> <span class="toctext">説明</span></a></li>
<li class="kadov-p"><a href="#Examples"><span class="tocnumber">6</span> <span class="toctext">サンプル</span></a></li>
<li class="kadov-p"><a href="#Related_X-Functions"><span class="tocnumber">7</span> <span class="toctext">関連のXファンクション</span></a></li>
</ol>
</td>
</tr>
</table>
<a name="Menu_Information" id="Menu_Information"></a>
<h2><span class="mw-headline">メニュー情報</span></h2>
<p>行列の置換</p>
<a name="Brief_Information" id="Brief_Information"></a>
<h2><span class="mw-headline">概要</span></h2>
<p>指定したデータでアクティブ行列のセルを置き換えます。</p>
<a name="Command_Line_Usage" id="Command_Line_Usage"></a>
<h2><span class="mw-headline">コマンドラインでの使用法</span></h2>
<p>&#160;</p>
<ol>
<li class="kadov-p">mreplace cond:=eq find:=1.3 abs_error:=0.1 replace:=13 use_abs:=1 keep_sign:=1</li>
<li class="kadov-p">mreplace cond:=ne find:=1.1 set_missing:=1 replace:=0</li>
</ol>
<p>&#160;</p>
<a name="Variables" id="Variables"></a>
<h2><span class="mw-headline">変数</span></h2>
<table class="xfvar">
<tr>
<th style="width: 8%;">表示<br />
名</th>
<th style="width: 8%;">変数<br />
名</th>
<th style="width: 8%;">I/O<br />
と<br />
データ型</th>
<th style="width: 8%;">デフォルト<br />
値</th>
<th>説明</th>
</tr>
<tr>
<td>行列オブジェクト</td>
<td>im</td>
<td>
<p>入力/出力</p>
<p>MatrixObject</p>
</td>
<td>
<p style="text-align: center;">&lt;active&gt;</p>
</td>
<td>入力行列を指定します。</td>
</tr>
<tr>
<td>条件</td>
<td>cond</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">0</p>
</td>
<td><b style="font-weight: bold;">検索対象</b>の値とこのリスト内で選択した演算子を組合せて、置き換える値を見つけるのに使用します。
<p>オプションリスト:</p>
<ul>
<li class="kadov-p"><i style="font-style: italic;">eq:Cell(i,j)=</i>
<dl>
<dd><i style="font-style: italic;">検索対象</i>の値と等しいデータを探します。</dd>
</dl>
</li>
<li class="kadov-p"><i style="font-style: italic;">lt:Cell(i,j)&lt;</i>
<dl>
<dd><i style="font-style: italic;">検索対象</i>の値より小さいデータを探します。</dd>
</dl>
</li>
<li class="kadov-p"><i style="font-style: italic;">le:Cell(i,j)&lt;=</i>
<dl>
<dd><i style="font-style: italic;">検索対象</i>の値以上のデータを探します。</dd>
</dl>
</li>
<li class="kadov-p"><i style="font-style: italic;">gt:Cell(i,j)&gt;</i>
<dl>
<dd><i style="font-style: italic;">検索対象</i>の値より大きいデータを探します。</dd>
</dl>
</li>
<li class="kadov-p"><i style="font-style: italic;">ge:Cell(i,j)&gt;=</i>
<dl>
<dd><i style="font-style: italic;">検索対象</i>の値以下のデータを探します。</dd>
</dl>
</li>
<li class="kadov-p"><i style="font-style: italic;">ne:Cell(i,j)&lt;&gt;</i>
<dl>
<dd><i style="font-style: italic;">検索対象</i>の値と等しくないデータを探します。</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr>
<td>検索対象 (欠損値は-- で指定)</td>
<td>find</td>
<td>
<p>入力</p>
<p>double</p>
</td>
<td>
<p style="text-align: center;">&lt;unassigned&gt;</p>
</td>
<td><b style="font-weight: bold;">条件</b>で選択した演算子と組み合わせて、この変数の値を条件として使用し、置き換える値を探します。欠損値を探すために、ここに"--" と入力できます。</td>
</tr>
<tr>
<td>置き換え</td>
<td>replace</td>
<td>
<p>入力</p>
<p>double</p>
</td>
<td>
<p style="text-align: center;">&lt;unassigned&gt;</p>
</td>
<td>見つかったセルすべてに対して、置き換える新しい値を指定します。</td>
</tr>
<tr>
<td>絶対誤差</td>
<td>abs_error</td>
<td>
<p>入力</p>
<p>double</p>
</td>
<td>
<p style="text-align: center;">0.01</p>
</td>
<td>置き換える行列データを探すのに使用される許容値を指定します。2つの値の間の差の絶対値が許容値より小さい場合、2つの値は等しい値と見なされます。これは、<b>条件</b>が <b>&gt;</b> または <b>&lt;</b> または <b>&lt;&gt;</b>の場合、利用できません。</td>
</tr>
<tr>
<td>条件に絶対値を使用</td>
<td>use_abs</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">0</p>
</td>
<td>与えられた条件に対してワークシートデータの絶対値を使うかどうかを指定します。</td>
</tr>
<tr>
<td>条件が真の場合符号を維持</td>
<td>keep_sign</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">0</p>
</td>
<td>条件が真で、行列データを置き換える場合、元の値の符号を維持するかどうかを指定します。</td>
</tr>
<tr>
<td>条件が偽の場合欠損値として設定</td>
<td>set_missing</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">0</p>
</td>
<td>セル内の値が条件に合わないときに、そのセルに欠損値を割り当てるかどうかを指定します。</td>
</tr>
<tr>
<td>検索位置</td>
<td>lookin</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">7</p>
</td>
<td>検索および置換の対象を指定します。
<p>オプションリスト:</p>
<ul>
<li class="kadov-p"><i style="font-style: italic;">active_object:現行列オブジェクト</i>
<dl>
<dd>アクティブな行列オブジェクト</dd>
</dl>
</li>
<li class="kadov-p"><i style="font-style: italic;">active_sheet:現行列シート</i>
<dl>
<dd>アクティブな行列シート</dd>
</dl>
</li>
<li class="kadov-p"><i style="font-style: italic;">active_book:現行列ブック</i>
<dl>
<dd>アクティブな行列ブック</dd>
</dl>
</li>
<li class="kadov-p"><i style="font-style: italic;">all_in_active_folder:アクティブフォルダ内のすべての行列ブック</i>
<dl>
<dd>アクティブフォルダ内のすべての行列ブック(サブフォルダは含まれません)</dd>
</dl>
</li>
<li class="kadov-p"><i style="font-style: italic;">recursive_in_active_folder:アクティブフォルダ内のすべての行列ブック(再帰的)</i>
<dl>
<dd>アクティブフォルダとそのサブフォルダ内のすべての行列ブック</dd>
</dl>
</li>
<li class="kadov-p"><i style="font-style: italic;">open_in_active_folder:アクティブフォルダ内のすべての行列ブック(オープンなもの)</i>
<dl>
<dd>アクティブフォルダ内の非表示でないすべての行列ブック(サブフォルダは含まれません)</dd>
</dl>
</li>
<li class="kadov-p"><i style="font-style: italic;">all_in_project:プロジェクト内のすべての行列ブック</i>
<dl>
<dd>プロジェクト内のすべての行列ブック</dd>
</dl>
</li>
<li class="kadov-p"><i style="font-style: italic;">specified:指定した行列オブジェクト</i>
<dl>
<dd>指定した行列オブジェクト</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr>
<td>出力行列</td>
<td>om</td>
<td>
<p>出力</p>
<p>MatrixObject</p>
</td>
<td>
<p style="text-align: center;">&lt;input&gt;</p>
</td>
<td>出力行列の出力先を指定します。</td>
</tr>
</table>
<a name="Description" id="Description"></a>
<h2><span class="mw-headline">説明</span></h2>
<p>このXファンクションは、行列のセルのデータを検索し、置き換える機能があります。</p>
<a name="Examples" id="Examples"></a>
<h2><span class="mw-headline">サンプル</span></h2>
<p>このサンプルでは、アクティブな行列にある1000より小さい値を1000に置き換える方法を説明します。</p>
<ol>
<li class="kadov-p">新しいプロジェクトを作成します。そして、新しい行列を作成し、アクティブにします。</li>
<li class="kadov-p">&lt;Originインストールフォルダ&gt;\Samples\Graphing\3D Surface &amp; Contour.datファイルをインポートします。</li>
<li class="kadov-p">コマンドウィンドウに、 <code>mreplace -d;</code> と入力し、 <b>mreplace</b> ダイアログボックスを開きます。</li>
<li class="kadov-p"><b style="font-weight: bold;">条件</b> を <b>Cell(i,j)&lt;</b> とし、<b>検索対象</b> と <b>置き換え</b> に1000と入力します。 <b>出力行列</b> は <b>&lt;new&gt;</b>とします。その他の設定は、そのままにします。
<dl>
<dd><img src="../images/Mreplace/Mreplace_1.png" alt="" style="border: none;" width="571" height="376" border="0" /></dd>
</dl>
</li>
<li class="kadov-p"><b style="font-weight: bold;">OK</b> ボタンをクリックします。すると、1000より小さいすべての値が1000に置き換わります。</li>
</ol>
<a name="Related_X-Functions" id="Related_X-Functions"></a>
<h2><span class="mw-headline">関連のXファンクション</span></h2>
<p><a href="Wreplace.html" title="X-Function:Wreplace">wreplace</a></p>
