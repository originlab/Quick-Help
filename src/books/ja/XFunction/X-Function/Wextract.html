<h1 class="firstheading">wextract</h1>
<table id="toc" class="toc" summary="Contents">
<tr>
<td>
<div id="toctitle">
<h2>内容</h2>
</div>
<ol>
<li class="kadov-p"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">メニュー情報</span></a></li>
<li class="kadov-p"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">概要</span></a></li>
<li class="kadov-p"><a href="#Command_Line_Usage"><span class="tocnumber">3</span> <span class="toctext">コマンドラインでの使用法</span></a></li>
<li class="kadov-p"><a href="#Variables"><span class="tocnumber">4</span> <span class="toctext">変数</span></a></li>
<li class="kadov-p"><a href="#Description"><span class="tocnumber">5</span> <span class="toctext">説明</span></a></li>
<li class="kadov-p"><a href="#Examples"><span class="tocnumber">6</span> <span class="toctext">サンプル</span></a></li>
</ol>
</td>
</tr>
</table>
<a name="Menu_Information" id="Menu_Information"></a>
<h2><span class="mw-headline">メニュー情報</span></h2>
<p>ワークシートデータの抽出...</p>
<a name="Brief_Information" id="Brief_Information"></a>
<h2><span class="mw-headline">概要</span></h2>
<p>LabTalkの条件式を使ってアクティブワークシートの該当データをマスクあるいは抽出します。</p>
<a name="Command_Line_Usage" id="Command_Line_Usage"></a>
<h2><span class="mw-headline">コマンドラインでの使用法</span></h2>
<ol>
<li class="kadov-p"><code style="font-family: monospace;">wextract iy:=[Book1]Sheet1!col(A) settings.stAlias.Cols:=1 settings.stAlias.AliasNames:=A settings.stCondition.Condition:="A&lt;6" settings.Cols:=1;</code></li>
<li class="kadov-p"><code style="font-family: monospace;">wextract iy:=[USMetropolita]"US Metropolitan Area Population"!(1:end) settings.stAlias.Cols:="2|3" settings.stAlias.AliasNames:="S|D" settings.stCondition.Condition:="D&gt;500&amp;&amp;S&gt;1000" settings.stMethod.Method:=1 settings.Cols:="0|2|3";</code></li>
<li class="kadov-p"><code style="font-family: monospace;">wextract iy:=[Book1]Sheet1!col(A) settings.stAlias.Cols:=1 settings.stAlias.AliasNames:=A settings.stCondition.BeforeLoop:="j=1;" settings.stCondition.BeforeIfCondition:="if (i==col(B)[j]) {temp=col(A)[i];j=j+1;}" settings.stCondition.Condition:="A==temp" settings.Cols:=0;</code></li>
</ol>
<a name="Variables" id="Variables"></a>
<h2><span class="mw-headline">変数</span></h2>
<table class="xfvar">
<tr>
<th style="width: 8%;">表示<br />
名</th>
<th style="width: 8%;">変数<br />
名</th>
<th style="width: 8%;">I/O<br />
と<br />
データ型</th>
<th style="width: 8%;">デフォルト<br />
値</th>
<th>説明</th>
</tr>
<tr>
<td>入力</td>
<td>iy</td>
<td>
<p>入力</p>
<p>Range</p>
</td>
<td>
<p style="text-align: center;">&lt;active&gt;</p>
</td>
<td>入力範囲を指定します。</td>
</tr>
<tr>
<td>設定</td>
<td>settings</td>
<td>
<p>入力</p>
<p>TreeNode</p>
</td>
<td>
<p style="text-align: center;">&lt;unassigned&gt;</p>
</td>
<td>抽出設定を指定します。詳細は、 <a href="details_of_treenodes_in_export_worksheet.html" title="Xファンクション:Wextractツリーノードの詳細">こちらのページをご覧下さい</a></td>
</tr>
<tr>
<td>出力</td>
<td>oy</td>
<td>
<p>出力</p>
<p>Range</p>
</td>
<td>
<p style="text-align: center;">&lt;optional&gt;</p>
</td>
<td>出力範囲を指定します。</td>
</tr>
</table>
<a name="Description" id="Description"></a>
<h2><span class="mw-headline">説明</span></h2>
<p>この機能はつまり<a href="../../UserGuide/UserGuide/Extract_Worksheet_Data.html" title="http://docwiki.originlab.com/index.php?title=UserGuide:Extract_Worksheet_Data" rel="nofollow"><b>ワークシートデータの抽出</b>機能</a>のスクリプトバージョンです。ユーザー指定条件式に基づき、指定したワークシートのデータを置くようにします。見つかったデータ値が抽出されます。これらの値は、他のワークシートにコピーしたり指定した色で見分けることができます。</p>
<p>設定変数は操作のオプションでカスタマイズすることができます。</p>
<a name="Examples" id="Examples"></a>
<h2><span class="mw-headline">サンプル</span></h2>
<p><b style="font-weight: bold;">サンプル1: 6よりも少ない列Aに対応するセルを列Bから抽出するには。</b></p>
<p>新しいワークブックを作成し、最初の列を行番号に、2番目の列を 2, 4, 6...(行番号の2倍) の数字で埋めます。.</p>
<p><a href=""><img alt="Image:XFunction_Wextract1.png" src="../images/Wextract/XFunction_Wextract1.png" title="Image:XFunction_Wextract1.png" width="249" height="286" border="0" /></a></p>
<p>コマンドウィンドウに次のスクリプトを入力します。</p>
<pre class="lt">
wextract iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span>Book1<span style="color: #000000;">]</span>Sheet1<span style="color: #000080;">!</span>col<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span> settings.<span style="color: #000080;">stAlias</span>.<span style="color: #000080;">Cols</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>
settings.<span style="color: #000080;">stAlias</span>.<span style="color: #000080;">AliasNames</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span>A
settings.<span style="color: #000080;">stCondition</span>.<span style="color: #000080;">Condition</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">"A&lt;6"</span>
settings.<span style="color: #000080;">Cols</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
</pre>
<p>列Bに抽出したデータは新しいワークブックに表示されます。</p>
<p><a href=""><img alt="Image:XFunction_Wextract2.png" src="../images/Wextract/XFunction_Wextract2.png" title="Image:XFunction_Wextract2.png" width="250" height="222" border="0" /></a></p>
<p><b style="font-weight: bold;">サンプル 2</b></p>
<p>メニューから「<b>ファイル：インポート：単一ASCII</b>」を選択します。ファイルをインポートします。 \Samples\Data Manipulation\Us Metropolitan Area Population.dat.インポート先のワークシートには場所は以下の4列が含まれています。: Population, Sq.Mi., Density, Metropolitan Area.Densityが100よりも大きいカリフォルニアの Metropolitan Areas を選択し、新しいシートにPopulation, Density, Metropolitan Area を出力します。以下のスクリプトをコマンドウィンドウに入力します。</p>
<pre class="lt">
str1<span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">"D&gt;100 AND M[i]$=="</span><span style="color: #000080;">*</span>, CA<span style="color: #000080;">*</span><span style="color: #ff00ff;">""</span>;
 
wextract iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span>USMetropolita<span style="color: #000000;">]</span><span style="color: #ff00ff;">"US Metropolitan Area Population"</span><span style="color: #000080;">!</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span>end<span style="color: #000000;">)</span>
settings.<span style="color: #000080;">stAlias</span>.<span style="color: #000080;">Cols</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">"3|4"</span>
settings.<span style="color: #000080;">stAlias</span>.<span style="color: #000080;">AliasNames</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">"D|M"</span>
settings.<span style="color: #000080;">stCondition</span>.<span style="color: #000080;">Condition</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span>str1<span style="color: #000080;">$</span>
settings.<span style="color: #000080;">stMethod</span>.<span style="color: #000080;">Method</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>
settings.<span style="color: #000080;">Cols</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">"0|2|3"</span>;
</pre>
<p>抽出結果はUSMetropolita ワークブックの新しいワークシートに表示されます。</p>
<p><a href=""><img alt="Image:XFunction_Wextract3.png" src="../images/Wextract/XFunction_Wextract3.png" title="Image:XFunction_Wextract3.png" width="445" height="349" border="0" /></a></p>
<p><b style="font-weight: bold;">サンプル 3: 列Aの行インデックスが列Bを含む列Aからデータを抽出するには。</b></p>
<p>新しいワークブックを作成します。列Aを選択します。右クリックして、ショートカットメニューから｢<b>列値の一律設定：正規乱数</b>｣を選択します。列B には 2, 3, 5と入力します。</p>
<p><a href=""><img alt="Image:XFunction_Wextract4.png" src="../images/Wextract/XFunction_Wextract4.png" title="Image:XFunction_Wextract4.png" width="254" height="322" border="0" /></a></p>
<p>ワークブックがアクティブになっていることを確認します。コマンドウィンドウに次のスクリプトを入力します。</p>
<pre class="lt">
wextract iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span>
settings.<span style="color: #000080;">stAlias</span>.<span style="color: #000080;">Cols</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>
settings.<span style="color: #000080;">stAlias</span>.<span style="color: #000080;">AliasNames</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span>A
settings.<span style="color: #000080;">stCondition</span>.<span style="color: #000080;">BeforeLoop</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">"j=1;"</span>
settings.<span style="color: #000080;">stCondition</span>.<span style="color: #000080;">BeforeIfCondition</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">"if (i==col(B)[j]) {temp=col(A)[i];j=j+1;}"</span>
settings.<span style="color: #000080;">stCondition</span>.<span style="color: #000080;">Condition</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">"A==temp"</span>
settings.<span style="color: #000080;">Cols</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;
</pre>
<p>列Aの2行目、3行目、5行目が新しいワークブックに抽出されます。</p>
<p><a href=""><img alt="Image:XFunction_Wextract5.png" src="../images/Wextract/XFunction_Wextract5.png" title="Image:XFunction_Wextract5.png" width="249" height="208" border="0" /></a></p>
