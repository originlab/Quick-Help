<h1 class="firstheading">averagexy</h1><table id="toc" class="toc" summary="Contents"><tr><td><div id="toctitle"><h2>内容</h2></div>
<ul>
<li class="toclevel-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">メニュー情報</span></a></li>
<li class="toclevel-1"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">概要</span></a></li>
<li class="toclevel-1"><a href="#Command_Line_Usage"><span class="tocnumber">3</span> <span class="toctext">コマンドラインでの使用法</span></a></li>
<li class="toclevel-1"><a href="#Variables"><span class="tocnumber">4</span> <span class="toctext">変数</span></a></li>
<li class="toclevel-1"><a href="#Description"><span class="tocnumber">5</span> <span class="toctext">説明</span></a></li>
<li class="toclevel-1"><a href="#Examples"><span class="tocnumber">6</span> <span class="toctext">サンプル</span></a></li>
<li class="toclevel-1"><a href="#Algorithm"><span class="tocnumber">7</span> <span class="toctext">アルゴリズム</span></a></li>
<li class="toclevel-1"><a href="#Related_X-Functions"><span class="tocnumber">8</span> <span class="toctext">関連のXファンクション</span></a></li>
</ul>
</td></tr></table>
<a name="Menu_Information"></a><h2> <span class="mw-headline"> メニュー情報 </span></h2>
<p>このXファンクションにはメニューはありません。プログラムからのみ呼び出せます。
</p>
<a name="Brief_Information"></a><h2> <span class="mw-headline"> 概要 </span></h2>
<p>複数の曲線またはXYデータを平均または連結します。
</p>
<a name="Command_Line_Usage"></a><h2> <span class="mw-headline"> コマンドラインでの使用法 </span></h2>
<p><code>
</p>
<ol><li>averagexy iy:=(Plot(1), Plot(2)) method:=concatenate x:=myX y:=myY;
</li><li>averagexy iy:=((1,2),(3, 4)) method:=ave avex:=common interp:=linear x:=5 y:=6;
</li></ol>
<p></code>
</p>
<a name="Variables"></a><h2> <span class="mw-headline"> 変数 </span></h2>
<table class="xfvar">
<tr>
<th width="8%">表示<br />名
</th><th width="8%">変数<br />名
</th><th width="8%">I/O<br />と<br />データ型
</th><th width="8%">デフォルト<br />値
</th><th>説明
</th></tr>
<tr>
<td>入力
</td><td>iy
</td><td>
<p>入力
</p><p>XYRange
</p>
</td><td> <center>&lt;active&gt;</center>
</td><td> 平均または連結する複数の曲線を指定します。
</td></tr>
<tr>
<td>手法
</td><td>method
</td><td>
<p>入力
</p><p>int
</p>
</td><td> <center>0</center>
</td><td> 平均法
<p>オプションリスト:
</p>
<ul><li><i>ave:Average</i>
<dl><dd>同じX値を統合し、それに対応するY値を平均して入力曲線を平均します。
</dd></dl>
</li><li><i>concatenate:Concatenate</i>
<dl><dd>入力の曲線を連結します。
</dd></dl>
</li></ul>
</td></tr>
<tr>
<td>平均化されたX
</td><td>avex
</td><td>
<p>入力
</p><p>int
</p>
</td><td> <center>2</center>
</td><td> これは、<b>手法</b>で<b>平均</b>が選択されている場合のみ利用できます。これは平均化した曲線のX値を決める手法を指定します。
<p>オプションリスト:
</p>
<ul><li><i>same:Same as Source X</i>
<dl><dd>すべての入力曲線のX値を平均化した曲線のXとして使います。tolerで指定した許容範囲にあるX値は、同じX値として扱われ、平均化されます。
</dd></dl>
</li><li><i>common:共通X範囲</i>
<dl><dd>すべてのデータセットの最大のX最小値から最小のX最大値までで、<i>npts</i> のXデータセットを作成し、interpの設定を使ってYを計算します。
</dd></dl>
</li><li><i>full:フルX範囲</i>
<dl><dd>すべてのデータセットの最小のX最小値から最大のX最大値までで、<i>npts</i> のXデータセットを作成し、interpの設定を使ってYを計算します。
</dd></dl>
</li><li><i>custom:カスタム</i>
<dl><dd> <b>xmin</b> から <b>xmax</b> の <i>npts</i> のXデータセットを作成し、<i>interp</i> 設定を使ってYを計算します。
</dd></dl>
</li><li><i>trace:曲線トレースに従う</i>
<dl><dd><a href="../../XFunction/X-Function/Interp1trace.html" title="http://wiki.originlab.com/~originla/wiki2/index.php?title=X-Function:Interp1trace" rel="nofollow">トレース補間</a>により平均曲線のX値を計算します。これは、入力曲線と同じ形状の新しい曲線を作成します。詳細は、下記<a href="../../XFunction/X-Function/Averagexy.html#Algorithm" title="http://wiki.originlab.com/~originla/wiki2/index.php?title=X-Function:Averagexy#Algorithm" rel="nofollow">アルゴリズム</a> のセクションをご覧下さい。
</dd></dl>
</li></ul>
</td></tr>
<tr>
<td>共通Xの許容値
</td><td>toler
</td><td>
<p>入力
</p><p>double
</p>
</td><td> <center>1e-8</center>
</td><td> これは、methodに対して平均が選択されていて、avexに対して同じが選択されている場合のみ利用できます。入力曲線のX値が同じかどうかを確認するために使います。
</td></tr>
<tr>
<td>ポイント数
</td><td>npts
</td><td>
<p>入力
</p><p>int
</p>
</td><td> <center>&lt;自動&gt;</center>
</td><td> これは、<B>手法</B>に対して<B>平均</B>が選択され、<B>平均化されたX</B>で<B>ソースXと同じ</B>が選択されていない場合に利用できます。補間曲線のポイント数を指定します。ダイアログボックスで、<B>自動</B>にチェックがついている場合、自動的に数を計算します。<b>自動</b>チェックボックスのチェックを外して、自分で値を指定することができます。
</td></tr>
<tr>
<td>X最小
</td><td>xmin
</td><td>
<p>入力
</p><p>double
</p>
</td><td> <center>&lt;自動&gt;</center>
</td><td> これは、<B>平均化されたX</B>で<B>カスタム</B>が選択されている場合のみ編集できます。平均曲線の最小のX値を指定します。ダイアログボックスで、<B>自動</B>にチェックがついている場合、自動的に数を計算します。<b>自動</b>チェックボックスのチェックを外して、自分で値を指定することができます。この変数は、<B>平均化されたX</B>で<B>共通X範囲</B>または<B>完全X範囲</B>が選択されている場合には読み取り専用です。
</td></tr>
<tr>
<td>X最大
</td><td>xmax
</td><td>
<p>入力
</p><p>double
</p>
</td><td> <center>&lt;自動&gt;</center>
</td><td> これは、<B>平均化されたX</B>で<B>カスタム</B>が選択されている場合のみ編集できます。平均曲線の最大のX値を指定します。ダイアログボックスで、<B>自動</B>にチェックがついている場合、自動的に数を計算します。<b>自動</b>チェックボックスのチェックを外して、自分で値を指定することができます。この変数は、<B>平均化されたX</B>で<B>共通X範囲</B>または<B>完全X範囲</B>が選択されている場合には読み取り専用です。
</td></tr>
<tr>
<td>補間
</td><td>interp
</td><td>
<p>入力
</p><p>int
</p>
</td><td> <center>0</center>
</td><td> これは、<B>平均化されたX</B>で<B>ソースXと同じ</B>が選択されていない場合にのみ利用できます。これは入力曲線を平均化する前にY値を <a href="../../XFunction/X-Function/Interp1.html#Algorithm" title="http://wiki.originlab.com/~originla/wiki2/index.php?title=X-Function:Interp1#Algorithm" rel="nofollow">補間する手法</a> を指定します。
<p>オプションリスト:
</p>
<ul><li><i>linear:線形</i>
<dl><dd>X値に対して <a href="../../XFunction/X-Function/Interp1.html#Algorithm" title="http://wiki.originlab.com/~originla/wiki2/index.php?title=X-Function:Interp1#Algorithm" rel="nofollow">線形補間</a> を実行します。
</dd></dl>
</li><li><i>spline:Spline</i>
<dl><dd>X値に対して <a href="../../XFunction/X-Function/Interp1.html#Algorithm" title="http://wiki.originlab.com/~originla/wiki2/index.php?title=X-Function:Interp1#Algorithm" rel="nofollow">スプライン補間</a> を実行します。
</dd></dl>
</li><li><i>bspline:B-Spline</i>
<dl><dd>X値に対して <a href="../../XFunction/X-Function/Interp1.html#Algorithm" title="http://wiki.originlab.com/~originla/wiki2/index.php?title=X-Function:Interp1#Algorithm" rel="nofollow">Bスプライン補間</a> を実行します。
</dd></dl>
</li></ul>
</td></tr>
<tr>
<td>Xソート
</td><td>sortx
</td><td>
<p>入力
</p><p>int
</p>
</td><td> <center>1</center>
</td><td> これは、<b>手法</b>で<b>連結</b>が選択されている場合のみ利用できます。これは平均化した曲線のX値をソートする手法を指定します。それに伴いY値が並び替えられます。
<p>オプションリスト:
</p>
<ul><li><i>none:None</i>
<dl><dd>X値をソートしません。
</dd></dl>
</li><li><i>ascend:昇順</i>
<dl><dd>X値を昇順でソートします。
</dd></dl>
</li><li><i> descend:降順</i>
<dl><dd>X値を降順でソートします。
</dd></dl>
</li></ul>
</td></tr>
<tr>
<td>X
</td><td>x
</td><td>
<p>出力
</p><p>vector
</p>
</td><td> <center>&lt;optional&gt;</center>
</td><td> 平均化されたX値を出力する列を指定します。
</td></tr>
<tr>
<td>Y
</td><td>y
</td><td>
<p>出力
</p><p>vector
</p>
</td><td> <center>&lt;optional&gt;</center>
</td><td> 平均化されたY値を出力する列を指定します。
</td></tr>
<tr>
<td>標準偏差
</td><td>sd
</td><td>
<p>出力
</p><p>vector
</p>
</td><td> <center>&lt;optional&gt;</center>
</td><td> これは、<b>Method</b>変数が<b>Average</b>にセットされている場合のみ利用できます。これは、平均化曲線の標準偏差を計算するかどうかを指定します。
</td></tr>
<tr>
<td>標準誤差
</td><td>se
</td><td>
<p>出力
</p><p>vector
</p>
</td><td> <center>&lt;optional&gt;</center>
</td><td> これは、<b>Method</b>変数が<b>Average</b>にセットされている場合のみ利用できます。これは、平均化曲線の標準誤差を計算するかどうかを指定します。
</td></tr>
<tr>
<td>N
</td><td>n
</td><td>
<p>出力
</p><p>vector
</p>
</td><td> <center>&lt;optional&gt;</center>
</td><td> これは、<b>Method</b>変数が<b>Average</b>にセットされている場合のみ利用できます。平均化した各X値に対応する入力データの数を計算するかどうかを指定します。
</td></tr>
<tr>
<td>最小
</td><td>min
</td><td>
<p>入力
</p><p>int
</p>
</td><td> <center>0</center>
</td><td> これは、<b>Method</b>変数が<b>Average</b>にセットされている場合のみ利用できます。最小値を出力するかどうかを指定します。
</td></tr>
<tr>
<td>最大
</td><td>max
</td><td>
<p>入力
</p><p>int
</p>
</td><td> <center>0</center>
</td><td> これは、<B>手法</B>で<B>平均</B>にセットされている場合のみ利用できます。最大値を出力するかどうかを指定します。
</td></tr>
<tr>
<td>SDの2倍
</td><td>sd2
</td><td>
<p>入力
</p><p>int
</p>
</td><td> <center>0</center>
</td><td> これは、<B>手法</B>で<B>平均</B>にセットされている場合のみ利用できます。標準偏差の2倍を計算するかどうかを指定します。
</td></tr>
<tr>
<td>SDの3倍
</td><td>sd3
</td><td>
<p>入力
</p><p>int
</p>
</td><td> <center>0</center>
</td><td> これは、<B>手法</B>で<B>平均</B>にセットされている場合のみ利用できます。標準偏差の3倍を計算するかどうかを指定します。
</td></tr></table>
<a name="Description"></a><h2> <span class="mw-headline"> 説明 </span></h2>
<p>この関数は、入力曲線の平均を計算するか、それらを連結し、XYデータを他の選択した出力項目と一緒に、vector型データで出力します。
</p><p><b>Method </b>変数が <b>連結</b>にセットされている場合、入力範囲が結合され、より大きなデータセットを形成します。それ以外の場合、入力曲線のY値の平均が計算されます。
</p><p>平均曲線の均一なX範囲で補間がすべての入力曲線のy値に対して実行されます。または、単にすべての入力曲線のx値を組み込んで、より大きなデータセットにします。この場合、x値が無視される許容値と最小差を指定することができます。
</p><p>入力曲線のx値は単調ではない場合、曲線は最初にソートされ、Originはこれら単調曲線を平均します。平均の計算に対して、各X値に対応する標準偏差、標準誤差、ポイント数も出力されます。
</p>
<a name="Examples"></a><h2> <span class="mw-headline"> サンプル </span></h2>
<p>次のスクリプトはX値の線形補間を使ってアクティブワークシートの2つの曲線のデータを平均するのに使用します。
</p>
<pre class="lt">averagexy iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">(</span><span style="color: #000000;">(</span>col<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>,col<span style="color: #000000;">(</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>,<span style="color: #000000;">(</span>col<span style="color: #000000;">(</span><span style="color: #0000dd;">3</span><span style="color: #000000;">)</span>, col<span style="color: #000000;">(</span><span style="color: #0000dd;">4</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span> method<span style="color: #000000;">:</span><span style="color: #000080;">=</span>ave avex<span style="color: #000000;">:</span><span style="color: #000080;">=</span>common x<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>new<span style="color: #000080;">&gt;</span> y<span style="color: #000000;">:</span><span style="color: #000080;">=</span> <span style="color: #000080;">&lt;</span>new<span style="color: #000080;">&gt;</span>;</pre>
<p>そして、2つの列が入力ワークシートに追加されます。1つは平均曲線のx値を保存し、他方はy値を保存します。
</p>
<a name="Algorithm"></a><h2> <span class="mw-headline"> アルゴリズム </span></h2>
<p><b>Method </b>変数が <b>連結</b>にセットされている場合、すべての入力範囲が単純に結合されます。それ以外の場合、Y値の平均が入力曲線に対して計算されます。平均曲線のX値を計算するために、このXファンクションには5つの方法があります。 
</p><p>x値を計算する方法についての詳細は、<a href="../../XFunction/X-Function/Avecurves.html#algorithm" title="http://wiki.originlab.com/~originla/wiki2/index.php?title=X-Function:Avecurves#algorithm" rel="nofollow">avecurvesのアルゴリズム</a>を参照してください。
</p>
<a name="Related_X-Functions"></a><h2> <span class="mw-headline"> 関連するXファンクション </span></h2>
<p><a href="../../XFunction/X-Function/Avecurves.html" title="X-Function:Avecurves">avecurves</a>
</p>