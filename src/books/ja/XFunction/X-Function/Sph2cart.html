<h1 class="firstheading">sph2cart<br /></h1>
<table id="toc" class="toc">
<tr>
<td>
<div id="toctitle">
<h2>内容</h2>
</div>
<ol>
<li class="toclevel-1 tocsection-1"><a href="#Brief_Information"><span class="tocnumber">1</span> <span class="toctext">概要</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Additional_Information"><span class="tocnumber">2</span> <span class="toctext">追加の情報</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Command_Line_Usage"><span class="tocnumber">3</span> <span class="toctext">コマンドラインでの使用法</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Variables"><span class="tocnumber">4</span> <span class="toctext">変数</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Description"><span class="tocnumber">5</span> <span class="toctext">説明</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Algorithm"><span class="tocnumber">6</span> <span class="toctext">アルゴリズム</span></a></li>
</ol>
</td>
</tr>
</table>
<a name="Brief_Information" id="Brief_Information"></a>
<h2><span class="mw-headline">概要</span></h2>
<p>球座標の配列をデカルト座標に変換</p>
<a name="Additional_Information" id="Additional_Information"></a>
<h2><span class="mw-headline">追加の情報</span></h2>
<p>必要なOriginのバージョン: Origin 9.1 SR0以降</p>
<a name="Command_Line_Usage" id="Command_Line_Usage"></a>
<h2><span class="mw-headline">コマンドラインでの使用法</span></h2>
<p><code style="font-family: monospace;">1. sph2cart format:=virmat iw:=[Book1]Sheet1! omx:=&lt;new&gt;!&lt;new&gt; omy:=&lt;same&gt;!&lt;new&gt; omz:=&lt;same&gt;!&lt;new&gt;;//Book1 Sheet1 内にある仮想行列データを3つの行列オブジェクト X Y Z の同名の行列に変換する</code></p>
<p><code style="font-family: monospace;">2. sph2cart ir:=[Book1]Sheet1!(A,B,C)[1:3] unit:=1 oz:=&lt;new&gt;!(&lt;new&gt;,&lt;new&gt;,&lt;new&gt;);// XYZ ワークシートデータ列を変換し、結果のXYZデータを新しいワークシートにXYZ列として出力する</code></p>
<p><code style="font-family: monospace;">3. sph2cart format:=mats ima:=[MBook1]MSheet1!1 ime:=[MBook2]MSheet1!1 imr:=[MBook3]MSheet1!1;//異なる行列ブックにある3つの行列オブジェクトを変換し、変換した3つのX、Y、Zデータを格納した行列ブックを出力</code></p>
<a name="Variables" id="Variables"></a>
<h2><span class="mw-headline">変数</span></h2>
<table class="xfvar">
<tr>
<th style="width: 8%;">表示名</th>
<th style="width: 8%;">変数名</th>
<th style="width: 8%;">I/Oとタイプ</th>
<th style="width: 8%;">デフォルト値</th>
<th>説明</th>
</tr>
<tr>
<td>データフォーマット</td>
<td>format</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">0</p>
</td>
<td>入力データ形式を指定します。入力は球体の座標システムであると推測されます。
<p>オプションリスト</p>
<ul>
<li><i style="font-style: italic;">xyz:XYZ</i>{0}
<dl>
<dd>ワークシート内のXY属性がXYZとなる、3つの列である入力データ形式として指定します。</dd>
</dl>
</li>
<li><i style="font-style: italic;">virmat:</i> <i>仮想行列</i>{1}
<dl>
<dd>仮想行列を入力データ形式として指定します。</dd>
</dl>
</li>
<li><i style="font-style: italic;">mat:</i><i>行列オブジェクト</i>{2}
<dl>
<dd>1つの行列オブジェクトを入力データ形式として指定します。</dd>
</dl>
</li>
<li><i style="font-style: italic;">mats:</i><i>1つのレイヤに3つの行列</i>{3}
<dl>
<dd>3つの行列オブジェクトを入力データ形式として指定します。これらの3つの行列オブジェクトは、同じ次元を有している必要があります。</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr>
<td>入力</td>
<td>ir</td>
<td>
<p>入力</p>
<p>XYZRange</p>
</td>
<td>
<p style="text-align: center;">&lt;active&gt;</p>
</td>
<td>この変数は変数の<i>フォーマット</i>が<i>xyz</i>に設定されている時のみ使用可能です。これは入力するXYZデータ範囲を指定するのに使用します。</td>
</tr>
<tr>
<td>方位</td>
<td>ima</td>
<td>
<p>入力</p>
<p>MatrixObject</p>
</td>
<td>
<p style="text-align: center;">&lt;active&gt;</p>
</td>
<td>この変数は変数の<i>フォーマット</i>が<i>mats</i>に設定されている時のみ使用可能です。方位データとして入力する行列データを指定します。</td>
</tr>
<tr>
<td>標高</td>
<td>ime</td>
<td>
<p>入力</p>
<p>MatrixObject</p>
</td>
<td>
<p style="text-align: center;">&lt;active&gt;</p>
</td>
<td>この変数は変数の<i>フォーマット</i>が<i>mats</i>に設定されている時のみ使用可能です。標高データとして入力する行列データを指定します。</td>
</tr>
<tr>
<td>半径</td>
<td>imr</td>
<td>
<p>入力</p>
<p>MatrixObject</p>
</td>
<td>
<p style="text-align: center;">&lt;active&gt;</p>
</td>
<td>この変数は変数の<i>フォーマット</i>が<i>mat</i>または<i>mats</i>に設定されている時に使用可能です。<i>フォーマット</i>が<i>mat</i>変数の場合は入力する行列オブジェクトを指定します。<i>フォーマット</i>が<i>mats</i>変数の場合は、半径データとして入力する行列オブジェクトを指定します。</td>
</tr>
<tr>
<td>入力</td>
<td>iw</td>
<td>
<p>入力</p>
<p>Worksheet</p>
</td>
<td>
<p style="text-align: center;">&lt;active&gt;</p>
</td>
<td>この変数は変数の<i>フォーマット</i>が<i>virmat</i>に設定されている時のみ使用可能です。これは仮想行列のワークシート範囲を指定するために使用します。</td>
</tr>
<tr>
<td>角度データ</td>
<td>angle</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">0</p>
</td>
<td>この変数は変数の<i>フォーマット</i>が<i>virmat</i>または<i>mat</i>に設定されている時のみ使用可能です。これは方位や標高のデータ値が元のデータないでどのように配置されているか指定します。
<p>オプションリスト</p>
<ul>
<li><i style="font-style: italic;">0:列を横断する方位</i>
<dl>
<dd><i style="font-style: italic;">フォーマット</i>が<i>virmat</i>の場合、行を方位角値として設定し、最初のデータ列を標高の値として設定します。方位角値として指定する行は方位角値( <i>Azimuth Values in</i> )変数で設定できます。</dd>
<dd><i style="font-style: italic;">フォーマット</i>が<i>mat</i>の場合、行列のX値を方位角値として使用し、Y値を標高の値として使用します。</dd>
</dl>
</li>
<li><i style="font-style: italic;">1:列を横断する標高</i>
<dl>
<dd><i style="font-style: italic;">フォーマット</i>が<i>virmat</i>の場合、行を標高の値として設定し、最初のデータ列を方位角値として設定します。方位角値として指定する行は標高の値( <i>Elevation Values in</i> )変数で設定できます。</dd>
<dd><i style="font-style: italic;">フォーマット</i>が<i>mat</i>の場合、行列のX値を標高の値として使用し、Y値を方位角値として使用します。</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr>
<td>方位角値</td>
<td>alabel</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">0</p>
</td>
<td>この変数は<i>angle</i>変数が<i>0</i>(列を横断して方位)設定されている時のみ使用可能です。方位角値のデータソースを指定します。
<p>オプションリスト</p>
<ul>
<li><i style="font-style: italic;">first:</i><i>第一データ行</i>{0}
<dl>
<dd>入力ワークシートで最初の行を方位角値として使用します。</dd>
</dl>
</li>
<li><i style="font-style: italic;">second:</i><i>列ラベル</i>{1}
<dl>
<dd>列ラベル行の中にある値を方位角値として使用します。列ラベル行は <i>param</i> 変数で指定できます。</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr>
<td>標高の値</td>
<td>elabel</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">0</p>
</td>
<td>
<p>この変数は<i>angle</i>変数が<i>1</i>(列を横断して標高)設定されている時のみ使用可能です。標高の値のデータソースを指定します。</p>
<p>オプションリスト</p>
<ul>
<li><i style="font-style: italic;">first:</i><i>第一データ行</i>{0}
<dl>
<dd>入力ワークシートで最初の行を標高の値として使用します。</dd>
</dl>
</li>
<li><i style="font-style: italic;">second:</i><i>列ラベル</i>{1}
<dl>
<dd>列ラベル行の中にある値を標高の値として使用します。列ラベル行は <b>param</b> 変数で指定できます。</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr>
<td>列ラベル</td>
<td>param</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">0</p>
</td>
<td>この変数は<i>alabel</i> または<i>elabel</i> 変数で<i>second</i>か<i>1</i>(列ラベル)をセットした時のみ有効になります。方位または標高データとして使用する列ラベル行を指定します。
<p>オプションリスト</p>
<ul>
<li><i style="font-style: italic;">longname:ロングネーム</i>{0}
<dl>
<dd>ロングネーム行の値を方位/標高データに使用します。</dd>
</dl>
</li>
<li><i style="font-style: italic;">units:</i>単位{1}
<dl>
<dd>単位行の値を方位/標高データに使用します。</dd>
</dl>
</li>
<li><i style="font-style: italic;">comments:</i>コメント{2}
<dl>
<dd>コメント行の値を方位/標高データに使用します。</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr>
<td>角度単位</td>
<td>unit</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">0</p>
</td>
<td>入力データに対して方位角の単位を指定します。
<p>オプションリスト</p>
<ul>
<li><i style="font-style: italic;">0:ラジアン</i>
<dl>
<dd>入力データはラジアンで表記されます。</dd>
</dl>
</li>
<li><i style="font-style: italic;">1:度</i>
<dl>
<dd>入力データは度数で表記されます。</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr>
<td>X</td>
<td>omx</td>
<td>
<p>出力</p>
<p>MatrixObject</p>
</td>
<td>
<p style="text-align: center;">&lt;新規&gt;</p>
</td>
<td>この変数は変数の<i>フォーマット</i>が <i>XYZ</i>に設定されて<i>いない</i>時のみ使用可能です。変換したXの値をどこに出力するか指定します。変換したX値は出力した行列オブジェクトのZ値になります。</td>
</tr>
<tr>
<td>Y</td>
<td>omy</td>
<td>
<p>出力</p>
<p>MatrixObject</p>
</td>
<td>
<p style="text-align: center;">&lt;新規&gt;</p>
</td>
<td>この変数は変数の<i>フォーマット</i>が <i>XYZ</i>に設定されて<i>いない</i>時のみ使用可能です。変換したYの値をどこに出力するか指定します。変換したY値は出力した行列オブジェクトのZ値になります。</td>
</tr>
<tr>
<td>Z</td>
<td>omz</td>
<td>
<p>出力</p>
<p>MatrixObject</p>
</td>
<td>
<p style="text-align: center;">&lt;新規&gt;</p>
</td>
<td>この変数は変数の<i>フォーマット</i>が <i>XYZ</i>に設定されて<i>いない</i>時のみ使用可能です。変換したZの値をどこに出力するか指定します。変換したZ値は出力した行列オブジェクトのZ値になります。</td>
</tr>
<tr>
<td>出力</td>
<td>oz</td>
<td>
<p>出力</p>
<p>XYZRange</p>
</td>
<td>
<p style="text-align: center;">&lt;新規&gt;</p>
</td>
<td>この変数は変数の<i>フォーマット</i>が<i>XYZ</i>に設定されている時のみ使用可能です。変換したXYZデータを出力するワークシート範囲を指定します。</td>
</tr>
</table>
<a name="Description" id="Description"></a>
<h2><span class="mw-headline">説明</span></h2>
<p>このツールは球面座標系をデカルト座標系に変換する際に使用するツールです。入力データはワークシートのXYZ列、仮想行列、1つの行列オブジェクト、同じ次元をもつ3つの行列オブジェクトのいずれかを利用できます。</p>
<p>以下のコマンドをスクリプトウィンドウまたはコマンドウィンドウで実行するとこのツールのGUIダイアログを開く事ができます。</p>
<pre class="lt" style="font-family: monospace;">
sph2cart <span style="color: #000080;">-</span>d;
</pre>
<p><a class="image"><img alt="Sph2cart dialog.png" src="../images/Sph2cart/Sph2cart_dialog.png" width="449" height="324" border="0" /></a></p>
<a name="Algorithm" id="Algorithm"></a>
<h2><span class="mw-headline">アルゴリズム</span></h2>
<p>球面座標は<img src="../images/Sph2cart/math-0d7145c5b6c1f28cc984f30558c1fee0.png" title="\left (r, \theta, \phi \right )" alt="\left (r, \theta, \phi \right )" class="tex" width="50" height="18" border="0" />によって定義されます。ここで、<img src="../images/Sph2cart/math-4b43b0aee35624cd95b910189b3dc231.png" title="r" alt="r" class="tex" width="8" height="7" border="0" />は半径(データポイントと原点との距離)、<img src="../images/Sph2cart/math-1ed346930917426bc46d41e22cc525ec.png" title="\phi" alt="\phi" class="tex" width="10" height="14" border="0" />が標高(XY面からデータポイントまでの偏位角度、単位はラジアン)、<img src="../images/Sph2cart/math-2554a2bb846cffd697389e5dc8912759.png" title="\theta" alt="\theta" class="tex" width="8" height="11" border="0" />が方位(X軸からデータポイントまでの偏位角度を正の数で表示、つまりX &gt; 0で、単位はラジアン)を示します。下図はそれぞれの3つの値はどのように定義されるか示します。</p>
<p><a class="image"><img alt="Spherical CS 01.png" src="../images/Sph2cart/Spherical_CS_01.png" width="459" height="447" border="0" /></a></p>
<p>方位、標高、半径のデータは入力データ形式で変更になります。</p>
<table class="simple">
<tr>
<th>入力データフォーマット</th>
<th>方位</th>
<th>標高</th>
<th>半径</th>
</tr>
<tr>
<td style="text-align: center;"><b style="font-weight: bold;">XYZ</b></td>
<td>X列</td>
<td>Y列</td>
<td>Z列</td>
</tr>
<tr>
<td style="text-align: center;"><b style="font-weight: bold;">仮想行列/行列オブジェクト</b></td>
<td>仮想行列/行列オブジェクトのX値</td>
<td>仮想行列/行列オブジェクトのY値</td>
<td>仮想行列/行列オブジェクトのZ値</td>
</tr>
<tr>
<td style="text-align: center;"><b style="font-weight: bold;">1つのレイヤに3つの行列</b></td>
<td>行列オブジェクト内のZ値が方位角値として設定</td>
<td>行列オブジェクト内のZ値が標高の値として設定</td>
<td>行列オブジェクト内のZ値が半径の値として設定</td>
</tr>
</table>
<p>入力データは球面座標からデカルト座標に下記の手法で変換されます。</p>
<p><img src="../images/Sph2cart/math-abc5d9ae973e3024c12523f50b7e98c7.png" title=" x = r \ast cos\left ( \phi \right ) \ast cos \left ( \theta \right ); " alt=" x = r \ast cos\left ( \phi \right ) \ast cos \left ( \theta \right ); " class="tex" width="173" height="18" border="0" /></p>
<p><img src="../images/Sph2cart/math-bf19b127f9953cf4a3bece5bddb88e21.png" title=" y = r \ast cos\left ( \phi \right ) \ast sin \left ( \theta \right ); " alt=" y = r \ast cos\left ( \phi \right ) \ast sin \left ( \theta \right ); " class="tex" width="173" height="18" border="0" /></p>
<p><img src="../images/Sph2cart/math-7ff6c70cd5252461cd3496c399919a55.png" title=" z = r \ast sin\left ( \phi \right ) " alt=" z = r \ast sin\left ( \phi \right ) " class="tex" width="102" height="18" border="0" /></p>


