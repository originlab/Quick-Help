<h1 class="\&quot;firstheading\&quot;">fft_filters</h1>
<table id="toc" class="toc" summary="Contents">
<tr>
<td>
<div id="toctitle">
<h2>内容</h2>
</div>
<ol>
<li class="kadov-p"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">メニュー情報</span></a></li>
<li class="kadov-p"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">概要</span></a></li>
<li class="kadov-p"><a href="#Command_Line_Usage"><span class="tocnumber">3</span> <span class="toctext">コマンドラインでの使用法</span></a></li>
<li class="kadov-p"><a href="#Variables"><span class="tocnumber">4</span> <span class="toctext">変数</span></a></li>
<li class="kadov-p"><a href="#Description"><span class="tocnumber">5</span> <span class="toctext">説明</span></a></li>
<li class="kadov-p"><a href="#Examples"><span class="tocnumber">6</span> <span class="toctext">サンプル</span></a></li>
<li class="kadov-p"><a href="#Algorithm"><span class="tocnumber">7</span> <span class="toctext">アルゴリズム</span></a></li>
<li class="kadov-p"><a href="#Related_X-Functions"><span class="tocnumber">8</span> <span class="toctext">関連のXファンクション</span></a></li>
</ol>
</td>
</tr>
</table>
<a name="Menu_Information" id="Menu_Information"></a>
<h2><span class="mw-headline">メニュー情報</span></h2>
<p>FFTフィルタ</p>
<a name="Brief_Information" id="Brief_Information"></a>
<h2><span class="mw-headline">概要</span></h2>
<p>FFTフィルタを実行する</p>
<a name="Command_Line_Usage" id="Command_Line_Usage"></a>
<h2><span class="mw-headline">コマンドラインでの使用法</span></h2>
<p><code style="font-family: monospace;">1. fft_filters Col(2) cutoff:=5;</code></p>
<p><code style="font-family: monospace;">2. fft_filters Col(2) filter:=bandpass Freq1:=3 Freq2:=3.6;</code></p>
<p><code style="font-family: monospace;">3. fft_filters Col(2) filter:=threshold threshold:=1;</code></p>
<p><code style="font-family: monospace;">4. fft_filters Col(2) filter:=bandblock Freq1:=1.1 Freq2:=1.3 oy:= (Col(3), Col(4));</code></p>
<a name="Variables" id="Variables"></a>
<h2><span class="mw-headline">変数</span></h2>
<table class="xfvar">
<tr>
<th style="width: 8%;">表示<br />
名</th>
<th style="width: 8%;">変数<br />
名</th>
<th style="width: 8%;">I/O<br />
と<br />
データ型</th>
<th style="width: 8%;">デフォルト<br />
値</th>
<th>説明</th>
</tr>
<tr>
<td>入力</td>
<td>iy</td>
<td>
<p>入力</p>
<p>XYRange</p>
</td>
<td>
<p style="text-align: center;">&lt;active&gt;</p>
</td>
<td>
<p>入力データ範囲を指定します。</p>
</td>
</tr>
<tr>
<td>フィルタの種類</td>
<td>filter</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">ローパス</p>
</td>
<td>
<p>フィルタの種類を指定します。</p>
<p>オプションリスト</p>
<ul>
<li class="kadov-p"><i style="font-style: italic;">low:ローパス</i>
<dl>
<dd>低い周波数成分のみを通します。</dd>
</dl>
</li>
<li class="kadov-p"><i style="font-style: italic;">high:ハイパス</i>
<dl>
<dd>高い周波数成分のみを通します。</dd>
</dl>
</li>
<li class="kadov-p"><i style="font-style: italic;">bandpass:バンドパス</i>
<dl>
<dd>指定した範囲内の周波数成分のみを通します。</dd>
</dl>
</li>
<li class="kadov-p"><i style="font-style: italic;">bandblock:バンドブロック</i>
<dl>
<dd>指定した範囲外の周波数成分のみを通します。</dd>
</dl>
</li>
<li class="kadov-p"><i style="font-style: italic;">threshold:しきい値</i>
<dl>
<dd>振幅がしきい値より大きい周波数成分のみを通します。</dd>
</dl>
</li>
<li class="kadov-p"><i style="font-style: italic;">lowpp :</i>
<dl>
<dd>パラボリックローパスフィルタです。</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr>
<td>低域のカットオフ周波数</td>
<td>freq1</td>
<td>
<p>入力</p>
<p>double</p>
</td>
<td>
<p style="text-align: center;">0</p>
</td>
<td>
<p>このオプションは、フィルタの種類がバンドパスまたはバンドブロックの場合のみ利用できます。低域のカットオフ周波数を指定します。</p>
</td>
</tr>
<tr>
<td>高域のカットオフ周波数</td>
<td>freq2</td>
<td>
<p>入力</p>
<p>double</p>
</td>
<td>
<p style="text-align: center;">1</p>
</td>
<td>
<p>このオプションは、フィルタの種類がバンドパスまたはバンドブロックの場合のみ利用できます。高域のカットオフ周波数を指定します。</p>
</td>
</tr>
<tr>
<td>カットオフ周波数</td>
<td>cutoff</td>
<td>
<p>入力</p>
<p>double</p>
</td>
<td>
<p style="text-align: center;">0</p>
</td>
<td>
<p>このオプションは、フィルタの種類がローパスまたはハイパスの場合のみ利用できます。カットオフ周波数を指定します。</p>
</td>
</tr>
<tr>
<td>パス周波数</td>
<td>pass</td>
<td>
<p>入力</p>
<p>double</p>
</td>
<td>
<p style="text-align: center;">1</p>
</td>
<td>
<p>このオプションは、フィルタの種類がローパスパラボリックの場合のみ利用できます。この値以下のすべての周波数は、フィルタ通過後に一定となります。</p>
</td>
</tr>
<tr>
<td>停止周波数</td>
<td>stop</td>
<td>
<p>入力</p>
<p>double</p>
</td>
<td>
<p style="text-align: center;">1</p>
</td>
<td>
<p>このオプションは、フィルタの種類がローパスパラボリックの場合のみ利用できます。この値以上のすべての周波数が完全に除去されます。</p>
</td>
</tr>
<tr>
<td>しきい値</td>
<td>threshold</td>
<td>
<p>入力</p>
<p>double</p>
</td>
<td>
<p style="text-align: center;">1</p>
</td>
<td>
<p>このオプションは、フィルタの種類がしきい値の場合のみ利用できます。振幅のしきい値を指定します。</p>
</td>
</tr>
<tr>
<td>DCオフセットを保持</td>
<td>offset</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">1</p>
</td>
<td>
<p>このオプションは、フィルタの種類がハイパス、バンドパス、バンドブロックの場合のみ利用できます。このオプションにチェックが付いていると、DCオフセットはフィルタリング処理中に変更されません。</p>
</td>
</tr>
<tr>
<td>出力</td>
<td>oy</td>
<td>
<p>出力</p>
<p>XYRange</p>
</td>
<td>
<p style="text-align: center;">&lt;新規&gt;</p>
</td>
<td>
<p>出力を指定します。</p>
</td>
</tr>
</table>
<a name="Description" id="Description"></a>
<h2><span class="mw-headline">説明</span></h2>
<p>フィルタリングは信号データから周波数成分を選択する処理です。FFTフィルターは、 フーリエ変換を使って入力信号の周波数成分を分析するフィルタリングを実行しています。</p>
<p>この関数では、ローパス、ハイパス、バンドパス、バンドブロック、パラボリックローパス、しきい値の6種類のフィルターが利用できます。最初の4つのフィルタが実用上理想的なフィルタです。ローパスフィルターは、カットオフ周波数より大きいすべての周波数成分をブロックし、小さい周波数のみを通します。ハイパスフィルターは、ローパスフィルターの逆で、カットオフ周波数より小さいすべての周波数成分をブロックします。バンドパスフィルターは、低域および高域カットオフ周波数で決められた範囲内の周波数成分を通し、バンドブロックフィルタは選択した範囲の周波数を除去します。ローパスパラボリックフィルタは、窓関数は指定したカットオフ周波数を境界にしていきなりブロックしないという点で理想的なローパスフィルタとは異なります。パスする周波数とブロックする周波数の間で、窓関数は双曲線を描くような周波数を選択します。一方で、しきい値フィルタを選択することができ、これは指定したしきい値以下の大きさを持つ周波数を削除します。</p>
<p>この関数のダイアログでは、変数を変更するとフィルタリングされた信号のプレビューをリアルタイムで見ることができます。カットオフ周波数、パス周波数、ブロック周波数、しきい値は、プレビューウィンドウに表示される線をドラッグして選択することができます。</p>
<a name="Examples" id="Examples"></a>
<h2><span class="mw-headline">サンプル</span></h2>
<p>1. カットオフ周波数を3として、ローパスフィルターを実行するには、アクティブワークシートの2列目のYデータに対して、次のスクリプトコマンドを使います。</p>
<dl>
<dd>fft_filters iy:=col(2) cutoff:=3</dd>
</dl>
<p>2. 事前に保存したテーマファルを使ってデータにfft_filteringを実行するには、 fft_filter ダイアログで自分の設定を保存し、そのテーマファイルのタイトルを使って、以下のようにスクリプトコマンドを入力して実行します。</p>
<dl>
<dd>fft_filters -t "my fft filter theme.oth"</dd>
</dl>
<p>3. ダイアログを開くには、コマンドウィンドウに次のように入力します。</p>
<dl>
<dd>fft_filters -d</dd>
</dl>
<p>または、Originのメニューから、「<b>解析：信号処理：FFTフィルタ</b> 」を選択します。プレビューを持つダイアログで、周波数と振幅のグラフ上の赤い線をドラッグしてカットオフ周波数を選択することができます。 左上の領域には、元の信号とフィルタリングした信号が表示されます。このグラフ上に、青い四角形があり、これを移動したり、大きさを変えて、その選択した領域を拡大表示して、右上の領域に表示します。</p>
<dl>
<dd><img src="../images/Fft_filters/Fft_filters_help_English_files_image002.jpg" alt="" style="border: none;" width="880" height="358" border="0" /></dd>
</dl>
<p>他のサンプルについては、XFスクリプトダイアログ(F11を押す)をご覧下さい。</p>
<a name="Algorithm" id="Algorithm"></a>
<h2><span class="mw-headline">アルゴリズム</span></h2>
<p>最初に入力信号のフーリエ変換が計算されます。そして、ローパス、ハイパス、バンドパス、バンドブロック、パラボリックローパスの各フィルタに対しては、フィルタの種類によって決まるウィンドウがフーリエ変換の掛け算に使われます。変数<i>Keep DC Offset</i>が1の場合、ウィンドウの最初の点が1にセットされます。しきい値フィルタに対しては、各周波数成分のパワーが調べられます。それがしきい値より大きく無い場合、対応する周波数成分が破棄されます。周波数を変えた後、逆フーリエ変換が実行されフィルタリングした信号データが得られます。</p>
<p><b style="font-weight: bold;">図 ローパスフィルタのウィンドウ</b></p>
<dl>
<dd><a href="" style="color: #0000ff; text-decoration: underline;"><img alt="Image:fft_filters_help_English_files_image004.gif" src="../images/Fft_filters/Fft_filters_help_English_files_image004.gif" title="Image:fft_filters_help_English_files_image004.gif" width="357" height="295" border="0" /></a></dd>
</dl>
<p><span class="texhtml"><i style="font-style: italic;">f</i><sub><i>c</i></sub></span> をカットオフ周波数とします。窓関数は次式となります。</p>
<p><img class="tex" src="../images/Fft_filters/math-d88a4f86f56eff94c8292a5be83f19f9.png" alt="w(f) = \begin{cases} 1, &amp; \mbox{if }f \le f_{c} \\ 0, &amp; \mbox{if }f &gt; f_{c} \end{cases}" title="w(f) = \begin{cases} 1, &amp; \mbox{if }f \le f_{c} \\ 0, &amp; \mbox{if }f &gt; f_{c} \end{cases}" width="161" height="51" border="0" /></p>
<p><b style="font-weight: bold;">ハイパスフィルタのウィンドウ</b></p>
<dl>
<dd><a href="" style="color: #0000ff; text-decoration: underline;"><img alt="Image:fft_filters_help_English_files_image006.gif" src="../images/Fft_filters/Fft_filters_help_English_files_image006.gif" title="Image:fft_filters_help_English_files_image006.gif" width="357" height="295" border="0" /></a></dd>
</dl>
<p><span class="texhtml"><i style="font-style: italic;">f</i><sub><i>c</i></sub></span> をカットオフ周波数とします。窓関数は次式となります。</p>
<p><img class="tex" src="../images/Fft_filters/math-9d226188ed4e5418f145e0f5773fd5c4.png" alt="w(f) = \begin{cases} 0, &amp; \mbox{if }f \le f_{c} \\ 1, &amp; \mbox{if }f &gt; f_{c} \end{cases}" title="w(f) = \begin{cases} 0, &amp; \mbox{if }f \le f_{c} \\ 1, &amp; \mbox{if }f &gt; f_{c} \end{cases}" width="161" height="51" border="0" /></p>
<p><b style="font-weight: bold;">バンドパスフィルタのウィンドウ</b></p>
<dl>
<dd><a href="" style="color: #0000ff; text-decoration: underline;"><img alt="Image:fft_filters_help_English_files_image008.gif" src="../images/Fft_filters/Fft_filters_help_English_files_image008.gif" title="Image:fft_filters_help_English_files_image008.gif" width="380" height="295" border="0" /></a></dd>
</dl>
<p><span class="texhtml"><i style="font-style: italic;">f</i><sub><i>c</i>1</sub></span> を下側のカットオフ周波数とし、 <span class="texhtml"><i>f</i><sub><i>c</i>2</sub></span> を上側のをカットオフ周波数とします。窓関数は次式となります。<br />
<img class="tex" src="../images/Fft_filters/math-b62adef8bc8c22943a346ecb2c60369d.png" alt="w(f) = \begin{cases} 1, &amp; \mbox{if } f_{c1} &lt; f &lt; f_{c2} \\ 0, &amp; \mbox{otherwise } \end{cases}" title="w(f) = \begin{cases} 1, &amp; \mbox{if } f_{c1} &lt; f &lt; f_{c2} \\ 0, &amp; \mbox{otherwise } \end{cases}" width="211" height="51" border="0" /></p>
<p><b style="font-weight: bold;">バンドブロックフィルタのウィンドウ</b></p>
<dl>
<dd><a href="" style="color: #0000ff; text-decoration: underline;"><img alt="Image:fft_filters_help_English_files_image010.gif" src="../images/Fft_filters/Fft_filters_help_English_files_image010.gif" title="Image:fft_filters_help_English_files_image010.gif" width="380" height="295" border="0" /></a></dd>
</dl>
<p><span class="texhtml"><i style="font-style: italic;">f</i><sub><i>c</i>1</sub></span> を下側のカットオフ周波数とし、 <span class="texhtml"><i>f</i><sub><i>c</i>2</sub></span> を上側のをカットオフ周波数とします。窓関数は次式となります。<br />
<img class="tex" src="../images/Fft_filters/math-0907ab31730983ea691feb9ec4d95227.png" alt="w(f) = \begin{cases} 0, &amp; \mbox{if } f_{c1} &lt; f &lt; f_{c2} \\ 1, &amp; \mbox{otherwise } \end{cases}" title="w(f) = \begin{cases} 0, &amp; \mbox{if } f_{c1} &lt; f &lt; f_{c2} \\ 1, &amp; \mbox{otherwise } \end{cases}" width="211" height="51" border="0" /></p>
<p><b style="font-weight: bold;">ローパスフィルタのウィンドウ</b></p>
<dl>
<dd><a href="" style="color: #0000ff; text-decoration: underline;"><img alt="Image:Low_pass_parabolic_filter.gif" src="../images/Fft_filters/Low_pass_parabolic_filter.PNG" title="Image:Low_pass_parabolic_filter.gif" width="305" height="235" border="0" /></a></dd>
</dl>
<p><span class="texhtml"><i style="font-style: italic;">f</i><sub><i>c</i>1</sub></span> をパス周波数とし、 <span class="texhtml"><i>f</i><sub><i>c</i>2</sub></span> をブロック周波数とします。窓関数は次式となります。<br />
<img class="tex" src="../images/Fft_filters/math-5ac2efa0521869609a2a6ffaf34eb551.png" alt="w(f) = \begin{cases} 1, &amp; \mbox{if }f \le f_{c1} \\ 1-\frac{(f-f_{c1})^2}{(f_{c2}-f_{c1})^2}, &amp; \mbox{if } f_{c1} &lt; f &lt; f_{c2} \\ 0, &amp; \mbox{if }f \ge f_{c2} \end{cases}" title="w(f) = \begin{cases} 1, &amp; \mbox{if }f \le f_{c1} \\ 1-\frac{(f-f_{c1})^2}{(f_{c2}-f_{c1})^2}, &amp; \mbox{if } f_{c1} &lt; f &lt; f_{c2} \\ 0, &amp; \mbox{if }f \ge f_{c2} \end{cases}" width="320" height="89" border="0" /></p>
<a name="Related_X-Functions" id="Related_X-Functions"></a>
<h2><span class="mw-headline">関連のXファンクション</span></h2>
<p><a href="Fft1.html" title="X-Function:Fft1">fft1</a>, <a href="Ifft1.html" title="X-Function:Ifft1">ifft1</a></p>
