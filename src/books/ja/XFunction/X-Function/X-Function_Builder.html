<h1 class="firstheading">Xファンクションビルダ</h1><p><span class="OIndex" style="display:none">Xファンクションビルダ</span>
<b>ツール：Xファンクションビルダ</b>をクリックしてXファンクションビルダを開きます。 
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#X-Function_Name"><span class="tocnumber">1</span> <span class="toctext">Xファンクション名</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#X-Function_VariableX-Function_Variables"><span class="tocnumber">2</span> <span class="toctext"><span class="OIndex" style="display:none">X-Function Variable</span>Xファンクション変数</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#X-Function_Variable_TypeVariable_Data_Type_and_Default_Value"><span class="tocnumber">3</span> <span class="toctext"><span class="OIndex" style="display:none">X-Function Variable Type</span>変数データタイプとデフォルト値</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#X-Function_Dialog_ControlsControl_Types"><span class="tocnumber">4</span> <span class="toctext"><span class="OIndex" style="display:none">X-Function Dialog Controls</span>制御型</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#X-Function_Option_StringsOption_String"><span class="tocnumber">5</span> <span class="toctext"><span class="OIndex" style="display:none">X-Function Option Strings</span>オプション文字列</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#X-Function_Dialog_ThemeTheme_ID"><span class="tocnumber">6</span> <span class="toctext"><span class="OIndex" style="display:none">X-Function Dialog Theme</span>テーマID</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#X-Function_Tree_ViewTree_View"><span class="tocnumber">7</span> <span class="toctext"><span class="OIndex" style="display:none">X-Function Tree View</span>ツリービュー</span></a></li>
</ul>
</div>
<h2><a name="X-Function_Name"></a><span class="mw-headline">Xファンクション名</span></h2>
<p>Xファンクション編集ボックスでXファンクション名を入力します。 
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/X-Function_Builder/Tip_icon.png" width="57"  border="0" /></td><td><p>Xファンクションの名前として、既存のLabTalkマクロ、OGSファイル、LabTalkコマンド、LabTalkで呼び出し可能なOriginC関数の名前は使用しないでください。 
</p><p>同じ名前のものがある場合、呼びだされる順番は、LabTalkマクロ &gt; LabTalk OGS &gt; Xファンクション &gt; LabTalkで呼び出し可能なOriginC関数 &gt; LabTalkコマンド の順になります。
</p></td></tr></table>
<p><br />
</p>
<h2><a name="X-Function_VariableX-Function_Variables"></a><span class="mw-headline"><span class="OIndex" style="display:none">X-Function Variable</span>Xファンクション変数</span></h2>
<table class="simple">
<tr>
<th> 名前
</th>
<td>
<p>変数の名前を指定します。Xファンクションがスクリプトで実行されるとき、その名前を使って、変数に値を割り当てる必要があります。そのため、異なる文字で始まる短い名前にすることをおすすめします。
</p>
</td></tr>
<tr>
<th> ラベル
</th>
<td>
<p>変数のラベルを指定します。特殊記号やスペースを使うことができます。制御ラベルとしてXファンクションダイアログ上に表示します。  指定しない場合、変数名が使用されます。
</p>
</td></tr>
<tr>
<th> 入力/出力
</th>
<td>
<p>変数が入力、出力、入出力のどのタイプで使用されるかを指定します。
</p>
</td></tr>
<tr>
<th> データ型
</th>
<td>
<p>変数のデータ型を指定します。 
</p><p>詳細は <a href="../../XFunction/X-Function/X-Function_Builder.html#X-Function_Variable_TypeVariable_Data_Type_and_Default_Value" title="Xファンクション:Xファンクションビルダ">変数のデータ型とデフォルト値 </a>セクション内で参照できます。
</p>
</td></tr>
<tr>
<th> データ
</th>
<td>
<p>変数のデフォルト値を指定します。詳細は <a href="../../XFunction/X-Function/X-Function_Builder.html#X-Function_Variable_TypeVariable_Data_Type_and_Default_Value" title="Xファンクション:Xファンクションビルダ">変数のデータ型とデフォルト値 </a>セクション内で参照できます。
</p>
</td></tr>
<tr>
<th> 制御
</th>
<td>
<p>ダイアログボックスでの変数のコントロール（コンボボックス、スライダーなど）を指定します。 
</p><p>詳細は <a href="../../XFunction/X-Function/X-Function_Builder.html#X-Function_Dialog_ControlsControl_Types" title="Xファンクション:Xファンクションビルダ">制御型</a>セクション内で参照できます。
</p>
</td></tr>
<tr>
<th> オプション文字列
</th>
<td>
<p>変数に対するオプション文字列を指定します。グループのいくつかの変数を一緒にしたり、再計算を有効にするなど、オプション文字列で詳細設定を適用できます。詳細は、<a href="../../XFunction/X-Function/X-Function_Builder.html#X-Function_Option_StringsOption_String" title="Xファンクション:Xファンクションビルダ">オプション文字列</a>セクションの下を参照してください。
</p>
</td></tr>
<tr>
<th> テーマID
</th>
<td>
<p>変数のテーマIDを指定します。割り当てない場合、変数のテーマIDは変数のインデックスを参照します。テーマIDは、Xファンクションダイアログ用のテーマファイルで使用されます。
</p><p>詳細は<a href="../../XFunction/X-Function/X-Function_Builder.html#X-Function_Dialog_ThemeTheme_ID" title="Xファンクション:Xファンクションビルダ">テーマID</a>のセクションを参照してください。
</p>
</td></tr></table>
<h2><a name="X-Function_Variable_TypeVariable_Data_Type_and_Default_Value"></a><span class="mw-headline"><span class="OIndex" style="display:none">X-Function Variable Type</span>変数データタイプとデフォルト値</span></h2>
<p>Xファンクションは、下記のように様々なデータ型を提供します。
</p>
<ol><li> <b>基本データ型</b> 
<ul><li> データ型は double, string, int</li>
<li> デフォルト値は、数値に対しては0、文字列に対しては空です。</li></ul></li>
<li> <b>Originの合成データ型</b>
<ul><li> データ型はvector、vector&lt;string&gt;、vector&lt;complex&gt;、matrix </li>
<li> 例えば、vectorはワークシート列を入力または出力に接続できます。 </li>
<li> デフォルト値は &lt;active&gt;、&lt;new&gt;、&lt;unassigned&gt;にできます。</li>
<li> 詳細はOrigin Cヘルプの<a class="external text" href="../../OriginC/Category/Composite_Data_Types_(class_category).html">Composite Data Types</a>を参照してください。</li></ul></li>
<li> <b>Originオブジェクトタイプ</b> 
<ul><li> データ型は、Column、Range、GraphLayer 、および他のOriginオブジェクトタイプ</li>
<li> デフォルト値は &lt;active&gt;、&lt;new&gt;、&lt;input&gt;、&lt;unassigned&gt;にできます。 </li>
<li> Origin C は、GetNツリー文字列値からOriginオブジェクトを取得する<i>BOOL okxf_resolve_string_get_origin_object(LPCSTR lpcsz, OriginObject* pObj)</i> 関数を提供します。</li>
<li> 詳細は、Origin Cヘルプの<a class="external text" href="../../OriginC/Category/Internal_Origin_Objects_(class_category).html">Internal Origin Objects</a>をご覧ください。</li></ul></li>
<li> <b>TreeNodeタイプ</b>
<ul><li> データ型は、TreeNode, ReportData, ReportTreeです。TreeNode iは入力、ReportData および ReportTreeは出力です。</li></ul></li>
<li> <b> Origin図形オブジェクトコントロール</b>
<ul><li> データ型はButtonInfo, LineInfo, TextInfoなどです。 </li>
<li> Xファンクションビルダで組み込みXファンクションOriginEXE\X-Functions\Data Manipulation\curve translate.OXFを開き、サンプルとして使用法を見ることができます。</li></ul></li>
<li> <b>レポートタイプ</b>
<ul><li> データ型は、 ReportData, ReportTreeです。</li>
<li> 詳細は<a href="../../XFunction/Category/X-Function_Examples.html" title="カテゴリー:Xファンクションサンプル">Xファンクションチュートリアル</a>の章の<a href="../../XFunction/X-Function/X-Function_ReportTree_Example.html" title="Xファンクション:Xファンクションのレポートツリーのサンプル">Xファンクションのレポートツリーサンプル</a> を参照してください。</li></ul></li></ol>
<h2><a name="X-Function_Dialog_ControlsControl_Types"></a><span class="mw-headline"><span class="OIndex" style="display:none">X-Function Dialog Controls</span>制御型</span></h2>
<p>Xファンクションビルダ内の制御列の変数グリッドで異なる制御文字列を指定したら、Xファンクションダイアログでのユーザインターフェースコントロールの異なるタイプを簡単に作成できます。
</p>
<table class="simple">
<tr>
<th> 使用方法
</th>
<th> データ型
</th>
<th> 制御文字列
</th></tr>
<tr>
<td> 数値編集ボックス
</td>
<td> double
</td>
<td> &#160;
</td></tr>
<tr>
<td> テキスト編集ボックス
</td>
<td> string
</td>
<td> &#160;
</td></tr>
<tr>
<td> チェックボックス
</td>
<td> int
</td>
<td> 0|1
</td></tr>
<tr>
<td> コンボボックス
</td>
<td> int
</td>
<td>
<ul><li>string1|string2|string3</li>
<li>CaseA:string1|CaseB:string2|CaseC:string3</li></ul>
</td></tr>
<tr>
<td> 編集可能なコンボボックス
</td>
<td> string
</td>
<td> 変数グリッドの制御列を空白のままにし、下記のコードを<i>xfname_before_execute function</i> 関数 に追加して、<b>var </b>変数制御を編集可能コンボボックスとしてセットします。
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> nGetNDialog <span style="color: #000080;">&gt;</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">)</span>
    trGetN.<span style="color: #000000;">var</span>.<span style="color: #000000;">SetAttribute</span><span style="color: #000000;">(</span>STR_COMBO_ATTRIB, <span style="color: #ff00ff;">&quot;|aa|bb|cc&quot;</span><span style="color: #000000;">)</span>;</pre>
</td></tr>
<tr>
<td> ラジオボックス
</td>
<td> int
</td>
<td> Radio:string1|string2|string3
</td></tr>
<tr>
<td> スライダー
</td>
<td> int/double
</td>
<td> slider:start|end|nstep
</td></tr>
<tr>
<td> カラーリスト
</td>
<td> int
</td>
<td>
<ul><li><i>ColorList</i>, 24 の基本的なカラーパネル</li>
<li><i>Color0</i>, 通常のカラーパネル</li></ul>
</td></tr>
<tr>
<td> グラフブラウザ
</td>
<td> string
</td>
<td>
<ul><li><i>...Graph</i>  - 単一グラフ</li>
<li><i>...Graphs</i> - 複数グラフ</li></ul>
<p>Originは制御文字列GraphBrowserFilterを使って、Origin C関数でグラフブラウザのインターフェース設定をサポートします。詳細は、<a href="../../XFunction/X-Function/Open_Graph_Browser_Dialog_in_X-Function.html" title="Xファンクション:グラフブラウザダイアログをXファンクションで開く">Xファンクショングラフブラウザダイアログのサンプル</a> をご覧ください。
</p>
</td></tr>
<tr>
<td> ファイル参照ボタン付きテキスト編集ボックス
</td>
<td> string
</td>
<td>
<ul><li><i>...File</i> - 単一ファイル</li>
<li><i>...Files</i> - 複数ファイル</li></ul>
</td></tr>
<tr>
<td> グラフ参照ボタン付きテキスト編集ボックス
</td>
<td> string
</td>
<td>
<ul><li><i>...Path</i>, フォルダ選択ダイアログを開きます</li>
<li><i>...Path2</i>, フォルダ参照ダイアログを開きます</li></ul>
<p><b>Note</b>: システム変数<a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#F.2CG">@FBL = 0</a> に設定すると、新しいフォルダブラウザと古いフォルダブラウザの切り替えが可能です。<font color="navy"><i>...Path</i></font>を指定するとフォルダの参照ダイアログが開き、<font color="navy"><i>...Path2</i></font>を指定するとフォルダの選択ダイアログが開きます。
</p>
</td></tr>
<tr>
<td> 名前を付けて保存ブラウザボタン付きテキスト編集ボックス
</td>
<td> string
</td>
<td><i>...Save</i>
</td></tr></table>
<h2><a name="X-Function_Option_StringsOption_String"></a><span class="mw-headline"><span class="OIndex" style="display:none">X-Function Option Strings</span>オプション文字列</span></h2>
<p>オプション文字列で特殊文字列をセットし、変数の操作を指定できます。   例えば、再計算をデフォルトモードでセットしたり、数値の桁数をセットしたり、出力オブジェクトのデフォルト名をセットできます。詳細は、<a href="../../XFunction/X-Function/X-Function_Option_Strings.html" title="Xファンクション:Xファンクションのオプション文字列">リファレンス：Xファンクションのオプション文字列</a>をご覧ください。
</p>
<h2><a name="X-Function_Dialog_ThemeTheme_ID"></a><span class="mw-headline"><span class="OIndex" style="display:none">X-Function Dialog Theme</span>テーマID</span></h2>
<p>テーマIDは、Xファンクションダイアログテーマファイルで使われ、デフォルト値は0です。すべての変数のテーマIDを0(デフォルト)にする場合、テーマファイル内のテーマIDは1から始まる変数のインデックスに従って変換されます。
</p><p>既存のテーマファイルと互換性を持たせるために、変数を既存のXファンクションに挿入したいとき、以下のようにする必要があります。(変数を最後に追加する場合は必要ありません)
</p>
<ol><li> 変数を挿入する前に、テーマIDを0から変数のインデックスに変更します。</li>
<li> 変数を挿入します。 </li>
<li> 繰り返しを避けるため、挿入した変数のテーマIDを最大値にします。</li></ol>
<h2><a name="X-Function_Tree_ViewTree_View"></a><span class="mw-headline"><span class="OIndex" style="display:none">X-Function Tree View</span>ツリービュー</span></h2>
<p>ツリービューボタン<a  class="image"><img alt="Ocguide xf treeview button.png" src="../images/X-Function_Builder/Ocguide_xf_treeview_button.png" width="23"  /></a>をクリックしてツリービューに切り替えます。ツリービュー内の設定は、Xファンクションダイアログを作成したり、OriginメニューにXファンクションを追加したり、ドキュメントを追加する時に主に使用されます。詳細は、次の章のXファンクションを編集するを確認してください。
</p><p><a  class="image"><img alt="Ocguide xf treeview.png" src="../images/X-Function_Builder/Ocguide_xf_treeview.png" width="531"  /></a>
</p>

    