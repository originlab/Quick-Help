<h1 class="firstheading">colmask</h1><div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">メニュー情報</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">概要</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Command_Line_Usage"><span class="tocnumber">3</span> <span class="toctext">コマンドラインでの使用法</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#X-Function_Execution_Options"><span class="tocnumber">4</span> <span class="toctext">Xファンクション実行オプション</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Variables"><span class="tocnumber">5</span> <span class="toctext">変数</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Description"><span class="tocnumber">6</span> <span class="toctext">説明</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Examples"><span class="tocnumber">7</span> <span class="toctext">サンプル</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Related_X-Functions"><span class="tocnumber">8</span> <span class="toctext">関連するXファンクション</span></a></li>
</ul>
</div>

<h2><a name="Menu_Information"></a><span class="mw-headline">メニュー情報</span></h2>
<p>列: 条件でセルをマスク
</p>
<h2><a name="Brief_Information"></a><span class="mw-headline">概要</span></h2>
<p>条件に応じてセルをマスキングします
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">コマンドラインでの使用法</span></h2>
<p><code>
1. colmask irng:=2 cond:=sd nSD:=2; //Mask the cell values in column 2 which outlie 2SD from the mean
</p><p>2. colmask irng:=3 cond:=gt val:=0.3;  //0.3より大きい列3のセルをマスクする
</p><p></code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">Xファンクションの実行オプション</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">スクリプトからXファンクションにアクセスする場合、追加のオプションスイッチについてのページを参照してください。</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">変数</span></h2>
<table class="xfvar">
<tr>
<th width="8%">表示<br />名
</th>
<th width="8%">変数<br />名
</th>
<th width="8%">I/O<br />と<br />データ型
</th>
<th width="8%">デフォルト<br />値
</th>
<th>説明
</th></tr>
<tr>
<td>入力
</td>
<td>irng
</td>
<td>
<p>入力
</p><p>Range
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> マスクする範囲を指定します。
</td></tr>
<tr>
<td>条件
</td>
<td>cond
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> 入力データをマスクする条件を指定します。
<p>オプションリスト：
</p>
<ul><li><i>sd:標準偏差による外れ値Deviation</i>
<dl><dd>入力範囲の平均から標準偏差が離れている値をマスク</dd></dl></li>
<li><i>gt:&gt;</i>
<dl><dd><b>val</b>で指定した値より大きいセル値をマスクします。</dd></dl></li>
<li><i>ge:&gt;=</i>
<dl><dd><b>val</b>で指定した値以上のセル値をマスクします。</dd></dl></li>
<li><i>lt:&lt;</i>
<dl><dd><b>val</b>で指定した値より小さいセル値をマスクします。</dd></dl></li>
<li><i>le:&lt;=</i>
<dl><dd><b>val</b>で指定した値以下のセル値をマスクします。</dd></dl></li>
<li><i>eq:=</i>
<dl><dd><b>val</b>で指定した値に等しいセル値をマスクします。</dd></dl></li>
<li><i>IQRによる外れ値</i>
<dl><dd>IQRは四分位数範囲です。これが選択された場合、[Q1-multiple*IQR, Q3+multiple*IQR]の範囲が計算され、この範囲を超えるデータは外れ値になります。これらの値をマスクします。</dd></dl></li></ul>
</td></tr>
<tr>
<td>SDの倍数/IQRの倍数
</td>
<td>nSD
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> これは、<b>cond</b>変数が<b>sd</b>もしくは<b>iqr</b>にセットされている場合のみ利用できます。ここで指定した数値<i>n </i> は、平均から <i>n</i> 標準偏差が外れている値がマスクされることを意味しています。Origin 2019b以降、非整数値をサポートし、GUIツール（colmaskダイアログ）のコンボボックスに直接値を入力または、次のようにスクリプトを記述できます。 <code>colmask nSD:=1.5;</code>
<p>オプションリスト：
</p>
<ul><li><i>1</i>
<dl><dd>平均から1SD外れているセルの値をマスクします。</dd></dl></li>
<li><i>2</i>
<dl><dd>平均から2SD外れているセルの値をマスクします。</dd></dl></li>
<li><i>3</i>
<dl><dd>平均から3SD外れているセルの値をマスクします。</dd></dl></li>
<li><i>4</i>
<dl><dd>平均から4SD外れているセルの値をマスクします。</dd></dl></li>
<li><i>5</i>
<dl><dd>平均から5SD外れているセルの値をマスクします。</dd></dl></li>
<li><i>6</i>
<dl><dd>平均から6SD外れているセルの値をマスクします。</dd></dl></li></ul>
</td></tr>
<tr>
<td>値
</td>
<td>val
</td>
<td>
<p>入力
</p><p>double
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td> これは、<b>cond</b>変数が<b>sd</b>もしくは<b>iqr</b>でない場合に利用できます。
</td></tr>
<tr>
<td>条件判定に絶対値を使う
</td>
<td>abs
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> これは、<b>cond</b>変数が<b>sd</b>もしくは<b>iqr</b>でない場合に利用できます。条件をテストするために絶対値を使うかどうかを指定します。
</td></tr>
<tr>
<td>既存マスクの保存
</td>
<td>keep
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> 既存のマスクを保存するかどうかをこの変数で指定します。
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">説明</span></h2>
<p>この機能は条件に合う入力値をマスクします。
</p>
<h2><a name="Examples"></a><span class="mw-headline">サンプル</span></h2>
<ol><li>次のステップは、乱数の平均から1標準偏差外れているデータをマスクする簡単な例を示しています。
<ol><li>新しいワークブックを作成します。</li>
<li>「<b>フォーマット：</b><b>ワークシートの表示属性</b>」を選択し、<b>ワークシートプロパティ</b>ダイアログを開きます。<b>サイズ</b>タブをクリックし、<b>行数</b>を10000にします。<b>OK</b> ボタンをクリックします。</li>
<li>A列を選択し、右クリックします。開いたメニューから<b>列値の一律設定: 正規乱数</b>を選択して1列目に正規乱数を入力します。</li>
<li>列を選択したまま、<b>列: 条件でセルをマスクする</b>を選択し、<b>colmask</b>ダイアログを開きます。 </li>
<li>デフォルトの設定のまま、<b>OK</b> をクリックして実行します。1SDより離れた値は赤くマスクされます。</li></ol></li>
<li>次のスクリプトは、256年の黒点数の記録データにおいて、平均から1SD外れている黒点数をマスクする方法を示します。</li></ol>
<pre class="lt" style="font-family:monospace;">newbook;
string fn<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span><span style="color: #000080;">+</span><span style="color: #ff00ff;">&quot;\Samples\Signal Processing\Average Sunspot.dat&quot;</span>;
impasc fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>fn<span style="color: #000080;">$</span>;
colmask irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span> cond<span style="color: #000000;">:</span><span style="color: #000080;">=</span>sd;</pre>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">関連 X ファンクション</span></h2>
<p><a href="../../XFunction/X-Function/Wcellmask.html" title="Xファンクション:Wcellmask">wcellmask</a>
</p>






    