<h1 class="firstheading">hcluster(Pro)</h1><div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">メニュー情報</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">概要</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Additional_Information"><span class="tocnumber">3</span> <span class="toctext">追加の情報</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Command_Line_Usage"><span class="tocnumber">4</span> <span class="toctext">コマンドラインでの使用法</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#X-Function_Execution_Options"><span class="tocnumber">5</span> <span class="toctext">Xファンクション実行オプション</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Variables"><span class="tocnumber">6</span> <span class="toctext">変数</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Description"><span class="tocnumber">7</span> <span class="toctext">説明</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Examples"><span class="tocnumber">8</span> <span class="toctext">サンプル</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Algorithm"><span class="tocnumber">9</span> <span class="toctext">アルゴリズム</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#References"><span class="tocnumber">10</span> <span class="toctext">参考文献</span></a></li>
<li class="toclevel-1 tocsection-11"><a href="#Related_X-Functions"><span class="tocnumber">11</span> <span class="toctext">関連するXファンクション</span></a></li>
</ul>
</div>

<h2><a name="Menu_Information"></a><span class="mw-headline">メニュー情報</span></h2>
<p>統計：多変量解析：階層的クラスター分析
</p>
<h2><a name="Brief_Information"></a><span class="mw-headline">概要</span></h2>
<p>階層的クラスター分析を実行します
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">追加の情報</span></h2>
<p>これはOrigin Proのみの機能です。
</p><p>必要なOriginのバージョン: Origin 8.6
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">コマンドラインでの使用法</span></h2>
<p><code>
</p>
<ol><li> hcluster irng:=2:5 label:=1 number:=2;</li>
<li> hcluster irng:=4:15 obj:=1 number:=3;</li></ol>
<p></code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">Xファンクションの実行オプション</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">スクリプトからXファンクションにアクセスする場合、追加のオプションスイッチについてのページを参照してください。</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">変数</span></h2>
<table class="xfvar">
<tr>
<th width="8%">表示<br />名
</th>
<th width="8%">変数<br />名
</th>
<th width="8%">I/O<br />と<br />データ型
</th>
<th width="8%">デフォルト<br />値
</th>
<th>説明
</th></tr>
<tr>
<td>変数
</td>
<td>irng
</td>
<td>
<p>入力
</p><p>Range
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> 階層的クラスター分析のためのデータ範囲を選択します。Origin 2020b以降、[Book]Sheet!(N1:N2) 形式の短縮構文を使用できます。ここで、N1は列の連続した範囲の開始の列番号、N2は終了の列番号です。[Book]Sheet!([Book]Sheet!N1:N2,[Book]Sheet!N3:N4) の形式の非連続データも使用できます。
</td></tr>
<tr>
<td>観測値ラベル
</td>
<td>label
</td>
<td>
<p>入力
</p><p>Range
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td> 観測値のラベルを選択します。ラベルが選ばれた場合、Ｘ軸目盛りとして樹形図に表示されます。このオプションは、<i>クラスター</i> に <i>観測値</i> を選択したときのみ表示されます。
</td></tr>
<tr>
<td>クラスター
</td>
<td>obj
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> オブジェクトの種類を指定します。
<p>オプションリスト
</p>
<ul><li><i>観測値</i>
<dl><dd> クラスターの観測値です。</dd></dl></li>
<li><i>変数</i>
<dl><dd> クラスターの変数です。</dd></dl></li></ul>
</td></tr>
<tr>
<td>クラスター法
</td>
<td>link
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>2</center>
</td>
<td> クラスターと新規のクラスター間の距離を計算するリンク法を選びます。0から開始する値ですが、明瞭さのために文字列値 (<i>near</i> のような)をお勧めします。
<p>オプションリスト
</p>
<ul><li><i>near:最短距離</i>
<dl><dd> 基準のクラスターからの距離が最も短い2つのクラスターが統合されて新しいクラスターになります。または単連結法とも呼ばれています。</dd></dl></li>
<li><i>furth:最長距離</i>
<dl><dd> 基準のクラスターからの距離が最も長い2つのクラスターが統合されて新しいクラスターになります。または完全連結法とも呼ばれています。</dd></dl></li>
<li><i>group:郡平均</i>
<dl><dd> 2つの距離の平均で2つのクラスターが統合されて新しいクラスターになります。</dd></dl></li>
<li><i>centroid:重心</i>
<dl><dd> 重心はクラスター中心間の距離が最大になるように生成されます。 </dd></dl></li>
<li><i>median: 中央値</i>
<dl><dd> 1つのクラスター内にある物ともう1つのクラスター内にある物の中央値になります。 </dd></dl></li>
<li><i>ward:Ward</i>
<dl><dd> クラスター内分散が最小になるようにクラスターが統合されます。</dd></dl></li></ul>
<p>結合法の詳細については<a class="external text" href="../../UserGuide/UserGuide/Algorithm_(Hierarchical_Cluster_Analysis).html#Linkage_Method">結合法のアルゴリズム</a>をご覧ください。 
</p>
</td></tr>
<tr>
<td>距離のタイプ
</td>
<td>dist1
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> <i>obj</i> が観測値のときに階層的クラスター分析での距離のタイプを選択します。0から開始する値ですが、明瞭さのために文字列値 (<i>euc</i> のような)をお勧めします。
<p>オプションリスト：
</p>
<ul><li><i>euc:ユークリッド距離</i>
<dl><dd> ２つの観測値間の差の二乗和の平方根を取った値です。 </dd></dl></li>
<li><i>squ:平方ユークリッド距離</i>
<dl><dd> ２つの観測値間の差の二乗和を取った値です。</dd></dl></li>
<li><i>city:City block距離</i>
<dl><dd> ２つの観測値間の絶対差を取った値です。またはマンハッタン距離とも呼ばれています。 </dd></dl></li></ul>
</td></tr>
<tr>
<td>距離のタイプ
</td>
<td>dist2
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> <i>obj</i> が<i>変数</i> のときに階層的クラスター分析での距離のタイプを選択します。0から開始する値ですが、明瞭さのために文字列値 (<i>corr</i> のような)をお勧めします。
<p>オプションリスト
</p>
<ul><li><i>corr:相関</i>
<dl><dd> 1と相関した2つの変数の違いをもとにしています。 </dd></dl></li>
<li><i>abs:絶対相関</i>
<dl><dd> 1と絶対相関した2つの変数の違いをもとにしています。</dd></dl></li></ul>
</td></tr>
<tr>
<td>標準化変数
</td>
<td>std
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> 変数を標準化する方法を指定します。このオプションは、<i>obj</i> に <i>観測値</i> を選択したときのみ表示されます。0から開始する値ですが、明瞭さのために文字列値 (<i>snd</i> のような)をお勧めします。
<p>オプションリスト
</p>
<ul><li><i>none:なし</i>
<dl><dd> 変数は標準化されません。 </dd></dl></li>
<li><i>snd:Z スコア (N(0, 1) で正規化)</i>
<dl><dd> 標準正規分布に変数を変換します。 </dd></dl></li>
<li><i>range: (0, 1) に正規化</i>
<dl><dd> 変数は0から1の範囲で変換されます。</dd></dl></li></ul>
</td></tr>
<tr>
<td>クラスターの数
</td>
<td>number
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> クラスターの数を指定します。
</td></tr>
<tr>
<td>クラストロイド検索
</td>
<td>stat
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td><center>0</center>
</td>
<td>クラストロイド（最大/最小代理変数/観測値）を検索する手法を指定します。
<p>オプションリスト
</p>
<ul><li><i>sd:Sum of distances（距離の和）</i>
<dl><dd> クラスター内の全ての観測値/変数から測った距離の和を使用して、クラストロイドを検索します。</dd></dl></li>
<li><i>md:Maximum distance（最大距離）</i>
<dl><dd> クラスター内の全ての観測値/変数から測った距離の中で最大のものを使用してクラストロイドを検索します。 </dd></dl></li>
<li><i>ssd:Sum of squares of distances（距離の二乗和）</i>
<dl><dd> クラスター内の全ての観測値/変数から測った距離の二乗和を使用して、クラストロイドを検索します。 </dd></dl></li></ul>
</td></tr>
<tr>
<td>相違行列
</td>
<td>dissimilarity
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> 距離行列を出力するかどうかを指定します。オブジェクト数が大きい場合、この距離行列はレポート内ではなく個別のワークシートに表示されます。1 = する, 0 = しない
</td></tr>
<tr>
<td>クラスターステージ
</td>
<td>stage
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> クラスターステージを出力するかどうかを指定します。1 = する, 0 = しない
</td></tr>
<tr>
<td>クラスター中心
</td>
<td>center
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> クラスター中心を計算するかどうかを指定できます。このオプションは、<i>obj</i> に <i>観測値</i> を選択したときのみ表示されます。1 = する, 0 = しない
</td></tr>
<tr>
<td>クラスター中心間の距離
</td>
<td>distc2c
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> クラスター中心間の距離を計算するかどうかを指定できます。このオプションは、<i>obj</i> に <i>観測値</i> を選択したときのみ表示されます。1 = する, 0 = しない
</td></tr>
<tr>
<td>観測とクラスター間の距離
</td>
<td>disto2c
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> 各観測値とクラスター中心間の距離を計算するかどうかを指定できます。このオプションは、<i>obj</i> に <i>観測値</i> を選択したときのみ表示されます。1 = する, 0 = しない
</td></tr>
<tr>
<td>樹形図
</td>
<td>dendrogram
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> 樹形図を表示するかどうかを指定できます。1 = する, 0 = しない
</td></tr>
<tr>
<td>樹形図を表示
</td>
<td>ngraph
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> 樹形図を１つのグラフで表示するかクラスターごとに別々に表示するかを指定します。これは<b>樹形図</b>が1のときのみ利用できます。0から始まる値です。
<p>オプションリスト
</p>
<ul><li> 樹形図を１つのグラフ内に表示します。別々のクラスターは色分けされています。 </li>
<li> クラスターの樹形図を別々のグラフとして表示します。各クラスターごとに1つのグラフになります。</li></ul>
</td></tr>
<tr>
<td>方向
</td>
<td>orient
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center> 0 </center>
</td>
<td> 樹形図の向きを指定します。これは<b>樹形図</b>にチェックがついている時のみ利用できます。
<p>オプションリスト
</p>
<ul><li><i>0: 垂直</i>
<dl><dd>樹形図を垂直にプロットします。</dd></dl></li>
<li><i>1: 水平</i>
<dl><dd>樹形図を水平にプロットします。</dd></dl></li>
<li><i>2: 円</i>
<dl><dd>円形の樹形図をプロットします。</dd></dl></li></ul>
</td></tr>
<tr>
<td>クラスターレポート
</td>
<td>rt
</td>
<td>
<p>出力
</p><p>ReportTree
</p>
</td>
<td> <center>&lt;new&gt;</center>
</td>
<td> 階層的クラスター分析レポートのシートを指定します。
</td></tr>
<tr>
<td>クラスターメンバーシップ
</td>
<td>rd
</td>
<td>
<p>出力
</p><p>ReportData
</p>
</td>
<td> <center>&lt;新規&gt;</center>
</td>
<td> クラスターメンバーシップと観測値とクラスター間の距離を表示するシートを指定します。
</td></tr>
<tr>
<td>距離行列
</td>
<td>rddist
</td>
<td>
<p>出力
</p><p>ReportData
</p>
</td>
<td> <center>&lt;新規&gt;</center>
</td>
<td> クラスターのためのオブジェクトの数が大きすぎるときに距離行列のためのシートを指定します。これはダイアログでは表示されません。
</td></tr>
<tr>
<td>プロットデータ
</td>
<td>rdplot
</td>
<td>
<p>出力
</p><p>ReportData
</p>
</td>
<td> <center>&lt;new&gt;</center>
</td>
<td> プロットデータのためのシートを指定します。これはダイアログでは表示されません。
</td></tr>
<tr>
<td>クラストロイド情報
</td>
<td>clustroid
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> クラストロイド（最大/最小代理変数/観測値）情報を検索する手法を指定します。
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">説明</span></h2>
<p>この関数は、範囲データに対して<b>階層的クラスター分析</b>を実行します。詳細情報は、 <a class="external text" href="../../UserGuide/Category/Cluster_Analysis.html">クラスター分析</a>をご覧下さい。
</p>
<h2><a name="Examples"></a><span class="mw-headline">サンプル</span></h2>
<ol><li> <b>\Samples\Graphing\US Mean Temperature.dat</b>ファイルをインポートします。</li>
<li> 次のスクリプトを実行します。</li></ol>
<pre class="lt" style="font-family:monospace;">hcluster irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span><span style="color: #000000;">[</span><span style="color: #0000dd;">1</span><span style="color: #000000;">]</span><span style="color: #000000;">:</span><span style="color: #0000dd;">15</span><span style="color: #000000;">[</span><span style="color: #0000dd;">100</span><span style="color: #000000;">]</span> number<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">5</span> rd<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span><span style="color: #000080;">&lt;</span>input<span style="color: #000080;">&gt;</span><span style="color: #000000;">]</span><span style="color: #000080;">&lt;</span>input<span style="color: #000080;">&gt;</span> <span style="color: #000080;">-</span>r <span style="color: #0000dd;">2</span>;</pre>
<h2><a name="Algorithm"></a><span class="mw-headline">アルゴリズム</span></h2>
<p><a class="external text" href="../../UserGuide/UserGuide/Algorithm_(Hierarchical_Cluster_Analysis).html"><b>階層的クラスター分析</b>のアルゴリズム</a>をご覧ください。
</p>
<h2><a name="References"></a><span class="mw-headline">参考文献</span></h2>
<p><a class="external text" href="../../UserGuide/UserGuide/Reference_(Cluster_Analysis).html"><b>階層的クラスター分析</b>の参考文献</a>をご覧ください。
</p>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">関連 X ファンクション</span></h2>
<p><a href="../../XFunction/X-Function/Pca.html" title="Xファンクション:Pca">pca</a>, <a href="../../XFunction/X-Function/Kmeans.html" title="Xファンクション:Kmeans">kmeans</a>, <a href="../../XFunction/X-Function/Discrim.html" title="Xファンクション:Discrim">discrim</a>
</p>






    