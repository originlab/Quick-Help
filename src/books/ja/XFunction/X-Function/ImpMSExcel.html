<h1 class="firstheading">impMSExcel</h1>
<p><br /></p>
<div id="toc" class="toc">
<div id="toctitle">
<h2>内容</h2>
</div>
<ol>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">メニュー情報</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">概要</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Command_Line_Usage"><span class="tocnumber">3</span> <span class="toctext">コマンドラインの使用法</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Variables"><span class="tocnumber">4</span> <span class="toctext">変数</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Description"><span class="tocnumber">5</span> <span class="toctext">説明</span></a>
<ol>
<li class="toclevel-2 tocsection-6"><a href="#Options_Tree_Details"><span class="tocnumber">5.1</span> <span class="toctext">オプションツリーの詳細</span></a></li>
</ol>
</li>
<li class="toclevel-1 tocsection-7"><a href="#Examples"><span class="tocnumber">6</span> <span class="toctext">サンプル</span></a>
<ol>
<li class="toclevel-2"><a href="#Example_1"><span class="tocnumber">6.1</span> <span class="toctext">サンプル 1</span></a></li>
<li class="toclevel-2"><a href="#Example_2"><span class="tocnumber">6.2</span> <span class="toctext">サンプル 2</span></a></li>
</ol>
</li>
<li class="toclevel-1 tocsection-8"><a href="#Related_X-Functions"><span class="tocnumber">7</span> <span class="toctext">関連するXファンクション</span></a></li>
</ol>
</div>
<h2><a name="Menu_Information" id="Menu_Information"></a><span class="mw-headline">メニュー情報</span></h2>
<p>ファイル：インポート：Excel(XLS,XLSX,XLSM)</p>
<h2><a name="Brief_Information" id="Brief_Information"></a><span class="mw-headline">概要</span></h2>
<p>Excelを使用せずに、Excel (XLS, XLSX....)ファイルをOriginに直接インポートします。</p>
<p>Origin 2017より前のバージョンでは、OriginでXLSXファイルを開くためにバックグラウンドでExcelを起動するもう一つのXファンクション(<a href="../../XFunction/X-Function/ImpExcel.html" title="Xファンクション:ImpExcel">impExcel</a>参照) を使用していました。</p>
<h2><a name="Command_Line_Usage" id="Command_Line_Usage"></a><span class="mw-headline">コマンドラインでの使用法</span></h2>
<p><code style="font-family: monospace;">1. fname$="sample.xls"; impMSExcel; // sample.xlsファイルをインポート</code></p>
<p><code style="font-family: monospace;">2. impMSExcel fname:="c:\test1.xlsxt%(crlf)c:\test2.xlsx" options.sparklines:=1 options.Mode:=4 options.headers.LongName:=1 options.headers.Units:=2;</code></p>
<h2><a name="Variables" id="Variables"></a><span class="mw-headline">変数</span></h2>
<table class="TableGrid" style="border-collapse: separate; border-collapse: separate;" border="1">
<tr>
<td>
<p style="text-align: center;"><b style="font-weight: bold;">表示名</b></p>
</td>
<td>
<p style="text-align: center;"><b style="font-weight: bold;">変数名</b></p>
</td>
<td>
<p style="text-align: center;"><b style="font-weight: bold;">I/O</b> <b>と</b> <b>データ型</b></p>
</td>
<td>
<p style="text-align: center;"><b style="font-weight: bold;">デフォルト値</b></p>
</td>
<td>
<p style="text-align: center;"><b style="font-weight: bold;">説明</b></p>
</td>
</tr>
<tr>
<td>
<p style="text-align: center;">ファイル名</p>
</td>
<td>
<p style="text-align: center;">fname</p>
</td>
<td>
<p>入力</p>
<p>string</p>
</td>
<td>
<p style="text-align: center;">fname$</p>
</td>
<td>
<p>インポートするファイルのファイル名</p>
</td>
</tr>
<tr>
<td>
<p style="text-align: center;">ファイル情報</p>
</td>
<td>
<p style="text-align: center;">trfiles</p>
</td>
<td>
<p>入力</p>
<p>TreeNode</p>
</td>
<td>
<p style="text-align: center;">&lt;unassigned&gt;</p>
</td>
<td>
<p>ファイルサイズを表示するためにダイアログで使用されます。情報はOriginが自動的に探します。</p>
</td>
</tr>
<tr>
<td>
<p style="text-align: center;">インポートオプション</p>
</td>
<td>
<p style="text-align: center;"><a href="../../XFunction/X-Function/Details_of_TreeNodes_in_Import_MSExcel.html" title="Xファンクション: MSExcelインポートのツリーノードに関する詳細" style="color: #0000ff; text-decoration: underline;">options</a></p>
</td>
<td>
<p>入力</p>
<p>TreeNode</p>
</td>
<td>
<p style="text-align: center;">&lt;unassigned&gt;</p>
</td>
<td>
<p>これは主にダイアログ内で使用され、インポートオプションを修正する際に使用します。</p>
<p>詳細は説明をご覧ください</p>
</td>
</tr>
<tr>
<td>
<p style="text-align: center;">出力</p>
</td>
<td>
<p style="text-align: center;">orng</p>
</td>
<td>
<p>出力</p>
<p>範囲</p>
</td>
<td>
<p style="text-align: center;">&lt;active&gt;</p>
</td>
<td>
<p>これは出力範囲を指定するのに使用します。</p>
</td>
</tr>
<tr>
<td>
<p style="text-align: center;">ヘッダ情報</p>
</td>
<td>
<p style="text-align: center;">trheader</p>
</td>
<td>
<p>出力</p>
<p>TreeNode</p>
</td>
<td>
<p style="text-align: center;">&lt;optional&gt;</p>
</td>
<td>
<p>ヘッダ情報出力のオプションです。GUIでは表示されません。ユーザが、この変数を使用することはお勧めできません。</p>
</td>
</tr>
<tr>
<td>
<p>繰り返しインポート</p>
</td>
<td>
<p style="text-align: center;">reimp</p>
</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">0</p>
</td>
<td>
<p>現在のインポートが再インポートの処理かどうか指定します。GUIでは表示されません。この変数の使用はお勧めされません。</p>
</td>
</tr>
</table>
<h2><a name="Description" id="Description"></a><span class="mw-headline">説明</span></h2>
<p>このXファンクションはMicrosoft Excelファイルをインポートするのに使います。COMを使用しないので、Excelがインストールされていなくても.XLS、.XLSX、.XLSMファイルをインポートできます。</p>
<ul>
<li>メニューから操作：<b>ファイル：インポート：Excel(XLS,XLSX,XLSM)</b>を選びます。</li>
<li>コマンド入力の場合、
<pre class="lt" style="font-family: monospace;">
impMSExcel <span style="color: #000080;">-</span>d
        
</pre>
とコマンドウィンドウで入力します。</li>
</ul>
<p>インポートしたExcelウィンドウには1シート以上がある可能性があります。全てのシートは目的のワークブックで別々のワークシートに、同じインポートの設定でインポートされます。インポート設定の詳細はオプションツリーの詳細セクションをご覧ください。</p>
<p>Origin 2015では、ExcelからOriginに複数のシートを再インポートできます。Excel再インポートの間、Originが最新のデータを使用するためにリンクは維持されます。Excelファイルを再インポートする場合、</p>
<ul>
<li>メニューから<b>ファイル: 即時再インポート</b>を選択するか、ショートカットキーCtrl+4 で、以前の同じ設定でExcelシートをインポートできます。</li>
<li>メニューから<b>ファイル: 再インポート...</b>を選択して、再インポートのためのファイルのインポート設定を変更します。</li>
<li>コマンド入力の場合
<pre class="lt" style="font-family: monospace;">
reimport <span style="color: #000080;">-</span>d
        
</pre>
とコマンドウィンドウで入力するとExcelファイルを再インポートします。</li>
</ul>
<p>Origin2016から導入された&lt;クローン&gt;テンプレートを使用すると、用意したワークブックテンプレートまたは分析テンプレートに、Excelブックのカスタマイズ/分析データを一括処理するためにExcelワークブックをインポートすることが出来ます。詳細はオプションツリーの詳細セクションをご覧ください。</p>
<h3><a name="Options_Tree_Details" id="Options_Tree_Details"></a><span class="mw-headline">オプションツリーの詳細</span></h3>
<dl>
<dd>
<ul>
<li><b style="font-weight: bold;">インポートオプションツリー</b></li>
</ul>
<dl>
<dd>利用可能な多くのインポートオプションの詳細については<a href="../../XFunction/X-Function/Details_of_TreeNodes_in_Import_MSExcel.html" title="Xファンクション: MSExcelインポートのツリーノードに関する詳細">impMSExcelオプションツリーノードの情報ページ</a>をご覧ください。</dd>
</dl>
</dd>
</dl>
<h2><a name="Examples" id="Examples"></a><span class="mw-headline">サンプル</span></h2>
<h3><a name="Example_1" id="Example_1"></a><span class="mw-headline">サンプル 1</span></h3>
<p>以下のサンプルはExcelファイルを工場出荷時のデフォルト設定でインポートします。</p>
<ol>
<li>新規ワークブックを開きます。Originのメニューから操作するには、<b>ファイル：インポート：Excel(XLS,XLSX,XLSM)を選びます。</b> これは<b>Excel</b> ダイアログを開き、インポートファイルを選択します。</li>
<li><i style="font-style: italic;">&lt;Originインストールフォルダ&gt;/Samples/Import and Export/United States Energy (1980-2013).xls</i>ファイルを選択します。<b>ファイルの追加</b>ボタンをクリックします。<b>オプションダイアログを表示する</b>チェックボックスにチェックが付いている事を確認して<b>OK</b>をクリックします。</li>
<li>表示された<b>impMSExcel</b>ダイアログボックスで、以下の画像のようにヘッダ行を指定します。<b>Ok</b>をクリックしてExcelファイルをインポートします。</li>
</ol>
<dl>
<dd><a class="image" style="color: #0000ff; text-decoration: underline;"><img alt="ImportMSExcel 01.png" src="../images/ImpMSExcel/ImportMSExcel_01.png" width="407" height="263" border="0" /></a></dd>
</dl>
<h3><a name="Example_2" id="Example_2"></a><span class="mw-headline">サンプル 2</span></h3>
<p>以下のコマンドはExcelファイル(c:\test.xls)をダイアログを開くことなくインポートするスクリプトです。</p>
<pre class="lt" style="font-family: monospace;">
newbook; string fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">"Samples\Graphing\Excel Data.xls"</span>; impMSExcel options.<span style="color: #000080;">cellfmts</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> options.<span style="color: #000080;">headers</span>.<span style="color: #000080;">MainheaderLines</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> options.<span style="color: #000080;">headers</span>.<span style="color: #000080;">SubheaderLines</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> options.<span style="color: #000080;">headers</span>.<span style="color: #000080;">LongName</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>; <span style="color: #008000;">//copy cell format of Excel file while importing</span>
</pre>
<h2><a name="Related_X-Functions" id="Related_X-Functions"></a><span class="mw-headline">関係する X ファンクション</span></h2>
<p><a href="../../XFunction/X-Function/ImpFile.html" title="Xファンクション:ImpFile">impfile</a>, <a href="../../XFunction/X-Function/Impinfo.html" title="Xファンクション:Impinfo">impinfo</a>, <a href="../../XFunction/X-Function/ImpExcel.html" title="Xファンクション:ImpExcel">impExcel</a></p>
