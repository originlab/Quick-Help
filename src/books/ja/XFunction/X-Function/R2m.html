<h1 class="firstheading">r2m</h1><div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Brief_Information"><span class="tocnumber">1</span><span class="toctext">概要</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Command_Line_Usage"><span class="tocnumber">2</span> <span class="toctext">コマンドラインでの使用法</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#X-Function_Execution_Options"><span class="tocnumber">3</span> <span class="toctext">Xファンクション実行オプション</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Variables"><span class="tocnumber">4</span> <span class="toctext">変数</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Description"><span class="tocnumber">5</span> <span class="toctext">説明</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Examples"><span class="tocnumber">6</span> <span class="toctext">サンプル</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Related_X-Functions"><span class="tocnumber">7</span><span class="toctext">関連するXファンクション</span></a></li>
</ul>
</div>

<h2><a name="Brief_Information"></a><span class="mw-headline">概要</span></h2>
<p>ワークシートのセルの範囲を行列へ変換します
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">コマンドラインでの使用法</span></h2>
<p><code>
1. r2m irng:=[Book1]Sheet1!Col(1)[1]:Col(4)[5]
</p><p>2. r2m irng:=[Book1]Sheet1!Col(1)[1]:Col(4)[5] om:=[MBook1]MSheet1!Mat(1)
</code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">Xファンクションの実行オプション</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">スクリプトからXファンクションにアクセスする場合、追加のオプションスイッチについてのページを参照してください。</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">変数</span></h2>
<table class="xfvar">
<tr>
<th width="8%">表示<br />名
</th>
<th width="8%">変数<br />名
</th>
<th width="8%">I/O<br />と<br />データ型
</th>
<th width="8%">デフォルト<br />値
</th>
<th>説明
</th></tr>
<tr>
<td>入力
</td>
<td>irng
</td>
<td>
<p>入力
</p><p>Range
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td>
<p>入力データ範囲を指定します。
</p>
</td></tr>
<tr>
<td>データフォーマット
</td>
<td>xy
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>noxy</center>
</td>
<td> XおよびY座標を指定します。
<p>オプションリスト：
</p>
<ul><li><i>xcol:列方向のX</i></li></ul>
<dl><dd>0.ソース入力データの行の値（列を横断）からX座標を指定します。</dd></dl>
<ul><li><i>ycol:列方向のY</i></li></ul>
<dl><dd>1.ソース入力データの行の値（列を横断）からY座標を指定します。</dd></dl>
<ul><li><i>noxy:X、Yなし</i></li></ul>
<dl><dd>2.XおよびY座標を指定せずに入力データ範囲を直接指定します。XおよびY座標は整数値になります。</dd></dl>
</td></tr>
<tr>
<td>Xデータの場所
</td>
<td>xlabel
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center></center>
</td>
<td> <b>データフォーマット</b>で<b>列方向のX</b>が選択されている場合に利用できます。入力データの最初の行または列ラベル行を選択できます。
<p>オプションリスト：
</p>
<ul><li><i>none:なし</i></li></ul>
<dl><dd>行列列インデックスをX座標として使用します。</dd></dl>
<ul><li><i>row1:第1データ行</i></li></ul>
<dl><dd>最初のデータ行の値をX座標として使用します。</dd></dl>
<ul><li><i>param:列ラベル</i></li></ul>
<dl><dd>列ラベル行の値をX座標として使用します。</dd></dl>
</td></tr>
<tr>
<td>第1列がYデータ
</td>
<td>ycol
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> <b>データフォーマット</b>で<b>列方向のX</b>が選択されている場合に利用できます。最初の列の値をY座標として使用します。
</td></tr>
<tr>
<td>Yデータの場所
</td>
<td>ylabel
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center></center>
</td>
<td> <b>データフォーマット</b>で<b>列方向のY</b>が選択されている場合に利用できます。入力データの最初の行または列ラベル行を選択できます。
<p>オプションリスト：
</p>
<ul><li><i>none:なし</i></li></ul>
<dl><dd>行列行インデックスをY座標として使用します。</dd></dl>
<ul><li><i>row1:第1データ行</i></li></ul>
<dl><dd>最初のデータ行の値をY座標として使用します。</dd></dl>
<ul><li><i>param:列ラベル</i></li></ul>
<dl><dd>列ラベル行の値をY座標として使用します。</dd></dl>
</td></tr>
<tr>
<td>第1列がYデータ
</td>
<td>xcol
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> <b>データフォーマット</b>で<i>列方向のY</i>が選択されている場合に利用できます。最初の列の値をX座標として使用します。
</td></tr>
<tr>
<td>列ラベル
</td>
<td>param
</td>
<td>
<p>入力
</p><p>string
</p>
</td>
<td> <center></center>
</td>
<td> <b>X値の位置</b>または<b>Y値の位置</b>で<i>列ラベル</i>を選択した場合に有効です。ラベル行を表す文字を使ってXまたはY座標として使用するラベル行を指定します。各列ラベル行を示す文字については<a class="external text" href="../../LabTalk/LabTalk/Column_Label_Row_Characters.html">Column Label Row Characters</a>を参照してください。
</td></tr>
<tr>
<td>等間隔判定の許容値(%)
</td>
<td>tol
</td>
<td>
<p>入力
</p><p>double
</p>
</td>
<td> <center>5</center>
</td>
<td> 等間隔か確認するために使用する許容値です。
</td></tr>
<tr>
<td>座標に対する線形フィットでの予測値を使用
</td>
<td>lr
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> このチェックボックスで座標に対して線形フィットでの予測値を使用するかどうかを指定します。
</td></tr>
<tr>
<td>欠損値の調整
</td>
<td>trim
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> 欠損行または列を削除するか指定します。
</td></tr>
<tr>
<td>出力行列
</td>
<td>om
</td>
<td>
<p>出力
</p><p>MatrixObject
</p>
</td>
<td> <center>&lt;新規&gt;</center>
</td>
<td>
<p>出力行列を指定します。
</p><p><a class="external text" href="../../XFunction/X-Function/Output_Notations.html">このシンタックス</a>を参照してください。
</p>
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">説明</span></h2>
<p>この関数は、ワークシートデータ範囲を直接行列に変換し、自動的に行列座標を割り当てます。ワークシートから行列への変換についての詳細は、<i>w2m</i> Xファンクションのヘルプをご覧下さい。
</p>
<h2><a name="Examples"></a><span class="mw-headline">サンプル</span></h2>
<ul><li> コマンドウィンドウから実行</li></ul>
<p>1.  \<i>Samples</i>\<i>Matrix Conversion and Gridding\DirectXY.dat</i>ファイルをインポートします。
</p><p>2.  コマンドウィンドウに次のスクリプトを入力します。 
<code>r2m irng:=!Col(1)[1]:Col(4)[5];</code>
</p><p>スクリプト実行後、ワークシートデータの指定範囲が直接行列に変換されます。
</p>
<ul><li> コードサンプル</li></ul>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000; font-style: regular;">/*
ワークシート範囲データを行列に変換するサンプルです。
サンプルデータは、exe_パス\Samples\Matrix Conversion and Gridding\DirectXY.dat です。
1.新しく作成したワークブックにデータをロード
2.ワークシート範囲を行列に変換
*/</span>
<span style="color: #008000;">// サンプルファイル名を取得</span>
fn<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Matrix Conversion and Gridding\DirectXY.dat&quot;</span>;
<span style="color: #008000;">// 新規ワークブック</span>
newbook;
<span style="color: #008000;">// アクティブワークシートデータをインポート</span>
impASC fn<span style="color: #000080;">$</span>;

<span style="color: #008000;">// ワークシート範囲を行列に変換</span>
r2m irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000080;">!</span>Col<span style="color: #000000;">(</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span><span style="color: #000000;">[</span><span style="color: #0000dd;">2</span><span style="color: #000000;">]</span><span style="color: #000000;">:</span>Col<span style="color: #000000;">(</span><span style="color: #0000dd;">5</span><span style="color: #000000;">)</span><span style="color: #000000;">[</span><span style="color: #0000dd;">6</span><span style="color: #000000;">]</span>;</pre>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">関連するXファンクション</span></h2>
<p><a href="../../XFunction/X-Function/M2v.html" title="Xファンクション:M2v">m2v</a>, <a href="../../XFunction/X-Function/W2m.html" title="Xファンクション:W2m">w2m</a>, <a href="../../XFunction/X-Function/Wexpand2m.html" title="Xファンクション:Wexpand2m">wexpand2m</a>
</p>
<hr class='keywordshr'><p><span class='keywords'>キーワード:</span><span class='keywordsInput'>直接, xyz, 拡張, グリッディング</span></p>







    