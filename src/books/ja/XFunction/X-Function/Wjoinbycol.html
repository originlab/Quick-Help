<h1 class="firstheading">wjoinbycol</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Brief_Information"><span class="tocnumber">1</span> <span class="toctext">概要</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Additional_Information"><span class="tocnumber">2</span> <span class="toctext">追加の情報</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Command_Line_Usage"><span class="tocnumber">3</span> <span class="toctext">コマンドラインでの使用法</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#X-Function_Execution_Options"><span class="tocnumber">4</span> <span class="toctext">Xファンクションの実行オプション</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Variables"><span class="tocnumber">5</span> <span class="toctext">変数</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Description"><span class="tocnumber">6</span> <span class="toctext">説明</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Examples"><span class="tocnumber">7</span> <span class="toctext">サンプル</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Related_X-Functions"><span class="tocnumber">8</span> <span class="toctext">関連するXファンクション</span></a></li>
</ul>
</div>

<h2><a name="Brief_Information"></a><span class="mw-headline">概要</span></h2>
<p>データ整形：列で複数シートを結合する
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">追加の情報</span></h2>
<p class="version" >必要なOriginのバージョン: Origin 2015 SR0以降</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">コマンドラインでの使用法</span></h2>
<p><code>
1. wjoinbycol irng:=([Book1]Sheet1,[Book2]Sheet1) condition:=&quot;[Book1]Sheet1!A=[Book2]Sheet1!A&quot;
</p><p>2. wjoinbycol irng:=([Book1]B1,[Book1]B2,[Book2]B1,[Book2]B2) condition:=&quot;[Book1]B1!A=[Book1]B2!A=[Book2]B1!A=[Book2]B2!A&quot; unmatch:=1 combine:=0 missing:=1;
</p><p></code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">Xファンクションの実行オプション</span></h2>
<p>スクリプトからXファンクションにアクセスする場合、追加のオプションスイッチについての<a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">ページ</a>を参照してください。
</p>
<h2><a name="Variables"></a><span class="mw-headline">変数</span></h2>
<table class="xfvar">
<tr>
<th width="8%">表示<br />名
</th>
<th width="8%">変数<br />名
</th>
<th width="8%">I/O<br />と<br />データ型
</th>
<th width="8%">デフォルト<br />値
</th>
<th>説明
</th></tr>
<tr>
<td>入力ワークシート
</td>
<td>irng
</td>
<td>
<p>入力
</p><p>Range
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td>
<p>入力ワークシートデータ範囲を指定 
</p><p>シンタックス: <b>([<i>BookName1</i>]<i>SheetName1</i>!, [<i>BookName2</i>]<i>SheetName2</i>!)</b>.
</p>
</td></tr>
<tr>
<td>一致する列
</td>
<td>condition
</td>
<td>
<p>入力
</p><p>string
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td>
<p>irngで定義された入力ワークシートと並行して、ワークシートを結合するための一致する列条件を指定します。コネクタとして「=」を使用します。一致する列の全ての値は比較され、一致した行は結果ワークシートで同じ行として結合されます。
</p><p>完全なシンタックスは: <br /><b>[<i>BookName1</i>]<i>SheetName1</i>!<i>ColumnShortName1</i>=[<i>BookName2</i>]<i>SheetName2</i>!<i>ColumnShortName2</i></b>
</p><p><b>ロングネーム</b>が入力シート間で共有されている場合、等号「=」を付けずに、列のロングネームまたはショートネーム（ロングネームが最初の照合に使用されます）のみを入力できます。これは、入力したすべてのシートで指定された名前のすべての列が一致する必要があることを意味します。たとえば、「<i>Time</i>」が<b>一致する列</b>として入力された場合、選択されたすべてのシートの列「Time」のすべての値が比較され、一致した行が結果ワークシートの同じ行として結合されます。ワークシートに列「時間」がない場合、そのシートは削除されます。 
</p>
</td></tr>
<tr>
<td>ソート出力
</td>
<td>sort
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td><center>2</center>
</td>
<td>
<p>結果シートの計算値の順序を制御します。次の3つのオプションを使用できます。
</p>
<dl><dd>0= <i>一致する列 -- 昇順</i> </dd>
<dd>1= <i>一致する列 -- 降順</i> </dd>
<dd>2= <i>最初のシートの順序を保持</i> </dd></dl>
<p><b>一致した列を一つに統合</b>が選択されていない場合、<b>一致する列 -- 昇順/降順</b>は、最初のシート順序で列を一致させるのではなく、出力列を並べ替えます。
</p>
</td></tr>
<tr>
<td>非一致を削除
</td>
<td>unmatch
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>一致しない値を削除するかどうか指定します。 
</p>
<dl><dd>0 = 削除せず、欠損値で埋める </dd>
<dd>1 = 一致しない値を削除</dd></dl>
</td></tr>
<tr>
<td>重複を削除
</td>
<td>multiple
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>1つの値に対して一致するセルが複数ある場合に使用されるオプションです。最初に一致したデータ行以外を削除するかどうかを指定します。0 = 削除しない, 1 = 削除
</p><p><i>multiple</i> が<b>1</b>の場合、結果ワークシートには最初に一致した値のみが含まれます。 
</p>
</td></tr>
<tr>
<td>全ての組み合わせに合致
</td>
<td>combine
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td>
<p>1つの値に対して一致するセルが複数ある場合に使用されるオプションです。結果ワークシート中にすべての可能な組み合わせを表示するか指定します。 
</p>
<dl><dd>0= 全ての組み合わせを表示せず、欠損値がある組み合わせがないようほかの列を埋めます </dd>
<dd>1= 全ての組み合わせを表示します</dd></dl>
</td></tr>
<tr>
<td>一致した列を1つに統合
</td>
<td>merge
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td>
<p>結果ワークシート内の一致した列のみ保持するか指定します。 
</p>
<dl><dd>0 = 保持せず、結果シートには複数の一致列がある, </dd>
<dd>1 = 結果ワークシート内の一致した列のみを表示しますこの場合、一致する1つの列のみが最初の列として結果ワークシートに表示され、データ列は並べて配置されます。</dd></dl>
</td></tr>
<tr>
<td>欠損値を考慮する
</td>
<td>missing
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>一致した列の欠損値行を無視するか指定します。 
</p>
<dl><dd>0 =一致する列に欠落している値がある場合、結果シートではデータ行全体が無視されます。 </dd>
<dd>1 =一致する列にある欠落値は、個別のグループとして扱われます。  </dd></dl>
</td></tr>
<tr>
<td>データセット識別子
</td>
<td>id
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>ソースデータセットの識別子を指定します。
<p>0 = なし, 1 = 範囲, 2 = ブック名, 3 = シート名, 4 =インデックスで作成された<b>行番号</b>を使用してデータセットソースを指定, 5 = ソースワークシートのシートラベルを表示
</p>
</td></tr>
<tr>
<td>インデックス
</td>
<td>index
</td>
<td>
<p>入力
</p><p>string
</p>
</td>
<td> <center>&lt;自動&gt;</center>
</td>
<td>id=4のときに利用できます。識別子のインデックスを指定します。
<p>フォーマットは、<b><i>開始</i>：<i>増分</i></b>です。例えば、&rdquo;1:2&rdquo;の場合はソースワークシートを1,3,5...として指定します。
</p>
</td></tr>
<tr>
<td>出力ワークシート
</td>
<td>ow
</td>
<td>
<p>出力
</p><p>Worksheet
</p>
</td>
<td> <center>&lt;new&gt;</center>
</td>
<td>
<p>出力範囲を指定します。シンタックスは<a href="../../XFunction/X-Function/Output_Notations.html" title="Xファンクション:Output Notations">こちら</a>です。
</p>
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">説明</span></h2>
<p>このXファンクションはLabTalkスクリプトで使用できます。複数ワークシートを結合して1つにまとめます。組み合わせは各入力ワークシート内の一致した列で決定されます。特別なケースでの値の扱いを設定するオプションがあります。例えば、一致列が複数ある場合、一致する値がない場合、欠損値がある場合などです。 
</p><p>2つのワークシートを組み合わせる場合は、<a class="external text" href="../../UserGuide/UserGuide/Join_Worksheets_by_Column.html">列でワークシートを結合する</a>ツールを使用することもできます。
</p>
<h2><a name="Examples"></a><span class="mw-headline">サンプル</span></h2>
<p>一致する列でワークシートを組み合わせる簡単なサンプルです。一致する列のデータは日付です。
</p>
<ol>
<li>新しいOriginプロジェクトを作成し、<b>ウィンドウ：スクリプトウィンドウ</b>を選択して<b>スクリプトウィンドウ</b>を開き、以下のスクリプトを実行してソースデータシートを用意します。</li>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// ワークシートが2つのブックを作製</span>
newbook name<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;JoinWksEx&quot;</span> sheet<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span> option<span style="color: #000000;">:</span><span style="color: #000080;">=</span>lsname;
<span style="color: #008000;">// Sheet 1のA列に2014/10/1から2014/10/25までのパターンデータを入力</span>
patternD irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span>JoinWksEx<span style="color: #000000;">]</span>Sheet1<span style="color: #000080;">!</span>col<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span> from<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2456931</span> to<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2456955</span> unit<span style="color: #000000;">:</span><span style="color: #000080;">=</span>day;
<span style="color: #008000;">// Sheet 1ｍｐ列Bに行番号を入力</span>
patternN irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span>JoinWksEx<span style="color: #000000;">]</span>Sheet1<span style="color: #000080;">!</span>col<span style="color: #000000;">(</span>B<span style="color: #000000;">)</span> to<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">25</span>;
<span style="color: #008000;">// Sheet 2の列Aを2014/10/10から2014/10/30までのパターンデータを異なる表示形式で入力</span>
patternD irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span>JoinWksEx<span style="color: #000000;">]</span>Sheet2<span style="color: #000080;">!</span>col<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span> display<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">19</span> from<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2456940</span> to<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2456960</span> unit<span style="color: #000000;">:</span><span style="color: #000080;">=</span>day;
<span style="color: #008000;">// Sheet 2の列Bに10から30の番号を入力</span>
patternN irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span>JoinWksEx<span style="color: #000000;">]</span>Sheet2<span style="color: #000080;">!</span>col<span style="color: #000000;">(</span>B<span style="color: #000000;">)</span> from<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">10</span> to<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">30</span>;</pre>
<li>2つのワークシートといくつかのデータが入力された<i>JoinWksEx</i>という名前のブックが作成されます。両方のシートの日付データを含む列Aを一致する列として使用します。表示形式が2つのシートで異なることに注意してください。</li>
<li>Xファンクション<i>wjoinbycol</i>を実行して、以下のそれぞれのケースでの結果を取得します。</li>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Case 1: デフォルト設定で結合(非一致を削除せず、一致列を一つに統合しない)</span>
wjoinbycol irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span>JoinWksEx<span style="color: #000000;">]</span><span style="color: #000000;">(</span>Sheet1,Sheet2<span style="color: #000000;">)</span> condition<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;[JoinWksEx]Sheet1!A=[JoinWksEx]Sheet2!A&quot;</span> ow<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span><span style="color: #000080;">&lt;</span>new<span style="color: #000080;">&gt;</span><span style="color: #000000;">]</span><span style="color: #000080;">&lt;</span>new<span style="color: #000080;">&gt;</span>;
&nbsp;
<span style="color: #008000;">// Case 2: 非一致を削除</span>
wjoinbycol irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span>JoinWksEx<span style="color: #000000;">]</span><span style="color: #000000;">(</span>Sheet1,Sheet2<span style="color: #000000;">)</span> condition<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;[JoinWksEx]Sheet1!A=[JoinWksEx]Sheet2!A&quot;</span> unmatch<span style="color: #000000;">:</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span> ow<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span><span style="color: #000080;">&lt;</span>new<span style="color: #000080;">&gt;</span><span style="color: #000000;">]</span><span style="color: #000080;">&lt;</span>new<span style="color: #000080;">&gt;</span>;
&nbsp;
<span style="color: #008000;">// Case 3: 一致列を一つに統合しない</span>
wjoinbycol irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span>JoinWksEx<span style="color: #000000;">]</span><span style="color: #000000;">(</span>Sheet1,Sheet2<span style="color: #000000;">)</span> condition<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;[JoinWksEx]Sheet1!A=[JoinWksEx]Sheet2!A&quot;</span> merge<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> ow<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span><span style="color: #000080;">&lt;</span>new<span style="color: #000080;">&gt;</span><span style="color: #000000;">]</span><span style="color: #000080;">&lt;</span>new<span style="color: #000080;">&gt;</span>;</pre> 
</ol>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">関連するXファンクション</span></h2>
<p><a href="../../XFunction/X-Function/WAppend.html" title="Xファンクション:WAppend">wappend</a>, <a href="../../XFunction/X-Function/Wjoinbylabel.html" title="Xファンクション:Wjoinbylabel">wjoinbylabel</a>, <a href="../../XFunction/X-Function/Wjoincols.html" title="Xファンクション:Wjoincols">Wjoincols</a>
</p>
<hr class='keywordshr'><p><span class='keywords'>キーワード:</span><span class='keywordsInput'>統合, 結合</span></p>







    