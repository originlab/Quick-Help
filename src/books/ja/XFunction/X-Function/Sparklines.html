<h1 class="firstheading">sparklines</h1>
<div id="toc" class="toc">
	<div id="toctitle">
		<h2>目次</h2>
	</div>
	<ol>
		<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span 
		 class="tocnumber">1</span><span class="toctext">メニュー情報</span></a></li>
		<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span 
		 class="tocnumber">2</span><span class="toctext">概要</span></a></li>
		<li class="toclevel-1 tocsection-3"><a href="#Command_Line_Usage"><span 
		 class="tocnumber">3</span> <span class="toctext">コマンドラインでの使用法</span></a></li>
		<li class="toclevel-1 tocsection-4"><a href="#X-Function_Execution_Options"><span 
		 class="tocnumber">4</span> <span class="toctext">Xファンクション実行オプション</span></a></li>
		<li class="toclevel-1 tocsection-5"><a href="#Variables"><span 
		 class="tocnumber">5</span> <span class="toctext">変数</span></a></li>
		<li class="toclevel-1 tocsection-6"><a href="#Description"><span 
		 class="tocnumber">6</span> <span class="toctext">説明</span></a></li>
		<li class="toclevel-1 tocsection-7"><a href="#Examples"><span class="tocnumber">7</span> 
		 <span class="toctext">サンプル</span></a></li>
		<li class="toclevel-1 tocsection-8"><a href="#Related_X-Functions"><span 
		 class="tocnumber">8</span><span class="toctext">関連するXファンクション</span></a></li>
	</ol>
</div>
<h2><a name="Menu_Information"></a><span class="mw-headline">メニュー情報</span></h2>
<p>スパークラインの追加または更新 </p>
<h2><a name="Brief_Information"></a><span class="mw-headline">概要</span></h2>
<p>列にスパークライングラフを追加します </p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">コマンドラインでの使用法</span></h2>
<p>&#160;</p>
<p><code style="font-family: monospace;">1. sparklines logy:=1; </code></p>
<p><code style="font-family: monospace;">2. sparklines sel:=0 c1:=4 c2:=6; 
 </code></p>
<p><code style="font-family: monospace;">3. sparklines iw:=[Book1]Sheet1! 
 sel:=0 c1:=2 c2:=5; </code></p>
<p><code style="font-family: monospace;">4. sparklines iw:=[Book1]Sheet1! 
 sel:=0 c1:=6 c2:=8 plottype:=box; </code></p>
<p><code style="font-family: monospace;">5. sparklines plottype:=1; </code></p>
<p><code style="font-family: monospace;">6. sparklines iw:=[Book1]Sheet1! 
 sel:=0 c1:=6 c2:=8 template:=tabel row_height:=300 keepAspect:=0 label:=0 
 endpts:=0; </code></p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">Xファンクションの実行オプション</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">スクリプトからXファンクションにアクセスする場合、追加のオプションスイッチについてのページを参照してください。</a> 
 </p>
<h2><a name="Variables"></a><span class="mw-headline">変数</span></h2>
<table class="xfvar">
	<tr>
		<th style="width: 8%;">表示<br />
		名 </th>
		<th style="width: 8%;">変数<br />
		名 </th>
		<th style="width: 8%;">I/O<br />
		と<br />
		データ型 </th>
		<th style="width: 8%;">デフォルト<br />
		値 </th>
		<th>説明 </th>
	</tr>
	<tr>
		<td>入力ワークシート </td>
		<td>iw </td>
		<td><p>入力 </p>
		<p>ワークシート </p></td>
		<td><p style="text-align: center;">&lt;active&gt; </p></td>
		<td><p>操作するワークシートを指定します。デフォルトのワークシートはアクティブシートです。 </p></td>
	</tr>
	<tr>
		<td>選択した列 </td>
		<td>sel </td>
		<td><p>入力 </p>
		<p>int </p></td>
		<td><p style="text-align: center;">1 </p></td>
		<td><p>デフォルトでこのオプションが選択され、自動で選択列が入力として使用されます。チェックを外した場合、下の<b>開始列</b>と<b>終了列</b>でスパークラインを追加する列または範囲を指定する必要があります。指定した列にスパークラインが追加されます。 
		 </p></td>
	</tr>
	<tr>
		<td>開始列 </td>
		<td>c1 </td>
		<td><p>入力 </p>
		<p>int </p></td>
		<td><p style="text-align: center;">1 </p></td>
		<td><p>どの列から処理を実行するか指定します。 </p></td>
	</tr>
	<tr>
		<td>終了列 </td>
		<td>c2 </td>
		<td><p>入力 </p>
		<p>int </p></td>
		<td><p style="text-align: center;">0 </p></td>
		<td><p>どの列まで処理を実行するか指定します。 </p></td>
	</tr>
	<tr>
		<td>プロットタイプ </td>
		<td>plottype </td>
		<td><p>入力 </p>
		<p>int </p></td>
		<td><p style="text-align: center;">0 </p></td>
		<td><p>スパークライン作成の際のプロットタイプを指定します。 <br />
		オプションリスト： </p>
		<ul>
			<li><i>line:折れ線</i> 
			<dl>
				<dd>折れ線</dd>
			</dl></li>
			<li><i>his:ヒストグラム</i> 
			<dl>
				<dd>ヒストグラム</dd>
			</dl></li>
			<li><i>box:ボックス</i> 
			<dl>
				<dd>ボックスチャート</dd>
			</dl></li>
		</ul></td>
	</tr>
	<tr>
		<td>グラフテンプレート </td>
		<td>template </td>
		<td><p>入力 </p>
		<p>string </p></td>
		<td><p style="text-align: center;">sparkline_label </p></td>
		<td><p>スパークラインで使用するテンプレートを指定します。 </p></td>
	</tr>
	<tr>
		<td>行高 (パーセント) </td>
		<td>row_height </td>
		<td><p>入力 </p>
		<p>int </p></td>
		<td><p style="text-align: center;">200 </p></td>
		<td><p>スパークライン行の高さを指定します。デフォルト破通常のセル高さの倍です。 </p></td>
	</tr>
	<tr>
		<td>縦横比を維持 </td>
		<td>keepAspect </td>
		<td><p>入力 </p>
		<p>int </p></td>
		<td><p style="text-align: center;">0 </p></td>
		<td><p>スパークラインの縦横比を維持するかどうか指定します。デフォルトではこのオプションは無効になっており、グラフの縦横比を変更してもスパークラインには表示されません。チェックを付けた場合、グラフのXおよびY軸で縦横比を変更すると、スパークラインの縦横比も変更されます。 
		 </p></td>
	</tr>
	<tr>
		<td>注釈を非表示 </td>
		<td>label </td>
		<td><p>入力 </p>
		<p>int </p></td>
		<td><p style="text-align: center;">1 </p></td>
		<td><p>チェックを付けると、グラフラベルがスパークラインには表示されません。チェックを外すと、ラベルが表示されます。デフォルトでは、ラベルは非表示です。 
		 </p></td>
	</tr>
	<tr>
		<td>最初と最後のポイントを表示 </td>
		<td>endpts </td>
		<td><p>入力 </p>
		<p>int </p></td>
		<td><p style="text-align: center;">1 </p></td>
		<td><p>チェックを付けると、スパークラインの最初と最後のポイントに印が付きます。 </p></td>
	</tr>
	<tr>
		<td>対応するX列をプロットに使う </td>
		<td>xy </td>
		<td><p>入力 </p>
		<p>int </p></td>
		<td><p style="text-align: center;">0 </p></td>
		<td><p>対応するXデータセットに対してYデータをプロットするか指定します。チェックを外すと行番号に対してデータがプロットされます。 
		 </p></td>
	</tr>
	<tr>
		<td>Log10のXスケール </td>
		<td>logx </td>
		<td><p>入力 </p>
		<p>int </p></td>
		<td><p style="text-align: center;">0 </p></td>
		<td><p>XスケールタイプでLog10を使用します。プロットタイプで折れ線が選択されている場合のみ利用できます。 </p></td>
	</tr>
	<tr>
		<td>Log10のYスケール </td>
		<td>logy </td>
		<td><p>入力 </p>
		<p>int </p></td>
		<td><p style="text-align: center;">0 </p></td>
		<td><p>YスケールタイプでLog10を使用します。 </p></td>
	</tr>
</table>
<h2><a name="Description"></a><span class="mw-headline">説明</span></h2>
<p>スパークラインは、任意の数値または日付/時間列のデータのプロファイルを、関連するx軸、y軸、ラベルなどを表示しない小さなグラフィック画像として表示するものです。この機能は、Edward 
 Tufte氏によるスパークラインの定義に従って実装されています。個別にグラフウィンドウを作成することなく、シート内の多くのYデータの傾向をすばやく表示できます。実際には、各スパークラインセルにはグラフが埋め込まれており、セルをダブルクリックすることで編集用に表示できます。 
 </p>
<p>このスパークラインXファンクションは、ワークシート列内のスパークラインの追加と更新が可能です。ワークブックがアクティブな時にメインメニューの<b>列：スパークラインの追加</b>を選択するか、スパークラインセル上で右クリックして<b>スパークラインの追加</b>を選択することでアクセスできます。 
 </p>
<table class="noborder">
	<tr>
		<td style="vertical-align: top;" width="60"><img src="../images/Sparklines/Alert_icon.png" 
														 alt="" width="57" 
														 height="57" border="0" /></td>
		<td><p>大規模データセットのスパークラインを表示する場合、処理速度が落ちる可能性があります。プロジェクトの動作が遅い原因がスパークラインの表示である可能性がある場合、システム変数<a 
		 class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#S"><b>@SPK</b></a>を使用してスパークラインの作成を止め、プロジェクト内の既存のスパークラインを非表示にできます。また、<a 
		 class="external text" href="../../LabTalk/LabTalk/Delete_(command).html#-spk.3B_Delete_all_project_sparklines"><b>delete 
		 -spk</b></a>で現在のプロジェクトからスパークラインを削減可能です。 </p></td>
	</tr>
</table>
<p><b>&#160;</b></p>
<h2><a name="Examples"></a><span class="mw-headline">サンプル</span></h2>
<p>コマンドウィンドウで、以下のスクリプトを実行します。 </p>
<p><code>sparklines row_height:=300 keepAspect:=0 plottype:=his;</code> 
 </p>
<p>これによりアクティブ列にヒストグラムのスパークラインを追加します。 </p>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">関連するXファンクション</span></h2>
<p><a href="../../XFunction/X-Function/InsertSparklines.html" title="Xファンクション:InsertSparklines">insertSparklines</a>, 
 <a href="../../XFunction/X-Function/UpdateSparklines.html" title="Xファンクション:UpdateSparklines">UpdateSparklines</a> 
 </p>
