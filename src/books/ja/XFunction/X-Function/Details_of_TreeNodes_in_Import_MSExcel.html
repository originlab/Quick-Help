<h1 class="firstheading">MSExcelインポートのツリーノードに関する詳細</h1><p><br /></p>
<div id="toc" class="toc"><div id="toctitle"><h2>内容</h2></div><ul><li class="toclevel-1 tocsection-1"><a href="#Options"><span class="tocnumber">1</span> <span class="toctext">オプション</span></a> <ul><li class="toclevel-2 tocsection-2"><a href="#Names"><span class="tocnumber">1.1</span> <span class="toctext">ワークシート/ブックの名前を付ける/変更する</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#headers"><span class="tocnumber">1.2</span> <span class="toctext">ヘッダ行</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Partials"><span class="tocnumber">1.3</span> <span class="toctext">部分インポート</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Scripts"><span class="tocnumber">1.4</span> <span class="toctext">スクリプト</span></a></li></ul></li></ul></div>

<h2><a name="Options"></a><span class="mw-headline">オプション</span></h2>
<p><b>オプション</b>ツリーは、<b>impMSExcel</b> Xファンクションのインポートオプションを全て指定します。</p><p>シンタックス:  <b>Options.<i>.Treenode</i>:=&lt;value&gt;</b></p><p>サンプル: <b>Options.sparklines:=1</b> <br /></p>
<table class="treetable">
<tr>
<th> ツリーノード</th>
<th> ラベル</th>
<th> データ型</th>
<th> デフォルト</th>
<th> 説明</th></tr>
<tr>
<td>FirstMode</td>
<td>第１ファイルインポートモード</td>
<td>int</td>
<td>0</td>
<td>最初にインポートするファイルのインポートモードを指定します。オプションリスト： <ul><li>0: 既存データを置き換える<dl><dd>目的のウィンドウ内にデータがある場合は削除され、新しいデータがインポートされます。</dd></dl></li>
<li>3: ブックを新たに作って読み込む<dl><dd>インポートされた最初のファイルのために新しいブックを作成します。 </dd></dl></li>
<li>4: シートを新たに作って読み込む<dl><dd>インポートされた最初のファイルのために新しいシートを作成します。</dd></dl></li>
<li>1: 各シートに対して新しい列を開始<dl><dd>最初にインポートされたファイルの各シートのために目的のワークシートに新しい列を追加します。</dd></dl></li></ul></td></tr>
<tr>
<td>Mode</td>
<td>複数ファイルのインポートモード(第1ファイル以外)</td>
<td>int</td>
<td>3</td>
<td>複数のファイルに対して、第１ファイル以外のインポートモードを選択します。オプションリスト： <ul><li>3: ブックを新たに作って読み込む<dl><dd>インポートするファイルに対して新しいブックを作成します。 </dd></dl></li>
<li>4: シートを新たに作って読み込む<dl><dd>インポートするファイルに対して新しいシートを作成します。</dd></dl></li>
<li>1: 各シートに対して新しい列を開始<dl><dd>目的のワークシートに列を追加し、ファイルをインポートします。</dd></dl></li></ul></td></tr>
<tr>
<td>PageTemplate</td>
<td>テンプレート名</td>
<td>String</td>
<td>&lt;デフォルト&gt;</td>
<td>新しいワークブックかワークシートにインポートする時のテンプレートを指定します。このオプションは、<b>既存データを置き換える</b>、<b>インポートモード</b>が<b>シートを新たに作って読み込む</b>、<b>ブックを新たに作って読み込む</b>に設定されている時に使用します。デフォルトでは、Originのワークブックテンプレート<i><b>&lt;default&gt;</b> </i>が使用されます。ドロップダウンリストでは、特別なテンプレート<b><i>&lt;クローン&gt;</i> </b>が利用でき、現在のワークシート/ワークブックを複製して、アクティブなワークブックをファイルインポートのテンプレートとして使用します。</td></tr>
<tr>
<td>ColDesignations</td>
<td>列のXY属性</td>
<td>string</td>
<td>
</td>
<td><a class="external text" href="../../UserGuide/UserGuide/Set_Column_Designation.html">列の属性</a>を指定します。列の属性に関する詳しいシンタックス（属性の繰り返しのような）は <a class="external text" href="../../UserGuide/UserGuide/Import_Wizard_Data_Columns_Page_(ASCII).html#Column_Designations">こちらのヘルプページ</a> をご参照ください。指定された属性は、全てのシートに自動で適用されます。</td></tr>
<tr>
<td>sparklines</td>
<td>スパークラインの追加</td>
<td>int</td>
<td>1</td>
<td>データのスパークラインを追加するかどうかを指定します。オプションリスト <ul><li>0：しない<dl><dd>スパークラインを追加しません。</dd></dl></li>
<li>1: する<dl><dd>スパークラインを追加します。</dd></dl></li>
<li>2: はい(50列より少ない場合)<dl><dd>50列より少ない場合はスパークラインを追加します。</dd></dl></li></ul></td></tr>
<tr>
<td>cellfmts</td>
<td>インポートセルフォーマット</td>
<td>int</td>
<td>0</td>
<td>エクセルファイルのインポートセルフォーマット（テキストの色、フォント、セルの高さなど）を指定します。</td></tr>
<tr>
<td>emptycols</td>
<td>空白列の最大数 (すべてを指定するには-1)</td>
<td>int</td>
<td>0</td>
<td>空列の最大数を指定します。</td></tr>
<tr>
<td>excludeempty</td>
<td>空のシートを削除</td>
<td>int</td>
<td>1</td>
<td>対象のウィンドウに空のシートを入力するかどうかを指定してください。チェックがついている場合、空のシートは<b>ファイル情報</b>ブランチの<b>ファイルシート</b>ブランチに表示されません。</td></tr>
<tr>
<td>allsheets</td>
<td>ヘッダを全てのシートに適用</td>
<td>int</td>
<td>0</td>
<td>ヘッダ設定を全てのExcelシートに適用するか指定します。</td></tr></table>
<h3><a name="Names"></a><span class="mw-headline">ワークシート/ブックの名前を付ける/変更する</span></h3>
<p><b>オプション</b>ツリーの<b>ワークシート/ブックの名前を付ける/変更する</b>ブランチはワークシートとワークブックの名づけについて指定します。</p><p>シンタックス: <b>Options.Names.Treenode:= &lt;<i>value</i>&gt;</b></p><p>サンプル: <br /> // filenameの一部でワークブックを名前付けする &nbsp;: <br /> <b>Options.Names.FNameToBk:=1</b> <br /> <b>Options.Names.FNameToBkFrom:=1</b> <br /> <b>Options.Names.FNameToBkTo:=4</b> <br /></p>
<table class="treetable">
<tr>
<th> ツリーノード</th>
<th> ラベル</th>
<th> データ型</th>
<th> デフォルト</th>
<th> 説明</th></tr>
<tr>
<td>AutoNames</td>
<td>ファイル名による自動名前変更</td>
<td>int</td>
<td>0</td>
<td>チェックがついている場合、Originは以下のようなワークシートとワークブックの名前の変更デフォルト設定を使用します。: ファイル名全体（拡張子含む）をワークブック名として使用。</td></tr>
<tr>
<td>RenameSht</td>
<td>シート名をExcelのシート名に変更する</td>
<td>int</td>
<td>1</td>
<td>チェックがついている場合、対応するExcelシート名をOriginのワークシート名にします。</td></tr>
<tr>
<td>FNameToBk</td>
<td>ブック名を(部分)ファイル名に変更する</td>
<td>int</td>
<td>1</td>
<td>これを有効にすると、ワークブック名にファイル名の一部を使います。</td></tr>
<tr>
<td>FNameToBkFrom</td>
<td>短縮開始位置</td>
<td>int</td>
<td>1</td>
<td>ブック名の開始位置</td></tr>
<tr>
<td>FNameToBkTo</td>
<td>短縮終了位置</td>
<td>int</td>
<td>0</td>
<td>ブック名の終了位置</td></tr>
<tr>
<td>FNameToBkLnOnly</td>
<td>ブックのロングネームのみを変更する</td>
<td>int</td>
<td>0</td>
<td>これにチェックを付けると、ブックのロングネームのみ名前を変更します。</td></tr>
<tr>
<td>FPathToBk</td>
<td>ブック名の変更時にファイルパスを含める</td>
<td>int</td>
<td>0</td>
<td>ファイルパスをワークブック名に含めるかどうかを指定します。</td></tr>
<tr>
<td>FNameToBkComm</td>
<td>ワークブックコメントにファイル名を追加</td>
<td>int</td>
<td>1</td>
<td>ワークブックコメントにファイル名を追加するかどうか指定します。</td></tr>
<tr>
<td>FNameToWksComm</td>
<td>ワークシートのコメントにファイル名を付加</td>
<td>int</td>
<td>0</td>
<td>ワークシートコメントにファイル名を追加するかどうか指定します。</td></tr>
<tr>
<td>FPathToComm</td>
<td>ファイル名を追加するときにファイルパスを含める</td>
<td>int</td>
<td>1</td>
<td>これを有効にすると、ワークブックのコメントとコメント行にインポートファイルパスが追加されます。</td></tr></table>
<table class="note">

<tr>
<td><b><b>Note</b>：</b><p>Origin8.6以降、マイナス値(－)が<b>短縮開始位置</b>と<b>短縮終了位置</b>に追加されました。これは、ファイル名の最後の文字からカウントするためです。これはファイル拡張子を除くために使用できます。例えば、<i>sample.xls</i>という名前のASCIIファイルをインポートする場合、設定として拡張子「<i>.xls</i>」を切り取るように指定する事もできます。</p>
<dl><dd><b>短縮開始位置</b>: 1</dd>
<dd><b>短縮終了位置</b>: -4</dd></dl>
</td></tr></table>
<h3><a name="headers"></a><span class="mw-headline">ヘッダ行</span></h3>
<p><b>オプション</b>ツリー内の<b>ヘッダ行</b>ブランチはインポートするファイルのヘッダ情報を指定します。</p><p>シンタックス: <b>Options.Hdr.Treenode:= &lt;<i>value</i>&gt;</b></p><p>サンプル: <br /> // インポートされたファイルの最初の行をロングネームとする: <br /> <b>Options.headers.LongName:= 1;</b> <br /></p>
<table class="treetable">
<tr>
<th> ツリーノード</th>
<th> ラベル</th>
<th> データ型</th>
<th> デフォルト</th>
<th> 説明</th></tr>
<tr>
<td>MainheaderLines</td>
<td>メインヘッダの行数(サブヘッダを除く)</td>
<td>int</td>
<td>0</td>
<td>いくつかのファイル、特にラボの機材などから出力されたものは、ヘッダ情報で機材、オペレーター、日付、サンプル番号等を記録しています。これはメインのヘッダ行にあたります。MainheaderLinesはメインのヘッダ行がどこにあるか指示するのに使用します。</td></tr>
<tr>
<td>SubheaderLines</td>
<td>サブヘッダの行数</td>
<td>int</td>
<td>0</td>
<td>これはファイル内にあるサブヘッダ数を指定します。</td></tr>
<tr>
<td>LongName</td>
<td>ロングネーム</td>
<td>int</td>
<td>0</td>
<td>ロングネームの行を指定します。</td></tr>
<tr>
<td>Unit</td>
<td>単位</td>
<td>int</td>
<td>0</td>
<td>単位の行を指定します。</td></tr>
<tr>
<td>CommentFrom</td>
<td>コメント(開始行)</td>
<td>int</td>
<td>0</td>
<td>コメントが開始する行を指定します。</td></tr>
<tr>
<td>CommentTo</td>
<td>コメント(最終行)</td>
<td>int</td>
<td>0</td>
<td>コメントが終了する行を指定します。</td></tr>
<tr>
<td>ParametersFrom</td>
<td>システムパラメータ(開始行)</td>
<td>int</td>
<td>0</td>
<td>システムパラメータが開始する行を指定します。</td></tr>
<tr>
<td>ParametersTo</td>
<td>システムパラメータ(最終行)</td>
<td>int</td>
<td>0</td>
<td>システムパラメータが終了する行を指定します。</td></tr>
<tr>
<td>UserParametersFrom</td>
<td>ユーザパラメータ(開始行)</td>
<td>int</td>
<td>0</td>
<td>ユーザパラメータが開始する行を指定します。</td></tr>
<tr>
<td>UserParametersTo</td>
<td>ユーザパラメータ(最終行)</td>
<td>int</td>
<td>0</td>
<td>ユーザパラメータが終了する行を指定します。</td></tr></table>
<h3><a name="Partials"></a><span class="mw-headline">部分インポート</span></h3>
<p><b>オプション</b>ツリー内の<b>部分インポート</b>ブランチは、部分的にインポートする方法を指定します。</p><p>シンタックス: <b>Options.Partials.<i>Treenode:= &lt;value&gt;</i></b></p><p>サンプル:</p>
<dl><dd><b>Options.Partials.Partial:=1</b>  </dd>
<dd><b>Options.Partials.FirstCol:=1</b>    </dd>
<dd><b>Options.Partials.LastCol:=3</b> </dd></dl>
<table class="treetable">
<tr>
<th> ツリーノード</th>
<th> ラベル</th>
<th> データ型</th>
<th> デフォルト</th>
<th> 説明</th></tr>
<tr>
<td>Partial</td>
<td>部分インポート</td>
<td>int</td>
<td>0</td>
<td>部分インポートを可能にするかどうか指定します。オプションリスト： <ul><li>0：しない<dl><dd>部分インポートしない</dd></dl></li>
<li>1: 全てのファイル<dl><dd>部分インポート設定を全てのファイルに適用</dd></dl></li>
<li>2: 2番目のファイルから<dl><dd>最初のファイルを除いた全ファイルに部分インポート設定を適用</dd></dl></li></ul></td></tr>
<tr>
<td>FirstCol</td>
<td>開始列</td>
<td>int</td>
<td>1</td>
<td><i>Partial</i> が有効なとき(1または2)に利用できます。部分インポートの開始列を指定します。</td></tr>
<tr>
<td>ReadCols</td>
<td>列の読み込み</td>
<td>int</td>
<td>1</td>
<td>これは<i>データ列をスキップ</i> と一緒に動作します<i>Partial</i> が有効(1または2)で、<b>ポイントスキップ</b>が0より大きいときに利用できます。<p><b>列の読み込み</b>に値<i>j</i> を指定し、<b>データ列をスキップ</b>に値<i>k</i> を入力すると、 j+k 列毎に<i>j</i> 列がインポートされ、<i>k</i> 列が読み飛ばされます。</p>
</td></tr>
<tr>
<td>SkipCols</td>
<td>列をスキップ</td>
<td>int</td>
<td>0</td>
<td><i>Partial</i> が有効なとき(1または2)に利用できます。これは<i>列の読み込み</i> と一緒に動作します。</td></tr>
<tr>
<td>LastCol</td>
<td>最終列</td>
<td>int</td>
<td>0</td>
<td><i>Partial</i> が有効なとき(1または2)に利用できます。部分インポートの最終列を指定します。</td></tr>
<tr>
<td>FirstRow</td>
<td>開始行</td>
<td>int</td>
<td>1</td>
<td><i>Partial</i> が有効なとき(1または2)に利用できます。部分インポートの開始行を指定します。</td></tr>
<tr>
<td>ReadRows</td>
<td>行の読み込み</td>
<td>int</td>
<td>1</td>
<td>これは<i>データ行をスキップ</i> と一緒に動作します。 <b>部分インポート</b> が有効(1または2)で、<b><b>行のスキップ</b></b>が0より大きいときに利用できます。<p><b>行の読み込み</b>に値<i>j</i> を指定し<b>行のスキップ</b> に値<i>k</i> を入力すると、 <i>j</i> +<i>k</i> 行毎に<i>j</i> 行がインポートされ、<i>k</i> 行が読み飛ばされます。</p>
</td></tr>
<tr>
<td>SkipRows</td>
<td>行のスキップ</td>
<td>int</td>
<td>0</td>
<td><i>Partial</i> が有効なとき(1または2)に利用できます。これは<i>行の読み込み</i> と一緒に動作します。</td></tr>
<tr>
<td>LastRow</td>
<td>最終行</td>
<td>int</td>
<td>0</td>
<td><i>Partial</i> が有効なとき(1または2)に利用できます。部分インポートの最終行を指定します。</td></tr></table>
<h3><a name="Scripts"></a><span class="mw-headline">スクリプト</span></h3>
<p><b>オプション</b>ツリーの<b>スクリプト</b>は、ファイルがインポートされた後に実行するLabTalkスクリプトを指定します。</p><p>シンタックス: <b>Options.Scripts.Treenode:= &lt;<i>string</i>&gt;</b></p><p>サンプル: <br /> // インポートされた各ファイルの2列目をプロット&nbsp;: <br /> <b>Options.Script.RunScriptAfterEachImport:=&quot;plotxy 2;&quot;;</b> <br /></p><p>//全てのファイルがインポートされたときに、ワークブック内の全てのシートをループして、列1から4の最初の500行を削除する <br /> <b>Options.Script.RunScriptAfterAllImport:=&quot; doc -ef W { doc -e LW { range aa =1[1]:4[500]; del aa;}}&quot;;<br /></b></p><p><br /></p>
<table class="treetable">
<tr>
<th> ツリーノード</th>
<th> ラベル</th>
<th> データ型</th>
<th> デフォルト</th>
<th> 説明</th></tr>
<tr>
<td>RunScriptAfterEachImport</td>
<td>それぞれの各ファイルインポート後のスクリプト</td>
<td>string</td>
<td>&quot;?&quot;</td>
<td>各ファイルインポート後に実行されるLabTalkスクリプトを指定します。</td></tr>
<tr>
<td>RunScriptAfterAllImport</td>
<td>全てのファイルインポート後のスクリプト</td>
<td>string</td>
<td>&quot;?&quot;</td>
<td>全ファイルがインポートされた後に実行されるLabTalkスクリプトを指定します。</td></tr></table>







    