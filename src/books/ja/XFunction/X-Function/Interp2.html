<h1 class="firstheading">interp2</h1><div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">メニュー情報</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span class="tocnumber">2</span><span class="toctext">概要</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Additional_Information"><span class="tocnumber">3</span> <span class="toctext">追加の情報</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Command_Line_Usage"><span class="tocnumber">4</span><span class="toctext">コマンドラインでの使用法</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#X-Function_Execution_Options"><span class="tocnumber">5</span> <span class="toctext">Xファンクションの実行オプション</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Variables"><span class="tocnumber">6</span> <span class="toctext">変数</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Description"><span class="tocnumber">7</span> <span class="toctext">説明</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Algorithm"><span class="tocnumber">8</span> <span class="toctext">アルゴリズム</span></a>
<ul>
<li class="toclevel-2 tocsection-9"><a href="#Nearest_neighbor_interpolation"><span class="tocnumber">8.1</span> <span class="toctext">近傍（最近傍）補間</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#.28Random.29Ordinary_Kriging_interpolation"><span class="tocnumber">8.2</span> <span class="toctext">ランダム Kriging法</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Random_Renka_Cline"><span class="tocnumber">8.3</span> <span class="toctext">ランダム Renka Cline法</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Random_Shepard"><span class="tocnumber">8.4</span> <span class="toctext">ランダム Shepard法</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#Random_TPS"><span class="tocnumber">8.5</span> <span class="toctext">ランダム TPS法</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#Spline"><span class="tocnumber">8.6</span> <span class="toctext">スプライン</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="#Triangle"><span class="tocnumber">8.7</span> <span class="toctext">三角</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#Weighting_average"><span class="tocnumber">8.8</span> <span class="toctext">加重平均</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="#Comparison"><span class="tocnumber">8.9</span> <span class="toctext">比較</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-18"><a href="#Reference"><span class="tocnumber">9</span> <span class="toctext">参考文献</span></a></li>
<li class="toclevel-1 tocsection-19"><a href="#Related_X-Functions"><span class="tocnumber">10</span><span class="toctext">関連するXファンクション</span></a></li>
</ul>
</div>

<h2><a name="Menu_Information"></a><span class="mw-headline">メニュー情報</span></h2>
<p>XYからZを補間
</p>
<h2><a name="Brief_Information"></a><span class="mw-headline">概要</span></h2>
<p>与えられたXY値のセットでXYデータを補間します
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">追加の情報</span></h2>
<p>必要なOriginのバージョン: 9.1 SR0以降
</p><p><br />
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">コマンドラインでの使用法</span></h2>
<p><code>
1.interp2 ixy:=[XYZRandomGaus]&quot;XYZ Random Gaussian&quot;!(D,E) ir:=[XYZRandomGaus]&quot;XYZ Random Gaussian&quot;!(A,B,C) method:=rk pts:=3 smooth:=4;
</code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">Xファンクションの実行オプション</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">スクリプトからXファンクションにアクセスする場合、追加のオプションスイッチについてのページを参照してください。</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">変数</span></h2>
<table class="xfvar">
<tr>
<th width="8%">表示<br />名
</th>
<th width="8%">変数<br />名
</th>
<th width="8%">I/O<br />と<br />データ型
</th>
<th width="8%">デフォルト<br />値
</th>
<th>説明
</th></tr>
<tr>
<td>補間に使用するXYの値
</td>
<td>ixy
</td>
<td>
<p>入力
</p><p>XYRange
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td> 指定されたXY値の入力XY範囲を指定します。
</td></tr>
<tr>
<td>入力
</td>
<td>ir
</td>
<td>
<p>入力
</p><p>XYZRange
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> XYZデータグループの入力XYZ範囲を指定します。
</td></tr>
<tr>
<td>手法
</td>
<td>method
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> 使用する補間手法を指定します。8つの手法から選択できます。
<p>オプションリスト：
</p>
<ul><li><i>nr:近傍</i></li>
<li><i>rk:ランダムKriging法</i></li>
<li><i>rc:ランダムRenka Cline法</i></li>
<li><i>rs:ランダムShepard法</i></li>
<li><i>tps:ランダム TPS法</i></li>
<li><i>sp:スプライン</i></li>
<li><i>ta:三角</i></li>
<li><i>wa:加重平均法</i></li></ul>
<p>詳細は下の<a href="#Algorithm">アルゴリズム</a>を参照してください。
</p>
</td></tr>
<tr>
<td>検索半径
</td>
<td>radius
</td>
<td>
<p>入力
</p><p>double
</p>
</td>
<td> <center>2</center>
</td>
<td> 検索範囲を指定します。<i>手法</i>で<i>ランダムKriging法</i>または<i>加重平均法</i>を選択した場合に利用できます。
</td></tr>
<tr>
<td>最小ポイント
</td>
<td>pts
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>2</center>
</td>
<td> 最小ポイント数を指定します。<i>手法</i>で<i>ランダムKriging法</i>を選択した場合に利用できます。
</td></tr>
<tr>
<td>スムージング因子
</td>
<td>smooth
</td>
<td>
<p>入力
</p><p>double
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td> Kriging またはスプラインスムージング因子を指定します。<i>手法</i>で<i>ランダムKriging法</i>または<i>スプライン</i>を選択した場合に利用できます。
</td></tr>
<tr>
<td>重みの入力
</td>
<td>weight
</td>
<td>
<p>入力
</p><p>vector
</p>
</td>
<td> <center></center>
</td>
<td> 重みとしてベクトルを指定します。<i>手法</i>で<i>スプライン</i>を選択した場合に利用できます。
</td></tr>
<tr>
<td>重み関数局所因子
</td>
<td>nw
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>9</center>
</td>
<td> 重み関数の局所因子を指定します。<i>手法</i>で<i>ランダムShepard法</i>を選択した場合に利用できます。
</td></tr>
<tr>
<td>二次補間局所因子
</td>
<td>nq
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>18</center>
</td>
<td> 二次補間局所因子を指定します。<i>手法</i>で<i>ランダムShepard法</i>を選択した場合に利用できます。
</td></tr>
<tr>
<td>補間の結果
</td>
<td>oz
</td>
<td>
<p>出力
</p><p>vector
</p>
</td>
<td> <center>&lt;new&gt;</center>
</td>
<td> 補間結果を出力する場所を指定します。
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">説明</span></h2>
<p>この Xファンクションは、8つの手法 (近傍、ランダムKriging、ランダムRenka Cline、ランダムShepard、ランダムTPS、スプライン、三角、加重平均）を使用して、既存のXYZデータのグループを補間して、与えられた (x,y) に対するZ値を検索します。 
</p><p><b>interp2</b>Xファンクションを使用して xy から z を補間するには、次のようにします。
</p>
<ol>
<li><b>スクリプトウィンドウ</b>で以下を実行します。
<pre class="lt" style="font-family:monospace;">interp2 <span style="color: #000080;">-</span>d;</pre>
<b>Interp2</b> ダイアログボックスが開きます。</li>
<li><b>補間に使用するXYの値</b>としてワークシートの (x,y) データを指定し、XYZデータ範囲を補間の<b>入力</b>として指定します。</li> 
<li>ドロップダウンリストから<b>手法</b>を選択します。</li>
<li><b>補間の結果</b>に出力先の列を指定します。</li>
</ol>
<h2><a name="Algorithm"></a><span class="mw-headline">アルゴリズム</span></h2>
<p>Interp2 は、周囲の観測値から未測定の位置の変数を推定します。Xファンクション Interp2 で使用できる手法は8つあり、各手法とアルゴリズムの対応は下表のとおりです。 
</p>
<table class="dialogcontroltable">
<tr>
<th>メソッド
</th>
<th>アルゴリズム
</th></tr>
<tr>
<td>近傍
</td>
<td>最近傍補間
</td></tr>
<tr>
<td>ランダムKriging法
</td>
<td>通常クリギング補間
</td></tr>
<tr>
<td>ランダム Renka Cline法
</td>
<td>三角法ベースのRenka Cline補間
</td></tr>
<tr>
<td>ランダム Shepard法
</td>
<td>修正シェパード補間
</td></tr>
<tr>
<td>ランダムTPS法
</td>
<td>ランダムTPS補間
</td></tr>
<tr>
<td>スプライン
</td>
<td>バイキュービックB-スプライン補間
</td></tr>
<tr>
<td>三角形
</td>
<td>三角法ベースのRenka Cline補間
</td></tr>
<tr>
<td>加重平均法
</td>
<td>逆距離加重法（IDW)補間
</td></tr></table>
<h3><a name="Nearest_neighbor_interpolation"></a><span class="mw-headline">最近傍補間</span></h3>
<p>最近傍アルゴリズムでは、補間されるXとYの値に最も近い点を検索し、補間結果としてこの検索ポイントのZ値を使用します。この手順は、他の隣接点を含めず、 区分定数補間が生じます。このアルゴリズムはとても単純なので結果曲面はスムーズになりません。
</p>
<h3><a name=".28Random.29Ordinary_Kriging_interpolation"></a><span class="mw-headline">(ランダム)通常クリギング補間</span></h3>
<p>Originでは、関数<a class="external text" href="../../OriginC/OriginC/Ocmath_2d_kriging_scat_(global_function).html">ocmath_2d_kriging_scat</a>で通常Kriging補間を実行します。通常Krigingの基本的な手順は、以下のようになります。
</p><p><img src="../images/Interp2/math-97f71577a235052536405e4181dbf5cb.png" title="x_1, x_2, ..., x_n" alt="x_1, x_2, ..., x_n" class="tex"/> 観測されたランダムポイントとし、<img src="../images/Interp2/math-f753d777102789bbc469e6941d6c51b1.png" title="z(x_1), z(x_2), ..., z(x_n)" alt="z(x_1), z(x_2), ..., z(x_n)" class="tex"/> は一連のポイントそれぞれの計測された値とします。計測されていない与えられたポイント<img src="../images/Interp2/math-3e0d691f3a530e6c7e079636f20c111b.png" title="x_0" alt="x_0" class="tex"/> は、通常Krigingに従い、この未計測ポイントの推定値 <img src="../images/Interp2/math-1d9ebb4e035ddd08243a67427b57443d.png" title="z^*(x_0)" alt="z^*(x_0)" class="tex"/> は、以下のように記述できる計測されたポイントの加重線形組み合わせによって生成されます。
</p><p><img src="../images/Interp2/math-ae3994496a3226934f485304929e3a61.png" title="z^*(x_0) = \sum_{i=1}^nw_iz(x_i)" alt="z^*(x_0) = \sum_{i=1}^nw_iz(x_i)" class="tex"/>
</p><p>ここで<img src="../images/Interp2/math-aa38f107289d4d73d516190581397349.png" title="w_i" alt="w_i" class="tex"/> は対応するポイントの重みです。
</p><p>未計測ポイント <img src="../images/Interp2/math-3e0d691f3a530e6c7e079636f20c111b.png" title="x_0" alt="x_0" class="tex"/> の推定値 <img src="../images/Interp2/math-1d9ebb4e035ddd08243a67427b57443d.png" title="z^*(x_0)" alt="z^*(x_0)" class="tex"/> を取得するために、計算に寄与するそれぞれの計測されたポイントの重みを計算する必要があります。 
</p><p>第一に、ポイントのランダム関数は、結果の普遍性のために変動しないと仮定します。つまり、下式で予測された値はゼロである必要があります。
</p><p><img src="../images/Interp2/math-2ca1e0b9fe3c0b4e671138aae4e41115.png" title="E[z^*(x_0)-z(x_0)] = E[\sum_{i=1}^nw_iz(x_i)-z(x_0)] = \sum_{i=1}^nw_iE[z(x_i)]-E[z(x_0)] =0" alt="E[z^*(x_0)-z(x_0)] = E[\sum_{i=1}^nw_iz(x_i)-z(x_0)] = \sum_{i=1}^nw_iE[z(x_i)]-E[z(x_0)] =0" class="tex"/>
</p><p>明らかに、 <img src="../images/Interp2/math-bf5db65184bd9c61c3a398d53aa3c5fc.png" title="E[z(x_i)] = E[z(x_0)] = m" alt="E[z(x_i)] = E[z(x_0)] = m" class="tex"/> （<img src="../images/Interp2/math-6f8f57715090da2632453988d9a1501b.png" title="m" alt="m" class="tex"/>は平均）なので、<img src="../images/Interp2/math-1f6bfaafdef1df7d3536a37d8424a8ce.png" title="\sum_{i=1}^nw_i = 1" alt="\sum_{i=1}^nw_i = 1" class="tex"/>を取得します。
</p><p>次に、エラーのための最適の分散を満たす必要があります。これは、以下の式で表される分散の最小化です。
</p><p><img src="../images/Interp2/math-d5c87c18840e2e654b0f8bfb4485a5d2.png" title="\sigma_0^2 = Var[z^*(x_0)-z(x_0)] 
= E[((z^*(x_0)-z(x_0))-E[z^*(x_0)-z(x_0)])^2] 
= E[(z^*(x_0)-z(x_0))^2] 
= E[(\sum_{i=1}^nw_iz(x_i)-z(x_0))^2] 
= E[(z(x_0))^2] - 2E[z(x_0)\sum_{i=1}^nw_iz(x_i)] + E[(\sum_{i=1}^nw_iz(x_i))^2]
= C(x_0, x_0) - 2\sum_{i=1}^nw_iC(x_i, x_0) + \sum_{i=1}^n\sum_{j=1}^nw_iw_jC(x_i, x_j)
= minimum" alt="\sigma_0^2 = Var[z^*(x_0)-z(x_0)] 
= E[((z^*(x_0)-z(x_0))-E[z^*(x_0)-z(x_0)])^2] 
= E[(z^*(x_0)-z(x_0))^2] 
= E[(\sum_{i=1}^nw_iz(x_i)-z(x_0))^2] 
= E[(z(x_0))^2] - 2E[z(x_0)\sum_{i=1}^nw_iz(x_i)] + E[(\sum_{i=1}^nw_iz(x_i))^2]
= C(x_0, x_0) - 2\sum_{i=1}^nw_iC(x_i, x_0) + \sum_{i=1}^n\sum_{j=1}^nw_iw_jC(x_i, x_j)
= minimum" class="tex"/>
</p><p>上述の式による最小化は、Lagrange(言語)パラメータ <img src="../images/Interp2/math-c9faf6ead2cd2c2187bd943488de1d0a.png" title="\mu" alt="\mu" class="tex"/> があり、以下のようにします。
</p><p><img src="../images/Interp2/math-3ad337f73dd5867cdb34c08c8a2d66d9.png" title="F = \sigma_0^2 - 2\mu (\sum_{i=1}^nw_i - 1)" alt="F = \sigma_0^2 - 2\mu (\sum_{i=1}^nw_i - 1)" class="tex"/>
</p><p><img src="../images/Interp2/math-aa38f107289d4d73d516190581397349.png" title="w_i" alt="w_i" class="tex"/> と <img src="../images/Interp2/math-c9faf6ead2cd2c2187bd943488de1d0a.png" title="\mu" alt="\mu" class="tex"/>に関する上式の偏第一微分を計算し、取得します。
</p><p><img src="../images/Interp2/math-7e299ed45d6faaa620af5108b3937850.png" title="\left\{\begin{matrix}\frac{\partial F}{\partial w_i} = 2\sum_{j=1}^nw_jC(x_i, x_j) - 2C(x_i, x_0) - 2\mu = 0
\\ \frac{\partial F}{\partial \mu} = -2(\sum_{i=1}^nw_i-1) = 0
\end{matrix}\right." alt="\left\{\begin{matrix}\frac{\partial F}{\partial w_i} = 2\sum_{j=1}^nw_jC(x_i, x_j) - 2C(x_i, x_0) - 2\mu = 0
\\ \frac{\partial F}{\partial \mu} = -2(\sum_{i=1}^nw_i-1) = 0
\end{matrix}\right." class="tex"/>
</p><p>単純化したものを取得します。
</p><p><img src="../images/Interp2/math-7a289b7cf34cb3fee6eb9326b8f53f3a.png" title="\left\{\begin{matrix}\sum_{j=1}^nw_jC(x_i, x_j) - \mu = C(x_i, x_0)
\\ \sum_{i=1}^nw_i = 1
\end{matrix}\right." alt="\left\{\begin{matrix}\sum_{j=1}^nw_jC(x_i, x_j) - \mu = C(x_i, x_0)
\\ \sum_{i=1}^nw_i = 1
\end{matrix}\right." class="tex"/>
</p><p>および <img src="../images/Interp2/math-ba81065a6646676fa8726518cd83d4ac.png" title="\sigma_0^2 = C(x_0, x_0) - \sum_{i=1}^nw_iC(x_i, x_0) + \mu" alt="\sigma_0^2 = C(x_0, x_0) - \sum_{i=1}^nw_iC(x_i, x_0) + \mu" class="tex"/>
</p><p>以下のようにします。
</p><p><img src="../images/Interp2/math-a2ce9a6cb1de416a3cc9c54d63bf317d.png" title="C = \begin{bmatrix}C(x_1, x_1) &amp; C(x_1, x_2) &amp; \cdots &amp; C(x_1, x_n) &amp; 1
\\ C(x_2, x_1) &amp; C(x_2, x_2) &amp; \cdots &amp; C(x_2, x_n) &amp; 1
\\ \vdots &amp; \vdots &amp; \: &amp; \vdots &amp; \vdots
\\ C(x_n, x_1) &amp; C(x_n, x_2) &amp; \cdots &amp; C(x_n, x_n) &amp; 1
\\ 1 &amp; 1 &amp; \cdots &amp; 1 &amp; 0
\end{bmatrix},
W = \begin{bmatrix}w_1 \\ w_2 \\ \vdots \\ w_n \\ -\mu\end{bmatrix},
D = \begin{bmatrix}C(x_1, x_0) \\ C(x_2, x_0) \\ \vdots \\ C(x_n, x_0) \\ 1\end{bmatrix}
" alt="C = \begin{bmatrix}C(x_1, x_1) &amp; C(x_1, x_2) &amp; \cdots &amp; C(x_1, x_n) &amp; 1
\\ C(x_2, x_1) &amp; C(x_2, x_2) &amp; \cdots &amp; C(x_2, x_n) &amp; 1
\\ \vdots &amp; \vdots &amp; \: &amp; \vdots &amp; \vdots
\\ C(x_n, x_1) &amp; C(x_n, x_2) &amp; \cdots &amp; C(x_n, x_n) &amp; 1
\\ 1 &amp; 1 &amp; \cdots &amp; 1 &amp; 0
\end{bmatrix},
W = \begin{bmatrix}w_1 \\ w_2 \\ \vdots \\ w_n \\ -\mu\end{bmatrix},
D = \begin{bmatrix}C(x_1, x_0) \\ C(x_2, x_0) \\ \vdots \\ C(x_n, x_0) \\ 1\end{bmatrix}
" class="tex"/>
</p><p>偏第一微分は拡張でき、行列形式 <img src="../images/Interp2/math-ff108b929d78cdee4ecec24309fabd35.png" title="C\cdot W = D" alt="C\cdot W = D" class="tex"/> として再記述できます。
</p><p>重みを解くには、行列形式の両側に <img src="../images/Interp2/math-0d61f8370cad1d412f80b84d143e1257.png" title="C" alt="C" class="tex"/> 行列の逆上列である <img src="../images/Interp2/math-a47dc6dce0f5dcbdf98b9f9acaedbd10.png" title="C^{-1}" alt="C^{-1}" class="tex"/> をかけ、<img src="../images/Interp2/math-0d1991e0e0459c51aed8bdf1b3e24c6b.png" title="W = C^{-1}\cdot D" alt="W = C^{-1}\cdot D" class="tex"/>を取得します。
</p><p>最後のステップは、共分散の決定です。上述のすべての計算は、ランダム関数内のランダム変数はすべて同じ平均と分散を持つという仮定をベースにしています。このような仮定は、モデルバリオグラムとモデルの共分散間の関係を、以下のように導きます。
</p><p><img src="../images/Interp2/math-6c614358c8aad228784cd121545158ed.png" title="\gamma (x_i, x_j) = \frac{1}{2}E[(z(x_i)-z(x_j))^2] = \frac{1}{2}E[(z(x_i))^2] + \frac{1}{2}E[(z(x_j))^2] - E[z(x_i) \cdot z(x_j)] = E[z^2]-E[z(x_i) \cdot z(x_j)] = (E[z^2] - m^2)-(E[z(x_i) \cdot z(x_j)] - m^2) = \sigma^2-C(x_i, x_j)" alt="\gamma (x_i, x_j) = \frac{1}{2}E[(z(x_i)-z(x_j))^2] = \frac{1}{2}E[(z(x_i))^2] + \frac{1}{2}E[(z(x_j))^2] - E[z(x_i) \cdot z(x_j)] = E[z^2]-E[z(x_i) \cdot z(x_j)] = (E[z^2] - m^2)-(E[z(x_i) \cdot z(x_j)] - m^2) = \sigma^2-C(x_i, x_j)" class="tex"/>
</p><p><br />
この関係式を偏第一微分に置くと、他の形式(行列形式は同様)を取得できます。
</p><p><img src="../images/Interp2/math-c615089707a749496528a86b7867b46c.png" title="\left\{\begin{matrix}\sum_{j=1}^nw_j\gamma (x_i, x_j) + \mu =\gamma (x_i, x_0)
\\ \sum_{i=1}^nw_i = 1
\end{matrix}\right." alt="\left\{\begin{matrix}\sum_{j=1}^nw_j\gamma (x_i, x_j) + \mu =\gamma (x_i, x_0)
\\ \sum_{i=1}^nw_i = 1
\end{matrix}\right." class="tex"/>
</p><p>Originでは、以下のようにパワーモデルがバリオグラムの推定に使用されます。
</p><p><img src="../images/Interp2/math-3475e8bd03c599a5c584ce940dd85bed.png" title="\gamma (h) = \left\{\begin{matrix}0 \;\;\;\;\;\;\;\;\;\;\;\;\;\; |h| = 0
\\ a + b|h|^\lambda \;\;\;\; |h| &gt; 0
\end{matrix}\right." alt="\gamma (h) = \left\{\begin{matrix}0 \;\;\;\;\;\;\;\;\;\;\;\;\;\; |h| = 0
\\ a + b|h|^\lambda \;\;\;\; |h| &gt; 0
\end{matrix}\right." class="tex"/>
</p><p>ここで<img src="../images/Interp2/math-6d15f14cbcc8d335e7f317cbd3fe04af.png" title="a = 0, b = 1" alt="a = 0, b = 1" class="tex"/> および <img src="../images/Interp2/math-2860c05f82192c0f31751cab337cbfb8.png" title="0 &lt; \lambda &lt; 2" alt="0 &lt; \lambda &lt; 2" class="tex"/> です。<img src="../images/Interp2/math-2510c39011c5be704182423e3a695e91.png" title="h" alt="h" class="tex"/> は<img src="../images/Interp2/math-1ba8aaab47179b3d3e24b0ccea9f4e30.png" title="x_i" alt="x_i" class="tex"/> と <img src="../images/Interp2/math-1f89889020cdc84d9e1c35237cb62f65.png" title="x_j" alt="x_j" class="tex"/> 間の距離を参照し、<img src="../images/Interp2/math-61957245cce023557f0dc99589c6060f.png" title="\gamma (h) = \gamma (x_i, x_j)" alt="\gamma (h) = \gamma (x_i, x_j)" class="tex"/>となります。
</p><p>この手法が使用された時の、このXファンクションのダイアログでは、<a class="external text" href="http://www.originlab.com/doc/OriginC/ref/ocmath_2d_kriging_scat" target="_blank">ocmath_2d_kriging_scat</a> 関数の <img src="../images/Interp2/math-c6a6eb61fd9c6c913da73b3642ca147d.png" title="\lambda" alt="\lambda" class="tex"/> は<b>スムージングファクター</b>、<b>検索半径</b>と<b>最小ポイント</b>(補間を含む最小のポイント) は、<i>radius</i> と <i>noctMin</i> パラメーターに対応します。
</p>
<h3><a name="Random_Renka_Cline"></a><span class="mw-headline">ランダム Renka Cline法</span></h3>
<p>ランダム Renka Cline法のアルゴリズムはは、NAGにより提供された関数<i><a class="external text" href="https://www.originlab.com/pdfs/nagcl09/manual/pdf/E01/e01sac.pdf" target="_blank">nag_2d_scat_interpolant</a></i> (e01sac)をベースにしています。しかし、<i>NAG Library: Advice on Replacement Calls for Withdrawn/Superseded Functions</i>によると、<i><a class="external text" href="https://www.originlab.com/pdfs/nagcl09/manual/pdf/E01/e01sac.pdf" target="_blank">nag_2d_scat_interpolant</a></i> (e01sac) は  <i><a class="external text" href="https://d2mvzyuse3lwjc.cloudfront.net/pdfs/NAG26/Manual/html/e01/e01sgc.html" target="_blank">nag_2d_shep_interp</a></i> (e01sgc) または <i><a class="external text" href="https://d2mvzyuse3lwjc.cloudfront.net/pdfs/NAG26/Manual/html/e01/e01sjc.html" target="_blank">nag_2d_triang_interp</a></i> (e01sjc)で置き換えられます。つまり、ランダム Renka Cline法は、 <i><a class="external text" href="https://d2mvzyuse3lwjc.cloudfront.net/pdfs/NAG26/Manual/html/e01/e01sjc.html" target="_blank">nag_2d_triang_interp</a></i> (e01sjc)をベースにした三角法に似たアルゴリズムをもちますが、後半は、最小の最大補間誤差が生成される可能性があるので推奨されます。
</p>
<h3><a name="Random_Shepard"></a><span class="mw-headline">ランダム Shepard法</span></h3>
<p>詳細は <a class="external text" href="../../UserGuide/UserGuide/Gridding_Methods_for_Randomly_Spaced_Data.html#Shepard">ランダム Shepard</a>を参照してください。
</p>
<h3><a name="Random_TPS"></a><span class="mw-headline">ランダムTPS法</span></h3>
<p>詳細は <a class="external text" href="../../UserGuide/UserGuide/Gridding_Methods_for_Randomly_Spaced_Data.html#Thin_Plate_Spline_.28TPS.29">ランダム TPS</a>を参照してください。
</p>
<h3><a name="Spline"></a><span class="mw-headline">スプライン</span></h3>
<p><i><a class="external text" href="https://d2mvzyuse3lwjc.cloudfront.net/pdfs/NAG26/Manual/html/e02/e02ddc.html" target="_blank">nag_2d_spline_fit_scat</a></i> (e02ddc) をベースにした手法で、散布データセットに3次スプライン近似を計算します。 
</p>
<h3><a name="Triangle"></a><span class="mw-headline">三角形</span></h3>
<p>この方法では、まずすべてのデータポイントを接続してドロネー三角形を作成します。三角形はできる限り等角に近く、2つの三角形は交差しません。三角形分割の理論については、<a class="external text" href="../../UserGuide/UserGuide/Creating_Contour_Graphs.html#Triangulation">このドキュメント</a>を参照してください。
</p><p>三角形分割が作成された後、三角形ベースの内挿法は、データ値と、その点を含む三角形の3つの頂点における一次偏微分のみに基づいて、ある点の値を計算します。これは、Renka と Cline によるメソッドを使用する <a class="external text" href="https://d2mvzyuse3lwjc.cloudfront.net/pdfs/NAG26/Manual/html/e01/e01sjc.html" target="_blank">nag_2d_triang_interp</a> (e01sjc) を呼び出します。 
</p><p><br />
</p>
<h3><a name="Weighting_average"></a><span class="mw-headline">加重平均法</span></h3>
<p>加重平均法は、<a class="external text" href="../../OriginC/OriginC/Ocmath_gridding_weighted_average_(global_function).html">ocmath_gridding_weighted_average</a>をベースにした手法です。未知の値 <img src="../images/Interp2/math-7c8e639ee0f96691256a24e9353459a6.png" title="P(x_p, y_p, z_p)" alt="P(x_p, y_p, z_p)" class="tex"/>  は、指定された検索半径 r 内の真の値 <img src="../images/Interp2/math-52dbc3fd7d34cbe6ae695944dca0004d.png" title="Q_i" alt="Q_i" class="tex"/> の周囲から計算されます。補間値は次式となります。
</p><p><img src="../images/Interp2/math-c3d89da1788e716717a103c968a9b94d.png" title="Z_p=\frac{\sum_{i=1}^{n}\frac{Z_i}{3d_i^2+1}}{\sum_{i=1}^{n}\frac{1}{3d_i^2+1}}" alt="Z_p=\frac{\sum_{i=1}^{n}\frac{Z_i}{3d_i^2+1}}{\sum_{i=1}^{n}\frac{1}{3d_i^2+1}}" class="tex"/>
</p><p><img src="../images/Interp2/math-d247f594c78d0d2be10fc6d82512cc4e.png" title="d_i" alt="d_i" class="tex"/> は、<img src="../images/Interp2/math-44c29edb103a2872f519ad0c9a0fdaaa.png" title="P" alt="P" class="tex"/> および <img src="../images/Interp2/math-52dbc3fd7d34cbe6ae695944dca0004d.png" title="Q_i" alt="Q_i" class="tex"/>間の距離です。検索半径内に値がない場合、Zp は欠損値になります。検索半径を拡大するということは、各ポイントは隣り合うポイントとの内部的な関係を強め、詳細な部分を失って、より滑らかな曲面を作成するということになります。
</p>
<h3><a name="Comparison"></a><span class="mw-headline">比較</span></h3>
<p>8つの手法を比較してみます。6つの関数F1からF6（指数ピーク、急斜面の曲面、山のピーク、緩やかなピーク、急勾配のピーク、球形曲面）に、8つの手法を適用しました。手法は、Ref. 2のものです。  1089ポイントの補間は、100ノードの一様分布をベースにしています。平均誤差と最大誤差は、それぞれ1089ポイントの実際の値と補間値間の差の平均と最大です。下の棒グラフは、平均誤差と最大誤差の棒グラフです。
</p><p><a  class="image"><img alt="Analysis 3.png" src="../images/Interp2/Analysis_3.png" width="800"  /></a>
</p><p>関数式：
</p><p><img src="../images/Interp2/math-f279a48ea3841522396bbc6f10f6537f.png" title="F1: 0.75e^{-\frac{(9x-2)^2+(9y-2)^2}{4}}+0.75e^{\frac{-(9x+1)^2}{49}-\frac{9y+1}{10}}+0.5e^{-\frac{(9x-7)^2+(9y-3)^2}{4}}-0.2e^{-(9x-4)^2-(9y-7)^2}" alt="F1: 0.75e^{-\frac{(9x-2)^2+(9y-2)^2}{4}}+0.75e^{\frac{-(9x+1)^2}{49}-\frac{9y+1}{10}}+0.5e^{-\frac{(9x-7)^2+(9y-3)^2}{4}}-0.2e^{-(9x-4)^2-(9y-7)^2}" class="tex"/>
</p><p><img src="../images/Interp2/math-442e7cb498cbdd3e8a8cb11de7076b9c.png" title="F2: \frac{tanh(9y-9x)+1}{9}" alt="F2: \frac{tanh(9y-9x)+1}{9}" class="tex"/>
</p><p><img src="../images/Interp2/math-8a323f741771c259f3d0251ec3713ff5.png" title="F3: \frac{1.25+cos(5.4y)}{6+6(3x-1)^2}" alt="F3: \frac{1.25+cos(5.4y)}{6+6(3x-1)^2}" class="tex"/>
</p><p><img src="../images/Interp2/math-15b5909afabd4efcf3399e446cde9039.png" title="F4: e^{\frac{-(81/16)((x-0.5)^2+(y-0.5)^2)}{3}}" alt="F4: e^{\frac{-(81/16)((x-0.5)^2+(y-0.5)^2)}{3}}" class="tex"/>
</p><p><img src="../images/Interp2/math-b12a75f2b61e2745aa115538c148f83e.png" title="F5: e^{\frac{-(81/4)((x-0.5)^2+(y-0.5)^2)}{3}}" alt="F5: e^{\frac{-(81/4)((x-0.5)^2+(y-0.5)^2)}{3}}" class="tex"/>
</p><p><img src="../images/Interp2/math-c4ca4ef5e4f555321474d4e6f24a1aec.png" title="F6: \frac{\sqrt{64-81((x-0.5)^2+(y-0.5)^2}}{9}-0.5" alt="F6: \frac{\sqrt{64-81((x-0.5)^2+(y-0.5)^2}}{9}-0.5" class="tex"/>
</p>
<h2><a name="Reference"></a><span class="mw-headline">参考文献</span></h2>
<ol><li> Isaaks and Srivastava.An Introduction to Applied Geostatistics, Chapter 12.Oxford University Press (1989)</li>
<li> R. J. Renka and A. K. Cline.A Triangle-Based <img src="../images/Interp2/math-e462b7e236c081548166a08ba6b20e24.png" title="C^1" alt="C^1" class="tex"/> Interpolation Method, Rocky Mountain Journal of Mathematics.14, 223-237 (1984)</li>
<li> P. Dierckx.An Algorithm for Surface-Fitting with Spline Functions, IMA Journal of Numerical Analysis.1, 267-283 (1981)</li></ol>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">関連するXファンクション</span></h2>
<p><a href="../../XFunction/X-Function/Interpxyz.html" title="Xファンクション:Interpxyz">interpxyz</a>
</p>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>interpolate</span></p>







    