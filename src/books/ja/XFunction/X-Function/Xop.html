<h1 class="firstheading">xop</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Brief_Information"><span class="tocnumber">1</span><span class="toctext">概要</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Command_Line_Usage"><span class="tocnumber">2</span> <span class="toctext">コマンドラインでの使用法</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#X-Function_Execution_Options"><span class="tocnumber">3</span> <span class="toctext">Xファンクションの実行オプション</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Variables"><span class="tocnumber">4</span> <span class="toctext">変数</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Description"><span class="tocnumber">5</span> <span class="toctext">説明</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Examples"><span class="tocnumber">6</span> <span class="toctext">サンプル</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Related_X-Functions"><span class="tocnumber">7</span> <span class="toctext">関連するXファンクション</span></a></li>
</ul>
</div>

<h2><a name="Brief_Information"></a><span class="mw-headline">概要</span></h2>
<p>ツリーを使用してNLFit、ANOVAなどの操作を実行
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">コマンドラインでの使用法</span></h2>
<p>詳細は下のサンプルセクションを参照してください。
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">Xファンクション実行オプション</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">スクリプトからXファンクションにアクセスする場合、追加のオプションスイッチについてのページを参照してください。</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">変数</span></h2>
<table class="xfvar">
<tr>
<th width="8%">表示<br />名
</th>
<th width="8%">変数<br />名
</th>
<th width="8%">I/O<br />と<br />データ型
</th>
<th width="8%">デフォルト<br />値
</th>
<th>説明
</th></tr>
<tr>
<td>実行モード
</td>
<td>execute
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>init</center>
</td>
<td>
<p>操作ツリーの実行モードを指定します。
</p><p>オプションリスト
</p>
<ul><li><i>init:GUIツリーの初期化</i>
<dl><dd>このメソッドは、ツリーを初期化するために使用します。</dd></dl></li>
<li><i>update:GUIツリーの編集</i>
<dl><dd>このメソッドは、ツリーを更新するために使用します。</dd></dl></li>
<li><i>run:ツリーの出力</i>
<dl><dd>このメソッドは、ツリーを出力するために使用します。</dd></dl></li>
<li><i>report:レポートを作成</i>
<dl><dd>このメソッドは、ツリーを出力してレポートを生成するために使用します。</dd></dl></li>
<li><i>cleanup:操作オブジェクトのリセット</i>
<dl><dd>このメソッドは、オペレーションオブジェクトをクリーンアップするために使用されます。</dd></dl></li></ul>
</td></tr>
<tr>
<td>クラス名
</td>
<td>classname
</td>
<td>
<p>入力
</p><p>string
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td>
<p>この変数はクラス名を指定します。
</p><p>使用可能なクラス名は次のとおりです。
</p>
<dl><dd><ul><li> DescStats: 列の統計</li>
<li> DescStats_1: 行の統計</li>
<li> NormalityTest: 正規性の検定</li>
<li> ANOVAOneWay: 一元配置の分散分析</li>
<li> ANOVATwoWay: 二元配置の分散分析</li>
<li> ANOVAOneWayRM: 繰り返しのある一元配置分散分析</li>
<li> ANOVATwoWayRM: 繰り返しのある二元配置分散分析</li>
<li> FitLinear: 線形フィット</li>
<li> FitPolynomial: 多項式フィット</li>
<li> MR: 線形多重回帰</li>
<li> FitNL: 非線形曲線フィット</li>
<li> ROCCurve: ROC曲線</li></ul></dd></dl>
</td></tr>
<tr>
<td>GUIツリー
</td>
<td>iotrgui
</td>
<td>
<p>入力/出力
</p><p>TreeNode
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td>
<p>この変数は、入出力GUIツリーを指定します。操作クラスによって異なります。
</p><p><b>ヒント</b>
</p>
<dl><dd><ol><li> レポートシートの再計算モードを切り替えるには<code>iotrgui.gui.autoupdate</code> を使用します。</li>
<li> ツリーの情報を確認するには、 <code>iotrgui.=</code>を使用します。</li></ol></dd></dl>
</td></tr>
<tr>
<td>出力ツリー
</td>
<td>otrresult
</td>
<td>
<p>出力
</p><p>TreeNode
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td>
<p>この変数は出力ツリーを指定します。操作クラスによって異なります。
</p>
</td></tr>
<tr>
<td>ダイアログテーマ
</td>
<td>theme
</td>
<td>
<p>入力
</p><p>string
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td>
<p>この変数はダイアログテーマを指定します。
</p>
</td></tr>
<tr>
<td>基線のフィットが必要
</td>
<td>baseline
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>ベースラインをフィットするかどうか指定します。
</p>
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">説明</span></h2>
<p>NLFitやANOVAなどの解析は非常に複雑で、Origin Cの操作フレームワークと呼ばれるフレームワークによって実装されています。
</p><p>このフレームワークは、Xファンクションフレームワークがまだ取り扱えないような複雑な処理を行うことができます。 
</p><p>一方で、オペレーションフレームワークは、Origin Cから呼ばれるクラスに基づいたこれらの操作を実行でき、これによりXファンクション(xop)がこれらのオペレーションクラスを実行するのに作成されます。 
</p><p>他の多くのXファンクションと同様に、xopはLabTalkで使用できるように設計されています。
</p>
<h2><a name="Examples"></a><span class="mw-headline">サンプル</span></h2>
<p>その他の例： <a class="external text" href="https://www.originlab.com/doc/LabTalk/Tutorials/Tutorial-Statistics" target="_blank">LabTalkを使用した統計</a> <a class="external text" href="https://www.originlab.com/doc/LabTalk/examples/Curve-Fitting" target="_blank">解析LabTalkスクリプトの例</a>
</p><p><b>例1：ワークシートから&quot;線形フィット&quot;を実行するxop</b>
</p><p>アクティブシートにあるA(X)B(Y)の線形フィットを実行し、レポートシートを生成します。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 最初にデータをインポート</span>

filename<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Curve Fitting\Linear Fit.dat&quot;</span>;

newbook;

impASC filename<span style="color: #000080;">$</span>;

<span style="color: #008000;">// FitLinear クラスを使用してGUIツリー&quot;lrGUI&quot;を作成</span>
tree lrGUI;
xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>init classname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>FitLinear iotrgui<span style="color: #000000;">:</span><span style="color: #000080;">=</span>lrGUI;

<span style="color: #008000;">//  GUI treeの入力データを指定</span>

lrGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Range1</span>.<span style="color: #000080;">X</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>Col<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span>;

lrGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Range1</span>.<span style="color: #000080;">Y</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>Col<span style="color: #000000;">(</span>B<span style="color: #000000;">)</span>;

<span style="color: #008000;">// 切片を0.1に固定するなど、線形フィットの設定を行なう</span>

lrGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">Fit</span>.<span style="color: #000080;">FixIntercept</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;

lrGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">Fit</span>.<span style="color: #000080;">FixInterceptAt</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0.1</span>;

<span style="color: #008000;">// 準備したGUIツリーのフィットレポートを作成</span>

xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>report iotrgui<span style="color: #000000;">:</span><span style="color: #000080;">=</span>lrGUI;

<span style="color: #008000;">//フィット後操作オブジェクトをクリーンアップ</span>

xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>cleanup;</pre>
<p><b>例2:グラフから&quot;線形回帰&quot;を実行するxop</b>
</p><p>単一レイヤ内に複数データがプロットされたグラフで線形回帰を実行し、グラフ上にフィット線を作成します。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 最初にデータをインポート</span>
filename<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Curve Fitting\Linear Fit.dat&quot;</span>; 
newbook;
impASC filename<span style="color: #000080;">$</span>;


<span style="color: #008000;">//データでグラフを作成</span>
range data <span style="color: #000080;">=</span> <span style="color: #000000;">[</span><span style="color: #000080;">&lt;</span>active<span style="color: #000080;">&gt;</span><span style="color: #000000;">]</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">2</span><span style="color: #000000;">:</span> wcol<span style="color: #000000;">(</span>wks.<span style="color: #000080;">ncols</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
plotxy data plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">201</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>active<span style="color: #000080;">&gt;</span>;  <span style="color: #008000;">// ソースデータを散布図として作図</span>


<span style="color: #008000;">//FitLinearクラスを使用してGUIツリー &quot;lrGUI&quot;を作成</span>
tree lrGUI;  
<span style="color: #008000;">//  FitLinearクラスとGUIツリーを初期化</span>
xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>init classname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>FitLinear iotrgui<span style="color: #000000;">:</span><span style="color: #000080;">=</span>lrGUI;
 
<span style="color: #008000;">//GUI treeの入力データに全てのデータプロットを指定</span>
ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
doc <span style="color: #000080;">-</span>e d <span style="color: #008000;">//アクティブレイヤの全てのプロットでループ</span>
<span style="color: #000000;">{</span>
	<span style="color: #000080;">%</span>A <span style="color: #000080;">=</span>  xof<span style="color: #000000;">(</span><span style="color: #000080;">%</span>C<span style="color: #000000;">)</span>;   <span style="color: #008000;">//XYデータセットを指定</span>
	lrGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Range</span><span style="color: #000080;">$</span><span style="color: #000000;">(</span>ii<span style="color: #000000;">)</span>.<span style="color: #000080;">X</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">%</span>A;
	lrGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Range</span><span style="color: #000080;">$</span><span style="color: #000000;">(</span>ii<span style="color: #000000;">)</span>.<span style="color: #000080;">Y</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">%</span>C;	
	range rPlot <span style="color: #000080;">=</span> <span style="color: #000080;">$</span><span style="color: #000000;">(</span>ii<span style="color: #000000;">)</span>; <span style="color: #008000;">//各データプロットのlabtalk範囲を定義</span>
	int uid <span style="color: #000080;">=</span> range2uid<span style="color: #000000;">(</span>rPlot<span style="color: #000000;">)</span>; <span style="color: #008000;">//範囲のuidを取得</span>
	lrGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Range</span><span style="color: #000080;">$</span><span style="color: #000000;">(</span>ii<span style="color: #000000;">)</span>.<span style="color: #000080;">SetAttribute</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;PlotObjUID&quot;</span>, <span style="color: #000080;">$</span><span style="color: #000000;">(</span>uid<span style="color: #000000;">)</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">//プロットのuidをセット</span>
	ii <span style="color: #000080;">=</span> ii <span style="color: #000080;">+</span> <span style="color: #0000dd;">1</span>;
<span style="color: #000000;">}</span>
<span style="color: #008000;">// 線形フィットを実行して準備したGUIツリーのレポートを作成</span>
xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>report iotrgui<span style="color: #000000;">:</span><span style="color: #000080;">=</span>lrGUI;
<span style="color: #008000;">// フィット後に線形フィット操作オブジェクトをクリーンアップ</span>
xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>cleanup;</pre>
<p><br />
<b>例3：&quot;列の統計&quot;を実行するxop</b>
</p><p>アクティブシート内のデータをグループ化して、記述統計を実行してレポートツリーを作成します。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 新しいワークブックにデータをインポート</span>

filename<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Statistics\body.dat&quot;</span>;

newbook;

impASC filename<span style="color: #000080;">$</span>;

<span style="color: #008000;">// DescStatsクラスを使用してGUIツリー &quot;statGUI&quot;を作成</span>
tree statGUI;
xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>init classname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>DescStats iotrgui<span style="color: #000000;">:</span><span style="color: #000080;">=</span>statGUI;

<span style="color: #008000;">// GUI ツリーの入力データを作成</span>

statGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Range1</span>.<span style="color: #000080;">X</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>Col<span style="color: #000000;">(</span>height<span style="color: #000000;">)</span>;

<span style="color: #008000;">// グループ化データを指定</span>

statGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Range1</span>.<span style="color: #000080;">F</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>Col<span style="color: #000000;">(</span>gender<span style="color: #000000;">)</span>;

<span style="color: #008000;">// 列の統計の設定</span>

<span style="color: #008000;">// 例として、性別ごとの最高身長が誰かを知りたいとする</span>

statGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">Quantities</span>.<span style="color: #000080;">quantiles</span>.<span style="color: #000080;">iMax</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;

<span style="color: #008000;">// 準備したGUIツリーのレポートを作成</span>

xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>run iotrgui<span style="color: #000000;">:</span><span style="color: #000080;">=</span>statGUI otrresult<span style="color: #000000;">:</span><span style="color: #000080;">=</span>statOut;

<span style="color: #008000;">//フィット後に操作オブジェクトをクリーンアップ</span>

xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>cleanup;

<span style="color: #008000;">// 結果を確認するグループラベルを含むレポートツリーを表示</span>
statout.<span style="color: #000080;">list</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span>,<span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>;
<span style="color: #008000;">// または、次の方法で結果とグループラベルを取得</span>
statout.<span style="color: #000080;">=</span>;
statout.<span style="color: #000080;">Statistics</span>.<span style="color: #000080;">c1</span>.<span style="color: #000080;">GetLabel</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>;
statout.<span style="color: #000080;">Statistics</span>.<span style="color: #000080;">c2</span>.<span style="color: #000080;">GetLabel</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>;</pre>
<p><b>例4：&quot;一元配置の分散分析&quot;を実行するxop</b>
</p><p>素データに対して一元配置分散分析を実行し、レポートシートを生成します。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">/// 新しいワークブックにデータをインポートする</span>

filename<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Statistics\ANOVA\One-Way_ANOVA_raw.dat&quot;</span>;

newbook;

impASC filename<span style="color: #000080;">$</span>;

<span style="color: #008000;">// ANOVAOneWayクラスを使用してGUIツリー &quot;onewayGUI&quot;を作成</span>
tree onewayGUI;
xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>init classname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>ANOVAOneWay iotrgui<span style="color: #000000;">:</span><span style="color: #000080;">=</span>onewayGUI;

<span style="color: #008000;">// ツリーのデフォルトデータはインデックスデータ形式なのでGUIツリーは更新する必要がある</span>

<span style="color: #008000;">//GUI ツリーから素データ形式のGUIツリーが必要</span>

<span style="color: #008000;">//LTの属性で、特別なノード&quot;.Use&quot;でアクセスする必要がある</span>

onewayGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Use</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; <span style="color: #008000;">////0 はインデックス、1 は素データ</span>

xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>update iotrgui<span style="color: #000000;">:</span><span style="color: #000080;">=</span>onewayGUI;

<span style="color: #008000;">// 更新されたGUIツリーの入力データを指定</span>

onewayGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Data</span>.<span style="color: #000080;">Factor_0</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>Col<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span>;

onewayGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Data</span>.<span style="color: #000080;">Factor_1</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>Col<span style="color: #000000;">(</span>B<span style="color: #000000;">)</span>;

onewayGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Data</span>.<span style="color: #000080;">Factor_2</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>Col<span style="color: #000000;">(</span>C<span style="color: #000000;">)</span>;

<span style="color: #008000;">// 準備したGUIツリーでOne-Way ANOVAレポートを作成</span>

xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>report iotrgui<span style="color: #000000;">:</span><span style="color: #000080;">=</span>onewayGUI;

<span style="color: #008000;">//実行後に操作オブジェクトをクリーンアップ</span>

xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>cleanup;</pre>
<p><b>例5：&quot;非線形曲線フィット&quot;を実行するxop</b>
</p><p>アクティブシートのA(X)B(Y)C(Y)にNLSFのグローバルフィットを実行し、レポートシートを生成します。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">///新しいブックにデータをインポート</span>

filename<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Curve Fitting\Gaussian.dat&quot;</span>;

newbook;

impASC filename<span style="color: #000080;">$</span>;

<span style="color: #008000;">//NLSFクラスを使用してGUIツリー&quot;nlGUI&quot;を作成</span>
tree nlGUI;
xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>init classname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>FitNL iotrgui<span style="color: #000000;">:</span><span style="color: #000080;">=</span>nlGUI;

<span style="color: #008000;">//関数と入力データを指定し、フィット前に操作ツリーを更新</span>

nlGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">FunctionSelection</span>.<span style="color: #000080;">FunctionList</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Gauss&quot;</span>;

nlGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Range1</span>.<span style="color: #000080;">X</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>Col<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span>;

nlGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Range1</span>.<span style="color: #000080;">Y</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>Col<span style="color: #000000;">(</span>B<span style="color: #000000;">)</span>;

nlGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Range2</span>.<span style="color: #000080;">X</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>Col<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span>;

nlGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Range2</span>.<span style="color: #000080;">Y</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>Col<span style="color: #000000;">(</span>C<span style="color: #000000;">)</span>;

<span style="color: #008000;">//グローバルフィットに設定</span>

<span style="color: #008000;">//LT属性で、特別なノード &quot;.Use&quot; でアクセスする必要がある</span>

nlGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Use</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span>;

xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>update iotrgui<span style="color: #000000;">:</span><span style="color: #000080;">=</span>nlGUI;

<span style="color: #008000;">//デフォルトで表示されないFix and Dependencyを表示するパラメータ表を変更t</span>

nlGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">Quantities</span>.<span style="color: #000080;">Parameters</span>.<span style="color: #000080;">Fix</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;

nlGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">Quantities</span>.<span style="color: #000080;">Parameters</span>.<span style="color: #000080;">Dependency</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;

<span style="color: #008000;">//両方のデータセットでy0を値0に固定</span>

nlGUI.<span style="color: #000080;">UserSettings</span>.<span style="color: #000080;">Parameters</span>.<span style="color: #000080;">Values</span>.<span style="color: #000080;">y0</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;

nlGUI.<span style="color: #000080;">UserSettings</span>.<span style="color: #000080;">Parameters</span>.<span style="color: #000080;">Fixed</span>.<span style="color: #000080;">y0</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;

nlGUI.<span style="color: #000080;">UserSettings</span>.<span style="color: #000080;">Parameters</span>.<span style="color: #000080;">Values</span>.<span style="color: #000080;">y0_2</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;

nlGUI.<span style="color: #000080;">UserSettings</span>.<span style="color: #000080;">Parameters</span>.<span style="color: #000080;">Fixed</span>.<span style="color: #000080;">y0_2</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;

<span style="color: #008000;">//wを共有</span>

nlGUI.<span style="color: #000080;">UserSettings</span>.<span style="color: #000080;">Parameters</span>.<span style="color: #000080;">Share</span>.<span style="color: #000080;">w</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;

xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>report iotrgui<span style="color: #000000;">:</span><span style="color: #000080;">=</span>nlGUI;

<span style="color: #008000;">//フィット後に操作オブジェクトをクリーンアップ</span>

xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>cleanup;</pre>
<p><b>例6: &quot;線形多重回帰&quot;を実行するxop</b>
</p><p>アクティブシートに3つの独立変数と1つの従属変数を持つデータに重回帰を実行し、レポートシートを生成します。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// データをインポート</span>
filename<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Curve Fitting\Multiple Linear Regression.dat&quot;</span>;
newbook;
impASC filename<span style="color: #000080;">$</span>;

<span style="color: #008000;">// 重回帰クラスを使用してGUIツリー &quot;mrGUI&quot;を作成</span>
tree mrGUI;
xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>init classname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>MR iotrgui<span style="color: #000000;">:</span><span style="color: #000080;">=</span>mrGUI;

<span style="color: #008000;">// GUIツリーの入力データを指定</span>
mrGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Range1</span>.<span style="color: #000080;">X</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>col<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span><span style="color: #000000;">:</span>col<span style="color: #000000;">(</span>C<span style="color: #000000;">)</span>;
mrGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Range1</span>.<span style="color: #000080;">Y</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>col<span style="color: #000000;">(</span>D<span style="color: #000000;">)</span>;
 
<span style="color: #008000;">// 全てのツリーノードを確認するため設定を指定</span>
<span style="color: #008000;">// この例では、実行後にコマンド &quot;mrGUI.=&quot; を使用</span>
mrGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">Quantities</span>.<span style="color: #000080;">Parameters</span>.<span style="color: #000080;">ConfInterval</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
mrGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">Quantities</span>.<span style="color: #000080;">Statistics</span>.<span style="color: #000080;">ReducedChiSq</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
mrGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">ResAnalysis</span>.<span style="color: #000080;">Stad</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
mrGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">Residuals</span>.<span style="color: #000080;">Graph3</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
mrGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">Residuals</span>.<span style="color: #000080;">Graph4</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
mrGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">Residuals</span>.<span style="color: #000080;">Graph5</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
mrGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">Residuals</span>.<span style="color: #000080;">Graph6</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
mrGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">Residuals</span>.<span style="color: #000080;">Graph7</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;

<span style="color: #008000;">// 準備したGUIツリーのレポートを作成</span>
xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>report iotrgui<span style="color: #000000;">:</span><span style="color: #000080;">=</span>mrGUI;
 
<span style="color: #008000;">//操作オブジェクトをクリーンアップ</span>
xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>cleanup;</pre>
<p><b>例7: ROC曲線の正の状態値を設定するxop</b>
</p>
<pre class="lt" style="font-family:monospace;">newbook;
fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Statistics\sodium.dat&quot;</span>;
impasc fname<span style="color: #000080;">$</span>;

xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>init classname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>ROCCurve iotrgui<span style="color: #000000;">:</span><span style="color: #000080;">=</span>rocGUI;

<span style="color: #008000;">//GUIツリーで入力データを指定</span>
rocGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Range1</span>.<span style="color: #000080;">X</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;1!col(B)&quot;</span>;

<span style="color: #008000;">// グループ化データを指定</span>
rocGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Range1</span>.<span style="color: #000080;">F</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;1!Col(A)&quot;</span>;

<span style="color: #008000;">/// StateValueは古い互換性の使用法であり、項目はスペースで区切る</span>
rocGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">CompControl</span>.<span style="color: #000080;">StateValue</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;RMSF&quot;</span>;
StringArray stateList <span style="color: #000080;">=</span> <span style="color: #000000;">{</span><span style="color: #ff00ff;">&quot;RMSF&quot;</span><span style="color: #000000;">}</span>;
rocGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">CompControl</span>.<span style="color: #000080;">StateList</span>.<span style="color: #000080;">SetStrArray</span><span style="color: #000000;">(</span>stateList<span style="color: #000000;">)</span>;

xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>report iotrgui<span style="color: #000000;">:</span><span style="color: #000080;">=</span>rocGUI;</pre>
<p><b>例8: XOPを使用して行の統計を実行する場合に単位行の内容でグループ化</b>
</p>
<pre class="lt" style="font-family:monospace;">tree statGUI;
xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>init classname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>DescStats_1 iotrgui<span style="color: #000000;">:</span><span style="color: #000080;">=</span>statGUI; 
statGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Range1</span>.<span style="color: #000080;">X</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>col<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span><span style="color: #000000;">:</span>col<span style="color: #000000;">(</span><span style="color: #0000dd;">4</span><span style="color: #000000;">)</span>; <span style="color: #008000;">//データ</span>
statGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Range1</span>.<span style="color: #000080;">F</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;A[U]:D[U]&quot;</span>; <span style="color: #008000;">//グループ化</span>
statGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">Output</span>.<span style="color: #000080;">Report</span>.<span style="color: #000080;">Book</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;&quot;</span>;		<span style="color: #008000;">//新しい別のブックを作成するか &quot;&quot; をアクティブに設定する場合にのみ使用</span>
statGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">Output</span>.<span style="color: #000080;">Report</span>.<span style="color: #000080;">BookName</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;&quot;</span>; 	<span style="color: #008000;">// ブックロングネーム</span>
statGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">Output</span>.<span style="color: #000080;">Report</span>.<span style="color: #000080;">Sheet</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;&quot;</span>;   	<span style="color: #008000;">//新しいシートを作成するか、&quot;&quot;をアクティブに設定する場合にのみ使用</span>
statGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">Output</span>.<span style="color: #000080;">Report</span>.<span style="color: #000080;">SheetName</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;&quot;</span>;  	<span style="color: #008000;">//シートロングネーム</span>
xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>Report iotrgui<span style="color: #000000;">:</span><span style="color: #000080;">=</span>statGUI otrresult<span style="color: #000000;">:</span><span style="color: #000080;">=</span>statOut;	<span style="color: #008000;">// Execute:=RUN (ツリーのみ取得) または REPORT (通常のレポートを取得)を使用</span>
xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>cleanup;<span style="color: #008000;">// 別の計算を実行する前にクリーンアップが必要</span></pre>
<p><b>例9:行列オブジェクトで&quot;列の統計&quot;を実行するxop</b>
</p>
<pre class="lt" style="font-family:monospace;">tree statGUI;
xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>init classname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>DescStats iotrgui<span style="color: #000000;">:</span><span style="color: #000080;">=</span>statGUI;
statGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Range1</span>.<span style="color: #000080;">X</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span>MBook1<span style="color: #000000;">]</span>MSheet1<span style="color: #000080;">!</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">0</span>; <span style="color: #008000;">//全行列オブジェクト</span>
statGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">Output</span>.<span style="color: #000080;">Report</span>.<span style="color: #000080;">Book</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Book1&quot;</span>; <span style="color: #008000;">//デフォルト値を使用しない。デフォルトはソースブックに出力するが現在のソースブックは行列</span>
statGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">Output</span>.<span style="color: #000080;">FlatOut</span>.<span style="color: #000080;">Book</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;&lt;report&gt;&quot;</span>; <span style="color: #008000;">//同じブックにレポートシートを出力</span>
xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>report iotrgui<span style="color: #000000;">:</span><span style="color: #000080;">=</span>statGUI; <span style="color: #008000;">//レポートを取得</span>
xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>cleanup; <span style="color: #008000;">// 別の計算を実行する前にクリーンアップが必要</span></pre>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">関連するXファンクション</span></h2>







    