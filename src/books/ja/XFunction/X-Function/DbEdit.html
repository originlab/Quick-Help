<h1 class="firstheading">dbEdit</h1>
<table id="toc" class="toc" summary="Contents">
<tr>
<td>
<div id="toctitle">
<h2>内容</h2>
</div>
<ol>
<li class="kadov-p"><a href="#Brief_Information"><span class="tocnumber">1</span> <span class="toctext">概要</span></a></li>
<li class="kadov-p"><a href="#Additional_Information"><span class="tocnumber">2</span> <span class="toctext">追加の情報</span></a></li>
<li class="kadov-p"><a href="#Command_Line_Usage"><span class="tocnumber">3</span> <span class="toctext">コマンドラインでの使用法</span></a></li>
<li class="kadov-p"><a href="#Variables"><span class="tocnumber">4</span> <span class="toctext">変数</span></a></li>
<li class="kadov-p"><a href="#Description"><span class="tocnumber">5</span> <span class="toctext">説明</span></a>
<ol>
<li class="kadov-p"><a href="#ODS_file"><span class="tocnumber">5.1</span> <span class="toctext">ODSファイル</span></a></li>
<li class="kadov-p"><a href="#ODQ_file"><span class="tocnumber">5.2</span> <span class="toctext">ODQファイル</span></a></li>
<li class="kadov-p"><a href="#Connection_String"><span class="tocnumber">5.3</span> <span class="toctext">接続文字列</span></a></li>
</ol>
</li>
<li class="kadov-p"><a href="#Examples"><span class="tocnumber">6</span> <span class="toctext">サンプル</span></a></li>
<li class="kadov-p"><a href="#Related_X-Functions"><span class="tocnumber">7</span> <span class="toctext">関連のXファンクション</span></a></li>
</ol>
</td>
</tr>
</table>
<a name="Brief_Information" id="Brief_Information"></a>
<h2><span class="mw-headline">概要</span></h2>
<p>クエリの作成/編集/削除/読込み</p>
<a name="Additional_Information" id="Additional_Information"></a>
<h2><span class="mw-headline">追加の情報</span></h2>
<p>このXファンクションは、自動GetNダイアログには対応していません。</p>
<a name="Command_Line_Usage" id="Command_Line_Usage"></a>
<h2><span class="mw-headline">コマンドラインでの使用法</span></h2>
<ol>
<li class="kadov-p" style="font-family: monospace;"><code style="font-family: monospace;">dbEdit execute:=change;</code></li>
<li class="kadov-p" style="font-family: monospace;"><code style="font-family: monospace;">dbEdit execute:=load fname:="%Ystars.ods" iw:=[book2]sheet1!;</code></li>
<li class="kadov-p" style="font-family: monospace;"><code style="font-family: monospace;">dbEdit sql:="Select Stars.Name, Stars.LightYears From Stars";</code></li>
</ol>
<a name="Variables" id="Variables"></a>
<h2><span class="mw-headline">変数</span></h2>
<table class="xfvar">
<tr>
<th style="width: 8%;">表示<br />
名</th>
<th style="width: 8%;">変数<br />
名</th>
<th style="width: 8%;">I/O<br />
と<br />
データ型</th>
<th style="width: 8%;">デフォルト<br />
値</th>
<th>説明</th>
</tr>
<tr>
<td>コマンドオプション</td>
<td>execute</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">0</p>
</td>
<td>ワークシートに実行するデータベース操作を指定します。
<p>オプションリスト:</p>
<ul>
<li class="kadov-p"><i style="font-style: italic;">change:クエリの作成/修正</i>
<dl>
<dd>クエリを作成、または編集するための <b>クエリービルダ</b> ダイアログが開きます。</dd>
</dl>
</li>
<li class="kadov-p"><i style="font-style: italic;">askrem:確認してクエリを削除</i>
<dl>
<dd>確認後、ワークシートからクエリーを削除します。</dd>
</dl>
</li>
<li class="kadov-p"><i style="font-style: italic;">load:クエリファイルのロード</i>
<dl>
<dd>ワークシートにクエリー(.ODQ または.ODS) ファイルをロードします。ファイル名は変数 <b>fname</b> で指定する必要があります。</dd>
</dl>
</li>
<li class="kadov-p"><i style="font-style: italic;">remove:クエリを削除</i>
<dl>
<dd>ワークシートからクエリーを削除します。</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr>
<td>ODQまたはODSファイルのパスを入力します。</td>
<td>fname</td>
<td>
<p>入力</p>
<p>string</p>
</td>
<td>
<p style="text-align: center;">""</p>
</td>
<td>変数 <b>execute</b> が<b>ロード</b>されると、読み込まれる.odq または.ods ファイルのパスを指定するためにこの変数を使用することができます。</td>
</tr>
<tr>
<td>ワークシート</td>
<td>iw</td>
<td>
<p>入力</p>
<p>Worksheet</p>
</td>
<td>
<p style="text-align: center;">&lt;active&gt;</p>
</td>
<td>操作を実行するワークシートを指定します。</td>
</tr>
<tr>
<td>新しいSQL文字列</td>
<td>sql</td>
<td>
<p>入力</p>
<p>string</p>
</td>
<td>
<p style="text-align: center;">""</p>
</td>
<td>ワークシートの現在のクエリー内に書く新しいSQL 文字列を指定します。</td>
</tr>
<tr>
<td>新しい接続文字列</td>
<td>connect</td>
<td>
<p>入力</p>
<p>string</p>
</td>
<td>
<p style="text-align: center;">""</p>
</td>
<td>ワークシートの現在のクエリー内に書く新しい接続文字列を指定します。</td>
</tr>
<tr>
<td>インポートオプション</td>
<td>option</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">0</p>
</td>
<td>データをインポートする方法を指定します。
<p>オプションリスト:</p>
<ul>
<li class="kadov-p"><i style="font-style: italic;">ado:データをインポートするのにADO オブジェクトを使用します。</i>
<dl>
<dd>データをインポートするのにADO オブジェクトを使用します。</dd>
</dl>
</li>
<li class="kadov-p"><i style="font-style: italic;">odbc:データをインポートするのにODBC を使用します。</i>
<dl>
<dd>データをインポートするのにODBCを使用します。</dd>
</dl>
</li>
</ul>
</td>
</tr>
</table>
<a name="Description" id="Description"></a>
<h2><span class="mw-headline">説明</span></h2>
<p>このツールは、 <a href="../../UserGuide/UserGuide/The_Query_Builder_Dialog_Box.html" title="http://docwiki.originlab.com/index.php?title=UserGuide:The_Query_Builder_Dialog_Box" rel="nofollow"><b>クエリビルダ</b>ダイアログ</a> (<b>ファイル：データベースのインポート：新規作成</b>) を開いたり、データベースクエリを削除/ロード/編集します。</p>
<p>データベースに接続しているとき、クエリビルダは通常、ODQファイルとODSファイルの2種類のファイルを作成します。これらのファイルをクエリビルダに保存した後、テキストエディタ(メモ帳など)を使って開くことができます。</p>
<a name="ODS_file" id="ODS_file"></a>
<h3><span class="mw-headline">ODSファイル</span></h3>
<p><b style="font-weight: bold;">データソース</b>ファイル ODSファイルには、Originと外部データベースを接続するための<b><i>接続文字列</i></b>が含まれています。 ファイルには、サーバの名前、データベースの場所、サーバに接続するのに必要なユーザIDとパスワードなどの情報が含まれます。</p>
<p>データベースに接続した後、クエリビルダの<b>クエリ：データソース：保存</b>メニューを使って、ODSファイルを作成することができます。以下は、SQLサーバデータベースのサンプルです。</p>
<p><font color="#000080">[DataSource]<br />
Provider=SQLOLEDB.1;Password=abc123;Persist Security Info=True;User ID=tester;Initial Catalog=Northwind;Data Source=MYSQLSERVER;Use Procedure for Prepare=1;Auto Translate=True;Packet Size=4096;Workstation ID=MYSQLSERVER;Use Encryption for Data=False;Tag with column collation when possible=False</font></p>
<a name="ODQ_file" id="ODQ_file"></a>
<h3><span class="mw-headline">ODQファイル</span></h3>
<p><b style="font-weight: bold;">データクエリ</b>ファイル ODQファイルには、データベースから情報を取り出すのに使用する<b><i>接続文字列</i></b>と<b><i>SQLクエリ</i></b>の両方が含まれています。</p>
<p>データベースに接続した後、クエリビルダの<b>クエリ：保存</b>メニューを使って、ODQファイルを作成することができます。以下は、Oracleデータベースのサンプルです。</p>
<p><font color="#000080">[DataSource]<br />
Provider=OraOLEDB.Oracle.1;Password=tiger;Persist Security Info=True;User ID=scott;Data Source=orcl;Extended Properties=""</font></p>
<p><font color="#000080">[SQL]<br />
Select SCOTT.DEPT.DNAME, SCOTT.DEPT.LOC, SCOTT.EMP.ENAME, SCOTT.EMP.JOB, SCOTT.EMP.SAL<br />
From SCOTT.DEPT Inner Join SCOTT.EMP On SCOTT.DEPT.DEPTNO = SCOTT.EMP.DEPTNO</font></p>
<p><font color="#000080">[UseODBC]<br />
ADO</font></p>
<a name="Connection_String" id="Connection_String"></a>
<h3><span class="mw-headline">接続文字列</span></h3>
<p>上記で示した2つのサンプルは、ODSまたはODQファイルのいずれかが <b><i>[DataSource]</i></b> セクションに接続文字列を含んでいることを示しています。そして、クエリビルダダイアログでこの文字列を見つけることもできます。</p>
<dl>
<dd><img src="../images/DbEdit/ADO_Connect_String.png" alt="" style="border: none;" width="543" height="331" border="0" /></dd>
</dl>
<p>クエリをスクリプト(またはOrigin C)で実行するとき、キーとなるのは、データベース接続をセットアップして、クエリを発行するためにこの接続文字列を使うことです。そのため、データベースに検索要求する前に、<b>クエリビルダ</b>を使って、接続文字列を構築して、そしてコード内でこの文字列をコピーして使用するようにします。</p>
<a name="Examples" id="Examples"></a>
<h2><span class="mw-headline">サンプル</span></h2>
<p>このサンプルは、Originの組み込みのサンプルデータベース(MS ACCESS)からデータを取得するものです。データベースを接続するとき、クエリビルダダイアログを使って、接続文字列を構築してください。</p>
<pre class="lt">
<span style="color: #008000;">// 接続文字列の構築 </span><span style="color: #008000;">
// クエリビルダを使って、接続文字列を構築してください。</span>
string strdb<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span>
                <span style="color: #ff00ff;">"Samples\Import and Export\stars.mdb"</span>;
 
string strConn<span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">"Provider=Microsoft.Jet.OLEDB.4.0;
                Data Source=%(strdb$); User ID=; Password=;"</span>;
 <span style="color: #008000;">
// SQL</span>
string strSQL<span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">"SELECT Stars.Index, Stars.Name, Stars.LightYears, Stars.Magnitude
                FROM Stars
                WHERE Stars.LightYears&lt;=100
                ORDER BY Stars.Magnitude, Stars.LightYears"</span>;
 <span style="color: #008000;">
// データベースを接続し、SQLを発行する</span>
dbEdit change conn<span style="color: #000000;">:</span><span style="color: #000080;">=</span>strConn<span style="color: #000080;">$</span> sql<span style="color: #000000;">:</span><span style="color: #000080;">=</span>strSQL<span style="color: #000080;">$</span>;<span style="color: #008000;">
// データのインポート</span>
dbImport;<span style="color: #008000;">
// データベースの接続解除</span>
dbEdit remove;
</pre>
<a name="Related_X-Functions" id="Related_X-Functions"></a>
<h2><span class="mw-headline">関連のXファンクション</span></h2>
<p><a href="DbImport.html" title="X-Function:DbImport">dbImport</a>, <a href="DbInfo.html" title="X-Function:DbInfo">dbInfo</a>, <a href="DbPreview.html" title="X-Function:DbPreview">dbPreview</a></p>
