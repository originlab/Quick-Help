<h1 class="firstheading">plotstack（積み上げグラフを作図）</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">メニュー情報</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">概要</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Command_Line_Usage"><span class="tocnumber">3</span> <span class="toctext">コマンドラインでの使用法</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#X-Function_Execution_Options"><span class="tocnumber">4</span> <span class="toctext">Xファンクションの実行オプション</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Variables"><span class="tocnumber">5</span> <span class="toctext">変数</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Description"><span class="tocnumber">6</span> <span class="toctext">説明</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Examples"><span class="tocnumber">7</span> <span class="toctext">サンプル</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Related_X-Functions"><span class="tocnumber">8</span> <span class="toctext">関連するXファンクション</span></a></li>
</ul>
</div>

<h2><a name="Menu_Information"></a><span class="mw-headline">メニュー情報</span></h2>
<p>作図&nbsp;: 2D&nbsp;: 複数区分/軸&nbsp;: 積み上げ
</p>
<h2><a name="Brief_Information"></a><span class="mw-headline">概要</span></h2>
<p>複数区分の積み上げグラフを作成
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">コマンドラインでの使用法</span></h2>
<pre>
1. plotstack iy:=((1,2), (3,4)) plottype:=line;
2. plotstack iy:=((1,2), (3,4)) legend:=combine link:=0;
3. plotstack iy:=((1,2),(1,3),(1,4)) plottype:=custom custom:=&quot;203 200&quot; number:=&quot;1 2&quot;;
</pre>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">Xファンクションの実行オプション</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">スクリプトからXファンクションにアクセスする場合、追加のオプションスイッチについてのページを参照してください。</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">変数</span></h2>
<table class="xfvar">
<tr>
<th width="8%">表示<br />名
</th>
<th width="8%">変数<br />名
</th>
<th width="8%">I/O<br />と<br />データ型
</th>
<th width="8%">デフォルト<br />値
</th>
<th>説明
</th></tr>
<tr>
<td>入力
</td>
<td>iy
</td>
<td>
<p>入力
</p><p>XYRange
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> 入力範囲を指定
</td></tr>
<tr>
<td>グラフタイプ
</td>
<td>plottype
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> プロットタイプを指定します。
<p>オプションリスト：
</p>
<ul><li><i>line:折れ線</i>
<dl><dd>折れ線グラフ</dd></dl></li>
<li><i>scatter:散布図</i>
<dl><dd>散布図</dd></dl></li>
<li><i>linesymb:線+シンボル</i>
<dl><dd>線＋シンボルグラフ</dd></dl></li>
<li><i>column:縦棒</i>
<dl><dd>縦棒グラフ</dd></dl></li>
<li><i>template:テンプレートの使用</i>
<dl><dd>各レイヤのプロットについて指定したテンプレート（<b>グラフテンプレート</b>で指定）のプロットタイプを使用します。指定されたテンプレートのプロットタイプの数をn、各レイヤの最大プロット数をmとします。nがmより小さくない場合、テンプレート内の最初のm個のプロットタイプが使用されます。または、テンプレート内のすべてのプロットタイプが最初のn個のプロットに使用され、他のプロットはテンプレートの最後のプロットタイプが使用されます。</dd></dl></li>
<li><i>custom:カスタム</i>
<dl><dd><b>custom</b> 変数で指定したプロットタイプを使用します。</dd></dl></li></ul>
</td></tr>
<tr>
<td>各レイヤ中のグラフタイプ
</td>
<td>custom
</td>
<td>
<p>入力
</p><p>string
</p>
</td>
<td> <center>200</center>
</td>
<td>  <b>プロットタイプ</b>が<b>カスタム</b>の場合にこの設定を使用できます。各レイヤのプロットに対してグラフタイプを指定できます。各プロットタイプは、独自の値を持ち、スペース区切りで入力して二重引用符で囲みますｌ。プロットタイプに対応する値は<a class="external text" href="../../LabTalk/LabTalk/Plot_Type_IDs.html">こちら</a>をクリックして参照してください。指定するタイプの数がレイヤ内のプロットの数より少ない場合、テンプレートに保存されたプロットタイプが使用されます。
</td></tr>
<tr>
<td>グラフテンプレート
</td>
<td>template
</td>
<td>
<p>入力
</p><p>string
</p>
</td>
<td> <center>stack</center>
</td>
<td> グラフページのテンプレートを指定します。<b>プロットタイプ</b>が<b>テンプレートの使用</b>の場合は、テンプレートに保存されたプロットタイプが使用されます。Origin2018以降、*.otpu および *.otp テンプレートの両方をサポートしています。
</td></tr>
<tr>
<td>向き
</td>
<td>portrait
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> グラフの向きを指定します。
<p>オプションリスト：
</p>
<ul><li><i>landscape:横</i>
<dl><dd>グラフの向きを横にします。</dd></dl></li>
<li><i>portrait:縦</i>
<dl><dd>グラフの向きを縦にします。</dd></dl></li></ul>
</td></tr>
<tr>
<td>積上げの方向
</td>
<td>dir
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> 積上げ方向を指定します。
<p>オプションリスト：
</p>
<ul><li><i>vertical:垂直</i>
<dl><dd>全レイヤを垂直方向に積み上げます。 </dd></dl></li>
<li><i>horizontal:水平(X・Y軸の交換)</i>
<dl><dd>全レイヤを水平方向に積み上げます。X、Y軸が交換されるので注意してください。</dd></dl></li>
<li><i>hstack:水平</i>
<dl><dd>全レイヤを水平方向に積み上げます。XとY軸は交換しません。</dd></dl></li></ul>
</td></tr>
<tr>
<td>レイヤの順序
</td>
<td>order
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> レイヤの並び順を指定します。
<p>オプションリスト：
</p>
<ul><li><i>top:上から下/左から右</i>
<dl><dd>レイヤは、最初のレイヤが他のレイヤの上または左に来るように、上から下（<b>積上げ方向</b>が<b>垂直</b>の場合）または左から右（<b>積上げ方向</b>が<b>水平（XY軸の交換)</b>の場合）へ配置されます。</dd></dl></li>
<li><i>bottom:下から上/右から左</i>
<dl><dd>レイヤは、最後のレイヤが他のレイヤの上または左に来るように、下から上（<b>積上げ方向</b>が<b>垂直</b>の場合）または右から左（<b>積上げ方向</b>が<b>水平（XY軸の交換)</b>の場合）へ配置されます。</dd></dl></li></ul>
</td></tr>
<tr>
<td>凡例
</td>
<td>legend
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> グラフの凡例をどのように作成するか指定します。
<p>オプションリスト：
</p>
<ul><li><i>none:凡例なし</i>
<dl><dd>グラフ内に凡例を配置しません。</dd></dl></li>
<li><i>seperate:各レイヤ毎の凡例</i>
<dl><dd>各レイヤで個別の凡例を作成します。</dd></dl></li>
<li><i>combine:全てのページ用の1つの凡例</i>
<dl><dd>全レイヤのデータプロットを1つのグラフ凡例にまとめます。 </dd></dl></li></ul>
</td></tr>

<tr>
<td>目盛とラベルを交互に表示
</td>
<td>alternate
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>グラフレイヤの左右（あるいは下側と上側）に軸の目盛りやラベルを交互に表示させるかどうかを指定します。
<br />レイヤを垂直方向に重ねると、Y軸が左右に交互に表示されます。レイヤを水平方向に重ねた場合、X軸は下と上に交互に表示されます。
</p><p>オプションリスト：
</p>
<ul><li><i>0=偽</i></li>
<li><i>1=真</i></li></ul>
</td></tr>
<tr>
<td>1つのY/X軸タイトルを表示
</td>
<td>uniqueYTitle
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> 全レイヤでY/X軸タイトルを一つだけ表示するか指定します。
<p>オプションリスト：
</p>
<ul><li><i>0=偽</i></li>
<li><i>1=真</i></li></ul>
</td></tr>
<tr>
<td>リンクレイヤ
</td>
<td>link
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> レイヤ同士をリンクするかどうかを指定します。
</td></tr>
<tr>
<td>X軸のリンク
</td>
<td>xlink
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> この変数は<b>レイヤをリンク</b>チェックボックスが選択されている場合にのみ有効です。各レイヤのX軸間のリンクを作成するか指定します。
<p>オプションリスト：
</p>
<ul><li><i>none:なし</i>
<dl><dd>X軸スケール間のリンクを作成しません。</dd></dl></li>
<li><i>straight:直接(1対1)</i>
<dl><dd>子レイヤのX軸が親レイヤのスケール値を反映するリンクを作成します。</dd></dl></li></ul>
</td></tr>
<tr>
<td>単位
</td>
<td>unit
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>6</center>
</td>
<td> この変数は<b>レイヤをリンク</b>チェックボックスが選択されている場合にのみ有効です。レイヤに対する単位を指定します。
<p>オプションリスト：
</p>
<ul><li><i>page:ページの%</i>
<dl><dd>この単位は、ページ サイズに対して同じレイヤサイズを維持する際に便利なオプションです。これを選択すると、レイヤの左、上、高さ、幅は、グラフページの高さと幅の割合で表示されます。 </dd></dl></li>
<li><i>inch:インチ</i>
<dl><dd>これを選択すると、レイヤの左、上、高さ、幅はインチで表示されます。</dd></dl></li>
<li><i>cm:cm</i>
<dl><dd>これを選択すると、レイヤの左、上、高さ、幅はcmで表示されます。</dd></dl></li>
<li><i>mm:mm</i>
<dl><dd>これを選択すると、レイヤの左、上、高さ、幅はmmで表示されます。</dd></dl></li>
<li><i>pixel:ピクセル</i>
<dl><dd>これを選択すると、レイヤの左、上、高さ、幅はピクセルで表示されます。</dd></dl></li>
<li><i>point:ポイント</i>
<dl><dd>これを選択すると、レイヤの左、上、高さ、幅はポイントで表示されます。</dd></dl></li>
<li><i>link:リンクレイヤの%</i>
<dl><dd>この単位を使用すると、親レイヤ枠の寸法に対して、子レイヤの枠の寸法とオフセットを指定できます。このオプションが選択されると、左、上、高さ、幅は、親レイヤ枠の高さと幅の割合で表示されます。 </dd></dl></li></ul>
</td></tr>
<tr>
<td>レイヤの数
</td>
<td>layer
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>&lt;自動&gt;</center>
</td>
<td> レイヤの数を指定します。Xデータセットが1つの場合、デフォルトでは全Yデータが個別のレイヤにプロットされるので、レイヤの数とプロットの数は同じです。複数のXデータセットがある場合、各Yデータセットから見て左側にある直近のXデータセットに対してプロットされるのがデフォルトです。このデフォルトの構成は、レイヤの数と各レイヤ中のプロットの数を指定することで編集できます（例: plotstack layer:=3 number:=&quot;2 2 9&quot;）。X列の数はレイヤの数を超えることはできません。
</td></tr>
<tr>
<td>各レイヤ中のプロットの数
</td>
<td>number
</td>
<td>
<p>入力
</p><p>string
</p>
</td>
<td> <center>1</center>
</td>
<td> 各レイヤのプロットの数を指定します。スペース区切りの値を入力することで各レイヤ内のプロット数を一つずつ指定できます。例: 1 2 3
</td></tr>
<tr>
<td>垂直/水平の間隔
</td>
<td>gapy
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> 各レイヤ間の垂直方向の間隔 (<b>積上げの方向</b>が<b>垂直</b>のとき) または、水平の間隔 (when <b>積上げの方向</b> が<b>水平(X・Y軸の交換)</b>のとき)を指定します。
</td></tr>
<tr>
<td>左端余白
</td>
<td>leftmg
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>15</center>
</td>
<td> ページの左余白を指定します。
</td></tr>
<tr>
<td>右端余白
</td>
<td>rightmg
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>10</center>
</td>
<td> ページの右余白を指定します。
</td></tr>
<tr>
<td>上部余白
</td>
<td>topmg
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>10</center>
</td>
<td> ページの上余白を指定します。
</td></tr>
<tr>
<td>下部余白
</td>
<td>bottommg
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>10</center>
</td>
<td> ページの下余白を指定します。
</td></tr>
<tr>
<td>新しく作成したグラフを非表示
</td>
<td>hide
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> 新しく作成したグラフを非表示にするかどうかを指定します。このオプションはダイアログでは非表示です。Labtalkスクリプトを使うばあいのみ値を割り当てることができます。
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">説明</span></h2>
<p>指定した範囲を積み上げグラフにするXファンクションです。各レイヤのプロットタイプを編集できるほか、レイヤの積み上げ方向を垂直または水平にするか指定できます。
</p><p>詳細は、Originヘルプの<a class="external text" href="../../UserGuide/UserGuide/Stack_Graph.html">積み上げグラフ</a>をご覧下さい。
</p>
<h2><a name="Examples"></a><span class="mw-headline">サンプル</span></h2>
<ul><li> サンプルコード</li></ul>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// plotstack関数は作図&nbsp;: 複数区分/軸&nbsp;:</span>
<span style="color: #008000;">// 積み上げメニューで使用されますが、さらに</span>
<span style="color: #008000;">// テンプレート指定が可能</span>
newbook;
string fn<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Graphing\Linked Layers 1.dat&quot;</span>;
impasc fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>fn<span style="color: #000080;">$</span>;
<span style="color: #000080;">%</span>N <span style="color: #000080;">=</span> <span style="color: #000080;">%</span>H;
<span style="color: #008000;">// 全列 vs 列1の積み上げグラフを作成</span>
plotstack iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">:</span>end<span style="color: #000000;">)</span> plottype<span style="color: #000000;">:</span><span style="color: #000080;">=</span>line link<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> xlink<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;

<span style="color: #008000;">// 列2対列1、列4対列3の積み上げグラフを作成</span>
win <span style="color: #000080;">-</span>a <span style="color: #000080;">%</span>N;
plotstack iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">(</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">)</span>, <span style="color: #000000;">(</span><span style="color: #0000dd;">3</span>,<span style="color: #0000dd;">4</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span> plottype<span style="color: #000000;">:</span><span style="color: #000080;">=</span>column link<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;

<span style="color: #008000;">// 使用するテンプレートを指定できますが、この関数はデータセットごとに</span>
<span style="color: #008000;">// テンプレートのインスタンスをロードするため、このテンプレートは単一レイヤのテンプレートである必要があります。</span>
<span style="color: #008000;">// スタイルホルダを使用する場合は、プロットタイプがテンプレートと一致している必要があります。</span>
win <span style="color: #000080;">-</span>a <span style="color: #000080;">%</span>N;
plotstack iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">(</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">)</span>,<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">3</span><span style="color: #000000;">)</span>,<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">4</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span> plottype<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span> template<span style="color: #000000;">:</span><span style="color: #000080;">=</span>column;

<span style="color: #008000;">// すべてのワークシートを最小化し、残りのウィンドウを並べる</span>
doc <span style="color: #000080;">-</span>e W <span style="color: #000000;">{</span>
    win <span style="color: #000080;">-</span>i;
<span style="color: #000000;">}</span>
win <span style="color: #000080;">-</span>s T;  <span style="color: #008000;">//ウィンドウを水平方向に並べる horizontally</span></pre>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">関連するXファンクション</span></h2>
<p><a href="../../XFunction/X-Function/Newpanel.html" title="Xファンクション:Newpanel">newpanel</a>
</p>






    