<h1 class="firstheading">imppClamp</h1>
<p><br />
</p>
<div id="toc" class="toc">
	<div id="toctitle">
		<h2>目次</h2>
	</div>
	<ol>
		<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span 
		 class="tocnumber">1</span> <span class="toctext">メニュー情報</span></a></li>
		<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span 
		 class="tocnumber">2</span> <span class="toctext">概要</span></a></li>
		<li class="toclevel-1 tocsection-3"><a href="#Command_Line_Usage"><span 
		 class="tocnumber">3</span> <span class="toctext">コマンドラインの使用法</span></a></li>
		<li class="toclevel-1 tocsection-4"><a href="#Variables"><span 
		 class="tocnumber">4</span> <span class="toctext">変数</span></a></li>
		<li class="toclevel-1 tocsection-5"><a href="#Description"><span 
		 class="tocnumber">5</span> <span class="toctext">説明</span></a> 
		 
		<ol>
			<li class="toclevel-2 tocsection-6"><a href="#Details_on_Some_Dialog_Options"><span 
			 class="tocnumber">5.1</span> <span class="toctext">ダイアログオプションの詳細</span></a></li>
			<li class="toclevel-2 tocsection-7"><a href="#Secondary_X-Function_controls"><span 
			 class="tocnumber">5.2</span><span class="toctext">2番目のXファンクションのオプション</span></a></li>
		</ol></li>
		<li class="toclevel-1 tocsection-8"><a href="#Examples"><span class="tocnumber">6</span> 
		 <span class="toctext">サンプル</span></a></li>
		<li class="toclevel-1 tocsection-9"><a href="#Related_X-Functions"><span 
		 class="tocnumber">7</span> <span class="toctext">関連するXファンクション</span></a></li>
	</ol>
</div>
<h2><a name="Menu_Information"></a><span class="mw-headline">メニュー情報</span></h2>
<p>データ：ファイルからインポート：pCLAMP (ABF, DAT) </p>
<p><br />
このファイルタイプがメニューにない場合、<b>データ: ファイルからインポート: ファイルの種類の追加/削除</b>を選択します。 </p>
<p><a class="image"><img alt="File Import Add Menu.png" src="../images/ImppClamp/File_Import_Add_Menu.png" 
						 width="481" height="238" border="0" /></a> </p>
<table class="noborder">
	<tr>
		<td style="vertical-align: top;" width="60"><img src="../images/ImppClamp/Tip_icon.png" 
														 alt="" width="57" 
														 border="0" /></td>
		<td><p>ドラッグアンドドロップをサポートするファイルとして追加するには、<a class="external text" 
													 href="../../UserGuide/UserGuide/Introduction_to_Import_Filters_Manager.html"><b>インポートフィルタマネージャー</b></a>を参照してください。 
		 </p></td>
	</tr>
</table>
<p>このXファンクションは、ファイルの再インポートをサポートしています。詳細は<a class="external text" href="../../GettingStarted/OriginLab/Import_Data.html#Re-Importing_Data_Files">この表</a>をご確認ください。 
 </p>
<h2><a name="Brief_Information"></a><span class="mw-headline">概要</span></h2>
<p>バージョン10(ABF 2.0)までのpCLAMPファイルをインポートします </p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">コマンドラインでの使用法</span></h2>
<p><code>1. imppClamp; //import pclamp file specified in fname$ </code></p>
<p><code style="font-family: monospace;">2. imppClamp fname:=&quot;C:\pClampData\Sample.abf&quot;; 
 </code></p>
<p><code style="font-family: monospace;">3. imppClamp fname:=&quot;C:\pClampData\Sample.abf&quot; 
 orng:=col(1); </code></p>
<h2><a name="Variables"></a><span class="mw-headline">変数</span></h2>
<table class="xfvar">
	<tr>
		<th style="width: 8%;">表示<br />
		名 </th>
		<th style="width: 8%;">変数<br />
		名 </th>
		<th style="width: 8%;">I/O<br />
		と<br />
		データ型 </th>
		<th style="width: 8%;">デフォルト<br />
		値 </th>
		<th>説明 </th>
	</tr>
	<tr>
		<td>ファイル名 </td>
		<td>fname </td>
		<td><p>入力 </p>
		<p>string </p></td>
		<td><p style="text-align: center;">fname$ </p></td>
		<td>インポートするファイルのファイル名 </td>
	</tr>
	<tr>
		<td>ファイル情報とデータ選択 </td>
		<td>trfiles </td>
		<td><p>入力 </p>
		<p>TreeNode </p></td>
		<td><p style="text-align: center;">&lt;unassigned&gt; </p></td>
		<td>ファイルとデータの情報を指定するツリーノード。詳細は、<a class="external text" href="../../XFunction/X-Function/Details_of_TreeNodes_in_Import_PClamp.html">trfiles</a>のセクションをご覧下さい。 
		 </td>
	</tr>
	<tr>
		<td>インポートオプション </td>
		<td>options </td>
		<td><p>入力 </p>
		<p>TreeNode </p></td>
		<td><p style="text-align: center;">&lt;unassigned&gt; </p></td>
		<td>インポートオプションを指定するツリーノード </td>
	</tr>
	<tr>
		<td>出力 </td>
		<td>orng </td>
		<td><p>出力 </p>
		<p>範囲 </p></td>
		<td><p style="text-align: center;">&lt;active&gt; </p></td>
		<td>ファイル内のファイル情報とデータ情報(チャネルとエピソード)をダイアログで表示するために使われます。チャネルとエピソードは次のことを行うことができます。 
		 
		<p>シンタックスは<a class="external text" href="../../XFunction/X-Function/Output_Notations.html">ここ</a>をご覧ください。 
		 </p></td>
	</tr>
	<tr>
		<td>ヘッダ情報 </td>
		<td>trheader </td>
		<td><p>出力 </p>
		<p>TreeNode </p></td>
		<td><p style="text-align: center;">&lt;optional&gt; </p></td>
		<td>出力範囲を指定するのに使用します。 </td>
	</tr>
	<tr>
		<td>繰り返しインポート </td>
		<td>reimp </td>
		<td><p>入力 </p>
		<p>int </p></td>
		<td><p style="text-align: center;">インポート </p></td>
		<td>データを繰り返しインポートする方法を制御します。 
		<p>オプションリスト </p>
		<ul>
			<li><i>import: インポート</i></li>
		</ul>
		<dl>
			<dd>新しいデータファイルをインポートします。</dd>
		</dl>
		<ul>
			<li><i>direct: 直接再インポート</i></li>
		</ul>
		<dl>
			<dd>データを直接再インポートします。</dd>
		</dl>
		<ul>
			<li><i>graph: グラフから再インポート</i></li>
		</ul>
		<dl>
			<dd>グラフからデータを再インポートします。</dd>
		</dl></td>
	</tr>
	<tr>
		<td>ファイル情報とデータ選択のテーマの設定 </td>
		<td>thm </td>
		<td><p>入力 </p>
		<p>TreeNode </p></td>
		<td><p style="text-align: center;">&lt;unassigned&gt; </p></td>
		<td>この変数はユーザ向けに設計されたものではなく、GUIから利用できません。ファイル情報変数とデータ選択変数のテーマの設定を改良するために使うだけのものです。 
		 </td>
	</tr>
</table>
<h2><a name="Description"></a><span class="mw-headline">説明</span></h2>
<p>このXファンクションは、pCLAMP (ABF, DAT, ab?) データファイルをインポートするために使用されます。 </p>
<h3><a name="Details_on_Some_Dialog_Options"></a><span class="mw-headline">ダイアログオプションの詳細</span></h3>
<dl>
	<dd><ul>
		<li><b>インポートオプション(オプション)</b></li>
	</ul>
	<dl>
		<dd>詳細は、<a class="external text" href="../../XFunction/X-Function/Details_of_TreeNodes_in_Import_PClamp.html">このページ</a>をご覧ください。</dd>
	</dl></dd>
</dl>
<h3><a name="Secondary_X-Function_controls"></a><span class="mw-headline">2番目のXファンクションのオプション</span></h3>
<p><b>pCLAMP</b> ファイルをインポートするとき、目的のワークブックの左側にpCLAMPプロットパネルを開くようにできます。 </p>
<dl>
	<dd><a class="image"><img alt="Importing Third Party Files-1.png" src="../images/ImppClamp/Importing_Third_Party_Files-1.png" 
								 width="346" height="283" border="0" /></a></dd>
</dl>
<p>これは、<b>imppClamp</b>ダイアログボックスの<b>インポートオプション</b>ブランチにある<b>プロット作成用のコントロールパネルを表示</b>にチェックを付けて行います。このパネルには、 
 <b>チャネル</b> や <b>エピソード</b>をプロットするためのオプションがあり、グラフウィンドウに補助的なコントロールパネルを表示するオプションもあります。補助パネルの<b>バリュー線の選択</b>は、グラフ上の線をドラッグして、プロット値を読み取り、その値をワークブックに保存します。 
 </p>
<dl>
	<dd><a class="image"><img alt="Importing Third Party Files-2.png" src="../images/ImppClamp/Importing_Third_Party_Files-2.png" 
								 width="311" height="317" border="0" /></a></dd>
</dl>
<h2><a name="Examples"></a><span class="mw-headline">サンプル</span></h2>
<p>このサンプルでは、<a href="../../XFunction/X-Function/Newbook.html" title="Xファンクション:Newbook">newbook</a>Xファンクションを使用してFILAVGという名前の空のワークブックを作成します。<br />
次に、Then it creates new sheets by <a href="../../XFunction/X-Function/Newsheet.html" 
									 title="Xファンクション:Newsheet">newsheet</a> 
 Xファンクションを使用して新しいワークシートを作成し、pclampデータファイルをインポートします。filavgから始まるファイル名をシートに入れます。<br />
<a href="../../XFunction/X-Function/PlotpClamp.html" title="Xファンクション:PlotpClamp">plotpclamp</a>Xファンクションを使用してpclampデータをプロットし、<a 
	 href="../../XFunction/X-Function/G2w.html" title="Xファンクション:G2w">g2w</a>Xファンクションを使用してワークブックの新しいワークシートに統合します。 
 </p>
<pre class="lt" style="font-family: monospace;">
<span style="color: #008000;">////OriginのProgram Filesフォルダパスを取得</span><span style="color: #000080;">
%</span>A<span style="color: #000080;">=</span>SYSTEM.<span style="color: #000080;">PATH</span>.<span style="color: #000080;">PROGRAM</span><span style="color: #000080;">$</span>;<span style="color: #008000;">
//pclampデータをインポートするブックを作成</span>
newbook s<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> name<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;FILAVG&quot;</span> result<span style="color: #000000;">:</span><span style="color: #000080;">=</span>bkn<span style="color: #000080;">$</span>;<span style="color: #000080;">
%</span>b<span style="color: #000080;">=</span>bkn<span style="color: #000080;">$</span>;<span style="color: #008000;">
//インポートされる file1 を指定</span><span style="color: #008000;">
//fname$=&quot;%ASamples\Import 、Export\pClamp\FILAVG01.DAT&quot;;</span>
string fns, path<span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;%ASamples\Import and Export\pClamp&quot;</span>; 
findfiles fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>fns<span style="color: #000080;">$</span> ext<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;filavg*.dat&quot;</span>; <span style="color: #008000;">
//findFilesは\ r \ nまたはCRLFで区切られた複数のファイルをパック</span>
int n <span style="color: #000080;">=</span> fns.<span style="color: #000080;">GetNumTokens</span><span style="color: #000000;">(</span>CRLF<span style="color: #000000;">)</span>;
int nShtID;
for<span style="color: #000000;">(</span>int ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; ii <span style="color: #000080;">&lt;=</span>n; ii<span style="color: #000080;">++</span><span style="color: #000000;">)</span><span style="color: #000000;">
{</span>
&#160;&#160;&#160;&#160;&#160;&#160;fname<span style="color: #000080;">$</span><span style="color: #000080;">=</span>fns.<span style="color: #000080;">GetToken</span><span style="color: #000000;">(</span>ii, CRLF<span style="color: #000000;">)</span><span style="color: #000080;">$</span>;
&#160;&#160;&#160;&#160;&#160;&#160;newsheet b<span style="color: #000000;">:</span><span style="color: #000080;">=</span>bkn<span style="color: #000080;">$</span>;
&#160;&#160;&#160;&#160;&#160;&#160;nShtID <span style="color: #000080;">=</span> range2UID<span style="color: #000000;">(</span>sname<span style="color: #000080;">$</span><span style="color: #000000;">)</span>;
&#160;&#160;&#160;&#160;&#160;&#160;<span style="color: #008000;">//wactive sheet:=uid2name(nShtID)$ book:=bkn$;</span>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span style="color: #008000;">//pclampファイルをインポート</span>
&#160;&#160;&#160;&#160;&#160;&#160;imppclamp options.<span style="color: #000080;">Sparklines</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> options.<span style="color: #000080;">XFbar</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> options.<span style="color: #000080;">names</span>.<span style="color: #000080;">FNameToBk</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;
&#160;&#160;&#160;&#160;&#160;&#160;sname<span style="color: #000080;">$</span><span style="color: #000080;">=</span>uid2name<span style="color: #000000;">(</span>nShtID<span style="color: #000000;">)</span><span style="color: #000080;">$</span>;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span style="color: #008000;">//プロット</span>
&#160;&#160;&#160;&#160;&#160;&#160;plotpclamp iw<span style="color: #000000;">:</span><span style="color: #000080;">=</span>sname<span style="color: #000080;">$</span> stimulur<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> scrollbar<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> ctrl<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;
&#160;&#160;&#160;&#160;&#160;&#160;win <span style="color: #000080;">-</span>a <span style="color: #000080;">%</span>b;<span style="color: #000000;">
}</span><span style="color: #008000;">
//結果のグラフを1つのブックに統合（3枚目のシートがよい）</span>
g2w ow<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>new template<span style="color: #000000;">:</span><span style="color: #000080;">=</span>graphs name<span style="color: #000000;">:</span><span style="color: #000080;">=</span>graphs<span style="color: #000080;">&gt;</span> option<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span>;
</pre>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">関連 X ファンクション</span></h2>
<p><a href="../../XFunction/X-Function/PlotpClamp.html" title="Xファンクション:PlotpClamp">plotpClamp</a>, 
 <a href="../../XFunction/X-Function/Impinfo.html" title="Xファンクション:Impinfo">impinfo</a>, 
 <a href="../../XFunction/X-Function/ImpFileSel.html" title="Xファンクション:ImpFileSel">impFileSel</a> 
 </p>
