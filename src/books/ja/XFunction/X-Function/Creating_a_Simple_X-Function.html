<h1 class="firstheading">単純なXファンクションの作成</h1><p><br />
<span class="OIndex" style="display:none">X-Function Builder</span>Xファンクションは<a href="../../XFunction/X-Function/X-Function_Builder.html" title="Xファンクション:Xファンクションビルダ">Xファンクション・ビルダ</a>で作成されます。Xファンクションビルダは<b>ツール：Xファンクション・ビルダ</b>を選択すると開きます。
</p><p>Xファンクションビルダダイアログは下図の通りです。
</p><p><a  class="image"><img alt="Ocguide xfdialog default.png" src="../images/Creating_a_Simple_X-Function/Ocguide_xfdialog_default.png" width="548"  /></a>
</p>
<h2><a name="X-Function.2C_CreateCreating_X-Function"></a><span class="mw-headline"><span class="OIndex" style="display:none">X-Function, Create</span>Xファンクションの作成</span></h2>
<p>以下のステップはXファンクションの作成手順を示します。今回の例では、1つの列のデータを他の列にコピーするタスクを担うXファンクションを作成します。
</p>
<ol>
<li><b>ツール：Xファンクション・ビルダ</b>を選択するしてビルダを開きます。</li>
<li>XファンクションボックスにXファンクションの名前として「<b>CopyCol</b>」と入力します。</li>
<li> Xファンクションの各変数とパラメータは、それぞれ行が必要です。テーブルの下にある灰色の領域を右クリックし、<b>変数の追加</b>を選択して、さらに行を追加します。</li>
<li> このXファンクションには、入力列と出力列を指定するための2変数が必要です。下の画像のように記入してください。ほとんどの列は一目瞭然です。 </li>
<li><b>データ</b>列は、デフォルト値を設定するためのものです。<b>&lt;active&gt;</b>は現在選択されている列を意味し、 <b>&lt;new&gt;は</b> 新しい列を意味します。図のように設定されている場合、CopyColを呼び出すとデフォルトで現在選択されている列を新しい列にコピーします。</li>
<dl><dd><a  class="image"><img alt="Ocguide xfdialog.png" src="../images/Creating_a_Simple_X-Function/Ocguide_xfdialog.png" width="517"  /></a></dd></dl>
<li><a  class="image"><img alt="Ocguide xfdialog savebutton.png" src="../images/Creating_a_Simple_X-Function/Ocguide_xfdialog_savebutton.png" width="23"  /></a>ボタンをクリックしてXファンクションを保存します。Xファンクションを初めて作成すると、システムのXファンクション領域からユーザーファイルフォルダにXファンクションフォルダ構造全体をコピーするように指示するメッセージが表示されます。2番目のラジオボタンを選択して、再度ポップアップしないようにします。</li>
<dl><dd> <a  class="image"><img alt="Copy xfunction structure.png" src="../images/Creating_a_Simple_X-Function/Copy_xfunction_structure.png" width="429"  /></a></dd></dl>
<li><b>名前を付けて保存</b>ダイアログが表示されたら、Xファクションに移動して、Xファンクションフォルダ構造全体を確認します。適切なフォルダを選択します。例: CopyCol Xファンクションは、ワークシートの列をコピーするためのものです。そのため、<b>データ操作&gt; ワークシート</b>フォルダの順に選択して、ファイルを保存します。通常、ファイル名はXファンクション名と同じにします。<b>保存</b>ボタンをクリックします。</li>
<li><a  class="image"><img alt="Ocguide xf treeview button.png" src="../images/Creating_a_Simple_X-Function/Ocguide_xf_treeview_button.png" width="23"  /></a>ボタンをクリックするとツリービューに切り替えます。<span class="OIndex" style="display:none">X-Function, Control Labtalk Accessing</span>スクリプトウィンドウおよびコマンドウィンドウでXファンクションを使用できるように、<b>LabTalk</b>チェックボックスがオンになっていることを確認します。</li>
<li><b>自動GetNダイアログ</b>を<b>単純なGetNBox</b>に設定します。自動GetNダイアログは、Xファンクションをダイアログ付きまたはダイアログなしで使用するか、また、ダイアログの種類を選択できます。保存ボタンを再度クリックして変更を保存します。<br /><a  class="image"><img alt="Ocguide xfsimpledialog treeview.png" src="../images/Creating_a_Simple_X-Function/Ocguide_xfsimpledialog_treeview.png" width="593"  /></a></li>
<li>次に、作成したXファンクションの作業を行うOrigin Cコードを書きます。コードビルダボタン<a  class="image"><img alt="Ocguide xfdialog codebuilderbutton.png" src="../images/Creating_a_Simple_X-Function/Ocguide_xfdialog_codebuilderbutton.png" width="23"  /></a>をクリックします。  これにより、Xファンクションをコードビルダで開き、Origin Cコードを記述できます。main関数に、次のOrigin Cコードを追加します。
<pre class="oc" style="font-family:monospace;">ocol <span style="color: #000080;">=</span> icol;</pre></li>
<li><b>コンパイル</b>ボタンをクリックし、<b>ダイアログに戻る</b>ボタンをクリックして、Xファンクションビルダに戻ります。  もう一度<a  class="image"><img alt="Ocguide xfdialog savebutton.png" src="../images/Creating_a_Simple_X-Function/Ocguide_xfdialog_savebutton.png" width="23"  /></a> ボタンをクリックします。</li>
<li>Xファンクションビルダツールを閉じます。 </li>
<li>ツールを再度開き、<b>開く</b>ボタンを選択することで、作成したXファンクションをロードして追加の編集が可能です。</li>
</ol>
<h2><a name="X-Function.2C_ExecutionUsing_X-Functions"></a><span class="mw-headline"><span class="OIndex" style="display:none">X-Function, Execution</span>Xファンクションを使用</span></h2>
<p>これで、Xファンクションの作成が成功したので、テストしてみます。
</p>
<ol><li> 2つの列がある、新しいワークシートを作成します。  列Aと列Bに乱数を入力します。</li>
<li> 列A(X)ヘッダをクリックして、列Aを強調表示します。</li>
<li> スクリプトウィンドウまたはコマンドウィンドウで、Xファンクション名<b>CopyCol</b>を変数なしで入力し、Enterキーを押してデフォルト設定で実行します。</li>
<li> 新しい列を作成し、列Aのデータをコピーします。</li>
<li> 列Bを選択します。</li>
<li> スクリプトウィンドウで、<b>CopyCol -d</b>と入力し、Enterキーを押してXファンクションのダイアログを開きます。</li>
<li> これにより、Xファンクション作成時に指定した単純なGetNダイアログが開きます。入力と出力はデフォルト設定でロードされます。OKボタンをクリックします。</li>
<li> 列Bの値がコピーされた新しい列が作成されます。</li></ol>
<p>Xファンクションの詳細とその呼び出し方法については、<a class="external text" href="../../LabTalk/Category/X-Functions.html">Xファンクション</a>を参照してください 。
</p>



    