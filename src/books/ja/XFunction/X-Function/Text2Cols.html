<h1 class="firstheading">text2cols</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Brief_Information"><span class="tocnumber">1</span> <span class="toctext">概要</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Additional_Information"><span class="tocnumber">2</span> <span class="toctext">追加の情報</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Command_Line_Usage"><span class="tocnumber">3</span> <span class="toctext">コマンドラインでの使用法</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#X-Function_Execution_Options"><span class="tocnumber">4</span> <span class="toctext">Xファンクションの実行オプション</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Variables"><span class="tocnumber">5</span> <span class="toctext">変数</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Description"><span class="tocnumber">6</span> <span class="toctext">説明</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Examples"><span class="tocnumber">7</span> <span class="toctext">サンプル</span></a></li>
</ul>
</div>

<h2><a name="Brief_Information"></a><span class="mw-headline">概要</span></h2>
<p>区切られた文字列を取り、それを解析して複数列に分割します。
</p><p><a class="external text" href="../../LabTalk/Script/LabTalk-Supported_Functions.html#Lookup_.26_Reference_Functions">LabTalkがサポートしている関数</a>の<b>CatIndex</b>および<b>Catrows</b>をご参照ください。
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">追加の情報</span></h2>
<p>ダイアログボックスはユーザインタフェースのメニューコマンドからは利用できません。他のXファンクションダイアログと同様に、スクリプトまたはコマンドウィンドウを開き、次のように入力してEnterキーを押します。
</p>
<pre class="lt" style="font-family:monospace;">text2cols <span style="color: #000080;">-</span>d</pre>
<p>スクリプトでのアクセスについては、次の項<i>コマンドラインでの使用法</i>をご参照ください。
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">コマンドラインでの使用法</span></h2>
<p><code>
text2cols ix:=[Book2]Sheet1!B delimiter:=pipe; // take pipe-separated strings in [Book2]Sheet1!B as input, output values to separate columns in new sheet
</code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">Xファンクションの実行オプション</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">スクリプトからXファンクションにアクセスする場合、追加のオプションスイッチについてのページを参照してください。</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">変数</span></h2>
<table class="xfvar">
<tr>
<th width="8%">表示<br />名
</th>
<th width="8%">変数<br />名
</th>
<th width="8%">I/O<br />と<br />データ型
</th>
<th width="8%">デフォルト<br />値
</th>
<th>説明
</th></tr>
<tr>
<td>テキスト列
</td>
<td>ix
</td>
<td> 入力<br />vector&lt;string&gt;
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> テキスト列。セルには、区切られた値の文字列が含まれています。区切り文字は、区切り文字にリストされているもののいずれかでなければなりません。
</td></tr>
<tr>
<td>区切り文字
</td>
<td>delimiter
</td>
<td> 入力<br />int
</td>
<td> <center>0</center>
</td>
<td> 区切り文字。次の値を使用します。 <br />
<ul><li> 0=comma:カンマ</li>
<li> 1=semicolon:セミコロン</li>
<li> 2=pipe:パイプ</li>
<li> 3=space:空白のスペース</li></ul>
</td></tr>
<tr>
<td>他の列を含める
</td>
<td>nosplit
</td>
<td> 入力<br />int
</td>
<td> <center>0</center>
</td>
<td> 出力で他の列をコピーするかどうかを指定します。
<ul><li> 0 = 偽</li>
<li> 1 = 真</li></ul>
</td></tr>
<tr>
<td>含める列
</td>
<td>other
</td>
<td> 入力<br />range
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td> 出力（解析済みデータ）とともにコピーされる他の列です。
</td></tr>
<tr>
<td>出力
</td>
<td>rd
</td>
<td> 出力<br />ReportData
</td>
<td> <center>[input]&lt;new&gt;</center>
</td>
<td> 出力。区切られた文字列は、解析されて個別のセル（列）に分割されます。
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">説明</span></h2>
<p>このXファンクションは、区切られた値のセルまたは列を取り、それらを解析して新しい列に分割します。
</p>
<h2><a name="Examples"></a><span class="mw-headline">サンプル</span></h2>
<p>このサンプルではカテゴリカルデータを含むASCIIファイルをインポートし、<a class="external text" href="../../LabTalk/LabTalk/Catrows_(function).html"><b>catrows()$</b></a>関数を使用して各カテゴリの行インデックスを取得し、それらの行インデックスを新しい列に出力します。結果シート<i>text2cols</i>には各カテゴリの行インデックスがリストされます。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 空のワークブックを作成し、automobile.dat ファイルをインポート</span>
newbook; string fname<span style="color: #000080;">$</span><span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Statistics\automobile.dat&quot;</span>;
impASC;
<span style="color: #008000;">// 2番目の列をカテゴリとして設定し、昇順にソート</span>
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">categorical</span>.<span style="color: #000080;">type</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>;
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">categorical</span>.<span style="color: #000080;">sort</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
<span style="color: #008000;">// 2番目の列を範囲変数rAとする</span>
range rA <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>automobile<span style="color: #000000;">]</span>automobile<span style="color: #000080;">!</span><span style="color: #ff00ff;">&quot;Make&quot;</span>;
<span style="color: #008000;">// 新しいブックを作成し、category関数を使用してrAのカテゴリを新しいブックのA列にコピー</span>
<span style="color: #008000;">// B列には、各カテゴリが出現する行インデックスをパイプ区切りリストとして追加</span>
newbook;
col<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span><span style="color: #000080;">=</span>category<span style="color: #000000;">(</span>rA<span style="color: #000000;">)</span><span style="color: #000080;">$</span>;
col<span style="color: #000000;">(</span>B<span style="color: #000000;">)</span><span style="color: #000080;">=</span>catrows<span style="color: #000000;">(</span>rA<span style="color: #000000;">)</span><span style="color: #000080;">$</span>;
<span style="color: #008000;">// [Book2]Sheet1!B のパイプで区切られた文字列を入力として受け取り、&lt;input&gt;の新しいシートに値を出力</span>
text2cols ix<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span>Book2<span style="color: #000000;">]</span>Sheet1<span style="color: #000080;">!</span>B delimiter<span style="color: #000000;">:</span><span style="color: #000080;">=</span>pipe nosplit<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> other<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span>Book2<span style="color: #000000;">]</span>Sheet1<span style="color: #000080;">!</span>A;</pre>
<hr class='keywordshr'><p><span class='keywords'>キーワード：</span><span class='keywordsInput'>文字列の処理, カテゴリ, catindex, catrows</span></p>







    