<h1 class="firstheading">w2xyz</h1><div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">メニュー情報</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">概要</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Additional_Information"><span class="tocnumber">3</span> <span class="toctext">追加の情報</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Command_Line_Usage"><span class="tocnumber">4</span><span class="toctext">コマンドラインでの使用法</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#X-Function_Execution_Options"><span class="tocnumber">5</span> <span class="toctext">Xファンクションの実行オプション</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Variables"><span class="tocnumber">6</span> <span class="toctext">変数</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Description"><span class="tocnumber">7</span> <span class="toctext">説明</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Examples"><span class="tocnumber">8</span> <span class="toctext">サンプル</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Related_X-Functions"><span class="tocnumber">9</span> <span class="toctext">関連するXファンクション</span></a></li>
</ul>
</div>

<h2><a name="Menu_Information"></a><span class="mw-headline">メニュー情報</span></h2>
<p>ワークシート：XYZ形式に変換
</p>
<h2><a name="Brief_Information"></a><span class="mw-headline">概要</span></h2>
<p>ワークシートデータをXYZ形式に変換
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">追加の情報</span></h2>
<p><b>必要なOriginのバージョン</b>：Origin8.0 SR3以上。Origin8.5.1 SR0で更新。
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">コマンドラインでの使用法</span></h2>
<p><code>
1. w2xyz iw:=[book1]sheet1! format:=xcol xlabel:=row1 ycol:=1;
</p><p>2. w2xyz format:=xcol xlabel:=param param:=P ycol:=1;
</p><p>3. w2xyz -r 2 range:=rng format:=ycol ylabel:=sel1 xcol:=sel1 trim:=1;
</code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">Xファンクションの実行オプション</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">スクリプトからXファンクションにアクセスする場合、追加のオプションスイッチについてのページを参照してください。</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">変数</span></h2>
<table class="xfvar">
<tr>
<th width="8%">表示<br />名
</th>
<th width="8%">変数<br />名
</th>
<th width="8%">I/O<br />と<br />データ型
</th>
<th width="8%">デフォルト<br />値
</th>
<th>説明
</th></tr>
<tr>
<td>変換範囲
</td>
<td>range
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> 変換範囲
<p>オプションリスト：
</p>
<ul><li> <i>wks:ワークシート全体</i> 
<dl><dd> 0 = ワークシート全体を選択します。</dd></dl></li>
<li> <i>rng:指定された範囲</i>
<dl><dd> 1 = 指定された範囲を使用します。</dd></dl></li></ul>
</td></tr>
<tr>
<td>入力ワークシート
</td>
<td>iw
</td>
<td>
<p>入力
</p><p>Worksheet
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> 変換するデータのある入力ワークシートを指定します。
</td></tr>
<tr>
<td>入力
</td>
<td>irng
</td>
<td>
<p>入力
</p><p>Range
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> 変換する入力範囲を指定します。
</td></tr>
<tr>
<td>データフォーマット
</td>
<td>format
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>2</center>
</td>
<td> ソースデータのフォーマットを指定します。
<p>オプションリスト：
</p>
<ul><li><i>xcol:列にわたるX</i>
<dl><dd>Xの値が横方向にあります。</dd></dl></li>
<li><i>ycol:列にわたるY</i>
<dl><dd>Yの値が横方向にあります。</dd></dl></li>
<li><i>noxy:XとYがありません</i>
<dl><dd>ワークシートにX値やY値がない場合、このオプションを使用します。列および行のインデックスを出力XY値として使用します。 </dd></dl></li></ul>
</td></tr>
<tr>
<td>X値の位置
</td>
<td>xlabel
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> X値の位置を指定します。<b>データフォーマット</b>が<b>列にわたるX</b>のとき利用可能です。
<p>オプションリスト：
</p>
<ul><li><i>none:なし</i>
<dl><dd>ワークシートにX値がありません。列番号がX値になります。</dd></dl></li>
<li><i>row1:最初のデータ行</i>
<dl><dd>最初の行にあるデータがX値になります。</dd></dl></li>
<li><i>param:列ラベル</i>
<dl><dd>列ラベル行でX値を指定します。 </dd></dl></li>
<li> <i>sel1:選択中の最初のデータ行</i>
<dl><dd>最初データ行でX値を指定します。変換範囲が<i>指定された範囲</i>、<i>かつ</i>、データフォーマットが<i>列にわたるX</i>または<i>列にわたるY</i>の時利用できます。</dd></dl></li></ul>
</td></tr>
<tr>
<td>Y値の位置
</td>
<td>ylabel
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Y値の位置を指定します。<b>データフォーマット</b>が<b>列にわたるX</b>のとき利用可能です。
<p>オプションリスト：
</p>
<ul><li><i>none:なし</i>
<dl><dd>ワークシートにY値がありません。列番号がY値になります。</dd></dl></li>
<li><i>row1:最初のデータ行</i>
<dl><dd>最初の行にあるデータがY値になります。</dd></dl></li>
<li><i>param:列ラベル</i>
<dl><dd>列ラベル行でY値を指定します。 </dd></dl></li>
<li> <i>sel1:選択中の最初のデータ行</i>
<dl><dd>最初データ行でY値を指定します。変換範囲が<i>指定された範囲</i>、<i>かつ</i>、データフォーマットが<i>列にわたるX</i>または<i>列にわたるY</i>の時利用できます。</dd></dl></li></ul>
</td></tr>
<tr>
<td>列ラベル
</td>
<td>param
</td>
<td>
<p>入力
</p><p>string
</p>
</td>
<td> <center></center>
</td>
<td> <b>X値の位置</b>または<b>Y値の位置</b>で<i>列ラベル</i>を選択した場合に有効です。ラベル行を表す文字を使ってXまたはY座標として使用するラベル行を指定します。  各列ラベル行を示す文字については<a class="external text" href="../../LabTalk/LabTalk/Column_Label_Row_Characters.html">Column Label Row Characters</a>を参照してください。
</td></tr>
<tr>
<td>最初の列のX値
</td>
<td>xcol
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> 第1列にX値があるかどうか指定します。<b>データフォーマット</b>が<b>列にわたるX</b>のとき利用可能です。
</td></tr>
<tr>
<td>最初の列のY値
</td>
<td>ycol
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> 第1列にY値があるかどうか指定します。<b>データフォーマット</b>が<b>列にわたるX</b>のとき利用可能です。
</td></tr>
<tr>
<td>欠損値の削除
</td>
<td>trim
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> 欠損セルまたは列を削除するか指定します。XYZへの変換時に座標が欠損している場合、このオプションを使用するとデータポイントが除外されます。
<ul><li> 0 = 偽</li>
<li> 1 = 真</li></ul>
</td></tr>
<tr>
<td>出力
</td>
<td>oz
</td>
<td>
<p>出力
</p><p>XYZRange
</p>
</td>
<td> <center>[&lt;input&gt;]&lt;new&gt;!(&lt;new&gt;,&lt;new&gt;,&lt;new&gt;)</center>
</td>
<td> 出力XYZ範囲のための3列を指定します。異なるワークシート、ワークブックにある3列を指定可能です。
<p><a class="external text" href="../../XFunction/X-Function/Output_Notations.html">出力表記</a>のシンタックスを参照してください。
</p>
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">説明</span></h2>
<p>このXファンクションは、行列のように並んだワークシートデータ（XY座標が最初の行と列にある表形式のデータ、仮想行列）をXYZ形式に変換するとき使います。X座標は最初の行に配置され、Y座標は最初の列に配置されます。あるいは、その逆もあります。等間隔でないX、Y座標でも問題ありません。XY座標が含まれていない場合は、列と行のインデックスが使用されます。Z値は数値またはテキスト（カテゴリデータも）です。
</p>
<h2><a name="Examples"></a><span class="mw-headline">サンプル</span></h2>
<ol>
<li>一番上の行にX座標値、一番左にある列にY座標値が入っているソースデータを使います。

<dl><dd><br /><a  class="image"><img alt="W2xyz example source.png" src="../images/W2xyz/W2xyz_example_source.png" width="393"  /></a><br /><br /></dd></dl>

XYZ形式に変換するには、ワークシートをアクティブにして、メニューから<b>ワークシート：XYZ形式に変換</b>を選択するか、コマンドウィンドウで<code>w2xyz -d;</code>を実行して、Xファンクションw2xyzのダイアログを開きます。

<li><b>ダイアログの変換</b>オプションで、<b>データフォーマット</b>として<b>列にわたるX</b>を選択します。<b>X値の位置</b>を、<b>最初のデータ行</b>とし、<b>第1列にY値</b>にチェックを付けます。

<dl><dd><br /><a  class="image"><img alt="W2xyz example dialog.png" src="../images/W2xyz/W2xyz_example_dialog.png" width="380"  /></a><br /><br /></dd></dl>

<li><b>OK</b>ボタンをクリックして変換を実行します。次のような結果ワークシートが出力されます。

<dl><dd><br /><a  class="image"><img alt="W2xyz example result.png" src="../images/W2xyz/W2xyz_example_result.png" width="322"  /></a></dd></dl>
</ol>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">関連するXファンクション</span></h2>
<p><a href="../../XFunction/X-Function/W2m.html" title="Xファンクション:W2m">w2m</a>, <a href="../../XFunction/X-Function/R2m.html" title="Xファンクション:R2m">r2m</a>, <a href="../../XFunction/X-Function/M2w.html" title="Xファンクション:M2w">m2w</a>
</p>






    