<h1 class="firstheading">paMultiY</h1><div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">メニュー情報</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">概要</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Command_Line_Usage"><span class="tocnumber">3</span> <span class="toctext">コマンドラインでの使用法</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#X-Function_Execution_Options"><span class="tocnumber">4</span> <span class="toctext">Xファンクションの実行オプション</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Variables"><span class="tocnumber">5</span> <span class="toctext">変数</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Description"><span class="tocnumber">6</span> <span class="toctext">説明</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Example"><span class="tocnumber">7</span> <span class="toctext">サンプル</span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="#Create_an_Analysis_Theme"><span class="tocnumber">7.1</span> <span class="toctext">分析テーマの作成</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Perform_Batch_Processing_with_the_Theme"><span class="tocnumber">7.2</span> <span class="toctext">テーマでバッチ処理を実行</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-10"><a href="#Related_X-Functions"><span class="tocnumber">8</span> <span class="toctext">関連するXファンクション</span></a></li>
</ul>
</div>

<h2><a name="Menu_Information"></a><span class="mw-headline">メニュー情報</span></h2>
<p>分析テーマによるバッチピーク解析
</p>
<h2><a name="Brief_Information"></a><span class="mw-headline">概要</span></h2>
<p>ピークアナライザのテーマを使用して複数のスペクトルのバッチ処理を実行します
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">コマンドラインでの使用法</span></h2>
<p><code>
1. paMultiY iy:=[MultiplePeaks]Sheet1!(A,B:E) theme:=&quot;IntegratePeaks&quot;;
</p><p>2. paMultiY iy:=[MultiplePeaks]Sheet1!(A,B:E) theme:=&quot;IntegratePeaks&quot; number:=2 clear:=1;
</p><p>3. paMultiY iy:=[MultiplePeaks]Sheet1!(A,B:E) theme:=&quot;myPeaksfit&quot; initvalues:=1;
</code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">Xファンクションの実行オプション</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">スクリプトからXファンクションにアクセスする場合、追加のオプションスイッチについてのページを参照してください。</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">変数</span></h2>
<table class="xfvar">
<tr>
<th width="8%">表示<br />名
</th>
<th width="8%">変数<br />名
</th>
<th width="8%">I/O<br />と<br />データ型
</th>
<th width="8%">デフォルト<br />値
</th>
<th>説明
</th></tr>
<tr>
<td>入力
</td>
<td>iy
</td>
<td>
<p>入力
</p><p>XYRange
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> 入力データセットを指定します。Origin 2020b以降、[Book]Sheet!(X,Y1:YN) 形式（X = 共通のX列、Y1:YN = X列の右側のY列の連続した範囲）の短縮構文を使用できます。[Book]Sheet!((X,Y1:YN),(X,YM:YO)) の形式の非連続データからのより複雑な文字列も使用できます。
</td></tr>
<tr>
<td>分析テーマ
</td>
<td>theme
</td>
<td>
<p>入力
</p><p>string
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td> ピーク分析の実行に使用するテーマを指定します。
</td></tr>
<tr>
<td>結果シート
</td>
<td>append
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> 各データセットのピーク分析はワークブックを生成します。この変数でワークブック内のワークシートを選択し、ワークシート内の情報が出力シートに追加されます。
<p>オプションリスト：
</p>
<ul><li><i>none:&lt;なし&gt;</i>
<dl><dd>このオプションでは、各データセットにピーク分析が実行されますが、結果シートのデータは出力シートに追加されません。 </dd></dl></li></ul>
<dl><dd></dd></dl>
<ul><li><i>integrate:積分の結果</i>
<dl><dd>ピークアナライザのピークの積分を使うテーマの場合のみ利用できます。</dd></dl></li>
<li><i>baseline:基線</i>
<dl><dd>ピークアナライザの基線を使うテーマの場合のみ利用できます。 </dd></dl></li></ul>
<dl><dd></dd></dl>
<ul><li><i>peak_centers:ピーク中心</i>
<dl><dd>ピークアナライザのピーク検索を使うテーマの場合のみ利用できます。</dd></dl></li>
<li><i>peak_properties:ピークのプロパティ</i>
<dl><dd>ピークアナライザのピークフィットを使うテーマの場合のみ利用できます。 </dd></dl></li></ul>
<dl><dd></dd></dl>
</td></tr>
<tr>
<td>レポートにフィット統計を含める
</td>
<td>fitresult
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> レポートシートにフィット統計を含めるか指定します。追加モードが列の場合、GUIでは表示されません。
</td></tr>
<tr>
<td>出力シート
</td>
<td>ow
</td>
<td>
<p>出力
</p><p>Worksheet
</p>
</td>
<td> <center>[Summary]Results!</center>
</td>
<td> 各入力データセットに実行されるピーク分析の結果を出力するワークシートを指定します。
</td></tr>
<tr>
<td>中間結果を削除
</td>
<td>remove
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> 入力データセットにピーク分析を実行することで生成される中間的に出力される分析結果を削除するかどうか指定します。
</td></tr>
<tr>
<td>データセット識別子
</td>
<td>dataid
</td>
<td>
<p>入力
</p><p>string
</p>
</td>
<td> <center>Range</center>
</td>
<td> 全範囲、ロングネーム、単位または入力データのユーザ定義パラメータを、レポート内でのデータセット名として指定します。
</td></tr>
<tr>
<td>指定
</td>
<td>desig
</td>
<td>
<p>入力
</p><p>string
</p>
</td>
<td> <center>&lt;自動&gt;</center>
</td>
<td> データ識別子のソースを指定し、範囲のX列またはY列からそれを入力します。
</td></tr>
<tr>
<td>追加の開始行番号
</td>
<td>number
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> 結果が追加される出力ワークシートの開始行を指定します。
</td></tr>
<tr>
<td>開始時に出力シートをクリア
</td>
<td>clear
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> 出力シートに結果を追加する前に出力シートの内容を消去するか指定します。
</td></tr>
<tr>
<td>ラベル行の追加(最初のファイル)
</td>
<td>label
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> 最初の結果シートのラベル行を出力シートに追加するか指定します。
</td></tr>
<tr>
<td>追加モード
</td>
<td>mode
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> データを出力シートに追加する方法を指定します。
<p>オプションリスト：
</p>
<ul><li><i>rows:行</i>
<dl><dd>データを行方向に追加します。</dd></dl></li>
<li><i>cols:列</i>
<dl><dd>データを列方向に追加します。 </dd></dl></li></ul>
<dl><dd></dd></dl>
</td></tr>
<tr>
<td>連続した初期パラメータ値
</td>
<td>initvalues
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> このオプションが選択された場合、テーマに保存されたピークの情報はバッチ処理の最初のデータのみに適用されます。連続したデータセットには、前のデータセットのフィット結果から得たピーク初期値が使われます。
</td></tr>
<tr>
<td>各処理前のスクリプト
</td>
<td>beforescript
</td>
<td>
<p>入力
</p><p>string
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td> 各入力データセットのピーク分析が実行される前に、この編集ボックスのスクリプトが実行されます。
<p>Note:
</p><p><b>_rx</b> は i 番目のx データセットの範囲を示します 
<b>_ry</b> は i 番目のy データセットの範囲を示します 
<b>_skip</b> は i 番目のファイル/データセットをスキップするか指定します
</p>
</td></tr>
<tr>
<td>各処理後のスクリプト
</td>
<td>loopscript
</td>
<td>
<p>入力
</p><p>string
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td> 各入力データセットのピーク分析の実行時に、この編集ボックスのスクリプトが実行されます。
<p>ここで、<b>_i</b> は i 番目のファイル/データセットのインデックスを示します 
</p>
</td></tr>
<tr>
<td>終了時のスクリプト
</td>
<td>endscript
</td>
<td>
<p>入力
</p><p>string
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td> 全入力データセットのピーク分析が実行された後、この編集ボックスのスクリプトが実行されます。
</td></tr>
<tr>
<td>バックグラウンドインスタンスを使用して処理
</td>
<td>instance
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> 複数のOriginプロセスを実行して、処理速度を上げます。最大のメリットを得るには、値をコンピューターの論理コアの数から1を引いた数に設定することをお勧めします。つまり、論理コアの数が8の場合、値を7に設定します。
<p><br />
コンピューターの論理コアを知るためには、 「スクリプトウィンドウ」に次のスクリプトを入力し、Enterキーを押して実行します。
<br />
<code>
@logprocs= 
</code>
</p><p><br />
</p>
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">説明</span></h2>
<p>このXファンクションは複数データセットに同じ設定でピークフィットを実行します。設定は、分析テーマファイルに保存されます。異なるデータセットに対して実行される結果はサマリーワークシート内にまとめられます。
</p>
<h2><a name="Example"></a><span class="mw-headline">サンプル</span></h2>
<p>次のサンプルは、最初に分析テーマを作成し、次にこのXファンクションの使用して、複数データセットに対してピーク分析を実行する方法を示します。
</p><p>この例では、ピークアナライザでテーマを作成し、使用する方法を示します。
</p>
<h3><a name="Create_an_Analysis_Theme"></a><span class="mw-headline">分析テーマの作成</span></h3>
<ol><li>新しいワークシートを作成し、<b>Samples\Curve Fitting</b> フォルダの<i>Multiple Peaks.dat</i> をインポートします。</li>
<li>B列を選択して、メインメニューで、<b>解析：ピークと基線：ピークアナライザ</b>を選択して<b>ピークアナライザ</b>のダイアログを開きます。 </li>
<li><b>ゴール</b>グループ内の<b>ピークの積分</b>を選択し、<b>進む</b>ボタンを4回クリックして、<b>ピークの積分</b>ページに移動します。 </li>
<li>ダイアログの右上にある三角形のボタンクリックし、<b>名前を付けて保存</b>を表示します。<b>テーマ名</b>編集ボックスに<b>MyIntegratePeaks</b> と入力します。<b>OK</b>をクリックしてダイアログを閉じ、<b>完了</b>をクリックしてピークを積分します。</li></ol>
<h3><a name="Perform_Batch_Processing_with_the_Theme"></a><span class="mw-headline">テーマでバッチ処理を実行</span></h3>
<p><b>Multiple Peaks</b>ワークシートの全てのY列を選択します。メニューから、<b>解析: ピークと基線: 分析テーマによるバッチピーク解析</b>を選択してダイアログを開きます。下図のようにダイアログを設定します。<b>OK</b> ボタンをクリックして、分析を実行します。 
</p>
<dl><dd><a  class="image"><img alt="BatchPeakAnalysis.png" src="../images/PaMultiY/BatchPeakAnalysis.png" width="521"  /></a></dd></dl>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">関連するXファンクション</span></h2>
<p><a href="../../XFunction/X-Function/BatchProcess.html" title="Xファンクション:BatchProcess">X-Function:BatchProcess</a>, <a href="../../XFunction/X-Function/Blauto.html" title="Xファンクション:Blauto">blauto</a>, <a href="../../XFunction/X-Function/Fitpeaks.html" title="Xファンクション:Fitpeaks">fitpeaks</a>, <a href="../../XFunction/X-Function/Pa.html" title="Xファンクション:Pa">pa</a>, <a href="../../XFunction/X-Function/PkFind.html" title="Xファンクション:PkFind">pkFind</a>, <a href="../../XFunction/X-Function/NLfitpeaks.html" title="Xファンクション:NLfitpeaks">NLfitpeaks</a>
</p>
<hr class='keywordshr'><p><span class='keywords'>キーワード:</span><span class='keywordsInput'>スペクトル、サマリーレポート</span></p>







    