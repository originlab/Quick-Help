<h1 class="firstheading">reducedup</h1>
<div id="toc" class="toc">
	<div id="toctitle">
		<h2>目次</h2>
	</div>
	<ol>
		<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span 
		 class="tocnumber">1</span> <span class="toctext">メニュー情報</span></a></li>
		<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span 
		 class="tocnumber">2</span><span class="toctext">概要</span></a></li>
		<li class="toclevel-1 tocsection-3"><a href="#Additional_Information"><span 
		 class="tocnumber">3</span> <span class="toctext">追加の情報</span></a></li>
		<li class="toclevel-1 tocsection-4"><a href="#Command_Line_Usage"><span 
		 class="tocnumber">4</span><span class="toctext">コマンドラインでの使用法</span></a></li>
		<li class="toclevel-1 tocsection-5"><a href="#X-Function_Execution_Options"><span 
		 class="tocnumber">5</span> <span class="toctext">Xファンクションの実行オプション</span></a></li>
		<li class="toclevel-1 tocsection-6"><a href="#Variables"><span 
		 class="tocnumber">6</span> <span class="toctext">変数</span></a></li>
		<li class="toclevel-1 tocsection-7"><a href="#Description"><span 
		 class="tocnumber">7</span> <span class="toctext">説明</span></a></li>
		<li class="toclevel-1 tocsection-8"><a href="#Example"><span class="tocnumber">8</span> 
		 <span class="toctext">サンプル</span></a></li>
		<li class="toclevel-1 tocsection-9"><a href="#Algorithm"><span 
		 class="tocnumber">9</span> <span class="toctext">アルゴリズム</span></a></li>
		<li class="toclevel-1 tocsection-10"><a href="#Related_X-Functions"><span 
		 class="tocnumber">10</span><span class="toctext">関連するXファンクション</span></a></li>
	</ol>
</div>
<h2><a name="Menu_Information"></a><span class="mw-headline">メニュー情報</span></h2>
<ul>
	<li>ワークブックがアクティブな場合</li>
</ul>
<dl>
	<dd><b>ワークシート：データ削減：重複X</b></dd>
</dl>
<ul>
	<li>グラフがアクティブな場合</li>
</ul>
<dl>
	<dd><b>解析：データ操作：データ削減：重複X</b></dd>
</dl>
<h2><a name="Brief_Information"></a><span class="mw-headline">概要</span></h2>
<p>重複しているXデータを置換してXYデータを削減します </p>
<h2><a name="Additional_Information"></a><span class="mw-headline">追加の情報</span></h2>
<p><b>必要なOriginのバージョン</b>: 8.1 SR0以降 </p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">コマンドラインでの使用法</span></h2>
<p><code>reducedup method:=mean tol:=1 xcount:=&lt;new&gt; </code></p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">Xファンクションの実行オプション</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">スクリプトからXファンクションにアクセスする場合、追加のオプションスイッチについてのページを参照してください。</a> 
 </p>
<h2><a name="Variables"></a><span class="mw-headline">変数</span></h2>
<table class="xfvar">
	<tr>
		<th style="width: 8%;">表示<br />
		名 </th>
		<th style="width: 8%;">変数<br />
		名 </th>
		<th style="width: 8%;">I/O<br />
		と<br />
		データ型 </th>
		<th style="width: 8%;">デフォルト<br />
		値 </th>
		<th>説明 </th>
	</tr>
	<tr>
		<td>入力 </td>
		<td>iy </td>
		<td><p>入力 </p>
		<p>XYRange </p></td>
		<td><p style="text-align: center;">&lt;active&gt; </p></td>
		<td>入力データ範囲を指定します。 </td>
	</tr>
	<tr>
		<td>置換方法 </td>
		<td>method </td>
		<td><p>入力 </p>
		<p>int </p></td>
		<td><p style="text-align: center;">0 </p></td>
		<td>同じX値に対応するY値をどの値で置き換えるか指定します。 
		<p>オプションリスト： </p>
		<ul>
			<li><i>mean: 平均</i> 
			<dl>
				<dd>各グループのデータポイントをそのデータポイントの平均値で置き換えます。</dd>
			</dl></li>
			<li><i>median:中央値</i> 
			<dl>
				<dd>各グループのデータポイントをそのデータポイントの中央値で置き換えます。</dd>
			</dl></li>
			<li><i>min:最小</i> 
			<dl>
				<dd>各グループのデータポイントをそのデータポイントの最小値で置き換えます。</dd>
			</dl></li>
			<li><i>max:最大</i> 
			<dl>
				<dd>各グループのデータポイントをそのデータポイントの最大値で置き換えます。</dd>
			</dl></li>
			<li><i>sum:合計</i> 
			<dl>
				<dd>各グループのデータポイントをそのデータポイントの合計値で置き換えます。</dd>
			</dl></li>
			<li><i>sd:SD</i> 
			<dl>
				<dd>各グループのデータポイントをそのデータポイントの標準偏差で置き換えます。</dd>
			</dl></li>
			<li><i>se:SE</i> 
			<dl>
				<dd>各グループのデータポイントをそのデータポイントの標準誤差で置き換えます。</dd>
			</dl></li>
			<li><i>rms:RMS</i> 
			<dl>
				<dd>各グループのデータポイントをそのデータポイントの二乗平均平方根（RMS）で置き換えます。</dd>
			</dl></li>
		</ul></td>
	</tr>
	<tr>
		<td>許容値 </td>
		<td>tol </td>
		<td><p>入力 </p>
		<p>double </p></td>
		<td><p style="text-align: center;">1.0e-8 </p></td>
		<td>2つのX値が等しいとするための許容値を指定します。詳細については、以下の<a href="../../XFunction/X-Function/Reducedup.html#Algorithm" 
													 title="Xファンクション:Reducedup">アルゴリズム</a>セクションを参照してください。 
		 </td>
	</tr>
	<tr>
		<td>出力 </td>
		<td>oy </td>
		<td><p>出力 </p>
		<p>XYRange </p></td>
		<td><p style="text-align: center;">&lt;new&gt; </p></td>
		<td>出力範囲を指定します。<a class="external text" href="../../XFunction/X-Function/Output_Notations.html">出力表記</a>のシンタックスを参照してください。 
		 </td>
	</tr>
	<tr>
		<td>重複Xのカウント </td>
		<td>xcount </td>
		<td><p>出力 </p>
		<p>XYRange </p></td>
		<td><p style="text-align: center;">&lt;new&gt; </p></td>
		<td>重複Xの数を出力するかどうかを指定します。<a class="external text" href="../../XFunction/X-Function/Output_Notations.html">出力表記</a>のシンタックスをご覧ください。 
		 </td>
	</tr>
</table>
<h2><a name="Description"></a><span class="mw-headline">説明</span></h2>
<p>このXファンクションは、重複するX値を持つデータ行を削除します。このXファンクションでデータを削減した後、同じX値を持つデータはなくなります。元データで同じX値に対応するY値は、選択した統計量で置き換わります。 
 </p>
<h2><a name="Example"></a><span class="mw-headline">サンプル</span></h2>
<p>次のサンプルでは、同じX値を含むいくつかのデータ行を削減する方法を示しています。 </p>
<ol>
	<li>ワークブックを作成して、&lt;Originプログラムフォルダ&gt;\Samples\Mathematics\Circle.datをインポートします。</li>
	<li>ワークシート列を選択してメインメニューの<b>作図：基本の2Dグラフ：折れ線</b>を選択してグラフを作成します。 
	<dl>
		<dd><a class="image"><img alt="Reducedup-1.png" src="../images/Reducedup/Reducedup-1.png" 
									 width="395" border="0" /></a></dd>
	</dl></li>
	<li>グラフをアクティブにします。<b>解析：データ操作：データ削減：重複X</b>メニューを選び、 <b>reducedup</b>Xファンクションダイアログボックスを開きます。 
	 </li>
	<li><b>自動プレビュー</b>にチェックを付けると、ダイアログプションを変更しても<b>プレビュー</b>ウィンドウで現在の結果を確認できます。 
	 </li>
	<li><b>置換方法</b>ドロップダウンリストで<b>最小</b>を選択します。</li>
	<li><b>重複Xのカウント</b>にチェックを付け、<b>[&lt;新規&gt;]&lt;新規&gt;</b> にします。これでデータ削減後に重複Xの数を取得できます。 
	 
	<dl>
		<dd><a class="image"><img alt="Reducedup-2.png" src="../images/Reducedup/Reducedup-2.png" 
									 width="848" border="0" /></a></dd>
	</dl></li>
	<li><b><b>OK</b></b>ボタンをクリックします。元のワークブックとグラフで結果を確認できます。 
	<dl>
		<dd><a class="image"><img alt="Reducedup-3.png" src="../images/Reducedup/Reducedup-3.png" 
									 width="545" border="0" /></a></dd>
	</dl></li>
	<li>削減データを別のグラフにプロットします。ワークブックを開きます。col(C) と col(D)を選択します。Originメニューから<b>作図: 
	 基本の2Dグラフ：折れ線</b>を選択して、グラフを描画します。 
	<dl>
		<dd><a class="image"><img alt="Reducedup-4.png" src="../images/Reducedup/Reducedup-4.png" 
									 width="420" border="0" /></a></dd>
	</dl></li>
</ol>
<h2><a name="Algorithm"></a><span class="mw-headline">アルゴリズム</span></h2>
<ul>
	<li><b>2つの値が等しいかどうかを確認する許容値</b></li>
</ul>
<p>いくつかのXファンクションの同一性の検定では許容値を含みます。このアルゴリズムは、2つのX値が等しいかどうかを検定します。 </p>
<p>与えられたvectorデータに対して、最初に昇順でソートし、ソートされたvectorデータが<img src="../images/Reducedup/math-324a4134393132d8cf5ce9cf50a56026.png" 
														 title="\left (x_1, x_2, x_3, ..., x_n \right )" 
														 alt="\left (x_1, x_2, x_3, ..., x_n \right )" 
														 class="tex" border="0" /> 
 とします。ここで <img src="../images/Reducedup/math-7b8b965ad4bca0e41ab51de7b31363a1.png" 
				 title="n" alt="n" class="tex" border="0" /> はvectorのサイズです。次のステップは、2つのX値が指定した許容値 
 <img src="../images/Reducedup/math-d9734757e2e9d7363d18a5d238f419b4.png" 
		 title="tol" alt="tol" class="tex" border="0" /> で等しいかどうかを検定する手順です。 
 </p>
<ol>
	<li>Vectorデータの最大値と最小値を見つけ、それぞれ <img src="../images/Reducedup/math-2ffe4e77325d9a7152f7086ea7aa5114.png" 
										 title="max" alt="max" class="tex" 
										 border="0" /> および <img src="../images/Reducedup/math-d8bd79cc131920d5de426f914d17405a.png" 
	 title="min" alt="min" class="tex" border="0" /> とします。</li>
	<li>次式で検定値 <img src="../images/Reducedup/math-6d7bb09c8a8458d49341dd84b7bf8f92.png" 
					 title="dTol" alt="dTol" class="tex" border="0" /> 
	 を計算します。 
	<dl>
		<dd><img src="../images/Reducedup/math-1aa1cd5340a47f0d642c9a70bf2e1997.png" 
				 title="dTol = tol * \left ( max - min \right )" alt="dTol = tol * \left ( max - min \right )" 
				 class="tex" border="0" /></dd>
	</dl></li>
	<li><img src="../images/Reducedup/math-aa687da0086c1ea060a8838e24611319.png" 
			 title="x_1" alt="x_1" class="tex" border="0" /> から <img src="../images/Reducedup/math-5bef92b1854f9c388d11bfbb1720c05d.png" 
	 title="x_n" alt="x_n" class="tex" border="0" /> までのソートしたvectorですべての値をループし、<img 
	 src="../images/Reducedup/math-8d33799f7f12b4e9922e6095ec2a425b.png" 
	 title="\left ( x_n - x_{n-1} \right)" alt="\left ( x_n - x_{n-1} \right)" 
	 class="tex" border="0" /> の絶対値を <img src="../images/Reducedup/math-6d7bb09c8a8458d49341dd84b7bf8f92.png" 
											 title="dTol" alt="dTol" class="tex" 
											 border="0" /> と比較します。 
	<dl>
		<dd><img src="../images/Reducedup/math-54bd16f94e627e9f2344db2732cdcb7b.png" 
				 title="abs \left ( x_n - x_{n-1} \right ) \le dTol" alt="abs \left ( x_n - x_{n-1} \right ) \le dTol" 
				 class="tex" border="0" /> の場合、<img src="../images/Reducedup/math-4b247a15debbefd719a8a03bf7fa0999.png" 
													 title="x_n = x_{n-1} \," 
													 alt="x_n = x_{n-1} \," 
													 class="tex" border="0" /> 
		 となり、そうでない場合は <img src="../images/Reducedup/math-445173307aeb1ab10148c0e905f7f8b5.png" 
							 title="x_n \ne x_{x-1}" alt="x_n \ne x_{x-1}" 
							 class="tex" border="0" /> です。</dd>
	</dl></li>
	<li>複数のX値が等しいと決まったら、つまり<img src="../images/Reducedup/math-ad9df8bf28bd3fcb175e1ac1384d4bb6.png" 
								 title="\left ( x_i, x_{i+1}, ..., x_j \right )" 
								 alt="\left ( x_i, x_{i+1}, ..., x_j \right )" 
								 class="tex" border="0" />、ここで<img src="../images/Reducedup/math-8bc9f3ea62ffcb0b8bc056bc3fb168f6.png" 
	 title="1 \le i &lt; j \le n" alt="1 \le i &lt; j \le n" class="tex" 
	 border="0" /> は、この等しいX値に対して表示X値は次のように定義されます。 
	<dl>
		<dd>この等しいX値の数が偶数の場合、表示X値は <img src="../images/Reducedup/math-16c6a40185c22da8ec3352cd2726cb38.png" 
										 title="x_{\frac {i + j - 1}{2}}" 
										 alt="x_{\frac {i + j - 1}{2}}" 
										 class="tex" border="0" /> です。</dd>
		<dd>この等しいX値の数が奇数の場合、表示X値は <img src="../images/Reducedup/math-027c1e8e023a843ee27bb39f379c4363.png" 
										 title="x_{\frac {i + j}{2}}" alt="x_{\frac {i + j}{2}}" 
										 class="tex" border="0" /> です。</dd>
	</dl></li>
</ol>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">関連するXファンクション</span></h2>
<p><a href="../../XFunction/X-Function/Stats.html" title="Xファンクション:Stats">stats</a>, 
 <a href="../../XFunction/X-Function/Reducexy.html" title="Xファンクション:Reducexy">reducexy</a> 
 </p>
<hr class="keywordshr" style="float: aligncenter; " />
<p><span class="keywords">キーワード:</span><span class="keywordsInput">データ削減、代表値、平均、合計、最小値、最大値、統計</span></p>
