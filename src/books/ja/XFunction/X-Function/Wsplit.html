<h1 class="firstheading">wsplit</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">メニュー情報</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">概要</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Additional_Information"><span class="tocnumber">3</span> <span class="toctext">追加の情報</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Command_Line_Usage"><span class="tocnumber">4</span><span class="toctext">コマンドラインでの使用法</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#X-Function_Execution_Options"><span class="tocnumber">5</span> <span class="toctext">Xファンクションの実行オプション</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Variables"><span class="tocnumber">6</span> <span class="toctext">変数</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Description"><span class="tocnumber">7</span> <span class="toctext">説明</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Related_X-Functions"><span class="tocnumber">8</span> <span class="toctext">関連するXファンクション</span></a></li>
</ul>
</div>

<h2><a name="Menu_Information"></a><span class="mw-headline">メニュー情報</span></h2>
<p>データ整形：ワークシートの分割
</p>
<h2><a name="Brief_Information"></a><span class="mw-headline">概要</span></h2>
<p>行/列または参照列の値でワークシートを分割します
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">追加の情報</span></h2>
<p><b>必要なOriginのバージョン</b>: Origin 8.6 以降 
</p><p>部分ワークシートの分割、参照列による分割、結果シート名の事前設定は2017b以上が必要です。
</p><p>値と条件の両方に従う参照列による分割は2021が必要です。
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">コマンドラインでの使用法</span></h2>
<p><code>
1. wsplit mode:=row row:=5;
</p><p>2. wsplit mode:=label label:=L keep:=1;
</p><p>3. wsplit mode:=ref ref:=[Book1]Sheet1!A name:=&lt;[&lt;%N_%V&gt;]&gt;;
</p><p>4. wsplit mode:=ref ref:=[Book1]Sheet1!D refmode:=change turnpoint:=pregroup refsort:=desc;
</p><p></code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">Xファンクションの実行オプション</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">スクリプトからXファンクションにアクセスする場合、追加のオプションスイッチについてのページを参照してください。</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">変数</span></h2>
<table class="xfvar">
<tr>
<th width="8%">表示<br />名
</th>
<th width="8%">変数<br />名
</th>
<th width="8%">I/O<br />と<br />データ型
</th>
<th width="8%">デフォルト<br />値
</th>
<th>説明
</th></tr>
<tr>
<td>入力ワークシート
</td>
<td>iw
</td>
<td>
<p>入力
</p><p>Worksheet
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> 分割する範囲を指定します。ワークシート全体または列範囲です。
</td></tr>
<tr>
<td>分割モード
</td>
<td>mode
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> 入力ワークシートの分割方法を指定します。
<p>オプションリスト:
</p>
<ul><li><i>col:列番号による</i>
<dl><dd><i>n</i> 列ごとに新しいワークシートに分解します。<b>列</b>の数<i>n</i>を指定します。</dd></dl></li>
<li><i>row:行番号による</i>
<dl><dd><i>n</i> 行ごとに新しいワークシートに分解します。<b>行</b>の数<i>n</i>を指定します。</dd></dl></li>
<li><i>label:列ラベルによる</i>
<dl><dd>指定されたラベル行に同じラベルがある列は、同じワークシートに分割されます。<b>ラベル</b>のある列ラベルを指定します。 </dd></dl></li>
<li> <i>ref: 参照列</i>
<dl><dd>参照列の値と条件で、行がグループ化され新しいワークシートに分割されます。 </dd></dl></li></ul>
</td></tr>
<tr>
<td>列数
</td>
<td>col
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>2</center>
</td>
<td> <b>分割モード</b>を<i>列番号による</i>にしたときに有効です。指定した<i><i>n</i></i> 行ごとに新しいワークシートを作成します。
</td></tr>
<tr>
<td>行数
</td>
<td>row
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>2</center>
</td>
<td> <b><b>分割モード</b></b>を<i><b>行の数による</b></i>にしたとき有効です。指定した<i><i>n</i></i> 行ごとに新しいワークシートを作成します。
</td></tr>
<tr>
<td>列ラベル
</td>
<td>label
</td>
<td>
<p>入力
</p><p>string
</p>
</td>
<td> <center></center>
</td>
<td> <b>分割モード</b>を<i>列ラベルによる</i>にしたときに有効です。ラベル行文字を使用してラベル行を指定します。  各列ラベル行を示す文字については<a class="external text" href="../../LabTalk/LabTalk/Column_Label_Row_Characters.html">Column Label Row Characters</a>を参照してください。
</td></tr>
<tr>
<td> 参照列
</td>
<td> ref
</td>
<td>
<p>入力
</p><p>Range
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td> <b><b>分割モード</b></b>を<i>参照列</i>にしたとき有効です。グループ化変数を含む列を指定します（複数選択可）。
</td></tr>
<tr>
<td>分割
</td>
<td>refmode
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>選択した参照列に従ってワークシート行を分割する方法を指定します。
</p><p>このコントロールは<b>参照列</b>ボックスで1つの参照列を選んでいる場合にのみ有効になります。
オプションリスト：
</p>
<ul><li> <b>0=val:値による</b>
<dl><dd> 参照列の値に従ってワークシートの行を分割します。参照列に同じ値を持つ行が分割され、結果ワークシートに抽出されます。許容値を指定します。これはデフォルトで選択されています。</dd></dl></li>
<li> <b>1=change:方向変更による</b>
<dl><dd> 参照列の値の方向が昇順から降順、またはその逆に変更されたときに、ワークシートの行を分割します。  </dd></dl></li>
<li> <b>2=reset:方向リセットによる</b>
<dl><dd> 参照列の値の上昇/下降が基本にリセットされたら、ワークシートの行を分割します。</dd></dl></li>
<li> <b>3=refval:値の変更による</b>
<dl><dd> 参照列の値が変更されたときにワークシートの行を分割します。許容値を指定します。 </dd></dl></li></ul>
</td></tr>
<tr>
<td>許容値
</td>
<td>tol
</td>
<td>
<p>入力
</p><p>double
</p>
</td>
<td> <center>1E-8</center>
</td>
<td> <b>分割モード</b>を<i>参照列</i>に、かつ<b>分割</b>を<i>値による</i>/<i>値の変更による</i>にしたときに有効です。数値が変化するかどうかを判断するときに考慮される許容誤差を指定します。
</td></tr>
<tr>
<td>各曲点を含める
</td>
<td>turnpoint
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> <b>分割</b>で<b>方向変更による</b>を選んだ際に、前のグループか次のグループどちらに曲点を含めるのかを指定します。
<p>オプションリスト：
</p>
<ul><li> <b>0=pregroup:前のグループ</b>
<dl><dd> ワークシート列を分割した際に前のグループに曲点を含める</dd></dl></li>
<li> <b>1=nextgroup:次のグループ</b>
<dl><dd> ワークシート列を分割した際に次のグループに曲点を含めるこれはデフォルトで選択されています。</dd></dl></li></ul>
</td></tr>
<tr>
<td> 結果内に参照列を保持
</td>
<td> keepref
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> 分割結果に参照列データを出力します。
</td></tr>
<tr>
<td>参照列による結果を並べ替え
</td>
<td>refsort
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> <b>結果内に参照列を保持</b>をチェックしたときに、参照列の対応する値に従って、結果列をソートするかどうかを指定します。このチェックボックスは、<b>分割</b>コントロールを<b>方向変更による</b>または<b>方向リセットによる</b>にしたときにのみ使用できます。
<p>オプションリスト：
</p>
<ul><li> <b>0=unsorted:ソートなし</b>
<dl><dd> 元の行の順番を維持し、ソートしません。</dd></dl></li>
<li> <b>1=asc:昇順</b>
<dl><dd> 参照列で対応する値の昇順で結果ワークシートの結果行をソートします。</dd></dl></li>
<li> <b>2=desc:降順</b>
<dl><dd> 参照列で対応する値の降順で結果ワークシートの結果行をソートします。</dd></dl></li></ul>
</td></tr>
<tr>
<td> 欠損値を除外
</td>
<td> missing
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> 空のセルや欠損値(&quot;--&quot;)を含むセルを出力から除外します。
</td></tr>
<tr>
<td>列の数式を結果にコピーする
</td>
<td>copyform
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> 元のワークシートに列の数式がある場合、式をどう扱うか設定します。
<p>オプションリスト：
</p>
<ul><li> <b>0=none:なし</b>
<dl><dd>列の数式をコピーしません。</dd></dl></li>
<li> <b>1=copyexc:コピーして実行</b>
<dl><dd>列の数式を結果シートにコピーして実行します。</dd></dl></li>
<li> <b>2=copy:式のテキストをコピー</b>
<dl><dd>列の数式を結果シートにコピーしますが、実行しません。必要に応じて手動で実行します。</dd></dl></li></ul>
</td></tr>
<tr>
<td>ショートネームを維持
</td>
<td>sn
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> 新しいワークシートに分割した後、列のショートネームを保持するかどうかを指定します。
<p><b>Note</b> Origin 2017から、<a class="external text" href="../../UserGuide/UserGuide/Column_Short_Name_Restriction.html">列のショートネームは、アルファベット順に制限</a>されます。初期設定ではこれは編集出来ません。<b>ショートネームを維持</b>オプションは<a class="external text" href="../../UserGuide/UserGuide/Split_Worksheet.html">GUIでは非表示</a>です。（ページ下部のノートをご覧ください）スクリプトユーザは、<a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#S">@SSG</a>の値に関らず、<code>sn:=1</code>を使って編集されたショートネームを出力することが可能です。
</p>
</td></tr>
<tr>
<td>最初のN列を保持する
</td>
<td>fixcol
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> <b>分割モード</b>を<i>列番号による</i>または<i>列ラベルによる</i>にしたときに有効です。ソースワークシートの最初の<i>n</i>列を指定して、分割された全ての結果シートにおいても保持されるようにします。これらの最初の<i>n</i>列は、<i>列番号による</i>または<i>列ラベルによる</i>から除外されます。
</td></tr>
<tr>
<td>元のワークシートの維持
</td>
<td>keep
</td>
<td>
<p>入力 int
</p>
</td>
<td> <center>1</center>
</td>
<td> 元のワークシートをそのまま残します。チェックを付けないと元のワークシートは削除されます。
</td></tr>
<tr>
<td>スパークラインを表示する
</td>
<td>sparkline
</td>
<td>
<p>入力 int
</p>
</td>
<td> <center>1</center>
</td>
<td> 出力ワークシートの列のスパークラインを表示します。
</td></tr>
<tr>
<td>出力ワークシート
</td>
<td>owp
</td>
<td>
<p>出力
</p><p>WorksheetPage
</p>
</td>
<td> <center>&lt;new&gt;</center>
</td>
<td> 出力ワークシートを指定します。
</td></tr>
<tr>
<td>結果シート名事前設定
</td>
<td>name
</td>
<td>
<p>入力
</p><p>string
</p>
</td>
<td> <center>%V</center>
</td>
<td>
<p>%N = あればロングネームなければショートネーム<br />
%C = データセット名<br />
%M = コメント<br />
%U = 単位<br />
%V = セル値(グループ変数)を参照
</p><p>変数は組み合わせ可能で、任意テキストを含めることもできます（%N=%V など）。単一、組み合わせ、任意テキストとの組み合わせのどの場合も、次のサンプルのように変数は保護されます。
</p>
<pre class="lt" style="font-family:monospace;">wsplit mode<span style="color: #000000;">:</span><span style="color: #000080;">=</span>ref ref<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span>Book1<span style="color: #000000;">]</span>Sheet1<span style="color: #000080;">!</span>A name<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span><span style="color: #000000;">[</span><span style="color: #000080;">&lt;</span><span style="color: #000080;">%</span>N_<span style="color: #000080;">%</span>V<span style="color: #000080;">&gt;</span><span style="color: #000000;">]</span><span style="color: #000080;">&gt;</span>;</pre>
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">説明</span></h2>
<p>このXファンクションは、指定された方法でワークシートの複数列を複数のワークシートに分割します。
</p>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">関連するXファンクション</span></h2>
<p><a href="../../XFunction/X-Function/Wsplit_book.html" title="Xファンクション:Wsplit book">wsplit_book</a>
</p>






    