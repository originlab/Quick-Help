<h1 class="firstheading">XファンクションのRangeListBoxのサンプル</h1><p><span class="OIndex" style="display:none">X-Function Range</span>
</p>
<h2><a name="Summary"></a><span class="mw-headline">概要</span></h2>
<p>この例では、Range変数にListBoxコントロールを使用する方法を示します。
</p>
<h2><a name="Steps"></a><span class="mw-headline">ステップ</span></h2>
<ol start="1">
<li>
ツールメニューのXファンクションビルダを開き、次の図のようにXファンクション名と変数を入力して、保存をクリックします。<a  class="image"><img alt="Ocguide xfdialog savebutton.png" src="../images/X-Function_RangeListBox_Example/Ocguide_xfdialog_savebutton.png" width="23"  /></a>.<br /><a  class="image"><img alt="OCguide xf example RangeListBox.png" src="../images/X-Function_RangeListBox_Example/OCguide_xf_example_RangeListBox.png" width="517"  /></a>
</li>
<li>
コードビルダーでこのXファンクションを開き、ソースコードを編集します。まず、以下のように必要なヘッダファイルを含めます。
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>..\OriginLab\wks_utils.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span> <span style="color: #008000;">// init_GetN_col_list_ctrls関数に必要</span></pre>
</li>
<li>
Xファンクションのメイン関数<i>collistex</i>で、次のコードを追加し、指定したデータ範囲から範囲文字列を取得します。
<span class="OIndex" style="display:none">X-Function, Range</span>
<pre class="oc" style="font-family:monospace;">	string str;
	<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span>collist<span style="color: #000000;">)</span>
		collist.<span style="color: #000000;">GetRangeString</span><span style="color: #000000;">(</span>str, NTYPE_FOR_RANGE<span style="color: #000000;">)</span>;
	out_str<span style="color: #000000;">(</span>str<span style="color: #000000;">)</span>;</pre>
</li>
<li>
Xファンクションのbefore_execute関数<i>collistex_before_execute</i>に、collist変数の制御を初期化する次のコードを追加します。これにより、collistはListBoxからリスト列の範囲になります。
<pre class="oc" style="font-family:monospace;">	<span style="color: #0000ff;">bool</span> bIsStart <span style="color: #000080;">=</span> is_xf_startup<span style="color: #000000;">(</span>nGetNDialog, dwCntrl<span style="color: #000000;">)</span>;
	<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span>bIsStart <span style="color: #000040;">&amp;&amp;</span> <span style="color: #000000;">(</span>dwCntrl <span style="color: #000040;">&amp;</span> LTXF_SHOW_DIALOG<span style="color: #000000;">)</span><span style="color: #000000;">)</span>
	<span style="color: #000000;">{</span>
		init_GetN_col_list_ctrls<span style="color: #000000;">(</span><span style="color: #0000ff;">NULL</span>, trGetN.<span style="color: #000000;">collist</span><span style="color: #000000;">)</span>;
	<span style="color: #000000;">}</span></pre>
</li>
<h2><a name="Run_the_X-Function"></a><span class="mw-headline">Xファンクションを実行</span></h2>
<ol>
<li>
スクリプトウィンドウで<i>collistex -d</i>を実行すると、以下のダイアログが表示されます。
<div><a  class="image"><img alt="Ocguide xfdialog collistex display.png" src="../images/X-Function_RangeListBox_Example/Ocguide_xfdialog_collistex_display.png" width="330"  /></a>
</div>
</li>
<li>
ListBoxの三角形ボタンをクリックして列を追加でき、列を選択/選択解除できます。
<div><a  class="image"><img alt="Ocguide xfdialog collistex columns.png" src="../images/X-Function_RangeListBox_Example/Ocguide_xfdialog_collistex_columns.png" width="332"  /></a>
</div>
</li>
<li>
OKをクリックします。選択した列の範囲を出力します。
</li>
</ol></ol>




    