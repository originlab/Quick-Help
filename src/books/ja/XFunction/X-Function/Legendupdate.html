<h1 class="firstheading">legendupdate</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">メニュー情報</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span class="tocnumber">2</span><span class="toctext">概要</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Command_Line_Usage"><span class="tocnumber">3</span> <span class="toctext">コマンドラインでの使用法</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#X-Function_Execution_Options"><span class="tocnumber">4</span> <span class="toctext">Xファンクション実行オプション</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Variables"><span class="tocnumber">5</span> <span class="toctext">変数</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Description"><span class="tocnumber">6</span> <span class="toctext">説明</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Examples"><span class="tocnumber">7</span> <span class="toctext">サンプル</span></a></li>
</ul>
</div>

<h2><a name="Menu_Information"></a><span class="mw-headline">メニュー情報</span></h2>
<p>グラフ操作：凡例：凡例の更新
</p>
<h2><a name="Brief_Information"></a><span class="mw-headline">概要</span></h2>
<p>グラフの凡例を更新/再構築します
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">コマンドラインでの使用法</span></h2>
<p><code>
1. legendupdate dest:=layer update:=reconstruct legend:=combine order:=ascend mode:=lu;
</code>
</p><p><br />
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">Xファンクションの実行オプション</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">スクリプトからXファンクションにアクセスする場合、追加のオプションスイッチについてのページを参照してください。</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">変数</span></h2>
<table class="xfvar">
<tr>
<th width="8%">表示<br />名
</th>
<th width="8%">変数<br />名
</th>
<th width="8%">I/O<br />と<br />データ型
</th>
<th width="8%">デフォルト<br />値
</th>
<th>説明
</th></tr>
<tr>
<td>更新スコープ
</td>
<td>dest
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> 凡例の更新を適用する場所を指定します。
<p>オプションリスト：
</p>
<ul><li><i>page:ページ全体</i>
<dl><dd>アクティブページ全体の凡例を更新します。</dd></dl></li>
<li><i>layer:アクティブレイヤ</i>
<dl><dd>アクティブレイヤの凡例を更新します。</dd></dl></li>
<li><i>spepage:指定ページ</i>
<dl><dd>ダイアログボックスでは非表示です。これを選択すると、 <i>page</i>変数で指定したグラフページの凡例だけを更新します。</dd></dl></li>
<li><i>spelayer:指定レイヤ</i>
<dl><dd>ダイアログボックスでは非表示です。これを選択すると、<i>layer</i>変数で指定したグラフレイヤの凡例だけを更新します。</dd></dl></li></ul>
</td></tr>
<tr>
<td>更新モード
</td>
<td>update
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> 凡例を再構築するか更新するか指定します。
<p>オプションリスト：
</p>
<ul><li><i>reconstruct:再構築</i>
<dl><dd><b>凡例の自動更新モード</b>と<b>順序</b>変数に従って凡例を再構築します。</dd>
<dd><b>Note:</b> 凡例の形式がデフォルト設定に戻ります。 </dd></dl></li>
<li><i>update:更新</i>
<dl><dd>指定した変数で既存の凡例情報を更新します。 </dd>
<dd><b>Note:</b> 既存の凡例の形式と構造は変更されません。</dd></dl></li></ul>
</td></tr>
<tr>
<td>凡例
</td>
<td>legend
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> これは、<b>update</b>で<b>reconstruct</b>が選択されている場合のみ利用できます。この変数で再構築される凡例の種類を指定します。
<p>オプションリスト：
</p>
<ul><li><i>separate:各レイヤの凡例</i>
<dl><dd>各レイヤにそれぞれ異なる凡例を構築します。</dd></dl></li>
<li><i>combine:全てのページ用の1つの凡例</i>
<dl><dd>グラフ内の全てのレイヤの凡例を1つにまとめて作成します。</dd></dl></li></ul>
</td></tr>
<tr>
<td>順序
</td>
<td>order
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> これは、<b>update</b>で<b>reconstruct</b>が選択されている場合のみ利用できます。凡例を再構築する場合、グラフレイヤから情報が読み込まれます。この変数で、読み込むレイヤの順序を設定します。
<p>オプションリスト：
</p>
<ul><li><i>descend:降順</i>
<dl><dd>レイヤの情報をレイヤインデックスの降順でデータを読み取ります。</dd></dl></li>
<li><i>ascend:昇順</i>
<dl><dd>レイヤの情報をレイヤインデックスの昇順でデータを読み取ります。</dd></dl></li></ul>
</td></tr>
<tr>
<td>レイヤ内でのグラフの順序
</td>
<td>porder
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> <b>update</b>で<b>reconstruct</b>が選択され、<b>legend</b>変数が<b>combine</b>のときに使用可能です。この変数はレイヤ内の読み取る順番を指定します。
<p>オプションリスト：
</p>
<ul><li><i>descend:降順</i>
<dl><dd>レイヤ内のプロット情報を読み取るのに、インデックスの降順でデータを読み取っていきます。</dd></dl></li>
<li><i>ascend:昇順</i>
<dl><dd>レイヤ内のプロット情報を読み取るのに、インデックスの昇順でデータを読み取っていきます。</dd></dl></li></ul>
</td></tr>
<tr>
<td>凡例の自動更新モード
</td>
<td>mode
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> LabTalk変数表記(&quot;%(1)&quot;, &quot;%(2)&quot;など)を使って凡例を作成します。Origin が凡例を作成するときに、指定された表記を自動で値に「変換」します。この変数で、表記の変換に使用する情報を指定します。
<p>オプションリスト：
</p>
<ul><li><i>comment:@LM:コメントを使用 (第1行)</i>
<dl><dd>ソースデータのコメント行の第1行を使用します。それ以外の場合、列のロングネームを使用します。コメントもロングネームもない場合、対応するショートネームを使用します。</dd></dl></li>
<li><i>dr:@R:データ範囲</i>
<dl><dd>プロットのデータ範囲です。</dd></dl></li>
<li><i>lu:@U:ロングネーム&amp;単位</i>
<dl><dd>元データのロングネームと単位です。ロングネームがない場合、代わりに列ショートネームが使用されます。</dd></dl></li>
<li><i>udpara:@LD:ユーザパラメータ1</i>
<dl><dd>元データの最初のユーザパラメータ行です。</dd></dl></li>
<li><i>lname:@LA:ロングネーム</i>
<dl><dd>元データのロングネームです。</dd></dl></li>
<li><i>sname:@LS:ショートネーム</i>
<dl><dd>元データのショートネームです。</dd></dl></li>
<li><i>lpara:@LP:パラメータ1</i>
<dl><dd>元データの最初のシステムパラメータ</dd></dl></li>
<li><i>custom:カスタム</i>
<dl><dd><b>custom</b> 変数で指定した情報です。</dd></dl></li></ul>
</td></tr>
<tr>
<td>凡例のカスタムフォーマット(@D, @LU etc)
</td>
<td>custom
</td>
<td>
<p>入力
</p><p>string
</p>
</td>
<td> <center></center>
</td>
<td><b>mode</b>変数で<b>custom</b>が選択されているときだけ利用可能です。凡例表記の前後に任意のリテラルを追加することができます。ここで使用した<a class="external text" href="../../LabTalk/LabTalk/Text_Label_Options.html#Complete_List_of_.40Options">表記法</a>は変換に使用します。
</td></tr>
<tr>
<td>追加フォーマット(@L、@Vなど)
</td>
<td>addon
</td>
<td>
<p>入力
</p><p>string
</p>
</td>
<td> <center></center>
</td>
<td><b>凡例の自動更新モード</b>に<b>カスタム</b>が選択されて、<b>カスタム</b>変数が<i>@L</i>、<i>@V</i>、<i>@WT</i>になっている場合にのみ有効です。ワークシートセルアクセスの完全な表記への<i>n</i> 番目の行および/または<i>ｍ</i> 番目の列を指定します。詳細は<a class="external text" href="../../LabTalk/LabTalk/Text_Label_Options.html#Complete_List_of_.40Options">表記法</a>を参照してください。
</td></tr>
<tr>
<td>グラフページ
</td>
<td>page
</td>
<td>
<p>入力
</p><p>GraphPage
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td> <b>dest</b>の変数が<b>spepage</b>にセットされている場合のみ、この変数を利用できます。グラフページを指定するのに使用します。指定したグラフページ上の凡例が更新されます。
</td></tr>
<tr>
<td>グラフレイヤ
</td>
<td>layer
</td>
<td>
<p>入力
</p><p>GraphLayer
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td> <b>dest</b>の変数が<b>spepage</b>にセットされている場合のみ、この変数を利用できます。グラフレイヤを指定するのに使用します。指定したグラフレイヤ上の凡例が更新されます。
</td></tr>
<tr>
<td>表示可能なプロットにのみ凡例を表示
</td>
<td>hide
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td><center>1</center>
</td>
<td>凡例内に非表示プロットを表示するか指定します。
</td></tr>
<tr>
<td>フィット曲線の凡例を隠す
</td>
<td>fit
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td><center>0</center>
</td>
<td>凡例内にフィットカーブを表示するかどうかを指定します。
</td></tr>
<tr>
<td>アクティブデータセットの標識
</td>
<td>indicate
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td><center>1</center>
</td>
<td>凡例内でアクティブデータセットに標識をつけるかを選択します。
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">説明</span></h2>
<p>このXファンクションはグラフまたはレイヤの凡例を更新/再構築することができます。ダイアログのメニューからアクセスできます。ダイアログ内の設定はこの<a class="external text" href="../../UserGuide/UserGuide/The_legendupdate_Dialog_Box.html">オンラインヘルプ</a>を参照してください。
</p>
<h2><a name="Examples"></a><span class="mw-headline">サンプル</span></h2>
<p>このサンプルでは、グラフ凡例の更新方法を紹介しています。サンプルデータは、<b>&lt;exeパス&gt;\Samples\Signal Processing\Signal with Shot Noise.dat</b>からインポートできます。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// サンプルデータ取得</span>
fn<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Signal Processing\Signal with Shot Noise.dat&quot;</span>;
newbook;
impASC fn<span style="color: #000080;">$</span>;

<span style="color: #008000;">// 折れ線グラフを作成 </span>
<span style="color: #008000;">// ワークシートロングネームと単位を使ったデフォルト凡例</span>
plotxy col<span style="color: #000000;">(</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;

<span style="color: #008000;">// 凡例を更新;</span>
legendupdate mode<span style="color: #000000;">:</span><span style="color: #000080;">=</span>lu;</pre>







    