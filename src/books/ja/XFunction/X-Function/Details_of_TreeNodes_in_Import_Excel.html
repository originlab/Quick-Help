<h1 class="firstheading">Excelインポートのツリーノードに関する詳細<br /></h1>
<h2><a name="Options" id="Options"></a><span class="mw-headline">オプション</span></h2>
<p><b style="font-weight: bold;">オプション</b>ツリーは、 <b>impExcel</b> Xファンクションのインポートオプションを全て指定します。</p>
<p>シンタックス：<b>Options.<i>.SubTree.Treenode</i>:=&lt;value&gt;</b></p>
<p>例：<b>Options.Names.FNameToSht:=1</b><br /></p>
<p><br /></p>
<h3><a name="Names" id="Names"></a><span class="mw-headline">ワークシート/ブックの名前を付ける/変更する</span></h3>
<p><b style="font-weight: bold;">オプション</b>ツリーの<b>ワークシート/ブックの名前を付ける/変更する</b>ブランチはワークシートとワークブックの名づけについて指定します。</p>
<p>シンタックス：<b>Options.Names.Treenode:= &lt;<i>value</i>&gt;</b></p>
<p>例：<br />
ファイル名の一部でワークシート名を変更する:<br />
<b>Options.Names.FNameToSht:=1</b><br />
<b>Options.Names.FNameToShtFrom:=1</b><br />
<b>Options.Names.FNameToShtTo:=4</b><br /></p>
<p><br /></p>
<table class="treetable">
<tr>
<th>ツリーノード</th>
<th>ラベル</th>
<th>データ型</th>
<th>デフォルト</th>
<th>説明</th>
</tr>
<tr>
<td>AutoNames</td>
<td>ファイル名による自動名前変更</td>
<td>int</td>
<td>0</td>
<td>チェックが付いていると、Originはデフォルト設定を使って、ワークシートとワークブックの名前を変更します。
<ul>
<li>ファイル名全体(拡張子を含む)をワークシート名として使用します。</li>
<li>ワークブックが空の場合またはインポートモードが<b>既存データの置き換え</b>の場合、ファイル名全体(拡張子を含む)をワークブック名として使用します。</li>
</ul>
</td>
</tr>
<tr>
<td>FNameToBk</td>
<td>ブック名を(部分)ファイル名に変更する</td>
<td>int</td>
<td>1</td>
<td>これにチェックが付いていると、ワークブック名にファイル名の一部を使います。</td>
</tr>
<tr>
<td>FNameToBkFrom</td>
<td>短縮開始位置</td>
<td>int</td>
<td>1</td>
<td>ブック名の開始位置</td>
</tr>
<tr>
<td>FNameToBkTo</td>
<td>短縮終了位置</td>
<td>int</td>
<td>0</td>
<td>ブック名の終了位置</td>
</tr>
<tr>
<td>FNameToBkLnOnly</td>
<td>ブックのロングネームのみを変更する</td>
<td>int</td>
<td>0</td>
<td>これにチェックを付けると、ブックのロングネームのみ名前を変更します。</td>
</tr>
<tr>
<td>FPathToBk</td>
<td>ブック名の変更時にファイルパスを含める</td>
<td>int</td>
<td>0</td>
<td>ファイルパスをワークブック名に含めるかどうかを指定します。</td>
</tr>
<tr>
<td>FNameToBkComm</td>
<td>ワークブックコメントにファイル名を追加</td>
<td>int</td>
<td>1</td>
<td>ワークブックコメントにファイル名を追加するかどうか指定します。</td>
</tr>
<tr>
<td>FPathToComm</td>
<td>ファイル名の追加の際にパスを含める</td>
<td>int</td>
<td>1</td>
<td>これにチェックが付いていると、ワークブックのコメントとコメント行にインポートファイルパスが追加されます。</td>
</tr>
</table>
<table class="note">
<tr>
<td><b style="font-weight: bold;">Note:</b>
<p>Origin8.6以降、マイナス値(－)が<b>短縮開始位置</b>と<b>短縮終了位置</b>に追加されました。これは、ファイル名の最後の文字からカウントするためです。これはファイル拡張子を除くために使用できます。例えば、<i>sample.xls</i>という名前のASCIIファイルをインポートする場合、設定として拡張子「<i>.xls</i>」を切り取るように指定する事もできます。</p>
<dl>
<dd><b style="font-weight: bold;">短縮開始位置</b>:1</dd>
<dd><b style="font-weight: bold;">短縮終了位置</b>:-4</dd>
</dl>
</td>
</tr>
</table>
<p><br /></p>
<h3><a name="Script" id="Script"></a><span class="mw-headline">スクリプト</span></h3>
<p><b style="font-weight: bold;">オプション</b>ツリーの<b>スクリプト</b>は、ファイルがインポートされた後に実行するLabTalkスクリプトを指定します。</p>
<p>シンタックス：<b>Options.Script.Treenode:= &lt;<i>string</i>&gt;</b></p>
<p>例：<br />
//各ファイルをインポートした後に2列目をプロット:<br />
<b>Options.Script.RunScriptAfterEachImport:="plotxy 2;";</b><br /></p>
<p>//全てのファイルがインポートされたときに、ワークブック内の全てのシートをループして、列1から4の最初の500行を削除する<br />
<b>Options.Script.RunScriptAfterAllImport:=" doc -ef W { doc -e LW { range aa =1[1]:4[500]; del aa;}}";<br /></b></p>
<p><br /></p>
<table class="treetable">
<tr>
<th>ツリーノード</th>
<th>ラベル</th>
<th>データ型</th>
<th>デフォルト</th>
<th>説明</th>
</tr>
<tr>
<td>RunScriptAfterEachImport</td>
<td>それぞれのファイルインポート後のスクリプト</td>
<td>string</td>
<td>"?"</td>
<td>各ファイルインポート後に実行されるLabTalkスクリプトを指定します。</td>
</tr>
<tr>
<td>RunScriptAfterAllImport</td>
<td>全てのファイルインポート後のスクリプト</td>
<td>string</td>
<td>"?"</td>
<td>全ファイルがインポートされた後に実行されるLabTalkスクリプトを指定します。</td>
</tr>
</table>
