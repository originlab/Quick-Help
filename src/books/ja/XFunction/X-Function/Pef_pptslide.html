<h1 class="firstheading">pef_pptslide</h1><div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">メニュー情報</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">概要</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Additional_Information"><span class="tocnumber">3</span> <span class="toctext">追加の情報</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Command_Line_Usage"><span class="tocnumber">4</span> <span class="toctext">コマンドラインでの使用法</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#X-Function_Execution_Options"><span class="tocnumber">5</span> <span class="toctext">Xファンクション実行オプション</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Variables"><span class="tocnumber">6</span> <span class="toctext">変数</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Description"><span class="tocnumber">7</span> <span class="toctext">説明</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Examples"><span class="tocnumber">8</span> <span class="toctext">サンプル</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Related_X-Functions"><span class="tocnumber">9</span> <span class="toctext">関連するXファンクション</span></a></li>
</ul>
</div>

<h2><a name="Menu_Information"></a><span class="mw-headline">メニュー情報</span></h2>
<p>Origin 2021b以降、ユーザーインターフェイスにおいては、Originにプリインストールされている <a class="external text" href="https://www.originlab.com/FileExchange/Details.aspx?fid=374" target="_blank">Send Graphs to PowerPoint App</a> に置き換えられています。Xファンクションpef_pptslideも利用可能で、スクリプトを介して、またはスクリプトウィンドウに次のように入力することで呼び出すことができます。
</p>
<pre class="lt" style="font-family:monospace;">pef_pptslide <span style="color: #000080;">-</span>d; <span style="color: #008000;">// pef_pptslideダイアログを開く</span>
pef_pptslide <span style="color: #000080;">-</span>h; <span style="color: #008000;">// パラメータをスクリプトウィンドウに印字</span></pre>
<h2><a name="Brief_Information"></a><span class="mw-headline">概要</span></h2>
<p>選択されたグラフをパワーポイントに送ります
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">追加の情報</span></h2>
<p class="version" >必要なOriginのバージョン: 2016 SR0以降</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">コマンドラインでの使用法</span></h2>
<p><code>
1.pef_pptslide export:=recursive;
</p><p>2.pef_pptslide export:=open top:=10 left:=10 bottom:=10 right:=10 title:=bottom;
</p><p>3.pef_pptslide embed:=1 title:=top mode:=lname slide:=2 slidemode:=insert;
</p><p>4.pef_pptslide export:=page title:=top mode:=lname slidemode:=insert srcf:=&quot;C:\Program Files\OriginLab\Origin2016\Samples\Import and Export\Column_Plots_in_Sample_OPJ.pptx&quot; dstf:=E:\MyOriginGraphs.pptx;
</p><p></code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">Xファンクションの実行オプション</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">スクリプトからXファンクションにアクセスする場合、追加のオプションスイッチについてのページを参照してください。</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">変数</span></h2>
<table class="xfvar">
<tr>
<th width="8%">表示<br />名
</th>
<th width="8%">変数<br />名
</th>
<th width="8%">I/O<br />と<br />データ型
</th>
<th width="8%">デフォルト<br />値
</th>
<th>説明
</th></tr>
<tr>
<td>グラフを選択
</td>
<td>export
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> PowerPointのスライドにエクスポートするグラフを指定します。
<p>オプションリスト：
</p>
<ul><li><i>folder{0}:現フォルダ中のすべて</i>
<dl><dd> プロジェクトのアクティブフォルダ内のすべてのグラフがエクスポートされます。サブフォルダのページは含まれません。非表示のページは含まれますが、ワークシートに埋め込まれたページは含まれません。</dd></dl></li>
<li><i>recursive{1}: 現フォルダ中のすべて（再帰的に適用）</i>
<dl><dd> プロジェクトのアクティブフォルダ内のすべてのグラフがエクスポートされます。サブフォルダは再帰的に含まれます。</dd></dl></li>
<li><i>open{2}: 現フォルダ中のすべて（オープンのもの）</i>
<dl><dd> プロジェクトのアクティブフォルダにある開いているすべてのページ(非表示ではない)がエクスポートされます。</dd></dl></li>
<li><i>project{3}: プロジェクト中のすべて</i>
<dl><dd> プロジェクト内のすべてのグラフがエクスポートされます。非表示のグラフは含まれますが、埋め込みのページは含まれません。</dd></dl></li>
<li><i>page{4}: 現在のページ</i>
<dl><dd> アクティブなページがエクスポートされます。</dd></dl></li>
<li><i>specified{5} 指定</i>
<dl><dd> 上記以外のオプションです。グラフページでページを指定します。</dd></dl></li></ul>
</td></tr>
<tr>
<td>埋め込みグラフも含める
</td>
<td>embed
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> PowerPointのスライドに埋め込みのグラフをエクスポートするか指定してください。
</td></tr>
<tr>
<td>挿入されるグラフの形式
</td>
<td>insert
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> PowerPointスライドにエクスポートするときのグラフの形式を指定します。
<p>オプションリスト
</p>
<ul><li><i>pic{0}:画像</i>
<dl><dd>PowerPointスライドにグラフをピクチャとしてエクスポートします</dd></dl></li>
<li><i>embed{1}:埋め込みオブジェクト</i>
<dl><dd>PowerPointスライドにグラフを埋め込みオブジェクトとしてエクスポートします</dd></dl></li></ul>
</td></tr>
<tr>
<td>上部余白(%)
</td>
<td>top
</td>
<td>
<p>入力
</p><p>double
</p>
</td>
<td> <center>0</center>
</td>
<td> スライドの上部余白の位置を指定します。
</td></tr>
<tr>
<td>左端余白(%)
</td>
<td>left
</td>
<td>
<p>入力
</p><p>double
</p>
</td>
<td> <center>0</center>
</td>
<td> スライドの左側余白の位置を指定します。
</td></tr>
<tr>
<td>下部余白(%)
</td>
<td>bottom
</td>
<td>
<p>入力
</p><p>double
</p>
</td>
<td> <center>0</center>
</td>
<td> スライドの下部余白の位置を指定します。
</td></tr>
<tr>
<td>右端余白(%)
</td>
<td>right
</td>
<td>
<p>入力
</p><p>double
</p>
</td>
<td> <center>0</center>
</td>
<td> スライドの右側余白の位置を指定します。
</td></tr>
<tr>
<td>縦横比を維持
</td>
<td>keepratio
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> Specify whether to keep aspect ratio.
</td></tr>
<tr>
<td>タイトルライン
</td>
<td>title
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> PowerPointスライドでタイトルがどのように表示されるか指定します。
<p>オプションリスト
</p>
<ul><li><i>none{0}:なし</i>
<dl><dd>タイトルを表示しません。 </dd></dl></li>
<li><i>top{1}:スライドの上部</i>
<dl><dd>タイトルをスクリーンの上部に表示します。</dd></dl></li>
<li><i>bottom{2}:スライドの下部</i>
<dl><dd>タイトルをスクリーンの下部に表示します。 </dd></dl></li></ul>
</td></tr>
<tr>
<td>タイトルモード
</td>
<td>mode
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> <i>title</i> 変数が0にセットされていない場合のみ、この変数を利用できます。各スライドでエクスポートしたグラフの何をタイトルとして使用するか指定します。
<p>オプションリスト
</p>
<ul><li><i>custom{0}:カスタム</i>
<dl><dd>カスタム化した文字列(置換表記も使用可能)をタイトルとして使用します。</dd></dl></li>
<li><i>sname{1}:ウィンドウのショートネーム</i>
<dl><dd>グラフウィンドウのショートネームをタイトルとして使います。</dd></dl></li>
<li><i>lname{2}: ウィンドウのロングネーム</i>
<dl><dd>グラフウィンドウのロングネームをタイトルとして使います。</dd></dl></li>
<li><i>lsname{3}: ウィンドウのショートネームとロングネーム</i>
<dl><dd>グラフウィンドウのショートネームとロングネームをタイトルとして使います。</dd></dl></li>
<li><i>path{4}: ウィンドウのパス</i>
<dl><dd><b>プロジェクトエクスプローラ</b>のファイルパスを各グラフウィンドウのタイトルとして使用します</dd></dl></li></ul>
</td></tr>
<tr>
<td>カスタムタイトル文字列
</td>
<td>custom
</td>
<td>
<p>入力
</p><p>string
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td> <i>mode</i> で<i>custom</i>が選択されている時のみ利用できます。カスタム文字列をスライドのタイトルとして使用します。
</td></tr>
<tr>
<td>スライドインデックスの開始
</td>
<td>slide
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> PowerPointプレゼンテーションファイルで開始するスライドのインデックス番号を指定します。
</td></tr>
<tr>
<td>スライドモード
</td>
<td>slidemode
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> エクスポートしたグラフのスライドモードを指定します。
<p>オプションリスト：
</p>
<ul><li><i>insert{0}: 新たに開始</i>
<dl><dd> エクスポートグラフごとに新しいスライドを開始します。</dd></dl></li>
<li><i>replace{1}: 上書き</i>
<dl><dd> 既存スライドを置き換えます。</dd></dl></li></ul>
</td></tr>
<tr>
<td>元のファイル名（任意）
</td>
<td>srcf
</td>
<td>
<p>入力
</p><p>string
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td> エクスポートしたスライドのPowerPointテンプレート名を指定します。
</td></tr>
<tr>
<td>目的ファイル名（任意）
</td>
<td>dstf
</td>
<td>
<p>入力
</p><p>string
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td> 保存するパスとPowerPoint プレゼンテーションファイル (*.ppt;*.pptx;*.pptm), PowerPoint スライドショー (*.pps;*.ppsx;*.ppsm) あるいはテンプレート (*.pot;*.potx;*.potm)の名前を指定します。スライドはこのファイルにエクスポートされます。
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">説明</span></h2>
<p>このXファンクションは特定のグラフをPowerPointスライドとしてエクスポートできます。それぞれのグラフは、PowerPoint ファイルの1つのスライドとして貼り付けられます。
</p><p>プロジェクト、フォルダ、またはサブフォルダ内のグラフを選択したり、ショートカットでない非表示のグラフをスキップするかどうかを選択するオプションがあります。
</p><p>エクスポートする順番は次の通りです。まず、一番上にあるフォルダ内のグラフがエクスポートされ、それからサブフォルダのグラフがエクスポートされます。サブフォルダが2つ以上ある場合、サブフォルダの順番はアルファベット順に処理されます。同じフォルダ内のグラフは<a class="external text" href="../../UserGuide/UserGuide/Using_Project_Explorer_to_Manage_Your_Windows.html#Changing_the_order_of_the_graphs">スライドインデックス</a>の順序でグラフを表示します。(<b>プロジェクトエクスプローラ</b>の<b>スライド</b>列、これは<b>プロジェクトエクスプローラ</b>でグラフをドラッグ&amp;ドロップして変更できます。)
</p><p><b>Note:</b> PowerPointスライドにグラフをエクスポートするには、Microsoft Officeがインストールされている必要があります。Officeのバージョンが2007の場合、SP2へアップグレードしてください。上記条件を満たしていないと、このXファンクションは上手く動作しません。
</p>
<h2><a name="Examples"></a><span class="mw-headline">サンプル</span></h2>
<p>次の例は、最初の部分では、ユーザインターフェイスとXファンクション<b>pef_pptslide</b>ダイアログボックスを使用します。つぎに、同じ例を完全にスクリプトで実行する方法を示しています。
</p>
<ol><li>プロジェクトファイル<i>&lt;Originインストールフォルダ&gt;\Samples\Graphing\Customizing Graphs.opj</i>を開きます。</li>
<li>プロジェクトエクスプローラでルートフォルダ(<b>Customizing Graphs</b>) を選択します。</li>
<li> <b>ウィンドウ：スクリプトウィンドウ</b>を選択して、以下を入力してEnterキーを押します。<br />
<dl><dd><pre class="lt" style="font-family:monospace;">pef_pptslide <span style="color: #000080;">-</span>d</pre>  </dd></dl></li>
<li><b>pef_pptslide</b>ダイアログで、次の図のように設定を編集します。<b>元のファイル名</b>には、<i>&lt;Origin Installation Directory&gt;\Samples\Import and Export\Column_Plots_in_Sample_OPJ.pptx</i>を参照して追加します。</li>
<li> <b>目的のファイル名</b>には、PPTファイルを出力するのに適当なパスを入力します。
<dl><dd><a  class="image"><img alt="Pef pptslide example 02.png" src="../images/Pef_pptslide/Pef_pptslide_example_02.png" width="434"  /></a></dd></dl></li>
<li><b><b>OK</b></b>ボタンをクリックします。プロジェクト内のグラフが埋め込みオブジェクトとして新しく作成されたPowerPointスライドにエクスポートされます。出力ファイルを参照して開けます。スライド3～5が以下の画像のように表示されるはずです。ヒント: 出力ファイルが見つからない場合は、Originワークスペースの左側にある<b>メッセージログ</b>タブをクリックすると、保存パスを確認できます。
<dl><dd><a  class="image"><img alt="Pef pptslide example 03.png" src="../images/Pef_pptslide/Pef_pptslide_example_03.png" width="826"  /></a></dd></dl></li></ol>
<p><br />
<i><b>スクリプトでの方法</b></i>
</p>
<ol><li> Originを起動し、開いている場合はプロジェクトを閉じ、PowerPointソフトウェアが実行されていないことを確認します。</li>
<li> 以下のスクリプトをスクリプトウィンドウ（<b>ウィンドウ：スクリプトウィンドウ</b>）にコピーし、全体をハイライトしてEnterキーを押して実行します。</li></ol>
<pre class="lt" style="font-family:monospace;">string outname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">%</span>YMyOriginGraphs.<span style="color: #000080;">pptx</span>;
string pptname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> SYSTEM.<span style="color: #000080;">PATH</span>.<span style="color: #000080;">PROGRAM</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Import and Export\Column_Plots_in_Sample_OPJ.pptx&quot;</span>;
string fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> SYSTEM.<span style="color: #000080;">PATH</span>.<span style="color: #000080;">PROGRAM</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Graphing\Customizing Graphs.opj&quot;</span>;
doc <span style="color: #000080;">-</span>o <span style="color: #000080;">%</span><span style="color: #000000;">(</span>fname<span style="color: #000080;">$</span><span style="color: #000000;">)</span>;
pef_pptslide export<span style="color: #000000;">:</span><span style="color: #000080;">=</span>recursive insert<span style="color: #000000;">:</span><span style="color: #000080;">=</span>pic top<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">5</span> left<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">5</span> bottom<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">5</span> right<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">5</span> keepratio<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> title<span style="color: #000000;">:</span><span style="color: #000080;">=</span>bottom mode<span style="color: #000000;">:</span><span style="color: #000080;">=</span>path slide<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span> slidemode<span style="color: #000000;">:</span><span style="color: #000080;">=</span>insert srcf<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;%(pptname$)&quot;</span> dstf<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;%(outname$)&quot;</span>;
type <span style="color: #000080;">-</span>b <span style="color: #ff00ff;">&quot;Your Script Has Completed!&quot;</span>;</pre>
<p>スクリプト実行後、\User Filesフォルダ（<b>ヘルプ：フォルダを開く：ユーザファイルフォルダ</b>）に <i>MyOriginGraphs.pptx</i> という名前のpptxファイルが作成されます。
</p>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">関連 X ファンクション</span></h2>
<p><a href="../../XFunction/X-Function/Pef_slideshow.html" title="X-ファンクション:Pef slideshow">pef_slideshow</a>,<a href="../../XFunction/X-Function/Pemp_pptslide.html" title="Xファンクション:Pemp pptslide">pemp_pptslide</a>, <a href="../../XFunction/X-Function/Pef_slideshow.html" title="X-ファンクション:Pef slideshow">pef_slideshow</a>
</p>
<hr class='keywordshr'><p><span class='keywords'>キーワード:</span><span class='keywordsInput'>出版, エクスポート</span></p>







    