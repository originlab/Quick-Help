<h1 class="firstheading">plotms</h1>
<div id="toc" class="toc">
	<div id="toctitle">
		<h2>目次</h2>
	</div>
	<ol>
		<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span 
		 class="tocnumber">1</span> <span class="toctext">メニュー情報</span></a></li>
		<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span 
		 class="tocnumber">2</span><span class="toctext">概要</span></a></li>
		<li class="toclevel-1 tocsection-3"><a href="#Additional_Information"><span 
		 class="tocnumber">3</span> <span class="toctext">追加の情報</span></a></li>
		<li class="toclevel-1 tocsection-4"><a href="#Command_Line_Usage"><span 
		 class="tocnumber">4</span><span class="toctext">コマンドラインでの使用法</span></a></li>
		<li class="toclevel-1 tocsection-5"><a href="#X-Function_Execution_Options"><span 
		 class="tocnumber">5</span> <span class="toctext">Xファンクションの実行オプション</span></a></li>
		<li class="toclevel-1 tocsection-6"><a href="#Variables"><span 
		 class="tocnumber">6</span> <span class="toctext">変数</span></a></li>
		<li class="toclevel-1 tocsection-7"><a href="#Description"><span 
		 class="tocnumber">7</span> <span class="toctext">説明</span></a></li>
		<li class="toclevel-1 tocsection-8"><a href="#Examples"><span class="tocnumber">8</span> 
		 <span class="toctext">サンプル</span></a></li>
	</ol>
</div>
<h2><a name="Menu_Information"></a><span class="mw-headline">メニュー情報</span></h2>
<p>作図：3D：複合色付き曲面図または複合カラーマップ曲面図 </p>
<h2><a name="Brief_Information"></a><span class="mw-headline">概要</span></h2>
<p>3D曲面プロットを複数の行列オブジェクトから作成します </p>
<h2><a name="Additional_Information"></a><span class="mw-headline">追加の情報</span></h2>
<p><b>必要なOriginのバージョン</b>: 8.5 SR0<br />
グラフを非表示にするオプションはバージョン9.0から利用できます。 </p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">コマンドラインでの使用法</span></h2>
<p>&#160;</p>
<p><code style="font-family: monospace;">plotms ml:=[MBook1]MSheet1! type:=mesh; 
 </code></p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">Xファンクションの実行オプション</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">スクリプトからXファンクションにアクセスする場合、追加のオプションスイッチについてのページを参照してください。</a> 
 </p>
<h2><a name="Variables"></a><span class="mw-headline">変数</span></h2>
<table class="xfvar">
	<tr>
		<th style="width: 8%;">表示<br />
		名 </th>
		<th style="width: 8%;">変数<br />
		名 </th>
		<th style="width: 8%;">I/O<br />
		と<br />
		データ型 </th>
		<th style="width: 8%;">デフォルト<br />
		値 </th>
		<th>説明 </th>
	</tr>
	<tr>
		<td>行列 </td>
		<td>ml </td>
		<td><p>入力 </p>
		<p>MatrixLayer </p></td>
		<td><p style="text-align: center;">&lt;active&gt; </p></td>
		<td>作図する全行列オブジェクトの行列シートを指定します。 </td>
	</tr>
	<tr>
		<td>グラフタイプ </td>
		<td>type </td>
		<td><p>入力 </p>
		<p>int </p></td>
		<td><p style="text-align: center;">mesh </p></td>
		<td>行列シート内の全行列オブジェクトをプロットするグラフタイプを指定します。 
		<p>オプションリスト： </p>
		<ul>
			<li><i>0=mesh:色付き曲面</i> 
			<dl>
				<dd>全行列オブジェクトを色付き曲面図としてプロットします。</dd>
			</dl></li>
			<li><i>1=cmap:カラーマップ曲面</i> 
			<dl>
				<dd>全行列オブジェクトをカラーマップ曲面図としてプロットします。</dd>
			</dl></li>
			<li><i>2=stacksurf:積み上げ曲面</i> 
			<dl>
				<dd>行列オブジェクトを積みげ曲面としてプロットします。</dd>
			</dl></li>
			<li><i>3=stackheat:積み上げ上げヒートマップ</i> 
			<dl>
				<dd>行列オブジェクトを積み上げヒートマップとしてプロットします。</dd>
			</dl></li>
		</ul></td>
	</tr>
	<tr>
		<td>新しく作成したグラフを非表示 </td>
		<td>hide </td>
		<td><p>入力 </p>
		<p>int </p></td>
		<td><p style="text-align: center;">0 </p></td>
		<td>新しく作成したグラフを非表示にするかどうかを指定します。 </td>
	</tr>
</table>
<h2><a name="Description"></a><span class="mw-headline">説明</span></h2>
<p>多くの3Dグラフは行列から作成できます。行列シートに1つ以上の行列オブジェクトがあるとき、これらのオブジェクトは<a class="external text" 
	 href="../../UserGuide/UserGuide/Multiple_Color_Fill_Surfaces.html">1つのレイヤに複数曲面を交差させてプロット</a>できます。 
 </p>
<p>このXファンクションは、指定した行列シート内のすべての行列オブジェクトをプロットします。4つのグラフタイプ（色塗り曲面、カラーマップ曲面、積み上げ曲面、積み上げヒートマップ）から選択できます。 
 </p>
<h2><a name="Examples"></a><span class="mw-headline">サンプル</span></h2>
<p>次のサンプルは、行列シートに生成した行列オブジェクトの色塗り曲面をプロットする方法を示しています。グリッド線を非表示にし、透過率を50%にしています。 
 </p>
<ol>
	<li>新しいプロジェクトを作成し、スクリプトウィンドウで次のLabTalkスクリプトを実行して行列オブジェクトを生成します。</li>
	<pre class="lt" style="font-family: monospace;">
newbook mat<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
int nmats <span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span>;
range msheet<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span>;
msheet.<span style="color: #000080;">Nmats</span> <span style="color: #000080;">=</span> nmats;
matrix <span style="color: #000080;">-</span>v x<span style="color: #000080;">+</span>y;<span style="color: #008000;">// 最初のものは別の方法で埋める</span>
range mm<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;mm.<span style="color: #000080;">label</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;x+y&quot;</span>;
double ff<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;
loop<span style="color: #000000;">(</span>i, <span style="color: #0000dd;">2</span>, nmats<span style="color: #000080;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span> <span style="color: #000000;">{</span>
	msheet.<span style="color: #000080;">active</span> <span style="color: #000080;">=</span> i;
	ff <span style="color: #000080;">=</span> <span style="color: #000000;">(</span>i<span style="color: #000080;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span><span style="color: #000080;">/</span><span style="color: #000000;">(</span>nmats<span style="color: #000080;">-</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span>;
	matrix <span style="color: #000080;">-</span>v <span style="color: #000000;">(</span><span style="color: #0000dd;">5</span><span style="color: #000080;">/</span>ff<span style="color: #000000;">)</span><span style="color: #000080;">*</span>sin<span style="color: #000000;">(</span>x<span style="color: #000000;">)</span> <span style="color: #000080;">+</span> ff<span style="color: #000080;">*</span><span style="color: #0000dd;">20</span><span style="color: #000080;">*</span>cos<span style="color: #000000;">(</span>y<span style="color: #000000;">)</span>;
	<span style="color: #008000;">//ロングネームを設定</span>
	range aa<span style="color: #000080;">=</span><span style="color: #000080;">$</span><span style="color: #000000;">(</span>i<span style="color: #000000;">)</span>;
	aa.<span style="color: #000080;">label</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;$(5/ff,*3)*sin(x) + $(ff*20)*cos(y)&quot;</span>;<span style="color: #000000;">
}</span><span style="color: #008000;">
//最後の1つをランダムに埋める</span>
msheet.<span style="color: #000080;">active</span> <span style="color: #000080;">=</span> nmats;
matrix <span style="color: #000080;">-</span>v rnd<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
range mm<span style="color: #000080;">=</span><span style="color: #000080;">$</span><span style="color: #000000;">(</span>nmats<span style="color: #000000;">)</span>;mm.<span style="color: #000080;">label</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;random&quot;</span>;
matrix <span style="color: #000080;">-</span>it;<span style="color: #008000;">//サムネイルを表示</span>
	</pre>
	<p>10個の行列オブジェクトが作成されます。 </p>
	<p><a class="image"><img alt="Plot ms example data.png" src="../images/Plotms/Plot_ms_example_data.png" 
							 width="321" border="0" /></a> </p>
	<li>作成した行列ブックをアクティブにし、コマンド<code>plotms -d</code>をスクリプトウィンドウで実行して、<b>plotms</b>ダイアログを開きます。<b>グラフタイプ</b>は<i>色塗り曲面図</i>にします。</li>
	<p><a class="image"><img alt="Plot ms example dialog.png" src="../images/Plotms/Plot_ms_example_dialog.png" 
							 width="284" border="0" /></a> </p>
	<li><b>OK</b>ボタンをクリックして、色塗り曲面図を作成します。</li>
	<p><a class="image"><img alt="Plot ms example result 1.png" src="../images/Plotms/Plot_ms_example_result_1.png" 
							 width="456" border="0" /></a> </p>
	<li>曲面図をダブルクリックして、<b>作図の詳細</b>ダイアログを開きます。ダイアログの左側のパネルから最初の曲面図を選択し、右側のパネルで<b>メッシュ</b>タブを開きます。<b>有効にする</b>のチェックを外して、面タブの<b>透過率</b>を50%に変更します。 
	 </li>
	<p><a class="image"><img alt="Plot ms example plot details.png" src="../images/Plotms/Plot_ms_example_plot_details.png" 
							 width="333" border="0" /></a> </p>
	<li>左パネルでほかの曲面を選択して、同じ操作で1つずつ編集します。<b>OK</b>ボタンをクリックして<b>作図の詳細</b>ダイアログを閉じ、編集完了です。</li>
	<p><a class="image"><img alt="Plot ms example result 2.png" src="../images/Plotms/Plot_ms_example_result_2.png" 
							 width="456" border="0" /></a> </p>
</ol>
