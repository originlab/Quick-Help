<h1 class="firstheading">smooth</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">メニュー情報</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span class="tocnumber">2</span><span class="toctext">概要</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Additional_Information"><span class="tocnumber">3</span> <span class="toctext">追加の情報</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Command_Line_Usage"><span class="tocnumber">4</span><span class="toctext">コマンドラインでの使用法</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#X-Function_Execution_Options"><span class="tocnumber">5</span> <span class="toctext">Xファンクションの実行オプション</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Variables"><span class="tocnumber">6</span> <span class="toctext">変数</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Examples"><span class="tocnumber">7</span> <span class="toctext">サンプル</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#More_Information"><span class="tocnumber">8</span> <span class="toctext">詳細な情報</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Related_X-Functions"><span class="tocnumber">9</span><span class="toctext">関連するXファンクション</span></a></li>
</ul>
</div>

<h2><a name="Menu_Information"></a><span class="mw-headline">メニュー情報</span></h2>
<p>解析：信号処理：スムージング
</p>
<h2><a name="Brief_Information"></a><span class="mw-headline">概要</span></h2>
<p>XYデータでスムージングを実行してノイズや不揃いを除去します
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">追加の情報</span></h2>
<p>この機能は9.1 SR1で更新されています。スムージング手法としてLowess および Loessオプションを使用できます。
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">コマンドラインでの使用法</span></h2>
<p><code>
1. smooth //Perform default smoothing to active data plot or highlighted 1st column in worksheet. smooth&nbsp;%C also works so
</p><p>2. smooth (1,2) //デフォルト設定を使用して、アクティブワークシートの列1、2のXYデータに対してデフォルトのSavitzky-Golayフィルタリングを実行
</p><p>3. smooth iy:=Col(2) boundary:=periodic; //境界条件を周期的に設定し、アクティブワークシートの2列目のYデータに対してデフォルトのSavitzky-Golayフィルタリングを実行
</p><p>4. smooth iy:=Col(2) polyorder:=3; //アクティブワークシートの2列目のYデータに対して、多項式次数を2に設定してデフォルトのSavitzky-Golayフィルタリングを実行
</p><p>5. smooth iy:=Col(2) method:=pf percent:=70; //パーセンタイルフィルタリングを使用してスムージングを実行。パーセンタイルは70に設定し、アクティブワークシートの2 列目のYデータに対して実行
</p><p>6. smooth -t &quot;my short noise removal theme.oth&quot; //スムージングダイアログで保存した事前保存テーマファイルを使用してアクティブプロットまたは選択列に対してスムージングを実行
</p><p>7. smooth -d //スムージングダイアログを開く
</code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">Xファンクションの実行オプション</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">スクリプトからXファンクションにアクセスする場合、追加のオプションスイッチについてのページを参照してください。</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">変数</span></h2>
<table class="xfvar">
<tr>
<th width="8%">表示<br />名
</th>
<th width="8%">変数<br />名
</th>
<th width="8%">I/O<br />と<br />データ型
</th>
<th width="8%">デフォルト<br />値
</th>
<th>説明
</th></tr>
<tr>
<td>入力
</td>
<td>iy
</td>
<td>
<p>入力
</p><p>XYRange
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td>
<p>スムージングを行いたいXYデータの範囲を指定します。
</p>
</td></tr>
<tr>
<td>手法
</td>
<td>method
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>sg</center>
</td>
<td>
<p>使用するスムージングの手法を指定します。デフォルトはSavitzky-Golayです。
</p><p>オプションリスト：
</p>
<ul><li><i>Aav: 隣接平均法</i> (0)
<dl><dd>この手法はデータの各ポイントの前後で指定したデータポイント数の平均を取り、そのポイントを計算した平均値で置き換えます。</dd></dl></li>
<li><i>sg: Savitzky-Golay</i> (1, デフォルト)
<dl><dd>この手法は、局所的な多項式回帰を実行します。信号データ全体の形状に影響を与えずにノイズを除去する場合に適しています。元のデータ値はフィットした値で置き換えられます。</dd></dl></li>
<li><i>Pf: パーセンタイルフィルタ</i> (2) 
<dl><dd>ランクオーダフィルタとして知られています。この手法はデータの各ポイントの前後でデータポイントの指定したパーセンタイルを見つけ、そのポイントをパーセンタイルで置き換えます。ショットノイズを除去する場合に適しています。</dd></dl></li>
<li><i>fft:FFTフィルタ</i> (3)
<dl><dd>この手法はFFTローパスフィルタが基になっています。これはノイズの周波数が真の信号より高い場合に使用します。実際には、双曲線ウィンドウで高周波成分を除去します。カットオフ周波数より大きい周波数は無視されます。 </dd></dl></li>
<li><i>lw:Lowess</i> (4)</li>
<li><i>le:Loess</i> (5)
<dl><dd>これら2つのオプションは「locally weighted scatter plot smoothing」(局所的に重み付けされた散布図平滑化) を示します。これらの手法は非常に多くのデータポイントがある場合に適しています。詳細は<a class="external text" href="../../UserGuide/UserGuide/Algorithm_(Smooth).html#The_Lowess_and_Loess_method">アルゴリズムページ</a>をご覧ください。</dd></dl></li>
<li><i>bm:二項</i> (6)
<dl><dd>二項フィルタは、重み付け移動平均フィルタで、その重みは二項係数から導かれます。これは、高周波ノイズを取り除くローパスフィルタです。 </dd></dl></li></ul>
</td></tr>
<tr>
<td>加重平均
</td>
<td>weight
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>手法で隣接平均法をを選択した場合に利用できるパラメータです。このパラメータが1にセットする（チェックを付ける）と加重平均が使われます。
</p>
</td></tr>
<tr>
<td>範囲指定方法
</td>
<td>prop
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> この変数は、手法がLowessまたはLoessの場合に利用できます。
<p>オプションリスト：
</p>
<ul><li><i>0=pts: ウィンドウのポイント数</i>
<dl><dd>範囲としてウィンドウのポイントを使用</dd></dl></li>
<li><i>1=prop: 比率</i>
<dl><dd> 範囲として比率 (0-1)を使用</dd></dl></li>
<li><i>2=x: X値</i>
<dl><dd>範囲としてX値を使用</dd></dl></li></ul>
</td></tr>
<tr>
<td>X値
</td>
<td>xval
</td>
<td>
<p>入力
</p><p>double
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p><b>範囲指定法</b>で<b>X値</b>を選択したとき、X値を指定します。デフォルトで<b>X値</b> は0.1*(x max-x min)です。
</p>
</td></tr>
<tr>
<td>範囲 (0-1)
</td>
<td>span
</td>
<td>
<p>入力
</p><p>double
</p>
</td>
<td> <center>0.1</center>
</td>
<td>
<p>これは、<b>範囲指定方法</b>で<b>比率</b>を選択したときのみ利用できます( prop = 1)。範囲の比率値を指定します。値が大きいほど曲線はなめらかになります。
</p>
</td></tr>
<tr>
<td>ウィンドウ内のポイント数
</td>
<td>npts
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>5</center>
</td>
<td>
<p>手法で、FFTフィルタが選択されていない場合、このパラメータで移動ウィンドウのポイント数を指定します。それ以外の場合、このパラメータを使ってFFTフィルタのカットオフ周波数を制御することができます。この値が大きくなると、スムージングの次数が大きくなります。値は0ではなく、正の数である必要があります。カットオフ周波数の計算については、アルゴリズムを参照して下さい。
</p>
</td></tr>
<tr>
<td>境界条件
</td>
<td>boundary
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>none</center>
</td>
<td>
<p>境界条件を指定します。手法でFFTフィルタ/Lowess/Loessが選択されている場合は利用できません。
</p><p>オプションリスト
</p>
<ul><li><i>none:なし</i>
<dl><dd>付加なし</dd></dl></li>
<li><i>reflect:反射</i>
<dl><dd>信号データを両端で反射させてデータを付加します。</dd></dl></li>
<li><i>repeat:繰り返し</i>
<dl><dd>信号データの最後のポイントを繰り返してデータを付加します。</dd></dl></li>
<li><i>periodic:周期的</i>
<dl><dd>データを周期的な信号として扱います。</dd></dl></li>
<li><i>extrap:補外</i>
<dl><dd>線形補外法を使ってデータの両端に信号を付加します。</dd></dl></li></ul>
</td></tr>
<tr>
<td>多項式次数
</td>
<td>polyorder
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>2</center>
</td>
<td>
<p>Savitzky-Golayスムージングオプションの場合に利用できます。多項式次数を指定します。
</p>
</td></tr>
<tr>
<td>パーセンタイル
</td>
<td>percent
</td>
<td>
<p>入力
</p><p>double
</p>
</td>
<td> <center>50</center>
</td>
<td>
<p>パーセンタイルフィルタで使用するパーセンタイル値を決めます。デフォルトは50%です。これはデータウィンドウ内のデータポイントの中央値を持つ信号を置き換えます。
</p>
</td></tr>
<tr>
<td>カットオフ周波数
</td>
<td>cutoff
</td>
<td>
<p>入力
</p><p>double
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>このパラメータは、手法が FFTフィルタの場合に GUIに表示されます。これは、ウィンドウのポイントから計算されたローパスフィルタのカットオフ周波数を示す読み取り専用の変数です。スクリプトでは使用しないでください。
</p>
</td></tr>
<tr>
<td>2のべき乗ポイントへの付加
</td>
<td>pad
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>このパラメータは、手法が FFTフィルタの場合に利用できます。スクリプトからのみ利用可能です。データポイントの数を2のべき乗で付加するかどうか指定します。1に設定すると、Origin8より前のバージョンで計算した値と同じになります。詳細は、アルゴリズムセクションを参照して下さい。
</p>
</td></tr>
<tr>
<td>フィルタの種類
</td>
<td>filter
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>new</center>
</td>
<td>
<p>このパラメータは、手法が FFTフィルタの場合に利用できます。スクリプトからのみ利用可能です。フィルタの種類を指定します。<i>old</i>に設定すると、Origin8より前のバージョンで計算した値と同じになります。
</p><p>オプションリスト：
</p>
<ul><li><i>new:ローパスパラボリック</i></li></ul>
<dl><dd>ローパスパラボリックフィルタ </dd></dl>
<ul><li><i>old:ローパスパラボリック(7.5)</i></li></ul>
<dl><dd>Origin 7.5で使用されているローパスパラボリックフィルタ</dd></dl>
</td></tr>
<tr>
<td>基線の減算
</td>
<td>baseline
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>two_ends_1</center>
</td>
<td>
<p>このパラメータは、手法が FFTフィルタの場合に利用できます。スクリプトからのみ利用可能です。FFTフィルタリングを使用する前に基線を減算するかどうか指定します。
オプションリスト：
</p>
<ul><li><i>two_ends:終点から得られた直線</i></li></ul>
<dl><dd>FFTフィルタを適用する前に2つの終点からなる直線の値を入力データから減算します。</dd></dl>
<ul><li><i>two_ends_1:終点の1％の平均から得られた直線</i></li></ul>
<dl><dd>FFTフィルタを適用する前に終点の1％の平均からなる直線の値を入力データから減算します。</dd></dl>
<ul><li><i>none:なし</i></li></ul>
<dl><dd>FFTフィルタリング適用前に入力データから減算は行われません。</dd></dl>
</td></tr>
<tr>
<td>出力
</td>
<td>oy
</td>
<td>
<p>出力
</p><p>XYRange
</p>
</td>
<td> <center>&lt;新規&gt;</center>
</td>
<td>
<p>スムージングした信号データの出力先を指定します。
</p><p><a href="../../XFunction/X-Function/Output_Notations.html" title="Xファンクション:Output Notations">このシンタックス</a>を参照してください。
</p>
</td></tr></table>
<h2><a name="Examples"></a><span class="mw-headline">サンプル</span></h2>
<p>gaussian.datをOriginにインポートする方法を示すサンプルです。<br />
<a href="../../XFunction/X-Function/White_noise.html" title="Xファンクション:White noise">white_noise</a> Xファンクションでホワイトノイズを追加します。<br />
Xファンクション<a href="../../XFunction/X-Function/Plotxy.html" title="Xファンクション:Plotxy">plotxy</a>を使ってノイズデータをプロットします。<br />
データをスムージングして、スムージングデータを新しいグラフにプロットします。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 新規ブックにデータをロード</span>
fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;\Samples\Curve Fitting\Gaussian.dat&quot;</span>;
newbook;
impASC;
string bkn<span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #000080;">%</span>H;
<span style="color: #008000;">// データにノイズを追加</span>
white_noise <span style="color: #000000;">[</span>bkn<span style="color: #000080;">$</span><span style="color: #000000;">]</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #000000;">(</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span> level<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">10</span>;
<span style="color: #008000;">// ノイズデータをプロット</span>
plotxy <span style="color: #000000;">[</span>bkn<span style="color: #000080;">$</span><span style="color: #000000;">]</span><span style="color: #000080;">!</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">)</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">200</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span><span style="color: #000080;">&lt;</span>new<span style="color: #000080;">&gt;</span><span style="color: #000000;">]</span><span style="color: #000080;">&lt;</span>new<span style="color: #000080;">&gt;</span>;

<span style="color: #008000;">// ノイズデータをスムージング</span>
newsheet book<span style="color: #000000;">:</span><span style="color: #000080;">=</span>bkn<span style="color: #000080;">$</span> name<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Smoothed Data&quot;</span>;
copydata <span style="color: #000000;">[</span>bkn<span style="color: #000080;">$</span><span style="color: #000000;">]</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span> <span style="color: #000000;">[</span>bkn<span style="color: #000080;">$</span><span style="color: #000000;">]</span><span style="color: #ff00ff;">&quot;Smoothed Data&quot;</span><span style="color: #000080;">!</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>;
smooth iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span>bkn<span style="color: #000080;">$</span><span style="color: #000000;">]</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #000000;">(</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span> oy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span>bkn<span style="color: #000080;">$</span><span style="color: #000000;">]</span><span style="color: #ff00ff;">&quot;Smoothed Data&quot;</span><span style="color: #000080;">!</span><span style="color: #000000;">(</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span> npts<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">10</span>;

<span style="color: #008000;">// スムージングデータをプロット</span>
plotxy <span style="color: #000000;">[</span>bkn<span style="color: #000080;">$</span><span style="color: #000000;">]</span><span style="color: #ff00ff;">&quot;Smoothed Data&quot;</span><span style="color: #000080;">!</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">)</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">200</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span><span style="color: #000080;">&lt;</span>new<span style="color: #000080;">&gt;</span><span style="color: #000000;">]</span><span style="color: #000080;">&lt;</span>new<span style="color: #000080;">&gt;</span>;</pre>
<h2><a name="More_Information"></a><span class="mw-headline">詳細な情報</span></h2>
<p>詳細は、ユーザガイドをご覧下さい。
</p>
<dl><dd><ul><li><a class="external text" href="../../UserGuide/Category/Smoothing.html">説明</a></li>
<li><a class="external text" href="../../UserGuide/UserGuide/Algorithm_(Smooth).html">アルゴリズム</a></li>
<li><a class="external text" href="../../UserGuide/UserGuide/Reference_(Smooth).html">参考文献</a></li></ul></dd></dl>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">関連するXファンクション</span></h2>
<p><a href="../../XFunction/X-Function/Fft1.html" title="Xファンクション:Fft1">fft1</a>, <a href="../../XFunction/X-Function/Fft_filters.html" title="Xファンクション:Fft filters">fft_filters</a>, <a href="../../XFunction/X-Function/Wtsmooth.html" title="Xファンクション:Wtsmooth">wtsmooth</a>
</p>
<hr class='keywordshr'><p><span class='keywords'>キーワード:</span><span class='keywordsInput'>隣接平均法, savitzky golay, fftフィルタ, lowess, loess, 2項, パーセンタイル</span></p>







    