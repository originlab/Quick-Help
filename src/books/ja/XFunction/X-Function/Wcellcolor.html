<h1 class="firstheading">wcellcolor</h1><div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Brief_Information"><span class="tocnumber">1</span> <span class="toctext">概要</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Command_Line_Usage"><span class="tocnumber">2</span> <span class="toctext">コマンドラインでの使用法</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#X-Function_Execution_Options"><span class="tocnumber">3</span> <span class="toctext">Xファンクションの実行オプション</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Variables"><span class="tocnumber">4</span> <span class="toctext">変数</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Description"><span class="tocnumber">5</span> <span class="toctext">説明</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Examples"><span class="tocnumber">6</span> <span class="toctext">サンプル</span></a></li>
</ul>
</div>

<h2><a name="Brief_Information"></a><span class="mw-headline">概要</span></h2>
<p>ワークシートセルの色を塗りつぶすかフォントの色にセット
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">コマンドラインでの使用法</span></h2>
<pre>
1. wcellcolor 1[1]:2[3] color(red); //アクティブシートのcol(1) row(1)からcol(2) row(3)を赤に
2. wcellcolor 2 color(blue); // col(2)全体を青に
3. wcellcolor 3 color(red) type:=font; // col(3)全体のフォント色を赤に
4. wcellcolor i:=[Book1]Sheet1!col(B)[2] c:=color(127,255,127); //RGB指定で設定
</pre>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">Xファンクションの実行オプション</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">スクリプトからXファンクションにアクセスする場合、追加のオプションスイッチについてのページを参照してください。</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">変数</span></h2>
<table class="xfvar">
<tr>
<th width="8%">表示<br />名
</th>
<th width="8%">変数<br />名
</th>
<th width="8%">I/O<br />と<br />データ型
</th>
<th width="8%">デフォルト<br />値
</th>
<th>説明
</th></tr>
<tr>
<td>入力
</td>
<td>irng
</td>
<td>
<p>入力
</p><p>Range
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> 塗りつぶすセル範囲を指定します。
</td></tr>
<tr>
<td>色
</td>
<td>color
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> 色を指定します。0(黒)からのカラーインデックスです。スタイルツールバーの塗りつぶしの色ドロップダウンリストから色を選択することもできます。
</td></tr>
<tr>
<td>種類
</td>
<td>type
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>fill</center>
</td>
<td> 選択したセルの色を塗りつぶしの色にセットするか、選択したフォントの色をフォントの色にセットします。
<p>オプションリスト：
</p>
<ul><li><i>fill:埋め色</i></li></ul>
<dl><dd>セルを塗りつぶす色</dd></dl>
<ul><li><i>font:フォントカラー</i></li></ul>
<dl><dd>選択したフォントカラーに変更</dd></dl>
</td></tr>
<tr>
<td>元に戻す
</td>
<td>undo
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Origin 2024bで廃止されました。代わりにXFスイッチ「-u」を使用してください。
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">説明</span></h2>
<p>この関数は、セルの色をセットして色で塗りつぶすか、選択した文字フォントをフォントの色にセットするのに使われます。
</p>
<h2><a name="Examples"></a><span class="mw-headline">サンプル</span></h2>
<ul><li> サンプル-1</li></ul>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// いくつかの列にランダムデータを持つ新しいブックを作成</span>
newbook;
newsheet cols<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">6</span> xy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Y&quot;</span>;
loop<span style="color: #000000;">(</span>i,<span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">6</span><span style="color: #000000;">)</span><span style="color: #000000;">{</span>wcol<span style="color: #000000;">(</span>i<span style="color: #000000;">)</span><span style="color: #000080;">=</span>normal<span style="color: #000000;">(</span><span style="color: #0000dd;">100</span><span style="color: #000000;">)</span><span style="color: #000000;">}</span>;
<span style="color: #008000;">// 0.5以上の値を持つ全てのセルを選択し、色付け</span>
wcellsel <span style="color: #0000dd;">1</span><span style="color: #000000;">:</span>end c<span style="color: #000000;">:</span><span style="color: #000080;">=</span>ge v<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0.5</span>;
wcellcolor c<span style="color: #000000;">:</span><span style="color: #000080;">=</span>color<span style="color: #000000;">(</span>green<span style="color: #000000;">)</span>;
wcellcolor c<span style="color: #000000;">:</span><span style="color: #000080;">=</span>color<span style="color: #000000;">(</span>red<span style="color: #000000;">)</span> type<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
wcellsel; <span style="color: #008000;">// セルの選択を解除して色を表示</span></pre>
<ul><li> サンプル-2</li></ul>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000; font-style: regular;">/*
この例では、スクリプトによって線形回帰を実行し、外れ値を検出し、これらのセルにラベルを付ける方法
サンプルデータ：exe_path\Samples\Curve Fitting\Outlier.dat
1.データをロードします。
2.xop メカニズムによる線形回帰を実行
3.標準化残差によって外れ値を特定
4.未加工のワークシートの外れ値のセルの色を赤に設定
*/</span>
<span style="color: #008000;">// サンプルデータをインポート</span>
fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Curve Fitting\Outlier.dat&quot;</span>;
newbook;
impASC;
<span style="color: #008000;">// xopによる線形回帰実行</span>
xop e<span style="color: #000000;">:</span><span style="color: #000080;">=</span>init c<span style="color: #000000;">:</span><span style="color: #000080;">=</span>FitLinear i<span style="color: #000000;">:</span><span style="color: #000080;">=</span>lrGUI;
lrGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Range1</span>.<span style="color: #000080;">X</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>Col<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span>;
lrGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Range1</span>.<span style="color: #000080;">Y</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>Col<span style="color: #000000;">(</span>B<span style="color: #000000;">)</span>;
<span style="color: #008000;">// 標準化残差データを出力</span>
lrGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">ResAnalysis</span>.<span style="color: #000080;">Stad</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
<span style="color: #008000;">// 準備された GUI ツリーを使用して線形フィットレポートを生成</span>
type <span style="color: #000080;">-</span>mb <span style="color: #0000dd;">0</span>;
xop e<span style="color: #000000;">:</span><span style="color: #000080;">=</span>report i<span style="color: #000000;">:</span><span style="color: #000080;">=</span>lrGUI; 
type <span style="color: #000080;">-</span>mb <span style="color: #000080;">-</span><span style="color: #0000dd;">1</span>;
<span style="color: #008000;">//フィット後に操作オブジェクトをクリーンアップ</span>
xop e<span style="color: #000000;">:</span><span style="color: #000080;">=</span>cleanup;
<span style="color: #008000;">// 出力レポートツリーを取得</span>
getresults tr Fitlinear1<span style="color: #000080;">!</span>;
range residual <span style="color: #000080;">=</span> FitLinearCurve1<span style="color: #000080;">!</span>col<span style="color: #000000;">(</span><span style="color: #0000dd;">5</span><span style="color: #000000;">)</span>;
range rawdata <span style="color: #000080;">=</span> Outlier<span style="color: #000080;">!</span>Col<span style="color: #000000;">(</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span>;

<span style="color: #008000;">// 残差 &gt; 2.5*sigmaの場合生データのセルの色を赤に設定</span>
for<span style="color: #000000;">(</span>ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; ii <span style="color: #000080;">&lt;=</span> tr.<span style="color: #000080;">RegStats</span>.<span style="color: #000080;">C1</span>.<span style="color: #000080;">N</span>; ii<span style="color: #000080;">++</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
	if<span style="color: #000000;">(</span> abs<span style="color: #000000;">(</span>residual<span style="color: #000000;">[</span>ii<span style="color: #000000;">]</span><span style="color: #000000;">)</span> <span style="color: #000080;">&gt;</span> <span style="color: #0000dd;">2.5</span><span style="color: #000000;">)</span> 
	<span style="color: #000000;">{</span>
		wcellcolor rawdata<span style="color: #000000;">[</span>ii<span style="color: #000000;">]</span> color<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>; 
	<span style="color: #000000;">}</span>
<span style="color: #000000;">}</span>

<span style="color: #008000;">// ソースワークシートをアクティブにする</span>
page.<span style="color: #000080;">active</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;</pre>







    