<h1 class="firstheading">wjoincols</h1><div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">メニュー情報</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">概要</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Additional_Information"><span class="tocnumber">3</span> <span class="toctext">追加の情報</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Command_Line_Usage"><span class="tocnumber">4</span><span class="toctext">コマンドラインでの使用法</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Variables"><span class="tocnumber">5</span> <span class="toctext">変数</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Description"><span class="tocnumber">6</span> <span class="toctext">説明</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#Details_of_Settings_TreeNode"><span class="tocnumber">6.1</span> <span class="toctext">ツリーノード設定の詳細</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Samples_of_SQL_query"><span class="tocnumber">6.2</span> <span class="toctext">SQLクエリのサンプル</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-9"><a href="#Related_X-Functions"><span class="tocnumber">7</span> <span class="toctext">関連するXファンクション</span></a></li>
</ul>
</div>

<h2><a name="Menu_Information"></a><span class="mw-headline">メニュー情報</span></h2>
<p>データ整形：列で2つのワークシートを結合する
</p>
<h2><a name="Brief_Information"></a><span class="mw-headline">概要</span></h2>
<p>複数ワークシートを一致する列で結合
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">追加の情報</span></h2>
<p>必要なOriginのバージョン: Origin 2022以降
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">コマンドラインでの使用法</span></h2>
<p><code>

1. wjoincols irng:=([Book3]Sheet1,[Book1]Sheet1) settings.cols:=&quot;&lt;All&gt;||A|B&quot; settings.unmatch:=&quot;0|1&quot; settings.multiple:=&quot;0|1&quot; settings.conditions:=&quot;w1.A=w2.A&quot; settings.sort:=3 settings.sortsheet:=1 settings.sortcol:=&quot;w1.A&quot;;

</p><p>
2. wjoincols -r 2 irng:=([Book2]Data2,[Book1]Data1) settings.cols:=&quot;ID1|ID2||ID1|ID10&quot; settings.conditions:=&quot;w1.ID1=w2.ID1&quot; settings.unmatch:=&quot;1|1&quot; settings.multiple:=&quot;1|1&quot; settings.mergeby:=5 settings.merge:=0;

</p><p>
3. wjoincols irng:=([Book2]Sheet1,[Book1]Sheet1) settings.cols:=&quot;&lt;All&gt;||&lt;All&gt;&quot; settings.conditions:=&quot;w1.A=w2.A|w1.B=w2.B&quot; settings.unmatch:=&quot;0|1&quot; settings.multiple:=&quot;0|1&quot; settings.sortsheet:=1;

</p><p>4. wjoincols irng:=([Book2]Sheet1,[Book1]Sheet1) query:=&quot;w1 left join w2 on w1.A=w2.A&quot;;
</p><p>5. wjoincols -r 2 irng:=([Book1]Sheet1,[Book2]Sheet1) query:=&quot;w1 inner join w2 on w1.A=w2.A and w1.B=w2.B order by match asc merge multiples by first row&quot;;
</code>
</p>
<h2><a name="Variables"></a><span class="mw-headline">変数</span></h2>
<table class="xfvar">
<tr>
<th width="8%">表示<br />名
</th>
<th width="8%">変数<br />名
</th>
<th width="8%">I/O<br />と<br />データ型
</th>
<th width="8%">デフォルト<br />値
</th>
<th>説明
</th></tr>
<tr>
<td>入力
</td>
<td>irng
</td>
<td>
<p>入力
</p><p>Range
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> 入力ワークシートデータ範囲を指定
<p>シンタックス: <b>([<i>BookName1</i>]<i>SheetName1</i>!, [<i>BookName2</i>]<i>SheetName2</i>!)</b>.
</p>
</td></tr>
<tr>
<td>設定
</td>
<td>settings
</td>
<td>
<p>入力
</p><p>TreeNode
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td> ツリーノードを制御します。詳細は<a href="#Details_of_Settings_TreeNode">ツリーノード設定の詳細</a>をご覧ください。
</td></tr>
<tr>
<td>
</td>
<td>query
</td>
<td>
<p>入力
</p><p>string
</p>
</td>
<td> <center></center>
</td>
<td> たとえば、SQL言語での一致条件、複数の一致セル、不一致値などのような組み合わせオプションを指定します。詳細は<a href="#Samples_of_SQL_query">SQLクエリのサンプルセクション</a>をご覧ください。
</td></tr>
<tr>
<td>出力ワークシート
</td>
<td>ow
</td>
<td>
<p>出力
</p><p>Worksheet
</p>
</td>
<td> <center>&lt;new&gt;</center>
</td>
<td> 出力範囲を指定します。シンタックスは<a href="../../XFunction/X-Function/Output_Notations.html" title="Xファンクション:Output Notations">こちら</a>です。
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">説明</span></h2>
<p>このXファンクションは2つのワークシートを1つに結合するために使用します。結合はそれぞれの入力されるワークシートにある列を照合することで決定されます。特別なケースでの値の扱いを設定するオプションがあります。例えば、一致列が複数ある場合、一致する値がない場合、欠損値がある場合などです。このツールの機能の詳細については、<a class="external text" href="../../UserGuide/UserGuide/Join_Worksheets_by_Column.html">このツールに関するOriginのヘルプページ</a>を参照してください。
</p><p>LabTalkスクリプトを経由して実行する場合、このXファンクションも一致条件と結合オプションを指定するためのSQL言語の使用をサポートしています。
</p>
<h3><a name="Details_of_Settings_TreeNode"></a><span class="mw-headline">ツリーノード設定の詳細</span></h3>
<p><b>設定</b>ツリーはXファンクション<b><b>addtool_rise_time</b></b>のすべての設定オプションを指定します。 
</p><p>シンタックス: <b>settings.<i>Treenode:=&lt;value&gt;</i></b>
</p><p>例: <b>settings.sort = 2</b> 
</p>
<table class="treetable">
<tr>
<th> ツリーノード
</th>
<th> ラベル
</th>
<th> データ型
</th>
<th> デフォルト
</th>
<th> 説明
</th></tr>
<tr>
<td>cols
</td>
<td>
</td>
<td>入力 string
</td>
<td>
</td>
<td>結合する列を指定します。シートは&rdquo;||&rdquo;で区切られ、同じシートにある列は&rdquo;|&rdquo;で区切られます。例えば、 <pre class="lt" style="font-family:monospace;">settings.<span style="color: #000080;">cols</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;&lt;All&gt;||w2-A|w2-B&quot;</span></pre> これは最初のシートのすべての列と、LongNameが「w2-A」および「w2-B」の2つの列が選択されていることを意味します。
<p><a  class="image"><img alt="Wjoincols settings cols.png" src="../images/Wjoincols/Wjoincols_settings_cols.png" width="345"  /></a>
</p>
</td></tr>
<tr>
<td>unmatch
</td>
<td>非一致を削除
</td>
<td>入力 string
</td>
<td>
</td>
<td>一致しない値を削除するかどうかを指定します。 w1とw2はそれぞれ制御され、&rdquo;|&rdquo;で区切られます。（例：<code>0|1</code>）
<ul><li>0 = 削除せず、欠損値で埋める</li>
<li>1 = 一致しない値を削除</li></ul>
</td></tr>
<tr>
<td>multiple
</td>
<td>重複を削除
</td>
<td>入力 string
</td>
<td>
</td>
<td>1つの値に一致するセルが複数ある場合、このコントロールを使用して、<b>mergeby</b>で指定された統計値で重複行をマージし、複製を削除するかどうかを指定します。  w1とw2はそれぞれ制御され、&rdquo;|&rdquo;で区切られます。（例：<code>0|1</code>）
<p>0 = 削除しない, 1 = 削除
</p>
</td></tr>
<tr>
<td>conditions
</td>
<td>一致する列
</td>
<td>入力 string
</td>
<td>
</td>
<td>ワークシートを結合するために、一致する列条件を指定します。一致する列の全ての値は比較され、一致した行は結果ワークシートで同じ行として結合されます。
<p>完全なシンタックス: <br /><b>w1.<i>ColumnLongName/ShortName1</i> = w2.<i>ColumnLongName/ShortName2</i></b> <br />例えば、 <code>w1.A=w2.A</code>
</p>
</td></tr>
<tr>
<td>mergeby
</td>
<td>複数を統合
</td>
<td>入力 int
</td>
<td>0
</td>
<td><b>multiple</b>=1のときに利用できます。複数を置き換える統計値を設定します。
<p>0=最初の行、1=最終行、2=最大、3=最小、4=平均、5=合計
</p>
</td></tr>
<tr>
<td>combine
</td>
<td>全ての組み合わせに合致
</td>
<td>入力 int
</td>
<td>1
</td>
<td>結合されたワークシートにすべての可能な組み合わせを表示するかどうかを決定します。
<dl><dd>0= 全ての組み合わせを表示せず、欠損値がある組み合わせがないようほかの列を埋めます </dd>
<dd>1= 全ての組み合わせを表示します</dd></dl>
</td></tr>
<tr>
<td>merge
</td>
<td>一致した列を1つに統合
</td>
<td>入力 int
</td>
<td>1
</td>
<td>結合ワークシート内の一致した列のみ保持するか指定します。
<dl><dd>0=保持しないこの場合、結合シートには複数の一致した列があります。</dd>
<dd>1=結合シートに一致した列のもを表示します。この場合、一致する1つの列のみが最初の列として結合ワークシートに表示され、データ列は並べて配置されます。</dd></dl>
</td></tr>
<tr>
<td>missing
</td>
<td>欠損値を考慮する
</td>
<td>入力 int
</td>
<td>0
</td>
<td>一致した列の欠損値行を無視するか指定します。
<dl><dd>0 =一致する列に欠落している値がある場合、結果シートではデータ行全体が無視されます。</dd>
<dd>1 =一致する列にある欠落値は、個別のグループとして扱われます。</dd></dl>
</td></tr>
<tr>
<td>sort
</td>
<td>ソート出力
</td>
<td>入力 int
</td>
<td>2
</td>
<td>結合シートの一致した値の順序を制御します。
<dl><dd>0= <i>一致する列 -- 昇順</i></dd>
<dd>1= <i>一致する列 -- 降順</i></dd>
<dd>2= <i>シートの順序を保持</i>：<b>sortsheet</b>で設定したシートで見つかった一致する値の順序で並べ替える</dd>
<dd>3= <i>指定列による -- 昇順</i>：　<b>ソート列</b>で指定された列の昇順でワークシートを結合してソートします。</dd>
<dd>4= <i>指定列による -- 降順</i>：　<b>ソート列</b>で指定された列の降順でワークシートを結合してソートします。</dd></dl>
</td></tr>
<tr>
<td>sortsheet
</td>
<td>シート
</td>
<td>入力 int
</td>
<td>0
</td>
<td>sort=2のときに利用できます。並べ替えるワークシートのインデックスを指定します。0 = w1, 1 = w2.
</td></tr>
<tr>
<td>sortcol
</td>
<td>列
</td>
<td>入力 string
</td>
<td>
</td>
<td>sort=3もしくは4のときに利用できます。ソートする列を指定します。
<p>シンタックスは <b>w1/w2.<i>列ロングネーム/列ショートネーム</i></b>　です。例えば、<code>&quot;w1.ID1&quot;</code> 
</p>
</td></tr>
<tr>
<td>id
</td>
<td>データセット識別子
</td>
<td>入力 int
</td>
<td>0
</td>
<td>ソースデータセットの識別子を指定します。
<p>0 = なし, 1 = 範囲, 2 = ブック名, 3 = シート名, 4 =インデックスで作成された<b>行番号</b>を使用してデータセットソースを指定, 5 = ソースワークシートのシートラベルを表示
</p>
</td></tr>
<tr>
<td>index
</td>
<td>インデックス
</td>
<td>入力 string
</td>
<td>&lt;自動&gt;
</td>
<td>id=4のときに利用できます。識別子のインデックスを指定します。
<p>フォーマットは、<b><i>開始</i>：<i>増分</i></b>です。例えば、<code>1:2</code>は、w1の列を&rdquo;1&rdquo;、w2の列を&rdquo;3&rdquo;として識別します。 
</p>
</td></tr></table>
<h3><a name="Samples_of_SQL_query"></a><span class="mw-headline">SQLクエリのサンプル</span></h3>
<p><b>1.非一致を削除</b>
</p>
<pre class="lt" style="font-family:monospace;">w1 Left Join w2 on <span style="color: #008000;">//Left Join は Right Join/Inner Join/Full Outer Join　の場合もあります</span>
       w1.<span style="color: #000080;">A</span><span style="color: #000080;">=</span>w2.<span style="color: #000080;">A</span></pre>
<table class="simple">
<tr>
<td> <b>Left Join</b>
</td>
<td> <b>Right Join</b>
</td>
<td> <b>Inner Join</b>
</td>
<td> <b>Full Outer Join</b>
</td></tr>
<tr>
<td> <a  class="image"><img alt="Left Join.png" src="../images/Wjoincols/Left_Join.png" width="305"  /></a>
</td>
<td> <a  class="image"><img alt="Right Join.png" src="../images/Wjoincols/Right_Join.png" width="305"  /></a>
</td>
<td> <a  class="image"><img alt="Inner Join.png" src="../images/Wjoincols/Inner_Join.png" width="305"  /></a>
</td>
<td> <a  class="image"><img alt="Full Outer Join.png" src="../images/Wjoincols/Full_Outer_Join.png" width="305"  /></a>
</td></tr></table>
<p><b>2.複数の一致する列</b>
</p>
<pre class="lt" style="font-family:monospace;">w1 Inner Join w2 on <span style="color: #008000;">//Inner Join は Left Join/Right Join/Full Outer Join　にもできます</span>
       w1.<span style="color: #000080;">ID</span><span style="color: #000080;">=</span>W2.<span style="color: #000080;">UserID</span>
       and w1.<span style="color: #000080;">A</span><span style="color: #000080;">=</span>w2.<span style="color: #000080;">A</span> <span style="color: #008000;">// and は or　の場合もあります。</span></pre>
<p><b>3.特定の列で並び替え</b>
</p>
<pre class="lt" style="font-family:monospace;">w1 Full Outer Join w2 on <span style="color: #008000;">//Full Outer Join は Left Join/Right Join/Inner Join　にもできます</span>
       w1.<span style="color: #000080;">A</span><span style="color: #000080;">=</span>w2.<span style="color: #000080;">A</span>
Order by w1.<span style="color: #000080;">C</span> asc <span style="color: #008000;">//w1.C は w1/w2/match　でも, asc は desc　にもできます</span></pre>
<p><b>4.重複を削除</b>
</p>
<pre class="lt" style="font-family:monospace;">w1 Right Join w2 on <span style="color: #008000;">//Right Join は Left Join/Inner Join/Full Outer Join　にもできます</span>
       w1.<span style="color: #000080;">A</span><span style="color: #000080;">=</span>w2.<span style="color: #000080;">A</span>
w1 Merge multiples by Average <span style="color: #008000;">//Average は First/Last/Min/Max/　にもできますこの場合、ｗ2の重複は除されません。</span></pre>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">関連するXファンクション</span></h2>
<p><a href="../../XFunction/X-Function/Wjoinbycol.html" title="Xファンクション：Wjoinbycol">wjoinbycol</a>, <a href="../../XFunction/X-Function/WAppend.html" title="Xファンクション：WAppend">wAppend</a>, <a href="../../XFunction/X-Function/Wjoinbylabel.html" title="Xファンクション:Wjoinbylabel">wjoinbylabel</a>
</p>






    