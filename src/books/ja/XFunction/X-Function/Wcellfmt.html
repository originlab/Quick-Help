<h1 class="firstheading">wcellfmt</h1>
<p>&#160;</p>
<div id="toc" class="toc">
<div id="toctitle">
<h2>内容</h2>
</div>
<ol>
<li class="toclevel-1 tocsection-1"><a href="#Brief_Information"><span class="tocnumber">1</span><span class="toctext">概要</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Additional_Information"><span class="tocnumber">2</span><span class="toctext">追加の情報</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Command_Line_Usage"><span class="tocnumber">3</span><span class="toctext">コマンドラインでの使用法</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Variables"><span class="tocnumber">4</span><span class="toctext">変数</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Description"><span class="tocnumber">5</span><span class="toctext">説明</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Examples"><span class="tocnumber">6</span><span class="toctext">サンプル</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Related_X-Functions"><span class="tocnumber">7</span><span class="toctext">関連するXファンクション</span></a></li>
</ol>
</div>
<h2><a name="Brief_Information" id="Brief_Information"></a><span class="mw-headline">概要</span></h2>
<p>ツリーでセルプロパティを取得または設定</p>
<h2><a name="Additional_Information" id="Additional_Information"></a><span class="mw-headline">追加の情報</span></h2>
<h2><a name="Command_Line_Usage" id="Command_Line_Usage"></a><span class="mw-headline">コマンドラインでの使用法</span></h2>
<p><code style="font-family: monospace;">1. wcellFmt tr:=cfmt; cfmt.=;</code></p>
<p>2. wcellFmt tr:=cfmt; cfmt.FillColor=2; cfmt.Size=18; wcellFmt execute:=1 tr:=cfmt;</p>
<h2><a name="Variables" id="Variables"></a><span class="mw-headline">変数</span></h2>
<table class="xfvar">
<tr>
<th style="width: 8%;">表示名</th>
<th style="width: 8%;">変数名</th>
<th style="width: 8%;">I/O<br />
と<br />
データ型</th>
<th style="width: 8%;">デフォルト値</th>
<th>説明</th>
</tr>
<tr>
<td>入力範囲</td>
<td>irng</td>
<td>
<p>入力</p>
<p>Range</p>
</td>
<td>
<p style="text-align: center;">&lt;active&gt;</p>
</td>
<td>
<p>入力範囲を指定します。</p>
</td>
</tr>
<tr>
<td>実行モード</td>
<td>execute</td>
<td>
<p>入力</p>
<p>int</p>
</td>
<td>
<p style="text-align: center;">get</p>
</td>
<td>
<p>セルプロパティを取得または設定<br />
オプションリスト</p>
<ul>
<li><i style="font-style: italic;">get:フォーマットツリーを取得</i>
<dl>
<dd>セルプロパティを取得</dd>
</dl>
</li>
<li><i style="font-style: italic;">set:修正済みノードのフォーマットを設定</i>
<dl>
<dd>修正済みノードのフォーマットを設定</dd>
</dl>
</li>
<li><i style="font-style: italic;">all全ノードのフォーマットを設定</i>
<dl>
<dd>全ノードのフォーマットを設定</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr>
<td>GUIツリー</td>
<td>tr</td>
<td>
<p>入力/出力</p>
<p>TreeNode</p>
</td>
<td>&#160;</td>
<td>
<p>セルプロパティツリー</p>
</td>
</tr>
</table>
<h2><a name="Description" id="Description"></a><span class="mw-headline">説明</span></h2>
<p>このXファンクションはワークシートプロパティツリー<b>tr</b>(exectute:=0)を取得するか、ワークシートプロパティツリー<b>tr</b>(exectute:=1)を設定するために使用します。</p>
<p><a href="../../XFunction/X-Function/Wproperties.html#TextControl" title="Xファンクション:Wproperties"><b>TextControl</b></a>セクションのXファンクション<b>wproperties</b>を参照してください。</p>
<h2><a name="Examples" id="Examples"></a><span class="mw-headline">サンプル</span></h2>
<pre class="lt" style="font-family: monospace;">
<span style="color: #008000;">　　//選択されたセルの塗り色を緑に設定</span>
  Tree cfmt;
  wcellFmt tr<span>:</span><span style="color: #000080;">=</span>cfmt;<span style="color: #008000;">//取得のデフォルト</span>
  cfmt.<span style="color: #000080;">FillColor=</span><span style="color: rgb(0, 0, 221);">2</span>;
  wcellFmt exec<span>:</span><span style="color: #000080;">=</span>set tr<span>:</span><span style="color: #000080;">=</span>cfmt;
</pre>
<pre class="lt" style="font-family: monospace;">
  <span style="color: #008000;">//セルの塗り色を事前選択なしで緑にする  </span>
  Tree cfmt;
  wcellFmt <span style="color: rgb(0, 0, 221);">2</span><span>[</span><span style="color: rgb(0, 0, 221);">3</span><span>:</span><span style="color: rgb(0, 0, 221);">5</span><span>]</span> get cfmt;
  cfmt.<span style="color: #000080;">FillColor=</span><span style="color: rgb(0, 0, 221);">2</span>;
  wcellFmt <span style="color: rgb(0, 0, 221);">2</span><span>[</span><span style="color: rgb(0, 0, 221);">3</span><span>:</span><span style="color: rgb(0, 0, 221);">5</span><span>]</span> set cfmt;
</pre>
<pre class="lt" style="font-family: monospace;">
<span style="color: #008000;">　　//選択されたセルからツリーを出力</span>
  Tree cfmt;
  wcellFmt tr<span>:</span><span style="color: #000080;">=</span>cfmt;
  cfmt.<span style="color: #000080;">=</span>;
</pre>
<pre class="lt" style="font-family: monospace;">
<span style="color: #008000;">// 3つのスペクトルをインポートしてワークシートのYデータのための10レベルのヒートマップを作成</span>
<?rh-implicit_p ?><span style="color: #008000;">
// Originサンプルフォルダから3つのデータファイルをインポート</span>
newbook;
impASC fname<span>:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">"C:\Program Files\OriginLab\Origin2018\Samples\Batch Processing\T275K.csv
C:\Program Files\OriginLab\Origin2018\Samples\Batch Processing\T305K.csv
C:\Program Files\OriginLab\Origin2018\Samples\Batch Processing\T335K.csv"</span> options.<span style="color: #000080;">ImpMode</span><span>:</span><span style="color: #000080;">=</span><span style="color: rgb(0, 0, 221);">1</span>;
<?rh-implicit_p ?><span style="color: #008000;">
// 余分なX列を削除</span>
for <span>(</span>int ii <span style="color: #000080;">=</span> wks.<span style="color: #000080;">ncols</span> <span style="color: #000080;">-</span><span style="color: rgb(0, 0, 221);">1</span>; ii <span style="color: #000080;">&gt;</span> <span style="color: rgb(0, 0, 221);">2</span>; ii <span style="color: #000080;">-=</span> <span style="color: rgb(0, 0, 221);">2</span><span>)</span>
        delete wcol<span>(</span>ii<span>)</span>;
<?rh-implicit_p ?><span style="color: #008000;">
// 10進数の色のStringArrayを作成</span>
string strColors<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"#A000C8|#6E00DC|#1E3CFF|#00A0FF|#00C8C8|#00DC00|#E6DC32|#E6AF2D|#FA3C3C|#F00082"</span>;
StringArray sa;
sa.<span style="color: #000080;">Append</span><span>(</span>strColors<span style="color: #000080;">$</span>, <span style="color: #000080;">|</span><span>)</span>;
<?rh-implicit_p ?><span style="color: #008000;">
// 列1、行1のセル形式をTree変数に取得</span>
Tree trFmt;
wcellFmt irng<span>:</span><span style="color: #000080;">=</span>col<span>(</span><span style="color: rgb(0, 0, 221);">1</span><span>)[</span><span style="color: rgb(0, 0, 221);">1</span><span>]</span> exec<span>:</span><span style="color: #000080;">=</span>get tr<span>:</span><span style="color: #000080;">=</span>trFmt;
<?rh-implicit_p ?><span style="color: #008000;">
// 書式ツリーからオリジナルのフォントサイズを保存</span>
double dFontSize <span style="color: #000080;">=</span> trFmt.<span style="color: #000080;">Size</span>;
<?rh-implicit_p ?><span style="color: #008000;">
// Y列の全ての値の最小、最大値を取得</span>
stats ix<span>:</span><span style="color: #000080;">=</span><span>(</span><span style="color: rgb(0, 0, 221);">2</span><span>:</span>end<span>)</span>;
double dMin <span style="color: #000080;">=</span> stats.<span style="color: #000080;">min</span>;
double dMax <span style="color: #000080;">=</span> stats.<span style="color: #000080;">max</span>;
<?rh-implicit_p ?><span style="color: #008000;">
// 全Y列でループ</span>
int nCols <span style="color: #000080;">=</span> wks.<span style="color: #000080;">ncols</span>;
for <span>(</span>int ii <span style="color: #000080;">=</span> <span style="color: rgb(0, 0, 221);">2</span>; ii <span style="color: #000080;">&lt;=</span> nCols; ii<span style="color: #000080;">++</span><span>)
{</span>
        <span style="color: #008000;">// 現在の列の範囲を取得し、列が空の場合はスキップ</span>
        range rng <span style="color: #000080;">=</span> wcol<span>(</span>ii<span>)</span>;
        if <span>(</span><span style="color: #000080;">!</span>rng.<span style="color: #000080;">GetSize</span><span>())</span>
                continue;<?rh-implicit_p ?>
        <span style="color: #008000;">// 現在の列の値の一時データセットを作成</span>
        <span style="color: #008000;">// シート内の全セルの最小、最大値で(1-10)の規格化</span>
        dataset ds <span style="color: #000080;">=</span> round<span>(</span><span style="color: rgb(0, 0, 221);">1</span> <span style="color: #000080;">+</span> <span>(</span>rng <span style="color: #000080;">-</span> dMin<span>)</span> <span style="color: #000080;">*</span> <span>(</span><span style="color: rgb(0, 0, 221);">10</span> <span style="color: #000080;">-</span> <span style="color: rgb(0, 0, 221);">1</span><span>)</span> <span style="color: #000080;">/</span> <span>(</span>dMax <span style="color: #000080;">-</span> dMin<span>))</span>;
<?rh-implicit_p ?>
        <span style="color: #008000;">// 現在の列の全行でループ</span>
        int nSize <span style="color: #000080;">=</span> ds.<span style="color: #000080;">GetSize</span><span>()</span>;
        for<span>(</span>jj <span style="color: #000080;">=</span> <span style="color: rgb(0, 0, 221);">1</span>; jj <span style="color: #000080;">&lt;=</span> nSize; jj<span style="color: #000080;">++</span><span>)</span>
        <span>{</span>
                <span style="color: #008000;">// 正規化されたセルの値に基づいてツリーをフォーマットするために</span>
                <span style="color: #008000;">// 修正されたフォントサイズを適用</span>
                trFmt.<span style="color: #000080;">Size</span> <span style="color: #000080;">=</span> dFontSize <span style="color: #000080;">+</span> ds<span>[</span>jj<span>]</span>;
                <span style="color: #008000;">// 正規化されたセルの値に基づいてツリーをフォーマットするために</span>
                <span style="color: #008000;">// 16進数の背景色を適用</span>
                string str<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> sa.<span style="color: #000080;">GetAt</span><span>(</span>ds<span>[</span>jj<span>])</span><span style="color: #000080;">$</span>;
                trFmt.<span style="color: #000080;">FillColor</span> <span style="color: #000080;">=</span> color<span>(</span><span style="color: #ff00ff;">"%(str$)"</span><span>)</span>;
                <span style="color: #008000;">// セルに書式ツリーを適用</span>
                wcellFmt irng<span>:</span><span style="color: #000080;">=</span>rng<span>[</span>jj<span>]</span> exec<span>:</span><span style="color: #000080;">=</span>set tr<span>:</span><span style="color: #000080;">=</span>trFmt;
        <span>}
}</span><span style="color: #008000;">
//列と行のサイズに基づいてワークシートのサイズを変更</span>
wautosize hw<span>:</span><span style="color: #000080;">=</span>b;
</pre>
<h2><a name="Related_X-Functions" id="Related_X-Functions"></a><span class="mw-headline">関連 X ファンクション</span></h2>
