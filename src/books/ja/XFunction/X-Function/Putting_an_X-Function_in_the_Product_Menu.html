<h1 class="firstheading">製品メニューにXファンクションを追加する</h1>
<p><span class="OIndex" style="display: none;">X-Function, Add to Origin Menu</span></p>
<p>XファンクションをOriginメニューに追加するには、次の2つのステップを行います。</p>
<ul>
<li>Xファンクションビルダツリービューで基本設定を修正</li>
<li>Xファンクションを指定したメインメニューおよびサブメニューに配置</li>
</ul>
<p>そして、メニューで、フォーマット：メニュー：フルメニューを選ぶか、Originを再起動し、すべてのXファンクションの変更を自動スキャンして、新しく追加したXファンクションをメニューに追加します。詳細はXファンクションビルダのドキュメントを参照してください。</p>
<table id="toc" class="toc">
<tr>
<td>
<div id="toctitle">
<h2>内容</h2>
</div>
<ol>
<li class="toclevel-1 tocsection-1"><a href="#Setup_in_Tree_View"><span class="tocnumber">1</span> <span class="toctext">ツリービューでのセットアップ</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Menu_Accessible"><span class="tocnumber">2</span> <span class="toctext">メニューをアクセス可能にする</span></a>
<ol>
<li class="toclevel-2 tocsection-3"><a href="#Default_Menu"><span class="tocnumber">2.1</span> <span class="toctext">デフォルトメニュー</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#User_Defined_Menu"><span class="tocnumber">2.2</span> <span class="toctext">ユーザ定義メニュー</span></a></li>
</ol>
</li>
</ol>
</td>
</tr>
</table>
<a name="Setup_in_Tree_View" id="Setup_in_Tree_View"></a>
<h2><span class="mw-headline">ツリービューでのセットアップ</span></h2>
<p>Xファンクションをメニュー内で適切に表示するには、Xファンクションビルダ内で次の設定が必要です。</p>
<ol>
<li>XファンクションビルダでXファンクションを開きます。</li>
<li>コンテキストの使用ブランチでツリービューモードに切り替えます。
<ul>
<li>メニューで<b>メインメニュー</b>を選びます。</li>
<li><b style="font-weight: bold;">Windows</b> チェックボックスをチェックします。</li>
<li>1つまたはいくつかのウィンドウタイプ（ワークシート、グラフ、行列 ）をチェックします。</li>
</ul>
</li>
</ol>
<a name="Menu_Accessible" id="Menu_Accessible"></a>
<h2><span class="mw-headline">メニューをアクセス可能にする</span></h2>
<p>Xファンクションがツリービューでセットアップされると、Xファンクションを指定したメニューに配置することができます。Originは、ユーザのXファンクションを2種類のメニューからアクセス可能にします。</p>
<ul>
<li>デフォルトメニュー</li>
</ul>
<p>(このメカニズムには制限があります。Xファンクションを指定したファイルフォルダに置く必要があり、Xファンクション名は指定した接頭語を持つ必要があります。また、メニュー内の位置を制御するのは簡単ではありません。次のメカニズム、ユーザ定義メニューではこれらの問題が解決されます。)</p>
<ul>
<li>ユーザ定義メニュー</li>
</ul>
<a name="Default_Menu" id="Default_Menu"></a>
<h3><span class="mw-headline">デフォルトメニュー</span></h3>
<p>Xファンクションがユーザファイルフォルダ内の<b>X-Functions</b>フォルダのサブフォルダに適切に保存されていれば、指定したデフォルトメニューから、そのXファンクションにアクセスできます。</p>
<ul>
<li>サブフォルダ内のすべてのXファンクションがメニューに表示されます。</li>
</ul>
<table class="simple">
<tr>
<th>フォルダ</th>
<th>メニュー</th>
</tr>
<tr>
<td>Signal Processing\</td>
<td><b style="font-weight: bold;">解析：信号処理</b></td>
</tr>
<tr>
<td>Spectroscopy\</td>
<td><b style="font-weight: bold;">解析：スペクトル分析</b></td>
</tr>
<tr>
<td>Mathematics\</td>
<td><b style="font-weight: bold;">解析：数学</b></td>
</tr>
<tr>
<td>Statistics\</td>
<td><b style="font-weight: bold;">統計</b></td>
</tr>
</table>
<ul>
<li>サブフォルダ内にある接頭語付きの全Xファンクションがメニューに表示されます。</li>
</ul>
<table class="simple">
<tr>
<th>フォルダ</th>
<th>接頭語</th>
<th>メニュー</th>
</tr>
<tr>
<td rowspan="2">Import and Export\</td>
<td>imp*</td>
<td><b style="font-weight: bold;">ファイル：インポート</b></td>
</tr>
<tr>
<td>exp*</td>
<td><b style="font-weight: bold;">ファイル：エクスポート</b></td>
</tr>
<tr>
<td rowspan="2">Data Manipulation\</td>
<td>w*</td>
<td><b style="font-weight: bold;">ワークシート</b></td>
</tr>
<tr>
<td>col*</td>
<td><b style="font-weight: bold;">列</b></td>
</tr>
<tr>
<td>Database Access\</td>
<td>db*</td>
<td><b style="font-weight: bold;">カテゴリー：データベースアクセス</b></td>
</tr>
</table>
<ul>
<li>サブフォルダMiscellaneous、Data Exploration、Utilities にあるXファンクションは、次のセクションで示す処理で、ユーザが直接XMLファイルを修正しなければ、メニューに表示されません。</li>
</ul>
<a name="User_Defined_Menu" id="User_Defined_Menu"></a>
<h3><span class="mw-headline">ユーザ定義メニュー</span></h3>
<p>Xファンクションをデフォルトメニューに追加することに加え、OriginのインストールフォルダのThemes\MenusフォルダにあるXMLファイルを編集することで、ユーザはXファンクションをユーザ定義メニューに配置することができます。このフォルダには2つのXMLファイルがあり、ConfMenus.xmlはOriginメインメニューを制御するのに使用され、ContextMenus.xmlはコンテキストメニューを制御するのに使われます。</p>
<p><i style="font-style: italic;"><b style="font-weight: bold;"><u style="text-decoration: underline;">サンプル</u></b></i></p>
<p>以下は、ユーザ定義XファンクションをOriginの<b>解析</b>メニュー内に作成した新しいサブメニュー <b>OC Guide Tools</b>に追加する方法を示すサンプルです。ユーザ定義メニューは、<b>解析：フィット</b>と<b>解析：信号処理</b>の間に配置されます。</p>
<ol>
<li>ファイルパス<i>&lt;User Files Folder&gt;\X-Functions\</i>のフォルダの下に<b>OC Guide</b>フォルダを作成します。</li>
<li><a href="../../XFunction/X-Function/Creating_a_Simple_X-Function.html" title="X-Function: 単純なXファンクションの作成">このサンプル</a>に従ってユーザ定義Xファンクションを作成しますが、名称は<b>MyAnalysis</b>とし、保存の際には<i>&lt;User Files Folder&gt;\X-Functions\OC Guide\</i>をパスとして指定します。</li>
<li>XファンクションビルダでXファンクション<b>MyAnalysis</b> を開きます。ツリービューに切り替え、使用のコンテキストブランチ内でメニューをメインメニューにセットし、ウィンドウチェックボックスにチェックを付け、ウィンドウブランチ内のワークシートにチェックを付けます。</li>
<li>説明編集ボックスに、例えば、"カスタムダイアログ(&amp;C)"のようにテキストを入力します。&amp;は、キーボードからのショートカットキーを指定するために使います。保存をクリックして、Xファンクションに変更を保存し、Xファンクションビルダを閉じます。</li>
<li><a class="external text" href="http://symbolclick.com/index.htm">XML Marker</a>のようなXMLエディタで、<b>ConfMenus.xml</b>を開きます。</li>
<li>左パネルで wks -&gt; wksAnalysis -&gt; wfit を選択します。</li>
<li>以下をコピーして、&lt;wfit...&gt;&lt;/wfit&gt;の後の右側パネルに貼り付け、保存をクリックします。 （WindowsVISTA以降のOSの場合、ProgramFilesフォルダのXMLファイルを直接編集できませんので注意して下さい）
<pre>
&lt;testmenu1 Label = "OC Guide Tools" popup = "1"&gt;
        &lt;efg Label = ""&gt;
            &lt;name&gt;*&lt;/name&gt;
            &lt;auxopts&gt;2162688.&lt;/auxopts&gt;
            &lt;catsubcat DataID = "74"&gt;OC Guide&lt;/catsubcat&gt;
        &lt;/efg&gt;
&lt;/testmenu1&gt;
</pre></li>
<li>Originを閉じ、再起動します。ワークシートをアクティブにし、メニューで解析を選びます。OC Guide Tools：カスタムダイアログが表示されました。
<div><a class="image" style="color: #0000ff; text-decoration: underline;"><img alt="Ocguide xf put to menu.png" src="../images/Putting_an_X-Function_in_the_Product_Menu/Ocguide_xf_put_to_menu.png" width="503" height="274" border="0" /></a></div>
</li>
</ol>


