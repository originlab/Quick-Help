<h1 class="firstheading">m2w</h1><div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">メニュー情報</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">概要</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Additional_Information"><span class="tocnumber">3</span> <span class="toctext">追加の情報</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Command_Line_Usage"><span class="tocnumber">4</span><span class="toctext">コマンドラインでの使用法</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#X-Function_Execution_Options"><span class="tocnumber">5</span> <span class="toctext">Xファンクションの実行オプション</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Variables"><span class="tocnumber">6</span> <span class="toctext">変数</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Description"><span class="tocnumber">7</span> <span class="toctext">説明</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Examples"><span class="tocnumber">8</span> <span class="toctext">サンプル</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Related_X-Functions"><span class="tocnumber">9</span> <span class="toctext">関連するXファンクション</span></a></li>
</ul>
</div>

<h2><a name="Menu_Information"></a><span class="mw-headline">メニュー情報</span></h2>
<p>行列：ワークシートに変換 
</p>
<h2><a name="Brief_Information"></a><span class="mw-headline">概要</span></h2>
<p>ワークシートに行列データを変換
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">追加の情報</span></h2>
<p>必要なOriginのバージョン：Origin8.0 SR0以降、Origin8.5.1 で更新
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">コマンドラインでの使用法</span></h2>
<p><code>
1. m2w;
</p><p>2. m2w im:=[MBook1]MSheet1!Mat(1) ow:=[Book1]Sheet1!;
</p><p>3. m2w method:=direct xy:=xcol ycol:=1 xlabel:=row1; 
</p><p>4. m2w method:=xyz option:=yconst;
</p><p>5. m2w method:=xyz trim:=1;
</p><p>6. m2w -r 1 ims:=[MBook1]MSheet2! method:=xyz multi:=all;
</code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">Xファンクションの実行オプション</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">スクリプトからXファンクションにアクセスする場合、追加のオプションスイッチについてのページを参照してください。</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">変数</span></h2>
<table class="xfvar">
<tr>
<th width="8%">表示<br />名
</th>
<th width="8%">変数<br />名
</th>
<th width="8%">I/O<br />と<br />データ型
</th>
<th width="8%">デフォルト<br />値
</th>
<th>説明
</th></tr>
<tr>
<td>入力行列
</td>
<td>im
</td>
<td>
<p>入力
</p><p>MatrixObject
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td>
<p>ソース行列オブジェクトを指定します。 
</p>
</td></tr>
<tr>
<td>入力行列
</td>
<td>ims
</td>
<td>
<p>入力
</p><p>MatrixLayer
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td>
<p>ソース行列シートを指定します。行列シート内の全オブジェクトを変換する場合、<b>im</b>の代わりに<b>ims</b>を使用する必要があります。
<br /><b>method:=xyz, multi:=1</b>の時利用可能です。
</p>
</td></tr>
<tr>
<td>手法
</td>
<td>method
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>direct</center>
</td>
<td>
<p>変換法を指定します。<br />
オプションリスト:<br />
</p>
<ul><li><i>direct:形状のまま</i>
<dl><dd>直接変換</dd></dl></li>
<li><i>xyz:XYZ列</i>
<dl><dd>XYZ列のワークシートを作成します。</dd></dl></li></ul>
</td></tr>
<tr>
<td>データフォーマット
</td>
<td>xy
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>xcol</center>
</td>
<td>
<p>これは、<b><b>手法</b></b>で<b>形状のまま</b>が選択されている場合のみ利用できます。データを出力するワークシートでのデータ配置を指定します。<br />
オプションリスト:
</p>
<ul><li><i>xcol:列方向のX</i>
<dl><dd>同じX値に対応する行列値が列に配置され、異なるX値に対応する2つの行列値は異なる列に配置されます。<b>X値</b>変数にX値を出力することもできます。</dd></dl></li>
<li><i> ycol:列方向のY</i>
<dl><dd>同じY値に対応する行列値が列に配置され、異なるY値に対応する2つの行列値は異なる列に配置されます。<b>Y値</b>変数にX値を出力することもできます。</dd></dl></li>
<li><i> noxy:XとYがありません</i>
<dl><dd>行列のXとYの値は出力されません。</dd></dl></li></ul>
</td></tr>
<tr>
<td>最初の列のY値
</td>
<td>ycol
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>これは、<b>データフォーマット</b>で<b>列方向のX</b>が選択されている場合のみ利用できます。出力ワークシートの最初の列に行列のY値を出力するかを指定します。
</p>
</td></tr>
<tr>
<td>最初の列のX値
</td>
<td>xcol
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>これは、<b>データフォーマット</b>で<b>列方向のY</b>が選択されている場合のみ利用できます。出力ワークシートの最初の列に行列のX値を出力するかを指定します。
</p>
</td></tr>
<tr>
<td>X値の位置
</td>
<td>xlabel
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>none</center>
</td>
<td>
<p>これは、<b>データフォーマット</b>で<b>列方向のX</b>が選択されている場合のみ利用できます。行列のX値を出力するかを指定し、出力する場合は、保存位置を指定します。
<br />
オプションリスト:
</p>
<ul><li><i>none:なし</i>
<dl><dd>行列のX値を出力しません。</dd></dl></li>
<li><i>row1</i>:第1行
<dl><dd>出力ワークシートの最初の行に行列のX値を出力します。</dd></dl></li>
<li><i> syspara:システムパラメータ</i>
<dl><dd>出力ワークシートのシステムパラメータ行に行列のX値を出力します。以下の<b>システムパラメータ</b>変数を参照してください。</dd></dl></li>
<li><i> userpara:ユーザ定義パラメータ </i>
<dl><dd>出力ワークシートのユーザ定義パラメータ行に行列のX値を出力します。以下の<b>ユーザ定義パラメータ</b>変数を参照してください。</dd></dl></li></ul>
</td></tr>
<tr>
<td>Y値の位置
</td>
<td>ylabel
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>none</center>
</td>
<td>
<p>これは、<b>データフォーマット</b>で<b>列方向のY</b>が選択されている場合のみ利用できます。行列のY値を出力するかを指定し、出力する場合は、保存位置を指定します。
<br />
オプションリスト:
</p>
<ul><li><i>none:なし</i>
<dl><dd>行列のY値を出力しません。</dd></dl></li>
<li><i> row1:第1行</i>
<dl><dd>出力ワークシートの最初の行に行列のY値を出力します。</dd></dl></li>
<li><i> syspara:システムパラメータ</i>
<dl><dd>出力ワークシートのシステムパラメータ行に行列のY値を出力します。以下の<b>システムパラメータ</b>変数を参照してください。</dd></dl></li>
<li><i> userpara:ユーザ定義パラメータ</i>
<dl><dd>出力ワークシートのユーザ定義パラメータ行に行列のY値を出力します。以下の<b>ユーザ定義パラメータ</b>変数を参照してください。</dd></dl></li></ul>
</td></tr>
<tr>
<td>システムパラメータ
</td>
<td>sysparam
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>p1</center>
</td>
<td>
<p><b>X値</b>または<b>Y値</b>で<b>システムパラメータ</b>が選択されている場合にのみ使用できます。行列のX/Y値を保存するためのシステムパラメータラベル行を指定します。
<br />
オプションリスト:
</p>
<ul><li><i>p1: パラメータ1</i>
<dl><dd><b>パラメータ1</b>ラベル行です。</dd></dl></li>
<li><i>p2: パラメータ2</i>
<dl><dd><b>パラメータ2</b>ラベル行です。</dd></dl></li>
<li><i>p3: パラメータ3</i>
<dl><dd><b>パラメータ3</b>ラベル行です。</dd></dl></li>
<li><i>p4: パラメータ4</i>
<dl><dd><b>パラメータ4</b>ラベル行です。</dd></dl></li>
<li><i>p5: パラメータ5</i>
<dl><dd><b>パラメータ5</b>ラベル行です。</dd></dl></li>
<li><i>p6: パラメータ6</i>
<dl><dd><b>パラメータ6</b>ラベル行です。</dd></dl></li>
<li><i>p7: パラメータ7</i>
<dl><dd><b>パラメータ7</b>ラベル行です。</dd></dl></li>
<li><i>p8: パラメータ8</i>
<dl><dd><b>パラメータ8</b>ラベル行です。</dd></dl></li>
<li><i>p9: パラメータ9</i>
<dl><dd><b>パラメータ9</b>ラベル行です。</dd></dl></li>
<li><i>p10: パラメータ10</i>
<dl><dd><b>パラメータ10</b>ラベル行です。</dd></dl></li></ul>
</td></tr>
<tr>
<td>ユーザ定義パラメータ
</td>
<td>userdef
</td>
<td>
<p>入力
</p><p>string
</p>
</td>
<td> <center>UserDefined</center>
</td>
<td>
<p><b>X値</b>または<b>Y値</b>で<b>ユーザ定義パラメータ</b>が選択されている場合にのみ使用できます。行列のX/Y値を保存するためのユーザ定義パラメータラベル行を指定します。
</p>
</td></tr>
<tr>
<td>変換
</td>
<td>multi
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>行列シート内に複数の行列オブジェクトがある場合、単一オブジェクトのみ変換するか全て変換するか指定できます。
<br /><b>method:=xyz</b>の時利用できます。
</p><p>オプションリスト:
</p>
<ul><li> <i>0=single:単一オブジェクトのみ</i>
<dl><dd> 第1行列オブジェクトのみ変換します。</dd></dl></li>
<li> <i>1=all:すべてのオブジェクト</i>
<dl><dd> 指定した行列シート内のすべてのオブジェクトを変換します。</dd></dl></li></ul>
<p><i><b>Note:</b></i> この2つのオプションは、入力変数が異なります。
</p>
</td></tr>
<tr>
<td>オプション
</td>
<td>option
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>xconst</center>
</td>
<td>
<p>これは、<b><b>手法</b></b>で<b>XYZ列</b>が選択されている場合のみ利用できます。ワークシートの値をどのようにソートするか指定します。
<br />
オプションリスト:
</p>
<ul><li><i>xconst</i>:X一定でYを変化
<dl><dd>ターゲットワークシートの値を、ソース行列のX値を昇順で並べ替え、次にY値を昇順で並べ替えます。</dd></dl></li>
<li><i>yconst</i>:Y一定でXを変化
<dl><dd>ターゲットワークシートの値を、ソース行列のY値を昇順で並べ替え、次にX値を昇順で並べ替えます。</dd></dl></li></ul>
</td></tr>
<tr>
<td>欠損値の削除
</td>
<td>trim
</td>
<td>
<p>入力
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> このチェックボックスは、<b>手法</b>が<b>XYZ列</b>の場合にのみ利用できます。チェックを付けると、行列内の欠損値がスキップされ、ワークシート上では含めません。チェックを外すと、欠損値も結果ワークシートに表示されます。
</td></tr>
<tr>
<td>出力ワークシート
</td>
<td>ow
</td>
<td>
<p>出力
</p><p>Worksheet
</p>
</td>
<td> <center>[&lt;new&gt;]&lt;new&gt;</center>
</td>
<td>
<p>出力ワークシートを指定します。
</p><p><a class="external text" href="../../XFunction/X-Function/Output_Notations.html">このシンタックス</a>を参照してください。
</p>
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">説明</span></h2>
<p>行列には1つのZ値のデータセットが表示されます。これには次のような特徴があります。
</p>
<ul><li><i>線形</i>の等間隔なのX値でマッピングされた番号付きの列。</li></ul>
<ul><li><i>線形</i>の等間隔なのY値でマッピングされた番号付きの行。</li></ul>
<p>デフォルトでは、行ヘッダには列および行番号が表示されます(左図)。右図のようにXおよびYの値を表示するには、メニューから<b>表示：X/Yを表示</b>を選択します。
</p>
<dl><dd><a  class="image"><img alt="M2w image12.gif" src="../images/M2w/M2w_image12.gif" width="455"  /></a></dd></dl>
<p>行列をワークシートに変換するには、2つの方法があります。: 1つは直接変換で、もう1つはXYZ列を持つワークシートを作成する方法です。
</p><p><b>直接変換：</b>
</p><p>1.<i>XとYなし</i>
</p><p>行列のセル値のみを変換します。
</p>
<dl><dd><a  class="image"><img alt="M2w image13.gif" src="../images/M2w/M2w_image13.gif" width="291"  /></a></dd></dl>
<p>2.<i>列方向のX</i>
</p><p>行列値がXマッピング値によってワークシート列に並び替え：同じX値に対応する行列値が同じ列に配置され、異なるX値に対応する2つの行列値は異なる列に配置されます。
</p><p>この方法では、行列のXY値をワークシートの1列目および1行目に出力するか、またはワークシートラベルに出力するどうかを指定できます。次のサンプルは、直接変換を使用し、目的のワークシートの最初の行にX値を加え、最初の列にY値を加えます。
</p>
<dl><dd><a  class="image"><img alt="M2w image14.gif" src="../images/M2w/M2w_image14.gif" width="371"  /></a></dd></dl>
<p>3.<i>列方向のY</i>:
</p><p>行列値がYマッピング値によってワークシート列に並び替え：同じY値に対応する行列値が同じ列に配置され、異なるY値に対応する2つの行列値は異なる列に配置されます。
</p><p>この方法では、行列のXY値をワークシートの1列目および1行目に出力するか、またはワークシートラベルに出力するどうかを指定できます。次のサンプルは、直接変換を使用し、目的のワークシートの<b>パラメータ 1</b>行にY値を加え、最初の列にX値を加えます。
</p>
<dl><dd><a  class="image"><img alt="M2w image15.png" src="../images/M2w/M2w_image15.png" width="475"  /></a></dd></dl>
<p><b>XYZ列のワークシートを作成：</b>
</p><p>この手法ではX、Y、Z 列のあるワークシートを作成します。行列のセルの値はワークシート内のZデータに変換されます。ワークシートの対応するXY列の値は行列のXとYのマッピング情報によって設定されます。そして、<b>オプション</b>変数を使って変換したワークシートを並び替える方法を指定できます。
</p><p>1.X一定でYを変化: ターゲットワークシートの値を、ソース行列のX値を昇順で並べ替え、次にY値を昇順で並べ替えます。
</p>
<dl><dd><a  class="image"><img alt="M2w image16.gif" src="../images/M2w/M2w_image16.gif" width="290"  /></a></dd></dl>
<p>2.  Y一定でXを変化: ターゲットワークシートの値を、ソース行列のY値を昇順で並べ替え、次にX値を昇順で並べ替えます。
</p>
<dl><dd><a  class="image"><img alt="M2w image17.gif" src="../images/M2w/M2w_image17.gif" width="294"  /></a></dd></dl>
<h2><a name="Examples"></a><span class="mw-headline">サンプル</span></h2>
<ul><li> コードサンプル</li></ul>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000; font-style: regular;">/*
このサンプルでは、行列データをXYZワークシート列に変換する方法を示します。
サンプルデータ：exe_path\Samples\Matrix Conversion and Gridding\Direct.dat
1.新規作成した行列にデータをロードします。
2.行列をXYZワークシートデータに変換します。
*/</span>
<span style="color: #008000;">// サンプルファイル名を取得</span>
fn<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Matrix Conversion and Gridding\Direct.dat&quot;</span>;
<span style="color: #008000;">// 行列ウィンドウを作成</span>
win <span style="color: #000080;">-</span>t matrix origin;
<span style="color: #008000;">// アクティブ行列にデータをインポート</span>
impASC fn<span style="color: #000080;">$</span>;

<span style="color: #008000;">// X一定でYを変化オプションで行列をXYZワークシートに変換</span>
m2w m<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;</pre>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">関連するXファンクション</span></h2>
<p><a href="../../XFunction/X-Function/W2m.html" title="Xファンクション:W2m">w2m</a>, <a href="../../XFunction/X-Function/R2m.html" title="Xファンクション:R2m">r2m</a>, <a href="../../XFunction/X-Function/Wexpand2m.html" title="Xファンクション:Wexpand2m">wexpand2m</a>
</p>






    