<h1 class="firstheading">Page::AddLayer</h1>

  <p><span class="OIndex" style="display:none">AddLayer</span></p>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>Contents</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>

      <li class="toclevel-1 tocsection-2"><a href="#Syntax"><span class="tocnumber">2</span> <span class="toctext">Syntax</span></a></li>

      <li class="toclevel-1 tocsection-3"><a href="#Parameters"><span class="tocnumber">3</span> <span class="toctext">Parameters</span></a></li>

      <li class="toclevel-1 tocsection-4"><a href="#Return"><span class="tocnumber">4</span> <span class="toctext">Return</span></a></li>

      <li class="toclevel-1 tocsection-5"><a href="#Examples"><span class="tocnumber">5</span> <span class="toctext">Examples</span></a></li>

      <li class="toclevel-1 tocsection-6"><a href="#Remark"><span class="tocnumber">6</span> <span class="toctext">Remark</span></a></li>

      <li class="toclevel-1 tocsection-7"><a href="#See_Also"><span class="tocnumber">7</span> <span class="toctext">See Also</span></a></li>

      <li class="toclevel-1 tocsection-8"><a href="#header_to_Include"><span class="tocnumber">8</span> <span class="toctext">header to Include</span></a></li>
    </ul>
  </div>

  <h2><a name="Description"></a><span class="mw-headline">Description</span></h2>

  <p>Add a new Layer to the page giving it the specified name. Can be used with GraphPage, WorksheetPage, or MatrixPage. The specified Layer name if already exist in the page the new Layer's name will be enumerated.</p>

  <p><br>
  Copy an existing Layer from one page to another. Can be used with GraphPage, WorksheetPage or MatrixPage.</p>

  <h2><a name="Syntax"></a><span class="mw-headline">Syntax</span></h2>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">int</span> AddLayer<span style="color: #000000;">(</span> LPCSTR lpcszLayerName <span style="color: #000080;">=</span> <span style="color: #0000ff;">NULL</span>, DWORD dwOptions <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>, LPCSTR lpcszTemplate <span style="color: #000080;">=</span> <span style="color: #0000ff;">NULL</span>, DWORD dwOption2 <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>, LPCSTR lpcszSheet <span style="color: #000080;">=</span> <span style="color: #0000ff;">NULL</span> <span style="color: #000000;">)</span>
</pre>

  <p> </p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">int</span> AddLayer<span style="color: #000000;">(</span> Layer <span style="color: #000040;">&amp;</span> layerToCopy, DWORD dwOptions <span style="color: #000080;">=</span> DCTRL_COPY_DEFAULT, <span style="color: #0000ff;">BOOL</span> bKeepSrcLayer <span style="color: #000080;">=</span> <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">int</span> nNewLayerPos <span style="color: #000080;">=</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span> <span style="color: #000000;">)</span>
</pre>

  <h2><a name="Parameters"></a><span class="mw-headline">Parameters</span></h2>

  <dl>
    <dt>lpcszLayerName</dt>

    <dd>[input]Optional name of the new layer. If the specified Layer name already exists in the Page, the new Layer's name is automatically enumerated to make it unique. Consequently, you can not assume the new Layer will always have the specified name. Pass Null for lpcszLayerName to preseve the sheet name stored in the template lpcszTemplate.</dd>

    <dt>dwOptions</dt>

    <dd>[input]Options for the new layer which are dependent on the page layer type. Bits such as CREATE_NO_DEFAULT_TEMPLATE can be used.</dd>

    <dt>lpcszTemplate</dt>

    <dd>[input]Optional template to load the layer from. Use lpcszLayerName=NULL to preseve sheet name in template otherwise sheet will be renamed by lpcszLayerName.</dd>

    <dt>dwOption2</dt>

    <dd>[input]Additional option settings.</dd>

    <dt>lpcszSheet</dt>

    <dd>optionally specifies sheet name from a multiple-sheet template to be loaded, if NULL first sheet is used</dd>
  </dl>

  <p> </p>

  <dl>
    <dt>layerToCopy</dt>

    <dd>[input]input Layer to copy.</dd>

    <dt>dwOptions</dt>

    <dd>[input] copy layer options, can be one or more of the following</dd>

    <dd>DCTRL_COPY_DATA, DCTRL_COPY_IN_OPERATIONS, DCTRL_COPY_OUT_OPERATIONS, DCTRL_COPY_LINKED_LAYERS, DCTRL_COPY_DEFAULT (= DCTRL_COPY_DATA | DCTRL_COPY_OUT_OPERATIONS)</dd>

    <dd>DCTRL_COPY_DATA, DCTRL_COPY_IN_OPERATIONS, DCTRL_COPY_OUT_OPERATIONS are specific to Worksheet layers</dd>

    <dd>DCTRL_COPY_LINKED_LAYERS is specific to graph layers</dd>

    <dt>bKeepSrcLayer</dt>

    <dd>[input] if false, will do the same as drag sheet from source to destination and dwOptions will be ignored except DCTRL_ADD_LAYER_UNDOABLE</dd>

    <dt>nNewLayerPos</dt>

    <dd>[input] 0 for add to first sheet, -1 as last</dd>
  </dl>

  <h2><a name="Return"></a><span class="mw-headline">Return</span></h2>

  <p>Returns the index (0 offset) of the newly added layer on successful exit or -1 on failure.</p>

  <p><br>
  Returns the index (0 offset) of the newly added layer on successful exit or &lt; 0 on failure.</p>

  <h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>

  <p><b>EX1</b></p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #008000;">//Add a new layer to worksheet</span>
<span style="color: #0000ff;">void</span> Page_AddLayer_ex1<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
        WorksheetPage wksPg;
        wksPg.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Origin"</span><span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">if</span> <span style="color: #000000;">(</span>wksPg<span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
                <span style="color: #0000ff;">int</span> nn <span style="color: #000080;">=</span> wksPg.<span style="color: #000000;">AddLayer</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"New"</span><span style="color: #000000;">)</span>; <span style="color: #008000;">//Add a new sheet to worksheet</span>
                Worksheet wksNew <span style="color: #000080;">=</span> wksPg.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span>nn<span style="color: #000000;">)</span>;        <span style="color: #008000;">//Access the new sheet</span>
                <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"A new sheet names <span style="color: #666666; font-weight: bold;">\"</span>%s<span style="color: #666666; font-weight: bold;">\"</span> was added<span style="color: #666666; font-weight: bold;">\n</span>"</span>, wksNew.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>
        <span style="color: #000000;">}</span>
<span style="color: #000000;">}</span>
</pre>

  <p><b>EX2</b></p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #008000;">//Add a new layer to graph</span>
<span style="color: #0000ff;">void</span> Page_AddLayer_ex2<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
    GraphPage gp;
    gp.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"origin"</span><span style="color: #000000;">)</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> gp <span style="color: #000000;">)</span>
    <span style="color: #000000;">{</span>
        <span style="color: #0000ff;">int</span> nn <span style="color: #000080;">=</span> gp.<span style="color: #000000;">AddLayer</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Test"</span><span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> nn <span style="color: #000080;">&gt;=</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
            GraphLayer gl <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span>nn<span style="color: #000000;">)</span>;
            <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> gl <span style="color: #000000;">)</span>
                <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"A new layer named %s was added<span style="color: #666666; font-weight: bold;">\n</span>"</span>, gl.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
        <span style="color: #000000;">}</span>
    <span style="color: #000000;">}</span>
<span style="color: #000000;">}</span>
</pre>

  <p><b>EX3</b></p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #008000;">// Add a Layer by loading a template sheet into the current workbook</span>
<span style="color: #0000ff;">int</span> Page_AddLayer_ex3<span style="color: #000000;">(</span>string strTemplate<span style="color: #000080;">=</span><span style="color: #ff00ff;">"origin"</span>, <span style="color: #0000ff;">bool</span> bUseDefaultIfNotFound <span style="color: #000080;">=</span> <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
    WorksheetPage wp <span style="color: #000080;">=</span> Project.<span style="color: #000000;">Pages</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #000040;">!</span>wp <span style="color: #000000;">)</span>
        <span style="color: #0000ff;">return</span> <span style="color: #0000dd;">0</span>;
    DWORD dwCntrl <span style="color: #000080;">=</span> bUseDefaultIfNotFound ? <span style="color: #0000dd;">0</span> <span style="color: #000000;">:</span> CREATE_NO_DEFAULT_TEMPLATE;
    <span style="color: #0000ff;">int</span> nn <span style="color: #000080;">=</span> wp.<span style="color: #000000;">AddLayer</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Test1"</span>, dwCntrl, strTemplate<span style="color: #000000;">)</span>; <span style="color: #008000;">// Created worksheet(layer) will be named Test1, Test2 etc.</span>
    <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> nn <span style="color: #000080;">&lt;</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">)</span>
        <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Failed to add a new sheet<span style="color: #666666; font-weight: bold;">\n</span>"</span><span style="color: #000000;">)</span>;
    <span style="color: #0000ff;">else</span>
    <span style="color: #000000;">{</span>
        Worksheet wks <span style="color: #000080;">=</span> wp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span>nn<span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> wks <span style="color: #000000;">)</span>
            <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"New sheet added index = %d, name = %s, # cols = %d<span style="color: #666666; font-weight: bold;">\n</span>"</span>, nn, wks.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>, wks.<span style="color: #000000;">GetNumCols</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
    <span style="color: #000000;">}</span>
    <span style="color: #0000ff;">return</span> <span style="color: #0000dd;">0</span>;
<span style="color: #000000;">}</span>
</pre>

  <p><b>EX4</b></p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #008000;">//Copy an existing Layer from one page to another</span>
<span style="color: #0000ff;">void</span> Page_AddLayer_ex4<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
    GraphPage gpTo; 
    gpTo.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
    GraphPage gpFrom;
    gpFrom.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
 
    <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> gpTo <span style="color: #000040;">&amp;&amp;</span> gpFrom <span style="color: #000000;">)</span>
    <span style="color: #000000;">{</span>
        GraphLayer glFrom <span style="color: #000080;">=</span> gpFrom.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">int</span> nn <span style="color: #000080;">=</span> gpTo.<span style="color: #000000;">AddLayer</span><span style="color: #000000;">(</span>glFrom<span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> nn <span style="color: #000080;">&gt;=</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
            GraphLayer glTo <span style="color: #000080;">=</span> gpTo.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span>nn<span style="color: #000000;">)</span>;
            <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> glTo <span style="color: #000000;">)</span>
                <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"A new layer named %s was added to %s<span style="color: #666666; font-weight: bold;">\n</span>"</span>, glTo.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>, gpTo.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
        <span style="color: #000000;">}</span>
    <span style="color: #000000;">}</span>
<span style="color: #000000;">}</span>
</pre>

  <p><b>EX5</b></p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #008000;">//Add a new layer copied from existing layer to worksheet page</span>
<span style="color: #0000ff;">int</span> Page_AddLayer_ex5<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
    GraphPage gp;
    gp.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"origin"</span><span style="color: #000000;">)</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> gp <span style="color: #000000;">)</span>
    <span style="color: #000000;">{</span>
        GraphLayer gl1 <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">int</span> nn <span style="color: #000080;">=</span> gp.<span style="color: #000000;">AddLayer</span><span style="color: #000000;">(</span>gl1<span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> nn <span style="color: #000080;">&gt;=</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
            GraphLayer gl2 <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span>nn<span style="color: #000000;">)</span>;
            <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> gl2 <span style="color: #000000;">)</span>
                <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"A new layer named %s was added to %s<span style="color: #666666; font-weight: bold;">\n</span>"</span>, gl2.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>, gp.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
        <span style="color: #000000;">}</span>
    <span style="color: #000000;">}</span>
    <span style="color: #0000ff;">return</span> <span style="color: #0000dd;">0</span>;
<span style="color: #000000;">}</span>
</pre>

  <p><b>EX6</b></p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #008000;">//Add a new layer copied from existing layer to worksheet page</span>
<span style="color: #0000ff;">int</span> Page_AddLayer_ex6<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
    <span style="color: #008000;">// Assume a workbook window exists in OPJ</span>
    WorksheetPage wp <span style="color: #000080;">=</span> Project.<span style="color: #000000;">Pages</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> wp <span style="color: #000000;">)</span>
    <span style="color: #000000;">{</span>
        Worksheet wks1 <span style="color: #000080;">=</span> wp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">int</span> nn <span style="color: #000080;">=</span> wp.<span style="color: #000000;">AddLayer</span><span style="color: #000000;">(</span>wks1<span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> nn <span style="color: #000080;">&gt;=</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
            Worksheet wks2 <span style="color: #000080;">=</span> wp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span>nn<span style="color: #000000;">)</span>;
            <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"A new layer named %s was added to %s, it's copied from %s.<span style="color: #666666; font-weight: bold;">\n</span>"</span>,wks2.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>, wp.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>, wks1.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
        <span style="color: #000000;">}</span>
    <span style="color: #000000;">}</span>
    <span style="color: #0000ff;">return</span> <span style="color: #0000dd;">0</span>;
<span style="color: #000000;">}</span>
</pre>

  <p><b>EX7</b></p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #008000;">//Create a new graph from 2 existing graphs by taking their respective 1st layer and </span>
<span style="color: #008000;">//arrange top bottom in new graph.</span>
<span style="color: #0000ff;">int</span> Page_AddLayer_ex7<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
    GraphPage gp1; 
    gp1.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
    GraphPage gp2;
    gp1.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
 
    GraphPage gpNew;
    gpNew.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"origin"</span>, CREATE_HIDDEN<span style="color: #000000;">)</span>;
    GraphLayer glFirst1 <span style="color: #000080;">=</span> gp1.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;
    GraphLayer glFirst2 <span style="color: #000080;">=</span> gp2.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;
 
    GraphLayer glTop <span style="color: #000080;">=</span> gpNew.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span>gpNew.<span style="color: #000000;">AddLayer</span><span style="color: #000000;">(</span>glFirst1<span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
    GraphLayer glBottom <span style="color: #000080;">=</span> gpNew.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span>gpNew.<span style="color: #000000;">AddLayer</span><span style="color: #000000;">(</span>glFirst2<span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
 
    <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> glTop <span style="color: #000040;">&amp;&amp;</span> glBottom <span style="color: #000000;">)</span>
    <span style="color: #000000;">{</span>
        <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Two new layers named %s and %s was added to %s<span style="color: #666666; font-weight: bold;">\n</span>"</span>, glTop.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>, glBottom.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>, gpNew.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
 
        string strLT;
        <span style="color: #0000ff;">int</span> nLeft<span style="color: #000080;">=</span><span style="color: #0000dd;">15</span>, nRight<span style="color: #000080;">=</span><span style="color: #0000dd;">10</span>, nWidth<span style="color: #000080;">=</span><span style="color: #0000dd;">35</span>, nHeight<span style="color: #000080;">=</span><span style="color: #0000dd;">35</span>;
        strLT.<span style="color: #000000;">Format</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"layer x y %d %d"</span>, nLeft, nRight<span style="color: #000000;">)</span>;
        glTop.<span style="color: #000000;">LT_execute</span><span style="color: #000000;">(</span>strLT<span style="color: #000000;">)</span>;
 
        nRight<span style="color: #000080;">=</span><span style="color: #0000dd;">50</span>;
        strLT.<span style="color: #000000;">Format</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"layer x y %d %d"</span>, nLeft, nRight<span style="color: #000000;">)</span>;
        glBottom.<span style="color: #000000;">LT_execute</span><span style="color: #000000;">(</span>strLT<span style="color: #000000;">)</span>;
 
        strLT.<span style="color: #000000;">Format</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"layer.width=%d"</span>, nWidth<span style="color: #000000;">)</span>;
        glTop.<span style="color: #000000;">LT_execute</span><span style="color: #000000;">(</span>strLT<span style="color: #000000;">)</span>;
        glBottom.<span style="color: #000000;">LT_execute</span><span style="color: #000000;">(</span>strLT<span style="color: #000000;">)</span>;
        strLT.<span style="color: #000000;">Format</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"layer.height=%d"</span>, nHeight<span style="color: #000000;">)</span>;
        glTop.<span style="color: #000000;">LT_execute</span><span style="color: #000000;">(</span>strLT<span style="color: #000000;">)</span>;
        glBottom.<span style="color: #000000;">LT_execute</span><span style="color: #000000;">(</span>strLT<span style="color: #000000;">)</span>;
 
    <span style="color: #000000;">}</span>
    gpNew.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>.<span style="color: #000000;">Destroy</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
    gpNew.<span style="color: #000000;">SetShow</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;

    <span style="color: #0000ff;">return</span> <span style="color: #0000dd;">0</span>;
<span style="color: #000000;">}</span>
</pre>

  <p><b>EX8</b></p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #008000;">// drag first sheet from Book1 to end of book2</span>
<span style="color: #0000ff;">void</span> Page_AddLayer_ex8<span style="color: #000000;">(</span>string strB1 <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"Book1"</span>, string strB2 <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"Book2"</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
    WorksheetPage w1<span style="color: #000000;">(</span>strB1<span style="color: #000000;">)</span>;
    WorksheetPage w2<span style="color: #000000;">(</span>strB2<span style="color: #000000;">)</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span><span style="color: #000040;">!</span>w1<span style="color: #000000;">)</span>
        <span style="color: #0000ff;">return</span>;
    Worksheet wks1 <span style="color: #000080;">=</span> w1.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span><span style="color: #000040;">!</span>wks1<span style="color: #000000;">)</span>
        <span style="color: #0000ff;">return</span>;
    
    <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span><span style="color: #000040;">!</span>w2<span style="color: #000000;">)</span>
    <span style="color: #000000;">{</span>
        w2.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"origin.otw"</span>, CREATE_VISIBLE<span style="color: #000000;">)</span>;
        Worksheet wks <span style="color: #000080;">=</span> w2.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;
        wks.<span style="color: #000000;">Destroy</span><span style="color: #000000;">(</span>OCD_DEL_LINKED_OBJS<span style="color: #000000;">)</span>;
    <span style="color: #000000;">}</span>
    
    w2.<span style="color: #000000;">AddLayer</span><span style="color: #000000;">(</span>wks1, DCTRL_ADD_LAYER_UNDOABLE, <span style="color: #0000ff;">false</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span>
</pre>

  <p><b>EX9</b></p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #008000;">// merge all books in current folder and move all their sheets to the</span>
<span style="color: #008000;">// specified book. If no book is specified, then merge to the active book in folder</span>
<span style="color: #0000ff;">void</span> Page_AddLayer_ex9<span style="color: #000000;">(</span>string strBook <span style="color: #000080;">=</span> <span style="color: #ff00ff;">""</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
        WorksheetPage wb<span style="color: #000000;">(</span>strBook<span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span><span style="color: #000040;">!</span>wb<span style="color: #000000;">)</span>
                wb <span style="color: #000080;">=</span> Project.<span style="color: #000000;">Pages</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
        
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span><span style="color: #000040;">!</span>wb<span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
                out_str<span style="color: #000000;">(</span><span style="color: #ff00ff;">"no valid book found to merge into"</span><span style="color: #000000;">)</span>;
                <span style="color: #0000ff;">return</span>;
        <span style="color: #000000;">}</span>
        wb.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span>strBook<span style="color: #000000;">)</span>;
        
        string strTemp;
        
        Folder fld <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveFolder</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; 
    foreach<span style="color: #000000;">(</span>PageBase pb in fld.<span style="color: #000000;">Pages</span><span style="color: #000000;">)</span>
    <span style="color: #000000;">{</span>
        WorksheetPage wb1 <span style="color: #000080;">=</span> pb;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span><span style="color: #000040;">!</span>wb1<span style="color: #000000;">)</span>
                <span style="color: #0000ff;">continue</span>;<span style="color: #008000;">//not a workbook</span>
        wb1.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span>strTemp<span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span>strTemp <span style="color: #000080;">==</span> strBook<span style="color: #000000;">)</span>
                <span style="color: #0000ff;">continue</span>;<span style="color: #008000;">//skip our destination book</span>
        
        foreach<span style="color: #000000;">(</span>Layer lay in wb1.<span style="color: #000000;">Layers</span><span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
                Worksheet wks <span style="color: #000080;">=</span> lay;
                wb.<span style="color: #000000;">AddLayer</span><span style="color: #000000;">(</span>wks, <span style="color: #0000dd;">0</span>, <span style="color: #0000ff;">false</span><span style="color: #000000;">)</span>;
        <span style="color: #000000;">}</span>
        wb1.<span style="color: #000000;">Destroy</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
    <span style="color: #000000;">}</span>
<span style="color: #000000;">}</span>
</pre>

  <h2><a name="Remark"></a><span class="mw-headline">Remark</span></h2>

  <h2><a name="See_Also"></a><span class="mw-headline">See Also</span></h2>

  <h2><a name="header_to_Include"></a><span class="mw-headline">header to Include</span></h2>

  <p>origin.h</p>
