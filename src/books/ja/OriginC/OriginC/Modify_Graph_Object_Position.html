<h1 class="firstheading">Modify Graph Object Position</h1>

  <p>&#160;</p>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>Contents</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1"><a href="#Version_Info"><span class="tocnumber">1</span> <span class="toctext">Version Info</span></a></li>

      <li class="toclevel-1 tocsection-2"><a href="#Modify_Text_Position_by_Class"><span class="tocnumber">2</span> <span class="toctext">Modify Text Position by Class</span></a></li>

      <li class="toclevel-1 tocsection-3"><a href="#Modify_Text_Position_by_Theme_Tree"><span class="tocnumber">3</span> <span class="toctext">Modify Text Position by Theme Tree</span></a></li>

      <li class="toclevel-1 tocsection-4"><a href="#Modify_Rectangle_Position_by_Theme_Tree"><span class="tocnumber">4</span> <span class="toctext">Modify Rectangle Position by Theme Tree</span></a></li>

      <li class="toclevel-1 tocsection-5"><a href="#Modify_Vertices_of_a_Polygon"><span class="tocnumber">5</span> <span class="toctext">Modify Vertices of a Polygon</span></a></li>

      <li class="toclevel-1 tocsection-6"><a href="#Mofidy_Graph_Object_Position_on_Newly_Created_Graph_Window"><span class="tocnumber">6</span> <span class="toctext">Mofidy Graph Object Position on Newly Created Graph Window</span></a></li>

      <li class="toclevel-1 tocsection-7">
        <a href="#Get_Real_World_.28Axes.29_Coordinates_of_Graph_Object"><span class="tocnumber">7</span> <span class="toctext">Get Real World (Axes) Coordinates of Graph Object</span></a>

        <ul>
          <li class="toclevel-2 tocsection-8"><a href="#Line"><span class="tocnumber">7.1</span> <span class="toctext">Line</span></a></li>
        </ul>
      </li>
    </ul>
  </div>

  <p>&#160;</p>

  <h2><a name="Version_Info"></a><span class="mw-headline">Version Info</span></h2>

  <p class="version">Minimum Origin Version Required: Origin 8 SR0</p>

  <h2><a name="Modify_Text_Position_by_Class"></a><span class="mw-headline">Modify Text Position by Class</span></h2>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #008000;">// modify Text object position by methods in GraphObject class</span>
<span style="color: #0000ff;">void</span>    Set_Text_Pos_ex1<span style="color: #000000;">(</span>string strName <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"MyText"</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
    GraphLayer          gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;    
    <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> gl <span style="color: #000000;">)</span>
    <span style="color: #000000;">{</span>
        GraphObject     grobj <span style="color: #000080;">=</span> gl.<span style="color: #000000;">GraphObjects</span><span style="color: #000000;">(</span>strName<span style="color: #000000;">)</span>;   <span style="color: #008000;">// Get the graphic object by name</span>
            <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> grobj <span style="color: #000000;">)</span>
            <span style="color: #000000;">{</span>  
                grobj.<span style="color: #000000;">Attach</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>; <span style="color: #008000;">// attach to axes scales</span>
                grobj.<span style="color: #000000;">X</span> <span style="color: #000080;">=</span> gl.<span style="color: #000000;">X</span>.<span style="color: #000000;">From</span> <span style="color: #000040;">+</span> grobj.<span style="color: #000000;">DX</span> <span style="color: #000040;">/</span> <span style="color: #0000dd;">2.0</span>;   <span style="color: #008000;">// grobj.X is the X coordinate of the center of the object </span>
                grobj.<span style="color: #000000;">Y</span> <span style="color: #000080;">=</span> gl.<span style="color: #000000;">Y</span>.<span style="color: #000000;">To</span> <span style="color: #000040;">-</span> grobj.<span style="color: #000000;">DY</span> <span style="color: #000040;">/</span> <span style="color: #0000dd;">2.0</span>;             <span style="color: #008000;">// grobj.Y is the Y coordinate of the center of the object </span>
            <span style="color: #000000;">}</span>
    <span style="color: #000000;">}</span>
<span style="color: #000000;">}</span>
</pre>

  <h2><a name="Modify_Text_Position_by_Theme_Tree"></a><span class="mw-headline">Modify Text Position by Theme Tree</span></h2>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #008000;">// modify Text object position by Theme Tree</span>
<span style="color: #0000ff;">void</span>    Set_Text_Pos_ex2<span style="color: #000000;">(</span>string strName <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"MyText"</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
    GraphLayer          gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;    
    <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> gl <span style="color: #000000;">)</span>
    <span style="color: #000000;">{</span>
        GraphObject     grobj <span style="color: #000080;">=</span> gl.<span style="color: #000000;">GraphObjects</span><span style="color: #000000;">(</span>strName<span style="color: #000000;">)</span>;
            <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> grobj <span style="color: #000000;">)</span>
            <span style="color: #000000;">{</span>
                Tree tr;
                tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimension</span>.<span style="color: #000000;">Units</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>;
                tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimension</span>.<span style="color: #000000;">Attachment</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;    <span style="color: #008000;">// attach to axes scales</span>
                tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimension</span>.<span style="color: #000000;">Left</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> gl.<span style="color: #000000;">X</span>.<span style="color: #000000;">From</span>;
                tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimension</span>.<span style="color: #000000;">Top</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> gl.<span style="color: #000000;">Y</span>.<span style="color: #000000;">To</span>;
                <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> grobj.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">(</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
                <span style="color: #000000;">{</span>
                        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> grobj.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">(</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
                                gl.<span style="color: #000000;">GetPage</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>.<span style="color: #000000;">Refresh</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
                <span style="color: #000000;">}</span>
            <span style="color: #000000;">}</span>
    <span style="color: #000000;">}</span>
<span style="color: #000000;">}</span>
</pre>

  <h2><a name="Modify_Rectangle_Position_by_Theme_Tree"></a><span class="mw-headline">Modify Rectangle Position by Theme Tree</span></h2>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #008000;">// Modify rectangle graph object position and size</span>
<span style="color: #0000ff;">void</span>    Set_Rect_Pos_ex1<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
        GraphPage gp;
        gp.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Origin"</span><span style="color: #000000;">)</span>;
        GraphLayer gl <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
        
        <span style="color: #008000;">// create a graph object</span>
        string          strName <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"MyRect"</span>;
        GraphObject goText <span style="color: #000080;">=</span> gl.<span style="color: #000000;">CreateGraphObject</span><span style="color: #000000;">(</span>GROT_RECT<span style="color: #000000;">)</span>;
        goText.<span style="color: #000000;">SetName</span><span style="color: #000000;">(</span>strName<span style="color: #000000;">)</span>;
        
    GraphObject grobj <span style="color: #000080;">=</span> gl.<span style="color: #000000;">GraphObjects</span><span style="color: #000000;">(</span>strName<span style="color: #000000;">)</span>; <span style="color: #008000;">// get this text by name</span>
    <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> grobj <span style="color: #000000;">)</span>
    <span style="color: #000000;">{</span>
        <span style="color: #008000;">// change position and size by theme tree</span>
        Tree tr;  
        tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimension</span>.<span style="color: #000000;">Units</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>; <span style="color: #008000;">//UNITS_INCH = 0, UNITS_CM = 1, UNITS_MM = 2, UNITS_PIXEL = 3, UNITS_POINT = 4, UNITS_SCALE = 5</span>
        tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimension</span>.<span style="color: #000000;">Attachment</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;  <span style="color: #008000;">// attach to axes scales</span>
        
        <span style="color: #0000ff;">double</span> left <span style="color: #000080;">=</span> gl.<span style="color: #000000;">X</span>.<span style="color: #000000;">From</span>;
        <span style="color: #0000ff;">double</span> right <span style="color: #000080;">=</span> <span style="color: #000000;">(</span>gl.<span style="color: #000000;">X</span>.<span style="color: #000000;">To</span> <span style="color: #000040;">-</span> gl.<span style="color: #000000;">X</span>.<span style="color: #000000;">From</span><span style="color: #000000;">)</span> <span style="color: #000040;">/</span> <span style="color: #0000dd;">2</span>;
        <span style="color: #0000ff;">double</span> bottom <span style="color: #000080;">=</span> gl.<span style="color: #000000;">Y</span>.<span style="color: #000000;">To</span>;
        <span style="color: #0000ff;">double</span> top <span style="color: #000080;">=</span> <span style="color: #000000;">(</span>gl.<span style="color: #000000;">Y</span>.<span style="color: #000000;">To</span> <span style="color: #000040;">-</span> gl.<span style="color: #000000;">Y</span>.<span style="color: #000000;">From</span><span style="color: #000000;">)</span> <span style="color: #000040;">/</span> <span style="color: #0000dd;">2</span>;
        tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimension</span>.<span style="color: #000000;">Left</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> left;
        tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimension</span>.<span style="color: #000000;">Top</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> top;
        tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimension</span>.<span style="color: #000000;">Width</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> right <span style="color: #000040;">-</span> left;
        tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimension</span>.<span style="color: #000000;">Height</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> top <span style="color: #000040;">-</span> bottom;
      
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> grobj.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">(</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span> <span style="color: #008000;">// updated IDs to treenodes</span>
        <span style="color: #000000;">{</span>
            <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> grobj.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">(</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
            <span style="color: #000000;">{</span>
                gl.<span style="color: #000000;">GetPage</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>.<span style="color: #000000;">Refresh</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
            <span style="color: #000000;">}</span>
        <span style="color: #000000;">}</span>
    <span style="color: #000000;">}</span>    
<span style="color: #000000;">}</span>
</pre>

  <h2><a name="Modify_Vertices_of_a_Polygon"></a><span class="mw-headline">Modify Vertices of a Polygon</span></h2>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #008000;">// this example shows how to modify the vertices of an existing polygon object</span>
<span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>..\Originlab\grobj_utils.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span>
<span style="color: #0000ff;">void</span> graph_object_modify_polygon_ex<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
    <span style="color: #008000;">// Assume graph layer is active and polgon object named "polygon" exists</span>
    GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;     
    GraphObject go;
    go <span style="color: #000080;">=</span> gl.<span style="color: #000000;">GraphObjects</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"polygon"</span><span style="color: #000000;">)</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> go <span style="color: #000000;">)</span>
    <span style="color: #000000;">{</span>
        go.<span style="color: #000000;">Attach</span> <span style="color: #000080;">=</span> ATTACH_TO_SCALE;
        
        <span style="color: #008000;">// Get format to tree</span>
        Tree tr;
        tr <span style="color: #000080;">=</span> go.<span style="color: #000000;">GetFormat</span><span style="color: #000000;">(</span>FPB_DATA, FOB_ALL, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// FPB_DATA bit to control the accessing of vertices of graph object</span>
 
        <span style="color: #008000;">// Get current vertices</span>
        vector vx, vy;
        vx <span style="color: #000080;">=</span> tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Data</span>.<span style="color: #000000;">X</span>.<span style="color: #000000;">dVals</span>;
        vy <span style="color: #000080;">=</span> tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Data</span>.<span style="color: #000000;">Y</span>.<span style="color: #000000;">dVals</span>;
 
        <span style="color: #008000;">// Make some chagnes to vertex values</span>
        <span style="color: #008000;">// Note: It is assumed here that the polygon object is attached to Layer and Scale, otherwise changing the vertices</span>
        <span style="color: #008000;">// by scaling may place the object outside of page</span>
        vx <span style="color: #000040;">+</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>; <span style="color: #008000;">// Add some offset to x</span>
        vy <span style="color: #000040;">/</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>; <span style="color: #008000;">// Scale the y vertices</span>
 
        <span style="color: #008000;">// Set vectors back to tree</span>
        tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Data</span>.<span style="color: #000000;">X</span>.<span style="color: #000000;">dVals</span> <span style="color: #000080;">=</span> vx;
        tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Data</span>.<span style="color: #000000;">Y</span>.<span style="color: #000000;">dVals</span> <span style="color: #000080;">=</span> vy;
        
        <span style="color: #008000;">// Set format to apply changes to object</span>
        <span style="color: #0000ff;">int</span> nErr <span style="color: #000080;">=</span> go.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">(</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span>nErr <span style="color: #000080;">==</span> <span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
            go.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">(</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>;
        <span style="color: #000000;">}</span>
        <span style="color: #0000ff;">else</span>
        <span style="color: #000000;">{</span>
            out_int<span style="color: #000000;">(</span><span style="color: #ff00ff;">"err = "</span>, nErr<span style="color: #000000;">)</span>;
        <span style="color: #000000;">}</span>
    <span style="color: #000000;">}</span>    
<span style="color: #000000;">}</span>
</pre>

  <h2><a name="Mofidy_Graph_Object_Position_on_Newly_Created_Graph_Window"></a><span class="mw-headline">Mofidy Graph Object Position on Newly Created Graph Window</span></h2>

  <p>Please notice the LT command <b>doc -UWF</b> in following example function. This command used to force to update window to draw newly created window, however, the position of XB(X axis title), YL(Y axis title) and so on will be wrong. Once you want to get the real position of build-in graph object in newly created window, like XB, YL, Legend, need to call this command before getting position.</p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">void</span> Set_Line_Pos_ex1<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>   
   <span style="color: #008000;">// create page and get first layer</span>
   GraphPage oPage;
   oPage.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Origin"</span><span style="color: #000000;">)</span>;
   GraphLayer oLayer <span style="color: #000080;">=</span> oPage.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;

   LT_execute<span style="color: #000000;">(</span><span style="color: #ff00ff;">"doc -UWF;"</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// force update window to draw however the position of XB would be wrong</span>
   
   <span style="color: #008000;">// get the Y position of the x axis title</span>
   GraphObject goXB <span style="color: #000080;">=</span> oLayer.<span style="color: #000000;">GraphObjects</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"XB"</span><span style="color: #000000;">)</span>;    
   <span style="color: #0000ff;">double</span> dY <span style="color: #000080;">=</span> goXB.<span style="color: #000000;">Y</span>;
   <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Y-position of XB (%f) <span style="color: #666666; font-weight: bold;">\n</span>"</span>, dY<span style="color: #000000;">)</span>;

   <span style="color: #008000;">// add line graph object </span>
   GraphObject goLine <span style="color: #000080;">=</span> oLayer.<span style="color: #000000;">CreateGraphObject</span><span style="color: #000000;">(</span>GROT_LINE<span style="color: #000000;">)</span>;
   
   <span style="color: #008000;">// format line</span>
   Tree tr;
   tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimension</span>.<span style="color: #000000;">Attachment</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>; <span style="color: #008000;">// 2: layer and scale</span>
   tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Direction</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
   tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Span</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
   <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> goLine.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">(</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
                goLine.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">(</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>;
   
   <span style="color: #008000;">// to set the position of the line to the Y position of the X-axis label</span>
   goLine.<span style="color: #000000;">Y</span> <span style="color: #000080;">=</span> dY;
<span style="color: #000000;">}</span>
</pre>

  <h2><a name="Get_Real_World_.28Axes.29_Coordinates_of_Graph_Object"></a><span class="mw-headline">Get Real World (Axes) Coordinates of Graph Object</span></h2>

  <p>Since object.x, object.y etc are not in real world coordinates but converted from pixel positions, and as a result, they do not have the precision to reflect the real values that the object has been set with. From LabTalk, you can access the real axes coordinates array by <i>object.x#</i> and <i>object.y#</i>, where <i>x#</i> and <i>y#</i> are the real position of the #th point of an object. Straight lines and arrows have 2 points, rectangles and circles have 4 points and other objects may have many points. In the following example, the same axes positions can be gotten by Origin C code as these LabTalk commands read.</p>

  <h3><a name="Line"></a><span class="mw-headline">Line</span></h3>

  <p>To run this example, a graph window must exist in the project and the active layer in the graph should contain a vertical line named "VLine". To get these requirements, run the following LabTalk script first.</p>
  <pre class="lt" style="font-family:monospace;">
win <span style="color: #000080;">-</span>n plot;
draw <span style="color: #000080;">-</span>n VLine <span style="color: #000080;">-</span>d <span style="color: #0000dd;">0</span> <span style="color: #000080;">-</span>l <span style="color: #000080;">-</span>v <span style="color: #0000dd;">5</span>;
</pre>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">void</span> Get_Graph_Object_Axes_Pos_ex1<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
    <span style="color: #008000;">// get the active layer</span>
    GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span>gl<span style="color: #000000;">)</span>  <span style="color: #008000;">// if the active layer exist</span>
    <span style="color: #000000;">{</span>
        <span style="color: #008000;">// get the line "VLine"</span>
        GraphObject goLine <span style="color: #000080;">=</span> gl.<span style="color: #000000;">GraphObjects</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"VLine"</span><span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span>goLine<span style="color: #000000;">)</span>    <span style="color: #008000;">// if the line exist</span>
        <span style="color: #000000;">{</span>
            Tree trFormat;    <span style="color: #008000;">// define a Tree variable</span>
            
            <span style="color: #008000;">// FPB_DATA is not part of FPB_ALL, as getting data is slower so must explicitly ask</span>
            trFormat <span style="color: #000080;">=</span> goLine.<span style="color: #000000;">GetFormat</span><span style="color: #000000;">(</span>FPB_DATA, FOB_OBJECT, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>;
 
            vector vX, vY;  <span style="color: #008000;">// define two vector to hold positions of X and Y</span>
            vX <span style="color: #000080;">=</span> trFormat.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Data</span>.<span style="color: #000000;">X</span>.<span style="color: #000000;">dVals</span>;   <span style="color: #008000;">// get X positions</span>
            vY <span style="color: #000080;">=</span> trFormat.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Data</span>.<span style="color: #000000;">Y</span>.<span style="color: #000000;">dVals</span>;   <span style="color: #008000;">// get Y positions</span>
            
            <span style="color: #0000ff;">for</span><span style="color: #000000;">(</span><span style="color: #0000ff;">int</span> i<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>; i<span style="color: #000080;">&lt;</span>vX.<span style="color: #000000;">GetSize</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; i<span style="color: #000040;">++</span><span style="color: #000000;">)</span>  <span style="color: #008000;">// loop to print X and Y positions</span>
            <span style="color: #000000;">{</span>
                <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"<span style="color: #666666; font-weight: bold;">\n</span>x[%d]=%f,  y[%d]=%f"</span>, i, vX<span style="color: #000000;">[</span>i<span style="color: #000000;">]</span>, i, vY<span style="color: #000000;">[</span>i<span style="color: #000000;">]</span><span style="color: #000000;">)</span>;
            <span style="color: #000000;">}</span>
        <span style="color: #000000;">}</span>
        <span style="color: #0000ff;">else</span>   <span style="color: #008000;">// if the line not exist</span>
        <span style="color: #000000;">{</span>
            out_str<span style="color: #000000;">(</span><span style="color: #ff00ff;">"No graph object named <span style="color: #666666; font-weight: bold;">\"</span>VLine<span style="color: #666666; font-weight: bold;">\"</span> exists!"</span><span style="color: #000000;">)</span>;
        <span style="color: #000000;">}</span>
    <span style="color: #000000;">}</span>
    <span style="color: #0000ff;">else</span>   <span style="color: #008000;">// if active graph layer not exist</span>
    <span style="color: #000000;">{</span>
        out_str<span style="color: #000000;">(</span><span style="color: #ff00ff;">"No graph layer is active!"</span><span style="color: #000000;">)</span>;
    <span style="color: #000000;">}</span> 
<span style="color: #000000;">}</span>
</pre>
