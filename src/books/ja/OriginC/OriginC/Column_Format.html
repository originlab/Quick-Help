<h1 class="firstheading">Column Format</h1>

  <p>&#160;</p>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>Contents</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1"><a href="#Version_Info"><span class="tocnumber">1</span> <span class="toctext">Version Info</span></a></li>

      <li class="toclevel-1 tocsection-2"><a href="#Get_Column_Type"><span class="tocnumber">2</span> <span class="toctext">Get Column Type</span></a></li>

      <li class="toclevel-1 tocsection-3"><a href="#Set_Column_Type"><span class="tocnumber">3</span> <span class="toctext">Set Column Type</span></a></li>

      <li class="toclevel-1 tocsection-4"><a href="#Get_Column_Format"><span class="tocnumber">4</span> <span class="toctext">Get Column Format</span></a></li>

      <li class="toclevel-1 tocsection-5"><a href="#Set_Column_Format"><span class="tocnumber">5</span> <span class="toctext">Set Column Format</span></a></li>

      <li class="toclevel-1 tocsection-6"><a href="#Get_Column_SubFormat"><span class="tocnumber">6</span> <span class="toctext">Get Column SubFormat</span></a></li>

      <li class="toclevel-1 tocsection-7"><a href="#Set_Column_SubFormat"><span class="tocnumber">7</span> <span class="toctext">Set Column SubFormat</span></a></li>

      <li class="toclevel-1 tocsection-8"><a href="#Set_Column_Justification"><span class="tocnumber">8</span> <span class="toctext">Set Column Justification</span></a></li>

      <li class="toclevel-1 tocsection-9"><a href="#Set_Column_Internal_Data_Type"><span class="tocnumber">9</span> <span class="toctext">Set Column Internal Data Type</span></a></li>

      <li class="toclevel-1 tocsection-10"><a href="#Set_Column_Digit_Mode"><span class="tocnumber">10</span> <span class="toctext">Set Column Digit Mode</span></a></li>

      <li class="toclevel-1 tocsection-11"><a href="#Set_Column_Digit_Value"><span class="tocnumber">11</span> <span class="toctext">Set Column Digit Value</span></a></li>

      <li class="toclevel-1 tocsection-12"><a href="#Set_Column_Custom_Display"><span class="tocnumber">12</span> <span class="toctext">Set Column Custom Display</span></a></li>

      <li class="toclevel-1 tocsection-13"><a href="#Check_Column_Is_Even_Sampling"><span class="tocnumber">13</span> <span class="toctext">Check Column Is Even Sampling</span></a></li>

      <li class="toclevel-1 tocsection-14"><a href="#Check_Column_Is_Write_Protected"><span class="tocnumber">14</span> <span class="toctext">Check Column Is Write Protected</span></a></li>
    </ul>
  </div>

  <h2><a name="Version_Info"></a><span class="mw-headline">Version Info</span></h2>

  <p class="version">Minimum Origin Version Required: Origin8 SR0</p>

  <h2><a name="Get_Column_Type"></a><span class="mw-headline">Get Column Type</span></h2>

  <p>You can use <a href="../../OriginC/OriginC/Column-GetType.html" title="OriginC:Column-GetType">Column::GetType</a> to get the type designator of a column.</p>

  <h2><a name="Set_Column_Type"></a><span class="mw-headline">Set Column Type</span></h2>

  <p>This example shows how to Set the type of column in worksheet.</p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">void</span> column_set_type<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
        Worksheet wks;
    wks.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Origin"</span>, CREATE_VISIBLE<span style="color: #000000;">)</span>;
    
    wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>.<span style="color: #000000;">SetType</span><span style="color: #000000;">(</span>OKDATAOBJ_DESIGNATION_X<span style="color: #000000;">)</span>; <span style="color: #008000;">// An X column</span>
    
    wks.<span style="color: #000000;">AddCol</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
    wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">(</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span>.<span style="color: #000000;">SetType</span><span style="color: #000000;">(</span>OKDATAOBJ_DESIGNATION_Y<span style="color: #000000;">)</span>; <span style="color: #008000;">// A Y column</span>
    <span style="color: #008000;">// Note that sequence is forced by internal check that won't allow X Err without Y column in worksheet</span>
    wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>.<span style="color: #000000;">SetType</span><span style="color: #000000;">(</span>OKDATAOBJ_DESIGNATION_X_ERROR<span style="color: #000000;">)</span>; <span style="color: #008000;">// An X Err column</span>
    
    wks.<span style="color: #000000;">AddCol</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
    wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">(</span><span style="color: #0000dd;">3</span><span style="color: #000000;">)</span>.<span style="color: #000000;">SetType</span><span style="color: #000000;">(</span>OKDATAOBJ_DESIGNATION_ERROR<span style="color: #000000;">)</span>; <span style="color: #008000;">// A Y Err column</span>
    
    wks.<span style="color: #000000;">AddCol</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
    wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">(</span><span style="color: #0000dd;">4</span><span style="color: #000000;">)</span>.<span style="color: #000000;">SetType</span><span style="color: #000000;">(</span>OKDATAOBJ_DESIGNATION_L<span style="color: #000000;">)</span>; <span style="color: #008000;">// A Label column</span>
    
    wks.<span style="color: #000000;">AddCol</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
    wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">(</span><span style="color: #0000dd;">5</span><span style="color: #000000;">)</span>.<span style="color: #000000;">SetType</span><span style="color: #000000;">(</span>OKDATAOBJ_DESIGNATION_Z<span style="color: #000000;">)</span>; <span style="color: #008000;">// A Z column</span>
    
    wks.<span style="color: #000000;">AddCol</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
    wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">(</span><span style="color: #0000dd;">6</span><span style="color: #000000;">)</span>.<span style="color: #000000;">SetType</span><span style="color: #000000;">(</span>OKDATAOBJ_DESIGNATION_NONE<span style="color: #000000;">)</span>; <span style="color: #008000;">// A Disregard column</span>
<span style="color: #000000;">}</span>
</pre>

  <h2><a name="Get_Column_Format"></a><span class="mw-headline">Get Column Format</span></h2>

  <p>You can use <a href="../../OriginC/OriginC/Column-GetFormat.html" title="OriginC:Column-GetFormat">Column::GetFormat</a> to get the type of format of a column.</p>

  <h2><a name="Set_Column_Format"></a><span class="mw-headline">Set Column Format</span></h2>

  <p>This example shows how to set the format of column in worksheet.</p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">void</span> column_set_format_ex<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
        Worksheet wks;
        wks.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Origin"</span><span style="color: #000000;">)</span>;
        
        <span style="color: #008000;">//set the format of column 1 as Numeric</span>
        <span style="color: #0000ff;">BOOL</span> bRet <span style="color: #000080;">=</span> wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>.<span style="color: #000000;">SetFormat</span><span style="color: #000000;">(</span>OKCOLTYPE_NUMERIC<span style="color: #000000;">)</span>; 
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> bRet <span style="color: #000000;">)</span>
                <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Format of column %s is of type %u<span style="color: #666666; font-weight: bold;">\n</span>"</span>, wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>, wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>.<span style="color: #000000;">GetFormat</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">else</span> 
                <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Failed to set format of column %s!<span style="color: #666666; font-weight: bold;">\n</span>"</span>, wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
        
        <span style="color: #008000;">//set the format of column 2 as text</span>
        bRet <span style="color: #000080;">=</span> wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>.<span style="color: #000000;">SetFormat</span><span style="color: #000000;">(</span>OKCOLTYPE_TEXT<span style="color: #000000;">)</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> bRet <span style="color: #000000;">)</span>
                <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Format of column %s is of type %u<span style="color: #666666; font-weight: bold;">\n</span>"</span>, wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>, wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>.<span style="color: #000000;">GetFormat</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">else</span> 
                <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Failed to set format of column %s!<span style="color: #666666; font-weight: bold;">\n</span>"</span>, wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span>
</pre>

  <h2><a name="Get_Column_SubFormat"></a><span class="mw-headline">Get Column SubFormat</span></h2>

  <p>You can use <a href="../../OriginC/OriginC/Column-GetSubFormat.html" title="OriginC:Column-GetSubFormat">Column::GetSubFormat</a> to get the type of subformat of a column.</p>

  <h2><a name="Set_Column_SubFormat"></a><span class="mw-headline">Set Column SubFormat</span></h2>

  <p>This example shows how to set the subformat of column in worksheet.</p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">void</span> column_set_subformat_ex<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
        Worksheet wks;
    wks.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Origin"</span><span style="color: #000000;">)</span>;
    
    wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>.<span style="color: #000000;">SetFormat</span><span style="color: #000000;">(</span>OKCOLTYPE_DATE<span style="color: #000000;">)</span>; <span style="color: #008000;">// Column Format is DATE</span>
    <span style="color: #0000ff;">BOOL</span> bRet <span style="color: #000080;">=</span> wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>.<span style="color: #000000;">SetSubFormat</span><span style="color: #000000;">(</span><span style="color: #0000dd;">13</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// The 14th SubFormat (value = 13) of DATE is yyMMdd HH:mm:ss</span>
    
    wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>.<span style="color: #000000;">SetFormat</span><span style="color: #000000;">(</span>OKCOLTYPE_NUMERIC<span style="color: #000000;">)</span>; <span style="color: #008000;">// Column Format is NUMERIC</span>
    bRet <span style="color: #000080;">=</span> wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>.<span style="color: #000000;">SetSubFormat</span><span style="color: #000000;">(</span><span style="color: #0000dd;">3</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// The 4th SubFormat (value = 3) of NUMERIC is Decimal: 1,000</span>
<span style="color: #000000;">}</span>
</pre>

  <h2><a name="Set_Column_Justification"></a><span class="mw-headline">Set Column Justification</span></h2>

  <p>This example shows how to set justification of a column. Please refer to <a href="../../OriginC/OriginC/Column-SetJustify.html" title="OriginC:Column-SetJustify">Column::SetJustify</a> for more details.</p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #008000;">//Before running this code, Worksheet with at least one column must exist in project.</span>
<span style="color: #0000ff;">void</span> column_set_justify_ex<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
        Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span><span style="color: #000040;">!</span>wks<span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
                <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Error. Please active worksheet before running!"</span><span style="color: #000000;">)</span>;
                <span style="color: #0000ff;">return</span>;
        <span style="color: #000000;">}</span>
        
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> wks.<span style="color: #000000;">GetNumCols</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
                <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Error. No columns to justify in the active worksheet!<span style="color: #666666; font-weight: bold;">\n</span>"</span><span style="color: #000000;">)</span>;
                <span style="color: #0000ff;">return</span>;
        <span style="color: #000000;">}</span>
        
        <span style="color: #0000ff;">int</span> iJustify <span style="color: #000080;">=</span> COL_JUSTIFY_RIGHT;
        <span style="color: #0000ff;">bool</span> bRet <span style="color: #000080;">=</span> wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>.<span style="color: #000000;">SetJustify</span><span style="color: #000000;">(</span>iJustify<span style="color: #000000;">)</span>;   <span style="color: #008000;">// Set justification to right for column 1</span>
        
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> bRet <span style="color: #000000;">)</span>
                <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Successfully set justify!<span style="color: #666666; font-weight: bold;">\n</span>"</span><span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">else</span>
                <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Failed to set justify!<span style="color: #666666; font-weight: bold;">\n</span>"</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span>
</pre>

  <h2><a name="Set_Column_Internal_Data_Type"></a><span class="mw-headline">Set Column Internal Data Type</span></h2>

  <p>This example shows how to set the column internal data type. Please refer to <a href="../../OriginC/OriginC/DataObject-SetInternalDataType.html" title="OriginC:DataObject-SetInternalDataType">DataObject::SetInternalDataType</a> for more details.</p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">void</span> column_set_internal_data_ex<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
    Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
    
    <span style="color: #0000ff;">int</span> nFormat <span style="color: #000080;">=</span> OKCOLTYPE_NUMERIC;
    <span style="color: #0000ff;">int</span> nType <span style="color: #000080;">=</span> FSI_SHORT;
 
    foreach<span style="color: #000000;">(</span>Column col in wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">)</span>
    <span style="color: #000000;">{</span>
        col.<span style="color: #000000;">SetFormat</span><span style="color: #000000;">(</span>nFormat<span style="color: #000000;">)</span>;          
        col.<span style="color: #000000;">SetInternalDataType</span><span style="color: #000000;">(</span>nType, OCD_RESET_VIEW <span style="color: #000040;">|</span> OCD_RESTORE<span style="color: #000000;">)</span>;
        <span style="color: #000000;">}</span>    
<span style="color: #000000;">}</span>
</pre>

  <h2><a name="Set_Column_Digit_Mode"></a><span class="mw-headline">Set Column Digit Mode</span></h2>

  <p>This example shows how to set the display mode used for numbers in a column. Please refer to <a href="../../OriginC/OriginC/Column-GetDigitMode.html" title="OriginC:Column-GetDigitMode">Column::GetDigitMode</a> for more details.</p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #008000;">//Before running this code, Worksheet with at least one column must exist in project.</span>
<span style="color: #0000ff;">void</span> column_set_digit_mode_ex<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
        Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span><span style="color: #000040;">!</span>wks<span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
                <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Error. Please active worksheet before running!"</span><span style="color: #000000;">)</span>;
                <span style="color: #0000ff;">return</span>;
        <span style="color: #000000;">}</span>

        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> wks.<span style="color: #000000;">GetNumCols</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
                <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Error. No columns exist in the active worksheet!<span style="color: #666666; font-weight: bold;">\n</span>"</span><span style="color: #000000;">)</span>;
                <span style="color: #0000ff;">return</span>;
        <span style="color: #000000;">}</span>
        
        <span style="color: #0000ff;">int</span> iDigitMode <span style="color: #000080;">=</span> DIGITS_DECIMAL;      <span style="color: #008000;">// set display mode decimal</span>
    <span style="color: #0000ff;">bool</span> bRet <span style="color: #000080;">=</span> wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>.<span style="color: #000000;">SetDigitMode</span><span style="color: #000000;">(</span>iDigitMode<span style="color: #000000;">)</span>;   <span style="color: #008000;">// Set the display mode of column 1</span>
    
    <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> bRet <span style="color: #000000;">)</span>
        <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Successfully set display mode for column %s<span style="color: #666666; font-weight: bold;">\n</span>"</span>, wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
    <span style="color: #0000ff;">else</span>
        <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Failed to set displey mode for column %s<span style="color: #666666; font-weight: bold;">\n</span>"</span>, wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span>
</pre>

  <h2><a name="Set_Column_Digit_Value"></a><span class="mw-headline">Set Column Digit Value</span></h2>

  <p>This example shows how to set the digit value for the numeric display mode.</p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #008000;">// Before running this code, Worksheet with at least one column must exist in project</span>
<span style="color: #0000ff;">void</span> Column_Set_Digits_Ex1<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
    Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span><span style="color: #000040;">!</span>wks<span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
                <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Error. Please active worksheet before running!"</span><span style="color: #000000;">)</span>;
                <span style="color: #0000ff;">return</span>;
        <span style="color: #000000;">}</span>

        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> wks.<span style="color: #000000;">GetNumCols</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
                <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Error. No columns exist in the active worksheet!<span style="color: #666666; font-weight: bold;">\n</span>"</span><span style="color: #000000;">)</span>;
                <span style="color: #0000ff;">return</span>;
        <span style="color: #000000;">}</span>
        
        wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>.<span style="color: #000000;">SetDigitMode</span><span style="color: #000000;">(</span>DIGITS_DECIMAL<span style="color: #000000;">)</span>;
    <span style="color: #0000ff;">bool</span> bRet <span style="color: #000080;">=</span> wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>.<span style="color: #000000;">SetDigits</span><span style="color: #000000;">(</span><span style="color: #0000dd;">10</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// set the number of digits in column 1 to 10</span>
    <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> bRet <span style="color: #000000;">)</span>
        <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Successfully set digits for column %s<span style="color: #666666; font-weight: bold;">\n</span>"</span>, wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
    <span style="color: #0000ff;">else</span>
        <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Failed to set digits for column %s<span style="color: #666666; font-weight: bold;">\n</span>"</span>, wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;   
<span style="color: #000000;">}</span>
</pre>

  <h2><a name="Set_Column_Custom_Display"></a><span class="mw-headline">Set Column Custom Display</span></h2>

  <p>This example shows how to set the custom date display format. This action is same as setup Custom Date Formats in Preference: Options : Miscellaneous.</p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #008000;">// Before running this code, Worksheet with at least one column must exist in project</span>
<span style="color: #0000ff;">void</span> column_set_custom_display_ex<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
    Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span><span style="color: #000040;">!</span>wks<span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
                <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Error. Please active worksheet before running!"</span><span style="color: #000000;">)</span>;
                <span style="color: #0000ff;">return</span>;
        <span style="color: #000000;">}</span>
 
    Column col<span style="color: #000000;">(</span>wks, <span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> col <span style="color: #000000;">)</span>
    <span style="color: #000000;">{</span>
        col.<span style="color: #000000;">SetFormat</span><span style="color: #000000;">(</span>OKCOLTYPE_DATE<span style="color: #000000;">)</span>;
        col.<span style="color: #000000;">SetSubFormat</span><span style="color: #000000;">(</span>LDF_OBJ_CUSTOM<span style="color: #000000;">)</span>; <span style="color: #008000;">// for "Custom Display"</span>
        <span style="color: #0000ff;">bool</span> bRet <span style="color: #000080;">=</span> col.<span style="color: #000000;">SetCustomDisplay</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"dd-mm-yy"</span><span style="color: #000000;">)</span>;
        
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> bRet <span style="color: #000000;">)</span>
            <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"The custom display format of Column %u is %s<span style="color: #666666; font-weight: bold;">\n</span>"</span>, col.<span style="color: #000000;">GetIndex</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000040;">+</span><span style="color: #0000dd;">1</span>, col.<span style="color: #000000;">GetCustomDisplay</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">else</span>
            <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Fail to set custom format to this column<span style="color: #666666; font-weight: bold;">\n</span>"</span><span style="color: #000000;">)</span>;
    <span style="color: #000000;">}</span>
<span style="color: #000000;">}</span>
</pre>

  <h2><a name="Check_Column_Is_Even_Sampling"></a><span class="mw-headline">Check Column Is Even Sampling</span></h2>

  <p>This example shows how to check if the column has even sampling and get the sampling information.</p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #008000;">// Before running this code, Worksheet with at least one column must exist in project</span>
<span style="color: #0000ff;">void</span> column_is_even_sampling_ex<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
    Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span><span style="color: #000040;">!</span>wks<span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
                <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Error. Please active worksheet before running!"</span><span style="color: #000000;">)</span>;
                <span style="color: #0000ff;">return</span>;
        <span style="color: #000000;">}</span>

    Column col <span style="color: #000080;">=</span> wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;
    <span style="color: #0000ff;">if</span> <span style="color: #000000;">(</span> <span style="color: #000040;">!</span>col <span style="color: #000000;">)</span>
    <span style="color: #000000;">{</span>
        <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Error. No columns in the active worksheet!<span style="color: #666666; font-weight: bold;">\n</span>"</span><span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">return</span>;
    <span style="color: #000000;">}</span>
 
    <span style="color: #0000ff;">double</span> dX0, dXInc;             <span style="color: #008000;">// used to receive the starting X value and the X increment value, if any</span>
    string strXUnits, strXLongName;             <span style="color: #008000;">//used to receive the X units name and the X long name, if any</span>
    <span style="color: #0000ff;">bool</span> bRet <span style="color: #000080;">=</span> col.<span style="color: #000000;">IsEvenSampling</span><span style="color: #000000;">(</span><span style="color: #000040;">&amp;</span>dX0, <span style="color: #000040;">&amp;</span>dXInc, strXUnits, strXLongName<span style="color: #000000;">)</span>;
    
    <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> bRet <span style="color: #000000;">)</span>
    <span style="color: #000000;">{</span>
        <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Column %s is even sampling.<span style="color: #666666; font-weight: bold;">\n</span>"</span>, col.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
        <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Start == %f<span style="color: #666666; font-weight: bold;">\n</span>Increment == %f<span style="color: #666666; font-weight: bold;">\n</span>Units == %s<span style="color: #666666; font-weight: bold;">\n</span>Long Name == %s<span style="color: #666666; font-weight: bold;">\n</span>"</span>,
            dX0, dXInc, strXUnits, strXLongName<span style="color: #000000;">)</span>;      <span style="color: #008000;">// print the the sampling information</span>
    <span style="color: #000000;">}</span>
    <span style="color: #0000ff;">else</span>
        <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Column %s is not even sampling.<span style="color: #666666; font-weight: bold;">\n</span>"</span>, col.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span>
</pre>

  <h2><a name="Check_Column_Is_Write_Protected"></a><span class="mw-headline">Check Column Is Write Protected</span></h2>

  <p>This example shows how to determine if a column is write protected.</p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #008000;">// Before running this code, Worksheet with at least one column must exist in project</span>
<span style="color: #0000ff;">void</span> column_is_write_protected_ex<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
    Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span><span style="color: #000040;">!</span>wks<span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
                <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Error. Please active worksheet before running!"</span><span style="color: #000000;">)</span>;
                <span style="color: #0000ff;">return</span>;
        <span style="color: #000000;">}</span>
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> wks.<span style="color: #000000;">GetNumCols</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
                <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Error. No columns in the worksheet!<span style="color: #666666; font-weight: bold;">\n</span>"</span><span style="color: #000000;">)</span>;
                <span style="color: #0000ff;">return</span>;
        <span style="color: #000000;">}</span>
    <span style="color: #0000ff;">BOOL</span> bRet;
    <span style="color: #008000;">// check each column in the worksheet if it's write protected.</span>
    foreach<span style="color: #000000;">(</span>Column col in wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">)</span>
    <span style="color: #000000;">{</span>
        bRet <span style="color: #000080;">=</span> col.<span style="color: #000000;">IsWriteProtected</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;      
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> bRet <span style="color: #000000;">)</span>
            <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Column %s is WRITE PROTECTED<span style="color: #666666; font-weight: bold;">\n</span>"</span>, col.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">else</span>
            <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Column %s is NOT write protected<span style="color: #666666; font-weight: bold;">\n</span>"</span>, col.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
    <span style="color: #000000;">}</span>
<span style="color: #000000;">}</span>
</pre>
