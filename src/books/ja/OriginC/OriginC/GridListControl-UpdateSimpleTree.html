<h1 class="firstheading">GridListControl::UpdateSimpleTree</h1>

  <p>&#160;</p>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>Contents</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>

      <li class="toclevel-1 tocsection-2"><a href="#Syntax"><span class="tocnumber">2</span> <span class="toctext">Syntax</span></a></li>

      <li class="toclevel-1 tocsection-3"><a href="#Parameters"><span class="tocnumber">3</span> <span class="toctext">Parameters</span></a></li>

      <li class="toclevel-1 tocsection-4"><a href="#Return"><span class="tocnumber">4</span> <span class="toctext">Return</span></a></li>

      <li class="toclevel-1 tocsection-5"><a href="#Examples"><span class="tocnumber">5</span> <span class="toctext">Examples</span></a></li>

      <li class="toclevel-1 tocsection-6"><a href="#Remark"><span class="tocnumber">6</span> <span class="toctext">Remark</span></a></li>

      <li class="toclevel-1 tocsection-7"><a href="#See_Also"><span class="tocnumber">7</span> <span class="toctext">See Also</span></a></li>

      <li class="toclevel-1 tocsection-8"><a href="#header_to_Included"><span class="tocnumber">8</span> <span class="toctext">header to Included</span></a></li>
    </ul>
  </div>

  <h2><a name="Description"></a><span class="mw-headline">Description</span></h2>

  <p>Update grid control by tree</p>

  <h2><a name="Syntax"></a><span class="mw-headline">Syntax</span></h2>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">void</span> UpdateSimpleTree<span style="color: #000000;">(</span> TreeNode <span style="color: #000040;">&amp;</span> tr, <span style="color: #0000ff;">int</span> nFromRow <span style="color: #000080;">=</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span> <span style="color: #000000;">)</span>
</pre>

  <h2><a name="Parameters"></a><span class="mw-headline">Parameters</span></h2>

  <dl>
    <dt>tr</dt>

    <dd>[input] TreeNode object that is used to generate the grid control</dd>

    <dt>nFromRow</dt>

    <dd>[input] if -1, means add from root, if not add from the row=nFromRow to add tr</dd>
  </dl>

  <h2><a name="Return"></a><span class="mw-headline">Return</span></h2>

  <h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>

  <p>his section describes how to open a dialog with grid control in Origin C. The examples in this section will use an existing grid dialog resource DLL that gets installed with Origin C's Developer Kit. The DLL can be found in <a class="external text" href="http://blog.originlab.com/wp-content/uploads/2017/01/DialogBuilderExamples.zip" target="_blank">this zip file</a>, under <i>\Dialog Builder\GridDLG</i> sub-folder.</p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>..\Originlab\DialogEx.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span>
<span style="color: #0000ff;">#include</span> <span style="color: #ff00ff;">"GridDLGRes.h"</span><span style="color: #008000;">// resource DLL header</span>


<span style="color: #0000ff;">class</span> ListCtrlDLG <span style="color: #000000;">:</span> <span style="color: #0000ff;">public</span> ResizeDialog
<span style="color: #000000;">{</span>
<span style="color: #0000ff;">public</span><span style="color: #000000;">:</span>
        ListCtrlDLG<span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000;">:</span> ResizeDialog<span style="color: #000000;">(</span>IDD_GRID_DLG, <span style="color: #ff00ff;">"GridDLG"</span><span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
        <span style="color: #000000;">}</span>

        <span style="color: #0000ff;">int</span> DoModal<span style="color: #000000;">(</span>HWND hParent <span style="color: #000080;">=</span> <span style="color: #0000ff;">NULL</span><span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
                InitMsgMap<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
                <span style="color: #0000ff;">int</span> nRet <span style="color: #000080;">=</span> ResizeDialog<span style="color: #000000;">::</span><span style="color: #000000;">DoModal</span><span style="color: #000000;">(</span>hParent<span style="color: #000000;">)</span>;
                <span style="color: #0000ff;">return</span> nRet;
        <span style="color: #000000;">}</span>

<span style="color: #0000ff;">protected</span><span style="color: #000000;">:</span>
<span style="color: #008000;">///----------------- Message Map ----------------</span>
        EVENTS_BEGIN
                ON_INIT<span style="color: #000000;">(</span>OnInitDialog<span style="color: #000000;">)</span>
                ON_SIZE<span style="color: #000000;">(</span>OnDlgResize<span style="color: #000000;">)</span>
                ON_GETMINMAXINFO<span style="color: #000000;">(</span>OnMinMaxInfo<span style="color: #000000;">)</span>
        EVENTS_END
<span style="color: #008000;">///----------------------------------------------</span>
        
        <span style="color: #0000ff;">BOOL</span> OnInitDialog<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
                ResizeDialog<span style="color: #000000;">::</span><span style="color: #000000;">OnInitDialog</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span>, <span style="color: #ff00ff;">"Grid Dialog"</span><span style="color: #000000;">)</span>;
                
                <span style="color: #008000;">//initialize grid control</span>
                m_ListCtrl.<span style="color: #000000;">Init</span><span style="color: #000000;">(</span>IDC_GRID, <span style="color: #000040;">*</span><span style="color: #0000ff;">this</span><span style="color: #000000;">)</span>;
                
                <span style="color: #008000;">//move grid control to top left</span>
                RECT rrList;    
                rrList.<span style="color: #000000;">top</span> <span style="color: #000080;">=</span> rrList.<span style="color: #000000;">left</span> <span style="color: #000080;">=</span> GetControlGap<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
                m_ListCtrl.<span style="color: #000000;">MoveWindow</span><span style="color: #000000;">(</span>rrList<span style="color: #000000;">)</span>;
                
                SetInitReady<span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
                
                <span style="color: #008000;">//use a tree to update GridListControl</span>
                m_ListCtrl.<span style="color: #000000;">AddCol</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
                m_ListCtrl.<span style="color: #000000;">SetOutlineBar</span><span style="color: #000000;">(</span>flexOutlineBarSimpleLeaf<span style="color: #000000;">)</span>;
                
                Tree trList;
                vector<span style="color: #000080;">&lt;</span>string<span style="color: #000080;">&gt;</span> vsWeekDays <span style="color: #000080;">=</span> <span style="color: #000000;">{</span><span style="color: #ff00ff;">"Morning"</span>, <span style="color: #ff00ff;">"Tuesday"</span>, <span style="color: #ff00ff;">"Wednesday"</span>, <span style="color: #ff00ff;">"Thursday"</span>, <span style="color: #ff00ff;">"Friday"</span>, <span style="color: #ff00ff;">"Saturday"</span>, <span style="color: #ff00ff;">"Sunday"</span><span style="color: #000000;">}</span>;  
                <span style="color: #0000ff;">for</span><span style="color: #000000;">(</span><span style="color: #0000ff;">int</span> ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; ii <span style="color: #000080;">&lt;</span> vsWeekDays.<span style="color: #000000;">GetSize</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; ii<span style="color: #000040;">++</span><span style="color: #000000;">)</span>
                <span style="color: #000000;">{</span>
                        trList.<span style="color: #000000;">AddNode</span><span style="color: #000000;">(</span>vsWeekDays<span style="color: #000000;">[</span>ii<span style="color: #000000;">]</span><span style="color: #000000;">)</span>;
                <span style="color: #000000;">}</span>
                trList.<span style="color: #000000;">FirstNode</span>.<span style="color: #000000;">AddNode</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Afternoon"</span><span style="color: #000000;">)</span>;
                
                m_ListCtrl.<span style="color: #000000;">UpdateSimpleTree</span><span style="color: #000000;">(</span>trList<span style="color: #000000;">)</span>;
                
                <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">TRUE</span>;
        <span style="color: #000000;">}</span>     

        <span style="color: #0000ff;">BOOL</span> OnDlgResize<span style="color: #000000;">(</span><span style="color: #0000ff;">int</span> nType, <span style="color: #0000ff;">int</span> cx, <span style="color: #0000ff;">int</span> cy<span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
                <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span><span style="color: #000040;">!</span>IsInitReady<span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>
                        <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">TRUE</span>;          
                
                uint nButtonIDs<span style="color: #000000;">[</span><span style="color: #000000;">]</span> <span style="color: #000080;">=</span> <span style="color: #000000;">{</span>IDOK, <span style="color: #0000dd;">0</span><span style="color: #000000;">}</span>;
                ArrangeMainItemAndControls<span style="color: #000000;">(</span>nButtonIDs, IDC_GRID, <span style="color: #0000ff;">NULL</span>, <span style="color: #0000ff;">false</span><span style="color: #000000;">)</span>;
                <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">TRUE</span>;          
        <span style="color: #000000;">}</span>

<span style="color: #0000ff;">private</span><span style="color: #000000;">:</span>
        GridListControl         m_ListCtrl;
<span style="color: #000000;">}</span>;

<span style="color: #0000ff;">bool</span> OpenListDLG<span style="color: #000000;">(</span><span style="color: #000000;">)</span>    
<span style="color: #000000;">{</span>
        ListCtrlDLG myDlg;
        myDlg.<span style="color: #000000;">DoModal</span><span style="color: #000000;">(</span> GetWindow<span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span>;
<span style="color: #000000;">}</span>
</pre>

  <h2><a name="Remark"></a><span class="mw-headline">Remark</span></h2>

  <h2><a name="See_Also"></a><span class="mw-headline">See Also</span></h2>

  <h2><a name="header_to_Included"></a><span class="mw-headline">header to Included</span></h2>

  <p>GridControl.h</p>
