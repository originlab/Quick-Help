<h1 class="firstheading">Adding a User Tree to Worksheet</h1>

  <p>&#160;</p>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>Contents</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1"><a href="#Version_Info"><span class="tocnumber">1</span> <span class="toctext">Version Info</span></a></li>

      <li class="toclevel-1 tocsection-2"><a href="#Example"><span class="tocnumber">2</span> <span class="toctext">Example</span></a></li>
    </ul>
  </div>

  <h2><a name="Version_Info"></a><span class="mw-headline">Version Info</span></h2>

  <p class="version">Minimum Origin Version Required: Origin 8 SR0</p>

  <h2><a name="Example"></a><span class="mw-headline">Example</span></h2>

  <p>The following example to show how to add user parameter tree to one Origin window. Right click the title of window and choose Show Organizer to see newly added tree in User Tree branch.</p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">void</span> OriginObject_PutBinaryStorage_Ex1<span style="color: #000000;">(</span>string strPageName <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"Book1"</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
        Page pg <span style="color: #000080;">=</span> Project.<span style="color: #000000;">Pages</span><span style="color: #000000;">(</span>strPageName<span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span>pg<span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
                string strStorageName <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"TREE"</span>; <span style="color: #008000;">// the name of user tree must be TREE</span>
                
                Tree tr;                
                tr.<span style="color: #000000;">Param1</span>.<span style="color: #000000;">Company</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"ACME Corp"</span>;
                tr.<span style="color: #000000;">Param1</span>.<span style="color: #000000;">operator</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"Joe Smith"</span>;
                tr.<span style="color: #000000;">Param1</span>.<span style="color: #000000;">DAQ</span>.<span style="color: #000000;">start</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
                tr.<span style="color: #000000;">Param1</span>.<span style="color: #000000;">DAQ</span>.<span style="color: #000000;">stop</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0.5</span>;
                
                tr.<span style="color: #000000;">Param2</span>.<span style="color: #000000;">Test</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"Just a test"</span>;
                
                pg.<span style="color: #000000;">PutBinaryStorage</span><span style="color: #000000;">(</span>strStorageName, tr<span style="color: #000000;">)</span>; 
                
                
                Tree trTest;
                pg.<span style="color: #000000;">GetBinaryStorage</span><span style="color: #000000;">(</span>strStorageName, trTest<span style="color: #000000;">)</span>;
                out_tree<span style="color: #000000;">(</span>trTest<span style="color: #000000;">)</span>;
        <span style="color: #000000;">}</span>
        <span style="color: #0000ff;">else</span>
                <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Not this page named %s in project<span style="color: #666666; font-weight: bold;">\n</span>"</span>, strPageName<span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span>
</pre>
