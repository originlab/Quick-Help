<h1 class="firstheading">Wind Rose Plot</h1>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>Contents</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1"><a href="#Version_Info"><span class="tocnumber">1</span> <span class="toctext">Version Info</span></a></li>

      <li class="toclevel-1 tocsection-2"><a href="#Wind_Rose_with_Binned_Data"><span class="tocnumber">2</span> <span class="toctext">Wind Rose with Binned Data</span></a></li>

      <li class="toclevel-1 tocsection-3"><a href="#Wind_Rose_with_Raw_Data"><span class="tocnumber">3</span> <span class="toctext">Wind Rose with Raw Data</span></a></li>
    </ul>
  </div>

  <h2><a name="Version_Info"></a><span class="mw-headline">Version Info</span></h2>

  <p class="version">Minimum Origin Version Required: Origin8 SR0</p>

  <h2><a name="Wind_Rose_with_Binned_Data"></a><span class="mw-headline">Wind Rose with Binned Data</span></h2>

  <p>To generate binned data from wind rose raw data:</p>

  <ol>
    <li>New a worksheet, import Samples\Graphing\WIND.dat from Origin install folder to worksheet.</li>

    <li>High-light column B and C, right click and choose Swap Columns to swap B,C columns. Set column C as X type.</li>

    <li>High-light column C and B, open Two D Binning dialog from menu Statistics -&gt; Descritive Statistics -&gt; 2D Frequency Count/Binning -&gt; Open Dialog...</li>

    <li>Change options as the following and click OK button.<br>
    X -&gt; Minimum Bin Beginning: 0<br>
    X -&gt; Maximum Bin End: 360<br>
    X -&gt; Increment: 30</li>
  </ol>

  <p>Run the following function to plot Wind Rose with binned data.</p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">void</span> wind_rose_with_binned_data<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
        Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> wks <span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
                DataRange dr;
                dr.<span style="color: #000000;">Add</span><span style="color: #000000;">(</span>wks, <span style="color: #0000dd;">0</span>, <span style="color: #ff00ff;">"X"</span><span style="color: #000000;">)</span>;
                <span style="color: #0000ff;">int</span> nLastColIndex <span style="color: #000080;">=</span> wks.<span style="color: #000000;">Columns</span>.<span style="color: #000000;">Count</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000040;">-</span> <span style="color: #0000dd;">1</span>;
                dr.<span style="color: #000000;">Add</span><span style="color: #000000;">(</span>wks, <span style="color: #0000dd;">1</span>, <span style="color: #ff00ff;">"Y"</span>, nLastColIndex<span style="color: #000000;">)</span>;
                
                GraphPage gp;
                gp.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"WindRose"</span><span style="color: #000000;">)</span>;
                GraphLayer gl <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;
                
                <span style="color: #0000ff;">int</span> nPlot <span style="color: #000080;">=</span> gl.<span style="color: #000000;">AddPlot</span><span style="color: #000000;">(</span>dr, IDM_PLOT_COLUMN_STACK<span style="color: #000000;">)</span>; <span style="color: #008000;">// return the index of newly added plot</span>
                <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> nPlot <span style="color: #000000;">)</span>
                <span style="color: #000000;">{</span>
                        gl.<span style="color: #000000;">Rescale</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
                <span style="color: #000000;">}</span>
        <span style="color: #000000;">}</span>
<span style="color: #000000;">}</span>
</pre>

  <h2><a name="Wind_Rose_with_Raw_Data"></a><span class="mw-headline">Wind Rose with Raw Data</span></h2>

  <p>This plot type not support use <a href="../../OriginC/OriginC/GraphLayer-AddPlot.html" title="OriginC:GraphLayer-AddPlot">GraphLayer::AddPlot</a> to plot in Origin C since this plot generated by X-Function framework.</p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">void</span> wind_rose_with_raw_data<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
        Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> wks <span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>             
                LT_execute<span style="color: #000000;">(</span><span style="color: #ff00ff;">"worksheet -px ? WindRoseRaw plot_windrose -d;"</span><span style="color: #000000;">)</span>;              
        <span style="color: #000000;">}</span>
<span style="color: #000000;">}</span>
</pre>
