<h1 class="firstheading">Creating Reports in Flat Sheet</h1>

  <h2><a name="Version_Info"></a><span class="mw-headline">Version Info</span></h2>

  <p class="version">Minimum Origin Version Required: Origin 8 SR0</p>

  <h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>

  <p>Reports vector numeric data and text via <a href="../../OriginC/OriginC/Datasheet-SetReportTree.html" title="OriginC:Datasheet-SetReportTree">Datasheet::SetReportTree</a> function in Worksheet class from tree to flat sheet.</p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">void</span> Datasheet_SetReportTree<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
        <span style="color: #0000ff;">int</span> nID <span style="color: #000080;">=</span> <span style="color: #0000dd;">100</span>; <span style="color: #008000;">// Each node must have node ID and node ID must be unique   </span>
        <span style="color: #0000ff;">int</span> nTableFormat <span style="color: #000080;">=</span> GETNBRANCH_FIT_COL_WIDTH <span style="color: #000040;">|</span> GETNBRANCH_FIT_ROW_HEIGHT;

        <span style="color: #008000;">// 1. Create report tree</span>
        Tree tr;
        tr.<span style="color: #000000;">Report</span>.<span style="color: #000000;">ID</span> <span style="color: #000080;">=</span> nID<span style="color: #000040;">++</span>; 
        tr.<span style="color: #000000;">Report</span>.<span style="color: #000000;">SetAttribute</span><span style="color: #000000;">(</span>STR_LABEL_ATTRIB, <span style="color: #ff00ff;">"Dest Stats Report"</span><span style="color: #000000;">)</span>; <span style="color: #008000;">//Table title</span>
        <span style="color: #008000;">// TREE_Table attribute is critical in getting the report to work so must be present in every table level. </span>
        <span style="color: #008000;">// Can set this attribute as 0 without any format, but many bits GETNBRANCH_* defined in oc_const.h to set table display format.</span>
        tr.<span style="color: #000000;">Report</span>.<span style="color: #000000;">SetAttribute</span><span style="color: #000000;">(</span>TREE_Table, nTableFormat<span style="color: #000000;">)</span>;
        
        
        <span style="color: #008000;">// 2. Prepare the table and show values got from vectors</span>
        tr.<span style="color: #000000;">Report</span>.<span style="color: #000000;">Table</span>.<span style="color: #000000;">ID</span> <span style="color: #000080;">=</span> nID<span style="color: #000040;">++</span>;
        TreeNode trTable <span style="color: #000080;">=</span> tr.<span style="color: #000000;">Report</span>.<span style="color: #000000;">Table</span>;
        trTable.<span style="color: #000000;">SetAttribute</span><span style="color: #000000;">(</span>STR_LABEL_ATTRIB, <span style="color: #ff00ff;">"Extreme Values"</span><span style="color: #000000;">)</span>; <span style="color: #008000;">//Table tile</span>
        trTable.<span style="color: #000000;">SetAttribute</span><span style="color: #000000;">(</span>TREE_Table, nTableFormat <span style="color: #000040;">|</span> GETNBRANCH_TRANSPOSE<span style="color: #000000;">)</span>; 
        
        <span style="color: #008000;">// setup column 1</span>
        trTable.<span style="color: #000000;">C1</span>.<span style="color: #000000;">ID</span> <span style="color: #000080;">=</span> nID<span style="color: #000040;">++</span>;
        trTable.<span style="color: #000000;">C1</span>.<span style="color: #000000;">SetAttribute</span><span style="color: #000000;">(</span>STR_LABEL_ATTRIB, <span style="color: #ff00ff;">"Description"</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// Column label</span>
        trTable.<span style="color: #000000;">C1</span>.<span style="color: #000000;">SetAttribute</span><span style="color: #000000;">(</span>STR_COL_DESIGNATION_ATTRIB, OKDATAOBJ_DESIGNATION_NONE<span style="color: #000000;">)</span>; <span style="color: #008000;">// Set column type to None</span>
        
        <span style="color: #008000;">// setup column 2</span>
        trTable.<span style="color: #000000;">C2</span>.<span style="color: #000000;">ID</span> <span style="color: #000080;">=</span> nID<span style="color: #000040;">++</span>;
        trTable.<span style="color: #000000;">C2</span>.<span style="color: #000000;">SetAttribute</span><span style="color: #000000;">(</span>STR_LABEL_ATTRIB, <span style="color: #ff00ff;">"Max Values"</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// Column label</span>
        trTable.<span style="color: #000000;">C2</span>.<span style="color: #000000;">SetAttribute</span><span style="color: #000000;">(</span>STR_COL_DESIGNATION_ATTRIB, OKDATAOBJ_DESIGNATION_Y<span style="color: #000000;">)</span>; <span style="color: #008000;">// Set column type to Y</span>
        
        <span style="color: #008000;">// setup column 3</span>
        trTable.<span style="color: #000000;">C3</span>.<span style="color: #000000;">ID</span> <span style="color: #000080;">=</span> nID<span style="color: #000040;">++</span>;
        trTable.<span style="color: #000000;">C3</span>.<span style="color: #000000;">SetAttribute</span><span style="color: #000000;">(</span>STR_LABEL_ATTRIB, <span style="color: #ff00ff;">"Min Values"</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// Column label       </span>
        trTable.<span style="color: #000000;">C3</span>.<span style="color: #000000;">SetAttribute</span><span style="color: #000000;">(</span>STR_COL_DESIGNATION_ATTRIB, OKDATAOBJ_DESIGNATION_Y<span style="color: #000000;">)</span>; <span style="color: #008000;">// Set column type to Y</span>
        
        
        <span style="color: #008000;">// Put data from vector to table columns</span>
        vector<span style="color: #000080;">&lt;</span>string<span style="color: #000080;">&gt;</span> vsDesc <span style="color: #000080;">=</span> <span style="color: #000000;">{</span><span style="color: #ff00ff;">"Data1"</span>, <span style="color: #ff00ff;">"Data2"</span>, <span style="color: #ff00ff;">"Data3"</span>, <span style="color: #ff00ff;">"Data4"</span>, <span style="color: #ff00ff;">"Data5"</span><span style="color: #000000;">}</span>;
        vector vMaxDatas <span style="color: #000080;">=</span> <span style="color: #000000;">{</span><span style="color: #0000dd;">100</span>, <span style="color: #0000dd;">98</span>, <span style="color: #0000dd;">95</span>, <span style="color: #0000dd;">92</span>, <span style="color: #0000dd;">84</span><span style="color: #000000;">}</span>;
        vector vMinDatas <span style="color: #000080;">=</span> <span style="color: #000000;">{</span><span style="color: #0000dd;">5</span>, <span style="color: #0000dd;">9</span>, <span style="color: #0000dd;">13</span>, <span style="color: #0000dd;">18</span>, <span style="color: #0000dd;">21</span><span style="color: #000000;">}</span>;
        trTable.<span style="color: #000000;">C1</span>.<span style="color: #000000;">strVals</span> <span style="color: #000080;">=</span> vsDesc;     
        trTable.<span style="color: #000000;">C2</span>.<span style="color: #000000;">dVals</span> <span style="color: #000080;">=</span> vMaxDatas; 
        trTable.<span style="color: #000000;">C3</span>.<span style="color: #000000;">dVals</span> <span style="color: #000080;">=</span> vMinDatas;    
        
        
        <span style="color: #008000;">// 4. Prepare worksheet window to report</span>
        WorksheetPage wksPage;
        wksPage.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;        
        
        
        string  strSheetName <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"Report Sheet"</span>;
        <span style="color: #0000ff;">int</span> nn <span style="color: #000080;">=</span> wksPage.<span style="color: #000000;">AddLayer</span><span style="color: #000000;">(</span>strSheetName<span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> nn <span style="color: #000080;">&lt;</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">)</span>        
                <span style="color: #0000ff;">return</span>;    
        
        Worksheet wksOut <span style="color: #000080;">=</span> wksPage.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span>nn<span style="color: #000000;">)</span>;
        wksPage.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>.<span style="color: #0000ff;">Delete</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">//delete the first default layer  </span>
        
        
        <span style="color: #008000;">// 5. Do report</span>
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> wksOut.<span style="color: #000000;">SetReportTree</span><span style="color: #000000;">(</span>tr.<span style="color: #000000;">Report</span><span style="color: #000000;">)</span> <span style="color: #000080;">&lt;</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">)</span> <span style="color: #008000;">// Returns last row number on successful exit and -1 on failure.</span>
        <span style="color: #000000;">{</span>
                <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Fail to set report tree.<span style="color: #666666; font-weight: bold;">\n</span>"</span><span style="color: #000000;">)</span>;
                <span style="color: #0000ff;">return</span>;
        <span style="color: #000000;">}</span>             
        wksOut.<span style="color: #000000;">AutoSize</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;       
<span style="color: #000000;">}</span>
</pre>
