<h1 class="firstheading">FFT</h1>

  <p>&#160;</p>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>Contents</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>

      <li class="toclevel-1 tocsection-2"><a href="#Syntax"><span class="tocnumber">2</span> <span class="toctext">Syntax</span></a></li>

      <li class="toclevel-1 tocsection-3"><a href="#Parameters"><span class="tocnumber">3</span> <span class="toctext">Parameters</span></a></li>

      <li class="toclevel-1 tocsection-4"><a href="#Return"><span class="tocnumber">4</span> <span class="toctext">Return</span></a></li>

      <li class="toclevel-1 tocsection-5"><a href="#Examples"><span class="tocnumber">5</span> <span class="toctext">Examples</span></a></li>

      <li class="toclevel-1 tocsection-6"><a href="#Remark"><span class="tocnumber">6</span> <span class="toctext">Remark</span></a></li>

      <li class="toclevel-1 tocsection-7"><a href="#See_Also"><span class="tocnumber">7</span> <span class="toctext">See Also</span></a></li>

      <li class="toclevel-1 tocsection-8"><a href="#header_to_Included"><span class="tocnumber">8</span> <span class="toctext">header to Included</span></a></li>

      <li class="toclevel-1 tocsection-9"><a href="#Reference"><span class="tocnumber">9</span> <span class="toctext">Reference</span></a></li>
    </ul>
  </div>

  <h2><a name="Description"></a><span class="mw-headline">Description</span></h2>

  <p>These two Functions will do the 1 dimension Fast Fourier Transform. Data matrix should be of type double. If user have the data matrix in integer form, user should first transform it to double using the member function of matrixbase "CastToDouble".</p>

  <p>This function performs 1-dimensional Fast Fourier Transform on each row of data in a matrix. Data matrix should be of type complex. If user have the data matrix in integer form, user should first transform it to complex.</p>

  <h2><a name="Syntax"></a><span class="mw-headline">Syntax</span></h2>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">int</span> FFT<span style="color: #000000;">(</span> matrix <span style="color: #000040;">&amp;</span> matSource, matrix<span style="color: #000080;">&lt;</span>complex<span style="color: #000080;">&gt;</span> <span style="color: #000040;">&amp;</span> matFFTResult, <span style="color: #0000ff;">int</span> nColProcess <span style="color: #000080;">=</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span> <span style="color: #000000;">)</span>
</pre>

  <p> </p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">int</span> FFT<span style="color: #000000;">(</span> matrix<span style="color: #000080;">&lt;</span>complex<span style="color: #000080;">&gt;</span> <span style="color: #000040;">&amp;</span> matSource, matrix<span style="color: #000080;">&lt;</span>complex<span style="color: #000080;">&gt;</span> <span style="color: #000040;">&amp;</span> matFFTResult, <span style="color: #0000ff;">int</span> nColProcess <span style="color: #000080;">=</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span> <span style="color: #000000;">)</span>
</pre>

  <p> </p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">int</span> FFT<span style="color: #000000;">(</span> vector<span style="color: #000080;">&lt;</span>complex<span style="color: #000080;">&gt;</span> <span style="color: #000040;">&amp;</span> vecSource, vector<span style="color: #000080;">&lt;</span>complex<span style="color: #000080;">&gt;</span> <span style="color: #000040;">&amp;</span> vecFFTResult <span style="color: #000000;">)</span>
</pre>

  <h2><a name="Parameters"></a><span class="mw-headline">Parameters</span></h2>

  <dl>
    <dt>matSource</dt>

    <dd>[input] The data source matrix</dd>

    <dt>matFFTResult</dt>

    <dd>[output] The matrix containing the 1 dimension FFT results</dd>

    <dt>nColProcess</dt>

    <dd>[input] The number of columns user provided. If it is -1, function will not do any padding or truncating. But if it is larger than the size of the matrix, it will pad zero to meet the size if less than, it will truncate the data matrix.</dd>
  </dl>

  <p> </p>

  <dl>
    <dt>matSource</dt>

    <dd>[input] The data source matrix</dd>

    <dt>matFFTResult</dt>

    <dd>[output] The matrix containing the 1 dimension FFT results</dd>

    <dt>nColProcess</dt>

    <dd>[input] The number of columns user provided. If it is -1, function will not do any padding or truncating. But if it is larger than the size of the matrix, it will pad zero to meet the size if less than, it will truncate the data matrix.</dd>
  </dl>

  <p> </p>

  <dl>
    <dt>vecSource</dt>

    <dd>[input] The data source vector</dd>

    <dt>vecFFTResult</dt>

    <dd>[output] The vector containing the 1-dimensional FFT result</dd>
  </dl>

  <h2><a name="Return"></a><span class="mw-headline">Return</span></h2>

  <p>If succeed, it will return 0; Otherwise it returns error indications.</p>

  <p>Error:</p>

  <p>-1: Provided column number or row number. Must be -1 or positive integer</p>

  <p>-2: The data source matrix is empty</p>

  <p>-3: When calling member function, it fails.</p>

  <p>-4: When calling GetReal or GetImage member function of matrix class, it failed.</p>

  <p><br>
  If succeed, it will return 0; Otherwise it returns error indications.</p>

  <p>Error:</p>

  <p>-1: Provided column number or row number. Must be -1 or positive integer</p>

  <p>-2: The data source matrix is empty</p>

  <p>-3: When calling member function, it fails.</p>

  <p>-4: When calling GetReal or GetImage member function of matrix class, it failed.</p>

  <p><br>
  If succeed, it will return 0; Otherwise it returns error indications.</p>

  <p>Error:</p>

  <p>-5: source vector is of zero length</p>

  <p>n: other error codes returned by matrix-based FFT function</p>

  <h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>

  <p>Prior to compilation, load fft_utils.c to the workspace by executing the following LabTalk command:</p>
  <pre class="lt" style="font-family:monospace;">
Run.<span style="color: #000080;">LoadOC</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Originlab\fft_utils.c"</span>, <span style="color: #0000dd;">16</span><span style="color: #000000;">)</span>;
</pre>

  <p>To retain fft_utils.c in the workspace for successive sessions, drag and drop the file from the Temporary folder to the System folder.</p>

  <p><b>EX1</b></p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #008000;">//This example computes the 1 dimension fast fourier transform on each row of the matrix mRe.</span>
<span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>fft_utils.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span>
<span style="color: #0000ff;">void</span> FFT_ex1<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
        matrix <span style="color: #000080;">&lt;</span><span style="color: #0000ff;">double</span><span style="color: #000080;">&gt;</span> mRe <span style="color: #000080;">=</span> <span style="color: #000000;">{</span><span style="color: #000000;">{</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2.5</span>,<span style="color: #0000dd;">3.5</span>,<span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">1.0</span>,<span style="color: #0000dd;">2.3</span><span style="color: #000000;">}</span>,<span style="color: #000000;">{</span><span style="color: #0000dd;">3.2</span>,<span style="color: #0000dd;">4.1</span>,<span style="color: #0000dd;">2.2</span>,<span style="color: #0000dd;">1.0</span>,<span style="color: #0000dd;">4</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">}</span><span style="color: #000000;">}</span>;
        <span style="color: #0000ff;">int</span> ii , jj;
 
        matrix <span style="color: #000080;">&lt;</span>complex<span style="color: #000080;">&gt;</span> mResult;
 
        <span style="color: #008000;">//test 1d fft function for arbitrary source matrix.</span>
        <span style="color: #0000ff;">int</span> Err <span style="color: #000080;">=</span> FFT<span style="color: #000000;">(</span>mRe, mResult, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>;
 
        <span style="color: #0000ff;">if</span> <span style="color: #000000;">(</span> <span style="color: #0000dd;">0</span> <span style="color: #000040;">!</span><span style="color: #000080;">=</span> Err <span style="color: #000000;">)</span> 
        <span style="color: #000000;">{</span>
       <span style="color: #000000;">ASSERT</span><span style="color: #000000;">(</span><span style="color: #0000ff;">false</span><span style="color: #000000;">)</span>;
       <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"one-dimension FFT fails.<span style="color: #666666; font-weight: bold;">\n</span>"</span><span style="color: #000000;">)</span>;
        <span style="color: #000000;">}</span> 
        <span style="color: #0000ff;">else</span>
        <span style="color: #000000;">{</span>
        <span style="color: #0000ff;">for</span><span style="color: #000000;">(</span>ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; ii <span style="color: #000080;">&lt;</span> mResult.<span style="color: #000000;">GetNumRows</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;  ii<span style="color: #000040;">++</span><span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
                <span style="color: #0000ff;">for</span><span style="color: #000000;">(</span>jj <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; jj <span style="color: #000080;">&lt;</span> mResult.<span style="color: #000000;">GetNumCols</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; jj<span style="color: #000040;">++</span><span style="color: #000000;">)</span>
                <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"(%f, %fi)  "</span>,mResult<span style="color: #000000;">[</span>ii<span style="color: #000000;">]</span><span style="color: #000000;">[</span>jj<span style="color: #000000;">]</span>.<span style="color: #000000;">m_re</span>,mResult<span style="color: #000000;">[</span>ii<span style="color: #000000;">]</span><span style="color: #000000;">[</span>jj<span style="color: #000000;">]</span>.<span style="color: #000000;">m_im</span><span style="color: #000000;">)</span>;
                <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"<span style="color: #666666; font-weight: bold;">\n</span>"</span><span style="color: #000000;">)</span>;            
        <span style="color: #000000;">}</span>
        <span style="color: #000000;">}</span>
<span style="color: #000000;">}</span>

<span style="color: #008000; font-style: regular;">/**
    The output is as following:
(5.021454, 0.000000i)  (-0.347011, -0.954594i)  (-0.673610, 0.813173i)  (-0.530723, 0.000000i)  (-0.673610, -0.813173i)  (-0.347011, 0.954594i)  
(6.736097, 0.000000i)  (0.877734, -0.106066i)  (-0.796084, -1.378858i)  (0.938971, 0.000000i)  (-0.796084, 1.378858i)  (0.877734, 0.106066i)
**/</span>
</pre>

  <p><br>
  <b>EX2</b></p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #008000;">//This example computes the 1 dimension fast fourier transform on each row of the matrix mSource.</span>
<span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>fft_utils.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span> 
<span style="color: #0000ff;">void</span> FFT_ex2<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
        matrix <span style="color: #000080;">&lt;</span><span style="color: #0000ff;">double</span><span style="color: #000080;">&gt;</span> mRe <span style="color: #000080;">=</span> <span style="color: #000000;">{</span><span style="color: #000000;">{</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2.5</span>,<span style="color: #0000dd;">3.5</span>,<span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">1.0</span>,<span style="color: #0000dd;">2.3</span><span style="color: #000000;">}</span>,<span style="color: #000000;">{</span><span style="color: #0000dd;">3.2</span>,<span style="color: #0000dd;">4.1</span>,<span style="color: #0000dd;">2.2</span>,<span style="color: #0000dd;">1.0</span>,<span style="color: #0000dd;">4</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">}</span><span style="color: #000000;">}</span>;
        matrix <span style="color: #000080;">&lt;</span><span style="color: #0000ff;">double</span><span style="color: #000080;">&gt;</span> mIm <span style="color: #000080;">=</span> <span style="color: #000000;">{</span><span style="color: #000000;">{</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">0.5</span>,<span style="color: #0000dd;">1.0</span>,<span style="color: #0000dd;">0.8</span>,<span style="color: #0000dd;">3.1</span>,<span style="color: #0000dd;">0.3</span><span style="color: #000000;">}</span>,<span style="color: #000000;">{</span><span style="color: #0000dd;">2.2</span>,<span style="color: #0000dd;">3.2</span>,<span style="color: #0000dd;">3.0</span>,<span style="color: #0000dd;">1.5</span>,<span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">2.1</span><span style="color: #000000;">}</span><span style="color: #000000;">}</span>;
        <span style="color: #0000ff;">int</span> ii , jj;
 
        matrix <span style="color: #000080;">&lt;</span>complex<span style="color: #000080;">&gt;</span> mSource, mResult;
        mSource.<span style="color: #000000;">MakeComplex</span><span style="color: #000000;">(</span>mRe,mIm<span style="color: #000000;">)</span>;
 
        <span style="color: #008000;">//test 1d fft function for complex source matrix.</span>
 
        <span style="color: #0000ff;">int</span> Err <span style="color: #000080;">=</span> FFT<span style="color: #000000;">(</span>mSource, mResult<span style="color: #000000;">)</span>;
 
        <span style="color: #0000ff;">if</span> <span style="color: #000000;">(</span> <span style="color: #0000dd;">0</span> <span style="color: #000040;">!</span><span style="color: #000080;">=</span> Err <span style="color: #000000;">)</span> 
        <span style="color: #000000;">{</span>
       <span style="color: #000000;">ASSERT</span><span style="color: #000000;">(</span><span style="color: #0000ff;">false</span><span style="color: #000000;">)</span>;
       <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"one-dimension FFT fails<span style="color: #666666; font-weight: bold;">\n</span>"</span><span style="color: #000000;">)</span>;
        <span style="color: #000000;">}</span>
        <span style="color: #0000ff;">else</span>
        <span style="color: #000000;">{</span>
        <span style="color: #0000ff;">for</span><span style="color: #000000;">(</span>ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; ii <span style="color: #000080;">&lt;</span> mResult.<span style="color: #000000;">GetNumRows</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;  ii<span style="color: #000040;">++</span><span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
                <span style="color: #0000ff;">for</span><span style="color: #000000;">(</span>jj <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; jj <span style="color: #000080;">&lt;</span> mResult.<span style="color: #000000;">GetNumCols</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; jj<span style="color: #000040;">++</span><span style="color: #000000;">)</span>
                <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"(%f, %fi)  "</span>,mResult<span style="color: #000000;">[</span>ii<span style="color: #000000;">]</span><span style="color: #000000;">[</span>jj<span style="color: #000000;">]</span>.<span style="color: #000000;">m_re</span>,mResult<span style="color: #000000;">[</span>ii<span style="color: #000000;">]</span><span style="color: #000000;">[</span>jj<span style="color: #000000;">]</span>.<span style="color: #000000;">m_im</span><span style="color: #000000;">)</span>;
                <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"<span style="color: #666666; font-weight: bold;">\n</span>"</span><span style="color: #000000;">)</span>;
 
        <span style="color: #000000;">}</span>
        <span style="color: #000000;">}</span>
<span style="color: #000000;">}</span>

<span style="color: #008000; font-style: regular;">/**
    The output is as following:
(5.021454, 2.735264i)  (-1.018762, -1.546554i)  (0.139563, 0.547811i)  (-0.530723, 1.428869i)  (-1.486782, -1.078534i)  (0.324740, 0.362634i)  
(6.736097, 5.715476i)  (1.620196, 0.240945i)  (-0.760729, -1.970818i)  (0.938971, 0.163299i)  (-0.831440, 0.786898i)  (0.135272, 0.453077i)

**/</span>
</pre>

  <p><br>
  <b>EX3</b></p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #008000;">//This example computes the 1-dimensional Fast Fourier Transform on a complex vector.</span>
<span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>fft_utils.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span>
<span style="color: #0000ff;">void</span> FFT_ex3<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
        vector vR <span style="color: #000080;">=</span> <span style="color: #000000;">{</span> <span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2.5</span>,<span style="color: #0000dd;">3.5</span>,<span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">1.0</span>,<span style="color: #0000dd;">2.3</span> <span style="color: #000000;">}</span>;
        vector vI <span style="color: #000080;">=</span> <span style="color: #000000;">{</span> <span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">0.5</span>,<span style="color: #0000dd;">1.0</span>,<span style="color: #0000dd;">0.8</span>,<span style="color: #0000dd;">3.1</span>,<span style="color: #0000dd;">0.3</span> <span style="color: #000000;">}</span>;
        vector <span style="color: #000080;">&lt;</span>complex<span style="color: #000080;">&gt;</span> vC<span style="color: #000000;">(</span>vR, vI<span style="color: #000000;">)</span>, vResult<span style="color: #000000;">(</span>vC.<span style="color: #000000;">GetSize</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
         
        <span style="color: #008000;">//tedt 1d fft function on data in a complex vector</span>
        <span style="color: #0000ff;">int</span> Err <span style="color: #000080;">=</span> FFT<span style="color: #000000;">(</span>vC, vResult<span style="color: #000000;">)</span>;
         
        <span style="color: #0000ff;">if</span> <span style="color: #000000;">(</span> <span style="color: #0000dd;">0</span> <span style="color: #000040;">!</span><span style="color: #000080;">=</span> Err <span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
       <span style="color: #000000;">ASSERT</span><span style="color: #000000;">(</span><span style="color: #0000ff;">false</span><span style="color: #000000;">)</span>;
       <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"one-dimension FFT fails<span style="color: #666666; font-weight: bold;">\n</span>"</span><span style="color: #000000;">)</span>;
        <span style="color: #000000;">}</span>
        <span style="color: #0000ff;">else</span>
        <span style="color: #000000;">{</span>
            <span style="color: #0000ff;">for</span><span style="color: #000000;">(</span><span style="color: #0000ff;">int</span> ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; ii <span style="color: #000080;">&lt;</span> vResult.<span style="color: #000000;">GetSize</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;  ii<span style="color: #000040;">++</span><span style="color: #000000;">)</span>
            <span style="color: #000000;">{</span>
                        <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"(%f, %fi)  "</span>,vResult<span style="color: #000000;">[</span>ii<span style="color: #000000;">]</span>.<span style="color: #000000;">m_re</span>,vResult<span style="color: #000000;">[</span>ii<span style="color: #000000;">]</span>.<span style="color: #000000;">m_im</span><span style="color: #000000;">)</span>;
                <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"<span style="color: #666666; font-weight: bold;">\n</span>"</span><span style="color: #000000;">)</span>;
            <span style="color: #000000;">}</span>  
        <span style="color: #000000;">}</span>
<span style="color: #000000;">}</span>
 
<span style="color: #008000; font-style: regular;">/**
            The output is as following:
        (5.021454,  2.735264i)  
        (-1.018762, -1.546554i)  
        (0.139563,  0.547811i)  
        (-0.530723, 1.428869i)  
        (-1.486782, -1.078534i)  
        (0.324740,  0.362634i)

**/</span>
</pre>

  <h2><a name="Remark"></a><span class="mw-headline">Remark</span></h2>

  <p>This function performs 1-dimensional Fast Fourier Transform on data in a complex vector.</p>

  <p>Data vector should be of type complex. If user have the data vector in integer or double form, user should first transform it or copy it to a complex vector.</p>

  <p>This function in turn calls the matrix-based FFT function.</p>

  <h2><a name="See_Also"></a><span class="mw-headline">See Also</span></h2>

  <h2><a name="header_to_Included"></a><span class="mw-headline">header to Included</span></h2>

  <p>fft_utils.h</p>

  <h2><a name="Reference"></a><span class="mw-headline">Reference</span></h2>
