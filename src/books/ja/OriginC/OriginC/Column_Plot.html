<h1 class="firstheading">Column Plot</h1>

  <p>&#160;</p>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>Contents</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1"><a href="#Version_Info"><span class="tocnumber">1</span> <span class="toctext">Version Info</span></a></li>

      <li class="toclevel-1 tocsection-2"><a href="#Plot_Float_Column_with_Indexing_Color"><span class="tocnumber">2</span> <span class="toctext">Plot Float Column with Indexing Color</span></a></li>
    </ul>
  </div>

  <h2><a name="Version_Info"></a><span class="mw-headline">Version Info</span></h2>

  <p class="version">Minimum Origin Version Required: Origin80 SR0</p>

  <h2><a name="Plot_Float_Column_with_Indexing_Color"></a><span class="mw-headline">Plot Float Column with Indexing Color</span></h2>

  <p><b>Example Data</b></p>

  <p>New a worksheet, make sure worksheet page name is "Book1", copy the following example data to worksheet.</p>
  <pre>
Col(A)  Col(B)  Col(C)        Col(D)
A       30      196.087         1
B       0       197.747         1
C       10      1.693           2
D       0       -2.194          2
E       10      33.214          4
F       10      -35.101         4
G       0       -16.713         6
H       0       15.993          6
</pre>

  <p><b>Example Code</b></p>

  <p>Run the following function to plot a float column, and set the color of columns depend on column D.</p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">void</span> float_column_plot_ex<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
        WorksheetPage wksPage<span style="color: #000000;">(</span><span style="color: #ff00ff;">"Book1"</span><span style="color: #000000;">)</span>;
        Worksheet wks <span style="color: #000080;">=</span> wksPage.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> wks <span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
                DataRange dr;
                dr.<span style="color: #000000;">Add</span><span style="color: #000000;">(</span>wks, <span style="color: #0000dd;">0</span>, <span style="color: #ff00ff;">"X"</span><span style="color: #000000;">)</span>;
                dr.<span style="color: #000000;">Add</span><span style="color: #000000;">(</span>wks, <span style="color: #0000dd;">1</span>, <span style="color: #ff00ff;">"Y"</span><span style="color: #000000;">)</span>;
                dr.<span style="color: #000000;">Add</span><span style="color: #000000;">(</span>wks, <span style="color: #0000dd;">2</span>, <span style="color: #ff00ff;">"Y"</span><span style="color: #000000;">)</span>;
                
                GraphPage gp;
                gp.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"FLOATCOL"</span><span style="color: #000000;">)</span>;
                GraphLayer gl <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;
                <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> gl.<span style="color: #000000;">AddPlot</span><span style="color: #000000;">(</span>dr, IDM_PLOT_COLUMN_FLOAT<span style="color: #000000;">)</span> <span style="color: #000080;">&gt;=</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">)</span>
                <span style="color: #000000;">{</span>
                        gl.<span style="color: #000000;">Rescale</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
                        
                        <span style="color: #008000;">// Set column D as color index</span>
                        <span style="color: #0000ff;">const</span> <span style="color: #0000ff;">int</span> nIndexingBegin <span style="color: #000080;">=</span> <span style="color: #0000dd;">100</span>;
                        <span style="color: #0000ff;">int</span> nFillColor <span style="color: #000080;">=</span> nIndexingBegin <span style="color: #000040;">+</span> <span style="color: #0000dd;">2</span>; <span style="color: #008000;">// column D is the 3rd Y column, Origin C index offset is 0, so add 2 here.</span>
                        
                        Tree tr;
                        tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Columns</span>.<span style="color: #000000;">Column1</span>.<span style="color: #000000;">Pattern</span>.<span style="color: #000000;">Fill</span>.<span style="color: #000000;">FillColor</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> nFillColor;
                        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> gl.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">(</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
                        <span style="color: #000000;">{</span>
                                <span style="color: #0000ff;">bool</span> bRet <span style="color: #000080;">=</span> gl.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">(</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>;
                        <span style="color: #000000;">}</span>
                <span style="color: #000000;">}</span> 
        <span style="color: #000000;">}</span>
<span style="color: #000000;">}</span>
</pre>
