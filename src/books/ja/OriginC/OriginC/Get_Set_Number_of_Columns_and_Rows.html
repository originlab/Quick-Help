<h1 class="firstheading">Get and Set Number of Columns and Rows</h1>

  <p>&#160;</p>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>Contents</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1"><a href="#Version_Info"><span class="tocnumber">1</span> <span class="toctext">Version Info</span></a></li>

      <li class="toclevel-1 tocsection-2"><a href="#Get_Number_of_Columns_and_Rows"><span class="tocnumber">2</span> <span class="toctext">Get Number of Columns and Rows</span></a></li>

      <li class="toclevel-1 tocsection-3"><a href="#Set_Number_of_Columns_and_Rows"><span class="tocnumber">3</span> <span class="toctext">Set Number of Columns and Rows</span></a></li>

      <li class="toclevel-1 tocsection-4"><a href="#Add_Column"><span class="tocnumber">4</span> <span class="toctext">Add Column</span></a></li>

      <li class="toclevel-1 tocsection-5"><a href="#Delete_Column"><span class="tocnumber">5</span> <span class="toctext">Delete Column</span></a></li>

      <li class="toclevel-1 tocsection-6"><a href="#Insert_Column"><span class="tocnumber">6</span> <span class="toctext">Insert Column</span></a></li>

      <li class="toclevel-1 tocsection-7"><a href="#Set_Large_Size"><span class="tocnumber">7</span> <span class="toctext">Set Large Size</span></a></li>
    </ul>
  </div>

  <h2><a name="Version_Info"></a><span class="mw-headline">Version Info</span></h2>

  <p class="version">Minimum Origin Version Required: Origin8 SR0</p>

  <h2><a name="Get_Number_of_Columns_and_Rows"></a><span class="mw-headline">Get Number of Columns and Rows</span></h2>

  <p>This example shows how to get the number of columns and rows in a worksheet</p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">void</span> wks_get_cols_and_rows_num_ex<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
        WorksheetPage wp;
        wp.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Origin"</span><span style="color: #000000;">)</span>;
        
        <span style="color: #008000;">//Get the first worksheet of the workbook</span>
        Worksheet wks<span style="color: #000000;">(</span>wp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
        
        <span style="color: #008000;">//Get the number of rows and columns</span>
        <span style="color: #0000ff;">int</span> nRows <span style="color: #000080;">=</span> wks.<span style="color: #000000;">GetNumRows</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">int</span> nCols <span style="color: #000080;">=</span> wks.<span style="color: #000000;">GetNumCols</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
        
        <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"The number of the rows in %s is: %d<span style="color: #666666; font-weight: bold;">\n</span>"</span>,  wks.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>,nRows<span style="color: #000000;">)</span>;
        <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"The number of the columns in %s is: %d<span style="color: #666666; font-weight: bold;">\n</span>"</span>, wks.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>, nCols<span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span>
</pre>

  <h2><a name="Set_Number_of_Columns_and_Rows"></a><span class="mw-headline">Set Number of Columns and Rows</span></h2>

  <p>This example shows how to set the number of columns and rows in a worksheet</p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">void</span> wks_set_cols_and_rows_num_ex<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
        WorksheetPage wp;
        wp.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Origin"</span><span style="color: #000000;">)</span>;
        
        <span style="color: #008000;">//Get the first worksheet of the workbook</span>
        Worksheet wks<span style="color: #000000;">(</span>wp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
        
        <span style="color: #008000;">//Set the number of rows and columns</span>
        <span style="color: #0000ff;">int</span> nRows <span style="color: #000080;">=</span> <span style="color: #0000dd;">50</span>;
        <span style="color: #0000ff;">int</span> nCols <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span><span style="color: #000040;">!</span>wks.<span style="color: #000000;">SetSize</span><span style="color: #000000;">(</span>nRows, nCols<span style="color: #000000;">)</span><span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
                <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Failed to set size of %s!<span style="color: #666666; font-weight: bold;">\n</span>"</span>, wks.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
        <span style="color: #000000;">}</span>
<span style="color: #000000;">}</span>
</pre>

  <h2><a name="Add_Column"></a><span class="mw-headline">Add Column</span></h2>

  <p>This example shows how to add column to the specified worksheet</p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">void</span> wks_add_col_ex<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
        WorksheetPage wp;
        wp.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Origin"</span><span style="color: #000000;">)</span>;
        
        <span style="color: #008000;">//Get the first worksheet of the workbook</span>
        Worksheet wks<span style="color: #000000;">(</span>wp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
        
        string strColName;
        <span style="color: #008000;">//Add a new column named "NewCol", if there already has a column named NewCol, will auto enumerate name with number and put name to strColName.</span>
        <span style="color: #0000ff;">int</span> iCol <span style="color: #000080;">=</span> wks.<span style="color: #000000;">AddCol</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"NewCol"</span>, strColName<span style="color: #000000;">)</span>;
        
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> iCol<span style="color: #000080;">&gt;=</span><span style="color: #0000dd;">0</span> <span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
                <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"New column added at index %d, name %s<span style="color: #666666; font-weight: bold;">\n</span>"</span>, iCol, strColName<span style="color: #000000;">)</span>;
        <span style="color: #000000;">}</span>
<span style="color: #000000;">}</span>
</pre>

  <h2><a name="Delete_Column"></a><span class="mw-headline">Delete Column</span></h2>

  <p>This example shows how to delete a column in the worksheet</p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">void</span> wks_delete_col_ex<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
        WorksheetPage wp;
        wp.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Origin"</span><span style="color: #000000;">)</span>;
        
        <span style="color: #008000;">//Get the first worksheet of the workbook</span>
        Worksheet wks<span style="color: #000000;">(</span>wp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
        
        <span style="color: #008000;">//Delete the first column of the worksheet</span>
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> wks.<span style="color: #000000;">DeleteCol</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
                <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Successful delete column<span style="color: #666666; font-weight: bold;">\n</span>"</span><span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">else</span>
                <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Failed to delete column<span style="color: #666666; font-weight: bold;">\n</span>"</span><span style="color: #000000;">)</span>;
        
<span style="color: #000000;">}</span>
</pre>

  <h2><a name="Insert_Column"></a><span class="mw-headline">Insert Column</span></h2>

  <p>This example shows how to insert a column in the worksheet</p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">void</span> wks_insert_col_ex<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
    WorksheetPage wp;
    wp.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Origin"</span><span style="color: #000000;">)</span>;
    
    Worksheet wks<span style="color: #000000;">(</span>wp.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;    
    
    <span style="color: #0000ff;">int</span> nPos <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; <span style="color: #008000;">//Set the insert position as the first column    </span>
    string strColName <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"NewInsert"</span>; <span style="color: #008000;">//Set the insert column name to "NewInsert"</span>
    string strColCreated;  
    
    <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span><span style="color: #000040;">!</span>wks.<span style="color: #000000;">InsertCol</span><span style="color: #000000;">(</span>nPos, strColName, strColCreated<span style="color: #000000;">)</span><span style="color: #000000;">)</span>
        <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Failed to insert column<span style="color: #666666; font-weight: bold;">\n</span>"</span><span style="color: #000000;">)</span>;
    <span style="color: #0000ff;">else</span>
        <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"New column insert named %s<span style="color: #666666; font-weight: bold;">\n</span>"</span>, strColCreated<span style="color: #000000;">)</span>;    
<span style="color: #000000;">}</span>
</pre>

  <h2><a name="Set_Large_Size"></a><span class="mw-headline">Set Large Size</span></h2>

  <p>In order to keep Origin C function more efficient on setting the large number of columns or rows in worksheet, for example 5000 columns, need to do like the steps below.</p>

  <ul>
    <li>Use <b><a href="../../OriginC/OriginC/Worksheet-SetSize.html" title="OriginC:Worksheet-SetSize">Worksheet::SetSize</a></b>, not use <b><a href="../../OriginC/OriginC/Worksheet-AddCol.html" title="OriginC:Worksheet-AddCol">Worksheet::AddCol</a></b> to set size.</li>

    <li>Do SetSize on an empty worksheet, means no column, since need to check the short name of the existed columns to avoid duplicate name when add new column. This check may cost many times. Can use <b>while( wks.DeleteCol(0) );</b> to remove all columns.</li>

    <li>Keep Code Builder close when running function to set size.</li>
  </ul>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">void</span> wks_set_large_size_ex<span style="color: #000000;">(</span><span style="color: #0000ff;">int</span> rows <span style="color: #000080;">=</span> <span style="color: #0000dd;">100</span>, <span style="color: #0000ff;">int</span> cols <span style="color: #000080;">=</span> <span style="color: #0000dd;">5000</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
    <span style="color: #008000;">// prepare worksheet size</span>
    Worksheet wks;
    wks.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Origin"</span><span style="color: #000000;">)</span>;
    
    <span style="color: #0000ff;">while</span><span style="color: #000000;">(</span> wks.<span style="color: #000000;">DeleteCol</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>;  <span style="color: #008000;">// del all columns</span>
    
    wks.<span style="color: #000000;">SetSize</span><span style="color: #000000;">(</span>rows, cols<span style="color: #000000;">)</span>;  
<span style="color: #000000;">}</span>
</pre>
