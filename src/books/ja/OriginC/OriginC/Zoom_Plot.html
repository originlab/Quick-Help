<h1 class="firstheading">Zoom Plot</h1>

  <p>&#160;</p>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>Contents</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1"><a href="#Version_Info"><span class="tocnumber">1</span> <span class="toctext">Version Info</span></a></li>

      <li class="toclevel-1 tocsection-2"><a href="#Remark"><span class="tocnumber">2</span> <span class="toctext">Remark</span></a></li>

      <li class="toclevel-1 tocsection-3"><a href="#Before_Running"><span class="tocnumber">3</span> <span class="toctext">Before Running</span></a></li>

      <li class="toclevel-1 tocsection-4"><a href="#Example_Codes"><span class="tocnumber">4</span> <span class="toctext">Example Codes</span></a></li>
    </ul>
  </div>

  <h2><a name="Version_Info"></a><span class="mw-headline">Version Info</span></h2>

  <p class="version">Minimum Origin Version Required: Origin 8.0</p>

  <h2><a name="Remark"></a><span class="mw-headline">Remark</span></h2>

  <p>This example shows how to set script with event mode on one retangle graph object. The <b>Script</b> and <b>Event Mode</b> are <b>Script, Run After</b> and <b>Ctrl-TAB for TAB</b> options in Programming Control... dialog. Right click on graph object and choose Programming Control... to open this dialog.</p>

  <p>This example just simulate Origin Zoom graph. Move rectangle on the top layer to zoom the selected area and display in the bottom layer.</p>

  <h2><a name="Before_Running"></a><span class="mw-headline">Before Running</span></h2>

  <p><b>To generate ZoomSource template for the top layer:</b></p>

  <ol>
    <li>Click New Graph button to new a graph.</li>

    <li>Double-click on X axis to open dialog, choose Grid Lines tab, choose Major Grids checkbox and Opposite checkbox, click OK button to close dialog.</li>

    <li>The same step as above on Y axis to show grid line.</li>

    <li>Delete X Axis Title, Y Axis Title and Legend.</li>

    <li>Right-click graph window title, choose Save Template As..., type "ZoomSource" for Template Name and click OK button twice time.</li>
  </ol>

  <p><b>To genereate ZoomDest template for the bottom layer:</b></p>

  <ol>
    <li>Click New Graph button to new a graph.</li>

    <li>Double-click on graph layer to open Plot Details dialog, in Background tab, change Color to Cyan, click OK button.</li>

    <li>Delete X Axis Title, Y Axis Title and Legend.</li>

    <li>Right-click graph window title, choose Save Template As..., type "ZoomDest" for Template Name and click OK button twice time.</li>
  </ol>

  <h2><a name="Example_Codes"></a><span class="mw-headline">Example Codes</span></h2>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">void</span> zoom_plot<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
        GraphPage       gp;
        gp.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"ZoomSource"</span><span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">int</span> nZoomLayer <span style="color: #000080;">=</span> gp.<span style="color: #000000;">AddLayer</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Layer2"</span>, <span style="color: #0000dd;">0</span>, <span style="color: #ff00ff;">"ZoomDest"</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// return the plot index of newly created layer</span>
        graph_arrange_layers<span style="color: #000000;">(</span>gp, <span style="color: #0000dd;">2</span>, <span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// 2 rows 1 column</span>
        
        Worksheet       wks;
        wks.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Origin"</span>, CREATE_HIDDEN<span style="color: #000000;">)</span>;
        
        string          strFile <span style="color: #000080;">=</span> GetAppPath<span style="color: #000000;">(</span><span style="color: #0000ff;">true</span><span style="color: #000000;">)</span> <span style="color: #000040;">+</span> <span style="color: #ff00ff;">"Samples<span style="color: #666666; font-weight: bold;">\\</span>Spectroscopy<span style="color: #666666; font-weight: bold;">\\</span>HiddenPeaks.dat"</span>;
        ASCIMP          ai;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> AscImpReadFileStruct<span style="color: #000000;">(</span>strFile, <span style="color: #000040;">&amp;</span>ai<span style="color: #000000;">)</span> <span style="color: #000040;">!</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
                out_str<span style="color: #000000;">(</span><span style="color: #ff00ff;">"Fail to read ASCII file struct."</span><span style="color: #000000;">)</span>;
                <span style="color: #0000ff;">return</span>;
        <span style="color: #000000;">}</span>
        
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #0000dd;">0</span> <span style="color: #000040;">!</span><span style="color: #000080;">=</span> wks.<span style="color: #000000;">ImportASCII</span><span style="color: #000000;">(</span>strFile, ai<span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
                out_str<span style="color: #000000;">(</span><span style="color: #ff00ff;">"Fail to import data"</span><span style="color: #000000;">)</span>;
                <span style="color: #0000ff;">return</span>;
        <span style="color: #000000;">}</span>
        
        <span style="color: #008000;">// plot source data to the first layer and second layer</span>
        DataRange drIn;
        drIn.<span style="color: #000000;">Add</span><span style="color: #000000;">(</span>wks, <span style="color: #0000dd;">0</span>, <span style="color: #ff00ff;">"X"</span><span style="color: #000000;">)</span>;
        drIn.<span style="color: #000000;">Add</span><span style="color: #000000;">(</span>wks, <span style="color: #0000dd;">1</span>, <span style="color: #ff00ff;">"Y"</span><span style="color: #000000;">)</span>;
        
        GraphLayer glSource <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;
        glSource.<span style="color: #000000;">AddPlot</span><span style="color: #000000;">(</span>drIn, IDM_PLOT_LINE<span style="color: #000000;">)</span>;
        
        DataRange dr2;
        dr2.<span style="color: #000000;">Add</span><span style="color: #000000;">(</span>wks, <span style="color: #0000dd;">0</span>, <span style="color: #ff00ff;">"X"</span><span style="color: #000000;">)</span>;
        dr2.<span style="color: #000000;">Add</span><span style="color: #000000;">(</span>wks, <span style="color: #0000dd;">1</span>, <span style="color: #ff00ff;">"Y"</span><span style="color: #000000;">)</span>;        
        GraphLayer glZoom <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span>nZoomLayer<span style="color: #000000;">)</span>;
        glZoom.<span style="color: #000000;">AddPlot</span><span style="color: #000000;">(</span>dr2, IDM_PLOT_LINE<span style="color: #000000;">)</span>;      
        
        <span style="color: #008000;">// add rectangle to first layer</span>
        GraphObject goRect <span style="color: #000080;">=</span> glSource.<span style="color: #000000;">CreateGraphObject</span><span style="color: #000000;">(</span>GROT_RECT<span style="color: #000000;">)</span>;
        goRect.<span style="color: #000000;">Attach</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
        
        Tree tr;
        tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Border</span>.<span style="color: #000000;">Color</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> SYSCOLOR_BLUE;
        tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Border</span>.<span style="color: #000000;">Width</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0.2</span>;
        tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Fill</span>.<span style="color: #000000;">Color</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> SYSCOLOR_CYAN;
        tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">BehindData</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
        tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimension</span>.<span style="color: #000000;">Left</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> glSource.<span style="color: #000000;">X</span>.<span style="color: #000000;">From</span> <span style="color: #000040;">+</span> <span style="color: #000000;">(</span>glSource.<span style="color: #000000;">X</span>.<span style="color: #000000;">To</span> <span style="color: #000040;">-</span> glSource.<span style="color: #000000;">X</span>.<span style="color: #000000;">From</span><span style="color: #000000;">)</span> <span style="color: #000040;">*</span> <span style="color: #0000dd;">0.2</span>;
        tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimension</span>.<span style="color: #000000;">Top</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> glSource.<span style="color: #000000;">Y</span>.<span style="color: #000000;">To</span> <span style="color: #000040;">-</span> <span style="color: #000000;">(</span>glSource.<span style="color: #000000;">Y</span>.<span style="color: #000000;">To</span> <span style="color: #000040;">-</span> glSource.<span style="color: #000000;">Y</span>.<span style="color: #000000;">From</span><span style="color: #000000;">)</span> <span style="color: #000040;">*</span> <span style="color: #0000dd;">0.4</span>;
        tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimension</span>.<span style="color: #000000;">Width</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> <span style="color: #000000;">(</span>glSource.<span style="color: #000000;">X</span>.<span style="color: #000000;">To</span> <span style="color: #000040;">-</span> glSource.<span style="color: #000000;">X</span>.<span style="color: #000000;">From</span><span style="color: #000000;">)</span> <span style="color: #000040;">*</span> <span style="color: #0000dd;">0.2</span>;
        tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimension</span>.<span style="color: #000000;">Height</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> <span style="color: #000000;">(</span>glSource.<span style="color: #000000;">Y</span>.<span style="color: #000000;">To</span> <span style="color: #000040;">-</span> glSource.<span style="color: #000000;">Y</span>.<span style="color: #000000;">From</span><span style="color: #000000;">)</span> <span style="color: #000040;">*</span> <span style="color: #0000dd;">0.2</span>;  
        tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Script</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"string name$=this.name$; ZoomByRect(name$)"</span>;
        tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Event</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> GRCT_MOVE;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> goRect.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">(</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
                goRect.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">(</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>;
        <span style="color: #000000;">}</span>
        ZoomByRect<span style="color: #000000;">(</span>goRect.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// call this once in first time to init zoom layer according to the init postion of rectangle</span>
<span style="color: #000000;">}</span>

<span style="color: #008000;">// This function always assume the first layer is source data layer, the second layer is zoom layer.</span>
<span style="color: #0000ff;">void</span> ZoomByRect<span style="color: #000000;">(</span>string strRectName<span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>     
        GraphPage gp <span style="color: #000080;">=</span> Project.<span style="color: #000000;">GraphPages</span><span style="color: #000000;">(</span><span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// to get active graph page          </span>
        GraphLayer glSource <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;    
        GraphLayer glZoom <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>;
        
        GraphObject goRect <span style="color: #000080;">=</span> glSource.<span style="color: #000000;">GraphObjects</span><span style="color: #000000;">(</span>strRectName<span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #000040;">!</span>goRect <span style="color: #000000;">)</span>
                <span style="color: #0000ff;">return</span>;
        
        <span style="color: #0000ff;">double</span> dLeft <span style="color: #000080;">=</span> goRect.<span style="color: #000000;">X</span> <span style="color: #000040;">-</span> goRect.<span style="color: #000000;">DX</span> <span style="color: #000040;">/</span> <span style="color: #0000dd;">2.0</span>;
        <span style="color: #0000ff;">double</span> dRight <span style="color: #000080;">=</span> goRect.<span style="color: #000000;">X</span> <span style="color: #000040;">+</span> goRect.<span style="color: #000000;">DX</span> <span style="color: #000040;">/</span> <span style="color: #0000dd;">2.0</span>;
        <span style="color: #0000ff;">double</span> dTop <span style="color: #000080;">=</span> goRect.<span style="color: #000000;">Y</span> <span style="color: #000040;">+</span> goRect.<span style="color: #000000;">DY</span> <span style="color: #000040;">/</span> <span style="color: #0000dd;">2.0</span>;
        <span style="color: #0000ff;">double</span> dBottom <span style="color: #000080;">=</span> goRect.<span style="color: #000000;">Y</span> <span style="color: #000040;">-</span> goRect.<span style="color: #000000;">DY</span> <span style="color: #000040;">/</span> <span style="color: #0000dd;">2.0</span>;
        <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"%.2f, %.2f, %.2f, %.2f<span style="color: #666666; font-weight: bold;">\n</span>"</span>, dLeft, dRight, dTop, dBottom<span style="color: #000000;">)</span>;  

        glZoom.<span style="color: #000000;">X</span>.<span style="color: #000000;">From</span> <span style="color: #000080;">=</span> dLeft;
        glZoom.<span style="color: #000000;">X</span>.<span style="color: #000000;">To</span> <span style="color: #000080;">=</span> dRight;
        glZoom.<span style="color: #000000;">Y</span>.<span style="color: #000000;">From</span> <span style="color: #000080;">=</span> dBottom;
        glZoom.<span style="color: #000000;">Y</span>.<span style="color: #000000;">To</span> <span style="color: #000080;">=</span> dTop;      
<span style="color: #000000;">}</span>
</pre>
