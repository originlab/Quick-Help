<h1 class="firstheading">Inserting Links into Worksheet Cells</h1>

  <p>&#160;</p>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>Contents</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1"><a href="#Version_Info"><span class="tocnumber">1</span> <span class="toctext">Version Info</span></a></li>

      <li class="toclevel-1 tocsection-2"><a href="#Cell_Link_Notation"><span class="tocnumber">2</span> <span class="toctext">Cell Link Notation</span></a></li>

      <li class="toclevel-1 tocsection-3"><a href="#Examples"><span class="tocnumber">3</span> <span class="toctext">Examples</span></a></li>
    </ul>
  </div>

  <h2><a name="Version_Info"></a><span class="mw-headline">Version Info</span></h2>

  <p class="version">Minimum Origin Version Required: Origin91 SR0</p>

  <h2><a name="Cell_Link_Notation"></a><span class="mw-headline">Cell Link Notation</span></h2>

  <p>Cell link notation has the following syntax:</p>
  <pre>
Object://ocfilename:ocfuncname|displaytext|extrainfo
</pre>

  <ul>
    <li>ocfilename is a valid Origin C file with .c or .cpp suffix, and put under OriginInstallFolder\OriginC\Originlab.</li>

    <li>ocfuncname is the callback function name, with prototype like int object_callback(string&amp; label, string&amp; strExtraInfo);</li>

    <li>displaytext is the label to be displayed in the cell and will be passed to the callback as the first argument, and it can be modified by the callback.</li>

    <li>extrainfo is a string contains any user information which will be passed to the argument as the second argument, and it can be modified by the callback.</li>
  </ul>

  <h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>

  <p>This example below shows how to use cell link notation.</p>

  <ul>
    <li>Copy the notation: "OBJECT://UserLink.c:UserCallback|Go to Result Sheet|Result sheet" to any cell of a workbook.</li>
  </ul>

  <ul>
    <li>create a new OC file UserLink.c and put under \OriginC\Originlab, with content below:</li>
  </ul>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">int</span> UserCallback<span style="color: #000000;">(</span>string<span style="color: #000040;">&amp;</span> strLabel, string<span style="color: #000040;">&amp;</span> strExtra<span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
        strExtra <span style="color: #000080;">=</span><span style="color: #ff00ff;">"Result Sheet"</span>;
        strLabel <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"Go to Result sheet"</span>;
        
        <span style="color: #008000;">// Access the workbook named "Book1"</span>
        WorksheetPage wksPage<span style="color: #000000;">(</span><span style="color: #ff00ff;">"Book1"</span><span style="color: #000000;">)</span>;
 
        <span style="color: #008000;">// Add a new sheet to the workbook</span>
        <span style="color: #0000ff;">int</span> index <span style="color: #000080;">=</span> wksPage.<span style="color: #000000;">AddLayer</span><span style="color: #000000;">(</span>strExtra<span style="color: #000000;">)</span>;
        
        <span style="color: #008000;">// Access the new worksheet</span>
        Worksheet wksNew <span style="color: #000080;">=</span> wksPage.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span>index<span style="color: #000000;">)</span>; 
        
        <span style="color: #008000;">// Set the new worksheet to be active</span>
        set_active_layer<span style="color: #000000;">(</span>wksNew<span style="color: #000000;">)</span>;
    
        <span style="color: #0000ff;">return</span> <span style="color: #0000dd;">0</span>;
        
<span style="color: #000000;">}</span>
</pre>

  <ul>
    <li>Go back to the cell with link notation, then click it.</li>
  </ul>
