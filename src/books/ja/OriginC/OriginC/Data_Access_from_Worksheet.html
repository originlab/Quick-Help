<h1 class="firstheading">Data Access from Worksheet</h1>

  <p>&#160;</p>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>Contents</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1"><a href="#Version_Info"><span class="tocnumber">1</span> <span class="toctext">Version Info</span></a></li>

      <li class="toclevel-1 tocsection-2"><a href="#Remark"><span class="tocnumber">2</span> <span class="toctext">Remark</span></a></li>

      <li class="toclevel-1 tocsection-3">
        <a href="#Numeric"><span class="tocnumber">3</span> <span class="toctext">Numeric</span></a>

        <ul>
          <li class="toclevel-2 tocsection-4"><a href="#Get_Numeric_Dataset"><span class="tocnumber">3.1</span> <span class="toctext">Get Numeric Dataset</span></a></li>

          <li class="toclevel-2 tocsection-5"><a href="#Modify_Numeric_Dataset"><span class="tocnumber">3.2</span> <span class="toctext">Modify Numeric Dataset</span></a></li>

          <li class="toclevel-2 tocsection-6"><a href="#Access_One_Numeric_Cell"><span class="tocnumber">3.3</span> <span class="toctext">Access One Numeric Cell</span></a></li>

          <li class="toclevel-2 tocsection-7"><a href="#Put_Large_Dataset_to_Worksheet"><span class="tocnumber">3.4</span> <span class="toctext">Put Large Dataset to Worksheet</span></a></li>
        </ul>
      </li>

      <li class="toclevel-1 tocsection-8">
        <a href="#String"><span class="tocnumber">4</span> <span class="toctext">String</span></a>

        <ul>
          <li class="toclevel-2 tocsection-9"><a href="#Get.2FPut_String_Array"><span class="tocnumber">4.1</span> <span class="toctext">Get/Put String Array</span></a></li>

          <li class="toclevel-2 tocsection-10"><a href="#Access_One_String_Cell"><span class="tocnumber">4.2</span> <span class="toctext">Access One String Cell</span></a></li>
        </ul>
      </li>

      <li class="toclevel-1 tocsection-11"><a href="#Date_and_Time"><span class="tocnumber">5</span> <span class="toctext">Date and Time</span></a></li>

      <li class="toclevel-1 tocsection-12"><a href="#Missing_Value"><span class="tocnumber">6</span> <span class="toctext">Missing Value</span></a></li>
    </ul>
  </div>

  <p>&#160;</p>

  <h2><a name="Version_Info"></a><span class="mw-headline">Version Info</span></h2>

  <p class="version">Minimum Origin Version Required: Origin 8 SR0</p>

  <h2><a name="Remark"></a><span class="mw-headline">Remark</span></h2>

  <p>This section introduced access numeric data, text, Julian date/time data from Origin worksheet window.</p>

  <p>More related details please reference to the following Origin C Reference sections:</p>

  <p><a href="../../OriginC/Category/WorksheetPage_(class).html" title="Category:WorksheetPage (class)">WorksheetPage class</a></p>

  <p><a href="../../OriginC/Category/Worksheet_(class).html" title="Category:Worksheet (class)">Worksheet class</a></p>

  <p><a href="../../OriginC/Category/Column_(class).html" title="Category:Column (class)">Column class</a></p>

  <p><a href="../../OriginC/Category/DataRange_(class).html" title="Category:DataRange (class)">DataRange class</a></p>

  <p><a href="../../OriginC/Category/Vectorbase_(class).html" title="Category:Vectorbase (class)">vectorbase class</a></p>

  <p><a href="../../OriginC/Category/Vector_(class).html" title="Category:Vector (class)">vector class</a></p>

  <p>&#160;</p>

  <h2><a name="Numeric"></a><span class="mw-headline">Numeric</span></h2>

  <h3><a name="Get_Numeric_Dataset"></a><span class="mw-headline">Get Numeric Dataset</span></h3>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">void</span> GetNumericDataset<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
        Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> wks <span style="color: #000000;">)</span> <span style="color: #008000;">// if active layer is Worksheet</span>
        <span style="color: #000000;">{</span>
                foreach<span style="color: #000000;">(</span>Column col in wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">)</span>
                <span style="color: #000000;">{</span>
                        vectorbase<span style="color: #000040;">&amp;</span> vec <span style="color: #000080;">=</span> col.<span style="color: #000000;">GetDataObject</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// use vectorbase here since data in column can be any numeric data type, for example, double, int, complex. </span>
                        
                        <span style="color: #0000ff;">double</span> dSum;
                        vec.<span style="color: #000000;">Sum</span><span style="color: #000000;">(</span>dSum<span style="color: #000000;">)</span>;
                        <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"The sum of the %dth column is %f<span style="color: #666666; font-weight: bold;">\n</span>"</span>, col.<span style="color: #000000;">GetIndex</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000040;">+</span><span style="color: #0000dd;">1</span>, dSum<span style="color: #000000;">)</span>; <span style="color: #008000;">// GetIndex return index with 0 offset</span>
                <span style="color: #000000;">}</span>
        <span style="color: #000000;">}</span>
<span style="color: #000000;">}</span>
</pre>

  <h3><a name="Modify_Numeric_Dataset"></a><span class="mw-headline">Modify Numeric Dataset</span></h3>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">void</span> ModifyNumericDataset<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
        Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> wks <span style="color: #000040;">&amp;&amp;</span> wks.<span style="color: #000000;">GetNumCols</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000080;">&gt;=</span> <span style="color: #0000dd;">2</span> <span style="color: #000000;">)</span> <span style="color: #008000;">//to make sure active window is Worksheet and at least exist two columns</span>
        <span style="color: #000000;">{</span>
                DataRange dr;
                dr.<span style="color: #000000;">Add</span><span style="color: #000000;">(</span>wks, <span style="color: #0000dd;">0</span>, <span style="color: #ff00ff;">"X"</span><span style="color: #000000;">)</span>;
                dr.<span style="color: #000000;">Add</span><span style="color: #000000;">(</span>wks, <span style="color: #0000dd;">1</span>, <span style="color: #ff00ff;">"X"</span><span style="color: #000000;">)</span>;
                
                vector vA, vB;
                dr.<span style="color: #000000;">GetData</span><span style="color: #000000;">(</span><span style="color: #000040;">&amp;</span>vA, <span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;
                dr.<span style="color: #000000;">GetData</span><span style="color: #000000;">(</span><span style="color: #000040;">&amp;</span>vB, <span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>;
                
                <span style="color: #008000;">// sort the whole worksheet by column A with ascending</span>
                vector<span style="color: #000080;">&lt;</span>uint<span style="color: #000080;">&gt;</span> vnIndices;
                vA.<span style="color: #000000;">Sort</span><span style="color: #000000;">(</span>SORT_ASCENDING, <span style="color: #0000ff;">TRUE</span>, vnIndices<span style="color: #000000;">)</span>; <span style="color: #008000;">// sort column A and returned order indices</span>
                vB.<span style="color: #000000;">Reorder</span><span style="color: #000000;">(</span>vnIndices<span style="color: #000000;">)</span>; <span style="color: #008000;">// reorder column B by column A indices</span>
                
                dr.<span style="color: #000000;">SetData</span><span style="color: #000000;">(</span>vA, <span style="color: #0000ff;">false</span>, <span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;
                dr.<span style="color: #000000;">SetData</span><span style="color: #000000;">(</span>vB, <span style="color: #0000ff;">false</span>, <span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>;
        <span style="color: #000000;">}</span>
<span style="color: #000000;">}</span>
</pre>

  <h3><a name="Access_One_Numeric_Cell"></a><span class="mw-headline">Access One Numeric Cell</span></h3>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">void</span> AccessNumericData<span style="color: #000000;">(</span><span style="color: #0000ff;">int</span> nRow <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>, <span style="color: #0000ff;">int</span> nCol <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
        Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #000040;">!</span>wks <span style="color: #000000;">)</span>
                <span style="color: #0000ff;">return</span>;
        
        <span style="color: #0000ff;">double</span> dd <span style="color: #000080;">=</span> wks.<span style="color: #000000;">Cell</span><span style="color: #000000;">(</span>nRow, nCol<span style="color: #000000;">)</span>;
        out_double<span style="color: #000000;">(</span><span style="color: #ff00ff;">"The original data is "</span>, dd<span style="color: #000000;">)</span>;
        
        dd <span style="color: #000080;">=</span> <span style="color: #0000dd;">100</span>;
        wks.<span style="color: #000000;">SetCell</span><span style="color: #000000;">(</span>nRow, nCol, dd<span style="color: #000000;">)</span>;
        out_double<span style="color: #000000;">(</span><span style="color: #ff00ff;">"The modified data is "</span>, dd<span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span>
</pre>

  <h3><a name="Put_Large_Dataset_to_Worksheet"></a><span class="mw-headline">Put Large Dataset to Worksheet</span></h3>

  <p>In order to keep Origin C function more efficient on putting the large dataset to worksheet, for example 5000 columns, need to do like the steps below.</p>

  <ul>
    <li>Prepare the columns and rows before put into data to worksheet.</li>

    <li>Use <b>Worksheet::SetSize</b>, not use <b>Worksheet::AddCol</b> to set size.</li>

    <li>Set size on an empty worksheet, means no column, since need to check the short name of the existed columns to avoid duplicate name when add new column. This check may cost many times. Can use <b>while( wks.DeleteCol(0) );</b> to remove all columns.</li>

    <li>Put data to worksheet column by buffer, <b>DataObject::GetInternalDataBuffer</b>.</li>

    <li>Keep Code Builder close when running function to set size and put back data to worksheet.</li>
  </ul>

  <p>See following example codes:</p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">void</span> PutLargeDataset<span style="color: #000000;">(</span><span style="color: #0000ff;">int</span> rows <span style="color: #000080;">=</span> <span style="color: #0000dd;">100</span>, <span style="color: #0000ff;">int</span> cols <span style="color: #000080;">=</span> <span style="color: #0000dd;">500</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
        <span style="color: #008000;">// prepare worksheet size</span>
        Worksheet wks;
        wks.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Origin"</span><span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">while</span><span style="color: #000000;">(</span> wks.<span style="color: #000000;">DeleteCol</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>;   
        wks.<span style="color: #000000;">SetSize</span><span style="color: #000000;">(</span>rows, cols<span style="color: #000000;">)</span>;
        
        <span style="color: #008000;">// put dataset to worksheet column one by one</span>
        foreach<span style="color: #000000;">(</span>Column col in wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
                col.<span style="color: #000000;">SetFormat</span><span style="color: #000000;">(</span>OKCOLTYPE_NUMERIC<span style="color: #000000;">)</span>;
                col.<span style="color: #000000;">SetInternalData</span><span style="color: #000000;">(</span>FSI_SHORT<span style="color: #000000;">)</span>;
                col.<span style="color: #000000;">SetUpperBound</span><span style="color: #000000;">(</span>rows<span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>;<span style="color: #008000;">//index of last row, 0 offset</span>
                
                <span style="color: #0000ff;">int</span>        nElementSize;
                uint    nNum;
                LPVOID  pData <span style="color: #000080;">=</span> col.<span style="color: #000000;">GetInternalDataBuffer</span><span style="color: #000000;">(</span><span style="color: #000040;">&amp;</span>nElementSize, <span style="color: #000040;">&amp;</span>nNum<span style="color: #000000;">)</span>;          
                <span style="color: #0000ff;">short</span><span style="color: #000040;">*</span> psBuff <span style="color: #000080;">=</span> <span style="color: #000000;">(</span><span style="color: #0000ff;">short</span><span style="color: #000040;">*</span><span style="color: #000000;">)</span>pData;
                
                <span style="color: #008000;">// OC loop is still slow, but you might pass this pointer to your DLL</span>
                <span style="color: #008000;">// for much faster manipulation, here we just show that the pointer works</span>
                <span style="color: #0000ff;">for</span><span style="color: #000000;">(</span><span style="color: #0000ff;">int</span> ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; ii <span style="color: #000080;">&lt;</span> rows; ii<span style="color: #000040;">++</span>, psBuff<span style="color: #000040;">++</span><span style="color: #000000;">)</span>
                <span style="color: #000000;">{</span>
                        <span style="color: #000040;">*</span>psBuff <span style="color: #000080;">=</span> <span style="color: #000000;">(</span>ii<span style="color: #000040;">+</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span> <span style="color: #000040;">*</span> <span style="color: #000000;">(</span>col.<span style="color: #000000;">GetIndex</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000040;">+</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>;
                <span style="color: #000000;">}</span>
                col.<span style="color: #000000;">ReleaseBuffer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// do NOT remember to call this</span>
        <span style="color: #000000;">}</span>     
<span style="color: #000000;">}</span>
</pre>

  <h2><a name="String"></a><span class="mw-headline">String</span></h2>

  <h3><a name="Get.2FPut_String_Array"></a><span class="mw-headline">Get/Put String Array</span></h3>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">void</span> AccessStringArray<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
        Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> wks <span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
                foreach<span style="color: #000000;">(</span>Column col in wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">)</span>
                <span style="color: #000000;">{</span>
                        <span style="color: #0000ff;">int</span> nFormat <span style="color: #000080;">=</span> col.<span style="color: #000000;">GetFormat</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
                        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> OKCOLTYPE_TEXT <span style="color: #000080;">==</span> nFormat <span style="color: #000040;">||</span> OKCOLTYPE_TEXT_NUMERIC <span style="color: #000080;">==</span> nFormat <span style="color: #000000;">)</span>
                        <span style="color: #000000;">{</span>
                                vector<span style="color: #000080;">&lt;</span>string<span style="color: #000080;">&gt;</span> vstr;
                                col.<span style="color: #000000;">GetStringArray</span><span style="color: #000000;">(</span>vstr<span style="color: #000000;">)</span>;
                                
                                DWORD dwOptions <span style="color: #000080;">=</span> SORT_ASCENDING <span style="color: #000040;">|</span> SORT_CASE_SENSITIVE;
                                vstr.<span style="color: #000000;">Sort</span><span style="color: #000000;">(</span>dwOptions<span style="color: #000000;">)</span>; <span style="color: #008000;">// ascending sort with case sensitive</span>
                                
                                col.<span style="color: #000000;">PutStringArray</span><span style="color: #000000;">(</span>vstr<span style="color: #000000;">)</span>; <span style="color: #008000;">// put back sorted string array to column</span>
                        <span style="color: #000000;">}</span>
                <span style="color: #000000;">}</span>             
        <span style="color: #000000;">}</span>
<span style="color: #000000;">}</span>
</pre>

  <h3><a name="Access_One_String_Cell"></a><span class="mw-headline">Access One String Cell</span></h3>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">void</span> AccessString<span style="color: #000000;">(</span><span style="color: #0000ff;">int</span> nRow <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>, <span style="color: #0000ff;">int</span> nCol <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
        Worksheet wks;
        wks.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Origin"</span><span style="color: #000000;">)</span>;
        
        string strVal;
        wks.<span style="color: #000000;">GetCell</span><span style="color: #000000;">(</span>nRow, nCol, strVal<span style="color: #000000;">)</span>;
        out_str<span style="color: #000000;">(</span>strVal<span style="color: #000000;">)</span>;
        
        strVal <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"This is an example!"</span>;
        wks.<span style="color: #000000;">SetCell</span><span style="color: #000000;">(</span>nRow, nCol, strVal<span style="color: #000000;">)</span>;
        out_str<span style="color: #000000;">(</span>strVal<span style="color: #000000;">)</span>;
        
        Column col <span style="color: #000080;">=</span> wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">(</span>nCol<span style="color: #000000;">)</span>;
        col.<span style="color: #000000;">SetWidth</span><span style="color: #000000;">(</span><span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// -1 to set the width to the largest cell in the column.      </span>
<span style="color: #000000;">}</span>
</pre>

  <h2><a name="Date_and_Time"></a><span class="mw-headline">Date and Time</span></h2>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">void</span> AccessDateTimeData<span style="color: #000000;">(</span><span style="color: #0000ff;">int</span> nColIndex<span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
        Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #000040;">!</span>wks <span style="color: #000000;">)</span>
                <span style="color: #0000ff;">return</span>;    
        
        Column col<span style="color: #000000;">(</span>wks, nColIndex<span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #000040;">!</span>col <span style="color: #000000;">)</span>
                <span style="color: #0000ff;">return</span>;    
                
        <span style="color: #008000;">// find out the smallest date</span>
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> OKCOLTYPE_DATE <span style="color: #000080;">==</span> col.<span style="color: #000000;">GetFormat</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000040;">||</span> OKCOLTYPE_TIME <span style="color: #000080;">==</span> col.<span style="color: #000000;">GetFormat</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
                vector<span style="color: #000040;">&amp;</span> vec <span style="color: #000080;">=</span> col.<span style="color: #000000;">GetDataObject</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// return the Julian date value</span>
                <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> vec.<span style="color: #000000;">GetSize</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000040;">!</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">)</span>
                <span style="color: #000000;">{</span>
                        vec.<span style="color: #000000;">Sort</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
                        <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"The smallest date is %s<span style="color: #666666; font-weight: bold;">\n</span>"</span>, get_date_str<span style="color: #000000;">(</span>vec<span style="color: #000000;">[</span><span style="color: #0000dd;">0</span><span style="color: #000000;">]</span>, LDF_LONG<span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
                <span style="color: #000000;">}</span>
        <span style="color: #000000;">}</span>
<span style="color: #000000;">}</span>
</pre>

  <h2><a name="Missing_Value"></a><span class="mw-headline">Missing Value</span></h2>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">void</span> fill_with_missing<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
        Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">// get active worksheet</span>
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span><span style="color: #000040;">!</span>wks<span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
                out_str<span style="color: #000000;">(</span><span style="color: #ff00ff;">"The active worksheet not exist!"</span><span style="color: #000000;">)</span>;
                <span style="color: #0000ff;">return</span>;
        <span style="color: #000000;">}</span>
        
        DataRange dr;  
        dr.<span style="color: #000000;">Add</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"X"</span>, wks, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">0</span>, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">// the whole worksheet</span>
        dr.<span style="color: #000000;">Replace</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span>, NANUM, WKSREPL_TEST_EQUAL<span style="color: #000000;">)</span>;  <span style="color: #008000;">// replace by missing, missing=NANUM</span>

        Dataset ds<span style="color: #000000;">(</span>wks, <span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">// dataset attached to column 1</span>
        ds <span style="color: #000080;">=</span> NANUM;  <span style="color: #008000;">// clear column 1</span>
<span style="color: #000000;">}</span>
</pre>
