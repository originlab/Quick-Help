<h1 class="firstheading">Managing Project</h1>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>Contents</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1"><a href="#Version_Info"><span class="tocnumber">1</span> <span class="toctext">Version Info</span></a></li>

      <li class="toclevel-1 tocsection-2"><a href="#Customize_Project_Explorer"><span class="tocnumber">2</span> <span class="toctext">Customize Project Explorer</span></a></li>

      <li class="toclevel-1 tocsection-3"><a href="#Project_Operation"><span class="tocnumber">3</span> <span class="toctext">Project Operation</span></a></li>
    </ul>
  </div>

  <h2><a name="Version_Info"></a><span class="mw-headline">Version Info</span></h2>

  <p class="version">Minimum Origin Version Required: Origin 8 SR1</p>

  <h2><a name="Customize_Project_Explorer"></a><span class="mw-headline">Customize Project Explorer</span></h2>

  <p>This example is used to customize the structure of Project Explorer.</p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">void</span> project_explorer<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
        Project pro;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span><span style="color: #000040;">!</span>pro.<span style="color: #000000;">Open</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>  <span style="color: #008000;">// create a new project</span>
        <span style="color: #000000;">{</span>
                out_str<span style="color: #000000;">(</span><span style="color: #ff00ff;">"Failed to create a new project!<span style="color: #666666; font-weight: bold;">\n</span>"</span><span style="color: #000000;">)</span>;
                <span style="color: #0000ff;">return</span>;
        <span style="color: #000000;">}</span>
        
        Folder fldRoot <span style="color: #000080;">=</span> pro.<span style="color: #000000;">RootFolder</span>;  <span style="color: #008000;">// get root folder</span>
        foreach<span style="color: #000000;">(</span>Folder subfld in fldRoot.<span style="color: #000000;">Subfolders</span><span style="color: #000000;">)</span>  <span style="color: #008000;">// if subfolder exists, delete it</span>
        <span style="color: #000000;">{</span>
                fldRoot.<span style="color: #000000;">RemoveSubFolder</span><span style="color: #000000;">(</span>subfld.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
        <span style="color: #000000;">}</span>
        
        Folder fldSubL1_1 <span style="color: #000080;">=</span> fldRoot.<span style="color: #000000;">AddSubfolder</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Test Subjects"</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">// level 1 first subfolder</span>
        Folder fldSubL2_11 <span style="color: #000080;">=</span> fldSubL1_1.<span style="color: #000000;">AddSubfolder</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Trials"</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">// level 2 subfolder, in level 1 first subfolder</span>
        Folder fldSubL2_12 <span style="color: #000080;">=</span> fldSubL1_1.<span style="color: #000000;">AddSubfolder</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Results"</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">// level 2 subfolder, in level 1 first subfolder</span>
        
        Folder fldSubL1_2 <span style="color: #000080;">=</span> fldRoot.<span style="color: #000000;">AddSubfolder</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Control Subjects"</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">// level 1 second subfolder </span>
        Folder fldSubL2_21 <span style="color: #000080;">=</span> fldSubL1_2.<span style="color: #000000;">AddSubfolder</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Trials"</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">// level 2 subfolder, in level 1 second subfolder</span>
        Folder fldSubL2_22 <span style="color: #000080;">=</span> fldSubL1_2.<span style="color: #000000;">AddSubfolder</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Results"</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">// level 2 subfolder, in level 1 second subfolder</span>
        
        Folder fldSubL1_3 <span style="color: #000080;">=</span> fldRoot.<span style="color: #000000;">AddSubfolder</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Comparison"</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">// level 1 third subfolder </span>
<span style="color: #000000;">}</span>
</pre>

  <h2><a name="Project_Operation"></a><span class="mw-headline">Project Operation</span></h2>

  <p>The following example is capable of managing project, including creating a new project, appending an existing project to another project, saving a active folder as project, saving a worksheet as template, and saving the project with a new name.</p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">void</span> managing_project<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
        Project pro;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span><span style="color: #000040;">!</span>pro.<span style="color: #000000;">Open</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>  <span style="color: #008000;">// create a new project</span>
        <span style="color: #000000;">{</span>
                out_str<span style="color: #000000;">(</span><span style="color: #ff00ff;">"Failed to create a new project!<span style="color: #666666; font-weight: bold;">\n</span>"</span><span style="color: #000000;">)</span>;
                <span style="color: #0000ff;">return</span>;
        <span style="color: #000000;">}</span>
        
        <span style="color: #008000;">// append the existing project to the new project</span>
        string strAppendPath <span style="color: #000080;">=</span> GetAppPath<span style="color: #000000;">(</span><span style="color: #0000ff;">true</span><span style="color: #000000;">)</span> <span style="color: #000040;">+</span> <span style="color: #ff00ff;">"Samples<span style="color: #666666; font-weight: bold;">\\</span>Graphing<span style="color: #666666; font-weight: bold;">\\</span>OffsetY.opj"</span>;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span><span style="color: #000040;">!</span>pro.<span style="color: #000000;">Open</span><span style="color: #000000;">(</span>strAppendPath, OPJ_OPEN_APPEND_NEW_FOLDER<span style="color: #000000;">)</span><span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
                out_str<span style="color: #000000;">(</span><span style="color: #ff00ff;">"Failed to append project!<span style="color: #666666; font-weight: bold;">\n</span>"</span><span style="color: #000000;">)</span>;
                <span style="color: #0000ff;">return</span>;
        <span style="color: #000000;">}</span>
        
        <span style="color: #008000;">// save folder as project, worksheet as template with data and storage</span>
        string strFolder <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"/Folder1/OffsetY"</span>;  <span style="color: #008000;">// folder path</span>
        Folder fld<span style="color: #000000;">(</span>strFolder<span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span>fld.<span style="color: #000000;">IsValid</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>  <span style="color: #008000;">// if the folder exists</span>
        <span style="color: #000000;">{</span>
                <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span><span style="color: #000040;">!</span>fld.<span style="color: #000000;">Activate</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>  <span style="color: #008000;">// activate the folder</span>
                <span style="color: #000000;">{</span>
                        out_str<span style="color: #000000;">(</span><span style="color: #ff00ff;">"Failed to activate the folder!<span style="color: #666666; font-weight: bold;">\n</span>"</span><span style="color: #000000;">)</span>;
                        <span style="color: #0000ff;">return</span>;
                <span style="color: #000000;">}</span>
                
                <span style="color: #008000;">// path of the folder project to be saved</span>
                string strSaveFolderPath <span style="color: #000080;">=</span> GetAppPath<span style="color: #000000;">(</span><span style="color: #0000ff;">false</span><span style="color: #000000;">)</span> <span style="color: #000040;">+</span> <span style="color: #ff00ff;">"OffsetYFolder.opj"</span>;
                
                <span style="color: #008000;">// save the folder as project with subfolders and attached files</span>
                <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span>fld.<span style="color: #000000;">SaveAsProject</span><span style="color: #000000;">(</span>strSaveFolderPath, SFC_INCLUDE_SUBFOLDERS <span style="color: #000040;">|</span> SFC_INCLUDE_ATTACHED_FILES<span style="color: #000000;">)</span><span style="color: #000000;">)</span>
                        out_str<span style="color: #000000;">(</span><span style="color: #ff00ff;">"Save the folder as project successfully!<span style="color: #666666; font-weight: bold;">\n</span>"</span><span style="color: #000000;">)</span>;
                
                <span style="color: #008000;">// loop pages in the folder and save worksheet as template</span>
                <span style="color: #0000ff;">for</span><span style="color: #000000;">(</span><span style="color: #0000ff;">int</span> iPage; iPage<span style="color: #000080;">&lt;</span>fld.<span style="color: #000000;">Pages</span>.<span style="color: #000000;">Count</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; iPage<span style="color: #000040;">++</span><span style="color: #000000;">)</span>
                <span style="color: #000000;">{</span>
                        PageBase pg <span style="color: #000080;">=</span> fld.<span style="color: #000000;">Pages</span><span style="color: #000000;">(</span>iPage<span style="color: #000000;">)</span>;
            <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span>EXIST_WKS <span style="color: #000040;">!</span><span style="color: #000080;">=</span> pg.<span style="color: #000000;">GetType</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>  <span style="color: #008000;">// if the page is workbook</span>
                <span style="color: #0000ff;">continue</span>;
            WorksheetPage wp <span style="color: #000080;">=</span> pg;
            Worksheet wks <span style="color: #000080;">=</span> wp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">// get first worksheet in the workbook</span>
                        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span>wks<span style="color: #000000;">)</span>
                        <span style="color: #000000;">{</span>
                                <span style="color: #008000;">// save the worksheet as template with data and storage</span>
                                <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span>wks.<span style="color: #000000;">SaveAs</span><span style="color: #000000;">(</span>GetAppPath<span style="color: #000000;">(</span><span style="color: #0000ff;">false</span><span style="color: #000000;">)</span> <span style="color: #000040;">+</span> wks.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>, OOSAS_DATA <span style="color: #000040;">|</span> OOSAS_STORAGE<span style="color: #000000;">)</span><span style="color: #000000;">)</span>
                                        out_str<span style="color: #000000;">(</span><span style="color: #ff00ff;">"Save as worksheet template successfully!<span style="color: #666666; font-weight: bold;">\n</span>"</span><span style="color: #000000;">)</span>;

                        <span style="color: #000000;">}</span>
                        <span style="color: #0000ff;">else</span>
                                out_str<span style="color: #000000;">(</span><span style="color: #ff00ff;">"Not a valid worksheet page!<span style="color: #666666; font-weight: bold;">\n</span>"</span><span style="color: #000000;">)</span>;
                <span style="color: #000000;">}</span>

        <span style="color: #000000;">}</span>
        
        <span style="color: #008000;">// path of the new project</span>
        string strNewPath <span style="color: #000080;">=</span> GetAppPath<span style="color: #000000;">(</span><span style="color: #0000ff;">false</span><span style="color: #000000;">)</span> <span style="color: #000040;">+</span> <span style="color: #ff00ff;">"MyNewProject.opj"</span>;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span>pro.<span style="color: #000000;">Save</span><span style="color: #000000;">(</span>strNewPath<span style="color: #000000;">)</span><span style="color: #000000;">)</span>  <span style="color: #008000;">// save the project as a new project</span>
                out_str<span style="color: #000000;">(</span><span style="color: #ff00ff;">"Succeed to save the new project!<span style="color: #666666; font-weight: bold;">\n</span>"</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span>
</pre>
