<h1 class="firstheading">OHLC Bar Chart</h1>

  <p>&#160;</p>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>Contents</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1"><a href="#Version_Info"><span class="tocnumber">1</span> <span class="toctext">Version Info</span></a></li>

      <li class="toclevel-1 tocsection-2"><a href="#Example"><span class="tocnumber">2</span> <span class="toctext">Example</span></a></li>
    </ul>
  </div>

  <p>&#160;</p>

  <p class='urlname' style='display: none'>OHLC_Bar_Chart</p>

  <h2><a name="Version_Info"></a><span class="mw-headline">Version Info</span></h2>

  <p class="version">Minimum Origin Version Required: Origin8.5 SR0</p>

  <h2><a name="Example"></a><span class="mw-headline">Example</span></h2>

  <ol>
    <li>Download the source data file from our <a class="external text" href="http://www.originlab.com/ftp/graph_gallery/data/OHLC-Volume_Stock.txt" target="_blank">ftp</a> and import it into Origin. When importing this file, keep the system default settings.</li>

    <li>Rename the short name of both workbook and worksheet to “OHLC”.</li>

    <li>Set column A as Date format. Double click on the header of column A to bring up the <b>Column Properties</b> dialog. Expand the <b>Options</b> branch in <b>Properties</b> tab, select <b>Date</b> from the <b>Format</b> drop-down list, and then select <b>Custom Display</b> from the <b>Display</b> drop-down list. Type <b>dd'-'MMM'-'yyyy</b> in the <b>Custom Display</b> combo box. Click <b>OK</b> button.

      <dl>
        <dd><a class="image"><img alt="Column Properties.png" src="../images/OHLC_Stock_Chart/Column_Properties.png" width="400"></a></dd>
      </dl>
    </li>

    <li>Compile and run the following function plot to a OHLC bar chart.
      <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">void</span> plot_OHLC_bar_chart_ex1<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
    GraphPage gp;
    gp.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
    GraphLayer gl <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span><span style="color: #000040;">!</span>gl<span style="color: #000000;">)</span>
        <span style="color: #0000ff;">return</span>;
 
    <span style="color: #008000;">// Draw an OHLC bar chart</span>
    Tree tr;
    TreeNode trLayer <span style="color: #000080;">=</span> tr.<span style="color: #000000;">AddNode</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Layer0"</span><span style="color: #000000;">)</span>;
    trLayer.<span style="color: #000000;">Rescale</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
 
    TreeNode trDataPlot <span style="color: #000080;">=</span> trLayer.<span style="color: #000000;">AddNode</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"DataPlot1"</span><span style="color: #000000;">)</span>;
    trDataPlot.<span style="color: #000000;">PlotType</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"OHLC"</span>;
 
    TreeNode trDesigs <span style="color: #000080;">=</span> trDataPlot.<span style="color: #000000;">AddNode</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"PlotDesigs"</span><span style="color: #000000;">)</span>;
    trDesigs.<span style="color: #000000;">Type</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">221</span>;
    trDesigs.<span style="color: #000000;">ExValue</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
 
    <span style="color: #008000;">// Specify the workbook and worksheet in order to point to the data.</span>
    trDesigs.<span style="color: #000000;">WksPage</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"OHLC"</span>;
    trDesigs.<span style="color: #000000;">WksLayer</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"OHLC"</span>;
 
    <span style="color: #008000;">// Name the tree node with a prefix "DPC..."</span>
    TreeNode trOpen <span style="color: #000080;">=</span> trDesigs.<span style="color: #000000;">AddNode</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"DPC1"</span><span style="color: #000000;">)</span>;
    trOpen.<span style="color: #000000;">Desig</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> COLDESIG_OPEN;
    trOpen.<span style="color: #000000;">Name</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"B"</span>;
 
    TreeNode trHi <span style="color: #000080;">=</span> trDesigs.<span style="color: #000000;">AddNode</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"DPC2"</span><span style="color: #000000;">)</span>;
    trHi.<span style="color: #000000;">Desig</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> COLDESIG_HIGH;
    trHi.<span style="color: #000000;">Name</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"C"</span>;
 
    TreeNode trLo <span style="color: #000080;">=</span> trDesigs.<span style="color: #000000;">AddNode</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"DPC3"</span><span style="color: #000000;">)</span>;
    trLo.<span style="color: #000000;">Desig</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> COLDESIG_LOW;
    trLo.<span style="color: #000000;">Name</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"D"</span>;
 
    TreeNode trClose <span style="color: #000080;">=</span> trDesigs.<span style="color: #000000;">AddNode</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"DPC4"</span><span style="color: #000000;">)</span>;
    trClose.<span style="color: #000000;">Desig</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> COLDESIG_CLOSE;
    trClose.<span style="color: #000000;">Name</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"E"</span>;
 
    TreeNode trX <span style="color: #000080;">=</span> trDesigs.<span style="color: #000000;">AddNode</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"DPC5"</span><span style="color: #000000;">)</span>;
    trX.<span style="color: #000000;">Desig</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> COLDESIG_X;
    trX.<span style="color: #000000;">Name</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"A"</span>;
 
    gl.<span style="color: #000000;">AddPlots</span><span style="color: #000000;">(</span>tr.<span style="color: #000000;">Layer0</span><span style="color: #000000;">)</span>;
    
    <span style="color: #008000;">// Customize the graph layer format</span>
    Tree trFormat;
        trFormat.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Axes</span>.<span style="color: #000000;">X</span>.<span style="color: #000000;">Scale</span>.<span style="color: #000000;">Type</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">11</span>;
        trFormat.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Axes</span>.<span style="color: #000000;">X</span>.<span style="color: #000000;">Labels</span>.<span style="color: #000000;">BottomLabels</span>.<span style="color: #000000;">Font</span>.<span style="color: #000000;">Size</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">12</span>; 
        trFormat.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Axes</span>.<span style="color: #000000;">X</span>.<span style="color: #000000;">Labels</span>.<span style="color: #000000;">BottomLabels</span>.<span style="color: #000000;">Type</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;
        trFormat.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Axes</span>.<span style="color: #000000;">X</span>.<span style="color: #000000;">Labels</span>.<span style="color: #000000;">BottomLabels</span>.<span style="color: #000000;">DateFormat</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">21</span>;
        trFormat.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Axes</span>.<span style="color: #000000;">X</span>.<span style="color: #000000;">Labels</span>.<span style="color: #000000;">BottomLabels</span>.<span style="color: #000000;">DateCustomDisplay</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"dd'-'MMM'-'yyyy"</span>;
        trFormat.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Axes</span>.<span style="color: #000000;">X</span>.<span style="color: #000000;">Labels</span>.<span style="color: #000000;">BottomLabels</span>.<span style="color: #000000;">Angle</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">45</span>;
        trFormat.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Axes</span>.<span style="color: #000000;">Y</span>.<span style="color: #000000;">Labels</span>.<span style="color: #000000;">LeftLabels</span>.<span style="color: #000000;">Font</span>.<span style="color: #000000;">Size</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">12</span>; 

    <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> gl.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">(</span>trFormat.<span style="color: #000000;">Root</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>
        <span style="color: #0000ff;">bool</span> bRet <span style="color: #000080;">=</span> gl.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">(</span>trFormat, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// Update the graph layer format</span>
    <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span>bRet<span style="color: #000000;">)</span>     
        out_tree<span style="color: #000000;">(</span>gl.<span style="color: #000000;">GetFormat</span><span style="color: #000000;">(</span>FPB_ALL, FOB_ALL, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>; <span style="color: #008000;">//Output the whole format tree  </span>
<span style="color: #000000;">}</span>
</pre>
    </li>
  </ol>
