<h1 class="firstheading">Worksheet Sort Data</h1>

  <p>&#160;</p>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>Contents</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1"><a href="#Version_Info"><span class="tocnumber">1</span> <span class="toctext">Version Info</span></a></li>

      <li class="toclevel-1 tocsection-2"><a href="#Sort_Worksheet_By_One_Column"><span class="tocnumber">2</span> <span class="toctext">Sort Worksheet By One Column</span></a></li>

      <li class="toclevel-1 tocsection-3"><a href="#Nested_Sort_Worksheet_by_Customize_Settings"><span class="tocnumber">3</span> <span class="toctext">Nested Sort Worksheet by Customize Settings</span></a></li>
    </ul>
  </div>

  <h2><a name="Version_Info"></a><span class="mw-headline">Version Info</span></h2>

  <p class="version">Minimum Origin Version Required: Origin8 SR0</p>

  <h2><a name="Sort_Worksheet_By_One_Column"></a><span class="mw-headline">Sort Worksheet By One Column</span></h2>

  <p>This example shows how to sort data in ascending or descending order based on the values in the specified column number.</p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #008000;">//Before running this code, Worksheet with at least one column must exist in project.</span>
<span style="color: #0000ff;">void</span> wks_sort_data_ex<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
        Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;      <span style="color: #008000;">//Columns in the active worksheet contain values to be sorted.</span>
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span><span style="color: #000040;">!</span>wks<span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
                <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Error. Please active worksheet before running!"</span><span style="color: #000000;">)</span>;
                <span style="color: #0000ff;">return</span>;
        <span style="color: #000000;">}</span>
        
    <span style="color: #0000ff;">int</span> wByColNum <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;   <span style="color: #008000;">//column number to sort           </span>
        <span style="color: #0000ff;">bool</span> bMissingValuesSmall <span style="color: #000080;">=</span> <span style="color: #0000ff;">true</span>; <span style="color: #008000;">//Missing values are treated as smallest. true is also default value.</span>
        <span style="color: #0000ff;">int</span> iFromRow <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;        <span style="color: #008000;">//first row number to sort</span>
        <span style="color: #0000ff;">int</span> iFromCol <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;        <span style="color: #008000;">//first column number to sort</span>
        <span style="color: #0000ff;">int</span> iToRow <span style="color: #000080;">=</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>;    <span style="color: #008000;">//last row number to sort, default -1 sorts to last row</span>
        <span style="color: #0000ff;">int</span> iToCol <span style="color: #000080;">=</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>;    <span style="color: #008000;">//last column number to sort, default -1 sorts to last column </span>
        
        <span style="color: #008000;">//Sorts column B in worksheet in descending order</span>
        <span style="color: #0000ff;">bool</span> bRet <span style="color: #000080;">=</span> wks.<span style="color: #000000;">Sort</span><span style="color: #000000;">(</span>wByColNum, SORT_DESCENDING, bMissingValuesSmall, iFromRow, iFromCol, iToRow, iToCol<span style="color: #000000;">)</span>;
        
        <span style="color: #0000ff;">if</span> <span style="color: #000000;">(</span>bRet<span style="color: #000000;">)</span>
                out_str<span style="color: #000000;">(</span><span style="color: #ff00ff;">"Sort successful!"</span><span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">else</span>
                out_str<span style="color: #000000;">(</span><span style="color: #ff00ff;">"Sort error!"</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span>
</pre>

  <h2><a name="Nested_Sort_Worksheet_by_Customize_Settings"></a><span class="mw-headline">Nested Sort Worksheet by Customize Settings</span></h2>

  <p>This example shows how to do nested sort in worksheet.</p>

  <p>The working mechanism of the following example is same as Nested Sort dialog in Origin panel. To open the dialog, you can</p>

  <ol>
    <li>Highlight the columns you want to sort in worksheet</li>

    <li>Right click, select Sort Worksheet, then select Custom...</li>
  </ol>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #008000;">//Before running this code, Worksheet with at least one column must exist in project.</span>
<span style="color: #0000ff;">void</span> wks_nested_sort_data_ex<span style="color: #000000;">(</span><span style="color: #000000;">)</span> 
<span style="color: #000000;">{</span>
        Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span><span style="color: #000040;">!</span>wks<span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
                <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Error. Please active worksheet before running!"</span><span style="color: #000000;">)</span>;
                <span style="color: #0000ff;">return</span>;
        <span style="color: #000000;">}</span>
        
        vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> vSortByCols <span style="color: #000080;">=</span> <span style="color: #000000;">{</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">0</span><span style="color: #000000;">}</span>;       <span style="color: #008000;">//column numbers to sort. set Column B as primary sort key</span>
        vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> vOrder <span style="color: #000080;">=</span> <span style="color: #000000;">{</span>SORT_ASCENDING, SORT_DESCENDING<span style="color: #000000;">}</span>;   <span style="color: #008000;">//set the sort order of each column </span>
        
        <span style="color: #0000ff;">bool</span> bMissingValuesSmall <span style="color: #000080;">=</span> <span style="color: #0000ff;">true</span>; <span style="color: #008000;">//Missing values are treated as smallest. true is also default value.</span>
        <span style="color: #0000ff;">int</span> iFromRow <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;        <span style="color: #008000;">//first row number to sort</span>
        <span style="color: #0000ff;">int</span> iFromCol <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;        <span style="color: #008000;">//first column number to sort</span>
        <span style="color: #0000ff;">int</span> iToRow <span style="color: #000080;">=</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>;    <span style="color: #008000;">//last row number to sort, default -1 sorts to last row</span>
        <span style="color: #0000ff;">int</span> iToCol <span style="color: #000080;">=</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>;    <span style="color: #008000;">//last column number to sort, default -1 sorts to last column </span>
        
        <span style="color: #0000ff;">bool</span> bRet <span style="color: #000080;">=</span> wks.<span style="color: #000000;">Sort</span><span style="color: #000000;">(</span>vSortByCols, vOrder, bMissingValuesSmall, iFromRow, iFromCol, iToRow, iToCol<span style="color: #000000;">)</span>;
        
        <span style="color: #0000ff;">if</span> <span style="color: #000000;">(</span>bRet<span style="color: #000000;">)</span>
                out_str<span style="color: #000000;">(</span><span style="color: #ff00ff;">"Sort successful!"</span><span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">else</span>
                out_str<span style="color: #000000;">(</span><span style="color: #ff00ff;">"Sort error!"</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span>
</pre>
