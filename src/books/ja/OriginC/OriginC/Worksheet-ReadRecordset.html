<h1 class="firstheading">Worksheet::ReadRecordset</h1>

  <p><span class="OIndex" style="display:none">ReadRecordset</span></p>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>Contents</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>

      <li class="toclevel-1 tocsection-2"><a href="#Syntax"><span class="tocnumber">2</span> <span class="toctext">Syntax</span></a></li>

      <li class="toclevel-1 tocsection-3"><a href="#Parameters"><span class="tocnumber">3</span> <span class="toctext">Parameters</span></a></li>

      <li class="toclevel-1 tocsection-4"><a href="#Return"><span class="tocnumber">4</span> <span class="toctext">Return</span></a></li>

      <li class="toclevel-1 tocsection-5"><a href="#Examples"><span class="tocnumber">5</span> <span class="toctext">Examples</span></a></li>

      <li class="toclevel-1 tocsection-6"><a href="#Remark"><span class="tocnumber">6</span> <span class="toctext">Remark</span></a></li>

      <li class="toclevel-1 tocsection-7"><a href="#See_Also"><span class="tocnumber">7</span> <span class="toctext">See Also</span></a></li>

      <li class="toclevel-1 tocsection-8"><a href="#header_to_Include"><span class="tocnumber">8</span> <span class="toctext">header to Include</span></a></li>
    </ul>
  </div>

  <h2><a name="Description"></a><span class="mw-headline">Description</span></h2>

  <p>Read data from recordset object into worksheet.</p>

  <h2><a name="Syntax"></a><span class="mw-headline">Syntax</span></h2>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">int</span> ReadRecordset<span style="color: #000000;">(</span> Object <span style="color: #000040;">&amp;</span> object, DWORD dwCntrl <span style="color: #000080;">=</span> LAYWKGETRECORDSET_BY_COLUMN_INDEX_WITH_COLUMN_RENAMING, <span style="color: #0000ff;">int</span> nRowBegin <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>, <span style="color: #0000ff;">int</span> nNumRows <span style="color: #000080;">=</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, <span style="color: #0000ff;">int</span> nColBegin <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>, POSTREADRS postReadRS <span style="color: #000080;">=</span> <span style="color: #0000ff;">NULL</span> <span style="color: #000000;">)</span>
</pre>

  <h2><a name="Parameters"></a><span class="mw-headline">Parameters</span></h2>

  <dl>
    <dt>object</dt>

    <dd>[input] The recordset.</dd>
  </dl>

  <dl>
    <dt>dwCntrl</dt>

    <dd>[input] Options from LAYWKGETRECORDSET_BY_COLUMN_INDEX , etc (OC_const.h). // beginning with the starting column nColBegin retrieve all fields (will add columns as necessary). default is LAYWKGETRECORDSET_BY_COLUMN_INDEX_WITH_COLUMN_RENAMING</dd>
  </dl>

  <dl>
    <dt>nRowBegin</dt>

    <dd>[input] The starting row in the worksheet. default is 0.</dd>
  </dl>

  <dl>
    <dt>nNumRows</dt>

    <dd>[input] Total number of records to retrieve,or &lt; 0 to retrieve all available. default is -1.</dd>
  </dl>

  <dl>
    <dt>nColBegin</dt>

    <dd>[input] Applies only to the options LAYWKGETRECORDSET_BY_COLUMN_INDEX with or without LAYWKGETRECORDSET_BY_COLUMN_INDEX and LAYWKGETRECORDSET_SET_COLUMN_NAME bits the column in worksheet from which to begin. default is 0.</dd>
  </dl>

  <dl>
    <dt>postReadRS</dt>

    <dd>[input,optional] (8.1SR2) if supplied, postReadRS-&gt;nCodePage holds the code page to be used when converting string values from database. If postReadRS-&gt;nCodePage &gt; 0, the code page value postReadRS-&gt;nCodePage is used. If postReadRS-&gt;nCodePage &lt; 0, the current code page used in Origin for various string manipulations (which might be different from OS code page) is used. If postReadRS-&gt;nCodePage == 0 (same as postReadRS == NULL), then the current OS code page is used.</dd>
  </dl>

  <h2><a name="Return"></a><span class="mw-headline">Return</span></h2>

  <p>error message, 0 if no error</p>

  <h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>

  <p><b>EX1</b></p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">#define</span> DB_SETUP_STR            <span style="color: #ff00ff;">"Provider=Microsoft.Jet.OLEDB.4.0;Password="</span><span style="color: #ff00ff;">";User ID=Admin;Data Source="</span>
<span style="color: #0000ff;">#define</span> DB_FILE_FULLPATH        GetAppPath<span style="color: #000000;">(</span><span style="color: #0000ff;">TRUE</span><span style="color: #000000;">)</span> <span style="color: #000040;">+</span> <span style="color: #ff00ff;">"Samples<span style="color: #666666; font-weight: bold;">\I</span>mport and Export<span style="color: #666666; font-weight: bold;">\s</span>tars.mdb"</span>
<span style="color: #0000ff;">#define</span> TABLE_NAME                 <span style="color: #ff00ff;">"Stars"</span>
 
<span style="color: #008000;">//function to retrieve data and put into a worksheet</span>
<span style="color: #0000ff;">int</span> ReadRecordset_ex1<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>    
    <span style="color: #008000;">//create the ADODB.Recorset object</span>
    Object ocrs <span style="color: #000080;">=</span> CreateObject<span style="color: #000000;">(</span><span style="color: #ff00ff;">"ADODB.Recordset"</span><span style="color: #000000;">)</span>;    
    <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #000040;">!</span>ocrs <span style="color: #000000;">)</span>
    <span style="color: #000000;">{</span>
        out_str<span style="color: #000000;">(</span><span style="color: #ff00ff;">" ADO init error!"</span><span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">return</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>;
    <span style="color: #000000;">}</span>
 
    <span style="color: #008000;">// prepare and open database recordset</span>
    string strConn <span style="color: #000080;">=</span> DB_SETUP_STR <span style="color: #000040;">+</span> DB_FILE_FULLPATH <span style="color: #000040;">+</span> <span style="color: #ff00ff;">";"</span>;
    string strQuery <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"select * from "</span><span style="color: #000040;">+</span> TABLE_NAME <span style="color: #000040;">+</span> <span style="color: #ff00ff;">";"</span>;

    <span style="color: #008000;">//make the recordset ReadOnly (adUseClient) for faster open</span>
    ocrs.<span style="color: #000000;">CursorLocation</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;<span style="color: #008000;">//3=adUseClient(enum added in Origin 9)</span>

    ocrs.<span style="color: #000000;">open</span><span style="color: #000000;">(</span>strQuery, strConn, <span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">3</span><span style="color: #000000;">)</span>;    
 
    <span style="color: #008000;">//prepare worksheet</span>
    Worksheet wks;
    wks.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"origin"</span><span style="color: #000000;">)</span>;
 
    <span style="color: #008000;">//read data into the worksheet.</span>
    <span style="color: #0000ff;">int</span> nRet <span style="color: #000080;">=</span> wks.<span style="color: #000000;">ReadRecordset</span><span style="color: #000000;">(</span>ocrs<span style="color: #000000;">)</span>;
    <span style="color: #0000ff;">if</span> <span style="color: #000000;">(</span> nRet <span style="color: #000000;">)</span>
        <span style="color: #0000ff;">return</span> nRet;
    <span style="color: #0000ff;">if</span> <span style="color: #000000;">(</span>ocrs.<span style="color: #000000;">State</span> <span style="color: #000080;">==</span> <span style="color: #0000dd;">1</span> <span style="color: #000000;">)</span> <span style="color: #008000;">//adStateOpen</span>
         ocrs.<span style="color: #000000;">Close</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
    <span style="color: #0000ff;">return</span> <span style="color: #0000dd;">0</span>;
<span style="color: #000000;">}</span>
</pre>

  <h2><a name="Remark"></a><span class="mw-headline">Remark</span></h2>

  <p>The performance depends on how the recordset is opened, as controlled by CursorLocation (adUseClient, or adUseServer, see in query_utils.h). For reading into worksheet, usually set CursorLocation as adUseCient is enough, which will cause CursorType be set as adOpenStatic, which means that any other application's update into source database will not affect this recordset once it is open. It is like the recordset is open as read-only. See <a class="external text" href="http://msdn.microsoft.com/en-us/library/office/aa140098(v=office.10).aspx" target="_blank">CursorType</a>, <a class="external text" href="http://msdn.microsoft.com/en-us/library/ee252442(v=bts.10).aspx" target="_blank">CursorLocation</a> for more details.</p>

  <h2><a name="See_Also"></a><span class="mw-headline">See Also</span></h2>

  <p><a href="../../OriginC/OriginC/Worksheet-WriteRecordset.html" title="OriginC:Worksheet-WriteRecordset">Worksheet::WriteRecordset</a> | <a href="../../OriginC/OriginC/Worksheet-PutRecordset.html" title="OriginC:Worksheet-PutRecordset">Worksheet::PutRecordset</a></p>

  <h2><a name="header_to_Include"></a><span class="mw-headline">header to Include</span></h2>

  <p>origin.h</p>
