<h1 class="firstheading">OriginObject::UpdateThemeIDs</h1>

  <p><span class="OIndex" style="display:none">UpdateThemeIDs</span></p>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>Contents</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>

      <li class="toclevel-1 tocsection-2"><a href="#Syntax"><span class="tocnumber">2</span> <span class="toctext">Syntax</span></a></li>

      <li class="toclevel-1 tocsection-3"><a href="#Parameters"><span class="tocnumber">3</span> <span class="toctext">Parameters</span></a></li>

      <li class="toclevel-1 tocsection-4"><a href="#Return"><span class="tocnumber">4</span> <span class="toctext">Return</span></a></li>

      <li class="toclevel-1 tocsection-5"><a href="#Examples"><span class="tocnumber">5</span> <span class="toctext">Examples</span></a></li>

      <li class="toclevel-1 tocsection-6"><a href="#Remark"><span class="tocnumber">6</span> <span class="toctext">Remark</span></a></li>

      <li class="toclevel-1 tocsection-7"><a href="#See_Also"><span class="tocnumber">7</span> <span class="toctext">See Also</span></a></li>

      <li class="toclevel-1 tocsection-8"><a href="#header_to_Include"><span class="tocnumber">8</span> <span class="toctext">header to Include</span></a></li>
    </ul>
  </div>

  <h2><a name="Description"></a><span class="mw-headline">Description</span></h2>

  <p>This method allows a tree with no theme ID to be used in ApplyFormat.</p>

  <h2><a name="Syntax"></a><span class="mw-headline">Syntax</span></h2>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">int</span> UpdateThemeIDs<span style="color: #000000;">(</span> TreeNode <span style="color: #000040;">&amp;</span> trNode, LPCTSTR lpcszName <span style="color: #000080;">=</span> <span style="color: #0000ff;">NULL</span>, LPCTSTR lpcszValue <span style="color: #000080;">=</span> <span style="color: #0000ff;">NULL</span> <span style="color: #000000;">)</span>
</pre>

  <h2><a name="Parameters"></a><span class="mw-headline">Parameters</span></h2>

  <dl>
    <dt>trNode</dt>

    <dd>[input] Tree contains format information</dd>

    <dt>lpcszName</dt>

    <dd>[input] if specified and node has no ID then new attribute of that name will be added. This is used in conjuction with lpcszValue to report translation errors</dd>

    <dt>lpcszValue</dt>

    <dd>[input] if specified and node has no ID then new attribute of that value will be added. This is used only if lpcszName is specified to add error attributes to the tree nodes so that when function returns none-zero values, caller of this function can scan the tree to find the offending nodes.</dd>
  </dl>

  <h2><a name="Return"></a><span class="mw-headline">Return</span></h2>

  <p>0 for no error.</p>

  <h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>

  <p><b>EX1</b></p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">void</span> OriginObject_UpdateThemeIDs_Ex1<span style="color: #000000;">(</span>string strName <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"Rect"</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
    GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
    GraphObject gg <span style="color: #000080;">=</span>  gl.<span style="color: #000000;">GraphObjects</span><span style="color: #000000;">(</span>strName<span style="color: #000000;">)</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span>gg<span style="color: #000000;">)</span>
    <span style="color: #000000;">{</span>
        Tree tr;                
        tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Fill</span>.<span style="color: #000000;">Color</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">4</span>; <span style="color: #008000;">// this value corresponds to transparent, or NONE in dialog</span>
        tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Fill</span>.<span style="color: #000000;">Pattern</span>.<span style="color: #000000;">Style</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">6</span>;
        tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Fill</span>.<span style="color: #000000;">Pattern</span>.<span style="color: #000000;">UseBorderColor</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;<span style="color: #008000;">// independent color for fill pattern lines</span>
        tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Fill</span>.<span style="color: #000000;">Pattern</span>.<span style="color: #000000;">PatternColor</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">6</span>; <span style="color: #008000;">// yellow</span>
        tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Fill</span>.<span style="color: #000000;">Pattern</span>.<span style="color: #000000;">Width</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0.1</span>; <span style="color: #008000;">// fill pattern line width</span>
        tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Fill</span> <span style="color: #000080;">=</span> tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Border</span>;
          
          <span style="color: #0000ff;">int</span> nErr <span style="color: #000080;">=</span> gg.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">(</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">)</span>;
          <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> nErr<span style="color: #000000;">)</span>
              gg.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">(</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>;
    <span style="color: #000000;">}</span>
<span style="color: #000000;">}</span>
</pre>

  <h2><a name="Remark"></a><span class="mw-headline">Remark</span></h2>

  <p>The ApplyFormat method takes a tree with proper theme ID to make internal assignments to set various properties in an object. For an Origin C programmer, it is more friendly to deal with tag names then with theme IDs. With this method, one can construct a tree with simple a.b.c notation and call this function to prepare the tree by adding theme IDs acording to internal theme rules.</p>

  <h2><a name="See_Also"></a><span class="mw-headline">See Also</span></h2>

  <p><a href="../../OriginC/OriginC/OriginObject-ApplyFormat.html" title="OriginC:OriginObject-ApplyFormat">OriginObject::ApplyFormat</a></p>

  <h2><a name="header_to_Include"></a><span class="mw-headline">header to Include</span></h2>

  <p>origin.h</p>
