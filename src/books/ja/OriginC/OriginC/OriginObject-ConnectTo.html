<h1 class="firstheading">OriginObject::ConnectTo</h1>

  <p><span class="OIndex" style="display:none">ConnectTo</span></p>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>Contents</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>

      <li class="toclevel-1 tocsection-2"><a href="#Syntax"><span class="tocnumber">2</span> <span class="toctext">Syntax</span></a></li>

      <li class="toclevel-1 tocsection-3"><a href="#Parameters"><span class="tocnumber">3</span> <span class="toctext">Parameters</span></a></li>

      <li class="toclevel-1 tocsection-4"><a href="#Return"><span class="tocnumber">4</span> <span class="toctext">Return</span></a></li>

      <li class="toclevel-1 tocsection-5"><a href="#Examples"><span class="tocnumber">5</span> <span class="toctext">Examples</span></a></li>

      <li class="toclevel-1 tocsection-6"><a href="#Remark"><span class="tocnumber">6</span> <span class="toctext">Remark</span></a></li>

      <li class="toclevel-1 tocsection-7"><a href="#See_Also"><span class="tocnumber">7</span> <span class="toctext">See Also</span></a></li>

      <li class="toclevel-1 tocsection-8"><a href="#header_to_Include"><span class="tocnumber">8</span> <span class="toctext">header to Include</span></a></li>
    </ul>
  </div>

  <h2><a name="Description"></a><span class="mw-headline">Description</span></h2>

  <p>Connect one object to another object</p>

  <h2><a name="Syntax"></a><span class="mw-headline">Syntax</span></h2>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">BOOL</span> ConnectTo<span style="color: #000000;">(</span> OriginObject <span style="color: #000040;">&amp;</span> objTarget, <span style="color: #0000ff;">int</span> nTargetReferencePoint <span style="color: #000080;">=</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, <span style="color: #0000ff;">int</span> nReferencePoint <span style="color: #000080;">=</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, <span style="color: #0000ff;">BOOL</span> bVisibleConnector <span style="color: #000080;">=</span> <span style="color: #0000ff;">TRUE</span>, DWORD dwRigid <span style="color: #000080;">=</span> OCR_SITE1 <span style="color: #000040;">|</span> OCR_SITE2, RECT <span style="color: #000040;">*</span> lpConfineRect <span style="color: #000080;">=</span> <span style="color: #0000ff;">NULL</span> <span style="color: #000000;">)</span>
</pre>

  <h2><a name="Parameters"></a><span class="mw-headline">Parameters</span></h2>

  <dl>
    <dt>objTarget</dt>

    <dd>[input] the object want to connect to</dd>

    <dt>nTargetReferencePoint</dt>

    <dd>[input] reference point on target object. Value is from CONNECTORTETHERINGPOINT enum.</dd>

    <dt>nReferencePoint</dt>

    <dd>[input] reference point on object being connected. Value is from CONNECTORTETHERINGPOINT enum.</dd>

    <dt>bVisibleConnector</dt>

    <dd>[input] if TRUE connector is visible.</dd>

    <dt>dwRigid</dt>

    <dd>[input] connector rigidity. Combination of OCR_SITE1 and OCR_SITE2 bits. If OCR_SITE1 is set, objTarget will follow this object when this object is moved. If OCR_SITE2 is set, this object will follow objTarget, when objTarget is moved.</dd>

    <dt>lpConfineRect</dt>

    <dd>[input] confinement rectangle to restrict movement of connected object if corresponding connection is not rigid. If lpConfineRect is NULL, no confinement is applied. If not NULL then following logic is followed: assume object1 is connected to object2 and connection on the object1 site is not rigid. Object1 will be restricted in movement up, down, left or right such that distance to the object2 is less than (lpConfineRect-&gt;top * object2.Height / 1000.0), (lpConfineRect-&gt;bottom * object2.Height / 1000.0), (lpConfineRect-&gt;left * object2.Width / 1000.0) and (lpConfineRect-&gt;right * object2.Width / 1000.0) respectively.</dd>
  </dl>

  <h2><a name="Return"></a><span class="mw-headline">Return</span></h2>

  <p>TRUE if successful, FALSE otherwise</p>

  <h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>

  <p><b>EX1</b></p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #008000;">// this example will show how to connect graph object to another graph object. </span>
<span style="color: #008000;">// If move Line object Text and Rect will be moved together</span>
<span style="color: #0000ff;">void</span> OriginObject_ConnectTo_Ex1<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
    GraphPage gp;
    gp.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
    GraphLayer gl <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
    
    GraphObject goLine <span style="color: #000080;">=</span> gl.<span style="color: #000000;">CreateGraphObject</span><span style="color: #000000;">(</span>GROT_LINE<span style="color: #000000;">)</span>;
    GraphObject goText <span style="color: #000080;">=</span> gl.<span style="color: #000000;">CreateGraphObject</span><span style="color: #000000;">(</span>GROT_TEXT<span style="color: #000000;">)</span>;
    GraphObject goRect <span style="color: #000080;">=</span> gl.<span style="color: #000000;">CreateGraphObject</span><span style="color: #000000;">(</span>GROT_RECT<span style="color: #000000;">)</span>;
    goText.<span style="color: #000000;">Text</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"Hello"</span>;
    goText.<span style="color: #000000;">ConnectTo</span><span style="color: #000000;">(</span>goLine<span style="color: #000000;">)</span>;
    goRect.<span style="color: #000000;">ConnectTo</span><span style="color: #000000;">(</span>goLine<span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span>
</pre>

  <p><b>EX2</b></p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #008000;">//Run this code after OriginObject_ConnectTo_Ex1 to see the result.</span>
<span style="color: #0000ff;">void</span> OriginObject_ConnectTo_Ex2<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
        GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">if</span> <span style="color: #000000;">(</span> gl <span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
                GraphObject goRect <span style="color: #000080;">=</span> gl.<span style="color: #000000;">GraphObjects</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Rect"</span><span style="color: #000000;">)</span>;
                <span style="color: #0000ff;">if</span> <span style="color: #000000;">(</span> goRect <span style="color: #000000;">)</span>
                        goRect.<span style="color: #000000;">ConnectTo</span><span style="color: #000000;">(</span><span style="color: #0000ff;">NULL</span><span style="color: #000000;">)</span>;<span style="color: #008000;">//disconnect from other graph object.</span>
        <span style="color: #000000;">}</span>
        <span style="color: #0000ff;">return</span>;
<span style="color: #000000;">}</span>
</pre>

  <h2><a name="Remark"></a><span class="mw-headline">Remark</span></h2>

  <h2><a name="See_Also"></a><span class="mw-headline">See Also</span></h2>

  <p><a href="../../OriginC/OriginC/OriginObject-GetConnectedObjects.html" title="OriginC:OriginObject-GetConnectedObjects">OriginObject::GetConnectedObjects</a></p>

  <h2><a name="header_to_Include"></a><span class="mw-headline">header to Include</span></h2>

  <p>origin.h</p>
