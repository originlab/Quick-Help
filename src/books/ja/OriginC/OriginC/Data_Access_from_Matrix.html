<h1 class="firstheading">Data Access from Matrix</h1>

  <p>&#160;</p>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>Contents</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1"><a href="#Version_Info"><span class="tocnumber">1</span> <span class="toctext">Version Info</span></a></li>

      <li class="toclevel-1 tocsection-2"><a href="#Remark"><span class="tocnumber">2</span> <span class="toctext">Remark</span></a></li>

      <li class="toclevel-1 tocsection-3">
        <a href="#Numeric"><span class="tocnumber">3</span> <span class="toctext">Numeric</span></a>

        <ul>
          <li class="toclevel-2 tocsection-4"><a href="#double"><span class="tocnumber">3.1</span> <span class="toctext">double</span></a></li>

          <li class="toclevel-2 tocsection-5"><a href="#complex"><span class="tocnumber">3.2</span> <span class="toctext">complex</span></a></li>
        </ul>
      </li>
    </ul>
  </div>

  <p>&#160;</p>

  <h2><a name="Version_Info"></a><span class="mw-headline">Version Info</span></h2>

  <p class="version">Minimum Origin Version Required: Origin8 SR0</p>

  <h2><a name="Remark"></a><span class="mw-headline">Remark</span></h2>

  <p>This section introduced access data from Origin matrix window.</p>

  <p>More related details please reference to the following Origin C Reference sections:</p>

  <p><a href="../../OriginC/Category/MatrixPage_(class).html" title="Category:MatrixPage (class)">MatrixPage class</a></p>

  <p><a href="../../OriginC/Category/MatrixLayer_(class).html" title="Category:MatrixLayer (class)">MatrixLayer class</a></p>

  <p><a href="../../OriginC/Category/MatrixObject_(class).html" title="Category:MatrixObject (class)">MatrixObject class</a></p>

  <p><a href="../../OriginC/Category/Matrixbase_(class).html" title="Category:Matrixbase (class)">matrixbase class</a></p>

  <p><a href="../../OriginC/Category/Matrix_(lowcase)_(class).html" title="Category:Matrix (lowcase) (class)">matrix class</a></p>

  <p><a href="../../OriginC/Category/Matrix_(class).html" title="Category:Matrix (class)">Matrix class</a></p>

  <h2><a name="Numeric"></a><span class="mw-headline">Numeric</span></h2>

  <h3><a name="double"></a><span class="mw-headline">double</span></h3>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">void</span> AccessMatrixDoubleType<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
        MatrixPage matPage;
        matPage.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Origin"</span><span style="color: #000000;">)</span>; 
        MatrixLayer ml <span style="color: #000080;">=</span> matPage.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// get the first matrix sheet        </span>
        
        <span style="color: #0000ff;">int</span> nObjectIndex <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
        MatrixObject mo <span style="color: #000080;">=</span> ml.<span style="color: #000000;">MatrixObjects</span><span style="color: #000000;">(</span>nObjectIndex<span style="color: #000000;">)</span>; <span style="color: #008000;">// get the first matrix object</span>
        
        mo.<span style="color: #000000;">SetSize</span><span style="color: #000000;">(</span><span style="color: #0000dd;">5</span>, <span style="color: #0000dd;">5</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// set size to 5 rows with 5 columns   </span>
        <span style="color: #0000ff;">double</span> xmin <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>, xmax <span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span>, ymin <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>, ymax <span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span>;   
        mo.<span style="color: #000000;">SetXY</span><span style="color: #000000;">(</span>xmin, xmax, ymin, ymax<span style="color: #000000;">)</span>; <span style="color: #008000;">// set x/y from and to</span>
        
        <span style="color: #008000;">// set z values</span>
        Matrix mat<span style="color: #000000;">(</span>ml, nObjectIndex<span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">for</span><span style="color: #000000;">(</span><span style="color: #0000ff;">int</span> ii<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>; ii<span style="color: #000080;">&lt;</span>mat.<span style="color: #000000;">GetNumRows</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; ii<span style="color: #000040;">++</span><span style="color: #000000;">)</span>
                <span style="color: #0000ff;">for</span><span style="color: #000000;">(</span><span style="color: #0000ff;">int</span> jj<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>; jj<span style="color: #000080;">&lt;</span>mat.<span style="color: #000000;">GetNumCols</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; jj<span style="color: #000040;">++</span><span style="color: #000000;">)</span>
                <span style="color: #000000;">{</span>
                        mat<span style="color: #000000;">[</span>ii<span style="color: #000000;">]</span><span style="color: #000000;">[</span>jj<span style="color: #000000;">]</span> <span style="color: #000080;">=</span> ii <span style="color: #000040;">+</span> jj;
                <span style="color: #000000;">}</span>
<span style="color: #000000;">}</span>
</pre>

  <h3><a name="complex"></a><span class="mw-headline">complex</span></h3>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">void</span> AccessMatrixComplexType<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
        MatrixPage matPage;
        matPage.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Origin"</span><span style="color: #000000;">)</span>; 
        MatrixLayer ml <span style="color: #000080;">=</span> matPage.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// get the first matrix sheet</span>
        
        <span style="color: #0000ff;">int</span> nObjectIndex <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
        MatrixObject mo <span style="color: #000080;">=</span> ml.<span style="color: #000000;">MatrixObjects</span><span style="color: #000000;">(</span>nObjectIndex<span style="color: #000000;">)</span>; <span style="color: #008000;">// get the first matrix object</span>
        
        mo.<span style="color: #000000;">SetSize</span><span style="color: #000000;">(</span><span style="color: #0000dd;">5</span>, <span style="color: #0000dd;">5</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// set size to 5 rows with 5 columns   </span>
        mo.<span style="color: #000000;">SetInternalData</span><span style="color: #000000;">(</span>FSI_COMPLEX<span style="color: #000000;">)</span>; <span style="color: #008000;">// set internal data type to complex, default is double</span>
        
        <span style="color: #008000;">// set z values</span>
        Matrix<span style="color: #000080;">&lt;</span>complex<span style="color: #000080;">&gt;</span> mat<span style="color: #000000;">(</span>ml, nObjectIndex<span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">for</span><span style="color: #000000;">(</span><span style="color: #0000ff;">int</span> ii<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>; ii<span style="color: #000080;">&lt;</span>mat.<span style="color: #000000;">GetNumRows</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; ii<span style="color: #000040;">++</span><span style="color: #000000;">)</span>
                <span style="color: #0000ff;">for</span><span style="color: #000000;">(</span><span style="color: #0000ff;">int</span> jj<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>; jj<span style="color: #000080;">&lt;</span>mat.<span style="color: #000000;">GetNumCols</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; jj<span style="color: #000040;">++</span><span style="color: #000000;">)</span>
                <span style="color: #000000;">{</span>
                        complex cc<span style="color: #000000;">(</span>ii, jj<span style="color: #000000;">)</span>; <span style="color: #008000;">// construct a complex data with ii as real and jj as imaginary</span>
                        mat<span style="color: #000000;">[</span>ii<span style="color: #000000;">]</span><span style="color: #000000;">[</span>jj<span style="color: #000000;">]</span> <span style="color: #000080;">=</span> cc;
                <span style="color: #000000;">}</span>     
<span style="color: #000000;">}</span>
</pre>
