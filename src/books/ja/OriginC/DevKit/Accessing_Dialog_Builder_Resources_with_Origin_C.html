<h1 class="firstheading">Accessing Dialog Builder Resources with Origin C</h1><p class='urlname' style='display: none'>DevKit-Accessing-Dialog-Builder-Resources-with-Origin-C</p>
<div id="POPUP272806918" class="x-popup-text" style="display: none; position: absolute">
<ol><li><ol><li> For the control on the dialog that you want to access declare an Origin C object of the appropriate type (one that matches the control type of the resource you want to access). For example, to access a list box control you would declare an Origin C <span><b>ListBox</b></span> object.</li></ol></li></ol>
<p>ListBox m_lbxAvailableData; // Declare ListBox object
</p>
<ol><li><ol><li> Attach the declared Origin C object to the resource or control you want to access using the <span><b>GetItem</b></span> method of the Origin C <span><b>Dialog</b></span> class. For example, the statement below attaches an Origin C <span><b>ListBox</b></span> object to a list box control identified by the resource ID string IDC_LDS_LIST1.</li></ol></li></ol>
<p>m_lbxAvailableData = GetItem(IDC_LDS_LIST1); // Attach ListBox object to list box
</p>
<ol><li><ol><li> Access the list box control in the Dialog Builder resource by manipulating the methods and properties of the Origin C <span><b>ListBox</b></span> object attached to the list box control. For example the code below populates the list box with the names of all data sets in the currently open Origin project file.</li></ol></li></ol>
<p>// Loop through all data set names in project
</p><p>string strDataName;
</p><p>foreach(strDataName in Project.DatasetNames)
</p><p>{
</p><p>m_lbxAvailableData.AddString(strDataName); // Add name to list box
</p><p>}
</p><p><span><b>Note:</b></span> The call to the <span><b>GetItem</b></span> method of the <span><b>Dialog</b></span> class above (step 2) does not require a prepended object identifier (e.g. <span><b>dlgListDataSets.</b></span>) because the call is contained within the scope of the <span><b>dlgListDataSets </b></span>class object. See the section <a href="../../OriginC/DevKit/Accessing_a_List_Box_Control_with_Origin_C.html" title="DevKit:Accessing a List Box Control with Origin C">Accessing a List Box Control with Origin C</a> for a link to all source code used in the example above.
</p>
</div>
<p>To access a resource (or control) on a Dialog Builder dialog first <a href="../../OriginC/DevKit/Launching_Dialog_Builder_Resources_with_Origin_C.html" title="DevKit:Launching Dialog Builder Resources with Origin C">launch</a> the dialog containing the control. Then, declare an Origin C object of the appropriate type and attach it to the desired resource (control). Once an Origin C object is successfully attached to the resource, the resource can be accessed (initialized, controlled, evaluated, enabled, and shown or hidden) by manipulating the methods and properties of the attached Origin C object.
</p><p>To access a control on a dialog use the following syntax:
</p><p><b>ControlName</b> MyControl;
</p>
<pre>
MyControl = GetItem(ControlID);
</pre>
<p>where <i>ControlName</i> is an Origin C class name and <i>ControlID</i> is the resource ID string of the control defined in your Symbol header file. The <span><b>Dialog</b></span> class member function <span><b>GetItem</b></span> returns the control for the given resource ID.
</p><p><span><b>Note:</b></span> To access a resource outside a <span><b>Dialog</b></span> class member function you must also include the name of the dialog. For example, you would use <span><b>MyControl = </b><i>DialogName</i><b>.GetItem(</b><i>ControlID</i><b>); </b></span>where <i><b>DialogName</b></i> is the Origin C name of the dialog containing the control.
</p><p>The following example demonstrates how to declare an Origin C object of the appropriate type and attach it to a resource.
</p>
<ul><li> 1 For the control on the dialog that you want to access declare an Origin C object of the appropriate type (one that matches the control type of the resource you want to access).  For example, to access a list box control you would declare an Origin C <b>ListBox</b> object.</li></ul>
<pre>
ListBox m_lbxAvailableData; // Declare ListBox object
</pre>
<ul><li> 2 Attach the declared Origin C object to the resource or control you want to access using the <b>GetItem</b> method of the Origin C <b>Dialog</b> class.  For example, the statement below attaches an Origin C <b>ListBox</b> object to a list box control identified by the resource ID string IDC_LDS_LIST1. </li></ul>
<pre>
m_lbxAvailableData = GetItem(IDC_LDS_LIST1); // Attach ListBox object to list box
</pre>
<ul><li> 3 Access the list box control in the Dialog Builder resource by manipulating the methods and properties of the Origin C <b>ListBox</b> object attached to the list box control.  For example the code below populates the list box with the names of all data sets in the currently open Origin project file. </li></ul>
<pre>
// Loop through all data set names in project
string strDataName;
foreach(strDataName in Project.DatasetNames)
{
      m_lbxAvailableData.AddString(strDataName); // Add name to list box
}  
</pre>
<p><b>Note</b>: The call to the GetItem method of the Dialog class above (step 2) does not require a prepended object identifier (e.g. dlgListDataSets.) because the call is contained within the scope of the dlgListDataSets class object.  See the section <a href="../../OriginC/DevKit/Accessing_a_List_Box_Control_with_Origin_C.html" title="DevKit:Accessing a List Box Control with Origin C">Accessing a List Box</a> Control with Origin C for a link to all source code used in the example above.
</p>






    