<h1 class="firstheading">Build Resource-only DLL in Visual Studio 2015</h1><p><br />
The Origin Dialog Project Template (odialog.awx) is only compatible with Visual Studio 6.  This article will walk you through the steps necessary to make a resource-only DLL using Visual Studio 2008, 2010, 2012 and 2015 Community.  It will then show you how to use your DLL in Origin C.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Creating_a_Resource-Only_DLL"><span class="tocnumber">1</span> <span class="toctext">Creating a Resource-Only DLL</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Creating_a_64-Bit_Resource-Only_DLL"><span class="tocnumber">2</span> <span class="toctext">Creating a 64-Bit Resource-Only DLL</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Using_a_Resource-Only_DLL_in_Origin_C"><span class="tocnumber">3</span> <span class="toctext">Using a Resource-Only DLL in Origin C</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Copy_the_DLL_and_Resource_header_into_Origin_C"><span class="tocnumber">3.1</span> <span class="toctext">Copy the DLL and Resource header into Origin C</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Writing_Origin_C_code_to_Display_the_Dialog"><span class="tocnumber">3.2</span> <span class="toctext">Writing Origin C code to Display the Dialog</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="Creating_a_Resource-Only_DLL"></a><span class="mw-headline">Creating a Resource-Only DLL</span></h2>
<p>Here is an example of how to build a resource-only DLL that is accessible in Origin C.  After following these steps you will have a Visual Studio solution for building a 32-bit DLL.  The next section will then show you how to add 64-bit support to your solution.
</p>
<ol><li> Launch Visual Studio.(This example has been tested in Visual Studio Community 2015.)</li>
<li> Select "File &gt; New &gt; Project..." to create a new project.</li>
<li> In the "New Project" dialog:
<ol><li> Select "Visual C++" templates.</li>
<li> Select "Win32 Project".</li>
<li> Enter a name for your project.  For this example we will name our project "Welcome".</li>
<li> Click the OK button.<br /><a  class="image"><img alt="Vs2015-new project dlg.png" src="../images/Build_Resource-only_DLL_in_Visual_Studio_2008/500px-Vs2015-new_project_dlg.png" width="500"   /></a></li></ol></li>
<li> In the "Win32 Application Wizard" dialog:
<ol><li> Click "Next" until you see "Application Settings".</li>
<li> Set "Application type" to "DLL".</li>
<li> Under "Additional options", check "Empty project".</li>
<li> Click the Finish button.<br /><a  class="image"><img alt="Vs2015-win32 wuz dlg settings.png" src="../images/Build_Resource-only_DLL_in_Visual_Studio_2008/500px-Vs2015-win32_wuz_dlg_settings.png" width="500"   /></a></li></ol></li>
<li> In "Solution Explorer", right-click on the project group and choose Properties.</li>
<li> In the "Properties Pages" dialog:
<ol><li> Set Configuration to "All Configurations".</li>
<li> Expand "Configuration Properties".</li>
<li> Select "General".</li>
<li> Set "Character Set" to "Use Multi-Byte Character Set".</li>
<li> Expand "Linker".</li>
<li> Select "Advanced".</li>
<li> Set "No Entry Point" to "Yes".</li>
<li> Click the OK button.</li></ol></li>
<li> In "Solution Explorer", right-click on the project group and choose "Add &gt; Resource...".</li>
<li> In the "Add Resource" dialog:
<ol><li> Select Dialog.</li>
<li> Click the New button.<br /><a  class="image"><img alt="Vs2015-win32 add dlg.png" src="../images/Build_Resource-only_DLL_in_Visual_Studio_2008/300px-Vs2015-win32_add_dlg.png" width="300"   /></a></li></ol></li>
<li> In the dialog editor, add an "Edit Control" to the dialog by drag&amp;drop the control from the Toolbox bar.<br /><a  class="image"><img alt="Vs2015-win32 edit ctrl.png" src="../images/Build_Resource-only_DLL_in_Visual_Studio_2008/300px-Vs2015-win32_edit_ctrl.png" width="300"   /></a></li>
<li> Select "File &gt; Save All".</li>
<li> Select "Build &gt; Rebuild Solution".</li></ol>
<p>When you build 32-bit DLLs, Visual Studio creates the DLLs in the Debug and Release sub folders of your Visual Studio's project folder.
</p>
<h2><a name="Creating_a_64-Bit_Resource-Only_DLL"></a><span class="mw-headline">Creating a 64-Bit Resource-Only DLL</span></h2>
<p>The above steps will create a 32-bit resource-only DLL.  The following steps will show you how to create a 64-bit resource-only DLL by adding an x64 (64-bit) configuration to your Visual Studio project.
</p>
<ol><li> Select "View &gt; Property Pages".</li>
<li> Click the "Configuration Manager" button in the top right corner to open the "Configuration Manager" dialog.</li>
<li> In the "Active solution platform" drop-down, select New to open the "New Solution Platform" dialog.</li>
<li> Set Type to x64</li>
<li> Click the OK button.</li>
<li> Back in the "Configuration Manager" dialog, click the Close button.</li>
<li> Set Platform to x64.</li>
<li> Change "Target Name" from "$(ProjectName)" to "$(ProjectName)_64".</li>
<li> Click the OK button.</li></ol>
<p>Now you can switch between making a 32-bit (Win32) and a 64-bit (x64) DLL using the "Solutions Platform" setting in the toolbar.
</p><p>When you build 32-bit DLLs, Visual Studio creates the DLLs in the Debug and Release sub folders of your Visual Studio's project folder.  For 64-bit DLLs, they will be created in the x64\Debug and x64\Release sub folders of your Visual Studio's project folder.
</p>
<h2><a name="Using_a_Resource-Only_DLL_in_Origin_C"></a><span class="mw-headline">Using a Resource-Only DLL in Origin C</span></h2>
<p>Now that you have created a resource-only DLL using the steps above, we will show you how to use the DLL in Origin C.
</p>
<h3><a name="Copy_the_DLL_and_Resource_header_into_Origin_C"></a><span class="mw-headline">Copy the DLL and Resource header into Origin C</span></h3>
<p>The first step is to copy the DLL and the resource header file to the <b>Origin C</b> sub folder in your <b>User Files</b> folder.
</p><p>As noted above, Visual Studio creates the 32-bit DLLs in the Debug and Release sub folders of your Visual Studio's project folder and the 64-bit DLLs are created in the x64\Debug and x64\Release sub folders.
</p><p>The default name of the resource header file is <b>resource.h</b> and it is located in a sub folder with the same name as your Visual Studio's project folder.  For example, the Welcome project we created above is in a folder named <b>Welcome</b>.  That folder contains a sub folder also named <b>Welcome</b>.
</p><p>The resource header file in this case is: .\Welcome\Welcome\resource.h
</p><p>Later versions of Visual Studio will create this header file with unicode encoding.  Origin C can not read this encoding so you can not simply copy the file to your Origin C folder.  Instead, you need to convert the file from unicode to ANSI.
</p>
<ol><li> Open the header file in Windows Notepad.</li>
<li> Do "File &gt; Save As..."</li>
<li> Navigate to the Origin C sub folder in your User Files folder.</li>
<li> Set Encoding to ANSI.</li>
<li> Click the Save button.</li></ol>
<h3><a name="Writing_Origin_C_code_to_Display_the_Dialog"></a><span class="mw-headline">Writing Origin C code to Display the Dialog</span></h3>
<p>At this point you should have created your DLL and copied it and it's resource header file to the Origin C sub folder in your User Files folder.  Now we will write the Origin C code that will display the dialog and handle events.
</p>
<ol><li> Start Origin and open Code Builder.</li>
<li> In Code Builder select "File &gt; New" to create a new C file.</li>
<li> Copy the Origin C code below and paste it at the end of your new C file.</li>
<li> Select "Build &gt; Build".</li>
<li> In Code Builder's "Command &amp; Results" window type "DoMyDialog" and press Enter.</li>
<li> When the Welcome dialog appears enter a message into the edit control and click OK.</li></ol>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>Dialog.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span>
<span style="color: #0000ff;">#include</span> <span style="color: #ff00ff;">&quot;resource.h&quot;</span>


<span style="color: #0000ff;">class</span> MyDialog <span style="color: #000000;">:</span> <span style="color: #0000ff;">public</span> Dialog
<span style="color: #000000;">&#123;</span>
<span style="color: #0000ff;">public</span><span style="color: #000000;">:</span>
	MyDialog<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">:</span> Dialog<span style="color: #000000;">&#40;</span>IDD_DIALOG1, <span style="color: #ff00ff;">&quot;Welcome&quot;</span><span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
	<span style="color: #000000;">&#125;</span>

	<span style="color: #0000ff;">int</span> DoModal<span style="color: #000000;">&#40;</span>HWND hParent <span style="color: #000080;">=</span> <span style="color: #0000ff;">NULL</span><span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		InitMsgMap<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
		<span style="color: #0000ff;">int</span> nRet <span style="color: #000080;">=</span> Dialog<span style="color: #000000;">::</span><span style="color: #000000;">DoModal</span><span style="color: #000000;">&#40;</span>hParent<span style="color: #000000;">&#41;</span>;
		<span style="color: #0000ff;">return</span> nRet;
	<span style="color: #000000;">&#125;</span>

<span style="color: #0000ff;">protected</span><span style="color: #000000;">:</span>
	EVENTS_BEGIN
		ON_INIT<span style="color: #000000;">&#40;</span>OnInitDialog<span style="color: #000000;">&#41;</span>
		ON_OK<span style="color: #000000;">&#40;</span>OnOK<span style="color: #000000;">&#41;</span>
		ON_CANCEL<span style="color: #000000;">&#40;</span>OnCancel<span style="color: #000000;">&#41;</span>
	EVENTS_END

	<span style="color: #0000ff;">BOOL</span> OnInitDialog<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		this<span style="color: #000040;">-</span><span style="color: #000080;">&gt;</span>Text <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Welcome&quot;</span>;
		m_editCtrl <span style="color: #000080;">=</span> GetItem<span style="color: #000000;">&#40;</span>IDC_EDIT1<span style="color: #000000;">&#41;</span>;
		m_editCtrl.<span style="color: #000000;">Text</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Enter a message here.&quot;</span>;
		<span style="color: #0000ff;">return</span> <span style="color: #0000ff;">TRUE</span>;
	<span style="color: #000000;">&#125;</span>

	<span style="color: #0000ff;">BOOL</span> OnOK<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		MessageBox<span style="color: #000000;">&#40;</span>GetSafeHwnd<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>, m_editCtrl.<span style="color: #000000;">Text</span>, this<span style="color: #000040;">-</span><span style="color: #000080;">&gt;</span>Text<span style="color: #000000;">&#41;</span>;
		<span style="color: #0000ff;">return</span> <span style="color: #0000ff;">TRUE</span>;
	<span style="color: #000000;">&#125;</span>

	<span style="color: #0000ff;">BOOL</span> OnCancel<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		<span style="color: #0000ff;">return</span> <span style="color: #0000ff;">TRUE</span>;
	<span style="color: #000000;">&#125;</span>

	Edit m_editCtrl;
<span style="color: #000000;">&#125;</span>;


<span style="color: #0000ff;">bool</span> DoMyDialog<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> 
<span style="color: #000000;">&#123;</span>
	MyDialog myDlg;
	myDlg.<span style="color: #000000;">DoModal</span><span style="color: #000000;">&#40;</span> GetWindow<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>;
	<span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span>;
<span style="color: #000000;">&#125;</span></pre>







    