<h1 class="firstheading">統計</h1><p>ワークシート内で選択したデータ(列や行、ワークシート全体)の統計処理を行いたい場合があります。  <b><a href="../../OriginC/OCGuide/Numeric_Data.html#DataRange" title="CGuide:数値データ">データで操作する：数値データ：データ範囲</a></b>の章には、列/行のインデックスでデータ範囲を構築する方法があり、元のデータをベクターデータにします。 
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Descriptive_Statistics_on_Columns_and_Rows"><span class="tocnumber">1</span> <span class="toctext">列と行の<span class="OIndex">記述統計</span></span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Frequency_Count"><span class="tocnumber">2</span> <span class="toctext"><span class="OIndex">度数カウント</span></span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Correlation_Coefficient"><span class="tocnumber">3</span> <span class="toctext"><span class="OIndex">相関係数</span></span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Normality_Test"><span class="tocnumber">4</span> <span class="toctext"><span class="OIndex">正規性の検定</span></span></a></li>
</ul>
</div>

<h2><a name="Descriptive_Statistics_on_Columns_and_Rows"></a><span class="mw-headline">列と行の<span class="OIndex">記述統計量</span></span></h2>
<p><b><a href="../../OriginC/OriginC/Ocmath_basic_summary_stats_(global_function).html" title="OriginC:Ocmath basic summary stats (global function)">ocmath_basic_summary_stats</a></b>関数は、元データの合計数、平均値、標準偏差、歪度などの基本統計量を計算します。  詳細は、Origin Cヘルプを参照してください。次のOrigin Cコードは、vDataというベクターオブジェクトのデータのポイント数、平均、平均の標準誤差を計算し、出力します。 


</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">int</span> N;
<span style="color: #0000ff;">double</span> Mean, SE;
ocmath_basic_summary_stats<span style="color: #000000;">(</span>vData.<span style="color: #000000;">GetSize</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>, vData, <span style="color: #000040;">&amp;</span>N, <span style="color: #000040;">&amp;</span>Mean, <span style="color: #0000ff;">NULL</span>, <span style="color: #000040;">&amp;</span>SE<span style="color: #000000;">)</span>;
<span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;N=%d<span style="color: #666666; font-weight: bold;">\n</span>Mean=%g<span style="color: #666666; font-weight: bold;">\n</span>SE=%g<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, N, Mean, SE<span style="color: #000000;">)</span>;</pre>
<h2><a name="Frequency_Count"></a><span class="mw-headline"><span class="OIndex">度数カウント</span></span></h2>
<p><b><a href="../../OriginC/OriginC/Ocmath_frequency_count_(global_function).html" title="OriginC:Ocmath frequency count (global function)">ocmath_frequency_count</a></b>関数は、FreqCountOptions 構造体に従って度数カウントを計算するのに使用します。 
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// 度数カウントを行うソースデータ</span>
vector vData <span style="color: #000080;">=</span> <span style="color: #000000;">{</span><span style="color: #0000dd;">0.11</span>, <span style="color: #0000dd;">0.39</span>, <span style="color: #0000dd;">0.43</span>, <span style="color: #0000dd;">0.54</span>, <span style="color: #0000dd;">0.68</span>, <span style="color: #0000dd;">0.71</span>, <span style="color: #0000dd;">0.86</span><span style="color: #000000;">}</span>;

<span style="color: #008000;">// ビンサイズ、設定の開始と終了などのオプションをセット</span>
<span style="color: #0000ff;">int</span> nBinSize <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>;	
FreqCountOptions fcoOptions;    
fcoOptions.<span style="color: #000000;">FromMin</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
fcoOptions.<span style="color: #000000;">ToMax</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
fcoOptions.<span style="color: #000000;">StepSize</span> <span style="color: #000080;">=</span> nBinSize;
fcoOptions.<span style="color: #000000;">IncludeLTMin</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
fcoOptions.<span style="color: #000000;">IncludeGEMax</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;

vector vBinCenters<span style="color: #000000;">(</span>nBinSize<span style="color: #000000;">)</span>;
vector vAbsoluteCounts<span style="color: #000000;">(</span>nBinSize<span style="color: #000000;">)</span>;
vector vCumulativeCounts<span style="color: #000000;">(</span>nBinSize<span style="color: #000000;">)</span>;
<span style="color: #0000ff;">int</span> nOption <span style="color: #000080;">=</span> FC_NUMINTERVALS; <span style="color: #008000;">// 最後のビンを拡張</span>

<span style="color: #0000ff;">int</span> nRet <span style="color: #000080;">=</span> ocmath_frequency_count<span style="color: #000000;">(</span>
    vData, vData.<span style="color: #000000;">GetSize</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>, <span style="color: #000040;">&amp;</span>fcoOptions,
    vBinCenters, nBinSize, vAbsoluteCounts, nBinSize,
    vCumulativeCounts, nBinSize, nOption<span style="color: #000000;">)</span>;

<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> STATS_NO_ERROR <span style="color: #000080;">==</span> nRet <span style="color: #000000;">)</span>
    out_str<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Done&quot;</span><span style="color: #000000;">)</span>;</pre>
<p>さらに、離散/カテゴリーデータに対して度数カウントを計算する2つの関数があります。  1つはテキストデータに対する <a href="../../OriginC/OriginC/Ocu_discrete_frequencies_(global_function).html" title="OriginC:Ocu discrete frequencies (global function)">ocu_discrete_frequencies</a> で、もう1つは数値データに対する <a href="../../OriginC/OriginC/Ocmath_discrete_frequencies_(global_function).html" title="OriginC:Ocmath discrete frequencies (global function)">ocmath_discrete_frequencies</a> です。また、2次元データに対して度数カウントを計算する2つの関数があります。<a href="../../OriginC/OriginC/Ocmath_2d_binning_stats_(global_function).html" title="OriginC:Ocmath 2d binning stats (global function)">ocmath_2d_binning_stats</a> と <a href="../../OriginC/OriginC/Ocmath_2d_binning_(global_function).html" title="OriginC:Ocmath 2d binning (global function)">ocmath_2d_binning</a>です。 
</p>
<h2><a name="Correlation_Coefficient"></a><span class="mw-headline"><span class="OIndex">相関係数</span></span></h2>
<p>ocmath_corr_coeff関数は、Pearson rank, Spearman rank, Kendall rankの相関係数を計算するのに使われます。
</p>
<pre class="oc" style="font-family:monospace;">matrix mData <span style="color: #000080;">=</span> <span style="color: #000000;">{</span><span style="color: #000000;">{</span><span style="color: #0000dd;">10</span>,<span style="color: #0000dd;">12</span>,<span style="color: #0000dd;">13</span>,<span style="color: #0000dd;">11</span><span style="color: #000000;">}</span>, <span style="color: #000000;">{</span><span style="color: #0000dd;">13</span>,<span style="color: #0000dd;">10</span>,<span style="color: #0000dd;">11</span>,<span style="color: #0000dd;">12</span><span style="color: #000000;">}</span>, <span style="color: #000000;">{</span><span style="color: #0000dd;">9</span>,<span style="color: #0000dd;">12</span>,<span style="color: #0000dd;">10</span>,<span style="color: #0000dd;">11</span><span style="color: #000000;">}</span><span style="color: #000000;">}</span>; 
<span style="color: #0000ff;">int</span> nRows <span style="color: #000080;">=</span> mData.<span style="color: #000000;">GetNumRows</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
<span style="color: #0000ff;">int</span> nCols <span style="color: #000080;">=</span> mData.<span style="color: #000000;">GetNumCols</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;

matrix mPeaCorr<span style="color: #000000;">(</span>nCols, nCols<span style="color: #000000;">)</span>;
matrix mPeaSig<span style="color: #000000;">(</span>nCols, nCols<span style="color: #000000;">)</span>;

matrix mSpeCorr<span style="color: #000000;">(</span>nCols, nCols<span style="color: #000000;">)</span>;
matrix mSpeSig<span style="color: #000000;">(</span>nCols, nCols<span style="color: #000000;">)</span>;

matrix mKenCorr<span style="color: #000000;">(</span>nCols, nCols<span style="color: #000000;">)</span>;
matrix mKenSig<span style="color: #000000;">(</span>nCols, nCols<span style="color: #000000;">)</span>;

<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span>STATS_NO_ERROR <span style="color: #000080;">==</span> ocmath_corr_coeff<span style="color: #000000;">(</span>nRows, nCols, mData, mPeaCorr, mPeaSig, 
	mSpeCorr, mSpeSig, mKenCorr, mKenSig<span style="color: #000000;">)</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span> 
	out_str<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Done&quot;</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span></pre>
<h2><a name="Normality_Test"></a><span class="mw-headline"><span class="OIndex">正規性の検定</span></span></h2>
<p>*<b><a href="../../OriginC/OriginC/Ocmath_shapiro_wilk_test_(global_function).html" title="OriginC:Ocmath shapiro wilk test (global function)">ocmath_shapiro_wilk_test</a></b>関数を使って、Shapiro-Wilkの正規性の検定を実行します。 
*<b><a href="../../OriginC/OriginC/Ocmath_lilliefors_test_(global_function).html" title="OriginC:Ocmath lilliefors test (global function)">ocmath_lilliefors_test</a></b>関数を使って、Lillieforsの正規性の検定を実行します。 
*<b><a href="../../OriginC/OriginC/Ocmath_kolmogorov_smirnov_test_(global_function).html" title="OriginC:Ocmath kolmogorov smirnov test (global function)">ocmath_kolmogorov_smirnov_test</a></b> 関数を使って、Kolmogorov-Smirnovの正規性の検定を実行します。 
</p>
<pre class="oc" style="font-family:monospace;">vector vTestData <span style="color: #000080;">=</span> <span style="color: #000000;">{</span><span style="color: #0000dd;">0.11</span>, <span style="color: #0000dd;">0.39</span>, <span style="color: #0000dd;">0.43</span>, <span style="color: #0000dd;">0.54</span>, <span style="color: #0000dd;">0.68</span>, <span style="color: #0000dd;">0.71</span>, <span style="color: #0000dd;">0.86</span><span style="color: #000000;">}</span>;

NormTestResults SWRes;
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> STATS_NO_ERROR <span style="color: #000080;">==</span> ocmath_shapiro_wilk_test<span style="color: #000000;">(</span>vTestData.<span style="color: #000000;">GetSize</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>, vTestData, 
		<span style="color: #000040;">&amp;</span>SWRes, <span style="color: #0000dd;">1</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
	<span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;DOF=%d, TestStat=%g, Prob=%g<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, SWRes.<span style="color: #000000;">DOF</span>, SWRes.<span style="color: #000000;">TestStat</span>, SWRes.<span style="color: #000000;">Prob</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span></pre>







    