<h1 class="firstheading">仮想行列</h1><p>ワークシートウィンドウから仮想行列を構築することができます。仮想行列のXYZデータに対するワークシートのデータ範囲を別々に取得します。XおよびYデータを指定しない場合、デフォルトデータが自動的に使われます。次のコードはアクティブワークシートウィンドウから仮想行列を構築し、この仮想行列をグラフにプロットする方法を示しています。 
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// 実行前に、アクティブワークシートにデータがあることを確認</span>
<span style="color: #008000;">// 例えば、新しいワークシートに、Originのインストールフォルダの</span>
<span style="color: #008000;">// Samples\Matrix Conversion and Gridding にあるXYZ Random Gaussian.dat をインポート</span>
Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;

<span style="color: #0000ff;">int</span> r1, r2;
<span style="color: #0000ff;">int</span> c1 <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>, c2 <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
wks.<span style="color: #000000;">GetBounds</span><span style="color: #000000;">(</span>r1, c1, r2, c2<span style="color: #000000;">)</span>;

<span style="color: #008000;">// Zデータのみデータ範囲を構築すると</span>
<span style="color: #008000;">// X、Yデータは自動的に割り当て</span>
DataRange dr;
dr.<span style="color: #000000;">Add</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Z&quot;</span>, wks, r1, c1, r2, c2<span style="color: #000000;">)</span>;

MatrixObject mo;
mo.<span style="color: #000000;">Attach</span><span style="color: #000000;">(</span>dr<span style="color: #000000;">)</span>;

<span style="color: #0000ff;">int</span> nRows <span style="color: #000080;">=</span> mo.<span style="color: #000000;">GetNumRows</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
<span style="color: #0000ff;">int</span> nCols <span style="color: #000080;">=</span> mo.<span style="color: #000000;">GetNumCols</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;

<span style="color: #008000;">// デフォルトのx, y 範囲を取得</span>
<span style="color: #0000ff;">double</span> xmin, xmax, ymin, ymax;
mo.<span style="color: #000000;">GetXY</span><span style="color: #000000;">(</span>xmin, ymin, xmax, ymax<span style="color: #000000;">)</span>;

GraphPage gp;
gp.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;CONTOUR&quot;</span><span style="color: #000000;">)</span>;
GraphLayer gl <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;

gl.<span style="color: #000000;">AddPlot</span><span style="color: #000000;">(</span>mo, IDM_PLOT_CONTOUR<span style="color: #000000;">)</span>;
gl.<span style="color: #000000;">Rescale</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;

mo.<span style="color: #000000;">Detach</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</pre>
<p>XYデータを割り当てたい場合、データは単調増加あるいは、減少するものである必要があります。次のサンプルは、XYZデータ範囲から仮想行列を構築する方法を示しています。
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// アクティブレイヤには5列のデータがあるとする</span>
Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;

<span style="color: #008000;">// 列0から4に対する最小と最大の行インデックスを取得</span>
<span style="color: #0000ff;">int</span> r1, r2, c1 <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>, c2 <span style="color: #000080;">=</span> <span style="color: #0000dd;">4</span>;
wks.<span style="color: #000000;">GetBounds</span><span style="color: #000000;">(</span>r1, c1, r2, c2<span style="color: #000000;">)</span>;

<span style="color: #008000;">// XYZデータを持つデータ範囲オブジェクトを作成</span>
DataRange dr;
dr.<span style="color: #000000;">Add</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;X&quot;</span>, wks, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">0</span>, c2<span style="color: #000000;">)</span>; <span style="color: #008000;">// 最初のセルを除く最初の行</span>
dr.<span style="color: #000000;">Add</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Y&quot;</span>, wks, <span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">0</span>, r2, <span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// 最初のセルを除く最初の列</span>
dr.<span style="color: #000000;">Add</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Z&quot;</span>, wks, <span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">1</span>, r2, c2<span style="color: #000000;">)</span>;

MatrixObject mo;
mo.<span style="color: #000000;">Attach</span><span style="color: #000000;">(</span>dr<span style="color: #000000;">)</span>;</pre>







    