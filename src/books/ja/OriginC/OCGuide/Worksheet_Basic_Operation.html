<h1 class="firstheading">ワークシートの基本操作</h1><p>ワークシートの基本的な操作には、ワークブックにシートを追加、ワークシートをアクティブ化、ワークシートプロパティの取得や設定、ワークシート削除などを含みます。ここではいくつかのサンプルも紹介しています。
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Add_New_Worksheet"><span class="tocnumber">1</span> <span class="toctext">新しいワークシートを追加する</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Activate_a_Worksheet"><span class="tocnumber">2</span> <span class="toctext">ワークシートをアクティブにする</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Delete_Worksheet"><span class="tocnumber">3</span> <span class="toctext">ワークブックを削除する</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Access_Worksheets_in_WorkbookWorkbook.2C_Get_One_SheetWorkbook.2C_Get_Name"><span class="tocnumber">4</span> <span class="toctext">ワークブック内のワークシートにアクセスする<span class="OIndex" style="display:none">ワークブック、1シートを取得</span><span class="OIndex" style="display:none">ワークブック、名前を取得</span></span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Reorder_Worksheets"><span class="tocnumber">5</span> <span class="toctext">ワークシートの並べ替え</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Copy_Worksheet"><span class="tocnumber">6</span> <span class="toctext">ワークシートをコピー</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Format_a_Worksheet"><span class="tocnumber">7</span> <span class="toctext">ワークシートのフォーマット</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Merge_CellsWorksheet.2C_Merge_Cells"><span class="tocnumber">8</span> <span class="toctext">セルの統合<span class="OIndex" style="display:none">ワークシート、セルの統合</span></span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Read_Only_Cells"><span class="tocnumber">9</span> <span class="toctext">読み取り専用セル</span></a></li>
</ul>
</div>

<h2><a name="Add_New_Worksheet"></a><span class="mw-headline">新しいワークシートを追加する</span></h2>
<p><a href="../../OriginC/OriginC/Page-AddLayer.html" title="OriginC:Page-AddLayer">AddLayer</a> メソッドを使用してワークシートをブックに追加します。
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// &quot;Book1&quot;というワークブックにアクセス</span>
WorksheetPage wksPage<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Book1&quot;</span><span style="color: #000000;">)</span>;

<span style="color: #008000;">// ワークブックにシートを追加</span>
<span style="color: #0000ff;">int</span> index <span style="color: #000080;">=</span> wksPage.<span style="color: #000000;">AddLayer</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;New Sheet&quot;</span><span style="color: #000000;">)</span>; 

<span style="color: #008000;">// 新しいワークシートにアクセス</span>
Worksheet wksNew <span style="color: #000080;">=</span> wksPage.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span>index<span style="color: #000000;">)</span>;</pre>
<h2><a name="Activate_a_Worksheet"></a><span class="mw-headline">ワークシートをアクティブにする</span></h2>
<p><span class="OIndex" style="display:none">Active Worksheet</span><span class="OIndex" style="display:none">Active Window</span><span class="OIndex" style="display:none">Active Workbook</span><span class="OIndex" style="display:none">Active Matrixbook</span><span class="OIndex" style="display:none">Active Column</span><a href="../../OriginC/Category/Workbooks.html" title="カテゴリー: ワークブック">Workbook</a> は、ワークシートを含むOriginのオジェクトです。ワークブック内のシートをアクティブにするには、関数<a href="../../OriginC/OriginC/Set_active_layer_(global_function).html" title="OriginC:Set active layer (global function)">set_active_layer</a> を使用します。
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// フルネームによりワークシートにアクセス</span>
Worksheet wks<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;[Book1]Sheet1&quot;</span><span style="color: #000000;">)</span>;

<span style="color: #008000;">// このワークシートをアクティブにする</span>
set_active_layer<span style="color: #000000;">(</span>wks<span style="color: #000000;">)</span>;</pre>
<h2><a name="Delete_Worksheet"></a><span class="mw-headline">ワークブックを削除する</span></h2>
<p><span class="OIndex" style="display:none">ワークブックを削除する</span><a href="../../OriginC/OriginC/OriginObject-Destroy.html" title="OriginC:OriginObject-Destroy">Destroy</a>メソッドを使用してワークシートを削除します。
</p>
<pre class="oc" style="font-family:monospace;">Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> wks <span style="color: #000000;">)</span> <span style="color: #008000;">//アクティブレイヤがワークシートの時</span>
    wks.<span style="color: #000000;">Destroy</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// ワークシート削除</span></pre>
<h2><a name="Access_Worksheets_in_WorkbookWorkbook.2C_Get_One_SheetWorkbook.2C_Get_Name"></a><span class="mw-headline">ワークブック内のワークシートにアクセスする<span class="OIndex" style="display:none">ワークブック、1シートを取得</span><span class="OIndex" style="display:none">ワークブック、名前を取得</span></span></h2>
<p>名前でワークシートにアクセスするには、2通りあります。  コンストラクタや付加メソッドにレイヤのフルネームを渡します。  レイヤのフルネームには、[ ] 内にページ名が含まれ、そのあとにレイヤ名が続きます。
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// wksPageが、アクセスしたいシートを保持している有効なWorksheetPageであると仮定</span>
string strFullName <span style="color: #000080;">=</span> okutil_make_book_sheet_string<span style="color: #000000;">(</span>wksPage.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>, <span style="color: #ff00ff;">&quot;Sheet1&quot;</span><span style="color: #000000;">)</span>;

<span style="color: #008000;">// ブックとシートの名前がわかれば、手動で文字列を構築可能</span>
string strFullName <span style="color: #000080;">=</span> okutil_make_book_sheet_string<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Book5&quot;</span>, <span style="color: #ff00ff;">&quot;Sheet1&quot;</span><span style="color: #000000;">)</span>;</pre>
<p>全レイヤ名がある場合、ワークシートにアクセスできます。
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">//  ワークシートインスタンスを構築して名前の付いたシートを追加</span>
Worksheet wks1<span style="color: #000000;">(</span>strFullName<span style="color: #000000;">)</span>;

<span style="color: #008000;">// 名前の付いたシートに既存のワークシートインスタンスを付加</span>
wks2.<span style="color: #000000;">Attach</span><span style="color: #000000;">(</span>strFullName<span style="color: #000000;">)</span>;</pre>
<p>ワークシートのコレクションを持つワークブックの場合。  <b>foreach</b>ステートメントを使用して指定したワークブック内の全ワークシートでループできます。
</p>
<pre class="oc" style="font-family:monospace;">WorksheetPage wksPage<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Book1&quot;</span><span style="color: #000000;">)</span>;
foreach<span style="color: #000000;">(</span>Layer wks in wksPage.<span style="color: #000000;">Layers</span><span style="color: #000000;">)</span>
    out_str<span style="color: #000000;">(</span>wks.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;</pre>
<p>指定したワークシートに名前または索引でアクセスすることもできます。
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">//Book1ページには最低2つのシートがあるとする,</span>
<span style="color: #008000;">//これらの名前はSheet1 と Sheet2</span>
WorksheetPage wksPage<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Book1&quot;</span><span style="color: #000000;">)</span>;
Worksheet wksFirst <span style="color: #000080;">=</span> wksPage.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>; <span style="color: #008000;">//インデックスによる</span>
Worksheet wksSecond <span style="color: #000080;">=</span> wksPage.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Sheet2&quot;</span><span style="color: #000000;">)</span>; <span style="color: #008000;">//名前による</span></pre>
<h2><a name="Reorder_Worksheets"></a><span class="mw-headline">ワークシートの並べ替え</span></h2>
<p><a href="../../OriginC/OriginC/Worksheet-Reorder.html" title="OriginC:ワークシートの並べ替え">Reorder</a> メソッドでワークブック内のワークシートの順序を変更できます。
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">//  このサンプルは、アクティブワークブックに2つのシートがあることが前提</span>

<span style="color: #008000;">// アクティブなレイヤからアクティブなページを取得</span>
WorksheetPage wksPage;
Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> wks <span style="color: #000000;">)</span>
    wksPage <span style="color: #000080;">=</span> wks.<span style="color: #000000;">GetPage</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;

<span style="color: #008000;">// 2つ目のワークシートを1番目のポジションに移動</span>
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> wksPage.<span style="color: #000000;">Reorder</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">0</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
    out_str<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Reorder sheets successfully&quot;</span><span style="color: #000000;">)</span>;</pre>
<h2><a name="Copy_Worksheet"></a><span class="mw-headline">ワークシートをコピー</span></h2>
<p><a href="../../OriginC/OriginC/Page-AddLayer.html" title="OriginC:Page-AddLayer">AddLayer</a>メソッドは、1つのページから他にコピーするのに使用されます。これは、GraphPage, WorksheetPage あるいは MatrixPageをともに使用できます。 
</p><p>次のサンプルは、アクティブフォルダにある全ワークシートをアクティブワークブックにドラッグして統合する方法を示しています。
</p>
<pre class="oc" style="font-family:monospace;">WorksheetPage wksPageDest <span style="color: #000080;">=</span> Project.<span style="color: #000000;">Pages</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #000040;">!</span>wksPageDest <span style="color: #000000;">)</span> <span style="color: #008000;">// アクティブウィンドウがない、あるいはアクティブウィンドウはワークシートではない</span>
	<span style="color: #0000ff;">return</span>; 

<span style="color: #0000ff;">bool</span> bKeepSourceLayer <span style="color: #000080;">=</span> <span style="color: #0000ff;">false</span>; <span style="color: #008000;">// コピー後ソースレイヤは削除</span>
Folder fld <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveFolder</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; 
foreach<span style="color: #000000;">(</span>PageBase pb in fld.<span style="color: #000000;">Pages</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
    WorksheetPage wbSource<span style="color: #000000;">(</span>pb<span style="color: #000000;">)</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span><span style="color: #000040;">!</span>wbSource<span style="color: #000000;">)</span>
        <span style="color: #0000ff;">continue</span>;<span style="color: #008000;">//ワークブックではない
 </span>
    
    <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span>wbSource.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000080;">==</span> wksPageDest.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>
        <span style="color: #0000ff;">continue</span>;<span style="color: #008000;">//目的のブックはスキップ
 </span>
    
    <span style="color: #008000;">//目的のブックにワークシートをコピーし、ソースブックから削除</span>
    foreach<span style="color: #000000;">(</span>Layer lay in wbSource.<span style="color: #000000;">Layers</span><span style="color: #000000;">)</span>
    <span style="color: #000000;">{</span>
        Worksheet wks <span style="color: #000080;">=</span> lay;
        wksPageDest.<span style="color: #000000;">AddLayer</span><span style="color: #000000;">(</span>wks, <span style="color: #0000dd;">0</span>, bKeepSourceLayer<span style="color: #000000;">)</span>;
    <span style="color: #000000;">}</span>
    wbSource.<span style="color: #000000;">Destroy</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;<span style="color: #008000;">//空のワークブックを破棄
</span>
<span style="color: #000000;">}</span></pre>
<h2><a name="Format_a_Worksheet"></a><span class="mw-headline">ワークシートのフォーマット</span></h2>
<p>プログラミングで、テーマツリーを使用してワークシートをフォーマットできます。  以下のサンプルでは、既存テーマツリーを生成して保存する操作を示します。
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// ワークシートからフォーマットツリーを取得</span>
Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;

Tree tr;	
tr <span style="color: #000080;">=</span> wks.<span style="color: #000000;">GetFormat</span><span style="color: #000000;">(</span>FPB_ALL, FOB_ALL, <span style="color: #0000ff;">TRUE</span>, <span style="color: #0000ff;">TRUE</span><span style="color: #000000;">)</span>;	
out_tree<span style="color: #000000;">(</span>tr<span style="color: #000000;">)</span>; <span style="color: #008000;">// スクリプトウィンドウにツリーを出力</span></pre>
<p>あるいは、次の3つの操作でテーマツリーを行使することもできます。  まず、ワークシートを作成し、データを挿入します。
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// ワークシートを作成</span>
Worksheet wks;
wks.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Origin&quot;</span><span style="color: #000000;">)</span>;	
wks.<span style="color: #000000;">SetCell</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">0</span>, <span style="color: #ff00ff;">&quot;abc&quot;</span><span style="color: #000000;">)</span>; <span style="color: #008000;">//  (0, 0) セルにテキストを入力</span>

<span style="color: #008000;">// フォーマット適用のためにデータ範囲を確立する</span>
DataRange dr;
<span style="color: #0000ff;">int</span> r1 <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>, c1 <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>, r2 <span style="color: #000080;">=</span> <span style="color: #0000dd;">4</span>, c2 <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;	
dr.<span style="color: #000000;">Add</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Range1&quot;</span>, wks, r1, c1, r2, c2<span style="color: #000000;">)</span>;</pre>
<p>次に、範囲情報を使用してツリーを構成し、希望のプロパティに値を与えます。  
</p>
<pre class="oc" style="font-family:monospace;">Tree tr;

<span style="color: #008000;">// 塗りつぶし</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">CommonStyle</span>.<span style="color: #000000;">Fill</span>.<span style="color: #000000;">FillColor</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> SYSCOLOR_LTCYAN; 

<span style="color: #008000;">// セル内のテキストの配置、中央は2</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">CommonStyle</span>.<span style="color: #000000;">Alignment</span>.<span style="color: #000000;">Horizontal</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;

<span style="color: #008000;">// テキストのフォントサイズ</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">CommonStyle</span>.<span style="color: #000000;">Font</span>.<span style="color: #000000;">Size</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">11</span>;

<span style="color: #008000;">// テキストの色</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">CommonStyle</span>.<span style="color: #000000;">Color</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> SYSCOLOR_BLUE;</pre>
<p>そして、データ範囲にフォーマットを適用します。
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// 指定したデータ範囲にフォーマットを適用</span>
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> dr.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">(</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span> <span style="color: #008000;">// 0はエラーなし
</span>
<span style="color: #000000;">{</span>
	<span style="color: #0000ff;">bool</span> bRet <span style="color: #000080;">=</span> dr.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">(</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span></pre>
<h2><a name="Merge_CellsWorksheet.2C_Merge_Cells"></a><span class="mw-headline">セルの統合</span></h2>
<p>Origin Cコードを使用して、指定した範囲のワークシートセルを統合できます。選択範囲はデータ領域あるいは、列ラベル領域を指定することができます。ラベルセルを統合したい場合、次のコードで<i>bLabels </i>を<b>true</b>にします。
</p>
<pre class="oc" style="font-family:monospace;">Worksheet wks;
wks.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Origin&quot;</span><span style="color: #000000;">)</span>;

<span style="color: #008000;">//Grid を定義してワークシートに付加</span>
Grid gg;
gg.<span style="color: #000000;">Attach</span><span style="color: #000000;">(</span>wks<span style="color: #000000;">)</span>; 

<span style="color: #008000;">// 2列の最初の2行を統合する</span>
ORANGE rng;
rng.<span style="color: #000000;">r1</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
rng.<span style="color: #000000;">c1</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
rng.<span style="color: #000000;">r2</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
rng.<span style="color: #000000;">c2</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;

<span style="color: #0000ff;">bool</span> bLabels <span style="color: #000080;">=</span> <span style="color: #0000ff;">false</span>;
<span style="color: #0000ff;">bool</span> bRet <span style="color: #000080;">=</span> gg.<span style="color: #000000;">MergeCells</span><span style="color: #000000;">(</span>rng, bLabels<span style="color: #000000;">)</span>;

<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> bRet <span style="color: #000000;">)</span>
	<span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Successfully merged cells in&nbsp;%s!<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, wks.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
<span style="color: #0000ff;">else</span>
	<span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Failed to merge cells in&nbsp;%s!<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, wks.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;</pre>
<h2><a name="Read_Only_Cells"></a><span class="mw-headline">読み取り専用セル</span></h2>
<p>ワークシートセルの内容を変更したくないとき、テーマツリーを使用してセルを読み取り専用にすることができます。 
</p><p>次のサンプルでは、ワークシート内のデータセルを読み取り専用にし、列1の2つ目のデータセルを編集可能にする方法を示します。
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// デフォルトテンプレート（Origin）を使用してワークシートを作成</span>
<span style="color: #008000;">// ロングネーム、単位、コメント行が表示される</span>
Worksheet wks;
wks.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Origin&quot;</span><span style="color: #000000;">)</span>;

Tree tr;
tr <span style="color: #000080;">=</span> wks.<span style="color: #000000;">GetFormat</span><span style="color: #000000;">(</span>FPB_ALL, FOB_ALL, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">// ワークシートのテーマツリー取得</span>

<span style="color: #008000;">//テーマツリーから指定したツリーノードを取得し、</span>
<span style="color: #008000;">// データセルを読み取り専用にセットするために開始</span>
string strName <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;ogData&quot;</span>;  <span style="color: #008000;">// 希望のフォーマットでノードを取得するために使用</span>
TreeNode trGrid, trNameStyles;
trGrid <span style="color: #000080;">=</span> tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Grid</span>;  <span style="color: #008000;">//グリッドノードを取得</span>
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span><span style="color: #000040;">!</span>trGrid.<span style="color: #000000;">IsValid</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>
	<span style="color: #0000ff;">return</span>;

<span style="color: #008000;">// このノードの子ノードに読み取り専用フォーマットがある</span>
trNameStyles <span style="color: #000080;">=</span> trGrid.<span style="color: #000000;">NameStyles</span>;  
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span><span style="color: #000040;">!</span>trNameStyles.<span style="color: #000000;">IsValid</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>
	<span style="color: #0000ff;">return</span>;

TreeNode trNameStyle;
<span style="color: #0000ff;">bool</span> bRet <span style="color: #000080;">=</span> <span style="color: #0000ff;">false</span>;
<span style="color: #008000;">// 希望のツリーノードを見つけるためにすべての子ノードをループ</span>
foreach<span style="color: #000000;">(</span>trNameStyle in trNameStyles.<span style="color: #000000;">Children</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
	<span style="color: #008000;">// ノード&quot;ogData&quot;を検索</span>
	<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> trNameStyle.<span style="color: #000000;">Name</span>.<span style="color: #000000;">strVal</span>.<span style="color: #000000;">Compare</span><span style="color: #000000;">(</span>strName<span style="color: #000000;">)</span><span style="color: #000000;">)</span>  
	<span style="color: #000000;">{</span>
		bRet <span style="color: #000080;">=</span> <span style="color: #0000ff;">true</span>;
		<span style="color: #0000ff;">break</span>;
	<span style="color: #000000;">}</span>
<span style="color: #000000;">}</span>
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span><span style="color: #000040;">!</span>bRet<span style="color: #000000;">)</span>
	<span style="color: #0000ff;">return</span>;

trNameStyle.<span style="color: #000000;">Style</span>.<span style="color: #000000;">ReadOnly</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;  <span style="color: #008000;">// 読み取り専用にするためにすべてのデータセルをセット</span>

<span style="color: #008000;">// テーマツリーから特定のツリーノードを取得/作成するため</span>
<span style="color: #008000;">// 指定したデータセルのお読み取り専用フォーマットをキャンセルするために開始</span>
TreeNode trRangeStyles;
trRangeStyles <span style="color: #000080;">=</span> trGrid.<span style="color: #000000;">RangeStyles</span>;  <span style="color: #008000;">// GridノードからRangeStylesノードを取得</span>
TreeNode trRangeStyle;
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span><span style="color: #000040;">!</span>trRangeStyles.<span style="color: #000000;">IsValid</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>  <span style="color: #008000;">// RangeStyles ノードがない場合</span>
<span style="color: #000000;">{</span>
	<span style="color: #008000;">// RangeStylesノードを作成</span>
	trRangeStyles <span style="color: #000080;">=</span> trGrid.<span style="color: #000000;">AddNode</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;RangeStyles&quot;</span><span style="color: #000000;">)</span>;
	<span style="color: #008000;">// そしてRangeStyle1というサブノードを作成</span>
	trRangeStyle <span style="color: #000080;">=</span> trRangeStyles.<span style="color: #000000;">AddNode</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;RangeStyle1&quot;</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span>
<span style="color: #0000ff;">else</span>  <span style="color: #008000;">// RangeStyles ノードがある場合</span>
<span style="color: #000000;">{</span>
	<span style="color: #008000;">// 子ノードがいくつあるか検索</span>
	<span style="color: #0000ff;">int</span> tagNum <span style="color: #000080;">=</span> trRangeStyles.<span style="color: #000000;">Children</span>.<span style="color: #000000;">Count</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
	<span style="color: #008000;">// RangeStyle#（# = tagNum+1）という名前のサブノードを作成</span>
	trRangeStyle <span style="color: #000080;">=</span> trRangeStyles.<span style="color: #000000;">AddNode</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;RangeStyle&quot;</span><span style="color: #000040;">+</span><span style="color: #000000;">(</span>tagNum<span style="color: #000040;">+</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span>
<span style="color: #008000;">// 設定のための範囲を定義。ここでは範囲ｙは1つのセル</span>
<span style="color: #008000;">// 1から始まる範囲内の左のセル</span>
trRangeStyle.<span style="color: #000000;">Left</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;  
<span style="color: #008000;">// 2から始まる範囲の上のセル（ラベル行を含む）</span>
<span style="color: #008000;">// 4つのラベル行があるので、5は最初のデータセル</span>
trRangeStyle.<span style="color: #000000;">Top</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>;  
<span style="color: #008000;">// 1つのセルなので範囲の右は左と同じ</span>
trRangeStyle.<span style="color: #000000;">Right</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
<span style="color: #008000;">// 1つのセルなので下のセルと上のセルは同じ</span>
trRangeStyle.<span style="color: #000000;">Bottom</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>;
trRangeStyle.<span style="color: #000000;">Style</span>.<span style="color: #000000;">ReadOnly</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;  <span style="color: #008000;">// 0にして読み取り専用をキャンセル</span>

<span style="color: #008000;">// ワークシートにフォーマット設定を適用</span>
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> wks.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">(</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
	<span style="color: #0000ff;">bool</span> bb <span style="color: #000080;">=</span> wks.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">(</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>;
	<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span>bb<span style="color: #000000;">)</span>
	<span style="color: #000000;">{</span>
		<span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Cell 1 in column 1 is editable.<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span><span style="color: #000000;">)</span>;
	<span style="color: #000000;">}</span>
<span style="color: #000000;">}</span></pre>
<p>ラベル行のセルを読み取り専用にすることもできます上述のコードに簡単な変更を加えることで行えます。たとえば、列2以外のコメント行を読み取り専用にする場合、以下のようにして変更を行います。
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000; font-style: regular;">/* 上述コード内の以下のラインをコメントアウト
string strName = &quot;ogData&quot;;
*/</span>
<span style="color: #008000;">// これはデータのための行なので、次のようにコメントのための行に変更</span>
string strName <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;ogComment&quot;</span>;

<span style="color: #008000; font-style: regular;">/* 上記コードの次の4行をコメントアウト
trRangeStyle.Left.nVal = 1; 
trRangeStyle.Top.nVal = 5;
trRangeStyle.Right.nVal = 1;
trRangeStyle.Bottom.nVal = 5;
*/</span>
<span style="color: #008000;">// この4行は2番目のデータセル（ワークシート内で3つのラベル行があると仮定）</span>
<span style="color: #008000;">// の設定のために使用</span>
<span style="color: #008000;">// ここではコメントセルに対して設定する</span>
<span style="color: #008000;">// コメント行は列2の3番目であると仮定して </span>
<span style="color: #008000;">// 列1ではない</span>
trRangeStyle.<span style="color: #000000;">Left</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> 
trRangeStyle.<span style="color: #000000;">Right</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;  <span style="color: #008000;">// Column 2</span>
<span style="color: #008000;">// コメント行(ワークシート内で表示された3番目の行)</span>
trRangeStyle.<span style="color: #000000;">Top</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> 
trRangeStyle.<span style="color: #000000;">Bottom</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;</pre>







    