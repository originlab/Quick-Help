<h1 class="firstheading">Xファンクション</h1>
<h3><a name="Dialog_generated_by_X-Function" id="Dialog_generated_by_X-Function"></a><span class="mw-headline">Xファンクションでダイアログを作成</span></h3>
<p>このサンプルでは、Xファンクションビルダを使ってXファンクションを作成することにより、ダイアログ生成の自動化について説明します。Xファンクションビルダはツールメニューで「Xファンクション・ビルダ」を選択すると開きます。</p>
<div style="text-align: center;">
<p><a class="image"><img alt="Xfunction.png" src="../images/X-Function/300px-Xfunction.png" width="517" height="418" border="0" /></a></p>
</div>
<h3><a name="Creating_X-Function" id="Creating_X-Function"></a><span class="mw-headline">X ファンクションの作成</span></h3>
<p>以下のステップはXファンクションの作成手順を示します。今回の例では、1つの列のデータを他の列にコピーするタスクを担うXファンクションを作成します。</p>
<ol>
<li>Xファンクションビルダを開き、Xファンクションの名前を「CopyCol」とし、変数リスト上で右クリックして「変数の追加」を選択して2つ目の変数を追加します。変数の名前、ラベル、他の値を次の画像と同じになるように入力します。</li>
</ol>
<div style="text-align: center;">
<p><a class="image"><img alt="XFunction2.png" src="../images/X-Function/300px-XFunction2.png" width="517" height="418" border="0" /></a></p>
</div>
<p>2.変数に必要な変更を加えたら、 OXFファイルを保存するボタン<a class="image"><img alt="Savebutton.png" src="../images/X-Function/Savebutton.png" width="25" border="0" /></a>をクリックしてXファンクションを保存します。名前を付けて保存ダイアログが開かれたら、保存ボタンをクリックします。</p>
<p>3.では、目的の動作をするためのOrigin Cコードを入力してXファンクションを作成しましょう。コードビルダボタン<a class="image"><img alt="Cb.png" src="../images/X-Function/Cb.png" width="26" border="0" /></a>をクリックします。これはXファンクションをコードビルダで開き、Origin Cコードを入力出来る状態にします。メインの関数に以下のOrigin Cコードを追加します。</p>
<pre class="lt" style="font-family: monospace;">
ocol <span style="color: #000080;">=</span> icol;
</pre>
<p>4.コンパイルボタンをクリックしてからダイアログに戻るをクリックするとXファンクションビルダに戻ります。OXFファイルの保存ボタンをクリックしましょう。</p>
<h3><a name="Launch_the_X-function_dialog" id="Launch_the_X-function_dialog"></a><span class="mw-headline">Xファンクションダイアログを開きます。</span></h3>
<p>作成したXファンクションをテストしてみます。</p>
<ol>
<li>2つの列がある、新しいワークシートを作成します。列Aに行番号を入力し、ヘッダをクリックして列全体を選択します。</li>
<li>スクリプトまたはコマンドウィンドウに「CopyCol -d」と入力し(カギ括弧は入力しないでください)、Enterを押します。</li>
<li>ダイアログが開いたらデフォルトの値のままOKボタンをクリックします。</li>
</ol>
<p>Xファンクションが実行されると、ワークシートは3番目の列を追加し、そこに列Aのデータをコピーします。</p>
