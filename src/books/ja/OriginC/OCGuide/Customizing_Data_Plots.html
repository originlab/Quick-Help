<h1 class="firstheading">データプロットを編集する</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Adding_Data_MarkerGraph_Layer.2C_Add_Data_MarkerGraph_Layer.2C_Remove_Data_MarkerGraph_Layer.2C_Set_Data_Marker"><span class="tocnumber">1</span> <span class="toctext">データマーカーを追加する <span class="OIndex" style="display:none">Graph Layer, Add Data Marker</span><span class="OIndex" style="display:none">Graph Layer, Remove Data Marker</span><span class="OIndex" style="display:none">Graph Layer, Set Data Marker</span></span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Setting_ColorGraph_Layer.2C_Set_Color_on_DataPlot"><span class="tocnumber">2</span> <span class="toctext">色を設定する<span class="OIndex" style="display:none">Graph Layer, Set Color on DataPlot</span></span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Getting_Format_TreeGraph_Layer.2C_Get_Format_on_DataPlot"><span class="tocnumber">3</span> <span class="toctext">フォーマットツリーの取得<span class="OIndex" style="display:none">Graph Layer, Get Format on DataPlot</span></span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Setting_Format_on_Line_PlotGraph_Layer.2C_Set_Format_on_Line_Plot"><span class="tocnumber">4</span> <span class="toctext">折れ線グラフのフォーマットをセットする<span class="OIndex" style="display:none">Graph Layer, Set Format on Line Plot</span></span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Copying_Format_from_One_Data_Plot_to_AnotherCopy_FormatOrigin_Object.2C_Copy_Format"><span class="tocnumber">5</span> <span class="toctext">あるデータプロットから別のプロットにフォーマットをコピーする<span class="OIndex" style="display:none">Copy Format</span><span class="OIndex" style="display:none">Origin Object, Copy Format</span></span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#Copying_Format_via_Theme_FileTheme_File"><span class="tocnumber">5.1</span> <span class="toctext">テーマファイルでフォーマットをコピーする<span class="OIndex" style="display:none">Theme File</span></span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Copying_Format_via_Tree"><span class="tocnumber">5.2</span> <span class="toctext">ツリーでフォーマットをコピーする</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8"><a href="#Setting_Format_on_Scatter_PlotGraph_Layer.2C_Set_Format_on_Scatter_Plot"><span class="tocnumber">6</span> <span class="toctext">散布図のフォーマットをセットする<span class="OIndex" style="display:none">Graph Layer, Set Format on Scatter Plot</span></span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Setting_Format_on_Grouped_Line_.2B_Symbol_PlotsGraph_Layer.2C_Set_Format_on_Grouping_Plot"><span class="tocnumber">7</span> <span class="toctext">グループ化した線＋シンボルのフォーマットを設定する<span class="OIndex" style="display:none">Graph Layer, Set Format on Grouping Plot</span></span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#Setting_Colormap_Settings"><span class="tocnumber">8</span> <span class="toctext">カラーマップ設定を設定する</span></a></li>
</ul>
</div>

<h2><a name="Adding_Data_MarkerGraph_Layer.2C_Add_Data_MarkerGraph_Layer.2C_Remove_Data_MarkerGraph_Layer.2C_Set_Data_Marker"></a><span class="mw-headline">データマーカーを追加する <span class="OIndex" style="display:none">Graph Layer, Add Data Marker</span><span class="OIndex" style="display:none">Graph Layer, Remove Data Marker</span><span class="OIndex" style="display:none">Graph Layer, Set Data Marker</span></span></h2>
<p>Origin Cは、データマーカを編集するのに次のメソッドをサポートします。
</p>
<ul><li> <b><a href="../../OriginC/OriginC/DataPlot-AddDataMarkers.html" title="OriginC:DataPlot-AddDataMarkers">DataPlot::AddDataMarkers</a></b>は、選択した部分範囲にデータプロットのデータマーカを追加します。 </li>
<li> <b><a href="../../OriginC/OriginC/DataPlot-SetDataMarkers.html" title="OriginC:DataPlot-SetDataMarkers">DataPlot::SetDataMarkers</a></b>は、現在のデータマーカの位置を変更します。 </li>
<li> <b><a href="../../OriginC/OriginC/DataPlot-GetDataMarkers.html" title="OriginC:DataPlot-GetDataMarkers">DataPlot::GetDataMarkers</a></b>は、すべての既存のデータプロットを取得します。</li>
<li> <b><a href="../../OriginC/OriginC/DataPlot-RemoveDataMarker.html" title="OriginC:DataPlot-RemoveDataMarker">DataPlot::RemoveDataMarker</a></b>は、指定したデータマーカを削除します。 </li></ul>
<p>次のコードは、アクティブグラフに2つのデータマーカを追加する方法を示しています。 
</p>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
DataPlot dp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;

<span style="color: #008000;">// データマーカのインデックス</span>
vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> vnBegin <span style="color: #000080;">=</span> <span style="color: #000000;">{</span><span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">9</span><span style="color: #000000;">}</span>;
vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> vnEnd <span style="color: #000080;">=</span> <span style="color: #000000;">{</span><span style="color: #0000dd;">4</span>, <span style="color: #0000dd;">14</span><span style="color: #000000;">}</span>;

<span style="color: #008000;">// 2つのデータマーカを追加</span>
<span style="color: #0000ff;">int</span> nRet <span style="color: #000080;">=</span> dp.<span style="color: #000000;">AddDataMarkers</span><span style="color: #000000;">(</span>vnBegin, vnEnd<span style="color: #000000;">)</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> nRet <span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
	out_str<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Add data marker successfully.&quot;</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span></pre>
<p>以下のコードは、現在のデータマーカの位置を変更します。
</p>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
DataPlot dp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;

<span style="color: #008000;">// データマーカのインデックス</span>
vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> vnBegin <span style="color: #000080;">=</span> <span style="color: #000000;">{</span><span style="color: #0000dd;">11</span>, <span style="color: #0000dd;">2</span><span style="color: #000000;">}</span>;
vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> vnEnd <span style="color: #000080;">=</span> <span style="color: #000000;">{</span><span style="color: #0000dd;">19</span>, <span style="color: #0000dd;">5</span><span style="color: #000000;">}</span>;
vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> vnIndices <span style="color: #000080;">=</span> <span style="color: #000000;">{</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">0</span><span style="color: #000000;">}</span>;

<span style="color: #008000;">// 2つのデータマーカを追加</span>
<span style="color: #0000ff;">int</span> nRet <span style="color: #000080;">=</span> dp.<span style="color: #000000;">SetDataMarkers</span><span style="color: #000000;">(</span>vnBegin, vnEnd, vnIndices<span style="color: #000000;">)</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> nRet <span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
	out_str<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Set data marker successfully.&quot;</span><span style="color: #000000;">)</span>;
	gl.<span style="color: #000000;">GetPage</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>.<span style="color: #000000;">Refresh</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span></pre>
<h2><a name="Setting_ColorGraph_Layer.2C_Set_Color_on_DataPlot"></a><span class="mw-headline">色を設定する<span class="OIndex" style="display:none">Graph Layer, Set Color on DataPlot</span></span></h2>
<p>次のサンプルコードは、データプロットの色をセットする方法を示します。
</p>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
DataPlot dp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;

<span style="color: #0000ff;">bool</span> bRepaint <span style="color: #000080;">=</span> <span style="color: #0000ff;">true</span>;
dp.<span style="color: #000000;">SetColor</span><span style="color: #000000;">(</span>SYSCOLOR_GREEN, bRepaint<span style="color: #000000;">)</span>;</pre>
<h2><a name="Getting_Format_TreeGraph_Layer.2C_Get_Format_on_DataPlot"></a><span class="mw-headline">フォーマットツリーの取得<span class="OIndex" style="display:none">Graph Layer, Get Format on DataPlot</span></span></h2>
<p><i>OriginObject::GetFormat</i> と <i>OriginObject::ApplyFormat</i> は、Originオブジェクトフォーマットを取得するのに使われます。  次のフォーマットの取得、セット、コピーのメカニズムは、OriginObjectの基底クラスから派生するクラスを持つすべてのOriginオブジェクトに対して使うことができます(<a href="../../OriginC/OCGuide/Class_Hierarchy.html" title="OCGuide:クラスの階層">クラスの階層</a>を参照)。  例えば、Originオブジェクトは、<i>DataPlot</i> クラス, <i>Worksheet </i>クラス, <i>WorksheetPage</i> クラス, <i>MatrixLayer</i> クラス, <i>MatrixPage</i> クラス, <i>GraphLayer</i> クラス,<i> GraphPage</i> クラスのオブジェクトにすることができます。
</p><p><i>DataPlot </i>クラスは、<i>DataObjectBase</i> クラスから派生され、<i>DataObjectBase</i> クラスは、<i>OriginObject</i> クラスがら派生されるので、<i>DataPlot::GetFormat</i> を呼び出して、フォーマットツリー構造を取得できます。 
</p><p>次のコードを使って、フォーマットツリー構造を見る2つの方法があります。 
</p>
<ul><li> 次のコードで、<i>GetFormat</i> の行にブレークポイントを設定し、1つのデータをアクティブにし、コードを実行し、F10を押し(ステップオーバー)、<i>GetFormat</i> 行を実行し、コードビルダのローカル変数ウィンドウで、<b>tr</b>変数のフォーマットツリーの詳細を見ます。(Alt+4を押し、ローカル変数ウィンドウを開いたり、閉じたりできます。) </li>
<li> 最後の行 <i>out_tree(tr); </i>を使って、フォーマットツリーを出力します。 </li></ul>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
DataPlot dp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">(</span><span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// アクティブデータプロットを取得</span>
 
<span style="color: #008000;">// 異なるプロットタイプ(例えば、折れ線、ボックスチャート...) は、</span>
<span style="color: #008000;">// フォーマットツリーの異なる構造を持ちます。</span>
Tree tr;
 
<span style="color: #008000;">// ツリー構造の詳細を表示するフォーマットツリーを取得</span>
tr <span style="color: #000080;">=</span> dp.<span style="color: #000000;">GetFormat</span><span style="color: #000000;">(</span>FPB_ALL, FOB_ALL, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>;

out_tree<span style="color: #000000;">(</span>tr<span style="color: #000000;">)</span>; <span style="color: #008000;">// フォーマットツリーを取得</span></pre>
<h2><a name="Setting_Format_on_Line_PlotGraph_Layer.2C_Set_Format_on_Line_Plot"></a><span class="mw-headline">折れ線グラフのフォーマットをセットする<span class="OIndex" style="display:none">Graph Layer, Set Format on Line Plot</span></span></h2>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
DataPlot dp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">(</span><span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>; <span style="color: #008000;">//アクティブデータプロットを取得</span>
  
<span style="color: #008000;">// 折れ線プロットのフォーマットをセット</span>
<span style="color: #008000;">// Note:フォーマットツリーの構造を取得するには前のセクションを参照</span>
Tree tr;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Line</span>.<span style="color: #000000;">Connect</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>; <span style="color: #008000;">// 2点のセグメントに対しては2</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Line</span>.<span style="color: #000000;">Color</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> RGB2OCOLOR<span style="color: #000000;">(</span>RGB<span style="color: #000000;">(</span><span style="color: #0000dd;">100</span>, <span style="color: #0000dd;">100</span>, <span style="color: #0000dd;">220</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Line</span>.<span style="color: #000000;">Width</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1.5</span>;
 
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> dp.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">(</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
    <span style="color: #0000ff;">bool</span> bRet <span style="color: #000080;">=</span> dp.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">(</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>; 
<span style="color: #000000;">}</span></pre>
<h2><a name="Copying_Format_from_One_Data_Plot_to_AnotherCopy_FormatOrigin_Object.2C_Copy_Format"></a><span class="mw-headline">あるデータプロットから別のプロットにフォーマットをコピーする<span class="OIndex" style="display:none">Copy Format</span><span class="OIndex" style="display:none">Origin Object, Copy Format</span></span></h2>
<h3><a name="Copying_Format_via_Theme_FileTheme_File"></a><span class="mw-headline">テーマファイルでフォーマットをコピーする<span class="OIndex" style="display:none">Theme File</span></span></h3>
<p>データプロットからテーマファイルにフォーマットツリーを取得し保存すると、テーマファイルをツリーにロードし、フォーマットツリーを別のデータプロットに適用できます。 
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Graph1からテーマファイルにプロット設定を保存</span>
GraphPage gpSource<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Graph1&quot;</span><span style="color: #000000;">)</span>;
GraphLayer glSource <span style="color: #000080;">=</span> gpSource.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;
DataPlot dpSource <span style="color: #000080;">=</span> glSource.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;

Tree tr;
tr <span style="color: #000080;">=</span> dpSource.<span style="color: #000000;">GetFormat</span><span style="color: #000000;">(</span>FPB_ALL, FOB_ALL, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>;
string strTheme <span style="color: #000080;">=</span> GetAppPath<span style="color: #000000;">(</span><span style="color: #0000ff;">false</span><span style="color: #000000;">)</span> <span style="color: #000040;">+</span> <span style="color: #ff00ff;">&quot;plotsettings.XML&quot;</span>;
tr.<span style="color: #000000;">Save</span><span style="color: #000000;">(</span>strTheme<span style="color: #000000;">)</span>;

<span style="color: #008000;">// テーマファイルからプロット設定をツリーにロードし、</span>
<span style="color: #008000;">// ツリーからデータプロットオブジェクトにフォーマットを適用</span>
GraphPage gpDest<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Graph2&quot;</span><span style="color: #000000;">)</span>;
GraphLayer glDest <span style="color: #000080;">=</span> gpDest.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;	
DataPlot dpDest <span style="color: #000080;">=</span> glDest.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;

Tree tr2;
tr2.<span style="color: #000000;">Load</span><span style="color: #000000;">(</span>strTheme<span style="color: #000000;">)</span>;
dpDest.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">(</span>tr2, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>;</pre>
<h3><a name="Copying_Format_via_Tree"></a><span class="mw-headline">ツリーでフォーマットをコピーする</span></h3>
<p>あるデータプロットからのプロット設定をツリーに取得すると、このツリーから別のプロットオブジェクトに設定を適用できます。 
</p>
<pre class="oc" style="font-family:monospace;">GraphPage gpSource<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Graph1&quot;</span><span style="color: #000000;">)</span>;
GraphLayer glSource <span style="color: #000080;">=</span> gpSource.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;
DataPlot dpSource <span style="color: #000080;">=</span> glSource.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;

GraphPage gpDest<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Graph2&quot;</span><span style="color: #000000;">)</span>;
GraphLayer glDest <span style="color: #000080;">=</span> gpDest.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;	
DataPlot dpDest <span style="color: #000080;">=</span> glDest.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;

<span style="color: #008000;">// 元のデータプロットからフォーマットを取得</span>
Tree tr;
tr <span style="color: #000080;">=</span> dpSource.<span style="color: #000000;">GetFormat</span><span style="color: #000000;">(</span>FPB_ALL, FOB_ALL, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>;

<span style="color: #008000;">// フォーマットを別のデータプロットに適用</span>
dpDest.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">(</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>;</pre>
<h2><a name="Setting_Format_on_Scatter_PlotGraph_Layer.2C_Set_Format_on_Scatter_Plot"></a><span class="mw-headline">散布図のフォーマットをセットする<span class="OIndex" style="display:none">Graph Layer, Set Format on Scatter Plot</span></span></h2>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
DataPlot dp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">(</span><span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// アクティブデータプロットを取得</span>

<span style="color: #008000;">// シンボルフォーマットをセット</span>
Tree tr;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Symbol</span>.<span style="color: #000000;">Size</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">12</span>; <span style="color: #008000;">// シンボルのサイズ</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Symbol</span>.<span style="color: #000000;">Shape</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; <span style="color: #008000;">// 円</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Symbol</span>.<span style="color: #000000;">Interior</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; <span style="color: #008000;">// 内部</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Symbol</span>.<span style="color: #000000;">EdgeColor</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> SYSCOLOR_RED;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Symbol</span>.<span style="color: #000000;">FillColor</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> SYSCOLOR_BLUE;

<span style="color: #008000;">// 垂直ドロップラインの表示</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">DropLines</span>.<span style="color: #000000;">Vertical</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">DropLines</span>.<span style="color: #000000;">VerticalColor</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> SYSCOLOR_LTGRAY;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">DropLines</span>.<span style="color: #000000;">VerticalStyle</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">DropLines</span>.<span style="color: #000000;">VerticalWidth</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1.5</span>;

<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> dp.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">(</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
    <span style="color: #0000ff;">bool</span> bRet <span style="color: #000080;">=</span> dp.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">(</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>; 
<span style="color: #000000;">}</span></pre>
<h2><a name="Setting_Format_on_Grouped_Line_.2B_Symbol_PlotsGraph_Layer.2C_Set_Format_on_Grouping_Plot"></a><span class="mw-headline">グループ化した線＋シンボルのフォーマットを設定する<span class="OIndex" style="display:none">Graph Layer, Set Format on Grouping Plot</span></span></h2>
<p>Origin Cを使って、グループ化したプロットに対するフォーマットをセットします。  同じ操作を、作図の詳細ダイアログで、グループタブで行うことができます。フォーマットには線の色、シンボルタイプ、シンボルの内部、線種が含まれます。
</p><p>次のサンプルは、線＋シンボルグラフのフォーマットをセットする方法を示しています。このグループには4つのデータプロットがあるものとします。
</p>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; 
GroupPlot gplot <span style="color: #000080;">=</span> gl.<span style="color: #000000;">Groups</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// レイヤ内の最初のグループ</span>

<span style="color: #008000;">// Nesterはグループ内でネストするオブジェクトタイプの配列</span>
<span style="color: #008000;">// グループ内で周期的にネストする4種類の設定</span>
vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> vNester<span style="color: #000000;">(</span><span style="color: #0000dd;">3</span><span style="color: #000000;">)</span>; 
vNester<span style="color: #000000;">[</span><span style="color: #0000dd;">0</span><span style="color: #000000;">]</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;  <span style="color: #008000;">// グループ内で周期的に線の色を変更</span>
vNester<span style="color: #000000;">[</span><span style="color: #0000dd;">1</span><span style="color: #000000;">]</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;  <span style="color: #008000;">// グループ内で周期的にシンボルを変更</span>
vNester<span style="color: #000000;">[</span><span style="color: #0000dd;">2</span><span style="color: #000000;">]</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">8</span>;  <span style="color: #008000;">// グループ内で周期的にシンボル内部を変更</span>
gplot.<span style="color: #000000;">Increment</span>.<span style="color: #000000;">Nester</span>.<span style="color: #000000;">nVals</span> <span style="color: #000080;">=</span> vNester;  <span style="color: #008000;">// グループプロットのNester</span>

<span style="color: #008000;">// フォーマット設定を4つのプロットへのvectorに配置</span>
vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> vLineColor <span style="color: #000080;">=</span> <span style="color: #000000;">{</span>SYSCOLOR_BLUE, SYSCOLOR_OLIVE, SYSCOLOR_RED, 
		SYSCOLOR_CYAN<span style="color: #000000;">}</span>;
vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> vSymbolShape <span style="color: #000080;">=</span> <span style="color: #000000;">{</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">3</span>, <span style="color: #0000dd;">5</span>, <span style="color: #0000dd;">8</span><span style="color: #000000;">}</span>;
vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> vSymbolInterior <span style="color: #000080;">=</span> <span style="color: #000000;">{</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">2</span>, <span style="color: #0000dd;">5</span>, <span style="color: #0000dd;">0</span><span style="color: #000000;">}</span>;

Tree tr;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Increment</span>.<span style="color: #000000;">LineColor</span>.<span style="color: #000000;">nVals</span> <span style="color: #000080;">=</span> vLineColor;  <span style="color: #008000;">// 線の色をテーマツリーにセット</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Increment</span>.<span style="color: #000000;">Shape</span>.<span style="color: #000000;">nVals</span> <span style="color: #000080;">=</span> vSymbolShape;  <span style="color: #008000;">// シンボルの形状をテーマツリーにセット</span>
<span style="color: #008000;">// シンボルの内部をテーマツリーにセット</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Increment</span>.<span style="color: #000000;">SymbolInterior</span>.<span style="color: #000000;">nVals</span> <span style="color: #000080;">=</span> vSymbolInterior;  

<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> gplot.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">(</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>    
<span style="color: #000000;">{</span>
	<span style="color: #0000ff;">bool</span> bb <span style="color: #000080;">=</span> gplot.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">(</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>;    <span style="color: #008000;">// テーマツリーを適用</span>
<span style="color: #000000;">}</span></pre>
<h2><a name="Setting_Colormap_Settings"></a><span class="mw-headline">カラーマップ設定を設定する</span></h2>
<p><b>DataPlot</b>クラスは、カラーマップの設定をするための2つのオーバーロードメソッド持ちます。 
</p>
<ul><li> DataPlot::SetColormap( const vector&lt;double&gt; &amp; vz, BOOL bLogScale = FALSE ) は、Z値レベルとスケールタイプ（対数かそうでないか）の設定だけに使用されます。<b>vz</b> 引数内の値はZ値です。  </li>
<li> DataPlot::SetColormap( TreeNode&amp; trColormap ) は、すべてのカラーマップ設定に使用されます。たとえば、Z値、色、線のフォーマット、テキストラベルのフォーマット等の設定をします。 </li></ul>
<p>次のサンプルでは、等高線図のZカラーマップの設定方法を示します。
</p>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
DataPlot dp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;

<span style="color: #008000;">// Zレベルの元のカラーマップを取得</span>
vector vZs;
<span style="color: #0000ff;">BOOL</span> bLogScale <span style="color: #000080;">=</span> <span style="color: #0000ff;">FALSE</span>;
<span style="color: #0000ff;">BOOL</span> bRet <span style="color: #000080;">=</span> dp.<span style="color: #000000;">GetColormap</span><span style="color: #000000;">(</span>vZs, bLogScale<span style="color: #000000;">)</span>;
<span style="color: #0000ff;">int</span> nLevels <span style="color: #000080;">=</span> vZs.<span style="color: #000000;">GetSize</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;    

<span style="color: #008000;">// Zレベルのvectorを減少させ、DataPlotに戻してセット</span>
<span style="color: #0000ff;">double</span> min, max;
vZs.<span style="color: #000000;">GetMinMax</span><span style="color: #000000;">(</span>min, max<span style="color: #000000;">)</span>;
<span style="color: #0000ff;">double</span> dChangeVal <span style="color: #000080;">=</span> <span style="color: #000000;">fabs</span><span style="color: #000000;">(</span>max <span style="color: #000040;">-</span> min<span style="color: #000000;">)</span> <span style="color: #000040;">*</span> <span style="color: #0000dd;">0.2</span>;
<span style="color: #0000ff;">bool</span> bIncrease <span style="color: #000080;">=</span> <span style="color: #0000ff;">true</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #000040;">!</span>bIncrease <span style="color: #000000;">)</span>
	dChangeVal <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span> <span style="color: #000040;">-</span> dChangeVal;

min <span style="color: #000080;">=</span> min <span style="color: #000040;">-</span> dChangeVal;
max <span style="color: #000080;">=</span> max <span style="color: #000040;">-</span> dChangeVal;
<span style="color: #0000ff;">double</span> inc <span style="color: #000080;">=</span> <span style="color: #000000;">(</span>max <span style="color: #000040;">-</span> min<span style="color: #000000;">)</span> <span style="color: #000040;">/</span> nLevels;    
vZs.<span style="color: #000000;">Data</span><span style="color: #000000;">(</span>min, max, inc<span style="color: #000000;">)</span>;

dp.<span style="color: #000000;">SetColormap</span><span style="color: #000000;">(</span>vZs<span style="color: #000000;">)</span>;</pre>
<p>次のサンプルでは、カラーマップZ値レベルをLog10スケールタイプでセットする方法を示しています。
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">bool</span> plot_matrix<span style="color: #000000;">(</span>LPCSTR lpsczMatPage, LPCSTR lpcszGraphTemplate <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;contour&quot;</span>
		, <span style="color: #0000ff;">int</span> nPlotID <span style="color: #000080;">=</span> IDM_PLOT_CONTOUR<span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
	<span style="color: #008000;">// 特定行列ページから行列オブジェクトを取得</span>
	MatrixPage matPage <span style="color: #000080;">=</span> Project.<span style="color: #000000;">MatrixPages</span><span style="color: #000000;">(</span>lpsczMatPage<span style="color: #000000;">)</span>;
	<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #000040;">!</span>matPage <span style="color: #000000;">)</span>
	<span style="color: #000000;">{</span>
		out_str<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Invalid matrix page&quot;</span><span style="color: #000000;">)</span>;
		<span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span>;
	<span style="color: #000000;">}</span>
	<span style="color: #008000;">// 行列ページのアクティブシートを取得</span>
	MatrixLayer ml <span style="color: #000080;">=</span> matPage.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>; 
	<span style="color: #008000;">// 行列シート内のアクティブ行列オブジェクトを取得</span>
	MatrixObject mobj <span style="color: #000080;">=</span> ml.<span style="color: #000000;">MatrixObjects</span><span style="color: #000000;">(</span><span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>; 	
	
	<span style="color: #008000;">// テンプレートで非表示のグラフページを作成し、プロットを追加</span>
	<span style="color: #008000;">// 非表示として、描画しない           </span>
	GraphPage gp;
	gp.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span>lpcszGraphTemplate, CREATE_HIDDEN<span style="color: #000000;">)</span>;
	GraphLayer glay <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
	
	<span style="color: #0000ff;">int</span> nPlot <span style="color: #000080;">=</span> glay.<span style="color: #000000;">AddPlot</span><span style="color: #000000;">(</span>mobj, nPlotID<span style="color: #000000;">)</span>;
	<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span>nPlot <span style="color: #000080;">&lt;</span> <span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>
	<span style="color: #000000;">{</span>
		out_str<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;fail to add data plot to graph&quot;</span><span style="color: #000000;">)</span>;
	    <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span>; 
	<span style="color: #000000;">}</span>
	glay.<span style="color: #000000;">Rescale</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// XY軸を再スケール</span>
	     
	
	<span style="color: #008000;">// Zレベルベクトルを構築</span>
	<span style="color: #0000ff;">int</span> nNewLevels <span style="color: #000080;">=</span> <span style="color: #0000dd;">4</span>;    
	<span style="color: #0000ff;">double</span> min <span style="color: #000080;">=</span> <span style="color: #0000dd;">0.1</span>, max <span style="color: #000080;">=</span> <span style="color: #0000dd;">100000</span>.;
	<span style="color: #0000ff;">double</span> step <span style="color: #000080;">=</span> <span style="color: #000000;">(</span><span style="color: #000000;">log10</span><span style="color: #000000;">(</span>max<span style="color: #000000;">)</span> <span style="color: #000040;">-</span> <span style="color: #000000;">log10</span><span style="color: #000000;">(</span>min<span style="color: #000000;">)</span><span style="color: #000000;">)</span> <span style="color: #000040;">/</span> <span style="color: #000000;">(</span>nNewLevels <span style="color: #000040;">-</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>;
	
	vector vLevels;
	vLevels.<span style="color: #000000;">SetSize</span><span style="color: #000000;">(</span>nNewLevels<span style="color: #000000;">)</span>;
	vLevels.<span style="color: #000000;">Data</span><span style="color: #000000;">(</span><span style="color: #000000;">log10</span><span style="color: #000000;">(</span>min<span style="color: #000000;">)</span>, <span style="color: #000000;">log10</span><span style="color: #000000;">(</span>max<span style="color: #000000;">)</span>, step<span style="color: #000000;">)</span>;   
	vLevels <span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span><span style="color: #000040;">^</span>vLevels;	
	
	<span style="color: #008000;">// パーセントでZ値をセット。実際のZ値ではないことに注意</span>
	<span style="color: #008000;">// 最初の値は0、最後の値は &lt; 100 である必要がある</span>
	vLevels <span style="color: #000080;">=</span> <span style="color: #0000dd;">100</span><span style="color: #000040;">*</span><span style="color: #000000;">(</span>vLevels <span style="color: #000040;">-</span> min<span style="color: #000000;">)</span><span style="color: #000040;">/</span><span style="color: #000000;">(</span>max <span style="color: #000040;">-</span> min<span style="color: #000000;">)</span>; 
	
	Tree tr;
	tr.<span style="color: #000000;">ColorMap</span>.<span style="color: #000000;">Details</span>.<span style="color: #000000;">Levels</span>.<span style="color: #000000;">dVals</span> <span style="color: #000080;">=</span> vLevels;
	tr.<span style="color: #000000;">ColorMap</span>.<span style="color: #000000;">ScaleType</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; <span style="color: #008000;">// 1 は log10</span>
	tr.<span style="color: #000000;">ColorMap</span>.<span style="color: #000000;">Min</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> min;
	tr.<span style="color: #000000;">ColorMap</span>.<span style="color: #000000;">Max</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> max;
	
	DataPlot dp <span style="color: #000080;">=</span> glay.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">(</span>nPlot<span style="color: #000000;">)</span>;               
	<span style="color: #0000ff;">bool</span> bRet <span style="color: #000080;">=</span> dp.<span style="color: #000000;">SetColormap</span><span style="color: #000000;">(</span>tr<span style="color: #000000;">)</span>; 
	<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #000040;">!</span>bRet <span style="color: #000000;">)</span>
	<span style="color: #000000;">{</span>
		out_str<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;fail to set colormap&quot;</span><span style="color: #000000;">)</span>;
		<span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span>;
	<span style="color: #000000;">}</span>
	
	gp.<span style="color: #000000;">Label</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Plot created using template: &quot;</span> <span style="color: #000040;">+</span> <span style="color: #000000;">(</span>string<span style="color: #000000;">)</span>lpcszGraphTemplate;
	gp.<span style="color: #000000;">TitleShow</span> <span style="color: #000080;">=</span> WIN_TITLE_SHOW_BOTH;
	gp.<span style="color: #000000;">SetShow</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// 用意できたら表示</span>
	
	<span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span>;
<span style="color: #000000;">}</span></pre>
<p>上述の<i>plot_matrix</i> 関数を<i>coutour</i> テンプレートとともに呼び出し、<i>IDM_PLOT_CONTOUR</i> プロットid で等高線図を作成してカラーマップをセットします。
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">void</span> plot_contour_ex<span style="color: #000000;">(</span>LPCSTR lpcszMatPage<span style="color: #000000;">)</span>
<span style="color: #000000;">{</span> 
    plot_matrix<span style="color: #000000;">(</span>lpcszMatPage, <span style="color: #ff00ff;">&quot;contour&quot;</span>, IDM_PLOT_CONTOUR<span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span></pre>
<p>上述の<i> plot_matrix</i> 関数を<i> image </i>テンプレートと共に呼び出し、<i>IDM_PLOT_MATRIX_IMAGE</i> プロット id でイメージグラフを作成してカラーマップをセットします。
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">void</span> plot_image_ex<span style="color: #000000;">(</span>LPCSTR lpcszMatPage<span style="color: #000000;">)</span>
<span style="color: #000000;">{</span> 
    plot_matrix<span style="color: #000000;">(</span>lpcszMatPage, <span style="color: #ff00ff;">&quot;image&quot;</span>, IDM_PLOT_MATRIX_IMAGE<span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span></pre>
<p>次のサンプルでは、塗りつぶし色を削除し、等高線図の線の色、スタイル、幅、テキストラベルをセットします。
</p>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
DataPlot dp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;
 
Tree tr;
dp.<span style="color: #000000;">GetColormap</span><span style="color: #000000;">(</span>tr<span style="color: #000000;">)</span>;
 
<span style="color: #008000;">// 塗りつぶし色削除</span>
tr.<span style="color: #000000;">ColorFillControl</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
 
<span style="color: #008000;">// 線の色を設定</span>
vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> vnLineColors;
vnLineColors <span style="color: #000080;">=</span> tr.<span style="color: #000000;">Details</span>.<span style="color: #000000;">LineColors</span>.<span style="color: #000000;">nVals</span>;
<span style="color: #0000ff;">int</span> nLevels <span style="color: #000080;">=</span> vnLineColors.<span style="color: #000000;">GetSize</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
vnLineColors.<span style="color: #000000;">Data</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>, nLevels, <span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>;
tr.<span style="color: #000000;">Details</span>.<span style="color: #000000;">LineColors</span>.<span style="color: #000000;">nVals</span> <span style="color: #000080;">=</span> vnLineColors;
 
<span style="color: #008000;">// 全ての線のスタイルを破線にセット</span>
vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> vnLineStyles<span style="color: #000000;">(</span>vnLineColors.<span style="color: #000000;">GetSize</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
vnLineStyles <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
tr.<span style="color: #000000;">Details</span>.<span style="color: #000000;">LineStyles</span>.<span style="color: #000000;">nVals</span> <span style="color: #000080;">=</span> vnLineStyles;
 
<span style="color: #008000;">// 全ての線の幅をセット</span>
vector vdLineWidths<span style="color: #000000;">(</span>vnLineColors.<span style="color: #000000;">GetSize</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
vdLineWidths <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;
tr.<span style="color: #000000;">Details</span>.<span style="color: #000000;">LineWidths</span>.<span style="color: #000000;">dVals</span> <span style="color: #000080;">=</span> vdLineWidths;    
 
<span style="color: #008000;">// ラベルの表示/非表示。最初の2つ以外を表示</span>
vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> vnLabels<span style="color: #000000;">(</span>vnLineColors.<span style="color: #000000;">GetSize</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
vnLabels <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;    
vnLabels<span style="color: #000000;">[</span><span style="color: #0000dd;">0</span><span style="color: #000000;">]</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
vnLabels<span style="color: #000000;">[</span><span style="color: #0000dd;">1</span><span style="color: #000000;">]</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
tr.<span style="color: #000000;">Details</span>.<span style="color: #000000;">Labels</span>.<span style="color: #000000;">nVals</span> <span style="color: #000080;">=</span> vnLabels;    
 
<span style="color: #008000;">// グラフの背景の設定</span>
dp.<span style="color: #000000;">SetColormap</span><span style="color: #000000;">(</span>tr<span style="color: #000000;">)</span>;</pre>
<p>このサンプルでは、等高線グラフのテキストラベルのフォーマット(例：色、サイズ、太字、斜体)をセットする方法を示します。
</p>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
DataPlot dp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;

<span style="color: #008000;">// カラーマッププロットの関連オブジェクトのすべてのプロパティを取得</span>
Tree tr;
tr <span style="color: #000080;">=</span> dp.<span style="color: #000000;">GetFormat</span><span style="color: #000000;">(</span>FPB_ALL, FOB_ALL, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>;

<span style="color: #008000;">// すべてのラベルを表示</span>
vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> vnLabels;
vnLabels <span style="color: #000080;">=</span> tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">ColorMap</span>.<span style="color: #000000;">Details</span>.<span style="color: #000000;">Labels</span>.<span style="color: #000000;">nVals</span>;
vnLabels <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;<span style="color: #008000;">// 0 は非表示、1 は表示</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">ColorMap</span>.<span style="color: #000000;">Details</span>.<span style="color: #000000;">Labels</span>.<span style="color: #000000;">nVals</span> <span style="color: #000080;">=</span> vnLabels;

<span style="color: #008000;">// ラベルに対して数値フォーマットをセット</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">NumericFormats</span>.<span style="color: #000000;">Format</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; <span style="color: #008000;">// 十進法</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">NumericFormats</span>.<span style="color: #000000;">DigitsControl</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">NumericFormats</span>.<span style="color: #000000;">SignificantDigits</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>;<span style="color: #008000;">//小数点以下桁数</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">NumericFormats</span>.<span style="color: #000000;">Prefix</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;_&quot;</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">NumericFormats</span>.<span style="color: #000000;">Suffix</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Label&quot;</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">NumericFormats</span>.<span style="color: #000000;">MinArea</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>; <span style="color: #008000;">// ラベル Criteria - Min Area(%)</span>

<span style="color: #008000;">// ラベルに対してテキストフォーマットをセット</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Labels</span>.<span style="color: #000000;">Color</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> SYSCOLOR_BLUE;
<span style="color: #008000;">//FontFaceIndex_to_DWORD は、GUIインデックスからDWORD実数値に変換するのに使用</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Labels</span>.<span style="color: #000000;">Face</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> FontFaceIndex_to_DWORD<span style="color: #000000;">(</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span>;<span style="color: #008000;">// GUI内に3番目のフォントを選択</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Labels</span>.<span style="color: #000000;">Size</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">20</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Labels</span>.<span style="color: #000000;">WhiteOut</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Labels</span>.<span style="color: #000000;">Bold</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Labels</span>.<span style="color: #000000;">Italic</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Labels</span>.<span style="color: #000000;">Underline</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;

<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> dp.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">(</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
	dp.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">(</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>;</pre>







    