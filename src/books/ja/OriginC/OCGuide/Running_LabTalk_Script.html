<h1 class="firstheading">LabTalk スクリプトを実行する</h1><p><span class="OIndex" style="display:none">LabTalk Variable, LabTalk Script, Execution in Origin C</span>
</p><p>Origin Cのグローバル変数 <b><a href="../../OriginC/OriginC/LT_execute_(global_function).html" title="OriginC:LT execute (global function)">LT_execute</a></b><span class="OIndex" style="display:none">LT_execute</span>は、文字列に保存されているLabTalkスクリプトを実行することができます。
Format文字列メソッドは、Origin C変数をLabTalkスクリプトに渡すのに役立ちます。
</p>
<pre class="oc" style="font-family:monospace;">string strScript;
string strBook <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Book1&quot;</span>;
<span style="color: #0000ff;">int</span> iColStart <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>, iColEnd <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>;
strScript.<span style="color: #000000;">Format</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;win -a&nbsp;%s;plotxy&nbsp;%u:%u;&quot;</span>, strBook, iColStart, iColEnd<span style="color: #000000;">)</span>;
LT_execute<span style="color: #000000;">(</span>strScript<span style="color: #000000;">)</span>;</pre>
<p>次のサンプルは、グローバル関数LT_executeではなく、Layerクラスの<i>LT_execute</i> メソッドを呼びます。  グローバル関数<i>LT_execute</i> を呼ぶと、スクリプトが実行され、スクリプトコードでレイヤが指定されていなければ、アクティブレイヤに対して操作されます。  Layerクラスの<i>LT_execute</i> メソッドを呼ぶと、スクリプトが実行され、アクティブレイヤではなく、レイヤインスタンスに対して実行されます。 
</p>
<pre class="oc" style="font-family:monospace;">WorksheetPage wksPg<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Book1&quot;</span><span style="color: #000000;">)</span>;
Worksheet wks <span style="color: #000080;">=</span> wksPg.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;

WorksheetPage wksPgActive;
wksPgActive.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Origin&quot;</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// このページがアクティブ</span>

LT_execute<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;wks.colWidth=16&quot;</span><span style="color: #000000;">)</span>;    <span style="color: #008000;">// アクティブレイヤの列幅を設定</span>
wks.<span style="color: #000000;">LT_execute</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;wks.colWidth=8&quot;</span><span style="color: #000000;">)</span>; <span style="color: #008000;">//Book1の列幅を設定</span></pre>
<p>また、<i><a href="../../OriginC/OriginC/OriginObject-SetProp.html" title="OriginC:OriginObject-SetProp">OriginObject::SetProp</a></i> 関数を使って、LabTalkオブジェクトプロパティを変更することもできます。詳細は、<a href="../../OriginC/OriginC/OriginObject-SetProp.html#See_Also" title="OriginC:OriginObject-SetProp">このセクション</a>を参照してください。
</p>
<pre class="oc" style="font-family:monospace;">wks.<span style="color: #000000;">SetProp</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;colWidth&quot;</span>, <span style="color: #0000dd;">8</span><span style="color: #000000;">)</span>;</pre>







    