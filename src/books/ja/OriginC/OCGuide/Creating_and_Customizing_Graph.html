<h1 class="firstheading">グラフの作成と編集</h1><div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Creating_Graph_WindowGraph_Page.2C_CreateTemplate"><span class="tocnumber">1</span> <span class="toctext">グラフウィンドウの作成<span class="OIndex" style="display:none">Graph Page, Create</span><span class="OIndex" style="display:none">Template</span></span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Getting_Graph_Page_FormatGraph_Page.2C_Get_Format"><span class="tocnumber">2</span> <span class="toctext">グラフページのフォーマットを取得<span class="OIndex" style="display:none">Graph Page, Get Format</span></span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Setting_Graph_Page_Format"><span class="tocnumber">3</span> <span class="toctext">グラフページフォーマットを設定</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Getting_Graph_Layer_FormatGraph_Layer.2C_Get_Format"><span class="tocnumber">4</span> <span class="toctext">グラフレイヤのフォーマットを取得<span class="OIndex" style="display:none">Graph Layer, Get Format</span></span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Setting_Graph_Layer_Format"><span class="tocnumber">5</span> <span class="toctext">グラフレイヤフォーマットを設定</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Show_Additional_LinesGraph_Layer.2C_Show_Additional_Lines"><span class="tocnumber">6</span> <span class="toctext">追加の線を表示<span class="OIndex" style="display:none">Graph Layer, Show Additional Lines</span></span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Show_Grid_LinesGraph_Layer.2C_Grid_Lines"><span class="tocnumber">7</span> <span class="toctext">グリッド線を表示<span class="OIndex" style="display:none">Graph Layer, Grid Lines</span></span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Setting_Axis_ScaleGraph_Layer.2C_Scale_Settings"><span class="tocnumber">8</span> <span class="toctext">軸スケールの設定 <span class="OIndex" style="display:none">Graph Layer, Scale Settings</span></span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Getting_Axis_FormatGraph_Layer.2C_Axis_Properties"><span class="tocnumber">9</span> <span class="toctext">軸フォーマットを取得<span class="OIndex" style="display:none">Graph Layer, Axis Properties</span></span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#Setting_Axis_LabelGraph_Layer.2C_Axis_Label_Properties"><span class="tocnumber">10</span> <span class="toctext">軸ラベルを設定<span class="OIndex" style="display:none">Graph Layer, Axis Label Properties</span></span></a></li>
<li class="toclevel-1 tocsection-11"><a href="#Show_Top_AxisGraph_Layer.2C_Show.2FHide_Axis"><span class="tocnumber">11</span> <span class="toctext">上X軸を表示<span class="OIndex" style="display:none">Graph Layer, Show/Hide Axis</span></span></a></li>
<li class="toclevel-1 tocsection-12"><a href="#Customizing_Axis_TicksGraph_Layer.2C_Axis_Ticks_Properties"><span class="tocnumber">12</span> <span class="toctext">軸目盛を編集<span class="OIndex" style="display:none">Graph Layer, Axis Ticks Properties</span></span></a></li>
<li class="toclevel-1 tocsection-13"><a href="#Customizing_Tick_LabelsGraph_Layer.2C_Axis_Tick_Label_Properties"><span class="tocnumber">13</span> <span class="toctext">軸目盛ラベルを編集<span class="OIndex" style="display:none">Graph Layer, Axis Tick Label Properties</span></span></a></li>
<li class="toclevel-1 tocsection-14"><a href="#Change_Scale_Factor"><span class="tocnumber">14</span> <span class="toctext">倍率の変更</span></a></li>
</ul>
</div>

<h2><a name="Creating_Graph_WindowGraph_Page.2C_CreateTemplate"></a><span class="mw-headline">グラフウィンドウの作成<span class="OIndex" style="display:none">Graph Page, Create</span><span class="OIndex" style="display:none">Template</span></span></h2>
<p><b>Create</b>メソッドは、新しいグラフの作成に使用されます。 
</p>
<pre class="oc" style="font-family:monospace;">GraphPage gp;
gp.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;3D&quot;</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// 3Dテンプレートを使ってグラフを作成</span></pre>
<h2><a name="Getting_Graph_Page_FormatGraph_Page.2C_Get_Format"></a><span class="mw-headline">グラフページのフォーマットを取得<span class="OIndex" style="display:none">Graph Page, Get Format</span></span></h2>
<pre class="oc" style="font-family:monospace;">GraphPage gp<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Graph1&quot;</span><span style="color: #000000;">)</span>;

Tree tr;
tr <span style="color: #000080;">=</span> gp.<span style="color: #000000;">GetFormat</span><span style="color: #000000;">(</span>FPB_ALL, FOB_ALL, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>;
out_tree<span style="color: #000000;">(</span>tr<span style="color: #000000;">)</span>;</pre>
<h2><a name="Setting_Graph_Page_Format"></a><span class="mw-headline">グラフページフォーマットを設定</span></h2>
<p>次のサンプルコードは、2色のグラデーションでページの背景色をセットする方法を示しています。 
</p>
<pre class="oc" style="font-family:monospace;">Tree tr;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Background</span>.<span style="color: #000000;">BaseColor</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> SYSCOLOR_RED;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Background</span>.<span style="color: #000000;">GradientControl</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Background</span>.<span style="color: #000000;">GradientColor</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> SYSCOLOR_BLUE;

GraphPage gp<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Graph1&quot;</span><span style="color: #000000;">)</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> gp.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">(</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
	gp.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">(</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>;</pre>
<h2><a name="Getting_Graph_Layer_FormatGraph_Layer.2C_Get_Format"></a><span class="mw-headline">グラフレイヤのフォーマットを取得<span class="OIndex" style="display:none">Graph Layer, Get Format</span></span></h2>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;

Tree tr;
tr <span style="color: #000080;">=</span> gl.<span style="color: #000000;">GetFormat</span><span style="color: #000000;">(</span>FPB_ALL, FOB_ALL, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>;
out_tree<span style="color: #000000;">(</span>tr<span style="color: #000000;">)</span>;</pre>
<h2><a name="Setting_Graph_Layer_Format"></a><span class="mw-headline">グラフレイヤフォーマットを設定</span></h2>
<p>以下のサンプルコードは、グラフレイヤオブジェクトの背景を黒線フォーマットにセットする方法を示します。
</p>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;

Tree tr;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Background</span>.<span style="color: #000000;">Border</span>.<span style="color: #000000;">Color</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> SYSCOLOR_BLACK;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Background</span>.<span style="color: #000000;">Border</span>.<span style="color: #000000;">Width</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Background</span>.<span style="color: #000000;">Fill</span>.<span style="color: #000000;">Color</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> SYSCOLOR_WHITE;

<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> gl.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">(</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
	gl.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">(</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>;</pre>
<h2><a name="Show_Additional_LinesGraph_Layer.2C_Show_Additional_Lines"></a><span class="mw-headline">追加の線を表示<span class="OIndex" style="display:none">Graph Layer, Show Additional Lines</span></span></h2>
<p>このサンプルは、追加の線、Y=0/X=0での線、反対の線を表示する方法を示しています。
</p>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
Axis axesX <span style="color: #000080;">=</span> gl.<span style="color: #000000;">XAxis</span>;	

axesX.<span style="color: #000000;">Additional</span>.<span style="color: #000000;">ZeroLine</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; <span style="color: #008000;">// Y = 0の線を表示</span>
axesX.<span style="color: #000000;">Additional</span>.<span style="color: #000000;">OppositeLine</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; <span style="color: #008000;">// X軸の反対の線を表示</span></pre>
<h2><a name="Show_Grid_LinesGraph_Layer.2C_Grid_Lines"></a><span class="mw-headline">グリッド線を表示<span class="OIndex" style="display:none">Graph Layer, Grid Lines</span></span></h2>
<p>このサンプルは、グリッド線の表示方法および色付けの方法を示しています。 
</p><p>色の値は、Originの内部のカラーパレットまたはRGB値へのインデックスにすることができます。  色の値についての詳細は、<a href="../../OriginC/OCGuide/Data_Types_and_Variables.html" title="OCGuide:Data Types and Variables">データ型と変数</a>の<a href="../../OriginC/OCGuide/Data_Types_and_Variables.html#Color" title="OCGuide:Data Types and Variables">色</a>をご覧ください。 
</p>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
Axis axisY <span style="color: #000080;">=</span> gl.<span style="color: #000000;">YAxis</span>;
Tree tr;	

<span style="color: #008000;">// 主グリッド表示</span>
TreeNode trProperty <span style="color: #000080;">=</span> tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Grids</span>.<span style="color: #000000;">HorizontalMajorGrids</span>.<span style="color: #000000;">AddNode</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Show&quot;</span><span style="color: #000000;">)</span>;
trProperty.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Grids</span>.<span style="color: #000000;">HorizontalMajorGrids</span>.<span style="color: #000000;">Color</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> RGB2OCOLOR<span style="color: #000000;">(</span>RGB<span style="color: #000000;">(</span><span style="color: #0000dd;">100</span>, <span style="color: #0000dd;">100</span>, <span style="color: #0000dd;">220</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Grids</span>.<span style="color: #000000;">HorizontalMajorGrids</span>.<span style="color: #000000;">Style</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; <span style="color: #008000;">// 実線</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Grids</span>.<span style="color: #000000;">HorizontalMajorGrids</span>.<span style="color: #000000;">Width</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;

<span style="color: #008000;">// 副グリッド表示</span>
trProperty <span style="color: #000080;">=</span> tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Grids</span>.<span style="color: #000000;">HorizontalMinorGrids</span>.<span style="color: #000000;">AddNode</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Show&quot;</span><span style="color: #000000;">)</span>;
trProperty.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Grids</span>.<span style="color: #000000;">HorizontalMinorGrids</span>.<span style="color: #000000;">Color</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> SYSCOLOR_GREEN; <span style="color: #008000;">// 緑</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Grids</span>.<span style="color: #000000;">HorizontalMinorGrids</span>.<span style="color: #000000;">Style</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>; <span style="color: #008000;">// ドット</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Grids</span>.<span style="color: #000000;">HorizontalMinorGrids</span>.<span style="color: #000000;">Width</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0.3</span>;

<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> axisY.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">(</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
	<span style="color: #0000ff;">bool</span> bRet <span style="color: #000080;">=</span> axisY.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">(</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span></pre>
<h2><a name="Setting_Axis_ScaleGraph_Layer.2C_Scale_Settings"></a><span class="mw-headline">軸スケールの設定 <span class="OIndex" style="display:none">Graph Layer, Scale Settings</span></span></h2>
<p>このサンプルは、スケールのパラメータ、増分、スケールタイプなどをセットする方法を示しています。 
</p>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
Axis axesX <span style="color: #000080;">=</span> gl.<span style="color: #000000;">XAxis</span>;  
 
axesX.<span style="color: #000000;">Scale</span>.<span style="color: #000000;">From</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
axesX.<span style="color: #000000;">Scale</span>.<span style="color: #000000;">To</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
axesX.<span style="color: #000000;">Scale</span>.<span style="color: #000000;">IncrementBy</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; <span style="color: #008000;">// 0=値で増加; 1=主目盛の数</span>
axesX.<span style="color: #000000;">Scale</span>.<span style="color: #000000;">Value</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0.2</span>; <span style="color: #008000;">// 増分</span>
axesX.<span style="color: #000000;">Scale</span>.<span style="color: #000000;">Type</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;<span style="color: #008000;">// 線形</span>
axesX.<span style="color: #000000;">Scale</span>.<span style="color: #000000;">Rescale</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; <span style="color: #008000;">// 再スケールタイプ</span>
axesX.<span style="color: #000000;">Scale</span>.<span style="color: #000000;">RescaleMargin</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">8</span>; <span style="color: #008000;">// 8パーセント</span></pre>
<p>次のサンプルは、Y 軸の主目盛数をセットする方法を示しています。
</p>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
Axis axesY <span style="color: #000080;">=</span> gl.<span style="color: #000000;">YAxis</span>; 

axesY.<span style="color: #000000;">Scale</span>.<span style="color: #000000;">IncrementBy</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; <span style="color: #008000;">// 0: 値で増加; 1: 主目盛の数</span>
axesY.<span style="color: #000000;">Scale</span>.<span style="color: #000000;">MajorTicksCount</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>;</pre>
<h2><a name="Getting_Axis_FormatGraph_Layer.2C_Axis_Properties"></a><span class="mw-headline">軸フォーマットを取得<span class="OIndex" style="display:none">Graph Layer, Axis Properties</span></span></h2>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
Axis axisX <span style="color: #000080;">=</span> gl.<span style="color: #000000;">XAxis</span>;

<span style="color: #008000;">// 軸フォーマット設定をツリーに取得</span>
Tree tr;
tr <span style="color: #000080;">=</span> axisX.<span style="color: #000000;">GetFormat</span><span style="color: #000000;">(</span>FPB_ALL, FOB_ALL, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>;
out_tree<span style="color: #000000;">(</span>tr<span style="color: #000000;">)</span>;</pre>
<h2><a name="Setting_Axis_LabelGraph_Layer.2C_Axis_Label_Properties"></a><span class="mw-headline">軸ラベルを設定<span class="OIndex" style="display:none">Graph Layer, Axis Label Properties</span></span></h2>
<p>軸ラベルは、通常のテキストオブジェクトであり、GraphObjectクラスを使ってOrigin Cでアクセスできます。  デフォルトグラフでは、X軸はXBという名前で、Y軸はYLという名前になっています。  次のコードは、XおよびY軸ラベルにアクセスする方法を示し、デフォルトグラフがアクティブページとします。
</p>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;    <span style="color: #008000;">// アクティブグラフレイヤ取得</span>

GraphObject grXL <span style="color: #000080;">=</span> gl.<span style="color: #000000;">GraphObjects</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;XB&quot;</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// X軸ラベルを取得</span>
GraphObject grYL <span style="color: #000080;">=</span> gl.<span style="color: #000000;">GraphObjects</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;YL&quot;</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// Y軸ラベルを取得</span></pre>
<p>これで、軸ラベルにアクセスし、値を変更できます。  次のコードは、X軸ラベルを直接セットし、Y軸ラベルをLabTalk文字列変数にリンクすることで間接的にセットします。  LabTalk変数へのリンクは、ラベルのプログラミング制御オプション&quot;変数へリンク&quot;を有効にする必要があります。  このオプションはデフォルトで有効になっています。 
</p>
<pre class="oc" style="font-family:monospace;">grXL.<span style="color: #000000;">Text</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;My New X Asis Label&quot;</span>;

LT_set_str<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;abc$&quot;</span>, <span style="color: #ff00ff;">&quot;My String Variable&quot;</span><span style="color: #000000;">)</span>;
grYL.<span style="color: #000000;">Text</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;%(abc$)&quot;</span>;</pre>
<p>ラベルが変わったことを確認するには、グラフページをリフレッシュする必要があります。  GraphLayerオブジェクトを使って、次のコードでページをリフレッシュできます。 
</p>
<pre class="oc" style="font-family:monospace;">gl.<span style="color: #000000;">GetPage</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>.<span style="color: #000000;">Refresh</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</pre>
<h2><a name="Show_Top_AxisGraph_Layer.2C_Show.2FHide_Axis"></a><span class="mw-headline">上X軸を表示<span class="OIndex" style="display:none">Graph Layer, Show/Hide Axis</span></span></h2>
<p>このサンプルは、上X軸を表示する方法を示します。
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// 軸と刻みを表示</span>
Tree tr;	
TreeNode trProperty <span style="color: #000080;">=</span> tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Ticks</span>.<span style="color: #000000;">TopTicks</span>.<span style="color: #000000;">AddNode</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Show&quot;</span><span style="color: #000000;">)</span>;
trProperty.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;

<span style="color: #008000;">// 軸ラベルを表示</span>
trProperty <span style="color: #000080;">=</span> tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Labels</span>.<span style="color: #000000;">TopLabels</span>.<span style="color: #000000;">AddNode</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Show&quot;</span><span style="color: #000000;">)</span>;
trProperty.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;

GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
Axis axesX <span style="color: #000080;">=</span> gl.<span style="color: #000000;">XAxis</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> axesX.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">(</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
	<span style="color: #0000ff;">bool</span> bRet <span style="color: #000080;">=</span> axesX.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">(</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span></pre>
<h2><a name="Customizing_Axis_TicksGraph_Layer.2C_Axis_Ticks_Properties"></a><span class="mw-headline">軸目盛を編集<span class="OIndex" style="display:none">Graph Layer, Axis Ticks Properties</span></span></h2>
<p>このサンプルは、軸ダイアログ-&gt;軸の主要設定(タイトル・形態)でフォーマットをセットする方法を示しています。
</p>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
Axis axesX <span style="color: #000080;">=</span> gl.<span style="color: #000000;">XAxis</span>;	

Tree tr;
<span style="color: #008000;">// データプロットの色を従って、刻みの色を自動にセット</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Ticks</span>.<span style="color: #000000;">BottomTicks</span>.<span style="color: #000000;">Color</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> INDEX_COLOR_AUTOMATIC;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Ticks</span>.<span style="color: #000000;">BottomTicks</span>.<span style="color: #000000;">Width</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Ticks</span>.<span style="color: #000000;">BottomTicks</span>.<span style="color: #000000;">Major</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; <span style="color: #008000;">// 0:刻みを両側表示</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Ticks</span>.<span style="color: #000000;">BottomTicks</span>.<span style="color: #000000;">Minor</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>; <span style="color: #008000;">// 2:外側</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Ticks</span>.<span style="color: #000000;">BottomTicks</span>.<span style="color: #000000;">Style</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; <span style="color: #008000;">// 実線</span>

<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> axesX.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">(</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
    <span style="color: #0000ff;">bool</span> bRet <span style="color: #000080;">=</span> axesX.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">(</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>;</pre>
<h2><a name="Customizing_Tick_LabelsGraph_Layer.2C_Axis_Tick_Label_Properties"></a><span class="mw-headline">軸目盛ラベルを編集<span class="OIndex" style="display:none">Graph Layer, Axis Tick Label Properties</span></span></h2>
<p>このサンプルは、指定した位置で軸ラベルをセットする方法を示します。軸ダイアログの軸目盛のカスタム化タブで同じ操作を行うことができます。 
</p>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
Axis axesX <span style="color: #000080;">=</span> gl.<span style="color: #000000;">XAxis</span>;

Tree tr;
<span style="color: #008000;">// スケール値として軸の開始と終了を表示</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Labels</span>.<span style="color: #000000;">BottomLabels</span>.<span style="color: #000000;">Custom</span>.<span style="color: #000000;">Begin</span>.<span style="color: #000000;">Type</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;	
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Labels</span>.<span style="color: #000000;">BottomLabels</span>.<span style="color: #000000;">Custom</span>.<span style="color: #000000;">End</span>.<span style="color: #000000;">Type</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;

<span style="color: #008000;">// 特別な値とテキストを特定のポイントにセット</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Labels</span>.<span style="color: #000000;">BottomLabels</span>.<span style="color: #000000;">Custom</span>.<span style="color: #000000;">Special</span>.<span style="color: #000000;">Type</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Labels</span>.<span style="color: #000000;">BottomLabels</span>.<span style="color: #000000;">Custom</span>.<span style="color: #000000;">Special</span>.<span style="color: #000000;">Label</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Mid&quot;</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Labels</span>.<span style="color: #000000;">BottomLabels</span>.<span style="color: #000000;">Custom</span>.<span style="color: #000000;">Special</span>.<span style="color: #000000;">Value</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">12</span>;

<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> axesX.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">(</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
	<span style="color: #0000ff;">bool</span> bRet <span style="color: #000080;">=</span> axesX.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">(</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span></pre>
<h2><a name="Change_Scale_Factor"></a><span class="mw-headline">倍率の変更</span></h2>
<p>このサンプルは、倍率の変更によってページサイズが変更されたときに、フォントサイズと線の太さをスケールする方法を示しています。
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">void</span> change_graph_and_font_size<span style="color: #000000;">(</span><span style="color: #0000ff;">double</span> dNewWidth <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
	GraphPage gp <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>.<span style="color: #000000;">GetPage</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
	Tree tr1;tr1 <span style="color: #000080;">=</span> gp.<span style="color: #000000;">GetFormat</span><span style="color: #000000;">(</span>FPB_ALL, FOB_ALL, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>;
	<span style="color: #0000ff;">double</span> dOldWidth <span style="color: #000080;">=</span> tr1.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimension</span>.<span style="color: #000000;">Width</span>.<span style="color: #000000;">dVal</span>;
	<span style="color: #0000ff;">double</span> factor <span style="color: #000080;">=</span> dOldWidth<span style="color: #000040;">/</span>tr1.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimension</span>.<span style="color: #000000;">Height</span>.<span style="color: #000000;">dVal</span>;
	Tree tr2;
	tr2.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimension</span>.<span style="color: #000000;">Width</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> dNewWidth;
	tr2.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimension</span>.<span style="color: #000000;">Height</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> dNewWidth <span style="color: #000040;">/</span> factor;
	<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> gp.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">(</span>tr2.<span style="color: #000000;">Root</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>
	<span style="color: #000000;">{</span>
		gp.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">(</span>tr2, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>;
		string strScript;
		<span style="color: #008000;">//page -afu&nbsp;: 倍率変更</span>
		<span style="color: #008000;">//win -z0&nbsp;: ページをウィンドウサイズに合わせる</span>
		strScript.<span style="color: #000000;">Format</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;page -AFU&nbsp;%f;win -z0&quot;</span>, <span style="color: #000040;">-</span>dNewWidth<span style="color: #000040;">/</span>dOldWidth<span style="color: #000000;">)</span>;
		gp.<span style="color: #000000;">LT_execute</span><span style="color: #000000;">(</span>strScript<span style="color: #000000;">)</span>;
	<span style="color: #000000;">}</span>
<span style="color: #000000;">}</span></pre>
<table class="note">

<tr>
<td><b>Note:</b>
<p>この場合、tr1は現在の寸法を取得するためにのみ使用され、新しい値は適用されません。
</p>
<dl><dt>これは、tr1にもグラフオブジェクトの位置設定があり、グラフの寸法を変更する場合は古くなっているためです。</dt>
<dt>正しい方法は、寸法の設定のみを適用することであり、グラフオブジェクトの位置は自動的に更新されます。</dt></dl>
</td></tr></table>







    