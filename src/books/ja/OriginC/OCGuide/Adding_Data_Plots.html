<h1 class="firstheading">データプロットを追加する</h1><p><br />
<span class="OIndex" style="display:none">Plotting, from Worksheet</span><b>プロット</b> または <b>データプロット</b> は、グラフレイヤ内のデータ表示です。  各グラフレイヤには、1つ以上のプロットが含まれます。
</p><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#2D_Plot_.28XY.2C_YErr.2C_Bar.2FColumn.29"><span class="tocnumber">1</span> <span class="toctext">2D グラフ (XY, Yエラー, 縦棒/横棒) </span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Plot_XY_Scatter"><span class="tocnumber">1.1</span> <span class="toctext">XY散布図をプロット</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Attach_YErr_Plot"><span class="tocnumber">1.2</span> <span class="toctext">Yエラープロットを付ける</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Bar.2FColumn_Plot"><span class="tocnumber">1.3</span> <span class="toctext">縦棒/横棒グラフ</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="#3D_Plot"><span class="tocnumber">2</span> <span class="toctext">3Dグラフ</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Contour_PlotGraph_Layer.2C_Add_Contour_PlotDataPlot.2C_Contour"><span class="tocnumber">3</span> <span class="toctext">等高線図<span class="OIndex" style="display:none">Graph Layer, Add Contour Plot</span><span class="OIndex" style="display:none">DataPlot, Contour</span></span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#Plot_XYZ_Contour"><span class="tocnumber">3.1</span> <span class="toctext">XYZ 等高線図をプロット</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Plot_Color_Fill_Contour"><span class="tocnumber">3.2</span> <span class="toctext">色付き等高線をプロット</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-9"><a href="#Image_PlotGraph_Layer.2C_Add_Matrix_Image_PlotDataPlot.2C_Image_Type"><span class="tocnumber">4</span> <span class="toctext">イメージプロット<span class="OIndex" style="display:none">Graph Layer, Add Matrix Image Plot</span><span class="OIndex" style="display:none">DataPlot, Image Type</span></span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#Multi-AxesGraph_Layer.2C_Double-Y_Axes"><span class="tocnumber">5</span> <span class="toctext">複数軸<span class="OIndex" style="display:none">Graph Layer, Double-Y Axes</span></span></a></li>
<li class="toclevel-1 tocsection-11"><a href="#Multi-Panels_.28Multi-Layer.2C_with_Shared_X-Axis.29Plotting_in_Multiple_Graph_LayersGraph_Layer.2C_Set_Ticks_and_TickLabels_as_Auto_ColorGraph_Page.2C_Arrange_Layers"><span class="tocnumber">6</span> <span class="toctext">複数区分グラフ (X軸を共有した複数レイヤ) <span class="OIndex" style="display:none">Plotting in Multiple Graph Layers</span><span class="OIndex" style="display:none">Graph Layer, Set Ticks and TickLabels as Auto Color</span><span class="OIndex" style="display:none">Graph Page, Arrange Layers</span></span></a></li>
</ul>
</div>

<h2><a name="2D_Plot_.28XY.2C_YErr.2C_Bar.2FColumn.29"></a><span class="mw-headline">2D グラフ (XY, Yエラー, 縦棒/横棒) </span></h2>
<h3><a name="Plot_XY_Scatter"></a><span class="mw-headline">XY散布図をプロット</span></h3>
<p><span class="OIndex" style="display:none">Graph Layer, Add XY Data Plot</span><span class="OIndex" style="display:none">Graph Layer, Rescale</span>次のコードは、アクティブワークシートからXYYErrデータ範囲を構築する方法を示し、新しく作成したグラフでデータ範囲をプロットします。 
</p>
<pre class="oc" style="font-family:monospace;">Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;	

<span style="color: #008000;">// 範囲名は、X, Y, Z, ED(YErr)にする</span>
DataRange dr;
dr.<span style="color: #000000;">Add</span><span style="color: #000000;">(</span>wks, <span style="color: #0000dd;">0</span>, <span style="color: #ff00ff;">&quot;X&quot;</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// 第1列はXデータ</span>
dr.<span style="color: #000000;">Add</span><span style="color: #000000;">(</span>wks, <span style="color: #0000dd;">1</span>, <span style="color: #ff00ff;">&quot;Y&quot;</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// 第2列はYデータ</span>
dr.<span style="color: #000000;">Add</span><span style="color: #000000;">(</span>wks, <span style="color: #0000dd;">2</span>, <span style="color: #ff00ff;">&quot;ED&quot;</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// 第1列はYエラーデータ(任意)</span>

<span style="color: #008000;">// グラフウィンドウを作成</span>
GraphPage gp;
gp.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Origin&quot;</span><span style="color: #000000;">)</span>;
GraphLayer gl <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// アクティブレイヤを取得</span>

<span style="color: #008000;">// XYデータ範囲を散布図としてプロット</span>
<span style="color: #008000;">// IDM_PLOT_SCATTER はプロットタイプIDで、他のタイプのIDはoPlotIDs.h ファイルを確認</span>
<span style="color: #0000ff;">int</span> nPlotIndex <span style="color: #000080;">=</span> gl.<span style="color: #000000;">AddPlot</span><span style="color: #000000;">(</span>dr, IDM_PLOT_SCATTER<span style="color: #000000;">)</span>;
<span style="color: #008000;">// プロットインデックス(オフセットは0)を返す、エラーは-1を返す</span>
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> nPlotIndex <span style="color: #000080;">&gt;=</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">)</span> 
<span style="color: #000000;">{</span>
	gl.<span style="color: #000000;">Rescale</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// 軸を再スケールしすべてのデータポイントを表示</span>
<span style="color: #000000;">}</span></pre>
<h3><a name="Attach_YErr_Plot"></a><span class="mw-headline">Yエラープロットを付ける</span></h3>
<p><span class="OIndex" style="display:none">Graph Layer, Add YErr Data Plot</span><span class="OIndex" style="display:none">DataPlot, Error Bar</span><span class="OIndex" style="display:none">Graph Layer, Get Active Data Plot</span>YErrデータを既存のXYデータプロットに付加します。 
</p>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
DataPlot dp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">(</span><span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>;	<span style="color: #008000;">// アクティブデータプロットを取得</span>

<span style="color: #008000;">// Yエラー列を取得</span>
WorksheetPage wksPage<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Book1&quot;</span><span style="color: #000000;">)</span>;
Worksheet wks <span style="color: #000080;">=</span> wksPage.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
Column	colErrBar<span style="color: #000000;">(</span>wks, <span style="color: #0000dd;">2</span><span style="color: #000000;">)</span>;	 

<span style="color: #008000;">// アクティブデータプロットにYエラー列をプロット</span>
Curve	crv<span style="color: #000000;">(</span>dp<span style="color: #000000;">)</span>;
<span style="color: #0000ff;">int</span>		nErrPlotIndex <span style="color: #000080;">=</span> gl.<span style="color: #000000;">AddErrBar</span><span style="color: #000000;">(</span>crv, colErrBar<span style="color: #000000;">)</span>;
out_int<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;nErrPlotIndex = &quot;</span>, nErrPlotIndex<span style="color: #000000;">)</span>;</pre>
<h3><a name="Bar.2FColumn_Plot"></a><span class="mw-headline">縦棒/横棒グラフ</span></h3>
<p><span class="OIndex" style="display:none">Graph Layer, Add Bar/Column Plot</span><span class="OIndex" style="display:none">DataPlot, Bar/Column</span>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// 実行前にアクティブウィンドウがワークシートであることを確認</span>
Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
DataRange dr;
dr.<span style="color: #000000;">Add</span><span style="color: #000000;">(</span>wks, <span style="color: #0000dd;">1</span>, <span style="color: #ff00ff;">&quot;Y&quot;</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// 1列を持つデータ範囲を構築</span>

GraphPage gp;
gp.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;BAR&quot;</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// 指定したテンプレートでグラフを作成</span>
GraphLayer gl <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// アクティブグラフレイヤを取得</span>

<span style="color: #0000ff;">int</span> index <span style="color: #000080;">=</span> gl.<span style="color: #000000;">AddPlot</span><span style="color: #000000;">(</span>dr, IDM_PLOT_BAR<span style="color: #000000;">)</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> index <span style="color: #000080;">&gt;=</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
	out_str<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Plot bar&quot;</span><span style="color: #000000;">)</span>;
	gl.<span style="color: #000000;">Rescale</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span></pre>
<h2><a name="3D_Plot"></a><span class="mw-headline">3Dグラフ</span></h2>
<p><span class="OIndex" style="display:none">Graph Layer, Add 3D Surface Plot</span><span class="OIndex" style="display:none">Matrixbook, Open OGM File in Window</span><span class="OIndex" style="display:none">Plotting, from Matrix</span>
行列からグラフウィンドウに3D曲面図をプロットします。 
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// 行列データを用意		</span>
MatrixLayer ml;
string strFile <span style="color: #000080;">=</span> GetAppPath<span style="color: #000000;">(</span><span style="color: #0000ff;">true</span><span style="color: #000000;">)</span> <span style="color: #000040;">+</span> <span style="color: #ff00ff;">&quot;Samples<span style="color: #666666; font-weight: bold;">\\</span>Matrix Conversion and Gridding<span style="color: #666666; font-weight: bold;">\\</span>
2D Gaussian.ogm&quot;</span>;
ml.<span style="color: #000000;">Open</span><span style="color: #000000;">(</span>strFile<span style="color: #000000;">)</span>;
MatrixObject mo <span style="color: #000080;">=</span> ml.<span style="color: #000000;">MatrixObjects</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;

<span style="color: #008000;">// テンプレートでグラフページを作成</span>
GraphPage gp;
gp.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;CMAP&quot;</span><span style="color: #000000;">)</span>; 
GraphLayer gl <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;

<span style="color: #008000;">// 3D 曲面図をプロット</span>
<span style="color: #0000ff;">int</span> nPlotIndex <span style="color: #000080;">=</span> gl.<span style="color: #000000;">AddPlot</span><span style="color: #000000;">(</span>mo, IDM_PLOT_SURFACE_COLORMAP<span style="color: #000000;">)</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> nPlotIndex<span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
	gl.<span style="color: #000000;">Rescale</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
	<span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;3D Surface plotted successfully<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span></pre>
<h2><a name="Contour_PlotGraph_Layer.2C_Add_Contour_PlotDataPlot.2C_Contour"></a><span class="mw-headline">等高線図<span class="OIndex" style="display:none">Graph Layer, Add Contour Plot</span><span class="OIndex" style="display:none">DataPlot, Contour</span></span></h2>
<h3><a name="Plot_XYZ_Contour"></a><span class="mw-headline">XYZ 等高線図をプロット</span></h3>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// 実行前に、アクティブワークシートウィンドウにXYZデータがあることを確認</span>
<span style="color: #008000;">// または、\Samples\Matrix Conversion and Gridding\</span>
<span style="color: #008000;">// XYZ Random Gaussian.dat をワークシートにインポート</span>
Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
DataRange dr;
dr.<span style="color: #000000;">Add</span><span style="color: #000000;">(</span>wks, <span style="color: #0000dd;">0</span>, <span style="color: #ff00ff;">&quot;X&quot;</span><span style="color: #000000;">)</span>;
dr.<span style="color: #000000;">Add</span><span style="color: #000000;">(</span>wks, <span style="color: #0000dd;">1</span>, <span style="color: #ff00ff;">&quot;Y&quot;</span><span style="color: #000000;">)</span>;
dr.<span style="color: #000000;">Add</span><span style="color: #000000;">(</span>wks, <span style="color: #0000dd;">2</span>, <span style="color: #ff00ff;">&quot;Z&quot;</span><span style="color: #000000;">)</span>;

<span style="color: #008000;">// テンプレートでグラフページを作成</span>
GraphPage gp;	
gp.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;TriContour&quot;</span><span style="color: #000000;">)</span>;	
GraphLayer gl <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;

<span style="color: #008000;">// タイプIDでXYZ等高線をプロット</span>
<span style="color: #0000ff;">int</span> nPlot <span style="color: #000080;">=</span> gl.<span style="color: #000000;">AddPlot</span><span style="color: #000000;">(</span>dr, IDM_PLOT_TRI_CONTOUR<span style="color: #000000;">)</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> nPlot <span style="color: #000080;">&gt;=</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
	gl.<span style="color: #000000;">Rescale</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
	<span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;XYZ contour plotted successfully<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span></pre>
<h3><a name="Plot_Color_Fill_Contour"></a><span class="mw-headline">色付き等高線をプロット</span></h3>
<pre class="oc" style="font-family:monospace;">MatrixLayer ml <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
MatrixObject mo <span style="color: #000080;">=</span> ml.<span style="color: #000000;">MatrixObjects</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;

<span style="color: #008000;">// テンプレートでグラフウィンドウを作成</span>
GraphPage gp;
gp.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;contour&quot;</span><span style="color: #000000;">)</span>; 
GraphLayer gl <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;

<span style="color: #0000ff;">int</span> nPlot <span style="color: #000080;">=</span> gl.<span style="color: #000000;">AddPlot</span><span style="color: #000000;">(</span>mo, IDM_PLOT_CONTOUR<span style="color: #000000;">)</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> nPlot <span style="color: #000080;">&gt;=</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
	gl.<span style="color: #000000;">Rescale</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span></pre>
<h2><a name="Image_PlotGraph_Layer.2C_Add_Matrix_Image_PlotDataPlot.2C_Image_Type"></a><span class="mw-headline">イメージプロット<span class="OIndex" style="display:none">Graph Layer, Add Matrix Image Plot</span><span class="OIndex" style="display:none">DataPlot, Image Type</span></span></h2>
<pre class="oc" style="font-family:monospace;">MatrixLayer ml <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
MatrixObject mo <span style="color: #000080;">=</span> ml.<span style="color: #000000;">MatrixObjects</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;

<span style="color: #008000;">// テンプレートでグラフウィンドウを作成</span>
GraphPage gp;
gp.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;image&quot;</span><span style="color: #000000;">)</span>; 
GraphLayer gl <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;

<span style="color: #0000ff;">int</span> nPlot <span style="color: #000080;">=</span> gl.<span style="color: #000000;">AddPlot</span><span style="color: #000000;">(</span>mo, IDM_PLOT_MATRIX_IMAGE<span style="color: #000000;">)</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> nPlot <span style="color: #000080;">&gt;=</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
	gl.<span style="color: #000000;">Rescale</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span></pre>
<h2><a name="Multi-AxesGraph_Layer.2C_Double-Y_Axes"></a><span class="mw-headline">複数軸<span class="OIndex" style="display:none">Graph Layer, Double-Y Axes</span></span></h2>
<p>次のサンプルコードは、1つのグラフレイヤ内の4つの軸－左、下、右、上の表示/非表示をセットし、フォーマットをセットする方法を示します。 
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>..\Originlab\graph_utils.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span> <span style="color: #008000;">// AXIS_* で必要</span>
GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;

<span style="color: #008000;">// 全ての軸とラベルを表示。0 または 1, 1 は表示。</span>
vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> vnAxes<span style="color: #000000;">(</span><span style="color: #0000dd;">4</span><span style="color: #000000;">)</span>, vnLabels<span style="color: #000000;">(</span><span style="color: #0000dd;">4</span><span style="color: #000000;">)</span>, vnTitles<span style="color: #000000;">(</span><span style="color: #0000dd;">4</span><span style="color: #000000;">)</span>;
vnAxes<span style="color: #000000;">[</span>AXIS_BOTTOM<span style="color: #000000;">]</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
vnAxes<span style="color: #000000;">[</span>AXIS_LEFT<span style="color: #000000;">]</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
vnAxes<span style="color: #000000;">[</span>AXIS_TOP<span style="color: #000000;">]</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
vnAxes<span style="color: #000000;">[</span>AXIS_RIGHT<span style="color: #000000;">]</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;	
vnLabels <span style="color: #000080;">=</span> vnAxes;	

<span style="color: #008000;">// 左と下の軸の軸タイトルを表示。0 または 1, 1 は表示。</span>
vnTitles<span style="color: #000000;">[</span>AXIS_BOTTOM<span style="color: #000000;">]</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
vnTitles<span style="color: #000000;">[</span>AXIS_LEFT<span style="color: #000000;">]</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
vnTitles<span style="color: #000000;">[</span>AXIS_TOP<span style="color: #000000;">]</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
vnTitles<span style="color: #000000;">[</span>AXIS_RIGHT<span style="color: #000000;">]</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;	

<span style="color: #008000;">// すべての軸の主刻みと副刻みを内側にセット</span>
<span style="color: #008000;">// 他のオプションについてはgraph_utils.hのTICK_*項目を参照</span>
vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> vnMajorTicks<span style="color: #000000;">(</span><span style="color: #0000dd;">4</span><span style="color: #000000;">)</span>, vnMinorTicks<span style="color: #000000;">(</span><span style="color: #0000dd;">4</span><span style="color: #000000;">)</span>;
vnMajorTicks<span style="color: #000000;">[</span>AXIS_BOTTOM<span style="color: #000000;">]</span> <span style="color: #000080;">=</span> TICK_IN;
vnMajorTicks<span style="color: #000000;">[</span>AXIS_LEFT<span style="color: #000000;">]</span> <span style="color: #000080;">=</span> TICK_IN;
vnMajorTicks<span style="color: #000000;">[</span>AXIS_TOP<span style="color: #000000;">]</span> <span style="color: #000080;">=</span> TICK_IN;
vnMajorTicks<span style="color: #000000;">[</span>AXIS_RIGHT<span style="color: #000000;">]</span> <span style="color: #000080;">=</span> TICK_IN;		
vnMinorTicks <span style="color: #000080;">=</span> vnMajorTicks;

gl_smart_show_object<span style="color: #000000;">(</span>gl, vnAxes, vnLabels, vnTitles, vnMajorTicks, vnMinorTicks<span style="color: #000000;">)</span>;</pre>
<h2><a name="Multi-Panels_.28Multi-Layer.2C_with_Shared_X-Axis.29Plotting_in_Multiple_Graph_LayersGraph_Layer.2C_Set_Ticks_and_TickLabels_as_Auto_ColorGraph_Page.2C_Arrange_Layers"></a><span class="mw-headline">複数区分グラフ (X軸を共有した複数レイヤ) <span class="OIndex" style="display:none">Plotting in Multiple Graph Layers</span><span class="OIndex" style="display:none">Graph Layer, Set Ticks and TickLabels as Auto Color</span><span class="OIndex" style="display:none">Graph Page, Arrange Layers</span></span></h2>
<p>次のサンプルは、1つのグラフページに複数のグラフレイヤを構築し、すべてのレイヤのX軸を共有し、XYデータセットをワークシートデータから各グラフレイヤにプロットする方法を示します。 
</p><p>次のコードをコンパイルする前に、現在のワークスペースにgraph_utils.cをビルドするために、次のコマンドを実行する必要があります。
</p>
<pre class="lt" style="font-family:monospace;">run.<span style="color: #000080;">LoadOC</span><span style="color: #000000;">(</span>Originlab\graph_utils.<span style="color: #000080;">c</span>, <span style="color: #0000dd;">16</span><span style="color: #000000;">)</span>;</pre>
<p>次のOrigin Cコードをコンパイルします。実行する前に、1つのX列と少なくとも2つのY列を持つBook1というワークブックがあることを確認します。 
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>..\Originlab\graph_utils.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span> <span style="color: #008000;">//page_add_layer 関数に対して必要</span>
<span style="color: #008000;">// Book1からデータ範囲を構築</span>
WorksheetPage wksPage<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Book1&quot;</span><span style="color: #000000;">)</span>;
Worksheet wks <span style="color: #000080;">=</span> wksPage.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// Book1の最初のワークシートを取得</span>
DataRange dr;
dr.<span style="color: #000000;">Add</span><span style="color: #000000;">(</span>wks, <span style="color: #0000dd;">0</span>, <span style="color: #ff00ff;">&quot;X&quot;</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// Xデータを第1列</span>
dr.<span style="color: #000000;">Add</span><span style="color: #000000;">(</span>wks, <span style="color: #0000dd;">1</span>, <span style="color: #ff00ff;">&quot;Y&quot;</span>, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// 最後のＹデータを第2列</span>

<span style="color: #008000;">// Yの数を取得</span>
DWORD dwRules <span style="color: #000080;">=</span> DRR_GET_DEPENDENT <span style="color: #000040;">|</span> DRR_NO_FACTORS;
<span style="color: #0000ff;">int</span> nNumYs <span style="color: #000080;">=</span> dr.<span style="color: #000000;">GetNumData</span><span style="color: #000000;">(</span>dwRules<span style="color: #000000;">)</span>;	

<span style="color: #008000;">// 右軸を持つレイヤを追加し、最初のレイヤにリンク</span>
GraphPage gp;
gp.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Origin&quot;</span><span style="color: #000000;">)</span>;
<span style="color: #0000ff;">while</span> <span style="color: #000000;">(</span> gp.<span style="color: #000000;">Layers</span>.<span style="color: #000000;">Count</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000080;">&lt;</span> nNumYs <span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
	page_add_layer<span style="color: #000000;">(</span>gp, <span style="color: #0000ff;">false</span>, <span style="color: #0000ff;">false</span>, <span style="color: #0000ff;">false</span>, <span style="color: #0000ff;">true</span>, 
		ADD_LAYER_INIT_SIZE_POS_MOVE_OFFSET, <span style="color: #0000ff;">false</span>, <span style="color: #0000dd;">0</span>, LINK_STRAIGHT<span style="color: #000000;">)</span>; 
<span style="color: #000000;">}</span>

<span style="color: #008000;">// ループして各XYデータからグラフレイヤにプロットを追加</span>
foreach<span style="color: #000000;">(</span>GraphLayer gl in gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
	<span style="color: #0000ff;">int</span> nLayerIndex <span style="color: #000080;">=</span> gl.<span style="color: #000000;">GetIndex</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
	
	<span style="color: #008000;">// drから部分XY範囲を取得</span>
	DataRange drOne;
	dr.<span style="color: #000000;">GetSubRange</span><span style="color: #000000;">(</span>drOne, dwRules, nLayerIndex<span style="color: #000000;">)</span>;		
	
	<span style="color: #008000;">// 1つのXY範囲をグラフレイヤにプロット</span>
	<span style="color: #0000ff;">int</span> nPlot <span style="color: #000080;">=</span> gl.<span style="color: #000000;">AddPlot</span><span style="color: #000000;">(</span>drOne, IDM_PLOT_LINE<span style="color: #000000;">)</span>;
	<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> nPlot <span style="color: #000080;">&gt;=</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">)</span>
	<span style="color: #000000;">{</span>
		DataPlot dp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">(</span>nPlot<span style="color: #000000;">)</span>;
		dp.<span style="color: #000000;">SetColor</span><span style="color: #000000;">(</span>nLayerIndex<span style="color: #000000;">)</span>; <span style="color: #008000;">//データプロットを異なる色にセット</span>

		<span style="color: #008000;">// 右Y軸の軸刻みと軸ラベルの色を自動にセット</span>
		gl.<span style="color: #000000;">YAxis</span>.<span style="color: #000000;">AxisObjects</span><span style="color: #000000;">(</span>AXISOBJPOS_AXIS_SECOND<span style="color: #000000;">)</span>.<span style="color: #000000;">RightTicks</span>.<span style="color: #000000;">Color</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> 
		gl.<span style="color: #000000;">YAxis</span>.<span style="color: #000000;">AxisObjects</span><span style="color: #000000;">(</span>AXISOBJPOS_LABEL_SECOND<span style="color: #000000;">)</span>.<span style="color: #000000;">RightLabels</span>.<span style="color: #000000;">Color</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> 
		INDEX_COLOR_AUTOMATIC;
				
		gl.<span style="color: #000000;">Rescale</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
	<span style="color: #000000;">}</span>		
<span style="color: #000000;">}</span></pre>







    