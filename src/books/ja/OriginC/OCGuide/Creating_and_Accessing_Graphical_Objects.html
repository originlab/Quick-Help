<h1 class="firstheading">グラフィックオブジェクトの作成とアクセス</h1><div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Creating_Graphical_ObjectGraph_Object.2C_Create"><span class="tocnumber">1</span> <span class="toctext">グラフィックオブジェクトの作成<span class="OIndex" style="display:none">Graph Object, Create</span></span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Setting_PropertiesGraph_Object.2C_General_Properties"><span class="tocnumber">2</span> <span class="toctext">プロパティ設定<span class="OIndex" style="display:none">Graph Object, General Properties</span></span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Setting_Position_and_SizeGraph_Object.2C_ResizeGraph_Object.2C_Position"><span class="tocnumber">3</span> <span class="toctext">位置とサイズを設定<span class="OIndex" style="display:none">Graph Object, Resize</span><span class="OIndex" style="display:none">Graph Object, Position</span></span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Updating_Attach_PropertyGraph_Object.2C_Attach_Property"><span class="tocnumber">4</span> <span class="toctext">接続先プロパティを更新<span class="OIndex" style="display:none">Graph Object, General Properties</span></span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Getting_and_Setting_Disable_PropertyGraph_Object.2C_Disable_Moving_and_Selection"><span class="tocnumber">5</span> <span class="toctext">無効なプロパティの取得と設定<span class="OIndex" style="display:none">Graph Object, Disable Moving and Selection</span></span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Programming_ControlGraph_Object.2C_Programming_Control"><span class="tocnumber">6</span> <span class="toctext">プログラム制御<span class="OIndex" style="display:none">Graph Object, Programming Control</span></span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Updating_LegendLegend_UpdateGraph_Layer.2C_Legend"><span class="tocnumber">7</span> <span class="toctext">凡例の更新<span class="OIndex" style="display:none">Legend Update</span><span class="OIndex" style="display:none">Graph Layer, Legend</span></span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Adding_Table_Object_on_GraphGraph_Layer.2C_Add_Worksheet_Table"><span class="tocnumber">8</span> <span class="toctext">グラフに表オブジェクトを追加<span class="OIndex" style="display:none">Graph Layer, Add Worksheet Table</span></span></a></li>
</ul>
</div>

<h2><a name="Creating_Graphical_ObjectGraph_Object.2C_Create"></a><span class="mw-headline">グラフィックオブジェクトの作成<span class="OIndex" style="display:none">Graph Object, Create</span></span></h2>
<p>テキストや四角形、線といったグラフィックオブジェクトを追加します。
</p><p>次のサンプルでは、アクティブなグラフに四角形を追加する方法を紹介します。他のグラフオブジェクトタイプについては、oc_const.h ファイル内の GROT_* (例:GROT_TEXT, GROT_LINE, GROT_POLYGON) を確認してください。
</p>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
string strName <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;MyRect&quot;</span>;
GraphObject goRect <span style="color: #000080;">=</span> gl.<span style="color: #000000;">CreateGraphObject</span><span style="color: #000000;">(</span>GROT_RECT, strName<span style="color: #000000;">)</span>;</pre>
<p>現在のグラフウィンドウにテキストラベルを追加します。
</p>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
GraphObject go <span style="color: #000080;">=</span> gl.<span style="color: #000000;">CreateGraphObject</span><span style="color: #000000;">(</span>GROT_TEXT, <span style="color: #ff00ff;">&quot;MyText&quot;</span><span style="color: #000000;">)</span>;		
go.<span style="color: #000000;">Text</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;This is a test&quot;</span>;</pre>
<p>以下のサンプルでは、グラフに矢印を追加する方法を示します。矢印のオブジェクトタイプは、GROT_LINEで、線と同じです。線と矢印ともに、データポイントの数は2つ必要です。
</p>
<pre class="oc" style="font-family:monospace;">GraphPage gp;
gp.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
GraphLayer gl <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;

string strName <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;MyArrow&quot;</span>; <span style="color: #008000;">// グラフオブジェクトの名前</span>
GraphObject go <span style="color: #000080;">=</span> gl.<span style="color: #000000;">CreateGraphObject</span><span style="color: #000000;">(</span>GROT_LINE, strName<span style="color: #000000;">)</span>;

go.<span style="color: #000000;">Attach</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>; <span style="color: #008000;">// 接続先はレイヤとスケール</span>

Tree tr;		
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimension</span>.<span style="color: #000000;">Units</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>; <span style="color: #008000;">// 単位はスケールにセット</span>

<span style="color: #008000;">// スケール値で位置をセット</span>
vector vx <span style="color: #000080;">=</span> <span style="color: #000000;">{</span><span style="color: #0000dd;">2</span>, <span style="color: #0000dd;">6</span><span style="color: #000000;">}</span>;
vector vy <span style="color: #000080;">=</span> <span style="color: #000000;">{</span><span style="color: #0000dd;">6</span>, <span style="color: #0000dd;">2</span><span style="color: #000000;">}</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Data</span>.<span style="color: #000000;">X</span>.<span style="color: #000000;">dVals</span> <span style="color: #000080;">=</span> vx;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Data</span>.<span style="color: #000000;">Y</span>.<span style="color: #000000;">dVals</span> <span style="color: #000080;">=</span> vy;	

tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Arrow</span>.<span style="color: #000000;">Begin</span>.<span style="color: #000000;">Style</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Arrow</span>.<span style="color: #000000;">End</span>.<span style="color: #000000;">Style</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;

<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> go.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">(</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
	go.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">(</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span></pre>
<p>次のサンプルでは、グラフに曲線矢印を追加する方法を示します。曲線矢印は、データポイントの数は4つ必要です。
</p>
<pre class="oc" style="font-family:monospace;">GraphPage gp;
gp.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
GraphLayer gl <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;

string strName <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;MyArrow&quot;</span>; <span style="color: #008000;">// グラフオブジェクトの名前</span>
GraphObject go <span style="color: #000080;">=</span> gl.<span style="color: #000000;">CreateGraphObject</span><span style="color: #000000;">(</span>GROT_LINE4, strName<span style="color: #000000;">)</span>;

go.<span style="color: #000000;">Attach</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>; <span style="color: #008000;">// 接続先はレイヤとスケール</span>

Tree tr;		
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimension</span>.<span style="color: #000000;">Units</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>; <span style="color: #008000;">// 単位をスケールにセット</span>

<span style="color: #008000;">// スケール値で位置をセット</span>
vector vx <span style="color: #000080;">=</span> <span style="color: #000000;">{</span><span style="color: #0000dd;">2</span>, <span style="color: #0000dd;">4</span>, <span style="color: #0000dd;">6</span>, <span style="color: #0000dd;">5</span><span style="color: #000000;">}</span>;
vector vy <span style="color: #000080;">=</span> <span style="color: #000000;">{</span><span style="color: #0000dd;">7</span>, <span style="color: #0000dd;">6.9</span>, <span style="color: #0000dd;">6.8</span>, <span style="color: #0000dd;">2</span><span style="color: #000000;">}</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Data</span>.<span style="color: #000000;">X</span>.<span style="color: #000000;">dVals</span> <span style="color: #000080;">=</span> vx;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Data</span>.<span style="color: #000000;">Y</span>.<span style="color: #000000;">dVals</span> <span style="color: #000080;">=</span> vy;	

tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Arrow</span>.<span style="color: #000000;">Begin</span>.<span style="color: #000000;">Style</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Arrow</span>.<span style="color: #000000;">End</span>.<span style="color: #000000;">Style</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;

<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> go.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">(</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
	go.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">(</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span></pre>
<h2><a name="Setting_PropertiesGraph_Object.2C_General_Properties"></a><span class="mw-headline">プロパティ設定<span class="OIndex" style="display:none">Graph Object, General Properties</span></span></h2>
<p>テキストフォントや、色、線の幅などのグラフィカルオブジェクトのプロパティを設定します。
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// グラフオブジェクトの色とフォントを設定	</span>
GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
GraphObject goText <span style="color: #000080;">=</span> gl.<span style="color: #000000;">GraphObjects</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Text&quot;</span><span style="color: #000000;">)</span>;
goText.<span style="color: #000000;">Text</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;This is a test&quot;</span>;
goText.<span style="color: #000000;">Attach</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>; <span style="color: #008000;">// レイヤスケールに接続	</span>

Tree tr;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Color</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> SYSCOLOR_RED; <span style="color: #008000;">// the color of text</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Font</span>.<span style="color: #000000;">Bold</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; 
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Font</span>.<span style="color: #000000;">Italic</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Font</span>.<span style="color: #000000;">Underline</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Font</span>.<span style="color: #000000;">Size</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">30</span>; <span style="color: #008000;">// font size of text</span>

<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> goText.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">(</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
	<span style="color: #0000ff;">bool</span> bRet <span style="color: #000080;">=</span> goText.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">(</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span></pre>
<h2><a name="Setting_Position_and_SizeGraph_Object.2C_ResizeGraph_Object.2C_Position"></a><span class="mw-headline">位置とサイズを設定<span class="OIndex" style="display:none">Graph Object, Resize</span><span class="OIndex" style="display:none">Graph Object, Position</span></span></h2>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
GraphObject go <span style="color: #000080;">=</span> gl.<span style="color: #000000;">GraphObjects</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Rect&quot;</span><span style="color: #000000;">)</span>;
go.<span style="color: #000000;">Attach</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>; <span style="color: #008000;">// レイヤスケールに接続	</span>

<span style="color: #008000;">// テキストオブジェクトをレイヤの左上に移動</span>
Tree tr;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimension</span>.<span style="color: #000000;">Units</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> UNITS_SCALE;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimension</span>.<span style="color: #000000;">Left</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> gl.<span style="color: #000000;">X</span>.<span style="color: #000000;">From</span>; <span style="color: #008000;">// 左</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimension</span>.<span style="color: #000000;">Top</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> gl.<span style="color: #000000;">Y</span>.<span style="color: #000000;">To</span><span style="color: #000040;">/</span><span style="color: #0000dd;">2</span>; <span style="color: #008000;">// 上</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimension</span>.<span style="color: #000000;">Width</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> <span style="color: #000000;">(</span>gl.<span style="color: #000000;">X</span>.<span style="color: #000000;">To</span> <span style="color: #000040;">-</span> gl.<span style="color: #000000;">X</span>.<span style="color: #000000;">From</span><span style="color: #000000;">)</span><span style="color: #000040;">/</span><span style="color: #0000dd;">2</span>; <span style="color: #008000;">// 幅</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimension</span>.<span style="color: #000000;">Height</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> <span style="color: #000000;">(</span>gl.<span style="color: #000000;">Y</span>.<span style="color: #000000;">To</span> <span style="color: #000040;">-</span> gl.<span style="color: #000000;">Y</span>.<span style="color: #000000;">From</span><span style="color: #000000;">)</span><span style="color: #000040;">/</span><span style="color: #0000dd;">2</span>; <span style="color: #008000;">// 高さ</span>

<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> go.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">(</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
	<span style="color: #0000ff;">bool</span> bRet <span style="color: #000080;">=</span> go.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">(</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span></pre>
<h2><a name="Updating_Attach_PropertyGraph_Object.2C_Attach_Property"></a><span class="mw-headline">接続先プロパティを更新<span class="OIndex" style="display:none">Graph Object, General Properties</span></span></h2>
<p>接続先には、ページ、レイヤ枠、レイヤスケールの3つの選択肢があります。
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// グラフオブジェクトに異なるオブジェクトを接続</span>
<span style="color: #008000;">// 0 はレイヤ。レイヤを移動するとグラフオブジェクトも一緒に移動</span>
<span style="color: #008000;">// 1 はページ。レイヤを移動してもグラフオブジェクトに影響はない</span>
<span style="color: #008000;">// 2 はレイヤスケール。スケールを変更するとグラフオブジェクトの位置が</span>
<span style="color: #008000;">// 対応して移動</span>
go.<span style="color: #000000;">Attach</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;</pre>
<h2><a name="Getting_and_Setting_Disable_PropertyGraph_Object.2C_Disable_Moving_and_Selection"></a><span class="mw-headline">無効なプロパティの取得と設定<span class="OIndex" style="display:none">Graph Object, Disable Moving and Selection</span></span></h2>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// 移動可能、選択可能といった無効なプロパティを確認</span>
Tree tr;
tr <span style="color: #000080;">=</span> go.<span style="color: #000000;">GetFormat</span><span style="color: #000000;">(</span>FPB_OTHER, FOB_ALL, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>;
DWORD 	dwStats <span style="color: #000080;">=</span> tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">States</span>.<span style="color: #000000;">nVal</span>;

<span style="color: #008000;">// 垂直と水平移動を確認</span>
<span style="color: #008000;">// プロパティの詳細は、oc_const.hファイルの GOC_* を確認</span>
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #000000;">(</span>dwStats <span style="color: #000040;">&amp;</span> GOC_NO_VMOVE<span style="color: #000000;">)</span> <span style="color: #000040;">&amp;&amp;</span> <span style="color: #000000;">(</span>dwStats <span style="color: #000040;">&amp;</span> GOC_NO_HMOVE<span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
	out_str<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;This graph object cannot be move&quot;</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span></pre>
<h2><a name="Programming_ControlGraph_Object.2C_Programming_Control"></a><span class="mw-headline">Programming Control<span class="OIndex" style="display:none">Graph Object, Programming Control</span></span></h2>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// 1. 線を追加</span>
GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
GraphObject go <span style="color: #000080;">=</span> gl.<span style="color: #000000;">CreateGraphObject</span><span style="color: #000000;">(</span>GROT_LINE<span style="color: #000000;">)</span>;
go.<span style="color: #000000;">Attach</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>; <span style="color: #008000;">// 接続先をレイヤスケールにセット</span>
go.<span style="color: #000000;">X</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>; <span style="color: #008000;">// 初期位置X = 5にセット</span>

<span style="color: #008000;">// 2.線図のプロパティをセット</span>
Tree tr;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Direction</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>; <span style="color: #008000;">// 1 は水平、2 は垂直</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Span</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; <span style="color: #008000;">// レイヤまで間隔 </span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Color</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> SYSCOLOR_RED; <span style="color: #008000;">// 線の色</span>

<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> go.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">(</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>	
<span style="color: #000000;">{</span>
	go.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">(</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span>

<span style="color: #008000;">// 3.イベントモードとLTスクリプトをセット</span>
<span style="color: #008000;">// 線移動すると線の位置のX値を印字</span>
Tree trEvent;
trEvent.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Event</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> GRCT_MOVE;<span style="color: #008000;">// 詳細は、oc_const.hの GRCT_* </span>
trEvent.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Script</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;type -a $(this.X)&quot;</span>;

<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> go.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">(</span>trEvent.<span style="color: #000000;">Root</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>	
<span style="color: #000000;">{</span>
	go.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">(</span>trEvent, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span></pre>
<h2><a name="Updating_LegendLegend_UpdateGraph_Layer.2C_Legend"></a><span class="mw-headline">凡例の更新<span class="OIndex" style="display:none">Legend Update</span><span class="OIndex" style="display:none">Graph Layer, Legend</span></span></h2>
<p>凡例は、グラフウィンドウ内にある&quot;Legend&quot;という名前のグラフィックオブジェクトです。データプロットを追加/削除後、<b><a href="../../OriginC/OriginC/Legend_update_(global_function).html" title="OriginC:Legend update (global function)">legend_update</a></b> 関数を使用して、現在データプロットに基づいた凡例に更新することが可能です。
</p>
<pre class="oc" style="font-family:monospace;"> 
<span style="color: #008000;">// 凡例の更新の簡単な使用方法</span>
<span style="color: #008000;">// Origin C ヘルプでは、この関数を検索して引数や</span>
<span style="color: #008000;">// 使用例について確認可能</span>
legend_update<span style="color: #000000;">(</span>gl<span style="color: #000000;">)</span>; <span style="color: #008000;">// gl は、GraphLayer オブジェクト</span></pre>
<h2><a name="Adding_Table_Object_on_GraphGraph_Layer.2C_Add_Worksheet_Table"></a><span class="mw-headline">グラフに表オブジェクトを追加<span class="OIndex" style="display:none">Graph Layer, Add Worksheet Table</span></span></h2>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// 1. 表テンプレートとともにワークシートを作成</span>
Worksheet wks;
wks.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Table&quot;</span>, CREATE_HIDDEN<span style="color: #000000;">)</span>; 
WorksheetPage wksPage <span style="color: #000080;">=</span> wks.<span style="color: #000000;">GetPage</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;

<span style="color: #008000;">// 2.表のサイズを取得し、テキストを埋める</span>
wks.<span style="color: #000000;">SetSize</span><span style="color: #000000;">(</span><span style="color: #0000dd;">3</span>, <span style="color: #0000dd;">2</span><span style="color: #000000;">)</span>;
wks.<span style="color: #000000;">SetCell</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">0</span>, <span style="color: #ff00ff;">&quot;1&quot;</span><span style="color: #000000;">)</span>;
wks.<span style="color: #000000;">SetCell</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">1</span>, <span style="color: #ff00ff;">&quot;Layer 1&quot;</span><span style="color: #000000;">)</span>;

wks.<span style="color: #000000;">SetCell</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">0</span>, <span style="color: #ff00ff;">&quot;2&quot;</span><span style="color: #000000;">)</span>;
wks.<span style="color: #000000;">SetCell</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">1</span>, <span style="color: #ff00ff;">&quot;Layer 2&quot;</span><span style="color: #000000;">)</span>;

wks.<span style="color: #000000;">SetCell</span><span style="color: #000000;">(</span><span style="color: #0000dd;">2</span>, <span style="color: #0000dd;">0</span>, <span style="color: #ff00ff;">&quot;3&quot;</span><span style="color: #000000;">)</span>;
wks.<span style="color: #000000;">SetCell</span><span style="color: #000000;">(</span><span style="color: #0000dd;">2</span>, <span style="color: #0000dd;">1</span>, <span style="color: #ff00ff;">&quot;Layer 3&quot;</span><span style="color: #000000;">)</span>;

<span style="color: #008000;">//3.グラフへのリンクとして表を追加</span>
GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;	
GraphObject grTable <span style="color: #000080;">=</span> gl.<span style="color: #000000;">CreateLinkTable</span><span style="color: #000000;">(</span>wksPage.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>, wks<span style="color: #000000;">)</span>;</pre>







    