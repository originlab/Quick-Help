<h1 class="firstheading">行列をワークシートに変換</h1><p>分析または、グラフ作成時に、行列からワークシートに変換またはその反対の操作により、データを再構成する必要があるかもしれません。このページでは、行列をワークシートに変換する時のサンプルと情報を紹介します。なお、反対の操作は、<a href="../../OriginC/OCGuide/Converting_Worksheet_to_Matrix.html" title="OCGuide:ワークシートから行列に変換">ワークシートを行列に変換する</a>を確認してください。
</p>
<h2><a name="Matrix_to_Worksheet"></a><span class="mw-headline">行列からワークシート</span></h2>
<p>行列オブジェクトデータをワークシートに変換するには、まず行列オブジェクト内のデータをデータ行列に取得し、クラス内に定義された <a href="../../OriginC/OriginC/Matrixbase-CopyTo.html" title="OriginC:Matrixbase-CopyTo">CopyTo</a>メソッドを使用します。
</p><p>ここでは、すべての行列オブジェクトを直接ワークシートに変換する方法を示します。
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// アクティブ行列オブジェクトを新しく作成した行列に直接変換 </span>
<span style="color: #008000;">// 転置なし、列タイプは行列と同じ</span>
MatrixLayer ml <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">// 行列シートをアクティブにする</span>
MatrixObject mo <span style="color: #000080;">=</span> ml.<span style="color: #000000;">MatrixObjects</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">// 第1行列オブジェクトを取得</span>
matrixbase <span style="color: #000040;">&amp;</span>mb <span style="color: #000080;">=</span> mo.<span style="color: #000000;">GetDataObject</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">// 行列オブジェクトからデータを取得</span>
Worksheet wks;
wks.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Origin&quot;</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">// 新しいワークシートを作成</span>
mb.<span style="color: #000000;">CopyTo</span><span style="color: #000000;">(</span>wks, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">0</span>, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">0</span>, <span style="color: #0000ff;">FALSE</span>, <span style="color: #0000ff;">TRUE</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">// データをワークシートに変換</span></pre>







    