<h1 class="firstheading">Hello Worldダイアログ</h1>
<p class="urlname" style="display: none;">first-HTML-dialog</p>
<p><span class="OIndex" style="display: none;">Hello Worldダイアログ</span><span class="OIndex" style="display: none;">HTML Dialog</span></p>
<p><br /></p>
<div id="toc" class="toc">
<div id="toctitle">
<h2>目次</h2>
</div>
<ol>
<li class="toclevel-1 tocsection-1"><a href="#Summary"><span class="tocnumber">1</span> <span class="toctext">サマリー</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Sample_Files"><span class="tocnumber">2</span> <span class="toctext">サンプルファイル</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Creating_an_HTML_Page"><span class="tocnumber">3</span> <span class="toctext">HTMLページの作成</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Creating_an_HTML_dialog"><span class="tocnumber">4</span> <span class="toctext">HTMLダイアログの作成</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Advanced_Feature"><span class="tocnumber">5</span> <span class="toctext">高度な機能</span></a>
<ol>
<li class="toclevel-2 tocsection-6"><a href="#Preventing_dialog_resizing"><span class="tocnumber">5.1</span> <span class="toctext">ダイアログのサイズ変更を禁止</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Setting_dialog_size"><span class="tocnumber">5.2</span> <span class="toctext">ダイアログサイズの設定</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Adding_event_handler"><span class="tocnumber">5.3</span> <span class="toctext">イベントハンドラーの追加</span></a></li>
</ol>
</li>
</ol>
</div>
<h2><a name="Summary" id="Summary"></a><span class="mw-headline">サマリー</span></h2>
<p>このチュートリアルでは、以下の項目について説明します。</p>
<ol>
<li>HTMLページの作成</li>
<li>OriginCを使ってダイアログボックス内でHTMLページを表示</li>
<li>ダイアログのイベントに対応するイベントハンドラーのビルド</li>
</ol>
<p class="version">必要なOriginのバージョン: Origin 2017 以降</p>
<h2><a name="Sample_Files" id="Sample_Files"></a><span class="mw-headline">サンプルファイル</span></h2>
<ul>
<li>index.html: htmlページのHTMLコード</li>
<li>HelloWorldDlg.cpp: HTMLページを呼び出してダイアログ内でそれを表示するOriginCのコード</li>
<li>HelloWorldDlg1.cpp: 応用的な機能を含むOriginCのコード</li>
</ul>
<table class="note">
<tr>
<td><b>Note:</b> <a class="external text" href="http://blog.originlab.com/wp-content/uploads/2016/11/HTMLDlgExamples.zip" target="_blank">こちら</a>から、サンプルファイルをダウンロードできます。</td>
</tr>
</table>
<h2><a name="Creating_an_HTML_Page" id="Creating_an_HTML_Page"></a><span class="mw-headline">HTMLページの作成</span></h2>
<p>HTMLダイアログを作成する際には、まず初めにHTMLページを作成します。</p>
<ol>
<li>Originを起動して、<a class="image"><img alt="Cb.png" src="../images/1st_HTML_Dialog/Cb.png" width="26" height="21" border="0" /></a>をダブルクリックして<b>コードビルダ</b>を開きます。</li>
<li>「index.html」という新しいHTMLファイルを作成して、「Hello World」という新しいフォルダに保存します。</li>
<li>&lt; head &gt;と&lt; body &gt;要素を中に入れ、&lt; title &gt;, &lt; h1 &gt;, &lt; p &gt; などの別のHTML要素を加えてHTMLページを構築します。
<pre class="javascript" style="font-family: monospace;">
<span style="color: #339933;">&lt;!</span>DOCTYPE html<span style="color: #339933;">&gt;</span><span style="color: #339933;">
&lt;</span>html<span style="color: #339933;">&gt;</span>
    <span style="color: #339933;">&lt;</span>meta charset<span style="color: #339933;">=</span><span style="color: #3366CC;">"utf-8"</span> <span style="color: #339933;">/&gt;</span>
    <span style="color: #339933;">&lt;</span>meta http<span style="color: #339933;">-</span>equiv<span style="color: #339933;">=</span><span style="color: #3366CC;">"X-UA-Compatible"</span> content<span style="color: #339933;">=</span><span style="color: #3366CC;">"IE=Edge"</span><span style="color: #339933;">/&gt;</span>
    <span style="color: #339933;">&lt;</span>head<span style="color: #339933;">&gt;</span>
       <span style="color: #339933;">&lt;</span>title<span style="color: #339933;">&gt;</span>
          A Small Hello 
       <span style="color: #339933;">&lt;/</span>title<span style="color: #339933;">&gt;</span>
    <span style="color: #339933;">&lt;/</span>head<span style="color: #339933;">&gt;</span>
    <span style="color: #339933;">&lt;</span>body<span style="color: #339933;">&gt;</span>
        <span style="color: #339933;">&lt;</span>h1<span style="color: #339933;">&gt;</span>Hello World<span style="color: #339933;">&lt;/</span>h1<span style="color: #339933;">&gt;</span>
        <span style="color: #339933;">&lt;</span>p<span style="color: #339933;">&gt;</span>This is very minimal <span style="color: #3366CC;">"hello world"</span> HTML document.<span style="color: #339933;">&lt;/</span>p<span style="color: #339933;">&gt;</span> 
    <span style="color: #339933;">&lt;/</span>body<span style="color: #339933;">&gt;</span><span style="color: #339933;">
&lt;/</span>html<span style="color: #339933;">&gt;</span>
        
</pre></li>
</ol>
<table class="note">
<tr>
<td><b>Note:</b>編集を終えたら、ブラウザでこのページを開いて、確認します。</td>
</tr>
</table>
<h2><a name="Creating_an_HTML_dialog" id="Creating_an_HTML_dialog"></a><span class="mw-headline">HTMLダイアログの作成</span></h2>
<p>このセクションでは、ダイアログのHTMLページ表示を作成します。</p>
<ol>
<li><b>コードビルダ</b>で、HTMLファイルのパスの下に、新しいcppファイル「DlgWithGraph.cpp」を作成します。</li>
<li>まず初めに、3つの必要なヘッダを入れます。ここで、HTMLDlg.はOrigin 2017で新しくなっており、OriginとHTMLダイアログを一緒に結びつけます。
<pre class="c" style="font-family: monospace;">
<span style="color: #339933;">#include &lt;Origin.h&gt;</span><span style="color: #339933;">
#include &lt;..\OriginLab\DialogEx.h&gt;</span><span style="color: #339933;">
#include &lt;..\OriginLab\HTMLDlg.h&gt;</span>
</pre></li>
<li>ユーザ定義HTMLダイアログクラスを<code>HTMLDlg</code>クラスから生成し、手法<code>GetInitURL()</code>の中にHTMLページを示します。
<pre class="c" style="font-family: monospace;">
class HelloWorldDlg<span style="color: #339933;">:</span> public HTMLDlg<span style="color: #009900;">
{</span>
    public<span style="color: #339933;">:</span>
        string GetInitURL<span style="color: #009900;">(</span><span style="color: #009900;">)</span> <span style="color: #666666; font-style: italic;">//htmlファイルのパス取得                    </span>
        <span style="color: #009900;">{</span>
            string strFile <span style="color: #339933;">=</span> __FILE__<span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//現在のファイルのパス</span>
            <span style="color: #b1b100;">return</span> GetFilePath<span style="color: #009900;">(</span>strFile<span style="color: #009900;">)</span> <span style="color: #339933;">+</span> <span style="color: #ff0000;">"index.html"</span><span style="color: #339933;">;</span>
        <span style="color: #009900;">}</span><span style="color: #009900;">
}</span><span style="color: #339933;">;</span>
        
</pre></li>
<li>HTMLダイアログを開くには、すべてのコードを保存してビルドし、以下の関数を実行します。
<pre class="c" style="font-family: monospace;">
<span style="color: #993333;">void</span> hello<span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #009900;">
{</span>
    HelloWorldDlg dlg<span style="color: #339933;">;</span>
    dlg.<span style="color: #202020;">DoModalEx</span><span style="color: #009900;">(</span>GetWindow<span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span><span style="color: #009900;">
}</span>
</pre></li>
</ol>
<p>「Hello World」の付いたHTMLダイアログがポップアップされます。</p>
<dl>
<dd><a class="image"><img alt="Hello.png" src="../images/1st_HTML_Dialog/300px-Hello.png" width="300" height="214" border="0" /></a></dd>
</dl>
<h2><a name="Advanced_Feature" id="Advanced_Feature"></a><span class="mw-headline">高度な機能</span></h2>
<p>ダイアログを変更してイベントヘッダーを追加し、プログラムを改良することができます。</p>
<table class="note">
<tr>
<td><b>Note:</b> 以下の機能の完全なコードは「HelloWorldDlg1.cpp」で利用可能です。</td>
</tr>
</table>
<h3><a name="Preventing_dialog_resizing" id="Preventing_dialog_resizing"></a><span class="mw-headline">ダイアログのサイズ変更を禁止</span></h3>
<p>この設定を行うには、<code>ModifyStyle</code>を使い、ダイアログクラスの手法 <code>OnInitDialog</code>「WS_THICKFRAME」を無効にします。</p>
<pre class="c" style="font-family: monospace;">
BOOL OnInitDialog<span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #009900;">
{</span>
    ModifyStyle<span style="color: #009900;">(</span>WS_THICKFRAME<span style="color: #339933;">,</span> <span style="color: #0000dd;">0</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span><span style="color: #666666; font-style: italic;">//サイズ変更禁止</span>
    <span style="color: #b1b100;">return</span> HTMLDlg<span style="color: #339933;">::</span><span style="color: #202020;">OnInitDialog</span><span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span><span style="color: #009900;">
}</span>
</pre>
<h3><a name="Setting_dialog_size" id="Setting_dialog_size"></a><span class="mw-headline">ダイアログサイズの設定</span></h3>
<p>対のクラス手法<code>GetDlgInitSize</code>をダイアログクラスから呼び出し、ダイアログの幅と高さを指定する必要があります。</p>
<pre class="c" style="font-family: monospace;">
BOOL GetDlgInitSize<span style="color: #009900;">(</span>int<span style="color: #339933;">&amp;</span> width<span style="color: #339933;">,</span> int<span style="color: #339933;">&amp;</span> height<span style="color: #009900;">)</span><span style="color: #666666; font-style: italic;">//ダイアログサイズ取得</span><span style="color: #009900;">
{</span>
    width <span style="color: #339933;">=</span> <span style="color: #0000dd;">500</span><span style="color: #339933;">;</span>
    height <span style="color: #339933;">=</span> <span style="color: #0000dd;">200</span><span style="color: #339933;">;</span>
    <span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">true</span><span style="color: #339933;">;</span><span style="color: #009900;">
}</span>
</pre>
<h3><a name="Adding_event_handler" id="Adding_event_handler"></a><span class="mw-headline">イベントハンドラーの追加</span></h3>
<p><a href="../../OriginC/Category/Dialog_Builder.html" title="カテゴリー:ダイアログビルダ">ダイアログビルダ</a>と同様に、メッセージマップを使って、どのイベントを扱うのか、どの関数を呼び出すのかを指定します。<br />
例えば、イベントハンドラー手法をユーザ定義のクラス「HelloWorldDlg」に 加えて、ダイアログを閉じるとメッセージがポップアップするようにします。</p>
<ol>
<li>クラス<code>HelloWorldDlg</code>にある以下のメッセージマップにより、ダイアログメッセージをマップします。
<pre class="c" style="font-family: monospace;">
<span style="color: #666666; font-style: italic;">//メッセージマップ</span>
public<span style="color: #339933;">:</span>
    EVENTS_BEGIN_DERIV<span style="color: #009900;">(</span>HTMLDlg<span style="color: #009900;">)</span>
        ON_DESTROY<span style="color: #009900;">(</span>OnDestroy<span style="color: #009900;">)</span>
    EVENTS_END_DERIV
</pre></li>
<li>イベントハンドラー手法をユーザ定義のクラス<code>HelloWorldDlg</code>に加えて、ダイアログを閉じるとメッセージがポップアップするようにします。
<pre class="c" style="font-family: monospace;">
BOOL OnDestroy<span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #009900;">
{</span>
    MessageBox<span style="color: #009900;">(</span>GetSafeHwnd<span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span> _L<span style="color: #009900;">(</span><span style="color: #ff0000;">"Thank you and have a good day!"</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span>_L<span style="color: #009900;">(</span><span style="color: #ff0000;">"Message"</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span>
    <span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">true</span><span style="color: #339933;">;</span><span style="color: #009900;">
}</span>
</pre></li>
</ol>
