<h1 class="firstheading">数値データ</h1><p><br />
このセクションでは、Origin Cで数値データを操作するサンプルを扱います。数値データは次のデータタイプの変数に保存することができます。
</p>
<ol><li> double</li>
<li> integer</li>
<li> vector</li>
<li> matrix</li></ol>
<p>数値データと文字列は、ツリーのノードに保存でき、提供されたノードは上記のデータ型の1つです。 
</p><p><b>Note</b>:0.0、NANUM (欠損値)、-1.0E-290 から 1.0E-290の間の値は、ロジカル文では<i>偽</i> と評価されます。 
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Missing_Values"><span class="tocnumber">1</span> <span class="toctext"><span class="OIndex">欠損値</span></span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Numeric.2C_Significant_DigitsNumeric.2C_Data_Comparison_DataPrecision_and_Comparison"><span class="tocnumber">2</span> <span class="toctext"><span class="OIndex" style="display:none">Numeric, Significant Digits</span><span class="OIndex" style="display:none">Numeric, Data Comparison Data</span>精度と比較</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Convert_Numeric_to_StringNumeric.2C_Convert_to_String"><span class="tocnumber">3</span> <span class="toctext">数値を文字列に変換する<span class="OIndex" style="display:none">Numeric, Convert to String</span></span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#VectorArray.2C_One-Dimensional"><span class="tocnumber">4</span> <span class="toctext"><span class="OIndex">ベクトル</span><span class="OIndex" style="display:none">Array, One-Dimensional</span></span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#MatrixArray.2C_Two-Dimensionals"><span class="tocnumber">5</span> <span class="toctext"><span class="OIndex">行列</span><span class="OIndex" style="display:none">Array, Two-Dimensionals</span></span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#TreeNode"><span class="tocnumber">6</span> <span class="toctext"><span class="OIndex">TreeNode</span></span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#ComplexComplex_Variable"><span class="tocnumber">7</span> <span class="toctext">複素数<span class="OIndex" style="display:none">Complex Variable</span></span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#DataRange"><span class="tocnumber">8</span> <span class="toctext">DataRange</span></a>
<ul>
<li class="toclevel-2 tocsection-9"><a href="#Data_Range_in_WorksheetWorksheet.2C_Data_Range_SelectionData_Range.2C_from_Worksheet"><span class="tocnumber">8.1</span> <span class="toctext">ワークシート内のデータ範囲<span class="OIndex" style="display:none">Worksheet, Data Range Selection</span><span class="OIndex" style="display:none">Data Range, from Worksheet</span></span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Data_Range_in_MatrixsheetMatrix_Sheet.2C_Data_Range_SelectionData_Range.2C_from_Matrix"><span class="tocnumber">8.2</span> <span class="toctext">行列シート内のデータ範囲<span class="OIndex" style="display:none">Matrix Sheet, Data Range Selection</span><span class="OIndex" style="display:none">Data Range, from Matrix</span></span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Data_Range_in_GraphGraph_Layer.2C_Data_Range_SelectionData_Range.2C_from_Graph"><span class="tocnumber">8.3</span> <span class="toctext">グラフ内のデータ範囲<span class="OIndex" style="display:none">Graph Layer, Data Range Selection</span><span class="OIndex" style="display:none">Data Range, from Graph</span></span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Data_Range_ControlData_Selector"><span class="tocnumber">8.4</span> <span class="toctext"><span class="OIndex">データ範囲を制御する</span><span class="OIndex" style="display:none">Data Selector</span></span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="Missing_Values"></a><span class="mw-headline"><span class="OIndex">欠損値</span></span></h2>
<p>数値データが重要であるのと同様に、欠損値を表すことができることも重要です。  Origin Cは、値が欠損値であるかどうかを比較する<span class="OIndex">NANUM</span>マクロを定義します。  欠損値は、double型のデータ型のみをサポートしています。 
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">double</span> d <span style="color: #000080;">=</span> NANUM;
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> NANUM <span style="color: #000080;">==</span> d <span style="color: #000000;">)</span>
    out_str<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;The value is a missing value.&quot;</span><span style="color: #000000;">)</span>;</pre>
<p>Origin Cは、値が欠損値であるかどうかをチェックする<b><a href="../../OriginC/OriginC/Is_missing_value_(global_function).html" title="OriginC:Is missing value (global function)">is_missing_value</a></b> 関数も提供しています。 
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> is_missing_value<span style="color: #000000;">(</span>d<span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
    out_str<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;The value is a missing value.&quot;</span><span style="color: #000000;">)</span>;</pre>
<h2><a name="Numeric.2C_Significant_DigitsNumeric.2C_Data_Comparison_DataPrecision_and_Comparison"></a><span class="mw-headline"><span class="OIndex" style="display:none">Numeric, Significant Digits</span><span class="OIndex" style="display:none">Numeric, Data Comparison Data</span>精度と比較</span></h2>
<p>次のサンプルコードでは、<i>prec</i> と <i>round</i> 関数を使って、double型の数値データの精度を制御します。  <i>is_equal</i> 関数を使って、double型の数値データの2つを比較します。 
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">double</span> dVal <span style="color: #000080;">=</span> PI; <span style="color: #008000;">// PI は、3.1415926535897932384626と定義</span>

<span style="color: #008000;">// double型の値を有効桁数6ケタに変換</span>
<span style="color: #0000ff;">int</span> nSignificantDigits <span style="color: #000080;">=</span> <span style="color: #0000dd;">6</span>;
<span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;%f<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, prec<span style="color: #000000;">(</span>dVal, nSignificantDigits<span style="color: #000000;">)</span><span style="color: #000000;">)</span>;

<span style="color: #008000;">// double型の値を2ケタのみにする</span>
uint nDecimalPlaces <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
<span style="color: #0000ff;">double</span> dd <span style="color: #000080;">=</span> round<span style="color: #000000;">(</span>dVal, nDecimalPlaces<span style="color: #000000;">)</span>;
<span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;%f<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, dd<span style="color: #000000;">)</span>;

<span style="color: #008000;">// 2つのdouble型の値を比較</span>
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> is_equal<span style="color: #000000;">(</span>dd, <span style="color: #0000dd;">3.14</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
	out_str<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;equal<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span>	
<span style="color: #0000ff;">else</span>
<span style="color: #000000;">{</span>
	out_str<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;not equal<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span></pre>
<h2><a name="Convert_Numeric_to_StringNumeric.2C_Convert_to_String"></a><span class="mw-headline">数値を文字列に変換する<span class="OIndex" style="display:none">Numeric, Convert to String</span></span></h2>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// int型の数値を文字列に割り当て</span>
string str <span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span>;
out_str<span style="color: #000000;">(</span>str<span style="color: #000000;">)</span>;

<span style="color: #0000ff;">int</span> nn <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
str <span style="color: #000080;">=</span> nn;
out_str<span style="color: #000000;">(</span>str<span style="color: #000000;">)</span>;

<span style="color: #008000;">// double型の数値を文字列に割り当て</span>
<span style="color: #0000ff;">double</span> dd <span style="color: #000080;">=</span> PI;	
str <span style="color: #000080;">=</span> ftoa<span style="color: #000000;">(</span>dd, <span style="color: #ff00ff;">&quot;*&quot;</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// オプションダイアログでOriginのグローバル設定に&quot;*&quot;を使う</span>
out_str<span style="color: #000000;">(</span>str<span style="color: #000000;">)</span>;

str <span style="color: #000080;">=</span> ftoa<span style="color: #000000;">(</span>dd, <span style="color: #ff00ff;">&quot;*8&quot;</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// &quot;*8&quot;を使用して有効桁数8ケタに指定</span>
out_str<span style="color: #000000;">(</span>str<span style="color: #000000;">)</span>;</pre>
<h2><a name="VectorArray.2C_One-Dimensional"></a><span class="mw-headline"><span class="OIndex">ベクトル</span><span class="OIndex" style="display:none">Array, One-Dimensional</span></span></h2>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// 基本データ型、例えば double, int, string, complexの </span>
<span style="color: #008000;">// 一次配列</span>
vector vx, vy;

<span style="color: #0000ff;">int</span> nMax <span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span>;	
vx.<span style="color: #000000;">Data</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>, nMax, <span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// 1から10まで増分1で値をvxに割り当て</span>
vy.<span style="color: #000000;">SetSize</span><span style="color: #000000;">(</span>nMax<span style="color: #000000;">)</span>; <span style="color: #008000;">// サイズ(10)をvyにセット</span>

<span style="color: #0000ff;">for</span><span style="color: #000000;">(</span><span style="color: #0000ff;">int</span> nn <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; nn <span style="color: #000080;">&lt;</span> nMax; nn<span style="color: #000040;">++</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
	vy<span style="color: #000000;">[</span>nn<span style="color: #000000;">]</span> <span style="color: #000080;">=</span> rnd<span style="color: #000000;">(</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// 乱数をvyの各項目に割り当て</span>
	<span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;index =&nbsp;%d, x =&nbsp;%g, y =&nbsp;%g<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, nn<span style="color: #000040;">+</span><span style="color: #0000dd;">1</span>, vx<span style="color: #000000;">[</span>nn<span style="color: #000000;">]</span>, vy<span style="color: #000000;">[</span>nn<span style="color: #000000;">]</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span></pre>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// ワークシート内のデータにアクセス</span>
Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
Column col<span style="color: #000000;">(</span>wks, <span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;	

vector<span style="color: #000040;">&amp;</span> vec <span style="color: #000080;">=</span> col.<span style="color: #000000;">GetDataObject</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
vec <span style="color: #000080;">=</span> vec <span style="color: #000040;">*</span> <span style="color: #0000dd;">0.1</span>; <span style="color: #008000;">// vec内の各データに0.1を乗算</span>

vec <span style="color: #000080;">=</span> <span style="color: #000000;">sin</span><span style="color: #000000;">(</span>vec<span style="color: #000000;">)</span>;	<span style="color: #008000;">// vec内のデータのsinを求める</span></pre>
<h2><a name="MatrixArray.2C_Two-Dimensionals"></a><span class="mw-headline"><span class="OIndex">行列</span><span class="OIndex" style="display:none">Array, Two-Dimensionals</span></span></h2>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// 基本データ型、例えば double, int, complexの2次配列 </span>
<span style="color: #008000;">// stringは含まれない</span>
matrix mat<span style="color: #000000;">(</span><span style="color: #0000dd;">5</span>, <span style="color: #0000dd;">6</span><span style="color: #000000;">)</span>;

<span style="color: #0000ff;">for</span><span style="color: #000000;">(</span><span style="color: #0000ff;">int</span> ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; ii <span style="color: #000080;">&lt;</span> <span style="color: #0000dd;">5</span>; ii<span style="color: #000040;">++</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
	<span style="color: #0000ff;">for</span><span style="color: #000000;">(</span><span style="color: #0000ff;">int</span> jj <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; jj <span style="color: #000080;">&lt;</span> <span style="color: #0000dd;">6</span>; jj<span style="color: #000040;">++</span><span style="color: #000000;">)</span>
	<span style="color: #000000;">{</span>
		mat<span style="color: #000000;">[</span>ii<span style="color: #000000;">]</span><span style="color: #000000;">[</span>jj<span style="color: #000000;">]</span> <span style="color: #000080;">=</span> ii <span style="color: #000040;">+</span> jj;
		<span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;%g<span style="color: #666666; font-weight: bold;">\t</span>&quot;</span>, mat<span style="color: #000000;">[</span>ii<span style="color: #000000;">]</span><span style="color: #000000;">[</span>jj<span style="color: #000000;">]</span><span style="color: #000000;">)</span>;
	<span style="color: #000000;">}</span>
	<span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// 新しいライン</span>
<span style="color: #000000;">}</span></pre>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// 行列ウィンドウ内のデータにアクセス</span>
MatrixLayer ml <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
MatrixObject mo <span style="color: #000080;">=</span> ml.<span style="color: #000000;">MatrixObjects</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;

matrix<span style="color: #000040;">&amp;</span> mat <span style="color: #000080;">=</span> mo.<span style="color: #000000;">GetDataObject</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;	
mat <span style="color: #000080;">=</span> mat <span style="color: #000040;">+</span> <span style="color: #0000dd;">0.1</span>; <span style="color: #008000;">// 行列の各データに0.1を加算</span></pre>
<h2><a name="TreeNode"></a><span class="mw-headline"><span class="OIndex">TreeNode</span></span></h2>
<p>Origin CのTreeNodeクラスは、複数レベルのツリーを構築し、ツリーを横断し、ツリーノードの値/属性にアクセスするいくつかのメソッドを提供します。 
</p>
<pre class="oc" style="font-family:monospace;">Tree tr;

<span style="color: #008000;">// ツリーノードの値にアクセス</span>
TreeNode trName <span style="color: #000080;">=</span> tr.<span style="color: #000000;">AddNode</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Name&quot;</span><span style="color: #000000;">)</span>;
trName.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Jane&quot;</span>;

tr.<span style="color: #000000;">UserID</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span>;

vector<span style="color: #000080;">&lt;</span>string<span style="color: #000080;">&gt;</span> vsBooks <span style="color: #000080;">=</span> <span style="color: #000000;">{</span><span style="color: #ff00ff;">&quot;C++&quot;</span>, <span style="color: #ff00ff;">&quot;MFC&quot;</span><span style="color: #000000;">}</span>;
tr.<span style="color: #000000;">Books</span>.<span style="color: #000000;">strVals</span> <span style="color: #000080;">=</span> vsBooks;

out_tree<span style="color: #000000;">(</span>tr<span style="color: #000000;">)</span>; <span style="color: #008000;">// ツリーを出力</span></pre>
<h2><a name="ComplexComplex_Variable"></a><span class="mw-headline">複素数<span class="OIndex" style="display:none">Complex Variable</span></span></h2>
<pre class="oc" style="font-family:monospace;">complex cc<span style="color: #000000;">(</span><span style="color: #0000dd;">1.5</span>, <span style="color: #0000dd;">2.2</span><span style="color: #000000;">)</span>;

cc.<span style="color: #000000;">m_re</span> <span style="color: #000080;">=</span> cc.<span style="color: #000000;">m_re</span> <span style="color: #000040;">+</span><span style="color: #0000dd;">1</span>;
cc.<span style="color: #000000;">m_im</span> <span style="color: #000080;">=</span> cc.<span style="color: #000000;">m_im</span> <span style="color: #000040;">*</span> <span style="color: #0000dd;">0.1</span>;	

out_complex<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;cc = &quot;</span>, cc<span style="color: #000000;">)</span>; <span style="color: #008000;">// cc = 2.500000+0.220000i</span></pre>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// 複素数データセットにアクセス</span>
Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
Column col<span style="color: #000000;">(</span>wks, <span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> FSI_COMPLEX <span style="color: #000080;">==</span> col.<span style="color: #000000;">GetInternalDataType</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
	vector<span style="color: #000080;">&lt;</span>complex<span style="color: #000080;">&gt;</span><span style="color: #000040;">&amp;</span> vcc <span style="color: #000080;">=</span> col.<span style="color: #000000;">GetDataObject</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
	vcc<span style="color: #000000;">[</span><span style="color: #0000dd;">0</span><span style="color: #000000;">]</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0.5</span> <span style="color: #000040;">+</span> 3.6i;
<span style="color: #000000;">}</span></pre>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// 複素数行列にアクセス</span>
MatrixLayer ml <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
MatrixObject mo <span style="color: #000080;">=</span> ml.<span style="color: #000000;">MatrixObjects</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;

<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> FSI_COMPLEX <span style="color: #000080;">==</span> mo.<span style="color: #000000;">GetInternalDataType</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
	matrix<span style="color: #000080;">&lt;</span>complex<span style="color: #000080;">&gt;</span><span style="color: #000040;">&amp;</span> mat <span style="color: #000080;">=</span> mo.<span style="color: #000000;">GetDataObject</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
	mat<span style="color: #000000;">[</span><span style="color: #0000dd;">0</span><span style="color: #000000;">]</span><span style="color: #000000;">[</span><span style="color: #0000dd;">0</span><span style="color: #000000;">]</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span> <span style="color: #000040;">+</span> 2.5i;
<span style="color: #000000;">}</span></pre>
<h2><a name="DataRange"></a><span class="mw-headline">DataRange</span></h2>
<p><b>DataRange</b> クラスは、ワークシート、行列、グラフウィンドウでデータを取得したり、配置する広範なメカニズムを提供します。  
</p>
<h3><a name="Data_Range_in_WorksheetWorksheet.2C_Data_Range_SelectionData_Range.2C_from_Worksheet"></a><span class="mw-headline">ワークシート内のデータ範囲<span class="OIndex" style="display:none">Worksheet, Data Range Selection</span><span class="OIndex" style="display:none">Data Range, from Worksheet</span></span></h3>
<p>ワークシートに対しては、データ範囲は、1列、1行、部分範囲、1つのセル、ワークシート全体として列と行のインデックスを指定することができます。
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// アクティブワークシートの1行目から5行目までのすべての列と行の </span>
<span style="color: #008000;">// データ範囲を構築</span>
Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
<span style="color: #0000ff;">int</span> r1 <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>, c1 <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>, r2 <span style="color: #000080;">=</span> <span style="color: #0000dd;">4</span>, c2 <span style="color: #000080;">=</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>;

DataRange dr;
<span style="color: #008000;">// 範囲名は&quot;X&quot;, &quot;Y&quot;</span>
<span style="color: #008000;">// &quot;ED&quot;(Yエラー), &quot;Z&quot;のようなわかりやすいものにする。
データ範囲は、従属または独立のデータ型に属さなければ</span>
<span style="color: #008000;">// デフォルトは &quot;X&quot;</span>
dr.<span style="color: #000000;">Add</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;X&quot;</span>, wks, r1, c1, r2, c2<span style="color: #000000;">)</span>;</pre>
<p>データ範囲からvectorにデータを取得します。<b><a href="../../OriginC/OriginC/DataRange-GetData.html" title="OriginC:DataRange-GetData">DataRange::GetData</a></b> は、複数のオーバーロードしたメソッドをサポートします。例えば、
</p>
<pre class="oc" style="font-family:monospace;">vector vData;
<span style="color: #0000ff;">int</span> index <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; <span style="color: #008000;">// 範囲インデックス</span>
dr.<span style="color: #000000;">GetData</span><span style="color: #000000;">(</span><span style="color: #000040;">&amp;</span>vData, index<span style="color: #000000;">)</span>;</pre>
<h3><a name="Data_Range_in_MatrixsheetMatrix_Sheet.2C_Data_Range_SelectionData_Range.2C_from_Matrix"></a><span class="mw-headline">行列シート内のデータ範囲<span class="OIndex" style="display:none">Matrix Sheet, Data Range Selection</span><span class="OIndex" style="display:none">Data Range, from Matrix</span></span></h3>
<p>行列ウィンドウに対しては、データ範囲は行列オブジェクトインデックスにすることができます。 
</p>
<pre class="oc" style="font-family:monospace;">MatrixLayer ml <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;

DataRange dr;
<span style="color: #0000ff;">int</span> nMatrixObjectIndex <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
dr.<span style="color: #000000;">Add</span><span style="color: #000000;">(</span>ml, nMatrixObjectIndex, <span style="color: #ff00ff;">&quot;X&quot;</span><span style="color: #000000;">)</span>;</pre>
<p>データ範囲からmatrixにデータを取得します。 
</p>
<pre class="oc" style="font-family:monospace;">matrix mat;
dr.<span style="color: #000000;">GetData</span><span style="color: #000000;">(</span>mat<span style="color: #000000;">)</span>;</pre>
<h3><a name="Data_Range_in_GraphGraph_Layer.2C_Data_Range_SelectionData_Range.2C_from_Graph"></a><span class="mw-headline">グラフ内のデータ範囲<span class="OIndex" style="display:none">Graph Layer, Data Range Selection</span><span class="OIndex" style="display:none">Data Range, from Graph</span></span></h3>
<p>グラフウィンドウに対して、データ範囲はデータプロットの1つまたは1つのデータプロットの部分範囲にすることができます。
</p>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
DataPlot dp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// アクティブデータプロットを取得</span>

DataRange dr;
<span style="color: #0000ff;">int</span> i1 <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; <span style="color: #008000;">// 最初のデータポイントから</span>
<span style="color: #0000ff;">int</span> i2 <span style="color: #000080;">=</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>; <span style="color: #008000;">// 最後のデータポイントまで</span>
dp.<span style="color: #000000;">GetDataRange</span><span style="color: #000000;">(</span>dr, i1, i2<span style="color: #000000;">)</span>;</pre>
<p>データ範囲オブジェクトでデータプロットからXYデータをvectorに取得します。
</p>
<pre class="oc" style="font-family:monospace;">vector vx, vy;
DWORD dwRules <span style="color: #000080;">=</span> DRR_GET_DEPENDENT;
dr.<span style="color: #000000;">GetData</span><span style="color: #000000;">(</span>dwRules, <span style="color: #0000dd;">0</span>, <span style="color: #0000ff;">NULL</span>, <span style="color: #0000ff;">NULL</span>, <span style="color: #000040;">&amp;</span>vy, <span style="color: #000040;">&amp;</span>vx<span style="color: #000000;">)</span>;</pre>
<h3><a name="Data_Range_ControlData_Selector"></a><span class="mw-headline"><span class="OIndex">データ範囲を制御する</span><span class="OIndex" style="display:none">Data Selector</span></span></h3>
<p>OriginCは、データ範囲を選択するためにGetNダイアログをサポートしています。 
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>GetNBox.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span>
<span style="color: #008000;">// ダイアログを開き、1つのグラフデータプロットから範囲を選択</span>
<span style="color: #008000;">// この選択でデータ範囲オブジェクトを構築</span>
GETN_TREE<span style="color: #000000;">(</span>tr<span style="color: #000000;">)</span>	
GETN_INTERACTIVE<span style="color: #000000;">(</span>Range1, <span style="color: #ff00ff;">&quot;Select Range&quot;</span>, <span style="color: #ff00ff;">&quot;&quot;</span><span style="color: #000000;">)</span>	
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> GetNBox<span style="color: #000000;">(</span>tr<span style="color: #000000;">)</span> <span style="color: #000000;">)</span> <span style="color: #008000;">// OKボタンで true を返す</span>
<span style="color: #000000;">{</span>
	
	DataRange dr;
	dr.<span style="color: #000000;">Add</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Range1&quot;</span>, tr.<span style="color: #000000;">Range1</span>.<span style="color: #000000;">strVal</span><span style="color: #000000;">)</span>;
	
	vector vData;
	<span style="color: #0000ff;">int</span> index <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; <span style="color: #008000;">// 範囲インデックス</span>
	dr.<span style="color: #000000;">GetData</span><span style="color: #000000;">(</span><span style="color: #000040;">&amp;</span>vData, index<span style="color: #000000;">)</span>; <span style="color: #008000;">// TvData内のデータは選択したデータポイント</span>
<span style="color: #000000;">}</span></pre>







    