<h1 class="firstheading">Hello Worldダイアログ</h1>
<p><span class="OIndex" style="display: none;">Hello Worldダイアログ</span><span class="OIndex" style="display: none;">Dialog Builder</span></p>
<div id="toc" class="toc">
<div id="toctitle">
<h2>目次</h2>
</div>
<ol>
<li class="toclevel-1 tocsection-1"><a href="#Create_Resource_DLL_in_VC"><span class="tocnumber">1</span> <span class="toctext">VCでリソースDLLを作成する</span></a>
<ol>
<li class="toclevel-2 tocsection-2"><a href="#Create_by_Origin_Dialog_AppWizardDialog.2C_Resource_DLL_Created_by_Origin_Dialog_AppWizard"><span class="tocnumber">1.1</span> <span class="toctext">Origin Dialog AppWizardで作成する<span class="OIndex" style="display: none;">Dialog, Resource DLL Created by Origin Dialog AppWizard</span></span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Dialog.2C_Resource_DLL_Created_by_Win32_Dynamic-Link_LibraryCreate_by_Win32_Dynamic-Link_Library"><span class="tocnumber">1.2</span> <span class="toctext"><span class="OIndex" style="display: none;">Dialog, Resource DLL Created by Win32 Dynamic-Link Library</span>Win32 ダイナミックリンクライブラリで作成する</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Dialog.2C_Resource_DLL_Created_by_Visual_Studio_2008Create_Resource-only_DLL_in_Visual_Studio_2008"><span class="tocnumber">1.3</span> <span class="toctext"><span class="OIndex" style="display: none;">Dialog, Resource DLL Created by Visual Studio 2008</span>Visual Studio 2008でリソースのみのDLLを作成する</span></a></li>
</ol>
</li>
<li class="toclevel-1 tocsection-5"><a href="#Use_Resource_DLL_in_Origin_CDialog.2C_Use_Resource_DLL_in_Origin_CModal_Dialog"><span class="tocnumber">2</span> <span class="toctext">Origin CでリソースDLLを使用する<span class="OIndex" style="display: none;">Dialog, Use Resource DLL in Origin C</span><span class="OIndex" style="display: none;">Modal Dialog</span></span></a></li>
</ol>
</div>
<h2><a name="Create_Resource_DLL_in_VC" id="Create_Resource_DLL_in_VC"></a><span class="mw-headline">VCでリソースDLLを作成する</span></h2>
<h3><a name="Create_by_Origin_Dialog_AppWizardDialog.2C_Resource_DLL_Created_by_Origin_Dialog_AppWizard" id="Create_by_Origin_Dialog_AppWizardDialog.2C_Resource_DLL_Created_by_Origin_Dialog_AppWizard"></a><span class="mw-headline">Origin Dialog AppWizardで作成する<span class="OIndex" style="display: none;">Dialog, Resource DLL Created by Origin Dialog AppWizard</span></span></h3>
<ol>
<li>Visual C++ 6.0を開始し、ファイル-&gt;新規を選択し、新しいダイアログを開きます。プロジェクトタブで、Origin Dialog AppWizardを選択し、プロジェクト名を"ODialog"にセットし、場所を選択して、OKをクリックします。</li>
<li>シンプルダイアログを選び、次へをクリックします。</li>
<li>Origin Cを選択したまま、完了をクリックし、OKをクリックします。1つのシンプルダイアログを持つリソースファイルとそれに関連したソースファイルおよびヘッダファイルが生成されます。</li>
<li>ビルド-&gt;アクティブな構成の設定メニューを選択し、デバックまたはリリースを選びます。</li>
<li>ビルド-&gt;ODialog.dllのビルドを選択し、DLLを作成します。</li>
<li>上記で指定したファイルの場所に移動します。DLLファイルをDebugまたはReleaseフォルダの外側にコピーし、DLLファイルのパスをODialog.cppファイルのパスと同じにします。</li>
<li>Origin CのコードビルダでODialog.cppファイルを開き、コンパイルし、DoMyDialog関数を実行して、ダイアログを開きます。</li>
</ol>
<h3><a name="Dialog.2C_Resource_DLL_Created_by_Win32_Dynamic-Link_LibraryCreate_by_Win32_Dynamic-Link_Library" id="Dialog.2C_Resource_DLL_Created_by_Win32_Dynamic-Link_LibraryCreate_by_Win32_Dynamic-Link_Library"></a><span class="mw-headline"><span class="OIndex" style="display: none;">Dialog, Resource DLL Created by Win32 Dynamic-Link Library</span>Win32 ダイナミックリンクライブラリで作成する</span></h3>
<p>このセクションは、Visual C++ 6.0でリソースのみのDLLを作成する方法について説明しています。</p>
<ol>
<li>Visual C++ 6.0を開始し、ファイル-&gt;新規を選択し、新しいダイアログを開きます。プロジェクトタブで、プロジェクトテンプレートとしてWin32ダイナミックリンクライブラリを選択し、プロジェクト名をODialogにセットし、場所を選択して、OKをクリックします。現れたダイアログで、シンプルDLLプロジェクトを選び、完了をクリックします。</li>
<li>プロジェクト-&gt;設定を選び、プロジェクト設定ダイアログを開きます。リソースタブで、ODialog.resのようなリソースファイル名をセットし、ソフトウェア設定に従って言語を選択し、OKをクリックします。</li>
<li>挿入-&gt;リソースを選び、プロジェクトにリソースを挿入します。ダイアログとそのコントロールに対して、ダイアログIDをIDD_OC_DIALOGにセットします。</li>
<li>ファイル-&gt;名前を付けて保存を選び、リソーススクリプトをODialog.rcとして保存します。プロジェクト-&gt;プロジェクトに追加-&gt;ファイルを選び、ODialog.rcファイルを選び、プロジェクトに追加します。</li>
<li>言語が英語でなければ、このステップを行います。ワークスペースビューのリソースタブで、リストツリーを開き、IDD_OC_DIALOGを右クリックし、プロパティを選び、ダイアログで言語をニュートラルを選びます。</li>
<li>デバッグまたはリリースの構成で、プロジェクト全体をビルドします。結果のDLLファイルが、DebugまたはReleaseサブフォルダに生成されます。</li>
</ol>
<h3><a name="Dialog.2C_Resource_DLL_Created_by_Visual_Studio_2008Create_Resource-only_DLL_in_Visual_Studio_2008" id="Dialog.2C_Resource_DLL_Created_by_Visual_Studio_2008Create_Resource-only_DLL_in_Visual_Studio_2008"></a><span class="mw-headline"><span class="OIndex" style="display: none;">Dialog, Resource DLL Created by Visual Studio 2008</span>Visual Studio 2008でリソースのみのDLLを作成する</span></h3>
<p>Visual Studio 2008でリソースのみのDLLを作成する一般的な処理について説明しています。以下のステップは、OriginからOrigin Cを使ってアクセスするリソースのみのDLLをVS2008で作成する方法を示しています。</p>
<ol>
<li>Microsoft Visual Studio 2008を起動します。</li>
<li>ファイル-&gt;新規-&gt;プロジェクトを選択し、新しいプロジェクトを作成します。</li>
<li>新しいプロジェクトダイアログで、プログラム言語としてVisual C++を選び、テンプレートとしてWin32プロジェクトを選び、プロジェクト名には"Welcome"とし、その場所を下記のように選択して、OKをクリックします。<br />
<a class="image"><img alt="New Project vs2008.png" src="../images/Simple_Hello_World_Dialog/New_Project_vs2008.png" width="540" height="425" border="0" /></a></li>
<li>Win32アプリケーションウィザードダイアログで、アプリケーションの種類をDLLにして、完了ボタンをクリックします。<br />
<a class="image"><img alt="App Settings vs2008.png" src="../images/Simple_Hello_World_Dialog/App_Settings_vs2008.png" width="520" height="389" border="0" /></a></li>
<li>プロジェクトのリソースビューに切り替え、プロジェクト名を右クリックして、リソースを追加し、リソースの種類はDialogを選択して、新規作成をクリックします。<br />
<a class="image"><img alt="AddResource vs2008.png" src="../images/Simple_Hello_World_Dialog/AddResource_vs2008.png" width="366" height="261" border="0" /></a></li>
<li>ソフトウェア環境に従って、リソースの言語プロパティをセットすることを忘れないようにしてください。英語のソフトウェアであれば、English(United States) です。<br />
<a class="image"><img alt="DlgProperty vs2008.png" src="../images/Simple_Hello_World_Dialog/DlgProperty_vs2008.png" width="295" height="256" border="0" /></a></li>
<li>希望のコントロールを追加し、プロジェクトの構成をDebugまたはReleaseにし、プロジェクトを保存します。そして、ビルド&gt;ソリューションのビルドまたはソリューションのリビルドを選び、プロジェクトをビルドします。 ソリューションフォルダにDLLを含む"Debug"または"Release"というフォルダが生成されます。このソリューションで生成したファイルは、次のものです。<br />
<a class="image"><img alt="WelcomeFileTree.png" src="../images/Simple_Hello_World_Dialog/WelcomeFileTree.png" width="517" height="393" border="0" /></a></li>
</ol>
<h2><a name="Use_Resource_DLL_in_Origin_CDialog.2C_Use_Resource_DLL_in_Origin_CModal_Dialog" id="Use_Resource_DLL_in_Origin_CDialog.2C_Use_Resource_DLL_in_Origin_CModal_Dialog"></a><span class="mw-headline">Origin CでリソースDLLを使用する<span class="OIndex" style="display: none;">Dialog, Use Resource DLL in Origin C</span><span class="OIndex" style="display: none;">Modal Dialog</span></span></h2>
<p>このセクションでは、上記で作成したリソースのみのDLLを使用する方法を説明しています。</p>
<ol>
<li>DLLファイルをDebugまたはReleaseフォルダの外側にコピーし、DLLファイルのパスをresource.hファイルのパスと同じにします。</li>
<li>Originを起動し、コードビルダを開きます。</li>
<li>DLLファイルのパスにtestODialog.cという新しいOrigin Cファイルが作成されます。現在のワークスペースに追加し、次のようにテスト用のコードを記述します。OpenDlg関数を実行し、ダイアログボックスを開きます。
<pre class="oc" style="font-family: monospace;">
<span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>Dialog.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span><span style="color: #0000ff;">
#include</span> <span style="color: #000080;">&lt;</span>..\Originlab\Resource.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span> <span style="color: #008000;">//ODialog リソースヘッダ</span><span style="color: #0000ff;">
class</span> MyDialog <span style="color: #000000;">:</span> <span style="color: #0000ff;">public</span> Dialog<span style="color: #000000;">
{</span><span style="color: #0000ff;">
public</span><span style="color: #000000;">:</span>
        <span style="color: #008000;">// ダイアログIDとDLL名を持つダイアログを作成</span>
        <span style="color: #008000;">// "ODialog" はDLLファイル名</span>
        <span style="color: #008000;">// パスを指定しなければ、DLLファイルがこのOrigin Cファイルと</span>
        <span style="color: #008000;">// 同じパスにあるということ</span>
        <span style="color: #008000;">// DLLが別の場所にある場合、DLLの</span>
        <span style="color: #008000;">// フルパスを使用</span>
        MyDialog<span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000;">:</span> Dialog<span style="color: #000000;">(</span>IDD_OC_DIALOG, <span style="color: #ff00ff;">"ODialog"</span><span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
        <span style="color: #000000;">}</span>
 <span style="color: #000000;">
}</span>;<span style="color: #0000ff;">
void</span> OpenDlg<span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">
{</span>
        MyDialog odlg;
        odlg.<span style="color: #000000;">DoModal</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;<span style="color: #000000;">
}</span>
</pre></li>
</ol>
