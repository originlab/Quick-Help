<h1 class="firstheading">コンパイル、リンク、ロード</h1><p><br />
Origin C関数にアクセスする前に、<a href="../../OriginC/OCGuide/Create_and_Edit_an_Origin_C_File.html#Overview" title="OCGuide:Create and Edit an Origin C File">コードビルダ</a>でコンパイルしてリンク(ビルド)する必要があります。  
</p><p>エラー無く関数をコンパイルリンクしたら、自動的にロードされ、現在のOriginセッションでアクセスできます。以降のOriginセッションで関数にアクセスするには、再ロードし、リンクする必要があります。この処理は素早く、自動化することができます。  
</p><p>この章では、Origin Cのソースファイルとプリプロセスファイルを手動または自動でビルドする方法について説明します。 
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Compiling_and_LinkingCompile_and_Link_Source_Files"><span class="tocnumber">1</span> <span class="toctext">コンパイルとリンク<span class="OIndex" style="display:none">Compile and Link Source Files</span></span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Add_the_File_to_the_WorkspaceWorkspace.2C_Load_Files"><span class="tocnumber">1.1</span> <span class="toctext">ワークスペースにファイルを追加<span class="OIndex" style="display:none">Workspace, Load Files</span></span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Compile_the_File"><span class="tocnumber">1.2</span> <span class="toctext">ファイルをコンパイルする</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Build_the_Workspace"><span class="tocnumber">1.3</span> <span class="toctext">ワークスペースをビルドする</span></a>
<ul>
<li class="toclevel-3 tocsection-5"><a href="#Build_vs._Build_All"><span class="tocnumber">1.3.1</span> <span class="toctext">ビルドとすべてをビルドの違い</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Automated_Building"><span class="tocnumber">2</span> <span class="toctext">ビルドの自動化 </span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#Add_files_to_the_Project_FolderBuilding_Origin_C_File_with_Project"><span class="tocnumber">2.1</span> <span class="toctext">Projectフォルダにファイルを追加する<span class="OIndex" style="display:none">Building Origin C File with Project</span></span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Add_files_to_the_User_.5BAutoLoad.5D_FolderBuilding_Origin_C_Files_under_Workspace_System_Folder"><span class="tocnumber">2.2</span> <span class="toctext">[AutoLoad]フォルダにファイルを追加する<span class="OIndex" style="display:none">Building Origin C Files under Workspace System Folder</span></span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Build_Workspace_on_Origin_StartupBuilding_on_Startup"><span class="tocnumber">2.3</span> <span class="toctext">Origin起動時にワークスペースをビルド<span class="OIndex" style="display:none">Building on Startup</span></span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Build_Individual_Source_File_on_Origin_Startup"><span class="tocnumber">2.4</span> <span class="toctext">Origin起動時にソースファイルをビルド</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-11"><a href="#Building_by_ScriptBuilding_with_Dependent_Files"><span class="tocnumber">3</span> <span class="toctext"><span class="OIndex">スクリプトでビルドする</span><span class="OIndex" style="display:none">Building with Dependent Files</span></span></a></li>
<li class="toclevel-1 tocsection-12"><a href="#Identifying_ErrorsBuilding.2C_Handle_Compiling_and_Linking_Error"><span class="tocnumber">4</span> <span class="toctext">エラーを識別する<span class="OIndex" style="display:none">Building, Handle Compiling and Linking Error</span></span></a></li>
</ul>
</div>

<h2><a name="Compiling_and_LinkingCompile_and_Link_Source_Files"></a><span class="mw-headline">コンパイルとリンク<span class="OIndex" style="display:none">Compile and Link Source Files</span></span></h2>
<p>Origin Cのソースファイルまたはプリプロセスファイルで定義した関数を作成するため、以下のステップを行う必要があります。 
</p>
<ul><li> コードビルダワークスペースにファイルを追加 </li>
<li> ファイルをコンパイル</li>
<li> すべての関連ファイルをリンクし、必要に応じて関連ファイルもコンパイルして、作成したオブジェクトファイルをロード</li></ul>
<p>すべてのファイルをコンパイルし、リンクする処理はビルドとして扱われます。 
</p>
<h3><a name="Add_the_File_to_the_WorkspaceWorkspace.2C_Load_Files"></a><span class="mw-headline">ワークスペースにファイルを追加<span class="OIndex" style="display:none">Workspace, Load Files</span></span></h3>
<p>ソースファイルまたはプリプロセスファイルをコンパイルリンクする前に、ファイルは、<b>コードビルダ</b>ワークスペースフォルダである<a href="../../OriginC/OCGuide/Create_and_Edit_an_Origin_C_File.html#Code_Builder_Folder_Structure" title="OCGuide:Origin Cファイルの作成と編集">Project, User, System, Temporary</a>の内の1つに追加する必要があります。   すべてのソースファイルは、最初に作成されるか、Userフォルダにロードされます。 
</p>
<h3><a name="Compile_the_File"></a><span class="mw-headline">ファイルをコンパイルする</span></h3>
<p>ファイルをワークスペースに追加した後、 (<b>コンパイル</b>ボタン<a  class="image"><img alt="Compile button.png" src="../images/Compiling,_Linking_and_Loading/Compile_button.png" width="24"  /></a>をクリックして)コンパイルし、オブジェクトファイルを生成する必要があります。オブジェクトファイルは、ソースファイルまたはプリプロセスファイルと同じ名前で、<b>OCB</b> という拡張子を持ちます。Origin8.1以降、オブジェクトファイルは、<b>アプリケーションデータ</b>フォルダに保存されます。古いバージョンでは、ファイルは<b> User Files\OCTemp</b> フォルダに保存されます。
</p>
<h3><a name="Build_the_Workspace"></a><span class="mw-headline">ワークスペースをビルドする</span></h3>
<p>アクティブなファイルとすべての関連ファイルをビルドするには、<b>ビルド</b> <a  class="image"><img alt="Build Button.png" src="../images/Compiling,_Linking_and_Loading/Build_Button.png" width="24"  /></a>ボタンを選択するか、<b>すべてをリビルド</b> <a  class="image"><img alt="Rebuild All button.png" src="../images/Compiling,_Linking_and_Loading/Rebuild_All_button.png" width="22"  /></a>ボタンを選択し、ワークスペース内のすべてのファイルをビルドします。作成したオブジェクトファイルは、自動的にメモリにロードされ、リンクされ、ファイルに定義した関数はOriginの中で実行可能になります。
</p><p>オブジェクトファイルが生成されると、その後のビルド処理がより高速になります。ソースファイルとプリプロセスファイルに変更が無ければ、<b>コードビルダ</b>はオブジェクトファイルを直接ロードし、リンクしますが、ファイルをリビルドしません。  
</p>
<h4><a name="Build_vs._Build_All"></a><span class="mw-headline">ビルドとすべてをビルドの違い</span></h4>
<p><b>ビルド</b>：与えられたフォルダがコードビルダでアクティブフォルダで、ビルドツールバーボタン <a  class="image"><img alt="Button Build.png" src="../images/Compiling,_Linking_and_Loading/Button_Build.png" width="22"  /></a>がクリックされると、そのフォルダ内のすべてのファイルがコンパイルリンクされます。 
</p><p><b>すべてをビルド</b>：コードビルダのすべてをリビルドボタン<a  class="image"><img alt="Button Rebuild All.png" src="../images/Compiling,_Linking_and_Loading/Button_Rebuild_All.png" width="22"  /></a>がクリックされると、コードビルダの<i><b>すべて</b></i> のフォルダ内のファイルがコンパイルリンクされます。 
</p>
<h2><a name="Automated_Building"></a><span class="mw-headline">ビルドの自動化 </span></h2>
<p>最初に、すべてのOrigin CソースファイルまたはプリプロセスファイルがUserフォルダ内で作成され、開かれます。そして、上記のようにOrigin Cソースファイルを手動でビルドします。  しかし、ビルド処理を自動化するとメリットがあります。これは、コードビルダのフォルダ構造を使用することで行なったり、機能的に少しの違いがあったり、<b>起動時のビルド</b>オプションを利用して、行うことができます。 
</p>
<h3><a name="Add_files_to_the_Project_FolderBuilding_Origin_C_File_with_Project"></a><span class="mw-headline">Projectフォルダにファイルを追加する<span class="OIndex" style="display:none">Building Origin C File with Project</span></span></h3>
<p>コードビルダの<b>Projectフォルダ</b>にファイルを追加すると、関連のOriginプロジェクトが開いたときに、自動的にビルドされます。 
</p><p>次の方法で、<b>Project</b>フォルダにファイルを追加できます。 
</p>
<ul><li> Projectフォルダを右クリックして、<b>ファイルの追加</b>を選びます。 </li>
<li> 別のワークスペースフォルダからファイルをドラッグし、Projectフォルダにドロップします。</li></ul>
<h3><a name="Add_files_to_the_User_.5BAutoLoad.5D_FolderBuilding_Origin_C_Files_under_Workspace_System_Folder"></a><span class="mw-headline">[AutoLoad]フォルダにファイルを追加する<span class="OIndex" style="display:none">Building Origin C Files under Workspace System Folder</span></span></h3>
<p>以前は、コードビルダの<b>System</b>フォルダを右クリックして<b>ファイルを追加</b>できました。Origin 2015以降、このフォルダにユーザーファイルを追加することはできません。Originの起動時に自動的にファイルをコンパイルリンクさせるには、これらのファイルを<b>User [Autoload]</b> fフォルダに追加する必要があります。  
</p><p><b>User [AutoLoad]</b>フォルダにファイルを追加するには次のようにします。 
</p>
<ul><li> User [AutoLoad] フォルダを右クリックして、<b>ファイルの追加</b>を選択します。 </li>
<li> 他のワークスペースフォルダからファイルをドラッグして、 User [AutoLoad]フォルダにドロップします。</li>
<li> <a class="external text" href="../../LabTalk/LabTalk/Run_(object).html#Methods:"><b>run.LoadOC()</b>オブジェクト</a>を使用します。</li></ul>
<p><br />
</p>
<table class="note">

<tr>
<td><b>Note</b>: <b>User [AutoLoad]</b>フォルダにファイルを追加すると、<b>[OriginCAuto]</b>というセクションが<a class="external text" href="../../UserGuide/UserGuide/The_User_Files_Folder.html">User Files フォルダ</a>のOrigin.iniファイルに追加されます。<b>User [AutoLoad]</b>からファイルを同時に削除し、Origin.iniから追加された<b>[OriginCAuto]</b>を削除するには、<a class="external text" href="../../LabTalk/LabTalk/Run_(command).html#-cra.3B_Remove_Temp_and_User_files_from_Code_Builder_Workspace">次の LabTalkコマンド</a>を実行します。 
<pre class="lt" style="font-family:monospace;">run <span style="color: #000080;">-</span>cra <span style="color: #008000;">// システムフォルダファイルには影響しません</span></pre>
</td></tr></table>
<h3><a name="Build_Workspace_on_Origin_StartupBuilding_on_Startup"></a><span class="mw-headline">Origin起動時にワークスペースをビルド<span class="OIndex" style="display:none">Building on Startup</span></span></h3>
<p><b>起動時にビルド</b>オプションは、Origin起動時に直前に開いたコードビルダワークスペースをビルドします。  
</p><p>Originが起動したときに、Origin Cワークスペースの<b>System</b>フォルダの内容を確認し、変更が見つかったら、コンパイルリンクしようとします。   また、<b>起動にビルド</b>オプションを有効にして、<b>ユーザ</b>フォルダ内のファイルにこの手順を行うことができます。 
</p>
<ol><li> コードビルダを実行します。 </li>
<li> ワークスペースが見えていない場合、<b>表示</b>メニューの<b>ワークスペース</b>を選びます。 </li>
<li> <b>Origin Cワークスペース</b>を右クリックします。 </li>
<li> <b>起動にビルド</b>の項目がチェックされていない場合、クリックします。</li></ol>
<p>次回Originを起動すると、Userフォルダ内のファイルがチェックされ、変更があったファイルをコンパイルリンクします。
</p>
<h3><a name="Build_Individual_Source_File_on_Origin_Startup"></a><span class="mw-headline">Origin起動時にソースファイルをビルド</span></h3>
<p>次の操作方法で、起動時にOrigin Cソースファイルをロードし、コンパイルするために Origin.ini ファイルを編集します。 
</p>
<ol><li> Originが開いていたら閉じます。Origin.ini ファイルを開きます。このファイルはユーザファイルフォルダにあります。コマンドウィンドウで %Y= を実行すると、ユーザファイルフォルダの場所を確認できます。  </li>
<li> <b>[Config]</b> セクションで、OgsN = OEvents の行のセミコロン(;)をとり、コメントとして扱うのをやめます。Nは、使用されている数字でなければ、何でも構いません。変更後、保存してファイルを閉じます。</li>
<li> Originのインストールフォルダにある、OEvents.ogs を開きます。<b>[AfterCompileSystem] </b>セクションに以下の行を追加します。  <pre class="lt" style="font-family:monospace;">run.<span style="color: #000080;">LoadOC</span><span style="color: #000000;">(</span>Originlab\AscImpOptions, <span style="color: #0000dd;">16</span><span style="color: #000000;">)</span>;</pre> OEvents.ogsをユーザーファイルフォルダ（編集したOrigin.iniファイルと同じ場所）に保存し、エディタを閉じます。 </li>
<li> Originを再度起動し、コードビルダを開きます。Temporaryフォルダに3つのファイルがあります。AscImpOptions は、fu_utils.c と Import_utils.c に依存するので、コンパイラはこれら2つのファイルを一緒にAscImpをコンパイルします。詳細はLabTalkヘルプで、 <b>run.LoadOC</b>を検索して確認してください。</li></ol>
<p><br />
または、ワークスペースの<i><b>User [AutoLoad]</b></i>フォルダを使用してください。フォルダに追加されたファイルは、Originの起動時に自動的にロードされます（<a href="#Add_files_to_the_User_.5BAutoLoad.5D_FolderBuilding_Origin_C_Files_under_Workspace_System_Folder">上記参照</a>）。 
</p>
<h2><a name="Building_by_ScriptBuilding_with_Dependent_Files"></a><span class="mw-headline"><span class="OIndex">スクリプトでビルドする</span><span class="OIndex" style="display:none">Building with Dependent Files</span></span></h2>
<p>LabTalkスクリプトでOrigin Cを呼び出したい場合、ソースファイルのコンパイルとリンクが完了していることを確認する必要があります。その後、LabTalkコマンド <i>Run.LoadOC</i> を使用して、特定のソースファイルをコンパイルし、リンクします。例えば
</p>
<ol><li>コードビルダで、ファイル: 新規ワークスペースを選択して新しいワークスペースを作成します。   ここでは、Temporary フォルダは空です。  </li>
<li>コマンドウィンドウで、次のスクリプトを実行します。すると <i>dragNdrop.c </i>ファイルとその関連ファイルすべてがTemporaryフォルダにロードされ、コンパイルされます。 
<pre class="lt" style="font-family:monospace;">if<span style="color: #000000;">(</span>run.<span style="color: #000080;">LoadOC</span><span style="color: #000000;">(</span>OriginLab\dragNdrop.<span style="color: #000080;">c</span>, <span style="color: #0000dd;">16</span><span style="color: #000000;">)</span> <span style="color: #000080;">!</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
        type <span style="color: #ff00ff;">&quot;Failed to load dragNdrop.c!&quot;</span>;
        return <span style="color: #0000dd;">0</span>;
<span style="color: #000000;">}</span></pre></li>
</ol>
<h2><a name="Identifying_ErrorsBuilding.2C_Handle_Compiling_and_Linking_Error"></a><span class="mw-headline">エラーを識別する<span class="OIndex" style="display:none">Building, Handle Compiling and Linking Error</span></span></h2>
<p>コードビルダでソースファイルをコンパイルリンクするとき、コンパイルおよびリンクの結果はコードビルダの<b>出力</b>ウィンドウに表示されます。 
</p><p>コンパイルリンクが問題なく行われた場合、<b>出力</b>ウィンドウにはソースファイルがコンパイルされたことが表示されます。   <b>完了!</b> と表示され、問題がなかったことが分かります。  
</p><p>コンパイルリンク中にエラーが発生したら、<b>出力</b>ウィンドウには、ファイル名、行番号、エラーが発生したことが表示されます。   <b>出力</b>ウィンドウ内のエラー行をダブルクリックすると、ソースファイルをアクティブにし、エラーを含むコード行にカーソルを移動します。<br />
</p><p><a  class="image"><img alt="Compiling originc.png" src="../images/Compiling,_Linking_and_Loading/Compiling_originc.png" width="463"  /></a>
</p>






    