<h1 class="firstheading">SQLiteデータベースへのアクセス</h1><p><span class="OIndex" style="display:none">SQLite</span>
</p><p><br />
<b>SQLite</b> は、内蔵型で、サーバおよび設定不要なSQLデータベースエンジンを組み込んだソフトウェアライブラリで、世界で最も幅広く使われているSQLデータベースとされています。高度な機能があるので、SQLiteはさまざまな業務分野やシステムで広く使われています。
</p><p><b>SQLite3</b>は、最新のバージョンです。Originは、Origin Cから32bit、64bitのSQLiteデータベースにアクセスするDLLを提供しています。SQLite3 APIのプロトタイプを含むヘッダファイルを含める必要があります。
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>oc_Sqlite.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span></pre>
<p>これらの関数の使い方の簡単なサンプルがヘッダファイルの最後にあります。
</p><p>Origin Cは、SQLiteへのアクセスをより簡単にするラッパークラス<b>OSQLite</b>も提供しています。  このOrigin Cクラスを使うには、次のように、このクラスを含むヘッダファイルが含まれている必要があります。
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">//DataSet1.1.dbはデータベースファイルで、これはOriginlabという名前のテーブルを含む</span>
<span style="color: #008000;">//テーブルは次のステートメントで作成</span>
<span style="color: #008000;">//CREATE TABLE OriginLab(ID INTEGER NOT NULL, NUMBER INTEGER NOT NULL, SALARY INTE</span>
<span style="color: #008000;">//GER NOT NULL, Data BLOB NOT NULL);</span>
<span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>..\Originlab\oSQLite.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span> <span style="color: #008000;">//必要なヘッダファイル</span>
<span style="color: #0000ff;">#define</span>	STR_DATABASE_FILE	<span style="color: #ff00ff;">&quot;E:<span style="color: #666666; font-weight: bold;">\\</span>DataSet1.1.db&quot;</span>
<span style="color: #0000ff;">#define</span>	STR_QUERY_STRING	<span style="color: #ff00ff;">&quot;select * from Originlab limit 80&quot;</span>
<span style="color: #0000ff;">void</span> test_OSQLite<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
	OSQLite sqlObj<span style="color: #000000;">(</span>STR_DATABASE_FILE<span style="color: #000000;">)</span>;	
	LPCSTR lpSQL <span style="color: #000080;">=</span> STR_QUERY_STRING;
	sqlObj.<span style="color: #000000;">Select</span><span style="color: #000000;">(</span>lpSQL<span style="color: #000000;">)</span>;
	Worksheet wks;
	wks.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Origin&quot;</span><span style="color: #000000;">)</span>;
	sqlObj.<span style="color: #000000;">Import</span><span style="color: #000000;">(</span>wks<span style="color: #000000;">)</span>;
	<span style="color: #008000;">//データを修正した後、次のコードでデータをエクスポート</span>
	<span style="color: #008000;">//sqlObj.Export(&quot;OriginLab&quot;, wks);</span>
<span style="color: #000000;">}</span></pre>







    