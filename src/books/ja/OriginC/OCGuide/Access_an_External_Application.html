<h1 class="firstheading">外部アプリケーションにアクセス</h1><p><br />
Microsoft Component Object Model（<span class="OIndex">COM</span>）は、アプリケーションがバイナリソフトウェアコンポーネントから構築されるソフトウェアアーキテクチャで、ソフトウェアの開発がより簡単で効率よく行うことができます。 
</p><p>Originは、COMクライアントプログラミングの機能を提供しており、<b>OriginPro</b>でのみサポートされています。  このメカニズムは、すべてのCOM(オートメーションサーバ)オブジェクトを表す<b>オブジェクト</b>タイプを使用します。すべてのCOMオブジェクトは2つの方法で初期化することができます。
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">//CreateObjectメソッドによる</span>
Object oExcel;
oExcel <span style="color: #000080;">=</span> CreateObject<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Excel.Application&quot;</span><span style="color: #000000;">)</span>;

<span style="color: #008000;">//既存のCOMオブジェクトからの初期化による</span>
Object oWorkBooks;
oWorkBooks <span style="color: #000080;">=</span> oExcel.<span style="color: #000000;">Workbooks</span>;</pre>
<p>Origin Cは、<b>Matlab</b>にアクセスするクラスも提供しており、これを使ってOriginとMatlab間の通信を可能にします。 
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>Origin.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span>
<span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>externApps.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span> <span style="color: #008000;">//MATLABクラスに必要なヘッダ</span>
<span style="color: #0000ff;">void</span> test_Matlab<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
    Matlab matlabObj<span style="color: #000000;">(</span><span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span><span style="color: #000040;">!</span>matlabObj<span style="color: #000000;">)</span>
    <span style="color: #000000;">{</span>
        out_str<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;No MATLAB found&quot;</span><span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">return</span>;
    <span style="color: #000000;">}</span>
 
    <span style="color: #008000;">//maという3x5の行列を定義</span>
    string strRet;
    strRet <span style="color: #000080;">=</span> matlabObj.<span style="color: #000000;">Execute</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;ma=[1 2 3 4 5; 
        4 5 6 7 8;10.3 4.5 -4.7 -23.2 -6.7]&quot;</span><span style="color: #000000;">)</span>; 
    out_str<span style="color: #000000;">(</span>strRet<span style="color: #000000;">)</span>;<span style="color: #008000;">// MATLABからstrを表示</span>
 
    <span style="color: #008000;">// 行列をOrigin行列に配置</span>
    MatrixLayer matLayer;
    matLayer.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
    Matrix mao<span style="color: #000000;">(</span>matLayer<span style="color: #000000;">)</span>;
 
    <span style="color: #008000;">//MATLABの行列(ma)をOriginのmao行列に変換</span>
    <span style="color: #0000ff;">BOOL</span> bRet <span style="color: #000080;">=</span> matlabObj.<span style="color: #000000;">GetMatrix</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;ma&quot;</span>, <span style="color: #000040;">&amp;</span>mao<span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span></pre>
<p>Origin CでのCOMクライアントプログラミングは、MS Officeアプリケーションとデータのやりとりを行うのに使用できます。Excelワークシートからデータを読み、Originでグラフを作成し、それをWord文書に配置するサンプルコードを用意しています。これは、Originの<i>\Samples\COM Server and Client\MS Office\Client</i>サブフォルダにあります。 

</p><p>Origin CのCOMプログラミングは、ADO(ActiveX Data Object)にアクセスしてデータベースと接続するのに使用することができ、SQLとAccessデータベースをワークシートにインポートし、データの修正を行った後データベースに戻すサンプルファイルがあります。詳細は、Originの<i>Samples\COM Server and Client\ADO\Client</i> サブフォルダのADOSample.cファイルをご覧ください。 
</p>






    