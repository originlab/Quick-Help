<h1 class="firstheading">文字列データ</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#String_Variables_String.2C_Define_Variables"><span class="tocnumber">1</span> <span class="toctext">文字列変数<span class="OIndex" style="display:none">String, Define Variables</span></span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Convert_String_to_NumericString.2C_Convert_to_IntegerString.2C_Convert_to_DoubleString.2C_Convert_to_Complex"><span class="tocnumber">2</span> <span class="toctext">文字列を数値に変換<span class="OIndex" style="display:none">String, Convert to Integer</span><span class="OIndex" style="display:none">String, Convert to Double</span><span class="OIndex" style="display:none">String, Convert to Complex</span></span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Append_Numeric.2FString_to_another_String"><span class="tocnumber">3</span> <span class="toctext">数値/文字列を別の文字列に追加</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Find_Sub_String"><span class="tocnumber">4</span> <span class="toctext">部分文字列を検索</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Replace_Sub_String"><span class="tocnumber">5</span> <span class="toctext">部分文字列の置換</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Path_String_Functions"><span class="tocnumber">6</span> <span class="toctext">パス文字列関数</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#File_Path_StringString.2C_Check_Path_StringString.2C_Extract_File_Name_from_Full_Path"><span class="tocnumber">6.1</span> <span class="toctext">ファイルパスの文字列<span class="OIndex" style="display:none">String, Check Path String</span><span class="OIndex" style="display:none">String, Extract File Name from Full Path</span></span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Origin_System_PathString.2C_Origin_System_FolderString.2C_User_File_FolderUser_File_Folder"><span class="tocnumber">6.2</span> <span class="toctext"><span class="OIndex">Origin システムパス</span><span class="OIndex" style="display:none">String, Origin System Folder</span><span class="OIndex" style="display:none">String, User File Folder</span><span class="OIndex" style="display:none">User File Folder</span></span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="String_Variables_String.2C_Define_Variables"></a><span class="mw-headline">文字列変数<span class="OIndex" style="display:none">String, Define Variables</span></span></h2>
<pre class="oc" style="font-family:monospace;">string str1; <span style="color: #008000;">// str1という文字列変数を宣言</span>
str1 <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;New York&quot;</span>; <span style="color: #008000;">// str1 に文字列シーケンスを割り当て</span>

string str2 <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Tokyo&quot;</span>; <span style="color: #008000;">// 文字列変数を宣言して割り当て</span>

<span style="color: #008000;">// 文字列配列を宣言して文字列シーケンスで初期化</span>
<span style="color: #0000ff;">char</span> ch<span style="color: #000000;">[</span><span style="color: #000000;">]</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;This is a test!&quot;</span>; 

<span style="color: #008000;">// 文字配列を宣言し、サイズを指定して文字列シーケンスで初期化</span>
<span style="color: #0000ff;">char</span> chArr<span style="color: #000000;">[</span><span style="color: #0000dd;">255</span><span style="color: #000000;">]</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Big World.&quot;</span>;</pre>
<h2><a name="Convert_String_to_NumericString.2C_Convert_to_IntegerString.2C_Convert_to_DoubleString.2C_Convert_to_Complex"></a><span class="mw-headline">文字列を数値に変換<span class="OIndex" style="display:none">String, Convert to Integer</span><span class="OIndex" style="display:none">String, Convert to Double</span><span class="OIndex" style="display:none">String, Convert to Complex</span></span></h2>
<pre class="oc" style="font-family:monospace;">string str <span style="color: #000080;">=</span> PI; <span style="color: #008000;">// 数値を文字変数に割り当て</span>

<span style="color: #008000;">// 文字列を数値に割り当て</span>
<span style="color: #0000ff;">double</span> dd <span style="color: #000080;">=</span> <span style="color: #000000;">atof</span><span style="color: #000000;">(</span>str, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>;
out_double<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;dd=&quot;</span>, dd<span style="color: #000000;">)</span>; <span style="color: #008000;">// dd=3.14159</span>

<span style="color: #008000;">// 文字列を複素数に変換</span>
str <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;1+2.5i&quot;</span>;
complex cc <span style="color: #000080;">=</span> atoc<span style="color: #000000;">(</span>str<span style="color: #000000;">)</span>; 
out_complex<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;cc = &quot;</span>, cc<span style="color: #000000;">)</span>; <span style="color: #008000;">// cc = 1.000000+2.500000i</span>

<span style="color: #008000;">// 文字列を整数型に変換</span>
str <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;100&quot;</span>;
<span style="color: #0000ff;">int</span> nn <span style="color: #000080;">=</span> <span style="color: #000000;">atoi</span><span style="color: #000000;">(</span>str<span style="color: #000000;">)</span>;
out_int<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;nn = &quot;</span>, nn<span style="color: #000000;">)</span>; <span style="color: #008000;">// nn = 100</span></pre>
<h2><a name="Append_Numeric.2FString_to_another_String"></a><span class="mw-headline">数値/文字列を別の文字列に追加</span></h2>
<p><span class="OIndex" style="display:none">String, Append String</span><span class="OIndex" style="display:none">String, Append Numeric</span>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// 数値または文字列を別の文字列に追加</span>
<span style="color: #008000;">// Origin Cでは、,数値/文字列の定数または変数を加えるのに&apos;+&apos;を使う</span>
string str <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;The area is &quot;</span> <span style="color: #000040;">+</span> <span style="color: #0000dd;">30.7</span>; <span style="color: #008000;">// double型の定数を文字列に追加</span>

str <span style="color: #000040;">+</span><span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>; <span style="color: #008000;">// 文字列定数を文字列変数に追加</span>

<span style="color: #0000ff;">int</span> nLength <span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span>;
str <span style="color: #000040;">+</span><span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;The length is &quot;</span> <span style="color: #000040;">+</span> nLength; <span style="color: #008000;">// 整数型変数を文字列に追加</span>

out_str<span style="color: #000000;">(</span>str<span style="color: #000000;">)</span>;</pre>
<h2><a name="Find_Sub_String"></a><span class="mw-headline">部分文字列を検索</span></h2>
<p><span class="OIndex" style="display:none">String, Find</span><span class="OIndex" style="display:none">String, Get Sub String</span>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// 部分文字列を検索して取得</span>
string str <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;[Book1]Sheet1!A:C&quot;</span>;
<span style="color: #0000ff;">int</span> begin <span style="color: #000080;">=</span> str.<span style="color: #000000;">Find</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&apos;]&apos;</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// &apos;]&apos; のインデックスを検索して戻す</span>
begin<span style="color: #000040;">++</span>; <span style="color: #008000;">// ] の次の文字に移動</span>

<span style="color: #0000ff;">int</span> end <span style="color: #000080;">=</span> str.<span style="color: #000000;">Find</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&apos;!&apos;</span>, begin<span style="color: #000000;">)</span>; <span style="color: #008000;">// &apos;!&apos; のインデックスを検索して戻す</span>
end<span style="color: #000040;">--</span>; <span style="color: #008000;">// ! の次の文字に移動</span>

<span style="color: #008000;">// 開始インデックスと部分文字列の長さで部分文字列を取得</span>
<span style="color: #0000ff;">int</span> nLength <span style="color: #000080;">=</span> end <span style="color: #000040;">-</span> begin <span style="color: #000040;">+</span> <span style="color: #0000dd;">1</span>;
string strSheetName <span style="color: #000080;">=</span> str.<span style="color: #000000;">Mid</span><span style="color: #000000;">(</span>begin, nLength<span style="color: #000000;">)</span>; 
out_str<span style="color: #000000;">(</span>strSheetName<span style="color: #000000;">)</span>;<span style="color: #008000;">// &quot;Sheet1&quot; が出力される</span></pre>
<h2><a name="Replace_Sub_String"></a><span class="mw-headline">部分文字列の置換</span></h2>
<p><span class="OIndex" style="display:none">String, Replace</span>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// 1文字を検索して置換</span>
string str<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;A+B+C+&quot;</span><span style="color: #000000;">)</span>;
<span style="color: #0000ff;">int</span> nCount <span style="color: #000080;">=</span> str.<span style="color: #000000;">Replace</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&apos;+&apos;</span>,<span style="color: #ff00ff;">&apos;-&apos;</span><span style="color: #000000;">)</span>;
out_int<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;&quot;</span>, nCount<span style="color: #000000;">)</span>; <span style="color: #008000;">// nCount は 3</span>
out_str<span style="color: #000000;">(</span>str<span style="color: #000000;">)</span>; <span style="color: #008000;">// &quot;A-B-C-&quot; </span>

<span style="color: #008000;">// 文字列を検索し、置換</span>
str <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;I am a student.<span style="color: #666666; font-weight: bold;">\n</span>I am a girl.&quot;</span>;
nCount <span style="color: #000080;">=</span> str.<span style="color: #000000;">Replace</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;I am&quot;</span>, <span style="color: #ff00ff;">&quot;You are&quot;</span><span style="color: #000000;">)</span>;
out_int<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;&quot;</span>, nCount<span style="color: #000000;">)</span>; <span style="color: #008000;">// nCount は 2</span>
out_str<span style="color: #000000;">(</span>str<span style="color: #000000;">)</span>;</pre>
<h2><a name="Path_String_Functions"></a><span class="mw-headline">パス文字列関数</span></h2>
<h3><a name="File_Path_StringString.2C_Check_Path_StringString.2C_Extract_File_Name_from_Full_Path"></a><span class="mw-headline">ファイルパスの文字列<span class="OIndex" style="display:none">String, Check Path String</span><span class="OIndex" style="display:none">String, Extract File Name from Full Path</span></span></h3>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// string::IsFile はファイルをチェックするのに使用</span>
string strFile <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;D:<span style="color: #666666; font-weight: bold;">\\</span>TestFolder<span style="color: #666666; font-weight: bold;">\\</span>abc.txt&quot;</span>;
<span style="color: #0000ff;">bool</span> bb <span style="color: #000080;">=</span> strFile.<span style="color: #000000;">IsFile</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; 
<span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;The file&nbsp;%s is&nbsp;%sexist.<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, strFile, bb&nbsp;? <span style="color: #ff00ff;">&quot;&quot;</span> <span style="color: #000000;">:</span> <span style="color: #ff00ff;">&quot;NOT &quot;</span><span style="color: #000000;">)</span>;

<span style="color: #008000;">// GetFilePath関数はフルパスの文字列からパスを抽出するのに使用</span>
string strPath <span style="color: #000080;">=</span> GetFilePath<span style="color: #000000;">(</span>strFile<span style="color: #000000;">)</span>;	
out_str<span style="color: #000000;">(</span>strPath<span style="color: #000000;">)</span>;

<span style="color: #008000;">// GetFileName 関数はフルパスの文字列からファイル名の部分を  </span>
<span style="color: #008000;">// 抽出するのに使用</span>
<span style="color: #0000ff;">bool</span> bRemoveExtension <span style="color: #000080;">=</span> <span style="color: #0000ff;">true</span>;
string strFileName <span style="color: #000080;">=</span> GetFileName<span style="color: #000000;">(</span>strFile, bRemoveExtension<span style="color: #000000;">)</span>;
out_str<span style="color: #000000;">(</span>strFileName<span style="color: #000000;">)</span>;

<span style="color: #008000;">// string::IsPath はパスが存在するかチェック</span>
bb <span style="color: #000080;">=</span> strPath.<span style="color: #000000;">IsPath</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
out_int<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;&quot;</span>, bb<span style="color: #000000;">)</span>;</pre>
<h3><a name="Origin_System_PathString.2C_Origin_System_FolderString.2C_User_File_FolderUser_File_Folder"></a><span class="mw-headline"><span class="OIndex">Origin システムパス</span><span class="OIndex" style="display:none">String, Origin System Folder</span><span class="OIndex" style="display:none">String, User File Folder</span><span class="OIndex" style="display:none">User File Folder</span></span></h3>
<pre class="oc" style="font-family:monospace;">string strSysPath <span style="color: #000080;">=</span> GetOriginPath<span style="color: #000000;">(</span>ORIGIN_PATH_SYSTEM<span style="color: #000000;">)</span>;
<span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Origin System Path:&nbsp;%s<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, strSysPath<span style="color: #000000;">)</span>;

string strUserPath <span style="color: #000080;">=</span> GetOriginPath<span style="color: #000000;">(</span>ORIGIN_PATH_USER<span style="color: #000000;">)</span>;
<span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;User File Path:&nbsp;%s<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, strUserPath<span style="color: #000000;">)</span>;</pre>







    