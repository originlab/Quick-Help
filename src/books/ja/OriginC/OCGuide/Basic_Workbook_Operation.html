<h1 class="firstheading">ワークブックの基本操作</h1><div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Create_New_WorkbookWorkbook.2C_CreateMatrixbook.2C_CreateTemplateHidden_Page.2C_Create"><span class="tocnumber">1</span> <span class="toctext">新しいワークブックを作成 <span class="OIndex" style="display:none">Workbook, Create</span><span class="OIndex" style="display:none">Matrixbook, Create</span><span class="OIndex" style="display:none">Template</span><span class="OIndex" style="display:none">Hidden Page, Create</span></span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Open_Workbook"><span class="tocnumber">2</span> <span class="toctext">ワークブックを開く</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Access_Workbook"><span class="tocnumber">3</span> <span class="toctext">ワークブックにアクセスする</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Save_Workbook"><span class="tocnumber">4</span> <span class="toctext">ワークブックを保存する</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Show_or_Hide_Workbook"><span class="tocnumber">5</span> <span class="toctext">ワークブックの表示と非表示</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Activate_Workbook"><span class="tocnumber">6</span> <span class="toctext">ワークブックをアクティブにする</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Delete_Workbook"><span class="tocnumber">7</span> <span class="toctext">ワークブックを削除する</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Clone.2FDuplicate_WorkbookPage_CloneClone_PagePage.2C_CloneDuplicate_Window"><span class="tocnumber">8</span> <span class="toctext">ワークブックを複製する<span class="OIndex" style="display:none">Page Clone</span><span class="OIndex" style="display:none">Clone Page</span><span class="OIndex" style="display:none">Page, Clone</span><span class="OIndex" style="display:none">Duplicate Window</span></span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Name_and_Label_Workbook"><span class="tocnumber">9</span> <span class="toctext">ワークブックに名前とラベルを付ける</span></a></li>
</ul>
</div>

<h2><a name="Create_New_WorkbookWorkbook.2C_CreateMatrixbook.2C_CreateTemplateHidden_Page.2C_Create"></a><span class="mw-headline">新しいワークブックを作成 <span class="OIndex" style="display:none">Workbook, Create</span><span class="OIndex" style="display:none">Matrixbook, Create</span><span class="OIndex" style="display:none">Template</span><span class="OIndex" style="display:none">Hidden Page, Create</span></span></h2>
<p><a href="../../OriginC/OriginC/Page-Create.html" title="OriginC:Page-Create">Create </a>メソッドは、新しいワークブックの作成に使用されます。 
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// STAT テンプレートを使用して非表示のワークブックを作成</span>
WorksheetPage wksPg;
wksPg.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;STAT&quot;</span>, CREATE_HIDDEN<span style="color: #000000;">)</span>;</pre>
<h2><a name="Open_Workbook"></a><span class="mw-headline">ワークブックを開く</span></h2>
<p>ワークブックのデータが、拡張子ogwのファイルとして保存されている場合、<a href="../../OriginC/OriginC/Worksheet-Open.html" title="OriginC:Worksheet-Open">Open </a>メソッドで開く事ができます。
</p>
<pre class="oc" style="font-family:monospace;">Worksheet wks;  <span style="color: #008000;">// ワークシートに属したOpenメソッド</span>
string strOGW <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;D:<span style="color: #666666; font-weight: bold;">\\</span>Book1.ogw&quot;</span>;  <span style="color: #008000;">// ワークブックのパス</span>
wks.<span style="color: #000000;">Open</span><span style="color: #000000;">(</span>strOGW<span style="color: #000000;">)</span>;  <span style="color: #008000;">// ワークブックを開く</span></pre>
<h2><a name="Access_Workbook"></a><span class="mw-headline">ワークブックにアクセスする</span></h2>
<p>既存のワークブックにアクセスするには、複数の方法があります。<a href="../../OriginC/Category/Project_(class).html" title="Category:Project (class)">Project </a>クラスは、プロジェクト内の全ワークブックのコレクションを含みます。次のサンプルでは、それらをどのようにループするかを示します。
</p>
<pre class="oc" style="font-family:monospace;">foreach<span style="color: #000000;">(</span>WorksheetPage wksPg in Project.<span style="color: #000000;">WorksheetPages</span><span style="color: #000000;">)</span>
    out_str<span style="color: #000000;">(</span>wksPg.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>; <span style="color: #008000;">//ワークブック名出力</span></pre>
<p>また、<a href="../../OriginC/Category/Collection_(class).html" title="Category:Collection (class)">Collection</a> クラスの<a href="../../OriginC/OriginC/Collection-Item.html" title="OriginC:Collection-Item">Item</a>メソッドに、ワークブックのインデックスを渡すことによってワークブックにアクセスできます。
</p>
<pre class="oc" style="font-family:monospace;">WorksheetPage wksPg;
wksPg <span style="color: #000080;">=</span> Project.<span style="color: #000000;">WorksheetPages</span>.<span style="color: #000000;">Item</span><span style="color: #000000;">(</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span>wksPg<span style="color: #000000;">)</span> <span style="color: #008000;">// 3番目のワークブックがある場合</span>
    out_str<span style="color: #000000;">(</span>wksPg.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// ワークブック名を出力</span></pre>
<p>ワークブック名がわかっている場合、クラスコンストラクタにその名前を渡すことで、ワークブックにアクセスできます。
</p>
<pre class="oc" style="font-family:monospace;">WorksheetPage wksPg<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Book1&quot;</span><span style="color: #000000;">)</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span>wksPg<span style="color: #000000;">)</span> <span style="color: #008000;">// ワークブック名が&quot;Book1&quot;のワークブックがある場合</span>
    wksPg.<span style="color: #000000;">SetName</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;MyBook1&quot;</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// ワークブックの名前を変更</span></pre>
<h2><a name="Save_Workbook"></a><span class="mw-headline">ワークブックを保存する</span></h2>
<p>Originはワークブックのデータをファイル（拡張子 .ogw）として保存、データなしのテンプレートで保存（拡張子 .ogw）、分析を行ったワークブックに関しては分析テンプレート（拡張子 .ogw）として保存できます。メソッド <a href="../../OriginC/OriginC/PageBase-SaveToFile.html" title="OriginC:PageBase-SaveToFile">SaveToFile</a> と <a href="../../OriginC/OriginC/PageBase-SaveTemplate.html" title="OriginC:PageBase-SaveTemplate">SaveTemplate</a> は、ワークブックを *.ogw と *.otw ファイルとして保存するのに使用されます。
</p>
<pre class="oc" style="font-family:monospace;">WorksheetPage wksPg<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Book1&quot;</span><span style="color: #000000;">)</span>;
<span style="color: #008000;">// ワークブックを OGW ファイルとして保存</span>
<span style="color: #0000ff;">bool</span> bRet1 <span style="color: #000080;">=</span> wksPg.<span style="color: #000000;">SaveToFile</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;D:<span style="color: #666666; font-weight: bold;">\\</span>&quot;</span> <span style="color: #000040;">+</span> wksPg.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000040;">+</span> <span style="color: #ff00ff;">&quot;.ogw&quot;</span><span style="color: #000000;">)</span>;  
<span style="color: #008000;">// ワークブックを OTW テンプレートとして保存</span>
<span style="color: #0000ff;">bool</span> bRet2 <span style="color: #000080;">=</span> wksPg.<span style="color: #000000;">SaveTemplate</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;D:<span style="color: #666666; font-weight: bold;">\\</span>&quot;</span> <span style="color: #000040;">+</span> wksPg.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000040;">+</span> <span style="color: #ff00ff;">&quot;.otw&quot;</span><span style="color: #000000;">)</span>;</pre>
<h2><a name="Show_or_Hide_Workbook"></a><span class="mw-headline">ワークブックの表示と非表示</span></h2>
<p><a href="../../OriginC/Category/WorksheetPage_(class).html" title="Category:WorksheetPage (class)">WorksheetPage</a> クラスは、<a href="../../OriginC/Category/OriginObject_(class).html" title="Category:OriginObject (class)">OriginObject</a>クラスから<a href="../../OriginC/OriginC/OriginObject-Show.html" title="OriginC:OriginObject-Show">Show</a>プロパティを継承し、自身の表示/非表示を決めます。
</p>
<pre class="oc" style="font-family:monospace;">WorksheetPage wksPg<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Book1&quot;</span><span style="color: #000000;">)</span>;
wksPg.<span style="color: #000000;">Show</span> <span style="color: #000080;">=</span> <span style="color: #0000ff;">false</span>;  <span style="color: #008000;">// ワークブックを非表示にする。trueの場合、ワークブックを表示。</span></pre>
<h2><a name="Activate_Workbook"></a><span class="mw-headline">ワークブックをアクティブにする</span></h2>
<p>ワークブックをアクティブにするために、PAGE_ACTIVATEパラメータ値を渡すことによって、<a href="../../OriginC/OriginC/PageBase-SetShow.html" title="OriginC:PageBase-SetShow">SetShow</a>メソッドを使用できます。
</p>
<pre class="oc" style="font-family:monospace;">WorksheetPage wksPg<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Book1&quot;</span><span style="color: #000000;">)</span>;
wksPg.<span style="color: #000000;">SetShow</span><span style="color: #000000;">(</span>PAGE_ACTIVATE<span style="color: #000000;">)</span>;  <span style="color: #008000;">// ワークブックをアクティブにする</span>
<span style="color: #008000;">// 異なる値を渡すことで多くの操作を完了できます。たとえば、</span>
<span style="color: #008000;">// wksPg.SetShow(PAGE_HIDDEN);  // ワークブック非表示</span>
<span style="color: #008000;">// wksPg.SetShow(PAGE_MINIMIZED);  // ワークブック最小化</span>
<span style="color: #008000;">// wksPg.SetShow(PAGE_MAXIMIZED);  // ワークブック最大化</span></pre>
<h2><a name="Delete_Workbook"></a><span class="mw-headline">ワークブックを削除する</span></h2>
<p>すべてのOrigin Cの内部クラスは、<a href="../../OriginC/Category/OriginObject_(class).html" title="Category:OriginObject (class)">OriginObject</a>クラスから派生したものです。  このクラスは、オブジェクトを破棄するのに使用する<a href="../../OriginC/OriginC/OriginObject-Destroy.html" title="OriginC:OriginObject-Destroy">Destroy</a>メソッドがあります。ワークブックまたは行列ブックでこのメソッドを呼び出すと、ワークブックの中にあるすべてのシート、各シート内のすべての列または行列オブジェクトを削除します。 
</p>
<pre class="oc" style="font-family:monospace;">WorksheetPage wksPg;
wksPg <span style="color: #000080;">=</span> Project.<span style="color: #000000;">WorksheetPages</span>.<span style="color: #000000;">Item</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// プロジェクト内の最初のワークブックを取得</span>
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> wksPg <span style="color: #000000;">)</span> <span style="color: #008000;">// ワークブックがあれば</span>
    wksPg.<span style="color: #000000;">Destroy</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// ワークブックを削除</span></pre>
<h2><a name="Clone.2FDuplicate_WorkbookPage_CloneClone_PagePage.2C_CloneDuplicate_Window"></a><span class="mw-headline">ワークブックを複製する<span class="OIndex" style="display:none">Page Clone</span><span class="OIndex" style="display:none">Clone Page</span><span class="OIndex" style="display:none">Page, Clone</span><span class="OIndex" style="display:none">Duplicate Window</span></span></h2>
<p><a href="../../OriginC/Category/WorksheetPage_(class).html" title="Category:WorksheetPage (class)">WorksheetPage</a>クラス（ワークブックに対して）は、<a href="../../OriginC/Category/Page_(class).html" title="Category:Page (class)">Page</a>クラスから派生したものです。このクラスは、元のページを複製するのに使用する<a href="../../OriginC/OriginC/Page-Clone.html" title="OriginC:Page-Clone">Clone</a>メソッドがあります。 
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// データとスタイルと一緒に &quot;Book1&quot;を複製 </span>
<span style="color: #008000;">// 呼び出す前にウィンドウが存在することを確認</span>
WorksheetPage wksPage<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Book1&quot;</span><span style="color: #000000;">)</span>;
WorksheetPage wksPage1 <span style="color: #000080;">=</span> wksPage.<span style="color: #000000;">Clone</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</pre>
<h2><a name="Name_and_Label_Workbook"></a><span class="mw-headline">ワークブックに名前とラベルを付ける</span></h2>
<p>ワークブックにはショートネーム、ロングネーム、コメントがあります。ワークブックにはショートネーム、ロングネーム、コメントがあります。 <a href="../../OriginC/Category/OriginObject_(class).html" title="Category:OriginObject (class)">OriginObject</a>クラスで定義された継承メソッド<a href="../../OriginC/OriginC/OriginObject-SetName.html" title="OriginC:OriginObject-SetName">SetName</a>, <a href="../../OriginC/OriginC/OriginObject-SetLongName.html" title="OriginC:OriginObject-SetLongName">SetLongName</a>, <a href="../../OriginC/OriginC/OriginObject-SetComments.html" title="OriginC:OriginObject-SetComments">SetComments</a>は、ワークブック名(ショートネーム、ロングネームとも）とコメントを制御するために使用できます。
</p>
<pre class="oc" style="font-family:monospace;">WorksheetPage wksPg<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Book1&quot;</span><span style="color: #000000;">)</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span>wksPg<span style="color: #000000;">)</span> 
<span style="color: #000000;">{</span>
	wksPg.<span style="color: #000000;">SetName</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;MyBook&quot;</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">// ワークブック名変更</span>
	wksPg.<span style="color: #000000;">SetLongName</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;This is Long Name&quot;</span>, <span style="color: #0000ff;">false</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">// ロングネームをセット</span>
	wksPg.<span style="color: #000000;">SetComments</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Comments&quot;</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">// コメントをセット</span>
<span style="color: #000000;">}</span></pre>
<p>また、<a href="../../OriginC/OriginC/PageBase-Label.html" title="OriginC:PageBase-Label">Label </a>プロパティもロングネーム変更に使用できます。<a href="../../OriginC/OriginC/PageBase-TitleShow.html" title="OriginC:PageBase-TitleShow">TitleShow</a> プロパティじゃワークブックタイトルにロングネーム、ショートネームをどのように表示するか制御します。
</p>
<pre class="oc" style="font-family:monospace;">WorksheetPage wksPg1<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Book2&quot;</span><span style="color: #000000;">)</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span>wksPg1<span style="color: #000000;">)</span> 
<span style="color: #000000;">{</span>
	wksPg1.<span style="color: #000000;">Label</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;My Label&quot;</span>;  <span style="color: #008000;">// ラベル(ロングネームともいう)をセット</span>
	<span style="color: #008000;">// ワークブックタイトルにはラベルのみ表示</span>
	wksPg1.<span style="color: #000000;">TitleShow</span> <span style="color: #000080;">=</span> WIN_TITLE_SHOW_LABEL;  
	<span style="color: #008000;">// ワークブックタイトルにはショートネームのみ表示</span>
	<span style="color: #008000;">// wksPg1.TitleShow = WIN_TITLE_SHOW_NAME;  </span>
	<span style="color: #008000;">// ワークブックタイトルにショートネームとラベル両方表示</span>
	<span style="color: #008000;">// wksPg1.TitleShow = WIN_TITLE_SHOW_BOTH;  </span>
<span style="color: #000000;">}</span></pre>







    