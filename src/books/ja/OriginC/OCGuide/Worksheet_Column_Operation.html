<h1 class="firstheading">ワークシート列操作</h1><p>ワークシート列の操作を行うには、 <a href="../../OriginC/Category/Column_(class).html" title="Category:Column (class)">Column </a>クラスか<a href="../../OriginC/Category/Worksheet_(class).html" title="Category:Worksheet (class)">Worksheet</a> クラスを使用します。
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Add_ColumnInsert_ColumnAdd_or_Insert_Column"><span class="tocnumber">1</span> <span class="toctext"><span class="OIndex" style="display:none">Add Column</span><span class="OIndex" style="display:none">Insert Column</span>列の追加及び挿入</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Delete_Column"><span class="tocnumber">2</span> <span class="toctext"><span class="OIndex">列を削除</span></span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Rename_and_Label_ColumnRename_ColumnColumn_Label"><span class="tocnumber">3</span> <span class="toctext">列の名前を変更する・ラベルを付ける<span class="OIndex" style="display:none">Rename Column</span><span class="OIndex" style="display:none">Column Label</span></span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Hide.2FUnhide_ColumnHide_Column"><span class="tocnumber">4</span> <span class="toctext">列の表示/非表示<span class="OIndex" style="display:none">Hide Column</span></span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Move_and_Swap_Columns"><span class="tocnumber">5</span> <span class="toctext">列の移動と<span class="OIndex">交換</span></span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Add_Sparkline_to_Column"><span class="tocnumber">6</span> <span class="toctext">列に<span class="OIndex">スパークライン</span>を追加</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Data_Type.2C_Format.2C_SubFormatColumn_Properties"><span class="tocnumber">7</span> <span class="toctext">属性、フォーマット、サブフォーマット<span class="OIndex" style="display:none">Column Properties</span></span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="#Get_.26_Set_Data_TypeColumn_Designation"><span class="tocnumber">7.1</span> <span class="toctext">属性の取得と設定<span class="OIndex" style="display:none">Column Designation</span></span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Get_.26_Set_Data_FormatColumn.2C_Data_Format"><span class="tocnumber">7.2</span> <span class="toctext">データフォーマットの取得と設定<span class="OIndex" style="display:none">Column, Data Format</span></span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Get_.26_Set_Data_SubformatColumn.2C_Data_SubFormat"><span class="tocnumber">7.3</span> <span class="toctext">データサブフォーマットの取得と設定<span class="OIndex" style="display:none">Column, Data SubFormat</span></span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="Add_ColumnInsert_ColumnAdd_or_Insert_Column"></a><span class="mw-headline"><span class="OIndex" style="display:none">Add Column</span><span class="OIndex" style="display:none">Insert Column</span>列の追加及び挿入</span></h2>
<p>ワークシートの最後に新しい列を追加する場合、<a href="../../OriginC/Category/Worksheet_(class).html" title="Category:Worksheet (class)">Worksheet</a> クラスの<a href="../../OriginC/OriginC/Worksheet-AddCol.html" title="OriginC:Worksheet-AddCol">AddCol</a>メソッドを使用し、指定した位置の直前に列を挿入するときは<a href="../../OriginC/OriginC/Worksheet-InsertCol.html" title="OriginC:Worksheet-InsertCol">InsertCol</a>を使用します。
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// デフォルト名で列を追加</span>
<span style="color: #0000ff;">int</span> nColIndex <span style="color: #000080;">=</span> wks.<span style="color: #000000;">AddCol</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;

<span style="color: #008000;">// strNameという名前の列を追加;</span>
<span style="color: #0000ff;">int</span> nColIndex <span style="color: #000080;">=</span> wks.<span style="color: #000000;">AddCol</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;AA&quot;</span>, strName<span style="color: #000000;">)</span>; <span style="color: #008000;">// 列のインデックスを返す</span>
<span style="color: #008000;">// AAという名前の列が既にある場合、自動で名付け</span>
out_str<span style="color: #000000;">(</span>strName<span style="color: #000000;">)</span>; 
Column col<span style="color: #000000;">(</span>wks, nColIndex<span style="color: #000000;">)</span>; <span style="color: #008000;">// 列インデックスで列オブジェクトを構築</span>


<span style="color: #008000;">// 新しい列を1列目として挿入</span>
<span style="color: #0000ff;">int</span> nPos <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; <span style="color: #008000;">// 挿入する位置</span>
string strNewCreated; <span style="color: #008000;">// 新しい列の名前</span>
<span style="color: #008000;">// MyColという列名が既にある場合は、自動で名付け</span>
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> wks.<span style="color: #000000;">InsertCol</span><span style="color: #000000;">(</span>nPos, <span style="color: #ff00ff;">&quot;MyCol&quot;</span>, strNewCreated<span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
        <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Insert column successfully, name is&nbsp;%s<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, strNewCreated<span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span></pre>
<h2><a name="Delete_Column"></a><span class="mw-headline"><span class="OIndex">列を削除</span></span></h2>
<p><a href="../../OriginC/OriginC/Worksheet-DeleteCol.html" title="OriginC:Worksheet-DeleteCol">Worksheet::DeleteCol</a>メソッドはワークシートから列を削除する事ができます。
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// インデックスで列を削除</span>
wks.<span style="color: #000000;">DeleteCol</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;</pre>
<h2><a name="Rename_and_Label_ColumnRename_ColumnColumn_Label"></a><span class="mw-headline">列の名前を変更する・ラベルを付ける<span class="OIndex" style="display:none">Rename Column</span><span class="OIndex" style="display:none">Column Label</span></span></h2>
<p>列の名前（ショートネーム）を変更するには、<a href="../../OriginC/OriginC/OriginObject-SetName.html" title="OriginC:OriginObject-SetName">SetName</a>メソッドを使用します。
</p>
<pre class="oc" style="font-family:monospace;">Column col <span style="color: #000080;">=</span> wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">//ワークシート内の1列目を取得</span>
<span style="color: #0000ff;">BOOL</span> bRet <span style="color: #000080;">=</span> col.<span style="color: #000000;">SetName</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;MyNewName&quot;</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">// 列の名前を変更</span></pre>
<p>ワークシート列ラベルには、ロングネーム、単位、コメント、パラメータ、ユーザ定義ラベル等がサポートされています。Origin Cコードでラベルの表示/非表示や、特定の列ラベルにテキストを追加できます。
</p>
<pre class="oc" style="font-family:monospace;">Worksheet wks;
wks.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;    
 
Grid gg;
gg.<span style="color: #000000;">Attach</span><span style="color: #000000;">(</span>wks<span style="color: #000000;">)</span>;
 
<span style="color: #008000;">// パラメータラベルが非表示の場合、表示する</span>
<span style="color: #0000ff;">bool</span> bShow <span style="color: #000080;">=</span> gg.<span style="color: #000000;">IsLabelsShown</span><span style="color: #000000;">(</span>RCLT_PARAM<span style="color: #000000;">)</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #000040;">!</span>bShow <span style="color: #000000;">)</span>
        gg.<span style="color: #000000;">ShowLabels</span><span style="color: #000000;">(</span>RCLT_PARAM<span style="color: #000000;">)</span>;
 
wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>.<span style="color: #000000;">SetLongName</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;X Data&quot;</span><span style="color: #000000;">)</span>;
wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>.<span style="color: #000000;">SetLongName</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Y Data&quot;</span><span style="color: #000000;">)</span>;
 
wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>.<span style="color: #000000;">SetComments</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;This is a test&quot;</span><span style="color: #000000;">)</span>;
 
wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>.<span style="color: #000000;">SetUnits</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;AA&quot;</span><span style="color: #000000;">)</span>;
wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>.<span style="color: #000000;">SetUnits</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;BB&quot;</span><span style="color: #000000;">)</span>;
 
<span style="color: #008000;">// 2列のパラメータラベルにテキストを入力</span>
wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>.<span style="color: #000000;">SetExtendedLabel</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Param A&quot;</span>, RCLT_PARAM<span style="color: #000000;">)</span>;
wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>.<span style="color: #000000;">SetExtendedLabel</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Param B&quot;</span>, RCLT_PARAM<span style="color: #000000;">)</span>;</pre>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Worksheet_Column_Operation/Tip_icon.png" width="57"  border="0" /></td><td><p>RCLT_PARAM は、パラメータ列ラベルタイプです。他のタイプについては、<i>OriginC\system\oc_const.h</i> の ROWCOLLABELTYPE enumを確認してください。
</p></td></tr></table>
<h2><a name="Hide.2FUnhide_ColumnHide_Column"></a><span class="mw-headline">列の表示/非表示<span class="OIndex" style="display:none">Hide Column</span></span></h2>
<p>列を表示/非表示にするには、<a href="../../OriginC/OriginC/Worksheet-ShowCol.html" title="OriginC:Worksheet-ShowCol">Workhseet::ShowCol</a> メソッドを使用します。
</p>
<pre class="oc" style="font-family:monospace;">wks.<span style="color: #000000;">ShowCol</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">1</span>, <span style="color: #0000ff;">false</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// 列1を非表示にする</span></pre>
<h2><a name="Move_and_Swap_Columns"></a><span class="mw-headline">列の移動と<span class="OIndex">交換</span></span></h2>
<p>列を移動したり交換する場合、<a href="../../OriginC/Category/Worksheet_(class).html" title="Category:Worksheet (class)">Worksheet</a>クラス、<a href="../../OriginC/Category/Datasheet_(class).html" title="Category:Datasheet (class)">Datasheet</a>クラスが<a href="../../OriginC/OriginC/Datasheet-MoveColumns.html" title="OriginC:Datasheet-MoveColumns">MoveColumns</a>メソッドと[[OriginC:Datasheet-SwapColumns|SwapColumns]を提供しています
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// 3列移動 - 列5を最初の列へ</span>
<span style="color: #008000;">// このサンプルでは最低限7列あるワークシートが必要</span>
Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span>wks<span style="color: #000000;">)</span>
    wks.<span style="color: #000000;">MoveColumns</span><span style="color: #000000;">(</span><span style="color: #0000dd;">4</span>, <span style="color: #0000dd;">3</span>, MOVE_COL_TO_FIRST<span style="color: #000000;">)</span>;

<span style="color: #008000;">// アクティブワークシートの列の順番を逆に</span>
<span style="color: #0000ff;">for</span><span style="color: #000000;">(</span><span style="color: #0000ff;">int</span> ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; ii <span style="color: #000080;">&lt;=</span> wks.<span style="color: #000000;">GetNumCols</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000040;">/</span> <span style="color: #0000dd;">2</span>&nbsp;; ii<span style="color: #000040;">++</span><span style="color: #000000;">)</span>
    wks.<span style="color: #000000;">SwapColumns</span><span style="color: #000000;">(</span>ii <span style="color: #000040;">-</span> <span style="color: #0000dd;">1</span>, wks.<span style="color: #000000;">GetNumCols</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000040;">-</span> ii<span style="color: #000000;">)</span>;</pre>
<h2><a name="Add_Sparkline_to_Column"></a><span class="mw-headline">列に<span class="OIndex">スパークライン</span>を追加</span></h2>
<p>列にスパークラインを追加するために、Origin CではRCLT_SPARKLINEラベルタイプの<a href="../../OriginC/OriginC/Wks_set_show_labels_(global_function).html" title="OriginC:Wks set show labels (global function)">wks_set_show_labels</a> が提供されています。
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// サンプリング間隔とスパークラインを表示するためにアクティブワークシートを構成</span>
<span style="color: #008000;">// 現在のラベルに追加</span>
Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> vn <span style="color: #000080;">=</span> <span style="color: #000000;">{</span>RCLT_SAMPLE_RATE, RCLT_SPARKLINE<span style="color: #000000;">}</span>; 
wks_add_show_labels<span style="color: #000000;">(</span>wks, vn, <span style="color: #0000ff;">false</span><span style="color: #000000;">)</span>;</pre>
<h2><a name="Data_Type.2C_Format.2C_SubFormatColumn_Properties"></a><span class="mw-headline">属性、フォーマット、サブフォーマット<span class="OIndex" style="display:none">Column Properties</span></span></h2>
<h3><a name="Get_.26_Set_Data_TypeColumn_Designation"></a><span class="mw-headline">属性の取得と設定<span class="OIndex" style="display:none">Column Designation</span></span></h3>
<pre class="oc" style="font-family:monospace;">Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;	
Column col<span style="color: #000000;">(</span>wks, <span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;

<span style="color: #008000;">// 列タイプを取得</span>
<span style="color: #008000;">// 0: Y</span>
<span style="color: #008000;">// 1: 無属性</span>
<span style="color: #008000;">// 2: Yエラー</span>
<span style="color: #008000;">// 3: X</span>
<span style="color: #008000;">// 4: L</span>
<span style="color: #008000;">// 5: Z</span>
<span style="color: #008000;">// 6: Xエラー</span>
<span style="color: #0000ff;">int</span> nType <span style="color: #000080;">=</span> col.<span style="color: #000000;">GetType</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
out_int<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Type: &quot;</span>, nType<span style="color: #000000;">)</span>;</pre>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// 列属性を設定。 OKDATAOBJ_DESIGNATION_* in oc_const.h 参照</span>
col.<span style="color: #000000;">SetType</span><span style="color: #000000;">(</span>OKDATAOBJ_DESIGNATION_Z<span style="color: #000000;">)</span>;</pre>
<h3><a name="Get_.26_Set_Data_FormatColumn.2C_Data_Format"></a><span class="mw-headline">データフォーマットの取得と設定<span class="OIndex" style="display:none">Column, Data Format</span></span></h3>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// データフォーマットを取得して設定</span>
<span style="color: #008000;">// 列のデフォルトフォーマットは、  OKCOLTYPE_TEXT_NUMERIC</span>
<span style="color: #008000;">// 列のフォーマットを日付に変更</span>
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> OKCOLTYPE_DATE <span style="color: #000040;">!</span><span style="color: #000080;">=</span> col.<span style="color: #000000;">GetFormat</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
	col.<span style="color: #000000;">SetFormat</span><span style="color: #000000;">(</span>OKCOLTYPE_DATE<span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span></pre>
<h3><a name="Get_.26_Set_Data_SubformatColumn.2C_Data_SubFormat"></a><span class="mw-headline">データサブフォーマットの取得と設定<span class="OIndex" style="display:none">Column, Data SubFormat</span></span></h3>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// データサブフォーマットの取得と設定</span>
<span style="color: #008000;">// サブフォーマットのオプションは、フォーマットのタイプ</span>
<span style="color: #008000;">// 数値、日付、時間などに応じて異なる</span>
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> LDF_YYMMDD <span style="color: #000040;">!</span><span style="color: #000080;">=</span> col.<span style="color: #000000;">GetSubFormat</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
	col.<span style="color: #000000;">SetSubFormat</span><span style="color: #000000;">(</span>LDF_YYMMDD<span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span></pre>



    