<h1 class="firstheading">Origin C コードを配布する</h1>
<p><br /></p>
<h2><a name="Distributing_Source_CodeDistributing_CodeShare_Code" id="Distributing_Source_CodeDistributing_CodeShare_Code"></a><span class="mw-headline">ソースコードを配布する<span class="OIndex" style="display: none;">Distributing Code</span><span class="OIndex" style="display: none;">Share Code</span></span></h2>
<p>Originユーザは、ソースファイル(.C、.CPP、.OCZ)またはプリプロセスファイル(.OP)のいずれかを配布することで、他の人とOrigin Cソースコードを共有することができます。</p>
<p>他の人がアプリケーションのソースコードを見る必要がなければ、ソースファイル(.Cまたは.CPP)ではなく、暗号化Origin Cファイル(.OCZ)かプリプロセスファイル(.OP)を配布することをお勧めします。</p>
<p>暗号化OCZファイルは、<a href="CodeBuilderUsersGuide.chm::/Category/Code_Builder.html" title="カテゴリー:コードビルダ">コードビルダ</a>にドラッグアンドドロップするだけで内容の表示や編集が可能です。最初ファイルを開こうとしたときにパスワードを聞かれますが、同じOriginセッション内では一度しか聞かれません。</p>
<p>詳細は、<b>Origin Cファイルの作成と編集</b>セクションの<a href="../../OriginC/OCGuide/Create_and_Edit_an_Origin_C_File.html#File_Types" title="OCGuide:&lt;b&gt;Origin Cファイルの作成と編集&lt;/b&gt;">ファイルの種類</a>を確認してください。</p>
<table class="noborder">
<tr>
<td style="vertical-align: top;" width="60"><img src="../images/Distributing_Origin_C_Code/Tip_icon.png" alt="" width="57" border="0" /></td>
<td>
<p>暗号化されたOCZファイルをOrigin内で開くときには、Origin 2016 SR0移行のユーザは暗号化されていない*.cファイルもしくは*.cppファイルとして*.oczファイルを再保存します。その際は、<b>ファイル：名前を付けて保存</b>を選択して、<b>ファイルの種類</b>ドロップダウンリストでファイル種類を選択します。</p>
</td>
</tr>
</table>
<h2><a name="Distributing_Applications" id="Distributing_Applications"></a><span class="mw-headline">アプリケーションを配布する</span></h2>
<p>アプリケーションを作成したら、1つのパッケージファイルとして、他のユーザにアプリケーションを配布することができます。</p>
<p><b>パッケージ・マネージャ</b> を使って、すべてのアプリケーションファイルを1つのパッケジファイル(.OPX)にまとめることができます。<span class="OIndex" style="display: none;">Package Files</span> アプリケーションファイルをパッケージに追加するときには、プリプロセスファイル(.OP)またはソースファイル(.Cまたは.CPP)を追加することに注意してください。 両方を追加する必要はありません。</p>
<p>ユーザは、パッケージファイルをOriginに直接ドロップしてインストールすることができます。</p>
<p>以下は、すべてのアプリケーションファイルを1つのOPXにパッケージする方法を示すサンプルです。ユーザは、パッケージファイルをOriginにドロップし、ボタンをクリックしてソースファイルを実行することができます。</p>
<ol>
<li>Origin Cファイルを準備します。<b>コードビルダ</b>では、<b>ファイル：新規</b>メニューから<i>MyButton.c</i> という新しいcファイルを作成し、以下のコードをそこにコピーして、<i>User FilesフォルダのOriginC</i> サブフォルダに保存します。
<pre class="oc" style="font-family: monospace;">
<span style="color: #0000ff;">void</span> OnButtonClick<span style="color: #000000;">(</span><span style="color: #000000;">)</span>          <span style="color: #000000;">
{</span>
        Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
        
        DataRange dr;
        dr.<span style="color: #000000;">Add</span><span style="color: #000000;">(</span>wks, <span style="color: #0000dd;">0</span>, <span style="color: #ff00ff;">"X"</span><span style="color: #000000;">)</span>;
        dr.<span style="color: #000000;">Add</span><span style="color: #000000;">(</span>wks, <span style="color: #0000dd;">1</span>, <span style="color: #ff00ff;">"Y"</span><span style="color: #000000;">)</span>;
        
        GraphPage gp;
        gp.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
        GraphLayer gl <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;
        
        <span style="color: #0000ff;">int</span> nn <span style="color: #000080;">=</span> gl.<span style="color: #000000;">AddPlot</span><span style="color: #000000;">(</span>dr<span style="color: #000000;">)</span>;
        gl.<span style="color: #000000;">Rescale</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;<span style="color: #000000;">
}</span>
</pre></li>
<li><i>MyButton.ogs</i> というOGSファイルを作成し、Origin Cソースコードをロードし、関数を呼びます。以下のコードをコピーし、User Filesフォルダに保存します。
<pre class="lt" style="font-family: monospace;">
<span style="color: #000000;">[</span>Main<span style="color: #000000;">]</span>
        if<span style="color: #000000;">(</span><span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> Run.<span style="color: #000080;">LoadOC</span><span style="color: #000000;">(</span><span style="color: #000080;">%</span>Y\OriginC\MyButton.<span style="color: #000080;">c</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
                OnButtonClick;
        <span style="color: #000000;">}</span>
        
</pre></li>
<li>Originメニューから<b>表示：ツールバー</b>を選択します。<b>カスタマイズ</b>ダイアログで、<b>ボタングループ</b>タブを選び、<b>新規作成</b>をクリックして、<b>ボタングループの作成</b>ダイアログを開きます。<b>グループ名</b>として<i>MyButton</i> をセットし、<b>ボタンの数</b>は1のままにし、<b>ビットマップ</b>にはUser Filesフォルダから<i>Userdef.bmp</i> ファイルを選び、OKボタンをクリックします。<b>名前を付けて保存</b>ダイアログで、保存ボタンをクリックして、<i>MyButton.ini</i>ファイルをデフォルトパスに保存します。</li>
<li><b>カスタマイズ</b>ダイアログで、<b>グループ</b>リストから<i>MyButton</i> を選んで、<b>ボタン</b>パネルから<a class="image"><img alt="MyButton.png" src="../images/Distributing_Origin_C_Code/MyButton.png" width="22" border="0" /></a>ボタンをクリックして選び、設定をクリックして<b>ボタン設定</b>ダイアログを開きます。 <b>ファイル名</b>に<i>MyButton.ogs</i> を選び、<b>セクション名</b>にMainと入力し、<b>行列</b>、<b>Excel</b>、<b>グラフ</b>、<b>レイアウト</b>のチェックが外れていることを確認してください。OKをクリックしてダイアログを閉じます。</li>
<li><b>エクスポート</b>をクリックし、<b>ボタングループのエクスポート</b>ダイアログで、<b>ファイルの追加</b>をクリックして<i>MyButton.c</i> ファイルを選択します。
<div><a class="image"><img alt="ExportButtonGroup.png" src="../images/Distributing_Origin_C_Code/ExportButtonGroup.png" width="296" height="476" border="0" /></a></div>
</li>
<li><b>エクスポート</b>をクリックし、名前を付けて保存ダイアログで、保存をクリックして指定したフォルダに<i>MyButton.OPX</i> ファイルを保存します。</li>
<li>メニューから<b>ツール：パッケージ・マネージャー</b>を選び、開いたダイアログボックスで、<b>ファイル：開く</b>を選択して<i>MyButton.OPX</i> を開きます。 以下のスクリプト
<pre class="lt" style="font-family: monospace;">
Run.<span style="color: #000080;">LoadOC</span><span style="color: #000000;">(</span><span style="color: #000080;">%</span>Y\OriginC\MyButton.<span style="color: #000080;">c</span><span style="color: #000000;">)</span>;
        
</pre>
を、<b>LabTalk スクリプト：インストール後</b>に入力してOriginCのソースファイルをロードします。 OriginにOPXファイルをドロップしてこのアプリケーションをインストールするときに、このスクリプトが実行します。</li>
</ol>
