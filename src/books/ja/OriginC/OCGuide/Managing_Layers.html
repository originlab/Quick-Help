<h1 class="firstheading">レイヤの管理</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Creating_a_Panel_Plot"><span class="tocnumber">1</span><span class="toctext">区分プロットを作成する</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Creating_a_6_Panel_GraphGraph_Page.2C_Layer_Arrangement"><span class="tocnumber">1.1</span> <span class="toctext">6区分プロットを作成する<span class="OIndex" style="display:none">Graph Page, Layer Arrangement</span></span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Creating_and_Plotting_into_a_6_Panel_GraphGraph_Page.2C_Plotting_Separated_Data_in_Multiple_Layers"><span class="tocnumber">1.2</span> <span class="toctext">6区分グラフを作成しプロット<span class="OIndex" style="display:none">Graph Page, Plotting Separated Data in Multiple Layers</span></span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4"><a href="#Adding_Layers_to_a_Graph_WindowGraph_Page.2C_Add_Layer"><span class="tocnumber">2</span> <span class="toctext">グラフウィンドウにレイヤを追加する<span class="OIndex" style="display:none">Graph Page, Add Layer</span></span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Hiding_Layers_Except_Active_One"><span class="tocnumber">3</span> <span class="toctext">アクティブなレイヤ以外を非表示にする</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Arranging_the_LayersGraph_Page.2C_Layer_Arrangement"><span class="tocnumber">4</span> <span class="toctext">レイヤを配置する<span class="OIndex" style="display:none">Graph Page, Layer Arrangement</span></span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Moving_a_LayerGraph_Page.2C_Move_Layer"><span class="tocnumber">5</span> <span class="toctext">レイヤを移動する<span class="OIndex" style="display:none">Graph Page, Move Layer</span></span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Resizing_a_LayerGraph_Page.2C_Resize_Layer"><span class="tocnumber">6</span> <span class="toctext">レイヤサイズの変更<span class="OIndex" style="display:none">Graph Page, Resize Layer</span></span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Swap_two_LayersGraph_Page.2C_Swap_Layers"><span class="tocnumber">7</span> <span class="toctext">2つのレイヤを入れ替える<span class="OIndex" style="display:none">Graph Page, Swap Layers</span></span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#Aligning_LayersLayer.2C_Alignment"><span class="tocnumber">8</span> <span class="toctext">レイヤを整列する<span class="OIndex" style="display:none">Layer, Alignment</span></span></a></li>
<li class="toclevel-1 tocsection-11"><a href="#Linking_LayersGraph_Page.2C_Linking_Layers"><span class="tocnumber">9</span> <span class="toctext">レイヤをリンクする<span class="OIndex" style="display:none">Graph Page, Linking Layers</span></span></a></li>
<li class="toclevel-1 tocsection-12"><a href="#Setting_Layer_UnitGraph_Layer.2C_Dimension"><span class="tocnumber">10</span> <span class="toctext">レイヤ単位をセットする<span class="OIndex" style="display:none">Graph Layer, Dimension</span></span></a></li>
</ul>
</div>

<h2><a name="Creating_a_Panel_Plot"></a><span class="mw-headline">区分プロットを作成する</span></h2>
<h3><a name="Creating_a_6_Panel_GraphGraph_Page.2C_Layer_Arrangement"></a><span class="mw-headline">6区分プロットを作成する<span class="OIndex" style="display:none">Graph Page, Layer Arrangement</span></span></h3>
<p>次のサンプルは、2列3行で配置した6つのレイヤを持つ新しいグラフを作成します。  この関数は、どのウィンドウがアクティブかに関係なく実行できます。  
</p>
<pre class="oc" style="font-family:monospace;">GraphPage gp;
gp.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Origin&quot;</span><span style="color: #000000;">)</span>;

<span style="color: #0000ff;">while</span><span style="color: #000000;">(</span>gp.<span style="color: #000000;">Layers</span>.<span style="color: #000000;">Count</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000080;">&lt;</span> <span style="color: #0000dd;">6</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
	gp.<span style="color: #000000;">AddLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span>

graph_arrange_layers<span style="color: #000000;">(</span>gp, <span style="color: #0000dd;">3</span>, <span style="color: #0000dd;">2</span><span style="color: #000000;">)</span>;</pre>
<h3><a name="Creating_and_Plotting_into_a_6_Panel_GraphGraph_Page.2C_Plotting_Separated_Data_in_Multiple_Layers"></a><span class="mw-headline">6区分グラフを作成しプロット<span class="OIndex" style="display:none">Graph Page, Plotting Separated Data in Multiple Layers</span></span></h3>
<p>次のサンプルは、新しいワークブックにいくつかデータをインポートし、6つのレイヤを持つ新しいグラフウィンドウを作成し、2列3行で配置し、各レイヤ(区分)をループして、インポートしたデータをプロットします。
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// ワークシートにデータファイルをインポート</span>
ASCIMP  	ai;
Worksheet 	wks;
string	strDataFile <span style="color: #000080;">=</span> GetOpenBox<span style="color: #000000;">(</span>FDLOG_ASCII, GetAppPath<span style="color: #000000;">(</span><span style="color: #0000ff;">true</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span>AscImpReadFileStruct<span style="color: #000000;">(</span>strDataFile,<span style="color: #000040;">&amp;</span>ai<span style="color: #000000;">)</span> <span style="color: #000080;">==</span> <span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>		
	wks.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Origin&quot;</span><span style="color: #000000;">)</span>;
	wks.<span style="color: #000000;">ImportASCII</span><span style="color: #000000;">(</span>strDataFile, ai<span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span>

<span style="color: #008000;">// ワークシートからグラフの各レイヤにXYデータを追加</span>
GraphPage gp<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Graph1&quot;</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// グラフは上記で作成した3x2区分レイヤを持つ</span>
<span style="color: #0000ff;">int</span> index <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
foreach<span style="color: #000000;">(</span>GraphLayer gl in gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
	DataRange dr;
	dr.<span style="color: #000000;">Add</span><span style="color: #000000;">(</span>wks, <span style="color: #0000dd;">0</span>, <span style="color: #ff00ff;">&quot;X&quot;</span><span style="color: #000000;">)</span>;
	dr.<span style="color: #000000;">Add</span><span style="color: #000000;">(</span>wks, index<span style="color: #000040;">+</span><span style="color: #0000dd;">1</span>, <span style="color: #ff00ff;">&quot;Y&quot;</span><span style="color: #000000;">)</span>;
	
	<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> gl.<span style="color: #000000;">AddPlot</span><span style="color: #000000;">(</span>dr, IDM_PLOT_LINE<span style="color: #000000;">)</span> <span style="color: #000080;">&gt;=</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">)</span>
		gl.<span style="color: #000000;">Rescale</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
	
	index<span style="color: #000040;">++</span>;
<span style="color: #000000;">}</span></pre>
<h2><a name="Adding_Layers_to_a_Graph_WindowGraph_Page.2C_Add_Layer"></a><span class="mw-headline">グラフウィンドウにレイヤを追加する<span class="OIndex" style="display:none">Graph Page, Add Layer</span></span></h2>
<p>次のサンプルは、独立した右Y軸スケールを追加します。  右Y軸のみを表示する新しいレイヤを追加します。  これは寸法がリンクされ、レイヤが追加された時に、X軸が現在のアクティブレイヤにリンクされます。  新しく追加したレイヤがアクティブレイヤになります。
</p><p>次のコードをコンパイルする前に、現在のワークスペースにgraph_utils.cを追加する必要があります。これには、Labtalkコマンド&quot;Run.LoadOC(Originlab\graph_utils.c)&quot;を使います。
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>..\Originlab\graph_utils.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span><span style="color: #008000;">// page_add_layer関数に必要</span>

GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
GraphPage gp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">GetPage</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;

<span style="color: #0000ff;">bool</span> bBottom <span style="color: #000080;">=</span> <span style="color: #0000ff;">false</span>, bLeft <span style="color: #000080;">=</span> <span style="color: #0000ff;">false</span>, bTop <span style="color: #000080;">=</span> <span style="color: #0000ff;">false</span>, bRight <span style="color: #000080;">=</span> <span style="color: #0000ff;">true</span>;
<span style="color: #0000ff;">int</span> nLinkTo <span style="color: #000080;">=</span> gl.<span style="color: #000000;">GetIndex</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// アクティブレイヤにレイヤリンクを新しく追加</span>
<span style="color: #0000ff;">bool</span> bActivateNewLayer <span style="color: #000080;">=</span> <span style="color: #0000ff;">true</span>;

<span style="color: #0000ff;">int</span>	nLayerIndex <span style="color: #000080;">=</span> page_add_layer<span style="color: #000000;">(</span>gp, bBottom, bLeft, bTop, bRight, 
ADD_LAYER_INIT_SIZE_POS_SAME_AS_PREVIOUS, bActivateNewLayer, nLinkTo<span style="color: #000000;">)</span>;</pre>
<h2><a name="Hiding_Layers_Except_Active_One"></a><span class="mw-headline">アクティブなレイヤ以外を非表示にする</span></h2>
<pre class="oc" style="font-family:monospace;">GraphPage gp<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Graph1&quot;</span><span style="color: #000000;">)</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> gp <span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
	GraphLayer glActive <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// -1 はアクティブレイヤを取得</span>
	
	foreach<span style="color: #000000;">(</span>GraphLayer gl in gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">)</span>
	<span style="color: #000000;">{</span>
		<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> gl.<span style="color: #000000;">GetIndex</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000040;">!</span><span style="color: #000080;">=</span> glActive.<span style="color: #000000;">GetIndex</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
			gl.<span style="color: #000000;">Show</span><span style="color: #000000;">(</span><span style="color: #0000ff;">false</span><span style="color: #000000;">)</span>;
	<span style="color: #000000;">}</span>
<span style="color: #000000;">}</span></pre>
<h2><a name="Arranging_the_LayersGraph_Page.2C_Layer_Arrangement"></a><span class="mw-headline">レイヤを配置する<span class="OIndex" style="display:none">Graph Page, Layer Arrangement</span></span></h2>
<p>次のサンプルは、アクティブグラフに既存レイヤを2行3列で配置します。  アクティブグラフに6つのレイヤが無くても、新しいレイヤは追加されません。  存在しているレイヤのみが配置されます。  
</p>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
GraphPage gp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">GetPage</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;

<span style="color: #0000ff;">int</span> nRows <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>, nCols <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
graph_arrange_layers<span style="color: #000000;">(</span>gp, nRows, nCols<span style="color: #000000;">)</span>;</pre>
<h2><a name="Moving_a_LayerGraph_Page.2C_Move_Layer"></a><span class="mw-headline">レイヤを移動する<span class="OIndex" style="display:none">Graph Page, Move Layer</span></span></h2>
<p>次のサンプルは、アクティブグラフウィンドウのすべてのレイヤを左に整列し、ページの左側から15%の位置にセットします。
</p>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
GraphPage gp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">GetPage</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;

<span style="color: #0000ff;">int</span> nRows <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span>.<span style="color: #000000;">Count</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
<span style="color: #0000ff;">int</span> nCols <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;

stLayersGridFormat stFormat;
stFormat.<span style="color: #000000;">nXGap</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; <span style="color: #008000;">// レイヤのX方向の余白</span>
stFormat.<span style="color: #000000;">nYGap</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>; <span style="color: #008000;">// レイヤのY方向の余白</span>
stFormat.<span style="color: #000000;">nLeftMg</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">15</span>; <span style="color: #008000;">// 左余白</span>
stFormat.<span style="color: #000000;">nRightMg</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span>;
stFormat.<span style="color: #000000;">nTopMg</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span>;	
stFormat.<span style="color: #000000;">nBottomMg</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span>;

page_arrange_layers<span style="color: #000000;">(</span>gp, nRows, nCols, <span style="color: #000040;">&amp;</span>stFormat<span style="color: #000000;">)</span>;</pre>
<h2><a name="Resizing_a_LayerGraph_Page.2C_Resize_Layer"></a><span class="mw-headline">レイヤサイズの変更<span class="OIndex" style="display:none">Graph Page, Resize Layer</span></span></h2>
<p>次のサンプルは、現在のレイヤのサイズを変更し、幅と高さを元のサイズの半分にします。
</p><p>次のコードをコンパイルする前に、現在のワークスペースにgraph_utils.cを追加する必要があります。これには、Labtalkコマンド&quot;Run.LoadOC(Originlab\graph_utils.c)&quot;を使います。
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>..\Originlab\graph_utils.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span> <span style="color: #008000;">// layer_set_size 関数に必要</span>
GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;

<span style="color: #008000;">// グラフレイヤの元のサイズを取得</span>
<span style="color: #0000ff;">double</span> dWidth, dHeight;
layer_get_size<span style="color: #000000;">(</span>gl, dWidth, dHeight<span style="color: #000000;">)</span>;

<span style="color: #008000;">// レイヤサイズ変更</span>
dWidth <span style="color: #000040;">/</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
dHeight <span style="color: #000040;">/</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
layer_set_size<span style="color: #000000;">(</span>gl, dWidth, dHeight<span style="color: #000000;">)</span>;</pre>
<h2><a name="Swap_two_LayersGraph_Page.2C_Swap_Layers"></a><span class="mw-headline">2つのレイヤを入れ替える<span class="OIndex" style="display:none">Graph Page, Swap Layers</span></span></h2>
<p>次のサンプルは、レイヤ1と2のページの位置をインデックス番号を使って入れ替えます。
</p><p>次のコードをコンパイルする前に、現在のワークスペースにgraph_utils.cを追加する必要があります。これには、Labtalkコマンド&quot;Run.LoadOC(Originlab\graph_utils.c)&quot;を使います。
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>..\Originlab\graph_utils.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span> <span style="color: #008000;">// layer_swap_position関数に必要</span>
GraphPage gp<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Graph1&quot;</span><span style="color: #000000;">)</span>;
GraphLayer gl1 <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;
GraphLayer gl2 <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>;

layer_swap_position<span style="color: #000000;">(</span>gl1, gl2<span style="color: #000000;">)</span>;</pre>
<p>次のサンプルは、Layer1およびLayer2という名前のレイヤの位置を名前を入れ替えます。
</p>
<pre class="oc" style="font-family:monospace;">GraphPage gp<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Graph1&quot;</span><span style="color: #000000;">)</span>;
GraphLayer gl1 <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Layer1&quot;</span><span style="color: #000000;">)</span>;
GraphLayer gl2 <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Layer2&quot;</span><span style="color: #000000;">)</span>;

layer_swap_position<span style="color: #000000;">(</span>gl1, gl2<span style="color: #000000;">)</span>;</pre>
<h2><a name="Aligning_LayersLayer.2C_Alignment"></a><span class="mw-headline">レイヤを整列する<span class="OIndex" style="display:none">Layer, Alignment</span></span></h2>
<p>次のサンプルは、アクティブグラフレイヤのレイヤ1とレイヤ2を下辺に合わせて整列します。
</p><p>次のコードをコンパイルする前に、現在のワークスペースにgraph_utils.cを追加する必要があります。これには、Labtalkコマンド&quot;Run.LoadOC(Originlab\graph_utils.c)&quot;を使います。
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>..\Originlab\graph_utils.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span> <span style="color: #008000;">// layer_aligns関数に必要</span>
<span style="color: #008000;">// アクティブグラフページを取得</span>
GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
GraphPage gp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">GetPage</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;

GraphLayer gl1 <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;
GraphLayer gl2 <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>;

<span style="color: #008000;">// レイヤ2をレイヤ1に下辺で合わせる</span>
layer_aligns<span style="color: #000000;">(</span>gl1, gl2, POS_BOTTOM<span style="color: #000000;">)</span>;</pre>
<h2><a name="Linking_LayersGraph_Page.2C_Linking_Layers"></a><span class="mw-headline">レイヤをリンクする<span class="OIndex" style="display:none">Graph Page, Linking Layers</span></span></h2>
<p>次のサンプルは、アクティブグラフのすべてのレイヤのX軸をレイヤ1のX軸にリンクします。  単位は、リンクしたレイヤの%にセットされます。
</p><p>次のコードをコンパイルする前に、現在のワークスペースにgraph_utils.cを追加する必要があります。これには、Labtalkコマンド&quot;Run.LoadOC(Originlab\graph_utils.c)&quot;を使います。
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>..\Originlab\graph_utils.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span> <span style="color: #008000;">// layer_set_link関数に必要</span>
GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
GraphPage gp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">GetPage</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
GraphLayer gl1 <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// Layer 1</span>

foreach<span style="color: #000000;">(</span>GraphLayer glOne in gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
	<span style="color: #0000ff;">int</span> nUnit <span style="color: #000080;">=</span> M_LINK; <span style="color: #008000;">// レイヤの単位をリンクしたレイヤの%にセット</span>
	<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> glOne <span style="color: #000040;">!</span><span style="color: #000080;">=</span> gl1 <span style="color: #000000;">)</span>
		layer_set_link<span style="color: #000000;">(</span>glOne, gl1.<span style="color: #000000;">GetIndex</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>, LINK_STRAIGHT, LINK_NONE, <span style="color: #000040;">&amp;</span>nUnit<span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span></pre>
<h2><a name="Setting_Layer_UnitGraph_Layer.2C_Dimension"></a><span class="mw-headline">レイヤ単位をセットする<span class="OIndex" style="display:none">Graph Layer, Dimension</span></span></h2>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">int</span> nUnit <span style="color: #000080;">=</span> M_PIXEL;
GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;

<span style="color: #008000;">// 現在の位置を取得</span>
<span style="color: #0000ff;">double</span> dPos<span style="color: #000000;">[</span>TOTAL_POS<span style="color: #000000;">]</span>;
gl.<span style="color: #000000;">GetPosition</span><span style="color: #000000;">(</span>dPos<span style="color: #000000;">)</span>;

<span style="color: #008000;">// 位置を指定した単位に変換</span>
gl.<span style="color: #000000;">UnitsConvert</span><span style="color: #000000;">(</span>nUnit, dPos<span style="color: #000000;">)</span>;

<span style="color: #008000;">// 位置を単位でセット</span>
gl.<span style="color: #000000;">SetPosition</span><span style="color: #000000;">(</span>dPos, nUnit<span style="color: #000000;">)</span>;</pre>







    