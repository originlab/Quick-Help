<h1 class="firstheading">GetNダイアログ</h1>
<p><span class="OIndex" style="display: none;">GetN Simple Dialog</span></p>
<div id="toc" class="toc">
<div id="toctitle">
<h2>目次</h2>
</div>
<ol>
<li class="toclevel-1 tocsection-1"><a href="#Simple_Dialog"><span class="tocnumber">1</span> <span class="toctext">シンプルなダイアログ</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Controls"><span class="tocnumber">2</span> <span class="toctext">コントロール</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Event_Handler"><span class="tocnumber">3</span> <span class="toctext">イベントハンドラ</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Apply_Button"><span class="tocnumber">4</span> <span class="toctext">適用ボタン</span></a></li>
</ol>
</div>
<h2><a name="Simple_Dialog" id="Simple_Dialog"></a><span class="mw-headline">シンプルなダイアログ</span></h2>
<p><a href="../../OriginC/Category/GetN_(OriginC).html" title="Category:GetN (OriginC)">GetN</a> マクロと<a href="../../OriginC/OriginC/GetNBox_(global_function).html" title="OriginC:GetNBox (global function)">GetNBox</a> 関数を使用して、シンプルなダイアログを作成できます。</p>
<p>ダイアログは、下図のようなものです。</p>
<div style="text-align: center;">
<p><a class="image"><img alt="Creat simple dialog.png" src="../images/GetN_Dialog/Creat_simple_dialog.png" width="368" height="261" border="0" /></a></p>
</div>
<p>次の関数を実行して上のダイアログを開きます。</p>
<pre class="oc" style="font-family: monospace;">
<span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>GetNbox.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span><span style="color: #0000ff;">
void</span> simple_dialog<span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">
{</span>
    GETN_BOX<span style="color: #000000;">(</span>trRoot<span style="color: #000000;">)</span>   <span style="color: #008000;">// "trRoot" というツリー変数を定義</span>
    
    <span style="color: #008000;">// データ範囲のコントロール</span>
    GETN_INTERACTIVE<span style="color: #000000;">(</span>Input, <span style="color: #ff00ff;">"Input data"</span>, <span style="color: #ff00ff;">"[Book1]Sheet1!A"</span><span style="color: #000000;">)</span>
    
    <span style="color: #008000;">// ラジオボタン</span>
    GETN_RADIO_INDEX_EX<span style="color: #000000;">(</span>Operator, <span style="color: #ff00ff;">"Operator"</span>, <span style="color: #0000dd;">0</span>, <span style="color: #ff00ff;">"Add|Subtract"</span><span style="color: #000000;">)</span>
    
    <span style="color: #008000;">// リストボックス</span>
    GETN_LIST<span style="color: #000000;">(</span>type, <span style="color: #ff00ff;">"Operand"</span>, <span style="color: #0000dd;">0</span>, <span style="color: #ff00ff;">"Constant|Reference Data"</span><span style="color: #000000;">)</span>
    
    <span style="color: #008000;">// 文字列編集ボックス </span>
    GETN_STR<span style="color: #000000;">(</span>Constant, <span style="color: #ff00ff;">"Constant"</span>, <span style="color: #ff00ff;">"10"</span><span style="color: #000000;">)</span>
    
    <span style="color: #008000;">// 参照データのデータ範囲を選択</span>
    GETN_INTERACTIVE<span style="color: #000000;">(</span>Reference, <span style="color: #ff00ff;">"Reference Data"</span>, <span style="color: #ff00ff;">"[Book1]Sheet1!B"</span><span style="color: #000000;">)</span>
    
    <span style="color: #008000;">// 出力データのための列を選択</span>
    GETN_INTERACTIVE<span style="color: #000000;">(</span>Output, <span style="color: #ff00ff;">"Output data"</span>, <span style="color: #ff00ff;">"[Book1]Sheet1!C"</span><span style="color: #000000;">)</span>  
    <span style="color: #008000;">// ダイアログを開く</span>
    GetNBox<span style="color: #000000;">(</span>trRoot <span style="color: #000000;">)</span>;<span style="color: #000000;">
}</span>
</pre>
<h2><a name="Controls" id="Controls"></a><span class="mw-headline">コントロール</span></h2>
<p>次表に、一般的なコントロールを示します。他のコントロールと、スタイルの設定については、<a href="../../OriginC/Category/GetN_(OriginC).html" title="Category:GetN (OriginC)">Origin C Reference: Macros: GetN</a>を確認してください。</p>
<table class="TableGrid" style="border-collapse: separate; border-collapse: separate;" border="1">
<tr>
<th style="width: 2%;" bgcolor="#EFEFEF">画像</th>
<th style="width: 18%;" bgcolor="#EFEFEF">名前</th>
</tr>
<tr>
<td style="text-align: center;"><a class="image"><img alt="Radio.png" src="../images/GetN_Dialog/Radio.png" width="14" border="0" /></a></td>
<td>
<ul>
<li><a href="../../OriginC/OriginC/GETN_RADIO_INDEX.html" title="OriginC:GETN RADIO INDEX">GETN_RADIO_INDEX</a></li>
<li><a href="../../OriginC/OriginC/GETN_RADIO_INDEX_EX.html" title="OriginC:GETN RADIO INDEX EX">GETN_RADIO_INDEX_EX</a></li>
</ul>
</td>
</tr>
<tr>
<td style="text-align: center;"><a class="image"><img alt="Checkbox.png" src="../images/GetN_Dialog/Checkbox.png" width="15" border="0" /></a></td>
<td>
<ul>
<li><a href="../../OriginC/OriginC/GETN_CHECK.html" title="OriginC:GETN CHECK">GETN_CHECK</a></li>
</ul>
</td>
</tr>
<tr>
<td style="text-align: center;"><a class="image"><img alt="Listbox.png" src="../images/GetN_Dialog/Listbox.png" width="46" border="0" /></a></td>
<td>
<ul>
<li><a href="../../OriginC/OriginC/GETN_LISTBOX.html" title="OriginC:GETN LISTBOX">GETN_LISTBOX</a></li>
<li><a href="../../OriginC/OriginC/GETN_MULTISEL_LISTBOX.html" title="OriginC:GETN MULTISEL LISTBOX">GETN_MULTISEL_LISTBOX</a></li>
</ul>
</td>
</tr>
<tr>
<td style="text-align: center;"><a class="image"><img alt="Button group.png" src="../images/GetN_Dialog/Button_group.png" width="72" border="0" /></a></td>
<td>
<ul>
<li><a href="../../OriginC/OriginC/GETN_BUTTON_GROUP.html" title="OriginC:GETN BUTTON GROUP">GETN_BUTTON_GROUP</a></li>
</ul>
</td>
</tr>
<tr>
<td style="text-align: center;"><a class="image"><img alt="Button.png" src="../images/GetN_Dialog/Button.png" width="78" border="0" /></a></td>
<td>
<ul>
<li><a href="../../OriginC/OriginC/GETN_BUTTON.html" title="OriginC:GETN BUTTON">GETN_BUTTON</a></li>
</ul>
</td>
</tr>
<tr>
<td style="text-align: center;"><a class="image"><img alt="Combo edit.png" src="../images/GetN_Dialog/Combo_edit.png" width="70" border="0" /></a>
<p><a class="image"><img alt="Combo.png" src="../images/GetN_Dialog/Combo.png" width="93" border="0" /></a></p>
</td>
<td>
<ul>
<li><a href="../../OriginC/OriginC/GETN_COMBO.html" title="OriginC:GETN COMBO">GETN_COMBO</a>(数値)</li>
<li><a href="../../OriginC/OriginC/GETN_LIST.html" title="OriginC:GETN LIST">GETN_LIST</a>(文字列。選択のインデックスを返す)</li>
<li><a href="../../OriginC/OriginC/GETN_STRLIST.html" title="OriginC:GETN STRLIST">GETN_STRLIST</a>(文字列。選択されたテキストを返す)</li>
<li><a href="../../OriginC/OriginC/GETN_STR_GROUP.html" title="OriginC:GETN STR GROUP">GETN_STR_GROUP</a>(複数選択)</li>
</ul>
</td>
</tr>
<tr>
<td style="text-align: center;"><a class="image"><img alt="Combo button.png" src="../images/GetN_Dialog/Combo_button.png" width="109" height="23" border="0" /></a></td>
<td>
<ul>
<li><a href="../../OriginC/OriginC/GETN_COMBO_BUTTON.html" title="OriginC:GETN COMBO BUTTON">GETN_COMBO_BUTTON</a></li>
</ul>
</td>
</tr>
<tr>
<td style="text-align: center;"><a class="image"><img alt="Range.png" src="../images/GetN_Dialog/Range.png" width="102" border="0" /></a></td>
<td>
<ul>
<li><a href="../../OriginC/OriginC/GETN_RANGE.html" title="OriginC:GETN RANGE">GETN_RANGE</a></li>
</ul>
</td>
</tr>
<tr>
<td style="text-align: center;"><a class="image"><img alt="Editbox.png" src="../images/GetN_Dialog/Editbox.png" width="120" border="0" /></a></td>
<td>
<ul>
<li><a href="../../OriginC/OriginC/GETN_STR.html" title="OriginC:GETN STR">GETN_STR</a>(文字列)</li>
<li><a href="../../OriginC/OriginC/GETN_NUM.html" title="OriginC:GETN NUM">GETN_NUM</a>(数値)</li>
<li><a href="../../OriginC/OriginC/GETN_MULTILINE_TEXT.html" title="OriginC:GETN MULTILINE TEXT">GETN_MULTILINE_TEXT</a>(複数行テキスト)</li>
</ul>
</td>
</tr>
<tr>
<td style="text-align: center;"><a class="image"><img alt="SPINNOR DOUBLE.png" src="../images/GetN_Dialog/SPINNOR_DOUBLE.png" width="138" border="0" /></a></td>
<td>
<ul>
<li><a href="../../OriginC/OriginC/GETN_SPINNOR_DOUBLE.html" title="OriginC:GETN SPINNOR DOUBLE">GETN_SPINNOR_DOUBLE</a></li>
</ul>
</td>
</tr>
<tr>
<td style="text-align: center;"><a class="image"><img alt="Slider.png" src="../images/GetN_Dialog/Slider.png" width="150" border="0" /></a></td>
<td>
<ul>
<li><a href="../../OriginC/OriginC/GETN_SLIDER.html" title="OriginC:GETN SLIDER">GETN_SLIDER</a></li>
<li><a href="../../OriginC/OriginC/GETN_SLIDEREDIT.html" title="OriginC:GETN SLIDEREDIT">GETN_SLIDEREDIT</a>(編集可)</li>
</ul>
</td>
</tr>
<tr>
<td style="text-align: center;"><a class="image"><img alt="Color.png" src="../images/GetN_Dialog/Color.png" width="100" border="0" /></a></td>
<td>
<ul>
<li><a href="../../OriginC/OriginC/GETN_COLOR.html" title="OriginC:GETN COLOR">GETN_COLOR</a></li>
</ul>
</td>
</tr>
<tr>
<td style="text-align: center;"><a class="image"><img alt="Symbol.png" src="../images/GetN_Dialog/Symbol.png" width="111" border="0" /></a></td>
<td>
<ul>
<li><a href="../../OriginC/OriginC/GETN_SYMBOL.html" title="OriginC:GETN SYMBOL">GETN_SYMBOL</a></li>
</ul>
</td>
</tr>
<tr>
<td style="text-align: center;"><a class="image"><img alt="SEPARATOR LINE.png" src="../images/GetN_Dialog/SEPARATOR_LINE.png" width="115" border="0" /></a></td>
<td>
<ul>
<li><a href="../../OriginC/OriginC/GETN_SEPARATOR_LINE.html" title="OriginC:GETN SEPARATOR LINE">GETN_SEPARATOR_LINE</a></li>
</ul>
</td>
</tr>
<tr>
<td style="text-align: center;"><a class="image"><img alt="Data.png" src="../images/GetN_Dialog/Data.png" width="102" border="0" /></a></td>
<td>
<ul>
<li><a href="../../OriginC/OriginC/GETN_DATE.html" title="OriginC:GETN DATE">GETN_DATE</a></li>
</ul>
</td>
</tr>
<tr>
<td style="text-align: center;"><a class="image"><img alt="Times.png" src="../images/GetN_Dialog/Times.png" width="122" border="0" /></a></td>
<td>
<ul>
<li><a href="../../OriginC/OriginC/GETN_TIME.html" title="OriginC:GETN TIME">GETN_TIME</a></li>
</ul>
</td>
</tr>
<tr>
<td style="text-align: center;"><a class="image"><img alt="Password.png" src="../images/GetN_Dialog/Password.png" width="167" border="0" /></a></td>
<td>
<ul>
<li><a href="../../OriginC/OriginC/GETN_PASSWORD.html" title="OriginC:GETN PASSWORD">GETN_PASSWORD</a></li>
</ul>
</td>
</tr>
<tr>
<td style="text-align: center;"><a class="image"><img alt="Input data.png" src="../images/GetN_Dialog/Input_data.png" width="192" border="0" /></a>
<p><a class="image"><img alt="Data range.png" src="../images/GetN_Dialog/Data_range.png" width="192" border="0" /></a></p>
</td>
<td>
<ul>
<li><a href="../../OriginC/OriginC/GETN_XYRANGE.html" title="OriginC:GETN XYRANGE">GETN_XYRANGE</a></li>
<li><a href="../../OriginC/OriginC/GETN_XYRANGE_COMPLEX.html" title="OriginC:GETN XYRANGE COMPLEX">GETN_XYRANGE_COMPLEX</a></li>
<li><a href="../../OriginC/OriginC/GETN_XYZRANGE.html" title="OriginC:GETN XYZRANGE">GETN_XYZRANGE</a></li>
<li><a href="../../OriginC/OriginC/GETN_INTERACTIVE.html" title="OriginC:GETN INTERACTIVE">GETN_INTERACTIVE</a></li>
</ul>
</td>
</tr>
</table>
<h2><a name="Event_Handler" id="Event_Handler"></a><span class="mw-headline">イベントハンドラ</span></h2>
<p>上のダイアログで、ダイナミックな表示/非表示の制御や、コンボリストの構築などのために、<i>node_event</i> 関数を追加できます。</p>
<p>以下のサンプル関数</p>
<pre class="oc" style="font-family: monospace;">
GetNBox<span style="color: #000000;">(</span>trRoot<span style="color: #000000;">)</span>;
</pre>
<p>を次のようにします。</p>
<pre class="oc" style="font-family: monospace;">
GetNBox<span style="color: #000000;">(</span>trRoot, node_event<span style="color: #000000;">)</span>;
</pre>
<p>以下のようにイベント関数を追加します。</p>
<pre class="oc" style="font-family: monospace;">
<span style="color: #0000ff;">int</span> node_event<span style="color: #000000;">(</span>TreeNode<span style="color: #000040;">&amp;</span> trRoot, <span style="color: #0000ff;">int</span> nRow, <span style="color: #0000ff;">int</span> nEvent, DWORD<span style="color: #000040;">&amp;</span> dwEnables,  
        LPCSTR lpcszNodeName, WndContainer<span style="color: #000040;">&amp;</span> getNContainer, string<span style="color: #000040;">&amp;</span> strAux, 
        string<span style="color: #000040;">&amp;</span> strErrMsg<span style="color: #000000;">)</span><span style="color: #000000;">
{</span>
    <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> lstrcmp<span style="color: #000000;">(</span>lpcszNodeName, <span style="color: #ff00ff;">"type"</span><span style="color: #000000;">)</span> <span style="color: #000040;">||</span> GETNE_ON_VALUE_CHANGE <span style="color: #000080;">==</span> nEvent 
    <span style="color: #000040;">||</span> GETNE_ON_INIT <span style="color: #000080;">==</span> nEvent <span style="color: #000000;">)</span>
    <span style="color: #000000;">{</span>
        trRoot.<span style="color: #000000;">Constant</span>.<span style="color: #000000;">Show</span> <span style="color: #000080;">=</span> <span style="color: #000000;">(</span><span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> trRoot.<span style="color: #000000;">type</span>.<span style="color: #000000;">nVal</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// Constantを表示</span>
        trRoot.<span style="color: #000000;">Reference</span>.<span style="color: #000000;">Show</span> <span style="color: #000080;">=</span> <span style="color: #000000;">(</span><span style="color: #0000dd;">1</span> <span style="color: #000080;">==</span> trRoot.<span style="color: #000000;">type</span>.<span style="color: #000000;">nVal</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// 参照を表示</span>
    <span style="color: #000000;">}</span>
    <span style="color: #0000ff;">return</span> <span style="color: #0000dd;">0</span>;   <span style="color: #000000;">
}</span>
</pre>
<h2><a name="Apply_Button" id="Apply_Button"></a><span class="mw-headline">適用ボタン</span></h2>
<p>デフォルトの GetN ダイアログには、OKとキャンセルボタンがありますが、適用ボタンはオプションです適用ボタンが表示されていて、ユーザがこのボタンをクリックすると、ある操作のためのイベント関数を呼び出すことができます。</p>
<p>次のサンプルは、GetN ダイアログに適用ボタンを追加する方法と、適用ボタンをクリックした際にイベント関数<i>_apply_event</i> を呼び出す方法を示します。</p>
<pre class="oc" style="font-family: monospace;">
<span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>GetNbox.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span><span style="color: #0000ff;">
void</span> GETN_Apply_ex1<span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">
{</span>
    GETN_TREE<span style="color: #000000;">(</span>tr<span style="color: #000000;">)</span>    
    GETN_COLOR<span style="color: #000000;">(</span>LineColor, <span style="color: #ff00ff;">"Color"</span>, <span style="color: #0000dd;">3</span><span style="color: #000000;">)</span>
    <span style="color: #008000;">// カスタムパネルを含めるためのカラーリストをセットするオプション</span>
    GETN_COLOR_CHOICE_OPTIONS<span style="color: #000000;">(</span>COLORLIST_CUSTOM <span style="color: #000040;">|</span> COLORLIST_SINGLE<span style="color: #000000;">)</span> 
    
    <span style="color: #0000ff;">bool</span> bShowApply <span style="color: #000080;">=</span> <span style="color: #0000ff;">true</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span>GetNBox<span style="color: #000000;">(</span>tr, <span style="color: #0000ff;">NULL</span>, <span style="color: #ff00ff;">"Example"</span>, <span style="color: #0000ff;">NULL</span>, GetWindow<span style="color: #000000;">(</span><span style="color: #000000;">)</span>, bShowApply, 
                _apply_event<span style="color: #000000;">)</span><span style="color: #000000;">)</span>
    <span style="color: #000000;">{</span>
            out_str<span style="color: #000000;">(</span><span style="color: #ff00ff;">"Click OK"</span><span style="color: #000000;">)</span>;
    <span style="color: #000000;">}</span><span style="color: #000000;">
}</span><span style="color: #008000;">
// 適用ボタンイベント関数のインターフェースは、</span><span style="color: #008000;">
// PAPPLY_FUNC typedef を参照</span><span style="color: #0000ff;">
bool</span> _apply_event<span style="color: #000000;">(</span>TreeNode<span style="color: #000040;">&amp;</span> tr<span style="color: #000000;">)</span><span style="color: #000000;">
{</span>
    <span style="color: #0000ff;">int</span> nIndex <span style="color: #000080;">=</span> tr.<span style="color: #000000;">LineColor</span>.<span style="color: #000000;">nVal</span>;     
    UINT cr <span style="color: #000080;">=</span> color_index_to_rgb<span style="color: #000000;">(</span>nIndex<span style="color: #000000;">)</span>;
    <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Red = %d, Green = %d, Blue = %d<span style="color: #666666; font-weight: bold;">\n</span>"</span>, GetRValue<span style="color: #000000;">(</span>cr<span style="color: #000000;">)</span>, 
                GetGValue<span style="color: #000000;">(</span>cr<span style="color: #000000;">)</span>, GetBValue<span style="color: #000000;">(</span>cr<span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
    <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span>;<span style="color: #000000;">
}</span>
</pre>
<table class="noborder">
<tr>
<td style="vertical-align: top;" width="60"><img src="../images/GetN_Dialog/Tip_icon.png" alt="" width="57" border="0" /></td>
<td>
<p>デフォルトでは、GetNダイアログの適用ボタンは最初のクリックでは非アクティブ状態で、GetNダイアログで変更が加えられるまでアクティブになりません。適用ボタンを常時アクティブにしたい場合、システム変数@EAB = 0に設定します。</p>
</td>
</tr>
</table>
