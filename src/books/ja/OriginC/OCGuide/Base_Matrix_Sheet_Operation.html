<h1 class="firstheading">行列シートの基本操作</h1><p>行列シートとワークシートは、Originオブジェクト構造でのレベルが同じため、このセクションのサンプルは、<a href="../../OriginC/OCGuide/Worksheet_Basic_Operation.html" title="OCGuide:Worksheet Basic Operation">ワークシートの基本操作</a>の章で紹介しているものと似通っています。
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Add_New_Matrix_Sheet"><span class="tocnumber">1</span> <span class="toctext">新しい行列シートを追加する</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Activate_a_Matrixsheet"><span class="tocnumber">2</span> <span class="toctext">行列シートをアクティブにする</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Delete_Matrixsheet"><span class="tocnumber">3</span> <span class="toctext">行列シートを削除する</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Access_Matrixsheets_in_Matrixbookmatrixbook.2C_Get_One_Sheetmatrixbook.2C_Get_Name"><span class="tocnumber">4</span> <span class="toctext">行列ブック内の行列シートにアクセスする<span class="OIndex" style="display:none">matrixbook, Get One Sheet</span><span class="OIndex" style="display:none">matrixbook, Get Name</span></span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Modify_Matrixsheet_Properties"><span class="tocnumber">5</span> <span class="toctext">行列シートのプロパティを修正する</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#Get_and_Set_Dimensions"><span class="tocnumber">5.1</span> <span class="toctext">次数の取得と設定</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Get_and_Set_Labels"><span class="tocnumber">5.2</span> <span class="toctext">ラベルの取得と設定</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Format_Matrixsheet"><span class="tocnumber">5.3</span> <span class="toctext">行列シートのフォーマット</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Get_and_Set_Matrix_Cell_Text_Color"><span class="tocnumber">5.4</span> <span class="toctext">行列セルテキスト色の取得と設定</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="Add_New_Matrix_Sheet"></a><span class="mw-headline">新しい行列シートを追加する</span></h2>
<p><span class="OIndex" style="display:none">Matrixbook, Add One Sheet</span><span class="OIndex" style="display:none">Matrixbook, Activate a Sheet</span><a href="../../OriginC/OriginC/Page-AddLayer.html" title="OriginC:Page-AddLayer">AddLayer</a>メソッドを使用して、行列ブック内の行列シートを追加します。
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// &quot;MBook1&quot;という名前の行列ブックにアクセス</span>
MatrixPage mp<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;MBook1&quot;</span><span style="color: #000000;">)</span>;

<span style="color: #008000;">// 行列ブックに新しいシートを追加</span>
<span style="color: #0000ff;">int</span> index <span style="color: #000080;">=</span> mp.<span style="color: #000000;">AddLayer</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;New Matrix Sheet&quot;</span><span style="color: #000000;">)</span>; 

<span style="color: #008000;">// 新しい行列シートにアクセス</span>
MatrixLayer mlayerNew <span style="color: #000080;">=</span> mp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span>index<span style="color: #000000;">)</span>;</pre>
<h2><a name="Activate_a_Matrixsheet"></a><span class="mw-headline">行列シートをアクティブにする</span></h2>
<p><span class="OIndex" style="display:none">Active Matrixsheet</span><span class="OIndex" style="display:none">Active Window</span><span class="OIndex" style="display:none">Active Workbook</span><span class="OIndex" style="display:none">Active Matrixbook</span>行列ブック内のシートをアクティブにするには、関数<a href="../../OriginC/OriginC/Set_active_layer_(global_function).html" title="OriginC:Set active layer (global function)"> set_active_layer </a>を使用できます。
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// フルネームで行列シートにアクセス</span>
MatrixLayer mLayer<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;[MBook1]MSheet1&quot;</span><span style="color: #000000;">)</span>;

<span style="color: #008000;">// この行列シートをアクティブに設定</span>
set_active_layer<span style="color: #000000;">(</span>mLayer<span style="color: #000000;">)</span>;</pre>
<h2><a name="Delete_Matrixsheet"></a><span class="mw-headline">行列シートを削除する</span></h2>
<p><a href="../../OriginC/OriginC/OriginObject-Destroy.html" title="OriginC:OriginObject-Destroy">Destroy </a>メソッドを使用して行列シートを削除します。
</p>
<pre class="oc" style="font-family:monospace;">MatrixLayer ly <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> ly <span style="color: #000000;">)</span> <span style="color: #008000;">// アクティブレイヤが行列シートの場合</span>
    ly.<span style="color: #000000;">Destroy</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// 行列シートを削除</span></pre>
<h2><a name="Access_Matrixsheets_in_Matrixbookmatrixbook.2C_Get_One_Sheetmatrixbook.2C_Get_Name"></a><span class="mw-headline">行列ブック内の行列シートにアクセスする<span class="OIndex" style="display:none">matrixbook, Get One Sheet</span><span class="OIndex" style="display:none">matrixbook, Get Name</span></span></h2>
<p>ワークブック内のワークシートにアクセスするのと同様、行列ブック内の行列シートへは以下の方法によりアクセスできます。
</p>
<ol>
<li>全レイヤ名による </li>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// 行列シートのフルネーム</span>
string strFullName <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;[MBook1]MSheet1!&quot;</span>;

<span style="color: #008000;">// 行列シートのインスタンスを構成し、名前を付けたシートを付加</span>
MatrixLayer matLy1<span style="color: #000000;">(</span>strFullName<span style="color: #000000;">)</span>;

<span style="color: #008000;">// 名前付きシートに既存行列のインスタンスを付加</span>
matLy2.<span style="color: #000000;">Attach</span><span style="color: #000000;">(</span>strFullName<span style="color: #000000;">)</span>;</pre>
<li>行列ブックには、行列レイヤのコレクションが含まれています。全ての特定の行列ブック内の行列レイヤを 、<b>foreach</b>ステートメントを使用してループします。 </li>
<pre class="oc" style="font-family:monospace;">MatrixPage matPage<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;MBook1&quot;</span><span style="color: #000000;">)</span>;
foreach<span style="color: #000000;">(</span>Layer ly in matPage.<span style="color: #000000;">Layers</span><span style="color: #000000;">)</span>
    out_str<span style="color: #000000;">(</span>ly.<span style="color: #000000;">GetName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;</pre>
<li>名前かインデックスで特定の行列シートにアクセス</li>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// ページ MBook1には、最低でも2つの行列シートがあると仮定</span>
<span style="color: #008000;">// それらのシート名は、MSheet1 と MSheet2 </span>
MatrixPage matPage<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;MBook1&quot;</span><span style="color: #000000;">)</span>;
MatrixLayer lyFirst <span style="color: #000080;">=</span> matPage.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>; <span style="color: #008000;">//インデックスによる</span>
MatrixLayer lySecond <span style="color: #000080;">=</span> matPage.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;MSheet2&quot;</span><span style="color: #000000;">)</span>; <span style="color: #008000;">//名前による</span></pre>
</ol>
<h2><a name="Modify_Matrixsheet_Properties"></a><span class="mw-headline">行列シートのプロパティを修正する</span></h2>
<h3><a name="Get_and_Set_Dimensions"></a><span class="mw-headline">次数の取得と設定</span></h3>
<p>Originでは、行列シート内のすべての行列オブジェクトは同じ次数（列と行の数が同じ）を共有します。
</p>
<ol>
<li>行列シートの行と列の数を取得するには、まず行列シートの最初の行列オブジェクトを取得し、<a href="../../OriginC/Category/MatrixObject_(class).html" title="Category:MatrixObject (class)">MatrixObject</a> クラスのメソッド (<a href="../../OriginC/OriginC/MatrixObject-GetNumCols.html" title="OriginC:MatrixObject-GetNumCols">GetNumCols</a> と <a href="../../OriginC/OriginC/MatrixObject-GetNumRows.html" title="OriginC:MatrixObject-GetNumRows">GetNumRows</a>) を使用します。 </li>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// 行と列の数を取得</span>
MatrixLayer ml <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// アクティブ行列シートを取得	</span>
MatrixObject mo <span style="color: #000080;">=</span> ml.<span style="color: #000000;">MatrixObjects</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// 第1行列オブジェクトを取得</span>

<span style="color: #0000ff;">int</span> nNumRows <span style="color: #000080;">=</span> mo.<span style="color: #000000;">GetNumRows</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">// 行数を取得</span>
<span style="color: #0000ff;">int</span> nNumCols <span style="color: #000080;">=</span> mo.<span style="color: #000000;">GetNumCols</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">// 列数を取得</span></pre>
<li>行列シートの次数を設定するには、<a href="../../OriginC/OriginC/MatrixLayer-SetSize.html" title="OriginC:MatrixLayer-SetSize">MatrixLayer::SetSize</a> メソッドを使用します。 </li>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// 行と列の数を設定</span>
MatrixLayer ml <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// アクティブ行列シートを取得</span>
ml.<span style="color: #000000;">SetSize</span><span style="color: #000000;">(</span><span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">5</span>, <span style="color: #0000dd;">5</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">//次数を 5x5 に設定</span></pre>
<li><a href="../../OriginC/Category/MatrixObject_(class).html" title="Category:MatrixObject (class)">MatrixObject</a> クラスは、次数設定のためのメソッド <a href="../../OriginC/OriginC/MatrixObject-SetSize.html" title="OriginC:MatrixObject-SetSize">SetSize </a>を提供します。しかし、同じ行列シート内の全行列オブジェクトの次数は同じであるため、<a href="../../OriginC/Category/MatrixObject_(class).html" title="Category:MatrixObject (class)">MatrixObject</a>で定義されるメソッドであるにも関わらず、行列シートの次数が変更されることに注意してください。 </li>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// 行と列の数を設定</span>
MatrixLayer ml <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// アクティブな行列シートを取得 </span>
MatrixObject mo <span style="color: #000080;">=</span> ml.<span style="color: #000000;">MatrixObjects</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// 第1オブジェクトを取得</span>

<span style="color: #0000ff;">int</span> nNumRows <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>, nNumCols <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>;
mo.<span style="color: #000000;">SetSize</span><span style="color: #000000;">(</span>nNumRows, nNumCols<span style="color: #000000;">)</span>;  <span style="color: #008000;">// 次数を 5x5 に設定</span></pre>
<li>行列は、番号が付けられた列と行を持ち、これらは等間隔で線形にマッピングされたX値およびY値です。<a href="../../OriginC/OriginC/MatrixObject-SetXY.html" title="OriginC:MatrixObject-SetXY">SetXY </a>メソッドでXY のマッピング座標を設定できます。Note: このメソッドは、行列オブジェクトによって利用可能ですが、XYマッピングは同じ行列シート上で共有します。 </li>
<pre class="oc" style="font-family:monospace;">MatrixLayer ml <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">// アクティブレイヤを取得</span>
MatrixObject mo <span style="color: #000080;">=</span> ml.<span style="color: #000000;">MatrixObjects</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">// 第1行列オブジェクトを取得</span>
mo.<span style="color: #000000;">SetXY</span><span style="color: #000000;">(</span><span style="color: #000040;">-</span><span style="color: #0000dd;">10</span>, <span style="color: #0000dd;">20</span>, <span style="color: #000040;">-</span><span style="color: #0000dd;">2.3</span>, <span style="color: #0000dd;">12.4</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">// Xを -10 から 20 にし、Yを -2.3 から 12.4 に設定</span></pre>
</ol>
<h3><a name="Get_and_Set_Labels"></a><span class="mw-headline">ラベルの取得と設定</span></h3>
<p>行列のラベルには、X、Y、Zに対するロングネーム、単位、コメントが含まれます。XとYのラベルは、行列シート内の全行列オブジェクトで共通で、Zのラベルは各行列オブジェクトで固有です。次のコードは、ラベルの取得と設定の方法を示しています。
</p>
<ol>
<li>XYラベルを設定 <span class="OIndex" style="display:none">Matrixsheet, Get/Set Labels for XY</span></li>
<pre class="oc" style="font-family:monospace;">MatrixPage mp<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;MBook1&quot;</span><span style="color: #000000;">)</span>;
MatrixLayer ml <span style="color: #000080;">=</span> mp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// 第1行列シート	</span>

Tree tr;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimensions</span>.<span style="color: #000000;">X</span>.<span style="color: #000000;">LongName</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;X Values&quot;</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimensions</span>.<span style="color: #000000;">X</span>.<span style="color: #000000;">Unit</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;X Units&quot;</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimensions</span>.<span style="color: #000000;">X</span>.<span style="color: #000000;">Comment</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;X Comment&quot;</span>;

tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimensions</span>.<span style="color: #000000;">Y</span>.<span style="color: #000000;">LongName</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Y Values&quot;</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimensions</span>.<span style="color: #000000;">Y</span>.<span style="color: #000000;">Unit</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Y Units&quot;</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimensions</span>.<span style="color: #000000;">Y</span>.<span style="color: #000000;">Comment</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Y Comment&quot;</span>;

<span style="color: #008000;">// XYラベルのための行列シート上でフォーマットをセット</span>
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> ml.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">(</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
	ml.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">(</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>;</pre>
<li>XYラベルを取得 </li>
<pre class="oc" style="font-family:monospace;">MatrixPage mp<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;MBook1&quot;</span><span style="color: #000000;">)</span>;
MatrixLayer ml <span style="color: #000080;">=</span> mp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// 第1行列シート</span>

<span style="color: #008000;">// 行列オブジェクトではなく行列シートのXYラベルを取得</span>
Tree tr;
tr <span style="color: #000080;">=</span> ml.<span style="color: #000000;">GetFormat</span><span style="color: #000000;">(</span>FPB_ALL, FOB_ALL, <span style="color: #0000ff;">TRUE</span>, <span style="color: #0000ff;">TRUE</span><span style="color: #000000;">)</span>;

TreeNode trX <span style="color: #000080;">=</span> tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimensions</span>.<span style="color: #000000;">X</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #000040;">!</span>trX.<span style="color: #000000;">LongName</span>.<span style="color: #000000;">IsEmpty</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
	<span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;X Long Name:&nbsp;%s<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, trX.<span style="color: #000000;">LongName</span>.<span style="color: #000000;">strVal</span><span style="color: #000000;">)</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #000040;">!</span>trX.<span style="color: #000000;">Unit</span>.<span style="color: #000000;">IsEmpty</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
	<span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;X Unit:&nbsp;%s<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, trX.<span style="color: #000000;">Unit</span>.<span style="color: #000000;">strVal</span><span style="color: #000000;">)</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #000040;">!</span>trX.<span style="color: #000000;">Comment</span>.<span style="color: #000000;">IsEmpty</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
	<span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;X Comment:&nbsp;%s<span style="color: #666666; font-weight: bold;">\n</span><span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, trX.<span style="color: #000000;">Comment</span>.<span style="color: #000000;">strVal</span><span style="color: #000000;">)</span>;

TreeNode <span style="color: #0000ff;">trY</span> <span style="color: #000080;">=</span> tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimensions</span>.<span style="color: #000000;">Y</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #000040;">!</span><span style="color: #0000ff;">trY</span>.<span style="color: #000000;">LongName</span>.<span style="color: #000000;">IsEmpty</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
	<span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Y Long Name:&nbsp;%s<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, <span style="color: #0000ff;">trY</span>.<span style="color: #000000;">LongName</span>.<span style="color: #000000;">strVal</span><span style="color: #000000;">)</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #000040;">!</span><span style="color: #0000ff;">trY</span>.<span style="color: #000000;">Unit</span>.<span style="color: #000000;">IsEmpty</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
	<span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Y Unit:&nbsp;%s<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, <span style="color: #0000ff;">trY</span>.<span style="color: #000000;">Unit</span>.<span style="color: #000000;">strVal</span><span style="color: #000000;">)</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #000040;">!</span><span style="color: #0000ff;">trY</span>.<span style="color: #000000;">Comment</span>.<span style="color: #000000;">IsEmpty</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
	<span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Y Comment:&nbsp;%s<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, <span style="color: #0000ff;">trY</span>.<span style="color: #000000;">Comment</span>.<span style="color: #000000;">strVal</span><span style="color: #000000;">)</span>;</pre>
<li>Zラベルを設定<span class="OIndex" style="display:none">Matrixsheet, Get/Set Labels for Z</span></li>
<pre class="oc" style="font-family:monospace;">MatrixPage mp<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;MBook1&quot;</span><span style="color: #000000;">)</span>;
MatrixLayer ml <span style="color: #000080;">=</span> mp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// 第1行列シート</span>
MatrixObject mo <span style="color: #000080;">=</span> ml.<span style="color: #000000;">MatrixObjects</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;<span style="color: #008000;">// 第1行列オブジェクト</span>

<span style="color: #008000;">// フォーマットツリーを構成して文字列値をツリーノードに割り当て</span>
Tree tr;	
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">LongName</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Z Long Name&quot;</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Unit</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Z Units&quot;</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Comment</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Z Comment&quot;</span>;

<span style="color: #008000;">// 行列シートではなく、行列オブジェクトにZラベルを適用</span>
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> mo.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">(</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span> <span style="color: #008000;">// 各ツリーノードのIDを追加</span>
	mo.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">(</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>;	<span style="color: #008000;">// 適用</span></pre>
<li>Zラベル取得 </li>
<pre class="oc" style="font-family:monospace;">MatrixPage mp<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;MBook1&quot;</span><span style="color: #000000;">)</span>;
MatrixLayer ml <span style="color: #000080;">=</span> mp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// 第1行列シート</span>
MatrixObject mo <span style="color: #000080;">=</span> ml.<span style="color: #000000;">MatrixObjects</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;

Tree tr;	
tr <span style="color: #000080;">=</span> mo.<span style="color: #000000;">GetFormat</span><span style="color: #000000;">(</span>FPB_ALL, FOB_ALL, <span style="color: #0000ff;">TRUE</span>, <span style="color: #0000ff;">TRUE</span><span style="color: #000000;">)</span>;

<span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Z Short Name:&nbsp;%s<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">ShortName</span>.<span style="color: #000000;">strVal</span><span style="color: #000000;">)</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #000040;">!</span>tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">LongName</span>.<span style="color: #000000;">IsEmpty</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span><span style="color: #008000;">// 空でない場合</span>
	<span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Z Long Name is&nbsp;%s<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">LongName</span>.<span style="color: #000000;">strVal</span><span style="color: #000000;">)</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #000040;">!</span>tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Unit</span>.<span style="color: #000000;">IsEmpty</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
	<span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Z Unit is&nbsp;%s<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Unit</span>.<span style="color: #000000;">strVal</span><span style="color: #000000;">)</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #000040;">!</span>tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Comment</span>.<span style="color: #000000;">IsEmpty</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
	<span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Z Comment is&nbsp;%s<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Comment</span>.<span style="color: #000000;">strVal</span><span style="color: #000000;">)</span>;</pre>
</ol>
<h3><a name="Format_Matrixsheet"></a><span class="mw-headline">行列シートのフォーマット</span></h3>
<p>テーマツリーを使用して、プログラムで行列シートをフォーマットできます。
</p><p>次のサンプルは、アクティブ行列シートないのセルブロックをフォーマットし、背景を青色、テキストを明るい深紅色にします。
</p>
<pre class="oc" style="font-family:monospace;">MatrixLayer ml <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
 
Tree tr;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">CommonStyle</span>.<span style="color: #000000;">Fill</span>.<span style="color: #000000;">FillColor</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> SYSCOLOR_BLUE;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">CommonStyle</span>.<span style="color: #000000;">Color</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> SYSCOLOR_LTMAGENTA;
 
DataRange dr;
dr.<span style="color: #000000;">Add</span><span style="color: #000000;">(</span><span style="color: #0000ff;">NULL</span>, ml, <span style="color: #0000dd;">2</span>, <span style="color: #0000dd;">2</span>, <span style="color: #0000dd;">5</span>, <span style="color: #0000dd;">3</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// 第1行、列、最後の行、列</span>
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> dr.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">(</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
    dr.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">(</span>tr, <span style="color: #0000ff;">TRUE</span>, <span style="color: #0000ff;">TRUE</span><span style="color: #000000;">)</span>;</pre>
<h3><a name="Get_and_Set_Matrix_Cell_Text_Color"></a><span class="mw-headline">行列セルテキスト色の取得と設定</span></h3>
<p>次のサンプルでは、せるのテキスト色を取得して設定します。
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// 単純なユーティリティ関数に &apos;set&apos; コードを内包</span>
<span style="color: #0000ff;">bool</span> setCellTextColor<span style="color: #000000;">(</span>Datasheet<span style="color: #000040;">&amp;</span> ds, <span style="color: #0000ff;">int</span> row, <span style="color: #0000ff;">int</span> col, uint color<span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
    Grid grid;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #000040;">!</span>grid.<span style="color: #000000;">Attach</span><span style="color: #000000;">(</span>ds<span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
        <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span>;
    vector<span style="color: #000080;">&lt;</span>uint<span style="color: #000080;">&gt;</span> vTextColor<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>;
    vTextColor<span style="color: #000000;">[</span><span style="color: #0000dd;">0</span><span style="color: #000000;">]</span> <span style="color: #000080;">=</span> color;
    <span style="color: #0000ff;">return</span> grid.<span style="color: #000000;">SetCellTextColors</span><span style="color: #000000;">(</span>vTextColor, col, row, row<span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span>
 
<span style="color: #008000;">// シンプルなユーティリティ関数に &apos;get&apos; コードを内包</span>
<span style="color: #0000ff;">bool</span> getCellTextColor<span style="color: #000000;">(</span>Datasheet<span style="color: #000040;">&amp;</span> ds, <span style="color: #0000ff;">int</span> row, <span style="color: #0000ff;">int</span> col, uint<span style="color: #000040;">&amp;</span> color<span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
    Grid grid;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #000040;">!</span>grid.<span style="color: #000000;">Attach</span><span style="color: #000000;">(</span>ds<span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
        <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span>;
    vector<span style="color: #000080;">&lt;</span>uint<span style="color: #000080;">&gt;</span> vTextColor;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #000040;">!</span>grid.<span style="color: #000000;">GetCellTextColors</span><span style="color: #000000;">(</span>vTextColor, col, row, row<span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
        <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span>;
    color <span style="color: #000080;">=</span> vTextColor<span style="color: #000000;">[</span><span style="color: #0000dd;">0</span><span style="color: #000000;">]</span>;
    <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span>;
<span style="color: #000000;">}</span>
 
<span style="color: #008000;">// 上述のユーティリティ関数をテストするためのシンプルな関数</span>
<span style="color: #0000ff;">void</span> testCellTextColor<span style="color: #000000;">(</span><span style="color: #0000ff;">int</span> nRow <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>, <span style="color: #0000ff;">int</span> nCol <span style="color: #000080;">=</span> <span style="color: #0000dd;">4</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
    MatrixLayer ml <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
	<span style="color: #008000;">// nRow, nCol は LT/GUI インデックス, 1-offsetを使用するが OC は 0-offset</span>
	<span style="color: #0000ff;">int</span> row <span style="color: #000080;">=</span> nRow<span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, col <span style="color: #000080;">=</span> nCol<span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>;
    setCellTextColor<span style="color: #000000;">(</span>ml, row, col, SYSCOLOR_BLUE<span style="color: #000000;">)</span>;
 
    uint color;
    getCellTextColor<span style="color: #000000;">(</span>ml, row, col, color<span style="color: #000000;">)</span>;
    <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;color ==&nbsp;%d<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, color<span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span></pre>







    