<h1 class="firstheading">行列オブジェクトの基本操作</h1><p>行列シートは、次数を共有した複数の行列オブジェクトを持つことができます。行列オブジェクトはワークシートと同じように認識することができ、追加や削除ができます。以下のセクションは行列オブジェクトの基本的な操作について、実践的な例題を通して紹介します。
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Add_or_Insert_Matrix_Object"><span class="tocnumber">1</span> <span class="toctext">行列オブジェクトの追加または挿入</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Activate_Matrix_Object"><span class="tocnumber">2</span> <span class="toctext">行列オブジェクトをアクティブ化する</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Access_Matrix_Object"><span class="tocnumber">3</span> <span class="toctext">行列オブジェクトにアクセスする </span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Delete_Matrix_Object"><span class="tocnumber">4</span> <span class="toctext">行列オブジェクト削除する</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Switch_Between_Image_Mode_and_Data_Mode"><span class="tocnumber">5</span> <span class="toctext">イメージモードとデータモードを切り替える</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Get_and_Set_Labels"><span class="tocnumber">6</span> <span class="toctext">ラベルの取得と設定</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Data_Type_and_Format"><span class="tocnumber">7</span> <span class="toctext">データ型とフォーマット</span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="#Get_and_Set_Data_TypeMatrix_Sheet.2C_Set_Internal_Data_Type"><span class="tocnumber">7.1</span> <span class="toctext">データ型の取得と設定<span class="OIndex" style="display:none">Matrix Sheet, Set Internal Data Type</span></span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Get_and_Set_Data_FormatMatrix_Sheet.2C_Data_Format"><span class="tocnumber">7.2</span> <span class="toctext">フォーマットの取得と設定<span class="OIndex" style="display:none">Matrix Sheet, Data Format</span></span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="Add_or_Insert_Matrix_Object"></a><span class="mw-headline">行列オブジェクトの追加または挿入</span></h2>
<p><a href="../../OriginC/OriginC/MatrixLayer-SetSize.html" title="OriginC:MatrixLayer-SetSize">MatrixLayer::SetSize</a>を使用すると行列シート内に複数の行列オブジェクトをセットして行列オブジェクトを追加する事ができます。 
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// アクティブ行列シートに5つの行列オブジェクトをセット</span>
MatrixLayer ml <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
ml.<span style="color: #000000;">SetSize</span><span style="color: #000000;">(</span><span style="color: #0000dd;">5</span><span style="color: #000000;">)</span>;</pre>
<p><a href="../../OriginC/OriginC/MatrixLayer-Insert.html" title="OriginC:MatrixLayer-Insert">MatrixLayer::Insert</a> メソッドは、現在の行列オブジェクトの前に、指定された行列オブジェクトの番号を挿入します。
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// 行列オブジェクトをシートに追加</span>
MatrixLayer ml <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// アクティブ行列シートを取得</span>

<span style="color: #0000ff;">int</span> nNum <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; <span style="color: #008000;">// 追加された行列オブジェクトの番号</span>
<span style="color: #0000ff;">int</span> nPos <span style="color: #000080;">=</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>; <span style="color: #008000;">// -1, 最後に追加</span>
<span style="color: #0000ff;">int</span> nDataType <span style="color: #000080;">=</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>; <span style="color: #008000;">// 任意, -1 はデフォルトでdouble 型</span>
<span style="color: #0000ff;">int</span> index <span style="color: #000080;">=</span> ml.<span style="color: #000000;">Insert</span><span style="color: #000000;">(</span>nNum, nPos, nDataType<span style="color: #000000;">)</span>; <span style="color: #008000;">// 最初のものもインデックスを返す</span></pre>
<h2><a name="Activate_Matrix_Object"></a><span class="mw-headline">行列オブジェクトをアクティブ化する</span></h2>
<p>行列シートの中にある行列オブジェクトをアクティブにするには<a href="../../OriginC/OriginC/MatrixLayer-SetActive.html" title="OriginC:MatrixLayer-SetActive">MatrixLayer::SetActive</a>を使用します。
</p>
<pre class="oc" style="font-family:monospace;">MatrixLayer ml <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
ml.<span style="color: #000000;">SetActive</span><span style="color: #000000;">(</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">// 第3行列オブジェクトをアクティブ化(インデックスは0ベース)</span></pre>
<h2><a name="Access_Matrix_Object"></a><span class="mw-headline">行列オブジェクトにアクセスする</span></h2>
<p>行列オブジェクトにアクセスするには、<a href="../../OriginC/Category/MatrixLayer_(class).html" title="Category:MatrixLayer (class)">MatrixLayer</a>からの<a href="../../OriginC/OriginC/MatrixLayer-MatrixObjects.html" title="OriginC:MatrixLayer-MatrixObjects">MatrixObjects</a>のコレクションを使用します。
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// 名前で1つの行列オブジェクトに付加</span>
MatrixPage matPage<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;MBook3&quot;</span><span style="color: #000000;">)</span>; 

<span style="color: #008000;">// 行列ページからシート名 MSheet1 を付加</span>
<span style="color: #008000;">// インデックスで行列ページからのシート取得もサポート</span>
MatrixLayer ml1 <span style="color: #000080;">=</span> matPage.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;MSheet1&quot;</span><span style="color: #000000;">)</span>; 
        
<span style="color: #008000;">// インデックスによりシートから行列オブジェクトを取得</span>
MatrixObject mo <span style="color: #000080;">=</span> ml1.<span style="color: #000000;">MatrixObjects</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>; 
   
<span style="color: #008000;">// 行列オブジェクトのデータ型は、行列ウィンドウ内で一致している必要がある</span>
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> FSI_SHORT <span style="color: #000080;">==</span> mo.<span style="color: #000000;">GetInternalDataType</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>	
	matrix<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">short</span><span style="color: #000080;">&gt;</span><span style="color: #000040;">&amp;</span> mat <span style="color: #000080;">=</span> mo.<span style="color: #000000;">GetDataObject</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span></pre>
<h2><a name="Delete_Matrix_Object"></a><span class="mw-headline">行列オブジェクト削除する</span></h2>
<p>行列シートから、指定した数の行列オブジェクトを削除するには、<a href="../../OriginC/OriginC/MatrixLayer-Delete.html" title="OriginC:MatrixLayer-Delete">MatrixLayer::Delete</a> メソッドを使用します。
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// シートから行列オブジェクトを削除</span>
MatrixLayer ml <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// アクティブな行列シートを取得</span>

<span style="color: #008000;">// はじめから2つの行列オブジェクトを削除</span>
<span style="color: #0000ff;">int</span> nPos <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
<span style="color: #0000ff;">int</span> nNum <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
ml.<span style="color: #0000ff;">Delete</span><span style="color: #000000;">(</span>nPos,	nNum<span style="color: #000000;">)</span>;</pre>
<h2><a name="Switch_Between_Image_Mode_and_Data_Mode"></a><span class="mw-headline">イメージモードとデータモードを切り替える</span></h2>
<p><a href="../../OriginC/OriginC/MatrixLayer-SetViewImage.html" title="OriginC:MatrixLayer-SetViewImage">MatrixLayer::SetViewImage</a> メソッドは、インデックスで指定した行列の、イメージモードとデータモードを切り替えるオプションを提供しています。
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// イメージモードにセット</span>
MatrixLayer ml <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// アクティブ行列シートを取得</span>
	
<span style="color: #0000ff;">int</span> nImgIndex <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
MatrixObject mo <span style="color: #000080;">=</span> ml.<span style="color: #000000;">MatrixObjects</span><span style="color: #000000;">(</span>nImgIndex<span style="color: #000000;">)</span>;

<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #000040;">!</span>mo.<span style="color: #000000;">IsImageView</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
	<span style="color: #0000ff;">BOOL</span> bAllObjs <span style="color: #000080;">=</span> <span style="color: #0000ff;">FALSE</span>;
	ml.<span style="color: #000000;">SetViewImage</span><span style="color: #000000;">(</span><span style="color: #0000ff;">TRUE</span>, bAllObjs, nImgIndex<span style="color: #000000;">)</span>;  <span style="color: #008000;">// データモードはFALSE</span>
<span style="color: #000000;">}</span></pre>
<h2><a name="Get_and_Set_Labels"></a><span class="mw-headline">ラベルの取得と設定</span></h2>
<p>各行列オブジェクトで、ロングネーム、コメント、単位をセットできます。Zラベルの設定については、<a href="../../OriginC/OCGuide/Base_Matrix_Sheet_Operation.html" title="OCGuide:行列シートの基本操作">行列シートの基本操作</a>の章の、<a href="../../OriginC/OCGuide/Base_Matrix_Sheet_Operation.html#Get_and_Set_Labels" title="OCGuide:行列シートの基本操作">Zラベルの取得と設定</a>をご覧ください。
</p>
<h2><a name="Data_Type_and_Format"></a><span class="mw-headline">データ型とフォーマット</span></h2>
<h3><a name="Get_and_Set_Data_TypeMatrix_Sheet.2C_Set_Internal_Data_Type"></a><span class="mw-headline">データ型の取得と設定<span class="OIndex" style="display:none">Matrix Sheet, Set Internal Data Type</span></span></h3>
<p>行列オブジェクトの内部データ型には、double, real, short, long, char, text, mixed, byte, ushort, ulong, complex型などがあります。Origin C は、MatrixObjectクラス内に<a href="../../OriginC/OriginC/DataObject-GetInternalDataType.html" title="OriginC:DataObject-GetInternalDataType">GetInternalDataType</a> と <a href="../../OriginC/OriginC/DataObject-SetInternalDataType.html" title="OriginC:DataObject-SetInternalDataType">SetInternalDataType</a> メソッドを提供し、行列オブジェクトの内部データタイプの取得と設定に使われます。 
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// データ型の取得と設定</span>
MatrixLayer ml <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// アクティブ行列シートを取得	</span>
MatrixObject mo <span style="color: #000080;">=</span> ml.<span style="color: #000000;">MatrixObjects</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;

<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> mo.<span style="color: #000000;">GetInternalDataType</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000040;">!</span><span style="color: #000080;">=</span> FSI_BYTE <span style="color: #000000;">)</span> <span style="color: #008000;">// データ型を取得</span>
<span style="color: #000000;">{</span>
	<span style="color: #008000;">// OCD_RESTORE はデータをバックアップし </span>
	<span style="color: #008000;">// 型を変更した後元に戻す</span>
	DWORD dwFlags <span style="color: #000080;">=</span> OCD_RESTORE;
	mo.<span style="color: #000000;">SetInternalDataType</span><span style="color: #000000;">(</span>FSI_BYTE, dwFlags<span style="color: #000000;">)</span>; <span style="color: #008000;">// データ型をセット</span>
<span style="color: #000000;">}</span></pre>
<h3><a name="Get_and_Set_Data_FormatMatrix_Sheet.2C_Data_Format"></a><span class="mw-headline">フォーマットの取得と設定<span class="OIndex" style="display:none">Matrix Sheet, Data Format</span></span></h3>
<p><a href="../../OriginC/OriginC/MatrixObject-GetFormat.html" title="OriginC:MatrixObject-GetFormat">MatrixObject::GetFormat </a>と <a href="../../OriginC/OriginC/MatrixObject-SetFormat.html" title="OriginC:MatrixObject-SetFormat">MatrixObject::SetFormat </a>は、行列オブジェクトのデータフォーマットを取得し、設定することができます。
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// データフォーマットを取得して設定</span>
MatrixLayer ml <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// アクティブ行列シートを取得	</span>
MatrixObject mo <span style="color: #000080;">=</span> ml.<span style="color: #000000;">MatrixObjects</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;

<span style="color: #0000ff;">int</span> nFormat <span style="color: #000080;">=</span> mo.<span style="color: #000000;">GetFormat</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// OKCOLTYPE_NUMERIC( = 0) のみサポートされる</span>
mo.<span style="color: #000000;">SetFormat</span><span style="color: #000000;">(</span>OKCOLTYPE_NUMERIC<span style="color: #000000;">)</span>;</pre>







    