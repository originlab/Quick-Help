<h1 class="firstheading">組み込みダイアログボックス</h1><p><br />
<span class="OIndex" style="display:none">ダイアログボックス</span>
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Input_BoxNumeric_BoxString_BoxInput_NumericInput_String"><span class="tocnumber">1</span> <span class="toctext">入力ボックス<span class="OIndex" style="display:none">数値ボックス</span><span class="OIndex" style="display:none">ストリングボックス</span><span class="OIndex" style="display:none">入力数値</span><span class="OIndex" style="display:none">入力ストリング</span></span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Message_Box"><span class="tocnumber">2</span> <span class="OIndex">メッセージボックス</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Progress_Box"><span class="tocnumber">3</span> <span class="OIndex">プログレスボックス</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#File_Dialogs"><span class="tocnumber">4</span> <span class="toctext">ファイルダイアログ</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="#File_Open_Dialog"><span class="tocnumber">4.1</span> <span class="toctext"><span class="OIndex">ファイルを開くダイアログ</span></span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Multiple_Files_Open_Dialog"><span class="tocnumber">4.2</span> <span class="toctext">複数ファイルを開くダイアログ</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#File_SaveAs_Dialog"><span class="tocnumber">4.3</span> <span class="toctext"><span class="OIndex">ファイルを保存ダイアログ</span></span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Path_Browser_Dialog"><span class="tocnumber">4.4</span> <span class="toctext"><span class="OIndex">パスブラウザダイアログ</span></span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="Input_BoxNumeric_BoxString_BoxInput_NumericInput_String"></a><span class="mw-headline">入力ボックス<span class="OIndex" style="display:none">数値ボックス</span><span class="OIndex" style="display:none">ストリングボックス</span><span class="OIndex" style="display:none">入力数値</span><span class="OIndex" style="display:none">入力ストリング</span></span></h2>
<p>入力ボックスはプログラムのユーザからテキスト形式の情報を求めます。入力ボックスを開くには、グローバル関数 InputBox が使われます。
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// stringを入力</span>
string strName <span style="color: #000080;">=</span> InputBox<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Please enter your name&quot;</span>, <span style="color: #ff00ff;">&quot;&quot;</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Name is&nbsp;%s.<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, strName<span style="color: #000000;">)</span>;

<span style="color: #008000;">// 数値を入力</span>
<span style="color: #0000ff;">double</span> dVal <span style="color: #000080;">=</span> InputBox<span style="color: #000000;">(</span><span style="color: #0000dd;">0</span>, <span style="color: #ff00ff;">&quot;Please enter a value&quot;</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Value is&nbsp;%g.<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, dVal<span style="color: #000000;">)</span>;</pre>
<h2><a name="Message_Box"></a><span class="mw-headline"><span class="OIndex">メッセージボックス</span></span></h2>
<p>メッセージボックスは、情報を表示したり、ユーザに選択を促すために使われます。  表示する情報は、操作を続ける前にユーザに注意を促すための重要なものにします。
</p><p>最初のサンプルは、OKボタンだけを持つ単純なメッセージボックスで、ファイルのダウンロードが成功したことを通知します。
</p>
<pre class="oc" style="font-family:monospace;">string strTitle <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;File Download&quot;</span>;
string strMsg <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Your file downloaded successfully.&quot;</span>;
MessageBox<span style="color: #000000;">(</span>GetWindow<span style="color: #000000;">(</span><span style="color: #000000;">)</span>, strMsg, strTitle, MB_OK<span style="color: #000000;">)</span>;</pre>
<p>次のサンプルは、OKとキャンセルボタンを持つ感嘆符のアイコン付きメッセージボックスで、ユーザに操作を元に戻すことができないという注意を促します。  ユーザは操作を続行するか、キャンセルするかを選択できます。
</p>
<pre class="oc" style="font-family:monospace;">string strTitle <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Delete Data&quot;</span>;
string strMsg <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;You will not be able to undo this change.&quot;</span>;
<span style="color: #0000ff;">int</span> nMB <span style="color: #000080;">=</span> MB_OKCANCEL<span style="color: #000040;">|</span>MB_ICONEXCLAMATION;
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> IDOK <span style="color: #000080;">==</span> MessageBox<span style="color: #000000;">(</span>GetWindow<span style="color: #000000;">(</span><span style="color: #000000;">)</span>, strMsg, strTitle, nMB<span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
    out_str<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Data has been deleted&quot;</span><span style="color: #000000;">)</span>;</pre>
<p>次の例は、はい－いいえのボタンを持つ疑問符のアイコン付きのメッセージボックスです。  これは、ユーザに操作を続行するかどうかを尋ねるのに使用しています。
</p>
<pre class="oc" style="font-family:monospace;">string strTitle <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Close Windows&quot;</span>;
string strMsg <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Are you sure you want to close all windows?&quot;</span>;
<span style="color: #0000ff;">int</span> nMB <span style="color: #000080;">=</span> MB_YESNO<span style="color: #000040;">|</span>MB_ICONQUESTION;
<span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> IDYES <span style="color: #000080;">==</span> MessageBox<span style="color: #000000;">(</span>GetWindow<span style="color: #000000;">(</span><span style="color: #000000;">)</span>, strMsg, strTitle, nMB<span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
    out_str<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;All windows have been closed.&quot;</span><span style="color: #000000;">)</span>;</pre>
<p>次の例では、プライベートリマインダメッセージダイアログを表示します。Iniファイルは、ダイアログを初期化するために使用されます。iniファイルの各セクションは、単一のメッセージに使用されます。 
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000; font-style: regular;">/* Example Dialog.ini file in UFF.
[MyMessage]
;Title = My Reminder
Msg = This is my message.
;Btns = 4 for Yes No buttons
Btns = 4
*/</span>
<span style="color: #0000ff;">void</span> PrivateReminderMessage_ex1<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
   string iniFileName <span style="color: #000080;">=</span> GetOriginPath<span style="color: #000000;">(</span>ORIGIN_PATH_USER<span style="color: #000000;">)</span> <span style="color: #000040;">+</span> <span style="color: #ff00ff;">&quot;Dialog.ini&quot;</span>;
   <span style="color: #0000ff;">int</span> nRet <span style="color: #000080;">=</span> PrivateReminderMessage<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;MyMessage&quot;</span>, iniFileName<span style="color: #000000;">)</span>;
   <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;User chose&nbsp;%d<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, nRet<span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span></pre>
<h2><a name="Progress_Box"></a><span class="mw-headline"><span class="OIndex">プログレスボックス</span></span></h2>
<p>プログレスボックスは、ソフトウェアがデータを処理中であることを示す小さなダイアログボックスです。このダイアログボックスは、処理の進行状況の割合を表示するプログレスバーを含みます。プログレスダイアログは、通常、反復ループに使用します。
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">int</span> iMax <span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span>, iMin <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
progressBox prgbBox<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;This is a ProgressBox example:&quot;</span><span style="color: #000000;">)</span>;
prgbBox.<span style="color: #000000;">SetRange</span><span style="color: #000000;">(</span>iMin, iMax<span style="color: #000000;">)</span>;

<span style="color: #0000ff;">for</span> <span style="color: #000000;">(</span><span style="color: #0000ff;">int</span> ii<span style="color: #000080;">=</span>iMin; ii<span style="color: #000080;">&lt;=</span>iMax; ii<span style="color: #000040;">++</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
    <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span>prgbBox.<span style="color: #000000;">Set</span><span style="color: #000000;">(</span>ii<span style="color: #000000;">)</span><span style="color: #000000;">)</span>
        <span style="color: #000000;">printf</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Hi, it is now at&nbsp;%d.<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, ii<span style="color: #000000;">)</span>;
    <span style="color: #0000ff;">else</span> 
    <span style="color: #000000;">{</span>
        out_str<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;User abort!&quot;</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// Cancel ボタンをクリックして停止</span>
        <span style="color: #0000ff;">break</span>;
    <span style="color: #000000;">}</span>
    LT_execute<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;sec -p 0.5&quot;</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span></pre>
<h2><a name="File_Dialogs"></a><span class="mw-headline">ファイルダイアログ</span></h2>
<p>Origin Cは、すべてに共通のファイルダイアログの関数を提供しています。  これには、1つのファイルを開く、複数ファイルを開く、ファイルを保存する、フォルダを選択するダイアログが含まれます。  次のセクションは、自分自身のアプリケーションでこれらのダイアログを使用する方法を示します。
</p>
<h3><a name="File_Open_Dialog"></a><span class="mw-headline"><span class="OIndex">ファイルを開くダイアログ</span></span></h3>
<pre class="oc" style="font-family:monospace;">StringArray saFiletypes<span style="color: #000000;">(</span><span style="color: #0000dd;">3</span><span style="color: #000000;">)</span>;
saFiletypes<span style="color: #000000;">[</span><span style="color: #0000dd;">0</span><span style="color: #000000;">]</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;[Project (*.OPJ)] *.OPJ&quot;</span>;
saFiletypes<span style="color: #000000;">[</span><span style="color: #0000dd;">1</span><span style="color: #000000;">]</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;[Old version (*.ORG)] *.ORG&quot;</span>;
saFiletypes<span style="color: #000000;">[</span><span style="color: #0000dd;">2</span><span style="color: #000000;">]</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;[Worksheets (*.OGW)] *.OGW&quot;</span>;

string strPath <span style="color: #000080;">=</span> GetOpenBox<span style="color: #000000;">(</span> saFiletypes, GetAppPath<span style="color: #000000;">(</span><span style="color: #0000ff;">false</span><span style="color: #000000;">)</span> <span style="color: #000000;">)</span>; 
out_str<span style="color: #000000;">(</span>strPath<span style="color: #000000;">)</span>;</pre>
<h3><a name="Multiple_Files_Open_Dialog"></a><span class="mw-headline">複数ファイルを開くダイアログ</span></h3>
<pre class="oc" style="font-family:monospace;">StringArray saFilePaths;
StringArray saFileTypes<span style="color: #000000;">(</span><span style="color: #0000dd;">3</span><span style="color: #000000;">)</span>;    
saFileTypes<span style="color: #000000;">[</span><span style="color: #0000dd;">0</span><span style="color: #000000;">]</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;[Project (*.OPJ)] *.OPJ&quot;</span>;
saFileTypes<span style="color: #000000;">[</span><span style="color: #0000dd;">1</span><span style="color: #000000;">]</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;[Old version (*.ORG)] *.ORG&quot;</span>;
saFileTypes<span style="color: #000000;">[</span><span style="color: #0000dd;">2</span><span style="color: #000000;">]</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;[Worksheets (*.OGW)] *.OGW&quot;</span>;

<span style="color: #008000;">// Ctrl または Shirt キーで複数ファイルを選択</span>
<span style="color: #0000ff;">int</span> iNumSelFiles <span style="color: #000080;">=</span> GetMultiOpenBox<span style="color: #000000;">(</span>saFilePaths, saFileTypes, GetAppPath<span style="color: #000000;">(</span><span style="color: #0000ff;">false</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;</pre>
<h3><a name="File_SaveAs_Dialog"></a><span class="mw-headline"><span class="OIndex">ファイルを保存ダイアログ</span></span></h3>
<pre class="oc" style="font-family:monospace;">string strDefaultFilename <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Origin&quot;</span>;
FDLogUseGroup nFDLogUseGroup <span style="color: #000080;">=</span> FDLOG_ASCII; <span style="color: #008000;">// ASCII ファイルグループ</span>

string strPath <span style="color: #000080;">=</span> GetSaveAsBox<span style="color: #000000;">(</span>nFDLogUseGroup,GetAppPath<span style="color: #000000;">(</span><span style="color: #0000ff;">false</span><span style="color: #000000;">)</span>,strDefaultFilename<span style="color: #000000;">)</span>;
out_str<span style="color: #000000;">(</span> strPath <span style="color: #000000;">)</span>;</pre>
<h3><a name="Path_Browser_Dialog"></a><span class="mw-headline"><span class="OIndex">パスブラウザダイアログ</span></span></h3>
<pre class="oc" style="font-family:monospace;">string strPath <span style="color: #000080;">=</span> BrowseGetPath<span style="color: #000000;">(</span>GetAppPath<span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000040;">+</span> <span style="color: #ff00ff;">&quot;OriginC<span style="color: #666666; font-weight: bold;">\\</span>&quot;</span>, <span style="color: #ff00ff;">&quot;This is an example&quot;</span><span style="color: #000000;">)</span>;
out_str<span style="color: #000000;">(</span>strPath<span style="color: #000000;">)</span>;</pre>







    