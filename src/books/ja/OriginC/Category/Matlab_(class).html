<h1 class="firstheading">Matlab</h1>

  <p>&#160;</p>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>Contents</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1"><a href="#Name"><span class="tocnumber">1</span> <span class="toctext">Name</span></a></li>

      <li class="toclevel-1 tocsection-2"><a href="#Remark"><span class="tocnumber">2</span> <span class="toctext">Remark</span></a></li>

      <li class="toclevel-1 tocsection-3"><a href="#Hierarchy"><span class="tocnumber">3</span> <span class="toctext">Hierarchy</span></a></li>

      <li class="toclevel-1 tocsection-4"><a href="#Examples"><span class="tocnumber">4</span> <span class="toctext">Examples</span></a></li>

      <li class="toclevel-1 tocsection-5"><a href="#header_to_Include"><span class="tocnumber">5</span> <span class="toctext">header to Include</span></a></li>

      <li class="toclevel-1 tocsection-6"><a href="#Reference"><span class="tocnumber">6</span> <span class="toctext">Reference</span></a></li>

      <li class="toclevel-1 tocsection-7"><a href="#Members"><span class="tocnumber">7</span> <span class="toctext">Members</span></a></li>

      <li class="toclevel-1 tocsection-8"><a href="#Property"><span class="tocnumber">8</span> <span class="toctext">Property</span></a></li>
    </ul>
  </div>

  <h2><a name="Name"></a><span class="mw-headline">Name</span></h2>

  <p>Matlab</p>

  <h2><a name="Remark"></a><span class="mw-headline">Remark</span></h2>

  <p>Matlab class provides communication between Origin and Matlab.</p>

  <h2><a name="Hierarchy"></a><span class="mw-headline">Hierarchy</span></h2>

  <ul>
    <li><strong class="selflink">Matlab</strong></li>
  </ul>

  <h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>

  <p><b>EX1</b></p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>origin.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span>
<span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>externApps.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span> <span style="color: #008000;">// this file is not included in origin.h</span>
<span style="color: #008000;">////////////////////////////////////////////////////////////////////////////////////</span>

<span style="color: #0000ff;">void</span> mltest<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
    Matlab matObj<span style="color: #000000;">(</span><span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span><span style="color: #000040;">!</span>matObj<span style="color: #000000;">)</span>
    <span style="color: #000000;">{</span>
        out_str<span style="color: #000000;">(</span><span style="color: #ff00ff;">"No Matlab found"</span><span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">return</span>;
    <span style="color: #000000;">}</span>
    
    <span style="color: #008000;">//defines 3x5 matrix named ma</span>
    string strRet <span style="color: #000080;">=</span> matObj.<span style="color: #000000;">Execute</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"ma=[1 2 3 4 5; 4 5 6 7 8;10.3 4.5 -4.7 -23.2 -6.7]"</span><span style="color: #000000;">)</span>;    
    out_str<span style="color: #000000;">(</span>strRet<span style="color: #000000;">)</span>;<span style="color: #008000;">// show str from Matlab</span>
    
    <span style="color: #008000;">// put matrix into Origin matrix</span>
    MatrixLayer matLayer;
    matLayer.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
    Matrix mao<span style="color: #000000;">(</span>matLayer<span style="color: #000000;">)</span>;
    
    <span style="color: #008000;">//Transfer Matlab's matrix (ma) to Origin's mao matrix.</span>
    <span style="color: #0000ff;">BOOL</span> bRet <span style="color: #000080;">=</span> matObj.<span style="color: #000000;">GetMatrix</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"ma"</span>, <span style="color: #000040;">&amp;</span>mao<span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span>
</pre>

  <h2><a name="header_to_Include"></a><span class="mw-headline">header to Include</span></h2>

  <p>ExternApps.h</p>

  <h2><a name="Reference"></a><span class="mw-headline">Reference</span></h2>

  <h2><a name="Members"></a><span class="mw-headline">Members</span></h2>

  <table class="TableGrid" style="; border-spacing: 0px; border-spacing: 0px;" border="1">
    <tr>
      <th bgcolor="#EFEFEF" width="2%">Name</th>

      <th bgcolor="#EFEFEF" width="18%">Brief</th>

      <th bgcolor="#EFEFEF" width="2%">Example</th>
    </tr>

    <tr>
      <td><a href="../../OriginC/OriginC/Matlab-Attach.html" title="OriginC:Matlab-Attach">Attach</a></td>

      <td>Establishes connection to Matlab.</td>

      <td align="center"><a href="../../OriginC/OriginC/Matlab-Attach.html#Examples" title="OriginC:Matlab-Attach">Examples</a></td>
    </tr>

    <tr>
      <td><a href="../../OriginC/OriginC/Matlab-Detach.html" title="OriginC:Matlab-Detach">Detach</a></td>

      <td>Destroys the connection with Matlab</td>

      <td align="center"><a href="../../OriginC/OriginC/Matlab-Detach.html#Examples" title="OriginC:Matlab-Detach">Examples</a></td>
    </tr>

    <tr>
      <td><a href="../../OriginC/OriginC/Matlab-Execute.html" title="OriginC:Matlab-Execute">Execute</a></td>

      <td>Executes command in Matlab workspace</td>

      <td align="center"><a href="../../OriginC/OriginC/Matlab-Execute.html#Examples" title="OriginC:Matlab-Execute">Examples</a></td>
    </tr>

    <tr>
      <td><a href="../../OriginC/OriginC/Matlab-GetMatrix.html" title="OriginC:Matlab-GetMatrix">GetMatrix</a></td>

      <td>Transfer Matlab matrix to Origin Matrix. OriginC matrix not currently supported.</td>

      <td align="center"><a href="../../OriginC/OriginC/Matlab-GetMatrix.html#Examples" title="OriginC:Matlab-GetMatrix">Examples</a></td>
    </tr>

    <tr>
      <td><a href="../../OriginC/OriginC/Matlab-GetString.html" title="OriginC:Matlab-GetString">GetString</a></td>

      <td>Transfer Matlab character array to Origin string.</td>

      <td align="center"><a href="../../OriginC/OriginC/Matlab-GetString.html#Examples" title="OriginC:Matlab-GetString">Examples</a></td>
    </tr>

    <tr>
      <td><a href="../../OriginC/OriginC/Matlab-Matlab.html" title="OriginC:Matlab-Matlab">Matlab</a></td>

      <td>Constructor for Matlab class.</td>

      <td align="center"><a href="../../OriginC/OriginC/Matlab-Matlab.html#Examples" title="OriginC:Matlab-Matlab">Examples</a></td>
    </tr>

    <tr>
      <td><a href="../../OriginC/OriginC/Matlab-MinimizeCommandWindow.html" title="OriginC:Matlab-MinimizeCommandWindow">MinimizeCommandWindow</a></td>

      <td>Minimizes Matlab command window.</td>

      <td align="center"><a href="../../OriginC/OriginC/Matlab-MinimizeCommandWindow.html#Examples" title="OriginC:Matlab-MinimizeCommandWindow">Examples</a></td>
    </tr>

    <tr>
      <td><a href="../../OriginC/OriginC/Matlab-PutMatrix.html" title="OriginC:Matlab-PutMatrix">PutMatrix</a></td>

      <td>Transfer Origin Matrix to Matlab matrix. OriginC matrix not currently supported. Complex matrices not currently supported</td>

      <td align="center"><a href="../../OriginC/OriginC/Matlab-PutMatrix.html#Examples" title="OriginC:Matlab-PutMatrix">Examples</a></td>
    </tr>

    <tr>
      <td><a href="../../OriginC/OriginC/Matlab-PutString.html" title="OriginC:Matlab-PutString">PutString</a></td>

      <td>Transfer Origin string to Matlab character array.</td>

      <td align="center"><a href="../../OriginC/OriginC/Matlab-PutString.html#Examples" title="OriginC:Matlab-PutString">Examples</a></td>
    </tr>
  </table>

  <h2><a name="Property"></a><span class="mw-headline">Property</span></h2>

  <table class="TableGrid" style="; border-spacing: 0px; border-spacing: 0px;" border="1">
    <tr>
      <th bgcolor="#EFEFEF" width="2%">Name</th>

      <th bgcolor="#EFEFEF" width="18%">Brief</th>

      <th bgcolor="#EFEFEF" width="2%">Example</th>
    </tr>

    <tr>
      <td><a href="../../OriginC/OriginC/Matlab-KeepMatlabRunning.html" title="OriginC:Matlab-KeepMatlabRunning">KeepMatlabRunning</a></td>

      <td>Controls if Origin should keep Matlab session alive after closing the connection. When Origin exits, Matlab session created by Origin, or Matlab session started prior to Origin one, with command line: Matlab /Automation, will close.</td>

      <td align="center"><a href="../../OriginC/OriginC/Matlab-KeepMatlabRunning.html#Examples" title="OriginC:Matlab-KeepMatlabRunning">Examples</a></td>
    </tr>

    <tr>
      <td><a href="../../OriginC/OriginC/Matlab-Visible.html" title="OriginC:Matlab-Visible">Visible</a></td>

      <td>Shows the Visible/Hidden state of Matlab window.</td>

      <td align="center">
        <a href="../../OriginC/OriginC/Matlab-Visible.html#Examples" title="OriginC:Matlab-Visible">Examples</a>

        <p> </p>
      </td>
    </tr>
  </table>
