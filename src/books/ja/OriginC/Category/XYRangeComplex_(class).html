<h1 class="firstheading">XYRangeComplex</h1>

  <p>&#160;</p>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>Contents</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1"><a href="#Name"><span class="tocnumber">1</span> <span class="toctext">Name</span></a></li>

      <li class="toclevel-1 tocsection-2"><a href="#Remark"><span class="tocnumber">2</span> <span class="toctext">Remark</span></a></li>

      <li class="toclevel-1 tocsection-3"><a href="#Hierarchy"><span class="tocnumber">3</span> <span class="toctext">Hierarchy</span></a></li>

      <li class="toclevel-1 tocsection-4"><a href="#Examples"><span class="tocnumber">4</span> <span class="toctext">Examples</span></a></li>

      <li class="toclevel-1 tocsection-5"><a href="#header_to_Include"><span class="tocnumber">5</span> <span class="toctext">header to Include</span></a></li>

      <li class="toclevel-1 tocsection-6"><a href="#Reference"><span class="tocnumber">6</span> <span class="toctext">Reference</span></a></li>

      <li class="toclevel-1 tocsection-7"><a href="#Members"><span class="tocnumber">7</span> <span class="toctext">Members</span></a></li>
    </ul>
  </div>

  <h2><a name="Name"></a><span class="mw-headline">Name</span></h2>

  <p>XYRangeComplex</p>

  <h2><a name="Remark"></a><span class="mw-headline">Remark</span></h2>

  <p>The XYRangeComplex class provides methods to get and set complex type XY dataset for matrix and worksheet window. Same as DataRange class, itself does not hold data, just keep the data range with page name, sheet name and row/column indices. One XYRangeComplex object allow containing multiple sub XY complex data ranges.</p>

  <p>The XYRangeComplex class is derived from the XYRange, DataRange class from which it inherits methods and properties.</p>

  <h2><a name="Hierarchy"></a><span class="mw-headline">Hierarchy</span></h2>

  <ul>
    <li>
      <a href="../../OriginC/Category/OriginObject_(class).html" title="Category:OriginObject (class)">OriginObject</a>

      <ul>
        <li>
          <a href="../../OriginC/Category/DataRange_(class).html" title="Category:DataRange (class)">DataRange</a>

          <ul>
            <li>
              <a href="../../OriginC/Category/XYRange_(class).html" title="Category:XYRange (class)">XYRange</a>

              <ul>
                <li><strong class="selflink">XYRangeComplex</strong></li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>

  <h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>

  <p><b>EX1</b></p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #008000;">// The function first creates a worksheet and puts some input data</span>
<span style="color: #008000;">// into it. Then it initializes XYRangeComplex such that it refers to the data</span>
<span style="color: #008000;">// in the worksheet.</span>
<span style="color: #008000;">// Then it creates the output worksheet, extracts the data from the input (i.e. source)</span>
<span style="color: #008000;">// worksheet using XYRangeComplex::GetData() method, and puts them into the output worksheet.</span>
<span style="color: #0000ff;">void</span>    XYRangeComlex_ex1<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
    Worksheet wksSource;
    wksSource.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
    <span style="color: #008000;">// Make sure there are at least 5 columns of data:</span>
    <span style="color: #0000ff;">while</span> <span style="color: #000000;">(</span> wksSource.<span style="color: #000000;">Columns</span>.<span style="color: #000000;">Count</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000080;">&lt;</span> <span style="color: #0000dd;">5</span> <span style="color: #000000;">)</span>
        wksSource.<span style="color: #000000;">AddCol</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
    
    
    DWORD dwRulesEx <span style="color: #000080;">=</span> DRR_GET_MISSING <span style="color: #000040;">|</span> DRR_BAD_WEIGHT_TREATMENT;
    <span style="color: #0000ff;">int</span> nNumRows <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>;
    
    <span style="color: #008000;">// Make columns 2 to 5 complex</span>
    <span style="color: #008000;">// and set some complex values into it:</span>
    <span style="color: #0000ff;">for</span> <span style="color: #000000;">(</span><span style="color: #0000ff;">int</span> col <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; col <span style="color: #000080;">&lt;=</span> <span style="color: #0000dd;">4</span>; col<span style="color: #000040;">++</span><span style="color: #000000;">)</span>
    <span style="color: #000000;">{</span>
        Column colObj <span style="color: #000080;">=</span> wksSource.<span style="color: #000000;">Columns</span><span style="color: #000000;">(</span>col<span style="color: #000000;">)</span>;
        colObj.<span style="color: #000000;">SetFormat</span><span style="color: #000000;">(</span>OKCOLTYPE_NUMERIC<span style="color: #000000;">)</span>;
        colObj.<span style="color: #000000;">SetInternalData</span><span style="color: #000000;">(</span>FSI_COMPLEX<span style="color: #000000;">)</span>;

        Dataset<span style="color: #000080;">&lt;</span>complex<span style="color: #000080;">&gt;</span>    ds<span style="color: #000000;">(</span>wksSource, col<span style="color: #000000;">)</span>;
        ds.<span style="color: #000000;">SetSize</span><span style="color: #000000;">(</span>nNumRows<span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">for</span> <span style="color: #000000;">(</span><span style="color: #0000ff;">int</span> row <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; row <span style="color: #000080;">&lt;</span> nNumRows; row<span style="color: #000040;">++</span><span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
            <span style="color: #0000ff;">double</span>            rReal <span style="color: #000080;">=</span> <span style="color: #000000;">pow</span><span style="color: #000000;">(</span><span style="color: #0000dd;">10</span>, col<span style="color: #000000;">)</span> <span style="color: #000040;">+</span> row;
            <span style="color: #0000ff;">double</span>            rImag <span style="color: #000080;">=</span> <span style="color: #000000;">(</span>row <span style="color: #000040;">+</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">)</span> <span style="color: #000040;">*</span> <span style="color: #000000;">pow</span><span style="color: #000000;">(</span><span style="color: #0000dd;">10</span>, col <span style="color: #000040;">-</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>;
            complex            cc<span style="color: #000000;">(</span>rReal, rImag<span style="color: #000000;">)</span>;
            
            ds<span style="color: #000000;">[</span>row<span style="color: #000000;">]</span> <span style="color: #000080;">=</span> cc;
        <span style="color: #000000;">}</span>
    <span style="color: #000000;">}</span>
    
    <span style="color: #008000;">// Set X-values into the first column:</span>
    Dataset dsXSource<span style="color: #000000;">(</span>wksSource, <span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;
    dsXSource.<span style="color: #000000;">SetSize</span><span style="color: #000000;">(</span>nNumRows<span style="color: #000000;">)</span>;
    <span style="color: #0000ff;">for</span> <span style="color: #000000;">(</span><span style="color: #0000ff;">int</span> row <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; row <span style="color: #000080;">&lt;</span> nNumRows; row<span style="color: #000040;">++</span><span style="color: #000000;">)</span>
    <span style="color: #000000;">{</span>
        dsXSource<span style="color: #000000;">[</span>row<span style="color: #000000;">]</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0.1</span> <span style="color: #000040;">*</span> <span style="color: #000000;">(</span>row <span style="color: #000040;">+</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>;
    <span style="color: #000000;">}</span>

    <span style="color: #008000;">// Initialize XYRangeComplex:</span>
    XYRangeComplex                dr;
    dr.<span style="color: #000000;">Add</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"X"</span>, wksSource, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">0</span>, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;
    dr.<span style="color: #000000;">Add</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Y"</span>, wksSource, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">1</span>, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">2</span><span style="color: #000000;">)</span>;
    dr.<span style="color: #000000;">Add</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"S"</span>, <span style="color: #0000ff;">NULL</span><span style="color: #000000;">)</span>;
    dr.<span style="color: #000000;">Add</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"X"</span>, wksSource, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">0</span>, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;
    dr.<span style="color: #000000;">Add</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Y"</span>, wksSource, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">3</span>, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">3</span><span style="color: #000000;">)</span>;
    dr.<span style="color: #000000;">Add</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Y"</span>, wksSource, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">4</span>, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">4</span><span style="color: #000000;">)</span>;
    
    <span style="color: #0000ff;">int</span>    nNumData <span style="color: #000080;">=</span> dr.<span style="color: #000000;">GetNumData</span><span style="color: #000000;">(</span>dwRulesEx<span style="color: #000000;">)</span>;
    
    <span style="color: #008000;">// Create worksheet for putting the extracted data into:</span>
    Worksheet wksOut;
    wksOut.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
    <span style="color: #008000;">// Make sure the worksheet has 2 * nNumData columns:</span>
    <span style="color: #0000ff;">while</span> <span style="color: #000000;">(</span> wksOut.<span style="color: #000000;">Columns</span>.<span style="color: #000000;">Count</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000080;">&lt;</span> <span style="color: #0000dd;">2</span> <span style="color: #000040;">*</span> nNumData <span style="color: #000000;">)</span>
        wksOut.<span style="color: #000000;">AddCol</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
    
    <span style="color: #008000;">// Get all the data and put them into the output worksheet:</span>
    <span style="color: #0000ff;">for</span> <span style="color: #000000;">(</span><span style="color: #0000ff;">int</span> idata <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; idata <span style="color: #000080;">&lt;</span> nNumData; idata<span style="color: #000040;">++</span><span style="color: #000000;">)</span>
    <span style="color: #000000;">{</span>
        vector<span style="color: #000080;">&lt;</span>complex<span style="color: #000080;">&gt;</span>        vc;
        vector                vx;
        <span style="color: #0000ff;">if</span> <span style="color: #000000;">(</span> <span style="color: #000040;">!</span>dr.<span style="color: #000000;">GetData</span><span style="color: #000000;">(</span>vc, vx, idata<span style="color: #000000;">)</span> <span style="color: #000000;">)</span>
        <span style="color: #000000;">{</span>
            out_str<span style="color: #000000;">(</span><span style="color: #ff00ff;">"Failed to get complex data!"</span><span style="color: #000000;">)</span>;
            <span style="color: #0000ff;">return</span>;
        <span style="color: #000000;">}</span>
        
        <span style="color: #008000;">// Set the column for complex values to be complex:</span>
        <span style="color: #0000ff;">int</span>                colIndexComplex <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span> <span style="color: #000040;">*</span> idata <span style="color: #000040;">+</span> <span style="color: #0000dd;">1</span>;
        Column            colObj <span style="color: #000080;">=</span> wksOut.<span style="color: #000000;">Columns</span><span style="color: #000000;">(</span>colIndexComplex<span style="color: #000000;">)</span>;
        colObj.<span style="color: #000000;">SetFormat</span><span style="color: #000000;">(</span>OKCOLTYPE_NUMERIC<span style="color: #000000;">)</span>;
        colObj.<span style="color: #000000;">SetInternalData</span><span style="color: #000000;">(</span>FSI_COMPLEX<span style="color: #000000;">)</span>;
        
        Dataset<span style="color: #000080;">&lt;</span>complex<span style="color: #000080;">&gt;</span>    dc<span style="color: #000000;">(</span>wksOut, colIndexComplex<span style="color: #000000;">)</span>;
        dc <span style="color: #000080;">=</span> vc;
        
        <span style="color: #008000;">// Set X-Values as well:</span>
        Dataset                dX<span style="color: #000000;">(</span>wksOut, <span style="color: #0000dd;">2</span> <span style="color: #000040;">*</span> idata<span style="color: #000000;">)</span>;
        dX <span style="color: #000080;">=</span> vx;
    <span style="color: #000000;">}</span>
    
    <span style="color: #0000ff;">return</span>;
<span style="color: #000000;">}</span>
</pre>

  <h2><a name="header_to_Include"></a><span class="mw-headline">header to Include</span></h2>

  <p>origin.h</p>

  <h2><a name="Reference"></a><span class="mw-headline">Reference</span></h2>

  <h2><a name="Members"></a><span class="mw-headline">Members</span></h2>

  <table class="TableGrid" style="; border-spacing: 0px; border-spacing: 0px;" border="1">
    <tr>
      <th bgcolor="#EFEFEF" width="2%">Name</th>

      <th bgcolor="#EFEFEF" width="18%">Brief</th>

      <th bgcolor="#EFEFEF" width="2%">Example</th>
    </tr>

    <tr>
      <td><a href="../../OriginC/OriginC/XYRangeComplex-GetData.html" title="OriginC:XYRangeComplex-GetData">GetData</a></td>

      <td>Get xyz data from the datarange</td>

      <td align="center"><a href="../../OriginC/OriginC/XYRangeComplex-GetData.html#Examples" title="OriginC:XYRangeComplex-GetData">Examples</a></td>
    </tr>

    <tr>
      <td><a href="../../OriginC/OriginC/XYRangeComplex-SetData.html" title="OriginC:XYRangeComplex-SetData">SetData</a></td>

      <td>Update xyz data with new data in vectors</td>

      <td align="center"><a href="../../OriginC/OriginC/XYRangeComplex-SetData.html#Examples" title="OriginC:XYRangeComplex-SetData">Examples</a></td>
    </tr>
  </table>
