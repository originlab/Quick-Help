<h1 class="firstheading">クライアントにOriginをインストール、またはファイルサーバに展開</h1><p class='urlname' style='display: none'>Multi-userDeployment</p>
<p>このページでは、Originの展開方法を紹介します。ネットワーク同時起動版/マルチシート両方に対応しています。
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Things_to_consider_before_getting_started"><span class="tocnumber">1</span> <span class="toctext">はじめにお読みください</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Prepare_your_customized_settings_with_the_installer"><span class="tocnumber">2</span> <span class="toctext">設定をカスタマイズしたインストーラの用意</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Customize_Installation_Settings_with_Config.ini"><span class="tocnumber">2.1</span> <span class="toctext">Config.iniを使用してインストール設定をカスタマイズ</span></a>
<ul>
<li class="toclevel-3 tocsection-4"><a href="#What_is_Config.ini_and_what_can_it_do"><span class="tocnumber">2.1.1</span> <span class="toctext">Config.iniとは何か、Config.ini でできること</span></a>
<ul>
<li class="toclevel-4 tocsection-5"><a href="#What.27s_in_Config.ini.3F"><span class="tocnumber">2.1.1.1</span> <span class="toctext">Config.iniの内容</span></a>
<ul>
<li class="toclevel-5 tocsection-6"><a href="#Installation_Settings"><span class="tocnumber">2.1.1.1.1</span> <span class="toctext">インストール設定</span></a></li>
<li class="toclevel-5 tocsection-7"><a href="#Origin_Folder_Path"><span class="tocnumber">2.1.1.1.2</span> <span class="toctext">Originフォルダのパス</span></a></li>
<li class="toclevel-5 tocsection-8"><a href="#License_Management"><span class="tocnumber">2.1.1.1.3</span> <span class="toctext">ライセンス管理</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-2 tocsection-9"><a href="#Optional_Steps"><span class="tocnumber">2.2</span> <span class="toctext">オプションの手順</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Distribute_your_Origin_installation_package"><span class="tocnumber">2.1.2.3</span> <span class="toctext">Originインストールパッケージの配布</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#MSI_Installation"><span class="tocnumber">2.4</span> <span class="toctext">MSI インストール</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-12"><a href="#Post_Installation_Updates_by_Group_Folder"><span class="tocnumber">3</span> <span class="toctext">グループフォルダによるインストール後の更新</span></a>
<ul>
<li class="toclevel-2 tocsection-13"><a href="#Set_up_Group_Leader.28s.29_and_Group_Members"><span class="tocnumber">3.1</span> <span class="toctext">グループリーダーとグループメンバーのセットアップ</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#Use_the_Group_Folder_Manager_to_Publish_Files"><span class="tocnumber">3.2</span> <span class="toctext">グループフォルダマネージャを使用してファイルを公開する</span></a>
<ul>
<li class="toclevel-3 tocsection-15"><a href="#Types_of_Files_that_can_be_Published"><span class="tocnumber">3.2.1</span> <span class="toctext">公開できるファイルの種類</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>

<h2><a name="Things_to_consider_before_getting_started"></a><span class="mw-headline">はじめにお読みください</span></h2>
<p><span class='headerInParagraph'>Originの配布方法</span>
</p><p>OriginLabは、2種類のインストーラを提供しています。
</p>
<dl><dd><ul><li><b>InstallShield セットアップ</b> - DVD、体験版のダウンロード、ご購入後に電子メールでお送りするダウンロードリンクから入手できます。（注：複数ユーザーに展開したい場合は、exe形式ではなくzip形式のダウンロードを選択してください。）</li>
<li><b>MSI インストーラ</b> - <a class="external text" href="https://www.originlab.com/index.aspx?go=Support/DocumentationAndHelpCenter/Installation/Multi-userDeployment/MSIInstall#Download%20the%20MSI%20Installer" target="_blank">こちら</a>からダウンロードしてください。</li></ul></dd></dl>
<p><b>InstallShield セットアップの利点</b>
</p>
<dl><dd>InstallShield セットアップの利点は、必要なMicrosoft（MS）DLLがコンピュータに存在するかどうかを確認し、存在しない場合は、InstallShield セットアップが必要なMSインストーラを自動的に実行してDLLをインストールすることです。</dd></dl>
<dl><dd>MSIとの違い - OriginのMSI インストーラは、MSインストーラを自動的に実行できません。したがって、MSIからOriginを展開する場合は、MSインストーラとそれらをインストールするためのバッチファイルを含めることをお勧めします。</dd></dl>
<p><b>MSI インストーラの利点</b>
</p>
<dl><dd>グループポリシー（GPO）を使用してOriginを展開する場合、MSIインストーラのみを選択でき、InstallShieldセットアップは選択できません。</dd></dl>
<dl><dd>MSIインストーラを使用すると、ユーザがOriginをサイレントインストールできるようにスクリプトを準備できます。.iniファイルは、シリアル番号、インストールフォルダ、ユーザーファイルフォルダ（ユーザは最初の起動時にこれを選択するように求められます）などを事前設定するために使用されます。同時起動版の場合、FLEXnetサーバーを事前設定することもできます。</dd></dl>
<dl><dd>InstallShieldセットアップでは.iniファイルを使用できますが、MSIインストーラは複数ユーザへの展開に適したタイプです。これにより、管理者は別の「変換」（MSTファイル）を使用して、より多くの構成を事前設定したり、MSIインストールデータベースのデータを置き換えたりすることができます。変換の詳細については、<a class="external text" href="https://docs.microsoft.com/en-us/windows/win32/msi/about-transforms" target="_blank">こちら</a>をご覧ください。 </dd></dl>
<p>次の手順は、InstallShieldセットアップとMSIインストーラの両方に適用されます。
</p>
<h2><a name="Prepare_your_customized_settings_with_the_installer"></a><span class="mw-headline">設定をカスタマイズしたインストーラの用意</span></h2>
<h3><a name="Customize_Installation_Settings_with_Config.ini"></a><span class="mw-headline">Config.iniでインストールの設定をカスタマイズする</span></h3>
<h4><a name="What_is_Config.ini_and_what_can_it_do"></a><span class="mw-headline">Config.iniとは何か、Config.ini でできること</span></h4>
<p>Config.iniファイルは、インストール設定を事前設定/カスタマイズするための構成ファイルです。Origin 2019以降のバージョンで使用可能です。InstallShield セットアップの場合、Originセットアップファイル（zip形式のインストーラ）に付属しています。MSIインストーラの場合、個別にダウンロードできます。
</p>
<h5><a name="What.27s_in_Config.ini.3F"></a><span class="mw-headline">Config.iniの内容</span></h5>
<p>オプションとして、<b>Config.ini</b>ファイルで次の設定を構成できます。メモ帳で開いて閲覧し、編集することができます。各設定の理解に役立つ詳細なコメントが含まれています。 
</p>
<h6><a name="Installation_Settings"></a><span class="mw-headline">インストール設定</span></h6>
<p><i>[Setup]</i>セクションですべてのインストールデータを事前設定します。
</p>
<dl><dd> - シリアル番号、ユーザー名、会社情報、インストールパス、PythonコンソールとSPSSインポートを有効にするかどうかを事前設定</dd>
<dd> - Originをサイレントインストールするかどうかを決定します（注：これはInstallShieldセットアップにのみ適用されます。MSIをサイレントインストールするには、/quietスイッチを使用してコマンドラインを実行できます。）</dd></dl>
<p><b>Note</b>: 
Originをサイレントモードでインストールするために<code>QuietMode = 1</code>に設定した場合、以下の項目を事前設定する必要があります。
</p>
<pre class="lt" style="font-family:monospace;">AcceptOriginLabLicenceAgreement<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>
SN<span style="color: #000080;">=</span>
UserName<span style="color: #000080;">=</span>
Company<span style="color: #000080;">=</span></pre>
<p>他の項目は、指定されていない場合、次のデフォルト値を使用します。
</p>
<pre class="lt" style="font-family:monospace;">InstallPath<span style="color: #000080;">=</span>C<span style="color: #000000;">:</span>\Program Files\OriginLab\Origin####
EmbeddedPython<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>
SPSSImport<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>
AllUsers<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>
ProgramFolder<span style="color: #000080;">=</span>C<span style="color: #000000;">:</span>\ProgramData\Microsoft\Windows\Start Menu\Programs\OriginLab Origin ####</pre>
<h6><a name="Origin_Folder_Path"></a><span class="mw-headline">Originフォルダのパス</span></h6>
<dl><dd><ul><li> ユーザファイルフォルダ </li></ul>
<dl><dd> - ユーザファイルフォルダを<i>[Locations]</i>セクションで事前設定します。</dd>
<dd> - Originを最初に起動するときに、事前設定されたパスで<a class="external text" href="../../UserGuide/UserGuide/The_User_Files_Folder.html"><b>ユーザファイルフォルダ</b>ダイアログ</a>を表示するかどうかを決定します。</dd></dl>
<ul><li> 自動保存フォルダ、バックアッププロジェクトフォルダ、未保存プロジェクトフォルダ</li></ul>
<dl><dd> - 自動保存フォルダ(AutoSave)、バックアッププロジェクトフォルダ(Backup)、未保存プロジェクトフォルダ(Unsaved)のルートフォルダを<i>[Locations]</i>セクションで事前設定します。</dd></dl>
<ul><li> アプリ</li></ul>
<dl><dd> - アプリフォルダ(Apps)を<i>[Apps]</i>セクションで事前設定します。</dd></dl></dd></dl>
<p><b>Note:</b><b>Config.ini</b>に事前設定されたフォルダパス（たとえば、ユーザーファイルフォルダまたは自動保存フォルダ）がある場合、以前のバージョンから古い設定を引き継ぐ代わりに、それらが使用されます。
</p>
<h6><a name="License_Management"></a><span class="mw-headline">ライセンス管理</span></h6>
<ul>
<li>ネットワーク同時起動版の場合、config.iniの[License]セクションにライセンスサーバとポート番号（存在する場合）を入力します。
<br />Originが以前にインストールされている場合、Replaceオプションを設定して現在のサーバー情報を更新するかどうかも決定できます。（注：Replaceオプションは、InstallShieldセットアップ config.iniファイルでのみ使用でき、MSIインストーラでは使用できません。）</li>
<li>ネットワーク接続が不安定または低速な場合などで、Originが同時起動ライセンスサーバーからの応答を待機する最大時間を増やす必要があるときは、config.iniの[License] セクションにシステム環境変数<code>FLEXLM_TIMEOUT</code> (マイクロ秒単位) を事前設定します。たとえば、<code>FLEXLM_TIMEOUT</code>を5秒に設定する場合
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">[</span>License<span style="color: #000000;">]</span> 
FLEXLM_TIMEOUT <span style="color: #000080;">=</span> <span style="color: #0000dd;">5000000</span></pre> 
<p><br /><code>FLEXLM_TIMEOUT</code>のデフォルト値は3000000 (3秒)です。より大きな値が既に存在する場合は、以下のように強制で設定しない限り更新されません。 
</p>
<pre class="lt" style="font-family:monospace;">FLEXLM_TIMEOUT_FORCE<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span></pre> 
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Multi_userDeployment/Tip_icon.png" width="57"  border="0" /></td><td><p>詳細は<a class="external text" href="../../QuickHelp/QuickHelp/What_should_I_do_if_I_see_license_expired_error_from_time_to_time.html">このFAQ</a>を参照してください。 
</p></td></tr></table></li>
</ul>
<h3><a name="Optional_Steps"></a><span class="mw-headline">オプションの手順</span></h3>
<p><span class='headerInParagraph'>プロダクトキーの事前設定</span> 
</p>
<dl><dd>マルチシート版ライセンスをお持ちで、エンドユーザのプロダクトキーを事前設定して、Originを自動的にアクティブ化できるようにする場合は、<a href="../../License/License/Group_Product_Key.html" title="ライセンス：グループプロダクトキー"><b>グループプロダクトキー</b></a>をリクエストして、インストーラファイルが配置されているフォルダ内のpk.txtファイルに保存できます。</dd></dl>
<p><span class='headerInParagraph'>インターフェイス設定、テンプレート、フィット関数などのカスタマイズファイルを自薦設定する。</span>
</p>
<dl><dd>メニューやボタン、グラフテンプレート、フィット関数などのエンドユーザのOriginを事前にカスタマイズしたい場合は、インストーラファイルが配置されているフォルダに<b>UpdateUserFiles</b>フォルダを作成し、カスタマイズしたファイル（OMC、XML、 ogwu、fdfなど）をUpdateUserFilesフォルダに移動します。これらは、Originを初めて起動したときに、各ユーザのユーザファイルフォルダにコピーされます。</dd></dl>
<p><span class='headerInParagraph'>opx/opkファイルの事前設定</span>
</p>
<dl><dd>2つの仕組みを利用できます。
<ul><li> Origin セットアップフォルダ（Setup.exeまたはMSIを含む）に<i>UpdateUserFiles</i>という名前のフォルダを作成すると、Originプログラムフォルダにコピーされます。Originを起動すると、UFFにコピーされます。</li>
<li> Origin セットアップフォルダ（Setup.exeまたはMSIを含む）に<i>Auto Install</i>という名前のフォルダを作成すると、Originプログラムフォルダにコピーされます。Originを起動すると、含まれている opx / opk が自動的にインストールされます。</li></ul></dd></dl>
<p><span class='headerInParagraph'>レジストリに保存されたシステム変数を事前設定する</span>
</p>
<dl><dd>Origin セットアップフォルダ（Setup.exeまたはMSIを含む）の<i>Config.ini</i>を、メモ帳で開きます。<i>[SysVar]</i>セクションを見つけて、ここに事前設定するシステム変数を追加します。Originをインストールすると、指定したシステム変数が設定されます。</dd></dl>
<h3><a name="Distribute_your_Origin_installation_package"></a><span class="mw-headline">Originインストールパッケージの配布</span></h3>
<ol>
<li> Originセットアップファイルをコンピュータ「A」のフォルダにコピーします。<b>Note：</b>コンピュータ「A」は、すべてのOriginユーザが接続できるネットワーク上に存在する必要があります。 
<li> その変更された<b>Config.ini</b>、<b>pk.txt</b>ファイルおよび<b>UpdateUserFiles</b>フォルダ（ある場合）が、setup.exeがあるOrigin Setupフォルダにあるのかを確認します。
<li> このフォルダーを完全な読み取り/書き込み権限で共有し、UNC共有名をメモします。（例： \\A\Origin\）
<li> すべてのユーザにメールを送信して、setup.exe/msiファイルの実行を依頼します。ユーザは、管理者特権を持つログインアカウントを使用してコンピュータにログインする必要があります。また、ユーザのコンピュータはコンピューター「A」にアクセスできるネットワーク上に存在する必要があります。  
</ol>
<p><b>Note:</b> 
</p>
<dl><dd><ul><li> このインストール方法は、Originをターゲットコンピュータにのみインストールします。</li>
<li> ネットワーク同時起動パッケージでは、登録はオプションです。ユーザがOriginを登録したいときは、メニューの<b>ヘルプ：Help: オンライン登録</b>で<b>登録</b>ダイアログを開いて登録します。</li></ul></dd></dl>
<h3><a name="MSI_Installation"></a><span class="mw-headline">MSIインストール</span></h3>
<p>MSIインストーラーインストールパッケージをセットアップする方法の詳細については、<a class="external text" href="http://originlab.com/index.aspx?go=Support/DocumentationAndHelpCenter/Installation/Multi-userDeployment/MSIInstall" target="_blank">このページ</a>を参照してください。
</p>
<h2><a name="Post_Installation_Updates_by_Group_Folder"></a><span class="mw-headline">グループフォルダによるインストール後の更新</span></h2>
<p>グループフォルダは、Originがファイルを配布するために提供するオプション機能です。複数のOriginユーザーがいるサイト/組織で使用できます。どのライセンスタイプにも対応しています。グループリーダーとグループメンバーのライセンスタイプが異なる場合でも。グループフォルダを使用してそれらの間でファイルを共有できます。
</p><p>グループフォルダ機能には、1つまたは複数のグループリーダーの設定が含まれます。たとえば、グループリーダーは組織の部門レベルで設定できます。組織内のすべてまたは任意の数のOriginユーザーとOriginProユーザーが、同じグループリーダーを共有できます。リーダーは、グループのメンバーにファイルを配布することができます。 
</p><p>グループリーダーを設定し、メンバーに対してカスタムOriginファイルとパッチを配布できます。それを行った後、Originをセットアップして、グループリーダーからの更新を受信するように事前定義することができます。
</p>
<h3><a name="Set_up_Group_Leader.28s.29_and_Group_Members"></a><span class="mw-headline">グループリーダーとグループメンバーのセットアップ</span></h3>
<p>はじめに、<a class="external text" href="../../UserGuide/UserGuide/Set_Group_Folder_Location_Dialog.html#Setting_the_Group_Folder_for_the_Group_Leader_Machine"><font color="blue">グループリーダーのPCのグループフォルダを設定します</font></a>。
</p><p>次に、<a class="external text" href="../../UserGuide/UserGuide/Set_Group_Folder_Location_Dialog.html#Setting_the_Group_Folder_for_the_Member_Machines"><font color="blue">メンバーのPCのグループフォルダを設定できます</font></a>。
</p>
<h3><a name="Use_the_Group_Folder_Manager_to_Publish_Files"></a><span class="mw-headline">グループフォルダマネージャを使用してファイルを公開する</span></h3>
<p>グループリーダーは、<a class="external text" href="../../UserGuide/UserGuide/Group_Folder_Manager.html">グループフォルダマネージャ</a>を使用してファイルをグループフォルダに追加、削除し、グループのメンバーに公開します。このツールの使い方の詳細については<a class="external text" href="../../UserGuide/UserGuide/Group_Folder_Manager.html">グループフォルダマネージャのドキュメント</a>をご参照ください。 
</p><p>グループメンバーがグループフォルダを指定した後、Originの起動時に、グループフォルダに新しいファイルが存在する場合、ファイルが更新されたことを通知するメッセージが表示されます（サポートされているファイルのみで、パッチは対象外です）。パッチの場合は、アップデートが利用可能であり、アップデートを実行するにはOriginの再起動が必要である旨が表示されます。
</p><p>共有グループフォルダのファイルは、ユーザファイルフォルダにあるグループメンバーの　\ GroupShared \　フォルダにコピーされます。
</p><p>ファイルは、テーマオーガナイザ、フィット関数オーガナイザなどのさまざまなOriginダイアログで利用可能になります。ファイルには、グループフォルダからのファイルであることを識別するために（グループの）先頭タグが付いています。
</p>
<h4><a name="Types_of_Files_that_can_be_Published"></a><span class="mw-headline">公開できるファイルの種類</span></h4>
<ul>
<li><b>Originでサポートしているファイル</b>：プロジェクト、テンプレート、フィット関数などです。<br /><b>Note</b>：事前定義した<a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html">システム変数</a>があり、それをopxファイルで共有したい場合は、opxファイルをユーザファイルフォルダ下の \GroupShared\ フォルダから移動する必要があります。そうしないと、opxファイルは自動インストールされません。 
<li><b>Originのサービスリリースを公開</b><br />バージョン内で、OriginLabは通常、リリースバージョンで見つかった問題を修正するために1つ以上の<a class="external text" href="https://www.originlab.com/index.aspx?go=Support&amp;pid=1036" target="_blank">サービスリリース</a>を公開します。通常、サービスリリースはパッチとして提供されます。
<ol>
<li>最初にグループリーダーのPCにパッチを適用する必要があります。完了したら、PCを再起動します。
<li><b>グループフォルダマネージャ</b>を使用して、グループリーダーに適用したパッチファイルを公開します。
<li>これで、OriginグループメンバーがOriginを開始すると、グループリーダーからパッチを入手できるというメッセージが表示されます。パッチを適用してOriginを閉じると、パッチプログラムの実行が開始されます。
</ol>
</li>
<li><b>FLEXnetサーバを移行し、新しい場所のメンバーを更新する（同時起動ネットワークパッケージ）</b><br />
FLEXnetサービスを別のPCに移動した場合、グループフォルダ機能を使用して、この新しい場所で同時起動ネットワークパッケージのメンバーを更新できます。
<ol>
<li>新しいFLEXnetサーバをセットアップし、サービスを正常に実行した後、グループリーダーのライセンスフォルダ（通常は非表示）にあるUSE_SERVER.licファイルを編集できます。次の場所にあります：<br /> <code>C:\ProgramData\OriginLab\License</code>
<br />FLEXnetサーバ名を&lt;FLEXnet server&gt;とすると、このファイルには通常、次のテキストが含まれます。
<pre class="lt" style="font-family:monospace;">SERVER <span style="color: #000080;">&lt;</span>FLEXnet server<span style="color: #000080;">&gt;</span> ANY
USE_SERVER</pre>
<p>FLEXnetサーバーの3台冗長構成もサポートされています。たとえば、3つのサーバ&lt;one&gt;、&lt;two&gt;、&lt;three&gt;、およびポート12345、23456、34567がある場合、USE_SERVER.licファイルは次のようになります。
</p>
<pre class="lt" style="font-family:monospace;">SERVER <span style="color: #000080;">&lt;</span>one<span style="color: #000080;">&gt;</span> ANY <span style="color: #0000dd;">12345</span>
SERVER <span style="color: #000080;">&lt;</span>two<span style="color: #000080;">&gt;</span> ANY <span style="color: #0000dd;">23456</span>
SERVER <span style="color: #000080;">&lt;</span>three<span style="color: #000080;">&gt;</span> ANY <span style="color: #0000dd;">34567</span>
USE_SERVER</pre>
<li>この変更が行われ、OriginグループリーダーのPCが起動されると、このファイルは自動的にグループフォルダに公開され、Originグループメンバーには、「同時起動ライセンスサーバの設定が更新されました。OKをクリックして再起動してください」というメッセージが表示されます。
</ol>
</li>
</ul>



    