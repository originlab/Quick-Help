<h1 class="firstheading">originproパッケージを使ったコードサンプル</h1><p><br />
</p>
<p class='urlname' style='display: none'>Python-Examples-using-originpro</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Introduction"><span class="tocnumber">1</span> <span class="toctext">はじめに</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Worksheet_Data"><span class="tocnumber">2</span> <span class="toctext">ワークシートデータ</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Putting_Data_to_Columns"><span class="tocnumber">2.1</span> <span class="toctext">列にデータを入力</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Import_Data"><span class="tocnumber">2.2</span> <span class="toctext">データをインポート</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#DataFrame_and_Column_Format"><span class="tocnumber">2.3</span> <span class="toctext">DataFrameと列フォーマット</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Split_Dataset_to_Training_and_Testing_Data"><span class="tocnumber">2.4</span> <span class="toctext">データセットを訓練データおよびテストデータに分割</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-7"><a href="#Matrix_Data_Manipulation"><span class="tocnumber">3</span> <span class="toctext">行列データの操作</span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="#Matrix_Dot_Product_using_numpy"><span class="tocnumber">3.1</span> <span class="toctext">numpyを使った行列のドット積</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Use_OpenCV_to_Load_TIFF_Images_into_Matrix_Sheet"><span class="tocnumber">3.2</span> <span class="toctext">OpenCVを使って行列シートにTIFF画像をロード</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-10"><a href="#Graphing"><span class="tocnumber">4</span> <span class="toctext">グラフ作成</span></a>
<ul>
<li class="toclevel-2 tocsection-11"><a href="#Line_Plot_with_Log_Scale"><span class="tocnumber">4.1</span> <span class="toctext">対数スケールの折れ線グラフ</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-12"><a href="#Project"><span class="tocnumber">5</span> <span class="toctext">プロジェクト</span></a>
<ul>
<li class="toclevel-2 tocsection-13"><a href="#Export_Graphs_as_Images_from_Sample_Projects"><span class="tocnumber">5.1</span> <span class="toctext">サンプルプロジェクトのグラフを画像としてエクスポート</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#Extract_Image_Colors"><span class="tocnumber">5.2</span> <span class="toctext">画像の色を抽出</span></a></li>
</ul>
</li>
</ul>
</div>

<p><br />
</p>
<h2><a name="Introduction"></a><span class="mw-headline">はじめに</span></h2>
<p>このページではPythonコードのサンプルを紹介します。サンプルを試す簡単な方法は以下の通りです。
</p>
<ol><li> Originのメニューから<b>接続 &gt; untitled.pyを開く...</b>を選択します。これにより、コードビルダで<b>untitled.py</b>が開きます。</li>
<li> 各サンプルにあるコードをコピーして貼り付けます（すでにコードが入力されている場合は置換）。</li>
<li> F5キーを押して実行します。実行前に保存する必要はありません。</li></ol>
<p>サンプルには、あらかじめPythonパッケージのインストールが必要なものもあります。パッケージをインストールするコマンドを使用してから、コードビルダでPython IDEにサンプルコードをコピーして実行してください。
</p>
<h2><a name="Worksheet_Data"></a><span class="mw-headline">ワークシートデータ</span></h2>
<p><b>new_sheet</b>などの関数は、<a class="external text" href="https://www.originlab.com/python/doc/originpro/namespaceoriginpro_1_1project.html" target="_blank">project.py</a>を参照してください。
</p><p><b>from_list</b>は、<a class="external text" href="https://www.originlab.com/python/doc/originpro/classoriginpro_1_1worksheet_1_1_w_sheet.html" target="_blank">worksheet</a>を参照してください。
</p>
<h3><a name="Putting_Data_to_Columns"></a><span class="mw-headline">列にデータを入力</span></h3>
<pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">import</span> originpro <span style="color: #ff7700;font-weight:bold;">as</span> op
data<span style="color: #000;">=</span><span style="color: #000;">[</span>x/<span style="color: #000;">10</span>.<span style="color: #ff7700;font-weight:bold;">for</span> x <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: #900090;">range</span><span style="color: #000;">(</span><span style="color: #000;">50</span><span style="color: #000;">)</span><span style="color: #000;">]</span>
wks<span style="color: #000;">=</span>op.<span style="color: #000;">new_sheet</span><span style="color: #000;">(</span><span style="color: #000;">)</span>
wks.<span style="color: #000;">from_list</span><span style="color: #000;">(</span><span style="color: #0a0;">&apos;A&apos;</span><span style="color: #000;">,</span>data<span style="color: #000;">,</span> <span style="color: #0a0;">&apos;time&apos;</span><span style="color: #000;">,</span> <span style="color: #0a0;">&apos;sec&apos;</span><span style="color: #000;">,</span>axis<span style="color: #000;">=</span><span style="color: #0a0;">&apos;N&apos;</span><span style="color: #000;">)</span>
data1<span style="color: #000;">=</span><span style="color: #000;">[</span>x*<span style="color: #000;">1.5</span> <span style="color: #ff7700;font-weight:bold;">for</span> x <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: #900090;">range</span><span style="color: #000;">(</span><span style="color: #000;">50</span><span style="color: #000;">)</span><span style="color: #000;">]</span>
wks.<span style="color: #000;">from_list</span><span style="color: #000;">(</span><span style="color: #0a0;">&apos;B&apos;</span><span style="color: #000;">,</span> data1<span style="color: #000;">,</span> axis<span style="color: #000;">=</span><span style="color: #0a0;">&apos;X&apos;</span><span style="color: #000;">)</span>
wks.<span style="color: #000;">cols</span><span style="color: #000;">=</span><span style="color: #000;">3</span>
wks.<span style="color: #000;">from_list</span><span style="color: #000;">(</span><span style="color: #000;">2</span><span style="color: #000;">,</span> <span style="color: #000;">[</span><span style="color: #900090;">sum</span><span style="color: #000;">(</span>i<span style="color: #000;">)</span> <span style="color: #ff7700;font-weight:bold;">for</span> i <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: #900090;">zip</span><span style="color: #000;">(</span>data<span style="color: #000;">,</span> data1<span style="color: #000;">)</span><span style="color: #000;">]</span><span style="color: #000;">,</span> comments <span style="color: #000;">=</span> <span style="color: #0a0;">&apos;A+B&apos;</span><span style="color: #000;">)</span></pre>
<h3><a name="Import_Data"></a><span class="mw-headline">データをインポート</span></h3>
<pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">import</span> originpro <span style="color: #ff7700;font-weight:bold;">as</span> op
f<span style="color: #000;">=</span>op.<span style="color: #000;">path</span><span style="color: #000;">(</span><span style="color: #0a0;">&apos;e&apos;</span><span style="color: #000;">)</span>+r<span style="color: #0a0;">&apos;Samples<span style="color: #000099; font-weight: bold;">\C</span>urve Fitting<span style="color: #000099; font-weight: bold;">\E</span>nzyme.dat&apos;</span>
<span style="color: #d00; font-style: italic;">#ワークシートがアクティブであると仮定</span>
wks<span style="color: #000;">=</span>op.<span style="color: #000;">find_sheet</span><span style="color: #000;">(</span><span style="color: #000;">)</span>
wks.<span style="color: #000;">from_file</span><span style="color: #000;">(</span>f<span style="color: #000;">)</span>
<span style="color: #ff7700;font-weight:bold;">print</span><span style="color: #000;">(</span>wks.<span style="color: #000;">shape</span><span style="color: #000;">)</span></pre>
<h3><a name="DataFrame_and_Column_Format"></a><span class="mw-headline">DataFrameと列フォーマット</span></h3>
<p>DataFrameでは、列名と、カテゴリ列や日時といった列データフォーマットの両方を使用できます。originproは、<b>from_df</b>と<b>to_df</b>を呼び出すだけです。
</p><p>以下のサンプルを試す前に、必ずpandasをインストールしてください。このモジュールをインストールするには、スクリプトウィンドウを開き（Shift+Alt+3）、以下を入力してEnterキーを押します。
</p>
<pre class="lt" style="font-family:monospace;">pip install pandas</pre>
<p>インストール済みか確認してからインストールするには以下を実行します。 
</p>
<pre class="lt" style="font-family:monospace;">pip <span style="color: #000080;">-</span>chk pandas</pre>
<pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">import</span> originpro <span style="color: #ff7700;font-weight:bold;">as</span> op
<span style="color: #ff7700;font-weight:bold;">import</span> pandas <span style="color: #ff7700;font-weight:bold;">as</span> pd
df <span style="color: #000;">=</span> pd.<span style="color: #000;">DataFrame</span><span style="color: #000;">(</span><span style="color: #000;">{</span>
    <span style="color: #0a0;">&apos;Date&apos;</span>: <span style="color: #000;">[</span><span style="color: #0a0;">&apos;10/25/2018&apos;</span><span style="color: #000;">,</span><span style="color: #0a0;">&apos;02/21/2019&apos;</span><span style="color: #000;">,</span><span style="color: #0a0;">&apos;04/01/2020&apos;</span><span style="color: #000;">]</span><span style="color: #000;">,</span>
    <span style="color: #0a0;">&apos;Gender&apos;</span>:<span style="color: #000;">[</span><span style="color: #0a0;">&apos;Male&apos;</span><span style="color: #000;">,</span><span style="color: #0a0;">&apos;Male&apos;</span><span style="color: #000;">,</span><span style="color: #0a0;">&apos;Female&apos;</span><span style="color: #000;">]</span><span style="color: #000;">,</span>
    <span style="color: #0a0;">&apos;Score&apos;</span>: <span style="color: #000;">[</span><span style="color: #000;">75.5</span><span style="color: #000;">,</span> <span style="color: #000;">86.7</span><span style="color: #000;">,</span> <span style="color: #000;">91</span><span style="color: #000;">]</span><span style="color: #000;">,</span>
<span style="color: #000;">}</span><span style="color: #000;">)</span>

df<span style="color: #000;">[</span><span style="color: #0a0;">&apos;Date&apos;</span><span style="color: #000;">]</span> <span style="color: #000;">=</span> pd.<span style="color: #000;">to_datetime</span><span style="color: #000;">(</span>df<span style="color: #000;">[</span><span style="color: #0a0;">&apos;Date&apos;</span><span style="color: #000;">]</span><span style="color: #000;">)</span>
df<span style="color: #000;">[</span><span style="color: #0a0;">&apos;Gender&apos;</span><span style="color: #000;">]</span><span style="color: #000;">=</span> pd.<span style="color: #000;">Categorical</span><span style="color: #000;">(</span>df<span style="color: #000;">[</span><span style="color: #0a0;">&apos;Gender&apos;</span><span style="color: #000;">]</span><span style="color: #000;">)</span>

wks<span style="color: #000;">=</span>op.<span style="color: #000;">new_sheet</span><span style="color: #000;">(</span><span style="color: #000;">)</span>
wks.<span style="color: #000;">from_df</span><span style="color: #000;">(</span>df<span style="color: #000;">)</span>
<span style="color: #d00; font-style: italic;">#このようにしてブック作成と第一シートを取得可能</span>
wks2<span style="color: #000;">=</span>op.<span style="color: #000;">new_book</span><span style="color: #000;">(</span><span style="color: #0a0;">&apos;w&apos;</span><span style="color: #000;">,</span> <span style="color: #0a0;">&apos;Copy using DF&apos;</span><span style="color: #000;">)</span><span style="color: #000;">[</span><span style="color: #000;">0</span><span style="color: #000;">]</span>
<span style="color: #d00; font-style: italic;">#日付などの列フォーマットは自動的に処理</span>
df1<span style="color: #000;">=</span>wks.<span style="color: #000;">to_df</span><span style="color: #000;">(</span><span style="color: #000;">)</span>
wks2.<span style="color: #000;">from_df</span><span style="color: #000;">(</span>df1<span style="color: #000;">)</span></pre>
<h3><a name="Split_Dataset_to_Training_and_Testing_Data"></a><span class="mw-headline">データセットを訓練データおよびテストデータに分割</span></h3>
<p>このサンプルでは、sklearnパッケージを使って、複数列のデータセットをTrainとTestという2つのデータセットに分割します。パッケージの有無をチェックしてインストールするには、スクリプトウィンドウを開き（Shift+Alt+3）、以下を入力してEnterキーを押します 
</p>
<pre class="lt" style="font-family:monospace;">pip <span style="color: #000080;">-</span>chk pandas sklearn</pre>
<p>サンプルデータセットの一つをインポートし、訓練データとテストデータセットにランダムに分割するサンプルです。
</p>
<pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">import</span> numpy <span style="color: #ff7700;font-weight:bold;">as</span> np
<span style="color: #ff7700;font-weight:bold;">import</span> pandas <span style="color: #ff7700;font-weight:bold;">as</span> pd
<span style="color: #ff7700;font-weight:bold;">import</span> originpro <span style="color: #ff7700;font-weight:bold;">as</span> op
<span style="color: #ff7700;font-weight:bold;">from</span> sklearn.<span style="color: #000;">model_selection</span> <span style="color: #ff7700;font-weight:bold;">import</span> train_test_split


<span style="color: #d00; font-style: italic;"># データをインポートして独立データと従属データをそれぞれXとyに取得 respectively</span>
ws<span style="color: #000;">=</span>op.<span style="color: #000;">new_sheet</span><span style="color: #000;">(</span><span style="color: #000;">)</span>
ws.<span style="color: #000;">from_file</span><span style="color: #000;">(</span>fname<span style="color: #000;">=</span>op.<span style="color: #000;">path</span><span style="color: #000;">(</span><span style="color: #0a0;">&apos;e&apos;</span><span style="color: #000;">)</span>+r<span style="color: #0a0;">&quot;Samples<span style="color: #000099; font-weight: bold;">\S</span>tatistics<span style="color: #000099; font-weight: bold;">\F</span>isher&apos;s Iris Data.dat&quot;</span><span style="color: #000;">,</span> keep_DC<span style="color: #000;">=</span><span style="color: #900090;">False</span><span style="color: #000;">)</span>
X <span style="color: #000;">=</span> ws.<span style="color: #000;">to_df</span><span style="color: #000;">(</span>c1<span style="color: #000;">=</span><span style="color: #000;">0</span><span style="color: #000;">,</span> numcols<span style="color: #000;">=</span><span style="color: #000;">4</span><span style="color: #000;">)</span>  <span style="color: #d00; font-style: italic;"># 最初の4列をXとして取得</span>
y <span style="color: #000;">=</span> ws.<span style="color: #000;">to_df</span><span style="color: #000;">(</span>c1<span style="color: #000;">=</span><span style="color: #000;">4</span><span style="color: #000;">,</span> numcols<span style="color: #000;">=</span><span style="color: #000;">1</span><span style="color: #000;">)</span>  <span style="color: #d00; font-style: italic;">#最後の列をYとして取得</span>

<span style="color: #d00; font-style: italic;"># データセットを訓練およびテストデータセットに分割</span>
<span style="color: #d00; font-style: italic;"># 訓練データセットは70%のサンプルを含み、テストデータセット30%のサンプルを含む</span>
<span style="color: #d00; font-style: italic;"># 分割前にデータをシャッフル</span>
X_train<span style="color: #000;">,</span> X_test<span style="color: #000;">,</span> y_train<span style="color: #000;">,</span> y_test <span style="color: #000;">=</span> train_test_split<span style="color: #000;">(</span>X<span style="color: #000;">,</span> y<span style="color: #000;">,</span> test_size<span style="color: #000;">=</span><span style="color: #000;">0.3</span><span style="color: #000;">,</span> shuffle<span style="color: #000;">=</span><span style="color: #900090;">True</span><span style="color: #000;">,</span> random_state<span style="color: #000;">=</span><span style="color: #000;">1</span><span style="color: #000;">)</span>

<span style="color: #d00; font-style: italic;"># 分割したデータセット用にワークブックを作成</span>
wks <span style="color: #000;">=</span> op.<span style="color: #000;">new_sheet</span><span style="color: #000;">(</span><span style="color: #0a0;">&apos;w&apos;</span><span style="color: #000;">,</span> <span style="color: #0a0;">&apos;Split&apos;</span><span style="color: #000;">)</span>
Num <span style="color: #000;">=</span> X_train.<span style="color: #000;">columns</span>.<span style="color: #000;">shape</span><span style="color: #000;">[</span><span style="color: #000;">0</span><span style="color: #000;">]</span>
wks.<span style="color: #000;">from_list</span><span style="color: #000;">(</span>Num<span style="color: #000;">,</span> y_train.<span style="color: #000;">iloc</span><span style="color: #000;">[</span>:<span style="color: #000;">,</span> <span style="color: #000;">0</span><span style="color: #000;">]</span>.<span style="color: #000;">tolist</span><span style="color: #000;">(</span><span style="color: #000;">)</span><span style="color: #000;">,</span> comments<span style="color: #000;">=</span><span style="color: #0a0;">&apos;Train&apos;</span><span style="color: #000;">,</span> lname<span style="color: #000;">=</span>y_train.<span style="color: #000;">columns</span><span style="color: #000;">[</span><span style="color: #000;">0</span><span style="color: #000;">]</span><span style="color: #000;">)</span>
wks.<span style="color: #000;">from_list</span><span style="color: #000;">(</span>Num*<span style="color: #000;">2</span>+<span style="color: #000;">1</span><span style="color: #000;">,</span> y_test.<span style="color: #000;">iloc</span><span style="color: #000;">[</span>:<span style="color: #000;">,</span> <span style="color: #000;">0</span><span style="color: #000;">]</span>.<span style="color: #000;">tolist</span><span style="color: #000;">(</span><span style="color: #000;">)</span><span style="color: #000;">,</span> comments<span style="color: #000;">=</span><span style="color: #0a0;">&apos;Test&apos;</span><span style="color: #000;">,</span> lname<span style="color: #000;">=</span>y_train.<span style="color: #000;">columns</span><span style="color: #000;">[</span><span style="color: #000;">0</span><span style="color: #000;">]</span><span style="color: #000;">)</span>
<span style="color: #ff7700;font-weight:bold;">for</span> idx <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: #900090;">range</span><span style="color: #000;">(</span>Num<span style="color: #000;">)</span>:
	wks.<span style="color: #000;">from_list</span><span style="color: #000;">(</span>idx<span style="color: #000;">,</span> X_train.<span style="color: #000;">iloc</span><span style="color: #000;">[</span>:<span style="color: #000;">,</span> idx<span style="color: #000;">]</span>.<span style="color: #000;">tolist</span><span style="color: #000;">(</span><span style="color: #000;">)</span><span style="color: #000;">,</span> comments<span style="color: #000;">=</span><span style="color: #0a0;">&apos;Train&apos;</span><span style="color: #000;">,</span> lname<span style="color: #000;">=</span>X_train.<span style="color: #000;">columns</span><span style="color: #000;">[</span>idx<span style="color: #000;">]</span><span style="color: #000;">)</span>
	wks.<span style="color: #000;">from_list</span><span style="color: #000;">(</span>Num+<span style="color: #000;">1</span>+idx<span style="color: #000;">,</span> X_test.<span style="color: #000;">iloc</span><span style="color: #000;">[</span>:<span style="color: #000;">,</span> idx<span style="color: #000;">]</span>.<span style="color: #000;">tolist</span><span style="color: #000;">(</span><span style="color: #000;">)</span><span style="color: #000;">,</span> comments<span style="color: #000;">=</span><span style="color: #0a0;">&apos;Test&apos;</span><span style="color: #000;">,</span> lname<span style="color: #000;">=</span>X_train.<span style="color: #000;">columns</span><span style="color: #000;">[</span>idx<span style="color: #000;">]</span><span style="color: #000;">)</span></pre>
<h2><a name="Matrix_Data_Manipulation"></a><span class="mw-headline">行列データの操作</span></h2>
<p>Originの行列シートは、同じ形状の2D配列である複数の行列オブジェクトを保持できるので、行列シートは3D配列を保持できます。このセクションでは、OriginのMatrixSheetとNumPy配列間のデータ転送に焦点を当てます。
詳細は、<a class="external text" href="https://www.originlab.com/python/doc/originpro/classoriginpro_1_1matrix_1_1_m_sheet.html" target="_blank">matrix.py</a>を参照してください。
</p>
<h3><a name="Matrix_Dot_Product_using_numpy"></a><span class="mw-headline">numpyを使った行列のドット積</span></h3>
<p>このサンプルではNumPyを使用します。NumPyはPandasに含まれており、遅かれ早かれ必要になるPandasをインストールするのが最善です。パッケージの有無をチェックしてインストールするには、スクリプトウィンドウを開き（Shift+Alt+3）、以下を入力してEnterキーを押します。
</p>
<pre class="lt" style="font-family:monospace;">pip <span style="color: #000080;">-</span>chk pandas</pre>
<p>これは、Originの行列とNumpy配列間の基本的なデータ転送を示すサンプルです。
</p>
<pre class="python" style="font-family:monospace;"><span style="color: #d00; font-style: italic;">#3つの行列シートを作成してm3 = m1*m2とする</span>
<span style="color: #ff7700;font-weight:bold;">import</span> numpy <span style="color: #ff7700;font-weight:bold;">as</span> np
<span style="color: #ff7700;font-weight:bold;">import</span> originpro <span style="color: #ff7700;font-weight:bold;">as</span> op
<span style="color: #d00; font-style: italic;">#整数の行列データ</span>
aa <span style="color: #000;">=</span> np.<span style="color: #000;">array</span><span style="color: #000;">(</span><span style="color: #000;">[</span>	<span style="color: #000;">[</span><span style="color: #000;">1</span><span style="color: #000;">,</span> <span style="color: #000;">2</span><span style="color: #000;">,</span> <span style="color: #000;">3</span><span style="color: #000;">]</span><span style="color: #000;">,</span> <span style="color: #000;">[</span><span style="color: #000;">4</span><span style="color: #000;">,</span> <span style="color: #000;">5</span><span style="color: #000;">,</span> <span style="color: #000;">6</span><span style="color: #000;">]</span> <span style="color: #000;">]</span><span style="color: #000;">)</span>
bb <span style="color: #000;">=</span> np.<span style="color: #000;">array</span><span style="color: #000;">(</span><span style="color: #000;">[</span>	<span style="color: #000;">[</span><span style="color: #000;">10</span><span style="color: #000;">,</span><span style="color: #000;">11</span><span style="color: #000;">]</span><span style="color: #000;">,</span> <span style="color: #000;">[</span><span style="color: #000;">20</span><span style="color: #000;">,</span><span style="color: #000;">21</span><span style="color: #000;">]</span><span style="color: #000;">,</span> <span style="color: #000;">[</span><span style="color: #000;">30</span><span style="color: #000;">,</span><span style="color: #000;">31</span><span style="color: #000;">]</span> <span style="color: #000;">]</span><span style="color: #000;">)</span>
<span style="color: #d00; font-style: italic;">#新しい非表示行列ブックを作製して行列シートを取得</span>
ma<span style="color: #000;">=</span>op.<span style="color: #000;">new_sheet</span><span style="color: #000;">(</span><span style="color: #0a0;">&apos;m&apos;</span><span style="color: #000;">)</span>
<span style="color: #d00; font-style: italic;">#行列シートは3D配列を保持でき、形状とデータ型は自動的に設定される</span>
ma.<span style="color: #000;">from_np</span><span style="color: #000;">(</span>aa<span style="color: #000;">)</span>
<span style="color: #d00; font-style: italic;">#同じブックの他のシート</span>
mb <span style="color: #000;">=</span> ma.<span style="color: #000;">get_book</span><span style="color: #000;">(</span><span style="color: #000;">)</span>.<span style="color: #000;">add_sheet</span><span style="color: #000;">(</span><span style="color: #000;">)</span>
mb.<span style="color: #000;">from_np</span><span style="color: #000;">(</span>bb<span style="color: #000;">)</span>

<span style="color: #d00; font-style: italic;">#結果を3番目のシートに出力</span>
mc <span style="color: #000;">=</span> ma.<span style="color: #000;">get_book</span><span style="color: #000;">(</span><span style="color: #000;">)</span>.<span style="color: #000;">add_sheet</span><span style="color: #000;">(</span><span style="color: #0a0;">&apos;Dot Product&apos;</span><span style="color: #000;">)</span>
<span style="color: #d00; font-style: italic;">#numpyを使用して実際の計算を行う</span>
<span style="color: #d00; font-style: italic;">#ここでは各シートに1つの行列オブジェクトしかないため2D配列として取得</span>
cc <span style="color: #000;">=</span> np.<span style="color: #000;">dot</span><span style="color: #000;">(</span>ma.<span style="color: #000;">to_np2d</span><span style="color: #000;">(</span><span style="color: #000;">)</span><span style="color: #000;">,</span> mb.<span style="color: #000;">to_np2d</span><span style="color: #000;">(</span><span style="color: #000;">)</span><span style="color: #000;">)</span>
mc.<span style="color: #000;">from_np</span><span style="color: #000;">(</span>cc<span style="color: #000;">)</span></pre>
<h3><a name="Use_OpenCV_to_Load_TIFF_Images_into_Matrix_Sheet"></a><span class="mw-headline">OpenCVを使って行列シートにTIFF画像をロード</span></h3>
<p>スクリプトウィンドウで以下を実行して、openCV (cv2)をインストールします。
</p>
<pre class="lt" style="font-family:monospace;">pip install opencv<span style="color: #000080;">-</span>python</pre>
<p>このサンプルでは、tif画像を3D numpy配列にインポートしてからOriginの行列ブックに渡す方法を示します。
</p>
<pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">import</span> originpro <span style="color: #ff7700;font-weight:bold;">as</span> op
<span style="color: #ff7700;font-weight:bold;">import</span> numpy <span style="color: #ff7700;font-weight:bold;">as</span> np
<span style="color: #ff7700;font-weight:bold;">import</span> cv2

<span style="color: #d00; font-style: italic;"># 複数のTIF画像を配列にインポート</span>
<span style="color: #d00; font-style: italic;"># 全画像は同じサイズであると仮定</span>
ImArray <span style="color: #000;">=</span> np.<span style="color: #000;">array</span><span style="color: #000;">(</span><span style="color: #000;">[</span><span style="color: #000;">]</span><span style="color: #000;">)</span>
<span style="color: #ff7700;font-weight:bold;">for</span> idx <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: #900090;">range</span><span style="color: #000;">(</span><span style="color: #000;">7</span><span style="color: #000;">)</span>:
	fname <span style="color: #000;">=</span> op.<span style="color: #000;">path</span><span style="color: #000;">(</span><span style="color: #0a0;">&apos;e&apos;</span><span style="color: #000;">)</span> + f<span style="color: #0a0;">&apos;Samples<span style="color: #000099; font-weight: bold;">\\</span>Image Processing and Analysis<span style="color: #000099; font-weight: bold;">\\</span>myocyte{idx+1}.tif&apos;</span>
	<span style="color: #000;">array</span> <span style="color: #000;">=</span> np.<span style="color: #000;">array</span><span style="color: #000;">(</span>cv2.<span style="color: #000;">imread</span><span style="color: #000;">(</span>fname<span style="color: #000;">,</span> cv2.<span style="color: #000;">IMREAD_UNCHANGED</span><span style="color: #000;">)</span><span style="color: #000;">)</span>
	ImArray <span style="color: #000;">=</span> np.<span style="color: #000;">dstack</span><span style="color: #000;">(</span><span style="color: #000;">(</span>ImArray<span style="color: #000;">,</span> <span style="color: #000;">array</span><span style="color: #000;">)</span><span style="color: #000;">)</span> <span style="color: #ff7700;font-weight:bold;">if</span> ImArray.<span style="color: #000;">size</span> <span style="color: #ff7700;font-weight:bold;">else</span> <span style="color: #000;">array</span>

<span style="color: #d00; font-style: italic;"># この3D配列をOriginの行列シートに置く</span>
ms <span style="color: #000;">=</span> op.<span style="color: #000;">new_sheet</span><span style="color: #000;">(</span><span style="color: #0a0;">&apos;m&apos;</span><span style="color: #000;">)</span>
ms.<span style="color: #000;">from_np</span><span style="color: #000;">(</span>arr<span style="color: #000;">=</span>ImArray<span style="color: #000;">,</span> dstack<span style="color: #000;">=</span><span style="color: #900090;">True</span><span style="color: #000;">)</span>
ms.<span style="color: #000;">show_slider</span><span style="color: #000;">(</span><span style="color: #900090;">True</span><span style="color: #000;">)</span>
ms.<span style="color: #000;">show_image</span><span style="color: #000;">(</span><span style="color: #900090;">True</span><span style="color: #000;">)</span></pre>
<h2><a name="Graphing"></a><span class="mw-headline">グラフ作成</span></h2>
<p>Originは複雑なグラフを作図できます。したがって、グラフ機能を最大限に活用するには、すでにグラフが作成されているプロジェクトを準備し、データを入れ替えるのが最善の方法です。<a href="../../Python/Python/Sample_Projects_with_Attached_Python_Codes.html" title="Python:Pythonコードが添付されたサンプルプロジェクト">Pythonコードが添付されたサンプルプロジェクト</a>のページにいくつかサンプルを用意しています。
</p><p>以下のサンプルでは、originproパッケージでプロット作成やシンプルなカスタマイズを実行する基本的な方法を示します。
</p>
<h3><a name="Line_Plot_with_Log_Scale"></a><span class="mw-headline">対数スケールの折れ線グラフ</span></h3>
<p>このサンプルでは、いくつかのPythonパッケージが必要です。パッケージの有無をチェックしてインストールするには、スクリプトウィンドウを開き（Shift+Alt+3）、以下を入力してEnterキーを押します。
</p>
<pre class="lt" style="font-family:monospace;">pip <span style="color: #000080;">-</span>chk scipy numpy</pre>
<p>以下のサンプルでは、サンプルの信号データを作成し、このパッケージを使ってピリオドグラムパワースペクトル密度プロットを作成します。
</p>
<pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">import</span> numpy <span style="color: #ff7700;font-weight:bold;">as</span> np
<span style="color: #ff7700;font-weight:bold;">from</span> scipy <span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #000;">signal</span>
<span style="color: #ff7700;font-weight:bold;">import</span> originpro <span style="color: #ff7700;font-weight:bold;">as</span> op

fs <span style="color: #000;">=</span> <span style="color: #000;">10e3</span>
N <span style="color: #000;">=</span> <span style="color: #000;">1e5</span>
amp <span style="color: #000;">=</span> <span style="color: #000;">2</span>*np.<span style="color: #000;">sqrt</span><span style="color: #000;">(</span><span style="color: #000;">2</span><span style="color: #000;">)</span>
freq <span style="color: #000;">=</span> <span style="color: #000;">1234.0</span>
noise_power <span style="color: #000;">=</span> <span style="color: #000;">0.001</span> * fs / <span style="color: #000;">2</span>
<span style="color: #000;">time</span> <span style="color: #000;">=</span> np.<span style="color: #000;">arange</span><span style="color: #000;">(</span>N<span style="color: #000;">)</span> / fs
x <span style="color: #000;">=</span> amp*np.<span style="color: #000;">sin</span><span style="color: #000;">(</span><span style="color: #000;">2</span>*np.<span style="color: #000;">pi</span>*freq*<span style="color: #000;">time</span><span style="color: #000;">)</span>
x +<span style="color: #000;">=</span> np.<span style="color: #000;">random</span>.<span style="color: #000;">normal</span><span style="color: #000;">(</span>scale<span style="color: #000;">=</span>np.<span style="color: #000;">sqrt</span><span style="color: #000;">(</span>noise_power<span style="color: #000;">)</span><span style="color: #000;">,</span> size<span style="color: #000;">=</span><span style="color: #000;">time</span>.<span style="color: #000;">shape</span><span style="color: #000;">)</span>
f<span style="color: #000;">,</span> Pxx_den <span style="color: #000;">=</span> <span style="color: #000;">signal</span>.<span style="color: #000;">periodogram</span><span style="color: #000;">(</span>x<span style="color: #000;">,</span> fs<span style="color: #000;">)</span>

wks <span style="color: #000;">=</span> op.<span style="color: #000;">new_sheet</span><span style="color: #000;">(</span><span style="color: #900090;">type</span><span style="color: #000;">=</span><span style="color: #0a0;">&apos;w&apos;</span><span style="color: #000;">,</span> lname<span style="color: #000;">=</span><span style="color: #0a0;">&apos;Periodogram Power Spectral&apos;</span><span style="color: #000;">)</span>
wks.<span style="color: #000;">from_list</span><span style="color: #000;">(</span><span style="color: #000;">0</span><span style="color: #000;">,</span> f<span style="color: #000;">,</span> lname<span style="color: #000;">=</span><span style="color: #0a0;">&apos;Freq&apos;</span><span style="color: #000;">,</span> units<span style="color: #000;">=</span><span style="color: #0a0;">&apos;Hz&apos;</span><span style="color: #000;">)</span>
wks.<span style="color: #000;">from_list</span><span style="color: #000;">(</span><span style="color: #000;">1</span><span style="color: #000;">,</span> Pxx_den<span style="color: #000;">,</span> lname<span style="color: #000;">=</span><span style="color: #0a0;">&apos;PSD&apos;</span><span style="color: #000;">,</span> units<span style="color: #000;">=</span><span style="color: #0a0;">&apos;V<span style="color: #000099; font-weight: bold;">\+</span>(2)/Hz&apos;</span><span style="color: #000;">)</span>

graph <span style="color: #000;">=</span> op.<span style="color: #000;">new_graph</span><span style="color: #000;">(</span>template<span style="color: #000;">=</span><span style="color: #0a0;">&apos;line&apos;</span><span style="color: #000;">)</span>
graph<span style="color: #000;">[</span><span style="color: #000;">0</span><span style="color: #000;">]</span>.<span style="color: #000;">yscale</span> <span style="color: #000;">=</span> <span style="color: #000;">2</span>   <span style="color: #d00; font-style: italic;">#対数スケール</span>
graph<span style="color: #000;">[</span><span style="color: #000;">0</span><span style="color: #000;">]</span>.<span style="color: #000;">set_xlim</span><span style="color: #000;">(</span>begin<span style="color: #000;">=</span><span style="color: #000;">0</span><span style="color: #000;">,</span> end<span style="color: #000;">=</span><span style="color: #000;">5000</span><span style="color: #000;">,</span> step<span style="color: #000;">=</span><span style="color: #000;">1000</span><span style="color: #000;">)</span>
graph<span style="color: #000;">[</span><span style="color: #000;">0</span><span style="color: #000;">]</span>.<span style="color: #000;">set_ylim</span><span style="color: #000;">(</span><span style="color: #000;">1e-7</span><span style="color: #000;">,</span> <span style="color: #000;">1e2</span><span style="color: #000;">,</span> <span style="color: #000;">2</span><span style="color: #000;">)</span> <span style="color: #d00; font-style: italic;">#対数スケールのstep=2</span>
graph<span style="color: #000;">[</span><span style="color: #000;">0</span><span style="color: #000;">]</span>.<span style="color: #000;">label</span><span style="color: #000;">(</span><span style="color: #0a0;">&apos;legend&apos;</span><span style="color: #000;">)</span>.<span style="color: #000;">remove</span><span style="color: #000;">(</span><span style="color: #000;">)</span>
graph.<span style="color: #000;">set_int</span><span style="color: #000;">(</span><span style="color: #0a0;">&apos;aa&apos;</span><span style="color: #000;">,</span> <span style="color: #000;">1</span><span style="color: #000;">)</span><span style="color: #d00; font-style: italic;">#LTではpage.aa、アンチエイリアス -&gt; On</span>

plot <span style="color: #000;">=</span> graph<span style="color: #000;">[</span><span style="color: #000;">0</span><span style="color: #000;">]</span>.<span style="color: #000;">add_plot</span><span style="color: #000;">(</span>wks<span style="color: #000;">,</span> coly<span style="color: #000;">=</span><span style="color: #000;">1</span><span style="color: #000;">,</span> colx<span style="color: #000;">=</span><span style="color: #000;">0</span><span style="color: #000;">,</span> <span style="color: #900090;">type</span><span style="color: #000;">=</span><span style="color: #0a0;">&apos;line&apos;</span><span style="color: #000;">)</span>
plot.<span style="color: #000;">color</span> <span style="color: #000;">=</span> <span style="color: #0a0;">&apos;#167BB2&apos;</span></pre>
<h2><a name="Project"></a><span class="mw-headline">プロジェクト</span></h2>
<h3><a name="Export_Graphs_as_Images_from_Sample_Projects"></a><span class="mw-headline">サンプルプロジェクトのグラフを画像としてエクスポート</span></h3>
<p>サンプルプロジェクトのグラフから画像を作成します。このサンプルを実行すると、<b>my_py_test.png</b>という名前のファイルが置き換えられることに注意してください。
</p><p><b>save_fig</b>についての詳細は、<a class="external text" href="https://www.originlab.com/python/doc/originpro/classoriginpro_1_1graph_1_1_g_layer.html" target="_blank">graph.py</a>を参照してください。
</p>
<pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">import</span> originpro <span style="color: #ff7700;font-weight:bold;">as</span> op
<span style="color: #d00; font-style: italic;">#ラーニングセンターフォルダから</span>
op.<span style="color: #900090;">open</span><span style="color: #000;">(</span>op.<span style="color: #000;">path</span><span style="color: #000;">(</span><span style="color: #0a0;">&apos;c&apos;</span><span style="color: #000;">)</span>+ r<span style="color: #0a0;">&apos;<span style="color: #000099; font-weight: bold;">\G</span>raphing<span style="color: #000099; font-weight: bold;">\T</span>rellis Plots - Box Charts.opju&apos;</span><span style="color: #000;">)</span>
gg<span style="color: #000;">=</span>op.<span style="color: #000;">find_graph</span><span style="color: #000;">(</span><span style="color: #000;">0</span><span style="color: #000;">)</span>
f<span style="color: #000;">=</span><span style="color: #0a0;">&apos;&apos;</span>
<span style="color: #ff7700;font-weight:bold;">if</span> gg:
    f<span style="color: #000;">=</span>gg.<span style="color: #000;">save_fig</span><span style="color: #000;">(</span>op.<span style="color: #000;">path</span><span style="color: #000;">(</span><span style="color: #000;">)</span>+<span style="color: #0a0;">&apos;my_py_test.png&apos;</span><span style="color: #000;">,</span>width<span style="color: #000;">=</span><span style="color: #000;">500</span><span style="color: #000;">)</span>

<span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #000;">os</span>
<span style="color: #ff7700;font-weight:bold;">if</span> <span style="color: #900090;">len</span><span style="color: #000;">(</span>f<span style="color: #000;">)</span>:
    <span style="color: #000;">os</span>.<span style="color: #000;">startfile</span><span style="color: #000;">(</span>f<span style="color: #000;">)</span></pre>
<h3><a name="Extract_Image_Colors"></a><span class="mw-headline">画像の色を抽出</span></h3>
<p>出版物のグラフといった画像からすべての色を取得します。各色のRGB値がワークシートに出力されます。この例では、Pythonパッケージの<b>extcolors</b>を事前にインストールする必要があります。 
</p>
<pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">import</span> extcolors
<span style="color: #ff7700;font-weight:bold;">import</span> numpy <span style="color: #ff7700;font-weight:bold;">as</span> np
<span style="color: #ff7700;font-weight:bold;">import</span> originpro <span style="color: #ff7700;font-weight:bold;">as</span> op

file_path <span style="color: #000;">=</span> op.<span style="color: #000;">file_dialog</span><span style="color: #000;">(</span><span style="color: #0a0;">&apos;*.png;*.jpg;*.bmp&apos;</span><span style="color: #000;">,</span><span style="color: #0a0;">&apos;Select an Image&apos;</span><span style="color: #000;">)</span>
<span style="color: #ff7700;font-weight:bold;">if</span> <span style="color: #900090;">len</span><span style="color: #000;">(</span>file_path<span style="color: #000;">)</span> <span style="color: #000;">==</span><span style="color: #000;">0</span>:
    <span style="color: #ff7700;font-weight:bold;">raise</span> <span style="color: #900090;">ValueError</span><span style="color: #000;">(</span><span style="color: #0a0;">&apos;user cancel&apos;</span><span style="color: #000;">)</span>
    
colors<span style="color: #000;">,</span> pixel_count <span style="color: #000;">=</span> extcolors.<span style="color: #000;">extract_from_path</span><span style="color: #000;">(</span>file_path<span style="color: #000;">)</span>

colors <span style="color: #000;">=</span> np.<span style="color: #000;">array</span><span style="color: #000;">(</span>colors<span style="color: #000;">)</span>
<span style="color: #d00; font-style: italic;">#rgb = colors[:,0]</span>
rgb<span style="color: #000;">,</span>pixel <span style="color: #000;">=</span> <span style="color: #900090;">map</span><span style="color: #000;">(</span><span style="color: #900090;">list</span><span style="color: #000;">,</span> <span style="color: #900090;">zip</span><span style="color: #000;">(</span>*colors<span style="color: #000;">)</span><span style="color: #000;">)</span>
<span style="color: #d00; font-style: italic;">#print(rgb)</span>
r <span style="color: #000;">=</span> <span style="color: #000;">[</span><span style="color: #000;">]</span>
g <span style="color: #000;">=</span> <span style="color: #000;">[</span><span style="color: #000;">]</span>
b <span style="color: #000;">=</span> <span style="color: #000;">[</span><span style="color: #000;">]</span>
<span style="color: #ff7700;font-weight:bold;">for</span> row <span style="color: #ff7700;font-weight:bold;">in</span> rgb:
    r.<span style="color: #000;">append</span><span style="color: #000;">(</span>row<span style="color: #000;">[</span><span style="color: #000;">0</span><span style="color: #000;">]</span><span style="color: #000;">)</span>
    g.<span style="color: #000;">append</span><span style="color: #000;">(</span>row<span style="color: #000;">[</span><span style="color: #000;">1</span><span style="color: #000;">]</span><span style="color: #000;">)</span>
    b.<span style="color: #000;">append</span><span style="color: #000;">(</span>row<span style="color: #000;">[</span><span style="color: #000;">2</span><span style="color: #000;">]</span><span style="color: #000;">)</span>
<span style="color: #d00; font-style: italic;">#色を出力</span>
wks <span style="color: #000;">=</span> op.<span style="color: #000;">new_sheet</span><span style="color: #000;">(</span><span style="color: #000;">)</span>
wks.<span style="color: #000;">from_list</span><span style="color: #000;">(</span><span style="color: #000;">0</span><span style="color: #000;">,</span> r<span style="color: #000;">)</span>
wks.<span style="color: #000;">from_list</span><span style="color: #000;">(</span><span style="color: #000;">1</span><span style="color: #000;">,</span> g<span style="color: #000;">)</span>
wks.<span style="color: #000;">from_list</span><span style="color: #000;">(</span><span style="color: #000;">2</span><span style="color: #000;">,</span> b<span style="color: #000;">)</span></pre>
<p><br />
</p><p><b>関連情報：</b>
</p>
<ul><li> <a href="../../Python/Python/Sample_Projects_with_Attached_Python_Codes.html" title="Python:Pythonコードが添付されたサンプルプロジェクト"> Pythonコードが添付されたサンプルプロジェクト</a></li></ul>
<ul><li> <a class="external text" href="https://www.originlab.com/python/doc/originpro/annotated.html" target="_blank">Python originproリファレンス</a></li></ul>







    