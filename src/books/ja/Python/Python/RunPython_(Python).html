<h1 class="firstheading">組み込みPython</h1><p class='urlname' style='display: none'>Run-Python-in-Origin</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Running_Python_Inside_Origin"><span class="tocnumber">1</span> <span class="toctext">OriginでPythonを実行</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Run_Python_Command_in_Console"><span class="tocnumber">2</span> <span class="toctext">コンソールでPythonコマンドを実行</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Hello_World_Example"><span class="tocnumber">3</span> <span class="toctext">Hello World のサンプル</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Where_to_go_from_here.3F"><span class="tocnumber">4</span> <span class="toctext">これから行うこと</span></a></li>
</ul>
</div>

<h2><a name="Running_Python_Inside_Origin"></a><span class="mw-headline">OriginでPythonを実行</span></h2>
<p>Originをインストールすると、Pythonも同時にインストールされます。インストールされたものは<b>組み込みPython</b>と呼ばれ、Originの外部にインストールしたPythonのバージョンとは無関係です。組み込みPythonの現在のバージョンは、<b>3.8.3</b>です。 
</p><p>ワークシート、行列シート、グラフなどのOriginオブジェクトを操作するための、<a class="external text" href="https://www.originlab.com/python/doc/originpro/annotated.html" target="_blank">originpro</a>パッケージも事前インストールされるため、すぐに組み込みPythonから使用できるようになっています。現在のoriginproパッケージのバージョンは、<b>1.0.6</b>です。
</p><p>Originの内部でPythonコードにアクセスする方法はいくつかあります。以下の2つのセクションで簡単なサンプルを紹介します。
</p>
<h2><a name="Run_Python_Command_in_Console"></a><span class="mw-headline">コンソールでPythonコマンドを実行</span></h2>
<p>OriginのPythonコンソールで、Pythonコマンドを直接実行できます。数行のコードを実行する場合に便利な方法です。
</p>
<ol><li> メニューの<b>接続: Pythonコンソール...</b>を選択します。</li>
<li> 以下より一行ごとにコピーして貼り付けた後、Enterキーを押して実行します。</li></ol>
<pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">import</span> originpro <span style="color: #ff7700;font-weight:bold;">as</span> op</pre>
<pre class="python" style="font-family:monospace;">wks<span style="color: #000;">=</span>op.<span style="color: #000;">new_sheet</span><span style="color: #000;">(</span><span style="color: #000;">)</span></pre>
<pre class="python" style="font-family:monospace;">f<span style="color: #000;">=</span>op.<span style="color: #000;">path</span><span style="color: #000;">(</span><span style="color: #0a0;">&apos;e&apos;</span><span style="color: #000;">)</span>+r<span style="color: #0a0;">&apos;Samples<span style="color: #000099; font-weight: bold;">\C</span>urve Fitting<span style="color: #000099; font-weight: bold;">\E</span>nzyme.dat&apos;</span></pre>
<pre class="python" style="font-family:monospace;">wks.<span style="color: #000;">from_file</span><span style="color: #000;">(</span>f<span style="color: #000;">)</span></pre>
<p><br />
OriginのPython環境をリセットするには
</p>
<ol><li> <b>ウィンドウ: スクリプトウィンドウ</b>を選択して以下のコマンドを実行します。</li></ol>
<pre class="lt" style="font-family:monospace;">run <span style="color: #000080;">-</span>pyr;</pre>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/RunPython_(Python)/Tip_icon.png" width="57"  border="0" /></td><td><p><b>Origin 2021b</b>以降、インテリセンス（自動補完）はデフォルトで有効になっています。<a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#N"><b>@NPYC</b></a> = <i>0</i>を設定することにより、インテリセンスを無効にできます。システム変数の値を変更する方法については、<a class="external text" href="../../QuickHelp/QuickHelp/How_do_I_permanently_change_the_value_of_a_system_variable.html">FAQ-708 システム変数を永続的に変更するには</a>にあるシステム変数の変更を参照してください。
</p></td></tr></table>
<h2><a name="Hello_World_Example"></a><span class="mw-headline">Hello World のサンプル</span></h2>
<p>Pythonコードは、外部ファイル、Originプロジェクトに添付されたファイル、列値の設定ダイアログに含まれるファイル、グラフまたはワークシートウィンドウのテキストオブジェクトに保存されたファイルといった、さまざまな場所に保存でき、アクセスできます。
</p><p>この簡単なサンプルでは、.pyファイルにPythonコードを保存し、Originのスクリプトウィンドウから実行します。
</p>
<ol>
<li> Originのメニューから<b>接続：untitled.pyを開く</b>を選びます。</li></b>
<li> 右側のuntitiled.pyという名前のタブ内に、以下のコードを入力します。
<pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">print</span> <span style="color: #000;">(</span><span style="color: #0a0;">&quot;Hello World!&quot;</span><span style="color: #000;">)</span></pre>
<li> <b>ファイル：名前を付けて保存</b>を選択し、ファイル名に<i>Hello</i> と入力してファイルを保存します。
<li> Originに戻り、メニューから<b>ウィンドウ：スクリプトウィンドウ</b>を選択します。
<li> スクリプトウィンドウに、以下のコマンドを入力し、Enterキーを押して実行します。
<pre class="lt" style="font-family:monospace;">run <span style="color: #000080;">-</span>pyf <span style="color: #ff00ff;">&quot;Hello.py&quot;</span></pre>
</ol>
<p>スクリプトウィンドウに、&quot;Hello World!&quot;というメッセージが返されます（詳細は<a class="external text" href="../../LabTalk/LabTalk/Run_(command).html#-pyf.3B_Execute_Python_File"><b>run -pyf</b></a>を参照）。
</p>
<h2><a name="Where_to_go_from_here.3F"></a><span class="mw-headline">これから行うこと</span></h2>
<p>Originの組み込みPythonの使用方法は、以下のページをご参照ください。
</p>
<ul><li> <a href="../../Python/Python/Python_Packages.html" title="Python:Pythonパッケージ">Pythonパッケージのインストールと管理</a></li></ul>
<ul><li> <a href="../../Python/Python/Running_Python_Code.html" title="Python:Pythonコードを実行">Pythonコードを実行</a></li></ul>
<ul><li> <a href="../../Python/Category/Using_Python_In_Tools_And_Dialogs_(Python).html" title="カテゴリ:ツールとダイアログでのPythonの使用(Python)">ツールとダイアログでのPythonの使用</a></li></ul>
<ul><li> <a href="../../Python/Category/Python_Code_Samples_(Python).html" title="カテゴリ:Pythonコードのサンプル (Python)">Pythonコードのサンプル</a></li></ul>
<ul><li> <a href="../../Python/Python/Sample_Projects_with_Attached_Python_Codes.html" title="Python:Pythonコードが添付されたサンプルプロジェクト"> Pythonコードが添付されたサンプルプロジェクト</a></li></ul>
<ul><li> <a class="external text" href="https://www.originlab.com/python/doc/originpro/annotated.html" target="_blank">originproパッケージのリファレンス</a></li></ul>
<ul><li> <a class="external text" href="http://blog.originlab.com/category/programming-python" target="_blank">関連するブログ</a></li></ul>



    