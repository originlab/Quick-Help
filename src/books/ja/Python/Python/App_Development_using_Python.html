<h1 class="firstheading">Pythonを使ったアプリ開発</h1><div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Call_Python_Function_in_App"><span class="tocnumber">1</span> <span class="toctext">アプリでPython関数を呼び出す</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Install_Python_Packages_During_App_Installation"><span class="tocnumber">2</span> <span class="toctext">アプリインストール中にPythonパッケージをインストール</span></a></li>
</ul>
</div>
<h2><a name="Call_Python_Function_in_App"></a><span class="mw-headline">アプリでPython関数を呼び出す</span></h2>
<p>Originでアプリを作成するための基本的な操作は、<a href="App.chm::/App/Introduction.html" title="App:イントロダクション">こちらのページ</a>を参照してください。
</p><p>Origin 2021以降、<a href="../../Python/Python/Calling_Python_Functions_from_OriginC.html" title="Python:Origin Cから Python関数を呼び出す">Origin C</a>または<a href="../../Python/Python/Calling_Python_Functions_from_LabTalk_and_Column_Formula.html" title="Python:列の式およびLabTalkからPython関数を呼び出す">LabTalkスクリプト</a>からPython関数を直接呼び出すことができます。 
</p><p>アプリ内で、Origin CコードからPython関数を呼び出す場合、<b>origin.py</b>ファイルをアプリフォルダに置きます。そして、以下のシンタックスを使ってPython関数を呼び出します。
</p>
<pre class="oc" style="font-family:monospace;">Python.<span style="color: #000000;">function_name</span><span style="color: #000000;">(</span>arg1, arg2...<span style="color: #000000;">)</span></pre>
<p>または複数の変数を返すためには、
</p>
<pre class="oc" style="font-family:monospace;">Python.<span style="color: #000000;">function_name</span><span style="color: #000000;">(</span>arg1, arg2..., <span style="color: #000040;">&amp;</span> ret1, <span style="color: #000040;">&amp;</span> ret2...<span style="color: #000000;">)</span></pre>
<p>ここで、<b>function_name</b>は、<b>origin.py</b>で定義されている関数の名前です。
</p><p>アプリ内でLabTalkスクリプトからPython関数を呼び出す場合は、.pyファイルをアプリフォルダに置きます。そして、以下のシンタックスを使ってPython関数を呼び出します。
</p>
<pre class="lt" style="font-family:monospace;">Python.<span style="color: #000080;">LTwd</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #000080;">%</span>@ATestApp\;
Python.<span style="color: #000080;">LTwf</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>myfunc.<span style="color: #000080;">py</span>;
py.<span style="color: #000080;">function_name</span><span style="color: #000000;">(</span>arg1, arg2...<span style="color: #000000;">)</span></pre>
<p>複数の変数を返すためには、
</p>
<pre class="lt" style="font-family:monospace;">Python.<span style="color: #000080;">LTwd</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #000080;">%</span>@ATestApp\;
Python.<span style="color: #000080;">LTwf</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>myfunc.<span style="color: #000080;">py</span>;
<span style="color: #000000;">(</span>ret1, ret2...<span style="color: #000000;">)</span><span style="color: #000080;">=</span> py.<span style="color: #000080;">function_name</span><span style="color: #000000;">(</span>arg1, arg2...<span style="color: #000000;">)</span></pre>
<p>ここで、<b>myfunc</b>は.pyファイル名で、<b>function_name</b> は<b>myfunc.py</b>で定義されている関数の名前です。
</p>
<h2><a name="Install_Python_Packages_During_App_Installation"></a><span class="mw-headline">アプリインストール中にPythonパッケージをインストール</span></h2>
<p>.pyファイルで使用するためのPythonモジュールがある場合、Originアプリのインストール中に、必要なモジュールを確認してインストールする機能が必要になります。これは、<a href="App.chm::/App/Introduction.html#Packaging_and_Installing_an_App_for_the_First_Time" title="App:イントロダクション">パッケージマネージャ</a>ダイアログで可能です。LabTalkスクリプト：インストール前の項目で、以下のようにLabTalkコマンド行を入力するだけで、アプリがインストールされる前に、指定したモジュールを確認して、ない場合はインストールします。
</p>
<pre class="oc" style="font-family:monospace;"> <span style="color: #0000ff;">if</span> <span style="color: #000000;">(</span>Python.<span style="color: #000000;">chk</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;sklearn&quot;</span><span style="color: #000000;">)</span> <span style="color: #000080;">&gt;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span> <span style="color: #000000;">{</span>type <span style="color: #000040;">-</span>b <span style="color: #ff00ff;">&quot;The required Python module is not installed properly&quot;</span>; <span style="color: #0000ff;">break</span> <span style="color: #0000dd;">1</span>;<span style="color: #000000;">}</span>;</pre>
<p><a  class="image"><img alt="CheckPackageInstall1.png" src="../images/App_Development_using_Python/CheckPackageInstall1.png" width="747"  /></a>
</p>



    