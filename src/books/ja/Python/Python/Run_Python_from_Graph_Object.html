<h1 class="firstheading">グラフィックオブジェクトからPythonを実行</h1>
<p><br />
Pythonコードは、グラフ、ワークシート、行列にあるグラフィックオブジェクトに保存できます。オブジェクトの裏で<a class="external text" href="https://www.originlab.com/doc/LabTalk/guide/From-Graphical-objs" target="_blank">LabTalkスクリプト</a>を実行するのと同じように、オブジェクトの特定のイベントがトリガーされると、コードが実行されます。</p>
<table class="noborder">
<tr>
<td style="vertical-align:top" width="60"><img src="../images/Run_Python_from_Graph_Object/Tip_icon.png" width="57" border="0" alt="" /></td>
<td>
<p>スクリプトをPythonとして認識させるために、#、''' (シングルクォーテーション3つ)、""" (ダブルクォーテーション3つ)、importのいずれかでスクリプトを始める必要があります。</p>
</td>
</tr>
</table>
<h2><a name="Run_Python_Script_From_a_Text_Object" id="Run_Python_Script_From_a_Text_Object"></a><span class="mw-headline">テキストオブジェクトからPythonスクリプトを実行する</span></h2>
<ol>
<li>新しいワークブックを作成します。</li>
<li>プロジェクトウィンドウの左側にある<b>プロット操作・オブジェクト作成</b>ツールバーより、<b>テキスト</b>ツール<a class="image"><img alt="Button Text Tool.png" src="../images/Run_Python_from_Graph_Object/Button_Text_Tool.png" width="23" /></a>を選択します。</li>
<li>ワークシートの空いているスペース（最後の列の右側にある灰色の領域）をクリックします。テキストオブジェクトに「Run」と入力し、オブジェクトの外側をクリックします。これで、ボタンのラベルが作成されました。</li>
<li>Altキーを押しながら、作成したテキストオブジェクトをダブルクリックします。 オブジェクトダイアログが開き、<b>プログラミング</b>タブが表示されます。</li>
<li>下のテキストボックスに以下のスクリプトを入力します。
<pre class="python" style="font-family:monospace;">
<span style="color: #ff7700;font-weight:bold;">import</span> pandas <span style="color: #ff7700;font-weight:bold;">as</span> pd
<span style="color: #ff7700;font-weight:bold;">import</span> originpro <span style="color: #ff7700;font-weight:bold;">as</span> op
data <span style="color: #000;">=</span> <span style="color: #000;">{</span><span style="color: #0a0;">'Name'</span>:<span style="color: #000;">[</span><span style="color: #0a0;">'Tom'</span><span style="color: #000;">,</span> <span style="color: #0a0;">'Jack'</span><span style="color: #000;">,</span> <span style="color: #0a0;">'Mike'</span><span style="color: #000;">,</span> <span style="color: #0a0;">'Alice'</span><span style="color: #000;">]</span><span style="color: #000;">,</span>
        <span style="color: #0a0;">'Grade'</span>:<span style="color: #000;">[</span><span style="color: #000;">99</span><span style="color: #000;">,</span> <span style="color: #000;">98</span><span style="color: #000;">,</span> <span style="color: #000;">95</span><span style="color: #000;">,</span> <span style="color: #000;">90</span><span style="color: #000;">]</span><span style="color: #000;">}</span>
df <span style="color: #000;">=</span> pd.<span style="color: #000;">DataFrame</span><span style="color: #000;">(</span>data<span style="color: #000;">)</span>
wks <span style="color: #000;">=</span> op.<span style="color: #000;">find_sheet</span><span style="color: #000;">(</span><span style="color: #000;">)</span>
wks.<span style="color: #000;">from_df</span><span style="color: #000;">(</span>df<span style="color: #000;">)</span>
</pre></li>
<li><b>のあとでスクリプトを実行</b>ドロップダウンリストから、<b>ボタンアップ</b>を選択し、<b>OK</b>をクリックします。</li>
<li>ボタンを押し、データをワークシートにインポートします。
<p><a class="image"><img alt="Python Button.png" src="../images/Run_Python_from_Graph_Object/300px-Python_Button.png" width="396" /></a></p>
</li>
</ol>
