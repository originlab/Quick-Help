<h1 class="firstheading">Pythonコードを実行</h1><p class='urlname' style='display: none'>Running_Python_Code</p>
<p>以下のセクションでは、OriginでPythonコードを保存および実行する様々な方法を紹介します。
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#From_Python_Console"><span class="tocnumber">1</span> <span class="toctext">Pythonコンソールから</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#From_Code_Builder"><span class="tocnumber">2</span> <span class="toctext">コードビルダから</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#From_External_.py_File"><span class="tocnumber">3</span> <span class="toctext">外部の .py ファイルから</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#From_.py_File_Attached_to_Project"><span class="tocnumber">4</span> <span class="toctext">プロジェクトに添付された .py ファイルから</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#From_Text_Object"><span class="tocnumber">5</span> <span class="toctext">テキストオブジェクトから</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Calling_Python_Functions"><span class="tocnumber">6</span> <span class="toctext">Python関数を呼び出す</span></a></li>
</ul>
</div>

<h2><a name="From_Python_Console"></a><span class="mw-headline">Pythonコンソールから</span></h2>
<p><a href="../../Python/Python/RunPython_(Python).html#Run_Python_Command_in_Console" title="Python:RunPython (Python)">実行するPythonコードが数行しかない場合</a>、Pythonコンソールが便利です。コンソールではインテリセンスがサポートされているため、originproパッケージで利用可能なオブジェクトとメソッドを調べるのに役立ちます。
</p><p>Originの<b>接続：Pythonコンソール...</b>メニューを選択して、Pythonコンソールウィンドウを開きます。
</p><p><a  class="image"><img alt="PythonConsoleIntens1.png" src="../images/Running_Python_Code/700px-PythonConsoleIntens1.png" width="700"   /></a>
</p>
<h2><a name="From_Code_Builder"></a><span class="mw-headline">コードビルダから</span></h2>
<p><b>コードビルダ</b>を使ってPythonコードを開発できます。コードビルダでは、コードの強調表示、インテリセンス、デバッグがサポートされています。
</p><p><a  class="image"><img alt="CodeBuilder Python.png" src="../images/Running_Python_Code/700px-CodeBuilder_Python.png" width="700"   /></a>
</p><p>Originの<b>接続：utitled.pyを開く...</b>メニューを選択して、コードビルダを開きます。コードを編集したら、F5キーを押してコードを実行できます。実行する前にコードをファイルに保存する必要もありません。コードビルダのツールメニューには、Pythonのために用意された次の3つのメニュー項目があります。
</p>
<ul><li><b>Pythonパッケージ</b>: パッケージのインストール、アップデート、アンインストール</li>
<li><b>インテリセンス</b>: インテリセンスを有効/無効にする</li>
<li><b>Pythonコンパイルファイルをクリア</b>: ユーザファイルフォルダのPYCファイルをクリア/削除</li></ul>
<p><br />
</p>
<h2><a name="From_External_.py_File"></a><span class="mw-headline">外部の .py ファイルから</span></h2>
<p><b>.py</b>ファイルに保存したコードは、スクリプトウィンドウなどのLabTalkスクリプトを実行可能なOrigin内のどこからでも、<a class="external text" href="../../LabTalk/LabTalk/Run_(command).html">Runコマンド</a>を使って実行できます。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// ユーザファイルフォルダに保存されたtest.pyファイルのコードを実行</span>
run <span style="color: #000080;">-</span>pyf test.<span style="color: #000080;">py</span>;

<span style="color: #008000;">// 指定したフォルダに保存されたファイルのコードを実行</span>
string str<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;C:\temp\test.py&quot;</span>;
run <span style="color: #000080;">-</span>pyf <span style="color: #000080;">%</span><span style="color: #000000;">(</span>str<span style="color: #000080;">$</span><span style="color: #000000;">)</span>;</pre>
<p><br />
LabTalkスクリプトからPythonコードに変数を渡すことができます。次のように操作してみましょう。
</p>
<ol>
<li>Originのメニューから<b>接続 &gt; untitled.pyを開く...</b>を選択します。
<li>コードビルダの右側に<b>untitled.py</b>タブが開きます。以下のPythonコードを貼り付けます。
<pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #000;">sys</span>
<span style="color: #ff7700;font-weight:bold;">if</span> __name__ <span style="color: #000;">==</span> <span style="color: #0a0;">&apos;__main__&apos;</span>:
    <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: #000;">(</span><span style="color: #900090;">len</span><span style="color: #000;">(</span><span style="color: #000;">sys</span>.<span style="color: #000;">argv</span><span style="color: #000;">)</span><span style="color: #000;">)</span>
    <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: #000;">(</span><span style="color: #000;">sys</span>.<span style="color: #000;">argv</span><span style="color: #000;">[</span><span style="color: #000;">1</span><span style="color: #000;">]</span><span style="color: #000;">)</span>
    <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: #000;">(</span><span style="color: #000;">sys</span>.<span style="color: #000;">argv</span><span style="color: #000;">[</span><span style="color: #000;">2</span><span style="color: #000;">]</span><span style="color: #000;">)</span></pre>
<li>コードビルダの<b>ファイル：名前を付けて保存</b>を選択して、デフォルトのフォルダ（ユーザファイルフォルダ）に<b>test.py</b>という名前で保存します。
<li>Originに戻り、メインメニューの<b>ウィンドウ：スクリプトウィンドウ</b>を選択してスクリプトウィンドウを開きます。そして、以下のLabTalkスクリプト行を貼り付けます。
<pre class="lt" style="font-family:monospace;">double var1 <span style="color: #000080;">=</span> <span style="color: #0000dd;">123.456</span>;
string var2<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&apos;hello&apos;</span>;
run <span style="color: #000080;">-</span>pyf test.<span style="color: #000080;">py</span> <span style="color: #ff00ff;">&quot;$(var1)&quot;</span> <span style="color: #ff00ff;">&quot;%(var2$)&quot;</span>;</pre>
<li>マウスでドラッグして、スクリプトコードの3行とも選択し、Enterキーを押して実行します。
<li>出力として以下が表示されるはずです。
<pre class="lt" style="font-family:monospace;"><span style="color: #0000dd;">3</span>
<span style="color: #0000dd;">123.456</span>
<span style="color: #ff00ff;">&apos;hello&apos;</span></pre>
</ol>
<h2><a name="From_.py_File_Attached_to_Project"></a><span class="mw-headline">プロジェクトに添付された .py ファイルから</span></h2>
<p>Pythonコードを含む<b>.py</b>ファイルは、Originプロジェクトに添付できます。添付すると、以下のスクリプトコマンドを使ってコードを実行できます。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// プロジェクトに添付されたtest.pyファイルのPythonコードを実行</span>
run <span style="color: #000080;">-</span>pyp test.<span style="color: #000080;">py</span>;
<span style="color: #008000;">// 拡張子.pyは省略可</span>
run <span style="color: #000080;">-</span>pyp test;</pre>
<p><br />
ファイルを作成してプロジェクトに添付するには、以下のように操作します。
</p>
<ol>
<li>コードビルダでPythonコードを編集して、ファイル名を付けて保存します。
<li>コードビルダメニューの、<b>ファイル：ワークスペースに追加</b>を選択します。すると左パネルのワークスペースツリーの<b>User</b>の位置に表示されます。
<li>ワークスペースツリーのUserの項目から<b>Project</b>にファイルをドラッグ&amp;ドロップで移動します。
<li> これでファイルがプロジェクトに添付されます。 
<li> プロジェクトの項目にあるこのエントリをダブルクリックして、右側の新しいタブにコードを開けば編集可能です。
<li> Originに戻り、プロジェクトを保存します。これでコードファイルはプロジェクトに添付され、Origin内のLabTalkスクリプトがサポートされている場所ならどこからでもコードを実行できます。
</ol>
<h2><a name="From_Text_Object"></a><span class="mw-headline">テキストオブジェクトから</span></h2>
<p>Pythonコードは、グラフ、ワークシート、行列にあるテキストオブジェクトに保存できます。このコードは、ボタンなどのほかのオブジェクトからrunコマンドを使って実行できます。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// テキストオブジェクト &apos;pycode&apos;  に保存されたPythonコードを実行</span>
run <span style="color: #000080;">-</span>pyb pycode;</pre>
<p>次のように操作してみましょう。
</p>
<ol>
<li>Originのメインメニューで、<b>ファイル：新規作成：ワークブック...</b>を選択します。
<li>開いた<b>新しいワークブック</b>ダイアログで、テンプレート名<b>Lomb-Scargle Periodogram</b>を選択し、OKボタンをクリックしてOriginにテンプレートを開きます。
<li>ALTキーを押しながら、<b>ピリオドグラムの計算</b>というボタンをダブルクリックします。<b>テキストオブジェクト</b>ダイアログの<b>プログラミング</b>タブが開き、以下のLabTalkスクリプトコードが確認できます。
<pre class="lt" style="font-family:monospace;">pip <span style="color: #000080;">-</span>check scipy pandas;
run <span style="color: #000080;">-</span>pyb pycode;</pre>
<li>最初の行では<a class="external text" href="../../LabTalk/LabTalk/Pip_(command).html">LabTalkのpipコマンド</a>を使って、このサンプルに必要なパッケージである、scipyとpandasの有無を確認してインストールします。2行目では、<b>pycode</b>という名前のテキストラベルに保存されているPythonコードを呼び出します。ダイアログを閉じます。
<li>次に、<b>Pythonコード</b>ボタンを右クリックして、ショートカットメニューから<b>プロパティ</b>を選択します。 
<li><b>テキストオブジェクト</b>ダイアログで、<b>プログラミング</b>タブを開きます。名前が<b>pycode</b>に設定されており、先ほどのボタンに設定されたスクリプトが参照するオブジェクトであることがわかります。編集ボックスでには、Pythonコードが入力されていることがわかります。ダイアログを閉じます。
<li>ワークシートの<b>ピリオドグラムの計算</b>ボタンをクリックします。Pythonコードが実行されて、ワークシートのC、D列に結果が出力され、グラフも更新されて曲線が表示されます。
</ol>
<h2><a name="Calling_Python_Functions"></a><span class="mw-headline">Python関数を呼び出す</span></h2>
<p>Pythonコードの代わりにPython関数を定義すると、<a href="../../Python/Python/Calling_Python_Functions_from_LabTalk_and_Column_Formula.html" title="Python:列の式およびLabTalkからPython関数を呼び出す">列の式やインポートウィザード</a>、<a href="../../Python/Python/Python_Functions_NLFit.html" title="Python:Python 関数で NLFit">フィット関数</a>などのOriginの機能から呼び出すことができます。
</p>






    