<h1 class="firstheading">Graphing</h1>
<div id="toc" class="toc">
<div id="toctitle">
<h2>Contents</h2>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Control_Plots_As_Group"><span class="tocnumber">1</span> <span class="toctext">Control Plots As Group</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Graph_Legend_to_Show_Only_First_Plot"><span class="tocnumber">2</span> <span class="toctext">Graph Legend to Show Only First Plot</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Line_Plot_with_Log_Scale"><span class="tocnumber">3</span> <span class="toctext">Line Plot with Log Scale</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Multiple_Layer_Plot"><span class="tocnumber">4</span> <span class="toctext">Multiple Layer Plot</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Plot_Contour_and_3D_Surface_Graph"><span class="tocnumber">5</span> <span class="toctext">Plot Contour and 3D Surface Graph</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Plot_From_Data_Range"><span class="tocnumber">6</span> <span class="toctext">Plot From Data Range</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Plot_Heatmap_from_Matrix_Data"><span class="tocnumber">7</span> <span class="toctext">Plot Heatmap from Matrix Data</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Plot_Symbols_Indexed_by_Column_Values"><span class="tocnumber">8</span> <span class="toctext">Plot Symbols Indexed by Column Values</span></a></li>
</ul>
</div>
<p>&#160;</p>
<p>This folder contains examples of plotting and customizing graphs with Python <strong>originpro</strong> package.</p>
<p>For the graph related functions in <strong>originpro</strong>, see <a href="https://www.originlab.com/python/doc/originpro/namespaceoriginpro_1_1graph.html">Graph</a>.</p>
<br />
<br />
<h2><a name="Control_Plots_As_Group" id="Control_Plots_As_Group"></a><span class="mw-headline">Control Plots As Group</span></h2>
<pre class="python" style="font-family:monospace;">
<span style="color: #0a0;">'''
This sample plots a whole worksheet as XY plot and control plots in group
'''</span>
<span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #000;">os</span>
<span style="color: #ff7700;font-weight:bold;">import</span> originpro <span style="color: #ff7700;font-weight:bold;">as</span> op

wks <span style="color: #000;">=</span> op.<span style="color: #000;">new_sheet</span><span style="color: #000;">(</span><span style="color: #000;">)</span>
wks.<span style="color: #000;">from_file</span><span style="color: #000;">(</span><span style="color: #000;">os</span>.<span style="color: #000;">path</span>.<span style="color: #000;">join</span><span style="color: #000;">(</span>op.<span style="color: #000;">path</span><span style="color: #000;">(</span><span style="color: #0a0;">'e'</span><span style="color: #000;">)</span><span style="color: #000;">,</span> <span style="color: #0a0;">'Samples'</span><span style="color: #000;">,</span> <span style="color: #0a0;">'Graphing'</span><span style="color: #000;">,</span> <span style="color: #0a0;">'Group.dat'</span><span style="color: #000;">)</span><span style="color: #000;">)</span>
graph <span style="color: #000;">=</span> op.<span style="color: #000;">new_graph</span><span style="color: #000;">(</span>template<span style="color: #000;">=</span><span style="color: #0a0;">'scatter'</span><span style="color: #000;">)</span>
<span style="color: #000;">gl</span><span style="color: #000;">=</span>graph<span style="color: #000;">[</span><span style="color: #000;">0</span><span style="color: #000;">]</span>

<span style="color: #d00; font-style: italic;"># plot whole sheet as XY plot</span>
plot <span style="color: #000;">=</span> <span style="color: #000;">gl</span>.<span style="color: #000;">add_plot</span><span style="color: #000;">(</span>f<span style="color: #0a0;">'{wks.lt_range()}!(?,1:end)'</span><span style="color: #000;">)</span>

<span style="color: #d00; font-style: italic;"># group the plots and control plots setting in group</span>
<span style="color: #000;">gl</span>.<span style="color: #000;">group</span><span style="color: #000;">(</span><span style="color: #000;">)</span>
plot.<span style="color: #000;">colormap</span> <span style="color: #000;">=</span> <span style="color: #0a0;">'Candy'</span>
plot.<span style="color: #000;">shapelist</span> <span style="color: #000;">=</span> <span style="color: #000;">[</span><span style="color: #000;">3</span><span style="color: #000;">,</span> <span style="color: #000;">2</span><span style="color: #000;">,</span> <span style="color: #000;">1</span><span style="color: #000;">]</span>
<span style="color: #000;">gl</span>.<span style="color: #000;">rescale</span><span style="color: #000;">(</span><span style="color: #000;">)</span>

<span style="color: #d00; font-style: italic;"># Customize Legend</span>
lgnd <span style="color: #000;">=</span> <span style="color: #000;">gl</span>.<span style="color: #000;">label</span><span style="color: #000;">(</span><span style="color: #0a0;">'Legend'</span><span style="color: #000;">)</span>
lgnd.<span style="color: #000;">set_int</span><span style="color: #000;">(</span><span style="color: #0a0;">'fsize'</span><span style="color: #000;">,</span> <span style="color: #000;">22</span><span style="color: #000;">)</span>
lgnd.<span style="color: #000;">set_int</span><span style="color: #000;">(</span><span style="color: #0a0;">'left'</span><span style="color: #000;">,</span><span style="color: #000;">1400</span><span style="color: #000;">)</span>
lgnd.<span style="color: #000;">set_int</span><span style="color: #000;">(</span><span style="color: #0a0;">'top'</span><span style="color: #000;">,</span><span style="color: #000;">700</span><span style="color: #000;">)</span>
lgnd.<span style="color: #000;">set_int</span><span style="color: #000;">(</span><span style="color: #0a0;">'showframe'</span><span style="color: #000;">,</span><span style="color: #000;">0</span><span style="color: #000;">)</span>
</pre>
<h2><a name="Graph_Legend_to_Show_Only_First_Plot" id="Graph_Legend_to_Show_Only_First_Plot"></a><span class="mw-headline">Graph Legend to Show Only First Plot</span></h2>
<pre class="python" style="font-family:monospace;">
<span style="color: #0a0;">'''
This sample shows how to make a multi-layer graph and show legend only on the top layer and to show 
only legend for the first plot, while each layer has 3 plots.
'''</span>
<span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #000;">os</span>
<span style="color: #ff7700;font-weight:bold;">import</span> originpro <span style="color: #ff7700;font-weight:bold;">as</span> op

<span style="color: #d00; font-style: italic;"># Input three data files into three worksheets within one workbook</span>
wb <span style="color: #000;">=</span> op.<span style="color: #000;">new_book</span><span style="color: #000;">(</span><span style="color: #000;">)</span>
wb.<span style="color: #000;">set_int</span><span style="color: #000;">(</span><span style="color: #0a0;">'nLayers'</span><span style="color: #000;">,</span><span style="color: #000;">3</span><span style="color: #000;">)</span> <span style="color: #d00; font-style: italic;"># Set number of sheets</span>
<span style="color: #ff7700;font-weight:bold;">for</span> wks<span style="color: #000;">,</span> fn <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: #900090;">zip</span><span style="color: #000;">(</span>wb<span style="color: #000;">,</span> <span style="color: #000;">[</span><span style="color: #0a0;">'S15-125-03.dat'</span><span style="color: #000;">,</span> <span style="color: #0a0;">'S21-235-07.dat'</span><span style="color: #000;">,</span> <span style="color: #0a0;">'S32-014-04.dat'</span><span style="color: #000;">]</span><span style="color: #000;">)</span>:
    wks.<span style="color: #000;">from_file</span><span style="color: #000;">(</span><span style="color: #000;">os</span>.<span style="color: #000;">path</span>.<span style="color: #000;">join</span><span style="color: #000;">(</span>op.<span style="color: #000;">path</span><span style="color: #000;">(</span><span style="color: #0a0;">'e'</span><span style="color: #000;">)</span><span style="color: #000;">,</span> <span style="color: #0a0;">'Samples'</span><span style="color: #000;">,</span> <span style="color: #0a0;">'Import and Export'</span><span style="color: #000;">,</span> fn<span style="color: #000;">)</span><span style="color: #000;">)</span>

<span style="color: #d00; font-style: italic;"># Add data plots onto the graph</span>
gp <span style="color: #000;">=</span> op.<span style="color: #000;">new_graph</span><span style="color: #000;">(</span>template<span style="color: #000;">=</span><span style="color: #0a0;">'PAN2VERT'</span><span style="color: #000;">)</span>  <span style="color: #d00; font-style: italic;"># load Vertical 2 Panel graph template</span>

<span style="color: #d00; font-style: italic;"># Loop over layers and worksheets to add individual curve.</span>
<span style="color: #ff7700;font-weight:bold;">for</span> i<span style="color: #000;">,</span> <span style="color: #000;">gl</span> <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: #900090;">enumerate</span><span style="color: #000;">(</span>gp<span style="color: #000;">)</span>:
    <span style="color: #ff7700;font-weight:bold;">for</span> wks <span style="color: #ff7700;font-weight:bold;">in</span> wb:
        plot <span style="color: #000;">=</span> <span style="color: #000;">gl</span>.<span style="color: #000;">add_plot</span><span style="color: #000;">(</span>wks<span style="color: #000;">,</span><span style="color: #000;">1</span>+i<span style="color: #000;">)</span>
    <span style="color: #000;">gl</span>.<span style="color: #000;">group</span><span style="color: #000;">(</span><span style="color: #000;">)</span>
    <span style="color: #000;">gl</span>.<span style="color: #000;">rescale</span><span style="color: #000;">(</span><span style="color: #000;">)</span>
    
<span style="color: #d00; font-style: italic;"># Customize legend</span>
lgnd <span style="color: #000;">=</span> gp<span style="color: #000;">[</span><span style="color: #000;">1</span><span style="color: #000;">]</span>.<span style="color: #000;">label</span><span style="color: #000;">(</span><span style="color: #0a0;">'Legend'</span><span style="color: #000;">)</span>

lgnd.<span style="color: #000;">set_int</span><span style="color: #000;">(</span><span style="color: #0a0;">'left'</span><span style="color: #000;">,</span><span style="color: #000;">4900</span><span style="color: #000;">)</span>
lgnd.<span style="color: #000;">set_int</span><span style="color: #000;">(</span><span style="color: #0a0;">'top'</span><span style="color: #000;">,</span><span style="color: #000;">100</span><span style="color: #000;">)</span>
<span style="color: #d00; font-style: italic;">#must have something different from internal "\l(1) %(1)" to prevent auto expending</span>
<span style="color: #d00; font-style: italic;">#so I just added a space, but you can add a caption or whatever as long as it is </span>
<span style="color: #d00; font-style: italic;">#different from the generic internal form</span>
lgnd.<span style="color: #000;">text</span><span style="color: #000;">=</span><span style="color: #0a0;">' <span style="color: #000099; font-weight: bold;">\l</span>(1) %(1)'</span>

<span style="color: #d00; font-style: italic;">#we only need one legend, so the one in layer1 will not be needed</span>
gp<span style="color: #000;">[</span><span style="color: #000;">0</span><span style="color: #000;">]</span>.<span style="color: #000;">label</span><span style="color: #000;">(</span><span style="color: #0a0;">'Legend'</span><span style="color: #000;">)</span>.<span style="color: #000;">remove</span><span style="color: #000;">(</span><span style="color: #000;">)</span>
</pre>
<h2><a name="Line_Plot_with_Log_Scale" id="Line_Plot_with_Log_Scale"></a><span class="mw-headline">Line Plot with Log Scale</span></h2>
<pre class="python" style="font-family:monospace;">
<span style="color: #0a0;">'''
This sample creates a sample signal and uses this package to create a periodogram power spectral density plot.
This example requires certain Python packages. To check for and install if needed, 
open the Script Window (Shift+Alt+3), type the following and press Enter:
    pip -chk scipy numpy
'''</span>
<span style="color: #ff7700;font-weight:bold;">import</span> numpy <span style="color: #ff7700;font-weight:bold;">as</span> np
<span style="color: #ff7700;font-weight:bold;">from</span> scipy <span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #000;">signal</span>
<span style="color: #ff7700;font-weight:bold;">import</span> originpro <span style="color: #ff7700;font-weight:bold;">as</span> op

<span style="color: #d00; font-style: italic;"># periodogram power spectral density</span>
fs <span style="color: #000;">=</span> <span style="color: #000;">10e3</span>
N <span style="color: #000;">=</span> <span style="color: #000;">1e5</span>
amp <span style="color: #000;">=</span> <span style="color: #000;">2</span>*np.<span style="color: #000;">sqrt</span><span style="color: #000;">(</span><span style="color: #000;">2</span><span style="color: #000;">)</span>
freq <span style="color: #000;">=</span> <span style="color: #000;">1234.0</span>
noise_power <span style="color: #000;">=</span> <span style="color: #000;">0.001</span> * fs / <span style="color: #000;">2</span>
<span style="color: #000;">time</span> <span style="color: #000;">=</span> np.<span style="color: #000;">arange</span><span style="color: #000;">(</span>N<span style="color: #000;">)</span> / fs
x <span style="color: #000;">=</span> amp*np.<span style="color: #000;">sin</span><span style="color: #000;">(</span><span style="color: #000;">2</span>*np.<span style="color: #000;">pi</span>*freq*<span style="color: #000;">time</span><span style="color: #000;">)</span>
x +<span style="color: #000;">=</span> np.<span style="color: #000;">random</span>.<span style="color: #000;">normal</span><span style="color: #000;">(</span>scale<span style="color: #000;">=</span>np.<span style="color: #000;">sqrt</span><span style="color: #000;">(</span>noise_power<span style="color: #000;">)</span><span style="color: #000;">,</span> size<span style="color: #000;">=</span><span style="color: #000;">time</span>.<span style="color: #000;">shape</span><span style="color: #000;">)</span>
f<span style="color: #000;">,</span> Pxx_den <span style="color: #000;">=</span> <span style="color: #000;">signal</span>.<span style="color: #000;">periodogram</span><span style="color: #000;">(</span>x<span style="color: #000;">,</span> fs<span style="color: #000;">)</span>

<span style="color: #d00; font-style: italic;"># put the data into worksheet</span>
wks <span style="color: #000;">=</span> op.<span style="color: #000;">new_sheet</span><span style="color: #000;">(</span><span style="color: #900090;">type</span><span style="color: #000;">=</span><span style="color: #0a0;">'w'</span><span style="color: #000;">,</span> lname<span style="color: #000;">=</span><span style="color: #0a0;">'Periodogram Power Spectral'</span><span style="color: #000;">)</span>
wks.<span style="color: #000;">from_list</span><span style="color: #000;">(</span><span style="color: #000;">0</span><span style="color: #000;">,</span> f<span style="color: #000;">,</span> lname<span style="color: #000;">=</span><span style="color: #0a0;">'Freq'</span><span style="color: #000;">,</span> units<span style="color: #000;">=</span><span style="color: #0a0;">'Hz'</span><span style="color: #000;">)</span>
wks.<span style="color: #000;">from_list</span><span style="color: #000;">(</span><span style="color: #000;">1</span><span style="color: #000;">,</span> Pxx_den<span style="color: #000;">,</span> lname<span style="color: #000;">=</span><span style="color: #0a0;">'PSD'</span><span style="color: #000;">,</span> units<span style="color: #000;">=</span><span style="color: #0a0;">'V<span style="color: #000099; font-weight: bold;">\+</span>(2)/Hz'</span><span style="color: #000;">)</span>

graph <span style="color: #000;">=</span> op.<span style="color: #000;">new_graph</span><span style="color: #000;">(</span>template<span style="color: #000;">=</span><span style="color: #0a0;">'line'</span><span style="color: #000;">)</span>

<span style="color: #d00; font-style: italic;">#log scale</span>
graph<span style="color: #000;">[</span><span style="color: #000;">0</span><span style="color: #000;">]</span>.<span style="color: #000;">yscale</span> <span style="color: #000;">=</span> <span style="color: #000;">2</span>   

graph<span style="color: #000;">[</span><span style="color: #000;">0</span><span style="color: #000;">]</span>.<span style="color: #000;">set_xlim</span><span style="color: #000;">(</span>begin<span style="color: #000;">=</span><span style="color: #000;">0</span><span style="color: #000;">,</span> end<span style="color: #000;">=</span><span style="color: #000;">5000</span><span style="color: #000;">,</span> step<span style="color: #000;">=</span><span style="color: #000;">1000</span><span style="color: #000;">)</span>

<span style="color: #d00; font-style: italic;">#step=2 in log</span>
graph<span style="color: #000;">[</span><span style="color: #000;">0</span><span style="color: #000;">]</span>.<span style="color: #000;">set_ylim</span><span style="color: #000;">(</span><span style="color: #000;">1e-7</span><span style="color: #000;">,</span> <span style="color: #000;">1e2</span><span style="color: #000;">,</span> <span style="color: #000;">2</span><span style="color: #000;">)</span> 

graph<span style="color: #000;">[</span><span style="color: #000;">0</span><span style="color: #000;">]</span>.<span style="color: #000;">label</span><span style="color: #000;">(</span><span style="color: #0a0;">'legend'</span><span style="color: #000;">)</span>.<span style="color: #000;">remove</span><span style="color: #000;">(</span><span style="color: #000;">)</span>

<span style="color: #d00; font-style: italic;">#page.aa in LT, anti-alias -&gt; On</span>
graph.<span style="color: #000;">set_int</span><span style="color: #000;">(</span><span style="color: #0a0;">'aa'</span><span style="color: #000;">,</span> <span style="color: #000;">1</span><span style="color: #000;">)</span>

<span style="color: #d00; font-style: italic;"># plot the data into the graph</span>
plot <span style="color: #000;">=</span> graph<span style="color: #000;">[</span><span style="color: #000;">0</span><span style="color: #000;">]</span>.<span style="color: #000;">add_plot</span><span style="color: #000;">(</span>wks<span style="color: #000;">,</span> coly<span style="color: #000;">=</span><span style="color: #000;">1</span><span style="color: #000;">,</span> colx<span style="color: #000;">=</span><span style="color: #000;">0</span><span style="color: #000;">,</span> <span style="color: #900090;">type</span><span style="color: #000;">=</span><span style="color: #0a0;">'line'</span><span style="color: #000;">)</span>
plot.<span style="color: #000;">color</span> <span style="color: #000;">=</span> <span style="color: #0a0;">'#167BB2'</span>
</pre>
<h2><a name="Multiple_Layer_Plot" id="Multiple_Layer_Plot"></a><span class="mw-headline">Multiple Layer Plot</span></h2>
<pre class="python" style="font-family:monospace;">
<span style="color: #0a0;">'''
This sample shows how to make multi-layer graph with Python 
where data on each layer is from different worksheet. Legend 
is customized to show sheet name.
'''</span>
<span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #000;">os</span>
<span style="color: #ff7700;font-weight:bold;">import</span> originpro <span style="color: #ff7700;font-weight:bold;">as</span> op

<span style="color: #d00; font-style: italic;"># Input three data files into three worksheets within one workbook</span>
wb <span style="color: #000;">=</span> op.<span style="color: #000;">new_book</span><span style="color: #000;">(</span><span style="color: #000;">)</span>
wb.<span style="color: #000;">set_int</span><span style="color: #000;">(</span><span style="color: #0a0;">'nLayers'</span><span style="color: #000;">,</span><span style="color: #000;">3</span><span style="color: #000;">)</span> <span style="color: #d00; font-style: italic;"># Set number of sheets</span>
<span style="color: #ff7700;font-weight:bold;">for</span> wks<span style="color: #000;">,</span> fn <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: #900090;">zip</span><span style="color: #000;">(</span>wb<span style="color: #000;">,</span> <span style="color: #000;">[</span><span style="color: #0a0;">'S15-125-03.dat'</span><span style="color: #000;">,</span> <span style="color: #0a0;">'S21-235-07.dat'</span><span style="color: #000;">,</span> <span style="color: #0a0;">'S32-014-04.dat'</span><span style="color: #000;">]</span><span style="color: #000;">)</span>:
    wks.<span style="color: #000;">from_file</span><span style="color: #000;">(</span><span style="color: #000;">os</span>.<span style="color: #000;">path</span>.<span style="color: #000;">join</span><span style="color: #000;">(</span>op.<span style="color: #000;">path</span><span style="color: #000;">(</span><span style="color: #0a0;">'e'</span><span style="color: #000;">)</span><span style="color: #000;">,</span> <span style="color: #0a0;">'Samples'</span><span style="color: #000;">,</span> <span style="color: #0a0;">'Import and Export'</span><span style="color: #000;">,</span> fn<span style="color: #000;">)</span><span style="color: #000;">)</span>

<span style="color: #d00; font-style: italic;"># Add data plots onto the graph</span>
gp <span style="color: #000;">=</span> op.<span style="color: #000;">new_graph</span><span style="color: #000;">(</span>template<span style="color: #000;">=</span><span style="color: #0a0;">'PAN2VERT'</span><span style="color: #000;">)</span>  <span style="color: #d00; font-style: italic;"># load Vertical 2 Panel graph template</span>

<span style="color: #d00; font-style: italic;"># Loop over layers and worksheets to add individual curve.</span>
<span style="color: #ff7700;font-weight:bold;">for</span> i<span style="color: #000;">,</span> <span style="color: #000;">gl</span> <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: #900090;">enumerate</span><span style="color: #000;">(</span>gp<span style="color: #000;">)</span>:
    <span style="color: #ff7700;font-weight:bold;">for</span> wks <span style="color: #ff7700;font-weight:bold;">in</span> wb:
        plot <span style="color: #000;">=</span> <span style="color: #000;">gl</span>.<span style="color: #000;">add_plot</span><span style="color: #000;">(</span>wks<span style="color: #000;">,</span><span style="color: #000;">1</span>+i<span style="color: #000;">)</span>
    <span style="color: #000;">gl</span>.<span style="color: #000;">group</span><span style="color: #000;">(</span><span style="color: #000;">)</span>
    <span style="color: #000;">gl</span>.<span style="color: #000;">rescale</span><span style="color: #000;">(</span><span style="color: #000;">)</span>
    
<span style="color: #d00; font-style: italic;"># Customize legend</span>
lgnd <span style="color: #000;">=</span> gp<span style="color: #000;">[</span><span style="color: #000;">1</span><span style="color: #000;">]</span>.<span style="color: #000;">label</span><span style="color: #000;">(</span><span style="color: #0a0;">'Legend'</span><span style="color: #000;">)</span>
lgnd.<span style="color: #000;">text</span><span style="color: #000;">=</span><span style="color: #0a0;">'<span style="color: #000099; font-weight: bold;">\l</span>(1) %(1, @ws)<span style="color: #000099; font-weight: bold;">\n</span><span style="color: #000099; font-weight: bold;">\l</span>(2) %(2, @ws)<span style="color: #000099; font-weight: bold;">\n</span><span style="color: #000099; font-weight: bold;">\l</span>(3) %(3, @ws)'</span>
lgnd.<span style="color: #000;">set_int</span><span style="color: #000;">(</span><span style="color: #0a0;">'left'</span><span style="color: #000;">,</span><span style="color: #000;">4900</span><span style="color: #000;">)</span>
lgnd.<span style="color: #000;">set_int</span><span style="color: #000;">(</span><span style="color: #0a0;">'top'</span><span style="color: #000;">,</span><span style="color: #000;">100</span><span style="color: #000;">)</span>

gp<span style="color: #000;">[</span><span style="color: #000;">0</span><span style="color: #000;">]</span>.<span style="color: #000;">label</span><span style="color: #000;">(</span><span style="color: #0a0;">'Legend'</span><span style="color: #000;">)</span>.<span style="color: #000;">remove</span><span style="color: #000;">(</span><span style="color: #000;">)</span>
</pre>
<h2><a name="Plot_Contour_and_3D_Surface_Graph" id="Plot_Contour_and_3D_Surface_Graph"></a><span class="mw-headline">Plot Contour and 3D Surface Graph</span></h2>
<pre class="python" style="font-family:monospace;">
<span style="color: #0a0;">'''
This sample shows how to plot contour and 3D colormap surface from XYZ data. 
The Graph template names and IDs can be found in the page:
https://www.originlab.com/doc/LabTalk/ref/Plot-Type-IDs
'''</span>
<span style="color: #ff7700;font-weight:bold;">import</span> originpro <span style="color: #ff7700;font-weight:bold;">as</span> op

<span style="color: #d00; font-style: italic;">#Import Data File</span>
wks <span style="color: #000;">=</span> op.<span style="color: #000;">new_sheet</span><span style="color: #000;">(</span><span style="color: #000;">)</span>
f <span style="color: #000;">=</span> op.<span style="color: #000;">path</span><span style="color: #000;">(</span><span style="color: #0a0;">'e'</span><span style="color: #000;">)</span>+r<span style="color: #0a0;">'Samples<span style="color: #000099; font-weight: bold;">\M</span>atrix Conversion and Gridding<span style="color: #000099; font-weight: bold;">\X</span>YZ Random Gaussian.dat'</span>
wks.<span style="color: #000;">from_file</span><span style="color: #000;">(</span>f<span style="color: #000;">)</span>
wks.<span style="color: #000;">cols_axis</span><span style="color: #000;">(</span><span style="color: #0a0;">'xyz'</span><span style="color: #000;">)</span> 

<span style="color: #d00; font-style: italic;"># Plot 3D surface</span>
gp <span style="color: #000;">=</span> op.<span style="color: #000;">new_graph</span><span style="color: #000;">(</span>template<span style="color: #000;">=</span><span style="color: #0a0;">'glCMAP'</span><span style="color: #000;">)</span>
p <span style="color: #000;">=</span> gp<span style="color: #000;">[</span><span style="color: #000;">0</span><span style="color: #000;">]</span>.<span style="color: #000;">add_plot</span><span style="color: #000;">(</span>wks<span style="color: #000;">,</span>coly<span style="color: #000;">=</span><span style="color: #000;">1</span><span style="color: #000;">,</span>colx<span style="color: #000;">=</span><span style="color: #000;">0</span><span style="color: #000;">,</span>colz<span style="color: #000;">=</span><span style="color: #000;">2</span><span style="color: #000;">,</span> <span style="color: #900090;">type</span><span style="color: #000;">=</span><span style="color: #000;">103</span><span style="color: #000;">)</span> 
gp<span style="color: #000;">[</span><span style="color: #000;">0</span><span style="color: #000;">]</span>.<span style="color: #000;">rescale</span><span style="color: #000;">(</span><span style="color: #000;">)</span>

<span style="color: #d00; font-style: italic;"># Plot contour</span>
gp <span style="color: #000;">=</span> op.<span style="color: #000;">new_graph</span><span style="color: #000;">(</span>template<span style="color: #000;">=</span><span style="color: #0a0;">'TriContour'</span><span style="color: #000;">)</span>
p <span style="color: #000;">=</span> gp<span style="color: #000;">[</span><span style="color: #000;">0</span><span style="color: #000;">]</span>.<span style="color: #000;">add_plot</span><span style="color: #000;">(</span>wks<span style="color: #000;">,</span>coly<span style="color: #000;">=</span><span style="color: #000;">1</span><span style="color: #000;">,</span>colx<span style="color: #000;">=</span><span style="color: #000;">0</span><span style="color: #000;">,</span>colz<span style="color: #000;">=</span><span style="color: #000;">2</span><span style="color: #000;">,</span> <span style="color: #900090;">type</span><span style="color: #000;">=</span><span style="color: #000;">243</span><span style="color: #000;">)</span>
p.<span style="color: #000;">colormap</span> <span style="color: #000;">=</span> <span style="color: #0a0;">'Maple.pal'</span>
<span style="color: #000;">gl</span>.<span style="color: #000;">rescale</span><span style="color: #000;">(</span><span style="color: #000;">)</span>
</pre>
<h2><a name="Plot_From_Data_Range" id="Plot_From_Data_Range"></a><span class="mw-headline">Plot From Data Range</span></h2>
<pre class="python" style="font-family:monospace;">
<span style="color: #0a0;">'''
This sample shows how to use data range to make plot.
'''</span>
<span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #000;">os</span>
<span style="color: #ff7700;font-weight:bold;">import</span> originpro <span style="color: #ff7700;font-weight:bold;">as</span> op

<span style="color: #d00; font-style: italic;"># Import the data file</span>
wks <span style="color: #000;">=</span> op.<span style="color: #000;">new_sheet</span><span style="color: #000;">(</span><span style="color: #000;">)</span>
wks.<span style="color: #000;">from_file</span><span style="color: #000;">(</span><span style="color: #000;">os</span>.<span style="color: #000;">path</span>.<span style="color: #000;">join</span><span style="color: #000;">(</span>op.<span style="color: #000;">path</span><span style="color: #000;">(</span><span style="color: #0a0;">'e'</span><span style="color: #000;">)</span><span style="color: #000;">,</span> <span style="color: #0a0;">'Samples'</span><span style="color: #000;">,</span> <span style="color: #0a0;">'Statistics'</span><span style="color: #000;">,</span> <span style="color: #0a0;">'ANOVA'</span><span style="color: #000;">,</span> <span style="color: #0a0;">'One-Way_ANOVA_indexed.dat'</span><span style="color: #000;">)</span><span style="color: #000;">)</span>

<span style="color: #d00; font-style: italic;"># Create a graph page</span>
graph <span style="color: #000;">=</span> op.<span style="color: #000;">new_graph</span><span style="color: #000;">(</span>template<span style="color: #000;">=</span><span style="color: #0a0;">'scatter'</span><span style="color: #000;">)</span>
<span style="color: #000;">gl</span><span style="color: #000;">=</span>graph<span style="color: #000;">[</span><span style="color: #000;">0</span><span style="color: #000;">]</span>

<span style="color: #d00; font-style: italic;"># Use the data range string as add_plot() argument.</span>
plot <span style="color: #000;">=</span> <span style="color: #000;">gl</span>.<span style="color: #000;">add_plot</span><span style="color: #000;">(</span>f<span style="color: #0a0;">'{wks.lt_range()}!(1,3)[1:20]'</span><span style="color: #000;">)</span>
plot <span style="color: #000;">=</span> <span style="color: #000;">gl</span>.<span style="color: #000;">add_plot</span><span style="color: #000;">(</span>f<span style="color: #0a0;">'{wks.lt_range()}!(1,3)[21:40]'</span><span style="color: #000;">)</span>
plot <span style="color: #000;">=</span> <span style="color: #000;">gl</span>.<span style="color: #000;">add_plot</span><span style="color: #000;">(</span>f<span style="color: #0a0;">'{wks.lt_range()}!(1,3)[41:60]'</span><span style="color: #000;">)</span>

<span style="color: #000;">gl</span>.<span style="color: #000;">group</span><span style="color: #000;">(</span><span style="color: #000;">)</span>
<span style="color: #000;">gl</span>.<span style="color: #000;">rescale</span><span style="color: #000;">(</span><span style="color: #000;">)</span>

<span style="color: #d00; font-style: italic;"># Customize legend</span>
lgnd <span style="color: #000;">=</span> <span style="color: #000;">gl</span>.<span style="color: #000;">label</span><span style="color: #000;">(</span><span style="color: #0a0;">'Legend'</span><span style="color: #000;">)</span>
lgnd.<span style="color: #000;">text</span><span style="color: #000;">=</span><span style="color: #0a0;">'<span style="color: #000099; font-weight: bold;">\l</span>(1) class 1  <span style="color: #000099; font-weight: bold;">\l</span>(2) class 2  <span style="color: #000099; font-weight: bold;">\l</span>(3) class 3'</span>
lgnd.<span style="color: #000;">set_int</span><span style="color: #000;">(</span><span style="color: #0a0;">'left'</span><span style="color: #000;">,</span><span style="color: #000;">1400</span><span style="color: #000;">)</span>
lgnd.<span style="color: #000;">set_int</span><span style="color: #000;">(</span><span style="color: #0a0;">'showframe'</span><span style="color: #000;">,</span><span style="color: #000;">0</span><span style="color: #000;">)</span>
</pre>
<h2><a name="Plot_Heatmap_from_Matrix_Data" id="Plot_Heatmap_from_Matrix_Data"></a><span class="mw-headline">Plot Heatmap from Matrix Data</span></h2>
<pre class="python" style="font-family:monospace;">
<span style="color: #0a0;">'''
This sample shows how to plot a heatmap from matrix data 
It also shows how to set matrix xy map, color scale title and how to set plot colormap
'''</span>
<span style="color: #ff7700;font-weight:bold;">import</span> originpro <span style="color: #ff7700;font-weight:bold;">as</span> op
<span style="color: #ff7700;font-weight:bold;">import</span> numpy <span style="color: #ff7700;font-weight:bold;">as</span> np

arr <span style="color: #000;">=</span> np.<span style="color: #000;">array</span><span style="color: #000;">(</span><span style="color: #000;">[</span><span style="color: #000;">[</span><span style="color: #000;">1</span><span style="color: #000;">,</span> -<span style="color: #000;">8</span><span style="color: #000;">]</span><span style="color: #000;">,</span> <span style="color: #000;">[</span><span style="color: #000;">3</span><span style="color: #000;">,</span> -<span style="color: #000;">4</span><span style="color: #000;">]</span><span style="color: #000;">,</span> <span style="color: #000;">[</span><span style="color: #000;">5</span><span style="color: #000;">,</span> <span style="color: #000;">4</span><span style="color: #000;">]</span><span style="color: #000;">,</span> <span style="color: #000;">[</span><span style="color: #000;">7</span><span style="color: #000;">,</span> <span style="color: #000;">8</span><span style="color: #000;">]</span><span style="color: #000;">]</span><span style="color: #000;">)</span>
mat <span style="color: #000;">=</span> op.<span style="color: #000;">new_sheet</span><span style="color: #000;">(</span><span style="color: #900090;">type</span><span style="color: #000;">=</span><span style="color: #0a0;">'m'</span><span style="color: #000;">)</span>
mat.<span style="color: #000;">from_np</span><span style="color: #000;">(</span>arr<span style="color: #000;">)</span>
<span style="color: #d00; font-style: italic;">#set the 1st matrix's long name, which is the Z lable, which the color scale will use as title</span>
mat.<span style="color: #000;">set_label</span><span style="color: #000;">(</span><span style="color: #000;">0</span><span style="color: #000;">,</span> <span style="color: #0a0;">'Z Levels'</span><span style="color: #000;">)</span>
<span style="color: #d00; font-style: italic;">#set the XY mapping in the matrix which will provde the XY scale for the graph</span>
x1<span style="color: #000;">,</span>x2<span style="color: #000;">,</span>y1<span style="color: #000;">,</span>y2 <span style="color: #000;">=</span> <span style="color: #000;">0.5</span><span style="color: #000;">,</span> <span style="color: #000;">2.5</span><span style="color: #000;">,</span> <span style="color: #000;">0.5</span><span style="color: #000;">,</span> <span style="color: #000;">4.5</span>
mat.<span style="color: #000;">xymap</span> <span style="color: #000;">=</span> x1<span style="color: #000;">,</span>x2<span style="color: #000;">,</span>y1<span style="color: #000;">,</span>y2
gr <span style="color: #000;">=</span> op.<span style="color: #000;">new_graph</span><span style="color: #000;">(</span>template<span style="color: #000;">=</span><span style="color: #0a0;">'Heat_Map.otpu'</span><span style="color: #000;">)</span>
g <span style="color: #000;">=</span> gr<span style="color: #000;">[</span><span style="color: #000;">0</span><span style="color: #000;">]</span>
p <span style="color: #000;">=</span> g.<span style="color: #000;">add_mplot</span><span style="color: #000;">(</span>mat<span style="color: #000;">,</span> <span style="color: #000;">0</span><span style="color: #000;">,</span> <span style="color: #900090;">type</span> <span style="color: #000;">=</span> <span style="color: #000;">105</span><span style="color: #000;">)</span>
<span style="color: #d00; font-style: italic;">#heatmap is showing data point at the center, so need to adjust for half step size</span>
hs <span style="color: #000;">=</span> <span style="color: #000;">0.5</span> * <span style="color: #000;">(</span>x2-x1<span style="color: #000;">)</span>/<span style="color: #000;">2</span><span style="color: #000;">;</span>
g.<span style="color: #000;">set_ylim</span><span style="color: #000;">(</span>y1-hs<span style="color: #000;">,</span> y2+hs<span style="color: #000;">,</span> <span style="color: #000;">1</span><span style="color: #000;">)</span>
g.<span style="color: #000;">set_xlim</span><span style="color: #000;">(</span>x1-hs<span style="color: #000;">,</span> x2+hs<span style="color: #000;">,</span> <span style="color: #000;">1</span><span style="color: #000;">)</span>
<span style="color: #d00; font-style: italic;">#set plot colormap</span>
z <span style="color: #000;">=</span> p.<span style="color: #000;">zlevels</span>
z<span style="color: #000;">[</span><span style="color: #0a0;">'minors'</span><span style="color: #000;">]</span> <span style="color: #000;">=</span> <span style="color: #000;">15</span>
z<span style="color: #000;">[</span><span style="color: #0a0;">'levels'</span><span style="color: #000;">]</span> <span style="color: #000;">=</span> <span style="color: #000;">[</span>-<span style="color: #000;">8</span><span style="color: #000;">,</span> <span style="color: #000;">0</span><span style="color: #000;">,</span> <span style="color: #000;">8</span><span style="color: #000;">]</span>
p.<span style="color: #000;">zlevels</span> <span style="color: #000;">=</span> z
p.<span style="color: #000;">colormap</span> <span style="color: #000;">=</span> <span style="color: #0a0;">'BlueYellow.pal'</span>
</pre>
<h2><a name="Plot_Symbols_Indexed_by_Column_Values" id="Plot_Symbols_Indexed_by_Column_Values"></a><span class="mw-headline">Plot Symbols Indexed by Column Values</span></h2>
<pre class="python" style="font-family:monospace;">
<span style="color: #0a0;">'''
This sample creates a scatter plot from the A(x) B(y) and control plot symbols from:
col(C) = color index (1=black,2=red etc), offset = 1 from Y which is col(B)
col(D) or col(4), or offset=2 from col(B) = symbol type and so on
modi_col is for genreal modifier control
color_col is specific to color which can further control color types, index, direct RGB, colormap
'''</span>
<span style="color: #ff7700;font-weight:bold;">import</span> originpro <span style="color: #ff7700;font-weight:bold;">as</span> op
wks <span style="color: #000;">=</span> op.<span style="color: #000;">new_sheet</span><span style="color: #000;">(</span><span style="color: #000;">)</span><span style="color: #000;">;</span>
wks.<span style="color: #000;">cols</span><span style="color: #000;">=</span><span style="color: #000;">6</span>
x<span style="color: #000;">=</span><span style="color: #000;">[</span><span style="color: #000;">1</span><span style="color: #000;">,</span><span style="color: #000;">2</span><span style="color: #000;">,</span><span style="color: #000;">3</span><span style="color: #000;">,</span><span style="color: #000;">4</span><span style="color: #000;">,</span><span style="color: #000;">5</span><span style="color: #000;">]</span>
<span style="color: #ff7700;font-weight:bold;">for</span> i <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: #900090;">range</span><span style="color: #000;">(</span><span style="color: #000;">6</span><span style="color: #000;">)</span>:
    wks.<span style="color: #000;">from_list</span><span style="color: #000;">(</span>i<span style="color: #000;">,</span>x<span style="color: #000;">)</span>

graph <span style="color: #000;">=</span> op.<span style="color: #000;">new_graph</span><span style="color: #000;">(</span>template<span style="color: #000;">=</span><span style="color: #0a0;">'scatter'</span><span style="color: #000;">)</span>
layer <span style="color: #000;">=</span> graph<span style="color: #000;">[</span><span style="color: #000;">0</span><span style="color: #000;">]</span>
plot <span style="color: #000;">=</span> layer.<span style="color: #000;">add_plot</span><span style="color: #000;">(</span>wks<span style="color: #000;">,</span> coly<span style="color: #000;">=</span><span style="color: #000;">1</span><span style="color: #000;">,</span> colx<span style="color: #000;">=</span><span style="color: #000;">0</span><span style="color: #000;">)</span>
layer.<span style="color: #000;">rescale</span><span style="color: #000;">(</span><span style="color: #000;">)</span>
plot.<span style="color: #000;">color</span> <span style="color: #000;">=</span> op.<span style="color: #000;">color_col</span><span style="color: #000;">(</span><span style="color: #000;">1</span><span style="color: #000;">,</span> <span style="color: #0a0;">'n'</span><span style="color: #000;">)</span><span style="color: #d00; font-style: italic;"># the +1 column, n=index</span>
plot.<span style="color: #000;">symbol_kind</span> <span style="color: #000;">=</span> op.<span style="color: #000;">modi_col</span><span style="color: #000;">(</span><span style="color: #000;">2</span><span style="color: #000;">)</span>
plot.<span style="color: #000;">symbol_size</span> <span style="color: #000;">=</span> op.<span style="color: #000;">modi_col</span><span style="color: #000;">(</span><span style="color: #000;">3</span><span style="color: #000;">)</span>
plot.<span style="color: #000;">symbol_sizefactor</span><span style="color: #000;">=</span><span style="color: #000;">10</span>
plot.<span style="color: #000;">symbol_interior</span> <span style="color: #000;">=</span> op.<span style="color: #000;">modi_col</span><span style="color: #000;">(</span><span style="color: #000;">4</span><span style="color: #000;">)</span>
</pre>
