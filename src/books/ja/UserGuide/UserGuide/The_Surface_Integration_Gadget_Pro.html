<h1 class="firstheading">面積分ガジェット（Proのみ）</h1><p class='urlname' style='display: none'>surface-integ-gadget</p>
<div class="toclimit-2"><div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Overview"><span class="tocnumber">1</span> <span class="toctext">概要</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#ROI_Box_.28roi.29"><span class="tocnumber">2</span> <span class="toctext">ROI ボックス（roi）</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Shape"><span class="tocnumber">2.1</span> <span class="toctext">形状 </span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Shape_Position_.28shapeProp.29"><span class="tocnumber">2.2</span> <span class="toctext">図形の位置 (shapeProp)</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Show_Tool_Name_.28toolname.29"><span class="tocnumber">2.3</span> <span class="toctext">ツール名を表示する (toolname)</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Show_on_Center-Top_of_ROI_Box_.28showtop.29"><span class="tocnumber">2.4</span> <span class="toctext">ROIボックスの上中央に表示 (showtop)</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Fill_Color_.28rectcolor.29"><span class="tocnumber">2.5</span> <span class="toctext">塗り色 (rectcolor)</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8"><a href="#Baseline_.28baseline.29"><span class="tocnumber">3</span> <span class="toctext">基線 (baseline)</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Integration_.28integration.29"><span class="tocnumber">4</span> <span class="toctext">積分 (integration)</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#Output_.28Output.29"><span class="tocnumber">5</span> <span class="toctext">出力 (Output)</span></a>
<ul>
<li class="toclevel-2 tocsection-11"><a href="#Output_Quantities_to_.28outputQuantitiesTo.29"><span class="tocnumber">5.1</span> <span class="toctext">出力先 (outputQuantitiesTo)</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Quantities_Branch_.28quantities.29"><span class="tocnumber">5.2</span> <span class="toctext">値 (quantities)</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#Baseline_.28baselineOutput.29"><span class="tocnumber">5.3</span> <span class="toctext">基線 (baselineOutput)</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-14"><a href="#The_Fly-out_Menu"><span class="tocnumber">6</span> <span class="toctext">フライアウトメニュー</span></a></li>
</ul>
</div>
</div>
<h2><a name="Overview"></a><span class="mw-headline">概要</span></h2>
<p>面積分ガジェット(<a class="external text" href="../../XFunction/X-Function/Addtool_surface_integ.html">addtool_integ2</a> Xファンクション使用)は等間隔な行列や不等間隔な<a class="external text" href="../../GettingStarted/OriginLab/Matrix_Book_Matrix_Sheet_Matrix_Objects.html#Virtual_Matrix">仮想行列</a>、XYZワークシートデータから作図された等高線やグラフの面積分を計算します。
</p><p>このガジェットを使用するには、等高線図をデータから作成し、グラフをアクティブにしてからメニューから<b><b>ガジェット:2D積分</b></b>と操作します。
</p>
<dl><dd><a  class="image"><img alt="2d integrate.png" src="../images/The_Surface_Integration_Gadget_Pro/350px-2d_integrate.png" width="350"   /></a></dd></dl>
<table class="note">

<tr>
<td><b>Notes:</b> ガジェットのXファンクションのオプションはツリー変数として構成されています。各オプション/ブランチのツリーノードはオプション名(ツリーノード名)の隣に括弧で表記します。
</td></tr></table>
<h2><a name="ROI_Box_.28roi.29"></a><span class="mw-headline">ROI ボックス（roi）</span></h2>
<p>ROI（region of interest、興味範囲）ボックスは四角形のオブジェクトで面積分計算を定義します。 
</p>
<h3><a name="Shape"></a><span class="mw-headline">形状</span></h3>
<p>ROIボックスの形状を決めます。 
</p>
<table class="dialogcontroltable">

<tr>
<th> 矩形
</th>
<td> ROI矩形の形と位置は、下の<b>図形の位置</b>で指定します。
</td></tr>
<tr>
<th> 円
</th>
<td> ROI円の形と位置は、下の<b>図形の位置</b>で指定します。
</td></tr>
<tr>
<th> 任意の形状
</th>
<td> <b>OK</b>ボタンをクリックすると、<b>ROIを作成</b>小ダイアログボックスが開き、描画ツールを選択してグラフ上に任意の形状を描画し、ROIボックスを追加できます。
<p><a  class="image"><img alt="Create ROI Dialog.png" src="../images/The_Surface_Integration_Gadget_Pro/Create_ROI_Dialog.png" width="245"  /></a>
</p>
<ul><li><b>矩形</b><a  class="image"><img alt="Button Rectangle Tool.png" src="../images/The_Surface_Integration_Gadget_Pro/Button_Rectangle_Tool.png" width="22"  /></a> &amp;&amp; <b>円</b><a  class="image"><img alt="Button Circle Tool.png" src="../images/The_Surface_Integration_Gadget_Pro/Button_Circle_Tool.png" width="22"  /></a> ボタン: 正方形/長方形/円/楕円形のオブジェクトを描画してROIを追加します。これらのツールの詳細は、<a href="../../UserGuide/Category/Creating_Drawing_Objects.html#Drawing_two-dimensional_objects" title="カテゴリー:描画オブジェクトを作成する">このページ</a>を確認してください。</li>
<li><b>ポリゴン</b><a  class="image"><img alt="Button Polygon Tool.png" src="../images/The_Surface_Integration_Gadget_Pro/Button_Polygon_Tool.png" width="22"  /></a> &amp;&amp; <b>領域</b><a  class="image"><img alt="Button Region Tool.png" src="../images/The_Surface_Integration_Gadget_Pro/Button_Region_Tool.png" width="22"  /></a> ボタン: フリースタイルオブジェクトを描画してROIを追加します。これらのツールの詳細は、<a href="../../UserGuide/Category/Creating_Drawing_Objects.html#Drawing_two-dimensional_objects" title="カテゴリー:描画オブジェクトを作成する">このページ</a>を確認してください。</li>
<li><b>曲線</b> ボタン <a  class="image"><img alt="Button Curve Tool.png" src="../images/The_Surface_Integration_Gadget_Pro/Button_Curve_Tool.png" width="22"  /></a>: 閉曲線を描画してROIを追加します。このツールの詳細は、<a href="../../UserGuide/Category/Creating_Drawing_Objects.html#Drawing_smooth_curve" title="カテゴリー:描画オブジェクトを作成する">このページ</a>を確認してください。</li></ul>
</td></tr></table>
<p><br />
<b>Note:</b>ROIをグラフに追加した後、いつでもROIボックスの右上隅にある三角形のボタンをクリックし、<b>ROIの変更</b>メニューを選択して<b>ROIを作成</b>ダイアログを開き、ROIの形状を再度変更することができます。
</p>
<h3><a name="Shape_Position_.28shapeProp.29"></a><span class="mw-headline">図形の位置 (shapeProp)</span></h3>
<p>ROI ボックスの位置はXY座標の位置を設定する事で定義できます。
</p>
<table class="dialogcontroltable">

<tr>
<th> X1 (xFrom)
</th>
<td> ROIボックスのX座標の左端の線の位置の値を入力します。
</td></tr>
<tr>
<th> X2 (xTo)
</th>
<td> ROIボックスのX座標の右端の線の位置の値を入力します。
</td></tr>
<tr>
<th> Y1 (yFrom)
</th>
<td> ROIボックスのY座標の下端の線の位置の値を入力します。
</td></tr>
<tr>
<th> Y2 (yTo)
</th>
<td> ROIボックスのY座標の上端の線の位置の値を入力します。
</td></tr>
<tr>
<th> 固定（ROIによる変動を防止） (fix_roi_loc)
</th>
<td> 手動でROIボックスを移動するかどうか指定します。
</td></tr></table>
<p><br />
</p>
<h3><a name="Show_Tool_Name_.28toolname.29"></a><span class="mw-headline">ツール名を表示する(toolname)</span></h3>
<p>ROIボックスの左上角にツールの名前を表示するかどうか指定します。このチェックボックスが選択されていると、表示されるテキストボックスでツール名を指定することができます。
</p><p><br />
</p>
<h3><a name="Show_on_Center-Top_of_ROI_Box_.28showtop.29"></a><span class="mw-headline">ROIボックスの上中央に表示 (showtop)</span></h3>
<p>指定する値の結果をROIボックスの中央上に表示するかどうか指定します。
</p>
<table class="dialogcontroltable">

<tr>
<th> 体積 (topVolume)
</th>
<td> 体積は元の平面から積分されます。
</td></tr>
<tr>
<th> FWHM (topFwhm)
</th>
<td> 元の平面の半分の高さと全幅です。
</td></tr>
<tr>
<th> N (topN)
</th>
<td> データポイントです。
</td></tr>
<tr>
<th> 最小 (topMinimum)
</th>
<td> 最小Z値です。
</td></tr>
<tr>
<th> 最大 (topMaximum)
</th>
<td> 最大Z値です。
</td></tr>
<tr>
<th> 平均 (topMean)
</th>
<td> Z値の平均です。
</td></tr>
<tr>
<th> 中央値 (topMedian)
</th>
<td> Z値の中央値です。
</td></tr>
<tr>
<th> SD (topSD)
</th>
<td> Z値の標準偏差です。
</td></tr>
<tr>
<th> 合計 (topSum)
</th>
<td> Z値の合計です。
</td></tr></table>
<h3><a name="Fill_Color_.28rectcolor.29"></a><span class="mw-headline">塗り色 (rectcolor)</span></h3>
<p>ROIボックスの塗りつぶしの色を指定します。
</p>
<h2><a name="Baseline_.28baseline.29"></a><span class="mw-headline">基線 (baseline)</span></h2>
<table class="dialogcontroltable">

<tr>
<th>モード (method)
</th>
<td>ベースのモードを選択します。
<ul><li><b>なし</b>
<dl><dd>基線はなく、積分は0面から開始します。</dd></dl></li>
<li><b>定数</b>
<dl><dd>予め定義したZ値でXY面と平行な平面を使用します。</dd></dl></li>
<li><b>面</b>
<dl><dd>境界ポイントを使用してフィット面を基線として作成します。  </dd></dl></li></ul>
</td></tr>
<tr>
<th>定数(constantMode)
</th>
<td><b>モード</b>で<b>定数</b>が選択されている時のみ利用できます。基線面のためのZ値を指定するために使用します。
<ul><li><b>カスタム</b>
<dl><dd>カスタムZ値を設定します。<b>Z=</b>テキストボックスで定義します。</dd></dl></li>
<li><b>最小</b>
<dl><dd>最小Z値を使用します。</dd></dl></li>
<li><b>最大</b>
<dl><dd>最大Z値を使用します。</dd></dl></li></ul>
</td></tr>
<tr>
<th>Z= (zvalue)
</th>
<td><b>定数</b>で<b>カスタム</b>が選択されている時のみ利用できます。基線面のためカスタムZ値を指定するために使用します。
</td></tr>
<tr>
<th>境界許容量(％) (boundtor)
</th>
<td><b>モード</b>で<b>面</b>が選択されている時のみ利用できます。境界は<b>範囲</b>で選択されているオプションで決定します。許容量(パーセント単位)が許容幅と許容高さを定義します。つまり、境界からのポイントの距離が許容幅や高さよりも小さい必要があります。許容幅/高さ = 許容量 (%) * 幅/高さ
</td></tr>
<tr>
<th>範囲 (range)
</th>
<td>このオプションは<b>モード</b>で<b>なし</b>が選択されているときと<b>定数</b>で<b>カスタム</b>が選択されている時は利用できません。これは基準面を決定するときのデータ範囲を指定する際に使用します。
<ul><li><b>全プロット範囲</b>
<dl><dd>基準面として全プロット範囲が使用されるか、全プロット範囲内で最小/最大の値が見つけられます。</dd></dl></li>
<li><b>ROI内のグラフ</b>
<dl><dd>ROIボックス内部のプロットの境界が基準面をフィットするのに使用されるか、ROIボックス内の最小/最大の値が探され、その値が使われます。</dd></dl></li></ul>
</td></tr></table>
<h2><a name="Integration_.28integration.29"></a><span class="mw-headline">積分 (integration)</span></h2>
<p>積分に関するオプションをこのタブで指定できます。
</p><p><b>欠損値を補間する</b>(<b>interpmissing</b>) にチェックがついている場合、欠損値を補間します。
</p><p><b>基線を差し引いた表面を表示</b>(<b>showsurface</b>)にチェックがついている場合、差し引かれた曲面(元のデータと基線面から差し引く)が表示されます。
</p>
<h2><a name="Output_.28Output.29"></a><span class="mw-headline">出力 (Output)</span></h2>
<h3><a name="Output_Quantities_to_.28outputQuantitiesTo.29"></a><span class="mw-headline">出力先 (outputQuantitiesTo)</span></h3>
<p>出力結果を編集します。 
</p>
<table class="dialogcontroltable">

<tr>
<th><b><b>スクリプトウィンドウ</b></b> (<b>script</b>)
</th>
<td> <b>スクリプトウィンドウ</b>に結果を出力するかどうかを指定します。
</td></tr>
<tr>
<th><b><b>結果ログ</b></b> (<b>reslog</b>)
</th>
<td>結果ログに結果を出力するかどうかを指定します。
</td></tr>
<tr>
<th><b><b>ワークシートに追加</b></b> (<b>appendwks</b>)
</th>
<td>ワークシートに出力結果を追加するかどうか指定します。
</td></tr>
<tr>
<th><b><b>結果ワークシート名</b></b> (<b>wbkName</b>)
</th>
<td>これは、<b><b>ワークシートに追加</b></b>(<b>appendwks</b>) が選択されたときのみ利用できます。
<p>ワークシートに出力する場合、次のオプションを利用できます。
</p>
<ul><li> 結果は、デフォルトで<b>[%H-Integ2d]Result</b>に出力されますが、ほかのブックやシートを指定することもできます（ここで、<b>%H</b>はソースグラフのショートネームです）。指定したブックやシートがない場合、作成して出力します。</li>
<li> もう一つの方法として、<b>結果ワークシート名</b>の右側にあるフライアウトボタン<a  class="image"><img alt="Gadget flyout button.png" src="../images/The_Surface_Integration_Gadget_Pro/Gadget_flyout_button.png" width="18"  /></a>をクリックして、<b>入力ブック内のシート</b>を選択します。これにより、編集ボックスには<b>[&lt;input&gt;]Result</b>が入力されます。結果は、元データのワークシート<b>Result</b>に出力されます。</li></ul>
</td></tr></table>
<h3><a name="Quantities_Branch_.28quantities.29"></a><span class="mw-headline">値 (quantities)</span></h3>
<p>出力する値を指定します。 
</p>
<table class="dialogcontroltable">

<tr>
<th> <b>データセット識別子 (name)</b>
</th>
<td>ドロップダウンリストでデータセット識別子を指定します。
</td></tr>
<tr>
<th> <b>インデックス範囲 (index_rng)</b>
</th>
<td>ROIボックスで制限された次元のためにインデックスを出力するかどうか指定します。これは、入力データがXYZ範囲でない限り使用できません。
</td></tr>
<tr>
<th> <b>X範囲 (x_rng)</b>
</th>
<td>X範囲のインデックスを出力するかどうかを指定します。
</td></tr>
<tr>
<th> <b>Y範囲 (y_rng)</b>
</th>
<td>Y範囲のインデックスを出力するかどうかを指定します。
</td></tr>
<tr>
<th><b><b>最大の高さ</b> (max_height)</b>
</th>
<td> 元の曲面から基線までで計算する最大の高さを出力するかどうか指定します。
</td></tr>
<tr>
<th><b>量 (volume)</b>
</th>
<td> 元の平面から積分された量を出力するか指定します。
</td></tr>
<tr>
<th> <b>表面の面積 (area)</b>
</th>
<td> 元の曲面の面積を出力するかどうかを指定します。
</td></tr>
<tr>
<th> <b>重心 (centroid)</b>
</th>
<td> 選択した範囲の重心の座標を出力するかどうか指定します。
</td></tr>
<tr>
<th><b>FWHM (fwhm)</b>
</th>
<td> FWHM、元の曲面の半分の高さでの幅を出力するかどうかを指定します。
</td></tr>
<tr>
<th><b>半幅 (half_width)</b>
</th>
<td> 半分の幅を出力するかどうかを指定します。
</td></tr>
<tr>
<th> <b>Zの最大 (zmax)</b>
</th>
<td> Zの最大値を出力するかどうかを指定します。
</td></tr>
<tr>
<th> <b>Z最大値のインデックス (index_zmax)</b>
</th>
<td> Z最大値でデータポイントの列/行 インデックスを出力するか指定します。
</td></tr>
<tr>
<th> <b>Z最大値の(x,y) (xy_zmax)</b>
</th>
<td> Z最大値でデータポイントのXとY値を出力するか指定します。
</td></tr>
<tr>
<th> <b>統計 (QStatistics)</b>
</th>
<td> Z値を元にした統計値を出力するか指定します。
<ul><li><b>N (qsN)</b>：データポイント数です。</li>
<li><b>最小 (qsMinimum)</b>：最小Z値です。</li>
<li><b>最大 (qsMinimum)</b>：最大Z値です。</li>
<li><b>平均 (qsMean)</b>：Z値の平均です。</li>
<li><b>中央値 (qsMedian)</b>：Z値の中央値です。</li>
<li><b>SD (qsSD)</b>：Z値の標準偏差です。</li>
<li><b>合計 (qsSum)</b>：Z値の合計です。</li></ul>
</td></tr></table>
<h3><a name="Baseline_.28baselineOutput.29"></a><span class="mw-headline">基線 (baselineOutput)</span></h3>
<table class="dialogcontroltable">

<tr>
<th> <b>基線</b> (<b>baseline</b>)
</th>
<td> 基線の情報を出力するか指定します。
</td></tr>
<tr>
<th><b><b>出力先</b></b><b> </b>(<b>OutputTo</b>)
</th>
<td>結果を出力する場所を指定します。
</td></tr></table>
<p><br />
</p>
<table class="note">

<tr>
<td><b><b>Notes:</b></b> 名前はダイアログボックスのラベルで、括弧の中の名前はツリーノード名です。Xファンクションがスクリプトで実行されるとき、その名前を使って、ツリーノードに値を割り当てる必要があります。ツリーノード名に特殊記号やスペースを使うことはできません。しかし、ツリーノードラベル(ダイアログのラベル)には特殊記号やスペースを使うことができます。
</td></tr></table>
<h2><a name="The_Fly-out_Menu"></a><span class="mw-headline">フライアウトメニュー</span></h2>
<p>ROIボックスの右上角にある三角形のボタン<a  class="image"><img alt="ROI menu.png" src="../images/The_Surface_Integration_Gadget_Pro/ROI_menu.png" width="21"  /></a>をクリックして、以下のオプションを含んだフライアウトメニューを開きます。
</p>
<table class="dialogcontroltable">

<tr>
<th><b>新しい出力</b>
</th>
<td>結果を出力します。
</td></tr>
<tr>
<th><b>レポートシートに行く</b>
</th>
<td> ワークシートの結果が出力されてから、結果のワークシートに移動します。
</td></tr>
<tr>
<th>クリップボードに出力
</th>
<td>選択すると（メニューの項目にチェックが入っている）、<b>新しい出力</b>がクリップボードに出力されます。
</td></tr>
<tr>
<th><b>データ変更</b>
</th>
<td> 入力データの変更
<ul><li> デフォルトで<b>自動</b>モードになっています。  <b>自動</b>が有効になっている場合、プロットの選択は、グラフウィンドウまたはオブジェクトマネージャでプロットをクリックすることによって可能です。  Origin 2019より前のバージョンでは、自動はサポートしていないので、変更する場合はフライアウトメニューを使います。 </li>
<li> 各プロットにチェックを付けて、そのプロットを選択します。</li>
<li> <b>選択...</b>または、<b>詳細...</b>をクリックすると<b>プロットを選択</b>ダイアログが開きます。</li></ul>
</td></tr>
<tr>
<th><b>プロット群の最大範囲に拡大する</b>
</th>
<td> ROIボックスを全プロット範囲に拡大します。
</td></tr>
<tr>
<th><b>レイヤの最大幅に拡大する</b>
</th>
<td> ROIの幅をレイヤ幅に広げます。
</td></tr>
<tr>
<th><b>レイヤの最大高さに拡大する</b>
</th>
<td> ROIの高さをレイヤ高さに広げます。
</td></tr>
<tr>
<th><b>テーマに名前を付けて保存</b>
</th>
<td> この設定をダイアログテーマとして保存します。
</td></tr>
<tr>
<th><b>&lt;デフォルト&gt;として保存</b>
</th>
<td> この設定を＜デフォルト＞テーマとして保存します。
</td></tr>
<tr>
<th><b>テーマのロード</b>
</th>
<td> 以前保存されたテーマをロードします。
</td></tr>
<tr>
<th><b>設定</b>
</th>
<td> 設定ダイアログを開きます。
</td></tr></table>







    