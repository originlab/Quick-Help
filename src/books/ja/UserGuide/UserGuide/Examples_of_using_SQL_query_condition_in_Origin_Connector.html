<h1 class="firstheading">OriginコネクタにおけるSQLクエリ使用のリファレンス</h1>
<p class="urlname" style="display: none;">Origin-Connect-Refer</p>
<p>Origin 2020から、Originファイルコネクタは、プロジェクトファイルに保存された希望のデータを選択するためのSQLクエリ言語をサポートしています。SQLは、単純な宣言ステートメントを通じて動作します。そして、データ抽出をより柔軟にし、Originプロジェクトでのデータ整理、維持に役立ちます。</p>
<div id="toc" class="toc">
<div id="toctitle">
<h2>目次</h2>
</div>
<ol>
<li class="toclevel-1 tocsection-1"><a href="#Syntax:"><span class="tocnumber">1</span> <span class="toctext">シンタックス:</span></a>
<ol>
<li class="toclevel-2 tocsection-2"><a href="#Range_to_search"><span class="tocnumber">1.1</span> <span class="toctext">検索範囲</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#key_words_in_Condition"><span class="tocnumber">1.2</span> <span class="toctext">条件のキーワード</span></a>
<ol>
<li class="toclevel-3 tocsection-4"><a href="#Column_Type"><span class="tocnumber">1.2.1</span> <span class="toctext">Column_Type</span></a></li>
<li class="toclevel-3 tocsection-5"><a href="#Column_Y"><span class="tocnumber">1.2.2</span> <span class="toctext">Column_Y</span></a></li>
<li class="toclevel-3 tocsection-6"><a href="#Column_Z"><span class="tocnumber">1.2.3</span> <span class="toctext">Column_Z</span></a></li>
<li class="toclevel-3 tocsection-7"><a href="#Column_SName"><span class="tocnumber">1.2.4</span> <span class="toctext">Column_SName</span></a></li>
<li class="toclevel-3 tocsection-8"><a href="#Column_LName"><span class="tocnumber">1.2.5</span> <span class="toctext">Column_LName</span></a></li>
<li class="toclevel-3 tocsection-9"><a href="#Column_Comments"><span class="tocnumber">1.2.6</span> <span class="toctext">Column_Comments</span></a></li>
<li class="toclevel-3 tocsection-10"><a href="#Column_Visible"><span class="tocnumber">1.2.7</span> <span class="toctext">Column_Visible</span></a></li>
<li class="toclevel-3 tocsection-11"><a href="#Column_Pn"><span class="tocnumber">1.2.8</span> <span class="toctext">Column_Pn</span></a></li>
<li class="toclevel-3 tocsection-12"><a href="#Column_Dn"><span class="tocnumber">1.2.9</span> <span class="toctext">Column_Dn</span></a></li>
<li class="toclevel-3 tocsection-13"><a href="#Column_SampleID"><span class="tocnumber">1.2.10</span> <span class="toctext">Column_SampleID</span></a></li>
<li class="toclevel-3 tocsection-14"><a href="#Sheet_SName"><span class="tocnumber">1.2.11</span> <span class="toctext">Sheet_SName</span></a></li>
<li class="toclevel-3 tocsection-15"><a href="#Sheet_Comments"><span class="tocnumber">1.2.12</span> <span class="toctext">Sheet_Comments</span></a></li>
<li class="toclevel-3 tocsection-16"><a href="#Book_Comments"><span class="tocnumber">1.2.13</span> <span class="toctext">Book_Comments</span></a></li>
<li class="toclevel-3 tocsection-17"><a href="#Book_SName"><span class="tocnumber">1.2.14</span> <span class="toctext">Book_SName</span></a></li>
<li class="toclevel-3 tocsection-18"><a href="#Book_LName"><span class="tocnumber">1.2.15</span> <span class="toctext">Book_LName</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="toclevel-1 tocsection-19"><a href="#Examples"><span class="tocnumber">2</span> <span class="toctext">サンプル</span></a>
<ol>
<li class="toclevel-2 tocsection-20"><a href="#Example_1"><span class="tocnumber">2.1</span> <span class="toctext">サンプル 1</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="#Example_2"><span class="tocnumber">2.2</span> <span class="toctext">サンプル 2</span></a></li>
</ol>
</li>
</ol>
</div>
<h2><a name="Syntax:" id="Syntax:"></a><span class="mw-headline">シンタックス:</span></h2>
<pre class="lt" style="font-family: monospace;">
SELECT COLUMN FROM Range WHERE Condition
</pre>
<p><b>Note</b>: Originファイルコネクタで使用されるオブジェクトとしてサポートされるのはデータ列のみです。</p>
<h3><a name="Range_to_search" id="Range_to_search"></a><span class="mw-headline">検索範囲</span></h3>
<p>FROMは、プロジェクトパス、ワークブック、またはシート範囲表記をサポートしています。以下の特別なキーも利用可能です。</p>
<ul>
<li>PROJECT,</li>
<li>ACTIVEFOLDER,</li>
<li>FAVORITEFOLDER</li>
</ul>
<h3><a name="key_words_in_Condition" id="key_words_in_Condition"></a><span class="mw-headline">条件のキーワード</span></h3>
<h4><a name="Column_Type" id="Column_Type"></a><span class="mw-headline">Column_Type</span></h4>
<p>指定したプロット属性の列を選択します。</p>
<pre class="lt" style="font-family: monospace;">
<span style="color: #008000;">//プロジェクト全体を検索し非表示のX列を選択</span>
Select Column from Project where <span style="color: #000000;">(</span>Column_Type <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"X"</span> and Column_Visible <span style="color: #000080;">=</span> True<span style="color: #000000;">)</span>;
</pre>
<h4><a name="Column_Y" id="Column_Y"></a><span class="mw-headline">Column_Y</span></h4>
<p>Y列を選択すると、関連するX列もインポートされます。</p>
<pre class="lt" style="font-family: monospace;">
<span style="color: #008000;">//プロジェクト全体を検索し、「Trial」で始まる長い名前の列を選択</span><span style="color: #008000;">
//選択した列とX列の両方をインポート</span>
Select Column from Project where <span style="color: #000000;">(</span>Column_LName like <span style="color: #ff00ff;">"Trial*"</span> and Column_Y <span style="color: #000080;">=</span> True<span style="color: #000000;">)</span>;
</pre>
<h4><a name="Column_Z" id="Column_Z"></a><span class="mw-headline">Column_Z</span></h4>
<p>Z列を選択すると、関連するXおよびY列もインポートされます。</p>
<pre class="lt" style="font-family: monospace;">
<span style="color: #008000;">//プロジェクト全体を検索し、「Trial」で始まる長い名前の列を選択</span><span style="color: #008000;">
//選択した列と関連するXY列の両方をインポート</span>
Select Column from Project where <span style="color: #000000;">(</span>Column_LName like <span style="color: #ff00ff;">"Trial*"</span> and Column_Z <span style="color: #000080;">=</span> True<span style="color: #000000;">)</span>;
</pre>
<h4><a name="Column_SName" id="Column_SName"></a><span class="mw-headline">Column_SName</span></h4>
<p>指定したショートネームの列を選択します。</p>
<pre class="lt" style="font-family: monospace;">
<span style="color: #008000;">//アクティブワークブックを検索し、ショートネーム「A」の列を選択</span>
Select Column from <span style="color: #000080;">%</span>H where Column_SName like <span style="color: #ff00ff;">"A"</span>;
</pre>
<h4><a name="Column_LName" id="Column_LName"></a><span class="mw-headline">Column_LName</span></h4>
<p>指定したロングネームの列を選択します。ワイルドカードの “*” と “?” を使用できます。“*” は任意の文字列を表し、“?”は任意の1文字を表します。</p>
<pre class="lt" style="font-family: monospace;">
<span style="color: #008000;">//プロジェクト全体を検索し、「Trial」で始まるロングネームの列を選択</span>
Select Column from Project where Column_LName like <span style="color: #ff00ff;">"Trial*"</span>;
</pre>
<h4><a name="Column_Comments" id="Column_Comments"></a><span class="mw-headline">Column_Comments</span></h4>
<p>指定した条件に合致するコメントを持つ列を選択します。ワイルドカードがサポートされています。</p>
<pre class="lt" style="font-family: monospace;">
<span style="color: #008000;">//プロジェクト全体を検索し、文字「S」で始まり数字「3」で終わるコメントのある列を選択</span>
Select Column from Project where Column_Comments like <span style="color: #ff00ff;">"S*3"</span>;
</pre>
<h4><a name="Column_Visible" id="Column_Visible"></a><span class="mw-headline">Column_Visible</span></h4>
<p>表示列または非表示列から選択するよう指定します。</p>
<pre class="lt" style="font-family: monospace;">
<span style="color: #008000;">//プロジェクト全体を検索し、非表示のY列を選択</span>
Select Column from Project where <span style="color: #000000;">(</span>Column_Type <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"Y"</span> and Column_Visible <span style="color: #000080;">=</span> False<span style="color: #000000;">)</span>;
</pre>
<h4><a name="Column_Pn" id="Column_Pn"></a><span class="mw-headline">Column_Pn</span></h4>
<p>指定した条件に合致するパラメータ<i>n</i> ヘッダ行を持つ列を選択します。ワイルドカード文字の使用がサポートされています。</p>
<pre class="lt" style="font-family: monospace;">
<span style="color: #008000;">//プロジェクト全体を検索し、パラメータ1に文字「y」が含まれる列を選択</span>
Select Column from Project where Column_P1 like <span style="color: #ff00ff;">"*y*"</span>;
</pre>
<h4><a name="Column_Dn" id="Column_Dn"></a><span class="mw-headline">Column_Dn</span></h4>
<p>指定した条件に合致するユーザ定義パラメータ<i>n</i> を持つ列を選択します。ワイルドカード文字の使用がサポートされています。</p>
<pre class="lt" style="font-family: monospace;">
<span style="color: #008000;">//プロジェクト全体を検索し、文字「y」を含み、</span><span style="color: #008000;">
//1番目のユーザー定義パラメーターの値が3より大きいParameter1の列を選択</span>
Select Column from Project where <span style="color: #000000;">(</span>Column_P1 like <span style="color: #ff00ff;">"*y*"</span> and Column_D1 <span style="color: #000080;">&gt;</span> <span style="color: #0000dd;">3</span><span style="color: #000000;">)</span>;
</pre>
<h4><a name="Column_SampleID" id="Column_SampleID"></a><span class="mw-headline">Column_SampleID</span></h4>
<p>指定した条件に合致するユーザ定義パラメータ名<i>SampleID</i> を持つ列を選択します。スペースを含む名前の場合は、[<i>SampleID</i>]を使います。条件にワイルドカードの使用がサポートされています。</p>
<pre class="lt" style="font-family: monospace;">
<span style="color: #008000;">//アクティブなフォルダを検索し、パラメーター行“Population Mean”が100より大きい列を選択</span>
Select Column from ACTIVEFOLDER where Column_<span style="color: #000000;">[</span>Population Mean<span style="color: #000000;">]</span> <span style="color: #000080;">&gt;</span> <span style="color: #0000dd;">100</span>;
</pre>
<h4><a name="Sheet_SName" id="Sheet_SName"></a><span class="mw-headline">Sheet_SName</span></h4>
<p>指定した条件に合致するショートネームのシートの列を選択します。ワイルドカード文字の使用がサポートされています。</p>
<pre class="lt" style="font-family: monospace;">
<span style="color: #008000;">//お気に入りフォルダを検索し、「Trial…」という名前のシートの列を選択</span>
Select Column from FAVORITEFOLDER where Sheet_SName like <span style="color: #ff00ff;">"Trial*"</span>;
</pre>
<h4><a name="Sheet_Comments" id="Sheet_Comments"></a><span class="mw-headline">Sheet_Comments</span></h4>
<p>シートコメントが指定した条件に一致するプロジェクトから列を選択します。ワイルドカード文字の使用がサポートされています。</p>
<pre class="lt" style="font-family: monospace;">
Select Column From Project Where Sheet_Comments like <span style="color: #ff00ff;">"Sheet1"</span> and Book_Comments like <span style="color: #ff00ff;">"Book1"</span>
</pre>
<h4><a name="Book_Comments" id="Book_Comments"></a><span class="mw-headline">Book_Comments</span></h4>
<p>ブックのコメントが指定した条件に一致するプロジェクトから列を選択します。ワイルドカード文字の使用がサポートされています。</p>
<pre class="lt" style="font-family: monospace;">
Select Column From Project Where Book_Comments like <span style="color: #ff00ff;">"Trial Run*"</span>
</pre>
<h4><a name="Book_SName" id="Book_SName"></a><span class="mw-headline">Book_SName</span></h4>
<p>指定した条件に合致するショートネームのワークブックの列を選択します。ワイルドカード文字の使用がサポートされています。</p>
<pre class="lt" style="font-family: monospace;">
<span style="color: #008000;">//プロジェクト全体を検索し、「Book」で始まるショートネームのブックの列を選択</span>
Select Column from Project where <span style="color: #000000;">(</span>Book_SName like <span style="color: #ff00ff;">"Book*"</span><span style="color: #000000;">)</span>;
</pre>
<h4><a name="Book_LName" id="Book_LName"></a><span class="mw-headline">Book_LName</span></h4>
<p>指定した条件に合致するロングネームのワークブックの列を選択します。ワイルドカード文字の使用がサポートされています。</p>
<pre class="lt" style="font-family: monospace;">
<span style="color: #008000;">//プロジェクト全体を検索し、ショートネームが「Book」で始まるブックまたは、</span><span style="color: #008000;">
//「fit」で始まるブックの列を選択</span>
Select Column from Project where <span style="color: #000000;">(</span>Book_SName like <span style="color: #ff00ff;">"Book*"</span> or Book_LName like <span style="color: #ff00ff;">"*fit*"</span><span style="color: #000000;">)</span>;
</pre>
<p><br /></p>
<h2><a name="Examples" id="Examples"></a><span class="mw-headline">サンプル</span></h2>
<h5><a name="Example_1" id="Example_1"></a><span class="mw-headline">サンプル 1</span></h5>
<ol>
<li><b>データ：ファイルに接続：Originコネクタ</b>を選択します。<i>&lt;OriginLab インストールフォルダ&gt;\Samples\Tutorial Data.opj</i> ファイルを選択します。</li>
<li>「選択」ダイアログで、<b>クエリを選択</b>ボタン<a class="image"><img alt="Select Query button.png" src="../images/Examples_of_using_SQL_query_condition_in_Origin_Connector/Select_Query_button.png" width="44" height="30" border="0" /></a>をクリックして、<b>クエリを選択</b>ダイアログを開きます。</li>
<li>次の文字列を入力します。
<pre class="lt" style="font-family: monospace;">
Select Column from Project where <span style="color: #000000;">(</span>Column_LName like <span style="color: #ff00ff;">"Year"</span> AND Column_Type <span style="color: #000080;">=</span> X<span style="color: #000000;">)</span> or <span style="color: #000000;">(</span>Column_LName like <span style="color: #ff00ff;">"Value*"</span> and Column_Type <span style="color: #000080;">=</span> Y<span style="color: #000000;">)</span>
        
</pre></li>
<li><b>OK</b>をクリックし、下部パネルに追加します。</li>
<li><b>OK</b>をクリックして、ロングネーム「Year」のX列と、文字列「Value」で始まるロングネームのY列をインポートします。</li>
</ol>
<p><br /></p>
<h5><a name="Example_2" id="Example_2"></a><span class="mw-headline">サンプル 2</span></h5>
<ol>
<li><b>ヘルプ: ラーニングセンター</b>を選択します。開いたダイアログで、<i>統計グラフ - Pyramid Plot of Australia Population</i> を選択して開きます。</li>
<li>コマンドウィンドウウィンドウで次のLabTalkスクリプトを実行して、新規ワークブックに5000000人を超えるすべての男性人口データを新しいブックに抽出します。
<pre class="lt" style="font-family: monospace;">
wo <span style="color: #000080;">-</span>qn Select Column from <span style="color: #000000;">[</span><span style="color: #ff00ff;">"Austrialia Population from 1960 to 2017"</span><span style="color: #000000;">]</span>UnstackCols2<span style="color: #000080;">!</span> where <span style="color: #000000;">(</span>Column_Comments like <span style="color: #ff00ff;">"male*"</span> and Column_N <span style="color: #000080;">&gt;</span> <span style="color: #0000dd;">5000000</span><span style="color: #000000;">)</span>;
        
</pre>
<p>Note: LabTalkコマンド「worksheet -qn」の詳細については、<a class="external text" href="../../LabTalk/LabTalk/Worksheet_(command).html#-qn.3B_Extract_columns_satisfied_with_specified_SQL_query_and_put_to_a_new_book">このページ</a>を参照してください。</p>
</li>
</ol>
