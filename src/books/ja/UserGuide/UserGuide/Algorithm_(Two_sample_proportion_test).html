<h1 class="firstheading">アルゴリズム（2群の比率の検定）</h1><p><br />
</p><p>サンプル1の大きさを<img src="../images/Algorithm_(Two_sample_proportion_test)/math-2fccdd06e4c2b79e4f65f2f532fdf9ec.png" title="n_{1}\!" alt="n_{1}\!" class="tex"/>、イベントまたは成功の数を<img src="../images/Algorithm_(Two_sample_proportion_test)/math-fdad14c036fde9f986da06150b87a44c.png" title="x_{1}\!" alt="x_{1}\!" class="tex"/>とすると、サンプルの比率<img src="../images/Algorithm_(Two_sample_proportion_test)/math-2b49ceafb7c17ba633238ebd9932468b.png" title="\tilde{p_{1}}\!" alt="\tilde{p_{1}}\!" class="tex"/>は以下のように計算されます。<img src="../images/Algorithm_(Two_sample_proportion_test)/math-a31d5b1c9315097b39138038b35a733d.png" title="\tilde{p_{1}}=\frac{x_{1}}{n_{1}}" alt="\tilde{p_{1}}=\frac{x_{1}}{n_{1}}" class="tex"/> 
</p><p>同様に、異なるサンプルでは、サンプルサイズは<img src="../images/Algorithm_(Two_sample_proportion_test)/math-524b3b5be113e2ddfb80c81946f7acd9.png" title="n_{2}\!" alt="n_{2}\!" class="tex"/>で、イベントの数を<img src="../images/Algorithm_(Two_sample_proportion_test)/math-32846ccc5f26d802a0fe5ea9bbe7f00d.png" title="x_{2}\!" alt="x_{2}\!" class="tex"/>とすると、サンプルの比率は<img src="../images/Algorithm_(Two_sample_proportion_test)/math-bdf797b2281b2325c6b84e5fbbdd0419.png" title="\tilde{p_{2}}=\frac{x_{2}}{n_{2}}" alt="\tilde{p_{2}}=\frac{x_{2}}{n_{2}}" class="tex"/>
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Hypotheses"><span class="tocnumber">1</span> <span class="toctext">仮説</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Normal_Approximation"><span class="tocnumber">2</span> <span class="toctext">正規近似</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#P_Value"><span class="tocnumber">2.1</span> <span class="toctext">P値</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Confidence_Interval"><span class="tocnumber">2.2</span> <span class="toctext">信頼区間</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="#Fisher.27s_Exact_Test"><span class="tocnumber">3</span> <span class="toctext">フィッシャーの正確確率検定</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#Exact_P_value"><span class="tocnumber">3.1</span> <span class="toctext">正確なP値</span></a></li>
</ul>
</li>
</ul>
</div>

<h3><a name="Hypotheses"></a><span class="mw-headline">仮説</span></h3>
<p><img src="../images/Algorithm_(Two_sample_proportion_test)/math-7b808e5178ceb5dc7d7cd3055dd492db.png" title="p_{1}\!" alt="p_{1}\!" class="tex"/>及び<img src="../images/Algorithm_(Two_sample_proportion_test)/math-7b808e5178ceb5dc7d7cd3055dd492db.png" title="p_{1}\!" alt="p_{1}\!" class="tex"/>は、サンプル1と2の真の母比率とし、<img src="../images/Algorithm_(Two_sample_proportion_test)/math-bd9eee3ffcc47aa2c4ff7032d9e24ee9.png" title="d_{0}\!" alt="d_{0}\!" class="tex"/>は母比率と仮説の差とします。
</p><p><img src="../images/Algorithm_(Two_sample_proportion_test)/math-c607e29efc94ad70d2c3c422748aaaff.png" title="H_0:p_{1}-p_{2}=d_{0}\!" alt="H_0:p_{1}-p_{2}=d_{0}\!" class="tex"/> 両側検定
</p><p><img src="../images/Algorithm_(Two_sample_proportion_test)/math-b34f0ce1b16f76275e5ca5bb2095309a.png" title="H_0:p_{1}-p_{2}\ge d_{0}\!" alt="H_0:p_{1}-p_{2}\ge d_{0}\!" class="tex"/> 片側検定
</p><p><img src="../images/Algorithm_(Two_sample_proportion_test)/math-eff4b11b5021a77c9b957a60ef7d7839.png" title="H_0:p_{1}-p_{2}\le d_{0}\!" alt="H_0:p_{1}-p_{2}\le d_{0}\!" class="tex"/> 片側検定
</p>
<h3><a name="Normal_Approximation"></a><span class="mw-headline">正規近似</span></h3>
<h4><a name="P_Value"></a><span class="mw-headline">P値</span></h4>
<p>仮説：<img src="../images/Algorithm_(Two_sample_proportion_test)/math-1ac2183e2b27a97935f0ce1eac821c81.png" title="x_{1}\ge10\!" alt="x_{1}\ge10\!" class="tex"/> および <img src="../images/Algorithm_(Two_sample_proportion_test)/math-7e77cc4bc8f9de81bd613971cca6bdbe.png" title="n_{1}-x_{1}\ge10\!" alt="n_{1}-x_{1}\ge10\!" class="tex"/>、<img src="../images/Algorithm_(Two_sample_proportion_test)/math-7db56eb2a970f6af0b5d2a8ec332adf9.png" title="x_{2}\ge10\!" alt="x_{2}\ge10\!" class="tex"/> および <img src="../images/Algorithm_(Two_sample_proportion_test)/math-9c47106b3141ec18de2b358627ea9010.png" title="n_{2}-x_{2}\ge10\!" alt="n_{2}-x_{2}\ge10\!" class="tex"/>により、正規近似検定を実行できます。
</p><p>検定を行うために、<img src="../images/Algorithm_(Two_sample_proportion_test)/math-814b9f64b478b6caf94e723a0e6814c5.png" title="z\!" alt="z\!" class="tex"/> と <img src="../images/Algorithm_(Two_sample_proportion_test)/math-c619dfb3f0ada810733c791d3e461ade.png" title=" p_{value}\!" alt=" p_{value}\!" class="tex"/>の値を計算します。
</p><p><img src="../images/Algorithm_(Two_sample_proportion_test)/math-a83acc8877291a1769abf9c63cac0c06.png" title="z=\frac{\tilde{p_{1}}-\tilde{p_{2}} -d_{0}}{\sqrt{\frac{\tilde{p_{1}}(1-\tilde{p_{1}})}{n_{1}}}+\frac{\tilde{p_{2}}(1-\tilde{p_{2}})}{n_{2}}}
\!" alt="z=\frac{\tilde{p_{1}}-\tilde{p_{2}} -d_{0}}{\sqrt{\frac{\tilde{p_{1}}(1-\tilde{p_{1}})}{n_{1}}}+\frac{\tilde{p_{2}}(1-\tilde{p_{2}})}{n_{2}}}
\!" class="tex"/> .
</p><p><img src="../images/Algorithm_(Two_sample_proportion_test)/math-2a3499732983c7813c587075c92c0990.png" title="d_{0} " alt="d_{0} " class="tex"/> が0になるような特殊な場合、Originでは、ダイアログで「検定にプールされたP値を使用」をチェックすることで、pを込みにした推定を使用できます。
</p><p><img src="../images/Algorithm_(Two_sample_proportion_test)/math-c8de0be6d90bda1b287888d08b796b4e.png" title="z=\frac{\tilde{p_{1}}-\tilde{p_{2}}}{\sqrt{\tilde{p_{0}}(1-\tilde{p_{0}})({\frac{1}{n_{1}}+ \frac{1}{n_{2}}}})}\!" alt="z=\frac{\tilde{p_{1}}-\tilde{p_{2}}}{\sqrt{\tilde{p_{0}}(1-\tilde{p_{0}})({\frac{1}{n_{1}}+ \frac{1}{n_{2}}}})}\!" class="tex"/>  
、ここで<img src="../images/Algorithm_(Two_sample_proportion_test)/math-581efaf63802fe89785cddcf19e96cb4.png" title="p_{0}=\frac{x_{1}+x_{2}}{n_{1}+n_{2}}" alt="p_{0}=\frac{x_{1}+x_{2}}{n_{1}+n_{2}}" class="tex"/>
</p><p>各仮説で、p値は以下のように与えられます。
</p><p><img src="../images/Algorithm_(Two_sample_proportion_test)/math-c607e29efc94ad70d2c3c422748aaaff.png" title="H_0:p_{1}-p_{2}=d_{0}\!" alt="H_0:p_{1}-p_{2}=d_{0}\!" class="tex"/>、<img src="../images/Algorithm_(Two_sample_proportion_test)/math-29f7013ed3172dc36f431f0b8482b50b.png" title="p_{value}=2P(Z_{1}\ge|z|)\!" alt="p_{value}=2P(Z_{1}\ge|z|)\!" class="tex"/>、 両側検定
</p><p><img src="../images/Algorithm_(Two_sample_proportion_test)/math-b34f0ce1b16f76275e5ca5bb2095309a.png" title="H_0:p_{1}-p_{2}\ge d_{0}\!" alt="H_0:p_{1}-p_{2}\ge d_{0}\!" class="tex"/>、<img src="../images/Algorithm_(Two_sample_proportion_test)/math-10a0f892ce645224d3e01a17f2e69302.png" title="p_{value}=P(Z_{1}\le z)\!" alt="p_{value}=P(Z_{1}\le z)\!" class="tex"/>、 上側検定
</p><p><img src="../images/Algorithm_(Two_sample_proportion_test)/math-eff4b11b5021a77c9b957a60ef7d7839.png" title="H_0:p_{1}-p_{2}\le d_{0}\!" alt="H_0:p_{1}-p_{2}\le d_{0}\!" class="tex"/>、<img src="../images/Algorithm_(Two_sample_proportion_test)/math-3bf80569261b1154f5d7acdf9d0f6cad.png" title="p_{value}=P(Z_{1}\ge z)\!" alt="p_{value}=P(Z_{1}\ge z)\!" class="tex"/>、 下側検定
</p>
<h4><a name="Confidence_Interval"></a><span class="mw-headline">信頼区間</span></h4>
<p>与えられた信頼度 <img src="../images/Algorithm_(Two_sample_proportion_test)/math-378df00d12056b404d7d02aef9d8650b.png" title="1-\alpha" alt="1-\alpha" class="tex"/> について、サンプルの比率における信頼区間は以下のようにして与えられます。
</p>
<table class="simple">
<tr>
<th>帰無仮説
</th>
<th>信頼区間
</th></tr>
<tr>
<td><img src="../images/Algorithm_(Two_sample_proportion_test)/math-c607e29efc94ad70d2c3c422748aaaff.png" title="H_0:p_{1}-p_{2}=d_{0}\!" alt="H_0:p_{1}-p_{2}=d_{0}\!" class="tex"/>
</td>
<td><img src="../images/Algorithm_(Two_sample_proportion_test)/math-ea62046992830b5407422a0bc50eb5e4.png" title="\left[(\tilde{p_{1}}-\tilde{p_{2}})- Z_{\frac{\alpha}{2}}\sqrt{\frac{\tilde{p_{1}}(1-\tilde{p_{1}})}{n_{1}}+ \frac{\tilde{p_{2}}(1-\tilde{p_{2}})}{n_{2}}}, (\tilde{p_{1}}-\tilde{p_{2}})+ Z_{\frac{\alpha}{2}}\sqrt{\frac{\tilde{p_{1}}(1-\tilde{p_{1}})}{n_{1}}+ \frac{\tilde{p_{2}}(1-\tilde{p_{2}})}{n_{2}}}\right]" alt="\left[(\tilde{p_{1}}-\tilde{p_{2}})- Z_{\frac{\alpha}{2}}\sqrt{\frac{\tilde{p_{1}}(1-\tilde{p_{1}})}{n_{1}}+ \frac{\tilde{p_{2}}(1-\tilde{p_{2}})}{n_{2}}}, (\tilde{p_{1}}-\tilde{p_{2}})+ Z_{\frac{\alpha}{2}}\sqrt{\frac{\tilde{p_{1}}(1-\tilde{p_{1}})}{n_{1}}+ \frac{\tilde{p_{2}}(1-\tilde{p_{2}})}{n_{2}}}\right]" class="tex"/>
</td></tr>
<tr>
<td><img src="../images/Algorithm_(Two_sample_proportion_test)/math-b34f0ce1b16f76275e5ca5bb2095309a.png" title="H_0:p_{1}-p_{2}\ge d_{0}\!" alt="H_0:p_{1}-p_{2}\ge d_{0}\!" class="tex"/>
</td>
<td><img src="../images/Algorithm_(Two_sample_proportion_test)/math-25f19502677d1d4ee361f6bceae2271a.png" title="\left[(\tilde{p_{1}}-\tilde{p_{2}})- Z_{\frac{\alpha}{2}}\sqrt{\frac{\tilde{p_{1}}(1-\tilde{p_{1}})}{n_{1}}+ \frac{\tilde{p_{2}}(1-\tilde{p_{2}})}{n_{2}}}, 1\right]" alt="\left[(\tilde{p_{1}}-\tilde{p_{2}})- Z_{\frac{\alpha}{2}}\sqrt{\frac{\tilde{p_{1}}(1-\tilde{p_{1}})}{n_{1}}+ \frac{\tilde{p_{2}}(1-\tilde{p_{2}})}{n_{2}}}, 1\right]" class="tex"/>
</td></tr>
<tr>
<td><img src="../images/Algorithm_(Two_sample_proportion_test)/math-eff4b11b5021a77c9b957a60ef7d7839.png" title="H_0:p_{1}-p_{2}\le d_{0}\!" alt="H_0:p_{1}-p_{2}\le d_{0}\!" class="tex"/>
</td>
<td><img src="../images/Algorithm_(Two_sample_proportion_test)/math-912083364694e7cf293a0a2b314d5ba2.png" title="\left[-1, (\tilde{p_{1}}-\tilde{p_{2}})+ Z_{\frac{\alpha}{2}}\sqrt{\frac{\tilde{p_{1}}(1-\tilde{p_{1}})}{n_{1}}+ \frac{\tilde{p_{2}}(1-\tilde{p_{2}})}{n_{2}}}\right]" alt="\left[-1, (\tilde{p_{1}}-\tilde{p_{2}})+ Z_{\frac{\alpha}{2}}\sqrt{\frac{\tilde{p_{1}}(1-\tilde{p_{1}})}{n_{1}}+ \frac{\tilde{p_{2}}(1-\tilde{p_{2}})}{n_{2}}}\right]" class="tex"/>
</td></tr></table>
<h3><a name="Fisher.27s_Exact_Test"></a><span class="mw-headline">フィッシャーの正確確率検定</span></h3>
<h4><a name="Exact_P_value"></a><span class="mw-headline">正確なP値</span></h4>
<p>フィッシャーの正確確率検定は、<img src="../images/Algorithm_(Two_sample_proportion_test)/math-a6b4ba4f8e6e0c7aa62a6321e42f50c5.png" title="d_{0} \!" alt="d_{0} \!" class="tex"/>が0であるときにすべてのサンプルサイズのために使用されます。
X= xのとき、超幾何分布の確率p（x）を表してみましょう。
</p><p><img src="../images/Algorithm_(Two_sample_proportion_test)/math-87ee7c011ddd771e42be5b24401b7b38.png" title="P(X=x)=\frac{\begin{pmatrix}x_{1}+x_{2} \\{x}\end{pmatrix}\begin{pmatrix}{n_{1}+n_{2}-x_{1}-x_{2}}\\{n_{1}-x}\end{pmatrix}}{\begin{pmatrix}{n_{1}+n_{2}}\\{n_{1}}\end{pmatrix}}" alt="P(X=x)=\frac{\begin{pmatrix}x_{1}+x_{2} \\{x}\end{pmatrix}\begin{pmatrix}{n_{1}+n_{2}-x_{1}-x_{2}}\\{n_{1}-x}\end{pmatrix}}{\begin{pmatrix}{n_{1}+n_{2}}\\{n_{1}}\end{pmatrix}}" class="tex"/>
</p><p>Mを超幾何分布モードで表します。<sub><img src="../images/Algorithm_(Two_sample_proportion_test)/math-a5c2eef81958cd52e29970d65dd26510.png" title="M=\left \lfloor \frac{(n_1+1)(x_1+x_2+1)}{n_1+n_2+2}\right \rfloor" alt="M=\left \lfloor \frac{(n_1+1)(x_1+x_2+1)}{n_1+n_2+2}\right \rfloor" class="tex"/></sub>
</p><p>各仮説で、p値は以下のように与えられます。
</p><p><img src="../images/Algorithm_(Two_sample_proportion_test)/math-e8e42b6377357ab28f8d67401a32dcbb.png" title="H_0:p_{1}\ge p_{2}\!" alt="H_0:p_{1}\ge p_{2}\!" class="tex"/>, <img src="../images/Algorithm_(Two_sample_proportion_test)/math-ac0d5ea358618a9ad75aa424e562381e.png" title="p_{value}=P(x\le x_{1})\!" alt="p_{value}=P(x\le x_{1})\!" class="tex"/>
</p><p><img src="../images/Algorithm_(Two_sample_proportion_test)/math-2d65f2eb45f1ed6987af501d89e0c698.png" title="H_0:p_{1}\le p_{2}\!" alt="H_0:p_{1}\le p_{2}\!" class="tex"/>, <img src="../images/Algorithm_(Two_sample_proportion_test)/math-11412e997c86e471799bb7527f8951e5.png" title="p_{value}=P(x\ge x_{1})\!" alt="p_{value}=P(x\ge x_{1})\!" class="tex"/>
</p><p><img src="../images/Algorithm_(Two_sample_proportion_test)/math-9bc36a86a3c356596eaded763aafa716.png" title="H_0:p_{1}= p_{2}\!" alt="H_0:p_{1}= p_{2}\!" class="tex"/>のとき 
</p><p><img src="../images/Algorithm_(Two_sample_proportion_test)/math-4291cab60dfd9a45d2b2e27ca563fd02.png" title="a:x_{1} &lt; M\!" alt="a:x_{1} &lt; M\!" class="tex"/>:
<img src="../images/Algorithm_(Two_sample_proportion_test)/math-1de87365a19dd27513e6b7373b9522d3.png" title="p_{value} = P(X\le x_{1}) + P(X\ge y)" alt="p_{value} = P(X\le x_{1}) + P(X\ge y)" class="tex"/>
</p><p>ここでyは、<img src="../images/Algorithm_(Two_sample_proportion_test)/math-a204b7185fc011518c001fd57d7c9a32.png" title="p(y) \le p(x_1)\!" alt="p(y) \le p(x_1)\!" class="tex"/>のような最小の整数<img src="../images/Algorithm_(Two_sample_proportion_test)/math-8fcaeb2e7c7c9d85baf692b14f25bba1.png" title="\ge M" alt="\ge M" class="tex"/>です。 
</p><p><img src="../images/Algorithm_(Two_sample_proportion_test)/math-60a92aacb57e6b5495c9d18453da11c8.png" title="b:x_{1} = M\!" alt="b:x_{1} = M\!" class="tex"/>
</p><p><img src="../images/Algorithm_(Two_sample_proportion_test)/math-76be9e9d8c2c9e081f9a0a4f75723372.png" title="p_{value} = 1.0\!" alt="p_{value} = 1.0\!" class="tex"/>
</p><p><img src="../images/Algorithm_(Two_sample_proportion_test)/math-1cc2cb9480b59d99e1d6d338f9348f95.png" title="c: x_1 &gt; M\!" alt="c: x_1 &gt; M\!" class="tex"/>
</p><p><img src="../images/Algorithm_(Two_sample_proportion_test)/math-242d0497051cf5e0c14dc7013dbeb161.png" title="p_{value} = P(X\ge x_{1}) + P(X\le y)" alt="p_{value} = P(X\ge x_{1}) + P(X\le y)" class="tex"/>
</p><p>ここでyは、<img src="../images/Algorithm_(Two_sample_proportion_test)/math-a204b7185fc011518c001fd57d7c9a32.png" title="p(y) \le p(x_1)\!" alt="p(y) \le p(x_1)\!" class="tex"/>のような最大の整数<img src="../images/Algorithm_(Two_sample_proportion_test)/math-cdc6f4e3821a03f2e3d5bff6b42afc7d.png" title="\le M" alt="\le M" class="tex"/>です。
</p>






    