<h1 class="firstheading">ボタン設定ダイアログボックス</h1><p class='urlname' style='display: none'>ButtonSetting-Dialog</p>
<p><br />
</p>
<dl><dd><dl><dd><a  class="image"><img alt="The Button Settings Dialog Box.png" src="../images/The_Button_Settings_Dialog_Box/The_Button_Settings_Dialog_Box.png" width="606"  /></a></dd></dl></dd></dl>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#The_File_Name_Text_Box"><span class="tocnumber">1</span> <span class="toctext">ファイル名テキストボックス</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#The_Section_Name_Text_Box"><span class="tocnumber">2</span> <span class="toctext">セクション名テキストボックス</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#The_Argument_List_Text_Box"><span class="tocnumber">3</span> <span class="toctext">引数リストテキストボックス</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#The_Tool_Tip_Text_and_Status_Bar_Text_Boxes"><span class="tocnumber">4</span> <span class="toctext">バルーンヘルプテキストとステータスバーテキスト</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#The_Context_Group"><span class="tocnumber">5</span> <span class="toctext">実行コンテキストグループ</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#LabTalk_Expression_to_enable"><span class="tocnumber">5.1</span> <span class="toctext">有効にするためのLabTalkの式</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#LabTalk_Variable_to_toggle:"><span class="tocnumber">5.2</span> <span class="toctext">LabTalkの変数を切り替える:</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Split_Buttons:_adding_a_drop-down_menu_to_a_button"><span class="tocnumber">5.3</span> <span class="toctext">ボタンの分割:ボタンにドロップダウンメニューを追加</span></a></li>
</ul>
</li>
</ul>
</div>
<h2><a name="The_File_Name_Text_Box"></a><span class="mw-headline">ファイル名テキストボックス</span></h2>
<p>ボタンをクリックした時に実行されるスクリプトを含むLabTalkスクリプトファイル名を指定します。組み込みスクリプトファイルまたは、自分や他のOriginユーザが作成したカスタムスクリプトファイルを指定できます。スクリプトファイルのフ拡張子は.OGSです。 
</p><p>スクリプトファイルは、セクションで構成されたテキストファイルです。各セクションは、角括弧で囲まれるセクション名で識別されます。以下は、Originソフトウェアにインストールされている.OGSファイルの1つのセクションです。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Filename:  Arrow.ogs</span>
<span style="color: #008000;">// Creation:  10/31/1996</span>
<span style="color: #008000;">// Purpose:  Script to be called from the Arrow toolbar</span>
<span style="color: #008000;">//////////////////////////////////////////////////////////////////</span>
<span style="color: #000000;">[</span>Horizontal<span style="color: #000000;">]</span>
select <span style="color: #000080;">-</span>toggle horz;
<span style="color: #000000;">[</span>Vertical<span style="color: #000000;">]</span>
select <span style="color: #000080;">-</span>toggle vert;</pre>
<table class="note">
<tr>
<td>
<p><b>Note:</b>サンプルのLabTalkスクリプトファイルを確認するには、
</p>
<ol><li> <b>ファイル：開く</b>を選択します。</li>
<li> <b>ファイルの種類</b>ドロップダウンリストから｢スクリプト (*.OGS)｣を選択します。</li>
<li> スクリプトファイルを選択します。</li>
<li> <b>開く</b>ボタンをクリックします。 </li></ol>
<p>例えば、ARROW.OGSを選択します。LabTalkエディタウィンドウにファイル内容が開きます。
</p>
</td></tr></table>
<h2><a name="The_Section_Name_Text_Box"></a><span class="mw-headline">セクション名テキストボックス</span></h2>
<p>セクション名テキストボックスには、ボタンをクリックした時に実行されるスクリプトを含むスクリプトファイルの<b>セクション名</b>(角括弧は含まず)を指定します。
</p><p>セクション名は、スクリプトファイルの中で角括弧で囲まれています。例えば、
</p>
<pre class="lt" style="font-family:monospace;"> <span style="color: #000000;">[</span>SectionName<span style="color: #000000;">]</span></pre>
<h2><a name="The_Argument_List_Text_Box"></a><span class="mw-headline">引数リストテキストボックス</span></h2>
<p>スクリプトに引数を渡すには、<b>引数リスト</b>テキストボックスに引数を入力します。
</p><p>スペースで区切れば最大5つの引数を渡すことができます。引数内のスペースは引用符または括弧で保護します。すべての引数はテキストとして渡され、スクリプトに渡される前にテキスト置換が発生します。
</p><p>サンプル (%A = &quot;myvar&quot; 、myvar = 3 としたとき)&nbsp;:
</p><p>&quot;one is the first&quot;&nbsp;%A $(%A) $(pi) (five is the fifth argument)
</p><p>これは、スクリプトに5つの文字列を渡し、次のように渡されます。
</p><p>&quot;one is the first&quot; &quot;myvar&quot; &quot;3&quot; &quot;3.14159&quot; &quot;five is the fifth argument&quot;
</p>
<h2><a name="The_Tool_Tip_Text_and_Status_Bar_Text_Boxes"></a><span class="mw-headline">バルーンヘルプテキストとステータスバーテキスト</span></h2>
<p>「バルーンヘルプ」と「ステータスバー」テキストボックスには、ボタン上にマウスカーソルを移動した時に現れるバルーンヘルプとステータスバーに表示するメッセージを指定します。
</p>
<h2><a name="The_Context_Group"></a><span class="mw-headline">実行コンテキストグループ</span></h2>
<p>指定したテンプレートから作成されたウィンドウがアクティブになった時、または指定したウィンドウタイプがアクティブになった時に、どのボタンを利用できるようにするかを指定することができます。 
</p>
<dl><dd><dl><dd><a  class="image"><img alt="Button settings context group.png" src="../images/The_Button_Settings_Dialog_Box/Button_settings_context_group.png" width="606"  /></a></dd></dl></dd></dl>
<p><br />
</p>
<h3><a name="LabTalk_Expression_to_enable"></a><span class="mw-headline">有効にするためのLabTalk式</span></h3>
<p>指定した変数またはテスト条件の値に基づいて、どのボタンを利用できるようにするかを指定することもできます。このためには、<b>有効にするためのLabTalk式</b>テキストボックスに変数名またはテスト条件を入力します。
</p><p>ボタンの可用性を判断するために、Originは最初にテンプレートとウィンドウタイプの制限をチェックします。ボタンがこれらの基準に合えば、Originは変数またはオブジェクトプロパティがボタンに関連付けられているかどうかを確認します。
</p>
<ul><li> <b>変数名</b>:<b>LabTalk式</b>テキストボックスに変数を入力する場合、Originは、現在の変数の値をチェックします。現在の変数値がゼロ（0）の場合、Originはボタンを無効にします。そうでなければ、ボタンを有効にします。例えば、以下のように入力した場合</li></ul>
<p><b>wks.sel</b>
</p><p>...ワークシート上で選択がある場合は常に <a class="external text" href="../../LabTalk/LabTalk/Wks_(object).html"><b>wks.sel</b></a>がゼロ以外になり、ボタンが有効になります。 
</p>
<ul><li> <b>テスト条件</b>:<b>LabTalk式</b>テキストボックスにテスト条件が入力されている場合、Originは、そのテスト条件が偽(0)または真(0以外)のどちらであるかをチェックします。テスト条件が偽の場合は、Originはボタンを無効にします。テスト条件が真の場合は、ボタンを有効にします。例えば、以下のように入力した場合</li></ul>
<p><b>wks.sel</b> == <b>8</b>
</p><p>... ワークシートでデータの範囲が選択されると、この条件がTrueになり、ボタンが有効になります。
</p>
<h3><a name="LabTalk_Variable_to_toggle:"></a><span class="mw-headline">LabTalkの変数を切り替える</span></h3>
<p><b>切り替えのためのLabTalk変数</b>テキストボックスを使用して、さまざまなアイコンを使用してさまざまな状態を表示するボタンを作成できます。例えば、以下のように入力した場合
</p><p><b>state:3</b>
</p><p>...選択されたアイコンに加えて、3で四捨五入されたLabTalk変数<b>state</b> の値に基づいてビットマップに従った他の2つを使用します。
</p><p>特殊なケースとして、以下のように入力した場合
</p><p><b>state:1</b> または <b>state</b>
</p><p>...ボタンは「ボタンアップ」（押されていない）状態と「ボタンダウン」（押されている）状態を切り替えます。
</p><p>LabTalk変数<b>state</b>が定義されていない、または、値が欠損している場合はボタンは無効で、切り替えの変数は内部的に引数リスト最後の追加の引数として渡されます。
</p>
<h3><a name="Split_Buttons:_adding_a_drop-down_menu_to_a_button"></a><span class="mw-headline">ボタンの分割:ボタンにドロップダウンメニューを追加</span></h3>
<p>カスタムボタンは、上記の<b>state</b>変数で示したのと同様の構文で、変数<b>state</b>省略してドロップダウンボタンを表示できます。 
</p><p>たとえば、選択したカスタムボタンに6個のボタンのドロップダウンメニューを付けるには（<b>ボタン</b>の下のボタンをひとつ選択して<b>設定</b>をクリック）、次のように入力します。
</p><p><b>:6</b>
</p><p>...これを<b>切り替えのためのLabTalk変数</b>に入力します。6つのアイコン（現在のアイコンと、以降の5つのアイコン）を使用してドロップダウンリストを生成します。
</p>
<dl><dd><a  class="image"><img alt="Custom button drop-down menu.png" src="../images/The_Button_Settings_Dialog_Box/Custom_button_drop-down_menu.png" width="738"  /></a></dd></dl>




    