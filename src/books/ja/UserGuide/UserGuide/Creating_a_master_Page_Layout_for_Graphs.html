<h1 class="firstheading">グラフに適用するマスターページレイアウトの作成</h1><p class='urlname' style='display: none'>Master-Page-Layout</p>
<p><br />
グラフ全てに適用する注釈を簡単に作成するために、Originには<b>マスター項目</b> 機能があります。  プロジェクト内の指定したグラフやレイアウトに、カスタム背景、会社ロゴやラベル、画像などを適用するときに便利です。  
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Using_the_MASTER.OTPU_template"><span class="tocnumber">1</span><span class="toctext">MASTER.OTPUテンプレートを使う</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Control_Master_Item_display_and_export_at_the_graph_page_.28window.29_level"><span class="tocnumber">2</span><span class="toctext">マスター項目コントロールの表示とグラフページ（ウィンドウ）レベルでのエクスポート</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Adding_common_elements_to_an_MS_Word_or_PowerPoint_file"><span class="tocnumber">2.1</span><span class="toctext">MS WordまたはPowerPointファイルに共通要素を追加</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4"><a href="#Control_Master_Item_display_in_the_Origin_session_or_project"><span class="tocnumber">3</span><span class="toctext">Originセッションまたはプロジェクトでのマスター項目の表示制御</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Selectively_exclude_Master_Items_from_workspace.2C_export_or_print"><span class="tocnumber">4</span><span class="toctext">マスター項目をワークスペースから選択的に除外しエクスポートまたは印刷</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Additional_master_page_notes"><span class="tocnumber">5</span><span class="toctext">マスターページに関するその他の注意</span></a></li>
</ul>
</div>
<h2><a name="Using_the_MASTER.OTPU_template"></a><span class="mw-headline">MASTER.OTPUテンプレートを使う</span></h2>
<ol>
<li> メニューから<b>ファイル：新規作成：マスターページ</b> を選びます。<b>Master.otpu</b> テンプレートが開きます。
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Creating_a_master_Page_Layout_for_Graphs/Tip_icon.png" width="57"  border="0" /></td><td><p>このメニュー項目を選択したときにプロジェクトのルートフォルダにいない場合、プロジェクトルートフォルダに切り替えるか尋ねられます。 
<p><b>Note</b>: プロジェクトルートフォルダにマスターページがあると、マスターページと同じ寸法のグラフに、自動でマスター項目が表示されます。（Origin 2018b以降）マスターテンプレートがプロジェクトルートフォルダにない場合、既存のグラフに対しては、マスターテンプレートを作成または更新したとき、グラフウィンドウをアクティブにして<b>リフレッシュ</b>ボタンをクリックしてマスター項目を表示する必要があります。
</p>
</p></td></tr></table>
<p>マスターページウィンドウには次の情報が表示されます。
<br />
<a class="image"><img alt="Master Page window.png" src="../images/Creating_a_master_Page_Layout_for_Graphs/Master_Page_window.png" width="774"  /></a>
</p>
<li> マスターテンプレートを編集します。 
<ul><li> マスターページは他のグラフウィンドウで表示したいプロパティやオブジェクトのみを含みます。</li>
<li> Note: <b>マスターテンプレートを保存</b>ボタンの下に表示されるコメントは「非表示」で、グラフウィンドウには適用されません。</li></ul>
<li> <b>マスターテンプレートを保存</b>ボタンをクリックします。
<br />
<ul><li> 保存すると、<b>マスターテンプレート</b>が、 &quot;アクティブウィンドウ名&quot;.otpu という名前で<a class="external text" href="../../UserGuide/UserGuide/The_User_Files_Folder.html">User Filesフォルダ</a>に保存されます。<br />(例: &quot;C:\Users\<i>YourName</i>\Documents\OriginLab\User Files\Master.otpu&quot;)</li>
<li> 縦向きに切り替える<b>回転</b>ボタンをクリックすると、テンプレートのショートネームは<b>Portrait</b>になります。そして、<i><b>Portrait.otpu</b></i>を保存します。</li></ul>
</ol>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Creating_a_master_Page_Layout_for_Graphs/Tip_icon.png" width="57"  border="0" /></td><td><p>テキストツールを使用してプロジェクトやシステム情報を静的テキストオブジェクトとしてマスターテンプレートに追加することもできますが、再利用できるテンプレートを作成することが目的であるため、情報を「ソフトコーディング」したテキストラベルを検討してください。詳細は、以下のトピックを参照してください。
</p>
<ul><li> <a href="../../UserGuide/UserGuide/Linking_Text_Labels_to_Data_and_Variables.html#Substituting_Variable_Values_in_Text_Labels" title="ユーザガイド:テキストラベルを、データと変数にリンク">テキストトラベルの置換変数値</a></li>
<li> <a class="external text" href="../../LabTalk/LabTalk/String_registers.html">LabTalk 文字列レジスタ</a></li></ul>
</td></tr></table>
<h2><a name="Control_Master_Item_display_and_export_at_the_graph_page_.28window.29_level"></a><span class="mw-headline">マスター項目コントロールの表示とグラフページ（ウィンドウ）レベルでのエクスポート</span></h2>
<p>マスターテンプレートを設定すると、マスター項目は、デフォルトでOriginワークスペースにあるテンプレートと同じ寸法のすべてのグラフに表示されます。マスター項目はエクスポート、コピー、印刷時のグラフにも適用されます。 
</p><p>ワークスペース内でマスター項目を<i>表示せず</i>、エクスポート、コピー、印刷時にのみマスター項目を表示したい場合、グラフの作図の詳細ダイアログで無効にできます。
</p>
<ol><li><b>フォーマット: ページ</b>を選択してページレベルの作図の詳細ダイアログを開きます。  </li>
<li><b>表示指定</b>タブを開きます。  </li>
<li><b>マスター項目を使う</b>のチェックを外します。このマスター項目の無効の設定は、この<i>グラフページ限定</i>のものです。<b>マスター項目を使う</b>のチェックがついている他のページには効果がありません。</li></ol>
<h3><a name="Adding_common_elements_to_an_MS_Word_or_PowerPoint_file"></a><span class="mw-headline">MS WordまたはPowerPointファイルに共通要素を追加</span></h3>
<p><b>編集: ページコピー</b>は通常、Originグラフオブジェクトをクリップボードにコピーします。オブジェクトがMS Word文書に貼り付けられ、グラフオブジェクトをダブルクリックすると、グラフはOriginのOLEインスタンスで開き、編集できます。マスター項目がグラフに存在するとき、<b>編集: ページコピー</b>は、通常のグラフオブジェクトと異なり、画像オブジェクト(EMF)をクリップボードに置きます。 
</p><p>MS Word文書で編集可能なOriginのグラフオブジェクトが必要な場合は、<b>編集: ページコピー</b>操作の前に、作図の詳細の<b>マスター項目を使う</b>のチェックを外してください。あるいは、LabTalkシステム変数<a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#F.2CG"><b>@GMC = 1</b></a>を使用します。システム変数を使ってOriginのデフォルトの動作の設定についての詳細は、<a href="../../UserGuide/UserGuide/Customizing_Origin_using_System_Variables.html" title="ユーザガイド: システム変数を使ってOriginをカスタマイズ">システム変数を使ってOriginをカスタマイズ</a>を参照してください。
</p><p>同様に、Originの<a class="external text" href="../../Tutorial/Tutorial/Send_Graphs_to_PowerPoint.html"><b>PowerPointに送る</b></a>の機能でも、PowerPointプレゼンテーションにマスター項目のOLE埋め込みをサポートしていません。PowerPointプレゼンテーションのOriginグラフに共通要素を追加するには、以下の方法があります。
</p>
<ul><li> PowerPointの<a class="external text" href="https://support.office.com/en-us/article/what-is-a-slide-master-b9abb2a0-7aef-4257-a14e-4329c904da54" target="_blank"><b>スライドマスター</b></a>を作成してマスター項目を含める</li>
<li> Originから<b>PowerPointにグラフを送る</b>ときに選択できるマスター項目スライドを含む最小限のPowerPointファイルを作成する(<a class="external text" href="../../Tutorial/Tutorial/Send_Graphs_to_PowerPoint.html">スライドマスターの作成は必要ありません</a>)</li>
<li> <b>PowerPointにグラフを送る</b>の<b>グラフを画像として挿入</b> </li></ul>
<dl><dd><dl><dd><a class="image"><img alt="Send Graphs 2PPT as Pic.png" src="../images/Creating_a_master_Page_Layout_for_Graphs/Send_Graphs_2PPT_as_Pic.png" width="473"  /></a></dd></dl></dd></dl>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Creating_a_master_Page_Layout_for_Graphs/Tip_icon.png" width="57"  border="0" /></td><td><p>マスター項目と埋め込みグラフの同じ制限は、Originアプリの<a class="external text" href="https://www.originlab.com/fileExchange/details.aspx?fid=238" target="_blank"><b>Send Graphs to Word</b></a>および<a class="external text" href="https://www.originlab.com/fileExchange/details.aspx?fid=374" target="_blank"><b>Send Graphs to PowerPoint</b></a>にも適用されます。マスター項目を含むグラフを<b>埋め込みオブジェクト</b><i>でなく</i><b>画像</b>として挿入します。
</p></td></tr></table>
<h2><a name="Control_Master_Item_display_in_the_Origin_session_or_project"></a><span class="mw-headline">Originセッションまたはプロジェクトでのマスター項目の表示制御</span></h2>
<p>各グラフウィンドウで<b>マスター項目を使う</b>を無効にしなくても、Originセッションまたはプロジェクトで表示を制御することができます。これはワークスペース表示を切り替え、エクスポート、印刷時には影響を与えません（<b>Note</b>を参照）。
</p>
<ol><li> 任意のグラフウィンドウをアクティブにし、<b>表示: 表示様式: マスター項目の画面表示</b>のチェックを付けるとマスター項目が表示されます。</li>
<li> <b>表示: 表示様式: マスター項目の画面表示</b>のチェックを外すと、マスター項目が非表示になります。</li></ol>
<table class="note">
<tr>
<td>
<p><b>Notes:</b> 
</p>
<ul><li> アクティブグラフウィンドウの「作図の詳細(ページ)」ダイアログボックスで<b>マスター項目を使う</b>チェックボックスのチェックを外さないと、このメニューコマンドは利用できません。</li>
<li> <b>表示: 表示様式: マスター項目の画面表示</b>の設定はプロジェクトに保存されます。</li>
<li> <b>表示: 表示様式: マスター項目の画面表示</b>のチェックを外しても、グラフのコピー、印刷、エクスポート時にはマスター項目は非表示になりません。</li></ul>
</td></tr></table>
<h2><a name="Selectively_exclude_Master_Items_from_workspace.2C_export_or_print"></a><span class="mw-headline">マスター項目をワークスペースから選択的に除外しエクスポートまたは印刷</span></h2>
<p>ワークスペースおよびエクスポートまたは印刷ページでマスター項目を選択的に除外するメカニズムがあります。グラフページ上のすべてのオブジェクト(テキスト、描画、ボタンなど)には名前があります。この名前は、オブジェクトの<b>プロパティ</b>ダイアログの<b>プログラミング</b>タブで確認できます。 
</p><p>ワークスペースまたはページコピーおよびエクスポート時に特定のマスターページオブジェクトを表示<i>したくない</i>場合、オブジェクト名に&quot;NoExport&quot;を付加します（例: &quot;NoExport<i>ObjectName</i>&quot;）。
</p>
<dl><dd><a class="image"><img alt="Master items noExport.png" src="../images/Creating_a_master_Page_Layout_for_Graphs/Master_items_noExport.png" width="819"  /></a></dd></dl>
<h2><a name="Additional_master_page_notes"></a><span class="mw-headline">マスターページに関するその他の注意</span></h2>
<ul><li><b>Master.otpu</b>テンプレートを元にして作成したグラフを開くには、次のLabTalkスクリプトを使います。 </li></ul>
<pre class="lt" style="font-family:monospace;">win <span style="color: #000080;">-</span>t plot master Master;</pre>
<p>Note: このスクリプトはアクティブフォルダ内のマスターページウィンドウを開きます。アクティブフォルダがルートフォルダでない場合は、グラフウィンドウをそれぞれリフレッシュしてマスター項目を表示する必要があります。
</p>
<ul><li><b>ファイル：新規作成：マスターページ</b>  メニューを使ってマスターページウィンドウを開きますが、横向きがデフォルトです。縦向きのテンプレートを使用または保存したい場合、<b>回転</b>ボタンをクリックしてページ寸法を入れ替えます。また、ページショートネームが<b>Portrait</b>になり、このテンプレートを<i><b>Portrait.otpu</b></i>に保存できます。さらに、<b>ファイル：ページの設定</b>メニューを使って、グラフページの向きを変更することができます。</li></ul>
<ul><li>マスター項目は、テンプレートと同じ寸法のグラフページでのみ表示されます。<b>全グラフに寸法を適用</b>ボタンは、マスターテンプレートのページ寸法を同じ方向のグラフ全てに適用します。</li></ul>
<ul><li>レイアウトページウィンドウにマスター項目を含めることもできます。  デフォルトで、レイアウトページの<b>作図の詳細</b>ダイアログボックスの<b>マスター項目を使う</b>ボックスと<b>表示: 表示様式: マスター項目の画面表示</b>にはチェックがついています。</li></ul>

    