<h1 class="firstheading">ワークシートデータをXYZ形式に変換</h1><p class='urlname' style='display: none'>Convert-to-XYZ</p>
<p>第1行のXデータと第1列のYデータ(または<i>その逆</i>)で構成されている、一般的な3次元のスプレッドシートデータを用いて説明します。このような配置で、X座標値とY座標値が線形間隔である場合、3Dグラフを作成したり、行列データに対して他の分析を実行したりする最初のステップとして、データを<a href="../../UserGuide/UserGuide/Direct_Worksheet_to_Matrix_Conversion.html" title="ユーザガイド：ワークシートを行列に直接変換">ワークシートを行列に直接変換</a>できます。
</p>
<dl><dd><a  class="image"><img alt="W2xyz example source.png" src="../images/Convert_to_XYZ/W2xyz_example_source.png" width="396"  /></a></dd></dl>
<p>上図のように、XまたはYの間隔が<i>非線形</i>である場合、行列への<b>直接変換</b>を行うことはできません。2つの代替方法があります。
</p>
<ul><li> Xファンクション（<a class="external text" href="../../XFunction/X-Function/W2vm.html">w2vm</a>）を使用してデータを<a href="../../UserGuide/UserGuide/Creating_3D_and_Contour_Graphs_from_Virtual_Matrix.html" title="ユーザガイド:仮想行列から3Dおよび等高線グラフを作成する。">「仮想行列」</a>に変換します。</li>
<li> <b>XYZ形式に変換</b>メニューオプションを使用して、データをXYZ列形式に変換します。</li></ul>
<p><br />
<i><b>この機能を使用するには、</b></i>
</p>
<ol><li> ワークシートをアクティブにします。</li>
<li> <b>ワークシート：XYZ形式に変換...</b>をクリックします。</li></ol>
<p>すると、<b>w2xyz</b>ダイアログボックスが開きます。このダイアログは、<a class="external text" href="../../XFunction/X-Function/W2xyz.html">w2xyz</a> Xファンクションを使用します。
</p><p>ダイアログボックスの<b>変換オプション</b>項目で、元のデータの配列方法を次から指定できます。<b>列にわたるX</b>、<b>列にわたるY</b>、または<b>X、Yなし</b>（XとYの座標値が指定されておらず、Originが列と行のインデックスを使用する必要があることを意味します）Z値には数値またはテキスト（カテゴリデータも同様）を指定できるます。
</p>
<h2><a name="Dialog_Options"></a><span class="mw-headline">ダイアログオプション</span></h2>
<table class="dialogcontroltable">
<tr>
<th><b>再計算</b>
</th>
<td>
<p>結果の再計算の設定を変更します。
</p>
<ul><li><b>なし</b> </li>
<li><b>自動</b> </li>
<li><b>手動</b>  </li></ul>
<p>詳細情報は、 <a href="../../UserGuide/UserGuide/Recalculating_Analysis_Results.html" title="ユーザガイド：分析結果の再計算">分析結果の再計算</a>をご覧下さい。
</p>
</td></tr>
<tr>
<th>変換範囲
</th>
<td>
<p>オプションは、<b>ワークシート全体</b>（デフォルト）または<b>指定された範囲</b>です。<b>指定された範囲</b>オプションを使用すると、部分範囲を<b>入力</b>として定義できます（データを事前に選択するか、<a href="../../UserGuide/UserGuide/Specifying_Your_Input_Data.html#Using_the_interactive_range_selection_control" title="ユーザーガイド：入力データの指定">インタラクティブ範囲セレクタ</a>を使用します）。 
</p>
</td></tr>
<tr>
<th>入力ワークシート
</th>
<td>
<p><b>変換範囲</b>が<b>ワークシート全体</b>の場合に変換する入力ワークシートです。
</p><p>範囲の設定に関する詳細は、<a href="../../UserGuide/UserGuide/Specifying_Your_Input_Data.html" title="ユーザーガイド：入力データの指定">入力データを指定する</a>をご覧ください。
</p>
</td></tr>
<tr>
<th>入力
</th>
<td>
<p><b>変換範囲</b>が<b>指定された範囲</b>の場合に変換する入力範囲です。
</p><p>範囲の設定に関する詳細は、<a href="../../UserGuide/UserGuide/Specifying_Your_Input_Data.html" title="ユーザーガイド：入力データの指定">入力データを指定する</a>をご覧ください。
</p>
</td></tr>
<tr>
<th>データフォーマット
</th>
<td>
<p>ソースデータのフォーマット：
</p>
<dl><dd><ul><li><b>列にわたるX</b> </li></ul>
<dl><dd>Xの値が横方向にあります。 </dd></dl>
<ul><li><b>列にわたるY</b> </li></ul>
<dl><dd>Yの値が横方向にあります。 </dd></dl>
<ul><li><b>X、Yなし</b> </li></ul>
<dl><dd>ワークシートにX値やY値がない場合、このオプションを使用します。XとY座標として列と行インデックスが使用されます。 </dd></dl></dd></dl>
</td></tr>
<tr>
<th rowspan="2">X値の位置
</th>
<td>
<p><b><b>データフォーマット</b></b>が<b>列にわたるX</b>のとき利用可能です。 
</p>
<ul><li> <b>なし</b> </li></ul>
<dl><dd><dl><dd>ワークシートにX値がない場合、このオプションを使用します。列インデックスがX値として使用されます。 </dd></dl></dd></dl>
<ul><li> <b>ワークシートの最初のデータ行</b> </li></ul>
<dl><dd><dl><dd>第1データ行がX値の場合このオプションを使用します。 </dd></dl></dd></dl>
<ul><li> <b>列ラベル</b> </li></ul>
<dl><dd><dl><dd>列ラベル行がX値として使用されます。 </dd></dl></dd></dl>
<ul><li> <b>選択中の最初のデータ行</b></li></ul>
<dl><dd><dl><dd>選択中の第1データ行がX値このオプションを使用します。<b>変換範囲</b>が<b>指定された範囲</b>、</dd></dl></dd></dl>
</td></tr>
<tr>
<td>
<p><b><b>データフォーマット</b></b>が<b>列にわたるY</b>のとき利用可能です。 
</p>
<ul><li> <b>なし</b> </li></ul>
<dl><dd><dl><dd>ワークシートにX値がありません。列インデックスがX値として使用されます。 </dd></dl></dd></dl>
<ul><li> <b>ワークシートの最初のデータ列</b> </li></ul>
<dl><dd><dl><dd>第1データ列がX値の場合このオプションを使用します。 </dd></dl></dd></dl>
<ul><li> <b>選択中の最初のデータ列</b></li></ul>
<dl><dd><dl><dd>選択中の第1データ列がX値の場合このオプションを使用します。<b>変換範囲</b>が<b>指定された範囲</b>の場合に使用できます。</dd></dl></dd></dl>
</td></tr>
<tr>
<th rowspan="2">Y値の位置
</th>
<td>
<p><b><b>データフォーマット</b></b>が<b>列にわたるX</b>のとき利用可能です。 
</p>
<ul><li> <b>なし</b> </li></ul>
<dl><dd><dl><dd>ワークシートにY値がありません。列インデックスがY値として使用されます。 </dd></dl></dd></dl>
<ul><li> <b>ワークシートの最初のデータ列</b> </li></ul>
<dl><dd><dl><dd>第1データ列がY値の場合このオプションを使用します。 </dd></dl></dd></dl>
<ul><li> <b>選択中の最初のデータ列</b></li></ul>
<dl><dd><dl><dd>選択中の第1データ列がY値の場合このオプションを使用します。<b>変換範囲</b>が<b>指定された範囲</b>の場合に使用できます。</dd></dl></dd></dl>
</td></tr>
<tr>
<td>
<p><b><b>データフォーマット</b></b>が<b>列にわたるY</b>のとき利用可能です。
</p>
<ul><li> <b>なし</b> </li></ul>
<dl><dd><dl><dd>ワークシートにY値がありません。列インデックスがY値として使用されます。 </dd></dl></dd></dl>
<ul><li> <b>ワークシートの最初のデータ行</b> </li></ul>
<dl><dd><dl><dd>第1データ行がY値の場合このオプションを使用します。 </dd></dl></dd></dl>
<ul><li> <b>列ラベル</b> </li></ul>
<dl><dd><dl><dd>列ラベル行がY値として使用されます。 </dd></dl></dd></dl>
<ul><li> <b>選択中の最初のデータ行</b></li></ul>
<dl><dd><dl><dd>第1データ行がY値の場合このオプションを使用します。<b>変換範囲</b>が<b>指定された範囲</b>の場合に使用できます。</dd></dl></dd></dl>
</td></tr>
<tr>
<th>列ラベル
</th>
<td>
<p><b><b><b>X値の位置</b></b></b>または<b><b>Y値の位置</b></b>が、<b>列ラベル</b>に指定されている時に利用できます。XまたはY座標が入力されたラベル行を選択します。 
</p>
</td></tr>
<tr>
<th>欠損値の排除
</th>
<td>
<p>ワークシートから空の行と列を削除します。さらに、変換中にX、Y、またはZのいずれかの値が欠落している場合、ポイントは破棄されます。
</p>
</td></tr>
<tr>
<th>出力
</th>
<td>
<p>出力XYZ範囲のための3列を指定します。X、Y、Zデータを異なるシートやブックに出力することもできます。
</p><p>範囲制御についてはこちらを参照してください：<a class="external text" href="../../UserGuide/UserGuide/Output_Results.html">出力結果</a>
</p>
</td></tr></table>




    