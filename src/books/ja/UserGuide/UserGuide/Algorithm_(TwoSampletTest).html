<h1 class="firstheading">アルゴリズム(2群のt検定)</h1><p class='urlname' style='display: none'>tTest-TwoSample-Algorithm</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Test_Statistics"><span class="tocnumber">1</span>  <span class="toctext">検定統計量</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Confidence_Intervals"><span class="tocnumber">2</span> <span class="toctext">信頼区間</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Power_Analysis"><span class="tocnumber">3</span> <span class="toctext">検出力解析</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Reference"><span class="tocnumber">4</span> <span class="toctext">参考文献</span></a></li>
</ul>
</div>

<p>2群の t検定はスチューデントの<i>t</i>統計量と関連する確率を計算し、2つの標本の平均の差が<img src="../images/Algorithm_(TwoSampletTest)/math-12f3be74f7266e038bdf61eb68a6208c.png" title="\mu_d\,\!" alt="\mu_d\,\!" class="tex"/>に等しいかどうかを検定します(例：2つの平均が等しいかどうかを検定するにはその差が0、つまり<img src="../images/Algorithm_(TwoSampletTest)/math-590eba6400c9e4df07e0c234f91e4460.png" title="\mu_1-\mu_2=\mu_d=0\,\!" alt="\mu_1-\mu_2=\mu_d=0\,\!" class="tex"/>であるかどうかを検定します)。そして、仮説は次の形式をとります。
</p><p><img src="../images/Algorithm_(TwoSampletTest)/math-f67a81ef315f0c59070ef53cb50b3932.png" title="H_0:\mu_1-\mu_2=\mu_d\,\!" alt="H_0:\mu_1-\mu_2=\mu_d\,\!" class="tex"/>  Vs  <img src="../images/Algorithm_(TwoSampletTest)/math-5c09300d675833793616502094acaa0f.png" title="H_1:\mu_1-\mu_2 \ne \mu_d" alt="H_1:\mu_1-\mu_2 \ne \mu_d" class="tex"/>  <i>両側</i>
</p><p><img src="../images/Algorithm_(TwoSampletTest)/math-1fc800dcea3acfe50f9e90c310b1174a.png" title="H_0:\mu_1-\mu_2 \le \mu_d" alt="H_0:\mu_1-\mu_2 \le \mu_d" class="tex"/>  Vs  <img src="../images/Algorithm_(TwoSampletTest)/math-0fbc9ae55928f128a94afcf65c2c2e39.png" title="H_1:\mu_1-\mu_2 &gt; \mu_d" alt="H_1:\mu_1-\mu_2 &gt; \mu_d" class="tex"/>  <i>上側</i>
</p><p><img src="../images/Algorithm_(TwoSampletTest)/math-8d8812a65564ffde40d299d450d3de7f.png" title="H_0:\mu_1-\mu_2 \ge \mu_d" alt="H_0:\mu_1-\mu_2 \ge \mu_d" class="tex"/>  Vs  <img src="../images/Algorithm_(TwoSampletTest)/math-9a968e5033dd7110b7973529fa35c85d.png" title="H_1:\mu_1-\mu_2 &lt; \mu_d" alt="H_1:\mu_1-\mu_2 &lt; \mu_d" class="tex"/>   <i>下側</i>
</p>
<h3><a name="Test_Statistics"></a><span class="mw-headline">検定統計量</span></h3>
<p>標本サイズが<img src="../images/Algorithm_(TwoSampletTest)/math-d60f5062564e1ece65993038b62484fa.png" title="x_1\,\!" alt="x_1\,\!" class="tex"/>と<img src="../images/Algorithm_(TwoSampletTest)/math-9defdb27049cde0b5bdfd4e762a02d6b.png" title="x_2\,\!" alt="x_2\,\!" class="tex"/>、平均が<img src="../images/Algorithm_(TwoSampletTest)/math-8d88a43872d6db6535d8672a15f09ce2.png" title="n_1\,\!" alt="n_1\,\!" class="tex"/>と<img src="../images/Algorithm_(TwoSampletTest)/math-2f6fac59fce80e76d698bcf5ea77bab6.png" title="n_2\,\!" alt="n_2\,\!" class="tex"/>、分散が<img src="../images/Algorithm_(TwoSampletTest)/math-4ed789d5f6cd3fea302e306da621cb83.png" title="\mu_1\,\!" alt="\mu_1\,\!" class="tex"/>と<img src="../images/Algorithm_(TwoSampletTest)/math-917bb8defee48f460766703f23fc0822.png" title="\mu_2\,\!" alt="\mu_2\,\!" class="tex"/>である2つの独立した標本<img src="../images/Algorithm_(TwoSampletTest)/math-0c153418ac24896b413d1c3c8ad3e95c.png" title="\sigma_1^2\,\!" alt="\sigma_1^2\,\!" class="tex"/>と<img src="../images/Algorithm_(TwoSampletTest)/math-f94e0c3605e0ebe3aa890455f27416e5.png" title="\sigma_2^2\,\!" alt="\sigma_2^2\,\!" class="tex"/>が、2つの正規分布する母集団からそれぞれ得られたものだとすると、下記の式で表すことができます。
</p><p><img src="../images/Algorithm_(TwoSampletTest)/math-6dc73b5670604b65621d1ad70209c678.png" title="\bar{x}_1=\frac{1}{n_1}\sum_{j=1}^{n_1}x_{1j}" alt="\bar{x}_1=\frac{1}{n_1}\sum_{j=1}^{n_1}x_{1j}" class="tex"/>, <img src="../images/Algorithm_(TwoSampletTest)/math-06a309ba82fba50c69561e78b4ffdf7f.png" title="\bar{x}_2=\frac{1}{n_2}\sum_{j=1}^{n_2}x_{2j}" alt="\bar{x}_2=\frac{1}{n_2}\sum_{j=1}^{n_2}x_{2j}" class="tex"/>,
<img src="../images/Algorithm_(TwoSampletTest)/math-06931d63b90e0e6a6d7d81d64e149e48.png" title="s_1^2=\frac{1}{n_1-1}\sum_{j=1}^{n_1}{(x_{1j}-\bar{x}_1)^2}" alt="s_1^2=\frac{1}{n_1-1}\sum_{j=1}^{n_1}{(x_{1j}-\bar{x}_1)^2}" class="tex"/>, <img src="../images/Algorithm_(TwoSampletTest)/math-1ea85773f946cf6770cf4f76022e133d.png" title="s_2^2=\frac{1}{n_2-1}\sum_{j=1}^{n_2}{(x_{2j}-\bar{x}_2)^2}" alt="s_2^2=\frac{1}{n_2-1}\sum_{j=1}^{n_2}{(x_{2j}-\bar{x}_2)^2}" class="tex"/>
</p><p>ここで、<img src="../images/Algorithm_(TwoSampletTest)/math-875d0b783f9b167155a8f54a2c3f9e6a.png" title="\bar{x}_1\,\!" alt="\bar{x}_1\,\!" class="tex"/>と<img src="../images/Algorithm_(TwoSampletTest)/math-68dc9b353bc272e9d32196f5e30bff4e.png" title="\bar{x}_2\,\!" alt="\bar{x}_2\,\!" class="tex"/>は標本平均で、<img src="../images/Algorithm_(TwoSampletTest)/math-f963d3c66aa9a89e64a6db3d0dd63351.png" title="s_1^2\,\!" alt="s_1^2\,\!" class="tex"/>と<img src="../images/Algorithm_(TwoSampletTest)/math-8a65733320d52c6da4efeeb5888dba00.png" title="s_2^2\,\!" alt="s_2^2\,\!" class="tex"/>は標本分散です。そして、t 検定統計量を次の式で計算します。
</p><p>ここでは、等しい分散であると仮定され、それは<img src="../images/Algorithm_(TwoSampletTest)/math-3728dc0e9ed8d4ea6c77089a7c1bb2fb.png" title="\sigma_1^2=\sigma_2^2\,\!" alt="\sigma_1^2=\sigma_2^2\,\!" class="tex"/>になります。
</p><p>検定の統計量<i>t</i>は次のようになります。
</p><p><img src="../images/Algorithm_(TwoSampletTest)/math-8992dd1682d9d05a300c39478ada35f5.png" title="t=\frac{(\bar{x}_1-\bar{x}_2)-\mu_d}{s_p\sqrt{(1/n_1+1/n_2)}}" alt="t=\frac{(\bar{x}_1-\bar{x}_2)-\mu_d}{s_p\sqrt{(1/n_1+1/n_2)}}" class="tex"/>
</p><p>これは自由度 <img src="../images/Algorithm_(TwoSampletTest)/math-6350a1d09d381cb5b9c2420a49cec064.png" title="(v = n_1+n_2-2)" alt="(v = n_1+n_2-2)" class="tex"/> を持つt 分布であり、
</p><p><img src="../images/Algorithm_(TwoSampletTest)/math-49682ab10edeb0f5ed248d7195b85d78.png" title="s_p=\sqrt{\frac{(n_1-1)s_1^2+(n_2-1)s_2^2}{n_1+n_2-2}}" alt="s_p=\sqrt{\frac{(n_1-1)s_1^2+(n_2-1)s_2^2}{n_1+n_2-2}}" class="tex"/>
</p><p>は、2つの標本のプール分散です。
</p><p>等しい分散ではないと見なされる場合
</p><p>通常の2標本の <i>t</i>統計量は<i>t</i>分布ではないので、近似した検定の統計量<i>t&apos;</i>が使われます。
</p><p><img src="../images/Algorithm_(TwoSampletTest)/math-2f3931fdb28db4a39f9b7140cc965c81.png" title="t&apos;=\frac{(\bar{x}_1-\bar{x}_2)-\mu_d}{\sqrt{\frac{s_1^2}{n_1}+\frac{s_2^2}{n_2}}}" alt="t&apos;=\frac{(\bar{x}_1-\bar{x}_2)-\mu_d}{\sqrt{\frac{s_1^2}{n_1}+\frac{s_2^2}{n_2}}}" class="tex"/>
</p><p>そして、自由度<i>v</i>を持つ<i>t</i>分布が、<i>t&rsquo;</i>の分布の近似に使われます。
</p><p><img src="../images/Algorithm_(TwoSampletTest)/math-fdd079fbba82fc1bb066171f062bab57.png" title="v=\frac{(s_1^2/n_1+s_2^2/n_2)^2}{\frac{(s_1^2/n_1)^2}{n_1-1}+\frac{(s_2^2/n_2)^2}{n_2-1}}" alt="v=\frac{(s_1^2/n_1+s_2^2/n_2)^2}{\frac{(s_1^2/n_1)^2}{n_1-1}+\frac{(s_2^2/n_2)^2}{n_2-1}}" class="tex"/>
</p><p>限界値を持つ<i>t</i>の値を比較し、次の場合、帰無仮説<img src="../images/Algorithm_(TwoSampletTest)/math-806277203dedea2ed8321f6cbd465a54.png" title="H_0\,\!" alt="H_0\,\!" class="tex"/>を棄却します。
</p><p>両側検定：  <img src="../images/Algorithm_(TwoSampletTest)/math-dc78eff8d710d926c9d712cebdb408d0.png" title="|t| &gt; t_{\sigma/2}\,\!" alt="|t| &gt; t_{\sigma/2}\,\!" class="tex"/>;
</p><p>上側検定： <img src="../images/Algorithm_(TwoSampletTest)/math-b3c71dc9421063ffaf6de1641540a5d5.png" title="t &gt; t_\sigma\,\!" alt="t &gt; t_\sigma\,\!" class="tex"/>;
</p><p>下側検定： <img src="../images/Algorithm_(TwoSampletTest)/math-b3c0361ff553afb248a469861134f399.png" title="t &lt; -t_\sigma\,\!" alt="t &lt; -t_\sigma\,\!" class="tex"/>;
</p><p><i>p</i> 値もユーザ指定の有意水準, <img src="../images/Algorithm_(TwoSampletTest)/math-3ac6004d77c0cc0055e95c99b9dfd7e0.png" title="\sigma\,\!" alt="\sigma\,\!" class="tex"/>と比較され、その値は通常0.05が使われます。帰無仮説<img src="../images/Algorithm_(TwoSampletTest)/math-806277203dedea2ed8321f6cbd465a54.png" title="H_0\,\!" alt="H_0\,\!" class="tex"/>は、<img src="../images/Algorithm_(TwoSampletTest)/math-350fad5bdd3c28b92d7b6a076336a463.png" title="p &lt; \mu\,\!" alt="p &lt; \mu\,\!" class="tex"/>の場合棄却されます。
</p>
<h3><a name="Confidence_Intervals"></a><span class="mw-headline">信頼区間</span></h3>
<p>上側と下側<img src="../images/Algorithm_(TwoSampletTest)/math-45828455265148a331fe94e5c5175f93.png" title="(1-\sigma )\times 100\%" alt="(1-\sigma )\times 100\%" class="tex"/>の平均の相違に対する信頼水準<img src="../images/Algorithm_(TwoSampletTest)/math-32a17f0051e09406b2f689fa5f0bb2c5.png" title="(\mu_1 - \mu_2)\,\!" alt="(\mu_1 - \mu_2)\,\!" class="tex"/>は次のように計算されます。
</p><p>等しい分散であると見なされる場合
</p>
<table class="simple">
<tr>
<th>帰無仮説
</th>
<th>信頼区間
</th></tr>
<tr>
<td><img src="../images/Algorithm_(TwoSampletTest)/math-f67a81ef315f0c59070ef53cb50b3932.png" title="H_0:\mu_1-\mu_2=\mu_d\,\!" alt="H_0:\mu_1-\mu_2=\mu_d\,\!" class="tex"/>
</td>
<td><img src="../images/Algorithm_(TwoSampletTest)/math-35e508ffa325356798bfeb78b55c5162.png" title="\left[(\bar{x}_1-\bar{x}_2)- t_{\alpha/2}s_p\sqrt{\frac{1}{n_1}+\frac{1}{n_2}}, (\bar{x}_1-\bar{x}_2)+ t_{\alpha/2}s_p\sqrt{\frac{1}{n_1}+\frac{1}{n_2}}\right]" alt="\left[(\bar{x}_1-\bar{x}_2)- t_{\alpha/2}s_p\sqrt{\frac{1}{n_1}+\frac{1}{n_2}}, (\bar{x}_1-\bar{x}_2)+ t_{\alpha/2}s_p\sqrt{\frac{1}{n_1}+\frac{1}{n_2}}\right]" class="tex"/>
</td></tr>
<tr>
<td><img src="../images/Algorithm_(TwoSampletTest)/math-1fc800dcea3acfe50f9e90c310b1174a.png" title="H_0:\mu_1-\mu_2 \le \mu_d" alt="H_0:\mu_1-\mu_2 \le \mu_d" class="tex"/>
</td>
<td><img src="../images/Algorithm_(TwoSampletTest)/math-438038a816d1733a3f4947f61e539c61.png" title="\left[(\bar{x}_1-\bar{x}_2)- t_{\alpha}s_p\sqrt{\frac{1}{n_1}+\frac{1}{n_2}},  \infty\right]" alt="\left[(\bar{x}_1-\bar{x}_2)- t_{\alpha}s_p\sqrt{\frac{1}{n_1}+\frac{1}{n_2}},  \infty\right]" class="tex"/>
</td></tr>
<tr>
<td><img src="../images/Algorithm_(TwoSampletTest)/math-8d8812a65564ffde40d299d450d3de7f.png" title="H_0:\mu_1-\mu_2 \ge \mu_d" alt="H_0:\mu_1-\mu_2 \ge \mu_d" class="tex"/>
</td>
<td> <img src="../images/Algorithm_(TwoSampletTest)/math-043e91f03e23cf4cb47273b881ee6f02.png" title="\left[-\infty, (\bar{x}_1-\bar{x}_2)+ t_{\alpha}s_p\sqrt{\frac{1}{n_1}+\frac{1}{n_2}}\right]" alt="\left[-\infty, (\bar{x}_1-\bar{x}_2)+ t_{\alpha}s_p\sqrt{\frac{1}{n_1}+\frac{1}{n_2}}\right]" class="tex"/>
</td></tr></table>
<p>等しい分散ではないと見なされる場合
</p>
<table class="simple">
<tr>
<th>帰無仮説
</th>
<th>信頼区間
</th></tr>
<tr>
<td><img src="../images/Algorithm_(TwoSampletTest)/math-f67a81ef315f0c59070ef53cb50b3932.png" title="H_0:\mu_1-\mu_2=\mu_d\,\!" alt="H_0:\mu_1-\mu_2=\mu_d\,\!" class="tex"/>
</td>
<td><img src="../images/Algorithm_(TwoSampletTest)/math-1dc3a8412c3e70c868d0def30834cdfd.png" title="\left[(\bar{x}_1-\bar{x}_2)- t_{\alpha/2}\sqrt{\frac{s_1^2}{n_1}+\frac{s_2^2}{n_2}}, (\bar{x}_1-\bar{x}_2)+ t_{\alpha/2}\sqrt{\frac{s_1^2}{n_1}+\frac{s_2^2}{n_2}}\right]" alt="\left[(\bar{x}_1-\bar{x}_2)- t_{\alpha/2}\sqrt{\frac{s_1^2}{n_1}+\frac{s_2^2}{n_2}}, (\bar{x}_1-\bar{x}_2)+ t_{\alpha/2}\sqrt{\frac{s_1^2}{n_1}+\frac{s_2^2}{n_2}}\right]" class="tex"/>
</td></tr>
<tr>
<td><img src="../images/Algorithm_(TwoSampletTest)/math-1fc800dcea3acfe50f9e90c310b1174a.png" title="H_0:\mu_1-\mu_2 \le \mu_d" alt="H_0:\mu_1-\mu_2 \le \mu_d" class="tex"/>
</td>
<td> <img src="../images/Algorithm_(TwoSampletTest)/math-6317c80637d203c8b436ce4d361f825c.png" title="\left[(\bar{x}_1-\bar{x}_2)- t_{\alpha}\sqrt{\frac{s_1^2}{n_1}+\frac{s_2^2}{n_2}}, \infty\right]" alt="\left[(\bar{x}_1-\bar{x}_2)- t_{\alpha}\sqrt{\frac{s_1^2}{n_1}+\frac{s_2^2}{n_2}}, \infty\right]" class="tex"/>
</td></tr>
<tr>
<td><img src="../images/Algorithm_(TwoSampletTest)/math-8d8812a65564ffde40d299d450d3de7f.png" title="H_0:\mu_1-\mu_2 \ge \mu_d" alt="H_0:\mu_1-\mu_2 \ge \mu_d" class="tex"/>
</td>
<td> <img src="../images/Algorithm_(TwoSampletTest)/math-39eb7689ff8eaf4fc97f74a82869d201.png" title="\left[-\infty, (\bar{x}_1-\bar{x}_2)+ t_{\alpha}\sqrt{\frac{s_1^2}{n_1}+\frac{s_2^2}{n_2}}\right]" alt="\left[-\infty, (\bar{x}_1-\bar{x}_2)+ t_{\alpha}\sqrt{\frac{s_1^2}{n_1}+\frac{s_2^2}{n_2}}\right]" class="tex"/>
</td></tr></table>
<p><br />
ここで、<img src="../images/Algorithm_(TwoSampletTest)/math-f1004b741c7a8310ad2a3b7c0d726855.png" title="t_{\sigma/2}\,\!" alt="t_{\sigma/2}\,\!" class="tex"/>は自由度<i>v</i>を持つt-分布の限界値です。
</p>
<h3><a name="Power_Analysis"></a><span class="mw-headline">検出力解析</span></h3>
<p>2群の <i>t</i>検定の検出力は、その感度の測定です。検出力の計算に関する詳細なアルゴリズムについては、<a href="../../UserGuide/Category/Power_and_Sample_Size_(OriginPro_Only).html" title="カテゴリー：検出力とサンプルサイズ (OriginProのみ)">検出力とサンプルサイズ</a>ヘルプをご覧下さい。 
</p>
<h3><a name="Reference"></a><span class="mw-headline">参考文献</span></h3>
<p>2群のt検定の計算は、NAG関数<a class="external text" href="http://www.originlab.com/pdfs/nagcl09/manual/pdf/g07/g07cac.pdf" target="_blank">nag_2_sample_t_test (g07cac)</a>を使っています。アルゴリズムについての詳細は、対応するNAG文書を参照して下さい。
</p>






    