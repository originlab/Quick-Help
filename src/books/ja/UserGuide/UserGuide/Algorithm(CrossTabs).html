<h1 class="firstheading">アルゴリズム (クロス集計)<br /></h1>
<table id="toc" class="toc">
<tr>
<td>
<div id="toctitle">
<h2>目次</h2>
</div>
<ol>
<li class="toclevel-1 tocsection-1"><a href="#CrossTabs_Method"><span class="tocnumber">1</span> <span class="toctext">クロス集計の手法</span></a>
<ol>
<li class="toclevel-2 tocsection-2"><a href="#Frequency_Counts"><span class="tocnumber">1.1</span> <span class="toctext">度数カウント</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Marginal_and_Cell"><span class="tocnumber">1.2</span> <span class="toctext">周辺とセル</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Chi-Square_Statistics"><span class="tocnumber">1.3</span> <span class="toctext">カイ二乗統計</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Fisher.27s_Exact_Test"><span class="tocnumber">1.4</span> <span class="toctext">フィッシャーの正確確率検定</span></a>
<ol>
<li class="toclevel-3 tocsection-6"><a href="#one-Sided_test"><span class="tocnumber">1.4.1</span> <span class="toctext">片側検定</span></a></li>
<li class="toclevel-3 tocsection-7"><a href="#Two-Sided_tail"><span class="tocnumber">1.4.2</span> <span class="toctext">両側</span></a></li>
</ol>
</li>
<li class="toclevel-2 tocsection-8"><a href="#Measures_of_Association"><span class="tocnumber">1.5</span> <span class="toctext">関連性の尺度</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Measures_of_Agreement"><span class="tocnumber">1.6</span> <span class="toctext">一致性の尺度</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Odds_Ratio_and_Relative_Risk"><span class="tocnumber">1.7</span> <span class="toctext">オッズ比と相対危険度</span></a>
<ol>
<li class="toclevel-3 tocsection-11"><a href="#Odds_Ratio"><span class="tocnumber">1.7.1</span> <span class="toctext">オッズ比</span></a></li>
<li class="toclevel-3 tocsection-12"><a href="#Relative_Risk"><span class="tocnumber">1.7.2</span> <span class="toctext">相対危険度</span></a></li>
</ol>
</li>
<li class="toclevel-2 tocsection-13"><a href="#Cochran-Mantel-Haenszel"><span class="tocnumber">1.8</span> <span class="toctext">Cochran-Mantel-Haenszel</span></a>
<ol>
<li class="toclevel-3 tocsection-14"><a href="#Mantel-Haenszel_statistic"><span class="tocnumber">1.8.1</span> <span class="toctext">Mantel-Haenszel 統計</span></a></li>
<li class="toclevel-3 tocsection-15"><a href="#Breslow-Day_statistic"><span class="tocnumber">1.8.2</span> <span class="toctext">Breslow-Day 統計</span></a></li>
<li class="toclevel-3 tocsection-16"><a href="#Tarone.E2.80.99s_Statistic"><span class="tocnumber">1.8.3</span> <span class="toctext">タローンの統計</span></a></li>
<li class="toclevel-3 tocsection-17"><a href="#Common_Odds_Ratio"><span class="tocnumber">1.8.4</span> <span class="toctext">共通オッズ比</span></a></li>
</ol>
</li>
</ol>
</li>
</ol>
</td>
</tr>
</table>
<p><br /></p>
<p><b style="font-weight: bold;">クロス集計</b>は、<b>分割表</b>とも呼ばれます。この機能は、変数間の関連の存在や強さを確かめるために使用されます。</p>
<h2><a name="CrossTabs_Method" id="CrossTabs_Method"></a><span class="mw-headline">クロス集計の手法</span></h2>
<ul>
<li>度数カウント</li>
<li>周辺とセル</li>
<li>カイ二乗検定表</li>
<li>フィッシャーの正確確率検定 (2 x 2のみ)</li>
<li>関連性の尺度</li>
<li>一致性の尺度</li>
<li>オッズ比と相対危険度 (2 x 2のみ)</li>
<li>Cochran-Mantel-Haenszel</li>
</ul>
<h3><a name="Frequency_Counts" id="Frequency_Counts"></a><span class="mw-headline">度数カウント</span></h3>
<p>定義</p>
<dl>
<dd><img src="../images/Algorithm(CrossTabs)/math-a97118fb9e8d7e006a466bfc0771f888.png" title="X_i" alt="X_i" class="tex" border="0" /> は昇順の行変数の明確な値で、たとえば、<img src="../images/Algorithm(CrossTabs)/math-afa34668ee4178285b425ccef9790f80.png" title="X_1 &lt; X_2 &lt; \cdots X_R " alt="X_1 &lt; X_2 &lt; \cdots X_R " class="tex" border="0" /></dd>
<dd><img src="../images/Algorithm(CrossTabs)/math-762c0f38c71ffa6e93f0a1daab55ab04.png" title="Y_i" alt="Y_i" class="tex" border="0" /> は昇順の列変数の明確な値で、たとえば、<img src="../images/Algorithm(CrossTabs)/math-443ff437c68afb202ac14bf0d0046751.png" title="Y_1 &lt; Y_2 &lt; \cdots Y_C " alt="Y_1 &lt; Y_2 &lt; \cdots Y_C " class="tex" border="0" /></dd>
<dd><img src="../images/Algorithm(CrossTabs)/math-e5896e2e0b803ed74e0a3ee9ec61d795.png" title="f_{ij}" alt="f_{ij}" class="tex" border="0" /> はセル <img src="../images/Algorithm(CrossTabs)/math-5270ae675fac24f97e172dcd9b18fa92.png" title="(i,j)" alt="(i,j)" class="tex" border="0" /> についての度数</dd>
<dd><img src="../images/Algorithm(CrossTabs)/math-1915a32e0c91c1f84a3056a294c65d30.png" title="r_i = \sum_{j=1}^{C}f_{ij}" alt="r_i = \sum_{j=1}^{C}f_{ij}" class="tex" border="0" /> は <img src="../images/Algorithm(CrossTabs)/math-865c0c0b4ab0e063e5caa3387c1a8741.png" title="i" alt="i" class="tex" border="0" /> 番目の行の小計</dd>
<dd><img src="../images/Algorithm(CrossTabs)/math-be38e302d77e59345377566d7423034c.png" title="c_j = \sum_{i=1}^{R}f_{ij}" alt="c_j = \sum_{i=1}^{R}f_{ij}" class="tex" border="0" /> は <img src="../images/Algorithm(CrossTabs)/math-363b122c528f54df4a0446b6bab05515.png" title="j" alt="j" class="tex" border="0" /> 番目の列の小計</dd>
<dd><img src="../images/Algorithm(CrossTabs)/math-886246e4a3101263e1138e72bfc977e6.png" title="N = \sum_{j=1}^{C}c_j = \sum_{i=1}^{R}r_i" alt="N = \sum_{j=1}^{C}c_j = \sum_{i=1}^{R}r_i" class="tex" border="0" /> は総計</dd>
</dl>
<h3><a name="Marginal_and_Cell" id="Marginal_and_Cell"></a><span class="mw-headline">周辺とセル</span></h3>
<table class="simple">
<tr>
<th>統計</th>
<th>式および説明</th>
</tr>
<tr>
<th>度数</th>
<td><img src="../images/Algorithm(CrossTabs)/math-e5896e2e0b803ed74e0a3ee9ec61d795.png" title="f_{ij}" alt="f_{ij}" class="tex" border="0" /></td>
</tr>
<tr>
<th>期待度数</th>
<td><img src="../images/Algorithm(CrossTabs)/math-f30a2b0e3370f0814c959957a224dd89.png" title="E_{ij} = \frac{r_i c_j}{N}" alt="E_{ij} = \frac{r_i c_j}{N}" class="tex" border="0" /></td>
</tr>
<tr>
<th>行パーセント</th>
<td><img src="../images/Algorithm(CrossTabs)/math-19639d8682c50097fbde98f448d6a16a.png" title="100*\frac{f_{ij}}{r_i}" alt="100*\frac{f_{ij}}{r_i}" class="tex" border="0" /></td>
</tr>
<tr>
<th>列パーセント</th>
<td><img src="../images/Algorithm(CrossTabs)/math-589eb80e404ec249dc486616aaf78822.png" title="100*\frac{f_{ij}}{c_j}" alt="100*\frac{f_{ij}}{c_j}" class="tex" border="0" /></td>
</tr>
<tr>
<th>合計パーセント</th>
<td><img src="../images/Algorithm(CrossTabs)/math-3357da1c1efa26e265b977d3b0670c1c.png" title="100*\frac{f_{ij}}{N}" alt="100*\frac{f_{ij}}{N}" class="tex" border="0" /></td>
</tr>
<tr>
<th>残差</th>
<td><img src="../images/Algorithm(CrossTabs)/math-56959063ec3204d0aeeae97829b457f3.png" title="R_{ij} = f_{ij} - E_{ij}" alt="R_{ij} = f_{ij} - E_{ij}" class="tex" border="0" /></td>
</tr>
<tr>
<th>標準化残差</th>
<td><img src="../images/Algorithm(CrossTabs)/math-c48259c9651c2f6503d9960937e6533e.png" title="StdR_{ij} = \frac{R_{ij}}{\sqrt{E_{ij}}}" alt="StdR_{ij} = \frac{R_{ij}}{\sqrt{E_{ij}}}" class="tex" border="0" /></td>
</tr>
<tr>
<th>調整済み残差</th>
<td><img src="../images/Algorithm(CrossTabs)/math-c0843832a859ffc34d11d9099f6428b0.png" title="AdjR_{ij} = \frac{R_{ij}}{\sqrt{E_{ij}\left(1-\frac{r_i}{N}\right)\left(1-\frac{c_j}{N}\right)}}" alt="AdjR_{ij} = \frac{R_{ij}}{\sqrt{E_{ij}\left(1-\frac{r_i}{N}\right)\left(1-\frac{c_j}{N}\right)}}" class="tex" border="0" /></td>
</tr>
</table>
<h3><a name="Chi-Square_Statistics" id="Chi-Square_Statistics"></a><span class="mw-headline">カイ二乗統計</span></h3>
<table class="simple">
<tr>
<th>統計</th>
<th>式および説明</th>
<th>自由度</th>
</tr>
<tr>
<th>ピアソンのカイ二乗</th>
<td><img src="../images/Algorithm(CrossTabs)/math-16abb82ca7492ebc6d92c48f3cb57156.png" title="\chi_p^2 = \sum_{ij} \frac{(f_{ij}-E_{ij})^2}{E_{ij}}" alt="\chi_p^2 = \sum_{ij} \frac{(f_{ij}-E_{ij})^2}{E_{ij}}" class="tex" border="0" /></td>
<td><img src="../images/Algorithm(CrossTabs)/math-457e064382dbfc17fa5acc98b7037504.png" title="(R-1)(C-1)" alt="(R-1)(C-1)" class="tex" border="0" /></td>
</tr>
<tr>
<th>尤度比</th>
<td><img src="../images/Algorithm(CrossTabs)/math-5711c9b4ed36c6b98d89fb52d062fc0a.png" title="\chi_{LR}^2 = -2\sum_{ij} f_{ij} \ln (E_{ij}/f_{ij})" alt="\chi_{LR}^2 = -2\sum_{ij} f_{ij} \ln (E_{ij}/f_{ij})" class="tex" border="0" /></td>
<td><img src="../images/Algorithm(CrossTabs)/math-457e064382dbfc17fa5acc98b7037504.png" title="(R-1)(C-1)" alt="(R-1)(C-1)" class="tex" border="0" /></td>
</tr>
<tr>
<th>線形関連</th>
<td><img src="../images/Algorithm(CrossTabs)/math-3f74d84e50dc6faa63daef4080aacb1d.png" title="\chi_{LA}^2 = (N-1)r^2" alt="\chi_{LA}^2 = (N-1)r^2" class="tex" border="0" />, ここで <img src="../images/Algorithm(CrossTabs)/math-4b43b0aee35624cd95b910189b3dc231.png" title="r" alt="r" class="tex" border="0" /> はピアソンの相関係数</td>
<td><img src="../images/Algorithm(CrossTabs)/math-c4ca4238a0b923820dcc509a6f75849b.png" title="1" alt="1" class="tex" border="0" /></td>
</tr>
<tr>
<th>連続補正</th>
<td><img src="../images/Algorithm(CrossTabs)/math-229934e6de0b77d0cfb90e85aa101495.png" title="\chi_C^2 = \frac{N(|f_{11}f_{22}-f_{12}f_{21}|-0.5N)^2}{r_1r_2c_1c_2} I(|f_{11}f_{22}-f_{12}f_{21}|&gt;0.5N)" alt="\chi_C^2 = \frac{N(|f_{11}f_{22}-f_{12}f_{21}|-0.5N)^2}{r_1r_2c_1c_2} I(|f_{11}f_{22}-f_{12}f_{21}|&gt;0.5N)" class="tex" border="0" />, これは 2 x 2 表でのみ計算</td>
<td><img src="../images/Algorithm(CrossTabs)/math-c4ca4238a0b923820dcc509a6f75849b.png" title="1" alt="1" class="tex" border="0" /></td>
</tr>
</table>
<h3><a name="Fisher.27s_Exact_Test" id="Fisher.27s_Exact_Test"></a><span class="mw-headline">フィッシャーの正確確率検定</span></h3>
<p>この検定は、期待セル度数が低い(5よりも低い)とき便利です。2 x 2 表でのみ計算されます。次のような表を考えます。</p>
<table class="simple">
<tr>
<th>&#160;</th>
<th><img src="../images/Algorithm(CrossTabs)/math-0d5fa3f335333b23d4aaf795d1336587.png" title="X_1" alt="X_1" class="tex" border="0" /></th>
<th><img src="../images/Algorithm(CrossTabs)/math-e209e24a3d42a840c21481572570342f.png" title="X_2" alt="X_2" class="tex" border="0" /></th>
<th>小計/合計</th>
</tr>
<tr>
<th><img src="../images/Algorithm(CrossTabs)/math-c772000136f6d3ba6dec3c7c5a35458b.png" title="Y_1" alt="Y_1" class="tex" border="0" /></th>
<td><img src="../images/Algorithm(CrossTabs)/math-6c773b2b7798e5713845e475d0c4b4c7.png" title="n_1" alt="n_1" class="tex" border="0" /></td>
<td><img src="../images/Algorithm(CrossTabs)/math-5967eff521c650a997f82f083abf639a.png" title="n_3" alt="n_3" class="tex" border="0" /></td>
<td><img src="../images/Algorithm(CrossTabs)/math-6657a6c206f3e5e31275783a3668e5de.png" title="n_1+n_3" alt="n_1+n_3" class="tex" border="0" /></td>
</tr>
<tr>
<th><img src="../images/Algorithm(CrossTabs)/math-b5825a6794db70d759fd6fa7eb747fd7.png" title="Y_2" alt="Y_2" class="tex" border="0" /></th>
<td><img src="../images/Algorithm(CrossTabs)/math-e501ae2ad90dc374410a774da21c5739.png" title="n_2" alt="n_2" class="tex" border="0" /></td>
<td><img src="../images/Algorithm(CrossTabs)/math-43c5783d36b015e36edeecd60da73206.png" title="n_4" alt="n_4" class="tex" border="0" /></td>
<td><img src="../images/Algorithm(CrossTabs)/math-4d19d3c0c698ba1ab821a9d391ae4fac.png" title="n_2+n_4" alt="n_2+n_4" class="tex" border="0" /></td>
</tr>
<tr>
<th>小計/合計</th>
<td><img src="../images/Algorithm(CrossTabs)/math-f16c4024084f71bae29d858ad345502b.png" title="n_1+n_2" alt="n_1+n_2" class="tex" border="0" /></td>
<td><img src="../images/Algorithm(CrossTabs)/math-7f53026eedc310e75b8bfbaafcc98e9d.png" title="n_3+n_4" alt="n_3+n_4" class="tex" border="0" /></td>
<td><img src="../images/Algorithm(CrossTabs)/math-8d9c307cb7f3c4a32822a51922d1ceaa.png" title="N" alt="N" class="tex" border="0" /></td>
</tr>
</table>
<p>帰無仮説(独立)下で、最初のセル<img src="../images/Algorithm(CrossTabs)/math-865adb153c19640c27383f3fc1ee7e8a.png" title="N_1" alt="N_1" class="tex" border="0" />の度数は、以下で与えられる確率の超幾何分布です。</p>
<p><img src="../images/Algorithm(CrossTabs)/math-b81fe4db9d9ce8c9e4d200ced42c19c9.png" title="Pr(N_1=n_1) = \frac{(n_1+n_2)!(n_3+n_4)!(n_1+n_3)!(n_2+n_4)!}{N!n_1!n_2!n_3!n_4!}" alt="Pr(N_1=n_1) = \frac{(n_1+n_2)!(n_3+n_4)!(n_1+n_3)!(n_2+n_4)!}{N!n_1!n_2!n_3!n_4!}" class="tex" border="0" />, <img src="../images/Algorithm(CrossTabs)/math-10def7f70d948d677a406c91c82bf307.png" title="\max(0,n_1-n_4)\leq N_1 \leq \min(n_1+n_2,n_1+n_3)" alt="\max(0,n_1-n_4)\leq N_1 \leq \min(n_1+n_2,n_1+n_3)" class="tex" border="0" />.</p>
<h4><a name="one-Sided_test" id="one-Sided_test"></a><span class="mw-headline">片側検定</span></h4>
<p>片側検定の有意水準は以下で計算されます。</p>
<dl>
<dd>p(左片側検定) =<img src="../images/Algorithm(CrossTabs)/math-86e6e38543be7730a5d275879331853b.png" title=" Pr(N_1\leq n_1)" alt=" Pr(N_1\leq n_1)" class="tex" border="0" /></dd>
<dd>p(右片側検定) =<img src="../images/Algorithm(CrossTabs)/math-a0da9ea8cfd87134a3bc676fc188f06e.png" title=" Pr(N_1\geq n_1)" alt=" Pr(N_1\geq n_1)" class="tex" border="0" /></dd>
</dl>
<h4><a name="Two-Sided_tail" id="Two-Sided_tail"></a><span class="mw-headline">両側</span></h4>
<p>両側の有意性は</p>
<p><img src="../images/Algorithm(CrossTabs)/math-26774c9dfcd5e97bc46f921e5d961bc3.png" title="p_2 = p_1 + p_3" alt="p_2 = p_1 + p_3" class="tex" border="0" /></p>
<p>ここで</p>
<dl>
<dd><img src="../images/Algorithm(CrossTabs)/math-ad6e799464206e320a500025fbb12f7f.png" title="n_{1}\leq (n_{1}+n_{2})(n_{1}+n_{3})/N" alt="n_{1}\leq (n_{1}+n_{2})(n_{1}+n_{3})/N" class="tex" border="0" /> の場合 <img src="../images/Algorithm(CrossTabs)/math-81db1a1a7d204cda8eca78cd1626e9d0.png" title="p_{1}= Pr(N_1\leq n_1)" alt="p_{1}= Pr(N_1\leq n_1)" class="tex" border="0" /></dd>
</dl>
<dl>
<dd><img src="../images/Algorithm(CrossTabs)/math-dff4b325fc0edc3fc4cf9134afe80cd6.png" title="n_{1}&gt;(n_{1}+n_{2})(n_{1}+n_{3})/N" alt="n_{1}&gt;(n_{1}+n_{2})(n_{1}+n_{3})/N" class="tex" border="0" /> の場合 <img src="../images/Algorithm(CrossTabs)/math-e793456f33b630b6743c3e2532b86d9e.png" title="p_{1}= Pr(N_1\geq n_1)" alt="p_{1}= Pr(N_1\geq n_1)" class="tex" border="0" /></dd>
</dl>
<p><br /></p>
<dl>
<dd><img src="../images/Algorithm(CrossTabs)/math-fb4549dbe0388469b28f1e469e8dbccc.png" title="p_3 = \sum_{x:\text{ between }\min(n_1+n_2,n_1+n_3) \text{ and } (n_1+1); Pr(N_1=x) \leq Pr(N_1=n_1)} Pr(N_1=x)" alt="p_3 = \sum_{x:\text{ between }\min(n_1+n_2,n_1+n_3) \text{ and } (n_1+1); Pr(N_1=x) \leq Pr(N_1=n_1)} Pr(N_1=x)" class="tex" border="0" /></dd>
</dl>
<h3><a name="Measures_of_Association" id="Measures_of_Association"></a><span class="mw-headline">関連性の尺度</span></h3>
<p>定義</p>
<dl>
<dd><img src="../images/Algorithm(CrossTabs)/math-e1447424a87a72997354115e74f780d2.png" title="D_r = N^2 - \sum_{i=1}^{R}r_i^2" alt="D_r = N^2 - \sum_{i=1}^{R}r_i^2" class="tex" border="0" /></dd>
<dd><img src="../images/Algorithm(CrossTabs)/math-9a63691fc5e41c8da93b03ae0e8fc436.png" title="D_c = N^2 - \sum_{j=1}^{C}c_j^2" alt="D_c = N^2 - \sum_{j=1}^{C}c_j^2" class="tex" border="0" /></dd>
<dd><img src="../images/Algorithm(CrossTabs)/math-0bf9a641a2a2f9570c4874c60e4ff055.png" title="C_{ij} = \sum_{h&lt;i}\sum_{k&lt;j}f_{hk}+\sum_{h&gt;i}\sum_{k&gt;j}f_{hk}" alt="C_{ij} = \sum_{h&lt;i}\sum_{k&lt;j}f_{hk}+\sum_{h&gt;i}\sum_{k&gt;j}f_{hk}" class="tex" border="0" /></dd>
<dd><img src="../images/Algorithm(CrossTabs)/math-abe49e571496aef0ee9284532118e575.png" title="D_{ij} = \sum_{h&lt;i}\sum_{k&gt;j}f_{hk}+\sum_{h&gt;i}\sum_{k&lt;j}f_{hk}" alt="D_{ij} = \sum_{h&lt;i}\sum_{k&gt;j}f_{hk}+\sum_{h&gt;i}\sum_{k&lt;j}f_{hk}" class="tex" border="0" /></dd>
<dd><img src="../images/Algorithm(CrossTabs)/math-ae03d6a4fc3d6bde417a7352ed6c0d76.png" title="P = \sum_{ij}f_{ij}C_{ij}" alt="P = \sum_{ij}f_{ij}C_{ij}" class="tex" border="0" /></dd>
<dd><img src="../images/Algorithm(CrossTabs)/math-1306db1d8aedf83c64c23134dc6f6cce.png" title="Q = \sum_{ij}f_{ij}D_{ij}" alt="Q = \sum_{ij}f_{ij}D_{ij}" class="tex" border="0" /></dd>
<dd><img src="../images/Algorithm(CrossTabs)/math-1915a32e0c91c1f84a3056a294c65d30.png" title="r_i = \sum_{j=1}^{C}f_{ij}" alt="r_i = \sum_{j=1}^{C}f_{ij}" class="tex" border="0" /> は <img src="../images/Algorithm(CrossTabs)/math-865c0c0b4ab0e063e5caa3387c1a8741.png" title="i" alt="i" class="tex" border="0" /> 番目の行の小計</dd>
<dd><img src="../images/Algorithm(CrossTabs)/math-be38e302d77e59345377566d7423034c.png" title="c_j = \sum_{i=1}^{R}f_{ij}" alt="c_j = \sum_{i=1}^{R}f_{ij}" class="tex" border="0" /> は <img src="../images/Algorithm(CrossTabs)/math-363b122c528f54df4a0446b6bab05515.png" title="j" alt="j" class="tex" border="0" /> 番目の列の小計</dd>
<dd><img src="../images/Algorithm(CrossTabs)/math-886246e4a3101263e1138e72bfc977e6.png" title="N = \sum_{j=1}^{C}c_j = \sum_{i=1}^{R}r_i" alt="N = \sum_{j=1}^{C}c_j = \sum_{i=1}^{R}r_i" class="tex" border="0" /> は総計</dd>
</dl>
<table class="simple">
<tr>
<th colspan="2">統計</th>
<th>式および説明</th>
<th>標準誤差</th>
</tr>
<tr>
<th colspan="2">Phi 係数</th>
<td><img src="../images/Algorithm(CrossTabs)/math-ade4cff8aeb025b9cae15f35a2dcd46d.png" title="\phi = \sqrt{\chi_p^2/N}" alt="\phi = \sqrt{\chi_p^2/N}" class="tex" border="0" />, これは 2 x 2 表でないとき計算。2 x 2 表の場合 <img src="../images/Algorithm(CrossTabs)/math-4b43b0aee35624cd95b910189b3dc231.png" title="r" alt="r" class="tex" border="0" /> に等しい。
<p><img src="../images/Algorithm(CrossTabs)/math-ab68f1b76095c4fe09bbc55661bfa168.png" title="[0,M]" alt="[0,M]" class="tex" border="0" /> からの値の範囲, ここで <img src="../images/Algorithm(CrossTabs)/math-557fee2c06855d00673e05c0d165d00e.png" title="M = min(\sqrt{R-1},\sqrt{C-1})" alt="M = min(\sqrt{R-1},\sqrt{C-1})" class="tex" border="0" /></p>
</td>
<td>&#160;</td>
</tr>
<tr>
<th colspan="2">クラメールのV</th>
<td><img src="../images/Algorithm(CrossTabs)/math-32808fbdf779579250ced07a3b57f092.png" title="V = \sqrt{\frac{\chi_p^2}{N\min\{R,C\}}}" alt="V = \sqrt{\frac{\chi_p^2}{N\min\{R,C\}}}" class="tex" border="0" /></td>
<td>&#160;</td>
</tr>
<tr>
<th colspan="2">C係数</th>
<td><img src="../images/Algorithm(CrossTabs)/math-0512a20370c1a32d02c46e82c38d5767.png" title="CC = \sqrt{\frac{\chi_p^2}{\chi_p^2+N}}" alt="CC = \sqrt{\frac{\chi_p^2}{\chi_p^2+N}}" class="tex" border="0" /></td>
<td>&#160;</td>
</tr>
<tr>
<th colspan="2">ガンマ</th>
<td><img src="../images/Algorithm(CrossTabs)/math-ca54853c333dece226fd892c1471fca6.png" title="\gamma = \frac{P-Q}{P+Q}" alt="\gamma = \frac{P-Q}{P+Q}" class="tex" border="0" /></td>
<td><img src="../images/Algorithm(CrossTabs)/math-ceeab2bf0dfc9669dc3af396bdf3b9f0.png" title="\frac{2}{P+Q}\sqrt{\sum_{ij}f_{ij}(C_{ij}-D_{ij})^2-\frac{1}{N}(P-Q)^2}" alt="\frac{2}{P+Q}\sqrt{\sum_{ij}f_{ij}(C_{ij}-D_{ij})^2-\frac{1}{N}(P-Q)^2}" class="tex" border="0" /></td>
</tr>
<tr>
<th rowspan="2">ケンドール</th>
<td>タウb</td>
<td><img src="../images/Algorithm(CrossTabs)/math-d483a07e25f428eae9e524345b1f6097.png" title="\tau_b = \frac{P-Q}{\sqrt{D_rD_c}}" alt="\tau_b = \frac{P-Q}{\sqrt{D_rD_c}}" class="tex" border="0" /></td>
<td><img src="../images/Algorithm(CrossTabs)/math-e06a2ae207bc0f4367248d2f7795410b.png" title="2\sqrt{\frac{1}{D_rD_c}\left[\sum_{ij}f_{ij}(C_{ij}-D_{ij})^2-\frac{1}{N}(P-Q)^2\right]}" alt="2\sqrt{\frac{1}{D_rD_c}\left[\sum_{ij}f_{ij}(C_{ij}-D_{ij})^2-\frac{1}{N}(P-Q)^2\right]}" class="tex" border="0" /></td>
</tr>
<tr>
<td>タウc</td>
<td><img src="../images/Algorithm(CrossTabs)/math-bf85650ad481dd12febaf1005608bac6.png" title="\tau_c = \frac{(P-Q)q}{N^2(q-1)}" alt="\tau_c = \frac{(P-Q)q}{N^2(q-1)}" class="tex" border="0" />, ここで <img src="../images/Algorithm(CrossTabs)/math-0d910548fc627e702b2e9d398eeed3bc.png" title="q = \min\{R,C\}" alt="q = \min\{R,C\}" class="tex" border="0" /></td>
<td><img src="../images/Algorithm(CrossTabs)/math-423d45130bb7e6a7741ed999591467b1.png" title="\frac{2q}{N^2(q-1)}\sqrt{\sum_{ij}f_{ij}(C_{ij}-D_{ij})^2-\frac{1}{N}(P-Q)^2}" alt="\frac{2q}{N^2(q-1)}\sqrt{\sum_{ij}f_{ij}(C_{ij}-D_{ij})^2-\frac{1}{N}(P-Q)^2}" class="tex" border="0" /></td>
</tr>
<tr>
<th rowspan="3">SomersのD</th>
<td>C<img src="../images/Algorithm(CrossTabs)/math-b99834bc19bbad24580b3adfa04fb947.png" title="|" alt="|" class="tex" border="0" />R</td>
<td><img src="../images/Algorithm(CrossTabs)/math-a55cc67126812452ebb989878123e1d1.png" title="d_{C|R} = \frac{P-Q}{D_r}" alt="d_{C|R} = \frac{P-Q}{D_r}" class="tex" border="0" /></td>
<td><img src="../images/Algorithm(CrossTabs)/math-e1b49506418c36946f11b0273a1ff255.png" title="\frac{2}{D_r}\sqrt{\sum_{ij}f_{ij}(C_{ij}-D_{ij})^2-\frac{1}{N}(P-Q)^2}" alt="\frac{2}{D_r}\sqrt{\sum_{ij}f_{ij}(C_{ij}-D_{ij})^2-\frac{1}{N}(P-Q)^2}" class="tex" border="0" /></td>
</tr>
<tr>
<td>R<img src="../images/Algorithm(CrossTabs)/math-b99834bc19bbad24580b3adfa04fb947.png" title="|" alt="|" class="tex" border="0" />C</td>
<td><img src="../images/Algorithm(CrossTabs)/math-95c75be2de7e1e529a221f1b6ff2c0ae.png" title="d_{R|C} = \frac{P-Q}{D_c}" alt="d_{R|C} = \frac{P-Q}{D_c}" class="tex" border="0" /></td>
<td><img src="../images/Algorithm(CrossTabs)/math-08de37f7d4b6824a6f734bab201f8682.png" title="\frac{2}{D_c}\sqrt{\sum_{ij}f_{ij}(C_{ij}-D_{ij})^2-\frac{1}{N}(P-Q)^2}" alt="\frac{2}{D_c}\sqrt{\sum_{ij}f_{ij}(C_{ij}-D_{ij})^2-\frac{1}{N}(P-Q)^2}" class="tex" border="0" /></td>
</tr>
<tr>
<td>対称</td>
<td><img src="../images/Algorithm(CrossTabs)/math-7b2342cd106f701a2394591454e27dc3.png" title="d = 2\frac{P-Q}{D_c+D_r}" alt="d = 2\frac{P-Q}{D_c+D_r}" class="tex" border="0" /></td>
<td><img src="../images/Algorithm(CrossTabs)/math-13b710204e1ae878fb90eee4ce577ed8.png" title="\frac{4}{D_c+D_r}\sqrt{\sum_{ij}f_{ij}(C_{ij}-D_{ij})^2-\frac{1}{N}(P-Q)^2}" alt="\frac{4}{D_c+D_r}\sqrt{\sum_{ij}f_{ij}(C_{ij}-D_{ij})^2-\frac{1}{N}(P-Q)^2}" class="tex" border="0" /></td>
</tr>
<tr>
<th rowspan="3">ラムダ</th>
<td>C<img src="../images/Algorithm(CrossTabs)/math-b99834bc19bbad24580b3adfa04fb947.png" title="|" alt="|" class="tex" border="0" />R</td>
<td><img src="../images/Algorithm(CrossTabs)/math-0fcfa7cd51e5e3ebb6720715537fc2d4.png" title="\lambda_{C|R} = \frac{1}{N-c_m}\left(\sum_{i=1}^{R}f_{im}-c_m\right)" alt="\lambda_{C|R} = \frac{1}{N-c_m}\left(\sum_{i=1}^{R}f_{im}-c_m\right)" class="tex" border="0" />, ここで <img src="../images/Algorithm(CrossTabs)/math-45764555b24d287ac9b6919d6e8d06e3.png" title="f_{im}" alt="f_{im}" class="tex" border="0" /> はi番目の行で最も大きな度数、<img src="../images/Algorithm(CrossTabs)/math-809448c12da6a61638ab2987bc9fcaeb.png" title="c_m" alt="c_m" class="tex" border="0" /> は最も大きな列小計</td>
<td><img src="../images/Algorithm(CrossTabs)/math-40624954a038197124010a9924745b44.png" title="\sqrt{ \frac{ N - \displaystyle\sum_{i=1}^{R} f_{im} }{ (N-c_m)^3 } \left(\sum_{i=1}^{R} f_{im} + c_m -2\sum_{i=1}^{R} (f_{im}|l_i=l) \right) }" alt="\sqrt{ \frac{ N - \displaystyle\sum_{i=1}^{R} f_{im} }{ (N-c_m)^3 } \left(\sum_{i=1}^{R} f_{im} + c_m -2\sum_{i=1}^{R} (f_{im}|l_i=l) \right) }" class="tex" border="0" />,<br />
<p>ここで <img src="../images/Algorithm(CrossTabs)/math-b39335b6584e8455ab4de3c86b439e21.png" title="l_i" alt="l_i" class="tex" border="0" /> は <img src="../images/Algorithm(CrossTabs)/math-45764555b24d287ac9b6919d6e8d06e3.png" title="f_{im}" alt="f_{im}" class="tex" border="0" /> の列インデックス、 <img src="../images/Algorithm(CrossTabs)/math-2db95e8e1a9267b7a1188556b2013b33.png" title="l" alt="l" class="tex" border="0" /> は <img src="../images/Algorithm(CrossTabs)/math-809448c12da6a61638ab2987bc9fcaeb.png" title="c_m" alt="c_m" class="tex" border="0" /> の列小計のインデックス</p>
</td>
</tr>
<tr>
<td>R<img src="../images/Algorithm(CrossTabs)/math-b99834bc19bbad24580b3adfa04fb947.png" title="|" alt="|" class="tex" border="0" />C</td>
<td><img src="../images/Algorithm(CrossTabs)/math-8907cb58cfbcf70876c3fa1d022a54da.png" title="\lambda_{R|C} = \frac{1}{N-r_m}\left(\sum_{j=1}^{C}f_{mj}-r_m\right)" alt="\lambda_{R|C} = \frac{1}{N-r_m}\left(\sum_{j=1}^{C}f_{mj}-r_m\right)" class="tex" border="0" />,
<p>ここで <img src="../images/Algorithm(CrossTabs)/math-4df3903f1f8e364348208bf47bb42ec0.png" title="f_{mj}" alt="f_{mj}" class="tex" border="0" /> はj番目の列で最も大きな度数、<img src="../images/Algorithm(CrossTabs)/math-ad2fdd8ee6e6b23d512c21f9be0c1117.png" title="r_m" alt="r_m" class="tex" border="0" /> は最も大きな行小計</p>
</td>
<td><img src="../images/Algorithm(CrossTabs)/math-1211ae29c851f8f0a06dffae60fea2b7.png" title="\sqrt{ \frac{ N - \displaystyle\sum_{j=1}^{C} f_{mj} }{ (N-r_m)^3 } \left(\sum_{j=1}^{C} f_{mj} + r_m -2\sum_{j=1}^{C} (f_{mj}|k_j=k) \right) }" alt="\sqrt{ \frac{ N - \displaystyle\sum_{j=1}^{C} f_{mj} }{ (N-r_m)^3 } \left(\sum_{j=1}^{C} f_{mj} + r_m -2\sum_{j=1}^{C} (f_{mj}|k_j=k) \right) }" class="tex" border="0" />,<br />
<p>ここで <img src="../images/Algorithm(CrossTabs)/math-a4546bcd382733f23282f745bd3e2e98.png" title="k_j" alt="k_j" class="tex" border="0" /> は <img src="../images/Algorithm(CrossTabs)/math-4df3903f1f8e364348208bf47bb42ec0.png" title="f_{mj}" alt="f_{mj}" class="tex" border="0" /> の行インデックス、<img src="../images/Algorithm(CrossTabs)/math-8ce4b16b22b58894aa86c421e8759df3.png" title="k" alt="k" class="tex" border="0" /> は <img src="../images/Algorithm(CrossTabs)/math-ad2fdd8ee6e6b23d512c21f9be0c1117.png" title="r_m" alt="r_m" class="tex" border="0" /> の行小計のインデックス</p>
</td>
</tr>
<tr>
<td>対称</td>
<td><img src="../images/Algorithm(CrossTabs)/math-e1eba21c82a1b082d636a63187cb00a7.png" title="\lambda = \frac { \displaystyle \sum_{i=1}^{R}f_{im} + \sum_{j=1}^{C}f_{mj} - c_m - r_m }{2N-r_m-c_m}" alt="\lambda = \frac { \displaystyle \sum_{i=1}^{R}f_{im} + \sum_{j=1}^{C}f_{mj} - c_m - r_m }{2N-r_m-c_m}" class="tex" border="0" /></td>
<td><img src="../images/Algorithm(CrossTabs)/math-19a542d5e209aac0810776eadb8cedef.png" title="\frac{1}{w^2} \sqrt{ wvy - 2w^2\left( N-\sum_{i=1}^{R} (f_{im}|i=k_{l_i}) \right) - 2v^2(N-f_{kl}) }" alt="\frac{1}{w^2} \sqrt{ wvy - 2w^2\left( N-\sum_{i=1}^{R} (f_{im}|i=k_{l_i}) \right) - 2v^2(N-f_{kl}) }" class="tex" border="0" /><br />
<p>ここで <img src="../images/Algorithm(CrossTabs)/math-482184ecfe89cf022f132ec45b287995.png" title="w=2N-r_m-c_m" alt="w=2N-r_m-c_m" class="tex" border="0" />, <img src="../images/Algorithm(CrossTabs)/math-e440a2c7d776b0b2dbea9c561d0b426c.png" title="v = 2N - \sum_{i=1}^{R}f_{im} - \sum_{j=1}^{C}f_{mj}" alt="v = 2N - \sum_{i=1}^{R}f_{im} - \sum_{j=1}^{C}f_{mj}" class="tex" border="0" />, <img src="../images/Algorithm(CrossTabs)/math-c6adf2e551f3d61a8c29e74ec448990b.png" title="x = \sum_{i=1}^R (f_{im}|l_i=l) + \sum_{j=1}^C (f_{mj}|k_j=k) + f_{km} + f_{ml}" alt="x = \sum_{i=1}^R (f_{im}|l_i=l) + \sum_{j=1}^C (f_{mj}|k_j=k) + f_{km} + f_{ml}" class="tex" border="0" />, および <img src="../images/Algorithm(CrossTabs)/math-9864388d59406b2ca9fc4b3b8b495d0c.png" title="y = 8N - w - v - 2x" alt="y = 8N - w - v - 2x" class="tex" border="0" /></p>
</td>
</tr>
<tr>
<th rowspan="3">不確実性</th>
<td>C<img src="../images/Algorithm(CrossTabs)/math-b99834bc19bbad24580b3adfa04fb947.png" title="|" alt="|" class="tex" border="0" />R</td>
<td><img src="../images/Algorithm(CrossTabs)/math-41d754f4bf76713a35b0c1284fd54c34.png" title="U_{R|C} = \frac{U(X)+U(Y)-U(XY)}{U(Y)}" alt="U_{R|C} = \frac{U(X)+U(Y)-U(XY)}{U(Y)}" class="tex" border="0" />, ここで <img src="../images/Algorithm(CrossTabs)/math-6c101af2c4e5d9d4e9a71bfd9cd1cee9.png" title="U(X) = -\sum_{i=1}^{R}\frac{r_i}{N}\ln\frac{r_i}{N}" alt="U(X) = -\sum_{i=1}^{R}\frac{r_i}{N}\ln\frac{r_i}{N}" class="tex" border="0" />, および <img src="../images/Algorithm(CrossTabs)/math-9801595969688b934b63df41a05e7c30.png" title="U(Y) = -\sum_{j=1}^{C}\frac{c_j}{N}\ln\frac{c_j}{N}" alt="U(Y) = -\sum_{j=1}^{C}\frac{c_j}{N}\ln\frac{c_j}{N}" class="tex" border="0" />, および <img src="../images/Algorithm(CrossTabs)/math-ea444840a2b4f491836ac96f310228fc.png" title="U(XY) = -\sum_{ij}\frac{f_{ij}}{N}\ln\frac{f_{ij}}{N}" alt="U(XY) = -\sum_{ij}\frac{f_{ij}}{N}\ln\frac{f_{ij}}{N}" class="tex" border="0" /></td>
<td><img src="../images/Algorithm(CrossTabs)/math-9ea06b87526a38e4d91042ca8c4fe917.png" title="\frac{1}{NU(Y)}\sqrt{P-N\left(U(X)+U(Y)-U(XY)\right)^2}" alt="\frac{1}{NU(Y)}\sqrt{P-N\left(U(X)+U(Y)-U(XY)\right)^2}" class="tex" border="0" />, ここで <img src="../images/Algorithm(CrossTabs)/math-bed50ae560cb148d344cf16dcd5a0108.png" title="P = \sum_{ij}f_{ij}\ln\left(\frac{r_ic_j}{f_{ij}N}\right)^2" alt="P = \sum_{ij}f_{ij}\ln\left(\frac{r_ic_j}{f_{ij}N}\right)^2" class="tex" border="0" /></td>
</tr>
<tr>
<td>R<img src="../images/Algorithm(CrossTabs)/math-b99834bc19bbad24580b3adfa04fb947.png" title="|" alt="|" class="tex" border="0" />C</td>
<td><img src="../images/Algorithm(CrossTabs)/math-2f741623b6366e540eaba9c97d083e7b.png" title="U_{C|R} = \frac{U(X)+U(Y)-U(XY)}{U(X)}" alt="U_{C|R} = \frac{U(X)+U(Y)-U(XY)}{U(X)}" class="tex" border="0" /></td>
<td><img src="../images/Algorithm(CrossTabs)/math-eed562bf2445e78c73aa3c344fb75249.png" title="\frac{1}{NU(X)}\sqrt{P-N\left(U(X)+U(Y)-U(XY)\right)^2}" alt="\frac{1}{NU(X)}\sqrt{P-N\left(U(X)+U(Y)-U(XY)\right)^2}" class="tex" border="0" /></td>
</tr>
<tr>
<td>対称</td>
<td><img src="../images/Algorithm(CrossTabs)/math-1b42c23d992439355e27425484c6fe29.png" title="U = 2\frac{U(X)+U(Y)-U(XY)}{U(X)+U(Y)}" alt="U = 2\frac{U(X)+U(Y)-U(XY)}{U(X)+U(Y)}" class="tex" border="0" /></td>
<td><img src="../images/Algorithm(CrossTabs)/math-16431aabee7e70358843ece1fbd3d1c7.png" title="\frac{2}{N(U(X)+U(Y))}\sqrt{P-\frac{1}{N}\left(U(X)+U(Y)-U(XY)\right)^2}" alt="\frac{2}{N(U(X)+U(Y))}\sqrt{P-\frac{1}{N}\left(U(X)+U(Y)-U(XY)\right)^2}" class="tex" border="0" /></td>
</tr>
</table>
<h3><a name="Measures_of_Agreement" id="Measures_of_Agreement"></a><span class="mw-headline">一致性の尺度</span></h3>
<p>この表は(1) <img src="../images/Algorithm(CrossTabs)/math-edb010593263510315660511c8d3fffd.png" title="R=C" alt="R=C" class="tex" border="0" /> であるような正方形の表かつ、(2)行変数と列変数が同じ値を持つときに計算されます。</p>
<p>カッパ統計は次式で計算されます。</p>
<dl>
<dd><img src="../images/Algorithm(CrossTabs)/math-5254a7c3d0d060337a3cbbbdf6875b25.png" title=" \kappa = \frac{N\sum_{i=1}^{R}f_{ii} - \sum_{i=1}^{R}r_ic_i}{N^2 - \sum_{i=1}^{R}r_ic_i}" alt=" \kappa = \frac{N\sum_{i=1}^{R}f_{ii} - \sum_{i=1}^{R}r_ic_i}{N^2 - \sum_{i=1}^{R}r_ic_i}" class="tex" border="0" /></dd>
</dl>
<p>昇順誤差は以下で推定されます。</p>
<dl>
<dd><img src="../images/Algorithm(CrossTabs)/math-d5df0387ad3559e108f0277be4b93139.png" title="SE_1 = \frac{1}{1-p_e} \sqrt{ \frac{A+B-C}{N} }" alt="SE_1 = \frac{1}{1-p_e} \sqrt{ \frac{A+B-C}{N} }" class="tex" border="0" />.</dd>
</dl>
<p>ここで <img src="../images/Algorithm(CrossTabs)/math-bf7508ed7ef577a0788e418015208540.png" title="p_e = \frac{ \sum_{i=1}^R r_i c_i }{ N^2 }" alt="p_e = \frac{ \sum_{i=1}^R r_i c_i }{ N^2 }" class="tex" border="0" />, <img src="../images/Algorithm(CrossTabs)/math-076dba1512e9c770a80347941db7b618.png" title=" A = \sum_{i=1}^R \frac{f_{ii}}{N} \left( 1-\frac{(r_i+c_i)(1- \kappa)}{N} \right)^2" alt=" A = \sum_{i=1}^R \frac{f_{ii}}{N} \left( 1-\frac{(r_i+c_i)(1- \kappa)}{N} \right)^2" class="tex" border="0" />,<br />
<img src="../images/Algorithm(CrossTabs)/math-7ccc2452ce9ae57bfb1b04168cf43e22.png" title="B = (1-\kappa)^2 \sum_{i=1}^R \sum_{j=1, j \ne i}^{C} \frac{f_{ij} (r_i+c_j)^2}{N^3}" alt="B = (1-\kappa)^2 \sum_{i=1}^R \sum_{j=1, j \ne i}^{C} \frac{f_{ij} (r_i+c_j)^2}{N^3}" class="tex" border="0" /> および <img src="../images/Algorithm(CrossTabs)/math-b3d3228022c4151930cd2512e69756bf.png" title="C = \Bigl( \kappa - p_e( 1-\kappa ) \Bigr)^2" alt="C = \Bigl( \kappa - p_e( 1-\kappa ) \Bigr)^2" class="tex" border="0" /></p>
<p>帰無仮説<img src="../images/Algorithm(CrossTabs)/math-25613c08c6b68a9704ffc406287fdbd2.png" title="\kappa = 0" alt="\kappa = 0" class="tex" border="0" />下の対応する漸近的標準誤差は以下で与えられます。</p>
<dl>
<dd><img src="../images/Algorithm(CrossTabs)/math-2fb11a39b32089a9fb7b374c23a68abc.png" title="SE_0 = \sqrt{\frac{1}{N\left(N^2 - \sum_{i=1}^{R}r_ic_i\right)^2} \left[N^2\sum_{i=1}^{R}r_ic_i + \left(\sum_{i=1}^{R}r_ic_i\right)^2 - N \sum_{i=1}^{R}r_ic_i(r_i+c_i)\right]}" alt="SE_0 = \sqrt{\frac{1}{N\left(N^2 - \sum_{i=1}^{R}r_ic_i\right)^2} \left[N^2\sum_{i=1}^{R}r_ic_i + \left(\sum_{i=1}^{R}r_ic_i\right)^2 - N \sum_{i=1}^{R}r_ic_i(r_i+c_i)\right]}" class="tex" border="0" /></dd>
</dl>
<p>他の関連する統計はBowkerで、これは全ての対の検定<img src="../images/Algorithm(CrossTabs)/math-ba67ef5ead9d27984e0fc008b6a4ceeb.png" title="H_0: p_{ij} = p_{ji}" alt="H_0: p_{ij} = p_{ji}" class="tex" border="0" />に使用されます。<img src="../images/Algorithm(CrossTabs)/math-7b6f9d86b5ef2eaa20b9fb1427a88ed1.png" title="R&gt;2" alt="R&gt;2" class="tex" border="0" /> の場合以下のように計算されます。</p>
<dl>
<dd><img src="../images/Algorithm(CrossTabs)/math-d430e26fecf56fc1e12fb1c885b0977d.png" title="Bo = \sum_{i=1}^R \sum_{j=1}^{j&lt;i}\frac{(f_{ij}-f_{ji})^2}{f_{ij}+f_{ji}}" alt="Bo = \sum_{i=1}^R \sum_{j=1}^{j&lt;i}\frac{(f_{ij}-f_{ji})^2}{f_{ij}+f_{ji}}" class="tex" border="0" /></dd>
</dl>
<p>大きなサンプルでは、<img src="../images/Algorithm(CrossTabs)/math-b0d8913d4dfb85c2325c0773ff52ae98.png" title="Bo" alt="Bo" class="tex" border="0" /> は自由度 <img src="../images/Algorithm(CrossTabs)/math-a2718716a0f1de1548d7c9904548263e.png" title="0.5R(R-1)" alt="0.5R(R-1)" class="tex" border="0" /> の漸近的なカイ二乗分布です。</p>
<p>2 x 2 表ではBowker'の検定はMcNemarの検定に等しくなります。そのためBowkerの検定のみ提供します。</p>
<h3><a name="Odds_Ratio_and_Relative_Risk" id="Odds_Ratio_and_Relative_Risk"></a><span class="mw-headline">オッズ比と相対危険度</span></h3>
<p>これらは、2 x 2 表でのみ計算されます。</p>
<h4><a name="Odds_Ratio" id="Odds_Ratio"></a><span class="mw-headline">オッズ比</span></h4>
<p>オッズ比は以下のように計算されます。</p>
<p><img src="../images/Algorithm(CrossTabs)/math-3fa39a72468c2793e5b60fc04aa0aef1.png" title="OR = \frac{f_{11}f_{22}}{f_{12}f_{21}}" alt="OR = \frac{f_{11}f_{22}}{f_{12}f_{21}}" class="tex" border="0" /></p>
<h4><a name="Relative_Risk" id="Relative_Risk"></a><span class="mw-headline">相対危険度</span></h4>
<p>相対危険度は以下のように与えられます。</p>
<dl>
<dd><img src="../images/Algorithm(CrossTabs)/math-ddef868fb9aede240998288fda3c3aa7.png" title="P(Y_1|X_1)/P(Y_1|X_2) = \frac{f_{11}(f_{21}+f_{22})}{f_{21}(f_{11}+f_{12})}" alt="P(Y_1|X_1)/P(Y_1|X_2) = \frac{f_{11}(f_{21}+f_{22})}{f_{21}(f_{11}+f_{12})}" class="tex" border="0" /></dd>
<dd><img src="../images/Algorithm(CrossTabs)/math-d2ceb3919433fdc636aaa24dbf97eff3.png" title="P(Y_1|X_2)/P(Y_1|X_1) = \frac{f_{21}(f_{11}+f_{12})}{f_{11}(f_{21}+f_{22})}" alt="P(Y_1|X_2)/P(Y_1|X_1) = \frac{f_{21}(f_{11}+f_{12})}{f_{11}(f_{21}+f_{22})}" class="tex" border="0" /></dd>
<dd><img src="../images/Algorithm(CrossTabs)/math-beb356acfebcc913c83cc436c4c1a294.png" title="P(Y_2|X_1)/P(Y_2|X_2) = \frac{f_{12}(f_{21}+f_{22})}{f_{22}(f_{12}+f_{11})}" alt="P(Y_2|X_1)/P(Y_2|X_2) = \frac{f_{12}(f_{21}+f_{22})}{f_{22}(f_{12}+f_{11})}" class="tex" border="0" /></dd>
<dd><img src="../images/Algorithm(CrossTabs)/math-dccda1547a25ca3e806a9ca71e7f18b8.png" title="P(Y_2|X_2)/P(Y_2|X_1) = \frac{f_{22}(f_{12}+f_{11})}{f_{12}(f_{21}+f_{22})}" alt="P(Y_2|X_2)/P(Y_2|X_1) = \frac{f_{22}(f_{12}+f_{11})}{f_{12}(f_{21}+f_{22})}" class="tex" border="0" /></dd>
</dl>
<h3><a name="Cochran-Mantel-Haenszel" id="Cochran-Mantel-Haenszel"></a><span class="mw-headline">Cochran-Mantel-Haenszel</span></h3>
<p>定義</p>
<dl>
<dd><img src="../images/Algorithm(CrossTabs)/math-a5f3c6a11b03839d46af9fb43c97c188.png" title="K" alt="K" class="tex" border="0" /> はレイヤの数</dd>
<dd><img src="../images/Algorithm(CrossTabs)/math-e556497bde20dfbfa75643809f1ebdf7.png" title="f_{ijk}" alt="f_{ijk}" class="tex" border="0" /> はi番目の行、j番目の列、k番目のレイヤの行の頻度</dd>
<dd><img src="../images/Algorithm(CrossTabs)/math-7cf78813f9fae08fd878f1cc53cf8537.png" title="c_{jk} = \sum_{i=1}^{R} f_{ijk}" alt="c_{jk} = \sum_{i=1}^{R} f_{ijk}" class="tex" border="0" /> はj番目の列、k番目のレイヤ小計</dd>
<dd><img src="../images/Algorithm(CrossTabs)/math-a724d1b708d3641b5ecf703c6e82edfe.png" title="r_{ik} = \sum_{j=1}^{C} f_{ijk}" alt="r_{ik} = \sum_{j=1}^{C} f_{ijk}" class="tex" border="0" /> はi番目の行、k番目のレイヤの小計</dd>
<dd><img src="../images/Algorithm(CrossTabs)/math-f6efcc282f93fcf708632763b952abeb.png" title="n_{k} = \sum_{i=1}^{R}\sum_{j=1}^{C} f_{ijk}" alt="n_{k} = \sum_{i=1}^{R}\sum_{j=1}^{C} f_{ijk}" class="tex" border="0" /> はk番目のレイヤ小計</dd>
<dd><img src="../images/Algorithm(CrossTabs)/math-6a3fbc33c2b95cce81a2b588a43535b3.png" title="E_{ijk} = \frac{r_{ik}c_{jk}}{n_k}" alt="E_{ijk} = \frac{r_{ik}c_{jk}}{n_k}" class="tex" border="0" /> はi番目の行、j番目の列、k番目のセルの行の推定された頻度</dd>
<dd><img src="../images/Algorithm(CrossTabs)/math-5f5f9e9f589b49daa28976461688df13.png" title="\hat{p}_{ik} = \frac{f_{i1k}}{r_{ik}}, d_k = \hat{p}_{1k} - \hat{p}_{2k}, \hat{p}_{k} = \frac{c_{1k}}{n_{k}}" alt="\hat{p}_{ik} = \frac{f_{i1k}}{r_{ik}}, d_k = \hat{p}_{1k} - \hat{p}_{2k}, \hat{p}_{k} = \frac{c_{1k}}{n_{k}}" class="tex" border="0" /></dd>
</dl>
<h4><a name="Mantel-Haenszel_statistic" id="Mantel-Haenszel_statistic"></a><span class="mw-headline">Mantel-Haenszel 統計</span></h4>
<p>Mantel-Haenszel統計は次式で計算されます。</p>
<p><img src="../images/Algorithm(CrossTabs)/math-a19d6f25b272775d916bf03f49c392a7.png" title="MH = \left(\sum_{k=1}^{K}\frac{r_{1k}r_{2k}}{n_k-1} \hat{p}_{k}(1-\hat{p}_{k}) \right)^{-1/2}\left(\big|\sum_{k=1}^{K} (f_{11k}-E_{11k})\big|-0.5\right)sgn\left(\sum_{k=1}^{K} (f_{11k}-E_{11k})\right)" alt="MH = \left(\sum_{k=1}^{K}\frac{r_{1k}r_{2k}}{n_k-1} \hat{p}_{k}(1-\hat{p}_{k}) \right)^{-1/2}\left(\big|\sum_{k=1}^{K} (f_{11k}-E_{11k})\big|-0.5\right)sgn\left(\sum_{k=1}^{K} (f_{11k}-E_{11k})\right)" class="tex" border="0" /></p>
<p>sgn は符号関数 <img src="../images/Algorithm(CrossTabs)/math-bac6f59daa3ed3f832a664093772d7f5.png" title="sgn(x) = I(x&gt;0)-I(x&lt;0)+0*I(x=0)" alt="sgn(x) = I(x&gt;0)-I(x&lt;0)+0*I(x=0)" class="tex" border="0" /> です。</p>
<p><br /></p>
<h4><a name="Breslow-Day_statistic" id="Breslow-Day_statistic"></a><span class="mw-headline">Breslow-Day 統計</span></h4>
<p>Breslow-Day 統計は、</p>
<p><img src="../images/Algorithm(CrossTabs)/math-9e373b8a5825fcf21df5156eec3131d9.png" title="BD = \sum_{k=1}^{K} V_k \left[f_{11k}-\hat{f}_{11k}\right]^2" alt="BD = \sum_{k=1}^{K} V_k \left[f_{11k}-\hat{f}_{11k}\right]^2" class="tex" border="0" /></p>
<p>ここで <img src="../images/Algorithm(CrossTabs)/math-51a2177fcf45f2b8a173881132bf7396.png" title="V_k = \frac{1}{\hat{f}_{11k}}+\frac{1}{\hat{f}_{12k}}+\frac{1}{\hat{f}_{21k}}+\frac{1}{\hat{f}_{22k}}" alt="V_k = \frac{1}{\hat{f}_{11k}}+\frac{1}{\hat{f}_{12k}}+\frac{1}{\hat{f}_{21k}}+\frac{1}{\hat{f}_{22k}}" class="tex" border="0" /> です。</p>
<h4><a name="Tarone.E2.80.99s_Statistic" id="Tarone.E2.80.99s_Statistic"></a><span class="mw-headline">タローンの統計</span></h4>
<p>タローンの統計は、</p>
<dl>
<dd><img src="../images/Algorithm(CrossTabs)/math-2d5715c073380230f9458c06eed9823c.png" title="T = \sum_{k=1}^{K} V_k \left[f_{11k}-\hat{f}_{11k}\right]^2- \frac{\sum_{k=1}^{K}\left[f_{11k}-\hat{f}_{11k}\right]^2}{\sum_{k=1}^{K}\frac {1}{V_k} }" alt="T = \sum_{k=1}^{K} V_k \left[f_{11k}-\hat{f}_{11k}\right]^2- \frac{\sum_{k=1}^{K}\left[f_{11k}-\hat{f}_{11k}\right]^2}{\sum_{k=1}^{K}\frac {1}{V_k} }" class="tex" border="0" /></dd>
</dl>
<p>ここで <img src="../images/Algorithm(CrossTabs)/math-51a2177fcf45f2b8a173881132bf7396.png" title="V_k = \frac{1}{\hat{f}_{11k}}+\frac{1}{\hat{f}_{12k}}+\frac{1}{\hat{f}_{21k}}+\frac{1}{\hat{f}_{22k}}" alt="V_k = \frac{1}{\hat{f}_{11k}}+\frac{1}{\hat{f}_{12k}}+\frac{1}{\hat{f}_{21k}}+\frac{1}{\hat{f}_{22k}}" class="tex" border="0" /> です。</p>
<h4><a name="Common_Odds_Ratio" id="Common_Odds_Ratio"></a><span class="mw-headline">共通オッズ比</span></h4>
<p>2×2×K 表の場合、k番目のレイヤのオッズ比は <img src="../images/Algorithm(CrossTabs)/math-21626330e02733bfb9c5ce9522a3b6a4.png" title="OR_{k}" alt="OR_{k}" class="tex" border="0" /> です。共通オッズ比が存在すると仮定、つまり <img src="../images/Algorithm(CrossTabs)/math-1a28ceae6382df6568013684e1188e9e.png" title="OR_{1}=OR_{2}=...OR_{K}" alt="OR_{1}=OR_{2}=...OR_{K}" class="tex" border="0" /> とすると、共通オッズ比のMantel-Haenszelの推定子は、</p>
<dl>
<dd><img src="../images/Algorithm(CrossTabs)/math-488db329f6cab4e8b965215f34861f44.png" title="\hat OR_{MH}=\frac{\sum_{k=1}^{K}\frac{f_{11k} f_{22k}}{n_{k}}}{\sum_{k=1}^{K}\frac{f_{12k} f_{21k}}{n_{k}}}" alt="\hat OR_{MH}=\frac{\sum_{k=1}^{K}\frac{f_{11k} f_{22k}}{n_{k}}}{\sum_{k=1}^{K}\frac{f_{12k} f_{21k}}{n_{k}}}" class="tex" border="0" /></dd>
</dl>
<p><img src="../images/Algorithm(CrossTabs)/math-30df4328bbc77817e4b8cd73539d4829.png" title="ln(\hat OR_{MH})" alt="ln(\hat OR_{MH})" class="tex" border="0" /> の漸近的分散は、</p>
<dl>
<dd><img src="../images/Algorithm(CrossTabs)/math-fe6d99fcba77f28d2e62c52d30d014f4.png" title="\hat Var[ln(\hat OR_{MH})]=\frac{\sum_{k=1}^{K}\frac{(f_{11k}+f_{22k})f_{11k} f_{22k}}{n_{k}^2}}{2\sum_{k=1}^{K}\frac{f_{11k} f_{22k}}{n_{k}}}+\frac{\sum_{k=1}^{K}\frac{(f_{11k}+f_{22k})f_{12k} f_{21k}+(f_{12k}+f_{21k})f_{11k} f_{22k}}{n_{k}^2}}{2\sum_{k=1}^{K}\frac{f_{11k} f_{22k}}{n_{k}}\sum_{k=1}^{K}\frac{f_{12k} f_{21k}}{n_{k}}}+\frac{\sum_{k=1}^{K}\frac{(f_{12k}+f_{21k})f_{12k} f_{21k}}{n_{k}^2}}{2\sum_{k=1}^{K}\frac{f_{12k} f_{21k}}{n_{k}}}" alt="\hat Var[ln(\hat OR_{MH})]=\frac{\sum_{k=1}^{K}\frac{(f_{11k}+f_{22k})f_{11k} f_{22k}}{n_{k}^2}}{2\sum_{k=1}^{K}\frac{f_{11k} f_{22k}}{n_{k}}}+\frac{\sum_{k=1}^{K}\frac{(f_{11k}+f_{22k})f_{12k} f_{21k}+(f_{12k}+f_{21k})f_{11k} f_{22k}}{n_{k}^2}}{2\sum_{k=1}^{K}\frac{f_{11k} f_{22k}}{n_{k}}\sum_{k=1}^{K}\frac{f_{12k} f_{21k}}{n_{k}}}+\frac{\sum_{k=1}^{K}\frac{(f_{12k}+f_{21k})f_{12k} f_{21k}}{n_{k}^2}}{2\sum_{k=1}^{K}\frac{f_{12k} f_{21k}}{n_{k}}}" class="tex" border="0" /></dd>
</dl>
<p><img src="../images/Algorithm(CrossTabs)/math-30df4328bbc77817e4b8cd73539d4829.png" title="ln(\hat OR_{MH})" alt="ln(\hat OR_{MH})" class="tex" border="0" /> の下側信頼限界(LCL)と上側信頼限界(UCL)は、</p>
<dl>
<dd><img src="../images/Algorithm(CrossTabs)/math-687f3dc2952c8d8fc3ddafc624d1a1a3.png" title="ln(\hat OR_{MH})-z({alpha}/2)\sqrt{\hat Var[ln(\hat OR_{MH})]}" alt="ln(\hat OR_{MH})-z({alpha}/2)\sqrt{\hat Var[ln(\hat OR_{MH})]}" class="tex" border="0" /> および <img src="../images/Algorithm(CrossTabs)/math-e8dcfecb9336a5c778bcff6588b5c278.png" title="ln(\hat OR_{MH})+z(alpha/2)\sqrt{\hat Var[ln(\hat OR_{MH})]}" alt="ln(\hat OR_{MH})+z(alpha/2)\sqrt{\hat Var[ln(\hat OR_{MH})]}" class="tex" border="0" /></dd>
</dl>
