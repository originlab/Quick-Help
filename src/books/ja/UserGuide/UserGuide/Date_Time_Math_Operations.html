<h1 class="firstheading">日時演算</h1><p class='urlname' style='display: none'>Date-Time-Math-Operations</p>
<p>最近のバージョンのOriginでは、日時データのインポートが改良されました。<b>Origin 2020b</b>では、<a class="external text" href="../../UserGuide/UserGuide/Connecting_to_File.html#Text.2FCSV_Connector"><b>Text/CSVコネクタ</b></a>の日時インポートが改善され、<b>Origin 2021</b>では、<a class="external text" href="../../QuickHelp/QuickHelp/How_to_paste_date_time_from_Excel.html">MSExcelからコピー/貼り付け</a>する際の日時の処理が改善されました。 
</p><p>古いX-ファンクションベースのインポートに関しては、フィルタを使用してデータをインポートする場合や、ASCIIオプションでカスタム形式を指定する場合を除き、日時データは<a href="../../UserGuide/UserGuide/Dates_and_Times_in_the_Worksheet.html#Formatting_Date_and_Time_Data" title="ユーザガイド：ワークシート内の日付と時間">テキストとして扱われる</a>可能性があります（ワークシートで日時データが左揃え（テキスト）か右揃え（数値）であるかどうかを調べることで、すばやく確認できます）。数値演算（たとえば経過時間の計算）で日時データを使用するには、それらが<a href="../../UserGuide/UserGuide/Dates_and_Times_in_the_Worksheet.html#Formatting_Date_and_Time_Data" title="ユーザガイド：ワークシート内の日付と時間">適切にフォーマット</a>されていること、つまり数値データとして扱われていることを確認する必要があります。
</p><p>また、日時データに対して数学演算を実行する必要がある場合、日時の数値と日時文字列を操作するために、Originには多くの<a class="external text" href="../../LabTalk/Script/LabTalk-Supported_Functions.html#Date_and_Time_Functions"><b>日時</b></a>、<a class="external text" href="../../LabTalk/Script/LabTalk-Supported_Functions.html#String_Functions"><b>文字列</b></a>、および<a class="external text" href="../../LabTalk/Script/LabTalk-Supported_Functions.html#Math_Functions"><b>数学</b></a>関数が組み込まれています。
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Date_Time_Math_Operations/Tip_icon.png" width="57"  border="0" /></td><td><p>デフォルトでは、日時（設定画面の<b>フォーマット</b>では<b>日付</b>と表記されていますが、時間要素も含みます）は内部的には<a href="../../UserGuide/UserGuide/Dates_and_Times_in_Origin.html" title="ユーザガイド:Originでの日付と時刻の扱いについて">ユリウス通日</a>(倍精度)で保存されます。整数部分が日付で、小数部分が秒を示します。このシステムでは、小数点以下4桁までに制限されており、これより小さい値は四捨五入されます。Origin2019以降、「Time Zero」が2018年1月1日00:00と定義されている<a href="../../UserGuide/UserGuide/Dates_and_Times_in_Origin.html#Alternate_Date-Time_Systems_in_Origin" title="ユーザガイド:Originでの日付と時刻の扱いについて">「<b>2018</b>」 日付システム</a>をサポートしています。この場合は、整数部分が小さいので、少数部分の桁数を大きくすることができます。  2018システムでは、10<sup>-8</sup>秒まで対応しています。
</p></td></tr></table>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Date.2C_Time.2C_Month.2C_Day_of_the_Week"><span class="tocnumber">1</span> <span class="toctext">日付、時間、月、曜日</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Date_and_time_math_operations:_dates_and_times"><span class="tocnumber">2</span> <span class="toctext">日時演算：日付と時間</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Date_and_time_math_operations:_months"><span class="tocnumber">3</span> <span class="toctext">日時演算：月</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Date_and_time_math_operations:_days"><span class="tocnumber">4</span> <span class="toctext">日時演算：曜日</span></a></li>
</ul>
</div>
<h2><a name="Date.2C_Time.2C_Month.2C_Day_of_the_Week"></a><span class="mw-headline">日付、時間、月、曜日</span></h2>
<p>Originの日時の値は、データ型<b>double(8)</b>の<a href="../../UserGuide/UserGuide/Dates_and_Times_in_Origin.html" title="ユーザガイド:Originでの日付と時刻の扱いについて">天文学ユリウス日番号</a>として内部的に格納されます。これらの内部的に格納された値は、日時データ用に選択した<b>表示</b>オプションとは無関係であることに留意してください。これらのユリウス日の値は、日時データに対して数学演算を実行するときに使用されます。 
</p>
<dl><dd><dl><dd><a  class="image"><img alt="Date Time Math 02.png" src="../images/Date_Time_Math_Operations/Date_Time_Math_02.png" width="608"  /></a></dd></dl></dd></dl>
<p>もう1つの注意点は、内部で保存された値が<b>表示</b>フォーマットの選択に影響されないため、サポートされている任意の日時<b>表示</b>オプション間で自由に前後に切り替えることができる点です（すなわち、小数点以下2桁にフォーマットされた日時値から元の日時値に切り替えても、元となる値を変更しないため、精度の損失はありません）。
</p><p>Originは基本的な<b>日付</b>、<b>時間</b>、<b>月</b>、<b>曜日</b>の<b>フォーマット</b>をサポートしています。さらに、それぞれに対応したいくつかの<b>表示</b>オプションがあります（例：日付記法で使用される月表示オプションに加えて、月は &quot;Jan&quot;, &quot;January&quot; または &quot;J&quot; と表示することができます）。 
</p><p><br />
<i><b>詳細は、こちらを確認してください：</b></i>
</p>
<ul><li> <b>列プロパティ</b>ダイアログボックス<a href="../../UserGuide/UserGuide/The_(Column_Properties)_Properties_Tab.html#Format" title="ユーザガイド: (列プロパティ) プロパティタブ"><b>フォーマット</b></a>オプション</li>
<li> <b>列プロパティ</b>ダイアログボックスの<a href="../../UserGuide/UserGuide/The_(Column_Properties)_Properties_Tab.html#Display" title="ユーザガイド: (列プロパティ) プロパティタブ"><b>表示</b></a> オプション</li></ul>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Date_Time_Math_Operations/Tip_icon.png" width="57"  border="0" /></td><td><p>日時の列が欠損値（&quot;--&quot;）を含む場合、<a href="../../UserGuide/UserGuide/Dates_and_Times_in_the_Worksheet.html#A_Note_about_Missing_Values_in_Date-Time_Data" title="ユーザガイド：ワークシート内の日付と時間">日付・時間データの欠損値について</a>を参照してください。
</p></td></tr></table>
<h2><a name="Date_and_time_math_operations:_dates_and_times"></a><span class="mw-headline">日時演算：日付と時間</span></h2>
<p>列Aに日時の値が含まれ、列Bに列Aの各日時値で行われた測定値が含まれているワークシートがある場合に、各測定の間にどれくらいの時間が経過したかを知りたいことがあるかもしれません。3つ目の列Cを作成して、<a href="../../UserGuide/UserGuide/Quick_Start_SetColumnValues.html" title="ユーザガイド:クィックスタート 列値の設定"><b>列値の設定</b>ダイアログボックス</a>を使用して、測定間の経過時間のデータセットを簡単に生成することができます。
</p>
<pre class="lt" style="font-family:monospace;">A<span style="color: #000000;">[</span>i<span style="color: #000000;">]</span><span style="color: #000080;">-</span>A<span style="color: #000000;">[</span>i<span style="color: #000080;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">]</span>   <span style="color: #008000;">// i は2から列Aの最後の行</span></pre>
<dl><dd><dl><dd><a  class="image"><img alt="Date Time Math 01.png" src="../images/Date_Time_Math_Operations/Date_Time_Math_01.png" width="713"  /></a></dd></dl></dd></dl>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Date_Time_Math_Operations/Alert_icon.png" width="57"  border="0" /></td><td><p><b>Origin 2021b</b>では、<i>時間</i>形式の制限が<i>240日から548日に</i>増加しました（つまり、<b>表示</b> = <i>Hh：mm</i>に設定された<i>時間</i>列に 13151：00 と入力すると 13151：00 と表示されますが、 13152：00 と入力すると 00:00 と表示されます）。548日以上の経過を伴う経過時間の計算を行う場合、列の<b>フォーマット</b>を<i>時間</i>から<i>数値</i>に変更すると、小数部分を含む時間を日単位で追跡できます。
</p>
	</td>
	</tr>
	</table>
<h2><a name="Date_and_time_math_operations:_months"></a><span class="mw-headline">日時演算：月</span></h2>
<p>前述したように、数値および日時のテキスト文字列を操作するために使用できるいくつかのOrigin関数があります。LabTalkスクリプトガイドの中に<a class="external text" href="../../LabTalk/Script/LabTalk-Supported_Functions.html">これらの関数</a>のリストがあります。数値を月表現に変換する場合、Originはこれらの関数の1つである、<b>mod</b> (modulus)関数を使用します。
</p><p>1月（1）から12月（12）まで<b>月</b>が列挙されます。12より大きい数値は、<b>月</b>に変換するとモジュラス関数（<a class="external text" href="../../LabTalk/LabTalk/Mod_(function).html">Mod</a>を参照）によって処理されます。モジュラス関数は、次の構文を使用します：
</p><p><b>mod(x,y)</b> = 整数xを整数yで割った余り
</p><p>例：
</p><p><b>mod(46,12)</b>（＝46を12で割った余り）は10、10は10月（12月= 0）なので、46は10月に変換されます。  
</p><p><b>フォーマット</b>が<b>月</b>に設定されている列のセルに1から12の範囲外の値を入力することはできません。この範囲外の値を入力した場合、Originは欠損値として表示します。ワークシートにそれらの値を入力するには、列のフォーマットを<b>文字と数値</b>に設定してから入力してください。その後、列の<b>フォーマット</b>を<b>月</b>に戻してください。
</p>
<h2><a name="Date_and_time_math_operations:_days"></a><span class="mw-headline">日時演算：曜日</span></h2>
<p><b>曜日</b>は日曜日（0）から土曜日（6）まで列挙されます。6より大きい数値は、<b>曜日</b>に変換されたときに<a class="external text" href="../../LabTalk/LabTalk/Mod_(function).html">モジュラス関数</a>によって処理されます。
</p><p>例：
</p><p><b>mod(46,7)</b>（＝46を7で割った余り）は4で、4は木曜日に割り当てられているため、46は木曜日に変換されます。  
</p><p><b>フォーマット</b>が<b>曜日</b>に設定されている列のセルに0から6の範囲外の値を入力することはできません。この範囲外の値を入力した場合、Originは欠損値として表示します。ワークシートにそれらの値を入力するには、列の<b><b>フォーマット</b></b>を<b><b>文字と数値</b></b>に設定してから入力してください。その後、列の<b>フォーマット</b>を<b>曜日</b>に戻してください。
</p>

    