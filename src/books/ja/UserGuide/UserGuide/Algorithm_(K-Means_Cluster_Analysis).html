<h1 class="firstheading">アルゴリズム (K-means法クラスター分析)</h1>
<p><b style="font-weight: bold;">K-means法クラスター分析</b>は最小二乗和を利用して観測グループに分類します。</p>
<p>欠損値がある観測データは<b>Ｋ－means法クラスター分析</b>を行う前に除外されます。</p>
<p>変数<i>ｐ</i>で<i>ｎ</i>個の観測点を持つ行列<i>Ｘ</i>の場合、初期のクラスター中心は<i>Ｋｘｐ</i>行列により特定されるか、行列<i>Ｘ</i>から既に定義されていたクラスター数より選ばれます。</p>
<ul>
<li>観測データから初期クラスター中心を設定します
<ol>
<li>初めの<i>Ｋ</i>個の観測データはクラスター中心として割り振られています。</li>
<li>残りの観測データでループを行い、現在のクラスター中心を置き換えることができるか試します。</li>
</ol>
</li>
</ul>
<dl>
<dd>
<dl>
<dd>
<dl>
<dd>もし観測点とそれに最も近いクラスター中心の距離が2つの直近のクラスター中心(クラスター<i>i</i>とクラスター<i>ｊ</i>)よりも離れている場合、その観測点がクラスター<i>i</i>または<i>ｊ</i>のうち、より近い方のクラスター中心を置き換えることになります。</dd>
<dd>そうでないとき、もし観測点と2番目に近いクラスター中心の距離が2つの直近のクラスター中心(クラスター<i>i</i>とクラスター<i>ｊ</i>)よりも離れている場合、観測点は最も近いクラスター中心を置き換えることになります。</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<ul>
<li>観測点を最も近いクラスターに所属させます。</li>
</ul>
<dl>
<dd>各観測値は最も近くにあるクラスターに分類され、その観測点とクラスター間の距離はその2点間のユークリッド距離で計算されています。</dd>
</dl>
<dl>
<dd><i style="font-style: italic;">i</i> 番目の観測点が<i>ｋ</i>番目のクラスターに置かれた場合、その観測点と<i>k</i>番目のクラスター間の距離は<img class="tex" alt="\bar{d}_{ik}=n_k/(n_k-1)d_{ik}" src="../images/Algorithm_(K-Means_Cluster_Analysis)/math-cedef1aea230e2899f28ff3b14ff48b2.png" border="0" />のように修正されます。また、その観測点とほかのクラスターとの距離は、<img class="tex" alt="n_k\ " src="../images/Algorithm_(K-Means_Cluster_Analysis)/math-fd91d2523217931bfcd6f684555f4d7f.png" border="0" />と<img class="tex" alt="n_j\ " src="../images/Algorithm_(K-Means_Cluster_Analysis)/math-f898efd8ac64b6621a2aeed350ce3164.png" border="0" />がそれぞれ<i>ｋ</i>番目と<i>j</i> 番目のクラスターの観測数である場合、<img class="tex" alt="\bar{d}_{ij}=n_j/(n_j+1)d_{ij}" src="../images/Algorithm_(K-Means_Cluster_Analysis)/math-cc1852317b9341b92b6a403752aa9c12.png" border="0" />のように修正されます。もし観測点と<i>i</i> 番目のクラスター間の修正距離が最小でかつ<img class="tex" alt="l \ne k\ " src="../images/Algorithm_(K-Means_Cluster_Analysis)/math-cb7d6f01169691ad7f49df88fe07a026.png" border="0" />である場合、その観測点は<i>k</i>番目のクラスターではなく<i>i</i> 番目のクラスターにおかれます。</dd>
</dl>
<dl>
<dd>各クラスター中心はそのクラスター内の観測点の平均に更新されます。</dd>
<dd>クラスター内平方和は次のようになります。
<dl>
<dd><img class="tex" alt="\sum_{k=1}^K \sum_{i\in S_k} \sum_{j=1}^{p} (x_{ij}-\bar{x}_{kj})^2" src="../images/Algorithm_(K-Means_Cluster_Analysis)/math-d70a8fe7cc57982f3b8f0d400ab1c27e.png" border="0" /></dd>
</dl>
</dd>
<dd>ここで、<img class="tex" alt="S_k\ " src="../images/Algorithm_(K-Means_Cluster_Analysis)/math-0682d2d74c6ab43ef8f1268d2254691f.png" border="0" />は<i>k</i>番目のクラスター内の観測点で、<img class="tex" alt="\bar{x}_{kj}\ " src="../images/Algorithm_(K-Means_Cluster_Analysis)/math-868a6eb27b3cae22a9d545f9c41d4d0b.png" border="0" />は<i>k</i>番目のクラスターにあるクラスター中心の<i>j</i> 番目の変数に当たります。</dd>
</dl>
<dl>
<dd>更新されたクラスター中心を使うことでこの手順を繰り返し、各観測点をクラスターに所属させてクラスター中心も更新します。反復は最大反復数に到達するか、2回の連続した反復内でクラスター内二乗和がしきい値よりも小さくなった時に終了します。最後の反復の時に更新されたクラスター中心は<b>最終クラスター中心</b>と呼ばれます。</dd>
</dl>
<dl>
<dd>Originのデフォルト最大反復数は10に設定されています。</dd>
</dl>
<ul>
<li>クラスターからの距離</li>
</ul>
<dl>
<dd><i style="font-style: italic;">i</i> 番目の観測と<i>k</i>番目のクラスター間の距離はユークリッド距離を使用して計算されています。
<dl>
<dd><img class="tex" alt="S_k\ " src="../images/Algorithm_(K-Means_Cluster_Analysis)/math-f8290cc4abbfcc45ce670e3143067d20.png" border="0" /></dd>
</dl>
</dd>
</dl>
