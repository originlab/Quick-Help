<h1 class="firstheading"><b>ワークシート列のスタッキング</b></h1><p class='urlname' style='display: none'>Wks-Stacking-Cols</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Stacking_Columns_by_Column_Label"><span class="tocnumber">1</span> <span class="toctext">列ラベルで列をスタッキングする</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Dialog_Controls"><span class="tocnumber">1.1</span> <span class="toctext">ダイアログ操作</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#How_to_Stack_Columns"><span class="tocnumber">1.2</span> <span class="toctext">列をスタッキングする方法</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Example"><span class="tocnumber">1.3</span> <span class="toctext">サンプル</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="#Stacking_Columns_by_Column_Designation"><span class="tocnumber">2</span> <span class="toctext">列属性で列をスタッキングする</span></a></li>
</ul>
</div>
<h2><a name="Stacking_Columns_by_Column_Label"></a><span class="mw-headline">列ラベルで列をスタッキングする</span></h2>
<p>ワークシート列のスタッキングツールを使って、素データモードからインデックスデータモードに変換することができます。元のデータセットでは、サンプルは、グループごとに別の列に保存されています。スタッキング後には同じ列の違う行に保存され、グループ情報を提供するワークシート(元のサンプルが属するグループ)の中に列が追加されます。
</p><p>この機能を使うには
</p>
<ol><li> データの入った新しいワークシートを作成します。 </li>
<li> データを選択します。 </li>
<li> メニューから<b>データ整形：列スタッキング</b>を選び、<b>wstackcol</b>ダイアログボックスを開きます。 </li></ol>
<p>実際には、Xファンクション<a class="external text" href="../../XFunction/X-Function/Wstackcol.html">wstackcol</a>が呼び出されて操作を行います。
</p>
<dl><dd><a  class="image"><img alt="Stacking Worksheet Columns 1.png" src="../images/Stacking_Worksheet_Columns/Stacking_Worksheet_Columns_1.png" width="876"  /></a></dd></dl>
<h3><a name="Dialog_Controls"></a><span class="mw-headline">ダイアログの設定</span></h3>
<table class="dialogcontroltable">
<tr>
<th>再計算
</th>
<td>
<p>結果を再計算する方法を指定します。詳細は<a href="../../UserGuide/UserGuide/Recalculating_Analysis_Results.html" title="ユーザガイド：分析結果の再計算">分析結果の再計算</a>を確認してください。
</p>
</td></tr>
<tr>
<th>入力スタック列
</th>
<td>
<p>ソースデータから列を選択します。少なくとも2列必要です。
</p>
</td></tr>
<tr>
<th>グループ識別子
</th>
<td>
<dl><dd><b>グループ行</b>
<dl><dd>グループ情報を含む列ラベル行を選択します。この情報を使って、ツールはサンプルが属するグループを識別します。複数行選択されている場合、グループの選択の順序は下側のテキストボックスに表示されます。</dd></dl></dd></dl>
</td></tr>
<tr>
<th>オプション
</th>
<td>
<p>スタッキングのオプション
</p>
<dl><dd><b>他の列を含める</b>
<dl><dd>出力の際に、他の列を含めるか指定します。このチェックボックスがチェックされていると、含める列を選択できます。</dd></dl></dd>
<dd><b>サブグループにスタック</b>
<dl><dd>元のサンプルを複数のサブグループにスタックするかどうか指定します。これが選択されていない場合、入力サンプルのすべてが1列に保存されます。このチェックボックスがチェックされると、サブグループの数またはサンプルがスタックされる列の数を指定できます。</dd>
<dd>例えば、元のデータに6グループあり、2つのサブグループを選択した場合、1、3、5番目のグループが1つ目のサブグループになり、残りは2つ目のサブグループになります。</dd></dl></dd>
<dd><b>グループの交互挿入</b>
<dl><dd>異なるグループからのサンプルを混ぜるかどうか指定します。 </dd>
<dd>例えば、元のデータセットに2つのグループがあり、このオプションを選択すると、出力列の偶数行は、最初のグループに属するサンプルで、奇数行は2番目のグループからのサンプルになります。このチェックボックスが選択されていない場合、出力列の最初の<i>n</i>行 (<i>n</i>は最初のグループのサンプル数) は、最初のグループからのサンプルを含み、残りの行は2番目のグループからのサンプルを含みます。</dd></dl></dd>
<dd><b>欠損行の排除</b>
<dl><dd>元の列にある欠損値を含む行を、無視するかどうかを指定します。</dd></dl></dd></dl>
</td></tr>
<tr>
<th>出力設定
</th>
<td>
<dl><dd><b>グループ列の<b>ロングネーム</b></b>
<dl><dd>グループ列のロングネームを指定します。以下のオプションがあります。
<ul><li><b>&lt;グループ行ヘッダ&gt;</b>
<dl><dd>グループ情報があるヘッダ行。言い換えると、<b>グループ行</b>(上記参照)です。</dd></dl></li>
<li><b>グループ</b>
<dl><dd>グループ<i>n</i></dd></dl></li>
<li><b>クラス</b>
<dl><dd>クラス<i>n</i></dd></dl></li></ul></dd></dl></dd>
<dd><b>データ列のロングネーム</b>
<dl><dd>出力データ列のロングネームを使用します。ロングネームが列挙されます。</dd></dl></dd>
<dd><b>出力ワークシート</b>
<dl><dd>結果を出力するワークシートを指定します。</dd></dl></dd></dl>
</td></tr></table>
<p><br />
</p>
<h3><a name="How_to_Stack_Columns"></a><span class="mw-headline">列をスタッキングする方法</span></h3>
<p>この機能は、列をスタック、行ごとに列をスタックできます。他の列を含めたり、サブグループの数を指定することもできます。そのため、スタッキングの方法は下記のように数通りになります。
</p>
<ul><li><b>スタック</b></li></ul>
<dl><dd>いくつかの列からの値を、グループ内の複数行にスタックします。</dd>
<dd><a  class="image"><img alt="Stack Columns.png" src="../images/Stacking_Worksheet_Columns/Stack_Columns.png" width="342"  /></a></dd></dl>
<ul><li><b>グループの交互挿入</b></li></ul>
<dl><dd>列を積み重ねていくのではなく、行インデックスに従って列をスタックします。列の値は交互に配置されます。</dd>
<dd><a  class="image"><img alt="Stack by Row.png" src="../images/Stacking_Worksheet_Columns/Stack_by_Row.png" width="342"  /></a></dd></dl>
<ul><li><b>別の列を含めてスタック</b></li></ul>
<dl><dd>このスタック方法は元のワークシート列にある他の列に加え、新規ワークシートに新しくスタックされた列を含みます。</dd>
<dd><a  class="image"><img alt="Include Non-stack Columns.png" src="../images/Stacking_Worksheet_Columns/Include_Non-stack_Columns.png" width="341"  /></a></dd></dl>
<ul><li><b>グループの交互挿入と別の列を含めるスタック</b></li></ul>
<dl><dd>行に従って列をスタックし、元のワークシートの非スタック列を含めます。</dd>
<dd><a  class="image"><img alt="Interleave Groups and Include Other Columns.png" src="../images/Stacking_Worksheet_Columns/Interleave_Groups_and_Include_Other_Columns.png" width="342"  /></a></dd></dl>
<ul><li><b>サブグループにスタック</b></li></ul>
<dl><dd>複数列を2つ以上のグループにスタックします。</dd>
<dd><a  class="image"><img alt="Multiple Output Variable Groups.png" src="../images/Stacking_Worksheet_Columns/Multiple_Output_Variable_Groups.png" width="342"  /></a></dd></dl>
<ul><li><b>グループの交互挿入とサブグループにスタック</b></li></ul>
<dl><dd>複数列を、行に従って2つ以上のグループにスタックします。</dd>
<dd><a  class="image"><img alt="Interleave Groups and Divided Groups.png" src="../images/Stacking_Worksheet_Columns/Interleave_Groups_and_Divided_Groups.png" width="342"  /></a></dd></dl>
<ul><li><b>サブグループ中にスタックし、他の列を含める</b></li></ul>
<dl><dd>複数の列を2つ以上のグループにスタックし、元のワークシートの非スタック列を含めます。</dd>
<dd><a  class="image"><img alt="Divide Groups and Include Other Columns.png" src="../images/Stacking_Worksheet_Columns/Divide_Groups_and_Include_Other_Columns.png" width="341"  /></a></dd></dl>
<ul><li><b>行によるスタック、サブグループにスタックし、他の列も含める</b></li></ul>
<dl><dd>複数の列を、行に従って2つ以上のグループにスタックし、元のワークシートの非スタック列を含めます。</dd>
<dd><a  class="image"><img alt="Interleave and Divide and Include Other Columns.png" src="../images/Stacking_Worksheet_Columns/Interleave_and_Divide_and_Include_Other_Columns.png" width="342"  /></a></dd></dl>
<h3><a name="Example"></a><span class="mw-headline">サンプル</span></h3>
<p>次の例では、サンプルデータファイル内の列を積み重ねて、別の形式で表示されるようにします。
</p>
<ol><li><i>\Samples\Statistics\Body.ogw</i>ファイルを開きます。
<dl><dd><a  class="image"><img alt="Wstackclos example 2.png" src="../images/Stacking_Worksheet_Columns/Wstackclos_example_2.png" width="392"  /></a></dd></dl></li>
<li>Maleワークシートの列B、C、およびDを選択し、メニューから<b>ワークシート：列スタッキング</b>を選択して、<b>wstackcol</b>ダイアログを開きます。</li>
<li><b>別の列を含める</b>と <b>グループの交互挿入</b>にチェックを付け、他の設定はデフォルトのままにします。 
<dl><dd><a  class="image"><img alt="Wstackcol example 3.png" src="../images/Stacking_Worksheet_Columns/Wstackcol_example_3.png" width="876"  /></a></dd></dl></li>
<li><b>OK</b>ボタンをクリックして実行します。次のような結果が出力されます。
<dl><dd><a  class="image"><img alt="Wstackclos example 1.png" src="../images/Stacking_Worksheet_Columns/Wstackclos_example_1.png" width="347"  /></a></dd></dl></li></ol>
<h2><a name="Stacking_Columns_by_Column_Designation"></a><span class="mw-headline">列属性で列をスタッキングする</span></h2>
<p><a href="../../UserGuide/UserGuide/Set_Column_Designation.html" title="ユーザガイド：列の属性の設定"><b>列（プロット）属性</b></a>でワークシートの列を重ねることもできます。<a class="external text" href="../../XFunction/X-Function/Coljoinbydesig.html">coljoinbydesig</a> Xファンクションダイアログはメニューからは開けませんが、ユーザーインターフェースで開くことができます。
</p>
<ol><li> <b>ウィンドウ</b>メニューをクリックして <b>スクリプトウィンドウ</b>または <b>コマンドウィンドウ</b>を開きます。</li>
<li> 以下をコピーして貼り付け（または入力し）、Enterキーを押します。</li></ol>
<pre class="lt" style="font-family:monospace;">coljoinbydesig <span style="color: #000080;">-</span>d</pre>
<dl><dd><a  class="image"><img alt="XF coljoinbydesig db.png" src="../images/Stacking_Worksheet_Columns/XF_coljoinbydesig_db.png" width="363"  /></a></dd></dl>
<p><br />
ダイアログコントロールの使い方は簡単です。
</p>
<ul><li> <b>入力</b>は、列属性で積み重ねるワークシートデータです。</li>
<li> <b>出力</b>は、積み重ねたデータ（新しいシート、新しいブックなど）を出力するフィールドです。</li></ul>
<dl><dd><a  class="image"><img alt="Output coljoinbydesig db.png" src="../images/Stacking_Worksheet_Columns/Output_coljoinbydesig_db.png" width="798"  /></a></dd></dl>




    