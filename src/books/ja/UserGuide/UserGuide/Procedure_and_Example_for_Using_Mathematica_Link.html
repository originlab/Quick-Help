<h1 class="firstheading">Mathematicaリンクを使う手順とその例</h1>
<p class="urlname" style="display: none;">Mathematica-Procedure-EX</p>
<p>このページでは、<b>OriginのMathematicaリンク</b>を使う手順とその例について説明します。ここで使っているバージョンは、Mathematica 10.0です。</p>
<div id="toc" class="toc">
<div id="toctitle">
<h2>目次</h2>
</div>
<ol>
<li class="toclevel-1 tocsection-1"><a href="#Start_Mathematica_Link_in_Origin"><span class="tocnumber">1</span> <span class="toctext">OriginでMathematicaリンクを起動する</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Examples"><span class="tocnumber">2</span> <span class="toctext">サンプル</span></a>
<ol>
<li class="toclevel-2 tocsection-3"><a href="#Example_1"><span class="tocnumber">2.1</span> <span class="toctext">サンプル 1</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Example_2"><span class="tocnumber">2.2</span> <span class="toctext">サンプル 2</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Example_3"><span class="tocnumber">2.3</span> <span class="toctext">サンプル 3</span></a></li>
</ol>
</li>
</ol>
</div>
<h2><a name="Start_Mathematica_Link_in_Origin" id="Start_Mathematica_Link_in_Origin"></a><span class="mw-headline">OriginでMathematicaリンクを起動する</span></h2>
<p>このツールを起動する前に、Originのkernel Osequencer.exe にリンクするように、Mathematica のKernel環境設定が必要です。詳細は、<a href="../../UserGuide/UserGuide/Launching_the_tool.html" title="ユーザガイド:起動ツール">このページ</a>を参照して下さい。</p>
<h2><a name="Examples" id="Examples"></a><span class="mw-headline">サンプル</span></h2>
<p>サンプルを見る前に、この前のセクションの手順に従ってMathematicaリンクを起動して下さい。</p>
<h3><a name="Example_1" id="Example_1"></a><span class="mw-headline">サンプル 1</span></h3>
<p>このサンプルでは、ワークシートデータをMethematicaに送ったり、Methematicaからデータを受け取ったりします。</p>
<ol>
<li>システムのデフォルトテーマを使って、データ<i>&lt;Origin Installation Directory&gt;/Samples/Signal Processing/fftfilter1.DAT</i> を新規ワークシートにインポートし、ワークブック名とワークシート名が <i>fftfilter1</i>というファイル名に変更されているかを確認します。</li>
<li><b style="font-weight: bold;">Mathematicaリンク</b>ダイアログの<b>列</b>タブを開きます。<b>列の送信</b>グループで、<b>Mathematica変数</b>を<i>raw</i>、 <b>Orginデータセット</b>を <i>[fftfilter1]fftfilter1!col(b)</i> に設定します。
<dl>
<dd><a class="image" style="color: #0000ff; text-decoration: underline;"><img alt="Mathematica Link Column Send.png" src="../images/Procedure_and_Example_for_Using_Mathematica_Link/Mathematica_Link_Column_Send.png" width="385" height="253" border="0" /></a></dd>
</dl>
</li>
<li><b style="font-weight: bold;">送信</b>ボタンをクリックし、Mathematicaにデータの第2行を送信します。</li>
<li><b style="font-weight: bold;">式の評価</b>タブに行き、下記の2行を入力します。
<dl>
<dd>temp=Fourier[raw]</dd>
<dd>realpart=Re[temp]</dd>
</dl>
</li>
<li><b style="font-weight: bold;">評価</b>ボタンを押し、結果を得ます。
<dl>
<dd><a class="image" style="color: #0000ff; text-decoration: underline;"><img alt="Mathematica Link Evaluate.png" src="../images/Procedure_and_Example_for_Using_Mathematica_Link/Mathematica_Link_Evaluate.png" width="622" height="365" border="0" /></a></dd>
</dl>
</li>
<li>ワークシートに行き、標準ツールバーの<b>列の追加ボタン</b><a class="image"><img alt="Mathematica Link Add Col Button.png" src="../images/Procedure_and_Example_for_Using_Mathematica_Link/Mathematica_Link_Add_Col_Button.png" width="23" height="23" border="0" /></a>をクリックし、ワークシートに列Cを追加します</li>
<li><b style="font-weight: bold;">Mathematicaリンク</b>ダイアログに戻り、<b>列</b>タブを開きます。<b>列の受信</b>グループを下記のように設定します。
<dl>
<dd><b style="font-weight: bold;">Mathematica変数</b>: realpart</dd>
<dd><b style="font-weight: bold;">Originデータセット:</b> [fftfilter1]fftfilter1!col(c)[fftfilter1]fftfilter1!col(c)</dd>
<dd><a class="image" style="color: #0000ff; text-decoration: underline;"><img alt="Mathematica Link Column Receive.png" src="../images/Procedure_and_Example_for_Using_Mathematica_Link/Mathematica_Link_Column_Receive.png" width="564" height="255" border="0" /></a></dd>
</dl>
</li>
<li><b style="font-weight: bold;">受信</b>ボタンをクリックすると、ワークシートの列Cに結果が表示されます。
<dl>
<dd><a class="image" style="color: #0000ff; text-decoration: underline;"><img alt="Mathematica Link Worksheet Result.png" src="../images/Procedure_and_Example_for_Using_Mathematica_Link/Mathematica_Link_Worksheet_Result.png" width="332" height="279" border="0" /></a></dd>
</dl>
</li>
</ol>
<h3><a name="Example_2" id="Example_2"></a><span class="mw-headline">サンプル 2</span></h3>
<p>このサンプルは、行列データをMethematicaに送ったり、Methematicaからデータを受け取ったりします。</p>
<ol>
<li>行列<i>&lt;Origin Installation Directory&gt;/Samples/Matrix Conversion and Gridding/2D Gaussian.ogm</i>を開きます。</li>
<li><b>Mathematicaリンク</b>ダイアログの<b>行列</b>タブを開きます。<b>列の送信</b>グループで、<b>Mathematica変数</b>を<i>mat</i>、<b>Origin行列</b>を<i>[MBook1]Data!1</i> と設定します。
<dl>
<dd><a class="image" style="color: #0000ff; text-decoration: underline;"><img alt="Mathematica Link Matrix Send.png" src="../images/Procedure_and_Example_for_Using_Mathematica_Link/Mathematica_Link_Matrix_Send.png" width="358" height="365" border="0" /></a></dd>
</dl>
</li>
<li><b style="font-weight: bold;">送信</b> ボタンをクリックします。</li>
<li>開始されない場合、Methematicaを開き、新しいノートブックを作成します。メニューから<b>評価： Notebook&amp;apos;s Kernel</b>を選択し、kernel "OSequencer"が選択されていることを確認してください。これでMathematicaの現在のノートブックとOriginの接続が確立されます。</li>
<li>次のスクリプトを入力します。
<pre class="lt" style="font-family: monospace;">
invmat <span style="color: #000080;">=</span> Inverse<span style="color: #000000;">[</span>mat<span style="color: #000000;">]</span>
        
</pre>
実行します。
<dl>
<dd><a class="image" style="color: #0000ff; text-decoration: underline;"><img alt="Mathematica Link Mathematica.png" src="../images/Procedure_and_Example_for_Using_Mathematica_Link/Mathematica_Link_Mathematica.png" width="436" height="237" border="0" /></a></dd>
</dl>
</li>
<li>Originに戻ります。新しい行列オブジェクトをデータ表列シートに追加します。データ行列シートの右上にある<b>D</b>アイコンをクリックして、<b>追加</b>を選択して、新しいオブジェクトを追加します。</li>
<li><b style="font-weight: bold;">Mathematicaリンク</b>ダイアログをアクティブにして、<b>行列の受信</b>グループを下記のように設定します。
<dl>
<dd><b style="font-weight: bold;">Mathematica変数</b>: invmat</dd>
<dd><b style="font-weight: bold;">Origin 行列</b>:[MBook1]Data!2</dd>
<dd><a class="image" style="color: #0000ff; text-decoration: underline;"><img alt="Mathematica Link Matrix Receive.png" src="../images/Procedure_and_Example_for_Using_Mathematica_Link/Mathematica_Link_Matrix_Receive.png" width="622" height="365" border="0" /></a></dd>
</dl>
</li>
<li><b>受信</b>ボタンをクリックすると、元の行列が逆行列に置き換わります。
<dl>
<dd><a class="image" style="color: #0000ff; text-decoration: underline;"><img alt="Mathematica Link Matrix Result.png" src="../images/Procedure_and_Example_for_Using_Mathematica_Link/Mathematica_Link_Matrix_Result.png" width="385" height="339" border="0" /></a></dd>
</dl>
</li>
</ol>
<h3><a name="Example_3" id="Example_3"></a><span class="mw-headline">サンプル 3</span></h3>
<p>このサンプルでは、Mathematicaでユーザ定義関数を作成してから、作図します。</p>
<ul>
<li>開始されない場合、Methematicaを開き、新しいノートブックを作成します。メニューから評価<b>：</b>Notebook&amp;apos;s Kernelを選択し、kernel "OSequencer"が選択されていることを確認してください。これでMathematicaの現在のノートブックとOriginの接続が確立されます。</li>
<li>関数は次の様に定義されます。<br />
<pre class="lt" style="font-family: monospace;">
f1<span style="color: #000000;">[</span>x_<span style="color: #000000;">]</span> <span style="color: #000000;">:</span><span style="color: #000080;">=</span> <span style="color: #000000;">(</span>FresnelS<span style="color: #000000;">[</span>x<span style="color: #000000;">]</span> <span style="color: #000080;">+</span> <span style="color: #0000dd;">1</span><span style="color: #000080;">/</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span><span style="color: #000080;">^</span><span style="color: #0000dd;">2</span> <span style="color: #000080;">+</span> <span style="color: #000000;">(</span>FresnelC<span style="color: #000000;">[</span>x<span style="color: #000000;">]</span> <span style="color: #000080;">+</span> <span style="color: #0000dd;">1</span><span style="color: #000080;">/</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span>
        
</pre></li>
<li>Originに戻ります。<b>Mathematicaリンク</b>ダイアログの<b>関数</b>タブで、次のように式、曲線範囲、データポイント個数を指定します。<br />
<table class="noborder">
<tr style="vertical-align: top;">
<td>
<p><b style="font-weight: bold;">f(x) =</b>: f1[x^2+2]<br />
<b>開始</b>:0<br />
<b>終了</b>:10<br />
<b>ポイント</b>:2000</p>
</td>
<td><a class="image" style="color: #0000ff; text-decoration: underline;"><img alt="Mathematica Link Function.png" src="../images/Procedure_and_Example_for_Using_Mathematica_Link/Mathematica_Link_Function.png" width="562" height="264" border="0" /></a></td>
</tr>
</table>
</li>
<li><b style="font-weight: bold;">作図</b>ボタンをクリックして、ユーザ定義関数が作図されます。<br />
<a class="image"><img alt="Mathematica Link Function Plot.png" src="../images/Procedure_and_Example_for_Using_Mathematica_Link/Mathematica_Link_Function_Plot.png" width="396" height="282" border="0" /></a></li>
</ul>
