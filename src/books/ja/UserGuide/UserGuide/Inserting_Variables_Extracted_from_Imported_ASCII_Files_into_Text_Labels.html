<h1 class="firstheading">インポートしたASCIIファイルから抽出した変数を、テキストラベルに挿入する</h1><p class='urlname' style='display: none'>InsVar-Metadata-TextLabel</p>
<h2><a name="By_Insert:_Info_Variable_dialog"></a><span class="mw-headline">挿入：情報変数ダイアログより</span></h2>
<p>ASCIIファイルヘッダ行から抽出した<a href="../../UserGuide/Category/Accessing_Metadata_Associated_with_Imported_Files.html" title="カテゴリ：インポートしたファイルに関連するメタデータにアクセス">メタデータ</a>は、次の方法でテキストラベルに挿入することができます。
</p>
<ol><li>標準的な「インプレース」テキストラベル作成法を使って、新しいテキストラベルを作成します。</li>
<li>テキスト入力モードで、「CTRL＋Hキー」を押すか、右クリックをして、<b>情報変数の挿入</b>を選びます。  <a href="../../UserGuide/UserGuide/The_Insert_Info_Variables_Dialog_Box.html" title="ユーザガイド: 変数の挿入ダイアログボックス"><b>変数の挿入</b></a>ダイアログボックスが開きます。変数が抽出され、異なるレベルの格納されます(ブック、シート、列)目的の変数を挿入するための対応するレベルを選択します。サンプルとして <i>/Samples/Import and Export/S15-125-03.dat</i> を使用します。ブックのレベルでは、次のようにして変数の挿入が可能です。</li></ol>
<dl><dd><a  class="image"><img alt="Inserting Variables 01.png" src="../images/Inserting_Variables_Extracted_from_Imported_ASCII_Files_into_Text_Labels/Inserting_Variables_01.png" width="813"  /></a> </dd>
<dd>シートのレベルでは、次のようにして変数の挿入が可能です。</dd>
<dd><a  class="image"><img alt="Inserting Variables 02.png" src="../images/Inserting_Variables_Extracted_from_Imported_ASCII_Files_into_Text_Labels/Inserting_Variables_02.png" width="857"  /></a> </dd>
<dd>列のレベルでは、列ラベル行に変数を挿入できます。</dd>
<dd><a  class="image"><img alt="Inserting Variables 03.png" src="../images/Inserting_Variables_Extracted_from_Imported_ASCII_Files_into_Text_Labels/Inserting_Variables_03.png" width="987"  /></a> </dd></dl>
<p><b><b>情報変数の挿入</b></b>ダイアログボックスは、ASCIIファイルインポート中に抽出された変数を一覧表示します。  次の3つの方法で、変数を選択し挿入することができます。
</p>
<table class="simple">
<tr>
<th>テキスト
</th>
<td>
<p><b>リンクとして挿入</b>チェックボックスか、<b>&quot;Property = Value&quot;として挿入</b>チェックボックスのいずれも選択していない場合、変数の値はリテラルテキストとして挿入されます。
</p>
<dl><dd><a  class="image"><img alt="Inserting Variables 3.png" src="../images/Inserting_Variables_Extracted_from_Imported_ASCII_Files_into_Text_Labels/Inserting_Variables_3.png" width="390"  /></a></dd></dl>
</td></tr>
<tr>
<th>リンクとして挿入
</th>
<td>変数の値に動的にリンクする文字列を挿入するには、このボックスにチェックを付けます。文字列の値を変更すると、次にファイルをインポートするときにラベルの値が変更されます。このオプションは<a class="external text" href="../../LabTalk/LabTalk/Substitution_Notation.html">置換表記</a>と<a class="external text" href="../../LabTalk/LabTalk/Text_Label_Options.html">テキストラベルオプション</a>を組み合わせたもので、柔軟な方法でラベルを表示できます。詳しくは、<a href="../../UserGuide/UserGuide/Linking_Text_Labels_to_Data_and_Variables.html" title="ユーザガイド:テキストラベルを、データと変数にリンク">テキストラベルを、データと変数にリンク</a>を参照してください。
</td></tr>
<tr>
<th>&quot;Property = Value&quot;として挿入
</th>
<td>
<p>このボックスを選択して、テキストラベルに<i><i>「変数名= 値」</i></i>を挿入します。
</p>
<dl><dd><a  class="image"><img alt="Inserting Variables 4.png" src="../images/Inserting_Variables_Extracted_from_Imported_ASCII_Files_into_Text_Labels/Inserting_Variables_4.png" width="446"  /></a></dd></dl>
</td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Inserting_Variables_Extracted_from_Imported_ASCII_Files_into_Text_Labels/Tip_icon.png" width="57"  border="0" /></td><td><p>メタデータ変数は、次のコマンドを使って、スクリプトウィンドウで表示することができます。
</p>
<pre class="lt" style="font-family:monospace;">Page.<span style="color: #000080;">info</span>.<span style="color: #000080;">user</span>.<span style="color: #000080;">=</span></pre>
<p>これらをテキストラベルに組み込むことに加えて、ダイアログボックスなどの<a class="external text" href="../../XFunction/X-Function/Calling_X-Functions_from_Script.html#Use_File_Metadata_as_Input">一部のXファンクション</a>の入力として、これらの変数を使用できます。また、ワークシート列の右側の灰色の領域を右クリックして、<b>オーガナイザを表示</b>を選択しても、ワークシートのメタデータを表示できます。<code>page.info</code> の項目にある、USER.VARIABLES.を探します。これらは右側のパネルにリストされます。変数名を右クリックして、<b>ノードパスをコピーする</b>を選択し、Xファンクションダイアログの適切な個所に貼り付けます。 
</p></td></tr></table>
<h2><a name="By_Workbook_Organizer"></a><span class="mw-headline">ワークブックオーガナイザより</span></h2>
<p>ASCIIファイルヘッダ行から抽出した<a href="../../UserGuide/Category/Accessing_Metadata_Associated_with_Imported_Files.html" title="カテゴリ：インポートしたファイルに関連するメタデータにアクセス">メタデータ</a>は、<a href="../../UserGuide/UserGuide/The_Workbook_Organizer.html" title="ユーザガイド：ワークブックオーガナイザ">ワークブックオーガナイザ</a>で閲覧・コピーすることができます。次の方法でメタデータをコピー・貼り付けができます。
</p>
<ol><li>ワークブックウィンドウの左下隅にある<b>オーガナイザを表示/非表示</b>ボタン<a  class="image"><img alt="Show Hide Organizer.png" src="../images/Inserting_Variables_Extracted_from_Imported_ASCII_Files_into_Text_Labels/Show_Hide_Organizer.png" width="18"  /></a>をクリックします。</li>
<li>目的の変数の編集ボックス、編集不可の青いテキスト、または変数名を右クリックし、<b>ノードパスをコピーする</b>を選択します。 </li>
<li>対象の列ラベルセルまたはワークシートセル、またはグラフまたはワークシートのテキストオブジェクトに移動し、右クリックして<b>リンクの貼り付け</b>を選択します。</li></ol>
<dl><dd><a  class="image"><img alt="Worksheet Organizer Copy header Info.gif" src="../images/Inserting_Variables_Extracted_from_Imported_ASCII_Files_into_Text_Labels/Worksheet_Organizer_Copy_header_Info.gif" width="524"  /></a></dd></dl>


    