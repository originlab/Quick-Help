<h1 class="firstheading">バッチ処理</h1><p class='urlname' style='display: none'>バッチ処理</p>
<div style="text-align: left; direction: ltr; margin-left: 1em;"><p><a  class="image"><img alt="Video Image.png" src="../images/Batch_Processing/Video_Image.png" width="33"  /></a> 関連する動画: <a class="external text" href="http://www.originlab.com/Index.aspx?go=Support/VideoTutorials&amp;ss=chm&amp;pid=1559" target="_blank">Batch Processing</a>, <a class="external text" href="http://www.originlab.com/Index.aspx?go=Support/VideoTutorials&amp;ss=chm&amp;pid=1886" target="_blank">Batch Processing of Peak Data using Theme</a>
</p></div>
 <div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#The_Batch_Processing_Dialog_Box"><span class="tocnumber">1</span><span class="toctext">バッチ処理のダイアログボックス</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Examples"><span class="tocnumber">2</span> <span class="toctext">サンプル</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Example_1:_Import_.DAT_files_and_perform_nonlinear_curve_fitting"><span class="tocnumber">2.1</span> <span class="toctext">サンプル１: DATファイルのインポートと非線形フィット</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Example_2:_Perform_batch_analysis_on_groups_of_CSV_files"><span class="tocnumber">2.2</span> <span class="toctext">サンプル 2: CSVファイルのバッチ分析</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Example_3:_Perform_batch_analysis_and_create_reports_using_a_custom_MS_Word_template"><span class="tocnumber">2.3</span> <span class="toctext">サンプル3: バッチ分析とMSワードテンプレートを使ったレポートの作成</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Example_4:_Perform_batch_processing_on_worksheets_in_your_project_file"><span class="tocnumber">2.4</span> <span class="toctext">サンプル 4: プロジェクトファイル内のワークシートのバッチ処理</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Example_5:_Perform_batch_processing_on_datasets_grouped_by_worksheet_column"><span class="tocnumber">2.5</span> <span class="toctext">サンプル 5: プロジェクトファイル内のワークシート列でグループ化されたデータセットのバッチ処理</span></a></li>
</ul>
</li>
</ul>
</div>
<dl><dd><a  class="image"><img alt="UserGuide Batch Processing 001-vNext.png" src="../images/Batch_Processing/650px-UserGuide_Batch_Processing_001.png" width="782"   /></a><br /></dd></dl>
<p><b>バッチ処理</b>ツールで、既存の<b><a href="../../UserGuide/UserGuide/Analysis_Templates.html" title="ユーザガイド:分析テンプレート">分析テンプレート</a></b>を使って、複数データセットについて繰り返し分析を行います。オプションで、分析結果をWordテンプレートに出力します。ディスク内の複数のデータファイルを処理したり、すでにプロジェクト内にあるデータをループする事ができます。
</p><p><a href="../../UserGuide/UserGuide/Analysis_Templates.html" title="ユーザガイド:分析テンプレート">分析テンプレート</a>を作成するには、操作 (例、曲線フィット)を実行し、<b><a href="../../UserGuide/UserGuide/Recalculating_Analysis_Results.html" title="ユーザガイド：分析結果の再計算">再計算</a></b>モードを自動または手動にします。  任意で結果シートを追加することができ、そこに分析操作で得た結果(例、ファイル名。曲線フィットで生成したパラメータテーブルからの値のサブセットなど)をリンクが貼り付けられています。  そして、バッチ処理ツールを使って複数データファイルまたはデータセットから結果シートデータをまとめたサマリーレポートを作成します。
</p><p>オプションで、Wordテンプレートのブックマークを使って、Word/PDFファイルに解析結果を出力する選択をすることができます。Wordテンプレートのこのブックマークは、 <a href="../../UserGuide/UserGuide/Add_Word_Bookmarks_to_Analysis_Template_Dialog.html" title="ユーザガイド：分析テンプレートダイアログにWordブックマークを追加">分析テンプレートにブックマークを追加</a>ダイアログを使って、指定した分析テンプレートに追加された場合のみ有効です。追加された<i><b>ブックマーク</b></i>ワークシートは、自動で作成され、分析レポートからセルにリンクした分析結果と、エクスポートされたグラフサイズのブックマークを保存します。
</p><p>ツールが複数ファイルを処理するのに使われるとき、インポート設定 (例、カスタムASCII 設定、またはインポートウィザードのフィルタ設定)が<b><b>分析テンプレート</b></b>の一部として保存されます。  インポート中に抽出された変数は、<b>結果シート</b>にリンク貼り付けでき、そして、この情報はバッチ処理ツールが作成した<b>サマリー</b>レポートに表示されます。
</p><p><b>分析テンプレート</b>には以下が含まれます。
</p>
<ol><li><b>元データ</b>のワークシート</li>
<li><b>分析レポート</b>のワークシート。これらは、分析処理 (非線形フィットなど)で生成されたレポートシートです。</li>
<li>分析レポートからセルリンクした分析結果を含む任意の<b>結果ワークシート</b>およびファイルヘッダから抽出したファイル名またはパラメータなどのインポート変数 </li>
<li>任意の<b>ブックマーク</b>ワークシートは、Wordテンプレートから分析テンプレートにブックマークを追加する際に、自動で生成されます。<i><b>ブックマーク</b></i>ワークシートには、Wordテンプレートからブックマークを保存する<i>ブックマーク</i>列、分析レポートからセルリンクした分析結果を保存する<i>リンク</i>列、Wrod/PDFファイルにエクスポートするグラフサイズを調整する<i>グラフ幅</i>列があります。</li></ol>
<p><b>バッチ処理</b>ダイアログで全ての設定をすませ、<b>OK</b>をクリックすると、<b>バッチ処理モード</b>と <b>ファイルリスト</b>の内容を除くすべての設定が分析テンプレートに保存されます。<b>バッチ処理モード</b>を<b>アクティブ分析テンプレート中に繰り返しインポート</b>に設定するには、初期設定として分析テンプレートをUser Files フォルダに保存します。<b>バッチ処理モード</b>が<b>分析テンプレートのロード</b>に設定されている場合、オリジナルのテンプレートは自動的に更新が行われます。(この際、テンプレートファイルはOriginがインストールされているフォルダやそのサブフォルダに保存してはいけません。)
</p>
<table class="note">
<tr>
<td><b>Note:</b>
<ol><li> バッチ処理の設定は<b>バッチ処理</b>ダイアログを開いている時だけ、保存することができます。スクリプトからバッチ処理Ｘファンクションを使用している場合、設定は保存されません。</li>
<li> もしダイアログを設定内容をデフォルトのパス以外に保存したい場合は、システム変数@BST = -1と設定します。<b>バッチ処理ダイアログの設定内容を分析テンプレートに保存</b>のメッセージボックスが開きますので、<b>バッチ処理</b>ダイアログの中の<b>ＯＫ</b>をクリックして、設定を保存する場所を変更できます。@BTSを設定するにはメニューから<b>環境設定: </b><a class="external text" href="../../UserGuide/UserGuide/Set_System_Variables_Dialog_Box.html">システム変数 </a><b></b>を選択します。</li></ol>
<dl><dd><a  class="image"><img alt="UserGuide Batch Processing 002.png" src="../images/Batch_Processing/UserGuide_Batch_Processing_002.png" width="500"  /></a></dd></dl>
</td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Batch_Processing/Tip_icon.png" width="57"  border="0" /></td><td><p>バッチ処理ほどの柔軟さや強力さはありませんが、<a class="external text" href="../../Tutorial/Tutorial/Importing_Multiple_Files_into_Workbooks_Cloned_from_Active_Workbook.html">このチュートリアル</a>で概説されている手順を使用して、アクティブなブックでインポートおよび分析操作を「複製」できます。
</p></td></tr></table>
<h2><a name="The_Batch_Processing_Dialog_Box"></a><span class="mw-headline">バッチ処理のダイアログボックス</span></h2>
<p>開くには、<b><b>ファイル</b></b>をクリックし、<b><b>バッチ処理</b></b>をクリックします。
</p>
<table class="dialogcontroltable">
<tr>
<th> バッチ処理モード
</th>
<td> バッチ処理を実行する方法を指定します。
<ul><li> <b>アクティブ分析テンプレートウィンドウ中に繰り返しインポートする</b>
<dl><dd> ワークブックが既に分析テンプレートとしてセットアップされているものとしてアクティブなワークブックウィンドウに繰り返しデータをインポートします。</dd></dl></li>
<li> <b>分析テンプレートをロード</b>
<dl><dd> 指定の分析テンプレートワークブック(.OGW)をロードします。</dd></dl></li></ul>
</td></tr>
<tr>
<th> 分析テンプレート
</th>
<td> <b><b>バッチ処理モード</b></b>が<b><b>分析テンプレートをロー</b></b><b>ド</b>にセットされているときに利用できます。これを使って、バッチ処理の分析テンプレートを指定します。
</td></tr>
<tr>
<th> エクスポート
</th>
<td> アクティブ/ロード分析テンプレートに、シート名<i><b>ブックマーク</b></i>がある場合のみ有効です。オプションを使って、どのファイルタイプに分析レポートをエクスポートするのかを指定します。オプションは、次の通りです。
<ul><li><b>なし</b> 
<dl><dd> ファイルにエクスポートなし</dd></dl></li>
<li><b>Word</b>
<dl><dd> Wordファイルにエクスポート</dd></dl></li>
<li><b>PDF</b>
<dl><dd> PDFファイルにエクスポート</dd></dl></li>
<li><b>Word&amp;PDF</b>
<dl><dd> WordとPDFファイル両方にエクスポート</dd></dl></li></ul>
</td></tr>
<tr>
<th> Wordテンプレート
</th>
<td> アクティブ/ロード分析テンプレートに、シート名<i><b>ブックマーク</b></i>がある場合のみ有効です。このオプションを使用してバッチ処理結果のレポートにWordテンプレートを指定します。
</td></tr>
<tr>
<th> エクスポートパス
</th>
<td> アクティブ/ロード分析テンプレートに、シート名<i><b>ブックマーク</b></i>がある場合のみ有効です。このオプションを使って、Wordテンプレート内のブックマークを使ったバッチ分析結果を、どこにエクスポートするのかを指定します。WordおよびPDFファイルは、同じ場所にエクスポートされます。
</td></tr>
<tr>
<th> マルチページファイル<br />としてエクスポート
</th>
<td> このチェックボックスにチェックを付けて全PDFまたはWordファイルを単一ファイルとして統合します。
</td></tr>
<tr>
<th> データソース
</th>
<td> データソースは以下から利用できます。
<ul><li> <b>指定したファイルをインポート</b>
<dl><dd> 指定したファイルからデータをインポートします。分析テンプレートにデータコネクタが含まれている場合、<b>データソース</b>は<b>指定したファイルをインポート</b>する必要があります。</dd></dl></li>
<li> <b>フォルダから全てのファイルをインポート</b>
<dl><dd> 指定したフォルダからすべてのファイルをインポートします。</dd></dl></li>
<li> <b>既存XYデータセットを使用</b>
<dl><dd> 現在のプロジェクトで<b>XY範囲のデータ</b>にバッチ処理を実行します。 </dd></dl></li>
<li> <b>既存XYZデータセットを使用</b>
<dl><dd> 現在のプロジェクトで<b><b>XYZ範囲のデータ</b></b>にバッチ処理を実行します。 </dd></dl></li>
<li> <b>既存ワークシートを使用</b>
<dl><dd> 現在のプロジェクトで選択されたワークシートにバッチ処理を実行します。</dd></dl></li></ul>
<p><br />このオプションは、データを参照しない統計ツールで役立ちます。ワークシートを同じ構造で設定した場合、このオプションを選択すると、ワークシートの内容が分析テンプレートにコピーされ、プロセスが1つずつ取り込まれます。 
</p>
<ul><li> <b>既存範囲を使用</b>
<dl><dd> 現在のプロジェクトで選択された範囲にバッチ処理を実行します。</dd></dl></li></ul>
</td></tr>
<tr>
<th> ワークブックのインポート設定を利用
</th>
<td> <b>データソース</b>が<b>指定したファイルをインポート</b>の場合のみ利用できます。  最後にインポートした時の設定を使用するかどうかを指定します。
</td></tr>
<tr>
<th> ファイルリスト
</th>
<td> <b>指定したファイルをインポート</b>が使われるときに利用できます。バッチ処理のデータファイルを選択します。*.dat, *.txt, *.csv, *.xls, *.xlsx, *.xlsm ファイルがサポートされています。
<p>Origin 2018b以降では、<a href="../../UserGuide/UserGuide/Adding_Existing_Graphs_Matrixs_as_Sheets.html#Embedding_Graphs_and_Matrices_in_Analysis_Templates" title="ユーザガイド:既存のグラフ/行列をシートとして追加">ワークブックに行列、<b>分析テンプレート</b></a>を埋め込み、バッチ分析を行うことができます。行列は<a class="external text" href="../../QuickHelp/QuickHelp/What_is_the_difference_between_data_and_image.html">データや画像ファイル</a>を保存することができます。データモードでは、データファイル(.dat, .txtなど)を行列にインポートして表示、画像モードでは画像ファイル(.jpg, .tifなど)を表示することができます。<b>バッチ処理モード</b>でも行列にファイルをインポートできます。
</p>
</td></tr>
<tr>
<th> フォルダ
</th>
<td> <b>データソース</b>が<b>フォルダから全てのファイルをインポート</b>の場合に利用できます。インポートされるファイルのフォルダを指定します。
</td></tr>
<tr>
<th> ファイル拡張子
</th>
<td> <b>データソース</b>が<b>フォルダから全てのファイルをインポート</b>の場合に利用できます。インポートされるファイルの拡張子を指定します。複数の拡張子がある場合は、セミコロンをセパレータとして使用できます。
<p><i>例：</i> <b>*.dat*; *.csv*</b>
</p>
</td></tr>
<tr>
<th> 入力
</th>
<td> <b>データソース</b>が<b><b>既存のXY(Z)データセットを使用</b></b>にセットされているときに利用できます。現在のシートや現在のブック、あるいは<b>データセットブラウザ</b>ツールで実行した選択など、プロジェクト内のどの場所からでも分析の<b>XY(Z)範囲</b>を指定します。  (データセットブラウザツールを実行するには、<b><b>入力</b></b>の右にある<b><b>矢印</b></b>をクリックし、<b><b>列の選択...</b></b> をクリックします。)
</td></tr>
<tr>
<th> ワークシート
</th>
<td> <b>データソース</b>が<b>既存のワークシートを使用</b>にセットされているときに利用できます。右向きの矢印をクリックして、<b>ブック中のシート</b>、<b>フォルダ中のシート</b>、<b>フォルダ中のシート(サブフォルダ再帰)</b>または<b>プロジェクト中のシート</b>でフィルタリングできます。または、ワークシートを選択を選んで、<b>シートブラウザ</b>を開きます。<b>リセット</b>は、選択ウィンドウの内容をクリアします。
</td></tr>
<tr>
<th> 固定範囲
</th>
<td> <b>データソース</b>が<b><b>既存範囲を使用</b></b>にセットされているときに利用できます。テンプレートのデータシート内の対応する列にコピーされるだけで、各処理ループでは計算に関与しない固定範囲を指定します。
</td></tr>
<tr>
<th> バッチ範囲
</th>
<td> <b>データソース</b>が<b><b>既存範囲を使用</b></b>にセットされているときに利用できます。バッチ処理中の計算の入力として使用されるバッチ範囲を指定します。
</td></tr>
<tr>
<th> データセット識別子
</th>
<td> 分析するデータセットを識別するため結果ワークシートに&quot;Dataset&quot;というロングネームを持つ列を追加するかどうかを指定します。
<ul><li> <b><b>なし</b></b>の場合、この列は追加されません。 </li>
<li> <b>データソース</b>を<b>指定したファイルをインポート</b>にした場合、オプションは、<b>ファイル名</b>と<a href="../../UserGuide/UserGuide/Displaying_Supporting_Data_in_Worksheet_header_Rows.html" title="ユーザガイド:ワークシートヘッダ行に表示するサポートデータ">列ラベル行</a>に表示されているデータシートに関連する情報です。 </li>
<li> <b>データソース</b>を<b>フォルダから全てのファイルをインポート</b>にした場合、オプションは、<b>ファイル名</b>と<a href="../../UserGuide/UserGuide/Displaying_Supporting_Data_in_Worksheet_header_Rows.html" title="ユーザガイド:ワークシートヘッダ行に表示するサポートデータ">列ラベル行</a>に表示されているデータシートに関連する情報です。 </li>
<li> <b>データソース</b>を<b>既存XY(Z)データセットを使用</b>にした場合、オプションは、<b>ファイル名</b>と<a href="../../UserGuide/UserGuide/Displaying_Supporting_Data_in_Worksheet_header_Rows.html" title="ユーザガイド:ワークシートヘッダ行に表示するサポートデータ">列ラベル行</a>に表示されているデータシートに関連する情報です。</li>
<li> <b>データソース</b>を<b>既存ワークシート</b>を使用にした場合、オプションは、<b>範囲</b>、<b>ブック名</b>、<b>シート名</b>です。</li>
<li> <b>データソース</b>を<b>既存範囲を使用</b>にした場合、オプションは、<b>範囲</b>、<b>ブック名</b>、<b>シート名</b>です。</li></ul>
</td></tr>
<tr>
<th> 属性
</th>
<td> この設定項目は、<b>データセット識別子</b>を分析テンプレートに表示された<a href="../../UserGuide/UserGuide/Displaying_Supporting_Data_in_Worksheet_header_Rows.html" title="ユーザガイド:ワークシートヘッダ行に表示するサポートデータ">列ラベル行</a>にセットしたときに追加されます（<b>モード</b>=<b>繰り返しインポート</b>、<b>データソース</b>=<b>指定したファイルをインポート</b>もしくは<b>フォルダから全てのファイルをインポート</b>の時は使用できません）。
<p>データセット識別子にする列を指定するために使用します。デフォルトの<b>&lt;自動&gt;</b>は、現在の設定を使用します。 
</p>
</td></tr>
<tr>
<th> データシート
</th>
<td> データがインポートされる分析テンプレートの元データシートの名前を指定します。テンプレートに複数データシートがある場合、オプション<b>&lt;自動&gt;</b>が選択すると、グループファイルを対応するデータシートへ、順番にインポートすることが可能です。更に、<b>&lt;カスタム&gt;</b>を選択した場合、デフォルトのオプション<b>&lt;自動&gt;</b>で出てくるデータシートを追加・削除することが可能です。
<p>インポートするファイルを選択するときに（<b>データソース</b>の下）、<b>開く</b>ダイアログの下部パネルで名前、サイズ、日付のヘッダをクリックしてファイルをソートできます。
カスタムASCIIインポート設定またはインポートウィザードフィルタなどのインポート設定を分析テンプレートのデータシートに保存することができます。詳細は、<a href="../../UserGuide/UserGuide/Customizing_the_ASCII_Import_Options.html" title="ユーザガイド：ASCIIインポートオプションをカスタマイズする">ASCII 設定を保存する</a> および <a href="../../UserGuide/UserGuide/Import_Wizard_Save_Filters_Page_(All_Data_Types).html" title="ユーザガイド：インポートウィザード、フィルタの保存ページ(すべてのデータタイプ)">フィルタの保存ページ</a> をご覧ください。
</p>
</td></tr>
<tr>
<th> 結果シート
</th>
<td> 分析テンプレートで任意の<b>結果ワークシート</b>を指定します。これはツールで処理されたデータセットまたはファイルのまとまった情報が含まれています。<b><b>結果シート</b></b>が<i><i>&lt;なし&gt;</i></i> の場合、<b><b>データセット識別子</b></b>は利用できません。
</td></tr>
<tr>
<th> 出力シート
</th>
<td> <b>結果シート</b>の内容は<b>出力シート</b>に追加されます。
<ul><li> デフォルトの設定 -- <b>[Summary]Results&lt;new template:=BatchResult&gt;!</b> では、出力シートを<b>Results</b>という名前で<b>BatchResult</b>というテンプレートの内のブックに保存します。</li>
<li> メニュー<b>&lt;新規&gt;</b>を選ぶと、アクティブなワークブックに出力シートを書き込みます。ワークブックが無い場合は新しく作成します。</li>
<li> メニュー<b>&lt;新規&gt;</b>を選ぶと、アクティブなワークブックに出力シートを書き込みます。</li>
<li> 既存のシートを指定して、書き込むこともできます。</li></ul>
<p><b>結果シート</b>が<i><i>&lt;なし&gt;</i></i>の場合、<b>出力シート</b>は利用できません。
</p>
<table class="note">
<tr>
<td><b>Note:</b>  (1) <b>バッチ処理モード</b> = <i>分析テンプレートのロード</i>, (2) <b>データソース</b> = <i>指定したファイルをインポート</i> and (3) <b>出力シート</b> = <i>[Summary]Results&lt;new template:=BatchResult&gt;!</i> の場合、BatchResultテンプレートにはウィンドウ上部のスペースに3つのボタンが表示されます。
<ul><li> <b>Open Book(s)</b>:<b>中途生成されたワークブックの削除</b>をオンにしており（次項をご覧ください）、あとからこれらのデータが必要だと判断した場合には<i>Result</i>シートで対応する行を選択し、このボタンをクリックすることで削除されたブックを再生成することができます。</li>
<li> <b>Reprocess</b>:外部のデータファイルに変更があった場合にこのボタンをクリックして選択されたファイルの再インポートと結果の更新を行うことができます。</li>
<li> <b>Update</b>:分析の入力側で変更があった際に（例：データのマスクをした）、このボタンをクリックして選択されたファイルの結果を更新できます。</li></ul>
</td></tr></table>
</td></tr>
<tr>
<th> 中途生成されたワークブックの削除
</th>
<td>
<p>処理が完了したら、途中で生成された各データセットに対する結果ワークブックを削除するかどうかを指定します。 
</p><p>上記の<b>出力シート</b>にある「Note」を参照してください。
</p>
</td></tr>
<tr>
<th> オプション
</th>
<td> 次の項目があります。
<ul><li><b>追加の開始行番号</b>
<dl><dd> 結果を追加する出力シート内の開始行を指定します。 </dd></dl></li>
<li> <b>開始時に出力シートをクリア</b>
<dl><dd> バッチ処理を開始するときに、出力シートをクリアします。新しいファイルまたはデータセットに分析を繰り返す場合、このチェックボックスのチェックを外します。そして、前のバッチ分析からの既存のサマリー情報に新たなサマリ情報を追加します。</dd></dl></li>
<li> <b>ラベル行の追加</b>
<dl><dd> このチェックボックスはデフォルトでは選択されていません。これを使って、列ラベル行の下にあるセルの列に、ラベル行を追加するかどうかを指定します。 </dd>
<dd> 出力シートがExcelシートの場合、シートの始まりに列ラベル行がないので、このオプションを使って、セル列にラベルを追加します。 </dd></dl></li>
<li> <b>追加モード</b>
<dl><dd> <b>行</b>ごと、または<b>列</b>ごとに分析結果の追加の仕方を決定します。<b>列</b>オプションでは、<b>出力シート</b>設定をご覧ください。<b>列</b>オプションを選んだ場合、<i>データセットＩＤ</i>の列ラベルを持つユーザ定義パラメータが追加されます。</dd></dl></li></ul>
<dl><dd><dl><dd><a  class="image"><img alt="BatchProcess Append by Cols.png" src="../images/Batch_Processing/BatchProcess_Append_by_Cols.png" width="443"  /></a></dd></dl></dd></dl>
</td></tr>
<tr>
<th>スクリプト
</th>
<td>次の項目があります。
<ul><li> <b>各処理前のスクリプト</b>
<dl><dd> 各ファイルやデータセットを処理する前に、LabTalkスクリプトを実行します。Note:</dd>
<dd><b>fname$</b>は、i番目のファイルを示します。</dd>
<dd><b>_rx</b>は、i番目のxデータセットの範囲を示します。</dd>
<dd><b>_ry</b>は、i番目のyデータセットの範囲を示します。</dd>
<dd><b>_skip</b>は、i番目のファイル/データセットがスキップされた場合に、指定します。</dd>
<dd><b>_i1</b> は i 番目のファイル/データセットの開始行インデックスを示します</dd>
<dd><b>_i2</b> は i 番目のファイル/データセットの終了行インデックスを示します</dd></dl></li>
<li> <b>各処理後のスクリプト</b>
<dl><dd> 各ファイルやデータセットを処理した後に、LabTalkスクリプトを実行します。Note:</dd>
<dd> <b>_i</b> は i 番目のファイル/データセットのインデックスを示します</dd>
<dd> <b>_book$</b>は、i番目ののブック名を示します。</dd>
<dd> 旧バージョンで使われていたの変数<b>i</b>と<b>__BATCHBOOK$</b>は、それぞれ、<b>_i</b>と<b>_book$</b>で置き換えます。</dd></dl></li>
<li> <b>終了時のスクリプト</b>
<dl><dd> 処理の最後に実行するLabTalkスクリプト</dd></dl></li></ul>
</td></tr></table>
<h2><a name="Examples"></a><span class="mw-headline">サンプル</span></h2>
<h3><a name="Example_1:_Import_.DAT_files_and_perform_nonlinear_curve_fitting"></a><span class="mw-headline">サンプル2.1: DATファイルのインポートと非線形フィット</span></h3>
<p>このサンプルでは、3つの.datファイルをインポートし、非線形曲線フィットを実行します。
</p>
<ol><li>メインメニューで、 <b>ファイル</b>をクリックし、<b>バッチ処理...</b>をクリックして<b>バッチ処理</b>ダイアログを開きます。</li>
<li><b>分析テンプレートをロード</b>が選択されていることを確認します。<b><b>分析テンプレート</b></b>の右側にあるボタン<a  class="image"><img alt="BatchBrowseButton.png" src="../images/Batch_Processing/BatchBrowseButton.png" width="17"  /></a>をクリックします。Originのインストールフォルダに移動し、<i>\ Samples\ Curve Fitting</i><b> </b>にある<i>Linear Regression.ogw</i> を選択します。</li>
<li><b><b>データソース</b></b>が<b><b>ファイルからインポート</b></b>にセットされていることを確認します。<b><b>ファイルリスト</b></b>の右にあるボタン<a  class="image"><img alt="BatchBrowseButton.png" src="../images/Batch_Processing/BatchBrowseButton.png" width="17"  /></a> をクリックし、<i><b>\Samples\Curve Fitting</b></i><b> </b>に移動し、<i><b>Sensor01.dat</b></i>, <i><b>Sensor02.dat</b></i>, <i><b>Sensor03.dat</b></i>を追加します。ダイアログの残りの設定は下図のようにします。
<dl><dd><a  class="image"><img alt="BatchProcessingDialgo.png" src="../images/Batch_Processing/BatchProcessingDialgo.png" width="629"  /></a></dd></dl></li>
<li><b>OK</b>をクリックして、3つの「.dat」ファイルを実行して、結果シートに統計を出力します。
<dl><dd><a  class="image"><img alt="BatchProcessingResults.png" src="../images/Batch_Processing/BatchProcessingResults.png" width="544"  /></a></dd></dl></li></ol>
<h3><a name="Example_2:_Perform_batch_analysis_on_groups_of_CSV_files"></a><span class="mw-headline">サンプル 2: CSVファイルのバッチ分析</span></h3>
<p><a class="external text" href="../../Tutorial/Tutorial/Batch_Processing_Grouped_Datasets_Using_Multi_Data_Sheets_Analysis_Template.html">このチュートリアル</a>で、複数データシートの分析テンプレートを使ってグループ化データセットのバッチ分析を実行します。
</p>
<h3><a name="Example_3:_Perform_batch_analysis_and_create_reports_using_a_custom_MS_Word_template"></a><span class="mw-headline">サンプル3: バッチ分析とMSワードテンプレートを使ったレポートの作成</span></h3>
<p><a class="external text" href="../../Tutorial/Tutorial/Batch_Processing_with_Word_Template_for_Reporting.html">このチュートリアル</a>では、レポート用Wordテンプレートでバッチ分析する用法を説明しています。
</p>
<h3><a name="Example_4:_Perform_batch_processing_on_worksheets_in_your_project_file"></a><span class="mw-headline">サンプル 4: プロジェクトファイル内のワークシートのバッチ処理</span></h3>
<p>すでにソースデータをプロジェクト内の複数のワークシートにインポートした場合、または前処理の中間結果である複数のワークシートでバッチ処理を実行する場合は、<b>データソース</b>=<b>既存ワークシートを使用</b>を使用します。次のサンプルでは、複数ワークシートでバッチ処理を実行する方法を示します。
</p><p>このサンプルでは、<i>&lt;Originインストールfolder&gt;\Origin2018\Samples\Statistics\</i>のExcelファイル<i>HouseholdCareSamples.xls</i> を使用します。このExcelファイルは、スーパーマーケットのクリーニング製品の在庫データを持つ数ワークシートを含みます。マーケットごとに異なる種類の在庫を計算し、結果シートにまとめます。
</p><p><font color="blue">まず分析テンプレートを準備します。</font>
</p>
<ol>
<li>メニューから<b>データ：ファイルからインポート：Excel(XLS, XLSX, XLSM)...</b> を選びます。次のようにして<b>OK</b>をクリックします。 
<ul><li><b>ファイル名</b>として<i>&lt;Origin installation folder&gt;\Origin2018\Samples\Statistics\HouseholdCareSamples.xls</i>を参照して選択 </li>
<li><b>ファイル情報</b>を開き、<i>HQ Family Mart</i> のみを選択してこのファイルの最初のシートのみインポート </li>
<li>ヘッダ行を開きます。<b>サブヘッダの行数</b>を1にし、<b>ロングネーム</b>を1に設定して、最初の行をロングネームに設定 </li></ul>
<li>インポートした<b>HQ Family Mart</b>シートをアクティブにして、col(&quot;Number&quot;)を選択し、<b>統計: 記述統計: 列の統計</b>を選択します。開いたダイアログで次のように設定して<b>OK</b>をクリックします。
<ul><li>入力タブで、<b>グループ</b>を<b>E(Y): Category</b>にします。</li>
<li>値タブで、<b>N合計</b>、<b>合計</b>、<b>最小</b>、<b>中央値</b>、<b>最大</b>にチェックをつけ、<b>平均</b>と<b>標準偏差</b>のチェックを外します。</li></ul>
<li><i>DescStatsQuantities</i>を使います。このシート名を<i>StatsResult&apos;</i>に変更します。<i>HQ Family Mart</i> ワークシート名を<i>Data</i> に変更します。ワークブックウィンドウのタイトルバーで右クリックして、<b>分析テンプレートとして保存</b>を選択して、<i>MyDesStats.ogwu</i>として保存します。
</ol>
<p><font color="blue">これで、Excelファイルの全てをインポートしてバッチ処理を実行します。</font>
</p>
<ol>
<li>メインメニューから、<b>データ: インポート: Excel(XLS, XLSX, XLSM)...</b>を選択して、<i>&lt;Origin installation folder&gt;\&lt;version&gt;\Samples\Statistics\HouseholdCareSamples.xls</i>をインポートします。次のようにして<b>OK</b>をクリックします。
<ul><li><b>複数ファイル(第一ファイル以外)のインポートモード</b>を<b>シートを新たに作って読み込む</b>にし、<b>ヘッダ行</b>を開きます。<b><b>サブヘッダの行数</b></b>を1にし、<b>ロングネーム</b>を1に設定します。</li>
<li><b>ヘッダを全てのシートに適用</b>にチェックを入れます。 </li></ul>
<li>ワークブックがアクティブな状態で、メニューから<b>ファイル：バッチ処理</b>を選び、<b>バッチ処理</b> ダイアログを開きます。
<li>分析テンプレートをロードが選択されていることを確認します。<b>分析テンプレート</b>の右にある<a  class="image"><img alt="BatchBrowseButton.png" src="../images/Batch_Processing/BatchBrowseButton.png" width="17"  /></a>ボタンをクリックして、保存した分析テンプレートを選びます。
<li><b>データソース</b>を<b><b>既存ワークシートを使用</b></b>にします。<b>ワークシート</b>の三角形ボタンをクリックして、<b>ブック内のシート</b>を選択して、全シートを追加します。 
<li><b>データセット識別子</b>を<b>シート名</b>にし、データシートを<i>Data</i>、<b>結果シート</b>を<b>StatsResult</b>にします。<b>OK</b>をクリックすると、9シートを処理して結果シートに統計が出力されます。
</ol>
<h3><a name="Example_5:_Perform_batch_processing_on_datasets_grouped_by_worksheet_column"></a><span class="mw-headline">サンプル 5: ワークシート列ごとのデータセットグループでのバッチ処理</span></h3>
<p><b>ヘルプ：ラーニングセンター</b>の<b>解析サンプル</b>タブを選択して、<b>サンプル</b>をバッチ処理に設定して、<b>グループ化列のバッチ処理</b>を選択します。グループ列付きの複数列を処理するためにバッチ処理（統計）を使用するサンプルです。
</p>

    