<h1 class="firstheading">列で2つのワークシートを結合する</h1><p class='urlname' style='display: none'>join-worksheets-bycol</p>
<p><br />
2つのワークシートを列で統合したいとき、一致する参照列がある場合、<b>列で2つのワークシートを結合する</b>ツールを使用することができます。
</p>
<table class="note">
<tr>
<td><b>Note:</b> 結合するワークシートが3つ以上ある場合は、<a href="../../UserGuide/UserGuide/Join_Multiple_Sheets_by_Column.html" title="ユーザガイド：列で複数のワークシートを結合する">列で複数のワークシートを結合する</a>機能を使用してください。
</td></tr></table>
<p><br />
<span class='headerInParagraph'>このツールを開くには </span>
</p>
<ul><li> ワークブックウィンドウがアクティブな状態で、<b>データ整形：列で2つのワークシートを結合する</b>メニューを選択します。</li></ul>
<dl><dd><a  class="image"><img alt="Join Worksheets by Column 01.png" src="../images/Join_Worksheets_by_Column/Join_Worksheets_by_Column_01.png" width="707"  /></a></dd></dl>
<p>これでXファンクションの<a class="external text" href="../../XFunction/X-Function/Wjoincols.html">Wjoincols</a>が開きます。
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Recalculate"><span class="tocnumber">1</span> <span class="toctext">再計算</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Specify_worksheets_and_columns_to_join"><span class="tocnumber">2</span> <span class="toctext">結合するワークシートと列を指定する</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Control_Options"><span class="tocnumber">2.1</span> <span class="toctext">コントロールオプション</span></a>
<ul>
<li class="toclevel-3 tocsection-4"><a href="#Drop_Non-matches"><span class="tocnumber">2.1.1</span> <span class="toctext">非一致を削除</span></a></li>
<li class="toclevel-3 tocsection-5"><a href="#Drop_Multiples"><span class="tocnumber">2.1.2</span> <span class="toctext">重複を削除</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Specify_matching_columns"><span class="tocnumber">3</span> <span class="toctext">一致する列を指定する</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#Matching_Columns"><span class="tocnumber">3.1</span> <span class="toctext">一致する列</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Match_with_All_Combinations"><span class="tocnumber">3.2</span> <span class="toctext">一致した全ての組み合わせ</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Merge_Matched_Columns_as_One"><span class="tocnumber">3.3</span> <span class="toctext">一致した列を1つに統合</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Consider_Missing_Value"><span class="tocnumber">3.4</span> <span class="toctext">欠損値を考慮する</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-11"><a href="#Output_worksheet"><span class="tocnumber">4</span> <span class="toctext">出力ワークシート</span></a>
<ul>
<li class="toclevel-2 tocsection-12"><a href="#Sort_Output"><span class="tocnumber">4.1</span> <span class="toctext">出力ソート</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#Dataset_Identifier"><span class="tocnumber">4.2</span> <span class="toctext">データセット識別子</span></a></li>
</ul>
</li>
</ul>
</div>
<h2><a name="Recalculate"></a><span class="mw-headline">再計算</span></h2>
<p><a href="../../UserGuide/UserGuide/Recalculating_Analysis_Results.html" title="ユーザガイド：分析結果の再計算">再計算モード</a>を指定します。
</p>
<h2><a name="Specify_worksheets_and_columns_to_join"></a><span class="mw-headline">結合するワークシートと列を指定する</span></h2>
<p>ダイアログの左側のパネルには、<b>w1</b>と<b>w2</b>の2つの列テーブルがあります。各テーブルの下のチェックボックスは、それぞれ所有するシートの設定を制御します。
</p>
<ol><li><b>Sheet1 (w1)</b>および<b>Sheet2 (w2)</b>ドロップダウンリストから結合する2つのシートを選択するか、その横にある<b>...</b>ボタンを選択します。 </li>
<li>列テーブルから、結合されたワークシートで統合する列を選択します。チェックされていない列は結果シートから除外されます。</li></ol>
<h3><a name="Control_Options"></a><span class="mw-headline">コントロールオプション</span></h3>
<h4><a name="Drop_Non-matches"></a><span class="mw-headline">非一致を削除</span></h4>
<p>結合されたワークシートから一致しないセルを除外するには、このチェックボックスにチェックを入れます。しない場合、一致しない値の列が欠損値で埋められます。
</p><p><a  class="image"><img alt="Join worksheet drop nonmatches.png" src="../images/Join_Worksheets_by_Column/Join_worksheet_drop_nonmatches.png" width="498"  /></a>
</p>
<h4><a name="Drop_Multiples"></a><span class="mw-headline">重複を削除</span></h4>
<p>1つの値に対して一致するセルが複数ある場合に使用されるオプションです。<b>複数を統合</b>で指定された統計値で複数を統合するには、このチェックボックスをオンにすると、複製が削除されます。
</p><p><a  class="image"><img alt="Join worksheet drop multiples.png" src="../images/Join_Worksheets_by_Column/Join_worksheet_drop_multiples.png" width="503"  /></a>
</p>
<h2><a name="Specify_matching_columns"></a><span class="mw-headline">一致する列を指定する</span></h2>
<h3><a name="Matching_Columns"></a><span class="mw-headline">一致する列</span></h3>
<p><b>w1</b>および<b>w2</b>列テーブルの一致する列を確認し、<b>-&gt;</b>ボタンをクリックして、<b>一致する列</b>テーブルにワークシートを結合する条件を追加します。複数の条件が存在する場合は、すべての条件が一致する必要があります。
</p><p>例えば、<b>一致する列</b>で<code>w1.A=w2.A</code>が指定されている場合、シートw1とw2の両方の列Aのすべての値が比較され、一致した行が結合されたワークシートの同じ行として統合されます。 
すべてのオプションが0に設定されているとします。
</p><p><a  class="image"><img alt="Join worksheet matching columns.png" src="../images/Join_Worksheets_by_Column/Join_worksheet_matching_columns.png" width="463"  /></a>
</p>
<h3><a name="Match_with_All_Combinations"></a><span class="mw-headline">全ての組み合わせと一致</span></h3>
<p>1つの値に一致するセルが複数ある場合は、このチェックボックスを利用して、結果ワークシートにすべての可能な組み合わせを表示できます。 
</p><p><a  class="image"><img alt="Join worksheet match with all combinations.png" src="../images/Join_Worksheets_by_Column/Join_worksheet_match_with_all_combinations.png" width="518"  /></a>
</p>
<h3><a name="Merge_Matched_Columns_as_One"></a><span class="mw-headline">一致した列を1つに統合</span></h3>
<p>結合したワークシート内の一致する列のみ保持するか指定します。
</p><p><a  class="image"><img alt="Join worksheet merge matched columns as one.png" src="../images/Join_Worksheets_by_Column/Join_worksheet_merge_matched_columns_as_one.png" width="513"  /></a>
</p>
<h3><a name="Consider_Missing_Value"></a><span class="mw-headline">欠損値を考慮する</span></h3>
<p>一致する列の欠損値を比較する値として考慮するには、このチェックボックスのチェックを入れます。チェックしない場合は、欠損値を持つ行を無視します。
</p>
<h2><a name="Output_worksheet"></a><span class="mw-headline">出力ワークシート</span></h2>
<h3><a name="Sort_Output"></a><span class="mw-headline">ソート出力</span></h3>
<p>結合されたシートで一致した値の順序を並べ替える方法を制御します。
</p>
<dl><dd><ul><li><b>一致する列 -- 昇順</b></li>
<li><b>一致する列 -- 降順</b> <br /><b>一致した列を1つに統合</b>：一致するすべての値を1つの列に統合します。選択されていない場合、<b>一致する列 -- 昇順/降順</b>は、各ソースシートの出力列をそれぞれ並べ替えます。</li>
<li><b>シートの順番を保持</b>：<b>シート</b>で指定されたシートで見つかった一致する値の順序で並べ替えます。</li>
<li><b>指定列による --昇順</b>：結合されたワークシートを、<b>列</b>で指定された列で昇順に並べ替えます。</li>
<li><b>指定列による -- 降順</b>：結合されたワークシートを、<b>列</b>で指定された列で降順に並べ替えます。</li></ul></dd></dl>
<h3><a name="Dataset_Identifier"></a><span class="mw-headline">データセット識別子</span></h3>
<p>データセットのソースを識別するために、結合されたワークシートに<b>ソース</b>という名前のパラメータラベル行を追加するかどうかを指定します。
</p>
<dl><dd><ul><li><b><b>なし</b></b>の場合、識別子ラベル行は追加されません。</li>
<li><b>一致した列を1つに統合</b>にチェックが入っていて、<b>範囲</b>/<b>ブック名</b>/<b>シート名</b>/<b>インデックス</b>が識別子として選択されている場合、一致した列の<b>ソース</b>ラベル行に「統合済み」と表示されます。</li>
<li><b>インデックス</b>：<b>インデックス</b>で指定されたインデックスによってソースシートを識別します。フォーマットは、<b><i>開始インデックス</i>：<i>増分</i></b>です例えば、<code>1:2</code>は、w1の列を「1」、w2の列を「3」として識別します。</li>
<li> <b>シートラベル</b>：ソースワークシートの<a href="../../UserGuide/UserGuide/Basic_Operations_on_Worksheet.html#Name_and_Notes" title="ユーザガイド：ワークシートの基本操作">シートラベル</a>を表示します。</li></ul></dd></dl>




    