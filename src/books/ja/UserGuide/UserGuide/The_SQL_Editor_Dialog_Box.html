<h1 class="firstheading">SQLエディタダイアログ</h1><p class='urlname' style='display: none'>ImpDatabase-SQLEditor-Dialog</p>
<p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Database_Overview"><span class="tocnumber">1</span> <span class="toctext">概要</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#The_SQL_Editor"><span class="tocnumber">2</span> <span class="toctext">SQLエディタ</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Dialog_Settings"><span class="tocnumber">3</span> <span class="toctext">ダイアログ設定</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#The_File_menu"><span class="tocnumber">3.1</span> <span class="toctext">ファイルメニュー</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#The_View_menu"><span class="tocnumber">3.2</span> <span class="toctext">表示メニュー</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#The_Query_menu"><span class="tocnumber">3.3</span> <span class="toctext">クエリーメニュー</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#The_Settings_menu"><span class="tocnumber">3.4</span> <span class="toctext">設定メニュー</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Buttons"><span class="tocnumber">3.5</span> <span class="toctext">ボタン</span></a></li>
</ul>
</li>
</ul>
</div>
<h2><a name="Database_Overview"></a><span class="mw-headline">概要</span></h2>
<p>Originのデータベース接続とインポート機能は更新されています。詳細については、次のブログを参照してください。
</p>
<ul><li> <a class="external text" href="http://blog.originlab.com/data-handling/better-faster-database-support-in-origin-2020" target="_blank">Better, Faster Database Support in Origin 2020</a></li>
<li> <a class="external text" href="http://blog.originlab.com/data-import/the-sql-editor-dialog" target="_blank">The SQL Editor Dialog Box</a></li>
<li> <a class="external text" href="http://blog.originlab.com/data-import/connecting-to-a-database-and-importing-data" target="_blank">Connecting to a Database and Importing Data</a></li>
<li> <a class="external text" href="http://blog.originlab.com/origin-2020/things-to-know-about-origin-database-connectivity" target="_blank">Things to Know About Origin Database Connectivity</a></li>
<li> <a class="external text" href="http://blog.originlab.com/sqlite-support-in-origin" target="_blank">OriginでのSQLiteのサポート</a></li></ul>
<h2><a name="The_SQL_Editor"></a><span class="mw-headline">SQLエディタ</span></h2>
<dl><dd><dl><dd><a  class="image"><img alt="Sqleditor.png" src="../images/The_SQL_Editor_Dialog_Box/Sqleditor.png" width="608"  /></a></dd></dl></dd></dl>
<p>SQLエディタは、データベース接続を確立し、SQL文字列を編集してデータベースのデータをインポートするためのシンプルなGUIです。ダイアログは次の項目で構成されています。
</p>
<ul><li> <b>テーブルリスト</b>：選択したデータベース内のテーブルのリストです。テーブルごとに、フィールドのリストがあります。アイテムをダブルクリックして、SQLステートメント編集ボックスで作成されているSQLクエリに追加できます。</li>
<li> <b>SQLステートメント編集ボックス</b>：SQLをここに手動で入力します。  テーブルリストをダブルクリックして、リストからSQLにアイテムを追加します。</li>
<li> <b>プレビューパネルの表示切り替え</b>：クリックして、プレビューパネルを表示または非表示にします。</li>
<li> <b>プレビューパネル</b>：プレビューボタンをクリックすると、データのプレビューが表示されます。</li>
<li> <b>プレビュー生成</b>：プレビューをクリックして、最大50行のプレビューデータを生成します。</li>
<li> <b>データのインポート</b>：OKをクリックしてSQLエディタダイアログを閉じ、クエリをワークシートに保存し、クエリで指定されたデータをワークシートにインポートします。</li></ul>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/The_SQL_Editor_Dialog_Box/Tip_icon.png" width="57"  border="0" /></td><td><p>トップパネルの高さを調整するには、プレビューパネルをオフに切り替え（右側の二重上矢印をクリック）、ドラッグして高さを調整します。
</p></td></tr></table>
<table class="note">
<tr>
<td><b>Note:</b> デフォルトでは、ビューはSQLエディターのテーブルリストで非表示になっています。LabTalkシステム変数<a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#D">@DBSV = 1</a>の値を設定することにより、ビューを有効にできます。システム変数の値を変更する方法については、<a class="external text" href="../../QuickHelp/QuickHelp/How_do_I_permanently_change_the_value_of_a_system_variable.html">FAQ-708 システム変数を永続的に変更するには</a>にあるシステム変数の変更を参照してください。
</td></tr></table>
<h2><a name="Dialog_Settings"></a><span class="mw-headline">ダイアログ設定</span></h2>
<h3><a name="The_File_menu"></a><span class="mw-headline">ファイルメニュー</span></h3>
<p>このメニューのオプションは、データベース接続を確立し、接続とクエリファイル (ODS および ODQファイル)を管理します。<a class="external text" href="http://blog.originlab.com/data-import/the-sql-editor-dialog*" target="_blank">*.ODSおよび*.ODQファイルの説明については、こちらのブログを参照してください。</a>
</p>
<table class="dialogcontroltable">
<tr>
<th> 新規
</th>
<td> 空白のSQLクエリを使用して完全に新しい接続を開始します。<b>データリンクプロパティ</b>ダイアログボックスを開きます。
</td></tr>
<tr>
<th> 開く
</th>
<td> クエリファイル (<a href="../../UserGuide/UserGuide/Database_Terminology.html" title="ユーザガイド: データベース用語集">.ODQファイル</a>) またはデータソースファイル (<a href="../../UserGuide/UserGuide/Database_Terminology.html" title="ユーザガイド: データベース用語集">.ODS ファイル</a>)を開きます。
</td></tr>
<tr>
<th> <b>現在のワークシートに保存</b>
</th>
<td> SQLおよび接続情報をアクティブワークシートに保存します。情報を保存したいが、すぐにデータをインポートしたくない場合に適したオプションです。<b>ファイル：閉じる</b>をクリックして後でダイアログを閉じます。
</td></tr>
<tr>
<th> 接続を新規に保存
</th>
<td>  現在の接続情報から<a href="../../UserGuide/UserGuide/Database_Terminology.html" title="ユーザガイド: データベース用語集">*.ODSファイル</a>を作成します。接続に資格情報/ログイン情報を含める場合は、事前に暗号化しないでください。
</td></tr>
<tr>
<th> 接続文字列を表示
</th>
<td> プレビューパネルの<b>メッセージ</b>タブに、現在の接続の<a href="../../UserGuide/UserGuide/Database_Terminology.html" title="ユーザガイド: データベース用語集">接続文字列</a>を表示します。
</td></tr>
<tr>
<th> 接続文字列を編集
</th>
<td> 現在の接続文字列の一部を変更します。または、接続文字列をクリップボードにコピーするために使用します。
</td></tr>
<tr>
<th> <b>接続とクエリーを新規に保存</b>
</th>
<td>  現在の接続情報とSQLステートメントから<a href="../../UserGuide/UserGuide/Database_Terminology.html" title="ユーザガイド: データベース用語集">*.ODQファイル</a>を作成します。
</td></tr>
<tr>
<th> 閉じる
</th>
<td> ダイアログを閉じます。
</td></tr></table>
<h3><a name="The_View_menu"></a><span class="mw-headline">表示メニュー</span></h3>
<table class="dialogcontroltable">
<tr>
<th> テキストサイズ
</th>
<td> SQLステートメントエディタのフォントサイズを調整します。
</td></tr>
<tr>
<th> テーブルリストを表示
</th>
<td> 左パネルを表示または非表示にします。Originはデータベースのメタデータを読み、このテーブルを構築します。構築までには時間が掛かる可能性があります。大規模なデータベースに接続しているとき、テーブルリストを非表示にすると、速度が上がります。このノードをダブルクリックして右のSQLステートメント編集ボックスに追加します。
</td></tr>
<tr>
<th> テーブルリストにテーブルビューを表示
</th>
<td> テーブルリストでテーブルビューを表示または非表示にします。
</td></tr></table>
<h3><a name="The_Query_menu"></a><span class="mw-headline">クエリーメニュー</span></h3>
<table class="dialogcontroltable">
<tr>
<th> LabTalk
</th>
<td> <b>LabTalk サポート設定</b> ダイアログを開きます。このダイアログは、LabTalk変数を定義し、LabTalkスクリプトを実行し、SQL文字列の中で使用できます。次のオプションを利用できます。
<ul>
<li> <b>LabTalk 置換(%, $) をする</b>:<br /> チェックするとSQL文字列でLabTalk置換を有効にします。
<li> <b>シングルクオート内の置換を無視する</b>:<br /> チェックすると &apos; &lsquo; 内部の置換を無視します。
<li> <b>クエリー前のスクリプト</b>:<br />SQL文字列を適用する前に実行するスクリプトです。これはLabTalk変数などを定義するのに使用します。
</ul></ul>
<p>詳細は、下記のサンプルを参照してください。
</p>
</td></tr>
<tr>
<th> 置換文字列のプレビュー
</th>
<td> 右パネルでLabTalkを使用している場合、実際のSQL文字列をプレビューできます。チェックをつけると、SQL編集ボックスは編集不可になります。
</td></tr>
<tr>
<th> プレビュー
</th>
<td> 下のプレビュータブでSQLクエリ結果をプレビューできます。
</td></tr></table>
<p><br />
<i><b>サンプル: SQL文字列内でLabTalkを使用する</b></i>
</p><p>サポートされている元々のSQL文字列は以下の通りです。
</p>
<pre class="sql" style="font-family:monospace;"><span style="color: #993333; font-weight: bold;">SELECT</span> country<span style="color: #66cc66;">,</span> years<span style="color: #66cc66;">,</span> amount <span style="color: #993333; font-weight: bold;">FROM</span> salesrecords
<span style="color: #993333; font-weight: bold;">WHERE</span> country <span style="color: #66cc66;">=</span> <span style="color: #ff0000;">&apos;USA&apos;</span> <span style="color: #993333; font-weight: bold;">AND</span> years <span style="color: #66cc66;">=</span> <span style="color: #cc66cc;">2010</span></pre>
<p>条件を変更するために、WHERE句にLabTalk変数を使うことができます。例えば、この<b>LabTalkサポート設定</b>  (<b>クエリー: LabTalk</b>) を開き、<b>クエリー前のスクリプト</b>に次のように入力します。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000080;">%</span>A <span style="color: #000080;">=</span> Japan; <span style="color: #008000;">//define a string variable</span>
int YY <span style="color: #000080;">=</span> <span style="color: #0000dd;">2010</span>; <span style="color: #008000;">//define an integer variable</span>
And change the SQL into</pre> 
<p>SQLを次のように変更します。
</p>
<pre class="sql" style="font-family:monospace;"><span style="color: #993333; font-weight: bold;">SELECT</span> country<span style="color: #66cc66;">,</span> years<span style="color: #66cc66;">,</span> amount <span style="color: #993333; font-weight: bold;">FROM</span> salesrecords
<span style="color: #993333; font-weight: bold;">WHERE</span> country <span style="color: #66cc66;">=</span> <span style="color: #ff0000;">&apos;%A&apos;</span> <span style="color: #993333; font-weight: bold;">AND</span> years <span style="color: #66cc66;">=</span> $<span style="color: #66cc66;">(</span>YY<span style="color: #66cc66;">)</span></pre>
<p>SQLの結果は次のようになります。
</p>
<ol>
<li> <b>LabTalk 置換(%, $) をする</b> -- チェックを外した場合
<pre class="sql" style="font-family:monospace;"><span style="color: #993333; font-weight: bold;">SELECT</span> country<span style="color: #66cc66;">,</span> years<span style="color: #66cc66;">,</span> amount <span style="color: #993333; font-weight: bold;">FROM</span> salesrecords
<span style="color: #993333; font-weight: bold;">WHERE</span> country <span style="color: #66cc66;">=</span> <span style="color: #ff0000;">&apos;%A&apos;</span> <span style="color: #993333; font-weight: bold;">AND</span> years <span style="color: #66cc66;">=</span> $<span style="color: #66cc66;">(</span>YY<span style="color: #66cc66;">)</span></pre>
<li> <b>LabTalk 置換(%, $) をする</b> -- チェックを付け、<b>シングルクオート内の置換を無視する</b> -- チェックを外した場合
<pre class="sql" style="font-family:monospace;"><span style="color: #993333; font-weight: bold;">SELECT</span> country<span style="color: #66cc66;">,</span> years<span style="color: #66cc66;">,</span> amount <span style="color: #993333; font-weight: bold;">FROM</span> salesrecords
<span style="color: #993333; font-weight: bold;">WHERE</span> country <span style="color: #66cc66;">=</span> <span style="color: #ff0000;">&apos;Japan&apos;</span> <span style="color: #993333; font-weight: bold;">AND</span> years <span style="color: #66cc66;">=</span> <span style="color: #cc66cc;">2010</span></pre>
<li> <b>LabTalk 置換(%, $) をする</b> -- チェックを付け、<b>シングルクオート内の置換を無視する</b> -- チェックを付けた場合
<pre class="sql" style="font-family:monospace;"><span style="color: #993333; font-weight: bold;">SELECT</span> country<span style="color: #66cc66;">,</span> years<span style="color: #66cc66;">,</span> amount <span style="color: #993333; font-weight: bold;">FROM</span> salesrecords
<span style="color: #993333; font-weight: bold;">WHERE</span> country <span style="color: #66cc66;">=</span> <span style="color: #ff0000;">&apos;%A&apos;</span> <span style="color: #993333; font-weight: bold;">AND</span> years <span style="color: #66cc66;">=</span> <span style="color: #cc66cc;">2010</span></pre>
</ol>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/The_SQL_Editor_Dialog_Box/Tip_icon.png" width="57"  border="0" /></td><td><p><b>シングルクオート内の置換を無視する</b>のチェックを外したときに実際の「%」記号を使用するには、代わりに二つのパーセント「%%」を使用します。
</p></td></tr></table>
<h3><a name="The_Settings_menu"></a><span class="mw-headline">設定メニュー</span></h3>
<table class="dialogcontroltable">
<tr>
<th> OLE DBによるデータのインポート
</th>
<td>  データのインポートにOLE DBを使用します。（OLE DBとODBCの両方で有効）
</td></tr>
<tr>
<th> ODBCによるデータのインポート
</th>
<td>  データのインポートにODBCを使用します。（ODBC接続でのみ有効）
</td></tr>
<tr>
<th> ワークシートの自動サイズ
</th>
<td> レコードの大きさに合わせてワークシート列の幅を自動調整します。
</td></tr>
<tr>
<th> ログイン情報を暗号化する
</th>
<td> Originで表示されたときに人の目で読めないように、資格情報/ログイン情報を暗号化します。
</td></tr></table>
<h3><a name="Buttons"></a><span class="mw-headline">ボタン</span></h3>
<p>このダイアログでよく使用されるオプションには、次のボタンが用意されています。
</p>
<table class="dialogcontroltable">
<tr>
<th> 開く <a  class="image"><img alt="Db editor open.png" src="../images/The_SQL_Editor_Dialog_Box/Db_editor_open.png" width="23"  /></a>
</th>
<td> <b>ファイル: 開く</b>メニュー
</td>
<td> <a href="../../UserGuide/UserGuide/Database_Terminology.html" title="ユーザガイド: データベース用語集">.ODQ</a> または <a href="../../UserGuide/UserGuide/Database_Terminology.html" title="ユーザガイド: データベース用語集">.ODS</a>ファイルを開きます。
</td></tr>
<tr>
<th> 保存 <a  class="image"><img alt="Db editor save.png" src="../images/The_SQL_Editor_Dialog_Box/Db_editor_save.png" width="23"  /></a>
</th>
<td> <b>ファイル: 現在のワークシートに保存</b>メニュー
</td>
<td> <b>ファイル：新規</b>メニューでダイアログを開き、<a href="../../UserGuide/UserGuide/Database_Terminology.html" title="ユーザガイド: データベース用語集">.ODQ</a>ファイルとして保存していない場合、SQLエディタダイアログのタイトルには<i>Untitled.ODQ</i>と表示されます。この場合、<b>保存</b>ボタンは接続とクエリーをアクティブワークシートのみに保存します。現在の接続とクエリーが.ODQファイルからロードまたは、.ODQファイルとして保存されていている場合、SQLエディタダイアログのタイトルはファイル名になります。この場合、保存ボタンは対応するファイルを保存します。
<p>Note: インポートボタンをクリックした場合、接続とクエリーは自動でワークシートに保存されます。SQLエディタを再度開くと、実際にはOriginはシートからのクエリーをロードし、ダイアログタイトルにブックとシート名<i>[Book1]Sheet1</i> を表示します。再度変更を加え、保存をクリックすると、アクティブワークシートに保存されます。 
</p>
</td></tr>
<tr>
<th> プレビュー <a  class="image"><img alt="Db editor preview.png" src="../images/The_SQL_Editor_Dialog_Box/Db_editor_preview.png" width="23"  /></a>
</th>
<td> <b>クエリー：プレビュー</b>メニュー
</td>
<td> SQLクエリ結果をプレビューします。
</td></tr>
<tr>
<th> インポート <a  class="image"><img alt="Db editor import.png" src="../images/The_SQL_Editor_Dialog_Box/Db_editor_import.png" width="23"  /></a>
</th>
<td> <b>クエリー：インポート</b>メニュー
</td>
<td> データベースデータをワークシートにインポートします。
</td></tr>
<tr>
<th> すべてのLabTalk変数を置換した後にクエリ文字列をプレビュー <a  class="image"><img alt="Db editor connect.png" src="../images/The_SQL_Editor_Dialog_Box/Db_editor_labtalk.png" width="23"  /></a>
</th>
<td> <b>クエリー：置換文字列のプレビュー</b>メニュー
</td>
<td> <b>クエリー：LabTalk</b>ダイアログでLabTalk変数が定義され、LabTalk 置換(%, $) をするにチェック付いている場合、実際のSQL文字列をプレビューできます。
</td></tr></table>


    