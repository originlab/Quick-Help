<h1 class="firstheading">カスタム日時フォーマット</h1>
<a name="Custom_Date_Format" id="Custom_Date_Format"></a>
<h2><span class="mw-headline">カスタム日時フォーマット</span></h2>
<p><b style="font-weight: bold;">ツール&#160;: オプション&#160;: <a href="../UserGuide/The_%28Options%29_Miscellaneous_Tab.html" title="UserGuide:The (Options) Miscellaneous Tab">その他のオプション</a></b>でサポートされている2つの日時フォーマットに加え、Originは、<span class="db">列のプロパティ</span> ダイアログの<a href="../UserGuide/The_%28Column_Properties%29_Properties_Tab.html" title="UserGuide:The (Column Properties) Properties Tab"><b>プロパティ</b>タブ</a> および<b>インポートウィザード</b> ダイアログの <a href="../UserGuide/Import_Wizard_Data_Columns_Page_%28ASCII%29.html" title="UserGuide:Import Wizard Data Columns Page (ASCII)"><b>データ列</b>ページ</a> で、カスタム日付フォーマットを定義することができます。設定されたカスタム日時フォーマットは、ワークシート列をダブルクリックして、｢<span class="db">列プロパティ</span>｣ダイアログボックスの『<b>列のデータ型</b>』ドロップダウンリストで｢<b>日付</b>｣が選ばれた時に、『<b>表示フォーマット</b>』ドロップダウンリストの項目として現れます。ダイアログボックスの『<b>表示フォーマット</b>』ドロップダウンリストでカスタム日時が選択されると、そのフォーマットはプロジェクトファイルに保存されます。他の人がこのプロジェクトを開いたときに、同じフォーマットで表示されます。これは、<b>ツール&#160;: オプション&#160;: [その他のオプション]</b>でサポートされる2つの日時フォーマットに対して、常にローカルなユーザ定義フォーマットを表示します。</p>
<ul>
<li>カスタム日時フォーマットでは、その定義のピクチャ文字列は60バイトを越えることはできません。</li>
<li>また、ピクチャ文字列が日付部分と時刻部分の両方を含む時、日付の中に時間のフォーマット要素を含んだり、時刻の中に日付のフォーマット要素を含んだりして、TIME-DATE-TIMEやDATE-TIME-DATEのいわばサンドイッチ形式とすることは禁止されています。</li>
<li>秒以下の値を表現するための小数点が地域により異なりますが、標準的なものだけが利用できます。</li>
<li>新しい日時フォーマットを編集すると、<b>日時フォーマット</b>はカスタム表示ドロップダウンリストの最初の項目として表示されます。他の人と共有したければ、ユーザファイルフォルダにあるOrigin.iniファイルの<b>Column Custom Format List</b> セクションを探し、他の人のユーザファイルフォルダのOrigin.iniファイルに編集した日時フォーマットをコピーします。</li>
</ul>
<table class="simple">
<tr>
<th>テキストボックスの入力...</th>
<th>意味...</th>
<th>Originでの表示</th>
</tr>
<tr>
<td>
<p>M</p>
</td>
<td>
<p>月</p>
</td>
<td>
<dl>
<dd>
<ul>
<li>M = 月を示す数字 (例えば、1月の1)。フォーマット要素が後続する時は、引用符(')で囲まれた区切り文字を挿入してください。</li>
<li>MM = 月を示す2桁の数字(例えば、1月の01)。</li>
<li>MMM = 日本語版：使用不可</li>
<li>MMMM = 月の名前 (例えば、1月)。フォーマット要素が後続する時は、引用符(')で囲まれた区切り文字を挿入してください。</li>
</ul>
</dd>
</dl>
</td>
</tr>
<tr>
<td>
<p>d</p>
</td>
<td>
<p>日</p>
</td>
<td>
<dl>
<dd>
<ul>
<li>d = 日を示す数字 (例えば、1日の1)。フォーマット要素が後続する時は、引用符(')で囲まれた区切り文字を挿入してください。</li>
<li>dd = 日を示す2桁の数字(例えば、1日の01)。</li>
<li>ddd = 1文字の曜日(例えば、火曜日の火)。</li>
<li>dddd = 長い曜日名(例えば、火曜日)。フォーマット要素が後続する時は、引用符(')で囲まれた区切り文字を挿入してください。</li>
</ul>
</dd>
</dl>
</td>
</tr>
<tr>
<td>
<p>y</p>
</td>
<td>
<p>年</p>
</td>
<td>
<dl>
<dd>
<ul>
<li>y = 先行ゼロを除いた西暦年の下2桁の数字 (例えば、1901 = 1)。フォーマット要素が後続する時は、引用符(')で囲まれた区切り文字を挿入してください。</li>
<li>yy = 2桁の西暦年を示す数字 (例えば、1901 = 01)。</li>
<li>yyyy = 西暦年(全桁)を示す数字 (例えば、1901)。</li>
</ul>
</dd>
</dl>
</td>
</tr>
<tr>
<td>
<p>h</p>
</td>
<td>
<p>時間</p>
</td>
<td>
<dl>
<dd>
<ul>
<li>h = 先行ゼロを除いた12時間制の｢時｣(例えば、午前6時 = 午後6時 = 6)。フォーマット要素が後続する時は、引用符(')で囲まれた区切り文字を挿入してください。</li>
<li>hh = 先行ゼロを含む12時間制の｢時｣(午前6時 = 午後6時 = 06)。</li>
</ul>
</dd>
</dl>
</td>
</tr>
<tr>
<td>
<p>H</p>
</td>
<td>
<p>時間</p>
</td>
<td>
<dl>
<dd>
<ul>
<li>H = 先行ゼロを除いた24時間制の｢時｣(例えば、午前6時 = 6、午後6時 = 18)。フォーマット要素が後続する時は、引用符(')で囲まれた区切り文字を挿入してください。</li>
<li>HH = 先行ゼロを含む24時間制の｢時｣(例えば、午前6時 = 06、午後6時 = 18)。</li>
</ul>
</dd>
</dl>
</td>
</tr>
<tr>
<td>
<p>m</p>
</td>
<td>
<p>分</p>
</td>
<td>
<dl>
<dd>
<ul>
<li>m = 先行ゼロを除いた｢分｣。フォーマット要素が後続する時は、引用符(')で囲まれた区切り文字を挿入してください。</li>
<li>mm = 先行ゼロを含む｢分｣。</li>
</ul>
</dd>
</dl>
</td>
</tr>
<tr>
<td>
<p>s</p>
</td>
<td>
<p>秒</p>
</td>
<td>
<dl>
<dd>
<ul>
<li>s = 先行ゼロを除いた｢秒｣。フォーマット要素が後続する時は、引用符(')で囲まれた区切り文字を挿入してください。</li>
<li>ss = 先行ゼロを含む｢秒｣。</li>
</ul>
</dd>
</dl>
</td>
</tr>
<tr>
<td>
<p>#</p>
</td>
<td>秒の小数部</td>
<td>
<dl>
<dd>
<ul>
<li># = 1桁の秒の小数部</li>
<li>## = 2桁の秒の小数部</li>
<li>### = 3桁の秒の小数部</li>
<li>#### = 4桁の秒の小数部</li>
</ul>
</dd>
</dl>
</td>
</tr>
<tr>
<td>
<p>t</p>
</td>
<td>
<p>午前/午後</p>
</td>
<td>
<dl>
<dd>
<ul>
<li>t = 午前/午後を示す1文字。AかP。</li>
<li>tt = 午前/午後を示す1文字。AMかPM。</li>
</ul>
</dd>
</dl>
</td>
</tr>
</table>
<a name="Custom_Dates_Examples" id="Custom_Dates_Examples"></a>
<h2><span class="mw-headline">カスタム日時のサンプル</span></h2>
<p>フォーマットに表示するカスタム日時フォーマットを設定してみましょう。</p>
<p><b style="font-weight: bold;">2008, 12 15, 土曜日</b></p>
<p>このカスタム日時フォーマットのピクチャ文字列は次のようになります。</p>
<p><b style="font-weight: bold;">yyyy, 'MMMM' 'd','dddd'</b></p>
<p>この日時フォーマットの日時フォーマット要素が、大文字、小文字を使い分けていることに注意してください。 (例えば、"MM"は"mm"ではありません)2つの連続するフォーマット要素の間には、区切り文字を挿入することができます。この区切り文字は、上表に挙げられた日時フォーマット要素と重ならない、任意のASCII文字 (日本語版: 漢字等の1字が使えます。) が使えます。正しい日時フォーマットの解釈が確実でない場合は、区切り文字をシングルクォート(')で囲むことが必要です。ただし、日時フォーマット要素が、ピクチャ文字列の最後に来る場合は、引用符は省略することができます。この区切り文字は、ワークシート表示でも同じ位置に表示されます。しかし、シングルクォート(')は表示されません。｢ワークシート列フォーマット｣ダイアログボックスの『表示フォーマット』ドロップダウンリストの項目の表示にも表示されません。シングルクォート(')で囲んだ区切り文字を2つ連続して指定することができません。例えば、｢ddd '|' '-'MMM｣のようにシングルクォートで囲まれた区切り文字を連続して並べることは禁止されています。</p>
<p>また、区切りのスペースが、シングルクォート(')で囲まれている時、指定されたスペースが必ずそこに来るものとして解釈されます。つまり、そのセルにデータを入力する時、シングルクォート(')で囲まれたスペースと同じだけの文字数のスペースで要素が区切られる必要があります。もし、データがスペースで区切られていないような場合は、フォーマットの方の区切りのスペースにもシングルクォートを付けないでください。このシングルクォートのないフォーマット区切りは、単にピクチャ文字列の並びを間違いなく解釈するためだけに使われます。例として次の表をご覧ください。</p>
<table class="simple">
<tr>
<th>カスタム日時</th>
<th>入力</th>
<th>出力</th>
<th>Notes</th>
</tr>
<tr>
<td>
<p>MM dd</p>
</td>
<td>
<p>0416</p>
</td>
<td>
<p>04 16</p>
</td>
<td>
<p>シングルクォートの無いスペースは無視されます。入力はフォーマットに従います。</p>
</td>
</tr>
<tr>
<td>
<p>MM' 'dd</p>
</td>
<td>
<p>02 12</p>
</td>
<td>
<p>02 12</p>
</td>
<td>
<p>1つのスペースで月と日を区切ります。入力文字列に余分なスペースがあっても構いません。</p>
</td>
</tr>
<tr>
<td>
<p>MM' 'dd</p>
</td>
<td>
<p>0212</p>
</td>
<td>
<p>-</p>
</td>
<td>
<p>1つの区切り用のスペースが必要ですが、入力にはスペースが無いため解釈できません。(エラー)</p>
</td>
</tr>
</table>
