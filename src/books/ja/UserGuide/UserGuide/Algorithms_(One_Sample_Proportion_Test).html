<h1 class="firstheading">アルゴリズム（1群の比率の検定）</h1><p class='urlname' style='display: none'>One-Prop-algorithm</p>
<p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Hypotheses"><span class="tocnumber">1</span> <span class="toctext">仮説</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Normal_approximation"><span class="tocnumber">2</span> <span class="toctext">正規近似</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#P_Value"><span class="tocnumber">2.1</span> <span class="toctext">P値</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Confidence_Interval"><span class="tocnumber">2.2</span> <span class="toctext">信頼区間</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="#Binomial_Test"><span class="tocnumber">3</span> <span class="toctext">二項検定</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#Exact_P_value"><span class="tocnumber">3.1</span> <span class="toctext">正確なP値</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Exact_Confidence_Interval"><span class="tocnumber">3.2</span> <span class="toctext">正確な信頼区間</span></a></li>
</ul>
</li>
</ul>
</div>

<h3><a name="Hypotheses"></a><span class="mw-headline">仮説</span></h3>
<p><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-a3904f143141153cc70766aff62f962c.png" title="n\!" alt="n\!" class="tex"/>をサンプルサイズとし、<img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-2fccdd06e4c2b79e4f65f2f532fdf9ec.png" title="n_{1}\!" alt="n_{1}\!" class="tex"/>をイベントまたは成功の数とします。標本比率<img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-059dd42e5c1758bf5ac9b735c33d9897.png" title="\tilde{p}\!" alt="\tilde{p}\!" class="tex"/>は<img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-74b78268fb8edf8f3c550eb3a02a9da4.png" title="\tilde{p}=\frac{n_{1}}{n}" alt="\tilde{p}=\frac{n_{1}}{n}" class="tex"/>で説明されます。
</p><p><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-2225a33c170f19586f1ee1de06e36962.png" title="p\!" alt="p\!" class="tex"/>をサンプル比率とし、<img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-98a2a58d47208a196dce8aebf1187a7b.png" title="p_{0}\!" alt="p_{0}\!" class="tex"/>は仮説比率としてこの関数は仮説を検定します。
</p><p><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-e6439f7e3ffa3e9be5825528b7bd98ca.png" title="H_0:p=p_{0}\!" alt="H_0:p=p_{0}\!" class="tex"/> vs  <img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-001ce83ba7f68612061a4f6535289a14.png" title="H_1:p \ne p_{0}\!" alt="H_1:p \ne p_{0}\!" class="tex"/>, 両側検定
</p><p><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-77393df8f4ba31f7392f313ebd9a6a01.png" title="H_0: p\ge p_{0}\!" alt="H_0: p\ge p_{0}\!" class="tex"/> vs  <img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-2efa1b2d6fe683e736fc4a3c72f338d0.png" title="H_1:p &lt; p_{0}\!" alt="H_1:p &lt; p_{0}\!" class="tex"/>, 上側検定
</p><p><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-9a14db95eaad70a65f7cde4742e6cfec.png" title="H_0:p\le p_{0}\!" alt="H_0:p\le p_{0}\!" class="tex"/> vs  <img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-e676757568c1548bc0a04e938d5970f4.png" title="H_1:p &gt; p_{0}\!" alt="H_1:p &gt; p_{0}\!" class="tex"/>, 下側検定
</p>
<h3><a name="Normal_approximation"></a><span class="mw-headline">正規近似</span></h3>
<h4><a name="P_Value"></a><span class="mw-headline">P値</span></h4>
<p><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-949e1609f9a8555500d11bfd80fd252f.png" title="n_{1}\ge10\!" alt="n_{1}\ge10\!" class="tex"/> および <img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-6dad1a4a3be6aa277f8d81cab11744ca.png" title="n-n_{1}\ge10\!" alt="n-n_{1}\ge10\!" class="tex"/> のとき、二項分布の正規近似を使用してp 値を計算できます。検定を行うために、次のようにして <img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-814b9f64b478b6caf94e723a0e6814c5.png" title="z\!" alt="z\!" class="tex"/> と <img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-c619dfb3f0ada810733c791d3e461ade.png" title=" p_{value}\!" alt=" p_{value}\!" class="tex"/> の値を計算します。
</p><p><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-5e43bb1a14561bd36062237b108f17a1.png" title="z=\frac{\tilde{p}-p_{0}}{\sqrt{\frac{p_{0}(1-p_{0})}{n}}}\!" alt="z=\frac{\tilde{p}-p_{0}}{\sqrt{\frac{p_{0}(1-p_{0})}{n}}}\!" class="tex"/>
</p><p><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-5333752eab96d7d78da0ddc4e3d9da72.png" title="p_{value}=2p(Z&gt;|z||p=p_{0})\!" alt="p_{value}=2p(Z&gt;|z||p=p_{0})\!" class="tex"/> 両側検定
</p><p><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-23cc99079273c727425f7f2b249939fc.png" title="p_{value}=p(Z\le z|p=p_{0})\!" alt="p_{value}=p(Z\le z|p=p_{0})\!" class="tex"/> 上側検定
</p><p><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-b454c9285e4a909cd7a23c7c233ca221.png" title="p_{value}=p(Z\ge z|p=p_{0})\!" alt="p_{value}=p(Z\ge z|p=p_{0})\!" class="tex"/> 下側検定
</p>
<h4><a name="Confidence_Interval"></a><span class="mw-headline">信頼区間</span></h4>
<p>信頼度が <img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-378df00d12056b404d7d02aef9d8650b.png" title="1-\alpha" alt="1-\alpha" class="tex"/> と等しい場合、サンプルの比率における信頼区間は以下のようにして与えられます。
</p>
<table class="simple">
<tr>
<th>帰無仮説
</th>
<th>信頼区間
</th></tr>
<tr>
<td><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-e6439f7e3ffa3e9be5825528b7bd98ca.png" title="H_0:p=p_{0}\!" alt="H_0:p=p_{0}\!" class="tex"/>
</td>
<td><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-45e3a879d9177162292d8b92c1e74936.png" title="\left[\tilde{p}- Z_{\frac{\alpha}{2}}\sqrt{\frac{\tilde{p}(1-\tilde{p})}{n}}, \tilde{p}+ Z_{\frac{\alpha}{2}}\sqrt{\frac{\tilde{p}(1-\tilde{p})}{n}}\right]" alt="\left[\tilde{p}- Z_{\frac{\alpha}{2}}\sqrt{\frac{\tilde{p}(1-\tilde{p})}{n}}, \tilde{p}+ Z_{\frac{\alpha}{2}}\sqrt{\frac{\tilde{p}(1-\tilde{p})}{n}}\right]" class="tex"/>
</td></tr>
<tr>
<td><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-77393df8f4ba31f7392f313ebd9a6a01.png" title="H_0: p\ge p_{0}\!" alt="H_0: p\ge p_{0}\!" class="tex"/>
</td>
<td><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-b1f8f1563d875c1b9ad0781525e22d66.png" title="\left[\tilde{p}- Z_{\alpha}\sqrt{\frac{\tilde{p}(1-\tilde{p})}{n}}, 1\right]" alt="\left[\tilde{p}- Z_{\alpha}\sqrt{\frac{\tilde{p}(1-\tilde{p})}{n}}, 1\right]" class="tex"/>
</td></tr>
<tr>
<td><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-9a14db95eaad70a65f7cde4742e6cfec.png" title="H_0:p\le p_{0}\!" alt="H_0:p\le p_{0}\!" class="tex"/>
</td>
<td><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-ddaa6748a4f7d5d7ec97a10b6094c9ab.png" title="\left[0, \tilde{p}+ Z_{\alpha}\sqrt{\frac{\tilde{p}(1-\tilde{p})}{n}}\right]" alt="\left[0, \tilde{p}+ Z_{\alpha}\sqrt{\frac{\tilde{p}(1-\tilde{p})}{n}}\right]" class="tex"/>
</td></tr></table>
<h3><a name="Binomial_Test"></a><span class="mw-headline">二項検定</span></h3>
<h4><a name="Exact_P_value"></a><span class="mw-headline">正確なP値</span></h4>
<p>Originでは、比率の正確検定は、二項検定をベースにします。
</p><p><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-77393df8f4ba31f7392f313ebd9a6a01.png" title="H_0: p\ge p_{0}\!" alt="H_0: p\ge p_{0}\!" class="tex"/>  <img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-236283f94349ab58667bb20e23c48c62.png" title="P_{value}=p(X\le n_{1}|p_0)" alt="P_{value}=p(X\le n_{1}|p_0)" class="tex"/>
</p><p><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-9a14db95eaad70a65f7cde4742e6cfec.png" title="H_0:p\le p_{0}\!" alt="H_0:p\le p_{0}\!" class="tex"/>   <img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-1b70aa97ad67ad73ec03a8b86eaa5378.png" title="P_{value}=p(X\ge n_{1}|p_0)" alt="P_{value}=p(X\ge n_{1}|p_0)" class="tex"/>
</p><p><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-e6439f7e3ffa3e9be5825528b7bd98ca.png" title="H_0:p=p_{0}\!" alt="H_0:p=p_{0}\!" class="tex"/>:
</p><p><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-ed8fc8393999c826e034ba7eda3820a5.png" title="M=n*p_0\!" alt="M=n*p_0\!" class="tex"/>のようにします。
</p><p><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-d71e7a494c74e9f4dc1befc9fc3f5985.png" title="n_1=M\!" alt="n_1=M\!" class="tex"/>  のとき <img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-3b7c3f8394db8c7ddbd64c20296e4816.png" title="P_{value}=1\!" alt="P_{value}=1\!" class="tex"/>
</p><p><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-5dc733247724ff9e5663466f3ba1aa52.png" title="n_1\le M\!" alt="n_1\le M\!" class="tex"/> <img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-a279ad1020d1230bcaca3b34763a1871.png" title="P_{value}=P(X\le n_1)+P(X\ge n-y+1)" alt="P_{value}=P(X\le n_1)+P(X\ge n-y+1)" class="tex"/>の時、yは<img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-972f03c6782e959c6296bd6454b4c3c1.png" title="P(z)\le p(n_1)" alt="P(z)\le p(n_1)" class="tex"/> および <img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-91f2fe6954e96740db5e5363be3214fc.png" title="n\ge z\ge \left \lfloor M \right \rfloor+1" alt="n\ge z\ge \left \lfloor M \right \rfloor+1" class="tex"/>のようにzのためのカウントです。
</p><p><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-33889b4adcda5ccfd42a486618a2e393.png" title="n_1\ge M\!" alt="n_1\ge M\!" class="tex"/> <img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-6d9ce680825cccb7345526c42f52d588.png" title="P_{value}=P(X\le y-1)+P(X\ge n_1)" alt="P_{value}=P(X\le y-1)+P(X\ge n_1)" class="tex"/>の時、yは<img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-972f03c6782e959c6296bd6454b4c3c1.png" title="P(z)\le p(n_1)" alt="P(z)\le p(n_1)" class="tex"/> および <img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-63f49135aa0df4deb4d2af7319868d98.png" title="0\le z\le \left \lfloor M \right \rfloor" alt="0\le z\le \left \lfloor M \right \rfloor" class="tex"/>のようにZのためのカウントです。
</p>
<h4><a name="Exact_Confidence_Interval"></a><span class="mw-headline">正確な信頼区間</span></h4>
<p>正確な信頼区間：信頼係数は <img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-378df00d12056b404d7d02aef9d8650b.png" title="1-\alpha" alt="1-\alpha" class="tex"/>
</p>
<table class="simple">
<tr>
<th>帰無仮説
</th>
<th>信頼区間
</th></tr>
<tr>
<td><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-e6439f7e3ffa3e9be5825528b7bd98ca.png" title="H_0:p=p_{0}\!" alt="H_0:p=p_{0}\!" class="tex"/>
</td>
<td>
<p><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-1f8c9b67e8071ca56485f823a54f73b7.png" title="\left[QBETA_{(1 - \alpha/2, n_1 + 1, n - n_1)}, QBETA_{(\alpha/2, n_1, n - n_1 + 1)}\right]" alt="\left[QBETA_{(1 - \alpha/2, n_1 + 1, n - n_1)}, QBETA_{(\alpha/2, n_1, n - n_1 + 1)}\right]" class="tex"/>
</p>
</td></tr>
<tr>
<td><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-77393df8f4ba31f7392f313ebd9a6a01.png" title="H_0: p\ge p_{0}\!" alt="H_0: p\ge p_{0}\!" class="tex"/>
</td>
<td>
<p><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-e36a48eef8fc383a8d311fc6fdcdae83.png" title="\left[QBETA_{(1 - \alpha, n_1 + 1, n - n_1)}, 1\right]" alt="\left[QBETA_{(1 - \alpha, n_1 + 1, n - n_1)}, 1\right]" class="tex"/>
</p>
</td></tr>

<tr>
<td><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-9a14db95eaad70a65f7cde4742e6cfec.png" title="H_0:p\le p_{0}\!" alt="H_0:p\le p_{0}\!" class="tex"/>
</td>
<td>
<p><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-94e921d28056ad0a1a1a0b9697535d58.png" title="\left[0, QBETA_{(\alpha, n_1, n - n_1 + 1)}\right]" alt="\left[0, QBETA_{(\alpha, n_1, n - n_1 + 1)}\right]" class="tex"/>
</p>
</td></tr></table>
<p>ここで、<img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-bac83f0f16753d22b8473eaef9e3ed0c.png" title="QBETA" alt="QBETA" class="tex"/> は、ベータ分布の分位点関数を表します。
</p>






    