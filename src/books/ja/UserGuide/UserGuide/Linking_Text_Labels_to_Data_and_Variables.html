<h1 class="firstheading">テキストオブジェクトとデータや変数のリンク</h1><p class='urlname' style='display: none'>LinkVar-TextLabel</p>
<p>テキストラベルは、ワークブック、ワークシート、列、セルの値やメタデータ、データファイル情報、さらにはデータ統計など、さまざまなプロジェクト情報を表示するために、静的リテラルテキストや、ランタイム文字列置換を行う<a class="external text" href="../../LabTalk/Category/Substitution_Notation.html">LabTalk置換表記</a>文字列のようなシンプルなものにすることができます。  
</p>
<dl><dd><dl><dd><a  class="image"><img alt="Link to cell.png" src="../images/Linking_Text_Labels_to_Data_and_Variables/Link_to_cell.png" width="240"  /></a></dd></dl></dd></dl>
<p>軸タイトルや凡例、データポイントラベルのようないくつかのテキストラベルはOriginによって自動的に生成される一方でほかにも<b>テキスト</b>または<b>データラベル</b>ツールで手動で追加するものもあります。手動で追加するラベルでは<b>置換へのリンク</b>がチェックされているか、<b>テキストオブジェクト</b>ダイアログの<b>プログラミング</b>タブにあるレベルが1に設定されていることを確認してください。
</p>
<dl><dd><a  class="image"><img alt="Link to SubStitution.png" src="../images/Linking_Text_Labels_to_Data_and_Variables/Link_to_SubStitution.png" width="626"  /></a></dd></dl>
<p>グラフウィンドウのコンテキスト内では、テキストラベルを2つのグループにまとめることができます。
</p>
<ul><li> <b>グラフテキストラベル</b>：これには、自動的に生成された軸のタイトルとグラフの凡例、および<b>テキスト</b>ツール<a  class="image"><img alt="Button Text Tool.png" src="../images/Linking_Text_Labels_to_Data_and_Variables/Button_Text_Tool.png" width="23"  /></a>で追加されたラベルが含まれます。ここでは<b>テキスト</b>ツールで追加されたラベルについて主に説明します。<a href="../../UserGuide/Category/Graph_Legends_and_Color_Scales.html" title="カテゴリー:凡例と色スケール">グラフの凡例</a>または<a href="../../UserGuide/Category/Graph_Legends_and_Color_Scales.html" title="カテゴリー:凡例と色スケール">軸タイトル</a>についてはこれらのページをご参照ください。</li>
<li> <b>データプロットラベル</b>：<b>データラベル</b>ツールまたは作図の詳細のラベルタブを使ってラベルを有効にすることにより、データポイント（単一ポイントまたはデータセット全体）にラべルを適用します。詳細は<a href="../../UserGuide/UserGuide/Labelling_Data_Points.html" title="ユーザガイド：データポイントにラベル付け">データポイントにラベル付け</a>をご参照ください。</li></ul>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Substituting_Worksheet_Cell_Values_in_Text_Labels"><span class="tocnumber">1</span> <span class="toctext">テキストラベルの置換ワークシートセル値</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Substituting_Column_Label_Row_Values_.28Metadata.29_in_Text_Labels"><span class="tocnumber">2</span> <span class="toctext">テキストラベルの列ラベル行の値（メタデータ）の置換</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Substituting_Dataset_Statistics_in_Text_Labels"><span class="tocnumber">3</span> <span class="toctext">テキストトラベルのデータセット統計の置換</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Substituting_Info_Variable_in_Text_Labels"><span class="tocnumber">4</span> <span class="toctext">テキストトラベルの変数情報の置換</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Substituting_Variable_Values_in_Text_Labels"><span class="tocnumber">5</span> <span class="toctext">テキストトラベルの置換変数値</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#Example_1._Use_Reserved_String_Registers"><span class="tocnumber">5.1</span> <span class="toctext">サンプル 1予約語のレジスタを使う</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Example_2._Numeric_Substitution"><span class="tocnumber">5.2</span> <span class="toctext">サンプル 2数値の変換</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8"><a href="#Resolving_Math_Expressions_in_Text_Labels"><span class="tocnumber">6</span> <span class="toctext">テキストラベルでの数式の解決</span></a>
<ul>
<li class="toclevel-2 tocsection-9"><a href="#Example._Resolving_pi_in_text_label"><span class="tocnumber">6.1</span> <span class="toctext">サンプルテキストラベルでpiを解く</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-10"><a href="#Adding_Date-Time_in_Text_Labels"><span class="tocnumber">7</span> <span class="toctext">テキストラベルへの日時の追加</span></a>
<ul>
<li class="toclevel-2 tocsection-11"><a href="#As_a_static_text_object"><span class="tocnumber">7.1</span> <span class="toctext">静的テキストオブジェクトとして</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#As_a_dynamic_text_object"><span class="tocnumber">7.2</span> <span class="toctext">動的テキストオブジェクトとして</span></a>
<ul>
<li class="toclevel-3 tocsection-13"><a href="#Adding_a_date-time_label_using_LabTalk_substitution"><span class="tocnumber">7.2.1</span> <span class="toctext">LabTalk置換を使用して日時のラベルを追加</span></a></li>
<li class="toclevel-3 tocsection-14"><a href="#Adding_date-time_by_running_LabTalk_script_in_the_label"><span class="tocnumber">7.2.2</span> <span class="toctext">ラベルでLabTalkスクリプトを実行して日時を追加する</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<h2><a name="Substituting_Worksheet_Cell_Values_in_Text_Labels"></a><span class="mw-headline">テキストラベルの置換ワークシートセル値</span></h2>
<p>テキストラベルでワークシートセルの値を表示する最も簡単な方法はリンクをコピー&amp;ペーストすることです。
</p>
<dl><dd><ol><li> ワークシートのセルをクリックし、CTRL + C（または右クリックして<b>コピー</b>）キーを押します。 </li>
<li> <b>テキスト</b>ツールを使用してテキスト（たとえば、<i>The value of y is:</i>)を作成し、ラベル編集モードで右クリックして、 <b>リンクの貼り付け</b>を選択します。</li>
<li> Originがワークシートセルの置換表記を追加します。 </li></ol></dd></dl>
<p>ワークシートのセル値を変更すると、ラベルに表示されている値が変更されます。
</p><p>貼り付けたリンクはほとんどのユーザにとって適切ですが、ワークシートセルの<a class="external text" href="../../LabTalk/Category/Substitution_Notation.html">置換</a>にはいくつかのオプションがあることも理解してもらえるとよいです。
</p><p>置換が動作するように最初にテキストラベルをクリックして表示されるミニツールバーで<b>置換へのリンク</b>にチェックがあることを確認してください。または、テキストラベル上で右クリックして、プロパティを選択します。プログラミングタブをクリックし、<b> (%,$)にリンク,置換レベル</b>を<b>1</b>と設定し、OKをクリックします。
</p><p><br />
</p>
<table class="simple" style="width: 90%">
<tr>
<th style="width: 15%">構文
</th>
<th style="width: 20%">説明
</th>
<th style="width: 55%">例
</th></tr>
<tr>
<td>
<p><i>%(workbookName, Column, row#[, format])</i> 
</p>
</td>
<td> ワークブックでアクティブなシートの列、行
</td>
<td>
<pre>//book1のアクティブなシート、2列 5行を完全精度で
%(Book1,2,5) 
//book1のアクティブなシート、列Bの5行目を, 小数点2桁で
%(Book1,B,5, .2) 
</pre>
</td></tr>
<tr>
<td><i>%([workbookName]Sheet, Column, row#[, format])</i>
</td>
<td> ワークブックの特定のシートの列、行
</td>
<td>
<pre>//book1のsheet1にある2列、5行を完全精度で
%([Book1]Sheet1,2,5) 
</pre>
<p>//book1のsheet1にある2列、5行を有効数字3桁で
</p>
<pre>%([Book1]Sheet1,2,5, *3) 
</pre>
</td></tr>
<tr>
<td><i>%(workbookName, @WL, column[row] [,format])</i>
</td>
<td> ワークブックでアクティブなシートの列、行
</td>
<td>
<pre>//book1のアクティブなシート、2列 5行を完全精度で
%(Book1, @WL, 2[5])
//book1のアクティブなシート、列Bの5行目を, 小数点2桁で
%(Book1,@WL, B[5], .2)
</pre>
</td></tr>
<tr>
<td><i>%([workbookName]sheetName, @WL, column[row] [,format])</i>
</td>
<td> ワークブックの特定のシートの列、行
</td>
<td>
<pre>//book1のsheet1にある2列5行を完全精度で
%([Book1]Sheet1,@WL, 2[5]) 
//book1、sheet1、2番目の列、5行目をワークシートセルと同じ表示で
%([Book1]Sheet1,@WL, B[5], W)
</pre>
</td></tr>
<tr>
<td> <i>%(plotindex, @WT, column, row[, format]</i>)
</td>
<td> 指定したプロットのソースワークシートまたは列
</td>
<td>
<pre>//第1プロットのワークシート、列F、5行目
%(1, @WT,F,5) 
//2番目のプロットのYデータシート、6列5行小数点2桁で
%(2Y, @WT,6,5, .2) 
</pre>
</td></tr></table>
<p>Note:
</p>
<dl><dd><ul><li> この方法の利点は、<b>@WT</b>が参照するワークシート列がソースデータによって識別されることです。グラフテンプレートとして保存して再利用したとき、データセット名が変更されたとしても、このテキストラベルの表示内容は新しいデータを参照して自動で更新します。</li>
<li> <b>%(1, @WT,<i>ColIndex</i>,<i>RowIndex</i>)</b>使用して、行列シートの値を参照できます。 </li>
<li> フォーマットはオプションです。指定しない場合、完全精度になります。<a class="external text" href="../../LabTalk/LabTalk/Origin_Formats.html">Originフォーマット</a>をご覧ください。</li>
<li> <b>@WL</b>では、フォーマットは<b>W</b>にでき、ワークシートのセル形式または列形式を使用します。</li></ul></dd></dl>
<p>次のグラフでは、MM/DD/YYYY 形式のA1セルに含まれる開始日のテキストを示しています。
</p>
<dl><dd><a  class="image"><img alt="Text label cell.png" src="../images/Linking_Text_Labels_to_Data_and_Variables/Text_label_cell.png" width="601"  /></a></dd></dl>
<h2><a name="Substituting_Column_Label_Row_Values_.28Metadata.29_in_Text_Labels"></a><span class="mw-headline">テキストラベルの列ラベル行の値（メタデータ）の置換</span></h2>
<p>データ行セルに加えて、テキストラベルの列ラベル行セルの値を置換できます。再度、置換が動作するように最初にテキストラベルをクリックして表示されるミニツールバーで<b>置換へのリンク</b>にチェックがあることを確認します。または、テキストラベル上で右クリックして、プロパティを選択します。プログラミングタブをクリックし、<b> (%,$)にリンク,置換レベル</b>を<b>1</b>と設定し、OKをクリックします。
</p><p>必要に応じて、使用できるするシンタックスがいくつかあります。
</p>
<dl><dd><ul><li> <b>%(PlotIndex, @option<i>[,arguemnt]</i> )</b> </li>
<li> <b>%(PlotIndex[PlotDesignChar], @option)</b></li>
<li> <b>%(PlotIndex,@WT,ColIndex, LabelRowChar)</b></li></ul></dd></dl>
<p>最後のオプションは、<a class="external text" href="../../LabTalk/LabTalk/Column_Label_Row_Characters.html">列ラベル行の文字</a>（LabelRowChar）を使用します。
</p>
<table class="simple" style="width: 80%">
<tr>
<th style="width: 20%">サンプル
</th>
<th style="width: 60%">説明
</th></tr>
<tr>
<td>&nbsp;%(1, @LD&quot;Mean&quot;)
</td>
<td> 第一プロットの列のユーザ定義パラメータ行の値
</td></tr>
<tr>
<td>&nbsp;%(1, @LF, B)
</td>
<td> 第一プロットのB列のフィルタ条件
</td></tr>
<tr>
<td> $(%(2Y, @LC), .2)
</td>
<td> 第二プロットのY列のコメントを小数点以下2桁で
</td></tr>
<tr>
<td>&nbsp;%(1X, @WT, 5, D2)
</td>
<td> 第一プロットのXデータがあるワークシートの5列目の2番目のユーザパラメータ行の値
</td></tr></table>
<p>下図は列CとDからプロットされており、テキストラベルで列 Bのフィルタ条件を示します。
</p>
<dl><dd><a  class="image"><img alt="Link to b filter.png" src="../images/Linking_Text_Labels_to_Data_and_Variables/Link_to_b_filter.png" width="653"  /></a></dd></dl>
<p><br />
</p>
<h2><a name="Substituting_Dataset_Statistics_in_Text_Labels"></a><span class="mw-headline">テキストトラベルのデータセット統計の置換</span></h2>
<p>LabTalk関数を使用してデータセット統計を計算し、結果をテキスト ラベルで表示することもできます。再度、置換が動作するように最初にテキストラベルをクリックして表示されるミニツールバーで<b>置換へのリンク</b>にチェックがあることを確認します。または、テキストラベル上で右クリックして、プロパティを選択します。プログラミングタブをクリックし、<b> (%,$)にリンク,置換レベル</b>を<b>1</b>と設定し、OKをクリックします。
</p><p>シンタックスは、以下の通りです。 
</p>
<dl><dd> <b>$(function(Dataset)<i>[, format])</i></b> </dd></dl>
<p>ここで
</p>
<dl><dd><ul><li> 関数はデータセットの代わりにスカラー値を返す必要があります (total()、mean() など)。</li>
<li> データセットは、データセットまたは範囲変数、プロットまたはワークシート列の文字列レジスターにすることができます。</li>
<li> フォーマットはオプションで<a href="../../LabTalk/LabTalk/Origin_Formats&amp;action=edit&amp;redlink=1.html" class="new" title="LabTalk:Origin Formats (page does not exist)">Originのフォーマット</a>を参照してください。</li></ul></dd></dl>
<p>次の表では、例としてLabTalk関数 total() を使用します。$( )置換は、計算をオプションのOriginフォーマットで文字列に変換して表示をカスタマイズするために使用されます。 
</p>
<table class="simple" style="width: 90%">
<tr>
<th style="width: 15%">データセット
</th>
<th style="width: 40%">説明
</th>
<th style="width: 35%">例
</th></tr>
<tr>
<td>&nbsp;%C
</td>
<td> アクティブデータセットの文字列レジスタ
</td>
<td>
<pre>$(total(%C)) //現在のデータセットの合計
$(total(%C), .2) //現在のデータセットの合計を小数点以下2桁で
</pre>
</td></tr>
<tr>
<td>&nbsp;%(<i>plotindex</i>, @D)
</td>
<td> 指定したプロットのデータセット
</td>
<td>
<pre>$(total(%(1, @D)) //最初のプロットの合計。2Dの場合、Yデータセットを参照
$(total(%(2X, @D)), *3) //2番目のプロットのXデータセットの合計を有効数字3桁で表示
$(total(%(2.1, @D))) //2番目のレイヤの最初のプロットのYデータの合計 
</pre>
</td></tr>
<tr>
<td>&nbsp;%(<i>plotindex</i>, @WT, columnNameorIndex)
</td>
<td> 指定したプロットのデータセット
</td>
<td>
<pre>$(total(%(1, @WT, 5))) //最初のプロットが含まれるワークシートの 5番目の列の合計
$(total(%(2X, @WT, E))) //2番目のXデータが取得されるワークシートの列Eの合計
$(total(%(1, @WT, &quot;Decay 2&quot;))) //最初のプロットのシートの列 (ロングネーム「Decay 2」) の合計
</pre>
</td></tr>
<tr>
<td> <i>%([book]Sheet, column)</i>
</td>
<td> ワークシート列置換
</td>
<td>
<pre>$(total(%([book1]1, C )) //book1の1番目のシートのC列の合計
</pre>
</td></tr>
<tr>
<td> <i>ds</i> または <i>ra</i>
</td>
<td> データセットまたは範囲変数または式
</td>
<td>
<pre>$(total(ds)) //データセットds={1,2,3};とする
$(total({2,4,6})) //{2,4,6}の合計
$(total(ra), .0) //範囲 ra=[book1]sheet1!B と仮定し、小数点以下0桁で
$(total([book1]1!C[5:0])) //Book1、1シート目、5行目から最後までの範囲列合計
</pre>
</td></tr></table>
<p>次のテキストラベルは、プロットの合計値を計算します。値は、カンマ区切り文字を使用し、小数点以下0桁でカスタマイズされます。
</p>
<dl><dd><a  class="image"><img alt="Text label total.png" src="../images/Linking_Text_Labels_to_Data_and_Variables/Text_label_total.png" width="779"  /></a></dd></dl>
<p><br />
</p>
<h2><a name="Substituting_Info_Variable_in_Text_Labels"></a><span class="mw-headline">テキストトラベルの変数情報の置換</span></h2>
<p>テキストラベルのインプレース編集モードで、右クリックして、挿入: 情報変数(Ctrl+L) を選択してプロットされたデータのファイル、ブック、シート、列情報を挿入できます。
</p>
<dl><dd><a  class="image"><img alt="Link to info var.png" src="../images/Linking_Text_Labels_to_Data_and_Variables/Link_to_info_var.png" width="609"  /></a></dd></dl>
<p>右側でブック、シートまたはプロットのXおよびY列ノードを選択します。<b>情報</b>または<b>ラベル</b>タブで挿入する情報を選択します。デフォルトで、置換表記で挿入されます。
</p>
<dl><dd><a  class="image"><img alt="Link to info var db.png" src="../images/Linking_Text_Labels_to_Data_and_Variables/Link_to_info_var_db.png" width="926"  /></a></dd></dl>
<h2><a name="Substituting_Variable_Values_in_Text_Labels"></a><span class="mw-headline">テキストトラベルの置換変数値</span></h2>
<p>ワークシートの値を表示するのに加え、テキストラベルに変数値を含めることができます。再度、置換が動作するように最初にテキストラベルをクリックして表示されるミニツールバーで<b>置換へのリンク</b>にチェックがあることを確認します。または、テキストラベル上で右クリックして、プロパティを選択します。プログラミングタブをクリックし、<b> (%,$)にリンク,置換レベル</b>を<b>1</b>と設定し、OKをクリックします。
</p>
<table class="simple" style="width: 80%">
<tr>
<th style="width: 20%">タイプ
</th>
<th style="width: 20%">サンプル
</th>
<th style="width: 40%">説明
</th></tr>
<tr>
<td> 文字列レジスタ
</td>
<td>&nbsp;%X%G.opju
</td>
<td> 現在のプロジェクトのパスとファイル名を末尾に .opju を付けて表示
</td></tr>
<tr>
<td> 文字列変数
</td>
<td>&nbsp;%(user$)
</td>
<td> 文字列user$の内容を表示
</td></tr>
<tr>
<td> 数値変数
</td>
<td> $(myvalue, .2)
</td>
<td> 変数 myvalue を小数点以下2桁で表示
</td></tr></table>
<p><br />
</p>
<h3><a name="Example_1._Use_Reserved_String_Registers"></a><span class="mw-headline">サンプル 1.予約語のレジスタを使う</span></h3>
<p><a class="external text" href="../../LabTalk/LabTalk/String_registers.html">文字列レジスタ</a>は、Originで文字列データを処理する手段の1つです。プロジェクトパス%X、プロジェクトファイル名%G、現在のアクティブ データ%Cなどの重要な情報を保持する予約済みのシステム文字列レジスタです。  
</p><p>現在のプロジェクト<i>MYPROJECT.OPJ</i> が<i>C:\MYFILES\</i>に保存されているとします。
</p>
<ol><li><a href="../../UserGuide/Category/Creating_Text_Labels.html" title="カテゴリ:テキストラベルを作成する">WYSIWYGテキストラベル法</a>を使って、グラフウィンドウのテキストラベルに次のように入力します。
<dl><dd><b>このプロジェクトは、%X%Gに保存されます。</b></dd></dl></li>
<li>入力モードを抜け、ラベルを選択して、右クリックし、<b>オブジェクトの</b><b>プログラム制御</b>を選びます。</li>
<li><b>(%,$)にリンク, 置換レベル</b> を<b>1</b>にします。</li>
<li><b>テキスト</b>タブで、<b><b>逐次解釈</b></b>のチェックボックスにチェックを付けます（これにより &quot;\&quot; は文字として認識されます）。ラベルは、現在のプロジェクトのドライブとパス名を表示します。
<dl><dd><b>このプロジェクトは、C:\MYFILES\MYPROJECTに保存されます。</b></dd></dl></li></ol>
<p><b><b>逐次解釈</b></b>オプションの使用に関する詳細は、<a href="../../UserGuide/UserGuide/Escape_Sequences.html#A_note_on_entering_the_backslash_.22.5C.22_character_in_text_labels" title="ユーザガイド：エスケープシーケンス">「オブジェクトプロパティ」ダイアログボックスでの円記号(バックスラッシュ)の利用</a>をご覧ください。
</p>
<h3><a name="Example_2._Numeric_Substitution"></a><span class="mw-headline">サンプル 2.数値の変換</span></h3>
<p>LabTalkを使用して、作業で使用する変数を定義できます。「変数」と「スコープ」の考え方については、<a class="external text" href="../../LabTalk/LabTalk/Data_Types_and_Variables.html#Variables">このトピック</a>を確認してください。基本的な数値表記を説明するために、次の簡単な例を紹介します。  
</p>
<ol>
<li>Originメニューで次のように操作します。<b>ウィンドウ：スクリプトウィンドウ</b></li>
<li>スクリプトウィンドウの内部でクリックし、次のように入力します。
<dl><dd><pre class="lt" style="font-family:monospace;">MyVariable<span style="color: #000080;">=</span><span style="color: #0000dd;">5</span></pre><br /></dd></dl>
そして、ENTERキーを押します。</li>
<li><b><b>プロット操作・オブジェクト作成</b></b>ツールバーの、<b>テキストツール</b>を選択し、グラフやワークシートの余白部分で次のように入力します。
<dl><dd><pre class="lt" style="font-family:monospace;">MyVariable<span style="color: #000080;">=</span><span style="color: #000080;">$</span><span style="color: #000000;">(</span>MyVariable<span style="color: #000000;">)</span></pre></li></dd></dl>
<li>テキストラベルを右クリックして、<b>プロパティ</b>を選択して<b>プログラミング</b>タブに行き、ダイアログで、<b>(%,$)にリンク, 置換レベル</b>を<b>1</b>にセットして<b><b>OK</b></b>をクリックします。これで、テキストラベルには、<i>MyVariable</i>の数値を表示されます。
<dl><dd><i>MyVariable=5</i></li></dd></dl>
</ol>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Linking_Text_Labels_to_Data_and_Variables/Tip_icon.png" width="57"  border="0" /></td><td><p>利用可能なLabTalkの変数を一覧するには、スクリプトウィンドウを開き(<b>ウィンドウ: スクリプトウィンドウ</b>)、<b>ツール: 変数</b>を選ぶか、コマンドラインに&quot;ed&quot;と入力します。
</p></td></tr></table>
<h2><a name="Resolving_Math_Expressions_in_Text_Labels"></a><span class="mw-headline">テキストラベルでの数式の解決</span></h2>
<p>Originは、 <a href="../../UserGuide/Category/Creating_Text_Labels.html" title="カテゴリ:テキストラベルを作成する">標準的なWYSIWYGテキスト編集法</a>でのテキスト作成時や「<a href="../../UserGuide/Category/Text_and_Drawing_Objects.html" title="カテゴリ:テキストオブジェクトと描画オブジェクト"><b>オブジェクトプロパティ</b></a>」ダイアログボックスでのテキストラベル編集時に置換表記をサポートしています。さらに、この表記を使って、数式を解いてテキストラベルに値を表示することができます。
</p>
<dl><dd><i>$(expression)</i></dd></dl>
<p>この置換表記では、テキストラベルが再描画される度に<i>数式</i>が解かれ値が表示されます。  ラベルを移動したり、グラフウィンドウを再描画する度に、テキストラベルは再描画されます。
</p>
<h3><a name="Example._Resolving_pi_in_text_label"></a><span class="mw-headline">サンプル.テキストラベルでpiを解く</span></h3>
<ol><li>WYSIWYG編集モードで次のテキストを入力するか、「<b>オブジェクトプロパティ</b>」ダイアログボックスの<b>テキスト</b>タブに数式を入力して、<b>OK</b>をクリックします。
<dl><dd> <i>The value of X is $(pi^2)</i></dd></dl></li>
<li>テキストラベルの上で右クリックし、<b>プロパティ...</b> を選択して、<b>オブジェクトのプログラミング制御</b> タブに移動します。または、<i>ALT</i>キーを押しながら、テキストラベルをダブルクリックします。</li>
<li><b>(%,$)にリンク, 置換レベル</b> を<b>1</b>にして<b><b>OK</b></b>をクリックします。  ラベルは次のようになります。
<dl><dd><i>The value of X is 9.8696</i></dd></dl></li></ol>
<p><b><b>標準</b></b>ツールバーの<b>リフレッシュ</b>ボタン <a  class="image"><img alt="Button Refresh.png" src="../images/Linking_Text_Labels_to_Data_and_Variables/Button_Refresh.png" width="23"  /></a>をクリックして、変更を見ます。
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Linking_Text_Labels_to_Data_and_Variables/Tip_icon.png" width="57"  border="0" /></td><td><p>Originを起動すると、プログラムフォルダのORGSYS.CNFというテキストファイルが読み込まれます。このファイルで、<b>スクリプトウィンドウ</b>や<b><b>列値の設定</b></b>ダイアログでの変数定義と同じように、<i><i>pi</i></i>の値が定義されています。<br />
</p>
<pre class="lt" style="font-family:monospace;">const pi <span style="color: #000080;">=</span> <span style="color: #0000dd;">3.141592653589793</span></pre>
<p>もし、通常使用する数学的な定数がある場合、ユーザファイルフォルダのCONST.CNFでそれを定義すれば、Originを起動するたびに利用可能になります(CNFファイルは、メモ帳などのテキストエディタで編集できます)。
</p></td></tr></table>
<h2><a name="Adding_Date-Time_in_Text_Labels"></a><span class="mw-headline">テキストラベルへの日時の追加</span></h2>
<p>日時情報をテキストラベルとしてグラフやワークシートなどに追加するには、いくつかの方法があります。 
</p>
<h3><a name="As_a_static_text_object"></a><span class="mw-headline">静的テキストオブジェクトとして</span></h3>
<p><b>プロット操作・オブジェクト作成</b>ツールバーの<b>日時</b>ボタン<a  class="image"><img alt="Button Date Time.png" src="../images/Linking_Text_Labels_to_Data_and_Variables/Button_Date_Time.png" width="23"  /></a>をクリックすると、日付と時刻のスタンプをグラフに追加できます。 
</p><p>これは静的なテキストオブジェクトであり、<b>日時</b>ボタン<a  class="image"><img alt="Button Date Time.png" src="../images/Linking_Text_Labels_to_Data_and_Variables/Button_Date_Time.png" width="23"  /></a>をもう一度クリックしない限り、現在の日付/時刻が保持されることに注意してください。
</p><p>詳細は、<a class="external text" href="../../QuickHelp/QuickHelp/How_do_I_add_date_time_stamp_to_my_graph.html">このページ</a>をご覧ください。
</p>
<h3><a name="As_a_dynamic_text_object"></a><span class="mw-headline">動的テキストオブジェクトとして</span></h3>
<p>現在の日時をテキストラベルに組み込む方法はいくつかあります。<b>日時</b>ボタンとは異なり、このようなテキストラベルはグラフテンプレートと共に保存でき、ウィンドウ作成の日付と時刻をグラフにスタンプするために使用できます。次の方法のいずれかを使用して作成されたテキストオブジェクトでテンプレートを保存すると、現在の日時のリテラルテキストではなく、ラベルの<i>基になるコード</i>が保存されることに注意してください。 
</p><p>基本的なプロセスはこのようになります。
</p>
<ol><li> <i>以下で説明する日時テキストオブジェクトの追加</i>など、グラフをカスタマイズします。</li>
<li> <a href="../../UserGuide/UserGuide/The_User_Files_Folder.html" title="ユーザガイド：ユーザファイルフォルダ">ユーザファイルフォルダ</a>に<a href="../../UserGuide/UserGuide/What_is_Saved_with_the_Graph_Template.html#Saving_graph_customizations_to_a_template_file" title="ユーザガイド：グラフテンプレートに保存される属性">カスタムテンプレートを保存</a>します。</li>
<li> プロットするデータを選択し、<b>作図</b>&gt;<b>マイ テンプレート</b>からカスタムテンプレートを選択します。</li></ol>
<h4><a name="Adding_a_date-time_label_using_LabTalk_substitution"></a><span class="mw-headline">LabTalk置換を使用して日時のラベルを追加</span></h4>
<p><b>@D</b> または <b>@T</b> 構文を使用して、日時ラベルをグラフに追加します。
</p>
<ol>
<li> <b>テキストツール</b><a  class="image"><img alt="Button Text Tool.png" src="../images/Linking_Text_Labels_to_Data_and_Variables/Button_Text_Tool.png" width="23"  /></a>を選択し、グラフをクリックして、カーソル位置に次のように入力します。
<pre class="lt" style="font-family:monospace;"> <span style="color: #000080;">$</span><span style="color: #000000;">(</span>@D, DMM<span style="color: #000080;">-</span>dd<span style="color: #000080;">-</span>yyyy HH<span style="color: #000000;">:</span>mm<span style="color: #000000;">:</span>ss<span style="color: #000000;">)</span></pre></li>
<li>入力したらテキストオブジェクトをクリックして編集モードを終了します。</li>
<li>テキストオブジェクトを選択し、ミニツールバーの<b>置換へのリンク</b>ボタンをクリックします。
<a  class="image"><img alt="OH date time text label DT syntax.png" src="../images/Linking_Text_Labels_to_Data_and_Variables/OH_date_time_text_label_DT_syntax.png" width="599"  /></a></li>
</ol>
<table class="note">
<tr>
<td><b>Note:</b> ここで使用されている特定の日時形式は、あくまで一例です。<b>@D</b> と <b>@T</b> のフォーマットについて詳しくは、LabTalkリファレンスの<a class="external text" href="../../LabTalk/LabTalk/Origin_Formats.html#Converting_Current_Date-Time_to_String">このセクション</a>を参照してください。
</td></tr></table>
<h4><a name="Adding_date-time_by_running_LabTalk_script_in_the_label"></a><span class="mw-headline">ラベルでLabTalkスクリプトを実行して日時を追加する</span></h4>
<p>この方法は、短いスクリプト行をテキストオブジェクトに追加することで機能します。そのスクリプトは<b>ウィンドウオープン</b>でトリガーされるため、グラフが作成された日時でグラフがスタンプされます。
</p>
<ol>
<li> <b>テキストツール</b><a  class="image"><img alt="Button Text Tool.png" src="../images/Linking_Text_Labels_to_Data_and_Variables/Button_Text_Tool.png" width="23"  /></a>を選択し、グラフをクリックして、カーソル位置に次のように入力します。
<pre class="lt" style="font-family:monospace;"><span style="color: #000080;">%</span><span style="color: #000000;">(</span>dt<span style="color: #000080;">$</span><span style="color: #000000;">)</span></pre></li>
<li>入力したらテキストオブジェクトをクリックして編集モードを終了します。</li>
<li>テキストオブジェクト上で右クリックして、<b>プロパティ</b>を選択します。</li>
<li>ダイアログで<b>プログラミング</b>タブをクリックし、次の設定を再作成します (<b>テキスト</b>タブも次のようになります)。
<a  class="image"><img alt="OH date time text label string var script.png" src="../images/Linking_Text_Labels_to_Data_and_Variables/OH_date_time_text_label_string_var_script.png" width="758"  /></a></li>
<li><b>OK</b> をクリックして、ダイアログを閉じ、現在の日時を与えます。</li>
</ol>
<table class="note">
<tr>
<td><b>Note:</b> ここで使用されているOrigin日時関数と日時形式の組み合わせは、ほんの一例です。
<ul><li> Originの日時関数については、LabTalkリファレンスの<a class="external text" href="../../LabTalk/Script/LabTalk-Supported_Functions.html#Date_and_Time_Functions">このページ</a>を参照してください。</li>
<li> 日時文字列の作成については、<a class="external text" href="../../LabTalk/LabTalk/Date_and_Time_Format_Specifiers.html">日付と時刻の書式指定子</a>を参照してください。</li></ul>
</td></tr></table>


    