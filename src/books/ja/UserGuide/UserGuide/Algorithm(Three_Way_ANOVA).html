<h1 class="firstheading">アルゴリズム (三元配置分散分析)</h1><p class='urlname' style='display: none'>ThreeWayANOVA-Algorithm</p>
<table id="toc" class="toc"><tr><td><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Theory_of_Three-Way_ANOVA"><span class="tocnumber">1</span> <span class="toctext">三元配置分散分析の理論</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Multiple_Means_Comparisons"><span class="tocnumber">2</span> <span class="toctext">複数の平均比較</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Power_Analysis"><span class="tocnumber">3</span> <span class="toctext">検出力解析</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Levene_test_for_Homogeneity_of_Variances"><span class="tocnumber">4</span> <span class="toctext">等分散性のLeveneの検定 </span></a></li>
</ul>
</td></tr></table>
<h2><a name="Theory_of_Three-Way_ANOVA"></a><span class="mw-headline">三元配置分散分析の理論</span></h2>
<p><I>N</I> 個の観測値が3つの因子、Iレベルの因子A、Jレベルの因子B、Kレベルの因子Cと関連しているものとします。
</p><p><img src="../images/Algorithm(Three_Way_ANOVA)/math-3d26ff2a9bebac5afd9fb871c7eddf45.png" title="y_{hijk}\,\!" alt="y_{hijk}\,\!" class="tex"/>を因子Aのレベル<I>i</I> 、因子Bのレベル <i>j</i> 、因子Cのレベル <I>k</I> での<I>h</I> 番目の観測値を表すものとすると、三元配置分散分析モデルは下記のようになります。
</p><p><img src="../images/Algorithm(Three_Way_ANOVA)/math-a5fddfa546aea6fc7b34789cdba6254a.png" title="y_{hijk}=\mu +\alpha _i+\beta _j+\gamma _k+(\alpha\beta)_{ij}+(\alpha\gamma)_{ik}+(\beta\gamma)_{jk}+(\alpha\beta\gamma)_{ijk}+\varepsilon _{hijk}" alt="y_{hijk}=\mu +\alpha _i+\beta _j+\gamma _k+(\alpha\beta)_{ij}+(\alpha\gamma)_{ik}+(\beta\gamma)_{jk}+(\alpha\beta\gamma)_{ijk}+\varepsilon _{hijk}" class="tex"/>
</p><p>ここで <img src="../images/Algorithm(Three_Way_ANOVA)/math-74b8eddf4b37de80c7c8eed1b64e46fc.png" title="\mu \,\!" alt="\mu \,\!" class="tex"/> は全応答データの平均、<img src="../images/Algorithm(Three_Way_ANOVA)/math-d015b015788a3872acceec61ded52bfb.png" title="\alpha _i\,\!" alt="\alpha _i\,\!" class="tex"/> は因子Aのレベル<I>i</I> での偏差、<img src="../images/Algorithm(Three_Way_ANOVA)/math-193f021d9028eb9706698a6f5c0f1e0a.png" title="\beta _j\,\!" alt="\beta _j\,\!" class="tex"/> は因子Bのレベル<I>j </I>での偏差、 <img src="../images/Algorithm(Three_Way_ANOVA)/math-f7fa86ea1e9e4cb6fec7a55a2c1b2de6.png" title="\gamma _k\,\!" alt="\gamma _k\,\!" class="tex"/> は因子Cのレベル<I>k</I> での偏差、<img src="../images/Algorithm(Three_Way_ANOVA)/math-db2e33c6b70364fbd8ab6f8aa270224b.png" title="(\alpha\beta)_{ij}\,\!" alt="(\alpha\beta)_{ij}\,\!" class="tex"/> は因子AとB間の相互作用項、<img src="../images/Algorithm(Three_Way_ANOVA)/math-b001b2a044d8308d62fb40dd094f95ec.png" title="(\alpha\gamma)_{ij}\,\!" alt="(\alpha\gamma)_{ij}\,\!" class="tex"/> は因子AとC間の相互作用項、<img src="../images/Algorithm(Three_Way_ANOVA)/math-e21552d4f43db3892b1d72d6fc7bb005.png" title="(\beta\gamma)_{ij}\,\!" alt="(\beta\gamma)_{ij}\,\!" class="tex"/> は因子BとC間の相互作用項、<img src="../images/Algorithm(Three_Way_ANOVA)/math-6967f59091d9c0e5b30e61946dc6a872.png" title="(\alpha\beta\gamma)_{ijk}\,\!" alt="(\alpha\beta\gamma)_{ijk}\,\!" class="tex"/> は因子A、B、C間の相互作用項、<img src="../images/Algorithm(Three_Way_ANOVA)/math-fe57a484afa70baac90662116b2751f0.png" title="\varepsilon _{hijk}\,\!" alt="\varepsilon _{hijk}\,\!" class="tex"/> は誤差項です。 
</p><p>三元配置の分散分析では、モデルを指定できます。例えば、項 <img src="../images/Algorithm(Three_Way_ANOVA)/math-db2e33c6b70364fbd8ab6f8aa270224b.png" title="(\alpha\beta)_{ij}\,\!" alt="(\alpha\beta)_{ij}\,\!" class="tex"/> を除外でき(その場合、項<img src="../images/Algorithm(Three_Way_ANOVA)/math-6967f59091d9c0e5b30e61946dc6a872.png" title="(\alpha\beta\gamma)_{ijk}\,\!" alt="(\alpha\beta\gamma)_{ijk}\,\!" class="tex"/>は自律的に除外されます)、モデルは以下のようになります。
</p><p><img src="../images/Algorithm(Three_Way_ANOVA)/math-4a67b5560fa0f3072ae9571ca065784a.png" title="y_{hijk}=\mu +\alpha _i+\beta _j+\gamma _k+(\alpha\gamma)_{ik}+(\beta\gamma)_{jk}+\varepsilon _{hijk}" alt="y_{hijk}=\mu +\alpha _i+\beta _j+\gamma _k+(\alpha\gamma)_{ik}+(\beta\gamma)_{jk}+\varepsilon _{hijk}" class="tex"/>
</p><p>指定されたモデルのサンプル偏差は、いわゆる計画行列の手法で生成されます。サンプルとして全てのモデルについて述べると、この手法の処理の要約は、以下の通りです。
</p><p>全モデルの自由度は <img src="../images/Algorithm(Three_Way_ANOVA)/math-17c23ef3a646b0a619980567eee3809c.png" title="df_{Model}=IJK-1" alt="df_{Model}=IJK-1" class="tex"/> です。全計画行列は <img src="../images/Algorithm(Three_Way_ANOVA)/math-974cbbf249506b83847ef3a27f40bb64.png" title="X&nbsp;:= X_{N\times df_{Model}} = [X_\mu |X_A |X_B |X_C |X_{AB} |X_{AC} |X_{BC} |X_{ABC}]" alt="X&nbsp;:= X_{N\times df_{Model}} = [X_\mu |X_A |X_B |X_C |X_{AB} |X_{AC} |X_{BC} |X_{ABC}]" class="tex"/>、ここで、<img src="../images/Algorithm(Three_Way_ANOVA)/math-22b3962c846ffd00ff3604200a8f5e60.png" title="X_\mu" alt="X_\mu" class="tex"/> は <img src="../images/Algorithm(Three_Way_ANOVA)/math-c9faf6ead2cd2c2187bd943488de1d0a.png" title="\mu" alt="\mu" class="tex"/> の副計画行列で、これは通常全て &quot;1&quot; で構成され、他の副計画行列はそれぞれの添え字が意味するものです。<img src="../images/Algorithm(Three_Way_ANOVA)/math-44129bb28848bd077486456b3db71fc1.png" title="X_{-*}" alt="X_{-*}" class="tex"/> が関連する0の副計画行列の置換によって表現されるとします。例えば、<img src="../images/Algorithm(Three_Way_ANOVA)/math-2e179930336cd7d54632e143300c93f5.png" title="X_{-AB} = [X_\mu |X_A |X_B |X_C |0 |X_{AC} |X_{BC} |X_{ABC}]" alt="X_{-AB} = [X_\mu |X_A |X_B |X_C |0 |X_{AC} |X_{BC} |X_{ABC}]" class="tex"/>
</p><p>定義 
</p><p><img src="../images/Algorithm(Three_Way_ANOVA)/math-bd00b8792be7ede4e683c46aa3a0e6fe.png" title="R_0 = Y^T X_{\mu}(X_{\mu}^T X_{\mu})^{-1}X_{\mu}^T Y" alt="R_0 = Y^T X_{\mu}(X_{\mu}^T X_{\mu})^{-1}X_{\mu}^T Y" class="tex"/>
</p><p><img src="../images/Algorithm(Three_Way_ANOVA)/math-4b044b5a44959ebbbe8951655538bf20.png" title="R_\mu = Y^T Y" alt="R_\mu = Y^T Y" class="tex"/>
</p><p><img src="../images/Algorithm(Three_Way_ANOVA)/math-e6d8ebe5c5cccf19ba0d715d407631f5.png" title="R_{Model} = Y^T X(X^T X)^{-1}X^T Y" alt="R_{Model} = Y^T X(X^T X)^{-1}X^T Y" class="tex"/>
</p><p><img src="../images/Algorithm(Three_Way_ANOVA)/math-2f8bfaaeced6351ba75efa018c499abc.png" title="R_A = Y^T X_{-A}(X_{-A}^T X_{-A})^{-1}X_{-A}^T Y" alt="R_A = Y^T X_{-A}(X_{-A}^T X_{-A})^{-1}X_{-A}^T Y" class="tex"/>
</p><p><img src="../images/Algorithm(Three_Way_ANOVA)/math-db10147d89f311a36da03b92e09c88c8.png" title="R_B = Y^T X_{-B}(X_{-B}^T X_{-B})^{-1}X_{-B}^T Y" alt="R_B = Y^T X_{-B}(X_{-B}^T X_{-B})^{-1}X_{-B}^T Y" class="tex"/>
</p><p><img src="../images/Algorithm(Three_Way_ANOVA)/math-6cb959ea1659d205096410b7a4662bda.png" title="R_C = Y^T X_{-C}(X_{-C}^T X_{-C})^{-1}X_{-C}^T Y" alt="R_C = Y^T X_{-C}(X_{-C}^T X_{-C})^{-1}X_{-C}^T Y" class="tex"/>
</p><p><img src="../images/Algorithm(Three_Way_ANOVA)/math-01e08550766c2a23ba562a5e0b9c1f98.png" title="R_{AB} = Y^T X_{-AB}(X_{-AB}^T X_{-AB})^{-1}X_{-AB}^T Y" alt="R_{AB} = Y^T X_{-AB}(X_{-AB}^T X_{-AB})^{-1}X_{-AB}^T Y" class="tex"/>
</p><p><img src="../images/Algorithm(Three_Way_ANOVA)/math-4d3bc46b96f974b945c5110257c650c3.png" title="R_{AC} = Y^T X_{-AC}(X_{-AC}^T X_{-AC})^{-1}X_{-AC}^T Y" alt="R_{AC} = Y^T X_{-AC}(X_{-AC}^T X_{-AC})^{-1}X_{-AC}^T Y" class="tex"/>
</p><p><img src="../images/Algorithm(Three_Way_ANOVA)/math-8c89db815bd0926df808c32e9673ca27.png" title="R_{BC} = Y^T X_{-BC}(X_{-BC}^T X_{-BC})^{-1}X_{-BC}^T Y" alt="R_{BC} = Y^T X_{-BC}(X_{-BC}^T X_{-BC})^{-1}X_{-BC}^T Y" class="tex"/>
</p><p><img src="../images/Algorithm(Three_Way_ANOVA)/math-e382d8f4938548dc7e5f1e2de7ef68d9.png" title="R_{ABC} = Y^T X_{-ABC}(X_{-ABC}^T X_{-ABC})^{-1}X_{-ABC}^T Y" alt="R_{ABC} = Y^T X_{-ABC}(X_{-ABC}^T X_{-ABC})^{-1}X_{-ABC}^T Y" class="tex"/>
</p><p>二乗誤差の合計は、
</p><p><img src="../images/Algorithm(Three_Way_ANOVA)/math-9fd9a174f2d229ee0e4859ab1bf62f9e.png" title="SS_A = R_{Model}-R_A" alt="SS_A = R_{Model}-R_A" class="tex"/>
</p><p><img src="../images/Algorithm(Three_Way_ANOVA)/math-57fba17a0f57ca5a0e9c8e9cf2c37b1e.png" title="SS_B = R_{Model}-R_B" alt="SS_B = R_{Model}-R_B" class="tex"/>
</p><p><img src="../images/Algorithm(Three_Way_ANOVA)/math-2a96e63724970e7dfd4779f8a2d5f6e2.png" title="SS_C = R_{Model}-R_C" alt="SS_C = R_{Model}-R_C" class="tex"/>
</p><p><img src="../images/Algorithm(Three_Way_ANOVA)/math-9452cd76150d8354a840a8a112d411df.png" title="SS_{AB} = R_{Model}-R_{AB}" alt="SS_{AB} = R_{Model}-R_{AB}" class="tex"/>
</p><p><img src="../images/Algorithm(Three_Way_ANOVA)/math-afde43906b1e11b6d60f84c222fda31d.png" title="SS_{AC} = R_{Model}-R_{AC}" alt="SS_{AC} = R_{Model}-R_{AC}" class="tex"/>
</p><p><img src="../images/Algorithm(Three_Way_ANOVA)/math-1c1d599d9c128c3ddc13ca84287d28cb.png" title="SS_{BC} = R_{Model}-R_{BC}" alt="SS_{BC} = R_{Model}-R_{BC}" class="tex"/>
</p><p><img src="../images/Algorithm(Three_Way_ANOVA)/math-b9f4cf1dfcacf65ce36198b56478c620.png" title="SS_{ABC} = R_{Model}-R_{ABC}" alt="SS_{ABC} = R_{Model}-R_{ABC}" class="tex"/>
</p><p><img src="../images/Algorithm(Three_Way_ANOVA)/math-3d7f5f8de700e2dcfcaf3cc86413c447.png" title="SS_{Error} = R_{\mu}-R_{Model}" alt="SS_{Error} = R_{\mu}-R_{Model}" class="tex"/>
</p><p><img src="../images/Algorithm(Three_Way_ANOVA)/math-a3a8cbb61688ec90e5dbcec307f6d11d.png" title="SS_{Total} = R_{\mu}-R_{0}" alt="SS_{Total} = R_{\mu}-R_{0}" class="tex"/>
</p><p><br /> 全モデルでは、ANOVA表は以下のようにまとめることができます。
</p>
<table class="simple">
<tr>
<th>分散の入力
</th>
<th>自由度 (DF)
</th>
<th>平方和 (SS)
</th>
<th>平均平方 (MS)
</th>
<th><i>F</i> 値
</th>
<th><i>Prob &gt; F</i>
</th></tr>
<tr>
<th>因子A
</th>
<td><i>I</i> - 1
</td>
<td><img src="../images/Algorithm(Three_Way_ANOVA)/math-8d95f5934baa7c353f18fd77c675e92c.png" title="SS_A" alt="SS_A" class="tex"/>
</td>
<td><img src="../images/Algorithm(Three_Way_ANOVA)/math-d8cf712091994539169b7f92bcabdd67.png" title="MS_A" alt="MS_A" class="tex"/>
</td>
<td><img src="../images/Algorithm(Three_Way_ANOVA)/math-d8cf712091994539169b7f92bcabdd67.png" title="MS_A" alt="MS_A" class="tex"/> / <img src="../images/Algorithm(Three_Way_ANOVA)/math-ff8dc369a4b279c7e064cb1ef6fc4ba1.png" title="MS_{Error}" alt="MS_{Error}" class="tex"/>
</td>
<td><img src="../images/Algorithm(Three_Way_ANOVA)/math-46b9373262cf908281fa3c046a60ab1b.png" title="P\{F\geq F_{(I-1,df_e,\alpha )}\}" alt="P\{F\geq F_{(I-1,df_e,\alpha )}\}" class="tex"/>
</td></tr>
<tr>
<th>因子B
</th>
<td><i>J</i> - 1
</td>
<td><img src="../images/Algorithm(Three_Way_ANOVA)/math-8abe5e40ad8ae7fd4ed12d2d27a1a7dd.png" title="SS_B" alt="SS_B" class="tex"/>
</td>
<td><img src="../images/Algorithm(Three_Way_ANOVA)/math-666cadb9e58dc0e560e052a20e3a510f.png" title="MS_B" alt="MS_B" class="tex"/>
</td>
<td><img src="../images/Algorithm(Three_Way_ANOVA)/math-666cadb9e58dc0e560e052a20e3a510f.png" title="MS_B" alt="MS_B" class="tex"/> / <img src="../images/Algorithm(Three_Way_ANOVA)/math-ff8dc369a4b279c7e064cb1ef6fc4ba1.png" title="MS_{Error}" alt="MS_{Error}" class="tex"/>
</td>
<td><img src="../images/Algorithm(Three_Way_ANOVA)/math-b1db7b83604a33d08e8d2e08be7f9d90.png" title="P\{F\geq F_{(J-1,df_e,\alpha )}\}" alt="P\{F\geq F_{(J-1,df_e,\alpha )}\}" class="tex"/>
</td></tr>
<tr>
<th>因子C
</th>
<td><i>K</i> - 1
</td>
<td><img src="../images/Algorithm(Three_Way_ANOVA)/math-91392ab538a2412e4840647ffe5ab230.png" title="SS_C" alt="SS_C" class="tex"/>
</td>
<td><img src="../images/Algorithm(Three_Way_ANOVA)/math-6bbe60f8d599863a5b3ba709763b4a05.png" title="MS_C" alt="MS_C" class="tex"/>
</td>
<td><img src="../images/Algorithm(Three_Way_ANOVA)/math-6bbe60f8d599863a5b3ba709763b4a05.png" title="MS_C" alt="MS_C" class="tex"/> / <img src="../images/Algorithm(Three_Way_ANOVA)/math-ff8dc369a4b279c7e064cb1ef6fc4ba1.png" title="MS_{Error}" alt="MS_{Error}" class="tex"/>
</td>
<td><img src="../images/Algorithm(Three_Way_ANOVA)/math-3ea7efc0c93b626e4949d94eb32b07f6.png" title="P\{F\geq F_{(K-1,df_e,\alpha )}\}" alt="P\{F\geq F_{(K-1,df_e,\alpha )}\}" class="tex"/>
</td></tr>
<tr>
<th>A*B
</th>
<td>(<i>I</i>- 1) (<i>J</i> - 1)
</td>
<td><img src="../images/Algorithm(Three_Way_ANOVA)/math-23d40e491f33023cbce6ed1898054a81.png" title="SS_{AB}" alt="SS_{AB}" class="tex"/>
</td>
<td><img src="../images/Algorithm(Three_Way_ANOVA)/math-bcd1cd8741b39cdd8c3e290f145ae5a1.png" title="MS_{AB}" alt="MS_{AB}" class="tex"/>
</td>
<td><img src="../images/Algorithm(Three_Way_ANOVA)/math-bcd1cd8741b39cdd8c3e290f145ae5a1.png" title="MS_{AB}" alt="MS_{AB}" class="tex"/> / <img src="../images/Algorithm(Three_Way_ANOVA)/math-ff8dc369a4b279c7e064cb1ef6fc4ba1.png" title="MS_{Error}" alt="MS_{Error}" class="tex"/>
</td>
<td><img src="../images/Algorithm(Three_Way_ANOVA)/math-40b10ce24f549a5335b5b18831b089ad.png" title="P\{F\geq F_{((I-1)(J-1),df_e,\alpha )}\}" alt="P\{F\geq F_{((I-1)(J-1),df_e,\alpha )}\}" class="tex"/>
</td></tr>
<tr>
<th>A*C
</th>
<td>(<i>I</i>- 1) (<i>K</i> - 1)
</td>
<td><img src="../images/Algorithm(Three_Way_ANOVA)/math-6fad30abaac99bb8dc35c5f3b8b3826a.png" title="SS_{AC}" alt="SS_{AC}" class="tex"/>
</td>
<td><img src="../images/Algorithm(Three_Way_ANOVA)/math-fd73263586214fb88d8cc0b02d928fa2.png" title="MS_{AC}" alt="MS_{AC}" class="tex"/>
</td>
<td><img src="../images/Algorithm(Three_Way_ANOVA)/math-fd73263586214fb88d8cc0b02d928fa2.png" title="MS_{AC}" alt="MS_{AC}" class="tex"/> / <img src="../images/Algorithm(Three_Way_ANOVA)/math-ff8dc369a4b279c7e064cb1ef6fc4ba1.png" title="MS_{Error}" alt="MS_{Error}" class="tex"/>
</td>
<td><img src="../images/Algorithm(Three_Way_ANOVA)/math-85c6dd067f19d46df5527874d27fea88.png" title="P\{F\geq F_{((I-1)(K-1),df_e,\alpha )}\}" alt="P\{F\geq F_{((I-1)(K-1),df_e,\alpha )}\}" class="tex"/>
</td></tr>
<tr>
<th>B*C
</th>
<td>(<i>J</i>- 1) (<i>K</i> - 1)
</td>
<td><img src="../images/Algorithm(Three_Way_ANOVA)/math-bab5b2ee657f228f35b225324f0bc1b6.png" title="SS_{BC}" alt="SS_{BC}" class="tex"/>
</td>
<td><img src="../images/Algorithm(Three_Way_ANOVA)/math-eaac51e7bc7de46573d845cf3b0607b1.png" title="MS_{BC}" alt="MS_{BC}" class="tex"/>
</td>
<td><img src="../images/Algorithm(Three_Way_ANOVA)/math-eaac51e7bc7de46573d845cf3b0607b1.png" title="MS_{BC}" alt="MS_{BC}" class="tex"/> / <img src="../images/Algorithm(Three_Way_ANOVA)/math-ff8dc369a4b279c7e064cb1ef6fc4ba1.png" title="MS_{Error}" alt="MS_{Error}" class="tex"/>
</td>
<td><img src="../images/Algorithm(Three_Way_ANOVA)/math-517dca22cbb9f9c5cc95baa146662800.png" title="P\{F\geq F_{((J-1)(K-1),df_e,\alpha )}\}" alt="P\{F\geq F_{((J-1)(K-1),df_e,\alpha )}\}" class="tex"/>
</td></tr>
<tr>
<th>A*B*C
</th>
<td>(<i>I</i>- 1) (<i>J</i> - 1)(<i>K</i> - 1)
</td>
<td><img src="../images/Algorithm(Three_Way_ANOVA)/math-e3fe9a6e0feaf250ab6566828ab58be7.png" title="SS_{ABC}" alt="SS_{ABC}" class="tex"/>
</td>
<td><img src="../images/Algorithm(Three_Way_ANOVA)/math-c2497270b6bc7784f01f58e06d8a2454.png" title="MS_{ABC}" alt="MS_{ABC}" class="tex"/>
</td>
<td><img src="../images/Algorithm(Three_Way_ANOVA)/math-c2497270b6bc7784f01f58e06d8a2454.png" title="MS_{ABC}" alt="MS_{ABC}" class="tex"/> / <img src="../images/Algorithm(Three_Way_ANOVA)/math-ff8dc369a4b279c7e064cb1ef6fc4ba1.png" title="MS_{Error}" alt="MS_{Error}" class="tex"/>
</td>
<td><img src="../images/Algorithm(Three_Way_ANOVA)/math-42856e0f0acc8506fd925fe88c3be665.png" title="P\{F\geq F_{((I-1)(J-1)(K-1),df_e,\alpha )}\}" alt="P\{F\geq F_{((I-1)(J-1)(K-1),df_e,\alpha )}\}" class="tex"/>
</td></tr>
<tr>
<th>誤差
</th>
<td><img src="../images/Algorithm(Three_Way_ANOVA)/math-0cec8e73933cf1bb4ed01dde2e10a68d.png" title="df_e" alt="df_e" class="tex"/>=<i>N</i>-<i>IJK</i>
</td>
<td><img src="../images/Algorithm(Three_Way_ANOVA)/math-349fb0475e9b16a6353bbc1aae235e6a.png" title="SS_{Error}" alt="SS_{Error}" class="tex"/>
</td>
<td><img src="../images/Algorithm(Three_Way_ANOVA)/math-ff8dc369a4b279c7e064cb1ef6fc4ba1.png" title="MS_{Error}" alt="MS_{Error}" class="tex"/>
</td>
<td>
</td>
<td>
</td></tr>
<tr>
<th>合計
</th>
<td><i>N</i> - 1
</td>
<td><img src="../images/Algorithm(Three_Way_ANOVA)/math-100f5db42fc55631c7b4e798218f6a8f.png" title="SS_{Total}" alt="SS_{Total}" class="tex"/>
</td>
<td>
</td>
<td>
</td>
<td>
</td></tr></table>
<h2><a name="Multiple_Means_Comparisons"></a><span class="mw-headline">複数の平均比較</span></h2>
<p>Originでは、平均比較にさまざまな方法があり、これは<i>ocstat_dlsm_mean_comparison()</i> 関数を使って行っています。 
</p><p>複数の平均の比較法の2種類がOriginに含まれています。 
</p><p>シングルステップ法これは、Tukey-Kramer, Bonferroni, Dunn-Sidak, Fisher&rsquo;s LSD, Scheff&eacute;を含む、平均がどの程度違うのかを示すために信頼区間を作成します。
</p><p>ステップワイズ法Holm-Bonferroni 、Holm-Sidak 検定を含む仮説検定を実行します。
</p>
<h2><a name="Power_Analysis"></a><span class="mw-headline">検出力解析</span></h2>
<p>検出力分析は、サンプルデータに対する仮説の検出力だけでなく、実際の検出力を計算します。
</p><p>三元配置ANOVAの検出力は、その敏感度の計測です。検出力は、ANOVAが実際の差があるときの標本の平均の差を検出するものです。帰無仮説および対立仮説に関して、検出力は検定する統計量 F が、実際に帰無仮説を棄却すべき(例：与えられた帰無仮説が真でない)ときに、帰無仮説を棄却するのに十分であるという確率です。
</p><p>Originの三元配置ANOVAダイアログは、因子A、因子Bおよび因子C に対する検出力を計算します。特定の交差項が選択された場合もOriginは検出力を計算します。
</p><p>検出力は次式で定義されます。  
</p><p><img src="../images/Algorithm(Three_Way_ANOVA)/math-e3a9b7f790e5b9b01d2fe974337ea4cf.png" title="power=1-probf(f,df,dfe,nc)\,\!" alt="power=1-probf(f,df,dfe,nc)\,\!" class="tex"/>
</p><p>ここで <I>f </I>は、非中心の <I>F</I>-分布の偏りで、この<I>F</I>分布は自由度<I>df</I> および <I>dfe</I> と <I>nc = SS/MSE</I>を持ちます。SS は<i>A</i>, <i>B</i>, <i>C</i>, <i>A*B</i>, <i>A*C</i>, <i>B*C</i>, <i>A*B*C</i>の二乗和で、MSEは誤差の平均平方、 <I>df</I> は分子の自由度、<I>dfe</I> は誤差の自由度です。全ての値<i>(<i>SS</i>, </i><i>M</i>SE, df, <i>dfe</i>) は、ANOVA表で取得できます。<i>probf</i>( ) の値が、NAG関数<a class="external text" target="_blank" href="http://www.originlab.com/pdfs/nagcl09/manual/pdf/g01/g01gdc.pdf"><b>nag_prob_non_central_f_dist (g01gdc)</b></a>で取得されます。詳細はNAG文書をご覧ください。
</p><p>上記は、簡単な三元配置ANOVAのアルゴリズムの概要であり、詳細な数学的な演算については、このマニュアルの対応する部分やNAG文書を参照してください。
</p>
<h2><a name="Levene_test_for_Homogeneity_of_Variances"></a><span class="mw-headline">等分散性のLeveneの検定 </span></h2>
<p>Leveneの検定を行うために以下の統計を使用します。
</p><p><img src="../images/Algorithm(Three_Way_ANOVA)/math-d3bfbc09dea01e9ac160725781de92ea.png" title="L = \frac{(N-k)\sum_{k}^{i=1}n_i(Z_i-Z)^2}{(k-1)\sum_{k}^{i=1}\sum_{n_i}^{j=1}(Z_{ij}-Z_i)^2}" alt="L = \frac{(N-k)\sum_{k}^{i=1}n_i(Z_i-Z)^2}{(k-1)\sum_{k}^{i=1}\sum_{n_i}^{j=1}(Z_{ij}-Z_i)^2}" class="tex"/>
</p><p>ここで 
</p><p><i>N</i> は観測値の数、<img src="../images/Algorithm(Three_Way_ANOVA)/math-d12d6997eb7752845328c388de196659.png" title="k = IJK" alt="k = IJK" class="tex"/> は観測値 <img src="../images/Algorithm(Three_Way_ANOVA)/math-adc98b949625e9830e389a7232a15d2d.png" title="n_i(i=1,...,k)" alt="n_i(i=1,...,k)" class="tex"/> のサブグループの数です。
</p><p><img src="../images/Algorithm(Three_Way_ANOVA)/math-c259a976bb76363cc7e1babf02971f77.png" title="Z_{ij} = |Y_{ij}-T_i|" alt="Z_{ij} = |Y_{ij}-T_i|" class="tex"/>
</p><p><img src="../images/Algorithm(Three_Way_ANOVA)/math-8c310536db00fa9688168ebace905389.png" title="T_i = \frac{1}{n_i}\sum_{n_i}^{j=1}Y_{ij}" alt="T_i = \frac{1}{n_i}\sum_{n_i}^{j=1}Y_{ij}" class="tex"/>
</p><p><img src="../images/Algorithm(Three_Way_ANOVA)/math-442f62839ba312c5dd42941add171871.png" title="Z_i = \frac{1}{n_i}\sum_{n_i}^{j=1}Z_{ij}" alt="Z_i = \frac{1}{n_i}\sum_{n_i}^{j=1}Z_{ij}" class="tex"/>
</p><p><img src="../images/Algorithm(Three_Way_ANOVA)/math-776a1d6fd0b15cb0ee444a11839e2da4.png" title="Z = \frac{1}{N}\sum_{k}^{i=1}Z_i" alt="Z = \frac{1}{N}\sum_{k}^{i=1}Z_i" class="tex"/>
</p><p>そして、p値 <img src="../images/Algorithm(Three_Way_ANOVA)/math-61b92b4e6a98ff4a75c7ae495f4af4ee.png" title="1-F_{k-1,N-k}(L)" alt="1-F_{k-1,N-k}(L)" class="tex"/> が得られます。
</p>




    