<h1 class="firstheading">ワークシートを新しいシートに分割する</h1><p class='urlname' style='display: none'>split-wks-into-sheets</p>
<h2><a name="Description"></a><span class="mw-headline">説明</span></h2>
<p><a  class="image"><img alt="SplitWorksheet.png" src="../images/Split_Worksheet/SplitWorksheet.png" width="828"  /></a>
<br /><br />
Originには、1つのワークシートを複数のワークシートに分割するツールがあります。分割方法としては、<i><i>n</i></i>列ごと、<i><i>n</i></i> 行ごと、レベル行によるグループごとから指定して新しいシートに分離できます。<b>wsplit</b>ダイアログは、Xファンクション<a class="external text" href="../../XFunction/X-Function/Wsplit.html">wsplit</a>を使用しています。
</p>
<h5><a name="To_Split_Your_Worksheet"></a><span class="mw-headline">ワークシートの分割</span></h5>
<ol><li> ワークシートをアクティブにします。</li>
<li> <b>データ整形：<b>ワークシートの分割</b></b>と選択して<b><b>wsplit_book</b> </b>ダイアログを開きます。</li></ol>
<h2><a name="Dialog_Options"></a><span class="mw-headline">ダイアログオプション</span></h2>
<table class="dialogcontroltable">
<tr>
<th>再計算
</th>
<td>
<p><a href="../../UserGuide/UserGuide/Recalculating_Analysis_Results.html" title="ユーザガイド：分析結果の再計算">再計算モード</a>を指定します。
</p>
<ul><li><b>なし</b></li>
<li><b>自動</b></li>
<li><b>手動</b></li></ul>
</td></tr>
<tr>
<th>入力ワークシート
</th>
<td>
<p>分割するワークシートです。Origin 2017bから、CTRLキーを押しながら列範囲を選択して分割可能です。シート全体でなくても分割できます。
</p><p>範囲の設定に関する詳細は、<a class="external text" href="../../UserGuide/UserGuide/Specifying_Your_Input_Data.html">入力データを指定する</a>をご覧ください。
</p>
</td></tr>
<tr>
<th>分割モード
</th>
<td>
<p>どのように分割するか指定します。
</p>
<ul><li><b>列数による</b> 
<dl><dd><i>n</i> 列ごとに新しいワークシートに分解します。<b><b>列の数</b></b>ボックスで<i><i>n</i></i> を指定します。</dd></dl></li>
<li><b>行数による</b> 
<dl><dd><i>n</i> 行ごとに新しいワークシートに分解します。<b><b>行数</b></b>ボックスで<i><i>n</i></i> を指定します。</dd></dl></li>
<li><b>列ラベルによる</b>
<dl><dd>指定したラベル行でグループ化し、新しいワークシートに分割します。<b><b>列ラベル</b></b>の項目で<a href="../../UserGuide/UserGuide/Displaying_Supporting_Data_in_Worksheet_header_Rows.html" title="ユーザガイド:ワークシートヘッダ行に表示するサポートデータ">ラベルが入力されたヘッダ行</a>を指定します。</dd></dl></li>
<li><b>参照列</b>
<dl><dd>参照列の値で、列が新しいワークシートに分割されます。複数列の値で分割する場合、表示される順番が重要になります。</dd></dl></li></ul>
</td></tr>
<tr>
<th>列の数
</th>
<td><b><b>分割モード</b></b>を<b><b>列の数による</b></b>にしたとき有効です。全ての<i>n</i>毎に指定して、新しいワークシートを作成します。(<b><b>参照列ごと</b></b>には対応していません)
</td></tr>
<tr>
<th>最初のN列を保持する
</th>
<td><b><b>分割モード</b></b>を<b><b>列番号による</b></b>または<b>列ラベルによる</b>にしたとき有効です。元のワークシートの最初の<i>n</i>列を指定して、分割された全ての結果シートにおいても保持されるようにします。これらの最初の<i>n</i>列は、<b><b>列番号による</b></b>または<b>列ラベルによる</b>から除外されます。
</td></tr>
<tr>
<th>行数
</th>
<td><b><b>分割モード</b></b>を<b><b>行数による</b></b>にしたとき有効です。全ての<i>n</i>毎に指定して、新しいワークシートを作成します。(<b>参照列</b>のみに適用)
</td></tr>
<tr>
<th>列ラベル
</th>
<td><b><b>分割モード</b></b>を<b><b>列ラベルによる</b></b>にしたとき有効です。新しいワークシートに分割する際に、列をグループ化する情報が入力された列ラベルを指定します。
</td></tr>
<tr>
<th>参照列
</th>
<td><b><b>分割モード</b></b>を<b>参照列</b>にしたとき有効です。グループ化変数を含む列を指定します（複数選択可）。 <br />
<p>複数列選択した場合、順序リストでどのように分割するか決定します。<br />
単一の列を選択すると、<b>分割</b>ドロップダウンリストが表示され、値または他の条件（参照値のジャンプや回転など）で列を分割するかどうかを制御できます。
</p>
</td></tr>
<tr>
<th>分割
</th>
<td>選択した単一の参照列に対してのみ使用できます。選択した参照列に従ってワークシートを分割する方法を指定します。
<ul><li><b>値による</b>
<dl><dd>参照列の値に従ってワークシートの行を分割します。参照列に同じ値を持つ行が分割され、新しいワークシートに抽出されます。数値には許容値を設定できます。これは、選択された単一の参照列の<b>分割</b>コントロールのデフォルトの選択です。</dd></dl></li>
<li><b>方向の変更による</b>
<dl><dd>参照列の値の方向が昇順から降順、またはその逆に変更されたときに、ワークシートの行を分割します。</dd></dl></li>
<li><b>方向のリセットによる</b>
<dl><dd>参照値の上昇/下降が終了し、元の値に戻ったら、ワークシートの行を分割します。 </dd></dl></li>
<li><b>値の変更による</b>
<dl><dd>参照値が変更されたときにワークシートの行を分割します。数値には許容値を設定できます。参照値は識別子として使用され、各結果シートの<a href="../../UserGuide/UserGuide/Basic_Operations_on_Worksheet.html#Name_and_Notes" title="ユーザガイド：ワークシートの基本操作">シートラベル</a>として設定されます。</dd></dl></li></ul>
<p><a  class="image"><img alt="Split By Reference Columns.png" src="../images/Split_Worksheet/Split_By_Reference_Columns.png" width="803"  /></a>
</p>
</td></tr>
<tr>
<th>許容値
</th>
<td><b>分割モード</b> = <b>参照列</b>で、<b>分割</b>=<b>値による</b>/<b>値の変更による</b>のとき、このドロップダウンボックスを使用して、数値が変更されたがどうかを判断するときの許容値を設定できます。
</td></tr>
<tr>
<th>各曲点を含める
</th>
<td><b>分割</b>を<b>方向変更による</b>にしたとき、このドロップボックスを使用して各曲点の処理方法を決定し、前のグループまたは次のグループに含めることができます。
</td></tr>
<tr>
<th>結果内に参照列を保持
</th>
<td>分割した結果付きの参照列データの出力。(<b>参照列</b>のみに適用)
</td></tr>
<tr>
<th>参照列による結果を並べ替え
</th>
<td><b>結果に参照列を保存</b>をチェックしたときに、分割結果の行を参照値で並べ替えるかどうかを指定します。
<p>このチェックボックスは、<b>方向の変更による</b>または<b>方向のリセットによる</b>によるに設定された分割コントロールでのみ使用できます。 
</p>
</td></tr>
<tr>
<th>欠損値を除外
</th>
<td>空のセルや欠損値(<b>&quot;--&quot;</b>)を含むセルを分割した結果から除外します。(<b>参照列</b>のみに適用)
</td></tr>
<tr>
<th>列の数式を結果にコピーする
</th>
<td>ソースワークシートに列の数式がある場合、式をどう扱うか設定します。
<ul><li><b>なし</b>
<dl><dd>列の数式をコピーしません。</dd></dl></li>
<li><b>コピーして実行</b>
<dl><dd>列の数式を結果シートにコピーして実行します。</dd></dl></li>
<li><b>式のテキストをコピー</b>
<dl><dd>列の数式を結果シートにコピーしますが、実行しません。必要に応じて手動で実行します。</dd></dl></li></ul>
</td></tr>
<tr>
<th>元のワークシートの維持
</th>
<td>元のワークシートをそのまま残します。チェックを付けないと元のワークシートは削除されます。
</td></tr>
<tr>
<th>スパークラインを表示する
</th>
<td>出力ワークシートの列のスパークラインを表示します。
</td></tr>
<tr>
<th>出力ワークシート
</th>
<td>出力ワークシートを指定します。
<p>範囲制御についてはこちらを参照してください：<a class="external text" href="../../UserGuide/UserGuide/Output_Results.html">出力結果</a>
</p>
</td></tr>
<tr>
<th>結果シート名事前設定
</th>
<td><b>分割モード</b>を<b>参照列</b>、<b>分割</b>を<b>値による</b>にしたとき有効です。<br />
<p><br />
<b>%N: 参照列のロングネームまたはショートネーム</b> (例: <i>ロングネーム</i>、<i>ロングネーム</i>1 など)<br /> <b>%C: 参照列のデータセット名</b> (例: <i>Book1_A</i>、<i>Book1_A</i>1 など)<br /> <b>%M: 参照列のコメント</b> (例: <i>コメント</i>、<i>コメント</i>1 など)<br /> <b>%U: 参照列の単位</b> (例: <i>単位</i>、<i>単位</i>1 など)<br /> <b>%V: 参照列のセルの値</b> (例: <i>グループ 1</i>、<i>グループ 2</i> など)<br /> <br /> 名前は連結変数で構成することができ、任意のテキストうぃ含みます(例: &quot;%N=%V は &quot;<i>Column Name</i>=<i>Cell Value</i>&quot; という名前のシートを作成します)。
</p><p>Origin 2019bでは、このオプションはデフォルトで<b>%V</b>に設定されており、グループ情報シートの名前と合わせてサブグループごとに新しいシートを出力します。
</p>
</td></tr></table>
<p><br />
</p>
<table class="note">
<tr>
<td> <b>Note:</b> Origin 2017から、<a href="../../UserGuide/UserGuide/Column_Short_Name_Restriction.html" title="ユーザガイド:列ショートネームの制限">列のショートネームは、アルファベット順に制限</a>されます。初期設定ではこれは編集出来ません。この理由から、ダイアログの<b>ショートネームを保持</b>オプションは非表示になりました。Origin 2017より前のバージョンで作成したプロジェクトを開く場合や、<a href="../../UserGuide/UserGuide/Folder_and_Window_Properties_Dialog.html#The_Properties_tab" title="ユーザガイド：フォルダとウィンドウのプロパティダイアログ">スプレッドシートセル表記をオフ</a>にしている場合で、分割後もショートネームを保持したい場合、以下のようにします。
<ol>
<li><b>コマンドウィンドウ</b>または、<b>スクリプトウィンドウ</b>を開き、以下のように入力してEnterキーを押します。</li>
<pre class="lt" style="font-family:monospace;">@SSG <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span></pre> 
<li><b>wsplit</b> ダイアログを開き、<b>ショートネームを保持</b> オプションにチェックをつけます。</li>
</ol>
</td></tr></table>




    