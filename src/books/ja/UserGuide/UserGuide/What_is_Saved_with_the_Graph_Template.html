<h1 class="firstheading">何がグラフテンプレートと一緒に保存されるのか?</h1><p class='urlname' style='display: none'>Graph-Template-Elements</p>
<p>グラフウィンドウはグラフテンプレートファイルから作成されます。  Originのグラフテンプレートファイルの拡張子は<b><b>OTP</b></b>です。  Originは多数のグラフテンプレート（システムテンプレート）を内蔵しています。  これらのテンプレートはOriginの100種類以上のグラフタイプを作成するために使用され、カスタム設定に変更して保存できます。  
</p><p>グラフテンプレートファイルは、テンプレートにデータを保存しないという点でグラフ<i>ウィンドウ</i>ファイル（.OGG）と異なります。  そうではなく、グラフテンプレートファイルは重要なページとレイヤの特性（ページサイズ、レイヤ数、テキストと描画オブジェクトの拡大縮小など）を保存し、データの印刷スタイル情報（印刷タイプ、印刷色、データラベルなど）も保存します。   詳細は、『グラフテンプレートに保存される属性』をご覧下さい。
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Saving_graph_customizations_to_a_template_file"><span class="tocnumber">1</span> <span class="toctext">グラフに施した編集をテンプレートファイルに保存する</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Attributes_saved_with_the_graph_template"><span class="tocnumber">2</span> <span class="toctext">グラフテンプレートに保存される属性</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#A_note_about_data_plot_style_holders"><span class="tocnumber">3</span> <span class="toctext">データプロットのスタイルホルダについての注意</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Additional_Scripts_Saved_with_Template"><span class="tocnumber">4</span> <span class="toctext">テンプレートとともに保存される追加のスクリプト</span></a></li>
</ul>
</div>
<h2><a name="Saving_graph_customizations_to_a_template_file"></a><span class="mw-headline">グラフに施した編集をテンプレートファイルに保存する</span></h2>
<p>アクティブなグラフウィンドウをグラフテンプレート（.OTP）ファイルとして保存するには
</p>
<ol><li>グラフウィンドウをアクティブにして、「<b>ファイル：テンプレートの新規保存</b>」を選びます。 </li></ol>
<p><i>または、</i> 
</p>
<ol><li>ウィンドウのタイトルバーを右クリックして、ショートカットメニューから<b>テンプレートの新規保存</b>を選びます。  </li></ol>
<p>どちらの方法でも、「<b>template_saveas</b>」ダイアログボックスが開きます。ダイアログボックスでの編集方法についての詳細は、<a href="../../UserGuide/UserGuide/Template_Files.html#Saving_a_customized_window_as_a_template" title="ユーザーガイド:テンプレートファイル">テンプレートとしてカスタムウィンドウを保存</a>を参照してください。
</p>
<h2><a name="Attributes_saved_with_the_graph_template"></a><span class="mw-headline">グラフテンプレートに保存される属性</span></h2>
<p>グラフページ、ページ上の各グラフレイヤ、軸、目盛ラベル、軸ラベル、テキストまたはオブジェクトの注釈、およびデータプロットはすべて、グラフテンプレートに保存できるプロパティを持っています。  
</p><p><b><b>作図の詳細</b></b>ダイアログボックスで制御した属性は、グラフテンプレートとともに保存されます。
</p>
<ul><li>作図の詳細ダイアログボックスのページタブ</li>
<li>作図の詳細ダイアログボックスのレイヤタブ</li>
<li>作図の詳細ダイアログボックスのデータプロットタブ</li>
<li>作図の詳細ダイアログボックスの関数、データ点、エラー、ラベルのタブ</li></ul>
<p>以下のダイアログボックスで制御される属性は、グラフテンプレートに保存されます。
</p>
<ul><li><b><b>軸</b></b>ダイアログボックス。  </li>
<li>グラフの注釈（テキストおよび描画オブジェクト）を制御するダイアログボックス。 </li></ul>
<p>また、以下のグラフウィンドウのプロパティもテンプレートに保存されます。
</p>
<ul><li>グラフのロングネーム。このテンプレートで作成するグラフのロングネームを事前定義できます。</li>
<li>グラフのショートネーム。このテンプレートで作成するグラフのショートネームを事前定義できます。</li></ul>
<table class="note">
<tr>
<td><b>Note:</b>グラフロングネーム/ショートネームの事前定義は、テーマから設定します。<b>フォーマットをテーマとして保存</b>ダイアログには、以下の設定項目があります。
<ul><li><i>page.Misc.PagePresetLongName.strVal</i>で、ロングネームを事前定義</li>
<li><i>page.Misc.PagePresetShortName.strVal</i>で、ショートネームを事前定義  </li></ul>
</td></tr></table>
<p><br />
<i><b>最後に...</b></i>
</p>
<ul><li> グラフテンプレートを保存するときにそれを「クローンテンプレート」としてマークした場合は、グラフウィンドウプロットの関係とソースデータの構造に関する情報がグラフテンプレートとともに保存されます。詳細については、<a href="../../UserGuide/UserGuide/Graph_Template_Basics.html#Cloneable_Templates" title="ユーザガイド:グラフテンプレートの基本">クローンテンプレート</a> をご参照ください。</li>
<li> テンプレート保存時のグラフのプレビュー画像は、グラフテンプレートとともに保存されます。このプレビューは、<b>作図</b>メニューと<b>テンプレートライブラリ</b>でテンプレートの表示に使用されます。</li></ul>
<h2><a name="A_note_about_data_plot_style_holders"></a><span class="mw-headline">データプロットのスタイルホルダについての注意</span></h2>
<p>グラフウィンドウの各データプロットの詳細（またはデータプロットスタイル）は、データプロットスタイルホルダーに保存されます。  <b>データプロットスタイルホルダ</b>には、データプロットの種類(例：散布図、折れ線、縦棒など)についての情報およびデータプロットの設定(例：「作図の詳細」ダイアログボックスの『シンボル』タブ上の設定など)ついての情報が含まれます。  グラフウィンドウをテンプレートとして保存すると、グラフウィンドウの各レイヤのデータプロットには、データプロットスタイルホルダーが関連付けられます。  
</p><p>したがって、このカスタムテンプレートに基づいてグラフを作成すると、グラフ内の各レイヤについて、そのレイヤの最初のデータプロットスタイルホルダーに格納されている情報に従って、そのレイヤの最初のデータプロットが表示されます。  レイヤ内の2番目のデータプロットは、そのレイヤの2番目のデータプロットスタイルホルダに格納されている情報に従って表示されます。  データプロットをレイヤに追加すると、Originは現在使用されていないデータプロットスタイルホルダを検索し（レイヤの内容からデータプロットを削除した場合など）、最初のデータプロットスタイルを使用してデータプロットを表示します。  保存されたスタイルホルダー数よりも多くのデータプロットをレイヤに追加した場合、最後のデータプロットスタイルホルダーの情報を使用してデータプロットを表示します。
</p>
<h2><a name="Additional_Scripts_Saved_with_Template"></a><span class="mw-headline">テンプレートとともに保存される追加のスクリプト</span></h2>
<p>特定のコマンドを使用して、グラフテンプレートとともにLabTalkスクリプトを保存できます。Origin 2021bから、2つのコマンドがサポートされます。
</p><p><span class='headerInParagraph'>グラフのプロット中にLabTalkコマンドを実行するには、 </span>
</p>
<ul><li> コマンド<b>page.info.system.plotting.LT$=</b>を使用</li></ul>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/What_is_Saved_with_the_Graph_Template/Tutorial_icon.png" width="57"  border="0" />
	</td>
	<td><ol>
<li>プロジェクトを新規作成し、<b>&lt;<i>Program Folder</i>&gt;\Samples\Graphing\Group.DAT</b>を新しいブックにインポートします。
<li>最初の2列を選択し、<b>作図：基本の2Dグラフ： 散布図</b>を選択してグラフを作成します。 
<li>プロットをダブルクリックして作図の詳細ダイアログを開き、シンボル形状を塗りつぶし円を選択し、<b>サイズ</b>をcol(C)にし、<b>縮尺倍率</b>を4に設定して、シンボルカラーマッピングとしてcol(D)を割り当てます。<br />
<a  class="image"><img alt="Save Script With Template.png" src="../images/What_is_Saved_with_the_Graph_Template/Save_Script_With_Template.png" width="617"  /></a></li>
<li> シンボルサイズのマッピングとシンボルカラーのマッピングをテンプレートに保存するには、まず以下のスクリプトを実行する必要があります。
<pre class="lt" style="font-family:monospace;">page.<span style="color: #000080;">info</span>.<span style="color: #000080;">system</span>.<span style="color: #000080;">plotting</span>.<span style="color: #000080;">LT</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;worksheet -p 248 __TEMPLATE;&quot;</span></pre>
<p>ここで、<code>worksheet -p 248 __TEMPLATE;</code>は列マッピング情報をテンプレートとともに保存するLabTalkコマンドです。 <code>__TEMPLATE</code> は、保存する現在のウィンドウを示すためのキーです（名前を付けていないため）。
</p>
</li>
<li> ウィンドウタイトルを右クリックし、<b>テンプレートの新規保存</b> を選択してダイアログを開き、「myBnC」といった名前を入力して、OKをクリックします。
<li> 元のワークブックをアクティブにし、<b>作図：ユーザテンプレートに作図: myBnC</b>を選択すると、同じグラフを作成できます。
</ol>
</td></tr></table>
<p><br />
<span class='headerInParagraph'>グラフをプロットした後にLabTalkコマンドを実行するには、</span>
</p>
<ul><li> コマンド<b>page.info.system.plotting.LTAfter$</b>を使用</li></ul>
<p>たとえば、プロット後に<b>境界幅</b>= <i>8</i>で<a href="../../UserGuide/UserGuide/Fitting_Page_to_Layers_and_Fitting_Layer_to_Page.html" title="ユーザガイド：ページをレイヤ、レイヤをページに合わせる">「ページをレイヤサイズに合わせる」</a>場合は、次のコマンドを実行します。 
</p>
<pre class="lt" style="font-family:monospace;">page.<span style="color: #000080;">info</span>.<span style="color: #000080;">system</span>.<span style="color: #000080;">plotting</span>.<span style="color: #000080;">LTAfter</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;pfit2l borderwid:=8;」</span></pre>


    