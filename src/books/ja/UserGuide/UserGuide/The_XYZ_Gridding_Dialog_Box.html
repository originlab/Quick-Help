<h1 class="firstheading">XYZグリッディング(XYZ対数グリッディング)ダイアログボックス</h1><p class='urlname' style='display: none'>XYZGridding-Dialog</p>
<p><br />
<b>XYZグリッディング</b>および<b>XYZ対数グリッディング</b>ダイアログボックスにアクセスするには、メニューから<b>ワークシート：行列に変換：XYZグリッディング</b>または<b>ワークシート：行列に変換：XYZ対数グリッディング</b>を選択します。どちらのダイアログボックスも2つのパネルがあり、左のパネルはパラメータコントロール、右のパネルは機能プレビューのタブがあり、それぞれで設定は同じです。 
</p>
<dl><dd><a  class="image"><img alt="The XYZ Gridding Dialog Box.png" src="../images/The_XYZ_Gridding_Dialog_Box/The_XYZ_Gridding_Dialog_Box.png" width="902"  /></a></dd></dl>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Input_Data"><span class="tocnumber">1</span> <span class="toctext">入力データ</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Data_Examination"><span class="tocnumber">2</span> <span class="toctext">データチェック</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Gridding_Method_and_Parameters"><span class="tocnumber">3</span> <span class="toctext">グリッディング手法とそのパラメータ</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Advanced"><span class="tocnumber">4</span> <span class="toctext">詳細</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#No_Extrapolation_outside_Boundary"><span class="tocnumber">5</span> <span class="toctext">境界外の外挿なし</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Preview_Plot_Type"><span class="tocnumber">6</span> <span class="toctext">プレビューのプロットタイプ</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Output"><span class="tocnumber">7</span> <span class="toctext">出力</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Preview.28Right.29_Panel:"><span class="tocnumber">8</span> <span class="toctext">プレビュー（右側）パネル:</span></a></li>
</ul>
</div>
<h2><a name="Input_Data"></a><span class="mw-headline">入力データ</span></h2>
<p>ワークシートの1つ以上のZ列が必要です。Zデータを選択してから、XYZグリッディングまたはXYZ対数グリッディングダイアログを開くと、Originは自動で選択範囲を入力として設定します。ダイアログが開いたら、入力ダイアログコントロールを使用して範囲を変更できます。
</p><p>複数のZ列が指定された場合、各Z列は、同じ行列シート内の行列オブジェクトに各々変換されます。
</p>
<h2><a name="Data_Examination"></a><span class="mw-headline">データチェック</span></h2>
<p>同じXYデータに対する複数のZ値を入力とすることはできません。(a) 2つのXY対データを同じ点として扱うかどうか、(b)同じXY対データに結びついているZデータをどのように扱うのかを指定するには、3つの方法があります。
</p>
<table class="dialogcontroltable">
<tr>
<th> 複数のXの許容値
</th>
<td> 複数のX座標データを検出する許容値を指定します。近接する2点(x<sub>1</sub>, y<sub>1</sub>, z<sub>1</sub>) 及び(x<sub>2</sub>, y<sub>2</sub>, z<sub>2</sub>)に対して次が成り立つ場合、
<dl><dd><img src="../images/The_XYZ_Gridding_Dialog_Box/math-a059807ad61e3d2967d7ac0fd59d5b34.png" title="\left | \frac{x_1-x_2}{x_1+x_2} \right | &lt; 許容値" alt="\left | \frac{x_1-x_2}{x_1+x_2} \right | &lt; 許容値" class="tex"/></dd></dl>
<p>これらの2つのX値は重複していると見なされます。<b>Y許容値</b>の値は、 (0, 1)の間の値を指定します。
</p>
</td></tr>
<tr>
<th> 複数のYの許容値
</th>
<td> 複数Y座標データを検出する許容値を指定します。近接する2点(x<sub>1</sub>, y<sub>1</sub>, z<sub>1</sub>) 及び(x<sub>2</sub>, y<sub>2</sub>, z<sub>2</sub>)に対して次が成り立つ場合、
<dl><dd><img src="../images/The_XYZ_Gridding_Dialog_Box/math-d6c8801878c117379a624b49d0884e40.png" title="\left | \frac{y_1-y_2}{y_1+y_2} \right | &lt; 許容値" alt="\left | \frac{y_1-y_2}{y_1+y_2} \right | &lt; 許容値" class="tex"/></dd></dl>
<p>これらの2つのY値は重複していると見なされます。<b>Y許容値</b>の値は、 (0, 1)の間の値を指定します。
</p>
</td></tr>
<tr>
<th> 重なりの置換
</th>
<td> 許容値を考慮して2つのZ値が同じXYデータの対と皆割れる場合、これらのZ値を新しい値に統合する必要があります。このドロップダウンを使って新しい値を指定します。<b>平均</b>、<b>中央値</b>、<b>最大</b>、<b>最小</b>、<b>合計</b>から選択します。
</td></tr></table>
<p>複数のXYペアのデータを取り扱った後は、そのデータが等間隔であるかを調べます。X方向に等間隔かどうか、Y方向に等間隔かどうかを調べます。
</p>
<table class="dialogcontroltable">
<tr>
<th> 等間隔Xの許容値
</th>
<td>
<p>Xデータの規則性チェックのため、許容値を指定します。近接する各2点 (x<sub>i</sub>, y<sub>i</sub>, z<sub>i</sub>) 及び (x<sub>i+1</sub>, y<sub>i+1</sub>, z<sub>i+1</sub>) に対して次が成り立つ場合、
</p>
<dl><dd><img src="../images/The_XYZ_Gridding_Dialog_Box/math-6014690389b02c64a7fe383762f806a0.png" title="\frac{\left|x_i-x_{i+1}\right| \bmod I_x}{I_x}&lt; 許容値" alt="\frac{\left|x_i-x_{i+1}\right| \bmod I_x}{I_x}&lt; 許容値" class="tex"/></dd></dl>
<p>または
</p>
<dl><dd><img src="../images/The_XYZ_Gridding_Dialog_Box/math-51652bfbe244e0dfe2011a29bcf02186.png" title="\frac{\left|x_i-x_{i+1}\right| \bmod I_x}{I_x}&gt;1 - 許容値" alt="\frac{\left|x_i-x_{i+1}\right| \bmod I_x}{I_x}&gt;1 - 許容値" class="tex"/></dd></dl>
<p><b>I<sub>x</sub></b> はXデータ間の平均間隔です。<br />
</p><p>これらのX データは、等間隔であると考えられます。<b>等間隔Xの許容値</b>の値は、 (0, 1)の間の値を指定します。
</p>
</td></tr>
<tr>
<th> 等間隔Yの許容値
</th>
<td>
<p>Yデータの規則性チェックのため、許容値を指定します。近接する各2点 (x<sub>i</sub>, y<sub>i</sub>, z<sub>i</sub>) 及び (x<sub>i+1</sub>, y<sub>i+1</sub>, z<sub>i+1</sub>) に対して次が成り立つ場合、
</p>
<dl><dd><img src="../images/The_XYZ_Gridding_Dialog_Box/math-2e8f2aac7bb10cae2ecbe0a3113ac8d6.png" title="\frac{\left|y_i-y_{i+1}\right| \bmod I_y}{I_y}&lt; 許容値" alt="\frac{\left|y_i-y_{i+1}\right| \bmod I_y}{I_y}&lt; 許容値" class="tex"/></dd></dl>
<p>または
</p>
<dl><dd><img src="../images/The_XYZ_Gridding_Dialog_Box/math-1f9479d0b932c9bfd3c40c0328517d3a.png" title="\frac{\left|y_i-y_{i+1}\right| \bmod I_y}{I_y}&gt;1 - 許容値" alt="\frac{\left|y_i-y_{i+1}\right| \bmod I_y}{I_y}&gt;1 - 許容値" class="tex"/></dd></dl>
<p><b>I<sub>x</sub></b> はYデータ間の平均間隔です。<br />
</p><p>これらのXデータは、等間隔であると考えられます。<b>等間隔Yの許容値</b>の値は、 (0, 1)の間の値を指定します。
</p>
</td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/The_XYZ_Gridding_Dialog_Box/Tip_icon.png" width="57"  border="0" /></td><td><p>データが等間隔であると考えられる場合のみ、 <b><a href="../../UserGuide/UserGuide/Gridding_of_Regularly_Spaced_Data.html" title="ユーザガイド:等間隔に並んだデータのグリッディング">均一</a></b> と <b><a href="../../UserGuide/UserGuide/Gridding_of_Sparse_or_Missing_Data.html" title="ユーザガイド:疎データまたは欠損データのグリッディング">まばら</a></b> のどちらかを<b>グリッディング手法とパラメーター</b>のドロップダウンから選択できます。.もし等間隔でない場合は、ランダム変換方法または、重なりの許容値と間隔を大きくして試してください。
</p></td></tr></table>
<h2><a name="Gridding_Method_and_Parameters"></a><span class="mw-headline">グリッディング手法とそのパラメータ</span></h2>
<p>グリッディング手法を選択し、グリッディングパラメータを設定します。コントロールは手法によって異なるので注意してください。 
</p>
<table class="dialogcontroltable">
<tr>
<th> グリッディング手法とそのパラメータ
</th>
<td>
<p>グリッディング手法を指定します。
</p>
<ul><li> <a href="../../UserGuide/UserGuide/Gridding_of_Regularly_Spaced_Data.html" title="ユーザガイド:等間隔に並んだデータのグリッディング">X/Y等間隔</a></li>
<li> <a href="../../UserGuide/UserGuide/Gridding_of_Sparse_or_Missing_Data.html" title="ユーザガイド:疎データまたは欠損データのグリッディング">疎データ</a></li>
<li> <a href="../../UserGuide/UserGuide/Gridding_Methods_for_Randomly_Spaced_Data.html#Renka_Cline" title="ユーザガイド:ランダム配置データのグリッディング法">Renka- Cline</a></li>
<li> <a href="../../UserGuide/UserGuide/Gridding_Methods_for_Randomly_Spaced_Data.html#Shepard" title="ユーザガイド:ランダム配置データのグリッディング法">Shepard</a></li>
<li> <a href="../../UserGuide/UserGuide/Gridding_Methods_for_Randomly_Spaced_Data.html#Thin_Plate_Spline_.28TPS.29" title="ユーザガイド:ランダム配置データのグリッディング法">Thin Plate Spline</a></li>
<li> <a href="../../UserGuide/UserGuide/Gridding_Methods_for_Randomly_Spaced_Data.html#Kriging_Correlation" title="ユーザガイド:ランダム配置データのグリッディング法">Kriging Correlation</a></li>
<li> <a href="../../UserGuide/UserGuide/Gridding_Methods_for_Randomly_Spaced_Data.html#Weighted_Average" title="ユーザガイド:ランダム配置データのグリッディング法">加重平均</a></li></ul>
</td></tr>
<tr>
<th> 列
</th>
<td>
<p>出力行列の行数を指定します。  
</p>
</td></tr>
<tr>
<th> 行
</th>
<td>
<p>出力行列の行数を指定します。
</p>
</td></tr>
<tr>
<th> 二次補間局所因子
<p>(q)
</p>
</th>
<td>
<p>これは、<b>グリッディング手法とそのパラメーター</b>で、<b>ランダム(Shepard)</b>が選択されている場合のみ利用できます。
</p><p><a href="../../UserGuide/UserGuide/Gridding_Methods_for_Randomly_Spaced_Data.html#Shepard" title="ユーザガイド:ランダム配置データのグリッディング法">Shepard</a>グリッディングメソッドを使用する場合、各ノードの局所的な近似二次フィット関数の影響半径を計算するために、二次補間局所因子（q）を使用します。  
</p><p>デフォルトでは <b> <i>q</i> = 18 </b>です。  最良の結果を得るためには、<b><i>q</i> </b>が<b>2<i>w</i></b>にほぼ等しく、 <i><b>w</b></i>は<b>0</b>より大きい必要があります。これらの係数を変更すると、グリッディングの精度が向上する可能性がありますが、大きな値（つまり、局所性を低下させる値）の場合、計算に大幅に時間がかかります。
</p>
</td></tr>
<tr>
<th> 重み関数局所因子
<p>(w)
</p>
</th>
<td>
<p>これは、<b>グリッディング手法とそのパラメーター</b>で、<b>ランダム(Shepard)</b>が選択されている場合のみ利用できます。
</p><p>これを使用して、各ノードの均等化半径を計算するために使用される、重み関数局所因子wを指定します。 
</p><p>デフォルトでは、<b> <i>w</i> = 9</b>です。最良の結果を得るためには、<i><b>q</b> </i>が<b>2<i>w</i></b>にほぼ等しく、 <i><b>w</b></i>は<b>0</b>より大きい必要があります。これらの係数を変更すると、グリッディングの精度が向上する可能性がありますが、大きな値（つまり、局所性を低下させる値）の場合、計算に大幅に時間がかかります。
</p>
</td></tr>
<tr>
<th> スムージング
</th>
<td>
<p>これは、<b>グリッディング手法とそのパラメーター</b>で、<a href="../../UserGuide/UserGuide/Gridding_Methods_for_Randomly_Spaced_Data.html#Thin_Plate_Spline_.28TPS.29" title="ユーザガイド:ランダム配置データのグリッディング法">ランダム（Thin Plate Spline）</a>または<a href="../../UserGuide/UserGuide/Gridding_Methods_for_Randomly_Spaced_Data.html#Kriging_Correlation" title="ユーザガイド:ランダム配置データのグリッディング法">ランダム（Kriging相関）</a>が選択されている場合に利用できます。
</p><p>この負でない値は、グリッディング曲面が入力データポイントから離れる範囲を指定します。  スムージング係数がゼロの場合、平滑化は実行されず、補間された曲面は全データポイントを通過します。  正の値のスムージング係数は、曲面をスムージングします。ただし、係数が大きすぎると、元のデータから大きく変わってしまう可能性があります。
</p>
</td></tr>
<tr>
<th> 補外
</th>
<td>
<p>これは、<b>グリッディング手法とそのパラメーター</b>で、<a href="../../UserGuide/UserGuide/Gridding_Methods_for_Randomly_Spaced_Data.html#Thin_Plate_Spline_.28TPS.29" title="ユーザガイド:ランダム配置データのグリッディング法">ランダム(Thin Plate Spline)</a>が選択されている場合のみ利用できます。
</p><p>詳細については<a href="../../UserGuide/UserGuide/Gridding_Methods_for_Randomly_Spaced_Data.html#Thin_Plate_Spline_.28TPS.29" title="ユーザガイド:ランダム配置データのグリッディング法">アルゴリズムの説明</a>を参照して下さい。
</p>
</td></tr>
<tr>
<th> 検索半径
</th>
<td>
<p>これは、<b>グリッディング手法とそのパラメーター</b>で、<a href="../../UserGuide/UserGuide/Gridding_Methods_for_Randomly_Spaced_Data.html#Weighted_Average" title="ユーザガイド:ランダム配置データのグリッディング法">ランダム（加重平均）</a>または<a href="../../UserGuide/UserGuide/Gridding_Methods_for_Randomly_Spaced_Data.html#Kriging_Correlation" title="ユーザガイド:ランダム配置データのグリッディング法">ランダム（Kriging相関）</a>が選択されている場合に利用できます。
</p><p>詳細については<a href="../../UserGuide/UserGuide/Gridding_Methods_for_Randomly_Spaced_Data.html" title="ユーザガイド:ランダム配置データのグリッディング法">アルゴリズムの説明</a>を参照して下さい。
</p>
</td></tr>
<tr>
<th> 最小ポイント
</th>
<td>
<p>これは、<b>グリッディング手法とそのパラメーター</b>で、<a href="../../UserGuide/UserGuide/Gridding_Methods_for_Randomly_Spaced_Data.html#Kriging_Correlation" title="ユーザガイド:ランダム配置データのグリッディング法">ランダム（Kriging相関）</a>が選択されている場合に利用できます。
</p><p>詳細については<a href="../../UserGuide/UserGuide/Gridding_Methods_for_Randomly_Spaced_Data.html#Kriging_Correlation" title="ユーザガイド:ランダム配置データのグリッディング法">アルゴリズムの説明</a>を参照して下さい。
</p>
</td></tr></table>
<h2><a name="Advanced"></a><span class="mw-headline">詳細</span></h2>
<p>グリッディング範囲と行列コーディネートのための詳細オプション
</p>
<table class="dialogcontroltable">
<tr>
<th> 範囲の制限
</th>
<td>
<p>入力データ範囲の境界を指定します。デフォルトでは、すべてのデータポイントが含まれています。不良データポイントどを除外するために、最小と最大のXY座標を編集することで入力データの制限が可能です（<b>Note:</b> プレビューパネルのXY範囲タブで効果を確認できます。） 
</p>
<dl><dd><b>X最小</b> 
<dl><dd>出力行列の最小のX値</dd></dl></dd>
<dd><b>X最大</b>
<dl><dd>出力行列の最大のX値</dd></dl></dd>
<dd><b>Y最小</b> 
<dl><dd>出力行列の最小のY値</dd></dl></dd>
<dd><b>Y最大</b> 
<dl><dd>出力行列の最大のY値</dd></dl></dd></dl>
</td></tr></table>
<h2><a name="No_Extrapolation_outside_Boundary"></a><span class="mw-headline">境界外の外挿なし</span></h2>
<p>このチェックボックスは、<i>X/Y等間隔</i>または<i>Sparse</i>を除く<b>グリッディング手法とそのパラメータ</b>オプションに対して表示されます。このチェックボックスは、デフォルトでチャックが外れています。
</p><p>このチェックボックスをオンにすると、データ境界の外側のグリッドポイント（入力ポイントの三角形分割によって決定される）が欠落値として扱われます。<b>列</b>と<b>行</b>の数を増やすと（<a href="#Gridding_Method_and_Parameters"><b>グリッディング手法とパラメータ</b></a>の下の設定）、最も外側のグリッドポイントが実際のデータ境界に近づきます。
</p>
<dl><dd><a  class="image"><img alt="境界外の外挿なし" src="../images/The_XYZ_Gridding_Dialog_Box/No_Extrapolation_outside_Boundary.png" width="579"  /></a></dd></dl>
<p>このオプションは、<a href="../../UserGuide/UserGuide/Creating_Contour_Graphs.html#Generate_Grid_from_XYZ_Contour_Plot" title="ユーザガイド:等高線図を作成する">XYZ等高線図からグリッドを生成</a>する機能のアルゴリズムを使用します。
</p>
<h2><a name="Preview_Plot_Type"></a><span class="mw-headline">プロットタイプのプレビュー</span></h2>
<p><b>結果のプレビュー</b>タブに表示するプロットタイプを選択します。
</p>
<ul><li> <b>3Dカラーマップ曲面図</b></li></ul>
<ul><li> <b>色付き等高線</b></li></ul>
<ul><li> <b>3Dワイヤーフレーム</b></li></ul>
<h2><a name="Output"></a><span class="mw-headline">出力</span></h2>
<p>グリッディングデータをどのように出力するを指定します。
</p>
<ul><li><b>出力行列</b></li></ul>
<p>選択するとグリッディングデータを行列として出力します。
</p>
<ul><li><b>出力仮想行列</b></li></ul>
<p>選択するとグリッディングデータを仮想行列のワークシートとして出力します。入力データとして複数のZデータを選択した場合、仮想行列への出力はできません。
</p>
<h2><a name="Preview.28Right.29_Panel:"></a><span class="mw-headline">プレビュー(右側)パネル:</span></h2>
<p>このパネルではいくつかのプレビューオプションを利用できます。  
</p>
<table class="dialogcontroltable">
<tr>
<th> XY範囲
</th>
<td>
<p>XY範囲タブのプロットは、XY座標データの2Dビューを提供します。  
</p>
</td></tr>
<tr>
<th> X/Y間隔
</th>
<td>
<p>X軸、Y軸の間隔配分グリッディングの行と列はX間隔とY間隔の値に従うため、これらの一つを編集した場合には、この値も変わります。
</p>
</td></tr>
<tr>
<th> 結果のプレビュー
</th>
<td>
<p>グリッディング結果をプレビューできます。  <b>プレビューのプロットタイプ</b>で選択した形式でプロットが表示されます。大規模データセットの場合は、プレビューグラフの表示に時間がかかるのでご注意ください。
</p>
</td></tr></table>


    