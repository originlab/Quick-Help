<h1 class="firstheading">日付と時刻の扱いについて</h1><p class='urlname' style='display: none'>DateTime-in-Origin</p>
<p><br />
Originは、グレゴリオ暦(いわゆる西暦)に基づいた日付を解釈します。  時間データは<b>時:分:秒</b>の形になります。  Originでは以下の範囲をサポートしています。
</p>
<ul><li>年数を示すために<b><b>4桁</b></b>の数字を入力する場合、以下の範囲で入力します。  
<dl><dd>1/1/0100; 12/31/9999.</dd></dl></li></ul>
<ul><li>年数を示すために<b><b>2桁</b></b>の数字を入力する場合、以下の範囲で入力します。
<dl><dd>0, 44; 20002044.</dd>
<dd>45, 99; 19451999.</dd></dl></li></ul>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Origin.27s_Mathematical_System_for_Date_and_Time"><span class="tocnumber">1</span> <span class="toctext">日付と時間を扱う数値システム</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Origin.27s_Default_System:_Adjusted_Julian_Date"><span class="tocnumber">1.1</span> <span class="toctext">デフォルトシステム：修正ユリウス日</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Alternate_Date-Time_Systems_in_Origin"><span class="tocnumber">1.2</span> <span class="toctext">その他の日付・時間システム</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4"><a href="#Converting_Between_Unix_Timestamp_and_Julian_Date"><span class="toctext"></span><span class="tocnumber">2</span> <span class="toctext">Unixタイムスタンプとユリウス通日との変換</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Set_Date.2FTime_interval_in_Analysis_Tools"><span class="tocnumber">3</span> <span class="toctext">解析機能における日時間隔の設定</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#References"><span class="tocnumber">4</span> <span class="toctext">参考文献</span></a></li>
</ul>
</div>
<h3><a name="Origin.27s_Mathematical_System_for_Date_and_Time"></a><span class="mw-headline">日付と時間を扱う数値システム</span></h3>
<p>日付と時間を処理するOriginの内部システムでは、<a class="external text" href="https://en.wikipedia.org/wiki/Julian_day" target="_blank"><b>ユリウス通日</b></a>を使用して、1月1日を-4712 (January 1, 4713 BCE)、グリニッジ標準12時を&quot;time zero&quot; (t0).としています。しかし、Originは12時間オフセットの表記が異なります。
</p>
<h4><a name="Origin.27s_Default_System:_Adjusted_Julian_Date"></a><span class="mw-headline">デフォルトシステム：修正ユリウス日</span></h4>
<p>Originのデフォルトシステムではt0を1月1日、4713 BCE (1月１日 4713 24:00:00 BCEまたは、1月2日、4713 00:00:00 BCE)となり、通常のユリウスt0の値より12時間遅くなります。  
</p><p>このように、Originのカレンダーで、日付と時間は次のようになります。
</p>
<dl><dd><dl><dd><b>11 June 1998</b>の<b>21:23:01</b> </dd></dl></dd></dl>
<p>日付の値は、
</p>
<dl><dd><dl><dd><b>2450975.890984を持っています。</b></dd></dl></dd></dl>
<p><i>正しい</i> <a class="external text" href="https://en.wikipedia.org/wiki/Julian_day" target="_blank">天文学的な <b>ユリウス通日</b></a> の値を入手するには、Originに表示される値に<b>0.5</b> (0.5日は12時間なので)を加えて<b>2450976.390984</b>となります。
</p><p>タイムゾーンの違いやサマータイムなどは考慮されません。
</p>
<h4><a name="Alternate_Date-Time_Systems_in_Origin"></a><span class="mw-headline">その他の日付・時間システム</span></h4>
<p><b>Origin 2019</b>では、2つの日付・時間のシステムが利用できます。ユリウス通日とt0を2018年1月1日00:00とする『2018システム』（小数秒のより正確な処理を可能にします）です。 
</p><p>このシステムを変更するにはシステム変数<b>@DSP</b>の値を変更します。この値はプロジェクトに保存されるため、<i>代替の日時システムを使用したいプロジェクトごとに</i> 値を設定する必要があるので注意が必要です。 
</p>
<table class="simple">
<tr>
<th> @DSPの値
</th>
<th> カレンダーの日付
</th>
<th colspan="2">内部の数値
</th>
<th> コメント
</th></tr>
<tr>
<td align="center"><b>0</b>
</td>
<td align="center">2018-07-26 13:35:00
</td>
<td style="text-align:right; border-right:none; padding-right:0;"> 2458325
</td>
<td style="text-align:left; border-left: none; padding-left: 0;"> 56597222
</td>
<td> Originのデフォルト設定(ユリウス通日 - 0.5)
</td></tr>
<tr>
<td align="center"><b>1</b>
</td>
<td align="center">2018-07-26 13:35:00
</td>
<td style="text-align:right; border-right:none; padding-right:0;"> 2458326
</td>
<td style="text-align:left; border-left: none; padding-left: 0;"> 06597222
</td>
<td> 実際のユリウス通日
</td></tr>
<tr>
<td align="center"><b>2018</b>
</td>
<td align="center">2018-07-26 13:35:00
</td>
<td style="text-align:right; border-right:none; padding-right:0;"> 206
</td>
<td style="text-align:left; border-left: none; padding-left: 0;"> 565972222222
</td>
<td> t0 = Jan 1 2018 00:00
</td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Dates_and_Times_in_Origin/Tip_icon.png" width="57"  border="0" /></td><td><p>Originの2018システムでは、小数点以下の秒数までのデータを記録することができます。10<sup>-8</sup>秒までを含む計算に対応しています。
</p></td></tr></table>
<p><br />
<i><b>日付・時間システムを経選択するには：</b></i>
</p>
<ol>
<li>Originを起動してメニューから<b><b>ウィンドウ：スクリプトウィンドウ</b></b>(Shift+Alt+3)を選択します。</li>
<li>スクリプトウィンドウで以下のように入力してエンターを押します。</li>
<pre class="lt" style="font-family:monospace;">@DSP<span style="color: #000080;">=</span>value</pre>
</ol>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Dates_and_Times_in_Origin/Tip_icon.png" width="57"  border="0" /></td><td><p>@DSPは3つのオプションをサポートしています。
</p>
<ul><li> 0 = 紀元前4713年1月1日午前0時、Originの長期調整ユリウス日システムの「ゼロ」（実際のユリウス日より12時間遅い）。</li>
<li> 1 =真のユリウス日（ 「ゼロ」は紀元前4713年1月1日、グリニッジ標準時12:00）。</li>
<li> 2018 = 「ゼロ」は2018年1月1日 00:00とする2018日付システム。</li></ul>
<table class="note">
<tr>
<td><b>Note:</b> @DSPが1に設定され、日付データを時間で表示したい場合、<a href="../../UserGuide/UserGuide/The_(Column_Properties)_Properties_Tab.html#Display" title="ユーザガイド: (列プロパティ) プロパティタブ">列プロパティ</a>を次のように設定することをお勧めします。そうでない場合、12時間オフセットされます。
<dl><dd><a  class="image"><img alt="Date time custom display.png" src="../images/Dates_and_Times_in_Origin/Date_time_custom_display.png" width="319"  /></a></dd></dl>
</td></tr></table>
</td></tr></table>
<h3><a name="Converting_Between_Unix_Timestamp_and_Julian_Date"></a><span class="mw-headline">Unixタイムスタンプとユリウス通日との変換</span></h3>
<p>Originのバージョンに応じて、Unixタイムスタンプとユリウス通日を変換する方法がいくつか存在します。
</p>
<ul><li> <b>Origin 2020b</b>以降から、Originの<a class="external text" href="../../LabTalk/Script/LabTalk-Supported_Functions.html#Date_and_Time_Functions"><b>UnixTime( )</b></a>関数を使用して、値をどちらの方向にも変換できます。</li>
<li> 2020ｂよりの前のバージョンでは、<a class="external text" href="../../QuickHelp/QuickHelp/Convert_UNIX_timestamp_Origin_date.html"><i><b>FAQ-936 UnixのタイムスタンプをOriginの日付に変換するにはどうすればよいでしょうか？</b></i></a>を参照ください。</li></ul>
<p><br />
</p>
<h3><a name="Set_Date.2FTime_interval_in_Analysis_Tools"></a><span class="mw-headline">解析機能における日時間隔の設定</span></h3>
<p>一部の統計およびデータ整形機能では、Originはデータ処理に対する日時間隔の設定をサポートしています。データソースが日時の場合、秒、分、時、日、週、月、年を、日時間隔として設定できます。 
</p>
<table class="simple" style="width: 80%">
<tr>
<th style="width: 40%">データ整形ツール
</th>
<th style="width: 40%">統計ツール
</th></tr>
<tr style="vertical-align:top">
<td>
<ul><li> <a class="external text" href="../../XFunction/X-Function/Reducexy.html">データ削減：クラスタX</a></li>
<li> <a class="external text" href="../../XFunction/X-Function/Reduce_ex.html">データ削減：等間隔X</a></li></ul>
</td>
<td>
<ul><li> <a href="../../UserGuide/Category/Frequency_Counts.html" title="カテゴリ：度数表">度数表</a> </li>
<li> <a href="../../UserGuide/Category/2D_Frequency_Count_Binning.html" title="カテゴリ：2D度数カウント/ビン化">2D度数カウント/ビン化</a></li>
<li> <a class="external text" href="https://www.originlab.com/fileExchange/details.aspx?fid=489" target="_blank">1D Binning アプリ</a></li>
<li> <a href="../../UserGuide/UserGuide/Split_Columns.html" title="ユーザガイド：列データの分割">列データの分割</a> </li>
<li> <a href="../../UserGuide/UserGuide/Heat_Map.html" title="ユーザガイド：ヒートマップ">ヒートマップグラフ</a></li></ul>
</td></tr></table>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Dates_and_Times_in_Origin/Tutorial_icon.png" width="57"  border="0" />
	</td>
	<td><p>ここでは例として、<b>列データの分割</b>機能を使用します。日付に基づいて列を <b>2月</b>、<b>3月</b>、<b>4月</b>などに分割します。
</p>
<ol><li> 分割する列をハイライトし、<b>データ整形：列データの分割</b>メニューから、列データの分割ダイアログを開きます。</li>
<li> <b>サブグループ法</b>を<b>参照列による</b>と設定し、日付の列を<b>参照列</b>に指定します。</li>
<li> <b>分割</b>を<b>間隔による</b>と設定し、<b>間隔</b>を<b>1month</b>に指定します。</li>
<li> その月の始めである<b>2015-02-01</b>を<b>開始値</b>として設定します。 </li>
<li> OKをクリックすると、列が1か月ごとに分割されます。</li></ol>
<dl><dd><a  class="image"><img alt="Split Column by Dates.png" src="../images/Dates_and_Times_in_Origin/Split_Column_by_Dates.png" width="850"  /></a></dd></dl>
</td></tr></table>
<h3><a name="References"></a><span class="mw-headline">参考文献</span></h3>
<ul><li> <a href="../../UserGuide/UserGuide/Dates_and_Times_in_the_Worksheet.html" title="ユーザガイド：ワークシート内の日付と時間">ワークシート内の日付と時刻</a></li>
<li> <a class="external text" href="../../LabTalk/LabTalk/Date_and_Time_Format_Specifiers.html">日付と時間のフォーマット指示子</a></li>
<li> <a href="../../UserGuide/UserGuide/The_(Column_Properties)_Properties_Tab.html#Format" title="ユーザガイド: (列プロパティ) プロパティタブ">列プロパティダイアログボックスで日付と時間のフォーマットを指定する</a></li>
<li> <a class="external text" href="https://en.wikipedia.org/wiki/Julian_day" target="_blank">Wikipedia の&quot;ユリウス日」項目 ウィキペディア フリー百科事典</a></li></ul>


    