<h1 class="firstheading">エスケープシーケンス</h1><p class='urlname' style='display: none'>Escape-Sequences</p>
<p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Escape_sequences_and_text_formats"><span class="tocnumber">1</span> <span class="toctext">エスケープシーケンスとテキストのフォーマット</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Available_text_formatting_commands"><span class="tocnumber">2</span> <span class="toctext">利用できるフォーマットコマンドのリスト</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#A_note_on_entering_the_backslash_.22.5C.22_character_in_text_labels"><span class="tocnumber">3</span> <span class="toctext">テキストオブジェクト中のバックスラッシュ（円記号）の入力に関する注意</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Use_of_the_backslash_.22.5C.22_character_in_the_Object_Properties_dialog_box"><span class="tocnumber">4</span> <span class="toctext"> ｢オブジェクトプロパティ｣ダイアログボックスでのバックスラッシュ（円記号）の使用</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#A_note_concerning_escape_sequences_and_graph_Themes"><span class="tocnumber">5</span> <span class="toctext">エスケープシーケンスとグラフテーマに関する考察</span></a></li>
</ul>
</div>
<h2><a name="Escape_sequences_and_text_formats"></a><span class="mw-headline">エスケープシーケンスとテキストの書式</span></h2>
<p>グラフ、ワークシート、レイアウト上のテキストブジェクトに特殊なフォーマットを適用するには、通常はマウスで目的のテキストを選択して、<b>書式</b>または<b>スタイル</b>ツールバーのボタンを使用します。  <a href="../../UserGuide/Category/Creating_Text_Labels.html" title="カテゴリ:テキストラベルを作成する">WYSIWYG方式</a>でテキストオブジェクトを操作する場合、 ツールバーボタンに設定されている<b>非表示のテキストフォーマットコマンド</b>(エスケープシーケンスといいます)を見ることはできません。しかし、これらのエスケープシーケンスを表示するOriginのインターフェースがあり、<b>エスケープシーケンス</b>がどういうものか、どのように動作するのかを知っておくと大変役立ちます。
</p><p>ラベル列からプロットされたテキストだけでなく、<b>テキスト</b>ツール、<b>テキストの追加</b>メニュー、LabTalkの<b>Label</b>コマンド、テキストボックスに入力した接頭語/接尾語などで作成されたすべてのテキストラベルでは、これらの特殊フォーマットコマンドに従って表示されます。  すべてのエスケープシーケンスは、<b>バックスラッシュ（円記号） &quot;\&quot;  </b>で始まり、テキストをどのように変更するかという制御文字を続けて入力します。  変更の加えられるテキストは、次のように制御文字に続く括弧内に入力します：
</p><p><i><b>\制御文字(編集したい文字列)</b></i>
</p><p><a  class="image"><img alt="Escape Sequences 01.png" src="../images/Escape_Sequences/Escape_Sequences_01.png" width="309"  /></a>
</p><p>文字列を書式化するために<b><b>書式</b></b>および<b><b>スタイル</b></b>ツールバーのボタンやリストを使用するとき、Originは自動的にこれらのフォーマットコマンドを付加しています。  これらのフォーマットコマンドは、テキストラベルの中には表示されませんが、その文字列の<b>オブジェクトプロパティ</b>ダイアログボックス(<b>フォーマット：オブジェクトプロパティ</b>）の中には表示されます。  
</p><p>例えば、テキストツールを使って、Controlと入力し、それを選択して「<b>太字</b>」ボタン(「<b>書式</b>」ツールバー)をクリックします。  グラフやワークシート上には単にControlと表示されますが、<b>オブジェクトプロパティ</b>ダイアログボックスを開くと、\b(Control)と、対象文字列が「\b( )」シーケンスで囲まれています。  つまり、「\b( )」フォーマットコマンドがControlという文字列を太字で表示しているのです。  この方法の実用的な重要性としては、テキストラベルをプログラムで作成する場合などWYSIWYGのインプレーステキスト編集を使って文字列を入力できないような状況で、これらのフォーマットコマンドを明示的に使用して文字列の書式を指定できる点にあります。フォーマットコマンドは、<a href="../../UserGuide/UserGuide/Tick_Labels_2.html#Prefix" title="ユーザガイド:目盛ラベル2">接尾語や接頭語のテキストボックス</a>、<b>オブジェクトプロパティ</b>ダイアログボックス、LabTalkの<a class="external text" href="../../LabTalk/LabTalk/Label_(command).html">Label</a>コマンドで使用することができます。  
</p><p>エスケープシーケンスには<b>LabTalk</b>で解釈できるものもありますし、標準の<b>C言語</b>のものもあります。
</p>
<h2><a name="Available_text_formatting_commands"></a><span class="mw-headline">利用できるフォーマットコマンドのリスト</span></h2>
<table class="simple">
<tr>
<th style="width: 140px;">構文
</th>
<th>説明
</th>
<th>入力の方法...
</th>
<th>表示結果...
</th></tr>
<tr>
<td>
<p>\(<i>ASCII character code</i>)
</p>
</td>
<td>
<p>指定したASCII記号を表示
</p>
</td>
<td>
<p>\(169)
</p>
</td>
<td>
<p><a  class="image"><img alt="Available Text Formatting Commands 12.png" src="../images/Escape_Sequences/Available_Text_Formatting_Commands_12.png" width="25"  /></a>
</p>
</td></tr>
<tr>
<td>
<p>\-(<i>text</i>)
</p>
</td>
<td>
<p><i>text</i>を下付きとして設定
</p>
</td>
<td>
<p>sub\-(script)
</p>
</td>
<td>
<p><a  class="image"><img alt="Available Text Formatting Commands 3.png" src="../images/Escape_Sequences/Available_Text_Formatting_Commands_3.png" width="96"  /></a> 
</p>
</td></tr>
<tr>
<td>
<p>\+(<i>text</i>)
</p>
</td>
<td>
<p><i>text</i>を上付きとして設定
</p>
</td>
<td>
<p>super\+(script)
</p>
</td>
<td>
<p><a  class="image"><img alt="Available Text Formatting Commands 2.png" src="../images/Escape_Sequences/Available_Text_Formatting_Commands_2.png" width="124"  /></a>
</p>
</td></tr>
<tr>
<td>
<p>\=(<i>text1,text2</i>)
</p>
</td>
<td>
<p>上下両付き表記<i>text1</i>を下付きとして設定、<i>text2</i>を上付きとして設定
</p>
</td>
<td>
<p>script\=(sub,super)
</p>
</td>
<td>
<p><a  class="image"><img alt="Available Text Formatting Commands 4.png" src="../images/Escape_Sequences/Available_Text_Formatting_Commands_4.png" width="132"  /></a>
</p>
</td></tr>
<tr>
<td>
<p>\=(<i>text1</i>\v(,)<i>text2,text3</i>)
</p>
</td>
<td>
<p>上下両付き表記<i>text1</i> と <i>text2</i> を下付き (コンマで区切る)、<i>text3</i> を上付きとして設定します。
</p>
</td>
<td>
<p>script\=(sub1\v(,)sub2,super)
</p>
</td>
<td>
<p><a  class="image"><img alt="Available Text Formatting Commands 19.png" src="../images/Escape_Sequences/Available_Text_Formatting_Commands_19.png" width="183"  /></a>
</p>
</td></tr>
<tr>
<td>
<p>\ab(<i>text</i>)
</p>
</td>
<td>
<p><i>text</i>の上にバーを表示
</p>
</td>
<td>
<p>\ab(X)
</p>
</td>
<td>
<p><a  class="image"><img alt="Available Text Formatting Commands 9.png" src="../images/Escape_Sequences/Available_Text_Formatting_Commands_9.png" width="23"  /></a> 
</p>
</td></tr>
<tr>
<td>
<p>\ad(<i>text</i>)
</p>
</td>
<td>
<p><i>text</i>の上に一点鎖線を表示 
</p>
</td>
<td>
<p>\ad(A)
</p>
</td>
<td>
<p><a  class="image"><img alt="Available Text Formatting Commands 10.png" src="../images/Escape_Sequences/Available_Text_Formatting_Commands_10.png" width="26"  /></a>
</p>
</td></tr>
<tr>
<td>
<p>\at(<i>text</i>)
</p>
</td>
<td>
<p><i>text</i>の上にティルデを表示 
</p>
</td>
<td>
<p>\at(A)
</p>
</td>
<td>
<p><a  class="image"><img alt="Available Text Formatting Commands 11.png" src="../images/Escape_Sequences/Available_Text_Formatting_Commands_11.png" width="27"  /></a>
</p>
</td></tr>
<tr>
<td>
<p>\b(<i>text</i>)
</p>
</td>
<td>
<p><i>text</i>を太字に設定
</p>
</td>
<td>
<p>\b(bold)
</p>
</td>
<td>
<p><a  class="image"><img alt="Available Text Formatting Commands 7.png" src="../images/Escape_Sequences/Available_Text_Formatting_Commands_7.png" width="57"  /></a>
</p>
</td></tr>
<tr>
<td>
<p>\<i>cnumber(text)</i>
</p>
</td>
<td>
<p>ORIGIN.INIファイルの色リストの<i>number</i>で示される色で<i>text</i>を表示
</p>
</td>
<td>
<p>\c2(red)
</p>
</td>
<td>
<p><a  class="image"><img alt="Available Text Formatting Commands 14.png" src="../images/Escape_Sequences/Available_Text_Formatting_Commands_14.png" width="46"  /></a>
</p>
</td></tr>
<tr>
<td>
<p>\f:<i>fontname(text)</i>
</p>
</td>
<td>
<p><i>text</i>を<i>fontname</i>のフォントを使用して表示  (<i>フォント名</i>は同定可能な範囲で略記可) 
</p>
</td>
<td>
<p>\f:Wide Latin(font)
</p>
</td>
<td>
<p><a  class="image"><img alt="Available Text Formatting Commands 13.png" src="../images/Escape_Sequences/Available_Text_Formatting_Commands_13.png" width="100"  /></a> 
</p>
</td></tr>
<tr>
<td>
<p>\g(<i>text</i>)
</p>
</td>
<td>
<p><i>text</i>をギリシャ文字に設定
</p>
</td>
<td>
<p>\g(Greek)
</p>
</td>
<td>
<p><a  class="image"><img alt="Available Text Formatting Commands 8.png" src="../images/Escape_Sequences/Available_Text_Formatting_Commands_8.png" width="65"  /></a> 
</p>
</td></tr>
<tr>
<td>
<p>\<i>h(text)</i>
</p>
</td>
<td>
<p>ブロック置換表記
</p>
</td>
<td>
<p>\h(\l(1)&nbsp;%(?Y))
</p>
</td>
<td>
<p>\l(1)&nbsp;%(?Y)
</p>
</td></tr>
<tr>
<td>
<p>\i(<i>text</i>)
</p>
</td>
<td>
<p><i>text</i>を斜体に設定
</p>
</td>
<td>
<p>\i(italics)
</p>
</td>
<td>
<p><a  class="image"><img alt="Available Text Formatting Commands 6.png" src="../images/Escape_Sequences/Available_Text_Formatting_Commands_6.png" width="50"  /></a> 
</p>
</td></tr>
<tr>
<td>
<p>\p%<i>pointsize(text)</i>
</p>
</td>
<td>
<p><i>text</i>の大きさを%倍に変更。  200は2倍、100は大きさの変更なし等
</p>
</td>
<td>
<p>change\p200(point)size
</p>
</td>
<td>
<p><a  class="image"><img alt="Available Text Formatting Commands 5.png" src="../images/Escape_Sequences/Available_Text_Formatting_Commands_5.png" width="174"  /></a> 
</p>
</td></tr>
<tr>
<td>
<p>\<i>q(text)</i>
</p>
</td>
<td>
<p><a href="../../UserGuide/Category/Inserting_Graphs_Images_and_Other_Objects_into_Worksheet_Cells.html" title="カテゴリ：ワークシートセルにグラフ、画像、他のオブジェクトを挿入する">LaTeX数式を挿入</a>するときに、<i>テキスト</i> (LaTeXマークアップ) をLaTeXオブジェクトとしてレンダリングします (Origin 2023以前のバージョンでは、<a class="external text" href="http://www.originlab.com/fileExchange/details.aspx?fid=221" target="_blank">2017 LaTeX アプリ</a>を使用)。
</p>
</td>
<td>
<p>\q(\varphi_{\mu, \sigma^{2}}(X))
</p>
</td>
<td>
<p><a  class="image"><img alt="Available Text Formatting Commands 16.png" src="../images/Escape_Sequences/Available_Text_Formatting_Commands_16.png" width="106"  /></a>
</p>
</td></tr>
<tr>
<td>
<p>\<i>s(literal text)</i>
</p>
</td>
<td>
<p>テキストに取り消し線（水平線）を引く
</p>
</td>
<td>
<p>\s(abc)
</p>
</td>
<td>
<p><a  class="image"><img alt="Strick text.png" src="../images/Escape_Sequences/Strick_text.png" width="45"  /></a> 
</p>
</td></tr>
<tr>
<td>
<p>\<i>sc(text)</i>
</p>
</td>
<td>
<p>連続するスペースが複数ある場合でも、1つの条件付き水平スペースを文字列に挿入します。これは、いくつかのラベルが存在せず、いくつかのスペース(&gt;1)がある場合に使用されます。\scは1つのスペースしか作成しません。
</p>
</td>
<td>
<p>\b(%(1Y,@LL)\sc%(1Y,@LD3)\sc%(1Y,@LD4)\sc(%(1Y,@LU)))
</p>
</td>
<td>
<p>LName Unit
</p>
</td></tr>
<tr>
<td>
<p>\sep:<i>nn</i>
</p>
</td>
<td>
<p>複数行のテキス ラベル (グラフの凡例を含む) では、前の行と次の行の間に <i>nn</i> の量で余分な区切りを追加します。ここで、<i>nn</i> はフォントの高さのパーセントです。
</p>
</td>
<td>
<p>\l(1)&nbsp;%(1)<br />
\sep:50<br />
\l(2)&nbsp;%(2)<br />
\l(3)&nbsp;%(3)<br />
</p>
</td>
<td align="center"><a  class="image"><img alt="OH escape line sep increase.png" src="../images/Escape_Sequences/OH_escape_line_sep_increase.png" width="179"  /></a>
</td></tr>
<tr>
<td>
<p>\u(<i>text</i>)
</p>
</td>
<td>
<p><i>text</i>に下線を設定
</p>
</td>
<td>
<p>\u(underline)
</p>
</td>
<td>
<p><a  class="image"><img alt="Available Text Formatting Commands 15.png" src="../images/Escape_Sequences/Available_Text_Formatting_Commands_15.png" width="91"  /></a>
</p>
</td></tr>
<tr>
<td>
<p>\v(<i>text</i>)
</p>
</td>
<td>
<p><i>text</i>をリテラルテキストとして扱います。 
</p><p>これは、バックスラッシュ(円記号)「\」を含むパスを表示する場合に役立ちます。 
</p>
</td>
<td>
<p>\v
(C:\Samples\Programming)
</p>
</td>
<td>
<p><a  class="image"><img alt="Available Text Formatting Commands 1.png" src="../images/Escape_Sequences/Available_Text_Formatting_Commands_1.png" width="214"  /></a>
</p>
</td></tr>
<tr>
<td>
<p>\<i>ww(literal text)</i>
</p>
</td>
<td>
<p>凡例オブジェクトの<b>プロパティ</b>ダイアログに入力されたリテラルテキストを折り返し、凡例のテキスト部分に割り当てられた「ボックス」内で左揃えにします。<br />
</p>
</td>
<td>
<p>\ww(Very Large-sized Cities: population between 5 and 10 million)
</p>
</td>
<td align="center"><a  class="image"><img alt="Legend Wrap Escape Sequence.png" src="../images/Escape_Sequences/Legend_Wrap_Escape_Sequence.png" width="191"  /></a>
</td></tr>
<tr>
<td>
<p>\<i>x(unicode number)</i>
</p>
</td>
<td>
<p>Unicode文字を表示します。<br />
</p>
</td>
<td>
<p>\x(03b8)
</p>
</td>
<td>
<p><a  class="image"><img alt="Available Text Formatting Commands 18.png" src="../images/Escape_Sequences/Available_Text_Formatting_Commands_18.png" width="27"  /></a>
</p>
</td></tr>
<tr>
<td>
<p>\y(&apos;) <br /> \y(&quot;)
</p>
</td>
<td>
<p>プライムあるいはダブルプライムを表示。プライムとダブルプライムの組み合わせを表示するためには、\+(\y(&apos;)) or \+(\y(&quot;))のように上付き文字の表現を使用します。
</p>
</td>
<td>
<p>\g(c)\=(3,\y(&apos;))
</p>
</td>
<td>
<p><a  class="image"><img alt="Available Text Formatting Commands 12b.png" src="../images/Escape_Sequences/Available_Text_Formatting_Commands_12b.png" width="60"  /></a>
</p>
</td></tr></table>
<h2><a name="A_note_on_entering_the_backslash_.22.5C.22_character_in_text_labels"></a><span class="mw-headline">テキストオブジェクト中のバックスラッシュ（円記号）の入力に関する注意</span></h2>
<p><a href="../../UserGuide/Category/Creating_Text_Labels.html" title="カテゴリ:テキストラベルを作成する">通常のWYSIWYG方式</a>でテキストラベルを編集するとき、バックスラッシュ（円記号）を直接入力することができます。  インプレースでは、エスケープシーケンスをサポートしていないので、エスケープシーケンスとしては解釈されません。  
</p><p>そのため、例えば次のように入力すると...
</p>
<dl><dd><b>This file is located at C:\MY FILES</b></dd></dl>
<p>そのまま入力したように表示されます。  
</p><p>Originは、2番目のバックスラッシュをテキスト文字列に自動的に挿入することでWYSIWYGによるバックスラッシュを挿入することができます。  WYSIWYGモードの場合、1つのバックスラッシュしか表示されません。  しかし、オブジェクトの<b>プロパティ</b>ダイアログボックスを開くと、2つのバックスラッシュが表示されているのがわかります(下図参照)。(以下に説明するようにテキストラベルが壊れてしまうので、このダイアログボックスで2番目のバックスラッシュを消去しないで下さい。)   
</p>
<dl><dd><a  class="image"><img alt="Escape Sequences 2.png" src="../images/Escape_Sequences/Escape_Sequences_2.png" width="587"  /></a></dd></dl>
<h2><a name="Use_of_the_backslash_.22.5C.22_character_in_the_Object_Properties_dialog_box"></a><span class="mw-headline">｢オブジェクトプロパティ｣ダイアログボックスでのバックスラッシュ（円記号）の使用</span></h2>
<p>バックスラッシュ（円記号） (&quot;\&quot;) を「<b>オブジェクトプロパティ</b>」ダイアログボックス に直接入力するとエスケープシーケンスだと解釈されます。
</p><p>例えば、｢オブジェクトプロパティ｣ダイアログボックスに下の文を入力すると：
</p>
<dl><dd><b>This file is located at C:\MY FILES</b></dd></dl>
<p>次のように表示されます。
</p>
<dl><dd><b>This file is located at C:MY FILES</b></dd></dl>
<p>バックスラッシュが表示されていません。  定義されていないオプションや括弧がバックスラッシュの後に続かない場合、バックスラッシュは無視されて表示されません。  そのため、<b>オブジェクトプロパティ</b>ダイアログボックスに直接テキストを入力したり、編集する際に、バックスラッシュを表示する必要があれば、次のいずれかを行う必要があります：
</p>
<ul><li>文字列にバックスラッシュを2つ(<b>\\</b> )入力します。(例えば、 &quot;This file is located at C:\\MY FILES&quot;)</li>
<li>フォーマットコマンドの<b>\v( )</b>を使用します。 (例えば、&quot;This file is located at \v(C:\MY FILES)&quot;)</li>
<li> オブジェクトプロパティの<b>テキスト</b>タブの<b>逐次解釈</b>ボックスにチェックを付けます。</li></ul>
<dl><dd><a  class="image"><img alt="Escape Sequences 025B.png" src="../images/Escape_Sequences/Escape_Sequences_025B.png" width="643"  /></a></dd></dl>
<p><br />
<i><b>LabTalkを使用して...</b></i>
</p>
<ol><li><b>オブジェクトプロパティ</b>ダイアログボックスに文字通りにテキストを入力し(2つ&quot;\\&quot;ではなく、1つのバックスラッシュ&quot;\&quot;のみを入力、下図参照)、<b>OK</b>をクリックします。
<dl><dd><a  class="image"><img alt="Escape Sequences 03.png" src="../images/Escape_Sequences/Escape_Sequences_03.png" width="590"  /></a></dd></dl></li>
<li><a href="../../UserGuide/Category/The_Origin_Command_Window.html" title="カテゴリー: Originコマンドウィンドウ">コマンドウィンドウ</a>を開き、コマンドラインに次のように入力します。</li></ol>
<dl><dd><i>ObjectName</i>.verbatim=1   &lt;ENTER&gt;</dd>
<dd>ここで<i>ObjectName</i> は<b>テキストのオブジェクト名</b>です。(これはプロパティの「<b>プログラミング</b>」タブに表示されます。)</dd></dl>
<p>バックスラッシュがテキストラベルの中に適切に表示されます。  
</p>
<table class="note">
<tr>
<td>
<p><b>Note:</b><i>ObjectName</i>.verbatimメソッドは、WYSIWYGによるインプレーステキスト編集と似たような操作(文字列変数を使ってファイルパスの情報を挿入する)で実行する場合に役立ちます。  WYSIWYG方式ではバックスラッシュ(\)を直接入力することができますが、それが文字列の一部の場合適切に扱われません(例えばファイルパス)。
</p><p>WYSIWYG方式で作成したテキストオブジェクトでこれがどのように扱われるかについては、<a href="../../UserGuide/UserGuide/Linking_Text_Labels_to_Data_and_Variables.html#Substituting_Variable_Values_in_Text_Labels" title="ユーザガイド:テキストラベルを、データと変数にリンク">テキストラベルの置換変数値</a>.を参照してください。
</p>
</td></tr></table>
<h2><a name="A_note_concerning_escape_sequences_and_graph_Themes"></a><span class="mw-headline">エスケープシーケンスとグラフテーマに関する考察</span></h2>
<p>グラフ<b>テーマ</b>は、あるテキストオブジェクトの表示属性をコピーして、別のテキストオブジェクトに貼り付けることができます。  しかし、コピーと貼り付けができない表示属性もいくつかあります。  テキストオブジェクトのプロパティがエスケープシーケンスを挿入して作成された場合、<i>それは別のテキストオブジェクトに適用できません</i>。
</p><p>どのテキストフォーマットが別のテキストオブジェクトに貼り付けることができないかを知るには、まず、テキストオブジェクトを作成し、クリックしてそれを選択します。  ここで、<b>書式</b> および<b>スタイル</b>ツールバーのボタン--太字、斜体、下線など--が利用できない(ボタンがグレーアウトしている)ことが分かります。一方他のボタン（ギリシャ文字、フォントを大きく/小さく、フォントの色など）は<i>利用できます</i>。
</p><p><a  class="image"><img alt="Escape Sequences 04.png" src="../images/Escape_Sequences/Escape_Sequences_04.png" width="467"  /></a>
</p><p>テキストオブジェクトが選択されたときに利用できないボタンやドロップダウンリストがあるのは、フォーマットオプションを指定する際にエスケープシーケンスを使用しており、他のテキストオブジェクトにフォーマットをコピーして貼り付けることができないためです。
</p>



    