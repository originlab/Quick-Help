<h1 class="firstheading">ワークシート列の数値データの表示を制御する</h1><p class='urlname' style='display: none'>Wks-Col</p>
<p>列に名前を付けたり、 <a href="../../UserGuide/UserGuide/Set_Column_Designation.html" title="ユーザガイド：列の属性の設定"><b>列のXY属性</b></a>を設定することに加え、列データの<b>表示フォーマット</b>(文字と数値など)や<b>データ型</b>(例えば、数値データを&quot;double&quot;や&quot;real&quot;など)を指定することができます。  デフォルトで列の<b>表示フォーマット</b>は<b>文字と数値</b>を取り扱うように設定されていますが、システムリソースの制限などがある場合、<b>数値</b>のみに制限することができます。さらに<b>数値型</b>の<b>データ型</b>を指定することにより、数値データに割り当てられるメモリの大きさをさらに小さくすることができます(<a href="#Format_and_Numeric_Display">下記注意参照</a>)。
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Numeric_vs._Text_.26_Numeric"><span class="tocnumber">1</span> <span class="toctext">数値 vs 文字と数値</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Numeric_Data_Types_and_memory_allocation"><span class="tocnumber">2</span> <span class="toctext">数値データ型とメモリの割り当て</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Format_and_Numeric_Display"><span class="tocnumber">3</span> <span class="toctext">列のデータ型と桁表示</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#A_Note_about_Displayed_vs._Actual_Values"><span class="tocnumber">4</span> <span class="toctext">表示値と実際値に関する注意</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Decimal.2C_Scientific_and_Engineering_Notation"><span class="tocnumber">5</span> <span class="toctext">10進数、指数、工学表記</span></a></li>
</ul>
</div>

<h2><a name="Numeric_vs._Text_.26_Numeric"></a><span class="mw-headline">数値 vs 文字と数値</span></h2>
<p>数値型のデータ列を使った場合のメリットとして、メモリの節約があります。数値型データは<b>倍精度実数(8)</b>の形式をしていますが、<b>文字と数値型</b>では、それより約20%余分のメモリが使われます。一般に、この余分なメモリ使用が問題となることは少ないでしょう。システムリソースを最大化することを心配する場合は、新しいワークシートのすべての列に<b>倍精度実数(8)</b>を使用するようにOriginを設定できます。
</p>
<ol><li>メニューから<b>環境設定：オプション</b>を選びます。</li>
<li><b>その他のオプション</b>タブをクリックします。</li>
<li>『<b>列データ型として数値型を基本とする</b>』を選択します。</li></ol>
<p>さらに、数値データの列に<a class="external text" href="../../LabTalk/LabTalk/Origin_Formats.html">カスタムフォーマット</a>を適用する場合は、列の<b>フォーマット</b>を<b>文字と数値</b>から <b>数値</b>変更する必要があります。<b>文字と数値</b>は<i>通常</i>Originのカスタム表示フォーマットをサポートしますが、何か問題が起きた際にフォーマットを<b>数値</b>に設定することで解消することがあります。
</p>
<h2><a name="Numeric_Data_Types_and_memory_allocation"></a><span class="mw-headline">数値データ型とメモリの割り当て</span></h2>
<p>数値データで操作するとき、<b>列プロパティ</b>ダイアログボックスの「<b>内部データ表現</b>」ドロップダウンリストを変更することで、各データ値に割り当てられるメモリの大きさを調整することができます。  例えば、メモリをもっと節約したければ(例えば50%節約)、<b>表示フォーマット＝<b>数値</b></b>にして、<b>内部データ表現</b>ドロップダウンリストから<b>Real(4)</b>を選択します(下記注意を参照して下さい)。
</p><p><b>列プロパティ</b>ダイアログボックスを開くには
</p>
<ol><li>列ヘッダをダブルクリックします。</li></ol>
<p><i>または、</i>
</p>
<ol><li>選択した列を右クリックして、<b><b>列フォーマット</b></b>を選択します。</li></ol>
<p><i>または、</i>
</p>
<ol><li>列を選択して、メニューから<b>フォーマット: 列フォーマット</b>と操作します。
<dl><dd><i>そして、</i></dd></dl></li>
<li><b><b>列プロパティ</b></b>ダイアログボックスで、<b>表示フォーマット</b>から<b>数値</b>を選びます。</li>
<li><b><b>データ型</b></b>ドロップダウンリストから選択します。</li></ol>
<table class="simple" width="50%">
<tr>
<th>ワークブック
</th>
<th>バイト
</th>
<th>値の範囲
</th></tr>
<tr>
<td>
<p>double
</p>
</td>
<td>
<p>8
</p>
</td>
<td>
<p>±1.7E±308 (15ケタ)
</p>
</td></tr>
<tr>
<td>
<p>real
</p>
</td>
<td>
<p>4
</p>
</td>
<td>
<p>±3.4E±38 (7ケタ)
</p>
</td></tr>
<tr>
<td>
<p>short
</p>
</td>
<td>
<p>2
</p>
</td>
<td>
<p>32,768から32,767
</p>
</td></tr>
<tr>
<td>
<p>long
</p>
</td>
<td>
<p>4
</p>
</td>
<td>
<p>2,147,483,648から2,147,483,647
</p>
</td></tr>
<tr>
<td>
<p>char
</p>
</td>
<td>
<p>1
</p>
</td>
<td>
<p>-128から127
</p>
</td></tr>
<tr>
<td>
<p>byte
</p>
</td>
<td>
<p>1
</p>
</td>
<td>
<p>0から255
</p>
</td></tr>
<tr>
<td>
<p>ushort
</p>
</td>
<td>
<p>2
</p>
</td>
<td>
<p>0から65,535
</p>
</td></tr>
<tr>
<td>
<p>ulong
</p>
</td>
<td>
<p>4
</p>
</td>
<td>
<p>0から4,294,967,295
</p>
</td></tr>
<tr>
<td>
<p>complex
</p>
</td>
<td>
<p>16
</p>
</td>
<td>
<p>±1.7E±308 (15桁)、それぞれ8バイト
</p>
</td></tr></table>
<table class="note">
<tr>
<td>
<p><b><b>注意:</b></b><b>データ型</b>の値が<b>Double(8)</b>より小さいとさまざまな計算を実行する際に問題が発生する場合があります。同様の理由から、<b>内部データ</b>表現の指定は実際のデータが入力される前に設定されていなければなりません。<b>データ型</b>が適切ではなかった場合、データの精度が失われるなどの問題が生じる可能性があります。 
</p>
</td></tr></table>
<h2><a name="Format_and_Numeric_Display"></a><span class="mw-headline">列のデータ型と桁表示</span></h2>
<p>(「ワークシート列フォーマット」ダイアログボックスで)ワークシート列の<b>データ型</b>が、<b>数値</b>または<b>文字と数値</b>に設定されているとき、桁数表示は、「<b>列プロパティ</b>」ダイアログボックスのこれらの組み合わせで決まります。
</p>
<ul><li><b>表示フォーマット</b>十進数、指数、工学、あるいは<a class="external text" href="../../LabTalk/LabTalk/Origin_Formats.html">カスタム</a>からフォーマットを選択します。</li>
<li><b>桁数指定法</b>列（データセット）で表示する小数点以下の桁数または有効桁数です。 </li></ul>
<p>指定していない場合(例えば、数値の桁表示に<b>デフォルト桁数</b>を設定)、Originは<b>オプション</b>ダイアログボックスの<b><b>数値の表現形式</b></b>タブにある<b><b>小数点以下の桁数</b></b>の設定を使います。
</p><p><b><b>列プロパティ</b></b>ダイアログボックスでの<b>数値の桁表示</b>の設定は、<b>オプション</b>ダイアログボックスのグローバルな設定に優先して使用されます。
</p><p><br />
<span class='headerInParagraph'>デフォルトの桁数を設定するには(次の手順での説明を除く、グローバルな設定)</span>
</p>
<ol><li>メニューから、<b>環境設定：オプション</b>を選びます。</li>
<li><b>数値の表現形式</b>タブをクリックします。</li>
<li><b>桁数</b>を設定します。</li></ol>
<p><br />
<span class='headerInParagraph'>ワークシート内の1つまたは複数のデータセットに対して、有効桁数または小数点以下の桁数を設定するには</span>
</p>
<ol><li>アクティブなワークシートで、メニューの<b>フォーマット：列フォーマット</b>を選ぶか、列のヘッダ部分をダブルクリックします。これで<b><b>列プロパティ</b></b>ダイアログボックスを開きます。</li>
<li><b>桁数指定法</b>を<b>デフォルト桁数</b>から<b>小数桁数＝</b>または<b>有効桁数＝</b>に変え、「桁数」テキストボックスに数値を入力します。(最大の小数桁数は12桁、最大の有効桁数は15桁です。)</li>
<li>任意で、<b>右側全列に上記設定を適用</b>チェックボックスを選択します。</li></ol>
<h2><a name="A_Note_about_Displayed_vs._Actual_Values"></a><span class="mw-headline">表示値と実際値に関する注意</span></h2>
<p>ワークシートにデータをインポートしたり入力したりするとき、Originは、桁数/小数桁数の設定を使用して各セルにデータを表示します。これは単にデータセットを視覚的に表現したものです。実際のデータ値は保存され、計算を実行するときに使用されるのは実際のデータ値であり、<b>データ型</b>の制限と<a href="#Numeric_Data_Types_and_memory_allocation">割り当てられたメモリの量</a>と一致します。セルに表示される値では<i>ありません</i>。
</p>
<h2><a name="Decimal.2C_Scientific_and_Engineering_Notation"></a><span class="mw-headline">10進数、指数、工学表記</span></h2>
<p>Originは、<b>十進数:1000</b>, <b>指数:1E3</b>, <b>工学:1k</b>, <b>10進数:1,000</b> の形式でワークシートデータを表示します。<b>十進数:1000, 工学:1k, 十進数:1,000</b><b>では</b>、Originは「<b>オプション</b>」ダイアログボックスの「<b>数値の表現形式</b>」タブにある『<b>ベキ乗表現の上限しきい値</b>』および『<b>ベキ乗表現の下限しきい値</b>』を設定するオプションを使用します。  
</p><p>デフォルトでは、『<b>ベキ乗表現の上限しきい値</b>』および『<b>ベキ乗表現の下限しきい値</b>』は、それぞれ <b>6</b> および <b>-3</b>に設定されています。データが、1x10<sup>-3</sup> から &nbsp;1x10<sup>6</sup>の範囲にある場合、データは<b><b>列プロパティ</b></b>ダイアログの<b>表示フォーマット</b>ドロップダウンリスト(「<b>オプション</b>」グループ)の設定に従って表示されます。データが、下限値または上限値を超えた(つまり、1x10<sup>-3</sup>より小さいまたは1x10<sup>6</sup>より大きい)場合、データは<b>表示</b>の設定を無視して、<b>指数表記</b>になります。
</p><p><br />
<span class='headerInParagraph'>べき乗表現のデフォルトを変更するには</span>
</p>
<ol><li>「<b>環境設定：オプション</b>」を選択します。</li>
<li><b>数値の表現形式</b>タブをクリックします。</li>
<li>『<b>科学的表記への変換契機</b>』グループにある『<b>ベキ乗表現の上限しきい値</b>』および『<b>ベキ乗表現の下限しきい値</b>』を設定します。</li></ol>







    