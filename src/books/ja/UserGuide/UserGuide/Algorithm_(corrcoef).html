<h1 class="firstheading">アルゴリズム (相関係数)</h1>
<p><br />
異なる環境下で使用するのに適した係数が数多くあります。その中で、最も頻繁に使われるのは、ピアソンの積率相関係数です。</p>
<p><i style="font-style: italic;"><b style="font-weight: bold;">ピアソンの積率相関係数</b></i></p>
<p>ピアソンの積率相関係数は、2つの変数間の線形の関係を測定するものです。</p>
<p><span class="Apple-converted-space">&#160;</span><img src="../images/Algorithm_(corrcoef)/math-ea2fb250ea955e9548d7d78941d80ec0.png" title="\sigma _x\," alt="\sigma _x\," class="tex" style="color: #000000; font-family: Arial, sans-serif; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 19.2px; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;" border="0" /> &#160;および<span class="Apple-converted-space">&#160;</span><img src="../images/Algorithm_(corrcoef)/math-5b7011069d54d7494a581c5a39afc3a0.png" title="\sigma _y\," alt="\sigma _y\," class="tex" style="color: #000000; font-family: Arial, sans-serif; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 19.2px; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;" border="0" /> &#160;をそれぞれ2つの変数 X および Y の標準偏差とします。そのとき、変数間のピアソンの積率相関係数は、次式で求められます。</p>
<p><img src="../images/Algorithm_(corrcoef)/math-28e6ed2438f8ba9a554b7c2c5bfdcbbb.png" title="\rho _{x,y}=\frac{cov(X,Y)}{\sigma _x\sigma _y}=\frac{E((X-E(X))(Y-E(Y)))}{\sigma _x\sigma _y}" alt="\rho _{x,y}=\frac{cov(X,Y)}{\sigma _x\sigma _y}=\frac{E((X-E(X))(Y-E(Y)))}{\sigma _x\sigma _y}" class="tex" style="color: #000000; font-family: Arial, sans-serif; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 19.2px; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;" border="0" /></p>
<p><i style="font-style: italic;">ここで</i> E(?) は変量の期待値、cov(?) は共分散を表しています。</p>
<p>この方法を使うには、区間データは観測データから求められ、変数は正規分布に従うものとします。結果に影響を及ぼすことが多いので、データには極値は含まれません。ピアソンの積率相関係数は、変数に非線形の関係がある場合、誤解を招くような小さい値になることがあります。</p>
<p><i style="font-style: italic;"><b style="font-weight: bold;">スピアマンの順位相関係数</b></i></p>
<p>スピアマンの順位相関係数はノンパラメトリックであるため、正規分布に従わないデータに適しています。2変数間に非線形の関係が認められる場合に良い結果となります。これは次式のように定義できます。</p>
<p><img src="../images/Algorithm_(corrcoef)/math-30e2b8b2169b7c14da1f976316e7c59c.png" title="r^{\prime }=1-6\sum \frac{d^2}{N(N^2-1)}" alt="r^{\prime }=1-6\sum \frac{d^2}{N(N^2-1)}" class="tex" style="color: #000000; font-family: Arial, sans-serif; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 19.2px; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;" border="0" /></p>
<p>ここで、 <i>d</i> は、対応する変数の統計上の順位の差です。</p>
<p>統計上の順位は、リスト内の値の序数であるため、スピアマンの順位相関係数は、変数の実際の値が不明な場合でも計算することができます。</p>
<p><i style="font-style: italic;"><b style="font-weight: bold;">ケンドールの相関係数</b></i></p>
<p>ケンドールの相関係数または ケンドール のタウは、その前提と統計的な検出力の点ではスピアマンの順位相関と同じです。しかし、ケンドールの相関係数には、直感的に説明できる点があります。そして、その代数構造はより単純です。さらに、計算を実行する前にデータの順序を必要としません。</p>
<p>ケンドール の相関係数は次式で計算されます。</p>
<p><img src="../images/Algorithm_(corrcoef)/math-e77b5d7ffbaeb1048e2202d9f7dcec6c.png" title="t=\frac{C-D}{\sqrt{q}}" alt="t=\frac{C-D}{\sqrt{q}}" class="tex" style="color: #000000; font-family: Arial, sans-serif; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 19.2px; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;" border="0" /></p>
<p>ここでCは、一致する対のデータ (同じ符号を持つ対の観測値)の数で、Dは、 一致しない対のデータ (異なる符号を持つ対の観測値)の数です。</p>
<a name="Significance_Level_of_r" id="Significance_Level_of_r"></a>
<h2><span class="mw-headline">rの有意レベル</span></h2>
<ul>
<li>ピアソンとスピアマンタイプ</li>
</ul>
<p><b style="font-weight: bold;">ピアソン</b>と<b>スピアマン</b>の相関では、次のように定義します。</p>
<dl>
<dd><img src="../images/Algorithm_(corrcoef)/math-24747472afeca9759e13e01893745921.png" title=" t = |r\sqrt{\frac{N-2}{1-r^2}}| " alt=" t = |r\sqrt{\frac{N-2}{1-r^2}}| " class="tex" style="color: #000000; font-family: Arial, sans-serif; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 19.2px; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;" border="0" /></dd>
</dl>
<p>ここで、rは2つの変数の相関で、Nは観測値の数です。</p>
<p>tはN-2の自由度を元にしたt分布に基づきます。両端の有意水準レベルは以下のように計算されます。</p>
<dl>
<dd><img src="../images/Algorithm_(corrcoef)/math-ca08a21786c0a0775c6a839bc73e1a0b.png" title=" p=2(1-\mbox{tcdf} (t,N-2))\; " alt=" p=2(1-\mbox{tcdf} (t,N-2))\; " class="tex" style="color: #000000; font-family: Arial, sans-serif; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 19.2px; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;" border="0" /></dd>
</dl>
<ul>
<li>ケンドールタイプ</li>
</ul>
<p><b style="font-weight: bold;">ケンドール</b>の相関では次のように定義します。</p>
<dl>
<dd><img src="../images/Algorithm_(corrcoef)/math-c939a27ffcf3bc1776bfe8fb5a0eac2c.png" title=" z=\frac{r\sqrt{q}}{\sqrt{v}} " alt=" z=\frac{r\sqrt{q}}{\sqrt{v}} " class="tex" style="color: #000000; font-family: Arial, sans-serif; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 19.2px; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;" border="0" /></dd>
</dl>
<p>ここで</p>
<dl>
<dd><img src="../images/Algorithm_(corrcoef)/math-548bc5538f0ef9eacf0ae3c5be40f69c.png" title="v_0 = N(N-1)(2N+5)\;" alt="v_0 = N(N-1)(2N+5)\;" class="tex" border="0" /></dd>
<dd><img src="../images/Algorithm_(corrcoef)/math-5caaeb544cb4ccce475311401745a3c6.png" title="\tau = \sum_{k} t_k (t_k-1)\;" alt="\tau = \sum_{k} t_k (t_k-1)\;" class="tex" border="0" /></dd>
<dd><img src="../images/Algorithm_(corrcoef)/math-e6c7791706cf93f4232f2c8534736995.png" title="\tau_1 = \sum_{k} t_k (t_k-1)(t_k-2)\;" alt="\tau_1 = \sum_{k} t_k (t_k-1)(t_k-2)\;" class="tex" border="0" /></dd>
<dd><img src="../images/Algorithm_(corrcoef)/math-eb2c6e9601d25f02e8838ef730b5bd67.png" title="\tau_2 = \sum_{k} t_k (t_k-1)(2t_k+5)\;" alt="\tau_2 = \sum_{k} t_k (t_k-1)(2t_k+5)\;" class="tex" border="0" /></dd>
<dd><img src="../images/Algorithm_(corrcoef)/math-c9f02f1e1911eedbf05988df3ce43feb.png" title="t_k \mbox{ is the number of tied values in the kth group of ties for a variable.}\;" alt="t_k \mbox{ is the number of tied values in the kth group of ties for a variable.}\;" class="tex" border="0" /></dd>
<dd><img src="../images/Algorithm_(corrcoef)/math-a407e02e1a2d60aaea82067fef66b721.png" title="q=(N(N-1)/2-\tau(i)/2)(N(N-1)/2-\tau(j)/2)\;" alt="q=(N(N-1)/2-\tau(i)/2)(N(N-1)/2-\tau(j)/2)\;" class="tex" border="0" /></dd>
<dd><img src="../images/Algorithm_(corrcoef)/math-ca7363f711e3049973f2371b26b477d6.png" title="v=(v_0-\tau_2(i)-\tau_2(j))/18 + \tau (i)\tau (j)/(2N(N-1)) + \tau_1 (i)\tau_1 (j)/(9N(N-1)(N-2)) \;" alt="v=(v_0-\tau_2(i)-\tau_2(j))/18 + \tau (i)\tau (j)/(2N(N-1)) + \tau_1 (i)\tau_1 (j)/(9N(N-1)(N-2)) \;" class="tex" border="0" /></dd>
<dd><img src="../images/Algorithm_(corrcoef)/math-046af118cd5a4fed647d9ee0185f654a.png" title="r \mbox{ is the correlation between variable } i \mbox{ and variable } j. \;" alt="r \mbox{ is the correlation between variable } i \mbox{ and variable } j. \;" class="tex" border="0" /></dd>
</dl>
<p>Zは標準正規分布から近似値を求められます。両端の有意水準レベルは次のようになります。</p>
<dl>
<dd><img src="../images/Algorithm_(corrcoef)/math-2edf21ee0d07e7b466bf4ebb5bfec769.png" title=" p=2(1-\mbox{normcdf} (\mbox{abs} (z)))\; " alt=" p=2(1-\mbox{normcdf} (\mbox{abs} (z)))\; " class="tex" border="0" /></dd>
</dl>
<p><br /></p>
