<h1 class="firstheading">Excelからのインポート</h1><p class='urlname' style='display: none'>Excelのインポート</p>
<h2><a name="Importing_Excel_Data_using_the_Import_Excel_Data_Connector_Dialog"></a><span class="mw-headline">Excelデータコネクタのインポートダイアログを使用したExcelデータのインポート</span></h2>
<p><a href="../../UserGuide/Category/Data_Connector.html" title="カテゴリー：データコネクタ"><b>データコネクタ</b></a>はＯriginの新しい一般的なインポートメカニズムです。Origin 2021bの場合、<b>Excelインポート</b>ツールバーボタンは、古い<a href="#Importing_Excel_Data_using_the_impMSExcel_X-Function_Dialog"><b>impMSExcel</b></a>ルーチンの代わりにExcelコネクタを使用するように再コーディングされています。
</p>
<dl><dd><dl><dd><a  class="image"><img alt="Excel import option dlg.png" src="../images/Importing_from_Excel/Excel_import_option_dlg.png" width="390"  /></a></dd></dl></dd></dl>
<ol><li> ワークシートをアクティブにして、<b>データ：ファイルに接続</b>を選択します。または、ワークスペースの上部にあるインポートツールバーの<b>Excelインポート</b>ボタン<a  class="image"><img alt="Button Import Excel.png" src="../images/Importing_from_Excel/Button_Import_Excel.png" width="25"  /></a>をクリックします。</li>
<li> 複数のシートがあるExcelファイルの場合、接続する1つの<b>Excelシート</b>を指定します（接続が行われた後、追加のシートに接続できます）。</li>
<li> デフォルトで、<b>メインヘッダ行</b>の<b>自動</b>のチェックがオンになります。ヘッダ行は、<b>ファイルヘッダ</b>ラベル行に追加されます。</li>
<li> <b>自動</b>のチェックを外して<b>メインヘッダ行</b>の数を入力すると、<b>ファイルヘッダーの保存先</b>ドロップダウンがダイアログに追加されます。これを使用して、<a href="../../UserGuide/UserGuide/Displaying_Supporting_Data_in_Worksheet_header_Rows.html" title="ユーザガイド:ワークシートヘッダ行に表示するサポートデータ"><b>ワークシートラベルエリア</b></a>または<a href="../../UserGuide/UserGuide/The_Workbook_Organizer.html" title="ユーザガイド：ワークブックオーガナイザ"><b>ブックオーガナイザ</b></a>にヘッダ情報を保存するように指定します。</li>
<li> サブヘッダ行が検出されると<b>列ラベル</b>ボックスのチェックが入り、<b>ロングネーム</b>・<b>単位</b>行が自動的に指定されます。<b>コメント開始</b>・<b>コメント終了</b>を含む<b>列ラベル</b>の場所を手動で指定するには、付随するコンボボックスを編集します。</li>
<li> 部分インポートの場合、<b>部分インポート</b>にチェックを付け、ダイアログ内の入力例に従って、あるいは、<a href="../../UserGuide/Category/Partial_Importing_and_Re_Importing.html#Partial_Import_Controls_used_by_Import_From_File" title="カテゴリー: 部分インポートと再インポート">こちらの表</a>にある<b>カスタム</b>構文を参照して、<b>列</b>と<b>行</b>の範囲を入力します。</li>
<li> インポート時に<a class="external text" href="../../QuickHelp/QuickHelp/What_is_a_Sparkline_and_how_do_I_customize_it.html">スパークライン</a>を追加するには、<b>他のオプション</b>ボタン（<b>OK</b>の左）をクリックし、ラジオボタンを選択します。インポート時にスパークラインを無効にするには、<a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#H.2CI.2CJ.2CK"><b>@IMPS</b> = <i>0</i></a>に設定します。</li>
<li> インポート後の処理としてLabTalkスクリプトを実行したい場合は、<b>他のオプション</b>ボタンをクリックして<b>インポート後に実行するLabTalkスクリプト</b>編集ボックスにスクリプトを入力します。</li>
<li> ファイルをインポートしたら、<a href="../../UserGuide/UserGuide/Data_Navigator.html" title="ユーザガイド:データナビゲータ"><b>データナビゲータ</b>パネル</a>を使ってExcelファイルの別のシートに<b>シートの追加と接続</b>が可能です。</li></ol>
<h2><a name="Importing_Excel_Data_using_the_impMSExcel_X-Function_Dialog"></a><span class="mw-headline">XファンクションimpMSExcelのインポートダイアログを使用したExcelデータのインポート</span></h2>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Importing_from_Excel/Alert_icon.png" width="57"  border="0" /></td><td><p><b>Origin 2021b</b>以降、<b>Excelインポート</b>ボタン<a  class="image"><img alt="Button Import Excel.png" src="../images/Importing_from_Excel/Button_Import_Excel.png" width="25"  /></a>をクリックすると、データコネクタの<b>Excelのインポートオプション</b>ダイアログボックスが開きます。以前のように、このボタンで<b>impMSExcel</b>ダイアログボックスを開くには、LabTalkシステム変数を<a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#T"><b>@TIB</b> = <i>2</i></a>に設定します。システム変数の値を変更する方法については、<a class="external text" href="../../QuickHelp/QuickHelp/How_do_I_permanently_change_the_value_of_a_system_variable.html">このFAQ</a>を参照してください。
</p>
	</td>
	</tr>
	</table>
<p><b>Excelファイルをインポートするには</b>
</p>
<ol><li>メニューの<b>データ：ファイルからインポート：Excel (XLS, XLSX, XLSM)...</b>を選択するか、<b>標準</b>ツールバーにある<b>Excelにインポート</b>ボタン<a  class="image"><img alt="Button Import Excel.png" src="../images/Importing_from_Excel/Button_Import_Excel.png" width="25"  /></a>をクリックします。これによりExcelダイアログボックスが開きます。 </li>
<li>1つのファイルを選択して「<b>ファイルの追加</b>」ボタンをクリックするか、CTRLまたはSHIFTキーを押して、複数ファイルを選択して、「ファイルの追加」ボタンをクリックします。全てのファイルを選択したあと、OKボタンをクリックします。この設定についてのより詳しい情報は下記をご覧ください。 </li>
<li><a class="external text" href="../../XFunction/X-Function/ImpMSExcel.html">impMSExcel</a>ダイアログで調整を行ったら、 <b>OK</b>ボタンをクリックして、Originにファイルをインポートします。 </li></ol>
<p><br />
<i><b>Excelダイアログボックスでの制御についての補足</b></i>
</p>
<ul><li><b>ファイルを削除</b>ボタンを使うと、インポートするファイルのリストからファイルを消去することができます。 </li>
<li>また、インポートするファイルのリストの一番上にある<b>ファイル名</b>、<b>サイズ</b>、<b>更新日時</b>の<b>ボタン</b>をクリックすると、その項目でソートします。 </li></ul>
<dl><dd><a  class="image"><img alt="Importing from Excel-1.png" src="../images/Importing_from_Excel/Importing_from_Excel-1.png" width="552"  /></a></dd></dl>
<ul><li><b>OK</b>ボタンをクリックすると、Originは、2つ目のダイアログボックス (「<a class="external text" href="../../XFunction/X-Function/ImpMSExcel.html">impExcel</a>」ダイアログボックス)を開きます。 </li></ul>
<p><br />
<b>1つもしくは複数のExcelシートを再インポートするには</b>
</p><p>Origin 2015以降、ExcelからOriginへの複数シートの即時再インポートが可能です。Excel再インポート中、Originが最新のデータを利用するようリンクは維持されます。
</p><p>Excelファイルを再インポートするには、メニューから<b>データ: 直接<b>再インポート</b></b>を選択するか、ショートカットキーCtrl+4 で、以前の同じ設定でExcelシートをインポートできます。あるいは、メニューから<b>データ： 再インポート...</b>を選択して、再インポートのためのファイルのインポート設定を変更します。
</p><p>コマンドウィンドウに<b>reimport -d</b>と入力することでもExcelファイルを再インポートできます。
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Importing_from_Excel/Tip_icon.png" width="57"  border="0" /></td><td><p><b>Excelコネクタ</b>の（およびデータコネクタの一般的な）利点の1つは、接続されたExcelファイルのデータが変更されたときにプロジェクトを更新するように自動的に構成できることです。詳しくは、<a href="../../UserGuide/Category/Working_with_Microsoft_Excel.html#Reimport_Data_if_Changed" title="カテゴリ:Microsoft Excelと操作"><b>Microsoft Excelと操作</b></a>を参照してください。
</p></td></tr></table>
<p><br />
<b><b>impMSExcel</b></b>ダイアログボックスでは、Excelファイル(XLS、XLSX、XLSM)をインポートする方法を詳細に設定することができます。 
</p>
<table class="dialogcontroltable">
<tr>
<th>ファイル名
</th>
<td>
<p><b>ファイル名</b>ボックスには、<b>Excel </b>ダイアログで選択したすべてのファイルを表示します。<b>参照</b>ボタンをクリックして、ファイルを選択し直すこともできます。 
</p>
</td></tr>
<tr>
<th>ファイル情報
</th>
<td>
<p>この項目では、選択されたExcelファイルのサイズとシート構造を表示します。
</p>
<ul><li> <b>ファイル情報</b>テキストボックスは、Excelファイルのサイズを表示します。 </li>
<li> Excelファイルの全てのシートが表示されます。各シート名の隣にあるチェックボックスを使ってインポートするシートを選択します。</li></ul>
</td></tr>
<tr>
<th>第1ファイルインポートモード
</th>
<td>
<p>最初にインポートするファイルに対して、インポートモードを選択します。以下より選択します。
</p>
<ul><li> <b>既存データを置き換える</b>: 目的のウィンドウ内にある既存のデータを置き換えてインポートします。</li>
<li> <b>ブックを新たに作って読み込む</b>: 新しいワークブックに第1ファイルをインポートします。</li>
<li> シートを新たに作って読み込む: アクティブシートの隣の空のワークシートがあればそこに第1ファイルをインポートします。なければ新しいシートを作ってインポートします。ブックには最大で1024シートまで追加することができます。</li>
<li> <b>各シートに対して新しい列を開始</b>: 指定したワークソートの新しい列として最初のExcelファイルの各シートをインポートします。</li>
<li> <b>各シート用に新しいブックを開始</b>: 新しいブックに最初のExcelファイルの各シートをインポートします。</li></ul>
</td></tr>
<tr>
<th>複数ファイルのインポートモード(第1ファイル以外)
</th>
<td>
<p>2番目以降のファイルのインポートモードです。以下より選択します。
</p>
<ul><li> <b>ブックを新たに作って読み込む</b>: 新しいワークブックに各ファイルをインポートします。</li>
<li> <b>シートを新たに作って読み込む</b>: データが最初にインポートされたブック内のアクティブシートの後に空のシートがあればインポートし、それ以外の場合は、アクティブシートの次の新しいシートにファイルをインポートします。ブックには最大で1024シートまで追加することができます。</li>
<li> <b>各シートに対して新しい列を開始</b>: 最初のファイルがインポートされたワークシートの新しい列としてExcelファイルの各シートをインポートします。</li>
<li> <b>各シート用に新しいブックを開始</b>: 新しいブックに最初のExcelファイル以外の各シートをインポートします。</li></ul>
</td></tr>
<tr>
<th>テンプレート名
</th>
<td>
<p>データインポートにおいて、ワークブックテンプレート (*.otw) または分析テンプレート (*.ogw) を使用できます。リストからテンプレートを選択して参照ボタンをクリックします。 
</p>
<ul><li> デフォルトでは、Originのワークブックテンプレート<i>&lt;default&gt;</i> が使用されます。 </li>
<li> アクティブなワークシート/ワークブックから、インポートしたデータをクローン複製することが出来る、<i>&lt;clone&gt;</i>という特別なテンプレートを提供します。 </li></ul>
<p><b>Note</b>: 空のワークシートを含む特定のワークブックテンプレートに複数のエクセルシートをインポートするときは、インポート挙動を追加制御するための <a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#H.2CI.2CJ.2CK">システム変数 @ISE</a> を参照することが出来ます。
</p>
</td></tr>
<tr>
<th>列のXY属性
</th>
<td>
<p>インポートしたExcelワークブックデータに列の<a href="../../UserGuide/UserGuide/Set_Column_Designation.html" title="ユーザガイド：列の属性の設定">プロット属性</a>をOriginが適用します。ドロップダウンリストから選択、または、属性を直接入力します。このオプションはインポートウィザードと同じ列属性シンタックス（例えば、属性の繰り返しなど）を使用できます。詳細は<a href="../../UserGuide/UserGuide/Import_Wizard_Data_Columns_Page_(ASCII).html#Column_Designations" title="ユーザガイド:インポートウィザードデータ列ページ (ASCII)">このページ</a>を参照してください。
</p><p><b>Note:</b>指定された属性は、全てのシートに自動で適用されます。
</p>
</td></tr>
<tr>
<th>スパークラインの追加
</th>
<td>
<p>データのスパークラインを追加します。
</p>
<ul><li> <b>しない</b>: スパークラインを表示しません。</li>
<li> <b>する</b>: スパークラインを表示します。</li>
<li> <b>する（50列未満）</b>: 50列未満の場合スパークラインを表示します。</li></ul>
</td></tr>
<tr>
<th>インポートセルフォーマット
</th>
<td>
<p>エクセルファイルのインポートセルフォーマット（テキストの色、フォント、セルの高さなど）を指定します。
</p>
</td></tr>
<tr>
<th>空白列の最大数(すべてを指定するには-1)
</th>
<td>
<p>Originにインポートする最大の空白列数を指定します。
</p>
</td></tr>
<tr>
<th>空のシートを削除
</th>
<td>
<p>ターゲットウィンドウにある空のシートを入力するかどうかを指定します。チェックがついている場合、空のシートはファイル情報ブランチの<b><b>ファイルシート</b></b>ブランチに表示されません。
</p>
</td></tr>
<tr>
<th>ヘッダを全てのシートに適用
</th>
<td>
<p>「ヘッダ行」ブランチでヘッダの設定を全てのExcelシートに適用するかどうか指定します。
</p>
</td></tr>
<tr>
<th>シートとブックの名前の(再)変更
</th>
<td>
<p>ワークシートとワークブックの名前をどのように変更するかを指定します。
</p>
<ul><li><b>ファイル名による自動名前変更</b>: チェックがついている場合、Originは以下のようなワークシートとワークブックの名前の変更デフォルト設定を使用します。: (1) ファイル名全体（拡張子含む）をワークブック名として使用。(2)Excelシート名をワークシート名として使用。</li>
<li><b><b>シート名をExcelのシート名に変更する</b></b>：Excelシート名にシート名を変更するか指定します。</li>
<li><b>ブック名を（部分）ファイル名に変更する</b>: ファイル名の一部分をワークブック名として使用します。</li>
<li><b>短縮開始位置</b>：名前の開始位置を指定します。</li>
<li><b>短縮終了位置</b>：名前の終了位置を指定します。</li>
<li><b>ブックのロングネームのみを変更</b>: ブックのみのロングネームを変更し、ショートネームは変更しません。</li>
<li><b>ブック名の変更の際にパスを含める</b>：ファイルパスをワークブック名に含めるかどうか指定します。</li>
<li><b>ファイル名をワークブックコメントに含める</b>: ファイル名をワークブックコメントに含めるかどうかを指定します。</li>
<li><b>ファイル名をワークシートコメントに含める</b>: ファイル名をワークシートコメントに含めるかどうかを指定します。</li>
<li><b>ファイル名を列のコメントに含める</b>: ファイル名を列のコメント行に含めるかどうかを指定します。</li>
<li><b>ファイル名をユーザパラメータ行に含める</b>: ファイル名を列のユーザコメント行に含めるかどうかを指定します。</li>
<li><b>ファイル名の追加の際にパスを含める</b>: インポートファイルパスをワークブックのコマンドと/またはコメント行に追加するかどうかを指定します。</li>
<li><b>ファイル名をユーザパラメータ行に含める</b>: ファイル名を列のユーザパラメータ行&rdquo;ソースシート&rdquo;に含めるかどうかを指定します。</li></ul>
</td></tr>
<tr>
<th>ヘッダ行
</th>
<td>
<p>これらのブランチを使って、どの行をOriginのワークシート列の<b>ロングネーム</b>、<b>単位</b>、<b>コメント</b>に対応させるのかを指定します。<b>メインヘッダの行数</b>と<b>サブヘッダの行数</b>を指定できます。
</p>
<ul><li><b>メインヘッダの行数(サブヘッダを除く)</b>: インポートの際、省略されるメインヘッダの行数を指定します。</li>
<li><b>サブヘッダの行数</b>: サブヘッダ行の数を指定します。</li>
<li><b>ロングネーム</b>： 列のロングネームの行インデックスを指定します。</li>
<li><b>単位</b>: 列の単位の行の行インデックスを指定します。</li>
<li><b>コメント(開始行)</b>: コメント行の開始インデックスを指定します。</li>
<li><b>コメント(最終行)</b>: コメント行の終了インデックスを指定します。</li>
<li><b>システムパラメータ(開始行)</b>: システムパラメータ行の開始インデックスを指定します。</li>
<li><b>システムパラメータ(最終行)</b>: システムパラメータ行の終了インデックスを指定します。</li>
<li><b>ユーザパラメータ(開始行)</b>: ユーザパラメータ行の開始インデックスを指定します。</li>
<li><b>ユーザパラメータ(最終行)</b>: ユーザパラメータ行の終了インデックスを指定します。</li></ul>
</td></tr>
<tr>
<th>部分インポート
</th>
<td> 周期的な繰り返しパターンを指定して、インポートする列または行を選択します。あるいは、<b>カスタム</b>と<a href="../../UserGuide/Category/Partial_Importing_and_Re_Importing.html" title="カテゴリー: 部分インポートと再インポート">部分インポートと再インポート</a>にリストされている表記を使用してインポートする列を選択します。列または行の場合、<b>終了 = 0</b>を指定すると、最後まで読み込まれます。
<ul><li><b>部分インポート</b>: 部分インポートの設定を<b>全てのファイル</b>または<b>2番目のファイルから</b>適用します。</li>
<li><b>列の一部</b>: 開始列（<b>開始</b>）、<i>m</i>列読み込み(<b>読み込み</b>)、<i>n</i>列スキップ(<b>スキップ</b>)、最後の列(<b>終了</b>)を指定して、インポートする列の繰り返しパターンを決定します。</li>
<li><b>行の一部</b>: 開始行（<b>開始</b>）、<i>m</i>行読み込み(<b>読み込み</b>)、<i>n</i>行スキップ(<b>スキップ</b>)、最後の行(<b>終了</b>)を指定して、インポートする行の繰り返しパターンを決定します。</li></ul>
<p><b>カスタム</b>の場合、データ範囲選択を指定する表記を<a href="../../UserGuide/Category/Partial_Importing_and_Re_Importing.html" title="カテゴリー: 部分インポートと再インポート">部分インポートと再インポート</a>で確認してください。
</p>
</td></tr>
<tr>
<th>スクリプト
</th>
<td>
<p>3番目のブランチ「スクリプト」では、ファイルをインポートした後に実行する、LabTalk スクリプトを指定します。
</p>
<ul><li><b>それぞれのファイルインポート後のスクリプト</b>: それぞれのファイルをインポートした後、編集ボックスに入力されたLabTalkスクリプトを実行します。</li>
<li><b>全てのファイルインポート後のスクリプト</b>: 全ファイルをインポートした後、編集ボックスに入力されたLabTalkスクリプトを実行します。</li></ul>
</td></tr></table>


    