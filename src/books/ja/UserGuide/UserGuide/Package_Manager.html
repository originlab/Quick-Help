<h1 class="firstheading">パッケージマネジャ</h1><p class='urlname' style='display: none'>FileShare-PackageManager</p>
<p><b>パッケージマネジャ</b>は、OPKファイルに変わってOriginに新しく導入されました。古いOPKファイルはバイナリファイルで、モジュールのインストールで使用する際に制限がありました。新しいOPXファイルはXMLファイルで、モジュールのインストールをより簡単にする目的で設計されています。<b>ツール</b>メニューの<b>パッケージマネジャ</b>を選び、ダイアログを開くことができます。</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div><ul><li class="toclevel-1 tocsection-1"><a href="#Dialog:_File_Menu"><span class="tocnumber">1</span> <span class="toctext">ダイアログ: ファイルメニュー</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Dialog:_Tree_View"><span class="tocnumber">2</span> <span class="toctext">ダイアログ: ツリービュー</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Dialog:_Buttons"><span class="tocnumber">3</span> <span class="toctext">ダイアログ: ボタン</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Dialog:_File_List"><span class="tocnumber">4</span> <span class="toctext">ダイアログ: ファイルリスト</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#OriginC"><span class="tocnumber">5</span> <span class="toctext">OriginC</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Internal_Behavior"><span class="tocnumber">6</span> <span class="toctext">内部動作</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Silent_Install"><span class="tocnumber">7</span> <span class="toctext">サイレントインストール</span></a></li></ul></div>

<h2><a name="Dialog:_File_Menu"></a><span class="mw-headline">ダイアログ:ファイルメニュー</span></h2>
<p>パッケージマネジャのダイアログにはファイルメニューがあります。このメニューには次の項目があります。</p>
<table class="dialogcontroltable">

<tr>
<th> 新規</th>
<td>
<p>新しいパッケージを作成します。この操作は、既にパッケージが開いていると、現在のパッケージを閉じます。現在のパッケージに保存されていない変更があると、その変更を保存するか、保存しないか、新しいパッケージの作成をキャンセルするか、を選択するメッセージボックスが表示されます。</p>
</td></tr>
<tr>
<th> 開く</th>
<td>
<p>既存のパッケージファイルを開きます。この操作は、既にパッケージが開いていると、現在のパッケージを閉じます。現在のパッケージに保存されていない変更があると、その変更を保存するか、保存しないか、新しいパッケージの作成をキャンセルするか、を選択するメッセージボックスが表示されます。</p>
</td></tr>
<tr>
<th> 保存</th>
<td>
<p>現在のパッケージを同じ名前で上書き保存します。パッケージが新しく、まだファイル名を付けていない場合には、ファイル名を指定するように促されます。</p>
</td></tr>
<tr>
<th> 名前を付けて保存</th>
<td>
<p>現在のパッケージに新しいファイル名を付けて保存します。</p>
</td></tr>
<tr>
<th> パッケージのインストール</th>
<td>
<p>パッケージファイルを選択するファイルダイアログが開きます。パッケージファイルを選択し、開くボタンをクリックすると、パッケージがインストールされます。</p>
</td></tr>
<tr>
<th> パッケージのアンインストール</th>
<td>
<p>この項目は、インストール済みパッケージダイアログを表示します。このダイアログは、現在インストールされているすべてのパッケージを一覧表示します。アンインストールしたいパッケージを単に選択し、アンインストールボタンをクリックします。</p>
</td></tr>
<tr>
<th> パッケージの抽出</th>
<td>
<p>パッケージの抽出は、パッケージのインストールとは異なります。パッケージの抽出は、パッケージからファイルを取得したいときに使います。前後のスクリプトは実行されません。目的のフォルダを選択するように促されます。目的のフォルダはユーザフォルダまたはOriginのインストールフォルダにすることはできません。</p>
</td></tr>
<tr>
<th> 閉じる</th>
<td>
<p>ダイアログを閉じます。現在のパッケージに変更を行っていて、まだ保存していない場合、メッセージボックスが表示されます。</p>
</td></tr></table>
<h2><a name="Dialog:_Tree_View"></a><span class="mw-headline">ダイアログ:ツリービュー</span></h2>
<p>ツリービューは、パッケージの設定が編集される場所です。以下は、設定についての説明です。</p>
<table class="dialogcontroltable">
<tr>
<th>パッケージ</th>
<td><ul><li>モジュール名<dl><dd>モジュールの名前名前は、リリースされた各バージョン*に対して同じとなります。</dd>
<dd>インストール中、モジュール名が既にインストールされているパッケージの名前と比較されます。名前が一致すると、バージョンフィールドが比較され、既にインストールされているパッケージに対して、新しい、古い、同じであることをユーザに通知します。ユーザは、インストールを続行するかキャンセルするかを選択することができます。</dd></dl></li>
<li>説明<dl><dd>モジュールまたはパッケージの内容の説明です。</dd></dl></li>
<li>バージョン<dl><dd>パッケージに含まれるモジュールのバージョンです。</dd>
<dd>インストール中、モジュール名が既にインストールされているパッケージの名前と比較されます。名前が一致すると、バージョンフィールドが比較され、既にインストールされているパッケージに対して、新しい、古い、同じであることをユーザに通知します。</dd></dl></li>
<li>著者<dl><dd>パッケージに含まれるモジュールの作成者です。</dd></dl></li></ul></td></tr>
<tr>
<th>アプリ</th>
<td><ul><li>アイコン<dl><dd><a href="../../UserGuide/UserGuide/Apps.html#The_Apps_Gallery" title="ユーザガイド:アプリ">アプリギャラリー</a>でアイコンとして使用するbmp画像です。</dd></dl></li>
<li>スクリプトを実行<dl><dd>アプリを起動するときに実行するLabTalkスクリプト</dd></dl></li></ul></td></tr>
<tr>
<th>必要なOriginのバージョン</th>
<td>
<p>パッケージに含まれるモジュールを使用するのに必要なOriginのバージョンです。</p>
</td></tr>
<tr>
<th>ターゲットパス</th>
<td>
<p>ターゲットパスはインストール中に使われ、パッケージマネジャにパッケージの内容をどこにインストールするのかを通知しします。</p><ul><li>ユーザ = ユーザファイルフォルダ</li>
<li>System = Originのプログラムフォルダ</li>
<li>自動 = ユーザおよびシステムのパスに書き込みできるかチェックします。どちらか一方だけが書き込める場合、そこにインストールします。両方とも書き込める場合、ターゲットパスを選択するようにユーザに促します。</li></ul></td></tr>
<tr>
<th>ツールバー</th>
<td><ul><li>ボタングループファイル<dl><dd>パッケージにボタングループファイルが含まれ、そのボタングループをパッケージのインストール中にOriginのユーザ定義ボタングループに追加したい場合、ここにボタングループファイルを指定します。</dd>
<dd>このフィールドをセットする最も簡単な方法は、最初にパッケージにボタングループファイルを追加することです。追加したら、ファイルリストでボタングループファイルを選択し、ツールバーの設定ボタンをクリックします。</dd></dl></li>
<li>ツールバーを作成<dl><dd>これは、パッケージのインストール中に、ボタングループからツールバーを作成するかどうかを決めます。</dd>
<dd>チェックを付けるとツールバーを作成し、チェックを付けないとツールバーを作成しません。</dd></dl></li></ul></td></tr>
<tr>
<th>LabTalkスクリプト</th>
<td><ul><li>インストール前<dl><dd>ここに入力したLabTalkのコードをパッケージがインストールされる前に実行します。LabTalkのコマンドエラーが発生したら、インストールはキャンセルされます。作成したスクリプトコードでいくつかチェックを行い、インストールするべきでないと判定したら、&apos;break 1;&apos; で強制的にコマンドエラーを発生させるか、OPXERRに0以外の値をセットします。</dd></dl></li>
<li>インストール後<dl><dd>ここに入力したLabTalkのコードをパッケージがインストールされた後に実行します。</dd></dl></li>
<li>アンインストール前<dl><dd>ここに入力したLabTalkのコードをインストール済みのファイルがアンインストールされる前に実行します。これを使って、インストール前またはインストール後に行った変更を元に戻すことができます。作成したスクリプトコードでいくつかチェックを行い、アンインストールするべきでないと判定したら、&apos;break 1;&apos; で強制的にコマンドエラーを発生させるか、OPXERRに0以外の値をセットします。</dd></dl></li></ul></td></tr>
<tr>
<th>ソースパス</th>
<td>
<p>このフィールドは、パッケージファイルすべてのソースパスを表示します。パッケージに追加されるすべてのファイルは、同じソースパスからのものでなければなりません。ソースパスは、最初にフォルダまたはファイルを追加したときにセットされます。</p>
<dl><dd><ul><li>最初のフォルダまたはファイルがOriginのプログラムフォルダまたはそのサブフォルダからのものであれば、ソースパスはOriginのプログラムフォルダにセットします。</li>
<li>最初のフォルダまたはファイルがユーザファイルフォルダまたはそのサブフォルダからのものであれば、ソースパスはユーザファイルフォルダにセットします。</li>
<li>最初のフォルダまたはファイルがOriginのプログラムフォルダでもユーザファイルフォルダからのものでもなければ、ソースパスは追加するフォルダの上位のフォルダパスまたは追加するファイルを含むフォルダのパスにセットします。</li></ul></dd>
<dd>ファイルの位置を変更したら、手動でソースパスを編集できます。ソースパスの設定を新しい位置に変更すると、パッケージ内の変更したファイルを更新するため、ファイルの再パックボタンが使えるようになります。ソースパスを変更すると、他のコンピュータで作成したパッケージを再パックすることができます。</dd></dl>
</td></tr></table>
<h2><a name="Dialog:_Buttons"></a><span class="mw-headline">ダイアログ:ボタン</span></h2>
<p>ツリービューの下には、6つのボタンがあります。以下は、ボタンについての説明です。</p>
<table class="dialogcontroltable">
<tr>
<th>ファイルの再パック</th>
<td>
<p>このボタンをクリックして、パッケージに追加したすべてのファイルを再パックします。このボタンは、ファイルを変更し、変更したファイルをファイルパッケージ内に配置する場合に役立ちます。ファイルを削除して、再び追加するのではなく、単にこのボタンをクリックするだけで、ファイルに行ったすべての変更がパッケージに再パックされます。</p><p>このボタンはパッケージに少なくとも1つのファイルが存在しないと有効になりません。</p>
</td></tr>
<tr>
<th>ツールバーの設定</th>
<td>
<p>このボタンをクリックして、ツリービューのツールバーブランチのボタングループファイル設定をセットします。</p><p>このボタンは、ファイルリストでファイルを選択しないと有効になりません。</p>
</td></tr>
<tr>
<th>フォルダの追加...</th>
<td>
<p>このボタンをクリックして、フォルダを追加し、すべてのファイルとサブフォルダを選択したフォルダに含めます。</p><p>ツリービューのソースパスフィールドは、最初にフォルダまたはファイルがパッケージに追加されたときにセットされます。詳細は、ソースパスをご覧下さい。</p>
</td></tr>
<tr>
<th>ファイルの追加...</th>
<td>
<p>このボタンをクリックして、パッケージにファイルを追加します。「パッケージにファイルを追加」ダイアログでファイルを指定するように促されます。</p><p>ツリービューのソースパスフィールドは、最初にフォルダまたはファイルがパッケージに追加されたときにセットされます。詳細は、ソースパスをご覧下さい。</p>
</td></tr>
<tr>
<th>ファイルの削除</th>
<td>
<p>このボタンをクリックすると、選択されたファイルをすべてパッケージから削除します。</p><p>このボタンは、ファイルリストで1つ以上ファイルを選択しないと有効になりません。</p>
</td></tr></table>
<p>最も右のボタンは、ファイルリストを表示するのに使用します。</p>
<h2><a name="Dialog:_File_List"></a><span class="mw-headline">ダイアログ:ファイルリスト</span></h2>
<p>ファイルリストは、現在パッケージにあるすべてのファイルを表示します。リスト内のファイルの数と選択したファイルの数により、上記で述べたようにボタンの状態が変化します。</p>
<h2><a name="OriginC"></a><span class="mw-headline">OriginC</span></h2>
<p>パッケージマネジャダイアログは、OriginC\OriginLab\XMLPackage.cにあるOriginCコードで扱われます。</p><p>XMLPackage.cファイルは、パッケージを操作するOriginのエクスポートされた関数のコレクションを呼び出します。次の関数がoUtils.hで宣言されており、OriginのokUtil80.dllからエクスポートされた関数です。</p><ul><li> okutil_create_package_tree</li>
<li> okutil_create_package_file</li>
<li> okutil_install_package_file</li>
<li> okutil_uninstall_package_file</li>
<li> okutil_get_installed_package_names</li>
<li> okutil_add_folder_to_package</li>
<li> okutil_add_files_to_package</li>
<li> okutil_remove_files_from_package</li>
<li> okutil_get_packed_file_names</li>
<li> okutil_repack_files</li></ul><p>関数の戻り型および各関数が受け入れる引数についてはOriginCのUtils.hをご覧下さい。</p>
<h2><a name="Internal_Behavior"></a><span class="mw-headline">内部動作</span></h2>
<p>パッケージをインストールするとき、Originは最初にパッケージが既にインストールされているかどうかをチェックします。既にインストールされている場合、Originは、そのパッケージが既にインストールされていることをユーザに通知し、インストールを続行するかどうかを尋ねます。ユーザがインストールを続行することを選択した場合、Originは最初に既にインストールされているパッケージをアンインストールし、続けて現在のパッケージをインストールします。</p><p>インストールされる各パッケージに対して、Originはパッケージをパックされたファイル無しでパッケージリストファイルにコピーします。パッケージリストファイルは、OPXList.xmlで、ユーザファイルフォルダに保存されています。</p>
<h2><a name="Silent_Install"></a><span class="mw-headline">サイレントインストール</span></h2>
<p>サイレントインストールができるようにOPXを作成するには、次のように設定を行います。</p><ul><li><b>LabTalkスクリプト &gt; インストール前</b> の設定を空白にするか、ユーザの操作を要求しないスクリプトのみをセットします。</li>
<li><b>LabTalkスクリプト &gt; インストール後</b>の設定を次の2つのコマンドの前に、ユーザの操作を要求しないスクリプトをセットします。</li></ul><pre class="lt" style="font-family:monospace;">doc <span style="color: #000080;">-</span>s; exit;</pre>
<p>OPXへ必要な変更を行い、Originを起動し、OPXをインストールし、人による操作無しでOriginを終了します。次のコマンドラインは、OPXファイルのサイレントインストールのサンプルです。</p>
<pre class="lt" style="font-family:monospace;">Origin8.<span style="color: #000080;">exe</span> <span style="color: #000080;">-</span>h <span style="color: #000080;">-</span>R <span style="color: #ff00ff;">&quot;instOPX OPXFileName.opx&quot;</span></pre>
<p>上記のコマンドラインで、自分のOPXのファイル名に編集して使用できます。</p>






    