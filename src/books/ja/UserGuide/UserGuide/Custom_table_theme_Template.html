<h1 class="firstheading">表スタイルテンプレートと表中の値の編集</h1>
<p class="urlname" style="display: none;">FitRef-CustomReportTable</p>
<p>グラフウィンドウからフィットするとき、結果テーブルを元のグラフに貼り付けるかどうかを決めるだけでなく、「<b>表スタイルテンプレート</b>」でワークシートテンプレートを指定して表のフォーマットを編集したり、「<b>表中の値</b>」でINIファイルを指定してテーブルの内容を編集することができます。</p>
<table id="toc" class="toc">
<tr>
<td>
<div id="toctitle">
<h2>目次</h2>
</div>
<ol>
<li class="toclevel-1 tocsection-1"><a href="#Table_Style_Template"><span class="tocnumber">1</span> <span class="toctext">表スタイルテンプレート</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Quantities_in_Table"><span class="tocnumber">2</span> <span class="toctext">表中の値</span></a>
<ol>
<li class="toclevel-2 tocsection-3"><a href="#Quantities_in_Table_dialog"><span class="tocnumber">2.1</span> <span class="toctext">表ダイアログの値</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Custom_Quantities_in_Table_by_editing_INI_file"><span class="tocnumber">2.2</span> <span class="toctext">INIファイルを編集して、表中の値をカスタマイズ</span></a>
<ol>
<li class="toclevel-3 tocsection-5"><a href="#How_to_indicate_a_report_tree_value"><span class="tocnumber">2.2.1</span> <span class="toctext">レポートツリーの値を示す方法</span></a></li>
<li class="toclevel-3 tocsection-6"><a href="#Node_item_names"><span class="tocnumber">2.2.2</span> <span class="toctext">ノード項目名</span></a></li>
<li class="toclevel-3 tocsection-7"><a href="#Constructing_INI_file"><span class="tocnumber">2.2.3</span> <span class="toctext">INIファイルの作成</span></a></li>
<li class="toclevel-3 tocsection-8"><a href="#Example"><span class="tocnumber">2.2.4</span> <span class="toctext">サンプル</span></a></li>
</ol>
</li>
</ol>
</li>
</ol>
</td>
</tr>
</table>
<h2><a name="Table_Style_Template" id="Table_Style_Template"></a><span class="mw-headline">表スタイルテンプレート</span></h2>
<p>レポートテーブルは組込のワークブックテンプレートで作成されます。通常のワークシートの操作と同様に、フォント、背景、色などのワークシートスタイルをカスタマイズできます。このワークシートをテンプレートして保存し、表作成編集ボックスでテンプレートを指定できます。</p>
<p><i style="font-style: italic;"><b style="font-weight: bold;">例：</b></i></p>
<ol>
<li><i style="font-style: italic;">\Samples\Curve Fitting\Linear Fit.dat</i>ファイルをインポートした後、B列にを選択して、散布図を作成します。</li>
<li>グラフをアクティブにして、<b>解析：</b><b>フィット：</b><b>線形フィット</b>と選び、 <b>線形フィット</b>ダイアログを出します。デフォルトのまま、<b>OK</b>ボタンをクリックします。結果の表は、元のグラフに貼り付けられます。</li>
<li>表をダブルクリックして、ワークシートとして開きます。最初の行の背景の色を赤に設定します。
<dl>
<dd><a class="image" style="color: #0000ff; text-decoration: underline;"><img alt="Custom table theme Template01v.png" src="../images/Custom_table_theme_Template/Custom_table_theme_Template01v.png" width="266" height="253" border="0" /></a></dd>
</dl>
</li>
<li>メニューから<b>ファイル：テンプレートの新規保存</b>を選びます。MyTemplateと名前を付けて、保存します。
<dl>
<dd><a class="image" style="color: #0000ff; text-decoration: underline;"><img alt="Custom table theme Template 02.png" src="../images/Custom_table_theme_Template/Custom_table_theme_Template_02.png" width="541" height="229" border="0" /></a></dd>
</dl>
</li>
<li>元のデータワークシートに戻ります。C列を選択して、散布図を作成します。</li>
<li>グラフをアクティブにして、<b>線形フィット</b>ダイアログを再度開きます。<b>出力</b>タブで、<b>グラフ:</b><b>元のグラフに結果表を表示</b>の項目を開いて、 <b>表スタイルテンプレート</b>編集ボックスに 「MyTemplate」と入力します。
<dl>
<dd><a class="image" style="color: #0000ff; text-decoration: underline;"><img alt="Custom table theme Template03v.png" src="../images/Custom_table_theme_Template/Custom_table_theme_Template03v.png" width="569" height="318" border="0" /></a></dd>
</dl>
</li>
<li><b style="font-weight: bold;">OK</b>ボタンをクリックして、フィットを実行します。結果グラフのレポート表の最初の行が赤くなっているのが分かります。つまり、ユーザ定義のテンプレートを使って、グラフ上の表が作成されました。
<dl>
<dd><a class="image" style="color: #0000ff; text-decoration: underline;"><img alt="Custom table theme Template04v.png" src="../images/Custom_table_theme_Template/Custom_table_theme_Template04v.png" width="459" height="345" border="0" /></a></dd>
</dl>
</li>
</ol>
<h2><a name="Quantities_in_Table" id="Quantities_in_Table"></a><span class="mw-headline">表中の値</span></h2>
<p>グラフの表に表示する項目を変更する方法は、2つあります。</p>
<ul>
<li>「表中の値」ダイアログを使う</li>
<li>*.iniファイルを編集します。この方法を使う場合、<b>表中の値</b>ボックスに 「iniファイル名」を入力します。</li>
</ul>
<h3><a name="Quantities_in_Table_dialog" id="Quantities_in_Table_dialog"></a><span class="mw-headline">「表中の値」ダイアログ</span></h3>
<p><a class="image"><img alt="Quantities in Table.png" src="../images/Custom_table_theme_Template/Quantities_in_Table.png" width="426" height="345" border="0" /></a></p>
<p>このダイアログは、<b>表中の値</b>の隣にある<a class="image"><img alt="DOT.png" src="../images/Custom_table_theme_Template/DOT.png" width="17" height="18" border="0" /></a> をクリックして開きます。右側のフライアウトメニューから選択して、グラフ表に値を追加/削除します。<a class="image"><img alt="Move button.png" src="../images/Custom_table_theme_Template/Move_button.png" width="76" height="18" border="0" /></a>ボタンをクリックして、値の順番の並び替え、削除、選択を行うことも可能です。<b>OK</b>を選択後、表の内容を示す文字列が編集ボックスに作成されます。以下のチュートリアルでは、グラフ上に線形回帰レポート表を作成する方法を説明しています。</p>
<table class="noborder">
<tr>
<td style="vertical-align: top;" width="60"><img src="../images/Custom_table_theme_Template/Tutorial_icon.png" alt="" width="57" height="57" border="0" /></td>
<td>
<ol>
<li>新しいワークブックを開き、\<i>Samples</i>\<i>Curve Fitting</i>\<i>Linear Fit.dat</i>ファイルをインポートします。</li>
<li>2列目をクリックして選択した後にメニューから操作を行います。<b>作図：</b><b>シンボル図：</b><b>散布図</b>と選び、散布図を作成します。</li>
<li>グラフをアクティブにしたうえで次の操作を行います。<b>解析：</b><b>フィット：</b><b>線形フィット</b>と選び、線形フィットダイアログを出します。</li>
<li><b style="font-weight: bold;">フィット制御</b>タブの<b>図上値によるフィット</b>のチェックを外します。</li>
<li>ダイアログの<b>出力</b>タブで、<b>グラフ-&gt; 元のグラフに結果表を表示</b>の順に開きます。<b>表の値</b>の隣にある、<a class="image"><img alt="DOT.png" src="../images/Custom_table_theme_Template/DOT.png" width="17" height="18" border="0" /></a>ボタンをクリックして、<b>表の値</b>ダイアログを開きます。CTRLを押しながら、リストから<b>数式</b>、<b>プロット</b>、<b>重み</b>、<b>残差平方和</b>、<b>R二乗(COD)</b>を選択し、<a class="image"><img alt="Move button 1.png" src="../images/Custom_table_theme_Template/Move_button_1.png" width="18" height="18" border="0" /></a>をクリックして、削除します。残りの項目がグラフ中に表示されます。OKをクリックして適用します。</li>
<li>OKをクリックして、線形フィットダイアログを閉じます。結果のグラフは、下図と同様になります。
<dl>
<dd><a class="image" style="color: #0000ff; text-decoration: underline;"><img alt="FIt Result Graph.png" src="../images/Custom_table_theme_Template/FIt_Result_Graph.png" width="446" height="337" border="0" /></a></dd>
</dl>
</li>
</ol>
</td>
</tr>
</table>
<h3><a name="Custom_Quantities_in_Table_by_editing_INI_file" id="Custom_Quantities_in_Table_by_editing_INI_file"></a><span class="mw-headline">INIファイルを編集して、表中の数をカスタマイズ</span></h3>
<p>Originでは、\CustomTable フォルダにある、「INIファイル」として保存したテーマを使って、表の内容を指定します。新規テーマを作成したい場合、新しいINIファイルを作成しした後、\CustomTableフォルダに保存し、「表の値」編集ボックスにあるこのINIファイルを指定します。</p>
<h4><a name="How_to_indicate_a_report_tree_value" id="How_to_indicate_a_report_tree_value"></a><span class="mw-headline">レポートツリーの値を示す方法</span></h4>
<p>レポートテーブルの内容は、レポートワークシートにリンクしており、レポートワークシートはツリー構造で管理されており、次のようにINIファイル内のツリーノードを指定することができます。</p>
<dl>
<dd><i style="font-style: italic;">TableName!ColumnNodeName[RowNodeName]</i></dd>
<dd><a class="image" style="color: #0000ff; text-decoration: underline;"><img alt="Custom table theme Template05.png" src="../images/Custom_table_theme_Template/Custom_table_theme_Template05.png" width="436" height="241" border="0" /></a></dd>
</dl>
<p>例えば、次の曲線の傾き値は次のように記述できます。</p>
<dl>
<dd>Parameters!Value[Slope]</dd>
</dl>
<p>ノード名はレポートワークシートで使われる名前とは異なっています。次のノード名を参照してください。</p>
<h4><a name="Node_item_names" id="Node_item_names"></a><span class="mw-headline">ノード項目名</span></h4>
<p>ノート表(<b>Notes</b>)</p>
<table class="dialogcontroltable">
<tr>
<th>列/行</th>
<th>項目名</th>
</tr>
<tr>
<td>
<p>説明</p>
<p>ユーザ名</p>
<p>オペレーション時間</p>
<p>モデル</p>
<p>数式</p>
<p>レポートステータス</p>
</td>
<td>
<p>Description</p>
<p>UserName</p>
<p>Time</p>
<p>Model</p>
<p>Equation</p>
<p>AutoUpdateMode</p>
</td>
</tr>
</table>
<p>入力データ表(<b>Input</b>)</p>
<table class="dialogcontroltable">
<tr>
<th>列/行</th>
<th>項目名</th>
</tr>
<tr>
<td>
<p>列</p>
<p>行</p>
</td>
<td>
<p>Cn</p>
<p>Rn</p>
</td>
</tr>
</table>
<p>(ここで、<i>n</i>は、n番目の行/列)</p>
<p>パラメータ表(<b>Parameters</b>)</p>
<table class="dialogcontroltable">
<tr>
<th>列/行</th>
<th>項目名</th>
</tr>
<tr>
<td>
<p>値</p>
<p>固定</p>
<p>標準誤差</p>
<p>t値</p>
<p>Prob&gt;|t|</p>
<p>LCL</p>
<p>UCL</p>
<p>依存度</p>
<p>CI 半幅</p>
<p>下限</p>
<p>上限</p>
</td>
<td>
<p>Value</p>
<p>Fix</p>
<p>Error</p>
<p>tValue</p>
<p>Prob</p>
<p>LCL</p>
<p>UCL</p>
<p>Dependency</p>
<p>ConfInterval</p>
<p>LowerBound</p>
<p>UpperBound</p>
</td>
</tr>
</table>
<p>統計表 (<b>RegStats</b>)</p>
<table class="dialogcontroltable">
<tr>
<th>列/行</th>
<th>項目名</th>
</tr>
<tr>
<td>
<p>ポイント数</p>
<p>自由度</p>
<p>自由度あたりのカイ二乗</p>
<p>残差平方和</p>
<p>R値</p>
<p>R二乗 (COD)</p>
<p>補正R二乗</p>
<p>Root-MSE (SD)</p>
<p>反復回数</p>
<p>フィット状況</p>
</td>
<td>
<p>N</p>
<p>DOF</p>
<p>ReducedChiSq</p>
<p>SSR</p>
<p>Rvalue</p>
<p>RSqCOD</p>
<p>AdjRSq</p>
<p>RMSESD</p>
<p>NumIter</p>
<p>FitStatus</p>
</td>
</tr>
</table>
<p>概要表 (<b>Summary</b>)</p>
<p>ANOVAテーブル (<b>ANOVAs</b>)</p>
<table class="dialogcontroltable">
<tr>
<th>列/行</th>
<th>項目名</th>
</tr>
<tr>
<td>
<p>DF</p>
<p>平方和</p>
<p>二乗平均</p>
<p>F 値</p>
<p>Prob&gt;F</p>
<p>回帰</p>
<p>残差</p>
<p>未補正合計</p>
<p>補正合計</p>
</td>
<td>
<p>DOF</p>
<p>SSq</p>
<p>MeanSq</p>
<p>FValue</p>
<p>PValue</p>
<p>RegressionN</p>
<p>ResidualN</p>
<p>UCTotalN</p>
<p>CTotalN</p>
</td>
</tr>
</table>
<p>(Note:<i>N</i>は、n番目のANOVA表を意味します。)</p>
<h4><a name="Constructing_INI_file" id="Constructing_INI_file"></a><span class="mw-headline">INIファイルの作成</span></h4>
<ol>
<li>テーマファイルは標準的なINIファイルのような内容で、次のセクションで開始されます。
<dl>
<dd>
<dl>
<dd>[SectionName]</dd>
</dl>
</dd>
<dd>行に続き、以下の項目があります。
<dl>
<dd>name=value</dd>
</dl>
</dd>
<dd>この形式で項目数分入力されています。[DataLinks]という名前を持つセクションのみに対してサポートされます。セミコロン(;)で始まる行は、コメント行です。</dd>
</dl>
</li>
<li>すべての入力項目は、数字付きの「Entry」という文字で始まります。数字は、テーマでの上からの入力項目の順番です。テーマがカスタムテーブルに適用されると、1つの入力項目は1行以上の結果になります。ですから、例えば、2つの入力項目Enrty1とEntry2がある場合、Entry1はカスタムテーブルに3行作成し、カスタムテーブルのEntry2は4行目から開始します。</li>
<li>各入力値は、スペースで区切られた0または複数の項目で構成されます。テーマがカスタムテーブルに適用されると、項目は左から右へ(連続した列)現れます。入力項目が空白の場合(例えば項目がない)、テーマが適用されると、空白行になります。</li>
<li>各項目はいくつかの部分で構成されます。この部分は、いくつかの別のテーブルにリンクして参照するレポートツリーのノード名またはセルの中に入力される文字列にすることができます。項目にスペースがある場合、クォーテーションマークで囲みます。</li>
<li>項目にリンクがある場合、通常次のようになります。
<dl>
<dd>
<dl>
<dd><i style="font-style: italic;">TableName!ColumnNodeName[RowNodeName]</i></dd>
</dl>
</dd>
<dd>各リンク項目は、テーブルを表すレポートツリー内のノード名で始まる必要があります。RowNodeName は、<i>TableName</i>テーブルで1行を生成するノード名を表します (ノード名がブラケット内にあるということから、行を表しています。)<i>ColumnNodeName</i>は、TableName テーブル内の列のノードの名前を表しています。テーマとしてカスタムテーブルを適用するとき、上記リンクはリンクを1つのセルにします。セルは TableNameテーブル、RowNodeName行、 <i>ColumnNodeName</i>列にあります。例えば、
<dl>
<dd>Parameters!Value[P1]</dd>
</dl>
</dd>
<dd>は、<i>Parameters</i> テーブル内の最初のパラメータの値にリンクします。</dd>
</dl>
</li>
<li>同じテーブルのいくつかの列は組み合わされ、1つのリンクになります。例えば、
<dl>
<dd>
<dl>
<dd>Parameters!(Value,Error)[P1]</dd>
</dl>
</dd>
<dd>は、隣り合う2つのセルを作成します<i>Parameters</i> テーブル内の最初のパラメータの値セルと誤差セルへのリンクです。</dd>
</dl>
</li>
<li>行または列のノードが省略されている場合、結果は全体の他の次数にリンクされます。例えば、
<dl>
<dd>
<dl>
<dd>Parameters!Value</dd>
</dl>
</dd>
<dd>は、列値全体へのリンクを作成し、
<dl>
<dd>Parameters![P1]</dd>
</dl>
</dd>
<dd>は、<i>Parameters</i> テーブル内の最初のパラメータの行全体にリンクします。</dd>
</dl>
</li>
<li>行または列のノードが省略され、テーブルノード名だけが存在する場合、テーブル全体へのリンクが作成されます。例えば、
<dl>
<dd>
<dl>
<dd>Parameters!</dd>
</dl>
</dd>
<dd>は、<i>Parameters</i> テーブル全体にリンクします。</dd>
</dl>
</li>
<li>特殊なキーワード -- Labelsがあります。これは、ラベルにリンクしている次数を生成します。例えば、
<dl>
<dd>
<dl>
<dd>RegStats![Labels]</dd>
</dl>
</dd>
<dd>は、<i>RegStats</i>.テーブルの列ラベルを生成します。かつ
<dl>
<dd>Parameters!Labels[P1]</dd>
</dl>
</dd>
</dl>
</li>
</ol>
<h4><a name="Example" id="Example"></a><span class="mw-headline">サンプル</span></h4>
<p>メモ帳で、<i>\CustomTable\FitNL.INI</i>を開き、非線形フィットに対するデフォルトの出力テーブルを確認します。</p>
<dl>
<dd>[DataLinks]</dd>
<dd>Entry1=Notes![Model]<br />
Entry2=Notes![Equation]<br />
Entry3=RegStats![ReducedChiSq]<br />
Entry4=RegStats![AdjRsq]<br />
Entry5=Parameters!(Labels,Value,Error)</dd>
</dl>
<p>これは、レポートワークシートの次のテーブルを表します。</p>
<dl>
<dd><a class="image" style="color: #0000ff; text-decoration: underline;"><img alt="Custom table theme Template06.png" src="../images/Custom_table_theme_Template/Custom_table_theme_Template06.png" width="492" height="623" border="0" /></a></dd>
</dl>
<p>グラフテーブルのANOVA表のp値を取得するには、ファイルを次のように修正します。</p>
<dl>
<dd>[DataLinks]</dd>
<dd>Entry1=Notes![Equation]<br />
Entry2=RegStats![AdjRsq]<br />
Entry3="Model P Value" ANOVAs!PValue[Regression1]<br />
Entry4=Parameters!(Labels,Value,Error)</dd>
</dl>
<p>ユーザファイルフォルダにCustomTableというフォルダを作成します。Originは、最初にユーザファイルフォルダの設定 (.INIファイル) を使います。.INIファイルを、新しく作成したフォルダ<i>CustomTable</i> に<i>MyTheme.INI</i> という名前で保存します。このテーマを使うには、 <b>出力:設定：元のグラフに結果表を貼り付け：表の値</b>編集ボックスを使います。</p>
<dl>
<dd><a class="image" style="color: #0000ff; text-decoration: underline;"><img alt="Custom table theme Template07v.png" src="../images/Custom_table_theme_Template/Custom_table_theme_Template07v.png" width="840" height="365" border="0" /></a></dd>
</dl>
