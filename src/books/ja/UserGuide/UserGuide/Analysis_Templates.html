<h1 class="firstheading">分析テンプレート</h1><p class='urlname' style='display: none'>Analysis-Templates</p>
<p><br />
</p>
<div style="text-align: left; direction: ltr; margin-left: 1em;"><p><a class="image"><img alt="Video Image.png" src="../images/Analysis_Templates/Video_Image.png" width="33"  /></a> 関連する動画はこちら：<a class="external text" href="http://www.originlab.com/Index.aspx?go=Support/VideoTutorials&amp;ss=chm&amp;pid=1171" target="_blank">分析テンプレートの作成</a>
</p></div>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Introduction"><span class="tocnumber">1</span> <span class="toctext">はじめに</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Saving_Analysis_Operations_into_a_Template"><span class="tocnumber">1.1</span> <span class="toctext">分析操作をテンプレートに保存</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Using_Saved_Template_to_Handle_Repetitive_Tasks"><span class="tocnumber">1.2</span> <span class="toctext">保存テンプレートを使って、繰り返し処理</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Use_Active_Workbook_as_Template_to_Handle_Repetitive_Tasks"><span class="tocnumber">1.3</span> <span class="toctext">繰り返し処理のテンプレートとしてアクティブワークブックを使う</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Reporting_Batch_Analyzed_Results"><span class="tocnumber">1.4</span> <span class="toctext">バッチ分析結果をレポート</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Example"><span class="tocnumber">2</span> <span class="toctext">サンプル</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Other_Materials"><span class="tocnumber">3</span> <span class="toctext">その他</span></a></li>
</ul>
</div>
<h2><a name="Introduction"></a><span class="mw-headline">はじめに</span></h2>
<p>Originのワークブックは、データ、メタデータ、計算式、スクリプト、分析結果(グラフおよび行列を含む)を保存する機能があります。Originの分析機能の<a href="../../UserGuide/UserGuide/Recalculating_Analysis_Results.html" title="ユーザガイド:分析結果の再計算">再計算</a>付きの複雑な情報を保持する機能を組み合わせて、<b>分析テンプレート</b>を作成することができます。   
</p><p>分析テンプレートのコンセプトは、OTW(U)ファイルとしてワークブックテンプレートを保存するときすべてのデータが失われるという点で、Originの<a href="../../UserGuide/UserGuide/What_is_Saved_with_the_Workbook_Template.html" title="ユーザガイド:ワークブックテンプレートに保存される属性">ワークブックテンプレート</a>のコンセプトとは異なります。いくつかの操作を実行し、分析テンプレートをOGW（U）ファイルとして保存する（<b>ファイル：分析テンプレートとして保存</b>）と、ブックには列とシートの数、列の指定と順序、フォーマットとスタイルオプションといった情報だけでなく、 実行した分析の種類と生成する出力の種類に関する情報もOTW(U)ファイルに保存します。適切なデータを与えると、分析テンプレートはデータを処理し、自動的にワークシートデータ、行列、テーブルとグラフを組み合わせた分析レポートシートの形式で出力します。分析テンプレートは、Originの<a class="external text" href="../../UserGuide/UserGuide/Batch_Processing.html">バッチ処理</a>で不可欠なアイテムになります。
</p>
<dl><dd><dl><dd><a class="image"><img alt="Product Page BatchProcessing 04.png" src="../images/Analysis_Templates/Product_Page_BatchProcessing_04.png" width="702"  /></a></dd></dl></dd></dl>
<h3><a name="Saving_Analysis_Operations_into_a_Template"></a><span class="mw-headline">分析操作をテンプレートに保存</span></h3>
<p>すべての分析操作が1つのワークブックに統合されている場合は、<b>ファイル：ワークブックを分析テンプレートとして保存</b>を選択して、ワークブックを分析テンプレート（*.OGW(U)ファイル）として保存できます。OGW(U)ファイルをOriginに直接ドラッグして、開くことも可能です。関連するデータの全ての分析は消去されますが、分析は緑色の鍵で表示されている通り続行されます。
</p>
<ul>
分析操作が行列ブックまたは独立したグラフウィンドウにも関連付けられている場合は、 
<li>これらの<a href="../../UserGuide/UserGuide/Adding_Existing_Graphs_Matrixs_as_Sheets.html" title="ユーザガイド:既存のグラフ/行列をシートとして追加">行列ブック/グラフウィンドウを新しいシートとしてソースブックに追加</a>し（この機能はOrigin 2018b以降で利用可能です）、ブックを分析テンプレートとして保存します。 
<li>プロジェクト全体を分析テンプレートとして保存することができます。保存されたプロジェクトは新しいデータを追加する「テンプレート」になります。現在のプロジェクトをテンプレートとして保存するには、<b>ファイル: 現在のプロジェクトのクローンを作成</b>をクリックします。これにより、現在のプロジェクトファイルの全ウィンドウや操作は残し、インポートデータは消去して<i>複製</i> します。プロジェクトファイルが開かれてから変更されている場合は、クローン作成する前に、操作とグラフのカスタマイズ内容をプロジェクトファイルに保存するように求められます。新しい<b>UNTITLED.opju</b>が作成され、複製のあとに開かれます。</li>
</ul>
<h3><a name="Using_Saved_Template_to_Handle_Repetitive_Tasks"></a><span class="mw-headline">保存テンプレートを使って、繰り返し処理</span></h3>
<p>保存したテンプレートを使って別のデータセットを処理したいだけの場合、「ワークブックのテンプレート」は、「プロジェクトのテンプレート」と同じように機能します。いずれも、新規データをテンプレートにインポートして、グラフと結果に関連する全ての分析を更新する必要があります。
</p><p>「ワークブックのテンプレート」を利用するメリットは、 <a href="../../UserGuide/UserGuide/Batch_Processing.html" title="ユーザガイド:バッチ処理"><b>バッチ処理</b></a>ダイアログを使用できる点です。これは、ボタン<a class="image"><img alt="Button Batch Processing.png" src="../images/Analysis_Templates/Button_Batch_Processing.png" width="23"  /></a>をクリックするか、メニューから<b>ファイル:バッチ処理</b>を選択して複数ファイルまたはデータセットを自動で処理します。
</p>
<h3><a name="Use_Active_Workbook_as_Template_to_Handle_Repetitive_Tasks"></a><span class="mw-headline">繰り返し処理のテンプレートとしてアクティブワークブックを使う</span></h3>
<p>1つのワークブック内でデータの1つを解析する場合、アクティブなワークブックからクローン化したワークブックにインポートして、全てのファイルに同じ解析することが簡単にできます。この機能を使用する際は、各ファイルタイプのインポートダイアログで<b>テンプレート名</b>を<i>&lt;クローン&gt;</i>に設定します。
</p>
<dl><dd><dl><dd><a class="image"><img alt="Analysis Template clone worksheet.png" src="../images/Analysis_Templates/Analysis_Template_clone_worksheet.png" width="723"  /></a></dd></dl></dd></dl>
<h3><a name="Reporting_Batch_Analyzed_Results"></a><span class="mw-headline">バッチ分析結果をレポート</span></h3>
<p>分析結果をまとめてレポートするには、<a class="external text" href="../../Tutorial/Tutorial/Creating_a_Custom_Report_Sheet.html">カスタムレポートシート</a>を作成します。ここには、表、グラフ、ロゴなどの外部の画像など、分析テンプレートを分析処理した出力要素のすべてのリンクを含みます。 
</p><p>また、分析テンプレートから得られた結果を事前カスタマイズしたWordテンプレートに出力する選択をして、レポート用にWordまたはPDFファイルを作成することが可能です。 
</p><p>これを実行するには、まず初めにブックマークした好みのセルで、Wordテンプレートを用意します。メニューから<b>ファイル:分析テンプレートにWordブックマークを追加する</b>を選択して、<a href="../../UserGuide/UserGuide/Add_Word_Bookmarks_to_Analysis_Template_Dialog.html" title="ユーザガイド：分析テンプレートダイアログにWordブックマークを追加">分析テンプレートにWordブックマークを追加</a>ダイアログを開き、特定のワークシート内の分析テンプレートに、<i><b>ブックマーク</b></i>という名前で追加されます。 
</p><p>分析結果をWordブックマークでWordテンプレートに送る場合、分析テンプレートから結果をコピーしてWordブックマークが追加された対応するセルに、リンクとして貼る必要があります。その後、現行の分析テンプレートを再保存して、Wordテンプレートに沿って、バッチ分析結果をWordやPDFに直接エクスポートすることができます。
</p>
<h2><a name="Example"></a><span class="mw-headline">例</span></h2>
<p>次の簡単な例で分析テンプレートについて説明します。
</p>
<ol><li>新しいOriginプロジェクトを開き、<b>単一ASCIIインポート</b>ボタンをクリックし、\Samples\Curve Fitting\Linear Fit.datファイルを開きます。  ファイルはアクティブなワークシートにインポートされます。  シートは、<b>Linear Fit</b>という名前が付けられます。</li>
<li>列<b>B</b>から列<b>D</b>を選択し、メニューから<b>解析：フィット：線形フィット</b>と操作して<b>線形フィット</b>ダイアログを開きます。</li>
<li><b>再計算</b> を <b>自動</b>にセットします。</li>
<li>他の項目はデフォルトのまま<b>OK</b>をクリックして線形フィットを実行します。  表示されたメッセージには「いいえ」をクリックします。</li>
<li><b>Linear Fit</b>ワークシート列の右側の灰色の領域で右クリックし、ショートカットメニューから「<b>ワークシートのクリア</b>」を選択します。<b>OK</b>をクリックして、すべてのデータを削除します。  これによりLinear Fitデータに依存するすべての出力データがクリアされます（FitLinear1およびFitLinearCurve1シートをクリックすると確認できます）。この時点では、<b>分析テンプレート</b>はまだ保存されていません（タイトルなしのOriginプロジェクトファイルで作業していたにすぎません）。  必要に応じて、次の2つの保存オプションから選択します。  
<ul><li>最小化された分析テンプレート（最小の機能単位であれば）を保存したい場合、および入力と出力のすべてをワークブック自体に含めることができる場合は、Origin<b>ウィンドウ</b>ファイルとして保存できます。  <b>ファイル：ウィンドウの新規保存</b> (<b>テンプレートの新規保存</b>ではなく)を選択し、ワークブックを <b>OGW(U)</b>ファイルとして保存します。  </li>
<li>分析テンプレートをより複雑なプロジェクト（例えば別のグラフ、行列、またはレイアウトウィンドウを含むプロジェクト）に含める必要がある場合は、ワークブックを<b>プロジェクト</b>ファイルの一部として保存することができます。(<b>ファイル：プロジェクトの新規保存</b>）。  ただし、上記で説明したようにワークブックを<b>OGW(U)</b>として保存した場合は、いつでも「<b>ファイル：開く</b>」メニューコマンドを使っていつでもOriginプロジェクトファイルに追加することができます。</li></ul></li>
<li> 保存するためのオプションを選択したら、<b>単一ASCIIインポート</b>ボタン<a class="image"><img alt="Button Import Single ASCII.png" src="../images/Analysis_Templates/Button_Import_Single_ASCII.png" width="23"  /></a>をクリックして、\Samples\Curve Fitting\Linear Fit.datを再インポートすることで分析テンプレートのデモを見ることができます。  このファイルがアクティブワークシートにインポートされ、カーブフィットが実行されて、<b>FitLinear</b> および <b>FittedValues</b>ワークシートに結果が書き出されます。 </li></ol>
<table class="note">
<tr>
<td>
<p><b>上級ユーザへの注意：</b>分析テンプレートの操作をユーザ定義のXファンクションで実行し、テンプレートを<b>OGW(U)</b>で保存し、それを別のユーザと共有する場合、Xファンクションを作成するときに「<b>プロジェクト内に保存</b>」(<b>Xファンクションビルダ</b> &gt; <b>ツリービュー</b>)にチェックを付ける必要があります。 
</p>
</td></tr></table>
<h2><a name="Other_Materials"></a><span class="mw-headline">その他</span></h2>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Analysis_Templates/Tutorial_icon.png" width="57"  border="0" />
	</td>
	<td><p><a class="external text" href="../../Tutorial/Tutorial/Importing_Multiple_Files_into_Workbooks_Cloned_from_Active_Workbook.html">アクティブなワークブックからクローン化したワークブックに、複数ファイルをインポートする</a>チュートリアルでは、分析テンプレートとして現在のワークブックを使って、複数ファイルをバッチ処理する操作方法を説明しています。
</p><p><a class="external text" href="../../Tutorial/Tutorial/Creating_and_Using_Analysis_Templates.html">分析テンプレートの作成と使用</a>のチュートリアルで、分析テンプレート使用のクイックスタートを提供しています。
</p><p><a class="external text" href="../../Tutorial/Tutorial/Batch_Processing_with_Word_Template_for_Reporting.html">レポート用Wordテンプレートでのバッチ処理</a>のチュートリアルでは、Wordテンプレートと分析テンプレートを使って、Word/PDFレポートを作成する方法を、ひとつずつ説明しています。
</p><p><br />
</p></td></tr></table>

    