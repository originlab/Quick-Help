<h1 class="firstheading">2D補間/補外</h1><p class='urlname' style='display: none'>Math-2D-Inter-Extrapolate</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Overview"><span class="tocnumber">1</span> <span class="toctext">概要</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Interpolate_From_XY"><span class="tocnumber">1.1</span> <span class="toctext">XYからの補間</span></a>
<ul>
<li class="toclevel-3 tocsection-3"><a href="#To_Interpolate_Z_from_XY"><span class="tocnumber">1.1.1</span> <span class="toctext">XYからZを補間するには</span></a></li>
<li class="toclevel-3 tocsection-4"><a href="#Dialog_Options_for_Interpolate_Z_from_XY"><span class="tocnumber">1.1.2</span> <span class="toctext">XYからZを補間するためのダイアログオプション</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-5"><a href="#2D_Interpolation_on_Matrix"><span class="tocnumber">1.2</span> <span class="toctext">行列の2D補間</span></a>
<ul>
<li class="toclevel-3 tocsection-6"><a href="#To_Perform_2D_Interpolation_on_Matrix"><span class="tocnumber">1.2.1</span> <span class="toctext">行列で2D補間するには</span></a></li>
<li class="toclevel-3 tocsection-7"><a href="#Dialog_Options_for_2D_Interpolation_on_Matrix"><span class="tocnumber">1.2.2</span> <span class="toctext">行列で2D補間するためのダイアログオプション</span></a></li>
<li class="toclevel-3 tocsection-8"><a href="#Algorithm_for_Interpolation_on_Matrix"><span class="tocnumber">1.2.3</span> <span class="toctext">行列の補間のアルゴリズム</span></a></li>
<li class="toclevel-3 tocsection-9"><a href="#References"><span class="tocnumber">1.2.4</span> <span class="toctext">参考文献</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>

<h2><a name="Overview"></a><span class="mw-headline">概要</span></h2>
<p>2D補間/補外を使用すると、既存のXYZデータに対しての特定のXYデータセットの補間/補外や、特定の行列オブジェクトに対しての補間/補外が可能です。
</p>
<h3><a name="Interpolate_From_XY"></a><span class="mw-headline">XYからの補間</span></h3>
<p><a  class="image"><img alt="InterpolateZfromXY.png" src="../images/2D_Interpolate_Extrapolate/400px-InterpolateZfromXY.png" width="400"   /></a><br /><br />
<b>XYからZを補間</b>ツールを使用すると、補間/補外のためにXY値のセットを指定できます。これにより、不等間隔のXYデータセットの2D補間/補外における追加の自由度を提供します。Originは、XYからZを補間するための8つの補間手法をサポートしています：<b>近傍</b>、<b>ランダムKriging法</b>、<b>ランダムRenka Cline法</b>、<b>ランダムShepard法</b>、<b>ランダムTPS法</b>、<b>スプライン</b>、<b>三角</b>、<b>加重平均法</b>
</p>
<h5><a name="To_Interpolate_Z_from_XY"></a><span class="mw-headline">XYからZを補間するには</span></h5>
<ol><li>入力データを含むワークブックをアクティブにします。</li>
<li>メニューから<b>解析：数学：XYからZを補間</b>を開きます。すると、<a class="external text" href="../../XFunction/X-Function/Interp2.html">interp2</a>ダイアログボックスが開きます。 </li>
<li> 入力オプションを設定して、<b>OK</b>をクリックします。<b>interp2</b>Xファンクションが呼び出されて計算を実行します。</li></ol>
<p><br />
</p>
<h4><a name="Dialog_Options_for_Interpolate_Z_from_XY"></a><span class="mw-headline">XYからZを補間するためのダイアログオプション</span></h4>
<p>XYからZを補間するためのダイアログコントロールの詳細については、X functionのドキュメント<a class="external text" href="../../XFunction/X-Function/Interp2.html">interp2</a>を参照してください。
<br /><br />
</p>
<h3><a name="2D_Interpolation_on_Matrix"></a><span class="mw-headline">行列の2D補間</span></h3>
<p><a  class="image"><img alt="2DInterpolationOnMatrix.png" src="../images/2D_Interpolate_Extrapolate/2DInterpolationOnMatrix.png" width="323"  /></a><br /><br />
2次元の補間/補外は、Originの行列に保存されているデータに対しても実行可能です。Originは、行列を補間するための5つの補間手法をサポートしています：<b>近傍</b>、<b>Bilinear</b>、<b>Bicubic</b>、<b>スプライン</b>、<b>Biquadratic</b>XとYの補間出力範囲を指定することも可能です。
</p>
<h5><a name="To_Perform_2D_Interpolation_on_Matrix"></a><span class="mw-headline">行列で2D補間するには</span></h5>
<ol><li>入力データを含む行列をアクティブにします。</li>
<li>メニューから、<b>解析：数学：2D補間/補外</b>を選択します。minterp2ダイアログボックスが開きます。 </li>
<li> 入力オプションを設定して、<b>OK</b>をクリックします。<a class="external text" href="../../XFunction/X-Function/Minterp2.html">minterp2</a>Xファンクションが呼び出されて計算を実行します。</li></ol>
<h4><a name="Dialog_Options_for_2D_Interpolation_on_Matrix"></a><span class="mw-headline">行列で2D補間するためのダイアログオプション</span></h4>
<table class="dialogcontroltable">

<tr>
<th><b>再計算</b>
</th>
<td>
<p>分析結果の再計算の設定を変更します。
</p>
<ul><li><b>なし</b> </li>
<li><b>自動</b> </li>
<li><b>手動</b>  </li></ul>
<p>詳細情報は、 <a class="external text" href="../../UserGuide/UserGuide/Recalculating_Analysis_Results.html">分析結果の再計算</a>をご覧下さい。
</p>
</td></tr>
<tr>
<th>入力行列
</th>
<td>
<p>補間/補外を行うデータを含む行列を指定します。
</p><p>範囲の設定に関する詳細は、<a class="external text" href="../../UserGuide/UserGuide/Specifying_Your_Input_Data.html">入力データを指定する</a>をご覧ください。
</p>
</td></tr>
<tr>
<th>手法
</th>
<td>
<p>補間/補外の手法を指定します。 
</p>
<ul><li><b>近傍</b>
<dl><dd>最近傍の点を使用して補間</dd></dl></li>
<li><b>Bilinear（共一次補間）</b>
<dl><dd>2次線形補間</dd></dl></li>
<li><b>Bicubic Convolution</b>
<dl><dd>2次キュービック補間</dd></dl></li>
<li><b>スプライン</b>
<dl><dd>2次スプライン補間</dd></dl></li>
<li><b>Biquadratic（共二次補間）</b>
<dl><dd>2次双補間</dd></dl></li>
<li><b>Bicubic Lagrange</b>
<dl><dd>Lagrange多項式を用いた2次補間</dd></dl></li></ul>
</td></tr>
<tr>
<th>列数
</th>
<td>
<p>出力行列の列数を指定します。
</p>
</td></tr>
<tr>
<th>行数
</th>
<td>
<p>出力行列の行数を指定します。
</p>
</td></tr>
<tr>
<th>欠損値の前処理
</th>
<td>
<p>2D補間で欠損値を前処理する方法を指定します
</p>
<dl><dd><b>スキップ</b>
<dl><dd>最初に欠損値をすべて削除してから、補間を実行します。</dd></dl></dd>
<dd><b>Renka Clineで補間 </b>
<dl><dd>Renka Cline: 任意の点P について、P を含む三角形の3つの頂点のそれぞれで、データ値と勾配推定値を使用して補間値を計算します。</dd></dl></dd></dl>
</td></tr>
<tr>
<th>座標
</th>
<td>
<p>出力行列の<a href="../../UserGuide/UserGuide/Matrix_Sheet_Dimensions_and_XY_Coordinates.html" title="ユーザガイド：行列の次数とXY座標値の設定">座標値/XYマッピング</a>を指定します。
</p>
<dl><dd><b>最初のX</b>
<dl><dd>出力行列の最初のX値</dd></dl></dd>
<dd><b>最後のX</b>
<dl><dd>出力行列の最初のX値</dd></dl></dd>
<dd><b>最初のY</b>
<dl><dd>出力行列の最初のY値</dd></dl></dd>
<dd><b>最後のY</b>
<dl><dd>出力行列の最後のY値</dd></dl></dd></dl>
</td></tr>
<tr>
<th>出力行列
</th>
<td>
<p>補間/補外したデータの出力行列を指定します。
</p>
</td></tr></table>
<h4><a name="Algorithm_for_Interpolation_on_Matrix"></a><span class="mw-headline">行列の補間のアルゴリズム</span></h4>
<p><b>近傍（最近傍）補間:</b>
</p><p>最も近いグリッドポイントを使用して補間値を計算します。
</p><p><b>多項式補間:</b>
</p><p><b>Bilinear</b>、<b>Biquadratic</b>、<b>Bicubic</b>、<b>Bicubic Lagrange</b>の手法があり、同じように動作します。例えば、Biquadratic 補間法で 点<img src="../images/2D_Interpolate_Extrapolate/math-c97cc0a129342152d901ad67de39c031.png" title="P(x,y)\!" alt="P(x,y)\!" class="tex"/>における値を計算するには、最初に、データポイント<img src="../images/2D_Interpolate_Extrapolate/math-1d52943387a339b16f3993f2e5d6092d.png" title="P_{(i,i)}\!" alt="P_{(i,i)}\!" class="tex"/>, <img src="../images/2D_Interpolate_Extrapolate/math-c0309cf8d1395bb0c49233821e578975.png" title="P_{(i,i+1)}\!" alt="P_{(i,i+1)}\!" class="tex"/>, <img src="../images/2D_Interpolate_Extrapolate/math-4369012a5b5764f77697b10385b9619f.png" title="P_{(i,i+2)}\!" alt="P_{(i,i+2)}\!" class="tex"/>に基づいて、1Dの二次補間を垂直に実行して<img src="../images/2D_Interpolate_Extrapolate/math-ee7148e71fba7eb438b11e7e75cb4793.png" title="p_i^{\prime }" alt="p_i^{\prime }" class="tex"/>を作成し、同じ<img src="../images/2D_Interpolate_Extrapolate/math-301530a7f5da08f6e75622d6438fbd91.png" title="y\!" alt="y\!" class="tex"/>値を持つ<img src="../images/2D_Interpolate_Extrapolate/math-301530a7f5da08f6e75622d6438fbd91.png" title="y\!" alt="y\!" class="tex"/>を生成します。そして <img src="../images/2D_Interpolate_Extrapolate/math-de082b0d33d08a600072c70086fedc47.png" title="P_{i+1}^{\prime }" alt="P_{i+1}^{\prime }" class="tex"/> と <img src="../images/2D_Interpolate_Extrapolate/math-2c3fe365dc042b89e824fcaf52236ea1.png" title="P_{i+2}^{\prime }" alt="P_{i+2}^{\prime }" class="tex"/> を計算します。値 <img src="../images/2D_Interpolate_Extrapolate/math-76254aef32e50426815bd4683bfbb998.png" title="p_{i+1}^{\prime }" alt="p_{i+1}^{\prime }" class="tex"/>, <img src="../images/2D_Interpolate_Extrapolate/math-76254aef32e50426815bd4683bfbb998.png" title="p_{i+1}^{\prime }" alt="p_{i+1}^{\prime }" class="tex"/>, <img src="../images/2D_Interpolate_Extrapolate/math-56cfd58f2d00b4200a28b465046def68.png" title="p_{i+2}^{\prime }" alt="p_{i+2}^{\prime }" class="tex"/>は、<img src="../images/2D_Interpolate_Extrapolate/math-159f12ce9148954f5f1c7dedd3def78f.png" title="P\!" alt="P\!" class="tex"/>を通る直線を定義します。次に、1Dの二次補間を水平に実行し、<img src="../images/2D_Interpolate_Extrapolate/math-159f12ce9148954f5f1c7dedd3def78f.png" title="P\!" alt="P\!" class="tex"/>における値を計算します。
</p>
<dl><dd><a  class="image"><img alt="2D interpolation Algorithm.gif" src="../images/2D_Interpolate_Extrapolate/2D_interpolation_Algorithm.gif" width="317"  /></a></dd></dl>
<p>Bilinear、Biquadratic、Bicubic、Bicubic Lagrange 法の違いは、 次数の異なる多項式を使うことです。次数 <i>n</i>個の点を通る次数 <i>n</i>-1の補間多項式は、
</p><p><img src="../images/2D_Interpolate_Extrapolate/math-c12dedab516f392f6755fdfca9d61331.png" title="P(x) = \cfrac{(x-x_1)(x-x_2)\cdots (x-x_{n-1})}{(x_0-x_1)(x_0-x_2)\cdots (x_0-x_{n-1})}y_0 " alt="P(x) = \cfrac{(x-x_1)(x-x_2)\cdots (x-x_{n-1})}{(x_0-x_1)(x_0-x_2)\cdots (x_0-x_{n-1})}y_0 " class="tex"/>
<img src="../images/2D_Interpolate_Extrapolate/math-e9663202bdbad31bfd18f2f0c48e60cb.png" title="+\cfrac{(x-x_1)(x-x_2)\cdots (x-x_{n-1})}{(x_1-x_1)(x_1-x_2)\cdots (x_1-x_{n-1})}y_1+ \cdots" alt="+\cfrac{(x-x_1)(x-x_2)\cdots (x-x_{n-1})}{(x_1-x_1)(x_1-x_2)\cdots (x_1-x_{n-1})}y_1+ \cdots" class="tex"/> 
<img src="../images/2D_Interpolate_Extrapolate/math-591c278aef54cab2d0a0ff050a2eaa2b.png" title="+ \cfrac{(x-x_1)(x-x_2)\cdots (x-x_{n-1})}{(x_{n-1}-x_1)(x_{n-1}-x_2)\cdots (x_{n-1}-x_{n-1})}y_{n-1}" alt="+ \cfrac{(x-x_1)(x-x_2)\cdots (x-x_{n-1})}{(x_{n-1}-x_1)(x_{n-1}-x_2)\cdots (x_{n-1}-x_{n-1})}y_{n-1}" class="tex"/> 
<br /><br />
<b>スブライン補間:</b>
</p><p>この方法は、次式によるbicubicスプライン <img src="../images/2D_Interpolate_Extrapolate/math-bfe54647b6c8b76b2ae64eff5ad8a4dd.png" title="s(x,y)\!" alt="s(x,y)\!" class="tex"/>の値を計算します：
</p><p><img src="../images/2D_Interpolate_Extrapolate/math-af680a713f45eca2f76d3a987d33a580.png" title="s(x,y)=\sum_{i,j} c_{ij}M_i(x)N_j(y)\,\!" alt="s(x,y)=\sum_{i,j} c_{ij}M_i(x)N_j(y)\,\!" class="tex"/>
</p><p><img src="../images/2D_Interpolate_Extrapolate/math-91a600ad034735ce3ad751b68829a8de.png" title="M_i(x)\!" alt="M_i(x)\!" class="tex"/>と<img src="../images/2D_Interpolate_Extrapolate/math-4f77311a720eb44d154037d4d3f0a915.png" title="N_j(y)\!" alt="N_j(y)\!" class="tex"/>は正規化した3次B-スプラインを指し、<img src="../images/2D_Interpolate_Extrapolate/math-a7048e01820bfccf6ad70659c5dc2e91.png" title="c_{ij}\!" alt="c_{ij}\!" class="tex"/>はスプラインの定数です。 
</p><p>2次スプライン補間についての詳細は、NAG関数のドキュメント<a class="external text" href="http://www.originlab.com/pdfs/nagcl09/manual/pdf/e02/e02dec.pdf" target="_blank">e02dec</a>をご覧ください。
</p>
<h4><a name="References"></a><span class="mw-headline">参考文献</span></h4>
<ol><li> Willian H. Press, etc. <i>Numerical Recipes in C++, 2<sup>nd</sup> Edition</i>.Cambridge University Press.(2002)</li></ol>







    