<h1 class="firstheading">(作図の詳細)『ドロップライン』タブ</h1><p class='urlname' style='display: none'>PD-Dialog-DropLine-Tab</p>
<p><br />
プロットシンボルを含むどの2Dデータプロットでも、プロットのシンボルを組み合わせてドロップラインを追加できます。また、3D散布図やトラジェクトリグラフでも任意の平面へ追加できます。 
</p>
<table class="noborder">
<tr>
<td> <div style="text-align: center;">
<p><b>2Dグラフ</b>
</p>
</div>                                    
</td>
<td> <div style="text-align: center;">
<p><b>3D散布図、2D/3D三点グラフ</b>
</p>
</div>
</td></tr>
<tr>
<td> <a  class="image"><img alt="Drop Line Tab 2D.png" src="../images/The_(Plot_Details)_Drop_Lines_Tab/400px-Drop_Line_Tab_2D.png" width="492"   /></a>
</td>
<td> <a  class="image"><img alt="Drop Line Tab 3D.png" src="../images/The_(Plot_Details)_Drop_Lines_Tab/400px-Drop_Line_Tab_3D.png" width="462"   /></a>
</td></tr></table>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Direction_Control_for_Drop_Lines"><span class="tocnumber">1</span> <span class="toctext">ドロップラインの方向</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Line_Style_Controls"><span class="tocnumber">2</span> <span class="toctext">線種</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Setting_Drop_Line_Color"><span class="tocnumber">2.1</span> <span class="toctext">ドロップラインの色の設定</span></a>
<ul>
<li class="toclevel-3 tocsection-4"><a href="#Single_Color_for_all_drop_lines"><span class="tocnumber">2.1.1</span> <span class="toctext">
すべてのドロップラインを単色に設定</span></a></li>
<li class="toclevel-3 tocsection-5"><a href="#Different_Colors_By_Points"><span class="tocnumber">2.1.2</span> <span class="toctext">ポイント毎に違う色を設定</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Drop_To_Controls"><span class="tocnumber">3</span> <span class="toctext">ドロップライン</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Arrow_Controls"><span class="tocnumber">4</span> <span class="toctext">矢印の設定</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Show_at_Specified_Points_Only"><span class="tocnumber">5</span> <span class="toctext">指定した点のみを表示</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Data_Points_Display_Control"><span class="tocnumber">6</span> <span class="toctext">データポイントの表示</span></a>
<ul>
<li class="toclevel-2 tocsection-10"><a href="#No_Skipping_Points"><span class="tocnumber">6.1</span> <span class="toctext">ポイントをスキップしない</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Skip_Points_by_Increment"><span class="tocnumber">6.2</span> <span class="toctext">増分でポイントをスキップ</span></a>
<ul>
<li class="toclevel-3 tocsection-12"><a href="#No_Line_Break_for_Skipped_Point.28s.29"><span class="tocnumber">6.2.1</span> <span class="toctext">ポイントのスキップによる線破断なし</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-13"><a href="#Smart_Skip"><span class="tocnumber">6.3</span> <span class="toctext">スマートスキップ</span></a>
<ul>
<li class="toclevel-3 tocsection-14"><a href="#Smart_Skip.28Total_Points_Kept.29"><span class="tocnumber">6.3.1</span> <span class="toctext">スマートスキップ(総保有ポイント数)</span></a></li>
<li class="toclevel-3 tocsection-15"><a href="#Smart_Skip.28.25_of_Points_Skipped.29"><span class="tocnumber">6.3.2</span> <span class="toctext">スマートスキップ(スキップポイントの%)</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-16"><a href="#Smart_Skip_Method"><span class="tocnumber">6.4</span> <span class="toctext">スマートスキップの方法</span></a></li>
</ul>
</li>
</ul>
</div>
<h2><a name="Direction_Control_for_Drop_Lines"></a><span class="mw-headline">ドロップラインの方向</span></h2>
<p>直交座標系の2Dグラフの場合、<b>水平</b>、<b>垂直</b>ドロップラインはオプションです。 
</p><p>2D三点グラフおよび3Dグラフ(3D三点グラフを含む)では、<b>3D散布図</b>の<b>オリジナル</b> と <b>XY/ZX/YZ投影</b>レベルのある<b>ドロップライン</b>タブで<b>X/Y/Z軸に平行</b>なドロップラインを利用できます。<b>オリジナル</b>レベルでは、3方向のドロップライン（X/Y/Z軸に平行）がオプションですが、<b>XY/ZX/YZ 投影</b>レベルでは、そのパネルの軸方向である2方向しか利用できません。例えば、<b>XY投影</b>レベルでは、<b>X</b>と<b>Y</b>軸に平行なドロップラインのみになります。<b>3D三点</b>グラフ の場合、垂直Z 軸(Zh)に平行なドロップラインのみ可能です。対照的に、<b>2D三点</b>グラフ の場合、すべての方向にドロップラインを追加可能です。
</p>
<h2><a name="Line_Style_Controls"></a><span class="mw-headline">線種</span></h2>
<p><b>水平/垂直</b>、または、<b>X/Y/Z 軸に平行</b>チェックボックスにチェックを付け、下X軸または左Y軸に、各データポイントからの水平線または垂直線を表示します。それぞれ、<b><b>線種</b></b>、<b><b>太さ</b></b>、<b>色</b>をドロップダウンで選択する事により、変更できます。
</p>
<h3><a name="Setting_Drop_Line_Color"></a><span class="mw-headline">ドロップラインの色の設定</span></h3>
<p><a href="../../UserGuide/UserGuide/Customizing_Data_Plot_Colors.html" title="ユーザガイド：データプロットの色を編集する">データプロットの場合</a>と同じようにカラーチューザーを使用して、ドロップラインの色を個別に指定できます。
</p>
<h4><a name="Single_Color_for_all_drop_lines"></a><span class="mw-headline">すべてのドロップラインを単色に設定</span></h4>
<p><a  class="image"><img alt="Drop Lines Color 01.png" src="../images/The_(Plot_Details)_Drop_Lines_Tab/Drop_Lines_Color_01.png" width="303"  /></a><br />
</p><p><b><b>色</b></b>のドロップダウンリストで<b><b>自動</b></b>が選択されている場合、作図の詳細・<b><b>シンボル</b></b>タブの<b><b>シンボルの色</b></b>または<b><b>縁の色</b></b>で設定されている色を表示します。 
</p><p>希望する色を指定して、現在の方向のすべてのドロップラインに適用できます。ドロップラインにカスタムカラーを定義して使用する場合は、<a href="../../UserGuide/UserGuide/Customizing_Data_Plot_Colors.html#Defining_and_Using_Custom_Colors" title="ユーザガイド：データプロットの色を編集する">このページ</a>を参照してください。
</p>
<h4><a name="Different_Colors_By_Points"></a><span class="mw-headline">ポイント毎に違う色を設定</span></h4>
<p><a  class="image"><img alt="Drop Lines Color 02.png" src="../images/The_(Plot_Details)_Drop_Lines_Tab/Drop_Lines_Color_02.png" width="335"  /></a><br />
</p><p>カラーチューザーのポイント毎サブタブでは、<a href="../../UserGuide/UserGuide/Using_a_Dataset_to_Control_Plot_Color.html" title="ユーザガイド:データセットの値を使用してデータプロットの色を制御する">データセットを私用してドロップラインの色を制御</a>できます。
</p><p>滝グラフの縦棒/横棒と同様に、ドロップラインには特別なタイプのデータセットの色の制御方法があります。
</p>
<ul><li> <b>Y値: 正-負</b>: このオプションは、対応するY値が正、負の条件かによって、縦棒/横棒を異なる色で塗ります。（ロリポッププロットのみに利用できます。） </li></ul>
<p><br />
ドロップラインの色について、<b>次のデータプロットにドロップ</b>を選択すると、<b>Y値: 正-負</b>がカラーチューザーのポイント毎サブタブに表示されます。
</p>
<ul><li>次のプロットのY値がこのプロットより大きい場合、ドロップラインの色をカラーリストの最初の色として設定します。</li>
<li> 次のプロットのY値がこのプロットよりも小さい場合、ドロップラインの色をカラーリストの2番目の色として設定します。</li></ul>
<p>滝グラフの<a href="../../UserGuide/UserGuide/Using_a_Dataset_to_Control_Plot_Color.html#Y_Value:_Plus-Minus-Total" title="ユーザガイド:データセットの値を使用してデータプロットの色を制御する">Y値: 正-負-合計</a>のように、この方法を選択すると、2番目のカラーリストの後の色もグレーアウト表示になります。
</p>
<table class="note">
<tr>
<td><b>Note:</b>この特別な色の制御は、他のプロットタイプのグラフオブジェクトでも使用できます。
<ul><li>縦棒グラフの境界と塗り色に対して、<b>Y値: 正-負</b>がカラーチューザのポイント毎サブタブに表示されます。選択すると：
<ul><li>Yの値がカスタムの追加線Y =より大きい場合、カラーリストの最初の色を使用します。</li>
<li>Yの値がカスタムの追加線Y =より小きい場合、カラーリストの2番目の色を使用します。</li></ul></li>
<li>散布図と線+シンボルグラフのシンボルの色（シンボルの境界線、シンボルの塗り色）で、垂直または水平のドロップライン（一方向のみ）があり、ドロップ先が次のプロットに設定されていない場合、
<b>Y値: 正-負</b>がカラーチューザーのポイント別サブタブに表示されます。選択すると： 
<ul><li>Yの値が基線（軸またはカスタム追加線）よりも大きい場合、最初の色を使用します。</li>
<li>Yの値が基線（軸またはカスタム追加線）よりも小さい場合、二番目の色を使用します。</li></ul></li></ul>
</td></tr></table>
<h2><a name="Drop_To_Controls"></a><span class="mw-headline">ドロップライン</span></h2>
<p>ドロップダウンリストを使って、現在のドロップラインにつなぐ線（軸や追加線）や曲面（軸パネルや3Dデータの曲面）を指定します。
</p><p>直交座標系の<b>2D散布図/折れ線グラフ</b>には、ドロップダウンリストにある4つのオプションが選択可能です。 
</p>
<ul><li><b>自動</b>: この項目は、デフォルトでドロップラインを左Yと下X軸に引きます。</li>
<li><b>X/Y=軸の開始</b>: <b>X/Y=<i>最小</i></b>になるように、左Y軸と下X軸にドロップラインを引きます。</li>
<li><b>X/Y=軸の終了</b>: <b>X/Y=<i>最大</i></b>になるように、左Y軸と下X軸にドロップラインを引きます。</li>
<li><b>X/Y=カスタム追加線</b>：<i>X/Y=カスタム値</i>になるように<a href="../../UserGuide/UserGuide/Grids_2.html#Additional_Lines" title="ユーザガイド：グリッド線2">カスタム追加線</a>を引きます。追加線がない場合、ドロップラインは<b>自動</b>になります。 </li>
<li><b>次のデータプロット</b>：ドロップラインを同じX値で次のプロットにドロップします。<b>垂直</b>グループにあるこの項目は、<a href="../../UserGuide/UserGuide/Lollipop_Plot.html" title="ユーザガイド：ロリポッププロット">ロリポッププロット</a>ではデフォルトで選択されます。</li></ul>
<p><br />
ただし、<b>2D三点</b>グラフ の場合、すべての方向にドロップラインを追加可能です。 
</p>
<ul><li> <b>X軸に平行</b>なドロップラインの場合、<b>Y</b>や<b>X</b>を選択してどの軸にドロップラインを引くのかを指定できます。</li>
<li> <b>Y軸に平行</b>なドロップラインの場合、<b>X</b>や<b>Z </b>を選択してどの軸にドロップラインを引くのかを指定できます。</li>
<li> <b>Z軸に平行</b>なドロップラインの場合、<b>X</b>や<b>Y</b>を選択して度の軸にドロップラインを引くのかを指定できます。</li></ul>
<p><br />
直交座標系の<b>3D散布図/トラジェクトリグラフ</b>には、ドロップダウンリストにある4つのオプションが選択可能です。 
</p>
<ul><li><b>自動</b>: デフォルトでこの項目が選択されていて、<b>X=<i>最小</i>/Y=<i>最大</i>/Z=<i>最小</i></b>面にドロップラインを引きます。</li>
<li><b>X/Y/Z=軸開始面</b>: <b>X/Y/Z=<i>最小</i></b>になるように、YZ/XZ/XY面にドロップラインを引きます。</li>
<li><b>X/Y/Z=軸終了面</b>: <b>X/Y/Z=<i>最大</i></b>になるように、YZ/XZ/XY面にドロップラインを引きます。</li>
<li><b>曲面</b>:3Dデータから作成される曲面にドロップラインを引きます。曲面がない場合、ドロップラインは<b>自動</b>になります。</li></ul>
<p><b>3D三点散布図</b>の場合、垂直Z軸(Zh)に沿ったドロップラインを追加できる<b>Z軸に平行</b>なもののみ可能です。
</p>
<h2><a name="Arrow_Controls"></a><span class="mw-headline">矢印の設定</span></h2>
<p>直交座標系の2D<b>散布図/折れ線</b>グラフの場合、ドロップラインの最後に矢印を表示できます。
</p><p>矢印を表示する場合は、<b>矢印の形状</b>、<b>矢印の太さ</b>、<b>矢印の長さ</b>を指定します。矢印の太さと長さの単位はポイントです。
</p><p>三点グラフと3Dグラフの場合、ドロップラインの最後に矢印を表示できません。
</p>
<h2><a name="Show_at_Specified_Points_Only"></a><span class="mw-headline">指定した点のみを表示</span></h2>
<p>特別なデータポイントまたは特別なX値でドロップラインを追加できます。 
</p><p>ここでは、以下の5つのシンタックスが使用できます。
</p>
<ul><li> スペース区切りで行番号を入力します。例えば<i><b>1 3 5</b></i> とすると、1、3、5行でドロップラインを表示します。</li>
<li> 開始と終了の行番号、スキップするポイントの数を指定します。例えば、<i><b>2:0:5</b></i> と入力すると、2行目から最後の行までの範囲で、1行のデータをドロップラインを表示し、5行スキップします。</li>
<li> <b>x=</b>または<b>y=</b>の後にスペース区切りで、X/Y値を入力します。例えば、<i><b>x=3.5 7.8</b></i> と入力すると、X値が3.5と7.8の位置で、<i><b>y=5.3 8.9 10.5</b></i>と入力すると、Y値が5.3と8.9と10.5の位置でドロップラインを表示します。</li>
<li> 他の列にある行番号をドロップダウンリストから選択します。例えば、<i><b>[Book1]sheet2!col(A)</b></i> とすると、選択した列で指定された行番号におけるドロップラインを表示します。</li>
<li> 他の列にあるX/Y値をドロップダウンリストから選択し、範囲表記の前に<b>x=</b>または<b>y=</b>を付けます。例えば、 <i><b>x=[Book1]sheet2!col(A)</b></i> とすると、選択した列で指定されたX値におけるドロップラインを表示します。</li></ul>
<p>指定したX/Y値でドロップラインを追加した場合、指定したX/Y値にデータポイントがない場合、最も近いデータポイント間の補間した接続線で対応する値を見つけ、ドロップラインを表示します。<a href="../../UserGuide/UserGuide/The_(Plot_Details)_Line_Tab.html#Connect" title="ユーザガイド:(作図の詳細)グラフの線タブ"><b>接続線</b></a>が<b>直線</b>のときのみ、ドロップラインをX/Y値によって指定できます。下図にサンプルを示します。
</p><p><a  class="image"><img alt="Drop Lines SpecifiedValues.png" src="../images/The_(Plot_Details)_Drop_Lines_Tab/700px-Drop_Lines_SpecifiedValues.png" width="705"   /></a>
</p>
<h2><a name="Data_Points_Display_Control"></a><span class="mw-headline">データポイントの表示</span></h2>
<p>ドロップライン表示の際にデータポイントをどのようにスキップするか指定します。 <br />
</p>
<h3><a name="No_Skipping_Points"></a><span class="mw-headline">ポイントをスキップしない</span></h3>
<p>ポイントをスキップせず、全データポイントが独自のドロップラインを保有します。このコントロールグループのデフォルトの選択です。
</p>
<h3><a name="Skip_Points_by_Increment"></a><span class="mw-headline">増分でポイントをスキップ</span></h3>
<p>ドロップダウンリストで<b>増分でポイントをスキップ</b>を選択するとデータポイントの頻度を表示でき、頻度をテキストボックスに入力できます。この設定は、データプロットの<b>ドロップライン</b>、<b>シンボル</b>、<b>エラーバー</b>、および<b>データラベル</b>の表示にも影響します。ベクトルグラフの場合、散布点がスキップされるとベクトルも非表示になります。3D散布図の投影の場合、ポイントスキップオプションは非表示になり、投影は元のプロットの設定に従ってポイントをスキップします。
</p><p>ポイントスキップテキストボックスに<i>n</i> が入力される場合、<i>n</i> ポイントの内最初の1つだけが表示されます。残りの<i>n-1</i>つのポイントはスキップされます。しかし、最後のデータポイントは常に表示されます。最後のポイントを非表示にしたい場合、<a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#S">@SMEP</a> = 0に設定します。  <i>n</i> は2以上の整数で指定します。<i>n</i> = 0 または 1の場合、ポイントはスキップされません。 
</p>
<h4><a name="No_Line_Break_for_Skipped_Point.28s.29"></a><span class="mw-headline">ポイントのスキップによる線破断なし</span></h4>
<p>線+シンボルグラフで<a href="../../UserGuide/UserGuide/The_(Plot_Details)_Line_Tab.html#Symbol.2FLine_interface" title="ユーザガイド:(作図の詳細)グラフの線タブ"><b>シンボルとの隙間</b></a>がチェックされている場合、 <b>ポイントのスキップによる線破断なし</b> チェックボックスが表示され、ポイントがスキップされた場合に軸破断するかどうかを指定できます。これを選択すると、データポイントがスキップされても、線は連続したままになります。<br />
<a  class="image"><img alt="Drop Lines No Line Break Skipping.png" src="../images/The_(Plot_Details)_Drop_Lines_Tab/650px-Drop_Lines_No_Line_Break_Skipping.png" width="652"   /></a>
</p>
<h3><a name="Smart_Skip"></a><span class="mw-headline">スマートスキップ</span></h3>
<p><b>スマートスキップ</b>オプションの何れかを選択すると、データ密度と曲線形状に基づいたスマートな演算処理を使用してデータ ポイントをスキップできます。
</p>
<h4><a name="Smart_Skip.28Total_Points_Kept.29"></a><span class="mw-headline">スマートスキップ（総保有ポイント数）</span></h4>
<p>スキップ後に保持されるデータポイントの合計を指定することで、データポイントをスマートスキップします。
</p>
<h4><a name="Smart_Skip.28.25_of_Points_Skipped.29"></a><span class="mw-headline">スマートスキップ（スキップポイントの%）</span></h4>
<p>すべてのデータポイントに対する割合でスキップするデータポイントの数を指定することで、データポイントをスマートスキップします。
</p>
<h3><a name="Smart_Skip_Method"></a><span class="mw-headline">スマートスキップの方法</span></h3>
<p>さまざまな曲線の形状とデータ密度に基づいて、データポイントをスキップする方法が複数あります。
</p>
<ul><li><b>最大三角形</b>: 中点付近の点を見つけます。この点(1)は、始点と終点を含むエリア内で最大の三角形となります。次に、点1は曲線全体を2つのセグメントに分割し、各セグメントで点1を見つけるのと同じ計算を実行して点2と点3を見つけます。セグメント内の点2と点3の三角形の領域を比較し、より広い面積を持つものを保持します。 <br /></li></ul>
<p>このアルゴリズムに従って段階的に検索し、そのたびに、設定されたポイント数に達するまで、最大の三角形エリア (現在大きな面積の三角形と上位レベルのより小さな三角形の間) を持つ点のみが保持されます。
</p>
<ul><li><b>Yしきい値</b>: 検索する点の数に応じて、反復法を使用して Y 軸距離のしきい値を計算します。次に、ポイントをしきい値以下に保ちます。Note: 3D散布図は「Yしきい値」をサポートしていません。</li>
<li><b>データ距離のしきい値</b>: 検索する点の数に応じて、反復法を使用して三角形の面積が大きいしきい値を計算します。次に、ポイントをしきい値以下に保ちます。</li>
<li><b>Douglas Peucker Hull</b>: Douglas&ndash;Peuckerアルゴリズムを使用して、線分で構成される曲線を、ポイントの少ない同様の曲線に間引きます。</li>
<li><b>区分の最大三角形</b>: 曲線をいくつかのセグメントに分割し、最大三角形アルゴリズムに従って点を見つけます。各セグメントでいくつかのデータポイントを見つけます。</li></ul>




    