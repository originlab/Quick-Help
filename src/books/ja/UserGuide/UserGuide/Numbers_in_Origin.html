<h1 class="firstheading">数値の扱いについて</h1><p class='urlname' style='display: none'>Number-in-Origin</p>
<p><br />
以下では、Originで数値がどのように扱われるかについて、一般的な説明をします。
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#How_numbers_are_stored_in_Origin"><span class="tocnumber">1</span> <span class="toctext">Originに数値を保存する方法</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Displayed_cell_value_vs._actual_cell_value"><span class="tocnumber">2</span> <span class="toctext">表示されたセル値 vs 実際のセル値</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Display_of_numbers_that_exceed_cell_width"><span class="tocnumber">3</span> <span class="toctext">セル幅以上の桁数の数値の表示</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Missing_values_in_the_worksheet_or_matrixsheet"><span class="tocnumber">4</span> <span class="toctext">ワークシートまたは行列シートの欠損値</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Decimal.2C_scientific_and_engineering_notation"><span class="tocnumber">5</span> <span class="toctext">10進数、科学的および工学的表記</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Custom_Display_Format"><span class="tocnumber">6</span> <span class="toctext">カスタム表示フォーマット</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Dates_and_Times_in_Origin"><span class="tocnumber">7</span> <span class="toctext">日付と時刻の扱いについて</span></a></li>
</ul>
</div>
<h2><a name="How_numbers_are_stored_in_Origin"></a><span class="mw-headline">Originに数値を保存する方法</span></h2>
<p>Originのワークブックと行列ブックは、次の<b>データ型</b>をサポートしています。
</p>
<table class="simple">
<tr>
<th>ワークブック
</th>
<th>行列ブック
</th>
<th>バイト
</th>
<th>値の範囲
</th></tr>
<tr>
<td>
<p>double
</p>
</td>
<td>
<p>double
</p>
</td>
<td>
<p>8
</p>
</td>
<td>
<p>±1.7E±308 (15ケタ)
</p>
</td></tr>
<tr>
<td>
<p>real
</p>
</td>
<td>
<p>float
</p>
</td>
<td>
<p>4
</p>
</td>
<td>
<p>±3.4E±38 (7ケタ)
</p>
</td></tr>
<tr>
<td>
<p>short
</p>
</td>
<td>
<p>short
</p>
</td>
<td>
<p>2
</p>
</td>
<td>
<p>-32,768から32,767
</p>
</td></tr>
<tr>
<td>
<p>long
</p>
</td>
<td>
<p>int
</p>
</td>
<td>
<p>4
</p>
</td>
<td>
<p>-2,147,483,648から2,147,483,647
</p>
</td></tr>
<tr>
<td>
<p>char
</p>
</td>
<td>
<p>char
</p>
</td>
<td>
<p>1
</p>
</td>
<td>
<p>-128から127
</p>
</td></tr>
<tr>
<td>
<p>byte
</p>
</td>
<td>
<p>char, unsigned
</p>
</td>
<td>
<p>1
</p>
</td>
<td>
<p>0から255
</p>
</td></tr>
<tr>
<td>
<p>ushort
</p>
</td>
<td>
<p>short, unsigned
</p>
</td>
<td>
<p>2
</p>
</td>
<td>
<p>0から65,535
</p>
</td></tr>
<tr>
<td>
<p>ulong
</p>
</td>
<td>
<p>int, unsigned
</p>
</td>
<td>
<p>4
</p>
</td>
<td>
<p>0から4,294,967,295
</p>
</td></tr>
<tr>
<td>
<p>complex
</p>
</td>
<td>
<p>complex
</p>
</td>
<td>
<p>16
</p>
</td>
<td>
<p>±1.7E±308 (15桁)、それぞれ8バイト
</p>
</td></tr></table>
<p>詳細は、次のトピックをご覧ください。
</p>
<ul><li><a href="../../UserGuide/UserGuide/Controlling_How_Numeric_Data_Display_in_the_Worksheet_Column.html" title="ユーザガイド:ワークシート列の数値データの表示を制御する">ワークシート列の数値データの表示を制御する</a></li>
<li><a href="../../UserGuide/UserGuide/Dates_and_Times_in_the_Worksheet.html" title="ユーザガイド:ワークシート内の日付と時刻">ワークシート内の日付と時刻</a></li>
<li><a href="../../UserGuide/UserGuide/Matrix_Object_Data_Properties.html" title="ユーザガイド：行列オブジェクトデータのプロパティ">行列オブジェクトデータのプロパティ</a></li></ul>
<h2><a name="Displayed_cell_value_vs._actual_cell_value"></a><span class="mw-headline">表示されたセル値 vs 実際のセル値</span></h2>
<p>ワークブックや行列ブックにデータをインポートしたり入力したりするとき、Originはユーザが設定した方法で各セルのデータを表示します。  ただし、表示されるのは単にデータ値を<a href="../../UserGuide/Category/Formatting_Worksheet_Data.html" title="カテゴリ：ワークシートデータのフォーマット設定">視覚的に表現したもの</a>であり、実際のデータ値は、前述のようにデータセットの<b><b>データ型</b></b>で許容される完全精度で格納されていることに注意してください。  計算を実行する場合、使用されるのは実際のデータ値であり、表示されている値ではありません。
</p><p>詳細は、次のトピックをご覧ください。
</p>
<ul><li><a href="../../UserGuide/UserGuide/The_(Options)_Numeric_Format_Tab.html" title="ユーザガイド：(オプション) 「数値の表現形式」タブ">(オプション) 「数値の表現形式」タブ</a></li>
<li><a href="../../UserGuide/UserGuide/Controlling_How_Numeric_Data_Display_in_the_Worksheet_Column.html" title="ユーザガイド:ワークシート列の数値データの表示を制御する">ワークシート列の数値データの表示を制御する</a></li>
<li><a href="../../UserGuide/UserGuide/Matrix_Object_Data_Properties.html" title="ユーザガイド：行列オブジェクトデータのプロパティ">行列シートデータの表示オプション</a></li></ul>
<h2><a name="Display_of_numbers_that_exceed_cell_width"></a><span class="mw-headline">セル幅以上の桁数の数値の表示</span></h2>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Numbers_in_Origin/Alert_icon.png" width="57"  border="0" /></td><td><p><b>Origin 2020b</b>より前のバージョンでは、シートセルの文字シーケンスが現在のセル（列）幅で表示できる文字数を超える場合、Originは記号（<b>######</b>）を表示します。これは、MS Excelのワークシートの動作と同じように変更されました。
</p>
	</td>
	</tr>
	</table>
<ul><li> テキスト文字列は、列の幅に関係なく<b>######</b>の表示をトリガーしません。文字列全体を表示するには、列幅を広げる必要があります。</li>
<li> 列幅を超える数値は、最初に最も近い10進数に丸められ、それが完全な整数値を表示するのに十分でない場合に限り、数値の代わりに<b>######</b>が表示されます。</li>
<li> この数値の丸めは、表示上のものです。（前のセクションを参照ください。）内部に保存された値は変更されません。</li>
<li> セルの内容が完全に表示されなかった場合に、<b>######</b>を表示するという以前の動作に変更するには、システム変数<a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#U.2CV.2CW"><b>@WPE = 1</b></a>を設定します。システム変数の値を変更する方法については、<a class="external text" href="../../QuickHelp/QuickHelp/How_do_I_permanently_change_the_value_of_a_system_variable.html">このFAQ</a>を参照してください。</li></ul>
<h2><a name="Missing_values_in_the_worksheet_or_matrixsheet"></a><span class="mw-headline">ワークシートまたは行列シートの欠損値</span></h2>
<p>表計算プログラムが最初にリリースされた頃から、実際の数値ではない特殊な数値－欠損値－を計算の中で扱う必要性が知られています。  Originでは、欠損値の値として内部的にある数値
</p>
<dl><dd><dl><dd><dl><dd>（-1.23456789E-300）を割り当てています。 </dd></dl></dd></dl></dd></dl>
<p>Origin はこの値を特別な値として認識するため、欠損値をワークシートや行列に入力するために使用したり、計算やスクリプトで使用できます (たとえば、何らかの条件を満たさない限り欠損値を返す)。Originはワークシートまたは行列シートの欠損値を &quot; -- &quot;として表示します。  ただし、この表示（出力）と入力した値（入力値）を混同しないでください。  
</p>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Numbers_in_Origin/Alert_icon.png" width="57"  border="0" /></td><td><p><b>Origin 2019</b>より前のバージョンでは、ワークシートの列に値を入力中にセルをスキップした場合、スキップされたセルは欠損値として扱われ、 &quot; <b>--</b> &quot;記号が自動的にセルに入力されました。また、ワークシートのセルを選択してショートカットメニューから<b><b>クリア</b></b>を選択した場合、そのセルは欠損値として扱われました。 
</p><p>Origin 2019以降、スキップまたはクリアされたワークシートのセルに欠損値が入力されることはありません。それらは空白のままになります。2019年以前の動作に戻すには、LabTalkシステム変数<a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#C"><b>@CDB</b></a> = <i>0</i>を設定します（システム変数の値を変更する方法については、<a class="external text" href="../../QuickHelp/QuickHelp/How_do_I_permanently_change_the_value_of_a_system_variable.html">このFAQ</a>を参照してください）。
</p>
	</td>
	</tr>
	</table> 
<p><i><b>欠損値を入力する他の方法：</b></i>
</p>
<ul><li>一般的な目的のために、&quot;<code>Na()</code>&quot;を<a href="../../UserGuide/UserGuide/Displaying_Supporting_Data_in_Worksheet_header_Rows.html#F.28x.29.3D" title="ユーザガイド：ワークシートヘッダ行に表示するサポートデータ"><b>F(x)=</b></a>に入力することによって、<a class="external text" href="../../LabTalk/LabTalk/NA_(function).html">NA() 関数</a>を使用してワークシート列全体に欠損値を手動で入力できます。欠損値を個々のセルに手動で入力するには、&quot;<code>=Na()</code>&quot;と入力します。またはセルを強調表示してCtrl + Deleteキーを押します（@ CDB = 1（デフォルト）の場合）。</li>
<li> 式に欠損値を設定するには（たとえば、<span class="db">列値の設定</span>ダイアログボックスなど）、ゼロで除算するか、<a class="external text" href="../../LabTalk/LabTalk/NA_(function).html">Na() 関数</a>を選択します（<a href="../../UserGuide/UserGuide/Quick_Start_SetColumnValues.html" title="ユーザーガイド：クイックスタート 列の設定">値の設定</a> メニューの<b>関数: その他</b>）。</li>
<li>ワークシートの列の<a href="../../UserGuide/Category/The_Column_Properties_Dialog_Box.html" title="カテゴリ：「列プロパティ」ダイアログボックス"><b>フォーマット</b></a>が<b><b>数値</b></b>に設定されている場合、任意のテキストを入力すると（たとえば、 &quot;missing&quot;）、セルの値に欠損値が設定されます。同様に、数値以外の<b>フォーマット</b>のワークシート列の場合、Originがその列タイプに対して無効と認識するものを入力することで、欠損値を手動で入力できます（たとえば、<b><b>フォーマット = 月</b></b>の列のセルに &quot;13&quot;を入力）。 </li></ul>
<p><br />
</p>
<table class="note">
<tr>
<td>
<p><b>Note:</b>欠損値をサポートするのは<b>データ型 = Double(8)</b>のみです。
</p>
</td></tr></table>
<h2><a name="Decimal.2C_scientific_and_engineering_notation"></a><span class="mw-headline">10進数、科学的および工学的表記</span></h2>
<p>ワークブックまたは行列ブックのデータを<b><b>十進数:1000</b></b>、<b><b>指数:1E3</b></b>、<b><b>工学:1k</b></b>、および<b><b><b>十進数:1,000</b></b></b>の表記で表示することを選択できます。  手動で科学表記法を使用してワークブックまたは行列ブックのデータを表示することを選択する以外に、特定のしきい値を超えると、選択されたデータ表示オプションが上書きされ、科学表記法を使用して数値が自動的に表示されるように指定できます。  デフォルトでは、これらの科学表記法のしきい値は<b>6</b> (上限) と<b>-3</b> (下限) に設定されています。上限値と下限値がそれぞれ6と-3の場合：
</p>
<ul><li><b><b>1x10^-3</b></b>から<b><b>1x10^6</b></b>の範囲の値は、ワークブックまたは行列ブックの<span class="db">プロパティ</span>ダイアログボックス（<b><b>10進数</b></b>、<b><b>指数</b></b>、または<b>工学</b>）の<b><b>表示</b></b>ドロップダウンリストで指定した設定で表示されます。  </li></ul>
<ul><li>データが下限または上限しきい値（1×10^-3未満または1×10^6より大きい）を超える値は、<b>表示</b>ドロップダウンリストの設定に関係なく、<b>科学表記法</b>で表示されます。</li></ul>
<p>科学表記法での自動表示のためのコントロールは、<a href="../../UserGuide/UserGuide/The_(Options)_Numeric_Format_Tab.html" title="ユーザガイド：(オプション) 「数値の表現形式」タブ"><b>オプション</b>ダイアログボックスの<b>数値の表現形式</b>タブ</a>にあります。
</p>
<h2><a name="Custom_Display_Format"></a><span class="mw-headline">カスタム表示フォーマット</span></h2>
<p>ワークシートに表示されるものとは別に、ワークシートデータは<b><b>数値</b></b>データ、<b>テキスト</b>データ、または欠損値として扱われることを認識することが重要です。格納されたデータが数値として認識され<i>ない</i>場合、それらはテキスト文字列または欠損値として扱われます。他に選択肢はありません。
</p>
<ul><li> 表示されているデータがテキストの場合、テキストは文字通りに格納されます。 </li>
<li> データがワークシートの列で正しく設定され、テキスト文字列ではなく<b><a href="../../UserGuide/UserGuide/Dates_and_Times_in_the_Worksheet.html" title="ユーザガイド:ワークシート内の日付と時刻">日時データ</a></b>として扱われるように、データが何らかの数値データとして表示される場合、これらのデータは数値として保存されます。</li></ul>
<p>Originのワークシートはさまざまなカスタムフォーマットをサポートしているため、基本となる数値を保持したまま、数値データを意味のある形式（例： &quot;0.12&quot;や &quot;12％&quot;）で表示できます。これらのカスタムフォーマットを設定する必要があります。または、前述のように、データはテキストまたは欠損値として扱われる<i>可能性があります。</i>
</p><p>次の表は、<b><b>テキストと数値</b></b>の<a href="../../UserGuide/UserGuide/The_(Column_Properties)_Properties_Tab.html#Format" title="ユーザガイド：（列プロパティ）プロパティタブ"><b>形式</b></a>、<b>数値</b>、または<b>日付</b>と<b><b>時刻</b></b>の形式でワークシートデータの列に使用できるカスタム表示形式オプションの種類を簡単にまとめたものです。詳しくは次のリンクをご参照ください。
</p>
<table class="simple">
<tr>
<th> フォーマット
</th>
<th> カスタム表示フォーマットオプション
</th></tr>
<tr>
<td> <b><b>テキストと数値</b></b>、<b>数値</b>
</td>
<td>
<ul><li> 小数桁数、有効桁数、パーセント、小数部、指数、0の埋め込みまたは切り捨て、工学表記法または科学表記法、度 - 分 - 秒、テキストの接頭辞または接尾辞などを表示するためのオプションなどについては、<a class="external text" href="../../LabTalk/LabTalk/Origin_Formats.html">カスタム数値形式</a>を参照してください。</li></ul>
</td></tr>
<tr>
<td> <b>時間</b>
</td>
<td>
<ul><li> Originの時刻のフォーマット指定子を使って、カスタムの時間文字列を指定します。<a href="../../UserGuide/UserGuide/Dates_and_Times_in_the_Worksheet.html#Origin.27s_Date_and_Time_Format_Specifiers" title="ユーザガイド:ワークシート内の日付と時刻">日付と時間のフォーマット指示子</a> をご参照ください。</li></ul>
</td></tr>
<tr>
<td> <b>日付</b>
</td>
<td>
<ul><li> Originの日時の書式指定子を使用して、カスタムの日付または日時の文字列を指定します。<a href="../../UserGuide/UserGuide/Dates_and_Times_in_the_Worksheet.html#Origin.27s_Date_and_Time_Format_Specifiers" title="ユーザガイド:ワークシート内の日付と時刻">日付と時間のフォーマット指示子</a> をご参照ください。</li></ul>
</td></tr></table>
<h2><a name="Dates_and_Times_in_Origin"></a><span class="mw-headline">日付と時刻の扱いについて</span></h2>
<p>前述のように、Originワークシートのデータはテキスト値、数値、または欠損値として扱われます。内部的には、Originは日付データを数値として保存します。これはワークシートに日付や時刻を表示するために使用されるフォーマットとは無関係です。たとえば、ワークシートは「2458283」という数字を「6/14/2018」として表示するように簡単に設定できます。または「2018年6月14日木曜日」、 またはあなたが選んだカスタムの日時フォーマットとして表示します。重要なのは、選択された日付と時刻の形式は、基礎となる数値の視覚的な表現にすぎないということです。
</p><p>日付と時刻に関するOriginのデフォルトの数学システムは、<b>天文ユリウス日</b>に基づいています。  これは、-4712年1月1日（西暦前4713年1月1日）、グリニッジ標準時の12時間を0として定義します。  Originは午前0時と0時間を一致させるために12時間のオフセットを使用します。タイムゾーンの違いやサマータイムなどは考慮されません。
</p><p>このシステムでは、例えば...
</p>
<dl><dd><dl><dd><b>11 June 1998の21:23:01</b> </dd></dl></dd></dl>
<p>...は次のOriginユリウス日数、
</p>
<dl><dd><dl><dd><b>2450975.890984</b>を持っています。</dd></dl></dd></dl>
<p><b><b><b>0.5</b></b></b>（Originの12時間オフセット）を加算すると、天文ユリウス日の<b><b>2450976.390984</b></b>が得られます。
</p><p>日付と時刻のデータを格納および処理するために内部で使用されるのは、<b><b>Originのユリウス日</b></b>です。ワークシートに「日付」または「時刻」データを入力またはインポートするとき、Originはデフォルトでそのようなインポートされた値をテキストとして扱います。日時値がテキストとして扱われていることを視覚的にわかりやすくするために、日時データは左寄せになっています。 
</p>
<dl><dd><dl><dd><a  class="image"><img alt="Date-Time vs Text.png" src="../images/Numbers_in_Origin/Date-Time_vs_Text.png" width="661"  /></a></dd></dl></dd></dl>
<p>Originが日付と時刻のデータを正しい形式で表示し、日付と時刻のデータを算術演算やグラフ作成に使用できるOriginユリウス日番号として内部に保存するには、ワークシート列を正しく設定する必要があります。詳細は、次のトピックをご覧ください。
</p>
<ul><li> <a href="../../UserGuide/UserGuide/The_(Column_Properties)_Properties_Tab.html#Format" title="ユーザガイド：（列プロパティ）プロパティタブ">列のプロパティ、プロパティタブ、書式コントロール</a></li>
<li> <a href="../../UserGuide/UserGuide/Dates_and_Times_in_the_Worksheet.html" title="ユーザガイド:ワークシート内の日付と時刻">ワークシート内の日付と時刻</a>.</li></ul>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Numbers_in_Origin/Tip_icon.png" width="57"  border="0" /></td><td><p>バージョン2019では、Originは2つの代替時間システムを提供しています：(1) 真のユリウス暦の値（0は真夜中の午前0時ではなく正午）、(2) 0は2018年1月1日00:00と定義されている「2018」システム。たとえば、インポートウィザードでデータをインポートすると、2018システムはより高い精度をサポートします（例：<b>カスタム日付フォーマット</b>は&quot;MM&apos;/&apos;dd&apos;/&apos;yyyy HH&apos;:&apos;mm&apos;:&apos;ss&apos;.&apos;######&quot;の形式をサポートします）。以前は、精度は0.0001秒に制限されていました。詳細は、<a href="../../UserGuide/UserGuide/Dates_and_Times_in_Origin.html" title="ユーザガイド:Originでの日付と時刻の扱いについて"><b>Originの日付と時刻</b></a>を参照してください。
</p></td></tr></table>


    