<h1 class="firstheading">ファイル名とヘッダからの変数への抽出</h1><p class='urlname' style='display: none'>ImpWiz-ExtractVar</p>
<p>インポートウィザードでファイルをインポートするとき、ファイル名とヘッダ情報を変数として認識させることができます。情報の抽出については、「<b>変数抽出</b>」ページで編集することができます。変数が抽出されると、今後使用するためにインポート先のページに保存されます。 
</p><p>ファイル名からは、4つの標準的なファイル名変数(パス+ ファイル名. 拡張子、パス、ファイル名.拡張子、ファイル名のみ)が抽出されます。さらに、すべてのヘッダ行 (<a href="../../UserGuide/UserGuide/Customizing_the_ASCII_Import_Options.html#header_Lines" title="ユーザガイド:ASCIIインポートオプションをカスタマイズする">メインヘッダ行とサブヘッダ行</a>)から変数を供給することもできます。インポートウィザードの「<b>ヘッダ行</b>」ページにある『<b>メインヘッダの行数</b>』ボックスと『<b>サブヘッダの行数</b>』にヘッダ行の行数を指定することができます。
</p>
<h2><a name="File_information_storage"></a><span class="mw-headline">ファイル情報の保存</span></h2>
<p>抽出した変数は、目的のページの情報保存オブジェクトに保存されます。変数が保存される場所は2つあります。 
</p>
<ul><li><b>page.info</b>：page.info領域は、最後にインポートしたファイルから抽出した情報のみを保持します。 
</li></ul>
<ul><li><b>バイナリ保存領域：</b>バイナリ保存領域は、ウィンドウにインポートしたすべてのファイルから抽出した変数を保存します。 
</li></ul>
<p>これらの変数は、テキストラベルに挿入したり、「<b>変数の挿入</b>」ショートカットコマンドを使ってワークシートセルに挿入することができます。変数は、コマンドラインから「<b>impinfo</b>」Xファンクションを使うか、次のコマンドを使って、一覧表示することができます。
</p><p>Page.info.user.=
</p>
<table class="note">

<tr>
<td>
<p><b>Note:</b>詳細は、この章の『<a href="../../UserGuide/Category/Accessing_Metadata_Associated_with_Imported_Files.html" title="カテゴリ：インポートしたファイルに関連するメタデータにアクセスする">インポートしたファイルのメタデータにアクセスする</a> 』をご覧ください。
</p>
</td></tr></table>
<h2><a name="Using_variables_for_annotation"></a><span class="mw-headline">変数を注釈に利用する</span></h2>
<p>変数の情報をグラフやワークシートのテキストオブジェクトに入れる方法は数多くあります。この情報の1つの利用法として、グラフの凡例に情報を追加することができます。この例では、データファイルをインポートして、そのファイル名やヘッダ情報の一部を変数に保存するように指定し、そしてファイル名をグラフの凡例に挿入する処理を行います。
</p>
<ol><li>新しいプロジェクトを開始します。 
</li><li>「標準」ツールバーの「<b>インポートウィザード</b><a class="image">」ボタン </a> をクリックしてインポートウィザードを開きます。Button Import Wizard.png
</li><li>『<b>ファイル</b>』リストの右側にある<b>参照 </b>ボタンをクリックします。Samples\Signal processingサブフォルダに移動します。Average Sunspot.datを追加して、<b>OK</b>をクリックします。
</li><li><B>進む</B>をクリックします。
</li><li>「 <b>ヘッダ行</b>」ページで、最初の2行をヘッダ行として設定します。
</li><li><B>進む</B>をクリックします。
</li><li>「<b>変数抽出</b>」ページで、『<b>区切りを使って変数名とその位置を指定する</b>』を選択します。これを選択すると、『<b>変数をページ情報に追加する</b>』が自動的に選択されます。
</li><li><B>進む</B>をクリックします。 
</li><li>「<b>区切り記号による変数抽出</b>」ページでは、『<b>行</b>』ドロップダウンリスト<b>から</b>「FN04 」を選択します。『<b>変数名を入力</b>』テキストボックスに <b>fname</b> と入力します。「<b>追加</b>」をクリックします。  
</li><li><b>完了</b>ボタンをクリックします。ファイルがワークブックにインポートされます。
</li><li>ワークブックの2列目を選択します。<b>「2Dグラフギャラリー」ツールバーの「</b>折れ線ボタン <a class="image"><img alt="Button Line.png" src="../images/Extracting_Variables_from_the_File_Name_and_header/Button_Line.png" width="22" height="23" /></a> をクリックし、<b> </b>プロットを作成します。
</li><li>凡例をダブルクリックすると、編集できるようになります。「<b>%(1)</b>」を削除します。CTRLキーを押したまま、キーボードの <b>H</b> キーを押します。「<b>情報変数の挿入</b>」ダイアログボックスが現れます。
</li><li>「情報変数の挿入」ダイアログボックスで、<b>User.Variables</b>から<b>fname</b>を選択します。「<b>挿入</b>」ボタンをクリックします。グラフの凡例が、<b>Average Sunspot</b>と表示されます。
</li></ol>





    