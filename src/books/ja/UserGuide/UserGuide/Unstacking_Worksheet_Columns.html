<h1 class="firstheading"><b>ワークシート列のアンスタック</b></h1><p class='urlname' style='display: none'>Wks-Unstacking-Cols</p>
<p>この機能は、グループデータを複数列にアンスタックするのに使用します。アンスタックの際に欠損値を1つのグループとしてまとめることができます。また、出力にグループ外の列を追加する事も可能です。 
</p><p>この機能を使うには
</p>
<ol><li> データの入った新しいワークシートを作成します。</li>
<li> メニューから<b>データ整形：列アンスタッキング</b>を選び、<b>wunstackcol</b>ダイアログボックスを開きます。 </li></ol>
<p>実際には、Xファンクション<a class="external text" href="../../XFunction/X-Function/Wunstackcol.html">wunstackcol</a>が呼び出されて操作を行います。 
</p>
<dl><dd><a  class="image"><img alt="UnstackColumnsDialog.png" src="../images/Unstacking_Worksheet_Columns/UnstackColumnsDialog.png" width="849"  /></a></dd></dl>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Dialog_Controls"><span class="tocnumber">1</span> <span class="toctext">ダイアログ操作</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#How_to_Unstack_Columns"><span class="tocnumber">2</span> <span class="toctext">列をアンスタッキングするには</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Examples"><span class="tocnumber">3</span> <span class="toctext">サンプル</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Example_1:_Basic_Unstacking"><span class="tocnumber">3.1</span> <span class="toctext">サンプル1: 基本の使用方法</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Example_2:_Unstacking_by_Date_or_Time"><span class="tocnumber">3.2</span> <span class="toctext">サンプル 2: 日付や時間でアンスタッキングする</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Example_3:_Reorder_Unstacked_Columns"><span class="tocnumber">3.3</span> <span class="toctext">サンプル3: アンスタッキングした列を並び替える</span></a></li>
</ul>
</li>
</ul>
</div>
<h2><a name="Dialog_Controls"></a><span class="mw-headline">ダイアログの設定</span></h2>
<table class="dialogcontroltable">
<tr>
<th>再計算
</th>
<td>
<p>結果を再計算する方法を指定します。詳細は<a href="../../UserGuide/UserGuide/Recalculating_Analysis_Results.html" title="ユーザガイド：分析結果の再計算">分析結果の再計算</a>を確認してください。
</p>
</td></tr>
<tr>
<th>アンスタックされるデータ
</th>
<td>
<p>アンスタックされるデータを指定します。 
</p>
</td></tr>
<tr>
<th>グループ列
</th>
<td>
<p>グループ情報を含む複数のグループ列を、<b><b>グループ列</b></b>ボックスに入力します。このグループに従って列のアンスタックが実行されます。ツールバー<a  class="image"><img alt="Group List Toolbar.png" src="../images/Unstacking_Worksheet_Columns/Group_List_Toolbar.png" width="160"  /></a>の、<b>上へ移動</b><a  class="image"><img alt="Button Group List Move Up.png" src="../images/Unstacking_Worksheet_Columns/Button_Group_List_Move_Up.png" width="16"  /></a>、<b>下へ移動</b><a  class="image"><img alt="Button Group List Move Down.png" src="../images/Unstacking_Worksheet_Columns/Button_Group_List_Move_Down.png" width="13"  /></a>、<b>削除</b><a  class="image"><img alt="Button Group List Remove.png" src="../images/Unstacking_Worksheet_Columns/Button_Group_List_Remove.png" width="14"  /></a>、<b>すべて選択</b><a  class="image"><img alt="Button Group List Select All.png" src="../images/Unstacking_Worksheet_Columns/Button_Group_List_Select_All.png" width="18"  /></a>、<b>選択</b><a  class="image"><img alt="Button Group List Add.png" src="../images/Unstacking_Worksheet_Columns/Button_Group_List_Add.png" width="17"  /></a>ボタンでグループ列の追加や削除、順序変更が可能です。
<br />列の大部分がテキストの場合、グループ列はプロット後にカテゴリーとして設定されます。そのため、簡単に出力列を並び替えることができます。
</p>
</td></tr>
<tr>
<th>オプション
</th>
<td>
<p><b>他の列を含める</b>
</p>
<dl><dd>元のシートのアンスタックしない列を結果シートに含めるかどうかを指定します。 </dd></dl>
<p><b>含める列</b>
</p>
<dl><dd>結果シートに出力するアンスタックしない列のデータ範囲を指定します。これは、<b>他の列を含める</b>にチェックが付いている場合のみ利用できます。 </dd></dl>
<p><b>他の列の値の抽出ルール</b>
</p>
<dl><dd><b>他の列</b>のデータの配置方法を指定します。これは、<b>他の列を含める</b>にチェックが付いている場合のみ利用できます。
<ul><li><b>最長グループ一致</b>
<dl><dd>このオプションは、グループ化変数 (<b>グループ列</b>) の各値の個数が等しく、グループ化されていない変数 (<b>他の列</b>) の各値の個数が等しい場合に使用します。例えば、G1 と G2 の 2 つの列にアンスタックされる6つの個体があるとします。非グループ化変数には、g1、g2、g3 の 3 つの値があります。  このオプションを使用するには、G1とG2にそれぞれ3つの個体があり、グループ化されていない変数のg1に2つの個体、g2に2つ、g3に2 つの個体が必要です。このオプションを選択する前に、<a href="../../UserGuide/UserGuide/Sorting_Worksheet_Data.html#Nested_Sorting" title="ユーザガイド:ワークシートデータのソート">ネストソート</a>を実行する必要があることに<b>注意してください</b> (最初に<b>グループ列</b>で並べ替え、次に<b>他の列</b>で並べ替えます)。</dd></dl></li>
<li><b>全てのグループを統合する</b>
<dl><dd>このオプションは、<b>グループ列</b>のデータと<b>他の列</b>のデータを組み合わせて、アンスタックデータのインデックスとして使用します。そのため、<b>グループ列</b>のデータと<b>他の列</b>のデータの組み合わせが一意である必要があります。</dd></dl></li></ul></dd></dl>
<p><b>欠損データを単一グループとして含める</b>
</p>
<dl><dd>欠損値を一つのグループとするか指定します。 </dd></dl>
</td></tr>
<tr>
<th>出力設定
</th>
<td>
<p><b>出力列のソート</b>
</p>
<dl><dd>出力列をどのようにソートするか指定します。
<ul><li><b>グループ変数</b>
<dl><dd>出力列をグループ変数値で英数字順に並べ替えます。例えば、グループ変数&quot;Make&quot;が2つの値&quot;Acura&quot; と &quot;Buick&quot;を持つとします。アンスタッキング後、列では&quot;Acura&quot;、&quot;Buick&quot;の順で出力されます。</dd></dl></li>
<li><b>アンスタックされるデータ</b>
<dl><dd><b>アンスタックされるデータ</b>の順序を保存します。例えば、<b>アンスタックされるデータ</b>が<i>[Book1]Sheet1!(3,4)</i>の場合を考えます。アンスタックすると、列3データが最初にリストされ、次に列4データがリストされます。<b>アンスタックされるデータ</b>が<i>[Book1]Sheet1!(4,3)</i>の場合は、列4データが最初にリストされ、次に列3データがリストされます。</dd></dl></li></ul></dd></dl>
<p><b>出力ワークシート</b>
</p>
<dl><dd>アンスタックした結果を出力する場所を指定します。 </dd></dl>
<p><b>グループ情報の出力先</b>
</p>
<dl><dd>グループ情報の出力先を指定します。 
<ul><li><b><b>ロングネーム</b></b>
<dl><dd>グループ情報をロングネーム行に出力します。</dd></dl></li>
<li><b>コメント</b>
<dl><dd>グループ情報をコメント行に出力します。 </dd></dl></li>
<li><b>データ列のロングネームに追加する</b>
<dl><dd>グループ情報をロングネーム行に追加します。 </dd></dl></li>
<li><b>ユーザ定義パラメータ</b>
<dl><dd>グループ情報をユーザ定義パラメータ行に出力します。行の名前は<b>グループ情報名の引用元</b>で指定します。</dd></dl></li>
<li><b>カスタム</b>
<dl><dd>すべてのグループ化列に<a class="external text" href="../../LabTalk/LabTalk/Column_Label_Row_Characters.html">ラベルの省略形</a>を入力します。ラベルの数は、グループ列の数と同じにする必要があります。各グループ列の情報は、1つのラベル行に格納されます。たとえば、入力に2つのグループ列がある場合、オプションに<b>LC</b>を入力します。group1の情報がロングネームとして、group2の情報がコメントとして設定されます</dd></dl></li></ul></dd></dl>
<p><b>グループ情報名の引用元</b>
</p>
<dl><dd><b>グループ情報の出力先</b>を<b>ユーザ定義パラメータ</b>に設定したときに利用できるドロップダウンリストです。グループ情報を格納するユーザ定義パラメータ行の名前付けに使用されます。ソースワークシートのグループ列のラベル行から名前を付けます。選択したラベル行には、ユーザ定義パラメータ行の名前用の文字列が必要で、ない場合はエラーメッセージが表示されます。GUIでは、ソースワークシートにそのラベル行が表示されているかに応じて利用可能なオプションが表示されます。
<ul><li><b>ショートネーム</b>
<dl><dd>グループ列のショートネームから</dd></dl></li>
<li><b><b>ロングネーム</b></b>
<dl><dd>グループ列のロングネーム行から</dd></dl></li>
<li><b>単位</b>
<dl><dd>グループ列の単位行から</dd></dl></li>
<li><b>コメント</b>
<dl><dd>グループ列のコメント行から</dd></dl></li></ul></dd></dl>
</td></tr></table>
<h2><a name="How_to_Unstack_Columns"></a><span class="mw-headline">列をアンスタッキングするには</span></h2>
<p><a href="../../UserGuide/UserGuide/Stacking_Worksheet_Columns.html" title="ユーザガイド: ワークシート列のスタッキング">列スタッキング</a>と反対の操作をする機能です。列のアンスタッキングでは、他のアンスタックしていない列をアンスタックした列の結果に追加できます。
</p>
<ul><li><b>アンスタック</b>
<dl><dd>グループデータを複数列にアンスタックします。</dd>
<dd><a  class="image"><img alt="Unstack Without Enable Options.png" src="../images/Unstacking_Worksheet_Columns/Unstack_Without_Enable_Options.png" width="258"  /></a></dd></dl></li>
<li><b>他の列を含めたアンスタック</b>
<dl><dd>非グループデータ列を含めてグループデータを複数列にアンスタックします。
<ul><li><b>最長グループ一致</b>オプションを使用
<dl><dd><a  class="image"><img alt="Unstack With Ungrouped Data.png" src="../images/Unstacking_Worksheet_Columns/Unstack_With_Ungrouped_Data.png" width="343"  /></a></dd></dl></li>
<li><b>全てのグループを統合する</b>オプションを使用
<dl><dd><a  class="image"><img alt="Unstack With Ungrouped Data1.png" src="../images/Unstacking_Worksheet_Columns/Unstack_With_Ungrouped_Data1.png" width="329"  /></a></dd></dl></li></ul></dd></dl></li></ul>
<h2><a name="Examples"></a><span class="mw-headline">サンプル</span></h2>
<h3><a name="Example_1:_Basic_Unstacking"></a><span class="mw-headline">サンプル 1: 基本の使用方法</span></h3>
<p>グループ化データ(&lt;Originインストールフォルダ&gt;\Samples\Statistics\body.dat)を複数列にアンスタッキングするサンプルです。 
</p>
<ol><li><i>&lt;Originインストールフォルダ&gt;\Samples\Statistics\body.dat</i>のファイルを新しいワークブックにインポートします。
<dl><dd><a  class="image"><img alt="Wunstackcol example 1.png" src="../images/Unstacking_Worksheet_Columns/400px-Wunstackcol_example_1.png" width="483"   /></a></dd></dl></li>
<li>列DとEを選択し、<b>ワークシート：列アンスタッキング</b>を選択(またはコマンドウィンドウで <code>wunstackcol -d;</code> を入力)し、<b>wunstackcol</b> ダイアログを開きます。</li>
<li><b>グループ列</b>の項目にある三角形のボタンをクリックし、<b>C(Y): gender</b>を選択します。 </li>
<li><b>オプション</b>で、<b>他の列を含める</b>にチェックを付けます。<b>他の列</b>では、デフォルトの範囲を使用します。</li>
<li><b>他の列の値の抽出ルール</b>ドロップダウンリストで<b>全てのグループを統合する</b>を選択します。</li>
<li><b>出力</b>設定の<b>グループ情報の出力先</b>で<b>ユーザ定義パラメータ</b>を選択して、<b>グループ情報名の引用元</b>で<b>ロングネーム</b>を選択します。他の設定はデフォルトのままです。
<dl><dd><a  class="image"><img alt="Wunstackcol example 2.png" src="../images/Unstacking_Worksheet_Columns/Wunstackcol_example_2.png" width="643"  /></a></dd></dl></li>
<li><b>OK </b>ボタンをクリックし、列をアンスタックします。結果は下図のようになります。
<dl><dd><a  class="image"><img alt="Wunstackcol example 3.png" src="../images/Unstacking_Worksheet_Columns/400px-Wunstackcol_example_3.png" width="535"   /></a></dd></dl></li></ol>
<h3><a name="Example_2:_Unstacking_by_Date_or_Time"></a><span class="mw-headline">サンプル 2: 日付や時間でアンスタッキングする</span></h3>
<p>この例では、日付-時間列で並べられたグループデータを使用します。
</p>
<ol>
<li>ワークブックを空の状態にして、<b>データ: インポート: 単一ASCIIファイル</b>を選び、&lt;Originプログラムディレクトリ&gt;\Samples\Import and Export\Custom Date and Time.datを選択します。</li>
<li>A(X)列の先頭をクリックして列を選択し、<b>列フォーマット</b>を選びます。
<li><b>プロパティ</b>タブを開き、<b>フォーマット</b>を<b>日付</b>に、<b>表示</b>を<b>カスタム表示</b>を選択し、カスタム表示ボックスに以下を入力して<b>OK</b>をクリックします。
<pre>
dd.MM.yyyy HH:mm:ss.##
</pre>
<dl><dd> この操作によって、Originに文字列データを数値として認識させることで数学的処理ができるようになります。</li></dd></dl>
<li>データシートをスクロールして、文字列の時間の部分(<i>HH:mm:ss.##</i> )が9時から始まっていることを確認します。B(Y)列のデータを時間と分ごとのグループに分けるとします。  グループ分けを行うにはまずA(X)列を再選択し、右クリックして<b>列フォーマット</b>を選び、<b>プロパティ</b>タブで<b>フォーマット</b>を<b>時間</b>にし、<b>表示</b>ドロップダウンリストから<i>HH:mm</i>を選択します。<br />
ワークシートは次のようになります。</li>
<p><a  class="image"><img alt="Wunstackcol example 4.png" src="../images/Unstacking_Worksheet_Columns/Wunstackcol_example_4.png" width="326"  /></a><br />
</p>
<li>両方の列をハイライトして、<b>ワークシート: 列アンスタッキング</b>と選択します。</li>
<li><b>グループ列</b>にA(X)を設定します。初期設定のまま、<b>OK</b>ボタンをクリックします。データが<code>HH:mm</code>ごとにグループ分けされ、グループ情報が新しいワークシートの<b>コメント</b>行に表示されます。</li>
<p><a  class="image"><img alt="Wunstackcol example 5.png" src="../images/Unstacking_Worksheet_Columns/Wunstackcol_example_5.png" width="734"  /></a>
</p>
</ol>
<h3><a name="Example_3:_Reorder_Unstacked_Columns"></a><span class="mw-headline">サンプル3: アンスタッキングした列を並び替える</span></h3>
<p>このサンプルでは<b>&lt;Originインストールフォルダ&gt;\Samples\Statistics\automobile.dat</b>の<b>Power</b>列を<b>Make</b>ごとにアンスタッキングします。 
</p>
<ol><li>ファイル <i>&lt;Origin インストールフォルダ&gt;\Samples\audtomobile.dat</i>を新しいワークシートにインポートします。</li>
<li>列Cを選択し、<b>ワークシート：列アンスタッキング</b>を選択し、<b>wunstackcol</b> ダイアログを開きます。</li>
<li><b>グループ列</b>の項目にある三角形のボタンをクリックし、<b>B(Y): Make</b>を選択します。 </li>
<li><b>再計算</b>を<b>自動</b>に変更し、その他はデフォルトのままとします。
<dl><dd><a  class="image"><img alt="Wunstackcol example 6.png" src="../images/Unstacking_Worksheet_Columns/Wunstackcol_example_6.png" width="622"  /></a></dd></dl></li>
<li><b>OK </b>ボタンをクリックし、列をアンスタックします。B列はカテゴリカルに設定されていることに注意してください。</li>
<li><i>UnstackCols1</i>シートの全てのデータを選択し、<b>作図&gt; 複数区分/軸: ラベルから複数パネルを一括作成</b>を選択します。 </li>
<li><b>グループ識別子</b>に<b>コメント</b>を指定します。<b><b>OK</b></b> をクリックして複数パネルグラフを作成します。パネルの並び順は<i>UnstackCol1</i>シートの列の順番に準じています。 </li>
<li>例えば、メーカー名のアルファベット順にパネルを並び替える場合は、元となるワークシートのカテゴリ順を変更することです。<i>automobile</i>シートに戻ります。B列のカテゴリセルのヘッダーをダブルクリックします。 </li>
<li><b>カテゴリー</b>ダイアログで、<b>カテゴリーの編集(追加、削除、任意の順)</b>をチェックします。表のヘッダーをクリックして、カテゴリーをアルファベット順に並び替えます。<b>OK</b>をクリックします。<br /><b>UnstackCols1</b>とグラフ内のパネルの順序が更新されていることを確認してください。</li></ol>




    