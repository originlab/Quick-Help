<h1 class="firstheading">クエリの作成と保存</h1>
<p class="urlname" style="display: none;">ImpDatabase-BuildSave-Query</p>
<p><br /></p>
<div id="toc" class="toc">
<div id="toctitle">
<h2>目次</h2>
</div>
<ol>
<li class="toclevel-1 tocsection-1"><a href="#Connecting_to_a_Datasource"><span class="tocnumber">1</span> <span class="toctext">データソースに接続</span></a>
<ol>
<li class="toclevel-2 tocsection-2"><a href="#Connection_String"><span class="tocnumber">1.1</span> <span class="toctext">接続文字列</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#OBDC_data_source"><span class="tocnumber">1.2</span> <span class="toctext">OBDCデータソース</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#ODBC_driver"><span class="tocnumber">1.3</span> <span class="toctext">ODBCドライバ</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Windows_.22Data_Link_Properties.22_dialog"><span class="tocnumber">1.4</span> <span class="toctext">Windows"データリンクプロパティ"ダイアログ</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#OLE_DB"><span class="tocnumber">1.5</span> <span class="toctext">OLE DB</span></a></li>
</ol>
</li>
<li class="toclevel-1 tocsection-7"><a href="#Building_a_query"><span class="tocnumber">2</span> <span class="toctext">クエリの構築</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Saving_a_query"><span class="tocnumber">3</span> <span class="toctext">クエリの保存</span></a></li>
</ol>
</div>
<h2><a name="Connecting_to_a_Datasource" id="Connecting_to_a_Datasource"></a><span class="mw-headline">データソースに接続</span></h2>
<p>SQLデータをインポートするには、<b>データ：データベースに接続</b>メニューコマンドから開始します。</p>
<ul>
<li>保存された接続（ODS）またはクエリ（ODQ）ファイルを開くには、<b>開く</b>をクリックします。接続が有効な場合、<a href="../../UserGuide/UserGuide/The_SQL_Editor_Dialog_Box.html" title="ユーザガイド：SQLエディタダイアログ"><b>SQLエディタ</b> ダイアログボックス</a>が開きます。</li>
<li>データソースに接続したことが<i>ない</i>場合、接続をセットアップする必要があります。</li>
</ul>
<dl>
<dd>
<ol>
<li><b>新規作成</b>は、<b>データベースコネクタ</b>ダイアログを開きます。</li>
</ol>
<dl>
<dd><a class="image"><img alt="DB database connector dialog.png" src="../images/Building_and_Saving_a_Query/DB_database_connector_dialog.png" width="321" height="258" border="0" /></a></dd>
</dl>
<ul>
<li><b>接続文字列</b>: 指定されたデータソース（ODBCまたはOLE DB）のテキストベースの接続文字列がすでにある場合は、これを選択します。</li>
<li><b>ODBCデータソース</b>:&#160;<b>ODBC データ ソース アドミニストレーター</b>アプレットを使用してODBCデータソースを定義している場合は、これを選択します。</li>
<li><b>ODBCドライバ</b>:&#160;ODBCドライバを使用していて、このデータコネクタインスタンスに適用可能なデータソースを作成したい場合は、これを選択します。</li>
<li><b>Windows"データリンクプロパティ"ダイアログ</b>: OLE DBベースのデータソースなどをSQLサーバーまたはアクセスクライアントライブラリとして使用している場合は、これを選択します。</li>
</ul>
</dd>
</dl>
<h3><a name="Connection_String" id="Connection_String"></a><span class="mw-headline">接続文字列</span></h3>
<p>接続文字列は、既存の接続から新しい接続をすばやく確立するための便利な方法です。</p>
<ol>
<li>ODBCまたはOLE DBデータソースへの有効な接続文字列がすでにある場合は、このオプションを選択して接続文字列を入力します。</li>
<li>接続文字列の認証/ログイン情報が暗号化されている場合は、この情報を再入力するよう求められます。 接続文字列が有効な場合、<a href="../../UserGuide/UserGuide/The_SQL_Editor_Dialog_Box.html" title="UserGuide:The SQL Editor Dialog Box"><b>SQLエディタ</b> ダイアログボックス</a>が開きます。</li>
</ol>
<h3><a name="OBDC_data_source" id="OBDC_data_source"></a><span class="mw-headline">OBDCデータソース</span></h3>
<p>ODBCデータソースへの新しい接続を確立するには、次のオプションを選択します。</p>
<dl>
<dd><a class="image"><img alt="UG database connector dialog.png" src="../images/Building_and_Saving_a_Query/UG_database_connector_dialog.png" width="675" height="357" border="0" /></a></dd>
</dl>
<ol>
<li>データベースコネクタダイアログボックスで、<b>ODBCデータソース</b>を選択して<b>OK</b>をクリックします。</li>
<li><b>データソースの選択(DSN)</b>から、<b>ODBCで接続</b>ダイアログボックス中に接続パラメータ入力します。</li>
</ol>
<h3><a name="ODBC_driver" id="ODBC_driver"></a><span class="mw-headline">ODBCドライバ</span></h3>
<p>ODBCドライバを使用していて、このデータコネクターインスタンスに適用可能なデータソースを作成する場合は、これを選択します。</p>
<dl>
<dd><a class="image"><img alt="DB ODBC Driver.png" src="../images/Building_and_Saving_a_Query/DB_ODBC_Driver.png" width="707" height="407" border="0" /></a></dd>
</dl>
<h3><a name="Windows_.22Data_Link_Properties.22_dialog" id="Windows_.22Data_Link_Properties.22_dialog"></a><span class="mw-headline">Windows"データリンクプロパティ"ダイアログ</span></h3>
<h3><a name="OLE_DB" id="OLE_DB"></a><span class="mw-headline">OLE DB</span></h3>
<dl>
<dd>
<dl>
<dd><a class="image"><img alt="DB Database Connector Data Link Properties dialog.png" src="../images/Building_and_Saving_a_Query/DB_Database_Connector_Data_Link_Properties_dialog.png" width="321" height="258" border="0" /></a></dd>
</dl>
</dd>
</dl>
<ol>
<li>データベースコネクタダイアログボックスで、<b>Windows"データリンクプロパティ"ダイアログ</b>を選択します。</li>
<li><b>プロバイダー</b>タブで、適切なOLE DB Providerを選択し、<b>次へ</b>をクリックして<b>接続</b>タブを開きます。
<p><a class="image"><img alt="DB Data Link Properties.png" src="../images/Building_and_Saving_a_Query/DB_Data_Link_Properties.png" width="421" height="531" border="0" /></a></p>
</li>
<li><b>サーバ名を選択するか入力します</b>。(サーバが表示されない場合、名前を入力します。)</li>
<li><b>ユーザ名</b>と<b>パスワード</b>を入力します。</li>
<li><b>OK</b> をクリックして、データソースに接続します。(別のタブにあるオプションの指定は任意)</li>
</ol>
<h2><a name="Building_a_query" id="Building_a_query"></a><span class="mw-headline">クエリの構築</span></h2>
<p>データソースと接続すると、<b>SQL エディタ</b>ダイアログボックスの左パネルにオブジェクトリストが表示されます。</p>
<p>テーブルノードをダブルクリックすると、テーブルノードが右側パネルのSQLステートメント編集ボックスに追加されます。または、SQLクエリをSQLステートメントの編集ボックスに直接貼り付けることもできます。</p>
<dl>
<dd><a class="image"><img alt="Sqleditor.png" src="../images/Building_and_Saving_a_Query/Sqleditor.png" width="681" height="538" border="0" /></a></dd>
</dl>
<p>クエリを作成する実例については、<a class="external text" href="http://blog.originlab.com/connecting-to-a-database-and-importing-data" target="_blank"><b>Connecting to a Database and Importing Data</b></a>のOriginLabブログの投稿を参照ください。</p>
<h2><a name="Saving_a_query" id="Saving_a_query"></a><span class="mw-headline">クエリの保存</span></h2>
<p>メニューから、<b>ファイル：アクティブシートに保存</b>を選択するか、<b>ファイル：接続とクエリの保存</b>を選択して、クエリーをワークブックまたはODQファイルに保存できます。 さらに、<b>SQLエディタ</b>ダイアログボックスの<b>インポート</b>ボタンをクリックすると、クエリを目的のワークブックに保存します。</p>
<p>ワークブックにクエリを保存（<b>ファイル：ウィンドウの新規保存</b>）すると、いつでもワークブック上のデータをプレビューして、データをインポートできます。 ワークブックはテンプレートとして保存（<b>ファイル：テンプレートの新規保存</b>）でき、そこにはワークブックのフォーマットに関する情報も保存することができます。 次回テンプレートを開くとき、そこに保存されたカスタマイズしたクエリを使ってフォーマットされたワークブックが表示されます。 左上隅のテンプレートにあるデータベース接続アイコン<a class="image"><img alt="Button database connector icon.png" src="../images/Building_and_Saving_a_Query/Button_database_connector_icon.png" width="19" border="0" /></a>をクリックするだけで、フォーマットされたワークブックにデータソースから取得したデータが入力されます。 アクティブシートに保存されたクエリーを表示または修正するには、データベース接続アイコンをクリックして<b>SQL エディタ</b>を選択します。</p>
<p>保存されたクエリ（ODQ）ファイルを読み込むには、<b>データ：データベースに接続：開く</b>をクリックするか、最近使用した項目で保存されたファイルの1つをクリックします。ODQファイルをロードしたあと、プレビューしたり、アクティブワークシートにインポートできます。 これは、複数のワークブックにクエリを適用する場合に役立ちます。</p>
