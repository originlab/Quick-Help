<h1 class="firstheading">「値の設定」ダイアログボックスに数式を入力する</h1>
<table id="toc" class="toc">
<tr>
<td>
<div id="toctitle">
<h2>内容</h2>
</div>
<ol>
<li class="toclevel-1 tocsection-1"><a href="#Expression_Basics"><span class="tocnumber">1</span> <span class="toctext">数式の基本</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Add_Expressions_only_in_Formula"><span class="tocnumber">2</span> <span class="toctext"><i>列の計算式</i> にのみ式を追加する</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Add_Expressions_only_in_Before_Formula_Scripts"><span class="tocnumber">3</span> <span class="toctext"><i>実行前の処理スクリプト</i>にのみ数式を追加する</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Add_Expressions_in_both_Formula_and_Before_Formula_Scripts"><span class="tocnumber">4</span> <span class="toctext"><i>列の計算式</i> と<i>実行前の処理スクリプト</i> の両方に数式を追加する</span></a></li>
</ol>
</td>
</tr>
</table>
<h2><a name="Expression_Basics" id="Expression_Basics"></a><span class="mw-headline">数式の基本</span></h2>
<p><b style="font-weight: bold;">値の設定</b>ダイアログで使われる計算式は、LabTalkのロジックに従います。計算式には、<a class="external text" href="../../LabTalk/LabTalk/Operators.html#Arithmetic_Operators">算術演算</a>、<a class="external text" href="../../LabTalk/LabTalk/Range_Notation.html">範囲(range)変数</a>、<a class="external text" href="../../LabTalk/Script/LabTalk-Supported_Functions.html">組込のLabTalk関数</a>、<a href="../../UserGuide/UserGuide/Create_a_User_Defined_Function_for_Set_Column_Values.html" title="ユーザガイド:列値の設定を行うためのユーザ定義式を作成する">ユーザ定義関数</a> などを含めることができます。数式を定義する場所が2ケ所あります。</p>
<ul>
<li><b style="font-weight: bold;">計算式</b>1行の数式のみここに入力できます。数式の右側を入力します。</li>
</ul>
<p>Cell(i,j) = <b>c1*sin(i) + c2*cos(j)</b>.</p>
<ul>
<li><b style="font-weight: bold;">Before Formula Scripts</b>.複数行のLabTalkスクリプトをここに入力でき、これは<b>計算式</b>編集ボックスにある計算式を使って列の値がセットされる前に実行されます。</li>
</ul>
<dl>
<dd><a class="image" style="color: #0000ff; text-decoration: underline;"><img alt="SetMatrixValuesPanel.png" src="../images/Entering_Expressions_in_the_Set_Values_Dialog/SetMatrixValuesPanel.png" width="627" height="419" border="0" /></a></dd>
</dl>
<table class="noborder">
<tr>
<td style="vertical-align: top;" width="60"><img src="../images/Entering_Expressions_in_the_Set_Values_Dialog/Tip_icon.png" alt="" width="57" height="57" border="0" /></td>
<td>
<ol>
<li>Originは、<b>関数</b>メニューに数多くの<a class="external text" href="../../LabTalk/Script/LabTalk-Supported_Functions.html">組み込み関数</a>を用意しており、これらを計算式で利用することができます。また、自分で<a href="../../UserGuide/UserGuide/Create_a_User_Defined_Function_for_Set_Column_Values.html" title="ユーザガイド:列値の設定を行うためのユーザ定義式を作成する">ユーザ定義関数を作成</a>することもできます。</li>
<li>文字<b>i</b>と<b>j</b>はシステム変数で、現在の行インデックスと列インデックスを保持しています。文字<b>x</b>と<b>y</b>は現在のXYの値を表します。<b>計算式</b>編集ボックスにこれらを使うことができます。</li>
</ol>
</td>
</tr>
</table>
<h2><a name="Add_Expressions_only_in_Formula" id="Add_Expressions_only_in_Formula"></a><span class="mw-headline"><i>計算式</i>にのみ数式を追加する</span></h2>
<p><b style="font-weight: bold;">計算式</b>に1行の数式を入力して、<b>実行前の処理スクリプト</b>を空白にしておくことができます。<b>計算式</b>編集ボックスの数式には、組み込み関数またはユーザ定義関数を含めることができます。次は、これらの関数をどのように使用するかを示すサンプルです。</p>
<p><b style="font-weight: bold;">サンプル 1</b></p>
<ol>
<li>新しい行列を作成します。行列の右上角にある <a class="image"><img alt="AddMatrixMenu.png" src="../images/Entering_Expressions_in_the_Set_Values_Dialog/AddMatrixMenu.png" width="17" height="17" border="0" /></a> アイコンをクリックし、<b>追加</b>を選び、新しい行列オブジェクトを追加します。</li>
<li>メインメニューから<b>行列：セル値の設定</b>を選択し、<b>値の設定</b>ダイアログを開きます。そして、<b>計算式</b>編集ボックスに<b>i</b>を入力し、<b>適用</b>ボタンをクリックしてデータを生成します。</li>
<li><a class="image"><img alt="SetValuesNext.png" src="../images/Entering_Expressions_in_the_Set_Values_Dialog/SetValuesNext.png" width="20" height="21" border="0" /></a> ボタンをクリックして、2番目の行列オブジェクトに対しても値をセットします。メニューから<b>関数：</b><b>数学：Cos(x)</b> を選び、<b>計算式</b>ボックスに <b>cos()</b> を追加します。カーソルは括弧内に配置されます。メニューから <b>Mat(1):Mat(1)</b> を選択します。すると、数式は <b>cos(Mat(1))</b>になります。<b>OK</b> ボタンをクリックして計算式を実行します。</li>
</ol>
<h2><a name="Add_Expressions_only_in_Before_Formula_Scripts" id="Add_Expressions_only_in_Before_Formula_Scripts"></a><span class="mw-headline"><i>実行前の処理スクリプト</i>にのみ数式を追加する</span></h2>
<p><b style="font-weight: bold;">実行前の処理スクリプト</b>編集ボックスに複数行のLabTalkスクリプトを入力し、<b>計算式</b>を空白にしておくことができます。組み込み関数またはユーザ定義関数だけでなく、LabTalkスクリプトをここで利用することができます。ですので、範囲(range)変数、 文字列変数、loop、LabTalkからアクセス可能なXファンクションを使うことができます。</p>
<p>次のサンプルは、サンプル1と同じ結果になります。</p>
<p><b style="font-weight: bold;">サンプル 2</b></p>
<ol>
<li>新しい行列を作成します。行列の右上角にある <a class="image"><img alt="AddMatrixMenu.png" src="../images/Entering_Expressions_in_the_Set_Values_Dialog/AddMatrixMenu.png" width="17" height="17" border="0" /></a> アイコンをクリックし、ショートカットメニューから<b>追加</b>を選び、新しい行列オブジェクトを追加します。</li>
<li>メインメニューから<b>行列：セル値の設定</b>を選択し、<b>値の設定</b>ダイアログを開きます。そして、<b>計算式</b>編集ボックスに<b>i</b>を入力し、<b>適用</b>ボタンをクリックしてデータを生成します。</li>
<li><a class="image"><img alt="SetValuesNext.png" src="../images/Entering_Expressions_in_the_Set_Values_Dialog/SetValuesNext.png" width="20" height="21" border="0" /></a> ボタンをクリックして、2番目の行列オブジェクトに対しても値をセットします。<b>実行前の処理スクリプト</b>に、<b>Mat(2)=cos(Mat(1))</b>と入力し、<b>OK</b>ボタンをクリックして、データを生成します。</li>
</ol>
<h2><a name="Add_Expressions_in_both_Formula_and_Before_Formula_Scripts" id="Add_Expressions_in_both_Formula_and_Before_Formula_Scripts"></a><span class="mw-headline"><i>計算式</i>と<i>実行前の処理スクリプト</i>の両方に数式を追加します。</span></h2>
<p><b style="font-weight: bold;">計算式</b>と<b>実行前の処理スクリプト</b>の両方にスクリプトを入力する必要が時々あります。例えば、<b>実行前の処理スクリプト</b>で範囲変数を定義し、それを<b>計算式</b>で使用するような場合です。</p>
<p><b style="font-weight: bold;">サンプル 3</b></p>
<ol>
<li>新しいプロジェクトを作成します。</li>
<li><b style="font-weight: bold;">MBook1</b>という名前の新しい行列を作成します。行列の右上角にある <a class="image"><img alt="AddMatrixMenu.png" src="../images/Entering_Expressions_in_the_Set_Values_Dialog/AddMatrixMenu.png" width="17" height="17" border="0" /></a> アイコンをクリックし、ショートカットメニューから<b>追加</b>を選び、新しい行列オブジェクトを追加します。そこにいくつか数値を入力し、それを後で使用します。</li>
<li><b style="font-weight: bold;">MBook1</b>を選択します。右クリックしてショートカットメニューから<b>値の設定</b>を選びます。そして、<b>計算式</b>編集ボックスに <b>i</b> を入力します。<b>適用</b>ボタンをクリックして、データを生成します。</li>
<li><a class="image"><img alt="SetValuesNext.png" src="../images/Entering_Expressions_in_the_Set_Values_Dialog/SetValuesNext.png" width="20" height="21" border="0" /></a> ボタンをクリックして、2番目の行列オブジェクトに対しても値をセットします。<b>計算式</b>編集ボックスに <b>j</b> を入力します。<b>OK</b> ボタンをクリックし、データを生成します。</li>
<li>別の行列を作成します。<b>MBook2</b>という名前になっているはずです。</li>
<li>MBook2の左上にある灰色の空セルを右クリックして、<b>行列のセル値の設定</b>を選択して<b>値の設定</b>ダイアログを開きます。<b>実行前の処理スクリプト</b>でMbook1の2つの行列オブジェクトを参照する2つの範囲変数を定義し、下図のように<b>計算式</b>編集ボックスでそれらを使います。
<dl>
<dd><a class="image" style="color: #0000ff; text-decoration: underline;"><img alt="SetMatrixRangeVariables.png" src="../images/Entering_Expressions_in_the_Set_Values_Dialog/SetMatrixRangeVariables.png" width="509" height="419" border="0" /></a></dd>
</dl>
</li>
<li><b style="font-weight: bold;">OK</b> ボタンをクリックし、MBook2のデータを生成します。結果は次のようになります。
<dl>
<dd><a class="image" style="color: #0000ff; text-decoration: underline;"><img alt="SetMatrixValuesResults.png" src="../images/Entering_Expressions_in_the_Set_Values_Dialog/SetMatrixValuesResults.png" width="398" height="301" border="0" /></a></dd>
</dl>
</li>
</ol>
