<h1 class="firstheading">メニューオプションとダイアログ操作</h1><p class='urlname' style='display: none'>Wks-SetColVal-MenuOpt-Dialog</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Formula_Menu"><span class="tocnumber">1</span> <span class="toctext">計算式メニュー</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#wcol.281.29_Menu"><span class="tocnumber">2</span><span class="toctext">wcol(1)メニュー</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Col.28A.29_Menu"><span class="tocnumber">3</span> <span class="toctext">Col(A) メニュー</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Function_Menu"><span class="tocnumber">4</span><span class="toctext">関数メニュー</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Variables_Menu"><span class="tocnumber">5</span><span class="toctext">変数メニュー</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#Example:_Inserting_SYSTEM_variables_into_your_column_formula"><span class="tocnumber">5.1</span> <span class="toctext">サンプル: SYSTEM変数を列式に挿入する</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-7"><a href="#Options_Menu"><span class="tocnumber">6</span> <span class="toctext">オプションメニュー</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Range.2FColumn_controls"><span class="tocnumber">7</span><span class="toctext">範囲/列のコントロール</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Target_Column"><span class="tocnumber">8</span><span class="toctext">目的の列</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#Column_First.2FNext.2FPrev.2FLast"><span class="tocnumber">9</span><span class="toctext">最初の列/次へ/前へ/最後へ</span></a></li>
<li class="toclevel-1 tocsection-11"><a href="#Column_Formula"><span class="tocnumber">10</span><span class="toctext">列の式</span></a></li>
<li class="toclevel-1 tocsection-12"><a href="#Recalculate"><span class="tocnumber">11</span> <span class="toctext">再計算</span></a></li>
<li class="toclevel-1 tocsection-13"><a href="#Buttons"><span class="tocnumber">12</span> <span class="toctext">ボタン</span></a></li>
<li class="toclevel-1 tocsection-14"><a href="#Before_Formula_Scripts"><span class="tocnumber">13</span><span class="toctext">実行前の処理スクリプト</span></a></li>
<li class="toclevel-1 tocsection-15"><a href="#Search_and_Insert_Functions"><span class="tocnumber">14</span><span class="toctext">関数の検索と挿入</span></a></li>
</ul>
</div>
<h2><a name="Formula_Menu"></a><span class="mw-headline">計算式メニュー</span></h2>
<p>計算式の保存やロードなどの計算式の操作を行う際には、<b>計算式</b>メニューにある項目を使います。
</p>
<table class="simple">
<tr>
<th><span class="menu">サンプルのロード</span>
</th>
<td>
<p>サンプルの計算式をロードします。
</p>
</td></tr>
<tr>
<th><span class="menu">ロード</span>
</th>
<td>
<p>保存した計算式をロードします。
</p>
</td></tr>
<tr>
<th><span class="menu">保存</span>
</th>
<td>
<p><b>実行前の処理スクリプト</b>タブと<b>Python関数</b>タブの内容を含め、現在の式を保存します。
</p>
</td></tr>
<tr>
<th><span class="menu">名前を付けて保存</span>
</th>
<td>
<p>計算式に別の名前を付けて保存します。
</p>
</td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Menu_Options_and_Dialog_Controls/Tip_icon.png" width="57"  border="0" /></td><td><p>列ラベル行<a href="../../UserGuide/UserGuide/Displaying_Supporting_Data_in_Worksheet_header_Rows.html#F.28x.29.3D" title="ユーザガイド:ワークシートヘッダ行に表示するサポートデータ"><b>F(x)=</b> セル</a>に計算式を直接読み込むこともできます。セルを選択し、<b>列：ユーザー式入力</b>を選択するか、セルを右クリックして<b>ロード</b>を選択します。
</p></td></tr></table>
<h2><a name="wcol.281.29_Menu"></a><span class="mw-headline">wcol(1)メニュー</span></h2>
<p>Origin は現在のワークシートのすべての列を<b>WCol(<i>N</i>): ショートネーム&quot;ロングネーム&quot;</b>という形式でリストアップします（<b>N</b>は列のインデックス）。計算式で列を参照して使う場合、ここから1つを選択して、<b>列の式</b>や<b>実行前の処理スクリプト</b>に列を追加することができます。選択した列を<b>列の式</b>編集ボックス、<b>実行前の処理スクリプト</b>のどちらに追加するかどうかは、カーソルの位置によります。
</p>
<table class="simple">
<tr>
<th><span class="menu">WCol(<i>N</i>): ショートネーム&quot;ロングネーム&quot;</span>
</th>
<td>
<p>このメニュー項目を選択すると、<b>wcol(<i>N</i>)</b>を<b>列の式</b>、または、<b>実行前の処理スクリプト</b>に追加することができます。  <i>N</i>は列のインデックスです。
</p>
</td></tr>
<tr>
<th><span class="menu">列ブラウザ</span>
</th>
<td>
<p>これを選択すると、<b>列ブラウザ</b>ダイアログガ開き、追加する列を選択することができます。  
</p>
</td></tr></table>
<h2><a name="Col.28A.29_Menu"></a><span class="mw-headline">Col(A)メニュー</span></h2>
<p>Origin は現在のワークシートのすべての列を、<i>Col(&quot;Time&quot;): A</i>のように、<b>Col(<i>ロングネーム</i>): <i>ショートネーム</i></b>の形式でリストアップします。計算式で列を参照して使う場合、ここから1つを選択して、<b>列の式</b>や<b>実行前の処理スクリプト</b>に列を追加することができます。選択した列を<b>列の式</b>編集ボックス、<b>実行前の処理スクリプト</b>のどちらに追加するかどうかは、カーソルの位置によります。
</p>
<table class="simple">
<tr>
<th><span class="menu">ロングネームを優先</span>
</th>
<td>
<p>列を特定するのに、Col(<i>ロングネーム</i>): <i>ショートネーム</i>のように、ロングネームを優先します。デフォルトでチェックが入っています（デフォルトを変更するにはシステム変数<a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#S">@SCVPL</a>を設定します） 
</p>
</td></tr>
<tr>
<th><span class="menu">Col(<i>ショートネーム</i>): <i>ロングネーム</i></span>
</th>
<td>
<p>このメニュー項目を選択して<b>Col(<i>ロングネーム</i>)</b>を<b>列の式</b>または<b>実行前の処理スクリプト</b>に追加できます。  
</p>
</td></tr>
<tr>
<th><span class="menu">列ブラウザ</span>
</th>
<td>
<p>これを選択すると、<b>列ブラウザ</b>ダイアログガ開き、追加する列を選択することができます。  
</p>
</td></tr></table>
<h2><a name="Function_Menu"></a><span class="mw-headline">関数メニュー</span></h2>
<p>このメニューを使用して、式を作成するための関数を追加できます。<b>列の式</b>または<b>実行前の処理スクリプト</b>編集ボックスのどちらにも関数を選択して挿入することができます。カーソルのあったところに関数が挿入されます。 
</p>
<table class="simple">
<tr>
<th><span class="menu">最近使用したもの</span>
</th>
<td>
<p>使われた関数は自動的にこのメニューに追加されます。
</p>
</td></tr>
<tr>
<th><span class="menu">検索と挿入...</span>
</th>
<td>
<p><a href="../../UserGuide/UserGuide/Menu_Options_and_Dialog_Controls.html#Search_and_Insert_Functions" title="ユーザガイド:メニューとダイアログのオプション"><b><b>関数の検索と挿入</b></b></a>ダイアログを開き、組み込み関数を検索します。 
</p>
</td></tr>
<tr>
<th><span class="menu">様々なカテゴリにある関数</span>
</th>
<td>
<p><b>列の式</b>、または、<b>実行前の処理スクリプト</b>に追加する関数を選択します。関数についての詳細は、<a class="external text" href="../../LabTalk/Script/LabTalk-Supported_Functions.html">LabTalkがサポートしている関数</a>を参照してください。
</p>
</td></tr></table>
<h2><a name="Variables_Menu"></a><span class="mw-headline">変数メニュー</span></h2>
<p>このメニューのオプションは、<b><b>Origin 8.1 SR0</b></b>からサポートされています。メニューコマンドを使用して、<b><b>実行前の処理スクリプト</b></b>編集ボックスに変数を挿入します。
</p>
<table class="simple">
<tr>
<th><span class="menu">事前定義変数</span>
</th>
<td>
<p>変数または定数を<b>列の式</b>、または、<b>実行前の処理スクリプト</b>に追加します。使用できる変数や定数には下記のものが含まれます。
</p>
<ul><li><i>This</i>
<dl><dd>現在の列を使用します。This<i>n</i> は、現在の列の<i>n</i> 番目のセルを参照します。</dd>
<dd><b>Note</b>: この変数は、<a class="external text" href="../../UserGuide/UserGuide/Folder_and_Window_Properties_Dialog.html#Window_Properties_dialog%7C"><b>スプレッドシートセル表記</b></a>が有効な時だけ利用できます。また、<b>実行前の処理スクリプト</b>編集ボックスでは使用できません。</dd></dl></li>
<li><i>[i]</i>
<dl><dd>行インデックスを示すために使います。</dd></dl></li>
<li><i>pi</i>
<dl><dd>これは定数PIです。 </dd></dl></li>
<li><i>j</i>
<dl><dd>列インデックスを示すために使います。</dd></dl></li>
<li><i>wcol(j)</i>
<dl><dd>現在の列を表します。</dd></dl></li></ul>
</td></tr>
<tr>
<th>プロジェクト変数
</th>
<td>プロジェクト変数を<b>列の式</b>、または、<b>実行前の処理スクリプト</b>に追加します。サブメニューには、最大10個のプロジェクト変数 (およびその値) が表示されます。<b>詳細…</b>のサブアイテムをクリックして<a href="../../UserGuide/UserGuide/The_Project_Variables_Dialog_Box.html" title="ユーザガイド: プロジェクト変数ダイアログボックス"><b>プロジェクト変数</b></a>ダイアログから全てのプロジェクト変数を確認・選択できます。
</td></tr>
<tr>
<th>範囲変数の追加
</th>
<td>
<p><a class="external text" href="../../UserGuide/UserGuide/Specifying_Your_Input_Data.html#Dataset_Browser.2FRange_Browser"><b>レンジブラウザ</b></a>が開き、範囲変数を定義できます。 
</p>
</td></tr>
<tr>
<th>変数情報の追加
</th>
<td>
<p><a href="../../UserGuide/UserGuide/The_Insert_Variables_Dialog_Box.html" title="ユーザガイド: 変数の挿入ダイアログボックス"><b>変数の挿入</b>ダイアログ</a>の情報タブが開き、ページオブジェクト内の変数値やファイルメタデータを挿入することができます。
</p><p>ここで役に立つオプションの一つとしてキー変数値を<a class="external text" href="../../LabTalk/LabTalk/System_Variables.html#V1.2C_V1.24.E2.80.93V4.2C_V4.24">システム変数<b>v1</b> - <b>v4</b></a>への格納があります。これにより、限られた数の数値(データ型=double)の値をワークブックに格納できます。これについての説明は、このセクションの最後にあるサンプルを確認してください。
</p>
</td></tr>
<tr>
<th>列ラベルセルの追加
</th>
<td>
<p><a href="../../UserGuide/UserGuide/The_Insert_Variables_Dialog_Box.html" title="ユーザガイド: 変数の挿入ダイアログボックス"><b>変数の挿入</b> ダイアログ</a> のラベルタブが開き、列ラベルセルから変数を挿入するのに役立ちます。<b>ヒント:</b> 挿入するラベルセルデータを含むブック、シート、列を選択するために右パネルを使用します。
</p>
</td></tr>
<tr>
<th>選択から範囲変数を追加...
</th>
<td> 値の設定ダイアログを最小化しワークシートから挿入する範囲変数を選択します。
</td></tr>
<tr>
<th>選択から列ラベルセルを追加
</th>
<td> 値の設定ダイアログを最小化し列ラベルセルを選択して変数を挿入します。
</td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Menu_Options_and_Dialog_Controls/Tip_icon.png" width="57"  border="0" /></td><td><p>最初に<b><b>選択から範囲変数を追加</b></b>メニューで、範囲変数が追加されたとき、<b><b>挿入モード</b></b>ダイアログが表示され、範囲を参照する異なるシンタックスを選択できます。利用可能なオプションは、<b>列表記: Col(A)</b>、<b>ロングネーム&nbsp;: A</b>、<b>ショートネーム&nbsp;: A</b> および <b>インデックス&nbsp;: wcol(1)</b>です。
</p></td></tr></table>
<h3><a name="Example:_Inserting_SYSTEM_variables_into_your_column_formula"></a><span class="mw-headline">サンプル: SYSTEM変数を列式に挿入する</span></h3>
<p>ワークブックには、4つの数値(double)と4つの文字列変数値を格納できます。<a class="external text" href="../../LabTalk/LabTalk/System_Variables.html#V1.2C_V1.24.E2.80.93V4.2C_V4.24">これらの事前定義システム変数</a> は、とりわけ、列値の計算で使用する主要なワークブック固有の値を格納するために使用できます。
</p>
<ol>
<li>新しいワークブックウィンドウを開きます。これは、列値の計算に使用する予定のワークブックです。</li>
<li>ワークブックウィンドウをアクティブにして、スクリプトウィンドウを開きます（<b>ウィンドウ：スクリプトウィンドウ</b>）。以下を入力してEnterを押します。
<pre class="lt" style="font-family:monospace;">page.<span style="color: #000080;">v1</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1.117</span></pre></li>
<li>計算で使用するワークシート列で右クリックして、<b>列値の設定</b>を選択します。</li>
<li>列<b>A</b>の値に、値が1.117の新しい&quot;v1&quot;変数を掛けるとします。最初に、列の計算式ボックスにAを入力します。</li>
<li>値の設定の<b>変数</b>メニューから、<b>変数情報の追加</b>を選択します。</li>
<li>System Formulaノードを開き、変数v1（値は1.117）を選択し、<b>挿入</b>、<b>閉じる</b>の順にクリックします。これにより、値の設定ダイアログの<b>実行前の処理スクリプト</b>パネルに以下の式が表示されます。
<pre class="lt" style="font-family:monospace;">double d1 <span style="color: #000080;">=</span> page.<span style="color: #000080;">info</span>.<span style="color: #000080;">SYSTEM</span>.<span style="color: #000080;">FORMULA</span>.<span style="color: #000080;">V1</span>;</pre></li>
<li>v1に格納されている値は、データ型doubleの変数d1に割り当てられました。これを使って列Aの値に1.117掛けるには、上部パネルに以下のような式を入力します。
<pre class="lt" style="font-family:monospace;">A <span style="color: #000080;">*</span> d1</pre></li>
<li><b>適用</b> または <b>OK</b> をクリックして計算を実行します。変数の値はブックに保存されるので、ブックを個別のウィンドウ（プロジェクトの一部）として保存する必要があることに注意してください。</li>
</ol>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Menu_Options_and_Dialog_Controls/Tip_icon.png" width="57"  border="0" /></td><td><p>値の設定の列式で使用する変数を定義および保存する別の論理的な方法は、<a href="../../UserGuide/UserGuide/Entering_Expressions_in_the_Set_Column_Dialog.html#Add_Expressions_in_both_Column_Formula_and_Before_Formula_Scripts" title="ユーザガイド:「値の設定」ダイアログボックスに数式を入力する">値を設定の<b>実行前の処理スクリプト</b>パネルを使用</a>することです。
</p></td></tr></table>
<h2><a name="Options_Menu"></a><span class="mw-headline">オプションメニュー</span></h2>
<table class="simple">
<tr>
<th>式セルを直接編集
</th>
<td>このオプションはデフォルトで有効になっています。このオプションをチェックするとセルで直接式を編集できるようになります。
</td></tr>
<tr>
<th>式テキスト...
</th>
<td>このオプションは<b><b>式セルを直接編集</b></b>が無効になった時に選択できます。このオプションを選択すると<b><b>式テキスト</b></b>ダイアログが開き、式セルの<b><b>F(x)</b></b>ラベル行に表示したいテキストを入力できます。<b><b>式テキスト</b></b>ダイアログが空のままの場合、式セルには式列がそのまま表示されます。<b>ヒント</b>: 式セルの表示が空欄がいい場合、<b><b>式テキスト</b></b>ボックスにスペースを入力してください。
</td></tr>
<tr>
<th>テキストを保持
</th>
<td>チェックした場合、計算した際に欠損値になる代わりに目的の列のテキストが保持されます。
</td></tr></table>
<h2><a name="Range.2FColumn_controls"></a><span class="mw-headline">範囲/列のコントロール</span></h2>
<dl><dd><a  class="image"><img alt="RowRangeControl.png" src="../images/Menu_Options_and_Dialog_Controls/RowRangeControl.png" width="258"  /></a></dd></dl>
<p>式で値が設定される値の範囲を定義します。
</p><p><span class="db">値の設定</span>ダイアログを開く前に列(複数列)を選択していた場合には、開始行と終了行は自動的に<b>行(i): 開始</b> と<b> 終了</b> ボックスに入ります。 (すべての列を選択するとこのボックスに <b>&lt;自動&gt;</b>となります）。非連続の範囲選択はサポートしていません。範囲を変更する場合、<b>開始</b>と<b>終了</b>のボックスの値を上書きします。
</p>
<dl><dd><a  class="image"><img alt="ColumnControl.png" src="../images/Menu_Options_and_Dialog_Controls/ColumnControl.png" width="255"  /></a></dd></dl>
<p>式で値が設定される列の範囲を定義します。これは複数列の値を設定するときにのみ利用可能です。 
</p><p><span class="db">値の設定</span>ダイアログを開く前に複数列を選択していた場合には、開始行と終了行は自動的に<b>列(j): 開始</b> と<b>終了</b> ボックスに入ります。連続していない列はサポートされていないことに注意してください。列を変更する場合、<b>開始</b>と<b>終了</b>のボックスの値を上書きします。
</p>
<h2><a name="Target_Column"></a><span class="mw-headline">目的の列</span></h2>
<p>この編集不可のフィールドは、列式および/または式スクリプト前の式が適用される列を識別します。
</p>
<h2><a name="Column_First.2FNext.2FPrev.2FLast"></a><span class="mw-headline">最初の列/次へ/前へ/最後へ</span></h2>
<dl><dd><a  class="image"><img alt="NavagationButtons.png" src="../images/Menu_Options_and_Dialog_Controls/NavagationButtons.png" width="116"  /></a></dd></dl>
<p>このボタンのグループを使用して、ある列から別の列に切り替えることができます。ダイアログを閉じずに複数列の<b>値の設定</b>を使うことができます。
</p>
<h2><a name="Column_Formula"></a><span class="mw-headline">列の式</span></h2>
<p>データ生成のためにこの編集ボックスに単一行の式を追加することができます。ここには関数、条件演算子、および変数を使用できます。 
</p>
<h2><a name="Recalculate"></a><span class="mw-headline">再計算</span></h2>
<table class="dialogcontroltable">
<tr>
<th><b>再計算</b>
</th>
<td>
<p>値の設定の式の再計算を制御します。
</p>
<ul><li><b>なし</b> </li>
<li><b>自動</b> </li>
<li><b>手動</b>  </li></ul>
<p>詳細情報は、 <a class="external text" href="../../UserGuide/UserGuide/Recalculating_Analysis_Results.html">分析結果の再計算</a>をご覧下さい。
</p>
</td></tr></table>
<h2><a name="Buttons"></a><span class="mw-headline">ボタン</span></h2>
<table class="dialogcontroltable">
<tr>
<th> 関数の検索と挿入
</th>
<td>
<p><a  class="image"><img alt="Search Insert Functions.png" src="../images/Menu_Options_and_Dialog_Controls/Search_Insert_Functions.png" width="23"  /></a>ボタンをクリックして<a href="../../UserGuide/UserGuide/Menu_Options_and_Dialog_Controls.html#Search_and_Insert_Functions" title="ユーザガイド:メニューとダイアログのオプション"><b>関数の検索と挿入</b></a>ダイアログを開きます。
</p>
</td></tr>
<tr>
<th> 列プロパティダイアログボックスに切り替える
</th>
<td>
<p><a  class="image"><img alt="Open properties dialog.png" src="../images/Menu_Options_and_Dialog_Controls/Open_properties_dialog.png" width="23"  /></a>ボタンをクリックして列プロパティダイアログに切り替えます。
</p>
</td></tr>
<tr>
<th> 適用
</th>
<td>
<p>ダイアログボックスを閉じることなく式で値を設定します。
</p>
</td></tr>
<tr>
<th> キャンセル
</th>
<td>
<p>ダイアログボックスを閉じ、何もしません。 
</p>
</td></tr>
<tr>
<th>OK
</th>
<td>
<p>式で値を設定してダイアログボックスを閉じます。
</p>
</td></tr>
<tr>
<th>スクリプトを表示/非表示 <br /> (上矢印ボタン)
</th>
<td>
<p><b>実行前の処理スクリプト</b>パネルを表示または非表示にします。
</p>
</td></tr></table>
<h2><a name="Before_Formula_Scripts"></a><span class="mw-headline">実行前の処理スクリプト</span></h2>
<p>この編集ボックスには複数行のLabTalkスクリプトを入力することができ、<b>列の計算式</b>編集ボックスの計算式の前に実行されます。<b>スクリプトの表示/非表示</b>ボタン <a  class="image"><img alt="ShowOrHideButton.png" src="../images/Menu_Options_and_Dialog_Controls/ShowOrHideButton.png" width="23"  /></a> をクリックして、この編集ボックスを表示/非表示することができます。
</p>
<h2><a name="Search_and_Insert_Functions"></a><span class="mw-headline">関数の検索と挿入</span></h2>
<p><a  class="image"><img alt="Search and Insert Functions.png" src="../images/Menu_Options_and_Dialog_Controls/Search_and_Insert_Functions.png" width="800"  /></a>
</p><p>関数を検索するには、まず関数検索入力ボックスにキーワードを入力します。関連するすべての関数が関数名と説明とともに一覧表示されます。使用したい関数をダブルクリックすると、<b><b>値の設定</b></b>ダイアログに関数を挿入できます。その関数の詳細を表示するには、関数の説明部分をクリックして、対応する関数ページに移動できます。
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Menu_Options_and_Dialog_Controls/Tip_icon.png" width="57"  border="0" /></td><td><p><b>値の設定</b>ダイアログの他に、これらのツール/メニューで<b>関数の検索と挿入</b>ダイアログを開くこともできます。
</p>
<ul><li> <a href="../../UserGuide/UserGuide/Using_Formulae_to_Set_Cell_Values.html#Edit_Cell_Formulas_in_Formula_Bar" title="ユーザガイド：式を利用してセルの値を決定する">数式バー</a>の<a  class="image"><img alt="FB FunSel.png" src="../images/Menu_Options_and_Dialog_Controls/FB_FunSel.png" width="23"  /></a>ボタンをクリックします。</li></ul>
<ul><li> メニューから<b>ツール：関数の検索</b>を選択します。このメニューで開いたダイアログで、数式情報を選択してテキストとしてコピーし、メモ帳に貼り付けることができます。</li></ul>
</td></tr></table>


    