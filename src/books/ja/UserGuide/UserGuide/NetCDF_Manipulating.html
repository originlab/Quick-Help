<h1 class="firstheading">NetCDFファイルの操作</h1><p class='urlname' style='display: none'>NetCDF-Manipulating</p>
<p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Manipulation_on_Matrix_Data"><span class="tocnumber">1</span> <span class="toctext">行列データの操作</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Linear_Fit_on_Matrix_Stack"><span class="tocnumber">1.1</span> <span class="toctext">行列での線形フィット</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Descriptive_Statistics_on_Matrix"><span class="tocnumber">1.2</span> <span class="toctext">行列での記述統計</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Subtraction"><span class="tocnumber">1.3</span> <span class="toctext">減算</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Subtract_Period_Average"><span class="tocnumber">1.4</span> <span class="toctext">期間平均の減算</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Pixel_Extraction"><span class="tocnumber">1.5</span> <span class="toctext">ピクセル抽出</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Interpolation"><span class="tocnumber">1.6</span> <span class="toctext">補間</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8"><a href="#Profiling_Matrix_Data_on_ROI"><span class="tocnumber">2</span><span class="toctext">ROIでの行列データのプロファイル</span></a>
<ul>
<li class="toclevel-2 tocsection-9"><a href="#Copy_and_Paste_Positions"><span class="tocnumber">2.1</span> <span class="toctext">コピー＆ペーストでの配置</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Export_and_Import_ROI"><span class="tocnumber">2.2</span> <span class="toctext">ROIのエクスポートとインポート</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Create_ROI_from_XY"><span class="tocnumber">2.3</span> <span class="toctext">XYからROIを作成する</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Create_New"><span class="tocnumber">2.4</span> <span class="toctext">新規作成</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#Extract_as_XYZ"><span class="tocnumber">2.5</span> <span class="toctext">XYZとして抽出する</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#Intensity_Profile"><span class="tocnumber">2.6</span><span class="toctext">強度プロファイル</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="#Clear_Data_in_ROI"><span class="tocnumber">2.7</span> <span class="toctext">ROIのデータをクリアする</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#Across_Multiple_Matrix_Sheets"><span class="tocnumber">2.8</span> <span class="toctext">複数行列シートに渡る</span></a></li>
</ul>
</li>
</ul>
</div>
<h2><a name="Manipulation_on_Matrix_Data"></a><span class="mw-headline">行列データの操作</span></h2>
<p>行列スタックにNetCDFファイルをインポートした後、<a class="external text" href="../../GettingStarted/OriginLab/Data_Analysis.html#Mathematics">行列データの操作</a>を実行することができます。
</p><p>以下の例では、NetCDFファイルでこれらのツールを使用する方法をいくつか示します。
</p>
<h4><a name="Linear_Fit_on_Matrix_Stack"></a><span class="mw-headline">行列での線形フィット</span></h4>
<p><b>解析：線形フィット</b>を選択してダイアログを開き、NetCDFの行列スタックで線形フィットを実行します。 
</p>
<dl><dd><a  class="image"><img alt="NetCDF Linear Fit 01.gif" src="../images/NetCDF_Manipulating/NetCDF_Linear_Fit_01.gif" width="852"  /></a></dd></dl>
<h4><a name="Descriptive_Statistics_on_Matrix"></a><span class="mw-headline">行列での記述統計</span></h4>
<p><b>解析：記述統計</b>を選択してダイアログを開き、行列スタックで記述統計（<b>平均</b>, <b>SD</b>（標準偏差）, <b>最小</b>, <b>最大</b>, <b>中央値</b>, <b>合計</b>）を実行します。
</p>
<dl><dd><a  class="image"><img alt="NetCDF Descriptive Statistics 01.gif" src="../images/NetCDF_Manipulating/NetCDF_Descriptive_Statistics_01.gif" width="852"  /></a></dd></dl>
<h4><a name="Subtraction"></a><span class="mw-headline">減算</span></h4>
<p><b>解析：数学：減算</b>を選択してダイアログを開き、同じサイズの2つの行列スタックを減算して、これら2つのデータの差を取得します。
</p><p>以下の例ではまず始めに、NetCDFファイルから行列の平均値を取得します。次に、2つの平均値の行列を減算し、それらの差を取得します。
</p>
<dl><dd><a  class="image"><img alt="NetCDF Subtraction 01.gif" src="../images/NetCDF_Manipulating/NetCDF_Subtraction_01.gif" width="852"  /></a></dd></dl>
<h4><a name="Subtract_Period_Average"></a><span class="mw-headline">期間平均の減算</span></h4>
<p><i><b>ユーザストーリー；</b></i> 
</p>
<ol><li> 新しい行列ウィンドウから始めて、ユーザは 1901年1月から2018年12月までの期間の月平均気温のデータファイルをインポートします。これにより、オブジェクトごとに、その期間の各月が収められた1416個の行列オブジェクトを含む行列 (行列シート) が生成されます。</li>
<li> その後、ユーザは同じファイルを再インポートしますが、今回は <b>m=月ごと</b>間隔 で <b>年ごとの平均</b>のオプションを選択します。これにより、12の行列オブジェクトを含む行列 (行列 シート) が生成されます。これは、1901年1月から 2018年12月までの期間の月ごとの平均気温によって取得されます。</li>
<li> ユーザは、ステップ2で取得した月平均を、元の期間の各月のデータから差し引く必要があります。これにより、1901年1月から2018年12月までの期間の月平均からの偏差を含む1416個の行列オブジェクトの行列 (行列シート) が生成されます。</li></ol>
<dl><dd><dl><dd><a  class="image"><img alt="OH netCDF simple math mmathtool.png" src="../images/NetCDF_Manipulating/OH_netCDF_simple_math_mmathtool.png" width="391"  /></a></dd></dl></dd></dl>
<ol><li> ステップ3を実行するには、ユーザは<b>解析</b> : <b>数学</b> : <b>算術演算</b>を選択します。
<ul><li> 行列<b>A</b>には、1901年1月から2018年12月までの測定値を含む行列を選択します (1416個の行列オブジェクト)。</li>
<li> 行列<b>B</b>には、1901年1月から2018年12月までの期間の月平均気温を含む行列を選択します (12個の行列オブジェクト)。</li>
<li> <b>A - B</b>と式を入力します。</li>
<li> <b>Bの選択範囲</b>で<b>B の周期行列</b>を選択します。</li></ul></li>
<li> または、ユーザーは<b>解析 : 数学 : 減算</b>を選択し、行列<b>A</b>と行列<b>B</b>を選択して、出力行列を選択して、<b>減算</b> = <b>B の周期行列</b>を設定できます。上記の入力が与えられた場合、どちらのツールでも同じ出力が生成されるはずです。</li></ol>
<h4><a name="Pixel_Extraction"></a><span class="mw-headline">ピクセル抽出</span></h4>
<p><b>行列：ピクセル抽出</b>を選択してダイアログを開き、行列スタック内のすべての行列の、指定したXY座標のZ値を抽出します。
</p><p>XY座標値を指定するには、 
</p>
<ul><li> <a class="external text" href="../../GettingStarted/OriginLab/Graphical_Exploration_of_Data.html#The_Screen_Reader_Tool">スクリーンリーダ</a>を使用して行列の点を指定する</li></ul>
<p><i>または</i>
</p>
<ul><li> ダイアログにて緯度・経度の値を手動で指定する</li></ul>
<p><i>または</i>
</p>
<ul><li> 参照列で緯度・経度の値を指定するこのとき、複数のXY座標の組におけるZ値を一度に抽出します。</li></ul>
<dl><dd>Note: <a class="external text" href="https://www.originlab.com/FileExchange/details.aspx?fid=285" target="_blank"><b>Import Shapefile アプリ</b></a>を使うと、インポートされたシェープファイルから経度・緯度のデータセットを使用できます</dd></dl>
<dl><dd><a  class="image"><img alt="NetCDF Pixel Extraction.gif" src="../images/NetCDF_Manipulating/NetCDF_Pixel_Extraction.gif" width="852"  /></a></dd></dl>
<p><br />
</p>
<h4><a name="Interpolation"></a><span class="mw-headline">補間</span></h4>
<p><b>行列：サイズ変更</b>を選択して<a class="external text" href="../../XFunction/X-Function/Msresize.html">msresize</a>ダイアログを開き、<b>サイズ変更オプション</b>として<b>補間</b>を選択して、NCファイルからより詳細な情報を取得します。
</p>
<h2><a name="Profiling_Matrix_Data_on_ROI"></a><span class="mw-headline">ROIでの行列データのプロファイル</span></h2>
<p>行列が<a class="external text" href="../../QuickHelp/QuickHelp/What_is_the_difference_between_data_and_image.html">イメージモード</a>にあるとき、<b>矩形/円形/多角形/領域</b>ツール<a  class="image"><img alt="ROI Rectangle Button.png" src="../images/NetCDF_Manipulating/ROI_Rectangle_Button.png" width="22"  /></a>を用いて領域を関心領域（ROI）として選択し、そこから情報を抽出することができます。
</p><p>ROIを右クリックして、ショートカットメニューからオプションを選択します。ROIを削除するには、Deleteキーを押します。
</p>
<dl><dd><a  class="image"><img alt="ROI shortcut menu.png" src="../images/NetCDF_Manipulating/ROI_shortcut_menu.png" width="171"  /></a></dd></dl>
<p><i><b>複数のROIを追加するには：</b></i>
</p><p>各ROIは、デフォルト名（ROIなど）で追加されます。行列イメージに複数のROIを追加できますが、別のROIを追加する前に、各ROIの名前を変更する必要があります。
</p>
<dl><dd><a  class="image"><img alt="ROI renaming multiple.png" src="../images/NetCDF_Manipulating/ROI_renaming_multiple.png" width="347"  /></a></dd></dl>
<ol><li> ROI上でダブルクリックして、<b>ROI位置</b>ダイアログを開きます。</li>
<li> ROIに意味を持つ（固有の）名前を付け、OKをクリックします。</li></ol>
<p><br />
</p>
<h4><a name="Copy_and_Paste_Positions"></a><span class="mw-headline">コピー＆ペーストでの配置</span></h4>
<p>選択したROIの位置をコピーします。選択したROIの位置を別のROI（幅、高さ...など）に貼り付けます。 
</p>
<dl><dd><a  class="image"><img alt="NetCDF Copy and Paste Positions.gif" src="../images/NetCDF_Manipulating/NetCDF_Copy_and_Paste_Positions.gif" width="852"  /></a></dd></dl>
<h4><a name="Export_and_Import_ROI"></a><span class="mw-headline">ROIのエクスポートとインポート</span></h4>
<p>ROIオブジェクトを保存します。
<br />オブジェクトを保存された.ROIファイル内のオブジェクトに置き換えます（ヒント：インポートする「ダミー」ROIを作成します）。
</p>
<dl><dd><a  class="image"><img alt="NetCDF Export Import ROI.gif" src="../images/NetCDF_Manipulating/NetCDF_Export_Import_ROI.gif" width="852"  /></a></dd></dl>
<h4><a name="Create_ROI_from_XY"></a><span class="mw-headline">XYからROIを作成する</span></h4>
<p>行列にROIを追加し、行列のROIを右クリックして、<b>XYからROIを作成する</b>を選択します。そして<b>xy2roi</b>ツールを使用してワークシートのXYデータをインポートしてROIを定義します。
<br /><br />
<i>例えば、シェープファイルからのデータセットがある場合、NetCDF行列にインポートすることができます。</i>
</p>
<dl><dd><a  class="image"><img alt="NetCDF Create ROI from XY.gif" src="../images/NetCDF_Manipulating/NetCDF_Create_ROI_from_XY.gif" width="852"  /></a></dd></dl>
<h4><a name="Create_New"></a><span class="mw-headline">新しく作成する</span></h4>
<p><b>mroi2mat</b>ツールを使用して、ROIから新しい行列を生成します。
</p>
<dl><dd><a  class="image"><img alt="NetCDF Create New.gif" src="../images/NetCDF_Manipulating/NetCDF_Create_New.gif" width="852"  /></a></dd></dl>
<h4><a name="Extract_as_XYZ"></a><span class="mw-headline">XYZデータに抽出</span></h4>
<p><b>mroi2xyz</b>ツールを使用して、ROIのXYZ値から新しいワークシートを生成します。
</p>
<h4><a name="Intensity_Profile"></a><span class="mw-headline">強度プロファイル</span></h4>
<p><b>mroiprofile</b>ツールを使用して、ROIの記述統計値（<b>平均</b>, <b>SD</b>（標準偏差）, <b>最小</b>, <b>最大</b>, <b>中央値</b>, <b>合計</b>, <b>XYの最小</b>, <b>XYの最大</b>）を生成します。<b>強度プロファイル</b>ダイアログに<b>重み付けROI</b>チェック ボックスが表示されます。このオプションが選択されている場合、各ピクセルは、ピクセル四角形と ROI多角形の交点の面積によって重み付けされます。これは、ROI 座標がピクセルを完全に囲んでいない場合の結果を改善するためのものです。
</p><p>たとえば、シェープファイルデータセットをROIとして追加（<a href="../../UserGuide/UserGuide/NetCDF_Manipulating.html#Create_ROI_from_XY" title="ユーザガイド:NetCDFファイルの操作"><b>XYからROIを作成</b></a>）した後、強度プロファイルツールを使用してROIデータセットを分析できます。
</p>
<dl><dd><a  class="image"><img alt="NetCDF Intensity Profile.gif" src="../images/NetCDF_Manipulating/NetCDF_Intensity_Profile.gif" width="852"  /></a></dd></dl>
<p><br />
このダイアログについては、Xファンクション<a class="external text" href="../../XFunction/X-Function/Mroiprofile.html">Mroiprofile</a>を参照してください。
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/NetCDF_Manipulating/Tip_icon.png" width="57"  border="0" /></td><td><p>多数のROIがあり、 <b>プロファイル位置</b> = <b>行列上の全ROI</b>および<b>データレイアウト</b> = <b>行ごとの行列</b>の場合、速度の問題が発生する可能性があります。速度低下は、レポートデータの出力列を維持することによって発生します。このような場合、元の出力の列数が<a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#R%7C"><b>@RDRC</b></a>より大きい場合、出力は元の列をすべて削除します。ただし、すべての出力列を削除すると、出力から作成されたプロットも破棄されることに注意してください。
</p></td></tr></table>
<h4><a name="Clear_Data_in_ROI"></a><span class="mw-headline">ROIのデータをクリアする</span></h4>
<p>行列にROIを追加し、ROIを右クリックして、<b>クリア</b>を選択します。
</p>
<dl><dd><a  class="image"><img alt="NetCDF Clear ROI Data.png" src="../images/NetCDF_Manipulating/NetCDF_Clear_ROI_Data.png" width="222"  /></a></dd></dl>
<p><br />
</p>
<h4><a name="Across_Multiple_Matrix_Sheets"></a><span class="mw-headline">複数行列シートに渡る</span></h4>
<p>4D行列ブック(4次元目はシート)の場合、1つのROI は行列シートにまたがって表示されます。  そして、ROI はアクティブシートに表示されます。
</p><p>このROI では、 <a href="#Create_New"><b>新規作成</b></a>、<a href="#Extract_as_XYZ"><b>XYZデータ抽出</b></a>、<a href="#Intensity_Profile"><b>強度プロファイル</b></a>ツールもサポートされています。アクティブ行列シートの結果を生成します。シートを切り替えると、アクティブシート用の結果に更新されます。
</p>
<dl><dd><a  class="image"><img alt="NetCDF ROI Across Multiple Matrix Sheets.gif" src="../images/NetCDF_Manipulating/NetCDF_ROI_Across_Multiple_Matrix_Sheets.gif" width="852"  /></a></dd></dl>


    