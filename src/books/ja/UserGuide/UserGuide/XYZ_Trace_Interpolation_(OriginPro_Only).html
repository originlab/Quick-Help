<h1 class="firstheading">XYZトレース補間</h1>
<p class="urlname" style="display: none;">Math-XYZ-TraceInterp</p>
<table id="toc" class="toc">
<tr>
<td>
<div id="toctitle">
<h2>内容</h2>
</div>
<ol>
<li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">説明</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Dialog_Options"><span class="tocnumber">2</span> <span class="toctext">ダイアログオプション</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Examples"><span class="tocnumber">3</span> <span class="toctext">サンプル</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Algorithm"><span class="tocnumber">4</span> <span class="toctext">アルゴリズム</span></a></li>
</ol>
</td>
</tr>
</table>
<h2><a name="Description" id="Description"></a> <span class="mw-headline">説明</span></h2>
<p>Xファンクション <a class="external text" href="../../XFunction/X-Function/Interpxyz.html">interpxyz</a> は、周期性を示すデータに対して2次元の補間を実行します。通常の補間手法は、周期的なデータの傾向を無視して「近傍法」の計算を実行します。トレース補間は、行インデックス番号ベースの曲線に働くので、データの連続的な形態を保持することができます。補間手法は、線形、3次スプライン、3次B-スプラインから選択します。</p>
<p><b style="font-weight: bold;">XYZデータに対してトレース補間を実行するには、以下のように操作します。</b></p>
<ol>
<li>メインメニューから<b>解析：</b><b>数学：</b><b>XYZトレース補間</b><b>interpxyz</b> ダイアログボックスが開きます。</li>
<li><b style="font-weight: bold;">入力</b>、<b>手法</b>、<b>ポイント数</b> を指定します。</li>
<li><b style="font-weight: bold;">OK</b>ボタンをクリックすると、補間されたXYZデータを含む3列が新しく作成され、データワークシートに追加されます(出力先は変更できます)。</li>
</ol>
<h2><a name="Dialog_Options" id="Dialog_Options"></a> <span class="mw-headline">ダイアログオプション</span></h2>
<table class="dialogcontroltable">
<tr>
<th><b style="font-weight: bold;">再計算</b></th>
<td>
<p>分析結果の再計算を制御します。</p>
<ul>
<li><b style="font-weight: bold;">なし</b></li>
<li><b style="font-weight: bold;">自動</b></li>
<li><b style="font-weight: bold;">手動</b></li>
</ul>
<p>詳細は、以下をご覧下さい。<a class="external text" href="../../UserGuide/UserGuide/Recalculating_Analysis_Results.html">分析結果の再計算</a></p>
</td>
</tr>
<tr>
<th>入力</th>
<td>
<p>補間するXYZ範囲を指定します。</p>
<p>範囲制御についてはこちらを確認してください：<a class="external text" href="../../UserGuide/UserGuide/Specifying_Your_Input_Data.html">入力データを指定する</a></p>
</td>
</tr>
<tr>
<th>手法</th>
<td>
<p>補間/補外の手法を指定します。</p>
<ul>
<li><b style="font-weight: bold;">線形</b>
<dl>
<dd>線形補間が速い方法で、隣り合う2つのデータポイント間に直線を引き、データポイントの値を求めます。この手法は、計算が集約された手法と比べ正確性で劣ります。</dd>
</dl>
</li>
<li><b style="font-weight: bold;">3次スプライン</b>
<dl>
<dd>この方法は入力データを指定した数に分割し、各セグメントに対して、3次多項式でフィットします。各3次関数に対して2階微分が0に等しくセットされます。これらの境界条件があっていると、関数全体はで構成できます。</dd>
</dl>
</li>
<li><b style="font-weight: bold;">3次B-スプライン</b>
<dl>
<dd>この方法も入力データを分割します。各区間はベジエスプラインでフィットされます。</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr>
<th>ポイント数</th>
<td>
<p>補間されたポイントの数です。</p>
</td>
</tr>
<tr>
<th>出力</th>
<td>
<p>出力XYデータ範囲を指定します。</p>
</td>
</tr>
</table>
<h2><a name="Examples" id="Examples"></a> <span class="mw-headline">サンプル</span></h2>
<ol>
<li><i style="font-style: italic;">&lt;Origin インストールディレクトリ&gt;\Samples\Mathematics\</i> フォルダにある、<i>Interpolation.dat</i> をインポートします。</li>
<li>C列を選択して右クリックし、<b>列XY属性の設定：Z列</b>を選択します。メインメニューから<b>解析：</b><b>数学：</b><b>XYZトレース補間</b>を選択し、ダイアログを開きます。</li>
<li><b style="font-weight: bold;">入力</b>の項目に適切なデータ範囲が入力されていることを確認します。そして、手法を<b>3次スプライン</b>にします。
<dl>
<dd><a class="image" style="color: #0000ff; text-decoration: underline;"><img alt="Interpxyz example dialog.png" src="../images/XYZ_Trace_Interpolation_(OriginPro_Only)/Interpxyz_example_dialog.png" width="403" height="314" border="0" /></a></dd>
</dl>
</li>
<li><b style="font-weight: bold;">OK</b> をクリックして補間を実行します。</li>
</ol>
<h2><a name="Algorithm" id="Algorithm"></a> <span class="mw-headline">アルゴリズム</span></h2>
<p>一般に、2つの隣り合うデータポイント間で補間されると、最終的なデータセットのデータポイントの数は、<b>ポイント数</b>変数と同じになります。</p>
<p>詳細なアルゴリズムは下記のようになります。</p>
<p>異なる一連の三要素のデータ (<i><img src="../images/XYZ_Trace_Interpolation_(OriginPro_Only)/math-0a645fc515fe6128f91758f996ebe307.png" title="x_i\," alt="x_i\," class="tex" border="0" /></i>, <i><img src="../images/XYZ_Trace_Interpolation_(OriginPro_Only)/math-b19930487b77bb2b470dafd74c4e60fa.png" title="y_i\," alt="y_i\," class="tex" border="0" /></i>,<i><img src="../images/XYZ_Trace_Interpolation_(OriginPro_Only)/math-35664ab219b2826ca92e3df62da5b341.png" title="z_i\," alt="z_i\," class="tex" border="0" /></i>), i = 0, 1, ... n-1　が与えられると、<i>n</i>-1:</p>
<p><img src="../images/XYZ_Trace_Interpolation_(OriginPro_Only)/math-a50bf741606f2c85fb3829b5f18a3196.png" title="x_i&lt;x&lt;x_{i+1},x=x_i+\frac j{npts}\left( x_{i+1}-x_i\right)" alt="x_i&lt;x&lt;x_{i+1},x=x_i+\frac j{npts}\left( x_{i+1}-x_i\right)" class="tex" border="0" /></p>
<p><img src="../images/XYZ_Trace_Interpolation_(OriginPro_Only)/math-02fa42913b4fdf4c28452e69ae4fb6ba.png" title="y_i&lt;y&lt;y_{i+1},y=y_i+\frac j{npts}\left( y_{i+1}-y_i\right)" alt="y_i&lt;y&lt;y_{i+1},y=y_i+\frac j{npts}\left( y_{i+1}-y_i\right)" class="tex" border="0" /></p>
<p><img src="../images/XYZ_Trace_Interpolation_(OriginPro_Only)/math-acf2ac4544594daccad6f286d3999502.png" title="z_i&lt;z&lt;z_{i+1},z=z_i+\frac j{npts}\left( z_{i+1}-z_i\right)" alt="z_i&lt;z&lt;z_{i+1},z=z_i+\frac j{npts}\left( z_{i+1}-z_i\right)" class="tex" border="0" /></p>
<p>ここで、 <i>j=1,2,3...(npts-1)</i> で、<i>npts</i> は<b>ポイント数</b>で指定した値です。</p>
