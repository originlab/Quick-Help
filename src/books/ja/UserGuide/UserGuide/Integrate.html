<h1 class="firstheading">積分</h1><p class='urlname' style='display: none'>Math-Integrate</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div><ul><li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">説明</span></a> <ul><li class="toclevel-2 tocsection-2"><a href="#To_Use_Integration_Tool"><span class="tocnumber">1.1</span> <span class="toctext">積分ツールを使用する</span></a></li></ul></li>
<li class="toclevel-1 tocsection-3"><a href="#Dialog_Options"><span class="tocnumber">2</span> <span class="toctext">ダイアログオプション</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Algorithm"><span class="tocnumber">3</span> <span class="toctext">アルゴリズム</span></a></li></ul></div>

<h2><a name="Description"></a><span class="mw-headline">説明</span></h2>
<p><a class="image"><img alt="NumericalIntegration.png" src="../images/Integrate/400px-NumericalIntegration.png" width="400" height="319" srcset="/images/docwiki/e/e7/NumericalIntegration.png 1.5x, /images/docwiki/e/e7/NumericalIntegration.png 2x" /></a><br /><br /> <b>積分</b> ツールは、台形公式を使用してアクティブデータプロットに数値積分を実行します。<b>数学的面積</b> (台形の代数的総計) または <b>絶対値面積</b> (絶対台形値の総計)を選択できます。欠損値がある場合無視されます。</p>
<h5><a name="To_Use_Integration_Tool"></a><span class="mw-headline">1.1 積分ツールを使用する</span></h5>
<ol><li>データを入力した、新しいワークシートを作成します。</li>
<li>ワークブックにあるデータを選択します。</li>
<li>その後メニューから、<b>解析</b>：<b> 数学： </b><b>積分</b>を選び、<b>integ1</b>ダイアログボックスを開きます。 </li></ol>
<p><a class="external text" href="../../XFunction/X-Function/Integ1.html">integ1</a> Xファンクションが呼び出されて計算を実行します。結果の面積、ピークの位置、ピーク幅、ピーク高さ(X軸からの最大の振れ) を結果ログに出力するオプションを利用できます。さらに、曲線の両端を結んだシンプルなベースラインを使用して積分を実行するか選んだり、積分曲線をプロットするか選択できます。</p>
<h2><a name="Dialog_Options"></a><span class="mw-headline">ダイアログオプション</span></h2>
<table class="dialogcontroltable">

<tr>
<th> 結果ログの出力</th>
<td> 面積、ピーク位置、ピーク幅、ピーク高さを結果ログに出力するかどうか選択します。</td></tr>
<tr>
<th><b>再計算</b></th>
<td>
<p>分析結果の再計算を制御します。</p><ul><li><b>なし</b> </li>
<li><b>自動</b> </li>
<li><b>手動</b>  </li></ul><p>詳細は、こちらを確認してください：<a class="external text" href="../../UserGuide/UserGuide/Recalculating_Analysis_Results.html">分析結果の再計算</a></p>
</td></tr>
<tr>
<th>入力</th>
<td>
<p>積分する入力データを指定します。</p><p>範囲制御についてはこちらを確認してください：<a class="external text" href="../../UserGuide/UserGuide/Specifying_Your_Input_Data.html">入力データを指定する</a></p>
</td></tr>
<tr>
<th>最終ポイントでの直線を基線に使用</th>
<td>
<p>最終ポイントを横切る直線を作成し、それを積分計算の基線として用いるかを指定します。</p>
</td></tr>
<tr>
<th>領域の種類</th>
<td>
<p>積分領域の種類を指定します。詳細については、以下のアルゴリズムのセクションをご覧下さい。</p><ul><li><b>数学的面積</b><dl><dd>面積は台形の代数的総計で求められます。</dd></dl></li>
<li><b>絶対値面積</b><dl><dd>面積は絶対台形値の総計で求められます。  </dd></dl></li></ul></td></tr>
<tr>
<th>出力する値</th>
<td>
<p><b>積分結果</b> ボックス(下図)にチェックを入れて、出力する内容を指定します。</p><ul><li><b>データセット識別子</b><dl><dd><b>積分結果</b> ボックスにチェックが入っているときは、どのデータセット識別子を使うか選択します。</dd></dl></li>
<li><b>開始の行番号</b><dl><dd>開始行のインデックスを出力するかどうかを指定します。</dd></dl></li>
<li><b>終了の行番号</b><dl><dd>終了行のインデックスを出力するかどうかを指定します。</dd></dl></li>
<li><b>開始X</b><dl><dd>開始X値を出力するかどうかを指定します。</dd></dl></li>
<li><b>終了X</b><dl><dd>最終X値を出力するかどうかを指定します。</dd></dl></li>
<li><b>最大高さ</b><dl><dd>基線から計算する最大の高さを出力するかどうか指定します。</dd></dl></li>
<li><b>最大高さでのX</b><dl><dd>最大高さに対応する X値の出力を指定します。</dd></dl></li>
<li><b>面積図</b><dl><dd>積分面積を出力するかどうかを指定します。</dd></dl></li>
<li><b>FWHM</b><dl><dd>FWHM、元の曲面の半分の高さでの幅、を出力するかどうかを指定します。</dd></dl></li></ul><p><b>Note:</b> X値の始まりと終わり及び積分面積は、出力する値、<b>Xの開始</b>、 <b>Xの終了</b> 及び <b>面積</b> が可能になっているかに関係なく、積分結果列のコメント行に出力されます。</p>
</td></tr>
<tr>
<th>積分曲線のデータ</th>
<td>
<p>累積結果の範囲を指定します。</p>
</td></tr>
<tr>
<th>積分結果</th>
<td>
<p>レポートシートに積分の結果を出力するかどうかを指定します。</p>
</td></tr>
<tr>
<th>積分曲線をプロット</th>
<td>
<p>積分曲線を作図するかどうか指定し、プロットする場合はどこにプロットするか指定します。</p><ul><li><b>なし</b><dl><dd>積分曲線をプロットしない。</dd></dl></li>
<li><b>新しいグラフ</b><dl><dd>新しいグラフに積分曲線をプロットします。 </dd></dl></li>
<li><b>ソースグラフ</b><dl><dd>ソースグラフに積分曲線をプロットします。このオプションは、グラフウィンドウがアクティブな時のみ利用できます。 </dd></dl></li></ul></td></tr>
<tr>
<th>ソースグラフの再スケール</th>
<td>
<p>積分曲線をプロットするときにソースグラフを再スケールするか指定します。このオプションは<b>積分曲線をプロット</b>が<b>ソースグラフ</b>に指定されているときに使用できます。</p>
</td></tr></table>
<h2><a name="Algorithm"></a><span class="mw-headline">アルゴリズム</span></h2>
<p>数値積分の考え方として、近似関数による定積分を計算します。</p>
<dl><dd><img src="../images/Integrate/math-db625ff0285f87a97833a1a0536c0781.png" title="\int _{a}^{b}f(x)dx" alt="\int _{a}^{b}f(x)dx" class="tex"/></dd></dl>
<p>元のデータは離散しているので、2つの隣接する点を使って、近似する台形を作ります。</p><p><a class="image"><img alt="Integ.png" src="../images/Integrate/Integ.png" width="299" height="173" /></a></p><p>上図のように曲線を断片に分け、各台形の合計を計算し、以下によって積分を計算します。</p>
<dl><dd><img src="../images/Integrate/math-02e1de68d6e5a54203ad7578c5a02844.png" title="\int _{x_1}^{x_n}f(x)dx \approx \sum _{i=1}^{n-1}( x_{i+1} -x_i) \frac{1}{2}[f(x_{i+1})+f(x_i)] " alt="\int _{x_1}^{x_n}f(x)dx \approx \sum _{i=1}^{n-1}( x_{i+1} -x_i) \frac{1}{2}[f(x_{i+1})+f(x_i)] " class="tex"/></dd></dl><ul><li><b>数学的面積と絶対値面積の違い</b></li></ul><p>基線が <img src="../images/Integrate/math-dd1e934594d651730dec0b7e28d8db3a.png" title="y=f(x_0 )\!" alt="y=f(x_0 )\!" class="tex"/> であるとき、<img src="../images/Integrate/math-a71c9a0cb0b8e83221630349cf929fad.png" title="f(x)\!" alt="f(x)\!" class="tex"/> の数学的面積は以下のように計算できます。</p>
<dl><dd><img src="../images/Integrate/math-a25d330f4319359dc2e20213e8096e19.png" title="\int _{x_1}^{x_n} \left[f \left( x \right)-f \left( x_0 \right) \right] \,dx \approx \sum _{i=1}^{n-1} \frac{1}{2} \left( x_{i+1} -x_i \right) \left[ \left( f \left( x_{i+1} \right) -f \left( x_0 \right) \right) + \left( f \left( x_i \right) -f \left( x_0 \right) \right) \right]" alt="\int _{x_1}^{x_n} \left[f \left( x \right)-f \left( x_0 \right) \right] \,dx \approx \sum _{i=1}^{n-1} \frac{1}{2} \left( x_{i+1} -x_i \right) \left[ \left( f \left( x_{i+1} \right) -f \left( x_0 \right) \right) + \left( f \left( x_i \right) -f \left( x_0 \right) \right) \right]" class="tex"/></dd></dl>
<p>各台形面積絶対値の合計が計算された場合、絶対値面積となります。</p>
<dl><dd><img src="../images/Integrate/math-2c032ecbce6257d0ec1dfd6f4510b0ad.png" title="\int _{x_1}^{x_n} | \left[f \left( x \right)-f \left( x_0 \right) \right] | \,dx \approx \sum _{i=1}^{n-1} \frac{1}{2} \left( x_{i+1} -x_i \right) | \left[ \left( f \left( x_{i+1} \right) -f \left( x_0 \right) \right) + \left( f \left( x_i \right) -f \left( x_0 \right) \right) \right] |" alt="\int _{x_1}^{x_n} | \left[f \left( x \right)-f \left( x_0 \right) \right] | \,dx \approx \sum _{i=1}^{n-1} \frac{1}{2} \left( x_{i+1} -x_i \right) | \left[ \left( f \left( x_{i+1} \right) -f \left( x_0 \right) \right) + \left( f \left( x_i \right) -f \left( x_0 \right) \right) \right] |" class="tex"/></dd></dl>
<p><a class="image"><img alt="Integ22.png" src="../images/Integrate/Integ22.png" width="493" height="354" /></a></p><p>上図のように、基線 <img src="../images/Integrate/math-dd1e934594d651730dec0b7e28d8db3a.png" title="y=f(x_0 )\!" alt="y=f(x_0 )\!" class="tex"/> で曲線が5つの台形(もしくは三角形)に分割されています。各台形(もしくは三角形)の面積は以下によって計算されます。</p>
<dl><dd><img src="../images/Integrate/math-741a03a31a9c340fc809dbde0bfd9d03.png" title="A_i = \frac{1}{2} \left( x_{i+1} -x_i \right) \left[ \left( f \left( x_{i+1} \right) -f \left( x_0 \right) \right) + \left( f \left( x_i \right) -f \left( x_0 \right) \right) \right]" alt="A_i = \frac{1}{2} \left( x_{i+1} -x_i \right) \left[ \left( f \left( x_{i+1} \right) -f \left( x_0 \right) \right) + \left( f \left( x_i \right) -f \left( x_0 \right) \right) \right]" class="tex"/></dd></dl>
<p>式から、ベースラインより上の <img src="../images/Integrate/math-49d13e07a9447d5e630f87b63c85691b.png" title="A_1:" alt="A_1:" class="tex"/>、<img src="../images/Integrate/math-592b3a7638d6da52b3853f3fdf596a50.png" title="A_2:" alt="A_2:" class="tex"/>、<img src="../images/Integrate/math-375589569aca2679e52b2a1aede0cf7f.png" title="A_3:" alt="A_3:" class="tex"/> は正ですが、ベースラインより下の<img src="../images/Integrate/math-0f938ef309155e541908ff183035eb41.png" title="A_4:" alt="A_4:" class="tex"/>、<img src="../images/Integrate/math-c01ef2db69dcb67463804b4c2dc3b23e.png" title="A_5:" alt="A_5:" class="tex"/>は負となります。</p><p>従って、この曲線の数学的面積は、<img src="../images/Integrate/math-f51515e5e9a0971b5006e88db4a39fbe.png" title="A_1+A_2+A_3+A_4+A_5\!" alt="A_1+A_2+A_3+A_4+A_5\!" class="tex"/> で表され、絶対値面積は、<img src="../images/Integrate/math-b00d4d4f70cba159c582ac2a35e64d67.png" title="|A_1|+|A_2|+|A_3|+|A_4|+|A_5|=A_1+A_2+A_3-A_4-A_5\!" alt="|A_1|+|A_2|+|A_3|+|A_4|+|A_5|=A_1+A_2+A_3-A_4-A_5\!" class="tex"/> で表されます。</p>






    