<h1 class="firstheading">スクリプトとオブジェクトの関連付け</h1>
<p class='urlname' style='display: none'>Associate-script-object</p>
<h3><a name="Run_LabTalk_Script_from_a_Text_Object" id="Run_LabTalk_Script_from_a_Text_Object"></a><span class="mw-headline">テキストオブジェクトからLabTalkスクリプトを実行する</span></h3>
<p>Originはグラフやワークシートにボタンを追加する事ができ、ボタンを押す事でLabTalkスクリプトの実行が可能です。これにより、スクリプトを特定のプロジェクトやウィンドウに保存できます。</p>
<ol>
<li><a class="external text" href="../../UserGuide/UserGuide/The_Standard_Toolbar.html">標準ツールバー</a>の<b>新規グラフ</b>ボタン（<a class="image"><img alt="Button New Graph.png" src="../images/Associating_script_with_an_object/Button_New_Graph.png" width="23" /></a>）をクリックし、新しいグラフを作成します。</li>
<li><a class="external text" href="../../UserGuide/UserGuide/The_Tools_Toolbar.html">プロット操作・オブジェクト作成ツールバー</a>の中の<b>テキストツール</b>ボタン（<a class="image"><img alt="Button Text Tool.png" src="../images/Associating_script_with_an_object/Button_Text_Tool.png" width="23" /></a>）をクリックし、作成したグラフ上でクリックして<b>My Button</b> と入力します。テキストの入力が終わったら、テキストの外側をクリックして編集を終了します。</li>
<li>テキスト上で右クリックして、<b>プロパティ</b>を選択します。<a href="../../UserGuide/UserGuide/The_(Object_Properties)_Programming_tab.html" title="ユーザガイド：(オブジェクトプロパティ)プログラムタブ"><b>プログラミング</b>タブ</a>をクリックして選択します。</li>
<li><b>のあとでスクリプトを実行</b>ドロップダウンリストで<b>ボタンアップ</b>と設定し、以下を編集ボックスに入力します。
<pre class="lt" style="font-family:monospace;">
type <span style="color: #000080;">-</span>b <span style="color: #ff00ff;">"Hello World"</span>;
</pre></li>
<li><b>OK</b>をクリックして、ダイアログを閉じます。テキストラベルがボタンになりました。ボタンをクリックします。Hello World と表示されたメッセージがポップアップします。</li>
</ol>
<p><br />
詳細は、<a class="external text" href="../../LabTalk/Script/From_Graphical_Objects.html"><b>図形オブジェクトからLabTalkスクリプトを実行する</b></a>を参照してください。</p>
<h3><a name="Run_Python_Script_From_a_Text_Object" id="Run_Python_Script_From_a_Text_Object"></a><span class="mw-headline">テキストオブジェクトからPythonスクリプトを実行する</span></h3>
<ol>
<li>新しいワークブックを作成します。</li>
<li>プロジェクトウィンドウの左側にある<b>プロット操作・オブジェクト作成</b>ツールバーより、<b>テキスト</b>ツール<a class="image"><img alt="Button Text Tool.png" src="../images/Associating_script_with_an_object/Button_Text_Tool.png" width="23" /></a>を選択します。</li>
<li>ワークシートの空いているスペース（最後の列の右側にある灰色の領域）をクリックします。テキストオブジェクトに<i>Run</i>と入力し、オブジェクトの外側をクリックします。これで、ボタンのラベルが作成されました。</li>
<li>Altキーを押しながら、作成したテキストオブジェクトをダブルクリックします。 オブジェクトダイアログが開き、<a href="../../UserGuide/UserGuide/The_(Object_Properties)_Programming_tab.html" title="ユーザガイド：(オブジェクトプロパティ)プログラミングタブ"><b>プログラミング</b>タブ</a>が表示されます。</li>
<li>下側のテキストボックスに、このスクリプトを入力します
<pre class="python" style="font-family:monospace;">
<span style="color: #ff7700;font-weight:bold;">import</span> pandas <span style="color: #ff7700;font-weight:bold;">as</span> pd
<span style="color: #ff7700;font-weight:bold;">import</span> originpro <span style="color: #ff7700;font-weight:bold;">as</span> op
data <span style="color: #000;">=</span> <span style="color: #000;">{</span><span style="color: #0a0;">'Name'</span>:<span style="color: #000;">[</span><span style="color: #0a0;">'Tom'</span><span style="color: #000;">,</span> <span style="color: #0a0;">'Jack'</span><span style="color: #000;">,</span> <span style="color: #0a0;">'Mike'</span><span style="color: #000;">,</span> <span style="color: #0a0;">'Alice'</span><span style="color: #000;">]</span><span style="color: #000;">,</span>
        <span style="color: #0a0;">'Grade'</span>:<span style="color: #000;">[</span><span style="color: #000;">99</span><span style="color: #000;">,</span> <span style="color: #000;">98</span><span style="color: #000;">,</span> <span style="color: #000;">95</span><span style="color: #000;">,</span> <span style="color: #000;">90</span><span style="color: #000;">]</span><span style="color: #000;">}</span>
df <span style="color: #000;">=</span> pd.<span style="color: #000;">DataFrame</span><span style="color: #000;">(</span>data<span style="color: #000;">)</span>
wks <span style="color: #000;">=</span> op.<span style="color: #000;">find_sheet</span><span style="color: #000;">(</span><span style="color: #000;">)</span>
wks.<span style="color: #000;">from_df</span><span style="color: #000;">(</span>df<span style="color: #000;">)</span>
</pre></li>
<li><b>のあとでスクリプトを実行</b>ドロップダウンリストから、<b>ボタンアップ</b>を選択し、<b>OK</b>をクリックします。</li>
<li>ボタンを押し、データをワークシートにインポートします。
<p><a class="image"><img alt="300px-Python Button.png" src="../images/Associating_script_with_an_object/300px-Python_Button.png" width="396" /></a></p>
</li>
</ol>
<p><br />
詳細は、<a class="external text" href="../../LabTalk/Script/From_Graphical_Objects.html"><b>図形オブジェクトからPythonスクリプトを実行する</b></a>を参照してください。</p>
