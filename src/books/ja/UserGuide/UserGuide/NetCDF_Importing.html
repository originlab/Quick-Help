<h1 class="firstheading">NetCDFファイルのインポート</h1><p class='urlname' style='display: none'>NetCDF-Importing</p>
<p>Originでは、NetCDFファイルのインポートおよび部分インポートがサポートされています。  
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Import_NetCDF"><span class="tocnumber">1</span> <span class="toctext">NetCDFファイルをインポートする</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#NetCDF_file_location"><span class="tocnumber">1.1</span> <span class="toctext">NetCDFファイルの場所</span></a>
<ul>
<li class="toclevel-3 tocsection-3"><a href="#To_import_a_.nc_file_on_local_PC_or_network"><span class="tocnumber">1.1.1</span> <span class="toctext">ローカルPCもしくはネットワークにある.ncファイルをインポート</span></a></li>
<li class="toclevel-3 tocsection-4"><a href="#To_import_a_.nc_data_on_web"><span class="tocnumber">1.1.2</span> <span class="toctext">Webにある.ncデータをインポート</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-5"><a href="#Data_Connector_Browser"><span class="tocnumber">1.2</span> <span class="toctext">データコネクタブラウザ</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#More_Import_options"><span class="tocnumber">1.3</span> <span class="toctext">詳細なインポートオプション</span></a>
<ul>
<li class="toclevel-3 tocsection-7"><a href="#Connector_icon"><span class="tocnumber">1.3.1</span> <span class="toctext">コネクタアイコン</span></a></li>
<li class="toclevel-3 tocsection-8"><a href="#Browser_panel"><span class="tocnumber">1.3.2</span> <span class="toctext">ブラウザパネル</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-9"><a href="#Import_NetCDF_with_different_Dimensional_Variable"><span class="tocnumber">2</span> <span class="toctext">次元変数の異なるNetCDFをインポート</span></a>
<ul>
<li class="toclevel-2 tocsection-10"><a href="#Import_1_Dimensional_Variable"><span class="tocnumber">2.1</span> <span class="toctext">1次元変数のインポート</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Import_2_Dimensional_Variable"><span class="tocnumber">2.2</span> <span class="toctext">2次元変数のインポート</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Import_3_Dimensional_Variable"><span class="tocnumber">2.3</span> <span class="toctext">3次元変数のインポート</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#Import_4_Dimensional_Variable"><span class="tocnumber">2.4</span> <span class="toctext">4次元変数のインポート</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#Import_a_Pixel_Value_in_3D.2F4D_variable_into_Worksheet_Column"><span class="tocnumber">2.5</span> <span class="toctext">3D/4D変数のピクセル値をワークシート列にインポート</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-15"><a href="#Partial_import_NetCDF"><span class="tocnumber">3</span> <span class="toctext">NetCDFファイルを部分インポート</span></a>
<ul>
<li class="toclevel-2 tocsection-16"><a href="#Specify_the_time_range_for_importing_data"><span class="tocnumber">3.1</span> <span class="toctext">インポートするデータの時間範囲を指定する</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="#Calculate_annual.2Fmonthly_average_during_import"><span class="tocnumber">3.2</span> <span class="toctext">インポート中に年平均/月平均を計算する</span></a></li>
<li class="toclevel-2 tocsection-18"><a href="#Subregion_to_Import"><span class="tocnumber">3.3</span> <span class="toctext">インポートする小領域</span></a></li>
<li class="toclevel-2 tocsection-19"><a href="#Longitude_Shift"><span class="tocnumber">3.4</span> <span class="toctext">経度をずらす</span></a></li>
<li class="toclevel-2 tocsection-20"><a href="#Latitude_Flip"><span class="tocnumber">3.5</span> <span class="toctext">緯度の反転</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="#Formula"><span class="tocnumber">3.6</span> <span class="toctext">数式</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-22"><a href="#Connection_String"><span class="tocnumber">4</span> <span class="toctext">接続文字列</span></a></li>
<li class="toclevel-1 tocsection-23"><a href="#View_Mode"><span class="tocnumber">5</span><span class="toctext">ビューモード</span></a></li>
</ul>
</div>
<h2><a name="Import_NetCDF"></a><span class="mw-headline">NetCDFファイルをインポートする</span></h2>
<p>NetCDFファイルはワークブック/行列ブックにのみインポートできます。.ncファイルをインポートする場合、ワークブックもしくは行列ウィンドウがアクティブになっていることを確認してください。
</p>
<h3><a name="NetCDF_file_location"></a><span class="mw-headline">NetCDFファイルの場所</span></h3>
<h5><a name="To_import_a_.nc_file_on_local_PC_or_network"></a><span class="mw-headline">ローカルPCもしくはネットワークにある.ncファイルをインポート</span></h5>
<ol>
<li>ローカルPCもしくはネットワークにある.ncファイルをインポートするには
<ul><li> .ncファイルをWindowsのエクスプローラーからOriginのワークスペース、ワークブックまたは行列にドラッグします。</li></ul>
または、
<ul><li> <b>データ：ファイルに接続：NetCDF...</b>メニューを選択して.ncファイルを選び、<b>OK</b>をクリックします。</li></ul>
<li> <b>データコネクタブラウザ</b>が開きます。
</ol>
<dl><dd><a  class="image"><img alt="NetCDF Importing 01.png" src="../images/NetCDF_Importing/NetCDF_Importing_01.png" width="667"  /></a></dd></dl>
<h5><a name="To_import_a_.nc_data_on_web"></a><span class="mw-headline">Webにある.ncデータをインポート</span></h5>
<ol>
<li> <b>データ：Webに接続</b>を選択します。
 
<li> <b>Webに接続</b>ダイアログにて、<b>ファイルタイプ</b> を<i>NetCDF</i> (オプション）に設定し、URLリンクを入力します。 (例えば<i>https://psl.noaa.gov/thredds/fileServer/Datasets/cpc_us_precip/precip.V1.0.1948.nc</i>)、もしくは過去にインポートしたことがあれば最近使ったURLをクリックします。<b>OK</b>をクリックします。
<li> <b>データコネクタブラウザ</b>が開きます。
</ol>
<h3><a name="Data_Connector_Browser"></a><span class="mw-headline">データコネクターブラウザ</span></h3>
<p><b>データコネクタブラウザ</b>ダイアログでは、左パネルに全ての変数が基本的な情報とともに一覧表示されます。Originは一度に1変数のインポートのみをサポートしています。
</p><p>左パネルの変数をクリックすると右パネルに追加の情報が表示されます。例えば<i><b>sst</b></i>(上の画像の<a href="#To_import_a_.nc_file_on_local_PC_or_network">最初のセクション</a>)は3次元データです。
</p>
<ol>
<li> ダブルクリックするか下向き矢印をクリックすることで下部パネルに追加されます。 
<li> ワークブックがアクティブでファイルを行列もしくはワークブックにインポートできる場合には、選択するダイアログがポップアップします。
<dl><dd><a  class="image"><img alt="NetCDF rmatrix.png" src="../images/NetCDF_Importing/NetCDF_rmatrix.png" width="353"  /></a></dd></dl>
<ul><li> <b>新規行列ブックを使用</b>：最もシンプルな方法です。</li>
<li> <b>埋め込み行列ブックを使用</b>：行列にデータをインポートしますが、行列はワークブックにシートとして埋め込まれます。</li>
<li> <b>ワークシート列（遅くなる可能性があります）</b>：これにより、行列の各時間フレームが複数の列にインポートされるため、多数の列を含むワークシートが作成され、データが大きい場合は速度が低下する可能性があります。 </li></ul>
<li> <b>インポートオプション</b>ボタン（「鉛筆」アイコン）をクリックして、オプションを設定できます。ここでは、部分インポートを指定したり、経度を変換したり、行列を垂直方向に反転したり、数式を使用してデータを変換したりできます。
<dl><dd><a  class="image"><img alt="OH netcdf import options.png" src="../images/NetCDF_Importing/OH_netcdf_import_options.png" width="667"  /></a></dd></dl>
<li> <b>OK</b>をクリックしてインポートオプションを閉じ、再度<b>OK</b>をクリックしてブラウザを閉じてデータをインポートします。ファイルサイズが大きい場合は、インポート完了まで時間がかかることがあります。ファイルがインポートされると、行列もしくはワークブックの左側にブラウザパネルが追加されます。 
<ul><li>行列にインポートした場合、行列ウィンドウの上側にあるスライダーで各行列オブジェクトの表示を切り替えできます。</li></ul>
<dl><dd><dl><dd><a  class="image"><img alt="OH matrix slider after import.png" src="../images/NetCDF_Importing/OH_matrix_slider_after_import.png" width="799"  /></a></dd></dl></dd></dl>
<ul><li>ワークブックをインポートした場合、全ての列がシートにインポートされます。</li></ul>
</ol>
<h3><a name="More_Import_options"></a><span class="mw-headline">詳細なインポートオプション</span></h3>
<h4><a name="Connector_icon"></a><span class="mw-headline">コネクタアイコン</span></h4>
<p>インポート後、<b>コネクタ</b>アイコン<a  class="image"><img alt="Dadta connector icon connect.png" src="../images/NetCDF_Importing/Dadta_connector_icon_connect.png" width="16"  /></a>がワークブックまたは行列の左上に表示されます。 
</p><p><b>コネクタ</b>アイコンをクリックして次のことが行えます。
</p>
<ul><li> <b>選択...</b>をクリックして他のデータをインポートするよう切り替えます。その前にインポートしたデータと入れ替えます。</li>
<li> <b>オプション</b>を選択して、<b>インポートオプション</b>を変更します。</li></ul>
<dl><dd><a  class="image"><img alt="NetCDF Connector icon.png" src="../images/NetCDF_Importing/NetCDF_Connector_icon.png" width="474"  /></a></dd></dl>
<h4><a name="Browser_panel"></a><span class="mw-headline">ブラウザパネル</span></h4>
<p>ブラウザパネルの左側には、この.ncファイルにあるすべての変数が一覧表示されています。ほかの変数を右クリックすることでそれらを追加できます。
</p>
<ul><li><b>シート追加および接続</b>：ワークブックまたは行列の新しいシートに選択した変数を追加します。</li></ul>
<dl><dd><a  class="image"><img alt="Add and Connect Sheet.png" src="../images/NetCDF_Importing/820px-Add_and_Connect_Sheet.png" width="820"   /></a></dd></dl>
<ul><li><b>アクティブシートに追加</b>：このオプションはワークブックにインポートしたときのみ利用可能です。選択した変数をアクティブなワークシートの新しい列に追加します。 </li></ul>
<dl><dd><a  class="image"><img alt="Add to Active Sheet.png" src="../images/NetCDF_Importing/820px-Add_to_Active_Sheet.png" width="820"   /></a></dd></dl>
<h2><a name="Import_NetCDF_with_different_Dimensional_Variable"></a><span class="mw-headline">次元変数の異なるNetCDFをインポート</span></h2>
<h3><a name="Import_1_Dimensional_Variable"></a><span class="mw-headline">1次元変数のインポート</span></h3>
<p><b>lat</b>, <b>lon</b>　や <b>time</b>, <b>level</b> などは1次元のデータです。これらはワークブックまたは行列にインポートできます。 
<br /><br />
<b>Note:</b> 
ワークブックウィンドウがアクティブな場合に1次元データをインポートしてもワークブックや行列を選択するダイアログはポップアップしません。Originは自動的に単一セルのデータだと判断してそれをワークシート列にインポートします。
</p>
<ol><li> ワークブックウィンドウがアクティブな状態で、メニューから<b>データ：ファイルに接続</b>を選択して.ncファイルを選びます。</li>
<li> <b>データコネクタブラウザ</b>ダイアログにて、変数をダブルクリックするか、インポートする変数を選択して下矢印をクリックします。 </li>
<li> 変数が下部パネルに入ります。 </li>
<li> <b>OK</b>をクリックして、インポートします。 </li>
<li> データコネクタアイコンをクリックし、<b>選択...</b>をクリックすることで別の1次元データをインポートするよう変更します。その前にインポートしたデータと入れ替えます。</li>
<li> 全ての変数はワークブックの左パネルに一覧表示されます。任意の1次元データをクリック、さらに右クリックして<b>アクティブシートに追加</b>を選択して、現在のシートに追加します。<br />または<b>シート追加および接続</b>を選択して同じブックの新しいシートに選択した変数をインポートします。</li></ol>
<h3><a name="Import_2_Dimensional_Variable"></a><span class="mw-headline">2次元変数のインポート</span></h3>
<p><b>lat</b>*<b>lon</b>などは2次元のデータです。これらはワークブックまたは行列にインポートできます。
</p>
<ol><li> 行列ウィンドウがアクティブな状態で、メニューから<b>データ：ファイルに接続</b>を選択して.ncファイルを選びます。</li>
<li> 2次元変数をダブルクリックして抽出、またはインポートする変数を選択して下矢印をクリックします。 </li>
<li> <b>新しい行列ブックを作成</b> をクリックしてインポートします。</li>
<li> 変数が下部パネルに入ります。</li>
<li> <b>OK</b>をクリックして、インポートします。 </li>
<li> データコネクタアイコンをクリックし、<b>選択...</b>をクリックすることで別の2次元データをインポートするよう変更します。その前にインポートしたデータと入れ替えます。</li>
<li> 全ての変数はワークブックの左パネルに一覧表示されます。<b>シート追加および接続</b>を選択して同じブックの新しいシートに選択した変数をインポートします。</li></ol>
<p><br />
</p>
<h3><a name="Import_3_Dimensional_Variable"></a><span class="mw-headline">3次元変数のインポート</span></h3>
<p>3次元データはワークブックまたは行列にインポートできます。 
</p>
<ol><li> メニューから<b>データ：ファイルに接続</b>を選択して.ncファイルを選びます。<a href="#To_import_a_.nc_file_on_local_PC_or_network">最初のセクション</a>の上の画像にある<b>sst</b>のような3次元の変数 (例： <i>time * lat * lon</i>)をインポートします。</li>
<li> ダブルクリックするか下向き矢印をクリックすることで下部パネルに追加されます。 </li>
<li> <b>新しい行列ブックを作成</b> をクリックしてインポートします。</li>
<li> 変数が下部パネルのリストに入ります。</li>
<li> <b>OK</b>をクリックして、インポートします。</li></ol>
<h3><a name="Import_4_Dimensional_Variable"></a><span class="mw-headline">4次元変数のインポート</span></h3>
<p>4次元データはワークブックまたは行列にインポートできます。 
</p>
<ol>
<li> 変数の次元数が4（例えば<i>time[248] * level[18] * lat[180] * lon[360]</i>）の場合には、<b>新しい行列ブックを作成</b>を選択してインポートします。デフォルトでは、Origin はインポートする最初のレベルを選択します。1 つの行列シートを含む行列ブックがそのレベルに対して作成され、レベル値が行列シート名として表示され、各時間枠が 1 つの行列オブジェクトに表示されます。行列シートの上部にあるスライダーをドラッグすることで全てのインポートされた時間フレームを確認できます。
<li><b>コネクタ</b>アイコンをクリック、<b>選択...</b>をクリックして接続文字列（例えば<i>NetCDF/t[z][10][y][x]</i>、これでレベル10がインポートされます）を確認できます。 
<li>行列シートへのインポートでは複数のレベルに対応しています。例えば、<i>NetCDF/t[z][2:5][y][x]</i>と修正することでレベル2からレベル5までをインポートできます。 
<br />行列に全てのレベルをインポートする場合、文字列を<i>NetCDF/t[z][1:0][y][x]</i>または<i>NetCDF/t[z][s][y][x]</i>と修正することができます。 
<li> 次のLabTalkスクリプトを使うことで、全18レベルのデータを各レベルが1つの行列シートにある状態で単一の行列ブックにインポートできます。 
</ol>
<pre class="lt" style="font-family:monospace;">newbook mat<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> sheet<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">18</span>; <span style="color: #008000;">//20シートある行列ブックを作成します</span>
string fname<span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;c:\tmp\mynetCDF\aa.nc&quot;</span>; <span style="color: #008000;">//ファイル名を指定します</span>
wbook.<span style="color: #000080;">dc</span>.<span style="color: #000080;">add</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;netCDF&quot;</span><span style="color: #000000;">)</span>; <span style="color: #008000;">//NetCDFコネクタを行列ブックに追加します</span>
loop<span style="color: #000000;">(</span>i, <span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">18</span><span style="color: #000000;">)</span> 
<span style="color: #000000;">{</span>
   page.<span style="color: #000080;">active</span><span style="color: #000080;">=</span>i; <span style="color: #008000;">//シートをアクティブにします</span>
   wks.<span style="color: #000080;">dc</span>.<span style="color: #000080;">source</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>fname<span style="color: #000080;">$</span>; <span style="color: #008000;">//コネクタのソースファイルをアクティブシートに設定</span>
   wks.<span style="color: #000080;">dc</span>.<span style="color: #000080;">sel</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;NetCDF/t[z][$(i)][y][x]&quot;</span>; <span style="color: #008000;">//どのレベルをインポートするか指定します</span>
   wks.<span style="color: #000080;">dc</span>.<span style="color: #000080;">import</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; <span style="color: #008000;">//インポート</span>
<span style="color: #000000;">}</span></pre>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/NetCDF_Importing/Tip_icon.png" width="57"  border="0" /></td><td><p>データコネクタを使用してNetCDF変数を4Dとして行列にインポートする場合、構造保護によりシートの変更が防止されます。つまり、この行列にシートを挿入/削除/追加したり、シートを新しいブックにドラッグしたりしないでください。
</p>
<dl><dd><a  class="image"><img alt="NetCDF Importing Structure Protection.png" src="../images/NetCDF_Importing/500px-NetCDF_Importing_Structure_Protection.png" width="500"   /></a></dd></dl>
</td></tr></table>
<h3><a name="Import_a_Pixel_Value_in_3D.2F4D_variable_into_Worksheet_Column"></a><span class="mw-headline">3D/4D変数のピクセル値をワークシート列にインポート</span></h3>
<p>Originは、例えば全ての時間枠の特定の緯度経度における単一のピクセル値をワークシートの列にインポートすることをサポートしています。
例えば、time[300]*lat[145]*lon[192]という3D変数の<b>tas</b>があり、列に入った全ての時間フレームの2つめの緯度と5つめの経度の値をインポートしたいとします。
</p>
<ol><li> その場合、ワークブックウィンドウをアクティブにしてnetCDFデータコネクタを開き、.ncファイルを選択します。</li>
<li> データコネクタブラウザダイアログにて、変数<b>tas</b>をダブルクリックします。</li>
<li> 表示されたプロンプトで3つ目のオプション<b>ワークシート列（遅くなる可能性があります）</b>を選択します。
<dl><dd><a  class="image"><img alt="NetCDF sheetormatrix.png" src="../images/NetCDF_Importing/NetCDF_sheetormatrix.png" width="353"  /></a></dd></dl></li>
<li> 下部パネルで<i>[x][2][5]</i>を追加してOKをクリックします。
<dl><dd><a  class="image"><img alt="NetCDF 3D to column.png" src="../images/NetCDF_Importing/NetCDF_3D_to_column.png" width="644"  /></a></dd></dl></li>
<li> 次にワークブックの左パネルで<b>time</b>変数をクリックします。さらに右クリックし<b>アクティブシートに追加</b>を選択して同じシートに時間列を追加します。time列をXにtasをYに設定することで、さらなる解析・プロットが可能です。</li></ol>
<dl><dd><b>Note</b>: 4次元変数 time[300]*level[20]*lat[145]*lon[192] の場合、例えば全時間フレームのレベル1の2つ目の緯度、5つ目の経度のピクセル値を列にインポートするには、<i>[x][1][2][5]</i>を加える必要があります。</dd></dl>
<h2><a name="Partial_import_NetCDF"></a><span class="mw-headline">NetCDFファイルを部分インポートする</span></h2>
<h3><a name="Specify_the_time_range_for_importing_data"></a><span class="mw-headline">インポートするデータの時間範囲を指定する</span></h3>
<p><b>データコネクタブラウザ</b>で、インポートするデータセットを選択した後、<b>インポートオプション - スライス、平均化、数式</b>ボタン<a  class="image"><img alt="NetCDF Import Option.png" src="../images/NetCDF_Importing/NetCDF_Import_Option.png" width="44"  /></a>をクリックし、<b>インポートオプション</b>ダイアログを開きます。
</p>
<ul><li> <b>開始</b> &amp; <b>終了</b>: インポートする日時範囲です。</li></ul>
<ul><li> <b>時間軸のスキップ</b>: <i>m</i> レコードを読み取り、<i>n</i> レコードをスキップして繰り返します。 </li></ul>
<dl><dd>たとえば、データが月次の場合、<b>読み取り</b>= <i>1</i> および<b>スキップ</b>= <i>11</i> は、日時範囲全体で<i>ひと月のデータを読み取り11か月分をスキップ</i>のパターンを繰り返します。</dd>
<dd><a  class="image"><img alt="NetCDF Importing 02.png" src="../images/NetCDF_Importing/NetCDF_Importing_02.png" width="304"  /></a></dd></dl>
<h3><a name="Calculate_annual.2Fmonthly_average_during_import"></a><span class="mw-headline">インポート中に年平均/月平均を計算する</span></h3>
<p>インポート処理の中で、年平均/月平均を直接インポートすることができます。<b>平均化</b>オプションは、<b>間隔</b>に基づいて平均を計算し、<b>年ごと</b>の<b>サンプリング</b>または<b>連続</b>のいずれかを実行します。 
</p><p><a  class="image"><img alt="NetCDF Importing 03.png" src="../images/NetCDF_Importing/NetCDF_Importing_03.png" width="304"  /></a>
</p><p><b>インポートオプション</b>ダイアログで、<b>平均化</b>セクションを広げて設定します。
</p>
<table class="dialogcontroltable">
<tr>
<th>抽出
</th>
<td>
<dl><dd><ul><li><b>連続</b>：連続時間の平均を計算します。  例えば、5年分のデータセットがあるとします。<b>間隔</b> = y に設定すると、連続12か月となります。そのため、年間の平均値を持つ5つの行列を取得することになります。</li></ul></dd></dl>
<dl><dd><ul><li><b>年ごと</b>：各の同じ月の平均を計算します。  例えば、5年分のデータセットがあるとします。<b>間隔</b> = m に設定すると、12の行列が取得され、各行列は当月の5年間の平均値になります。</li></ul></dd></dl>
</td></tr>
<tr>
<th>間隔
</th>
<td>
<p>連続する月を示す数値を入力します。
</p><p>文字を入力します：d=日ごと, m=月ごと, y=年ごと, q=四半期ごと
</p>
</td></tr></table>
<p><br />
ここでは、2つのサンプルを使用して、<b>時間軸のスキップ</b>と<b>平均化</b>のオプションで、指定した月の年間データの平均値をインポートする方法を示します。
</p><p><b>サンプル1：</b> 1990～1903年の各年の3か月（4月、5月、6月）の平均値をインポート
</p>
<dl><dd><a  class="image"><img alt="NetCDF Import Average Consecutive.gif" src="../images/NetCDF_Importing/NetCDF_Import_Average_Consecutive.gif" width="852"  /></a></dd></dl>
<p><br />
<b>サンプル2：</b> 4年間（1900年から1903年まで）の4月、5月、6月の平均値をインポート
</p>
<dl><dd><a  class="image"><img alt="NetCDF Import Average Across Years.gif" src="../images/NetCDF_Importing/NetCDF_Import_Average_Across_Years.gif" width="852"  /></a></dd></dl>
<p><br />
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/NetCDF_Importing/Tip_icon.png" width="57"  border="0" /></td><td><ul><li>2023bから、範囲データ (<i>例: 2022-10-01 1:00 - 2022-10:01: 23:00</i> )の毎日の平均をインポートすると、<i>2022-10-01</i>のように日付部分<b>yyyy-mm-dd</b>でのみ行列名に表示されます。</li></ul>
<ul><li>また、連続した年の平均の場合、行列名は<i>2022</i>のように年で表示されます。この設定を無効にする場合は、システム変数<i><b>@MOL = 1</b></i>に設定します。</li></ul>
</td></tr></table>
<p><br />
</p>
<h3><a name="Subregion_to_Import"></a><span class="mw-headline">インポートする小領域</span></h3>
<p><b>インポートオプション</b>ダイアログで、<b>小領域</b>セクションを展開して、インポートする地域部分を経度と緯度で指定すると、緯度と経度の対応するインデックスが見つかり、接続文字列に使用されます。
</p>
<dl><dd><a  class="image"><img alt="NetCDF subregion.png" src="../images/NetCDF_Importing/NetCDF_subregion.png" width="561"  /></a></dd></dl>
<p>大きなデータでは、小領域とN行またはN列ごとにスキップを行うこともできます。例：NetCDF/analysed_sst[z][2100:4800|1-40#][300:6600|1-50] はインデックス2100から4800までの緯度は1インポート、40スキップ、#は緯度が反転、インデックス300から6600までの経度は1インポート、50スキップ、を意味します。
</p>
<dl><dd><a  class="image"><img alt="NetCDF subregion skip.png" src="../images/NetCDF_Importing/NetCDF_subregion_skip.png" width="826"  /></a></dd></dl>
<h3><a name="Longitude_Shift"></a><span class="mw-headline">経度をずらす</span></h3>
<p>経度が約（0, 360）の範囲にある場合、このチェックボックスをオンにします。経度が(-180,180)にシフトされます。
</p>
<h3><a name="Latitude_Flip"></a><span class="mw-headline">緯度の反転</span></h3>
<p>デフォルトでは、インポートされたデータは南から北となります。緯度を北から南に変更するには、このチェックボックスを選択します。
</p>
<h3><a name="Formula"></a><span class="mw-headline">式</span></h3>
<p>インポート処理において、行列の新しい値を数式によって計算できます。 
</p><p>例えば、インポートした温度データを摂氏から華氏に変換する場合、この編集ボックスに以下の式を入力します。<i><b>v</b></i>は、元のインポートされた行列のセル値を表します。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">(</span>v<span style="color: #000080;">*</span><span style="color: #0000dd;">9</span><span style="color: #000080;">/</span><span style="color: #0000dd;">5</span><span style="color: #000000;">)</span><span style="color: #000080;">+</span><span style="color: #0000dd;">32</span></pre>
<h2><a name="Connection_String"></a><span class="mw-headline">接続文字列</span></h2>
<p>インポートオプションを設定してダイアログを閉じると、左側の下部にある接続文字列が更新され、インポートのカスタマイズに使用した構文が表示されます。直接文字列をダブルクリックして編集/修正することもできます。 
</p>
<dl><dd><dl><dd><a  class="image"><img alt="OH partial import connection string 1.png" src="../images/NetCDF_Importing/OH_partial_import_connection_string_1.png" width="511"  /></a></dd></dl></dd></dl>
<p>接続文字列の構文は複雑になる可能性がありますが、以下の基本的な形式に従います。
</p>
<pre class="lt" style="font-family:monospace;">NetCDF<span style="color: #000080;">/</span>variable<span style="color: #000000;">[</span>z<span style="color: #000000;">]</span><span style="color: #000000;">[</span>y<span style="color: #000000;">]</span><span style="color: #000000;">[</span>x<span style="color: #000000;">]</span></pre>
<p>ここで、variableはインポートする変数であり、z、y、xは、z、y、およびxディメンションデータの部分的なインポートを含む処理を指定します。 
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/NetCDF_Importing/Tip_icon.png" width="57"  border="0" /></td><td><dl><dd><dl><dd> インポートオプションダイアログを使って接続文字列を作成することおすすめします。</dd>
<dd> 4次元変数をインポートする際には1レベルにどのようにインポートするか最初に鉛筆ボタンをクリックします。文字列を取得しレベルの[z]と[y]の部分を修正します。例えば、<b>4次元変数のインポート</b>セクションにあるループ部分を修正します。例えば、iを1から9までループさせ、wks.dc.sel$=&quot;NetCDF/t [1:0|ave-d][$(i*2)][y][x]&quot;を使って他のレベル2、4、6、...、18ごとにインポートし、全フレームインポートではなく、日平均をインポートします。 </dd></dl></dd></dl>
</td></tr></table>
<p><br />
</p>
<h2><a name="View_Mode"></a><span class="mw-headline">ビューモード</span></h2>
<p>NetCDF行列は<b>データモード</b>と<b>イメージモード</b>で表示できます。<b>表示：データモード/イメージモード</b>で変更できます。新しいNetCDFファイルをインポートした際、行列が<b>データモード</b>か<b>イメージモード</b>のどちらで表示されるかは行列サイズに依存します。
</p>
<ul><li> 一般的には、行列は<b>イメージモード</b>で表示されます。</li>
<li> 行列の次元（行*列)が小さい場合、<b>イメージモード</b>の代わりに<b>データモード</b>が使用されます。システム変数<i>@VIM</i>が初回インポート時のイメージ表示を設定する最小のピクセル数を制御しています。デフォルトでは、<i>@VIM=400</i></li>
<li> 行列にファイルを再インポートするときまで選択した<b>ビューモード</b>ｊは維持されます。これは行列の次元には影響しません。</li></ul>


    