<h1 class="firstheading">階層的クラスター分析ダイアログボックス</h1><p class='urlname' style='display: none'>HCA-Dialog</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Dialog_Theme"><span class="tocnumber">1</span><span class="toctext">ダイアログテーマ</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Recalculate"><span class="tocnumber">2</span> <span class="toctext">再計算</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Input"><span class="tocnumber">3</span> <span class="toctext">入力</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Settings"><span class="tocnumber">4</span> <span class="toctext">設定</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Quantities"><span class="tocnumber">5</span> <span class="toctext">量</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Plot"><span class="tocnumber">6</span> <span class="toctext">プロット</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Output_Settings"><span class="tocnumber">7</span> <span class="toctext">出力設定</span></a></li>
</ul>
</div>
<p><br />
</p>
<h2><a name="Dialog_Theme"></a><span class="mw-headline">ダイアログテーマ</span></h2>
<p><a href="../../UserGuide/UserGuide/Dialog_Themes.html" title="ユーザガイド:ダイアログテーマ">ダイアログテーマ</a>をロードまたは保存します。また、<a class="external text" href="../../XFunction/X-Function/Calling_X-Functions_from_Script.html#Generate_Script_from_X-Function_Dialog">スクリプトの生成</a>は現在のダイアログ設定を使ったXファンクションを生成します。
</p>
<h2><a name="Recalculate"></a><span class="mw-headline">再計算</span></h2>
<p><a href="../../UserGuide/UserGuide/Recalculating_Analysis_Results.html" title="ユーザガイド:分析結果の再計算"><b>再計算</b>モード</a>を設定します。
</p>
<h2><a name="Input"></a><span class="mw-headline">入力</span></h2>
<table class="dialogcontroltable">
<tr>
<th>変数
</th>
<td><b>階層的クラスター分析</b>のためのデータを指定します。各列のデータは一つの変数に対応しており、各行は観測値に対応していいます。
</td></tr>
<tr>
<th>観測値ラベル
</th>
<td>観測値のラベルを選択します。ラベルが選ばれた場合、Ｘ軸目盛りとして樹形図に表示されます。これは観測値がクラスターに分類されるものでないと選択できません。ラベル列がテキスト列の場合、カテゴリー列に設定します。
</td></tr></table>
<h2><a name="Settings"></a><span class="mw-headline">設定</span></h2>
<p><b>階層的クラスター分析</b>のための設定を指定します。
</p>
<table class="dialogcontroltable">
<tr>
<th>クラスター
</th>
<td>オブジェクトの種類を指定します。
<ul><li> <b>観測値</b></li></ul>
<dl><dt><dl><dd>クラスターの観測値です。入力データの行はグループごとに分けられています。</dt></dl></dd></dl>
<ul><li> <b>変数</b></li></ul>
<dl><dt><dl><dd>クラスターの変数です。入力データの列はグループごとに分けられています。</dt></dl></dd></dl>
<p>オブジェクトの種類が違う場合、使用できる距離の種類も変わってきます。
</p>
</td></tr>
<tr>
<th>クラスター法
</th>
<td>クラスターと新規のクラスター間の距離を計算するリンク法を選びます。６つの方法が利用できます。
<ul><li> <b>最短距離</b></li></ul>
<dl><dt><dl><dd>基準のクラスターからの距離が最も短い2つのクラスターが統合されて新しいクラスターになります。または単連結法とも呼ばれています。</dt></dl></dd></dl>
<ul><li> <b>最長距離</b></li></ul>
<dl><dt><dl><dd>基準のクラスターからの距離が最も長い2つのクラスターが統合されて新しいクラスターになります。または完全連結法とも呼ばれています。</dt></dl></dd></dl>
<ul><li> <b>群平均</b></li></ul>
<dl><dt><dl><dd>2つの距離の平均で2つのクラスターが統合されて新しいクラスターになります。</dt></dl></dd></dl>
<ul><li> <b>重心</b></li></ul>
<dl><dt><dl><dd>重心はクラスター中心間の距離が最大になるように生成されます。</dt></dl></dd></dl>
<ul><li> <b>中央値</b></li></ul>
<dl><dt><dl><dd>1つのクラスター内にある物ともう1つのクラスター内にある物の中央値になります。</dt></dl></dd></dl>
<ul><li> <b>Ward</b></li></ul>
<dl><dt><dl><dd>クラスター内分散が最小になるようにクラスターが統合されます。</dt></dl></dd></dl>
<p><br />結合法の詳細については<a href="../../UserGuide/UserGuide/Algorithm_(Hierarchical_Cluster_Analysis).html#Linkage_Method" title="ユーザガイド：アルゴリズム（階層的クラスター分析）">結合法のアルゴリズム</a>をご覧ください。
</p>
</td></tr>
<tr>
<th>距離のタイプ
</th>
<td><b>階層的クラスター分析</b>の距離のタイプを選びます。
<p>観測値をクラスターにする場合、3つの手法を選ぶことができます。
</p>
<ul><li> <b>ユークリッド距離</b></li></ul>
<dl><dt><dl><dd> ２つの観測値間の差の二乗和の平方根を取った値です。</dt></dl></dd></dl>
<ul><li> <b>平方ユークリッド距離</b></li></ul>
<dl><dt><dl><dd> ２つの観測値間の差の二乗和を取った値です。</dt></dl></dd></dl>
<ul><li> <b>都市ブロック距離</b></li></ul>
<dl><dt><dl><dd> ２つの観測値間の絶対差を取った値です。またはマンハッタン距離とも呼ばれています。</dt></dl></dd></dl>
<ul><li> <b>Cosine</b></li></ul>
<dl><dt><dl><dd> 1とコサイン係数の2つの観測値の違いです。コサイン係数は、2つのベクトル間の距離の余弦です。</dt></dl></dd></dl>
<ul><li> <b>ピアソン相関</b></li></ul>
<dl><dt><dl><dd> 1と相関した2つの観測値の違いです。</dt></dl></dd></dl>
<ul><li> <b>Jaccard</b></li></ul>
<dl><dt><dl><dd> 1とJaccard係数の2つの観測値の違いです。バイナリデータに関しては、Jaccard係数は2つの観測値の交点と統合したサイズの比と等しくなります。</dt></dl></dd></dl>
<p><br />変数をクラスターにする場合、２つの手法を選ぶことができます。欠損値はペアワイズ方式で取り除かれ、相関が計算されます。
</p>
<ul><li> <b>相関</b></li></ul>
<dl><dt><dl><dd> 1と相関した2つの変数の違いをもとにしています。</dt></dl></dd></dl>
<ul><li> <b>絶対相関</b></li></ul>
<dl><dt><dl><dd> 1と絶対相関した2つの変数の違いをもとにしています。</dt></dl></dd></dl>
<p><br />距離の計算に関する詳細は<a href="../../UserGuide/UserGuide/Algorithm_(Hierarchical_Cluster_Analysis).html#Distance_Matrix" title="ユーザガイド：アルゴリズム（階層的クラスター分析）">距離のアルゴリズム</a>をご覧ください。
</p>
</td></tr>
<tr>
<th>標準化変数
</th>
<td>変数を標準化する方法を指定します。これは観測値がクラスターに分類される時のみ有効になります。
<ul><li> <b>なし</b></li></ul>
<dl><dt><dl><dd>変数は標準化されません。</dt></dl></dd></dl>
<ul><li> <b>Zスコア(N(0, 1)で正規化)</b></li></ul>
<dl><dt><dl><dd>変数は平均0で標準偏差１の状態に標準化されます。</dt></dl></dd></dl>
<ul><li> <b>[0,1]に正規化</b></li></ul>
<dl><dt><dl><dd>変数は0から1の間で標準化されます。</dt></dl></dd></dl>
</td></tr>
<tr>
<th>クラスターの数
</th>
<td>クラスターの数を指定します。ここの値は0より大きくて、有効な観測値（観測値クラスター）または変数（変数クラスター）より大きくなってはいけません。
</td></tr>
<tr>
<th>クラストロイド検索
</th>
<td>クラストロイド（最大/最小代理変数/観測値）を検索する手法を指定します。
<ul><li> <b>距離の和</b></li></ul>
<dl><dt><dl><dd> クラスター内の全ての観測値/変数から測った距離の和を使用して、クラストロイドを検索します。クラスターでは、最大代表変数/観測は最小の距離を持ち、最小代表変数/観測は、最大の距離の和をもちます。</dt></dl></dd></dl>
<ul><li> <b>最大距離</b></li></ul>
<dl><dt><dl><dd> クラスター内の全ての観測値/変数から測った距離の中で最大のものを使用してクラストロイドを検索します。クラスターでは、最大代表変数/観測は最も小さい最大距離を持ち、最小代表変数/観測は、最も大きい最大距離を持ちます。</dt></dl></dd></dl>
<ul><li> <b>距離の二乗和</b></li></ul>
<dl><dt><dl><dd> クラスター内の全ての観測値/変数から測った距離の二乗和を使用して、クラストロイドを検索します。クラスターでは、最大代表変数/観測は最小の距離の二乗和を持ち、最小代表変数/観測は、最大の距離の二乗和をもちます。</dt></dl></dd></dl>
</td></tr></table>
<h2><a name="Quantities"></a><span class="mw-headline">量</span></h2>
<p><b>階層的クラスター分析</b>を計算するための量を指定します。記述統計とクラスターメンバーシップは<b>階層的クラスター分析</b>の結果の中にデフォルトで含まれています。
</p>
<table class="dialogcontroltable">
<tr>
<th>相違行列
</th>
<td>距離行列を出力するかどうかを指定します。オブジェクト数が大きい場合、この距離行列はレポート内ではなく個別のワークシートに表示されます。
</td></tr>
<tr>
<th>クラスターステージ
</th>
<td>クラスターステージを出力するかどうかを指定します。各ステージでは2つのクラスターが統合され、1つの新しいクラスターになっていきます。
</td></tr>
<tr>
<th>クラスター中心
</th>
<td>クラスター中心を計算するかどうかを指定できます。これは観測値がクラスターに分類されるときでないと選択できません。<b>設定</b>ブランチ内の<b>標準化変数</b>で標準化手法が選択されている場合、クラスター中心はこの標準化された変数で計算されます。
</td></tr>
<tr>
<th>クラスター中心間の距離
</th>
<td>クラスター中心間の距離を計算するかどうかを指定できます。これは観測値がクラスターに分類されるときでないと選択できません。
</td></tr>
<tr>
<th>観測とクラスター間の距離
</th>
<td>各観測値とクラスター中心間の距離を計算するかどうかを指定できます。これは観測値がクラスターに分類されるときでないと選択できません。
</td></tr>
<tr>
<th>クラストロイド情報
</th>
<td>最大/最小代表変数あるいは観測を表示するか指定します。
</td></tr></table>
<h2><a name="Plot"></a><span class="mw-headline">プロット</span></h2>
<p>樹形図を表示するか、表示するならどのように表示するかを指定できます。
</p>
<table class="dialogcontroltable">
<tr>
<th>樹形図
</th>
<td>樹形図を表示するかどうかを指定できます。デフォルトの樹状図は、ノードとサブツリーを<a href="../../UserGuide/UserGuide/Interpreting_Results_of_Hierarchical_Cluster_Analysis.html#Dendrogram" title="ユーザガイド：階層的クラスター分析の結果を解釈するには">強調表示して入れ替える</a>ことができる、より動的な「系統樹」にすることができます。
</td></tr>
<tr>
<th>Y 軸で表示
</th>
<td>
<ul><li> <b>距離</b></li></ul>
<dl><dt><dl><dd> 距離は、<a href="../../UserGuide/UserGuide/Algorithm_(Hierarchical_Cluster_Analysis).html#Cluster_Observations" title="ユーザガイド：アルゴリズム（階層的クラスター分析）">距離のタイプ</a>で計算されます。</dt></dl></dd></dl>
<ul><li> <b>類似性</b></li></ul>
<dl><dt><dl><dd> 類似性は100*(1-d/dmax),として計算されます。ここで、dは距離、dmaxはすべての観測値の最大距離、つまり<b>クラスターステージ</b>表の最後の距離の計算です。各クラスターを個別にプロットする設定（<b>プロット</b>タブ &gt; <b>樹形図を表示</b>）の場合、dmaxは全グラフにおける最大値です。</dt></dl></dd></dl>
<p><a class="image"><img alt="Hierarchical cluster dialog box image001.png" src="../images/The_Hierarchical_Cluster_Analysis_Dialog_Box/Hierarchical_cluster_dialog_box_image001.png" width="602"  /></a>
</p>
</td></tr>
<tr>
<th>樹形図を表示
</th>
<td>樹形図を１つのグラフで表示するかクラスターごとに別々に表示するかを指定します。これは<b>樹形図</b>にチェックがついている時のみ利用できます。
<ul><li> <b>1つのグラフ内</b></li></ul>
<dl><dt><dl><dd> 樹形図を１つのグラフ内に表示します。別々のクラスターは色分けされています。</dt></dl></dd></dl>
<ul><li> <b>クラスターの別々のグラフ内</b></li></ul>
<dl><dt><dl><dd> クラスターの樹形図を別々のグラフとして表示します。各クラスターは個別のグラフに出力されます。</dt></dl></dd></dl>
</td></tr>
<tr>
<th>方向
</th>
<td>樹形図の向きを指定します。これは<b>樹形図</b>にチェックがついている時のみ利用できます。
<ul><li> <b>垂直</b></li></ul>
<dl><dt><dl><dd> 樹形図を垂直にプロットします。</dt></dl></dd></dl>
<ul><li> <b>水平</b></li></ul>
<dl><dt><dl><dd> 樹形図を水平にプロットします。</dt></dl></dd></dl>
<ul><li> <b>円</b></li></ul>
<dl><dt><dl><dd> 円形の樹形図をプロットします。 </dt></dl></dd></dl>
</td></tr></table>
<h2><a name="Output_Settings"></a><span class="mw-headline">出力設定</span></h2>
<p><b>階層的クラスター分析</b>結果の出力先を指定します。
</p>
<table class="dialogcontroltable">
<tr>
<th>クラスターレポート
</th>
<td><b>階層的クラスター分析</b>レポートの出力シートを指定します。デフォルトは入力データがあるワークブックに新しいシートを作成して表示します。
</td></tr>
<tr>
<th>クラスターメンバーシップ
</th>
<td>クラスターメンバーシップと観測値とクラスター間の距離を表示するシートを指定します。デフォルトは入力データがあるワークブックに新しいシートを作成して表示します。
</td></tr></table>
<p><br />
</p>

    