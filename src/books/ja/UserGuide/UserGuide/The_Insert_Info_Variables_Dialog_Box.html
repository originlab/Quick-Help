<h1 class="firstheading">変数の挿入ダイアログボックス(テキストラベルと一緒に使用)</h1>
<p class="urlname" style="display: none;">GraphRef-InsInfoVar-Dialog</p>
<dl>
<dd><a class="image"><img alt="Insert Info Var 1.png" src="../images/The_Insert_Info_Variables_Dialog_Box/Insert_Info_Var_1.png" width="853" height="400" border="0" /></a></dd>
</dl>
<p>ワークブック<a href="../../UserGuide/Category/Accessing_Metadata_Associated_with_Imported_Files.html" title="カテゴリ：インポートしたファイルに関連するメタデータにアクセス"><b>メタデータ</b></a>をワークブックや、ワークブックデータから作成したグラフにあるテキストオブジェクトに挿入するためには、<b>変数の挿入</b>ダイアログボックスを使います。</p>
<ul>
<li>メタデータをワークシートのセルに挿入したり、<b>列値の設定</b>ダイアログの<b>実行前処理スクリプト</b>パネルに変数を挿入したい場合は<a href="../../UserGuide/UserGuide/The_Insert_Variables_Dialog_Box.html" title="ユーザーガイド:変数の挿入ダイアログボックス">このページ</a>を参照してください</li>
</ul>
<ul>
<li>テキストオブジェクトにLabTalk変数（スクリプトウィンドウで定義されたOGSファイルなど）を挿入したい場合、<a href="../../UserGuide/UserGuide/Linking_Text_Labels_to_Data_and_Variables.html" title="ユーザガイド:テキストオブジェクトとデータや変数のリンク">「テキストオブジェクトとデータや変数のリンク」</a>をご覧ください。</li>
</ul>
<div id="toc" class="toc">
<div id="toctitle">
<h2>目次</h2>
</div>
<ol>
<li class="toclevel-1 tocsection-1"><a href="#To_open_this_tool:"><span class="tocnumber">1</span> <span class="toctext">このツールを開くには</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Left_Panel"><span class="tocnumber">2</span> <span class="toctext">左パネル</span></a>
<ol>
<li class="toclevel-2 tocsection-3"><a href="#Insert_as_Link"><span class="tocnumber">2.1</span> <span class="toctext">リンクとして挿入</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Insert_as_.22Property.3DValue.22"><span class="tocnumber">2.2</span> <span class="toctext">Property = Value"として挿入</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Start_New_Line_for_Each_Insert"><span class="tocnumber">2.3</span> <span class="toctext">挿入で新しい行を開始</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Verbatim"><span class="tocnumber">2.4</span> <span class="toctext">入力のまま</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Numeric_Display_Format"><span class="tocnumber">2.5</span> <span class="toctext">数値表示フォーマット</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Data_Selection_Button_.28selecting_cell.28s.29_from_a_worksheet.29"><span class="tocnumber">2.6</span> <span class="toctext">データ選択ボタン(ワークシートからセルを選択）</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Info_tab"><span class="tocnumber">2.7</span> <span class="toctext">情報タブ</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Label_tab"><span class="tocnumber">2.8</span> <span class="toctext">ラベルタブ</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Current_Origin_Object"><span class="tocnumber">2.9</span> <span class="toctext">現在のOriginオブジェクト</span></a></li>
</ol>
</li>
<li class="toclevel-1 tocsection-12"><a href="#Right_Panel"><span class="tocnumber">3</span> <span class="toctext">右パネル</span></a></li>
<li class="toclevel-1 tocsection-13"><a href="#Inserting_Variables_Extracted_from_Imported_ASCII_Files_into_Text_Labels"><span class="tocnumber">4</span> <span class="toctext">インポートしたASCIIファイルから抽出した変数をテキストラベルに挿入</span></a></li>
</ol>
</div>
<h3><a name="To_open_this_tool:" id="To_open_this_tool:"></a><span class="mw-headline">このツールを開くには</span></h3>
<p>テキストオブジェクトを編集モードにして、<b>変数の挿入</b>ダイアログを開きます。方法は、2つあります。</p>
<ol>
<li><b>Ctrl+H</b>キーを押します。</li>
<li>右クリックして、コンテキストメニューから<b>情報変数の挿入</b>を選択します。</li>
</ol>
<dl>
<dd><a class="image"><img alt="Insert Info Var 2.png" src="../images/The_Insert_Info_Variables_Dialog_Box/Insert_Info_Var_2.png" width="457" height="347" border="0" /></a></dd>
</dl>
<h2><a name="Left_Panel" id="Left_Panel"></a><span class="mw-headline">左パネル</span></h2>
<h3><a name="Insert_as_Link" id="Insert_as_Link"></a><span class="mw-headline">リンクとして挿入</span></h3>
<p>実行時に、変数がリンクする文字列を挿入するには、このチェックボックスを選択します。変数を変えると、対応する文字列が更新されます。</p>
<p><b>ラベル</b>タブがアクティブな状態で、<a href="../../UserGuide/UserGuide/The_Insert_Info_Variables_Dialog_Box.html#Right_Panel" title="ユーザガイド: 変数の挿入ダイアログボックス">右側パネル</a>で列が選択されている場合に、2つの<b>リンク...</b>プロパティ間で選ぶことができます。</p>
<ul>
<li><b>プロットインデックスのリンク</b></li>
</ul>
<dl>
<dd>リンクの形式は次のようになります。<i><b>%(1Y,@LC)</b></i>これは最初のYデータプロットのコメントを表示します。</dd>
</dl>
<table class="simple" width="50%">
<tr>
<th>リンクの表記</th>
<th>説明</th>
</tr>
<tr>
<td scope="col" width="100">1</td>
<td>プロットのインデックス(Plot1)</td>
</tr>
<tr>
<td>Y</td>
<td>データプロット</td>
</tr>
<tr>
<td>@LC</td>
<td>コメント(@LL = ロングネーム, @LU = 単位、等)</td>
</tr>
</table>
<p><br /></p>
<ul>
<li><b>列インデックスのリンク</b></li>
</ul>
<dl>
<dd>リンクの形式は次のようになります。<i><b>%(1@W,2,C)</b></i>これはワークシートの2列目を表示します。</dd>
</dl>
<table class="simple" width="50%">
<tr>
<th>リンクの表記</th>
<th>説明</th>
</tr>
<tr>
<td scope="col" width="100">1</td>
<td>プロットのインデックス(Plot1)</td>
</tr>
<tr>
<td>@W</td>
<td>ブックのショートネーム</td>
</tr>
<tr>
<td>2</td>
<td>表の列インデックス</td>
</tr>
<tr>
<td>C</td>
<td>コメント(L = ロングネーム, U = 単位、等)</td>
</tr>
</table>
<table class="note">
<tr>
<td><b>Note</b>:変数オプションの一覧(<b>@letter</b>引数)は<a class="external text" href="../../LabTalk/LabTalk/Text_Label_Options.html#Complete_List_of_.40Options"><b>テキストラベルオプション</b></a>にあります。</td>
</tr>
</table>
<h3><a name="Insert_as_.22Property.3DValue.22" id="Insert_as_.22Property.3DValue.22"></a><span class="mw-headline">"Property = Value" の形式で挿入</span></h3>
<p>"Property=Value"の形式変数を挿入します。例えば、「Unit=cm」と入力します。これは、ファイルインポート時に抽出した変数を挿入するときに便利です。<a href="../../UserGuide/UserGuide/The_Insert_Info_Variables_Dialog_Box.html#Inserting_Variables_Extracted_from_Imported_ASCII_Files_into_Text_Labels" title="ユーザガイド: 変数の挿入ダイアログボックス">以下</a>をご覧ください。</p>
<h3><a name="Start_New_Line_for_Each_Insert" id="Start_New_Line_for_Each_Insert"></a><span class="mw-headline">挿入で新しい行を開始</span></h3>
<p>挿入値から、テキストラベルの新しい行を開始します。</p>
<h3><a name="Verbatim" id="Verbatim"></a><span class="mw-headline">逐次解釈</span></h3>
<p>このチェックボックスを選択して、テキスト内に含まれるエスケープシーケンスを無効にします。これは、ファイルパスなどバックスラッシュ(日本語フォントの環境では\)を含む変数を挿入するときに便利です。</p>
<table class="note">
<tr>
<td><b>Note:</b>上付きまたは下付き文字のある変数を表示したい場合は、このチェックボックスにチェックを<b>付けないで</b>ください。</td>
</tr>
</table>
<h3><a name="Numeric_Display_Format" id="Numeric_Display_Format"></a><span class="mw-headline">数値表示フォーマット</span></h3>
<p><b>情報</b>タブがアクティブになっている場合、編集が可能です。デフォルトでは空になっていて、この場合、内部表示フォーマットを使います。ワークシートに表示された通りの値コントロールの右端の矢印をクリックすると、サンプルフォーマットオプションをいくつかご覧いただけます。このリストから選択するか、<a class="external text" href="../../LabTalk/LabTalk/Origin_Formats.html"><b>Originフォーマット</b></a>のリストを使ってボックスに入力します。フォーマットには、D（日付）とT（時間）のオプションがあります。日付と時間がデータがワークシート中に数値で表示される限り、<i>なし</i>は、完全精度の挿入（double =15桁）します。</p>
<table class="note">
<tr>
<td><b>Note</b>:ここで設定した数値形式の表示では、ユーザ変数のノードにデータを反映することができません。これは、ユーザ変数内のデータは、数値や日付のように見えても文字列であるためです。</td>
</tr>
</table>
<h3><a name="Data_Selection_Button_.28selecting_cell.28s.29_from_a_worksheet.29" id="Data_Selection_Button_.28selecting_cell.28s.29_from_a_worksheet.29"></a><span class="mw-headline">データ選択ボタン(ワークシートからセルを選択）</span></h3>
<p>データ選択ボタン<a class="image"><img alt="Button Select Data Interactive.png" src="../images/The_Insert_Info_Variables_Dialog_Box/Button_Select_Data_Interactive.png" width="18" border="0" /></a>を使って、ワークシートセル（データ行/ラベル行）の値を20個まで挿入できます。フォルダーにある全てのワークシートからセルの値を入力することができます。</p>
<p>セルの値にテキストラベルをリンクする(<b>値をリンク</b>ボックス)場合、 基本となるLabTalkのコードは次の通りです。</p>
<dl>
<dd><i><b>%(1, @WT, ColIndex, RowIndex)</b></i>.</dd>
</dl>
<p>シンタックスについては、LabTalk ヘルプファイルのトピック<a class="external text" href="../../LabTalk/LabTalk/Legend_Substitution_Notation.html#Worksheet_Cell_Access">ワークシートセルにアクセス</a>をご覧ください。</p>
<h3><a name="Info_tab" id="Info_tab"></a><span class="mw-headline">情報タブ</span></h3>
<p>挿入する情報を選びます。</p>
<dl>
<dd><a class="image"><img alt="Insert Info Var 3.png" src="../images/The_Insert_Info_Variables_Dialog_Box/Insert_Info_Var_3.png" width="438" height="181" border="0" /></a></dd>
</dl>
<h3><a name="Label_tab" id="Label_tab"></a><span class="mw-headline"><b>ラベル</b>タブ</span></h3>
<p>右側パネルで列を選択すると、<b>ロングネーム</b>、<b>コメント</b>、<b>単位</b>などの列ラベルが、このタブに表示されます。 ラベルを選択して、テキストオブジェクト内にラベルを挿入することができます。</p>
<dl>
<dd><a class="image"><img alt="Insert Info Var 4.png" src="../images/The_Insert_Info_Variables_Dialog_Box/Insert_Info_Var_4.png" width="439" height="182" border="0" /></a>.</dd>
</dl>
<h3><a name="Current_Origin_Object" id="Current_Origin_Object"></a><span class="mw-headline">現在のOriginオブジェクト</span></h3>
<p>この編集不可のテキストは、右側パネルで選択したOriginオブジェクトを示しています。</p>
<table class="simple" width="35%">
<tr>
<th>右パネルのオブジェクト</th>
<th>テキスト表示</th>
</tr>
<tr>
<td>グラフプロット</td>
<td><i><b>[GraphWindow]LayerIndex!PlotIndex"PlotLegend"</b></i></td>
</tr>
<tr>
<td>縦棒</td>
<td><i><b>[Workbook]worksheet!column</b></i></td>
</tr>
<tr>
<td>ワークブック</td>
<td><i><b>[Workbook]</b></i></td>
</tr>
<tr>
<td>ワークシート</td>
<td><i><b>[Workbook]worksheet</b></i></td>
</tr>
</table>
<h2><a name="Right_Panel" id="Right_Panel"></a><span class="mw-headline">右パネル</span></h2>
<p>目的のグラフのプロットは、このパネルに表示されます。プロットの元のデータは、プロット名の下に表示されます。Originの異なるオブジェクトを選択して、対応する情報を左側パネルに表示することが可能です。そして、左側パネルで情報を選択して、挿入することができます。</p>
<dl>
<dd><a class="image"><img alt="Insert Info Var 5.png" src="../images/The_Insert_Info_Variables_Dialog_Box/Insert_Info_Var_5.png" width="246" height="126" border="0" /></a></dd>
</dl>
<h2><a name="Inserting_Variables_Extracted_from_Imported_ASCII_Files_into_Text_Labels" id="Inserting_Variables_Extracted_from_Imported_ASCII_Files_into_Text_Labels"></a><span class="mw-headline">インポートしたASCIIファイルから抽出した変数を、テキストラベルに挿入する</span></h2>
<p><a href="../../UserGuide/Category/The_Import_Wizard.html" title="カテゴリ：インポートウィザード"><b>インポートウィザード</b></a>でファイルをインポートするとき、<a href="../../UserGuide/UserGuide/Extracting_Variables_from_the_File_Name_and_header.html" title="ユーザガイド：ファイル名とヘッダからの変数を抽出">ファイル名とヘッダ情報を変数として識別する</a>できます。抽出した<b>メタデータ</b>は、次の方法でテキストラベルに挿入することができます。</p>
<ol>
<li>標準的なテキストラベル作成法を使って、新しいテキストラベルを作成します。</li>
<li>テキスト入力モードで、「CTRL＋Hキー」を押すか、右クリックをして、<b>情報変数の挿入</b>を選びます。 <strong class="selflink"><b>情報変数の挿入</b></strong>ダイアログボックスが開きます。</li>
</ol>
<p><b>情報変数の挿入</b>ダイアログボックスは、ASCIIファイルインポート中に抽出された変数を一覧表示します。 次の3つの方法で、変数を選択、挿入することができます。</p>
<table class="simple">
<tr>
<th>テキスト</th>
<td>
<p><b>リンクとして挿入</b>チェックボックスか、<b>"Property = Value"として挿入</b>チェックボックスのいずれも選択していない場合、変数の値は文字として挿入されます。</p>
<dl>
<dd><a class="image"><img alt="Insert Var 3.png" src="../images/The_Insert_Info_Variables_Dialog_Box/Inserting_Variables_3.png" width="390" border="0" /></a></dd>
</dl>
</td>
</tr>
<tr>
<th>リンクとして挿入</th>
<td>変数の値に動的にリンクする文字列を挿入するには、このボックスにチェックを付けます。 文字列の値を変更すると、次にファイルをインポートするときにラベルの値が変更されます。
<p>詳細は、<a href="../../UserGuide/UserGuide/Linking_Text_Labels_to_Data_and_Variables.html" title="ユーザガイド:テキストラベルを、データと変数にリンク">テキストオブジェクトと値や変数のリンク</a>をご覧下さい。</p>
</td>
</tr>
<tr>
<th>"Property = Value"として挿入</th>
<td>
<p>このボックスを選択して、テキストラベルに<i>「変数名= 値」</i>を挿入します。</p>
<dl>
<dd><a class="image"><img alt="Insert Var 4.png" src="../images/The_Insert_Info_Variables_Dialog_Box/Inserting_Variables_4.png" width="446" border="0" /></a></dd>
</dl>
</td>
</tr>
</table>
<table class="noborder">
<tr>
<td style="vertical-align: top;" width="60"><img src="../images/The_Insert_Info_Variables_Dialog_Box/Tip_icon.png" alt="" width="57" border="0" /></td>
<td>
<p>ページオブジェクトに保存されている変数は、次のコマンドを使って、コマンドウィンドウで表示することができます。</p>
<pre class="lt" style="font-family: monospace;">
Page.<span style="color: #000080;">info</span>.<span style="color: #000080;">user</span>.<span style="color: #000080;">=</span>
                
</pre></td>
</tr>
</table>
<dl>
<dd><a class="image"><img alt="Insert Info Var 6.png" src="../images/The_Insert_Info_Variables_Dialog_Box/Insert_Info_Var_6.png" width="808" height="619" border="0" /></a></dd>
</dl>
