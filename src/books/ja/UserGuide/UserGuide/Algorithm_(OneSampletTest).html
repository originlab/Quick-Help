<h1 class="firstheading">アルゴリズム(1群のt検定)</h1><p class='urlname' style='display: none'>tTest-OneSample-Algorithm</p>
<p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Test_Statistics"><span class="tocnumber">1</span>  <span class="toctext">検定統計量</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Confidence_Intervals"><span class="tocnumber">2</span> <span class="toctext">信頼区間</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Power_Analysis"><span class="tocnumber">3</span> <span class="toctext">検出力解析</span></a></li>
</ul>
</div>

<p>1群の<i>t</i>検定は、真の母平均 <img src="../images/Algorithm_(OneSampletTest)/math-d4af45ea35b4839bf0a40ebb0c7a4407.png" title="\mu\,\!" alt="\mu\,\!" class="tex"/> が、指定した検定の平均 <img src="../images/Algorithm_(OneSampletTest)/math-5ab7c597b4d8943eb3551df415047c1e.png" title="\mu_0\,\!" alt="\mu_0\,\!" class="tex"/> に等しいかまたは異なるかを検定するのに使用します。検定は 片側または両側のどちらかにすることができ、仮説は次のようになります。
</p><p><img src="../images/Algorithm_(OneSampletTest)/math-e65765bedcabe42c66ec93228769e82a.png" title="H_0" alt="H_0" class="tex"/>:<img src="../images/Algorithm_(OneSampletTest)/math-88ea6cb23d8ae9ba9d5dac8b9805cc5c.png" title="\mu=\mu_0 ," alt="\mu=\mu_0 ," class="tex"/>  vs  <img src="../images/Algorithm_(OneSampletTest)/math-6207a80403dcccc1aa3b5b7303315c4b.png" title="H_1" alt="H_1" class="tex"/>:<img src="../images/Algorithm_(OneSampletTest)/math-f5d01355034cb1abf5d128b393ddebff.png" title="\mu \ne \mu_0" alt="\mu \ne \mu_0" class="tex"/>, <i>両側</i>
</p><p><img src="../images/Algorithm_(OneSampletTest)/math-e65765bedcabe42c66ec93228769e82a.png" title="H_0" alt="H_0" class="tex"/>:<img src="../images/Algorithm_(OneSampletTest)/math-acb57c5744a84b290a04f02b1545e9f3.png" title="\mu \le \mu_0" alt="\mu \le \mu_0" class="tex"/>  vs  <img src="../images/Algorithm_(OneSampletTest)/math-6207a80403dcccc1aa3b5b7303315c4b.png" title="H_1" alt="H_1" class="tex"/>:<img src="../images/Algorithm_(OneSampletTest)/math-a26ea3495ca267e259fed0188e7f396e.png" title="\mu &gt; \mu_0" alt="\mu &gt; \mu_0" class="tex"/>, <i>上側</i>
</p><p><img src="../images/Algorithm_(OneSampletTest)/math-e65765bedcabe42c66ec93228769e82a.png" title="H_0" alt="H_0" class="tex"/>:<img src="../images/Algorithm_(OneSampletTest)/math-d8c59401e54095893dbf55a817ee57c2.png" title="\mu \ge \mu_0" alt="\mu \ge \mu_0" class="tex"/>  vs  <img src="../images/Algorithm_(OneSampletTest)/math-6207a80403dcccc1aa3b5b7303315c4b.png" title="H_1" alt="H_1" class="tex"/>:<img src="../images/Algorithm_(OneSampletTest)/math-067938f8db0864ed2e506bec3acd6e85.png" title="\mu &lt; \mu_0" alt="\mu &lt; \mu_0" class="tex"/>, <i>下側</i>
</p>
<h3><a name="Test_Statistics"></a><span class="mw-headline">検定統計量</span></h3>
<p><img src="../images/Algorithm_(OneSampletTest)/math-888d89edfa615618d98b9d9dc1f12026.png" title="X(x_1,x_2,...,x_n)\,\!" alt="X(x_1,x_2,...,x_n)\,\!" class="tex"/> を入力データセットとすると、統計<i>t</i> 値は自由度が(n-1)のスチューデント<i>t</i> 分布になり、下記のように計算されます。
</p><p><img src="../images/Algorithm_(OneSampletTest)/math-d18e7f1610875a541d3b0fa8d770cef1.png" title="t=\frac{\bar{x}-\mu}{s/\sqrt{n}}" alt="t=\frac{\bar{x}-\mu}{s/\sqrt{n}}" class="tex"/>
</p><p>ここで <img src="../images/Algorithm_(OneSampletTest)/math-38ec78183e6af5e1a3f9c7f463fd519b.png" title="\bar{x}=\frac{1}{n}\sum_{i=1}^n x_i" alt="\bar{x}=\frac{1}{n}\sum_{i=1}^n x_i" class="tex"/> と<img src="../images/Algorithm_(OneSampletTest)/math-ab65ebd68263770b61cf182d644bcaae.png" title="s=\sqrt{\sum_{i=1}^n \frac{(x_i-\bar{x})^2}{n-1}}" alt="s=\sqrt{\sum_{i=1}^n \frac{(x_i-\bar{x})^2}{n-1}}" class="tex"/>
</p><p>与えられた有意水準 <img src="../images/Algorithm_(OneSampletTest)/math-06f7895cd704b1cb0921cf98aec71926.png" title="\alpha\,\!" alt="\alpha\,\!" class="tex"/> において、帰無仮説 <img src="../images/Algorithm_(OneSampletTest)/math-806277203dedea2ed8321f6cbd465a54.png" title="H_0\,\!" alt="H_0\,\!" class="tex"/> は、次の場合に棄却されます。
</p><p><img src="../images/Algorithm_(OneSampletTest)/math-b37bac03b98cbfc5efc0be8f8cb9e6b4.png" title="|t|&gt;t_{\alpha/2}\,\!" alt="|t|&gt;t_{\alpha/2}\,\!" class="tex"/>, <i>両側検定</i>
</p><p><img src="../images/Algorithm_(OneSampletTest)/math-ab4bac1fdde96c4f73a79e338654c86f.png" title="t&gt;t_{\alpha}\,\!" alt="t&gt;t_{\alpha}\,\!" class="tex"/>, <i>上側検定</i>
</p><p><img src="../images/Algorithm_(OneSampletTest)/math-5ada703667ed6b0bac90e7e882e7eac5.png" title="t&lt;-t_{\alpha}\,\!" alt="t&lt;-t_{\alpha}\,\!" class="tex"/>, <i>下側検定</i>
</p><p>ここで <img src="../images/Algorithm_(OneSampletTest)/math-cb6ea21e39ab34cb7538f2232d83de22.png" title="t_\alpha\,\!" alt="t_\alpha\,\!" class="tex"/> は、<img src="../images/Algorithm_(OneSampletTest)/math-06f7895cd704b1cb0921cf98aec71926.png" title="\alpha\,\!" alt="\alpha\,\!" class="tex"/> レベルでの自由度<img src="../images/Algorithm_(OneSampletTest)/math-cee44a4736519848cd908612350c85fe.png" title="(n-1)" alt="(n-1)" class="tex"/> のt分布からの限界値です。仮説の確率を表すより良い方法は、 <i>P</i> 値も出力することです。そして、<img src="../images/Algorithm_(OneSampletTest)/math-1f3050c84e32960a811642f3ae50c620.png" title="p &lt; \alpha\,\!" alt="p &lt; \alpha\,\!" class="tex"/> のとき、帰無仮説 <img src="../images/Algorithm_(OneSampletTest)/math-806277203dedea2ed8321f6cbd465a54.png" title="H_0\,\!" alt="H_0\,\!" class="tex"/> を棄却できます。<i>t</i> 統計に対する <i>P</i> 値は、不完全ベータ関数で計算できます。
</p><p><img src="../images/Algorithm_(OneSampletTest)/math-ec6611c1fbbb5c6556abf1a4ceadd914.png" title="p(t&gt;t_{\alpha})=1-I_{\frac{DOF}{DOF+I^2}}(\frac{DOF}{2},\frac{1}{2})" alt="p(t&gt;t_{\alpha})=1-I_{\frac{DOF}{DOF+I^2}}(\frac{DOF}{2},\frac{1}{2})" class="tex"/>
</p><p><br />
ここで、<img src="../images/Algorithm_(OneSampletTest)/math-3a5bcfb62e8795d2a1865aa0d56210a5.png" title="I_x(\alpha,\beta)=\frac{I&apos;(\alpha+\beta)}{I&apos;(\alpha)\cdot I&apos;(\beta)} \int_0^x t^{\alpha-1}(1-t)^{\beta-1}\,dt" alt="I_x(\alpha,\beta)=\frac{I&apos;(\alpha+\beta)}{I&apos;(\alpha)\cdot I&apos;(\beta)} \int_0^x t^{\alpha-1}(1-t)^{\beta-1}\,dt" class="tex"/>です。
</p>
<h3><a name="Confidence_Intervals"></a><span class="mw-headline">信頼区間</span></h3>
<p>指定した有意水準で、標本の平均に対する信頼区間は次式になります。
</p>
<table class="simple">
<tr>
<th>帰無仮説
</th>
<th>信頼区間
</th></tr>
<tr>
<td><img src="../images/Algorithm_(OneSampletTest)/math-0e07ec7acebf87e9f0a3393a7d4b1494.png" title="H_0:\mu=\mu_0\,\!" alt="H_0:\mu=\mu_0\,\!" class="tex"/>
</td>
<td> <img src="../images/Algorithm_(OneSampletTest)/math-72771118b48ec994926fcd86e53b7bab.png" title="\left[\bar{x}-t_{n-1,\alpha/2}\frac{s}{\sqrt{n}},\bar{x}+t_{n-1,\alpha/2}\frac{s}{\sqrt{n}}\right]" alt="\left[\bar{x}-t_{n-1,\alpha/2}\frac{s}{\sqrt{n}},\bar{x}+t_{n-1,\alpha/2}\frac{s}{\sqrt{n}}\right]" class="tex"/>
</td></tr>
<tr>
<td><img src="../images/Algorithm_(OneSampletTest)/math-cef745c83d012633dc3ec4cab2bddf05.png" title="H_0:\mu \le \mu_0" alt="H_0:\mu \le \mu_0" class="tex"/>
</td>
<td> <img src="../images/Algorithm_(OneSampletTest)/math-052bc488001c8ec3a15a2607c0bd4c12.png" title="\left[\bar{x}-t_{n-1,\alpha}\frac{s}{\sqrt{n}}, \infty\right]" alt="\left[\bar{x}-t_{n-1,\alpha}\frac{s}{\sqrt{n}}, \infty\right]" class="tex"/>
</td></tr>
<tr>
<td><img src="../images/Algorithm_(OneSampletTest)/math-72f86998b84d9769989044e8a2258378.png" title="H_0:\mu \ge \mu_0" alt="H_0:\mu \ge \mu_0" class="tex"/>
</td>
<td> <img src="../images/Algorithm_(OneSampletTest)/math-f30767e8f6276ff0642f817d4931fa8a.png" title="\left[-\infty, \bar{x}+t_{n-1,\alpha}\frac{s}{\sqrt{n}}\right]" alt="\left[-\infty, \bar{x}+t_{n-1,\alpha}\frac{s}{\sqrt{n}}\right]" class="tex"/>
</td></tr></table>
<h3><a name="Power_Analysis"></a><span class="mw-headline">検出力解析</span></h3>
<p>1群の t検定の検出力は、その感度の測定です。帰無仮説および対立仮説に関して、検出力は検定する統計量 <i>T</i> が、実際に帰無仮説を棄却すべき(例：与えられた帰無仮説が真でない)ときに、帰無仮説を棄却するのに十分であるという確率です。3つの異なる帰無仮説のそれぞれに対して、検出力は数学的に以下のように定義されます。
</p>
<table class="simple">
<tr>
<th>帰無仮説
</th>
<th>検出力
</th></tr>
<tr>
<td><img src="../images/Algorithm_(OneSampletTest)/math-0c10119befd073cec6a27f07496f89b1.png" title="H_0:\mu=\mu_0 " alt="H_0:\mu=\mu_0 " class="tex"/>
</td>
<td><img src="../images/Algorithm_(OneSampletTest)/math-3792e357d6b8eb168654fd02eb5c4b3b.png" title="1-P \left\{T \le t_{1-\alpha/2}(n-1)-t\right\}+P\left\{T&lt;t_{\alpha/2}(n-1)-t \right\}" alt="1-P \left\{T \le t_{1-\alpha/2}(n-1)-t\right\}+P\left\{T&lt;t_{\alpha/2}(n-1)-t \right\}" class="tex"/>
</td></tr>
<tr>
<td><img src="../images/Algorithm_(OneSampletTest)/math-cef745c83d012633dc3ec4cab2bddf05.png" title="H_0:\mu \le \mu_0" alt="H_0:\mu \le \mu_0" class="tex"/>
</td>
<td><img src="../images/Algorithm_(OneSampletTest)/math-793ca8ed26d47c70d24a482bb9fed930.png" title="1-P \left\{T \le t_{1-\alpha}(n-1)-t\right\}" alt="1-P \left\{T \le t_{1-\alpha}(n-1)-t\right\}" class="tex"/>
</td></tr>
<tr>
<td><img src="../images/Algorithm_(OneSampletTest)/math-72f86998b84d9769989044e8a2258378.png" title="H_0:\mu \ge \mu_0" alt="H_0:\mu \ge \mu_0" class="tex"/>
</td>
<td><img src="../images/Algorithm_(OneSampletTest)/math-9f2de4621d15fe747d43bab604aa6a96.png" title="P \left\{T \le t_{\alpha}(n-1)-t\right\}" alt="P \left\{T \le t_{\alpha}(n-1)-t\right\}" class="tex"/>
</td></tr></table>
<p>ここで <i>T</i> は、<i>t</i> 分布(自由度 <img src="../images/Algorithm_(OneSampletTest)/math-cee44a4736519848cd908612350c85fe.png" title="(n-1)" alt="(n-1)" class="tex"/> )を持つランダムな変数です。仮説の検出力に対する計算は、検定する統計量 <i>t</i>、限界値、自由度が実際のサンプルサイズを使用するのではなく、仮説のサンプルサイズを使って再計算することを以外は、実際の検出力と同じです。
</p>






    