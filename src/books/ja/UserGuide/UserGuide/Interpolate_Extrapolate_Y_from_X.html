<h1 class="firstheading">XからYを補間/補外</h1><p class='urlname' style='display: none'>Math-Inter-Extrapoltate-YfromX</p>
<div style="text-align: left; direction: ltr; margin-left: 1em;"><p><a  class="image"><img alt="Video Image.png" src="../images/Interpolate_Extrapolate_Y_from_X/Video_Image.png" width="33"  /></a> 関連する動画はこちら:<a class="external text" href="http://www.originlab.com/Index.aspx?go=Support/VideoTutorials&amp;ss=chm&amp;pid=1889" target="_blank">Origin VT-0010 Interpolation</a>
</p></div>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Overview"><span class="tocnumber">1</span> <span class="toctext">概要</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#To_Interpolate_Y_from_X"><span class="tocnumber">1.1</span> <span class="toctext">XからYを補間</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-3"><a href="#Dialog_Options"><span class="tocnumber">2</span> <span class="toctext">ダイアログオプション</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Algorithm"><span class="tocnumber">3</span> <span class="toctext">アルゴリズム</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#References"><span class="tocnumber">4</span> <span class="toctext">参考文献</span></a></li>
</ul>
</div>

<h2><a name="Overview"></a><span class="mw-headline">概要</span></h2>
<p><a  class="image"><img alt="InterpolateYFromX 1.png" src="../images/Interpolate_Extrapolate_Y_from_X/InterpolateYFromX_1.png" width="443"  /></a><br />
補間は、既知の離散データから新しいデータポイントを計算し、作成する方法です。Xベクトルデータを与えると、この機能は入力曲線(XY範囲)を元にYベクトルデータを補間します。Originには、データ補間のために次の4つの手法が用意されています。<i>線形</i>、<i>3次スプライン</i>、<i>3次B-スプライン</i>、<i>Akimaスプライン</i>
</p><p><i>線形補間</i> は、最も単純で高速な補間法です。線形補間では、2つの隣接するデータポイントの算術平均が計算されます。この方法は、精度が低くても構わない場合に役立ちます。また線形補間は、計算に時間がかからないので、大きなデータセットの場合にも役立ちます。
</p><p>線形補間の一般形は、多項式補間です。多項式補間は、線形補間よりも多くの計算パワーが必要で、多項式の次数が高いとフィットデータの振れも広がります。これらのデメリットは、多項式フィットやスプライン補間を使って避けることができます。
</p><p><i>3次スプライン</i>法は3次多項式を使用し、区分法の要領でデータフィットを実行します。スプライン補間は線形補間よりも誤差が少なくなり、補間曲線も滑らかになります。
</p><p><i>3次スプライン</i>同様、<i>3次B-スプライン</i>補間もデータ範囲を区分けしてデータフィットしますが、これは3次ベジェスプラインを使って、データを近似します。3次B-スプラインは、幾何学の汎用的な正確なモデルとなります。
</p>
<h5><a name="To_Interpolate_Y_from_X"></a><span class="mw-headline">XからYを補間するには、</span></h5>
<ol><li>データの入った新しいワークシートを作成します。</li>
<li>目的のデータを選択します。</li>
<li>メニューから、<b>解析：数学：補間/補外(XからYを検索)</b>を選択します。これにより <b>interp1</b> ダイアログが開きます。</li></ol>
<p><a class="external text" href="../../XFunction/X-Function/Interp1.html">interp1</a> Xファンクションが呼び出されて計算を実行します。
</p><p><b>Note：</b>均一で等間隔な補間曲線を生成するには、<a href="../../UserGuide/UserGuide/Interpolate_Extrapolate.html" title="ユーザガイド：補間補外"><b>補間/補外</b></a>のメニューコマンドを使用します。
</p>
<h2><a name="Dialog_Options"></a><span class="mw-headline">ダイアログオプション</span></h2>
<table class="dialogcontroltable">

<tr>
<th><b>再計算</b>
</th>
<td>
<p>分析結果の再計算の設定を変更します。
</p>
<ul><li><b>なし</b> </li>
<li><b>自動</b> </li>
<li><b>手動</b>  </li></ul>
<p>詳細情報は、 <a class="external text" href="../../UserGuide/UserGuide/Recalculating_Analysis_Results.html">分析結果の再計算</a>をご覧下さい。
</p>
</td></tr>
<tr>
<th>補間するX値
</th>
<td>
<p>補間を行うX列
</p>
</td></tr>
<tr>
<th>入力
</th>
<td>
<p>指定されたX列からYを補間するための参照XY列。複数のXY列を選択できます。複数のXYが選択されている場合、XYの各セットが同じX列を補間するための参照として使用され、対応するY列と係数値が出力されます。
</p><p>範囲の設定に関する詳細は、<a class="external text" href="../../UserGuide/UserGuide/Specifying_Your_Input_Data.html">入力データを指定する</a>をご覧ください。
</p>
</td></tr>
<tr>
<th>手法
</th>
<td>
<p>補間手法を指定します。 
</p>
<ul><li><b>線形 </b>
<dl><dd>線形補間は、隣接する2つのデータポイント間に線を作成することにより、データポイントを推定する高速な方法です。結果のポイントは、欠損値データに対してはあまり正確ではありません。 </dd></dl></li>
<li><b>3次スプライン</b>
<dl><dd>入力データを指定された数に分割し、各セグメントを3次多項式で近似します。各3次関数の2次導関数はゼロに等しく設定されます。これらの境界条件が満たされると、関数全体は区分的に構成できます。 </dd></dl></li>
<li><b>3次B-スプライン</b>
<dl><dd>この方法も入力データを分割し、各セグメントに対して、ベジェスプラインでフィットします。 </dd></dl></li>
<li><b>Akimaスプライン</b>
<dl><dd>この方法は複数の多項式から作成された区分関数を元にしています。akima補間は外れ値がある場合も出力が安定しています。</dd></dl></li></ul>
</td></tr>
<tr>
<th>補外オプション
</th>
<td>
<p><b>補間するX値</b> で指定されたデータ範囲の一部が、<b>入力</b>で指定されたX範囲の外側にあるとき、これらの結果のY値は補外から計算されるため、この範囲部分は補外範囲として考慮されます。このオプションは、対応するY値をどのように補外するか指定するために使用します。
</p>
<ul><li><b>補外</b> 
<dl><dd> 最後の2点を使用してYを補外します。</dd></dl></li>
<li><b>欠損値をセット</b>
<dl><dd> 補外範囲内のY値を欠損値としてセットします。</dd></dl></li>
<li><b>最終の値を繰り返す</b>
<dl><dd> 補外範囲内のすべての値のX値から最も近い入力XのY値を使用します。</dd></dl></li></ul>
</td></tr>
<tr>
<th>境界
</th>
<td>
<p>境界条件は3次スプラインでのみ利用できます。 
</p>
<ul><li><b>自然</b> 
<dl><dd>2次導関数は両端で0です。 </dd></dl></li>
<li><b>Not-A-Knot条件</b>
<dl><dd>2階微分および2階微分の最後のポイントで3階微分が連続</dd></dl></li></ul>
</td></tr>
<tr>
<th>スムージング因子
</th>
<td>
<p>スムージング因子は3次B-スプラインでのみ利用できます。
</p>
</td></tr>
<tr>
<th>補間の結果
</th>
<td>
<p>補間されたY値を出力するY列。
</p>
</td></tr>
<tr>
<th>係数
</th>
<td>
<p>スプラインまたはBスプライン法を使うときのスプライン係数を出力するかどうか、およびそれらをどの列に表示するか。
</p>
</td></tr></table>
<h2><a name="Algorithm"></a><span class="mw-headline">アルゴリズム</span></h2>
<p>異なる対の数列データ (<i><img src="../images/Interpolate_Extrapolate_Y_from_X/math-0a645fc515fe6128f91758f996ebe307.png" title="x_i\," alt="x_i\," class="tex"/></i>と<i><img src="../images/Interpolate_Extrapolate_Y_from_X/math-b19930487b77bb2b470dafd74c4e60fa.png" title="y_i\," alt="y_i\," class="tex"/></i>)が与えられています。ここで<img src="../images/Interpolate_Extrapolate_Y_from_X/math-4761687a623ae077b0cba0b0b8c1c1cf.png" title="i= 0, 1, ... n-1\!" alt="i= 0, 1, ... n-1\!" class="tex"/>です。次の方法で、<img src="../images/Interpolate_Extrapolate_Y_from_X/math-3a427d888687d9dfe0f72040d9fa53a4.png" title="x\!" alt="x\!" class="tex"/>での補間した<img src="../images/Interpolate_Extrapolate_Y_from_X/math-301530a7f5da08f6e75622d6438fbd91.png" title="y\!" alt="y\!" class="tex"/>を探します。
</p><p>1.  <b>線形補間</b> (<i>interp1q</i>)
</p><p>この場合、<img src="../images/Interpolate_Extrapolate_Y_from_X/math-2286d9f15cd7aa4b33fb66b32093db69.png" title="x&lt;x_{0,}y=y_0+\frac{y_1-y_0}{x_1-x_0}\times (x-x_0)" alt="x&lt;x_{0,}y=y_0+\frac{y_1-y_0}{x_1-x_0}\times (x-x_0)" class="tex"/>となります。
</p><p>この場合、<img src="../images/Interpolate_Extrapolate_Y_from_X/math-764955aa4711750a4f91d4369c8a26df.png" title="x&gt;x_{n-1,}y=y_{n-1}+\frac{y_{n-1}-y_{n-2}}{x_{n-1}-x_{n-2}}\times (x-x_{n-1})" alt="x&gt;x_{n-1,}y=y_{n-1}+\frac{y_{n-1}-y_{n-2}}{x_{n-1}-x_{n-2}}\times (x-x_{n-1})" class="tex"/>となります。
</p><p>この場合、<img src="../images/Interpolate_Extrapolate_Y_from_X/math-ae2d45ac8ead21449027a8625ff3a321.png" title="x_i&lt;x&lt;x_{i+1,}y=y_i+\frac{(y_{i+1}-y_{i)}}{(x_{i+1}-x_{i)}}\times (x-x_i)" alt="x_i&lt;x&lt;x_{i+1,}y=y_i+\frac{(y_{i+1}-y_{i)}}{(x_{i+1}-x_{i)}}\times (x-x_i)" class="tex"/>となります。
</p><p>2.  <b>3次スプライン</b> (<i>spline</i>)
</p><p>Originは、自然3次スプラインを用いて補間します。
</p>
<dl><dd><img src="../images/Interpolate_Extrapolate_Y_from_X/math-37df50772f83cc096665cc3301a54541.png" title="y=Ay_i+By_{i+1}+Cy_i^{&apos;&apos;}+Dy_{i+1}^{&apos;&apos;} " alt="y=Ay_i+By_{i+1}+Cy_i^{&apos;&apos;}+Dy_{i+1}^{&apos;&apos;} " class="tex"/></dd></dl>
<p>ここで、
</p><p><img src="../images/Interpolate_Extrapolate_Y_from_X/math-23202931938360581de341a20f402ce5.png" title="A\equiv \frac{x_{i+1}-x}{x_{i+1}-x_i},B\equiv 1-A,C\equiv \frac 16\left( A^3-A\right) \left( x_{i+1}-x_i\right) ^2,D\equiv \frac 16(B^3-B)(x_{i+1}-x_i)^2" alt="A\equiv \frac{x_{i+1}-x}{x_{i+1}-x_i},B\equiv 1-A,C\equiv \frac 16\left( A^3-A\right) \left( x_{i+1}-x_i\right) ^2,D\equiv \frac 16(B^3-B)(x_{i+1}-x_i)^2" class="tex"/>
</p><p>そして、<img src="../images/Interpolate_Extrapolate_Y_from_X/math-f45e2aef61a1fc1dc82962f9c936286f.png" title="y_i^{&apos;&apos;}" alt="y_i^{&apos;&apos;}" class="tex"/>が次から生成されます。
</p><p><img src="../images/Interpolate_Extrapolate_Y_from_X/math-87eda369c25995b4ead9091695bc4c99.png" title="\frac{x_i-x_{i-1}}6y_{i-1}+\frac{x_{i+1}-x_{i-1}}3y_i+\frac{x_{i+1}-x_i}6y_{i+1}=\frac{y_{i+1}-y_i}{x_{i+1}-x_i}-\frac{y_i-y_{i-1}}{x_i-x_{i-1}}" alt="\frac{x_i-x_{i-1}}6y_{i-1}+\frac{x_{i+1}-x_{i-1}}3y_i+\frac{x_{i+1}-x_i}6y_{i+1}=\frac{y_{i+1}-y_i}{x_{i+1}-x_i}-\frac{y_i-y_{i-1}}{x_i-x_{i-1}}" class="tex"/>
</p><p>境界点において、<img src="../images/Interpolate_Extrapolate_Y_from_X/math-f40f11403d7728f77fb3e6b752a3ba6c.png" title="y_o^{&apos;&apos;}" alt="y_o^{&apos;&apos;}" class="tex"/>と<img src="../images/Interpolate_Extrapolate_Y_from_X/math-dab9eb68306a521b23cb3c61ccbd22da.png" title="y_{n-1}^{&apos;&apos;}" alt="y_{n-1}^{&apos;&apos;}" class="tex"/>を0にセットします。
</p><p>3.  <b>3次B-スプライン</b> (<i>bspline</i>)
</p><p><img src="../images/Interpolate_Extrapolate_Y_from_X/math-9085c488d167a78461c4bd7a4c930a8b.png" title="x&lt;x_0\! " alt="x&lt;x_0\! " class="tex"/>または<img src="../images/Interpolate_Extrapolate_Y_from_X/math-f490bf141f6bfc5b6130848b2dc4c510.png" title="x&gt;x_{n-1}\!" alt="x&gt;x_{n-1}\!" class="tex"/>に対して線形補間を実行します。
</p><p>この場合、<img src="../images/Interpolate_Extrapolate_Y_from_X/math-be300f3fad7d0a81a73fec2bbf5ff175.png" title="x_0&lt;x&lt;x_{n-1},y=\sum_{i=1}^{n-4} c_iN_i(x)" alt="x_0&lt;x&lt;x_{n-1},y=\sum_{i=1}^{n-4} c_iN_i(x)" class="tex"/>となります。
</p><p>ここで、<img src="../images/Interpolate_Extrapolate_Y_from_X/math-76579a5927afb649d2ad05211b349820.png" title="N(x)\!" alt="N(x)\!" class="tex"/>は、結節点 <i><img src="../images/Interpolate_Extrapolate_Y_from_X/math-0a645fc515fe6128f91758f996ebe307.png" title="x_i\," alt="x_i\," class="tex"/></i>, <i><img src="../images/Interpolate_Extrapolate_Y_from_X/math-d52d60e99594ed33534fa1f75063caa2.png" title="x_i+1\," alt="x_i+1\," class="tex"/></i>, ..., <i><img src="../images/Interpolate_Extrapolate_Y_from_X/math-dbae88edddc31159993eb1f5ef14a5b6.png" title="x_i+4\," alt="x_i+4\," class="tex"/></i>, で定義される規格化した3次Bスプラインを表し、 <i><img src="../images/Interpolate_Extrapolate_Y_from_X/math-c528b0c61dee3193e34bed7c699eae72.png" title="c_i\," alt="c_i\," class="tex"/></i>は、対応する関数の係数を表します。
</p><p>この結節点の合計数<img src="../images/Interpolate_Extrapolate_Y_from_X/math-a3904f143141153cc70766aff62f962c.png" title="n\!" alt="n\!" class="tex"/>と <i><img src="../images/Interpolate_Extrapolate_Y_from_X/math-f8e02b93931569df742620719c191421.png" title="x_1\," alt="x_1\," class="tex"/></i>, ..., <i><img src="../images/Interpolate_Extrapolate_Y_from_X/math-1c163dcc48d8a0b9331c99c021e07795.png" title="x_n\," alt="x_n\," class="tex"/></i> は、関数によって自動的に選ばれます。結節点 <i><img src="../images/Interpolate_Extrapolate_Y_from_X/math-b094c32c305423b0709cea53882770c9.png" title="x_5\," alt="x_5\," class="tex"/></i>, ..., <i><img src="../images/Interpolate_Extrapolate_Y_from_X/math-f48235bca82ccf864fbb7831bf429ab8.png" title="x_n-4\," alt="x_n-4\," class="tex"/></i> は、内部の結節点です。これらは近似区間 [<i><img src="../images/Interpolate_Extrapolate_Y_from_X/math-f8e02b93931569df742620719c191421.png" title="x_1\," alt="x_1\," class="tex"/></i>, <i><img src="../images/Interpolate_Extrapolate_Y_from_X/math-84223fd0948413a7aff9e81d3610c059.png" title="x_m\," alt="x_m\," class="tex"/></i>] を<img src="../images/Interpolate_Extrapolate_Y_from_X/math-0c39bb827a5c8e3b452374f034903183.png" title="n-7\!" alt="n-7\!" class="tex"/>個のサブ区間に分けます。係数 <i><img src="../images/Interpolate_Extrapolate_Y_from_X/math-fd237b57e2c5d682b1ede37fd5191203.png" title="c_1\," alt="c_1\," class="tex"/></i>, <i><img src="../images/Interpolate_Extrapolate_Y_from_X/math-a2f5b11993679dafa520d1e60db8c27f.png" title="c_2\," alt="c_2\," class="tex"/></i>, ..., <i><img src="../images/Interpolate_Extrapolate_Y_from_X/math-ab4cb6018e67ab7a62baad1ed3dacb8c.png" title="c_n-4\," alt="c_n-4\," class="tex"/></i> は、次の制約最小化問題の解として決められます。
</p><p>最小化
</p>
<dl><dd><dl><dd><dl><dd><img src="../images/Interpolate_Extrapolate_Y_from_X/math-153df0ebe8c878cc55e4feb7aeac6321.png" title="\eta =\sum_{i=5}^{n-4}\delta _i^2\," alt="\eta =\sum_{i=5}^{n-4}\delta _i^2\," class="tex"/></dd></dl></dd></dl></dd></dl>
<p>制約の主要因
</p>
<dl><dd><dl><dd><dl><dd><img src="../images/Interpolate_Extrapolate_Y_from_X/math-c67f0b7e96f227a7e2c1517212c54d6b.png" title="\theta =\sum_{r=1}^m\varepsilon _r^2\leq S\," alt="\theta =\sum_{r=1}^m\varepsilon _r^2\leq S\," class="tex"/></dd></dl></dd></dl></dd></dl>
<p>ここで、<i><img src="../images/Interpolate_Extrapolate_Y_from_X/math-551f23ff7eff19a995a74585d9ae89c2.png" title="\delta _i\," alt="\delta _i\," class="tex"/></i>は内部結節点 <i><img src="../images/Interpolate_Extrapolate_Y_from_X/math-301530a7f5da08f6e75622d6438fbd91.png" title="y\!" alt="y\!" class="tex"/></i>における<img src="../images/Interpolate_Extrapolate_Y_from_X/math-fb2b5e85803d6d4f85e8c5147815edeb.png" title="\varepsilon _r\," alt="\varepsilon _r\," class="tex"/>の3階微分で不連続な飛び越えを表し、 <img src="../images/Interpolate_Extrapolate_Y_from_X/math-0a645fc515fe6128f91758f996ebe307.png" title="x_i\," alt="x_i\," class="tex"/> は、重み付けされた残差 <img src="../images/Interpolate_Extrapolate_Y_from_X/math-4c837daf72b6acd558569ecc29af63cc.png" title="w_r (y_r-y(x_r))\," alt="w_r (y_r-y(x_r))\," class="tex"/>、Sはユーザが指定した非負の数です。
</p><p>量<i><img src="../images/Interpolate_Extrapolate_Y_from_X/math-e2ba1b68ce44f2bb523e4c1f58ca0c42.png" title="\eta\," alt="\eta\," class="tex"/></i>は、<img src="../images/Interpolate_Extrapolate_Y_from_X/math-301530a7f5da08f6e75622d6438fbd91.png" title="y\!" alt="y\!" class="tex"/>の滑らかさ(の欠落)の計測値と見ることができ、フィットの近さは、 <i><img src="../images/Interpolate_Extrapolate_Y_from_X/math-91021c9f520a03331f431a3ceadcccc8.png" title="\theta\," alt="\theta\," class="tex"/></i>を通して測定されます。滑らかさの係数、パラメータ<img src="../images/Interpolate_Extrapolate_Y_from_X/math-31ea319361d1b03c9f77c6fbdb6833bd.png" title="S\!" alt="S\!" class="tex"/>によって、ユーザは(通常、競合している)2つのプロパティ間のバランスを制御します。<img src="../images/Interpolate_Extrapolate_Y_from_X/math-31ea319361d1b03c9f77c6fbdb6833bd.png" title="S\!" alt="S\!" class="tex"/>が大きすぎる場合、スプラインは滑らかすぎ、信号は失われます(アンダーフィット)。<img src="../images/Interpolate_Extrapolate_Y_from_X/math-31ea319361d1b03c9f77c6fbdb6833bd.png" title="S\!" alt="S\!" class="tex"/>が小さすぎる場合、スプラインは多くのノイズを検出します(オーバーフィット)。極端な場合として、関数は、<img src="../images/Interpolate_Extrapolate_Y_from_X/math-31ea319361d1b03c9f77c6fbdb6833bd.png" title="S\!" alt="S\!" class="tex"/>がゼロにセットされている場合、補間スプライン(<i><img src="../images/Interpolate_Extrapolate_Y_from_X/math-91021c9f520a03331f431a3ceadcccc8.png" title="\theta\," alt="\theta\," class="tex"/></i>,=0)を返し、<img src="../images/Interpolate_Extrapolate_Y_from_X/math-31ea319361d1b03c9f77c6fbdb6833bd.png" title="S\!" alt="S\!" class="tex"/>が非常に大きい場合、重み付けした最小二乗3次多項式(<i><img src="../images/Interpolate_Extrapolate_Y_from_X/math-e2ba1b68ce44f2bb523e4c1f58ca0c42.png" title="\eta\," alt="\eta\," class="tex"/></i>,=0)を返します。これら2つの極値の間の<img src="../images/Interpolate_Extrapolate_Y_from_X/math-31ea319361d1b03c9f77c6fbdb6833bd.png" title="S\!" alt="S\!" class="tex"/>値を試すことは、妥協できる結果となります。
</p><p>4.<b>Akimaスプライン</b> (<i>akima</i>)
</p><p>Akima補間は、複数の多項式(最大で3次式まで)から作成された区分関数を元にしています。この区分関数はあるXY座標で示された区間の間、順に適用されます。特定の位置での入力データプロットの傾きは4つの隣り合う点とその点そのもののXY座標で推計されます。特定の2つの点の傾きと座標から。3項式が計算され、2つの点の間の曲線が計算されます。そして補間はこのような多項式の組み合わせによって続けられます。多項式の終点を計算する時に追加の推定が行われます。
</p><p>まず、指定の位置の曲線<img src="../images/Interpolate_Extrapolate_Y_from_X/math-e358efa489f58062f10dd7316b65649e.png" title="t" alt="t" class="tex"/>が計算されます。特定のポイント(ポイント3)では、5つのデータポイント1,2,3,4,5があり、<img src="../images/Interpolate_Extrapolate_Y_from_X/math-e281d4c28ba868770a36ef30bb48d90a.png" title="m_{1}, m_{2}, m_{3}, m_{4}" alt="m_{1}, m_{2}, m_{3}, m_{4}" class="tex"/>はそれぞれ<img src="../images/Interpolate_Extrapolate_Y_from_X/math-285419bc5975edd9dfcfacd932e1fd59.png" title="\bar{12}, \bar{23}, \bar{34}, \bar{45}" alt="\bar{12}, \bar{23}, \bar{34}, \bar{45}" class="tex"/>の線分の傾きで、<img src="../images/Interpolate_Extrapolate_Y_from_X/math-7d627446c33c02b2908d5ef7dc3dc3e4.png" title="m_i=(y_{i+1}-y_i)/(x_{i+1}-x_i)" alt="m_i=(y_{i+1}-y_i)/(x_{i+1}-x_i)" class="tex"/>が成り立ちます。曲線の傾き<img src="../images/Interpolate_Extrapolate_Y_from_X/math-e358efa489f58062f10dd7316b65649e.png" title="t" alt="t" class="tex"/>は、条件によって以下の数式が成り立ち、それで決定されます。
</p><p><img src="../images/Interpolate_Extrapolate_Y_from_X/math-014c7bf63dc8b9770b6bc4a314b253f3.png" title="m_{1}\neq m_{2}" alt="m_{1}\neq m_{2}" class="tex"/>または<img src="../images/Interpolate_Extrapolate_Y_from_X/math-4311060944c0f9b6daf5e27c4ee01789.png" title="m_{3}\neq m_{4}" alt="m_{3}\neq m_{4}" class="tex"/>の場合、
</p>
<dl><dd><img src="../images/Interpolate_Extrapolate_Y_from_X/math-f224d95c7af4ace0a9ca76f828fe8eb6.png" title="t = \left ( \left | m_{4} - m_{3} \right |m_{2} + \left | m_{2} - m_{1} \right |m_{3} \right  )/\left ( \left | m_{4} - m_{3} \right | + \left | m_{2} - m_{1} \right |\right  )" alt="t = \left ( \left | m_{4} - m_{3} \right |m_{2} + \left | m_{2} - m_{1} \right |m_{3} \right  )/\left ( \left | m_{4} - m_{3} \right | + \left | m_{2} - m_{1} \right |\right  )" class="tex"/></dd></dl>
<p><img src="../images/Interpolate_Extrapolate_Y_from_X/math-75ba7702cdab7b6144e6ec0073cf9f1d.png" title="m_{1} = m_{2}" alt="m_{1} = m_{2}" class="tex"/>または<img src="../images/Interpolate_Extrapolate_Y_from_X/math-b0468899102e50fb6f03acaedf9a08d9.png" title="m_{3} = m_{4}" alt="m_{3} = m_{4}" class="tex"/>の場合、
</p>
<dl><dd><img src="../images/Interpolate_Extrapolate_Y_from_X/math-0ee8fff3c27ce3ed8a66e19e19a0567a.png" title=" t = \frac{(x_4-x_3)m_2 + (x_3-x_2)m_3}{x_4-x_2}" alt=" t = \frac{(x_4-x_3)m_2 + (x_3-x_2)m_3}{x_4-x_2}" class="tex"/></dd></dl>
<p>2つの終点に対する傾きは各曲線の最後に推定されます。そして推定するには、その傾きを隣にある3点を使用して2次曲線で補間します。つまり、1つ目の傾きは最初の3点から2次曲線で補間し、その補間曲線の微分を取ると最初の点の傾きを計算できます。
</p><p>そして2つの隣り合ったデータポイント<img src="../images/Interpolate_Extrapolate_Y_from_X/math-77f147b98729e0b8c06465d522c7039f.png" title="\left ( x_i, y_i \right )" alt="\left ( x_i, y_i \right )" class="tex"/>と<img src="../images/Interpolate_Extrapolate_Y_from_X/math-2798950c5b772d16c859b3b35db673b7.png" title="\left ( x_{i+1}, y_{i+1} \right )" alt="\left ( x_{i+1}, y_{i+1} \right )" class="tex"/>の間にある区間<img src="../images/Interpolate_Extrapolate_Y_from_X/math-b9ecd49b3245fff5c8a6ccb8e4a645be.png" title="[x_i, x_{i+1}]" alt="[x_i, x_{i+1}]" class="tex"/>に対する多項式は次の条件で決定します。
</p>
<dl><dd><img src="../images/Interpolate_Extrapolate_Y_from_X/math-69b84550afd635503768b7f0e3deb5d0.png" title="y|_{x=x_i} = y_i" alt="y|_{x=x_i} = y_i" class="tex"/> </dd></dl>
<dl><dd><img src="../images/Interpolate_Extrapolate_Y_from_X/math-09a6f71e3d4a4f5baa4c9b3dd7879afb.png" title="y&apos;|_{x=x_i}=t_i" alt="y&apos;|_{x=x_i}=t_i" class="tex"/></dd></dl>
<dl><dd><img src="../images/Interpolate_Extrapolate_Y_from_X/math-51f7e29278a095db5cc0c8b6866b8e98.png" title="y|_{x=x_{i+1}} = y_{i+1}" alt="y|_{x=x_{i+1}} = y_{i+1}" class="tex"/> </dd></dl>
<dl><dd><img src="../images/Interpolate_Extrapolate_Y_from_X/math-e9145ab06cc9e563677f8e435b6b0ea8.png" title="y&apos;|_{x=x_{i+1}}=t_{i+1}" alt="y&apos;|_{x=x_{i+1}}=t_{i+1}" class="tex"/></dd></dl>
<p>ここで、<img src="../images/Interpolate_Extrapolate_Y_from_X/math-f406db9a09c0430f7e54c1a3bb217c3e.png" title="t_i" alt="t_i" class="tex"/>と<img src="../images/Interpolate_Extrapolate_Y_from_X/math-9269d66b512bd8284a9ec8d7f56a021b.png" title="t_{i+1}" alt="t_{i+1}" class="tex"/>はこれら2点の傾きです。
</p>
<h2><a name="References"></a><span class="mw-headline">参考文献</span></h2>
<p>1.  Michelle Schatzman.<i>Numerical Analysis: A Mathematical Introduction, Chapters 4 and 6</i>.Clarendon Press, Oxford (2002).
</p><p>2.  William H. Press, etc. <i>Numerical Recipes in C++.2<sup>nd</sup> Edition</i>.Cambridge University Press (2002).
</p><p>3.  Nag C 関数ライブラリ ドキュメント, nag_1d_spline_fit (e02bec).
</p><p>4.  Hiroshi Akima, <i>Journal of the Association for Computing Machinery</i>, Vol. 17, No. 4, (1970)
</p>






    