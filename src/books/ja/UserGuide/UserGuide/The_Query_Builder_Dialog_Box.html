<h1 class="firstheading">クエリビルダダイアログボックス</h1>
<p class="urlname" style="display: none;">ImpDatabase-QueryBuilder-Dialog</p>
<table class="note">
<tr>
<td><b style="font-weight: bold;">Note:</b> <b>クエリビルダ</b> はOriginの32bit版で <b>のみ</b> ご利用頂けます。Origin 64-bit のみインストールされているパソコンでは、SQL編集とデータベースデータのインポートに<a href="../../UserGuide/UserGuide/The_SQL_Editor_Dialog_Box.html" title="ユーザガイド：SQLビルダダイアログ"><b>SQLエディタ</b></a>が利用出来ます。<b>ファイルの追加または削除</b>および<b>修正</b>を実行して、32bit版、64bit版Originの両方にインストールできます。</td>
</tr>
</table>
<dl>
<dd><a class="image" style="color: #0000ff; text-decoration: underline;"><img alt="Query dialog box.png" src="../images/The_Query_Builder_Dialog_Box/Query_dialog_box.png" width="744" height="524" border="0" /></a></dd>
</dl>
<div id="toc" class="toc">
<div id="toctitle">
<h2>目次</h2>
</div>
<ol>
<li class="toclevel-1 tocsection-1"><a href="#Query_Building_Pane"><span class="tocnumber">1</span> <span class="toctext">クエリ作成領域</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Union_Sub-Query_Control"><span class="tocnumber">2</span> <span class="toctext">UNIONサブクエリのオプション</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Columns_Pane"><span class="tocnumber">3</span> <span class="toctext">列の領域</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Query_Tree_View_Pane"><span class="tocnumber">4</span> <span class="toctext">クエリツリービュー領域</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Tables.2FViews.2FProcedures.28Functions.29_Pane"><span class="tocnumber">5</span> <span class="toctext">テーブル/ビュー/関数表示領域</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Preview_Button.2FPane"><span class="tocnumber">6</span> <span class="toctext">プレビューボタン/領域</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Show_SQL"><span class="tocnumber">7</span> <span class="toctext">SQLの表示</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Import"><span class="tocnumber">8</span> <span class="toctext">データをインポートする</span></a></li>
</ol>
</div>
<h2><a name="Query_Building_Pane" id="Query_Building_Pane"></a><span class="mw-headline">クエリ作成領域</span></h2>
<p>クエリの作成は、データベースに関する知識が必要です。Originは事前に作成したクエリ(Accessデータベース)を使ったり、クエリビルダダイアログでクエリを作成することができます。事前に作成したクエリがあれば、「<b>メイン</b>」領域を右クリックして、「<b>オブジェクトの追加</b>」メニューを使って、「<b>ビュー</b>」タブから選択します。適切に操作するために、&amp;apos;Provider&amp;apos; と&amp;apos;Dialect&amp;apos; (<b>設定：オプション</b>をご覧ください)は含まれる必要があります。</p>
<p>ソースオブジェクトと派生テーブルを選択し、その間のリンクを作成し、出力するデータを選択して、新しいクエリを作成することができます。この領域は、リンクとオブジェクトのプロパティを編集することもできます。例えば、ここでオブジェクトに対するエイリアスを定義することができます。</p>
<p>この領域にオブジェクトや派生テーブルは、領域の空白部分を右クリックし、「<b>オブジェクトの追加</b>」または「<b>サブクエリの追加</b>」を追加すると、追加されます。派生テーブルが追加されると、それに対応するタブが作成されます。メインクエリと同じ方法で、視覚的に派生テーブルに関連したサブクエリを編集できます。この派生テーブルを表すオブジェクトの最大化ボタンを押すと、それに対応したタブを開きます。</p>
<p>また、右側の領域からメイン領域にテーブルやビュー(クエリ)をドラッグすることもできます。</p>
<p>出力したいフィールド名の左側のチェックボックスにチェックを付けます。オブジェクトのすべてのフィールドを出力したい場合、オブジェクトのアスタリスクの左側のチェックボックスにチェックを付けます。出力からフィールドを削除するには、チェックボックスのチェックを外すだけです。</p>
<p>ソースオブジェクトのプロパティを編集するには、それを右クリックし、ショートカットメニューから「<b>プロパティ</b>」を選びます。ソースオブジェクトの編集可能なプロパティは、サーバにより異なります。しかし、常にエイリアスを定義したり、変更することができます。</p>
<p>2つのオブジェクトを結合するには、1つのオブジェクトのフィールドを選択し、別のオブジェクトの対応するフィールドにドラッグします。2つのフィールド間に線が表示されます。これは、「内部結合」を作成します。他のタイプの結合を作成するには、結合線を右クリックし、ショートカットメニューから「<b>プロパティ</b>」を選択します。結合を削除するには、ショートカットメニューから「<b>削除</b>」を選ぶか、結合線をクリックして、Delキーを押します。</p>
<p>クエリ作成領域について、ページ制御オプションがあります。それを使って、メインクエリとサブクエリ間を自由に切り替えることができます。</p>
<h2><a name="Union_Sub-Query_Control" id="Union_Sub-Query_Control"></a><span class="mw-headline">UNIONサブクエリのオプション</span></h2>
<p>クエリビルダの右上にある<a class="image"><img alt="Query buider 4.png" src="../images/The_Query_Builder_Dialog_Box/Query_buider_4.png" width="24" border="0" /></a> アイコンは、UNIONサブクエリを操作します。このオプションを使って、新しいUnionサブクエリを追加したり、操作を実行することができます。</p>
<p>新しいUnionサブクエリを追加するには、このアイコンを右クリックし、ショートカットメニューから、「<b>Unionサブクエリの作成</b>」を選択します。もう一つ<a class="image"><img alt="Query buider 4.png" src="../images/The_Query_Builder_Dialog_Box/Query_buider_4.png" width="24" border="0" /></a> アイコンと、<b>Uniting</b> コントロール <a class="image"><img alt="Query3.png" src="../images/The_Query_Builder_Dialog_Box/Query3.png" width="18" border="0" /></a> の間は次のように表示されます。 <a class="image"><img alt="Query2.png" src="../images/The_Query_Builder_Dialog_Box/Query2.png" width="65" border="0" /></a></p>
<p><br />
1つ以上のサブクエリがあると、このショートカットメニューは以下のことを行うことができます。</p>
<ul>
<li>サブクエリの削除</li>
</ul>
<ul>
<li>サブクエリをブラケットで囲む</li>
</ul>
<ul>
<li>前または次のサブクエリまたはブラケットに移動する</li>
</ul>
<p>統合操作を設定するには、<b>Uniting</b> アイコン<a class="image"><img alt="Query3.png" src="../images/The_Query_Builder_Dialog_Box/Query3.png" width="18" border="0" /></a>を右クリックします。すると、別のショートカットメニューが現れ、次のいずれかからUnionの演算子を選ぶことができます。</p>
<ul>
<li>UNION</li>
</ul>
<ul>
<li>UNION ALL</li>
</ul>
<ul>
<li>EXCEPT</li>
</ul>
<ul>
<li>INTERCEPT</li>
</ul>
<h2><a name="Columns_Pane" id="Columns_Pane"></a><span class="mw-headline">列領域</span></h2>
<p>列領域で、出力するフィールドを選択し、そのフィールドに対するエイリアスをセットし、ソートやグループをすることができます。</p>
<p>各フィールド名の前にチェックボックスがあります。チェックが付いてると、そのフィールドがクエリ結果に含まれます。クエリ出力からフィールドを削除したい場合、フィールド名の前のチェックボックスのチェックを外します。これは、列領域にフィールドを保持していて、ソートやグループをセットする目的のために、出力から除外したい場合に役立ちます。</p>
<p>「<b>式</b>」列には、現在のクエリに追加されるフィールド名が表示されます。ドロップダウンリストを使って、フィールドを選択し、この領域に追加することができます。さらに、この列に「(Select)」を入力して、サブクエリを作成することができます。</p>
<p>出力フィールドに対するエイリアスを定義するには、「<b>別名</b>」列にエイリアスを入力します。</p>
<p><b style="font-weight: bold;">Aggregate</b> 列で、集計機能を選択することが出来ます。 (<b>平均</b>、<b>カウント</b>、<b>合計</b>、<b>...</b>;)</p>
<p>「<b>ソート種別</b>」列と「<b>ソート順序</b>」列は、クエリ結果のソートを設定するのに使用します。これは<b>昇順</b>か<b>降順</b>から選べます。「ソート順序」列は、複数フィールドをソートするのに使用します。これはフィールドをソートする順序を指定します。</p>
<p>「<b>Grouping</b>」列は、グループ化を設定します。このチェックボックスにチェックが付いていると、現在のフィールドは「Group By」式に追加されます。また、列の<b>条件</b>も表示されます。グループデータに対する条件を設定する場合、列の<b>条件</b>で「グループ」を選び、「<b>条件</b>」列に条件を入力します。</p>
<p>「<b>条件</b>」列には、 <b>Where</b> 式(「<b>Grouping</b>」チェックボックスのチェックが付いていないか、 「<b>Grouping</b>」チェックボックスのチェックが付いていて「<b>条件</b>」で「For Values」 が選択されている場合) または、 <b>GroupBy</b> と組み合わせて使用する<b>Having</b>式(「<b>Grouping</b>」チェックボックスのチェックが付いているか、「<b>条件</b>」で「<b>For Groups</b>」 が選択されている場合)で使われる条件を定義します。式(フィールド名)は省略されます。次の条件をクエリで使用するものとします。</p>
<dl>
<dd>
<dl>
<dd>where (field&gt;10)</dd>
</dl>
</dd>
</dl>
<p>「<b>条件</b>」列に次のように入力します。</p>
<dl>
<dd>
<dl>
<dd>&gt;10</dd>
</dl>
</dd>
</dl>
<p>この列はサブクエリを作成することもできます。この列を右クリックして、「<b>サブクエリの挿入</b>」を選択します。サブクエリが追加され、クエリ作成領域に追加されたサブクエリタブをクリックして切り替えることができます。</p>
<p>いくつかの条件を指定するには、「<b>または</b>」列を使用します。条件は、クエリ文のOR演算子を使って接続されます。これは、条件を合成するのに使用することができます。</p>
<h2><a name="Query_Tree_View_Pane" id="Query_Tree_View_Pane"></a><span class="mw-headline">クエリツリービュー領域</span></h2>
<p>クエリツリー領域で、クエリのアウトラインを表示することができます。これを使って、クエリの一部をすばやく切り替えることができます。</p>
<h2><a name="Tables.2FViews.2FProcedures.28Functions.29_Pane" id="Tables.2FViews.2FProcedures.28Functions.29_Pane"></a><span class="mw-headline">テーブル/ビュー/関数表示領域</span></h2>
<p>この領域は、現在のクエリにあるテーブル、ビュー、関数元のオブジェクトを追加することができます。元のオブジェクトを追加するには、それをダブルクリックすると、クエリ作成領域にそれをドラッグします。</p>
<h2><a name="Preview_Button.2FPane" id="Preview_Button.2FPane"></a><span class="mw-headline">プレビューボタン/領域</span></h2>
<p>プレビュー領域は、結果をプレビュー表示し、現在のクエリを評価することができます。この領域は<b>表示プレビュー</b> <a class="image"><img alt="Button Expand Preview Down.png" src="../images/The_Query_Builder_Dialog_Box/Button_Expand_Preview_Down.png" width="24" border="0" /></a> ボタンまたは <b>プレビューなし</b> <a class="image"><img alt="Button Expand Preview Up.png" src="../images/The_Query_Builder_Dialog_Box/Button_Expand_Preview_Up.png" width="24" border="0" /></a> ボタンを切り替えられます。</p>
<p>プレビュー領域を表示していて、「プレビュー」ボタンをクリックすると、<b>プレビュー</b>領域のデータが更新されます。</p>
<h2><a name="Show_SQL" id="Show_SQL"></a><span class="mw-headline">「SQLの表示」ボタン</span></h2>
<p>このボタンをクリックして、SQLクエリ文を表示します。ダイアログボックスが開きます。このダイアログボックスで、SQLクエリ文を編集し、変更を適用することができます。</p>
<h2><a name="Import" id="Import"></a><span class="mw-headline">インポート：</span></h2>
<p>このボタンをクリックすると、クエリを適用して、アクティブワークシートに結果をインポートすることができます。</p>
