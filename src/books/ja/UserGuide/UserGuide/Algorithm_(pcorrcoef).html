<h1 class="firstheading">アルゴリズム(偏相関係数)</h1><p class='urlname' style='display: none'>Parial-Corr-Coef-Algorithm</p>
<p>偏相関係数は、調整変数が存在するときの2つの変数間の関係を説明するために使用されます。
</p>
<h2><a name="Partial_Correlation_Coefficient"></a><span class="mw-headline">偏相関係数</span></h2>
<p><img src="../images/Algorithm_(pcorrcoef)/math-88449ca5365fc85a4051a4f39cf72e31.png" title="n_y" alt="n_y" class="tex"/> ランダム変数<B>Y</B>のセットと <img src="../images/Algorithm_(pcorrcoef)/math-d037fcd5fa24c8673763af9c9253cdb1.png" title="n_x" alt="n_x" class="tex"/> 調整変数<B>X</B>で、2つの変数<B>X</B>と<B>Y</B>を統合すると、その分散共分散行列は以下のようになります。
</p>
<div class="center"><img src="../images/Algorithm_(pcorrcoef)/math-90b8ce2774c5073b1124c7e9a4b41957.png" title="
\begin{pmatrix}
\Sigma_{xx} &amp; \Sigma_{xy} \\
\Sigma_{yx} &amp; \Sigma_{yy}
\end{pmatrix}
" alt="
\begin{pmatrix}
\Sigma_{xx} &amp; \Sigma_{xy} \\
\Sigma_{yx} &amp; \Sigma_{yy}
\end{pmatrix}
" class="tex"/></div>
<p>調整変数<B>X</B>の<B>Y</B>変数の分散共分散行列は、以下で与えられます。
</p>
<div class="center"><img src="../images/Algorithm_(pcorrcoef)/math-a497642b29af9eda7964583875b85002.png" title="
\Sigma_{y|x} = \Sigma_{yy}-\Sigma_{yx}\Sigma_{xx}^{-1}\Sigma_{xy}
" alt="
\Sigma_{y|x} = \Sigma_{yy}-\Sigma_{yx}\Sigma_{xx}^{-1}\Sigma_{xy}
" class="tex"/></div>
<p>偏相関係数は以下のように計算されます。
</p>
<div class="center"><img src="../images/Algorithm_(pcorrcoef)/math-dc013e6067313a0ed2ca5041a49ac91b.png" title="
\text{diag}(\Sigma_{y|x})^{-1/2} \Sigma_{y|x} \text{diag}(\Sigma_{y|x})^{-1/2}.
" alt="
\text{diag}(\Sigma_{y|x})^{-1/2} \Sigma_{y|x} \text{diag}(\Sigma_{y|x})^{-1/2}.
" class="tex"/></div>
<h2><a name="Significance_of_Partial_Correlation_Coefficient"></a><span class="mw-headline">偏相関係数の有意性</span></h2>
<p>偏相関係数がゼロという帰無仮説の検定に、t検定を使用できます。
</p><p>自由度は、<br />
</p>
<div class="center"><img src="../images/Algorithm_(pcorrcoef)/math-0613eb5b6527b5b309de243d94b08a47.png" title="df=n-n_x-2" alt="df=n-n_x-2" class="tex"/></div>
<p>ここで<B>n</B>は、完全相関の計算における観測値の数です。欠損値のペアワイズ削除において、与えられた調整変数Xの2つの変数 <img src="../images/Algorithm_(pcorrcoef)/math-cca0d5b689e524b619b30538d3432266.png" title="Y_i, Y_j" alt="Y_i, Y_j" class="tex"/> の偏相関の計算で<B>n</B>はXの対の中と <img src="../images/Algorithm_(pcorrcoef)/math-9f58a707e9db8318aac1bb009020990d.png" title="(Y_i, Y_j), (Y_i, X), (Y_j, X)" alt="(Y_i, Y_j), (Y_i, X), (Y_j, X)" class="tex"/> の対の中の観測値の最小の数です。
</p><p>t統計量は、
</p>
<div class="center"><img src="../images/Algorithm_(pcorrcoef)/math-14450f33ce8531f5a46e17c259af12b7.png" title="
t = |r| \sqrt{ \frac {df} {1-r^2} }
" alt="
t = |r| \sqrt{ \frac {df} {1-r^2} }
" class="tex"/></div>
<p>ここで<B> r </B>は偏相関係数です。
</p><p>両端の有意水準レベル<img src="../images/Algorithm_(pcorrcoef)/math-550e9bcd0b294b7167dd9b8a1472af23.png" title="\text{Prob}&gt;|t|" alt="\text{Prob}&gt;|t|" class="tex"/>は以下のように計算されます。
</p>
<div class="center"><img src="../images/Algorithm_(pcorrcoef)/math-704674c897463ad5d94a0842cbdadd58.png" title="
2(1 - \text{tcdf}(t, df)).
" alt="
2(1 - \text{tcdf}(t, df)).
" class="tex"/></div>
<h2><a name="References"></a><span class="mw-headline">参考文献</span></h2>
<ol><li> Morrison, D. F. (1976), <i>Multivariate Statistical Methods</i>, Second Edition, New York:McGraw-Hill.
</li><li> <a class="external text" target="_blank" href="http://www.originlab.com/pdfs/nagcl09/manual/pdf/g02/g02byc.pdf">nag_partial_corr (g02byc)</a>
</li></ol>





    