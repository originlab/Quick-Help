<h1 class="firstheading">アルゴリズム (一元配置分散分析)<br /></h1>
<table id="toc" class="toc" summary="Contents">
<tr>
<td>
<div id="toctitle">
<h2>内容</h2>
</div>
<ol>
<li class="toclevel-1"><a href="#Theory_of_One-Way_ANOVA"><span class="tocnumber">1</span> <span class="toctext">One-Way ANOVAの理論</span></a></li>
<li class="toclevel-1"><a href="#Homogeneity_of_Variance"><span class="tocnumber">2</span> <span class="toctext">分散の等質性</span></a></li>
<li class="toclevel-1"><a href="#Multiple_Means_Comparisons"><span class="tocnumber">3</span> <span class="toctext">複数の平均比較</span></a></li>
<li class="toclevel-1"><a href="#Power_Analysis"><span class="tocnumber">4</span> <span class="toctext">検出力解析</span></a></li>
</ol>
</td>
</tr>
</table>
<a name="Theory_of_One-Way_ANOVA" id="Theory_of_One-Way_ANOVA"></a>
<h2><span class="mw-headline">一元配置分散分析(One-Way ANOVA)の理論</span></h2>
<p>k 個のレベルで測定された反応データがあるとします。ここで<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/One_Way_ANOVA_Algorithms/math-53969de94b3708187e040cc38293f661.png" title="y_{ij}\,\!" alt="y_{ij}\,\!" class="tex" border="0" /></span> は、 <i>j</i> 番目のファクターレベル (<i>j</i> = 1, 2, ..., k)での、<i>i</i>番目の観測値(i = 1, 2, ...<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/One_Way_ANOVA_Algorithms/math-4aa861124eff57dd7988faa6753e8b7e.png" title="n_j" alt="n_j" class="tex" border="0" /></span>) の値を表します。そして、一元配置ANOVAのモデルを以下のように書きます。</p>
<p><span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/One_Way_ANOVA_Algorithms/math-18ac8e0a81c8177f2a341169e66558ff.png" title="y_{ij}=u+t_j+\varepsilon _{ij}" alt="y_{ij}=u+t_j+\varepsilon _{ij}" class="tex" border="0" /></span>,<i>j</i> = 1,2, ..., <i>k</i>; <i>i</i> = 1, 2, ...<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/One_Way_ANOVA_Algorithms/math-4aa861124eff57dd7988faa6753e8b7e.png" title="n_j" alt="n_j" class="tex" border="0" /></span></p>
<p>ANOVA検定は、2つ以上の母集団(レベル)が等しいかどうかを調べます。ですから、帰無仮説は、異なる母集団の平均が同じとし、対立仮説は、少なくとも1つの標本の平均が、他とは異なるということになります。数学的に、これは次のように表すことができます。</p>
<p>H0:<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/One_Way_ANOVA_Algorithms/math-c73bd204f60c2fb90a3fdc612f03dfba.png" title="\mu =\mu _1=\mu _2=\cdots =\mu _k" alt="\mu =\mu _1=\mu _2=\cdots =\mu _k" class="tex" border="0" /></span></p>
<p>H1:<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/One_Way_ANOVA_Algorithms/math-83ac8a11cc465d7690f302a008cc1578.png" title="\mu _p\neq \mu _q" alt="\mu _p\neq \mu _q" class="tex" border="0" /></span>いくつかの<i>p</i>と<i>q</i>では、<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/One_Way_ANOVA_Algorithms/math-7588000cd59644c7b9cac3c6dd559059.png" title="1 \leq p" alt="1 \leq p" class="tex" border="0" /></span>と<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/One_Way_ANOVA_Algorithms/math-b923442948b5054ef5552308b82aaa88.png" title="q \geq k" alt="q \geq k" class="tex" border="0" /></span>が成り立ちます。</p>
<p>ここで <span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/One_Way_ANOVA_Algorithms/math-732981cec59c615df618a8ca96265370.png" title="\mu _i\,\!" alt="\mu _i\,\!" class="tex" border="0" /></span>は、 j番目の標本の平均です。仮説を検定するには、全サンプルをいくつかのグループに分け、グループ内の変化に対して 、F-検定を行い、2つの変化が異なるかどうかを検定します。</p>
<p>数学的には、 変化を推定する各部の平均平方を使うことが出来ます。</p>
<p><span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/One_Way_ANOVA_Algorithms/math-318b2225240c5d36c702a65d9791e911.png" title="\sum_{j=1}^k\sum_{i=1}^{n_1}(y_{ij}-\bar y)^2=\sum_{j=1}^kn_j(\bar y_j-\bar y)^2+\sum_{j=1}^k\sum_{i=1}^{n_1}(y_{ij}-\bar y_j)^2" alt="\sum_{j=1}^k\sum_{i=1}^{n_1}(y_{ij}-\bar y)^2=\sum_{j=1}^kn_j(\bar y_j-\bar y)^2+\sum_{j=1}^k\sum_{i=1}^{n_1}(y_{ij}-\bar y_j)^2" class="tex" border="0" /></span></p>
<p>ここで、左側の項は、二乗和の合計で、 2番目の項はtreatmentの二乗和で、これはグループ間の変化を表し、3番目の項は、誤差の二乗和で、グループ内の変化を表します。式は、一般に次のように表します。</p>
<p><span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/One_Way_ANOVA_Algorithms/math-2e316f3d38bb44586a05ad68555264bc.png" title="SS_{Total}=SS_{Treatment}+SS_{Error}\,\!" alt="SS_{Total}=SS_{Treatment}+SS_{Error}\,\!" class="tex" border="0" /></span></p>
<p><span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/One_Way_ANOVA_Algorithms/math-806277203dedea2ed8321f6cbd465a54.png" title="H_0\,\!" alt="H_0\,\!" class="tex" border="0" /></span> が真のとき、<i>k</i> レベルの標本データは、正規かつ独立して分散しており、平均 <span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/One_Way_ANOVA_Algorithms/math-d4af45ea35b4839bf0a40ebb0c7a4407.png" title="\mu\,\!" alt="\mu\,\!" class="tex" border="0" /></span>と分散 <span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/One_Way_ANOVA_Algorithms/math-03a7b0b49bea966adf365bb0d747ad89.png" title="\sigma ^2\,\!" alt="\sigma ^2\,\!" class="tex" border="0" /></span>を持っています。つまり、統計量は</p>
<p><span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/One_Way_ANOVA_Algorithms/math-3ae802b4468722915b610b8a10caa5ca.png" title="F=\frac{MS_{Treatment}}{MS_{Error}}=\frac{ss_{Treatment}/(k-1)}{ss_{Error}/(n-k)}" alt="F=\frac{MS_{Treatment}}{MS_{Error}}=\frac{ss_{Treatment}/(k-1)}{ss_{Error}/(n-k)}" class="tex" border="0" /></span></p>
<p>F分布 <span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/One_Way_ANOVA_Algorithms/math-bc03dd17df0bf9580dc44db49f8c532c.png" title="F_{(k-1, n-k)}\,\!" alt="F_{(k-1, n-k)}\,\!" class="tex" border="0" /></span> に従い、<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/One_Way_ANOVA_Algorithms/math-fe639299f2dbf4e9160e4f8086e83caf.png" title="MS_{Treatment}" alt="MS_{Treatment}" class="tex" border="0" /></span>はtreatmentsの平均平方、<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/One_Way_ANOVA_Algorithms/math-ff8dc369a4b279c7e064cb1ef6fc4ba1.png" title="MS_{Error}" alt="MS_{Error}" class="tex" border="0" /></span>はは誤差の平均平方になり、これらはそれぞれ自由度で二乗和を除算した形になっています。ある有意水準<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/One_Way_ANOVA_Algorithms/math-06f7895cd704b1cb0921cf98aec71926.png" title="\alpha\,\!" alt="\alpha\,\!" class="tex" border="0" /></span>が与えられてF 統計量が棄却値<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/One_Way_ANOVA_Algorithms/math-441f7078a6d67a201e54ee601f437ba2.png" title="F_{(k-1,n-k,\alpha)}\,\!" alt="F_{(k-1,n-k,\alpha)}\,\!" class="tex" border="0" /></span> を超える場合、帰無仮説は棄却されます。このとき、F 統計量は、有意水準<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/One_Way_ANOVA_Algorithms/math-06f7895cd704b1cb0921cf98aec71926.png" title="\alpha\,\!" alt="\alpha\,\!" class="tex" border="0" /></span> または同等の有意水準以下のP値で k-1 および n-k の自由度を持つF分布のこれは表形式の値です。</p>
<p>通常、ANOVA表の分散分析の結果を表します。</p>
<table class="simple">
<tr>
<th>分散の入力</th>
<th>自由度 (DF)</th>
<th>平方和 (SS)</th>
<th>平均平方 (MS)</th>
<th><i style="font-style: italic;">F</i> 値</th>
<th><i style="font-style: italic;">Prob</i> &gt; <i>F</i></th>
</tr>
<tr>
<th>モデル (ファクター)</th>
<td><i style="font-style: italic;">k</i>-1</td>
<td><span style="font-style: italic;"><img src="../images/One_Way_ANOVA_Algorithms/math-37ee04e2b0deee9bf057596e95fa9d4a.png" title="SS_{Treatme}" alt="SS_{Treatme}" class="tex" border="0" /></span></td>
<td><span style="font-style: italic;"><img src="../images/One_Way_ANOVA_Algorithms/math-fe639299f2dbf4e9160e4f8086e83caf.png" title="MS_{Treatment}" alt="MS_{Treatment}" class="tex" border="0" /></span></td>
<td><span style="font-style: italic;"><img src="../images/One_Way_ANOVA_Algorithms/math-fe639299f2dbf4e9160e4f8086e83caf.png" title="MS_{Treatment}" alt="MS_{Treatment}" class="tex" border="0" /></span> / <img src="../images/One_Way_ANOVA_Algorithms/math-ff8dc369a4b279c7e064cb1ef6fc4ba1.png" title="MS_{Error}" alt="MS_{Error}" class="tex" border="0" /></td>
<td><img src="../images/One_Way_ANOVA_Algorithms/math-4cfa5369bc0906fc9a5c5d9297de4180.png" title="P\{F\geq F_{(k-1,n-k,\alpha )}\}" alt="P\{F\geq F_{(k-1,n-k,\alpha )}\}" class="tex" border="0" /></td>
</tr>
<tr>
<th>誤差</th>
<td><i style="font-style: italic;">n-k</i></td>
<td><span style="font-style: italic;"><img src="../images/One_Way_ANOVA_Algorithms/math-349fb0475e9b16a6353bbc1aae235e6a.png" title="SS_{Error}" alt="SS_{Error}" class="tex" border="0" /></span></td>
<td><span style="font-style: italic;"><img src="../images/One_Way_ANOVA_Algorithms/math-ff8dc369a4b279c7e064cb1ef6fc4ba1.png" title="MS_{Error}" alt="MS_{Error}" class="tex" border="0" /></span></td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr>
<th>合計</th>
<td><i style="font-style: italic;">n</i>-1</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
</table>
<a name="Homogeneity_of_Variance" id="Homogeneity_of_Variance"></a>
<h2><span class="mw-headline">分散の等質性</span></h2>
<p>分散分析で、ことなるサンプルが等分散であると仮定すると、それは、一般に分散の等質性と呼ばれます。Levene検定とBrown-Forsythe検定は、仮定を検証するのに使うことができます。<i>k</i> 個の反応データの標本があるものとします。ここで<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/One_Way_ANOVA_Algorithms/math-53969de94b3708187e040cc38293f661.png" title="y_{ij}\,\!" alt="y_{ij}\,\!" class="tex" border="0" /></span>は、jt番目のファクターレベル (j = 1, 2, ..., k)でのi番目の観測 (<i>i</i> = 1, 2, ...<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/One_Way_ANOVA_Algorithms/math-4aa861124eff57dd7988faa6753e8b7e.png" title="n_j" alt="n_j" class="tex" border="0" /></span>) を表します。Levene検定とBrown-Forsythe検定の両方の仮説は、次の式で表すことが出来ます。</p>
<p><span class="texhtml"><i style="font-style: italic;">H</i><sub>0</sub></span>:<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/One_Way_ANOVA_Algorithms/math-6ae18486367863bbc938e896756f8df8.png" title="\sigma^2 _1=\sigma^2 _2=\cdots =\sigma^2 _k" alt="\sigma^2 _1=\sigma^2 _2=\cdots =\sigma^2 _k" class="tex" border="0" /></span></p>
<p><span class="texhtml"><i style="font-style: italic;">H</i><sub>1</sub></span>:<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/One_Way_ANOVA_Algorithms/math-2b5c2cc59d7a827f54617e61fb32f2d9.png" title="\sigma^2 _p\neq \sigma^2 _q" alt="\sigma^2 _p\neq \sigma^2 _q" class="tex" border="0" /></span> 少なくとも1組の(<i>p</i>, <i>q</i>)に対して<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/One_Way_ANOVA_Algorithms/math-f3befe30a4a0d18509558e6012408028.png" title="1\leq p,q\leq k" alt="1\leq p,q\leq k" class="tex" border="0" /></span></p>
<p><span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/One_Way_ANOVA_Algorithms/math-2af48c8053eb375472b4bbf78b90cec3.png" title="Z_{ij}\,\!" alt="Z_{ij}\,\!" class="tex" border="0" /></span> を異なる検定に従い、次の3つのように定義します。</p>
<ol>
<li>絶対Levene検定:<img src="../images/One_Way_ANOVA_Algorithms/math-b4e5bd6341b0f8ff84bf4a86cd819c58.png" title="Z_{ij}=|y_{ij}-\bar y_j|" alt="Z_{ij}=|y_{ij}-\bar y_j|" class="tex" border="0" /></li>
<li>Squared Levene検定:<img src="../images/One_Way_ANOVA_Algorithms/math-ca90d368003ebe629f44501f0e71c07a.png" title="Z_{ij}^2=(y_{ij}-\bar y_j)^2" alt="Z_{ij}^2=(y_{ij}-\bar y_j)^2" class="tex" border="0" /></li>
<li>Brown-Forsythe検定:<img src="../images/One_Way_ANOVA_Algorithms/math-face015854160d6388d3424185d3c24a.png" title="Z_{ij}=|y_{ij}-m_j|\,\!" alt="Z_{ij}=|y_{ij}-m_j|\,\!" class="tex" border="0" /></li>
</ol>
<p><span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px; font-style: italic;"><img src="../images/One_Way_ANOVA_Algorithms/math-e65765bedcabe42c66ec93228769e82a.png" title="H_0" alt="H_0" class="tex" border="0" /></span> を持つと、検定の統計量は</p>
<p><span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/One_Way_ANOVA_Algorithms/math-9550c1c345a48df5bdeda1954598b3a4.png" title="F=\frac{\sum_{j=1}^kn_j(\bar Z_j-\bar Z)^2/(k-1)}{\sum_{j=1}^k\sum_{i=1}^{n_1}(Z_{ij}-\bar Z_j)^2/(n-k)}" alt="F=\frac{\sum_{j=1}^kn_j(\bar Z_j-\bar Z)^2/(k-1)}{\sum_{j=1}^k\sum_{i=1}^{n_1}(Z_{ij}-\bar Z_j)^2/(n-k)}" class="tex" border="0" /></span></p>
<p>になり、これは(近似的に)F分布<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/One_Way_ANOVA_Algorithms/math-9c7168c68d0f7e7fcc65ef56a0cf4e87.png" title="F_{(k-1,n-k)}\,\!" alt="F_{(k-1,n-k)}\,\!" class="tex" border="0" /></span>に従い、<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/One_Way_ANOVA_Algorithms/math-68dd52e4750d73c982c39f0a3a5bc7b2.png" title="\overline{Z_j}" alt="\overline{Z_j}" class="tex" border="0" /></span> と <span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/One_Way_ANOVA_Algorithms/math-a79056b6644e25416e91e8b496e5d378.png" title="\overline{Z}" alt="\overline{Z}" class="tex" border="0" /></span>は、それぞれ<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/One_Way_ANOVA_Algorithms/math-2af48c8053eb375472b4bbf78b90cec3.png" title="Z_{ij}\,\!" alt="Z_{ij}\,\!" class="tex" border="0" /></span>の集団平均および全体平均となります。</p>
<a name="Multiple_Means_Comparisons" id="Multiple_Means_Comparisons"></a>
<h2><span class="mw-headline">複数の平均比較</span></h2>
<p>少なくとも1つの母平均が十分異なることを調べるANOVAを実行すると、それに続けて、平均が異なるかどうかすべてのファクターでの可能な組合せで、複数の平均の比較が行われます。Originでは、平均比較にさまざまな方法があり、これはNAG関数の<a href="http://www.originlab.com/pdfs/nagcl09/manual/pdf/g04/g04dbc.pdf" class="external text" title="http://www.originlab.com/pdfs/nagcl09/manual/pdf/g04/g04dbc.pdf" rel="nofollow" target="_blank"><b>nag_anova_confid_interval</b> <b>(g04dbc)</b></a> を使って行っています。</p>
<p>複数の平均の比較法の2種類がOriginに含まれています。</p>
<ol>
<li>シングルステップ法これは、Tukey-Kramer, Bonferroni, Dunn-Sidak, Fisher’s LSD, Schefféを含む、平均がどの程度違うのかを示すために信頼区間を作成します。</li>
<li>ステップワイズ法Holm-Bonferroni 、Holm-Sidak 検定を含む仮説検定を実行します。</li>
</ol>
<p>詳細はNAGヘルプを参照してください。</p>
<a name="Power_Analysis" id="Power_Analysis"></a>
<h2><span class="mw-headline">検出力解析</span></h2>
<p>検出力分析は、サンプルデータに対する仮説の検出力だけでなく、実際の検出力を計算します。</p>
<p>一元配置ANOVAの検出力は、その敏感度の計測です。検出力は、一元配置ANOVAが実際の差があるときの標本の平均の差を検出するものです。帰無仮説および対立仮説に関して、検出力は検定する統計量 <i>F</i> が、実際に帰無仮説を棄却すべき(例：与えられた帰無仮説が真でない)ときに、帰無仮説を棄却するのに十分であるという確率です。</p>
<p>検出力は次式で定義されます。</p>
<p><img src="../images/One_Way_ANOVA_Algorithms/math-994e2581ef30349da587e03faa17ce2b.png" title="power=1-probf(f,dfa,dfe,nc)\,\!" alt="power=1-probf(f,dfa,dfe,nc)\,\!" class="tex" style="color: #000000; font-family: Arial, sans-serif; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 19.2px; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;" border="0" /></p>
<p>ここで <i>f</i> は、非心の<i>F</i>-分布の偏りで、このF分布は <i>dfa</i> (モデルの自由度)と<i>dfe</i>(誤差の自由度) を持ちます。そして、<i>nc</i> = SST/MSE, ここで、<i>SST</i> は、モデルの二乗和、<i>MSE</i> は、誤差の平均平方です。<i>probf</i>( ) の値が、NAG関数<b><a href="http://www.originlab.com/pdfs/nagcl09/manual/pdf/g01/g01gdc.pdf" class="external text" title="http://www.originlab.com/pdfs/nagcl09/manual/pdf/g01/g01gdc.pdf" rel="nofollow" target="_blank">nag_prob_non_central_f_dist (g01gdc)</a></b>を使って取得されます。詳細はNAG文書をご覧ください。</p>
<p>上記は、簡単な一元配置ANOVAのアルゴリズムの概要であり、詳細な数学的な演算については、このマニュアルの対応する部分やNAG文書を参照してください。</p>
<p><br /></p>
