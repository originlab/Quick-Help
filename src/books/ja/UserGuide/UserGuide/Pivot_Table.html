<h1 class="firstheading">ピボットテーブル</h1><p class='urlname' style='display: none'>Wks-Pivot-Table</p>
<div style="text-align: left; direction: ltr; margin-left: 1em;">
<p><a  class="image"><img alt="Video Image.png" src="../images/Pivot_Table/Video_Image.png" width="33"  /></a> 関連する動画はこちら:<a class="external text" href="http://www.originlab.com/index.aspx?go=Products/Origin/DataAnalysis&amp;ss=chm&amp;pid=1574" target="_blank">Pivot Table</a>
</p></div>
<p>ピボットテーブルは、データ分析ソフトの一般的なデータサマリーツールです。テーブルは、変数の数を越えて収集された観測からなるデータセットを取ることによって構築され、目的の2つのカテゴリ変数、たとえば<i>Var1</i> と<i>Var2</i> を選びます。そして、<i>Var1</i> のすべての可能な値をテーブルの行で定義し、<i>Var2</i> のすべての可能な値は、列で定義します。テーブルセルには、行と列の値の交点による値が含まれます。ピボットテーブルは、<i>var1</i>を行、<i>var2</i> を列、ピボットテーブルのデータを行列の要素とした行列によく似ています。ピボットテーブルの分析テンプレートを保存することで、他のデータセットに対して似たようなデータサマリーを素早く作成することができます。 
Originのピボットテーブルは、以下のことが可能です。
</p>
<dl><dd><ul><li> カウントによるデータのサマリー、合計、平均、最大/最小値のレポート </li>
<li> 行と列の合計</li>
<li> 出力行と列を、行の合計またはラベルでソート</li>
<li> 分数またはパーセント値による正規化</li>
<li> 小さな値を統合して「その他」の列に入れる</li>
<li> パラメータの調整と簡単な再計算</li></ul></dd></dl>
<p>このツールを開くには
</p>
<ol><li> 分析するワークシートをクリックします。</li>
<li> <b>データ整形：ピボットテーブル</b>をクリックして<b>wpivot</b>ダイアログを開きます。</li></ol>
<p>wpivotダイアログは<a class="external text" href="../../XFunction/X-Function/Wpivot.html">wpivot X-ファンクション</a>を使用します。
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Dialog_Options"><span class="tocnumber">1</span> <span class="toctext">ダイアログオプション</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Pivot_Table_Row_Source"><span class="tocnumber">1.1</span> <span class="toctext">ピボットテーブルの行ソース</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Pivot_Table_Column_Source"><span class="tocnumber">1.2</span> <span class="toctext">ピボットテーブルの列ソース</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Pivot_Table_Data_Source"><span class="tocnumber">1.3</span> <span class="toctext">ピボットテーブルのデータソース</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Combine_Smaller_Values"><span class="tocnumber">1.4</span> <span class="toctext">より小さな値をまとめる</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Options"><span class="tocnumber">1.5</span> <span class="toctext">オプション</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Output_Result_Table_to"><span class="tocnumber">1.6</span> <span class="toctext">結果テーブルの出力先</span></a></li>
</ul>
</li>
</ul>
</div>
<h2><a name="Dialog_Options"></a><span class="mw-headline">ダイアログオプション</span></h2>
<dl><dd><a  class="image"><img alt="Pivot Table Dialog.png" src="../images/Pivot_Table/Pivot_Table_Dialog.png" width="524"  /></a></dd></dl>
<h3><a name="Pivot_Table_Row_Source"></a><span class="mw-headline">ピボットテーブルの行ソース</span></h3>
<p>ピボットテーブルの行ソースとして使用される列範囲を指定します。行ソース範囲内の同じ名前のソースワークシートのデータは、ピボットテーブルでは単一の行として表示されます。次のダイアグラムは行ソースの定義について説明しています。  1つ以上のデータ範囲をピボットテーブルの行ソースとして選択できます。 
</p><p><a  class="image"><img alt="Pv rowresource.png" src="../images/Pivot_Table/Pv_rowresource.png" width="1011"  /></a> <br />
</p><p>次のダイアグラムでは、ピボットテーブル内の複数行ソースの定義について説明しています。
</p><p><a  class="image"><img alt="Pv rowresourcemm.png" src="../images/Pivot_Table/Pv_rowresourcemm.png" width="1053"  /></a>
</p><p>この項目に表示ボックスと5つのボタン<a  class="image"><img alt="Group List Toolbar.png" src="../images/Pivot_Table/Group_List_Toolbar.png" width="160"  /></a>のついたツールバーがあります。
</p>
<table class="simple">
<tr>
<th width="200">表示ボックス
</th>
<td>選択された列が表示されます。この分析を行うには、行ソースのために少なくとも1列を選択する必要があります。
</td></tr>
<tr>
<th><b><b>選択</b></b>のための三角形ボタン <a  class="image"><img alt="Button Group List Add.png" src="../images/Pivot_Table/Button_Group_List_Add.png" width="17"  /></a>
</th>
<td>このボタンをクリックしてメニューから列を選択します。あるい<b><b>列の選択</b></b>をクリックして<a href="../../UserGuide/UserGuide/Specifying_Your_Input_Data.html#Column_Browser" title="ユーザーガイド：入力データの指定"><b>列ブラウザ</b></a>を開き、<b><b>表示ボックス</b></b>にピボットテーブルの行ソースとして列を追加します。このボタンを再度クリックして、他の列を追加の行ソースとして追加できます。
</td></tr>
<tr>
<th><b><b>削除</b></b>ボタン <a  class="image"><img alt="Button Group List Remove.png" src="../images/Pivot_Table/Button_Group_List_Remove.png" width="14"  /></a>
</th>
<td><b><b>表示ボックス</b></b>から選択したデータ範囲を削除します。このボタンはこのボックスで1つ以上のデータ範囲を選択しているときに利用可能です。
</td></tr>
<tr>
<th><b><b>上へ移動</b></b>ボタン <a  class="image"><img alt="Button Group List Move Up.png" src="../images/Pivot_Table/Button_Group_List_Move_Up.png" width="16"  /></a>
</th>
<td><b><b>表示ボックス</b></b>で選択したデータ範囲を上に移動します。このボタンを使用して、行ソース列を並べ替え、ピボットテーブルはこの順に従います。
</td></tr>
<tr>
<th><b><b>下へ移動</b></b>ボタン <a  class="image"><img alt="Button Group List Move Down.png" src="../images/Pivot_Table/Button_Group_List_Move_Down.png" width="13"  /></a>
</th>
<td><b><b>表示ボックス</b></b>で選択したデータ範囲を下に移動します。このボタンを使用して、行ソース列を並べ替え、ピボットテーブルはこの順に従います。
</td></tr>
<tr>
<th><b>すべて選択</b>ボタン <a  class="image"><img alt="Button Group List Select All.png" src="../images/Pivot_Table/Button_Group_List_Select_All.png" width="18"  /></a>
</th>
<td><b>表示ボックス</b>のデータ範囲を全て選択します。
</td></tr></table>
<h3><a name="Pivot_Table_Column_Source"></a><span class="mw-headline">ピボットテーブルの列ソース</span></h3>
<p>ピボットテーブルの列ソースとして使用する列範囲を指定します。列ソース範囲内の同じ名前のソースワークシートのデータは、ピボットテーブルでは単一の列として表示されます。次のダイアグラムは列ソースの定義について説明しています。列の情報は他の列ラベル行に示すこともできます。1つ以上のデータ範囲をピボットテーブルの列ソースとして選択できます。ピボットテーブルの列ソースの構成は、行ソースのものに似ています。
</p><p><a  class="image"><img alt="Pv column resource.png" src="../images/Pivot_Table/Pv_column_resource.png" width="1002"  /></a>
</p>
<table class="note">
<tr>
<td><b>Note:</b>
<ol><li> このパートは、表示ボックスと5つのボタン<a  class="image"><img alt="Group List Toolbar.png" src="../images/Pivot_Table/Group_List_Toolbar.png" width="160"  /></a>を持つツールバーを含みます。これらの使用についての情報は、<a href="../../UserGuide/UserGuide/Pivot_Table.html#Pivot_Table_Row_Source" title="ユーザガイド:ピボットテーブル"><b>ピボットテーブルの行ソース</b></a>セクションを確認してください。</li>
<li> <b>列ソース</b>の値は、デフォルトでは<i>コメント</i>行に配置されます。しかし、<a href="../../UserGuide/UserGuide/Pivot_Table.html#Options" title="ユーザガイド:ピボットテーブル"><b>オプション</b></a>の<b>列の情報を加える</b>のドロップダウンリストで<i>ロングネーム</i> などの他のラベル行にすることもできます。</li></ol>
</td></tr></table>
<h3><a name="Pivot_Table_Data_Source"></a><span class="mw-headline">ピボットテーブルのデータソース</span></h3>
<p>これは<b>サマリー出力タイプ</b>で<b>カウント</b>が選択されていない場合にのみ有効です(<b>Method</b> 変数)。1次元の列から2次元の行列のようなピボットテーブルに要約されるデータ値です。 
</p><p><br />
</p>
<ul><li><b>最大、最小、平均、合計によるデータのサマリー</b> </li></ul>
<dl><dd>ピボットテーブルにデータを構成する方法は、<b>最大</b>、<b>最小</b>、<b>平均</b>、<b>合計</b>によるデータのサマリーに似ています。下図は<b>合計</b>でデータをサマリーしたサンプルです。<br /> </dd>
<dd><a  class="image"><img alt="Pv data.png" src="../images/Pivot_Table/Pv_data.png" width="478"  /></a></dd></dl>
<dl><dd>以下のサンプルでは、セル(2001, <i>Bikes</i>)の総費用は、次の条件で抽出した<i>TotalCost</i> 列のセルの合計です：<i>ProductCategory</i> は <i>Bikes</i> かつ <i>YEAR</i> が <i>2001</i> </dd></dl>
<dl><dd><a  class="image"><img alt="Pv data1.png" src="../images/Pivot_Table/Pv_data1.png" width="916"  /></a></dd></dl>
<ul><li><b>カウントによるデータのサマリー</b></li></ul>
<dl><dd>反対に、<b>サマリー出力タイプ</b>に<b>カウント</b>が選択されていると、テーブルは、行ソースと列ソースに関連したセルの位置のカウント数で埋められます。</dd></dl>
<h3><a name="Combine_Smaller_Values"></a><span class="mw-headline">より小さな値をまとめる</span></h3>
<p><b>より小さい値をまとめる</b>は、似たような値を「その他」の列にまとめ、少しのカテゴリを表示します。詳細は以下のサンプルを参照してください。 
</p><p><br />
</p>
<ul><li><b>方向の統合</b>：「なし」でない場合、<b>行</b>カテゴリまたは<b>列</b>カテゴリいずれの選択ともに有効です。しかし、行とカテゴリー両方における小さい値の組み合わせは現在サポートされていません。</li></ul>
<p><br />
</p>
<ul><li><b>モード</b>：このドロップダウンリストで、値を要約する小さい値の組み合わせを指定します。<b>カウント</b>、<b>合計</b>、<b>平均</b>、<b>最小</b>、<b>最大</b>があります。</li></ul>
<table class="note">
<tr>
<td><b>Note</b>:<b>モード</b>を選択すると、<b>パーセント</b>、<b>参照行/列のパーセント</b>、<b>上位N</b>、<b>列/行ラベル</b>などのオプションを指定できます。<b>モード</b>ドロップダウンリストの下にあり、選択されたモードに対応して変化します。
</td></tr></table>
<dl><dd><ul><li><b>総和に対するパーセント</b>：要約された値(<b>カウント</b>/<b>合計</b>/<b>平均</b>/<b>最小</b>/<b>最大</b>)のパーセントの行/列カテゴリーは、しきい値パーセントを越える全ての合計を説明され、残りはデフォルトで<b>Others</b> カテゴリーに統合されます。<b>モード</b>ドロップダウンリストの下の<b>パーセント</b>でしきい値パーセントを指定できます。
 </li></ul></dd></dl>
<dl><dd><dl><dd><a  class="image"><img alt="Combine-PVT1.png" src="../images/Pivot_Table/Combine-PVT1.png" width="481"  /></a></dd></dl></dd></dl>
<dl><dd><dl><dd>削減されたカテゴリのデフォルト名を変更するには、<b>モード</b>ドロップダウンリストの下の<b>行(または列)ラベル</b>で新しい名前を指定します。  次のスクリーンショットでは、削減されたカテゴリーのデフォルト名が<b>Other Smaller Item</b>に変更され、小さいパーセンテージの他のカテゴリーはこのカテゴリーに削減されます。</dd></dl></dd></dl>
<dl><dd><dl><dd><a  class="image"><img alt="Combine-PVT2.png" src="../images/Pivot_Table/Combine-PVT2.png" width="446"  /></a>  </dd></dl></dd></dl>
<dl><dd><ul><li><b>参照行/列のパーセント</b>：参照列/行カテゴリー内の要約された値のパーセンテージの行/列カテゴリーはしきい値パーセントを超える全ての合計を説明し、リストされます。残りは削減され、<b>Other</b>(デフォルト)カテゴリーに統合されます。<b>参照列/行の値</b>に参照列/行カテゴリーを指定するために、表示された利用可能な値の一つを選択します。しきい値パーセントの編集と列名の削減については、<b>総和に対するパーセント</b>を参照してください。 </li></ul></dd></dl>
<dl><dd><ul><li><b>総計の上位N件</b>：各行/列カテゴリーの要約された値は順位づけされ、上位N行/列のカテゴリーがリストされます。<b>上位N</b>と<b>行(または列)ラベル</b>は、<b>モード</b>ドロップダウンリストの下で指定します。</li></ul></dd></dl>
<dl><dd><ul><li><b>参照列の上位N件</b>：列/行参照カテゴリー内の各行/列カテゴリーの要約された値は順位づけされ、上位N行/列のカテゴリーがリストされます。<b>上位N</b>と<b>行(または列)ラベル</b>は、<b>モード</b>ドロップダウンリストの下で指定します。</li></ul></dd></dl>
<dl><dd><ul><li><b>参照行の値</b>：<b>モード</b>で<b>参照行/列のパーセント</b>または<b>参照行/列の上位N件</b>が選択されている時に、参照行/列を指定します。</li></ul></dd></dl>
<dl><dd><ul><li><b>パーセント</b>：<b>モード</b>で<b>総和に対するパーセント</b>または<b>参照行/列のパーセント</b>が選択されている時に、より小さな値をまとめるパーセントを指定します。</li></ul></dd></dl>
<dl><dd><ul><li><b>列/行ラベル</b>：より小さな値が統合された時に、削減されたカテゴリー名を指定します。</li></ul></dd></dl>
<h3><a name="Options"></a><span class="mw-headline">オプション</span></h3>
<ul><li><b>行合計の列追加</b>：このオプションは行合計の列を追加します。</li></ul>
<p><br />
</p>
<dl><dd><a  class="image"><img alt="Row label ac222e.png" src="../images/Pivot_Table/Row_label_ac222e.png" width="459"  /></a></dd></dl>
<ul><li><b>出力行のソート</b>：このオプションは出力行の順番のソートを定義します。</li></ul>
<dl><dd><ul><li><b>行ラベルの昇順</b>：このオプションは行ラベルの昇順で行をソートします。<br />以下のサンプルをみてください。<i>Year</i> を行ソースとして使用した場合、これは昇順にソートされます。以下のサンプルをみてください。1つ以上の範囲を行ソースとして選択した場合、ピボットテーブルは行ソースの順序を参照して構成されます。 </li></ul></dd></dl>
<dl><dd><a  class="image"><img alt="Row label ac.png" src="../images/Pivot_Table/Row_label_ac.png" width="1011"  /></a></dd></dl>
<dl><dd><ul><li><b>行ラベルの降順</b>：このオプションは行ラベルの降順で行をソートします。<b>行ラベルの昇順</b>に似ていますが、ソートされたデータの順序は逆になります。 </li></ul></dd></dl>
<dl><dd><ul><li><b>行合計による昇順</b>：このオプションは行合計を昇順でソートします。この条件では、<b>ピボットテーブルのデータソース</b>として数字のデータのみ許可されます。このオプションは、<b>行合計の列追加</b>のボックスの選択に関わらず、選択できます。</li></ul></dd></dl>
<dl><dd><ul><li><b>行合計による降順</b>：このオプションは行合計を降順でソートします。<b>行合計による昇順</b>と同様、<b>ピボットテーブル</b>のデータソースとして数字のデータのみ許可されます。</li></ul></dd></dl>
<dl><dd><ul><li><b>なし</b>：行をソートしません。</li></ul></dd></dl>
<ul><li><b>列合計の行追加</b>：<b>行合計の列追加</b>と同様、列合計のための行を追加します。</li></ul>
<ul><li><b>出力列のソート</b>：<b>出力行のソート</b>と同様、<b>なし</b>以外を選択すると列ラベルまたは列合計の昇順または降順でソートします。</li></ul>
<ul><li><b>列の合計を正規化</b></li></ul>
<dl><dd><ul><li><b>なし</b>：データを正規化しません。</li></ul></dd></dl>
<dl><dd><ul><li><b>小数</b>：列合計によって各列のデータを正規化し、率表記でレポートします。</li></ul></dd></dl>
<dl><dd><ul><li><b>パーセント</b>：列合計によって各列のデータを正規化し、パーセント表記でレポートします。</li></ul></dd></dl>
<ul><li><b>空白時ゼロを表示</b>：空セルを欠損値ではなく0で表示します。サマリー出力タイプがカウント以外のときに利用できます。</li></ul>
<ul><li><b>行ソースの追加値</b>：このオプションはあまり使用されませんが<b>列ソースの追加値</b>を参照してください。 </li></ul>
<ul><li><b>列ソースの追加値</b>：このオプションは、ソースデータ列で欠損した追加のカテゴリーを提供します。これは、全ての必要なカテゴリーが結果テーブル内にあるか確認する時に便利です。入力データにおける欠損カテゴリーは<i>0</i>(<b>カウント</b>や<b>合計</b>によるサマリーのとき)または、欠損値 &quot;--&quot; (<b>最小</b>や<b>最大</b>によるサマリーのとき)で表示されます。  </li></ul>
<p>次のようなデータセットがある場合を考えます(下の画像のソースワークシート)。これは、2001年から2004年の製品(<i>Bike</i>, <i>Accessories</i>, <i>Clothing</i>) の各国での売り上げデータです。各年における製品それぞれの総費用を表すサマリーを作成したいとします。列カテゴリーとして<i>YEAR</i> 、行カテゴリーとして<i>Categories</i> を指定します。  しかし、<i>Accessories</i> と<i>Clothing</i> の2001年と2002年の売上履歴がありません。次の2つのケースは、<b>列ソースの追加値</b>を使用しているかどうかの異なる結果を表示します。
</p>
<dl><dd><ul><li><b>列追加値がない場合</b> </li></ul>
<dl><dd>ワークシートクエリを使用して、条件：<i>YEAR &lt;= 2002</i> でデータを表示し、新しく抽出されたデータをもとに、<b>列追加値</b>を指定せずに総費用の合計のピボットテーブルを作成します。  ピボットテーブルは、<i>Accessories</i> と<i>Clothing</i>のカテゴリーを含めず、ソースワークシートに、<i>YEAR</i> が2001と2002の履歴があるデータである<i>Bikes</i>のカテゴリーのみを表示します。 </dd></dl></dd></dl>
<dl><dd><dl><dd><a  class="image"><img alt="Pv filter 0.png" src="../images/Pivot_Table/Pv_filter_0.png" width="478"  /></a></dd></dl></dd></dl>
<dl><dd><dl><dd><a  class="image"><img alt="Pv filter 1.png" src="../images/Pivot_Table/Pv_filter_1.png" width="869"  /></a></dd></dl></dd></dl>
<dl><dd><ul><li><b>列追加値を使用する場合</b></li></ul></dd></dl>
<dl><dd><dl><dd><b>列追加値</b>を指定して同じようなピボットテーブルを作成する場合、履歴の欠損に関わらず、ピボットテーブルは3つのカテゴリー全てを表示します。欠損のあるカテゴリーは合計０で表示されます。 </dd></dl></dd></dl>
<dl><dd><dl><dd><a  class="image"><img alt="Pv filter 2.png" src="../images/Pivot_Table/Pv_filter_2.png" width="483"  /></a></dd></dl></dd></dl>
<dl><dd><dl><dd><a  class="image"><img alt="Pv filter 3.png" src="../images/Pivot_Table/Pv_filter_3.png" width="1021"  /></a></dd></dl></dd></dl>
<dl><dd><dl><dd><table class="note">
<tr>
<td><b>Note:</b>
<p><b>列追加値</b>の機能は、ピボットテーブルを使用してグラフを作図するときに非常に重要です。この場合、ソースワークシートのいくつかのカテゴリーの記録が完全でなくても、全てのカテゴリーを表示したいことがあります。<b>列追加値</b>の設定は、欠損データを自動的に0として扱い、関連するカテゴリはグラフにはデータグループとして表示されます。
</p>
</td></tr></table></dd></dl></dd></dl>
<dl><dd><dl><dd><a  class="image"><img alt="Pv filter 4.png" src="../images/Pivot_Table/Pv_filter_4.png" width="810"  /></a></dd></dl></dd></dl>
<ul><li><b>列情報を加える</b>：列カテゴリーの名前は、デフォルトでピボットテーブルのコメントラベル行に入力されますが、カテゴリー名はこのドロップダウンリストで選択した他の列ラベル行に入力することができます。 </li></ul>
<dl><dd><ul><li><b>ロングネーム</b>：列カテゴリー名をロングネームに出力します。</li></ul></dd></dl>
<dl><dd><ul><li><b>コメント</b>：列カテゴリー名をコメントに出力します。</li></ul></dd></dl>
<dl><dd><ul><li><b>列のロングネームを追加</b>：ソースワークシート内の列カテゴリーのロングネームを、ピボットテーブルのロングネームラベル行に追加します。</li></ul></dd></dl>
<dl><dd><ul><li><b>ユーザ定義パラメータ</b>：列カテゴリの他の情報(ソースワークシートの列カテゴリーのショートネームやロングネーム)を、ピボットテーブルのユーザ定義パラメータ行に出力します。  </li></ul></dd></dl>
<ul><li><b>開始列</b>:ユーザ定義パラメータのソース値を指定します。列情報を加えるでユーザ定義パラメータが選択された時にのみ有効です。</li></ul>
<dl><dd><ul><li><b>ショートネーム</b>：ソースワークシートの列カテゴリーのショートネームを、ユーザ定義パラメータの入力情報として選択します。 </li></ul></dd></dl>
<dl><dd><ul><li><b>ロングネーム</b>：ソースワークシートの列カテゴリーのロングネームを、ユーザ定義パラメータの入力情報として選択します。</li></ul></dd></dl>
<h3><a name="Output_Result_Table_to"></a><span class="mw-headline">結果テーブルの出力先</span></h3>
<p>結果ピボットテーブルを出力する場所を指定します。三角形のボタンをクリックして出力方法を指定します。<br /> 
</p><p><b>[&lt;入力&gt;]&lt;入力&gt;</b>:現在のワークシートにピボットテーブルを入力します。
</p><p><b>&lt;新規&gt;</b>：現在のワークブックの新しいシートにピボットテーブルを出力します。
</p><p><b>[&lt;新規&gt;]&lt;新規&gt;</b>:新しいワークブックにピボットテーブルを出力します。
</p>



    