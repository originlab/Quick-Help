<h1 class="firstheading">ファイルの添付と添付ファイルの取り出し</h1>
<p>OPJファイルにファイルを添付したり、添付したファイルを見るには、<b>コードビルダ</b>を使います。</p>
<table id="toc" class="toc" summary="Contents">
<tr>
<td>
<div id="toctitle">
<h2>内容</h2>
</div>
<ol>
<li class="toclevel-1"><a href="#Attaching_files_to_the_OPJ"><span class="tocnumber">1</span> <span class="toctext">OPJファイルにファイルを添付する</span></a></li>
<li class="toclevel-1"><a href="#Locating_and_opening_attached_third-party_files"><span class="tocnumber">2</span> <span class="toctext">添付されたサードパーティ製のファイルを取り出す</span></a></li>
<li class="toclevel-1"><a href="#Special_Handling_of_Origin_C_and_OGS_files"><span class="tocnumber">3</span> <span class="toctext">Origin CファイルおよびOGSファイルの添付における特別な取り扱い</span></a></li>
<li class="toclevel-1"><a href="#How_attached_third-party_files_are_handled_when_appending_OPJ_files"><span class="tocnumber">4</span> <span class="toctext">OPJファイルを追加したときの添付されたサードパーティ製のファイルの取り扱いについて</span></a></li>
</ol>
</td>
</tr>
</table>
<a name="Attaching_files_to_the_OPJ" id="Attaching_files_to_the_OPJ"></a>
<h2><span class="mw-headline">OPJファイルにファイルを添付する</span></h2>
<p>OPJファイルにファイルを添付するには</p>
<ol>
<li>「標準」ツールバーの「<b>コードビルダ</b>」ボタン <a href=""><img alt="Image:Button_Code_Builder.png" src="../images/The_Code_Builder/Button_Code_Builder.png" width="23" height="23" border="0" /></a>をクリックします。</li>
<li>ツリー形式のOrigin Cワークスペースウィンドウにある<b>Project</b>サブフォルダを右クリックし、「<b>ファイルを追加</b>」メニューを選びます。
<dl>
<dd><span><a href="" style="color: #0000ff; text-decoration: underline;"><img alt="Image:Attaching Files to the Origin Project-1.png" src="../images/Attaching_Files_to_the_Origin_Project/Attaching_Files_to_the_Origin_Project-1.png" width="208" height="116" border="0" /></a></span></dd>
</dl>
</li>
<li>OPJファイルに添付したいファイルを選択します。( <b>User</b> や <b>Temp</b>のような他のフォルダから<b>Project</b>フォルダにドラッグ&amp;ドロップすることもできます。)</li>
<li>Originプロジェクトファイルを保存する時、<b>Project</b>フォルダにあるすべてのファイルがOPJファイルに追加され、一緒に保存されます。Projectフォルダの内容は、OPJファイルと一緒に保存されますので、コードビルダ内のワークスペースを変更しても、このフォルダの内容は変更されません。</li>
</ol>
<a name="Locating_and_opening_attached_third-party_files" id="Locating_and_opening_attached_third-party_files"></a>
<h2><span class="mw-headline">添付されたサードパーティ製のファイルを取り出す</span></h2>
<p>添付されたファイルがあるOPJファイルを開く時、そのファイルは一時フォルダに展開され、そこに保存されます。</p>
<p>そのフォルダのパスを表示して、ファイルを開くには</p>
<ol>
<li>ツリー形式のOrigin Cワークスペースウィンドウにある<b>Project</b>サブフォルダを右クリックし、「<b>フルパスを表示</b>」メニューを選びます。</li>
<li>添付されたファイルは、ファイル名をダブルクリックして開くことができます。</li>
</ol>
<ul>
<li>添付されたファイルがコードビルダで認識できるファイルの場合(Origin C および OGSファイルは特別な取り扱いがなされます。)、これらのファイルはコードビルダのMDI領域で新しいウィンドウとして開きます。</li>
<li>添付されたファイルがコードビルダで認識できないファイルの場合、OriginはファイルをWindowsに渡し、Windowsに関連付けされたアプリケーションがそのファイルを開きます。例えば、Microsoft Wordファイルが添付されていて、このファイルをダブルクリックする場合、そのファイルはMicrosoft Wordのアプリケーションによって開かれます。</li>
</ul>
<p>別の方法として、Windowsエクスプローラを使って、一時サブフォルダに移動して、そのファイルをダブルクリックして開きます。プロジェクトを閉じると、このサブフォルダは、system.Windowsによって削除されます。</p>
<a name="Special_Handling_of_Origin_C_and_OGS_files" id="Special_Handling_of_Origin_C_and_OGS_files"></a>
<h2><span class="mw-headline">Origin CファイルおよびOGSファイルの添付における特別な取り扱い</span></h2>
<p>Origin CファイルとOGSファイルの特別な取り扱いにより、作成したコードをOPJファイルに添付して、他のOriginユーザに簡単に配布できるカスタムアプリケーションを作成することができます。</p>
<p>プロジェクトファイルに添付されるOrigin Cファイルは、プロジェクトを開いたときに、コンパイルされ、ロードされます。Origin Cファイルで定義されているすべての関数が、プロジェクトを開いたときに、ユーザインターフェースを介して利用可能となります。</p>
<p>OGSファイルでは、プロジェクトを開いたときに、添付されたOPJファイルにあるスクリプトのセクションをユーザインターフェースを介して実行することができます。例えば、MyScripts.OGSというファイルを添付する場合、一度プロジェクトを開いたら、次のようなコマンドを使うだけで、スクリプトを実行することができます。</p>
<pre class="lt">

Run.<span style="color: #000080;">section</span><span style="color: #000000;">(</span>MyScripts, MySection<span style="color: #000000;">)</span>;<br />
</pre>
<p>Originは、開いたOPJファイルにMyScripts.OGSというファイルがあるかどうかを探します。そして、そのOGSファイル内でMySectionというセクションを探します。見つかったら、そのセクションを実行します。添付されたファイルが見つからなければ、Originは、ユーザファイル領域を探し、最終的にOriginの実行ファイルのパスを探します。</p>
<a name="How_attached_third-party_files_are_handled_when_appending_OPJ_files" id="How_attached_third-party_files_are_handled_when_appending_OPJ_files"></a>
<h2><span class="mw-headline">OPJファイルを追加したときの添付されたサードパーティ製のファイルの取り扱いについて</span></h2>
<p>Originのプロジェクトファイルを現在開いているプロジェクトに追加することができます。これは追加されるプロジェクトの内容を現在のプロジェクトファイルに追加するということです。プロジェクトを追加するとき、Originは添付されたファイルを次のように取り扱います。</p>
<ul>
<li>同じ名前の添付ファイルが開いているプロジェクトに添付されていなければ、添付ファイルは開いているプロジェクトに添付されます。</li>
<li>同じ名前の添付ファイルが開いているプロジェクトに添付されている場合、ファイルの内容が比較されます。同一の内容だと見なされると2番目の添付ファイルは破棄されます。</li>
<li>添付されたファイルは同じで、ファイルの内容が異なる場合、2番目のファイルのファイル名が変更(例："TestData.txt"が"TestData1.txt"になる)されて、ファイルが添付されます。</li>
</ul>
