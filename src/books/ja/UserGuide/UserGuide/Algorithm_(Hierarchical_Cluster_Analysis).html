<h1 class="firstheading">アルゴリズム (階層的クラスター分析)</h1>
<table id="toc" class="toc" summary="Contents">
<tr>
<td>
<div id="toctitle">
<h2>内容</h2>
</div>
<ol>
<li class="toclevel-1"><a href="#Distance_Matrix"><span class="tocnumber">1</span> <span class="toctext">距離行列</span></a>
<ol>
<li class="toclevel-2"><a href="#Cluster_Observations"><span class="tocnumber">1.1</span> <span class="toctext">クラスター観測</span></a></li>
<li class="toclevel-2"><a href="#Cluster_Variables"><span class="tocnumber">1.2</span> <span class="toctext">クラスター変数</span></a></li>
</ol>
</li>
<li class="toclevel-1"><a href="#Linkage_Method"><span class="tocnumber">2</span> <span class="toctext">結合法</span></a></li>
<li class="toclevel-1"><a href="#Dendrogram"><span class="tocnumber">3</span> <span class="toctext">樹形図</span></a></li>
<li class="toclevel-1"><a href="#Group_Objects"><span class="tocnumber">4</span> <span class="toctext">グループオブジェクト</span></a></li>
</ol>
</td>
</tr>
</table>

<p><br />
<b>階層的クラスター分析</b>は階層樹を作るのに使用されます。それぞれが一つのオブジェクトを持った<i>ｎ</i>個のクラスターから始まります。まずは2つのクラスターを１つに統合してより大きなクラスターを最終的に１つの大きなクラスターになるまで行います。このプロセスは<b>樹形図</b>で見ることができます。</p>
<p><b style="font-weight: bold;">階層的クラスター分析</b>でクラスターに分類されるオブジェクトは観測データでも変数でも可能です。</p>
<a name="Distance_Matrix" id="Distance_Matrix"></a>
<h2><span class="mw-headline">距離行列</span></h2>
<p>距離または不同性行列は、対称行列にゼロ斜線要素を追加した行列です。<i>ij</i> 番目の要素が、<i>i</i> 番目と<i>j</i> 番目のオブジェクト間がどれだけ離れてる、または似ていないかを表しています。2つのオブジェクト間で距離を計算する方法はクラスター観測とクラスター変数で違ってきます。</p>
<a name="Cluster_Observations" id="Cluster_Observations"></a>
<h3><span class="mw-headline">クラスター観測</span></h3>
<p>Originはクラスター観測に関して、距離を計算する前にまず正規化を行います。欠損値がある観測データは分析から除外されます。</p>
<ul>
<li>標準化変数
<ol>
<li>N(0,1) に標準化<br />
変数<span class="Apple-converted-space">&#160;</span><img src="../images/Algorithm_(Hierarchical_Cluster_Analysis)/math-1ff32f369704bbf722cb41dd4727b5ea.png" title="x_j\ " alt="x_j\ " class="tex" style="color: #000000; font-family: Arial, sans-serif; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 24px; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;" border="0" /> は次のように標準化されます。<span class="Apple-converted-space">&#160;</span><img src="../images/Algorithm_(Hierarchical_Cluster_Analysis)/math-8a2aa7bf0d735426ff95edf02207ad93.png" title="(x_j-\bar{x}_j)/\sigma_j" alt="(x_j-\bar{x}_j)/\sigma_j" class="tex" style="color: #000000; font-family: Arial, sans-serif; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 24px; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;" border="0" /> 、そして<span class="Apple-converted-space">&#160;</span><img src="../images/Algorithm_(Hierarchical_Cluster_Analysis)/math-9a256199940d00c2536a5816e8562a68.png" title="\bar{x}_j\ " alt="\bar{x}_j\ " class="tex" style="color: #000000; font-family: Arial, sans-serif; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 24px; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;" border="0" /> と<span class="Apple-converted-space">&#160;</span><img src="../images/Algorithm_(Hierarchical_Cluster_Analysis)/math-a4ff3192674d9d65f2d0d7d64cf24c70.png" title="\sigma_j\ " alt="\sigma_j\ " class="tex" style="color: #000000; font-family: Arial, sans-serif; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 24px; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;" border="0" /> はこの変数の平均と標準偏差を表しています。標準化変数は平均０と標準偏差１になります。</li>
<li>(0,1) に標準化<br />
変数<span class="Apple-converted-space">&#160;</span><img src="../images/Algorithm_(Hierarchical_Cluster_Analysis)/math-1ff32f369704bbf722cb41dd4727b5ea.png" title="x_j\ " alt="x_j\ " class="tex" style="color: #000000; font-family: Arial, sans-serif; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 24px; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;" border="0" /> は次のように正規化されます。<span class="Apple-converted-space">&#160;</span><img src="../images/Algorithm_(Hierarchical_Cluster_Analysis)/math-da8bfea696c5d55d5c80213b624edaae.png" title="(x_j-\mathrm{min}(x_j))/(\mathrm{max}(x_j)-\mathrm{min}(x_j))\ " alt="(x_j-\mathrm{min}(x_j))/(\mathrm{max}(x_j)-\mathrm{min}(x_j))\ " class="tex" style="color: #000000; font-family: Arial, sans-serif; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 24px; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;" border="0" /> .変数は0から1の間で標準化されます。</li>
</ol>
</li>
</ul>
<p>Originは３つの距離タイプをサポートします。</p>
<ul>
<li>距離タイプ<br />
は<i>ｎ</i>個の観測点と<i>ｐ</i>変数を使った正規化行列<span class="Apple-converted-space">&#160;</span><img src="../images/Algorithm_(Hierarchical_Cluster_Analysis)/math-61b39f8b9a10e8428d4a1ee092fe90cd.png" title="x_{ij}\ " alt="x_{ij}\ " class="tex" style="color: #000000; font-family: Arial, sans-serif; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 24px; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;" border="0" /> で、<i>i</i> 番目の観測データと<i>ｋ</i>番目の観測データは次のように表わされています。
<ol>
<li>ユークリッド距離<br />
<img src="../images/Algorithm_(Hierarchical_Cluster_Analysis)/math-9b4e398de3c2f5d2506b9b45fe329ccc.png" title="d_{ik}=\Big\{\sum_{j=1}^p (x_{ij}-x_{kj})^2 \Big\}^{\frac{1}{2}}" alt="d_{ik}=\Big\{\sum_{j=1}^p (x_{ij}-x_{kj})^2 \Big\}^{\frac{1}{2}}" class="tex" style="color: #000000; font-family: Arial, sans-serif; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 24px; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;" border="0" /></li>
<li>平方ユークリッド距離<br />
<img src="../images/Algorithm_(Hierarchical_Cluster_Analysis)/math-00782c326cb91952af29de57a841a9c2.png" title="d_{ik}=\sum_{j=1}^p (x_{ij}-x_{kj})^2" alt="d_{ik}=\sum_{j=1}^p (x_{ij}-x_{kj})^2" class="tex" style="color: #000000; font-family: Arial, sans-serif; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 24px; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;" border="0" /></li>
<li>City-Block 距離<br />
<img src="../images/Algorithm_(Hierarchical_Cluster_Analysis)/math-95f211a025ebc7daa3e1605459b1cbd2.png" title="d_{ik}=\sum_{j=1}^p |x_{ij}-x_{kj}|" alt="d_{ik}=\sum_{j=1}^p |x_{ij}-x_{kj}|" class="tex" style="color: #000000; font-family: Arial, sans-serif; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 24px; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;" border="0" /></li>
<li>コサイン距離<br />
<img src="../images/Algorithm_(Hierarchical_Cluster_Analysis)/math-b9b1c3b4992cc70b4946348c159f37e6.png" title="d_{ik}=1-\frac{\sum_{j=1}^p x_{ij}x_{kj}}{\sqrt{\sum_{j=1}^p x_{ij}^2}\sqrt{\sum_{j=1}^p x_{kj}^2}}" alt="d_{ik}=1-\frac{\sum_{j=1}^p x_{ij}x_{kj}}{\sqrt{\sum_{j=1}^p x_{ij}^2}\sqrt{\sum_{j=1}^p x_{kj}^2}}" class="tex" style="color: #000000; font-family: Arial, sans-serif; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 24px; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;" border="0" /></li>
<li>ピアソン相関距離<br />
<img src="../images/Algorithm_(Hierarchical_Cluster_Analysis)/math-36d3bef9314267d27776738195752c04.png" title="d_{ik}=1-\frac{\sum_{j=1}^p (x_{ij}- \bar x_i)(x_{kj}- \bar x_k)}{\sqrt{\sum_{j=1}^p (x_{ij}- \bar x_i)^2}\sqrt{\sum_{j=1}^p (x_{kj}- \bar x_k)^2}}" alt="d_{ik}=1-\frac{\sum_{j=1}^p (x_{ij}- \bar x_i)(x_{kj}- \bar x_k)}{\sqrt{\sum_{j=1}^p (x_{ij}- \bar x_i)^2}\sqrt{\sum_{j=1}^p (x_{kj}- \bar x_k)^2}}" class="tex" style="color: #000000; font-family: Arial, sans-serif; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 24px; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;" border="0" /><br />
ここで、<span class="Apple-converted-space">&#160;</span><img src="../images/Algorithm_(Hierarchical_Cluster_Analysis)/math-0ff233a32e8ef8117a1b351b11a3a544.png" title="\bar x_i=\sum_{j=1}^p x_{ij}" alt="\bar x_i=\sum_{j=1}^p x_{ij}" class="tex" style="color: #000000; font-family: Arial, sans-serif; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 24px; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;" border="0" /> と<span class="Apple-converted-space">&#160;</span><img src="../images/Algorithm_(Hierarchical_Cluster_Analysis)/math-026de1a29e08504cc940a5d530450259.png" title="\bar x_k=\sum_{j=1}^p x_{kj}" alt="\bar x_k=\sum_{j=1}^p x_{kj}" class="tex" style="color: #000000; font-family: Arial, sans-serif; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 24px; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;" border="0" /> が成り立ちます。</li>
<li>Jaccard距離<br />
<img src="../images/Algorithm_(Hierarchical_Cluster_Analysis)/math-c8ba27ae461ab7e05dfd221d6f617dfe.png" title="d_{ik}=\frac{\sum_{j=1}^p ( (x_{ij} \ne x_{kj}) \bigcap (x_{ij} \ne 0 \bigcup x_{kj} \ne 0) )&#160;? 1:0 }{\sum_{j=1}^p (x_{ij} \ne 0 \bigcup x_{kj} \ne 0) )&#160;? 1:0}" alt="d_{ik}=\frac{\sum_{j=1}^p ( (x_{ij} \ne x_{kj}) \bigcap (x_{ij} \ne 0 \bigcup x_{kj} \ne 0) )&#160;? 1:0 }{\sum_{j=1}^p (x_{ij} \ne 0 \bigcup x_{kj} \ne 0) )&#160;? 1:0}" class="tex" style="color: #000000; font-family: Arial, sans-serif; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 24px; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;" border="0" /></li>
</ol>
</li>
</ul>
<a name="Cluster_Variables" id="Cluster_Variables"></a>
<h3><span class="mw-headline">クラスター変数</span></h3>
<p>Originはクラスター変数で2つの距離タイプをサポートしています。観測値は共分散や係数を計算する２つの変数のうち、どちらか一方に欠損値がある場合は除かれます。</p>
<ul>
<li>距離タイプ<br />
は<i>ｎ</i>個の観測データと<i>ｐ</i>変数を使った行列<img src="../images/Algorithm_(Hierarchical_Cluster_Analysis)/math-61b39f8b9a10e8428d4a1ee092fe90cd.png" title="x_{ij}\ " alt="x_{ij}\ " class="tex" style="color: #000000; font-family: Arial, sans-serif; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 24px; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;" border="0" />で、<i>i</i>番目の変数と<i>ｋ</i>番目の変数は次のように表わされています。
<ol>
<li>相関関係<br />
<img src="../images/Algorithm_(Hierarchical_Cluster_Analysis)/math-1fb6205bac10ad6d294c90cb9837e9c5.png" title="d_{jk}=1-\mathrm{corr}(x_j, x_k)\ " alt="d_{jk}=1-\mathrm{corr}(x_j, x_k)\ " class="tex" style="color: #000000; font-family: Arial, sans-serif; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 24px; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;" border="0" />　<span class="Apple-converted-space">&#160;</span><img src="../images/Algorithm_(Hierarchical_Cluster_Analysis)/math-c3683cdadf1e9d4e33ea12a052c0f174.png" title="\mathrm{corr}(x_j, x_k)\ " alt="\mathrm{corr}(x_j, x_k)\ " class="tex" style="color: #000000; font-family: Arial, sans-serif; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 24px; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;" border="0" /> は<i>ｊ</i>番目の変数と<i>ｋ</i>番目の変数の相関関係を示しています。</li>
<li>Absolute correlation(絶対相関)<br />
<img src="../images/Algorithm_(Hierarchical_Cluster_Analysis)/math-51b38858ea57d12c43210595a9d3661f.png" title="d_{jk}=1-|\mathrm{corr}(x_j, x_k)|\ " alt="d_{jk}=1-|\mathrm{corr}(x_j, x_k)|\ " class="tex" style="color: #000000; font-family: Arial, sans-serif; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 24px; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;" border="0" /></li>
</ol>
</li>
</ul>
<a name="Linkage_Method" id="Linkage_Method"></a>
<h2><span class="mw-headline">結合法</span></h2>
<p>各ステージで、最も近しい2つのクラスターは統合されます。Originはいくつかの手法を用いて新規クラスターと他のクラスター間の距離を計算しています。クラスター<i>ｊ</i>と<i>ｋ</i>を統合してクラスター<i>jk</i>とします。<img src="../images/Algorithm_(Hierarchical_Cluster_Analysis)/math-4977ea7b014aa7a99a12a7a0c45b76f6.png" title="n_i\ " alt="n_i\ " class="tex" style="color: #000000; font-family: Arial, sans-serif; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 19.2px; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;" border="0" />、 <span class="Apple-converted-space">&#160;</span><img src="../images/Algorithm_(Hierarchical_Cluster_Analysis)/math-f898efd8ac64b6621a2aeed350ce3164.png" title="n_j\ " alt="n_j\ " class="tex" style="color: #000000; font-family: Arial, sans-serif; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 19.2px; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;" border="0" /> 、 <span class="Apple-converted-space">&#160;</span><img src="../images/Algorithm_(Hierarchical_Cluster_Analysis)/math-fd91d2523217931bfcd6f684555f4d7f.png" title="n_k\ " alt="n_k\ " class="tex" style="color: #000000; font-family: Arial, sans-serif; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 19.2px; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;" border="0" /> &#160;を順にクラスター<i>i</i>、クラスター<i>ｊ</i>そしてクラスター<i>ｋ</i>のオブジェクト数とし、<img src="../images/Algorithm_(Hierarchical_Cluster_Analysis)/math-2a81a0fc16ebf02e971257997dafa28b.png" title="d_{ij}\ " alt="d_{ij}\ " class="tex" style="color: #000000; font-family: Arial, sans-serif; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 19.2px; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;" border="0" />、<img src="../images/Algorithm_(Hierarchical_Cluster_Analysis)/math-c198e05d8ed1e6f1af582129382f6495.png" title="d_{ik}\ " alt="d_{ik}\ " class="tex" style="color: #000000; font-family: Arial, sans-serif; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 19.2px; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;" border="0" />、<span class="Apple-converted-space">&#160;</span><img src="../images/Algorithm_(Hierarchical_Cluster_Analysis)/math-e2ed69879e29cc9517eb1a1f2ecab0cb.png" title="d_{jk}\ " alt="d_{jk}\ " class="tex" style="color: #000000; font-family: Arial, sans-serif; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 19.2px; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;" border="0" /> を2つのクラスター間の距離とします。するとクラスター<i>jk</i>とクラスター<i>i</i><img src="../images/Algorithm_(Hierarchical_Cluster_Analysis)/math-a473b8369dd26440ac973f3cf3de62ed.png" title="d_{i,jk}\ " alt="d_{i,jk}\ " class="tex" style="color: #000000; font-family: Arial, sans-serif; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 19.2px; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;" border="0" /> の距離 は次のように計算されます。</p>
<ol>
<li>単一結合または最短距離<br />
<img src="../images/Algorithm_(Hierarchical_Cluster_Analysis)/math-1decc6265d2731648206786ae0cc44e7.png" title="d_{i,jk}=\mathrm{min}(d_{ij},d_{ik})\ " alt="d_{i,jk}=\mathrm{min}(d_{ij},d_{ik})\ " class="tex" style="color: #000000; font-family: Arial, sans-serif; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 24px; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;" border="0" /></li>
<li>完全結合または最長距離<br />
<img src="../images/Algorithm_(Hierarchical_Cluster_Analysis)/math-88af2544aa89b6c5eb3bd10fbfc65fac.png" title="d_{i,jk}=\mathrm{max}(d_{ij},d_{ik})\ " alt="d_{i,jk}=\mathrm{max}(d_{ij},d_{ik})\ " class="tex" style="color: #000000; font-family: Arial, sans-serif; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 24px; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;" border="0" /></li>
<li>群平均<br />
<img src="../images/Algorithm_(Hierarchical_Cluster_Analysis)/math-a117d8802250e31ee98a59d789fb3728.png" title="d_{i,jk}=\frac{n_j}{n_j+n_k}d_{ij}+\frac{n_k}{n_j+n_k}d_{ik}\ " alt="d_{i,jk}=\frac{n_j}{n_j+n_k}d_{ij}+\frac{n_k}{n_j+n_k}d_{ik}\ " class="tex" style="color: #000000; font-family: Arial, sans-serif; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 24px; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;" border="0" /></li>
<li>重心<br />
<img src="../images/Algorithm_(Hierarchical_Cluster_Analysis)/math-a1e87a55511ee73bf5adfe0699ff3114.png" title="d_{i,jk}=\frac{n_j}{n_j+n_k}d_{ij}+\frac{n_k}{n_j+n_k}d_{ik}-\frac{n_jn_k}{(n_j+n_k)^2}d_{jk}\ " alt="d_{i,jk}=\frac{n_j}{n_j+n_k}d_{ij}+\frac{n_k}{n_j+n_k}d_{ik}-\frac{n_jn_k}{(n_j+n_k)^2}d_{jk}\ " class="tex" style="color: #000000; font-family: Arial, sans-serif; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 24px; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;" border="0" /></li>
<li>メディアン<br />
<img src="../images/Algorithm_(Hierarchical_Cluster_Analysis)/math-f7defcfc31776fe2c1319c4424b56a88.png" title="d_{i,jk}=\frac{1}{2}d_{ij}+\frac{1}{2}d_{ik}-\frac{1}{4}d_{jk}\ " alt="d_{i,jk}=\frac{1}{2}d_{ij}+\frac{1}{2}d_{ik}-\frac{1}{4}d_{jk}\ " class="tex" style="color: #000000; font-family: Arial, sans-serif; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 24px; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;" border="0" /></li>
<li>最低分散またはWard<br />
<img src="../images/Algorithm_(Hierarchical_Cluster_Analysis)/math-ebce4775175a80790a9f3ce946072790.png" title="d_{i,jk}=\frac{(n_i+n_j)d_{ij}+(n_i+n_k)d_{ik}-n_id_{jk}}{n_i+n_j+n_k}\ " alt="d_{i,jk}=\frac{(n_i+n_j)d_{ij}+(n_i+n_k)d_{ik}-n_id_{jk}}{n_i+n_j+n_k}\ " class="tex" style="color: #000000; font-family: Arial, sans-serif; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 24px; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;" border="0" /></li>
</ol>
<p>クラスター<i>ｊ</i>と<i>ｋ</i>で <i>j&lt;k</i> の場合、統合された新しいクラスターは<b>クラスター段階</b>表でクラスター<i>ｊ</i>として表記されます。</p>
<a name="Dendrogram" id="Dendrogram"></a>
<h2><span class="mw-headline">樹形図</span></h2>
<p><b style="font-weight: bold;">樹形図</b>は階層的な木のような図で、どの距離で2つのクラスターが統合するのかを表示しています。各段階は１つのユニットとして<b>樹形図</b>では示されています。各段階で一番上にあるユニットは2つのクラスターを統合したものを示しています。その高さは2つの統合したクラスター間の距離を示しています。</p>
<p><b style="font-weight: bold;">樹形図</b>の終点は<i>n</i>個のオブジェクトを表しています。<b>樹形図</b>内の<i>ｎ</i>個のオブジェクトは統合されたクラスターが隣り合うようにソートされています。<b>樹形図</b>の最初の終点は常に初めのオブジェクトを表しています。</p>
<a name="Group_Objects" id="Group_Objects"></a>
<h2><span class="mw-headline">グループオブジェクト</span></h2>
<p>特定された<i>ｋ</i>クラスターの<i>n</i>個のプロジェクトは<b>樹形図</b>または<b>クラスター段階</b>の情報によって判別できます。<i>ｋ</i>クラスターは<i>n-k</i>番目の段階にあり、これは各オブジェクトの所属は初めの<i>n-k</i>段階で知ることができます。そしてオブジェクト１は常にクラスター1に所属しています。</p>
<p>クラスター中心と観測データおよびクラスター間の距離はクラスター観測データのために計算されます。もし正規化が分析内で選択されていた場合、観測データは計算の中で正規化されます。</p>
