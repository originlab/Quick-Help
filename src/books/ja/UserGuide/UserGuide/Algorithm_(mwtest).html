<h1 class="firstheading">アルゴリズム (Mann-Whitney検定)</h1>
<p>2つの独立した標本<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(mwtest)/math-5b1801852159ba06309a26beab0a5c80.png" title="F(x)\," alt="F(x)\," class="tex" border="0" /></span>と<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(mwtest)/math-9756a2e5b64bdcdf316280aa3e4ec826.png" title="G(y)\," alt="G(y)\," class="tex" border="0" /></span>について、サンプルサイズが <span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(mwtest)/math-8d88a43872d6db6535d8672a15f09ce2.png" title="n_1\,\!" alt="n_1\,\!" class="tex" border="0" /></span> および <span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(mwtest)/math-ede03c8aef1b07c898c7747b489fd765.png" title="n_2\,\! " alt="n_2\,\! " class="tex" border="0" /></span>であると考えます。サンプルデータはそれぞれ <span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(mwtest)/math-d79752c45b6e0288c460390908ff4157.png" title="x_1,x_2,\ldots ,x_{n_1}\,\!" alt="x_1,x_2,\ldots ,x_{n_1}\,\!" class="tex" border="0" /></span> および <span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(mwtest)/math-ba3bf26bc53cf72dd2f7e804e8351ba7.png" title="y_1,y_2,\ldots ,y_{n_1}\,\!" alt="y_1,y_2,\ldots ,y_{n_1}\,\!" class="tex" border="0" /></span> と表します。</p>
<p>帰無仮説 :<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(mwtest)/math-f60cc190b9efdc1a8dd50689509520e4.png" title="H_0: F(x) = G(y)\," alt="H_0: F(x) = G(y)\," class="tex" border="0" /></span>と表し、2つの分布は同じです。これは対立仮説<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(mwtest)/math-7cd11b458088b7785f332b5101ecd466.png" title="H_1\," alt="H_1\," class="tex" border="0" /></span> に対して検定が実行されます。内容としては、</p>
<dl>
<dd><img src="../images/Algorithm_(mwtest)/math-442de29a07a0a1d2b14c2d251be35c0b.png" title="H_1: F(x) \neq G(y)\," alt="H_1: F(x) \neq G(y)\," class="tex" border="0" />;または</dd>
</dl>
<dl>
<dd><img src="../images/Algorithm_(mwtest)/math-6b206a28e60f665e235f89f460448467.png" title="x\," alt="x\," class="tex" border="0" />の傾向が<img src="../images/Algorithm_(mwtest)/math-ec9ff0a12771e750c2685d3b89a37c79.png" title="y\," alt="y\," class="tex" border="0" />よりも大きくなる場合、<img src="../images/Algorithm_(mwtest)/math-96afea18e20fea6dbe701b05689c166d.png" title="H_1: F(x) &lt; G(y)\,\!" alt="H_1: F(x) &lt; G(y)\,\!" class="tex" border="0" />;または</dd>
</dl>
<dl>
<dd><img src="../images/Algorithm_(mwtest)/math-6b206a28e60f665e235f89f460448467.png" title="x\," alt="x\," class="tex" border="0" />の傾向が<img src="../images/Algorithm_(mwtest)/math-ec9ff0a12771e750c2685d3b89a37c79.png" title="y\," alt="y\," class="tex" border="0" />よりも小さくなる場合、<img src="../images/Algorithm_(mwtest)/math-dd4112d1dfe28bb3868d87af588e6c1c.png" title="H_1: F(x) &gt; G(y)\,\!" alt="H_1: F(x) &gt; G(y)\,\!" class="tex" border="0" /></dd>
</dl>
<p>検定手順は以下のステップのようになります。</p>
<ul>
<li><img src="../images/Algorithm_(mwtest)/math-312ce869e8967ee6fff1453ef5e28c4c.png" title=" x_i \,\!" alt=" x_i \,\!" class="tex" border="0" />と <img src="../images/Algorithm_(mwtest)/math-015fcddf5978e5b63ac9135bd7bdae23.png" title=" y_i\,\!" alt=" y_i\,\!" class="tex" border="0" /> を1つのグループに組み合わせます。</li>
<li>それらを昇順で順位付けします。同順位のものは、それらの順位の平均を受け取ります。<img src="../images/Algorithm_(mwtest)/math-56a7a6ec92f118977b8523a962828446.png" title="r_{1i}\,\!" alt="r_{1i}\,\!" class="tex" border="0" />を <img src="../images/Algorithm_(mwtest)/math-312ce869e8967ee6fff1453ef5e28c4c.png" title=" x_i \,\!" alt=" x_i \,\!" class="tex" border="0" />に割り当てられる順位(<img src="../images/Algorithm_(mwtest)/math-b57947ce6a9bae17d7506e4f7c01f818.png" title=" i=1,2,\ldots ,n_1" alt=" i=1,2,\ldots ,n_1" class="tex" border="0" /> において)と、 <img src="../images/Algorithm_(mwtest)/math-015fcddf5978e5b63ac9135bd7bdae23.png" title=" y_i\,\!" alt=" y_i\,\!" class="tex" border="0" />に割り当てられる順位( <img src="../images/Algorithm_(mwtest)/math-1dae3723ecc58382e25c7a34892865a5.png" title=" j=1,2,\ldots ,n_2" alt=" j=1,2,\ldots ,n_2" class="tex" border="0" />において)とします。</li>
<li>順位の合計を計算します。
<dl>
<dd><img src="../images/Algorithm_(mwtest)/math-e9f090c9bc2e4925efed578d5fc957d4.png" title=" S_1=\sum_{I=1}^{n_1}r_{1i}\,\!" alt=" S_1=\sum_{I=1}^{n_1}r_{1i}\,\!" class="tex" border="0" />, および <img src="../images/Algorithm_(mwtest)/math-443e369d22f03a15147ddce7585c5b22.png" title=" S_2=\sum_{I=1}^{n_2}r_{2j}\,\!" alt=" S_2=\sum_{I=1}^{n_2}r_{2j}\,\!" class="tex" border="0" />です。</dd>
</dl>
</li>
<li>検定する統計量 <img src="../images/Algorithm_(mwtest)/math-6f3d5ad4b0e22c80e2db450cf7238ea9.png" title="U\," alt="U\," class="tex" border="0" /> は次のように表すことができます。
<dl>
<dd><img src="../images/Algorithm_(mwtest)/math-42f3622e67a4b7662e78f6c155b8ec10.png" title=" U=S_1-\frac{n_1(n_1+1)}2\," alt=" U=S_1-\frac{n_1(n_1+1)}2\," class="tex" border="0" /></dd>
</dl>
</li>
<li>おおよその一般検定統計量 <img src="../images/Algorithm_(mwtest)/math-77698ae92ac0435f8da1e266eeb528e3.png" title="z\," alt="z\," class="tex" border="0" />は次のように計算されます。
<dl>
<dd><img src="../images/Algorithm_(mwtest)/math-2590c4a4b785dfcc8e3983885df66db6.png" title="z=\frac{U-M(U)\pm \frac 12}{\sqrt{Var(U)}} \," alt="z=\frac{U-M(U)\pm \frac 12}{\sqrt{Var(U)}} \," class="tex" border="0" /></dd>
</dl>
ここで
<dl>
<dd><img src="../images/Algorithm_(mwtest)/math-28ce0d26a8607fa489594ca9a1d7cc31.png" title="M(U)=\frac{n_1n_2}2 \," alt="M(U)=\frac{n_1n_2}2 \," class="tex" border="0" /></dd>
</dl>
および
<dl>
<dd><img src="../images/Algorithm_(mwtest)/math-ef94a3f17a70689ec4c0b3b8808715e6.png" title="Var(U)=\frac{n_1n_2(n_1+n_2+1)}{12}-\frac{n_1n_2}{(n_1+n_2)(n_1+n_2-1)}\times TS \," alt="Var(U)=\frac{n_1n_2(n_1+n_2+1)}{12}-\frac{n_1n_2}{(n_1+n_2)(n_1+n_2-1)}\times TS \," class="tex" border="0" /></dd>
</dl>
ここで
<dl>
<dd><img src="../images/Algorithm_(mwtest)/math-2318b3a335f87d5d4da6d984610d7fc9.png" title="TS=\sum_{j=1}^\tau \frac{(t_j)(t_j-1)(t_j+1)}{12}\," alt="TS=\sum_{j=1}^\tau \frac{(t_j)(t_j-1)(t_j+1)}{12}\," class="tex" border="0" />.</dd>
</dl>
<br />
<p><img src="../images/Algorithm_(mwtest)/math-877f2649839d34ed84de578db8e58a47.png" title=" \tau \," alt=" \tau \," class="tex" border="0" /> は、標本内で同順位の数で、<img src="../images/Algorithm_(mwtest)/math-df204135239c5bf5c4634a38c3b9b470.png" title=" t_j\," alt=" t_j\," class="tex" border="0" /> は、<i>j</i> 番目のグループの同順位数です。<br />
同順位が存在しない場合、 <img src="../images/Algorithm_(mwtest)/math-d48c86a2e46b00c5cd98ca6169fed589.png" title="U \," alt="U \," class="tex" border="0" /> の分散は<img src="../images/Algorithm_(mwtest)/math-5e07afd040fd2b8d17dca3a17cf6a170.png" title="\frac{n_1n_2(n_1+n_2+1)}{12}\," alt="\frac{n_1n_2(n_1+n_2+1)}{12}\," class="tex" border="0" />のようになります。</p>
</li>
</ul>
<p>&#160;</p>
<p>このアルゴリズムの詳細は、<b><a href="http://www.originlab.com/pdfs/nagcl09/manual/pdf/g08/g08amc.pdf" class="external text" title="http://www.originlab.com/pdfs/nagcl09/manual/pdf/g08/g08amc.pdf" rel="nofollow" target="_blank">nag_mann_whitney (g08amc)</a></b>をご覧下さい。</p>
<p><br /></p>
