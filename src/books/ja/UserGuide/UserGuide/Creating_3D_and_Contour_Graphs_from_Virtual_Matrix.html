<h1 class="firstheading">仮想行列から3Dおよび等高線グラフを作成する</h1><p class='urlname' style='display: none'>仮想行列-3D等高線をプロットする</p>
<div style="text-align: left; direction: ltr; margin-left: 1em;"><p><a  class="image"><img alt="Video Image.png" src="../images/Creating_3D_and_Contour_Graphs_from_Virtual_Matrix/Video_Image.png" width="33"  /></a> 関連する動画はこちら：<a class="external text" href="http://www.originlab.com/index.aspx?go=Products/Origin/DataManagement/WorkbooksAndWorksheets&amp;ss=chm&amp;pid=1721" target="_blank">Creating Intersecting Surfaces Plots from Worksheets and Setting Transparency</a>
</p></div>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#What_is_a_Virtual_Matrix.3F"><span class="tocnumber">1</span> <span class="toctext">仮想行列とは？</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Available_3D_and_Contour_Graph_Types_that_can_be_Created_from_Virtual_Matrices"><span class="tocnumber">2</span> <span class="toctext">仮想行列から作成できる3Dおよび等高線図</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#How_to_Create_3D_and_Contour_Graphs_from_a_Virtual_Matrix"><span class="tocnumber">3</span> <span class="toctext">仮想行列から３Dおよび等高線図を作成する</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Dialog_Controls_of_the_plotvm_Dialog"><span class="tocnumber">4</span> <span class="toctext"><i>plotvm</i> ダイアログの設定項目</span></a></li>
</ul>
</div>
<h2><a name="What_is_a_Virtual_Matrix.3F"></a><span class="mw-headline">仮想行列とは？</span></h2>
<p>Originで<b>等高線図</b>または<b>3D曲面図</b>を作成する場合、使用できる3つの基本的なデータ配置があります。<b>XYZ ワークシート列</b>、Z値の<b>行列</b>、そして<b>仮想行列</b>と呼ばれるものです。通常の行列とは異なり、仮想行列は、ソートされている限り、X値とY値の不等間隔をサポートします。
</p><p>仮想行列は通常、(1) ワークシートの上部に沿ってY座標値の行、(2) ワークシートの最初の列にX座標値の列 (または<i>その逆</i>) が配置されたワークシートから始まります。そして、全てのX・Y座標のペアの交点によって定義されるブロック内の「Z」値の2D配列となります。 
</p><p>XまたはY座標値は、ワークシートのデータ部分の最初の行または列にある場合があります。ワークシートの列ラベル行領域に格納できます。もしくは、インタラクティブな<b>X範囲</b>または<b>Y範囲</b>選択コントロールなどを使用して定義したワークシートの別の部分にある場合もあります。
</p>
<dl><dd><a  class="image"><img alt="VM Worksheet Small.png" src="../images/Creating_3D_and_Contour_Graphs_from_Virtual_Matrix/400px-VM_Worksheet_Small.png" width="400"   /></a></dd></dl>
<p><br />
MS Excelからデータをインポートした場合や、装置で生成されたASCIIファイルをインポートしたとき、データの配置が上記のワークシートに類似している場合、仮想行列の作成に使用できる形式になっている可能性があります。
</p>
<ul><li> <b>データフォーマット</b>: 列と交差するY/行と交差するX</li>
<li> <b>X値</b>/<b>Y値</b>は、<b>選択中の第1行</b>または<b>選択中の第1列</b>、<b>列ラベル</b>または<b>インタラクティブな範囲選択</b>があります。</li></ul>
<dl><dd><a  class="image"><img alt="Data selection virtual matrix-vNext.png" src="../images/Creating_3D_and_Contour_Graphs_from_Virtual_Matrix/Data_selection_virtual_matrix.png" width="837"  /></a></dd></dl>
<h2><a name="Available_3D_and_Contour_Graph_Types_that_can_be_Created_from_Virtual_Matrices"></a><span class="mw-headline">仮想行列から作成できる3D等高線図のタイプ</span></h2>
<p>仮想行列から以下のようなグラフを作成できます。
</p>
<ul><li> 3D色付き曲面図</li>
<li> 3D等間隔X曲面図</li>
<li> 3D等間隔Y曲面図</li>
<li> 3Dカラーマップ曲面（および投影図付きのカラーマップ曲面図）</li>
<li> グレースケール3D散布図</li>
<li> 3Dワイヤーフレーム</li>
<li> 3Dワイヤー曲面</li>
<li> XYY3D棒グラフ</li>
<li> 色付き等高線</li>
<li> 等高線：線＋ラベル</li>
<li> ヒートマップ</li></ul>
<h2><a name="How_to_Create_3D_and_Contour_Graphs_from_a_Virtual_Matrix"></a><span class="mw-headline">仮想行列から3Dおよび等高線グラフを作成する</span></h2>
<p>仮想行列から等高線図や3Dグラフを作成するには、
</p>
<ol><li> ワークシートまたはワークシートのセルの範囲を選択し、<b>作図</b>メニューをクリックして<a href="#Available_3D_and_Contour_Graph_Types_that_can_be_Created_from_Virtual_Matrices">3Dグラフタイプを選択</a>します。</li>
<li> 開かれた<a href="#Dialog_Controls_of_the_plotvm_Dialog"><b>plotvmダイアログ</b></a>で、仮想行列に変換するときにワークシートデータをどのように処理するかを指定します。</li></ol>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Creating_3D_and_Contour_Graphs_from_Virtual_Matrix/Tip_icon.png" width="57"  border="0" /></td><td><p>仮想行列から 3D グラフを作成する手順については、<a class="external text" href="../../Tutorial/Tutorial/Creating_Intersecting_Surface_Plots_from_Worksheets.html">交差した曲面図の作成</a>のチュートリアルを参照してください。
</p></td></tr></table>
<h2><a name="Dialog_Controls_of_the_plotvm_Dialog"></a><span class="mw-headline"><i>plotvm</i> ダイアログの設定項目</span></h2>
<table class="dialogcontroltable">
<tr>
<th><b>入力</b>
</th>
<td>3Dグラフか等高線図のZ値を決定します。フライアウトメニューまたは仮想行列マネージャから、既存の仮想行列を入力として選択できます。
<p><b>Note</b>: ワークシート全体をデータとして選択すると、仮想行列はワークシート内のデータが変更されたとき、自動的に更新が行われます。ワークシートの特定のセルから最後の行・列までを選択して、仮想行列を更新したい場合は、<b>入力</b>の右の三角形のボタンを右クリックし、<b>Dynamic Ends</b>を選択します。 
</p>
</td></tr>
<tr>
<th>データフォーマット
</th>
<td>X値およびY値をセットする方法を指定します。  以下のオプションを利用できます。
<ul><li><b>列と交差するY</b> 
<dl><dd>Y軸の値を行として、X軸の値を列として利用します。 </dd></dl></li>
<li><b>行と交差するX</b> 
<dl><dd>X軸の値を行として、Y軸の値を列として利用します。 </dd></dl></li></ul>
</td></tr>
<tr>
<th>X値/Y値
</th>
<td>2つのドロップダウンリストを使用して、仮想行列を作成するときにXとYのデータ範囲を指定します。これら2つの順序は、<b>データフォーマット</b>の選択によって動的に変化し、上が行の指定に使用され、下が列の指定に使用されます。以下が、利用可能なオプションです。
<ul><li><b>なし</b>
<dl><dd> 行あるいは列のインデックスを使用します。 </dd></dl></li>
<li><b>選択中の第1行/列</b>
<dl><dd> 選択範囲の最初の行/列の値を使用します。</dd></dl></li>
<li><b>ワークシート中の第1行/列</b>
<dl><dd> 現在のワークシートの最初の行/列の値を使用します。 </dd></dl></li>
<li><b>列ラベル</b>
<dl><dd> これは、行が指定されている時に利用可能です。ワークシート内の列ラベルの値を使用します。これで、<b>列ラベル</b>のドロップダウンリストから列ラベルを選択できるようになります。ワークシートの範囲が<b>入力</b>データとして選択されている場合、このツールは自動的に列ラベルの対応する部分を使用します。 </dd></dl></li>
<li><b>カスタム</b>
<dl><dd> <b>X範囲</b> (または<b>Y範囲</b>)のデータを手動で選択するオプションを利用します。XまたはY軸は必ず同一のワークシートから指定しなければなりません。 </dd></dl></li></ul>
</td></tr>
<tr>
<th><b>Yのフォーマット</b>/<b>Xのフォーマット</b>
</th>
<td>Y/Xのデータのフォーマットを、<b>数値</b>(デフォルト)、<b>テキスト</b>、<b>時間</b>、<b>日付</b>から選択します。これにチェックを付け、<b>...</b>ボタンをクリックすると<b>データフォーマット</b>ダイアログが開きます。Y/Xデータに対応する<b>フォーマット</b>と<b>表示</b>を適用します。
<p><b><b>Y値</b></b>/<b><b>X値</b></b>がなしに指定されていると、このチェックボックスは無効です。 
</p>
</td></tr>
<tr>
<th><b>Xタイトル</b> / <b>Yタイトル</b> / <b>Zタイトル</b>
</th>
<td>X、Y、Z軸の軸タイトルを指定します。  この欄の端にあるチェックボックスをオフにすると、矢印ボタンをクリックして、フライアウトリストからソースシート情報をタイトルとして選択できます。
<p>フライアウトリストから任意の項目を選択すると、<a class="external text" href="../../LabTalk/LabTalk/Syntax_and_notations_used_in_plot_label.html">対応表記</a>がボックスに挿入されます。実際のタイトルは、欄の下に青いヒントとして表示されます。
</p>
<ul><li> <b>LG: ロングネームと単位</b>: 選択すると %(%@H, 1, LG) 表記が挿入されます&nbsp;</li>
<li> <b>L: ロングネーム</b>: 選択すると %(%@H, 1, L) 表記が挿入されます</li>
<li> <b>U: 単位</b>: 選択すると %(%@H, 1, U) 表記が挿入されます</li>
<li> <b>C: コメント</b>: 選択すると %(%@H, 1, C) 表記が挿入されます</li>
<li> <b>P1: 第1パラメータ行</b>: 選択すると %(%@H, 1, P1) 表記が挿入されます</li>
<li> <b>D1: 第1ユーザパラメータ</b>: 選択すると %(%@H, 1, D1) 表記が挿入されます</li>
<li> <b>LH1: 第1ユーザパラメータ名</b>: 選択すると %(%@H, @LH1) 表記が挿入されます</li>
<li> <b>SN: シート名</b>: 選択すると %(%@H, @SN) 表記が挿入されます</li>
<li> <b>PNL: ブックロングネーム</b>: 選択すると %(%@H, @PNL) 表記が挿入されます</li>
<li> <b>ワークシートから選択</b>: これを選択するとダイアログが開き、ワークシート内のセルをクリックできるようになります。選択したセルの表記が表示されます。例えば、VMのソースシートのセル (1列目、3行目) を選択すると、表記は %(%@H, 1, 3); となります。ソースシートにないセルを選択すると、<a href="../../UserGuide/UserGuide/The_Insert_Info_Variables_Dialog_Box.html" title="ユーザガイド: 変数の挿入ダイアログボックス">変数の挿入ダイアログ</a>と同様に、%([Book1]Sheet1, 1, 3, W) が作成されます。</li></ul>
</td></tr>
<tr>
<th><b>仮想行列名 </b>
</th>
<td>作成される仮想行列オブジェクトのショートネームを指定します。作図中に作成された全ての仮想行列は、<a href="../../UserGuide/UserGuide/Managing_Virtual_Matrix.html" title="ユーザガイド：仮想行列の管理">仮想行列マネージャ</a>でリスト化され、管理されます。
</td></tr></table>


    