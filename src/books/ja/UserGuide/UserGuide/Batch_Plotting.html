<h1 class="firstheading">バッチ作図</h1><p class='urlname' style='display: none'>Graphing-Batch-Plotting</p>
<p><br />
Originでは、様々な方法でグラフの編集が行え、編集内容を他のデータセットで再度使用できます。 
</p>
<ul><li> カスタム設定は<a href="../../UserGuide/UserGuide/Graph_Template_Basics.html" title="ユーザガイド: グラフテンプレートの基本">グラフテンプレート</a>として保存できます。</li>
<li> 編集内容は<a href="../../UserGuide/UserGuide/Saving_a_Format_as_a_Theme.html" title="ユーザガイド：テーマとしてフォーマットを保存">グラフテーマ</a>として保存できます。 </li>
<li> グラフからフォーマットをコピーし、<a href="../../UserGuide/UserGuide/Copying_and_Pasting_Formats.html" title="ユーザーガイド: フォーマットのコピーと貼り付け">他のグラフに貼り付ける</a>ことができます。</li>
<li> ここで説明する、Originのバッチ作図または<b><b>ワークシートを変更</b></b>機能を使用できます。 </li></ul>
<p><b>グラフテンプレート</b>や<b>グラフテーマ</b>を使用する場合、事前に編集内容を保存したファイルが必要です。<b>フォーマットのコピー/貼り付け</b>と<b>バッチ作図</b>は、事前に保存されたファイルは必要ありません。  すべてがアプリケーションを持っていますが、バッチ作図は複数の列/シート/ブックデータを扱う場合に特に便利です。このセクションでは、同じ構造または、識別子が一致する列/シート/ブックをもつ、新しい列/シート/ブックでバッチ作図を行います。
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Supported_graph_types"><span class="tocnumber">1</span><span class="toctext">サポートしているグラフ形式</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Four_Cases_of_Batch_Plotting"><span class="tocnumber">2</span> <span class="toctext">バッチ作図の4つのケース</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Duplicate_with_new_books"><span class="tocnumber">2.1</span> <span class="toctext">新しいブックで複製</span></a>
<ul>
<li class="toclevel-3 tocsection-4"><a href="#Settings_for_matching_conditions"><span class="tocnumber">2.1.1</span><span class="toctext">一致条件の設定</span></a></li>
<li class="toclevel-3 tocsection-5"><a href="#List_the_matching_books"><span class="tocnumber">2.1.2</span><span class="toctext">一致したブックのリスト</span></a></li>
<li class="toclevel-3 tocsection-6"><a href="#Settings_for_result_graph"><span class="tocnumber">2.1.3</span><span class="toctext">結果グラフの設定</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-7"><a href="#Duplicate_with_new_sheets"><span class="tocnumber">2.2</span> <span class="toctext">新しいシートで複製</span></a>
<ul>
<li class="toclevel-3 tocsection-8"><a href="#Settings_for_matching_conditions_2"><span class="tocnumber">2.2.1</span><span class="toctext">一致条件の設定</span></a></li>
<li class="toclevel-3 tocsection-9"><a href="#List_the_matching_sheets"><span class="tocnumber">2.2.2</span><span class="toctext">一致したシートのリスト</span></a></li>
<li class="toclevel-3 tocsection-10"><a href="#Settings_for_result_graph_2"><span class="tocnumber">2.2.3</span><span class="toctext">結果グラフの設定</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-11"><a href="#Duplicate_with_new_columns"><span class="tocnumber">2.3</span><span class="toctext">新しい列で複製</span></a>
<ul>
<li class="toclevel-3 tocsection-12"><a href="#Settings_for_matching_conditions_3"><span class="tocnumber">2.3.1</span><span class="toctext">一致条件の設定</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-13"><a href="#Duplicate_with_column_offset"><span class="tocnumber">2.4</span> <span class="toctext">指定されたオフセット列で複製</span></a>
<ul>
<li class="toclevel-3 tocsection-14"><a href="#Settings_for_matching_conditions_4"><span class="tocnumber">2.4.1</span><span class="toctext">一致条件の設定</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<h2><a name="Supported_graph_types"></a><span class="mw-headline">サポートしているグラフ形式</span></h2>
<ul><li>バッチ作図は同じプロジェクトにある2Ｄ/3D/等高線グラフで同じデータソースタイプのものでのみ有効です。<br /><b>注記:</b> プロットメニューから作成されたほとんどのグループ化2Dグラフではグループ化情報列はデータ列ではなく修飾子列として扱われます。 </li>
<li>新しい列で複製する時、それぞれの列は<b><b>列のXY属性</b></b>の<b><b>Y</b></b>(2D)や<b><b>Z</b></b>(3D、等高線図) をもち、同一シート内にある必要があります。</li>
<li>新しいシートで複製する時、各シートは同じ列の構造を持つ必要があります。</li>
<li>新しいブックで複製する時、各ブックは同じシートと列の構造を持つ必要があります。</li></ul>
<h2><a name="Four_Cases_of_Batch_Plotting"></a><span class="mw-headline">Four Cases of Batch Plotting</span></h2>
<p><span class='headerInParagraph'>
バッチ作図のツールを開く方法</span>
</p>
<ul><li> グラフのタイトルバーか、グラフレイヤ枠の空白部分を右クリックして、<b>バッチ作図…</b>を選択します。</li></ul>
<dl><dd><a  class="image"><img alt="Dialog Batch Plotting 01.png" src="../images/Batch_Plotting/Dialog_Batch_Plotting_01.png" width="511"  /></a></dd></dl>
<p><b>バッチ作図するデータ</b>ドロップダウンリストで現在のグラフを複製するソースデータを以下より選択します。
</p>
<ul><li> <a href="#Duplicate_with_new_books">ワークブック/行列ブックから</a></li>
<li> <a href="#Duplicate_with_new_sheets">ワークシート/行列シートから</a></li>
<li> <a href="#Duplicate_with_new_columns"><b>ワークシート列から</b></a></li>
<li> <a href="#Duplicate_with_column_offset">列オフセットから</a></li></ul>
<p><b>バッチ作図するデータ</b>で<b>ブック/シート/列</b>を選択したら、利用可能なブック/シート/列がダイアログの中央部分に一覧表示されます。
</p>
<h3><a name="Duplicate_with_new_books"></a><span class="mw-headline">新しいブックで複製</span></h3>
<p>グラフ内の全プロットが1つのブックから作成されている場合、バッチ作図機能を使用して他のブックを使って同じグラフを複製できます。この時、<b>バッチ作図するデータ</b>で<b>ブック</b>を選択します。すると、バッチ作図ダイアログのタイトルバーに、<b>ワークブックを選択</b>と表示されます。
</p>
<dl><dd><a  class="image"><img alt="Dialog Batch Plotting.png" src="../images/Batch_Plotting/Dialog_Batch_Plotting.png" width="524"  /></a></dd></dl>
<h5><a name="Settings_for_matching_conditions"></a><span class="mw-headline">一致条件の設定</span></h5>
<table class="dialogcontroltable">
<tr>
<th> 正確
</th>
<td> 選択すると（デフォルト）、アクティブグラフと同様のシートと列の構造であるブックのみを一覧表示します。ブックに追加のシートまたは列（特定のシート内）が含まれている場合、グラフのクローンを作成するときにそれらは無視されます。アクティブなグラフを作成するために必要なシートよりもブックに含まれるシートが少ない場合、そのブックはリストされません。<br /><br /><b>正確</b>を外すと、設定による<b>プロット列の一致条件</b>によっては、シート数が最小で、アクティブなグラフの作成に必要な列数より少ないブックが表示される場合があります（次の項目を参照）。
</td></tr>
<tr>
<th> プロット列/シートの一致条件
</th>
<td> <b>プロット列の一致条件</b>フィルタで<b><b>ロングネーム</b></b><b>、<b>ショートネーム</b>、<b><b>列インデックス</b></b></b>と、<b>シートの一致条件</b>フィルタで、<b><b>ロングネーム</b></b><b>、<b>ショートネーム</b>、<b>列インデックス</b></b>を選択すると、同じ構造があるワークブックに、バッチ作図を実行できます。
</td></tr>
<tr>
<th>次の修飾語句で一致
</th>
<td>選択したワークブックでバッチ処理を実行する際、このリストを使って、どの様に修飾語句(プロットの編集に使う値のワークブックシート列-例えば、プロットの色）を一致させるかを指定します。デフォルトで、<b>作図の詳細</b>ダイアログの<b>その他のオプション</b>タブにある<a href="../../UserGuide/UserGuide/The_(Plot_Details)_Miscellaneous_Tab.html#Match_Modifier_by_.28for_template_and_copy_format.29" title="ユーザガイド:(作図の詳細)その他のオプションタブ"><b>一致条件</b></a>の設定が選択されています。もちろん、ご自身の設定もご利用いただけます。
</td></tr></table>
<h5><a name="List_the_matching_books"></a><span class="mw-headline">一致したブックのリスト</span></h5>
<p>最初の部分のフィルター条件に従って、プロジェクト内の一致するブックが中央のボックスに一覧表示されます。1つまたは複数のブックのデータセットを選択して、バッチ作図を実行できます。
</p>
<h5><a name="Settings_for_result_graph"></a><span class="mw-headline">結果グラフの設定</span></h5>
<table class="dialogcontroltable">
<tr>
<th>軸の再スケール
</th>
<td>このチェックボックスは、デフォルトで選択されています。入力データの変更による軸再スケールが不要な場合、チェックを外します。
</td></tr>
<tr>
<th>カラーマップがある場合再スケール
</th>
<td>このチェックボックスは、デフォルトで選択されています。入力データの変更によるカラーマップの再スケールが不要な場合、チェックを外します。
</td></tr>
<tr>
<th> 選択データの作図方法
</th>
<td> このリストは選択されたブックが作図される場所の指定に使用されます。このオプションを使用して以下が可能です。
<dl><dd><ul><li> 選択されたブックをアクティブグラフにプロット </li>
<li> 各選択を個々のグラフにプロット </li>
<li> 選択されたブックを新しい1つのグラフにプロット </li></ul></dd></dl>
</td></tr>
<tr>
<th> グラフのショートネーム
</th>
<td> この編集ボックスは、複製されたグラフのショートネームを定義するのに使用します。
<dl><dd><ul><li> デフォルトの&lt;auto&gt;の場合、グラフ<i>n</i> が複製グラフのショートネームになります。なお、 <i>n</i> は、グラフウィンドウの番号です。 </li>
<li> フォーマットの文字列/Labtalkスクリプトを入力することが可能で、必要に応じて、複数表記と任意の固定文字を結びつけることができます。編集ボックスの右にあるボタン<a  class="image"><img alt="Triangle button 01.png" src="../images/Batch_Plotting/Triangle_button_01.png" width="26"  /></a>にて、いくつかの<a class="external text" href="../../LabTalk/LabTalk/Text_Label_Options.html">よく使用される表記</a>やシンタックス例を作ることが出来ます。 </li></ul></dd></dl>
</td></tr>
<tr>
<th> グラフのロングネーム
</th>
<td> この編集ボックスは複製されたグラフのロングネームを定義するのに使用します。
<dl><dd><ul><li> デフォルトの&lt;auto&gt;では、元のワークブックとシート名に「コピー」を付けてたものをロングネームとして設定します。</li>
<li> フォーマットの文字列/Labtalkスクリプトを入力することが可能で、必要に応じて、複数表記と任意の固定文字を結びつけることができます。編集ボックスの右にあるボタン<a  class="image"><img alt="Triangle button 01.png" src="../images/Batch_Plotting/Triangle_button_01.png" width="26"  /></a>にて、いくつかの<a class="external text" href="../../LabTalk/LabTalk/Text_Label_Options.html">よく使用される表記</a>やシンタックス例を作ることが出来ます。 </li></ul></dd></dl>
</td></tr></table>
<p><br />
</p>
<h3><a name="Duplicate_with_new_sheets"></a><span class="mw-headline">新しいシートで複製</span></h3>
<p>グラフ内の全プロットが1つのシートから作成されている場合、バッチ作図機能を使用して他のシートを使って同じグラフを複製できます。この時、<b>バッチ作図するデータ</b>で<b>シート</b>を選択します。  すると、バッチ作図ダイアログのタイトルバーに、<b>ワークブックを選択</b>と表示されます。
</p>
<dl><dd><a  class="image"><img alt="Dialog Batch Plotting Sheet.png" src="../images/Batch_Plotting/Dialog_Batch_Plotting_Sheet.png" width="524"  /></a></dd></dl>
<h5><a name="Settings_for_matching_conditions_2"></a><span class="mw-headline">一致条件の設定</span></h5>
<table class="dialogcontroltable">
<tr>
<th> 正確
</th>
<td> 選択すると（デフォルト）、アクティブなグラフのような列の構造であるシートのみを一覧表示します。シートに追加の列が含まれている場合、グラフのクローンを作成するときにそれらは無視されます。アクティブなグラフを作成するために必要な列よりもシートに含まれる列が少ない場合、そのシートはリストされません。<br /><br /><b>正確</b>を外すと、設定による<b>プロット列の一致条件</b>によっては、アクティブなグラフの作成に必要な列数より少ないシートが表示される場合があります（次の項目を参照）。これは、<b>アクティブグラフ</b>に新しいプロットを追加する1つの方法であることに注意してください（<b>選択データの作図方法</b>を参照）。
</td></tr>
<tr>
<th> プロット列の一致条件
</th>
<td> フィルタの種類として<b><b>ロングネーム</b></b><b>、<b>ショートネーム</b>、<b>列インデックス</b></b>から選択でき、元となるワークシートと同じ<b><b>ロングネーム</b></b><b>、<b>ショートネーム</b>、<b>列インデックス</b></b>構造があるワークシートに適用できます。
</td></tr>
<tr>
<th>一致条件
</th>
<td>選択したワークシートでバッチ処理を実行する際、このリストを使って、どの様に修飾語句(プロットの編集に使う値のワークブックシート列　-　例えば、プロットの色）を一致させるかを指定します。デフォルトで、<b>作図の詳細</b>ダイアログの<b>その他のオプション</b>タブにある<a href="../../UserGuide/UserGuide/The_(Plot_Details)_Miscellaneous_Tab.html#Match_Modifier_by_.28for_template_and_copy_format.29" title="ユーザガイド:(作図の詳細)その他のオプションタブ"><b>一致条件</b></a>の設定が選択されています。もちろん、ご自身の設定もご利用いただけます。
</td></tr></table>
<h5><a name="List_the_matching_sheets"></a><span class="mw-headline">一致したシートのリスト</span></h5>
<p>最初の一致条件によってプロジェクト内の条件が一致したシートが中央のボックスに一覧表示されます。1つまたは複数のシートのデータセットを選択して、バッチ作図を実行できます。
</p>
<h5><a name="Settings_for_result_graph_2"></a><span class="mw-headline">結果グラフの設定</span></h5>
<p>新しいブックで複製の<a href="../../UserGuide/UserGuide/Batch_Plotting.html#Settings_for_result_graph" title="ユーザガイド：バッチ作図"><b>結果グラフの設定</b></a>と同じオプションです。
</p>
<table class="note">
<tr>
<td><b>Note</b>： <a href="../../UserGuide/Category/Managing_Data_Plots_in_Layers.html#Changing_the_datasets_associated_with_a_plot" title="カテゴリ: レイヤ内のデータプロットの管理"><b>ワークシートを変更</b></a>は既存の2Dグラフを別のシート内のデータを使って再計算させる機能です<b><b>新しいシートでバッチ作図</b></b>と<b><b>ワークシートを変更</b></b>は全く同じ列の構造で、ショートネーム、列のXY属性、インデックス等を含む必要があります。<b><b>ワークシートを変更</b></b>は(右クリック後の)ショートカットメニューコマンドを使う事でレイヤ内で素早くデータプロットを変更できます。<b><b>ワークシートを変更</b></b>は複数レイヤの中でもひとつひとつのプロットを作図する事が可能です。この機能はグループ化していないプロットで有効です。複数プロット<i>が</i>グループ化されている場合、1度クリックして一時停止し、2回クリックするとこの機能が使用可能になります。（このモードではプロットグループ全体ではなく1つのプロットのみを置き換えることに注意してください）
</td></tr></table>
<p><br />
</p>
<h3><a name="Duplicate_with_new_columns"></a><span class="mw-headline">新しい列で複製</span></h3>
<p>プロットがワークシートのY/Z列から作成されている場合、同じシート内の他のY/Z列を使用してプロットを複製できます。この時、<b>バッチ作図するデータ</b>で<b>列</b>を選択します。  すると、バッチ作図ダイアログのタイトルバーに、<b>列を選択</b>と表示されます。 <br />
</p>
<dl><dd><a  class="image"><img alt="Dialog Batch Plotting Column.png" src="../images/Batch_Plotting/Dialog_Batch_Plotting_Column.png" width="524"  /></a></dd></dl>
<h5><a name="Settings_for_matching_conditions_3"></a><span class="mw-headline">一致条件の設定</span></h5>
<table class="dialogcontroltable">
<tr>
<th> 関連するXを使用/関連するXとYを使用
</th>
<td> これはデフォルトでチェックされ、新しいプロットが<a href="../../UserGuide/UserGuide/Set_Column_Designation.html" title="ユーザーガイド：列属性の設定">選択されたY列に対応するX列</a>を使用してプロットされます。このボックスのチェックを外すと、新規のプロットは 、複製されるプロットのX または X&amp;Y 列を使用します。
</td></tr>
<tr>
<th>次の修飾語句で一致
</th>
<td>選択した列でバッチ作図するときに、このチェックボックスとドロップダウンリストを使って、一致条件を指定します。（列はプロットの色やプロット属性をコントロールします。）デフォルトで、<b>作図の詳細</b>ダイアログの<b>その他のオプション</b>タブにある<a href="../../UserGuide/UserGuide/The_(Plot_Details)_Miscellaneous_Tab.html#Match_Modifier_by_.28for_template_and_copy_format.29" title="ユーザガイド:(作図の詳細)その他のオプションタブ"><b>一致条件</b></a>の設定が選択されています。
<p>バッチ処理の場合、選択したプロット列から始まっている同じ列のオフセットで、列を編集するオプションには、<i>&lt;オフセット&gt;</i> を選択することを推奨します。これは、選択している列ラベルが、常にプロット属性を現在のワークシートの最初の列にしているためです。
</p>
</td></tr></table>
<h3><a name="Duplicate_with_column_offset"></a><span class="mw-headline">指定されたオフセット列で複製</span></h3>
<p>プロットがワークシートのY/Z列から作成されている場合、同じシート内の他のY/Z列を使用してプロットを複製できます。この時、<b>バッチ作図するデータ</b>で<b>列オフセット</b>を選択します。  すると、バッチ作図ダイアログのタイトルバーに、<b>列オフセットを設定</b>と表示されます。 <br />
</p>
<dl><dd><a  class="image"><img alt="Dialog Batch Plotting ColumnOffset.png" src="../images/Batch_Plotting/Dialog_Batch_Plotting_ColumnOffset.png" width="524"  /></a></dd></dl>
<h4><a name="Settings_for_matching_conditions_4"></a><span class="mw-headline">一致条件の設定</span></h4>
<table class="dialogcontroltable">
<tr>
<th> 列オフセット
</th>
<td> ソースグラフで使用される列から何列オフセットするか指定して、バッチ作図をします。例えば、ソースグラフのYデータがD・E列の散布図がある場合、<b>列オフセット</b> = <i>+2</i>は、新しいプロット列が列F・Gであることを意味し、<b>列オフセット</b> = <i>-2</i>は、新しいプロット列が列B・Cであることを意味します。
</td></tr>
<tr>
<th> オフセットの数
</th>
<td> バッチ作図を何回行うのか指定します。デフォルトでは、バッチ作図を最大何回実行するかを計算するために<b>自動</b>がチェックされています。
<p><b>自動</b>チェックボックスをオフにして、自動計算された値より小さい値を入力できます。例えば、ソースグラフのYデータがD・E列の散布図がある場合、<b>オフセットの数</b>を1に設定しなければ、以降の列でバッチ作図を繰り返すことを意味します。YデータがB・C列のソースグラフで<b>列オフセット</b> = <i>+ 2</i>および<b>オフセット数</b> = <i>3</i>に設定した場合、新しいプロットの列は列D・E、F・G、H・Iであることを意味します。
</p><p>このオプションの自動計算は以下のルールに従います。
</p>
<ul><li> <b>一致条件</b>が<i>&lt;オフセット&gt;</i>のとき、<b>オフセットの数</b>は識別子の列を考慮して、各コピーデータにその識別子の列が含まれるようにします。 </li>
<li> <b>関連するX</b>のチェックが入っておらず、<b>Ｘをオフセットで一致させる</b>が選択されている場合、<b>オフセットの数</b>はX列を考慮して、各データコピーにそのX列を含むようにします。</li></ul>
</td></tr>
<tr>
<th> 関連するXを使用/関連するXとYを使用
</th>
<td> これはデフォルトでチェックされ、新しいプロットが<a href="../../UserGuide/UserGuide/Set_Column_Designation.html" title="ユーザーガイド：列属性の設定">選択されたY列に対応するX列</a>を使用してプロットされます。このボックスのチェックを外すと、新規のプロットは 、複製されるプロットのX または X&amp;Y 列を使用します。
</td></tr>
<tr>
<th> Ｘをオフセットで一致させる
</th>
<td> このチェックボックスはデフォルトでグレーアウトしており、選択されていません。<b>関連するＸを使用</b>にチェックがない場合にのみ利用できます。チェックしない場合、元のグラフのＸを使用します。チェックした場合、オフセットを使用してＸを決定します。<b>関連するＸを使用</b> オプションと同様に、<b>Ｘをオフセットで一致させる</b>は、エラー、ラベル、Y (Z と一緒にプロット) 列に適用されます。
</td></tr>
<tr>
<th>一致条件
</th>
<td>選択した列でバッチ作図するときに、このチェックボックスとドロップダウンリストを使って、一致条件を指定します。（列はプロットの色やプロット属性をコントロールします。）デフォルトで、<b>作図の詳細</b>ダイアログの<b>その他のオプション</b>タブにある<a href="../../UserGuide/UserGuide/The_(Plot_Details)_Miscellaneous_Tab.html#Match_Modifier_by_.28for_template_and_copy_format.29" title="ユーザガイド:(作図の詳細)その他のオプションタブ"><b>一致条件</b></a>の設定が選択されています。
<p>この種類のバッチ作図では、<b>一致条件</b>がオフセットに設定されている場合、Originは同じ列オフセットを修飾子列に適用することに注意してください。 一致条件が他のものに設定されている場合、Originは現在の一致ルールを使用して修飾子を検索します。ほとんどの場合、それらはソースグラフと同じになります。
</p>
</td></tr></table>




    