<h1 class="firstheading">データフィルタ</h1><p class='urlname' style='display: none'>Wks-DataFilter</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">説明</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Status_of_Filter"><span class="tocnumber">1.1</span> <span class="toctext">フィルタの状態</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-3"><a href="#Add.2FRemove_Data_Filter"><span class="tocnumber">2</span><span class="toctext">データフィルタを追加または削除</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Enable.2FDisable_Data_Filter"><span class="tocnumber">3</span> <span class="toctext">データフィルタを有効にする/無効にする</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Reapply_Data_Filter"><span class="tocnumber">4</span><span class="toctext">データフィルタの再適用</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Copy_and_Paste_Data_Filter"><span class="tocnumber">5</span> <span class="toctext">シートのコピーと貼り付け</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Customize_Data_Filters"><span class="tocnumber">6</span><span class="toctext">データフィルタの編集</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Menu_Options_and_Dialog_Controls"><span class="tocnumber">7</span> <span class="toctext">メニューオプションとダイアログ操作</span></a>
<ul>
<li class="toclevel-2 tocsection-9"><a href="#Date_Filter"><span class="tocnumber">7.1</span> <span class="toctext">日付フィルタ</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Numeric_Filter"><span class="tocnumber">7.2</span> <span class="toctext">数値フィルタ</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Text_Filter"><span class="tocnumber">7.3</span> <span class="toctext">テキストフィルタ</span></a>
<ul>
<li class="toclevel-3 tocsection-12"><a href="#Custom_Filter_.28Simple_Text.29"><span class="tocnumber">7.3.1</span> <span class="toctext">カスタムフィルタ (シンプルなテキスト)</span></a></li>
<li class="toclevel-3 tocsection-13"><a href="#Custom_Filter_.28Advanced_Text.29"><span class="tocnumber">7.3.2</span> <span class="toctext">カスタムフィルタ (高度なテキスト)</span></a>
<ul>
<li class="toclevel-4 tocsection-14"><a href="#Specifying_your_Condition"><span class="tocnumber">7.3.2.1</span> <span class="toctext">条件を指定する</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-2 tocsection-15"><a href="#Custom_Data_Filter_dialog"><span class="tocnumber">7.4</span> <span class="toctext">カスタムデータフィルタダイアログ</span></a>
<ul>
<li class="toclevel-3 tocsection-16"><a href="#Custom_Data_Filter_Buttons"><span class="tocnumber">7.4.1</span> <span class="toctext">カスタムデータフィルタボタン</span></a></li>
<li class="toclevel-3 tocsection-17"><a href="#Filter_Menu"><span class="tocnumber">7.4.2</span> <span class="toctext">フィルタメニュー</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-18"><a href="#Ignore_Hidden_Rows"><span class="tocnumber">8</span> <span class="toctext">非表示行を無視する</span></a></li>
<li class="toclevel-1 tocsection-19"><a href="#Save_Data_Filter_into_Operation"><span class="tocnumber">9</span><span class="toctext">データフィルタを操作に保存する</span></a></li>
</ul>
</div>
<h2><a name="Description"></a><span class="mw-headline">説明</span></h2>
<dl><dd><a  class="image"><img alt="DataFilter.png" src="../images/Data_Filter/DataFilter.png" width="741"  /></a></dd></dl>
<p>Originは3つのデータ形式（日付/時間、数値、テキスト）でデータフィルタを用意しています。データフィルタは<b><b>ワークシートデータ</b></b>ツールバーにあるボタンをクリックして、データフィルタのデータの追加、削除、有効化、無効化、再適用、カスタムフィルタを使用できます。
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Data_Filter/Tip_icon.png" width="57"  border="0" /></td><td><p>列リストビュー（<b>表示：列リストビュー</b>）に切り替え、リストビュー列にフィルタを適用すれば、データフィルタを<a href="../../UserGuide/UserGuide/Displaying_Supporting_Data_in_Worksheet_header_Rows.html" title="ユーザガイド:ワークシートヘッダ行に表示するサポートデータ">列ラベル行</a>に適用することもできます。詳細は、<a href="../../UserGuide/UserGuide/Column_List_View.html#Applying_a_Data_Filter" title="ユーザガイド: 列リストビュー">列リストビュー のデータフィルタ適用</a>を参照してください。
</p></td></tr></table>
<h3><a name="Status_of_Filter"></a><span class="mw-headline">フィルタの状態</span></h3>
<p>列にフィルタを追加すると、列ヘッダのフィルタアイコンの色でフィルタの状態を確認できます。<br />
<a  class="image"><img alt="Data Filter 01.png" src="../images/Data_Filter/850px-Data_Filter_01.png" width="850"   /></a>
</p>
<h2><a name="Add.2FRemove_Data_Filter"></a><span class="mw-headline">データフィルタを追加または削除</span></h2>
<p>1つもしくはいくつかの列にデータフィルタを追加、削除
</p>
<ol><li>目的の列を選択します。</li>
<li><b>データフィルタの追加/削除</b>ボタン<a  class="image"><img alt="Button Add Remove Column Filter.png" src="../images/Data_Filter/Button_Add_Remove_Column_Filter.png" width="21"  /></a>をクリックします。</li></ol>
<p>データフィルタが追加されたときはデフォルトで空のフィルタになり、条件は何も設定されていません。いったんフィルタ条件が設定されれば、フィルタはフィルタ条件によって自動的に名前が付けられ、フィルタアイコンは緑色になります。
</p><p><a  class="image"><img alt="Column Filter 001.png" src="../images/Data_Filter/Column_Filter_001.png" width="71"  /></a>
</p><p>フィルタが適用された列で<b>データフィルタの追加/削除</b>ボタンをクリックするとフィルタが削除されます。フィルタアイコンメニューからフィルタを削除しても同じです。
</p>
<ol><li>データフィルタのついた目的の列を選択します。</li>
<li><b><b>フィルタ</b></b>アイコンをクリックすると表示されるコンテキストメニューから、<b><b>フィルタを削除</b></b>を選択します。</li></ol>
<p><a  class="image"><img alt="Column Filter 002.png" src="../images/Data_Filter/Column_Filter_002.png" width="190"  /></a>
</p><p>フィルタアイコンをなくさずに、適用したフィルタをオン/オフしたい場合は、次で説明するようにフィルタを<i>無効</i>にします。
</p>
<h2><a name="Enable.2FDisable_Data_Filter"></a><span class="mw-headline">データフィルタを有効にする/無効にする</span></h2>
<p>データフィルタの追加後、次のどちらの方法でもフィルタの有効無効を切り替えることができます。
</p>
<ol><li>目的の列を選択します。</li>
<li><b><b>データフィルタ有効にする/無効にする</b></b>ボタン<a  class="image"><img alt="Button Enable Disable Column Filter.png" src="../images/Data_Filter/Button_Enable_Disable_Column_Filter.png" width="23"  /></a>をクリックします。</li></ol>
<p>または、
</p>
<ol><li>目的の列を選択します。</li>
<li><b><b>フィルタ</b></b>アイコンをクリックしてコンテキストメニューを開き、<b><b>フィルタを有効にする</b></b>のチェックと付けて有効にし、チェックを外して無効にします。</li></ol>
<p><a  class="image"><img alt="Column Filter 003.png" src="../images/Data_Filter/Column_Filter_003.png" width="190"  /></a>
</p><p>2つ目の場合で複数の列が選択されていると、選択された列のうち左端にある列のデータフィルタのみ有効/無効が切り替わります。
</p><p>データフィルタが無効化されているとき、フィルタアイコンは灰色になり、フィルタ名には「(オフ)」が表示されます。
</p><p><a  class="image"><img alt="Column Filter 004.png" src="../images/Data_Filter/Column_Filter_004.png" width="70"  /></a>
</p><p>フィルタが有効になっている列と無効になっている列が混ざっている範囲を選択した時に<a  class="image"><img alt="Button Enable Disable Column Filter.png" src="../images/Data_Filter/Button_Enable_Disable_Column_Filter.png" width="23"  /></a>ボタンをクリックすると、全ての列でフィルタが無効になります。
</p>
<h2><a name="Reapply_Data_Filter"></a><span class="mw-headline">データフィルタの再適用</span></h2>
<p>MS Excelと同様、フィルタが適用されたデータを変更した場合、フィルタを再度適用する必要があるので注意が必要です。  フィルタを再適用する必要がある場合、フィルタアイコンの色が黄色になります。フィルタを再適用するには、ワークシートデータ操作ツールバーの<b>データフィルタを再適用する</b>ボタン<a  class="image"><img alt="Button Reapply Column Filter.png" src="../images/Data_Filter/Button_Reapply_Column_Filter.png" width="20"  /></a>をクリックします。
</p>
<dl><dd><a  class="image"><img alt="Filter update pending.png" src="../images/Data_Filter/Filter_update_pending.png" width="651"  /></a></dd></dl>
<p><br />
</p>
<table class="note">
<tr>
<td><b>Note:</b> LabTalk変数をフィルタ条件に使用する場合があります。一般に、変数のフィルタ条件は、フィルタ実行後にキャッシュされます。したがって、LabTalkで変数の値を変更しても、<b>データフィルタを再適用する</b>ボタン<a  class="image"><img alt="Button Reapply Column Filter.png" src="../images/Data_Filter/Button_Reapply_Column_Filter.png" width="20"  /></a>をクリックしても結果は変わりません。キャッシュに関係なくフィルタ条件のLabTalk変数を更新する場合は、<a class="external text" href="../../LabTalk/LabTalk/Wks_(object).html#Methods">LabTalkメソッド</a><code>wks.runfilter()</code>を使用してフィルタを再適用します。
</td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Data_Filter/Tip_icon.png" width="57"  border="0" /></td><td><p>デフォルトでは、<a href="../../UserGuide/Category/Data_Connector.html" title="カテゴリー：データコネクタ">データコネクタ</a>を使用してワークブックを保存すると、インポートされたデータは除外されます（ファイルと一緒に保存されません）。ワークブックにデータフィルタを追加した場合、ファイルを再度開くと、インポート後にデータフィルタが自動的に実行されます。インポート時にデータフィルタを自動実行したくない場合は、<a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#U.2CV.2CW"><b>@WFI=0</b></a>と設定します。LabTalkシステム変数の値を変更する方法については、<a class="external text" href="../../QuickHelp/QuickHelp/How_do_I_permanently_change_the_value_of_a_system_variable.html">このFAQ</a>を参照してください。
</p></td></tr></table>
<h2><a name="Copy_and_Paste_Data_Filter"></a><span class="mw-headline">データフィルタのコピーと貼り付け</span></h2>
<p>1つのワークシート列からデータフィルタをコピーして他の列に適用することができます。これには、<a href="#Custom_Data_Filter_dialog"><b>実行前の条件スクリプト</b>パネル</a>で定義された変数を使用するカスタムフィルタが含まれます。
</p>
<ol><li> 列のフィルタアイコンをクリックしてメニューから<b>フィルタのコピー</b>を選択します。</li>
<li> 目的のワークシート列を選択し、まだフィルタが追加されていなければフィルタを追加します。列のフィルタアイコンをクリックしてメニューから<b>フィルタを貼り付け</b>を選択します。</li></ol>
<p><i>または</i>
</p>
<ol><li> 列の<b>フィルタ</b>セルを右クリックして<b>コピー</b>を選択します。またはフィルタセルをクリックしてCTRL+Cキーを押します。</li>
<li> 次に、対象列を選択し、Ctrl+Vキーでフィルタを貼り付け、それらの列のデータに適用します。</li></ol>
<p><i>もしくは、数値列の場合には、</i>
</p>
<ol><li> 列のフィルタアイコンをクリックしてメニューから<b>名前を付けて保存</b>を選択します。名前を付けてフィルタを保存します。</li>
<li> 目的のワークシート列を選択し、まだフィルタが追加されていなければフィルタを追加します。列のフィルタアイコンをクリックしてメニューから<b>ロード</b>を選択します。サブメニューから保存したフィルタを選択します。</li></ol>
<h2><a name="Customize_Data_Filters"></a><span class="mw-headline">データフィルタの編集</span></h2>
<p>Originはデータタイプを決定し、自動的に3つのデータフィルタ（日付、数値、テキスト）から1つを対応する列に割り当てます。データフィルタを編集する場合にはフィルタ条件を設定する必要があります。
</p><p>データフィルタを編集する場合、2つの方法があります。
</p>
<ol><li><b>フィルタ</b>アイコンをクリックし、コンテキストメニューを開きます。</li>
<li>各データフィルタタイプでは、いくつかのクイックメニュー項目が選択可能になっており、1つ選んで対応する<b>フィルタ</b>ダイアログを開きます。</li>
<li>データフィルタ条件を設定して<b>OK</b>をクリックします。</li></ol>
<p>または、
</p>
<ol><li><b>フィルタ</b>アイコンをクリックし、コンテキストメニューを開きます。</li>
<li><b><b>カスタムフィルタ</b></b>を選択し、<b><b>カスタムデータフィルタ</b></b>ダイアログを開きます。</li>
<li>データフィルタ条件を設定して、<b><b>適用</b></b>または<b><b>OK</b></b>をクリックします。</li></ol>
<p><a  class="image"><img alt="Column Filter 005.png" src="../images/Data_Filter/Column_Filter_005.png" width="191"  /></a>
</p><p><br />
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Data_Filter/Tip_icon.png" width="57"  border="0" /></td><td><p>フィルタ条件を追加したら、 <b>フィルタ</b>セルをダブルクリックしてフィルタを編集できます。
</p>
<dl><dd><a  class="image"><img alt="Filter cell customize.png" src="../images/Data_Filter/Filter_cell_customize.png" width="642"  /></a></dd></dl>
</td></tr></table>
<h2><a name="Menu_Options_and_Dialog_Controls"></a><span class="mw-headline">メニューオプションとダイアログ操作</span></h2>
<p>フォーマットごとに3つのフィルタタイプがあります。
</p>
<ul><li> <b>日付</b></li>
<li><b>数値</b></li>
<li><b>テキスト</b>、<b>月</b>、<b>曜日</b></li></ul>
<p>書くフォーマットでメニューオプションが異なります。どのメニューオプションを表示するかは、列フォーマット<a href="../../UserGuide/UserGuide/The_(Column_Properties)_Properties_Tab.html#Format" title="ユーザガイド: (列プロパティ) プロパティタブ">プロパティ</a>で決定されます。
</p>
<h3><a name="Date_Filter"></a><span class="mw-headline">日付フィルタ</span></h3>
<p><a href="../../UserGuide/UserGuide/The_(Column_Properties)_Properties_Tab.html#Format" title="ユーザガイド: (列プロパティ) プロパティタブ"><b>フォーマット</b> = <b>日付</b></a>の列の場合、以下のフィルタオプションがあります。
</p>
<dl><dd><a  class="image"><img alt="Filter menu date.png" src="../images/Data_Filter/Filter_menu_date.png" width="176"  /></a></dd></dl>
<p><b>等しい</b>、<b>前</b>、<b>後</b>をクリックすると、<b>単純な日付フィルタ</b>ダイアログが開きます。<b>範囲</b>をクリックすると、日付範囲を設定するダイアログが開きます。
</p>
<dl><dd><dl><dd><a  class="image"><img alt="Filter simple date filter.png" src="../images/Data_Filter/Filter_simple_date_filter.png" width="528"  /></a></dd></dl></dd></dl>
<p><b>数式タイプ</b>、<b>値</b>、<b>条件2</b>あるいは、<b>開始</b>、<b>終了</b>を設定して、日付のフィルタを行います。
</p><p>単純なデータフィルターの<b>条件2</b>には、<b>および/あるいは</b>フィルタがあります。デフォルトは<b>なし</b>ですが、<b>および</b>または<b>あるいは</b>を選択して、2番目のフィルタ条件を作成できます。
</p>
<dl><dd><dl><dd><a  class="image"><img alt="Filter simple date condition2.png" src="../images/Data_Filter/Filter_simple_date_condition2.png" width="278"  /></a></dd></dl></dd></dl>
<table class="dialogcontroltable">
<tr>
<th>なし
</th>
<td>2番目のフィルタ条件なし（デフォルト）
</td></tr>
<tr>
<th>および
</th>
<td>抽出した条件に設定した日時がどちらも真であるデータを残して他の行を非表示にします。
</td></tr>
<tr>
<th>あるいは
</th>
<td>抽出した条件に設定した日時がどちらか片方が真であるデータを残して他の行を非表示にします。
</td></tr></table>
<p><br />
データフィルタメニューの<b>カスタムフィルタ</b>を選択すると開く<a href="../../UserGuide/UserGuide/Data_Filter.html#Custom_Data_Filter_dialog" title="ユーザガイド:データフィルタ"><b>カスタムデータフィルタ</b>ダイアログ</a>で、より高度なフィルタリングを行えます。
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Data_Filter/Tip_icon.png" width="57"  border="0" /></td><td><p>以前は、<b>値</b>、<b>開始</b>および<b>終了</b>は、単純なテキストフィールドに置き換えられた標準の日付ピッカーコントロールを使用していました。日付ピッカーに戻すには、<b>@DP</b> = <i>1</i> と<a class="external text" href="../../QuickHelp/QuickHelp/How_do_I_permanently_change_the_value_of_a_system_variable.html">システム変数を設定</a>します。
</p>
<dl><dd><a  class="image"><img alt="Filter revert date picker.png" src="../images/Data_Filter/Filter_revert_date_picker.png" width="388"  /></a></dd></dl>
</td></tr></table>
<h3><a name="Numeric_Filter"></a><span class="mw-headline">数値フィルタ</span></h3>
<p><a href="../../UserGuide/UserGuide/The_(Column_Properties)_Properties_Tab.html#Format" title="ユーザガイド: (列プロパティ) プロパティタブ"><b>フォーマット</b> = <b>数値</b></a>の列の場合、以下のフィルタオプションがあります。
</p>
<dl><dd><dl><dd><a  class="image"><img alt="Filter menu numeric.png" src="../images/Data_Filter/Filter_menu_numeric.png" width="176"  /></a></dd></dl></dd></dl>
<p><b>等しい</b>、<b>より小さい</b>、<b>より大きい</b>をクリックすると、<b>単純な数値フィルタ</b>ダイアログボックスが開きます。<b>範囲</b>をクリックすると、数値範囲を設定するダイアログが開きます。
</p>
<dl><dd><dl><dd><a  class="image"><img alt="Filter simple numeric filter.png" src="../images/Data_Filter/Filter_simple_numeric_filter.png" width="452"  /></a></dd></dl></dd></dl>
<p><b>数式タイプ</b>、<b>値</b>、<b>条件2</b>あるいは、<b>開始</b>、<b>終了</b>を設定して、数値のフィルタを行います。
</p><p>単純な数値フィルターの条件2には、<b>および/あるいは</b>フィルタがあります。デフォルトは<b>なし</b>ですが、<b>および</b>または<b>あるいは</b>を選択して、2番目のフィルタ条件を作成できます。
</p>
<dl><dd><dl><dd><a  class="image"><img alt="Filter simple numeric condition2.png" src="../images/Data_Filter/Filter_simple_numeric_condition2.png" width="228"  /></a></dd></dl></dd></dl>
<table class="dialogcontroltable">
<tr>
<th>なし
</th>
<td>2番目のフィルタ条件なし（デフォルト）
</td></tr>
<tr>
<th>および
</th>
<td>抽出条件に設定した数値がどちらも真であるデータを残して他の行を非表示にします。
</td></tr>
<tr>
<th>あるいは
</th>
<td>抽出条件に設定した数値がどちらか片方が真であるデータを残して他の行を非表示にします。
</td></tr></table>
<p><br />
<b>上位10</b>または<b>下位10</b>をクリックすると、<b>トップテン</b>ダイアログが表示されます。ここでは、<b>項目</b>の数または<b>パーセント</b>で最高値または最低値を除くすべての値を除外することができます。 
</p>
<dl><dd><dl><dd><a  class="image"><img alt="Filter numeric topN.png" src="../images/Data_Filter/Filter_numeric_topN.png" width="234"  /></a></dd></dl></dd></dl>
<p><br />
データフィルタメニューの<b>カスタムフィルタ</b>を選択すると開く<a href="../../UserGuide/UserGuide/Data_Filter.html#Custom_Data_Filter_dialog" title="ユーザガイド:データフィルタ"><b>カスタムデータフィルタ</b>ダイアログ</a>で、より高度なフィルタリングを行えます。
</p>
<h3><a name="Text_Filter"></a><span class="mw-headline">テキストフィルタ</span></h3>
<p>テキストフィルタは選択した列のデータ形式が<b><b>テキスト</b></b>、<b><b>月</b></b>、<b><b>曜日</b></b>であるものに適用されます。
</p><p>クイックメニューから、チェックボックスを選択/選択解除して、対応するテキストエントリを表示/非表示にすることができます。
</p><p><a  class="image"><img alt="Column Filter Menu 002.png" src="../images/Data_Filter/Column_Filter_Menu_002.png" width="232"  /></a>
</p>
<h4><a name="Custom_Filter_.28Simple_Text.29"></a><span class="mw-headline">カスタムフィルタ (単純なテキスト)</span></h4>
<p><b><b>カスタムフィルタ</b></b>をクイックメニューアイテムから選ぶと<b><b>カスタムフィルタ（単純なテキスト）</b></b>ダイアログが開きます。
</p><p><a  class="image"><img alt="Column Filter Menu 003.png" src="../images/Data_Filter/Column_Filter_Menu_003.png" width="566"  /></a>
</p>
<ul><li> <b>項目</b>列は、選択された範囲に入力されているユニークなテキストをすべてリストで表示します。<b>カウント</b>列は、選択された範囲の対応するテキストの度数をリスト表示します。</li>
<li> いずれかの列見出しをクリックすると、データパネルの結果が昇順または降順でソートされます。</li>
<li> 各エントリに対応するチェックボックスを使って表示、非表示の切り替えが可能です。チェックは外すと非表示になります。</li></ul>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Data_Filter/Tip_icon.png" width="57"  border="0" /></td><td><p>テキストフィルタを使用した後、<b><b>フィルタ</b></b>ラベル行はフィルタで非表示になっていないテキストエントリのリストを表示します。デフォルトで、セル内のエントリはスペース (&quot; &quot;)で区切られています。システム変数 <b>@TFS</b>では0=Enter、1=スペース、2=カンマ、 3=セミコロンとなり、区切り文字を切り替えることができます。
</p>
<dl><dd><dl><dd><a  class="image"><img alt="Filter text label row.png" src="../images/Data_Filter/Filter_text_label_row.png" width="194"  /></a></dd></dl></dd></dl>
<p>もう一つのシステム変数 <b>@TFL</b> は、テキストフィルタラベル行の文字の最大数を設定できます。デフォルトでは、50に設定されています。最初の文字列と最後の文字列は常に完全に表示され（ソートはアルファベット順です）、他の文字列は...で表示されます。
</p><p>これら2つのLabTalkシステム変数については、<a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#T">LabTalkシステム変数リスト</a>を参照してください。
</p></td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Data_Filter/Tip_icon.png" width="57"  border="0" /></td><td><p>縦棒/横棒グラフのX列にテキストが含まれるとき、テキストは主目盛ラベルとして使用され、行番号順に並べられます。Origin 2018より前は、ワークシートデータフィルタを適用したときに、データポイントがプロットされていないにも関わらず、空の目盛とフィルタリングされたデータのラベルが登録されていました。これはOrigin 2018で変更され、フィルタデータに紐づいた目盛は表示されません。<a href="../../UserGuide/UserGuide/Displaying_Supporting_Data_in_Worksheet_header_Rows.html#Categories" title="ユーザガイド:ワークシートヘッダ行に表示するサポートデータ">カテゴリーとして設定</a>されていないテキストを含むX列に対してのみ適用されます。
</p>
<dl><dd><a  class="image"><img alt="Filter X Label Data.png" src="../images/Data_Filter/Filter_X_Label_Data.png" width="719"  /></a></dd></dl>
<p>バージョン2018より前の状態に戻すには、<code>wks.KHRA=1;</code> を使用します(例えば、これを<a href="../../UserGuide/UserGuide/The_Workbook_Script_Panel.html" title="ユーザガイド：ワークブックスクリプトパネル">ワークブックスクリプトパネル</a>に追加します)。
</p></td></tr></table>
<h4><a name="Custom_Filter_.28Advanced_Text.29"></a><span class="mw-headline">カスタムフィルタ (高度なテキスト)</span></h4>
<p><b><b>詳細</b></b>チェックを選択すると<b><b>カスタムフィルタ（テキスト形式の詳細）</b></b>ダイアログが開きます。
</p>
<dl><dd><a  class="image"><img alt="Column Filter Menu 004.png" src="../images/Data_Filter/Column_Filter_Menu_004.png" width="569"  /></a></dd></dl>
<ul><li> フィルタ条件の入力は<b>条件</b>パネルで行います。</li>
<li> <b>条件スクリプト前</b>パネルを使って、フィルタ条件を定義する<i>前に</i>、LabTalkスクリプトを実行できます。</li></ul>
<p><br />
</p>
<h5><a name="Specifying_your_Condition"></a><span class="mw-headline">条件を指定する</span></h5>
<dl><dd><a  class="image"><img alt="Column Filter Menu 004 1.png" src="../images/Data_Filter/Column_Filter_Menu_004_1.png" width="729"  /></a></dd></dl>
<p>キーボードからの直接入力とメニュー選択の任意の組み合わせを使用して、条件を作成できます。ダイアログボックスには、いくつかの重要な要素（ワイルドカード文字、行番号）が表示され、条件式の例が表示されます。
</p>
<ul><li> <b>Col(N)を表す変数</b>ボックスは、条件を入力する際に現在の列を示すために使用する変数を入力します。</li>
<li> 右側にある三角形ボタンをクリックすると、フライアウトメニューが開きます。メニューには、<b>文字列</b>関数、<b>論理</b>関数、<b>ユーザOriginC</b>関数（存在すれば）などが表示されます。関数を選択して、引数をつかって<b>条件</b>ボックスに直接入力します。これらの関数の使用についての詳細は、<a class="external text" href="../../LabTalk/Script/LabTalk-Supported_Functions.html">LabTalkがサポートしている関数</a>を参照してください。</li>
<li> 自然言語の論理演算子 &quot;AND&quot;、&quot;OR&quot;、&quot;NOT&quot;および &quot;LIKE&quot;を使用することも、それらと等価の記号演算子を使用することもできます（<a class="external text" href="../../LabTalk/LabTalk/Operators.html#Logical_and_Relational_Operators">論理演算子と関係演算子</a>を参照）。例えば、以下は等価な条件の例です。</li></ul>
<dl><dd><table class="simple" style="white-space:nowrap">
<tr>
<td style="background: #C9C9C9; border: 1px solid black"><b> サンプル </b>
</td>
<td style="background: #C9C9C9; border: 1px solid black"><b> 説明 </b>
</td></tr>
<tr>
<td style="border: 1px solid black"> NOT(make=&quot;Buick&quot; OR make=&quot;Chrysler&quot;)
</td>
<td style="border: 1px solid black"> &quot;Buick&quot; と &quot;Chrysler&quot;を除外
</td></tr>
<tr>
<td style="border: 1px solid black">&nbsp;!(make=&quot;Buick&quot; OR make=&quot;Chrysler&quot;)
</td>
<td style="border: 1px solid black"> &quot;Buick&quot; と &quot;Chrysler&quot;を除外
</td></tr>
<tr>
<td style="border: 1px solid black"> !(make=&quot;Buick&quot; || make=&quot;Chrysler&quot;)
</td>
<td style="border: 1px solid black"> &quot;Buick&quot; と &quot;Chrysler&quot;を除外
</td></tr></table></dd></dl>
<ul><li> Usage of wildcards:</li></ul>
<dl><dd><table class="simple" style="white-space:nowrap">
<tr>
<td style="background: #C9C9C9; border: 1px solid black"><b> シンボル </b>
</td>
<td style="background: #C9C9C9; border: 1px solid black"><b> 使用方法 </b>
</td></tr>
<tr>
<td style="border: 1px solid black">&nbsp;?(クエスチョンマーク)
</td>
<td style="border: 1px solid black"> 任意の1文字を表します。例えば、&rdquo;a?c&rdquo;は&rdquo;abc&rdquo;や&rdquo;adc&rdquo;を検索しますが、&rdquo;abbc&rdquo;は検索されません。
</td></tr>
<tr>
<td style="border: 1px solid black"> *(アスタリスク)
</td>
<td style="border: 1px solid black"> 任意の文字列を表します。例えば、&rdquo;abc*e&rdquo;は&rdquo;abcde&rdquo;や&rdquo;abcdde&rdquo;、&rdquo;abce&rdquo;を検索します。
</td></tr>
<tr>
<td style="border: 1px solid black"> ==(イコール2つ)
</td>
<td style="border: 1px solid black"> 完全一致を表します。例えば、x==&quot;a*&quot;は&quot;a*&quot;を検索しますが、&quot;abc&quot;は検索しません。
</td></tr></table></dd></dl>
<ul><li> <b>条件</b>パネルでは行番号の置換として、変数 <b>i</b> を使用できます。例えば、 <i>i&gt;15</i> は、15番目の行より後を示します。変数 <b>i</b> は、<b><b>カスタムデータフィルタ</b></b>ダイアログ内でも使用できます。</li></ul>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Data_Filter/Tutorial_icon.png" width="57"  border="0" />
	</td>
	<td><p>テキストフィルタでワイルドカードを使う方法については次の簡単なチュートリアルをご覧ください。
</p>
<ol><li>\Samples\Statistics\ から <b>Automobile.dat</b> ファイルをインポートします。</li>
<li>列Bを選択し、<b><b>データフィルタを追加/削除</b></b>ボタン<a  class="image"><img alt="Button Add Remove Column Filter.png" src="../images/Data_Filter/Button_Add_Remove_Column_Filter.png" width="21"  /></a>をクリックします。</li>
<li><b><b>フィルタ</b></b>アイコンをクリックし、<b><b>カスタムフィルタ</b></b>を選択します。
<dl><dd><a  class="image"><img alt="Column Filter 006.png" src="../images/Data_Filter/Column_Filter_006.png" width="244"  /></a></dd></dl></li>
<li><b><b>詳細</b></b>チェックボックスのチェックを付けます。</li>
<li>クエリボックス（条件）に次のように入力します。<pre class="lt" style="font-family:monospace;">x LIKE <span style="color: #ff00ff;">&quot;S*&quot;</span></pre></li>
<li><b><b>OK</b></b>をクリックし、確認メッセージが表示された場合は<b>はい</b>をクリックします。</li>
<li>元のワークシートに戻ると、&rdquo;s&rdquo;で始まるテキスト行のみが残っているはずです。</li></ol>
</td></tr></table>
<h3><a name="Custom_Data_Filter_dialog"></a><span class="mw-headline">カスタムデータフィルタダイアログ</span></h3>
<p><b><b>カスタムデータフィルタ</b></b>ダイアログは<b>日付</b>と<b>数値</b>データの高度なフィルタリングを実行するために使用します。
</p><p><a  class="image"><img alt="Column Filter Menu 001.png" src="../images/Data_Filter/Column_Filter_Menu_001.png" width="552"  /></a>
</p>
<ul><li> フィルタ条件の入力は<b>条件</b>パネルで行います。  三角形のボタン<a  class="image"><img alt="Button Select Data Right Triangle.png" src="../images/Data_Filter/Button_Select_Data_Right_Triangle.png" width="18"  /></a>をクリックしてフライアウトメニューを開くと、日付またはデータの関数を挿入できます。これらの関数についての詳細は、<a class="external text" href="../../LabTalk/Script/LabTalk-Supported_Functions.html">LabTalkがサポートしている関数</a>を参照してください。演算子についての詳細は、<a class="external text" href="../../LabTalk/LabTalk/Operators.html#Logical_and_Relational_Operators">論理演算子と関係演算子</a>を参照してください。</li></ul>
<ul><li> <b>条件スクリプトの前</b>パネル（非表示になっている場合は<a  class="image"><img alt="Button Show Scripts.png" src="../images/Data_Filter/Button_Show_Scripts.png" width="23"  /></a>ボタンをクリック）は、フィルタリング前に実行するLabTalkスクリプトを定義できます。ここでも三角形のボタン<a  class="image"><img alt="Button Select Data Right Triangle.png" src="../images/Data_Filter/Button_Select_Data_Right_Triangle.png" width="18"  /></a>をクリックして、スクリプト内で使用する関数にアクセスできます。</li></ul>
<h4><a name="Custom_Data_Filter_Buttons"></a><span class="mw-headline">カスタムデータフィルタボタン</span></h4>
<table class="dialogcontroltable">
<tr>
<th>テスト
</th>
<td>フィルタ条件を満たす行は、元のワークシートで強調表示されます。これらの行は、フィルタリング後も残ります。
</td></tr>
<tr>
<th>OK
</th>
<td>フィルタ条件の変更を適用し、ダイアログを閉じます。
</td></tr>
<tr>
<th>キャンセル
</th>
<td>フィルタ条件の変更を適用せずにダイアログを閉じます。
</td></tr>
<tr>
<th>OK
</th>
<td>ダイアログを閉じずにフィルタ条件を適用します。
</td></tr></table>
<p><br />
数値フィルタでは一部の組み込み関数がフライアウトメニュー内に表示されません。それらの関数は以下の通りです。
</p>
<table class="simple" style="white-space:nowrap">
<tr>
<td style="background: #C9C9C9; border: 1px solid black"><b> 数式 </b>
</td>
<td style="background: #C9C9C9; border: 1px solid black"><b> 使用方法 </b>
</td></tr>
<tr>
<td style="border: 1px solid black"> x.between(x1,x2)
</td>
<td style="border: 1px solid black"> ユーザ入力値のx1とx2の間のxのサブ範囲を返します。下記と同じです。 <pre class="lt" style="font-family:monospace;">x<span style="color: #000080;">&lt;=</span>x2 <span style="color: #000080;">&amp;&amp;</span> x<span style="color: #000080;">&gt;=</span>x1</pre>.
<p><b>*</b>表の下の注釈を確認してください。
</p>
</td></tr>
<tr>
<td style="border: 1px solid black"> x.top(10,0)
</td>
<td style="border: 1px solid black"> xの上位10を返します。
</td></tr>
<tr>
<td style="border: 1px solid black"> x.top(10,1)
</td>
<td style="border: 1px solid black"> xの上位10%を返します。
</td></tr>
<tr>
<td style="border: 1px solid black"> x.bottom(10,0)
</td>
<td style="border: 1px solid black"> xの下位10を返します。
</td></tr>
<tr>
<td style="border: 1px solid black"> x.bottom(10,1)
</td>
<td style="border: 1px solid black"> xの下位10%を返します。
</td></tr>
<tr>
<td style="border: 1px solid black"> x.top(n,0/1)
</td>
<td style="border: 1px solid black"> Xの中で上位<i>n</i> を返します。0が選択されていると、<i>n</i> は項目の個数、1が選択されていると<i>n</i> はパーセントです。
</td></tr>
<tr>
<td style="border: 1px solid black"> x.bottom(n,0/1)
</td>
<td style="border: 1px solid black"> Xの中で下位<i>n</i> を返します。0が選択されていると、<i>n</i> は項目の個数、1が選択されていると<i>n</i> はパーセントです。
</td></tr></table>
<p><b>*</b> この式では、x1 と x2 は行番号です。この式で変数を使用する場合は、&quot;x1&quot;と &quot;x2&quot;は広く使用されているシステム変数であるため、値が変更される可能性があるので使用しないでください。代わりに<a class="external text" href="../../LabTalk/LabTalk/System_Variables.html#V1.2C_V1.24.E2.80.93V4.2C_V4.24">ページ変数v1...v4</a>の使用を検討します。
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Data_Filter/Tip_icon.png" width="57"  border="0" /></td><td><p>テキスト、数値、日付のフィルタのために、Originは、<b>x.count()</b> 関数をサポートし、複製されたデータの数をカウントできます。例えば、3以上の数であるテキストデータを保持するには、<b><b>カスタムデータフィルタ</b></b>ダイアログで以下のようにセットします。 <code><b>Condition:</b> x.count() &gt; 3</code>
</p></td></tr></table>
<h4><a name="Filter_Menu"></a><span class="mw-headline">フィルタメニュー</span></h4>
<p><a  class="image"><img alt="Custom Data Filter Filter Menu.png" src="../images/Data_Filter/Custom_Data_Filter_Filter_Menu.png" width="552"  /></a>
</p><p><b>フィルタ</b>メニューから以下の操作が可能です。
</p>
<ul><li> サンプルを開く</li>
<li> 開く</li>
<li> 保存</li></ul>
<p>ロードされたフィルタはこのメニューの下部に表示されます（ない場合は「なし」と表示）。
</p>
<h2><a name="Ignore_Hidden_Rows"></a><span class="mw-headline">非表示行を無視する</span></h2>
<p>デフォルトでは、フィルタで非表示になった行はグラフ操作では無視されます。以下のいずれかの方法でこれを変更し、非表示行を含めることが可能です。
</p>
<ol><li>ワークシートをアクティブにします。</li>
<li>コマンドウィンドウまたはスクリプトウィンドウで以下を実行します。</li></ol>
<pre class="lt" style="font-family:monospace;">wks.<span style="color: #000080;">ignorehidden</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;</pre>
<p><i>または、</i>
</p>
<ol><li>メニューから<b><b>フォーマット：ワークシートの表示属性</b></b>を選ぶか<b>F4</b>キーを押して<b>ワークシートプロパティ</b>ダイアログを開きます。</li>
<li><b>その他</b>のタブで、<b>作図と分析で非表示の行は無視する</b>のチェックを外します。</li></ol>
<table class="note">
<tr>
<td><b>Note:</b> 非表示行は、LTスクリプトおよび値の設定では無視されません。
</td></tr></table>
<p><br />
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Data_Filter/Tip_icon.png" width="57"  border="0" /></td><td><p>マスクを適用してデータフィルタを列データに適用する場合、マスクしたデータでもデフォルトで列に表示されます。
</p><p>データフィルタを使用して列にマスクされたデータを表示するかどうかは、システム変数@FBMによって制御されています。
</p>
<ul><li>0：非表示</li>
<li>1：表示</li></ul>
</td></tr></table>
<h2><a name="Save_Data_Filter_into_Operation"></a><span class="mw-headline">データフィルタを操作に保存する</span></h2>
<p><b><a href="../../UserGuide/UserGuide/Copy_Columns_to_New_Destination.html" title="ユーザガイド：列を別の場所にコピーする">列をコピー</a></b>や<a href="../../UserGuide/UserGuide/Pivot_Table.html" title="ユーザガイド:ピボットテーブル"><b><b>ピボットテーブル</b></b></a>の、<a href="../../UserGuide/UserGuide/Recalculating_Analysis_Results.html" title="ユーザガイド：分析結果の再計算">再計算</a>の鍵のアイコンには、3つのワークシートフィルタオプションがあります。これらは結果がさらなるフィルタの変化によって影響を受けるかどうかを制御するために使用されます。 
</p><p><b>Note：</b>列のコピーおよびピボットテーブルの再計算モードは<b>自動</b>または<b>手動</b>に設定する必要があります。
</p><p><a  class="image"><img alt="Filters Lock.png" src="../images/Data_Filter/Filters_Lock.png" width="312"  /></a>
</p>
<table class="dialogcontroltable">
<tr>
<th>ワークシートフィルタ：ロック
</th>
<td>
<p>このオプションが選択されているとき、ソース列のデータフィルタ条件が変更されても、結果は固定されます。つまり、ソースワークシートのフィルタ条件が変更されても、結果列の更新のトリガーにはなりません。 
</p>
</td></tr>
<tr>
<th>ワークシートフィルタ：再読み込み
</th>
<td>
<p>この項目は<b><b>ワークシートフィルタ：ロック</b></b>をあらかじめ選択しないとアクティブになりません。ソース列から結果列にデータフィルタ条件を再読み込みします。 つまり、ソース列のデータフィルタ条件を変更した後、このオプションをクリックしてロックされた結果列の自動更新を行うことで、結果列にも同じフィルタ条件が適用されます。
</p>
</td></tr>
<tr>
<th>ワークシートフィルタ：戻る
</th>
<td>
<p>この項目は<b><b>ワークシートフィルタ：ロック</b></b>をあらかじめ選択しないとアクティブになりません。初期データフィルタ条件をソース列に戻します。 つまり、ソースワークシートのデータフィルタ条件を変更後、このオプションをクリックするとソース列から適用された最新のデータフィルタ条件は、結果列に適用されているフィルタ条件に押し戻されます。結果列に直接データフィルタを適用した場合には、ソースに反映させることはできませんのでご注意ください。 
</p>
</td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Data_Filter/Tip_icon.png" width="57"  border="0" /></td><td><p>テキストと現在のフィルタ条件を組み合わせたテキストラベルをグラフに追加できます。例えば、テキスト &quot;Make =&quot;を文字列 &quot;%(1, @LF)&quot;と組み合わせて、フィルタ条件の変化に応じて変化するダイナミックラベルを作成します（ラベルを更新すると、フィルタはロックできません）。
</p>
<dl><dd><a  class="image"><img alt="Text label options @LF.png" src="../images/Data_Filter/Text_label_options__40LF.png" width="442"  /></a></dd></dl>
</td></tr></table>


    