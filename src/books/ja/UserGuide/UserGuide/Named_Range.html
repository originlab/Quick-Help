<h1 class="firstheading">名前付き範囲</h1><p class='urlname' style='display: none'>Named-Range</p>
<table class="simple" style="width: 50%">
<tr style="vertical-align: top;">
<td> <a  class="image"><img alt="Website blog icon circle.png" src="../images/Named_Range/18px-Website_blog_icon_circle.png" width="18"   /></a><a  class="image"><img alt="Blog Image 33x33px.png" src="../images/Named_Range/100px-Blog_Image_33x33px.png" width="100"   /></a>
<ul><li> <a class="external text" href="http://blog.originlab.com/names-in-origin-2022" target="_blank"><b>Names in Origin2022</b></a></li>
<li> <a class="external text" href="http://blog.originlab.com/named-range-for-fitting-parameters" target="_blank"><b>Named Range for Fitting Parameters</b></a></li></ul>
</td></tr></table>
<p><br />
Origin 2022より、ワークシートの単一のセルまたは列（の一部）に直接名前を付けることで範囲変数を定義できます。名前付き範囲は、X-ファンクションでのセル/列の参照、列値の設定の数式、分析テンプレート、LabTalkスクリプトなどに使用できます。 
</p><p>Origin 2022b から、線形フィット、非線形フィット (NFit)、多項式フィット、および多重線形回帰ダイアログボックスで、名前付き範囲の値を X の「開始」値と「終了」値、初期パラメータ値、下限と上限、および固定パラメータ値として使用します。 
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Define_a_range"><span class="tocnumber">1</span> <span class="toctext">範囲を定義する</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#by_Define_Name_menu"><span class="tocnumber">1.1</span> <span class="toctext">名前を定義メニューから</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#by_Formula_Bar"><span class="tocnumber">1.2</span> <span class="toctext">数式バーから</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#by_Mini_Toolbar"><span class="tocnumber">1.3</span> <span class="toctext">ミニツールバーから</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#by_Name_Manager_menu"><span class="tocnumber">1.4</span> <span class="toctext">名前の管理メニューから</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Manage_Named_Ranges"><span class="tocnumber">2</span> <span class="toctext">名前付き範囲の管理</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#Named_Range_Manager"><span class="tocnumber">2.1</span> <span class="toctext">名前付き範囲の管理</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Display_in_Object_Manager"><span class="tocnumber">2.2</span> <span class="toctext">オブジェクトマネージャでの表示</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-9"><a href="#Using_Named_Range_in_Label_Rows"><span class="tocnumber">3</span> <span class="toctext">ラベル行で名前付き範囲を使用する</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#Quick_tutorial"><span class="tocnumber">4</span> <span class="toctext">クイックチュートリアル</span></a></li>
</ul>
</div>
<h2><a name="Define_a_range"></a><span class="mw-headline">範囲を定義する</span></h2>
<p>Originでは、いくつかの場所から、名前付き範囲を定義することができます。
</p>
<h4><a name="by_Define_Name_menu"></a><span class="mw-headline">名前を定義メニューから</span></h4>
<ol><li> ワークシートの単一のセルもしくは列を選択します。</li>
<li> メニューの<b>データ：名前を定義</b>を選択します（もしくは<b>Ctrl+L</b>）。</li></ol>
<p><b>新しい名前</b>ダイアログが開きます。
</p>
<dl><dd><a  class="image"><img alt="Define name dialog.png" src="../images/Named_Range/Define_name_dialog.png" width="399"  /></a></dd></dl>
<table class="simple">
<tr>
<th> 名前
</th>
<td>
<p>範囲変数として名前を入力します。「AAA1」のように、<a href="../../UserGuide/UserGuide/Column_Short_Name_Restriction.html" title="ユーザガイド：列ショートネームの制限">SCN表記</a>において競合が生じる名前は使用を避けてください。命名規則：
</p>
<ol><li> 文字で開始します。</li>
<li> 最低でも4文字。</li>
<li> スペースや特殊文字は使用できません。 </li>
<li> 大文字と小文字は区別しません。</li></ol>
</td></tr>
<tr>
<th>スコープ
</th>
<td>
<p>名前付き範囲には、ワークシート、ワークブック、プロジェクトの3つのスコープレベルを指定できます。
</p>
<dl><dd><ul><li>ワークシート/ワークブック/プロジェクト スコープの範囲は、それぞれワークシート/ワークブック/プロジェクトとともに保存されます。</li>
<li>同じスコープレベルでは、名前は一意である必要があります。 </li>
<li>名前付き範囲がシート/ブック スコープとして定義されている場合、この範囲をX-ファンクションまたはLabTalkスクリプトの入力として使用するときは、シート/ブックがアクティブである必要があります。</li></ul></dd></dl>
</td></tr>
<tr>
<th> 関数として定義する
</th>
<td>
<p>Y列が選択されている場合、このチェックボックスにチェックを入れると、この列とそれに対応するX列が関数として使用されます。つまり、命名されたXY範囲を使用して、XからYを補間/補外することができます。
</p>
<dl><dd><ul><li> 補間するXは、単一の値またはデータセットにすることができます。</li>
<li> Xは単調でなければなりません。 </li>
<li> デフォルトの補間方法は線形です。オプションで、この関数の2番目の引数として、スプライン/Bスプライン メソッドを指定できます。</li></ul></dd></dl>
<p>詳細は、<a class="external text" href="../../LabTalk/Script/Interpolation.html#Using_XY_Range">LabTalkガイドの補間</a>の案内を参照してください。
</p>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Named_Range/Tutorial_icon.png" width="57"  border="0" />
	</td>
	<td><p>例えば、範囲「alpha」をcol(B)として定義したとします。
</p>
<dl><dd><a  class="image"><img alt="Define as function 1.png" src="../images/Named_Range/Define_as_function_1.png" width="523"  /></a></dd></dl>
<p>スクリプトウィンドウで次のスクリプトを実行して、x = 0.15で補間されたY値を取得します。
</p>
<pre class="lt" style="font-family:monospace;">alpha<span style="color: #000000;">(</span><span style="color: #0000dd;">0.15</span>,spline<span style="color: #000000;">)</span><span style="color: #000080;">=</span>;</pre>
<p>そして、2つのXY列を追加し、col(C)にX値を入力する場合、補間/補外し、範囲「beta」として定義します。<br />col(D)の<b>F(x)=</b>に、式を入力します。
</p>
<pre class="lt" style="font-family:monospace;">alpha<span style="color: #000000;">(</span>beta<span style="color: #000000;">)</span>;</pre>
<p>col(C)から補間/補外されたY値で埋まります。
</p>
<dl><dd><a  class="image"><img alt="Define as function 2.png" src="../images/Named_Range/Define_as_function_2.png" width="506"  /></a></dd></dl>
</td></tr></table>
</td></tr></table>
<table class="note">
<tr>
<td><b>名前付き範囲での競合の防止：</b>
<ul><li> <i>シートを複製する場合</i>：シートレベルの名前付き範囲が複製されます。ブックおよびプロジェクトレベルの名前付き範囲は複製されません。</li>
<li> <i>ブックを複製する場合</i>：ブックおよびシートレベルの名前付き範囲が複製されます。プロジェクトレベルの名前付き範囲は複製されません。 </li>
<li> <i>ブック間でシートをドラッグする場合</i>：ブックレベルの名前付き範囲が重複している場合は、宛先のブックの名前付き範囲のみを保持します。 </li>
<li> <i>プロジェクトを追加する場合</i>：プロジェクトレベルの名前付き範囲が重複している場合は、追加するプロジェクトの名前付き範囲のみを保持し、追加されるプロジェクトの名前付き範囲を破棄します。</li></ul>
</td></tr></table>
<h4><a name="by_Formula_Bar"></a><span class="mw-headline">数式バーから</span></h4>
<ol><li> ワークシートの単一のセルもしくは列を選択します。</li>
<li> <b>表示：数式バー</b>メニューを選択し、<a href="../../UserGuide/UserGuide/Using_Formulae_to_Set_Cell_Values.html#Edit_Cell_Formulas_in_Formula_Bar" title="ユーザガイド：数式を使用してセル値を設定する">数式バー</a>を表示させます。</li>
<li> 左端の編集ボックスに、範囲名を入力して範囲を定義します。</li></ol>
<dl><dd><a  class="image"><img alt="Named range formula bar.png" src="../images/Named_Range/Named_range_formula_bar.png" width="318"  /></a></dd></dl>
<p><b>Note</b>: 
</p>
<dl><dd><ul><li> この方法で追加された名前付き範囲のスコープは、デフォルトではブックです。</li>
<li> ドロップダウンリストから既存の名前付き範囲を選択すると、その範囲にジャンプします。</li></ul>
<dl><dd><a  class="image"><img alt="Named range formula bar 1.gif" src="../images/Named_Range/Named_range_formula_bar_1.gif" width="502"  /></a></dd></dl></dd></dl>
<h4><a name="by_Mini_Toolbar"></a><span class="mw-headline">ミニツールバーから</span></h4>
<ol><li> ワークシートの <font color="blue">単一の入力された</font> セルを選択します。</li>
<li> 表示されるミニツールバーの<b>名前を定義</b>ボタン<a  class="image"><img alt="Popup Define Name.png" src="../images/Named_Range/Popup_Define_Name.png" width="24"  /></a>を選択します。<b><b>新しい名前</b></b>ダイアログが開きます。 </li></ol>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Named_Range/Tip_icon.png" width="57"  border="0" /></td><td><p>選択したセルの左側に命名規則を満たすテキストがある場合、そのテキストは範囲の<b>名前</b>として自動選択されます。
</p>
<dl><dd><a  class="image"><img alt="Define name minitoolbar.png" src="../images/Named_Range/Define_name_minitoolbar.png" width="526"  /></a></dd></dl>
</td></tr></table>
<h4><a name="by_Name_Manager_menu"></a><span class="mw-headline">名前の管理メニューから</span></h4>
<ol><li> <b>データ：名前の管理</b>メニューを選択します（もしくは<b>Ctrl</b>+<b>F3</b>）</li>
<li> 開いた<b>名前の管理</b>ダイアログで、名前付き範囲を追加、編集、削除することができます。詳細については、<a href="#manage_named_ranges">次のセクション</a>をご覧下さい。</li></ol>
<h2><a name="Manage_Named_Ranges"></a><span class="mw-headline">名前付き範囲の管理</span></h2>
<h3><a name="Named_Range_Manager"></a><span class="mw-headline">名前付き範囲マネージャ</span></h3>
<ol>
<li> <b>データ：名前の管理</b>メニューを選択します（もしくは<b>Ctrl</b>+<b>F3</b>）
<li> <b>名前付き範囲の管理</b>にて、以下を行えます
<ul>
<li> 名前、スコープを変更し、既存の範囲のコメントを編集します。
<li> 右クリックして新しい範囲を挿入します。
<li> 右クリックして、既存の範囲を削除します。
<li> 複数行の選択も可能です。（<b>Ctrl</b>キーを押して複数行を選択する、または<b>Shift</b>キーを押して連続した範囲を選択する）
</ul>
</ol>
<p><a  class="image"><img alt="Named range manager dialog.png" src="../images/Named_Range/Named_range_manager_dialog.png" width="488"  /></a>
</p>
<h3><a name="Display_in_Object_Manager"></a><span class="mw-headline">オブジェクトマネージャでの表示</span></h3>
<p>名前付き範囲は、それらが定義されているワークシートの下に一覧表示されます。 
</p>
<dl><dd><dl><dd><a  class="image"><img alt="OM named range list.png" src="../images/Named_Range/OM_named_range_list.png" width="497"  /></a></dd></dl></dd></dl>
<ul><li> 割り当てられた範囲が範囲名の横に表示されます。 </li>
<li> 名前付き範囲アイコンはスコープを示します。</li>
<li> 名前付き範囲をシングルクリックすると、ワークシート内の割り当てられた範囲がハイライトされます。</li>
<li> ハイライトされた名前付き範囲をダブルクリックすると<b>名前付き範囲の管理</b>が開きます。</li></ul>
<h2><a name="Using_Named_Range_in_Label_Rows"></a><span class="mw-headline">ラベル行で名前付き範囲を使用する</span></h2>
<p>名前付き範囲は、データ行または<a href="../../UserGuide/UserGuide/Displaying_Supporting_Data_in_Worksheet_header_Rows.html" title="ユーザガイド：ワークシートヘッダ行に表示するサポートデータ">列ラベル行（ヘッダ行）</a>のセルに定義できます。ラベル行での名前付き範囲の使用は、次のアプリケーションで役立ちます。
</p>
<ul><li> <b>列/セル式</b>: 名前付き範囲は、<a href="../../UserGuide/UserGuide/Quick_Start_SetColumnValues.html" title="ユーザーガイド：クイックスタート 列の設定">値の設定</a>の中や<a href="../../UserGuide/UserGuide/Using_Formulae_to_Set_Cell_Values.html" title="ユーザガイド：数式を使用してセル値を設定する">セル式</a>を定義する際に使用できます。</li>
<li> <b>参照線の定義</b>: <a href="../../UserGuide/UserGuide/Reference_Lines.html#Details_dialog_for_Reference_Lines" title="ユーザガイド：参照線"><b>値の種類</b></a>が<i>値</i>もしくは<i>式</i>に設定されている場合、参照線ダイアログで名前付き範囲を使用できます。</li>
<li> <b>関数グラフの定義</b>: 名前付き範囲は、関数グラフ式を定義するときに使用できます（<a href="../../UserGuide/UserGuide/The_(2D_Function_Plot)_Function_tab.html" title="ユーザガイド：（2D関数グラフ）の関数タブ">例：2D関数グラフ</a>）。</li></ul>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Named_Range/Tip_icon.png" width="57"  border="0" /></td><td><p><a href="#by_Define_Name_menu">名前付き範囲を定義</a>するときは、スコープに注意してください。たとえば、特定のシートまたはブックの計算内でのみ名前付き範囲を使用する場合は、スコープを<b>シート</b>または<b>ブック</b>に制限できます。これにより、別のシートまたはブックで同じ<b>名前</b>を使用できます。ただし、<a href="../../UserGuide/UserGuide/Reference_Lines.html" title="ユーザガイド：参照線">参照線</a>や<a href="../../UserGuide/Category/The_Function_Plot.html" title="カテゴリ：関数プロット">関数グラフ</a>で必要になるようにプロジェクト全体で名前付き範囲を使用するには、<b>スコープ</b>を<i>プロジェクト</i>に設定する必要があります。<a href="#Manage_Named_Ranges"><b>名前付き範囲の管理</b></a>を使用して、名前付き範囲のスコープをいつでも変更することができます。
</p></td></tr></table>
<h2><a name="Quick_tutorial"></a><span class="mw-headline">クイックチュートリアル</span></h2>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Named_Range/Tip_icon.png" width="57"  border="0" /></td><td><p>その他の使用例については、OriginLab のブログ投稿を参照してください。
</p>
<ul><li> <a class="external text" href="http://blog.originlab.com/names-in-origin-2022" target="_blank">Named Range in Origin 2022</a></li>
<li> <a class="external text" href="http://blog.originlab.com/named-range-for-fitting-parameters" target="_blank">Named Range for Fitting Parameters</a></li></ul>
</td></tr></table>
<p><br />
以下は、名前付き範囲で分析テンプレートを作成する簡単な例です。
</p>
<ol>
<li> 新しいワークブックを作成します。<b>データ:ファイルに接続:Text/CSV</b>メニューを選択し、サンプルデータの<i>&lt;EXE フォルダ&gt;\Samples\Signal Processing\Signal with High Frequency Noise.dat</i>をデフォルト設定のまま取り込みます。
<li> コネクタアイコン<a  class="image"><img alt="Dadta connector icon connect.png" src="../images/Named_Range/Dadta_connector_icon_connect.png" width="16"  /></a>をクリックし、コンテクストメニューから<b>保存時にインポートデータを除外</b>にチェックを入れます。
<li> C、D列の2列を追加します。C1に、テキスト<code>npts</code>を入力しますD1に、番号<code>10</code>を入力しますD1でクリックします。表示されるミニツールバーの<b>名前を定義</b>ボタンを選択します。  
<li> <b>新しい名前</b>ダイアログで、「npts」が名前編集ボックスに自動入力されます。<b>OK</b>をクリックします。
<dl><dd><a  class="image"><img alt="Named range example 1.png" src="../images/Named_Range/Named_range_example_1.png" width="624"  /></a></dd></dl>
<li> 列Aと列Bを選択します。メニューから<b><b>解析：信号処理：スムージング</b></b>と選択します。ダイアログで、<b>再計算</b>を<b>自動</b>と設定します。<b>ウィンドウのポイント数</b>にnptsと入力します。
<dl><dd><a  class="image"><img alt="Named range example 2.png" src="../images/Named_Range/Named_range_example_2.png" width="538"  /></a></dd></dl>
<li> <b>ファイル：ワークシートを分析テンプレートとして保存</b>メニューで、このブックを分析テンプレートとして保存します。 
<dl><dd><a  class="image"><img alt="Named range example 3.png" src="../images/Named_Range/Named_range_example_3.png" width="455"  /></a></dd></dl>
</ol>


    