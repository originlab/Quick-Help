<h1 class="firstheading">アルゴリズム (Moodのメディアン検定)</h1>
<p><br />
以下の説明は、NAGのアルゴリズムから引用したものです。</p>
<p>メディアン検定は、<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(median)/math-07ab8bd2ced78ca04d507625c0c5c584.png" title="K\,\!" alt="K\,\!" class="tex" border="0" /></span>サンプルサイズ <span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(median)/math-e3892b2f81bff2a1c12e4f5fc4137fdd.png" title="n_1,n_2,...,n_k\,\!" alt="n_1,n_2,...,n_k\,\!" class="tex" border="0" /></span>を持つ次のように表される2つ以上の独立した標本間の差を調べるものです。</p>
<p style="line-height: 19.2px; orphans: auto;"><span style="widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(median)/math-efdfa1d8d399dc969bdb8d05cf79116c.png" title="x_1,x_2,....x_{n_1};x_{n_1+1},x_{n_1+2},...,x_{n_1+n_2};...;x_{n_1+n_2+...+n_{i-1}+1},...x_{n_1+n_2+...+n_i}" alt="x_1,x_2,....x_{n_1};x_{n_1+1},x_{n_1+2},...,x_{n_1+n_2};...;x_{n_1+n_2+...+n_{i-1}+1},...x_{n_1+n_2+...+n_i}" class="tex" border="0" /></span></p>
<p>メディアンの値はユーザが与えるのではなく、すべてのグループを組み合わせたデータが保存され、そこからメディアンが次式を使って計算されます。</p>
<p>nが偶数の場合、<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(median)/math-de826035b962a7fd5705d750b9fd0d83.png" title="md=(x_{(n/2)}+x_{(n/2+1)})/2\,\!" alt="md=(x_{(n/2)}+x_{(n/2+1)})/2\,\!" class="tex" border="0" /></span>；nが奇数の場合、<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(median)/math-5376086378bef4c420780f8f4edd4b1d.png" title="md=x_{((n+1)/2)}\,\!" alt="md=x_{((n+1)/2)}\,\!" class="tex" border="0" /></span></p>
<p>ここで <span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(median)/math-cf499856225c05cdde6e54eb4dbcf6d7.png" title="n= \sum_{i=1}^k n_i" alt="n= \sum_{i=1}^k n_i" class="tex" border="0" /></span>となり、<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(median)/math-4d70cdaba8c6afb7571ebd312961e90f.png" title="x_{(1)},...,x_{(n)}\,\!" alt="x_{(1)},...,x_{(n)}\,\!" class="tex" border="0" /></span> は、すべての観測データを小さい方から大きい方に並べたデータです。</p>
<p>検定は、プールドサンプルのメディアンの上下にいける各標本の度数表を作成します。</p>
<table class="simple" width="63.36%">
<col style="width: 21.736%;" />
<col style="width: 16.301%;" />
<col style="width: 17.017%;" />
<col style="width: 15.157%;" />
<col style="width: 16.588%;" />
<col width="92" />
<tr>
<td>&#160;</td>
<td>標本1</td>
<td>標本2</td>
<td>……</td>
<td>標本K</td>
<td>合計</td>
</tr>
<tr>
<td><img src="../images/Algorithm_(median)/math-a2420521c0cb4d3b8fa937126d55adf9.png" title="Score \le md" alt="Score \le md" class="tex" border="0" /></td>
<td><img src="../images/Algorithm_(median)/math-1e796779bf5356266616c75e9ca23c69.png" title="n_{11}\,\!" alt="n_{11}\,\!" class="tex" border="0" /></td>
<td><img src="../images/Algorithm_(median)/math-8ea602aa47643a586c7ad5d3a7f92436.png" title="n_{12}\,\!" alt="n_{12}\,\!" class="tex" border="0" /></td>
<td>&#160;</td>
<td><img src="../images/Algorithm_(median)/math-498c7aedd5e9fd58c13dfe3b65c1aabd.png" title="n_{1k}\,\!" alt="n_{1k}\,\!" class="tex" border="0" /></td>
<td><img src="../images/Algorithm_(median)/math-f3e66ae4ff878c7732ac9e70740a05e5.png" title="R_{1}\,\!" alt="R_{1}\,\!" class="tex" border="0" /></td>
</tr>
<tr>
<td><img src="../images/Algorithm_(median)/math-7f3acb829bee05cb06afa7c68c824143.png" title="Score &gt; md\,\!" alt="Score &gt; md\,\!" class="tex" border="0" /></td>
<td><img src="../images/Algorithm_(median)/math-8115c272068040fbf82f5a6329571ae2.png" title="n_{21}\,\!" alt="n_{21}\,\!" class="tex" border="0" /></td>
<td><img src="../images/Algorithm_(median)/math-e17f0b1c025b09b2770ffc8957450930.png" title="n_{22}\,\!" alt="n_{22}\,\!" class="tex" border="0" /></td>
<td>&#160;</td>
<td><img src="../images/Algorithm_(median)/math-2187cbcffb8d9747727f583b4cec1183.png" title="n_{2k}\,\!" alt="n_{2k}\,\!" class="tex" border="0" /></td>
<td><img src="../images/Algorithm_(median)/math-78a63178b657eaea9b89208cb48f9a18.png" title="R_{2}\,\!" alt="R_{2}\,\!" class="tex" border="0" /></td>
</tr>
<tr>
<td><b style="font-weight: bold;">合計</b></td>
<td><img src="../images/Algorithm_(median)/math-7ae76161358672724be28c2a08a628ab.png" title="n_{1}\,\!" alt="n_{1}\,\!" class="tex" border="0" /></td>
<td><img src="../images/Algorithm_(median)/math-c133b543b65a4bc86c423aea7e6eb74a.png" title="n_{2}\,\!" alt="n_{2}\,\!" class="tex" border="0" /></td>
<td>&#160;</td>
<td><img src="../images/Algorithm_(median)/math-9b28262783cadfc3813abd0bc2299236.png" title="n_{k}\,\!" alt="n_{k}\,\!" class="tex" border="0" /></td>
<td><img src="../images/Algorithm_(median)/math-baa52b85c066dbd5eeff3c078a69205b.png" title="n\,\!" alt="n\,\!" class="tex" border="0" /></td>
</tr>
</table>
<p>すべての非空の標本に対する<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(median)/math-cfebfa945941b02f58dc453d7b14aeb5.png" title="x^2\,\!" alt="x^2\,\!" class="tex" border="0" /></span> の統計量は次の式で計算されます。</p>
<p><span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(median)/math-ef2be729a791fb8acec1fd6850edf7d8.png" title="x^2=\sum_{j=1}^k\sum_{i=1}^2(n_{ij}-e_{ij})^2/e_{ij}\,\!" alt="x^2=\sum_{j=1}^k\sum_{i=1}^2(n_{ij}-e_{ij})^2/e_{ij}\,\!" class="tex" border="0" /></span>となり、<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(median)/math-de73c78d7e86e0f4bfc60f8827595940.png" title="e_{ij}=R_in_j/n\,\!" alt="e_{ij}=R_in_j/n\,\!" class="tex" border="0" /></span>です。</p>
<p>有意水準は、 <span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(median)/math-cfebfa945941b02f58dc453d7b14aeb5.png" title="x^2\,\!" alt="x^2\,\!" class="tex" border="0" /></span>分布(自由度<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(median)/math-4dd90bab747a167e7975e1f8fb397a4d.png" title="k-1\,\!" alt="k-1\,\!" class="tex" border="0" /></span> )からのもので、<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(median)/math-4dd90bab747a167e7975e1f8fb397a4d.png" title="k-1\,\!" alt="k-1\,\!" class="tex" border="0" /></span> は非空の標本の数です。セルが1より小さい期待値を持つ場合、または20%以上のセルが5より小さい期待値を持つ場合、メッセージが出力されます。</p>
<p><br /></p>
