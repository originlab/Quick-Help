<h1 class="firstheading">ユーザ定義フィット関数</h1>
<p class="urlname" style="display: none;">UserDef-FitFunc</p>
<div style="text-align: left; direction: ltr; margin-left: 1em;">
	<p><a class="image"><img alt="Video Image.png" src="../images/User-Defined_Fitting_Functions/Video_Image.png" 
							 width="33" border="0" /></a> 関連する動画はこちら：<a 
	 class="external text" href="http://www.originlab.com/index.aspx?go=Products/Origin/DataAnalysis/CurveFitting/FittingFunctions&amp;ss=chm&amp;pid=1172" 
	 target="_blank">ユーザ定義関数</a> </p>
</div>
<p>Originには組み込みフィット関数がある一方で、ツールを使ってユーザ独自のフィット関数を定義することができます。 </p>
<ul>
	<li><a class="external text" href="http://originlab.com/fileExchange/details.aspx?fid=239" 
			 target="_blank"><b>Simple Fit</b>アプリ</a> 
	<dl>
		<dd><b>Simple Fit</b>アプリはOriginにプリインストールされているアプリで、グラフウィンドウがアクティブなときに、簡単に<a 
		 class="external text" href="../../UserGuide/UserGuide/Apps.html#The_Apps_Gallery"><b>アプリギャラリー</b></a>から呼び出すことができます。このアプリは、式<b>y 
		 = f（x）</b>で単純な関数を近似する非常に便利な方法を提供します。数式を入力し（または既存の関数を選択し）、初期値を指定して、すぐに近似レポートを生成するだけです。</dd>
		<dd><a class="image"><img alt="Define Function Using Simple Fit App.png" 
									 src="../images/User-Defined_Fitting_Functions/800px-Define_Function_Using_Simple_Fit_App.png" 
									 width="1571" height="594" border="0" /></a></dd>
	</dl></li>
	<li><a href="../../UserGuide/UserGuide/The_Fitting_Function_Organizer_Dialog_Box.html" 
			 title="ユーザガイド:フィット関数オーガナイザダイアログボックス"><b>フィット関数オーガナイザ</b></a> 
	 </li>
	<li><a href="../../UserGuide/Category/The_Fitting_Function_Builder.html" 
			 title="カテゴリー:フィット関数ビルダ"><b>フィット関数ビルダ</b></a></li>
</ul>
<p><br />
このページでは、使いやすいウィザード形式の<a href="../../UserGuide/Category/The_Fitting_Function_Builder.html" 
						 title="カテゴリー:フィット関数ビルダ"><b>フィット関数ビルダー</b></a>を使用して、ユーザ定義のフィット関数を作成する方法を紹介します。このウィザードは、<a 
	 href="../../UserGuide/UserGuide/The_Goal_Page.html" title="ユーザガイド:処理のゴールページ"> 
 処理のゴール</a>、<a href="../../UserGuide/UserGuide/The_Name_and_Type_Page.html" 
				 title="ユーザガイド:関数名と関数形式ページ"> 関数名と関数形式</a>、<a href="../../UserGuide/UserGuide/The_Variables_and_Parameters_Page.html" 
															 title="ユーザガイド:変数とパラメータページ">変数とパラメータ</a>、<a 
	 href="../../UserGuide/UserGuide/The_Function_Body_Page.html" title="ユーザガイド:式形式の関数ページ">関数本体のページ</a>、<a 
	 href="../../UserGuide/UserGuide/The_Parameter_Initialization_Code_Page.html" 
	 title="ユーザガイド:パラメータ初期化ルーチンページ">パラメータ初期化ルーチン</a>、<a href="../../UserGuide/UserGuide/The_Bounds_and_General_Linear_Constrains_Page.html" 
														 title="ユーザガイド:境界線と一般線形制約ページ">境界と一般線形制約のページ</a>、<a 
	 href="../../UserGuide/UserGuide/The_Derived_Parameters.html" title="ユーザガイド：派生パラメータ">派生パラメータのページ</a>、<a 
	 href="../../UserGuide/UserGuide/The_Script_Before_Or_After_Fitting_Page.html" 
	 title="ユーザガイド:フィット前後のスクリプトページ">フィット前後のスクリプト</a>の8ページで構成されています。最初の4ページは、いくつかの設定を行う必要があり、設定しないと次のページに進めません。4番目の<b>式形式の関数</b>ページで設定した後は、以降の設定を行わなくても関数を作成できます。もちろん残りの4ページの設定を継続することもできます。 
 </p>
<p><b>フィット関数ビルダー</b>は、各ページの左側のパネルに役立つヒントとサンプルが表示されるので、簡単に使用、習得できます。ウィザードの各ページで何ができるか確認したら、フィット関数を作成する方法を明確に理解できます。左側のページでは、ユーザ定義のフィット関数を作成するための一般的な手順と、各ページで何ができるかを説明しています。操作方法については、<a 
	 href="../../UserGuide/UserGuide/A_Simple_Example_to_Show_You_How_to_Create_A_New_Fitting_Function_with_The_Fitting_Function_Builder.html" 
	 title="ユーザガイド:フィット関数ビルダーを使用して新しいフィット関数を作成する簡単なサンプル"><b>こちら</b></a>からのチュートリアルを確認できます。また、新しく作成された関数に対しては、Originは<a 
	 href="../../UserGuide/UserGuide/The_User_Files_Folder.html" title="ユーザガイド:ユーザファイルフォルダ">ユーザファイルフォルダ</a>のFitFuncフォルダに関連したFDFファイルを作成します。作成した関数は、非線形曲フィットのダイアログで使用できるようになります。 
 </p>
<dl>
	<dd><a class="image"><img alt="Ffb home 1.png" src="../images/User-Defined_Fitting_Functions/Ffb_home_1.png" 
								 width="863" border="0" /></a></dd>
</dl>
<div id="toc" class="toc">
	<div id="toctitle">
		<h2>目次</h2>
	</div>
	<ol>
		<li class="toclevel-1 tocsection-1"><a href="#General_Steps_to_Create_a_New_Fitting_Function"><span 
		 class="tocnumber">1</span> <span class="toctext">新しいフィット関数を作成する一般的な手順</span></a></li>
		<li class="toclevel-1 tocsection-2"><a href="#Opening_the_Fitting_Function_Builder"><span 
		 class="tocnumber">2</span> <span class="toctext">フィット関数ビルダーを開く</span></a></li>
		<li class="toclevel-1 tocsection-3"><a href="#What_You_Can_Do_in_the_Goal_Page"><span 
		 class="tocnumber">3</span> <span class="toctext"><i>処理のゴール</i>ページでできること</span></a></li>
		<li class="toclevel-1 tocsection-4"><a href="#What_You_Can_Do_in_the_Name_and_Type_Page"><span 
		 class="tocnumber">4</span> <span class="toctext"><i>関数名と関数形式</i>ページでできること</span></a> 
		 
		<ol>
			<li class="toclevel-2 tocsection-5"><a href="#Create_a_Function_Category"><span 
			 class="tocnumber">4.1</span> <span class="toctext">新しい関数カテゴリーを作成する</span></a></li>
			<li class="toclevel-2 tocsection-6"><a href="#Choose_a_Function_Type"><span 
			 class="tocnumber">4.2</span> <span class="toctext">関数の形式を選択する</span></a></li>
		</ol></li>
		<li class="toclevel-1 tocsection-7"><a href="#What_You_Can_Do_in_the_Variables_and_Parameters_Page"><span 
		 class="tocnumber">5</span> <span class="toctext"><i>変数とパラメータ</i>ページでできること</span></a></li>
		<li class="toclevel-1 tocsection-8"><a href="#What_You_Can_Do_in_the_Function_Body_Page"><span 
		 class="tocnumber">6</span> <span class="toctext"><i>関数本体</i>のページでできること</span></a> 
		 
		<ol>
			<li class="toclevel-2 tocsection-9"><a href="#Input_Function_Body"><span 
			 class="tocnumber">6.1</span> <span class="toctext">関数本体を入力する</span></a></li>
			<li class="toclevel-2 tocsection-10"><a href="#Editing_the_Function_in_Code_Builder"><span 
			 class="tocnumber">6.2</span> <span class="toctext">コードビルダで関数を編集する</span></a></li>
			<li class="toclevel-2 tocsection-11"><a href="#Evaluate_the_Function"><span 
			 class="tocnumber">6.3</span> <span class="toctext">関数を評価する</span></a></li>
		</ol></li>
		<li class="toclevel-1 tocsection-12"><a href="#What_You_Can_Do_in_the_Parameter_Initialization_Code_Page"><span 
		 class="tocnumber">7</span> <span class="toctext"><i>パラメータ初期化ルーチン</i>ページでできること</span></a></li>
		<li class="toclevel-1 tocsection-13"><a href="#What_You_Can_Do_in_the_Bounds_and_General_Linear_Constrains_Page"><span 
		 class="tocnumber">8</span> <span class="toctext"><i>境界と一般線形制約</i>のページでできること</span></a></li>
		<li class="toclevel-1 tocsection-14"><a href="#What_You_Can_Do_in_the_Derived_Parameters_Page"><span 
		 class="tocnumber">9</span> <span class="toctext"><i>派生パラメータ</i>のページでできること</span></a></li>
		<li class="toclevel-1 tocsection-15"><a href="#What_You_Can_Do_in_the_Script_Before_or_After_Fitting_Page"><span 
		 class="tocnumber">10</span> <span class="toctext"><i>フィット前後のスクリプト</i>ページでできること</span></a></li>
	</ol>
</div>
<h2><a name="General_Steps_to_Create_a_New_Fitting_Function"></a><span 
	 class="mw-headline">新しいフィット関数を作成する一般的な手順</span></h2>
<p>フィット関数作成は次のような操作で行います。操作方法については、<a href="../../UserGuide/UserGuide/A_Simple_Example_to_Show_You_How_to_Create_A_New_Fitting_Function_with_The_Fitting_Function_Builder.html" 
										 title="ユーザガイド:フィット関数ビルダーを使用して新しいフィット関数を作成する簡単なサンプル"><b>こちら</b></a>からのチュートリアルを確認できます。 
 </p>
<ol>
	<li><b>フィット関数ビルダー</b>を開き、最初の<b>処理のゴール</b>ページで<b>新しい関数の作成</b>を選択します。<b>進む</b>をクリックし、<b>関数名と関数形式</b>ページに移動します。</li>
	<li><b>関数名と関数形式</b>ページで、新しい関数のカテゴリーを作成/選択し、<b>関数名</b>編集ボックスに関数の名前を入力します。 
	 オプションで、<b>説明</b>編集ボックスにコメントを追加できます。また、実際の状況に応じて適切な<b>関数形式</b>を選択します。進むをクリックし、<b>変数とパラメータ</b>ページに移動します。 
	 
	<table class="noborder">
		<tr>
			<td style="vertical-align: top;" width="60"><img src="../images/User-Defined_Fitting_Functions/Tip_icon.png" 
															 alt="" width="57" 
															 border="0" /></td>
			<td><p><b>外部DLL関数</b>を作成する場合は、<a href="../../UserGuide/UserGuide/Using_External_DLLs.html" 
											 title="ユーザガイド：外部DLLを使う">外部DLLの使用</a>を参照し、<i>FittingWithExternalDLL.opx</i>のドキュメントを確認してください。 
			 </p></td>
		</tr>
	</table></li>
	<li><b>変数とパラメータ</b>ページで、<b>独立変数</b>、<b>従属変数</b>、および<b>パラメータ</b>の名前を指定する必要があります。また、このページでは<b>派生パラメータ</b>と<b>定数</b>を定義することができます。ピークアナライザーでピークをフィットする、またはNLFitツールで複数のピークをフィットするための複製を行うための関数として定義する場合は、<b>ピーク関数</b>チェックボックスにチェックを付ける必要があります。進むをクリックし、<b>式形式の関数</b>ページに移動します。</li>
	<li><b>式形式の関数</b>ページでは、<b>パラメータ</b>タブと<b>定数</b>タブで、パラメータと定数の初期値を手動で設定できます。前のページで<b>ピーク関数</b>にチェックを使た場合は、<b>パラメータ</b>タブの<b>ピーク属性</b>を選択する必要があります。<b>関数式</b>編集ボックスに関数の式を入力する必要があります。<b>関数名と関数形式</b>ページで<b>関数形式</b>として<b>Origin 
	 C</b>を選択した場合は、<b>コードビルダ</b>を使用して関数を定義できて便利です。このページでの設定が完了したら、<b>完了</b>ボタンをクリックして関数作成の操作を終了できます。<b>進む</b>ボタンをクリックした場合、ウィザードの左側のページで他の設定を実行できます。 
	 </li>
	<li>最後の4ペーの[<b>パラメータ初期化ルーチン</b>ページ、<b>境界条件と一般線形制約</b>ページ、<b>派生パラメータ</b>ページ、<b>フィット前後のスクリプト</b>ページはオプションのページなので、それぞれで設定するか、無視して次へ 
	 / 完了ボタンをクリックして進むことができます。 </li>
	<li>このページでの設定が完了したら、完了ボタンをクリックして関数を保存します。</li>
</ol>
<h2><a name="Opening_the_Fitting_Function_Builder"></a><span class="mw-headline"><b>フィット関数ビルダ</b>を開く</span></h2>
<p>フィット関数ビルダーは、以下の操作で開けます。 </p>
<ul>
	<li>メインメニューの<b>ツール：フィット関数ビルダー</b>を選択するか、<b>F8</b>キーを押します。</li>
	<li><b>フィット関数オーガナイザ</b>ダイアログボックスの<b>ビルダー</b>ボタンをクリックします。</li>
	<li><b>非線形曲線フィット</b>ダイアログボックスの<b>新規関数作成</b>ボタン<a class="image"><img 
	 alt="Ffb nlfit createnew.png" src="../images/User-Defined_Fitting_Functions/Ffb_nlfit_createnew.png" 
	 width="26" border="0" /></a>をクリックします。</li>
</ul>
<h2><a name="What_You_Can_Do_in_the_Goal_Page"></a><span class="mw-headline"><i>処理のゴール</i>ページでできること</span></h2>
<p><b>処理のゴール</b>ページはウィザードの最初のページであり、処理の<b>目的</b>として<b>新しい関数の作成</b>か、<b>ユーザ定義関数の編集</b>を選択します。ユーザ定義関数を作成する場合には、<b>新しい関数の作成</b>を選択します。このページ設定の詳細については、<a 
	 href="../../UserGuide/UserGuide/The_Goal_Page.html" title="ユーザガイド:処理のゴールページ">処理のゴール</a>ページを参照してください。 
 </p>
<h2><a name="What_You_Can_Do_in_the_Name_and_Type_Page"></a><span class="mw-headline"><i>関数名と関数形式</i>ページでできること</span></h2>
<p><b>関数名と関数形式</b>ページは2番目のページで、関数カテゴリーを選択/作成でき、関数の名前を指定して関数の形式を選択します。このページ設定の詳細については、<a 
	 href="../../UserGuide/UserGuide/The_Name_and_Type_Page.html" title="ユーザガイド:関数名と関数形式ページ">関数名と関数形式</a>ページを参照してください。次の2つの設定に注意してください。 
 </p>
<h3><a name="Create_a_Function_Category"></a><span class="mw-headline">新しい関数カテゴリーを作成する</span></h3>
<p>カテゴリーの作成は以下のように行います。 </p>
<ol>
	<li><b>関数カテゴリーの選択/新規名称</b>の項目の隣にある<b>作成</b>ボタンをクリックします。</li>
	<li>カテゴリー名を<b>名前</b>編集ボックスに入力します。</li>
	<li>OKボタンをクリックして保存します。</li>
</ol>
<table class="note">
	<tr>
		<td><b>Note:</b> Origin 2018からこのカテゴリ情報もFDFファイルに保存されます。FDFファイルを共有し、他のOriginプログラムにFDFファイルをドラッグ&amp;ドロップして関数をインストールすると、同じカテゴリに保存されます。 
		 
		<p>以前のバージョンでは、カテゴリーの情報はFDFファイルに保存されなかったため、ドラッグ&amp;ドロップによるインストール時に<b>追加関数のカテゴリを選択</b>ダイアログが開き、カテゴリーを指定する必要がありました。 
		 </p></td>
	</tr>
</table>
<h3><a name="Choose_a_Function_Type"></a><span class="mw-headline">関数の形式を選択する</span></h3>
<p><b>関数形式</b>グループから適切な関数のタイプを選択します。下表でそれらの違いを示します。 </p>
<table class="simple">
	<tr>
		<th>定義形式 </th>
		<th width="250">例 </th>
		<th>コメント </th>
	</tr>
	<tr>
		<td><b>LabTalk算術式</b> </td>
		<td><dl>
			<dd><i>a + b * exp( -x^c / d )</i></dd>
		</dl></td>
		<td>このオプションは1つの従属変数だけを持つ単純なフィット関数です。関数の本体は、1つの式に限られ、式の右側だけを記述します。このオプションは、<b>Origin 
		 C</b>よりも高速なパフォーマンスを提供します。 </td>
	</tr>
	<tr>
		<td><b>Python関数 (scalar)</b> </td>
		<td><dl>
			<dd><i>y = py.pyline(x, a, b);</i></dd>
		</dl></td>
		<td>このオプションは、<b>Python関数（Vector）</b>よりも遅いため、小さいデータセットをフィッティングする場合にのみ選択してください。関数を作成するとき、関数名の前に&quot;py.&quot; 
		 を追加する必要があります。 </td>
	</tr>
	<tr>
		<td><b>Python関数 (Vector)</b> </td>
		<td><dl>
			<dd><i>y=pyGaussVectorEq(x,y0,xc,A,w);</i></dd>
		</dl></td>
		<td>大きなデータセットのフィットを行う場合このオプションを選択します。関数は、呼び出し中に各独立変数の独立値の配列（リストの形式）を受け取り、各従属変数の配列（リストの形式）を返します。このオプションはLabTalk処理を使用しないため比較的高速です。 
		 </td>
	</tr>
	<tr>
		<td><b>LabTalk方程式</b> </td>
		<td><dl>
			<dd><i>temp = 10;</i></dd>
			<dd><i>y1 = A + exp( (x1 - xc) / temp^2 );</i></dd>
			<dd><i>y2 = A + temp / (x2 - xc)^2;</i></dd>
		</dl></td>
		<td>このオプションは、複数行必要な場合や1つ以上の従属変数がある場合に使用します。このオプションは、loopやif-elseステートメントのような制御構造はサポートしません。しかし、三項演算子は使うことができます。このオプションは、<b>Origin 
		 C</b>よりも高速なパフォーマンスを提供します。 </td>
	</tr>
	<tr>
		<td><b>Origin C</b> </td>
		<td><dl>
			<dd><i>if ( x &lt; -PI )</i> 
			<dl>
				<dd><i>y = y0 + exp( -x-a*PI );</i></dd>
			</dl></dd>
			<dd><i>else if ( x &gt; PI )</i> 
			<dl>
				<dd><i>y = y0 + exp( x-a*PI );</i></dd>
			</dl></dd>
			<dd><i>else</i> 
			<dl>
				<dd><i>y = cos(x);</i></dd>
			</dl></dd>
		</dl></td>
		<td>このオプションは<b>算術式</b>より遅くなります。フィット関数が三項演算子では表せないloopや制御構造を必要とする場合、このオプションを選択します。厳密なC言語のシンタックスに従う必要があります。パラメータは大文字小文字を区別し、int型の除算とdouble型の除算は異なるものとして認識します。 
		 </td>
	</tr>
	<tr>
		<td><b>LabTalkスクリプト</b> </td>
		<td><dl>
			<dd><i>range rr =&#160;%C;</i></dd>
			<dd><i>int b =&#160;%(rr[P1]$);</i></dd>
			<dd><i>y = b + a*x;</i></dd>
		</dl></td>
		<td>このオプションは方程式やOrigin Cより遅くなります。制御構造が必要で、C言語に不慣れな場合、このオプションを選択してください。 
		 </td>
	</tr>
	<tr>
		<td><b>外部DLL関数</b> </td>
		<td>&#160;</td>
		<td>このオプションは、外部DLLを使ってフィット関数を定義します。外部DLLを使うと、フィット時間を向上させることができます。この関数形式についての詳細は、<a 
		 href="../../UserGuide/UserGuide/Using_External_DLLs.html" title="ユーザガイド：外部DLLを使う"><b>外部DLLを使う</b></a>を参照してください。 
		 </td>
	</tr>
</table>
<table class="note">
	<tr>
		<td><b>Note:</b> Origin C関数を作成するとき、コードの前に次のステートメントを含めることが良い慣習となっています。 
		 
		<pre class="oc" style="font-family: monospace;">
<span style="color: #0000ff;">#pragma</span> numlittype<span style="color: #000000;">(</span>push, <span style="color: #0000ff;">TRUE</span><span style="color: #000000;">)</span>
		</pre>
		<p>すると、Originは整数-3を浮動小数点数- 3.0として扱います。これは、他の関数形式をOrigin Cに変換する場合に非常に便利です。LabTalkでは、3/2 
		 = 1.5ですが、標準のCでは1です。<i>#Pragma</i> ステートメントは、関数形式を変更したときに一貫性を保つ上で便利です。 
		 </p></td>
	</tr>
</table>
<h2><a name="What_You_Can_Do_in_the_Variables_and_Parameters_Page"></a><span 
	 class="mw-headline"><i>変数とパラメータ</i>ページでできること</span></h2>
<p><b>変数とパラメータ</b>ページは、3番目のページで、独立変数、従属変数、パラメータ(派生パラメータを含む)、定数を定義します。このページ設定の詳細については、<a 
	 href="../../UserGuide/UserGuide/The_Variables_and_Parameters_Page.html" 
	 title="ユーザガイド:変数とパラメータページ">変数とパラメータ</a>ページを参照してください。 </p>
<table class="note">
	<tr>
		<td><b>Note:</b> <b>ピークアナライザ</b>のピークフィット用の関数またはNLFitの複製フィットを行う関数を使う場合、または<b>非線形フィット</b>で複製フィットをする場合、このページの<b>ピーク関数</b>チェックボックスにチェックを入れる必要があります。 
		 
		<p>ピーク関数のパラメータの場合は、次のページで特別なピーク属性を設定する必要があります。パラメータリストの最初のパラメータには「y0」という名前を付け、ピーク属性「offset」を割り当てる必要があります。「y0」に加え、ピークの属性として、「X中心」、「幅」、「振幅/面積」の少なくとも3つのパラメータを定義する必要があります。次は、ピーク関数のサンプルです。 
		 </p>
		<dl>
			<dd><i>y = y0 + (2*A/PI)(w/(4*(x-xc)^2 + w^2)) </i></dd>
		</dl></td>
	</tr>
</table>
<h2><a name="What_You_Can_Do_in_the_Function_Body_Page"></a><span class="mw-headline"><i>関数本体</i>のページでできること</span></h2>
<p><b>関数本体</b>ページは4番目のページで、関数を入力し、初期値の入力や固定などのパラメータのいくつかの基本設定を行います。ピークフィット関数を定義したければ、このページでパラメータのピーク属性を選択します。また、このページでフィット関数の動作を評価できます。このページ設定の詳細については、<a 
	 href="../../UserGuide/UserGuide/The_Function_Body_Page.html" title="ユーザガイド:式形式の関数ページ">関数本体</a>ページを参照してください。 
 </p>
<h3><a name="Input_Function_Body"></a><span class="mw-headline">関数本体を入力する</span></h3>
<p><b>関数名と関数形式</b>ページで紹介したように関数タイプは5つあり、それぞれに独自の形式で関数本体を定義します。フィット関数の記述の際には、<b>関数名と関数形式</b>ページの指示に従うか、関数本体ページの左側のパネルからヒントを参照してください。 
 </p>
<table class="note">
	<tr>
		<td><b>Note:</b> 新しい関数を作成するとき、ユーザは、<b>nlf_<i>FuncName</i></b>を使って、組み込み関数を引用することができます。例えば、以下のような関数を定義します。<br />
		
		<dl>
			<dd>y1 = nlf_Expdec1(x, y01, A11, t1);<br />
			</dd>
		</dl>
		<p>ここで、<b>nlf_Expdec1</b> は、組み込み関数の<b>ExpDec1</b>です。 </p></td>
	</tr>
</table>
<h3><a name="Editing_the_Function_in_Code_Builder"></a><span class="mw-headline">コードビルダで関数を編集する</span></h3>
<p><b>関数名と関数形式</b>ページで<b>Origin C</b>が選択されていたら、コードビルダでコードを編集します。<b>関数本体</b>編集ボックスの右上隅にあるボタン<a 
	 class="image"><img alt="User-Defined Fitting Functions-2.png" src="../images/User-Defined_Fitting_Functions/User-Defined_Fitting_Functions-2.png" 
						 width="19" border="0" /></a>をクリックすると、コードビルダが開きます。このときのウィンドウの名前は_nlf<i>functionName</i>.fitとなります。例えば、次図の場合、ウィンドウの名は_nlfAsymmetricGaussian.fitとなっています。このウィンドウの中で関数本体を編集できます。 
 </p>
<dl>
	<dd><a class="image"><img alt="User-Defined Fitting Functions-3.png" 
								 src="../images/User-Defined_Fitting_Functions/User-Defined_Fitting_Functions-3.png" 
								 width="720" border="0" /></a></dd>
</dl>
<p>コードの最初の数行は、フィット関数のコンパイルに必要なさまざまなヘッダファイルを識別する<b>#include</b>ステートメントです。この例では、実際の関数定義は次のステートメントで始まります。 
 </p>
<pre class="oc" style="font-family: monospace;">
<span style="color: #0000ff;">void</span> _nlsfAsymmetricGaussian
</pre>
<p>パラメータ、独立変数、および従属変数は、この関数定義の最初で宣言されています。 これらの宣言の後に、関数定義を入力するための編集可能なセクション（白い領域）があります。 
 </p>
<p>上の図では、サンプルとして非対称ガウス関数を定義しています。関数定義はCプログラミング言語の構文に準拠している必要があることに注意してください。たとえば、パラメータとすべての変数タイプでは大文字と小文字を区別します。中間変数（この例ではBなど）は、最初に次のようなステートメントを使用して宣言する必要があります。 
 </p>
<pre class="oc" style="font-family: monospace;">
<span style="color: #0000ff;">double</span> B;
</pre>
<p>この宣言は、変数が関数定義で使用される前に行ってください。 </p>
<p>関数のタイプは<b>void</b>であり、関数から値が返されないことを示しています。代わりに、従属変数値が関数コード内に設定されます。この例では、従属変数yには、xが重心パラメーターxcより小さいか大きいかに応じて異なる値が割り当てられます。 
 </p>
<p>関数を定義したら、構文が正しいか確認する必要があります。 コードビルダの上の方にある<b>コンパイル</b>ボタンをクリックするとテストできます。 
 コンパイルプロセスでのエラーは、ワークスペースの下部にあるコードビルダの出力ウィンドウに表示されます。ファイルが正常にコンパイルされた場合にもこのウィンドウに表示されます。 
 </p>
<p>関数を定義してコンパイルしたら、ウィンドウの上部にある<b>NLSFに戻る</b>ボタンをクリックして、関数フィット関数ビルダに戻れます。これによりコードビルダは終了します。 
 </p>
<p><br />
</p>
<h3><a name="Evaluate_the_Function"></a><span class="mw-headline">関数を評価する</span></h3>
<p><b>関数本体</b>ページの下部に、関数の動作を確認するために立つ<b>クイックチェック</b>というコントロールグループがあります。最初に、このページの<b>パラメータ</b>タブの<b>初期値</b>列に値を入力してから、<b>クイックチェック</b>グループの独立変数編集ボックスに値を入力します。<a 
	 class="image"><img alt="Ffb evaluate.png" src="../images/User-Defined_Fitting_Functions/Ffb_evaluate.png" 
						 width="23" border="0" /></a>ボタンを押し、従属変数の出力値を確認します。関数の内容に誤りがあったり、パラメータや変数に不適切な値を与えると、出力ボックスは欠損値とエラーメッセージを返します。 
 </p>
<h2><a name="What_You_Can_Do_in_the_Parameter_Initialization_Code_Page"></a><span 
	 class="mw-headline"><i>パラメータ初期化ルーチン</i>ページでできること</span></h2>
<p><b>パラメータ初期化ルーチン</b>ページは、5番目のページで、フィット関数パラメータの初期値を計算するための入力コードを実行します。このページはオプションなので、他の設定をするために<b>進む</b>ボタンをクリックして次のページに進んでも構いません。 
 このページ設定の詳細については、<a href="../../UserGuide/UserGuide/The_Parameter_Initialization_Code_Page.html" 
					 title="ユーザガイド:パラメータ初期化ルーチンページ">パラメータ初期化ルーチン</a>ページを参照してください。 
 </p>
<p>非線形曲線フィットで使用される反復法では、すべてのパラメータの初期値を指定する必要があります。良好なパラメータ初期値により、高速で信頼できるモデル/データの収束を得ることができます。新しい関数を定義するときにパラメータの初期化を制御する方法は2つあります。 
 </p>
<ul>
	<li><b>関数本体</b>ページの<b>パラメータ</b>タブで固定初期値を割り当てます。</li>
	<li><i>パラメータ初期化コード</i>に初期値を推定すための<b>初期化コード</b>を入力します。 </li>
</ul>
<p><a href="../../UserGuide/UserGuide/Parameter_Initialization.html" title="ユーザガイド:パラメータ初期化">パラメータ初期化</a>セクションのパラメータ値の初期化についての説明を確認してください。 
 初期値またはコードは、フィット関数の定義において必須ではありません。 ただし、パラメータ初期化がフィット関数ファイルで処理されない場合は、<b>NLFit</b>ダイアログボックスにおいてこの関数でフィットするときに手動で初期値を設定する必要があります。 
 </p>
<h2><a name="What_You_Can_Do_in_the_Bounds_and_General_Linear_Constrains_Page"></a><span 
	 class="mw-headline"><i>境界と一般線形制約</i>のページでできること</span></h2>
<p><b>境界と一般線形制約</b>ページは6番目のページで、フィット関数のパラメータに対する境界と線形制約を入力します。このページはオプションなので、他の設定をするために<b>進む</b>ボタンをクリックして次のページに進んでも構いません。 
 このページ設定の詳細については、<a href="../../UserGuide/UserGuide/The_Bounds_and_General_Linear_Constrains_Page.html" 
					 title="ユーザガイド:境界線と一般線形制約ページ">境界と一般線形制約</a>ページを参照してください。 
 </p>
<h2><a name="What_You_Can_Do_in_the_Derived_Parameters_Page"></a><span 
	 class="mw-headline"><i>派生パラメータ</i>のページでできること</span></h2>
<p><b>派生パラメータ</b>ページは7番目のページで、派生パラメータを定義します。このページはオプションなので、他の設定をするために<b>進む</b>ボタンをクリックして次のページに進んでも構いません。 
 このページ設定の詳細については、<a href="../../UserGuide/UserGuide/The_Derived_Parameters.html" 
					 title="ユーザガイド：派生パラメータ">派生パラメータ</a>ページを参照してください。 </p>
<h2><a name="What_You_Can_Do_in_the_Script_Before_or_After_Fitting_Page"></a><span 
	 class="mw-headline"><i>フィット前後のスクリプト</i>ページでできること</span></h2>
<p><b>フィット前後のスクリプト</b>ページは8番目の最後のページで、フィット処理前あるいは後に実行するLabTalkスクリプトを入力できます。このページはオプションなので、案芋設定せずに<b>完了</b>ボタンをクリックして関数の作成を終了しても構いません。このページ設定の詳細については、<a 
	 href="../../UserGuide/UserGuide/The_Script_Before_Or_After_Fitting_Page.html" 
	 title="ユーザガイド:フィット前後のスクリプトページ">フィット前後のスクリプト</a>ページを参照してください。 </p>
