<h1 class="firstheading">アルゴリズム（2群Kolmogorov-Smirnov検定）</h1><p class='urlname' style='display: none'>KS-Test-Algorithm</p>
<p>以下の説明は、NAGのアルゴリズムから引用したものです。 
</p><p>サイズ <img src="../images/Algorithm_(kstest2)/math-8d88a43872d6db6535d8672a15f09ce2.png" title="n_1\,\!" alt="n_1\,\!" class="tex"/> と <img src="../images/Algorithm_(kstest2)/math-ede03c8aef1b07c898c7747b489fd765.png" title="n_2\,\! " alt="n_2\,\! " class="tex"/> の2つの独立したサンプルX、Yを考えます。それぞれ、<img src="../images/Algorithm_(kstest2)/math-d79752c45b6e0288c460390908ff4157.png" title="x_1,x_2,\ldots ,x_{n_1}\,\!" alt="x_1,x_2,\ldots ,x_{n_1}\,\!" class="tex"/> と <img src="../images/Algorithm_(kstest2)/math-ba3bf26bc53cf72dd2f7e804e8351ba7.png" title="y_1,y_2,\ldots ,y_{n_1}\,\!" alt="y_1,y_2,\ldots ,y_{n_1}\,\!" class="tex"/>で示されます。F(x) および G(x)がそれぞれの未知の分布関数を表すとします。そして、サンプルの経験的分布関数の値を<img src="../images/Algorithm_(kstest2)/math-2eaa8777a1f571cbad7bfca3adf83c34.png" title=" S_1(x)\,\! " alt=" S_1(x)\,\! " class="tex"/> と<img src="../images/Algorithm_(kstest2)/math-17118f898c20f6dbf66463ce22714faa.png" title=" S_2(x)\,\! " alt=" S_2(x)\,\! " class="tex"/> で示します。
</p><p>帰無仮説 :F(x)=G(x) です。
</p><p>対立仮説 <img src="../images/Algorithm_(kstest2)/math-fabff59271b950125b7a360fba21de2c.png" title="H_1\,\!" alt="H_1\,\!" class="tex"/>: F(x)&lt;&gt;G(x)  p値は両側確率になります。
</p><p>または、<img src="../images/Algorithm_(kstest2)/math-fabff59271b950125b7a360fba21de2c.png" title="H_1\,\!" alt="H_1\,\!" class="tex"/> :F(x)&gt;G(x)  p値は上側の片側確率になります。 
</p><p>または、<img src="../images/Algorithm_(kstest2)/math-fabff59271b950125b7a360fba21de2c.png" title="H_1\,\!" alt="H_1\,\!" class="tex"/>: F(x)&lt;G(x)   p値は下側の片側確率になります。
</p><p>最初の <img src="../images/Algorithm_(kstest2)/math-fabff59271b950125b7a360fba21de2c.png" title="H_1\,\!" alt="H_1\,\!" class="tex"/> の場合、統計量 <img src="../images/Algorithm_(kstest2)/math-a9aca3b08301eb7213e2408c0ab85104.png" title="D_{n_1,n_2} \,\!" alt="D_{n_1,n_2} \,\!" class="tex"/> が、2つの経験分布関数の最大絶対偏差を表します。
</p><p>2番目の <img src="../images/Algorithm_(kstest2)/math-fabff59271b950125b7a360fba21de2c.png" title="H_1\,\!" alt="H_1\,\!" class="tex"/>の場合、統計量 <img src="../images/Algorithm_(kstest2)/math-4cd60644c5463cc66c7631c167ed3936.png" title="D_{n_1,n_2}^{+} \,\!" alt="D_{n_1,n_2}^{+} \,\!" class="tex"/>が、最初の標本の経験分布関数と2番目の標本の経験分布関数との間の正の最大絶対偏差を表します。つまり <img src="../images/Algorithm_(kstest2)/math-9cf98ed19b4ee4732ba5e4524e54a3f8.png" title="D_{n_1,n_2}^{+}=\max \{S_1(x)-S_2(x),0\}\,\!" alt="D_{n_1,n_2}^{+}=\max \{S_1(x)-S_2(x),0\}\,\!" class="tex"/>  です。
</p><p>3番目の <img src="../images/Algorithm_(kstest2)/math-fabff59271b950125b7a360fba21de2c.png" title="H_1\,\!" alt="H_1\,\!" class="tex"/> の場合、統計量 <img src="../images/Algorithm_(kstest2)/math-8af9c1a0d88a260554650e06fd515607.png" title="D_{n_1,n_2}^{-} \,\!" alt="D_{n_1,n_2}^{-} \,\!" class="tex"/> が、2番目の標本の経験分布関数と最初の標本の経験分布関数との間の正の最大絶対偏差を表します。つまり <img src="../images/Algorithm_(kstest2)/math-6a6a55b10a26fafb59197daab9f6d53b.png" title="D_{n_1,n_2}^{-}=\max \{S_2(x)-S_1(x),0\}\,\!" alt="D_{n_1,n_2}^{-}=\max \{S_2(x)-S_1(x),0\}\,\!" class="tex"/> です。 
</p><p>KS検定2も標準的な統計量 <img src="../images/Algorithm_(kstest2)/math-3e29b728262edf3639e74270b72e638a.png" title="Z=\sqrt{(n_1*n_2)/(n_1+n_2)}*D\,\!" alt="Z=\sqrt{(n_1*n_2)/(n_1+n_2)}*D\,\!" class="tex"/>を返します。
</p><p>ここで<img src="../images/Algorithm_(kstest2)/math-a7c6c783c5d03fc91d0594b217f56580.png" title="D\,\!" alt="D\,\!" class="tex"/>は<img src="../images/Algorithm_(kstest2)/math-3f75caf92b4b313ec5ec353b2df6a0b0.png" title="D_{n_1,n_2} \,\!" alt="D_{n_1,n_2} \,\!" class="tex"/>、<img src="../images/Algorithm_(kstest2)/math-4cd60644c5463cc66c7631c167ed3936.png" title="D_{n_1,n_2}^{+} \,\!" alt="D_{n_1,n_2}^{+} \,\!" class="tex"/>、<img src="../images/Algorithm_(kstest2)/math-8af9c1a0d88a260554650e06fd515607.png" title="D_{n_1,n_2}^{-} \,\!" alt="D_{n_1,n_2}^{-} \,\!" class="tex"/>で、対立仮説の選択に依存します。 
</p><p>統計量 <img src="../images/Algorithm_(kstest2)/math-07b1048bc60901fe82394ae47282671c.png" title="Z\,\!" alt="Z\,\!" class="tex"/> の分布は、 <img src="../images/Algorithm_(kstest2)/math-8d88a43872d6db6535d8672a15f09ce2.png" title="n_1\,\!" alt="n_1\,\!" class="tex"/> と <img src="../images/Algorithm_(kstest2)/math-2f6fac59fce80e76d698bcf5ea77bab6.png" title="n_2\,\!" alt="n_2\,\!" class="tex"/>が増加すると、Smirnovによって与えられる分布に近づくように収束します。帰無仮説の下で、観測統計量の極値として検定統計量の値を取得する確率が計算されます。 
</p><p><img src="../images/Algorithm_(kstest2)/math-caeb72e22c815c3c25d6a8b427c8aaad.png" title="max(n_1,n_2)\leq 2500\,\!" alt="max(n_1,n_2)\leq 2500\,\!" class="tex"/>および <img src="../images/Algorithm_(kstest2)/math-be2983946ebf66a1fd9de27574f27b22.png" title="n_1*n_2\leq 10000\,\!" alt="n_1*n_2\leq 10000\,\!" class="tex"/>の場合、KimとJinrichによって与えられる方法が使われます。あるいは、<img src="../images/Algorithm_(kstest2)/math-c0f582773fdbd168bbab09a1e6159c46.png" title="p\,\!" alt="p\,\!" class="tex"/> は、 KimとJenrich (1973)による近似式を用いて計算されます。
</p><p>この方法は、連続的な理論分布に対してのみ正確に使用できることに注意してください。 
</p><p>この手法は、両側確率を計算します。片側確率は、両側確率より推定されます。これは小さな <img src="../images/Algorithm_(kstest2)/math-c0f582773fdbd168bbab09a1e6159c46.png" title="p\,\!" alt="p\,\!" class="tex"/>、つまり <img src="../images/Algorithm_(kstest2)/math-cd60a65bcbb8b47dc37b5c879ed79777.png" title="p\leq 0.10\,\!" alt="p\leq 0.10\,\!" class="tex"/> に対する適切な推定値ですが、<img src="../images/Algorithm_(kstest2)/math-c0f582773fdbd168bbab09a1e6159c46.png" title="p\,\!" alt="p\,\!" class="tex"/> が大きくなると不確かになります。
</p><p>このアルゴリズムの詳細は、<a class="external text" href="http://www.originlab.com/pdfs/nagcl09/manual/pdf/g08/g08cdc.pdf" target="_blank"><b>nag_2_sample_ks_test (g08cdc)</b></a>をご覧下さい。
</p>






    