<h1 class="firstheading">クイックスタート</h1><p class='urlname' style='display: none'>Wks-SetColVal-QuickStart</p>
<p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Set_Values_Dialog_Box_Key_Features"><span class="tocnumber">1</span> <span class="toctext">値の設定ダイアログボックスの主な機能</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Spreadsheet_Cell_Notation"><span class="tocnumber">2</span> <span class="toctext">スプレッドシートセル表記</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#References_to_Columns_and_Cells"><span class="tocnumber">2.1</span> <span class="toctext">列とセルを参照</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#References_to_Other_Sheets_and_Books"><span class="tocnumber">2.2</span> <span class="toctext">他のシートとブックを参照</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="#What_Can_I_Enter_in_the_Column_Formula_or_Before_Formula_Scripts_Boxes.3F"><span class="tocnumber">3</span> <span class="toctext">列の計算式や実行前の処理スクリプトに何を入力すれは良いですか？</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#Column_Formula_Examples"><span class="tocnumber">3.1</span> <span class="toctext">列の計算式サンプル</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Autocomplete"><span class="tocnumber">3.2</span> <span class="toctext">オートコンプリート</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8"><a href="#Reusing_Formulas"><span class="tocnumber">4</span> <span class="toctext">計算式の再利用</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#A_Note:_When_Column_Formulas_do_not_Automatically_Update"><span class="tocnumber">5</span> <span class="toctext">列の計算式を自動で更新</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#Additional_Information"><span class="tocnumber">6</span> <span class="toctext">追加の情報</span></a></li>
<li class="toclevel-1 tocsection-11"><a href="#Two_Quick_Examples"><span class="tocnumber">7</span> <span class="toctext">クイックサンプル</span></a>
<ul>
<li class="toclevel-2 tocsection-12"><a href="#Set_Values_for_a_Single_Column"><span class="tocnumber">7.1</span> <span class="toctext">単一列の値を設定</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#Set_Values_for_Multiple_Columns"><span class="tocnumber">7.2</span> <span class="toctext">複数列の値を設定</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-14"><a href="#The_Python_Function_Tab"><span class="tocnumber">8</span> <span class="toctext">Python関数タブ</span></a>
<ul>
<li class="toclevel-2 tocsection-15"><a href="#Example"><span class="tocnumber">8.1</span> <span class="toctext">サンプル</span></a></li>
</ul>
</li>
</ul>
</div>
<h2><a name="Set_Values_Dialog_Box_Key_Features"></a><span class="mw-headline">値の設定ダイアログボックスの主な機能</span></h2>
<p><b><b>値の設定</b></b>ダイアログボックスは、ユーザが定義した式を1行をとり、この式によって生成された値を、<a href="../../UserGuide/UserGuide/Entering_Expressions_in_the_Set_Column_Dialog.html" title="ユーザガイド:「値の設定」ダイアログボックスに数式を入力する">1つあるいは複数のワークシート列</a>(あるいは列の一部分)に出力します。<b>列の計算式</b>ボックスに入力される式は、演算子、列や行の参照、関数、ユーザ定義変数、定数等を組み込むことができます（<a href="#What_Can_I_Enter_in_the_Column_Formula_or_Before_Formula_Scripts_Boxes.3F">詳細は下記</a>）。値の設定ダイアログには、構文の色付け機能があります。
</p>
<dl><dd><a  class="image"><img alt="SCV dialog features8.png" src="../images/Quick_Start_SetColumnValues/SCV_dialog_features8.png" width="821"  /></a></dd></dl>
<p><br />
<i><b>オプションのスクリプトタブ：</b></i>
</p>
<dl><dd><dl><dd><a  class="image"><img alt="SCV BFS Python Tabs.png" src="../images/Quick_Start_SetColumnValues/SCV_BFS_Python_Tabs.png" width="528"  /></a></dd></dl></dd></dl>
<ul><li> <b>実行前の処理スクリプト</b>タブは、複数行のLabTalkスクリプトを取り、このスクリプトは、<b>列の数式</b>ボックスの式が実行される前に実行されます。これにより、<b><b>列の計算式</b></b>で使用する入力データの前処理や、関数、変数、定数の定義などが可能です。実行前の処理スクリプトについての詳しい情報は、<a href="../../UserGuide/UserGuide/Entering_Expressions_in_the_Set_Column_Dialog.html" title="ユーザガイド:「値の設定」ダイアログボックスに数式を入力する">列値の設定ダイアログに数式を入力する</a>をご覧ください。<b>値の設定</b>ダイアログのコントロールについては、<a href="../../UserGuide/UserGuide/Menu_Options_and_Dialog_Controls.html" title="ユーザガイド:メニューとダイアログのオプション">メニューオプションとダイアログコントロール</a>を参照してください。</li>
<li> <b>Python関数</b>タブで、列の数式を呼び出すためにPython関数を定義することが出来ます。関数を外部ファイルに保存することもできますが、<b>Python関数</b>タブを使用すると、コードをOriginテンプレートファイルに保存して繰り返し使用できます。さらに、Python関数は<b>列の数式</b>ボックスから直接呼び出すことができます。または、隣の<b>実行前の処理スクリプト</b>タブのLabTalkスクリプトから呼び出すことができます。<a href="../../UserGuide/UserGuide/Quick_Start_SetColumnValues.html#The_Python_Function_Tab" title="ユーザーガイド：クイックスタート 列の設定">簡単な例/チュートリアル</a>での<b>Python関数</b>タブ使用の実例は、以下を参照してください。PythonとOriginのより詳細な情報については、<a class="external text" href="../../Python/Category/Python_(Python).html">OriginのPythonのドキュメント</a>を参照してください。 </li></ul>
<dl><dd><dl><dd><a  class="image"><img alt="SCV BFS Call Python Tab.png" src="../images/Quick_Start_SetColumnValues/SCV_BFS_Call_Python_Tab.png" width="584"  /></a></dd></dl></dd></dl>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Quick_Start_SetColumnValues/Tip_icon.png" width="57"  border="0" /></td><td><p>値の設定ダイアログボックスにサンプルをロードするには、メニューから<b><b>計算式：サンプルのロード</b></b>を選択して表示されるリストから、ロードしたいものを選択します。
</p></td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Quick_Start_SetColumnValues/Tip_icon.png" width="57"  border="0" /></td><td><p>Origin 2018 SR0より、<i>セルレベル</i>（列レベルではなく）での計算を実行できます。<a href="../../UserGuide/UserGuide/Using_Formulae_to_Set_Cell_Values.html" title="ユーザガイド: 式を使ってセル値を設定">式を使ってセル値を設定</a>を参照してください。
</p></td></tr></table>
<h2><a name="Spreadsheet_Cell_Notation"></a><span class="mw-headline">スプレッドシートセル表記</span></h2>
<p>Origin 2017 SR0からは、デフォルトで<a href="../../UserGuide/UserGuide/Folder_and_Window_Properties_Dialog.html#The_Properties_tab" title="ユーザガイド：フォルダとウィンドウのプロパティダイアログ">スプレッドシートセル表記 (SCN)</a>が有効になっています。SCNが有効の時、シンプルSCNや2017より前のバージョンをお使いの場合は、<b>列値の設定</b>ボックスか<a href="../../UserGuide/UserGuide/Displaying_Supporting_Data_in_Worksheet_header_Rows.html#F.28x.29.3D" title="ユーザガイド:ワークシートヘッダ行に表示するサポートデータ"><b>F(x)=</b>列ラベル行</a>のいずれかで、新しい表記、または、旧表記の利用が可能です。「col」や「wcol」を使う場合、<a href="../../UserGuide/UserGuide/Quick_Start_SetColumnValues.html#A_Note:_When_Column_Formulas_do_not_Automatically_Update" title="ユーザガイド:クィックスタート 列値の設定">いくつかの制限</a>があります。
</p><p>Origin 2017より前のバージョンでファイル(OPJ、OGWなど)を開くと、ワークブックのSCNは無効となります。古いバージョンのファイルであっても、<a href="../../UserGuide/UserGuide/Folder_and_Window_Properties_Dialog.html" title="ユーザガイド：フォルダとウィンドウのプロパティダイアログ"><b>ウィンドウプロパティ</b>ダイアログボックス</a>から、SCNを有効にすることができます。SCNを有効にしない場合(<a href="../../UserGuide/UserGuide/Folder_and_Window_Properties_Dialog.html#Window_Properties_dialog" title="ユーザガイド：フォルダとウィンドウのプロパティダイアログ"><b>スプレッドシートセル表記</b>ボックス</a>にチェックしていない場合)、ワークブック全体の<b>列値の設定</b>と<b>F(x)=</b>に<a href="#Column_Formula_Examples">古い列とセル表記</a>を適用<i>しなければいけません</i>。
</p><p>この新しいスプレッドシートセル表記は<b>列の計算式</b>ボックスと<b>F(x)=</b>ラベル行<i>のみで利用可能</i>です。<b>実行前の処理スクリプト</b>ボックス内、またはOrigin内で記述するLabTalkスクリプトでは使用できません。
</p>
<h3><a name="References_to_Columns_and_Cells"></a><span class="mw-headline">列とセルを参照</span></h3>
<p>ワークシート内の列やセルの参照は次の方法で行います。
</p>
<pre class="lt" style="font-family:monospace;">A; <span style="color: #008000;">// 同じシートの列Aを参照</span> A1; <span style="color: #008000;">// 同じシートの列Aの1行目を参照</span></pre>
<p><a href="#Column_Formula_Examples">以下</a>の<b>列の計算式サンプル</b>を参照してください。
</p>
<h3><a name="References_to_Other_Sheets_and_Books"></a><span class="mw-headline">他のシートとブックを参照</span></h3>
<p>Origin2017より前のバージョンでは、別のシートとブックで使う範囲変数を<b>値の設定</b>の計算式で定義する必要がありました。上の表のようにスプレッドシートセル表記を使って、他のシートとブックのデータに直接参照することができます。これは、<b>F(x)=</b>ラベル行と「列値の設定」ボックスの両方でサポートされています。スプレッドシートセル表記が、目的のブックで有効になっている必要があります。
</p><p>以下のシンタックスを使います。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span>A; <span style="color: #008000;">// 同じブックの最初のシートにある列Aを参照</span> Sheet1<span style="color: #000080;">!</span>A; <span style="color: #008000;">// 同じブックにあるシート[Sheet1]にあるるシートの列Aを参照</span> <span style="color: #000000;">[</span>Book1<span style="color: #000000;">]</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span>A; <span style="color: #008000;">// 別のブック[Book1]にある最初のシートのA列を参照</span> <span style="color: #000000;">[</span>Book2<span style="color: #000000;">]</span>Sheet1<span style="color: #000080;">!</span>B2; <span style="color: #008000;">// 別のブック[Book2]にあるシート[Sheet1]の列Bの2番目の行を参照</span></pre>
<p><a href="#Column_Formula_Examples">以下</a>の<b>列の計算式サンプル</b>を参照してください。
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Quick_Start_SetColumnValues/Tip_icon.png" width="57"  border="0" /></td><td><p>デフォルトでは、<code>2!a2</code>などの参照を<b>F(x)=</b>行またはセル式に入力したときに、Originはシートのシートネームを自動的に代用しません。この動作は<a href="../../UserGuide/UserGuide/Customizing_Origin_using_System_Variables.html#Changing_the_Value_of_a_System_Variable" title="ユーザガイド: システム変数を使ってOriginをカスタマイズ">LabTalkシステム変数</a><code><a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#S">@SCVU=0</a></code>の値を変更して、編集できます。
</p></td></tr></table>
<h2><a name="What_Can_I_Enter_in_the_Column_Formula_or_Before_Formula_Scripts_Boxes.3F"></a><span class="mw-headline">列の計算式や実行前の処理スクリプトに何を入力すれは良いですか？</span></h2>
<p>式には以下の項目を含めることができます。<a class="external text" href="../../LabTalk/LabTalk/Range_Notation.html#Types_of_Range_Data">範囲変数</a>は、<b><b>列の計算式</b></b>で使用する前に、予め定義しておく（例：<b>実行前の処理スクリプト</b>で）必要があります。
</p>
<table class="xfvar">
<tr>
<th width="20%">データ参照
</th>
<th width="20%">変数
</th>
<th width="20%">演算子
</th>
<th width="20%">関数
</th>
<th width="20%">定数
</th></tr>
<tr valign="top">
<td>
<ul><li> <a class="external text" href="../../LabTalk/LabTalk/Cell_(function).html">cell() 関数</a></li>
<li> <a class="external text" href="../../LabTalk/LabTalk/Col_(function).html">col() &amp; wcol() 関数</a></li>
<li> <a href="../../UserGuide/UserGuide/Named_Range.html" title="UserGuide:名前付き範囲">名前付き範囲</a></li>
<li> <a class="external text" href="../../LabTalk/LabTalk/Range_Notation.html#Types_of_Range_Data">範囲変数</a><sup></sup></li></ul>
</td>
<td>
<ul><li> <a class="external text" href="../../LabTalk/LabTalk/Data_Types_and_Variables.html#Variables">プロジェクト &amp; セッション変数</a></li>
<li> <a href="../../UserGuide/UserGuide/The_Insert_Variables_Dialog_Box.html" title="ユーザガイド: 変数の挿入ダイアログボックス">SYSTEM および<br />USER変数</a></li>
<li> <a href="../../UserGuide/UserGuide/Displaying_Supporting_Data_in_Worksheet_header_Rows.html" title="ユーザガイド:ワークシートヘッダ行に表示するサポートデータ">列ヘッダデータ</a></li></ul>
</td>
<td>
<ul><li> <a class="external text" href="../../LabTalk/LabTalk/Operators.html#Arithmetic_Operators">算術</a></li>
<li> <a class="external text" href="../../LabTalk/LabTalk/Operators.html#Logical_and_Relational_Operators">論理関係</a></li>
<li> <a class="external text" href="../../LabTalk/LabTalk/Operators.html#String_Concatenation">文字列の連結</a></li>
<li> <a class="external text" href="../../LabTalk/LabTalk/Operators.html#Conditional_Operator_.28.3F:.29">条件</a></li></ul>
</td>
<td>
<ul><li> <a class="external text" href="../../LabTalk/Script/LabTalk-Supported_Functions.html">ビルトイン</a></li>
<li> <a href="../../UserGuide/UserGuide/Create_a_User_Defined_Function_for_Set_Column_Values.html" title="ユーザガイド：列値の設定を行うためのユーザ定義式を作成する">ユーザ定義のOrigin C</a></li>
<li> <a class="external text" href="../../Python/Python/Calling_Python_Functions_from_LabTalk_and_Column_Formula.html">Python</a><sup></sup></li></ul>
</td>
<td>
<ul><li> <a class="external text" href="../../LabTalk/LabTalk/Operators.html#Define_a_constant">ビルトイン</a></li>
<li> <a class="external text" href="../../LabTalk/LabTalk/Operators.html#Define_a_constant">ユーザ定義</a></li></ul>
</td></tr></table>
<p><sup></sup><b><b>実行前の処理スクリプト</b></b>パネルや<b><b>スクリプトウィンドウ</b></b>等で事前定義する必要があります。
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Quick_Start_SetColumnValues/Tip_icon.png" width="57"  border="0" /></td><td><p>値の設定ダイアログのメニューコマンドである、<b>wcol(1)</b>, <b>Col(A)</b>, <b><b>関数</b></b>, <b><b>変数</b></b>は、データの参照、関数、変数、定数を列の計算式や実行前の処理スクリプトに挿入するのに役立ちます。メニューで選択された項目、はカーソル位置に挿入されます。Origin 2017 SR0では、これらのメニュー関数は従来の列と(スプレッドシートセル表記ではない）セル表記をサポートしています。
</p></td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Quick_Start_SetColumnValues/Tip_icon.png" width="57"  border="0" /></td><td><p><b>実行前の処理スクリプト</b> ボックスでスクリプトを実行する場合、制御条件またはloopスクリプトをロードする簡単な方法があります。<b>実行前の処理スクリプト</b>  ボックスを右クリックし、メニューの下部にある<b>条件/Loop</b> を選択し、条件構造やループ構造を選択します。シンタックスは簡単なコメントでカーソルに追加されます。
</p></td></tr></table>
<p><b>値の設定</b>ダイアログのコントロールについては、<b><a href="../../UserGuide/UserGuide/Menu_Options_and_Dialog_Controls.html" title="ユーザガイド:メニューとダイアログのオプション">メニューオプションとダイアログコントロール</a></b>を参照してください。
</p>
<h3><a name="Column_Formula_Examples"></a><span class="mw-headline">列の計算式サンプル</span></h3>
<p>以下は、<b><b>列の計算式</b></b>ボックスで使用できる数式の簡単なサンプルです。
</p>
<dl><dd><dl><dd><table class="simple" style="width: 80%">
<tr>
<th width="25%">新しいスプレッドシートセル表記
</th>
<th width="25%">従来の表記
</th>
<th width="50%">説明
</th></tr>
<tr>
<td> <b>B - C</b>
</td>
<td> <b>col(B)-col(C)</b>
</td>
<td> col(B)[i]とcol(C)[i]の差を返します。
</td></tr>
<tr>
<td> <b>2!B - 3!C</b>
</td>
<td> N/A
</td>
<td> シートインデックス2, col(B)[i]とシートインデックスcol(C)[i]の差を返します。
</td></tr>
<tr>
<td> <b>[Book2]Sheet1!A - [Book3]Sheet1!A</b>
</td>
<td> N/A
</td>
<td> [Book2]Sheet1!A[i]と[Book3]Sheet1!A[i]の差を返します。
</td></tr>
<tr>
<td> <b>[Book2]Sheet1!A - [Book3]Sheet1!A2</b>
</td>
<td> N/A
</td>
<td> [Book2]Sheet1!A[i]と[Book3]Sheet1!の差を返します。
</td></tr>
<tr>
<td> <b>sin(pi*B)</b>
</td>
<td> <b>sin(pi*col(B))</b>
</td>
<td> col(B)[i]の正弦の値にpiを乗じた数を返します。
</td></tr>
<tr>
<td> <b>today()</b>
</td>
<td> 変更なし
</td>
<td> 現在の日付を返します。
</td></tr>
<tr>
<td> <b>A$ + B$</b>
</td>
<td> <b>col(A)$ + col(B)$</b>
</td>
<td> 内部で列Aと列Bを文字列に変換して結合します。
</td></tr>
<tr>
<td> <b>a &gt; 0,A: Na()</b>
</td>
<td> <b>col(A)&gt;0? col(A): Na()</b>
</td>
<td> col(A)&gt;0ならcol(A)に値を返し、そうでなければ欠損値を返します。 (<a class="external text" href="../../LabTalk/LabTalk/NA_(function).html">LabTalk Utility Function<b>Na()</b></a>をご覧ください。)
</td></tr>
<tr>
<td> <b>B-B1</b>
</td>
<td> <b>col(B)-col(B)[1]</b>
</td>
<td> 列Bの最初のポイントを列Bの全ての値から減算します。
</td></tr>
<tr>
<td> <b>A + StartTime</b>
</td>
<td> N/A
</td>
<td> 名前付き範囲「StartTime」値を列Aの値に加算します。
</td></tr>
<tr>
<td> <b>total(A[i-1:i+3])</b>
</td>
<td> <b>total(col(A)[i-3:i+3])</b>
</td>
<td> col(A)のi-3 から i+3 までのサブ範囲の合計を返します。i は行番号です。
</td></tr>
<tr>
<td> <b>sum(A:C, D:G, F)</b>
</td>
<td> N/A
</td>
<td> 列AからC、DからG、およびFの値の行ごとの合計を返します。
</td></tr>
<tr>
<td> <b>(wcol(j)*2)-1</b>
</td>
<td> 変更なし
</td>
<td> <i>j</i> 番目の列（すべての選択された列）の各値に2を掛けて1を引いて、変換するために使用できます。
</td></tr></table></dd></dl></dd></dl>
<table class="note">
<tr>
<td><b>Note:</b><b>列値の設定</b>か<a class="external text" href="../../UserGuide/UserGuide/Displaying_Supporting_Data_in_Worksheet_header_Rows.html#F.28x.29.3D"><b>F(x)=</b>列ラベル行</a>で<b>i</b>と<b>j</b>を使う場合、<i>小文字を使います</i>。大文字の<b>I</b>と<b>J</b>は、ワークシート列のショートネームに影響を与えてしまいます。
</td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Quick_Start_SetColumnValues/Tip_icon.png" width="57"  border="0" /></td><td><p>「End」または「0」を使用して、列の最後のセルを定義します。 例 <code>total(A[10:end])-B[i]</code> or <code>total(A[10:0])-B[i]</code>.
</p></td></tr></table>
<h3><a name="Autocomplete"></a><span class="mw-headline">オートコンプリート</span></h3>
<p><b>Origin 2022</b>以降、列値の設定の列の数式ボックスおよび<a href="../../UserGuide/UserGuide/Displaying_Supporting_Data_in_Worksheet_header_Rows.html#F.28x.29.3D" title="ユーザガイド:ワークシートヘッダ行に表示するサポートデータ"><b>F(x)=</b>ラベル行</a>は、<a class="external text" href="../../LabTalk/Script/LabTalk-Supported_Functions.html">LabTalkでサポートされている関数</a>と<a href="../../UserGuide/UserGuide/Named_Range.html" title="UserGuide:名前付き範囲">名前付き範囲</a>のオートコンプリートをサポートします。 
</p><p>この機能を使用したくない場合は、列 および/または <a href="../../UserGuide/UserGuide/Using_Formulae_to_Set_Cell_Values.html" title="ユーザガイド: 式を使ってセル値を設定">セルの数式</a>に対して無効にすることができます/ F(x)=：
</p>
<ol><li> メニューの<b>環境設定: システム変数</b>をクリックします。</li>
<li> 空の<b>変数</b>セルに、<a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#F.2CG"><b>FAC</b></a>と入力します。</li>
<li> <b>値</b>セルに次のいずれかを入力します（値は加算されます）：<i>0</i> =オートコンプリートをオフにする、<i>1</i> =セルの数式と<b>F(x)=</b>ラベル行を有効にする、<i>2</i> =列式を有効にする、<i>3</i>（デフォルト）=セルの数式/<b>F(x)=</b>および列式を有効にする</li>
<li> <b><b>OK</b></b>をクリックしてダイアログを閉じます。</li></ol>
<h2><a name="Reusing_Formulas"></a><span class="mw-headline">計算式の再利用</span></h2>
<p>値の設定の計算式を<b>実行前の処理スクリプト</b>および<b>Python関数</b>コードとともに再利用する場合は、次のことができます。
</p>
<ul><li> （1）値の設定メニューバーの<b>計算式：保存</b>をクリックするか、（2）値の設定の<b>式を保存</b>ボタン<a  class="image"><img alt="Button Save X Function.png" src="../images/Quick_Start_SetColumnValues/Button_Save_X_Function.png" width="22"  /></a>をクリックして、数式を保存します。計算式を再利用するには、<b>計算式：ロード</b>をクリックして式を選択します。列ラベル行<a href="../../UserGuide/UserGuide/Displaying_Supporting_Data_in_Worksheet_header_Rows.html#F.28x.29.3D" title="ユーザガイド:ワークシートヘッダ行に表示するサポートデータ"><b>F（x）=</b>セル</a>を選択した状態で、<b>列：ユーザー式入力</b>を選択するか、セルを右クリックして<b>ロード</b>を選択します。</li>
<li> <a href="../../UserGuide/UserGuide/What_is_Saved_with_the_Workbook_Template.html#Set_Values_dialog_box" title="ユーザガイド：ワークブックテンプレートに保存される属性">ワークブックテンプレート</a>を使用して、値の設定の数式を保存できます。すると、ワークブックテンプレートのインスタンスを開けば、値の設定の式が準備されています。</li></ul>
<h2><a name="A_Note:_When_Column_Formulas_do_not_Automatically_Update"></a><span class="mw-headline">列の計算式を自動で更新</span></h2>
<p>簡単になった新しいシンタックスを使う場合、列Aと列Bの値を参照している列Cの列の式を定義して、列Aと列Bの間に列を挿入できます。列は式を参照し、列のショートネームが適用されます。ただし、この機能は以下の<i>全て</i>の場合利用できません。
</p>
<ul><li> 列の式が<a class="external text" href="../../LabTalk/LabTalk/Col_(function).html"><b>col()</b></a>や<a class="external text" href="../../LabTalk/LabTalk/WCol_(function).html"><b>wcol()</b></a>の関数を使っている。</li>
<li> 列の式が「列値の設定」の<a href="../../UserGuide/UserGuide/Entering_Expressions_in_the_Set_Column_Dialog.html#Add_Expressions_in_both_Column_Formula_and_Before_Formula_Scripts" title="ユーザガイド:「値の設定」ダイアログボックスに数式を入力する"><b>実行前の処理スクリプト</b></a>に入力しているスクリプトを使っている。</li>
<li> 式にブラケット「<b>{}</b>」が含まれている。</li>
<li> 列の式が、シート名の参照と反して、シートのインデックス参照を含んている（例：1!A vs. Sheet1!A)</li></ul>
<p>列の式がこれらの状況に影響する場合、列の式は更新されません。
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">追加の情報</span></h2>
<dl><dd><ul><li> <a href="../../UserGuide/Category/Using_Formulae_to_Set_or_Transform_Worksheet_Column_Values.html" title="カテゴリー:関数式を使った列値の設定やワークシート列の計算"><b>値の設定</b>ダイアログを開く</a>。</li>
<li> <a href="../../UserGuide/UserGuide/Entering_Expressions_in_the_Set_Column_Dialog.html" title="ユーザガイド:「値の設定」ダイアログボックスに数式を入力する">値の設定ダイアログに数式を入力する</a>。</li>
<li> <a href="../../UserGuide/UserGuide/Displaying_Supporting_Data_in_Worksheet_header_Rows.html#F.28x.29" title="ユーザガイド:ワークシートヘッダ行に表示するサポートデータ">列ラベル行で列の計算式を表示、編集する</a></li>
<li> <a href="../../UserGuide/UserGuide/Menu_Options_and_Dialog_Controls.html" title="ユーザガイド:メニューとダイアログのオプション">値の設定ダイアログボックスのメニューオプションとコントロール</a>。 </li>
<li> <a class="external text" href="../../LabTalk/Script/LabTalk-Supported_Functions.html">値の設定ダイアログボックスで使用できるLabTalk関数</a>。</li>
<li> <a href="../../UserGuide/UserGuide/Create_a_User_Defined_Function_for_Set_Column_Values.html" title="ユーザガイド:列値の設定を行うためのユーザ定義式を作成する">値の設定ダイアログボックスで使用できるユーザ定義関数を作成する</a>。</li></ul></dd></dl>
<h2><a name="Two_Quick_Examples"></a><span class="mw-headline">クイックサンプル</span></h2>
<h3><a name="Set_Values_for_a_Single_Column"></a><span class="mw-headline">単一列の値を設定</span></h3>
<p>次の簡単なチュートリアルは、このダイアログを使ってガウス曲線のデータを生成する方法を示しています。
</p>
<ol>
<li><b>標準</b>ツールバーの<b>新規ワークブック</b>ボタン<a  class="image"><img alt="New Workbook.png" src="../images/Quick_Start_SetColumnValues/New_Workbook.png" width="25"  /></a>をクリックして、新しいワークブックを作成します。 
<li>列Aを選択し、右クリックして、ショートカットメニューから<b>列値の設定</b>を選択し、<b>値の設定</b>ダイアログを開きます。 
<li><b>列の計算式</b>に <b>{-1:0.03:5}</b> と入力し、<b>適用</b>ボタンをクリックします。列Aには一連の数字が入力されます。
<li>ダイアログを閉じることなく、<a href="../../UserGuide/UserGuide/Menu_Options_and_Dialog_Controls.html#Column_First.2FNext.2FPrev.2FLast" title="ユーザガイド:メニューとダイアログのオプション">ナビゲーションボタン</a>のうちの1つを使用して2つ目の列に式を入力します。<b>次へ</b>ボタン<a  class="image"><img alt="Next Button.png" src="../images/Quick_Start_SetColumnValues/Next_Button.png" width="20"  /></a>をクリックします。列Bがワークシートで選択されるのが分かります。 
<li>そして、<b>列の計算式</b>編集ボックスに<b>1 + (5/(1.5*sqrt(PI/2)))*exp(-2*((A-2)/1.5)^2)</b> と入力し、<b><b>再計算</b></b>ドロップダウンリストで<b><b>自動</b></b>を選択します。
<li><b><b>OK</b></b>ボタンをクリックします。<b>値の設定</b>ダイアログが閉じます。次のワークシートのような結果になります。<br />(列Bの折れ線グラフを作成すると、ワークブックの隣にあるようなグラフになります。)
<dl><dd><a  class="image"><img alt="Quick Start SetColumnValues 1.png" src="../images/Quick_Start_SetColumnValues/Quick_Start_SetColumnValues_1.png" width="750"  /></a></dd></dl>
<li>列Bの<b><b>F(X)</b></b>列ラベルをダブルクリックし、式を<b>1+5/(1.5*sqrt(PI/2))*exp(-2*(A-2)/1.5*2)</b>に変更します。すると、列Bの値は自動的に変換している事がわかります。<br />(<b>再計算</b>ボタン<a  class="image"><img alt="Button Rescale.png" src="../images/Quick_Start_SetColumnValues/Button_Rescale.png" width="23"  /></a> をクリックすると、グラフも合わせて更新されます。)
<dl><dd><a  class="image"><img alt="Quick Start SetColumnValues 2.png" src="../images/Quick_Start_SetColumnValues/Quick_Start_SetColumnValues_2.png" width="750"  /></a></dd></dl>
</ol>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Quick_Start_SetColumnValues/Tip_icon.png" width="57"  border="0" /></td><td><p>Originは<b><b><b>値の設定</b></b></b>ダイアログで列のサブ範囲を使用して関数の引数に設定できます。
</p><p>例えば、列Aのサブ範囲<b>i-3</b> から <b>i+3</b> ( i は行インデックス)までの合計を計算するには、<b><b>列の式</b></b>編集ボックスに式を入力できます。
</p>
<pre class="lt" style="font-family:monospace;">Total<span style="color: #000000;">(</span>A<span style="color: #000000;">[</span>i<span style="color: #000080;">-</span><span style="color: #0000dd;">3</span><span style="color: #000000;">:</span>i<span style="color: #000080;">+</span><span style="color: #0000dd;">3</span><span style="color: #000000;">]</span><span style="color: #000000;">)</span></pre> 
</td></tr></table>
<h3><a name="Set_Values_for_Multiple_Columns"></a><span class="mw-headline">複数列の値を設定</span></h3>
<p>次の簡単なチュートリアルは、値の設定ダイアログを使って瞬時に複数の列に値を入力できるか示します。
</p>
<ol>
<li> <b><b>標準</b></b>ツールバーの<b>新規プロジェクト</b>ボタン<a  class="image"><img alt="Button New Project.png" src="../images/Quick_Start_SetColumnValues/Button_New_Project.png" width="22"  /></a>をクリックして、新しいプロジェクトを作成します。
<li> <b>複数ASCIIのインポート</b>ボタン<a  class="image"><img alt="Button Import Multiple ASCII.png" src="../images/Quick_Start_SetColumnValues/Button_Import_Multiple_ASCII.png" width="23"  /></a>をクリックして、<i>&lt;Origin フォルダ&gt;\Samples\Import and Export\</i> のパスにある<i>F1.dat</i>とF2.datをインポートします。<b>impASC</b>ダイアログで、<b>複数ファイル（第一以外）インポートモード</b>を<b>ブックを新たに作って読み込む</b>にして<b>OK</b>をクリックします。
<li> 2つのワークブック、F1とF2が作成されます。<b>標準</b>ツールバーの<b>新規ワークブック</b>ボタン <a  class="image"><img alt="New Workbook.png" src="../images/Quick_Start_SetColumnValues/New_Workbook.png" width="25"  /></a>をクリックし、もう1つワークブックを作成します。
<li> 3番目のワークブックがアクティブな状態で、<b>列の追加</b>ボタン <a  class="image"><img alt="Button Add New Columns.png" src="../images/Quick_Start_SetColumnValues/Button_Add_New_Columns.png" width="22"  /></a>をクリックします。全ての列を選択し、<b><b>列：複数列の値を設定</b></b>とメインメニューから操作するか、右クリックして<b><b>複数列の値を設定</b></b>をコンテキストメニューから選択して<b><b>値の設定</b></b>ダイアログを開きます。
<li> スクリプトを表示ボタン<a  class="image"><img alt="Button Show Scripts.png" src="../images/Quick_Start_SetColumnValues/Button_Show_Scripts.png" width="23"  /></a>をクリックして下部パネルを拡張します。次のスクリプトを<b>実行前の処理スクリプト</b>編集ボックスに入力します。 
<pre class="lt" style="font-family:monospace;">range r1<span style="color: #000080;">=</span><span style="color: #000000;">[</span>F1<span style="color: #000000;">]</span>F1<span style="color: #000080;">!</span>wcol<span style="color: #000000;">(</span>j<span style="color: #000000;">)</span>; <span style="color: #008000;">//&quot;j&quot; is the column index.</span>
range r2<span style="color: #000080;">=</span><span style="color: #000000;">[</span>F2<span style="color: #000000;">]</span>F2<span style="color: #000080;">!</span>wcol<span style="color: #000000;">(</span>j<span style="color: #000000;">)</span>;</pre>
<li> <b><b>列の式</b></b>編集ボックスに<b>(r1+r2)/2</b> と入力します。 
<li> <b><b>オプション：式セルを直接編集</b></b>の項目のチェックを外します。 
<li> <b><b>オプション：式テキスト</b></b>と選択して、<b>式テキスト</b>ダイアログに<i>(F1+F2)/2</i>を入力して<b><b>OK</b></b>ボタンをクリックします。
<li> <b><b>値の設定</b></b>ダイアログの<b><b>OK</b></b>ボタンをクリック します。結果がワークシートに反映され、<b>F(X)</b>列ラベル行には式では無くて<i>(F1+F2)/2</i> が表示されます。
</ol>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Quick_Start_SetColumnValues/Tip_icon.png" width="57"  border="0" /></td><td><p><b>実行前の処理スクリプト</b>で変数を定義する場合、変数名として小文字を使います。(例：「R1」ではなく「r1」を使う。)大文字を使うと以下のようなエラーが起こります。
<p><font face="courier" color="red">列ショートネームの制限が有効です。R1がセルを参照し、変数として定義されません。「列値の設定」スクリプトのエラーのため、Book1_Gの処理ができません。</font>
</p>
</p></td></tr></table>
<h2><a name="The_Python_Function_Tab"></a><span class="mw-headline">Python関数タブ</span></h2>
<p>Python関数は、必要に応じて、<b>列の数式</b>ボックスまたは<b>実行前の処理スクリプト</b>タブから呼び出すことができます。これらの関数は、外部ファイルで定義すること、もしくは値の設定の<b>Python関数</b>タブで定義することができます。列値の設定ダイアログでこれらを定義する利点は、それらがプロジェクトとともに保存されることです。繰り返し使用するためのテンプレートを使用することもできます。
</p><p>そのタブで、Python関数は...の形式で定義されます。
</p>
<pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">def</span> ff<span style="color: #000;">(</span>a<span style="color: #000;">)</span></pre>
<p>...そして<b>実行前の処理スクリプト</b>タブまたは<b>列の数式</b>ボックスで...として呼び出されます。
</p>
<pre class="python" style="font-family:monospace;">py.<span style="color: #000;">ff</span><span style="color: #000;">(</span>a<span style="color: #000;">)</span></pre>
<p><br />
値の設定ダイアログでPythonを利用する際の詳細は、<a class="external text" href="../../Python/Python/Set_Column_Values.html"><b>列値の設定でPython関数を使用</b></a>を参照してください。
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Quick_Start_SetColumnValues/Tip_icon.png" width="57"  border="0" /></td><td><p><b>F(x)=</b>セルが（1）「<b>py.</b>」で始まる場合、および（2）外部ファイルで定義されたPython関数を呼び出す場合は、<b>F(x)=</b>セルを右クリックし、<b>Pythonファイルを開く</b>を選択して、<a class="external text" href="https://www.originlab.com/python/doc/originpro/annotated.html" target="_blank"><b>コードビルダ</b>IDE</a>でPython関数を開くことができます。
</p></td></tr></table>
<h3><a name="Example"></a><span class="mw-headline">サンプル</span></h3>
<p>この簡単なチュートリアルでは、<b>Python関数</b>タブで関数を定義し、<b>列の数式</b>ボックスで呼び出す方法を示します。
</p>
<ol>
<li> 新しいワークブックを開き、<b>インポート</b> ツールバーにある、<b>単数ASCIIのインポート</b>ボタン<a  class="image"><img alt="Button Import Single ASCII.png" src="../images/Quick_Start_SetColumnValues/Button_Import_Single_ASCII.png" width="23"  /></a>をクリックします。
<li> このファイルを参照して開きます&lt;Origin Program Folder&gt;\Samples\Signal Processing\Signal with High Frequency Noise.dat.
<li> <b>標準</b>ツールバー中の<b><b>列の追加</b></b>ボタン<a  class="image"><img alt="Button Add New Columns.png" src="../images/Quick_Start_SetColumnValues/Button_Add_New_Columns.png" width="22"  /></a>をクリックします。
<li> 追加した列の先頭をクリックして列を選択し、右クリックして<b>列値の設定</b>を選びます。
<li> 表示されない場合は、<b>スクリプトを表示</b>ボタン<a  class="image"><img alt="Button Show Scripts.png" src="../images/Quick_Start_SetColumnValues/Button_Show_Scripts.png" width="23"  /></a>をクリックして下部パネルを拡張します。
<li> <b>Python関数</b>タブをクリックし、以下をコピー＆ペーストしてください。
<pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">import</span> numpy <span style="color: #ff7700;font-weight:bold;">as</span> np
<span style="color: #ff7700;font-weight:bold;">from</span> scipy <span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #000;">signal</span>
<span style="color: #ff7700;font-weight:bold;">def</span> smooth<span style="color: #000;">(</span>y<span style="color: #000;">,</span>npts<span style="color: #000;">,</span> norder<span style="color: #000;">)</span>:
     <span style="color: #0a0;">&quot;&quot;&quot;
     F:Fii
     Perform Savitzky-Golay smoothing using scipy signal
     &quot;&quot;&quot;</span>
     <span style="color: #d00; font-style: italic;">#npts: number of points for smoothing window</span>
     <span style="color: #d00; font-style: italic;">#norder: polynomial order</span>
     y<span style="color: #000;">=</span><span style="color: #000;">signal</span>.<span style="color: #000;">savgol_filter</span><span style="color: #000;">(</span> np.<span style="color: #000;">array</span><span style="color: #000;">(</span>y<span style="color: #000;">)</span><span style="color: #000;">,</span> npts<span style="color: #000;">,</span> norder <span style="color: #000;">)</span>
     <span style="color: #ff7700;font-weight:bold;">return</span> y</pre>
<li> 列の数式ボックスをクリックし、以下を入力します。
<pre class="lt" style="font-family:monospace;">py.<span style="color: #000080;">smooth</span><span style="color: #000000;">(</span>B,<span style="color: #0000dd;">101</span>,<span style="color: #0000dd;">3</span><span style="color: #000000;">)</span></pre>
<li> <b>OK</b>をクリックすると、列に平滑化された値が入力されます。
</ol>


    