<h1 class="firstheading">外れ値を検出する</h1>
<p class="urlname" style="display: none;">Detect-Outlier</p>
<p>統計的に、他のデータと比べて数値として離れている値を外れ値といいます。Originは外れ値を探してテストするツールと手法を提供します。</p>
<p>繰り返し計測されるデータセットに外れ値があるか判断する場合には、Grubbs検定やDixon's Q検定のようなツールも提供していますし、<a class="external text" href="../../QuickHelp/QuickHelp/How_do_I_identify_and_eliminate_outliers.html">Q-Qプロットを通じて大まかに視覚化する事</a>も可能です。</p>
<p>回帰から外れ値を検出するには、正規残差を使う事ができます。</p>
<p>データポイントが外れ値であることを統計的に判別したら、「プロット操作・オブジェクト作成」ツールバーの<b>領域マスクツールボタン</b><a class="image"><img alt="Regional Mask Tool.png" src="../images/Detecting_Outliers/Regional_Mask_Tool.png" width="23" height="23" border="0" /></a>を使って<a class="external text" href="../../GettingStarted/OriginLab/Data_Analysis.html#Data_Masking">ポイントをマスク</a>することができます。</p>
<p><br /></p>
<h2><span class="mw-headline" id="Grubbs_Test">Grubbs検定</span></h2>
<p>繰り返し計測されたデータが列にリストされている場合、外れ値の有無を検出するにはGrubbs検定を使います。</p>
<ol>
<li>メニューから<b>統計：記述統計：Grubbs検定</b>と操作し、<b>grubbs</b>ダイアログを開きます。</li>
<li>入力データ範囲を設定し、有意水準と他の設定を指定して<b>OK</b>をクリックします。</li>
</ol>
<p><a class="image"><img alt="Grubbs Test.png" src="../images/Detecting_Outliers/Grubbs_Test.png" width="457" height="350" border="0" /></a></p>
<p>または</p>
<ol>
<li><b style="font-weight: bold;">コマンドウィンドウ</b>を開きます。</li>
<li>Xファンクションから<a class="external text" href="../../XFunction/X-Function/Grubbs.html">grubbs</a> を直接呼び出します。</li>
</ol>
<p>結果は<b>コマンドウィンドウ</b>と<b>結果ログ</b>の両方に出力します。また、<b>外れ値のグラフ</b>をダイアログで選択した場合、作図データを含むワークシートも出力されます。</p>
<table class="dialogcontroltable">
<tr>
<th>ox</th>
<td>疑わしいポイントの値</td>
</tr>
<tr>
<th>index</th>
<td>疑わしいポイントの行インデックス</td>
</tr>
<tr>
<th>gstat</th>
<td>疑わしいポイントから計算されたg値</td>
</tr>
<tr>
<th>critical</th>
<td>指定された有意水準の棄却限界g値</td>
</tr>
<tr>
<th>pval</th>
<td>検定のためのp値</td>
</tr>
<tr>
<th>sig</th>
<td>sig=1 は外れ値がある事を意味し、 sig=0 は外れ値が無いことを意味します。</td>
</tr>
<tr>
<th>conclusion</th>
<td>統計結果に基づき、結果の一文を掲載します。</td>
</tr>
<tr>
<th>rd</th>
<td><b style="font-weight: bold;">外れ値のグラフ</b>オプションが選択されていた時、そのデータを入力したワークシートの範囲を示します。</td>
</tr>
<tr>
<th>rt</th>
<td>レポート表を出力するワークシート範囲を示します。</td>
</tr>
</table>
<h2><span class="mw-headline" id="Dixon.27s_Q_Test">DixonのQ検定</span></h2>
<p>繰り返し計測されたシリーズが列にリストされている(標本サイズが3から10)場合、外れ値の有無を検出するにはDixonのQ検定を使います。</p>
<ol>
<li>メニューから<b>統計：記述統計：DixonのQ検定</b>と操作し、<b>qtest</b>グを開きます。</li>
<li>入力データ範囲と有意水準の設定を指定して<b>OK</b>をクリックします。</li>
</ol>
<p><a class="image"><img alt="Dixons Q Test.png" src="../images/Detecting_Outliers/Dixons_Q_Test.png" width="468" height="350" border="0" /></a></p>
<p>または</p>
<ol>
<li><b style="font-weight: bold;">コマンドウィンドウ</b>を開きます。</li>
<li>Xファンクションから <a class="external text" href="../../XFunction/X-Function/Qtest.html">qtest</a>を直接呼び出します。</li>
</ol>
<p>結果は<b>コマンドウィンドウ</b>と<b>結果ログ</b>の両方に出力されます。</p>
<table class="dialogcontroltable">
<tr>
<th>ox</th>
<td>疑わしいポイントの値</td>
</tr>
<tr>
<th>index</th>
<td>疑わしいポイントの行インデックス</td>
</tr>
<tr>
<th>qstat</th>
<td>疑わしいポイントから計算されたQ値</td>
</tr>
<tr>
<th>critical</th>
<td>指定された有意水準の棄却限界Q値</td>
</tr>
<tr>
<th>sig</th>
<td>sig=1 は外れ値がある事を意味し、 sig=0 は外れ値が無いことを意味します。</td>
</tr>
<tr>
<th>conclusion</th>
<td>統計結果に基づき、結果の一文を掲載します。</td>
</tr>
<tr>
<th>rd</th>
<td><b style="font-weight: bold;">外れ値のグラフ</b>オプションが選択されていた時、そのデータを入力したワークシートの範囲を示します。</td>
</tr>
<tr>
<th>rt</th>
<td>レポート表を出力するワークシート範囲を示します。</td>
</tr>
</table>
<h2><span class="mw-headline" id="Detect_Outlier_with_Residual_Plot">外れ値を残差プロットから検出する</span></h2>
<p>回帰(線形、多項式、非線形)を実行して、正規化した残差を使って、どのデータポイントが外れ値なのかを判別します。</p>
<p>次の簡単なチュートリアルは残差プロットから外れ値を検出する方法を示します。</p>
<table class="noborder">
<tr>
<td style="vertical-align: top;" width="60"><img src="../images/Detecting_Outliers/Tutorial_icon.png" alt="" width="57" height="57" border="0" /></td>
<td>
<ol>
<li>新しいワークブックを開き、<b>Samples\Curve Fitting\Outlier.dat</b>ファイルを開きます。</li>
<li>2番目の列をクリックして選択し、メニューから「<b>作図：シンボル図：散布図</b>」を選択して散布図を作成します。</li>
<li>グラフをアクティブにしたうえでメニューから<b>解析：フィット：線形フィット</b>と操作して、線形フィットダイアログを開きます。以前に「線形フィット」ダイアログを使ったことがある場合、サブメニューが開きますので、「<b>&gt;&gt;ダイアログを開く</b>」サブメニューを選択します。</li>
<li>ダイアログ内の<b>フィットオプション</b>ツリーノードを開き、<b>図上値によるフィット</b>のチェックボックスにチェックを付けます。</li>
<li>『<b>残差解析</b>』ツリーノードを開き、『<b>正規化</b>』チェックボックスにチェックを付けます。</li>
<li>ダイアログの一番上にある「<b>再計算</b>」ドロップダウンリストを「<b>自動</b>」にし、ダイアログの一番下にあるOKボタンをクリックします。ダイアログが閉じ、データに線形回帰が実行されます。</li>
<li>データワークブックの「<b>FitLinearCurves1</b>」結果シートを選択し、右方向にスクロールして、「<b>標準化残差</b>」列を表示します。ここで、このデータの6行目の値は<b>-2.54889</b>なので、これが外れ値であるとわかります。<br />
<br />
<a class="image"><img alt="DetectOutlier 001.png" src="../images/Detecting_Outliers/DetectOutlier_001.png" width="738" height="280" border="0" /></a></li>
<li>グラフをアクティブにして、「プロット操作・オブジェクト作成」ツールバーの<b>領域マスクツール</b>のボタンをマウスで数秒押します。フライアウトメニューの最初の項目<b>現プロットを対象にマスクを付加する</b>サブメニューを選択します。<br />
<br />
<a class="image"><img alt="MaskToolbar.png" src="../images/Detecting_Outliers/MaskToolbar.png" width="268" height="148" border="0" /></a><br />
<br /></li>
<li>上記のサブメニューでグラフの6番目のデータポイントをクリックして、マスクします。これにより線形フィットでの入力データが変わり、自動更新機能が働きます。このマスクしたデータを除外して線形フィットが再度実行されます。グラフ内のフィット曲線と貼り付けたパラメータが自動的に更新されます。結果のグラフは、次のようになります。<br />
<br />
<a class="image"><img alt="OutlierRemovalGraph.jpg" src="../images/Detecting_Outliers/OutlierRemovalGraph.jpg" width="448" height="337" border="0" /></a><br /></li>
</ol>
</td>
</tr>
</table>

