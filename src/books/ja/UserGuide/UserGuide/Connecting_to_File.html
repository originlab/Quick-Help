<h1 class="firstheading">ファイルに接続</h1><p class='urlname' style='display: none'>Connect-to-File</p>
<p>データコネクタは、Originワークシート/行列と、PCまたはローカルネットワーク上のデータファイルの接続を構築します。一般的なファイルが多くサポートされています。 
</p><p>コネクタとインポート機能の違いについては、<a class="external text" href="../../QuickHelp/QuickHelp/Data_Connector_Difference_Import_From_File.html"><b>FAQ-1020 コネクタとインポート機能の違いはなんですか?</b></a>を参照してください。
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Connecting_to_File/Tip_icon.png" width="57"  border="0" /></td><td><p><font color="blue"><b>新規追加メニューで新しいコネクタタイプを追加するには、 </b></font>
</p><p>追加のファイルタイプ用のコネクタが、<b>データ: ファイルに接続</b>メニューの一番下のメニューアイテム<b>新規追加</b>を選択して追加できます。これにより、アプリセンターが開き、未インストールのコネクタアプリのみ表示します。<b>Download and Install</b>アイコンをクリックして、コネクタアプリをPCにインストールします。
</p><p>あるいは、OriginLab社Webサイトの<a class="external text" href="https://www.originlab.com/Fileexchange/index.aspx?t=App&amp;c=000001&amp;v2=NULL&amp;o=UpdateOnDESC" target="_blank">Originファイル交換の場</a>を開き、リストからコネクタを選択します。アプリページで、<b>Download File</b>ボタンをクリックし、ダウンロードが完了したらOriginワークシートにファイルをドラッグします。アプリのドキュメントは、アプリページの<b>説明</b>セクションを確認してください。
</p><p><font color="blue"><b>ファイルに接続メニューをカスタマイズするには、 </b></font>
</p><p><b>データ：ファイルに接続：カスタマイズ...</b>を選択すると、<b>データ：ファイルに接続</b>メニューをカスタマイズできます。<br />
<p><a  class="image"><img alt="Menu Customization.png" src="../images/Connecting_to_File/Menu_Customization.png" width="352"  /></a>
</p>
</p><p>インストールされているすべてのデータコネクタがここに一覧表示されます。またチェックボックスを使用して、<b>データ：ファイルに接続</b>メニューに表示するコネクタを決定できます。
</p></td></tr></table>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Adding_a_Connector_to_the_Book"><span class="tocnumber">1</span> <span class="toctext">ブックにコネクタを追加</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Text.2FCSV_Connector"><span class="tocnumber">2</span> <span class="toctext">テキスト/CSVコネクタ</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Extract_variable_from_data_cells"><span class="tocnumber">2.1</span> <span class="toctext">データセルから変数を抽出</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Data_Block_Markers"><span class="tocnumber">2.2</span> <span class="toctext">データブロックマーカー</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Customize_File_Extensions"><span class="tocnumber">2.3</span> <span class="toctext">ファイル拡張子の編集</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Excel"><span class="tocnumber">3</span><span class="toctext">Excelファイル</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#JSON.2FXML"><span class="tocnumber">4</span> <span class="toctext">JSON/XMLファイル</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#MATLAB"><span class="tocnumber">5</span> <span class="toctext">MATLAB</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#HDF"><span class="tocnumber">6</span> <span class="toctext">HDFファイル</span></a>
<ul>
<li class="toclevel-2 tocsection-10"><a href="#Tips_for_HDF_Import"><span class="tocnumber">6.1</span> <span class="toctext">HDFファイルインポートのヒント</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-11"><a href="#TDMS"><span class="tocnumber">7</span> <span class="toctext">TDMSファイル</span></a></li>
<li class="toclevel-1 tocsection-12"><a href="#N42"><span class="tocnumber">8</span> <span class="toctext">N42</span></a></li>
<li class="toclevel-1 tocsection-13"><a href="#NetCDF"><span class="tocnumber">9</span> <span class="toctext">NetCDFファイル</span></a></li>
<li class="toclevel-1 tocsection-14"><a href="#Shapefile"><span class="tocnumber">10</span> <span class="toctext">シェープファイル</span></a></li>
<li class="toclevel-1 tocsection-15"><a href="#Origin_File"><span class="tocnumber">11</span> <span class="toctext">Originファイル</span></a></li>
<li class="toclevel-1 tocsection-16"><a href="#HTML_Table"><span class="tocnumber">12</span> <span class="toctext">HTML表</span></a></li>
<li class="toclevel-1 tocsection-17"><a href="#Connect_Multiple_Files"><span class="tocnumber">13</span> <span class="toctext">複数ファイルに接続</span></a></li>
<li class="toclevel-1 tocsection-18"><a href="#Import_a_File_with_Filter"><span class="tocnumber">14</span> <span class="toctext">フィルタでファイルをインポート</span></a></li>
<li class="toclevel-1 tocsection-19"><a href="#Clone_Import"><span class="tocnumber">15</span> <span class="toctext">クローンインポート</span></a></li>
<li class="toclevel-1 tocsection-20"><a href="#Connect_Files_by_Appending_Rows_to_Current_Sheet"><span class="tocnumber">16</span> <span class="toctext">現在のシートに行を追加してファイルを接続する</span></a></li>
</ul>
</div>
<h2><a name="Adding_a_Connector_to_the_Book"></a><span class="mw-headline">ブックにコネクタを追加</span></h2>
<p>ブックにデータコネクタを追加してデータをインポートする方法
</p>
<ol><li> ワークシート/行列をアクティブにして、<b>データ: ファイルに接続: <i>データタイプ</i></b>を選択します。 </li>
<li> <b>開く</b>ダイアログボックスから目的のデータファイルを選択します。</li></ol>
<p><br />
インポートオプションを構築する、コネクタのダイアログボックスが開きます。 
</p>
<dl><dd><ul><li> MS ExcelやMATLABのような複数ページのファイルでは、インポートする初めのシートを選択します。（例：<b>Excelシート</b>）インポートすると、折りたたみ可能な<a href="../../UserGuide/UserGuide/Data_Navigator.html" title="ユーザガイド:データナビゲータ"><b>データナビゲータ</b></a>パネルがブックに追加され、残りのシートのファイルにアクセスできるようになります。</li>
<li> 接続されたファイル名はブックの<a href="../../UserGuide/UserGuide/Origin_Child_Window_Naming_Conventions.html" title="ユーザガイド:Originのウィンドウの命名規則"><b>ロングネーム</b></a>として追加されます。（CSV、Originファイルには適用されません。）</li></ul>
<dl><dd><a  class="image"><img alt="DC Rename book on import.png" src="../images/Connecting_to_File/DC_Rename_book_on_import.png" width="568"  /></a></dd></dl>
<ul><li> 行列ブックをファイルに接続する際、インポートされた行列の数がシステム変数<a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#M"><b>@MSS</b></a>（デフォルト= 10）の値を超えると、<a href="../../UserGuide/UserGuide/Viewing_and_Profiling_Matrix_Data.html" title="ユーザガイド：行列データの表示とプロファイル"><b>イメージモード</b>と<b>イメージサムネイル／スライダー</b></a>が自動的に有効になります。Originファイルには適用されません。システム変数の値を変更する方法については、<a class="external text" href="../../QuickHelp/QuickHelp/How_do_I_permanently_change_the_value_of_a_system_variable.html">このFAQ</a>を参照してください。</li></ul></dd></dl>
<h2><a name="Text.2FCSV_Connector"></a><span class="mw-headline">テキスト／CSVコネクタ</span></h2>
<p>テキスト／CSVコネクタはCSV、TXT、ASCなどのテキストファイルをインポートするために使用します。
</p>
<ul>
<li> 自動で<b>メインヘッダ行</b>を決定するか、チェックボックスのチェックを外して列ロングネーム、単位、コメントを含むメインヘッダとサブヘッダの指定を手動で指定します。<b>ヒント</b>: 自動検出されたメインヘッダー行の数が青文字で表示されます。</li> 
<li> メインヘッダ行を自動検出または、手動で指定すると、インポートダイアログに<b>ファイルヘッダーの保存先</b>ドロップダウンリストが表示され、ファイルヘッダの内容を<a href="../../UserGuide/UserGuide/Displaying_Supporting_Data_in_Worksheet_header_Rows.html" title="ユーザガイド:ワークシートヘッダ行に表示するサポートデータ"><b>ワークシートラベル行</b></a>または<a href="../../UserGuide/UserGuide/The_Workbook_Organizer.html" title="ユーザガイド：ワークブックオーガナイザ"><b>ブックオーガナイザ</b></a>に保存することができます。
<table class="simple">
<tr>
<th> CSVインポートオプション
</th>
<th> メインヘッダ行がある場合のCSVインポートオプション
</th></tr>
<tr>
<td align="center"><a  class="image"><img alt="Csv import option dlg.png" src="../images/Connecting_to_File/Csv_import_option_dlg.png" width="402"  /></a>
</td>
<td align="center"><a  class="image"><img alt="Csv import option dlg-Organizer.png" src="../images/Connecting_to_File/Csv_import_option_dlg-Organizer.png" width="407"  /></a>
</td></tr></table>
</li>
<li> インポートされたファイル（一部の*.pilファイルなど）にヘッダとデータ部分を分割するための区切り行がある場合（「END OF headER」など）、<b>メインヘッダ行</b>の横にある<b>自動</b>をオフにし、<b>メインヘッダ行</b>に0を入力し、<b>メインヘッダ行の終了</b>チェックボックスにチェックを入れ、コンボボックスに定義された区切り文字テキストを入力します。
<a  class="image"><img alt="CSV end of header lines.png" src="../images/Connecting_to_File/CSV_end_of_header_lines.png" width="629"  /></a></li>
<li> <b>最初の50行をプレビューとしてインポート</b>したり、<a href="../../UserGuide/Category/Partial_Importing_and_Re_Importing.html#Partial_Import" title="カテゴリー: 部分インポートと再インポート">部分インポート</a>のオプションも利用可能です。</li>
<li> <b>他のオプション</b>ボタン（<b>OK</b>の左）をクリックするとオプションを利用できます。 
<ul><li> <b>スパークラインの追加</b>: インポートの際<a class="external text" href="../../QuickHelp/QuickHelp/What_is_a_Sparkline_and_how_do_I_customize_it.html">スパークライン</a>を有効にします。インポート時にスパークラインを無効にするには、<a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#H.2CI.2CJ.2CK"><b>@IMPS</b> = <i>0</i></a>に設定します。</li>
<li> <b>ファイル名による名前変更</b>：CSVのみ。<b>シート</b>と<b>ブックロングネーム</b>のオプションがあります。</li>
<li> <b>デフォルトに保存</b>: CSVのみ。<b>スパークライン</b>と<b>ファイル名による名前変更</b>の設定をデフォルトに設定するボタンです。</li>
<li> <b>インポート後に実行するLabTalkスクリプト</b>: インポート時のデータの後処理を行うスクリプトを実行します。</li></ul>
<dl><dd><a  class="image"><img alt="CSV post import lt scripts.png" src="../images/Connecting_to_File/CSV_post_import_lt_scripts.png" width="743"  /></a></dd></dl>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Connecting_to_File/Tip_icon.png" width="57"  border="0" /></td><td><p><b>インポート後に実行するLabTalkスクリプト</b> はヘッダ行でなくデータセル () から変数を抽出するために使用できます。<a href="#Extract_variable_from_data_cells">次のセクション</a>のサンプルを参照してください。 
</p></td></tr></table>
</li>
<li> <b>CSVデータコネクタ</b>でデータをインポート後、選択した列で右クリックして<b>ソート（ワークシート）</b>を選択して全ワークシートをソートできます。
<li> 複数のCSVファイルを同じワークシートにインポートし、行ごとに追加する場合は、LabTalkスクリプトを使用してそれを行うことができます。<a class="external text" href="../../LabTalk/Category/Wks.DC_(object).html#Examples">LabTalkドキュメントページ</a>で「EX2」を参照してください。
</ul></ul>
<h3><a name="Extract_variable_from_data_cells"></a><span class="mw-headline">データセルから変数を抽出</span></h3>
<p>データセルから情報を抽出して、ワークシート変数に保存するには、<b>インポート後に実行するLabTalkスクリプト</b>ダイアログを使用します。
</p><p>以下のサンプルでは、最初の列に実験日が入力されており、それをユーザー定義変数として抽出します。以下の<b>インポート後に実行するLabTalkスクリプト</b>を実行してシートレベルの文字列変数 &quot;MDate&quot; を追加し最初のセル値を割り当てます。
</p>
<pre class="lt" style="font-family:monospace;">page.<span style="color: #000080;">info</span>.<span style="color: #000080;">add</span><span style="color: #000000;">(</span>user<span style="color: #000000;">)</span>;
page.<span style="color: #000080;">info</span>.<span style="color: #000080;">user</span>.<span style="color: #000080;">addsection</span><span style="color: #000000;">(</span>variables<span style="color: #000000;">)</span>;
string str1<span style="color: #000080;">=</span>left<span style="color: #000000;">(</span>col<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span><span style="color: #000000;">[</span><span style="color: #0000dd;">1</span><span style="color: #000000;">]</span><span style="color: #000080;">$</span>, <span style="color: #0000dd;">10</span><span style="color: #000000;">)</span><span style="color: #000080;">$</span>;
page.<span style="color: #000080;">info</span>.<span style="color: #000080;">user</span>.<span style="color: #000080;">variables</span>.<span style="color: #000080;">addstring</span><span style="color: #000000;">(</span>MDate, <span style="color: #ff00ff;">&quot;%(str1$)&quot;</span><span style="color: #000000;">)</span>;
del col<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span>;</pre> 
<p>インポート後、ワークブックオーガナイザでこの変数&quot;MDate&quot;を確認できます。
</p>
<dl><dd><a  class="image"><img alt="Extract variable from data cells via Post Import LT Script.png" src="../images/Connecting_to_File/Extract_variable_from_data_cells_via_Post_Import_LT_Script.png" width="651"  /></a></dd></dl>
<h3><a name="Data_Block_Markers"></a><span class="mw-headline">データブロックマーカー</span></h3>
<p>ファイルにデータと非データが混在している場合、データブロックを表す文字を定義できます。
</p>
<ul><li> <b>開始</b>ボックスを使用して、データの開始を示す文字の並びを定義します。文字の並びがセクション表記を使用している場合（つまり、<i>[Data]</i> のように角括弧で囲まれている場合など）、<b>終了</b>は空白のままにしてください。 </li>
<li> セクション表記を使用する場合、<b>メインヘッダ行</b>を<i>自動</i> にしてください。 </li>
<li> ワイルドカードのアスタリスク(*)とクオーテーションマーク(?)が使用可能です。</li>
<li> データブロックの終了に空の行がある場合は、<b>終了</b>を<i>&lt;blank&gt;</i>に指定できます。</li></ul>
<p><a  class="image"><img alt="OriginHelp Data Block Marker.png" src="../images/Connecting_to_File/900px-OriginHelp_Data_Block_Marker.png" width="1195"   /></a>
</p>
<h3><a name="Customize_File_Extensions"></a><span class="mw-headline">ファイル拡張子の編集</span></h3>
<p>CSVコネクタのファイル拡張子の設定を編集できます。これは、コネクタを開いたときにファイルブラウザの<b>ファイルの種類</b>ドロップダウンリストに表示されます。
</p><p>ファイル拡張子の編集方法
</p>
<ol><li>Originワークスペースの右側にあるアプリギャラリーのコネクタタブをアクティブにします。 </li>
<li>CSV Connectorアイコン上で右クリックして<b>ファイル拡張子の編集</b>を選択します。</li></ol>
<p><a  class="image"><img alt="CSV Data Connector Customize File Extensions.png" src="../images/Connecting_to_File/CSV_Data_Connector_Customize_File_Extensions.png" width="672"  /></a>
</p>
<ol>
<li>拡張子は<i>&quot;;&quot;</i>で区切ります。
<li><b>リセット</b>ボタンをクリックするとシステムデフォルトの牡蠣調子の設定にリセットできます。
<li><i>Origin.ini</i>ファイルでファイル拡張子を編集することもできます。
<ul>
<li>メニューから<b>ヘルプ: フォルダを開く: ユーザファイルフォルダ</b>を選択します。開いたユーザファイルフォルダで、<i>Origin.ini</i>ファイルを検索します。
<li>メモ帳などのテキストエディタで<i>Origin.ini</i>ファイルを開きます。<b>[DCFileGroup]</b> セクションを見つけます。このセクションの下に、ファイル拡張子の設定 (コネクタ名をキーとして) を追加します。<br />たとえば、次のようにすると、CSVデータコネクタのデフォルトのファイル拡張子が「すべてのファイル (*.*)」に変更されます。
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">[</span>DCFileGroup<span style="color: #000000;">]</span>
CSV Connector<span style="color: #000080;">=</span><span style="color: #000080;">*</span>.<span style="color: #000080;">*</span></pre>
</ul></ul>
</ol>
<h2><a name="Excel"></a><span class="mw-headline">Excel</span></h2>
<p>Excelコネクタの情報は、<a href="../../UserGuide/UserGuide/Importing_from_Excel.html" title="ユーザガイド：Excelからのインポート">Excelからのインポート</a>を参照してください。
</p>
<h2><a name="JSON.2FXML"></a><span class="mw-headline">JSON/XMLファイル</span></h2>
<p><b>データコネクタブラウザ</b>が開きます。
</p><p><a  class="image"><img alt="JSON DC dialog.png" src="../images/Connecting_to_File/JSON_DC_dialog.png" width="434"  /></a>
</p><p>上部パネルでインポートファイルの構造をロードします。 
</p>
<ol><li> ブランチをクリックすると右パネルにメタデータを表示します。 </li>
<li> 目的のブランチを選択して下向き矢印をクリックし、下部パネルに追加します。 </li>
<li> <b>OK</b>ボタンをクリックして選択したデータへの接続およびインポートをします。</li>
<li> ファイルに複数の配列、変数などが含まれている場合は、必要に応じて<b><a href="../../UserGuide/UserGuide/Data_Navigator.html" title="ユーザガイド:データナビゲータ">データナビゲータ</a></b>を使用して追加のデータに接続します。</li></ol>
<p><br />
<i><b>ヒント</b></i> 
</p>
<ul><li> <b>MATLAB</b>、<b>JSON</b>、<b>NetCDF</b>ファイル（ローカルファイルまたは<a href="../../UserGuide/UserGuide/Connecting_to_Web.html" title="ユーザガイド: Webに接続">Webファイル</a>）に接続する場合、データファイルに再接続するときに<a class="external text" href="../../QuickHelp/QuickHelp/Add_Worksheet_Comment_and_Name.html">カスタムシート名</a>が保持されます（データコネクタメニュー<a  class="image"><img alt="Dadta connector icon connect.png" src="../images/Connecting_to_File/Dadta_connector_icon_connect.png" width="16"  /></a>から<b>すべてのブックをインポート</b>または<b>インポート</b>）。これは、ツリーフレームワークを使用するファイルタイプにのみ適用され、ExcelやText/CSVなどの他のファイルタイプには適用されません。</li>
<li> インポートしたJSON/XML/Preship XMLファイルからのメタデータは<a href="../../UserGuide/UserGuide/The_Workbook_Organizer.html" title="ユーザガイド：ワークブックオーガナイザ">ワークブックオーガナイザ</a>に保存されます。メタデータを確認するにはワークシートの左の方にある<b>˅</b>のボタンをクリックしてオーガナイザパネルを表示します。ワークシートラベル行にメタデータを挿入するには、オーガナイザで目的のツリーノードを右クリックして<b>ノードパスをコピーする</b>を選択し、列ラベルセルに移動して右クリックし、<b>リンクの貼り付け</b>を選択します。</li></ul>
<h2><a name="MATLAB"></a><span class="mw-headline">MATLAB</span></h2>
<p><b>データコネクタブラウザ</b>が開きます。
</p><p><a  class="image"><img alt="MATLAB DC dialog.png" src="../images/Connecting_to_File/MATLAB_DC_dialog.png" width="484"  /></a>
</p><p>上部のパネルには、インポートファイル内のすべての変数がツリーとして一覧表示されます。各変数の右側には、各変数をインポートできる場所を示す列があります。オプションには、ワークシート、行列シート、またはその両方があります。
</p>
<ol><li> 目的のブランチを選択して下向き矢印をクリックし、下部パネルに追加します。 </li>
<li> ワークブックがアクティブでファイルを行列にインポートする必要がある場合には、選択するダイアログが表示されます。
<dl><dd><a  class="image"><img alt="NetCDF rmatrix.png" src="../images/Connecting_to_File/NetCDF_rmatrix.png" width="353"  /></a>
<ul><li><b>新規行列ブックを使用</b>：最もシンプルな方法です。</li>
<li><b>埋め込み行列ブックを使用</b>：行列にデータをインポートしますが、行列はワークブックにシートとして埋め込まれます。</li>
<li><b>ワークシート列（遅くなる可能性があります）</b>：これにより、行列の各時間フレームが複数の列にインポートされるため、多数の列を含むワークシートが作成され、データが大きい場合は速度が低下する可能性があります。</li></ul></dd></dl></li>
<li> オプションを選択して<b>OK</b>をクリックするとデータがインポートされます。</li>
<li> ファイルに複数の配列、変数などが含まれている場合は、必要に応じて<b><a href="../../UserGuide/UserGuide/Data_Navigator.html" title="ユーザガイド:データナビゲータ">データナビゲータ</a></b>を使用して追加のデータに接続します。</li></ol>
<h2><a name="HDF"></a><span class="mw-headline">HDFファイル</span></h2>
<p>HDFコネクタは、ローカルまたは<a href="../../UserGuide/UserGuide/Connecting_to_Web.html" title="ユーザガイド: Webに接続">Web</a>上のHDF5 (.h5, .he5, .hdf5) 、MATLABのバージョン7.3のmatファイルをインポートする際に使用できます。詳細については、<a class="external text" href="https://www.originlab.com/FileExchange/details.aspx?fid=535" target="_blank">OriginLabのファイルの交換の場のページ</a>を参照してください。
</p><p>ファイルへの接続を開始すると、<b>データコネクタブラウザ</b>が開き、ファイル内のすべての変数がツリーとして一覧表示されます。各変数の右側には、各変数をインポートできる場所を示す列があります。次の図に示すように、オプションには<b>ワークシート</b>、<b>行列</b>シート、またはその<i>両方</i>が含まれます。
</p>
<dl><dd><a  class="image"><img alt="Data Connector Browser H5.png" src="../images/Connecting_to_File/Data_Connector_Browser_H5.png" width="727"  /></a></dd></dl>
<p>ファイル内の任意のノードに直接接続できます。ワークシートがアクティブで変数に<b>行列</b>マークがついている場合、ノードを行列ブックにインポートするか聞かれます。ただし、行列データをワークブックにインポートするように選択すると、Originは自動的に<a href="../../UserGuide/UserGuide/Adding_Existing_Graphs_Matrixs_as_Sheets.html" title="ユーザガイド:既存のグラフ/行列をシートとして追加">アクティブワークブック内の行列シートとしてノードを追加</a>します。
</p><p>ファイルの階層に接続すると、<a href="../../UserGuide/UserGuide/Data_Navigator.html" title="ユーザガイド:データナビゲータ"><b>データナビゲータ</b></a>が開き、個々のノードに選択的に接続できます。前述のように、データがアクティブなシートと互換性がある場合、それらはシートにインポートされます。別のシートタイプが必要な場合は、アクティブなブックに追加されます。
</p>
<dl><dd><a  class="image"><img alt="Data Navigator Add Matrixsheet.png" src="../images/Connecting_to_File/Data_Navigator_Add_Matrixsheet.png" width="664"  /></a></dd></dl>
<h3><a name="Tips_for_HDF_Import"></a><span class="mw-headline">HDFファイルインポートのヒント</span></h3>
<ul><li> 他の複雑な構造のファイル (NetCDFを含む) と同様に、<b>ナビゲータ</b>パネルのショートカットメニューがあります。HDFコネクタには、データインポートのスクリプトを作成しているユーザが関心を持つ可能性がある1つの一意のエントリ (<b>パスをコピーする</b>) があります。複雑なツリー構造の奥深くにあるパスをコピーするのは難しいため、エントリをクリックして<b>パスをコピーする</b>を利用します。</li></ul>
<dl><dd><a  class="image"><img alt="OH HDF5 shortcut menu copy path.png" src="../images/Connecting_to_File/OH_HDF5_shortcut_menu_copy_path.png" width="494"  /></a></dd></dl>
<ul><li> HDFコネクタを使用してインポートのスクリプトを作成する場合、<b>ナビゲータ</b>パネルを表示しないことで、データのインポートを大幅に高速化できます。これは、コネクタを追加するときに引数 (&quot;1&quot;) を追加することで実行できます。</li></ul>
<pre class="lt" style="font-family:monospace;">wbk.<span style="color: #000080;">dc</span>.<span style="color: #000080;">add</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;HDF&quot;</span>, <span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>;</pre>
<h2><a name="TDMS"></a><span class="mw-headline">TDMSファイル</span></h2>
<p>Originの<b>TDMSコネクタ</b>を使用して、.tdmおよび.tdmsファイルからデータをインポートできます。 
</p><p><br />
<i><b>TDMSファイルをインポートする方法</b></i>
</p>
<ol><li> 新規のワークブックから、<b>データ:ファイルに接続:TDMS</b>を選択します。ファイルを選択して、<b><b>開く</b></b>をクリックします。</li>
<li> <b>データコネクタブラウザ</b>で、ノードをダブルクリックするか、ブラウザ内で選択後に<b>インポートするデータを選択</b>ボタンをクリックします。下部パネルにノードが追加されます。接続文字列を変更すれば<a href="../../UserGuide/Category/Partial_Importing_and_Re_Importing.html#Partial_Import_by_TDMS_Connector" title="カテゴリー: 部分インポートと再インポート">部分インポート</a>も可能です。</li>
<li> <b>OK</b>をクリックして、データをインポートします。 </li></ol>
<p>（ブラウザの上部にある<i>TDMS</i>を選択して）すべてのノードをインポートする場合、各チャネルはchannelという名前の個別のシートにインポートされます。メタデータは各列に追加されます（<b>ロングネーム</b>、<b>単位</b>、<i>node_source_attributes</i> というラベルの付いたユーザーパラメーター行など）。シートにはchannelという名前が付けられ、ファイル名はブックの<b>ロングネーム</b>に設定されます。<b>すべてのグループを同じワークシートにインポート</b>するを選択した場合、属性は<a href="../../UserGuide/UserGuide/Displaying_Supporting_Data_in_Worksheet_header_Rows.html" title="ユーザガイド:ワークシートヘッダ行に表示するサポートデータ">列ラベル行</a>領域に保存されますが、シート名は変更されません。
</p><p><br />
<i><b>関連のあるトピック</b></i>
</p>
<ul><li> <a href="../../UserGuide/Category/Partial_Importing_and_Re_Importing.html#Partial_Import_by_TDMS_Connector" title="カテゴリー: 部分インポートと再インポート">部分インポート</a></li>
<li> <a class="external text" href="../../LabTalk/LabTalk/Column_Label_Row_Characters.html">列ラベル行データへのLabTalkアクセス</a></li></ul>
<h2><a name="N42"></a><span class="mw-headline">N42</span></h2>
<p>Originの<b>N42 Connector</b>は、さまざまな放射線機器によって生成されたデータをインポートするために使用されます。
</p><p><br />
<i><b>N42ファイルをインポートするには</b></i>
</p>
<ol><li> 新規のワークブックから、<b>データ:ファイルに接続:N42</b>を選択します。ファイルを選択して、<b><b>開く</b></b>をクリックします。</li></ol>
<h2><a name="NetCDF"></a><span class="mw-headline">NetCDF</span></h2>
<p>NetCDFファイルは、変数の配列を保存するための自己記述型のスケーラブルな形式です。科学データを交換するための柔軟な形式として設計されており、地理学の研究に容易に適応でき、大気および気候科学で広く使用されています。バージョン<b>2021b</b>以降、OriginのNetCDFコネクタは、地理ベースの調査で使用されるデータセットタイプを処理できるように改善されました。 
</p>
<dl><dd><a  class="image"><img alt="Help connect netCDF import ch 1.png" src="../images/Connecting_to_File/Help_connect_netCDF_import_ch_1.png" width="800"  /></a></dd></dl>
<p><a href="../../UserGuide/Category/Partial_Importing_and_Re_Importing.html#Partial_Import_by_NetCDF_Connector" title="カテゴリー: 部分インポートと再インポート">部分インポート</a>（日付範囲の指定、読み取り/スキップまたは平均化）、経度変換、緯度の反転、緯度と経度によるサブ領域の指定、インポート時に行列値を変換するオプションなどに加えて、以下のような役立つ機能があります。
</p>
<ul><li> <a class="external text" href="../../GettingStarted/OriginLab/Matrix_Book_Matrix_Sheet_Matrix_Objects.html#Image_Thumbnails_and_Image_Slider">オブジェクトの<b>サムネイル</b>を表示したり、<b>スライダー</b>でオブジェクトをスクロール</a>できるOrigin行列シートにインポート</li>
<li> インポートされた行列の<a href="../../UserGuide/UserGuide/Data_Navigator.html" title="ユーザガイド:データナビゲータ"><b>データナビゲーター</b></a>パネルでファイルのメタデータにアクセス</li>
<li> 行列データを分析および操作するツール：<a class="external text" href="../../GettingStarted/OriginLab/Matrix_Book_Matrix_Sheet_Matrix_Objects.html#Manipulation_of_Matrix_Data"><b>ピクセル抽出</b>、<b>線形フィット</b>、<b>記述統計</b>、<b>減算</b>、<b>転置</b>など</a></li>
<li> 行列からサブ領域を抽出するためのツール：<a class="external text" href="../../GettingStarted/OriginLab/Matrix_Book_Matrix_Sheet_Matrix_Objects.html#Manipulation_of_Matrix_Data"><b>ピクセル抽出</b>、<b>xyzとしての抽出</b>、<b>トリミング</b>、<b>関心領域のエクスポート</b>など</a></li>
<li> 標準およびカスタムパレットを使った<a class="external text" href="../../UserGuide/UserGuide/Image_Plot.html"><b>イメージプロット</b></a>。パレットファイルは<a class="external text" href="../../QuickHelp/QuickHelp/Can_I_use_external_color_palette_files_to_apply_color_to_contour_plots_and_other.html">ドラッグ&amp;ドロップ</a>でOriginに追加可能。</li></ul>
<dl><dd><a  class="image"><img alt="Help connect netCDF import ch 2.png" src="../images/Connecting_to_File/Help_connect_netCDF_import_ch_2.png" width="796"  /></a></dd></dl>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Connecting_to_File/Tip_icon.png" width="57"  border="0" /></td><td><p>地図データを操作するときは、イメージプロットをアクティブにし、<b>挿入</b>メニューを使って、米国本土または世界地図の境界を挿入できます。
</p></td></tr></table>
<p><br />
<i><b>ローカルの.ncファイルをインポートする</b></i>
</p>
<ol><li> ワークブックや行列ブックがアクティブな状態で、<b>データ：ファイルに接続</b>を選択します。 </li>
<li> 下の<i><b>データコネクターブラウザ</b></i> での操作を行います。</li></ol>
<p><br />
<i><b>URLを指定してWeb上の.ncファイルをインポートする</b></i>
</p>
<ol><li> ワークブックや行列ブックがアクティブな状態で、<b>データ：Webに接続</b>を選択します。</li>
<li> 開いたダイアログで、<b>ファイルタイプ</b>を<i>NetCDF</i> （任意）にし、(a)<b>最近使ったURL</b>をクリックして、リストから.ncファイルを選択するか、(b)テキストボックスに直接<b>URL</b>を入力（例えば、<i>https://psl.noaa.gov/thredds/fileServer/Datasets/cpc_us_precip/precip.V1.0.1948.nc</i>）し、<b>OK</b>をクリックします。</li>
<li> 下の<i><b>データコネクターブラウザ</b></i> での操作を行います。</li></ol>
<p><br />
<i><b>データコネクターブラウザ</b></i>
</p>
<ol><li> インポートしたい多次元変数（例えば、<i>time * lat * lon</i>など）を選択して、<b>インポートするデータを選択</b>ボタンをクリックし、下部パネルにデータを追加します。ワークブックがアクティブで、ファイルインポートに行列ブックが必要な場合は、(a)新しい行列ブックを開くか、(b)アクティブワークブックに行列ブックを埋め込むか、(c)ワークシート列にデータをインポートするか聞かれます。通常、1次元変数はワークブック、多次元変数は行列ブックにインポートする必要があります。</li>
<li> <b>インポートオプション</b>ボタン（「鉛筆」アイコン）をクリックして、オプションを設定できます。ここでは、部分インポートを指定したり、経度を変換したり、行列を垂直方向に反転したり、数式を使用してデータを変換したりできます。
<dl><dd><a  class="image"><img alt="OH netcdf import options.png" src="../images/Connecting_to_File/OH_netcdf_import_options.png" width="667"  /></a></dd></dl></li>
<li> <b>OK</b>をクリックしてインポートオプションを閉じ、再度<b>OK</b>をクリックしてブラウザを閉じてデータをインポートします。ファイルサイズが大きい場合は、インポート完了まで時間がかかることがあります。ファイルがインポートされると、ブックの左側にブラウザパネルが追加されます。行列ウィンドウの上側にあるスライダーで各行列オブジェクトの表示を切り替えできます。</li></ol>
<dl><dd><dl><dd><a  class="image"><img alt="OH matrix slider after import.png" src="../images/Connecting_to_File/OH_matrix_slider_after_import.png" width="799"  /></a></dd></dl></dd></dl>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Connecting_to_File/Tip_icon.png" width="57"  border="0" /></td><td><p>インポートが完了すると、<b>コネクタ</b>アイコンをクリックして<b>オプション</b>を選ぶことで<b>インポートオプション</b>を変更できます。
</p>
<dl><dd><dl><dd><a  class="image"><img alt="Help connect netCDF import ch 3.png" src="../images/Connecting_to_File/Help_connect_netCDF_import_ch_3.png" width="338"  /></a></dd></dl></dd></dl>
</td></tr></table>
<h2><a name="Shapefile"></a><span class="mw-headline">シェープファイル</span></h2>
<ul><li> ローカルファイルに接続するには、<b>データ：ファイル：Shapefile</b>をクリックします。Webに保存されたファイルに接続するには、<b>データ：Webに接続</b>を選択し、URLを入力します。 </li>
<li> Shapefileコネクタは単純な<b>インポートオプション</b>ダイアログを開きます。<b>属性をロード</b>チェックボックスを選択して、各シェープの列属性をインポートできます。列属性は、.shpファイルと同じ名前の.dbfファイルであり、同じフォルダに保存されます。<b>WGS84に変換</b> チェックボックスは、距離がメートル単位のシェープファイルを、経度と緯度を含むWGSシステムに変換します。</li></ul>
<dl><dd><a  class="image"><img alt="UG shapeifle options wgs84.png" src="../images/Connecting_to_File/UG_shapeifle_options_wgs84.png" width="261"  /></a></dd></dl>
<ul><li> インポート後、ワークシートに<i>X</i>、<i>Y</i>、<i>Feature ID</i>の少なくとも3つの列が表示されます。<i>X</i>座標と<i>Y</i>座標は、異なるセグメントを表すために欠損値で区切られています。複数のセグメントが1つの<i>Feature ID</i>を共有する場合があります。 </li></ul>
<p>詳細は、ファイルの交換ページの<a class="external text" href="https://www.originlab.com/fileExchange/details.aspx?fid=610" target="_blank"><b>Shapefile Connector</b></a>のページを参照してください。
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Connecting_to_File/Tip_icon.png" width="57"  border="0" /></td><td><p>シェープファイルの多角形の塗りつぶしについては、<a href="../../UserGuide/UserGuide/The_(Plot_Details)_Line_Tab.html#Fill_Area_Under_Curve" title="ユーザガイド:(作図の詳細)グラフの線タブ"><b>曲線以下の塗りつぶし</b> &gt; <b>方向により形状を塗りつぶし</b></a> を参照してください。
</p></td></tr></table>
<h2><a name="Origin_File"></a><span class="mw-headline">Originファイル</span></h2>
<p><b>Originコネクタ</b>はOriginプロジェクトファイル（opj(u)）もしくはワークブック（ogw(u)）からデータをインポートします。これにより、Originファイルをデータリポジトリとして使用できます。 
</p><p>プロジェクトファイルであろうと複数ページのワークブックであろうと、Originファイル内のデータに接続すると、<b>データコネクタブラウザ</b>が開きます。ここでは、インポートするデータを選択的に指定できます。ワークブックにコネクタを追加したら、<a href="../../UserGuide/UserGuide/Data_Navigator.html" title="ユーザガイド:データナビゲータ"><b>データナビゲータ</b></a>の列を右クリックし、<b>シートの追加と接続</b>を選択することで、必要に応じて他のワークシートをインポートできます。
</p><p>Origin 2020から、OriginコネクタはSQLのような<a href="../../UserGuide/UserGuide/Examples_of_using_SQL_query_condition_in_Origin_Connector.html" title="ユーザガイド: OriginコネクタでSQLクエリを使用するサンプル"><b>クエリ言語</b></a>を使用してOriginファイルから目的のデータを検索と目的のデータの抽出することが可能です。 
</p><p><a  class="image"><img alt="Project DC dialog.png" src="../images/Connecting_to_File/Project_DC_dialog.png" width="530"  /></a>
</p>
<ol><li><b>選択...</b>ダイアログで<b>クエリを選択</b>ボタン<a  class="image"><img alt="Select Query button.png" src="../images/Connecting_to_File/Select_Query_button.png" width="44"  /></a>をクリックして、<b>クエリを選択</b>ダイアログを開きます。</li>
<li>例えば、プロジェクト全体を検索し、指定されたロングネームとプロット属性を持つすべての列を引き出す、といったクエリ文字列を編集ボックスに入力します。</li>
<li><b>OK</b>ボタンをクリックして、下部パネルにクエリを追加します。再度<b>OK</b>をクリックして条件に合う列を新しいワークシートにインポートします。</li>
<li> クエリ機能に加えて、必要に応じて<a href="../../UserGuide/UserGuide/Data_Navigator.html" title="ユーザガイド:データナビゲータ"><b>データナビゲータ</b></a>を使用してすることでOriginプロジェクトの追加のシートに接続できます。</li></ol>
<h2><a name="HTML_Table"></a><span class="mw-headline">HTML表</span></h2>
<p><b>データコネクタブラウザ</b>が開きます。 
</p><p><a  class="image"><img alt="Json DC dialog.png" src="../images/Connecting_to_File/Json_DC_dialog.png" width="434"  /></a>
</p><p>上部パネルにWebページ上の全ての表がロードされます。目的の表を選択して下向き矢印をクリックし、下部パネルに追加します。<b><b>OK</b></b>をクリックして、インポートします。
</p>
<h2><a name="Connect_Multiple_Files"></a><span class="mw-headline">複数ファイルに接続</span></h2>
<p>このメニューを使用して、同じファイルのタイプと構造である複数のファイルに接続します。
</p>
<ol><li> ワークブックや行列ブックがアクティブな状態で、<b>データ：複数ファイルに接続</b>を選択します。</li></ol>
<dl><dd><a  class="image"><img alt="DC connect multiple files files2dc.png" src="../images/Connecting_to_File/DC_connect_multiple_files_files2dc.png" width="590"  /></a></dd></dl>
<ul><li> CSVファイルの場合、<b>同一ブック</b>にチェックを入れると、そのブックの名前は最初のファイルの名前になります。別々のブックにインポートする場合、各ブックはファイル名の名前になります。</li>
<li> ファイルのインポート前に、<b>第一ファイルでダイアログを開く</b>ボックスにチェックを入れ、インポート設定を調整します。</li>
<li> <b>列属性の設定</b>コンボボックスを使用して、インポート時のワークシートの<a href="../../UserGuide/UserGuide/Set_Column_Designation.html#Column_Designation_Symbols" title="ユーザガイド：列の属性の設定">列属性</a>を設定します。</li>
<li> <b>指定したフォルダ内のファイル</b>をインポートして<b>同一ブック</b>にインポートすることを選択し、<b>自動インポート：フォルダ変更時</b>をオンにすると、後で<b>ソース</b>フォルダ内のデータファイルを追加、削除、更新するときに、Originはフォルダをスキャンし、すべてのデータファイルを再度インポートします。<br />この場合、作業中のプロジェクトを保存すると、接続はデフォルトで相対パスとして保存されます。</li></ul>
<dl><dd><a  class="image"><img alt="Auto Import on Folder Change Multiple Files.png" src="../images/Connecting_to_File/Auto_Import_on_Folder_Change_Multiple_Files.png" width="949"  /></a></dd></dl>
<ul><li> <b>データコネクタ</b>を<b>インポートフィルタ</b>に指定した場合は、次項を参照してください。</li></ul>
<h2><a name="Import_a_File_with_Filter"></a><span class="mw-headline">フィルタでファイルをインポート</span></h2>
<p>このオプションを使用すると、<b>インポートウィザード</b>で作成した<a href="../../UserGuide/UserGuide/Import_Wizard_Basics.html#Creating_and_saving_data_import_instructions_using_the_Import_Wizard" title="ユーザガイド： インポートウィザードの基本">インポートフィルタファイル（*.OIF）</a>からデータコネクタを使用できます。
</p><p><i><b>単一ファイルに接続する場合</b></i><br />
</p>
<ol><li> ワークシート/行列をアクティブにして、<b>データ: ファイルに接続: インポートフィルタ</b>を選択します。</li>
<li> 開いたメニューから目的のデータファイルを選択します。</li>
<li> <b>フィルタを選択</b>ダイアログで、目的のフィルタを選択します。<b>OK</b>をクリックして、インポートします。</li></ol>
<dl><dd><a  class="image"><img alt="Select filter dialog.png" src="../images/Connecting_to_File/Select_filter_dialog.png" width="366"  /></a></dd></dl>
<p><br />
<i><b>複数ファイルに接続する場合</b></i><br />
</p>
<ol><li> <b>データ：複数ファイルに接続</b>を選択するか、インポートツールバーの<b>複数ファイルに接続</b>ボタン<a  class="image"><img alt="Button connect multiple files.png" src="../images/Connecting_to_File/Button_connect_multiple_files.png" width="25"  /></a>をクリックします。</li>
<li> <b>データコネクタ</b>を<b>インポートフィルタ</b>に指定します。</li>
<li> ファイルを選択し、それらを同じブックにインポートするか、別のブックにインポートするかを決定して、<b>OK</b>をクリックします。</li></ol>
<p>このオプションを選択すると、<a class="external text" href="../../XFunction/X-Function/Files2dc.html">files2dc</a>ダイアログボックスに<b>ダイアログを開く</b>チェックボックスがありません。その代わりに、インポートフィルタダイアログが開き、インポートフィルタファイルを参照して選択できます。
</p>
<dl><dd><a  class="image"><img alt="DC connect multiple files importFilter.png" src="../images/Connecting_to_File/DC_connect_multiple_files_importFilter.png" width="806"  /></a></dd></dl>
<p><br />
<i><b>シートを新たに作って読み込み</b></i>：
</p><p><b>インポートウィザード</b>と同様に、インポートフィルタコネクタは、数値フィールドで非数値データが見つかった場合の<a href="../../UserGuide/UserGuide/Import_Wizard_Data_Selection_Page_(ASCII_Binary).html#Non-Numeric_Data_in_a_Numeric_Field_Controls_.28ASCII_Only.29" title="ユーザガイド:インポートウィザードデータ選択ページ (ASCII/バイナリ)">新しいシートの開始</a>をサポートします。
</p>
<table class="note">
<tr>
<td><b>Note:</b>
<p>Import Filter Connectorのファイル拡張子設定をカスタマイズするには、アプリギャラリーでこのコネクタアイコンを右クリックし、<b>ファイル拡張子の編集</b>メニューを選択します。詳細は、<a href="../../UserGuide/UserGuide/Connecting_to_File.html#Customize_File_Extensions" title="ユーザガイド: ファイルに接続">CSVコネクタのこのセクション</a>を参照してください。
</p>
</td></tr></table>
<h2><a name="Clone_Import"></a><span class="mw-headline">クローンインポート</span></h2>
<p>複数ファイルに接続する別の方法をご紹介します。ただし、これは単純な複数ファイルをインポートするメカニズムとはかなり異なります。「クローン作成」の真の価値は、同じタイプと構造を持つ後続のファイルで、プロトタイプとなるファイルに対して実行されたグラフ化および分析操作をすばやく繰り返すことにあります。一度プロトタイプを作成すると、クローン作成は簡単です。
</p>
<ol><li> <b>データ：ファイルに接続</b>を使用してプロトタイプとなるデータファイルをインポートし、必要なグラフ化および/または分析操作を実行します。</li>
<li> データを含むワークブックまたは行列ブックをアクティブにして、<b>データ：クローンインポート</b>を選択します。または、<b>インポート</b>ツールバーの<b>クローンインポート</b>ボタン<a  class="image"><img alt="Button clone import.png" src="../images/Connecting_to_File/Button_clone_import.png" width="25"  /></a>をクリックします。</li>
<li> ファイルを選択して、<b><b>OK</b></b>をクリックします。</li></ol>
<p><br />
詳細については、チュートリアル「<a class="external text" href="../../Tutorial/Tutorial/Importing_Multiple_Files_into_Workbooks_Cloned_from_Active_Workbook.html">アクティブなワークブックからクローン複製されたワークブックに複数のファイルをインポート</a>」を参照してください。
</p>
<h2><a name="Connect_Files_by_Appending_Rows_to_Current_Sheet"></a><span class="mw-headline">現在のシートに行を追加してファイルを接続する</span></h2>
<p>複数のファイルに接続するこの方法は、バージョン2021以降のText/CSVでのみサポートされています。ファイルは1つずつ追加する必要があり、現在のワークシートに行を追加することでインポートされます。
</p>
<ol><li> <b>Text/CSV</b>コネクタを使用して、ファイルをワークシートにインポートします。ファイルで<b>データブロックマーカー</b>を使用している場合は、必ずデータブロックマーカーを指定してください。</li>
<li> ワークシートをアクティブにして、<a class="external text" href="../../GettingStarted/OriginLab/The_Origin_Interface.html#The_Command_Window_and_Script_Window">スクリプトウィンドウ</a>を開きます（<b>ウィンドウ：スクリプトウィンドウ</b>）。以下を入力してEnterを押します。
<dl><dd><pre class="lt" style="font-family:monospace;">wks.<span style="color: #000080;">dc</span>.<span style="color: #000080;">flags</span><span style="color: #000080;">=</span><span style="color: #0000dd;">256</span></pre></dd></dl></li>
<li> アクティブなワークシートに戻り、緑色のデータコネクタアイコン<a  class="image"><img alt="Dadta connector icon connect.png" src="../images/Connecting_to_File/Dadta_connector_icon_connect.png" width="16"  /></a>をクリックします。</li>
<li> <b>データソース</b>を選択し、追加するファイルへの<b>ファイルパス</b>を設定して、<b>OK</b>をクリックします。</li>
<li> <b>データブロックマーカー</b>を含む接続オプションを選択し、<b>OK</b>をクリックして、現在のワークシートに新しい行としてデータを追加してファイルをインポートします。</li></ol>


    