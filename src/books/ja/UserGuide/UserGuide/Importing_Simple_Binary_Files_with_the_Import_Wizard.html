<h1 class="firstheading">インポートウィザードで簡単なバイナリファイルをインポート</h1><p class='urlname' style='display: none'>ImpWiz-Simple-Binary-Files</p>
<p><br />
このトピックでは、280バイトのヘッダ情報で始まるサンプルファイルをインポートします。  このヘッダはテキスト情報で、インポートウィザードの<b>ヘッダバイト</b>ページのプレビューウィンドウで見ることができます。  
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Importing_Simple_Binary_Files_with_the_Import_Wizard/Tip_icon.png" width="57"  border="0" /></td><td><p>Origin 2019bから、システム変数<a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#D"><b>@DENG</b></a>にビット値が追加され、インポートウィザードウィザードでどんなプレビューを表示するか指定できます。デフォルトでは、Originはファイルをバイナリとして扱い、バイトオーダーマークをチェックするか、ファイルのエンコーディングを「推測」しようとします。これがうまくいかない場合、テキストファイルとして扱います。
</p></td></tr></table>
<p>ヘッダに続くデータは、次の構造の100のレコードです。
</p>
<ul><li> 長さ9文字の1つの文字列</li></ul>
<ul><li> 2つの整数（各4バイト）</li></ul>
<ul><li> 3つの実数（各8バイト）</li></ul>
<ul><li> 1つの整数（4バイト）</li></ul>
<ul><li> 1つの実数（8バイト）</li></ul>
<p>次のようにしてチュートリアルを開始します。
</p>
<dl><dd>1.ワークシートをアクティブにして、メニューから<b>データ: ファイルからインポート: インポートウィザード</b>を選択するか、標準ツールバーの<b>インポートウィザード</b>ボタン<a class="image"><img alt="Button Import Wizard.png" src="../images/Importing_Simple_Binary_Files_with_the_Import_Wizard/Button_Import_Wizard.png" width="25"  /></a>をクリックします。  インポートウィザードの<b>データソースページ</b>が開きます。</dd></dl>
<dl><dd>2.<b>データタイプ</b>を<b>バイナリ</b>にします。</dd></dl>
<dl><dd>3.<b>ファイル</b>の項目の右にある参照ボタン<a class="image"><img alt="Importing Simple Binary Files with the Import Wizard-1.png" src="../images/Importing_Simple_Binary_Files_with_the_Import_Wizard/Importing_Simple_Binary_Files_with_the_Import_Wizard-1.png" width="23"  /></a>をクリックして、 OriginプログラムフォルダのSamples\Import and Exportフォルダにある、<b>Binary Simple GOOD.dat</b>ファイルを選択します。  </dd></dl>
<dl><dd>4.<b><b>進む</b></b>ボタンをクリックします。  </dd></dl>
<p><b>ヘッダバイト</b>ページが開きます。  サンプルファイルのヘッダ部分を指定します。  先述のように、ファイルは280バイトのヘッダ情報で始まります。
</p>
<dl><dd>5.<b>ヘッダバイト数</b>テキストボックスに<b>280</b> と入力し、ページの下にある<b>進む</b>ボタンをクリックします。  </dd></dl>
<p><b>データパターン</b>ページが開きます。  インポートウィザードにサンプルバイナリファイルの解析方法を指示するデータ構造情報を入力します。
</p>
<dl><dd>6.<b>タイプ</b>列の下の白い部分をクリックすると、ドロップダウンリストのボタンが現れます。  ドロップダウンボタンをクリックして<b>文字列</b>を選択します。</dd>
<dd><a class="image"><img alt="Importing Simple Binary Files with the Import Wizard-2.png" src="../images/Importing_Simple_Binary_Files_with_the_Import_Wizard/Importing_Simple_Binary_Files_with_the_Import_Wizard-2.png" width="394"  /></a></dd></dl>
<dl><dd>7.<b>サイズ</b>列に<b>9</b>を入力します。(文字列は9文字の長さ)</dd></dl>
<dl><dd>8.<b>カウント</b>列には<b>1</b>を入力します。(文字列は1つ)</dd></dl>
<dl><dd>9.<b>タイプ</b>列に戻り、ドロップダウンリストから<b>整数</b>を選択します。サイズは自動で<b>4</b>（正しい値）にセットされます。</dd></dl>
<dl><dd>10.<b>カウント</b>列に<b>2</b>を入力します。</dd></dl>
<p>上述の情報を使って同じ操作を繰り返します。  入力したら、データパターンは次のようになります。
</p>
<dl><dd><a class="image"><img alt="Importing Simple Binary Files with the Import Wizard-3.png" src="../images/Importing_Simple_Binary_Files_with_the_Import_Wizard/Importing_Simple_Binary_Files_with_the_Import_Wizard-3.png" width="435"  /></a></dd></dl>
<p>また、データパターンページの下にあるプレビューにデータが並んでいるのが表示されます。
</p>
<dl><dd><a class="image"><img alt="Importing Simple Binary Files with the Import Wizard-4.png" src="../images/Importing_Simple_Binary_Files_with_the_Import_Wizard/Importing_Simple_Binary_Files_with_the_Import_Wizard-4.png" width="681"  /></a></dd></dl>
<dl><dd>12.<b>進む</b>ボタンを3回クリックします。  すると、<b>フィルタの保存</b>ページが開きます。</dd></dl>
<dl><dd>13.<b>フィルタを保存する</b>チェックボックスにチェックを付けます。</dd></dl>
<dl><dd>14.<b>ユーザファイルのフォルダに保存</b>ラジオボタンを選択します。</dd></dl>
<dl><dd>15.<b>フィルタの説明</b>を入力します。(例：「バイナリファイルのサンプルインポートフィルタ」)</dd></dl>
<dl><dd>16. 『<b>フィルタファイル名</b>』テキストボックスに「<b>BIWtest</b>」と入力します。</dd></dl>
<dl><dd>17.<b>このフィルタに対応するファイル名...</b>テキストボックスに、<b>B*.dat </b>と入力します。(拡張子datは一般的なので、ファイル名とファイルタイプを指定することで、このフィルタが、似たような名前のdatファイルに対して適用されます。)</dd></dl>
<dl><dd>18.<b>完了</b> ボタンをクリックします。</dd></dl>
<p>バイナリデータがワークシートにインポートされます。  同時に、拡張子<b>.OIF</b>の<b>Originインポートフィルタ</b>ファイルが作成され、Originプログラムフォルダの\Samples\Import and Exportフォルダに保存されます。  このフィルタファイルを使用して、拡張子が<b>.DAT</b>であるこのバイナリファイル、あるいは類似の構造のバイナリファイルを再インポートできます。  
</p>
<dl><dd>19.これを確認するには、新しいワークシートを開き、上記のステップ1から3を繰り返します。   データファイルフォルダにフィルタファイルを保存しましたので、インポートウィザード(最初の<b>データソース</b>ページ)がフィルタファイルを自動的に検出します。</dd>
<dd><a class="image"><img alt="Importing Simple Binary Files with the Import Wizard-5.png" src="../images/Importing_Simple_Binary_Files_with_the_Import_Wizard/Importing_Simple_Binary_Files_with_the_Import_Wizard-5.png" width="651"  /></a></dd></dl>
<dl><dd>20.このとき、<b>進む</b>ボタン(手順4)をクリックするのではなく、<b>完了</b>ボタンをクリックします。  これで新しいワークシートに正しくインポートされます。</dd></dl>
<p>Originインポートフィルタの作成についての詳細は、インポートウィザードの<a href="../../UserGuide/UserGuide/Import_Wizard_Save_Filters_Page_(All_Data_Types).html" title="ユーザガイド:インポートウィザード、フィルタの保存ページ(すべてのデータタイプ)">フィルタの保存ページ</a>をご覧ください。
</p>
    