<h1 class="firstheading">Webに接続</h1><p class='urlname' style='display: none'>Connect-to-Web</p>
<p><b>Webに接続</b>はオンラインパスからのデータファイルやWebページ上の表とOriginとの間に接続を構築します。元データが変更された場合、再インポートするだけですべてがアップデートされます。 
</p>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Connecting_to_Web/Alert_icon.png" width="57"  border="0" /></td><td><p><a class="external text" href="../../License/Category/Single-User_Node-Locked_License(License).html">プロダクトキー型</a>や<a class="external text" href="../../License/Category/Concurrent_License(License).html">同時起動型</a>ライセンスのユーザについては、Originを適切にアクティブ化する前は<b>Webに接続</b>メニューを使用できません。詳細は<a class="external text" href="../../QuickHelp/QuickHelp/Why_my_Connect_to_Wed/Cloud_menu_grey_out.html">このFAQ</a>を参照してください。
</p>
	</td>
	</tr>
	</table>
<p><br />
<span class='headerInParagraph'>データコネクタを開く</span>
</p>
<ol><li> ワークシートまたは行列をアクティブにして、メニューから<b>データ: Webに接続</b>を選択します。データコネクタはCSV、JSON、HTML表、Originプロジェクトといった多くのデータタイプをサポートしています。新規追加メニューで新しいデータタイプのデータコネクタをインストールすることもできます。</li></ol>
<p><b>Webに接続</b>ダイアログが開きます。 
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Connecting_to_Web/Tip_icon.png" width="57"  border="0" /></td><td><p><b>Webに接続</b>機能によってインポートされたデータは、ファイルサイズ100kBあたりの<b><a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#C">@CFDT</a></b> 秒に等しい期間キャッシュされます（たとえば、10MBのファイルに接続したデータは900 * 100 = 90,000秒、つまり、約24時間キャッシュされます）。したがって、接続されたデータをプロジェクトに再インポートすると、期間を超えていない場合はキャッシュされたデータが使用されます。期間を超えると、キャッシュされたデータが削除されるため、インポート時にデータが更新されます。手動でキャッシュデータを削除する場合は、<a class="external text" href="../../LabTalk/LabTalk/Delete_(command).html#-web.3B_Clear_the_URL-to-File_cache_used_by_Web_Connectors_.28Data:_Connect_to_Web.29"><b>delete -web</b></a> を参照してください。
</p></td></tr></table>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Basic_operation"><span class="tocnumber">1</span> <span class="toctext">基本設定</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#HTML_Connector_Options"><span class="tocnumber">1.1</span> <span class="toctext">HTMLコネクタオプション</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-3"><a href="#Advanced_operation"><span class="tocnumber">2</span> <span class="toctext">詳細設定</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#URL_Parts"><span class="tocnumber">2.1</span> <span class="toctext">URL部分</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#POST_Data"><span class="tocnumber">2.2</span> <span class="toctext">POSTデータ</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Examples"><span class="tocnumber">3</span> <span class="toctext">サンプル</span></a></li>
</ul>
</div>
<h2><a name="Basic_operation"></a><span class="mw-headline">基本設定</span></h2>
<dl><dd><a  class="image"><img alt="Data connector from web basic.png" src="../images/Connecting_to_Web/Data_connector_from_web_basic.png" width="786"  /></a></dd></dl>
<ol>
<li> <b>基本</b>モードで、<b>URL</b>編集ボックスにURLリンクを入力または貼り付けます。以前にアクセスしたURLをロードするには、<b>最近使ったURL</b>をクリックします。 
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Connecting_to_Web/Tip_icon.png" width="57"  border="0" /></td><td><ul><li> <b>最近使ったURL</b> には接続履歴が表示されますが、<b>サンプルURL</b>では<b>CSV</b>、<b>HTML</b>、<b>JSON</b>、および<b>MATLAB</b>などの形式のサンプルが一覧表示されます。</li></ul>
<dl><dd><a  class="image"><img alt="Connect to web dialog samples 2023.png" src="../images/Connecting_to_Web/Connect_to_web_dialog_samples_2023.png" width="786"  /></a></dd></dl>
<ul><li> 必要に応じて、LabTalk変数を事前定義して、URLリンクで置換して使えます。例えば、LabTalk変数は次のようにパーセントエンコードが必要です。 <pre class="lt" style="font-family:monospace;">https<span style="color: #000000;">:</span><span style="color: #008000;">//.....%(var$)...</span></pre>.実際のURL文字列は、<b>URLプレビュー</b>で確認できます。 </li></ul>
<dl><dd> <a  class="image"><img alt="Data connector from web lt variable.png" src="../images/Connecting_to_Web/450px-Data_connector_from_web_lt_variable.png" width="478"   /></a></dd></dl>
</td></tr></table>
</li>
<li> <b>OK</b>をクリックしてWebブラウザに接続します。
<li> <b>選択</b>ダイアログでは、表を選択して、下向き矢印をクリックして下部パネルに追加します。<b>OK</b>をクリックして、インポートします。<a href="../../UserGuide/UserGuide/Data_Navigator.html#Connect_to_Multi-page_Files" title="ユーザガイド:データナビゲータ">データナビゲータ</a>を使用して、後で他のテーブルをインポートできます。
</ol>
<table class="note">
<tr>
<td><b>Note</b>:
<ul>
<li><b>Webに接続</b>は、HTTP、HTTPS、およびFTPをサポートしています（サイトでは、ユーザ名とパスワードの両方で匿名ログインを許可する必要があります）。</li>
<li>DropBoxからデータを共有したい場合、共有リンクを作成し、データコネクタのURLに使用するリンクテキストを取得できます。さらに、次の必要があります。
<ol><li> 共有リンクの最後の部分を<code>?dl=0</code>から<code>?dl=1</code>に変更しないと、リンクが機能しません。</li>
<li> データをインポートする前に、<a href="../../UserGuide/UserGuide/Set_System_Variables_Dialog_Box.html" title="ユーザガイド：システム変数の設定ダイアログボックス">システム変数</a> <code>@HTTPMR=1;</code>を設定します。</li></li></ol>
</ul>
</td></tr></table>
<h3><a name="HTML_Connector_Options"></a><span class="mw-headline">HTMLコネクタオプション</span></h3>
<p>インポート後、コネクタアイコン<a  class="image"><img alt="Dadta connector icon connect.png" src="../images/Connecting_to_Web/Dadta_connector_icon_connect.png" width="16"  /></a>をクリックし、<b>オプション</b>メニューを選択し、<b>HTMLコネクタオプション</b>ダイアログを開けます。
</p><p><a  class="image"><img alt="Connect to Web Options dialog.png" src="../images/Connecting_to_Web/Connect_to_Web_Options_dialog.png" width="562"  /></a>
</p>
<table class="simple">
<tr>
<th> Webサイトスクリプトを実行<br />直接URLアクセス
</th>
<td>
<p>これは、インポートHTMLテーブルにWebサイトスクリプト（CSSなど）があり、インポートしたデータをWebサイトのデータと同じにしたい場合にチェックすることをお勧めします。
</p><p><b>直接URLアクセス（ローカルファイルキャッシュを使用しない)</b>はURLリンクとダイレクトに接続します、そうでない場合にはローカルファイルキャッシュが使用されます。
</p>
</td></tr>
<tr>
<th width="22%">テーブル列の部分インポート
</th>
<td>
<p>テーブル列の部分インポートはCSVコネクタと同じ構文を使用します。 
</p><p>部分インポートで使われる構文については<a href="../../UserGuide/Category/Partial_Importing_and_Re_Importing.html#Partial_Import_Controls_used_by_Import_From_File" title="カテゴリー: 部分インポートと再インポート">テーブルにおける&rdquo;カスタム&rdquo;オプションの記述</a>をご覧ください。
</p>
</td></tr>
<tr>
<th> 部分テーブル名を使用
</th>
<td>
<p>次の構文を使ってシート名として部分テーブル名を使用します。
</p>
<ul><li>スペース( ) = &quot;and&quot;</li>
<li>コロン(:)は<b>開始</b>と<b>終了</b>を分離</li></ul>
<p><b>サンプル</b>として、 テーブル名が&rdquo;<i>The eight metropolitan statistical areas of the Commonwealth</i>&rdquo;　だったとします。
</p>
<dl><dd><code>1 3 5 7 9</code> はシート名を<i>Teegt</i>にします。</dd>
<dd><code>5:22</code> はシート名を<i>eight metropolitan</i>にします。</dd></dl>
</td></tr></table>
<h2><a name="Advanced_operation"></a><span class="mw-headline">詳細設定</span></h2>
<p>一部のweb<b>データコネクタ</b>では、より複雑なリクエストの場合があるため、<b>Webに接続</b>ダイアログで<b>詳細</b>設定をする必要があります。
</p>
<h3><a name="URL_Parts"></a><span class="mw-headline">URL部分</span></h3>
<p>別の例では、次のURLは、<i>パスの構成要素</i>または<i>部分</i>である一連の変数で構成されています。
</p>
<pre>https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/2244</pre>
<p>この場合、<i>パスの構成要素</i>は次のように分割できます。
</p>
<pre>
https://pubchem.ncbi.nlm.nih.gov/rest/pug
/compound
/cid
/2244
</pre>
<p>URLを分割するのは必要というわけではありませんが、上記の場合のように、明確にするためには必要な場合があります。<b>Webに接続</b>ダイアログで、下図のようにしてこれらの部分を指定します。
</p><p><a  class="image"><img alt="Data connector from web advance2.png" src="../images/Connecting_to_Web/450px-Data_connector_from_web_advance2.png" width="536"   /></a>
</p><p><b>URL部分の追加</b>ボタンをクリックすると、<b>URL部分</b>を指定するための新しいコントロールグループが追加されます。また、各部分には、順序を変更するための<b>上</b><b>下</b>の矢印と、削除するための<span style="font-size: 1.5em;"><b>×</b></span>ボタンがあります。
</p><p><b>Note:</b> URL部分のLabTalk置換表記をサポートしています。
</p><p>オプションの<b>コマンドタイムアウト（分単位）</b>により、ユーザーはデータリクエストを中断する時間を分単位で指定できます。空白のままにした場合<i>（通常は推奨）</i>、リクエストが完了する、または、サーバーがリクエストを中止するするまで続けられます。
</p><p><b>HTTPリクエストヘッダパラメータ</b>のオプションは、<b>詳細設定</b>を使用する主な理由になります。URLに加えて、いくつかのWebサービスのAPIは1つ以上の任意の<a class="external text" href="https://en.wikipedia.org/wiki/List_of_HTTP_header_fields#Standard_request_fields" target="_blank">HTTPリクエストヘッダ</a>がリクエストと一緒であることを要求することがあります。<i>これはWebサービスの要件に大きく依存しています。この点に関して明確な規則はありません。</i>
</p><p>一般的な要求ヘッダー名の<b>ドロップダウンリスト</b>から選択して<b>追加</b>ボタンをクリックすると、2つのテキストボックスコントロール（ヘッダー名用とヘッダー値用）が追加されます。カスタムヘッダーはドロップダウンから<b>---カスタム---</b>を選択するか、単に既に追加されているヘッダーの名前を上書きすることによって追加することもできます。
</p><p>この例で示したURLでは、<b>Accept</b>ヘッダーが必須で、その値は返されるデータのタイプの<a class="external text" href="https://en.wikipedia.org/wiki/Media_type" target="_blank">メディアタイプ</a>に設定する必要があります。この場合、<b>application/json</b>です。
</p>
<table class="note">
<tr>
<td><b>Note:</b> リクエストヘッダ名 <b>Authorization</b> はリストに含まれます。 <i><b> このヘッダが自動的にパスワードになるわけではありません。</b></i>すべてのWebサービスがこのヘッダを必要とするわけではなく、Webサービス自体次第で値がどうあるべきかを定義します。<i>適切な値を構成する明確な規則はありません。</i>
</td></tr></table>
<h3><a name="POST_Data"></a><span class="mw-headline">POSTデータ</span></h3>
<p>一部のWebサービスは、リクエスト本文に様々なパラメータを含むPOSTリクエストを想定しています。これは、一部のパラメータが簡単に表示できるURLの一部にならないようにするため、またはGETリクエストに入れることができるよりも多くの情報を提供する必要がある場合に使用します。
</p><p>ボックスをクリックして、このオプションを有効にします。追加したテキストが「リクエスト本文」になります。チェックがないため、POSTリクエスト用にテキストが適切にフォーマットされていることをユーザが確認する必要があります。
</p>
<dl><dd><a  class="image"><img alt="Web Connect Post Data.png" src="../images/Connecting_to_Web/Web_Connect_Post_Data.png" width="842"  /></a></dd></dl>
<p><br />
<i><b>POSTリクエストの例：</b></i>
</p><p><b>URL</b>: <i><a class="external free" href="https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/property/MolecularFormula,MolecularWeight/CSV" target="_blank">https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/property/MolecularFormula,MolecularWeight/CSV</a></i><br />
<b>リクエスト本文</b>:  <i>cid=1,2,3,4,5</i> <br />
<b>HTTPリクエストヘッダパラメータ</b>: <i>Content-Type - application/x-www-form-urlencoded</i> <br />
<b>ヘッダ</b>: <i>Accept</i> <br />
</p><p>予想されるレスポンスは次のようになります。:<br />
レスポンス本文: &quot;CID&quot;,&quot;MolecularFormula&quot;,&quot;MolecularWeight&quot;<br />
1,&quot;C9H17NO4&quot;,203.238000<br />
2,&quot;C9H18NO4+&quot;,204.246000<br />
3,&quot;C7H8O4&quot;,156.137000<br />
4,&quot;C3H9NO&quot;,75.111000<br />
5,&quot;C3H8NO5P&quot;,169.073000<br />
</p>
<h2><a name="Examples"></a><span class="mw-headline">サンプル</span></h2>
<p><span class='headerInParagraph'>サンプル 1 </span>
</p><p><a class="external text" href="http://blog.originlab.com/data-import/data-connector-json?tdsourcetag=s_pcqq_aiomsg" target="_blank">OriginWebデータコネクタのチュートリアル</a>
</p><p><span class='headerInParagraph'>サンプル 2 </span>
</p><p><i>Signal Processing - FFT Gadget with Data Connector.opju</i>を開き、太陽の黒点データのWebファイルに接続するサンプルを確認できます。
</p>
<ol><li><b>ヘルプ: ラーニングセンター</b>を選択します。</li>
<li>ダイアログで、解析サンプルタブを開きます。<b>サンプル</b>ドロップダウンリストから<b>信号処理</b>を選択します。 </li>
<li><b>FFTガジェットとデータコネクタ</b>をダブルクリックして開きます。</li></ol>


    