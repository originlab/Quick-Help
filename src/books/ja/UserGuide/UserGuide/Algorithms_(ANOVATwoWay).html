<h1 class="firstheading">アルゴリズム (二元配置分散分析)</h1>
<table id="toc" class="toc" summary="Contents">
<tr>
<td>
<div id="toctitle">
<h2>内容</h2>
</div>
<ol>
<li class="toclevel-1"><a href="#Theory_of_Two-Way_ANOVA"><span class="tocnumber">1</span> <span class="toctext">Two-Way ANOVAの理論</span></a></li>
<li class="toclevel-1"><a href="#Multiple_Means_Comparisons"><span class="tocnumber">2</span> <span class="toctext">複数の平均比較</span></a></li>
<li class="toclevel-1"><a href="#Power_Analysis"><span class="tocnumber">3</span> <span class="toctext">検出力解析</span></a></li>
</ol>
</td>
</tr>
</table>
<a name="Theory_of_Two-Way_ANOVA" id="Theory_of_Two-Way_ANOVA"></a>
<h2><span class="mw-headline">二元配置分散分析(Two-Way ANOVA)の理論</span></h2>
<p><span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithms_(ANOVATwoWay)/math-24e1348a922751ccbd4fc0a55d9f6ca8.png" title="y_{ij,k}\,\!" alt="y_{ij,k}\,\!" class="tex" border="0" /></span>を因子Aのレベル<i>I</i> と因子Bのレベル <i>j</i> でのk番目の観測値を表すものとすると、二元配置分散分析モデルは下記のように書くことができます。</p>
<p style="line-height: 19.2px; orphans: auto;"><span style="widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithms_(ANOVATwoWay)/math-0effb5dfe043214d3b87ff3ca0b1e4d4.png" title="y_{ij,k}=\mu +\alpha _i+\beta _j+\gamma _{ij}+\varepsilon _{ij,k}" alt="y_{ij,k}=\mu +\alpha _i+\beta _j+\gamma _{ij}+\varepsilon _{ij,k}" class="tex" border="0" /></span></p>
<p>ここで、<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithms_(ANOVATwoWay)/math-74b8eddf4b37de80c7c8eed1b64e46fc.png" title="\mu \,\!" alt="\mu \,\!" class="tex" border="0" /></span>は反応データ全体の平均、<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithms_(ANOVATwoWay)/math-d015b015788a3872acceec61ded52bfb.png" title="\alpha _i\,\!" alt="\alpha _i\,\!" class="tex" border="0" /></span>は因子Aのレベル <i>I</i> での偏差、<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithms_(ANOVATwoWay)/math-193f021d9028eb9706698a6f5c0f1e0a.png" title="\beta _j\,\!" alt="\beta _j\,\!" class="tex" border="0" /></span> は因子Bのレベル <i>j</i> での偏差、<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithms_(ANOVATwoWay)/math-4893dd2481ae10c24164553d3930b4b6.png" title="\gamma _{ij}\,\!" alt="\gamma _{ij}\,\!" class="tex" border="0" /></span>は2つの因子間の交互作用で、<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithms_(ANOVATwoWay)/math-2d8e26c124bbaaff2975eca997214c41.png" title="\varepsilon _{ij,k}\,\!" alt="\varepsilon _{ij,k}\,\!" class="tex" border="0" /></span> は誤差項です。そして、標本の変化は、3つの部分に分けられ、3つの仮説検定を行うことができます。</p>
<p>ですから、因子Aに関しては、帰無仮説はrの異なる母集団の平均が同じとし、対立仮説は、少なくとも1つの標本の平均が、他とは異なるということになります。</p>
<p style="line-height: 19.2px; orphans: auto;"><span style="widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithms_(ANOVATwoWay)/math-c33acaa27b66cec3e5a477ef1a4ec7ec.png" title="H_{01}:\alpha _1=\alpha _2=\ldots =\alpha _r=0" alt="H_{01}:\alpha _1=\alpha _2=\ldots =\alpha _r=0" class="tex" border="0" /></span></p>
<p><span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithms_(ANOVATwoWay)/math-1bcb49c656d9c9add5863d0330032e26.png" title="H_{A1}:\alpha _p\neq \alpha _q" alt="H_{A1}:\alpha _p\neq \alpha _q" class="tex" border="0" /></span>のとき、いくつかの <i>p</i> と<i>q</i> において, pは1と等しくなく、qはrと等しくありません。</p>
<p>ですから、因子Bに関しては、帰無仮説はsの異なる母集団の平均が同じとし、対立仮説は、少なくとも1つの標本の平均が、他とは異なるということになります。</p>
<p style="line-height: 19.2px; orphans: auto;"><span style="widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithms_(ANOVATwoWay)/math-b0c76e650b839f11332fb55bc4916f4a.png" title="H_{02}:\beta _1=\beta _2=\ldots =\beta _s=0" alt="H_{02}:\beta _1=\beta _2=\ldots =\beta _s=0" class="tex" border="0" /></span></p>
<p><span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithms_(ANOVATwoWay)/math-7a89b6844c46c8800f73742ac898bdbc.png" title="H_{A2}:\beta _p\neq \beta _q" alt="H_{A2}:\beta _p\neq \beta _q" class="tex" border="0" /></span>のとき、いくつかの <i>p</i> と<i>q</i> において, pは1と等しくなく、qはsと等しくありません。</p>
<p>交互作用の項に対して、帰無仮説は、2つのファクター間の交互作用が無いということです。</p>
<p style="line-height: 19.2px; orphans: auto;"><span style="widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithms_(ANOVATwoWay)/math-e7658574652ff84922c7e45311aa9711.png" title="H_{03}:\gamma _1=\gamma _2=\ldots =\gamma _{rs}=0" alt="H_{03}:\gamma _1=\gamma _2=\ldots =\gamma _{rs}=0" class="tex" border="0" /></span></p>
<p><span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithms_(ANOVATwoWay)/math-caba9da65b46245805574ee743414b93.png" title="H_{A3}:\gamma _p\neq \gamma _q" alt="H_{A3}:\gamma _p\neq \gamma _q" class="tex" border="0" /></span>のとき、いくつかの <i>p</i> と<i>q</i> において, pは1と等しくなく、qはrsと等しくありません。</p>
<p>これらの仮説を検定するため、標本全体を4つの部分に分け、標本の変化で推定します。</p>
<p style="line-height: 19.2px; orphans: auto;"><span style="widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithms_(ANOVATwoWay)/math-2c795d2f616da7e117502bbcf9cb9a87.png" title="SS_{Total}=SS_{Error}+SS_A+SS_B+SS_{AB}\,\!" alt="SS_{Total}=SS_{Error}+SS_A+SS_B+SS_{AB}\,\!" class="tex" border="0" /></span></p>
<p>ここで</p>
<p style="margin: 3pt 0.125in 8pt; font-family: Arial, sans-serif; font-size: 9pt; line-height: 19.2px; color: #000000; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="font-family: Arial, sans-serif; font-size: 9pt; line-height: 19.2px; color: #000000; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithms_(ANOVATwoWay)/math-47e7f804f075b9c157584ec06cce79cd.png" title="SS_{Total}=\sum_{i=1}^r\sum_{j=1}^s\sum_{k=1}^t(y_{ij,k}-\bar y)^2" alt="SS_{Total}=\sum_{i=1}^r\sum_{j=1}^s\sum_{k=1}^t(y_{ij,k}-\bar y)^2" class="tex" border="0" /></span></p>
<p style="margin: 3pt 0.125in 8pt; font-family: Arial, sans-serif; font-size: 9pt; line-height: 19.2px; color: #000000; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithms_(ANOVATwoWay)/math-df8189819caf3b152811459af23977f2.png" title="SS_{Error}=\sum_{i=1}^r\sum_{j=1}^s\sum_{k=1}^t(y_{ij,k}-\bar y_{ijm})^2" alt="SS_{Error}=\sum_{i=1}^r\sum_{j=1}^s\sum_{k=1}^t(y_{ij,k}-\bar y_{ijm})^2" class="tex" border="0" /></p>
<p style="margin: 3pt 0.125in 8pt; font-family: Arial, sans-serif; font-size: 9pt; line-height: 19.2px; color: #000000; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithms_(ANOVATwoWay)/math-af748babfd23e3bfd39704d86135daa5.png" title="SS_A=st\sum_{i=1}^r(\bar y_{imm}-\bar y)^2" alt="SS_A=st\sum_{i=1}^r(\bar y_{imm}-\bar y)^2" class="tex" border="0" /></p>
<p style="margin: 3pt 0.125in 8pt; font-family: Arial, sans-serif; font-size: 9pt; line-height: 19.2px; color: #000000; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithms_(ANOVATwoWay)/math-07adec886e53b88c568666a7f5ad66d9.png" title="SS_B=rt\sum_{j=1}^s(\bar y_{mjm}-\bar y)^2" alt="SS_B=rt\sum_{j=1}^s(\bar y_{mjm}-\bar y)^2" class="tex" border="0" /></p>
<p style="margin: 3pt 0.125in 8pt; font-family: Arial, sans-serif; font-size: 9pt; line-height: 19.2px; color: #000000; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithms_(ANOVATwoWay)/math-472bd2d14aa56baec128037732f9c276.png" title="S_{AB}=t\sum_{i=1}^r\sum_{j=1}^s(\bar y_{ijm}-\bar y_{imm}-\bar y_{mjm}+\bar y)^2" alt="S_{AB}=t\sum_{i=1}^r\sum_{j=1}^s(\bar y_{ijm}-\bar y_{imm}-\bar y_{mjm}+\bar y)^2" class="tex" border="0" /></p>
<p>すると、次の値を得ることができます。</p>
<p style="margin: 3pt 0.125in 8pt; font-family: Arial, sans-serif; font-size: 9pt; line-height: 19.2px; color: #000000; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="font-family: Arial, sans-serif; font-size: 9pt; line-height: 19.2px; color: #000000; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithms_(ANOVATwoWay)/math-74c3be6091d315b1d45889451f08c9f1.png" title="\bar y=\frac 1{rst}\sum_{i=1}^r\sum_{j=1}^s\sum_{k=1}^ty_{ij,k}" alt="\bar y=\frac 1{rst}\sum_{i=1}^r\sum_{j=1}^s\sum_{k=1}^ty_{ij,k}" class="tex" border="0" /></span></p>
<p style="margin: 3pt 0.125in 8pt; font-family: Arial, sans-serif; font-size: 9pt; line-height: 19.2px; color: #000000; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithms_(ANOVATwoWay)/math-8c782727576bb980e6cef0ccfd682cdf.png" title="\bar y_{ij}=\frac 1t\sum_{k=1}^ty_{ij,k}" alt="\bar y_{ij}=\frac 1t\sum_{k=1}^ty_{ij,k}" class="tex" border="0" /></p>
<p style="margin: 3pt 0.125in 8pt; font-family: Arial, sans-serif; font-size: 9pt; line-height: 19.2px; color: #000000; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithms_(ANOVATwoWay)/math-2ae3b31c7b66edb18f543169b3f2c9fa.png" title="\bar y_{imm}=\frac 1{st}\sum_{j=1}^s\sum_{k=1}^ty_{ij,k}" alt="\bar y_{imm}=\frac 1{st}\sum_{j=1}^s\sum_{k=1}^ty_{ij,k}" class="tex" border="0" /></p>
<p style="margin: 3pt 0.125in 8pt; font-family: Arial, sans-serif; font-size: 9pt; line-height: 19.2px; color: #000000; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithms_(ANOVATwoWay)/math-6b23df9fc156465fe8f63b0c088432ec.png" title="\bar y_{mjm}=\frac 1{rt}\sum_{i=1}^r\sum_{k=1}^ty_{ij,k}" alt="\bar y_{mjm}=\frac 1{rt}\sum_{i=1}^r\sum_{k=1}^ty_{ij,k}" class="tex" border="0" /></p>
<p><span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithms_(ANOVATwoWay)/math-100f5db42fc55631c7b4e798218f6a8f.png" title="SS_{Total}" alt="SS_{Total}" class="tex" border="0" /></span>は合計二乗和、 <span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithms_(ANOVATwoWay)/math-8d95f5934baa7c353f18fd77c675e92c.png" title="SS_A" alt="SS_A" class="tex" border="0" /></span>は因子Aからの平均差の変化、<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithms_(ANOVATwoWay)/math-8abe5e40ad8ae7fd4ed12d2d27a1a7dd.png" title="SS_B" alt="SS_B" class="tex" border="0" /></span> は因子Bからの平均の変化をそれぞれ表します。そして、 <span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithms_(ANOVATwoWay)/math-23d40e491f33023cbce6ed1898054a81.png" title="SS_{AB}" alt="SS_{AB}" class="tex" border="0" /></span>は交互作用の変化を、<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithms_(ANOVATwoWay)/math-349fb0475e9b16a6353bbc1aae235e6a.png" title="SS_{Error}" alt="SS_{Error}" class="tex" border="0" /></span>ははすべての個別の標本の変化を表します。そして、 F 検定はそれらの間の分散の有意差を検定するのに使います。</p>
<p style="margin: 3pt 0.125in 8pt; font-family: Arial, sans-serif; font-size: 9pt; line-height: 19.2px; color: #000000; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="font-family: Arial, sans-serif; font-size: 9pt; line-height: 19.2px; color: #000000; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithms_(ANOVATwoWay)/math-fd17c1de0001a4efd8b9a0c82993d061.png" title="F_A=\frac{MS_A}{MS_{Error}}=\frac{SS_A/(r-1)}{SS_{Error}/(rs(t-1))}\sim F_\alpha (r-1,rs(t-1))" alt="F_A=\frac{MS_A}{MS_{Error}}=\frac{SS_A/(r-1)}{SS_{Error}/(rs(t-1))}\sim F_\alpha (r-1,rs(t-1))" class="tex" border="0" /></span></p>
<p style="margin: 3pt 0.125in 8pt; font-family: Arial, sans-serif; font-size: 9pt; line-height: 19.2px; color: #000000; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithms_(ANOVATwoWay)/math-44845adb89d0b9dd10565f5ff22f742a.png" title="F_B=\frac{MS_B}{MS_{Error}}=\frac{SS_B/(s-1)}{SS_{Error}/(rs(t-1))}\sim F_\alpha (s-1,rs(t-1))" alt="F_B=\frac{MS_B}{MS_{Error}}=\frac{SS_B/(s-1)}{SS_{Error}/(rs(t-1))}\sim F_\alpha (s-1,rs(t-1))" class="tex" border="0" /></p>
<p style="margin: 3pt 0.125in 8pt; font-family: Arial, sans-serif; font-size: 9pt; line-height: 19.2px; color: #000000; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithms_(ANOVATwoWay)/math-57af428ccc9c055f5a80fdc87089b1c2.png" title="F_{AB}=\frac{MS_{AB}}{MS_{Error}}=\frac{SS_{AB}/((r-1)(s-1))}{SS_{Error}/(rs(t-1))}\sim F_\alpha ((r-1)(s-1),rs(t-1))" alt="F_{AB}=\frac{MS_{AB}}{MS_{Error}}=\frac{SS_{AB}/((r-1)(s-1))}{SS_{Error}/(rs(t-1))}\sim F_\alpha ((r-1)(s-1),rs(t-1))" class="tex" border="0" /></p>
<p>ある有意水準<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithms_(ANOVATwoWay)/math-7b7f9dbfea05c83784f8b85149852f08.png" title="\alpha" alt="\alpha" class="tex" border="0" /></span>が与えられると、 <i>F</i> 統計量が重要な値<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithms_(ANOVATwoWay)/math-61ee10cfeb9c8fea41d940edebb82588.png" title="F_\alpha" alt="F_\alpha" class="tex" border="0" /></span>を超える場合、またはF統計量のP値が有意水準<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithms_(ANOVATwoWay)/math-7b7f9dbfea05c83784f8b85149852f08.png" title="\alpha" alt="\alpha" class="tex" border="0" /></span>以下の場合、帰無仮説<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithms_(ANOVATwoWay)/math-e65765bedcabe42c66ec93228769e82a.png" title="H_0" alt="H_0" class="tex" border="0" /></span> は棄却されます。</p>
<p>二元配置分散分析の計算は以下のようにまとめることができます。</p>
<table class="simple">
<tr>
<th>分散の入力</th>
<th>自由度 (DF)</th>
<th>平方和 (SS)</th>
<th>平均平方 (MS)</th>
<th><i style="font-style: italic;">F</i> 値</th>
<th><i style="font-style: italic;">Prob &gt; F</i></th>
</tr>
<tr>
<th>因子A</th>
<td><i style="font-style: italic;">r</i> - 1</td>
<td><span style="font-style: italic;"><img src="../images/Algorithms_(ANOVATwoWay)/math-8d95f5934baa7c353f18fd77c675e92c.png" title="SS_A" alt="SS_A" class="tex" border="0" /></span></td>
<td><span style="font-style: italic;"><img src="../images/Algorithms_(ANOVATwoWay)/math-d8cf712091994539169b7f92bcabdd67.png" title="MS_A" alt="MS_A" class="tex" border="0" /></span></td>
<td><span style="font-style: italic;"><img src="../images/Algorithms_(ANOVATwoWay)/math-d8cf712091994539169b7f92bcabdd67.png" title="MS_A" alt="MS_A" class="tex" border="0" /></span> / <img src="../images/Algorithms_(ANOVATwoWay)/math-ff8dc369a4b279c7e064cb1ef6fc4ba1.png" title="MS_{Error}" alt="MS_{Error}" class="tex" border="0" /></td>
<td><img src="../images/Algorithms_(ANOVATwoWay)/math-336e88336f1a211d0c3f3e2f533edff3.png" title="P\{F\geq F_{(r-1,rs(t-1),\alpha )}\}" alt="P\{F\geq F_{(r-1,rs(t-1),\alpha )}\}" class="tex" border="0" /></td>
</tr>
<tr>
<th>Factor B</th>
<td>s - 1</td>
<td><span style="font-style: italic;"><img src="../images/Algorithms_(ANOVATwoWay)/math-8abe5e40ad8ae7fd4ed12d2d27a1a7dd.png" title="SS_B" alt="SS_B" class="tex" border="0" /></span></td>
<td><span style="font-style: italic;"><img src="../images/Algorithms_(ANOVATwoWay)/math-666cadb9e58dc0e560e052a20e3a510f.png" title="MS_B" alt="MS_B" class="tex" border="0" /></span></td>
<td><span style="font-style: italic;"><img src="../images/Algorithms_(ANOVATwoWay)/math-666cadb9e58dc0e560e052a20e3a510f.png" title="MS_B" alt="MS_B" class="tex" border="0" /></span> / <img src="../images/Algorithms_(ANOVATwoWay)/math-ff8dc369a4b279c7e064cb1ef6fc4ba1.png" title="MS_{Error}" alt="MS_{Error}" class="tex" border="0" /></td>
<td><img src="../images/Algorithms_(ANOVATwoWay)/math-b9560f30879a8b17bbee7eebd41b9efa.png" title="P\{F\geq F_{(s-1,rs(t-1),\alpha )}\}" alt="P\{F\geq F_{(s-1,rs(t-1),\alpha )}\}" class="tex" border="0" /></td>
</tr>
<tr>
<th>交互作用</th>
<td>(<i>r</i>- 1) (<i>s</i> - 1)</td>
<td><span style="font-style: italic;"><img src="../images/Algorithms_(ANOVATwoWay)/math-23d40e491f33023cbce6ed1898054a81.png" title="SS_{AB}" alt="SS_{AB}" class="tex" border="0" /></span></td>
<td><span style="font-style: italic;"><img src="../images/Algorithms_(ANOVATwoWay)/math-bcd1cd8741b39cdd8c3e290f145ae5a1.png" title="MS_{AB}" alt="MS_{AB}" class="tex" border="0" /></span></td>
<td><span style="font-style: italic;"><img src="../images/Algorithms_(ANOVATwoWay)/math-bcd1cd8741b39cdd8c3e290f145ae5a1.png" title="MS_{AB}" alt="MS_{AB}" class="tex" border="0" /></span>/ <img src="../images/Algorithms_(ANOVATwoWay)/math-ff8dc369a4b279c7e064cb1ef6fc4ba1.png" title="MS_{Error}" alt="MS_{Error}" class="tex" border="0" /></td>
<td><img src="../images/Algorithms_(ANOVATwoWay)/math-50ceeeecbb0c9e5fec9e00f101ebad0c.png" title="P\{F\geq F_{((r-1)(s-1),rs(t-1),\alpha )}\}" alt="P\{F\geq F_{((r-1)(s-1),rs(t-1),\alpha )}\}" class="tex" border="0" /></td>
</tr>
<tr>
<th>Error</th>
<td>rs (t - 1)</td>
<td><span style="font-style: italic;"><img src="../images/Algorithms_(ANOVATwoWay)/math-349fb0475e9b16a6353bbc1aae235e6a.png" title="SS_{Error}" alt="SS_{Error}" class="tex" border="0" /></span></td>
<td><span style="font-style: italic;"><img src="../images/Algorithms_(ANOVATwoWay)/math-ff8dc369a4b279c7e064cb1ef6fc4ba1.png" title="MS_{Error}" alt="MS_{Error}" class="tex" border="0" /></span></td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr>
<th>合計</th>
<td>rst - 1</td>
<td><span style="font-style: italic;"><img src="../images/Algorithms_(ANOVATwoWay)/math-100f5db42fc55631c7b4e798218f6a8f.png" title="SS_{Total}" alt="SS_{Total}" class="tex" border="0" /></span></td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
</table>
<p>Originの二元配置分散分析は、いくつかのNAG関数を使っています。NAG関数 <b><a href="http://www.originlab.com/pdfs/nagcl09/manual/pdf/g04/g04eac.pdf" class="external text" title="http://www.originlab.com/pdfs/nagcl09/manual/pdf/g04/g04eac.pdf" rel="nofollow" target="_blank">nag_dummy_vars (g04eac)</a></b>は、必要な形の行列を作成し、NAG関数<b><a href="http://www.originlab.com/pdfs/nagcl09/manual/pdf/g02/g02dac.pdf" class="external text" title="http://www.originlab.com/pdfs/nagcl09/manual/pdf/g02/g02dac.pdf" rel="nofollow" target="_blank">nag_regsn_mult_linear (g02dac)</a></b> は、必要な形の線形回帰を実行します。線形回帰の結果は、二元配置ANOVA表を作成するのに使われます。詳細はNAG文書をご覧ください。</p>
<a name="Multiple_Means_Comparisons" id="Multiple_Means_Comparisons"></a>
<h2><span class="mw-headline">複数の平均比較</span></h2>
<p>少なくとも1つのファクターレベルの平均が統計的に他のファクターレベルの平均と異なることを調べる二元配置ANOVAを実行すると、それに続けて、平均が異なるかどうかすべてのファクターでの可能な組合せで、平均の比較が行われます。Originでは、平均比較にさまざまな方法があり、これはNAG関数の<b><a href="http://www.originlab.com/pdfs/nagcl09/manual/pdf/g04/g04dbc.pdf" class="external text" title="http://www.originlab.com/pdfs/nagcl09/manual/pdf/g04/g04dbc.pdf" rel="nofollow" target="_blank">nag_anova_confid_interval (g04dbc)</a></b>を使って行っています。</p>
<p>複数の平均の比較法の2種類がOriginに含まれています。</p>
<p>シングルステップ法これは、Tukey-Kramer, Bonferroni, Dunn-Sidak, Fisher’s LSD, Scheffé, Dunnettを含む、平均がどの程度違うのかを示すために信頼区間を作成します。</p>
<p>ステップワイズ法Holm-Bonferroni 、Holm-Sidak 検定を含む仮説検定を実行します。</p>
<a name="Power_Analysis" id="Power_Analysis"></a>
<h2><span class="mw-headline">検出力解析</span></h2>
<p>検出力分析は、サンプルデータに対する仮説の検出力だけでなく、実際の検出力を計算します。</p>
<p>二元配置ANOVAの検出力は、その敏感度の計測です。検出力は、ANOVAが実際の差があるときの標本の平均の差を検出するものです。帰無仮説および対立仮説に関して、検出力は検定する統計量 F が、実際に帰無仮説を棄却すべき(例：与えられた帰無仮説が真でない)ときに、帰無仮説を棄却するのに十分であるという確率です。</p>
<p>Originの二元配置ANOVAダイアログは、因子A および因子B に対する検出力を計算します。「交互作用」チェックボックスが選択されている場合、Originは<i>A</i>*Bの交互作用に対して、検出力を計算することが出来ます。</p>
<p>検出力は次式で定義されます。</p>
<p><img src="../images/Algorithms_(ANOVATwoWay)/math-e3a9b7f790e5b9b01d2fe974337ea4cf.png" title="power=1-probf(f,df,dfe,nc)\,\!" alt="power=1-probf(f,df,dfe,nc)\,\!" class="tex" style="color: #000000; font-family: Arial, sans-serif; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 19.2px; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;" border="0" /></p>
<p>ここで <i>f</i> は、非中心の <i>F</i>-分布の偏りで、この<i>F</i>分布は自由度<i>df</i> および <i>dfe</i> と <i>nc = SS/MSE</i>を持ちます。SS は<i>A</i>, <i>B</i>, <i>A</i>*Bの二乗和で、 MSEは誤差の平均平方、 df は元の<i>A</i>, <i>B</i>, <i>A</i>*<i>B</i>に関しての分子の自由度、 dfe は誤差の自由度です。全ての値<i>(</i>SS, <i>M</i>SE, df, <i>dfe</i>) は、ANOVA表で取得できます。<i>probf</i>( ) の値が、NAG関数<b><a href="http://www.originlab.com/pdfs/nagcl09/manual/pdf/g01/g01gdc.pdf" class="external text" title="http://www.originlab.com/pdfs/nagcl09/manual/pdf/g01/g01gdc.pdf" rel="nofollow" target="_blank">nag_prob_non_central_f_dist (g01gdc)</a></b>を使って取得されます。詳細はNAG文書をご覧ください。</p>
<p>上記は、簡単な一元配置ANOVAのアルゴリズムの概要であり、詳細な数学的な演算については、このマニュアルの対応する部分やNAG文書を参照してください。</p>
<p><br /></p>
