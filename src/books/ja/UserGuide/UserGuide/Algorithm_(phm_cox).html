<h1 class="firstheading">アルゴリズム (phm cox)</h1>
<p><br />
<i>i = 1, 2, ..., n</i>で、<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-b4a096d9d2236359a73b7386af0c9ab6.png" title="t_i\,\!" alt="t_i\,\!" class="tex" border="0" /></span>を<i>i</i>番目の観測値は、<i>p</i> 共変量<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-e9b2a0e549182ce07a674b99d3bdd987.png" title="Z_j(j=1,2,\ldots ,p)" alt="Z_j(j=1,2,\ldots ,p)" class="tex" border="0" /></span> のベクターデータを持ち、これに対する故障時間または打ち切り時間にします。故障と打ち切りの過程は独立しているものとします。ハザード関数<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-b4edeac500164ed31e65913d1bf90051.png" title="\lambda (z,t)\,\!" alt="\lambda (z,t)\,\!" class="tex" border="0" /></span>は、共変量 z を持つ個々のデータが時間<i>t</i>で故障する確率で、時間<i>t</i>は、個々が生存する時間として与えられます。Con比例ハザードモデルは、次のような形式になっています。</p>
<p style="line-height: 19.2px; orphans: auto;"><span style="widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-7fd25fca62158bf07a508af6b3048824.png" title="\lambda (z,t)=\lambda _0(t)\exp (z^{T}\beta +\omega )\,\!" alt="\lambda (z,t)=\lambda _0(t)\exp (z^{T}\beta +\omega )\,\!" class="tex" border="0" /></span></p>
<p>ここで<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-3edc1ca1e622708969948a2514e800f2.png" title="\lambda _0\,\!" alt="\lambda _0\,\!" class="tex" border="0" /></span>は、ハザード関数のベースラインで時間関数ではなく、 <span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-5b320b6d3d3254d936c752ae308dbfd8.png" title="\beta \,\!" alt="\beta \,\!" class="tex" border="0" /></span>は、不明なパラメータのベクターデータで、<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-f2f1b18a419c6fddc9ad79a13a5946e3.png" title="\omega\,\!" alt="\omega\,\!" class="tex" border="0" /></span>は分かっているオフセット値です。</p>
<p>時間<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-659eb06b406d2e114b139d0dd37ba959.png" title="t_{(i)}\,\!" alt="t_{(i)}\,\!" class="tex" border="0" /></span>における個別の故障<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-40b4081d7e04c18f0529a2e70a11e290.png" title="d_i\,\!" alt="d_i\,\!" class="tex" border="0" /></span>のように、<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-99af4576b28fa0e44da190e42ca9fdfb.png" title="n_d &lt; n\,\!" alt="n_d &lt; n\,\!" class="tex" border="0" /></span>で与えられる故障時間は、 明確な故障時間 <span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-afdb5212c7209b37b90b950f8e435844.png" title="t_{(1)} &lt; t_{(2)} &lt;&#160;?&lt; t_{(nd)}" alt="t_{(1)} &lt; t_{(2)} &lt;&#160;?&lt; t_{(nd)}" class="tex" border="0" /></span>と結びついており、<span class="texhtml">&#160;</span><span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-b0603860fcffe94e5b8eec59ed813421.png" title="\beta" alt="\beta" class="tex" border="0" /></span>に対する周辺尤度は、次式で近似されます。</p>
<table class="formula">
<tr>
<td>
<p><span style="line-height: 19.2px;"><img src="../images/Algorithm_(phm_cox)/math-746fdd59f1f86341fb6c80f477eef31d.png" title="L=\prod_{i=1}^{n_d}\frac{\exp (s_i^{T}\beta +\omega _i)}{[\sum_{l\in R(t_{(1)})}\exp (z_i^{T}\beta +\omega _i)]^{d_{i}}}" alt="L=\prod_{i=1}^{n_d}\frac{\exp (s_i^{T}\beta +\omega _i)}{[\sum_{l\in R(t_{(1)})}\exp (z_i^{T}\beta +\omega _i)]^{d_{i}}}" class="tex" border="0" /></span></p>
</td>
<td>
<p>(1)</p>
</td>
</tr>
</table>
<p>ここで、<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-df637c345145e684f09c3e2bf73732cf.png" title="s_i\,\!" alt="s_i\,\!" class="tex" border="0" /></span>は、時間<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-659eb06b406d2e114b139d0dd37ba959.png" title="t_{(i)}\,\!" alt="t_{(i)}\,\!" class="tex" border="0" /></span> における観測した個々の故障の共変量の合計であり、 は、<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-ee91b0d4f1eaf7196ca8b86c689bce4c.png" title="R(t_{(i)})\,\!" alt="R(t_{(i)})\,\!" class="tex" border="0" /></span> より前のリスクにおける個々の故障です。これは、時間<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-659eb06b406d2e114b139d0dd37ba959.png" title="t_{(i)}\,\!" alt="t_{(i)}\,\!" class="tex" border="0" /></span>以上に生存した個々のデータに加えて、時間<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-f82bfe760d9b9727abfa6b9f205b4291.png" title="t_{(i)}" alt="t_{(i)}" class="tex" border="0" /></span> での故障または打ち切りのデータすべてとなります。 <span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-8d2bf18dffee8005942fdde98a69f3a1.png" title="\beta\,\!" alt="\beta\,\!" class="tex" border="0" /></span>のMLE(最大尤度見積り)は、<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-950a1c15a15d3e439fc0c39729c41abe.png" title="\hat \beta\,\!" alt="\hat \beta\,\!" class="tex" border="0" /></span>で与えられ、Newton-Raphson反復法を使って(1)を最大化することで取得されます。この反復法は、段階的に行われ、下記の(2)と(3)で与えられる(1)の一階および二階微分を利用します。</p>
<table class="formula">
<tr>
<td>
<p style="line-height: 19.2px;"><img src="../images/Algorithm_(phm_cox)/math-2f4266ed0d3815eaca058ea19e181c0e.png" title="U_j(\beta )=\frac{\partial Ln(L)}{\partial \beta _j}=\sum_{i=1}^{n_d}[s_{ji}-d_i\alpha _{ji}(\beta )]=0" alt="U_j(\beta )=\frac{\partial Ln(L)}{\partial \beta _j}=\sum_{i=1}^{n_d}[s_{ji}-d_i\alpha _{ji}(\beta )]=0" class="tex" border="0" /></p>
</td>
<td>
<p>(2)</p>
</td>
</tr>
</table>
<p><i style="font-style: italic;">j = 1, 2,..., p</i>, ここで<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-c187e0049b758f53e5e0d9889f652f49.png" title="s_{ji}\,\!" alt="s_{ji}\,\!" class="tex" border="0" /></span>は、ベクターデータ<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-df637c345145e684f09c3e2bf73732cf.png" title="s_i\,\!" alt="s_i\,\!" class="tex" border="0" /></span>の <i>j</i>番目の要素です。</p>
<p style="line-height: 19.2px; orphans: auto;"><span style="widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-a28a80d6e7722fccef4fc3249adc4ca2.png" title="\alpha _{ji}(\beta )=\frac{\sum_{l\in R(t_{(1)})}z_{jl}\exp (z_l^{T}\beta +\omega _l)}{\sum_{l\in R(t_{(1)})}\exp (z_l^{T}\beta +\omega _l)}" alt="\alpha _{ji}(\beta )=\frac{\sum_{l\in R(t_{(1)})}z_{jl}\exp (z_l^{T}\beta +\omega _l)}{\sum_{l\in R(t_{(1)})}\exp (z_l^{T}\beta +\omega _l)}" class="tex" border="0" /></span></p>
<p>同様に、</p>
<table class="formula">
<tr>
<td>
<p style="line-height: 19.2px;"><img src="../images/Algorithm_(phm_cox)/math-f7f5ed8c6b97518204b6c96b8797c7d9.png" title="I_{hj}(\beta )=-\frac{\partial ^2Ln(L)}{\partial \beta _h\partial \beta _j}=\sum_{i=1}^{n_d}d_i\gamma _{hji}" alt="I_{hj}(\beta )=-\frac{\partial ^2Ln(L)}{\partial \beta _h\partial \beta _j}=\sum_{i=1}^{n_d}d_i\gamma _{hji}" class="tex" border="0" /></p>
</td>
<td>
<p>(3)</p>
</td>
</tr>
</table>
<p>ここで <span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-b9afb94ffa7c4b399e7da601d15f214c.png" title="\gamma _{hji}=\frac{\sum_{l\in R(t_{(1)})}z_{hl}z_{jl}\exp (z_l^{T}\beta +\omega _l)}{\sum_{l\in R(t_{(1)})}\exp (z_l^{T}\beta +\omega _l)}-\alpha _{hi}(\beta )\alpha _{ji}(\beta )" alt="\gamma _{hji}=\frac{\sum_{l\in R(t_{(1)})}z_{hl}z_{jl}\exp (z_l^{T}\beta +\omega _l)}{\sum_{l\in R(t_{(1)})}\exp (z_l^{T}\beta +\omega _l)}-\alpha _{hi}(\beta )\alpha _{ji}(\beta )" class="tex" border="0" /></span> <i>h</i>, <i>j = 1, ..., p.p.</i></p>
<p><span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-94b61be7dbb72780127ba83b9a55c19f.png" title="U_j(\beta )\,\!" alt="U_j(\beta )\,\!" class="tex" border="0" /></span> は、スコアベクターの <i>j</i> 番目の成分で、<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-1a14fac8fed1c86899f6f323acabceea.png" title="I_{hi}(\beta )\,\!" alt="I_{hi}(\beta )\,\!" class="tex" border="0" /></span> は、観測情報行列 <span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-a139862e5a9fa67a8d14878476236d55.png" title="I(\beta )\,\!" alt="I(\beta )\,\!" class="tex" border="0" /></span>の(<i>h, j)</i>要素です。この行列の逆行列<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-3d35c360006c6b692bb24cfaa0162d4b.png" title="I(\beta )^{-1}=I_{hi}(\beta )^{-1}\,\!" alt="I(\beta )^{-1}=I_{hi}(\beta )^{-1}\,\!" class="tex" border="0" /></span>は、<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-8d2bf18dffee8005942fdde98a69f3a1.png" title="\beta\,\!" alt="\beta\,\!" class="tex" border="0" /></span> の分散－共分散行列を与えます。</p>
<p>共変量または共変量の線形の組合せは、時間と共に単調に増加または減少しており、1つ以上の<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-35ddbb0efc4d0c98d6f19a3b84c1db78.png" title="\beta _j^{\prime }s" alt="\beta _j^{\prime }s" class="tex" border="0" /></span>は無限大となります。</p>
<p>もし <span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-8883b73ab26908c75308092259b6d141.png" title="\lambda _0(t)\,\!" alt="\lambda _0(t)\,\!" class="tex" border="0" /></span>は<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-3b0619e986d2ebf9acd80c494cb421a4.png" title="\nu\,\!" alt="\nu\,\!" class="tex" border="0" /></span> の層でさまざまに変化すると、<i>k</i>番目の層にあるデータの数は<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-3da18b12eaeaccf089fe39883448b765.png" title="n_k\,\!" alt="n_k\,\!" class="tex" border="0" /></span>、 <i>k = 1</i>, ... , <span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><i><img src="../images/Algorithm_(phm_cox)/math-3b0619e986d2ebf9acd80c494cb421a4.png" title="\nu\,\!" alt="\nu\,\!" class="tex" border="0" /></i></span>)で、<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-ff8c77ee62f8208a4dbab23d6a511dcc.png" title="n=\sum_{k=1}^\nu n_k" alt="n=\sum_{k=1}^\nu n_k" class="tex" border="0" /></span>を持ち、<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-950a1c15a15d3e439fc0c39729c41abe.png" title="\hat \beta\,\!" alt="\hat \beta\,\!" class="tex" border="0" /></span>を取得するために(1)を最大化するのではなく、次の周辺尤度を最大化します。</p>
<table class="formula">
<tr>
<td>
<p style="line-height: 19.2px;"><img src="../images/Algorithm_(phm_cox)/math-3423d4e0ec03428876c386cf59a58dfe.png" title="L=\prod_{k=1}^\nu L_k" alt="L=\prod_{k=1}^\nu L_k" class="tex" border="0" /></p>
</td>
<td>
<p>(4)</p>
</td>
</tr>
</table>
<p>ここで<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-39209f726b762faf7442e04a446ad41f.png" title="L_k\,\!" alt="L_k\,\!" class="tex" border="0" /></span>は、(1)で簡単なサンプルとして扱われる<i>k</i>番目の層にある<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-3da18b12eaeaccf089fe39883448b765.png" title="n_k\,\!" alt="n_k\,\!" class="tex" border="0" /></span>観測値に対する尤度への寄与となります。 共変量係数が層にまたがって一定であると結論付けするとき、異なるベースラインハザード関数<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-8883b73ab26908c75308092259b6d141.png" title="\lambda _0(t)\,\!" alt="\lambda _0(t)\,\!" class="tex" border="0" /></span>があります。</p>
<p>故障時間<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-659eb06b406d2e114b139d0dd37ba959.png" title="t_{(i)}\,\!" alt="t_{(i)}\,\!" class="tex" border="0" /></span>と関連しているベースライン生存関数は次のように見積もられます。</p>
<p><span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-0b8df9b2daec8e7514a7c2cd894f8faf.png" title="exp(-\hat H(t_{(i)}))" alt="exp(-\hat H(t_{(i)}))" class="tex" border="0" /></span> ,</p>
<p>ここで <span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-ca2e935da3c4ec9f78523b3db2309234.png" title="\hat H(t_{(i)})=\sum_{t(j)\leq t(i)}(\frac{d_i}{\sum_{l\in R(t_{(j)})}\exp (z_l^T\hat \beta +\omega _l)})" alt="\hat H(t_{(i)})=\sum_{t(j)\leq t(i)}(\frac{d_i}{\sum_{l\in R(t_{(j)})}\exp (z_l^T\hat \beta +\omega _l)})" class="tex" border="0" /></span></p>
<p>そして、<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-40b4081d7e04c18f0529a2e70a11e290.png" title="d_i\,\!" alt="d_i\,\!" class="tex" border="0" /></span> は、時間<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-659eb06b406d2e114b139d0dd37ba959.png" title="t_{(i)}\,\!" alt="t_{(i)}\,\!" class="tex" border="0" /></span>における故障の数です。 <i>I</i>番目の観測値の残差は次式で計算されます。</p>
<p style="line-height: 19.2px; orphans: auto;"><span style="widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-a5cc248e45947fea428f4b34caff7093.png" title="r(t_l)=\hat H(t_l)\exp (-z_l^T\hat \beta +\omega _l)" alt="r(t_l)=\hat H(t_l)\exp (-z_l^T\hat \beta +\omega _l)" class="tex" border="0" /></span></p>
<p>ここで<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-b77e639a3484da642fbbd419c433f190.png" title="\hat H(t_l)=\hat H(t_{(i)}),t_{(i)}\leq t_l&lt;t_{(i+1)}" alt="\hat H(t_l)=\hat H(t_{(i)}),t_{(i)}\leq t_l&lt;t_{(i+1)}" class="tex" border="0" /></span></p>
<p>逸脱は、<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-22a372fe7aefbb5295da3f13a354ea31.png" title="-2^*\,\!" alt="-2^*\,\!" class="tex" border="0" /></span>(logarithm of marginal likelihood)と定義されます。個々の共変量が十分であるかをテストする2つの方法があります。: ネストしたモデルの共変量間の差は、適切な<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(phm_cox)/math-c15009ca5cbb034d023f145a4ed23b8d.png" title="\chi ^2\,\!" alt="\chi ^2\,\!" class="tex" border="0" /></span>の分布で比較されます。または、パラメータ推定の正規性がz検定を形作るために使われます。推定値を標準誤差で除算するか、帰無仮説下のモデルに対するスコア関数がz検定を形作るために使われます。</p>
<p style="margin: 3pt 0.125in 8pt; font-family: Arial, sans-serif; font-size: 9pt; line-height: 19.2px; color: #000000; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px;">&#160;</p>
