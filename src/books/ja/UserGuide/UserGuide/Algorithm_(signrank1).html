<h1 class="firstheading">アルゴリズム（1群のWilcoxon符号順位検定）</h1><p class='urlname' style='display: none'>SignRank1-Algorithm</p>
<p>1群のWilcoxon符号順位検定は、正規性に疑問があるような標本の場合に、1群のt検定の代わりに使います。1群のt検定よりも条件が緩いので、t検定よりも利用範囲が広くなります。
</p><p>a)  各 <img src="../images/Algorithm_(signrank1)/math-d2583020b138319a535bc3c88278ab33.png" title="x_i\,\!" alt="x_i\,\!" class="tex"/> に<img src="../images/Algorithm_(signrank1)/math-6b80d670336d4b43b32dbd006770a4f1.png" title="i=1,2,\ldots ,n" alt="i=1,2,\ldots ,n" class="tex"/> に対して、符号の差<img src="../images/Algorithm_(signrank1)/math-0816d4a592c11fc9915d60c0ab5c8ba8.png" title="d_i=x_i-\mu _0\,\!" alt="d_i=x_i-\mu _0\,\!" class="tex"/>を計算します。ここで <img src="../images/Algorithm_(signrank1)/math-4ed1ed38631c7263bc6b664a5c510f8e.png" title="\mu _0\,\!" alt="\mu _0\,\!" class="tex"/>は、標本の中央値に対して与える検定値です。
</p><p>b)  <img src="../images/Algorithm_(signrank1)/math-a3bf95053be7ee784232acceb28b8046.png" title="d_i=0\,\!" alt="d_i=0\,\!" class="tex"/>の場合は無視します。<img src="../images/Algorithm_(signrank1)/math-80c599954d244f780dfa6152785f1d15.png" title="\left| d_i\right| " alt="\left| d_i\right| " class="tex"/>の残りを順位付けし、その順位として<img src="../images/Algorithm_(signrank1)/math-af2593b49488f8bc44396795792c2d79.png" title="r_i" alt="r_i" class="tex"/>を使います。<img src="../images/Algorithm_(signrank1)/math-80c599954d244f780dfa6152785f1d15.png" title="\left| d_i\right| " alt="\left| d_i\right| " class="tex"/>のタイの値がタイのランクの平均に割り当てられるように注意します。例えば、   7 8 9 で3つの<img src="../images/Algorithm_(signrank1)/math-80c599954d244f780dfa6152785f1d15.png" title="\left| d_i\right| " alt="\left| d_i\right| " class="tex"/>が同順位であると、その順位は (7+8+9) /3=8 となります。
</p><p>C)  各符号に、対応する<img src="../images/Algorithm_(signrank1)/math-40b4081d7e04c18f0529a2e70a11e290.png" title="d_i\,\!" alt="d_i\,\!" class="tex"/>の符号が付加されます。<img src="../images/Algorithm_(signrank1)/math-1e45800d815894820f5acad906bbb8e7.png" title="s_i=sign(d_i)r_i\,\!" alt="s_i=sign(d_i)r_i\,\!" class="tex"/>　のようにします。 
</p><p>d)  正の符号順位の合計は次の式で計算できます。 
</p><p><img src="../images/Algorithm_(signrank1)/math-ead8d10bd1463b7b0bd40d8977d5ba37.png" title="W_1=\sum_{s_i&gt;0}s_i" alt="W_1=\sum_{s_i&gt;0}s_i" class="tex"/>
</p><p>このサンプルでの帰無仮説は、母集団の中央値は、指定した値<img src="../images/Algorithm_(signrank1)/math-4ed1ed38631c7263bc6b664a5c510f8e.png" title="\mu _0\,\!" alt="\mu _0\,\!" class="tex"/>があるということです。ここでは、母集団が中央値<img src="../images/Algorithm_(signrank1)/math-4ed1ed38631c7263bc6b664a5c510f8e.png" title="\mu _0\,\!" alt="\mu _0\,\!" class="tex"/>を持たないという両側の対立仮説に対する帰無仮説を検定します。信頼区間は、仮説検定の形式に変換されます。検定は、1群のWilcoxon符号順位検定で、次の式で定義されます。
</p>
<table class="dialogcontroltable">

<tr>
<th><img src="../images/Algorithm_(signrank1)/math-e65765bedcabe42c66ec93228769e82a.png" title="H_0" alt="H_0" class="tex"/>
</th>
<td><img src="../images/Algorithm_(signrank1)/math-0a9a0062a3140e27523057ac492950e3.png" title="\mu =\mu _0\,\!" alt="\mu =\mu _0\,\!" class="tex"/>
</td></tr>
<tr>
<th><img src="../images/Algorithm_(signrank1)/math-6207a80403dcccc1aa3b5b7303315c4b.png" title="H_1" alt="H_1" class="tex"/>
</th>
<td><img src="../images/Algorithm_(signrank1)/math-858de1a56ceb15609e7ab979a2638b00.png" title="\mu \neq \mu _0" alt="\mu \neq \mu _0" class="tex"/>
</td></tr>
<tr>
<th>検定統計量
</th>
<td><img src="../images/Algorithm_(signrank1)/math-b1b86035c067633cdfc2a356665fc977.png" title="z=\frac{(W-\frac{n_1(n_1+1)}4)-\frac 12\cdot sign(W-\frac{n_1(n_1+1)}4)}{\sqrt{\frac 14\cdot\sum_{i=1}^n S_i^2}}" alt="z=\frac{(W-\frac{n_1(n_1+1)}4)-\frac 12\cdot sign(W-\frac{n_1(n_1+1)}4)}{\sqrt{\frac 14\cdot\sum_{i=1}^n S_i^2}}" class="tex"/>
<p>ここで<img src="../images/Algorithm_(signrank1)/math-e5631ee132b76058c37eb3abeed99259.png" title="W\,\!" alt="W\,\!" class="tex"/>と<img src="../images/Algorithm_(signrank1)/math-df637c345145e684f09c3e2bf73732cf.png" title="s_i\,\!" alt="s_i\,\!" class="tex"/>は上述の通り<img src="../images/Algorithm_(signrank1)/math-8d88a43872d6db6535d8672a15f09ce2.png" title="n_1\,\!" alt="n_1\,\!" class="tex"/>で、これはゼロではない<img src="../images/Algorithm_(signrank1)/math-40b4081d7e04c18f0529a2e70a11e290.png" title="d_i\,\!" alt="d_i\,\!" class="tex"/>の数です。
</p>
</td></tr>
<tr>
<th>有意水準<img src="../images/Algorithm_(signrank1)/math-4bc6c42bbabe567d1f2516326e52b775.png" title="\alpha \,\!" alt="\alpha \,\!" class="tex"/>
</th>
<td>最も一般的に使われる<img src="../images/Algorithm_(signrank1)/math-4bc6c42bbabe567d1f2516326e52b775.png" title="\alpha \,\!" alt="\alpha \,\!" class="tex"/> の値は0.05です。
</td></tr>
<tr>
<th>棄却域
</th>
<td>中央値が指定した値<img src="../images/Algorithm_(signrank1)/math-4ed1ed38631c7263bc6b664a5c510f8e.png" title="\mu _0\,\!" alt="\mu _0\,\!" class="tex"/>であるという帰無仮説を棄却します。
<p><img src="../images/Algorithm_(signrank1)/math-49f05dc56aa54a13a63962746c7fff75.png" title="\left| z\right| &gt;Z_{\alpha /2}" alt="\left| z\right| &gt;Z_{\alpha /2}" class="tex"/>が Z~N(0,1)の場合
</p><p>標本サイズが大きい場合、 例えば、母集団の大きさが50以上の時の分布は、正規分布に近似されます。 
</p>
</td></tr></table>
<p>このアルゴリズムの詳細は、<a class="external text" href="http://www.originlab.com/pdfs/nagcl09/manual/pdf/g08/g08agc.pdf" target="_blank"><b>nag_wilcoxon_test (g08agc)</b></a>をご覧下さい。
</p>






    