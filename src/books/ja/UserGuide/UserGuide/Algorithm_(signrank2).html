<h1 class="firstheading">アルゴリズム(対応のあるデータのWilcoxon符号順位検定)</h1>
<p><br />
最初の母集団の中央値が2番目の母集団の中央値と同じかどうかを検定するには、対応のあるデータのWilcoxon符号順位検定を実行を実行します。最初の母集団と2番目の母集団の標本サイズは同じにします。</p>
<ol>
<li>この場合、<img src="../images/Algorithm_(signrank2)/math-9b0b09d3b8160549d46206793139aacb.png" title="\{x_i,y_i\}\,\!" alt="\{x_i,y_i\}\,\!" class="tex" border="0" />,<img src="../images/Algorithm_(signrank2)/math-6b80d670336d4b43b32dbd006770a4f1.png" title="i=1,2,\ldots ,n" alt="i=1,2,\ldots ,n" class="tex" border="0" />帰無仮説 <img src="../images/Algorithm_(signrank2)/math-806277203dedea2ed8321f6cbd465a54.png" title="H_0\,\!" alt="H_0\,\!" class="tex" border="0" />は、中央値が同じということで、対立仮説 <img src="../images/Algorithm_(signrank2)/math-fabff59271b950125b7a360fba21de2c.png" title="H_1\,\!" alt="H_1\,\!" class="tex" border="0" />は、片側または両側にすることができます。Wilcoxon符号順位検定は、スコアの符号だけでなく、スコアの大きさが考慮されるという点で符号検定とは異なります。</li>
<li>この場合、<img src="../images/Algorithm_(signrank2)/math-9b0b09d3b8160549d46206793139aacb.png" title="\{x_i,y_i\}\,\!" alt="\{x_i,y_i\}\,\!" class="tex" border="0" />、<img src="../images/Algorithm_(signrank2)/math-6b80d670336d4b43b32dbd006770a4f1.png" title="i=1,2,\ldots ,n" alt="i=1,2,\ldots ,n" class="tex" border="0" />に対して、符号の差<img src="../images/Algorithm_(signrank2)/math-5f18689480564609656880fdfb141abc.png" title=" d_i=x_i-y_i\,\!" alt=" d_i=x_i-y_i\,\!" class="tex" border="0" /> を計算します。</li>
<li>絶対値の差 <img src="../images/Algorithm_(signrank2)/math-80c599954d244f780dfa6152785f1d15.png" title="\left| d_i\right| " alt="\left| d_i\right| " class="tex" border="0" />が順位付けされ、どの同順位の値でも <img src="../images/Algorithm_(signrank2)/math-80c599954d244f780dfa6152785f1d15.png" title="\left| d_i\right| " alt="\left| d_i\right| " class="tex" border="0" />が同順位の平均に割り当てられます。ユーザは、順位付けの前後でそれらを削除することで、<img src="../images/Algorithm_(signrank2)/math-a3bf95053be7ee784232acceb28b8046.png" title="d_i=0\,\!" alt="d_i=0\,\!" class="tex" border="0" />であるような、さまざまなケースを無視するかどうかを選択することができます。</li>
<li>ゼロでない<img src="../images/Algorithm_(signrank2)/math-a3bf95053be7ee784232acceb28b8046.png" title="d_i=0\,\!" alt="d_i=0\,\!" class="tex" border="0" />の数が調べられ <img src="../images/Algorithm_(signrank2)/math-8d88a43872d6db6535d8672a15f09ce2.png" title="n_1\,\!" alt="n_1\,\!" class="tex" border="0" />で表されます。</li>
<li>各符号に、対応する <img src="../images/Algorithm_(signrank2)/math-a3bf95053be7ee784232acceb28b8046.png" title="d_i=0\,\!" alt="d_i=0\,\!" class="tex" border="0" />の符号が付加されます。<img src="../images/Algorithm_(signrank2)/math-1e45800d815894820f5acad906bbb8e7.png" title="s_i=sign(d_i)r_i\,\!" alt="s_i=sign(d_i)r_i\,\!" class="tex" border="0" />とします。</li>
<li>正の符号順位の合計<img src="../images/Algorithm_(signrank2)/math-cf58fc84b8733a6b98b7e6ea1cb1e9ae.png" title=" W_1=\sum_{s_i&gt;0}s_i=\sum_{i=1}^n\max (s_i,0) " alt=" W_1=\sum_{s_i&gt;0}s_i=\sum_{i=1}^n\max (s_i,0) " class="tex" border="0" />は次の式で計算できます。</li>
<li>片側の確率 <img src="../images/Algorithm_(signrank2)/math-fe6b6f2dcae650d9e649d40ca981681d.png" title="P\,\!" alt="P\,\!" class="tex" border="0" /> ( <img src="../images/Algorithm_(signrank2)/math-e5631ee132b76058c37eb3abeed99259.png" title="W\,\!" alt="W\,\!" class="tex" border="0" />に対応)は、対立仮説<img src="../images/Algorithm_(signrank2)/math-fabff59271b950125b7a360fba21de2c.png" title="H_1\,\!" alt="H_1\,\!" class="tex" border="0" />の選択に依存します。<img src="../images/Algorithm_(signrank2)/math-0223f7d3cf5585048856fbc6f3526098.png" title="n_1\leq 80" alt="n_1\leq 80" class="tex" border="0" />の場合、<img src="../images/Algorithm_(signrank2)/math-44c29edb103a2872f519ad0c9a0fdaaa.png" title="P" alt="P" class="tex" border="0" />値は厳密に計算され、それ以外では、<img src="../images/Algorithm_(signrank2)/math-44c29edb103a2872f519ad0c9a0fdaaa.png" title="P" alt="P" class="tex" border="0" />への近似値が返されます。この近似は、正規検定統計量<img src="../images/Algorithm_(signrank2)/math-07b1048bc60901fe82394ae47282671c.png" title="Z\,\!" alt="Z\,\!" class="tex" border="0" />の近似に基づいており、 これは <img src="../images/Algorithm_(signrank2)/math-28553b84f7e48474ccf64f67b8d03413.png" title=" z=\frac{(W-\frac{n_1(n_1+1)}4)-\frac 12\cdot sign(W-\frac{n_1(n_1+1)}4)}{\sqrt{\frac 14\cdot \sum_{i=1}^nS_i^2}}" alt=" z=\frac{(W-\frac{n_1(n_1+1)}4)-\frac 12\cdot sign(W-\frac{n_1(n_1+1)}4)}{\sqrt{\frac 14\cdot \sum_{i=1}^nS_i^2}}" class="tex" border="0" />で計算されます。</li>
</ol>
<p><span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(signrank2)/math-fe6b6f2dcae650d9e649d40ca981681d.png" title="P\,\!" alt="P\,\!" class="tex" border="0" /></span>の値は、対立仮説に対する中央値の有意差検定を実行するのに使用されます。<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(signrank2)/math-06f7895cd704b1cb0921cf98aec71926.png" title="\alpha\,\!" alt="\alpha\,\!" class="tex" border="0" /></span>を有意差検定の大きさにします。(つまり <span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(signrank2)/math-06f7895cd704b1cb0921cf98aec71926.png" title="\alpha\,\!" alt="\alpha\,\!" class="tex" border="0" /></span>は <span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(signrank2)/math-806277203dedea2ed8321f6cbd465a54.png" title="H_0\,\!" alt="H_0\,\!" class="tex" border="0" /></span>が真のときに <span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(signrank2)/math-806277203dedea2ed8321f6cbd465a54.png" title="H_0\,\!" alt="H_0\,\!" class="tex" border="0" /></span>を棄却する確率です。)<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(signrank2)/math-af035e6cb336d69d62fd85276db8da3c.png" title="P&lt;\alpha \,\!" alt="P&lt;\alpha \,\!" class="tex" border="0" /></span>の場合、帰無仮説が棄却されます。通常、<span style="line-height: 19.2px; orphans: auto; widows: 1; -webkit-text-stroke-width: 0px;"><img src="../images/Algorithm_(signrank2)/math-06f7895cd704b1cb0921cf98aec71926.png" title="\alpha\,\!" alt="\alpha\,\!" class="tex" border="0" /></span>は、0.05 または 0.01です。</p>
<p>このアルゴリズムの詳細は、<b><a href="http://www.originlab.com/pdfs/nagcl09/manual/pdf/g08/g08agc.pdf" class="external text" title="http://www.originlab.com/pdfs/nagcl09/manual/pdf/g08/g08agc.pdf" rel="nofollow" target="_blank">nag_wilcoxon_test (g08agc)</a></b>をご覧下さい。</p>
<p><br /></p>
