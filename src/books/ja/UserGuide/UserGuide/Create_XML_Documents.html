<h1 class="firstheading">OriginのドキュメントをXMLドキュメントに変換するためにMSXML Parserを利用する</h1>
<p class="urlname" style="display: none;">Create-XML</p>
<p><br />
Origin CのCOMサポートは、XMLドキュメントをプログラムして作成することが出来ます。コードの詳細につきましては、こちらをご参照ください<a class="external text" href="http://www.originlab.com/pdfs/origin_c_examples/WksToXML_1.pdf" target="_blank">WksToXML.PDF</a>.</p>
<dl>
<dd>
<dl>
<dd><a class="image" style="color: #0000ff; text-decoration: underline;"><img alt="WKSTOXML.png" src="../images/Create_XML_Documents/400px-WKSTOXML.png" srcset="/images/docwiki/3/36/WKSTOXML.png 1.5x, /images/docwiki/3/36/WKSTOXML.png 2x" width="400" height="255" border="0" /></a></dd>
</dl>
</dd>
</dl>
<p><b style="font-weight: bold;">WksToXML</b>ファンクションは、Microsoft MSXML parser (version 3 - 他のバージョンも可)を，OriginのワークシートをXMLドキュメントに変換することが出来ます。 このファンクションは、2つの引数を取ります。<br /></p>
<dl>
<dd>
<dl>
<dd>1.<b>A string</b> - この文字列の初期設定はData1ですが、LabTlak言語での文字列変数 (例：&#160;%H - アクティブなウィンドウタイトル)を含む、様々なワークシート名を使うことが出来ます。LabTalkの文字列変数は、XMLファイルに保存された複数のワークシートでのバッチ処理の実行をより簡単にします。</dd>
<dd>2.<b>A string</b> - この文字列の初期設定はCドライブ(例：C:\)ですが、あらゆるパスに変更が可能です。</dd>
</dl>
</dd>
</dl>
<p>C ファイルがコードビルダ（Originに内臓）でコンパイルされると、WKSToXML ファンクションは Origin C または LabTalk シンタックスの両方で呼び出されます。これは次の内容と同様です：</p>
<table class="simple" width="80%">
<tr>
<th style="width: 40%;">Origin Cでは</th>
<th style="width: 40%;">LabTalkでは</th>
</tr>
<tr>
<td>WKSToXML(<i>MyWorksheet,C:\Temp</i>);</td>
<td>WKSToXML <i>MyWorksheet C:\Temp</i>;</td>
</tr>
</table>
<p>別のファンクション <b>XMLToWks</b>では、XMLドキュメントをOriginのワークシートにインポートします。このファンクションは1つの引数、パスとファイル名を文字列としてとります。次のように、この機能で適切なファンクションを呼び出します。</p>
<table class="simple" width="80%">
<tr>
<th style="width: 40%;">Origin Cでは</th>
<th style="width: 40%;">LabTalkでは</th>
</tr>
<tr>
<td>XMLToWks(<i>C:\Temp</i>);</td>
<td>XMLToWks <i>C:\Temp</i>;</td>
</tr>
</table>
<p><font>Note</font>: この例では、Originのサブフォルダにある<b>\Samples\COM Server and Client\XML\Client</b> も利用することが出来ます。これは<b>WksToXML.c</b>を呼び出します。</p>
