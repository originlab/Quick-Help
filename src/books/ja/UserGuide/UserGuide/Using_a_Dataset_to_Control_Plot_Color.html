<h1 class="firstheading">データセットの値を使用してデータプロットの色を制御する</h1><p class='urlname' style='display: none'>プロットの色 - データセット制御</p>
<p><br />
Originのワークシート（または、エクセルのワークブック）にある値の列を使って、同じワークシートやワークブックから作図したデータのプロットの色を編集できます。
</p>
<ul><li> プロットデータの両端にある155列までのうち、どれか1つを、色制御のデータセットとして指定できます。 </li>
<li> 元のワークシート内で、155列より多い列がYのデータセットの右にある場合、Y列を作図した値（この値を含む）から155列までの列が、色制御の列として表示されます。 </li>
<li> ワークシート内で、155列より少ない列がYのデータセットの右にある場合、Yデータセットの左右両方にある列が使用されます。 </li></ul>
<p>データセットで色制御を設定するにはデータプロットの要素のカラーボタンを使って行います(例えば、「作図の詳細」ダイアログの<b>シンボルの色</b>のボタン)。 
</p><p><a  class="image"><img alt="Dataset Color Control.png" src="../images/Using_a_Dataset_to_Control_Plot_Color/Dataset_Color_Control.png" width="432"  /></a>
</p><p><a href="../../UserGuide/UserGuide/Customizing_Data_Plot_Colors.html#Opening_the_Color_Chooser" title="ユーザガイド:データプロットの色を編集する"><b>カラーチューザー</b>の<b>ポイント毎</b>タブ</a>にある方法で、データセットの色の制御ができます。最初の3つの方法は、一般的なグラフタイプで利用可能で、残りは特定のグラフタイプで使用するものです。 
</p>
<ul><li> <b>インデックス</b>: このオプションは、整数のデータセットまたは特定の <b>カラーリスト</b> にある色を指定するテキストストリングを使用します。</li>
<li> <b>RGB直接</b>: このオプションの場合、独立したR,G,Bの値から計算された、RGBの構成値のデータセットを使います。 </li>
<li> <b>カラーマップ</b>: このオプションの場合、ビン化され、かつ、カスタマイズ可能なビン範囲の実数のデータセットが、カスタマイズ可能なカラーリストにマップされます。</li>
<li> <b>密度カラーマッピング</b>: <a href="../../UserGuide/UserGuide/Customizing_Data_Plot_Colors.html#Using_Column_Values_to_Apply_Color_By_Points" title="ユーザガイド:データプロットの色を編集する">密度ドット</a>テンプレートで使用できます。</li>
<li><b>Y値: カラーマップ</b>: 1つのグラフに複数のYデータが存在する時、このオプションではY値とによってカラーマップを設定し、同様のカラーマップレベルを適用します。</li>
<li> <b>Y値: 正-負-合計</b>: このオプションは、対応するY値が正、負、または合計のどの条件であるかによって、縦棒/横棒を異なる色で塗ります。(<a href="../../UserGuide/UserGuide/Bridge_Chart.html" title="ユーザガイド: 滝グラフ">滝グラフ</a>でのみ利用可能)</li></ul>
<p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Indexing"><span class="tocnumber">1</span> <span class="toctext">インデックス</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Direct_RGB"><span class="tocnumber">2</span> <span class="toctext">RGB直接</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Color_Mapping"><span class="tocnumber">3</span> <span class="toctext">カラーマップ</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Y_Value:_Color_Mapping"><span class="tocnumber">4</span> <span class="toctext">Y値: カラーマップ</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Y_Value:_Plus-Minus-Total"><span class="tocnumber">5</span> <span class="toctext">Y値: 正-負-合計</span></a></li>
</ul>
</div>
<h2><a name="Indexing"></a><span class="mw-headline">インデックス：</span></h2>
<p>このオプションは、整数のデータセットまたは特定のカラーリストにある色を指定する <a href="../../UserGuide/UserGuide/Displaying_Supporting_Data_in_Worksheet_header_Rows.html#Categories" title="ユーザガイド:ワークシートヘッダ行に表示するサポートデータ">カテゴリー値</a> を使用します。  
</p><p><b>このツールを使うには</b>
</p>
<ol><li>変更したいデータプロットをダブルクリックします。  「作図の詳細」ダイアログボックスが開きます。</li>
<li>「<b>シンボル</b>」タブ、「<b>パターン</b>」タブなどを選択します。</li>
<li>「<b>シンボルの色</b>」ボタン、「<b>塗り色</b>ボタンなどをクリックします。カラーチューザーが開いたら、「<b>ポイント毎</b>」タブで、<b>インデックス</b>: <i><b>データセット</b></i> (<i><b>データセット</b></i>色制御のデータを保存している列名）を選択します。</li>
<li> <b>適用</b>をクリックします。</li></ol>
<p><a  class="image"><img alt="Indexing Color ByPoints.png" src="../images/Using_a_Dataset_to_Control_Plot_Color/Indexing_Color_ByPoints.png" width="436"  /></a>
</p>
<table class="note">
<tr>
<td>
<p><b>Note:</b>インデックスしている列の<b>列フォーマット</b>は、<b>数値</b>、または、<b>文字と数値</b> 列には、整数を含んでいないといけません。カテゴリーデータの場合は、対応するカテゴリ―です。小数点の右の全てがドロップされます。
</p>
</td></tr></table>
<p><br />
<b>インデックス色を変更するには:</b>
<br />
<br />
Origin 2019より前のバージョンでは、ワークシートの値のインデックスを作成するには、作図詳細で<b>色リスト</b>タブに追加し、カラーリストをそのタブでカラーリストをカスタマイズしました。Origin 2019では、以下のように変更されています。
</p>
<ol><li> 色リストボタンをクリックします (例 シンボル = <b>シンボルの色</b>)</li>
<li> 鉛筆のアイコン<a  class="image"><img alt="Button edit pencil.png" src="../images/Using_a_Dataset_to_Control_Plot_Color/Button_edit_pencil.png" width="22"  /></a>をクリックして、現在の<b>色リスト</b>を右にスライドさせます。</li>
<li> <a href="../../UserGuide/UserGuide/Customizing_Data_Plot_Colors.html" title="ユーザガイド:データプロットの色を編集する">色リストをロード、修正、保存する</a>に従って作業します。</li></ol>
<h2><a name="Direct_RGB"></a><span class="mw-headline">RGB直接:</span></h2>
<p>RGB色をOriginのグラフに適用するには、RGB合成値を作成する必要があります。RGB合成値は次の値から計算できます。
</p>
<ul><li> 赤(<b>R</b>)、緑(<b>G</b>)、青(<b>B</b>)の3つの要素を含むワークシート列。<b>赤</b>、<b>緑</b>、<b>青</b>の値は、0から255の範囲をとります(例：(255,0,0))。 </li>
<li> <b>HTMLカラーコード</b>値のワークシート列(例：#FF0000)</li></ul>
<p>RGB合成値は以下のように計算できます。
</p>
<ol><li> <a href="../../UserGuide/UserGuide/Quick_Start_SetColumnValues.html" title="ユーザガイド:クィックスタート 列値の設定"><b>値の設定</b></a>で、<a class="external text" href="../../LabTalk/LabTalk/Color_(function).html"><b>color()</b>関数</a>を使って、下の画像のように合成値を計算します(黄色で示した<b>F(x)=</b>行はスプレッドシートセル表記を使用しています)。</li></ol>
<dl><dd><a  class="image"><img alt="RGB using SCV.png" src="../images/Using_a_Dataset_to_Control_Plot_Color/RGB_using_SCV.png" width="773"  /></a></dd></dl>
<p>RGB合成値のデータセットが用意できたら、以下のようにします。
</p>
<ol><li>変更したいデータプロットをダブルクリックします。  「作図の詳細」ダイアログボックスが開きます。</li>
<li>「<b>シンボル</b>」タブ、「<b>パターン</b>」タブなどを選択します。</li>
<li>色ボタン(<b>境界の色</b>など)をクリックし、<b>ポイント毎</b>タブをクリックして<b>RGB直接</b>: <i><b>データセット</b></i>(RGB合成値が入力されたデータセット)を選択します。</li></ol>
<dl><dd><a  class="image"><img alt="RGB using color plot.png" src="../images/Using_a_Dataset_to_Control_Plot_Color/RGB_using_color_plot.png" width="810"  /></a></dd></dl>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Using_a_Dataset_to_Control_Plot_Color/Tip_icon.png" width="57"  border="0" /></td><td><p>スクリプトウィンドウまたはコマンドウィンドウで<a class="external text" href="../../LabTalk/LabTalk/Color_(function).html">Color() 関数</a> を使い、HTMLカラーコードまたはRGBの3つの値からRGB合成値を計算することもできます。 
</p>
<ol><li> コマンドウィンドウ(<b>ウィンドウ：コマンドウィンドウ</b>)またはスクリプトウィンドウ(<b>ウィンドウ：スクリプトウィンドウ</b>)を開きます。</li>
<li> 以下のサンプルの通りに値を入力し、Enterキーを押します。</li></ol>
<pre class="lt" style="font-family:monospace;">color<span style="color: #000000;">(</span>#FF0000<span style="color: #000000;">)</span><span style="color: #000080;">=</span>
color<span style="color: #000000;">(</span><span style="color: #0000dd;">255</span>,<span style="color: #0000dd;">0</span>,<span style="color: #0000dd;">0</span><span style="color: #000000;">)</span><span style="color: #000080;">=</span></pre>
<dl><dd>Originは次のように返します。</dd></dl>
<pre class="lt" style="font-family:monospace;">color<span style="color: #000000;">(</span>#FF0000<span style="color: #000000;">)</span><span style="color: #000080;">=</span>
color<span style="color: #0000dd;">(</span><span style="color: #0000dd;">255</span>,<span style="color: #0000dd;">0</span>,<span style="color: #0000dd;">0</span><span style="color: #000000;">)</span><span style="color: #000080;">=</span></pre>
</td></tr></table>
<h2><a name="Color_Mapping"></a><span class="mw-headline">カラーマップ</span></h2>
<p>このオプションでは、2DのY値または3DのZ値と色階調との間にマッピング関係を作成できます。  作成したカラーマップに基づいて、2D Y値や3D Z値がプロットのデータポイント色要素として利用されます。YまたはZは実数です。 
</p>
<ol><li>変更したいデータプロットをダブルクリックします。  「作図の詳細」ダイアログボックスが開きます。</li>
<li>「<b>シンボル</b>」タブ、「<b>パターン</b>」タブなどを選択します。</li>
<li><b>シンボルの色</b> ボタン、<b>塗り色</b> ボタン等を選択し、 <b>カラーマッピング</b>: <i><b>データセット</b></i> を選択します。  </li></ol>
<table class="note">
<tr>
<td><b>Note:</b> このオプションが選択されている場合、<b>作図の詳細</b>ダイアログボックスに、<b>カラーマップ</b>タブが追加されます。「<b>カラーマップ</b>」タブのコントロールを使って、カラーマップを操作します。 <a href="../../UserGuide/UserGuide/The_(Plot_Details)_Color_Map_Tab.html" title="ユーザガイド:(作図の詳細) 「カラーマップ」タブ">（<i>シンボルの色</i>ボタンからは操作できません。） </a>
<dl><dd><a  class="image"><img alt="Colormap DoNotUse.png" src="../images/Using_a_Dataset_to_Control_Plot_Color/Colormap_DoNotUse.png" width="620"  /></a></dd></dl>
</td></tr></table>
<p><br />
<b>例:</b>
</p>
<ol><li>新規プロジェクト、または、新規ワークブックを作成します。「単一ASCIIインポート」ボタンを使って、データファイル  「/Samples/Graphing/Template.dat 」をインポートします。 <a  class="image"><img alt="Import Single ASCII.png" src="../images/Using_a_Dataset_to_Control_Plot_Color/Import_Single_ASCII.png" width="26"  /></a></li>
<li>列(A)と列（B)を指定して、<b>作図：基本の2Dグラフ：散布図</b>を選択して、グラフを作成します。  <br /><a  class="image"><img alt="Color Mapping 1.png" src="../images/Using_a_Dataset_to_Control_Plot_Color/Color_Mapping_1.png" width="367"  /></a></li>
<li>グラフのデータ上でダブルクリックします。  「作図の詳細」ダイアログボックスが開きます。</li>
<li><b>シンボル</b>タブを開きます。</li>
<li><b>シンボルの色</b>ボタンをクリックして、<b>ポイント毎</b>タブで、<b>カラーマップ:</b> <i><b>Col(&quot;SVep&quot;)</b></i>を選択します。 </li></ol>
<dl><dd><dl><dd><a  class="image"><img alt="Color Mapping 2.png" src="../images/Using_a_Dataset_to_Control_Plot_Color/Color_Mapping_2.png" width="435"  /></a></dd></dl></dd>
<dd>グラフは下図のようになっています。
<dl><dd><a  class="image"><img alt="Color Mapping 3.png" src="../images/Using_a_Dataset_to_Control_Plot_Color/Color_Mapping_3.png" width="367"  /></a></dd></dl></dd></dl>
<p>Originは、自動的に8色(とその上下層)の色階調を作成します。さらに、データセットの最高値と最低値が確認され、データセットの値が色階調の色にマッピングされます。その結果8つのレベルになります。  
</p><p>デフォルトのカラーマップをカスタムするには：
</p>
<ol><li>プロットをダブルクリックして、作図の詳細を開き、<b>カラーマップ</b>タブを開きます。<b>レベル</b>、または、<b>色塗り</b>の列ヘッダでクリックして、YやZの値の範囲を関連付けた色に指定します。  </li>
<li><b>挿入: 色スケール</b>を選択し、カラースケールとグラフに関連付けられたカラーマップを表示します。</li></ol>
<table class="note">
<tr>
<td><b>Note</b>: スケールをダブルクリックして、色スケール制御ダイアログボックスを開いて、スケールを変更します。詳細は、<a href="../../UserGuide/UserGuide/Color_Scales.html" title="ユーザガイド:色スケール">色スケール</a>をご覧ください。
</td></tr></table>
<p><br />
カラーマップオプションは、2つの従属変数と1つの独立変数からなるデータを表現するときに、特に効果を発揮します。  この場合、従属変数を独立変数の一方に対して作図し、もう1つの独立変数をデータプロットのカラーマップに使用します。  例えば、あるサンプルからの反応を様々な位置や温度に応じて計測するとします。カラーマップオプションを使わない場合、2レイヤグラフを用いて温度と、観測された反応の変化を表すことになります。  カラーマップオプションを利用すると、観測された反応と対応する位置、温度をカラーマップとしてプロットすることができます。
</p>
<h2><a name="Y_Value:_Color_Mapping"></a><span class="mw-headline">Y値: カラーマップ</span></h2>
<p>このオプションは2Dグループプロットの内部編集モードでのみ有効です。Y値: カラーマップ: 1つのグラフに複数のYデータが存在する時、このオプションではY値とによってカラーマップを設定し、同様のカラーマップレベルを適用します。
</p><p><b>例:</b>
</p>
<ol>
<li>新規プロジェクト、または、新規ワークブックを作成します。「単一ASCIIインポート」ボタンを使って、データファイル \Samples\Curve Fitting\Composite Spectrum.dat をインポートします。 <a  class="image"><img alt="Import Single ASCII.png" src="../images/Using_a_Dataset_to_Control_Plot_Color/Import_Single_ASCII.png" width="26"  /></a></li>
<li>すべての列をハイライトして、<b>作図: 2D: 複数Y軸: Yオフセット付き積上げ折れ線</b>を選択して作図します。</li>
<p><a  class="image"><img alt="Y Value Color Mapping 1.png" src="../images/Using_a_Dataset_to_Control_Plot_Color/Y_Value_Color_Mapping_1.png" width="382"  /></a>
</p>
<li>メニューから、<b>フォーマット：作図の詳細（プロット属性）</b>を選択し、<b>作図の詳細</b>ダイアログボックスを開きます。</li>
<li><b>グラフの線</b>タブを開きます。 </li>
<li><b>色</b>ボタンをクリックして、<b>ポイント毎</b>タブで、<b>Y値：カラーマップ</b>を選択します。</li>
<p><a  class="image"><img alt="Y値: カラーマップ" src="../images/Using_a_Dataset_to_Control_Plot_Color/Y_Value_Color_Mapping_2.png" width="785"  /></a>
</p>
<li><b>カラーマップ</b>タブを開きます。カラーマップを下図のようにセットします。</li>
<p><a  class="image"><img alt="Y Value Color Mapping 3.png" src="../images/Using_a_Dataset_to_Control_Plot_Color/Y_Value_Color_Mapping_3.png" width="559"  /></a>
</p>
<li>最後に、グラフに色スケールを追加したい場合、<b>グラフにオブジェクトを追加</b>ツールバーの<b>カラースケール</b>ボタン<a  class="image"><img alt="Colorscale.png" src="../images/Using_a_Dataset_to_Control_Plot_Color/Colorscale.png" width="24"  /></a>をクリックします。</li>
<p><a  class="image"><img alt="Y Value Color Mapping 4.png" src="../images/Using_a_Dataset_to_Control_Plot_Color/Y_Value_Color_Mapping_4.png" width="431"  /></a>
</p>
</ol>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Using_a_Dataset_to_Control_Plot_Color/Tip_icon.png" width="57"  border="0" /></td><td><p>カラーマッププロットに対して色スケールはデフォルトの凡例が適用されていますが、プロットに独立したカラースケールを追加することができます。詳しくは、<a href="../../UserGuide/UserGuide/Color_Scales.html#Adding_an_independent_color_scale" title="ユーザガイド:色スケール"><b>独立したカラースケールの追加</b></a>.を参照してください。
</p></td></tr></table>
<h2><a name="Y_Value:_Plus-Minus-Total"></a><span class="mw-headline">Y値: 正-負-合計</span></h2>
<p>このオプションは、滝グラフでのみ使用できます（マッキンゼースタイルのウォータフォールとも呼ばれます）。滝グラフは、作図の詳細（レイヤ属性）の<b>滝グラフ</b>タブで、<b>滝グラフを有効にする</b>を選択した棒グラフです。 
</p><p>このオプションは、<b>作図の詳細</b>ダイアログの<a href="../../UserGuide/UserGuide/The_(Plot_Details)_Pattern_Tab.html#Color" title="ユーザガイド:(作図の詳細)「パターン」タブ">パターンタブ</a>の塗り色/パターン色ドロップダウンリストにあります。対応するY値が正、負、または合計のどの条件であるかによって、縦棒/横棒を異なる色で塗ります。<b>滝グラフ</b>タブの<b>合計/小計のデータインデックス</b>で合計を設定できます。 
</p><p><a  class="image"><img alt="Y Value Plus Minus Total 1.png" src="../images/Using_a_Dataset_to_Control_Plot_Color/Y_Value_Plus_Minus_Total_1.png" width="922"  /></a>
</p><p>塗りつぶしのカラーシーケンスは、カラーリストの下部に表示されます。<b>Y値: 正-負-合計</b>オプションでは、最初の3つの色だけが使用されます。1番目の色は正のY、2番目の色は負のY、3番目の色は合計に割り当てられます。 
</p><p>Ctrlキーを押しながらカラーリストをクリックして、<a href="../../UserGuide/UserGuide/Customizing_Data_Plot_Colors.html#The_Increment_Editor" title="ユーザガイド:データプロットの色を編集する"><b>推移リストエディタ</b></a>を開き、色を修正できます。
</p>

    