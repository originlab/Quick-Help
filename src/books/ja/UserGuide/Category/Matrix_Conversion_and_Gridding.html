<h1 class="firstheading">行列変換とグリッディング</h1>
<p>ワークシートのデータから<b>3D曲面図</b>や<b>等高線図</b>を作成する場合、最初にデータを<b>行列形式</b>に保存する必要があります。Oiginで<b>ワークシートを行列に変換する</b>基本的な処理方法は、3つあります。</p>
<dl>
<dd>
<ul>
<li><b style="font-weight: bold;">直接変換</b> 一般的なワークブックデータの配置 -- 特にExcelファイルの場合 -- は <b>X</b> と <b>Y</b> の測定データがワークシートの最初の行と最初の列に保存されており、<b>Z</b>値が各XYデータの交わるセルに保存されます。</li>
<li><b style="font-weight: bold;">XYZグリッディング</b> グリッディング法は、選択したアルゴリズムを使って、XYZデータを行列に変換します。</li>
<li>拡張 ： この手法は、ASCII(または他の)インポートによりワークシートの複数行データが行列の各行に構成される場合に使用します。</li>
</ul>
</dd>
</dl>
<p>直接変換は、ワークシートに含まれるZデータをそのままOriginの行列にコピーするか、転置してコピーするだけです。</p>
<p>XYZグリッディングは、より複雑な処理を行います。Originの行列はZ値が四角形に配列され、その列は線形でX値にマッピングされ、行は線形でY値にマッピングされます。元のワークシートのXYZデータがXおよびY方向に等間隔である場合、<b>標準配置</b>グリッディング法を使ってデータを行列に変換します。データがXおよびY方向に等間隔でない場合、いくつかの<b>ランダムグリッディング法</b>の1つを使う必要があります。</p>
<p>ランダムデータ配置のグリッディング法では、1セットの不規則なデータポイント<i>(xi, yi, zi)</i>において、<i>F(xi, yi)=zi</i>という式が成り立つようにデータを補間する関数 <i>F(x, y)</i>を構築しなければならないという数学上の問題があります。XY平面上では、データポイントが区別されなければなりません(1対のXYデータに複数のZデータを持つことはできません。Note 1をご覧ください。) 構築された曲面は連続した曲線で、連続した一次導関数を持ちます。</p>
<p>補間するとき、推定されるグリッドに近いデータポイントに、より大きな重み付けがされます。グリッドを定義するときには、グローバルとローカルの両方の計算方法が使われます。グローバルなアルゴリズムは、各グリッドを定義するのにすべてのデータポイントを使用し、ローカルなアルゴリズムでは、定義されるグリッドに近いXYデータだけを使います。そのためグリッディング結果は、使用されるアルゴリズムにより多少の違いがあります。また、グローバルなアルゴリズムは、多くのXYデータから情報を取得する必要があるので、計算量が多くなります。(相対的なスピードの比較は<a href="../Category/XYZ_Gridding_Methods.html" title="Category:XYZグリッディング法">XYZグリッディング法</a>をご覧ください。)</p>
<table class="note">
<tr>
<td>
<p><b style="font-weight: bold;">Note1:</b> データセットが同一線上のデータの場合、それは曲面を定義できないので、使用することができません。そのため同一線上のデータは削除する必要があります。また、 特定の (x, y) に対する複数のz値は複合z値を決定するため複数のオプションを 持ちます。</p>
</td>
</tr>
</table>
<table class="note">
<tr>
<td>
<p><b style="font-weight: bold;">Note 2:</b> Originの行列ブックには、2つの<b>ヘッダ</b>表示モードがあります。<b>行/列 (「表示：行/列モード」)</b> と <b>X/Y表示 (「表示：X/Yモード」)</b>です。</p>
<ul>
<li><b style="font-weight: bold;">行/列モード</b>の場合、行列の行と列の<b>インデックス番号</b>が、行列の行と列のヘッダに表示されます。</li>
<li><b style="font-weight: bold;">X/Y</b>モードの場合、行列のXとYの<b>値</b>が、行列の行と列のヘッダに表示されます。</li>
</ul>
<dl>
<dd><img alt="Image:Matrix Conversion and Gridding1.gif" src="../images/Matrix_Conversion_and_Gridding/Matrix_Conversion_and_Gridding1.gif" width="333" height="165" border="0" /></dd>
<dd><img alt="Image:Matrix Conversion and Gridding2.gif" src="../images/Matrix_Conversion_and_Gridding/Matrix_Conversion_and_Gridding2.gif" width="333" height="165" border="0" /></dd>
</dl>
</td>
</tr>
</table>
<table class="topiclist">
<tr>
<td><i style="font-style: italic;"><b style="font-weight: bold;">行列変換とグリッディング</b></i>
<ul>
<li><a href="../UserGuide/Direct_Worksheet_to_Matrix_Conversion.html">ワークシートを行列に直接変換</a></li>
<li><a href="XYZ_Gridding_Methods.html">XYZグリッディング法</a></li>
<li><a href="../UserGuide/Expanding_Columns_During_Conversion.html">列の拡張</a></li>
<li><a href="../UserGuide/References%2c_Matrix_Conversion_and_Gridding.html">参考文献：行列変換とグリッディング</a></li>
</ul>
</td>
</tr>
</table>
<p>&#160;</p>
<p>&#160;</p>
