<h1 class="firstheading">部分インポートと再インポート</h1>
<p class="urlname" style="display: none;">PartialImport-ReImport</p>
<p><br /></p>
<div style="text-align: left; direction: ltr; margin-left: 1em;">
<p><a class="image"><img alt="Video Image.png" src="../images/Partial_Importing_and_Re_Importing/Video_Image.png" width="33" border="0" /></a> 関連する動画はこちら：<a class="external text" href="http://www.originlab.com/index.aspx?go=Products/Origin/ImportingData&amp;ss=chm&amp;pid=1164" target="_blank">Partial Import</a></p>
</div>
<div id="toc" class="toc">
<div id="toctitle">
<h2>目次</h2>
</div>
<ol>
<li class="toclevel-1 tocsection-1"><a href="#Partial_Import"><span class="tocnumber">1</span> <span class="toctext">部分インポート</span></a>
<ol>
<li class="toclevel-2 tocsection-2"><a href="#Partial_Import_Controls_used_by_Import_From_File"><span class="tocnumber">1.1</span> <span class="toctext">ファイルからインポートにおける部分インポートの設定</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Partial_Import_by_NetCDF_Connector"><span class="tocnumber">1.2</span> <span class="toctext">NetCDFコネクタの部分インポート</span></a>
<ol>
<li class="toclevel-3 tocsection-4"><a href="#Ultimate_partial-import_control_for_NetCDF"><span class="tocnumber">1.2.1</span> <span class="toctext">NetCDFの部分インポート制御の原理</span></a></li>
</ol>
</li>
<li class="toclevel-2 tocsection-5"><a href="#Partial_Import_by_TDMS_Connector"><span class="tocnumber">1.3</span> <span class="toctext">TDMSコネクタの部分インポート</span></a></li>
</ol>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Re-Import"><span class="tocnumber">2</span> <span class="toctext">再インポート</span></a></li>
</ol>
</div>
<h2><a name="Partial_Import" id="Partial_Import"></a><span class="mw-headline">部分インポート</span></h2>
<p>たとえば、データの一部だけが必要、あるいはファイルサイズが大きくインポートが遅い、などでデータファイルの一部をインポート必要があるとき、<b>ファイルの部分インポート</b>が可能です。部分インポートがサポートされるのは一部のファイル形式です。ここで説明している以外のファイル形式では、部分インポートはサポートされていません。</p>
<ul>
<li><b>データ: ファイルからインポート</b>でインポートした場合、Originは<a href="../../UserGuide/UserGuide/Customizing_the_ASCII_Import_Options.html" title="ユーザガイド:ASCIIインポートオプションをカスタマイズする"><b>ASCII</b></a>、<b>バイナリ</b>（<a href="../../UserGuide/Category/The_Import_Wizard.html" title="カテゴリ：インポートウィザード">インポートウィザード</a>を使用）、<a href="../../UserGuide/UserGuide/Importing_Third_Party_Files.html" title="サードパーティ製のファイルをインポートする"><b>コンマ区切り(CSV)</b></a>、<a href="../../UserGuide/UserGuide/Importing_from_Excel.html" title="ユーザガイド：Excelからのインポート"><b>MS Excel</b></a>、<a href="../../UserGuide/UserGuide/Importing_Third_Party_Files.html" title="サードパーティ製のファイルをインポートする"><b>pCLAMP</b> (ABF, DAT)</a>、<a href="../../UserGuide/UserGuide/Importing_Third_Party_Files.html" title="サードパーティ製のファイルをインポートする"><b>音声</b> (WAV)</a>で部分インポートが可能です。</li>
<li><a href="../../UserGuide/UserGuide/Importing_Third_Party_Files.html" title="サードパーティ製のファイルをインポートする"><b>pCLAMP</b> (ABF, DAT)</a> および <a href="../../UserGuide/UserGuide/Importing_Third_Party_Files.html" title="サードパーティ製のファイルをインポートする"><b>音声</b> (WAV)</a>のインポートツールでは、pCLAMP と WAV ファイル独自の部分インポートコントロールがあります。詳細は、<a class="external text" href="../../XFunction/X-Function/Details_of_TreeNodes_in_Import_PClamp.html#trfiles">pCLAMPインポート</a>および<a class="external text" href="../../XFunction/X-Function/Details_of_TreeNodes_in_Import_WAV.html#partial">WAVインポート</a>を参照してください。</li>
<li><a href="../../UserGuide/UserGuide/Connecting_to_File.html#Excel" title="ユーザガイド: ファイルに接続"><b>CSV</b>または<b>Excel</b>コネクタ</a>（<b>データ：ファイルに接続</b>）でインポートする場合、部分インポートが可能です。CSVコネクタでは<b>列</b>と<b>行</b>の設定を使用できます（ASCIIインポートのように、<b>開始</b>、<b>終了</b>、<b>読み込み</b>、<b>スキップ</b>等はありません）。したがって、<b>列</b>と<b>行</b>ボックスについては、<b>部分インポート</b> &gt; <b>カスタム</b>で説明されている構文とサンプルに従って入力してください。</li>
<li>NetCDFおよびTDMS コネクタ（<b>データ：ファイルに接続</b>）も部分インポートをサポートしています。ただし、どちらも標準のGUIコントロールを使用していないため、下の個別のセクションで説明します。</li>
</ul>
<h3><a name="Partial_Import_Controls_used_by_Import_From_File" id="Partial_Import_Controls_used_by_Import_From_File"></a><span class="mw-headline">ファイルからインポートにおける部分インポートの設定</span></h3>
<p>Xファンクションルーチンである<b>ASCII</b>、<b>バイナリ</b>（インポートウィザード）、<b>CSV</b>、<b>MS Excel</b>のインポートダイアログの<b>部分インポート</b>の設定は以下のようなものです。</p>
<dl>
<dd>
<dl>
<dd><a class="image"><img alt="Partial Import.png" src="../images/Partial_Importing_and_Re_Importing/Partial_Import.png" width="584" border="0" /></a></dd>
</dl>
</dd>
</dl>
<table class="dialogcontroltable">
<tr>
<th><b>開始</b>と<b>終了</b></th>
<td>インポートを開始及び終了する列番号を指定します。</td>
</tr>
<tr>
<th><b>読み込み</b>と<b>スキップ</b></th>
<td><b>読み込み</b>に値<i>l</i>を指定し<b>スキップ</b>に値<i>k</i>を入力すると、 （<i>l</i>+<i>k</i>）列毎に<i>l</i> 列がインポートされ、<i>k</i> 列が読み飛ばされます。</td>
</tr>
<tr>
<th><b>カスタム</b></th>
<td>次のようにしてインポート文字列を作成します。
<dl>
<dd>
<ul>
<li>スペース( ) = "and"</li>
<li>コロン(:)は<b>開始</b>と<b>終了</b>を分離</li>
<li>バーティカルバー(|) = <i>n</i> 列/行読み込む</li>
<li>ダッシュ(-) = スキップ</li>
<li>チルダ(~) = 除外</li>
</ul>
</dd>
</dl>
<dl>
<dd><i><b><i><b>サンプル</b></i></b></i>
<dl>
<dd><b>1 3 7</b> は、列/行1、3、7をインポート</dd>
<dd><b>1:100 ~50:60</b> は、1から100列/行のうち50から60を除外してインポート</dd>
<dd><b>1:200|3-2</b> は、1から200列/行を3読み込み、2スキップしてインポート</dd>
<dd><b>1:1000 ~200:300 250:260</b>は、1から1000列/行のうち250から260以外の200から300をスキップしてインポート</dd>
<dd><b>1:100|3-7 5:100|2-8</b> は、1から100列/行のうち3読み込み、7スキップかつ、5から100列/行を2読み込み8スキップしてインポート。「and」(スペース)の組み合わせは、10列/行ごとに3読み込み、1スキップ、2読み込み、4スキップの繰り返しパターンを生成します。</dd>
</dl>
</dd>
</dl>
</td>
</tr>
</table>
<h3><a name="Partial_Import_by_NetCDF_Connector" id="Partial_Import_by_NetCDF_Connector"></a><span class="mw-headline">NetCDFコネクタの部分インポート</span></h3>
<p><a href="../../UserGuide/UserGuide/Connecting_to_File.html#NetCDF" title="ユーザガイド: ファイルに接続"><b>NetCDF</b>コネクタ</a>では、独自のGUIコントロールで部分インポートを指定できます。スクリプトを作成している場合は、GUIコントロールを使用して接続文字列を作成することで時間を節約できます（以下を参照）。</p>
<ol>
<li>GUIでデータをインポートするには、<b>データ：ファイルに接続：NetCDF</b>を選択します。<b>データコネクタブラウザ</b>が開きます。</li>
<li>つぎに、<a href="../../UserGuide/UserGuide/Connecting_to_File.html#NetCDF" title="ユーザガイド: ファイルに接続">多次元変数を選択</a>し、<b>インポートするデータの選択</b>をクリックして、変数を下部パネルに追加します。</li>
<li><b>インポートオプション</b>ボタンをクリックし、<b>開始</b>と<b>終了</b>、<b>時間軸のスキップ</b>または<b>平均化</b>のいずれかで部分インポートを指定し、OKをクリックしてオプションを閉じます。
<ul>
<li><b>開始</b> &amp; <b>終了</b>: インポートする日時範囲です。</li>
<li><b>時間軸のスキップ</b>: <i>m</i> レコードを読み取り、<i>n</i> レコードをスキップして繰り返します。たとえば、データが月次の場合、<b>読み取り</b>= <i>1</i> および<b>スキップ</b>= <i>11</i> は、日時範囲全体で「ひと月のデータを読み取り11か月分をスキップ」のパターンを繰り返します。</li>
<li><b>平均化</b>: <b>間隔</b>に基づいて平均を計算し、<b>年ごと</b>の<b>サンプリング</b>または<b>連続</b>のいずれかを実行します。たとえば、<b>年ごと</b>および<b>間隔</b> = <i>m</i>の場合、日時範囲の各月の総平均を計算します。</li>
</ul>
</li>
</ol>
<p>インポートオプションを設定してダイアログを閉じると、下部パネルの変数の横に接続文字列が表示されることに注意してください。この文字列は、ダブルクリックすることで編集可能です（コピーできるのでスクリプトを作成している場合は便利です）。</p>
<dl>
<dd>
<dl>
<dd><a class="image"><img alt="OH partial import connection string 1.png" src="../images/Partial_Importing_and_Re_Importing/OH_partial_import_connection_string_1.png" width="511" border="0" /></a></dd>
</dl>
</dd>
</dl>
<p>接続文字列の構文は複雑になる可能性がありますが、以下の基本的な形式に従います。</p>
<pre class="lt" style="font-family: monospace;">
NetCDF<span style="color: #000080;">/</span>variable<span style="color: #000000;">[</span>z<span style="color: #000000;">]</span><span style="color: #000000;">[</span>y<span style="color: #000000;">]</span><span style="color: #000000;">[</span>x<span style="color: #000000;">]</span>
</pre>
<p>ここで、variableはインポートする変数であり、z、y、xは、z、y、およびxディメンションデータの部分的なインポートを含む処理を指定します。</p>
<p>z次元データの部分インポートの指定は、上記の基本的な<b>カスタム</b>構文から始まります。しかし、GUIを使用して<b>インポートオプション</b>を設定し、ブラウザダイアログで接続文字列を読み取ったりコピーすることにより、最もよく理解できるNetCDFコネクタ固有の修飾子がいくつかあることに注意してください。</p>
<p>GUIを使用する場合は、接続文字列は重要ではありません。スクリプトを作成している場合は、GUIから接続文字列を取得したら、その<a class="external text" href="../../LabTalk/LabTalk/Wks.DC_(object).html#Examples">使用例</a>についてLabTalk <b>wks.dc</b>オブジェクトのドキュメントを参照してください。</p>
<h4><a name="Ultimate_partial-import_control_for_NetCDF" id="Ultimate_partial-import_control_for_NetCDF"></a><span class="mw-headline">NetCDFの部分インポート制御の原理</span></h4>
<p>部分インポートを高レベルに制御する必要があるGUIユーザまたはスクリプターの場合、<b>データコネクタブラウザ</b>で接続文字列をダブルクリックすると、接続文字列を手動で編集できます。構文については、上記の<b>カスタム</b>テーブルを参照してください。</p>
<p><br />
<i><b>Example 1</b></i><br />
たとえば、1948年1月から2018年6月までの月次測定値のデータセットがあるとします。1958年では、計測は信頼できなかったため、これらの12個の読み取り値のみ除外する必要がある場合を考えます。接続文字列は、121月から132月までの12か月を除外する必要があります。</p>
<pre class="lt" style="font-family: monospace;">
precip<span style="color: #000000;">[</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">0</span>~<span style="color: #0000dd;">121</span><span style="color: #000000;">:</span><span style="color: #0000dd;">132</span><span style="color: #000000;">]</span><span style="color: #000000;">[</span>y#<span style="color: #000000;">]</span><span style="color: #000000;">[</span>x<span style="color: #000000;">]</span>
precip<span style="color: #000000;">[</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">846</span>~<span style="color: #0000dd;">121</span><span style="color: #000000;">:</span><span style="color: #0000dd;">132</span><span style="color: #000000;">]</span><span style="color: #000000;">[</span>y#<span style="color: #000000;">]</span><span style="color: #000000;">[</span>x<span style="color: #000000;">]</span> <span style="color: #008000;">// FromおよびToの代替構文</span>
</pre>
<p><br />
<i><b>Example 2</b></i><br />
最初の120の行列について、行列1からインポートを開始し、11をスキップし、1つの行列をインポートし、また11をスキップする、という設定をします。行列121からは、2つインポートし、10個の行列をスキップ、を繰り返して241まで到達します。行列241から最後の行列（「0」で表現）までは、3つの行列をインポートして9個スキップ、を繰り返します。この例は簡単なものですが、必要に応じて、より複雑な接続文字列を作成できます。</p>
<pre class="lt" style="font-family: monospace;">
precip<span style="color: #000000;">[</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">120</span><span style="color: #000080;">|</span><span style="color: #0000dd;">1</span><span style="color: #000080;">-</span><span style="color: #0000dd;">11</span> <span style="color: #0000dd;">121</span><span style="color: #000000;">:</span><span style="color: #0000dd;">240</span><span style="color: #000080;">|</span><span style="color: #0000dd;">2</span><span style="color: #000080;">-</span><span style="color: #0000dd;">10</span> <span style="color: #0000dd;">241</span><span style="color: #000000;">:</span><span style="color: #0000dd;">0</span><span style="color: #000080;">|</span><span style="color: #0000dd;">3</span><span style="color: #000080;">-</span><span style="color: #0000dd;">9</span><span style="color: #000000;">]</span><span style="color: #000000;">[</span>y#<span style="color: #000000;">]</span><span style="color: #000000;">[</span>x<span style="color: #000000;">]</span>
</pre>
<h3><a name="Partial_Import_by_TDMS_Connector" id="Partial_Import_by_TDMS_Connector"></a><span class="mw-headline">TDMSコネクタの部分インポート</span></h3>
<p><b>TDMSコネクタ</b>を使用してTDMSファイルの部分インポートを指定する場合、上記で説明した、NetCDFファイルでの内容と同様の操作で行えます。</p>
<ol>
<li>ワークブックをアクティブにして、<b>データ:ファイルに接続:TDMS</b>を選択します。</li>
<li>ファイルを参照して、<b>開く</b>をクリックします。</li>
<li>データコネクタブラウザで、ノードをクリックして、ダイアログ下部の<b>インポートするデータを選択</b>をクリックします。</li>
<li>部分インポートを実行するには、上の表の接続文字列をダブルクリックして<b>カスタム</b>の項目にある構文を使って範囲を指定することで文字列を修正します。文字列の<i>最後</i>で部分範囲を指定する必要があることに注意してください（例：<i>TDMS/Dynamic Data Type (time domain, absolute)/Square with Uniform Noise[10:90]</i>）。</li>
</ol>
<dl>
<dd><a class="image"><img alt="OH partial import connection string 2.png" src="../images/Partial_Importing_and_Re_Importing/OH_partial_import_connection_string_2.png" width="761" border="0" /></a></dd>
</dl>
<h2><a name="Re-Import" id="Re-Import"></a><span class="mw-headline">再インポート</span></h2>
<p><a class="external text" href="../../GettingStarted/OriginLab/Import_Data.html#Re-Importing_Data_Files"><b>再インポート</b></a>は、その名前の通り、以前インポートしたファイルを再度インポートするものです。 これはインポートファイルが更新されたとき（オプションを変更せずに直接インポートするとき）、または異なるインポートオプションを使用するときに、この機能を使用することをお勧めします。 <b>データ</b>メニューにあるメニューコマンドから実行できます。 再インポートの機能は、<b>ASCIIファイル</b>と<a href="../../UserGuide/UserGuide/Importing_Third_Party_Files.html" title="サードパーティ製のファイルをインポートする"><b>サードパーティ製</b>ファイルの一部</a>で使用できます。</p>
<p><a href="../../UserGuide/UserGuide/Connecting_to_File.html" title="ユーザガイド: ファイルに接続"><b>データコネクタ</b></a>を使用してインポートしている場合は、必要に応じてデータをリフレッシュできます。インポート時、またはセッション中のいつでも、コネクタアイコンをクリックして<b>インポート</b>を選択するか、プロジェクト内のグラフウィンドウ上にあるダウンロードアイコンをクリックします。詳細は、<a class="external text" href="../../QuickHelp/QuickHelp/Connector_Open_Project_Data_Missing.html">FAQ-1080 データコネクタを使用してデータをインポートしましたが、プロジェクトを再度開くと、データが失われます</a>を参照してください。</p>
