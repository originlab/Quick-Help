<h1 class="firstheading">Originのプログラミング</h1><p class='urlname' style='display: none'>Originのプログラミング</p>
<p><br />
</p>
<dl><dd><a  class="image"><img alt="Programming image connectivity.png" src="../images/Programming_in_Origin/Programming_image_connectivity.png" width="637"  /></a></dd></dl>
<p>Originの使用が広範囲になると、プログラミングによって既存機能にアクセスしたり、自分で作成したルーティンやツールを追加したり、他のアプリケーションと連携したり、といった要望があるかもしれません。この章ではOriginのプログラミング機能で実現可能なオプションの概要を説明しています。詳細な情報については、Originのプログラミングに関連するリソースを確認してください。
</p>
<ul><li> プログラミングのガイドや言語リファレンス、サンプルコードなどのドキュメントはOrigin製品の<b><b>ヘルプ</b></b>メニューから利用可能です。 </li>
<li> オンラインでプログラミングドキュメントが利用できます（<b>www.originlab.com/doc</b>）。 </li>
<li> 以下のようなキーワードをインターネットブラウザで検索すれば、該当するオンラインドキュメントを表示可能です：<b><b>labtalk importing</b></b><b>、<b>originc interpolate</b>、<b>labview origin send data</b></b></li>
<li> Originのプログラミングフォーラム（<b>www.originlab.com/forum</b>）</li>
<li> LabTalk、Python、COM サーバとクライアントなどのサンプルファイルをOriginのサンプルフォルダで確認できます。</li></ul>
<p><span class="OIndex" style="display:none">Originのプログラミング</span>
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#LabTalk"><span class="tocnumber">1</span> <span class="toctext">LabTalk</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Python"><span class="tocnumber">2</span> <span class="toctext">Python</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#R"><span class="tocnumber">3</span> <span class="toctext">R</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#MATLAB"><span class="tocnumber">4</span> <span class="toctext">MATLAB</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Origin_C"><span class="tocnumber">5</span> <span class="toctext">Origin C</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#X-Function"><span class="tocnumber">6</span> <span class="toctext">Xファンクション</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Automation_Server"><span class="tocnumber">7</span> <span class="toctext">オートメーションサーバ</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#LabVIEW"><span class="tocnumber">8</span> <span class="toctext">LabVIEW</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Orglab"><span class="tocnumber">9</span> <span class="toctext">Orglab</span></a></li>
</ul>
</div>

<h2><a name="LabTalk"></a><span class="mw-headline">LabTalk</span></h2>
<p><span class="OIndex" style="display:none">Programming Origin, LabTalk</span>
<span class="OIndex" style="display:none">LabTalk</span>
<span class="OIndex" style="display:none">Scripting</span>
</p><p><b>LabTalk</b>は、Originのほとんどの機能にアクセスできるスクリプト言語です。LabTalkではワークシート列、グラフレイヤ、データプロットなどのOriginオブジェクトのプロパティを読み取ったり、変更することができます。LabTalkスクリプトは、高度なデータ分析処理を実行するXファンクションを呼び出すこともできます。
</p><p>LabTalkスクリプトの実行には、多くのオプションが用意されています。複数行のスクリプトはファイル内のセクションとすることができ、これらの独立したセクションは、<b><b>スクリプトウィンドウ</b></b>や<b><b>コマンドウィンドウ</b></b>のコマンドプロンプトにあるユーザインターフェース、あるいは、ワークシートやグラフに追加したボタン、ユーザが作成したツールバーボタン、カスタムメニューコマンドから実行できます。 
</p>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Programming_in_Origin/Tutorial_icon.png" width="57"  border="0" />
	</td>
	<td><p>以下のミニチュートリアルでは、ワークシートにボタンオブジェクトを追加し、このボタンに、基本的な統計処理を実行して結果をワークシートに出力するLabTalkスクリプトを組み込んで実行する方法を示します。
</p>
<ol>
<li>Originを起動し、<b><b>標準</b></b>ツールバーの<b>新規プロジェクト</b>ボタン<a  class="image"><img alt="Button New Project.png" src="../images/Programming_in_Origin/Button_New_Project.png" width="22"  /></a>をクリックして、新しいプロジェクトを作成します。</li>
<li>メニューから<b>データ：ファイルからインポート：<b>単一ASCIIファイル</b></b>を選択し、\Samples\Graphing\Box Chart.dat ファイルを選択します。ファイルを選択し、<b>開く</b>をクリックします。アクティブワークシートウィンドウにファイルがインポートされます。 </li>
<li>ワークシートウィンドウをアクティブにして、メインメニューから<b>フォーマット： ワークシートの表示属性</b>を選択します。<b><b>ワークシートプロパティ</b></b>ダイアログで、<b>サイズ</b>タブを開き、<b><b>上からのギャップ</b></b>の項目を<i><i>25</i></i> にして<b><b>OK</b></b>をクリックします。これで、ワークシートウィンドウの上部に何もない領域が追加されました。</li>
<li><b><b>プロット操作・オブジェクト作成</b></b>ツールバー上の<b>テキストツール</b>ボタンをクリックします。追加した上部の何もない領域でクリックして、テキストオブジェクトに &quot;Add Mean Label Row&quot; と入力します。入力したらテキストオブジェクトの外側をクリックして編集モードを終了します。</li>
<li>テキストラベル上で右クリックして<b>プロパティ</b>を選択します。<b>プログラミング</b>タブを開き、<b>のあとでスクリプトを実行</b>を<b>ボタンアップ</b>にします。以下のスクリプトをコピーして、テキストボックスに貼り付けます。</li>
<pre class="lt" style="font-family:monospace;">wks.<span style="color: #000080;">userParam1</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
wks.<span style="color: #000080;">userParam1</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Mean&quot;</span>;
for <span style="color: #000000;">(</span>int ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>; ii <span style="color: #000080;">&lt;=</span> wks.<span style="color: #000080;">ncols</span>; ii<span style="color: #000080;">++</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
	range rr <span style="color: #000080;">=</span> <span style="color: #000080;">$</span><span style="color: #000000;">(</span>ii<span style="color: #000000;">)</span>;
	Col<span style="color: #000000;">(</span><span style="color: #000080;">$</span><span style="color: #000000;">(</span>ii<span style="color: #000000;">)</span><span style="color: #000000;">)</span><span style="color: #000000;">[</span>D1<span style="color: #000000;">]</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">$</span><span style="color: #000000;">(</span>mean<span style="color: #000000;">(</span>rr<span style="color: #000000;">)</span>,.2<span style="color: #000080;">*</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span></pre>
<li><b>OK</b> をクリックして設定を適用し、<b>テキストオブジェクト</b>ダイアログを閉じます。テキストオブジェクトの見た目がボタンのようになりました。</li>
<li>ボタンをクリックします。ワークシートに &quot;Mean&quot; というラベルの新しい行が追加され、各列のデータの平均がこのセルに入力されます。</li>
</ol>
</td></tr></table>
<table class="note">

<tr>
<td>
<p><b>Note:</b> Originの組み込みスクリプト言語であるLabTalkについての詳細は、<a class="external text" href="../../LabTalk/Category/LT_Guide.html"><b>ヘルプ: プログラミング: LabTalk</b></a>のドキュメントを参照してください。
</p><p>サンプルファイルは、Originのインストールフォルダの \Samples\LabTalk Script Examples フォルダにあります。
</p>
</td></tr></table>
<h2><a name="Python"></a><span class="mw-headline">Python</span></h2>
<p><span class="OIndex" style="display:none">Originのプログラミング、Python</span><span class="OIndex" style="display:none">PyOriginモジュール</span><span class="OIndex" style="display:none">Python</span>
</p><p>Origin内でPythonを実行するために、埋め込みPython環境を提供しています。Originは、<b>Pythonコンソール</b>またはOriginの<b>コードビルダー</b>IDEからのPythonコードのコマンドラインの実行をサポートしています。2022年12月の時点で、組み込みPythonのバージョンは<a class="external text" href="https://www.python.org/downloads/" target="_blank">バージョン3.11</a>です。
</p>
<table class="note">

<tr>
<td>
<p><b>Note:</b> Originの組み込みPython使用法については、次のPythonトピックを参照してください。
</p>
<ul><li> <a class="external text" href="../../Python/Category/Python_(Python).html"><b>はじめに（Python）</b></a></li>
<li> <a class="external text" href="../../Python/Python/RunPython_(Python).html"><b>組み込みPython</b></a></li>
<li> <a class="external text" href="../../Python/Python/Sample_Projects_with_Attached_Python_Codes.html"><b>Pythonコードが添付されたサンプルプロジェクト</b></a></li></ul>
</td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Programming_in_Origin/Tip_icon.png" width="57"  border="0" /></td><td><ul><li>PythonからOriginを呼び出すAPIがあります。詳細は次の <b>オートメーションサーバー</b> ご覧ください。</li>
<li>パッケージバージョンの競合を防ぐために、Origin は複数の PyPackage フォルダをサポートしています (システム変数<b>@PYP</b>を設定します)。</li></ul>
</td></tr></table>
<h2><a name="R"></a><span class="mw-headline">R</span></h2>
<p><span class="OIndex" style="display:none">Programming Origin, R</span><span class="OIndex" style="display:none">R</span> Originの環境内でのRコマンドの実行をサポートしています。スクリプトウィンドウで、あるいは、組み込みのRコンソールから、Rコマンドを実行することができます。Rのすべてのリリースは、バージョン<b>3.6</b>までサポートされています。
</p><p>Originからは、2つの方法でRに接続することができます。 
</p>
<ul><li><a class="external text" href="../../UserGuide/UserGuide/R_Console.html"><b>R</b></a>。ローカルコンピューターにインストール </li>
<li><a class="external text" href="../../UserGuide/UserGuide/R_Server.html"><b>Rserve</b></a>.リモートPCにインストール</li></ul>
<table class="note">

<tr>
<td>
<p><b>Note:</b> OriginとRの連携に関する詳細な情報は、Originヘルプファイル（<a class="external text" href="../../UserGuide/UserGuide/R_Console.html"><b>Rコンソール</b></a>と<a class="external text" href="../../UserGuide/UserGuide/R_Server.html"><b>Rserve</b></a>）およびLabTalk スクリプトガイド（<a class="external text" href="../../LabTalk/Category/LT_Running_R_in_Origin.html"><b>OriginでのRの実行</b></a>、<a class="external text" href="../../LabTalk/LabTalk/R_(object).html"><b>Rオブジェクト</b></a>、<a class="external text" href="../../LabTalk/LabTalk/Rserve_(object).html"><b>Rserveオブジェクト</b></a>）をご参照ください。
</p><p>サンプルファイルは、Originのインストールフォルダの \Samples\R フォルダにあります。
</p>
</td></tr></table>
<h2><a name="MATLAB"></a><span class="mw-headline">MATLAB</span></h2>
<p>MATLABコンソールツールは、OriginユーザがOriginからMATLABコマンドを実行し、グラフィカルインターフェースまたはコマンド行を使って2つのアプリケーション間でデータを変換します。
</p>
<ul><li> このコンソールは、1台のコンピュータにOriginとMATLABの両方がインストールされている必要があります。 </li>
<li> Originは、ディスクからMATLAB (MAT) ファイルをインポートすることもできます。以前からの機能である<a class="external text" href="../../UserGuide/UserGuide/Importing_Third_Party_Files.html"><b>データ：ファイルからインポート</b></a>と、新しいコネクタベースの<a class="external text" href="../../UserGuide/UserGuide/Connecting_to_File.html#JSON.5CMATLAB_file"><b>データ：ファイルに接続：MATLAB</b></a>の2つのインポートルーチンがあります。MATファイルのインポートの場合、MATLABがインストールされている必要は<i>ありません</i>。</li></ul>
<table class="note">

<tr>
<td>
<p><b>Note:</b> MATLABコンソールについては詳細は、Originヘルプファイル(<a class="external text" href="../../UserGuide/Category/MATLAB_console.html"><b>MATLAB コンソール</b></a>を参照してください。
</p><p>MATLAB クライアントからOrigin COMサーバに接続する方法を説明するサンプル(CreatePlotInOrigin.m, CreatePlotInOrigin.OPJ) は、&lt;<i>Origin プログラムフォルダ</i>&gt;\Samples\COM Server and Client\MATLAB サブフォルダにあります(MATLABが必要)。
</p>
</td></tr></table>
<h2><a name="Origin_C"></a><span class="mw-headline">Origin C</span></h2>
<p><span class="OIndex" style="display:none">プログラミング, Origin C</span><span class="OIndex" style="display:none">NAG数値ライブラリ</span><b><b>Origin C</b></b>は、ANSI Cプログラミング言語のシンタックスに基づく高度なプログラミング言語です。また、Origin Cは、多くのC++の機能やC#の一部の機能をサポートしています。Origin Cは、データインポート、データ操作、グラフ作成/編集、分析、エクスポートといったOriginの機能に対してプログラミングすることができます。Origin C 関数は、ボタン、ツールバー、メニューといったユーザインターフェースやXファンクションベースのダイアログから利用できます。
</p><p>Origin Cのコードは、さまざまなOriginのオブジェクトを含む引数の受け渡しをサポートする関数として作成します。Origin C関数は、オブジェクトコードにコンパイルされ、Originの内部でロードされて実行します。Origin Cはより高い信頼性と管理能力があり、より広範囲で複雑なコードを開発したりデバッグすることができます。
</p><p>また、Origin Cから<b><b>NAG数値ライブラリ</b></b>関数を呼び出すことが可能です。NAG関数は簡単な統計とフーリエ変換などから、線形代数や多変量解析に至るまで、幅広い計算アルゴリズムを提供しています。Originは現在、NAGライブラリバージョン<b>Mark 26.1</b>をサポートしています。
</p>
<table class="note">

<tr>
<td>
<p><b>Note:</b> Origin Cについての詳細は、プログラミングヘルプファイルを参照してください。 
</p><p><b>ヘルプ: プログラミング: <a class="external text" href="../../OriginC/Category/Origin_C_Programming_Guide.html">Origin C</a></b>
</p><p>このドキュメントには、使用方法や言語リファレンス、開発者への注意、サンプルなどが用意されています。
</p><p>サンプルファイルは、Originのインストールフォルダの \Samples\Origin C Examples フォルダにあります。
</p>
</td></tr></table>
<h2><a name="X-Function"></a><span class="mw-headline">Xファンクション</span></h2>
<p><span class="OIndex" style="display:none">Xファンクション</span><span class="OIndex" style="display:none">Originのプログラミング, Xファンクション</span> Xファンクションとは、特別なタイプのグローバル関数としてOriginにロードされるXMLファイルです。また、Origin CはXファンクションを作成する際に使用する事ができます。Xファンクションは、カスタムデータ処理機能を追加して、Originに機能の拡張を提供します。既存のOriginツールのほとんどがXファンクションをベースにしています。Xファンクションを作成すると、スクリプトウィンドウはもちろん、ツールバーのボタンやカスタムメニューなどのインターフェースからアクセスして実行できます。
</p>
<table class="note">

<tr>
<td>
<p><b>Note:</b> Xファンクションについての詳細情報は、次のプログラミングヘルプファイルを参照してください。 
</p><p><b>ヘルプ: プログラミング: <a class="external text" href="../../XFunction/Category/X-Function_Programming_Guide.html">Xファンクション</a></b>
</p><p>このドキュメントには、Xファンクションの作成と使用、言語リファレンス、チュートリアルが用意されています。
</p>
</td></tr></table>
<h2><a name="Automation_Server"></a><span class="mw-headline">オートメーションサーバ</span></h2>
<p><span class="OIndex" style="display:none">オートメーションサーバ, Origin</span><span class="OIndex" style="display:none">Visual Basic/Visual C/C#</span> <span class="OIndex" style="display:none">Excel</span> Originは、<b>オートメーションサーバ</b>としてご利用可能です。クライアントのアプリケーション、例えばNational Instruments™<b> <b>LabVIEW™</b></b>、Microsoft <b><b><b>Excel</b></b></b>、<b>Python</b>、自作のVB/VC/C#アプリケーションはOriginとデータをやり取りしたり、Originで実行できるコマンドを送信できます。

株式会社ライトストーンでは、データ処理の自動化やシステムの一部としてOriginを利用するといったカスタマイズ作業を承っております。お気軽にお問い合わせください。
</p>
<table class="note">

<tr>
<td>
<p><b>Note: </b>Originのオートメーションサーバ機能に関する詳細情報は、次のプログラミングヘルプファイルを参照してください。 
</p><p><b>ヘルプ: プログラミング: <a class="external text" href="AutomationServer.chm::/Category/COM_Server.html">オートメーションサーバ</a></b>. 
</p><p>このドキュメントでは、サンプルや言語リファレンスの情報が用意されています。
また、サンプルファイルは、Originのインストールフォルダの \Samples\COM Server and Cliant フォルダにあります。
</p>
</td></tr></table>
<h2><a name="LabVIEW"></a><span class="mw-headline">LabVIEW</span></h2>
<p><span class="OIndex">National Instruments™ LabVIEW™</span>は、データ収集に幅広く使用されているソフトウェアです。例えば、多くの計測機器やセンサーのベンダーがデータ取得のため、<span class="OIndex">LabVIEW</span><span class="OIndex HasShownIndex" style="display:none">LabVIEW™</span>ドライバを提供しています。データ収集後、エンドユーザはグラフ作成や解析を行い、プレゼンテーション用のレポートを作成します。Originは、複数データによる繰り返し解析が可能な分析テンプレート機能を含む、強力なデータ解析機能とグラフ作成ツールを提供します。LabVIEWとOriginを連携して使用することで、取り込んだデータの解析と、表現の効率を大幅に向上させることができます。
</p><p>OriginにはLabVIEWのサブVIが標準で組み込まれています。LabVIEWユーザは、LabVIEWアプリケーションで、このカスタムサブVIを用いるだけでOriginとのシームレスな連携が可能です。 
</p>
<table class="note">

<tr>
<td>
<p><b>Note:</b> OriginとLabVIEWの連携関する詳細情報は、次のヘルプドキュメントを確認してください。 
</p><p><b>ヘルプ: <a class="external text" href="CustomVIsForLabVIEW.chm::/Category/LabVIEW_VI.html">LabVIEW VI</a></b>
</p><p>サンプルとチュートリアルを利用できます。 
</p>
</td></tr></table>
<p><br />
</p>
<h2><a name="Orglab"></a><span class="mw-headline">Orglab</span></h2>
<p><span class="OIndex">Orglab</span>は、Originプロジェクト (.opj) やその他のデータファイル (.ogg, .ogw and .ogm) のダイレクトな作成や読み込みのための、配布可能なDLLコンポーネントです。無料でダウンロードして利用可能です。Orglab使用の際には、Originのライセンスは必要ありません。一般に、OrgLabを計測機器で使用することで、サードパーティベンダーがフロントエンドのソフトウェアでOriginファイルの出力を可能にします。
</p>
<table class="note">

<tr>
<td>
<p>Orglabモジュールは64bitシステムで利用できます。Orglab についての情報とモジュールのダウンロードについては、OriginLab社のWebサイト<b>www.originlab.com</b>の <b>Products &gt; <a class="external text" href="http://originlab.com/index.aspx?go=Products/Orglab" target="_blank">Orglab</a></b>をご覧ください。
</p>
</td></tr></table>



    