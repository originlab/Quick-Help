<h1 class="firstheading">繰り返し処理の方法</h1><p class='urlname' style='display: none'>Automate-Repetitive-tasks</p>
<p><span class="OIndex" style="display:none">Originの自動化</span>
<span class="OIndex" style="display:none">バッチ処理</span>
</p><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Analysis_Report_Sheets"><span class="tocnumber">1</span> <span class="toctext">解析レポートシートの作成</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Recalculation"><span class="tocnumber">2</span> <span class="toctext">再計算</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Dialog_Themes"><span class="tocnumber">3</span> <span class="toctext">ダイアログテーマ</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Workbook_and_Project_Templates"><span class="tocnumber">4</span> <span class="toctext">プロジェクト/ワークブックテンプレート</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="#The_Workbook_as_Template"><span class="tocnumber">4.1</span> <span class="toctext">ワークブックをテンプレートとする</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#The_Project_as_Template"><span class="tocnumber">4.2</span> <span class="toctext">プロジェクトをテンプレートとする</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-7"><a href="#Batch_Plotting"><span class="tocnumber">5</span> <span class="toctext">バッチ作図</span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="#Duplicating_Graphs_with_Data_from_Other_Books.2FSheets.2FColumns"><span class="tocnumber">5.1</span> <span class="toctext">他のブック/シート/列データを使用してグラフを複製</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#The_Workbook_as_a_Template_for_Processing_Multiple_Files"><span class="tocnumber">5.2</span> <span class="toctext">ワークブックをテンプレートとして複数ファイルを処理</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-10"><a href="#Batch_Analysis"><span class="tocnumber">6</span> <span class="toctext">バッチ分析</span></a>
<ul>
<li class="toclevel-2 tocsection-11"><a href="#Analyzing_Multiple_Datasets_in_Dialogs"><span class="tocnumber">6.1</span> <span class="toctext">ダイアログで複数データセットを分析</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Using_Gadgets_for_Analyzing_Multiple_Curves"><span class="tocnumber">6.2</span> <span class="toctext">ガジェットを使用した複数曲線の分析</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#Batch_Analysis_Using_an_Analysis_Template"><span class="tocnumber">6.3</span> <span class="toctext">分析テンプレートを使用したバッチ処理</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-14"><a href="#Repeating_Analysis_on_Other_Datasets_or_Data_Plots"><span class="tocnumber">7</span> <span class="toctext">他のデータセットやプロットを繰り返し分析</span></a></li>
<li class="toclevel-1 tocsection-15"><a href="#Duplicate_this_Operation"><span class="tocnumber">8</span> <span class="toctext">操作の複製</span></a></li>
<li class="toclevel-1 tocsection-16"><a href="#Repeating_Analysis_Using_Data_Filters"><span class="tocnumber">9</span> <span class="toctext">データフィルタを使用した繰り返し分析</span></a></li>
<li class="toclevel-1 tocsection-17"><a href="#Automating_Tasks_Using_Programming"><span class="tocnumber">10</span> <span class="toctext">プログラミングによる自動化</span></a></li>
<li class="toclevel-1 tocsection-18"><a href="#Topics_for_Further_Reading"><span class="tocnumber">11</span> <span class="toctext">詳細情報</span></a></li>
</ul>
</div>
<h2><a name="Analysis_Report_Sheets"></a><span class="mw-headline">解析レポートシートの作成</span></h2>
<dl><dd><a  class="image"><img alt="UG Analysis Report Sheet.png" src="../images/How_to_Handle_Repetitive_Tasks/UG_Analysis_Report_Sheet.png" width="800"  /></a></dd></dl>
<p><a href="../../GettingStarted/OriginLab/Data_Analysis.html" title="OriginLab:データ分析">解析</a>の章または<a href="../../GettingStarted/OriginLab/Statistics.html" title="OriginLab:統計">統計</a>の章にリストされているツールで実行されるような分析操作は、詳細な<b>解析レポートシート</b>を作成します。  
</p>
<ul><li> 解析レポートシートは、ツリー構造でまとめられたテーブルを含みます。  </li>
<li> 各ブランチを開いたり、閉じたりして、各テーブルを表示、非表示することができます。  </li>
<li> このテーブルは、静的なレポートではありません。これらは、特定の分析結果にリンクされたプレースホルダーを使用して構築されるため、入力データや分析の設定を変更して結果を<a href="../../GettingStarted/OriginLab/How_to_Handle_Repetitive_Tasks.html#Recalculation" title="OriginLab:繰り返し処理の方法">再計算</a>できます。</li>
<li> シートにコメントを追加したり、テーブルをコピーして、プロジェクト内の他のウィンドウに貼り付けたり、リンクを貼り付けたりできます。</li>
<li> 解析レポートシートは、多くの場合、フィット曲線や残差プロットといった埋め込みグラフを含みます。これらのグラフを編集するには、ダブルクリックします。すると、埋め込みグラフが個別のグラフウィンドウとして開き、ミニツールバーや作図の詳細を使用して編集可能です。編集後、閉じるボタン<a  class="image"><img alt="Button close embedded.png" src="../images/How_to_Handle_Repetitive_Tasks/Button_close_embedded.png" width="32"  /></a>をクリックすると、レポートシートに再度グラフを挿入できます。</li></ul>
<p><b>解析レポートシート</b>の詳細は、<a class="external text" href="../../UserGuide/UserGuide/Analysis_Report_Sheets_and_Columns.html">Originヘルプファイル</a>をご覧ください。
</p>
<h2><a name="Recalculation"></a><span class="mw-headline">再計算</span></h2>
<p><span class="OIndex" style="display:none">結果の再計算</span>Originにある、全ての分析、および、ほとんどのデータ処理ダイアログボックスには、<b>再計算</b> <b><span class="OIndex" style="display:none">再計算</span></b>コントロールがあります。このコントロールを使用すると、出力操作をソースデータに結び付けることができます。再計算を<b>自動</b>または<b>手動</b>に設定すると、ソースデータの変更による更新が準備されます（<b>手動</b>の場合は保留中）これにより、ひと続きのデータをインポートし、既存データと置き換えるといった方法で、複数データセットの分析を実行できます。また、再計算機能は、<b>分析テンプレート</b>を作成する際のベースになります。分析テンプレートについては、下のセクションで説明します。
<span class="OIndex" style="display:none">自動再計算</span> <span class="OIndex" style="display:none">手動再計算</span> <span class="OIndex" style="display:none">ロック, 再計算</span>
<br /> 
</p>
<dl><dd><a  class="image"><img alt="LR dialog recalc 1.png" src="../images/How_to_Handle_Repetitive_Tasks/LR_dialog_recalc_1.png" width="517"  /></a></dd></dl>
<p><br />
<b>再計算</b> の制御は3モードあります：
</p>
<table class="simple">
<tr>
<th> なし
</th>
<td>
<ul><li> 出力結果には錠前アイコンが表示されません。 </li>
<li> 入力データが変更されても、出力結果は更新されません。</li></ul>
</td></tr>
<tr>
<th> 自動
</th>
<td>
<ul><li> 出力結果を含む列やグラフに、<b><b>自動</b></b>の錠前アイコン<a  class="image"><img alt="Operation lock auto.png" src="../images/How_to_Handle_Repetitive_Tasks/Operation_lock_auto.png" width="14"  /></a>が表示されます。メイン操作の錠前アイコンは、最も左の列に表示されます<a  class="image"><img alt="Operation lock auto.png" src="../images/How_to_Handle_Repetitive_Tasks/Operation_lock_auto.png" width="14"  /></a>。メイン操作の右側にある関連する操作の列には、「+」アイコン<a  class="image"><img alt="Operation lock auto related.png" src="../images/How_to_Handle_Repetitive_Tasks/Operation_lock_auto_related.png" width="11"  /></a>が表示されます。</li>
<li> 入力データが変更されると、出力結果が自動的に更新されます。</li>
<li> 錠前アイコンをクリックしてダイアログを開き<b>再計算</b>モードを変更するなど、分析設定を変更することもできます。</li></ul>
</td></tr>
<tr>
<th> 手動
</th>
<td>
<ul><li> 結果列や、出力結果を含むグラフに、<b><b>手動</b></b>の緑色の錠前アイコン<a  class="image"><img alt="Operation lock manual.png" src="../images/How_to_Handle_Repetitive_Tasks/Operation_lock_manual.png" width="13"  /></a>が表示されます。メイン操作の右側にある関連する操作の列には、「+」アイコン<a  class="image"><img alt="Operation lock auto related.png" src="../images/How_to_Handle_Repetitive_Tasks/Operation_lock_auto_related.png" width="11"  /></a>が表示されます。</li>
<li> 黄色いロック<a  class="image"><img alt="Operation lock manual pending.png" src="../images/How_to_Handle_Repetitive_Tasks/Operation_lock_manual_pending.png" width="14"  /></a>は、入力データが変更されたが、再計算操作が保留中であることを示します。黄色いロックをクリックし、ショートカットメニューから<b>再計算</b>を選択すると、更新を個別にトリガすることができます。 標準ツールバーの黄色の<b>再計算</b>ボタン<a  class="image"><img alt="Button Recalculate Manual.png" src="../images/How_to_Handle_Repetitive_Tasks/Button_Recalculate_Manual.png" width="22"  /></a> をクリックして、保留中の操作をすべて更新することもできます。</li>
<li> 錠前アイコンをクリックしてダイアログを開き<b>再計算</b>モードを変更するなど、分析設定を変更することもできます。</li></ul>
</td></tr></table>
<p><br />
<i><b>再計算操作の管理のヒント</b></i>
</p>
<ul><li> 錠前アイコン上でクリックするとメニューが表示され、パラメータの変更、ソースデータ開く、結果シートへの切り替え、再計算モードの変更などのオプションを利用できます。</li>
<li> <b><b>再計算</b></b>ボタンが<b><b>標準</b></b>ツールバーにあります。全てのプロジェクト操作が行われている場合は緑色<a  class="image"><img alt="Button Recalculate Auto.png" src="../images/How_to_Handle_Repetitive_Tasks/Button_Recalculate_Auto.png" width="22"  /></a>、保留中の再計算操作がある場合は黄色<a  class="image"><img alt="Button Recalculate Manual.png" src="../images/How_to_Handle_Repetitive_Tasks/Button_Recalculate_Manual.png" width="22"  /></a>で表示されます。プロジェクトを開いて、再計算ボタンが黄色の場合は、計算が保留中であり、プロジェクトに表示されているデータとデータのプロットが最新でない可能性があることがわかります。</li>
<li> 錠のアイコンが灰色のとき<a  class="image"><img alt="Gray lock pro only.png" src="../images/How_to_Handle_Repetitive_Tasks/Gray_lock_pro_only.png" width="15"  /></a>、この操作は<a class="external text" href="https://www.originlab.com/index.aspx?go=Products/Origin" target="_blank">OriginPro</a>のみで有効であり、現在のウィンドウまたはプロジェクトは通常版Originで開かれていることを示しています。この操作は通常版Originではサポートされていませんので、解析の再計算を行う場合はOriginProライセンスのあるコンピュータをご利用ください。</li>
<li> 錠前アイコンが赤く表示された場合は何かが発生し、再計算操作が不可能になります。このような条件はまれですが、たとえば、ユーザー定義のカーブフィッティング操作を含むプロジェクトファイルを同僚に渡したけれども、ユーザー定義のフィッティング関数に合致しなかった場合などに発生します。</li>
<li> プロジェクトファイルに再計算操作を多数含めると、作業が遅くなる可能性があります。錠前アイコンをクリックしてポップアップメニューから<b>再計算をブロック</b>を選択すると、再計算を<b>手動</b>でも<b>自動</b>でも再計算をブロックできます。保留中の再計算にブロックを配置すると、チェーン内の関連する各操作に黄色の<b>ブロック</b>アイコン<a  class="image"><img alt="Button block recalculation manual.png" src="../images/How_to_Handle_Repetitive_Tasks/Button_block_recalculation_manual.png" width="15"  /></a>が表示されます。更新済の再計算にブロックを配置すると、チェーン内の関連する各操作に緑色の<b>ブロック</b>アイコン<a  class="image"><img alt="Button block recalculation auto.png" src="../images/How_to_Handle_Repetitive_Tasks/Button_block_recalculation_auto.png" width="15"  /></a>が表示されます。ブロックを削除するには、<b>ブロック</b>アイコンをクリックしてチェックマークをクリアします（標準ツールバーの黄色の<b>再計算</b>ボタン<a  class="image"><img alt="Button Recalculate Manual.png" src="../images/How_to_Handle_Repetitive_Tasks/Button_Recalculate_Manual.png" width="22"  /></a>をクリックすると、ブロックされた操作は更新されません）。</li>
<li> すべての再計算を一時停止するには、<b>Ctrl+0</b>を押すか、<b>解析：自動再計算を一時停止</b>（ワークシートのみ）を選択するか、標準ツールバーの<b>自動再計算を一時停止</b>ボタン<a  class="image"><img alt="Button pause recalculation.png" src="../images/How_to_Handle_Repetitive_Tasks/Button_pause_recalculation.png" width="25"  /></a>をクリックします。</li>
<li> グラフをクリックし、メインメニューから<b>表示：表示様式</b>を選択したあと、<b>錠前アイコン</b>の横にあるチェックマークをクリアすることで、グラフウィンドウの錠前アイコンを非表示にすることができます。これにより、関連する操作はグラフウィンドウから削除され<i>ません</i>。アイコンを再表示するには、再度上記の操作をします。</li></ul>
<h2><a name="Dialog_Themes"></a><span class="mw-headline">ダイアログテーマ</span></h2>
<p><span class="OIndex" style="display:none">ダイアログボックステーマ</span> <span class="OIndex" style="display:none">テーマ, ダイアログボックス</span> 分析ダイアログや、データ操作のダイアログのほとんどは、設定内容を<b>ダイアログテーマ</b>ファイルとして保存できます。一度保存すれば、必要に応じて保存したダイアログテーマを呼び出して使用することができます。また、1つのダイアログに対し、複数のテーマファイルを保存できるので、データセットに対し異なる設定で繰り返し分析を行う際に便利です。
</p><p>前回使用したダイアログ設定は、<b><b>＜前回どおり＞</b></b>というテーマとして自動的に保存されます。また、カスタムした設定は、デフォルトテーマ<b><b>＜デフォルト＞</b></b>として保存することもできます。名前を付けて保存したテーマやデフォルトテーマ、前回どおりテーマは、ダイアログボックスのテーマフライアウトメニューからアクセスできるほか、分析のダイアログを開く際に表示されるメニューから使用することもできます。<br />
</p><p><a  class="image"><img alt="Analysis themes menu.png" src="../images/How_to_Handle_Repetitive_Tasks/Analysis_themes_menu.png" width="931"  /></a><br /><br />
</p><p>ダイアログテーマの管理は、<b><b>ツール</b></b>メニューの<b>テーマ・オーガナイザ</b>を使用して行います。
</p>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_to_Handle_Repetitive_Tasks/Tutorial_icon.png" width="57"  border="0" />
	</td>
	<td><p><b> チュートリアル：ダイアログテーマの保存と使用方法</b>
</p>
<ol><li> <b>Samples\Curve Fitting</b>フォルダから<b>Linear Fit.dat</b>ファイルをインポートします。</li>
<li> B列を選択し、メインメニューから<b>解析：フィット：線形フィット</b>と選択します。</li>
<li> <b>線形フィット</b>ダイアログが開いたら、<b><b>フィットオプション</b></b>の<b><b>切片固定</b></b>チェックボックスにチェックを付け、<b><b>切片固定：</b></b>テキストボックスに<b>0</b>を入力します。</li>
<li> <b><b>ダイアログテーマ</b></b>の隣にある、<a  class="image"><img alt="Button Save Theme.png" src="../images/How_to_Handle_Repetitive_Tasks/Button_Save_Theme.png" width="21"  /></a>ボタンをクリックし、<b><b>名前を付けて保存</b></b>を選択します。<b>テーマ名</b>として、<b>Zero Intercept</b> と入力し、<b><b>OK</b></b>ボタンをクリックします。線形フィットダイアログでも、<b><b>OK</b></b>ボタンをクリックし、フィットを実行します。結果シート<i>FitLinear1</i>と<b>FitLinearCurve1</b>がワークブックに追加されます。 </li>
<li> ソースデータシートを開き、C列を選択してメインメニューから<b><b>解析：フィット：線形フィット</b></b>と選択します。先ほど保存したテーマ<b>Zero Intercept</b>を含む、いくつかのテーマ名がフライアウトメニューに表示されます。</li>
<li> 保存したテーマを選択します。C列に対し、テーマとして保存された設定を使用した線形フィットが実行されます。ここでは、ダイアログは開かずに実行されます。 </li></ol>
</td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_to_Handle_Repetitive_Tasks/Tip_icon.png" width="57"  border="0" /></td><td><p><b>テーマを操作するためのヒント</b>
</p>
<ul><li> <b><b>SHIFT</b></b>キーを押しながらメインメニューにあるテーマをクリックして、ダイアログテーマの設定がロードされたダイアログを開くことができます。</li>
<li> ダイアログのデフォルトテーマは、<b>システムデフォルト</b>と呼ばれます。解析ダイアログのフライアウトメニューをクリックして<b>システムデフォルト</b>を選択し、ロードします。 </li>
<li> 分析ダイアログ内のフライアウトメニューをクリックして、<b>削除</b>を選択し、編集した<b>＜デフォルト＞</b>テーマを含む作成したテーマを削除します。 </li>
<li> すべての分析ダイアログにおける、編集した<b>＜デフォルト＞</b>テーマは、<a class="external text" href="../../UserGuide/UserGuide/The_User_Files_Folder.html"><b>User Filesフォルダ</b></a>のDefaults.xml に保存されます。これを削除すると、解析ダイアログ全てのシステムデフォルト設定が元に戻ります。 </li></ul>
</td></tr></table>
<h2><a name="Workbook_and_Project_Templates"></a><span class="mw-headline">プロジェクト/ワークブックテンプレート</span></h2>
<p><span class="OIndex" style="display:none">テンプレート、ワークブック</span>
<span class="OIndex" style="display:none">テンプレート、プロジェクト</span>
単一のブックまたはプロジェクト全体を「テンプレート」ファイルとして保存する理由はいくつかあります。いくつかの典型的な例を示します。
</p>
<ul><li> 列指定の繰り返しパターン（例：XYyError、XYyErrorなど）を持つ固定数の列を持つデータファイルをインポートすることで、これらのファイルをインポートするためだけのカスタムブックを作成できます（<b>ファイル：テンプレートの新規保存</b>）。</li>
<li> 同様の構造のデータファイルを定期的にインポートし、そのデータに対して通常のグラフ作成および分析操作を実行します。次に、ワークシートまたはブックを埋め込んだノートウィンドウを使用してレポートを生成します。これは<a href="../../GettingStarted/OriginLab/How_to_Handle_Repetitive_Tasks.html#Batch_Analysis_Using_an_Analysis_Template" title="OriginLab:繰り返し処理の方法">分析テンプレート</a>の典型的な例です（<b>ファイル：ワークブックを分析テンプレートとして保存</b>）。</li>
<li> 前の例で説明した操作と似た操作をいくつか実行しますが、保存時にすべてのデータがワークブックから消去され、分析に使用する参照値のシートが破壊されるため、ワークブックを分析テンプレートとして保存できません。 。代わりに、インポートしたデータのみを消去してワークブックをウィンドウファイルとして保存することを選択できます（<b>ファイル：ウィンドウの新規保存</b>）。これは参照データのシートを保持し、分析テンプレートと同様に、ワークブックによる分析とグラフ作成の操作を節約します。</li>
<li> あなたは定期的にデータをインポートし、何らかの分析を行い、そしてレポートを作成し、そして分析テンプレートの概念を利用したいと思うとします（箇条書きの2番目のように）。しかし、ワークブックに埋め込めないレイアウトウィンドウなど、プロジェクトには複数のウィンドウがあります。そのため、1つのワークブック分析テンプレートではうまくいきません。この場合は、「クローン」を作成してプロジェクトをデータなしで保存できます（<b>ファイル：現在のプロジェクトのクローンを作成</b>）。</li></ul>
<h3><a name="The_Workbook_as_Template"></a><span class="mw-headline">ワークブックをテンプレートとする</span></h3>
<p>ワークブックには、データ、メタデータ、浮動グラフまたは埋め込みグラフ、埋め込み行列とメモ、スクリプト、変数およびその他のサポートデータを含むワークシートを含めることができます。<span class="OIndex" style="display:none">組込みグラフ、Originテンプレート</span>
</p><p>ワークブックは、グラフ作成や分析処理を繰り返し実行するためのテンプレートとして使用することができます。必要に応じて、<b><b>ワークブック</b></b>（OGWU）、<b><b>テンプレート</b></b>（OTWU）、または<b><b>分析テンプレート</b></b>（OGWU）としてブックを保存する3つのオプションがあります。
</p>
<ul><li> <b><b>ワークブック</b>（OGWU）</b>：<b><b>ファイル：ウィンドウの新規保存</b></b>で<i>すべての</i>ブックの内容を保存します。</li>
<li> <b>分析テンプレート（OGWU）</b>：<b>ファイル：ワークブックを分析テンプレートとして保存</b>を選択すると、保存前にブック内の分析操作で使用されるすべてのデータ列が消去されます。分析操作に関連付けられていないデータと同様に操作が保存されます。<span class="OIndex" style="display:none">分析テンプレート</span><span class="OIndex" style="display:none">テンプレート、分析s</span> </li>
<li> <b>テンプレート（OTWU）</b>：<b>ファイルの選択：テンプレートの新規保存</b>でワークブックの構造、およびワークブックに存在する分析操作は保存されますが、これらの分析操作に関連付けられていないデータを含むすべてのデータは消去されます。</li></ul>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_to_Handle_Repetitive_Tasks/Tip_icon.png" width="57"  border="0" /></td><td><p><b>新しいブック</b>ダイアログは、ワークブック、行列ブック、および分析テンプレートを管理するためのテンプレートライブラリです。ダイアログボックスの機能の概要については、<a href="../../GettingStarted/OriginLab/Workbooks_Worksheets_Columns.html#Workbooks" title="OriginLab:ワークブック、ワークシート、列">ワークブック</a>を参照してください。
</p></td></tr></table>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_to_Handle_Repetitive_Tasks/Tutorial_icon.png" width="57"  border="0" />
	</td>
	<td><p><b>チュートリアル：分析テンプレートの作成</b>
</p>
<ol><li> 新しいワークブックを開き、<b>Samples\Curve Fitting\Sensor01.dat</b>ファイルをインポートします。</li>
<li> 列Bを選択し、<b>解析：フィット：線形フィット</b>メニューを選択し、<b>線形フィット</b>ダイアログを開きます。</li>
<li> <b><b>再計算</b></b>ドロップダウンから<b><b>自動</b></b>を選択します。</li>
<li> <b><b>フィット制御</b></b>タブの<b><b>切片固定</b></b>チェックボックスにチェックを付け、<b>切片固定</b>テキストボックスに<b>0</b>を入力します。 </li>
<li> <b>OK</b> をクリックしてダイアログを閉じ、線形フィットを実行します。</li>
<li> 「はい」をクリックしてレポートシート<b><b>FitLinear1</b></b> に切り替え、最適なフィット曲線や残差のグラフを含む結果を表示します。</li>
<li> データシートに戻り、ファイル<b> Samples\Curve Fitting\Sensor02.dat</b> をインポートします。すると、新たなデータに対し、フィット処理が行われ、結果が自動的に更新されます。このワークブックを続けて使用、あるいは、ワークブックウィンドウのタイトルバーを右クリックして<b>データなしで複製</b>を選択してフィット操作を含む新しいワークブックを作成し、ほかのデータのインポートに利用可能です。これにより、ワークブックに新しいデータをインポートし、必要があれば、複数ワークブックのプロジェクトを保存します。</li>
<li> ワークブックをアクティブにして、メニューから<b><b>ファイル：ワークシートを分析テンプレートとして保存</b></b>を選択します。ダイアログが開いたら、<b>Linear Fit of Sensor Data</b>  などの名前を付け、<b><b>保存</b></b>をクリックします。</li>
<li> <b><b>ファイル: 最近使ったブック</b></b>メニューを選択し、前のステップで保存したテンプレートを選択します。すると、データなしのワークブックが開きます。</li>
<li> ファイル<b> Samples\Curve Fitting\Sensor3.dat</b> を空のシート（1つ目のシート）にインポートします。データをインポートすると解析結果は自動で生成されます。</li></ol>
</td></tr></table>
<p><b>分析テンプレート</b> には、サマリーシートとカスタムレポートシート（<a class="external text" href="../../Tutorial/Tutorial/Creating_a_Custom_Report_Sheet.html">ワークシート・ベース</a>または<a href="../../GettingStarted/OriginLab/Publishing_and_Export.html#HTML_Reports_from_Notes_Windows" title="OriginLab:出版とエクスポート">HTML</a>）を含めることができます。これは分析ルーティンのインポート、分析、プロット、およびレポートのための理想的な媒体となります。<a class="external text" href="../../UserGuide/UserGuide/Batch_Processing.html"><b>バッチ処理</b>ツール</a>ツールと組み合わせて使用​​すると、任意の数のデータファイルに対して一連の分析とグラフ化操作を繰り返し、処理されるたびにそれぞれに対してPDFサマリーレポートを作成できます。この章の<a href="../../GettingStarted/OriginLab/How_to_Handle_Repetitive_Tasks.html#Batch_Plotting" title="OriginLab:繰り返し処理の方法"><b><b>バッチ作図</b></b></a>と<a href="../../GettingStarted/OriginLab/How_to_Handle_Repetitive_Tasks.html#Batch_Analysis" title="OriginLab:繰り返し処理の方法"><b><b>バッチ分析</b></b></a>のセクションでは、繰り返し処理を実行する際のワークブックテンプレートの使用方法を紹介しています。
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_to_Handle_Repetitive_Tasks/Tip_icon.png" width="57"  border="0" /></td><td><p>ノートウィンドウで<b>HTML</b>をサポートするようになりました。ノートウィンドウをワークブックに追加して（シートタブを右クリックして<b>シートとしてメモを追加</b>）、<b>分析テンプレート</b>にHTMLレポートを簡単に組み込むことができます。詳細は、<a href="../../GettingStarted/OriginLab/Publishing_and_Export.html#HTML_Reports_from_Notes_Windows" title="OriginLab:出版とエクスポート"><b>ノートウィンドウからHTMLレポートを作成</b></a>をご覧ください。
</p></td></tr></table>
<h3><a name="The_Project_as_Template"></a><span class="mw-headline">プロジェクトをテンプレートとする</span></h3>
<p>Originのプロジェクトファイルは、特に1つのワークブック内で分析とグラフ作成のタスクを解決できない場合に、繰り返しのグラフ作成と分析のタスクを実行するための「テンプレート」としても使用できます。
</p><p>「プロジェクトテンプレート」を作成するための基本手順は次のとおりです。
</p>
<ol>
<li>ワークブックのデータから、グラフ作成や分析を行い、プロジェクトとして保存します。 </li>
<li>プロジェクト保存後、<b>ファイル：現在のプロジェクトのクローンを作成</b>を選択します。クローンプロジェクトを設定するための小さなダイアログが開きます。
<dl><dd><dl><dd><a  class="image"><img alt="ClrAllData Dialog.png" src="../images/How_to_Handle_Repetitive_Tasks/ClrAllData_Dialog.png" width="424"  /></a></dd></dl></dd></dl>
</li>
<ul> 
<li><b>データコネクタを追加</b>：このボックスにチェックして、クローン作成するプロジェクトから保存されたプロジェクトへの<b>データコネクタ</b>を追加します。複製された各ワークシートは、保存されたプロジェクトの元のワークシートへの接続を持ちます。クローンプロジェクトの他の同様のファイルからデータをインポートする場合は、このボックスをクリアしてください。</li>
<li><b>全てクリア</b>：インポートしたデータのみをクリアします。分析操作はクローンプロジェクトに保存されます。 </li>
<li><b>インポートデータをクリアして計算を削除</b>：インポートされたデータと分析操作を消去します。</li>
</ul>
<li><b>OK</b>を押してクローンプロジェクトを作成します。選択したデータが消去され、UNTITLEDという名前のクローンプロジェクトがワークスペースに追加されます。</li>
<li>クローンプロジェクトに名前を付けて保存し、さらにデータファイルを処理する準備ができたら、それを開いて新しいデータをインポートできます。</li>
<ul>
<li>分析およびグラフ作成操作が定期的に更新される特定のデータファイルのセットにリンクされている場合は、必ずしもコネクタを使用する必要はありません。簡単にファイルを再インポートすることができます（<b>データ：再インポート...</b>または<b>直接再インポート</b>)。</li>
<li>操作が<a href="../../GettingStarted/OriginLab/Import_Data.html#Data_Connectors" title="OriginLab:データのインポート">データコネクタ</a>を使用してリンクされている場合は、コネクタアイコン<a  class="image"><img alt="DC Icon Live.png" src="../images/How_to_Handle_Repetitive_Tasks/DC_Icon_Live.png" width="18"  /></a>をクリックし、ポップアップメニューから<b>インポート</b> （このコネクタのみ）または<b>全てインポート</b>（ブック内のすべてのコネクタ）を選択します。</li>
<li>一つの方法は、すべてのデータを単一のOriginプロジェクトファイルに保存することです。クローンプロジェクトから元のプロジェクトにデータコネクタを追加した場合は、グラフ作成および分析操作を実行するために必要なデータのみを選択的にインポートできます。完了したら、クローンプロジェクトを再利用できるようにして、ファイルに新しい名前を付けて保存できます。</li>
</ul>
</ol>
<h2><a name="Batch_Plotting"></a><span class="mw-headline">バッチ作図</span></h2>
<p><span class="OIndex" style="display:none">バッチ作図</span>
Originには、複数データセットやファイルから、それぞれのグラフを作図する方法がいくつか用意されています。以下の2セクションでは、（1）既存のワークシートデータまたは、（2）複数のデータファイルから、複数グラフを作成する方法を説明します。なお、これら2通りの方法のほか、LabTalkスクリプトやOrigin Cを使用したバッチ作図の方法も可能です。
</p>
<h3><a name="Duplicating_Graphs_with_Data_from_Other_Books.2FSheets.2FColumns"></a><span class="mw-headline">他のブック/シート/列データを使用してグラフを複製</span></h3>
<p>ワークブック、ワークシート、列などが、同様のデータ構造の場合、グラフを複製することができます。<b>ウィンドウ：複製（バッチ作図）</b>メニューで新しいデータを使ってグラフを複製します。以下の2つの場合があります。
</p>
<ul><li> 単一データでグラフの作成と編集をして、同じワークシート内の別のデータでグラフを複製する場合、<b>ウィンドウ: 複製(バッチ作図): 新しい列で複製</b>を選択します。作図したい他のデータ（列）を指定します。それぞれの列は、新しいグラフとして作図されます。 </li>
<li> １つのワークシートかワークブック内のデータでグラフの作成と編集をして、同じデータ構造の別のワークシートやワークブックにグラフを複製する場合、<b>ウィンドウ: 複製（バッチ作図）: 新しい シートで複製/新しいブックで複製</b>を選択します。Originは似たデータ構造のワークシートやワークブックのすべてを表示します。作図したいワークシートやワークブックを指定します。それぞれのワークシートやワークブックのデータが、新しいグラフとして作図されます。</li></ul>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_to_Handle_Repetitive_Tasks/Tutorial_icon.png" width="57"  border="0" />
	</td>
	<td><p><b>チュートリアル：他のブック/シートにあるデータを使用してグラフを複製する</b>
</p>
<ol><li> <b><b>標準</b></b>ツールバーの<b>新規プロジェクト</b>ボタン<a  class="image"><img alt="Button New Project.png" src="../images/How_to_Handle_Repetitive_Tasks/Button_New_Project.png" width="22"  /></a>をクリックします。</li>
<li> 標準ツールバーの<b>インポートウィザード</b>ボタン<a  class="image"><img alt="Button Import Wizard.png" src="../images/How_to_Handle_Repetitive_Tasks/Button_Import_Wizard.png" width="25"  /></a>をクリックします。<b>インポートウィザード</b>ダイアログボックスが開きます。</li>
<li> <b><b>ファイル</b></b>ボックスの右側にある参照ボタン<a  class="image"><img alt="Button Browse.png" src="../images/How_to_Handle_Repetitive_Tasks/Button_Browse.png" width="20"  /></a>をクリックします。<b>Import and Export</b>フォルダの<b>S15-125-03.dat</b>、<b>S21-235-07.dat</b>、<b>S32-014-04.dat</b>を選択します。<b>ファイルの追加</b>をクリックし、<b>OK</b>をクリックします。インポート・ウィザードダイアログボックスで、<b><b>完了</b></b>をクリックします。3つのファイルがそれぞれ別のワークブックにインポートされます。</li>
<li> これらの内1つのワークブックで、3つのYデータ列を選択し、メインメニューの<b><b>作図：複数Y軸：3重Y：Y-YY</b></b>を選択して3つのY軸と共通のX軸をもつグラフを作図し、グラフを編集します。</li>
<li> グラフウィンドウのタイトルバーで右クリックし、<b><b>複製（バッチ作図）</b></b>を選択します。 </li>
<li> ダイアログボックスが開いたら、Ctrlキーを押しながら他の2つのワークブック/ワークシートを選択し、<b><b>OK</b></b>ボタンをクリックしてダイアログを閉じます。すると、指定した2つのブック/シートからグラフが作図されます。 </li></ol>
</td></tr></table>
<h3><a name="The_Workbook_as_a_Template_for_Processing_Multiple_Files"></a><span class="mw-headline">ワークブックをテンプレートとして複数ファイルを処理</span></h3>
<p>多くのデータでグラフを作成し、最初にワークブックに全てのファイルを作図前にインポートしたくない場合、希望のグラフを作成してから、ワークブックにこのグラフを追加して、ワークブックテンプレートとして保存することができます。このテンプレートを使用すれば、それぞれのグラフと対応するグラフのワークブックを作成して、複数ファイルを処理することができます。
</p>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_to_Handle_Repetitive_Tasks/Tutorial_icon.png" width="57"  border="0" />
	</td>
	<td><p><b>チュートリアル：複数データファイルからグラフ作成</b>
</p>
<ol><li> 新しいワークブックをアクティブにして、メニューから<b>データ：ファイルからインポート: 単一ASCIIファイル</b>を選択して、Originのインストールフォルダにある、<b>Samples\Statistics</b>フォルダの<b>Sensor01.dat</b> をインポートします。</li>
<li> B列を選択して、線＋シンボルグラフを作成します。</li>
<li> X軸をダブルクリックして、<b>軸</b>ダイアログボックスを開きます。<b><b>スケール</b></b>タブをアクティブにします。左パネルの<b>水平</b>と<b>垂直</b>を選択して、<b>再スケール</b>を<b>自動</b>に設定して<b>OK</b>をクリックします。これでデータが変更するとグラフスケールが自動で更新されます。</li>
<li> ワークシートタブ上で右クリックし、<b>グラフをシートとして追加</b>を選択し、開いたダイアログで、先に作成したグラフを選択し、<b>完了</b>をクリックします。これにより埋め込みグラフを含む新しいワークシートが追加されます。</li>
<li> データシートを開き、タブをダブルクリックして、シート名を<b><b>Data</b></b>に変更します。</li>
<li> メインメニューから、<b><b>ワークシート：ワークシートをクリア</b></b>を選択して、シート内のデータをクリアします。このステップは任意です。データをクリアすることで、次のステップで保存するテンプレートのサイズを小さくしています。 </li>
<li> メインメニューの<b><b>ファイル：ウィンドウの新規保存</b></b>を選択し、<b>Sensor Data and Graph</b> 等の名前を付けて<b><b>保存</b></b>をクリックし、グラフウィンドウを保存します。</li>
<li> このテンプレートを使用し、複数ファイルを処理します。メニューから、<b><b>ファイル：バッチ処理</b></b>を選択します。</li>
<li> 開いたダイアログで、<b><b>バッチ処理モード</b></b>を<b><b>分析テンプレートをロード</b></b>に設定し、<b><b>分析テンプレート</b></b>として、保存したテンプレートを指定します。</li>
<li> <b><b>データソース</b></b>を<b><b>ファイルからインポート</b></b>にし、<b>Samples\Curve Fitting</b> にある、3つのファイル<b><b>Sensor01.dat</b>、<b>Sensor02.dat</b>、<b>Sensor03.dat</b></b>を選択します。</li>
<li> <b><b>データシート</b></b>を<b><b>Data</b></b>にし、<b><b>結果シート</b></b>を<b><b>なし</b></b>にします。 </li>
<li> <b>OK </b>をクリックして、ダイアログを閉じます。これにより、1つ目のシートにインポートデータ、2つ目のシートに対応するグラフを持つ、3つのワークブックが作成されます。シートに埋め込まれたグラフをダブルクリックすれば、グラフウィンドウが開き編集できます。</li></ol>
</td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_to_Handle_Repetitive_Tasks/Tip_icon.png" width="57"  border="0" /></td><td><p>もし、データインポートの際に、特別なインポート設定が必要なときは、インポートオプションダイアログで、設定をデータシートに保存することができます。これにより複数ファイルに対し、バッチ処理を実行した際には、保存したインポート設定が適用されます。
</p></td></tr></table>
<h2><a name="Batch_Analysis"></a><span class="mw-headline">バッチ分析</span></h2>
<p>Originには、複数ファイルやデータ列、データプロットに対して実行できるバッチ分析の機能がいくつか用意されています。 
</p>
<h3><a name="Analyzing_Multiple_Datasets_in_Dialogs"></a><span class="mw-headline">ダイアログで複数データセットを分析</span></h3>
<p>線形フィットや非線形曲線フィットなど、いくつかのダイアログボックスには、複数データセットの分析をサポートしています。これらのダイアログボックスで作成されたレポートシートは、各データセットに対するパラメータ値や、フィット結果の良し悪しなど関連する結果が含まれます。この結果表は別のシートにコピーして、以降の解析処理などに使用することができます。
</p>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_to_Handle_Repetitive_Tasks/Tutorial_icon.png" width="57"  border="0" />
	</td>
	<td><p><b> チュートリアル：複数データセットをフィットする</b>
</p>
<ol><li> 新しいワークブックを開き、Originのインストールフォルダにある<b>Samples\Curve Fitting\Multiple Gaussians.dat</b> をインポートします。</li>
<li> Y列のロングネームをそれぞれ、<b>Peak 1</b>、<b>Peak 2</b>、<b>Peak 3</b>、<b>Peak 4</b> とします。</li>
<li> 4つのY列を選択して、<b>解析：フィット：非線形曲線フィット...</b>メニューを選択し、<b>NLFit</b> ダイアログを開きます。</li>
<li> <b><b>関数</b></b>ドロップダウンリストから、<b><b>Gauss</b></b>を選択し、<b><b>フィット</b></b>ボタンをクリックしてフィットを実行します。</li>
<li> <b>FitNL1</b>レポートシートを開きます。それぞれのデータセットに対するフィットパラメータがリストされた<b><b>概要</b></b>という表を確認できます。</li></ol>
<p><a  class="image"><img alt="GSB Batch NLFit Summary.png" src="../images/How_to_Handle_Repetitive_Tasks/GSB_Batch_NLFit_Summary.png" width="550"  /></a>
</p></td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_to_Handle_Repetitive_Tasks/Tip_icon.png" width="57"  border="0" /></td><td><p><b><b>概要</b></b>のとなりにある下向きの矢印ボタン<a  class="image"><img alt="Button Extract Worksheet DropDown.png" src="../images/How_to_Handle_Repetitive_Tasks/Button_Extract_Worksheet_DropDown.png" width="16"  /></a>をクリックし、<b><b>新しいシートとしてコピーを作成</b></b>を選択します。これにより、全てのセルがレポートシートにリンクされた表のコピーが作成されます。フィット処理を更新したり、変更すると、コピーした表の内容も自動的に更新されます。このシートのデータからグラフを作図することもできるので、フィットパラメータを使用した二次的な解析に使用できます。
</p></td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_to_Handle_Repetitive_Tasks/Tip_icon.png" width="57"  border="0" /></td><td><p>上記の手順2で行ったように、列ロングネームを列挙するときは、最初のセル（「ピーク1」など）に文字列を入力し、セルを選択して右下隅にカーソルを合わせます。カーソルが<b>+</b>の表示になったら、ほかのセルにドラッグして最初のセルの内容をほかのセルに拡張します。
</p>
<dl><dd><dl><dd><a  class="image"><img alt="Extend string to other cells.png" src="../images/How_to_Handle_Repetitive_Tasks/Extend_string_to_other_cells.png" width="301"  /></a></dd></dl></dd></dl>
</td></tr></table>
<h3><a name="Using_Gadgets_for_Analyzing_Multiple_Curves"></a><span class="mw-headline">ガジェットを使用した複数曲線の分析</span></h3>
<p><span class="OIndex" style="display:none">ガジェット</span><span class="OIndex" style="display:none">関心範囲(ROI)</span>Originには、作図データをインタラクティブに分析するいくつかのガジェットがあります。ガジェット機能では、分析を行う領域の選択や、分析対象のデータセット変更、分析実行時の様々なオプション設定などが可能です。
</p><p>また、ほとんどのガジェット機能では、現在のレイヤまたは、グラフページ内にある全てのプロットに対して分析を実行することができます。これにより、同じ設定を使用して、複数データセットに対する繰り返し分析処理を行い、すべてのデータセットに対応する分析結果の表を作成することができます。
</p>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_to_Handle_Repetitive_Tasks/Tutorial_icon.png" width="57"  border="0" />
	</td>
	<td><p><span class="OIndex" style="display:none">関心領域（ROI）</span>
<p><b>チュートリアル：積分ガジェットを使用し、複数の曲線を積分する </b>
</p>
</p>
<ol><li> Originプロジェクト&quot;Samples\Spectroscopy\Absorbance Spectra.opj&quot; を開きます。</li>
<li> グラフウィンドウをアクティブにし、メインメニューから、<b>ガジェット：積分</b>を選択します。 </li>
<li> 開いたダイアログで、<b><b>基線</b></b>タブを開き、<b><b>モード</b></b>ドロップダウンリストから<b><b>直線</b></b>を選択します。</li>
<li> <b><b>出力</b></b>タブを開き、<b><b>出力先</b></b>の項目にある、<b><b>ワークシートに追加</b></b>にチェックを付けます。<b>OK </b>をクリックして、ダイアログを閉じます。</li>
<li> グラフ内に関心領域（Region of Interest 、ROI）ボックスが配置されます。必要に応じて、ROIをクリックしてサイズを変更し、グラフ内のデータがオブジェクト範囲内に含まれるようにします。積分領域は、暗く表示されます。</li>
<li> ROIオブジェクトの右上にある矢印ボタン<a  class="image"><img alt="Right arrow menu button.png" src="../images/How_to_Handle_Repetitive_Tasks/Right_arrow_menu_button.png" width="17"  /></a>をクリックし、コンテキストメニューから、<b><b>データ変更</b></b>を選択すると、同一レイヤ内にある他のプロットを対象に積分が実行できます。ここで、現在のベースラインの設定が他の曲線に対しても適用されることに注意してください。</li>
<li> 矢印ボタン<a  class="image"><img alt="Right arrow menu button.png" src="../images/How_to_Handle_Repetitive_Tasks/Right_arrow_menu_button.png" width="17"  /></a>をクリックして、<b>すべての曲線で出力 (N)</b>、または、Nキーを押します。すべての曲線に対して積分が実行されます。 </li>
<li> 矢印ボタン<a  class="image"><img alt="Right arrow menu button.png" src="../images/How_to_Handle_Repetitive_Tasks/Right_arrow_menu_button.png" width="17"  /></a>をクリックし、メニューから<b><b>レポートシートに行く</b></b>を選びます。レポートシートが開き、すべての曲線に対する積分結果が表示されます。</li></ol>
<p><a  class="image"><img alt="GSB BatchAnalysis Gadget.png" src="../images/How_to_Handle_Repetitive_Tasks/GSB_BatchAnalysis_Gadget.png" width="793"  /></a>
</p></td></tr></table>
<h3><a name="Batch_Analysis_Using_an_Analysis_Template"></a><span class="mw-headline">分析テンプレートを使用したバッチ処理</span></h3>
<p><span class="OIndex" style="display:none">分析テンプレート</span>
<span class="OIndex" style="display:none">テンプレート, 分析</span>
<span class="OIndex" style="display:none">分析レポート</span>
<span class="OIndex" style="display:none">レポート, 分析</span>
<b><b>バッチ処理</b></b>ツールを使用すると、<b><b>分析テンプレート</b></b>を使用して複数ファイルやデータセットに対する分析を実行できます。1つのファイルに対して分析を実行し、同一ワークブックに分析結果やレポートシートなどを含め、分析テンプレートとして保存します。そして、バッチ処理ツールはこのテンプレートを使用して複数ファイルまたはデータセットを処理します。それぞれのファイルやデータセットのワークブックを残すオプションや、分析テンプレートを作成した際にあらかじめ設定可能なサマリー表（結果パラメータや、メタデータを含む）を作成するオプションを使用できます。
</p>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_to_Handle_Repetitive_Tasks/Tutorial_icon.png" width="57"  border="0" />
	</td>
	<td><p><b>チュートリアル：分析テンプレートを使用して複数ファイルのバッチ処理を実行</b>
</p>
<ol><li> メインメニューから、<b><b>ファイル：バッチ処理</b></b>を選択します。これにより<b>バッチ処理</b>ダイアログを開きます。</li>
<li> <b><b>バッチ処理モード</b> </b>を<b>分析テンプレートをロード</b>にします。</li>
<li> 分析テンプレートボックスの右にある参照ボタン<a  class="image"><img alt="Button Browse.png" src="../images/How_to_Handle_Repetitive_Tasks/Button_Browse.png" width="20"  /></a>をクリックして、<i>&lt;Origin Program Folder&gt;</i><b>\Samples\Batch Processing\Sensor Analysis.OGW</b>を選択します。この分析テンプレートには、線形フィット、レポート、結果表を含むシートが用意されています。</li>
<li> <b>データソース</b>を<b>ファイルからインポート</b>にし、<b>ファイルリスト</b>の右側にある参照ボタン<a  class="image"><img alt="Button Browse.png" src="../images/How_to_Handle_Repetitive_Tasks/Button_Browse.png" width="20"  /></a>をクリックして、<b>Samples\Curve Fitting</b>の<b>Sensor01.dat</b>、<b>Sensor02.dat</b>、<b>Sensor03.dat</b>を選択します。</li>
<li> <b>データセット識別子</b>を<b>ファイル名</b>にし、データシートを<b>Data</b>、結果シートを<b>Result</b>にします。これらは、分析テンプレート内の既存のシートの名前であることに注意してください。</li>
<li> <b><b>中途生成されたワークブックの削除</b></b>のチェックをはずします。</li>
<li> <b>OK</b>をクリックしてダイアログボックスを閉じ、3つのファイルを処理します（「いいえ」を選択することもできます）。処理が完了すると、それぞれのデータとレポートが入力された3つのブックと、すべての分析結果が入力された結果表を含む4つ目のブックが出力されます。</li></ol>
<dl><dd><a  class="image"><img alt="GSB BatchAnalysis Files.png" src="../images/How_to_Handle_Repetitive_Tasks/GSB_BatchAnalysis_Files.png" width="547"  /></a></dd></dl>
</td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_to_Handle_Repetitive_Tasks/Tip_icon.png" width="57"  border="0" /></td><td><p>ワークブックを分析テンプレートとして保存する操作は任意です。Originプロジェクト（.opj）として保存すれば、ワークブック内のデータを置き換えるだけで、すべての結果やグラフや自動更新されます。また、<b>バッチ処理</b>ツールには、アクティブなウィンドウに繰り返しインポートを行うオプションが用意されているため、分析やグラフを含む既存ブックをバッチ処理のためのテンプレートとして、使用することができます。 
</p></td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_to_Handle_Repetitive_Tasks/Tip_icon.png" width="57"  border="0" /></td><td><p>カスタム<b>MS Word</b> テンプレートを使って、分析レポートをバッチ生成できます。オプションでレポートごとに<b>PDF</b>あるいは<b>MS Word</b>ファイルを出力することができます。また、レポートを単一ファイルとして統合することができます。<b>レポート用にWordテンプレートを使ったバッチ処理</b>についての詳細は、<a class="external text" href="../../Tutorial/Tutorial/Batch_Processing_with_Word_Template_for_Reporting.html">このチュートリアル</a>を参照してください。
</p></td></tr></table>
<h2><a name="Repeating_Analysis_on_Other_Datasets_or_Data_Plots"></a><span class="mw-headline">他のデータセットやプロットを繰り返し分析</span></h2>
<p>一部の解析処理は、1つのデータセットやデータプロット上で分析を実行したのち、他のすべてのデータに対して処理を繰り返すことができます。この機能は、解析処理に関連した錠前アイコンをクリックして開くショートカットメニューから利用可能です。 
</p>
<ul><li> ワークシート列やレポートシートの場合、錠前アイコンをクリックし、メニューから<b>この分析をすべてのY列に繰り返す</b>を選択します。これにより、ソースデータシートにある他のYデータについて繰り返し分析が実行されます。 </li>
<li> グラフの場合、錠前アイコンをクリックし、メニューから<b><b>この分析をすべてのプロットに繰り返す</b></b>を選択します。これにより、レイヤが複数あっても関係なく、同じグラフページ内の全てのデータプロットに対して分析が実行されます。</li></ul>
<p>この機能は、入力データとして1つのデータセットしか扱うことのできない<b><b>スムージング</b></b>や<b><b>補間</b></b>といったダイアログボックスで特に便利です。全てのデータが<i>同一ワークシート内</i>または、<i>同一グラフ内</i>に存在している限り繰り返し分析を実行できます。
</p>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_to_Handle_Repetitive_Tasks/Alert_icon.png" width="57"  border="0" /></td><td><p><b>Origin 2022b</b>での変更についての注意: 以前のバージョンでは、元の分析出力が新しいシートまたはブックを作成した場合、<b>すべてに対してこれを繰り返す</b>と、残りのY列またはプロットに対して新しいシートやブックが作成されました。しかし、元の出力設定に関係なく、すべての出力を1つのシートにまとめたいという要望がありました。そこで、共通のXデータセットを入力列にしている場合、Xデータセットは一度だけ出力シートに書き込まれるようになりました。以前の動作に戻すには<a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#R"><b>@RAO</b> = <i>0</i></a> を設定します(デフォルトは<i>1</i>)。
</p>
	</td>
	</tr>
	</table>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_to_Handle_Repetitive_Tasks/Tutorial_icon.png" width="57"  border="0" />
	</td>
	<td><p><b>チュートリアル：ワークシート内の複数データ列のスムージング</b>
</p>
<ol><li> <b><b>Samples\Curve Fitting\Multiple Gaussians.dat </b></b>を空のワークブックにインポートします。</li>
<li> B列を選択して、<b>解析: 信号処理: スムージング</b>を選択して<b>smooth</b>ダイアログを開きます。</li>
<li> デフォルトの設定のまま、<b><b>OK</b></b>をクリックして、スムージングを実行します。スムージングされたデータと、新しい列が追加されます。</li>
<li> 錠前アイコン<a  class="image"><img alt="Operation lock manual.png" src="../images/How_to_Handle_Repetitive_Tasks/Operation_lock_manual.png" width="13"  /></a>をクリックして、<b><b>この分析をすべてのY列に繰り返す</b></b>を選択します。C列からE列のデータより、同じ設定でスムージングされた３列のデータが作成されます。</li></ol>
</td></tr></table>
<h2><a name="Duplicate_this_Operation"></a><span class="mw-headline">この操作を複製</span></h2>
<p>Originの分析操作によって生成された出力は、特定の分析および特定の分析パラメータのセットによってそのソースデータにリンクされます。このリンクは、分析出力に<a href="../../GettingStarted/OriginLab/How_to_Handle_Repetitive_Tasks.html#Recalculation" title="OriginLab:繰り返し処理の方法">「操作ロック」</a>を配置することによって示され、ユーザが特定の操作の<a href="#Recalculation">再計算を<i>オフ</i></a>にしない限り、このような結果は通常、編集に対して「ロック」されます。この章のセクションの<a href="../../GettingStarted/OriginLab/How_to_Handle_Repetitive_Tasks.html#Analysis_Report_Sheets" title="OriginLab:繰り返し処理の方法">分析レポートシート</a>と<a href="../../GettingStarted/OriginLab/How_to_Handle_Repetitive_Tasks.html#Analysis_Report_Sheets" title="OriginLab:繰り返し処理の方法">再計算</a>について読むことで詳細を知ることができます。
</p><p>分析出力に配置されたロックアイコンをクリックしてメニューを開くと、分析後の操作パラメータやその他の情報にアクセスできます。これには、<b>パラメータの変更</b>をクリックして開く、分析出力の生成に使用されるダイアログボックスとパラメータセットが含まれます。 
</p><p>このメニューの下の方に、<b>この操作を複製</b>メニューがあります。
</p>
<dl><dd><a  class="image"><img alt="UG lock dujplicate this operation.png" src="../images/How_to_Handle_Repetitive_Tasks/UG_lock_dujplicate_this_operation.png" width="443"  /></a></dd></dl>
<p>この機能の有益な使用法はの1つは、次のようになります。
</p>
<ol><li> データプロットに対して分析操作を実行します。たとえば、非線形曲線フィット（NLFit）を使用したフィット操作です。</li>
<li> どのフィット関数が自分のデータを最適にモデル化するかわからないため、当てはまりそうな関数を使用してフィットを試みます。</li>
<li> 結果の操作ロックをクリックして、<b>この操作を複製</b>を選択します。</li>
<li> 重複分析が実行され、2番目の操作ロックがグラフウィンドウに追加されます。</li>
<li> 2番目の操作ロックをクリックし、<b>パラメータの変更</b>を選択し、NLFitダイアログが開いたら、別のフィットを選択して、新しいフィット操作を実行します。新しい近似演算により、最初の近似関数の近似によって生成された出力と比較できる新しい出力が生成されます。</li></ol>
<dl><dd><dl><dd><a  class="image"><img alt="UG duplicate this operation nlfit.png" src="../images/How_to_Handle_Repetitive_Tasks/UG_duplicate_this_operation_nlfit.png" width="487"  /></a></dd></dl></dd></dl>
<h2><a name="Repeating_Analysis_Using_Data_Filters"></a><span class="mw-headline">データフィルタを使用した繰り返し分析</span></h2>
<p><span class="OIndex" style="display:none">繰り返し処理のデータフィルタ</span><span class="OIndex" style="display:none">繰り返し処理、フィルタ</span>
</p><p>大量な列データセットのうちの、1列またはそれ以上の列に対してフィルタを適用すれば、素早くデータを削減できます。この<a class="external text" href="../../UserGuide/UserGuide/Data_Filter.html">データフィルタ機能</a>と、<a class="external text" href="../../UserGuide/UserGuide/Copy_Columns_to_New_Destination.html">colcopy(列コピー)のXファンクション</a>を組み合わせて使用することにより、同じソースデータを異なる条件のもとでフィルタリングすることができます。また、フィルタをかけたデータに対し、分析処理を実行でき、複数の条件におけるグラフや分析結果を比較することが可能です。
</p><p>ソースデータシートから選択した列は、子シートとしてコピーを作成でき、フィルタ条件は、親シートと同期するか、子シートに固定するか選択できます。  ソースデータが更新されると、すべての同期されている子シートと関連するグラフや分析結果は、それぞれのフィルタ条件の元で自動的に更新されます。更に、特定の子シートのフィルタ条件を、親シートに戻すことができます。
</p><p>下図は、いくつかの自動車メーカーのデータが入力されたソースワークブックです。2つのワークブックは、自動車メーカーを特定するフィルタ条件をかけた、列のサブセットが入力されています。さらに、これらのデータに対して線形フィットを実行しているので、それぞれの条件での分析結果を比較可能です。
</p>
<dl><dd><a  class="image"><img alt="GSB DataFilter Locked.png" src="../images/How_to_Handle_Repetitive_Tasks/GSB_DataFilter_Locked.png" width="600"  /></a></dd></dl>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_to_Handle_Repetitive_Tasks/Tutorial_icon.png" width="57"  border="0" />
	</td>
	<td><p><b> チュートリアル：コピーした列のフィルタ条件を固定する </b>
</p>
<ol><li> <b>Samples\Statistics\Automobile.dat</b>ファイルを開きます。</li>
<li> <b>Make</b> 列でクリックして、ワークシート操作ツールバーにある<b>データフィルタの追加/削除</b>ボタン<a  class="image"><img alt="Button Add Or Remove Data Filter.png" src="../images/How_to_Handle_Repetitive_Tasks/Button_Add_Or_Remove_Data_Filter.png" width="23"  /></a>をクリックします。</li>
<li> 列に追加されたフィルタアイコン<a  class="image"><img alt="Button Add Or Remove Data Filter.png" src="../images/How_to_Handle_Repetitive_Tasks/Button_Add_Or_Remove_Data_Filter.png" width="23"  /></a>をクリックして、<i>Honda </i>以外のチェックを外します(<b>ヒント</b>：<b>全て選択</b>のチェックを外したあと、<i>Honda</i>にチェックを付けて<b>OK</b>をクリック)。</li>
<li> CTRLキーを押しながら、<b>Make</b>、<b>Power</b>、<b>Engine Displacement</b>列を選択します。そして、選択した列上で右クリックし、ショートカットメニューから<b><b>列をコピー</b></b>を選択します。</li>
<li> 開いたダイアログで、<b>ラベルのコピー</b>を開き、<b>ロングネーム</b>、<b>単位</b>にチェックを付けて、<b>OK</b>をクリックします。ワークブックに新しいシートが追加され、Hondaデータの<i>Power</i> および <i>Engine Displacement</i>列のみが含まれていることがわかります。</li>
<li> 新しいワークシートのタブをマウスでつかみ、Orignワークスペース内の空の箇所までドラックして、分離したワークブックを作ります。</li>
<li> 分離したシートの列に付いている錠前アイコンをクリックし、<b><b>ワークシートフィルタ：固定</b></b>を選択します。これでフィルタ条件を固定することができます。元データシートでフィルタ条件を変更しても、このデータシートは変更されません。 </li>
<li> 元の<b>automobile</b>ブックに戻り、フィルタアイコンをクリックしてフィルタ条件をToyotaに修正し、<b>列のコピー</b>を使って別のワークシートを作成することができます。</li>
<li> Hondaワークブックの列Bを選択して、右クリックし、<b>列XY属性の設定: X</b>を選択します。Toyotaワークブックでも同様に行います。 </li>
<li> Hondaワークブックで列Cを選択して、2Dグラフツールバーの<b>散布図</b>ボタン<a  class="image"><img alt="Button Scatter Plot.png" src="../images/How_to_Handle_Repetitive_Tasks/Button_Scatter_Plot.png" width="25"  /></a>をクリックします。Toyotaブックでも同じ操作をします。これは、Power vs Engine Displacementの2つのプロットを作成し、1つはHonda、もう1つはToyotaです。</li>
<li> Hondaグラフをクリックして<b>解析: フィット: 線形フィット</b>を選択します。初期設定のまま、<b>OK</b>ボタンをクリックし、Toyotaグラフでも同じ操作をします。両データに対して線形フィットが実行され、それぞれの分析レポートシートが作成されます。</li>
<li> 2つの自動車メーカーのフィット結果を比較します。</li></ol>
</td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_to_Handle_Repetitive_Tasks/Tip_icon.png" width="57"  border="0" /></td><td><p>デフォルトで、分析操作の入力である列にデータフィルタがある場合、フィルタデータ（非表示の）行は分析で無視されます。非表示行を含めるには、解析のカギのアイコンをクリックして<b>非表示の行を無視する</b>を<i>いいえ</i> にします。
</p>
<dl><dd><dl><dd><a  class="image"><img alt="UG Ignore Hidden Rows ShortMenu.png" src="../images/How_to_Handle_Repetitive_Tasks/UG_Ignore_Hidden_Rows_ShortMenu.png" width="398"  /></a></dd></dl></dd></dl>
</td></tr></table>
<h2><a name="Automating_Tasks_Using_Programming"></a><span class="mw-headline">プログラミングによる自動化</span></h2>
<p><span class="OIndex" style="display:none">Originのプログラミング</span>
</p><p>これまで説明したような、インターフェースによる自動化手法<span class="OIndex" style="display:none">Originの自動化</span>に加え、グラフ作成と分析機能は<b><b>LabTalk</b></b>スクリプトや<b><b>Origin C</b></b>、<b>Python</b>（内部または外部）からもアクセスすることができます。グラフテーマやテンプレートにアクセスして、分析テンプレートを組み込むこともできます。例えば、予めユーザインタフェースを使用して、いくつかの処理について手動でテンプレート（グラフテンプレートや分析テンプレート™など）を作成し、必要に応じてこのテンプレートを呼び出すようなコードを記述することができます。 
</p><p>Originでのプログラミングオプションについては、ユーザーガイドの<a href="../../GettingStarted/OriginLab/Programming_in_Origin.html" title="OriginLab:Originのプログラミング">プログラミングの章</a>を参照してください。  プログラミングに関する詳しい情報については、この章にあるリンクで確認できます。
</p>
<h2><a name="Topics_for_Further_Reading"></a><span class="mw-headline">参考</span></h2>
<ul><li> <a class="external text" href="../../UserGuide/UserGuide/Recalculating_Analysis_Results.html">データやパラメータを変更した結果の再計算</a></li>
<li> <a class="external text" href="../../UserGuide/UserGuide/Dialog_Themes.html">分析ダイアログ設定をテーマとして保存</a></li>
<li> <a class="external text" href="../../UserGuide/UserGuide/Theme_Organizer.html#The_Dialog_Themes_Tab">テーマオーガナイザ、ダイアログテーマ</a></li>
<li> <a class="external text" href="../../UserGuide/UserGuide/Analysis_Templates.html">分析テンプレート</a></li>
<li> <a class="external text" href="../../UserGuide/UserGuide/Batch_Processing.html">バッチ処理と分析テンプレート</a></li>
<li> <a class="external text" href="../../UserGuide/UserGuide/Copy_Paste_Operation.html">処理のコピーと貼り付け</a></li>
<li> <a class="external text" href="../../UserGuide/UserGuide/Data_Filter.html">データフィルタを使ったデータの様々な表示</a></li>
<li> <a class="external text" href="../../UserGuide/UserGuide/Analysis_Report_Sheets_and_Columns.html">分析レポートシートと列</a></li>
<li> <a class="external text" href="http://www.originlab.com/doc/Tutorials/Batch-Processing" target="_blank">チュートリアル: バッチ処理</a></li>
<li> <a class="external text" href="http://originlab.com/index.aspx?go=Support/VideoTutorials&amp;ss=chm&amp;pid=1559" target="_blank">動画: バッチ処理</a></li>
<li> <a class="external text" href="http://www.originlab.com/doc/Tutorials/Combine-QuickPeakGadget-PA" target="_blank">チュートリアル: クイックピークガジェットとピークアナライザを組み合わせて使用</a></li></ul>


    