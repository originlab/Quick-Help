<h1 class="firstheading">行列ブック、行列シート、行列オブジェクト</h1><p class='urlname' style='display: none'>行列ブック、行列シート、行列オブジェクト</p><a  class="image"><img alt="Less grand image matrices 650px.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Less_grand_image_matrices_650px.png" width="650"  /></a>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Matrixbooks.2C_Matrixsheets_and_Matrix_Objects"><span class="tocnumber">1</span> <span class="toctext">行列ブック、行列シート、行列オブジェクト</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Naming_Matrixbooks.2C_Matrixsheets_and_Matrix_Objects"><span class="tocnumber">1.1</span> <span class="toctext">行列ブック、行列シート、行列オブジェクトの名前</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Different_Views_of_the_Matrix"><span class="tocnumber">1.2</span> <span class="toctext">行列データのさまざまな表示方法</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Matrixbooks"><span class="tocnumber">1.3</span> <span class="toctext">行列ブック</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Matrixsheets"><span class="tocnumber">1.4</span> <span class="toctext">行列シート</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Matrix_Objects"><span class="tocnumber">1.5</span> <span class="toctext">行列オブジェクト</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Import_Image_to_Matrix"><span class="tocnumber">1.6</span> <span class="toctext">行列に画像をインポート</span></a>
<ul>
<li class="toclevel-3 tocsection-8"><a href="#Image_Thumbnails_and_Image_Slider"><span class="tocnumber">1.6.1</span> <span class="toctext">イメージサムネイルとスライダ</span></a></li>
<li class="toclevel-3 tocsection-9"><a href="#Naming_Matrix_Objects"><span class="tocnumber">1.6.2</span> <span class="toctext">行列オブジェクトの名前付け</span></a></li>
<li class="toclevel-3 tocsection-10"><a href="#Import_GeoTIFF_to_Matrix"><span class="tocnumber">1.6</span> <span class="toctext">行列にGeoTIFF をインポート</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-11"><a href="#Extracting_Information_from_the_Matrixsheet_or_Object"><span class="tocnumber">2</span> <span class="toctext">行列シートまたはオブジェクトから情報を抽出</span></a></li>
<li class="toclevel-1 tocsection-12"><a href="#Image_Plot"><span class="tocnumber">3</span> <span class="toctext">イメージプロット</span></a></li>
<li class="toclevel-1 tocsection-13"><a href="#Image_Window"><span class="tocnumber">4</span> <span class="toctext">画像ウィンドウ</span></a>
<ul>
<li class="toclevel-2 tocsection-14"><a href="#Image_and_Video_Import"><span class="tocnumber">4.1</span> <span class="toctext">画像と動画のインポート</span></a>
<ul>
<li class="toclevel-3 tocsection-15"><a href="#Import_GeoTIFF_as_Image"><span class="tocnumber">4.1</span> <span class="toctext">GeoTIFF を画像としてインポート</span></a></li>
<li class="toclevel-3 tocsection-16"><a href="#Image_Import_Notes"><span class="tocnumber">4.1.2</span> <span class="toctext">画像インポートに関するメモ</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-17"><a href="#Image_Window_Navigation"><span class="tocnumber">4.2</span> <span class="toctext">イメージウィンドウナビゲーション</span></a></li>
<li class="toclevel-2 tocsection-18"><a href="#Image_Resize"><span class="tocnumber">4.3</span> <span class="toctext">画像のサイズ変更</span></a></li>
<li class="toclevel-2 tocsection-19"><a href="#Mini_Toolbars_for_Image_Window"><span class="tocnumber">4.4</span> <span class="toctext">イメージウィンドウのミニツールバー</span></a></li>
<li class="toclevel-2 tocsection-20"><a href="#ROIs_in_the_Image_Window"><span class="tocnumber">4.5</span> <span class="toctext">イメージウィンドウのROI</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-21"><a href="#Profiling_Matrix_Data"><span class="tocnumber">5</span> <span class="toctext">行列データのプロファイル</span></a></li>
<li class="toclevel-1 tocsection-22"><a href="#Setting_Matrix_Values"><span class="tocnumber">6</span> <span class="toctext">行列値の設定</span></a></li>
<li class="toclevel-1 tocsection-23"><a href="#Manipulation_of_Matrix_Data"><span class="tocnumber">7</span> <span class="toctext">行列データの操作</span></a></li>
<li class="toclevel-1 tocsection-24"><a href="#Changing_the_Color_Scheme_of_a_Matrix"><span class="tocnumber">8</span> <span class="toctext">行列の配色変更</span></a></li>
<li class="toclevel-1 tocsection-25"><a href="#Converting_Matrixes_to_Worksheets"><span class="tocnumber">9</span> <span class="toctext">行列をワークシートに変換 </span></a>
<ul>
<li class="toclevel-2 tocsection-26"><a href="#Direct"><span class="tocnumber">9.1</span> <span class="toctext">形状のまま</span></a></li>
<li class="toclevel-2 tocsection-27"><a href="#XYZ_Columns"><span class="tocnumber">9.2</span> <span class="toctext">XYZ列</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-28"><a href="#Converting_Worksheets_to_Matrixes"><span class="tocnumber">10</span> <span class="toctext">ワークシートを行列に変換 </span></a></li>
<li class="toclevel-1 tocsection-29"><a href="#Virtual_Matrix"><span class="tocnumber">11</span> <span class="toctext">仮想行列</span></a></li>
<li class="toclevel-1 tocsection-30"><a href="#Topics_for_Further_Reading"><span class="tocnumber">12</span> <span class="toctext">詳細情報</span></a></li>
</ul>
</div>
<h2><a name="Matrixbooks.2C_Matrixsheets_and_Matrix_Objects"></a><span class="mw-headline">行列ブック、行列シート、行列オブジェクト</span></h2>
<p>行列は、XとYの値が線形にマッピングされた列と行により構成される、Z値の表形式データです。
<span class="OIndex" style="display:none">限度, 行列</span>以下は行列ブックの制限についてのサマリーです。
</p>
<table class="simple">
<tr>
<th> 最大数
</th>
<th> 32Bit OS
</th>
<th> 64Bit OS
</th></tr>
<tr>
<td>
<p><b>行列ブック内の行列シート</b><br />
<b>行列シート内の行列オブジェクト</b><br />
<b>行列のセル (Note)</b><br />
</p>
</td>
<td>
<p>1024&dagger;<br /> 65,527<br /> 90,000,000<br />
</p>
</td>
<td>
<p>1024&dagger;<br /> 65,527<br /> 90,000,000<br />
</p>
</td></tr></table>
<p>255シート以上の場合、Unicodeファイル形式 (例 *.opju) で保存する必要があります。Unicode対応のファイルは、Origin 2018 SR0より前のバージョンのOriginでは開けません。
</p>
<table class="note">
<tr>
<td><b>Note</b>: 行と列の組み合わせの積が90,000,000よりも小さい必要があります。
</td></tr></table>
<h3><a name="Naming_Matrixbooks.2C_Matrixsheets_and_Matrix_Objects"></a><span class="mw-headline">行列ブック、行列シート、行列オブジェクトの名前</span></h3>
<p><span class="OIndex" style="display:none">行列ブックの名前</span>
<span class="OIndex" style="display:none">行列ブック、名前</span>
<span class="OIndex" style="display:none">行列シート、名前</span>
<span class="OIndex" style="display:none">行列シートの名前</span>
<span class="OIndex" style="display:none">行列オブジェクト、名前</span>
<span class="OIndex" style="display:none">行列オブジェクトの名前</span>
</p>
<dl><dd><a  class="image"><img alt="Matrix Book Mult Object 2.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Matrix_Book_Mult_Object_2.png" width="524"  /></a><br /><br /></dd></dl>
<table class="dialogcontroltable">
<tr>
<th> 行列ブック
</th>
<td>
<ul><li> 行列ブックには、表示されているかどうかに関わらず、<b>ショートネーム</b>が設定されます。Origin内部のオペレーションには<b>ショートネーム</b>が使用されます。</li>
<li> <b><b>ショートネーム</b></b>は、プロジェクト内で固有で、スペースや特殊文字を含まず、アルファベットの文字(A-Z, 0-9)で始まる最大13文字まで、と制限されています。小文字を使用すると表示できますが、内部では大文字と小文字は区別されません。(そのため、行列のショートネームとしてMBOOK1 と mbook1 の両方を作成できません)</li>
<li> <b><b>ロングネーム</b></b>は、必須ではありません。プロジェクトで固有である必要はなく、スペースや特殊文字を含めることができ、始まりの文字に対する制限はありません。入力可能な文字数は、最大520以下（半角、スペースを含む）になります。</li></ul>
</td></tr>
<tr>
<th> 行列シート
</th>
<td>
<ul><li> シートの<b>名前</b>は、行列ブック内で固有で32文字に制限されます。</li>
<li> スペースと数字を含めることができます。</li>
<li> <b>`!%&quot;|()[]{}&lt;&gt;</b>を除く特殊文字を含めることができます。</li>
<li> 文字、数値、利用可能な特殊文字を先頭にすることができます。</li>
<li> オプションで、<b>ラベル</b> や<b>コメント</b>を追加できます。</li></ul>
</td></tr>
<tr>
<th> <b>行列オブジェクト</b>
</th>
<td>
<ul><li> デフォルトでは、行列オブジェクトが作成されると、Originはそれぞれに対し、行列オブジェクトのインデックス番号を名前として設定します。このインデックス番号を変更することはできません。 </li>
<li> 行列シートの右上にある黄色のアイコン（データ用アイコン<a  class="image"><img alt="Matrix object icon data.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Matrix_object_icon_data.png" width="17"  /></a>、イメージ用アイコン<a  class="image"><img alt="Matrix object icon image.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Matrix_object_icon_image.png" width="17"  /></a>）をクリックし、<b>名前の変更</b>を選択すると、行列オブジェクトに対して任意の名称を設定可能です。または、サムネイルの下の行列オブジェクトの番号/名前をダブルクリックして、名前を入力することもできます。</li></ul>
</td></tr></table>
<h3><a name="Different_Views_of_the_Matrix"></a><span class="mw-headline">行列データのさまざまな表示方法</span></h3>
<p><span class="OIndex" style="display:none">行列, データモード対イメージモード</span> <span class="OIndex" style="display:none">関心範囲（ROI）</span><span class="OIndex" style="display:none">イメージ、行列</span>ワークシートでは、データセットは1つの列に含まれ、一つの列がXデータ、Yデータ、Zデータ、エラー、ラベルデータとして構成されます。Originの行列では、データセットは行と列の指定された次元に配置されます。そして、行列には1つの<b>Z</b>値のデータセットが含まれます。 
</p>
<ul><li> 行列の列はXデータを線形間隔でマッピングします。 </li>
<li> 行列の行はYデータを線形間隔でマッピングします。 </li></ul>
<p><br />
行列ウィンドウには、行と列の表示モードが2通りあります。
</p>
<ul><li> デフォルトで、行列の行と列のヘッダは、行と列のインデックス番号 で表示します。( <b>表示：行/列を表示</b> または、<b>Ctrl+Shift+C</b>を押す) </li>
<li> この表示設定は、メインメニューの<b>表示：X/Yを表示</b>（または<b>Ctrl+Shift+X</b>）を選択して、行と列に対するXとYの値を表示するように変更可能です。表示されたXとYの値は、それぞれの<b><b>開始</b></b>と<b><b>終了</b></b>の値と、列や行の数の線形補間により算出されます。</li></ul>
<dl><dd><a  class="image"><img alt="Matrix Row Index vs XYValues.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Matrix_Row_Index_vs_XYValues.png" width="602"  /></a></dd></dl>
<p><br />
行と列に対する2つの表示モードに加え、<a class="external text" href="../../QuickHelp/QuickHelp/What_is_the_difference_between_data_and_image.html">2つの行列データの表示モード</a>があります。
</p>
<ul><li> データモード（<b><b>表示：データモード</b></b>あるいは<b>Ctrl+Shift+D</b>を押す）では、行列オブジェクトは値として表示します。</li>
<li> イメージモード（<b><b>表示：イメージモード</b></b>あるいは<b>Ctrl+Shift+I</b>を押す）では、行列のデータタイプにより、行列オブジェクトはグレースケールまたはカラーの画像を表示します。RGB値はカラー画像をとして表示されますが、実数または複素数の行列はグレースケールとして表示されます。<br /><br /></li></ul>
<dl><dd><a  class="image"><img alt="Datamode imagemode.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Datamode_imagemode.png" width="723"  /></a></dd></dl>
<p><br />
</p>
<table class="note">
<tr>
<td><b><b>Note</b></b>：行列オブジェクトが画像の場合、表示モードとしてイメージモード（<b><b>表示：イメージモード</b></b>）またはデータモード（<b><b>表示：データモード</b></b>）のどちらに設定していても、オブジェクトアイコンは<a  class="image"><img alt="Matrix object icon image.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Matrix_object_icon_image.png" width="17"  /></a>のように表示されます。同様に、数値データを行列にインポートすると、<b>表示</b>モードに関係なく、オブジェクトアイコンは<a  class="image"><img alt="Matrix object icon data.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Matrix_object_icon_data.png" width="17"  /></a>のように表示されます。
</td></tr></table>
<h3><a name="Matrixbooks"></a><span class="mw-headline">行列ブック</span></h3>
<p><span class="OIndex" style="display:none">行列オブジェクト</span><a href="../../GettingStarted/OriginLab/Workbooks_Worksheets_Columns.html#Workbooks" title="OriginLab:ワークブック、ワークシート、列">ワークブック</a>と同様、行列ブックもカスタム可能なテンプレート（.otmuファイル）から作成されています。行列テンプレートには、行列ブック内のシートの数、行列シートの名前、次数、データ型、数学関数、インポート方法、表示属性や表示フォーマットなどの設定項目を保存されています。 
</p><p>新しく行列ブックを作成すると、ブックはMBook<i>N</i>（<i>N</i>：ウィンドウの作成順）と命名されます。ブック名とともに、&quot;:1/3&quot;のように表示されますが、最初の数字は、アクティブな行列オブジェクトを意味し、2番目の数字は、アクティブな行列ブックが持つオブジェクト数を意味しています。上記の例に従って、行列の右側にある黄色のオブジェクトアイコンをクリックすると、メニューに3つの行列オブジェクトが表示されます。最初にあるチェックマークが付いているオブジェクトがアクティブなオブジェクトです（下図の場合、数値は入力されていません）。
</p>
<dl><dd><a  class="image"><img alt="Matrix window gsb.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Matrix_window_gsb.png" width="540"  /></a></dd></dl>
<p><br />
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Tip_icon.png" width="57"  border="0" /></td><td><p>ワークシートのタブを右クリックして<b>シートとして行列を追加</b>をクリックし、行列ブックをワークブックに挿入することができます。これは、3D曲面フィットや3Dプロット操作などの行列ベースの操作を含む<a href="../../GettingStarted/OriginLab/Workbooks_Worksheets_Columns.html#Workbooks_for_Analysis_and_Reporting" title="OriginLab:ワークブック、ワークシート、列">分析テンプレート</a>を作成するときに役立ちます。
<p><br />
</p>
</p>
<dl><dd><a  class="image"><img alt="Workbook add matrix.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Workbook_add_matrix.png" width="236"  /></a></dd></dl>
</td></tr></table>
<h3><a name="Matrixsheets"></a><span class="mw-headline">行列シート</span></h3>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Tip_icon.png" width="57"  border="0" /></td><td><p>Origin2018より前のバージョンでは、255シートまでしか行列ブックに含めることができませんでした。現在は、1024シートまで増えました。行列ブック内に255シート以上ある場合、Unicode形式のファイル(opju, ogmu, etc)で保存する必要があります。
</p></td></tr></table>
<p>行列ブックは、最大1024個の行列シートを含めることができます。デフォルトのOriginテンプレート（ORIGIN.otmu）は、32行 32列の行列シート1つを持ちます。それぞれの行列シートの次数（行と列の数、およびXとYの範囲）は変更可能です。
</p><p>行列シートの次数を変更する方法
</p>
<ol><li> タブをクリックしてシートをアクティブにし、<b>行列: 次数/ラベルの設定</b>を選択します。これにより、<b>行列次数/ラベルの設定</b>ダイアログボックスが開きます。</li>
<li> テキストボックスに、行数(X)と列数(Y)を入力します。</li>
<li> さらに、X（列）とY（行）の<b>開始</b>と<b>終了</b>の値を設定します。</li></ol>
<p><br />
</p>
<table class="note">
<tr>
<td><b><b>Not</b>e：</b>行列データのXとY座標は、等間隔であると見なされます。最初のXは行列の最初の列に、最後のXは行列の最後の列にマッピングされます。それ以外の列のX座標は線形にマッピングされます。行に対しても同様にマッピングされ、<b><b>開始</b></b>と<b><b>終了</b></b>のYが使われます。行列のセルに対応するポイントに対して、3D空間の位置は、セルに保存されたZ値だけでなく、このセルのXとY座標によって決められます。そのため、行列データがプロットまたは分析されると、行および列の番号ではなく、XY座標が使われます。
</td></tr></table>
<h3><a name="Matrix_Objects"></a><span class="mw-headline"><b>行列オブジェクト</b></span></h3>
<p>行列シートには最大65,504の行列オブジェクトを含めることができます。実際の制限はシステムリソースで決まるので、それより小さいと考えられます。ひとつのシート内のオブジェクトは、同じ列（X）/行（Y）の次数とヘッダを持ちますが、各オブジェクトはそれぞれの<a class="external text" href="../../UserGuide/UserGuide/Matrix_Object_headers.html">Zヘッダ</a>を持ちます。その他の行列オブジェクトのプロパティは、内部データ型および数値の表示オプションを含みます。
</p><p>行列オブジェクトのプロパティは、ユーザ・インターフェースである、<b>行列プロパティ</b>ダイアログボックスで設定します。ダイアログボックスを開くには
</p>
<ol><li> 行列オブジェクトをアクティブにします。（<a href="#Matrixbooks">オブジェクトメニュー</a>の中にチェックマークが表示されます。）</li>
<li> メニューから<b>行列：セル属性の設定</b>を選択します。 </li></ol>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Tip_icon.png" width="57"  border="0" /></td><td><p>ダイアログボックス上部に配置された<b>&lt;&lt;戻る</b>、<b>進む&gt;&gt;</b>ボタンを使用すれば、複数の行列オブジェクトそれぞれに設定を行う際、毎回ダイアログを閉じずに編集できます。
</p>
<dl><dd><a  class="image"><img alt="Apply properties other matrices.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Apply_properties_other_matrices.png" width="305"  /></a></dd></dl>
</td></tr></table>
<h3><a name="Import_Image_to_Matrix"></a><span class="mw-headline">行列に画像をインポート</span></h3>
<p>Originには、マルチフレーム画像をインポートするための2つの構造があります。行列ウィンドウと<a href="#Image_Window">イメージウィンドウ</a>です。行列ウィンドウは、データ分析タスク（曲面フィッティング、統計、データの数学変換など）や一部のグラフ化操作の実行に適していますが、次の点に注意が必要です。
</p>
<ul><li> 画像を行列にインポートした場合、他の行列データと同様に、「データモード」（<b>表示：データモード</b>）と「イメージモード」（<b>表示：イメージモード</b>）を切り替えることができます。</li>
<li> ただし、以下のシーケンスの2番目のウィンドウに示されているように、<a class="external text" href="../../UserGuide/UserGuide/Conversion.html">データに変換</a>されない限り、行列にはRGB値が含まれます（表示モードに関係なく）。 </li>
<li> 特定の分析または作図操作（<a class="external text" href="../../UserGuide/UserGuide/Fitting_2D_Surfaces_(OriginPro_Only).html">非線形行列フィット</a>や<a class="external text" href="../../UserGuide/UserGuide/Image_Plot.html">イメージプロットの作成</a>など）を実行するには、あらかじめ、<b>イメージ：変換：データに変換</b>を選択して、行列をZ値に変換する必要があります。</li></ul>
<dl><dd><a  class="image"><img alt="UG matrix image convert.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/UG_matrix_image_convert.png" width="800"  /></a></dd></dl>
<p>詳細は、Originヘルプファイルの<a class="external text" href="../../UserGuide/UserGuide/Conversion.html"><b>画像変換</b></a>を参照してください。
</p><p><br />
<i><b>画像または画像のスタックを行列ウィンドウにインポートする方法</b></i>
</p>
<ol><li> 行列ウィンドウをアクティブにして、<b>データ：ファイルからインポート：イメージファイルを行列へインポート</b>を選択します。</li>
<li> <b>イメージファイルを行列へインポート</b>(<b>impImage</b>)ダイアログが開きます。<b>グレースケールGeoTIFFをデータとしてインポートする</b>、<b>イメージサムネイルを表示する</b>など、複数ファイルのインポート処理を行うためのコントロールを利用できます。</li></ol>
<dl><dd><a  class="image"><img alt="UG impImage dlg.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/UG_impImage_dlg.png" width="567"  /></a></dd></dl>
<h4><a name="Image_Thumbnails_and_Image_Slider"></a><span class="mw-headline">イメージサムネイルとスライダ</span></h4>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Tip_icon.png" width="57"  border="0" /></td><td><p>マルチフレームのTIFファイルをインポートする場合、サムネイル/スライダの表示はシステム変数<a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#M"><b>@MSS</b></a>（デフォルト値= <i>10</i>）によって制御されます。
</p>
<ul><li> シートに1つのフレームしかない場合は、サムネイル/スライダーを表示しません。</li>
<li> 1 &lt; フレーム数 &lt; 10の場合、サムネイルを表示します</li>
<li> フレームが10を超える場合は、スライダーを表示します</li></ul>
</td></tr></table>
<p><br />
シートに複数のオブジェクトが含まれている場合、行列ウィンドウの上部にあるスペースに一連のサムネイルとしてそれらのオブジェクトを表示できます。
</p>
<ol><li> 行列ウィンドウのタイトルバーを右クリックして、<b><b>イメージサムネイルの表示</b></b>を選び、有効にします。</li></ol>
<dl><dd><a  class="image"><img alt="UG Show Image Thumbnails.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/UG_Show_Image_Thumbnails.png" width="638"  /></a></dd></dl>
<p><br />
または、スライダコントロールを使用して、アクティブな行列シートでこれらのオブジェクトを表示することもできます。 
</p>
<dl><dd><a  class="image"><img alt="UG Matrix Slider Enabled.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/UG_Matrix_Slider_Enabled.png" width="392"  /></a></dd></dl>
<p><br />
ウィンドウ上部のスペースにサムネイル画像が表示されている場合は、次の手順でスライダに切り替えることができます。
</p>
<ol><li> サムネイル間のスペースにカーソルを合わせ、カーソルがグリッドアイコン<a  class="image"><img alt="UG sheet toolbar cursor 2.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/UG_sheet_toolbar_cursor_2.png" width="20"  /></a>に変わったら、クリックしてミニツールバーのページを表示します（行列画像の右側の灰色の領域をクリックすることもできます）。 </li>
<li> <b>スライダまたはサムネイル</b>を切り替えて、スライダまたはサムネイルを表示します。
<dl><dd><a  class="image"><img alt="UG MT Matrix Slider Thumbnail.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/UG_MT_Matrix_Slider_Thumbnail.png" width="403"  /></a></dd></dl></li>
<li> 同様に、<b>イメージセレクタ</b>ボタンをクリックすると、サムネイルとスライダの<i>両方</i>をオフにできます<b>イメージを表示</b>ボタンをクリックして、<b>データモード</b>と<b>イメージモード</b>を切り替えます。 </li></ol>
<dl><dd><dl><dd><a  class="image"><img alt="UG image-related-toggles.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/UG_image-related-toggles.png" width="404"  /></a></dd></dl></dd></dl>
<h4><a name="Naming_Matrix_Objects"></a><span class="mw-headline">行列オブジェクトの名前付け</span></h4>
<p>行列オブジェクトに名前付け可能です。
</p>
<ol><li> 行列をアクティブにして、<b>データ：名前の定義</b>を選択します。</li>
<li> 行列の<b>名前</b>を入力し、任意で<b>スコープ</b>を設定して、<b>コメント</b>を追加します。</li></ol>
<p><b>行列：セル値の設定</b>で開くダイアログで名前付き範囲を使用できます（たとえば、同じ次元の他の行列オブジェクトに対して数学演算を実行するなど）。
</p>
<h4><a name="Import_GeoTIFF_to_Matrix"></a><span class="mw-headline">行列にGeoTIFFをインポート</span></h4>
<p>GeoTIFFは、空間情報をTIFFファイルに保存し、マッピングに適用できるパブリックドメインの画像形式です。OriginはGeoTIFFファイルを行列および<a href="#Import_GeoTIFF_as_Image">イメージウィンドウ</a>の両方へのインポートできます。
</p><p><br />
<i><b>GeoTIFFファイルをアクティブな行列にインポート</b></i>
</p>
<ol><li> <b>データ: ファイルからインポート: イメージファイルを行列へインポート</b>をクリックします。</li>
<li> イメージダイアログ(impImage),で、<b>グレースケールGeoTIFFをデータとしてインポートに</b>チェックを付けて<b>OK</b>をクリックします。</li></ol>
<p><a  class="image"><img alt="UG impImage GeoTIFF.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/UG_impImage_GeoTIFF.png" width="574"  /></a>
</p><p>詳細は、Originヘルプの<a class="external text" href="../../UserGuide/Category/Geotiff_Importing_and_Processing.html"><b>GeoTIFFのインポートと処理</b></a>を参照してください。
</p>
<h2><a name="Extracting_Information_from_the_Matrixsheet_or_Object"></a><span class="mw-headline">行列シートまたはオブジェクトから情報を抽出</span></h2>
<p>行列シートまたは行列オブジェクトをイメージモード（<b>表示：イメージモード</b>）で表示する場合、<b>関心領域</b>（<b>ROI</b>）ツールを使用して行列から情報を抽出できます。
</p>
<ol><li> <b>ツール：ツールをROIとして表示</b>から、メニュー項目の横にチェックマークがあることを確認します。そうでない場合は、この項目をクリックするか、CTRL + SHIFT + Tを押してROIツールを有効にします。 </li>
<li> <b>プロット操作・オブジェクト作成</b>ツールバーに表示されたROIツール（<b>四角形ツール</b> <a  class="image"><img alt="ROI rectangle tool.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/ROI_rectangle_tool.png" width="22"  /></a>など）をクリックし、フライアウトメニューからROI形状（長方形、円、ポリゴン、領域）を選択します。または、既存のROIがない場合はイメージ上で右クリックして、<b>ROIを追加</b>を選択しても追加できます。</li>
<li> マウス操作で画像上の領域をドラッグし（右クリックメニューから追加した場合は不要）、ダブルクリックして選択します。選択後、さらにクリックしてROIを回転、拡大、または傾斜させることができます。 </li>
<li> 行列イメージ上を右クリックして<b>ROIを追加</b>を選択する方法でも、<b>プロット操作・オブジェクト作成</b>ツールバーボタンを使った方法でも複数のROIボックスを追加できます。ツールバーボタンで複数のROIを追加する場合は、各ROI作成の際に名前を変更する必要があります。名前を変更しない場合、新しいROIを作成した際に削除されます。ROI上でダブルクリックしてダイアログを開き、<b>名前</b>を変更できます。既存の<b>名前</b>の末尾に番号を追加するのが簡単です。 </li>
<li> ROIを右クリックして、ショートカットメニューからオプションを選択します。選択したROIを削除するには、Deleteキーを押します。
<ul><li> <b>トリミング</b>：ROIを含む最小の四角形の領域に画像をトリミングします。デフォルトでは、ROI外の値は黒で表示されます（データモードではゼロ値）。</li>
<li> <b>コピー</b>: 四角形のみ。ROIから画像を作成します。</li>
<li> <b>クリア</b>: ROI内のデータをクリアします。TIFFスタック、<a class="external text" href="../../UserGuide/UserGuide/NetCDF_Manipulating.html#Clear_Data_in_ROI">NetCDF data</a>でのみ利用可能です。それ以外の場合はグレーアウトして利用できません。 </li>
<li> <b>ROIを追加</b>: ROIを追加します。名前が重複しないように、必要応じて名前の末尾に番号を付けてから追加します。</li>
<li> <b>位置のコピー</b>：選択したROIの位置をコピーします。</li>
<li> <b>位置の貼り付け</b>：選択したROIの位置を別のROI（幅、高さ...など）に貼り付けます。 </li>
<li> <b>ROIのエクスポート</b>：ROIオブジェクトを保存します。</li>
<li> <b>ROIのインポート</b>：オブジェクトを保存された.ROIファイル内のオブジェクトに置き換えます（ヒント：インポートする「ダミー」ROIを作成します）。</li>
<li> <b>XYからROIを作成</b>: <b>XYからROIを作成</b> (<a class="external text" href="../../XFunction/X-Function/Xy2roi.html">xy2roi</a>) ダイアログを開き、ROIを作成したいXY座標を指定します。</li>
<li> <b>全ROIをクリア</b>: 行列シートからROIを全て削除します。</li>
<li> <b>新規作成</b>：<b>mroi2mat</b>ツールを使用して、ROIから新しい行列を生成します。</li>
<li> <b>XYZとしての抽出</b>：<b>mroi2xyz</b>ツールを使用して、XYZ値の新しいワークシートを生成します。</li>
<li> <b>強度プロファイル</b>：<b>mroiprofile</b>ツールを使用して、ROIの統計を生成します。</li>
<li> <b>データに変換</b>: RGB画像をデータに変換します。</li>
<li> <b>グレースケールに変換</b>: RGB画像をグレースケールに変換します。</li>
<li> <b>複素イメージの表示</b>: 複合画像のコンポーネントを表示します。</li></ul></li></ol>
<p><br />
</p>
<dl><dd><a  class="image"><img alt="Matrix image crop.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Matrix_image_crop.png" width="777"  /></a></dd></dl>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Tip_icon.png" width="57"  border="0" /></td><td><p><a href="../../GettingStarted/OriginLab/The_Origin_Interface.html#The_Status_Bar" title="OriginLab:Originのインターフェース"><b>ステータスバー</b></a>にROI統計が自動で表示されます。ステータスバーを右クリックして統計の表示、非表示を切り替えできます。
</p>
<dl><dd><a  class="image"><img alt="UG ROI mat stat.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/UG_ROI_mat_stat.png" width="719"  /></a></dd></dl>
</td></tr></table>
<h2><a name="Image_Plot"></a><span class="mw-headline">イメージプロット</span></h2>
<p>行列内のデータを<b>イメージプロット</b>としてプロットすることができます。軸スケールは、行列のXY座標によって決定されます（行列がアクティブな場合は、<b>表示：X/Yを表示</b>を選択します）。 
</p><p>画像を行列にインポートする場合（<b>データ：ファイルからインポート：イメージファイルを行列にインポート</b>）、イメージプロット（<b>作図：等高線図：イメージプロット</b>）を作成する前に、まず画像をデータに変換する必要があります（<b>イメージ：変換：データに変換</b>）。
</p>
<ol><li> 行列ウィンドウをアクティブにして、<b>作図：等高線：イメージプロット</b>を選択します。</li></ol>
<dl><dd><a  class="image"><img alt="Image plot generic.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Image_plot_generic.png" width="507"  /></a></dd></dl>
<p>デフォルトでは、イメージプロットは、行列イメージモード（<b>表示：イメージモード</b>）と同じカラーマップ、Zスケール範囲、および欠損値の色を使用します。下記の<a href="#Manipulation_of_Matrix_Data"><b>行列：パレットをカラーマップに適用</b></a>を参照ください。
</p>
<h2><a name="Image_Window"></a><span class="mw-headline">イメージウィンドウ</span></h2>
<p>上記の<b>イメージプロット</b>は、単一の行列オブジェクトに値をプロットするために使用されます。<b>イメージウィンドウ</b>は次の目的で使用できます。
</p>
<ul><li> イメージウィンドウに開いた画像に対して、ミニツールバーを使って、反転、回転、グレースケール変換といった基本的な操作が可能です。</li>
<li> ワークシートやグラフウィンドウに挿入された画像ダブルクリックするとイメージウィンドウで画像を編集できます。</li>
<li> 一般的な「TIFFスタック」などの画像セットをインポートできます。 </li>
<li> 複数の不連続な画像ファイルをイメージスタックとしてインポートできます。</li>
<li> 動画（.avi、.mov、.mp4）ファイルを開いて再生します。</li>
<li> 1つ以上の関心領域（ROI）を定義可能で、別のROIから<b>位置をコピー</b>、<b>位置を貼り付け</b>、およびOriginの*.ROIファイル（ROIの位置情報を含むテキストファイル）に保存された位置情報の<b>エクスポート</b>/<b>インポート</b>等が可能です。</li>
<li> ワークシートまたはグラフに挿入された画像を開き、クロップ（切り取り）、コピ、ROIエクスポートなどの操作が可能です。</li></ul>
<h3><a name="Image_and_Video_Import"></a><span class="mw-headline">画像と動画のインポート</span></h3>
<ol><li> <b>ファイル：新規作成：イメージ</b> を選択し、フライアウトメニューからオプションを選択します。</li></ol>
<dl><dd><ul><li> <b>空のウィンドウ</b>：後で右クリックして<b>インポート</b>または<b>Webからインポート</b>を選択してファイルを追加できます。または、標準ツールバーの<b>新規画像</b>ボタン<a  class="image"><img alt="Button New Image.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Button_New_Image.png" width="25"  /></a>をクリックします。</li></ul>
<dl><dd><a  class="image"><img alt="UG Empty Image Windowy.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/UG_Empty_Image_Windowy.png" width="453"  /></a></dd></dl>
<ul><li> <b>画像/動画</b> (CTRL + ALT + I): ファイルの種類ドロップダウンで、画像またはビデオのファイル形式を指定します。</li></ul>
<dl><dd><a  class="image"><img alt="Image window play movie.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Image_window_play_movie.png" width="407"  /></a></dd></dl>
<ul><li> <b>複数画像ファイル</b> (CTRL + ALT + T): <a href="#Import_GeoTIFF_as_Image">GeoTIFF</a>を含む画像ファイルを複数指定してスタックとしてインポートします。結果のスタックにはデフォルトでイメージスライダが表示されます。 </li></ul>
<dl><dd><a  class="image"><img alt="Image Window Multiple File Stack.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Image_Window_Multiple_File_Stack.png" width="678"  /></a></dd></dl>
<ul><li> <b>Web画像</b> (CTRL + ALT + L): ダイアログにURLを入力してWeb上の画像にリンクします。ヒント：画像のURLは、Web画像を右クリックして、<b>画像のリンクコピー</b>または<b>画像アドレスをコピー</b>を選択します。</li></ul>
<dl><dd><a  class="image"><img alt="UG enter image url.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/UG_enter_image_url.png" width="775"  /></a></dd></dl></dd></dl>
<h4><a name="Import_GeoTIFF_as_Image"></a><span class="mw-headline">GeoTIFF を画像としてインポート</span></h4>
<p>GeoTIFFは、空間情報をTIFFファイルに保存し、マッピングに適用できるパブリックドメインの画像形式です。OriginはGeoTIFFファイルを<a href="#Import_GeoTIFF_to_Matrix">行列</a>およびイメージウィンドウの両方へのインポートできます。
</p><p><i><b>GeoTIFFファイルを画像としてインポート</b></i>
</p>
<ol><li> <b>ファイル：新規作成：イメージ：画像/動画</b>を選択してGeoTIFF画像を選択します。</li></ol>
<p><br />
<i><b>複数のGeoTIFFファイルを画像としてインポート</b></i>
</p>
<ol><li> <b>ファイル：新規作成：イメージ：複数の画像ファイル</b>を選択して複数の画像を選択します。画像はアクティブなイメージウィンドウにインポートされ、画像をスクロールするためのスライダーが追加されます。 </li></ol>
<dl><dd><a  class="image"><img alt="UG GTIFF multiple slider.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/UG_GTIFF_multiple_slider.png" width="611"  /></a></dd></dl>
<dl><dd><ul><li> すべての画像が同じサイズである必要があります。</li>
<li> 負の数（例：-999）は欠落値として扱われます。 </li>
<li> イメージウィンドウのミニツールバーに、<b>欠損値の色</b>を設定するためのボタンがあります。 </li>
<li> <b>イメージ：行列に変換</b>を使用して、複数のGeoTIFFファイルを含むイメージウィンドウを行列に変換します。スタック内の各画像は、出力行列内の<a href="#Matrix_Objects">オブジェクト</a>になります。</li></ul></dd></dl>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Tip_icon.png" width="57"  border="0" /></td><td><p>ウィンドウの上端をクリックして、ミニツールバーを表示します。
</p></td></tr></table>
<p><br />詳細は、Originヘルプの<a class="external text" href="../../UserGuide/Category/Geotiff_Importing_and_Processing.html"><b>GeoTIFFのインポートと処理</b></a>を参照してください。
</p>
<h4><a name="Image_Import_Notes"></a><span class="mw-headline">画像インポートに関するメモ</span></h4>
<ul><li> Originのプロジェクトファイルのサイズを制御するために、イメージウィンドウの画像を右クリックして<b>ファイルのリンク</b>を有効にします。これによりウィンドウに画像へのリンクが保存されますが、プロジェクトからは画像が除外されます。保存したプロジェクトを再度開いたとき、ウィンドウが空の状態で表示されますが、画像を再インポートすることができます（CTRL + 4キーを使用するか、ショートカットメニューの<b>インポート</b>を選択）。</li>
<li> 画像の最大幅または高さが800ピクセルより小さいとき、デフォルトで<b>実際のサイズモード</b>が有効になっています。このしきい値はシステム変数<a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#H.2CI.2CJ.2CK"><b>@IWP</b></a>を使って調整できます。システム変数の値を変更する方法についてはこの<a class="external text" href="../../QuickHelp/QuickHelp/How_do_I_permanently_change_the_value_of_a_system_variable.html">FAQ</a>を参照してください。</li></ul>
<h3><a name="Image_Window_Navigation"></a><span class="mw-headline">イメージウィンドウナビゲーション</span></h3>
<p><b>表示</b>メニュー、あるいは、イメージウィンドウの<b>ミニツールバー</b>で画像情報の表示およびナビゲーションコントロールを有効/無効にできます（<b>なし</b>、<b>サムネイル</b>、<b>動画</b>、<b>スライダー</b>）
</p><p><a  class="image"><img alt="UG Image Window Toggle Nav Display.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/UG_Image_Window_Toggle_Nav_Display.png" width="690"  /></a> 
</p><p>同じミニツールバーボタンがGeoTIFF画像でも表示されます。 
</p>
<dl><dd><dl><dd><a  class="image"><img alt="UG GTIFF multiple stack nav.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/UG_GTIFF_multiple_stack_nav.png" width="606"  /></a></dd></dl></dd></dl>
<p><br />
<i><b>動画ナビゲーション用の追加のキーボードコントロール</b></i>
</p>
<ul><li> 左右の矢印キーを押すと、フレームが1つずつ移動します。</li>
<li> Shift + 矢印キーでフレームが5つずつ移動します。</li>
<li> Shift + Ctrl + 矢印キーでフレームが20つずつ移動します。</li></ul>
<h3><a name="Image_Resize"></a><span class="mw-headline">画像のサイズ変更</span></h3>
<p>補間手法を選択して画像のサイズを変更するには、次のように操作します。
</p>
<ol><li> イメージウィンドウをアクティブにして、メインメニューから<b><b>イメージ：サイズ変更</b></b></li>
<li> <b>補間手法</b>（最近傍、双一次、双三次、Pixel Area Relation、Lanczos）を含むオプションを選択し、<b>OK</b>をクリックします。</li></ol>
<dl><dd><dl><dd><a  class="image"><img alt="UG cvResize dialog.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/UG_cvResize_dialog.png" width="330"  /></a></dd></dl></dd></dl>
<h3><a name="Mini_Toolbars_for_Image_Window"></a><span class="mw-headline">イメージウィンドウのミニツールバー</span></h3>
<p>ミニツールバーボタンは、回転、反転、グレースケールへの変換などの簡単な画像操作を実行するために使用できます。
</p>
<dl><dd><a  class="image"><img alt="UG MT Image Window Buttons.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/UG_MT_Image_Window_Buttons.png" width="709"  /></a></dd></dl>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Tip_icon.png" width="57"  border="0" /></td><td><p>スタイルツールバーの<b>パレット</b>ボタン<a  class="image"><img alt="Button Palette.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Button_Palette.png" width="23"  /></a>を使用して、グレースケール画像にカラーパレットを適用できます。<b>さらに他のパレット</b>をクリックして<a href="../../GettingStarted/OriginLab/Customizing_Graphs.html#Color_Manager" title="OriginLab:グラフの編集"><b>カラーマネージャー</b></a>ダイアログボックスを開き、さらにパレットを追加できます。
</p></td></tr></table>
<h3><a name="ROIs_in_the_Image_Window"></a><span class="mw-headline">イメージウィンドウのROI</span></h3>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Tip_icon.png" width="57"  border="0" /></td><td><p>背景​​画像に対してROI が見にくい場合は、ROI を選択し、スタイルツールバーの <b>線/境界の色</b>ボタン<a  class="image"><img alt="Button Line Border Color.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Button_Line_Border_Color.png" width="23"  /></a>を使って色を変更できます。
</p></td></tr></table>
<p>プロット操作・オブジェクト作成ツールバーの<b>四角形ツール</b><a  class="image"><img alt="ROI tool.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/ROI_tool.png" width="19"  /></a>を使って、イメージウィンドウに複数の関心領域を定義できます。
</p>
<ol><li> ツールを選択し、ドラッグしてROIを作成します。追加したら、オブジェクトを選択して青い選択ハンドルをドラッグすることで、サイズと位置を調整できます。</li>
<li> 画像に<i>複数の</i>ROIを追加するには、<b>矩形ツール</b>をクリックしてドラッグしてROIを追加します。または、画像を右クリックし、<b>ROI追加</b> (CTRL + Q) を選択するか、イメージウィンドウのミニツールバーの<b>ROIを追加</b>ボタンを使用します。どの方法で追加する場合も、追加した ROI の名前を変更する必要があります。ROI をダブルクリックし、一意の名前を付けることで新たなROIを追加できます。 </li></ol>
<dl><dd><dl><dd><a  class="image"><img alt="UG ROI Position Dialog.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/UG_ROI_Position_Dialog.png" width="358"  /></a></dd></dl></dd></dl>
<p>ROI を右クリックすると、次のようなコンテキストメニューが表示されます。
</p>
<dl><dd><dl><dd><a  class="image"><img alt="Image window ROI context menu.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Image_window_ROI_context_menu.png" width="758"  /></a></dd></dl></dd></dl>
<dl><dd><dl><dd><ul><li> <b>切り出し</b>：画像をグラフから開いたときに使用できます（グラフ画像をダブルクリックするなど）。これにより、グラフ画像がイメージウィ​​ンドウのROIに切り出されます。元のグラフ画像のサイズは、切り出された領域のサイズに縮小されます。グラフウィンドウで画像全体を復元するには、ROIの外側を右クリックして、<b>クリッピングを削除</b>を選択します。</li>
<li><b>切り取り</b>：イメージウィンドウ画像とグラフ画像（存在する場合）をROIにトリミングします。グラフ画像のサイズと位置は保持されます。 </li>
<li><b>コピー</b>：ROIを画像としてコピーできます。Origin内の他のウィンドウに貼り付けることができます。 （例：グラフまたはワークシートウィンドウ、または他のアプリケーションへ）マルチフレーム画像の場合、アクティブなフレームのみがコピーされます。</li>
<li><b>スケールをグラフに適用する</b>：<b>イメージウィンドウからの画像</b>でグラフにイメージが挿入されているときに利用できます。これにより、グラフ画像がイメージウィンドウ ROIに更新されます。 </li>
<li><b>位置をコピー</b>：ROIボックス座標の4つの頂点をコピーします。プレーンな数値として貼り付けるか、別のROIボックスに<b>位置を貼り付ける</b>かを選択できます。後のオプションでは、ROIの<b>幅</b>/<b>高さ</b>、または<b>水平</b>/<b>垂直</b>位置のみを貼り付けを選択できます。  </li>
<li><b>ROIをエクスポート</b>：詳細（ROI名、頂点の位置など）を.ROIファイルに保存します。</li>
<li> <b>ROIをインポート</b>：以前に保存したROIの詳細を、選択したROIに適用します。 </li>
<li> <b>XYからROIを作成</b>: XY座標（境界）とインデックスデータのセットから、任意の形状の新しいROIボックスを作成します。グレースケール画像のみサポートしています。<a class="external text" href="../../UserGuide/UserGuide/NetCDF_Manipulating.html#Create_ROI_from_XY">NetCDFデータのXYからROIを作成する</a>もご覧ください。</li>
<li><b>リンク画像を作成</b>：ROIを新しいイメージウィンドウに出力します。ROIを変更した場合は、新しいイメージウィンドウが更新されます。</li>
<li><b>リンク行列を作成</b>: ROIデータを新しい行列ウィンドウに出力します。イメージウィンドウ ROI への変更は行列に渡されます。これにより、イメージウィンドウでは実行できず、行列への変換が必要な多くの解析および統計処理操作を簡単に実行できます。</li></ul></dd></dl></dd></dl>
<h2><a name="Profiling_Matrix_Data"></a><span class="mw-headline">行列データのプロファイル</span></h2>
<p><span class="OIndex" style="display:none">行列データのプロファイル</span> <span class="OIndex" style="display:none">行列,プロファイル</span> <span class="OIndex" style="display:none">プロファイルイメージ</span>
</p><p>行列データは、水平、垂直、任意の直線を使用して、画像データのプロファイルを表示することができます。
</p>
<ol><li> 行列オブジェクトをアクティブにして、メニューから<b>作図: 2D: プロファイル: イメージプロファイル</b>を選択します。 </li></ol>
<p>これによりイメージプロットが作成され、<b>イメージ/等高線プロファイル</b>ダイアログボックスが開きます。このダイアログは、XやYのプロファイル線を指定したり、任意の直線の配置や表示を制御します。なお、このダイアログボックスはインタラクティブです。ダイアログを閉じなくても、プロファイル線の調節やグラフ要素の編集といったイメージプロファイルの編集が可能です。ダイアログボックスを閉じた後、グラフウィンドウの右上に<b>プロファイル...</b>ボタンが表示されるので、このボタンをクリックすると、<b><b>イメージ／等高線プロファイル</b></b>ダイアログを再度開くことができます。<br />
</p>
<dl><dd><a  class="image"><img alt="Image profile XY.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Image_profile_XY.png" width="601"  /></a></dd></dl>
<h2><a name="Setting_Matrix_Values"></a><span class="mw-headline">行列値の設定</span></h2>
<p><span class="OIndex" style="display:none">Matrix, Set Values</span>
<span class="OIndex" style="display:none">Set Matrix Values</span>
<b>値の設定</b>ダイアログボックスは、行列オブジェクトのデータを作成したり変換する際に使用できます。 
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Tip_icon.png" width="57"  border="0" /></td><td><p>行列オブジェクトに名前を割り当て、<b>セル値の設定</b>で使用できます（たとえば、同じ次元の他の行列オブジェクトに対して数学演算を実行するなど）。 
</p></td></tr></table>
<p><b>セル値の設定</b>ダイアログを開くには、行列オブジェクトがアクティブであることを確認し、
</p>
<ol><li> メインメニューから、<b><b>行列：セル値の設定</b></b>を選択 <br /></li></ol>
<p><i>または</i> <br />
</p>
<ol><li> 左上の角（行列アイコン/名前の下にある空のセルヘッダ）をクリックして行列を選択し、右クリックし、そして、<b><b>行列のセル値の設定</b></b>を選択<br /><br /></li></ol>
<dl><dd><a  class="image"><img alt="SetValues matrix.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/SetValues_matrix.png" width="487"  /></a><br /><br /></dd></dl>
<table class="dialogcontroltable">
<tr>
<th> メニューコマンド
</th>
<td>
<ul><li> <b>計算式</b>：行列計算式ボックスに保存した計算式の情報をロードします。計算式の保存は、<b><b>計算式：保存</b></b>または<b><b>計算式：名前を付けて保存</b></b>を選択します。</li>
<li> <b><b>Mat(1)</b></b>：計算式や実行前の処理スクリプトに、他の行列オブジェクトを含める場合に使用します。(行列オブジェクト参照がカーソルの位置に挿入されます）行列ブラウザを使用して的確にオブジェクトを選択することもできます。オブジェクトは、インデックスよって一覧表示されます。</li>
<li> <b>Mat(A)</b>: Mat(1)と同様ですが、オブジェクトに名前が設定されている場合、オブジェクトのロングネームによって表示されます。</li>
<li> <b>関数</b>: OriginのLabTalk関数を挿入するために使用します（カーソルの場所に関数が挿入されます）。 </li>
<li> <b>変数</b>:<b>計算式</b>や<b>実行前の処理スクリプト</b>に変数、定数、範囲変数（選択も可能）やファイルのメタデータを挿入します。</li></ul>
</td></tr>
<tr>
<th> 行列式
</th>
<td>
<ul><li> データを生成する1行の式を追加します。関数、条件演算子、および変数を使用できます。</li></ul>
</td></tr>
<tr>
<th> 実行前の処理スクリプト
</th>
<td>
<ul><li> 行列式ボックスの式が実行される前に実行されるLabTalkスクリプト行を入力します。 </li></ul>
</td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Tip_icon.png" width="57"  border="0" /></td><td><p><b><b>値の設定</b></b>ダイアログの下部パネルの<b><b>実行前の処理スクリプト</b></b>を使用して、行列式で使いたい変数やLabTalk関数の定義します。
</p><p><b><b>関数の検索と挿入</b></b>ボタン<a  class="image"><img alt="Search Insert Functions.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Search_Insert_Functions.png" width="23"  /></a>をクリックして組み込みのLabTalk関数を検索できます。
</p></td></tr></table>
<h2><a name="Manipulation_of_Matrix_Data"></a><span class="mw-headline">行列データの操作</span></h2>
<p><span class="OIndex" style="display:none">Matrix, Manipulating Data</span>
</p>
<table class="simple" style="width: 95%">
<tr>
<th style="width: 40%">処理
</th>
<th style="width: 55%">メニュー操作
</th></tr>
<tr>
<td>
<ul><li> <a href="../../GettingStarted/OriginLab/Graphical_Exploration_of_Data.html#The_Screen_Reader_Tool" title="OriginLab:グラフィカルなデータ検索">スクリーンリーダ</a>で選択したXY座標ペアの場合、積行列スタック（複数の行列オブジェクト）のZ値をワークシートに出力します。</li></ul>
</td>
<td><b>行列：ピクセル抽出</b>
</td></tr>
<tr>
<td>
<ul><li> 行列を反転または回転します。</li></ul>
</td>
<td><b><b>行列：90度回転</b></b><br /><b><b>行列：反転：垂直</b></b><br /><b><b>行列：反転：水平</b></b>
</td></tr>
<tr>
<td>
<ul><li> 行列を4つの手法（拡張、縮小、補間、埋め込み）でサイズ変更します。</li></ul>
</td>
<td>  <b>行列：サイズ変更</b>
</td></tr>
<tr>
<td>
<ul><li> 行列を転置します。</li></ul>
</td>
<td>  <b>行列：行列の転置</b>
</td></tr>
<tr>
<td>
<ul><li> XYZ値を数式で変換して、3次元データセットを生成します。</li></ul>
</td>
<td><b>行列：グリッド作成</b>
</td></tr>
<tr>
<td>
<ul><li> X方向とY方向にスケーリングして行列を拡張します。</li></ul>
</td>
<td> <b>行列：行列の拡張</b>
</td></tr>
<tr>
<td>
<ul><li> いずれかの縮小方法を使用し、行/列の係数で行列を縮小します。</li></ul>
</td>
<td> <b>行列：行列の縮小</b>
</td></tr>
<tr>
<td>
<ul><li> パレットファイルを使用して、イメージモードで行列を変換します。システム変数を設定して、カラーパレット（<b>スタイル</b>ツールバー、<b>パレット</b>ボタン）を<i>すべて</i>の行列オブジェクト（@ MAP = 0、デフォルト）または<i>アクティブな</i>行列オブジェクトのみ（@ MAP = 1）に適用します。</li></ul>
</td>
<td><b>行列：カラーマップにパレットを適用</b>
</td></tr>
<tr>
<td>
<ul><li> 値の行列をワークシートの列に変換します（次のセクションを参照ください）。</li></ul>
</td>
<td><b>行列：ワークシートに変換</b>
</td></tr></table>
<h2><a name="Changing_the_Color_Scheme_of_a_Matrix"></a><span class="mw-headline">行列の配色変更</span></h2>
<p>ミニツールバーの<b>パレット</b>ボタン<a  class="image"><img alt="Palettes Button.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Palettes_Button.png" width="24"  /></a>と<b>欠損値の色</b>ボタン<a  class="image"><img alt="Missing Value Color.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Missing_Value_Color.png" width="24"  /></a>で行列ウィンドウの配色を変更できます。
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Tip_icon.png" width="57"  border="0" /></td><td><p>選択したパレットと欠損値の色は、アクティブな行列シート内のすべての行列オブジェクトに適用されますが、同じ行列ウィンドウ内の他のシートのオブジェクトには影響しません。
</p></td></tr></table>
<h2><a name="Converting_Matrixes_to_Worksheets"></a><span class="mw-headline">行列をワークシートに変換</span></h2>
<p><span class="OIndex" style="display:none">ワークシート, 行列から変換</span> <span class="OIndex" style="display:none">行列, ワークシートへ変換</span>
</p><p><br />
<i><b>行列をワークシートに変換する方法</b></i>
</p>
<ol><li> 行列がアクティブな状態で、<b>行列：ワークシートに変換：ダイアログを開く</b>を選択します。</li></ol>
<p><br />
行列データをワークシートデータに変換する際には、<b>形状のまま</b>と<b>XYZ列</b>の2つの方法があります。たとえば、次のような配置があるとします。
</p>
<dl><dd><dl><dd><a  class="image"><img alt="Matrix Source.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Matrix_Source.png" width="437"  /></a></dd></dl></dd></dl>
<h3><a name="Direct"></a><span class="mw-headline">形状のまま</span></h3>
<p>順序を変更せずにZの値をワークシートにコピーします。もし、M行と列の行列データである場合、変換後のワークシートデータもM行N列で出力されます。デフォルトでは、それぞれのZに対応するXY座標値はコピーされません。オプションを使用して、X座標値をワークシートの1行目またはパラメータ行に、Y座標値をワークシートの1列目に出力させることができます。
</p>
<dl><dd><dl><dd><a  class="image"><img alt="Matrix direct convert.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Matrix_direct_convert.png" width="524"  /></a></dd></dl></dd></dl>
<h3><a name="XYZ_Columns"></a><span class="mw-headline">XYZ列</span></h3>
<p>単一の行列オブジェクトがある場合、X、Y、Zの3つの列を持つワークシートを生成します。X列とY列には、X座標値とY座標値が含まれ、Z列には各XY座標のZ値が含まれます。 
</p>
<dl><dd><dl><dd><a  class="image"><img alt="Matrix wks XYZ.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Matrix_wks_XYZ.png" width="340"  /></a></dd></dl></dd></dl>
<p><br />
<i><b>この手法の場合の追加情報</b></i>
</p>
<ul><li> 行列<i>オブジェクト</i>の<b>ロングネーム</b>、<b>単位</b>、<b>コメント</b>をZ<a href="../../GettingStarted/OriginLab/Workbooks_Worksheets_Columns.html#Column_Label_Rows" title="OriginLab:ワークブック、ワークシート、列">列のラベル行</a>に保存します。</li>
<li> 変換された行列にカラー画像が含まれている場合、結果のZ列には、各行列セルのHTMLカラーの<a href="../../GettingStarted/OriginLab/Workbooks_Worksheets_Columns.html#Color_Format" title="OriginLab:ワークブック、ワークシート、列"><b>カラー</b>列</a>が表示されます。</li></ul>
<dl><dd><dl><dd><a  class="image"><img alt="UG carbmp m2w color.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/UG_carbmp_m2w_color.png" width="564"  /></a></dd></dl></dd></dl>
<p><br />
<i><b>複数行列オブジェクトを変換する場合</b></i>
</p><p><i>N</i> 個の行列オブジェクトがある場合、<b>変換</b> = <b>全オブジェクト</b>として、出力列をX、Y、Z × <i>N</i>（つまり、<i>XYZZZ ...</i>）として設定できます。
</p>
<dl><dd><a  class="image"><img alt="Matrix wks All Objects XYZZ.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Matrix_wks_All_Objects_XYZZ.png" width="413"  /></a></dd></dl>
<h2><a name="Converting_Worksheets_to_Matrixes"></a><span class="mw-headline">ワークシートを行列に変換</span></h2>
<ol><li> ワークシートをアクティブにして、<b>ワークシート：行列に変換</b>を選択し、次のいずれかの方法を選択します。</li></ol>
<p><span class="OIndex" style="display:none">ワークシート, 行列へ変換</span> <span class="OIndex" style="display:none">行列, ワークシートデータの変換</span>
</p>
<table class="simple">
<tr>
<th> 手法
</th>
<th width="200">変換の種類
</th>
<th> ノート
</th></tr>
<tr>
<td> <b>直接</b>
</td>
<td>
<ul><li> <b>列方向のX</b></li>
<li> <b>列方向のY</b></li>
<li> <b>XとYなし</b></li></ul>
</td>
<td> スプレッドシートデータの識別のため、以下を設定します。
<ul><li> 1列目にXデータ値、1行目にYデータ値、2列目からN列目および2行目からM列目までにZデータ値 </li>
<li> 1列目にYデータ値、1行目にXデータ値、2列目からN列目および2行目からM列目までにZデータ値 </li></ul>
<p><b>Note</b>: <a href="#Virtual_Matrix">下記</a>の<b>仮想行列</b>を参照ください。
</p>
</td></tr>
<tr>
<td> <b>拡張</b>
</td>
<td>
<ul><li> <b>行</b></li>
<li> <b>列</b></li></ul>
</td>
<td> 一部のASCIIファイルの場合、1行あたりの文字数に制限があります。この方法は、1行のデータを複数行に分割する必要がある場合に使用します。
<ul><li> <b><b>行</b></b>に対して拡張: 行列の1行分に相当するASCIIファイルの行数を指定します。</li>
<li> <b><b>列</b></b>に対して拡張: 行列の1列分に相当するASCIIファイルの列数を指定します。</li></ul>
</td></tr>
<tr>
<td> <b>XYZグリッディング</b>
</td>
<td>
<ul><li> <b>X/Y等間隔</b></li>
<li> <b>疎データ</b> </li>
<li> <b>ランダム (Renka Cline)</b> </li>
<li> <b>ランダム (Shepard)</b> </li>
<li> <b>ランダム (Thin Plate Spline)</b> </li>
<li> <b>ランダム (Kriging相関)</b> </li>
<li> <b>ランダム (加重平均)</b></li></ul>
</td>
<td> 変換の種類はXYの間隔によります。
<ul><li> <b>X/Y等間隔</b>は、等間隔なXYデータに対し、適用します。</li>
<li> <b>疎データ</b>は、欠損値のある場合に使用します。</li>
<li> <b>Renka-Cline</b>、<b>Shepard</b>、<b>TPS</b>、<b><b>Kriging相関</b></b>、<b><b>加重平均</b></b>はXYデータが不等間隔の場合に使用します。<b>境界外の外挿なし</b>オプションがあります。</li></ul>
<p><b>Note</b>: XYZZZ...列のあるワークシートを変換した場合、各Z列を別のオブジェクトとして追加した行列シートが作成されます。 
</p>
</td></tr>
<tr>
<td> <b>XYZ対数グリッディング</b>
</td>
<td> メソッドは<b>XYZグリッディング</b>と同じです。
</td>
<td> X、Yの対数をとり、<b>XYZグリッディング</b>を実行します。Note: XYZZZ...列のあるワークシートを変換した場合、各Z列を別のオブジェクトとして追加した行列シートが作成されます。
</td></tr></table>
<h2><a name="Virtual_Matrix"></a><span class="mw-headline">仮想行列</span></h2>
<p><span class="OIndex" style="display:none">行列、仮想</span>
<span class="OIndex" style="display:none">仮想行列</span>1つのブロックとしてワークシートセルに配置したデータを、「仮想行列」として扱うことができます。通常の行列データと同様、この仮想行列データを使って3D曲面図や等高線図のような3Dグラフを作成することができます。X、Yデータは、列やラベル行に含めることができます。行列ウィンドウは等間隔なXYデータのみに対応していますが、仮想行列の場合、XY座標値が等間隔である必要はありません（値は昇順あるいは降順である必要があります）。<br />
</p>
<dl><dd><dl><dd><a  class="image"><img alt="Viirtual matrix GSB remade.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Viirtual_matrix_GSB_remade.png" width="956"  /></a><br /></dd></dl></dd></dl>
<p><br />
</p>
<table class="note">
<tr>
<td><b>Note:</b> <a href="../../GettingStarted/OriginLab/2D_Graphs.html#Origin_Graph_Types" title="OriginLab:2Dグラフ">ワークシートの<b>XYZ</b>列データから3Dグラフ</a>を作成することも可能です。この場合も不等間隔なXY座標データをサポートしますが、「仮想行列」として扱われません。
</td></tr></table>
<h2><a name="Topics_for_Further_Reading"></a><span class="mw-headline">参考</span></h2>
<ul><li> <a class="external text" href="../../UserGuide/Category/Matrix_Books_Matrix_Sheets_and_Matrix_Objects.html">行列ブック、行列シート、行列オブジェクト</a></li>
<li> <a class="external text" href="../../UserGuide/UserGuide/Basic_Matrix_Book_and_Matrix_Sheet_Operations.html">行列ブックと行列シートの操作</a></li>
<li> <a class="external text" href="../../UserGuide/UserGuide/What_is_Saved_with_the_Matrix_Template.html">何が行列テンプレートと一緒に保存されるのか?</a></li>
<li> <a class="external text" href="../../UserGuide/UserGuide/Matrix_Sheet_Dimensions_and_XY_Coordinates.html">行列の次数とXY座標</a></li>
<li> <a class="external text" href="../../UserGuide/UserGuide/Matrix_Object_Data_Properties.html">行列オブジェクトデータのプロパティ</a></li>
<li> <a class="external text" href="../../UserGuide/Category/Setting_Matrix_Values.html">行列値の設定</a></li>
<li> <a class="external text" href="../../UserGuide/Category/Matrix_Conversion_and_Gridding.html">行列変換とグリッディング</a></li>
<li> <a class="external text" href="../../UserGuide/UserGuide/Creating_3D_and_Contour_Graphs_from_Virtual_Matrix.html">仮想行列から3Dおよび等高線グラフを作成する</a></li>
<li> <a class="external text" href="../../UserGuide/UserGuide/Viewing_and_Profiling_Matrix_Data.html">行列データの表示とプロファイル</a></li></ul>


    