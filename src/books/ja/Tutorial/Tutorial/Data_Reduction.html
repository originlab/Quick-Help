<h1 class="firstheading">データの削減</h1><p class='urlname' style='display: none'>データの削減</p>
<div id="toc" class="toc"><div id="toctitle"><h2>内容</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Summary"><span class="tocnumber">1</span> <span class="toctext">サマリー</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#What_You_Will_Learn"><span class="tocnumber">2</span> <span class="toctext">学習する項目</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Steps"><span class="tocnumber">3</span> <span class="toctext">ステップ</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Reduce_to_Evenly_Spaced_X"><span class="tocnumber">3.1</span> <span class="toctext">等間隔なXにデータを削減</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Reduce_Duplicate_X"><span class="tocnumber">3.2</span> <span class="toctext">重複するXデータを削減</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Reduce.2FCombine_Duplicate_Rows"><span class="tocnumber">3.3</span> <span class="toctext">重複する行を削減/結合</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Reduce_by_Group"><span class="tocnumber">3.4</span> <span class="toctext">グループごとに削減</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Reduce_Worksheet_Rows"><span class="tocnumber">3.5</span> <span class="toctext">ワークシートの行を削減</span></a></li>
</ul>
</li>
</ul>
</div>
<h2><a name="Summary"></a><span class="mw-headline">サマリー</span></h2>
<p>Originには、<a href="../../Tutorial/Tutorial/Data_Filter.html" title="チュートリアル:データフィルタ">データフィルタ</a>や<a href="../../Tutorial/Tutorial/Extract_Worksheet_Data.html" title="チュートリアル:ワークシートデータの抽出">ワークシートクエリ</a>といったデータ削減の機能の他に、行を削減するためのいくつかのXファンクションによる、手法の異なるデータ削減機能が用意されています。
</p>
<p class="version" >必要なOriginのバージョン: Origin 2015 SR0以降</p>
<h2><a name="What_You_Will_Learn"></a><span class="mw-headline">学習する項目</span></h2>
<p>このチュートリアルで以下のことを行います：
</p>
<ul><li>等間隔なXにデータを削減</li>
<li>重複するXデータをもつデータセットを削減</li>
<li>グループごとにXYデータを削減</li>
<li>ワークシート行を削除</li></ul>
<h2><a name="Steps"></a><span class="mw-headline">ステップ</span></h2>
<h3><a name="Reduce_to_Evenly_Spaced_X"></a><span class="mw-headline">等間隔なXにデータを削減</span></h3>
<ol><li>新しいワークブックを作成し、<a class="image"><img alt="Button Import Single ASCII.png" src="../images/Data_Reduction/Button_Import_Single_ASCII.png" width="23"  /></a>ボタンをクリックして、<i>&lt;Origin インストールフォルダ&gt;\Samples\Signal Processing</i>にある<b>Signal with High Frequency Noise.dat</b> をインポートします。 </li>
<li>B列を選択し、メインメニュー<b>解析：データ操作：データ削減：等間隔X</b>を選択しダイアログを開きます。下図のように設定します。 
<dl><dd><a class="image"><img alt="Tutorial Data Reduction 06.png" src="../images/Data_Reduction/Tutorial_Data_Reduction_06.png" width="899"  /></a></dd></dl></li>
<li> <b>OK</b>をクリックします。新たな列（C列）がワークシートに追加されました。この列にはサンプリング間隔が設定されています。列ヘッダをクリックして列を選択してから、<b>列：X列の表示</b>を選択します。<b>X列の表示：colshowx</b>ダイアログボックスで、<b>OK</b>をクリックしてサンプリング間隔を使用したX列を生成します。サンプリング間隔が広く設定され、データが削減できたことがわかります。
<dl><dd><a class="image"><img alt="Tutorial Data Reduction 07.png" src="../images/Data_Reduction/Tutorial_Data_Reduction_07.png" width="418"  /></a></dd></dl></li>
<li> <b>Ctrl</b>キーを押しながらB列とC列を選択し、<a class="image"><img alt="Button Line.png" src="../images/Data_Reduction/Button_Line.png" width="22"  /></a>ボタンをクリックすると元データ（黒い線）と削減されたデータ（赤い線）がプロットされます。 </li>
<li> データ量が大幅に削減されたのがわかります。
<dl><dd><a class="image"><img alt="Tutorial Data Reduction 08.png" src="../images/Data_Reduction/Tutorial_Data_Reduction_08.png" width="568"  /></a></dd></dl></li></ol>
<h3><a name="Reduce_Duplicate_X"></a><span class="mw-headline">重複するXデータを削減</span></h3>
<ol><li>新しいワークブックを作成し、<a class="image"><img alt="Button Import Wizard.png" src="../images/Data_Reduction/Button_Import_Wizard.png" width="23"  /></a>ボタンをクリックして<b>インポートウィザード</b>を開きます。<i>&lt;Origin インストールフォルダ&gt;\Samples\Curve Fitting\</i> にある、<b>Step01.dat</b>, <b>Step02.dat</b>, <b>Step03.dat</b> を選択します。<b>インポートモード</b>を<b>行の末尾に追加する</b>に設定し、インポートフィルタ<b>step</b>が適用されていることを確認します。<b>完了</b>ボタンをクリックして、ファイルをインポートします。</li>
<li>A,B列を選択し、メインメニュー<b>解析：データ操作：データ削減：重複X</b>を選択し、ダイアログを開きます。下図のように設定を変更します。
<dl><dd><a class="image"><img alt="Tutorial Data Reduction 09.png" src="../images/Data_Reduction/Tutorial_Data_Reduction_09.png" width="874"  /></a></dd></dl></li>
<li><b>OK</b>をクリックして設定を適用し、<b>Sheet2</b>では、重複したXデータの数がそれぞれ3であることがわかります。削減されたデータでは、重複したXに対するYデータにはすべてのYデータの合計値が入力されています。
<dl><dd><a class="image"><img alt="Tutorial Data Reduction 10.png" src="../images/Data_Reduction/Tutorial_Data_Reduction_10.png" width="423"  /></a></dd></dl></li></ol>
<h3><a name="Reduce.2FCombine_Duplicate_Rows"></a><span class="mw-headline">重複する行を削減/結合</span></h3>
<ol><li>前セクションで使用したデータのSheet1を開き、A列を選択します。メインメニューの<b>ワークシート：重複行の削除</b>と選択し<b>wdeldup</b>ダイアログを開きます。<b>重複の統合基準</b>ドロップダウンリストで平均を選択し、<b>出力ワークシート</b>の右向きの三角形ボタンをクリックして<b>&lt;新規&gt;：新しいシート</b>を選択したあと、<b>出力カウント</b>にチェックを付けて<b>OK</b>をクリックします。
<dl><dd><a class="image"><img alt="Tutorial Data Reduction 11.png" src="../images/Data_Reduction/Tutorial_Data_Reduction_11.png" width="464"  /></a></dd></dl></li>
<li>ワークシートの行全体が統合した行の平均値に削減されます。この統合は選択した列の重複を元に行われています。新しい列<b>カウント</b>がワークシート<i>wdeldup</i>末尾に追加され、それぞれのX値に対する重複データの数が出力されます。
<dl><dd><a class="image"><img alt="Tutorial Data Reduction 15.png" src="../images/Data_Reduction/Tutorial_Data_Reduction_15.png" width="474"  /></a></dd></dl></li></ol>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Data_Reduction/Tip_icon.png" width="57"  border="0" /></td><td><p><b>データ削減：重複X</b>ツールは、XYデータセットへの使用に限られ、<b>重複行の削除</b>はシート内の全てのデータに対して使用できます。 
</p><p><a class="external text" href="../../UserGuide/Category/Statistics_on_Columns.html">列の統計機能</a>を使用してXYZデータ中の重複XYデータを削減することができます。詳細は<a href="../../QuickHelp/QuickHelp/How_do_I_reduce_XY_or_XYZ_dataset.html" title="クイックヘルプ：XYまたはXYZデータをどのように削減したらよいでしょうか">クイックヘルプ</a>をご利用ください。
</p></td></tr></table>
<h3><a name="Reduce_by_Group"></a><span class="mw-headline">グループごとに削減</span></h3>
<ol><li>新しいワークブックを作成し、<a class="image"><img alt="Button Import Single ASCII.png" src="../images/Data_Reduction/Button_Import_Single_ASCII.png" width="23"  /></a>ボタンをクリックして<i>&lt;Origin インストールフォルダ&gt;\Samples\Data Manipulation </i>にある<b>Magnetization.dat</b> をインポートします。</li>
<li>A,B列を選択して<a class="image"><img alt="Button Line.png" src="../images/Data_Reduction/Button_Line.png" width="22"  /></a>ボタンをクリックし、折れ線図を作図します。</li>
<li>作図したグラフをアクティブにし、メインメニューの<b>解析：データ操作：データ削減:クラスタX</b>を選択し<b>reducexy</b> ダイアログを開きます。以下のように設定します。
<dl><dd><a class="image"><img alt="Tutorial Data Reduction 12.png" src="../images/Data_Reduction/Tutorial_Data_Reduction_12.png" width="862"  /></a></dd></dl></li>
<li><b>OK </b>をクリックして、データ削減を実行します。ソースシートの末尾に新しい列が2列追加され、削減されたデータが出力します。 
<dl><dd><a class="image"><img alt="Tutorial Data Reduction 13.png" src="../images/Data_Reduction/Tutorial_Data_Reduction_13.png" width="653"  /></a></dd></dl></li>
<li>グラフにも削減されたXYデータのプロットが追加されます。
<dl><dd><a class="image"><img alt="Tutorial Data Reduction 14.png" src="../images/Data_Reduction/Tutorial_Data_Reduction_14.png" width="581"  /></a></dd></dl></li></ol>
<h3><a name="Reduce_Worksheet_Rows"></a><span class="mw-headline">ワークシート行を削除</span></h3>
<ol><li>新しいワークブックを作成し、<a class="image"><img alt="Button Import Single ASCII.png" src="../images/Data_Reduction/Button_Import_Single_ASCII.png" width="23"  /></a>ボタンをクリックして<i>&lt;Origin インストールフォルダ&gt;\Samples\Spectroscopy </i>にある<b>Nitrite.dat</b> をインポートします。このファイルには6392のデータポイントがあります。
<dl><dd><a class="image"><img alt="Tutorial Data Reduction 01.png" src="../images/Data_Reduction/Tutorial_Data_Reduction_01.png" width="326"  /></a></dd></dl></li>
<li>Nitriteワークシートにある2列を選択して、メインメニューの<b>ワークシート：行の削減</b>と選択し、<b>wreducerows</b>ダイアログを開きます。ダイアログの設定を下図のようにします。
<dl><dd><a class="image"><img alt="Tutorial Data Reduction 02.png" src="../images/Data_Reduction/Tutorial_Data_Reduction_02.png" width="441"  /></a></dd>
<dd><b>Note</b>: <b>出力</b>の右にある矢印をクリックして<b>&lt;新規&gt;：新しい列</b>を選択すれば、削減されたデータが新たな列に出力されます。</dd></dl></li>
<li><b>OK</b>ボタンをクリックすると、10行ごとに最初の1行のみが出力されます。9割のデータが削減され、残されたデータが新たな列に出力されます。
<dl><dd><a class="image"><img alt="Tutorial Data Reduction 03.png" src="../images/Data_Reduction/Tutorial_Data_Reduction_03.png" width="489"  /></a></dd></dl></li>
<li>全ての列を選択して<a class="image"><img alt="Button Line.png" src="../images/Data_Reduction/Button_Line.png" width="22"  /></a>ボタンをクリックし、ソースデータ（黒線）と削減されたデータ（赤線）をともに作図します。
<dl><dd><a class="image"><img alt="Tutorial Data Reduction 04.png" src="../images/Data_Reduction/Tutorial_Data_Reduction_04.png" width="556"  /></a></dd></dl></li>
<li>データ削減によりピークの高さが変化しています。データの形状を維持するために、より多くのデータを残す必要があることがわかります。Graph1にある緑の鍵のアイコンをクリックして<b>パラメータの変更</b>を選択し、<b>wreducerows</b> ダイアログを開きます。<b>読み捨てる行数</b>を<b>3</b>に変更し、<b>OK</b>をクリックします。</li>
<li>これで25％のデータが保持され、グラフの形状も維持できていることがわかります。
<dl><dd><a class="image"><img alt="Tutorial Data Reduction 05.png" src="../images/Data_Reduction/Tutorial_Data_Reduction_05.png" width="556"  /></a></dd></dl></li></ol>

    