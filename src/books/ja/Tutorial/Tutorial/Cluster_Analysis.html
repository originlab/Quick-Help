<h1 class="firstheading">クラスター分析</h1><p class='urlname' style='display: none'>Cluster-Analysis</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Summary"><span class="tocnumber">1</span> <span class="toctext">概要</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Hierarchical_Cluster_Analysis"><span class="tocnumber">2</span> <span class="toctext">階層的クラスター分析</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Analyzing_Original_Data_with_K-Means_Cluster"><span class="tocnumber">3</span> <span class="toctext">元のデータをK-means法クラスターで分析する</span></a></li>
</ul>
</div>
<p><br />
</p>
<table class="simple" style="width: 80%">
<tr style="vertical-align: top;">
<td style="width: 40%"><a  class="image"><img alt="Video Image.png" src="../images/Cluster_Analysis/Video_Image.png" width="33"  /></a> <a  class="image"><img alt="Video Text Image.png" src="../images/Cluster_Analysis/Video_Text_Image.png" width="135"  /></a>
<ul><li> <a class="external text" href="https://www.originlab.com/videos/details.aspx?id=343" target="_blank">OriginProにおけるクラスター分析</a></li></ul>
</td>
<td style="width: 40%"><a  class="image"><img alt="Website blog icon circle.png" src="../images/Cluster_Analysis/Website_blog_icon_circle.png" width="31"  /></a> <a  class="image"><img alt="Blog Image 33x33px.png" src="../images/Cluster_Analysis/Blog_Image_33x33px.png" width="135"  /></a>
<ul><li> <a class="external text" href="http://blog.originlab.com/dendrograms-in-originpro-2020" target="_blank">OriginPro 2020におけるデンドログラム</a></li>
<li> <a class="external text" href="http://blog.originlab.com/performing-principal-component-analysis-for-chemometric-spectra-using-origins-app" target="_blank">Originのアプリを使用して化学測定スペクトルの主成分分析を実行する</a></li></ul>
</td></tr></table>
<h2><a name="Summary"></a><span class="mw-headline">概要</span></h2>
<p>アメリカの都市の過去3年分の平均気温データを使ってクラスター分析をしてみましょう。  
</p><p>まずはランダムに選択したデータを使い、階層的クラスター分析を行って、それを元に最適なクラスター分けを見つけたいと思います。  そのあと、分析の速いクラスター法である、K-means法クラスター分析を全体のデータに行います。
</p>
<p class="version" >必要なOriginのバージョン: Origin 2020以降</p>
<h2><a name="Hierarchical_Cluster_Analysis"></a><span class="mw-headline">階層的クラスター分析</span></h2>
<ol><li> 新規プロジェクト、または、新規ワークブックを作成します。<b>\Samples\Graphing\US Mean Temperature.dat</b>ファイルをインポートします。</li>
<li> D列からO列を選択します。</li>
<li> <b>統計: 多変量解析: 階層的クラスター分析</b>を選択してダイアログを開きます。</li>
<li> <b>入力</b>タブを開き、<b><b>変数</b></b>の隣にある<b><b>三角形のボタン</b></b><a  class="image"><img alt="Button Select Data Right Triangle.png" src="../images/Cluster_Analysis/Button_Select_Data_Right_Triangle.png" width="18"  /></a>をクリックし、コンテキストメニュー内にある<b>列の選択</b>を選びます。
<dl><dd><a  class="image"><img alt="Cluster ex2 hcluster dialog1.png" src="../images/Cluster_Analysis/Cluster_ex2_hcluster_dialog1.png" width="585"  /></a></dd></dl></li>
<li> <b>列ブラウザ</b>ダイアログの下のパネルにある <b>...</b> ボタンをクリックします。  データの範囲を<b>1</b>から<b>100</b>に設定します  <b>OK</b>をクリックします。
<dl><dd><a  class="image"><img alt="Cluster ex2 col browser.png" src="../images/Cluster_Analysis/Cluster_ex2_col_browser.png" width="713"  /></a></dd></dl></li>
<li> <b>設定</b>タブをクリックし、<b><b>クラスター</b></b>が<b><b>観測値</b></b>に設定され、<b><b>クラスターの数</b></b>が<b><b>１</b></b>になっていることを確認します。  <b>クラスター方法</b>で<b>最長距離</b>を選び、<b>OK</b>をクリックします。
<dl><dd><a  class="image"><img alt="Hcluster ex2 dialog1.png" src="../images/Cluster_Analysis/Hcluster_ex2_dialog1.png" width="330"  /></a></dd></dl></li>
<li> <b>Cluster 1</b>シートに移動します。結果の樹形図を考慮して、全体を5グループに分けることにします。 
<dl><dd> <a  class="image"><img alt="Dendrogram2.PNG" src="../images/Cluster_Analysis/Dendrogram2.PNG" width="679"  /></a></dd></dl></li>
<li> 樹形図についているカギのアイコンをクリックし、<b><b>パラメータを変更</b></b>をコンテキストメニューから選びます。</li>
<li> <b>設定</b>タブで<b><b>クラスターの数</b></b>を<b><b>５</b></b>にし、<b><b>量</b></b>タブ内にある<b><b>クラスター中心</b></b>のチェックを付けます。<b>OK</b>をクリックします。
<dl><dd><a  class="image"><img alt="Cluster ex2 hcluster dialog.png" src="../images/Cluster_Analysis/Cluster_ex2_hcluster_dialog.png" width="330"  /></a></dd>
<dd><a  class="image"><img alt="Cluster ex2 hcluster dialog01.png" src="../images/Cluster_Analysis/Cluster_ex2_hcluster_dialog01.png" width="330"  /></a></dd></dl></li>
<li> 結果の樹形図ではどのように観測値がクラスター分けされているかよくわかります。レポートシート内の樹形図をダブルクリックするとグラフウィンドウとして開くことができます。ここで、樹形図にテキストラベルや矢印の追加といった編集を加えることができ、グラフウィンドウの右上にある<b>閉じる</b>ボタン<a  class="image"><img alt="Button close embedded.png" src="../images/Cluster_Analysis/Button_close_embedded.png" width="32"  /></a>をクリックするとレポートシートの埋め込みグラフに戻せます。
<dl><dd><a  class="image"><img alt="Hcluster ex2 dendrogram.png" src="../images/Cluster_Analysis/Hcluster_ex2_dendrogram.png" width="682"  /></a></dd></dl></li>
<li> 樹形図の一部分を抜き取ってみたい場合、クリックしてその部分を選択し、右クリックして<b>新しいウィンドウにブランチを複製</b>を選択します。これにより、枝分かれした部分のみが新しいグラフウィンドウに表示されます。
<dl><dd><a  class="image"><img alt="Dendrogram zoom1.PNG" src="../images/Cluster_Analysis/Dendrogram_zoom1.PNG" width="761"  /></a></dd></dl></li></ol>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Cluster_Analysis/Tip_icon.png" width="57"  border="0" /></td><td><dl><dd> Origin 2019b以降、<b>hcluster</b>ダイアログの<b>プロット</b>タブに、樹形図のY軸に<a class="external text" href="../../UserGuide/UserGuide/The_Hierarchical_Cluster_Analysis_Dialog_Box.html#Plot"><b>類似性</b></a>を表示するためのラジオボタンが表示されます（デフォルトは<b>距離</b>です）。</dd></dl>
</td></tr></table>
<h2><a name="Analyzing_Original_Data_with_K-Means_Cluster"></a><span class="mw-headline">元のデータをK-means法クラスターで分析する</span></h2>
<ol><li> Cluster1ワークシートの<b><b>クラスター中心</b></b>を右クリックし、コンテキストメニューから<b><b>新しいシートとしてコピーを作成</b></b>を選びます。新しく作成された<b><b>クラスター中心</b></b>シートを<b><b>初期のクラスター中心</b></b>としてK-means法クラスター分析を行います。
<dl><dd><a  class="image"><img alt="Cluster ex2 cluster center.png" src="../images/Cluster_Analysis/Cluster_ex2_cluster_center.png" width="538"  /></a></dd></dl></li>
<li> 元のデータ(US Mean Temperatureワークシート)に戻り、列Dから列Oを選択します。メニューから<b>統計：多変量解析：K-means法クラスター分析</b>を選びます。</li>
<li> <b><b>オプション</b></b>タブの<b><b>初期のクラスター中心を指定する</b></b>にチェックを付けます。  <b>初期のクラスター中心</b>の隣にある、<b>ワークシートから選択する</b>のボタン<a  class="image"><img alt="Button Select Data Interactive.png" src="../images/Cluster_Analysis/Button_Select_Data_Interactive.png" width="18"  /></a>を押します。これにより、ダイアログが小さくなります。   </li>
<li> <b><b>クラスター中心</b></b>シートに行き、列Dから列Oを選択します。  小さくなったダイアログにあるボタンをクリックしてダイアログを元に戻します。 </li>
<li> <b>プロット</b>タブ内で<b>グループグラフ</b>を選択します。<b>X範囲</b>の隣にある、<b>ワークシートから選択する</b>ボタン<a  class="image"><img alt="Button Select Data Interactive.png" src="../images/Cluster_Analysis/Button_Select_Data_Interactive.png" width="18"  /></a>を押します。これにより、ダイアログが小さくなります。元のワークシート<b>US Mean Temperature</b>に戻り、<b>列(B):Longtitude</b>を選択します。   小さくなったダイアログにあるボタンをクリックして元に戻します。 </li>
<li> <b>Y範囲</b>の隣にある<b>三角形ボタン</b><a  class="image"><img alt="Button Select Data Right Triangle.png" src="../images/Cluster_Analysis/Button_Select_Data_Right_Triangle.png" width="18"  /></a>を選び、<b>C(Y)：Latitude</b>を選びます。   <b>OK</b>をクリックします。
<dl><dd><a  class="image"><img alt="Kmeans ex2 dialog.png" src="../images/Cluster_Analysis/Kmeans_ex2_dialog.png" width="453"  /></a></dd></dl></li>
<li> <b>K-Means Plot Data1</b>ワークシートをアクティブにします。  観測データは各都市の緯度に対応した5つのクラスターにまとめられたことが分かります。
<dl><dd> <a  class="image"><img alt="Group graph.png" src="../images/Cluster_Analysis/Group_graph.png" width="421"  /></a></dd></dl></li></ol>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Cluster_Analysis/Tip_icon.png" width="57"  border="0" /></td><td><p>必要に応じて、さらなる操作を行うために、<b>クラスタメンバーシップ</b>列の出力先を入力データの隣などにすることもできます。
<p><a  class="image"><img alt="Cluster Membership.png" src="../images/Cluster_Analysis/Cluster_Membership.png" width="574"  /></a>
</p>
</p></td></tr></table>


    