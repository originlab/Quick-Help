<h1 class="firstheading">LabTalkの基本</h1>

  <p class='urlname' style='display: none'>Tutorial-Language-Fundamental</p>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>目次</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1"><a href="#Summary"><span class="tocnumber">1</span> <span class="toctext">概要</span></a></li>

      <li class="toclevel-1 tocsection-2">
        <a href="#What_You_Will_Learn"><span class="tocnumber">2</span> <span class="toctext">学習する項目</span></a>

        <ul>
          <li class="toclevel-2 tocsection-3"><a href="#Basic_Programming_Syntax"><span class="tocnumber">2.1</span> <span class="toctext">基本構文</span></a></li>

          <li class="toclevel-2 tocsection-4"><a href="#Conditional_and_Loop_Structure"><span class="tocnumber">2.2</span> <span class="toctext">条件とループ構文</span></a></li>

          <li class="toclevel-2 tocsection-5"><a href="#LabTalk_Functions"><span class="tocnumber">2.3</span> <span class="toctext">LabTalk関数</span></a></li>
        </ul>
      </li>
    </ul>
  </div>

  <h2><a name="Summary"></a><span class="mw-headline">概要</span></h2>

  <p>LabTalkは様々なデータタイプの変数をサポートしています。異なるステートメントでのこれら変数の利用はスクリプトにおける基本的な考え方です。型宣言なしで使われる変数はデフォルトで<i>double</i>もしくは<i>string</i>型になり、プロジェクトスコープになります。(Originプロジェクトが開いてる限り存在し、プロジェクトに保存できます)</p>

  <p>C言語のようにLabTalkのステートメントはセミコロン(&rdquo;;&rdquo;)で終わります。実行するコードのブロックを定義するフロー制御文があり、ブロックは中括弧（&apos;{&apos;と&apos;}&apos;）で区切られます。</p>

  <p>ブロックで定義した変数はスコープを持ち、ブロックを離れるときに変数は消去されます。</p>

  <h2><a name="What_You_Will_Learn"></a><span class="mw-headline">学習する項目</span></h2>

  <p>このチュートリアルでは、以下の項目について解説します。</p>

  <ul>
    <li>様々なデータ型の変数の定義と利用</li>

    <li>プログラム関数を制御するコマンドステートメントの記述</li>

    <li>条件とループ構文の作成</li>

    <li>操作で組み込み/ユーザ定義関数を利用</li>
  </ul>

  <h3><a name="Basic_Programming_Syntax"></a><span class="mw-headline">基本構文</span></h3>

  <p>LabTalkは次の9個のデータ型をサポートしています。double, integer, constant, dataset, string, stringarray, range, tree, graphic objectsLabTalkスクリプトは変数の定義（または宣言)とそれらの操作に基づいています。</p>

  <p>LabTalkでは5種のステートメントが利用されます。代入文、マクロ文、コマンド文、算術文、関数文です。</p>

  <p>基本のプログラミング構文の例をこの章のチュートリアルで紹介します。</p>

  <ol>
    <li>プロジェクト変数になるように、宣言なしで変数を定義</li>

    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">// double型のプロジェクト変数として定義</span>
aa <span style="color: #000080;">=</span> <span style="color: #0000dd;">3.5</span>;
<span style="color: #008000;">// string型のプロジェクト変数として定義 </span>
str<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Hello&quot;</span>;
</pre>
    </li>

    <li>セッション変数として、数値変数<b>bb</b>（double）、<b>nn</b>（integer）、<b>c1</b>（constant）を定義</li>

    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
double bb <span style="color: #000080;">=</span> <span style="color: #0000dd;">1.234</span>; <span style="color: #008000;">// 宣言と代入</span>
double cc; <span style="color: #008000;">// 宣言</span>
cc <span style="color: #000080;">=</span> <span style="color: #0000dd;">9.876</span>; <span style="color: #008000;">// 代入</span>
int nn;
<span style="color: #008000;">//定数を定義する際には必ず代入する必要があります</span>
<span style="color: #008000;">//定数は変更することができません</span>
const c1 <span style="color: #000080;">=</span> <span style="color: #0000dd;">0.5</span>;
</pre>
    </li>

    <li>string変数を宣言しさらにstringレジスタに保存</li>

    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">//次のスクリプトを使って文字列を定義 </span>
string greeting<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Hello World&quot;</span>;
<span style="color: #000080;">%</span>A <span style="color: #000080;">=</span> greeting<span style="color: #000080;">$</span>;
<span style="color: #008000;">//次のスクリプトで文字列の値を取得</span>
greeting<span style="color: #000080;">$</span> <span style="color: #000080;">=</span>;
<span style="color: #000080;">%</span>A <span style="color: #000080;">=</span>;
</pre>
    </li>

    <li>文字列変数として認識させずに、&quot;greeting$&quot;というテキストを別の文字列として定義</li>

    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">//&rdquo;+&rdquo;は文字列の結合を行う演算子です</span>
<span style="color: #000080;">%</span>B <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;greeting&quot;</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;$&quot;</span>;
<span style="color: #008000;">//文字列レジスタ%Bの値を返します</span>
<span style="color: #008000;">//greeting$というテキストが返されます</span>
<span style="color: #000080;">%</span>B <span style="color: #000080;">=</span>;
</pre>
    </li>

    <li>文字列レジスタとして認識させずに、&rdquo;%B&rdquo;というテキストを文字列変数として定義</li>

    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">//通常、%と任意の文字は26個の文字列レジスタのうちの1つとして解釈されます。</span>
<span style="color: #008000;">//接頭辞として%をつけることで置換をさせないようにできます</span>
string str1<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">%%</span>B;
<span style="color: #008000;">//文字列変数str1の値を返します</span>
<span style="color: #008000;">//%Bが返ってきます</span>
str1<span style="color: #000080;">$</span> <span style="color: #000080;">=</span>;
</pre>
    </li>

    <li>データセットを一時的なルースデータセットとして宣言します。このデータセットはワークシートに関連付けられず、Origin プロジェクトに保存されませんが、計算には使用できます。プロットには使用できません。</li>

    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">//1から10まで0.5ずつ増加する数列としてこのデータセットを定義</span>
dataset aa <span style="color: #000080;">=</span> <span style="color: #000000;">{</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">0.5</span><span style="color: #000000;">:</span><span style="color: #0000dd;">10</span><span style="color: #000000;">}</span>;
</pre>
    </li>

    <li>プロジェクトレベルのルースデータセットを代入で作成、またはcreateコマンドで作成</li>

    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">//代入</span>
temp <span style="color: #000080;">=</span> <span style="color: #000000;">{</span><span style="color: #0000dd;">10</span>,<span style="color: #0000dd;">9</span>,<span style="color: #0000dd;">8</span>,<span style="color: #0000dd;">7</span>,<span style="color: #0000dd;">6</span><span style="color: #000000;">}</span>;
<span style="color: #008000;">//createコマンド</span>
<span style="color: #008000;">//&rdquo;tmpdata&rdquo;というルースデータセットを作成し行数を5で定義</span>
create tmpdata <span style="color: #000080;">-</span>wdn <span style="color: #0000dd;">5</span> X Y;
</pre>

      <p><b>Note:</b>コマンド文は、一意である限り、コマンド自体またはその省略形から始まります（この例では、&quot;create &quot;がコマンドです）。ほとんどのコマンドにはオプションがあり、&rdquo;-&rdquo;記号が接頭辞になります。（この例では、&rdquo;-wdn&rdquo;がオプションもしくはスイッチです）コマンド自身とそのオプションの両方が引数を取ることができます(この例では、&rdquo;tmpdata&rdquo;がコマンドの引数、&rdquo;5 X Y&rdquo;が-wdnオプションの引数です)。</p>
    </li>

    <li>createコマンドで作成されるデータセット変数は、tmpdata_Xとtmpdata_Yの2つです。tmpdata_X に数値を1つずつ渡します。</li>

    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
tmpdata_X<span style="color: #000000;">[</span><span style="color: #0000dd;">1</span><span style="color: #000000;">]</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
tmpdata_X<span style="color: #000000;">[</span><span style="color: #0000dd;">2</span><span style="color: #000000;">]</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
tmpdata_X<span style="color: #000000;">[</span><span style="color: #0000dd;">3</span><span style="color: #000000;">]</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2.5</span>;
</pre>
    </li>

    <li>既存のデータセットから tmpdata_Y に値を渡します。</li>

    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
tmpdata_Y <span style="color: #000080;">=</span> temp;
</pre>

      <table class="noborder">
        <tr>
          <td style="vertical-align:top" width="60"><img src="../images/Tutorial_Language_Fundamental/Tip_icon.png" width="57" border="0" alt=""></td>

          <td>
            <p>プロジェクトレベルのデータセット（例：tmpdata_X、tmpdata_Y）はプロット用に使用できますが、セッションレベルのデータセット（例：aa）はプロットには使用できません。</p>

            <p>プロットするためには次のスクリプトを使用します。</p>
            <pre class="lt" style="font-family:monospace;">
plotxy iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span>tmpdata_Y plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">202</span>;
</pre>
          </td>
        </tr>
      </table>
    </li>

    <li>文字列配列を定義し、それに文字列メンバーを追加します。</li>

    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
StringArray stra;
stra.<span style="color: #000080;">Add</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Hello&quot;</span><span style="color: #000000;">)</span>;
stra.<span style="color: #000080;">Add</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;World&quot;</span><span style="color: #000000;">)</span>;
</pre>
    </li>

    <li>次のスクリプト (ループ構造については下のセクションで紹介) を使用して、文字列配列stra内の文字列を出力します。</li>

    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
loop<span style="color: #000000;">(</span>ii,<span style="color: #0000dd;">1</span>,stra.<span style="color: #000080;">GetSize</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
  string str<span style="color: #000080;">$</span><span style="color: #000080;">=</span>stra.<span style="color: #000080;">GetAt</span><span style="color: #000000;">(</span>ii<span style="color: #000000;">)</span><span style="color: #000080;">$</span>;
  str<span style="color: #000080;">$</span><span style="color: #000080;">=</span>;
<span style="color: #008000;">//以下を返す</span>
<span style="color: #008000;">//Hello</span>
<span style="color: #008000;">//World</span>
<span style="color: #000000;">}</span>
</pre>

      <table class="noborder">
        <tr>
          <td style="vertical-align:top" width="60"><img src="../images/Tutorial_Language_Fundamental/Tip_icon.png" width="57" border="0" alt=""></td>

          <td>
            <p>&quot;list&quot; および &quot;del&quot; コマンドで変数の表示と削除が可能です。以下のスクリプトを実行してアクセスできるLabTalk変数ビューアもあります。</p>
            <pre class="lt" style="font-family:monospace;">
list;
</pre>
          </td>
        </tr>
      </table>
    </li>
  </ol>

  <h3><a name="Conditional_and_Loop_Structure"></a><span class="mw-headline">条件とループ構文</span></h3>

  <p><b>ループ</b></p>

  <p>ループにより、プログラムで一連のアクションを繰り返し実行できます。LabTalk には、repeat、loop、doc -e、for の4つのループコマンドがあります。</p>

  <p><b>repeat</b>ループは一連の操作が変更無く繰り返されるときに使われます。</p>

  <p>構文: <b>repeat <i>value</i> {<i>script</i>}</b></p>

  <ul>
    <li>次のスクリプトを実行して、スクリプトウィンドウに行を6回出力し、繰り返しの回数を記録します。</li>
  </ul>
  <pre class="lt" style="font-family:monospace;">
int count <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
repeat <span style="color: #0000dd;">6</span> <span style="color: #000000;">{</span>type <span style="color: #ff00ff;">&quot;this is output line $(count)&quot;</span>; count <span style="color: #000080;">=</span> count <span style="color: #000080;">+</span> <span style="color: #0000dd;">1</span>;<span style="color: #000000;">}</span>
</pre>

  <p><b>Loop</b>ループは、一連のループごとに1つの変数が<b>1ずつ増える</b>ときに使用されます。</p>

  <p>構文: <b>loop (<i>variable</i>, <i>startVal</i>, <i>endVal</i>) {<i>script</i>}</b></p>

  <ul>
    <li>次のループを実行して、新しく作成されたデータセットに値を割り当てます。</li>
  </ul>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">//ワークシートに関連付けられていないデータセット (50行) を作成</span>
create loopdata <span style="color: #000080;">-</span>t <span style="color: #0000dd;">50</span>;
<span style="color: #008000;">//ループを使用して値をデータセットに渡す</span>
loop<span style="color: #000000;">(</span>ii, <span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">50</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
  loopdata<span style="color: #000000;">[</span><span style="color: #000080;">$</span><span style="color: #000000;">(</span>ii<span style="color: #000000;">)</span><span style="color: #000000;">]</span> <span style="color: #000080;">=</span> ii<span style="color: #000080;">^</span><span style="color: #0000dd;">2</span>;
<span style="color: #000000;">}</span>
</pre>

  <p><b>for</b>ループは最も一般的なループで、他のすべての条件で使用できます。</p>

  <p>構文:<b>for (<i>expression1</i>; <i>expression2</i>; <i>expression3</i>) {<i>script</i>}</b></p>

  <p>この構文では、<i>expression1</i> は初期設定を指定し、<i>expression2</i> は<i>script</i>を実行するか(trueの場合)、またはループを終了するか (falseの場合) を決定するために評価され、<i>expression3</i> は多くの場合でカウンターの増分として各ループの最後に実行されます。<i>expression1</i> および <i>expression3</i> は次のようにコンマ区切りの複数のステートメントで構成できます。</p>
  <pre class="lt" style="font-family:monospace;">
for<span style="color: #000000;">(</span>ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>, jj <span style="color: #000080;">=</span> <span style="color: #0000dd;">9</span>; ii <span style="color: #000080;">&lt;=</span> <span style="color: #0000dd;">5</span> ; ii<span style="color: #000080;">++</span>, jj<span style="color: #000080;">++</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
ty <span style="color: #000080;">$</span><span style="color: #000000;">(</span>ii<span style="color: #000000;">)</span>, <span style="color: #000080;">$</span><span style="color: #000000;">(</span>jj<span style="color: #000000;">)</span>, <span style="color: #000080;">$</span><span style="color: #000000;">(</span>ii<span style="color: #000080;">+</span>jj<span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span>
</pre>

  <ul>
    <li>次のループを実行すると、作成したルースデータセットloopdataの10番目ごとの値を出力します。</li>
  </ul>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">//dataset.GetSize() メソッドを使用するには、</span>
<span style="color: #008000;">//最初にデータセット オブジェクト ld を宣言する必要があります</span>
dataset ld <span style="color: #000080;">=</span> loopdata;
for<span style="color: #000000;">(</span>jj <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; jj <span style="color: #000080;">&lt;=</span> ld.<span style="color: #000080;">GetSize</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; jj <span style="color: #000080;">=</span> jj <span style="color: #000080;">+</span> <span style="color: #0000dd;">10</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
  ld<span style="color: #000000;">[</span><span style="color: #000080;">$</span><span style="color: #000000;">(</span>jj<span style="color: #000000;">)</span><span style="color: #000000;">]</span> <span style="color: #000080;">=</span>;
<span style="color: #000000;">}</span>
</pre>

  <p><b>doc -e</b>ループは、特定のタイプのオブジェクトに影響を与えるスクリプトが実行されているときに使用されます。オブジェクトタイプについては、<a href="../../LabTalk/LabTalk/Document_(command).html#-e_object_.7Bscript.7D.3B_Execute_the_given_script_for_all_objects" title="LabTalk:Document (コマンド)">documentコマンド</a>を参照してください。</p>

  <p>構文: <b>doc -e <i>object</i> {<i>script</i>}</b></p>

  <ul>
    <li>次のループを実行して、Originプロジェクトの各データセットの名前を出力します (ワークシートの列とプロジェクトレベルのルースデータセットを含む)。</li>
  </ul>
  <pre class="lt" style="font-family:monospace;">
doc <span style="color: #000080;">-</span>e S
<span style="color: #000000;">{</span>
  <span style="color: #000080;">%</span>C <span style="color: #000080;">=</span>;
<span style="color: #000000;">}</span>
</pre>

  <p><b>分岐構造</b></p>

  <p>分岐構造により、プログラムは状況に応じて異なる一連のアクションを実行できます。LabTalkでは、if、if-else、switchの3つの判断分岐構造を提供します。</p>

  <p><b>if</b>コマンドは、指定した条件が成り立った場合、つまり、真(true)の場合に、指定したスクリプトを実行する場合に使用します。<b>else</b>コマンドと組み合わせると、特定の式が偽(false)の場合、別のスクリプトが実行されます。</p>

  <p>構文: <b>if (<i>testCondition</i>) {<i>script1</i>} [else {<i>script2</i>}]</b></p>

  <ul>
    <li>Originプロジェクトファイルで、ワークブックが1つ、グラフウィンドウが1つ、行列ウィンドウが1つ、レイアウトページが1つあるとします。各ウィンドウをアクティブにし、次のスクリプトを実行して、ウィンドウの種類を決定します。</li>
  </ul>
  <pre class="lt" style="font-family:monospace;">
if<span style="color: #000000;">(</span>exist<span style="color: #000000;">(</span><span style="color: #000080;">%</span>H<span style="color: #000000;">)</span><span style="color: #000080;">==</span><span style="color: #0000dd;">3</span><span style="color: #000000;">)</span>
      type <span style="color: #000080;">-</span>b <span style="color: #ff00ff;">&quot;A graph window is active&quot;</span>;
else
      if<span style="color: #000000;">(</span>exist<span style="color: #000000;">(</span><span style="color: #000080;">%</span>H<span style="color: #000000;">)</span><span style="color: #000080;">==</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span>
            type <span style="color: #000080;">-</span>b <span style="color: #ff00ff;">&quot;A worksheet is active&quot;</span>;
      else
            type <span style="color: #000080;">-</span>b <span style="color: #ff00ff;">&quot;Neither a graph nor worksheet is active&quot;</span>;
</pre>

  <p><b>switch</b>コマンドは、2つ又はそれ以上の条件があって、条件を満たしたときの指定スクリプトを実行をする場合に使用します。</p>

  <p>例えば、上述のif-else構造のスクリプトは以下のように修正できます。</p>
  <pre class="lt" style="font-family:monospace;">
switch<span style="color: #000000;">(</span>exist<span style="color: #000000;">(</span><span style="color: #000080;">%</span>H<span style="color: #000000;">)</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
    case <span style="color: #0000dd;">3</span><span style="color: #000000;">:</span>
       type <span style="color: #000080;">-</span>b <span style="color: #ff00ff;">&quot;A graph window is active&quot;</span>;
       break;
    case <span style="color: #0000dd;">2</span><span style="color: #000000;">:</span>
       type <span style="color: #000080;">-</span>b <span style="color: #ff00ff;">&quot;A worksheet is active&quot;</span>;
       break;
    case <span style="color: #0000dd;">5</span><span style="color: #000000;">:</span>
       type <span style="color: #000080;">-</span>b <span style="color: #ff00ff;">&quot;A Matrix is active&quot;</span>;
       break;
    default<span style="color: #000000;">:</span>
       type <span style="color: #000080;">-</span>b <span style="color: #ff00ff;">&quot;Neither a graph, worksheet nor matrix is active&quot;</span>;
       break;
<span style="color: #000000;">}</span>
</pre>

  <h3><a name="LabTalk_Functions"></a><span class="mw-headline">LabTalk関数</span></h3>

  <p>LabTalk は、次の構文で呼び出される組み込み関数を介して多くの操作をサポートします。</p>

  <p><b><i>outputVariable</i> = <i>FunctionName</i>(<i>Arg1</i> <i>Arg2</i> ...<i>ArgN</i>);</b></p>

  <p>また、次の構文でユーザ定義関数を作成できます。</p>

  <p><b>function <i>dataType</i> <i>funcName</i>(<i>Arg1</i> <i>Arg2</i> ...<i>ArgN</i>) {<i>script</i>;}</b></p>

  <p>関数では、引数と戻り値の両方が<b>string</b>、<b>double</b>、<b>int</b>、<b>dataset</b>、<b>tree</b>データ型をサポートしています。</p>

  <ol>
    <li>まず、組み込み関数を呼び出して、ユーザ定義の数値関数を宣言します。この関数は、ランダムな数値からユリウス日の値を生成します。</li>

    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
function double JDate<span style="color: #000000;">(</span>double num<span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
   <span style="color: #008000;">//doubleから積分を計算</span>
   int x <span style="color: #000080;">=</span> int<span style="color: #000000;">(</span>exp<span style="color: #000000;">(</span>num<span style="color: #000000;">)</span><span style="color: #000080;">*</span><span style="color: #0000dd;">1000</span><span style="color: #000000;">)</span>; 
   <span style="color: #008000;">//剰余関数mod()で日、月、年の積分を生成</span>
   int iDay <span style="color: #000080;">=</span> mod<span style="color: #000000;">(</span>x, <span style="color: #0000dd;">27</span><span style="color: #000000;">)</span> <span style="color: #000080;">+</span> <span style="color: #0000dd;">1</span>;
   int iMonth <span style="color: #000080;">=</span> mod<span style="color: #000000;">(</span>x, <span style="color: #0000dd;">11</span><span style="color: #000000;">)</span> <span style="color: #000080;">+</span> <span style="color: #0000dd;">1</span>;
   int iYear <span style="color: #000080;">=</span> <span style="color: #0000dd;">2013</span> <span style="color: #000080;">-</span> mod<span style="color: #000000;">(</span>x, <span style="color: #0000dd;">5</span><span style="color: #000000;">)</span>;
   <span style="color: #008000;">//MM/DD/YYYYとして文字列を定義</span>
   string jd<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">$</span><span style="color: #000000;">(</span>iMonth<span style="color: #000000;">)</span><span style="color: #000080;">/</span><span style="color: #000080;">$</span><span style="color: #000000;">(</span>iDay<span style="color: #000000;">)</span><span style="color: #000080;">/</span><span style="color: #000080;">$</span><span style="color: #000000;">(</span>iYear<span style="color: #000000;">)</span>;
   <span style="color: #008000;">//関数の結果として文字列からユリウス通日を返す</span>
   <span style="color: #008000;">//%()表記で文字列を置換</span>
   return date<span style="color: #000000;">(</span><span style="color: #000080;">%</span><span style="color: #000000;">(</span>jd<span style="color: #000080;">$</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span>
</pre>
    </li>

    <li>ユーザ定義関数<b>JDate</b>を呼び出し、0.83などの数値からユリウス通日を計算します。</li>

    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">//ユリウス通日を計算してdouble型の変数jdaに渡す</span>
double jda <span style="color: #000080;">=</span> JDate<span style="color: #000000;">(</span><span style="color: #0000dd;">0.83</span><span style="color: #000000;">)</span>;
<span style="color: #008000;">//jdaの数値を出力</span>
jda <span style="color: #000080;">=</span>;<span style="color: #008000;">//2455373</span>
<span style="color: #008000;">//日付をMM/DD/YYYYの表記で表示</span>
type <span style="color: #000080;">$</span><span style="color: #000000;">(</span>jda, D0<span style="color: #000000;">)</span>;<span style="color: #008000;">//6/26/2010</span>
</pre>
    </li>

    <li>2列あるワークブックを作成して、一行目のA列で右クリックし、<b>列値の一律設定：一様乱数</b>を選択して乱数値を列に入力します。</li>

    <li style="list-style: none">
      <p><b>Note:</b> 以下のスクリプトを実行し、Xファンクションcsetvalueで第一列に乱数を取得します。</p>
      <pre class="lt" style="font-family:monospace;">
newbook;
wks.<span style="color: #000080;">nCols</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
csetvalue col<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> formula<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;grnd()&quot;</span>;
</pre>
    </li>

    <li><b>JDate</b>関数を使ってB列にユリウス通日を算出します。</li>

    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
col<span style="color: #000000;">(</span>B<span style="color: #000000;">)</span> <span style="color: #000080;">=</span> JDate<span style="color: #000000;">(</span>col<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
</pre>
    </li>

    <li>列フォーマットを日付に変更します。</li>

    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">format</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">4</span>;
</pre>
    </li>
  </ol>
