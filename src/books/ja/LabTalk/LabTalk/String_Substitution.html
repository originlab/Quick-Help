<h1 class="firstheading">%( ) 置換 - 文字列置換</h1><p class='urlname' style='display: none'>string-substitution</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#String_Expression_SubstitutionString_Expression_Substitution"><span class="tocnumber">1</span> <span class="toctext">文字列式の置換<span class="OIndex" style="display:none">String Expression Substitution</span></span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Range_Expression_Substitution"><span class="tocnumber">2</span> <span class="toctext">範囲式の置換</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Worksheet_Column_and_Cell_Substitution"><span class="tocnumber">3</span> <span class="toctext">ワークシート列とセルの置換</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Dataset_SubstitutionDataset_Substitution"><span class="tocnumber">3.1</span> <span class="toctext">データセット置換<span class="OIndex" style="display:none">Dataset Substitution</span></span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Cell_Contents"><span class="tocnumber">3.2</span> <span class="toctext">セルの内容</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Workbook_Information_Substitution"><span class="tocnumber">4</span> <span class="toctext">ワークブック情報の置換</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#Column_Label_Row_Information"><span class="tocnumber">4.1</span> <span class="toctext">列ラベル行情報</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Worksheet_Information"><span class="tocnumber">4.2</span> <span class="toctext">ワークシート情報</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Workbook_Information"><span class="tocnumber">4.3</span> <span class="toctext">ワークブック情報</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Information_Storage_and_Imported_File_Information"><span class="tocnumber">4.4</span> <span class="toctext">情報の保存とインポートしたファイルの情報</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-11"><a href="#Legend_and_Axis_Title_SubstitutionLegend_Substitution_Axis_Title_Substitution"><span class="tocnumber">5</span> <span class="toctext">凡例と軸タイトルの置換</span></a></li>
<li class="toclevel-1 tocsection-12"><a href="#Keyword_Substitution"><span class="tocnumber">6</span> <span class="toctext">キーワード置換</span></a></li>
</ul>
</div>
<h2><a name="String_Expression_SubstitutionString_Expression_Substitution"></a><span class="mw-headline">文字列式の置換<span class="OIndex" style="display:none">String Expression Substitution</span></span></h2>
<p><b>%(str$)</b>
<br />
</p><p><b>コマンドに文字列を渡す</b>
<br />
LabTalkコマンドは、数値引数と文字列引数の両方を受け入れます。 
数値変数または式は直接渡すことができます。例えば、<i>worksheet -a 2*2</i> は4つの新しい列を追加します。リアルタイムで解決された文字列をコマンドに渡すには、文字列引数を%( )で囲む必要があります。E.g.
</p>
<pre class="lt" style="font-family:monospace;">string name<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Book1&quot;</span>;
<span style="color: #008000;">//Originの他のウィンドウをアクティブにし、次のコマンドを実行してBook1をアクティブにする</span>
win <span style="color: #000080;">-</span>a name<span style="color: #000080;">$</span>; <span style="color: #008000;">//「bookname$」という名前のウィンドウをアクティブにしようとしてするため機能しない</span>
win <span style="color: #000080;">-</span>a <span style="color: #000080;">%</span><span style="color: #000000;">(</span>name<span style="color: #000080;">$</span><span style="color: #000000;">)</span> <span style="color: #008000;">//正しく動作</span></pre>
<p><b>&quot; &quot;内の文字列を連結</b>
<br />
複数の文字列を &quot; &quot; で連結する場合は、%(str$)置換を使用します。 
</p><p>現在のウィンドウがBook1でSheet1がアクティブだとします。
</p>
<pre class="lt" style="font-family:monospace;">string name<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;wks.name$ in page.name$&quot;</span>; 
name<span style="color: #000080;">$</span><span style="color: #000080;">=</span>; <span style="color: #008000;">//正確に&quot;wks.name$ in page.name$&quot;を印字</span>
string name<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;%(wks.name$) in&nbsp;%(page.name$)&quot;</span>;
name<span style="color: #000080;">$</span><span style="color: #000080;">=</span>; <span style="color: #008000;">//Sheet1 in Book1と印字</span>
<span style="color: #008000;">// &quot; &quot;内でない場合は、%( )を追加する必要なし</span>
string name<span style="color: #000080;">$</span> <span style="color: #000080;">=</span>wks.<span style="color: #000080;">name</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot; in &quot;</span> <span style="color: #000080;">+</span>page.<span style="color: #000080;">name</span><span style="color: #000080;">$</span>; 
name<span style="color: #000080;">$</span><span style="color: #000080;">=</span>; <span style="color: #008000;">//Sheet1 in Book1と印字</span></pre>
<p><b>文字列を数値に変換</b>
<br />
数値のみを含む文字列の場合は、%(str$) を使用して数値に変換できます。これは、数値を文字列に変換する $( ) の逆の操作です。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 文字列「456」を数値 456 に変換</span>
string myString<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;456&quot;</span>;
int myNum<span style="color: #000080;">=</span><span style="color: #000080;">%</span><span style="color: #000000;">(</span>myString<span style="color: #000080;">$</span><span style="color: #000000;">)</span>;</pre>
<h2><a name="Range_Expression_Substitution"></a><span class="mw-headline">範囲式の置換</span></h2>
<p><b>%(rangeVariable)</b>
<br />
範囲変数で<b>%( )</b> 置換が使用されると、範囲文字列に解決されます。
</p>
<pre class="lt" style="font-family:monospace;">range rA<span style="color: #000080;">=</span><span style="color: #000000;">[</span>Book1<span style="color: #000000;">]</span>Sheet1<span style="color: #000080;">!</span>A;
type <span style="color: #000080;">%</span><span style="color: #000000;">(</span>rA<span style="color: #000000;">)</span>; <span style="color: #008000;">//範囲文字列を出力</span></pre>
<p><br />
このため、ユーザは既存の範囲変数に基づいて新しい範囲を構築できるため、コードの一元化に役立ちます。  
</p>
<pre class="lt" style="font-family:monospace;">range rwks <span style="color: #000080;">=</span> sheet1<span style="color: #000080;">!</span>; <span style="color: #008000;">//rwks で現在のブックのシート1を指す</span>
range r1<span style="color: #000080;">=</span> <span style="color: #000080;">%</span><span style="color: #000000;">(</span>rwks<span style="color: #000000;">)</span>col<span style="color: #000000;">(</span>a<span style="color: #000000;">)</span>; <span style="color: #008000;">//r1でシートの列Aを指す</span>
r1<span style="color: #000080;">=</span>data<span style="color: #000000;">(</span><span style="color: #0000dd;">0</span>,<span style="color: #0000dd;">100</span><span style="color: #000000;">)</span>; <span style="color: #008000;">//r1に0、1、...、100を入力</span>
rwks.<span style="color: #000080;">addcol</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; <span style="color: #008000;">//シートに列を追加</span>
range r2 <span style="color: #000080;">=</span> <span style="color: #000080;">%</span><span style="color: #000000;">(</span>rwks<span style="color: #000000;">)</span>wcol<span style="color: #000000;">(</span> rwks.<span style="color: #000080;">ncols</span> <span style="color: #000000;">)</span>; <span style="color: #008000;">//r2は、新しく追加された列である最後の列を指す</span>
r2<span style="color: #000080;">=</span>r1<span style="color: #000080;">/</span><span style="color: #0000dd;">10</span>; //r1, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">0.1</span>, ..., <span style="color: #0000dd;">10</span>に基づいてr2を計算</pre>
<h2><a name="Worksheet_Column_and_Cell_Substitution"></a><span class="mw-headline">ワークシート列とセルの置換</span></h2>
<h3><a name="Dataset_SubstitutionDataset_Substitution"></a><span class="mw-headline">データセット置換<span class="OIndex" style="display:none">Dataset Substitution</span></span></h3>
<p><b>%(workbookName, column)</b> または <b>%([workbookName]sheet, column)</b>
<br />
ここで、
</p>
<ul><li> <b>workbookname</b> はワークブックのショートネーム</li>
<li> <b>sheet</b> はシート名、ラベル、インデックスのいずれか</li>
<li> <b>column</b> は列ショートネーム、ロングネーム、インデックスのいずれか</li></ul>
<p>Origin 8より前のバージョンでは、ワークブックごとにシートが1つしかなく、最初の引数に workbookName を指定するだけでよいため、2つの構文がサポートされています。最近のバージョンでは、複数のワークシートをサポートしているので、最初の引数でブックとシートの両方を指定する必要があります。アクティブなシートの列を参照する場合は、引き続き1番目の構文を使用できます。
</p>
<table class="simple" style="width: 90%">
<tr>
<th style="width: 200">構文
</th>
<th style="width: 200">説明
</th>
<th style="width: 400">サンプル
</th></tr>
<tr>
<td> <i><b>%(workbookName, column)</b></i>
</td>
<td> ブックのアクティブシート上の列
</td>
<td>
<pre>%(Book1, B) //列ショートネームを使用
%(%H,&quot;&quot;Average Temp&quot;) //列ロングネームを使用
winName$=&quot;Book1&quot;;&nbsp;%(%(winName$), 2); //列インデックスを使用
</pre>
</td></tr>
<tr>
<td> <i><b>%([workbookName]sheet, column)</b></i>
</td>
<td> ブックの指定したシート上の列
</td>
<td>
<pre>%([Book1]Sheet1, B) //シート名と列ショートネームを使用
%([%H]&quot;test result&quot;,&quot;&quot;Average Temp&quot;) //シートラベルと列ロングネームを使用
winName$=&quot;Book1&quot;;&nbsp;%([%(str$)]3, 2); //シートおと列インデックスを使用
</pre>
</td></tr></table>
<p>例: 右側の列の名前を置換し、%Aと%Bに割り当てます。2番目のケースでは、指定ブックまたはシートが存在しない場合、エラーは発生しませんが、置換は無効になります。 
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000080;">%</span>A <span style="color: #000080;">=</span> <span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000080;">%</span>H, B<span style="color: #000000;">)</span>; <span style="color: #008000;">// アクティブブックのアクティブシートの列B</span>
type <span style="color: #000080;">%</span>A; <span style="color: #008000;">//列名を返す。2番目のシートがアクティブの場合Book1_B@2を返す</span>
type <span style="color: #000080;">$</span><span style="color: #000000;">(</span><span style="color: #000080;">%</span>A<span style="color: #000000;">)</span> <span style="color: #008000;">//列値を返す</span>
<span style="color: #000080;">%</span>B <span style="color: #000080;">=</span> <span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000000;">[</span>Book1<span style="color: #000000;">]</span>Sheet3,<span style="color: #0000dd;">2</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// Book1、Sheet3の列2</span>
type <span style="color: #000080;">%</span>B; <span style="color: #008000;">//列名を返す。例：Book1_B@3</span>
type <span style="color: #000080;">$</span><span style="color: #000000;">(</span><span style="color: #000080;">%</span>B<span style="color: #000000;">)</span> <span style="color: #008000;">//列値を返す</span></pre>
<p>Note: 括弧を使って、文字列レジスタ自体に割り当てを実行するのではなく、文字列レジスタ変数に含まれる名前を持つデータセットで実行される割り当てを強制的に行うことができます。 
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000080;">%</span>A <span style="color: #000080;">=</span> <span style="color: #000080;">%</span><span style="color: #000000;">(</span>Book1,<span style="color: #0000dd;">2</span><span style="color: #000000;">)</span>;   <span style="color: #008000;">// 列2のデータセット名を%Aに割り当て</span>
<span style="color: #000000;">(</span><span style="color: #000080;">%</span>A<span style="color: #000000;">)</span> <span style="color: #000080;">=</span> <span style="color: #000080;">%</span><span style="color: #000000;">(</span>Book1,<span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// 列1のデータを列2にコピー</span></pre>
<p><b>列置換を使用した列計算</b>
</p><p>ブックまたはシートからデータセット名を取得する機能は、次のような異なるシートにある列間の計算を行うのにとても役立ちます。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Sheet2とSheet3のcol(1)を合計し、アクティブシートのcol(1)に入れる </span>
col<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span><span style="color: #000080;">=</span><span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000000;">[</span><span style="color: #000080;">%</span>H<span style="color: #000000;">]</span>sheet2, <span style="color: #0000dd;">1</span><span style="color: #000000;">)</span> <span style="color: #000080;">+</span> <span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000000;">[</span><span style="color: #000080;">%</span>H<span style="color: #000000;">]</span>sheet3, <span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>;
&nbsp;
<span style="color: #008000;">// Book2の最初のシートでcol &quot;signal&quot;を減算 </span>
<span style="color: #008000;">// そして、アクティブブックのSheet3の列&quot;calibrated&quot;に結果を入れる</span>
<span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000000;">[</span><span style="color: #000080;">%</span>H<span style="color: #000000;">]</span>sheet3, <span style="color: #ff00ff;">&quot;calibrated&quot;</span><span style="color: #000000;">)</span><span style="color: #000080;">=</span>col<span style="color: #000000;">(</span>signal<span style="color: #000000;">)</span> <span style="color: #000080;">-</span> <span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000000;">[</span>Book2<span style="color: #000000;">]</span><span style="color: #0000dd;">1</span>,signal<span style="color: #000000;">)</span>;</pre>
<p>ロングネームを使う場合、<i><b>column</b></i> 名は引用符で囲む必要があります。引用符が無い場合、Originは最初にショートネームを探し、見つからなければ、ロングネームを使用します。上述のサンプルの場合、 
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000000;">[</span><span style="color: #000080;">%</span>H<span style="color: #000000;">]</span>sheet3, <span style="color: #ff00ff;">&quot;calibrated&quot;</span><span style="color: #000000;">)</span></pre>
<p>とすると、強制的にロングネームを探しますが、
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000000;">[</span>Book2<span style="color: #000000;">]</span><span style="color: #0000dd;">1</span>,signal<span style="color: #000000;">)</span></pre>
<p>とした場合、ショートネームを持つ列がない場合のみロングネームを使います。
</p>
<h3><a name="Cell_Contents"></a><span class="mw-headline">セルの内容</span></h3>
<p><b>%(workbookName, column,row<i>[,format]</i>)</b> or <b>%([workbookName]sheetName, column,row<i>[,format]</i>)</b>
<br />
</p>
<dl><dd><ul><li> <b>workbookname</b> はワークブックのショートネーム</li>
<li> <b>sheet</b> はシート名、ラベル、インデックスのいずれか</li>
<li> <b>column</b> は列ショートネーム、ロングネーム、インデックスのいずれか</li>
<li> <b>row</b> は行インデックス</li>
<li> <b>format</b>は任意でOrigin 8.1以降で利用可能
<ul><li> フィーマットなし - フル精度</li>
<li> W = セル形式または列形式に基づくWYSIWYG </li>
<li> カスタムフォーマット（<a href="../../LabTalk/LabTalk/Origin_Formats.html" title="LabTalk:Originフォーマット">Originフォーマット</a>を参照）</li></ul></li></ul></dd></dl>
<p><br />
</p><p>Note: セル置換構文の別のバリエーション<b>%([workbookName]sheetName, @WL, column[row][,format])</b> はセルから値を取得するために使用できます。セルに値を割り当てるために使用することはできません。
</p>
<table class="simple" style="width: 90%">
<tr>
<th style="width: 30%">構文
</th>
<th style="width: 30%">説明
</th>
<th style="width: 40%">サンプル
</th></tr>
<tr>
<td> <b>%(<i>workbookName</i>, <i>column</i>, <i>row</i>)</b>
</td>
<td> 指定されたブックのアクティブシート上のセル、完全精度
</td>
<td>
<pre>%(Book1, B, 4) //列ショートネームを使用
%(%H,&quot;&quot;Average Temp&quot;, 4) //列ロングネームを使用
winName$=&quot;Book1&quot;;&nbsp;%(%(winName$), 2, 4); //列インデックスを使用
</pre>
</td></tr>
<tr>
<td> <b>%([<i>workbookname</i>]<i>sheetname</i>, <i>column</i>, <i>row</i>)</b>
</td>
<td> 指定したブックおよびシートのセル、完全精度
</td>
<td>
<pre>//シート名列ショートネームを使用
%([Book1]Sheet1, B, 4) 
//シートラベルと列ロングネームを使用
%([%H]&quot;test result&quot;,&quot;&quot;Average Temp&quot;, 4) 
//シートおよび列インデックスを使用
winName$=&quot;Book1&quot;;&nbsp;%([%(winName$)]3, 2, 4); 
</pre>
</td></tr>
<tr>
<td> <b>%(<i>workbookName</i>, <i>column</i>, <i>row</i>, format)</b>
</td>
<td> 指定されたブックのアクティブシート上のセル、フォーマット指定
</td>
<td>
<pre>//列ショートネームを使用、WYSIWYG
%(Book1, B, 4, W) 
//列ロングネームを使用、小数点以下2桁
%(%H,&quot;&quot;Average Temp&quot;, 4, .2) 
//列インデックスを使用、有効数字3桁
winName$=&quot;Book1&quot;;&nbsp;%(%(winName$), 2, 4, *3); 
</pre>
</td></tr>
<tr>
<td> <b>%([<i>workbookname</i>]<i>sheetname</i>, <i>column</i>, <i>row</i>, format)</b>
</td>
<td> 指定したブックおよびシートのセル、フォーマット指定
</td>
<td>
<pre>//シート名と列ショートネームを使用、WYSIWYG
%([Book1]Sheet1, B, 4, W) 
//シートラベルと列ロングネームを使用、小数点以下2桁
%([%H]&quot;test result&quot;,&quot;&quot;Average Temp&quot;, .2) 
//シートおよび列インデックスを使用、有効数字3桁
winName$=&quot;Book1&quot;;&nbsp;%([%(winName$)]3, 2, *3); 
</pre>
</td></tr></table>
<p><br />
例えば、Book1のアクティブワークシートの4番目の列の3行目のセルに25という値が含まれている場合、スクリプトウィンドウに次のステートメントを入力すると、Aを25にセットし、その値を2倍して同じワークブックの&quot;Results&quot;シートの1列目4行に入力します。 
</p>
<pre class="lt" style="font-family:monospace;">value <span style="color: #000080;">=</span> <span style="color: #000080;">%</span><span style="color: #000000;">(</span>Book1, <span style="color: #0000dd;">4</span>, <span style="color: #0000dd;">3</span><span style="color: #000000;">)</span>;
<span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000000;">[</span>Book1<span style="color: #000000;">]</span>Results, <span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">4</span><span style="color: #000000;">)</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span> <span style="color: #000080;">*</span> value;
<span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000000;">[</span>Book1<span style="color: #000000;">]</span>Results, <span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">4</span><span style="color: #000000;">)</span><span style="color: #000080;">=</span>;</pre>
<p><br />
テキストセルの内容を得るには、文字列変数に代入します。
</p>
<pre class="lt" style="font-family:monospace;">type <span style="color: #000080;">%</span><span style="color: #000000;">(</span>Book1, <span style="color: #0000dd;">2</span>, <span style="color: #0000dd;">5</span><span style="color: #000000;">)</span>; <span style="color: #008000;">//最後に$不要</span>
string strVar<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">%</span><span style="color: #000000;">(</span>Book1, <span style="color: #0000dd;">2</span>, <span style="color: #0000dd;">5</span><span style="color: #000000;">)</span>; <span style="color: #008000;">//最後に$不要</span>
strVar<span style="color: #000080;">$</span> <span style="color: #000080;">=</span>&nbsp;;</pre>
<p><br />
参照しているワークブック/ワークシートの名前がワークシートのセルに保存されている場合、たとえば、参照ワークブック名​​が現在のワークシートの列Aの最初のセルにある場合、次のセル式を使用できます。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000080;">=</span><span style="color: #000000;">[</span>Book<span style="color: #000080;">%</span><span style="color: #000000;">(</span>col<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span><span style="color: #000000;">[</span>i<span style="color: #000000;">]</span><span style="color: #000080;">$</span><span style="color: #000000;">)</span><span style="color: #000000;">]</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span>A1</pre>
<p>参照ブックの1枚目シートのA1セルにB1セルの値を設定します。
</p><p>ただし、%() 置換表記で「A1」を使用する場合は、文字列連結で二重等号構文を使用します。 
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000080;">==</span><span style="color: #ff00ff;">&quot;[Book&quot;</span> <span style="color: #000080;">+</span> A1<span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;]1!A1&quot;</span></pre>
<p>自動入力と数式の更新はそのような表記法でも機能します。
</p><p><br />
Book1のsheet1の列B行3に 12.3456789という数値があるものとし、小数点以下2桁で表示されているとします（この設定は<a class="external text" href="../../UserGuide/UserGuide/The_(Column_Properties)_Properties_Tab.html#Display"><b>列プロパティ</b>ダイアログ</a>で行います）。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//現在の列フォーマットで値を返す</span>
type <span style="color: #ff00ff;">&quot;Displayed value:&nbsp;%([Book1]Sheet1,B,3,W)&quot;</span>;
<span style="color: #008000;">//完全精度の値を返す</span>
type <span style="color: #ff00ff;">&quot;Full precision:&nbsp;%([Book1]Sheet1,B,3)&quot;</span>;
<span style="color: #008000;">//カスタムOriginフォーマットで返す</span>
type <span style="color: #ff00ff;">&quot;3 decimal places:&nbsp;%([Book1]Sheet1,B,3, .3)&quot;</span>;
<span style="color: #008000;">//または@WLオプションを指定して別の式を使用して表示フォーマットを維持</span>
type <span style="color: #ff00ff;">&quot;Displayed value with @WL syntax: &nbsp;%([Book1]Sheet1, @WL, B[3],W)&quot;</span>;</pre>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/String_Substitution/Tip_icon.png" width="57"  border="0" /></td><td><p>Origin 9.1でのフォーマット文字<i>W</i> は、以前のバージョンの<i>C</i> （つまり、%([workbookName]sheetName, column, row,C)）の代わりです。フォーマットパラメータ&quot;C&quot; はサポートされません。
</p></td></tr></table>
<h2><a name="Workbook_Information_Substitution"></a><span class="mw-headline">ワークブック情報の置換</span></h2>
<p>上述の<b>ワークシート列およびワークシートセルの置換</b>表記と同様、ワークシート情報の置換には2つの構文があります。1つはブック内の古い形式の1シートのみのワークブックまたはアクティブシート用で、もう1つはブック内のシートを指定して使用します。
</p>
<h3><a name="Column_Label_Row_Information"></a><span class="mw-headline">列ラベル行情報</span></h3>
<p><b>%(workbookName, @option, columnNumber]<i>)</i></b><i> または <b>%([workbookName]worksheetName, @option, columnNumber)</b></i>
</p><p>この表記により、列ラベル行情報にアクセスできます。
</p>
<table class="simple" style="width: 90%">
<tr>
<th style="width: 50%">構文
</th>
<th style="width: 40%">説明
</th></tr>
<tr>
<td> <b>%(<i>workbookName</i>, @<i>option</i>, <i>columnNumber</i>)</b>
</td>
<td> 名前付きブックのアクティブシートの列情報
</td></tr>
<tr>
<td> <b>%([<i>workbookName</i>]<i>worksheetName</i>, @<i>option</i>, <i>columnNumber</i>)</b>
</td>
<td> 指定したブックおよびシートの列情報
</td></tr></table>
<p><a href="../../LabTalk/LabTalk/Text_Label_Options.html#.40Options_for_Text_Labels" title="LabTalk:テキストラベルオプション">テキストラベルの@オプション</a>から列ラベル行関連<i>options</i>が使用されます。
</p>
<table class="simple">
<tr>
<th style="width: 8%">オプション
</th>
<th style="width: 50%">説明
</th></tr>
<tr>
<td> @C
</td>
<td> 列ショートネームを返す
</td></tr>
<tr>
<td> @D
</td>
<td> 列データセット名を返す
</td></tr>
<tr>
<td> @L
</td>
<td> 列ロングネームを返す
</td></tr>
<tr>
<td> @LA
</td>
<td> 列ロングネームを返します。ロングネームがなければショートネームを返します。
</td></tr>
<tr>
<td> @LC<i>n</i>
</td>
<td> 列コメント（n番目の行）を返します。<i>n</i>がスキップされた場合は1行目のコメントを返します
</td></tr>
<tr>
<td> @LD<i>n</i>
</td>
<td> 列のn番目のユーザ定義パラメータの内容を返します。スキップされた場合<i>n</i>=1
</td></tr>
<tr>
<td> @LD&quot;<i>paraname</i>&quot;
</td>
<td> 「paraname」という名前の列のユーザ定義パラメータの内容を返す
</td></tr>
<tr>
<td> @LG
</td>
<td> 列ロングネーム（単位）を返します。ロングネームがなければショートネームと単位を返します。
</td></tr>
<tr>
<td> @LP<i>n</i>
</td>
<td> 列のn番目のシステムパラメータの内容を返します。スキップされた場合<i>n</i>=1
</td></tr>
<tr>
<td> @LS
</td>
<td> 列ショートネームを返します。@Cと同じ
</td></tr>
<tr>
<td> @LU
</td>
<td> 列単位を返す
</td></tr>
<tr>
<td> @F<i>n</i>
</td>
<td> 列フィルタ情報の<i>n</i> 番目の行を返します。<i>n</i>がスキップされた場合完全なフィルター情報を返します。
</td></tr>
<tr>
<td> @T
</td>
<td> 列の属性を返します。1はY、2は無属性、3はYエラー、4はX、5はラベル、6はＺを、7はＸエラーを意味します。
</td></tr>
<tr>
<td> @U
</td>
<td> 列ロングネーム（単位）を返します。ロングネームがなければショートネームと単位を返します。@LGと同じ
</td></tr></table>
<p><b>サンプル</b>
<br />次のスクリプトは、現在選択されている範囲の最初の列の列名を返します。(<b>selc1</b>数値システム変数に関する情報に関しては、<a href="../../LabTalk/LabTalk/System_Variables.html" title="LabTalk:システム変数">システム変数</a> を参照してください。)
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000080;">%</span>N <span style="color: #000080;">=</span> <span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000080;">%</span>H, @C, selc1<span style="color: #000000;">)</span>;  <span style="color: #000080;">%</span>N <span style="color: #000080;">=</span>;</pre>
<p>以下のスクリプトは、Book 2、Sheet 3の4番目の列の列タイプを返します。
</p>
<pre class="lt" style="font-family:monospace;">type <span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000000;">[</span>Book2<span style="color: #000000;">]</span>Sheet3, @T, <span style="color: #0000dd;">4</span><span style="color: #000000;">)</span>;</pre>
<h3><a name="Worksheet_Information"></a><span class="mw-headline">ワークシート情報</span></h3>
<p><b>%(workbookName, @option <i>[,argument]</i>)</b> or <b>%([workbookName]worksheetName, @option<i>[, argument]</i>)</b>
<br />
この表記により、ワークシート情報とメタデータにアクセスできます。
</p>
<table class="simple" style="width: 90%">
<tr>
<th style="width: 50%">構文
</th>
<th style="width: 40%">説明
</th></tr>
<tr>
<td> <b>%(workbookName, @option<i>[,argument]</i>)</b>
</td>
<td> 指定したブックのアクティブシートのワークシート情報
</td></tr>
<tr>
<td> <b>%([workbookName]worksheetName<i>[, @option, argument]</i>)</b>
</td>
<td> 指定したブックおよびシートのワークシート情報
</td></tr></table>
<p><br />
</p><p>利用可能なオプションは以下にリストされています。 <a href="../../LabTalk/LabTalk/Text_Label_Options.html#.40Options_for_Text_Labels" title="LabTalk:テキストラベルオプション">テキストラベルの@オプション</a>も含まれます。
</p>
<table class="simple">
<tr>
<th style="width: 8%">オプション
</th>
<th style="width: 12%">引数
</th>
<th style="width: 60%">説明
</th></tr>
<tr>
<td> @#
</td>
<td> 不要
</td>
<td> ワークシートの列の合計数を返します。
</td></tr>
<tr>
<td> @CS
</td>
<td> columnNumber
</td>
<td> <i>n</i>番目の列 (およびn番目の列を含む) の右側にある最初に選択された列の列インデックスを返します。見つからない場合は0を返します。
</td></tr>
<tr>
<td> @E#
</td>
<td> オプション
</td>
<td> <i>argument</i> = 1の場合、ワークシート内のYエラー列数を返します。  <i>argument</i> = 2の場合、現在選択されている領域内のYエラー列数を返します。  <i>argument</i> が省略されている場合、1と見なされます。
</td></tr>
<tr>
<td> @H#
</td>
<td> オプション
</td>
<td> <i>argument</i> = 1の場合、ワークシート内のXエラー列数を返します。  <i>argument</i> = 2の場合、現在選択されている領域内のXエラー列数を返します。  <i>argument</i> が省略されている場合、1と見なされます。
</td></tr>
<tr>
<td> @OY
</td>
<td> columnNumber
</td>
<td> 選択された最初のY列から、選択範囲内でその右側にある<i>n</i>番目のY列までのオフセットを返します。<i>n</i>番目のYも選択範囲になければなりません。
</td></tr>
<tr>
<td> @OYX
</td>
<td> columnNumber
</td>
<td> 選択範囲内で左端のY列からその右にある<i>n+1</i>番目に選択されたX列までのオフセットを返します。<i>n</i>番目のXも選択範囲になければなりません。
</td></tr>
<tr>
<td> @OYY
</td>
<td> columnNumber
</td>
<td> 選択された最初のY列から、選択範囲内でその右側にある<i>n</i>番目のY列までのオフセットを返します。<i>n</i>番目のYも選択範囲になければなりません。@OYと同様です。
</td></tr>
<tr>
<td> @SC<i>n</i>
</td>
<td> 不要
</td>
<td> ワークシートコメントのn番目の行を返します。nがスキップされた場合、コメントの最初の行です。
</td></tr>
<tr>
<td> @SN
</td>
<td> 不要
</td>
<td> ワークシート表示名を返す
</td></tr>
<tr>
<td> @SNL
</td>
<td> 不要
</td>
<td> ワークシートラベルを返す
</td></tr>
<tr>
<td> @X
</td>
<td> 不要
</td>
<td> ワークシートの最初のX列の列インデックスを返します。
</td></tr>
<tr>
<td> @Xn
</td>
<td> 不要
</td>
<td> ワークシートの最初のX列の列ショートネームを返します。
</td></tr>
<tr>
<td> @Y-
</td>
<td> 要
</td>
<td> <i>n</i>番目の列の左に最も近いY列の列インデックスを返します。  見つからない場合は0を返します。
</td></tr>
<tr>
<td> @Y#
</td>
<td> オプション
</td>
<td> <i>argument</i> = 1の場合、ワークシート内のY列数を返します。  <i>argument</i> = 2の場合、現在選択されている領域内のY列数を返します。  <i>argument</i> が省略されている場合、1と見なされます。
</td></tr>
<tr>
<td> @Y+
</td>
<td> 要
</td>
<td> <i>n</i>番目の列の右に最も近いY列の列インデックスを返します。見つからない場合は0を返します。
</td></tr>
<tr>
<td> @YS
</td>
<td> 要
</td>
<td> <i>n</i>番目の列 (およびn番目の列を含む) の右側にある選択範囲の最初のY列の列インデックスを返します。
</td></tr>
<tr>
<td> @Z#
</td>
<td> オプション
</td>
<td> <i>argument</i> = 1の場合、ワークシート内のZ列数を返します。  <i>argument</i> = 2の場合、現在選択されている領域内のZ列数を返します。  <i>argument</i> が省略されている場合、1と見なされます。
</td></tr></table>
<p><b>サンプル</b>
<br />
以下のスクリプトはワークシートの表示名を返します。
</p>
<pre class="lt" style="font-family:monospace;">type <span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000080;">%</span>H, @SN<span style="color: #000000;">)</span>;</pre>
<p>Book2、Sheet3の一部の列をYErrorバーとして設定します。いくつかのYErrorバー列を含む、列を選択します。 
以下のスクリプトで、選択範囲内のYError列の数を返します。
</p>
<pre class="lt" style="font-family:monospace;">type <span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000000;">[</span>Book2<span style="color: #000000;">]</span>Sheet3, @E#, <span style="color: #0000dd;">2</span><span style="color: #000000;">)</span>;</pre>
<p>現在のアクティブワークシートが6つの列(XYXYXY)を持っているとします。もし、列2,4,5が選択されているとすると、以下のスクリプトは、最初に選択されたY列の番号を ii 番目の列 (3番目の引数) の右側に表示します。
</p>
<pre class="lt" style="font-family:monospace;">loop<span style="color: #000000;">(</span>ii,<span style="color: #0000dd;">1</span>,wks.<span style="color: #000080;">ncols</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
    type <span style="color: #000080;">-</span>l <span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000080;">%</span>H, @YS, ii<span style="color: #000000;">)</span>,;
<span style="color: #000000;">}</span></pre>
<p>これにより以下が出力されます。
</p>
<pre>   <b>2,2,4,4,0,0,</b>
</pre>
<p><br />
</p>
<h3><a name="Workbook_Information"></a><span class="mw-headline">ワークブック情報</span></h3>
<p><b>%(workbookName, @option)</b> <b>%([workbookName], @option)</b> 
<br />
この表記により、ワークブック情報とメタデータにアクセスできます。 
</p>
<table class="simple" style="width: 90%">
<tr>
<th style="width: 50%">構文
</th>
<th style="width: 40%">説明
</th></tr>
<tr>
<td> <b>%(<i>workbookName</i>, @<i>option</i>)</b>
</td>
<td> 名前付きブックのワークブック情報
</td></tr></table>
<p><b>[%H]Sheet1!A</b>のように最初の引数に <i>[workbookName]Sheet!Column</i> を指定しても問題ありません。シートと列の部分は無視されます。 
</p><p><br />
</p><p>利用可能なオプションは以下にリストされています。 <a href="../../LabTalk/LabTalk/Text_Label_Options.html#.40Options_for_Text_Labels" title="LabTalk:テキストラベルオプション">テキストラベルの@オプション</a>も含まれます。
</p>
<table class="simple">
<tr>
<th style="width: 8%">オプション
</th>
<th style="width: 60%">説明
</th></tr>
<tr>
<td> @PN
</td>
<td> ワークブックウィンドウのショートネームを返します。
</td></tr>
<tr>
<td> @PL
</td>
<td> ワークブックウィンドウのロングネームを返します。
</td></tr>
<tr>
<td> @PC<i>n</i>
</td>
<td> ワークブックウィンドウコメントのn番目の行を返します。すべてのコメントは @PC
</td></tr></table>
<p><b>サンプル</b>
<br />
以下のスクリプトはワークブックのショートネームを返します。
</p>
<pre class="lt" style="font-family:monospace;">type <span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000080;">%</span>H, @PS<span style="color: #000000;">)</span>;</pre>
<h3><a name="Information_Storage_and_Imported_File_Information"></a><span class="mw-headline">情報の保存とインポートしたファイルの情報</span></h3>
<p><b>%([workbookName]<i>Sheet!Column</i>, @Woption, varOrNodeName<i>,[format]</i>)</b>
ここで
</p>
<dl><dd><ul><li> Sheet はシートショートネーム、ロングネーム、インデックスのいずれかです。</li>
<li> Column は列ショートネーム、ロングネーム、インデックスのいずれかです。</li>
<li> フォーマットはオプションで<a href="../../LabTalk/LabTalk/Origin_Formats.html" title="LabTalk:Originフォーマット">Originのフォーマット</a>を参照してください。</li></ul></dd></dl>
<p><br />
Originワークブック、ワークシート、列内に保存されているメタデータや、インポートされたファイルについて保存されている情報にアクセスします。
</p>
<dl><dd><a  class="image"><img alt="String substitution systemdotimport.png" src="../images/String_Substitution/String_substitution_systemdotimport.png" width="824"  /></a></dd></dl>
<table class="simple" style="width: 95%">
<tr>
<th style="width: 55%">構文
</th>
<th style="width: 40%">説明
</th></tr>
<tr>
<td> <b>%([<i>workbookName</i>]<i>sheet</i>!<i>column</i>, @<i>Woption</i>, <i>varOrNodeName</i>)</b>
</td>
<td> フォーマットなしで変数またはノード情報を返す
</td></tr>
<tr>
<td> <b>%([<i>workbookName</i>]<i>sheet</i>!<i>column</i>, @<i>Woption</i>, <i>varOrNodeName</i>, [format])</b>
</td>
<td> フォーマット付きで変数またはノード情報を返す
</td></tr></table>
<p><b>@Woptions</b>の説明
</p>
<table class="simple">
<tr>
<th> オプション
</th>
<th> 戻り値
</th></tr>
<tr>
<td> @W
</td>
<td> <a class="external text" href="../../UserGuide/UserGuide/The_Workbook_Organizer.html"><b>ワークブックオーガナイザ</b></a>の<b>page.info</b>または<b>ユーザツリー</b>の下の<i>varOrNodeName</i>の情報を返します。<i>Sheet!Column</i>を指定する必要はありません。
</td></tr>
<tr>
<td> @WF<i>n</i>
</td>
<td> <a class="external text" href="../../UserGuide/UserGuide/The_Workbook_Organizer.html"><b>ワークブックオーガナイザ</b></a>の<i>n</i>番目の<b>インポートされたファイル</b>の下の<i>varOrNodeName</i>の情報を返します。  <i>Sheet!Column</i>を指定する必要はありません。
</td></tr>
<tr>
<td> @WS
</td>
<td> <a class="external text" href="../../UserGuide/UserGuide/The_Workbook_Organizer.html"><b>ワークブックオーガナイザ</b></a>の<b>データシート</b>の下の<i>n</i>番目のシートの<i>varOrNodeName</i>の情報を返します。<i>Column</i>.を指定する必要はありません。
</td></tr>
<tr>
<td> @WC
</td>
<td> 列レベルのユーザツリーの<i><i>varOrNodeName</i></i><i> </i>の情報を返します。この変数は<a class="external text" href="../../UserGuide/UserGuide/The_(Column_Properties)_User_Tree_Tab.html"><b>列プロパティ</b></a>ダイアログで確認できます。
</td></tr></table>
<p><br />
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/String_Substitution/Tip_icon.png" width="57"  border="0" /></td><td><p>この構文が機能しているか確認する方法の1つとして、ファイルをワークブックにインポート後、<b>テキスト</b>ツールを使用して、ワークシート列の右側の灰色のスペースでテキストラベルを開始することです。右クリックして<b>情報変数の挿入</b>を選択します。<b>情報</b>タブをクリックして、SYSTEM.IMPORTノードを開き、変数を選択して<b>挿入</b>をクリックします。ここでは、使用中の「@W」オプションと、<i>varOrNodeName</i>に格納されている情報を確認できます。変数を挿入ダイアログを閉じてラベルの外側でクリックすると、表記は解決され、ワー​​クブックのメタデータを表示するテキストラベルが作成されます。
</p>
<dl><dd><a  class="image"><img alt="LT Information Storage Substitution.png" src="../images/String_Substitution/LT_Information_Storage_Substitution.png" width="681"  /></a></dd></dl>
</td></tr></table>
<p><br />
<b>サンプル</b>
次の例は、インポートファイル情報、インポート中に抽出された変数、ページ (ブック)、シート、列レベルに保存されているユーザツリーにアクセスする方法を示しています。
<br />
</p><p><b>データ：ファイルからインポート：インポートウィザード...</b>を使用します。 <i>\Samples\Import and Export\</i>にある3つの<i>S*.dat</i> ファイルを選択し、<b>インポートモード</b>を<i>シートを新たに作って読み込む</i>に設定し、Book1に3つのファイルをインポートします。これらのファイルは、いくつかのユーザ変数が抽出された状態でワークブックにインポートされます。<b>ワークブックオーガナイザ</b>開きます。 
</p>
<dl><dd><ul><li> page.info node: 最後にインポートされたファイル関連の情報と変数のみが含まれます。  @W</li>
<li> ページ (ブック) レベルでユーザーツリーとノードを追加します。@Wによるアクセス</li>
<li> インポートされたファイル: インポートされたファイルレベルの変数を追加します。@WF<i>n</i>によるアクセス</li>
<li> データシート: シートレベルのユーザツリーとノードを追加します。@WSによるアクセス</li></ul></dd></dl>
<p>ファイルと最後にインポートされたファイルの抽出された編集情報にアクセスします。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//最後にインポートされたファイル名を返す</span>
type <span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000080;">%</span>H,@W,system.<span style="color: #000080;">import</span>.<span style="color: #000080;">filename</span><span style="color: #000080;">$</span><span style="color: #000000;">)</span>;
<span style="color: #008000;">//mm/dd/yyyyフォーマットを使って最後にインポートされたファイル日付を返す</span>
type <span style="color: #000080;">%</span><span style="color: #000000;">(</span>Book1, @W,system.<span style="color: #000080;">import</span>.<span style="color: #000080;">filedate</span>, D0<span style="color: #000000;">)</span>;
<span style="color: #008000;">//最後にインポートされたファイルで抽出された BatchNo変数を返す</span>
type <span style="color: #000080;">%</span><span style="color: #000000;">(</span>Book1, @W,user.<span style="color: #000080;">variables</span>.<span style="color: #000080;">batchno</span><span style="color: #000000;">)</span>;
<span style="color: #008000;">//最後にインポートされたファイルで抽出されたSample変数を返す</span>
type <span style="color: #000080;">%</span><span style="color: #000000;">(</span>Book1, @W,user.<span style="color: #000080;">variables</span>.<span style="color: #000080;">sampleID</span><span style="color: #000080;">$</span><span style="color: #000000;">)</span>;</pre>
<p><br />
ワークブックオーガナイザで、左側の<b>ユーザツリー</b>を右クリックし<b>ツリーの追加</b>を選択してツリー名<b>Cate</b>を追加します。左側で<b>ユーザツリー -&gt; Cate</b> を選択します。2 つのノードを追加します。<b>Depth</b>という名前の数値ノードと「Direction」という名前のテキストノードです。そうしないと、ワークブック オーガナイザに名前の代わりにラベルが表示され、混乱することがあります。 
<b>Depth</b>値を<i>127.2</i> に設定し、<b>Direction</b>値を<i>East</i>に設定します。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//ユーザツリー -&gt; Cateの下のDepth と Direction 情報を返す</span>
type <span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000080;">%</span>H,@W,tree.<span style="color: #000080;">cate</span>.<span style="color: #000080;">depth</span>, .0<span style="color: #000000;">)</span>; <span style="color: #008000;">//小数点以下桁数なしに</span>
type <span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000080;">%</span>H,@W,tree.<span style="color: #000080;">cate</span>.<span style="color: #000080;">direction</span><span style="color: #000080;">$</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// 文字列は末尾に$を使用</span></pre>
<p><br />
ワークブックオーガナイザで、<b>インポートされたファイル -&gt; S21-235-07.dat</b>（二番目のノード）を開き、ファイルのツリーとノードを確認します。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//2 番目にインポートされたファイルのファイル情報と抽出された変数を返す</span>
<span style="color: #008000;">//変数またはノード名の末尾に$を追加しない</span>
type <span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000080;">%</span>H,@WF2,info.<span style="color: #000080;">filename</span><span style="color: #000000;">)</span>; <span style="color: #008000;">//2番目にインポートされたファイル名を取得</span>
type <span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000080;">%</span>H,@WF2,header<span style="color: #000000;">)</span>; <span style="color: #008000;">//文字列変数に$を追加しない</span>
type <span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000080;">%</span>H,@WF2,Variables.<span style="color: #000080;">header</span>.<span style="color: #000080;">noofpoints</span><span style="color: #000000;">)</span>; <span style="color: #008000;">//ポイント情報の抽出された変数番号を取得</span>
type <span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000080;">%</span>H,@WF2,Variables.<span style="color: #000080;">FileName</span>.<span style="color: #000080;">SampleID</span><span style="color: #000080;">$</span><span style="color: #000000;">)</span>; <span style="color: #008000;">//抽出された変数SampleIDを取得</span></pre>
<p><br />
ワークブック オーガナイザで、<b>データシート -&gt; Trial Run2</b>（2番目のシート）に移動します。 
<b>ユーザツリー</b>ノードを右クリックし、 <b>Condition</b>という名前のツリーを追加します。<b>Temp</b>という名前で値<i>98.6</i>の数値ノードを追加します。値が<i>Failed</i>の<b>Result</b>という名前のテキストノードを追加します。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//ユーザツリー -&gt; Cateの下のDepth および Directionの情報を返す</span>
type <span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Trial Run 2&quot;</span><span style="color: #000080;">!</span>,@WS,tree.<span style="color: #000080;">condition</span>.<span style="color: #000080;">temp</span><span style="color: #000000;">)</span>; <span style="color: #008000;">//現ブックの場合ブック情報をスキップ</span>
type <span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000000;">[</span><span style="color: #000080;">%</span>H<span style="color: #000000;">]</span><span style="color: #0000dd;">2</span><span style="color: #000080;">!</span>,@WS,tree.<span style="color: #000080;">condition</span>.<span style="color: #000080;">result</span><span style="color: #000080;">$</span><span style="color: #000000;">)</span>; <span style="color: #008000;">//シートインデックスを使用、文字列末尾に$を追加</span></pre>
<p><br />
列レベルで<b>ユーザツリー</b>を作成し、@WCでアクセス
</p><p><b>Trial Run 1</b>ワークシートがアクティブな状態で列<b>D</b>をダブルクリックして<b>列プロパティ</b>ダイアログを開きます。
<b>ユーザツリー</b>タブを開きます。右クリックして<b>Machine</b>という名前のツリーを追加します。  <b>Speed</b>という名前で値<i>42.65</i>の数値ノードを追加します。値が<i>MD4</i>の<b>Type</b>という名前のテキストノードを追加します。 
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//列ユーザツリーのType情報を返す</span>
type <span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000000;">[</span><span style="color: #000080;">%</span>H<span style="color: #000000;">]</span><span style="color: #ff00ff;">&quot;Trial Run 1&quot;</span><span style="color: #000080;">!</span><span style="color: #ff00ff;">&quot;Position&quot;</span>,@WC,tree.<span style="color: #000080;">Machine</span>.<span style="color: #000080;">type</span><span style="color: #000080;">$</span><span style="color: #000000;">)</span>; <span style="color: #008000;">//シートおよび列のロングネームを使用</span>
<span style="color: #008000;">//Positionが引用符で囲まれていない場合は、最初に列のショートネームを検索し、見つからない場合はロングネームを使用を検索</span>
type <span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000000;">[</span><span style="color: #000080;">%</span>H<span style="color: #000000;">]</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span>Position,@WC,tree.<span style="color: #000080;">Machine</span>.<span style="color: #000080;">type</span><span style="color: #000080;">$</span><span style="color: #000000;">)</span>;
<span style="color: #008000;">//列ユーザツリーのSpeed情報を返す</span>
<span style="color: #008000;">//シートおよび列インデックスを使用、現ブックの場合ブック情報をスキップ</span>
type <span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #0000dd;">4</span>,@WC,tree.<span style="color: #000080;">Machine</span>.<span style="color: #000080;">speed</span><span style="color: #000000;">)</span> 
<span style="color: #008000;">//シートインデックスと列ショートネームを使用、小数点以下の桁数を0に設定</span>
type <span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span>D,@WC,tree.<span style="color: #000080;">Machine</span>.<span style="color: #000080;">speed</span>, .0<span style="color: #000000;">)</span></pre>
<h2><a name="Legend_and_Axis_Title_SubstitutionLegend_Substitution_Axis_Title_Substitution"></a><span class="mw-headline">凡例と軸タイトルの置換</span></h2>
<p><b>%(PlotSpecifier<i>[, @option, argument1, argument2, ...]</i>)</b>
<br />
最初の引数は、他の%( ) 表記法 (ワークシート置換表記法など) と区別するために数値または?で始まる必要があります。通常、最初の引数はワークブックとワークシートの指定子です。 
</p>
<table class="simple" style="width: 90%">
<tr>
<th style="width: 15%">PlotSpecifier
</th>
<th style="width: 40%">説明
</th>
<th style="width: 35%">例
</th></tr>
<tr>
<td> <b>&lt;plotIndex&gt;</b>
</td>
<td> 現在のレイヤのn番目のプロット、2DのY情報と3DのZ情報
</td>
<td>&nbsp;%(3) //現レイヤ、3番目のプロットのY情報
</td></tr>
<tr>
<td> <b>[layerIndex.]&lt;plotIndex&gt;</b>
</td>
<td> 指定したレイヤの<i>n</i>番目のプロット、2DのY情報と3DのZ情報
</td>
<td>&nbsp;%(2.3) // 2番目のレイヤ、3番目のプロットのY情報
</td></tr>
<tr>
<td> <b>&lt;plotindex&gt;&lt;plotdesignation&gt;</b>
</td>
<td> 現レイヤの<i>n</i>番目のプロットのX, Y または Z
</td>
<td>&nbsp;%(1X) //現レイヤ、1番目のプロットのX情報
</td></tr>
<tr>
<td> <b>[layerIndex.]&lt;plotindex&gt;&lt;plotdesignation&gt;</b>
</td>
<td> 指定したレイヤの<i>n</i>番目のプロットのX, Y または Z
</td>
<td>&nbsp;%(2.1X) //2番目のレイヤ、最初のプロットのX情報
</td></tr>
<tr>
<td> <b>?&lt;plotdesignation&gt;</b>
</td>
<td> 現在のレイヤの自動的に割り当てられるプロットインデックスの X、Y またはZ
</td>
<td>&nbsp;%(?Y) //デフォルトで現レイヤ、最初のプロットのY情報、たとえば、Y軸タイトルを参照
</td></tr>
<tr>
<td> <b>[layerIndex.]?&lt;plotdesignation&gt;</b>
</td>
<td> 指定したレイヤの自動的に割り当てられるプロットインデックスの X、Y またはZ
</td>
<td>&nbsp;%(2.?Y) //デフォルトで第2レイヤ、第1プロットのY情報
</td></tr></table>
<p><br />
<a href="../../LabTalk/LabTalk/Text_Label_Options.html#.40Options_for_Text_Labels" title="LabTalk:テキストラベルオプション">テキストラベルの&quot;@&quot;オプション</a>からすべてのプロット関連のオプションを使用できます。例えば、
</p>
<table class="simple">
<tr>
<th style="width: 10%"><b>@オプション</b>
</th>
<th style="width: 10%"><b>引数</b>
</th>
<th style="width: 35%"><b>説明</b>
</th>
<th style="width: 35%"><b>例</b>
</th></tr>
<tr>
<td> @C
</td>
<td> NA
</td>
<td> 列のショートネーム@LSと同様です。
</td>
<td> <i>%(1,@C)</i>
</td></tr>
<tr>
<td> @LD&quot;<i>name</i>&quot;
</td>
<td> NA
</td>
<td> <i>name</i>によって特定されるユーザ定義パラメータ。
</td>
<td> <i>%(1,@LD&quot;RunNo&quot;)</i>
</td></tr>
<tr>
<td> @LG
</td>
<td> NA
</td>
<td> ロングネーム（使用できなければショートネーム）と単位（あれば）@Uと同様です。
</td>
<td> <i>%(1,@LG)</i>
</td></tr>
<tr>
<td> @V
</td>
<td> <i>RowIndex</i>
</td>
<td> プロットのYデータ内の指定行インデックスのデータ値
</td>
<td>
<ul><li> <i>&nbsp;%(1Y, @V, 2)</i> 
<dl><dd> 最初のプロットのYデータの2行目の値</dd></dl></li></ul>
</td></tr>
<tr>
<td> @WT
</td>
<td> <i>ColIndex</i>/<i>ColName</i>, <i>RowIndex</i>[<i>, format]</i>
</td>
<td> 列インデックス (またはショートネーム) と行インデックスで指定されたシートセルの値。オプションでフォーマットを指定 (<a href="../../LabTalk/LabTalk/Origin_Formats.html" title="LabTalk:Originフォーマット">Originフォーマット</a>参照)。
</td>
<td>
<ul><li><i>%(1, @WT, 2, 3)</i> 
<dl><dd>1つ目のデータプロットのソースシート（ワークシート、行列）にある2列3行目のセルの値 </dd></dl></li>
<li><i>$(&nbsp;%(1, @WT, 2, 3,.4 ) * 100, .2 )</i>
<dl><dd> 数値なので、列2、行3の値を取得し、小数点以下4 桁を保持したまま100倍して、小数点以下2桁を表示するようにフォーマット</dd></dl></li>
<li><i>%(1, @WT, B, 3)</i> 
<dl><dd>1つ目のデータプロットのソースワークシートにあるB列3行目のセルの値</dd></dl></li>
<li><i>%(1, @WT, B, 3, .0)</i> 
<dl><dd>1つ目のデータプロットのソースワークシートにあるB列3行目のセルの値、小数点以下0桁で表示</dd></dl></li></ul>
</td></tr>
<tr>
<td> @WT
</td>
<td> <i>ColIndex</i>/<i>ColName</i>, <i>ColLabelRowCharacter</i>[<i>, format]</i>
</td>
<td> 列インデックス (またはショートネーム) と<a href="../../LabTalk/LabTalk/Column_Label_Row_Characters.html" title="LabTalk:列ラベル行の文字">列ラベル行文字</a>で指定されたワークシートセルの値。オプションで数値のフォーマットを指定 (<a href="../../LabTalk/LabTalk/Origin_Formats.html" title="LabTalk:Originフォーマット">Originフォーマット</a>参照)。
</td>
<td>
<ul><li><i>%(1, @WT, B, C)</i> 
<dl><dd><a href="../../LabTalk/LabTalk/Column_Label_Row_Characters.html#Examples" title="LabTalk:列ラベル行の文字">B[C]$</a>と同様に、これは1つ目のデータプロットのソースワークシートにある列Bのコメントを取得します。</dd></dl></li>
<li> <i>%(1, @WT, 2, D1, *3)</i>
<dl><dd> 1番目のデータプロットのソース ワークシートの 2 列目から最初のユーザ定義パラメータ情報を取得します。数値であると仮定し、有効数字3桁を表示</dd></dl></li></ul>
</td></tr></table>
<p><b>サンプル</b>
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 1番目のプロット (デフォルトでは2DのY データ) の最初のユーザーパラメータ情報を表示</span>
legend.<span style="color: #000080;">text</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> \l<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span> <span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>, @LD1<span style="color: #000000;">)</span>; <span style="color: #008000;">//LHSが$で終わる場合右側の引用符をスキップしても問題ありません</span>
<span style="color: #008000;">//最初のプロットのYデータセットのロングネームとXデータセットのロングネームを表示</span>
legend.<span style="color: #000080;">text</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;\l(1)&nbsp;%(1Y, @LA) vs&nbsp;%(1X, @LA)&quot;</span>;
<span style="color: #008000;">//3つのプロットが異なるシートからのものであると仮定</span>
<span style="color: #008000;">//各プロットのワークシート名を表示</span>
legend.<span style="color: #000080;">text</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;\l(1)&nbsp;%(1,@WS)
\l(2)&nbsp;%(2,@WS)
\l(3)&nbsp;%(3,@WS)&quot;</span></pre>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/String_Substitution/Tip_icon.png" width="57"  border="0" /></td><td><p>すべての凡例を legend.text$ に含める必要があるため、上の最後のスクリプトには欠点があります。<a href="../../LabTalk/Script/Creating_and_Accessing_Graphical_Objects.html#Graph_Legend" title="Script:グラフィックオブジェクトの作成とアクセス">legendupdate Xファンクション</a> は、スクリプトから凡例を変更または再描画する簡単な方法を提供しています。例えば、
</p>
<dl><dd> legendupdate mode:=custom custom:=@WS</dd></dl>
</td></tr></table>
<p>%(?Y) は軸タイトルを、インデックス（1,2,...n）ではなく、事前に指定されたデータプロットインデックス（<b><a class="external text" href="../../UserGuide/UserGuide/The_(Plot_Details)_Legends_Titles_Tab.html#Data_Plot_Index_for_Auto_Axis_Titles">作図の詳細：凡例/タイトル：自動軸タイトルのデータプロットインデックス</a></b>で設定）にデフォルトで設定する可変構文です。
Yデータのロングネームとそれに続く単位を左Y軸のタイトルとして&lt;&gt;内に表示するには、次のようにします。
</p>
<pre class="lt" style="font-family:monospace;">yl.<span style="color: #000080;">text</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">%</span><span style="color: #000000;">(</span>?Y,@<span style="color: #000000;">(</span>@LL<span style="color: #000080;">&lt;</span>@LU<span style="color: #000080;">&gt;</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;</pre>
<p>グラフ凡例と軸タイトルはテキストラベルで指定されます。これらについての詳細な情報は、LabTalkのリファレンスページを参照してください。
</p>
<ul><li> <a href="../../LabTalk/LabTalk/Text_Label_Options.html" title="LabTalk:テキストラベルオプション">テキストラベルの置換</a></li>
<li> <a href="../../LabTalk/LabTalk/Legend_Substitution_Notation.html" title="LabTalk:凡例の置換表記">凡例の置換表記</a></li></ul>
<h2><a name="Keyword_Substitution"></a><span class="mw-headline">キーワード置換</span></h2>
<p>%( ) 置換表記は、タブや改行などの非印刷文字 (制御文字とも呼ばれる) を文字列に挿入するためにも使用されます。  これらの印刷されない文字にアクセスするには、<a href="../../LabTalk/LabTalk/LabTalk_Keywords.html" title="LabTalk:LabTalkキーワード">LabTalk キーワード</a>を使用します。  例えば、
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 改行、ラインフィード(CRLF)を文字列に挿入</span>
string ss<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Hello%(CRLF)Goodbye&quot;</span>;
ss<span style="color: #000080;">$</span><span style="color: #000080;">=</span>;     <span style="color: #008000;">// ANS: &apos;Hello&apos;, &apos;Goodbye&apos; が別の行に出力</span>
<span style="color: #008000;">// 直接入力可能</span>
type ss<span style="color: #000080;">$</span>;
<span style="color: #008000;">// リテラルと混合する場合は%()置換を使用</span>
ty I say <span style="color: #000080;">%</span><span style="color: #000000;">(</span>ss<span style="color: #000080;">$</span><span style="color: #000000;">)</span><span style="color: #000080;">%</span><span style="color: #000000;">(</span>CRLF<span style="color: #000000;">)</span>to you;</pre>
<p>凡例をTABで区切って水平方向に表示します。
</p>
<pre class="lt" style="font-family:monospace;">legend.<span style="color: #000080;">text</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;\l(1)&nbsp;%(1)%(TAB)\l(2)&nbsp;%(2)%(TAB)\l(3)&nbsp;%(3)&quot;</span>;</pre>


    