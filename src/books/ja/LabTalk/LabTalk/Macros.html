<h1 class="firstheading">マクロ</h1><p class='urlname' style='display: none'>マクロ</p>
<h2><a name="Definition_of_the_Macros"></a><span class="mw-headline">マクロの定義</span></h2>
<p>コマンドシンタックス 
</p>
<pre class="lt" style="font-family:monospace;">define macroName <span style="color: #000000;">{</span>script<span style="color: #000000;">}</span></pre>
<p>このコマンドは、<i>macroName</i>と呼ばれるマクロを定義し、それを指定した<i>スクリプト</i>に関連づけます。  この操作により、macroNameはコマンドとして利用でき、スクリプトを呼び起こすこともできます。
</p><p>下記のスクリプトは、指定した文字列を3回出力するマクロhelloを定義しています。  
</p>
<pre class="lt" style="font-family:monospace;">def hello 
<span style="color: #000000;">{</span> 
      loop <span style="color: #000000;">(</span>ii, <span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">3</span><span style="color: #000000;">)</span> 
            <span style="color: #000000;">{</span> type <span style="color: #ff00ff;">&quot;$(ii).Hello World&quot;</span>; <span style="color: #000000;">}</span>
<span style="color: #000000;">}</span>;</pre>
<p>マクロhelloを定義した後、スクリプトウィンドウに文字列<i>hello</i>を入力すると、次の結果が出力されます。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #0000dd;">1</span>.<span style="color: #000080;">Hello</span> World</pre>
<pre class="lt" style="font-family:monospace;"><span style="color: #0000dd;">2</span>.<span style="color: #000080;">Hello</span> World</pre>
<pre class="lt" style="font-family:monospace;"><span style="color: #0000dd;">3</span>.<span style="color: #000080;">Hello</span> World</pre>
<p>マクロを定義したら、次のように入力することで、マクロとして定義されているスクリプトを表示することができます。
</p>
<pre class="lt" style="font-family:monospace;">define macroName;</pre>
<h2><a name="Passing_Arguments_to_MacrosArgument.2C_MacroPass_Arguments_to_Macro"></a><span class="mw-headline">マクロに引数を渡す</span></h2>
<p>マクロには最高5つまで引数を含むことができます。  各引数に対して、スクリプトの中で%1-%5を使用します。  マクロの引数には、数値、文字列、変数、データセット、関数、及びスクリプトが使用可能です。マクロに引数を渡すことは、<a href="../../LabTalk/Script/From_Files.html#Passing_Arguments_in_Scripts" title="Script:ファイルから">スクリプトに引数を渡す</a>ことに似ています。
</p><p>マクロに引数が渡される場合、オブジェクトのプロパティ<a href="#Macro_PropertyMacro_Property">macro.nArg</a>を使用して、引数の数を調べることができます。
</p><p>下記のスクリプトは、数値の引数を1つ持つ<i>ｍｙDouble</i>というマクロを定義します。  このマクロにより、入力した引数の2倍の値が出力されます。
</p>
<pre class="lt" style="font-family:monospace;">def myDouble <span style="color: #000000;">{</span> type <span style="color: #ff00ff;">&quot;$(%1 * 2)&quot;</span>; <span style="color: #000000;">}</span>;</pre>
<p>上記のマクロを定義した後、スクリプトウィンドウに下記のように入力します。
</p>
<pre class="lt" style="font-family:monospace;">myDouble <span style="color: #0000dd;">5</span></pre>
<p>Originはスクリプトウィンドウに下記の結果を出力します。  
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #0000dd;">10</span></pre>
<p>このマクロを2つの引数を取るように修正します。
</p>
<pre class="lt" style="font-family:monospace;">def myDouble <span style="color: #000000;">{</span> type <span style="color: #ff00ff;">&quot;$(%1 *&nbsp;%2)&quot;</span>; <span style="color: #000000;">}</span>;</pre>
<p>マクロの定義後、スクリプトウィンドウに下記のように入力します。
</p>
<pre class="lt" style="font-family:monospace;">myDouble <span style="color: #0000dd;">5</span> <span style="color: #0000dd;">4</span></pre>
<p>Originは、次のように出力します。  
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #0000dd;">20</span></pre>
<h2><a name="Macro_PropertyMacro_Property"></a><span class="mw-headline">マクロのプロパティ<span class="OIndex" style="display:none">マクロのプロパティ</span></span></h2>
<p>macroオブジェクトは、マクロに渡された引数の数を保持するプロパティをもちます。  
</p>
<table class="simple">
<tr>
<th> プロパティ
</th>
<th> アクセス
</th>
<th> 説明
</th></tr>
<tr>
<td> <b>Macro.nArg</b>
</td>
<td> 読み込みのみ,数値
</td>
<td> マクロ中では、このプロパティは、引数の総数を保持しています。
</td></tr></table>
<p>例えば、
</p><p>次のスクリプトは、<i>TypeArgs</i>と呼ばれるマクロを定義します。  マクロTypeArgsに3つの引数が渡されると、このマクロはそれらの引数をスクリプトウィンドウに表示します。 
</p>
<pre class="lt" style="font-family:monospace;">Def TypeArgs 
<span style="color: #000000;">{</span>
      if <span style="color: #000000;">(</span>macro.<span style="color: #000080;">narg</span> <span style="color: #000080;">!</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span><span style="color: #000000;">)</span>
      <span style="color: #000000;">{</span>
            type <span style="color: #ff00ff;">&quot;Error!You must pass 3 arguments!&quot;</span>;
      <span style="color: #000000;">}</span>
      else
      <span style="color: #000000;">{</span>
            type <span style="color: #ff00ff;">&quot;The first argument passed was&nbsp;%1.&quot;</span>;
            type <span style="color: #ff00ff;">&quot;The second argument passed was&nbsp;%2.&quot;</span>;
            type <span style="color: #ff00ff;">&quot;The third argument passed was&nbsp;%3.&quot;</span>;
      <span style="color: #000000;">}</span>
<span style="color: #000000;">}</span>;</pre>
<p>上述した例のようにマクロ<i>TypeArgs</i>を定義して、下記をスクリプトウィンドウに入力すると、  
</p>
<pre class="lt" style="font-family:monospace;">TypeArgs One;</pre>
<p>下記の結果がスクリプトウィンドウに表示されます。
</p>
<pre class="lt" style="font-family:monospace;">Error<span style="color: #000080;">!</span>You must pass <span style="color: #0000dd;">3</span> arguments<span style="color: #000080;">!</span></pre>
<p>上述した例のようにマクロ<i>TypeArgs</i>を定義して、下記をスクリプトウィンドウに入力すると、 
</p>
<pre class="lt" style="font-family:monospace;">TypeArgs  One <span style="color: #000000;">(</span>This is argument Two<span style="color: #000000;">)</span> Three;</pre>
<p>下記の結果がスクリプトウィンドウに表示されます。
</p>
<pre class="lt" style="font-family:monospace;">The first argument passed was One.
<span style="color: #000080;">The</span> second argument passed was This is argument Two.
<span style="color: #000080;">The</span> third argument passed was Three.</pre>







    