<h1 class="firstheading">Sort</h1>

  <p class='urlname' style='display: none'>Sort-obj</p>

  <p><b>LabTalk Object Type:</b></p>

  <dl>
    <dd><a href="../../LabTalk/LabTalk/Utility_Objects,_Property_and_Method_Syntax_(Object).html" title="LabTalk:Utility Objects, Property and Method Syntax (Object)">Utility</a></dd>
  </dl>

  <p>The sort object controls the sorting sequence, order, and range within a worksheet.</p>

  <table class="noborder">
    <tr>
      <td style="vertical-align:top" width="60"><img src="../images/Sort_(object)/Tip_icon.png" width="57" border="0" alt=""></td>

      <td>
        <p>Please see the <a class="external text" href="../../XFunction/X-Function/Wsort.html"><b>wsort</b></a> X-Function.</p>
      </td>
    </tr>
  </table>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>Contents</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1"><a href="#Properties:"><span class="tocnumber">1</span> <span class="toctext">Properties:</span></a></li>

      <li class="toclevel-1 tocsection-2"><a href="#Methods:"><span class="tocnumber">2</span> <span class="toctext">Methods:</span></a></li>

      <li class="toclevel-1 tocsection-3">
        <a href="#Examples:"><span class="tocnumber">3</span> <span class="toctext">Examples:</span></a>

        <ul>
          <li class="toclevel-2 tocsection-4"><a href="#Sort_Columns.2C_Specify_Primary_and_Secondary_Sort_Columns"><span class="tocnumber">3.1</span> <span class="toctext">Sort Columns, Specify Primary and Secondary Sort Columns</span></a></li>

          <li class="toclevel-2 tocsection-5"><a href="#Changing_Sort_Sequence"><span class="tocnumber">3.2</span> <span class="toctext">Changing Sort Sequence</span></a></li>

          <li class="toclevel-2 tocsection-6"><a href="#Ranking"><span class="tocnumber">3.3</span> <span class="toctext">Ranking</span></a></li>
        </ul>
      </li>
    </ul>
  </div>

  <h2><a name="Properties:"></a><span class="mw-headline"><font color="chocolate">Properties:</font></span></h2>

  <table class="simple">
    <tr>
      <th width="110">Property</th>

      <th width="70">Access</th>

      <th width="540">Description</th>
    </tr>

    <tr>
      <td><b>sort.c1</b></td>

      <td>Read/write<br>
      numeric</td>

      <td>
        <p>The column number of the beginning range for sorting. If this number is zero, then all columns in the worksheet are sorted.</p>
      </td>
    </tr>

    <tr>
      <td><b>sort.c2</b></td>

      <td>Read/write<br>
      numeric</td>

      <td>
        <p>The column number of the end range for sorting. This is ignored if <b>c1</b> is zero.</p>
      </td>
    </tr>

    <tr>
      <td><b>sort.cNamen$</b></td>

      <td>Read/write<br>
      string</td>

      <td>
        <p>An enumerated string specifying the sort sequence (primary, secondary, etc.) and order (ascending or descending). The syntax is: <b>sort.cnamen$ = {A|D}: ColumnName</b>; The space between&#160;: and ColumnName is required. n is 1, 2, etc. for the primary, secondary, etc. sort sequence. A for ascending order and D for descending order. ColumnName is the name of the column, which should be one column between c1 and c2</p>
      </td>
    </tr>

    <tr>
      <td><b>sort.missing</b></td>

      <td>Read/write<br>
      numeric</td>

      <td>
        <p>Missing values: 0 = treat missing values as the smallest values within a column, 1 = treat missing values as the largest values within a column.</p>
      </td>
    </tr>

    <tr>
      <td><b>sort.r1</b></td>

      <td>Read/write<br>
      numeric</td>

      <td>
        <p>The row number of the beginning range for sorting.</p>
      </td>
    </tr>

    <tr>
      <td><b>sort.r2</b></td>

      <td>Read/write<br>
      numeric</td>

      <td>
        <p>The row number of the end range for sorting.</p>
      </td>
    </tr>

    <tr>
      <td><b>sort.wksName$</b></td>

      <td>Read/write<br>
      string</td>

      <td>
        <p>The name of the worksheet to be sorted.</p>
      </td>
    </tr>
  </table>

  <h2><a name="Methods:"></a><span class="mw-headline"><font color="chocolate">Methods:</font></span></h2>

  <table class="simple">
    <tr>
      <th width="180">Method</th>

      <th>Description</th>
    </tr>

    <tr>
      <td><b>sort.rank(<i>Dataset1, Dataset2[, n]</i>)</b></td>

      <td>
        <p>Dataset1 is the dataset to be ranked. Dataset2 is the dataset that will hold the ranking results. If n = 0, rank in ascending order. If n = 1, rank in descending order. If n is not included, rank in ascending order. When this method is executed, Origin internally sorts Dataset1 in ascending (or descending, n = 1) order. It then finds the average rank (or row number) for each of the duplicate values. This average value is then appended to Dataset2 in each of the corresponding duplicate cells.</p>
      </td>
    </tr>

    <tr>
      <td><b>sort.toggle(<i>index</i>)</b></td>

      <td>
        <p>Changes the sort order for the sequence specified by index. Index is equivalent to n in the <b>sort.cnamen$</b> property, so that index = 1 for the primary sort sequence, index = 2 for the secondary sort sequence, etc.</p>
      </td>
    </tr>

    <tr>
      <td><b>sort.wks()</b></td>

      <td>
        <p>Executes the sort.</p>
      </td>
    </tr>
  </table>

  <h2><a name="Examples:"></a><span class="mw-headline"><font color="chocolate">Examples:</font></span></h2>

  <h3><a name="Sort_Columns.2C_Specify_Primary_and_Secondary_Sort_Columns"></a><span class="mw-headline">Sort Columns, Specify Primary and Secondary Sort Columns</span></h3>

  <p>This script sorts all columns in the Data1 worksheet from row 3 to row 11, using column B as the primary sort column (descending) and column A as the secondary sort column (ascending).</p>
  <pre class="lt" style="font-family:monospace;">
sort.<span style="color: #000080;">wksname</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>Book1<span style="color: #000000;">]</span>Data1<span style="color: #000080;">!</span>;  <span style="color: #008000;">// For the worksheet Data1 in the Book1</span>
sort.<span style="color: #000080;">c1</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;  <span style="color: #008000;">// all columns</span>
sort.<span style="color: #000080;">r1</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;  <span style="color: #008000;">// from row 3 to</span>
sort.<span style="color: #000080;">r2</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">11</span>;  <span style="color: #008000;">// row 11,</span>
sort.<span style="color: #000080;">cname1</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> D<span style="color: #000000;">:</span> B;  
<span style="color: #008000;">// using column B as the primary, sort in descending order</span>
sort.<span style="color: #000080;">cname2</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> A<span style="color: #000000;">:</span> A;  
<span style="color: #008000;">// and column A as the secondary, sort in ascending order</span>
sort.<span style="color: #000080;">wks</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">// execute sort</span>
</pre>

  <h3><a name="Changing_Sort_Sequence"></a><span class="mw-headline">Changing Sort Sequence</span></h3>

  <p>This script changes the secondary sort sequence from ascending to descending.</p>
  <pre class="lt" style="font-family:monospace;">
sort.<span style="color: #000080;">toggle</span><span style="color: #000000;">(</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">// Changes the sort order for the </span>
<span style="color: #008000;">// secondary sorting sequence</span>
<span style="color: #008000;">// here, changes column A from ascending to descending.</span>
sort.<span style="color: #000080;">wks</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">// execute sort</span>
</pre>

  <h3><a name="Ranking"></a><span class="mw-headline">Ranking</span></h3>

  <p>This script ranks col(1) in descending order and places the ranking results in col(2).</p>
  <pre class="lt" style="font-family:monospace;">
range r1<span style="color: #000080;">=</span>col<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>;
range r2<span style="color: #000080;">=</span>col<span style="color: #000000;">(</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span>;
sort.<span style="color: #000080;">rank</span><span style="color: #000000;">(</span>r1,r2,<span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>;
doc <span style="color: #000080;">-</span>uw;
</pre>
