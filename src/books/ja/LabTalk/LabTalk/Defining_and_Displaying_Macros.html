<h1 class="firstheading">Defining and Displaying Macros</h1>

  <p class='urlname' style='display: none'>Defining-and-Displaying-Macros</p>

  <p>To <a href="../../LabTalk/LabTalk/Define_(command).html" title="LabTalk:Define (command)">define</a> a new macro or to re-define an existing macro, use the define command. Since macros are defined by executing the define command, macros can be defined anywhere in Origin that allows LabTalk scripts to be executed. However, macros are generally defined in *.CNF files which get executed when Origin is started or in the Script window at run time.</p>

  <p>The syntax for the define command is:</p>

  <p>define macroName {script}</p>

  <p>The define command defines a macro named macroName and associates it with a script {script}. MacroName can then be used like a command which, when executed, invokes the script.</p>

  <p>This script defines a macro named hello that uses a loop to print a text string three times in the Script window:</p>
  <pre class="lt" style="font-family:monospace;">
def hello <span style="color: #000000;">{</span>
      loop <span style="color: #000000;">(</span>ii, <span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">3</span><span style="color: #000000;">)</span> <span style="color: #000000;">{</span>
            type <span style="color: #ff00ff;">"$(ii). Hello World"</span>;
      <span style="color: #000000;">}</span>;
<span style="color: #000000;">}</span>;
</pre>

  <p>To display a script that has been previously associated with a defined macro, use the define command without the {script} argument:</p>

  <p>define macroName</p>

  <p>For example:</p>

  <p>Executing the command define hello in the Script window, after having defined the hello macro as described above, will cause the following text to be printed in the Script window:</p>
  <pre class="lt" style="font-family:monospace;">
define hello;
<span style="color: #000000;">{</span>
      loop<span style="color: #000000;">(</span>ii, <span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">3</span><span style="color: #000000;">)</span> <span style="color: #000000;">{</span>
            type <span style="color: #ff00ff;">"$(ii). Hello World"</span>;
      <span style="color: #000000;">}</span>;
<span style="color: #000000;">}</span>
</pre>

  <p>Macros can be passed up to five arguments. Use the  %1, %2, %3, %4, and %5 notation within the script definition to indicate that the macro expects one or more arguments. A macro can accept a number, string, variable, dataset, function, or even a script as an argument. Arguments to an Origin macro function similarly to MS-DOS batch arguments. An executing macro can access the number of arguments passed to it at run time via the macro.nArg object property.</p>

  <p>This script defines a macro named goodbye that uses a loop to print out a goodbye message to the Script window for each argument string (up to five) it is passed.</p>

  <p>The script uses the macro.nArg object property to determine the number of times the loop should iterate.</p>
  <pre class="lt" style="font-family:monospace;">
def goodbye <span style="color: #000000;">{</span>

      <span style="color: #000080;">%</span>Z<span style="color: #000080;">=</span><span style="color: #000080;">%</span>1 <span style="color: #000080;">%</span>2 <span style="color: #000080;">%</span>3 <span style="color: #000080;">%</span>4 <span style="color: #000080;">%</span>5;

      for <span style="color: #000000;">(</span>ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; ii <span style="color: #000080;">&lt;=</span> macro.<span style="color: #000080;">nArg</span>; ii<span style="color: #000080;">++</span><span style="color: #000000;">)</span> <span style="color: #000000;">{</span>

            type <span style="color: #ff00ff;">"$(ii). Goodbye %[%Z,#$(ii)]"</span>;

      <span style="color: #000000;">}</span>;

<span style="color: #000000;">}</span>;
</pre>
