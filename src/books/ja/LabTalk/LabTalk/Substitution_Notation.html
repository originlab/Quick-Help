<h1 class="firstheading">置換表記</h1><p class='urlname' style='display: none'>Substitution-Notation</p>
<p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#IntroductionSubstitution_Notation"><span class="tocnumber">1</span> <span class="toctext">はじめに<span class="OIndex" style="display:none">Substitution Notation</span></span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#.25A_-_.25Z"><span class="tocnumber">2</span> <span class="toctext">%A -&nbsp;%Z</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#.25.28_.29_Substitution"><span class="tocnumber">3</span> <span class="toctext">%( ) 置換</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#String_Expression_SubstitutionString_Expression_Substitution"><span class="tocnumber">3.1</span> <span class="toctext">文字列式の置換<span class="OIndex" style="display:none">String Expression Substitution</span></span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Worksheet_Column_and_Cell_Substitutionsubstitution.2C_worksheet_column.2Fcellworksheet.2C_column_and_cell_substitution"><span class="tocnumber">3.2</span> <span class="toctext">ワークシート列とセルの置換<span class="OIndex" style="display:none">substitution, worksheet column/cell</span><span class="OIndex" style="display:none">worksheet, column and cell substitution</span></span></a>
<ul>
<li class="toclevel-3 tocsection-6"><a href="#To_return_individual_cell_contents"><span class="tocnumber">3.2.1</span> <span class="toctext">個別セルの内容を返す</span></a></li>
<li class="toclevel-3 tocsection-7"><a href="#Formatting_the_return_value"><span class="tocnumber">3.2.2</span> <span class="toctext">戻り値のフォーマット</span></a></li>
<li class="toclevel-3 tocsection-8"><a href="#Return_value_in_current_column_format_with_.22W.22_and_.22.40WL.22"><span class="tocnumber">3.2.3</span> <span class="toctext">&quot;W&quot;および&quot;@WL&quot;で現在の列のフォーマットを返す</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-9"><a href="#Calculation_Involving_Datasets_from_Another_Sheet"><span class="tocnumber">3.3</span> <span class="toctext">他のシートのデータセットを含めた計算</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Worksheet_Information_Substitution"><span class="tocnumber">3.4</span> <span class="toctext">ワークシート情報の置換</span></a>
<ul>
<li class="toclevel-3 tocsection-11"><a href="#To_return_information_on_the_worksheet"><span class="tocnumber">3.4.1</span> <span class="toctext">ワークシートの情報を返すには</span></a></li>
<li class="toclevel-3 tocsection-12"><a href="#Information_Storage_and_Imported_File_Information"><span class="tocnumber">3.4.2</span> <span class="toctext">情報の保存とインポートしたファイルの情報</span></a></li>
<li class="toclevel-3 tocsection-13"><a href="#Examples_of_.40_Substitution"><span class="tocnumber">3.4.3</span> <span class="toctext">@置換のサンプル</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-14"><a href="#Legend_and_Axis_Title_SubstitutionLegend_Substitution_Axis_Title_Substitution"><span class="tocnumber">3.5</span> <span class="toctext">凡例と軸タイトルの置換</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="#Keyword_Substitutionsubstitution.2C_keyword"><span class="tocnumber">3.6</span> <span class="toctext"><span class="OIndex">キーワード置換</span><span class="OIndex HasShownIndex" style="display:none">substitution, keyword</span></span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-16"><a href="#.24.28_.29_Substitution.24.28_.29_Substitution"><span class="tocnumber">4</span> <span class="toctext">$( ) 置換<span class="OIndex" style="display:none">$( ) Substitution</span></span></a>
<ul>
<li class="toclevel-2 tocsection-17"><a href="#Default_Format"><span class="tocnumber">4.1</span> <span class="toctext">デフォルトフォーマット</span></a></li>
<li class="toclevel-2 tocsection-18"><a href="#Origin_Formats"><span class="tocnumber">4.2</span> <span class="toctext">Originフォーマット</span></a></li>
<li class="toclevel-2 tocsection-19"><a href="#C-Language_Formats"><span class="tocnumber">4.3</span> <span class="toctext">C言語フォーマット</span></a></li>
<li class="toclevel-2 tocsection-20"><a href="#Combining_Origin_and_C-language_Formats"><span class="tocnumber">4.4</span> <span class="toctext">OriginとC言語の形式の組合せ</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="#Displaying_Negative_Values"><span class="tocnumber">4.5</span> <span class="toctext">負の値の表示</span></a></li>
<li class="toclevel-2 tocsection-22"><a href="#Dynamic_Variable_Naming_and_Creation"><span class="tocnumber">4.6</span> <span class="toctext">変数の動的な名前付けと作成</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-23"><a href="#.25n_Macro_and_Script_Arguments_Argument.2C_Subsitution.25n.2C_Argument"><span class="tocnumber">5</span> <span class="toctext">%<i>n</i>マクロとスクリプト引数<span class="OIndex" style="display:none">Argument, Subsitution</span><span class="OIndex" style="display:none">%n, Argument</span></span></a></li>
</ul>
</div>

<h2><a name="IntroductionSubstitution_Notation"></a><span class="mw-headline">はじめに<span class="OIndex" style="display:none">Substitution Notation</span></span></h2>
<p>スクリプトが実行される時、それはLabTalkのインタプリタに送られます。  そして、その操作の中でインタプリタは、%と$で始まる2種類の特別な置換表記を探します。  置換表記が見つかると、次のセクションで説明しているように、インタプリタは元の文字列を別の文字列で置き換えます。  置換された文字列の値は、そのステートメントが実際に実行されるまで分かりません。  したがって、この手順は実行時文字列置換と呼ばれます。
</p><p>置換法には以下の3つがあります。
</p>
<ul><li> <a href="#.25A_-_.25Z">文字列レジスタ置換</a>、<span class="OIndex">%A -&nbsp;%Z</span></li>
<li> <a href="#.25.28_.29_Substitution"><span class="OIndex">%( )置換</span></a>、<b>%(str$)</b>、<b>%(range)</b>, ワークシート情報、列データセット名、ワークシートセル、凡例などの置換に利用する表記</li>
<li> <a href="#.24.28_.29_Substitution.24.28_.29_Substitution"><span class="OIndex">$( )置換</span></a>、 $(<i>expression</i>) は、数式を解釈し、結果を文字列の形式にする</li></ul>
<h2><a name=".25A_-_.25Z"></a><span class="mw-headline"><a href="../../LabTalk/LabTalk/String_registers.html" title="LabTalk:文字列レジスタ">%A - %Z</a></span></h2>
<p><a href="../../LabTalk/LabTalk/String_registers.html" title="LabTalk:文字列レジスタ">文字列レジスタ</a>は、最も簡単な置換の形式です。  文字列レジスタは、スクリプト実行中にその内容によって置換されます。以下がサンプルです。
</p>
<pre class="lt" style="font-family:monospace;">FDLOG.<span style="color: #000080;">Open</span><span style="color: #000000;">(</span>A<span style="color: #000000;">)</span>;   <span style="color: #008000;">// ダイアログからファイル名を%Aに入れる</span>
<span style="color: #000080;">%</span>B<span style="color: #000080;">=</span>FDLOG.<span style="color: #000080;">path</span><span style="color: #000080;">$</span>;  <span style="color: #008000;">// ファイルパスを%Bに入れる</span>
doc <span style="color: #000080;">-</span>open <span style="color: #000080;">%</span>B<span style="color: #000080;">%</span>A;  <span style="color: #008000;">//&nbsp;%B%Aはフルパスとファイル名</span></pre>
<p>文字列レジスタは、より信頼性の高いコードを可能にする文字列変数 (Origin 8) が導入される前の古いスクリプトでよく使用されています。<a href="../../LabTalk/LabTalk/Data_Types_and_Variables.html#String_Variables" title="LabTalk:データ型と変数">文字列変数</a>の解釈には、%( )置換が使用されます。これについては、次のセクションで説明します。
</p>
<h2><a name=".25.28_.29_Substitution"></a><span class="mw-headline">%( )置換</span></h2>
<h3><a name="String_Expression_SubstitutionString_Expression_Substitution"></a><span class="mw-headline">文字列式の置換<span class="OIndex" style="display:none">String Expression Substitution</span></span></h3>
<p>LabTalkコマンドは数値の式を受け付けますが、文字列の式は受け付けません。そのため文字列を引数とする必要がある場合、%( )置換を使った文字列変数または文字列式を渡して、実行時の値を解釈する必要があります。文字列式の最も簡単な形式は、次の例のような1つの文字列変数です。
</p>
<pre class="lt" style="font-family:monospace;">string str<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Book2&quot;</span>;         
win <span style="color: #000080;">-</span>o <span style="color: #000080;">%</span><span style="color: #000000;">(</span>str<span style="color: #000080;">$</span><span style="color: #000000;">)</span> <span style="color: #000000;">{</span>wks.<span style="color: #000080;">ncols</span><span style="color: #000080;">=</span>;<span style="color: #000000;">}</span></pre>
<h3><a name="Worksheet_Column_and_Cell_Substitutionsubstitution.2C_worksheet_column.2Fcellworksheet.2C_column_and_cell_substitution"></a><span class="mw-headline">ワークシート列とセルの置換<span class="OIndex" style="display:none">substitution, worksheet column/cell</span><span class="OIndex" style="display:none">worksheet, column and cell substitution</span></span></h3>
<p>次の表記は、文字列としてワークシートセルにアクセスしたり、どのブックのシートからでも列のデータセット名を取得できます。Origin 8より前のバージョンでは、各ブックは1つのシートしかなかったので、ブック名だけでその内容を参照できました。最近のバージョンでは、複数のワークシートをサポートしているので、そのブックに1つのシートだけが含まれていることが確実でなければ、<b>[<i>workbookname</i>]<i>sheetNameorsheetIndex</i></b> の形式で特定のシートにアクセスします。
</p>
<h4><a name="To_return_individual_cell_contents"></a><span class="mw-headline">個別セルの内容を返す</span></h4>
<ul><li> <b>%(<i>workbookName</i>, <i>column</i>, <i>row</i>)</b> -- ブックのアクティブシートを参照</li>
<li> <b>%([<i>workbookname</i>]<i>sheetname</i>, <i>column</i>, <i>row</i>)</b> -- ブックおよびシートを指定</li></ul>
<p><br />
例えば、Book1のアクティブワークシートの4番目の列の3行目のセルに25という値が含まれている場合、スクリプトウィンドウに次のステートメントを入力すると、Aを25にセットし、その値を2倍して同じワークブックの&quot;Results&quot;シートの1列目4行に入力します。 
</p>
<pre class="lt" style="font-family:monospace;">A <span style="color: #000080;">=</span> <span style="color: #000080;">%</span><span style="color: #000000;">(</span>Book1, <span style="color: #0000dd;">4</span>, <span style="color: #0000dd;">3</span><span style="color: #000000;">)</span>;
<span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000000;">[</span>Book1<span style="color: #000000;">]</span>Results, <span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">4</span><span style="color: #000000;">)</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span> <span style="color: #000080;">*</span> A;</pre>
<p><br />
テキストセルの内容を得るには、文字列変数に代入します。
</p>
<pre class="lt" style="font-family:monospace;">string strVar<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">%</span><span style="color: #000000;">(</span>Book1, <span style="color: #0000dd;">2</span>, <span style="color: #0000dd;">5</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// Note&nbsp;: ここでは最後の&apos;$&apos;は必須ではない</span>
strVar<span style="color: #000080;">$</span> <span style="color: #000080;">=</span>&nbsp;;</pre>
<h4><a name="Formatting_the_return_value"></a><span class="mw-headline">戻り値のフォーマット</span></h4>
<ul><li> Origin 8.1より前のバージョンでは、列および行番号のみ指定でき、数値セルには常にフル精度で値が返されました。 </li>
<li> Origin 8.1では、列に対しては、インデックスと列名の両方がサポートされ、<i>行</i>に対しては、<a href="../../LabTalk/LabTalk/Column_Label_Row_Characters.html" title="LabTalk:列ラベル行の文字"><span class="OIndex">ラベル行の文字</span></a>(例えばロングネームは<i>L</i>)もサポートされています。 </li>
<li> さらに、この構文は指定したフォーマットで値を返すためのオプションのフォーマット引数をサポートしています（<b>%([<i>workbookname</i>]<i>sheetname</i>, <i>column</i>, <i>row</i>[,<i>format</i>])</b>）。</li></ul>
<h4><a name="Return_value_in_current_column_format_with_.22W.22_and_.22.40WL.22"></a><span class="mw-headline">&quot;W&quot; および&quot;@WL&quot;で現在の列フォーマットの値を返す</span></h4>
<p>文字「W」を「format」パラメータとして使用して、現在の列形式で値を返します。 
</p><p><b>%([<i>workbookname</i>]<i>sheetname</i>, <i>column</i>, <i>row</i>[,W])</b>
</p><p><br />
<i><b>サンプル:</b></i>
</p><p>Book2のsheet3のcol(Signal)[3]に 12.3456789という数値があるものとしますが、小数点以下2桁が表示されます（この設定は<a class="external text" href="../../UserGuide/UserGuide/The_(Column_Properties)_Properties_Tab.html#Display"><b>列プロパティ</b></a>ダイアログで行います）。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//現在の列フォーマットを使って文字列Wをフォーマット</span>
<span style="color: #008000;">//12.35が返される</span>
type <span style="color: #ff00ff;">&quot;Col(Signal)[3] displayed value is&nbsp;%([Book2]Sheet3,Signal,3,W)&quot;</span>;
<span style="color: #008000;">//フォーマット指定がない場合フル精度</span>
A<span style="color: #000080;">=</span><span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000000;">[</span>Book2<span style="color: #000000;">]</span>Sheet3,Signal,<span style="color: #0000dd;">3</span><span style="color: #000000;">)</span>;
A<span style="color: #000080;">=</span>;<span style="color: #008000;">// 12.3456789が表示</span>
<span style="color: #008000;">//あるいはカスタムフォーマット（例：小数点以下3桁）を指定</span>
type <span style="color: #ff00ff;">&quot;Showing 3 decimal places:%([Book2]Sheet3,Signal,3,.3)&quot;</span>;</pre>
<p><br />
他のシンタックスを使用してデータの表示フォーマットを管理します。<a class="external text" href="../../UserGuide/UserGuide/The_Format_Cells_Dialog_Box.html#Display"><b>セルのフォーマット</b></a>ダイアログまたは<a class="external text" href="../../UserGuide/UserGuide/The_(Column_Properties)_Properties_Tab.html#Display"><b>列プロパティ</b></a>ダイアログを使用して編集します。 
</p><p><b>%([<i>workbookName</i>]<i>sheetName</i>, @WL, <i>column</i>[<i>row</i>][, W])</b>
</p><p><br />
<i><b>サンプル:</b></i>
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//表示フォーマットを保つため、@WL オプション付きのWを使用</span>
type <span style="color: #ff00ff;">&quot;Col(Signal)[3] displayed value is&nbsp;%([Book2]Sheet3, @WL, Signal[3], W)&quot;</span>;
<span style="color: #008000;">//Wを省略した場合、フル精度を返す</span>
B<span style="color: #000080;">=</span><span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000000;">[</span>Book2<span style="color: #000000;">]</span>Sheet3,@WL, Signal<span style="color: #000000;">[</span><span style="color: #0000dd;">3</span><span style="color: #000000;">]</span><span style="color: #000000;">)</span>;
B<span style="color: #000080;">=</span>;<span style="color: #008000;">// 12.3456789が表示</span>
<span style="color: #008000;">//あるいはカスタムフォーマット（例：小数点以下3桁）を指定</span>
type <span style="color: #ff00ff;">&quot;Showing 3 decimal places:%([Book2]Sheet3,@WL, Signal,3,.3)&quot;</span>;</pre>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Substitution_Notation/Tip_icon.png" width="57"  border="0" /></td><td><p>Origin 9.1以降のフォーマット文字<i>W</i> は、以前のバージョンの<i>C</i> の代わりです。しかし、Originは、現在の列フォーマットの値を返すために<b>%([<i>workbookName</i>]<i>sheetName</i>, <i>column</i>, <i>row</i>,C)</b> の使用をサポートしています。
</p></td></tr></table>
<h3><a name="Calculation_Involving_Datasets_from_Another_Sheet"></a><span class="mw-headline">他のシートのデータセットを含めた計算</span></h3>
<p>ブックまたはシートからデータセット名を取得する(データセット置換)機能は、次のような異なるシートにある列間の計算を行うのにとても役立ちます。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Sheet2とSheet3のcol(1)を合計し、アクティブシートのcol(1)に入れる </span>
col<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span><span style="color: #000080;">=</span><span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000000;">[</span><span style="color: #000080;">%</span>H<span style="color: #000000;">]</span>sheet2, <span style="color: #0000dd;">1</span><span style="color: #000000;">)</span> <span style="color: #000080;">+</span> <span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000000;">[</span><span style="color: #000080;">%</span>H<span style="color: #000000;">]</span>sheet3, <span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>;
&nbsp;
<span style="color: #008000;">// Book2の最初のシートでcol &quot;signal&quot;を減算 </span>
<span style="color: #008000;">// そして、アクティブブックのSheet3の列&quot;calibrated&quot;に結果を入れる</span>
<span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000000;">[</span><span style="color: #000080;">%</span>H<span style="color: #000000;">]</span>sheet3, <span style="color: #ff00ff;">&quot;calibrated&quot;</span><span style="color: #000000;">)</span><span style="color: #000080;">=</span>col<span style="color: #000000;">(</span>signal<span style="color: #000000;">)</span> <span style="color: #000080;">-</span> <span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000000;">[</span>Book2<span style="color: #000000;">]</span><span style="color: #0000dd;">1</span>,signal<span style="color: #000000;">)</span>;</pre>
<p>ロングネームを使う場合、<i><b>column</b></i> 名は引用符で囲む必要があります。引用符が無い場合、Originは最初にショートネームを探し、見つからなければ、ロングネームを使用します。上述のサンプルの場合、 
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000000;">[</span><span style="color: #000080;">%</span>H<span style="color: #000000;">]</span>sheet3, <span style="color: #ff00ff;">&quot;calibrated&quot;</span><span style="color: #000000;">)</span></pre>
<p>とすると、強制的にロングネームを探しますが、
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000000;">[</span>Book2<span style="color: #000000;">]</span><span style="color: #0000dd;">1</span>,signal<span style="color: #000000;">)</span></pre>
<p>とした場合、ショートネームを持つ列がない場合のみロングネームを使います。
</p>
<h3><a name="Worksheet_Information_Substitution"></a><span class="mw-headline">ワークシート情報の置換</span></h3>
<p>置換表記でのワークシート列とセルへのアクセスと同様、<span class="OIndex">@置換</span> (<span class="OIndex">ワークシート情報置換</span>)は、<b>@</b>文字を使って、2番目の引数にある列インデックスまたは列名とは区別されます。この表記は、ワークシート情報とメタデータにアクセスできます。
</p><p>上記の<b>ワークシートの列とセルの置換</b>表jきと同様に、1枚のウィンドウにはまだサポートされている古い構文がありますが、新しい表記（Origin 8で導入）を使用することをお勧めします。
</p>
<h4><a name="To_return_information_on_the_worksheet"></a><span class="mw-headline">ワークシートの情報を返すには</span></h4>
<ul><li> <b>%(<i>workbookName</i>, @<i>option</i>, <i>columnNumber</i>)</b> -- 名前付きブックのアクティブシートを参照</li>
<li> <b>%([<i>workbookName</i>]<i>worksheetName</i>, @<i>option</i>, <i>columnNumber</i>)</b> -- シートとブックを指定</li></ul>
<p><br />
ここで、<i>オプション</i> は以下（パラメータ<i>columnNumber</i>はいくつかのオプションで省略されます）のうち一つになります。
</p>
<table class="simple">
<tr>
<th> オプション
</th>
<th> 戻り値
</th></tr>
<tr>
<td> @#
</td>
<td> ワークシートの列の総数を返します。
</td></tr>
<tr>
<td> @CS
</td>
<td> 列の属性に関係なく、<i>columnNumber</i>列から右に数えて、一番最初の選択されている列のインデックス（columnNumber列を含む）を返します。
</td></tr>
<tr>
<td> @E#
</td>
<td> <i>columnNumber</i> = 1の場合、ワークシート内のYエラー列数を返します。  <i>columnNumber</i> = 2の場合、現在選択されている領域内のYエラー列数を返します。  <i>columnNumber</i> が省略されている場合、<i>columnNumber</i> は1と見なされます。
</td></tr>
<tr>
<td> @H#
</td>
<td> <i>columnNumber</i> = 1の場合、ワークシート内のXエラー列数を返します。  <i>columnNumber</i> = 2の場合、現在選択されている領域内のXエラー列数を返します。  <i>columnNumber</i> が省略されている場合、<i>columnNumber</i> は1と見なされます。
</td></tr>
<tr>
<td> @OY
</td>
<td> 選択されている列の1番左のY列から数えた、<i>columnNumber</i>列までのオフセットを返します。
</td></tr>
<tr>
<td> @OYX
</td>
<td> 選択されている列の1番左のY列から数えた、<i>columnNumber</i> Y列までのY列のみのオフセットを返します。
</td></tr>
<tr>
<td> @OYY
</td>
<td> 選択されている列の1番左のY列から数えた、<i>columnNumber</i> X列までのX列のみのオフセットを返します。
</td></tr>
<tr>
<td> @T
</td>
<td> 列の属性を返します。  1はY、2は無属性、3はYエラー、4はX、5はラベル、6はＺを、7はＸエラーを意味します。
</td></tr>
<tr>
<td> @X
</td>
<td> ワークシートの最も左にあるX列の列番号を返します。  列は左から右へ、列番号が1から順に大きくなります。  %(worksheetName, @X); という構文を使います。
</td></tr>
<tr>
<td> @Xn
</td>
<td> ワークシートの最も左にあるX列のショートネームを返します。  %(worksheetName, @Xn); という構文を使います。
</td></tr>
<tr>
<td> @Y
</td>
<td> 選択されている列の1番左の列から数えた、<i>columnNumber</i>列までのオフセットを返します。
</td></tr>
<tr>
<td> @Y-
</td>
<td> 左側の最初のY列の列番号を返します。  指定した列がY列であれば、<i>columnNumber</i>を返します。Y列が見つからなければ、0を返します。  %(worksheetName, @Y-, ColumnNumber); という構文を使います。
</td></tr>
<tr>
<td> @Y#
</td>
<td> <i>columnNumber</i>=1の場合、ワークシートのY列の数を返します。  <i>columnNumber</i>=2の場合、現在選択されている領域内のY列の数を返します。  <i>columnNumber</i> が省略されている場合、<i>columnNumber</i> は1と見なされます。
</td></tr>
<tr>
<td> @Y+
</td>
<td> 右側の最初のY列の列番号を返します。  指定した列がY列であれば、<i>columnNumber</i>を返します。Y列が見つからなければ、0を返します。  %(worksheetName, @Y+, ColumnNumber); という構文を使います。
</td></tr>
<tr>
<td> @YS
</td>
<td> <i>columnNumber</i>列から右に数えて、一番最初の選択されているY列の番号（columnNumber列を含む）を返します。
</td></tr>
<tr>
<td> @Z#
</td>
<td> <i>columnNumber</i>=1の場合、ワークシートのZ列の数を返します。  <i>columnNumber</i>=2の場合、現在選択されている領域内のZ列の数を返します。  <i>columnNumber</i> が省略されている場合、<i>columnNumber</i> は1と見なされます。
</td></tr></table>
<p>この表のオプションは、@オプションまたは@変数として識別される場合があります。<a href="../../LabTalk/LabTalk/Text_Label_Options.html" title="LabTalk:テキストラベルオプション">テキストラベルオプション</a>ページの@オプションは、ワークシート情報の置換でも使用できます。
<br /><br />
</p>
<h4><a name="Information_Storage_and_Imported_File_Information"></a><span class="mw-headline">情報の保存とインポートしたファイルの情報</span></h4>
<p><b>@W</b>変数は、Originのワークブックおよびワークシート、列だけでなく、インポートしたファイルに保存されているメタデータにアクセスします。
</p><p>上記と同様のシンタックスを使って、列番号を変数またはノードの情報で置き換えます。
</p><p><b>%([<i>workbookName</i>]<i>worksheetName</i>!<i>columnName</i>, @<i>option</i>, <i>varOrNodeName</i>)</b>
</p>
<table class="simple">
<tr>
<th> オプション
</th>
<th> 戻り値
</th></tr>
<tr>
<td> @W
</td>
<td> <i>varOrNodeName </i>の情報を返します。この変数はそのワークブックレベルにあると理解され、ワークブック<a class="external text" href="../../UserGuide/UserGuide/The_Workbook_Organizer.html"><b>オーガナイザ</b></a>で確認できます。使用されている場合<i>worksheetName!ColumnName</i>を指定する必要はありません。
</td></tr>

<tr>
<td> @WF<i>n</i>
</td>
<td> <i>n</i>番目のインポートしたファイルに対して<i>varOrNodeName</i> の情報を返します。変数はワークブック<a class="external text" href="../../UserGuide/UserGuide/The_Workbook_Organizer.html"><b>オーガナイザ</b></a>で確認できます。
</td></tr>
<tr>
<td> @WS
</td>
<td> <i>varOrNodeName </i>の情報を返します。この変数はそのワークブックレベルにあると理解され、ワークシート<a class="external text" href="../../UserGuide/UserGuide/The_Workbook_Organizer.html"><b>オーガナイザ</b></a>で確認できます。使用されている場合<i>ColumnName</i>を指定する必要はありません。
</td></tr>

<tr>
<td> @WC
</td>
<td> <i>varOrNodeName </i>の情報を返します。この変数はその列レベルにあると理解され、<a class="external text" href="../../UserGuide/UserGuide/The_(Column_Properties)_User_Tree_Tab.html"><b>列プロパティ</b></a>ダイアログで確認できます。
</td></tr></table>
<p><br />
</p>
<h4><a name="Examples_of_.40_Substitution"></a><span class="mw-headline">@置換のサンプル</span></h4>
<p>以下のスクリプトは、Book 2、Sheet 3の4番目の列の列タイプを返します。
</p>
<pre class="lt" style="font-family:monospace;">string colType<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000000;">[</span>Book2<span style="color: #000000;">]</span>Sheet3, @T, <span style="color: #0000dd;">4</span><span style="color: #000000;">)</span>;  
colType<span style="color: #000080;">$</span><span style="color: #000080;">=</span>;</pre>
<p>インポートフィルタは、ワークブックと共に保存されるインポートファイルに関する情報のツリー構造を作成できます。  ここでは、複数ファイルのインポートの場合、現在のブックにインポートされた3番目のデータセットのポイント数を返します。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000080;">%</span>z<span style="color: #000080;">=</span><span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000080;">%</span>H,@WF3,variables.<span style="color: #000080;">header</span>.<span style="color: #000080;">noofpoints</span><span style="color: #000000;">)</span>;
<span style="color: #000080;">%</span>z<span style="color: #000080;">=</span></pre>
<p>現在のアクティブワークシートが6つの列(XYYYYY)を持っているとします。もし、列2,4,5が選択されているとすると、以下のスクリプトは、<i>columnNumber</i>列（3つ目の引数）から右に数えて、1番最初の選択されたY列番号（columnNumber列を含む）を返します。
</p>
<pre class="lt" style="font-family:monospace;">loop<span style="color: #000000;">(</span>ii,<span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">6</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
    type <span style="color: #000080;">-</span>l <span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000080;">%</span>H, @YS, ii<span style="color: #000000;">)</span>,;
<span style="color: #000000;">}</span>
type;</pre>
<p>これにより以下が出力されます。
</p>
<pre>   <b>2,2,4,4,5,0,</b>
</pre>
<h3><a name="Legend_and_Axis_Title_SubstitutionLegend_Substitution_Axis_Title_Substitution"></a><span class="mw-headline">凡例と軸タイトルの置換</span></h3>
<p>グラフの凡例と軸タイトルも %( )置換を使うことができます。最初の引数は整数値で、最初の引数がワークシート指定子であるような他の%( )置換とは区別されなければなりません。凡例と軸タイトルの置換のシンタックスは次のようになります。
</p><p><b>%(<i>PlotIndex</i>[, @<i>option</i>])</b>
</p><p>ここで、<i>PlotIndex</i> は現在のレイヤにあるデータプロットのインデックスあるいは、クエスチョンマーク(&quot;?&quot;)です。多くのオプションを<i><i>PlotIndex</i> </i>の後に指定でき、通常、データセットと結びついているプロット属性の文字(X, Y, Z)であり、指定していなければ、Yと見なされます。指定されていれば、<i>@オプション</i>は、凡例の内容を制御します。  例えば、
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 現在のグラフレイヤの凡例内で ...</span>
<span style="color: #008000;">// 最初の従属データセットのロングネームを表示</span>
legend.<span style="color: #000080;">text</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">%</span><span style="color: #000000;">(</span>1Y, @LL<span style="color: #000000;">)</span>  
&nbsp;
<span style="color: #008000;">// 同等のコマンド(デフォルトのYが使われる)</span>
legend.<span style="color: #000080;">text</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>, @LL<span style="color: #000000;">)</span></pre>
<p>次のスクリプトは、凡例に2番目の独立データセット(例; X)のショートネームを表示します。
</p>
<pre class="lt" style="font-family:monospace;">legend.<span style="color: #000080;">text</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">%</span><span style="color: #000000;">(</span>2X, @LS<span style="color: #000000;">)</span></pre>
<p>%(?Y) は軸タイトルを、インデックス（1,2,...n）ではなく、事前に指定されたデータプロットインデックス（<b>作図の詳細：凡例/タイトル：自動軸タイトルのデータプロットインデックス</b>で設定）にデフォルトで設定する可変構文です。
Yデータのロングネームとそれに続く単位を左Y軸のタイトルとして&lt;&gt;内に表示するには、次のようにします。
</p>
<pre class="lt" style="font-family:monospace;">yl.<span style="color: #000080;">text</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">%</span><span style="color: #000000;">(</span>?Y,@<span style="color: #000000;">(</span>@LL<span style="color: #000080;">&lt;</span>@LU<span style="color: #000080;">&gt;</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;</pre>
<p><br />
<a href="../../LabTalk/LabTalk/Legend_Substitution_Notation.html" title="LabTalk:凡例の置換表記">凡例の置換表記ページ</a>の詳細な情報と、＠オプションの完全なリストの<a href="../../LabTalk/LabTalk/Text_Label_Options.html#.40Options_for_Returning_Plot_Metadata" title="LabTalk:テキストラベルオプション">テキストラベルオプションページ</a>を参照してください。
</p><p><b>Note</b>: この凡例の変更スタイルは、単一の凡例項目のみの変更に限られますが、<b>作図の詳細</b>ダイアログで使用することができるよう構成されています。
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Substitution_Notation/Tip_icon.png" width="57"  border="0" /></td><td><p><a href="../../LabTalk/Script/Creating_and_Accessing_Graphical_Objects.html#Graph_Legend" title="Script:グラフィックオブジェクトの作成とアクセス">legendupdate Xファンクション</a>は、スクリプトから凡例を編集するより簡単で包括的な方法を提供します。
</p></td></tr></table>
<h3><a name="Keyword_Substitutionsubstitution.2C_keyword"></a><span class="mw-headline"><span class="OIndex">キーワード置換</span><span class="OIndex HasShownIndex" style="display:none">substitution, keyword</span></span></h3>
<p>%( ) 置換表記は、タブや改行などの非印刷文字 (制御文字とも呼ばれる) を文字列に挿入するためにも使用されます。  これらの印刷されない文字にアクセスするには、<a href="../../LabTalk/LabTalk/LabTalk_Keywords.html" title="LabTalk:LabTalkキーワード">LabTalk キーワード</a>を使用します。  例えば、
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 改行、ラインフィード(CRLF)を文字列に挿入</span>
string ss<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Hello%(CRLF)Goodbye&quot;</span>;
ss<span style="color: #000080;">$</span><span style="color: #000080;">=</span>;     <span style="color: #008000;">// ANS: &apos;Hello&apos;, &apos;Goodbye&apos; が別の行に出力</span>
<span style="color: #008000;">// 直接入力可能</span>
type ss<span style="color: #000080;">$</span>;
<span style="color: #008000;">// リテラルと混合する場合は%()置換を使用</span>
ty I say <span style="color: #000080;">%</span><span style="color: #000000;">(</span>ss<span style="color: #000080;">$</span><span style="color: #000000;">)</span> you say;</pre>
<h2><a name=".24.28_.29_Substitution.24.28_.29_Substitution"></a><span class="mw-headline">$( ) 置換<span class="OIndex" style="display:none">$( ) Substitution</span></span></h2>
<p>数値を文字列に変換するには$()置換を使用します。  この表記は、与えられた数式を実行時に評価し、その結果を数値文字列に変換して置き換えます。
</p><p>この表記は次のような構成で使用します。
</p><p><b>$(<i>expression</i> [, <i>format</i>])</b>
</p><p><i>expression</i>は任意の数式、データセットまたはデータ範囲にすることができます。<i>format</i>は、必須ではありません。ここではOriginフォーマットまたはC言語フォーマットのどちらも利用できます。
</p><p><i>expression</i> がデータセットまたはデータ範囲の場合、スペース区切りの値リストを返します。<font color="red">(利用可能なバージョン: 9.1 SR0以降)</font>
</p><p>例
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//データセットを定義</span>
dataset ds1 <span style="color: #000080;">=</span> <span style="color: #000000;">{</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">3</span>, <span style="color: #0000dd;">5</span>, <span style="color: #0000dd;">7</span><span style="color: #000000;">}</span>;
<span style="color: #008000;">//置換表記の結果を出力</span>
type <span style="color: #000080;">$</span><span style="color: #000000;">(</span>ds1<span style="color: #000000;">)</span>;<span style="color: #008000;">//ANS:1 3 5 7;</span>
type <span style="color: #000080;">$</span><span style="color: #000000;">(</span>ds1, <span style="color: #000080;">*</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span>;<span style="color: #008000;">//ANS: 1.0 3.0 5.0 7.0</span>

<span style="color: #008000;">/第1列の値を範囲変数rxに渡す</span>
range rx <span style="color: #000080;">=</span> col<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>;
<span style="color: #008000;">//置換表記の結果出力</span>
type <span style="color: #000080;">$</span><span style="color: #000000;">(</span>rx<span style="color: #000000;">)</span>;</pre>
<h3><a name="Default_Format"></a><span class="mw-headline">デフォルトフォーマット</span></h3>
<p>角括弧は、<i>format</i> が<b>$()</b> 置換表記に対して任意の引数であることを示します。  もし、<i>format</i> を除外すると、Originは<b>@SD</b><a href="../../LabTalk/LabTalk/System_Variables.html#DATA" title="LabTalk:システム変数">システム変数</a>（デフォルト値は14）により指定された桁または有効桁数で<i>expression</i>を実行します。  例えば、
</p>
<pre class="lt" style="font-family:monospace;">double aa <span style="color: #000080;">=</span>  <span style="color: #0000dd;">3.14159265358979323846</span>;
type <span style="color: #000080;">$</span><span style="color: #000000;">(</span>aa<span style="color: #000000;">)</span>;    <span style="color: #008000;">// ANS: 3.1415926535898</span></pre>
<h3><a name="Origin_Formats"></a><span class="mw-headline">Originフォーマット</span></h3>
<p>Originは、ワークシートまたはテキストラベルの数値のカスタムフォーマットをサポートしています。以下は部分的なリストであり、概念を示すためだけのものです。数値フォーマットオプションの全リストは、<a href="../../LabTalk/LabTalk/Origin_Formats.html" title="LabTalk:Originフォーマット"><b>Reference Tables: Origin Formats</b></a>を参照してください。
</p><p><br />
</p>
<table class="simple">
<tr>
<th> フォーマット
</th>
<th> 説明
</th>
<th> 例
</th></tr>
<tr>
<td align="center"> *<i>n</i>
</td>
<td> <i>n</i> 桁の有効桁数を表示します。
</td>
<td>
<pre>xx=1.23456; 
type &quot;xx = $(xx, *2)&quot;; //ANS: xx=1.2
</pre>
</td></tr>
<tr>
<td align="center"> .<i>n</i>
</td>
<td> <i>n</i> 桁の小数桁数を表示します。
</td>
<td>
<pre>xx=1.23456; 
type &quot;xx = $(xx, .2)&quot;; //ANS: xx=1.23
</pre>
</td></tr>
<tr>
<td align="center"> *<i>n</i>*
</td>
<td> <i>n</i>桁の有効数字を表示し、末尾のゼロを切り捨てます
</td>
<td>
<pre>xx = 1.10001; 
type &quot;xx = $(xx, *4*)&quot;; //ANS: xx=1.1
</pre>
</td></tr>
<tr>
<td align="center"> .<i>n</i>,
</td>
<td> カンマ区切り記号を使用して、小数点以下n桁を表示(US, UK, など)
</td>
<td>
<pre>xx = 1234.5678;
type &quot;xx = $(xx, .2,)&quot;; //ANS: xx=1,234.57
xx= 10000;
type &quot;$(xx, .0,)&quot;; //ANS: 10,000
</pre>
</td></tr>
<tr>
<td align="center"> E.<i>n</i>
</td>
<td> 工学表記で<i>n</i> 桁の小数桁数を表示します。
</td>
<td>
<pre>xx=203465987;
type &quot;xx = $(xx, E*3)&quot;; //ANS: xx=203M
</pre>
</td></tr>
<tr>
<td align="center"> S*<i>n</i>
</td>
<td> <b>1E3</b>の形式の科学表記で <i>n</i> 桁の有効桁数を表示
</td>
<td>
<pre>xx=203465987;
type &quot;xx = $(xx, S*3)&quot;; //ANS: xx=2.03E+08
</pre>
</td></tr>
<tr>
<td align="center"> D<i>&lt;format&gt;</i>
</td>
<td> カスタム日付形式を表示します。ここで、<i>&lt;format&gt;</i> は、<a class="external text" href="../../UserGuide/UserGuide/The_(Column_Properties)_Properties_Tab.html#Display">列プロパティ<b>表示</b>リスト</a>の先頭から始まる、フォーマットのインデックス番号（0からカウント）または、<a href="../../LabTalk/LabTalk/Date_and_Time_Format_Specifiers.html" title="LabTalk：日付と時間のフォーマット指示子">これらの日時形式指定子</a>を使用して作成された文字列のいずれかです。
</td>
<td>
<pre>type &quot;$(date(7/20/2009), D1)&quot;;  // ANS: Monday, July 20, 2009
type &quot;$(date(7/20/2009), Dyyyy&apos;-&apos;MM&apos;-&apos;dd)&quot;;  //ANS: 2009-07-20
DT=2459858.6946202; //DTにユリウス日を割り当てる
type &quot;DT = $(DT, D1)&quot;; // ANS: DT = Thursday, October 6, 2022
type &quot;Now= $(@D, DMM-dd-yyyy h:mm:ss tt)&quot;; // @D: 現在の日付と時間
</pre>
</td></tr>
<tr>
<td align="center"> T<i>&lt;format&gt;</i>
</td>
<td> カスタム時間形式を表示します。ここで、<i>&lt;format&gt;</i> は、<a class="external text" href="../../UserGuide/UserGuide/The_(Column_Properties)_Properties_Tab.html#Display">列プロパティ<b>表示</b>リスト</a>の先頭から始まる、フォーマットのインデックス番号（0からカウント）または、<a href="../../LabTalk/LabTalk/Date_and_Time_Format_Specifiers.html" title="LabTalk：日付と時間のフォーマット指示子">これらの時間形式指定子</a>を使用して作成された文字列のいずれかです。
</td>
<td>
<pre>type &quot;$(time(14:31:04), T4)&quot;;   //ANS: 02 PM
type &quot;$(time(14:31:04), Thh&apos;.&apos;mm&apos;.&apos;ss)&quot;;  //ANS: 02.31.04
DT=2459858.6946202;
type &quot;DT = $(DT, T0)&quot;; // ANS: DT = 16:40
type &quot;Now = $(@D, THH:mm:ss.##)&quot;; // @D: 現在の日付と時間
</pre>
</td></tr>
<tr>
<td align="center"> C<i>&lt;format&gt;</i>
</td>
<td> カレンダーのフォーマットで月や曜日を表示します。&lt;format&gt; は M# (月) または D# =曜日です。# は 0 (3文字), 1 (完全) または 2 (1文字)　に設定できます。
</td>
<td>
<pre>type &quot;$(12, CM0)&quot;;  // ANS: Dec
type &quot;$(3, CD1)&quot;;  // ANS: Wednesday
</pre>
</td></tr>
<tr>
<td align="center"> #<i>n</i>
</td>
<td> 整数値を<i>n</i>桁で表示、必要な場所で、0を付加
</td>
<td>
<pre>xx=45;
type &quot;xx=$(xx, #5)&quot;; //ANS: 00045
</pre>
</td></tr>
<tr>
<td align="center"> <i>&lt;prefix&gt;</i>##<i>&lt;sep&gt;</i>###<i>&lt;suffix&gt;</i>
</td>
<td> 数字の間にセパレータ (<i>&lt;sep&gt;</i>) を指定して数値を表示し、オプションで接頭語(<i>&lt;prefix&gt;</i>) や接尾辞 (<i>&lt;suffix&gt;</i>)を追加します。1つの<b>#</b>記号は1桁を示します。この式の最後の<b>#</b>は、常に単位の数字を参照します。最初と2番目の部分の<b>#</b>の数は変更できます。
</td>
<td>
<pre>xx=56000;
type &quot;xx=$(xx, ##+###)&quot;; //ANS: xx=56+000
xx=4000; 
type &quot;xx=$(xx, ##+##M)&quot;; //ANS: xx=40+00M
</pre>
</td></tr>
<tr>
<td align="center"># #/<i>n</i>
</td>
<td> <i>n</i> を分母として指定して、数値を小数として丸めて表示します。分子と分母はスラッシュ<b>/</b>で区切られます。分子の桁数は調整されます。
</td>
<td>
<pre>AA = 0.334;
type &quot;AA = $(AA, # ##/##)&quot;; //ANS: AA = 1/3
type &quot;AA = $(AA, # #/8)&quot;; //ANS: AA = 3/8
</pre>
</td></tr>
<tr>
<td align="center">D[<i>&lt;space&gt;</i>]M[S][F][<i>n</i>]
</td>
<td> 度数を<i>Degree° Minute&apos; Second&quot;</i>の形式で表示します。ここで、1度= 60分、1分= 60秒です。それぞれを区切るためにスペースを挿入します。<i>N</i> は、分数の小数点以下の桁を示します。<b>F</b>は、記号なしで区切り記号としてスペースを挿入して次数を表示します。
</td>
<td>
<pre>DD = 37.34255;
type &quot;DD = $(DD, DMS)&quot;; //ANS: DD = 37°20&apos;33&quot;
type &quot;DD = $(DD, D MS)&quot;; //ANS: DD = 37° 20&apos; 33&quot;
type &quot;DD = $(DD, DMSF)&quot;; //ANS: DD = 37 20 33
type &quot;DD = $(DD, DMF1)&quot;; //ANS: DD = 37 20.6
</pre>
</td></tr></table>
<h3><a name="C-Language_Formats"></a><span class="mw-headline">C言語の形式</span></h3>
<p>$() 置換の <i>format </i>の部分は、C言語形式のステートメントもサポートします。
</p>
<table class="simple">
<tr>
<th> オプション
</th>
<th> 符号の有無
</th>
<th> 出力
</th>
<th> 入力範囲
</th>
<th> 例
</th></tr>
<tr>
<td> d, i
</td>
<td> 符号付き
</td>
<td> 整数値(小数の整数部分または整数値)
</td>
<td> -2^31 -- 2^31 -1
</td>
<td>
<pre>double nn = -247.56;
type &quot;Value: $(nn,%d)&quot;; // ANS: -247
</pre>
</td></tr>
<tr>
<td> f, e, E, g, G
</td>
<td> 符号付き
</td>
<td> 十進数、科学表記、十進または科学表記
</td>
<td> +/-1e290 -- +/-1e-290
</td>
<td>
<pre>double nn = 1.23456e5;
type &quot;Values: $(nn,&nbsp;%9.4f), $(nn,&nbsp;%9.4E), $(nn,&nbsp;%g)&quot;;
// ANS: 123456.0000, 1.2346E+005, 123456
double nn = 1.23456e6;
type &quot;Values: $(nn,&nbsp;%9.4f), $(nn,&nbsp;%9.4E), $(nn,&nbsp;%g)&quot;;
// ANS: 123456.0000, 1.2346E+006, 1.23456e+006
</pre>
</td></tr>
<tr>
<td> o, u, x, X
</td>
<td> 符号なし
</td>
<td> 8進数、整数、16進数、16進数(大文字)
</td>
<td> -2^31 -- 2^32 - 1
</td>
<td>
<pre>double nn = 65551;
type &quot;Values: $(nn,&nbsp;%o), $(nn,&nbsp;%u), $(nn,&nbsp;%X)&quot;;
// ANS: 200017, 65551, 1000F
</pre>
</td></tr></table>
<p>Note: 最後のカテゴリでは、負の値は2つの成分で表されます。
</p>
<h3><a name="Combining_Origin_and_C-language_Formats"></a><span class="mw-headline">OriginとC言語の形式の組合せ</span></h3>
<p>Originは、C言語形式の指定子を使って、<i>E</i> と <i>S</i> の形式の使用をサポートしています。  例えば、
</p>
<pre class="lt" style="font-family:monospace;">xx <span style="color: #000080;">=</span> 1e6;
type <span style="color: #ff00ff;">&quot;xx = $(xx, E%4.2f)&quot;</span>;  <span style="color: #008000;">// ANS: 1.00M</span></pre>
<h3><a name="Displaying_Negative_Values"></a><span class="mw-headline">負の値の表示</span></h3>
<p><b>type</b> コマンド(およびその他)のコマンド解析は、オプションスイッチ指示子として <b>-</b> 記号を探します。変数Kに負の値を割り当て、typeコマンドを使ってその値を表す場合、引用符または括弧で置換表記を囲み <b>-</b> 記号を保護する必要があります。例
</p>
<pre class="lt" style="font-family:monospace;">K <span style="color: #000080;">=</span> <span style="color: #000080;">-</span><span style="color: #0000dd;">5</span>;
type <span style="color: #ff00ff;">&quot;$(K)&quot;</span>; <span style="color: #008000;">// これは動作する</span>
type <span style="color: #000000;">(</span><span style="color: #000080;">$</span><span style="color: #000000;">(</span>K<span style="color: #000000;">)</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// これも動作する</span>
type <span style="color: #000080;">$</span><span style="color: #000000;">(</span>K<span style="color: #000000;">)</span>;   <span style="color: #008000;">// これはtypeコマンドが -5オプションを持たないのでエラー</span></pre>
<h3><a name="Dynamic_Variable_Naming_and_Creation"></a><span class="mw-headline">変数の動的な名前付けと作成</span></h3>
<p>代入ステートメントでは、置換表記$()は、代入演算子の右辺、左辺のいずれの側にあるかに関係なく、置換操作をし、値を与えます。
</p><p>このスクリプトは、値 2 を持つ変数 A を作成します。  
</p>
<pre class="lt" style="font-family:monospace;">A <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;</pre>
<p>次に、次の表記法で値 3 を持つ変数 A2 を作成できます。
</p>
<pre class="lt" style="font-family:monospace;">A<span style="color: #000080;">$</span><span style="color: #000000;">(</span>A<span style="color: #000000;">)</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;</pre>
<p>スクリプトウィンドウに <b>A$(A) =</b> または <b>A2 =</b>  を入力して、確認できます。
</p>
<hr />
<p>$()置換の他のサンプルについては、<a href="../../LabTalk/Script/Converting_to_String.html" title="Script:文字列へ変換">数値から文字列</a>への変換をご覧下さい。
</p>
<h2><a name=".25n_Macro_and_Script_Arguments_Argument.2C_Subsitution.25n.2C_Argument"></a><span class="mw-headline">%<i>n</i>マクロとスクリプト引数<span class="OIndex" style="display:none">Argument, Subsitution</span><span class="OIndex" style="display:none">%n, Argument</span></span></h2>
<p><b>%<i>n</i></b> 形式の置換は、<a href="../../LabTalk/LabTalk/Macros.html#Passing_Arguments_to_Macros" title="LabTalk:マクロ">マクロ</a>または<a href="../../LabTalk/Script/From_Files.html#Passing_Arguments_in_Scripts" title="Script:ファイルから">スクリプトセクション</a>に渡される引数で使われます。ここで<i>n</i> は1-5の整数です (最大5つまでの引数をマクロまたはスクリプトに渡すことができます) 。 
</p><p>次のスクリプトサンプルは、二つの引数（%1と%2）を取り、それらを足し合わせ、合計をダイアログボックスに出力する<a href="../../LabTalk/LabTalk/Macros.html" title="LabTalk:マクロ">マクロ</a>を定義しています。
</p>
<pre class="lt" style="font-family:monospace;">def add <span style="color: #000000;">{</span>type <span style="color: #000080;">-</span>b <span style="color: #ff00ff;">&quot;(%1 +&nbsp;%2) = $(%1 +&nbsp;%2)&quot;</span><span style="color: #000000;">}</span></pre>
<p>定義をしたら、次のように入力してマクロを実行できます。
</p>
<pre class="lt" style="font-family:monospace;">add <span style="color: #000080;">-</span><span style="color: #0000dd;">13</span> <span style="color: #0000dd;">27</span>;</pre>
<p>出力文字列は次のとおりです。
</p><p>(-13 + 27) = 14
</p><p>なぜなら数式 $(%1 +&nbsp;%2) は14となるためです。
</p>


    