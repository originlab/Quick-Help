<h1 class="firstheading">列ラベル行データへのアクセス</h1><p class='urlname' style='display: none'>列ラベル行の文字</p>
<h2><a name="Introduction"></a><span class="mw-headline">はじめに</span></h2>
<p>ワークシートの列ラベルの行は通常、1つもしくはそれ以上のデータ（データセット）列と関係したメタデータを含んでいます。このメタデータはLabTalkスクリプトやユーザインタフェースのさまざまな場所を通じて利用することができます。注意：
</p>
<ul><li> スクリプトからメタデータにアクセスするための構文-- および<b>wcol(n)</b>関数を使用したGUIアクセス --は、<a href="../../LabTalk/LabTalk/Column_Label_Row_Characters.html#Column_Label_Row_Properties" title="LabTalk:列ラベル行の文字">この表</a>の<b>列ラベル行プロパティ</b>を使用します 。</li>
<li> GUI(軸のタイトル、凡例など)でメタデータにアクセスするための構文は、通常、<a href="../../LabTalk/LabTalk/Legend_Substitution_Notation.html#List_of_.40Options" title="LabTalk:凡例の置換表記">このページにリストされている@オプション</a>を使用します。</li></ul>
<p><br />
</p>
<table class="simple" width="95%">
<tr>
<th width="20%">要素
</th>
<th width="40%">使用場所
</th>
<th width="35%">サンプル
</th></tr>
<tr>
<td><a href="../../LabTalk/LabTalk/String_Substitution.html#Legend_and_Axis_Title_SubstitutionLegend_Substitution_Axis_Title_Substitution" title="LabTalk:文字列の置換">軸タイトル</a>
</td>
<td>
<ul><li> <a class="external text" href="../../UserGuide/UserGuide/Title_2.html#Text">軸ダイアログ<b>タイトル</b>タブ</a> </li></ul>
</td>
<td>
<p><b>%(1,@LL)</b>
</p>
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Legend_Substitution_Notation.html" title="LabTalk:凡例の置換表記">凡例</a>
</td>
<td>
<ul><li> <a class="external text" href="../../UserGuide/UserGuide/The_(Plot_Details)_Legends_Titles_Tab.html">作図の詳細<b>凡例/タイトル</b>タブ</a></li>
<li> <a href="../../LabTalk/Script/Creating_and_Accessing_Graphical_Objects.html#Creating_Legends" title="Script:グラフィックオブジェクトの作成とアクセス">グラフィックオブジェクトの作成とアクセス：</a></li>
<li> <a class="external text" href="../../XFunction/X-Function/Legendupdate.html"><b>legendupdate</b>X-Function</a></li></ul>
</td>
<td>
<p><b>\l(1)&nbsp;%(1,@LL)</b>
</p>
</td></tr>
<tr>
<td> <a class="external text" href="../../LabTalk/Script/Creating_and_Accessing_Graphical_Objects.html#Creating_Labels">テキストラベル</a>
</td>
<td>
<ul><li> <a class="external text" href="../../UserGuide/UserGuide/Linking_Text_Labels_to_Data_and_Variables.html#Substituting_Values_for_Data_and_Variables_in_Text_Labels">テキストラベルｊの代わりにデータや変数の値を用いる</a></li>
<li> <a href="../../LabTalk/LabTalk/Text_Label_Options.html" title="LabTalk：テキストラベルオプション">LabTalkリファレンス：テキストラベルの置換</a></li></ul>
</td>
<td>
<p><b>%(1,@LL)</b>
</p>
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Syntax_and_notations_used_in_plot_label.html" title="LabTalk:プロットラベルで使用される構文と表記法">プロットラベル</a>
</td>
<td>
<ul><li> <a class="external text" href="../../UserGuide/UserGuide/The_(Plot_Details)_Label2_Tab.html#Label_Source">作図の詳細 <b>ラベル</b>タブ</a></li>
<li> <a href="../../LabTalk/LabTalk/Options_for_Data_Plot_Labels.html#-qmi" title="LabTalk: データプロットラベルについてのオプション">LabTalkコマンド <b>set -qmi</b></a></li></ul>
</td>
<td>
<p><b>%(wcol(n)[L]$)</b><br />
<b>%(1,@LL)</b> 
</p>
</td></tr>
<tr>
<td> <a class="external text" href="../../UserGuide/UserGuide/Creating_Annotation.html">アノテーション</a>
</td>
<td>
<ul><li> <a class="external text" href="../../UserGuide/UserGuide/Creating_Annotation.html#Custom_annotations">カスタムアノテーション</a></li></ul>
</td>
<td>
<p><b>%(1,@LL) = $(x), $(y,y)</b>
</p>
</td></tr>
<tr>
<td> <a class="external text" href="../../UserGuide/UserGuide/Quick_Start_SetColumnValues.html">列の計算式</a>と<a class="external text" href="../../UserGuide/UserGuide/Using_Formulae_to_Set_Cell_Values.html">セルの計算式</a>
</td>
<td>
<ul><li> <a class="external text" href="../../UserGuide/UserGuide/Using_Formulae_to_Set_Cell_Values.html">数式を利用してセルの値を設定する</a></li>
<li> <a class="external text" href="../../UserGuide/UserGuide/Entering_Expressions_in_the_Set_Column_Dialog.html">「値の設定」ダイアログボックスに数式を入力する</a></li></ul>
</td>
<td>
<p><b>value(A[D2]$)*B</b> (列式)
<b>=value(A[D2]$)*B1</b> (セル式)
</p>
</td></tr>
<tr>
<td> スクリプト
</td>
<td>
<ul><li> 一般的なスクリプトの使用法</li></ul>
</td>
<td>
<p>下の<a href="../../LabTalk/LabTalk/Column_Label_Row_Characters.html#Examples" title="LabTalk:列ラベル行の文字"><b>サンプル</b></a>をご覧ください。
</p>
</td></tr></table>
<p>上記の要素はセルデータやプロジェクト、インポートファイルのメタデータ、プロジェクト変数などを含んだ他のタイプのプロジェクトデータの置換をサポートしています。要素による置換の使い方についての議論は<b>要素</b>列のリンクを参照してください。
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Column_Label_Row_Characters/Tip_icon.png" width="57"  border="0" /></td><td><p>ノートは、<a class="external text" href="../../UserGuide/UserGuide/Displaying_Supporting_Data_in_Worksheet_header_Rows.html#Inserting_Notes_to_Label_Row_Cells">ワークシートの列ラベル行</a>セルに挿入できます。また、<a class="external text" href="../../GettingStarted/OriginLab/Publishing_and_Export.html#Adding_Rich_Text_Content_to_Layout_or_Graph">&quot;<b>@@@Notes<i>N</i></b>&quot; 構文</a>を使用して、グラフページまたはレイアウトページに内容を追加できます。
</p></td></tr></table>
<h2><a name="Column_Label_Row_Properties"></a><span class="mw-headline">列ラベル行のプロパティ</span></h2>
<p>LabTalkスクリプトを記述する場合、 <span class="OIndex" style="display:none">ラベル</span><span class="OIndex" style="display:none">列ラベル行</span><span class="OIndex" style="display:none">ラベル行文字</span><span class="OIndex">ワークシートラベル行</span>は、次の文字を行インデックスとして使用してアクセスされます。 
</p>
<table class="simple">
<tr>
<th> 列のラベル行
</th>
<th> 文字
</th>
<th> アクセス
</th>
<th> 説明
</th></tr>
<tr>
<td> ショートネーム
</td>
<td> <b>G</b>
</td>
<td> 読み取り/書き込み
</td>
<td> <span class="OIndex">ショートネーム</span> <font color="red">(8.6 SR0)</font>.
</td></tr>
<tr>
<td> <b>ロングネーム</b>
</td>
<td> <b>L</b>
</td>
<td> 読み取り/書き込み
</td>
<td> <span class="OIndex"><b>ロングネーム</b></span>
</td></tr>
<tr>
<td> 単位
</td>
<td> <b>U</b>
</td>
<td> 読み取り/書き込み
</td>
<td> <span class="OIndex">単位</span>
</td></tr>
<tr>
<td> コメント
</td>
<td> <b>C</b>
</td>
<td> 読み取り/書き込み
</td>
<td> コメント<span class="OIndex" style="display:none">コメント、列ラベル</span>
</td></tr>
<tr>
<td> サンプリング間隔
</td>
<td> <b>E</b>
</td>
<td> 読み取り専用
</td>
<td> <span class="OIndex">サンプリング間隔</span>（8.0 SR3より前では<i>R</i>で表されます）。<b>wks.labels(E)</b>を使用してこの列ラベル行を表示し、<b>wks.col</b>を使用して間隔を設定します --以下の例を参照してください。
</td></tr>
<tr>
<td> スパークライン
</td>
<td> <b>S</b>
</td>
<td> n/a
</td>
<td> <span class="OIndex">スパークライン</span>。<b>wks.labels(S)</b>を使用してこのラベル行を表示できます。この場合、<b>sparklines</b>Xファンクションを使用してプロットを表示できます。ただし、sparklinesのXファンクションを使用して、スパークラインの列ラベル行とプロットの両方を表示できます。
</td></tr>
<tr>
<td> フィルタ
</td>
<td> <b>F</b>
</td>
<td> 読み取り専用
</td>
<td> <span class="OIndex">フィルタ条件</span> <font color="red">(90 SR0)</font>.
</td></tr>
<tr>
<td> F(x)=
</td>
<td> <b>O</b>
</td>
<td> 読み取り/書き込み
</td>
<td> <b>F(x)=</b>または<b>列値の設定</b>式<span class="OIndex" style="display:none">数式、列ラベル</span><span class="OIndex" style="display:none">列値の設定</span> <font color="red">(91 SR0)</font>.
</td></tr>
<tr>
<td> カテゴリ
</td>
<td> <b>O1</b>
</td>
<td> 読み取り専用
</td>
<td> カテゴリデータ列のカテゴリ <font color="red">(2015 SR2)</font>.
</td></tr>
<tr>
<td> パラメータ
</td>
<td> <b>P</b><i>n</i>
</td>
<td> 読み取り/書き込み
</td>
<td> 組み込みの<span class="OIndex">列パラメータ</span><span class="OIndex HasShownIndex" style="display:none">パラメータ, 列</span>。<i>n</i>はパラメータインデックスです。
</td></tr>
<tr>
<td> ユーザ-定義パラメータ
</td>
<td> <b>D</b><i>n</i> / <b>&lt;実パラメータ名&gt;</b>
</td>
<td> 読み取り/書き込み
</td>
<td> ユーザ定義パラメータ。<i>n</i>はパラメータインデックスです。  例えば、平均として1つ目のユーザパラメータの名前を変更する場合には、col(B)[D1]$ や col(B)[Mean]$　が使用できます。
</td></tr></table>
<h3><a name="Examples"></a><span class="mw-headline">サンプル</span></h3>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//列ラベル行の表示、非表示、または移動</span>
wks.<span style="color: #000080;">labels</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>; <span style="color: #008000;">//すべての列ラベル行を非表示</span>
wks.<span style="color: #000080;">labels</span><span style="color: #000000;">(</span>@<span style="color: #000000;">)</span>; <span style="color: #008000;">// インポートで単位が追加されると、単位はロングネームとコメントの間に移動し、F(x)=は一番下に</span>
wks.<span style="color: #000080;">labels</span><span style="color: #000000;">(</span>LUCO<span style="color: #000000;">)</span>; <span style="color: #008000;">//ロングネーム、単位、コメント、およびF(x)行</span>
wks.<span style="color: #000080;">labels</span><span style="color: #000000;">(</span><span style="color: #000080;">+</span>EF<span style="color: #000000;">)</span>;  <span style="color: #008000;">//サンプリング間隔とフィルタ行を上部に追加</span>
wks.<span style="color: #000080;">labels</span><span style="color: #000000;">(</span><span style="color: #000080;">*</span>P1O1<span style="color: #000000;">)</span>; <span style="color: #008000;">// 列パラメータ1、カテゴリ行を下部に追加</span>
wks.<span style="color: #000080;">labels</span><span style="color: #000000;">(</span><span style="color: #000080;">-</span>F<span style="color: #000000;">)</span>; <span style="color: #008000;">//フィルタ行を非表示に</span>
wks.<span style="color: #000080;">labels</span><span style="color: #000000;">(</span><span style="color: #000080;">&gt;</span>C<span style="color: #000000;">)</span>; <span style="color: #008000;">//コメント行をラベル行の一番下に移動</span>

<span style="color: #008000;">// 列Bのロングネーム、単位、コメント、パラメータ1</span>
col<span style="color: #000000;">(</span>B<span style="color: #000000;">)</span><span style="color: #000000;">[</span>L<span style="color: #000000;">]</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Temperature&quot;</span>; <span style="color: #008000;">// ロングネーム</span>
col<span style="color: #000000;">(</span>B<span style="color: #000000;">)</span><span style="color: #000000;">[</span>U<span style="color: #000000;">]</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> \<span style="color: #000080;">+</span><span style="color: #000000;">(</span>o<span style="color: #000000;">)</span>C; <span style="color: #008000;">// 単位</span>
col<span style="color: #000000;">(</span>B<span style="color: #000000;">)</span><span style="color: #000000;">[</span>C<span style="color: #000000;">]</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Temperature vs Time&quot;</span>; <span style="color: #008000;">// コメント</span>
col<span style="color: #000000;">(</span>B<span style="color: #000000;">)</span><span style="color: #000000;">[</span>P1<span style="color: #000000;">]</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Site 1&quot;</span>; <span style="color: #008000;">// 第一パラメータ行</span>
 
<span style="color: #008000;">// 列Bのサンプリング間隔を設定</span>
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">xinit</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0.1</span>;  <span style="color: #008000;">// 初期値</span>
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">xinc</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0.001</span>;  <span style="color: #008000;">// 間隔</span>
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">xunits</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;s&quot;</span>;  <span style="color: #008000;">// 単位</span>
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">xname</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Time&quot;</span>;  <span style="color: #008000;">// 名前</span>
 
<span style="color: #008000;">// C列のF(x)セルを定義して値を設定</span>
col<span style="color: #000000;">(</span>B<span style="color: #000000;">)</span><span style="color: #000080;">=</span>normal<span style="color: #000000;">(</span><span style="color: #0000dd;">32</span><span style="color: #000000;">)</span>; <span style="color: #008000;">//列に通常のランダムな値を入力</span>
col<span style="color: #000000;">(</span>C<span style="color: #000000;">)</span><span style="color: #000000;">[</span>O<span style="color: #000000;">]</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;col(B)*2&quot;</span>; <span style="color: #008000;">//C 列の値を計算する数式を入力</span>
<span style="color: #008000;">//wks.col3.formula$=&quot;col(B)*2&quot;; // formula$も使用可</span>

<span style="color: #008000;">//スパークライン表示</span>
wks.<span style="color: #000080;">labels</span><span style="color: #000000;">(</span><span style="color: #000080;">*</span>S<span style="color: #000000;">)</span>; <span style="color: #008000;">//スパークライン行を一番下に追加</span>
sparklines sel<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> c1<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> c2<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span>; <span style="color: #008000;">//スパークラインをプロットするにはsparklines Xファンクションを使用</span>

<span style="color: #008000;">//列Aをカテゴリとして設定し、カテゴリセルの文字列を読み取り</span>
patternT irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span> mode<span style="color: #000000;">:</span><span style="color: #000080;">=</span>random text<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;NY LA GZ HK&quot;</span> onerepeat<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span> seqrepeat<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span>; <span style="color: #008000;">//列Aにランダムなテキストを入力</span>
set col<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span> <span style="color: #000080;">-</span>dc <span style="color: #0000dd;">1</span>; <span style="color: #008000;">//列 A をカテゴリとして設定</span>
col<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span><span style="color: #000000;">[</span>O1<span style="color: #000000;">]</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>; <span style="color: #008000;">//カテゴリセルの文字列を読み取る</span>
string str1<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> col<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span><span style="color: #000000;">[</span>O1<span style="color: #000000;">]</span><span style="color: #000080;">$</span>; <span style="color: #008000;">//カテゴリセルの文字列を文字列変数に読み取り;</span>
str1<span style="color: #000080;">$</span><span style="color: #000080;">=</span>; 
 
<span style="color: #008000;">// ユーザ定義パラメータ 1 を追加し、D1文字を使用してアクセス</span>
wks.<span style="color: #000080;">labels</span><span style="color: #000000;">(</span><span style="color: #000080;">*</span>D1<span style="color: #000000;">)</span>; <span style="color: #008000;">//最初のユーザ定義パラメータを表示</span>
wks.<span style="color: #000080;">UserParam1</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Mean&quot;</span>; <span style="color: #008000;">//最初のユーザ定義パラメータの名前をMeanに変更</span>
col<span style="color: #000000;">(</span>B<span style="color: #000000;">)</span><span style="color: #000000;">[</span>D1<span style="color: #000000;">]</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">$</span><span style="color: #000000;">(</span>mean<span style="color: #000000;">(</span>Col<span style="color: #000000;">(</span>B<span style="color: #000000;">)</span><span style="color: #000000;">)</span>,<span style="color: #000080;">*</span><span style="color: #0000dd;">3</span><span style="color: #000000;">)</span>; <span style="color: #008000;">//列Bの平均をMeanラベル行に入力し、有効数字3桁にします</span>

<span style="color: #008000;">//ユーザ定義パラメータ2を追加し、実際のユーザパラメータ名を使用してアクセス</span>
wks.<span style="color: #000080;">userparam2</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; <span style="color: #008000;">//Size列ラベル行を表示します。wks.labels(*D2)と同じです。</span>
wks.<span style="color: #000080;">userparam2</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Size; <span style="color: #008000;">//2 番目のユーザー定義パラメータのSizeを定義</span>
col<span style="color: #000000;">(</span>B<span style="color: #000000;">)</span><span style="color: #000000;">[</span>Size<span style="color: #000000;">]</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">$</span><span style="color: #000000;">(</span>count<span style="color: #000000;">(</span>Col<span style="color: #000000;">(</span>B<span style="color: #000000;">)</span>,<span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>,.0<span style="color: #000000;">)</span>; <span style="color: #008000;">//Size行に列Bのサイズを小数点以下0桁で入力</span></pre>
<p>列ラベル行は<span class="OIndex">メタデータ</span>または列に含まれるデータについての情報を含みます。  メタデータの使用方法の詳細については、<a href="../../LabTalk/Script/Accessing_Metadata.html" title="スクリプト: メタデータにアクセスする">メタデータへのアクセス</a>セクションを参照してください。
</p>


    