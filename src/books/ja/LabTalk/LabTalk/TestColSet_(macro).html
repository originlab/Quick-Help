<h1 class="firstheading">TestColSet</h1>

  <p class='urlname' style='display: none'>TestColSet-macro</p>

  <p>Checks to see if a single (or part of a single) dataset is selected. If so, nothing is done. If not, the currently executing script is terminated.</p>

  <p>&#160;</p>

  <h2><a name="Definition:"></a><span class="mw-headline"><font color="chocolate">Definition:</font></span></h2>
  <pre class="lt" style="font-family:monospace;">
Def TestColSel <span style="color: #000000;">{</span>
      if <span style="color: #000000;">(</span>exist<span style="color: #000000;">(</span><span style="color: #000080;">%</span>C<span style="color: #000000;">)</span><span style="color: #000080;">!</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> <span style="color: #000080;">||</span> SelC2 <span style="color: #000080;">&gt;</span> SelC1<span style="color: #000000;">)</span> <span style="color: #000000;">{</span>

           type <span style="color: #000080;">-</span>b <span style="color: #ff00ff;">"$general.Only1YColumn"</span>;
            break <span style="color: #0000dd;">1</span>;
      <span style="color: #000000;">}</span>;
<span style="color: #000000;">}</span>;
</pre>

  <h2><a name="Example:"></a><span class="mw-headline"><font color="chocolate">Example:</font></span></h2>

  <p>The following script checks to see if a single dataset is selected. If so, it integrates the selected dataset and prints the results in the Script window. If not, an error message is printed out and the script is terminated.</p>
  <pre class="lt" style="font-family:monospace;">
TestColSel;
integ <span style="color: #000080;">%</span>C;
if <span style="color: #000000;">(</span>MkS1<span style="color: #000080;">&gt;=</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span> <span style="color: #000000;">{</span>
      i1<span style="color: #000080;">=</span>MkS1;
      i2<span style="color: #000080;">=</span>MkS2;
<span style="color: #000000;">}</span>
else 
<span style="color: #000000;">{</span>
      get <span style="color: #000080;">%</span>C <span style="color: #000080;">-</span>b i1;
      get <span style="color: #000080;">%</span>C <span style="color: #000080;">-</span>e i2;
<span style="color: #000000;">}</span>;
ty <span style="color: #000080;">-</span>a Integ of <span style="color: #000080;">%</span>C from zero;
ty <span style="color: #ff00ff;">"i = $(i1) --&gt; $(i2)"</span>;
ty <span style="color: #ff00ff;">"x = $(integ.x1) --&gt; $(integ.x2)"</span>;
ty <span style="color: #ff00ff;">"Area    Peak at    Width    Height"</span>;
ty <span style="color: #ff00ff;">"$(integ.area)    $(integ.x0)    $(integ.dx)    $(integ.y0)"</span>;
</pre>
