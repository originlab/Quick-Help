<h1 class="firstheading">プロットデータのラベル付けに使用される表記法と構文</h1>
<p class="urlname" style="display: none;">PlotLabel-LTNotation</p>
<p>最も単純な形式では、プロットデータのラベルとして、ソースワークシートセルから直接取得した座標値が表示されます。ただし、プロットラベルをカスタマイズして、たとえば、座標値を別の数値形式で表示したり、データプロットに関連付けられたメタデータを表示したりすることができます。</p>
<p>カスタムプロットラベルは、固定文字列をフォーマット構文および表記法と組み合わせて、<a class="external text" href="../../UserGuide/UserGuide/The_(Plot_Details)_Label2_Tab.html#Label_Source">作図の詳細ダイアログの<b>ラベル</b>タブの<b>フォーマット指定</b>編集ボックス</a>に入力することで作成されます。これらのカスタムラベルを付ける操作は、指定したポイントのみ、またはプロット内のすべてのポイントに適用できます。</p>
<div id="toc" class="toc">
<div id="toctitle">
<h2>目次</h2>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Predefined_characters"><span class="tocnumber">1</span> <span class="toctext">事前定義された文字</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Syntax_for_formatting_of_Numeric_and_Date-Time_data"><span class="tocnumber">2</span> <span class="toctext">数値および日時にフォーマットするシンタックス</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Formatting_Numeric_data"><span class="tocnumber">2.1</span> <span class="toctext">数値データにフォーマットする</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Formatting_Date-Time_data"><span class="tocnumber">2.2</span> <span class="toctext">日時データをフォーマットする</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="#Characters_for_Column_Label_Rows"><span class="tocnumber">3</span> <span class="toctext">列ラベル行の文字</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Examples"><span class="tocnumber">4</span> <span class="toctext">サンプル</span></a></li>
</ul>
</div>
<h2><a name="Predefined_characters" id="Predefined_characters"></a><span class="mw-headline">事前定義された文字</span></h2>
<p>これらの文字は、現在選択されているポイントを表すために使用されます。これらは単独で使用することも（例：<a class="external text" href="../../UserGuide/UserGuide/The_(Plot_Details)_Label2_Tab.html#Label_Source"><b>ラベル形式</b></a>=<i>(X,Y)</i>）、より複雑な式の要素にすることもできます（例：<b>ラベル形式</b>=<i>カスタム</i> および<b>フォーマット文字列</b>= <i>$(wcol(n)[i],.4))</i>）。</p>
<table class="simple">
<tr>
<th>文字</th>
<th>説明</th>
</tr>
<tr>
<td><i>n</i>, <i>i</i></td>
<td>ソースワークシートの列および行番号</td>
</tr>
<tr>
<td><i>x</i>, <i>y</i>, <i>z</i></td>
<td>データポイントのX、Y、Z座標</td>
</tr>
<tr>
<td><i>ix</i>, <i>iy</i></td>
<td>プロットが行列から作成されるときのデータポイントの列と行番号</td>
</tr>
<tr>
<td><i>zh</i></td>
<td>3D三点グラフのデータポイントのZh座標</td>
</tr>
</table>
<table class="noborder">
<tr>
<td style="vertical-align: top;" width="60"><img src="../images/Syntax_and_notations_used_in_plot_label/Tip_icon.png" alt="" width="57" border="0" /></td>
<td>
<p><i>wcol</i> と <i>col</i> 列の参照に使用されます。<i>wcol(n)</i> は数値式を引数として取り、<i>n</i>は現在の列番号を表す動的変数です。</p>
</td>
</tr>
</table>
<h2><a name="Syntax_for_formatting_of_Numeric_and_Date-Time_data" id="Syntax_for_formatting_of_Numeric_and_Date-Time_data"></a><span class="mw-headline">数値および日時にフォーマットするシンタックス</span></h2>
<p>デフォルトでは、数字と日時データのデータラベルは、ソースブックに表示されている内容を反映します。ただし、内部に保存されている数値は、<a href="../../LabTalk/LabTalk/Origin_Formats.html" title="LabTalk:Originの形式">Originフォーマット</a>を使用してさまざまな方法で表示を変更できます。次の画像は、ソースブックで使用されているものと異なる日時フォーマットを適用するカスタム<b>フォーマット文字列</b>（<a class="external text" href="../../UserGuide/UserGuide/The_(Plot_Details)_Label2_Tab.html#Label_Source">作図の詳細の<b>ラベル</b>タブ</a>）の使用を示しています。</p>
<dl>
<dd><a class="image"><img alt="LT custom label plot data.png" src="../images/Syntax_and_notations_used_in_plot_label/LT_custom_label_plot_data.png" width="724" height="332" border="0" /></a></dd>
</dl>
<h3><a name="Formatting_Numeric_data" id="Formatting_Numeric_data"></a><span class="mw-headline">数値データにフォーマットする</span></h3>
<p>数値データに適用できる<b>カスタム</b>フォーマットは以下のリンクを参照してください。</p>
<ul>
<li><a href="../../LabTalk/LabTalk/Origin_Formats.html#Significant_Digits.2C_Decimal_Places.2C_Scientific_and_Engineering_Formats" title="LabTalk:Originの形式">有効桁数、小数点桁数、科学および工業のフォーマット</a></li>
<li><a href="../../LabTalk/LabTalk/Origin_Formats.html#Fractions" title="LabTalk:Originの形式">分数</a></li>
<li><a href="../../LabTalk/LabTalk/Origin_Formats.html#Percentages" title="LabTalk:Originの形式">パーセンテージ</a></li>
<li><a href="../../LabTalk/LabTalk/Origin_Formats.html#pi" title="LabTalk:Originの形式">pi</a></li>
<li><a href="../../LabTalk/LabTalk/Origin_Formats.html#Degrees.2C_Minutes.2C_Seconds" title="LabTalk:Originの形式">度、分、秒</a></li>
<li><a href="../../LabTalk/LabTalk/Origin_Formats.html#Hexadecimal" title="LabTalk:Originの形式">16進数</a></li>
<li><a href="../../LabTalk/LabTalk/Origin_Formats.html#Other_Prefix_and_Suffix_Units" title="LabTalk:Originの形式">その他の接頭辞と接尾辞の単位</a></li>
</ul>
<h3><a name="Formatting_Date-Time_data" id="Formatting_Date-Time_data"></a><span class="mw-headline">日時データをフォーマットする</span></h3>
<p>日時データに適用できる<b>カスタム</b>フォーマットは以下のリンクを参照してください。</p>
<ul>
<li><a href="../../LabTalk/LabTalk/Origin_Formats.html#Date_and_Time" title="LabTalk:Originの形式">日付と時間</a></li>
</ul>
<h2><a name="Characters_for_Column_Label_Rows" id="Characters_for_Column_Label_Rows"></a><span class="mw-headline">列ラベル行の文字</span></h2>
<p>いくつかのインスタンスでは、複数曲線について最後のデータポイントでのみプロットの情報のラベルを表示したい場合があります。これは、デフォルトのグラフ凡例の代替です（<a class="external text" href="../../UserGuide/UserGuide/Linking_Text_Labels_to_Data_and_Variables.html#Example_2:_Plot_Details_Label_tab_Format_String"><b>例2：作図の詳細のラベルタブのフォーマット文字列</b></a>を参照）。</p>
<p><a class="external text" href="../../UserGuide/UserGuide/The_(Plot_Details)_Label2_Tab.html#Label_Source"><b>ラベル</b>タブ</a>の曲線のラベル付けをするとき、<b>wcol(n)</b>を使って<a href="../../LabTalk/LabTalk/Column_Label_Row_Characters.html" title="LabTalk:列ラベル行の文字">列ラベル行の文字</a>でプロットにラベル付けできます。例として、次のワークシートを使用します。</p>
<p><a class="image"><img alt="LTnotations in label 01.png" src="../images/Syntax_and_notations_used_in_plot_label/LTnotations_in_label_01.png" width="268" border="0" /></a></p>
<table class="simple">
<tr>
<th>列のラベル行</th>
<th>文字</th>
<th>ラベル形式</th>
</tr>
<tr>
<td>ショートネーム</td>
<td>
<p><b>G</b></p>
</td>
<td>&#160;%(wcol(n)[G]$) --&gt; B</td>
</tr>
<tr>
<td>ロングネーム</td>
<td>
<p><b>L</b></p>
</td>
<td>
<p>%(wcol(n)[L]$) --&gt; Delta Temperature</p>
<dl>
<dd>=&#160;%(?,@LL)</dd>
</dl>
</td>
</tr>
<tr>
<td>単位</td>
<td>
<p><b>U</b></p>
</td>
<td>&#160;%(wcol(n)[U]$) --&gt; K</td>
</tr>
<tr>
<td>コメント</td>
<td>
<p><b>C</b></p>
</td>
<td>&#160;%(wcol(n)[C]$) --&gt; YBCO milled</td>
</tr>
<tr>
<td>パラメータ</td>
<td>
<p><b>P</b><i>n</i>、ここで<i>n</i> はパラメータインデックス</p>
</td>
<td>
<p>%(wcol(n)[P1]$) --&gt; Version 2.1<br />
%(wcol(n)[P2]$) --&gt; 12/15/2004</p>
</td>
</tr>
<tr>
<td>ユーザ定義パラメータ</td>
<td>
<p><b>D</b><i>n</i>、ここで<i>n</i> はパラメータインデックス</p>
<p><i>または</i></p>
<p><b>&lt;Real Parameter Name&gt;</b></p>
</td>
<td>
<p>%(wcol(n)[D1]$) --&gt; 03:00:39 PM<br />
%(wcol(n)[Time]$) --&gt; 03:00:39 PM<br />
%(wcol(n)[D2]$) --&gt; S21<br />
%(wcol(n)[D3]$) --&gt; 235<br />
%(wcol(n)[RunNo]$)/%(wcol(n)[D4]$) --&gt; 07</p>
</td>
</tr>
</table>
<p><a href="../../LabTalk/LabTalk/Column_Label_Row_Characters.html" title="LabTalk:列ラベル行の文字">このページ</a>を参照すると、より多くの列ラベル行にアクセスできます。</p>
<h2><a name="Examples" id="Examples"></a><span class="mw-headline">サンプル</span></h2>
<p>プロットの<a class="external text" href="../../UserGuide/UserGuide/The_(Plot_Details)_Label2_Tab.html#Label_Source">作図の詳細の<b>ラベル</b>タブ</a>の設定使う場合、<b>ラベル形式</b>を<i>カスタム</i>にして<b>フォーマット文字列</b>を選択または入力します。</p>
<dl>
<dd><a class="image"><img alt="LT custom label plot data examples.png" src="../images/Syntax_and_notations_used_in_plot_label/LT_custom_label_plot_data_examples.png" width="350" border="0" /></a></dd>
</dl>
<p><br />
数値および日時フォーマットのヘルプは、<a href="../../LabTalk/LabTalk/Origin_Formats.html" title="LabTalk:Originの形式">Originフォーマット</a>を参照してください。</p>
<p><br />
<i><b>フォーマット文字列およびそれらのアプリケーションの例:</b></i></p>
<table class="simple" width="80%">
<tr>
<th style="width: 25%;">フォーマット文字列</th>
<th style="width: 55%;">アプリケーション</th>
</tr>
<tr>
<td>$(wcol(n)[i],*4)</td>
<td>現在のY列の<i>i</i> 番目の行にある数値をラベルとして使用します。値は、有効桁数4桁で表示されます。</td>
</tr>
<tr>
<td>My Label: $(col(Pressure)[i],.3)</td>
<td><i>Pressure</i>の<i>i</i>番目の行の値に接頭辞"My Label:"をつけ、ラベルとして使用します。値は小数点桁数3で表示されます。</td>
</tr>
<tr>
<td>$(col(1)[i],D2)</td>
<td>現在の列の<i>i</i> 番目の行の日付をラベルとして使用します。<b>セルのフォーマット</b>ダイアログボックスの<b>フォーマット</b>を日付にしたときに<b>表示</b>ドロップダウンリストの3番目の形式で日付を表示します。</td>
</tr>
<tr>
<td>$(col(2)[i], T15)</td>
<td>2番目の列の<i>i</i>番目の行の時間の値をラベルとして使用します。<b>セルのフォーマット</b>ダイアログボックスの<b>フォーマット</b>を時間にしたときに<b>表示</b>ドロップダウンリストの16番目の形式で時間を表示します。</td>
</tr>
<tr>
<td>&#160;%(wcol(n+1)[i]$)&#160;%(x$)</td>
<td><i>n+1</i>番目の列のi番目の行にあるテキストとX値のテキストを組み合わせてラベルとして使用します。<i>n</i>は現在のY列のインデックスです。</td>
</tr>
<tr>
<td>&#160;%(book2,iy,ix)</td>
<td>行列ブックからグラフを作成したときに、<i>ix</i> と <i>iy</i>は現在のデータポイントの元の行列ブックでのX、Yインデックスを参照します。このサンプルではワークブック、<i>book2</i>にラベルを配置できます。<i>%(book2,iy,ix)</i>は、Book2Sheet1の<i>iy</i>列<i>ix</i>行の値をデータポイントのラベルとして使用します。</td>
</tr>
<tr>
<td>&#160;%([book1]sheet2,iy,ix)</td>
<td>上述の<i>%(book2,iy,ix)</i> と同様ですこのサンプルではワークシートを指定する必要があります。</td>
</tr>
<tr>
<td>&#160;%(MBook2,ix,iy)</td>
<td>行列ブック<i>MBook2</i>（第一シート、第一オブジェクト）のセル(ix, iy)の値をラベルとして使用します。<i>ix</i>と<i>iy</i>は、元の行列のデータポイントのXとYインデックスです。</td>
</tr>
<tr>
<td>$(Y)%(CRLF)$(p,0)%</td>
<td>積み上げグラフを作成するときは、この文字列を使用してY値と対応するパーセンタイルをラベルとして表示できます。"%(CRLF)"はラベルを2つの行に分けるために使用されます。パーセンタイルは整数で表示されます。</td>
</tr>
<tr>
<td>&#160;%(?,@LL)</td>
<td>現在のY列のロングネームをラベルとして使用します。</td>
</tr>
<tr>
<td>$(Y*100, .1)%</td>
<td>小数点以下1桁までの10進数のY値をパーセンテージで表示します。</td>
</tr>
</table>
