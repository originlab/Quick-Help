<h1 class="firstheading">Xファンクションの実行オプション</h1><p class='urlname' style='display: none'>XF-Execution-Options</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#X-Function_Option_SwitchesX-Function.2C_option_switch"><span class="tocnumber">1</span> <span class="toctext">Xファンクションのオプションスイッチ<span class="OIndex" style="display:none">X-Function, option switch</span></span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Examples"><span class="tocnumber">2</span> <span class="toctext">サンプル</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Open_X-Function_DialogOpen_X-Function_DialogX-Function.2C_open_dialog"><span class="tocnumber">2.1</span> <span class="toctext">Xファンクションダイアログを開く<span class="OIndex" style="display:none">Open X-Function Dialog</span><span class="OIndex" style="display:none">X-Function, open dialog</span></span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Using_a_Theme"><span class="tocnumber">2.2</span> <span class="toctext">テーマを使う</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Setting_Recalculate_Mode"><span class="tocnumber">2.3</span> <span class="toctext">再計算モードをセット</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Open_X-Function_Builder"><span class="tocnumber">2.4</span> <span class="toctext">Xファンクションビルダを開く</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Copy_Format_from_Input_to_Output"><span class="tocnumber">2.5</span> <span class="toctext">入力から出力にフォーマットをコピー</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Undo_the_Operation"><span class="tocnumber">2.6</span> <span class="toctext">操作を元に戻す</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="X-Function_Option_SwitchesX-Function.2C_option_switch"></a><span class="mw-headline">Xファンクションのオプションスイッチ<span class="OIndex" style="display:none">X-Function, option switch</span></span></h2>
<p>次のオプションスイッチは、スクリプトからXファンクションにアクセスするときに利用できます。
</p>
<table class="simple">
<tr>
<th width="140"> スイッチ
</th>
<th width="90"> 完全な名前
</th>
<th> 関数
</th></tr>
<tr>
<td> -cf
</td>
<td> --
</td>
<td> 入力範囲の列フォーマットをコピーし、それを出力範囲に適用
</td></tr>
<tr>
<td> -d
</td>
<td> -dialog
</td>
<td> Xファンクションパラメータを設定およびスクリプトを生成するためにダイアログを開く
</td></tr>
<tr>
<td> -db
</td>
<td> --
</td>
<td> ダイアログの種類; 現在のワークブック内でパネルとしてXファンクションダイアログを開く
</td></tr>
<tr>
<td> -dc <i>IsCancel</i>
</td>
<td> --
</td>
<td> ダイアログの種類；Xファンクションパラメータを選択するダイアログを開く。<b>OK</b>ボタンをクリックする場合、<i>IsCancel</i> を0にセットし、<b>キャンセル</b>ボタンをクリックする場合1にセット<b>キャンセル</b>ボタンをクリックした場合、<b>#User Abort!</b>のようなエラーメッセージやXファンクション実行後のスクリプトはスクリプトウィンドウに表示されません。
</td></tr>
<tr>
<td> -e
</td>
<td> --
</td>
<td> XファンクションビルダーにXファンクションを開く。<a href="../../LabTalk/LabTalk/Edit_(command).html#-x.3B_Open_an_X-Function_in_X-Function_Builder" title="LabTalk:Edit (コマンド)">edit -x</a> コマンドと同じように動作します。
</td></tr>
<tr>
<td> -h
</td>
<td> -help
</td>
<td> スクリプトウィンドウにヘルプファイルの内容を出力
</td></tr>
<tr>
<td> -he
</td>
<td> --
</td>
<td> スクリプトウィンドウにスクリプトサンプルの内容を出力
</td></tr>
<tr>
<td> -hn
</td>
<td> --
</td>
<td> Xファンクションをロードしコンパイルだけする。すでにロードとコンパイル済みの場合、何もしない。
</td></tr>
<tr>
<td> -hs
</td>
<td> --
</td>
<td> -hの変形; スクリプト使用例のみを出力
</td></tr>
<tr>
<td> -ht
</td>
<td> --
</td>
<td> Hの変形; ツリーノードの情報があればそれのみ出力
</td></tr>
<tr>
<td> -hv
</td>
<td> --
</td>
<td> -hの変形; 変数リストのみを出力
</td></tr>
<tr>
<td> -hx
</td>
<td> --
</td>
<td> -hの変形; 関連するXファンクション情報のみ出力
</td></tr>
<tr>
<td> -r &lt;option&gt;
</td>
<td> -recalculate
</td>
<td> 再計算モードを指定: 0 = なし; 1 = 自動; 2 = 手動:<a href="#Setting_Recalculate_Mode">サンプル</a>.出力が&lt;入力&gt;と同じ場合、再計算はサポートされません。
</td></tr>
<tr>
<td> -s
</td>
<td> -silent
</td>
<td> サイレントモードで実行。結果は結果ログに送られない
</td></tr>
<tr>
<td> -sb
</td>
<td> --
</td>
<td> -sの変形; エラーメッセージと結果ログの出力をしない。
</td></tr>
<tr>
<td> -se
</td>
<td> --
</td>
<td> -sの変形; エラーメッセージを出さない。結果ログの出力は行う。
</td></tr>
<tr>
<td> -sl
</td>
<td> -silent
</td>
<td> -sと同じ
</td></tr>
<tr>
<td> -sr
<p><font color="red">(Origin 2016 SR1)</font>
</p>
</td>
<td> --
</td>
<td> -sの変形; スクリプトウィンドウに結果メッセージを出さない。
</td></tr>
<tr>
<td> -ss
</td>
<td> --
</td>
<td> -sの変形; スクリプトウィンドウに情報メッセージを出さない。
</td></tr>
<tr>
<td> -sw
<p><font color="red">(Origin 2016 SR1)</font>
</p>
</td>
<td> --
</td>
<td> -sの変形; スクリプトウィンドウに注意メッセージを出さない。
</td></tr>
<tr>
<td> -t &lt;<i>Name</i>&gt;
</td>
<td> -theme
</td>
<td> 事前に設定されたテーマを使用する。
</td></tr>
<tr>
<td> -u
<p><font color="red">(Origin 2024b)</font>
</p>
</td>
<td> -undo
</td>
<td> スクリプトから実行するときに、操作を元に戻すことができるかどうかを指定します。
</td></tr></table>
<p><br />
既存の<b>完全な名前</b>を持つオプションでは、省略形または完全な名前のスイッチのどちらかをスクリプトで使います。  例えば、Xファンクション <b>smooth</b>では
</p>
<pre class="lt" style="font-family:monospace;">smooth <span style="color: #000080;">-</span>h</pre>
<p>は以下と同じです。 
</p>
<pre class="lt" style="font-family:monospace;">smooth <span style="color: #000080;">-</span>help</pre>
<h2><a name="Examples"></a><span class="mw-headline">サンプル</span></h2>
<h3><a name="Open_X-Function_DialogOpen_X-Function_DialogX-Function.2C_open_dialog"></a><span class="mw-headline">Xファンクションダイアログを開く<span class="OIndex" style="display:none">Open X-Function Dialog</span><span class="OIndex" style="display:none">X-Function, open dialog</span></span></h3>
<p><b>-d</b> スイッチを使用してXファンクションダイアログを開き、ユーザが対話的に入力とパラメータ設定が可能なようにします。
</p><p>次のスクリプトは、列1と列2にデータを入力します。-dスイッチを使用して <a class="external text" href="../../XFunction/X-Function/Smooth.html">smooth</a>Xファンクションダイアログを開き、ユーザが結果をプレビューしたり、設定を調整したりできます。OKをクリックすると、スクリプトが続き、列2と列3を折れ線グラフとしてプロットします。 
</p>
<pre class="lt" style="font-family:monospace;">col<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span><span style="color: #000080;">=</span>data<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">100</span><span style="color: #000000;">)</span>; <span style="color: #008000;">//列1に行番号を入力</span>
col<span style="color: #000000;">(</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span><span style="color: #000080;">=</span>normal<span style="color: #000000;">(</span><span style="color: #0000dd;">100</span><span style="color: #000000;">)</span>; <span style="color: #008000;">//列2に正規化データを入力</span>
<span style="color: #008000;">//入力、メソッド、ロードされたポイント数を含むダイアログを開く</span>
<span style="color: #008000;">//ダイアログの設定をしてOKをクリック</span>
smooth <span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">)</span> method<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span> npts<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">25</span> <span style="color: #000080;">-</span>d; 
<span style="color: #008000;">//シートのX列 (列1) に対してY列 (列2および3)を折れ線グラフとしてプロット</span>
plotxy <span style="color: #000000;">(</span>?,<span style="color: #0000dd;">2</span><span style="color: #000000;">:</span><span style="color: #0000dd;">3</span><span style="color: #000000;">)</span> p<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">200</span>;</pre>
<h3><a name="Using_a_Theme"></a><span class="mw-headline">テーマを使う</span></h3>
<p><b>-t</b>スイッチを使って保存されているダイアログテーマでXファンクションを実行します。ダイアログテーマは基本的に、Xファンクションダイアログのパラメータ、出力の設定です。通常、テーマファイルでは入力は除外されます。
</p><p>次の手順では、ダイアログテーマファイルを保存し、-tスイッチを使用して保存したテーマを使用する方法を示します。
</p>
<ol>
<li> 上記のスクリプトの後に作成された列2を選択します。以下のスクリプトを実行してスムージングダイアログを開きます。または、<b>解析：信号処理：スムージング：ダイアログを開く</b>メニューを選択して開きます。
<pre class="lt" style="font-family:monospace;">smooth <span style="color: #000080;">-</span>d;</pre>
<li><b>方式</b>を<b>隣接平均法</b>にし、<b>ウィンドウのポイント数</b>を<b>5</b>にします。 
<li>ダイアログ上部の<b>ダイアログテーマ</b>の右側にある<b>&gt;</b> ボタンをクリックし<b>名前を付けて保存...</b>を選択します。ダイアログの設定を<b>FivePtAdjAve</b>という名前で保存します。
<li>ダイアログをキャンセルします。
<li> 前のスクリプトで使ったデータがあるワークブックをアクティブにします。
<li> -tスイッチを指定してXファンクションを実行し、<b>FivePtAdjAve</b> という名前の<span class="OIndex">テーマ</span>を使用して列1と2のXYデータでスムージングを実行します。これは、<b>方式</b>を<b>隣接平均法</b>、<b>ウィンドウのポイント数</b>を<b>5</b>として意味します。

<pre class="lt" style="font-family:monospace;">smooth <span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">)</span> <span style="color: #000080;">-</span>t FivePtAdjAve;</pre>
</ol>
<p><b>Note</b>: Originが自動的にテーマを<i>User Files\Themes\AnalysisAndReportTable\</i>に保存するため、テーマファイルのパスを指定する必要はありません。テーマファイルは他の人と共有できます。Originのワークスペースにテーマファイルをドラッグアンドドロップするだけでインストールして使用できます。1つのプロジェクト (*.OPJ) に保存されたテーマは、他のプロジェクトでも使用できます。<b>Origin 2024から、Originはまず現在のプロジェクトフォルダからテーマを探します。見つからない場合は、ユーザーファイルフォルダから。 </b>
</p>
<h3><a name="Setting_Recalculate_Mode"></a><span class="mw-headline">再計算モードをセット</span></h3>
<p><b>-r</b>スイッチを使って出力の再計算モードを設定できます。 
</p><p>複数のスイッチを一緒に使用できます。下記の2つのスイッチのうち <b>-t FivePtAdjAve</b> は、FivePtAdjAveテーマでスムージングを実行し、<b>-r 1</b> は再計算モードを自動に設定します。
</p>
<pre class="lt" style="font-family:monospace;">smooth <span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">)</span> <span style="color: #000080;">-</span>t FivePtAdjAve <span style="color: #000080;">-</span>r <span style="color: #0000dd;">1</span>;</pre>
<p>以下のスクリプトは、Xファンクション<b><a class="external text" href="../../XFunction/X-Function/Freqcounts.html">freqcounts</a></b> を<b>-r 1</b>とともに実行し、入力列が変更された時に自動で<span class="OIndex">再計算</span>します。
</p>
<pre class="lt" style="font-family:monospace;">newbook;
col<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span><span style="color: #000080;">=</span>uniform<span style="color: #000000;">(</span><span style="color: #0000dd;">100</span><span style="color: #000000;">)</span><span style="color: #000080;">*</span><span style="color: #0000dd;">50</span>; <span style="color: #008000;">//0 から 50 までの一様に分散されたランダム データを生成</span>
<span style="color: #008000;">//増分5で周波数カウントを実行し、再計算モードを自動に設定</span>
freqcounts irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span> min<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> max<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">50</span> stepby<span style="color: #000000;">:</span><span style="color: #000080;">=</span>increment inc<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">5</span>
   end<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> count<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> center<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> cumulcount<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> rd<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">(</span><span style="color: #0000dd;">4</span><span style="color: #000000;">)</span> <span style="color: #000080;">-</span>r <span style="color: #0000dd;">1</span>;</pre>
<h3><a name="Open_X-Function_Builder"></a><span class="mw-headline">Xファンクションビルダを開く</span></h3>
<p>-hスイッチによって表示されるヘルプファイルは膨大で読みにくい場合がありますが、他の-he、-hvでは内容が少なすぎる場合もあります。
</p><p>代わりに、-eスイッチを使用して Xファンクションビルダで Xファンクションを開くことで、テーブルビューですべてのパラメータについて完全な情報 (入力/出力、データ型、デフォルト値など) とともに確認できるようになります。
これは、上級ユーザが組み込みXファンクションのコードを学習するためのダイアログでもあります。ダイアログの<b>Xファンクションをコードビルダで編集</b>ボタンをクリックするとXファンクションコードがコード ビルダーに表示されます。 
</p>
<pre class="lt" style="font-family:monospace;">smooth <span style="color: #000080;">-</span>e;</pre>
<h3><a name="Copy_Format_from_Input_to_Output"></a><span class="mw-headline">入力から出力にフォーマットをコピー</span></h3>
<p><b>-cf</b>スイッチを使って入力データと一致するように出力データをフォーマットします。
</p><p>デフォルトでは、すべての分析結果はデー​​タ型doubleとして出力されます。次のスクリプトでは、出力データ形式を入力データ形式である short(2) にします。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// *.wavファイルをインポート; インポートされた *.wavファイルのデータ形式はshort(2)</span>
fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Signal Processing\sample.wav&quot;</span>;
newbook s<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>; 
newsheet col<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>; 
impWav options.<span style="color: #000080;">SparkLines</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;

<span style="color: #008000;">//現在のブックの最初のシートの列1に対してカットオフ周波数 = 2000 でローパスfft_filterを実行</span>
fft_filters <span style="color: #000080;">-</span>cf <span style="color: #000000;">[</span><span style="color: #000080;">%</span>H<span style="color: #000000;">]</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span>col<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span> cutoff<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2000</span>  
oy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">(</span><span style="color: #000080;">&lt;</span>input<span style="color: #000080;">&gt;</span>,<span style="color: #000080;">&lt;</span>new name<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Lowpass Sound Frequency&quot;</span><span style="color: #000080;">&gt;</span><span style="color: #000000;">)</span>;</pre>
<h3><a name="Undo_the_Operation"></a><span class="mw-headline">操作を元に戻す</span></h3>
<p><b>-u</b>スイッチを使用すると、スクリプトから実行するときにXファンクション操作を元に戻すことができます。
</p><p>ダイアログからXファンクションを実行した場合、デフォルトで操作を元に戻すことができます。しかし、スクリプトから実行する場合は、<b>-u</b>スイッチを使用してundoをサポートする必要があります。次のスクリプトは、アクティブなワークシートを入れ替えて結果を新しいブックに出力し、操作を元に戻します。
</p>
<pre class="lt" style="font-family:monospace;">wtranspose <span style="color: #000080;">-</span>u ow<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>new<span style="color: #000080;">&gt;</span>;
undo;</pre>







    