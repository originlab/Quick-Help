<h1 class="firstheading">LabTalkオブジェクト</h1><p class='urlname' style='display: none'>LT-objs</p>
<p>LabTalkスクリプトプログラミングでは、さまざまなオブジェクトおよびそのプロパティにアクセスできます。  これらのオブジェクトは、ワークシート列やグラフのデータプロットなどGUIに表示されているOriginプロジェクトのコンポーネントを含みます。このようなオブジェクトは、<b>Originオブジェクト</b>として参照され、次のセクション、<a href="../../LabTalk/Category/Origin_Objects.html" title="カテゴリー:Originオブジェクト">Origin オブジェクト</a>のサブジェクトとなっています。 
</p><p>オブジェクトのコレクションには、INIオブジェクトまたはシステムオブジェクトのようなインターフェースに表示されない別のオブジェクトも含みます。  LabTalkスクリプトからアクセス可能なオブジェクトのすべては<a href="../../LabTalk/Category/Alphabetical_Listing_of_Objects_(Labtalk).html" title="Category:Alphabetical Listing of Objects (Labtalk)">アルファベット順のオブジェクトリスト</a>にあります。
</p><p>通常、各オブジェクトにはプロパティがあり、そしてオブジェクトを操作するメソッドがあります。  オブジェクトのプロパティとメソッドは、個々のオブジェクトにより異なります。  例えば、データ列はグラフとは異なるプロパティを持ち、それぞれに実行する操作も異なります。  どちらの場合でも、オブジェクトのプロパティにアクセスしたり、メソッドを呼び出すための一般的なシンタックスが必要です。  これらは以下にまとめられています。
</p><p>また、オブジェクトの名前を変更することができるので、異なる<a href="../../LabTalk/LabTalk/Data_Types_and_Variables.html#Scope_of_Variables" title="LabTalk:データ型と変数">スコープ</a>のオブジェクトで名前を共有すると、オブジェクト名が紛らわしくなります。  そのような理由から、各オブジェクトには固有のユニバーサルID(UID)が割り当てられ、オブジェクト名とそのUID間の相互に参照する機能があります。
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Properties"><span class="tocnumber">1</span> <span class="toctext">プロパティ</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Methods"><span class="tocnumber">2</span> <span class="toctext">メソッド</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Object_Name_and_Universal_Identifier_.28UID.29"><span class="tocnumber">3</span> <span class="toctext">オブジェクト名とユニバーサルID(UID)</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Getting_Page_and_Layer_from_a_Range_Variable"><span class="tocnumber">3.1</span> <span class="toctext">範囲変数からページとレイヤを取得</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Getting_Book_And_Sheet_from_a_Plot"><span class="tocnumber">3.2</span> <span class="toctext">プロットからブックとシートを取得</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="Properties"></a><span class="mw-headline">プロパティ</span></h2>
<p><span class="OIndex">プロパティ</span>は、次のようなシンタックスを持つオブジェクトに結びついた数値またはテキスト文字列を設定するか、返します。
</p>
<dl><dd><font color="navy"><b><i>objName</i>.<i>property</i></b></font>   (数値のプロパティ) <br /><font color="navy"><b><i>objName</i>.<i>property</i>$</b></font> (テキストのプロパティ)</dd></dl>
<p>ここで <i>objName</i> はオブジェクトの名前で、<i>property</i> はオブジェクトの種類に対する有効なプロパティです。テキストオブジェクトにアクセスするとき、<i>プロパティ</i>の後ろに<b>$</b>記号を付ける必要があります。
</p><p>例えば、次の方法でオブジェクトプロパティを設定できます。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// アクティブワークシートの列数を10に設定</span>
wks.<span style="color: #000080;">ncols</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span>;   
<span style="color: #008000;">// アクティブワークシートをMySheetという名前にする</span>
wks.<span style="color: #000080;">name</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> MySheet;</pre>
<p>またはプロパティの値を取得できます。
</p>
<pre class="lt" style="font-family:monospace;">pn<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> page.<span style="color: #000080;">name</span><span style="color: #000080;">$</span>;  <span style="color: #008000;">// アクティブページ名を取得</span>
layer.<span style="color: #000080;">x</span>.<span style="color: #000080;">from</span> <span style="color: #000080;">=</span>&nbsp;;   <span style="color: #008000;">// X軸の開始値を取得して表示</span></pre>
<h2><a name="Methods"></a><span class="mw-headline">メソッド</span></h2>
<p><span class="OIndex">メソッド</span>は、直ちに実行可能なコマンドです。実行される時、メソッドはオブジェクトと関連する処理を実行し、値を表示します。オブジェクトメソッドは次の構文で表わされます。
</p>
<dl><dd><font color="navy"><b><i>objName</i>.<i>method</i>(<i>arguments</i>)</b></font></dd></dl>
<p>ここで<i>objName</i>は、オブジェクトの名前で、<i>method</i>は、オブジェクトの種類に対して有効なメソッド、<i>arguments</i> はメソッドがどのような動作をさせるかを決めます。一部の引数はオプションです。そして、一部のメソッドは引数を必要としません。ただし、全てのオブジェクトメソッドのステートメントは括弧 &quot;()&quot; で囲む必要があります。
</p><p>例えば、次のコードは、<a href="../../LabTalk/LabTalk/Run_(object).html" title="LabTalk:Run (オブジェクト)"><b>run</b> オブジェクト</a>の<b>section</b>メソッドを使って、<b>computeCircle</b>, という名前のスクリプトにある<b>Main</b>セクションを呼び出して、3つの引数を渡します。
</p>
<pre class="lt" style="font-family:monospace;">double RR <span style="color: #000080;">=</span> <span style="color: #0000dd;">4.5</span>;
string PA<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Perimeter and Area&quot;</span>;
run.<span style="color: #000080;">section</span><span style="color: #000000;">(</span>computeCircle, Main, PA<span style="color: #000080;">$</span> <span style="color: #0000dd;">3.14</span> R<span style="color: #000000;">)</span>;</pre>
<h2><a name="Object_Name_and_Universal_Identifier_.28UID.29"></a><span class="mw-headline">オブジェクト名とユニバーサルID(UID)</span></h2>
<p>各オブジェクトには、ショートネームとロングネームがあり、ほとんどのオブジェクトには<span class="OIndex">ユニバーサルID</span> (<span class="OIndex">UID</span>)があります。  ショートネームとロングネームの両方とも変更できますが、オブジェクトのUIDはプロジェクト(OPJファイル)内では同じままです。  オブジェクトのUIDは、あるプロジェクトを別のプロジェクトに変更する場合に変わります。これは、すべてのオブジェクトUIDがリフレッシュされ、新しく組み合わせられたプロジェクト内で各オブジェクトが固有になるように再設定されるためです。 
</p><p>多くのLabTalk関数には引数としてオブジェクト名が必要です。また、オブジェクトの名前は変更可能なので、変換のために、次の関数を使用できます。
</p>
<ul><li> <b><i>nVal</i> = range2uid(<i>rangeName</i>$)</b></li>
<li> <b><i>str</i>$ = uid2name(<i>nVal</i>)$</b></li>
<li> <b><i>str</i>$ = uid2range(<i>nVal</i>)$</b></li></ul>
<p>関連する関数は、次の一般シンタックスを持つ<b><a href="../../LabTalk/LabTalk/NameOf_(function).html" title="LabTalk:NameOf (関数)">NameOf(range$)</a></b>です。
</p>
<ul><li> <b><i>str</i>$ = nameof(<i>rangeName</i>$)</b></li></ul>
<p>その利用法は次のサンプルで示しています。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// (Book1, Sheet1内の)列1の範囲変数を確立</span>
range ra<span style="color: #000080;">=</span><span style="color: #000000;">[</span>Book1<span style="color: #000000;">]</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #0000dd;">1</span>;    
<span style="color: #008000;">//その範囲と結びついた内部名を取得
</span>
string na<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> NameOf<span style="color: #000000;">(</span>ra<span style="color: #000000;">)</span><span style="color: #000080;">$</span>; 
<span style="color: #008000;">// na$は&apos;Book1_A&apos;になる</span>
na<span style="color: #000080;">$</span> <span style="color: #000080;">=</span>;         
<span style="color: #008000;">//  内部名を与えるUIDを取得               </span>
int nDataSetUID <span style="color: #000080;">=</span> range2uid<span style="color: #000000;">(</span>na<span style="color: #000080;">$</span><span style="color: #000000;">)</span>;</pre>
<p>範囲名に加え、列、シート、ブックそれら自体の名前からUIDを取得することができます。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 列2のUIDを返す</span>
int nColUID <span style="color: #000080;">=</span> range2uid<span style="color: #000000;">(</span>col<span style="color: #000000;">(</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;              
<span style="color: #008000;">// シートまたはレイヤのUIDを返す</span>
int nLayerUID <span style="color: #000080;">=</span> range2uid<span style="color: #000000;">(</span><span style="color: #000000;">[</span>book2<span style="color: #000000;">]</span>Sheet3<span style="color: #000080;">!</span><span style="color: #000000;">)</span>; 
<span style="color: #008000;">// アクティブシートまたはレイヤのUIDを返す</span>
nLayerUID <span style="color: #000080;">=</span>range2uid<span style="color: #000000;">(</span><span style="color: #000080;">!</span><span style="color: #000000;">)</span>;   
<span style="color: #008000;">// アクティブワークブックのシート3のUIDを返す</span>
nLayerUID <span style="color: #000080;">=</span>range2uid<span style="color: #000000;">(</span>sheet3<span style="color: #000080;">!</span><span style="color: #000000;">)</span>;      
<span style="color: #008000;">// 特定シート内のインデックス &apos;jj&apos; を持つ列のUIDを返す </span>
nColUID <span style="color: #000080;">=</span> range2uid<span style="color: #000000;">(</span><span style="color: #000000;">[</span>Book1<span style="color: #000000;">]</span>sheet2<span style="color: #000080;">!</span>wcol<span style="color: #000000;">(</span>jj<span style="color: #000000;">)</span><span style="color: #000000;">)</span>;</pre>
<p>また、関数range2uid は、実行中のデータプロット名やデータ列名を含むシステム変数 <b><a href="../../LabTalk/LabTalk/String_registers.html#String_Registers_as_System_Variables" title="LabTalk:文字列レジスタ">%C</a></b>と働きます。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// アクティブデータプロットまたは選択した列のUIDを返す</span>
nDataSetUID <span style="color: #000080;">=</span> range2uid<span style="color: #000000;">(</span><span style="color: #000080;">%</span>C<span style="color: #000000;">)</span>;</pre>
<h3><a name="Getting_Page_and_Layer_from_a_Range_Variable"></a><span class="mw-headline">範囲変数からページとレイヤを取得</span></h3>
<p><span class="OIndex">範囲変数</span>を与えると、対応するページとレイヤのUIDを取得することができます。次のコードは、現在のシートのXYデータから非表示のプロットを作成し、非表示のプロットのグラフページ名を取得する方法を示しています。
</p>
<pre class="lt" style="font-family:monospace;">plotxy <span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">)</span> hide<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>; <span style="color: #008000;">// A(x)B(y)を新しい非表示のプロットに作図</span>
range aa<span style="color: #000080;">=</span>plotxy.<span style="color: #000080;">ogl</span><span style="color: #000080;">$</span>;
int uid<span style="color: #000080;">=</span>aa.<span style="color: #000080;">GetPage</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
string str<span style="color: #000080;">$</span><span style="color: #000080;">=</span>uid2Name<span style="color: #000000;">(</span>uid<span style="color: #000000;">)</span><span style="color: #000080;">$</span>;
type <span style="color: #ff00ff;">&quot;Resulting graph name is&nbsp;%(str$)&quot;</span>;</pre>
<h3><a name="Getting_Book_And_Sheet_from_a_Plot"></a><span class="mw-headline">プロットからブックとシートを取得</span></h3>
<p>データプロットに関連したワークブックとワークシートを範囲変数として取得することもできます。次のコード(Origin 8 SR2以降)は、アクティブプロット(<a href="../../LabTalk/LabTalk/String_registers.html#String_Registers_as_System_Variables" title="LabTalk:文字列レジスタ">%C</a>)を列範囲として取得する方法を示し、そこから対応するワークシート変数とブック変数を取り出します。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//アクティブプロットの列範囲、 -w スイッチはデフォルトでY列を取得</span>
range <span style="color: #000080;">-</span>w aa<span style="color: #000080;">=</span><span style="color: #000080;">%</span>C;
<span style="color: #008000;">// シートに対するwks範囲、列は以下に属する</span>
range ss <span style="color: #000080;">=</span> uid2range<span style="color: #000000;">(</span>aa.<span style="color: #000080;">GetLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span><span style="color: #000080;">$</span>;
<span style="color: #008000;">// シート名を表示</span>
ss.<span style="color: #000080;">name</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>;
<span style="color: #008000;">// その列からのブックの範囲</span>
range bb <span style="color: #000080;">=</span> uid2range<span style="color: #000000;">(</span>aa.<span style="color: #000080;">GetPage</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span><span style="color: #000080;">$</span>;
<span style="color: #008000;">// ブック名を表示</span>
bb.<span style="color: #000080;">name</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>;</pre>
<p>文字列形式でGetLayerとGetPageから返す範囲文字列を直接使うより簡単な方法もあります。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//アクティブプロットの列範囲、 -w スイッチはデフォルトでY列を取得</span>
range <span style="color: #000080;">-</span>w aa<span style="color: #000080;">=</span><span style="color: #000080;">%</span>C;
<span style="color: #008000;">// シートに対するsheet範囲文字列は以下に属する</span>
range ss <span style="color: #000080;">=</span> aa.<span style="color: #000080;">GetLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000080;">$</span>;
<span style="color: #008000;">// シート名を表示</span>
ss.<span style="color: #000080;">name</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>;
<span style="color: #008000;">// その列からのブック範囲文字列</span>
range bb <span style="color: #000080;">=</span> aa.<span style="color: #000080;">GetPage</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000080;">$</span>;
<span style="color: #008000;">// ブック名を表示</span>
bb.<span style="color: #000080;">name</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>;</pre>
<p>ページにマッピングされた範囲を作成するとき、範囲変数は <a href="../../LabTalk/LabTalk/Page_(object).html" title="LabTalk:Page (オブジェクト)">PAGE (オブジェクト)</a>のプロパティを持ちます。<br />
グラフレイヤにマッピングされた範囲を作成するとき、範囲変数は<a href="../../LabTalk/LabTalk/Layer_(object).html" title="LabTalk:Layer (オブジェクト)">LAYER (オブジェクト)</a>のプロパティを持ちます。<br />
ワークブックレイヤ(ワークシートまたは行列シート)にマッピングされた範囲を作成するとき、範囲変数は<a href="../../LabTalk/LabTalk/Wks_(object).html" title="LabTalk:Wks(オブジェクト)">WKS (オブジェクト)</a>のプロパティを持ちます。
</p>






    