<h1 class="firstheading">Wks.Col</h1>

  <p class='urlname' style='display: none'>Wks-Col-obj</p>

  <p><br>
  <span class="OIndex" style="display:none">Object, Column</span>Columns in a worksheet or objects in a matrix are handled as objects in Origin. These objects can contain much information, such as column name, column numeric type, data formats, etc. The <span class="OIndex">column attribute</span>s can be accessed and changed using the properties in the table below.</p>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>Contents</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1"><a href="#Properties_and_MethodsColumn_Method"><span class="tocnumber">1</span> <span class="toctext">Properties and Methods<span class="OIndex" style="display:none">Column Method</span></span></a></li>

      <li class="toclevel-1 tocsection-2"><a href="#Methods:"><span class="tocnumber">2</span> <span class="toctext">Methods:</span></a></li>

      <li class="toclevel-1 tocsection-3">
        <a href="#Examples"><span class="tocnumber">3</span> <span class="toctext">Examples</span></a>

        <ul>
          <li class="toclevel-2 tocsection-4">
            <a href="#Worksheet_Column_Access"><span class="tocnumber">3.1</span> <span class="toctext">Worksheet Column Access</span></a>

            <ul>
              <li class="toclevel-3 tocsection-5"><a href="#Active_sheet_column_access_by_indexAccess_column_by_index"><span class="tocnumber">3.1.1</span> <span class="toctext">Active sheet column access by index<span class="OIndex" style="display:none">Access column by index</span></span></a></li>

              <li class="toclevel-3 tocsection-6"><a href="#Range_variable_that_represents_a_columnRange_as_column"><span class="tocnumber">3.1.2</span> <span class="toctext">Range variable that represents a column<span class="OIndex" style="display:none">Range as column</span></span></a></li>

              <li class="toclevel-3 tocsection-7"><a href="#Designating_variable_column_number"><span class="tocnumber">3.1.3</span> <span class="toctext">Designating variable column number</span></a></li>
            </ul>
          </li>

          <li class="toclevel-2 tocsection-8"><a href="#Set_Column_Type"><span class="tocnumber">3.2</span> <span class="toctext">Set Column Type</span></a></li>

          <li class="toclevel-2 tocsection-9"><a href="#Loop_Over_ColumnsLoop_Over_ColumnsColumns.2C_Loop_Over"><span class="tocnumber">3.3</span> <span class="toctext">Loop Over Columns<span class="OIndex" style="display:none">Loop Over Columns</span><span class="OIndex" style="display:none">Columns, Loop Over</span></span></a></li>

          <li class="toclevel-2 tocsection-10"><a href="#Create_Internal_X_Dataset"><span class="tocnumber">3.4</span> <span class="toctext">Create Internal X Dataset</span></a></li>

          <li class="toclevel-2 tocsection-11"><a href="#Set_Custom_Date_FormatCustom_Date_FormatDate_Format.2C_Customization"><span class="tocnumber">3.5</span> <span class="toctext">Set Custom Date Format<span class="OIndex" style="display:none">Custom Date Format</span><span class="OIndex" style="display:none">Date Format, Customization</span></span></a></li>

          <li class="toclevel-2 tocsection-12"><a href="#Setting_up_a_Worksheet_Filter"><span class="tocnumber">3.6</span> <span class="toctext">Setting up a Worksheet Filter</span></a></li>

          <li class="toclevel-2 tocsection-13"><a href="#Set_Column_as_Categorical"><span class="tocnumber">3.7</span> <span class="toctext">Set Column as Categorical</span></a></li>

          <li class="toclevel-2 tocsection-14"><a href="#Remove_Column_Filter"><span class="tocnumber">3.8</span> <span class="toctext">Remove Column Filter</span></a></li>

          <li class="toclevel-2 tocsection-15"><a href="#Access_Python_Function_in_Set_.28Column.29_Values"><span class="tocnumber">3.9</span> <span class="toctext">Access Python Function in Set (Column) Values</span></a></li>
        </ul>
      </li>
    </ul>
  </div>

  <h2><a name="Properties_and_MethodsColumn_Method"></a><span class="mw-headline">Properties and Methods<span class="OIndex" style="display:none">Column Method</span></span></h2>

  <table class="simple">
    <tr>
      <th width="110">Property</th>

      <th width="70">Access</th>

      <th width="540">Description</th>
    </tr>

    <tr>
      <td>
        wks.col.comment$

        <p align="right"><font color="red">(8.0 SR0)</font></p>
      </td>

      <td>Read/write<br>
      string</td>

      <td>Column Comment row header string value.</td>
    </tr>

    <tr>
      <td>
        wks.col.categorical.sort

        <p align="right"><font color="red">(2017 SR0)</font></p>
      </td>

      <td>Read/Write<br>
      numeric</td>

      <td>
        Read or set the sort method for column <i>n</i>: 0 = unsorted, 1 = ascending, 2 = descending and 3 = customizable (arbitrary).

        <p><b>Notes:</b> "Unsorted" follows order of appearance in the column. Sort method=3 is <i>Read Only</i>.</p>
      </td>
    </tr>

    <tr>
      <td>
        wks.col.categorical.type

        <p align="right"><font color="red">(2017 SR0)</font></p>
      </td>

      <td>Read/Write<br>
      numeric</td>

      <td>
        Read or set the type for column <i>n</i>:<br>

        <p>0 = Column type not Categorical.<br>
        1 = Auto off: Set as Categorical, with Categories manually managed. Categories can be added/deleted and are arbitrarily sorted (cannot be sorted by <code>wks.col.categorical.sort</code>).<br>
        2 = Auto on: Set as Categorical, with Categories auto-generated by column data (can be sorted by <code>wks.col.categorical.sort</code>). Categories updated automatically with data change.</p>
      </td>
    </tr>

    <tr>
      <td>wks.col.cmap.palette$</td>

      <td>Read/Write<br>
      string</td>

      <td>Read or set the color palette for the matrix object.</td>
    </tr>

    <tr>
      <td>wks.col.digitMode</td>

      <td>Read/write<br>
      numeric</td>

      <td>Set the digit display mode: 0 = display all, 1 = set the decimal places, and 2 = set the significant digits.<br>
      When <code>wks.col[n].digitmode = 0</code>, <code>wks.col[n].digits</code> is set to 0.<br>
      When <code>wks.col[n].digitmode = 1</code>, <code>wks.col[n].digits</code> is set to 3.<br>
      When <code>wks.col[n].digitmode = 2</code>, <code>wks.col[n].digits</code> is set to 6.</td>
    </tr>

    <tr>
      <td>wks.col.digits</td>

      <td>Read/write<br>
      numeric</td>

      <td>Number of decimal places when <code>wks.col.digitMode = 1</code>, number of significant digits when <code>wks.col.digitmode = 2</code>: 0 = display all, <i>n</i> = display <i>n</i>.</td>
    </tr>

    <tr>
      <td>
        wks.col.edit

        <p align="right"><font color="red">(2019)</font></p>
      </td>

      <td>Read/write<br>
      numeric</td>

      <td>Adds one of the following controls to each cell in the column. Options =2 and =3 require the user to click into the cell for the control to show: 1 = unselected check box, 2 = list box (not editable), 3 = combobox (editable). Remove controls using wks.col.edit = 0 (e.g. <code>wks.col2.edit=2; //add list box to column 2</code>, <code>wks.col2.edit=0; // remove list box from column 2</code>).</td>
    </tr>

    <tr>
      <td>wks.col.evenx</td>

      <td>Read/write<br>
      numeric</td>

      <td>Read or set column <i>n</i> to be using Sample Interval: 0 = not using Sample Interval, 1 = using Sample Interval with Internal X Initial value = 0 and Increment value = 1.</td>
    </tr>

    <tr>
      <td>
        wks.col.filter

        <p align="right"><font color="red">(9.0 SR0)</font></p>
      </td>

      <td>Read/write<br>
      numeric</td>

      <td>
        Add or remove a filter.<br>

        <p>0 = remove filter<br>
        1 = add filter<br>
        2 = custom filter (read only)<br>
        <br>
        <b>Note:</b> Filter properties are set by using these filter related scripts, but the filter will not run automatically, and the method <a href="../../LabTalk/LabTalk/Wks_(object).html" title="LabTalk:Wks (object)">wks.runfilter()</a> needs to be called to run or re-apply the filter.</p>
      </td>
    </tr>

    <tr>
      <td>
        wks.col.filter$

        <p align="right"><font color="red">(9.0 SR0)</font></p>
      </td>

      <td>Read/write<br>
      string</td>

      <td>Set or get filter query string. It must set the filter type to advance.</td>
    </tr>

    <tr>
      <td>
        wks.col.filterenabled

        <p align="right"><font color="red">(9.0 SR0)</font></p>
      </td>

      <td>Read/write<br>
      numeric</td>

      <td>Enable or disable a filter. 1 = enable filter, and 0 = disable filter.</td>
    </tr>

    <tr>
      <td>
        wks.col.filterprescript$

        <p align="right"><font color="red">(9.0 SR0)</font></p>
      </td>

      <td>Read/write<br>
      string</td>

      <td>Set or get before query script.</td>
    </tr>

    <tr>
      <td>
        wks.col.filterx$

        <p align="right"><font color="red">(9.0 SR0)</font></p>
      </td>

      <td>Read/write<br>
      string</td>

      <td>Set and get the variable used to represent the column.</td>
    </tr>

    <tr>
      <td>wks.col.format</td>

      <td>Read/write<br>
      numeric</td>

      <td>Column format: 1 = Numeric, 2 = Text, 3 = Time, 4 = Date, 5 = Month, 6 = Day of Week, 7 = Text and Numeric, and 8 = Color as listed in the Format drop-down list in the Worksheet Column Format dialog box.</td>
    </tr>

    <tr>
      <td>wks.col.formula$</td>

      <td>Read/write<font color="red">(9.8b)</font><br>
      string</td>

      <td>Column formula as in <b>Set (Column) Values</b> or in <b>F(x)=</b> label row (see also <a href="../../LabTalk/LabTalk/Column_Label_Row_Characters.html" title="LabTalk:Column Label Row Characters">Column Label Row Characters</a>).</td>
    </tr>

    <tr>
      <td>wks.col.formularange$</td>

      <td>Read<br>
      string</td>

      <td>Column formula range as in <b>Set (Column) Values</b>.</td>
    </tr>

    <tr>
      <td>wks.col.index</td>

      <td>Read/write<br>
      numeric</td>

      <td>
        Column index counting from left to right.

        <p>Use this property to reorder worksheet column. For example:</p>
        <pre class="lt" style="font-family:monospace;">
range rr <span style="color: #000080;">=</span> col<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span>; <span style="color: #008000;">// Define a range notation</span>
rr.<span style="color: #000080;">index</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>; <span style="color: #008000;">// Move the column as the 2nd column</span>
</pre>

        <p><b>Note:</b> This property is <i>Read Only</i> before <font color="red">8.5.0 SR1</font>.</p>
      </td>
    </tr>

    <tr>
      <td>wks.col.iscat</td>

      <td>Read/write<br>
      numeric</td>

      <td>Read or set column is Categorical or not. 0 = Column type is not Categorical, 1 = Column type is Categorical.</td>
    </tr>

    <tr>
      <td>
        wks.col.justify

        <p align="right"><font color="red">Deprecated</font></p>
      </td>

      <td>Read/write<br>
      numeric</td>

      <td>
        Set the justification for worksheet cell values. 1 = right, 2 = left, and 3 = center.

        <p><b>Note:</b> This property was deprecated after 8.0.<br>
        As an workaround, you can use the <i><a href="../../LabTalk/LabTalk/Menu_(command).html#-e.3B_Execute_the_menu_command_with_the_specified_ID" title="LabTalk:Menu (command)">menu -e</a></i> command instead. For example, to set the 2nd column as center:</p>
        <pre class="lt" style="font-family:monospace;">
worksheet <span style="color: #000080;">-</span>s <span style="color: #0000dd;">2</span> <span style="color: #0000dd;">0</span> <span style="color: #0000dd;">2</span> <span style="color: #0000dd;">0</span>;
menu <span style="color: #000080;">-</span>e <span style="color: #0000dd;">35153</span>;
</pre>

        <p>Where 35152 = left, 35153 = center, and 35154 = right.</p>
      </td>
    </tr>

    <tr>
      <td>wks.col.label$</td>

      <td>Read/write<br>
      string</td>

      <td>Column label access for versions before 8.0. Still supporte to control long name, units and comments in a single call. For detailed access to column long name, units and comments, use <a href="../../LabTalk/LabTalk/Column_Label_Row_Characters.html" title="LabTalk:Column Label Row Characters">col(a)[L]$, col(a)[C]$ etc notation</a> instead.</td>
    </tr>

    <tr>
      <td>
        wks.col.lname$

        <p align="right"><font color="red">(8.5 SR0)</font></p>
      </td>

      <td>Read/write<br>
      string</td>

      <td>String value for the long name of column or matrix object.</td>
    </tr>

    <tr>
      <td>
        wks.col.missing

        <p align="right"><font color="red">(8.0 SR1)</font></p>
      </td>

      <td>Read/write<br>
      numeric</td>

      <td>
        Custom missing value, this is particularily important for data types other then double as by default, only Text &amp; Numeric or double has built-in missing value support. This property allow setting custom missing value such that non-double columns can have missing value support. 0/0 means no custom missing value, i.e.
        <pre class="lt" style="font-family:monospace;">
wks.<span style="color: #000080;">col</span>.<span style="color: #000080;">missing</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span><span style="color: #000080;">/</span><span style="color: #0000dd;">0</span>;<span style="color: #008000;">//to turn off custom missing value</span>
</pre>
      </td>
    </tr>

    <tr>
      <td>wks.col.name$</td>

      <td>Read/write<br>
      string</td>

      <td>Column short name</td>
    </tr>

    <tr>
      <td>
        wks.col.nCols

        <p align="right"><font color="red">(8.0 SR1)</font></p>
      </td>

      <td>Read/write<br>
      int</td>

      <td>Number of columns for Matrix Object; for worksheet column, always 1.</td>
    </tr>

    <tr>
      <td>
        wks.col.nRows

        <p align="right"><font color="red">(8.0 SR1)</font></p>
      </td>

      <td>Read/write<br>
      int</td>

      <td>Number of rows</td>
    </tr>

    <tr>
      <td>
        wks.col.numerictype

        <p align="right"><font color="red">(8.0 SR1)</font></p>
      </td>

      <td>Read/write<br>
      numeric</td>

      <td>
        Column numeric type:

        <p>0 = non-numeric, 1 = double, 2 = float, 3 = short int, 4 = int, 5 = char, 8=byte, 9=unsigned short int, 10 = unsigned int, 11=complex</p>

        <p>The following values are redundant, since they are the same as Column format</p>

        <p>6 = Text, same as format = 2</p>

        <p>7 = Text and Numeric, same as format = 7</p>
      </td>
    </tr>

    <tr>
      <td>wks.col.py$</td>

      <td>Read/write<font color="red">(9.8b)</font><br>
      string</td>

      <td>Contents of Python Formula tab in <b>Set (Column) Values</b></td>
    </tr>

    <tr>
      <td>wks.col.script$</td>

      <td>Read/write<font color="red">(9.8b)</font><br>
      string</td>

      <td>Contents of Before Formula Script tab in <b>Set (Column) Values</b></td>
    </tr>

    <tr>
      <td>wks.col.subformat</td>

      <td>Read/write<br>
      numeric</td>

      <td>Subformat options as listed in the <b>Display</b> drop-down list of the Worksheet Column Format dialog box (select from main menu <b>Format: Column ...</b> to open this dialog). To get the appropriate number of the option you want, simply count down from the top of the list of <b>Display</b> options, starting from 1. For example, 1 stands for "7/30/2020", the 1st entry. and 22 is "Custom Display", the last entry. Please note that options "2020-W34" and "2020-W34-3" are newly added, so they are indexed after "Custom Display". That is, 23 for "2020-W34", and 24 for "2020-W34-3". Make sure the desired <b>Format</b> has been selected first.</td>
    </tr>

    <tr>
      <td>
        wks.col.svrm

        <p align="right"><font color="red">(8.0 SR0)</font></p>
      </td>

      <td>Read/write<br>
      integer</td>

      <td>Set Value Recalculate Mode for the column formula (in any) of the column. 0=none,1=auto,2=manual.</td>
    </tr>

    <tr>
      <td>wks.col.tWidth</td>

      <td>Read/write<br>
      numeric</td>

      <td>The number of characters that can be entered in a Text column. The default value = 49. The maximum value = 799. Note that a Text &amp; Numeric column will hold a max of 3799 characters.</td>
    </tr>

    <tr>
      <td>wks.col.type</td>

      <td>Read/write<br>
      numeric</td>

      <td>Column type: 1 = Y, 2 = disregard, 3 = Y Error, 4 = X, 5 = Label, 6 = Z, and 7 = X Error. <a href="#Set_Column_Type">Example</a> below.</td>
    </tr>

    <tr>
      <td>wks.col.unit</td>

      <td>Read/write<br>
      string</td>

      <td>Units row header</td>
    </tr>

    <tr>
      <td>wks.col.width</td>

      <td>Read/write<br>
      numeric</td>

      <td>Width of a single worksheet column (e.g. "col1"), in units of characters. Also see the <a class="external text" href="../../XFunction/X-Function/Wcolwidth.html"><b>wcolwidth</b></a> X-Function which can be used to set the width of a column range or <a href="../../LabTalk/LabTalk/Wks_(object).html#PropertiesWorksheet_Property" title="LabTalk:Wks (object)">wks.colWidth</a> which can be used to set the width of all columns in the active sheet.</td>
    </tr>

    <tr>
      <td>
        wks.col.xinit

        <p align="right"><font color="red">(8.0 SR2)</font></p>
      </td>

      <td>Read/write<br>
      numeric</td>

      <td>Internal X Initial value for column. The XINIT, XINC and XUNITS appear in the Sampling Interval row header if displayed. <a href="#Create_Internal_X_Dataset">Example</a> below.</td>
    </tr>

    <tr>
      <td>
        wks.col.xinc

        <p align="right"><font color="red">(8.0 SR2)</font></p>
      </td>

      <td>Read/write<br>
      numeric</td>

      <td>Internal X Increment value for column. <a href="#Create_Internal_X_Dataset">Example</a> below.</td>
    </tr>

    <tr>
      <td>
        wks.col.xuints$

        <p align="right"><font color="red">(8.0 SR2)</font></p>
      </td>

      <td>Read/write<br>
      string</td>

      <td>Internal X Units string for column. <a href="#Create_Internal_X_Dataset">Example</a> below.</td>
    </tr>

    <tr>
      <td>
        wks.col.xname$

        <p align="right"><font color="red">(8.0 SR2)</font></p>
      </td>

      <td>Read/write<br>
      string</td>

      <td>Internal X Name string for column. The XNAME and XUNITS appear as the X Axis Title on plots of this column. <a href="#Create_Internal_X_Dataset">Example</a> below.</td>
    </tr>
  </table>

  <h2><a name="Methods:"></a><span class="mw-headline"><font color="chocolate">Methods:</font></span></h2>

  <p><span class="OIndex" style="display:none">Layer method</span></p>

  <table class="simple" width="100%">
    <tr>
      <th width="25%">Method</th>

      <th width="75%">Description</th>
    </tr>

    <tr>
      <td><b>wks.col.filter([<i>Dialog</i>])</b></td>

      <td>
        Open the filter dialog, where <i><b>Dialog</b></i> is:

        <p>0 = (default) open the associated filter dialog (Top <i>N</i>, Simple Numeric Filter, etc.).<br>
        1 = open the Custom Data Filter dialog.</p>
      </td>
    </tr>

    <tr>
      <td>
        <b>wks.col.setformat(<i>format[, subformat , customFormat]</i>)</b>

        <p align="right"><font color="red">(8.0 SR2)</font></p>
      </td>

      <td>
        Setformat method combines functionalities of the format and subformat methods, additionally allowing custom formats to be specified. This object method takes up to 3 arguments, See format and subformat properties above. Only set subformat and customformat if format is 4 (date)

        <p>wks.col.setformat(2) //set to text</p>

        <p>wks.col.setformat(2) //set to date using system date format</p>

        <p>wks.col.setformat(4,10) //set to date using 11th built-in date format</p>

        <p>wks.col.setformat(4, 22, dd-MMM-yyyy HH:mm:ss.###) //set to date using custom date format <a href="#Set_Custom_Date_FormatCustom_Date_FormatDate_Format.2C_Customization">Example</a> below.</p>
      </td>
    </tr>

    <tr>
      <td>
        <b>wks.col.setformula([<i>string register</i>], autoupdatemethod=au_none)</b>

        <p align="right"><font color="red">(8.6)</font></p>
      </td>

      <td>
        The first is mandatory and contains the name of the system string containing the column formula (in the example above it is Z).

        <p>The second argument is optional and takes values from the enumeration AUTOUPDATEMODE (default= AU_NONE) to specify the autoupdate mode.</p>

        <p>%Z = "col(1) + 100"; wks.col2.SetFormula(Z, 1);</p>
      </td>
    </tr>

    <tr>
      <td><b>wks.col.findX()</b></td>

      <td>
        Returns corresponding X column index

        <p>wks.col3.findx()= will return 1 if the 3rd column's X column is 1.</p>
      </td>
    </tr>
  </table>

  <h2><a name="Examples"></a><span class="mw-headline"><font color="chocolate">Examples</font></span></h2>

  <h3><a name="Worksheet_Column_Access"></a><span class="mw-headline">Worksheet Column Access</span></h3>

  <p>Worksheet Column objects can be accessed in the following two ways:</p>

  <h4><a name="Active_sheet_column_access_by_indexAccess_column_by_index"></a><span class="mw-headline">Active sheet column access by index<span class="OIndex" style="display:none">Access column by index</span></span></h4>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">// Set col(1)'s short name in active sheet as "Time"</span>
wks.<span style="color: #000080;">col1</span>.<span style="color: #000080;">name</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Time;

<span style="color: #008000;">// You can reference another book, but the target sheet must still be active</span>
<span style="color: #008000;">// Set column 5 in the active sheet of Book5 to be an X column</span>
Book5<span style="color: #000080;">!</span>wks.<span style="color: #000080;">col5</span>.<span style="color: #000080;">type</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">4</span>;

<span style="color: #008000;">// col0 to refer to last column</span>
<span style="color: #008000;">//set last column formula</span>
wks.<span style="color: #000080;">col0</span>.<span style="color: #000080;">formula</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">"A"</span>;
</pre>

  <h4><a name="Range_variable_that_represents_a_columnRange_as_column"></a><span class="mw-headline">Range variable that represents a column<span class="OIndex" style="display:none">Range as column</span></span></h4>
  <pre class="lt" style="font-family:monospace;">
range cc <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>Book1<span style="color: #000000;">]</span>Sheet1<span style="color: #000080;">!</span>col<span style="color: #000000;">(</span><span style="color: #ff00ff;">"Room Temperature"</span><span style="color: #000000;">)</span>;   <span style="color: #008000;">// Define a range</span>
cc.<span style="color: #000080;">width</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span>;                <span style="color: #008000;">// Set the column width as 10</span>
</pre>

  <h4><a name="Designating_variable_column_number"></a><span class="mw-headline">Designating variable column number</span></h4>

  <p>The column number may be omitted if you first set the <b>wks.col</b> property to the number of the column you wish to address.</p>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">// Set every odd column as an X column</span>
for<span style="color: #000000;">(</span> ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span> ; ii <span style="color: #000080;">&lt;=</span> wks.<span style="color: #000080;">ncols</span> ; ii<span style="color: #000080;">+</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
   wks.<span style="color: #000080;">col</span> <span style="color: #000080;">=</span> ii;
   wks.<span style="color: #000080;">col</span>.<span style="color: #000080;">type</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">4</span>;
<span style="color: #000000;">}</span>
<span style="color: #008000;">// which is equivalent to</span>
for<span style="color: #000000;">(</span> ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span> ; ii <span style="color: #000080;">&lt;=</span> wks.<span style="color: #000080;">ncols</span> ; ii<span style="color: #000080;">+</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
   wks.<span style="color: #000080;">col</span><span style="color: #000080;">$</span><span style="color: #000000;">(</span>ii<span style="color: #000000;">)</span>.<span style="color: #000080;">type</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">4</span>;
<span style="color: #000000;">}</span>
</pre>

  <p>For column labels, you can access by <a href="../../LabTalk/LabTalk/Column_Label_Row_Characters.html" title="LabTalk:Column Label Row Characters">column label row characters</a>.</p>

  <h3><a name="Set_Column_Type"></a><span class="mw-headline">Set Column Type</span></h3>

  <p>This script sets column 1 of the active window to be an X column.</p>
  <pre class="lt" style="font-family:monospace;">
wks.<span style="color: #000080;">col1</span>.<span style="color: #000080;">type</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">4</span>;
</pre>

  <h3><a name="Loop_Over_ColumnsLoop_Over_ColumnsColumns.2C_Loop_Over"></a><span class="mw-headline">Loop Over Columns<span class="OIndex" style="display:none">Loop Over Columns</span><span class="OIndex" style="display:none">Columns, Loop Over</span></span></h3>

  <p>This script loops over the all workbooks and columns, and then prints the names of the columns.</p>
  <pre class="lt" style="font-family:monospace;">
doc <span style="color: #000080;">-</span>e LB <span style="color: #000000;">{</span>
        loop <span style="color: #000000;">(</span>var, <span style="color: #0000dd;">1</span>, wks.<span style="color: #000080;">ncols</span><span style="color: #000000;">)</span>     
        <span style="color: #000000;">{</span>
                type <span style="color: #ff00ff;">"This is column %(wks.col$(var).name$) in %H, %(page.active$)"</span>;
        <span style="color: #000000;">}</span>;
<span style="color: #000000;">}</span>;
</pre>

  <h3><a name="Create_Internal_X_Dataset"></a><span class="mw-headline">Create Internal X Dataset</span></h3>

  <p>This script creates an internal X dataset for a Y column and plots the Y against this X.</p>
  <pre class="lt" style="font-family:monospace;">
newbook;
col<span style="color: #000000;">(</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span> <span style="color: #000080;">=</span> uniform<span style="color: #000000;">(</span><span style="color: #0000dd;">10</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// Fill Y column with random numbers</span>
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">xinit</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">600</span>; <span style="color: #008000;">// First X value will be 600</span>
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">xinc</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span>; <span style="color: #008000;">// Subsequent X spacing of 10</span>
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">xunits</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> nm;
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">xname</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Wavelength;
plotxy iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">(</span>?,<span style="color: #0000dd;">2</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// Plot column 2 as Y using its internal X dataset as X</span>
</pre>

  <h3><a name="Set_Custom_Date_FormatCustom_Date_FormatDate_Format.2C_Customization"></a><span class="mw-headline">Set Custom Date Format<span class="OIndex" style="display:none">Custom Date Format</span><span class="OIndex" style="display:none">Date Format, Customization</span></span></h3>

  <p>This script sets the format of column 2 of the active worksheet to a custom date format.</p>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">// Surround non-date characters in specifier by single quotes:</span>
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">SetFormat</span><span style="color: #000000;">(</span><span style="color: #0000dd;">4</span>, <span style="color: #0000dd;">22</span>, yyyy<span style="color: #ff00ff;">'.'</span>MM<span style="color: #ff00ff;">'.'</span>dd<span style="color: #000000;">)</span>;
</pre>

  <p>Note that all non-date characters included in the custom string specifier must be surrounded by single quotes.</p>

  <p>Dates entered into this column will now be displayed in the specified custom format. Enter <code>07-29-09</code> into one or more cells and confirm the display to show <code>2009.07.29</code>.</p>

  <h3><a name="Setting_up_a_Worksheet_Filter"></a><span class="mw-headline">Setting up a Worksheet Filter</span></h3>

  <p>In the following example we have a column of temperatures where we wish only to show rows where the temperature is greater than 75. The last line of script allows the user to manually modify and reapply filter.</p>
  <pre class="lt" style="font-family:monospace;">
newbook;
col<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span> <span style="color: #000080;">=</span> data<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">31</span><span style="color: #000000;">)</span>;
col<span style="color: #000000;">(</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span><span style="color: #000080;">=</span>uniform<span style="color: #000000;">(</span><span style="color: #0000dd;">31</span><span style="color: #000000;">)</span><span style="color: #000080;">*</span><span style="color: #0000dd;">10</span><span style="color: #000080;">+</span><span style="color: #0000dd;">70</span>;
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">filter</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">filterx</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"temperature"</span>; <span style="color: #008000;">// variable name we will use</span>
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">filter</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"temperature &gt; 75"</span>; <span style="color: #008000;">// our filter condition</span>
wks.<span style="color: #000080;">runfilter</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">filter</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// open the associated filter dialog box to modify filter</span>
</pre>

  <h3><a name="Set_Column_as_Categorical"></a><span class="mw-headline">Set Column as Categorical</span></h3>

  <p>This script imports data, filters the data, sets a column of data as categorical then sorts the filtered categories in ascending order using <code>wks.col.categorical.sort</code>. Ordering becomes important when creating the stack plot. Sorting in ascending order then plotting the stack "top to bottom" preserves alphabetical ordering of categories, from top to bottom.</p>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">// import automobile.dat to a new book</span>
fn<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">"Samples\Statistics\automobile.dat"</span>;
newbook;
impASC fn<span style="color: #000080;">$</span>;
<span style="color: #008000;">// apply filter to column = Make to show only Buick Chrysler GMC Lincoln Saturn</span>
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">filter</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">filterx</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> make;
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">filter</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"make="</span>Buick<span style="color: #ff00ff;">" or make="</span>Chrysler<span style="color: #ff00ff;">" or make="</span>GMC<span style="color: #ff00ff;">" or make="</span>Lincoln<span style="color: #ff00ff;">" or make="</span>Saturn<span style="color: #ff00ff;">""</span>;
wks.<span style="color: #000080;">runfilter</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
<span style="color: #008000;">// set col(2) as categorical and sort in ascending order</span>
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">categorical</span>.<span style="color: #000080;">type</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>;
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">categorical</span>.<span style="color: #000080;">sort</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
<span style="color: #008000;">//refresh column filter</span>
wks.<span style="color: #000080;">runfilter</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
<span style="color: #008000;">// unstack worksheet to columns by make</span>
wunstackcol <span style="color: #000080;">-</span>r <span style="color: #0000dd;">2</span> irng1<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span><span style="color: #000080;">%</span>H<span style="color: #000000;">]</span>automobile<span style="color: #000080;">!</span>C<span style="color: #ff00ff;">"Power"</span> irng2<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span><span style="color: #000080;">%</span>H<span style="color: #000000;">]</span>automobile<span style="color: #000080;">!</span>B<span style="color: #ff00ff;">"Make"</span> nonstack<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> other<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span><span style="color: #000080;">%</span>H<span style="color: #000000;">]</span>automobile<span style="color: #000080;">!</span>A<span style="color: #ff00ff;">"Year"</span> extract<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;
<span style="color: #008000;">// create stack plot of col(1) vs. col(2) to end, type=scatter</span>
plotstack iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">:</span>end<span style="color: #000000;">)</span> plottype<span style="color: #000000;">:</span><span style="color: #000080;">=</span>scatter order<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> link<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> xlink<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
</pre>

  <h3><a name="Remove_Column_Filter"></a><span class="mw-headline">Remove Column Filter</span></h3>
  <pre class="lt" style="font-family:monospace;">
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">filter</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
wks.<span style="color: #000080;">runfilter</span><span style="color: #000000;">(</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span>; <span style="color: #008000;">//force update even there is no filter</span>
</pre>

  <h3><a name="Access_Python_Function_in_Set_.28Column.29_Values"></a><span class="mw-headline">Access Python Function in Set (Column) Values</span></h3>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">//define function in python field</span>
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">py</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>
<span style="color: #ff00ff;">"def add1(a):
    return [val+1 for val in a]
"</span>;

<span style="color: #008000;">//use the function above in column formula</span>
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">formula</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">"py.add1(A)"</span>;
</pre><br>
  <br>
