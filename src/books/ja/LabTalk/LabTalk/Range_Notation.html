<h1 class="firstheading">範囲表記</h1><p class='urlname' style='display: none'>Range-Notation</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Introduction_to_RangeRange_Notation"><span class="tocnumber">1</span> <span class="toctext">範囲入門<span class="OIndex" style="display:none">Range Notation</span></span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Declaration_and_SyntaxDeclare_Range"><span class="tocnumber">1.1</span> <span class="toctext">宣言と構文<span class="OIndex" style="display:none">Declare Range</span></span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Access_Origin_ObjectAccess_Origin_Object_by_RangeRange.2C_Origin_Object"><span class="tocnumber">1.2</span> <span class="toctext">Originオブジェクトへアクセス<span class="OIndex" style="display:none">Access Origin Object by Range</span><span class="OIndex" style="display:none">Range, Origin Object</span></span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4"><a href="#Types_of_Range_Data"><span class="tocnumber">2</span> <span class="toctext">範囲データの型</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="#Worksheet_DataRange.2C_Worksheet_Data"><span class="tocnumber">2.1</span> <span class="toctext">ワークシートデータ<span class="OIndex" style="display:none">Range, Worksheet Data</span></span></a>
<ul>
<li class="toclevel-3 tocsection-6"><a href="#ColumnRange.2C_Column"><span class="tocnumber">2.1.1</span> <span class="toctext">列<span class="OIndex" style="display:none">Range, Column</span></span></a></li>
<li class="toclevel-3 tocsection-7"><a href="#Page_and_SheetRange.2C_Page_and_Sheet"><span class="tocnumber">2.1.2</span> <span class="toctext">ページとシート<span class="OIndex" style="display:none">Range, Page and Sheet</span></span></a></li>
<li class="toclevel-3 tocsection-8"><a href="#Column_SubrangeRange.2C_Column_Subrange"><span class="tocnumber">2.1.3</span> <span class="toctext">列の部分範囲<span class="OIndex" style="display:none">Range, Column Subrange</span></span></a></li>
<li class="toclevel-3 tocsection-9"><a href="#Block_of_CellsRange.2C_Block_of_Cells"><span class="tocnumber">2.1.4</span> <span class="toctext">セルブロック<span class="OIndex" style="display:none">Range, Block of Cells</span></span></a></li>
<li class="toclevel-3 tocsection-10"><a href="#Option_Switch_-vOption_Switches"><span class="tocnumber">2.1.5</span> <span class="toctext">オプションスイッチ<b>-v</b><span class="OIndex" style="display:none">Option Switches</span></span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-11"><a href="#Matrix_DataRange.2C_Matrix_Data"><span class="tocnumber">2.2</span> <span class="toctext">行列データ<span class="OIndex" style="display:none">Range, Matrix Data</span></span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Graph_DataRange.2C_Graph_Data"><span class="tocnumber">2.3</span> <span class="toctext">グラフデータ<span class="OIndex" style="display:none">Range, Graph Data</span></span></a>
<ul>
<li class="toclevel-3 tocsection-13"><a href="#Option_Switches_-w.2C_-wx.2C_-wy_and_-wzOption_Switche"><span class="tocnumber">2.3.1</span> <span class="toctext">オプションスイッチ<b>-w</b>, <b>-wx</b>, <b>-wy</b>, <b>-wz</b><span class="OIndex" style="display:none">Option Switche</span></span></a></li>
<li class="toclevel-3 tocsection-14"><a href="#Data_Selector_Ranges_on_a_GraphSelect_Range_on_Graph"><span class="tocnumber">2.3.2</span> <span class="toctext">グラフ上のデータセレクタの範囲<span class="OIndex" style="display:none">Select Range on Graph</span></span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-15"><a href="#Specifying_Subrange_Using_X_Values"><span class="tocnumber">2.4</span> <span class="toctext">X値を使用した部分範囲指定</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#Loose_Dataset"><span class="tocnumber">2.5</span> <span class="toctext">非接続データセット</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-17"><a href="#Methods_of_Range"><span class="tocnumber">3</span> <span class="toctext">範囲メソッド</span></a></li>
<li class="toclevel-1 tocsection-18"><a href="#Unique_Uses_of_Range"><span class="tocnumber">4</span> <span class="toctext">範囲の特殊な使い方</span></a>
<ul>
<li class="toclevel-2 tocsection-19"><a href="#Manipulating_Range_DataManipulate_RangeRange_Data_Manipulation"><span class="tocnumber">4.1</span> <span class="toctext">範囲データの編集<span class="OIndex" style="display:none">Manipulate Range</span><span class="OIndex" style="display:none">Range Data Manipulation</span></span></a></li>
<li class="toclevel-2 tocsection-20"><a href="#Dynamic_Range_AssignmentDynamic_Range_Assignment"><span class="tocnumber">4.2</span> <span class="toctext">動的な範囲の割り当て<span class="OIndex" style="display:none">Dynamic Range Assignment</span></span></a>
<ul>
<li class="toclevel-3 tocsection-21"><a href="#Define_a_New_Range_Using_an_Expression_for_Column_IndexDefine_Range"><span class="tocnumber">4.2.1</span> <span class="toctext">列インデックスについての式を使用して新しい範囲を定義<span class="OIndex" style="display:none">Define Range</span></span></a></li>
<li class="toclevel-3 tocsection-22"><a href="#Define_a_New_Range_Using_an_Existing_Range"><span class="tocnumber">4.2.2</span> <span class="toctext">既存範囲を使って新しい範囲を定義</span></a></li>
<li class="toclevel-3 tocsection-23"><a href="#Refer_to_the_Last_Row.2C_Column_and_Sheet_Using_0"><span class="tocnumber">4.2.3</span> <span class="toctext">0を使用して最後の行/列/シートを参照</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-24"><a href="#X-Function_ArgumentX-Function_Argument.2C_RangeRange.2C_X-Function_Argument"><span class="tocnumber">4.3</span> <span class="toctext">Xファンクション引数<span class="OIndex" style="display:none">X-Function Argument, Range</span><span class="OIndex" style="display:none">Range, X-Function Argument</span></span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-25"><a href="#Listing.2C_Deleting.2C_and_Converting_Range_Variables"><span class="tocnumber">5</span> <span class="toctext">範囲変数の一覧、削除、変換</span></a>
<ul>
<li class="toclevel-2 tocsection-26"><a href="#Listing_Range_VariablesList_Range_Variable"><span class="tocnumber">5.1</span> <span class="toctext">範囲変数の一覧<span class="OIndex" style="display:none">List Range Variable</span></span></a></li>
<li class="toclevel-2 tocsection-27"><a href="#Deleting_Range_VariablesDelete_Range_Variable"><span class="tocnumber">5.2</span> <span class="toctext">範囲変数の削除<span class="OIndex" style="display:none">Delete Range Variable</span></span></a></li>
<li class="toclevel-2 tocsection-28"><a href="#Converting_Range_to_UIDRange_to_UIDUID.2C_Range"><span class="tocnumber">5.3</span> <span class="toctext">範囲をUIDに変換<span class="OIndex" style="display:none">Range to UID</span><span class="OIndex" style="display:none">UID, Range</span></span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-29"><a href="#Special_Notations_for_Range"><span class="tocnumber">6</span> <span class="toctext">特別な範囲表記</span></a>
<ul>
<li class="toclevel-2 tocsection-30"><a href="#Specifying_Multiple_Sheets"><span class="tocnumber">6.1</span> <span class="toctext">複数シートを指定</span></a></li>
<li class="toclevel-2 tocsection-31"><a href="#XY_and_XYZ_Range"><span class="tocnumber">6.2</span> <span class="toctext">XY、XYZ Range</span></a></li>
<li class="toclevel-2 tocsection-32"><a href="#XY_Range_using_.23_and_.3F_for_X"><span class="tocnumber">6.3</span> <span class="toctext">Xで # や&nbsp;? を使ったXY Range</span></a></li>
<li class="toclevel-2 tocsection-33"><a href="#Tag_Notations_in_Range_Output"><span class="tocnumber">6.4</span> <span class="toctext">範囲出力のタグ表記</span></a></li>
<li class="toclevel-2 tocsection-34"><a href="#Composite_Range"><span class="tocnumber">6.5</span> <span class="toctext">複合範囲</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="Introduction_to_RangeRange_Notation"></a><span class="mw-headline">範囲入門<span class="OIndex" style="display:none">Range Notation</span></span></h2>
<p>Originプロジェクト内ではワークシート、行列、グラフ、<a href="../../LabTalk/LabTalk/Data_Types_and_Variables.html#Dataset" title="LabTalk:データ型と変数">非接続データセット</a>の4つの主要な場所にデータが存在します。  これらのいずれの形式でも、範囲データ型を使用すると、標準的な方法で簡単にデータにアクセスできます。グラフに実際のデータが保存されているわけではありません。 
</p><p>Origin 8.0より前は、データは<a href="../../LabTalk/LabTalk/Datasets_(object).html" title="LabTalk:Datasets (オブジェクト)">dattasets</a>と<a href="../../LabTalk/LabTalk/Cell_(function).html" title="LabTalk:Cell(関数)">cell()</a>、<a href="../../LabTalk/LabTalk/Col_(function).html" title="LabTalk:Col (関数)">col()</a>、<a href="../../LabTalk/LabTalk/WCol_(function).html" title="LabTalk:WCol (関数)">wcol()</a>関数でアクセスしていました。ただし、この関数はアクティブウィンドウのアクティブシートのデータにアクセスするためにのみ使用できます。
</p><p>範囲データ型は、Originプロジェクト内のデータにアクセスする一貫した方法を提供するために、Origin 8.0以降に導入されました。アクティブなウィンドウと非アクティブなウィンドウの両方のデータにアクセスするために使用できます。 
</p><p>このチュートリアルでは、Originのさまざまな場所にあるデータの範囲変数の作成と使用について説明します。 
</p><p><b>Note&nbsp;:</b> <i>すべてのXファンクションが複数列や非隣接列などの複雑な範囲を扱える訳ではありません。論理や文書でサポートが得られない場合は、少し実験してみるとよいでしょう。</i>
</p>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Range_Notation/Alert_icon.png" width="57"  border="0" /></td><td><p><b>Orgin 2023</b>から、ページ名（ワークブック、行列、グラフなど）の範囲参照では、ページのロングネームはダブルクォートし、ページのショートネームはダブルクォートしないでください（これまではロングネームのダブルクォートが必須で、ショートネームのダブルクォートは可能でしたが、推奨されません）。ショートネームのダブルクォートの禁止は、置換による参照（例：<b>[%H]</b> が正しい、 <b>[&quot;%H&quot;]</b>にはしないでください）にも適用されます。この変更により、ページのロングネームの検索では、<i>アクティブなフォルダ</i>のウィンドウのロングネームを優先的に検索するようになります。この禁止事項により、フォルダの複製やプロジェクトの追加を行う際、より強固なページ参照が可能になります。ただし、以前の挙動にしたい場合は、システム変数<a href="../../LabTalk/LabTalk/System_Variable_List.html#R" title="LabTalk:システム変数リスト"><b>@RQS</b></a>を使ってこの変更をもとに戻すことができます。
</p>
	</td>
	</tr>
	</table>
<h3><a name="Declaration_and_SyntaxDeclare_Range"></a><span class="mw-headline">宣言と構文<span class="OIndex" style="display:none">Declare Range</span></span></h3>
<p>範囲変数は使用前に宣言する必要があります。しかし、次のような独自性もあります。
</p>
<dl><dd><ul><li> Originがどのデータを参照しているのかを認識できるように、宣言とともに初期化する必要があります。</li>
<li> 他のデータに代入したい場合は、再度宣言して初期化する必要があります。</li></ul></dd></dl>
<p>宣言と初期化のシンタックスは以下の通りです。
</p>
<dl><dd> <b>range [<i>-option</i>] <i>RangeName</i> = <i>RangeString</i></b></dd></dl>
<dl><dd><ul><li> 角括弧は、オプションであることを示します。</li>
<li> データの場所が異なると、使用できるオプションスイッチが異なります。詳細については、以下の<b>範囲データの種類</b>セクションを参照してください。  </li>
<li> 範囲名は、 <a href="../../LabTalk/LabTalk/Data_Types_and_Variables.html#Variable_Naming_Rules" title="LabTalk:データ型と変数">Originの変数名の規則</a>に従います。<a href="../../LabTalk/LabTalk/System_Variables.html#Numeric_System_Variables" title="LabTalk:システム変数">システム変数名</a>は使用しないでください。</li>
<li> <i><b>RangeString</b></i>は、範囲が指し示すオブジェクトの種類によって変化します。 ただし、<b>[Window]SheetorLayer!ColumnorPlot[subrange]</b>という一貫した表記があります。詳細は<a href="#Types_of_Range_Data">範囲データの種類</a>を参照してください。</li></ul></dd></dl>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Range_Notation/Alert_icon.png" width="57"  border="0" /></td><td><p>範囲キーワードは、範囲変数を定義するためにのみ使用されます。式の両側でデータアクセスを行う一般的な表記法としては使用できません。
</p>
	</td>
	</tr>
	</table>
<h3><a name="Access_Origin_ObjectAccess_Origin_Object_by_RangeRange.2C_Origin_Object"></a><span class="mw-headline">Originオブジェクトへアクセス<span class="OIndex" style="display:none">Access Origin Object by Range</span><span class="OIndex" style="display:none">Range, Origin Object</span></span></h3>
<p>範囲変数は、以下のタイプの<a href="../../LabTalk/Category/Origin_Objects.html" title="カテゴリ:Originオブジェクト">Originオブジェクト</a>に割り当てることができます。
</p>
<dl><dd><ul><li><a class="external text" href="../../LabTalk/Category/Wks.Col_(object).html">列</a></li>
<li><a href="../../LabTalk/LabTalk/Wks_(object).html" title="LabTalk:Wks (オブジェクト)">ワークシート</a> </li>
<li><a href="../../LabTalk/LabTalk/Page_(object).html" title="LabTalk:Page(オブジェクト)">ページ</a></li>
<li><a href="../../LabTalk/LabTalk/Layer_(object).html" title="LabTalk:Layer (オブジェクト)">グラフレイヤ</a></li>
<li><a href="../../LabTalk/LabTalk/Datasets_(object).html" title="LabTalk:Datasets (オブジェクト)">非接続データセット</a> </li></ul></dd></dl>
<p>割り当てられると、範囲変数には、指定されたオブジェクトのすべてのプロパティとメソッドが含まれます。<i><b>rangeVariable.=</b></i> および <i><b>rangeVariable.()</b></i> を使用して、アクセス可能なすべてのプロパティとメソッドを表示できます。
</p>
<pre class="lt" style="font-family:monospace;">range rA <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>Book1<span style="color: #000000;">]</span>Sheet1<span style="color: #000080;">!</span>Col<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span>; <span style="color: #008000;">//範囲変数 ra as  column A in Book1 Sheet1</span>
rA.<span style="color: #000080;">=</span>; <span style="color: #008000;">//全プロパティを表示</span>
rA.<span style="color: #000000;">(</span><span style="color: #000000;">)</span>; <span style="color: #008000;">//全メソッドを表示</span>
rA.<span style="color: #000080;">lname</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>; <span style="color: #008000;">//ロングネームを出力</span>
rA.<span style="color: #000080;">nRows</span><span style="color: #000080;">=</span>; <span style="color: #008000;">//行数を出力</span>
rA.<span style="color: #000080;">unit</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;MM/DD/YYYY&quot;</span>; <span style="color: #008000;">//set unit as &quot;MM/DD/YYYY&quot;</span>
ra.<span style="color: #000080;">setformat</span><span style="color: #000000;">(</span><span style="color: #0000dd;">4</span><span style="color: #000000;">)</span>;<span style="color: #008000;">//列を日付に設定</span></pre>
<p><br />
範囲は標準的なOriginオブジェクトのサブセットまたはいくつかの組み合わせで構成されます。  下記のような例があります。
</p>
<dl><dd><ul><li> <a href="../../LabTalk/LabTalk/Range_Notation.html#Column_SubrangeRange.2C_Column_Subrange" title="LabTalk:範囲表記">列の部分範囲</a></li>
<li> <a href="../../LabTalk/LabTalk/Range_Notation.html#Block_of_CellsRange.2C_Block_of_Cells" title="LabTalk:範囲表記">セルブロック</a></li>
<li> <a href="#XY_and_XYZ_Range">XY range</a></li>
<li> <a href="#XY_and_XYZ_Range">XYZ range</a></li>
<li> <a href="#Composite_Range">複合範囲</a></li></ul></dd></dl>
<h2><a name="Types_of_Range_Data"></a><span class="mw-headline">範囲データの型</span></h2>
<h3><a name="Worksheet_DataRange.2C_Worksheet_Data"></a><span class="mw-headline">ワークシートデータ<span class="OIndex" style="display:none">Range, Worksheet Data</span></span></h3>
<p>ワークシートデータに対して、<i><b><b>RangeString</b></b></i> は次の形式を取ります。 
</p><p><b>[<i>WorkBookName</i>]<i>SheetNameOrIndex</i>!<i>ColumnNameOrIndex</i>[<i>CellIndex</i>]</b>
</p>
<ul><li> アクティブブックまたはアクティブシートを参照する場合は<i><b>WorkBookName</b></i> および <i><b>SheetName</b></i> 部分はスキップできます。 </li>
<li> <i>ショートネーム</i>がデフォルトのプログラミング名であるため、上記の<i><b>WorkBookName</b></i> と<i><b>SheetName</b></i> は対応する<i>ショートネーム</i>を参照します。 </li>
<li> ワークブックやワークシートの範囲表記で<i>ロングネーム</i>を使用するには、[&quot;MyBook&quot;]&quot;MySheet&quot;]のように<i>ロングネーム</i>をダブルクォーテーションで囲む必要があります！</li>
<li> 逆に、<i>ショートネーム</i>をダブルクォーテーションで囲まないでください（これには<a href="../../LabTalk/LabTalk/String_registers.html#.25_String_Registers" title="LabTalk:文字列レジスタ"><b>[%H]</b></a>のような参照も含みます）。Origin 2023より前では、この方法は推奨されてはいませんでしたが、使えていた<i>可能性があり</i>ます。Origin2023以降、<i>ショートネーム</i>をダブルクォートすると失敗する可能性が高くなりました。以前の挙動（ショートネームをダブルクォートすることを許可する）に戻したい場合は、LabTalkシステム変数<a href="../../LabTalk/LabTalk/System_Variable_List.html#R" title="LabTalk:システム変数リスト"><b>@RQS</b></a>をご覧ください。</li>
<li> ショートネームのダブルクオートを禁止する変更に伴い、ページロングネームの検索では、ウィンドウ<b>ロングネーム</b>をアクティブフォルダから優先的に検索するようになりました。これは下記のようなことを可能にします。</li></ul>
<dl><dd><ul><li> フォルダを複製し、ワークブックで定義されたローカル変数に依存するようなフォルダ内の操作を保持します。</li>
<li> プロジェクトエクスプローラのフォルダをプロジェクトとして保存し、後でそのプロジェクトを別のプロジェクトに追加することができます。その際、ウィンドウのショートネームは名前の衝突を避けるために変更されますが、ウィンドウのロングネームに依存する操作には影響がありません。</li></ul></dd></dl>
<ul><li> <i><b>ColumnName</b></i> (引用符なし) には、列の<i>ロングネーム</i>または<i>ショートネーム</i>のいずれかを指定します。 (ロングネームにスペースがある場合は、二重引用符で囲む必要があります) </li>
<li> 2022bから、<a href="../../LabTalk/LabTalk/System_Variable_List.html#L" title="LabTalk:システム変数リスト"><b>@LNCS=1</b></a>で列ロングネームは大文字小文字を区別するようになりました。</li></ul>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//ロングネームを使用</span>
range rPage <span style="color: #000080;">=</span> <span style="color: #000000;">[</span><span style="color: #ff00ff;">&quot;My Book&quot;</span><span style="color: #000000;">]</span>; <span style="color: #008000;">//ページの範囲変数</span>
range rSheet <span style="color: #000080;">=</span> <span style="color: #000000;">[</span><span style="color: #ff00ff;">&quot;My Book&quot;</span><span style="color: #000000;">]</span><span style="color: #ff00ff;">&quot;My Sheet&quot;</span>; <span style="color: #008000;">//シートの範囲変数</span>
range rA <span style="color: #000080;">=</span> <span style="color: #000000;">[</span><span style="color: #ff00ff;">&quot;My Book&quot;</span><span style="color: #000000;">]</span><span style="color: #ff00ff;">&quot;My Sheet&quot;</span><span style="color: #000080;">!</span><span style="color: #ff00ff;">&quot;Amplitude&quot;</span>; <span style="color: #008000;">//列の範囲変数</span>

<span style="color: #008000;">//ショートネーム使用</span>
range rPage <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>Book1<span style="color: #000000;">]</span>; <span style="color: #008000;">//ページの範囲変数</span>
range rSheet <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>Book1<span style="color: #000000;">]</span>Sheet1; <span style="color: #008000;">//シートの範囲変数</span>
range rA <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>Book1<span style="color: #000000;">]</span>Sheet1<span style="color: #000080;">!</span>B; <span style="color: #008000;">//列の範囲変数</span>

<span style="color: #008000;">//シートおよび列部分でインデックスを使用</span>
range rSheet <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>Book1<span style="color: #000000;">]</span><span style="color: #0000dd;">1</span>; <span style="color: #008000;">//シートの範囲変数</span>
range rA <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>Book1<span style="color: #000000;">]</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #0000dd;">2</span>; <span style="color: #008000;">//列の範囲変数</span>

<span style="color: #008000;">//ロングネーム、ショートネーム、インデックス混合</span>
range rSheet <span style="color: #000080;">=</span> <span style="color: #000000;">[</span><span style="color: #ff00ff;">&quot;My Book&quot;</span><span style="color: #000000;">]</span><span style="color: #0000dd;">1</span>; <span style="color: #008000;">//ブックはロングネームシートはインデックス</span>
range rA <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>Book1<span style="color: #000000;">]</span><span style="color: #ff00ff;">&quot;My Sheet&quot;</span><span style="color: #000080;">!</span><span style="color: #0000dd;">2</span>; <span style="color: #008000;">//ブックはショートネーム、シートはロングネーム、列はインデックス</span>
range rB <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>Book1<span style="color: #000000;">]</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #ff00ff;">&quot;Temparature&quot;</span>; <span style="color: #008000;">//ブックはショートネーム、シートはインデックス、列はロングネーム</span>

<span style="color: #008000;">//そのほかのサンプル</span>
range rPage <span style="color: #000080;">=</span><span style="color: #000000;">[</span><span style="color: #000080;">%</span>H<span style="color: #000000;">]</span>; <span style="color: #008000;">//%H は現在のウィンドウ</span>
range rA<span style="color: #000080;">=</span><span style="color: #000080;">%</span>C; <span style="color: #008000;">//%C はシート内の現在の選択</span>
range rSheet <span style="color: #000080;">=</span> <span style="color: #000000;">[</span><span style="color: #000080;">%</span>H<span style="color: #000000;">]</span><span style="color: #0000dd;">1</span>; <span style="color: #008000;">//現在のウィンドウの第一シート</span>
range rA<span style="color: #000080;">=</span>rSheet<span style="color: #000080;">!</span>A; <span style="color: #008000;">//
rSheetに基づいてrA を構築</span></pre>
<p>任意の<i><b>RangeString</b></i>において、連続したシート、列、行の長さを指定するには、<b><i>index1</i>:<i>index2</i></b>のように、シート、列、行のインデックス（それぞれ）をコロンで区切って指定することができます。  キーワード<b>end</b>は、Originが指示されたオブジェクトをすべてピックアップすることを示すため、<i><b>index2</b></i>の代わりに使うことができます。  例えば、  
</p>
<pre class="lt" style="font-family:monospace;">range rs <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>Book1<span style="color: #000000;">]</span><span style="color: #0000dd;">4</span><span style="color: #000000;">:</span>end<span style="color: #000080;">!</span>           <span style="color: #008000;">// シート 4 から最後までを取得</span>
range rd <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>Book2<span style="color: #000000;">]</span>Sheet3<span style="color: #000080;">!</span><span style="color: #0000dd;">5</span><span style="color: #000000;">:</span><span style="color: #0000dd;">10</span>;     <span style="color: #008000;">// 列 5から10を取得</span></pre>
<p>行の場合、インデックスは角括弧で囲まなければならないので、ワークシート列の複数の行に対する完全な範囲指定文は次のようになります。
</p>
<pre class="lt" style="font-family:monospace;">range rc1 <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>Book1<span style="color: #000000;">]</span>Sheet2<span style="color: #000080;">!</span>Col<span style="color: #000000;">(</span><span style="color: #0000dd;">3</span><span style="color: #000000;">)</span><span style="color: #000000;">[</span><span style="color: #0000dd;">10</span><span style="color: #000000;">:</span>end<span style="color: #000000;">]</span>;   <span style="color: #008000;">// 10行目から最後の行まで取得。[10:0] でも可</span>
range rc2 <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>Book1<span style="color: #000000;">]</span>Sheet2<span style="color: #000080;">!</span>Col<span style="color: #000000;">(</span><span style="color: #0000dd;">3</span><span style="color: #000000;">)</span><span style="color: #000000;">[</span><span style="color: #0000dd;">10</span><span style="color: #000000;">:</span><span style="color: #0000dd;">20</span><span style="color: #000000;">]</span>;    <span style="color: #008000;">// 10から20行目まで取得</span></pre>
<p>セルの内容にアクセスする方法として、従来からある<a href="../../LabTalk/LabTalk/Cell_(function).html" title="LabTalk:Cell(関数)">Cell関数</a>もサポートされています。
</p><p><br />
</p>
<h4><a name="ColumnRange.2C_Column"></a><span class="mw-headline">列<span class="OIndex" style="display:none">Range, Column</span></span></h4>
<p><span class="OIndex">アクティブなワークシート</span>の列に対して範囲変数を宣言する場合、ブックとシートの部分をドロップすることができます。
識別可能な場合、列ショートネーム、インデックス、ロングネーム、またはcol()を列部分に使用できます。 
</p>
<pre class="lt" style="font-family:monospace;">range r1 <span style="color: #000080;">=</span> col<span style="color: #000000;">(</span><span style="color: #0000dd;">3</span><span style="color: #000000;">)</span>; <span style="color: #008000;">//アクティブシートの3列目</span>
range r2 <span style="color: #000080;">=</span> col<span style="color: #000000;">(</span>C<span style="color: #000000;">)</span>; <span style="color: #008000;">//アクティブシートのC列</span>
range r3 <span style="color: #000080;">=</span> col<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Sensor Y&quot;</span><span style="color: #000000;">)</span> <span style="color: #008000;">//アクティブシートのロングネーム&quot;Sensor Y&quot;の列</span>
range aa<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;        <span style="color: #008000;">// アクティブシートのcol(1)</span>
range bb<span style="color: #000080;">=</span>B;        <span style="color: #008000;">// アクティブワークシートのcol(B)</span>
range cc<span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Test A&quot;</span>; <span style="color: #008000;">// アクティブワークシートのロングネーム&quot;Test A」の列</span></pre>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Range_Notation/Tip_icon.png" width="57"  border="0" /></td><td><p>aa = 1! などの式で、アクティブブックの最初のシートを参照します。aa = &quot;1!&quot;では、ロングネームが1!の現在のシートの列を参照します。範囲宣言の引用符の保持または破棄を制御するには、システム変数<a href="../../LabTalk/LabTalk/System_Variable_List.html#R" title="LabTalk:システム変数リスト"><b>@RPQ</b></a>を参照してください。
</p></td></tr></table>
<p>複数の範囲変数をカンマで区切って同じ行に宣言することができます。  上記の例は、次のように書くこともできます。
</p>
<pre class="lt" style="font-family:monospace;">range aa <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>, bb <span style="color: #000080;">=</span> B, cc <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Test A&quot;</span>;</pre>
<p>または、指定した同じシート内で複数の範囲変数を宣言する場合は、ブックとシートの部分を先頭に置くことができます。
</p>
<pre class="lt" style="font-family:monospace;">range <span style="color: #000000;">[</span><span style="color: #ff00ff;">&quot;MyBook&quot;</span><span style="color: #000000;">]</span>Sheet3 aa<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>, bb<span style="color: #000080;">=</span>B, cc<span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Test A&quot;</span>; <span style="color: #008000;">// ロングネームが&quot;MyBook&quot;というブックのSheet3の列</span></pre>
<p>Originは列のロングネームを一意にすることを強制しないので（つまり、ワークシート内の複数の列が同じロングネームを持つことができる）、より正確にするためにショートネームとロングネームを一緒に指定することができます。
</p>
<pre class="lt" style="font-family:monospace;">range dd <span style="color: #000080;">=</span> D<span style="color: #ff00ff;">&quot;Test 4&quot;</span>;  <span style="color: #008000;">// Col(D)（ロングネームTest 4)を範囲に割り当て</span></pre>
<p>列の範囲が決まったら、それを使って列のプロパティにアクセスし、変更します。
</p>
<pre class="lt" style="font-family:monospace;">range rColumn <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>Book1<span style="color: #000000;">]</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #0000dd;">2</span>;       <span style="color: #008000;">// 範囲は列です</span>
rColumn.<span style="color: #000080;">digitMode</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;            <span style="color: #008000;">// 表示する小数点以下の桁数を設定する</span>
rColumn.<span style="color: #000080;">digits</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;               <span style="color: #008000;">// 小数点桁数を2桁に</span></pre>
<p>あるいは計算を行います。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// アクティブワークブックのsheet1, 2, 3の列1をポイント
workbook:</span>
range aa <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span><span style="color: #000080;">!</span>col<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>;
range bb <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span><span style="color: #000080;">!</span>col<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>;
range cc <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span><span style="color: #000080;">!</span>col<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>;
cc <span style="color: #000080;">=</span> aa<span style="color: #000080;">+</span>bb;</pre>
<p>存在しない列を範囲変数に割り当てる場合、その列に値が割り当てられるまで表示されません。
存在しないシートまたはブックの列にも同じルールが適用されます。
</p>
<pre class="lt" style="font-family:monospace;">newbook; <span style="color: #008000;">//デフォルトの二列のみの新規ブック</span>
range aa<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>, bb<span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>, cc<span style="color: #000080;">=</span><span style="color: #0000dd;">3</span>; <span style="color: #008000;">//3つの範囲変数を3列に割り当て。3番目の列は存在しない</span>
aa<span style="color: #000080;">=</span>data<span style="color: #000000;">{</span><span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">10</span>, <span style="color: #0000dd;">0.5</span><span style="color: #000000;">}</span>; <span style="color: #008000;">//aaに値を割り当て</span>
bb<span style="color: #000080;">=</span>sin<span style="color: #000000;">(</span>aa<span style="color: #000000;">)</span>; <span style="color: #008000;">//bbに値を割り当て</span>
cc<span style="color: #000080;">=</span>cos<span style="color: #000000;">(</span>bb<span style="color: #000000;">)</span>; <span style="color: #008000;">//ccに値を割り当て。3列目が表示</span></pre>
<p>範囲指定でカラムラベル行にアクセスしたい場合は、<a href="../../LabTalk/Script/Accessing_Metadata.html" title="スクリプト：メタデータにアクセスする">メタデータへのアクセス</a>と<a href="../../LabTalk/LabTalk/Column_Label_Row_Characters.html" title="LabTalk:列ラベル行の文字">列ラベル行の参照表</a>をご覧ください。
</p>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Range_Notation/Alert_icon.png" width="57"  border="0" /></td><td><p>異なるシートのデータに対して演算を行う場合、範囲変数を使用する必要があります。  範囲文字列の直接参照はまだサポートされていません。  例えば、スクリプト <b>Sheet3!col(1) = Sheet1!col(1) + Sheet2!col(1);</b> は動作しません。どうしても範囲変数を宣言せずに一行で書きたい場合は、<a href="../../LabTalk/LabTalk/String_Substitution.html#Calculation_Involving_Datasets_from_Another_Sheet" title="LabTalk:文字列置換"><span class="OIndex">データセット置換表記</span></a>を使用します。 
</p>
	</td>
	</tr>
	</table>
<h4><a name="Page_and_SheetRange.2C_Page_and_Sheet"></a><span class="mw-headline">ページとシート<span class="OIndex" style="display:none">Range, Page and Sheet</span></span></h4>
<p>データの1列だけでなく、ページおよびシートオブジェクトにアクセスするために、範囲を使用することができます。
</p><p>ワークブック全体にアクセスするには、範囲変数を使用します。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// &apos;rPage&apos;は&apos;Book1&apos;という名前のワークブックを指定</span>
range rPage <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>Book1<span style="color: #000000;">]</span>; 
<span style="color: #008000;">// &apos;Book1&apos;のロングネームを&quot;My Analysis Worksheets&quot;に設定                   </span>
rPage.<span style="color: #000080;">LongName</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> My Analysis Worksheets; 
rPage.<span style="color: #000080;">nlayers</span><span style="color: #000080;">=</span>; <span style="color: #008000;">//シート数を出力</span>
rPage.<span style="color: #000080;">active</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span>; <span style="color: #008000;">//三番目のシートをアクティブシートに設定</span></pre>
<p>ワークブックにアクセスするには、範囲変数を使用します。 
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// &apos;rSheet&apos;はロングネームMyBookのブックにある、MySheetというロングネームのシートを指定</span>
range rSheet <span style="color: #000080;">=</span> <span style="color: #000000;">[</span><span style="color: #ff00ff;">&quot;MyBook&quot;</span><span style="color: #000000;">]</span><span style="color: #ff00ff;">&quot;MySheet&quot;</span><span style="color: #000080;">!</span>;
rSheet.<span style="color: #000080;">name</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Statistics&quot;</span>;        <span style="color: #008000;">// シート名を &quot;Statistics&quot;に変更</span>
page.<span style="color: #000080;">xlcolname</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;               <span style="color: #008000;">//スプレッドシートセル表記をオフ</span>
rSheet.<span style="color: #000080;">AddCol</span><span style="color: #000000;">(</span>StdDev<span style="color: #000000;">)</span>;              <span style="color: #008000;">// 列名StdDevの列を追加</span></pre>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Range_Notation/Tip_icon.png" width="57"  border="0" /></td><td><p>ワークブックの<a class="external text" href="../../UserGuide/UserGuide/Column_Short_Name_Restriction.html">スプレッドシートセル表記</a>については、<a class="external text" href="../../QuickHelp/QuickHelp/Turn_off_spreadsheet_cell_notation.html"><b>FAQ-849</b></a> を参照してください。
</p></td></tr></table>
<h4><a name="Column_SubrangeRange.2C_Column_Subrange"></a><span class="mw-headline">列の部分範囲<span class="OIndex" style="display:none">Range, Column Subrange</span></span></h4>
<p>列の<span class="OIndex">部分範囲</span>を指定するには、次のような範囲変数を使用します。 
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//MyBook(ロングネーム)、sheet2のcol(a)の部分範囲</span>
range cc <span style="color: #000080;">=</span> <span style="color: #000000;">[</span><span style="color: #ff00ff;">&quot;MyBook&quot;</span><span style="color: #000000;">]</span>sheet2<span style="color: #000080;">!</span>col<span style="color: #000000;">(</span>a<span style="color: #000000;">)</span><span style="color: #000000;">[</span><span style="color: #0000dd;">3</span><span style="color: #000000;">:</span><span style="color: #0000dd;">10</span><span style="color: #000000;">]</span>;</pre>
<p>また、目的のワークブックとワークシートがアクティブな場合は、短縮表記を使用することができます。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// book1のsheet2のcol(a)の部分範囲</span>
range cc <span style="color: #000080;">=</span> col<span style="color: #000000;">(</span>a<span style="color: #000000;">)</span><span style="color: #000000;">[</span><span style="color: #0000dd;">3</span><span style="color: #000000;">:</span><span style="color: #0000dd;">10</span><span style="color: #000000;">]</span>;</pre>
<p>他の範囲の部分範囲を作成
</p>
<pre class="lt" style="font-family:monospace;">range ra<span style="color: #000080;">=</span><span style="color: #000000;">[</span>book1<span style="color: #000000;">]</span>Sheet1<span style="color: #000080;">!</span>A;
range subra<span style="color: #000080;">=</span>ra<span style="color: #000000;">[</span><span style="color: #0000dd;">10</span><span style="color: #000000;">:</span><span style="color: #0000dd;">20</span><span style="color: #000000;">]</span>;</pre>
<p>列の一部に対して計算やその他の操作を行うことができます。例えば、
</p>
<pre class="lt" style="font-family:monospace;">range r1<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span><span style="color: #000000;">[</span><span style="color: #0000dd;">5</span><span style="color: #000000;">:</span><span style="color: #0000dd;">10</span><span style="color: #000000;">]</span>;
range r2<span style="color: #000080;">=</span><span style="color: #0000dd;">2</span><span style="color: #000000;">[</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">6</span><span style="color: #000000;">]</span>;
r1 <span style="color: #000080;">=</span> r2; <span style="color: #008000;">//2列目の1行目から6行目までの値を1列目の5行目から10行目にコピーする。</span>
r1<span style="color: #000000;">[</span><span style="color: #0000dd;">1</span><span style="color: #000000;">]</span><span style="color: #000080;">=</span>; 
<span style="color: #008000;">// この場合、1列目の5行目に値が出力され、2列目の1行目と等しくなるはずです。</span></pre>
<h4><a name="Block_of_CellsRange.2C_Block_of_Cells"></a><span class="mw-headline">セルブロック<span class="OIndex" style="display:none">Range, Block of Cells</span></span></h4>
<p>次のように、範囲を使用して、1つのセルまたは<span class="OIndex">セルブロック</span>（多くの行と列にまたがる場合があります）にアクセスします。
</p>
<pre class="lt" style="font-family:monospace;">range aa <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">[</span><span style="color: #0000dd;">2</span><span style="color: #000000;">]</span>;  <span style="color: #008000;">// (列1, 行2), 1つのセル</span>
range bb <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">[</span><span style="color: #0000dd;">1</span><span style="color: #000000;">]</span><span style="color: #000000;">:</span><span style="color: #0000dd;">3</span><span style="color: #000000;">[</span><span style="color: #0000dd;">10</span><span style="color: #000000;">]</span>;  <span style="color: #008000;">// (列1, 行1) から (列3, 行10)</span></pre>
<p><b>Note</b>：セルブロックを表す範囲変数は、<a href="#X-Function_ArgumentX-Function_Argument.2C_RangeRange.2C_X-Function_Argument">Xファンクションの引数</a>としてのみ使用でき、直接計算はサポートされていません。
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Range_Notation/Tip_icon.png" width="57"  border="0" /></td><td><p>Originの<a href="../../LabTalk/LabTalk/Join_(function).html" title="LabTalk:Join (関数)"><b>join()</b>関数</a>で、複数の非連続範囲を1つのデータセットに結合できます。
</p></td></tr></table>
<h4><a name="Option_Switch_-vOption_Switches"></a><span class="mw-headline">オプションスイッチ<b>-v</b><span class="OIndex" style="display:none">Option Switches</span></span></h4>
<p><font color="red">必要なOriginのバージョン: 9.1 SR0以降</font>
</p><p>ワークシートデータの場合、<b>-v</b>スイッチで1つのブロックを範囲として定義し、その値を一時ベクトルに格納することで、同じサイズでブロック形状が異なるブロック間でのデータ割り当てが可能になります（例えば、行から列への値の割り当てが可能です）。
</p><p>次の例では、ワークシートの特定の列の行にあるすべてのエントリをスケーリングします。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 最後の列を除くすべての列の最初の要素を係数でスケーリング</span>
range <span style="color: #000080;">-</span>v r<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span><span style="color: #000000;">[</span><span style="color: #0000dd;">1</span><span style="color: #000000;">]</span><span style="color: #000000;">:</span><span style="color: #000080;">$</span><span style="color: #000000;">(</span>wks.<span style="color: #000080;">ncols</span><span style="color: #000080;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span><span style="color: #000000;">[</span><span style="color: #0000dd;">1</span><span style="color: #000000;">]</span>;
r<span style="color: #000080;">*</span><span style="color: #000080;">=</span><span style="color: #0000dd;">10</span>;
<span style="color: #008000;">// すべての列の最初の要素をスケーリング</span>
range <span style="color: #000080;">-</span>v r<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span><span style="color: #000000;">[</span><span style="color: #0000dd;">1</span><span style="color: #000000;">]</span><span style="color: #000000;">:</span>end<span style="color: #000000;">[</span><span style="color: #0000dd;">1</span><span style="color: #000000;">]</span>;
r<span style="color: #000080;">*</span><span style="color: #000080;">=</span><span style="color: #0000dd;">10</span>;</pre>
<p>以下のサンプルで、このオプションスイッチの使用方法をご紹介します。 
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//新しいブックにサンプルデータをインポート</span>
fname<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;\Samples\Statistics\automobile.dat&quot;</span>; 
newbook;
impasc;
<span style="color: #008000;">//列BCの全ての行をブロックとして定義</span>
range <span style="color: #000080;">-</span>v r1 <span style="color: #000080;">=</span> B<span style="color: #000000;">[</span><span style="color: #0000dd;">1</span><span style="color: #000000;">]</span><span style="color: #000000;">:</span>C<span style="color: #000000;">[</span>end<span style="color: #000000;">]</span>;
<span style="color: #008000;">//新しいシートを作成</span>
newsheet;
<span style="color: #008000;">//列ABの大きさでブロックを定義</span>
range <span style="color: #000080;">-</span>v r2 <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">[</span><span style="color: #0000dd;">1</span><span style="color: #000000;">]</span><span style="color: #000000;">:</span><span style="color: #0000dd;">2</span><span style="color: #000000;">[</span>r1.<span style="color: #000080;">GetSize</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000080;">/</span><span style="color: #0000dd;">2</span><span style="color: #000000;">]</span>; <span style="color: #008000;">// ブロックのサイズは2列×行数</span>
<span style="color: #008000;">//1つ目のブロックの値を2つ目のブロックに割り当て</span>
r2 <span style="color: #000080;">=</span> r1;</pre>
<p>ベクターはデータを列方向に格納し、「形」に関係なく宛先ブロックを埋めます。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 新しいブックにサンプルデータをインポート</span>
fname<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;\Samples\Statistics\abrasion_raw.dat&quot;</span>; 
newbook;
impasc;
<span style="color: #008000;">// 列ＡＢの全ての行をブロックとして定義</span>
range <span style="color: #000080;">-</span>v ra1 <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">[</span><span style="color: #0000dd;">1</span><span style="color: #000000;">]</span><span style="color: #000000;">:</span><span style="color: #0000dd;">2</span><span style="color: #000000;">[</span>end<span style="color: #000000;">]</span>;
<span style="color: #008000;">//新しいシートを作成</span>
newsheet;
<span style="color: #008000;">// ra1のブロックの大きさを使って1列のブロックを定義</span>
range <span style="color: #000080;">-</span>v ra2 <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">[</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span>ra1.<span style="color: #000080;">GetSize</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">]</span>;
<span style="color: #008000;">//1つ目のブロックの値を2つ目のブロックに割り当て</span>
ra2 <span style="color: #000080;">=</span> ra1;
col<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span><span style="color: #000000;">[</span>L<span style="color: #000000;">]</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Combined;</pre>
<p><b>Note:</b>目的のブロックで定義される列は割り振られる前に存在する必要があります。
</p>
<h3><a name="Matrix_DataRange.2C_Matrix_Data"></a><span class="mw-headline">行列データ<span class="OIndex" style="display:none">Range, Matrix Data</span></span></h3>
<p>行列データでは<i><b>RangeString</b></i>は下記のようになります。
</p><p><b>[<i>MatrixBookName</i>]<i>MatrixSheetNameOrIndex</i>!<i>MatrixObject</i></b>
</p>
<table class="note">
<tr>
<td><b>Note:</b> <i>ショートネーム</i>がデフォルトのプログラミング名であるため、上記の<i>WorkBookName</i> と<i>SheetName</i> は対応する<i>ショートネーム</i>を使用しました。行列ブックと行列シートで範囲変数に<i>ロングネーム</i>を使用するには、[&quot;MyMatrixBook&quot;]&quot;MyMatrixSheet&quot;!のように、<i>ロングネーム</i> を二重引用符で囲みます。
</td></tr></table>
<p>変数の代入は、以下の構文で行うことができます。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// MBook1, MSheet1の2番目のオブジェクト</span>
range mm <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>MBook1<span style="color: #000000;">]</span>MSheet1<span style="color: #000080;">!</span><span style="color: #0000dd;">2</span>;
<span style="color: #008000;">// 行列ブックMatBook1（ロングネーム）の行列シートMatSheet1（ロングネーム）の</span>
<span style="color: #008000;">// ロングネームMatObject1の行列オブジェクト</span>
range mo <span style="color: #000080;">=</span> <span style="color: #000000;">[</span><span style="color: #ff00ff;">&quot;MatBook1&quot;</span><span style="color: #000000;">]</span><span style="color: #ff00ff;">&quot;MatSheet1&quot;</span><span style="color: #000080;">!</span>Mat<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;MatObject1&quot;</span><span style="color: #000000;">)</span>;</pre>
<p><b><i>RangeName</i>[<i>row</i>, <i>col</i>]</b>の表記を使って行列範囲のセルの内容にアクセスします。  例えば、
</p>
<pre class="lt" style="font-family:monospace;">range mm<span style="color: #000080;">=</span><span style="color: #000000;">[</span>MBook1<span style="color: #000000;">]</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #0000dd;">1</span>;    
mm<span style="color: #000000;">[</span><span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">3</span><span style="color: #000000;">]</span><span style="color: #000080;">=</span><span style="color: #0000dd;">10</span>;</pre>
<p>行列が複素数を含む場合，複素数を表す文字列は以下のようにアクセスすることができます。
</p>
<pre class="lt" style="font-family:monospace;">string str<span style="color: #000080;">$</span>;
str<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> mm<span style="color: #000000;">[</span><span style="color: #0000dd;">3</span>,<span style="color: #0000dd;">4</span><span style="color: #000000;">]</span><span style="color: #000080;">$</span>;</pre>
<h3><a name="Graph_DataRange.2C_Graph_Data"></a><span class="mw-headline">グラフデータ<span class="OIndex" style="display:none">Range, Graph Data</span></span></h3>
<p>グラフデータでは<i><b>RangeString</b></i>は下記のようになります。
</p><p><b>[<i>GraphWindowName</i>]<i>LayerNameOrIndex</i>!<i>DataPlot</i></b>
</p><p>割り当ての例はこのようになります。
</p>
<pre class="lt" style="font-family:monospace;">range ll <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>Graph1<span style="color: #000000;">]</span>Layer1<span style="color: #000080;">!</span><span style="color: #0000dd;">2</span>;       <span style="color: #008000;">// Graph1、Layer1の2番目の曲線</span>
range mm <span style="color: #000080;">=</span> <span style="color: #000080;">%</span>C; <span style="color: #008000;">//現在のアクティブプロットまたは選択したプロットを取得</span></pre>
<h4><a name="Option_Switches_-w.2C_-wx.2C_-wy_and_-wzOption_Switche"></a><span class="mw-headline">オプションスイッチ<b>-w</b>, <b>-wx</b>, <b>-wy</b>, <b>-wz</b><span class="OIndex" style="display:none">Option Switche</span></span></h4>
<p>グラフウィンドウでは、range -w<span class="OIndex" style="display:none">Range, Get plot Y</span> とrange -wx<span class="OIndex" style="display:none">Range, Get plot X</span>, range -wy<span class="OIndex" style="display:none">Range, Get plot Y</span>, range -wz<span class="OIndex" style="display:none">Range, Get plot Z</span>オプションを使って、プロットデータセットのワークシート列範囲を取得することができます。
</p><p>range -w は、常に、最も依存性の高い変数のワークシート範囲を取得します - これは、2DプロットのY値、3DプロットのZ値または行列オブジェクトです。Origin9.0 Sr0からrange -wで複数範囲がサポートされるようになっています。
</p><p>range -wx, range -wy, range -wz は、それぞれ対応する X, Y, Z 値のワークシート範囲を取得します。
</p><p>range -wx, range -wz <span style="color:red">必要なOriginのバージョン: 9.0 SR0</span>
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// グラフウィンドウをアクティブウィンドウにする</span>
<span style="color: #008000;">// 最初のデータプロットのY値のワークシート範囲を取得</span>
range <span style="color: #000080;">-</span>w rW <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
type <span style="color: #000080;">%</span><span style="color: #000000;">(</span>rw<span style="color: #000000;">)</span>; <span style="color: #008000;">//範囲文字列を出力</span>

<span style="color: #008000;">// 対応するX値のワークシート範囲を取得</span>
range <span style="color: #000080;">-</span>wx rWx <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;

<span style="color: #008000;">//対応するY値のワークシート範囲を取得</span>
range <span style="color: #000080;">-</span>wy rWy <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;

<span style="color: #008000;">//対応するZ値のワークシート範囲を取得</span>
range <span style="color: #000080;">-</span>wz rWz <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;

<span style="color: #008000;">// 最初のデータプロットのグラフ範囲を取得   </span>
range rG <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;      

<span style="color: #008000;">// 現在の選択内容を取得 (%C)</span>
range <span style="color: #000080;">-</span>w rC <span style="color: #000080;">=</span> <span style="color: #000080;">%</span>C;</pre>
<p>上記のスクリプトで、<b>rW = [Book1]Sheet1!B</b> ですが、<b>rG = [Graph1]1!1</b>であることに注意して下さい。
</p>
<h4><a name="Data_Selector_Ranges_on_a_GraphSelect_Range_on_Graph"></a><span class="mw-headline">グラフ上のデータセレクタの範囲<span class="OIndex" style="display:none">Select Range on Graph</span></span></h4>
<p>データセレクタツールを使用すると、グラフ上の1つまたは複数の範囲を選択し、LabTalkから参照することができます。選択された1つの範囲に対して、MKS1、MKS2システム変数を使用することができます。v8.0 SR6以降では、新しいXファンクション <b>get_plot_sel</b> が追加され、解析するために選択範囲を文字列に取得できます。  次の例は、現在のグラフの各範囲を選択する方法を示しています。
</p>
<pre class="lt" style="font-family:monospace;">string strRange;
get_plot_sel str<span style="color: #000000;">:</span><span style="color: #000080;">=</span>strRange;
StringArray sa;
sa.<span style="color: #000080;">Append</span><span style="color: #000000;">(</span>strRange<span style="color: #000080;">$</span>,<span style="color: #ff00ff;">&quot;|&quot;</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// トークン化</span>
int nNumRanges <span style="color: #000080;">=</span> sa.<span style="color: #000080;">GetSize</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
if<span style="color: #000000;">(</span>nNumRanges <span style="color: #000080;">==</span> <span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
	type <span style="color: #ff00ff;">&quot;there is nothing selected&quot;</span>;
	return;
<span style="color: #000000;">}</span>
type <span style="color: #ff00ff;">&quot;Total of $(nNumRanges) ranges selected for&nbsp;%C&quot;</span>;
for<span style="color: #000000;">(</span>int ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; ii <span style="color: #000080;">&lt;=</span> nNumRanges; ii<span style="color: #000080;">++</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
	range <span style="color: #000080;">-</span>w xy <span style="color: #000080;">=</span> sa.<span style="color: #000080;">GetAt</span><span style="color: #000000;">(</span>ii<span style="color: #000000;">)</span><span style="color: #000080;">$</span>;
	string strWks<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Temp$(ii)&quot;</span>;
	create <span style="color: #000080;">%</span><span style="color: #000000;">(</span>strWks<span style="color: #000080;">$</span><span style="color: #000000;">)</span> <span style="color: #000080;">-</span>wdn <span style="color: #0000dd;">10</span> aa bb;
	range fitxy <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>??<span style="color: #000000;">]</span><span style="color: #000080;">!</span><span style="color: #000000;">(</span><span style="color: #000080;">%</span><span style="color: #000000;">(</span>strWks<span style="color: #000080;">$</span><span style="color: #000000;">)</span>_aa, <span style="color: #000080;">%</span><span style="color: #000000;">(</span>strWks<span style="color: #000080;">$</span><span style="color: #000000;">)</span>_bb<span style="color: #000000;">)</span>;
	fitlr iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span>xy oy<span style="color: #000000;">:</span><span style="color: #000080;">=</span>fitxy;
	plotxy fitxy p<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">200</span> o<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>active<span style="color: #000080;">&gt;</span> c<span style="color: #000000;">:</span><span style="color: #000080;">=</span>color<span style="color: #000000;">(</span>red<span style="color: #000000;">)</span> rescale<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> legend<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;
	type <span style="color: #ff00ff;">&quot;%(xy) fit linear gives slope=$(fitlr.b)&quot;</span>;
<span style="color: #000000;">}</span>
<span style="color: #008000;">//  完了したら、すべてのデータマーカーをクリアする</span>
mark <span style="color: #000080;">-</span>r;</pre>
<p><a href="../../LabTalk/LabTalk/Create_(command).html" title="LabTalk:Create (コマンド)">Create (コマンド)</a> (非接続データセットを作成する)、<a href="#Loose_Dataset">[??] 範囲表記</a> (非接続データセットから範囲を作成する)、<a class="external text" href="../../XFunction/X-Function/FitLR.html"><b>fitlr</b>X-Function</a> 、<a href="../../LabTalk/LabTalk/StringArray_(object).html#Append" title="LabTalk:StringArray (オブジェクト)">StringArray (オブジェクト)</a> (特に、<b>Append</b>メソッドはOrigin 8.0 SR6で導入)の追加ドキュメントが利用できます。
</p>
<h3><a name="Specifying_Subrange_Using_X_Values"></a><span class="mw-headline">X値を使用した部分範囲指定</span></h3>
<p>XY範囲で作業する場合、X値を使用して部分範囲を指定できます。この構文は次のようになります。
</p>
<ol><li> ワークシートから
<dl><dd><b>[<i>WorkBookName</i>]<i>SheetNameOrIndex</i>!<i>YColumnNameOrIndex</i>[x<i>X1:X2</i>]</b></dd></dl></li></ol>
<p>サンプル:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// XとYに列1と2を使用してX=0.15～0.2の部分範囲を指定</span>
range rxy <span style="color: #000080;">=</span> <span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">2</span><span style="color: #000000;">)</span><span style="color: #000000;">[</span>x0.15<span style="color: #000000;">:</span><span style="color: #0000dd;">0.2</span><span style="color: #000000;">]</span>;</pre>
<ol><li> グラフから
<dl><dd><b>[<i>GraphWindowName</i>]<i>LayerNameOrIndex</i>!<i>DataPlot</i>[x<i>X1:X2</i>]</b></dd></dl></li></ol>
<p>サンプル:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Graph1, Layer1の2番目の曲線のXY部分範囲</span>
range rxy2 <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>Graph1<span style="color: #000000;">]</span>Layer1<span style="color: #000080;">!</span><span style="color: #0000dd;">2</span><span style="color: #000000;">[</span>x5<span style="color: #000000;">:</span><span style="color: #0000dd;">20</span><span style="color: #000000;">]</span>;</pre>
<p>次の例では、<a class="external text" href="../../XFunction/X-Function/Plotxy.html">Xファンクション plotxy</a>を使用してグラフをプロットし、<a class="external text" href="../../XFunction/X-Function/Smooth.html">Xファンクション smooth</a>を使用してデータの部分範囲をスムージングします。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 新規ブックにデータをインポート</span>
newbook;
fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;\Samples\Signal Processing\EMG Recording.dat&quot;</span>;
impasc;

<span style="color: #008000;">// XY部分範囲X=5～5.5および9.3～9.8を定義</span>
range rxy1 <span style="color: #000080;">=</span> <span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">2</span><span style="color: #000000;">)</span><span style="color: #000000;">[</span>x5<span style="color: #000000;">:</span><span style="color: #0000dd;">5.5</span><span style="color: #000000;">]</span>;
range rxy2 <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span><span style="color: #000000;">[</span>x9.3<span style="color: #000000;">:</span><span style="color: #0000dd;">9.8</span><span style="color: #000000;">]</span>;
plotxy rxy1 plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">200</span>;  <span style="color: #008000;">// 1番目のXY部分範囲の線図</span>
smooth <span style="color: #000080;">-</span>r <span style="color: #0000dd;">2</span> rxy2 method<span style="color: #000000;">:</span><span style="color: #000080;">=</span>le;  <span style="color: #008000;">// 2番目のXY部分範囲をLoessでスムージング</span></pre>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Range_Notation/Tip_icon.png" width="57"  border="0" /></td><td><p>X値に基づいて部分範囲を指定する場合、Xデータは単調である必要があります。
</p></td></tr></table>
<h3><a name="Loose_Dataset"></a><span class="mw-headline">非接続データセット</span></h3>
<p><span class="OIndex">非接続データセット</span>は、ワークシートの列に似ていますが、ブック・シート・列構成のようなオーバーヘッドを持ちません。これは、通常、 <a href="../../LabTalk/LabTalk/Create_(command).html" title="LabTalk:Create (コマンド)">create コマンド</a> で作成されるか、<a href="../../LabTalk/LabTalk/Datasets_(object).html" title="LabTalk:Datasets (オブジェクト)">Dataset 宣言</a>せずに代入文で自動的に作成されます。
</p><p>非接続データセットの<i><b>RangeString</b></i>はこのようになります。 
</p><p><b>[??]!<i>LooseDatasetName</i></b>
</p><p>割り当ては、構文を使って行うことができます。
</p>
<pre class="lt" style="font-family:monospace;">range xx <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>??<span style="color: #000000;">]</span><span style="color: #000080;">!</span>tmpdata_a;       <span style="color: #008000;">// 非接続データセット &apos;tmpdata_a&apos;</span></pre>
<p>この動作を示すために、<a class="external text" href="../../XFunction/X-Function/Plotxy.html"><b>plotxy</b>Xファンクション</a> を使って、緩やかなデータセットのグラフを描いてみます。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 2つの非接続データセットを作成</span>
create tmpdata <span style="color: #000080;">-</span>wd <span style="color: #0000dd;">50</span> a b;
tmpdata_a<span style="color: #000080;">=</span>data<span style="color: #000000;">(</span><span style="color: #0000dd;">50</span>,<span style="color: #0000dd;">1</span>,<span style="color: #000080;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>;
tmpdata_b<span style="color: #000080;">=</span>normal<span style="color: #000000;">(</span><span style="color: #0000dd;">50</span><span style="color: #000000;">)</span>;
<span style="color: #008000;">// 範囲を宣言し、非接続データセットを明示的に指し示す</span>
range aa<span style="color: #000080;">=</span><span style="color: #000000;">[</span>??<span style="color: #000000;">]</span><span style="color: #000080;">!</span><span style="color: #000000;">(</span>tmpdata_a, tmpdata_b<span style="color: #000000;">)</span>;
<span style="color: #008000;">// これを使って散布図を作成</span>
plotxy aa;</pre>
<p><br />
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Range_Notation/Tip_icon.png" width="57"  border="0" /></td><td><p>非接続データセットは<a href="../../LabTalk/LabTalk/Data_Types_and_Variables.html#Scope_of_Variables" title="LabTalk:データ型と変数">プロジェクト</a>に属するので、宣言され、セッションまたは<a href="../../LabTalk/LabTalk/Data_Types_and_Variables.html#Local_Variables" title="LabTalk:データ型と変数">ローカルスコープ</a>を持つDataset変数とは異なります。<a href="../../LabTalk/LabTalk/Data_Types_and_Variables.html#Dataset" title="LabTalk:データ型と変数">データセット変数</a>も内部的には非接続データセットですが、計算のみに使用するよう制限されており、例えばプロット作成には使用できません。
</p></td></tr></table>
<h2><a name="Methods_of_Range"></a><span class="mw-headline">範囲メソッド</span></h2>
<p>範囲変数が作成されると、この範囲から以下のメソッドが使用できるようになります。
</p>
<table class="simple">
<tr>
<th width="120">メソッド
</th>
<th> 説明
</th></tr>
<tr>
<td> range.getSize()
</td>
<td> 範囲の大きさを返します。このメソッドは、列、行列オブジェクト、グラフプロット、セルブロック、非接続データセットなどのデータセット範囲に対して動作します。セルブロックの場合、範囲宣言で指定された最初の部分範囲のサイズのみを返すことに注意してください。
</td></tr>
<tr>
<td> range.setSize()
</td>
<td> 範囲の大きさを設定します。このメソッドは、列、行列オブジェクト、グラフプロット、セルブロック、非接続データセットなどのデータセット範囲に対して機能します。範囲がセルブロックである場合、範囲宣言で指定された最初の部分範囲のサイズのみを設定します。
</td></tr>
<tr>
<td> range.getLayer()
</td>
<td> 範囲にレイヤ（グラフレイヤ、ワークシート、行列レイヤ）が添付されている場合、このメソッドはレイヤの<b>uid</b>を返します。レイヤの名前を取得するには、メソッドの後に<b>$</b>記号が必要で、例えば &quot;rng.getLayer()$ = &quot;.となります。
</td></tr>
<tr>
<td> range.getPage()
</td>
<td> 範囲に添付されたページ（グラフページ、ワークブック、または行列ブック）がある場合、このメソッドはページの<b>uid</b>を返します。ページの名前を取得するには、「rng.getPage()$ =」のように、メソッドの後に<b>$</b>記号を付ける必要があります。
</td></tr>
<tr>
<td> range.getop()
</td>
<td> 範囲がワークシート列またはグラフのプロットの場合、このメソッドは範囲に関連付けられた操作の<b>uid</b>を返します。範囲がワークシート（階層シートを含む）の場合、このシート範囲に接続されている最初の操作の<b>uid</b>を返します。
</td></tr>
<tr>
<td> range.sub(<i>name</i>/<i>index</i>)
</td>
<td> このメソッドは、<i>名前</i>または<i>インデックス</i>を指定して、データ範囲から部分範囲を取得するために使用されます。このメソッドは<a href="../../LabTalk/Script/Virtual_Matrix.html" title="Script:仮想行列">仮想行列</a>の場合にのみ便利です。例えば、<i>ztitle</i> という名前の仮想行列の場合、 <i>ztitle.sub(y);</i> (by name) または <i>ztitle.sub(1);</i> (by index) という式でYの値のデータセットを返すことができます。さらに、 <i>ztitle.sub(y)[3]=;</i> または <i>ztitle.sub(y)[3]$=;</i>という式でこのデータセットの3番目の値を返すことができます。
</td></tr>
<tr>
<td> range.reverse()
</td>
<td> このメソッドは、列、行列オブジェクト、グラフプロット、セルブロック、非接続データセットなどのデータセット範囲に対して機能します。範囲のデータ順序を逆にします。範囲がセルブロックである場合、範囲宣言で指定された最初の部分列のデータ順序を逆転させるだけになります。Ｘファンクション<a class="external text" href="../../XFunction/X-Function/Colreverse.html">colReverse</a>で同じことができます。
</td></tr>
<tr>
<td> range.empty()
</td>
<td> このメソッドは、列、行列オブジェクト、セルのブロック、ラベル行などのラベル領域とデータ領域に対して機能します。範囲内のデータとラベルをクリアします。範囲がデータ領域の場合、この範囲のデータは欠損値に設定されます。GUIでは、選択した範囲を右クリックして、コンテキストメニューで「クリア」を選択することもできます。
</td></tr></table>
<h2><a name="Unique_Uses_of_Range"></a><span class="mw-headline">範囲の特殊な使い方</span></h2>
<h3><a name="Manipulating_Range_DataManipulate_RangeRange_Data_Manipulation"></a><span class="mw-headline">範囲データの編集<span class="OIndex" style="display:none">Manipulate Range</span><span class="OIndex" style="display:none">Range Data Manipulation</span></span></h3>
<p>列の範囲は、データを直接操作するために使用することができます。  列名を直接指定するのではなく、範囲を指定する大きなメリットは、どのページやレイヤがアクティブであるかを意識する必要がないことです。
</p><p>例えば、
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 2つの範囲変数, v1とv2を宣言</span>
range <span style="color: #000000;">[</span>Book1<span style="color: #000000;">]</span>Sheet1 r1<span style="color: #000080;">=</span>Col<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span>, r2<span style="color: #000080;">=</span>Col<span style="color: #000000;">(</span>B<span style="color: #000000;">)</span>;
&nbsp;
<span style="color: #008000;">// [book1]sheet1がアクティブな場合、col(A)=data(1,30)と同じになる </span>
r1 <span style="color: #000080;">=</span> data<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">30</span><span style="color: #000000;">)</span>;                          
r2 <span style="color: #000080;">=</span> uniform<span style="color: #000000;">(</span><span style="color: #0000dd;">30</span><span style="color: #000000;">)</span>;
&nbsp;
<span style="color: #008000;">// [Book1]Sheet1 がアクティブにならないように新しいウィンドウを作成</span>
plotxy <span style="color: #0000dd;">2</span>;                                 
sec <span style="color: #000080;">-</span>p <span style="color: #0000dd;">1.5</span>;            <span style="color: #008000;">// 遅延</span>
r2<span style="color: #000080;">/</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span>;                 <span style="color: #008000;">// col(A)/=4は動かないが、定義した範囲は動く</span>
sec <span style="color: #000080;">-</span>p <span style="color: #0000dd;">1.5</span>;            <span style="color: #008000;">// 遅延</span>
r2<span style="color: #000080;">+</span><span style="color: #000080;">=</span>.4;
sec <span style="color: #000080;">-</span>p <span style="color: #0000dd;">1.5</span>;            <span style="color: #008000;">// 遅延</span>
r1<span style="color: #000080;">=</span><span style="color: #0000dd;">10</span><span style="color: #000080;">+</span>r1<span style="color: #000080;">/</span><span style="color: #0000dd;">3</span>;</pre>
<p>セル範囲を指定する列範囲変数に対する直接計算がサポートされています。例えば、
</p>
<pre class="lt" style="font-family:monospace;">range aa <span style="color: #000080;">=</span> Col<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span><span style="color: #000000;">[</span><span style="color: #0000dd;">10</span><span style="color: #000000;">:</span><span style="color: #0000dd;">19</span><span style="color: #000000;">]</span>; <span style="color: #008000;">// Row 10 to 19 of column A</span>
aa <span style="color: #000080;">+</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span>;                 <span style="color: #008000;">// aaの全ての要素が10増加します</span></pre>
<p>列内の部分範囲のサポートが拡張されました。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 列1の7行目から13行目と列2の3行目から4行目で構成される範囲</span>
<span style="color: #008000;">// 括弧とカンマの区切りを使用</span>
range rs <span style="color: #000080;">=</span> <span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">[</span><span style="color: #0000dd;">7</span><span style="color: #000000;">:</span><span style="color: #0000dd;">13</span><span style="color: #000000;">]</span>, <span style="color: #0000dd;">2</span><span style="color: #000000;">[</span><span style="color: #0000dd;">3</span><span style="color: #000000;">:</span><span style="color: #0000dd;">4</span><span style="color: #000000;">]</span><span style="color: #000000;">)</span>; 
del rs; <span style="color: #008000;">// Sv8.0 SR6以降でサポート
</span>
&nbsp;
<span style="color: #008000;">//  部分範囲間をコピー</span>
range r1 <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">[</span><span style="color: #0000dd;">85</span><span style="color: #000000;">:</span><span style="color: #0000dd;">100</span><span style="color: #000000;">]</span>;
range r2 <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
<span style="color: #008000;">// r1 を列2の先頭にコピー</span>
r2 <span style="color: #000080;">=</span> r1; <span style="color: #008000;">//  v8.1でサポート</span>
<span style="color: #008000;">// v8.1も部分範囲に完全/不完全コピー</span>
range r2 <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span><span style="color: #000000;">[</span><span style="color: #0000dd;">17</span><span style="color: #000000;">:</span><span style="color: #0000dd;">22</span><span style="color: #000000;">]</span>;
r2 <span style="color: #000080;">=</span> r1; <span style="color: #008000;">// r1から6つの値のみコピー</span>
range r2 <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span><span style="color: #000000;">[</span><span style="color: #0000dd;">50</span><span style="color: #000000;">:</span><span style="color: #0000dd;">200</span><span style="color: #000000;">]</span>;
r2 <span style="color: #000080;">=</span> r1; <span style="color: #008000;">// 元は16個の値があるので、65行までのみコピー</span></pre>
<h3><a name="Dynamic_Range_AssignmentDynamic_Range_Assignment"></a><span class="mw-headline">動的な範囲の割り当て<span class="OIndex" style="display:none">Dynamic Range Assignment</span></span></h3>
<p>変数の列番号や他の範囲変数の名前を使って、実行時に自動で新しい範囲を作成できることが有益な場合があります。
</p>
<h4><a name="Define_a_New_Range_Using_an_Expression_for_Column_IndexDefine_Range"></a><span class="mw-headline">列インデックスについての式を使用して新しい範囲を定義<span class="OIndex" style="display:none">Define Range</span></span></h4>
<p><b><a href="../../LabTalk/LabTalk/WCol_(function).html" title="LabTalk:WCol (関数)"><span class="OIndex">wcol()</span></a></b>関数は、次のように実際の列インデックスを実行時に解決できるようにするために使用します。
</p>
<pre class="lt" style="font-family:monospace;">int nn <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
range aa<span style="color: #000080;">=</span>wcol<span style="color: #000000;">(</span><span style="color: #0000dd;">2</span><span style="color: #000080;">*</span>nn <span style="color: #000080;">+</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>;</pre>
<h4><a name="Define_a_New_Range_Using_an_Existing_Range"></a><span class="mw-headline">既存範囲を使って新しい範囲を定義</span></h4>
<p>次のスクリプトは、<a href="../../LabTalk/LabTalk/String_Substitution.html" title="LabTalk:文字列の置換"><span class="OIndex">%( ) 置換</span>表記</a> と <a href="../../LabTalk/LabTalk/Wks_(object).html" title="LabTalk:Wks(オブジェクト)">wks (オブジェクト)メソッド</a>を使って、別の範囲変数に基づいた1つの範囲を作成する方法を示しています。範囲変数で<b>%( )</b> 置換が使用されると、範囲文字列に解決されます。<b>%()</b>はスキップする場合もあります。
</p>
<pre class="lt" style="font-family:monospace;">range rpage<span style="color: #000080;">=</span><span style="color: #000000;">[</span>book1<span style="color: #000000;">]</span> <span style="color: #008000;">//ページの範囲変数を定義</span>
range rwks <span style="color: #000080;">=</span> <span style="color: #000080;">%</span><span style="color: #000000;">(</span>rpage<span style="color: #000000;">)</span>sheet1<span style="color: #000080;">!</span>; <span style="color: #008000;">//%(rpage) に基づいて rwks を定義</span>

type <span style="color: #000080;">%</span><span style="color: #000000;">(</span>rwks<span style="color: #000000;">)</span>; <span style="color: #008000;">//出力範囲文字列[book1]sheet1! </span>

range r1<span style="color: #000080;">=</span> rwks<span style="color: #000080;">!</span>A; <span style="color: #008000;">//rwksに基づいてr1を定義。%(rwks)A も機能しますが%() はスキップ</span>
type <span style="color: #000080;">%</span><span style="color: #000000;">(</span>r1<span style="color: #000000;">)</span>; <span style="color: #008000;">//範囲文字列[Book1]Sheet1!Aを出力</span>
r1<span style="color: #000080;">=</span>data<span style="color: #000000;">(</span><span style="color: #0000dd;">0</span>,<span style="color: #0000dd;">100</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">)</span>; <span style="color: #008000;">//r1に0, 2, 4, ..., 100を入力</span>

range subr1<span style="color: #000080;">=</span>r1<span style="color: #000000;">[</span><span style="color: #0000dd;">10</span><span style="color: #000000;">:</span><span style="color: #0000dd;">20</span><span style="color: #000000;">]</span> <span style="color: #008000;">//r1に基づいてsubr1を定義。%()はスキップ、%(r1)[10:20] も機能する</span>
type <span style="color: #000080;">%</span><span style="color: #000000;">(</span>subr1<span style="color: #000000;">)</span>; <span style="color: #008000;">//範囲文字列出力 [Book1]Sheet1!A[10:20]</span></pre>
<p>より高いレベルの範囲に基づいて新しい範囲を作成するこの方法は、コードの集中化に非常に役立ちます。 
</p>
<pre class="lt" style="font-family:monospace;">rpage.<span style="color: #000080;">longname</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;My Book&quot;</span>; <span style="color: #008000;">//ページロングネームを再命名</span>
rwks.<span style="color: #000080;">addcol</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;<span style="color: #008000;">//指定したシートに列を追加</span>
range r2 <span style="color: #000080;">=</span> rwks<span style="color: #000080;">!</span>wcol<span style="color: #000000;">(</span>rwks.<span style="color: #000080;">ncols</span><span style="color: #000000;">)</span>; <span style="color: #008000;">//r2をrwksの最後列 (右端) として定義</span>
r2<span style="color: #000080;">=</span>subr1; <span style="color: #008000;">// r2をsubr1の値で埋める</span></pre>
<h4><a name="Refer_to_the_Last_Row.2C_Column_and_Sheet_Using_0"></a><span class="mw-headline">0を使用して最後の行/列/シートを参照</span></h4>
<p><b>0</b>表記は、ある範囲の最後のインデックス（最後の行、最後の列、または最後のシート）を参照します。例えば、
</p>
<pre class="lt" style="font-family:monospace;">range rsheet<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span><span style="color: #000080;">!</span>; <span style="color: #008000;">//最後のシート</span>
range right <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #000080;">!</span><span style="color: #0000dd;">0</span>; <span style="color: #008000;">//最後のシートの最後（右端）の列</span>
range sub <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #000080;">!</span><span style="color: #0000dd;">0</span><span style="color: #000000;">[</span><span style="color: #0000dd;">10</span><span style="color: #000000;">:</span><span style="color: #0000dd;">0</span><span style="color: #000000;">]</span>; <span style="color: #008000;">///最後のシートの行0から最終列の最終行までのセル</span>
range r2 <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>Book1<span style="color: #000000;">]</span>Sheet1<span style="color: #000080;">!</span><span style="color: #0000dd;">2</span><span style="color: #000000;">[</span><span style="color: #0000dd;">3</span><span style="color: #000000;">]</span><span style="color: #000000;">:</span><span style="color: #0000dd;">0</span><span style="color: #000000;">[</span><span style="color: #0000dd;">0</span><span style="color: #000000;">]</span>; <span style="color: #008000;">//2列目3行目から最終列最終行まで</span></pre>
<h3><a name="X-Function_ArgumentX-Function_Argument.2C_RangeRange.2C_X-Function_Argument"></a><span class="mw-headline">Ｘファンクション引数<span class="OIndex" style="display:none">X-Function Argument, Range</span><span class="OIndex" style="display:none">Range, X-Function Argument</span></span></h3>
<p>多くのＸファンクションが引数として範囲を使っています。例えば，<i>stats</i>Xファンクションはベクトルを入力とし，指定した範囲について記述統計量を計算します。以下のように入力できます。
</p>
<pre class="lt" style="font-family:monospace;">stats <span style="color: #000000;">[</span>Book1<span style="color: #000000;">]</span>Sheet2<span style="color: #000080;">!</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span>end<span style="color: #000000;">)</span>; <span style="color: #008000;">// book1の2シート目の統計量</span>
stats Col<span style="color: #000000;">(</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span>;                <span style="color: #008000;">// アクティブなワークシートの列2の統計量</span>
&nbsp;
<span style="color: #008000;">// 列1-2, 5-10行目のセルブロックの統計量</span>
stats <span style="color: #0000dd;">1</span><span style="color: #000000;">[</span><span style="color: #0000dd;">5</span><span style="color: #000000;">]</span><span style="color: #000000;">:</span><span style="color: #0000dd;">2</span><span style="color: #000000;">[</span><span style="color: #0000dd;">10</span><span style="color: #000000;">]</span>;</pre>
<p>あるいは、範囲変数を定義したあと範囲変数を引数として使用することもできます。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 1枚目と2枚目のシートのcol(2)の3行目から5行目までのセルに範囲変数を定義</span>
range aa <span style="color: #000080;">=</span> <span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">)</span><span style="color: #000080;">!</span>col<span style="color: #000000;">(</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span><span style="color: #000000;">[</span><span style="color: #0000dd;">3</span><span style="color: #000000;">:</span><span style="color: #0000dd;">5</span><span style="color: #000000;">]</span>; 
<span style="color: #008000;">//範囲に統計を実行</span>
stats aa;</pre>
<p>そして、このXファンクションの入力ベクター引数は、範囲変数で指定します。
</p><p>Xファンクションの中にはXYRangeと呼ばれる特別なタイプの範囲を使用するものがあり、これは基本的にXとY、そしてエラーバーの範囲を含む複合的な範囲です。
<br />XYRangeの一般的なシンタックスはこのようになります。 
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">(</span>rangeX, rangeY<span style="color: #000000;">)</span></pre>
<p>ただし、rangeX 部分をスキップして、標準の範囲表記を使用して XYRange を指定することもできます。この場合、デフォルトの Xデータが仮定されます。
<br />次の2つの表記はXYRangeと同じです。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">(</span>, rangeY<span style="color: #000000;">)</span>
rangeY</pre>
<p>例えば、nteg1 Xファンクションは、入力と出力の両方で XYRange を使います。 
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// col(1) をX、col(2)をYとして積分</span>
<span style="color: #008000;">// 列3をX, 列4をYとして積分曲線を出力</span>
integ1 iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">)</span> oy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">(</span><span style="color: #0000dd;">3</span>,<span style="color: #0000dd;">4</span><span style="color: #000000;">)</span>;
&nbsp;
<span style="color: #008000;">// 結果の積分曲線を列3にY, 列1の入力Xを共有することを除き、</span>
<span style="color: #008000;">// 上記と同じ</span>
integ1 iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span> oy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span>;</pre>
<h2><a name="Listing.2C_Deleting.2C_and_Converting_Range_Variables"></a><span class="mw-headline">範囲変数の一覧、削除、変換</span></h2>
<h3><a name="Listing_Range_VariablesList_Range_Variable"></a><span class="mw-headline">範囲変数の一覧<span class="OIndex" style="display:none">List Range Variable</span></span></h3>
<p><b><a href="../../LabTalk/LabTalk/List_(command).html" title="LabTalk:List (コマンド)"><span class="OIndex">list</span></a></b>LabTalk コマンドを使用して、範囲変数を含むすべてのセッション変数の名前とその定義済み本体のリストを出力します。例えば、
</p>
<pre class="lt" style="font-family:monospace;">list a; <span style="color: #008000;">// すべてのセッション変数を一覧表示</span></pre>
<p><a href="../../LabTalk/Script/From_Script_and_Command_Window.html" title="Script: スクリプトとコマンドウィンドウから"><span class="OIndex">コマンドウィンドウ</span></a>でこのコマンドを発行すると、次のようなリストが出力されます。
</p>
<pre class="lt" style="font-family:monospace;">Session<span style="color: #000000;">:</span>
 <span style="color: #0000dd;">1</span>       MYRANGE   <span style="color: #000000;">[</span>book1<span style="color: #000000;">]</span>sheet1<span style="color: #000080;">!</span>col<span style="color: #000000;">(</span>b<span style="color: #000000;">)</span>
 <span style="color: #0000dd;">2</span>         MYSTR  <span style="color: #ff00ff;">&quot;abc&quot;</span>
 <span style="color: #0000dd;">3</span>            PI   <span style="color: #0000dd;">3.1415926535898</span></pre>
<p>Origin8.1以降、特定のセッション変数を一覧表示するための<a href="../../LabTalk/LabTalk/Command_Statements.html" title="LabTalk:コマンドステートメント">スイッチ</a>が追加されました (以下を参照してください)。
</p>
<table class="simple">
<tr>
<th> オプション
</th>
<th> リストで得られるもの
</th>
<th> オプション
</th>
<th> リストで得られるもの
</th></tr>
<tr>
<td> a
</td>
<td> すべてのセッション変数
</td>
<td> aa
</td>
<td> 文字配列(セッション)
</td></tr>
<tr>
<td> ac
</td>
<td> 定数(セッション)
</td>
<td> af
</td>
<td> ローカル関数(セッション)
</td></tr>
<tr>
<td> afc
</td>
<td> 全てのコンテンツを含んだローカル関数(セッション)
</td>
<td> afp
</td>
<td> ローカル関数のプロトタイプ(セッション)
</td></tr>
<tr>
<td> ag
</td>
<td> グラフオブジェクト（セッション）
</td>
<td> ar
</td>
<td> 範囲変数（セッション）
</td></tr>
<tr>
<td> as
</td>
<td> 文字列変数（セッション）
</td>
<td> at
</td>
<td> ツリー変数（セッション）
</td></tr>
<tr>
<td> av
</td>
<td> 数値変数（セッション）
</td>
<td> --
</td>
<td> --
</td></tr></table>
<h3><a name="Deleting_Range_VariablesDelete_Range_Variable"></a><span class="mw-headline">範囲変数の削除<span class="OIndex" style="display:none">Delete Range Variable</span></span></h3>
<p>範囲変数を削除するには、-ra スイッチを指定して <b><a href="../../LabTalk/LabTalk/Delete_(command).html" title="LabTalk:Delete (コマンド)"><span class="OIndex">del</span><span class="OIndex HasShownIndex" style="display:none">delete</span></a></b> LabTalk コマンドを使用します。  例えば、
</p>
<pre class="lt" style="font-family:monospace;">range aa<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;  <span style="color: #008000;">// aa = アクティブワークシートのCol(1)</span>
range ab<span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>;  <span style="color: #008000;">// ab = アクティブワークシートのCol(2) </span>
range ac<span style="color: #000080;">=</span><span style="color: #0000dd;">3</span>;  <span style="color: #008000;">// ac = アクティブワークシートのCol(3) </span>
range bb<span style="color: #000080;">=</span><span style="color: #0000dd;">4</span>;  <span style="color: #008000;">// bb = アクティブワークシートのCol(4) </span>
list a;      <span style="color: #008000;">//aa, ab, ac, bbを含むすべてのセッション変数を一覧表示</span>
del <span style="color: #000080;">-</span>ra a<span style="color: #000080;">*</span>;  <span style="color: #008000;">// 文字&quot;a&quot;で始まるすべての範囲変数を削除</span>
&nbsp;
<span style="color: #008000;">// 最後のコマンドは aa, ab, acを削除</span></pre>
<p>次の表に、変数を削除するためのオプションを示します。
</p>
<table class="simple">
<tr>
<th> オプション
</th>
<th> 削除/クリアされるもの
</th>
<th> オプション
</th>
<th> 削除/クリアされるもの
</th></tr>
<tr>
<td> ra
</td>
<td> すべてのローカル/セッション変数
</td>
<td> al
</td>
<td> -raと同じ
</td></tr>
<tr>
<td> rar
</td>
<td> 範囲変数
</td>
<td> ras
</td>
<td> 文字列変数
</td></tr>
<tr>
<td> rav
</td>
<td> 数値変数
</td>
<td> rac
</td>
<td> 定数
</td></tr>
<tr>
<td> rat
</td>
<td> ツリー変数
</td>
<td> raa
</td>
<td> 文字列配列
</td></tr>
<tr>
<td> rag
</td>
<td> グラフオブジェクト
</td>
<td> raf
</td>
<td> ローカル/セッション関数
</td></tr></table>
<h3><a name="Converting_Range_to_UIDRange_to_UIDUID.2C_Range"></a><span class="mw-headline">範囲をUIDに変換<span class="OIndex" style="display:none">Range to UID</span><span class="OIndex" style="display:none">UID, Range</span></span></h3>
<p>各Originオブジェクトは、ショートネーム、ロングネーム、<a href="../../LabTalk/LabTalk/LabTalk_Objects.html#Object_Name_and_Universal_Identifier_.28UID.29" title="LabTalk:LabTalk オブジェクト"><span class="OIndex">ユニバーサル識別子</span></a>(<span class="OIndex">UID</span>)を持ちます。  範囲変数とそのUID間を変換することができ、関数 <b>range2uid</b>, <b>uid2name</b>, <b>uid2range</b>を使って、ページとレイヤの名前を取得できます。  使用例については、<a href="../../LabTalk/LabTalk/LabTalk_Objects.html" title="LabTalk:LabTalk オブジェクト">LabTalkオブジェクト</a> をご覧下さい。
</p>
<h2><a name="Special_Notations_for_Range"></a><span class="mw-headline">特別な範囲表記</span></h2>
<h3><a name="Specifying_Multiple_Sheets"></a><span class="mw-headline">複数シートを指定</span></h3>
<p>複数のシートを参照する場合は、ワークシートのデータ範囲文字列の一般的な形式を使用し、カンマとコロンを組み合わせて範囲を指定します。
</p><p><br />
<b>[<i>Workbook</i>](<i>SheetA</i>,<i>SheetN</i>:<i>SheetM</i>)!<i>colBegin</i>[<i>rowIndex</i>]:<i>colEnd</i>[<i>rowIndex</i>]</b>
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 3つの範囲の基本的な組合せ</span>
<span style="color: #000000;">(</span>range1, range2, range3<span style="color: #000000;">)</span>  

<span style="color: #008000;">// 複数シートからの共通の列</span>
<span style="color: #000000;">(</span>sheet1,sheet2,sheet3<span style="color: #000000;">)</span><span style="color: #000080;">!</span>range1
<span style="color: #000000;">(</span>sheet1,sheet3<span style="color: #000000;">:</span><span style="color: #0000dd;">5</span><span style="color: #000000;">)</span><span style="color: #000080;">!</span>range1
 
<span style="color: #008000;">// シート範囲からの共通の列範囲  </span>
<span style="color: #000000;">(</span>sheet1<span style="color: #000000;">:</span>sheetn<span style="color: #000000;">)</span><span style="color: #000080;">!</span>range1</pre>
<p>例えば、
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 2つのシートから A(X)B(Y) を同じグラフにプロット</span>
plotxy <span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span><span style="color: #000080;">!</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">)</span>; 
&nbsp;
<span style="color: #008000;">// ワークブックを再びアクティブにし、シートを追加して、それらにデータを入力</span>
<span style="color: #008000;">//2行目から10行目までの全てのシートからA(X)B(Y)をプロット</span>
plotxy <span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span>end<span style="color: #000000;">)</span><span style="color: #000080;">!</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">)</span><span style="color: #000000;">[</span><span style="color: #0000dd;">2</span><span style="color: #000000;">:</span><span style="color: #0000dd;">10</span><span style="color: #000000;">]</span>;</pre>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// アクティブなブック内のすべてのワークシートをブック内の新しいシートに追加</span>
wappend irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span>end<span style="color: #000000;">)</span><span style="color: #000080;">!</span>;</pre>
<p>詳細は、下の<a href="../../LabTalk/LabTalk/Range_Notation.html#Composite_Range" title="LabTalk:範囲表記">複合範囲</a>を参照してください。
</p>
<h3><a name="XY_and_XYZ_Range"></a><span class="mw-headline">XY、XYZ Range</span></h3>
<p>特定の X ファンクションへの入力として設計された <span class="OIndex">XY Range</span>は、ワークシートの 2 つの列を XY データとして指定する順序付けられたペアです。また、XY部分範囲は、<a href="../../LabTalk/LabTalk/Range_Notation.html#Specifying_Subrange_Using_X_Values" title="LabTalk:範囲表記">X値を使用して指定</a>できます。同様に、(<span class="OIndex">XYZ Range</span>) は、XYZ データを表す 3 つのワークシート列を含む順序付きトリプルです。
</p><p><br />
例えば、<a class="external text" href="../../XFunction/X-Function/Fitpoly.html"><b>fitpoly</b>X ファンクション</a>は、入力と出力の両方に XY Rangeを使います。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 1 列目と 2 列目の XY データに 2 次多項式を当てはめます。</span>
<span style="color: #008000;">// 係数を3列目に、XYフィットデータを4,5列目に入れます。</span>
fitpoly iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">)</span> polyorder<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span> coef<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span> oy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">(</span><span style="color: #0000dd;">4</span>,<span style="color: #0000dd;">5</span><span style="color: #000000;">)</span>;</pre>
<h3><a name="XY_Range_using_.23_and_.3F_for_X"></a><span class="mw-headline">Xで # や&nbsp;? を使ったXY Range</span></h3>
<p>Xファンクションの引数として範囲を使うため <font color="red">(8.0 SR3)</font> で2つの特殊文字&apos;?&apos; と &apos;#&apos; が導入されました。&apos;?&apos;は、強制的にワークシート指定を使用することを示し、範囲指定が要件を満たさない場合は、失敗します。&apos;#&apos; は、範囲が指定を無視し、行番号をX指定として使用することを意味します。  ただし、Y列がサンプリング情報まで持っている場合は、そのサンプリング情報を使ってXを提供します。
</p><p>例えば、
</p>
<pre class="lt" style="font-family:monospace;">plotxy <span style="color: #000000;">(</span>?, <span style="color: #0000dd;">5</span><span style="color: #000000;">)</span>;        <span style="color: #008000;">//  col(5) がX 列であった場合、呼び出しに失敗します</span>
plotxy <span style="color: #000000;">(</span>#, <span style="color: #0000dd;">3</span><span style="color: #000000;">)</span>;        <span style="color: #008000;">// col(3) を Y としてプロットし、行番号を X として使用します</span></pre>
<p>これらの表記法は、<a class="external text" href="../../XFunction/X-Function/Plotxy.html"><b>plotxy</b>Xファンクション</a>において特に便利ですので、ここで紹介します。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//  ワークシートのすべての列を列指定でプロットする。</span>
plotxy <span style="color: #000000;">(</span>?,<span style="color: #0000dd;">1</span><span style="color: #000000;">:</span>end<span style="color: #000000;">)</span>;</pre>
<h3><a name="Tag_Notations_in_Range_Output"></a><span class="mw-headline">範囲出力のタグ表記</span></h3>
<p>多くのXファンクションは、<i>テンプレート</i>、<i>名前</i>、<i>インデックス</i>などのタグで出力範囲を変更することができます。
以下は、離散周波数Xファンクション、<a class="external text" href="../../XFunction/X-Function/Discfreqs.html"><b>discfreqs</b></a>で使用できる例です。
</p>
<pre class="lt" style="font-family:monospace;">discfreqs irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> freq<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> rd<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;[Result]&lt;new template:=table.otw index:=3&gt;&quot;</span>;</pre>
<p>これは、TABLE.OTWというテンプレートをロードして、<b>Result</b>というワークブックの3番目のシートに直接出力されます。
</p><p>タグ表記のサポートは特定のXファンクションに依存するので、プロダクションコードに含める前にタグ表記がサポートされていることを確認してください。
</p>
<h3><a name="Composite_Range"></a><span class="mw-headline">複合範囲</span></h3>
<p><span class="OIndex">複合範囲</span>は、複数の部分範囲で構成される範囲です。  以下の構文で複合範囲を構築することができます。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 3つの範囲の基本的な組合せ</span>
<span style="color: #000000;">(</span>range1, range2, range3<span style="color: #000000;">)</span>         

<span style="color: #008000;">// 複数シートからの共通の列</span>
<span style="color: #000000;">(</span>sheet1,sheet2,sheet3<span style="color: #000000;">)</span><span style="color: #000080;">!</span>range1
<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>，<span style="color: #0000dd;">2</span>，<span style="color: #0000dd;">3</span><span style="color: #000000;">)</span><span style="color: #000080;">!</span>range1

<span style="color: #008000;">//シート範囲からの共通の列範囲 </span>
<span style="color: #000000;">(</span>sheet1<span style="color: #000000;">:</span>sheet3<span style="color: #000000;">)</span><span style="color: #000080;">!</span>range1           
<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">3</span><span style="color: #000000;">)</span><span style="color: #000080;">!!</span>range1</pre>
<p>この動作を示すために、<a class="external text" href="../../XFunction/X-Function/Wcellcolor.html"><b>wcellcolor</b></a>Xファンクションを使って範囲を表示し、<a class="external text" href="../../XFunction/X-Function/Plotxy.html"><b>plotxy</b></a>を使ってXYRangeを表示します。少なくとも4つの列が数値データで入力されているアクティブなブック/シートを操作しているものとします。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//  いくつか異なるブロックを青にする
</span>
wcellcolor <span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">[</span><span style="color: #0000dd;">1</span><span style="color: #000000;">]</span><span style="color: #000000;">:</span><span style="color: #0000dd;">2</span><span style="color: #000000;">[</span><span style="color: #0000dd;">3</span><span style="color: #000000;">]</span>, <span style="color: #0000dd;">1</span><span style="color: #000000;">[</span><span style="color: #0000dd;">5</span><span style="color: #000000;">]</span><span style="color: #000000;">:</span><span style="color: #0000dd;">2</span><span style="color: #000000;">[</span><span style="color: #0000dd;">5</span><span style="color: #000000;">]</span>, <span style="color: #0000dd;">2</span><span style="color: #000000;">[</span><span style="color: #0000dd;">7</span><span style="color: #000000;">]</span><span style="color: #000000;">)</span> color<span style="color: #000000;">(</span>blue<span style="color: #000000;">)</span>; 
&nbsp;
<span style="color: #008000;">// その内いくつかをフォントの色を赤にセット</span>
wcellcolor <span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">[</span><span style="color: #0000dd;">3</span><span style="color: #000000;">]</span><span style="color: #000000;">:</span><span style="color: #0000dd;">4</span><span style="color: #000000;">[</span><span style="color: #0000dd;">5</span><span style="color: #000000;">]</span>, <span style="color: #0000dd;">2</span><span style="color: #000000;">[</span><span style="color: #0000dd;">6</span><span style="color: #000000;">]</span><span style="color: #000000;">:</span><span style="color: #0000dd;">3</span><span style="color: #000000;">[</span><span style="color: #0000dd;">7</span><span style="color: #000000;">]</span><span style="color: #000000;">)</span> color<span style="color: #000000;">(</span>red<span style="color: #000000;">)</span> font;</pre>
<p><b>plotxy</b>を試すには、最初のシートにいくつか数値を入れ、新しいシートを追加し、2番目のシートにはより多くの数値を入れます。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 両方のシートから A(X)B(Y) を同じグラフにプロット</span>
plotxy <span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span><span style="color: #000080;">!</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">)</span>; 
&nbsp;
<span style="color: #008000;">// ワークブックを再びアクティブにし、シートを追加して、それらにデータを入力</span>
<span style="color: #008000;">//2行目から10行目までの全てのシートからA(X)B(Y)をプロット</span>
plotxy <span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span>end<span style="color: #000000;">)</span><span style="color: #000080;">!</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">)</span><span style="color: #000000;">[</span><span style="color: #0000dd;">2</span><span style="color: #000000;">:</span><span style="color: #0000dd;">10</span><span style="color: #000000;">]</span>;</pre>
<p><b>Note</b>: 複合範囲には特有の不明瞭さがあります。例えば、(<b>r1</b>,<b>r2</b>)のように範囲<b> r1</b> と範囲<b> r2</b> で構成される範囲、<b> r1</b>と<b>r2</b>という名前の列で構成される<a href="#XY_and_XYZ_Range"> XY範囲</a>、例えば、(<b>r1</b>,<b>r2</b>)です。  したがって、ある範囲変数にどのような種類のオブジェクトが割り当てられているかを覚えておくことが重要です!
</p>


    