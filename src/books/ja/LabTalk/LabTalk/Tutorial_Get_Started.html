<h1 class="firstheading">LabTalkを使いましょう</h1>

  <p class='urlname' style='display: none'>Tutorial-Get-Started</p>

  <p>&#160;</p>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>目次</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1"><a href="#Summary"><span class="tocnumber">1</span> <span class="toctext">概要</span></a></li>

      <li class="toclevel-1 tocsection-2"><a href="#What_You_Will_Learn"><span class="tocnumber">2</span> <span class="toctext">学習する項目</span></a></li>

      <li class="toclevel-1 tocsection-3">
        <a href="#Steps"><span class="tocnumber">3</span> <span class="toctext">ステップ</span></a>

        <ul>
          <li class="toclevel-2 tocsection-4"><a href="#Run_Script_From_Script.2FCommand_Window"><span class="tocnumber">3.1</span> <span class="toctext">スクリプトウィンドウ/コマンドウィンドウからスクリプトを実行</span></a></li>

          <li class="toclevel-2 tocsection-5"><a href="#Run_Script_From_OGS_File"><span class="tocnumber">3.2</span> <span class="toctext">OGSファイルからスクリプトを実行</span></a></li>

          <li class="toclevel-2 tocsection-6"><a href="#Run_Script_From_Customized_Buttons"><span class="tocnumber">3.3</span> <span class="toctext">カスタムボタンからスクリプトを実行</span></a></li>
        </ul>
      </li>

      <li class="toclevel-1 tocsection-7"><a href="#LabTalk_Elements"><span class="tocnumber">4</span> <span class="toctext">LabTalkエレメント</span></a></li>
    </ul>
  </div>

  <h2><a name="Summary"></a><span class="mw-headline">概要</span></h2>

  <p>LabTalkはOriginのスクリプト言語です。スクリプトを記述してインポートやデータ解析、グラフや出版物の作成を行うことができます。LabTalkスクリプトは独立して実行することもOriginのGUIにある解析ダイアログの一部として実行することもできます。</p>

  <p>LabTalkスクリプトは、LabTalkのインタプリタにより受け取られ、解釈･実行される、ひとまとまりのLabTalkテキストのことです。LabTalkスクリプトは、1つ以上のプログラミングステートメントで構成され、それぞれに割り当てられた操作を実行します。スクリプト中の各文の文末には、他の文と分割するためにセミコロン(;)を付ける必要があります。</p>

  <p>LabTalkプログラミングの構文には次の種類のエレメントがあります。<a href="../../LabTalk/LabTalk/System_Variables.html" title="LabTalk:システム変数">システム変数</a>,<a href="../../LabTalk/LabTalk/Command_Statements.html" title="LabTalk:コマンドステートメント">コマンド</a>,<a href="../../LabTalk/LabTalk/Functions.html" title="LabTalk:関数">関数</a>,<a href="../../LabTalk/LabTalk/Macros.html" title="LabTalk:マクロ">マクロ</a>,<a href="../../LabTalk/LabTalk/LabTalk_Objects.html" title="LabTalk:LabTalk オブジェクト">オブジェクト</a>,<a href="../../LabTalk/Script/Brief_X_Function_Introduction.html" title="Script:簡単なXファンクションの説明">Xファンクション</a></p>

  <p>LabTalkスクリプトを実行する方法は複数あります。頻度が高いものとしては<a href="../../LabTalk/Script/From_Script_and_Command_Window.html" title="Script: スクリプトとコマンドウィンドウから">スクリプトウィンドウ/コマンドウィンドウ　から</a>,<a href="../../LabTalk/Script/From_Files.html" title="Script:ファイルから">.ogsファイルから</a>,<a href="../../LabTalk/Script/From_a_Toolbar_Button.html" title="Script:ツールバーボタンから">ツールバーボタンから</a>,<a href="../../LabTalk/Script/From_Graphical_Objects.html" title="Script:グラフィックオブジェクトから">グラフオブジェクトから</a>があります。</p>

  <h2><a name="What_You_Will_Learn"></a><span class="mw-headline">学習する項目</span></h2>

  <p>このチュートリアルでは次のことを学ぶことができます。</p>

  <ul>
    <li>スクリプトウィンドウまたはコマンドウィンドウからLabTalkスクリプトを実行する方法</li>

    <li>.ogsファイルからLabTalkスクリプトを実行する方法</li>

    <li>ツールバーボタン/グラフオブジェクトからLabTalkスクリプトを実行する方法</li>

    <li>それぞれのLabTalkエレメントの基本的な使い方</li>

    <li>LabTalkスクリプトを実行方法の違いを比較</li>
  </ul>

  <h2><a name="Steps"></a><span class="mw-headline">ステップ：</span></h2>

  <h3><a name="Run_Script_From_Script.2FCommand_Window"></a><span class="mw-headline">スクリプトウィンドウ/コマンドウィンドウからスクリプトを実行</span></h3>

  <p>スクリプトウィンドウとコマンドウィンドウはLabTalkスクリプトを実行する際に最もよく使われます。それぞれのウィンドウは1行または複数行のスクリプト実行をサポートしています。</p>

  <p>スクリプトウィンドウでは1つのカーソルがあり、<b>Enter</b>キーを押したときにハイライトされたコードまたは今カーソルがある場所のにあるコードを実行します。対して、コマンドウィンドウにはプロンプトがありプロンプトに入力された全てのコードを実行します。</p>

  <p>コマンドウィンドウにはオートコンプリート機能やXファンクションのヒント、コマンド履歴があり、履歴からコマンドの再実行をサポートしています。しかしコマンドウィンドウの履歴はスクリプトウィンドウのように編集できません。ユーザは必要に応じてどちらのウィンドウからスクリプトを実行するか選択できます。</p>

  <p><b>スクリプトウィンドウから実行</b></p>

  <ol>
    <li>Originを起動し、<b>ウィンドウ：スクリプトウィンドウ</b>を選択（もしくは<b>Alt+Shift+3</b>を押す)してスクリプトウィンドウを開きます。</li>

    <li><b>スクリプトウィンドウ</b>のメニューから<b>編集：スクリプトの実行</b>が選択されていることを確認します。</li>

    <li>スクリプトウィンドウで次のテキストを入力して<b>Enter</b>キーを押し、スクリプトを実行します。
      <pre class="lt" style="font-family:monospace;">
type <span style="color: #000080;">-</span>b <span style="color: #ff00ff;">&quot;Hello World&quot;</span>
</pre>

      <dl>
        <dd>注目ボックスがポップアップし&rdquo;Hello World&rdquo;テキストが表示されればスクリプトはうまく実行できたことになります。</dd>
      </dl>
    </li>
  </ol>

  <ol start="4">
    <li><b>OK</b>をクリックして、注目ボックスを閉じます。以下のスクリプトをコピーして、スクリプトウィンドウに貼り付けます。実行する場合、貼り付けた3行のテキストを選択して<b>Enter</b>キーを押します。スクリプトにより4つの列を持つ新しいワークブックが作成され、ワークブック名(<a href="../../LabTalk/LabTalk/String_registers.html#.25.40_String_Registers" title="LabTalk:文字列レジスタ">文字列レジスタ</a><b>%H</b>に保持されています)と列数(<a href="../../LabTalk/LabTalk/Numeric_to_String_Conversion.html" title="LabTalk:数値から文字列への変換">置換表記</a><b>$(wks.ncols)</b>に保持されています)をスクリプトウィンドウに出力します。</li>

    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
newbook;
wks.<span style="color: #000080;">ncols</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span>;
type <span style="color: #000080;">-</span>a <span style="color: #ff00ff;">&quot;In %H, there are $(wks.ncols) columns.&quot;</span>
</pre>
    </li>

    <li>では現在の行を実行することなくスクリプトウィンドウに複数列を入力する方法を学びましょう。</li>

    <li>次のスクリプト(4行あります)を1行ずつ入力するとします。</li>

    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
loop<span style="color: #000000;">(</span>num,<span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">4</span><span style="color: #000000;">)</span>
   <span style="color: #000000;">{</span>
      num <span style="color: #000080;">=</span>;
   <span style="color: #000000;">}</span>
</pre>
    </li>

    <li>スクリプトウィンドウにあるすべてのコンテンツを消去し、スクリプトウィンドウのメニューから<b>編集：スクリプトの実行</b>の選択を解除します。</li>

    <li>これでスクリプトの実行を無効にしたので、<b>Enter</b>キーと使って新しい行を作成して上記4行のスクリプトを1行ずつ入力することができます。</li>

    <li>入力完了後、<b>編集：スクリプトの実行</b>を再度選択し入力した4行を選択して<b>Enter</b>キーを押すことで実行します。</li>
  </ol>

  <p><br>
  <b>コマンドウィンドウから実行</b></p>

  <ol>
    <li>Originを起動し、<b>ウィンドウ：コマンドウィンドウ</b>を選択（もしくは<b>Alt+3</b>を押す)してコマンドウィンドウを開きます。</li>

    <li>上記3と4の手順に従って、コマンドウィンドウで両方のスクリプトサンプルを実行します。2つ目のスクリプトサンプルでは実行時に全てのスクリプトを選択する必要はありません。</li>
  </ol>

  <table class="noborder">
    <tr>
      <td style="vertical-align:top" width="60"><img src="../images/Tutorial_Get_Started/Tip_icon.png" width="57" border="0" alt=""></td>

      <td>
        <p>実行せずに複数行入力するほかの方法として<b>Ctrl+Enter</b>で新しい行を作成します。これは<b>スクリプトウィンドウ</b>でも<b>コマンドウィンドウ</b>でも使えます。</p>
      </td>
    </tr>
  </table>

  <h3><a name="Run_Script_From_OGS_File"></a><span class="mw-headline">OGSファイルからスクリプトを実行</span></h3>

  <ol>
    <li>以下のスクリプトをコピーして、空のスクリプトウィンドウに貼り付けます。</li>
  </ol>
  <pre class="lt" style="font-family:monospace;">
type <span style="color: #000080;">-</span>b <span style="color: #ff00ff;">&quot;HELLO WORLD&quot;</span>;

<span style="color: #000000;">[</span>Section1<span style="color: #000000;">]</span>
type <span style="color: #000080;">-</span>a <span style="color: #ff00ff;">&quot;Hello&quot;</span>;

<span style="color: #000000;">[</span>Section2<span style="color: #000000;">]</span>
type <span style="color: #000080;">-</span>a <span style="color: #ff00ff;">&quot;World&quot;</span>;
</pre>

  <ol start="2">
    <li>スクリプトウィンドウのメニューから<b>ファイル[テキスト形式]：新規保存</b>をクリックし<b>ユーザファイルフォルダ</b>にTest.ogsとしてスクリプトを保存します。</li>

    <li>コマンドウィンドウを開き(<b>ウィンドウ:コマンドウィンドウ</b>もしくは<b>Alt+3</b>)、次のテキストを入力して<b>Enter</b>を押します。</li>

    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
run.<span style="color: #000080;">file</span><span style="color: #000000;">(</span>Test<span style="color: #000000;">)</span>
</pre>
    </li>

    <li style="list-style: none">
      <dl>
        <dd><a href="../../LabTalk/LabTalk/Run_(object).html#Methods:" title="LabTalk:Run (オブジェクト)"><i>run.file( )</i></a>はLabTalkの <a href="../../LabTalk/LabTalk/Run_(object).html" title="LabTalk:Run (オブジェクト)"><i>Run</i></a> オブジェクトのメソッドです。これにより、特定の.ogsファイルにあるスクリプトを実行することができます。この場合、名前のあるセクションの前にあるファイルの開始部分のスクリプトが実行されます。</dd>
      </dl>
    </li>

    <li><b>OK</b>をクリックして&rdquo;HELLO WORLD&rdquo;と表示された注目ボックスを閉じ、次のテキストをコマンドウィンドウに入力して<b>Enter</b>を押します。</li>

    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
run.<span style="color: #000080;">section</span><span style="color: #000000;">(</span>Test, Section1<span style="color: #000000;">)</span>
</pre>

      <dl>
        <dd><a href="../../LabTalk/LabTalk/Run_(object).html#Methods:" title="LabTalk:Run (オブジェクト)"><i>run.section( )</i></a>もLabTalkの <a href="../../LabTalk/LabTalk/Run_(object).html" title="LabTalk:Run (オブジェクト)"><i>Run</i></a> オブジェクトのメソッドです。このメソッドで特定の.ogsファイルにある名前のついたセクションのスクリプトを実行します。</dd>
      </dl>
    </li>
  </ol>

  <table class="note">
    <tr>
      <td><b>Notes:</b><b>ユーザファイルフォルダ</b>内に保存した.ogsファイルがない場合、<i>run.file()</i>もしくは<i>run.section()</i>メソッドを使う場合にはフルファイルパスが必要になります。</td>
    </tr>

    <tr>
      <td>.ogsという拡張子はどちらのメソッドでも必要ありません。</td>
    </tr>

    <tr>
      <td>どちらかのメソッドを使って実行されたスクリプトは名前つきセクション(もしくは<i>return</i>ステートメント)にたどり着くと終了します。</td>
    </tr>

    <tr>
      <td>typeステートメントはコマンドを実行したウィンドウに内容を出力するよう命令します。</td>
    </tr>
  </table>

  <p> </p>

  <h3><a name="Run_Script_From_Customized_Buttons"></a><span class="mw-headline">カスタムボタンからスクリプトを実行</span></h3>

  <p><b>ツールバーボタンから実行</b></p>

  <ol>
    <li><a href="../../LabTalk/LabTalk/Tutorial_Get_Started.html#Run_Script_From_OGS_File" title="LabTalk:LabTalkを使いましょうチュートリアル">前の章</a>で<b>ユーザファイルフォルダ</b>に保存されたTest.ogsファイルがあることを確認してください。</li>

    <li>Originを開いてスクリプトウィンドウとコマンドウィンドウが閉じられていることを確認してください。</li>

    <li>メニューから<b>表示：ツールバー</b>を選択してツールバーの<b>カスタマイズ</b>ダイアログを開きます。<b>ボタングループ</b>タブに移動して<b>グループ</b>にある<b>User Defined</b>を選択します。このグループには10個のボタンがあります。</li>

    <li><b>ボタン</b>にある<b>追加</b>ボタンをクリックし、ポップアップする<b>ボタンの追加</b>ダイアログの<b>ボタンイメージ</b>で<b>7</b>を選択します。</li>

    <li><b>OK</b>をクリックすると<b>Run</b>ボタンがボタンのサムネイル一覧に追加されます。

      <dl>
        <dd><a class="image"><img alt="LT Tutorial Get Started 01.png" src="../images/Tutorial_Get_Started/LT_Tutorial_Get_Started_01.png" width="233"></a></dd>
      </dl>
    </li>

    <li>2つ目の<b>Run</b>ボタンをクリックし、さらに<b>設定...</b>ボタンをクリックして<b>ボタン設定</b>ダイアログを開きます。</li>

    <li><b>ファイル名</b>ボックスの右側にある<b>一覧</b>ボタンをクリックし、<b>ユーザファイルフォルダ</b>に作成した<b>Test.ogs</b>ファイルを選択します。</li>

    <li><b>セクション名</b>に<b>Section1</b>と入力します。<b>OK</b>をクリックしてこの設定を適用して、ダイアログを閉じます。</li>

    <li>Originのワークスペースにボタンをドラッグアンドドロップし<b>カスタマイズ</b>ダイアログを閉じます。</li>

    <li>Originのインタフェースから独立しているこのボタンをクリックするとスクリプトが実行され、スクリプトウィンドウが開き入力した&rdquo;Hello&rdquo;というテキストが表示されます。</li>
  </ol>

  <p><br>
  <b>グラフィックオブジェクトから実行</b></p>

  <ol>
    <li><a class="image"><img alt="Button New Graph.png" src="../images/Tutorial_Get_Started/Button_New_Graph.png" width="23"></a>ボタンをクリックして空のグラフを作成します。</li>

    <li>空白の部分を右クリックしてコンテクストメニューから<b>テキストの追加</b>を選択し、ラベルとして<b>Run2</b>と入力します。</li>

    <li>テキストオブジェクトを選択して右クリックし、<b>プロパティ</b>を選択して開くダイアログでプログラミングタブを開きます。<b>のあとでスクリプトを実行</b>のドロップダウンリストから<b>ボタンアップ</b>を選択し、以下のスクリプトを入力します。
      <pre class="lt" style="font-family:monospace;">
run.<span style="color: #000080;">section</span><span style="color: #000000;">(</span>Test, Section2<span style="color: #000000;">)</span>;
</pre>

      <dl>
        <dd><a class="image"><img alt="LT Tutorial Get Started 02.png" src="../images/Tutorial_Get_Started/LT_Tutorial_Get_Started_02.png" width="643"></a></dd>
      </dl>
    </li>

    <li>これで、テキストラベルがボタンになりました。<b>Run2</b>ボタンをクリックすることでスクリプト編集ボックスに追加したスクリプトが実行されます。</li>
  </ol>

  <table class="noborder">
    <tr>
      <td style="vertical-align:top" width="60"><img src="../images/Tutorial_Get_Started/Tip_icon.png" width="57" border="0" alt=""></td>

      <td>
        <p>グラフィカルオブジェクトがボタンになると、<b>編集モード</b>（<b>編集：編集モード</b>もしくは<b>Ctrl+Alt+B</b>)を使うか、<b>Alt</b>キーを押したままダブルクリックしてプロパティを編集してください。編集モードを使用した場合には、再度選択することで編集モードをオフにできます。</p>
      </td>
    </tr>
  </table>

  <table class="note">
    <tr>
      <td>
        <b>Notes:</b>

        <ol>
          <li>ツールバーボタンからスクリプトを実行するためには.ogsファイルが必要になりますが、グラフィカルオブジェクトではスクリプト編集ボックスにLabTalkスクリプトをそのまま入力することができます。</li>

          <li>編集モードはOrigin2017より前のバージョンではボタン編集モードと呼ばれています。</li>
        </ol>
      </td>
    </tr>
  </table>

  <h2><a name="LabTalk_Elements"></a><span class="mw-headline">LabTalkエレメント</span></h2>

  <p>異なるLabTalkエレメントの利用法とサンプルは下記のようにまとめられます。</p>

  <ul>
    <li><a href="../../LabTalk/LabTalk/System_Variables.html" title="LabTalk:システム変数">システム変数</a></li>
  </ul>

  <dl>
    <dd>システム変数はOriginの挙動を監視・制御する読み取り専用もしく読み書きできる変数です。</dd>

    <dd><b>サンプル：</b><b>@ASC</b>システム変素を使うことで自動保存チェックのトリガーとなるプロジェクトサイズ（メガバイト単位）を確認、変更できます。</dd>
  </dl>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">//次の行のスクリプトを実行することで変数の値を取得します</span>
@ASC <span style="color: #000080;">=</span> ;
<span style="color: #008000;">//次の行のスクリプトを実行して変数の値を10 (MB)に設定します</span>
@ASC <span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span>;
</pre>

  <ul>
    <li><a href="../../LabTalk/LabTalk/Command_Statements.html" title="LabTalk:コマンドステートメント">コマンド</a></li>
  </ul>

  <dl>
    <dd>コマンドは定義されたタスクを実行するステートメント(オプションも含む)です。</dd>

    <dd><b>サンプル：</b><b>Type</b>コマンドを<b>-n</b>オプションをつけて使用します。</dd>
  </dl>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">//ダイアログに文字列とともにYes,NOボタンを表示します</span>
type <span style="color: #000080;">-</span>n <span style="color: #ff00ff;">&quot;Do you want to continue?&quot;</span>;
type <span style="color: #000080;">-</span>a Script continues here since you clicked Yes.;
</pre>

  <ul>
    <li><a href="../../LabTalk/LabTalk/Function_Statements.html" title="LabTalk:関数ステートメント">関数</a></li>
  </ul>

  <dl>
    <dd>オプションで括弧内に引数を含むステートメントで、単一の値または値の範囲（データセット）を返します。</dd>

    <dd><b>サンプル1：</b><b>Left()</b>関数を使って文字列を処理します</dd>
  </dl>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">//まず&quot;Hello World」文字列を定義します</span>
string str1<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Hello World&quot;</span>;
<span style="color: #008000;">//関数を使って定義した文字列の最初の5文字を取得します</span>
string strLeft<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Left<span style="color: #000000;">(</span>str1<span style="color: #000080;">$</span>,<span style="color: #0000dd;">5</span><span style="color: #000000;">)</span><span style="color: #000080;">$</span>;
strLeft<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> ; <span style="color: #008000;">//Helloが返るはずです</span>
</pre>

  <dl>
    <dd><b>サンプル2：</b>いくつかの関数は式の左側に表示することができます。</dd>
  </dl>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">//定義した一連の数で列Aを埋めます</span>
col<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span> <span style="color: #000080;">=</span> data<span style="color: #000000;">(</span><span style="color: #0000dd;">600</span>,<span style="color: #0000dd;">850</span>,<span style="color: #0000dd;">10</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// 600から850まで10間隔で列Aを埋めます</span>
</pre>

  <ul>
    <li><a href="../../LabTalk/LabTalk/Macro_Statements.html" title="LabTalk:マクロステートメント">マクロ</a></li>
  </ul>

  <dl>
    <dd>マクロは与えられたスクリプトを新しい変数名に関連づけ、引数を含めてコマンドとしてあとで利用できるようにします。</dd>

    <dd><b>サンプル：</b>簡単なマクロを定義し、あとで利用します。</dd>

    <dd>最初に<i>testmacro</i>という名前でマクロを定義するために次のスクリプトを実行します。</dd>
  </dl>
  <pre class="lt" style="font-family:monospace;">
def testmacro
<span style="color: #000000;">{</span>
        repeat <span style="color: #000080;">%</span>1
        <span style="color: #000000;">{</span>
                repeat <span style="color: #000080;">%</span>2
                <span style="color: #000000;">{</span>
                        type <span style="color: #000080;">-</span>l <span style="color: #ff00ff;">&quot;=&quot;</span>;
                <span style="color: #000000;">}</span>
                type;
        <span style="color: #000000;">}</span>
<span style="color: #000000;">}</span>
</pre>

  <dl>
    <dd>そのあと次の行を入力することでこのマクロで事前定義したスクリプトを実行します。</dd>
  </dl>
  <pre class="lt" style="font-family:monospace;">
testmacro <span style="color: #0000dd;">2</span> <span style="color: #0000dd;">64</span>; <span style="color: #008000;">//  %1 は &lsquo;2&rsquo; に  %2　は &lsquo;64&rsquo; になります</span>
</pre>

  <ul>
    <li><a href="../../LabTalk/LabTalk/LabTalk_Objects.html" title="LabTalk:LabTalk オブジェクト">オブジェクト</a></li>
  </ul>

  <dl>
    <dd>オブジェクト(表示、非表示どちらでも）のプロパティやメソッドにはLabTalkを使ってアクセスすることができます。</dd>

    <dd><b>サンプル1：</b><a href="../../LabTalk/LabTalk/Tutorial_Get_Started.html#Run_Script_From_OGS_File" title="LabTalk:LabTalkを使いましょうチュートリアル">3.2セクション</a>にある<i>run.file()</i><i>run.section()</i>サンプルをご覧ください。<b>Run</b>オブジェクトの2つのメソッドを使った例があります。</dd>

    <dd><b>サンプル2：</b>次のスクリプトを実行することでsystem.pathの<b>program</b>パスプロパティが返されます。</dd>
  </dl>
  <pre class="lt" style="font-family:monospace;">
System.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> ;
<span style="color: #008000;">//Originの実行しているファイル(.EXE)のディレクトリパスを返します</span>
</pre>

  <ul>
    <li><a href="../../LabTalk/Category/X-Functions.html" title="カテゴリー:Xファンクション">Xファンクション</a></li>
  </ul>

  <dl>
    <dd>Xファンクションはタスクを実行し、LabTalkスクリプトからOriginの機能を活用するための主要なツールです。</dd>

    <dd><b>サンプル：</b><a class="external text" href="../../XFunction/X-Function/Newbook.html">newbook</a>Xファンクションを使って特定のブック名、シート名を持つ新しいワークブックを作成します。</dd>

    <dd>以下のスクリプトを実行してください。</dd>
  </dl>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">//ワークブックをTest1と名づけます（ロングネーム、ショートネームどちらも）</span>
<span style="color: #008000;">//このワークブックには5つのワークシートが含まれます</span>
newbook name<span style="color: #000000;">:</span><span style="color: #000080;">=</span>Test1 sheet<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">5</span> option<span style="color: #000000;">:</span><span style="color: #000080;">=</span>lsname;
</pre>

  <ul>
    <li><a href="../../LabTalk/Category/Origin_C_Functions.html" title="カテゴリ：Origin C関数">Origin C関数</a></li>
  </ul>

  <dl>
    <dd><a class="external text" href="../../OriginC/Category/Origin_C_Programming_Guide.html">OriginC</a>で適切に実装された関数はLabTalkスクリプトで呼び出すことができます。</dd>

    <dd><b>サンプル：</b>OriginC関数を作成してLabTalkを使ってその関数を呼び出します。</dd>

    <dd>コードビルダを開いて新しい.cファイルを作成し、次のOriginCコードを貼り付けてください。</dd>
  </dl>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">double</span> CubeRoot<span style="color: #000000;">(</span><span style="color: #0000ff;">double</span> x<span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
        <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span>x <span style="color: #000080;">&lt;</span> <span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>
                <span style="color: #0000ff;">return</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">10</span><span style="color: #000040;">^</span><span style="color: #000000;">(</span><span style="color: #000000;">log10</span><span style="color: #000000;">(</span><span style="color: #000000;">abs</span><span style="color: #000000;">(</span>x<span style="color: #000000;">)</span><span style="color: #000000;">)</span><span style="color: #000040;">/</span><span style="color: #0000dd;">3</span><span style="color: #000000;">)</span>;
        <span style="color: #0000ff;">else</span>
                <span style="color: #0000ff;">return</span> <span style="color: #0000dd;">10</span><span style="color: #000040;">^</span><span style="color: #000000;">(</span><span style="color: #000000;">log10</span><span style="color: #000000;">(</span>x<span style="color: #000000;">)</span><span style="color: #000040;">/</span><span style="color: #0000dd;">3</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span>
</pre>

  <dl>
    <dd>OriginC関数をコンパイルしこの<b>MyFunc</b>関数をLabTalkスクリプトを使って実行します。</dd>
  </dl>
  <pre class="lt" style="font-family:monospace;">
double aa <span style="color: #000080;">=</span> CubeRoot<span style="color: #000000;">(</span><span style="color: #0000dd;">125</span><span style="color: #000000;">)</span>;
aa <span style="color: #000080;">=</span> ;<span style="color: #008000;">//aa=5　が返されます</span>
</pre>
