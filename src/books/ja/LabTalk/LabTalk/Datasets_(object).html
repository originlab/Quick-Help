<h1 class="firstheading">Datasets</h1>

  <p class='urlname' style='display: none'>Datasets</p>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>Contents</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1"><a href="#IntroductionDataset"><span class="tocnumber">1</span> <span class="toctext">Introduction<span class="OIndex" style="display:none">Dataset</span></span></a></li>

      <li class="toclevel-1 tocsection-2">
        <a href="#Creating_a_DatasetCreate_Dataset"><span class="tocnumber">2</span> <span class="toctext">Creating a Dataset<span class="OIndex" style="display:none">Create Dataset</span></span></a>

        <ul>
          <li class="toclevel-2 tocsection-3"><a href="#Declaring_a_Dataset_and_the_Dataset_-a_option"><span class="tocnumber">2.1</span> <span class="toctext">Declaring a Dataset and the Dataset -a option</span></a></li>

          <li class="toclevel-2 tocsection-4"><a href="#Examples"><span class="tocnumber">2.2</span> <span class="toctext">Examples</span></a></li>
        </ul>
      </li>

      <li class="toclevel-1 tocsection-5"><a href="#Getting_and_Setting_SizeGet_dataset_sizeSet_dataset_size"><span class="tocnumber">3</span> <span class="toctext">Getting and Setting Size<span class="OIndex" style="display:none">Get dataset size</span><span class="OIndex" style="display:none">Set dataset size</span></span></a></li>

      <li class="toclevel-1 tocsection-6">
        <a href="#Accessing_DatasetsAccessing_Dataset"><span class="tocnumber">4</span> <span class="toctext">Accessing Datasets<span class="OIndex" style="display:none">Accessing Dataset</span></span></a>

        <ul>
          <li class="toclevel-2 tocsection-7">
            <a href="#Range_Variables"><span class="tocnumber">4.1</span> <span class="toctext">Range Variables</span></a>

            <ul>
              <li class="toclevel-3 tocsection-8"><a href="#For_Worksheet_Data"><span class="tocnumber">4.1.1</span> <span class="toctext">For Worksheet Data</span></a></li>

              <li class="toclevel-3 tocsection-9"><a href="#For_Plotted_.28Graph.29_Data"><span class="tocnumber">4.1.2</span> <span class="toctext">For Plotted (Graph) Data</span></a></li>

              <li class="toclevel-3 tocsection-10"><a href="#For_Matrix_Data"><span class="tocnumber">4.1.3</span> <span class="toctext">For Matrix Data</span></a></li>
            </ul>
          </li>

          <li class="toclevel-2 tocsection-11"><a href="#By_Col.28.29.2C_Mat.28.29.2C_and_WCol.28.29_function"><span class="tocnumber">4.2</span> <span class="toctext">By Col(), Mat(), and WCol() function</span></a></li>

          <li class="toclevel-2 tocsection-12"><a href="#Cell_FunctionCell_Function"><span class="tocnumber">4.3</span> <span class="toctext">Cell Function<span class="OIndex" style="display:none">Cell Function</span></span></a></li>

          <li class="toclevel-2 tocsection-13"><a href="#Substitution_Notation"><span class="tocnumber">4.4</span> <span class="toctext">Substitution Notation</span></a></li>

          <li class="toclevel-2 tocsection-14"><a href="#By_Dataset_Name"><span class="tocnumber">4.5</span> <span class="toctext">By Dataset Name</span></a></li>
        </ul>
      </li>

      <li class="toclevel-1 tocsection-15"><a href="#Accessing_Dataset_Storage"><span class="tocnumber">5</span> <span class="toctext">Accessing Dataset Storage</span></a></li>

      <li class="toclevel-1 tocsection-16"><a href="#Masking_Cells"><span class="tocnumber">6</span> <span class="toctext">Masking Cells</span></a></li>

      <li class="toclevel-1 tocsection-17"><a href="#Set_Column_Values_with_a_Dataset"><span class="tocnumber">7</span> <span class="toctext">Set Column Values with a Dataset</span></a></li>

      <li class="toclevel-1 tocsection-18"><a href="#Using_Loose_Datasets_in_X-FunctionsLoose_Dataset.2C_X-FunctionX-Function.2C_Loose_Dataset"><span class="tocnumber">8</span> <span class="toctext">Using Loose Datasets in X-Functions<span class="OIndex" style="display:none">Loose Dataset, X-Function</span><span class="OIndex" style="display:none">X-Function, Loose Dataset</span></span></a></li>
    </ul>
  </div>

  <h2><a name="IntroductionDataset"></a><span class="mw-headline">Introduction<span class="OIndex" style="display:none">Dataset</span></span></h2>

  <p>A dataset is a basic Origin object. It is essentially a one-dimensional array that can contain numeric and/or text values.</p>

  <ul>
    <li>A dataset may contain different data types</li>

    <li>The individual values in a dataset are called elements.</li>

    <li>Each element in a dataset is associated with an index number, by which individual elements can be accessed. In a worksheet, the index number corresponds to the row number. Note that in contrast to Origin C convention (where the first element has an index of 0), LabTalk index numbers start with 1.</li>

    <li>Each dataset in an <a href="../../LabTalk/Category/LT_The_Origin_Project.html" title="Category:LT The Origin Project">Origin Project</a> has a unique name.</li>
  </ul>

  <p>A dataset is often associated with a worksheet column and/or one or more data plots. When a dataset is deleted, associated worksheet columns and data plots are also deleted.</p>

  <p>A dataset is also a LabTalk <a href="../../LabTalk/LabTalk/Data_Types_and_Variables.html" title="LabTalk:Data Types and Variables">Variable</a>, so it can either belong to the project, or be <a href="../../LabTalk/LabTalk/Data_Types_and_Variables.html#Dataset" title="LabTalk:Data Types and Variables">declared</a> as a local variable. The following types of datasets are supported in Origin:</p>

  <p><span class="OIndex">Column</span> or <span class="OIndex">Matrix</span> Object: A dataset that is associated with a column in a worksheet or a Matrix Object in a Matrixsheet.</p>

  <p><span class="OIndex">Loose Dataset</span>: A Dataset which is not attached to a worksheet or matrixsheet.</p>

  <p><span class="OIndex">Temporary Dataset</span>: A type of loose dataset used as temporary dataset storage. Origin creates temporary datasets with names starting with an underscore ("_") character, e.g., _temp. Origin temporary datasets are deleted when the project is saved or a graph page is printied/copied. User-created temporary (loose) datasets are deleted when a project is closed or a new project is opened.</p>

  <p>To see the names of the existing datasets, use <font color="navy"><i>List s</i></font> command.</p>

  <h2><a name="Creating_a_DatasetCreate_Dataset"></a><span class="mw-headline">Creating a Dataset<span class="OIndex" style="display:none">Create Dataset</span></span></h2>

  <p>Datasets in worksheets and matrix layers, are automatically created when a column or matrix object is added. A column or a matrix object is automatically added when it is requested as an output, like when it is on the left hand side of an assignment, for example:</p>
  <pre class="lt" style="font-family:monospace;">
wks.<span style="color: #000080;">ncols</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>; <span style="color: #008000;">// set active sheet to be only 3 columns</span>
col<span style="color: #000000;">(</span><span style="color: #0000dd;">4</span><span style="color: #000000;">)</span><span style="color: #000080;">=</span><span style="color: #000000;">{</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">3</span><span style="color: #000000;">}</span>; <span style="color: #008000;">// col(4) will be automatically added</span>
</pre>

  <p>There are three ways to create a loose dataset:</p>

  <dl>
    <dd>
      <ul>
        <li>Declare it with [LabTalk:Dataset_(command)|dataset command]]</li>

        <li>Use the <a href="../../LabTalk/LabTalk/Create_(command).html" title="LabTalk:Create (command)">Create (Command)</a>.</li>

        <li>Auto create with assignment.</li>
      </ul>
    </dd>
  </dl>

  <h3><a name="Declaring_a_Dataset_and_the_Dataset_-a_option"></a><span class="mw-headline">Declaring a Dataset and the Dataset -a option</span></h3>

  <p>If you <a href="../../LabTalk/LabTalk/Dataset_(command).html" title="LabTalk:Dataset (command)">declare a dataset</a> <i>without</i> using the <b>-a</b> option, it will be created as <b>Numeric(Double)</b> only. To create a <b>Text &amp; Numeric</b> dataset, add the option <b>-a</b>.</p>

  <h3><a name="Examples"></a><span class="mw-headline">Examples</span></h3>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">// Declared a numeric dataset</span>
Dataset ds1 <span style="color: #000080;">=</span> <span style="color: #000000;">{</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">3</span><span style="color: #000000;">}</span>;

<span style="color: #008000;">// create a Text &amp; Numeric dataset</span>
dataset <span style="color: #000080;">-</span>a vv;
vv<span style="color: #000080;">=</span>data<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">10</span><span style="color: #000000;">)</span>;
vv<span style="color: #000000;">[</span><span style="color: #0000dd;">2</span><span style="color: #000000;">]</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">"Test"</span>;

<span style="color: #008000;">// loose dataset mydata1 is created as result of assignment </span>
mydata1 <span style="color: #000080;">=</span> col<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// Since col(1) is a dataset, so is mydata1</span>
</pre>

  <h2><a name="Getting_and_Setting_SizeGet_dataset_sizeSet_dataset_size"></a><span class="mw-headline">Getting and Setting Size<span class="OIndex" style="display:none">Get dataset size</span><span class="OIndex" style="display:none">Set dataset size</span></span></h2>

  <p>Before Origin 8, you had to use Set and Get command with a dataset name to set and get a dataset's size. In Origin 8 you can use the following two methods:</p>

  <ul>
    <li>GetSize()</li>

    <li>SetSize(int nSize)</li>
  </ul>

  <p>which are part of the <b>vectorbase</b> OriginC class and inherited by a LabTalk dataset. In order to use these methods, you must have a variable of the type Range or type Dataset. For example:</p>
  <pre class="lt" style="font-family:monospace;">
Range a <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; <span style="color: #008000;">// col(1) of active sheet</span>
for<span style="color: #000000;">(</span> int ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span> ; ii <span style="color: #000080;">&lt;=</span> a.<span style="color: #000080;">GetSize</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> ; ii<span style="color: #000080;">++</span> <span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
   if<span style="color: #000000;">(</span> a<span style="color: #000000;">[</span>ii<span style="color: #000000;">]</span> <span style="color: #000080;">&lt;</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">)</span>
     type <span style="color: #ff00ff;">"Row $(ii) is negative"</span>;
<span style="color: #000000;">}</span>
</pre>

  <p>You cannot use these methods on a dataset name directly:</p>
  <pre class="lt" style="font-family:monospace;">
temp <span style="color: #000080;">=</span> col<span style="color: #000000;">(</span>a<span style="color: #000000;">)</span>;
i <span style="color: #000080;">=</span> temp.<span style="color: #000080;">GetSize</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// error, cannot do this</span>
i <span style="color: #000080;">=</span>;<span style="color: #008000;">// should produce --</span>
</pre>

  <p>Instead, declare a Dataset object first:</p>
  <pre class="lt" style="font-family:monospace;">
Dataset temp <span style="color: #000080;">=</span> col<span style="color: #000000;">(</span>a<span style="color: #000000;">)</span>;
<span style="color: #008000;">// If the dataset is too small</span>
if<span style="color: #000000;">(</span> temp.<span style="color: #000080;">GetSize</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000080;">&lt;</span> <span style="color: #0000dd;">50</span> <span style="color: #000000;">)</span>
   <span style="color: #008000;">// make it bigger</span>
   temp.<span style="color: #000080;">SetSize</span><span style="color: #000000;">(</span><span style="color: #0000dd;">366</span><span style="color: #000000;">)</span>;
</pre>

  <h2><a name="Accessing_DatasetsAccessing_Dataset"></a><span class="mw-headline">Accessing Datasets<span class="OIndex" style="display:none">Accessing Dataset</span></span></h2>

  <p>Datasets in Worksheets and in Matrices can be accessed by the following means:</p>

  <ol>
    <li>Range Variables</li>

    <li>Col() or Mat() function and WCol() function</li>

    <li>Cell() function</li>

    <li>Substitution Notation</li>

    <li>Dataset name</li>
  </ol>

  <h3><a name="Range_Variables"></a><span class="mw-headline">Range Variables</span></h3>

  <p>Range variables can be used to access data in worksheets, graphs, and matrices.</p>

  <h4><a name="For_Worksheet_Data"></a><span class="mw-headline">For Worksheet Data</span></h4>
  <pre class="lt" style="font-family:monospace;">
string strBk<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Book2;
string strSh<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Sheet3;
range rDa <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>strBk<span style="color: #000080;">$</span><span style="color: #000000;">]</span>strSh<span style="color: #000080;">$!</span>col<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span>;  <span style="color: #008000;">// This is a data range</span>
range rSh <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>strBk<span style="color: #000080;">$</span><span style="color: #000000;">]</span>strSh<span style="color: #000080;">$!</span>;        <span style="color: #008000;">// This is a sheet range</span>
rDa <span style="color: #000080;">=</span> <span style="color: #000000;">{</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">30</span><span style="color: #000000;">}</span>; <span style="color: #008000;">// data generation from 1 to 30 increment 1</span>
<span style="color: #008000;">// Use properties of a sheet range/object</span>
if<span style="color: #000000;">(</span>rSh.<span style="color: #000080;">ncols</span> <span style="color: #000080;">&lt;</span> <span style="color: #0000dd;">10</span><span style="color: #000000;">)</span> 
   <span style="color: #008000;">// adding more columns can be simply done like this</span>
   rSh.<span style="color: #000080;">nCols</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span>; 
loop<span style="color: #000000;">(</span>ii,<span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">10</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
<span style="color: #008000;">// re-assign range programmatically </span>
range rDb <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>strBk<span style="color: #000080;">$</span><span style="color: #000000;">]</span>strSh<span style="color: #000080;">$!</span>wcol<span style="color: #000000;">(</span>ii<span style="color: #000000;">)</span>; 
    rDb <span style="color: #000080;">=</span> normal<span style="color: #000000;">(</span><span style="color: #0000dd;">30</span><span style="color: #000000;">)</span>;
    rDb <span style="color: #000080;">+</span><span style="color: #000080;">=</span> rDa;
<span style="color: #000000;">}</span>
</pre>

  <h4><a name="For_Plotted_.28Graph.29_Data"></a><span class="mw-headline">For Plotted (Graph) Data</span></h4>

  <p>You can get various ranges from plotted data as well.</p>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">// Get range ( [Book]Sheet!col ) of third dataplot in active layer</span>
range <span style="color: #000080;">-</span>w rngData <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>; 
<span style="color: #008000;">// Gets the Page (Book) range of the data</span>
range rngBook <span style="color: #000080;">=</span> rngData.<span style="color: #000080;">GetPage</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000080;">$</span>; 
<span style="color: #008000;">// Gets the Layer (Sheet) range of the data</span>
range rngSheet <span style="color: #000080;">=</span> rngData.<span style="color: #000080;">GetLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000080;">$</span>;
</pre>

  <h4><a name="For_Matrix_Data"></a><span class="mw-headline">For Matrix Data</span></h4>

  <p>Similarily, you can access Matrix object with a Range variable and matrix elements by [<i>rowNumber</i>, <i>colNumber</i>].</p>
  <pre class="lt" style="font-family:monospace;">
range ml<span style="color: #000080;">=</span><span style="color: #000000;">[</span>MBook1<span style="color: #000000;">]</span>MSheet1<span style="color: #000080;">!</span>;   <span style="color: #008000;">// This is a sheet range</span>
range mm<span style="color: #000080;">=</span><span style="color: #000000;">[</span>MBook1<span style="color: #000000;">]</span>MSheet1<span style="color: #000080;">!</span><span style="color: #0000dd;">1</span>;  <span style="color: #008000;">// This is a data range, 1st Matrix obj</span>
<span style="color: #008000;">// Access sheet property - number of columns</span>
loop<span style="color: #000000;">(</span>i,<span style="color: #0000dd;">1</span>,ml.<span style="color: #000080;">ncols</span><span style="color: #000000;">)</span>          
<span style="color: #000000;">{</span>
<span style="color: #008000;">// Access sheet property - number of rows    </span>
loop<span style="color: #000000;">(</span>j, <span style="color: #0000dd;">1</span>, ml.<span style="color: #000080;">nrows</span><span style="color: #000000;">)</span>       
    <span style="color: #000000;">{</span>
        mm<span style="color: #000000;">[</span>i,j<span style="color: #000000;">]</span> <span style="color: #000080;">=</span> sin<span style="color: #000000;">(</span>pi<span style="color: #000080;">*</span>i<span style="color: #000080;">/</span><span style="color: #0000dd;">180</span><span style="color: #000000;">)</span> <span style="color: #000080;">-</span> cos<span style="color: #000000;">(</span>pi<span style="color: #000080;">*</span>j<span style="color: #000080;">/</span><span style="color: #0000dd;">180</span><span style="color: #000000;">)</span>;
    <span style="color: #000000;">}</span>
<span style="color: #000000;">}</span>
</pre>

  <p>Besides, a matrix can be treated as a single-dimensional array using row major ordering, and you can access a matrix value by:</p>

  <dl>
    <dd>MatrixObject[<i>N*(i - 1) + j</i>]</dd>
  </dl>

  <p>where <i>N</i> is the number of columns in the matrix, and <i>i</i> and <i>j</i> is the row and column number. So for a 4 rows by 5 columns matrix, using [2, 3] and [8] returns the same cell. For example:</p>
  <pre class="lt" style="font-family:monospace;">
range mm <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>MBook1<span style="color: #000000;">]</span>MSheet1<span style="color: #000080;">!</span>Mat<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>;
if<span style="color: #000000;">(</span>mm<span style="color: #000000;">[</span><span style="color: #0000dd;">2</span>, <span style="color: #0000dd;">3</span><span style="color: #000000;">]</span> <span style="color: #000080;">==</span> mm<span style="color: #000000;">[</span><span style="color: #0000dd;">8</span><span style="color: #000000;">]</span><span style="color: #000000;">)</span> 
        ty <span style="color: #ff00ff;">"They are the same!"</span>;
</pre>

  <h3><a name="By_Col.28.29.2C_Mat.28.29.2C_and_WCol.28.29_function"></a><span class="mw-headline">By Col(), Mat(), and WCol() function</span></h3>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">// Require an active sheet</span>
<span style="color: #008000;">// Here, the win -o command is used to temporarily switch books and set</span>
string strBk<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Book5;
string strSh<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Sheet2;
win <span style="color: #000080;">-</span>o strBk<span style="color: #000080;">$</span>
<span style="color: #000000;">{</span>
   temp <span style="color: #000080;">=</span> page.<span style="color: #000080;">active</span>;       <span style="color: #008000;">// remember the active sheet</span>
   page.<span style="color: #000080;">active</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> strSh<span style="color: #000080;">$</span>;
   <span style="color: #008000;">// col( ) function can take a column number (1..n)</span>
   col<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span> <span style="color: #000080;">=</span> <span style="color: #000000;">{</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">30</span><span style="color: #000000;">}</span>;          
   loop<span style="color: #000000;">(</span>ii,<span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">10</span><span style="color: #000000;">)</span>
   <span style="color: #000000;">{</span>
      <span style="color: #008000;">// wcol( ) takes column number or an integer variable</span>
      wcol<span style="color: #000000;">(</span>ii<span style="color: #000000;">)</span> <span style="color: #000080;">=</span> normal<span style="color: #000000;">(</span><span style="color: #0000dd;">30</span><span style="color: #000000;">)</span>; 
      <span style="color: #008000;">// col( ) function can also take a Short Name</span>
      wcol<span style="color: #000000;">(</span>ii<span style="color: #000000;">)</span> <span style="color: #000080;">+</span><span style="color: #000080;">=</span> col<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span>;    
   <span style="color: #000000;">}</span>
   page.<span style="color: #000080;">active</span> <span style="color: #000080;">=</span> temp;     <span style="color: #008000;">// Restore the originally active sheet</span>
<span style="color: #000000;">}</span>                          
<span style="color: #008000;">// Exit 'win -o', returning to previously active window</span>

<span style="color: #008000;">// For a matrix, the Mat( ) function serves as an analog to the Col( ) </span>
<span style="color: #008000;">// function, and matrix objects are analogous to column numbers.</span>

<span style="color: #008000;">// Fill the second matrix object in the active matrixsheet</span>
Mat<span style="color: #000000;">(</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span> <span style="color: #000080;">=</span> Data<span style="color: #000000;">(</span><span style="color: #0000dd;">100</span>,<span style="color: #0000dd;">1024</span>,.01<span style="color: #000000;">)</span>;
<span style="color: #008000;">// Set row 12, col 5 in first matrix object of active matrixsheet:</span>
Mat<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span><span style="color: #000000;">[</span><span style="color: #0000dd;">12</span>,<span style="color: #0000dd;">5</span><span style="color: #000000;">]</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">125</span>;
</pre>

  <h3><a name="Cell_FunctionCell_Function"></a><span class="mw-headline">Cell Function<span class="OIndex" style="display:none">Cell Function</span></span></h3>

  <p>The Cell( ) function can be used with either a worksheet or a matrix. When referring to a non-active book, this notation will only support the bookname! prefix for the active sheet.</p>
  <pre class="lt" style="font-family:monospace;">
cell<span style="color: #000000;">(</span><span style="color: #0000dd;">5</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">)</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">50</span>; <span style="color: #008000;">// Sets row 5, column 2 cell in active window </span>
                <span style="color: #008000;">//(worksheet or matrix) to 50</span>
<span style="color: #008000;">// You can use prefix for different active page, </span>
<span style="color: #008000;">// but target is still the active sheet in that page</span>

<span style="color: #008000;">// Sets row 10, column 1 in active sheet of Book5 to 100</span>
Book5<span style="color: #000080;">!</span>cell<span style="color: #000000;">(</span><span style="color: #0000dd;">10</span>,<span style="color: #0000dd;">1</span><span style="color: #000000;">)</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">100</span>; 
<span style="color: #008000;">// Function accepts variables</span>
for<span style="color: #000000;">(</span>ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span> ; ii <span style="color: #000080;">&lt;=</span> <span style="color: #0000dd;">32</span> ; ii<span style="color: #000080;">++</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
    for<span style="color: #000000;">(</span>jj <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span> ; jj <span style="color: #000080;">&lt;=</span> <span style="color: #0000dd;">32</span> ; jj<span style="color: #000080;">++</span><span style="color: #000000;">)</span>
    <span style="color: #000000;">{</span>
        MBook1<span style="color: #000080;">!</span>cell<span style="color: #000000;">(</span>ii,jj<span style="color: #000000;">)</span> <span style="color: #000080;">=</span> <span style="color: #000000;">(</span>ii<span style="color: #000080;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span> <span style="color: #000080;">*</span> <span style="color: #0000dd;">32</span> <span style="color: #000080;">+</span> jj;
    <span style="color: #000000;">}</span>
<span style="color: #000000;">}</span>
</pre>

  <h3><a name="Substitution_Notation"></a><span class="mw-headline">Substitution Notation</span></h3>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">// This notation accepts book name and sheet name </span>
<span style="color: #008000;">//to access data directly :</span>
<span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000000;">[</span>Book2<span style="color: #000000;">]</span>Sheet3,<span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">1</span><span style="color: #000000;">)</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">100</span>;
<span style="color: #008000;">// but does not resolve to active sheet of named book :</span>
<span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000000;">[</span>Book2<span style="color: #000000;">]</span>,<span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">1</span><span style="color: #000000;">)</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span>; <span style="color: #008000;">// THIS PRODUCES A COMMAND ERROR</span>
<span style="color: #008000;">// unless we just use the page name, as in :</span>
<span style="color: #000080;">%</span><span style="color: #000000;">(</span>Book2,<span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">1</span><span style="color: #000000;">)</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span>;   <span style="color: #008000;">// Use active sheet of Book2</span>
<span style="color: #008000;">// or :</span>
<span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000080;">%</span>H,<span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">1</span><span style="color: #000000;">)</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;       <span style="color: #008000;">// Uses active sheet of active window</span>
<span style="color: #008000;">// Substitution works before execution, so you can do things like:</span>
<span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000000;">[</span>Book2<span style="color: #000000;">]</span>Sheet1,<span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">1</span><span style="color: #000000;">)</span> <span style="color: #000080;">+</span> <span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000000;">[</span>Book2<span style="color: #000000;">]</span>Sheet2,<span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">1</span><span style="color: #000000;">)</span> <span style="color: #000080;">+</span> <span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000000;">[</span>Book2<span style="color: #000000;">]</span>Sheet3,<span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">1</span><span style="color: #000000;">)</span><span style="color: #000080;">=</span>;
val <span style="color: #000080;">=</span> <span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000000;">[</span>Book2<span style="color: #000000;">]</span>Sheet1,<span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">1</span><span style="color: #000000;">)</span> <span style="color: #000080;">+</span> <span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000000;">[</span>Book2<span style="color: #000000;">]</span>Sheet2,<span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">)</span> <span style="color: #000080;">+</span> <span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000000;">[</span>Book2<span style="color: #000000;">]</span>Sheet3,<span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">3</span><span style="color: #000000;">)</span>;
type <span style="color: #ff00ff;">"Cross-sheet sum \x3D $(val)"</span>;
</pre>

  <p>For other Substitution Notation, please see <a href="../../LabTalk/Category/Substitution_Notation.html" title="Category:Substitution Notation">Substitution Notation</a> .</p>

  <h3><a name="By_Dataset_Name"></a><span class="mw-headline">By Dataset Name</span></h3>

  <p>This is the oldest notation in LabTalk and should not be used unless you have to maintain old LabTalk code, or when you know the workbook has only one sheet or you are working with loose datasets.</p>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">// Dataset Name</span>
<span style="color: #008000;">// Using the formal name of a dataset :</span>
<span style="color: #008000;">// PageName_ColumnName[@SheetIndex]</span>
<span style="color: #008000;">// Where PageName and ColumnName are the Short Name </span>
<span style="color: #008000;">// and SheetIndex is a creation order index</span>
<span style="color: #008000;">// (SheetIndex is not the order of the sheet tabs in the window)</span>
Book1_B <span style="color: #000080;">=</span> Uniform<span style="color: #000000;">(</span><span style="color: #0000dd;">100</span><span style="color: #000000;">)</span>;   <span style="color: #008000;">// Can fill datasets</span>
Book1_B@2 <span style="color: #000080;">=</span> Data<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">365</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">// Same book and same column name, but on the</span>
                          <span style="color: #008000;">// second sheet</span>
July_Week1@3<span style="color: #000000;">[</span><span style="color: #0000dd;">5</span><span style="color: #000000;">]</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Sell;  <span style="color: #008000;">// Can access a particular row element</span>
                          <span style="color: #008000;">// (5th row of column 'Week1' on sheetindex </span>
                          <span style="color: #008000;">// 3 in book 'July')</span>
BSmith <span style="color: #000080;">=</span> <span style="color: #0000dd;">6</span>;
ChemLab_Grade@3<span style="color: #000000;">[</span>BSmith<span style="color: #000000;">]</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">86</span>; 
     <span style="color: #008000;">// Can use a variable to access row </span>
     <span style="color: #008000;">//(6th row of 'Grade' in third sheet of 'ChemLab')</span>
</pre>

  <h2><a name="Accessing_Dataset_Storage"></a><span class="mw-headline">Accessing Dataset Storage</span></h2>

  <p>Beginning with Origin 2018b, there is LabTalk access to dataset Storage. Utility is limited at this time but will be expanded upon in later versions.</p>

  <p>Prefix a dataset name with</p>
  <pre class="lt" style="font-family:monospace;">
dataset.
</pre>

  <p>For example:</p>
  <pre class="lt" style="font-family:monospace;">
dataset.<span style="color: #000080;">Book1_B</span>.<span style="color: #000080;">info</span>.<span style="color: #000080;">=</span>; <span style="color: #008000;">// returns information about content in the info. area of the dataset</span>
dataset.<span style="color: #000080;">Book1_B</span>.<span style="color: #000080;">info</span>.<span style="color: #000080;">Add</span><span style="color: #000000;">(</span>Something<span style="color: #000000;">)</span>; <span style="color: #008000;">// adds storage object "Something" to the dataset</span>
dataset.<span style="color: #000080;">Book1_B</span>.<span style="color: #000080;">info</span>.<span style="color: #000080;">Remove</span><span style="color: #000000;">(</span>Something<span style="color: #000000;">)</span>; <span style="color: #008000;">// deletes storage object "Something" from the dataset</span>
</pre>

  <h2><a name="Masking_Cells"></a><span class="mw-headline">Masking Cells</span></h2>

  <p><span class="OIndex" style="display:none">Mask Cell</span>Cells in worksheet columns and matrixsheets can be masked by setting</p>

  <dl>
    <dd>dataset&lt;<i>index</i>&gt; = 1</dd>
  </dl>

  <p>For example:</p>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">// Masking the cell 3 in column A</span>
col<span style="color: #000000;">(</span>a<span style="color: #000000;">)</span><span style="color: #000080;">&lt;</span><span style="color: #0000dd;">3</span><span style="color: #000080;">&gt;</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
<span style="color: #008000;">// Mask a cell in matrix</span>
range rr <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>mbook1<span style="color: #000000;">]</span>msheet1<span style="color: #000080;">!</span>mat<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>;
rr<span style="color: #000080;">&lt;</span><span style="color: #0000dd;">2</span><span style="color: #000080;">&gt;</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;

<span style="color: #008000;">// Unmask a cell</span>
col<span style="color: #000000;">(</span>a<span style="color: #000000;">)</span><span style="color: #000080;">&lt;</span><span style="color: #0000dd;">3</span><span style="color: #000080;">&gt;</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
</pre>

  <p>For matrix, you can also use &lt;row, col&gt; to specify a cell:</p>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">// Mask the 2nd row, 3rd column of current matrixsheet</span>
<span style="color: #000080;">%</span>C<span style="color: #000080;">&lt;</span><span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">3</span><span style="color: #000080;">&gt;</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
<span style="color: #008000;">// Mask the whole 2nd row of the current matrixsheet</span>
<span style="color: #000080;">%</span>C<span style="color: #000080;">&lt;</span><span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">0</span><span style="color: #000080;">&gt;</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
<span style="color: #008000;">// Mask the whole 3rd column of the current matrixsheet</span>
<span style="color: #000080;">%</span>C<span style="color: #000080;">&lt;</span><span style="color: #0000dd;">0</span>,<span style="color: #0000dd;">3</span><span style="color: #000080;">&gt;</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
</pre>

  <p>To mask a specified range, please see the <a href="../../LabTalk/LabTalk/Mark_(command).html" title="LabTalk:Mark (command)">mark command</a>.</p>

  <h2><a name="Set_Column_Values_with_a_Dataset"></a><span class="mw-headline">Set Column Values with a Dataset</span></h2>

  <p class="version">Minimum Origin Version Required: 9.0 SR0</p>

  <p>You can generate a dataset of certain size with a formula and some before formula script, and later assign this dataset to a certain column. The syntax is:</p>

  <p><i>dataset</i>.setvalues("<i>Formula</i>", "<i>Before formula script", "</i>From<i>", "</i>To<i>")</i></p>

  <p>In the <i>Formula</i> you could call functions like in the <a class="external text" href="../../UserGuide/UserGuide/Menu_Options_and_Dialog_Controls.html#F.28x.29_Menu">F(x) menu of set column values dialog</a>.</p>

  <p>An example is shown as following:</p>
  <pre class="lt" style="font-family:monospace;">
newbook;
wks.<span style="color: #000080;">addcol</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
dataset ds1,ds2,ds3;<span style="color: #008000;">//Define three dataset objects</span>
<span style="color: #008000;">//Set values for each object. </span>
ds1.<span style="color: #000080;">setvalues</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"i+grnd()"</span>,<span style="color: #ff00ff;">""</span>,<span style="color: #ff00ff;">"1"</span>,<span style="color: #ff00ff;">"20"</span><span style="color: #000000;">)</span>;
ds2.<span style="color: #000080;">setvalues</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"sin(i)"</span>,<span style="color: #ff00ff;">""</span>,<span style="color: #ff00ff;">"1"</span>,<span style="color: #ff00ff;">"20"</span><span style="color: #000000;">)</span>;
ds3.<span style="color: #000080;">setvalues</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"col(1)*col(2)"</span>,<span style="color: #ff00ff;">"col(1)=ds1;col(2)=ds2;"</span>,<span style="color: #ff00ff;">"1"</span>,<span style="color: #ff00ff;">"20"</span><span style="color: #000000;">)</span>;
<span style="color: #008000;">//Use ds3 dataset as the value of column 3</span>
col<span style="color: #000000;">(</span><span style="color: #0000dd;">3</span><span style="color: #000000;">)</span><span style="color: #000080;">=</span>ds3;
</pre>

  <p>Note that the <b>setvalues</b> method of a dataset does not support recalculate options. For that, see the <a class="external text" href="../../XFunction/X-Function/Csetvalue.html"><b>csetvalue</b></a> X-Function.</p>

  <h2><a name="Using_Loose_Datasets_in_X-FunctionsLoose_Dataset.2C_X-FunctionX-Function.2C_Loose_Dataset"></a><span class="mw-headline">Using Loose Datasets in X-Functions<span class="OIndex" style="display:none">Loose Dataset, X-Function</span><span class="OIndex" style="display:none">X-Function, Loose Dataset</span></span></h2>

  <p>Loose datasets are more efficient to use in a LabTalk script since they do not have the overhead of a column in a worksheet. If used inside a scope, they are also cleaned up automatically when the scope ends. For example, declare a loose dataset <i>missingvals</i>, and then use the <a class="external text" href="../../XFunction/X-Function/Vfind.html"><b>vfind</b> X-Function</a> to assign row-numbers of missing values in column 1 (of the active worksheet) to it:</p>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">// Declare a loose dataset</span>
dataset  missingvals;
<span style="color: #008000;">// Call vFind X-Function to find row numbers</span>
<span style="color: #008000;">// where missing values appear in col 1</span>
vfind ix<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> value<span style="color: #000000;">:</span><span style="color: #000080;">=</span>NANUM ox<span style="color: #000000;">:</span><span style="color: #000080;">=</span>missingvals;
<span style="color: #008000;">// Access missingvals for results</span>
for<span style="color: #000000;">(</span>int ii<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>; ii<span style="color: #000080;">&lt;=</span>missingvals.<span style="color: #000080;">GetSize</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; ii<span style="color: #000080;">++</span><span style="color: #000000;">)</span>
   type <span style="color: #000080;">$</span><span style="color: #000000;">(</span>missingvals<span style="color: #000000;">[</span>ii<span style="color: #000000;">]</span><span style="color: #000000;">)</span>;
</pre>

  <p>Many X-Functions produce outputs in the form of a <a href="../../LabTalk/LabTalk/Data_Types_and_Variables.html#Tree" title="LabTalk:Data Types and Variables">tree</a> and some of the tree nodes can be vectors. To access such a vector, you need to copy it to a dataset. You may directly put the tree vector into a column, but if the vector is used in subsequent calculations, it is more efficent to use a loose dataset.</p>
