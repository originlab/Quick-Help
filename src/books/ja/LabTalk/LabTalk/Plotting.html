<h1 class="firstheading">一般的なグラフ作成のサンプル</h1>

  <p class='urlname' style='display: none'>グラフ作成</p>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>目次</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1">
        <a href="#LabTalk_Plotting_Examples"><span class="tocnumber">1</span> <span class="toctext">LabTalkによるグラフ作成のサンプル</span></a>

        <ul>
          <li class="toclevel-2 tocsection-2"><a href="#plotgroup"><span class="tocnumber">1.1</span> <span class="toctext">plotgroup（グループ化変数に従った作図）</span></a></li>

          <li class="toclevel-2 tocsection-3"><a href="#plotmatrix"><span class="tocnumber">1.2</span> <span class="toctext">plotmatrix（散布図行列を作図）</span></a></li>

          <li class="toclevel-2 tocsection-4"><a href="#plotstack"><span class="tocnumber">1.3</span> <span class="toctext">plotstack（積み上げグラフを作図）</span></a></li>

          <li class="toclevel-2 tocsection-5"><a href="#plotxy"><span class="tocnumber">1.4</span> <span class="toctext">plotxy（折れ線や散布図など基本的な2Dグラフを作図）</span></a></li>

          <li class="toclevel-2 tocsection-6"><a href="#plotxyz"><span class="tocnumber">1.5</span> <span class="toctext">plotxyz（XYZデータから3Dグラフを作図）</span></a></li>

          <li class="toclevel-2 tocsection-7"><a href="#plotm"><span class="tocnumber">1.6</span> <span class="toctext">plotm</span></a></li>

          <li class="toclevel-2 tocsection-8"><a href="#plot_3D_box_and_sphere_using_plotm"><span class="tocnumber">1.7</span> <span class="toctext">plotmを使用して3Dボックスと球体を作図</span></a></li>

          <li class="toclevel-2 tocsection-9"><a href="#plotpClamp"><span class="tocnumber">1.8</span> <span class="toctext">plotpClamp</span></a></li>
        </ul>
      </li>
    </ul>
  </div>

  <h2><a name="LabTalk_Plotting_Examples"></a><span class="mw-headline">LabTalkによるグラフ作成のサンプル</span></h2>

  <h3><a name="plotgroup"></a><span class="mw-headline">plotgroup（グループ化変数に従った作図）</span></h3>

  <p>グループ化変数(データセット)に従って、 plotgroupはページ毎、レイヤ毎、データプロット毎でグループ化したプロットを作成します。正しく動作させるには、最初にワークシートをグラフグループデータでソートし、次にレイヤグループデータ、最後にデータプロットグループデータでソートします。</p>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000; font-style: regular;">/*
このサンプルではグループでプロットする方法を示します
サンプルデータは、Originインストールフォルダの\Samples\Statistics\body.datです。
1.サンプルデータをロード
2.ワークシートをソート
3.グラフを作図
*/</span>
<span style="color: #008000;">// サンプルデータを取得</span>
fn<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Statistics\body.dat&quot;</span>;
newbook;
impASC fn<span style="color: #000080;">$</span>;
<span style="color: #008000;">// ワークシートをソート - この工程はとても重要</span>
wsort bycol<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span>;
<span style="color: #008000;">// グループごとにプロット</span>
plotgroup iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">(</span><span style="color: #0000dd;">4</span>,<span style="color: #0000dd;">5</span><span style="color: #000000;">)</span> pgrp<span style="color: #000000;">:</span><span style="color: #000080;">=</span>Col<span style="color: #000000;">(</span><span style="color: #0000dd;">3</span><span style="color: #000000;">)</span>;
 
<span style="color: #008000; font-style: regular;">/* 次のサンプルでは、1つのグループをもとにしたグラフウィンドウを作成し、
2つ目のグループをもとにしたグラフレイヤを作成します*/</span>
<span style="color: #008000;">// サンプルデータを開く</span>
fn<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Graphing\Categorical Data.dat&quot;</span>;
newbook;
impASC fn<span style="color: #000080;">$</span>;
<span style="color: #008000;">// ソート</span>
dataset sortcol <span style="color: #000080;">=</span> <span style="color: #000000;">{</span><span style="color: #0000dd;">4</span>,<span style="color: #0000dd;">3</span><span style="color: #000000;">}</span>; <span style="color: #008000;">// drug、genderの順に</span>
dataset sortord <span style="color: #000080;">=</span> <span style="color: #000000;">{</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">1</span><span style="color: #000000;">}</span>; <span style="color: #008000;">// 昇順でソート</span>
wsort nest<span style="color: #000000;">:</span><span style="color: #000080;">=</span>sortcol ord<span style="color: #000000;">:</span><span style="color: #000080;">=</span>sortord;
<span style="color: #008000;">// 性別ごとにレイヤを分けて、各薬のグラフを作成</span>
plotgroup iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">(</span><span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">1</span><span style="color: #000000;">)</span> pgrp<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">(</span>drug<span style="color: #000000;">)</span> lgrp<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">(</span>gender<span style="color: #000000;">)</span>;
</pre>

  <p>Note: 各グループ変数は任意です。例えば、ページグループとデータグループを省略することで、レイヤ内のデータを統合する1つのグループ変数を使うことができます。使用するオプションがどれであっても同じソート順にすることが重要です。</p>

  <h3><a name="plotmatrix"></a><span class="mw-headline">plotmatrix（散布図行列を作図）</span></h3>

  <p>plotmatrixは、散布図行列を作図します。各データをYとし、Y以外のデータを対応するXデータとして作図していきます。グラフはワークシートのグリッドに作図されます。信頼楕円を含めたり、各グラフで線形フィットしたり、相関係数をレポートするオプションがあります。</p>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">// 指定したワークシートの列2、3、5を使用して散布図行列を作図</span>
newbook na<span style="color: #000000;">:</span><span style="color: #000080;">=</span>PlotMatrixEX op<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
wo <span style="color: #000080;">-</span>a <span style="color: #0000dd;">3</span>;   <span style="color: #008000;">// 3列追加</span>
col<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span><span style="color: #000080;">=</span>data<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">30</span><span style="color: #000000;">)</span>;
col<span style="color: #000000;">(</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span><span style="color: #000080;">=</span>uniform<span style="color: #000000;">(</span><span style="color: #0000dd;">30</span><span style="color: #000000;">)</span>;
col<span style="color: #000000;">(</span><span style="color: #0000dd;">3</span><span style="color: #000000;">)</span><span style="color: #000080;">=</span>normal<span style="color: #000000;">(</span><span style="color: #0000dd;">30</span><span style="color: #000000;">)</span>;
col<span style="color: #000000;">(</span><span style="color: #0000dd;">4</span><span style="color: #000000;">)</span><span style="color: #000080;">=</span>uniform<span style="color: #000000;">(</span><span style="color: #0000dd;">30</span><span style="color: #000000;">)</span>;
col<span style="color: #000000;">(</span><span style="color: #0000dd;">5</span><span style="color: #000000;">)</span><span style="color: #000080;">=</span>col<span style="color: #000000;">(</span><span style="color: #0000dd;">3</span><span style="color: #000000;">)</span>;
plotmatrix
  irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span>PlotMatrixEX<span style="color: #000000;">]</span>Sheet1<span style="color: #000080;">!</span><span style="color: #000000;">(</span><span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">3</span>,<span style="color: #0000dd;">5</span><span style="color: #000000;">)</span>
  ellipse<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>
  conflevel<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">50</span>
  fit<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
 
<span style="color: #008000;">// データとグラフのためのシートを持つ新しいブックを作成</span>
<span style="color: #008000;">// ソースブックの全シートの列1と2の散布図行列データを</span>
<span style="color: #008000;">// 集めるためにこのブックを使用する</span>
newbook na<span style="color: #000000;">:</span><span style="color: #000080;">=</span>PMEx2 op<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
repeat <span style="color: #0000dd;">3</span> newsheet;
loop<span style="color: #000000;">(</span>ii,<span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">4</span><span style="color: #000000;">)</span> <span style="color: #000000;">{</span>
    page.<span style="color: #000080;">active</span> <span style="color: #000080;">=</span> ii;     <span style="color: #008000;">// 各シートで繰り返す</span>
    col<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span> <span style="color: #000080;">=</span> uniform<span style="color: #000000;">(</span><span style="color: #0000dd;">25</span><span style="color: #000000;">)</span>;
    col<span style="color: #000000;">(</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span> <span style="color: #000080;">=</span> uniform<span style="color: #000000;">(</span><span style="color: #0000dd;">25</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span>
for<span style="color: #000000;">(</span> ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span> ; ii <span style="color: #000080;">&lt;=</span> <span style="color: #0000dd;">4</span> ; ii<span style="color: #000080;">++</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
  range rData <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>PMEx2<span style="color: #000000;">]</span><span style="color: #000080;">$</span><span style="color: #000000;">(</span>ii<span style="color: #000000;">)</span><span style="color: #000080;">!</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">)</span>;
  plotmatrix
  irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span>rData
  ellipse<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>
  conflevel<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">50</span>
  fit<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>
  rd<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span>STATS<span style="color: #000000;">]</span>MyScatterData
  rt<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span>STATS<span style="color: #000000;">]</span>MyScatterGraphs;
<span style="color: #000000;">}</span>
</pre>

  <h3><a name="plotstack"></a><span class="mw-headline">plotstack（積み上げグラフを作図）</span></h3>

  <p>plotstackは、複数データセットから積み上げグラフを作成します。</p>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">// サンプルデータを開く</span>
newbook;
string fn<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Graphing\Linked Layers 1.dat&quot;</span>;
impasc fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>fn<span style="color: #000080;">$</span>;
<span style="color: #000080;">%</span>N <span style="color: #000080;">=</span> <span style="color: #000080;">%</span>H;
<span style="color: #008000;">// 全列対列1の積み上げグラフを作図</span>
plotstack iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">:</span>end<span style="color: #000000;">)</span> plottype<span style="color: #000000;">:</span><span style="color: #000080;">=</span>line link<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> xlink<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;

<span style="color: #008000;">// 列2対列1および列4対列3の積み上げグラフを作図</span>
win <span style="color: #000080;">-</span>a <span style="color: #000080;">%</span>N;
plotstack iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">(</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">)</span>, <span style="color: #000000;">(</span><span style="color: #0000dd;">3</span>,<span style="color: #0000dd;">4</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span> plottype<span style="color: #000000;">:</span><span style="color: #000080;">=</span>column link<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;

<span style="color: #008000;">// 使用するテンプレート指定可能。ただし、データセットごとに</span>
<span style="color: #008000;">// テンプレートのインスタンスをロードするので、単一レイヤのテンプレートを使用</span>
<span style="color: #008000;">// スタイルフォルダを使用するためには、テンプレートに適応したプロットタイプを指定</span>
win <span style="color: #000080;">-</span>a <span style="color: #000080;">%</span>N;
plotstack iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">(</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">)</span>,<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">3</span><span style="color: #000000;">)</span>,<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">4</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span> plottype<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span> template<span style="color: #000000;">:</span><span style="color: #000080;">=</span>column;
</pre>

  <h3><a name="plotxy"></a><span class="mw-headline">plotxy（折れ線や散布図など基本的な2Dグラフを作図）</span></h3>

  <p><a class="external text" href="../../XFunction/X-Function/Plotxy.html">plotxy</a>は、様々なグラフ作図の用途で使用できます。以下が実際のサンプルです。</p>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">// Example 1－4で使用する、6列持つシートが</span>
<span style="color: #008000;">// 3枚あるワークブックを作成</span>
newbook sheet<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span>;
string bkName<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">%</span>H;
loop<span style="color: #000000;">(</span>ii,<span style="color: #0000dd;">1</span>,page.<span style="color: #000080;">nlayers</span><span style="color: #000000;">)</span> <span style="color: #000000;">{</span>
    page.<span style="color: #000080;">active</span> <span style="color: #000080;">=</span> ii;
    wo <span style="color: #000080;">-</span>a <span style="color: #0000dd;">4</span>;
    col<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span> <span style="color: #000080;">=</span> data<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">30</span><span style="color: #000000;">)</span>;
    col<span style="color: #000000;">(</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span> <span style="color: #000080;">=</span> uniform<span style="color: #000000;">(</span><span style="color: #0000dd;">30</span><span style="color: #000000;">)</span>;
    col<span style="color: #000000;">(</span><span style="color: #0000dd;">3</span><span style="color: #000000;">)</span> <span style="color: #000080;">=</span> normal<span style="color: #000000;">(</span><span style="color: #0000dd;">30</span><span style="color: #000000;">)</span>;
    col<span style="color: #000000;">(</span><span style="color: #0000dd;">4</span><span style="color: #000000;">)</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span> <span style="color: #000080;">*</span> col<span style="color: #000000;">(</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span>;
    col<span style="color: #000000;">(</span><span style="color: #0000dd;">5</span><span style="color: #000000;">)</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span> <span style="color: #000080;">*</span> col<span style="color: #000000;">(</span><span style="color: #0000dd;">3</span><span style="color: #000000;">)</span>;
    col<span style="color: #000000;">(</span><span style="color: #0000dd;">6</span><span style="color: #000000;">)</span> <span style="color: #000080;">=</span> col<span style="color: #000000;">(</span><span style="color: #0000dd;">5</span><span style="color: #000000;">)</span> <span style="color: #000080;">/</span> col<span style="color: #000000;">(</span><span style="color: #0000dd;">4</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span>

<span style="color: #008000;">////////// Example 1 ////////////////////////////////////////</span>
<span style="color: #008000;">// アクティブワークシートの3番目のグラフを作成</span>
plotxy <span style="color: #0000dd;">3</span>;
page.<span style="color: #000080;">label</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> plotxy <span style="color: #0000dd;">3</span>;

<span style="color: #008000;">////////// Example 2 ////////////////////////////////////////</span>
<span style="color: #008000;">// アクティブワークシートの列3、4、5を作図t</span>
win <span style="color: #000080;">-</span>a <span style="color: #000080;">%</span><span style="color: #000000;">(</span>bkName<span style="color: #000080;">$</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// plotxyでブックを指定しないので、ブックをアクティブにする</span>
plotxy <span style="color: #0000dd;">3</span><span style="color: #000000;">:</span><span style="color: #0000dd;">5</span>;

<span style="color: #008000;">// Sheet2の列2をXとして、列3、4、5を作図</span>
<span style="color: #008000;">// デフォルトの設定でアクティブグラフウィンドウに新しいグラフレイヤを追加</span>
plotxy <span style="color: #000000;">[</span>bkname<span style="color: #000080;">$</span><span style="color: #000000;">]</span>Sheet2<span style="color: #000080;">!</span><span style="color: #000000;">(</span><span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">3</span><span style="color: #000000;">:</span><span style="color: #0000dd;">5</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// plotxyでブックとシートをしていするのでアクティブにする必要なし</span>

<span style="color: #008000;">// 2つのレイヤを再編成</span>
layarrange row<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span> col<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> ygap<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">7</span> left<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">12</span> right<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">12</span> top<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">10</span> bottom<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">15</span>;
page.<span style="color: #000080;">label</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> plotxy <span style="color: #0000dd;">3</span><span style="color: #000000;">:</span><span style="color: #0000dd;">5</span> and <span style="color: #000000;">[</span><span style="color: #000080;">%</span><span style="color: #000000;">(</span>bkname<span style="color: #000080;">$</span><span style="color: #000000;">)</span><span style="color: #000000;">]</span>Sheet2<span style="color: #000080;">!</span><span style="color: #000000;">(</span><span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">3</span><span style="color: #000000;">:</span><span style="color: #0000dd;">5</span><span style="color: #000000;">)</span>;

<span style="color: #008000;">////////// Example 3 ////////////////////////////////////////</span>
<span style="color: #008000;">// 次の表記法を使用</span>
<span style="color: #008000;">//    範囲内全てのyを作図 : (?,1:end)</span>
<span style="color: #008000;">//    テンプレートを使ってグラフを作図し名前付け : [&lt;new template:=column.otp name:=MyGraph&gt;]</span>
plotxy <span style="color: #000000;">[</span>bkname<span style="color: #000080;">$</span><span style="color: #000000;">]</span>Sheet3<span style="color: #000080;">!</span><span style="color: #000000;">(</span>?,<span style="color: #0000dd;">1</span><span style="color: #000000;">:</span>end<span style="color: #000000;">)</span> pl<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">230</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span><span style="color: #000080;">&lt;</span>new template<span style="color: #000000;">:</span><span style="color: #000080;">=</span>column.<span style="color: #000080;">otp</span> name<span style="color: #000000;">:</span><span style="color: #000080;">=</span>MyGraph<span style="color: #000080;">&gt;</span><span style="color: #000000;">]</span>;
page.<span style="color: #000080;">label</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> plotxy <span style="color: #000000;">[</span><span style="color: #000080;">%</span><span style="color: #000000;">(</span>bkname<span style="color: #000080;">$</span><span style="color: #000000;">)</span><span style="color: #000000;">]</span>Sheet3<span style="color: #000080;">!</span><span style="color: #000000;">(</span>?,<span style="color: #0000dd;">1</span><span style="color: #000000;">:</span>end<span style="color: #000000;">)</span> pl<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">230</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span><span style="color: #000080;">&lt;</span>new template<span style="color: #000000;">:</span><span style="color: #000080;">=</span>column.<span style="color: #000080;">otp</span><span style="color: #000080;">&gt;</span><span style="color: #000000;">]</span>;

<span style="color: #008000;">////////// Example 4 ////////////////////////////////////////</span>
<span style="color: #008000;">// 変数を使用可能</span>
win <span style="color: #000080;">-</span>a <span style="color: #000080;">%</span><span style="color: #000000;">(</span>bkname<span style="color: #000080;">$</span><span style="color: #000000;">)</span>;
range rSheet <span style="color: #000080;">=</span> <span style="color: #000080;">$</span><span style="color: #000000;">(</span>page.<span style="color: #000080;">active</span><span style="color: #000000;">)</span><span style="color: #000080;">!</span>;
range rPage <span style="color: #000080;">=</span> rSheet.<span style="color: #000080;">GetPage</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000080;">$</span>;
for<span style="color: #000000;">(</span> ix <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span> ; ix <span style="color: #000080;">&lt;</span> int<span style="color: #000000;">(</span>rSheet.<span style="color: #000080;">NCOLS</span><span style="color: #000000;">)</span> ; ix <span style="color: #000080;">+</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span> <span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
   plotxy <span style="color: #000000;">[</span><span style="color: #000080;">%</span><span style="color: #000000;">(</span>rPage.<span style="color: #000080;">name</span><span style="color: #000080;">$</span><span style="color: #000000;">)</span><span style="color: #000000;">]</span><span style="color: #000080;">%</span><span style="color: #000000;">(</span>rSheet.<span style="color: #000080;">name</span><span style="color: #000080;">$</span><span style="color: #000000;">)</span><span style="color: #000080;">!</span><span style="color: #000000;">(</span><span style="color: #000080;">$</span><span style="color: #000000;">(</span>ix<span style="color: #000000;">)</span>,<span style="color: #000080;">$</span><span style="color: #000000;">(</span>ix<span style="color: #000080;">+</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
<span style="color: #000000;">}</span>

<span style="color: #008000;">// レイヤ内のデータセットをグループ化して自動で色推移</span>
layer <span style="color: #000080;">-</span>g;
page.<span style="color: #000080;">label</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Using variables with plotxy;

<span style="color: #008000;">////////// Example 5 ////////////////////////////////////////</span>
<span style="color: #008000;">// 新しいデータから開始</span>
newbook template<span style="color: #000000;">:</span><span style="color: #000080;">=</span>origin.<span style="color: #000080;">otw</span>;
impasc fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span><span style="color: #000080;">+</span><span style="color: #ff00ff;">&quot;Samples\Curve Fitting\Activity.DAT&quot;</span> option.<span style="color: #000080;">names</span>.<span style="color: #000080;">FNameToBk</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;

<span style="color: #008000;">// ブックとシートの名前を記録</span>
string bkname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> page.<span style="color: #000080;">name</span><span style="color: #000080;">$</span>;
string shname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> layer.<span style="color: #000080;">name</span><span style="color: #000080;">$</span>;

<span style="color: #008000;">// 指定したグラフテンプレートに列Bを3つの範囲に分けて作図</span>
plotxy <span style="color: #000000;">[</span>bkname<span style="color: #000080;">$</span><span style="color: #000000;">]</span>shname<span style="color: #000080;">$!</span><span style="color: #000000;">(</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">[</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">6</span><span style="color: #000000;">]</span><span style="color: #000000;">)</span>,<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">[</span><span style="color: #0000dd;">7</span><span style="color: #000000;">:</span><span style="color: #0000dd;">12</span><span style="color: #000000;">]</span><span style="color: #000000;">)</span>,<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">[</span><span style="color: #0000dd;">13</span><span style="color: #000000;">:</span><span style="color: #0000dd;">18</span><span style="color: #000000;">]</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">202</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span><span style="color: #000080;">&lt;</span>new template<span style="color: #000000;">:</span><span style="color: #000080;">=</span>doubley name<span style="color: #000000;">:</span><span style="color: #000080;">=</span>SamplePlot<span style="color: #000080;">&gt;</span><span style="color: #000000;">]</span>;

<span style="color: #008000;">// テンプレートの2番目のレイヤに列Cの3つの範囲を追加</span>
plotxy <span style="color: #000000;">[</span>bkname<span style="color: #000080;">$</span><span style="color: #000000;">]</span>shname<span style="color: #000080;">$!</span><span style="color: #000000;">(</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">3</span><span style="color: #000000;">[</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">6</span><span style="color: #000000;">]</span><span style="color: #000000;">)</span>,<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">3</span><span style="color: #000000;">[</span><span style="color: #0000dd;">7</span><span style="color: #000000;">:</span><span style="color: #0000dd;">12</span><span style="color: #000000;">]</span><span style="color: #000000;">)</span>,<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">3</span><span style="color: #000000;">[</span><span style="color: #0000dd;">13</span><span style="color: #000000;">:</span><span style="color: #0000dd;">18</span><span style="color: #000000;">]</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">202</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>;

<span style="color: #008000;">// 再スケール</span>
layer1.<span style="color: #000080;">x</span>.<span style="color: #000080;">from</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
layer1.<span style="color: #000080;">x</span>.<span style="color: #000080;">to</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">30</span>;
page.<span style="color: #000080;">label</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Multi<span style="color: #000080;">-</span>range plot;

<span style="color: #008000;">// 作図した全てのグラフを表示</span>
doc <span style="color: #000080;">-</span>e W <span style="color: #000000;">{</span>
    win <span style="color: #000080;">-</span>i;
<span style="color: #000000;">}</span>
win <span style="color: #000080;">-</span>s T;
</pre>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">// X値を1番目のワークシートから取得しY値を2番目のシートから取得した</span>
<span style="color: #008000;">// グループ化プロットを作図</span>
<span style="color: #008000;">// 両方のシートの列数は同じである必要があります</span>

<span style="color: #008000;">// アクティブワークブックの名前を保存</span>
string sbook<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">%</span>H;

<span style="color: #008000;">// アクティブシートの列数</span>
int num_cols <span style="color: #000080;">=</span> wks.<span style="color: #000080;">ncols</span>;

<span style="color: #008000;">// 新しいグラフを作成</span>
win <span style="color: #000080;">-</span>t plot;

<span style="color: #008000;">// 列の数繰り返す</span>
for <span style="color: #000000;">(</span>int ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; ii <span style="color: #000080;">&lt;=</span> num_cols; ii<span style="color: #000080;">++</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
        <span style="color: #008000;">// シート1の列インデックスiiをX、</span>
        <span style="color: #008000;">// シート2の列インデックスiiをYとして、</span>
        <span style="color: #008000;">// 新しいグラフの1番目のレイヤにプロットを追加</span>
        plotxy iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span>sbook<span style="color: #000080;">$</span><span style="color: #000000;">]</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!$</span><span style="color: #000000;">(</span>ii<span style="color: #000000;">)</span>, <span style="color: #0000dd;">2</span><span style="color: #000080;">!$</span><span style="color: #000000;">(</span>ii<span style="color: #000000;">)</span><span style="color: #000000;">)</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">201</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000080;">!</span><span style="color: #0000dd;">1</span>;
<span style="color: #000000;">}</span>

<span style="color: #008000;">//レイヤ内のプロットをグループ化</span>
layer <span style="color: #000080;">-</span>g;
</pre>

  <h3><a name="plotxyz"></a><span class="mw-headline">plotxyz（XYZデータから3Dグラフを作図）</span></h3>

  <p>XYZワークシートデータから3Dグラフを作成するために、Xファンクション<a class="external text" href="../../XFunction/X-Function/Plotxyz.html#Additional_Information">plotxyz</a>を使用します。以下がサンプルです。</p>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">////////// Example 1 ////////////////////////////////////////</span>
<span style="color: #008000;">//離散したデータから3D棒グラフを作図</span>
<span style="color: #008000;">//データファイルをインポート</span>
string fn<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;\Samples\Statistics\automobile.dat&quot;</span>; 
impasc fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>fn<span style="color: #000080;">$</span>; 
<span style="color: #008000;">//列属性を設定</span>
wks.<span style="color: #000080;">col3</span>.<span style="color: #000080;">type</span><span style="color: #000080;">=</span><span style="color: #0000dd;">6</span>;
wks.<span style="color: #000080;">col4</span>.<span style="color: #000080;">type</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span>;
wks.<span style="color: #000080;">col6</span>.<span style="color: #000080;">type</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
<span style="color: #008000;">//ワークシートから列を選択して3D棒グラフを作成</span>
plotxyz iz<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">(</span><span style="color: #0000dd;">4</span>,<span style="color: #0000dd;">6</span>,<span style="color: #0000dd;">3</span><span style="color: #000000;">)</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">242</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>new template<span style="color: #000000;">:</span><span style="color: #000080;">=</span>gl3dbars<span style="color: #000080;">&gt;</span>;
<span style="color: #008000;">//スピードモードをオフにしてグラフをリフレッシュ</span>
layer.<span style="color: #000080;">maxpts</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;
doc <span style="color: #000080;">-</span>uw;

<span style="color: #008000;">////////// Example 2 ////////////////////////////////////////</span>
<span style="color: #008000;">//3Dカラーマップ曲面図を作図して上部に等高線図を投影</span>
<span style="color: #008000;">//データファイルをインポート</span>
string fn<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;\Samples\Graphing\Gaussian Surface.dat&quot;</span>; 
impasc fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>fn<span style="color: #000080;">$</span>; 
<span style="color: #008000;">//3列目をZとして設定</span>
wks.<span style="color: #000080;">col3</span>.<span style="color: #000080;">type</span><span style="color: #000080;">=</span><span style="color: #0000dd;">6</span>;
plotxyz iz<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">103</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>new template<span style="color: #000000;">:</span><span style="color: #000080;">=</span>glcmap<span style="color: #000080;">&gt;</span>;
layer <span style="color: #000080;">-</span>ip103 <span style="color: #000080;">%</span>c;
range rr <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
set rr <span style="color: #000080;">-</span>spf <span style="color: #0000dd;">1</span>;
set rr <span style="color: #000080;">-</span>spz <span style="color: #0000dd;">100</span>;

<span style="color: #008000;">////////// Example 3 ////////////////////////////////////////</span>
<span style="color: #008000;">//3つの範囲に分けて3D散布図を作図</span>
<span style="color: #008000;">//データファイルをインポート</span>
string fn<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;\Samples\Statistics\Fisher&apos;s Iris Data.dat&quot;</span>; 
impasc fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>fn<span style="color: #000080;">$</span>; 
<span style="color: #008000;">//3番目の列をZとして設定</span>
wks.<span style="color: #000080;">col3</span>.<span style="color: #000080;">type</span><span style="color: #000080;">=</span><span style="color: #0000dd;">6</span>;
<span style="color: #008000;">//範囲分け</span>
range r1<span style="color: #000080;">=</span>col<span style="color: #000000;">(</span><span style="color: #0000dd;">3</span><span style="color: #000000;">)</span><span style="color: #000000;">[</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">50</span><span style="color: #000000;">]</span>;
range r2<span style="color: #000080;">=</span>col<span style="color: #000000;">(</span><span style="color: #0000dd;">3</span><span style="color: #000000;">)</span><span style="color: #000000;">[</span><span style="color: #0000dd;">51</span><span style="color: #000000;">:</span><span style="color: #0000dd;">100</span><span style="color: #000000;">]</span>;
range r3<span style="color: #000080;">=</span>col<span style="color: #000000;">(</span><span style="color: #0000dd;">3</span><span style="color: #000000;">)</span><span style="color: #000000;">[</span><span style="color: #0000dd;">101</span><span style="color: #000000;">:</span>end<span style="color: #000000;">]</span>;
<span style="color: #008000;">//同じレイヤにそれぞれの3D散布図を作図</span>
plotxyz iz<span style="color: #000000;">:</span><span style="color: #000080;">=</span>r1 plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">240</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>new template<span style="color: #000000;">:</span><span style="color: #000080;">=</span>gl3d<span style="color: #000080;">&gt;</span>;
plotxyz iz<span style="color: #000000;">:</span><span style="color: #000080;">=</span>r2 plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">240</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span><span style="color: #000080;">%</span>H<span style="color: #000000;">]</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span>;
plotxyz iz<span style="color: #000000;">:</span><span style="color: #000080;">=</span>r3 plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">240</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span><span style="color: #000080;">%</span>H<span style="color: #000000;">]</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span>;
legendupdate;
</pre>

  <h3><a name="plotm"></a><span class="mw-headline">plotm</span></h3>

  <p>Xファンクション<a class="external text" href="http://www.originlab.com/doc/X-Function/ref/plotm" target="_blank">plotm</a>は、カスタムテンプレートを使って行列からグラフを作図するときに使用します。</p>
  <pre class="lt" style="font-family:monospace;">
newbook name<span style="color: #000000;">:</span><span style="color: #000080;">=</span>MyMatrix mat<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
matrix <span style="color: #000080;">-</span>v x<span style="color: #000080;">^</span><span style="color: #0000dd;">2</span><span style="color: #000080;">-</span>y<span style="color: #000080;">^</span><span style="color: #0000dd;">2</span>;        
plotm im<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>active<span style="color: #000080;">&gt;</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">103</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>new template<span style="color: #000000;">:</span><span style="color: #000080;">=</span>glcmap<span style="color: #000080;">&gt;</span>;
</pre>

  <p>3D曲面図のカラーマップは、<i>set %C -b3c</i> を使用して他の行列オブジェクトから設定することもできます。</p>
  <pre class="lt" style="font-family:monospace;">
newbook name<span style="color: #000000;">:</span><span style="color: #000080;">=</span>CMap mat<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
matrix <span style="color: #000080;">-</span>v <span style="color: #0000dd;">10</span><span style="color: #000080;">*</span>x<span style="color: #000080;">+</span><span style="color: #0000dd;">10</span><span style="color: #000080;">*</span>y;    <span style="color: #008000;">//カラーマップ曲面用の行列を設定</span>
newbook name<span style="color: #000000;">:</span><span style="color: #000080;">=</span>MyMatrix mat<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
matrix <span style="color: #000080;">-</span>v x<span style="color: #000080;">^</span><span style="color: #0000dd;">2</span><span style="color: #000080;">+</span>y<span style="color: #000080;">^</span><span style="color: #0000dd;">2</span>;        <span style="color: #008000;">//曲面用の行列を設定 </span>
plotm im<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>active<span style="color: #000080;">&gt;</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">103</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>new template<span style="color: #000000;">:</span><span style="color: #000080;">=</span>glcmap<span style="color: #000080;">&gt;</span>;  <span style="color: #008000;">//曲面用の行列を3Dカラーマップ曲面図として作図</span>

range rr<span style="color: #000080;">=</span><span style="color: #000000;">[</span>Cmap<span style="color: #000000;">]</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #0000dd;">1</span>;  <span style="color: #008000;">//rangeを定義</span>
set <span style="color: #000080;">%</span>C <span style="color: #000080;">-</span>b3c rr;  <span style="color: #008000;">//ほかの行列オブジェクトからカラーマップを設定</span>
</pre>

  <h3><a name="plot_3D_box_and_sphere_using_plotm"></a><span class="mw-headline">plotmを使用して3Dボックスと球体を作図</span></h3>

  <p>次のコード サンプルでは、​​3Dレイヤに3Dボックスと球体を作成します。ボックスには6つの壁があり、<a class="external text" href="http://www.originlab.com/doc/X-Function/ref/plotm" target="_blank">plotm</a>で平面の3D パラメトリック関数としてプロットされます。メッシュは有効になっています。球は、特定の半径と座標でプロットされます。</p>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">//////////////////////////////////// Plot3DSphere /////////////////////////////////////////</span>
function int plotSphere<span style="color: #000000;">(</span>ref string gg<span style="color: #000080;">$</span>, double dXc, double dYc, double dZc, double dR<span style="color: #000000;">)</span> <span style="color: #000000;">{</span>
        type <span style="color: #000080;">-</span>a Sphere  Center<span style="color: #000000;">:</span><span style="color: #000000;">{</span><span style="color: #000080;">$</span><span style="color: #000000;">(</span>dXc<span style="color: #000000;">)</span>, <span style="color: #000080;">$</span><span style="color: #000000;">(</span>dYc<span style="color: #000000;">)</span>, <span style="color: #000080;">$</span><span style="color: #000000;">(</span>dZc<span style="color: #000000;">)</span><span style="color: #000000;">}</span>, Radius<span style="color: #000000;">:</span><span style="color: #000080;">$</span><span style="color: #000000;">(</span>dR<span style="color: #000000;">)</span>;
        int newg <span style="color: #000080;">=</span> exist<span style="color: #000000;">(</span>gname<span style="color: #000080;">$</span><span style="color: #000000;">)</span><span style="color: #000080;">==</span><span style="color: #0000dd;">3</span>?<span style="color: #0000dd;">0</span><span style="color: #000000;">:</span><span style="color: #0000dd;">1</span>;
        string enu<span style="color: #000080;">$</span>, bk<span style="color: #000080;">$</span>;
        int npts <span style="color: #000080;">=</span> <span style="color: #0000dd;">30</span>;<span style="color: #008000;">//正方行列</span>
        create myx3 <span style="color: #000080;">-</span>fp2 npts <span style="color: #ff00ff;">&quot;dR*sin(v)*cos(u)+dXc&quot;</span> <span style="color: #000080;">-</span>pi<span style="color: #000080;">/</span><span style="color: #0000dd;">2</span> pi<span style="color: #000080;">/</span><span style="color: #0000dd;">2</span> npts <span style="color: #0000dd;">0</span> <span style="color: #0000dd;">2</span><span style="color: #000080;">*</span>pi; 
        create myy3 <span style="color: #000080;">-</span>fp2 npts <span style="color: #ff00ff;">&quot;dR*cos(v)*cos(u)+dYc&quot;</span> <span style="color: #000080;">-</span>pi<span style="color: #000080;">/</span><span style="color: #0000dd;">2</span> pi<span style="color: #000080;">/</span><span style="color: #0000dd;">2</span> npts <span style="color: #0000dd;">0</span> <span style="color: #0000dd;">2</span><span style="color: #000080;">*</span>pi;
        create myz3 <span style="color: #000080;">-</span>fp2 npts <span style="color: #ff00ff;">&quot;dR*sin(u)+dZc&quot;</span> <span style="color: #000080;">-</span>pi<span style="color: #000080;">/</span><span style="color: #0000dd;">2</span> pi<span style="color: #000080;">/</span><span style="color: #0000dd;">2</span> npts <span style="color: #0000dd;">0</span> <span style="color: #0000dd;">2</span><span style="color: #000080;">*</span>pi; 
        create FunSphere <span style="color: #000080;">-</span>mfp myz3 myx3 myy3 <span style="color: #ff00ff;">&quot;u,v&quot;</span>;
        enu<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> mid<span style="color: #000000;">(</span><span style="color: #000080;">%</span>H,<span style="color: #0000dd;">10</span><span style="color: #000000;">)</span><span style="color: #000080;">$</span>;  <span style="color: #008000;">//列挙部分を取得。%Hは、新しく作成されたアクティブ行列ウィンドウ名を保存</span>
        bb<span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;FunSphere&quot;</span><span style="color: #000080;">+</span>enu<span style="color: #000080;">$</span>;
        window <span style="color: #000080;">-</span>ch <span style="color: #0000dd;">1</span>;  <span style="color: #008000;">//行列ウィンドウを隠す</span>
        if<span style="color: #000000;">(</span>exist<span style="color: #000000;">(</span>gg<span style="color: #000080;">$</span><span style="color: #000000;">)</span><span style="color: #000080;">==</span><span style="color: #0000dd;">3</span><span style="color: #000000;">)</span>  <span style="color: #008000;">//グラフが存在</span>
                plotm im<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span><span style="color: #000080;">%</span><span style="color: #000000;">(</span>bb<span style="color: #000080;">$</span><span style="color: #000000;">)</span><span style="color: #000000;">]</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #0000dd;">1</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">103</span> x<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span> y<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span>gg<span style="color: #000080;">$</span><span style="color: #000000;">]</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span>;
        else 
                plotm im<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span><span style="color: #000080;">%</span><span style="color: #000000;">(</span>bb<span style="color: #000080;">$</span><span style="color: #000000;">)</span><span style="color: #000000;">]</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #0000dd;">1</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">103</span> x<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span> y<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span>;   <span style="color: #008000;">//ライトは&quot;ogl:=&lt;new template:=EllipsoidLTCyan&gt;&quot;オプションを使用</span>
        set <span style="color: #000080;">%</span><span style="color: #000000;">(</span>bb<span style="color: #000080;">$</span><span style="color: #000000;">)</span> <span style="color: #000080;">-</span>b3cc  <span style="color: #0000dd;">22</span>;  <span style="color: #008000;">//color: 22=LT Cyan</span>
        set <span style="color: #000080;">%</span><span style="color: #000000;">(</span>bb<span style="color: #000080;">$</span><span style="color: #000000;">)</span> <span style="color: #000080;">-</span>b3m <span style="color: #0000dd;">1</span>;<span style="color: #008000;">//0:メッシュなし、1:メッシュ</span>
        return <span style="color: #0000dd;">0</span>;
<span style="color: #000000;">}</span>

<span style="color: #008000;">//////////////////////////////////// plotOneSide /////////////////////////////////////////</span>
function int plotOneSide<span style="color: #000000;">(</span>string bb<span style="color: #000080;">$</span>, string gg<span style="color: #000080;">$</span>, int cc<span style="color: #000000;">)</span> <span style="color: #000000;">{</span>
        <span style="color: #008000;">//type -a In plotOneSide:  bb: %(bb$) gg: %(gg$);</span>
        if<span style="color: #000000;">(</span>exist<span style="color: #000000;">(</span>gg<span style="color: #000080;">$</span><span style="color: #000000;">)</span><span style="color: #000080;">==</span><span style="color: #0000dd;">3</span><span style="color: #000000;">)</span>  <span style="color: #008000;">//グラフが存在</span>
                plotm im<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span><span style="color: #000080;">%</span><span style="color: #000000;">(</span>bb<span style="color: #000080;">$</span><span style="color: #000000;">)</span><span style="color: #000000;">]</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #0000dd;">1</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">103</span> x<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span> y<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span>gg<span style="color: #000080;">$</span><span style="color: #000000;">]</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span>;
        else 
                plotm im<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span><span style="color: #000080;">%</span><span style="color: #000000;">(</span>bb<span style="color: #000080;">$</span><span style="color: #000000;">)</span><span style="color: #000000;">]</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #0000dd;">1</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">103</span> x<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span> y<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span>;   <span style="color: #008000;">//ライトは&quot;ogl:=&lt;new template:=EllipsoidLTCyan&gt;&quot;オプションを使用</span>
        set <span style="color: #000080;">%</span><span style="color: #000000;">(</span>bb<span style="color: #000080;">$</span><span style="color: #000000;">)</span> <span style="color: #000080;">-</span>b3cc cc;<span style="color: #008000;">//color</span>
        set <span style="color: #000080;">%</span><span style="color: #000000;">(</span>bb<span style="color: #000080;">$</span><span style="color: #000000;">)</span> <span style="color: #000080;">-</span>b3m <span style="color: #0000dd;">1</span>;<span style="color: #008000;">//0:メッシュなし、1:メッシュ</span>
        return <span style="color: #0000dd;">0</span>;
<span style="color: #000000;">}</span>
<span style="color: #008000;">//////////////////////////////////// Plot3DBox /////////////////////////////////////////</span>
function int plot3DBox<span style="color: #000000;">(</span>ref string gname<span style="color: #000080;">$</span>, double dX1, double dX2, double dY1, double dY2, double dZ1, double dZ2<span style="color: #000000;">)</span> <span style="color: #000000;">{</span>
        type <span style="color: #000080;">-</span>a 3DBox  X<span style="color: #000000;">:</span><span style="color: #000080;">$</span><span style="color: #000000;">(</span>dX1<span style="color: #000000;">)</span><span style="color: #000080;">==&gt;</span><span style="color: #000080;">$</span><span style="color: #000000;">(</span>dX2<span style="color: #000000;">)</span>, Y<span style="color: #000000;">:</span><span style="color: #000080;">$</span><span style="color: #000000;">(</span>dY1<span style="color: #000000;">)</span><span style="color: #000080;">==&gt;</span><span style="color: #000080;">$</span><span style="color: #000000;">(</span>dY2<span style="color: #000000;">)</span>, Z<span style="color: #000000;">:</span><span style="color: #000080;">$</span><span style="color: #000000;">(</span>dZ1<span style="color: #000000;">)</span><span style="color: #000080;">==&gt;</span><span style="color: #000080;">$</span><span style="color: #000000;">(</span>dZ2<span style="color: #000000;">)</span>;
        int newg <span style="color: #000080;">=</span> exist<span style="color: #000000;">(</span>gname<span style="color: #000080;">$</span><span style="color: #000000;">)</span><span style="color: #000080;">==</span><span style="color: #0000dd;">3</span>?<span style="color: #0000dd;">0</span><span style="color: #000000;">:</span><span style="color: #0000dd;">1</span>;
        string enu<span style="color: #000080;">$</span>, bk<span style="color: #000080;">$</span>;
        int npts <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>;<span style="color: #008000;">//正方行列</span>
        <span style="color: #008000;">//// LEFT</span>
        <span style="color: #008000;">//3Dパラメトリック関数プロット用のx、y、zの2Dルースデータセットを作成</span>
        create myx <span style="color: #000080;">-</span>fp2 npts u dX1 dX2 npts dZ1 dZ2; 
        create myy <span style="color: #000080;">-</span>fp2 npts dY1 dX1 dX2 npts dZ1 dZ2;
        create myz <span style="color: #000080;">-</span>fp2 npts v dX1 dX2 npts dZ1 dZ2;
        <span style="color: #008000;">//Create matrices for left wall from 2D loose datasets for 3D parametric function plot</span>
        create FuncLeft <span style="color: #000080;">-</span>mfp myz myx myy <span style="color: #ff00ff;">&quot;u,v&quot;</span>;     <span style="color: #008000;">//アクティブ行列を作成</span>
        <span style="color: #008000;">//create FuncLeft -mfph myz myx myy &quot;u,v&quot;;  //非表示行列を作成（Origin 2017）</span>
        <span style="color: #008000;">//////////////////////////////////////////////////</span>
        enu<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> mid<span style="color: #000000;">(</span><span style="color: #000080;">%</span>H,<span style="color: #0000dd;">9</span><span style="color: #000000;">)</span><span style="color: #000080;">$</span>;  <span style="color: #008000;">//列挙部分を取得。%Hは新しく作成されたアクティブ行列ウィンドウ名</span>
        window <span style="color: #000080;">-</span>ch <span style="color: #0000dd;">1</span>;       <span style="color: #008000;">//非表示行列ウィンドウ</span>
        <span style="color: #008000;">//enu$ = mid(&quot;%@N&quot;,9)$;  //列挙部分を取得。%@N は新しく作成されたウィンドウ名</span>
        <span style="color: #008000;">///////////////////////////////////////////////////</span>
        <span style="color: #008000;">//// RIGHT</span>
        <span style="color: #008000;">//3Dパラメトリック関数プロット用のx、y、zの2Dルースデータセットを作成</span>
        create myx <span style="color: #000080;">-</span>fp2 npts u dX2 dX1 npts dZ1 dZ2;     <span style="color: #008000;">//外側右面</span>
        create myy <span style="color: #000080;">-</span>fp2 npts dY2 dX1 dX2 npts dZ1 dZ2;
        create myz <span style="color: #000080;">-</span>fp2 npts v dX1 dX2 npts dZ1 dZ2;
        <span style="color: #008000;">//3Dパラメトリック関数プロット用の2Dルースデータセットから右壁の行列を作成</span>
        create FuncRight <span style="color: #000080;">-</span>mfph myz myx myy <span style="color: #ff00ff;">&quot;u,v&quot;</span>;
        <span style="color: #008000;">////FRONT</span>
        <span style="color: #008000;">//3Dパラメトリック関数プロット用のx、y、zの2Dルースデータセットを作成</span>
        create myx <span style="color: #000080;">-</span>fp2 npts dX2 dY1 dY2 npts dZ1 dZ2;
        create myy <span style="color: #000080;">-</span>fp2 npts u dY1 dY2 npts dZ1 dZ2;
        create myz <span style="color: #000080;">-</span>fp2 npts v dY1 dY2 npts dZ1 dZ2;
        <span style="color: #008000;">//3Dパラメトリック関数プロット用の2Dルースデータセットから正面壁の行列を作成</span>
        create FuncFront <span style="color: #000080;">-</span>mfph myz myx myy <span style="color: #ff00ff;">&quot;u,v&quot;</span>;
        <span style="color: #008000;">//// BACK</span>
        <span style="color: #008000;">//3Dパラメトリック関数プロット用のx、y、zの2Dルースデータセットを作成</span>
        create myx <span style="color: #000080;">-</span>fp2 npts dX1 dY1 dY2 npts dZ1 dZ2;
        create myy <span style="color: #000080;">-</span>fp2 npts u dY2 dY1 npts dZ2 dZ1;   <span style="color: #008000;">//外側 背面</span>
        create myz <span style="color: #000080;">-</span>fp2 npts v dY1 dY2 npts dZ1 dZ2;
        <span style="color: #008000;">//3Dパラメトリック関数プロット用の2Dルースデータセットから背面壁の行列を作成</span>
        create FuncBack <span style="color: #000080;">-</span>mfph myz myx myy <span style="color: #ff00ff;">&quot;u,v&quot;</span>;
        <span style="color: #008000;">//// TOP</span>
        <span style="color: #008000;">//3Dパラメトリック関数プロット用のx、y、zの2Dルースデータセットを作成</span>
        create myx <span style="color: #000080;">-</span>fp2 npts u dX1 dX2 npts dY1 dY2;
        create myy <span style="color: #000080;">-</span>fp2 npts v dX1 dX2 npts dY1 dY2;
        create myz <span style="color: #000080;">-</span>fp2 npts dZ2 dX1 dX2 npts dY1 dY2;
        <span style="color: #008000;">//3Dパラメトリック関数プロット用の2Dルースデータセットから上壁の行列を作成</span>
        create FuncTop <span style="color: #000080;">-</span>mfph myz myx myy <span style="color: #ff00ff;">&quot;u,v&quot;</span>;
        <span style="color: #008000;">//// BOTTOM</span>
        <span style="color: #008000;">//3Dパラメトリック関数プロット用のx、y、zの2Dルースデータセットを作成</span>
        create myx <span style="color: #000080;">-</span>fp2 npts u dX2 dX1 npts dY1 dY2;   <span style="color: #008000;">//外側 底面</span>
        create myy <span style="color: #000080;">-</span>fp2 npts v dX1 dX2 npts dY1 dY2;
        create myz <span style="color: #000080;">-</span>fp2 npts dZ1 dX1 dX2 npts dY1 dY2;
        <span style="color: #008000;">//3Dパラメトリック関数プロット用のx、y、zの2Dルースデータセットを作成</span>
        create FuncBottom <span style="color: #000080;">-</span>mfph myz myx myy <span style="color: #ff00ff;">&quot;u,v&quot;</span>;
        <span style="color: #008000;">//////////////////////////////////////////////////////////</span>
        <span style="color: #008000;">// 作図</span>
        if<span style="color: #000000;">(</span>newg<span style="color: #000080;">==</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span> <span style="color: #000000;">{</span>
          win <span style="color: #000080;">-</span>o <span style="color: #000080;">%</span><span style="color: #000000;">(</span>gname<span style="color: #000080;">$</span><span style="color: #000000;">)</span> <span style="color: #000000;">{</span>
                type <span style="color: #ff00ff;">&quot;&gt; Adding a plot of the Left face to the existing graph %(gname$)&quot;</span>;
                plotOneSide<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;FuncLeft&quot;</span><span style="color: #000080;">+</span>enu<span style="color: #000080;">$</span>, gname<span style="color: #000080;">$</span>, <span style="color: #0000dd;">5</span><span style="color: #000000;">)</span>;
          <span style="color: #000000;">}</span>
        <span style="color: #000000;">}</span>
        else <span style="color: #000000;">{</span>
                plotOneSide<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;FuncLeft&quot;</span><span style="color: #000080;">+</span>enu<span style="color: #000080;">$</span>, gname<span style="color: #000080;">$</span>, <span style="color: #0000dd;">5</span><span style="color: #000000;">)</span>;
                gname<span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #000080;">%</span>H; <span style="color: #008000;">//作成したグラフ ウィンドウ名を保持</span>
                <span style="color: #008000;">//type &quot;&gt; Creating a new graph %(gname$) by plotting the Left face&quot;;</span>
        <span style="color: #000000;">}</span>
        win <span style="color: #000080;">-</span>o <span style="color: #000080;">%</span><span style="color: #000000;">(</span>gname<span style="color: #000080;">$</span><span style="color: #000000;">)</span> <span style="color: #000000;">{</span>
                <span style="color: #008000;">//type &quot;adding other faces to %(gname$)&quot;;</span>
                plotOneSide<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;FuncRight&quot;</span><span style="color: #000080;">+</span>enu<span style="color: #000080;">$</span>, gname<span style="color: #000080;">$</span>,<span style="color: #0000dd;">5</span><span style="color: #000000;">)</span>; <span style="color: #008000;">//右の壁を CYAN でプロット</span>
                plotOneSide<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;FuncFront&quot;</span><span style="color: #000080;">+</span>enu<span style="color: #000080;">$</span>, gname<span style="color: #000080;">$</span>,<span style="color: #0000dd;">4</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">//前面の壁を BLUE でプロット</span>
                plotOneSide<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;FuncBack&quot;</span><span style="color: #000080;">+</span>enu<span style="color: #000080;">$</span>, gname<span style="color: #000080;">$</span>, <span style="color: #0000dd;">4</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">//背面の壁をBLUEでプロット</span>
                plotOneSide<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;FuncTop&quot;</span><span style="color: #000080;">+</span>enu<span style="color: #000080;">$</span>, gname<span style="color: #000080;">$</span>, <span style="color: #0000dd;">6</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">//上壁をMAGENTAでプロット</span>
                plotOneSide<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;FuncBottom&quot;</span><span style="color: #000080;">+</span>enu<span style="color: #000080;">$</span>, gname<span style="color: #000080;">$</span>,<span style="color: #0000dd;">6</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">//下壁をMAGENTAでプロット</span>
        <span style="color: #000000;">}</span>
        return <span style="color: #0000dd;">0</span>;
<span style="color: #000000;">}</span>
<span style="color: #008000;">//////////////////////////////////////////////////</span>
<span style="color: #008000;">//                    MAIN                       //</span>
<span style="color: #008000;">//////////////////////////////////////////////////</span>
string str<span style="color: #000080;">$</span>;
plot3DBox<span style="color: #000000;">(</span>str, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">3</span>, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">1.5</span>, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>;    <span style="color: #008000;">//plot3DBox を実行して最初の 3D ボックスを作成</span>
plotSphere<span style="color: #000000;">(</span>str, <span style="color: #0000dd;">5</span>, <span style="color: #0000dd;">4</span>, <span style="color: #0000dd;">4</span>, <span style="color: #0000dd;">0.5</span><span style="color: #000000;">)</span>;         <span style="color: #008000;">//plotSphere を実行して球体を作成</span>

<span style="color: #008000;">//タイミングによってはアクティブウィンドウがグラフではない可能性があるためwin -oを使用</span>
win <span style="color: #000080;">-</span>o <span style="color: #000080;">%</span><span style="color: #000000;">(</span>str<span style="color: #000080;">$</span><span style="color: #000000;">)</span> <span style="color: #000000;">{</span>
    x1<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>; x2<span style="color: #000080;">=</span><span style="color: #0000dd;">5</span>; y1<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>; y2<span style="color: #000080;">=</span><span style="color: #0000dd;">5</span>; z1<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>; z2<span style="color: #000080;">=</span><span style="color: #0000dd;">5</span>;  <span style="color: #008000;">//ボックスをエッジに合わせてスケーリング</span>
    win <span style="color: #000080;">-</span>a <span style="color: #000080;">%</span><span style="color: #000000;">(</span>str<span style="color: #000080;">$</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">//グラフウィンドウをアクティブとして最前面に配置</span>
<span style="color: #000000;">}</span>
</pre>

  <p> </p>

  <dl>
    <dd>
      <dl>
        <dd><a class="image"><img alt="Scr 3DBoxSphere.jpg" src="../images/Plotting/Scr_3DBoxSphere.jpg" width="445"></a></dd>
      </dl>
    </dd>
  </dl>

  <h3><a name="plotpClamp"></a><span class="mw-headline">plotpClamp</span></h3>

  <p>Xファンクション<b>plotpclamp</b>はpClampインポートでインポートされたデータのグラフ作成を行います。ここでは、サンプルのpClampファイルを取り込み、プロットXファンクションパネルを表示せずにプロットします。</p>
  <pre class="lt" style="font-family:monospace;">
fname<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span><span style="color: #000080;">+</span><span style="color: #ff00ff;">&quot;Samples\Import and Export\pCLAMP\93311C01.DAT&quot;</span>;
imppClamp;
plotpclamp <span style="color: #0000dd;">1</span><span style="color: #000000;">:</span>end tag<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> stimulur<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> septstim<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> ctrl<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> mode<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>;
</pre>
