<h1 class="firstheading">Executing LabTalk Macros</h1>

  <p class='urlname' style='display: none'>Executing-LT-Macros</p>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>Contents</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1"><a href="#Macros_can_be_called_or_executed_anywhere_that_LabTalk_scripts_can_be_executed"><span class="tocnumber">1</span> <span class="toctext">Macros can be called or executed anywhere that LabTalk scripts can be executed</span></a></li>

      <li class="toclevel-1 tocsection-2"><a href="#A_script_associated_with_a_macro_name_can_be_passed_up_to_five_arguments"><span class="tocnumber">2</span> <span class="toctext">A script associated with a macro name can be passed up to five arguments</span></a></li>

      <li class="toclevel-1 tocsection-3"><a href="#To_call_or_execute_a_macro_from_someplace_other_than_the_Script_window"><span class="tocnumber">3</span> <span class="toctext">To call or execute a macro from someplace other than the Script window</span></a></li>

      <li class="toclevel-1 tocsection-4"><a href="#If_you_want_to_design_a_macro_that_terminates_its_execution_on_a_testable_condition_and_then_returns_control_back_to_the_Script_window_or_its_calling_script.2C_use_the_return_command_.28see_example.29"><span class="tocnumber">4</span> <span class="toctext">If you want to design a macro that terminates its execution on a testable condition and then returns control back to the Script window or its calling script, use the return command (see example)</span></a></li>
    </ul>
  </div>

  <h3><a name="Macros_can_be_called_or_executed_anywhere_that_LabTalk_scripts_can_be_executed"></a><span class="mw-headline">Macros can be called or executed anywhere that LabTalk scripts can be executed</span></h3>

  <p>This includes the Script window, the Worksheet Script dialog box, the Label Control dialog boxes, *.OGS files, user-defined Y-script fitting functions, and even other macros.</p>

  <p>To execute the script associated with a defined macro inside the Script window:</p>

  <ul>
    <li>Type the macro name and press ENTER (see example ).</li>
  </ul>

  <p>If you type the hello macro command into the Script window and press ENTER (<a href="../../LabTalk/LabTalk/Defining_and_Displaying_Macros.html" title="LabTalk:Defining and Displaying Macros">as defined here</a>), the script associated with the hello macro executes and prints the following in the Script window:</p>
  <pre class="lt" style="font-family:monospace;">
hello;

<span style="color: #0000dd;">1</span>. <span style="color: #000080;">Hello</span> World

<span style="color: #0000dd;">2</span>. <span style="color: #000080;">Hello</span> World

<span style="color: #0000dd;">3</span>. <span style="color: #000080;">Hello</span> World
</pre>

  <h3><a name="A_script_associated_with_a_macro_name_can_be_passed_up_to_five_arguments"></a><span class="mw-headline">A script associated with a macro name can be passed up to five arguments</span></h3>

  <p>To pass a macro arguments, type the macro name followed by a space separated list of the arguments into the Script window and then press ENTER. The values of the arguments passed will be accessible to the executing script through the use of the variables %1, %2, %3, %4, and %5 (see example ).</p>

  <p>If you type the macro command goodbye Liane Sarah Amanda into the Script window and press ENTER (<a href="../../LabTalk/LabTalk/Defining_and_Displaying_Macros.html" title="LabTalk:Defining and Displaying Macros">after having defined the goodbye macro</a>), the script associated with the goodbye macro executes and prints the following in the Script window:</p>
  <pre class="lt" style="font-family:monospace;">
goodbye Liane Sarah Amanda;

<span style="color: #0000dd;">1</span>. <span style="color: #000080;">Goodbye</span> Liane

<span style="color: #0000dd;">2</span>. <span style="color: #000080;">Goodbye</span> Sarah

<span style="color: #0000dd;">3</span>. <span style="color: #000080;">Goodbye</span> Amanda
</pre>

  <h3><a name="To_call_or_execute_a_macro_from_someplace_other_than_the_Script_window"></a><span class="mw-headline">To call or execute a macro from someplace other than the Script window</span></h3>

  <p>Place the macro name along with any arguments you are passing to it in the calling script (terminated with a semicolon) just as you would any other LabTalk command (see example ).</p>

  <ul>
    <li>To <a href="../../LabTalk/LabTalk/Defining_and_Displaying_Macros.html" title="LabTalk:Defining and Displaying Macros">execute the hello macro</a> from inside an OGS file, you include the line</li>
  </ul>
  <pre class="lt" style="font-family:monospace;">
hello;
</pre>

  <p>inside the OGS file.</p>

  <p>To execute the goodbye macro from inside a Label Control dialog box, include the line</p>
  <pre class="lt" style="font-family:monospace;">
goodbye Liane Sarah Amanda;
</pre>

  <p>inside the Label Control dialog box.</p>

  <h3><a name="If_you_want_to_design_a_macro_that_terminates_its_execution_on_a_testable_condition_and_then_returns_control_back_to_the_Script_window_or_its_calling_script.2C_use_the_return_command_.28see_example.29"></a><span class="mw-headline">If you want to design a macro that terminates its execution on a testable condition and then returns control back to the Script window or its calling script, use the return command (see example)</span></h3>

  <p>This script defines a macro named test that takes an argument, types OK if the argument is greater than 2, and then terminates its execution with the return command. If the argument is less than or equal to 2, the macro types Not OK and continues executing until it reaches its last statement.</p>
  <pre class="lt" style="font-family:monospace;">
def test <span style="color: #000000;">{</span>

      if <span style="color: #000000;">(</span><span style="color: #000080;">%</span>1 <span style="color: #000080;">&gt;</span> <span style="color: #0000dd;">2</span><span style="color: #000000;">)</span> <span style="color: #000000;">{</span>
            type <span style="color: #ff00ff;">"OK"</span>;
            return;

      <span style="color: #000000;">}</span>;

      type <span style="color: #ff00ff;">"Not OK"</span>;
      type <span style="color: #ff00ff;">"Keep running until you reach the end!"</span>; 
<span style="color: #000000;">}</span>;
</pre>

  <p>If you type the command test 3 and press &lt;ENTER&gt;, the macro will print OK and then terminate its execution.</p>
  <pre class="lt" style="font-family:monospace;">
test <span style="color: #0000dd;">3</span>;
</pre>

  <p>OK</p>

  <p>If you type test 1 and press &lt;ENTER&gt;, the macro types Not OK and continues to run until it reaches the end of the macro.</p>
  <pre class="lt" style="font-family:monospace;">
test <span style="color: #0000dd;">1</span>;
</pre>

  <p>Not OK</p>

  <p>Keep running until you reach the end!</p>
