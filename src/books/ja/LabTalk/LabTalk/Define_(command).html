<h1 class="firstheading">Define</h1>

  <p class='urlname' style='display: none'>Define-cmd</p>

  <p>The <b>Define</b> command is used in two different ways:</p>

  <ul>
    <li>Defines a macro called <i>macroName</i>, and associates it with the given script. <i>MacroName</i> can then be used like a command, and invokes the given script.</li>

    <li><font color="red">(from Origin 2022)</font> <a class="external text" href="../../UserGuide/UserGuide/Named_Range.html">Defines a range variable</a>.</li>
  </ul>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>Contents</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1">
        <a href="#Syntax:"><span class="tocnumber">1</span> <span class="toctext">Syntax:</span></a>

        <ul>
          <li class="toclevel-2 tocsection-2"><a href="#Define_a_Macro:"><span class="tocnumber">1.1</span> <span class="toctext">Define a Macro:</span></a></li>

          <li class="toclevel-2 tocsection-3"><a href="#Define_a_Range:"><span class="tocnumber">1.2</span> <span class="toctext">Define a Range:</span></a></li>
        </ul>
      </li>

      <li class="toclevel-1 tocsection-4">
        <a href="#Options"><span class="tocnumber">2</span> <span class="toctext">Options</span></a>

        <ul>
          <li class="toclevel-2 tocsection-5"><a href="#Define_a_Range:_2"><span class="tocnumber">2.1</span> <span class="toctext">Define a Range:</span></a></li>
        </ul>
      </li>

      <li class="toclevel-1 tocsection-6">
        <a href="#Examples:"><span class="tocnumber">3</span> <span class="toctext">Examples:</span></a>

        <ul>
          <li class="toclevel-2 tocsection-7"><a href="#Define_a_Macro:_2"><span class="tocnumber">3.1</span> <span class="toctext">Define a Macro:</span></a></li>

          <li class="toclevel-2 tocsection-8"><a href="#Define_a_Range:_3"><span class="tocnumber">3.2</span> <span class="toctext">Define a Range:</span></a></li>
        </ul>
      </li>
    </ul>
  </div>

  <h2><a name="Syntax:"></a><span class="mw-headline"><font color="chocolate">Syntax:</font></span></h2>

  <h3><a name="Define_a_Macro:"></a><span class="mw-headline">Define a Macro:</span></h3>
  <pre class="lt" style="font-family:monospace;">
define macroName <span style="color: #000000;">{</span> script<span style="color: #000000;">}</span>
</pre>

  <p>Macros can take up to five arguments. Use the %1, %2, %3, etc., notation within the script to indicate that the macro expects one or more arguments. A macro can accept a number, string, variable, dataset, function, or script as an argument, but all arguments are passed as strings. These are similar to MS-DOS batch command arguments. If arguments are passed to a macro, the macro can report the number of arguments using the <a href="../../LabTalk/LabTalk/Macro_(object).html" title="LabTalk:Macro (object)">macro.nArg</a> object property.</p>

  <p>To see the script associated with a defined macro, use:</p>
  <pre class="lt" style="font-family:monospace;">
define macroName
</pre>

  <h3><a name="Define_a_Range:"></a><span class="mw-headline">Define a Range:</span></h3>
  <pre class="lt" style="font-family:monospace;">
define option rangeName range
</pre>

  <h2><a name="Options"></a><span class="mw-headline"><font color="chocolate">Options</font></span></h2>

  <h3><a name="Define_a_Range:_2"></a><span class="mw-headline">Define a Range:</span></h3>

  <table class="simple">
    <tr>
      <th>Option</th>

      <th>Scope Level of Named Range</th>
    </tr>

    <tr>
      <td>n</td>

      <td>define a worksheet scope range variable</td>
    </tr>

    <tr>
      <td>nb</td>

      <td>define a workbook scope range variable</td>
    </tr>

    <tr>
      <td>np</td>

      <td>define a project scope range variable</td>
    </tr>
  </table>

  <h2><a name="Examples:"></a><span class="mw-headline"><font color="chocolate">Examples:</font></span></h2>

  <h3><a name="Define_a_Macro:_2"></a><span class="mw-headline">Define a Macro:</span></h3>

  <p><b>Example 1</b></p>

  <p>The following script defines the autoexec macro to create a new Origin worksheet from the ORIGIN.OTW template.</p>
  <pre class="lt" style="font-family:monospace;">
def autoexec <span style="color: #000000;">{</span> window <span style="color: #000080;">-</span>T Data Origin; <span style="color: #000000;">}</span>;
</pre>

  <p><b>Example 2</b></p>

  <p>The next script defines a macro that uses a loop to print a text string three times.</p>
  <pre class="lt" style="font-family:monospace;">
def hello 
<span style="color: #000000;">{</span> 
      loop <span style="color: #000000;">(</span>ii, <span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">3</span><span style="color: #000000;">)</span> 
            <span style="color: #000000;">{</span> type <span style="color: #ff00ff;">"$(ii). Hello World"</span>; <span style="color: #000000;">}</span>;
<span style="color: #000000;">}</span>;
</pre>

  <p>Once the hello macro is defined, typing the word hello in the Script window results in the printout:</p>

  <p>1. Hello World</p>

  <p>2. Hello World</p>

  <p>3. Hello World</p>

  <p><br>
  <b>Example 3</b></p>

  <p>The following script defines a macro named abc that expects a single argument. The given argument is then multiplied by 2, and the result is printed.</p>
  <pre class="lt" style="font-family:monospace;">
def abc <span style="color: #000000;">{</span> type <span style="color: #ff00ff;">"$(%1 * 2)"</span>; <span style="color: #000000;">}</span>;
</pre>

  <p>If you define this macro (previous example) and then type the following in the Script window:</p>
  <pre class="lt" style="font-family:monospace;">
abc <span style="color: #0000dd;">5</span>
</pre>

  <p>Origin responds: 10</p>

  <p>You could modify the abc macro (previous example) to take two arguments:</p>
  <pre class="lt" style="font-family:monospace;">
def abc <span style="color: #000000;">{</span> type <span style="color: #ff00ff;">"$(%1 * %2)"</span>; <span style="color: #000000;">}</span>;
</pre>

  <p>Now, if you type the following in the Script window:</p>
  <pre class="lt" style="font-family:monospace;">
abc <span style="color: #0000dd;">5</span> <span style="color: #0000dd;">4</span>
</pre>

  <p>Origin responds: 20</p>

  <h3><a name="Define_a_Range:_3"></a><span class="mw-headline">Define a Range:</span></h3>

  <p><b>Example 1</b></p>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">// Prepare 4 column XYXY</span>
def <span style="color: #000080;">-</span>n Sensor1 <span style="color: #000000;">[</span>Book1<span style="color: #000000;">]</span>Sheet1<span style="color: #000080;">!</span>col<span style="color: #000000;">(</span>B<span style="color: #000000;">)</span>;
def <span style="color: #000080;">-</span>n Sensor2 <span style="color: #000000;">[</span>Book1<span style="color: #000000;">]</span>Sheet1<span style="color: #000080;">!</span>col<span style="color: #000000;">(</span>D<span style="color: #000000;">)</span>;
plotxy iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">(</span><span style="color: #000000;">(</span>Sensor1<span style="color: #000000;">)</span>,<span style="color: #000000;">(</span>Sensor2<span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
</pre>

  <p><b>Example 2</b></p>
  <pre class="lt" style="font-family:monospace;">
newbook;
wks.<span style="color: #000080;">ncols</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">4</span>;
col<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span> <span style="color: #000080;">=</span> data<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">12</span><span style="color: #000000;">)</span>;
col<span style="color: #000000;">(</span>B<span style="color: #000000;">)</span> <span style="color: #000080;">=</span> data<span style="color: #000000;">(</span><span style="color: #0000dd;">21</span>,<span style="color: #0000dd;">32</span>,<span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>;
def <span style="color: #000080;">-</span>n ref1 col<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span><span style="color: #000000;">[</span><span style="color: #0000dd;">2</span><span style="color: #000000;">]</span>;
def <span style="color: #000080;">-</span>n myrange col<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span>;
csetvalue col<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">(</span>C<span style="color: #000000;">)</span> formula<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">"ref1*B"</span>; 
csetvalue col<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">(</span>D<span style="color: #000000;">)</span> formula<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">"total(myrange)"</span>;
</pre>
