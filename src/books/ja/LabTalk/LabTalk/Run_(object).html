<h1 class="firstheading">Run(object)</h1>

  <p class='urlname' style='display: none'>Run-obj</p>

  <p><br>
  <b>LabTalk Object Type:</b></p>

  <dl>
    <dd><a href="../../LabTalk/LabTalk/Utility_Objects,_Property_and_Method_Syntax_(Object).html" title="LabTalk:Utility Objects, Property and Method Syntax (Object)">Utility</a></dd>
  </dl>

  <p>The <b>run</b> object executes script from a script file. Origin tools use the <b>run.section()</b> method to execute sections of the appropriate *.OGS file.</p>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>Contents</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1"><a href="#Properties:"><span class="tocnumber">1</span> <span class="toctext">Properties:</span></a></li>

      <li class="toclevel-1 tocsection-2"><a href="#Methods:"><span class="tocnumber">2</span> <span class="toctext">Methods:</span></a></li>

      <li class="toclevel-1 tocsection-3"><a href="#Origin_C_Functions:"><span class="tocnumber">3</span> <span class="toctext">Origin C Functions:</span></a></li>

      <li class="toclevel-1 tocsection-4"><a href="#Run_Python:"><span class="tocnumber">4</span> <span class="toctext">Run Python:</span></a></li>

      <li class="toclevel-1 tocsection-5"><a href="#Examples:"><span class="tocnumber">5</span> <span class="toctext">Examples:</span></a></li>

      <li class="toclevel-1 tocsection-6"><a href="#See_Also:"><span class="tocnumber">6</span> <span class="toctext">See Also:</span></a></li>
    </ul>
  </div>

  <h2><a name="Properties:"></a><span class="mw-headline"><font color="chocolate">Properties:</font></span></h2>

  <table class="simple">
    <tr>
      <th width="110">Property</th>

      <th width="70">Access</th>

      <th width="540">Description</th>
    </tr>

    <tr>
      <td>run.automate</td>

      <td align="center">--</td>

      <td>Internal use only. Not implemented in Origin.</td>
    </tr>

    <tr>
      <td>run.ocworkspace</td>

      <td align="center">--</td>

      <td>Internal use only. Not implemented in Origin.</td>
    </tr>
  </table>

  <h2><a name="Methods:"></a><span class="mw-headline"><font color="chocolate">Methods:</font></span></h2>

  <table class="simple">
    <tr>
      <th width="180">Method</th>

      <th>Description</th>
    </tr>

    <tr>
      <td><b>run.addOC(<i>fileName</i>)</b></td>

      <td>
        <p>Add a file to the System folder of Code Builder's Origin C Workspace. After successfully adding the file compile and link it.</p>
      </td>
    </tr>

    <tr>
      <td><b>run.dialog(<i>OGOName[,DLLObject</i>])</b></td>

      <td>
        <p>General mechanism for tool launching. OGOName is the tool OGO file name. DLLObject is the object (existing in an external DLL) that contains source values for the tool sub-objects. (For a full discussion of "source" and tool sub-objects, see the draw.set() method.)</p>

        <p>The run.dialog() method is equivalent to the following script:</p>
        <pre class="lt" style="font-family:monospace;">
 
dotool <span style="color: #000080;">-</span>w OGOName; 
run.<span style="color: #000080;">section</span><span style="color: #000000;">(</span>OGSName,INIT<span style="color: #000000;">)</span>; 
DLLObject.<span style="color: #000080;">reset</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; 
draw.<span style="color: #000080;">set</span><span style="color: #000000;">(</span>OGOName,DLLObject<span style="color: #000000;">)</span>;
</pre>

        <p>(Where the OGSName is named the same as OGOName.)</p>

        <p>The <b>run.dialog()</b> method returns 0 if there is no error. It returns 1 if there is an error.</p>
      </td>
    </tr>

    <tr>
      <td><b>run.file(<i>fileName</i>)</b></td>

      <td>
        <p>Execute the specified LabTalk script file. This is the preferred mechanism for running older user-defined script files without sections (versus using the run command). If the file has an OGS extension, then the extension is optional. If the file is located in your User Files Folder then the path is optional otherwise you must specify the full path.</p>
      </td>
    </tr>

    <tr>
      <td><b>run.LoadOC(<i>"myFile", [option]</i>)</b></td>

      <td>
        <p>Load and compile an Origin C function or workspace with optional bit arguments.</p>

        <p><br>
        <b>The err return value:</b></p>

        <ul>
          <li>If err = 0, indicates success. Either myFile is already loaded in the current workspace or it is loaded from a *.C file and compiled and linked successfully.</li>

          <li>If err = 1, myFile was not found.</li>

          <li>If err = 2, myFile was found and loaded into the current workspace, but the compiling or linking failed.</li>
        </ul>

        <p>&#160;</p>

        <p><b>The myFile argument:</b></p>

        <ul>
          <li>The <b>myFile</b> can be either a workspace file (*.OCW) or a source file (*.C, *.CPP). If <b>myFile</b> is a workspace file, Origin checks each source file in the workspace file to see whether or not it is already loaded. If <b>myFile</b> is a source file, Origin checks to see if it is already loaded.</li>

          <li>In either case, if a source file is not already loaded then Origin adds it to the <b>Temporary</b> folder in the Code Builder workspace. When Origin is finished checking, it builds the Code Builder workspace. Files added to the Temporary folder of the Code Builder workspace are removed from the workspace when you close Code Builder or when you open a new or existing workspace file. Files can also be programmatically removed from the Temporary folder using <a href="../../LabTalk/LabTalk/Run_(command).html#-cr.5B_filename.5D.3B_Remove_file.28s.29_from_Code_Builder_Workspace" title="LabTalk:Run (command)">the LabTalk <b>run -cr &lt;filename&gt;</b> command</a>.</li>

          <li>You must surround myFile with quotation marks ("myFile").</li>

          <li>If no file extension is included, <b>myFile</b> is assumed to be a source file (*.C).</li>

          <li>If <b>myFile</b> has a full path, then it is used as is. If a path is not specified, Origin assumes that <b>myFile</b> is located in the \OriginC subfolder.</li>

          <li>The file name <b>myFile</b> supports wildcards.<br></li>
        </ul>

        <p><b>The option argument:</b><br>
        <b>Note:</b> Options 1,2,4 and 8 are for internal use and are not recommended.</p>

        <ul>
          <li>1 - Add file to Workspace User folder, but not Temporary Folder.</li>

          <li>2 - Loads, compiles, and links the file that is not already compiled and linked; otherwise does nothing.</li>

          <li>4 - Disable adding <b>internal.c</b> to the Workspace (Otherwise added by default).</li>

          <li>8 - Disable linking. Method of suspending linking until all files are loaded (See example).</li>

          <li>16 - Load all dependent Origin C files by scanning for .h files in the OC file being loaded.</li>

          <li>2048 - Add file to the AutoLoad folder.</li>
        </ul>

        <p>These are bit values and can be combined using the bit wise OR operator |. If <i>option</i> is not specified then zero is used.</p>
      </td>
    </tr>

    <tr>
      <td>
        <p><b>run.python(<i>arg</i>, [option])</b></p>

        <p class="version">Minimum Origin Version Required: 2015 SR0</p>
      </td>

      <td>
        <p>Execute Python statement(s) or files or evaluate Python expression(s), the <i>arg</i> should be a string variable including the Python statement, or file name and path, or Python evaluation, depending on the <i>option</i>. You can view the <a href="../../LabTalk/LabTalk/Run_(object).html#Run_Python:" title="LabTalk:Run (object)">examples</a> in the <b>Run Python</b> section below for sample usage.</p>

        <ul>
          <li>option = 0 (default), execute Python command

            <dl>
              <dd>In this case, <i>arg</i> should be the Python statement(s) and this is equivalent to the <a href="../../LabTalk/LabTalk/Run_(command).html#-py.3B_Execute_Python_Command_Line" title="LabTalk:Run (command)"><b>run -py</b></a> command.</dd>
            </dl>
          </li>

          <li>option = 1, evaluate Python expression

            <dl>
              <dd>In this case, <i>arg</i> should be the Python expression and this is equivalent to the <a href="../../LabTalk/LabTalk/Run_(command).html#-pye.3B_Evaluate_Python_Expression" title="LabTalk:Run (command)"><b>run -pye</b></a> command.</dd>
            </dl>
          </li>

          <li>option = 2, execute Python file

            <dl>
              <dd>In this case, <i>arg</i> should be the path and name of the .py file and this is equivalent to the <a href="../../LabTalk/LabTalk/Run_(command).html#-pyf.3B_Execute_Python_File" title="LabTalk:Run (command)"><b>run -pyf</b></a> command.</dd>
            </dl>
          </li>

          <li>option = 16, suppress output

            <dl>
              <dd>In this case, nothing will be output after execution</dd>
            </dl>
          </li>

          <li>option = 32 or 33, set the file path

            <dl>
              <dd>In this case, the path will be used when <b>run.python(<i>PythonFile</i>, 2)</b> when the full path of the file is not specified.</dd>
            </dl>
          </li>
        </ul>
      </td>
    </tr>

    <tr>
      <td><b>run.section(<i>fileName,sectionName[,arg1 arg2 arg3 arg4 arg5]</i>)</b></td>

      <td>
        <p>Execute the named section of the specified LabTalk script file. You can specify a path in fileName. If no path is specified, Origin first looks in the location of the open project, then the user files path, then the path to the Origin application file. Script file sections are separated by [section names]. For example, [Graph]. This method can pass up to five arguments to a section. Arguments in the script can be referred to using the temporary string variables: &#160;%1,&#160;%2,&#160;%3,&#160;%4, and&#160;%5. Note: When filename is not included, the current running script file is assumed. For example:</p>

        <p><code>run.section( ,Init);</code></p>

        <p>executes a subroutine Sub1 which is included in the currently running script file. This is a useful way to make a modular structure within a script file.</p>
      </td>
    </tr>
  </table>

  <h2><a name="Origin_C_Functions:"></a><span class="mw-headline"><font color="chocolate">Origin C Functions:</font></span></h2>

  <p>Origin C source file often has dependent C files. The following example shows how you can compile just the main file and automatically compile its dependents with option 16.</p>
  <pre class="lt" style="font-family:monospace;">
if<span style="color: #000000;">(</span>run.<span style="color: #000080;">LoadOC</span><span style="color: #000000;">(</span>Originlab\AscImpOptions, <span style="color: #0000dd;">16</span><span style="color: #000000;">)</span> <span style="color: #000080;">==</span> <span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>
   run <span style="color: #000080;">-</span>oc AscImportFDLOGFiles<span style="color: #000000;">(</span><span style="color: #000080;">%</span>H<span style="color: #000000;">)</span>;
</pre>

  <p>If you opens this file (AscImpOptions), you will see it has includes like</p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">#include</span> <span style="color: #ff00ff;">"fu_utils.h"</span>  
<span style="color: #0000ff;">#include</span> <span style="color: #ff00ff;">"Import_Utils.h"</span>
</pre>

  <p>option 16 will tell the Origin C compiler to scan the first 50 lines of code (after all comments stripped) to find such header include lines and then find corresponding C files in the same folder and add them to workspace as well. In this case, fu_utils.c and Import_Utils will be automatically loaded as well.</p>

  <p>You may also notice that the Origin C function AscImportFDLOGFiles was called with a LabTalk command <i><b>run -oc</b></i>. This technique allows the reduction of Origin C based function names to be directly visible from LabTalk, so as to prevent accidental name collisions. You will need to use</p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">#pragma</span> labtalk<span style="color: #000000;">(</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span>
</pre>

  <p>in the Origin C file to indicate subsequent functions to be callable only via <i><b>run -oc</b></i>, while</p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #0000ff;">#pragma</span> labtalk<span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>
</pre>

  <p>is used to completely prevent Origin C functions to be visible from LabTalk.</p>

  <h2><a name="Run_Python:"></a><span class="mw-headline"><font color="chocolate">Run Python:</font></span></h2>

  <p>The following examples show how to use the <b>run.python()</b> method. Note that you need to make sure the <b>Script Execution</b> is set to <b>LabTalk</b> in the <b>Script Window</b> in order to run these scripts.</p>

  <p>This LabTalk script directly executes Python command <i>print('Hello Origin')</i>:</p>
  <pre class="lt" style="font-family:monospace;">
run.<span style="color: #000080;">python</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"print('Hello Origin')"</span><span style="color: #000000;">)</span>;
<span style="color: #008000;">// This will print "Hello Origin" in Script Window</span>
</pre>

  <p>This script evaluates Python expression <i>2 ** 4</i>:</p>
  <pre class="lt" style="font-family:monospace;">
run.<span style="color: #000080;">python</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">" 2 ** 4 "</span>, <span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>; 
<span style="color: #008000;">//this will print 16 in Script Window.</span>
</pre>

  <p>This script first sets the file path to be <i>&lt;Origin EXE folder&gt;\Samples\Python</i>, and then execute the <b>ListMember.py</b> file under it:</p>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">// Define a string for the file path</span>
string file_path<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">PATH</span>.<span style="color: #000080;">PROGRAM</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">"\Samples\Python\"</span>;
<span style="color: #008000;">// Set path of the python file</span>
run.<span style="color: #000080;">python</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"%(file_path$)"</span>, <span style="color: #0000dd;">32</span><span style="color: #000000;">)</span>;
<span style="color: #008000;">// Run the .py file named as ListMember.py under the selected path</span>
run.<span style="color: #000080;">python</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"ListMember.py"</span>, <span style="color: #0000dd;">2</span><span style="color: #000000;">)</span>;

<span style="color: #008000;">// This .py file list all provided functions in PyOrigin module</span>
</pre>

  <p>This script suppress the output so nothing will be output after execution:</p>
  <pre class="lt" style="font-family:monospace;">
run.<span style="color: #000080;">python</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"print('Hello World')"</span>, <span style="color: #0000dd;">16</span><span style="color: #000000;">)</span>;
</pre>

  <h2><a name="Examples:"></a><span class="mw-headline"><font color="chocolate">Examples:</font></span></h2>

  <p>This script executes the script in the [LegendSmartPos] section of the standard.OGS file and move the Legend to a best position.</p>
  <pre class="lt" style="font-family:monospace;">
run.<span style="color: #000080;">section</span><span style="color: #000000;">(</span>standard, legendsmartpos<span style="color: #000000;">)</span>;
</pre>

  <p>This script executes the script in the [SimpleFit] section of the LR.OGS file and performs a linear fit of the data in the current graph window.</p>
  <pre class="lt" style="font-family:monospace;">
run.<span style="color: #000080;">section</span><span style="color: #000000;">(</span>LR,SimpleFit<span style="color: #000000;">)</span>;
</pre>

  <p>This script loads a sequence of files into the User Folder Workspace, deferring Linking to the end:</p>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">// 9 combines 1 (load to User Folder) and 8 (defer linking)</span>
err <span style="color: #000080;">=</span> run.<span style="color: #000080;">loadoc</span><span style="color: #000000;">(</span>originlab\initcode.<span style="color: #000080;">c</span>,<span style="color: #0000dd;">9</span><span style="color: #000000;">)</span>;
<span style="color: #008000;">// OR the errors together</span>
err <span style="color: #000080;">=</span> err <span style="color: #000080;">|</span> run.<span style="color: #000080;">loadoc</span><span style="color: #000000;">(</span>originlab\maincode.<span style="color: #000080;">cpp</span>,<span style="color: #0000dd;">9</span><span style="color: #000000;">)</span>;
err <span style="color: #000080;">=</span> err <span style="color: #000080;">|</span> run.<span style="color: #000080;">loadoc</span><span style="color: #000000;">(</span>originlab\supportcode.<span style="color: #000080;">c</span>,<span style="color: #0000dd;">9</span><span style="color: #000000;">)</span>;
if<span style="color: #000000;">(</span> err <span style="color: #000080;">==</span> <span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>
run.<span style="color: #000080;">loadoc</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// This triggers the linking</span>
else
printf<span style="color: #000000;">(</span><span style="color: #ff00ff;">"Some error(s) occurred. Linking not done.\n"</span><span style="color: #000000;">)</span>;
</pre>

  <p><br>
  This script loads a file selected by file dialog into the User Folder in Workspace:</p>
  <pre class="lt" style="font-family:monospace;">
fdlog.<span style="color: #000080;">UseGroup</span><span style="color: #000000;">(</span>OriginC<span style="color: #000000;">)</span>;
fdlog.<span style="color: #000080;">Open</span><span style="color: #000000;">(</span>A<span style="color: #000000;">)</span>;
<span style="color: #000080;">%</span>B <span style="color: #000080;">=</span> fdlog.<span style="color: #000080;">Path</span><span style="color: #000080;">$</span>;
string fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">%</span>B<span style="color: #000080;">%</span>A;
fname<span style="color: #000080;">$</span><span style="color: #000080;">=</span>;
err <span style="color: #000080;">=</span> run.<span style="color: #000080;">loadoc</span><span style="color: #000000;">(</span><span style="color: #000080;">%</span><span style="color: #000000;">(</span>fname<span style="color: #000080;">$</span><span style="color: #000000;">)</span>,<span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>;
if<span style="color: #000000;">(</span>err <span style="color: #000080;">==</span> <span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>
type <span style="color: #000080;">-</span>a Successfully load;
</pre>

  <h2><a name="See_Also:"></a><span class="mw-headline"><font color="chocolate">See Also:</font></span></h2>

  <p><a href="../../LabTalk/LabTalk/OGSFileName_(command).html" title="LabTalk:OGSFileName (command)">LabTalk:OGSFileName (command)</a>, <a href="../../LabTalk/LabTalk/OGSFileName.SectionName_(command).html" title="LabTalk:OGSFileName.SectionName (command)">LabTalk:OGSFileName.SectionName (command)</a></p>
