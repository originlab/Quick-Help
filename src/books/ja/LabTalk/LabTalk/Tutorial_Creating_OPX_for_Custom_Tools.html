<h1 class="firstheading">LabTalkによるカスタムツールのためのOPX作成</h1>

  <p class='urlname' style='display: none'>Tutorial-Creating-OPX-for-Custom-Tools</p>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>目次</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1"><a href="#Summary"><span class="tocnumber">1</span> <span class="toctext">概要</span></a></li>

      <li class="toclevel-1 tocsection-2"><a href="#What_Will_You_Learn"><span class="tocnumber">2</span> <span class="toctext">学習する項目</span></a></li>

      <li class="toclevel-1 tocsection-3">
        <a href="#Steps"><span class="tocnumber">3</span> <span class="toctext">ステップ</span></a>

        <ul>
          <li class="toclevel-2 tocsection-4"><a href="#Install_an_OPX_File"><span class="tocnumber">3.1</span> <span class="toctext">OPXファイルをインストール</span></a></li>

          <li class="toclevel-2 tocsection-5"><a href="#Create_Custom_Buttons"><span class="tocnumber">3.2</span> <span class="toctext">カスタムボタンを作成</span></a></li>

          <li class="toclevel-2 tocsection-6"><a href="#Create_OPX_File_for_Custom_Tools"><span class="tocnumber">3.3</span> <span class="toctext">カスタムツールのOPXファイルを作成</span></a></li>

          <li class="toclevel-2 tocsection-7"><a href="#Edit_the_OPX_file"><span class="tocnumber">3.4</span> <span class="toctext">OPXファイルを編集</span></a></li>

          <li class="toclevel-2 tocsection-8"><a href="#Share_the_OPX_file"><span class="tocnumber">3.5</span> <span class="toctext">OPXファイルを共有</span></a></li>
        </ul>
      </li>
    </ul>
  </div>

  <h2><a name="Summary"></a><span class="mw-headline">概要</span></h2>

  <p>Originでは、独自の LabTalkスクリプトを.opxファイルとしてパックし、他のユーザと共有することができます。さらに、LabTalkスクリプトを呼び出すカスタムボタンを作成し、このボタンを.opxファイルに含めて共有することもできます。</p>

  <h2><a name="What_Will_You_Learn"></a><span class="mw-headline">学習する項目</span></h2>

  <p>このチュートリアルでは、以下の項目について解説します。</p>

  <ul>
    <li>既存のOPXファイルをンストールする方法</li>

    <li>LabTalkファイル (.OGS) を使用してXファンクションを呼び出す方法</li>

    <li>カスタムボタンを作成してパッケージファイル (.OPX) にエクスポートする方法</li>

    <li>OPXでファイルを更新し、パッケージマネージャで再パックする方法</li>

    <li>別のマシンとファイルを共有する方法</li>
  </ul>

  <h2><a name="Steps"></a><span class="mw-headline">ステップ</span></h2>

  <h3><a name="Install_an_OPX_File"></a><span class="mw-headline">OPXファイルをインストール</span></h3>

  <p><i>&lt;Origin Installation Directory&gt;/Samples/LabTalk Script Examples/</i>フォルダにあるOPXファイル<b>MyStatistics.opx</b>をドラッグ&amp;ドロップします。このインストール済みパッケージには、次の4つのファイルが含まれています。</p>

  <dl>
    <dd><i>\OriginC\mystatistics.c</i></dd>

    <dd><i>\OriginC\mystatistics.h</i></dd>

    <dd><i>\X-Functions\Miscellaneous\normalitytest.OXF</i></dd>

    <dd><i>\X-Functions\Miscellaneous\onettest.OXF</i></dd>
  </dl>

  <p>ファイルのフォルダ構造もパッケージに記憶され、パッケージのインストール時に再作成されます。</p>

  <h3><a name="Create_Custom_Buttons"></a><span class="mw-headline">カスタムボタンを作成</span></h3>

  <p>このセクションでは、LabTalkスクリプトを使用してXファンクション (ユーザ定義) を呼び出す方法と、LabTalkスクリプトファイルを呼び出すカスタムボタンを作成する方法を説明します。</p>

  <ol>
    <li>
      <b>Xファンクションを実行するOGSファイルを作成</b>

      <ul>
        <li><b>コードビルダ</b>ボタンをクリックします。</li>

        <li><b>コードビルダ</b>で、<b>新規</b>ボタンをクリックして、<b>MyButton</b>という名前の<b>LabTalkスクリプトファイル</b>をUser Filesフォルダに作成します。</li>

        <li>次のスクリプトを入力し、ファイルを保存します。<b>コードビルダ</b>を閉じます。</li>
      </ul>
      <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">// 正規性の検定</span>
<span style="color: #000000;">[</span>Normality<span style="color: #000000;">]</span>
        normalitytest <span style="color: #000080;">-</span>d; 
                
<span style="color: #008000;">// 一群のt検定</span>
<span style="color: #000000;">[</span>ttest<span style="color: #000000;">]</span>
        onettest <span style="color: #000080;">-</span>d;
</pre>
    </li>

    <li>
      <b>新しいボタングループ</b><br>

      <ul>
        <li>Originメニューで、<b>表示：ツールバー</b>を選び、<b>カスタマイズ</b>ダイアログを開きます。</li>

        <li><b>ボタングループ</b>タブを開き、<b>新規作成</b>ボタンをクリックして<b>ボタングループの作成</b>ダイアログを開きます。</li>

        <li><b>グループ名</b>として<i>MyButton</i>を設定し、<b>ボタンの個数</b>ドロップダウンリストで<i>6</i> を選択し、<b>ビットマップファイル</b>としてUser Fileフォルダの<i>Userdef.bmp</i>ファイルを選択します。</li>
      </ul><a class="image"><img alt="Create Button Group.png" src="../images/Tutorial_Creating_OPX_for_Custom_Tools/Create_Button_Group.png" width="406"></a>

      <ul>
        <li><b>OK</b>ボタンをクリックし、<i>MyButton.ini</i>ファイルをデフォルトパスに保存します。</li>
      </ul><br>
    </li>

    <li>
      <b>最初のボタンの設定</b><br>

      <ul>
        <li><b>カスタマイズ</b>ダイアログで<b>グループ</b>リストから<b>MyButton</b>の項目を選択して<b>ボタン</b>パネルで最初の4つのボタンを削除します。</li>

        <li><a class="image"><img alt="Button1.png" src="../images/Tutorial_Creating_OPX_for_Custom_Tools/Button1.png" width="21"></a> ボタンをクリックして選択し、<b>ボタン</b>グループの<b>設定</b>ボタンをクリックして<b>ボタンの設定</b>ダイアログを開きます。</li>

        <li><b>ファイル名</b>で<i>MyButton.ogs</i>を選択して、<b>セクション名</b>で<i>Normality</i>と入力し、<b>行列</b>、<b>Excel</b>、<b>グラフ</b>、<b>レイアウト</b>にチェックを外します。</li>
      </ul><a class="image"><img alt="Set Button1.png" src="../images/Tutorial_Creating_OPX_for_Custom_Tools/Set_Button1.png" width="606"></a>

      <ul>
        <li><b>OK</b>をクリックして、ダイアログを閉じます。</li>
      </ul><br>
    </li>

    <li>
      <b>2番目のボタンの設定</b><br>

      <ul>
        <li><a class="image"><img alt="Button2.png" src="../images/Tutorial_Creating_OPX_for_Custom_Tools/Button2.png" width="22"></a> ボタンをクリックして選択し、<b>ボタン</b>グループの<b>設定</b>ボタンをクリックして<b>ボタンの設定</b>ダイアログを開きます。</li>

        <li><b>ファイル名</b>で<i>MyButton.ogs</i>を選択して、<b>セクション名</b>で<i>ttest</i> と入力し、<b>行列</b>、<b>Excel</b>、<b>グラフ</b>、<b>レイアウト</b>にチェックを外します。</li>
      </ul><a class="image"><img alt="Set Button2.png" src="../images/Tutorial_Creating_OPX_for_Custom_Tools/Set_Button2.png" width="606"></a>

      <ul>
        <li><b>OK</b>をクリックして、ダイアログを閉じます。</li>
      </ul><br>
    </li>
  </ol>

  <h3><a name="Create_OPX_File_for_Custom_Tools"></a><span class="mw-headline">カスタムツールのOPXファイルを作成</span></h3>

  <p>これで、LabTalkスクリプト、X ファンクション、および Origin Cファイルに関連付けられたカスタムツールができたのでOPXファイルを作成して、このカスタム ツールを他のユーザと共有できます。</p>

  <ol>
    <li>エクスポートボタンをクリックしてボタングループのエクスポートダイアログを開き、<b>ファイルの追加</b>ボタンをクリックしてユーザファイルフォルダにある以下の4つのファイルを選択します。</li>
  </ol>

  <dl>
    <dd><i>\OriginC\mystatistics.c</i></dd>

    <dd><i>\OriginC\mystatistics.h</i></dd>

    <dd><i>\X-Functions\Miscellaneous\normalitytest.OXF</i></dd>

    <dd><i>\X-Functions\Miscellaneous\onettest.OXF</i></dd>
  </dl>

  <p><a class="image"><img alt="Export ButtonGroup.png" src="../images/Tutorial_Creating_OPX_for_Custom_Tools/Export_ButtonGroup.png" width="345"></a></p>

  <ol>
    <li><b>エクスポート</b>ボタンをクリックし、MyButton.OPXファイルをユーザファイルフォルダに保存します。</li>

    <li><b><b>カスタマイズ</b></b>ダイアログを閉じます。</li>
  </ol>

  <p>&#160;</p>

  <h3><a name="Edit_the_OPX_file"></a><span class="mw-headline">OPXファイルを編集</span></h3>

  <p>OPXファイルにパッケージ化されているOCやXファンクションファイルを更新する場合、 <b>パッケージマネージャ</b>で編集することができます。ここでは<i>\X-Functions\Miscellaneous\normalitytest.OXF</i> が更新されたの仮定してOPXファイルの再パック操作をします。</p>

  <ol>
    <li>メニューから<b>ツール：パッケージマネージャ</b>を選択してダイアログを開きます。ダイアログで、メニューから<b>ファイル: 開く</b>を選択し、ユーザファイルフォルダにある<i>MyButton.OPX</i>ファイルを開きます。</li>

    <li><b>ファイルの再パック</b>ボタンをクリックしてファイルを再度パックします。</li>

    <li><b>パッケージ</b>ノードで、<b>バージョン</b>を<b>2</b>に更新します。</li>

    <li><b>ファイルメ</b>ニューの<b>保存</b>を選択してダイアログを閉じます。</li>
  </ol>

  <h3><a name="Share_the_OPX_file"></a><span class="mw-headline">OPXファイルを共有</span></h3>

  <p>OPXファイルは別のユーザと共有できます。</p>

  <ol>
    <li>OPXファイルを別のマシンにコピーし、<b>MyButton.opx</b>ファイルをOriginにドラッグアンドドロップします。</li>

    <li>パッケージが正常にインストールされると、Origin に新しいツールバーが表示されます。</li>

    <li>メニューから<b>ツール：パッケージマネージャ</b>を選択してダイアログを開きます。ダイアログで、<b>ツール: インストール済みパッケージの閲覧...</b>を選択します。.インストールされたパッケージがダイアログに一覧表示されます。名前、バージョン、説明などのパッケージ情報を参照し、必要に応じて選択したパッケージをアンインストールできます。</li>
  </ol>
