<h1 class="firstheading">Curve</h1>

  <p class='urlname' style='display: none'>Curve-obj</p>

  <p><b>LabTalk Object Type:</b></p>

  <dl>
    <dd><a href="../../LabTalk/LabTalk/External_Objects.html" title="LabTalk:External Objects">External Object</a></dd>
  </dl>

  <p>The <b>curve</b> object provides for the following math operations on a data plot:</p>

  <ul>
    <li>Smoothing</li>

    <li>Integration</li>

    <li>Derivation</li>
  </ul>

  <p>It also provides for baseline operations and peak selection.</p>

  <p>See the <b><a href="../../LabTalk/LabTalk/External_Objects.html" title="LabTalk:External Objects">common properties and methods of external objects</a></b>.</p>

  <table class="noborder">
    <tr>
      <td style="vertical-align:top" width="60"><img src="../images/Curve_(object)/Tip_icon.png" width="57" border="0" alt=""></td>

      <td>
        <p>Please see the <a class="external text" href="../../XFunction/X-Function/Addtool_curve_integ.html"><b>addtool_curve_integ</b></a> X-Function.</p>
      </td>
    </tr>
  </table>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>Contents</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1">
        <a href="#Properties:"><span class="tocnumber">1</span> <span class="toctext">Properties:</span></a>

        <ul>
          <li class="toclevel-2 tocsection-2"><a href="#Common_Curve_Object_Properties"><span class="tocnumber">1.1</span> <span class="toctext">Common Curve Object Properties</span></a></li>

          <li class="toclevel-2 tocsection-3"><a href="#Curve_Object_Properties_Specific_to_Math_Operations"><span class="tocnumber">1.2</span> <span class="toctext">Curve Object Properties Specific to Math Operations</span></a></li>

          <li class="toclevel-2 tocsection-4"><a href="#Curve_Object_Properties_Specific_to_Baseline_Operations_and_Peak_Selection"><span class="tocnumber">1.3</span> <span class="toctext">Curve Object Properties Specific to Baseline Operations and Peak Selection</span></a></li>
        </ul>
      </li>

      <li class="toclevel-1 tocsection-5">
        <a href="#Methods:"><span class="tocnumber">2</span> <span class="toctext">Methods:</span></a>

        <ul>
          <li class="toclevel-2 tocsection-6"><a href="#Curve_Object_Methods_Specific_to_Math_Operations"><span class="tocnumber">2.1</span> <span class="toctext">Curve Object Methods Specific to Math Operations</span></a></li>

          <li class="toclevel-2 tocsection-7"><a href="#Curve_Object_Methods_Specific_to_Baseline_Operations_and_Peak_Selection"><span class="tocnumber">2.2</span> <span class="toctext">Curve Object Methods Specific to Baseline Operations and Peak Selection</span></a></li>
        </ul>
      </li>

      <li class="toclevel-1 tocsection-8">
        <a href="#Examples:"><span class="tocnumber">3</span> <span class="toctext">Examples:</span></a>

        <ul>
          <li class="toclevel-2 tocsection-9"><a href="#Differentiation_Using_Savitzky-Golay_Method"><span class="tocnumber">3.1</span> <span class="toctext">Differentiation Using Savitzky-Golay Method</span></a></li>

          <li class="toclevel-2 tocsection-10"><a href="#Peak_Integration_from_a_Baseline"><span class="tocnumber">3.2</span> <span class="toctext">Peak Integration from a Baseline</span></a></li>
        </ul>
      </li>
    </ul>
  </div>

  <h2><a name="Properties:"></a><span class="mw-headline"><font color="chocolate">Properties:</font></span></h2>

  <h3><a name="Common_Curve_Object_Properties"></a><span class="mw-headline">Common Curve Object Properties</span></h3>

  <table class="simple">
    <tr>
      <th width="110">Property</th>

      <th width="70">Access</th>

      <th width="540">Description</th>
    </tr>

    <tr>
      <td><b>curve.baselinePts</b></td>

      <td>Read/write<br>
      numeric</td>

      <td>
        <p>Number of points used in baseline creation.</p>
      </td>
    </tr>

    <tr>
      <td><b>curve.data$</b></td>

      <td>Read/write<br>
      string</td>

      <td>
        <p>Name of the Y column in the worksheet to perform the operations on. This property must be set before performing an operation.</p>
      </td>
    </tr>

    <tr>
      <td><b>curve.derivDeg</b></td>

      <td>Read/write<br>
      numeric</td>

      <td>
        <p>Degree of differentiation: 0, 1, or 2.</p>
      </td>
    </tr>

    <tr>
      <td><b>curve.i1</b></td>

      <td>Read/write<br>
      numeric</td>

      <td>
        <p>Starting row index number of the selected range.</p>
      </td>
    </tr>

    <tr>
      <td><b>curve.i2</b></td>

      <td>Read/write<br>
      numeric</td>

      <td>
        <p>Ending row index number of the selected range. When i1 &gt; 0, i2 must be specified.</p>
      </td>
    </tr>

    <tr>
      <td><b>curve.plotName$</b></td>

      <td>Read/write<br>
      string</td>

      <td>
        <p>The name of the graph containing the data to be acted on by the <b>curve</b> object. This property does not require setting.</p>
      </td>
    </tr>

    <tr>
      <td><b>curve.show</b></td>

      <td>Read/write<br>
      numeric</td>

      <td>
        <p>Display the integration area: 0 = do not show, 1 = show.</p>
      </td>
    </tr>

    <tr>
      <td><b>curve.smoothPts</b></td>

      <td>Read/write<br>
      numeric</td>

      <td>
        <p>Total number of points to be smoothed including point (must be odd and &gt;= 3).</p>
      </td>
    </tr>

    <tr>
      <td><b>curve.x0</b></td>

      <td>Read only<br>
      numeric</td>

      <td>
        <p>Value of X at i1.</p>
      </td>
    </tr>

    <tr>
      <td><b>curve.x1</b></td>

      <td>Read only<br>
      numeric</td>

      <td>
        <p>Value of X at i2.</p>
      </td>
    </tr>

    <tr>
      <td><b>curve.y0</b></td>

      <td>Read only<br>
      numeric</td>

      <td>
        <p>Value of Y at i1.</p>
      </td>
    </tr>

    <tr>
      <td><b>curve.y1</b></td>

      <td>Read only<br>
      numeric</td>

      <td>
        <p>Value of Y at i2.</p>
      </td>
    </tr>

    <tr>
      <td><b>curve.ymax</b></td>

      <td>Read only<br>
      numeric</td>

      <td>
        <p>Maximum value of the active dataset with respect to the baseline.</p>
      </td>
    </tr>

    <tr>
      <td><b>curve.ymax0</b></td>

      <td>Read only<br>
      numeric</td>

      <td>
        <p>Maximum value of the active dataset with respect to zero.</p>
      </td>
    </tr>

    <tr>
      <td><b>curve.ymax0i</b></td>

      <td>Read only<br>
      numeric</td>

      <td>
        <p>Row index number for <b>ymax0</b>.</p>
      </td>
    </tr>

    <tr>
      <td><b>curve.ymax0x</b></td>

      <td>Read only<br>
      numeric</td>

      <td>
        <p>Value of X corresponding to <b>ymax0</b>.</p>
      </td>
    </tr>

    <tr>
      <td><b>curve.ymaxi</b></td>

      <td>Read only<br>
      numeric</td>

      <td>
        <p>Row index number for <b>ymax</b></p>
      </td>
    </tr>

    <tr>
      <td><b>curve.ymaxx</b></td>

      <td>Read only<br>
      numeric</td>

      <td>
        <p>Value of X corresponding to <b>ymax</b>.</p>
      </td>
    </tr>

    <tr>
      <td><b>curve.ymin</b></td>

      <td>Read only<br>
      numeric</td>

      <td>
        <p>Minimum value of the active dataset with respect to the baseline.</p>
      </td>
    </tr>

    <tr>
      <td><b>curve.ymini</b></td>

      <td>Read only<br>
      numeric</td>

      <td>
        <p>Row index number for <b>ymin</b>.</p>
      </td>
    </tr>

    <tr>
      <td><b>curve.yminx</b></td>

      <td>Read only<br>
      numeric</td>

      <td>
        <p>Value of X corresponding to <b>ymin</b>.</p>
      </td>
    </tr>
  </table>

  <h3><a name="Curve_Object_Properties_Specific_to_Math_Operations"></a><span class="mw-headline">Curve Object Properties Specific to Math Operations</span></h3>

  <table class="simple">
    <tr>
      <th width="110">Property</th>

      <th width="70">Access</th>

      <th width="540">Description</th>
    </tr>

    <tr>
      <td><b>curve.base$</b></td>

      <td>Read/write<br>
      string</td>

      <td>Name of the worksheet column that is used as a baseline. For integration, you must set this property. Set it to an existing dataset (<b>curve.base$</b> = <b>wks_colName;</b>) or specify the following: (<b>curve.base$</b> = <b>"";</b>). When <b>curve.base$</b> is set to "", then the <b>curve.integrate()</b> method integrates from y = 0.</td>
    </tr>

    <tr>
      <td><b>curve.integrate.area</b></td>

      <td>Read/write<br>
      numeric</td>

      <td>Integral.</td>
    </tr>

    <tr>
      <td><b>curve.polyDeg</b></td>

      <td>Read/write<br>
      numeric</td>

      <td>The degree of the underlying polynomial used for smoothing. Values can range from 1 to 9.</td>
    </tr>

    <tr>
      <td><b>curve.res</b></td>

      <td>Read only<br>
      numeric</td>

      <td>Tolerance for deviation in X axis values. This value is fixed at 5%.</td>
    </tr>

    <tr>
      <td><b>curve.result$</b></td>

      <td>Read/write<br>
      string</td>

      <td>Name of the (existing) dataset that stores the results. This property must be set before performing the math operation.</td>
    </tr>

    <tr>
      <td><b>curve.smoothLeftPts</b></td>

      <td>Read/write<br>
      numeric</td>

      <td>The number of points on the right of the data point being smoothed when using <b>curve.sgsmooth()</b>. This property combined with <b>curve.smoothRightPts</b> make up the smoothing window and can not exceed 100 points. The window can be asymmetric about a particular data point - i.e., the number of points to the left of the point of interest can be different from the number to the right.</td>
    </tr>

    <tr>
      <td><b>curve.smoothRightPts</b></td>

      <td>Read/write<br>
      numeric</td>

      <td>The number of points on the right of the data point being smoothed when using <b>curve.sgsmooth()</b>. This property combined with <b>curve.smoothLeftPts</b> make up the smoothing window and can not exceed 100 points. The window can be asymmetric about a particular data point - i.e., the number of points to the left of the point of interest can be different from the number to the right.</td>
    </tr>

    <tr>
      <td><b>curve.x$</b></td>

      <td>Read/write<br>
      string</td>

      <td>Name of the X column to use for the math operation.</td>
    </tr>
  </table>

  <h3><a name="Curve_Object_Properties_Specific_to_Baseline_Operations_and_Peak_Selection"></a><span class="mw-headline">Curve Object Properties Specific to Baseline Operations and Peak Selection</span></h3>

  <table class="simple">
    <tr>
      <th width="110">Property</th>

      <th width="70">Access</th>

      <th width="540">Description</th>
    </tr>

    <tr>
      <td><b>curve.areas$</b></td>

      <td>Read/write<br>
      string</td>

      <td>Worksheet column used for storing areas between base points.</td>
    </tr>

    <tr>
      <td><b>curve.basex$</b></td>

      <td>Read/write<br>
      string</td>

      <td>
        <p>Worksheet column used for storing X coordinate for the base points.</p>
      </td>
    </tr>

    <tr>
      <td><b>curve.basey$</b></td>

      <td>Read/write<br>
      string</td>

      <td>Worksheet column used for storing Y coordinate for the base points.</td>
    </tr>

    <tr>
      <td><b>curve.centers$</b></td>

      <td>Read/write<br>
      string</td>

      <td>Worksheet column used for storing the center points.</td>
    </tr>

    <tr>
      <td><b>curve.halfWidths$</b></td>

      <td>Read/write<br>
      string</td>

      <td>Worksheet column used for storing the half-widths.</td>
    </tr>

    <tr>
      <td><b>curve.heights$</b></td>

      <td>Read/write<br>
      string</td>

      <td>Worksheet column used for storing the heights.</td>
    </tr>

    <tr>
      <td><b>curve.integrate.area</b></td>

      <td>Read only<br>
      numeric</td>

      <td>Area under a single peak.</td>
    </tr>

    <tr>
      <td><b>curve.integrate.center</b></td>

      <td>Read only<br>
      numeric</td>

      <td>Center point of a single peak.</td>
    </tr>

    <tr>
      <td><b>curve.integrate.halfwidth</b></td>

      <td>Read only<br>
      numeric</td>

      <td>Half-width for a single peak.</td>
    </tr>

    <tr>
      <td><b>curve.integrate.height</b></td>

      <td>Read only<br>
      numeric</td>

      <td>Height of a single peak.</td>
    </tr>

    <tr>
      <td><b>curve.markerIndex$</b></td>

      <td>Read only<br>
      string</td>

      <td>Worksheet column used for storing the selected baseline points.</td>
    </tr>

    <tr>
      <td>
        <b>curve.maxPeakRange</b>

        <p>(You must also set <b>curve.minPeakRange</b> and <b>curve.minHeight</b>.</p>
      </td>

      <td>Read/write<br>
      numeric</td>

      <td>
        The value of this property is used for peak picking only if <b>curve.pickPeaks.simple</b> = 0.

        <p>Set this property to be the percentage of the total number of points in <b>curve.data$</b> that the peak must not exceed in order to be recognized as a peak.</p>
      </td>
    </tr>

    <tr>
      <td><b>curve.minDer</b></td>

      <td>Read/write<br>
      numeric</td>

      <td>Minimum value of the first derivative below which a point is accepted.</td>
    </tr>

    <tr>
      <td>
        <b>curve.minHeight</b>

        <p>(You must also set <b>curve.minPeakRange</b> and <b>curve.maxPeakRange</b>.)</p>
      </td>

      <td>Read/write<br>
      numeric</td>

      <td>
        The value of this property is used for peak picking only if <b>curve.pickPeaks.simple</b> = 0.

        <p>Set this property to be the percentage of the total amplitude (difference between min and max values) of <b>curve.data$</b> that a peak must have, to be considered a peak. This property enables you to exclude noise when determining peaks.</p>
      </td>
    </tr>

    <tr>
      <td>
        <b>curve.minPeakRange</b>

        <p>(You must also set <b>curve.maxPeakRange</b> and <b>curve.minHeight</b>.)</p>
      </td>

      <td>Read/write<br>
      numeric</td>

      <td>
        The value of this property is used for peak picking only if <b>curve.pickPeaks.simple</b> = 0.

        <p>Set this property to be the percentage of the total number of points in <b>curve.data$</b> that the peak must have in order to be recognized as a peak.</p>
      </td>
    </tr>

    <tr>
      <td><b>curve.peakDirection$</b></td>

      <td>Read/write<br>
      string</td>

      <td>Holds the name of the dataset that will have either a P (for positive) or an N (for negative) in the Peaks worksheet. The indexes of the peaks will be loaded in <b>curve.peakIndex$</b>.</td>
    </tr>

    <tr>
      <td><b>curve.peakIndex$</b></td>

      <td>Read/write<br>
      string</td>

      <td>Worksheet column used for storing the index for the peak points.</td>
    </tr>

    <tr>
      <td>
        <b>curve.pickPeaks.minHeight</b>

        <p>(You must also set <b>curve.pickPeaks.rectHeight</b> and <b>curve.pickPeaks.rectWidth</b>.)</p>
      </td>

      <td>Read/write<br>
      numeric</td>

      <td>
        The value of this property is used for peak picking only if <b>curve.pickPeaks.simple</b> = 1.

        <p>Set this property to be the percentage of the total amplitude (difference between min and max values) of <b>curve.data$</b> that a peak must have, to be considered a peak. This property enables you to exclude noise when determining peaks.</p>
      </td>
    </tr>

    <tr>
      <td>
        <b>curve.pickPeaks.rectHeight</b>

        <p>(You must also set <b>curve.pickPeaks.minHeight</b> and <b>curve.pickPeaks.rectWidth</b>.)</p>
      </td>

      <td>Read/write<br>
      numeric</td>

      <td>The value of this property is used for peak picking only if <b>curve.pickPeaks.simple</b> = 1. When<br>
      <b>curve.pickPeaks.simple</b> = 1, the <b>curve.pickPeaks()</b> method uses a search rectangle for peak picking. <b>Curve.pickPeaks.rectHeight</b> determines the height of the search rectangle.<br>
      Set this property to be the percentage of the difference between the maximum and minimum values in <b>curve.data$</b>.</td>
    </tr>

    <tr>
      <td>
        <b>curve.pickPeaks.rectWidth</b>

        <p>(You must also set <b>curve.pickPeaks.rectHeight</b> and <b>curve.pickPeaks.minHeight</b>.)</p>
      </td>

      <td>Read/write<br>
      numeric</td>

      <td>
        The value of this property is used for peak picking only if <b>curve.pickPeaks.simple</b> = 1. When<br>
        <b>curve.pickPeaks.simple</b> = 1, the <b>curve.pickPeaks()</b> method uses a search rectangle for peak picking. <b>Curve.pickPeaks.rectWidth</b> determines the width of the search rectangle.<br>

        <p>Set this property to be the percentage of the total range of values in <b>curve.data$</b>.</p>
      </td>
    </tr>

    <tr>
      <td><b>curve.pickPeaks.simple</b></td>

      <td>Read/write<br>
      numeric</td>

      <td>Set this property to 1 if <b>curve.data$</b> does not have a definable baseline. If <b>curve.data$</b> has a definable baseline (even if irregular), then set <b>curve.pickPeaks.simple</b> = 0.</td>
    </tr>
  </table>

  <h2><a name="Methods:"></a><span class="mw-headline"><font color="chocolate">Methods:</font></span></h2>

  <h3><a name="Curve_Object_Methods_Specific_to_Math_Operations"></a><span class="mw-headline">Curve Object Methods Specific to Math Operations</span></h3>

  <table class="simple">
    <tr>
      <th width="180">Method</th>

      <th>Description</th>
    </tr>

    <tr>
      <td><b>curve.adjave()</b></td>

      <td>Smoothing using the adjacent averaging method. The result is stored in <b>curve.result$.</b></td>
    </tr>

    <tr>
      <td><b>curve.deriv()</b></td>

      <td>Differentiate. The result is stored in <b>curve.result$.</b></td>
    </tr>

    <tr>
      <td><b>curve.FFTSmooth()</b></td>

      <td>Smoothing using the Fourier transform method. The result is stored in <b>curve.result$</b>.</td>
    </tr>

    <tr>
      <td><b>curve.integrate()</b></td>

      <td>Integrate. The result is stored in <b>curve.result$.</b></td>
    </tr>

    <tr>
      <td><b>curve.SGDeriv()</b></td>

      <td>Differentiate using the Savitzky-Golay method. The result is stored in <b>curve.result$</b>.</td>
    </tr>

    <tr>
      <td><b>curve.SGSmooth()</b></td>

      <td>Smoothing using the Savitzky-Golay method. The result is stored in <b>curve.result$</b>.</td>
    </tr>
  </table>

  <p>&#160;</p>

  <h3><a name="Curve_Object_Methods_Specific_to_Baseline_Operations_and_Peak_Selection"></a><span class="mw-headline">Curve Object Methods Specific to Baseline Operations and Peak Selection</span></h3>

  <table class="simple">
    <tr>
      <th width="180">Method</th>

      <th>Description</th>
    </tr>

    <tr>
      <td><b>curve.baseline()</b></td>

      <td>Find all points that make a baseline.</td>
    </tr>

    <tr>
      <td><b>curve.mrkIntegrate()</b></td>

      <td>Get the first baseline points on either side of the peak.</td>
    </tr>

    <tr>
      <td><b>curve.pickPeaks()</b></td>

      <td>Get all the peak points. The search method depends on property settings. See <b>curve.pickPeaks.simple, curve.maxPeakRange, curve.minHeight, curve.minPeakRange, curve.pickPeaks.minHeight, curve.pickPeaks.rectHeight, curve.pickPeaks.rectWidth</b>.</td>
    </tr>
  </table>

  <p>&#160;</p>

  <h2><a name="Examples:"></a><span class="mw-headline"><font color="chocolate">Examples:</font></span></h2>

  <h3><a name="Differentiation_Using_Savitzky-Golay_Method"></a><span class="mw-headline">Differentiation Using Savitzky-Golay Method</span></h3>

  <p>This script performs a differentiation using the Savitzky-Golay method:</p>
  <pre class="lt" style="font-family:monospace;">
 
<span style="color: #008000;">//Create a new book and import the data</span>
newbook;
string fpath<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"Samples\Signal Processing\fftfilter1.dat"</span>;
string fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> fpath<span style="color: #000080;">$</span>;
impasc;
wks.<span style="color: #000080;">addcol</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
col<span style="color: #000000;">(</span>c<span style="color: #000000;">)</span><span style="color: #000000;">[</span>L<span style="color: #000000;">]</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>Results;
<span style="color: #008000;">//Assign datasets</span>
curve.<span style="color: #000080;">data</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #000080;">%</span>H_B;
curve.<span style="color: #000080;">result</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #000080;">%</span>H_C;
curve.<span style="color: #000080;">i1</span> <span style="color: #000080;">=</span> <span style="color: #000080;">-</span><span style="color: #0000dd;">1</span>;
curve.<span style="color: #000080;">smoothpts</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>;
curve.<span style="color: #000080;">derivdeg</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
<span style="color: #008000;">//Perform differentiation, </span>
<span style="color: #008000;">//fill Result column of original worksheet</span>
curve.<span style="color: #000080;">sgderiv</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
</pre>

  <h3><a name="Peak_Integration_from_a_Baseline"></a><span class="mw-headline">Peak Integration from a Baseline</span></h3>

  <p>This script performs an integration from a baseline:</p>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">//Open a new worksheet</span>
newbook;
<span style="color: #008000;">//Import sample file;</span>
string fpath<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"Samples\Spectroscopy\Peaks with Base.DAT"</span>;
string fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> fpath<span style="color: #000080;">$</span>;
impasc;
<span style="color: #008000;">//Create a column for results</span>
wks.<span style="color: #000080;">addcol</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
col<span style="color: #000000;">(</span>D<span style="color: #000000;">)</span><span style="color: #000000;">[</span>L<span style="color: #000000;">]</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>Results;
curve.<span style="color: #000080;">data</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">%</span>H_B;
curve.<span style="color: #000080;">base</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">%</span>H_C;
curve.<span style="color: #000080;">result</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">%</span>H_D;
<span style="color: #008000;">//Perform integration, </span>
<span style="color: #008000;">//fill results column of original worksheet</span>
curve.<span style="color: #000080;">integrate</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
<span style="color: #008000;">//Send the total area to the script window</span>
type <span style="color: #ff00ff;">"Area = $(curve.integrate.area)"</span>;
</pre>

  <p><b>Example 3</b><br>
  This script finds peaks in the active data plot and adds the peak XY values and row index numbers to the original worksheet:</p>
  <pre class="lt" style="font-family:monospace;">
 
curve.<span style="color: #000080;">reset</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">//initialize</span>
<span style="color: #000080;">%</span>W <span style="color: #000080;">=</span> <span style="color: #000080;">%</span><span style="color: #000000;">[</span><span style="color: #000080;">%</span>C,<span style="color: #ff00ff;">'_'</span><span style="color: #000000;">]</span>; <span style="color: #008000;">//get name of wks for active data in layer</span>
<span style="color: #000080;">%</span>W<span style="color: #000080;">!</span>page.<span style="color: #000080;">xlcolname</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; <span style="color: #008000;">//turn off Spreadsheet Cell Notation firstly;</span>
<span style="color: #000080;">%</span>W<span style="color: #000080;">!</span>wks.<span style="color: #000080;">addcol</span><span style="color: #000000;">(</span>Pkindex<span style="color: #000000;">)</span>; <span style="color: #008000;">//add column to store index value</span>
<span style="color: #000080;">%</span>W<span style="color: #000080;">!</span>wks.<span style="color: #000080;">addcol</span><span style="color: #000000;">(</span>Pkx<span style="color: #000000;">)</span>;  <span style="color: #008000;">//add column to store x value</span>
<span style="color: #000080;">%</span>W<span style="color: #000080;">!</span>wks.<span style="color: #000080;">col</span><span style="color: #000080;">$</span><span style="color: #000000;">(</span><span style="color: #000080;">%</span>W<span style="color: #000080;">!</span>wks.<span style="color: #000080;">ncols</span><span style="color: #000000;">)</span>.<span style="color: #000080;">type</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">4</span>;  <span style="color: #008000;">//set as X column</span>
<span style="color: #000080;">%</span>W<span style="color: #000080;">!</span>wks.<span style="color: #000080;">addcol</span><span style="color: #000000;">(</span>Pky<span style="color: #000000;">)</span>;  <span style="color: #008000;">//add column to store y value</span>
curve.<span style="color: #000080;">data</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">%</span>C;  <span style="color: #008000;">//dataset to find peak values</span>
curve.<span style="color: #000080;">peakIndex</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">%</span>W_PkIndex;
curve.<span style="color: #000080;">pickPeaks</span>.<span style="color: #000080;">rectHeight</span> <span style="color: #000080;">=</span> .05;
curve.<span style="color: #000080;">pickPeaks</span>.<span style="color: #000080;">rectWidth</span> <span style="color: #000080;">=</span> .05;
curve.<span style="color: #000080;">pickPeaks</span>.<span style="color: #000080;">minHeight</span> <span style="color: #000080;">=</span> .05;
curve.<span style="color: #000080;">pickPeaks</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">//pick peaks without a definable baseline</span>
get <span style="color: #000080;">%</span>W_PkIndex <span style="color: #000080;">-</span>e end;
for <span style="color: #000000;">(</span>ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; ii <span style="color: #000080;">&lt;=</span> end; ii <span style="color: #000080;">+</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
      <span style="color: #000080;">%</span>B <span style="color: #000080;">=</span> curve.<span style="color: #000080;">data</span><span style="color: #000080;">$</span>;  <span style="color: #008000;">// %B is current active dataset</span>
      index <span style="color: #000080;">=</span> <span style="color: #000080;">%</span>W_pkindex<span style="color: #000000;">[</span>ii<span style="color: #000000;">]</span>; <span style="color: #008000;">// get peak index</span>
      <span style="color: #000080;">%</span>W_Pkx<span style="color: #000000;">[</span>ii<span style="color: #000000;">]</span> <span style="color: #000080;">=</span> xvalue<span style="color: #000000;">(</span>index,<span style="color: #000080;">%</span>B<span style="color: #000000;">)</span>; <span style="color: #008000;">// Set corresponding x value </span>
      <span style="color: #000080;">%</span>W_Pky<span style="color: #000000;">[</span>ii<span style="color: #000000;">]</span> <span style="color: #000080;">=</span> <span style="color: #000080;">%</span>B<span style="color: #000000;">[</span>index<span style="color: #000000;">]</span>;  <span style="color: #008000;">// Set corresponding y value</span>
<span style="color: #000000;">}</span>
</pre>

  <table class="noborder">
    <tr>
      <td style="vertical-align:top" width="60"><img src="../images/Curve_(object)/Tip_icon.png" width="57" border="0" alt=""></td>

      <td>
        <p>For the <a class="external text" href="../../UserGuide/UserGuide/Column_Short_Name_Restriction.html">Spreadsheet Cell Notation</a> in the workbook, please see <a class="external text" href="../../QuickHelp/QuickHelp/Turn_off_spreadsheet_cell_notation.html"><b>FAQ-849</b></a> for more information.</p>
      </td>
    </tr>
  </table>

  <p><b>Example 4</b><br>
  This example use <i>curve.smoothLeftPts</i> and <i>curve.smoothRightPts</i> to set the smoothing points.</p>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">//Create a new book and import the data</span>
newbook;
string fpath<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"Samples\Signal Processing\fftfilter1.dat"</span>;
string fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> fpath<span style="color: #000080;">$</span>;
impasc;
wks.<span style="color: #000080;">addcol</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
wks.<span style="color: #000080;">addcol</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;

<span style="color: #008000;">//smoothing points = 10</span>
col<span style="color: #000000;">(</span>c<span style="color: #000000;">)</span><span style="color: #000000;">[</span>c<span style="color: #000000;">]</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #0000dd;">10</span><span style="color: #000080;">-</span>point;
curve.<span style="color: #000080;">data</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #000080;">%</span>h_B;
curve.<span style="color: #000080;">result</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #000080;">%</span>h_c;
curve.<span style="color: #000080;">smoothleftpts</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>;
curve.<span style="color: #000080;">smoothrightpts</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span>;
curve.<span style="color: #000080;">smoothpts</span><span style="color: #000080;">=</span>curve.<span style="color: #000080;">smoothleftpts</span> <span style="color: #000080;">+</span> curve.<span style="color: #000080;">smoothrightpts</span> <span style="color: #000080;">+</span> <span style="color: #0000dd;">1</span>; 
curve.<span style="color: #000080;">polyDeg</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
curve.<span style="color: #000080;">derivdeg</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
curve.<span style="color: #000080;">sgderiv</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
</pre>
