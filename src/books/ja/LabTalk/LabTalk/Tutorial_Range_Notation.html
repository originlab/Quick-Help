<h1 class="firstheading">LabTalkにおける範囲表記</h1>

  <p class='urlname' style='display: none'>Tutorial-Range-Notation</p>

  <p>&#160;</p>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>目次</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1"><a href="#Summary"><span class="tocnumber">1</span> <span class="toctext">概要</span></a></li>

      <li class="toclevel-1 tocsection-2"><a href="#Declaration"><span class="tocnumber">2</span> <span class="toctext">宣言</span></a></li>

      <li class="toclevel-1 tocsection-3">
        <a href="#Workbooks"><span class="tocnumber">3</span> <span class="toctext">ワークブック</span></a>

        <ul>
          <li class="toclevel-2 tocsection-4"><a href="#Worksheet_Cell_Range"><span class="tocnumber">3.1</span> <span class="toctext">ワークシートセル範囲</span></a></li>

          <li class="toclevel-2 tocsection-5"><a href="#Column_Label_Row_Range"><span class="tocnumber">3.2</span> <span class="toctext">列ラベル行範囲</span></a></li>

          <li class="toclevel-2 tocsection-6"><a href="#Worksheet_Column_SubRange"><span class="tocnumber">3.3</span> <span class="toctext">ワークシート列の部分範囲</span></a></li>

          <li class="toclevel-2 tocsection-7"><a href="#Worksheet_Column_Range"><span class="tocnumber">3.4</span> <span class="toctext">ワークシート列範囲</span></a></li>

          <li class="toclevel-2 tocsection-8"><a href="#Worksheet_Range"><span class="tocnumber">3.5</span> <span class="toctext">ワークシート範囲</span></a></li>

          <li class="toclevel-2 tocsection-9"><a href="#Workbook_Page_Range"><span class="tocnumber">3.6</span> <span class="toctext">ワークブックページ範囲</span></a></li>
        </ul>
      </li>

      <li class="toclevel-1 tocsection-10">
        <a href="#Graphs"><span class="tocnumber">4</span> <span class="toctext">グラフ</span></a>

        <ul>
          <li class="toclevel-2 tocsection-11"><a href="#Graph_Data_Subrange"><span class="tocnumber">4.1</span> <span class="toctext">グラフデータ部分範囲</span></a></li>

          <li class="toclevel-2 tocsection-12"><a href="#Graph_Data_Range"><span class="tocnumber">4.2</span> <span class="toctext">グラフデータ範囲</span></a></li>

          <li class="toclevel-2 tocsection-13"><a href="#Graph_Layer_Range"><span class="tocnumber">4.3</span> <span class="toctext">グラフレイヤ範囲</span></a></li>

          <li class="toclevel-2 tocsection-14"><a href="#Graph_Page_Range"><span class="tocnumber">4.4</span> <span class="toctext">グラフページ範囲</span></a></li>
        </ul>
      </li>

      <li class="toclevel-1 tocsection-15">
        <a href="#Matrices"><span class="tocnumber">5</span> <span class="toctext">行列</span></a>

        <ul>
          <li class="toclevel-2 tocsection-16"><a href="#Matrix_Data_Subrange"><span class="tocnumber">5.1</span> <span class="toctext">行列データ部分範囲</span></a></li>

          <li class="toclevel-2 tocsection-17"><a href="#Matrix_Data"><span class="tocnumber">5.2</span> <span class="toctext">行列データ</span></a></li>

          <li class="toclevel-2 tocsection-18"><a href="#Matrixsheet"><span class="tocnumber">5.3</span> <span class="toctext">行列シート</span></a></li>

          <li class="toclevel-2 tocsection-19"><a href="#Matrixbook"><span class="tocnumber">5.4</span> <span class="toctext">行列ブック</span></a></li>
        </ul>
      </li>

      <li class="toclevel-1 tocsection-20"><a href="#Loose_Datasets"><span class="tocnumber">6</span> <span class="toctext">非接続データセット</span></a></li>

      <li class="toclevel-1 tocsection-21"><a href="#For_More_Information_on_Range"><span class="tocnumber">7</span> <span class="toctext">範囲について詳細情報</span></a></li>
    </ul>
  </div>

  <h2><a name="Summary"></a><span class="mw-headline">概要</span></h2>

  <p>Originプロジェクト内では、主に<b>ワークブック</b>、<b>グラフ</b>、<b>行列</b>、<b>ルースデータセット</b>の4つの場所にデータが存在します。</p>

  <p><a href="../../LabTalk/LabTalk/Range_Notation.html" title="LabTalk:範囲表記"><b>Range</b></a>変数を使うと、それらのオブジェクト内のデータにアクセスできます。range変数を宣言すると、rangeの読み込みまたは書き込みが可能です。</p>

  <table class="noborder">
    <tr>
      <td style="vertical-align:top" width="60"><img src="../images/Tutorial_Range_Notation/Alert_icon.png" width="57" border="0" alt=""></td>

      <td>
        <p><b>Orgin 2023</b>から、ページ名（ワークブック、行列、グラフなど）の範囲参照では、ページのロングネームはダブルクォートし、ページのショートネームはダブルクォートしないでください（これまではロングネームのダブルクォートが必須で、ショートネームのダブルクォートは可能でしたが、推奨されません）。ショートネームのダブルクォートの禁止は、置換による参照（例：<b>[%H]</b> が正しい、 <b>[&quot;%H&quot;]</b>にはしないでください）にも適用されます。この変更により、ページのロングネームの検索では、<i>アクティブなフォルダ</i>のウィンドウのロングネームを優先的に検索するようになります。この禁止事項により、フォルダの複製やプロジェクトの追加を行う際、より強固なページ参照が可能になります。ただし、以前の挙動にしたい場合は、システム変数<a href="../../LabTalk/LabTalk/System_Variable_List.html#R" title="LabTalk:システム変数リスト"><b>@RQS</b></a>を使ってこの変更をもとに戻すことができます。</p>
      </td>
    </tr>
  </table>

  <h2><a name="Declaration"></a><span class="mw-headline">宣言</span></h2>

  <p>range変数は他のデータタイプと同様の構文で宣言できます。</p>

  <p><b>range [<i>-option</i>] <i>RangeName</i> = <i>RangeString</i></b></p>

  <ul>
    <li>範囲指定の左辺は、すべてのタイプの範囲指定で統一されています。範囲名は<a href="../../LabTalk/LabTalk/Data_Types_and_Variables.html#Variable_Naming_Rules" title="LabTalk:データ型と変数">Origin変数の命名規則</a>に従います。<b>[<i>-option</i>]</b>コンポーネントはオプションのパラメーターを示し、使用可能なオプションスイッチはデータ型によって異なります（詳細は、<a href="../../LabTalk/LabTalk/Range_Notation.html#Types_of_Range_Data" title="LabTalk:範囲表記"><b>範囲データの型</b></a>を参照してください）。</li>

    <li>範囲割り当ての右側である<i><b>RangeString</b></i>は、オブジェクトの種類によって異なります。詳細については、次のサブトピックを参照してください。</li>
  </ul>

  <h2><a name="Workbooks"></a><span class="mw-headline">ワークブック</span></h2>

  <p>ワークブックデータに対して、<i><b><b>RangeString</b></b></i> は次の形式を取ります。</p>

  <p><b>[<i>WorkBookName</i>]<i>SheetNameOrIndex</i>!<i>ColumnNameOrIndex</i>[<i>CellIndex</i>]</b></p>

  <ul>
    <li><i>ショートネーム</i>がデフォルトのプログラミング名であるため、上記の<i><b>WorkBookName</b></i> と<i><b>SheetName</b></i> は対応する<i>ショートネーム</i>を参照します。</li>

    <li>ワークブックやワークシートの範囲表記で<i>ロングネーム</i>を使用するには、[&quot;MyBook&quot;]&quot;MySheet&quot;]のように<i>ロングネーム</i>をダブルクォーテーションで囲む必要があります！</li>

    <li>逆に、<i>ショートネーム</i>をダブルクォーテーションで囲まないでください（これには<a href="../../LabTalk/LabTalk/String_registers.html#.25_String_Registers" title="LabTalk:文字列レジスタ"><b>[%H]</b></a>のような参照も含みます）。Origin 2023より前では、この方法は推奨されてはいませんでしたが、使えていた<i>可能性があり</i>ます。Origin2023以降、<i>ショートネーム</i>をダブルクォートすると失敗する可能性が高くなりました。以前の挙動（ショートネームをダブルクォートすることを許可する）に戻したい場合は、LabTalkシステム変数<a href="../../LabTalk/LabTalk/System_Variable_List.html#R" title="LabTalk:システム変数リスト"><b>@RQS</b></a>をご覧ください。</li>

    <li>ショートネームのダブルクオートを禁止する変更に伴い、ページロングネームの検索では、ウィンドウ<b>ロングネーム</b>をアクティブフォルダから優先的に検索するようになりました。これは下記のようなことを可能にします。</li>
  </ul>

  <dl>
    <dd>
      <ul>
        <li>フォルダを複製し、ワークブックで定義されたローカル変数に依存するようなフォルダ内の操作を保持します。</li>

        <li>プロジェクトエクスプローラのフォルダをプロジェクトとして保存し、後でそのプロジェクトを別のプロジェクトに追加することができます。その際、ウィンドウのショートネームは名前の衝突を避けるために変更されますが、ウィンドウのロングネームに依存する操作には影響がありません。</li>
      </ul>
    </dd>
  </dl>

  <ul>
    <li><i><b>ColumnName</b></i> (引用符なし) には、列の<i>ロングネーム</i>または<i>ショートネーム</i>のいずれかを指定します。 (ロングネームにスペースがある場合は、二重引用符で囲む必要があります)</li>

    <li>2022bから、<a href="../../LabTalk/LabTalk/System_Variable_List.html#L" title="LabTalk:システム変数リスト"><b>@LNCS=1</b></a>で列ロングネームは大文字小文字を区別するようになりました。</li>
  </ul>

  <h3><a name="Worksheet_Cell_Range"></a><span class="mw-headline">ワークシートセル範囲</span></h3>

  <p>rangeを使用して単一セルまたはセルブロックにアクセスします。範囲は行および列をまたがる場合があります。</p>
  <pre>
 // cell(2,1)、列1の行2
 range aa = 1[2];  
 // cell(1,1) から cell(10,3)                   
 range bb = 1[1]:3[10];    
</pre>

  <p><b>Note</b>：セルブロックを表す範囲変数は、Xファンクションの引数としてのみ使用でき、直接計算はサポートされていません。</p>

  <p><br>
  <i><b>サンプル 1</b></i></p>
  <pre>
//列A、Bのあるワークブックを作成
newbook;
//第一列に値を入力
col(A) = {1:10};
// 列Aのデータセットをrange aa、列B（空）のデータセットをrange bbとして定義
range aa = col(A);
range bb = col(B);
// range aaセル1の値をrange bbセル1にコピー
bb[1] = aa[1];
</pre>

  <p><i><b>サンプル 2</b></i></p>
  <pre>
//新規ワークブックを作成
newbook;
//最初の列に値を入力
col(A) = {1:10};
// アクティブシートの名前を文字列変数&quot;yy$&quot;に置く
yy$ = %H;
// 値の列を範囲変数&quot;aa&quot;に定義
range aa = [yy$]1!col(A);
// 新規ワークブックを作成して&quot;zz$&quot;に名前を置く
newbook;
zz$ = %H;
// 新規ブック内の範囲を定義
range bb = [zz$]1!col(A);
// &quot;aa」セル1の値を&quot;bb」セル1に書き出し
bb[1] = aa[1];
</pre>

  <h3><a name="Column_Label_Row_Range"></a><span class="mw-headline">列ラベル行範囲</span></h3>

  <p>range変数を使ってアクティブワークブックの列ラベル行にアクセスします。</p>
  <pre class="lt" style="font-family:monospace;">
range rr<span style="color: #000080;">=</span><span style="color: #000000;">[</span>L<span style="color: #000000;">:</span>C<span style="color: #000000;">]</span>;
range rr<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span><span style="color: #000000;">[</span>L<span style="color: #000000;">]</span><span style="color: #000000;">:</span>end<span style="color: #000000;">[</span>L<span style="color: #000000;">]</span>;
</pre>

  <p>ラベル行の場合、range変数内で(-1)のような負の値は使用できないことに注意してください。</p>

  <p><br>
  <i><b>サンプル</b></i></p>
  <pre>
// 新規ワークブックを作成
newbook;
// ファイルをインポート
string fn$=system.path.program$ + &quot;Samples\Import and Export\ASCII Simple.dat&quot;;
impASC fname:=fn$;
// 生データを含む範囲変数を定義
range raw = [%H]1!col(signal);
// 第1および第2ユーザ定義パラメータ行を表示
wks.userParam1 = 1;  
wks.userParam2 = 1;
// 第一パラメータ行を&quot;Mean」第二パラメータ行を&quot;Std.Dev.&quot;に名前変更
wks.UserParam1$ = &quot;Mean&quot;;
wks.UserParam2$ = &quot;Std.Dev.&quot;;
// mean()およびstddev()関数を使用して、値を小数点以下 5 桁まで返す
// 範囲変数 raw のそれぞれのラベル行セルへ
raw[Mean]$ = $(mean(raw),*5);
raw[Std.Dev.]$ = $(stddev(raw),*5);
</pre>

  <p>列ラベル行データへのアクセスについての詳細とサンプルは以下を参照してください。</p>

  <ul>
    <li><a class="external text" href="../../LabTalk/LabTalk/Column_Label_Row_Characters.html">列ラベル行の文字</a></li>

    <li><a class="external text" href="../../LabTalk/Script/Accessing_Metadata.html">メタデータにアクセスする</a></li>
  </ul>

  <h3><a name="Worksheet_Column_SubRange"></a><span class="mw-headline">ワークシート列の部分範囲</span></h3>
  <pre>
// ブック1シート2列Aの3-10行の部分範囲
range cc = [book1]sheet2!col(a)[3:10];
</pre>
  <pre>
//アクティブワークシートの第一列を参照するrange
range r1 = !1;
//部分範囲を指定する場合変数を使用可能
int istart=3;
int iend=10;
range r2 = r1[istart:iend];
</pre>

  <p><br>
  <i><b>サンプル</b></i></p>
  <pre>
//新規ワークブックを作成
newbook;
//第一列に値を入力
col(A) = {1:10}; 
//この第一列を参照するrangeを作成
range rA = col(A);
//新規シートを追加
newsheet;
//最初のワークシートの最初の列の値をこの列に入力
col(A) = rA;
range rAA = col(A);
newsheet;
range r1 = rA[1:5];
range r2 = rAA[6:10];
col(A) = r1 + r2;
</pre>

  <h3><a name="Worksheet_Column_Range"></a><span class="mw-headline">ワークシート列範囲</span></h3>

  <p>データ列全体にアクセスするには、範囲変数を使用します。</p>

  <p>以下の例では、定義されているすべての範囲が、アクティブなワークシートの最初の列を参照しています (最初の列の名前が「A」と仮定)。col( )およびwcol( )関数は、Originの「列値の設定」ダイアログで使用されているものです。</p>
  <pre>
range rA = A;
range rAA = col(A);
range r1 = 1;
range ricol = wcol(ncol);
</pre>
  <pre>
int ncol = 1;
range rr = $(ncol);
</pre>

  <p><br>
  <i><b>サンプル</b></i></p>

  <p>範囲変数が作成されると、範囲のデータを直接操作することができるようになり、範囲への読み書きができるようになります。</p>
  <pre>
//新規ワークブックを作成
newbook;
//第一列に値を入力
col(A) = {1:10}; 
//第二列に値を入力
col(B) = {2:2:20};
//第一列を参照する範囲を作成
range rA = col(A);
//第二列を参照する範囲を作成
range rB = col(B);
//新規シートを追加
newsheet;
//列範囲の値に2をかけてA列に割り当て
col(A) = rA *2;
//列範囲の値を2で割ってB列に割り当て
col(B) = rB/2;
</pre>

  <p>特定のXファンクションで使用する場合、ワークシート内の複数の列またはセルのブロックの範囲を定義することができます。</p>
  <pre>
range raMC = col(2):col(4); // または 2:4
stats raMC;
ty %(raMC) values range from $(stats.min) to $(stats.max);
</pre>
  <pre>
range raBlock = 2[5]:10[300]; // 列2行5から列10行300
stats raBlock;
ty %(raBlock) values range from $(stats.min) to $(stats.max);
</pre>

  <p>Origin 2022bでは、@LNCS=1のときに列ロングネームは大文字小文字を区別します。</p>
  <pre>
col(&quot;M&quot;)=10*col(&quot;m&quot;); // &quot;M&quot; および &quot;m&quot;は別の列のロングネーム 
</pre>

  <h3><a name="Worksheet_Range"></a><span class="mw-headline">ワークシート範囲</span></h3>

  <p>ワークブックにアクセスするには、範囲変数を使用します。</p>
  <pre>
range rSheet1 = [Book1]Sheet1!;
range rSheet2 = 1!;
range rSheet3 = !;
</pre>

  <p>Note: アクティブなブックウィンドウBook1でSheet1がアクティブなときに上記のすべてのコマンド行を実行すると、3 つの範囲変数はすべて同じワークシートを参照します。</p>

  <p><br>
  <i><b>サンプル</b></i></p>
  <pre>
//新規ワークシートを作成
newsheet;
//アクティブワークシートを参照する範囲
range rWks = !;
</pre>

  <h3><a name="Workbook_Page_Range"></a><span class="mw-headline">ワークブックページ範囲</span></h3>

  <p>ワークブック全体にアクセスするには、範囲変数を使用します。以下のサンプルでは、ワークブックBook1をアクティブにして実行した場合、3つの範囲変数全てがBook1ウィンドウを参照します。</p>
  <pre>
range rPage1 = [Book1];
</pre>
  <pre>
//%H はアクティブウィンドウの名前を保持するシステム文字列レジスタ
range rPage2 = [%H];
</pre>
  <pre>
string strBookName$ = %H;
range rPage3 = [%(strBookName$)];
</pre>

  <h2><a name="Graphs"></a><span class="mw-headline">グラフ</span></h2>

  <p>グラフデータでは、<i><b>RangeString</b></i>は以下の形式を取ります。</p>

  <p><b>[<i>GraphWindowName</i>]<i>LayerNameOrIndex</i>!<i>DataPlot</i></b></p>

  <p>割り当ての例はこのようになります。</p>
  <pre class="lt" style="font-family:monospace;">
range ll <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>Graph1<span style="color: #000000;">]</span>Layer1<span style="color: #000080;">!</span><span style="color: #0000dd;">2</span>;       <span style="color: #008000;">// Graph1のLayer1にある2つ目の曲線</span>
</pre>

  <h3><a name="Graph_Data_Subrange"></a><span class="mw-headline">グラフデータ部分範囲</span></h3>

  <p><br>
  <i><b>サンプル</b></i></p>
  <pre>
//インデックス10 - 20のアクティブプロットを積分
integ1 1[10:20];
</pre>

  <h3><a name="Graph_Data_Range"></a><span class="mw-headline">グラフデータ範囲</span></h3>
  <pre>
range rAA = [Graph1]Layer1!1;
range rBB = 1!1;
range rCC = !1;
range rDD = 1;
</pre>

  <p>Note: Graph1ウィンドウのレイヤ1がアクティブな場合上述の3行を実行すると、3つの範囲変数全てがレイヤ内の第一データプロットを参照します。</p>

  <p><br>
  <i><b>サンプル</b></i></p>
  <pre>
range rr = 1;
set rr -c color(green);
</pre>

  <h3><a name="Graph_Layer_Range"></a><span class="mw-headline">グラフレイヤ範囲</span></h3>

  <p>グラフウィンドウ内のレイヤにアクセスするには、範囲変数を使用します。</p>
  <pre>
range rAA = [Graph1]Layer1!;
range rBB = 1!;
range rCC = !;
</pre>

  <p>Note: Graph1ウィンドウのレイヤ1がアクティブな場合上述の3行を実行すると、3つの範囲変数全てがそのレイヤを参照します。</p>

  <p><br>
  <i><b>サンプル</b></i></p>
  <pre>
//レイヤはOriginのオブジェクトです。  詳細はOriginオブジェクトのチュートリアルを参照してください。
//アクティブレイヤを参照するグラフレイヤオブジェクト
range rr= !;
//グラフレイヤオブジェクトの幅と高さを調整
rr.width=50;
rr.height=50;
</pre>

  <h3><a name="Graph_Page_Range"></a><span class="mw-headline">グラフページ範囲</span></h3>

  <p>グラフウィンドウ全体にアクセスするには、範囲変数を使用します。以下のサンプルでは、Graph1をアクティブにして実行した場合、3つの範囲変数全てがこのウィンドウを参照します。</p>
  <pre>
range rPage1 = [Graph1];
//%Hはアクティブウィンドウの名前を保持するシステム文字列レジスタ
range rPage2 = [%H];
</pre>
  <pre>
string strGraphName$ = %H;
range rPage3 = [%(strGraphName$)];
</pre>

  <h2><a name="Matrices"></a><span class="mw-headline">行列</span></h2>

  <p>行列データでは、<i><b>RangeString</b></i>は以下の形式を取ります。</p>

  <p><b>[<i>MatrixBookName</i>]<i>MatrixSheetNameOrIndex</i>!<i>MatrixObject</i></b></p>

  <table class="note">
    <tr>
      <td><b>Note:</b> <i>ショートネーム</i>がデフォルトのプログラミング名であるため、上記の<i>WorkBookName</i> と<i>SheetName</i> は対応する<i>ショートネーム</i>を使用しました。行列ブックと行列シートで範囲変数に<i>ロングネーム</i>を使用するには、[&quot;MyMatrixBook&quot;]&quot;MyMatrixSheet&quot;!のように、<i>ロングネーム</i> を二重引用符で囲みます。</td>
    </tr>
  </table>

  <h3><a name="Matrix_Data_Subrange"></a><span class="mw-headline">行列データ部分範囲</span></h3>

  <p>セルまたはセル範囲を指す範囲を宣言できます。行列は2D配列ですが、この場合のインデックスは、1から行列内のセル数までの1次元のインデックスです。番号付けは行の主要な順序で、ここでのインデックスの計算は次のとおりです。</p>
  <pre>
index = (RowNumber - 1) * NumberOfColumns + ColumnNumber
</pre>

  <p>たとえば、デフォルトの32x32の行列の場合、10番目の行および20番目の列のセルは以下ようなインデックスになります。</p>
  <pre>
(10 - 1) * 32 + 20 = 308
</pre>
  <pre>
range raMC = [MBook1]1!1[308];
raMC -= 100;
</pre>

  <h3><a name="Matrix_Data"></a><span class="mw-headline">行列データ</span></h3>

  <p>行列データは、行列オブジェクトと呼ばれ、 <b>wks.col</b>オブジェクトと同等です。</p>
  <pre>
range raMD = [MBook1]&quot;First Object Collection&quot;!1;
stats raMD;
ty %(raMD) ranges from $(stats.min) to $(stats.max);
</pre>

  <p>行列データ範囲を指定すると、行と列でセルにアクセスできます。</p>
  <pre>
raMD[10,20] += 100; // 行10、列20のセルを100ずつ増やす
</pre>

  <h3><a name="Matrixsheet"></a><span class="mw-headline">行列シート</span></h3>

  <p><b>wks</b>オブジェクトと同等の行列シートプロパティにアクセスできます。</p>
  <pre>
range raMS = [MBook1]MSheet1;
raMS.Name$ = First Object Collection;
</pre>

  <h3><a name="Matrixbook"></a><span class="mw-headline">行列ブック</span></h3>

  <p>行列ブック範囲を使用して行列ページのプロパティにアクセスできます。</p>
  <pre>
range raMB = [MBook1];
raMB.Label$ = Final Results;
</pre>

  <h2><a name="Loose_Datasets"></a><span class="mw-headline">非接続データセット</span></h2>

  <p>非接続データセット（ルースデータセット）は、ワークシートの列に似ていますが、ブック・シート・列構成を持ちません。非接続データセットは、通常、 <a href="../../LabTalk/LabTalk/Create_(command).html" title="LabTalk:Create (コマンド)">create コマンド</a> で作成されるか、<a href="../../LabTalk/LabTalk/Datasets_(object).html" title="LabTalk:Datasets (オブジェクト)">Dataset 宣言</a>せずに代入文で自動的に作成されます。</p>

  <p>非接続データセットでは、<i><b>RangeString</b></i>は以下の形式を取ります。</p>

  <p><b>[??]!<i>LooseDatasetName</i></b></p>

  <p>割り当ては、構文を使って行うことができます。</p>
  <pre class="lt" style="font-family:monospace;">
range xx <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>??<span style="color: #000000;">]</span><span style="color: #000080;">!</span>tmpdata_a;       <span style="color: #008000;">// 非接続データセット &apos;tmpdata_a&apos;</span>
</pre>

  <p><br>
  <i><b>サンプル</b></i></p>

  <p>ここでは、非接続データセットを作成し、<a class="external text" href="../../XFunction/X-Function/Plotxy.html">Xファンクション<b>plotxy</b></a>を使用してグラフをプロットします。</p>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">// 2つの非接続データセットを作成</span>
create tmpdata <span style="color: #000080;">-</span>wd <span style="color: #0000dd;">50</span> a b;
tmpdata_a<span style="color: #000080;">=</span>data<span style="color: #000000;">(</span><span style="color: #0000dd;">50</span>,<span style="color: #0000dd;">1</span>,<span style="color: #000080;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>;
tmpdata_b<span style="color: #000080;">=</span>normal<span style="color: #000000;">(</span><span style="color: #0000dd;">50</span><span style="color: #000000;">)</span>;
<span style="color: #008000;">// 範囲を宣言</span>
range aa<span style="color: #000080;">=</span><span style="color: #000000;">[</span>??<span style="color: #000000;">]</span><span style="color: #000080;">!</span><span style="color: #000000;">(</span>tmpdata_a, tmpdata_b<span style="color: #000000;">)</span>;
<span style="color: #008000;">// 散布図を作成</span>
plotxy aa;
</pre>

  <table class="noborder">
    <tr>
      <td style="vertical-align:top" width="60"><img src="../images/Tutorial_Range_Notation/Tip_icon.png" width="57" border="0" alt=""></td>

      <td>
        <p>非接続データセットは<a href="../../LabTalk/LabTalk/Data_Types_and_Variables.html#Scope_of_Variables" title="LabTalk:データ型と変数">プロジェクト</a>に属するので、宣言され、セッションまたは<a href="../../LabTalk/LabTalk/Data_Types_and_Variables.html#Local_Variables" title="LabTalk:データ型と変数">ローカルスコープ</a>を持つDataset変数とは異なります。<a href="../../LabTalk/LabTalk/Data_Types_and_Variables.html#Dataset" title="LabTalk:データ型と変数">データセット変数</a>も内部的には非接続データセットですが、計算のみに使用するよう制限されており、例えばプロット作成には使用できません。</p>
      </td>
    </tr>
  </table>

  <h2><a name="For_More_Information_on_Range"></a><span class="mw-headline">範囲について詳細情報</span></h2>

  <p>LabTalk 範囲構文の詳細については、LabTalkスクリプトガイドの<a class="external text" href="../../LabTalk/LabTalk/Range_Notation.html">「範囲表記」</a>を参照してください。</p>
