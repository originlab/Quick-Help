<h1 class="firstheading">Fdlog</h1>

  <p class='urlname' style='display: none'>Fdlog-obj</p>

  <p><b>LabTalk Object Type:</b></p>

  <dl>
    <dd><a href="../../LabTalk/LabTalk/Utility_Objects,_Property_and_Method_Syntax_(Object).html" title="LabTalk:Utility Objects, Property and Method Syntax (Object)">Utility</a></dd>
  </dl>

  <p>The <b>fdlog</b> object provides for script access to Origin's Open and Save As dialog boxes. These dialog boxes are a modification of the standard Windows dialog box that allows for a line of comments to be stored with Origin project files. The 32 bit version of Origin running under Windows 95 allows you to choose this dialog box (@X = 0 or <b>system.explorer</b> = 0) or the standard Explorer dialog box (@X = 1 or <b>system.explorer = 1</b>).</p>

  <p><br>
  <b>Note on Extension</b></p>

  <p>The portion of text in the file name that follows the last period. For example, BMP is the extension of the file named "MyImage.BMP".</p>

  <p><br>
  <b>Note on Extension Description</b></p>

  <p>The text that appears in the Files of Type combination box in the Open and Save As dialog box. This text is used to describe or identify the files that are named with a specific Extension. Example: Windows Bitmap (*.BMP)</p>

  <p><br>
  <b>Note on Extension Group</b></p>

  <p>A list of Extension Descriptions. Example: Images</p>

  <table class="noborder">
    <tr>
      <td style="vertical-align:top" width="60"><img src="../images/Fdlog_(object)/Tip_icon.png" width="57" border="0" alt=""></td>

      <td>
        <p>Please see the <a class="external text" href="../../XFunction/X-Function/DlgFile.html"><b>dlgFile</b></a>, <a class="external text" href="../../XFunction/X-Function/DlgSave.html"><b>dlgSave</b></a>, <a class="external text" href="../../XFunction/X-Function/DlgPath.html"><b>dlgPath</b></a> X-Function.</p>
      </td>
    </tr>
  </table>

  <h2><a name="Properties:"></a><span class="mw-headline"><font color="chocolate">Properties:</font></span></h2>

  <table class="simple">
    <tr>
      <th>Property</th>

      <th>Access</th>

      <th>Description</th>
    </tr>

    <tr>
      <td><b>fdlog.asReadOnly</b></td>

      <td>Read only,<br>
      numeric</td>

      <td>
        <p>This property is used to get the check state of the "Open as read-only" check box. The check box only appears on the dialog box displayed by the fdlog.open() method. The "Open as read-only" check box will be enabled when the Files of Type is for Origin projects (.OPJ or .ORG). When the "Files of type" is not set for Origin projects this check box will be unavailable (gray).</p>
      </td>
    </tr>

    <tr>
      <td><b>fdlog.checkName$</b></td>

      <td>Read/write,<br>
      string</td>

      <td>
        <p>This property is used to show and hide an optional check box on the dialog box. Set this property to any string to show the check box or to an empty string ("") to hide the check box. Use the fdlog.checkStatus property to get and set the state of the optional check box.</p>
      </td>
    </tr>

    <tr>
      <td><b>fdlog.checkStatus</b></td>

      <td>Read/write,<br>
      numeric</td>

      <td>
        <p>Get and set the state of the optional check box. Zero indicates not selected and non-zero indicates selected. Use the <b>fdlog.checkName$</b> property to show and hide the optional check box.</p>
      </td>
    </tr>

    <tr>
      <td><b>fdlog.choice</b></td>

      <td>Read only,<br>
      numeric</td>

      <td>
        <p>Get the index (starting with one) of the file type selected when the dialog box is closed. Note: It is recommended that the new property <b>fdlog.defType</b> be used instead of <b>fdlog.choice</b>.</p>
      </td>
    </tr>

    <tr>
      <td><b>fdlog.control</b></td>

      <td align="center">--</td>

      <td>
        <p>Not currently implemented.</p>
      </td>
    </tr>

    <tr>
      <td><b>fdlog.default$</b></td>

      <td>Read/write,<br>
      string</td>

      <td>
        <p>This property is used to get and set the contents of the File Name text box in the dialog boxes displayed by the <b>fdlog.open()</b> and <b>fdlog.saveAs()</b> method. Set this property to have a default file name appear when the dialog box opens and get this property after the dialog box closes for the name of the selected file. This string may contain a path and a file name. If a path is specified, then the <b>fdlog.path$</b> property is set. The File Name text box will not show the path. Only the file name is shown.</p>
      </td>
    </tr>

    <tr>
      <td><b>fdlog.defType</b></td>

      <td>Read/write,<br>
      numeric</td>

      <td>
        <p>This property is used to get the selected file type and set the default file type for the Files of Type combination box. Valid values are in the range [0, <b>fdlog.numTypes</b>]. The value determines which <b>fdlog.type$</b> is displayed in the Files of Type combination box. There is currently a limit of 25 file types.</p>
      </td>
    </tr>

    <tr>
      <td><b>fdlog.defTypeExt$</b></td>

      <td>Read/write,<br>
      string</td>

      <td>
        <p>Same as <b>fdlog.defType</b> except that it holds the extension of the type selected.</p>
      </td>
    </tr>

    <tr>
      <td><b>fdlog.dlgName$</b></td>

      <td>Read/write,<br>
      string</td>

      <td>
        <p>Use this property to get and set the name of the dialog box. Set to an empty string ("") to use the default names.<br>
        <a class="image"><img alt="Fdlog.png" src="../images/Fdlog_(object)/Fdlog.png" width="209"></a></p>
      </td>
    </tr>

    <tr>
      <td><b>fdlog.expASCII</b></td>

      <td align="center">--</td>

      <td>
        <p>Not currently implemented</p>
      </td>
    </tr>

    <tr>
      <td><b>fdlog.ext</b></td>

      <td align="center">--</td>

      <td>
        <p>This property is obsolete.</p>
      </td>
    </tr>

    <tr>
      <td><b>fdlog.message$</b></td>

      <td>Read/write,<br>
      string</td>

      <td>
        <p>Set the text in the static control of the Multi-open dialog box. It does not show a check box. If <b>fdlog.checkName$</b> is also set, it will supercede <b>fdlog.message$</b>.</p>
      </td>
    </tr>

    <tr>
      <td><b>fdlog.multiOpen.colView</b></td>

      <td>Read/write,<br>
      numeric</td>

      <td>
        <p>The MultiOpen dialog box contains a list of the user's selected files. By default, this list contains only the file's path and name. With this property you can display additional file information and even enable a way for the user to specify the column designation (how to import the file) for a selected file. This property is bit oriented and the following bits are used:<br>
        0 / 1 Show the Column Designation column.<br>
        1 / 2 Show the Template column.<br>
        2 / 4 Show the file's size.<br>
        3 / 8 Show the file's date of last modification.</p>
      </td>
    </tr>

    <tr>
      <td><b>fdlog.multiOpen.comboList$</b></td>

      <td>Read/write,<br>
      string</td>

      <td>
        <p>Contents of the combo box. Each item is separated with a .</p>
      </td>
    </tr>

    <tr>
      <td><b>fdlog.multiOpen.comboName$</b></td>

      <td>Read/write,<br>
      string</td>

      <td>
        <p>If empty, then hide the combo box. Otherwise, show the combo box and the label will equal the string.</p>
      </td>
    </tr>

    <tr>
      <td><b>fdlog.multiOpen.comboSel</b></td>

      <td>Read/write,<br>
      numeric</td>

      <td>
        <p>The default and the user selection from the combo box.</p>
      </td>
    </tr>

    <tr>
      <td><b>fdlog.multiOpen.count</b></td>

      <td>Read only,<br>
      numeric</td>

      <td>
        <p>After a MultiOpen dialog box closes, this property is set to the number of files selected. This property replaces the count variable that was previously being set.</p>
      </td>
    </tr>

    <tr>
      <td><b>fdlog.multiOpen.sort</b></td>

      <td>Read/write,<br>
      numeric</td>

      <td>
        <p>Set fdlog.multiOpen.sort to n to control sorting behavior in the MultiOpen dialog box:<br>
        0 = no sorting.<br>
        1 = sort the entire list after inserting selected files into the list.<br>
        2 = sort the selected files and then insert them at the end of the list.<br>
        This setting does not affect the sort behavior when clicking on the column headings. It only affects what happens prior to, and after, adding selected files to the list.</p>
      </td>
    </tr>

    <tr>
      <td><b>fdlog.multiOpen.colToggle</b></td>

      <td>Read/write,<br>
      numeric</td>

      <td>
        <p>When <b>fdlog.checkName$</b> is set, this property will toggle list box columns in the MultiOpen dialog box based on the state of the check box. It uses the same bits as <b>fdlog.multiOpen.colView</b>. For example: <b>fdlog.multiOpen.colToggle</b> = 6 will toggle the template and the size columns. If these columns were shown when opening the dialog box, then the first click on the check box will toggle them to not show, the next click will show them. For example, if the template column was shown and the size column was hidden when opening the dialog box, then the first click on the check box will hide the template column and show the size column, and the next click will show the template and hide the size.</p>
      </td>
    </tr>

    <tr>
      <td><b>fdlog.numTypes</b></td>

      <td>Read/write,<br>
      numeric</td>

      <td>
        <p>The number of extension types to appear in the Files of Type combination box. You can set this value to decrease or increase the number of types in the active group. This value must be in the range [0,25]. There is currently a limit of 25 file types.</p>
      </td>
    </tr>

    <tr>
      <td><b>fdlog.optionDlg$</b></td>

      <td>Read/write,<br>
      string</td>

      <td>
        <p>This property is used to show and hide an Option button on the dialog box. Currently, this is only used for the ASCII Import Options button when importing an ASCII file. Set this property to "IMPASCII" to show the button or to an empty string ("") to hide the button.</p>
      </td>
    </tr>

    <tr>
      <td><b>fdlog.path$</b></td>

      <td>Read/write,<br>
      string</td>

      <td>
        <p>This property is used to set the default path for when the dialog box opens and to get the path of the file selected when the dialog box closed.</p>
      </td>
    </tr>

    <tr>
      <td><b>fdlog.showComment</b></td>

      <td>Read/write,<br>
      numeric</td>

      <td>
        <p>For the Open dialog box, this property is used to show and hide the Show Info check box. The state of the Show Info check box determines if the Comments edit box is shown or hidden. For the SaveAs dialog box, this property is used to show and hide the Comments edit box. In both cases, the value 1 indicates show and the value 0 indicates hide.</p>
      </td>
    </tr>

    <tr>
      <td><b>fdlog.typen$</b></td>

      <td>Read/write,<br>
      string</td>

      <td>
        <p>Get and set the nth file type. These are the strings that appear in the Files of Type combination box. The index must be in the range [1, <b>NumTypes</b>]. The strings must be entered in the format "[description] extension". Example:</p>
        <pre class="lt" style="font-family:monospace;">
FDlog.<span style="color: #000080;">Type1</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"[Windows Bitmap  (*.BMP)] *.BMP"</span>;
</pre>

        <p>FDlog.numtypes needs to be set first. There is currently a limit of 25 file types. The <b>addtype</b> method can be used instead and <b>numtypes</b> will automatically be set.</p>
      </td>
    </tr>
  </table>

  <h2><a name="Methods:"></a><span class="mw-headline"><font color="chocolate">Methods:</font></span></h2>

  <table class="simple">
    <tr>
      <th>Method</th>

      <th>Description</th>
    </tr>

    <tr>
      <td><b>fdlog.addType(<i>extType</i>)</b></td>

      <td>
        <p>This method is used to create a new extension type. The extension type must be in the format "[description] *.extension" where description is the text that appears in the Files of Type combination box and extension is the extension of the files to display. On success, this method increments the <b>fdlog.numTypes property</b>. A group can have a maximum of 25 file types.</p>
      </td>
    </tr>

    <tr>
      <td><b>fdlog.addUserType(<i>Filtertype, Wintype</i>)</b></td>

      <td>
        <p>This method is used to select an installed import filter and destination window type.</p>

        <ul>
          <li><b>Note on Filtertype:</b></li>
        </ul>

        <p>0 = filters for ASCII data</p>

        <p>1 = filter for Binary data</p>

        <p>2 = user defined filters</p>

        <p>-1 = all filters (default)</p>

        <p>&#160;</p>

        <ul>
          <li><b>Note on Wintype:</b></li>
        </ul>

        <p>0 = any window type (default)</p>

        <p>2 = filters that support worksheets</p>

        <p>5 = filters that support matrix</p>
      </td>
    </tr>

    <tr>
      <td><b>fdlog.get(<i>letter, n, part</i>)</b></td>

      <td>
        <p>This method is used to get the names of the files selected in the MultiOpen dialog box. The first argument is the string variable that will receive the name. The second argument is the index of the selected file you want to receive the name of. The first file has an index of one. The number of files selected with the MultiOpen dialog box is stored in the numeric variable count. <i>Part</i> specifies the portion of the filename you want to get and if not specified defaults to a value of 0. 0 = Full filename, 1 = file name only (no extension), 2 = file extension only. <b>fdlog.get()</b> returns 0 for failure and 1 for success.</p>
      </td>
    </tr>

    <tr>
      <td><b>fdlog.getColStr(<i>letter, n</i>)</b></td>

      <td>
        <p>This method is used to get the plot designation columns of the files selected in the MultiOpen dialog box. The first argument is the string variable that will receive the plot designation columns. The second argument is the index of the selected file you want to receive the plot designation columns of. The first file has an index of one. The number of files selected with the MultiOpen dialog box is stored in the numeric variable count. <b>fdlog.getColStr()</b> returns 0 for failure and 1 for success.</p>
      </td>
    </tr>

    <tr>
      <td><b>fdlog.getTemplate(<i>letter, n</i>)</b></td>

      <td>
        <p>This method is used to get the templates of the files selected in the MultiOpen dialog box. The first argument is the string variable that will receive the template name. The second argument is the index of the selected file you want to receive the template name of. The first file has an index of one. The number of files selected with the MultiOpen dialog box is stored in the numeric variable count. <b>fdlog.getTemplate()</b> returns 0 for failure and 1 for success.</p>
      </td>
    </tr>

    <tr>
      <td><b>fdlog.gettypename(<i>letter,n</i>)</b></td>

      <td>
        <p>The first argument is the variable that will receive the type information. The second argument is the index of the file you want to receive the type of.</p>
      </td>
    </tr>

    <tr>
      <td><b>fdlog.multiOpen()</b></td>

      <td>
        <p>Display the MuliOpen dialog box. This dialog box allows the user to select multiple files. The default path is the path specified in the <b>fdlog.path$</b> property. The default file type is the type specified in the <b>fdlog.defType</b> property. The <b>fdlog.get()</b> method is used to get the names of the selected files. The number of files selected with the MultiOpen dialog box is stored in the numeric variable count.</p>
      </td>
    </tr>

    <tr>
      <td><b>fdlog.open(<i>letter</i>)</b></td>

      <td>
        <p>Display the Open dialog box. The default path is specified in the <b>fdlog.path$</b> property. The default file type is specified in the <b>fdlog.defType</b> property. This method returns zero for success or non-zero for failure.</p>
      </td>
    </tr>

    <tr>
      <td><b>fdlog.reset()</b></td>

      <td>
        <p>Resets all properties.</p>
      </td>
    </tr>

    <tr>
      <td><b>fdlog.saveAs(<i>letter</i>)</b></td>

      <td>
        <p>Display the Save As dialog box. The default path is specified in the <b>fdlog.path$</b> property. The default file type is specified in the <b>fdlog.defType</b> property. This method returns zero for success or non-zero for failure.</p>
      </td>
    </tr>

    <tr>
      <td><b>fdlog.useGroup(<i>groupName</i>)</b></td>

      <td>
        <p>This method allows you to setup a dialog box using an Extension Group defined with the <a href="../../LabTalk/LabTalk/System.FileExt_(object).html" title="LabTalk:System.FileExt (object)">system.fileExt</a> object. The argument is the name of the group. f successful, this method will have set the following properties: <b>fdlog.defType</b>, <b>fdlog.numTypes</b>, <b>fdlog.path$</b>, and <b>fdlog.type$</b>.</p>
      </td>
    </tr>

    <tr>
      <td><b>fdlog.useType(<i>extensions</i>)</b></td>

      <td>
        <p>This method should be used when you want to use a File Extension group, but not all the File Types in the group. You will still call <b>UseGroup</b>, but follow it with a call to <b>UseType</b>. The argument is the list of extensions for the File Types you want to appear in the File of Type combination box. All other file types will be removed. For example: If you have a group named Origin and this group contained the following types:</p>

        <ul>
          <li>[Project (*.OPJ)] *.OPJ</li>

          <li>[Old version (*.ORG)] *.ORG</li>

          <li>[Worksheets (*.OGW)] *.OGW</li>

          <li>[Graphs (*.OGG)] *.OGG</li>

          <li>[Matrix (*.OGM)] *.OGM</li>
        </ul>

        <p>The command <b>fdlog.useGroup(Origin)</b> will setup the <b>fdlog</b> object with the above types. If you then call the command <b>fdlog.useType("OPJ ORG")</b> the last three types will be removed. The benefit gained from this method is that tracking will still occur.</p>
      </td>
    </tr>
  </table>

  <h2><a name="Examples:"></a><span class="mw-headline"><font color="chocolate">Examples:</font></span></h2>

  <p>This script reads in data, performs calculations, and creates plots. The script is divided into three sections. The first section, the main section, handles the import as well as makes calls to the next two sections - calculate and createplot. Open the LabTalk Editor, enter this script into the editor, and then save it as a script file in your Origin folder. For example, you could save it as MYOGSFILE.ogs.</p>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #000000;">[</span>main<span style="color: #000000;">]</span>
fdlog.<span style="color: #000080;">reset</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
fdlog.<span style="color: #000080;">usegroup</span><span style="color: #000000;">(</span>ASCII<span style="color: #000000;">)</span>;
fdlog.<span style="color: #000080;">multiopen</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
loop <span style="color: #000000;">(</span>ii ,<span style="color: #0000dd;">1</span> , FDlog.<span style="color: #000080;">MultiOpen</span>.<span style="color: #000080;">Count</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
      Fdlog.<span style="color: #000080;">Get</span><span style="color: #000000;">(</span>A, ii<span style="color: #000000;">)</span>;  <span style="color: #008000;">//get the first selected filename</span>
      win <span style="color: #000080;">-</span>t data;  <span style="color: #008000;">//open a new worksheet</span>
      open <span style="color: #000080;">-</span>w <span style="color: #000080;">%</span>A;  <span style="color: #008000;">//import the first file into the worksheet</span>
      run.<span style="color: #000080;">section</span><span style="color: #000000;">(</span> , calculate<span style="color: #000000;">)</span>;
      run.<span style="color: #000080;">section</span><span style="color: #000000;">(</span> , createplot, <span style="color: #000080;">%</span>H<span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span>
<span style="color: #000000;">[</span>calculate<span style="color: #000000;">]</span>
wks.<span style="color: #000080;">addcol</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">//add a column to the worksheet</span>
<span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000080;">%</span>H,wks.<span style="color: #000080;">ncols</span><span style="color: #000000;">)</span> <span style="color: #000080;">=</span> <span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000080;">%</span>H,<span style="color: #0000dd;">1</span><span style="color: #000000;">)</span> <span style="color: #000080;">+</span> <span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000080;">%</span>H,<span style="color: #0000dd;">2</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">//perform a calculation</span>
<span style="color: #000000;">[</span>createplot<span style="color: #000000;">]</span>
<span style="color: #000080;">%</span>B<span style="color: #000080;">=</span><span style="color: #000080;">%</span>H;
win <span style="color: #000080;">-</span>t plot line;  <span style="color: #008000;">//open the line.otp graph template </span>
layer <span style="color: #000080;">-</span>i <span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000080;">%</span>B,<span style="color: #0000dd;">2</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">//plot the second column in the worksheet</span>
layer <span style="color: #000080;">-</span>a;  <span style="color: #008000;">//rescale to show all</span>
</pre>

  <p>To run this script, execute the following line of script (for example, in the Script window):</p>
  <pre class="lt" style="font-family:monospace;">
run.<span style="color: #000080;">section</span><span style="color: #000000;">(</span>MYOGSFILE,main<span style="color: #000000;">)</span>;
</pre>

  <p>This script opens the Open dialog box with *.OTP selected in the File Name text box and opens the selected graph template.</p>
  <pre class="lt" style="font-family:monospace;">
fdlog.<span style="color: #000080;">reset</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
fdlog.<span style="color: #000080;">ShowComment</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
fdlog.<span style="color: #000080;">UseGroup</span><span style="color: #000000;">(</span>Template<span style="color: #000000;">)</span>;
fdlog.<span style="color: #000080;">UseType</span><span style="color: #000000;">(</span>OTP<span style="color: #000000;">)</span>;
if <span style="color: #000000;">(</span>fdlog.<span style="color: #000080;">Open</span><span style="color: #000000;">(</span>A<span style="color: #000000;">)</span><span style="color: #000000;">)</span>
      return <span style="color: #0000dd;">1</span>;
<span style="color: #000080;">%</span>B <span style="color: #000080;">=</span> fdlog.<span style="color: #000080;">Path</span><span style="color: #000080;">$</span>;
doc <span style="color: #000080;">-</span>t <span style="color: #000080;">%</span>B<span style="color: #000080;">%</span>A;
</pre>

  <p>This script opens the Open Multiple Files dialog box with *.DAT selected in the File Name text box and opens the selected ASCII files in new worksheets.</p>
  <pre class="lt" style="font-family:monospace;">
fdlog.<span style="color: #000080;">reset</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
fdlog.<span style="color: #000080;">ShowComment</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
fdlog.<span style="color: #000080;">UseGroup</span><span style="color: #000000;">(</span>Ascii<span style="color: #000000;">)</span>;
fdlog.<span style="color: #000080;">UseType</span><span style="color: #000000;">(</span>DAT<span style="color: #000000;">)</span>;
if <span style="color: #000000;">(</span>fdlog.<span style="color: #000080;">MultiOpen</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000080;">!</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #000080;">/</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
      loop <span style="color: #000000;">(</span>ii, <span style="color: #0000dd;">1</span>, fdlog.<span style="color: #000080;">MultiOpen</span>.<span style="color: #000080;">Count</span><span style="color: #000000;">)</span>
      <span style="color: #000000;">{</span>
            win <span style="color: #000080;">-</span>t data Origin;
            FDlog.<span style="color: #000080;">Get</span><span style="color: #000000;">(</span>A, ii<span style="color: #000000;">)</span>;
            open <span style="color: #000080;">-</span>w <span style="color: #000080;">%</span>A;
      <span style="color: #000000;">}</span>
<span style="color: #000000;">}</span>
</pre>
