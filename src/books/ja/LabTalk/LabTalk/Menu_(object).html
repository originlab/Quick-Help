<h1 class="firstheading">Menu</h1>

  <p class='urlname' style='display: none'>Menu-obj</p>

  <p><br>
  <b>LabTalk Object Type:</b></p>

  <dl>
    <dd><a href="../../LabTalk/LabTalk/Utility_Objects,_Property_and_Method_Syntax_(Object).html" title="LabTalk:Utility Objects, Property and Method Syntax (Object)">Utility</a></dd>
  </dl>

  <p>The menu object methods and properties are designed for menu manipulation. They are most effective when used together with the menu command. The effects of the menu object methods may not be immediately apparent. It is sometimes necessary to make a different window type active before the result is visible. Alternatively, shrink Origin to an icon, then restore the application.<br>
  <b>Note</b>: Menu manipulation requires exact specification of the desired menu bar, menu, and menu commands. For information on how to specify the active menu bar and the active menu, see the <a href="../../LabTalk/LabTalk/Menu_(command).html" title="LabTalk:Menu (command)">menu command</a>.</p>

  <h2><a name="Properties:"></a><span class="mw-headline"><font color="chocolate">Properties:</font></span></h2>

  <table class="simple">
    <tr>
      <th width="110">Property</th>

      <th width="70">Access</th>

      <th width="540">Description</th>
    </tr>

    <tr>
      <td><b>menu.lastExeID</b></td>

      <td>Read only<br>
      numeric</td>

      <td>
        <p>Holds the ID number of the most recently executed menu command.</p>
      </td>
    </tr>

    <tr>
      <td><b>menu.lastID</b></td>

      <td>Read only<br>
      numeric</td>

      <td>
        <p>Holds the ID number of the most recently created menu command.</p>
      </td>
    </tr>

    <tr>
      <td><b>menu.level</b></td>

      <td>Read/Write<br>
      numeric</td>

      <td>
        <p>Gets and sets the menu level for menus created by cnf or omc files. For example, when menu.type=1 (use cnf file created menus), set menu.level = 2 is to choose the second menu in cnf file created menus group as active menu.</p>
      </td>
    </tr>

    <tr>
      <td><b>menu.level$</b></td>

      <td>Read/Write<br>
      string</td>

      <td>
        <p>Read and set Menu level by menu name defined in cnf file or by *.omc file name. For instance, menu.level$ =&#160;; will read the name of current active menu in cnf file or omc files created menus group.</p>
      </td>
    </tr>

    <tr>
      <td><b>menu.type</b></td>

      <td>Read/Write<br>
      numeric</td>

      <td>
        <p>Read and set Menu type. There are two menu types: 1 = menus from customized cnf file (eg. build-in Full Menus, Short Menus), 2 = menus from omc files.</p>
      </td>
    </tr>
  </table>

  <p>&#160;</p>

  <h2><a name="Methods:"></a><span class="mw-headline"><font color="chocolate">Methods:</font></span></h2>

  <table class="simple">
    <tr>
      <th width="180">Method</th>

      <th>Description</th>
    </tr>

    <tr>
      <td><b>menu.check(ID, num)</b></td>

      <td>
        <p>This method will only work for user-created menu commands. If num = 1, place a check mark next to the menu command with the specified menu ID. If num = 0, uncheck the menu command.</p>
      </td>
    </tr>

    <tr>
      <td><b>menu.cleanup( )</b></td>

      <td>
        <p>Remove all menu modifications, including those made in configuration files. To recover configuration file modifications, select an option from <b>Preference:Menu</b>.</p>
      </td>
    </tr>

    <tr>
      <td><b>menu.gray(ID, num)</b></td>

      <td>
        <p>Not currently implemented.</p>
      </td>
    </tr>

    <tr>
      <td><b>menu.itemDel(pos)</b></td>

      <td>
        <p>Delete the menu command at the specified pos position in the active menu.</p>
      </td>
    </tr>

    <tr>
      <td><b>menu.itemDelBelow(pos)</b></td>

      <td>
        <p>Delete the menu command at the specified pos position, and all the menu commands below it, from the active menu.</p>
      </td>
    </tr>

    <tr>
      <td><b>menu.rename(ID, name)</b></td>

      <td>
        <p>This method will only work for user-created menu commands. Rename the menu command with the specified menu ID to the specified name.</p>
      </td>
    </tr>
  </table>

  <h2><a name="Examples:"></a><span class="mw-headline"><font color="chocolate">Examples:</font></span></h2>

  <p>This script deletes the Copy menu command and all menu commands below it in the Edit menu.</p>
  <pre class="lt" style="font-family:monospace;">
 Menu <span style="color: #000080;">-</span>w;   <span style="color: #008000;">//make the Worksheet menu bar active</span>
menu ?Ed;   <span style="color: #008000;">//make the Edit menu active</span>
menu.<span style="color: #000080;">itemDelBelow</span><span style="color: #000000;">(</span><span style="color: #0000dd;">4</span><span style="color: #000000;">)</span>;
</pre>

  <p>This script creates a new menu command at the end of the Edit menu.</p>
  <pre class="lt" style="font-family:monospace;">
 Menu <span style="color: #000080;">-</span>P;   <span style="color: #008000;">//make the Layout menu bar active</span>
menu ?Ed;   <span style="color: #008000;">//make the Edit menu active</span>
Menu <span style="color: #000000;">(</span>My List<span style="color: #000000;">)</span> <span style="color: #000000;">{</span>type <span style="color: #000080;">-</span>b <span style="color: #ff00ff;">"my list"</span>;<span style="color: #000000;">}</span>;   
<span style="color: #008000;">// append My List menu command to the end of the Edit menu</span>
</pre>

  <p>This script finds the ID of the most recently created menu command, and then executes the menu command.</p>
  <pre class="lt" style="font-family:monospace;">
MyId <span style="color: #000080;">=</span> menu.<span style="color: #000080;">lastid</span>;   
<span style="color: #008000;">// set the value of myID to the ID of the last menu command</span>
menu <span style="color: #000080;">-</span>e myId; 
<span style="color: #008000;">// execute the menu command with ID 'myId'</span>
</pre>
