<h1 class="firstheading">CheckWksSelection</h1>

  <p class='urlname' style='display: none'>CheckWksSelection-macro</p>

  <p>Checks to see if you have selected all or part of a single Z column in the active worksheet. If not, an error message is printed to a message box. If so, it sets the variables nZcol, nYcol, and nXcol to their respective column number designations.</p>

  <h2><a name="Definition:"></a><span class="mw-headline"><font color="chocolate">Definition:</font></span></h2>
  <pre class="lt" style="font-family:monospace;">
Def CheckWksSelection <span style="color: #000000;">{</span>

      if <span style="color: #000000;">(</span>wks.<span style="color: #000080;">c1</span><span style="color: #000080;">!</span><span style="color: #000080;">=</span>wks.<span style="color: #000080;">c2</span> <span style="color: #000080;">||</span> wks.<span style="color: #000080;">c1</span><span style="color: #000080;">==</span><span style="color: #0000dd;">0</span> <span style="color: #000080;">||</span> wks.<span style="color: #000080;">col</span><span style="color: #000080;">$</span><span style="color: #000000;">(</span>wks.<span style="color: #000080;">c2</span><span style="color: #000000;">)</span>.<span style="color: #000080;">type</span><span style="color: #000080;">!</span><span style="color: #000080;">=</span><span style="color: #0000dd;">6</span><span style="color: #000000;">)</span> <span style="color: #000000;">{</span>
            type <span style="color: #000080;">-</span>b <span style="color: #ff00ff;">"You must select exactly one Z column"</span>;
            break <span style="color: #0000dd;">1</span>;
      <span style="color: #000000;">}</span>;
nZCol<span style="color: #000080;">=</span>wks.<span style="color: #000080;">c2</span>;   <span style="color: #008000;">// z col is selected z col</span>
nYCol<span style="color: #000080;">=</span><span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000080;">%</span>H,@Y<span style="color: #000080;">-</span>,wks.<span style="color: #000080;">c2</span><span style="color: #000000;">)</span>;
<span style="color: #008000;">// y col is immediately to left of z col</span>
nXCol<span style="color: #000080;">=</span><span style="color: #000080;">%</span><span style="color: #000000;">(</span><span style="color: #000080;">%</span>H,@X,nYCol<span style="color: #000000;">)</span>;
<span style="color: #008000;">// x col is first x col in worksheet</span>
<span style="color: #000000;">}</span>;
</pre>

  <h2><a name="Example:"></a><span class="mw-headline"><font color="chocolate">Example:</font></span></h2>

  <p>Given an active worksheet window with columns A(X1), B(X2), C(Y2), D(Y2), and E(Z2), the following script sets the variable nZcol equal to 5, nYcol equal to 4, and nXcol equal to 1.</p>
  <pre class="lt" style="font-family:monospace;">
CheckWksSelection;
</pre>
