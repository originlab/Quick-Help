<h1 class="firstheading">Origin C関数のロードとコンパイル</h1>
<p class="urlname" style="display: none;">Loading-and-Compiling-OC-Function</p>
<div id="toc" class="toc">
<div id="toctitle">
<h2>目次</h2>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Loading_and_Compiling_Origin_C_Function_or_WorkspaceCompile_Origin_CLoad_Origin_C"><span class="tocnumber">1</span> <span class="toctext">Origin C関数またはワークスペースのロードとコンパイル</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Example"><span class="tocnumber">1.1</span> <span class="toctext">サンプル</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-3"><a href="#Adding_Origin_C_Source_Files_to_System_Folder"><span class="tocnumber">2</span> <span class="toctext">Origin Cソースファイルをシステムフォルダに追加する</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Adding_Origin_C_Files_to_Project_.28OPJ.29"><span class="tocnumber">3</span> <span class="toctext">Origin Cファイルをプロジェクト(OPJ)に追加する</span></a></li>
</ul>
</div>
<h2><a name="Loading_and_Compiling_Origin_C_Function_or_WorkspaceCompile_Origin_CLoad_Origin_C" id="Loading_and_Compiling_Origin_C_Function_or_WorkspaceCompile_Origin_CLoad_Origin_C"></a><span class="mw-headline">Origin C関数またはワークスペースのロードとコンパイル</span></h2>
<p>OriginからOrigin C関数を呼び出す前に、現在のOriginセッションで関数をコンパイルリンクしておく必要があります。 ソースファイルをプログラムでコンパイルリンクしたり、LabTalkからワークスペースをビルドするには、LabTalkのrunオブジェクトの <a href="../../LabTalk/LabTalk/Run_(object).html#Methods" title="LabTalk:Run (オブジェクト)">run.loadOC</a>メソッドを使います。</p>
<pre class="lt" style="font-family: monospace;">
err <span style="color: #000080;">=</span> run.<span style="color: #000080;">LoadOC</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"myFile"</span>,<span style="color: #000000;">[</span>option<span style="color: #000000;">]</span><span style="color: #000000;">)</span>;
</pre>
<h3><a name="Example" id="Example"></a><span class="mw-headline">サンプル</span></h3>
<p>ロードされるOrigin Cファイルを走査するオプションを使って、Origin Cファイルの依存ファイルも自動的にロードされます。</p>
<pre class="lt" style="font-family: monospace;">
<span style="color: #008000;">// オプションを16とし、iw_filter.c のOrigin C関数を</span><span style="color: #008000;">
// ロードし、コンパイルする</span><span style="color: #008000;">
// これにより、iw_filter.c 内の.hファイルをスキャンする</span>
if<span style="color: #000000;">(</span>run.<span style="color: #000080;">LoadOC</span><span style="color: #000000;">(</span>OriginLab\iw_filter.<span style="color: #000080;">c</span>, <span style="color: #0000dd;">16</span><span style="color: #000000;">)</span> <span style="color: #000080;">!</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #000000;">)</span><span style="color: #000000;">
{</span>
        type <span style="color: #ff00ff;">"Failed to load iw_filter.c!"</span>;
        return <span style="color: #0000dd;">0</span>;<span style="color: #000000;">
}</span>
</pre>
<p>メニューの<b>表示：コードビルダ</b>を選択し、コードビルダを開きます。そして、<b>ワークスペース</b>パネル（表示されていない場合、<b>コードビルダ</b>のメニューアイテム<b>表示：ワークスペース</b>で表示）で、Temporary フォルダにある<i>iw_filter.c</i>ファイルを確認できます。</p>
<h2><a name="Adding_Origin_C_Source_Files_to_System_Folder" id="Adding_Origin_C_Source_Files_to_System_Folder"></a><span class="mw-headline">Origin Cソースファイルをシステムフォルダに追加する</span></h2>
<p>コードビルダでファイルを開いたら、コードビルダワークスペースの<b>System</b> ブランチにファイルをドラッグアンドドロップします。そうすることで新しいOriginセッションでもファイルをロードしコンパイルすることが保証されます。詳細情報は<a class="external text" href="../../UserGuide/UserGuide/The_Code_Builder.html">コードビルダ</a>を確認してください。</p>
<p>プログラムでソースファイルをsystemフォルダに追加して、Originが実行しているときにいつでも利用できるようにすることができます。</p>
<pre class="lt" style="font-family: monospace;">
run.<span style="color: #000080;">addOC</span><span style="color: #000000;">(</span>C<span style="color: #000000;">:</span>\Program Files\Originlab\Source Code\MyFunctions.<span style="color: #000080;">c</span><span style="color: #000000;">)</span>;
</pre>
<p>これは、ユーザに ツールを配布したり、<a class="external text" href="../../UserGuide/UserGuide/Create_a_User_Defined_Function_for_Set_Column_Values.html">値の設定</a>ダイアログで動作するように作られた関数を永久に利用できるようにするときに役に立ちます。</p>
<h2><a name="Adding_Origin_C_Files_to_Project_.28OPJ.29" id="Adding_Origin_C_Files_to_Project_.28OPJ.29"></a><span class="mw-headline">Origin Cファイルをプロジェクト(OPJ)に追加する</span></h2>
<p>Origin Cファイル(またはどんなファイルでも) をOriginプロジェクトファイルに追加することができます。そして、ファイルはOPJと一緒に保存され、プロジェクトが開いたときに抽出することができます。Origin Cファイルの場合、ファイルをコンパイルリンクすることもでき、ファイルにある関数にアクセスすることができます。プロジェクトにファイルを追加するには、単にファイルをコードビルダの<b>Project</b> ブランチにドラッグ＆ドロップするか、ブランチを右クリックして、ファイルを追加します。詳細情報は<a class="external text" href="../../UserGuide/UserGuide/The_Code_Builder.html">コードビルダ</a>を確認してください。</p>
