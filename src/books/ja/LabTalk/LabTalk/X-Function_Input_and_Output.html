<h1 class="firstheading">Xファンクションの入力と出力</h1><p class='urlname' style='display: none'>XF-Input-and-Output</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#X-Function_Variables"><span class="tocnumber">1</span> <span class="toctext">Xファンクションの変数</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Special_Keywords_for_Range"><span class="tocnumber">2</span> <span class="toctext">範囲の特殊なキーワード</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#ReportData_Output"><span class="tocnumber">3</span> <span class="toctext">レポートデータの出力</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Sending_ReportData_to_Worksheet"><span class="tocnumber">3.1</span> <span class="toctext">レポートデータをワークシートに送る</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Sending_ReportData_to_Tree_Variable"><span class="tocnumber">3.2</span> <span class="toctext">レポートデータをツリー変数に送る</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Assigning_Literal_Strings_to_X-function_Input"><span class="tocnumber">4</span> <span class="toctext">Xファンクション入力にリテラル文字列を割り当て</span></a></li>
</ul>
</div>

<h2><a name="X-Function_Variables"></a><span class="mw-headline">Xファンクションの変数</span></h2>
<p>Xファンクションは<a href="../../LabTalk/LabTalk/Data_Types_and_Variables.html" title="LabTalk:データ型と変数">LabTalkの変数型</a>(StringArrayを除く)を引数として受け付けます。LabTalk変数だけでなく、Xファンクションは複雑なデータ構造の特別な変数型を使うこともできます。 
</p><p>これらの特別な変数型は、下表にあるように Xファンクションへの引数としてのみ動作します。（使用可能なキーワードについての詳細は、この章にある<b>範囲の特殊なキーワード</b>セクションをご覧ください。）
</p>
<table class="simple">
<tr>
<th> 変数型</th>
<th> 説明</th>
<th> サンプル構造</th>
<th> コメント
</th></tr>
<tr>
<td> XYRange
</td>
<td>
<p>XとYの組合せ。任意でYエラーバーデータを含む。
</p>
</td>
<td>
<ol><li> (1,2)</li>
<li> &lt;new&gt;</li>
<li> (1,2:end)</li>
<li> (&lt;input&gt;,&lt;new&gt;)</li>
<li> [book2]sheet3!&lt;new&gt;</li></ol>
</td>
<td> グラフに対して、インデックスを直接使って、プロット範囲<br />(1,2)がグラフ上の1番目と2番目のプロットであることを示す。
</td></tr>
<tr>
<td> XYZRange
</td>
<td>
<p>X, Y, Zデータの組合せ。
</p>
</td>
<td>
<ol><li> (1,2,3)</li>
<li> &lt;new&gt;</li>
<li> [book2]sheet3!(1,&lt;new&gt;,&lt;new&gt;)</li></ol>
</td>
<td>
</td></tr>
<tr>
<td> ReportTree
</td>
<td>
<p>階層レポートのツリーベースオブジェクトは<br />ワークシート範囲またはLabTalkツリー変数に結びついている必要がある。
</p>
</td>
<td>
<ol><li> &lt;new&gt;</li>
<li> [&lt;input&gt;]&lt;new&gt;</li>
<li> [book2]sheet3</li></ol>
</td>
<td>
</td></tr>
<tr>
<td> ReportData
</td>
<td>
<p>ベクターのコレクションのツリーベースオブジェクトは<br />ワークシート範囲またはLabTalkツリー変数に結びついている必要がある。ReportTreeとは違って、ReportDataは通常のワークシートに出力し、ワークシート内の既存のデータの終わりに追加するのに使うことができる。ReportDataオブジェクト内のすべての列はグループ化されている必要がある。
</p>
</td>
<td>
<ol><li> &lt;new&gt;</li>
<li> [&lt;input&gt;]&lt;new&gt;</li>
<li> [book2]sheet3</li>
<li> [&lt;input&gt;]&lt;input&gt;!&lt;new&gt;</li></ol>
</td>
<td>
</td></tr></table>
<p>変数型についてより理解を深めるには、この章の<b>ReportDataの出力</b>セクションのサンプルを参照してください。
</p>
<h2><a name="Special_Keywords_for_Range"></a><span class="mw-headline">範囲の特殊なキーワード</span></h2>
<p><span class="OIndex" style="display:none">範囲の特殊なキーワード</span><span class="OIndex" style="display:none">Range Keyword</span>
</p>
<dl><dt>&lt;new&gt;</dt>
<dd>新規オブジェクトを追加/作成</dd>
<dt>&lt;active&gt;</dt>
<dd>アクティブオブジェクトを使用</dd>
<dt>&lt;input&gt;</dt>
<dd>同じXファンクションの入力範囲と同じ</dd>
<dt>&lt;same&gt;</dt>
<dd>Xファンクションの前の変数と同じ</dd>
<dt>&lt;optional&gt;</dt>
<dd>オブジェクトが入力または出力で任意であることを示す</dd>
<dt>&lt;none&gt;</dt>
<dd> オブジェクトは作成されない</dd></dl>
<h2><a name="ReportData_Output"></a><span class="mw-headline">レポートデータの出力</span></h2>
<p>多くのXファンクションが<b>ReportData</b> オブジェクトの形式で、複数の出力ベクターを生成します。  通常、ReportData オブジェクトはワークシートと結びついています。デフォルトでは、入力データと同じワークブックの新しいシートになります。
</p>
<h3><a name="Sending_ReportData_to_Worksheet"></a><span class="mw-headline">レポートデータをワークシートに送る</span></h3>
<p>出力が範囲（上記の特別な範囲、通常のワークシートまたは列範囲、または両方の組み合わせのいずれか）に設定されている場合、ReportDataはワークシートに出力されます。
</p><p>次のスクリプトは、ReportData出力をワークシートに配置します。 
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//Book2のSheet2 へ </span>
<span style="color: #008000;">//シートがない場合は作成</span>
<span style="color: #008000;">//シートがある場合は空の1列目から出力</span>
fft1 rd<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span>book2<span style="color: #000000;">]</span>sheet3<span style="color: #000080;">!</span>; 
<span style="color: #008000;">// Book2 の新規シートへ</span>
fft1 rd<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span>book2<span style="color: #000000;">]</span><span style="color: #000080;">&lt;</span>new<span style="color: #000080;">&gt;</span><span style="color: #000080;">!</span>;      
<span style="color: #008000;">// アクティブブックのアクティブシートの列4へ</span>
fft1 rd<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span><span style="color: #000080;">&lt;</span>active<span style="color: #000080;">&gt;</span><span style="color: #000000;">]</span><span style="color: #000080;">&lt;</span>active<span style="color: #000080;">&gt;</span><span style="color: #000080;">!</span>Col<span style="color: #000000;">(</span><span style="color: #0000dd;">4</span><span style="color: #000000;">)</span>;  
<span style="color: #008000;">// 入力データのワークブック内の新規シートへ</span>
fft1 rd<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span><span style="color: #000080;">&lt;</span>input<span style="color: #000080;">&gt;</span><span style="color: #000000;">]</span><span style="color: #000080;">&lt;</span>new<span style="color: #000080;">&gt;</span><span style="color: #000080;">!</span>;</pre>
<p>これらの新しい列を見つける追加のコードを記述する必要があるため、その後のデータへのアクセスはより複雑になります。
</p>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/X-Function_Input_and_Output/Alert_icon.png" width="57"  border="0" /></td><td><p>ReportDataタイプの出力には、使用されているXファンクションに応じて異なる量 (列) のデータが含まれることに注意してください。  結果を既存のシートに送信する場合は、生成されたReportData列で既存のデータを上書きしないように注意してください。
</p>
	</td>
	</tr>
	</table>
<h3><a name="Sending_ReportData_to_Tree_Variable"></a><span class="mw-headline">レポートデータをツリー変数に送る</span></h3>
<p>ReportDataを<a href="../../LabTalk/LabTalk/Data_Types_and_Variables.html#Tree" title="LabTalk:データ型と変数">Tree変数</a>に送ることで、このような出力を保持するワークシートを作成するオーバーヘッドを回避できます。 
</p><p>出力が<b>[Book]Sheet!</b>、<b>&lt;new&gt;</b>、<b>&lt;active&gt;</b>の範囲指定形式のいずれでもない場合は、自動的にLabTalkツリー名とみなされます。
</p><p>例えば、<b><a class="external text" href="../../XFunction/X-Function/Avecurves.html">avecurves</a></b> Xファンクション: には、<b>aveX</b>と<b>aveY</b> という2 つのリーフを持つ ReportData 出力が含まれています。 
</p><p>以下のスクリプトは、ワークシート内のデータを平均し、ReportData をツリー変数に出力します。ツリー変数には2つのベクトルリーフが含まれています。これら2つのリーフをデータセット変数に割り当て、データセット変数を折れ線グラフとしてプロットします。平均の結果を出力するための追加のワークシートや列は作成されません。
</p>
<pre class="lt" style="font-family:monospace;">col<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span><span style="color: #000080;">=</span>data<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">20</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">//col 1に1, 2, ...を入力20</span>
int nn <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>; 
loop<span style="color: #000000;">(</span>i,<span style="color: #0000dd;">2</span>,nn<span style="color: #000000;">)</span><span style="color: #000000;">{</span>wcol<span style="color: #000000;">(</span>i<span style="color: #000000;">)</span><span style="color: #000080;">=</span>normal<span style="color: #000000;">(</span><span style="color: #0000dd;">20</span><span style="color: #000000;">)</span>;<span style="color: #000000;">}</span>;  <span style="color: #008000;">//列2から5に正規化されたデータを入力</span>

<span style="color: #008000;">//2から5までの列の平均曲線を実行出力をツリー変数 tr に書き込み</span>
avecurves <span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">:</span><span style="color: #000080;">$</span><span style="color: #000000;">(</span>nn<span style="color: #000000;">)</span><span style="color: #000000;">)</span> rd<span style="color: #000000;">:</span><span style="color: #000080;">=</span>tr; 
tr.<span style="color: #000080;">=</span>; <span style="color: #008000;">// 内容を含むツリー構造を確認するには、aveX と aveY はベクトル</span>
<span style="color: #008000;">//ツリーの葉を一時的なデータセット変数に割り当て</span>
dataset avX <span style="color: #000080;">=</span> tr.<span style="color: #000080;">Result</span>.<span style="color: #000080;">aveX</span>;  
dataset avY <span style="color: #000080;">=</span> tr.<span style="color: #000080;">Result</span>.<span style="color: #000080;">aveY</span>;    

<span style="color: #008000;">// ワークシートのデフォルトのX列を使用してcol2から5を散布図としてプロット</span>
plotxy <span style="color: #000000;">(</span>?,<span style="color: #0000dd;">2</span><span style="color: #000000;">:</span>nn<span style="color: #000000;">)</span> p<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">201</span>;   

<span style="color: #008000;">//データセット変数avXをX、avYをYとする折れ線プロットをアクティブなグラフに追加</span>
plotxy <span style="color: #000000;">(</span>avX, avY<span style="color: #000000;">)</span> o<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>active<span style="color: #000080;">&gt;</span> p<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">200</span>;</pre>
<h2><a name="Assigning_Literal_Strings_to_X-function_Input"></a><span class="mw-headline">Xファンクション入力にリテラル文字列を割り当て</span></h2>
<p><b>&lt;[&lt;</b> および <b>&gt;]&gt;</b>は、LabTalkリテラル文字列をxあファンクションの入力変数に割り当てるために導入されました。入力文字列に文字列レジスタや<b>&apos;</b>、<b>&quot;</b>、<b>$</b>などの特殊文字が含まれている場合に便利です。
</p><p>以下のスクリプトは、xファンクション変数で<b>&lt;[&lt;</b> と <b>&gt;]&gt;</b>を使用するかどうかの違いを示しています。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000080;">%</span>A <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Mysplit&quot;</span>;
wsplit mode<span style="color: #000000;">:</span><span style="color: #000080;">=</span>ref ref<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span>Book1<span style="color: #000000;">]</span>Sheet1<span style="color: #000080;">!</span>A<span style="color: #ff00ff;">&quot;Fish&quot;</span> name<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;%A&quot;</span>;  <span style="color: #008000;">//結果シート名はMysplit</span>
wsplit mode<span style="color: #000000;">:</span><span style="color: #000080;">=</span>ref ref<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span>Book1<span style="color: #000000;">]</span>Sheet1<span style="color: #000080;">!</span>A<span style="color: #ff00ff;">&quot;Fish&quot;</span> name<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span><span style="color: #000000;">[</span><span style="color: #000080;">&lt;</span><span style="color: #000080;">%</span>A<span style="color: #000080;">&gt;</span><span style="color: #000000;">]</span><span style="color: #000080;">&gt;</span>; <span style="color: #008000;">//結果シートめーはFish </span>
<span style="color: #008000;">//名前は%aとして設定。これは、XFの参照列の名前として事前定義された変数</span></pre>
<p>次の例は、Xファンクション入力で<b>&quot;&quot;</b>を使用する方法を示しています。
</p>
<pre class="lt" style="font-family:monospace;">patternT text<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span><span style="color: #000000;">[</span><span style="color: #000080;">&lt;</span><span style="color: #ff00ff;">&quot;Sample A&quot;</span> <span style="color: #ff00ff;">&quot;Sample B&quot;</span> <span style="color: #ff00ff;">&quot;Sample C&quot;</span><span style="color: #000080;">&gt;</span><span style="color: #000000;">]</span><span style="color: #000080;">&gt;</span>;</pre>



    