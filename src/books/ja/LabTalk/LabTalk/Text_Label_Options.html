<h1 class="firstheading">テキストラベルの置換</h1><p class='urlname' style='display: none'>Text-Label-Options</p>
<p><span class="OIndex" style="display:none">ラベルオプション</span>
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#List_of_.40Options"><span class="tocnumber">1</span> <span class="toctext">@Optionsのリスト</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Column_Label_Rows"><span class="tocnumber">1.1</span> <span class="toctext">列ラベル行</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Workbook_Information"><span class="tocnumber">1.2</span> <span class="toctext">ワークブック情報</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Worksheet_Cell_Access"><span class="tocnumber">1.3</span> <span class="toctext">ワークシートセルへのアクセス</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Plot_Information"><span class="tocnumber">1.4</span> <span class="toctext">プロット情報</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Dataset.2FRange_Information"><span class="tocnumber">1.5</span> <span class="toctext">データセット/範囲情報</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Holder_Book_Information"><span class="tocnumber">1.6</span> <span class="toctext">ホルダーブック情報</span></a></li>
</ul>
</li>
</ul>
</div>
<p>ワークシートまたは行列データのグラフを作成する場合、軸のタイトルやグラフの凡例を含むほとんどの自動生成ラベルは、名前付きラベルオブジェクトにプロットメタデータを割り当てることによって作成されます。これらの名前付きラベルオブジェクトはそれぞれ、プロットのメタデータのさまざまな断片から事前定義された「空の」文字列としてグラフテンプレートに保存されます。これらのラベルへのプロットメタデータの実行時の割り当てを「置換」と呼び、「空の」文字列を作成するために使用される構文を「<a href="../../LabTalk/Category/Substitution_Notation.html" title="カテゴリ:置換表記">置換表記</a>」と呼びます。
</p><p><br />
</p>
<dl><dd><ul><li> 凡例のカスタマイズについては、<a href="../../LabTalk/LabTalk/Legend_Substitution_Notation.html" title="LabTalk:Legend Substitution Notation">凡例の置換表記</a>を参照してください。</li>
<li> 軸タイトル置換表記については、<a href="../../LabTalk/LabTalk/String_Substitution.html#Legend_and_Axis_Title_SubstitutionLegend_Substitution_Axis_Title_Substitution" title="LabTalk:String Substitution">軸タイトル置換</a>を参照してください。 </li>
<li> テキストラベルの置換に関するGUI指向の説明については、<a class="external text" href="../../UserGuide/UserGuide/Linking_Text_Labels_to_Data_and_Variables.html#Substituting_Values_for_Data_and_Variables_in_Text_Labels">テキストラベルのデータおよび変数の値の置換</a>を参照してください。 </li></ul></dd></dl>
<h2><a name="List_of_.40Options"></a><span class="mw-headline">@Optionsのリスト</span></h2>
<p>以下は、凡例テキストや軸タイトルなど、テキストラベルをカスタマイズするために使用できる<span class="OIndex">@テキストラベルオプション</span>の表です。サンプル式で参照されるワークシートのプロパティについては、このスクリーンショットを参照してください。
</p><p><a  class="image"><img alt="Worksheet Properties Legend Option 01.png" src="../images/Text_Label_Options/Worksheet_Properties_Legend_Option_01.png" width="632"  /></a>
</p>
<h4><a name="Column_Label_Rows"></a><span class="mw-headline">列ラベル行</span></h4>
<table class="simple">
<tr>
<th width="10%">@オプション
</th>
<th width="50%">参照元
</th>
<th width="40%">例
</th></tr>
<tr>
<td>@LS / @C
</td>
<td>列ショートネーム
</td>
<td><i>%(1,@LS)</i> --&gt; <b>B</b><br /><i>%(1,@C)</i> --&gt; <b>B</b>
</td></tr>
<tr>
<td>@LA
</td>
<td>利用可能ならロングネーム、そうでなければショートネーム
</td>
<td> <i>%(1,@LA)</i> --&gt; <b>Delta Temperature</b>
</td></tr>
<tr>
<td>@L / @LL
</td>
<td>ロングネームを表示しますが、ロングネームがないときには欠損値を返します。@LLと同様です。
</td>
<td><i>%(1Y,@L)</i> --&gt; <b>Delta Temperature</b><br /> <i>%(1,@LL)</i> --&gt; <b>Delta Temperature</b>
</td></tr>
<tr>
<td>@LG / @U
</td>
<td>ロングネーム（使用できなければショートネーム）と単位（あれば）@LGと同様です。
</td>
<td><i>%(1,@LG)</i> --&gt;<b>Delta Temperature (K)</b> <br /><i>%(1,@U)</i> --&gt;<b>Delta Temperature (K)</b>
</td></tr>
<tr>
<td>@LC
</td>
<td>利用可能ならコメント、そうでなければロングネーム、それもできなければショートネームを参照
</td>
<td><i>%(1,@LC)</i> --&gt;<br /> <b>YBCO</b><br /><b>milled</b>
</td></tr>
<tr>
<td>@LC[<i>n</i>]
</td>
<td>コメントラベル行セルの<i>n</i>番目の行<i>n</i>はオプションで@LC1=@LCです
</td>
<td><i>%(1,@LC2)</i> --&gt;<b>milled</b>
</td></tr>
<tr>
<td>@LM
</td>
<td>利用可能ならコメントの1行目を、できなければロングネームを、それもできなければショートネームを参照
</td>
<td><i>%(1,@LM)</i> --&gt; <b>YBCO</b>
</td></tr>
<tr>
<td>@LN
</td>
<td>コメントの1行目（利用できなければロングネームを、それもできなければショートネーム）を参照<i>@(@LM(@LU))</i>.と同じ
</td>
<td> <i>%(1,@LN)</i> --&gt; <b>YBCO(K)</b>
</td></tr>
<tr>
<td>@LU
</td>
<td>単位
</td>
<td><i>%(1,@LU)</i>  --&gt; <b>K</b>
</td></tr>
<tr>
<td>@LUP,@LUS,@LUA,@LUC
</td>
<td>単位に括弧を追加します。<b>P</b>は括弧 = (), <b>S</b>は角括弧 = [], <b>A</b>は山括弧 = &lt;&gt;, <b>C</b>は波括弧 = {}
</td>
<td><i>%(1,@LUA)</i>  --&gt; <b>&lt;K&gt;</b>
</td></tr>
<tr>
<td>@LD
</td>
<td>第一ユーザ定義パラメータ
</td>
<td><i>%(1,@LD)</i> --&gt;&apos;<i>S21</i>
</td></tr>
<tr>
<td>@LD[<i>n</i>]
</td>
<td><i>n</i>番目のユーザ定義パラメータ<i>n</i>は必須ではなく、@ LD1 = @ LDであることに注意してください。
</td>
<td><i>%(1,@LD2)</i> --&gt;<b>235</b>
</td></tr>
<tr>
<td> @LD&quot;<i>name</i>&quot;
</td>
<td>	nameによって特定されるユーザ定義パラメータ。
</td>
<td><i>%(1,@LD&quot;RunNo&quot;)</i>--&gt;<b>07</b>
</td></tr>
<tr>
<td>@LH
</td>
<td>1番目のユーザ定義パラメータ行の名前
</td>
<td><i>%(1,@LH)</i> --&gt;<b>UserDefined</b>
</td></tr>
<tr>
<td>@LQ
</td>
<td>1番目のユーザ定義パラメータと単位（利用できれば）を参照
</td>
<td><i>%(1,@LQ)</i> --&gt; <b>S21(K)</b>
</td></tr>
<tr>
<td>@LQ[<i>n</i>]
</td>
<td><i>n</i>番目のユーザ定義パラメータと単位（利用できれば）を参照単位が含まれているという点で@LHとは異なります。<i>n</i>はオプションで@LQ1=@LQです
</td>
<td><i>%(1,@LQ2)</i> --&gt; <b>235(K)</b>
</td></tr>
<tr>
<td>@LQ&quot;<i>name</i>&quot;
</td>
<td>ユーザ定義パラメータ（<i>name</i>によって決定）と単位（利用できれば）を参照
</td>
<td><i>%(1,@LQ&quot;RunNo&quot;)</i> --&gt; <b>07(K)</b>
</td></tr>
<tr>
<td>@LH[<i>n</i>]
</td>
<td><i>n</i>番目のユーザー定義パラメータの名前。  <i>n</i>は必須ではなく、@ LH1 = @ LHであることに注意してください。
</td>
<td><i>%(1,@LH3)</i> --&gt;<b>RunNo</b>
</td></tr>
<tr>
<td>@LP
</td>
<td> 1番目のシステムパラメータ
</td>
<td><i>%(1,@LP)</i> --&gt; <b>Version 2.1</b>
</td></tr>
<tr>
<td>@LP[<i>n</i>]
</td>
<td><i>n</i>番目のシステムパラメータ。<i>n</i>は必須ではなく、@ LP1 = @ LPであることに注意してください。
</td>
<td><i>%(1,@LP2)</i> --&gt; <b>12/15/2004</b>
</td></tr>
<tr>
<td>@LF[<i>n</i>]
</td>
<td>データプロットの<a class="external text" href="../../UserGuide/UserGuide/Data_Filter.html">フィルタ条件</a>。複数の条件がある場合には、オプションの<i>n</i>=が<i>n</i>行目のフィルタ条件であることを示します。（リストの順番はフィルタラベル行セルで表示されています）<a href="../../LabTalk/LabTalk/System_Variable_List.html#S" title="LabTalk:システム変数リスト">LatTalkシステム変数<b>@SFD</b></a>もご覧ください。
</td>
<td>Make = <i>%(1,@LF)</i>--&gt;<b>Buick</b>
<p><a  class="image"><img alt="Text label options @LF.png" src="../images/Text_Label_Options/Text_label_options__40LF.png" width="442"  /></a>
</p>
</td></tr></table>
<h4><a name="Workbook_Information"></a><span class="mw-headline">ワークブック情報</span></h4>
<table class="simple">
<tr>
<th width="10%">@オプション
</th>
<th width="35%">参照元
</th>
<th width="50%">例
</th></tr>
<tr>
<td>@WL
</td>
<td>ブックのロングネーム<br />（ワークブック、行列）
</td>
<td><i>%(1,@WL)</i> --&gt;<b>S21-235-07</b>
</td></tr>
<tr>
<td>@W
</td>
<td>ブックのショートネーム<br />（ワークブック、行列）
</td>
<td> <i>%(1,@W)</i> --&gt;<b>Book1</b>
</td></tr>
<tr>
<td>@WC[<i>n</i>]
</td>
<td>ワークブックコメントの<i>n</i>番目の行。<i>n</i>の指定がない場合には最初の行のみが表示されます。
</td>
<td><i>%(1,@WC2)</i> --&gt;
<p><b>&lt;Origin EXE Folder&gt;\Samples\Curve Fitting</b>
</p>
</td></tr>
<tr>
<td>@WS
</td>
<td>シートの名前<br />（ワークブック、行列）
</td>
<td><i>%(1,@WS)</i> --&gt;<b>Trial Run 2</b>
</td></tr>
<tr>
<td>@WNL
</td>
<td>シートのロングネーム<br />（ワークブック、行列）
</td>
<td><i>%(1,@WNL)</i> -- <a href="../../LabTalk/LabTalk/System_Variable_List.html#S" title="LabTalk:システム変数リスト">LabTalkシステム変数<b>@SSL</b>参照</a>
</td></tr>
<tr>
<td>@WNS
</td>
<td>シートのショートネーム<br />（ワークブック、行列）
</td>
<td><i>%(1,@WNS)</i> -- <a href="../../LabTalk/LabTalk/System_Variable_List.html#S" title="LabTalk:システム変数リスト">LabTalkシステム変数<b>@SSL</b>参照</a>
</td></tr>
<tr>
<td>@WM[<i>n</i>]
</td>
<td>ワークシートコメントの<i>n</i>番目の行。<i>n</i>の指定がない場合には最初の行のみが表示されます。
</td>
<td><i>%(1,@WM)</i> --&gt;<b>Data imported from</b>
</td></tr>
<tr>
<td>@WN
</td>
<td>セルノートの内容。
</td>
<td>*<i>%(1,@WN,1)</i>
<ul><li><dl><dd>1番目のプロットのソース列の行[1]のノートの内容。</dd></dl></li>
<li><i>%(1,@WN,B,3)</i> 
<dl><dd>現在のプロットのデータシートの列Bの行[1]のノートの内容。</dd></dl></li>
<li><i>%(1,@WN,C)</i> 
<dl><dd>ソース列のコメントセル内のノートの内容。</dd></dl></li>
<li><i>%(1,@WN,B,L)</i> 
<dl><dd>現在のプロットのデータシート内の列BのLNセルノート</dd></dl></li>
<li><i>%([book1]1,@WN,col(B)[L])</i> 
<dl><dd>シート内の列BのLNセルノート</dd></dl></li></ul>
</td></tr>
<tr>
<td> @WP
</td>
<td>プロジェクトエクスプローラー内でのブックのパス<br />（ワークブック、行列）
</td>
<td><i>%(1,@WP)</i> --&gt;<b>/Folder1/</b>
</td></tr></table>
<h4><a name="Worksheet_Cell_Access"></a><span class="mw-headline">ワークシートセルへのアクセス</span></h4>
<table class="simple">
<tr>
<th width="10%">@オプション
</th>
<th width="35%">参照元
</th>
<th width="50%">例
</th></tr>
<tr>
<td>@L, n
</td>
<td>データプロット内にある<i>n</i>番目のポイントのX値
</td>
<td>* <i>%(1, @L, 2)</i>
<ul><li><dl><dd>は１つ目のデータプロット内にある2番目のポイントのX値を指します。</dd></dl></li></ul>
</td></tr>
<tr>
<td>@V, n
</td>
<td>データプロット内にある<i>n</i>番目のポイントのY値
</td>
<td>* <i>&nbsp;%(1, @V, 2)</i>
<ul><li><dl><dd>は１つ目のデータプロット内にある2番目のポイントのY値を指します。</dd></dl></li></ul>
</td></tr>
<tr>
<td>@WT, <i>ColIndex</i>/<i>ColName</i>, <i>RowIndex</i>
</td>
<td>列番号（もしくはショートネームや行番号）で指定されたワークシートセルの値
</td>
<td>*<i>%(1, @WT, 2, 3)</i>
<ul><li><dl><dd>1つ目のデータプロットのソースシート（ワークシート、行列）にある2列3行目のセルの値</dd></dl></li>
<li><i>$(&nbsp;%(1, @WT, 2, 3,.4 ) * 100, .2 )</i>
<dl><dd> 数値なので、列2、行3の値を取得し、小数点以下4 桁を保持したまま100倍して、小数点以下2桁を表示するようにフォーマット</dd></dl></li>
<li><i>%(1, @WT, B, 3)</i> 
<dl><dd>1つ目のデータプロットのソースワークシートにあるB列3行目のセルの値</dd></dl></li></ul>
</td></tr>
<tr>
<td>@WT, <i>ColIndex</i>/<i>ColName</i>, <i>ColLabelRowCharacter</i>
</td>
<td>列番号（もしくはショートネーム）と<a href="../../LabTalk/LabTalk/Column_Label_Row_Characters.html" title="LabTalk:列ラベル行の文字">列ラベルの行の文字</a>で指定されたワークシートセルの値
</td>
<td>*<i>%(1, @WT, B, C)</i>
<ul><li><dl><dd><a href="../../LabTalk/LabTalk/Column_Label_Row_Characters.html#Examples" title="LabTalk:列ラベル行の文字">B[C]$</a>と同様に、これは1つ目のデータプロットのソースワークシートにある列Bのコメントを取得します。</dd></dl></li></ul>
</td></tr></table>
<h4><a name="Plot_Information"></a><span class="mw-headline">プロット情報</span></h4>
<table class="simple">
<tr>
<th width="10%">@オプション
</th>
<th width="45%">参照元
</th>
<th width="45%">例
</th></tr>
<tr>
<td>@GG
</td>
<td>グラフの現在のプロットのグループ名
</td>
<td><i>%(2, @GG)</i>
<dl><dd> 現在のプロットのグループ名を表示します。デフォルトのグループ名<b>g<i>#</i></b>は空白を表示します。</dd></dl>
</td></tr>
<tr>
<td>@GL
</td>
<td>グラフの現在のプロットのレイヤ名
</td>
<td> <i>%(2, @GL)</i>
<dl><dd> 現在のプロットのレイヤ名を表示します。デフォルトのレイヤ名<b>Layer<i>#</i></b>は空白を表示します。</dd></dl>
</td></tr>
<tr>
<td>@L[<i>n</i>]
</td>
<td>現プロットの情報<br />
<p>@L1: プロットインデックス<br />
@L2: グループ名 <br />
@L3: レイヤ名
</p>
</td>
<td><i>%(1,@L1)</i> --&gt; <b>1</b><br />
<p><i>%(1,@L2)</i> --&gt; <b>g1</b><br />
<i>%(1,@L3)</i> --&gt; <b>Layer1</b> 
</p>
</td></tr>
<tr>
<td>@LX
</td>
<td>列のXY属性インデックス<br />列A(X1)、B(Y1)、C(X2)、D(Y2)があり、一つのグラフにプロットした場合、@LXを使って列属性インデックスを取得し、凡例テキストに1, 2と表示できます。
</td>
<td><i>%(1,@LX)</i>  --&gt; <b>1</b>
</td></tr>
<tr>
<td>@V&quot;above&quot;/@V&quot;below&quot;
</td>
<td>曲線グラフの下の塗りつぶし領域でのみ使用します。<b>次のデータプロットまで塗りつぶす-色の上下</b>が選択されている場合、この表記は、ベースカーブの上/下の塗りつぶされた色を示すラベルに使用されます。
</td>
<td>%(1, @V&quot;above&quot;)
<p>%(1, @V&quot;below&quot;) 
--&gt;<br /><b>Above B<br />Below B</b>
</p>
</td></tr></table>
<h4><a name="Dataset.2FRange_Information"></a><span class="mw-headline">データセット/範囲情報</span></h4>
<table class="simple">
<tr>
<th width="10%">@オプション
</th>
<th width="45%">参照元
</th>
<th width="45%">例
</th></tr>
<tr>
<td>@D
</td>
<td>データセット名
</td>
<td><i>%(?Y,@D)</i> --&gt; <b>Book1_B</b>
</td></tr>
<tr>
<td>@R
</td>
<td>データセットの範囲
</td>
<td><i>%(1,@R)</i> --&gt;
<p><b>[Book1]&quot;Trial Run 2&quot;!Col(&quot;Delta Temperature&quot;)[1:32]</b>
</p>
</td></tr>
<tr>
<td>@R1
</td>
<td>行インデックスなしのデータセットの範囲
</td>
<td><i>%(1,@R1)</i> --&gt;
<p><b>[Book1]&quot;Trial Run 2&quot;!Col(&quot;Delta Temperature&quot;)</b>
</p>
</td></tr>
<tr>
<td>@RB
</td>
<td>プロットデータの開始行インデックス
</td>
<td><i>%(1,@RB)</i> --&gt;
<p><b>1</b>
</p>
</td></tr>
<tr>
<td>@RE
</td>
<td>プロットデータの終了行インデックス、@RBが1であれば@RNと同じ
</td>
<td><i>%(1,@RE)</i> --&gt;
<p><b>32</b>
</p>
</td></tr>
<tr>
<td>@RN
</td>
<td>プロットデータの合計行数（欠損値やマスクされたデータ点は除く）
</td>
<td><i>%(1,@RN)</i> --&gt; <b>32</b>
</td></tr></table>
<h4><a name="Holder_Book_Information"></a><span class="mw-headline">ホルダーブック情報</span></h4>
<table class="simple">
<tr>
<th width="10%">@オプション
</th>
<th width="45%">参照元
</th>
<th width="45%">例
</th></tr>
<tr>
<td>@ple
</td>
<td>ホルダーブックロングネーム。埋め込みグラフ、行列、メモ、またはHTMLレポートのコンテナワークブックのロングネームを返します。
</td>
<td><i>%(%H,@PLE)</i>
</td></tr>
<tr>
<td>@SC
</td>
<td> ホルダーシートコメント。埋め込みグラフ、行列、メモ、またはHTMLレポートのシートのコメントを返します。
</td>
<td><i>%(%H,@SC)</i>
</td></tr>
<tr>
<td>@SN
</td>
<td>ホルダーシート表示名; Labelが存在する場合は、Labelを使用します。埋め込みグラフ、行列、メモ、またはHTMLレポートのシートの表示名またはラベルを返します。
</td>
<td><i>%(%H,@SN)</i>
</td></tr>
<tr>
<td>@SNL
</td>
<td>ホルダーシートラベル。埋め込みグラフ、行列、メモ、またはHTMLレポートのシートのラベルを返します。
</td>
<td> <i>%(%H,@SNL)</i>
</td></tr>
<tr>
<td>@SNS
</td>
<td>ホルダーシート名。埋め込みグラフ、行列、メモ、またはHTMLレポートのシートの名前を返します。
</td>
<td> <i>%(%H,@SNS)</i>
</td></tr></table>
<p><b>Note:</b>　単位が置換テキストで表示されている場合、英語と日本語版のOriginでは単位を括弧<b>()</b>で囲みますが、ドイツ語版では角括弧<b>[]</b>を使用します。
</p>



    