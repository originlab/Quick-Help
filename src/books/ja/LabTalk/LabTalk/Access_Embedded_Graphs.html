<h1 class="firstheading">埋め込みグラフにアクセスする</h1>

  <p class='urlname' style='display: none'>Access-Embedded-Graphs</p>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>目次</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1">
        <a href="#List_Embedded_Graphs"><span class="tocnumber">1</span> <span class="toctext">埋め込みグラフをリスト</span></a>

        <ul>
          <li class="toclevel-2 tocsection-2"><a href="#List_Embedded_Graphs_in_the_Project"><span class="tocnumber">1.1</span> <span class="toctext">プロジェクト内の埋め込みグラフをリスト</span></a></li>

          <li class="toclevel-2 tocsection-3"><a href="#List_Embedded_Graphs_in_Active_Worksheet_Cells"><span class="tocnumber">1.2</span> <span class="toctext">アクティブワークシートセルの埋め込みグラフをリスト</span></a></li>
        </ul>
      </li>

      <li class="toclevel-1 tocsection-4"><a href="#Customize_the_Embedded_Graphs"><span class="tocnumber">2</span> <span class="toctext">埋め込みグラフの編集</span></a></li>
    </ul>
  </div>

  <h2><a name="List_Embedded_Graphs"></a><span class="mw-headline">埋め込みグラフをリスト</span></h2>

  <h3><a name="List_Embedded_Graphs_in_the_Project"></a><span class="mw-headline">プロジェクト内の埋め込みグラフをリスト</span></h3>

  <p>プロジェクト内の埋め込み/フローティンググラフページの全てを埋め込み情報（ワークシート、行、列）とともにリスト表示します。</p>
  <pre class="lt" style="font-family:monospace;">
doc <span style="color: #000080;">-</span>e P
<span style="color: #000000;">{</span>
   string wkb<span style="color: #000080;">$</span>, name<span style="color: #000080;">$</span>;        
    if<span style="color: #000000;">(</span>page.<span style="color: #000080;">IsEmbedded</span><span style="color: #000080;">==</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span> <span style="color: #008000;">// 全ての埋め込みグラフをリスト</span>
    <span style="color: #000000;">{</span>
        wkb<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> page.<span style="color: #000080;">isEmbedded</span><span style="color: #000080;">$</span>;
        name<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">%</span><span style="color: #000000;">(</span>page.<span style="color: #000080;">label</span><span style="color: #000080;">$</span><span style="color: #000000;">)</span>;
        if<span style="color: #000000;">(</span>name.<span style="color: #000080;">Getlength</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000080;">==</span><span style="color: #0000dd;">0</span> <span style="color: #000000;">)</span> name<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">%</span>H;
        type <span style="color: #ff00ff;">&quot;The embedded graph is %(name$)&quot;</span>;
        type <span style="color: #ff00ff;">&quot;It is in %(wkb$)&quot;</span>;

    <span style="color: #000000;">}</span>
    if<span style="color: #000000;">(</span>page.<span style="color: #000080;">IsEmbedded</span><span style="color: #000080;">==</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span> <span style="color: #008000;">// 全てのフローティンググラフをリスト</span>
    <span style="color: #000000;">{</span>
        wkb<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> page.<span style="color: #000080;">isEmbedded</span><span style="color: #000080;">$</span>;
        name<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">%</span><span style="color: #000000;">(</span>page.<span style="color: #000080;">label</span><span style="color: #000080;">$</span><span style="color: #000000;">)</span>;
        if<span style="color: #000000;">(</span>name.<span style="color: #000080;">Getlength</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000080;">==</span><span style="color: #0000dd;">0</span> <span style="color: #000000;">)</span> name<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">%</span>H;
        type <span style="color: #ff00ff;">&quot;The floating graph is %(name$)&quot;</span>;
        type <span style="color: #ff00ff;">&quot;It is in %(wkb$)&quot;</span>;
    <span style="color: #000000;">}</span>
<span style="color: #000000;">}</span>
</pre>

  <h3><a name="List_Embedded_Graphs_in_Active_Worksheet_Cells"></a><span class="mw-headline">アクティブワークシートセルの埋め込みグラフをリスト</span></h3>

  <p>アクティブワークシートのセルに埋め込まれた全てのグラフをリスト表示するサンプルです。</p>

  <table class="note">
    <tr>
      <td><b>Note:</b> <a href="../../LabTalk/LabTalk/List_(command).html#eg.3B_List_all_embeded_graphs_in_active_worksheet" title="LabTalk:List (コマンド)"><b>list -eg</b></a> は、アクティブなワークシートに埋め込まれたグラフのすべての名前をスクリプトウィンドウに印字することもできます (セルに埋め込まれたグラフと、ワークシートページのフローティンググラフの両方)。<b>list -eg</b>から取得した情報は、それ以上処理することはできません。</td>
    </tr>
  </table>
  <pre class="lt" style="font-family:monospace;">
range rA <span style="color: #000080;">=</span> <span style="color: #000080;">!</span>; <span style="color: #008000;">//アクティブワークシートの範囲を定義</span>
doc <span style="color: #000080;">-</span>e P <span style="color: #008000;">//プロジェクト内の全グラフウィンドウでループ</span>
<span style="color: #000000;">{</span>
    if<span style="color: #000000;">(</span>page.<span style="color: #000080;">IsEmbedded</span><span style="color: #000080;">==</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span> <span style="color: #008000;">//グラフがワークシートセルに埋め込まれている場合</span>
    <span style="color: #000000;">{</span>
        range rB <span style="color: #000080;">=</span> page.<span style="color: #000080;">isEmbedded</span><span style="color: #000080;">$</span>; <span style="color: #008000;">//埋め込みグラフ位置の範囲を定義</span>
        if <span style="color: #000000;">(</span>rB.<span style="color: #000080;">GetLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000080;">==</span> rA.<span style="color: #000080;">GetLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>  
        <span style="color: #000000;">{</span>
                type <span style="color: #000080;">%</span>H;
        <span style="color: #000000;">}</span>

    <span style="color: #000000;">}</span>;
<span style="color: #000000;">}</span>
</pre>

  <h2><a name="Customize_the_Embedded_Graphs"></a><span class="mw-headline">埋め込みグラフの編集</span></h2>

  <p>このサンプルでは、埋め込みグラフの各レイヤを再スケールして全プロットを表示します。</p>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">//Graph2がワークブックに埋め込まれているとする</span>
win <span style="color: #000080;">-</span>o Graph2
<span style="color: #000000;">{</span>
        doc <span style="color: #000080;">-</span>e LW <span style="color: #008000;">//グラフウィンドウ内の全レイヤでループ</span>
        <span style="color: #000000;">{</span>     
                Rescale;
        <span style="color: #000000;">}</span>
<span style="color: #000000;">}</span>
</pre>
