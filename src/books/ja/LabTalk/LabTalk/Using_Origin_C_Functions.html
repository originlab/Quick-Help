<h1 class="firstheading">Origin C関数を使用する</h1>
<p class="urlname" style="display: none;">Using-OC-Functions</p>
<p>機能を拡張するため、1つの値を返すOrigin C関数（詳細は<a class="external text" href="../../OriginC/Category/Creating_and_Using_Origin_C_Code.html">Orign Cの使用と作成</a>を参照）を定義して、コマンドウィンドウからその関数を呼び出すことができます。例えば、</p>
<ol>
<li>メニューの<b>表示：コードビルダ</b>を選択し、<b>コードビルダ</b>を開きます。</li>
<li>コードビルダのメニュー<b>ファイル</b>：<b>新規</b>を選択して新しい*.cファイルを作成します。<b>新規ファイル</b>ダイアログで、<i>MyFuncs</i>などのファイル名を入力し、OKボタンをクリックします。</li>
<li>このファイルの最後で新しい行を開始し、以下のコードを入力します。
<pre class="oc" style="font-family: monospace;">
<b><span style="color: #0000ff;">double</span> MyFunc <span style="color: #000000;">(</span><span style="color: #0000ff;">double</span> x<span style="color: #000000;">)</span><span style="color: #000000;">
{</span>
    <span style="color: #0000ff;">return</span> <span style="color: #000000;">sin</span><span style="color: #000000;">(</span>x<span style="color: #000000;">)</span> <span style="color: #000040;">+</span> <span style="color: #000000;">cos</span><span style="color: #000000;">(</span>x<span style="color: #000000;">)</span>;<span style="color: #000000;">
}</span></b>
</pre></li>
<li>メニューの<b>ビルド</b>：<b>ビルド</b>を選択してコンパイルし、ファイルをリンクします。</li>
<li>エラーがない場合、上記で定義した関数をLabTalkで使用できます。コマンドウィンドウで以下のスクリプトを実行します。
<pre class="lt" style="font-family: monospace;">
<b>newbook;  <span style="color: #008000;">// 新しいワークブックを作成</span>
col<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span> <span style="color: #000080;">=</span> data<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">32</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">// 行番号で埋める</span>
col<span style="color: #000000;">(</span>B<span style="color: #000000;">)</span> <span style="color: #000080;">=</span> MyFunc<span style="color: #000000;">(</span>col<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">// Origin C関数を呼び、B列に結果を出力</span></b>
        
</pre></li>
</ol>
