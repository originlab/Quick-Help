<h1 class="firstheading">LabTalkのオブジェクト</h1>

  <p class='urlname' style='display: none'>Tutorial-objs</p>

  <p>&#160;</p>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>目次</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1"><a href="#Summary"><span class="tocnumber">1</span> <span class="toctext">概要</span></a></li>

      <li class="toclevel-1 tocsection-2"><a href="#What_Will_You_Learn"><span class="tocnumber">2</span> <span class="toctext">学習する項目</span></a></li>

      <li class="toclevel-1 tocsection-3">
        <a href="#Steps"><span class="tocnumber">3</span> <span class="toctext">ステップ</span></a>

        <ul>
          <li class="toclevel-2 tocsection-4"><a href="#Read_and_Write_Object_Properties"><span class="tocnumber">3.1</span> <span class="toctext">オブジェクトプロパティの読み取りと書き込み</span></a></li>

          <li class="toclevel-2 tocsection-5"><a href="#Use_Method_to_Operate_Object"><span class="tocnumber">3.2</span> <span class="toctext">メソッドを使用してオブジェクトを操作</span></a></li>

          <li class="toclevel-2 tocsection-6"><a href="#Create_and_Manipulate_Graphic_Objects"><span class="tocnumber">3.3</span> <span class="toctext">描画オブジェクトの作成と操作</span></a></li>
        </ul>
      </li>
    </ul>
  </div>

  <h2><a name="Summary"></a><span class="mw-headline">概要</span></h2>

  <p>LabTalkスクリプトプログラミングは、さまざまな<a href="../../LabTalk/LabTalk/LabTalk_Objects.html" title="LabTalk:LabTalk オブジェクト">オブジェクト</a><a href="../../LabTalk/LabTalk/LabTalk_Objects.html#Properties" title="LabTalk:LabTalk オブジェクト">プロパティ</a>と<a href="../../LabTalk/LabTalk/LabTalk_Objects.html#Methods" title="LabTalk:LabTalk オブジェクト">メソッド</a>へのアクセスを提供します。</p>

  <p>オブジェクトプロパティにアクセスするための構文は次の通りです。</p>

  <p><i><b>objName.property</b></i> (数値プロパティ)</p>

  <p>または</p>

  <p><i><b>objName.property$</b></i> (テキストプロパティ)</p>

  <p><br>
  メソッドを操作する構文は次のとおりです。</p>

  <p><i><b>objName.method(arguments)</b></i></p>

  <p><br>
  オブジェクトは一般的なプロパティまたはメソッドを共有する場合がありますが、通常、各オブジェクトには固有のプロパティとメソッドがあります。特定のオブジェクトの詳細については、<a href="../../LabTalk/Category/Alphabetical_Listing_of_Objects_(Labtalk).html" title="Category:Alphabetical Listing of Objects (Labtalk)">オブジェクトのリスト</a>を参照してください。</p>

  <p>多くのオブジェクトは、ワークブック、ワークシート、ワークシート列、グラフ内のデータプロットなど、Originプロジェクトの可視コンポーネントです。一部のOriginオブジェクトとそのOPJコンポーネントとの対応を以下に示します。</p>

  <table class="dialogcontroltable">
    <tr>
      <th><a href="../../LabTalk/LabTalk/Page_(object).html" title="LabTalk:Page(オブジェクト)">Pageオブジェクト</a></th>

      <td>ワークブック/グラフウィンドウ/行列ブック</td>
    </tr>

    <tr>
      <th><a href="../../LabTalk/LabTalk/Wks_(object).html" title="LabTalk:Wks (オブジェクト)">Wksオブジェクト</a></th>

      <td>ワークシート/行列シート</td>
    </tr>

    <tr>
      <th><a href="../../LabTalk/LabTalk/Layer_(object).html" title="LabTalk:Layer (オブジェクト)">Layerオブジェクト</a></th>

      <td>グラフレイヤ/ワーシート/行列シート</td>
    </tr>

    <tr>
      <th><a href="../../LabTalk/LabTalk/Wks.Col_(object).html" title="LabTalk:Wks.Col (オブジェクト)">Wks.Col オブジェクト</a></th>

      <td>ワークシート列</td>
    </tr>

    <tr>
      <th><a href="../../LabTalk/LabTalk/Mat_(object).html" title="LabTalk:Mat (オブジェクト)">Mat オブジェクト</a></th>

      <td>行列オブジェクト</td>
    </tr>

    <tr>
      <th><a href="../../LabTalk/LabTalk/Datasets_(object).html" title="LabTalk:Datasets (オブジェクト)">Datasetオブジェクト</a></th>

      <td>非接続データセット（特定のダイアログ以外で表示されない）</td>
    </tr>

    <tr>
      <th><a href="../../LabTalk/LabTalk/Graphic_Objects.html" title="LabTalk:グラフィックオブジェクト">Graphicオブジェクト</a></th>

      <td>ラベル/矢印/線/ユーザ作成のグラフィック要素</td>
    </tr>
  </table>

  <p>INI オブジェクトやシステムオブジェクトといった他のオブジェクトはインターフェイスに表示されません。</p>

  <h2><a name="What_Will_You_Learn"></a><span class="mw-headline">学習する項目</span></h2>

  <p>このチュートリアルでは、以下の項目について解説します。</p>

  <ul>
    <li>オブジェクトからプロパティ値を取得</li>

    <li>オブジェクトのプロパティ値を変更</li>

    <li>メソッドを使用してオブジェクトを操作</li>

    <li><b>グラフィックオブジェクト</b>の作成と操作</li>
  </ul>

  <h2><a name="Steps"></a><span class="mw-headline">ステップ</span></h2>

  <h3><a name="Read_and_Write_Object_Properties"></a><span class="mw-headline">オブジェクトプロパティの読み取りと書き込み</span></h3>

  <p><b>プロパティ値を返す</b></p>

  <ol>
    <li>Originを開き、<b>スクリプトウィンドウ</b>が開いていることを確認します。(ない場合<b>ウィンドウ：スクリプトウィンドウ</b>を選択または<b>Shift + Alt + 3</b>を押して開きます)</li>

    <li><b>標準</b>ツールバーの<a class="image"><img alt="Button New Workbook.png" src="../images/Tutorial_Objects/Button_New_Workbook.png" width="23"></a>ボタンをクリックして新しいワークブックを作成し、タイトルバーを右クリックして<b>プロパティ</b>を選択し、<b>ウィンドウプロパティ</b> ウィンドウを開きます。</li>

    <li><b>ロングネーム</b>を <b>For Testing</b>、<b>ショートネーム</b>を<b>Test</b>に変更して、<b>OK</b>をクリックして設定を適用してダイアログを閉じます。</li>

    <li><b>Test</b>ワークブックウィンドウがアクティブなことを確認して、スクリプトウィンドウで以下のスクリプトを実行します。</li>
  </ol>

  <ol start="5">
    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">//スクリプトウィンドウのプロパティ値（ショートネーム）を読み込み</span>
page.<span style="color: #000080;">name</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> ;
<span style="color: #008000;">//文字列変数にテキストプロパティ値（ロングネーム）を割り当て</span>
string str1<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> page.<span style="color: #000080;">longname</span><span style="color: #000080;">$</span> ;
<span style="color: #008000;">//double型の変数にプロパティ値（ページ幅）を割り当て</span>
double width <span style="color: #000080;">=</span> page.<span style="color: #000080;">width</span>;
</pre>
    </li>

    <li><b>スクリプトウィンドウ</b>にワークブックショートネーム（<b>Test</b>）が出力されます。残りのプロパティは変数に読み込まれており、次のスクリプトを実行すると出力できます。</li>

    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
str1<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> ;<span style="color: #008000;">//スクリプトウィンドウに &quot;For Testing&quot;を返す</span>
width <span style="color: #000080;">=</span> ;<span style="color: #008000;">//ページ幅の数値を返す</span>
</pre>
    </li>
  </ol>

  <p><b>プロパティ値を設定</b></p>

  <ol>
    <li>ワークブック<b>Test</b>をアクティブにして、<a href="../../LabTalk/LabTalk/Wks_(object).html" title="LabTalk:Wks (オブジェクト)">wksオブジェクト</a>を使って文字列をプロパティに渡すことでワークシート名を変更します。</li>

    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
wks.<span style="color: #000080;">name</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Test1&quot;</span>;<span style="color: #008000;">//ワークシート名をTest1に変更</span>
</pre>

      <p><b>Note:</b> この場合、<a href="../../LabTalk/LabTalk/Layer_(object).html" title="LabTalk:Layer (オブジェクト)">layerオブジェクト</a>を使用してもワークシート名の変更が可能です。</p>
    </li>

    <li>このワークシートの列数を5に設定します。</li>

    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
wks.<span style="color: #000080;">nCols</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>;
</pre>
    </li>

    <li><a href="../../LabTalk/LabTalk/Wks.Col_(object).html" title="LabTalk:Wks.Col (オブジェクト)">wks.col object</a>を使ってワークシート列プロパティを変更します。</li>

    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">// ページロングネームを使って列2のロングネームを設定</span>
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">lname</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> page.<span style="color: #000080;">longname</span><span style="color: #000080;">$</span>;
<span style="color: #008000;">// 列の幅を広く</span>
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">width</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">12</span>;
<span style="color: #008000;">// 3列目をエラーバー列に設定</span>
wks.<span style="color: #000080;">col3</span>.<span style="color: #000080;">type</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;
</pre>
    </li>
  </ol>

  <p><b>範囲をオブジェクトとして定義してそのプロパティを使用</b></p>

  <p>概要で述べたように、<a href="../../LabTalk/Category/Origin_Objects.html" title="カテゴリ:Originオブジェクト">Originオブジェクト</a>はOriginプロジェクトファイル (OPJ) のグラフィカルインターフェイスと主要コンポーネントで表示されます。</p>

  <p>一般に、何も指定されていない場合はアクティブなコンポーネントがデフォルトで使用されます。非アクティブなコンポーネントを操作する場合は、名前/インデックスを指定するか、範囲を定義してこのコンポーネントにマッピングします。</p>

  <ol>
    <li><b>ヘルプ：ラーニングセンター</b>を選択して開くウィンドウで<b>3Ys Y-YY</b>を検索して表示されたサムネイルをダブルクリックしてデータを開きます。<b>3Ys Y-YY</b>グラフウィンドウをアクティブにして、レイヤの3番が選択された状態にします。</li>

    <li>以下のスクリプトを実行してアクティブレイヤ（レイヤ3）の寸法の単位をページに対する%からインチに変更します。</li>

    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
layer.<span style="color: #000080;">unit</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
</pre>
    </li>

    <li>グラフウィンドウ名（ここではグラフウィンドウがアクティブなためオプション）とレイヤ番号を指することで、レイヤ2も同様に寸法単位を変更します。</li>

    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
<span style="color: #000080;">%</span><span style="color: #000000;">(</span>page.<span style="color: #000080;">name</span><span style="color: #000080;">$</span><span style="color: #000000;">)</span><span style="color: #000080;">!</span>layer2.<span style="color: #000080;">unit</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
</pre>

      <p><b>Note:</b> 単位設定を確認するには、<b>フォーマット：作図の詳細（レイヤ属性）</b>をクリックして<b>作図の詳細 - レイヤ属性</b>ダイアログを開き、<b>レイヤの大きさ</b>タブを開きます。レイヤ2と3で<b>単位</b>の設定が<b>インチ</b>に変更されているはずです。</p>
    </li>

    <li>範囲変数<b>lay2</b>を定義してレイヤ2にマップします。</li>

    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
range lay2 <span style="color: #000080;">=</span> <span style="color: #000000;">[</span><span style="color: #000080;">%</span><span style="color: #000000;">(</span>page.<span style="color: #000080;">name</span><span style="color: #000080;">$</span><span style="color: #000000;">)</span><span style="color: #000000;">]</span>layer2<span style="color: #000080;">!</span>;
</pre>
    </li>

    <li>範囲変数<b>lay2</b>はレイヤ2の全プロパティを保持し、以下のスクリプトを実行することで幅を5インチに変更し、背景を明るい灰色で塗りつぶします。</li>

    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
lay2.<span style="color: #000080;">width</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>;
lay2.<span style="color: #000080;">color</span> <span style="color: #000080;">=</span> color<span style="color: #000000;">(</span>LT Gray<span style="color: #000000;">)</span>;
<span style="color: #008000;">//塗り色を定義するのに色インデックスも使用可能です</span>
<span style="color: #008000;">//例えば以下のスクリプトで上述のものと同じように動作します</span>
<span style="color: #008000;">//lay2.color = 19;</span>
</pre>
    </li>

    <li>ページオブジェクトのプロパティを使ってレイヤ1をアクティブにします。</li>

    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
page.<span style="color: #000080;">active</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
</pre>
    </li>

    <li>アクティブレイヤ（レイヤ1)を他の範囲変数<b>lay1</b>にマップします。</li>

    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
range lay1 <span style="color: #000080;">=</span> <span style="color: #000080;">!</span>;
</pre>
    </li>

    <li>layer.axisサブオブジェクトを使ってレイヤ1のY軸タイプを<b>線形</b>に変更します。</li>

    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
lay1.<span style="color: #000080;">y</span>.<span style="color: #000080;">type</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
</pre>
    </li>
  </ol>

  <h3><a name="Use_Method_to_Operate_Object"></a><span class="mw-headline">メソッドを使用してオブジェクトを操作</span></h3>

  <ol>
    <li>空のOriginプロジェクトファイルで<a class="image"><img alt="Button New Workbook.png" src="../images/Tutorial_Objects/Button_New_Workbook.png" width="23"></a>ボタンをクリックして新規ワークブックを作成します。</li>

    <li><a class="image"><img alt="Import Single ASCII.png" src="../images/Tutorial_Objects/Import_Single_ASCII.png" width="26"></a>ボタンをクリックして<i>&lt;Origin EXE folder&gt;\Samples\Graphing\</i> にある<b>Categorical_Data_1.dat</b>をインポートします。</li>

    <li style="list-style: none">
      <p><b>Note:</b> 以下のスクリプトを実行することでもファイルのインポートが可能です。</p>
      <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">//新規ワークブックを作成</span>
newbook;
<span style="color: #008000;">//ファイルをインポート</span>
string fn<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Graphing\Categorical_Data_1.dat&quot;</span>;
impASC fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>fn<span style="color: #000080;">$</span>; 
<span style="color: #008000;">//system.path.program$は非表示オブジェクトのプロパティ</span>
</pre>
    </li>

    <li><b>B2</b>という名前のワークシートの最後に1列追加します。
      <pre class="lt" style="font-family:monospace;">
page.<span style="color: #000080;">xlcolname</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; <span style="color: #008000;">// スプレッドシートセル表記をオフに</span>
wks.<span style="color: #000080;">addcol</span><span style="color: #000000;">(</span>B2<span style="color: #000000;">)</span>;
</pre>

      <table class="noborder">
        <tr>
          <td style="vertical-align:top" width="60"><img src="../images/Tutorial_Objects/Tip_icon.png" width="57" border="0" alt=""></td>

          <td>
            <p>ワークブックの<a class="external text" href="../../UserGuide/UserGuide/Column_Short_Name_Restriction.html">スプレッドシートセル表記</a>については、<a class="external text" href="../../QuickHelp/QuickHelp/Turn_off_spreadsheet_cell_notation.html"><b>FAQ-849</b></a> を参照してください。</p>
          </td>
        </tr>
      </table>
    </li>

    <li>列<b>B</b>の前に<b>A1</b>列を挿入します。
      <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">//列Bを現在の列として選択</span>
wks.<span style="color: #000080;">col</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
<span style="color: #008000;">//現在の列の前に列A2を挿入</span>
wks.<span style="color: #000080;">insert</span><span style="color: #000000;">(</span>A2<span style="color: #000000;">)</span>;
</pre>
    </li>

    <li><i>wks.labels( )</i>メソッドで列ラベル行の表示を制御します。</li>

    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">//スパークラインとコメントを削除してロングネームと単位行だけにする</span>
wks.<span style="color: #000080;">labels</span><span style="color: #000000;">(</span><span style="color: #000080;">-</span>CS<span style="color: #000000;">)</span>;
<span style="color: #008000;">//または以下のスクリプトを実行しても同じ結果を取得できます</span>
<span style="color: #008000;">//wks.labels(LU);</span>
</pre>
    </li>

    <li>必要に応じてロングネームと単位を設定します。</li>

    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">//A2列およびB2列（4番目の列）のロングネームを設定</span>
col<span style="color: #000000;">(</span>A2<span style="color: #000000;">)</span><span style="color: #000000;">[</span>L<span style="color: #000000;">]</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Abb.Direction&quot;</span>;
col<span style="color: #000000;">(</span><span style="color: #0000dd;">4</span><span style="color: #000000;">)</span><span style="color: #000000;">[</span>L<span style="color: #000000;">]</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Description&quot;</span>;
<span style="color: #008000;">//列Bの単位を設定</span>
col<span style="color: #000000;">(</span>B<span style="color: #000000;">)</span><span style="color: #000000;">[</span>U<span style="color: #000000;">]</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;km/h&quot;</span>;
</pre>
    </li>

    <li>列幅を調整して全テキストが1行で表示されるようにします。</li>

    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">width</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span>;
wks.<span style="color: #000080;">col4</span>.<span style="color: #000080;">width</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">17</span>;
</pre>
    </li>

    <li>文字列配列のメソッドを使用して説明の文字列を入れます。</li>

    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">//文字列配列を定義</span>
StringArray aa, bb;
<span style="color: #008000;">//文字列配列aaに文字列を追加</span>
aa.<span style="color: #000080;">Add</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Strong gale&quot;</span><span style="color: #000000;">)</span>;
<span style="color: #008000;">//文字列配列aaをbbにコピー</span>
bb.<span style="color: #000080;">Copy</span><span style="color: #000000;">(</span>aa<span style="color: #000000;">)</span>;
<span style="color: #008000;">//bbをaaに追加</span>
aa.<span style="color: #000080;">Append</span><span style="color: #000000;">(</span>bb<span style="color: #000000;">)</span>;
<span style="color: #008000;">//区切り文字として , を使用して他の4つの文字列をデータセットとして追加</span>
aa.<span style="color: #000080;">Append</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Strong breeze,Fresh breeze,Moderate gale,Moderate breeze&quot;</span>, <span style="color: #ff00ff;">&quot;,&quot;</span><span style="color: #000000;">)</span>;
</pre>
    </li>

    <li>文字れうaaの内容を列Dにコピーします。</li>

    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
aa.<span style="color: #000080;">CopyTo</span><span style="color: #000000;">(</span>col<span style="color: #000000;">(</span><span style="color: #0000dd;">4</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
</pre>
    </li>

    <li>メソッドを使って、最初の列の文字列を操作し、省略形を2番目の列に配置します。<b>for</b>ループを使用してスクリプトを簡略化します。</li>

    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
for<span style="color: #000000;">(</span>int ii<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>; ii<span style="color: #000080;">&lt;=</span>wks.<span style="color: #000080;">maxRows</span>; ii<span style="color: #000080;">++</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
   string str1<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> col<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span><span style="color: #000000;">[</span><span style="color: #000080;">$</span><span style="color: #000000;">(</span>ii<span style="color: #000000;">)</span><span style="color: #000000;">]</span><span style="color: #000080;">$</span>;
   <span style="color: #008000;">//左からみて最初の文字を取得</span>
   string str2<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> str1.<span style="color: #000080;">Left</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span><span style="color: #000080;">$</span>;
   <span style="color: #008000;">//str2を大文字に</span>
   str2.<span style="color: #000080;">MakeUpper</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
   col<span style="color: #000000;">(</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span><span style="color: #000000;">[</span><span style="color: #000080;">$</span><span style="color: #000000;">(</span>ii<span style="color: #000000;">)</span><span style="color: #000000;">]</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> str2<span style="color: #000080;">$</span>;
<span style="color: #000000;">}</span>
</pre>

      <p><b>Note:</b> Xファンクションcsetvaluesを使用するか列値の設定ダイアログを使って組み込みの文字列関数を呼び出すことで同じ操作が可能です。</p>
    </li>
  </ol>

  <h3><a name="Create_and_Manipulate_Graphic_Objects"></a><span class="mw-headline">グラフィックオブジェクトの作成と操作</span></h3>

  <ol>
    <li>新規グラフウィンドウを作成して線オブジェクトを描画します。</li>

    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">//グラフウィンドウを作成</span>
win <span style="color: #000080;">-</span>t plot; 
<span style="color: #008000;">//&apos;line1&apos;に接続されたmyLineという名前のGObjectを宣言</span>
GObject myLine <span style="color: #000080;">=</span> line1;
<span style="color: #008000;">//オブジェクトを作成(list -o で &apos;line1&apos;を表示) </span>
draw <span style="color: #000080;">-</span>n myLine <span style="color: #000080;">-</span>l <span style="color: #000000;">{</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">6</span>,<span style="color: #0000dd;">4</span><span style="color: #000000;">}</span>;
</pre>
    </li>

    <li>myLineまたはline1のいずれかを使用してオブジェクトプロパティの制御できます。</li>

    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">//線の色を赤に変更</span>
myLine.<span style="color: #000080;">color</span> <span style="color: #000080;">=</span> color<span style="color: #000000;">(</span>red<span style="color: #000000;">)</span>;
<span style="color: #008000;">//矢印の終了の形状を変更</span>
line1.<span style="color: #000080;">arrowEndShape</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
<span style="color: #008000;">//水平、垂直方向の移動を有効化</span>
line1.<span style="color: #000080;">hMove</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
line1.<span style="color: #000080;">vMove</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
</pre>
    </li>

    <li>&quot;myText&quot;という名前のテキストラベルをグラフに追加し、&quot;Distance&quot;というテキストを表示します。ラベルは指定した位置に配置されます。</li>

    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
label <span style="color: #000080;">-</span>p <span style="color: #0000dd;">20</span> <span style="color: #0000dd;">50</span> <span style="color: #000080;">-</span>n myText Distance;
</pre>
    </li>

    <li>テキストラベルのプロパティを変更します。</li>

    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">//テキストラベルの枠を影に設定</span>
myText.<span style="color: #000080;">background</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
</pre>
    </li>

    <li>テキストオブジェクトにスクリプトを追加し、再描画後に実行するように設定します。このスクリプトは、line1オブジェクトの計算された線の長さに応じてラベル内のテキストを更新し、lineオブジェクトとのオフセットを維持します。</li>

    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">//置換表記を使用しないようにあらかじめ文字列を定義</span>
string str1<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;$&quot;</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;(sqrt((line1.y2-line1.y)^2+(line1.x2-line1.x)^2), .2)&quot;</span>;
<span style="color: #008000;">//スクリプトは全イベント後に実行</span>
myText.<span style="color: #000080;">script</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>;
<span style="color: #008000;">//オブジェクトにスクリプトテキストを追加</span>
myText.<span style="color: #000080;">script</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;myText.text$ = &quot;</span>Line Length <span style="color: #000080;">=</span> <span style="color: #000080;">%</span><span style="color: #000000;">(</span>str1<span style="color: #000080;">$</span><span style="color: #000000;">)</span><span style="color: #ff00ff;">&quot;; doc -uw;&quot;</span>;
</pre>
    </li>

    <li>線オブジェクト上で右クリックして<b>プロパティ</b>を選択し、プログラミングタブで<b>のあとでスクリプトを実行</b>を<b>サイズ変更</b>に変更して、スクリプト編集ボックスに以下のスクリプトを入力します。これで線オブジェクトのサイズ変更の度にテキストラベルが再描画されます。</li>

    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
myText.<span style="color: #000080;">draw</span><span style="color: #000000;">(</span>global<span style="color: #000000;">)</span>;
</pre>

      <p><b>Note:</b>  同様に、<b>プロパティ</b>ダイアログを使用せずに、以下のスクリプトを実行することもできます。</p>
      <pre class="lt" style="font-family:monospace;">
line1.<span style="color: #000080;">script</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;
line1.<span style="color: #000080;">script</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;myText.draw(global);&quot;</span>;
</pre>
    </li>

    <li>myLine オブジェクトとmyTextオブジェクトを接続します。</li>

    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
line1.<span style="color: #000080;">Connect</span><span style="color: #000000;">(</span>myText, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">2</span>, <span style="color: #0000dd;">6</span><span style="color: #000000;">)</span>;
</pre>
    </li>

    <li>グラフ内の線オブジェクトを移動すると、テキスト移動し、サイズ変更すると、線の長さに応じてテキストが更新されます。</li>
  </ol>
