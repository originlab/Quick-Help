<h1 class="firstheading">DDE</h1>

  <p class='urlname' style='display: none'>DDE-cmd</p>

  <p>The dde command provides Dynamic Data Exchange support with Origin as the client application.</p>

  <p>&#160;</p>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>Contents</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1"><a href="#Syntax:"><span class="tocnumber">1</span> <span class="toctext">Syntax:</span></a></li>

      <li class="toclevel-1 tocsection-2">
        <a href="#Options:"><span class="tocnumber">2</span> <span class="toctext">Options:</span></a>

        <ul>
          <li class="toclevel-2 tocsection-3"><a href="#-c.3B_Connect_to_the_specified_application_with_the_specified_topic"><span class="tocnumber">2.1</span> <span class="toctext">-c; Connect to the specified application with the specified topic</span></a></li>

          <li class="toclevel-2 tocsection-4"><a href="#-d.3B_Disconnect_the_specified_conversation"><span class="tocnumber">2.2</span> <span class="toctext">-d; Disconnect the specified conversation</span></a></li>

          <li class="toclevel-2 tocsection-5"><a href="#-e.3B_Execute_the_specified_command_string_string_in_the_server_application_specified_by_varID"><span class="tocnumber">2.3</span> <span class="toctext">-e; Execute the specified command string <i>string</i> in the server application specified by <i>varID</i></span></a></li>

          <li class="toclevel-2 tocsection-6"><a href="#-i.3B_Find_the_conversation_ID_for_the_specified_application_with_the_specified_topic"><span class="tocnumber">2.4</span> <span class="toctext">-i; Find the conversation ID for the specified application with the specified topic</span></a></li>

          <li class="toclevel-2 tocsection-7"><a href="#-l.3B_List_all_DDE_conversations_and_display_them_in_the_Script_window"><span class="tocnumber">2.5</span> <span class="toctext">-l; List all DDE conversations and display them in the Script window</span></a></li>

          <li class="toclevel-2 tocsection-8"><a href="#-lz.3B_List_all_DDE_conversations_and_put_the_result_into_the_.25Z_string"><span class="tocnumber">2.6</span> <span class="toctext">-lz; List all DDE conversations and put the result into the&#160;%Z string</span></a></li>

          <li class="toclevel-2 tocsection-9"><a href="#-p.3B_Poke_string_to_the_server_application_as_specified_by_the_varID"><span class="tocnumber">2.7</span> <span class="toctext">-p; Poke string to the server application as specified by the varID</span></a></li>

          <li class="toclevel-2 tocsection-10"><a href="#-pc.3B_Poke_in_column_order_the_data_from_wksItem_to_the_ServerItem_with_the_specified_varID"><span class="tocnumber">2.8</span> <span class="toctext">-pc; Poke in column order the data from <i>wksItem</i> to the <i>ServerItem</i> with the specified <i>varID</i></span></a></li>

          <li class="toclevel-2 tocsection-11"><a href="#-pv.3B_Ignore_escape_sequences_and_send_untranslated_text"><span class="tocnumber">2.9</span> <span class="toctext">-pv; Ignore escape sequences and send untranslated text</span></a></li>

          <li class="toclevel-2 tocsection-12"><a href="#-q.3B_Quiet_Origin_use_of_DDE_warning_message_boxes"><span class="tocnumber">2.10</span> <span class="toctext">-q; Quiet Origin use of DDE warning message boxes</span></a></li>

          <li class="toclevel-2 tocsection-13"><a href="#-r.3B_Request_the_item_item_from_the_server_application_specified_by_varID"><span class="tocnumber">2.11</span> <span class="toctext">-r; Request the item <i>item</i> from the server application specified by varID</span></a></li>

          <li class="toclevel-2 tocsection-14"><a href="#-rc.3B_Receive_in_column_order_the_ServerItem_with_the_specified_varID_into_the_specified_wksItem"><span class="tocnumber">2.12</span> <span class="toctext">-rc; Receive in column order the <i>ServerItem</i> with the specified varID into the specified <i>wksItem</i></span></a></li>

          <li class="toclevel-2 tocsection-15"><a href="#-rr.3B_Receive_in_row_order_the_ServerItem_with_the_specified_varID_into_the_specified_wksItem"><span class="tocnumber">2.13</span> <span class="toctext">-rr; Receive in row order the <i>ServerItem</i> with the specified <i>varID</i> into the specified <i>wksItem</i></span></a></li>
        </ul>
      </li>

      <li class="toclevel-1 tocsection-16"><a href="#Examples:"><span class="tocnumber">3</span> <span class="toctext">Examples:</span></a></li>
    </ul>
  </div>

  <h2><a name="Syntax:"></a><span class="mw-headline"><font color="chocolate">Syntax:</font></span></h2>
  <pre class="lt" style="font-family:monospace;">
dde  <span style="color: #000000;">[</span>option<span style="color: #000000;">]</span> argument
</pre>

  <h2><a name="Options:"></a><span class="mw-headline"><font color="chocolate">Options:</font></span></h2>

  <h3><a name="-c.3B_Connect_to_the_specified_application_with_the_specified_topic"></a><span class="mw-headline">-c; Connect to the specified application with the specified topic</span></h3>

  <p><b>Syntax:</b> dde <b>-c</b> <i>application| topic [varID]</i></p>

  <p>Connect to the specified application with the specified topic.The <i>application|topic</i> string should have the application name and topic connected with a "|" character.If the connection is successful, an ID (&gt;= 0) is assigned to the connection and is stored in the specified variable <i>varID</i>. If <i>varID</i> is not specified, the system variable v1 is used. If the connection is not successful, (-1) is stored in the variable.</p>

  <h3><a name="-d.3B_Disconnect_the_specified_conversation"></a><span class="mw-headline">-d; Disconnect the specified conversation</span></h3>

  <p><b>Syntax:</b> dde <b>-d</b> <i>varID</i></p>

  <p>Disconnect the specified conversation.</p>

  <h3><a name="-e.3B_Execute_the_specified_command_string_string_in_the_server_application_specified_by_varID"></a><span class="mw-headline">-e; Execute the specified command string <i>string</i> in the server application specified by <i>varID</i></span></h3>

  <p><b>Syntax:</b> dde <b>-e</b> <i>varID string</i></p>

  <p>Execute the specified command string <i>string</i> in the server application specified by <i>varID</i>.</p>

  <h3><a name="-i.3B_Find_the_conversation_ID_for_the_specified_application_with_the_specified_topic"></a><span class="mw-headline">-i; Find the conversation ID for the specified application with the specified topic</span></h3>

  <p><b>Syntax:</b> dde <b>-i</b> <i>application| topic [varID]</i></p>

  <p>Find the conversation ID for the specified application with the specified topic.The <i>application| topic</i> string must have the application name and topic connected with a "|" character. If the specified conversation is found, its ID is stored in the specified variable <i>varID</i>.If <i>varID</i> is not specified, the system variable v1 is used. If the conversation cannot be found, (-1) is stored in the variable.</p>

  <h3><a name="-l.3B_List_all_DDE_conversations_and_display_them_in_the_Script_window"></a><span class="mw-headline">-l; List all DDE conversations and display them in the Script window</span></h3>

  <p><b>Syntax:</b> dde <b>-l</b> <i>application</i></p>

  <p>List all DDE conversations and display them in the Script window. If application is specified, only those conversations with the specified application are listed.</p>

  <h3><a name="-lz.3B_List_all_DDE_conversations_and_put_the_result_into_the_.25Z_string"></a><span class="mw-headline">-lz; List all DDE conversations and put the result into the %Z string</span></h3>

  <p><b>Syntax:</b> dde <b>-lz</b> <i>application</i></p>

  <p>List all DDE conversations and put the result into the <a href="../../LabTalk/LabTalk/String_Register_List&amp;action=edit&amp;redlink=1.html" class="new" title="LabTalk:String Register List (page does not exist)">%Z</a> string; result is searchable with substring commands. If application is specified, only those conversations with the specified application are listed.</p>

  <h3><a name="-p.3B_Poke_string_to_the_server_application_as_specified_by_the_varID"></a><span class="mw-headline">-p; Poke string to the server application as specified by the varID</span></h3>

  <p><b>Syntax:</b> dde <b>-p</b> <i>varID item string</i></p>

  <p>Poke string to the server application as specified by the varID, under the specified item.</p>

  <h3><a name="-pc.3B_Poke_in_column_order_the_data_from_wksItem_to_the_ServerItem_with_the_specified_varID"></a><span class="mw-headline">-pc; Poke in column order the data from <i>wksItem</i> to the <i>ServerItem</i> with the specified <i>varID</i></span></h3>

  <p><b>Syntax:</b> dde <b>-pc</b> <i>varID ServerItem wksItem</i></p>

  <p>Poke in column order the data from <i>wksItem</i> to the <i>ServerItem</i> with the specified <i>varID</i>. The <i>ServerItem</i> should specify a range large enough to hold the data range specified by the <i>wksItem</i>.</p>

  <h3><a name="-pv.3B_Ignore_escape_sequences_and_send_untranslated_text"></a><span class="mw-headline">-pv; Ignore escape sequences and send untranslated text</span></h3>

  <p><b>Syntax:</b> dde <b>-pv</b> <i>varID item string</i></p>

  <p>Ignore <a class="external text" href="../../UserGuide/UserGuide/Escape_Sequences.html">escape sequences</a>and send untranslated text. When using the DDE <code>-p</code> command to send strings, Origin will translate certain sequences of characters beginning with '\' as escape sequences, resulting in the loss of information. For example, a '\t' sequence would translate to a tab character with the result that: dde -p "My files can be found in C:\temp"; would be received as "My files can be found in C: emp"by the DDE Server Application. The <code>-pv</code> command option will cause Origin to ignore the escape sequence and send untranslated text.</p>

  <h3><a name="-q.3B_Quiet_Origin_use_of_DDE_warning_message_boxes"></a><span class="mw-headline">-q; Quiet Origin use of DDE warning message boxes</span></h3>

  <p><b>Syntax:</b> dde <b>-q</b> <i>n</i></p>

  <p>Quiet Origin use of DDE warning message boxes. If <i>n = 1</i>, no warning message boxes are displayed. If <i>n = 0</i>, Origin is reset to its normal state.</p>

  <h3><a name="-r.3B_Request_the_item_item_from_the_server_application_specified_by_varID"></a><span class="mw-headline">-r; Request the item <i>item</i> from the server application specified by varID</span></h3>

  <p><b>Syntax:</b> dde <b>-r</b> <i>varID item</i></p>

  <p>Request the item <i>item</i> from the server application specified by varID. The result is placed in the <a href="../../LabTalk/LabTalk/String_Register_List&amp;action=edit&amp;redlink=1.html" class="new" title="LabTalk:String Register List (page does not exist)">%Z</a> string if the operation is successful.</p>

  <h3><a name="-rc.3B_Receive_in_column_order_the_ServerItem_with_the_specified_varID_into_the_specified_wksItem"></a><span class="mw-headline">-rc; Receive in column order the <i>ServerItem</i> with the specified varID into the specified <i>wksItem</i></span></h3>

  <p><b>Syntax:</b> dde <b>-rc</b> <i>varID ServerItem wksItem</i></p>

  <p>Receive in column order the <i>ServerItem</i> with the specified varID into the specified <i>wksItem</i>. Column type should match the type of data being received. If the <i>wksItem</i> is the dataset name, then data is appended to the first empty row. If you specify a cell with <i><b>Dataset!RiCj</b></i>, then data replaces existing data. Data above the replacement point is retained, data below is removed. If you specify a range with <i><b>Dataset!RiCj:RkCl</b></i>, then data replaces the existing block of data without removing data below.</p>

  <table class="note">
    <tr>
      <td></td>

      <td>
        <b>Note:</b> When you specify the <i>ServerItem</i> to send the dataset, you need know that, the cell-column notation of <i>ServerItem</i> is different in different localized version of Office, such as, when using R1C1 style in a localized version of Excel, you have to use the localized R1C1 string, in German it is Z1S1, in French it is L1C1 and e.g. in Spanish it is F1C1.

        <p>For Example, If you have a Excel file which have some data in its sheet1, the script below will work fine in English OS and with English Excel,</p>
        <pre class="lt" style="font-family:monospace;">
dde <span style="color: #000080;">-</span>c Excel<span style="color: #000080;">|</span><span style="color: #000000;">[</span>Excel1.<span style="color: #000080;">xls</span><span style="color: #000000;">]</span>Sheet1 idxd;
dde <span style="color: #000080;">-</span>rc idxd R1C1<span style="color: #000000;">:</span>R5C2 <span style="color: #000000;">[</span>Book1<span style="color: #000000;">]</span>Sheet1<span style="color: #000080;">!</span>R1C1;
</pre>

        <p>If you want run it in German OS with the German Excel, you should modify the second line to be</p>
        <pre class="lt" style="font-family:monospace;">
dde <span style="color: #000080;">-</span>c Excel<span style="color: #000080;">|</span><span style="color: #000000;">[</span>Excel1.<span style="color: #000080;">xls</span><span style="color: #000000;">]</span>Sheet1 idxd;
dde <span style="color: #000080;">-</span>rc idxd Z1S1<span style="color: #000000;">:</span>Z5S2 <span style="color: #000000;">[</span>Book1<span style="color: #000000;">]</span>Sheet1<span style="color: #000080;">!</span>R1C1;
</pre>

        <p>The <i>ServerItem</i> has been changed from <b>R1C1:R5C2</b> to <b>Z1S1:Z5S2</b>.</p>
      </td>
    </tr>
  </table>

  <h3><a name="-rr.3B_Receive_in_row_order_the_ServerItem_with_the_specified_varID_into_the_specified_wksItem"></a><span class="mw-headline">-rr; Receive in row order the <i>ServerItem</i> with the specified <i>varID</i> into the specified <i>wksItem</i></span></h3>

  <p><b>Syntax:</b> dde <b>-rr</b> <i>varID ServerItem wksItem</i></p>

  <p>Receive in row order (transpose rows and columns) the <i>ServerItem</i> with the specified <i>varID</i> into the specified <i>wksItem</i>. See the -rc option for additional information.</p>

  <h2><a name="Examples:"></a><span class="mw-headline"><font color="chocolate">Examples:</font></span></h2>

  <p>For the following examples, Excel needs to be running. Either launch Excel manually or use the <code><a href="../../LabTalk/LabTalk/Run_(command).html" title="LabTalk:Run (command)">run -e</a></code> command.</p>

  <p>The following script connects to application Excel and topic Sheet1 and remembers the connection as idExcel.</p>
  <pre class="lt" style="font-family:monospace;">
dde <span style="color: #000080;">-</span>c excel<span style="color: #000080;">|</span>sheet1 idExcel;
</pre>

  <p>The next script pokes the slope value (LR.B) of the most recent linear regression to Excel row 1, column 1.</p>
  <pre class="lt" style="font-family:monospace;">
dde <span style="color: #000080;">-</span>p idExcel R1C1 <span style="color: #000080;">$</span><span style="color: #000000;">(</span>LR.<span style="color: #000080;">B</span><span style="color: #000000;">)</span>;
</pre>

  <p>This script requests the cell value of row 2, column 1 in Excel and assigns it to the variable value.</p>
  <pre class="lt" style="font-family:monospace;">
dde <span style="color: #000080;">-</span>r idExcel R2C1;value<span style="color: #000080;">=</span><span style="color: #000080;">%</span>Z;
</pre>

  <p>Here is a more complex script that launches Excel, opens an Excel file, gets data into Origin, performs a Linear Fit and pushes the calculated slope back to Excel.</p>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">// Designate the path to the file of interest,</span>
<span style="color: #008000;">// note that the path cannot include spaces!:</span>
string fp<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"D:\Files\FileType\Excel\Dose2.xls"</span>;

<span style="color: #008000;">// Launch Excel, and load desired file:</span>
run <span style="color: #000080;">-</span>e <span style="color: #ff00ff;">"C:\Program Files\Microsoft Office\OFFICE11\excel.exe"</span> <span style="color: #000080;">%</span><span style="color: #000000;">(</span>fp<span style="color: #000080;">$</span><span style="color: #000000;">)</span>;
<span style="color: #008000;">// Wait for a good connection</span>
for<span style="color: #000000;">(</span> ready <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>, attempts <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span> ; ready <span style="color: #000080;">==</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">&amp;&amp;</span> attempts <span style="color: #000080;">&lt;</span> <span style="color: #0000dd;">10</span> ; attempts<span style="color: #000080;">++</span> <span style="color: #000000;">)</span> 
<span style="color: #000000;">{</span>
        dde <span style="color: #000080;">-</span>c Excel<span style="color: #000080;">|</span>System idSys;
        sec <span style="color: #000080;">-</span>p <span style="color: #0000dd;">1</span>;
        if<span style="color: #000000;">(</span>idSys <span style="color: #000080;">&gt;=</span> <span style="color: #0000dd;">0</span><span style="color: #000000;">)</span> ready<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
<span style="color: #000000;">}</span>
if<span style="color: #000000;">(</span>attempts <span style="color: #000080;">&gt;=</span> <span style="color: #0000dd;">10</span><span style="color: #000000;">)</span> 
<span style="color: #000000;">{</span>
        type <span style="color: #000080;">-</span>a Request timed out. <span style="color: #000080;">Terminating</span>...;
        break1;
<span style="color: #000000;">}</span> 
else 
<span style="color: #000000;">{</span>
        type <span style="color: #000080;">-</span>a Connected, retrieving info.;
<span style="color: #000000;">}</span>

<span style="color: #008000;">// Request Topics</span>
dde <span style="color: #000080;">-</span>c Excel<span style="color: #000080;">|</span>System idSys;
dde <span style="color: #000080;">-</span>r idSys Topics;

<span style="color: #008000;">// and display them</span>
type <span style="color: #000080;">-</span>a List of Topics available.;
for<span style="color: #000000;">(</span> done <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>, ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span> ; done <span style="color: #000080;">==</span> <span style="color: #0000dd;">0</span> ; ii<span style="color: #000080;">++</span> <span style="color: #000000;">)</span> 
<span style="color: #000000;">{</span>
   <span style="color: #000080;">%</span>A<span style="color: #000080;">=</span><span style="color: #000080;">%</span><span style="color: #000000;">[</span><span style="color: #000080;">%</span>Z,#ii<span style="color: #000000;">]</span>;
   if<span style="color: #000000;">(</span><span style="color: #000080;">%</span><span style="color: #000000;">[</span><span style="color: #000080;">%</span>A<span style="color: #000000;">]</span><span style="color: #000080;">&gt;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span> type <span style="color: #000080;">%</span>A; else done <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
<span style="color: #000000;">}</span>
<span style="color: #008000;">// New connection to another Topic</span>
dde <span style="color: #000080;">-</span>c Excel<span style="color: #000080;">|</span><span style="color: #000000;">[</span>Dose1.<span style="color: #000080;">xls</span><span style="color: #000000;">]</span>Sheet1 idxd;
<span style="color: #008000;">// Request data</span>
dde <span style="color: #000080;">-</span>rc idxd R2C1<span style="color: #000000;">:</span>R11C2 <span style="color: #000000;">[</span>Book1<span style="color: #000000;">]</span>Sheet1<span style="color: #000080;">!</span>R1C1;
<span style="color: #008000;">// Do a linear fit</span>
lr col<span style="color: #000000;">(</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span>;
<span style="color: #000080;">%</span>A <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"Slope is $(lr.b)"</span>;
<span style="color: #008000;">// Push result to Excel</span>
dde <span style="color: #000080;">-</span>p idxd R1C3<span style="color: #000000;">:</span>R1C3 <span style="color: #000080;">%</span>A;
<span style="color: #008000;">// Terminate connections</span>
dde <span style="color: #000080;">-</span>d idxd;
dde <span style="color: #000080;">-</span>d idSys;
</pre>
