<h1 class="firstheading">画像処理</h1>

  <p>&#160;</p>

  <h2><a name="RGB_Image_Matrix"></a><span class="mw-headline">RGBイメージ行列</span></h2>

  <p>行列は、表示する行と列がいくつあるかという情報を含みますが、それは線形配列として内部的に格納されています。そのため、行列からワークシート列にデータをコピーし、以下のことが行えます。</p>

  <ol>
    <li>画像ファイルをインポート</li>

    <li>赤、緑、青（RGB）チャネルを抽出（行列から行列）</li>

    <li>チャネルデータをコピー（行列から列）</li>

    <li>RGB値の文字列表現を構築</li>
  </ol>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">// サンプル画像を指定してインポート</span>
fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> SYSTEM.<span style="color: #000080;">PATH</span>.<span style="color: #000080;">PROGRAM</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Image Processing and Analysis\Flower.jpg&quot;</span>;
impImage;
<span style="color: #008000;">// RGB を別々の赤、緑、青の行列に分割</span>
imgRGBsplit r<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span>RGBOUT<span style="color: #000000;">]</span>RED<span style="color: #000080;">!</span><span style="color: #0000dd;">1</span> g<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span>RGBOUT<span style="color: #000000;">]</span>GREEN<span style="color: #000080;">!</span><span style="color: #0000dd;">1</span> b<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span>RGBOUT<span style="color: #000000;">]</span>BLUE<span style="color: #000080;">!</span><span style="color: #0000dd;">1</span>;
<span style="color: #008000;">// 新規ワークブックを作成</span>
newbook;
wks.<span style="color: #000080;">ncols</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">4</span>;
wks.<span style="color: #000080;">col1</span>.<span style="color: #000080;">lname</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Red;
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">lname</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Green;
wks.<span style="color: #000080;">col3</span>.<span style="color: #000080;">lname</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Blue;
wks.<span style="color: #000080;">col4</span>.<span style="color: #000080;">lname</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> RGB;
<span style="color: #008000;">// ワークシート範囲</span>
range raDR <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>, raDG <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>, raDB <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;
<span style="color: #008000;">// 行列範囲</span>
range raR <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>RGBOUT<span style="color: #000000;">]</span>RED<span style="color: #000080;">!</span><span style="color: #0000dd;">1</span>;
range raG <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>RGBOUT<span style="color: #000000;">]</span>GREEN<span style="color: #000080;">!</span><span style="color: #0000dd;">1</span>;
range raB <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>RGBOUT<span style="color: #000000;">]</span>BLUE<span style="color: #000080;">!</span><span style="color: #0000dd;">1</span>;
<span style="color: #008000;">// 範囲の割り当てによって行列から ワークブックにデータをコピー</span>
raDR <span style="color: #000080;">=</span> raR;
raDG <span style="color: #000080;">=</span> raG;
raDB <span style="color: #000080;">=</span> raB;
<span style="color: #008000;">// RGBトリプレットを示す文字列を作成</span>
col<span style="color: #000000;">(</span>D<span style="color: #000000;">)</span> <span style="color: #000080;">=</span> col<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot; &quot;</span> <span style="color: #000080;">+</span> col<span style="color: #000000;">(</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot; &quot;</span> <span style="color: #000080;">+</span> col<span style="color: #000000;">(</span><span style="color: #0000dd;">3</span><span style="color: #000000;">)</span><span style="color: #000080;">$</span>;
</pre>

  <p> </p>
