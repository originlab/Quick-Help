<h1 class="firstheading">Exist</h1>

  <p class='urlname' style='display: none'>Exist-func</p>

  <p><br>
  The <b>exist(<i>name</i>[,<i>n</i>])</b> function has two primary applications:</p>

  <dl>
    <dd>
      <ul>
        <li>Checking for the existence of an object.</li>

        <li>Checking the state of an object.</li>
      </ul>
    </dd>
  </dl>

  <p><b>When option <i>n</i> is not specified</b>: You can test for the existence of (a) an <a href="#Testing_for_General_Object_Instances"><b>object</b></a>, (b) a <a href="#Range_Variables"><b>range variable</b></a>, (c) a <a href="#File_Testing_with_exist.28fileName.29_or_exist.28filename.2C_n.29"><b>file</b></a> or (d) a <a href="#Testing_for_LabTalk_tree"><b>LabTalk tree</b></a>.</p>

  <p><b>When <i>n</i> is specified:</b> You can test for (a) <a href="#Testing_for_General_Object_Instances"><b>graphic objects</b></a>, (b) <a href="#String_Variables"><b>string variables</b></a>, (c) <a href="#Testing_for_Origin_C_Functions"><b>Origin C functions</b></a>, (d) Origin <a href="#Testing_for_Folders"><b>project folders</b></a>, or (e) <a href="#exist.28winName.2C_n.29"><b>window activity (active, hidden)</b></a>.</p><br>

  <table class="note">
    <tr>
      <td>Note 1: A matrix is also a dataset. If you delete a matrix window without deleting the data, the <b>exist(<i>name</i>)</b> function will return <b>5</b> <i>before</i> deleting the matrix window, and <b>1</b> <i>after</i> deleting the matrix window.</td>
    </tr>
  </table>

  <table class="note">
    <tr>
      <td>Note 2: Starting with Origin 8.0 SR2, you can pass a string containing the name of an object instance (e.g., a worksheet, a variable, etc.) into the <b>exist</b> function, and Origin tests for the existence of that name in the project.</td>
    </tr>
  </table>

  <p>&#160;</p>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>Contents</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1"><a href="#Testing_for_General_Object_Instances"><span class="tocnumber">1</span> <span class="toctext">Testing for General Object Instances</span></a></li>

      <li class="toclevel-1 tocsection-2"><a href="#Graphic_Objects"><span class="tocnumber">2</span> <span class="toctext">Graphic Objects</span></a></li>

      <li class="toclevel-1 tocsection-3"><a href="#String_Variables"><span class="tocnumber">3</span> <span class="toctext">String Variables</span></a></li>

      <li class="toclevel-1 tocsection-4"><a href="#Range_Variables"><span class="tocnumber">4</span> <span class="toctext">Range Variables</span></a></li>

      <li class="toclevel-1 tocsection-5"><a href="#Testing_for_Origin_C_Functions"><span class="tocnumber">5</span> <span class="toctext">Testing for Origin C Functions</span></a></li>

      <li class="toclevel-1 tocsection-6"><a href="#File_Testing_with_exist.28fileName.29_or_exist.28filename.2C_n.29"><span class="tocnumber">6</span> <span class="toctext">File Testing with exist(fileName) or exist(filename, n)</span></a></li>

      <li class="toclevel-1 tocsection-7"><a href="#exist.28winName.2C_n.29"><span class="tocnumber">7</span> <span class="toctext"><span lang="DE">exist(winName, n)</span></span></a></li>

      <li class="toclevel-1 tocsection-8"><a href="#Testing_for_LabTalk_tree"><span class="tocnumber">8</span> <span class="toctext">Testing for LabTalk tree</span></a></li>

      <li class="toclevel-1 tocsection-9"><a href="#Testing_for_Folders"><span class="tocnumber">9</span> <span class="toctext">Testing for Folders</span></a></li>
    </ul>
  </div>

  <h3><a name="Testing_for_General_Object_Instances"></a><span class="mw-headline">Testing for General Object Instances</span></h3>

  <p>Usage: <b>exist(<i>Object name</i>)</b> returns <i>Value</i> if named object exists or <b>0</b> if it does not.</p>

  <dl>
    <dd>
      <table class="simple">
        <tr>
          <th>Value</th>

          <th>Object type</th>
        </tr>

        <tr>
          <td>0</td>

          <td>Object does not exist.</td>
        </tr>

        <tr>
          <td>1</td>

          <td>dataset</td>
        </tr>

        <tr>
          <td>2</td>

          <td>workbook/worksheet</td>
        </tr>

        <tr>
          <td>3</td>

          <td>graph window</td>
        </tr>

        <tr>
          <td>4</td>

          <td>numeric variable</td>
        </tr>

        <tr>
          <td>5</td>

          <td>matrixbook/matrixsheet</td>
        </tr>

        <tr>
          <td>7</td>

          <td>tool</td>
        </tr>

        <tr>
          <td>8</td>

          <td>macro</td>
        </tr>

        <tr>
          <td>9</td>

          <td>notes window</td>
        </tr>

        <tr>
          <td>11</td>

          <td>layout window</td>
        </tr>

        <tr>
          <td>12</td>

          <td>Excel worksheet</td>
        </tr>
      </table>
    </dd>
  </dl>
  <pre class="lt" style="font-family:monospace;">
str<span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">"Book1"</span>;
exist<span style="color: #000000;">(</span>str<span style="color: #000080;">$</span><span style="color: #000000;">)</span><span style="color: #000080;">=</span>;  <span style="color: #008000;">// Will return 2</span>
<span style="color: #008000;">// you don't have to do this, even though it will lead to the same result</span>
exist<span style="color: #000000;">(</span><span style="color: #000080;">%</span><span style="color: #000000;">(</span>str<span style="color: #000080;">$</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span><span style="color: #000080;">=</span>;
</pre>
  <pre class="lt" style="font-family:monospace;">
str<span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">"Book2"</span>; <span style="color: #008000;">// Book2 is a Excel workbook</span>
exist<span style="color: #000000;">(</span>str<span style="color: #000080;">$</span>,<span style="color: #0000dd;">12</span><span style="color: #000000;">)</span><span style="color: #000080;">=</span>; <span style="color: #008000;">// will return 12</span>
</pre>

  <h3><a name="Graphic_Objects"></a><span class="mw-headline">Graphic Objects</span></h3>

  <p>Usage: <b>exist(<i>name</i>,16)</b> Looks for the named graphic object, returns 16 if it exists in the active layer or sheet, or 0 if it does not <font color="red">(9.0 SR0)</font>.</p>

  <h3><a name="String_Variables"></a><span class="mw-headline">String Variables</span></h3>

  <p>Usage: <b>exist(<i>name</i>, 18)</b> Looks for the named string variable and returns 18 if it exists, or 0 if it does not <font color="red">(8.0 SR0)</font>.</p>

  <p>The <b>exist</b> function will look at the content of the string, and not the string name itself, unless it is told to do otherwise. Therefore, in order to test if a string variable exists, you must use the value 18:</p>
  <pre class="lt" style="font-family:monospace;">
if<span style="color: #000000;">(</span>exist<span style="color: #000000;">(</span>str<span style="color: #000080;">$</span>,<span style="color: #0000dd;">18</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>
  type <span style="color: #ff00ff;">"Yes, str$="</span><span style="color: #000080;">+</span>str<span style="color: #000080;">$</span>;
else
  type <span style="color: #ff00ff;">"No, there is no string variable named str$"</span>;
</pre>

  <h3><a name="Range_Variables"></a><span class="mw-headline">Range Variables</span></h3>

  <p>In Origin 8.0 SR5 and before, a range variable would create a new instance of an object upon assignment, such that <b>exist(<i>range</i>)</b> would never return 0.</p>

  <p>In 8.0 SR6 this was changed, so that <b>exist(<i>range</i>)</b> will return 0 until the object is assigned a value. For example:</p>
  <pre class="lt" style="font-family:monospace;">
range aa<span style="color: #000080;">=</span>testCol; 
exist<span style="color: #000000;">(</span>aa<span style="color: #000000;">)</span><span style="color: #000080;">=</span>;  <span style="color: #008000;">// ANS: EXIST(AA)=0</span>

aa<span style="color: #000000;">[</span><span style="color: #0000dd;">1</span><span style="color: #000000;">]</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;     <span style="color: #008000;">// New column 'testCol' is created in the active worksheet</span>
exist<span style="color: #000000;">(</span>aa<span style="color: #000000;">)</span><span style="color: #000080;">=</span>;  <span style="color: #008000;">// ANS: EXIST(AA)=1</span>
</pre>

  <p> </p>

  <h3><a name="Testing_for_Origin_C_Functions"></a><span class="mw-headline">Testing for Origin C Functions</span></h3>

  <p>You can also use the exist(<i>name</i>) function to determine whether or not an Origin C function exists:</p>

  <table class="simple">
    <tr>
      <th>Function</th>

      <th>Purpose</th>

      <th>Return value if function exists</th>

      <th>Return value if function does NOT exist</th>
    </tr>

    <tr>
      <td>
        <b>exist(name)</b>

        <p><i>or</i></p>

        <p><b>exist(name,20)</b></p>
      </td>

      <td>test any Origin C function callable from LabTalk</td>

      <td>20</td>

      <td>0</td>
    </tr>

    <tr>
      <td><b>exist(name,21)</b></td>

      <td>test for an Origin C string function</td>

      <td>21</td>

      <td>0</td>
    </tr>

    <tr>
      <td><b>exist(name,22)</b></td>

      <td>test for an Origin C numeric function</td>

      <td>22</td>

      <td>0</td>
    </tr>

    <tr>
      <td><b>exist(name,23)</b></td>

      <td>test for an Origin C vector function</td>

      <td>23</td>

      <td>0</td>
    </tr>
  </table>

  <p>For example,</p>
  <pre class="lt" style="font-family:monospace;">
exist<span style="color: #000000;">(</span>char,<span style="color: #0000dd;">21</span><span style="color: #000000;">)</span><span style="color: #000080;">=</span>; <span style="color: #008000;">// Returns 21</span>
exist<span style="color: #000000;">(</span>Degrees<span style="color: #000000;">)</span><span style="color: #000080;">=</span>; <span style="color: #008000;">// Returns 20</span>
</pre>

  <h3><a name="File_Testing_with_exist.28fileName.29_or_exist.28filename.2C_n.29"></a><span class="mw-headline">File Testing with exist(fileName) or exist(filename, n)</span></h3>

  <p>When the string passed into <b>exist</b> function is in the form of a full path file name, then the <b>exist(<i>filename</i>)</b> function will return the file size in kbytes, including to return 0 if file is empty. If the specified file does not exist, -1 is returned.</p>

  <p>Use the <b>exist(<i>filename</i>, <i>n</i>)</b> function to check the version number and date of a file. If <i>n</i> = 1, 2, 3, or 4, this function returns the first, second, third, or fourth byte from the version resource. For example:</p>
  <pre class="lt" style="font-family:monospace;">
str<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span><span style="color: #000080;">+</span><span style="color: #ff00ff;">"oUtl60.dll"</span>;
for<span style="color: #000000;">(</span>ii<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;ii<span style="color: #000080;">&lt;=</span><span style="color: #0000dd;">4</span>;ii<span style="color: #000080;">++</span><span style="color: #000000;">)</span> exist<span style="color: #000000;">(</span>str<span style="color: #000080;">$</span>,ii<span style="color: #000000;">)</span><span style="color: #000080;">=</span>;
</pre>

  <p>To return the date (in Julian Days) of the file, set <i>n</i> = 5. For example:</p>
  <pre class="lt" style="font-family:monospace;">
str<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span><span style="color: #000080;">+</span><span style="color: #ff00ff;">"oUtl60.dll"</span>;
if<span style="color: #000000;">(</span>exist<span style="color: #000000;">(</span>str<span style="color: #000080;">$</span><span style="color: #000000;">)</span> <span style="color: #000080;">&gt;</span> <span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
  double dd <span style="color: #000080;">=</span> exist<span style="color: #000000;">(</span>str<span style="color: #000080;">$</span>,<span style="color: #0000dd;">5</span><span style="color: #000000;">)</span>;
  type <span style="color: #ff00ff;">"The file "</span><span style="color: #000080;">+</span>str<span style="color: #000080;">$</span><span style="color: #000080;">+</span><span style="color: #ff00ff;">" was last modified on $(dd, D9)"</span>;
<span style="color: #000000;">}</span>
</pre>

  <h3><a name="exist.28winName.2C_n.29"></a><span class="mw-headline"><span lang="DE">exist(winName, n)</span></span></h3>

  <p>The <b>exist(<i>winName</i>, <i>n</i>)</b> function provides information about window activity.</p>

  <p>If <i>n</i> = 0, this function returns a non-zero value if the specified window is active and is not hidden. Otherwise, it returns 0.</p>

  <p>If <i>n</i> = 10, this function returns a non-zero value if the specified window is active. Otherwise, it returns 0.</p>

  <p>For example,</p>
  <pre class="lt" style="font-family:monospace;">
exist<span style="color: #000000;">(</span>Graph1,<span style="color: #0000dd;">10</span><span style="color: #000000;">)</span><span style="color: #000080;">=</span>; <span style="color: #008000;">//will return 3 if Graph1 window is active.</span>
</pre>

  <h3><a name="Testing_for_LabTalk_tree"></a><span class="mw-headline">Testing for LabTalk tree</span></h3>

  <p>You can use the exist(<i>tree name</i>) function to check whether or not the specified tree exists.</p>
  <pre class="lt" style="font-family:monospace;">
tree tt; <span style="color: #008000;">//define a LabTalk tree</span>
exist<span style="color: #000000;">(</span>tt<span style="color: #000000;">)</span><span style="color: #000080;">=</span>; <span style="color: #008000;">//will return 24 if this tree exists; Otherwise, return 0.</span>
</pre>

  <h3><a name="Testing_for_Folders"></a><span class="mw-headline">Testing for Folders</span></h3>

  <p>You can also use the exist(<i>name</i>) function to determine whether or not a Folder exists in a project. <span style="color:red">(Origin 8.1SR2)</span>:</p>

  <table class="simple">
    <tr>
      <th>Function</th>

      <th>Purpose</th>

      <th>Return value if folder exists</th>

      <th>Return value if folder does NOT exist</th>
    </tr>

    <tr>
      <td>
        <b>exist(Folder Name [, 25])</b>

        <p><i>or</i></p>

        <p><b>exist(../Folder Name [, 25])</b></p>
      </td>

      <td>
        test for existence of <b>Folder Name</b> in current folder or in specified path. For example<br>

        <p>if(exist(Run Data,25) == 0) pe_mkdir "Run Data";</p>
      </td>

      <td>25</td>

      <td>0</td>
    </tr>
  </table>
