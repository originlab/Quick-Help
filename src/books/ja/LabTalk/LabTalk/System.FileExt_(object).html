<h1 class="firstheading">System.FileExt</h1>

  <p class='urlname' style='display: none'>System-FileExt-obj</p>

  <p>Read and alter the file extension, file location, and file tracking settings</p>

  <p>&#160;</p>

  <p><b>LabTalk Object Type:</b></p>

  <dl>
    <dd><a href="../../LabTalk/LabTalk/Utility_Objects,_Property_and_Method_Syntax_(Object).html" title="LabTalk:Utility Objects, Property and Method Syntax (Object)">Utility</a></dd>
  </dl>

  <p>The fileExt object is a subobject of the system object. The fileExt object property allows you to read and alter the file extension, file location, and file tracking settings, which are set in the OPTION.CNF file. These settings can also be accessed in the Options dialog box.</p>

  <p>Definitions for this object:</p>

  <ul>
    <li><b>Extension</b>: The portion of text in the file name that follows the last period. For example, BMP is the extension of the file named "MyImage.BMP".</li>
  </ul>

  <ul>
    <li><b>Extension Description</b>: The text that appears in the Files of Type combination box in the Open and Save As dialog box. This text is used to describe or identify the files that are named with a specific Extension. Example: Windows Bitmap (*.BMP)</li>
  </ul>

  <ul>
    <li><b>Extension Group</b>: A list of Extension Descriptions. Example: Images</li>
  </ul>

  <p>&#160;</p>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>Contents</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1"><a href="#Properties:"><span class="tocnumber">1</span> <span class="toctext">Properties:</span></a></li>

      <li class="toclevel-1 tocsection-2"><a href="#Methods:"><span class="tocnumber">2</span> <span class="toctext">Methods:</span></a></li>

      <li class="toclevel-1 tocsection-3"><a href="#Examples:"><span class="tocnumber">3</span> <span class="toctext">Examples:</span></a></li>

      <li class="toclevel-1 tocsection-4"><a href="#See_Also:"><span class="tocnumber">4</span> <span class="toctext">See Also:</span></a></li>
    </ul>
  </div>

  <h2><a name="Properties:"></a><span class="mw-headline"><font color="chocolate">Properties:</font></span></h2>

  <table class="simple">
    <tr>
      <th width="110">Property</th>

      <th width="70">Access</th>

      <th width="540">Description</th>
    </tr>

    <tr>
      <td>System.fileExt.activeGroup</td>

      <td>Read/write<br>
      numeric</td>

      <td>
        <p>This property returns the index of the group that is currently active. If there are no groups, then this property will return zero. You can change the active group by setting this property to the index of the group you want to make active. Values used for setting this property must be in the range [1, numGroups]. Setting this property will be ignored when there are no groups.</p>
      </td>
    </tr>

    <tr>
      <td>System.fileExt.activeGroup$</td>

      <td>Read/write<br>
      string</td>

      <td>
        <p>This property returns the name of the group that is currently active. If there are no groups, then this property will return an empty string (""). You can change the active group by setting this property to the name of the group you want to make active. Setting this property will be ignored when there are no groups. This property and the Name$ property will always return the same value.</p>
      </td>
    </tr>

    <tr>
      <td>System.fileExt.defASCII$</td>

      <td>Read/write<br>
      string</td>

      <td>
        <p>This property is used for getting and setting the default extension to be appended to ASCII files when an extension is not specified by the user.</p>
      </td>
    </tr>

    <tr>
      <td>System.fileExt.defPath$</td>

      <td>Read/write<br>
      string</td>

      <td>
        <p>This property is used for getting and setting the default path for the file types of the active group.</p>
      </td>
    </tr>

    <tr>
      <td>System.fileExt.defType</td>

      <td>Read/write<br>
      numeric</td>

      <td>
        <p>The extension type used by default in the Files of Type combination box in the file dialog box. This value must be in the range [1, numTypes].</p>
      </td>
    </tr>

    <tr>
      <td>System.fileExt.name$</td>

      <td>Read/write<br>
      string</td>

      <td>
        <p>The name of the active group. Setting this property allows you to rename the active group. The Name$ and ActiveGroup$ properties always return the same value.</p>
      </td>
    </tr>

    <tr>
      <td>System.fileExt.numGroups</td>

      <td>Read/write<br>
      numeric</td>

      <td>
        <p>The number of extension groups currently defined. You can set this value to decrease or increase the number of groups to be handled by the System.FileExt object. While increasing NumGroups is a way to add more groups, it is highly recommended that you use the AddGroup() method instead.</p>
      </td>
    </tr>

    <tr>
      <td>System.fileExt.numTypes</td>

      <td>Read/write<br>
      numeric</td>

      <td>
        <p>The number of extension types in the active group. You can set this value to decrease or increase the number of types in the active group. This value must be in the range [0,25]. While increasing NumTypes is a way to add more types, it is highly recommended that you use the AddType() method instead.</p>
      </td>
    </tr>

    <tr>
      <td>System.fileext.openPathMode</td>

      <td>Read/write<br>
      numeric</td>

      <td>
        <p>Path used by FDlog object 1 = User Path, 2 = Project Path, 3 = Origin Path.</p>
      </td>
    </tr>

    <tr>
      <td>System.fileext.savePathMode</td>

      <td>Read/write<br>
      numeric</td>

      <td>
        <p>Path used by FDlog object. 0 = Use Open Path, 1 = User Path, 2 = Project Path, 3 = Origin Path.</p>
      </td>
    </tr>

    <tr>
      <td>System.fileExt.tracking</td>

      <td>Read/write<br>
      numeric</td>

      <td>
        <p>Tracking default file paths: 0 = no tracking, 1 = Track file dialog changes.</p>
      </td>
    </tr>

    <tr>
      <td>System.fileExt.typen$</td>

      <td>Read/write<br>
      string</td>

      <td>
        <p>This array property is used for getting and setting the nth extension type for the active group. The index must be in the range (1, NumTypes). The extension type must be in the format "[description] *.extension" where description is the text that appears in the Files of Type combination box and extension is used to determine what files are displayed.</p>
      </td>
    </tr>
  </table>

  <h2><a name="Methods:"></a><span class="mw-headline"><font color="chocolate">Methods:</font></span></h2>

  <table class="simple">
    <tr>
      <th width="180">Method</th>

      <th width="540">Description</th>
    </tr>

    <tr>
      <td>System.fileExt.addGroup(groupName)</td>

      <td>
        <p>Add (create) a new File Extension group. groupName is the name that will be used to identify the group and the types of files it will contain. Each group name must be unique. On success, the added group becomes the active group and the NumGroups property is incremented. Return value is zero for success and non-zero for error.</p>
      </td>
    </tr>

    <tr>
      <td>System.fileExt.addType(extensionType)</td>

      <td>
        <p>Add (create) a new Extension type. extensionType is the Extension type string. The string must be in the format: "[description] *.extension" where description is the text displayed in the Files of Type combination box and extension is the extension of the files to display in the file list box. On success, the NumTypes property is incremented. Return value is zero for success and non-zero for error.</p>
      </td>
    </tr>

    <tr>
      <td>groupIndex)</td>

      <td>
        <p>Delete a File Extension group by name or index. On success the NumGroups property is decremented. Return value is zero for success and non-zero for error.</p>
      </td>
    </tr>

    <tr>
      <td>System.fileExt.getType(extension)</td>

      <td>
        <p>Returns the index of the system.fileExt.typen$ property that represents the file type specified in extension. If no file type represents the extension then zero is returned. Example extension is BMP, EPS, JPG, etc. This is not case sensitive.</p>
      </td>
    </tr>

    <tr>
      <td>System.fileExt.reset()</td>

      <td>
        <p>Delete all File Extension groups. Numeric properties are set to zero and string properties are set to blank (""). Return value is always zero. system.fileExt.setTypeExts(groupName, extension) Set the extensions for the extension type system.fileExt.typen$. If groupName does not exist, it is added.</p>

        <p>For example: If the active file extension group is set as follows: system.fileExt.type1$ = "[Image (*.BMP)] *.BMP"; And then you execute the following: system.fileExt.setTypeExts("Image", tif jpg); Then the type will look as follows: system.fileExt.type1$="[Image (*.TIF,*.JPG)] *.TIF;*.JPG";</p>
      </td>
    </tr>
  </table>

  <h2><a name="Examples:"></a><span class="mw-headline"><font color="chocolate">Examples:</font></span></h2>

  <p><b>Example1:</b> The following script prints out all extension groups and their extension types:</p>
  <pre class="lt" style="font-family:monospace;">
for<span style="color: #000000;">(</span>ii<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;ii<span style="color: #000080;">&lt;=</span>system.<span style="color: #000080;">fileext</span>.<span style="color: #000080;">numgroups</span>;ii<span style="color: #000080;">++</span><span style="color: #000000;">)</span> <span style="color: #000000;">{</span>
  system.<span style="color: #000080;">fileExt</span>.<span style="color: #000080;">ActiveGroup</span><span style="color: #000080;">=</span>ii;
  <span style="color: #000080;">%</span>A<span style="color: #000080;">=</span>system.<span style="color: #000080;">fileExt</span>.<span style="color: #000080;">ActiveGroup</span><span style="color: #000080;">$</span>;
  type Group<span style="color: #000000;">:</span><span style="color: #000080;">$</span><span style="color: #000000;">(</span>ii<span style="color: #000000;">)</span> <span style="color: #000080;">%</span>A;
  for<span style="color: #000000;">(</span>jj<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;jj<span style="color: #000080;">&lt;=</span>system.<span style="color: #000080;">fileExt</span>.<span style="color: #000080;">numTypes</span>;jj<span style="color: #000080;">++</span><span style="color: #000000;">)</span> <span style="color: #000000;">{</span>
    <span style="color: #000080;">%</span>B<span style="color: #000080;">=</span>system.<span style="color: #000080;">FileExt</span>.<span style="color: #000080;">type</span><span style="color: #000080;">$</span><span style="color: #000000;">(</span>jj<span style="color: #000000;">)</span><span style="color: #000080;">$</span>;
    type ...<span style="color: #000080;">Type</span><span style="color: #000000;">:</span><span style="color: #000080;">$</span><span style="color: #000000;">(</span>jj<span style="color: #000000;">)</span> <span style="color: #000080;">%</span>B;
    <span style="color: #000000;">}</span>
<span style="color: #000000;">}</span>
</pre>

  <p><br>
  <b>Example2:</b></p>

  <p>The following script add an extension group which include a single type:</p>
  <pre class="lt" style="font-family:monospace;">
system.<span style="color: #000080;">fileExt</span>.<span style="color: #000080;">addGroup</span><span style="color: #000000;">(</span>myExtGrp<span style="color: #000000;">)</span>;
system.<span style="color: #000080;">fileExt</span>.<span style="color: #000080;">ActiveGroup</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">fileext</span>.<span style="color: #000080;">numgroups</span>;
system.<span style="color: #000080;">fileExt</span>.<span style="color: #000080;">numTypes</span><span style="color: #000080;">++</span>;
system.<span style="color: #000080;">fileExt</span>.<span style="color: #000080;">type1</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">"[My Init File (*.mif)] *.MIF"</span>;
</pre>

  <h2><a name="See_Also:"></a><span class="mw-headline"><font color="chocolate">See Also:</font></span></h2>

  <p><a href="../../LabTalk/LabTalk/System.Project_(object).html" title="LabTalk:System.Project (object)">System.Project</a>, <a href="../../LabTalk/LabTalk/System.Path_(object).html" title="LabTalk:System.Path (object)">System.Path</a>, <a class="external text" href="../../XFunction/X-Function/Dir.html">Dir</a>, <a class="external text" href="../../XFunction/X-Function/Cdset.html">Cdset</a></p>
