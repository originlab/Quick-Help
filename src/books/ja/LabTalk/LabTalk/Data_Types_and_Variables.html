<h1 class="firstheading">データ型と変数</h1><p class='urlname' style='display: none'>Data-Types-and-vars</p>
<p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#LabTalk_Data_TypesData_TypeVariable"><span class="tocnumber">1</span> <span class="toctext">LabTalkのデータ型<span class="OIndex" style="display:none">Data Type</span><span class="OIndex" style="display:none">Variable</span></span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Numeric"><span class="tocnumber">1.1</span> <span class="toctext">Numeric</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Dataset"><span class="tocnumber">1.2</span> <span class="toctext">Dataset</span></a>
<ul>
<li class="toclevel-3 tocsection-4"><a href="#Temporary_Loose_Dataset"><span class="tocnumber">1.2.1</span> <span class="toctext">一時非接続データセット</span></a></li>
<li class="toclevel-3 tocsection-5"><a href="#Project_Level_Loose_Dataset"><span class="tocnumber">1.2.2</span> <span class="toctext">プロジェクトレベルの非接続データセット</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-6"><a href="#String"><span class="tocnumber">1.3</span> <span class="toctext">String</span></a>
<ul>
<li class="toclevel-3 tocsection-7"><a href="#String_Variables"><span class="tocnumber">1.3.1</span> <span class="toctext">文字列変数</span></a></li>
<li class="toclevel-3 tocsection-8"><a href="#String_RegistersString_Register"><span class="tocnumber">1.3.2</span> <span class="toctext">文字列レジスタ<span class="OIndex" style="display:none">String Register</span></span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-9"><a href="#StringArray"><span class="tocnumber">1.4</span> <span class="toctext">StringArray</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Range"><span class="tocnumber">1.5</span> <span class="toctext">Range</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Tree"><span class="tocnumber">1.6</span> <span class="toctext">Tree</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Graphic_Objects"><span class="tocnumber">1.7</span> <span class="toctext">グラフィックオブジェクト</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-13"><a href="#Variables"><span class="tocnumber">2</span> <span class="toctext">変数</span></a>
<ul>
<li class="toclevel-2 tocsection-14"><a href="#Variable_Naming_RulesVariable_Naming_Rule"><span class="tocnumber">2.1</span> <span class="toctext">変数の命名規則<span class="OIndex" style="display:none">Variable Naming Rule</span></span></a></li>
<li class="toclevel-2 tocsection-15"><a href="#Handling_Variable_Name_ConflictsVariable_Name_Conflict"><span class="tocnumber">2.2</span> <span class="toctext">変数名の競合の取り扱い<span class="OIndex" style="display:none">Variable Name Conflict</span></span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#Listing_and_Deleting_VariablesList_VariablesDelete_Variable"><span class="tocnumber">2.3</span> <span class="toctext">変数の一覧表示と削除<span class="OIndex" style="display:none">List Variables</span><span class="OIndex" style="display:none">Delete Variable</span></span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-17"><a href="#Scope_of_Variables"><span class="tocnumber">3</span> <span class="toctext">変数のスコープ</span></a>
<ul>
<li class="toclevel-2 tocsection-18"><a href="#Project_Variables"><span class="tocnumber">3.1</span> <span class="toctext">プロジェクト変数</span></a></li>
<li class="toclevel-2 tocsection-19"><a href="#Session_Variablesscope.2C_session"><span class="tocnumber">3.2</span> <span class="toctext">セッション変数<span class="OIndex" style="display:none">scope, session</span></span></a></li>
<li class="toclevel-2 tocsection-20"><a href="#Local_Variablesscope.2C_local"><span class="tocnumber">3.3</span> <span class="toctext">ローカル変数<span class="OIndex" style="display:none">scope, local</span></span></a></li>
<li class="toclevel-2 tocsection-21"><a href="#Making_Local_Variables_and_Functions_Available_in_the_Session_scope.2C_forcing_change_of"><span class="tocnumber">3.4</span> <span class="toctext">4 ローカル変数と関数をセッション内で使用<span class="OIndex" style="display:none">scope, forcing change of</span></span></a></li>
<li class="toclevel-2 tocsection-22"><a href="#Summary_Table:_Scope_of_Variables"><span class="tocnumber">3.5</span> <span class="toctext">要約表:変数のスコープ</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="LabTalk_Data_TypesData_TypeVariable"></a><span class="mw-headline">LabTalkのデータ型<span class="OIndex" style="display:none">Data Type</span><span class="OIndex" style="display:none">Variable</span></span></h2>
<p>LabTalkは9つのデータ型をサポートしています。
</p>
<table class="simple">

<tr>
<th> データ型
</th>
<th> コメント
</th></tr>
<tr>
<td> Double
</td>
<td> double型の精度を持つ浮動小数点数
</td></tr>
<tr>
<td> Integer
</td>
<td> 整数値
</td></tr>
<tr>
<td> Constant
</td>
<td> 一度宣言されると変更できない数値データ型
</td></tr>
<tr>
<td> Dataset
</td>
<td> 数値の配列
</td></tr>
<tr>
<td> String
</td>
<td> 連続した文字
</td></tr>
<tr>
<td> StringArray
</td>
<td> 文字列の配列
</td></tr>
<tr>
<td> Range
</td>
<td> Originオブジェクト（ワークブック、ワークシート等）の特定の範囲を参照
</td></tr>
<tr>
<td> Tree
</td>
<td> 枝(ブランチ)と葉(リーフ)を持つ木(ツリー)構造のデータ
</td></tr>
<tr>
<td> グラフィックオブジェクト
</td>
<td> オブジェクト(ラベル、矢印、線及びその他ユーザーによって作成されたグラフィックエレメントなど)
</td></tr></table>
<h3><a name="Numeric"></a><span class="mw-headline">数値</span></h3>
<p>LabTalkは3つの<span class="OIndex">数値データ型</span>: <b>double</b>、<b>int</b>、<b>const</b>をサポートしています。
</p>
<ol><li> <span class="OIndex">Double</span>: double型の精度を持つ浮動小数点数。これはOriginのデフォルトの変数型です。</li>
<li> <span class="OIndex">Integer</span>: 整数 (<b>int</b>)はLabTalkではdouble型で保存され、代入中に切り詰めされます。</li>
<li> <span class="OIndex">Constant</span>: 定数(<b>const</b>)は、LabTalkで利用できる3番目の数値データ型です。  一度宣言されると、<b>constant</b>の値は変更できません。Origin 2016以降、<b>constant</b>は一度宣言されるとorgvar.ogs に自動保存されます。つまり、<b>constant</b>は、「システム変数として保存され、新しいOriginのセッションでも使用できることを意味します。</li></ol>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 新しい変数データ型として doubleを宣言</span>
double dd <span style="color: #000080;">=</span> <span style="color: #0000dd;">4.5678</span>;
<span style="color: #008000;">// 新しいinteger 変数を宣言</span>
int vv <span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span>;
<span style="color: #008000;">// 新しいconstantを宣言</span>
const em <span style="color: #000080;">=</span> <span style="color: #0000dd;">0.5772157</span>;</pre>
<p><b>Note</b>: 
</p>
<ul><li> 新しいOriginセッションを開いた後に定数を使用するには、ユーザーファイルフォルダにあるCONST.CNFファイルで定数を定義する必要があります。</li>
<li> LabTalkには<b>complex</b>データ型はありません。列は複素数データタイプとして設定でき、その際は基本的な演算子(+,-,*,/)を使用して列の間の演算を行ったり、リテラル値を使用できます。複素数を入力した列値や文字式から実数部や虚数部を抽出する関数は用意されていますが、<b>complex</b>変数を必要とするなら<b>Origin C</b>を利用してください。</li></ul>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 直接、文字式</span>
<span style="color: #000000;">(</span><span style="color: #0000dd;">3</span><span style="color: #000080;">-</span>13i<span style="color: #000000;">)</span> <span style="color: #000080;">/</span> <span style="color: #000000;">(</span><span style="color: #0000dd;">7</span><span style="color: #000080;">+</span>2i<span style="color: #000000;">)</span> <span style="color: #000080;">=</span>; 
<span style="color: #008000;">// (3-13i) / (7+2i)=-0.094339622641509-1.8301886792453i</span>
<span style="color: #008000;">// 複素数列に文字式を割り当て</span>
col<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span><span style="color: #000000;">[</span><span style="color: #0000dd;">3</span><span style="color: #000000;">]</span> <span style="color: #000080;">=</span> <span style="color: #000000;">(</span><span style="color: #0000dd;">3</span><span style="color: #000080;">-</span>13i<span style="color: #000000;">)</span> <span style="color: #000080;">*</span> <span style="color: #000000;">(</span><span style="color: #0000dd;">7</span><span style="color: #000080;">+</span>2i<span style="color: #000000;">)</span>;
<span style="color: #008000;">// 複素数列または文字式の実数部分を取得</span>
dReal1 <span style="color: #000080;">=</span> imreal<span style="color: #000000;">(</span>col<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span><span style="color: #000000;">[</span><span style="color: #0000dd;">3</span><span style="color: #000000;">]</span><span style="color: #000000;">)</span>;
dReal2 <span style="color: #000080;">=</span> imreal<span style="color: #000000;">(</span><span style="color: #000000;">(</span><span style="color: #0000dd;">3</span><span style="color: #000080;">-</span>13i<span style="color: #000000;">)</span> <span style="color: #000080;">+</span> <span style="color: #000000;">(</span><span style="color: #0000dd;">7</span><span style="color: #000080;">+</span>2i<span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
<span style="color: #008000;">// 複素数列または文字式の虚数部分を取得</span>
dImag1 <span style="color: #000080;">=</span> imaginary<span style="color: #000000;">(</span>col<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span><span style="color: #000000;">[</span><span style="color: #0000dd;">3</span><span style="color: #000000;">]</span><span style="color: #000000;">)</span>;
dImag2 <span style="color: #000080;">=</span> imaginary<span style="color: #000000;">(</span><span style="color: #000000;">(</span><span style="color: #0000dd;">3</span><span style="color: #000080;">-</span>13i<span style="color: #000000;">)</span> <span style="color: #000080;">-</span> <span style="color: #000000;">(</span><span style="color: #0000dd;">7</span><span style="color: #000080;">+</span>2i<span style="color: #000000;">)</span><span style="color: #000000;">)</span>;</pre>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Data_Types_and_Variables/Alert_icon.png" width="57"  border="0" /></td><td><p>0.0, NANUM(欠損値)や-1.0E-290 から 1.0E-290の値などは、論理宣言中で<i>False</i>として評価されます。つまり、LabTalkコマンドは、1(真)の代わりに0(偽)を返します。 
</p>
<pre class="lt" style="font-family:monospace;">type <span style="color: #000080;">$</span><span style="color: #000000;">(</span><span style="color: #000080;">-</span>1e<span style="color: #000080;">-</span>290?<span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// 0 (偽)を返す</span>
type <span style="color: #000080;">$</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000080;">/</span><span style="color: #0000dd;">0</span>?<span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// 0 (偽)を返す、ここで1/0 == NANUM</span></pre>
	</td>
	</tr>
	</table>
<h3><a name="Dataset"></a><span class="mw-headline">Dataset</span></h3>
<p><span class="OIndex">Dataset</span>データ型は数値配列を保持するように設計されています。 
</p>
<h4><a name="Temporary_Loose_Dataset"></a><span class="mw-headline">一時非接続データセット</span></h4>
<p><a href="../../LabTalk/LabTalk/Datasets_(object).html" title="LabTalk:Datasets (オブジェクト)"><b>dataset</b></a>変数を宣言すると、それはローカルな<span class="OIndex">一時非接続データセット</span>として内部的に保存されます。  一時非接続データセットは、Originプロジェクトと一緒に保存されず、特定のワークシートとは結びついていません。  一時非接続データセットは、計算のみに使用され、プロット用に使用することはできません。
</p><p>以下のサンプルでは、データ型の使用法を紹介します（<a href="../../LabTalk/LabTalk/Datasets_(object).html#Getting_and_Setting_Size" title="LabTalk:Datasets (オブジェクト)">Dataset型の宣言</a>と<a href="../../LabTalk/LabTalk/Numeric_to_String_Conversion.html" title="LabTalk:数値から文字列への変換">$ 置換表記</a>を使用します。）
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 1から10で、増分0.2の値を持つ </span>
<span style="color: #008000;">// データセット &apos;aa&apos; を宣言 </span>
dataset aa<span style="color: #000080;">=</span><span style="color: #000000;">{</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">0.2</span><span style="color: #000000;">:</span><span style="color: #0000dd;">10</span><span style="color: #000000;">}</span>;

<span style="color: #008000;">// integer型 &apos;nSize&apos;を宣言し、</span>
<span style="color: #008000;">// これに新しい配列の長さを割り当て  </span>
int nSize <span style="color: #000080;">=</span> aa.<span style="color: #000080;">GetSize</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;

<span style="color: #008000;">// スクリプトウィンドウに&apos;aa&apos;の長さを出力 </span>
type <span style="color: #ff00ff;">&quot;aa has $(nSize) values&quot;</span>;</pre>
<h4><a name="Project_Level_Loose_Dataset"></a><span class="mw-headline">プロジェクトレベルの非接続データセット</span></h4>
<p>vectorデータを代入(宣言せずに)または <a href="../../LabTalk/LabTalk/Create_(command).html" title="LabTalk:Create (コマンド)">Create (コマンド)</a> を使って、データセットを作成すると、それは、<span class="OIndex">プロジェクトレベルのデータセット</span>となり、 計算またはプロット用に使用することができます。
</p><p>代入によるプロジェクトレベルデータセットの作成
</p>
<pre class="lt" style="font-family:monospace;">bb <span style="color: #000080;">=</span> <span style="color: #000000;">{</span><span style="color: #0000dd;">10</span><span style="color: #000000;">:</span><span style="color: #0000dd;">2</span><span style="color: #000000;">:</span><span style="color: #0000dd;">100</span><span style="color: #000000;">}</span></pre>
<p>または、<b><a href="../../LabTalk/LabTalk/Create_(command).html" title="LabTalk:Create (コマンド)">Create</a>コマンド</b>を使用する方法
</p>
<pre class="lt" style="font-family:monospace;">create <span style="color: #000080;">%</span><span style="color: #000000;">(</span>strWks<span style="color: #000080;">$</span><span style="color: #000000;">)</span> <span style="color: #000080;">-</span>wdn <span style="color: #0000dd;">10</span> aa bb;</pre>
<p>プロジェクトレベルまたはローカルレベルの変数についての詳細は、以下の<a href="#Scope_of_Variables">変数のスコープ</a>のセクションをご覧下さい。
</p><p>データセットの操作については、<a href="../../LabTalk/LabTalk/Datasets_(object).html" title="LabTalk:Datasets (オブジェクト)">Datasets</a>をご覧下さい。
</p><p>%( )の操作については、<a href="../../LabTalk/LabTalk/Numeric_to_String_Conversion.html" title="LabTalk:数値から文字列への変換">$( ) 置換-数値から文字列の変換</a>をご覧下さい。
</p>
<h3><a name="String"></a><span class="mw-headline">String</span></h3>
<p>LabTalkでは、文字列変数および文字列レジスタの2つの方法で文字列を扱います。
</p>
<h4><a name="String_Variables"></a><span class="mw-headline">文字列変数</span></h4>
<p><span class="OIndex">文字列変数</span>は、宣言と代入で作成されたり、代入のみ(定義された<a href="../../LabTalk/LabTalk/Data_Types_and_Variables.html#Scope_of_Variables" title="LabTalk:データ型と変数">変数スコープ</a>による)で作成されます。そして、LabTalkでは連続した文字の名前に<b>$</b>記号を付けて表されます。(下記の<a href="#Variable_Naming_RulesVariable_Naming_Rule">命名規則</a>を参照) (例、<i>stringName$</i>)
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 宣言と割り当てによりローカル/セッションスコープで文字列を作成</span>

<span style="color: #008000;">// &quot;greeting&quot;という文字列を作成し </span>
<span style="color: #008000;">// 値&quot;Hello&quot;を割り当て:  </span>
string greeting<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Hello&quot;</span>;

<span style="color: #008000;">// $終了は、宣言ではオプションですが、割り当てには必須</span>
string FirstName, LastName; 
FirstName<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Isaac;
LastName<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Newton;

<span style="color: #008000;">// 宣言なしで割り当ててプロジェクト文字列を作成: </span>
greeting2<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;World&quot;</span>;<span style="color: #008000;">//プロジェクトスコープ。OPJで保存</span>

<span style="color: #008000;">// 文字列変数は文字列クラスメソッドを利用できる</span>
string str<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Johann Sebastian Bach;
str.<span style="color: #000080;">Find</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&apos;Sebastian&apos;</span><span style="color: #000000;">)</span><span style="color: #000080;">=</span>;

<span style="color: #008000;">// リテラル文字列を定義</span>
<span style="color: #008000;">// 構文&lt;[&lt;は、リテラル文字列の開始を示す</span>
<span style="color: #008000;">//  &gt;]&gt; はリテラル文字列の終了を示す</span>
<span style="color: #008000;">// 文字列に二重引用符などの特殊記号を含めるために使用できる</span>
string s1<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">&lt;</span><span style="color: #000000;">[</span><span style="color: #000080;">&lt;</span>a<span style="color: #ff00ff;">&quot;b&apos;&quot;</span>;<span style="color: #ff00ff;">&quot;c&quot;</span><span style="color: #000080;">&gt;</span><span style="color: #000000;">]</span><span style="color: #000080;">&gt;</span>;
s1<span style="color: #000080;">$</span><span style="color: #000080;">=</span>;
<span style="color: #008000;">// a&quot;b&apos;&quot;;&quot;c&quot;を返す</span>

<span style="color: #008000;">//Xファンクション引数でリテラル文字列を使用</span>
<span style="color: #008000;">// 現在選択されているワークシート列に3行を入力</span>
patternT text<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span><span style="color: #000000;">[</span><span style="color: #000080;">&lt;</span><span style="color: #ff00ff;">&quot;Sample A&quot;</span> <span style="color: #ff00ff;">&quot;Sample B&quot;</span> <span style="color: #ff00ff;">&quot;Sample C&quot;</span><span style="color: #000080;">&gt;</span><span style="color: #000000;">]</span><span style="color: #000080;">&gt;</span>;</pre>
<p>文字列変数の操作については、<a href="../../LabTalk/Script/String_Processing.html" title="Script:文字列の処理">文字列の処理</a>項目を参照してください。
</p>
<h4><a name="String_RegistersString_Register"></a><span class="mw-headline">文字列レジスタ</span></h4>
<p>文字列を<a href="../../LabTalk/LabTalk/String_registers.html" title="LabTalk:文字列レジスタ">文字列レジスタ</a>に保存することもできます。これは、%記号にアルファベット文字を付けて表します。(例、%A-%Z)文字列レジスタは常にグローバルスコープになります。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000; font-style: regular;">/* 文字列レジスタ%Aに文字列&quot;Hello World&quot;を割り当て */</span>
<span style="color: #000080;">%</span>A <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Hello World&quot;</span>;</pre>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Data_Types_and_Variables/Tip_icon.png" width="57"  border="0" /></td><td><p>Originの現在のバージョンでは、文字列の操作については、いくつかの役立つメソッドがあるので、文字列変数を使用することをお勧めします。詳細は、<a href="../../LabTalk/LabTalk/String_(object).html" title="LabTalk:String(オブジェクト)">String(オブジェクト)</a>をご覧下さい。  文字列レジスタを既に使っている場合、その使用法については、 <a href="../../LabTalk/LabTalk/String_registers.html" title="LabTalk:文字列レジスタ">文字列レジスタ</a>をご覧下さい。 
</p></td></tr></table>
<p><br />
</p>
<h3><a name="StringArray"></a><span class="mw-headline">StringArray</span></h3>
<p><span class="OIndex">StringArray</span>データ型は、<a href="../../LabTalk/LabTalk/Datasets_(object).html" title="LabTalk:Datasets (オブジェクト)">Datasets</a> データ型が数値配列を扱うのと同じように、文字列の配列を扱います。  String データ型と同様に、StringArrayもいくつかの組込のメソッドがあります。詳細は <a href="../../LabTalk/LabTalk/StringArray_(object).html" title="LabTalk:StringArray (オブジェクト)">StringArray (オブジェクト)</a>をご覧下さい。
</p><p>次のサンプルは、StringArrayの使用例を示します。 
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// &quot;aa&quot;という文字列配列を宣言,</span>
<span style="color: #008000;">// そして、組込のメソッドAddとGetSizeを使う </span>
StringArray aa;             <span style="color: #008000;">// aaは空白の文字列配列
</span>
aa.<span style="color: #000080;">Add</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Boston&quot;</span><span style="color: #000000;">)</span>;           <span style="color: #008000;">// ここでaaに1つの要素: &quot;Boston&quot;をいれる</span>
aa.<span style="color: #000080;">Add</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;New York&quot;</span><span style="color: #000000;">)</span>;         <span style="color: #008000;">// aaに2つ目の要素、&quot;New York&quot;を入れる</span>

<span style="color: #008000; font-style: regular;">/* &quot;aa has 2 strings in it&quot; と出力*/</span> 
type <span style="color: #ff00ff;">&quot;aa has $(aa.GetSize()) strings in it:&quot;</span>; 
loop<span style="color: #000000;">(</span>ii,<span style="color: #0000dd;">1</span>,aa.<span style="color: #000080;">GetSize</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
	ty aa.<span style="color: #000080;">GetAt</span><span style="color: #000000;">(</span>ii<span style="color: #000000;">)</span><span style="color: #000080;">$</span>;
<span style="color: #000000;">}</span></pre>
<p><br />
</p>
<h3><a name="Range"></a><span class="mw-headline">Range</span></h3>
<p><span class="OIndex">range</span>データ型は、ワークブック、ワークシート、グラフ、レイヤ、ウィンドウ等にある特定の領域を参照するOriginのデータに関連するオブジェクトにアクセスできます。
</p><p>一般的なシンタックスは：
</p><p><b>range <i>rangeName</i> = [<i>WindowName</i>]<i>LayerNameOrIndex</i>!<i>DataRange[subRange]</i></b>
</p><p>これは、ワークブック、行列、グラフ内の特定のデータにアクセスします。
</p><p><b>range <i>rangeName</i> = [<i>BookName</i>]<i>SheetNameOrIndex</i>!<i>ColumnNameOrIndex</i>[<i>RowBegin</i>:<i>RowEnd</i>]</b> 
</p><p><b>range <i>rangeName</i> = [<i>MatrixBookName</i>]<i>MatrixSheetNameOrIndex</i>!<i>MatrixObjectNameOrIndex[CellBegin:CellEnd]</i></b>
</p><p><b>range <i>rangeName</i> =[<i>GraphName</i>]<i>LayerNameOrIndex</i>!<i>DataPlotIndex[RowBegin:RowEnd]</i></b>
</p><p>一時データセットにアクセスするrange変数を作成するには特別なシンタックス<b>[??]</b>を使用します。
</p><p>例えば、
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Book1、Sheet2、列3にアクセス:</span>
range cc <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>Book1<span style="color: #000000;">]</span>Sheet2<span style="color: #000080;">!</span>Col<span style="color: #000000;">(</span><span style="color: #0000dd;">3</span><span style="color: #000000;">)</span>; 
<span style="color: #008000;">// Graph1、layer1の二番目の曲線にアクセス:  </span>
range ll <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>Graph1<span style="color: #000000;">]</span>Layer1<span style="color: #000080;">!</span><span style="color: #0000dd;">2</span>; 
<span style="color: #008000;">// MBook1、MSheet1の二番目の行列にアクセス:      </span>
range mm <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>MBook1<span style="color: #000000;">]</span>MSheet1<span style="color: #000080;">!</span><span style="color: #0000dd;">2</span>;
<span style="color: #008000;">// 非接続データセットtmpdata_aにアクセス:      </span>
range xx <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>??<span style="color: #000000;">]</span><span style="color: #000080;">!</span>tmpdata_a;</pre>
<p><b>Note</b>: 
</p>
<ul><li> セル範囲は、1つのセル、行または列(の一部)、セルグループ、非連続な複数のセルの選択ができます。 </li>
<li> ワークシート、行列シート、グラフレイヤは、それぞれ、名前またはインデックスで参照することができます。</li>
<li> <a href="../../LabTalk/LabTalk/Range_Notation.html#Range_Variable" title="LabTalk:範囲表記">range変数</a> を定義して、<a href="../../LabTalk/Category/Origin_Objects.html" title="カテゴリ:Originオブジェクト">originオブジェクト</a>を表したり、直接、<a href="../../LabTalk/LabTalk/Range_Notation.html#Range_as_X-Function_Arguments" title="LabTalk:範囲表記">Xファンクションの引数</a>としてrangeを使用することができます。 </li>
<li> <b>rangeデータ型</b>および<b>range 変数</b>の詳細については、<a href="../../LabTalk/LabTalk/Range_Notation.html" title="LabTalk:範囲表記">範囲表記</a>を参照してください。</li></ul>
<h3><a name="Tree"></a><span class="mw-headline">Tree</span></h3>
<p>LabTalkは、標準的な<span class="OIndex">treeデータ型</span>をサポートしており、これは枝(ブランチ)と葉(リーフ)を持つ木(ツリー)のような構造です。  ブランチは複数のリーフを含み、それぞれのリーフにはデータが含まれます。  ブランチとリーフを合わせたものノードと呼びます。
</p>
<dl><dd><b>リーフ</b>: 子ノードを持たないノード。値を含むことができます。</dd>
<dd><b>ブランチ</b>: 子ノードを持つノード。値は含みません。</dd></dl>
<p>リーフノードは<b>数値</b>、<b>文字列</b>、<b>データセット</b>(vector) 型を変数をもつことができます。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 空のツリーを宣言</span>
tree report;        
<span style="color: #008000;">// 割り当ての際にツリーノードが自動で追加</span>
<span style="color: #008000;">//レポート2には2つのブランチがあり、各ブランチには2つのリーフがある</span>
report.<span style="color: #000080;">user</span>.<span style="color: #000080;">name</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;dog&quot;</span>; <span style="color: #008000;">//文字列</span>
report.<span style="color: #000080;">user</span>.<span style="color: #000080;">age</span><span style="color: #000080;">=</span><span style="color: #0000dd;">22</span>; <span style="color: #008000;">// 数値</span>
report.<span style="color: #000080;">test</span>.<span style="color: #000080;">name</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;sensor&quot;</span>;
report.<span style="color: #000080;">test</span>.<span style="color: #000080;">temp</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">32.0</span>;

report.<span style="color: #000080;">=</span>; <span style="color: #008000;">//ツリーの内容を出力</span>

<span style="color: #008000;">// 新しいツリー&apos;newReport&apos;を宣言し&apos;report&rsquo;ツリーからのデータを割り当て</span>
tree newReport <span style="color: #000080;">=</span> report; 
newReport.<span style="color: #000080;">user</span>.<span style="color: #000080;">name</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>;
newReport.<span style="color: #000080;">test</span>.<span style="color: #000080;">temp</span><span style="color: #000080;">=</span>;</pre>
<p><br />
ツリーまたはブランチ、リーフがあるかチェック
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//上述のスクリプト後に実行。あれば24を返す。そうでない場合は0を返す</span>
exist<span style="color: #000000;">(</span>report<span style="color: #000000;">)</span><span style="color: #000080;">=</span>; <span style="color: #008000;">//24を返す</span>
exist<span style="color: #000000;">(</span>report.<span style="color: #000080;">user</span>.<span style="color: #000080;">name</span><span style="color: #000000;">)</span><span style="color: #000080;">=</span>; <span style="color: #008000;">//24を返す</span>
exist<span style="color: #000000;">(</span>report.<span style="color: #000080;">test</span>.<span style="color: #000080;">temp</span><span style="color: #000000;">)</span><span style="color: #000080;">=</span>; <span style="color: #000080;">/</span>returns <span style="color: #0000dd;">24</span>
exist<span style="color: #000000;">(</span>report.<span style="color: #000080;">test</span>.<span style="color: #000080;">x</span><span style="color: #000000;">)</span><span style="color: #000080;">=</span>; <span style="color: #008000;">// 0を返す</span></pre>
<p><br />
ブランチまたはリーフかチェック
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//ブランチは2、リーフは1、無効な場合0を返す</span>
report@<span style="color: #000080;">=</span> <span style="color: #008000;">//ブランチの場合2を返す</span>
report.<span style="color: #000080;">user</span>@<span style="color: #000080;">=</span>;   <span style="color: #008000;">// 2を返す、ブランチ</span>
report.<span style="color: #000080;">user</span>.<span style="color: #000080;">name</span>@<span style="color: #000080;">=</span>; <span style="color: #008000;">// 1を返す、リーフ</span>
report.<span style="color: #000080;">test</span>.<span style="color: #000080;">temp</span>@<span style="color: #000080;">=</span>; <span style="color: #008000;">// 1を返す、リーフ</span>
report.<span style="color: #000080;">test</span>.<span style="color: #000080;">speed</span>@<span style="color: #000080;">=</span>;<span style="color: #008000;">/// 0を返す、無効</span></pre>
<p><br />
ツリーは、Originでパラメータに関連するセットを設定および保存するためによく使用されます。ツリーデータ型は、入力または出力に関係なく、Xファンクションのツリー型引数でよく使用されます。 
</p><p>例えば、Xファンクション<b>impasc</b>を使用してOriginにデータをインポートする場合、ツリー型の引数<a class="external text" href="../../XFunction/X-Function/Details_of_TreeNodes_in_Import_ASCII.html"><b>options</b></a>がインポートをどう実行するか決定するパラメータを保持します。これは<b>options</b>ツリーが入力引数です。
</p>
<pre class="lt" style="font-family:monospace;">string str<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Graphing\Group.dat&quot;</span>; 
impasc fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>str<span style="color: #000080;">$</span>
<span style="color: #008000; font-style: regular;">/* 新しいシートで開始 */</span> 
options.<span style="color: #000080;">ImpMode</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span> 
<span style="color: #008000; font-style: regular;">/* 最初の3列をインポート */</span>
options.<span style="color: #000080;">Cols</span>.<span style="color: #000080;">NumCols</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span>;</pre>
<p><br />
Xファンクション<b>impinfo</b>にはツリー型の出力引数<b>trInfo</b>があります。
データをワークシートにインポートした後、次のスクリプトはファイル情報をツリー変数「fileInfo」に入力します。
</p>
<pre class="lt" style="font-family:monospace;">impinfo trInfo<span style="color: #000000;">:</span><span style="color: #000080;">=</span>fileInfo; 
fileInfo.<span style="color: #000080;">=</span> <span style="color: #008000;">//ツリーの全ての内容を出力</span></pre>
<p><br />
ツリーノードは文字列を数値を指定できます。次の例では、文字列データと数値データを含むツリーノードをワークシート列にコピーする方法を示しています。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//ワークシートにデータファイルをインポート</span>
newbook;
string fn<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;\samples\statistics\automobile.dat&quot;</span>; 
impasc fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>fn<span style="color: #000080;">$</span>;
tree tr;
<span style="color: #008000;">//2列目で離散周波数カウントを実行し結果をtrに保存</span>
discfreqs irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span> rd<span style="color: #000000;">:</span><span style="color: #000080;">=</span>tr;
newsheet name<span style="color: #000000;">:</span><span style="color: #000080;">=</span>Result; <span style="color: #008000;">//新しいワークシート&apos;Result&apos;を追加</span>
col<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span> <span style="color: #000080;">=</span> tr.<span style="color: #000080;">freqcount1</span>.<span style="color: #000080;">data1</span>; <span style="color: #008000;">// 第一列に &apos;data1&apos; リーフ (すべて文字列) を配置</span>
col<span style="color: #000000;">(</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span> <span style="color: #000080;">=</span> tr.<span style="color: #000080;">freqcount1</span>.<span style="color: #000080;">count1</span>; <span style="color: #008000;">//2番目の列に &apos;count1&apos; リーフ (数値) を配置</span></pre>
<p>ツリーノードはベクトルにすることもできます。<b>Origin 8.1 SR1</b>より前のバージョンでは、以下のコード例のように直接代入を行う方法が、ツリー変数内のベクトルにアクセスする唯一の方法でした。
</p>
<pre class="lt" style="font-family:monospace;">tree tr;
<span style="color: #008000;">// データセットをツリーノードに代入すると</span>
<span style="color: #008000;">// 自動的にベクターノードになる</span>
tr.<span style="color: #000080;">a</span><span style="color: #000080;">=</span>data<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">10</span><span style="color: #000000;">)</span>; 
<span style="color: #008000;">// ベクターツリーノードは列に割り当てできる</span>
col<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span><span style="color: #000080;">=</span>tr.<span style="color: #000080;">a</span>; 
<span style="color: #008000;">// ベクターツリーノードは非接続データセットに代入でき、</span>
<span style="color: #008000;">// これは、ツリーノードが直接計算するのに使えないので、便利</span>
dataset temp<span style="color: #000080;">=</span>tr.<span style="color: #000080;">a</span>;
<span style="color: #008000;">// 非接続データセットで計算を実行</span>
col<span style="color: #000000;">(</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span><span style="color: #000080;">=</span>temp<span style="color: #000080;">*</span><span style="color: #0000dd;">2</span>;</pre>
<p><br />
ベクターツリーノードの要素には、次のような記述で直接アクセスできます。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 上記のサンプルに続く操作</span>
col<span style="color: #000000;">(</span><span style="color: #0000dd;">3</span><span style="color: #000000;">)</span><span style="color: #000000;">[</span><span style="color: #0000dd;">1</span><span style="color: #000000;">]</span> <span style="color: #000080;">=</span> tr.<span style="color: #000080;">a</span><span style="color: #000000;">[</span><span style="color: #0000dd;">3</span><span style="color: #000000;">]</span>;</pre>
<p>これは、ベクター <b>tr.a</b> の3番目の要素を現在のワークシートの1行3列目に代入します。
</p><p>また、下記のように分析結果をツリー変数に出力することもできます。
</p>
<pre class="lt" style="font-family:monospace;">newbook;
<span style="color: #008000;">//データファイルをワークシートにインポート</span>
string fn<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;\samples\Signal Processing\fftfilter1.dat&quot;</span>; 
impasc fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>fn<span style="color: #000080;">$</span>;
tree mytr;
<span style="color: #008000;">//FFTを実行して結果をツリー変数に保存</span>
fft1 ix<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">(</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span> rd<span style="color: #000000;">:</span><span style="color: #000080;">=</span>mytr;
page.<span style="color: #000080;">active</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
col<span style="color: #000000;">(</span><span style="color: #0000dd;">3</span><span style="color: #000000;">)</span> <span style="color: #000080;">=</span> mytr.<span style="color: #000080;">fft</span>.<span style="color: #000080;">real</span>;
col<span style="color: #000000;">(</span><span style="color: #0000dd;">4</span><span style="color: #000000;">)</span> <span style="color: #000080;">=</span> mytr.<span style="color: #000080;">fft</span>.<span style="color: #000080;">imag</span>;</pre>
<p>ツリーに関する詳細はOriginプロジェクトの章、<a href="../../LabTalk/Script/Accessing_Metadata.html#Trees" title="スクリプト：メタデータにアクセスする"><b>メタデータにアクセスする</b></a>セクションをご覧ください。
</p>
<h3><a name="Graphic_Objects"></a><span class="mw-headline">グラフィックオブジェクト</span></h3>
<p>新しいLabTalkの変数型を使うと、ブック/レイヤ内の<span class="OIndex">グラフィックオブジェクト</span>をGObjectで制御できます。
</p><p>一般的なシンタックスは：
</p><p><font color="navy"><b>GObject <i>name</i> = [<i>GraphPageName</i>]<i>LayerIndex</i>!<i>ObjectName</i>;</b></font>
</p><p><font color="navy"><b>GObject <i>name</i> = [<i>GraphPageName</i>]<i>LayerName</i>!<i>ObjectName</i>;</b></font>
</p><p><font color="navy"><b>GObject <i>name</i> = <i>LayerName</i>!<i>ObjectName</i>;</b></font> // アクティブグラフ 
</p><p><font color="navy"><b>GObject <i>name</i> = <i>LayerIndex</i>!<i>ObjectName</i>;</b></font> // アクティブグラフ 
</p><p><font color="navy"><b>GObject <i>name</i> = <i>ObjectName</i>;</b></font> // アクティブレイヤ 
</p><p>既存のオブジェクトとまだ作成されていないオブジェクトの両方に対してGObject 変数を宣言できます。
</p><p>例えば、
</p>
<pre class="lt" style="font-family:monospace;">GObject myLine <span style="color: #000080;">=</span> line1;
draw <span style="color: #000080;">-</span>n myLine <span style="color: #000080;">-</span>l <span style="color: #000000;">{</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">3</span>,<span style="color: #0000dd;">4</span><span style="color: #000000;">}</span>;
win <span style="color: #000080;">-</span>t plot;
myLine.<span style="color: #000080;">X</span><span style="color: #000080;">+</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>; 
<span style="color: #008000; font-style: regular;">/* myLineが、アクティブでない別のグラフにあったとしても、それを制御することは可能*/</span></pre>
<p>グラフィックオブジェクトとそのプロパティおよびメソッドについての説明は、<a href="../../LabTalk/LabTalk/Graphic_Objects.html" title="LabTalk:グラフィックオブジェクト">グラフィックオブジェクト</a>をご覧下さい。
</p>
<h2><a name="Variables"></a><span class="mw-headline">変数</span></h2>
<p><span class="OIndex">変数</span>は、単に特定のデータ型のインスタンスです。  各変数には、名前または識別子があり、識別子は変数にデータを割り当てたり、変数からデータにアクセスするのに使われます。   この代入演算子は等号 (=)で、同時に変数を作成(存在しない場合)して、それに値を割り当てるのに使われます。
</p>
<h3><a name="Variable_Naming_RulesVariable_Naming_Rule"></a><span class="mw-headline">変数の命名規則<span class="OIndex" style="display:none">Variable Naming Rule</span></span></h3>
<p>変数、データセット、コマンド、マクロ名は、識別子として一般に参照されます。   LabTalkで識別子を割り当てるとき
</p>
<ul><li> 文字と数値のどの組合せでも使えますが、以下の注意が必要です。
<ul><li> 識別子は25文字以上にすることはできません。</li>
<li> 最初の文字を数字にすることはできません。 </li>
<li> アンダスコア &quot;_&quot; はデータセット名で特別な意味を持ちますので、使用を避けて下さい。</li></ul></li></ul>
<ul><li> <a href="../../LabTalk/LabTalk/Exist_(function).html" title="LabTalk:Exist (関数)"><b>Exist</b> (関数)</a> を使うと、識別子がウィンドウ、マクロ、ツール、データセット、変数に名前を付けるのに使われているかどうかをチェックすることができます。 </li></ul>
<ul><li> いくつかの一般的な識別子がシステム利用としてOriginに予約されています。これについては、<a href="../../LabTalk/LabTalk/System_Variables.html" title="LabTalk:システム変数">システム変数</a>をご覧下さい。</li></ul>
<ul><li> <a class="external text" href="../../UserGuide/UserGuide/Quick_Start_SetColumnValues.html#Column_Formula_Examples">列値の計算</a>で列のショートネームとの競合を避けるため、変数名として少なくとも4文字使用して割り当てることをお勧めします。</li></ul>
<h3><a name="Handling_Variable_Name_ConflictsVariable_Name_Conflict"></a><span class="mw-headline">変数名の競合の取り扱い<span class="OIndex" style="display:none">Variable Name Conflict</span></span></h3>
<p>システム変数<b>@ppv</b> は、プロジェクト変数、セッション変数、ローカル変数の名前の競合をOriginがどう扱うかを際魚します。  他のすべてのシステム変数と同様に<b>@ppv</b>は、スクリプトからいつでも変更でき、直ちに反映されます。  
</p>
<table class="simple">
<tr>
<th> <b>変数</b>
</th>
<th> <b>説明</b>
</th></tr>
<tr>
<td> @ppv=0
</td>
<td> これはデフォルトのオプションで、セッション変数とローカル変数の両方ともが既存のプロジェクト変数の名前を使うことができます。   競合のイベントがでは、セッション変数またはローカル変数が使われます。
</td></tr>
<tr>
<td> @ppv=1
</td>
<td> このオプションは、既存のプロジェクト変数と同じ名前を持つセッション変数を宣言することを不正とします。   新しいプロジェクトをロードするとき、競合した名前を持つセッション変数は、プロジェクトが閉じられるか、同じ名前を持つプロジェクト変数が削除されるまで、無効になります。
</td></tr>
<tr>
<td> @ppv=2
</td>
<td> このオプションは、既存のプロジェクト変数と同じ名前を持つローカル変数を宣言することを不正とします。  新しいプロジェクトをロードするとき、競合した名前を持つローカル変数は、プロジェクトが閉じられるか、同じ名前を持つプロジェクト変数が削除されるまで、無効になります。
</td></tr>
<tr>
<td> @ppv=3
</td>
<td> これは@ppv=1 と @ppv=2の組合せです。この場合、すべてのセッション変数とローカル変数は、プロジェクト変数の名前を使うことができません。新しいプロジェクトがロードされる場合、同じ名前の既存のセッションまたはローカル変数は無効になります。
</td></tr></table>
<h3><a name="Listing_and_Deleting_VariablesList_VariablesDelete_Variable"></a><span class="mw-headline">変数の一覧表示と削除<span class="OIndex" style="display:none">List Variables</span><span class="OIndex" style="display:none">Delete Variable</span></span></h3>
<p>LabTalkコマンドの<b>list</b> と<b>del</b> を使って、変数を一覧表示したり、変数を削除します。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000; font-style: regular;">/* LabTalkコマンドの&quot;list&quot;には変数を表示するさまざまなオプションがあります。
リストはデフォルトでスクリプトに出力されます。 */</span>
&nbsp;
list a;       <span style="color: #008000;">// 全てのセッション変数を表示</span>
list v;       <span style="color: #008000;">// 全てのプロジェクトおよびセッションの変数を表示</span>
list vs;      <span style="color: #008000;">// 全てのプロジェクトおよびセッションの文字列変数を表示</span>
list vt;      <span style="color: #008000;">// 全てのプロジェクトおよびセッションのツリー変数をリスト</span>
&nbsp;
<span style="color: #008000;">// LabTalk コマンド &quot;del&quot; を使用し、全ての変数を削除</span>
&nbsp;
del <span style="color: #000080;">-</span>al <span style="color: #000080;">&lt;</span>variableName<span style="color: #000080;">&gt;</span>;  <span style="color: #008000;">// 特定のローカルまたはセッション変数を削除</span>
del <span style="color: #000080;">-</span>al <span style="color: #000080;">*</span>;               <span style="color: #008000;">// 全てのローカルまたはセッション変数を削除</span>
&nbsp;
<span style="color: #008000;">// LabTalk変数のビューアもある</span>
<span style="color: #008000;">// &quot;ed&quot; コマンドはビューアを開く</span>
list;                     <span style="color: #008000;">// LabTalk 変数ビューアを開く</span></pre>
<p>一覧表示および削除のすべてのオプションについては(言語リファレンス：コマンドリファレンス)の<a href="../../LabTalk/LabTalk/List_(command).html" title="LabTalk:List (コマンド)"><b> List</b> (コマンド)</a>および <a href="../../LabTalk/LabTalk/Delete_(command).html" title="LabTalk:Delete (コマンド)"><b>Del</b> (コマンド)</a> をご覧ください。
</p><p>オプションが指定されていない場合、<a href="../../LabTalk/LabTalk/List_(command).html" title="LabTalk:List (コマンド)">List</a> または <a href="../../LabTalk/LabTalk/Edit_(command).html" title="LabTalk:Edit (コマンド)">Edit</a> コマンドを実行するとLabTalkの変数と関数ダイアログが開き、すべての変数および関数を一覧表示します。
</p>
<h2><a name="Scope_of_Variables"></a><span class="mw-headline">変数のスコープ</span></h2>
<p>変数が宣言される方法により、そのスコープが決まります。  宣言無しで作成された変数 (<b>double</b>,<b> string</b>, <b>dataset</b> のみ)は、プロジェクト変数になり、Originのプロジェクトファイルとともに保存されます。  宣言された変数は、ローカルまたはセッション変数になります。  LabTalkのスコープは、3つの可視のレベルで構成されます。 
</p>
<ul><li> <a href="#Project_Variables">プロジェクト変数</a></li>
<li> <a href="#Session_Variablesscope.2C_session">セッション変数</a></li>
<li> <a href="#Local_Variablesscope.2C_local">ローカル変数</a></li></ul>
<p><br />
これは、（a）同じ名前の複数の変数を持つことができ、（b）その場合、任意の時点で返される値は現在のスコープに依存することを意味します（以下のセッション変数とローカル変数を参照） 。
</p>
<h3><a name="Project_Variables"></a><span class="mw-headline">プロジェクト変数</span></h3>
<ul><li> <span class="OIndex">プロジェクト変数</span><span class="OIndex" style="display:none">variable, project</span> はOriginプロジェクトファイル(*.OPJ/OPJU)と一緒に保存されます。  プロジェクト変数は、<span class="OIndex">プロジェクトスコープ</span>を持つと言われます。 </li>
<li> プロジェクト変数は、<b>double</b>, <b>string</b>, <b>dataset</b> の変数型に対して宣言無しで自動的に作成されます。</li></ul>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// double型のプロジェクト(プロジェクトスコープ)変数を定義:</span>
myvar <span style="color: #000080;">=</span> <span style="color: #0000dd;">3.5</span>;
<span style="color: #008000;">// 非接続データセット(プロジェクトスコープ)を定義:</span>
temp <span style="color: #000080;">=</span> <span style="color: #000000;">{</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">3</span>,<span style="color: #0000dd;">4</span>,<span style="color: #0000dd;">5</span><span style="color: #000000;">}</span>;
<span style="color: #008000;">// string型のプロジェクト(プロジェクトスコープ)変数を定義:    </span>
str<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Hello&quot;</span>;</pre>
<ul><li> 他のすべての変数型は宣言する必要があり、そのデフォルトのスコープをセッションまたはローカルにします。   <a href="#Making_Local_Variables_and_Functions_Available_in_the_Session_scope.2C_forcing_change_of"><b>@glob</b>システム変数を使って</a>ローカル変数を強制的にセッション変数として利用可能にできます(下記参照)。</li></ul>
<h3><a name="Session_Variablesscope.2C_session"></a><span class="mw-headline">セッション変数<span class="OIndex" style="display:none">scope, session</span></span></h3>
<ul><li> <span class="OIndex">セッション変数</span><span class="OIndex" style="display:none">variable, session</span> はOriginプロジェクトと一緒に保存されず、プロジェクトを切り替えても、現在のOriginセッションで利用できます。つまり、一度セッション変数が定義されると、その変数は、Originアプリケーションが終了するか、変数を削除するまで、存在します。セッション変数は、次のように変数宣言で定義されます。 </li></ul>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// double型の変数を定義</span>
double var1 <span style="color: #000080;">=</span> <span style="color: #0000dd;">4.5</span>; 
<span style="color: #008000;">// 非接続データセットを定義            </span>
dataset mytemp <span style="color: #000080;">=</span> <span style="color: #000000;">{</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">3</span>,<span style="color: #0000dd;">4</span>,<span style="color: #0000dd;">5</span><span style="color: #000000;">}</span>;</pre>
<p>プロジェクト変数とセッション変数を同じ名前にすることができます。この場合、セッション変数が優先されます。
</p>
<pre class="lt" style="font-family:monospace;">aa <span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span>;
type <span style="color: #ff00ff;">&quot;First, aa is a project variable equal to $(aa)&quot;</span>;
double aa <span style="color: #000080;">=</span> <span style="color: #0000dd;">20</span>;
type <span style="color: #ff00ff;">&quot;Then aa is a session variable equal to $(aa)&quot;</span>;
del <span style="color: #000080;">-</span>al aa;
type <span style="color: #ff00ff;">&quot;Now aa is project variable equal to $(aa)&quot;</span>;</pre>
<p>出力は、
</p>
<pre class="lt" style="font-family:monospace;">First, aa is a project variable equal to <span style="color: #0000dd;">10</span>
Then aa is a session variable equal to <span style="color: #0000dd;">20</span>
Now aa is project variable equal to <span style="color: #0000dd;">10</span></pre>
<h3><a name="Local_Variablesscope.2C_local"></a><span class="mw-headline">ローカル変数<span class="OIndex" style="display:none">scope, local</span></span></h3>
<p><span class="OIndex">ローカル変数</span><span class="OIndex HasShownIndex" style="display:none">variable, local</span> は、特定のスクリプトの現在のスコープ内でのみ存在します。
</p><p>次のようなスクリプトに対してスクリプトレベルのスコープが存在します。
</p>
<ul><li> 波括弧 {} で囲まれている</li>
<li> 別の <a href="../../LabTalk/Script/From_Files.html" title="Script:ファイルから">*.OGS</a> ファイルまたはOGSファイル内の個々のセクション</li>
<li> 列/行列値の設定ダイアログの内部</li>
<li> カスタムボタン（ボタンボタンスクリプト）</li></ul>
<p>ローカル変数が宣言されると、セッション変数と同じ方法で値を割り当てます。 
</p>
<pre class="lt" style="font-family:monospace;">loop<span style="color: #000000;">(</span>i,<span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">10</span><span style="color: #000000;">)</span><span style="color: #000000;">{</span>
     double a <span style="color: #000080;">=</span> <span style="color: #0000dd;">3.5</span>;
     const e <span style="color: #000080;">=</span> <span style="color: #0000dd;">2.718</span>;
     <span style="color: #008000;">// 他のスクリプト行</span>
<span style="color: #000000;">}</span>
<span style="color: #008000;">//&quot;a&quot; および &quot;e&quot; は、{}で囲まれたコードの内部にだけ存在する</span></pre>
<p>セッション変数またはプロジェクト変数と同じ名前を持つローカル変数を持つことが可能です。  この場合、スクリプトのスコープ内で、同じ名前のローカル変数、セッション変数、プロジェクト変数が存在する場合、ローカル変数が優先されます。例えば、以下のスクリプトを実行する場合（以下のようなスクリプトの実行について詳細は、<a href="../../LabTalk/Script/From_Files.html" title="Script:ファイルから">LabTalkスクリプトをファイルから実行</a>を参照してください）
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">[</span>Main<span style="color: #000000;">]</span>
double aa <span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span>;
type <span style="color: #ff00ff;">&quot;In the main section, aa equals $(aa)&quot;</span>;
run.<span style="color: #000080;">section</span><span style="color: #000000;">(</span>, section1<span style="color: #000000;">)</span>;
run.<span style="color: #000080;">section</span><span style="color: #000000;">(</span>, section2<span style="color: #000000;">)</span>;

<span style="color: #000000;">[</span>section1<span style="color: #000000;">]</span>
double aa <span style="color: #000080;">=</span> <span style="color: #0000dd;">20</span>;
type <span style="color: #ff00ff;">&quot;In section1, aa equals $(aa)&quot;</span>;

<span style="color: #000000;">[</span>section2<span style="color: #000000;">]</span>
<span style="color: #008000;">// このセクションはローカル変数&apos;aa&apos;を宣言しない</span>
<span style="color: #008000;">// 次の順序で&apos;aa&apos;という名前の変数を検索</span>
<span style="color: #008000;">// &apos;aa&apos;という名前のセッション変数が存在する場合、それを使用</span>
<span style="color: #008000;">// そうでない場合、&apos;aa&apos; という名前のプロジェクト変数が存在する場合は、それが使用されます。</span>
<span style="color: #008000;">//それ以外の場合、このセクションが別のセクションおよび呼び出し元から呼び出されたとき</span>
<span style="color: #008000;">//セクションは &apos;aa&apos; という名前のローカル変数を宣言し、それを使用</span>
<span style="color: #008000;">// それ以外の場合、&apos;aa&apos; は欠損値になります。</span>
type <span style="color: #ff00ff;">&quot;In section2, aa equals $(aa)&quot;</span>;</pre>
<p>Originは次のように出力します。
</p>
<pre class="lt" style="font-family:monospace;">In the main section, aa equals <span style="color: #0000dd;">10</span>
In section1, aa equals <span style="color: #0000dd;">20</span>
In section2, aa equals <span style="color: #0000dd;">10</span></pre>
<h3><a name="Making_Local_Variables_and_Functions_Available_in_the_Session_scope.2C_forcing_change_of"></a><span class="mw-headline">ローカル変数と関数をセッション内で使用<span class="OIndex" style="display:none">scope, forcing change of</span></span></h3>
<p><a href="../../LabTalk/Script/From_Files.html" title="Script:ファイルから">*.OGS</a> ファイルで変数または関数を定義したい場合、スクリプトウィンドウやテキストラベルなどからそれらを使用できる場合があります。(通常、ローカル変数や関数はOGS完了まで実行されたときに存在しなくなります)。このようにするには、<b>@glob</b>システム変数を<b>1</b>にします（デフォルト値は<b>0</b>）。これにより、OGSファイルのローカル変数と関数をセッション内で使用できます。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">[</span>Main<span style="color: #000000;">]</span>
@glob <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
<span style="color: #008000;">// 以下の宣言がセッションで利用可能になります</span>
range a <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>, b<span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
if<span style="color: #000000;">(</span>a<span style="color: #000000;">[</span><span style="color: #0000dd;">2</span><span style="color: #000000;">]</span> <span style="color: #000080;">&gt;</span> <span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span> 
  <span style="color: #008000;">// ローカルスコープ開始</span>
  range c <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>; <span style="color: #008000;">// この宣言はセッション内で利用可能</span>
<span style="color: #000000;">}</span></pre>
<p>*.OGSを終了すると、<b>@glob</b> 変数は自動的にそのデフォルト値である <b>0</b>に戻ります。
</p><p>@globを次のように開始位置と終了位置に配置して、コードブロックを制御できます。
</p>
<pre class="lt" style="font-family:monospace;">@glob<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
double alpha<span style="color: #000080;">=</span><span style="color: #0000dd;">1.2</span>;
double beta<span style="color: #000080;">=</span><span style="color: #0000dd;">2.3</span>;
Function double myPeak<span style="color: #000000;">(</span>double x, double x0<span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
   double y <span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span><span style="color: #000080;">*</span>exp<span style="color: #000000;">(</span><span style="color: #000080;">-</span><span style="color: #000000;">(</span>x<span style="color: #000080;">-</span>x0<span style="color: #000000;">)</span><span style="color: #000080;">^</span><span style="color: #0000dd;">2</span><span style="color: #000080;">/</span><span style="color: #0000dd;">4</span><span style="color: #000000;">)</span>;
   return y;
<span style="color: #000000;">}</span>
@glob<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;
double gamma<span style="color: #000080;">=</span><span style="color: #0000dd;">3.45</span>;</pre>
<p>上記のスクリプトでは、変数alpha、beta、およびユーザー定義関数myPeakをセッション内で使用できます。一方、変数gammaは、@glob がデフォルト値である0に戻ってから宣言されたため、利用できません。
</p>
<h3><a name="Summary_Table:_Scope_of_Variables"></a><span class="mw-headline">要約表:変数のスコープ</span></h3>
<table class="simple">
<tr>
<th>
</th>
<th width="10%">データ型
</th>
<th width="10%">宣言
</th>
<th width="20%">定義される場所
</th>
<th width="20%">サンプル
</th>
<th width="20%">有効な期間
</th></tr>
<tr>
<th> 定数
</th>
<td> constant
</td>
<td> する (const)
</td>
<td>
<ul><li>スクリプトウィンドウ</li>
<li>コマンドウィンドウ</li>
<li>OGSファイル</li>
<li>様々なGUIダイアログ</li></ul>
</td>
<td> const av = 6.022×10<sup>23</sup>;
</td>
<td> Originが起動している間有効。すべての定数はorgvar.ogsに保存されます。
</td></tr>
<tr>
<th> プロジェクト変数
</th>
<td> double, <br />string, <br />dataset
</td>
<td> しない
</td>
<td>
<ul><li>スクリプトウィンドウ</li>
<li>コマンドウィンドウ</li>
<li>OGSファイル</li>
<li>様々なGUIダイアログ</li></ul>
</td>
<td> av = 6.022×10<sup>23</sup>;
</td>
<td> OPJが開いている間有効。<br />OPJとともに保存。
</td></tr>
<tr>
<th> セッション変数
</th>
<td> 全てのタイプ
</td>
<td> する
</td>
<td>
<ul><li>スクリプトウィンドウ</li>
<li>コマンドウィンドウ</li></ul>
</td>
<td> double av = 6.022×10<sup>23</sup>;
</td>
<td> セッションの間有効。<br />OPJとともに保存不可。
</td></tr>
<tr>
<th> ローカル変数
</th>
<td> 全てのタイプ
</td>
<td> する
</td>
<td>
<ul><li> OGSファイル</li>
<li> 様々なGUIダイアログ</li></ul>
</td>
<td> double av = 6.022×10<sup>23</sup>;
</td>
<td> スクリプトが実行されている間有効。
</td></tr>
<tr>
<th> セッション変数<br />としての<br />ローカル変数
</th>
<td> 全てのタイプ
</td>
<td> する
</td>
<td>
<ul><li> OGSファイル</li>
<li> 様々なGUIダイアログ</li></ul>
</td>
<td> <b>@glob=1</b>; <br />double av = 6.022×10<sup>23</sup>;
</td>
<td> セッションの間有効。<br />OPJとともに保存不可（<a href="../../LabTalk/Script/ProjectEvents_Script.html" title="Script:ProjectEvents スクリプト">ProjectEvents.OGS</a>参照）。
</td></tr></table>



    