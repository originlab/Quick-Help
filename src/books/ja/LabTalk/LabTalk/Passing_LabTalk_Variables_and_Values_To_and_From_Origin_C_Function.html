<h1 class="firstheading">変数をOrigin C関数に渡す/受け取る</h1><p class='urlname' style='display: none'>Passing-LT-vars-and-vals-To-and-From-OC-Function</p>
<p><span class="OIndex" style="display:none">Origin C, Pass Variable</span><span class="OIndex" style="display:none">Pass Variable, Origin C</span>どのような関数を呼び出す場合でも、その関数に変数を渡したり、関数が出力する変数を受け取る必要がある場合あります。  以下では、LabTalk変数をOrigin C関数に渡す<a class="external text" href="../../OriginC/OriginC/Calling_Origin_C_Functions_in_Labtalk_Script.html">構文および特徴</a>をまとめています。
</p>
<h2><a name="Sytnax_for_calling_Origin_C_Function_from_LabTalkCalling_Origin_C_Function_from_LabTalk"></a><span class="mw-headline">LabTalkからOrigin C関数を呼び出す構文<span class="OIndex" style="display:none">Calling Origin C Function from LabTalk</span></span></h2>
<p>Origin C関数は次のような構文を使ってLabTalkから呼び出します。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 複数のパラメータがある場合、カンマ(,)でパラメータを分ける</span>
int iret <span style="color: #000080;">=</span> myfunc<span style="color: #000000;">(</span>par1, par2....<span style="color: #000000;">)</span>; 
&nbsp;
<span style="color: #008000;">// 代入がなければ、括弧やカンマは不要</span>
myfunc par1; 
&nbsp;
<span style="color: #008000;">// 次の関数は、値を返さず、パラメータもない。括弧は任意</span>
myfunc;</pre>
<h2><a name="Variable_Types_Supported_for_Passing_To_and_From_LabTalk"></a><span class="mw-headline">LabTalkから渡すまたは受け取る変数のデータ型</span></h2>
<p>次の表は、Origin C関数を呼び出すときのLabTalkから渡されるまたは受け取る<a class="external text" href="../../OriginC/OCGuide/Data_Types_and_Variables.html">Origin C変数型</a>の一覧です。
</p>
<table class="simple">
<tr>
<th> 変数型</th>
<th> OC関数への引数</th>
<th> OC関数からの戻り
</th></tr>
<tr>
<td> double
</td>
<td> 可
</td>
<td> 可
</td></tr>
<tr>
<td> int
</td>
<td> 可
</td>
<td> 可
</td></tr>
<tr>
<td> bool (真または偽)
</td>
<td> 不可。かわりに <b>int</b> を渡す。偽の場合0、真の場合他の整数。
</td>
<td> 不可。かわりに <b>int</b> を返す。偽の場合0、真の場合1。
</td></tr>
<tr>
<td> string
</td>
<td> 可
</td>
<td> 可
</td></tr>
<tr>
<td> int型、double型の配列
</td>
<td> 可
</td>
<td> 可
</td></tr>
<tr>
<td> string array
</td>
<td> 可。参照渡しは不可。
</td>
<td> 可
</td></tr>
<tr>
<td> DataRange
</td>
<td> 可。ただし、列レベルの範囲のみ。他の範囲は文字列で渡す
</td>
<td> 不可
</td></tr>
<tr>
<td> Tree
</td>
<td> 可
</td>
<td> 可
</td></tr>
</table>
<p><b>Note:</b>
</p>
<ol><li> Origin C関数がLabTalk から呼び出せる引数の最大数は80です。 </li>
<li> LabTalk変数は、参照によってOrigin C数値関数に渡すことができます。</li></ol>







    