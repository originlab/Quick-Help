<h1 class="firstheading">グラフのフォーマット</h1>
<p class="urlname" style="display: none;">Formatting-Graphs</p>
<div id="toc" class="toc">
<div id="toctitle">
<h2>内容</h2>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Graph_Window"><span class="tocnumber">1</span> <span class="toctext">グラフウィンドウ</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Page_Properties"><span class="tocnumber">2</span> <span class="toctext">ページのプロパティ</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Layer_Properties"><span class="tocnumber">3</span> <span class="toctext">レイヤのプロパティ</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Fill_the_Layer_Background_Color"><span class="tocnumber">3.1</span> <span class="toctext">レイヤの背景色を塗る</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Set_Speed_Mode_Properties"><span class="tocnumber">3.2</span> <span class="toctext">スピードモードのプロパティをセット</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Update_the_Legend"><span class="tocnumber">3.3</span> <span class="toctext">凡例を更新する</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-7"><a href="#Axis_PropertiesAxis_Property"><span class="tocnumber">4</span> <span class="toctext">軸のプロパティ</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Data_Plot_Properties"><span class="tocnumber">5</span> <span class="toctext">データプロットのプロパティ</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Legend_and_Label"><span class="tocnumber">6</span> <span class="toctext">凡例とラベル</span></a></li>
</ul>
</div>
<h2><a name="Graph_Window" id="Graph_Window"></a><span class="mw-headline">グラフウィンドウ</span></h2>
<p><span class="OIndex">グラフ</span>ウィンドウは、<a href="../../LabTalk/LabTalk/Page_(object).html" title="LabTalk:Page(オブジェクト)"><b>Page</b> (オブジェクト)</a>に結びついたビジュアルページで構成されます。 各々のグラフページは、<a href="../../LabTalk/LabTalk/Layer_(object).html" title="LabTalk:Layer (オブジェクト)"><b>layer</b> オブジェクト</a>と関連づけられる、少なくとも1つのビジュアルページを含んでいます。 グラフレイヤには、<b>layer</b>オブジェクトのサブオブジェクトである <b><a href="../../LabTalk/LabTalk/Layer.Axis_(object).html" title="LabTalk:Layer.Axis (オブジェクト)">layer.x</a></b> および <b><a href="../../LabTalk/LabTalk/Layer.Axis_(object).html" title="LabTalk:Layer.Axis (オブジェクト)">layer.y</a></b> オブジェクトと結びついた1セットのXY軸を含みます。</p>
<table class="noborder">
<tr>
<td style="vertical-align: top;" width="60"><img src="../images/Formatting_Graphs/Tip_icon.png" alt="" width="57" border="0" /></td>
<td>
<p>グラフページまたはグラフレイヤにマッピングされた範囲変数がある場合、<b>page</b> や <b>layer</b>という言葉の変わりに、範囲変数名を使うことができます。</p>
</td>
</tr>
</table>
<h2><a name="Page_Properties" id="Page_Properties"></a><span class="mw-headline">ページプロパティ</span></h2>
<p><b><a href="../../LabTalk/LabTalk/Page_(object).html" title="LabTalk:Page(オブジェクト)">page</a></b> オブジェクトは、アクティブグラフウィンドウのプロパティにアクセスしたり、修正したりできます。 このオブジェクトのすべてのプロパティの一覧を出力するには</p>
<pre class="lt" style="font-family: monospace;">
page.<span style="color: #000080;">=</span>
</pre>
<p>一覧は数値とテキストのプロパティの両方を含みます。 テキスト(文字列)のプロパティ値をセットするとき、プロパティ名の後に<b>$</b> 記号を付けます。</p>
<p>アクティブウィンドウのショートネームを読み込むには</p>
<pre class="lt" style="font-family: monospace;">
page.<span style="color: #000080;">name</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">"Graph3"</span>;
</pre>
<p>アクティブウィンドウのロングネームを読み込むには</p>
<pre class="lt" style="font-family: monospace;">
page.<span style="color: #000080;">longname</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">"This name can contain spaces"</span>;
</pre>
<p><b>page</b> オブジェクトの代わりに範囲変数を使ってグラフのプロパティまたは属性にアクセスすることもできます。 範囲変数を使うことの利点は、目的のグラフがアクティブであるかどうかに関係なく操作できることです。</p>
<p>以下のサンプルは、範囲変数を使って、名前で目的のグラフを指し<span class="OIndex">アクティブグラフレイヤ</span>をレイヤ2にセットします。 宣言されると、範囲変数を <b>page</b>の代わりに使うことができます。</p>
<pre class="lt" style="font-family: monospace;">
<span style="color: #008000;">//グラフを指すRange変数を作成</span>
range rGraph <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>Graph3<span style="color: #000000;">]</span>;<span style="color: #008000;">
//範囲はページオブジェクトのプロパティ</span>
rGraph.<span style="color: #000080;">active</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>;
</pre>
<h2><a name="Layer_Properties" id="Layer_Properties"></a><span class="mw-headline">レイヤのプロパティ</span></h2>
<p><b><a href="../../LabTalk/LabTalk/Layer_(object).html" title="LabTalk:Layer (オブジェクト)">layer</a></b> オブジェクトは、<span class="OIndex">グラフレイヤ</span>のプロパティにアクセスしたり、修正したりできます。</p>
<p>グラフレイヤのサイズをセットするには</p>
<pre class="lt" style="font-family: monospace;">
<span style="color: #008000;">//レイヤ領域の単位を cmにセット</span>
layer.<span style="color: #000080;">unit</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span>;<span style="color: #008000;">
//幅をセット</span>
layer.<span style="color: #000080;">width</span><span style="color: #000080;">=</span><span style="color: #0000dd;">5</span>;<span style="color: #008000;">
//高さをセット </span>
layer.<span style="color: #000080;">height</span><span style="color: #000080;">=</span><span style="color: #0000dd;">5</span>;
</pre>
<h3><a name="Fill_the_Layer_Background_Color" id="Fill_the_Layer_Background_Color"></a><span class="mw-headline">レイヤの背景色を塗る</span></h3>
<p><a class="external text" href="../../XFunction/X-Function/Laycolor.html"><b>laycolor</b></a> Xファンクションはレイヤの背景色を塗りつぶすのに使います。 関数に渡される色指定の値は、作図の詳細で表示されるのと同じOriginの<a href="../../LabTalk/LabTalk/List_of_Colors.html" title="LabTalk:カラーリスト">カラーリスト</a> に対応しています(1=黒, 2=赤, 3=緑など)。</p>
<p>レイヤ1の背景色を緑にするには</p>
<pre class="lt" style="font-family: monospace;">
laycolor layer<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> color<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span>;
</pre>
<h3><a name="Set_Speed_Mode_Properties" id="Set_Speed_Mode_Properties"></a><span class="mw-headline">スピードモードのプロパティをセット</span></h3>
<p><a class="external text" href="../../XFunction/X-Function/Speedmode.html"><b>speedmode</b> Xファンクション</a>は、レイヤの<span class="OIndex">スピードモード</span>のプロパティをセットするのに使います。</p>
<h3><a name="Update_the_Legend" id="Update_the_Legend"></a><span class="mw-headline">凡例を更新</span></h3>
<p><a class="external text" href="../../XFunction/X-Function/Legendupdate.html"><b>legendupdate</b> Xファンクション</a>は、ページ/レイヤにある<span class="OIndex">グラフの凡例</span>を更新したり、再構築するのに使います。</p>
<h2><a name="Axis_PropertiesAxis_Property" id="Axis_PropertiesAxis_Property"></a><span class="mw-headline">軸のプロパティ</span></h2>
<p><b>layer</b>オブジェクトの <b><a href="../../LabTalk/LabTalk/Layer.Axis_(object).html" title="LabTalk:Layer.Axis (オブジェクト)">layer.x</a></b> および <b><a href="../../LabTalk/LabTalk/Layer.Axis_(object).html" title="LabTalk:Layer.Axis (オブジェクト)">layer.y</a></b> サブオブジェクトは、軸のプロパティを修正するのに使うことができます。</p>
<p>アクティブレイヤのXスケールを修正するには</p>
<pre class="lt" style="font-family: monospace;">
<span style="color: #008000;">//スケールをLog10にセット</span>
layer.<span style="color: #000080;">x</span>.<span style="color: #000080;">type</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;<span style="color: #008000;">
//開始値をセット</span>
layer.<span style="color: #000080;">x</span>.<span style="color: #000080;">from</span> <span style="color: #000080;">=</span> .001;<span style="color: #008000;">
//終了値をセット</span>
layer.<span style="color: #000080;">x</span>.<span style="color: #000080;">to</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1000</span>;<span style="color: #008000;">
//増分値をセット</span>
layer.<span style="color: #000080;">x</span>.<span style="color: #000080;">inc</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
</pre>
<table class="noborder">
<tr>
<td style="vertical-align: top;" width="60"><img src="../images/Formatting_Graphs/Tip_icon.png" alt="" width="57" border="0" /></td>
<td>
<p>Yスケールを操作するには、上記スクリプトのxをyに変更するだけです。アクティブでないレイヤを操作するには場合、layer<i>N</i>.x.from.のようにレイヤインデックスを指定します。 サンプルは次の通りです。 layer3.y.from = 0;</p>
</td>
</tr>
</table>
<p><b><a href="../../LabTalk/LabTalk/Axis_(command).html" title="LabTalk:Axis (コマンド)">Axis</a></b> コマンドは、軸ダイアログの設定にアクセスするのに使います。</p>
<p>Book1のSheet1にあるcol(A)に対してcol(B)をcol(C)のテキスト付きでプロットし、 X軸ラベルを列Cの値に変更するには、 次のようにします。</p>
<pre class="lt" style="font-family: monospace;">
range aa <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>Book1<span style="color: #000000;">]</span>Sheet1<span style="color: #000080;">!</span>col<span style="color: #000000;">(</span>C<span style="color: #000000;">)</span>;
axis <span style="color: #000080;">-</span>ps X T aa;
</pre>
<h2><a name="Data_Plot_Properties" id="Data_Plot_Properties"></a><span class="mw-headline">データプロットのプロパティ</span></h2>
<p><a href="../../LabTalk/Category/Set_(command).html" class="new" title="LabTalk:Set (command)"><b>Set</b> (コマンド)</a> は、<span class="OIndex">データプロット</span>の属性を変更するのに使います。次のサンプルは、同じデータプロットのプロパティを数回変更し、 <b><span class="OIndex">Set</span></b> コマンドがどのように動作するのかを示します。スクリプトでは、<span class="OIndex">プロットスタイル</span>を変更する前に、<a href="../../LabTalk/LabTalk/Second_(command).html" title="LabTalk:Second (コマンド)">secコマンド</a>を使って、1秒間停止します。</p>
<pre class="lt" style="font-family: monospace;">
<span style="color: #008000;">// いくつかデータを作成</span>
newbook;
col<span style="color: #000000;">(</span>a<span style="color: #000000;">)</span> <span style="color: #000080;">=</span> <span style="color: #000000;">{</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">5</span><span style="color: #000000;">}</span>;
col<span style="color: #000000;">(</span>b<span style="color: #000000;">)</span> <span style="color: #000080;">=</span> col<span style="color: #000000;">(</span>a<span style="color: #000000;">)</span>;<span style="color: #008000;">
// 散布図を作成</span>
plotxy col<span style="color: #000000;">(</span>b<span style="color: #000000;">)</span>;
 <span style="color: #008000;">
// シンボルサイズをセット</span><span style="color: #008000;">
// %C はアクティブデータセット</span>
sec <span style="color: #000080;">-</span>p <span style="color: #0000dd;">1</span>;
set <span style="color: #000080;">%</span>C <span style="color: #000080;">-</span>z <span style="color: #0000dd;">20</span>;<span style="color: #008000;">
// シンボルの形状をセット</span>
sec <span style="color: #000080;">-</span>p <span style="color: #0000dd;">1</span>;
set <span style="color: #000080;">%</span>C <span style="color: #000080;">-</span>k <span style="color: #0000dd;">3</span>;<span style="color: #008000;">
// シンボルの色をセット</span>
sec <span style="color: #000080;">-</span>p <span style="color: #0000dd;">1</span>;
set <span style="color: #000080;">%</span>C <span style="color: #000080;">-</span>c color<span style="color: #000000;">(</span>blue<span style="color: #000000;">)</span>;<span style="color: #008000;">
// シンボルを接続</span>
sec <span style="color: #000080;">-</span>p <span style="color: #0000dd;">1</span>;
set <span style="color: #000080;">%</span>C <span style="color: #000080;">-</span>l <span style="color: #0000dd;">1</span>;<span style="color: #008000;">
// グラフ線の色を変更</span>
sec <span style="color: #000080;">-</span>p <span style="color: #0000dd;">1</span>;
set <span style="color: #000080;">%</span>C <span style="color: #000080;">-</span>cl color<span style="color: #000000;">(</span>red<span style="color: #000000;">)</span>;<span style="color: #008000;">
// 線の太さを4ポイントにセット</span>
sec <span style="color: #000080;">-</span>p <span style="color: #0000dd;">1</span>;
set <span style="color: #000080;">%</span>C <span style="color: #000080;">-</span>w <span style="color: #0000dd;">2000</span>;<span style="color: #008000;">
// 実線を破線に変更</span>
sec <span style="color: #000080;">-</span>p <span style="color: #0000dd;">1</span>;
set <span style="color: #000080;">%</span>C <span style="color: #000080;">-</span>d <span style="color: #0000dd;">1</span>;
</pre>
<p>2つのレイヤを持つテンプレート, <i>DoubleY</i>, にプロットし、2番目のレイヤのデータプロットのスタイルをセットする別のサンプルがあります。</p>
<pre class="lt" style="font-family: monospace;">
<span style="color: #008000;">// データをインポート</span>
newbook;
string fn<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">"Samples\Curve Fitting\Enzyme.dat"</span>; 
impasc fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>fn<span style="color: #000080;">$</span>;<span style="color: #008000;">
//アクティブワークシート範囲を宣言</span>
range rr <span style="color: #000080;">=</span> <span style="color: #000080;">!</span>;<span style="color: #008000;">
//テンプレートにプロット</span>
plotxy iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">)</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">200</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span><span style="color: #000080;">&lt;</span>new template<span style="color: #000000;">:</span><span style="color: #000080;">=</span>DoubleY<span style="color: #000080;">&gt;</span><span style="color: #000000;">]</span>;<span style="color: #008000;">
//アクティブグラフの2番目のレイヤにプロット、これは上記の折れ線から作成したグラフ</span>
plotxy iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000080;">%</span><span style="color: #000000;">(</span>rr<span style="color: #000000;">)</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">3</span><span style="color: #000000;">)</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">200</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span><span style="color: #000080;">!</span>;<span style="color: #008000;">
//レイヤ2の最初のデータプロットの範囲を宣言</span>
range r2 <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span><span style="color: #000080;">!</span><span style="color: #0000dd;">1</span>;<span style="color: #008000;">
//線を破線にセット</span>
set r2 <span style="color: #000080;">-</span>d <span style="color: #0000dd;">1</span>;
</pre>
<h2><a name="Legend_and_Label" id="Legend_and_Label"></a><span class="mw-headline">凡例とラベル</span></h2>
<p>凡例とラベルのフォーマットについては、<a href="../../LabTalk/Script/Creating_and_Accessing_Graphical_Objects.html" title="Script:図形オブジェクトの作成とアクセス">グラフィックオブジェクトの作成とアクセス</a> をご覧下さい。</p>
