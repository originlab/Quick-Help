<h1 class="firstheading">ツールバーボタンから</h1>
<p class="urlname" style="display: none;">From-a-Toolbar-Button</p>
<p>LabTalkスクリプトファイルはOriginの <span class="OIndex">ツールバー</span>ボタンからも起動できます。 <a href="../../LabTalk/Script/Getting_Started_with_LabTalk.html#Custom_Routine" title="Script:LabTalkを使いましょう">LabTalkを使いましょう</a>の章で、ツールバーのカスタムルーチンボタンの使用方法について説明しました。ここでは、その詳細について説明します。3つのファイルによってこれができます。</p>
<ol>
<li>ボタンの外観を定義するビットマップファイル。 <a href="#Custom_Buttons_Available_in_Origin">Originが提供しているボタン</a> または <a href="#Creating_a_Bitmap_File_for_a_New_Button">自分自身で作成したボタン</a>の一方を使用します。</li>
<li>ユーザがボタンをクリックするときに実行されるLabTalkスクリプトファイル</li>
<li>ボタンまたはボタングループについての情報が保存されるINI ファイル。 Originは、以下の手順に従うときにINIファイルを作成します。</li>
</ol>
<p><br />
ボタン自体を定義するビットマップファイル(BMP)を持っているものとします(作成することに関心があれば、 <a href="#Creating_a_Bitmap_File_for_a_New_Button">以下</a>のステップがサンプルになっています。)</p>
<p>最初に、<b>コードビルダ</b> (Originの標準ツールバーの <a class="image"><img alt="Button Code Builder.png" src="../images/From_a_Toolbar_Button/Button_Code_Builder.png" width="23" border="0" /></a> を選択して開く) または他のテキストエディタを使って、LabTalkスクリプト (OGS) ファイルを開発します。 拡張子OGSを付けて保存します。 1つのスクリプトファイルをいくつかのセクションに分け、各セクションを異なるツールバーボタンにすることができます。</p>
<div id="toc" class="toc">
<div id="toctitle">
<h2>目次</h2>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Putting_a_Button_on_an_Origin_Toolbar"><span class="tocnumber">1</span> <span class="toctext">Originツールバーのボタンを配置する</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Match_the_Button_with_a_LabTalk_Script_.28OGS.29_File"><span class="tocnumber">2</span> <span class="toctext">LabTalkスクリプト(OGS) ファイルとボタンを合わせる</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Custom_Buttons_Available_in_Origin"><span class="tocnumber">3</span> <span class="toctext">Originで利用できるカスタムボタン</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Creating_a_Bitmap_File_for_a_New_Button"><span class="tocnumber">4</span> <span class="toctext">新しいボタン用のビットマップファイルを作成する</span></a></li>
</ul>
</div>
<h2><a name="Putting_a_Button_on_an_Origin_Toolbar" id="Putting_a_Button_on_an_Origin_Toolbar"></a><span class="mw-headline">Originツールバーのボタンを配置する</span></h2>
<p>Originツールバーにボタンを配置するには、この手順を使います。</p>
<ol>
<li>Originで、<b>表示：ツールバー</b>を選び、ツールバーのカスタム化ダイアログを開きます。</li>
<li><b>ボタングループ</b>タブをアクティブにします。</li>
<li><b>ボタングループ</b>にある<b>新規</b>ボタンをクリックし、ボタングループの作成ダイアログを開きます。</li>
<li>グループ名を入力します。</li>
<li>この新しいグループに対するボタンの数を入力します。</li>
<li>参照ボタンをクリックし、ビットマップファイルの場所に移動します。このファイルは、ユーザフォルダに置いておくほうが良いでしょう。</li>
<li><b>OK</b>をクリックします。</li>
<li><b>名前を付けて保存</b>ダイアログが開きます。ビットマップファイルと同じ名前を入力します。<b>OK</b>をクリックしてINIファイルを保存します。作成したグループがグループリストに追加され、ボタンが表示されます。</li>
</ol>
<p>OPXファイルにエクスポートするカスタムボタングループを作成する時には、<b>User Files</b>フォルダの中にサブフォルダを作成し、そこにボタングループの初期化ファイル、ビットマップファイル、スクリプトファイル、他のサポートファイルを保存することをお勧めします。他のOriginユーザが、そのOPXファイルをインストールする時に、<b>User Files</b>フォルダ内に、同じサブフォルダが自動的に作成されます。そして、このサブフォルダ内に、カスタムボタングループに関するファイルがコピーされます。この方法でOriginサブフォルダを使用すれば、自分で作成したファイルとOriginのファイルを分けておくことができます。</p>
<h2><a name="Match_the_Button_with_a_LabTalk_Script_.28OGS.29_File" id="Match_the_Button_with_a_LabTalk_Script_.28OGS.29_File"></a><span class="mw-headline">LabTalkスクリプト(OGS) ファイルとボタンを合わせる</span></h2>
<ol>
<li>ボタンをクリックして選択します。</li>
<li>設定ボタンをクリックし、ボタン設定ダイアログを開きます。</li>
<li>参照ボタンをクリックし、OGSファイルのある場所に移動します。</li>
<li>OGSファイルのセクション名を、引数リストに引数入力します。</li>
<li>ツールチップテキストボックスに簡単な説明を入力します。</li>
<li>ステータスバーテキストボックスにステータスバーに出力するメッセージを入力します。</li>
<li><b>OK</b>をクリックします。</li>
<li>ボタングループの各ボタンに対してこれらのステップを繰り返します。</li>
<li>初めのボタンをOriginのワークスペースにドラッグします。 ツールバーが作成されます。 これでほかのボタン全てをツールバーにドラッグできます。</li>
</ol>
<h2><a name="Custom_Buttons_Available_in_Origin" id="Custom_Buttons_Available_in_Origin"></a><span class="mw-headline">Originで利用できるカスタムボタン</span></h2>
<p>以下のダイアログは、Originのメインメニュー<b>表示</b>：<b>ツールバー</b>を選択して開くことができます。<b>ボタングループ</b>タブで、<b>ユーザ定義</b>グループを選びます。</p>
<p><a class="image"><img alt="CustomToolbarOptions.png" src="../images/From_a_Toolbar_Button/CustomToolbarOptions.png" width="584" border="0" /></a><br />
<br /></p>
<p>これらを使って始めるためにOriginツールバーにこれらのボタンをドラッグします。 上記の手順を使い、与えられたボタンとスクリプトを関連付けします。</p>
<h2><a name="Creating_a_Bitmap_File_for_a_New_Button" id="Creating_a_Bitmap_File_for_a_New_Button"></a><span class="mw-headline">新しいボタン用のビットマップファイルを作成する</span></h2>
<p>ビットマップファイルを作成するには、Windowsのペイントのようなビットマップ画像(BMP)を編集し、保存できるプログラムを使用します。 以下のステップは始める際の手助けとなります。</p>
<p><br /></p>
<ol>
<li>組込みのユーザ定義のツールバーのビットマップを使うことは最初に始めるのに適しています。 Windowsペイントで、<b>ファイル:開く</b>を選び、User Filesフォルダを使って、 <b>Userdef.bmp</b>を選択します。</li>
<li>画像サイズをセットします。 <b>イメージ: サイズ変更と傾斜</b>を選びます。画像の高さは16のままである必要があるので変更しないでください。 各ボタンは16x16ピクセルになります。 ツールバーに2つだけボタンが必要なら、幅を32に変更します。 幅は常に16掛けるボタンの数で、最大10個のボタン分、つまり160ピクセルです。</li>
<li><b>表示:ズーム:カスタム:800%</b>を選びます。 これでイメージは操作するのに十分大きくなりました。</li>
<li><b>表示:ズーム:グリッド表示</b>を選択します。 これでピクセルごとに色を付けることができます。 各ボタンの外観をデザインします。</li>
<li><b>ファイル:名前を付けて保存</b>を選び、新しいファイル名を入力し、<b>ファイルの種類</b> は <b>16色ビットマップ</b>にします。</li>
</ol>
