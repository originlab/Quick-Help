<h1 class="firstheading">文字列配列</h1><p class='urlname' style='display: none'>String-Arrays</p>
<p>これは、 <a href="../../LabTalk/LabTalk/StringArray_(object).html" title="LabTalk:StringArray (オブジェクト)"><span class="OIndex">文字列配列</span></a>を作成し、そこに要素を追加し、ソートし、配列の内容を一覧にする方法を示しています。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 既存のサンプルファイルをインポート</span>
newbook;
fpath<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Samples\Data Manipulation\US Metropolitan Area Population.dat&quot;</span>
string fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> fpath<span style="color: #000080;">$</span>;
impasc;
&nbsp;
<span style="color: #008000;">// 最後の列をループし、すべての州のデータを探す</span>
range rMetro<span style="color: #000080;">=</span><span style="color: #0000dd;">4</span>;
stringarray saStates;
for<span style="color: #000000;">(</span> int ir<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>; ir<span style="color: #000080;">&lt;=</span>rMetro.<span style="color: #000080;">GetSize</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; ir<span style="color: #000080;">++</span> <span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
	string strCell<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> rMetro<span style="color: #000000;">[</span>ir<span style="color: #000000;">]</span><span style="color: #000080;">$</span>;
	string strState<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> strCell.<span style="color: #000080;">GetToken</span><span style="color: #000000;">(</span><span style="color: #0000dd;">2</span>,<span style="color: #ff00ff;">&apos;,&apos;</span><span style="color: #000000;">)</span><span style="color: #000080;">$</span>;
	<span style="color: #008000;">// 名前に &apos;-&apos; のインスタンスを見つける</span>
	int nn <span style="color: #000080;">=</span> strState.<span style="color: #000080;">GetNumTokens</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;-&quot;</span><span style="color: #000000;">)</span>;
	<span style="color: #008000;">// States文字列配列に追加</span>
	for<span style="color: #000000;">(</span> int ii<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>; ii<span style="color: #000080;">&lt;=</span>nn; ii<span style="color: #000080;">++</span> <span style="color: #000000;">)</span>
	<span style="color: #000000;">{</span>
		string str<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> strState.<span style="color: #000080;">GetToken</span><span style="color: #000000;">(</span>ii, <span style="color: #ff00ff;">&apos;-&apos;</span><span style="color: #000000;">)</span><span style="color: #000080;">$</span>;
		<span style="color: #008000;">// すでに存在していなければ追加</span>
		int nFind <span style="color: #000080;">=</span> saStates.<span style="color: #000080;">Find</span><span style="color: #000000;">(</span>str<span style="color: #000080;">$</span><span style="color: #000000;">)</span>;
		if<span style="color: #000000;">(</span> nFind <span style="color: #000080;">&lt;</span> <span style="color: #0000dd;">1</span> <span style="color: #000000;">)</span>
			saStates.<span style="color: #000080;">Add</span><span style="color: #000000;">(</span>str<span style="color: #000080;">$</span><span style="color: #000000;">)</span>;
	<span style="color: #000000;">}</span>
<span style="color: #000000;">}</span>
&nbsp;
<span style="color: #008000;">// States文字列配列をソートし、出力</span>
saStates.<span style="color: #000080;">Sort</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
for<span style="color: #000000;">(</span>int ii<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>; ii<span style="color: #000080;">&lt;=</span>saStates.<span style="color: #000080;">GetSize</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; ii<span style="color: #000080;">++</span><span style="color: #000000;">)</span>
	saStates.<span style="color: #000080;">GetAt</span><span style="color: #000000;">(</span>ii<span style="color: #000000;">)</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>;</pre>







    