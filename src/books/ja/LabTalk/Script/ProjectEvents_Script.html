<h1 class="firstheading">ProjectEventsスクリプト</h1><p class='urlname' style='display: none'>ProjectEvents-Script</p>
<p><span class="OIndex" style="display:none">ProjectEventsスクリプトの実行</span><span class="OIndex" style="display:none">Script, Project events</span>
関数を定義して、操作を実行したり、Originプロジェクトを開いたり、閉じたり、保存するコマンドを実行することができます。  Originにはデフォルトで、<span class="OIndex">ProjectEvents.ogs</span> というファイルがOriginプロジェクトに添付されています。 
</p><p>このファイルのテンプレートはOriginに付属しており、<b>EXE</b>フォルダにあります。このテンプレートファイルは各新規プロジェクトに添付されています。ファイルは、<b>コードビルダ</b>で開いて、左パネルの<b>Project</b> ノードを開き、見たり、編集することができます。 
</p>
<h2><a name="Sections_of_ProjectEvents.ogs"></a><span class="mw-headline">ProjectEvents.ogsのセクション</span></h2>
<p>デフォルトで、<b>ProjectEvents.ogs</b> ファイルは、そのプロジェクトと結びついた3つの異なるイベントに対応する3つのセクションを含んでいます。
</p>
<ol><li> AfterOpenDoc:このセクションは、プロジェクトを開いたら直ちに実行されます。</li>
<li> BeforeCloseDoc:このセクションは、プロジェクトを閉じる前に実行されます。</li>
<li> BeforeSaveDoc:このセクションは、プロジェクトを保存する前に実行します。</li></ol>
<h2><a name="Utilizing_ProjectEvents.ogs"></a><span class="mw-headline">ProjectEvents.ogsを利用する</span></h2>
<p>このファイルと内容を実行できるようにするため、ユーザはファイルを編集し、コードビルダで保存する必要があり、そして、プロジェクトを保存します。次回プロジェクトを開いたら、添付OGSファイルに含まれるスクリプトコードは、(事前定義のセクション名に従って)指定したイベントで実行されます。
</p><p>例えば、ユーザが<b>ProjectEvents.ogs</b>ファイルの[AfterOpenDoc]セクションで新しい関数を定義して、コードビルダで保存し、Originのプロジェクトを保存すると、その関数は(<a href="../../LabTalk/LabTalk/Data_Types_and_Variables.html#Scope_of_Variables" title="LabTalk:データ型と変数">グローバル</a>で定義されていれば)プロジェクトが再度開いたときに利用できるようになります。  現在のセッションで利用可能な関数を実行するには、実行するセクションにカーソルを置き、<b>デバッグ</b>メニューから、<b>現在のセクションを実行</b>を選択します。  そして、Originのスクリプトウィンドウで、<b>list a</b> コマンドを発行して、新しい関数が現れ、プロジェクト内で使用できることを確認します。 
</p><p><a href="../../LabTalk/LabTalk/Functions.html#Tutorial:_Using_Multiple_Function_Features" title="LabTalk:関数">関数</a>についての簡単なチュートリアルでは、LabTalkのデータセットベースの関数と一緒に使用すると、<b>ProjectEvents.ogs</b> の値を表示します。
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/ProjectEvents_Script/Tip_icon.png" width="57"  border="0" /></td><td><p>このOGSファイルに自分のセクションを追加してカスタムルーチンを保存したり、プロジェクト固有のスクリプトコードを保存することができます。このようなセクションは、イベントドリブンではありませんが、LabTalkスクリプトを実行できる場所からアクセスすることができます。例えば、[MyScript]というセクションをこのファイルに追加すれば、スクリプトウィンドウから次のように実行して、そのセクションのコードはプロジェクトを開いた後に実行されます。
</p><p>run.section(projectevents,myscript);
</p></td></tr></table>
<p>ProjectEvents.ogsスクリプトは、Originの<a href="../../LabTalk/Script/From_Console.html#Run_OPJ-Based_Custom_Program_with_Command-Line_Control" title="Script:コンソールから">外部のコマンドコンソール</a>からOriginプロジェクトを開いて、実行することもできます。
</p>


    