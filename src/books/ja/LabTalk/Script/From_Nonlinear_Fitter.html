<h1 class="firstheading">非線形フィットから</h1><p class='urlname' style='display: none'>From-Nonlinear-Fitter</p>
<p>非線形フィットには、NLFitダイアログの<b>コード</b>ページに<b><span class="OIndex">フィット後のスクリプト</span></b>セクションがあります。これは、フィット直後に常に何かを実行した場合に役立ちます。例えば、フィットパラメータ値にアクセスし、別の計算を行ったり、別の分析のために結果を積み上げることができます。
</p><p>この例では、<b>フィット後のスクリプト</b>セクションは、フィットデータセットの名前を追加し、計算したピークの中心を<b>GaussResults</b>という名前のワークブックに追加します。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// これは初回のみ新しいブックを作成</span>
if<span style="color: #000000;">(</span>exist<span style="color: #000000;">(</span>GaussResults<span style="color: #000000;">)</span><span style="color: #000080;">!</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
    newbook name<span style="color: #000000;">:</span><span style="color: #000080;">=</span>GaussResults sheet<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> option<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> chkname<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
    GaussResults<span style="color: #000080;">!</span>wks.<span style="color: #000080;">col1</span>.<span style="color: #000080;">name</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span> Dataset;
    GaussResults<span style="color: #000080;">!</span>wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">name</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span> PeakCenter;
<span style="color: #000000;">}</span>
&nbsp;
<span style="color: #008000;">// 最後のレポートシート (this fit)からツリーを取得</span>
getresults iw<span style="color: #000000;">:</span><span style="color: #000080;">=</span>__REPORT<span style="color: #000080;">$</span>;
&nbsp;
<span style="color: #008000;">//  &apos;GaussResults&apos;の2つの列に範囲を割り当て</span>
range ra1 <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>GaussResults<span style="color: #000000;">]</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #0000dd;">1</span>;
range ra2 <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>GaussResults<span style="color: #000000;">]</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #0000dd;">2</span>;
&nbsp;
<span style="color: #008000;">// 1列目の行数と次の行番号を取得</span>
size <span style="color: #000080;">=</span> ra1.<span style="color: #000080;">GetSize</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
size<span style="color: #000080;">++</span>;
&nbsp;
<span style="color: #008000;">// 最初の列に入力データ範囲を書き出す</span>
ra1<span style="color: #000000;">[</span>size<span style="color: #000000;">]</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> ResultsTree.<span style="color: #000080;">Input</span>.<span style="color: #000080;">R2</span>.<span style="color: #000080;">C2</span><span style="color: #000080;">$</span>;
<span style="color: #008000;">// 2番目の列にピークの中心を書き出す</span>
ra2<span style="color: #000000;">[</span>size<span style="color: #000000;">]</span> <span style="color: #000080;">=</span> ResultsTree.<span style="color: #000080;">Parameters</span>.<span style="color: #000080;">xc</span>.<span style="color: #000080;">Value</span>;</pre>







    