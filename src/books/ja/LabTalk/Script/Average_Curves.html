<h1 class="firstheading">複数曲線の平均</h1><p class='urlname' style='display: none'>Average-Curves</p>
<p><a class="external text" href="../../XFunction/X-Function/Avecurves.html"><b>avecurves</b></a> Xファンクションを使って、複数曲線(XYデータ)を平均し、1つの曲線を作成できます。このXファンクションには、平均する時に曲線のX値を計算する方法や等間隔のX値を指定する方法などのオプションがあります。
</p><p>以下は線形補間で平均するサンプルです。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 既存のスクリプト &apos;loadDSC.ogs&apos; を使ってサンプルデータをロード</span>
string fpath<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Samples\LabTalk Script Examples\LoadDSC.ogs&quot;</span>;
string LoadPath<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> fpath<span style="color: #000080;">$</span>;
<span style="color: #008000;">// データが適切にロードされない場合、スクリプトの実行を止める</span>
if<span style="color: #000000;">(</span><span style="color: #000080;">!</span>run.<span style="color: #000080;">section</span><span style="color: #000000;">(</span><span style="color: #000080;">%</span><span style="color: #000000;">(</span>LoadPath<span style="color: #000080;">$</span><span style="color: #000000;">)</span>, Main, <span style="color: #0000dd;">0</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span> break <span style="color: #0000dd;">1</span>;
<span style="color: #008000;">// データがアクティブワークブックにロードされる</span>
<span style="color: #008000;">// アクティブワークブックの名前を取得、%H はアクティブワークブックを指す</span>
string dscBook<span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #000080;">%</span>H;  
&nbsp;
<span style="color: #008000;">// 線形補間を使ってすべてのデータの平均を実行</span>
avecurves iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span>dscBook<span style="color: #000080;">$</span><span style="color: #000000;">]</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span>end<span style="color: #000000;">)</span><span style="color: #000080;">!</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">)</span> 
          rd<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span><span style="color: #000080;">&lt;</span>input<span style="color: #000080;">&gt;</span><span style="color: #000000;">]</span><span style="color: #000080;">&lt;</span>new name<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Averaged Data&quot;</span><span style="color: #000080;">&gt;</span><span style="color: #000080;">!</span>  
          method<span style="color: #000000;">:</span><span style="color: #000080;">=</span>ave 
          interp<span style="color: #000000;">:</span><span style="color: #000080;">=</span>linear;</pre>
<p>平均したら、データと結果をプロットできます。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//  plotxy Xファンクションを使って、すべてのデータと平均曲線をプロット</span>
plotxy <span style="color: #000000;">[</span>dscBook<span style="color: #000080;">$</span><span style="color: #000000;">]</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span>end<span style="color: #000000;">)</span><span style="color: #000080;">!</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">)</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">200</span>;</pre>







    