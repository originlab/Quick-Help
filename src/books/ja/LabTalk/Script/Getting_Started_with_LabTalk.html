<h1 class="firstheading">LabTalkを使いましょう</h1><p class='urlname' style='display: none'>Getting-Started-with-LT</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Hello_WorldHello_World"><span class="tocnumber">1</span> <span class="toctext">Hello World<span class="OIndex" style="display:none">Hello World</span></span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Using_.3D_to_Get_Quick_OutputQuick_Output"><span class="tocnumber">2</span> <span class="toctext">= 記号を使った素早い出力<span class="OIndex" style="display:none">Quick Output</span></span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Simple_Useful_CommandsSimple_Commands"><span class="tocnumber">3</span> <span class="toctext">簡単で便利なコマンド<span class="OIndex" style="display:none">Simple Commands</span></span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Worksheet"><span class="tocnumber">3.1</span> <span class="toctext">ワークシート</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Graph"><span class="tocnumber">3.2</span> <span class="toctext">グラフ</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Other_Ways_to_Execute_Script"><span class="tocnumber">4</span> <span class="toctext">スクリプトを実行する他の方法</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#Custom_RoutineCustom_Routine_Button"><span class="tocnumber">4.1</span> <span class="toctext">カスタムルーチン<span class="OIndex" style="display:none">Custom Routine</span>ボタン</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Custom_Menu_Item"><span class="tocnumber">4.2</span> <span class="toctext">カスタムメニューアイテム</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Button_in_a_Graph"><span class="tocnumber">4.3</span> <span class="toctext">グラフ内のボタン</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-10"><a href="#Script_Example"><span class="tocnumber">5</span> <span class="toctext">スクリプトサンプル</span></a></li>
<li class="toclevel-1 tocsection-11"><a href="#Using_CTRL_.2B_SHIFT_to_capture_Menu_Command_and_Toolbar_Button_Script"><span class="tocnumber">6</span> <span class="toctext">CTRL + SHIFTを利用してメニューコマンドとツールバーボタンのスクリプトをキャプチャする</span></a>
<ul>
<li class="toclevel-2 tocsection-12"><a href="#Example"><span class="tocnumber">6.1</span> <span class="toctext">サンプル</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-13"><a href="#Where_to_Go_from_Here.3F"><span class="tocnumber">7</span> <span class="toctext">これから行うこと</span></a></li>
</ul>
</div>

<h2><a name="Hello_WorldHello_World"></a><span class="mw-headline">Hello World<span class="OIndex" style="display:none">Hello World</span></span></h2>
<p>まず、よく使用されるサンプルを使い、<a href="../../LabTalk/Category/LT_Running_Scripts.html" title="カテゴリー:LT スクリプトの実行">LabTalkスクリプトを実行する</a>方法を紹介します。
</p>
<ol>
<li>Originを開き、<b>ウィンドウ</b>メニューから<b>スクリプトウィンドウ</b>を選択します。  <b><a href="../../LabTalk/Script/From_Script_and_Command_Window.html" title="Script: スクリプトとコマンドウィンドウから"><span class="OIndex">スクリプトウィンドウ</span></a></b>が開きます。</li>
<li>このウィンドウで次のように入力し、Enterキーを押します。 
<pre class="lt" style="font-family:monospace;">type <span style="color: #ff00ff;">&quot;Hello World&quot;</span></pre>
<p>ここでは、LabTalk<a href="../../LabTalk/LabTalk/Command_Statements.html" title="LabTalk:コマンドステートメント">コマンド</a> <b><a href="../../LabTalk/LabTalk/Type_(command).html" title="LabTalk:Type (コマンド)">type</a></b>を使用しました。コマンドは2文字の省略形でも記述できます。その場合、次のコマンドを実行してください。
</p>
<pre class="lt" style="font-family:monospace;">ty <span style="color: #ff00ff;">&quot;Hello World&quot;</span></pre>
</li>
</ol>
<p>Originは、コマンド行の下に直接<b>Hello World</b>という文字を出力します。
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Getting_Started_with_LabTalk/Tip_icon.png" width="57"  border="0" /></td><td><p>エンターキーを押すと、Originが<a href="../../LabTalk/LabTalk/Using_Semicolons_in_LabTalk.html" title="LabTalk:LabTalkでのセミコロンの使用">セミコロン</a><b>;</b>を行の最後に入力し、そのスクリプトを実行します。<br />スクリプトを繰り返し実行するには、行内にカーソルを移動してエンターキーを押します。カーソルを行の最後に移動する場合、Enterを押してスクリプトを実行する前に、セミコロン（<b>;</b>）を削除する必要があります。
</p></td></tr></table>
<p>では、スクリプトウィンドウで複数の行を実行する方法を確認しましょう。
</p>
<ol>
<li>Origin内でワークブックがアクティブな状態で <b><a href="../../LabTalk/Script/From_Script_and_Command_Window.html" title="Script: スクリプトとコマンドウィンドウから"><span class="OIndex">スクリプトウィンドウ</span></a></b>を開きます。
<li>スクリプトウィンドウに次の3行を入力します。各行の最後に　<b>;</b> を入力してから、Enterキーを押します。これにより、それぞれの行が実行されません。後から全ての行を一度に実行します。
<pre class="lt" style="font-family:monospace;">type <span style="color: #ff00ff;">&quot;The current workbook is&nbsp;%h&quot;</span>;
type <span style="color: #ff00ff;">&quot;This book has $(page.nlayers) sheet(s)&quot;</span>;
type <span style="color: #ff00ff;">&quot;There are $(wks.ncols) columns in the active sheet&quot;</span>;</pre>
<li>マウスでドラッグし、すべてのスクリプト行を選択します。キーボードを使用する場合、スクリプトの最初にカーソルを合わせ、Shiftキーを押しながら矢印キーを使用して全ての行を選択します。
<li>選択した全てのスクリプト行を実行するためにEnterキーを押します。現在どのワークブックがアクティブであるかによって、スクリプトウィンドウに出力される情報は異なりますが、以下のような出力になります。
<pre class="lt" style="font-family:monospace;">The current workbook is Book1
This book has <span style="color: #0000dd;">1</span> sheet<span style="color: #000000;">(</span>s<span style="color: #000000;">)</span>
There are <span style="color: #0000dd;">2</span> columns in the active sheet</pre>
</li>
</ol>
<p>上記の例の場合、<b><a href="../../LabTalk/LabTalk/String_registers.html#String_Registers_as_System_Variables" title="LabTalk:文字列レジスタ">%H</a></b>という文字列レジスタを使用しました。これは現在アクティブなウィンドウ名（ワークブック、行列、グラフのいずれか）を保持します。そして、<a href="../../LabTalk/LabTalk/LabTalk_Objects.html" title="LabTalk:LabTalk オブジェクト">LabTalk オブジェクト</a>の<b><a href="../../LabTalk/LabTalk/Page_(object).html" title="LabTalk:Page(オブジェクト)">page</a></b>と<b><a href="../../LabTalk/LabTalk/Wks_(object).html" title="LabTalk:Wks(オブジェクト)">wks</a></b>を使用し、ブックのシートの数と、シート内の列数を取得しました。<b>$()</b>は、<a href="../../LabTalk/Category/Substitution_Notation.html" title="カテゴリ:置換表記"><span class="OIndex">置換表記</span></a>の1つで、<b>()</b>内の変数を評価し、その値を返すようOriginに通知します。
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Getting_Started_with_LabTalk/Tip_icon.png" width="57"  border="0" /></td><td><p>スクリプトウィンドウに複数の行を入力する場合、各行の最後に <b>;</b> を追加してからEnterを押すと、その行を実行せずに改行できます。これにより、それぞれの行で実行せずに複数行入力できます。そして、全行を選択してEnterキーを押すことで一括で実行できます。
</p></td></tr></table>
<h2><a name="Using_.3D_to_Get_Quick_OutputQuick_Output"></a><span class="mw-headline">記号を使った素早い出力<span class="OIndex" style="display:none">Quick Output</span></span></h2>
<p>スクリプトウィンドウは<a href="../../LabTalk/LabTalk/Interactive_Execution.html" title="LabTalk:Interactive Execution"><span class="OIndex">対話形式</span></a>で結果を返す計算機のように使うことができます。スクリプトウィンドウに、以下のスクリプトを入力し、Enterキーを押します。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #0000dd;">3</span> <span style="color: #000080;">+</span> <span style="color: #0000dd;">5</span> <span style="color: #000080;">=</span></pre>
<p>Originは計算を行い、結果を次の行に出力します。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #0000dd;">3</span> <span style="color: #000080;">+</span> <span style="color: #0000dd;">5</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">8</span></pre>
<p><b>=</b> 記号は、通常、左辺と右辺を持ち、<a href="../../LabTalk/LabTalk/Operators.html" title="LabTalk:演算子"><span class="OIndex">代入演算子</span></a>として使われます。右辺が無い場合、インタプリタが<b>=</b>の左側（左辺）の式を評価し、スクリプトウィンドウに結果を出力します。 
</p><p>以下のサンプルでは、LabTalkでの<a href="../../LabTalk/LabTalk/Data_Types_and_Variables.html" title="LabTalk:データ型と変数"><span class="OIndex">変数</span></a>の考え方を説明します。スクリプトウィンドウに次の<a href="../../LabTalk/LabTalk/Assignment_Statements.html" title="LabTalk:代入文">代入文</a>を入力します。
</p>
<pre class="lt" style="font-family:monospace;">double A <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span></pre>
<p>これにより変数Aを作成し、Aに2が割り当てられます。そして、変数Aに対してPI（Originで定義される<a href="../../LabTalk/LabTalk/Operators.html#Define_a_constant" title="LabTalk:演算子">定数</a><img src="../images/Getting_Started_with_LabTalk/math-b8838e6c7f4a9479d7deaef96e8dfd57.png" title="\;\pi" alt="\;\pi" class="tex"/>）を掛けるなどの算術演算を行い、変数Aに再割り当てすることができます。
</p>
<pre class="lt" style="font-family:monospace;">A <span style="color: #000080;">=</span> A<span style="color: #000080;">*</span>PI</pre>
<p>現在のAの値を表示するには、次のように入力します。
</p>
<pre class="lt" style="font-family:monospace;">A <span style="color: #000080;">=</span></pre>
<p>Enterキーを押すと、次のように値が返ってきます。
</p>
<pre class="lt" style="font-family:monospace;">A <span style="color: #000080;">=</span> <span style="color: #0000dd;">6.2831853071796</span></pre>
<p>さらに、変数や変数の値のリストを見る<a href="../../LabTalk/LabTalk/List_(command).html" title="LabTalk:List (コマンド)">List</a>コマンドもあります。以下のコマンドを入力してEnterを押します。
</p>
<pre class="lt" style="font-family:monospace;">list</pre>
<p>Originは、<b>LabTalkの変数と関数</b>ダイアログを開き、Originの変数をすべて表示します。
</p><p>また、特定のタイプの変数を取得することもできます。
</p>
<pre class="lt" style="font-family:monospace;">list v</pre>
<p>これは、数値<a href="../../LabTalk/LabTalk/Data_Types_and_Variables.html" title="LabTalk:データ型と変数">変数</a>をリストします。
</p>
<h2><a name="Simple_Useful_CommandsSimple_Commands"></a><span class="mw-headline">簡単で便利なコマンド<span class="OIndex" style="display:none">Simple Commands</span></span></h2>
<h3><a name="Worksheet"></a><span class="mw-headline">ワークシート</span></h3>
<pre class="lt" style="font-family:monospace;">newbook; <span style="color: #008000;">//ワークブックを作成</span>
wks.<span style="color: #000080;">ncols</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span>; <span style="color: #008000;">//ワークシートを3列設定</span></pre>
<pre class="lt" style="font-family:monospace;">col<span style="color: #000000;">(</span>B<span style="color: #000000;">)</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span><span style="color: #000080;">*</span>col<span style="color: #000000;">(</span>A<span style="color: #000000;">)</span>; <span style="color: #008000;">//col(B)の値をcol(A)で設定</span></pre>
<h3><a name="Graph"></a><span class="mw-headline">グラフ</span></h3>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//Y列をあらかじめ選択</span>
plotxy; <span style="color: #008000;">//選択されたY列を対応するXデータに対してプロット</span></pre>
<pre class="lt" style="font-family:monospace;">layer.<span style="color: #000080;">x</span>.<span style="color: #000080;">from</span><span style="color: #000080;">=</span><span style="color: #0000dd;">5</span>; <span style="color: #008000;">//X 軸の開始値を設定</span></pre>
<h2><a name="Other_Ways_to_Execute_Script"></a><span class="mw-headline">スクリプトを実行する他の方法</span></h2>
<p>先程のサンプルでは、<b><a href="../../LabTalk/Script/From_Script_and_Command_Window.html" title="Script: スクリプトとコマンドウィンドウから"><span class="OIndex">スクリプトをスクリプトウィンドウ</span></a></b>からスクリプトを実行しました。Originには他にもLabTalkスクリプトを整理して実行する機能があります。詳細については<b><a href="../../LabTalk/Category/LT_Running_and_Debugging_LabTalk_Scripts.html" title="Category:LabTalkスクリプトの実行とデバッグ"> LabTalk スクリプトの実行とデバッグ</a></b>の章を確認してください。ここでは、スクリプトを実行するメソッドをいくつか確認します。(1)<b>カスタムルーチン</b><a href="../../LabTalk/Script/From_a_Toolbar_Button.html" title="Script:ツールバーボタンから">ツールバーボタン</a>、(2)<a href="../../LabTalk/Script/From_a_Custom_Menu_Item.html" title="Script:カスタムメニュー項目から">カスタムメニューアイテム</a>、(3)<a href="../../LabTalk/Script/From_Graphical_Objects.html" title="Script:グラフィックオブジェクトから">グラフページ内のボタン</a>を紹介します。
</p>
<h3><a name="Custom_RoutineCustom_Routine_Button"></a><span class="mw-headline">カスタムルーチン<span class="OIndex" style="display:none">Custom Routine</span>ボタン</span></h3>
<p>Originには、スクリプトを保存し、ツールバーのボタンを押すだけで実行する便利な方法があります。
</p>
<ol>
<li>キーボードで<b>Ctrl+Shift</b>キーを押しながら、<a class="external text" href="../../UserGuide/UserGuide/The_Standard_Toolbar.html">標準ツールバー</a>の<b>カスタムルーチン</b>ボタン <a  class="image"><img alt="Button Custom Routine.png" src="../images/Getting_Started_with_LabTalk/Button_Custom_Routine.png" width="23"  /></a> を押します。</li>
<li>これによりOriginの標準のスクリプトエディタである<b><a href="../../LabTalk/Script/Debugging_Tools.html" title="Script:デバッグツール">コードビルダ</a></b>が開きます。  編集しているファイルは、<b>Custom.ogs</b>です。   コードには、1つの<a href="../../LabTalk/LabTalk/Flow_of_Control.html#Sections_in_a_Script_File" title="LabTalk:Flow of Control">セクション</a> <b>[Main]</b>があり、以下のスクリプト1行を含みます。 
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">[</span>Main<span style="color: #000000;">]</span>
type <span style="color: #000080;">-</span>b <span style="color: #000080;">$</span>General.<span style="color: #000080;">Userbutton</span>;</pre>
<p>これを次の行で置き換えます。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">[</span>Main<span style="color: #000000;">]</span>
type <span style="color: #000080;">-</span>b <span style="color: #ff00ff;">&quot;Hello World&quot;</span>;</pre>
そして、<b>コードビルダ</b>ウィンドウの<b>保存</b><a  class="image"><img alt="Button Save Project.png" src="../images/Getting_Started_with_LabTalk/Button_Save_Project.png" width="23"  /></a>ボタンをクリックします。  </li>
<li>Originのウィンドウに戻り、 <a  class="image"><img alt="Button Custom Routine.png" src="../images/Getting_Started_with_LabTalk/Button_Custom_Routine.png" width="23"  /></a>ボタンをクリックします（キーボードショートカット： <b>ALT + F5</b>）。 </li>
</ol>
<p>これにより、OriginはHello Worldのテキストを表示しますが、ここではtypeコマンドに-bスイッチが付いているので、ポップアップウィンドウに表示されます。
</p>
<h3><a name="Custom_Menu_Item"></a><span class="mw-headline">カスタムメニューアイテム</span></h3>
<p>LabTalkスクリプトはカスタムメニューアイテムから実行できます。
</p>
<ol>
<li>メニューから<b>環境設定：カスタムメニューオーガナイザ</b>を選択して<b><a class="external text" href="../../UserGuide/UserGuide/The_Custom_Menu_Organizer_Dialog_Box.html">カスタムメニューオーガナイザ</a></b>ダイアログを開きます。
</li>
<li><b>カスタムメニュー追加</b>タブを開きます。左側パネルの内部を右クリックし、<b>新しいメインポップアップ</b>をコンテキストメニューから選択します。
</li>
<li>右側のパネルでは、<b>ポップアップテキスト</b>に名前、例えば<b>My Menu</b>を入力してから編集ボックスの外側をクリックします。
</li>
<li>左側パネルから<b>My Menu</b>を選択してから右クリックし、<b>項目の追加</b>をコンテキストメニューから選びます。
</li>
<li>右側のパネルでは、<b>項目テキスト</b>を<b>Hello World</b>に変更し、次のスクリプトを<b>LabTalkスクリプト</b>ボックスに追加します。
</li>
<pre class="lt" style="font-family:monospace;">type <span style="color: #000080;">-</span>b <span style="color: #ff00ff;">&quot;Hello World&quot;</span>;</pre>
<li><b>閉じる</b>ボタンをクリックした後、ポップアップするウィンドウでは<b>Yes</b>をクリックして、メニューの変更を<b>デフォルト</b>メニューに設定します。開いたファイルダイアログでは、<b>保存</b>ボタンを押し、デフォルト名でデフォルトフォルダ（<a class="external text" href="../../UserGuide/UserGuide/The_User_Files_Folder.html">User Filesフォルダ</a>）に保存します。
</li>
<li>これで新しいメニュー（<b>My Menu</b>）がメニューバーの<b>ウィンドウ</b>メニューの左側に追加されます。この新しいメニューアイテムをクリックし、<b>Hello World</b>の項目をドロップダウンから選択します。Hello World と表示されたダイアログがポップアップします。
</ol>
<h3><a name="Button_in_a_Graph"></a><span class="mw-headline">グラフ内のボタン</span></h3>
<p>Originはグラフやワークシートにボタンを追加する事ができ、そのボタンを押す事でLabTalkスクリプトの実行が可能です。これにより、スクリプトを特定のプロジェクトやウィンドウに保存できます。
</p>
<ol>
<li><a class="external text" href="../../UserGuide/UserGuide/The_Standard_Toolbar.html">標準ツールバー</a>の<b>新規グラフ</b>ボタン（<a  class="image"><img alt="Button New Graph.png" src="../images/Getting_Started_with_LabTalk/Button_New_Graph.png" width="23"  /></a>）をクリックし、新しいグラフを作成します。
</li>
<li><a class="external text" href="../../UserGuide/UserGuide/The_Tools_Toolbar.html">プロット操作・オブジェクト作成ツールバー</a>の中の<b><b>テキストツール</b></b>ボタン（<a  class="image"><img alt="Button Text Tool.png" src="../images/Getting_Started_with_LabTalk/Button_Text_Tool.png" width="23"  /></a>）をクリックし、作成したグラフ上でクリックして<b><b>My Button</b></b> と入力します。テキストの入力が終わったら、テキストの外側をクリックして編集を終了します。
</li>
<li>テキストを右クリックしてコンテキストメニューを表示し、<b>プロパティ</b>を選択して<b><a href="../../LabTalk/LabTalk/Graphic_Objects.html" title="LabTalk:グラフィックオブジェクト">テキストオブジェクト</a></b>ダイアログを開きます。
</li>
<li>ダイアログでは、<b>のあとでスクリプトを実行</b>のドロップダウンリストから、<b>ボタンアップ</b>を選択し、以下のスクリプトを編集ボックスに入力します。
</li>
<pre class="lt" style="font-family:monospace;">type <span style="color: #000080;">-</span>b <span style="color: #ff00ff;">&quot;Hello World&quot;</span>;</pre>
<li>OKをクリックして、ダイアログを閉じます。これで、テキストラベルがボタンになりました。ボタンをクリックします。Hello World と表示されたダイアログがポップアップします。
</li>
</ol>
<h2><a name="Script_Example"></a><span class="mw-headline">スクリプトサンプル</span></h2>
<p>ここで紹介するスクリプトサンプルでは、<a href="../../LabTalk/Category/LT_Importing.html" title="Category:LTインポート">インポート</a>とデータ処理に関連する特定のシナリオをステップごとに実行し、プロジェクトを保存します。このサンプルでは、いくつかのLabTalk言語、例えば<b><a href="../../LabTalk/LabTalk/Command_Statements.html" title="LabTalk:コマンドステートメント">コマンド</a></b>、<b><a href="../../LabTalk/LabTalk/LabTalk_Objects.html" title="LabTalk:LabTalk オブジェクト">オブジェクト</a></b>、<b><a href="../../LabTalk/Category/X-Functions.html" title="カテゴリー:Xファンクション">Xファンクション</a></b>に焦点を当てています。これらの言語についての詳細は、この後に続く章で説明します。
</p><p><b>NOTE:</b> ここでは、コマンド文を実行するために<b><a href="../../LabTalk/Script/From_Script_and_Command_Window.html" title="Script: スクリプトとコマンドウィンドウから"><span class="OIndex">スクリプトウィンドウ</span></a></b>を使用します。コードの1行分だけを実行する場合、<b>;</b>は入力せずに、Enterキーを押してください。複数行にわたるコードの場合、各行の末尾に<b>;</b>を入力してからEnterを押すと、そのまま入力を続ける事ができます。全ての行を入力後、行を全選択してEnterキーを押すと実行します。
</p><p>それでは<b><a href="../../LabTalk/LabTalk/Document_(command).html" title="LabTalk:Document (コマンド)">doc</a></b>コマンドと<b>-n</b>スイッチを使用して、新しいプロジェクトを始めましょう。現在のプロジェクトを保存する必要がある場合、このコマンドはユーザに保存をするように促します。
</p>
<pre class="lt" style="font-family:monospace;">doc <span style="color: #000080;">-</span>n</pre>
<p>サンプルフォルダからデータファイルをインポートしましょう。インポートするファイルを参照するために、Xファンクション<b><a class="external text" href="../../XFunction/X-Function/DlgFile.html">dlgfile</a></b> を使用します。
</p>
<pre class="lt" style="font-family:monospace;">dlgfile gr<span style="color: #000000;">:</span><span style="color: #000080;">=</span>ASCII</pre>
<p>インストールフォルダの、<b>\Samples\Import and Export</b> サブフォルダから、<b>S15-125-03.dat</b>を選択し、<b>開く</b>をクリックします。
</p><p>上記操作により、ファイルのパスをロードし、<b>fname$</b>変数にファイル名が入力されます。この変数の値を確認するには、以下のコードを実行します。
</p>
<pre class="lt" style="font-family:monospace;">fname<span style="color: #000080;">$</span><span style="color: #000080;">=</span></pre>
<p>このファイルをアクティブなワークブックにインポートします。<b><a class="external text" href="../../XFunction/X-Function/ImpASC.html">impasc</a></b> Xファンクションを命名制御オプションと共に使用し、ファイル名はワークブック名に設定されません。
</p>
<pre class="lt" style="font-family:monospace;">impasc Options.<span style="color: #000080;">Names</span>.<span style="color: #000080;">FNameToBk</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span></pre>
<p>では、<b>Position</b>列のデータを処理しましょう。まず、<a href="../../LabTalk/LabTalk/Range_Notation.html" title="LabTalk:範囲表記">範囲変数</a>を定義し、この列を指定します。
</p>
<pre class="lt" style="font-family:monospace;">range rpos <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Position&quot;</span></pre>
<p>指定する列は、現在のワークシートの4番目の列なので、インデックス番号を使用し、以下のように定義することもできます。
</p>
<pre class="lt" style="font-family:monospace;">range rpos <span style="color: #000080;">=</span> <span style="color: #0000dd;">4</span></pre>
<p>次のコマンドを使用すると、範囲変数に現在定義されている値を確認できます。
</p>
<pre class="lt" style="font-family:monospace;">list a</pre>
<p>列データを正規化し、データが0から100までの値をになるようにします。正規化に必要なXファンクションを確認するには、次のコマンドを使用します。
</p>
<pre class="lt" style="font-family:monospace;">lx <span style="color: #000080;">*</span>norm<span style="color: #000080;">*</span></pre>
<p>このコマンドで、Xファンクション名に<b>norm</b>を含むものが表示されます。データを正規化するXファンクションは複数あります。今回の例では、<b><a class="external text" href="../../XFunction/X-Function/Rnormalize.html">rnormalize</a></b>Xファンクションを使用します。 
</p><p>このXファンクションのシンタックスに関するヘルプを参照するには、以下のように入力します。
</p>
<pre class="lt" style="font-family:monospace;">rnormalize <span style="color: #000080;">-</span>h</pre>
<p>これにより、情報が一覧表示されます。あるいは、以下のように入力します。
</p>
<pre class="lt" style="font-family:monospace;">help rnormalize</pre>
<p>これにより、ヘルプファイルが開きます。
</p><p>では、position列を正規化します。
</p>
<pre class="lt" style="font-family:monospace;">rnormalize irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span>rpos method<span style="color: #000000;">:</span><span style="color: #000080;">=</span>range100 orng<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>input<span style="color: #000080;">&gt;</span></pre>
<p>正規化データは同じ列、つまり、元のデータを置き換えて出力されます。これは<a class="external text" href="../../XFunction/X-Function/Output_Notations.html">出力範囲変数</a> <b>orng</b>を<b>&lt;input&gt;</b>に設定したためです。
</p><p>Xファンクションを使用する場合、正しい順序で変数値を指定している時は、<a href="../../LabTalk/Script/X-Functions_Overview.html" title="Script:Xファンクション概要">変数名を入力する必要はありません</a>。つまり、上記コマンドは次のように省略して記述できます。
</p>
<pre class="lt" style="font-family:monospace;">rnormalize rpos range100 orng<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>input<span style="color: #000080;">&gt;</span></pre>
<p>ここでも<b>orng</b>を指定した理由は、この変数に先立つ他の変数があるからです。それらの変数は、ここで行いたい計算には関係ないため、今回のコマンドには含めていません。
</p><p><br />
次に、プロジェクト中のフォルダに変更を加えます。<a href="../../LabTalk/Script/Managing_the_Project.html" title="Script:プロジェクトを管理する">プロジェクトを管理</a>するいくつかのXファンクションがあり、そのうちのいくつかを使用します。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 現在のワークシート名を取得</span>
string name<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> wks.<span style="color: #000080;">name</span><span style="color: #000080;">$</span>;
<span style="color: #008000;">// ルートフォルダに移動</span>
pe_cd ..;
<span style="color: #008000;">// Folder1をワークシートと同じ名前にする</span>
pe_rename Folder1 name<span style="color: #000080;">$</span>;</pre>
<p>では、ルートフォルダにある全てのサブフォルダとワークブックをリストしましょう。
</p>
<pre class="lt" style="font-family:monospace;">pe_dir</pre>
<p>最後に、<a href="../../LabTalk/Script/Managing_the_Project.html" title="Script:プロジェクトを管理する">Originプロジェクト</a>を<a class="external text" href="../../UserGuide/UserGuide/The_User_Files_Folder.html">User Filesフォルダ</a>に保存します。User Filesフォルダの場所は文字列レジスタ<b><a href="../../LabTalk/LabTalk/String_registers.html" title="LabTalk:文字列レジスタ">%Y</a></b>に保存されています。この変数を確認すると、User Filesフォルダの場所を確認できます。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000080;">%</span>Y <span style="color: #000080;">=</span></pre>
<p><b><a href="../../LabTalk/LabTalk/Save_(command).html" title="LabTalk:Save (コマンド)">save</a></b>コマンドを使用し、現在のプロジェクトをMyProject.opjという名前でUser Filesフォルダに保存します。
</p>
<pre class="lt" style="font-family:monospace;">save <span style="color: #000080;">%</span>yMyProject</pre>
<p>上記コマンドの<b>%Y</b>はUser Filesフォルダのパスに置き換えられ、このプロジェクトはこのパスに保存されます。
</p>
<h2><a name="Using_CTRL_.2B_SHIFT_to_capture_Menu_Command_and_Toolbar_Button_Script"></a><span class="mw-headline">CTRL + SHIFTを利用してメニューコマンドとツールバーボタンのスクリプトをキャプチャする</span></h2>
<p>Originのメニューコマンドやツールバーボタンなど、GUIの機能はLab Talkのスクリプトで実行することができます。次の方法で、スクリプトを確認できます。
</p>
<ol><li> キーボードのCTRL + SHIFTを押しながら、</li>
<li> メニューコマンドかツールバーボタンをクリックします。</li></ol>
<p>これは、自分でスクリプトを作る時に便利です。
</p>
<h3><a name="Example"></a><span class="mw-headline">サンプル</span></h3>
<ol><li> 新規ワークブックを開き、列AとBを選択・右クリックして、<b>列値の一律設定</b>: <b>行番号</b>を選択します。 </li>
<li> ワークシートがアクティブになっていることを確認して、CTRL + SHIFTを押して<b>散布図</b>ツールバーボタン<a  class="image"><img alt="Button Scatter.png" src="../images/Getting_Started_with_LabTalk/Button_Scatter.png" width="22"  /></a>をクリックします。(または、<b>作図</b> &gt; <b>2D</b>: <b>散布図</b>: <b>散布図</b>を選択します。)</li></ol>
<p>すると、次の2つが実行されます。
</p>
<ul><li> Code Builder(Originの開発環境)が開き、Plot.ogs(Originのシステムスクリプトファイル)のツールバーボタンやメニューコマンドの実行箇所が表示されます。</li>
<li> スクリプトウィンドウにメニューIDとrun.sectionコマンドを書き出します。</li></ul>
<pre class="lt" style="font-family:monospace;">Menu id<span style="color: #000080;">=</span><span style="color: #0000dd;">33248</span> <span style="color: #000000;">(</span>0x81e0<span style="color: #000000;">)</span>
run.<span style="color: #000080;">section</span><span style="color: #000000;">(</span>Plot,Scatter<span style="color: #000000;">)</span></pre>
<p>このスクリプトの情報をもとに、自分で折れ線グラフのスクリプトを作成できます。このスクリプトの動作を確認するには、行番号の入った2列がアクティブなことを確認して、スクリプトウィンドウを開き(<b>ウィンドウ</b>: <b>スクリプトウィンドウ</b>)、次のいずれかを入力してエンターキーを押します。
</p>
<pre class="lt" style="font-family:monospace;">menu <span style="color: #000080;">-</span>e <span style="color: #0000dd;">33248</span></pre>
<pre class="lt" style="font-family:monospace;">run.<span style="color: #000080;">section</span><span style="color: #000000;">(</span>Plot, Scatter<span style="color: #000000;">)</span></pre>
<p><br />
<i><b>詳細は、次のトピックをご覧ください。</b></i>
</p>
<ul><li> <a class="external text" href="../../QuickHelp/QuickHelp/How_to_open_the_dialog_in_Origin_by_using_LabTalk_Script.html">FAQ-666 LabTalk Scriptを使ってOriginのOriginのダイアログを開くには</a></li>
<li> <a href="../../LabTalk/LabTalk/Menu_(command).html#-d.3B_Delete_the_menu_command_at_position_position_in_the_active_menu" title="LabTalk:Menu (コマンド)">メニューコマンドの &quot;-e&quot;スイッチ</a></li>
<li> Originの<a href="../../LabTalk/LabTalk/Run_(object).html#Properties:" title="LabTalk:Run (オブジェクト)">run.section</a></li></ul>
<h2><a name="Where_to_Go_from_Here.3F"></a><span class="mw-headline">これから行うこと</span></h2>
<p>LabTalkスクリプトガイドの残りの項目を学習することが重要です。  上述の例は、表面的なものですが、LabTalkの学習を始めるにあたっては十分な情報といえます。次の章では、LabTalkを学ぶ上で便利なリソースの一覧を表示します。
</p>


    