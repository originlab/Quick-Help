<h1 class="firstheading">行列シートの基本操作</h1><p class='urlname' style='display: none'>Matrix-Basic-Operation</p>
<p>このセクションのサンプルは、多くのオブジェクトプロパティとXファンクションがワークシートと行列シートの両方に適用するので、<a href="../../LabTalk/Script/Worksheet_Basic_Operation.html" title="Script:ワークシートの基本操作">ワークシート基本操作</a> セクションにあるサンプルに似ています。  <b>wks</b> オブジェクトのすべてのプロパティが行列シートに適用するわけではないので、コード内で使用する前に確認する必要があります。
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>内容</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Add_New_Matrixsheet"><span class="tocnumber">1</span> <span class="toctext">新しい行列シートを追加する </span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Activate_a_Matrixsheet"><span class="tocnumber">2</span> <span class="toctext">行列シートをアクティブにする</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Modify_Matrixsheet_Properties"><span class="tocnumber">3</span> <span class="toctext">行列シートプロパティを修正する</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Set_Dimensions"><span class="tocnumber">3.1</span> <span class="toctext">次数をセットする</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Set_XY_Mapping"><span class="tocnumber">3.2</span> <span class="toctext">XYマッピングをセットする</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Delete_Matrixsheet"><span class="tocnumber">4</span> <span class="toctext">行列シートを削除する</span></a></li>
</ul>
</div>

<h2><a name="Add_New_Matrixsheet"></a><span class="mw-headline">新しい行列シートを追加する </span></h2>
<p><i>mat:=1</i> オプション付き<a class="external text" href="../../XFunction/X-Function/Newsheet.html"><b>newsheet</b></a> Xファンクションは、行列シートを行列ブックに追加するのに使用します。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 3つの行列シートを持つ新しい行列ブックを作成し</span>
<span style="color: #008000;">// ロングネームとショートネームに &quot;myMatrix&quot; を使用</span>
newbook name<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;myMatrix&quot;</span> sheet<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span> option<span style="color: #000000;">:</span><span style="color: #000080;">=</span>lsname mat<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
<span style="color: #008000;">// 現在の行列ブックに &quot;newMatrix&quot; という名前の100*100のシートを追加</span>
newsheet name<span style="color: #000000;">:</span><span style="color: #000080;">=</span>newMatrix cols<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">100</span> rows<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">100</span> mat<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;</pre>
<h2><a name="Activate_a_Matrixsheet"></a><span class="mw-headline">行列シートをアクティブにする</span></h2>
<p>ワークシートと同様、行列シートは、<a href="../../LabTalk/LabTalk/Page_(object).html" title="LabTalk:Page (オブジェクト)">page</a>にある内部的なレイヤで、<i>page.active$</i> プロパティにより行列シートにアクセス可能です。例えば:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 3つの行列シートをもつ、行列ブックを作成</span>
newbook sheet<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span> mat<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
&nbsp;
page.<span style="color: #000080;">active</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;	<span style="color: #008000;">// レイヤ番号で行列をアクティブにする</span>
page.<span style="color: #000080;">active</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> MSheet3;	<span style="color: #008000;">// 名前で行列をアクティブにする</span></pre>
<h2><a name="Modify_Matrixsheet_Properties"></a><span class="mw-headline">行列シートプロパティを修正する</span></h2>
<p>行列のプロパティを修正するには、<a href="../../LabTalk/LabTalk/Wks_(object).html" title="LabTalk:Wks(オブジェクト)">wks</a> オブジェクトを使います。これはワークシートと同じように行列シートを動作します。例えば: 
<span class="OIndex" style="display:none">行列シートの名前を変更</span>
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 行列シートの名前の変更</span>
wks.<span style="color: #000080;">name</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;New Matrix&quot;</span>;
<span style="color: #008000;">// 列幅の修正</span>
wks.<span style="color: #000080;">colwidth</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">8</span>;</pre>
<h4><a name="Set_Dimensions"></a><span class="mw-headline">次数/座標値の設定</span></h4>
<p><a href="../../LabTalk/LabTalk/Wks_(object).html" title="LabTalk:Wks(オブジェクト)">wks</a> オブジェクトと <a class="external text" href="../../XFunction/X-Function/Mdim.html">mdim</a> Xファンクションの両方は、行列の次数をセットするのに使用できます。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// wks オブジェクトを使って次数をセット</span>
wks.<span style="color: #000080;">ncols</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">100</span>;
wks.<span style="color: #000080;">nrows</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">200</span>;
<span style="color: #008000;">// mdim Xファンクションを使って次数をセット</span>
mdim cols<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">100</span> rows<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">100</span>;</pre>
<p>同じ行列シートに含まれる複数行列オブジェクトの場合には、すべての行列オブジェクトは同じ次数でなければなりません。
</p>
<h4><a name="Set_XY_Mapping"></a><span class="mw-headline">XYマッピングをセットする</span></h4>
<p>行列は、番号が付けられた列と行を持ち、これらは等間隔で線形にマッピングされたX値およびY値です。LabTalkでは、<a class="external text" href="../../XFunction/X-Function/Mdim.html">mdim</a> Xファンクションを使ってマッピングをセットできます。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 行列シートのXYマッピング</span>
mdim cols<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">100</span> rows<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">100</span> x1<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span> x2<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span> y1<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span> y2<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">9</span>;</pre>
<p><br />
</p>
<h2><a name="Delete_Matrixsheet"></a><span class="mw-headline">行列シートを削除する</span></h2>
<p><a href="../../LabTalk/LabTalk/Layer_(command).html#-d.3B_delete_the_active_layer" title="LabTalk:Layer (コマンド)">layer -d</a>コマンドにより、行列シートの削除が可能です。例えば:
</p>
<pre class="lt" style="font-family:monospace;">layer <span style="color: #000080;">-</span>d;  <span style="color: #008000;">// アクティブレイヤを削除、ワークシート、行列シート、グラフレイヤにできる</span>
layer <span style="color: #000080;">-</span>d <span style="color: #0000dd;">3</span>;  <span style="color: #008000;">// インデックスで、アクティブ行列ブックの3番目の行列シートを削除</span>
layer <span style="color: #000080;">-</span>d msheet1;  <span style="color: #008000;">// 名前で行列シートを削除</span>
range rs <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>mbook1<span style="color: #000000;">]</span>msheet3<span style="color: #000080;">!</span>;
layer <span style="color: #000080;">-</span>d rs;  <span style="color: #008000;">// 範囲で行列シートを削除</span>
<span style="color: #008000;">// 文字列変数に保存された行列ブック名</span>
string str<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> msheet2;
layer <span style="color: #000080;">-</span>d <span style="color: #000080;">%</span><span style="color: #000000;">(</span>str<span style="color: #000080;">$</span><span style="color: #000000;">)</span>;</pre>







    