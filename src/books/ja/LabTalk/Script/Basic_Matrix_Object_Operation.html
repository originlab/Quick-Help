<h1 class="firstheading">行列オブジェクトの基本操作</h1><p>行列シートは複数の行列オブジェクトを持つことができ、それらは共通の次数を持ちます。行列オブジェクトはワークシートと同じように認識することができ、追加や削除ができます。以下のセクションは行列オブジェクトの基本的な操作について、実践的なサンプルを通して紹介します。
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>内容</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Add_or_Insert_Matrix_Object"><span class="tocnumber">1</span> <span class="toctext">行列オブジェクトの追加または挿入</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Activate_Matrix_Object"><span class="tocnumber">2</span> <span class="toctext">行列オブジェクトをアクティブ化する</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Switch_Between_Image_Mode_and_Data_Mode"><span class="tocnumber">3</span> <span class="toctext">イメージモードとデータモードを切り替える</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Set_Labels"><span class="tocnumber">4</span> <span class="toctext">ラベルをセットする</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Delete_Matrix_Object"><span class="tocnumber">5</span> <span class="toctext">行列オブジェクト削除する</span></a></li>
</ul>
</div>

<h2><a name="Add_or_Insert_Matrix_Object"></a><span class="mw-headline">行列オブジェクトの追加または挿入</span></h2>
<p><a href="../../LabTalk/LabTalk/Wks_(object).html" title="LabTalk:Wks(オブジェクト)">wks.nmats</a>を使用すると行列シート内に複数の行列オブジェクトをセットして行列オブジェクトを追加する事ができます。また、<a href="../../LabTalk/LabTalk/Wks_(object).html" title="LabTalk:Wks (オブジェクト)">wks.addcol()</a>の方法は行列オブジェクトを追加する際にも使用できます。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 行列シート内に5つの行列オブジェクトをセット</span>
wks.<span style="color: #000080;">nmats</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>;
<span style="color: #008000;">// 行列シートに新しい行列オブジェクトを追加</span>
wks.<span style="color: #000080;">addCol</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
<span style="color: #008000;">// 名前のついた行列オブジェクトを行列シートに追加</span>
wks.<span style="color: #000080;">addCol</span><span style="color: #000000;">(</span>Channel2<span style="color: #000000;">)</span>;</pre>
<p>デフォルトでは、行列シート内にある最初の行列オブジェクトが現在の行列オブジェクトとなり、<a href="../../LabTalk/LabTalk/Wks_(object).html" title="LabTalk:Wks(オブジェクト)">wks.col</a>を使用します。また、 <a href="../../LabTalk/LabTalk/Wks_(object).html" title="LabTalk:Wks (オブジェクト)">wks.insert()</a>方法は現在の行列オブジェクトの前に行列オブジェクトを挿入します。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 新しい行列ブックを作成し、イメージサムネールを表示</span>
newbook mat<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
matrix <span style="color: #000080;">-</span>it <span style="color: #0000dd;">1</span>;
&nbsp;
<span style="color: #008000;">// アクティブな行列シートの中の1番目の行列オブジェクトの前に行列オブジェクトを挿入</span>
wks.<span style="color: #000080;">insert</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
&nbsp;
<span style="color: #008000;">// 2番目の行列オブジェクトを現在のオブジェクトにする</span>
wks.<span style="color: #000080;">col</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
&nbsp;
<span style="color: #008000;">// 2番目の行列オブジェクトの前に行列オブジェクトを挿入</span>
wks.<span style="color: #000080;">insert</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</pre>
<h2><a name="Activate_Matrix_Object"></a><span class="mw-headline">行列オブジェクトをアクティブ化する</span></h2>
<p>アクティブな行列シートの中にある行列オブジェクトをアクティブ化するには<b>wks.active</b>を使用します。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 新しい行列ブックを作成</span>
newbook mat<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
&nbsp;
<span style="color: #008000;">// アクティブな行列シートにさらに2つの行列オブジェクトを追加</span>
wks.<span style="color: #000080;">addCol</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
wks.<span style="color: #000080;">addCol</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
&nbsp;
<span style="color: #008000;">// イメージサムネールを表示</span>
matrix <span style="color: #000080;">-</span>it <span style="color: #0000dd;">1</span>;
&nbsp;
<span style="color: #008000;">// 2番目の行列オブジェクトをアクティブにする</span>
wks.<span style="color: #000080;">active</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;</pre>
<h2><a name="Switch_Between_Image_Mode_and_Data_Mode"></a><span class="mw-headline">イメージモードとデータモードを切り替える</span></h2>
<p><a href="../../LabTalk/LabTalk/Matrix_(command).html" title="LabTalk:Matrix (コマンド)">matrix</a> コマンドは行列オブジェクトのイメージモードとデータモードを切り替えるオプションを提供しています。アクティブな行列オブジェクトのみが行列シートに現れます。
</p>
<pre class="lt" style="font-family:monospace;">matrix <span style="color: #000080;">-</span>ii <span style="color: #0000dd;">1</span>;  <span style="color: #008000;">// イメージモードで表示</span>
matrix <span style="color: #000080;">-</span>ii <span style="color: #0000dd;">0</span>;  <span style="color: #008000;">// データモードで表示</span></pre>
<h2><a name="Set_Labels"></a><span class="mw-headline">ラベルのセット</span></h2>
<p>各行列オブジェクトについてのロングネーム、コメント、単位は<a href="../../LabTalk/LabTalk/Range_Notation.html" title="LabTalk:範囲表記">範囲表記</a>を使用してセットします。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 新しい行列ブックを作成</span>
newbook mat<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
&nbsp;
<span style="color: #008000;">// 1番目の行列シートに含む行列オブジェクトの数を3つにする</span>
wks.<span style="color: #000080;">nMats</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;
&nbsp;
<span style="color: #008000;">// イメージサムネールを表示</span>
matrix <span style="color: #000080;">-</span>it <span style="color: #0000dd;">1</span>;
&nbsp;
<span style="color: #008000;">// 最初の行列オブジェクトをアクティブにする</span>
wks.<span style="color: #000080;">active</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
&nbsp;
<span style="color: #008000;">// ロングネーム、単位、コメントをセット</span>
range rx <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;  <span style="color: #008000;">// アクティブな行列シートの最初の行列オブジェクト</span>
rx.<span style="color: #000080;">lname</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> X;  <span style="color: #008000;">// ロングネーム = X</span>
rx.<span style="color: #000080;">unit</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> cm;  <span style="color: #008000;">// 単位= cm</span>
rx.<span style="color: #000080;">comment</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;X Direction&quot;</span>;  <span style="color: #008000;">// コメント = &quot;X Direction&quot;</span>
&nbsp;
<span style="color: #008000;">// 同じことを行列オブジェクト2と3にも行う</span>
wks.<span style="color: #000080;">active</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
range ry <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
ry.<span style="color: #000080;">label</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Y;  <span style="color: #008000;">// ロングネームはこの方法でもセット可能</span>
ry.<span style="color: #000080;">unit</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> cm;
ry.<span style="color: #000080;">comment</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Y Direction&quot;</span>;
wks.<span style="color: #000080;">active</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;
range rz <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;
rz.<span style="color: #000080;">label</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Z;
rz.<span style="color: #000080;">unit</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Pa;
rz.<span style="color: #000080;">comment</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Pressure;</pre>
<h2><a name="Delete_Matrix_Object"></a><span class="mw-headline">行列オブジェクト削除する</span></h2>
<p>行列オブジェクトを削除するには、<a href="../../LabTalk/LabTalk/Delete_(command).html" title="LabTalk:Delete (コマンド)">delete</a>コマンドを使用します。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 行列オブジェクトを範囲で削除</span>
range rs<span style="color: #000080;">=</span><span style="color: #000000;">[</span>mbook1<span style="color: #000000;">]</span>msheet1<span style="color: #000080;">!</span><span style="color: #0000dd;">1</span>;  <span style="color: #008000;">// 最初の行列オブジェクト</span>
del rs;
<span style="color: #008000;">// または、行列オブジェクトの名前で削除</span>
range rs<span style="color: #000080;">=</span><span style="color: #000000;">[</span>mbook1<span style="color: #000000;">]</span>msheet1<span style="color: #000080;">!</span>Channel2;  <span style="color: #008000;">// オブジェクト名はChannel2</span>
del rs;</pre>







    