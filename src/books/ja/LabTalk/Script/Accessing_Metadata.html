<h1 class="firstheading">メタデータにアクセスする</h1><p class='urlname' style='display: none'>Accessing-Metadata</p>
<p><span class="OIndex">メタデータ</span>は、他のデータを参照する情報です。例えば、データが最初に収集された時間、データを収集する機器の操作者、調査中のサンプルの温度などです。メタデータはプロジェクト、ページ、レイヤ、列に保存できます。
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Column_Label_Rows"><span class="tocnumber">1</span> <span class="toctext">列ラベル行</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Read.2FWrite_Column_Label_Rows"><span class="tocnumber">1.1</span> <span class="toctext">列ラベル行の読み込み/書き出し</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Create_and_Name_User_Parameter_Rows"><span class="tocnumber">1.2</span> <span class="toctext">ユーザパラメータ行を作成し名前を付ける</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Show.2FHide_Column_LabelsColumn_Label"><span class="tocnumber">1.3</span> <span class="toctext">列ラベルの表示/非表示</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="#Even_Sampling_Interval"><span class="tocnumber">2</span> <span class="toctext">等間隔なサンプリング間隔</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#Accessing_the_Sampling_Interval_Column_Label_Row"><span class="tocnumber">2.1</span> <span class="toctext">サンプリング間隔列ラベル行にアクセスする</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Sampling_Interval_by_X-Function"><span class="tocnumber">2.2</span> <span class="toctext">Xファンクションによるサンプリング間隔</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8"><a href="#Trees"><span class="tocnumber">3</span> <span class="toctext">ツリー</span></a>
<ul>
<li class="toclevel-2 tocsection-9"><a href="#Access_Import_File_Tree_Nodes"><span class="tocnumber">3.1</span> <span class="toctext">ファイルインポートのツリーノードにアクセスする</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Access_Report_Page_Tree"><span class="tocnumber">3.2</span> <span class="toctext">レポートページツリーにアクセスする</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#User_Tree_in_Page_Storage"><span class="tocnumber">3.3</span> <span class="toctext">ページストレージのユーザツリー</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#User_Tree_in_a_Worksheet"><span class="tocnumber">3.4</span> <span class="toctext">ワークシートのユーザツリー</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#User_Tree_in_a_Worksheet_Column"><span class="tocnumber">3.5</span> <span class="toctext">ワークシート列のユーザツリー</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#ROI"><span class="tocnumber">3.6</span> <span class="toctext">ROI</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="Column_Label_Rows"></a><span class="mw-headline">列ラベル行</span></h2>
<p>メタデータは、 <span class="OIndex">ロングネーム</span> (L), <span class="OIndex">単位</span> (U), <span class="OIndex">コメント</span>(C), <span class="OIndex">サンプリング間隔</span> ユーザ定義パラメータを含むさまざまな <span class="OIndex">パラメータ行</span>などといった情報を <span class="OIndex">列ヘッダ</span>に含むワークシート内で表示できます。
</p><p>列ラベル行は文字によるインデックスが割り当てられます。この文字は<a href="../../LabTalk/LabTalk/Column_Label_Row_Characters.html" title="LabTalk:列ラベル行の文字">列ラベル行のリファレンステーブル</a>で確認できます。  使用例は次のようなものがあります。
</p>
<h3><a name="Read.2FWrite_Column_Label_Rows"></a><span class="mw-headline">列ラベル行の読み込み/書き出し</span></h3>
<p>スクリプトから<span class="OIndex" style="display:none">列ラベル行</span> または <span class="OIndex">列ヘッダ</span> の文字列を取得したり、設定したい場合があります。  対応するラベル行の文字を行インデックスとして、ラベル行にアクセスします。 
</p><p><b>Note</b>: 数値セルへのアクセスではラベル行の文字を使うことをサポートしていません。
</p><p>以下は列ヘッダ文字列を読み書きするサンプルです。
</p>
<pre class="lt" style="font-family:monospace;">Book1_A<span style="color: #000000;">[</span>L<span style="color: #000000;">]</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Time;   <span style="color: #008000;">// 列AのロングネームをTimeにセット</span>
Book1_A<span style="color: #000000;">[</span>U<span style="color: #000000;">]</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> sec;    <span style="color: #008000;">// 列Aの単位をsecにセット</span>
string strC<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> col<span style="color: #000000;">(</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span><span style="color: #000000;">[</span>C<span style="color: #000000;">]</span><span style="color: #000080;">$</span>;   <span style="color: #008000;">// 2番目の列のコメント行を読みstrC$に</span>
<span style="color: #008000;">// 最初のシステムパラメータ行から値を取得</span>
double syspar1 <span style="color: #000080;">=</span> <span style="color: #000080;">%</span><span style="color: #000000;">(</span>col<span style="color: #000000;">(</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span><span style="color: #000000;">[</span>p1<span style="color: #000000;">]</span><span style="color: #000080;">$</span><span style="color: #000000;">)</span>;</pre>
<pre class="lt" style="font-family:monospace;">Col<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span><span style="color: #000000;">[</span>L<span style="color: #000000;">]</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Temperature&quot;</span>;   <span style="color: #008000;">// Col(1) のロングネームを&quot;Temperature&quot;に</span>
range bb <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;               <span style="color: #008000;">// Col(2)の範囲変数を宣言</span>
<span style="color: #008000;">// Col(2) のロングネームに文字列 &quot; Data&quot; を追加して</span>
<span style="color: #008000;">//  Col(1) のロングネームにセット</span>
bb<span style="color: #000000;">[</span>L<span style="color: #000000;">]</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>Col<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span><span style="color: #000000;">[</span>L<span style="color: #000000;">]</span><span style="color: #000080;">$</span><span style="color: #000080;">+</span><span style="color: #ff00ff;">&quot; Data&quot;</span>;</pre>
<p><b>Note</b>: Origin8.0では、LabTalk変数が列ラベル行の文字に優先されます。例えば、
</p>
<pre class="lt" style="font-family:monospace;">int L <span style="color: #000080;">=</span> <span style="color: #0000dd;">4</span>;    <span style="color: #008000;">// Origin 8.0以前では</span>
Col<span style="color: #000000;">(</span>B<span style="color: #000000;">)</span><span style="color: #000000;">[</span>L<span style="color: #000000;">]</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>   <span style="color: #008000;">// Col(B)の4行目の値を文字列として返す</span></pre>
<p>しかし、Origin8.1では、これは変更され、列ラベル行(L,U,C,など)が優先されます。
</p>
<pre class="lt" style="font-family:monospace;">int L <span style="color: #000080;">=</span> <span style="color: #0000dd;">4</span>;    <span style="color: #008000;">// Origin 8.1では</span>
Col<span style="color: #000000;">(</span>B<span style="color: #000000;">)</span><span style="color: #000000;">[</span>L<span style="color: #000000;">]</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>   <span style="color: #008000;">// Col(B)のロングネームを文字列として返す</span></pre>
<h3><a name="Create_and_Name_User_Parameter_Rows"></a><span class="mw-headline">ユーザパラメータ行を作成し名前を付ける</span></h3>
<p>次のサンプルはユーザパラメータ行の作成とアクセス方法を示しています。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 最初のユーザパラメータ行を表示</span>
wks.<span style="color: #000080;">userParam1</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;   
<span style="color: #008000;">// 最初のユーザパラメータ行をカスタムネームに割り当て</span>
wks.<span style="color: #000080;">userParam1</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Temperature&quot;</span>;   
<span style="color: #008000;">// 列の特定のユーザパラメータ行に書き込み</span>
col<span style="color: #000000;">(</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span><span style="color: #000000;">[</span>Temperature<span style="color: #000000;">]</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;96.8&quot;</span>;   
<span style="color: #008000;">// ユーザ定義パラメータ行の値を取得</span>
double temp <span style="color: #000080;">=</span> <span style="color: #000080;">%</span><span style="color: #000000;">(</span>col<span style="color: #000000;">(</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span><span style="color: #000000;">[</span>Temperature<span style="color: #000000;">]</span><span style="color: #000080;">$</span><span style="color: #000000;">)</span>;</pre>
<h3><a name="Show.2FHide_Column_LabelsColumn_Label"></a><span class="mw-headline">列ラベルの表示/非表示</span></h3>
<p><a href="../../LabTalk/LabTalk/Wks_(object).html#Display_Worksheet_Column_Labels" title="LabTalk:Wks (オブジェクト)">wks.labels</a> オブジェクトメソッドで、どの列ヘッダ行をどの順番で表示するかをセットすることができます。  アクティブワークシートに対して、このスクリプトは次の列ヘッダ行を（指定された順序で）表示します。ロングネーム、単位、最初のシステムパラメータ、最初のユーザパラメータ、コメント
</p>
<pre class="lt" style="font-family:monospace;">range ww <span style="color: #000080;">=</span> <span style="color: #000080;">!</span>;
ww.<span style="color: #000080;">labels</span><span style="color: #000000;">(</span>LUP1D1C<span style="color: #000000;">)</span>;</pre>
<h2><a name="Even_Sampling_Interval"></a><span class="mw-headline">等間隔なサンプリング間隔</span></h2>
<p>Originのユーザはデータ系列(Y)に対するサンプリング間隔をデータポイントの対応する行以外の値にセットすることができます。（デフォルト）
</p>
<h3><a name="Accessing_the_Sampling_Interval_Column_Label_Row"></a><span class="mw-headline">サンプリング間隔列ラベル行にアクセスする</span></h3>
<p>これを行うと特別な列ヘッダ行が作成され、カスタム間隔（と初期値）が適用されていることがわかります。  このヘッダ行のテキストにアクセスするには、単に<b>E</b> 行インデックス文字を使います。  このヘッダ行は、実際には読み込み専用で、自由な文字列をセットできません。しかし、構成されているこの文字列のプロパティを列のプロパティ (<a href="../../LabTalk/LabTalk/Wks.Col_(object).html" title="LabTalk:Wks.Col (オブジェクト)">wks.colオブジェクト</a>を参照) または<a class="external text" href="../../XFunction/X-Function/Colint.html">colint Xファンクション</a>のどちらかで変更できます。 
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//  1番目の列のサンプリング間隔ヘッダテキストを読み取り、文字列変数に</span>
string sampInt<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Col<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span><span style="color: #000000;">[</span>E<span style="color: #000000;">]</span><span style="color: #000080;">$</span>;  
<span style="color: #008000;">// サンプリング間隔がCol(1)に開始値2、増分0.5で</span>
<span style="color: #008000;">// セットされている場合、</span>
sampInt<span style="color: #000080;">$</span><span style="color: #000080;">=</span>;                       <span style="color: #008000;">// &quot;x0 = 2&quot;</span>
                                 <span style="color: #008000;">// &quot;dx = 0.5&quot;　と出力される</span></pre>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Accessing_Metadata/Tutorial_icon.png" width="57"  border="0" />
	</td>
	<td><p>サンプリング間隔のヘッダを見るには、以下のステップを試してください。
</p>
<ol><li> 新しいワークシートを作成し、X列を削除します。</li>
<li> 残りの列(例：B(Y))の一番上をクリックして列全体を選択し、右クリックしてメニューから<b>サンプリング間隔を設定</b>を選択します。  </li>
<li> 初期値および増分値を1以外の値に設定します。  </li>
<li> OKをクリックすると指定した値が入力されている新しい列ヘッダ行が表示されます。  </li></ol>
<p>次のサンプルはXファンクションを使って、スクリプトからこれを行う方法を示しています。
</p><p>また、あるデータタイプ(例えば<i>*.wav</i>)をインポートするとき、サンプリング間隔がヘッダ行として表示されます。  
</p></td></tr></table>
<h3><a name="Sampling_Interval_by_X-Function"></a><span class="mw-headline">Xファンクションによるサンプリング間隔</span></h3>
<p>サンプリング間隔はその表示がユーザ情報で書式化されるという点で特別なものです。プログラム的には、以下のようにアクセスします。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Xファンクションの完全表記を使用</span>
colint rng<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span> x0<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">68</span> inc<span style="color: #000000;">:</span><span style="color: #000080;">=</span>.25 units<span style="color: #000000;">:</span><span style="color: #000080;">=</span>Degrees lname<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Temperature&quot;</span>;
<span style="color: #008000;">// 以下は短い表記 </span>
colint <span style="color: #0000dd;">1</span> <span style="color: #0000dd;">68</span> .25 Degrees <span style="color: #ff00ff;">&quot;Temperature&quot;</span>;</pre>
<p>初期値と増分値はワークシート列プロパティを使って読み込むことができます。
</p>
<pre class="lt" style="font-family:monospace;">double XInitial <span style="color: #000080;">=</span> wks.<span style="color: #000080;">col1</span>.<span style="color: #000080;">xinit</span>;
double XIncrement <span style="color: #000080;">=</span> wks.<span style="color: #000080;">col1</span>.<span style="color: #000080;">xinc</span>;
string XUnits<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> wks.<span style="color: #000080;">col1</span>.<span style="color: #000080;">xunits</span><span style="color: #000080;">$</span>;
string XName<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> wks.<span style="color: #000080;">col1</span>.<span style="color: #000080;">xname</span><span style="color: #000080;">$</span>;</pre>
<p><b>Note</b>: サンプリング間隔が設定されている場合を除き、これらのプロパティが列プロパティのリスト内で表示されます(スクリプトウィンドウに<b>wks.col1.= </b>と入力し、列1のプロパティ名を表示)。
</p>
<ul><li> 文字列 <b>wks.col1.xunits$</b> および <b>wks.col1.xname$</b> には値がありません。 </li>
<li> 数値 <b>wks.col1.xinit</b> および <b>wks.col1.xinc</b> は、それぞれ行番号の最初の値と増分値に対応する1という値を持ちます。</li></ul>
<p><br />
</p>
<h2><a name="Trees"></a><span class="mw-headline">ツリー</span></h2>
<p><span class="OIndex">ツリー</span>はLabTalkでサポートされるデータタイプで、これは既存のデータを構造化するものなのでメタデータの形式のツリーも考えます。これらは、<a href="../../LabTalk/LabTalk/Data_Types_and_Variables.html#Tree" title="LabTalk:データ型と変数">データタイプと変数</a>で扱うセクションで簡単に紹介されていますが、Xファンクションに対しても重要なので再度説明しています。
</p><p>多くのXファンクションは、データをツリー形式で入力、出力します。  XファンクションはLabTalkスクリプトからアクセスできる主要なツールの1つなので、効率よくツリー変数を認識し、使用することが重要です。
</p>
<h3><a name="Access_Import_File_Tree_Nodes"></a><span class="mw-headline">ファイルインポートのツリーノードにアクセスする</span></h3>
<p>ワークシートにデータをインポートしたあと、Originはページレベルで特別なツリーのような構造<a href="../../LabTalk/LabTalk/Page_(object).html" title="LabTalk:Page (オブジェクト)">(page.info)</a>のメタデータを保存します。ファイルについての基本情報は、この構造から直接取り出すことができます。
</p>
<pre class="lt" style="font-family:monospace;">string strName, strPath;
double dDate;
<span style="color: #008000;">// 構造からファイル名、パスデータを取得</span>
strName<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> page.<span style="color: #000080;">info</span>.<span style="color: #000080;">system</span>.<span style="color: #000080;">import</span>.<span style="color: #000080;">filename</span><span style="color: #000080;">$</span>;
strPath<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> page.<span style="color: #000080;">info</span>.<span style="color: #000080;">system</span>.<span style="color: #000080;">import</span>.<span style="color: #000080;">filepath</span><span style="color: #000080;">$</span>;
dDate <span style="color: #000080;">=</span> page.<span style="color: #000080;">info</span>.<span style="color: #000080;">system</span>.<span style="color: #000080;">import</span>.<span style="color: #000080;">filedate</span>;
<span style="color: #008000;">// %と$置換の両方を使用</span>
ty File <span style="color: #000080;">%</span><span style="color: #000000;">(</span>strPath<span style="color: #000080;">$</span><span style="color: #000000;">)</span><span style="color: #000080;">%</span><span style="color: #000000;">(</span>strName<span style="color: #000080;">$</span><span style="color: #000000;">)</span>, dated <span style="color: #000080;">$</span><span style="color: #000000;">(</span>dDate,D10<span style="color: #000000;">)</span>;

<span style="color: #008000;">// Origin 2019b以降のより簡単にフォーマットされたファイルデータに出力可能</span>
strDate<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> page.<span style="color: #000080;">info</span>.<span style="color: #000080;">SYSTEM</span>.<span style="color: #000080;">IMPORT</span>.<span style="color: #000080;">FILEDATE</span><span style="color: #000080;">$</span>;
<span style="color: #008000;">//D9データフォーマットを使って日時文字列を生成</span></pre>
<p>このツリー構造は、インポートについて追加の情報を持つツリーを含みます。このツリーはXファンクションを使ってツリー変数として抽出できます。
</p>
<pre class="lt" style="font-family:monospace;">Tree MyFiles;
impinfo ipg<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span>Book2<span style="color: #000000;">]</span> tr<span style="color: #000000;">:</span><span style="color: #000080;">=</span>MyFiles;
MyFiles.<span style="color: #000080;">=</span>; <span style="color: #008000;">// ツリーの内容をスクリプトウィンドウに出力</span></pre>
<p>Note: <i>impinfo</i>ツリーの内容は、インポートに使われる関数に依存します。
</p><p>複数ファイルを1つのワークブックにインポートする場合(新しいシート、新しい列または新しい行)、オーガナイザは最後にインポートしたシステムメタデータのみを表示するため、各ファイルに対する特定のツリーをロードする必要があります。
</p>
<pre class="lt" style="font-family:monospace;">Tree trFile;
int iNumFiles;
<span style="color: #008000;">// ファイルの数を探すために最初にこの関数を使用</span>
impinfo trInfo<span style="color: #000000;">:</span><span style="color: #000080;">=</span>trFile fcount<span style="color: #000000;">:</span><span style="color: #000080;">=</span>iNumFiles;
<span style="color: #008000;">// すべてのファイルをループ - インデックス0から始まる</span>
for<span style="color: #000000;">(</span> idx <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>&nbsp;; idx <span style="color: #000080;">&lt;</span> iNumFiles&nbsp;; idx<span style="color: #000080;">++</span> <span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
   <span style="color: #008000;">// 次のファイルのツリーを取得</span>
   impinfo findex<span style="color: #000000;">:</span><span style="color: #000080;">=</span>idx trInfo<span style="color: #000000;">:</span><span style="color: #000080;">=</span>trFile;
   string strFileName, strLocation;
   <span style="color: #008000;">// </span>
   strFileName<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> trFile.<span style="color: #000080;">Info</span>.<span style="color: #000080;">FileName</span><span style="color: #000080;">$</span>;
   strLocation<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> trFile.<span style="color: #000080;">Info</span>.<span style="color: #000080;">DataRange</span><span style="color: #000080;">$</span>;
   ty File <span style="color: #000080;">%</span><span style="color: #000000;">(</span>strFileName<span style="color: #000080;">$</span><span style="color: #000000;">)</span> was imported into <span style="color: #000080;">%</span><span style="color: #000000;">(</span>strLocation<span style="color: #000080;">$</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span></pre>
<h3><a name="Access_Report_Page_Tree"></a><span class="mw-headline">レポートページツリーにアクセスする</span></h3>
<p>分析レポートページは、ツリー構造に基づく特別な形式のワークシートです。この構造を <a class="external text" href="../../XFunction/X-Function/Getresults.html">getresults Xファンクション</a>を使って、<a href="../../LabTalk/LabTalk/Data_Types_and_Variables.html#Tree" title="LabTalk:データ型と変数">ツリー変数</a>を取得し、結果を抽出できます。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Originサンプルファイルをインポート</span>
string fpath<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Samples\Curve Fitting\Gaussian.dat&quot;</span>;
string fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> SYSTEM.<span style="color: #000080;">PATH</span>.<span style="color: #000080;">PROGRAM</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> fpath<span style="color: #000080;">$</span>;
impasc;
<span style="color: #008000;">// データのGaussフィットを実行しレポートシートを作成</span>
nlbegin <span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">)</span> gauss;
nlfit;
nlend <span style="color: #0000dd;">1</span> <span style="color: #0000dd;">1</span>;
<span style="color: #008000;">// 自動作成の文字列変数 __REPORT$, </span>
<span style="color: #008000;">// は最後に作成されたレポートシートの名前を保持</span>
string strLastReport<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> __REPORT<span style="color: #000080;">$</span>;
<span style="color: #008000;">// これはレポートをツリーに取得するXファンクション</span>
getresults tr<span style="color: #000000;">:</span><span style="color: #000080;">=</span>MyResults iw<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000080;">%</span><span style="color: #000000;">(</span>strLastReport<span style="color: #000080;">$</span><span style="color: #000000;">)</span>;
<span style="color: #008000;">// これらの結果にアクセスできる</span>
ty Variable\tValue\tError;
separator <span style="color: #0000dd;">3</span>;
ty y0\t<span style="color: #000080;">$</span><span style="color: #000000;">(</span>MyResults.<span style="color: #000080;">Parameters</span>.<span style="color: #000080;">y0</span>.<span style="color: #000080;">Value</span><span style="color: #000000;">)</span>\t<span style="color: #000080;">$</span><span style="color: #000000;">(</span>MyResults.<span style="color: #000080;">Parameters</span>.<span style="color: #000080;">y0</span>.<span style="color: #000080;">Error</span><span style="color: #000000;">)</span>;
ty xc\t<span style="color: #000080;">$</span><span style="color: #000000;">(</span>MyResults.<span style="color: #000080;">Parameters</span>.<span style="color: #000080;">xc</span>.<span style="color: #000080;">Value</span><span style="color: #000000;">)</span>\t<span style="color: #000080;">$</span><span style="color: #000000;">(</span>MyResults.<span style="color: #000080;">Parameters</span>.<span style="color: #000080;">xc</span>.<span style="color: #000080;">Error</span><span style="color: #000000;">)</span>;
ty w\t<span style="color: #000080;">$</span><span style="color: #000000;">(</span>MyResults.<span style="color: #000080;">Parameters</span>.<span style="color: #000080;">w</span>.<span style="color: #000080;">Value</span><span style="color: #000000;">)</span>\t<span style="color: #000080;">$</span><span style="color: #000000;">(</span>MyResults.<span style="color: #000080;">Parameters</span>.<span style="color: #000080;">w</span>.<span style="color: #000080;">Error</span><span style="color: #000000;">)</span>;
ty A\t<span style="color: #000080;">$</span><span style="color: #000000;">(</span>MyResults.<span style="color: #000080;">Parameters</span>.<span style="color: #000080;">A</span>.<span style="color: #000080;">Value</span><span style="color: #000000;">)</span>\t<span style="color: #000080;">$</span><span style="color: #000000;">(</span>MyResults.<span style="color: #000080;">Parameters</span>.<span style="color: #000080;">A</span>.<span style="color: #000080;">Error</span><span style="color: #000000;">)</span>;</pre>
<h3><a name="User_Tree_in_Page_Storage"></a><span class="mw-headline">ページストレージのユーザツリー</span></h3>
<p>ツリー構造<a href="../../LabTalk/LabTalk/Page_(object).html" title="LabTalk:Page (オブジェクト)">(page.tree)</a>を使って情報をワークブック、行列ブック、グラフページに保存できます。次のサンプルは、セクションを作成し、アクティブページ保存領域にサブセクションと値を追加する方法を示します。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// ツリーノードに値を追加</span>
page.<span style="color: #000080;">tree</span>.<span style="color: #000080;">experiment</span>.<span style="color: #000080;">sample</span>.<span style="color: #000080;">RunNumber</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">45</span>;
page.<span style="color: #000080;">tree</span>.<span style="color: #000080;">experiment</span>.<span style="color: #000080;">sample</span>.<span style="color: #000080;">Temperature</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">273.8</span>; 
<span style="color: #008000;">// 他のツリーノードに値を追加</span>
page.<span style="color: #000080;">tree</span>.<span style="color: #000080;">experiment</span>.<span style="color: #000080;">detector</span>.<span style="color: #000080;">Type</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;InGaAs&quot;</span>;
page.<span style="color: #000080;">tree</span>.<span style="color: #000080;">experiment</span>.<span style="color: #000080;">detector</span>.<span style="color: #000080;">Cooling</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Liquid Nitrogen&quot;</span>;
page.<span style="color: #000080;">tree</span>.<span style="color: #000080;">=</span>
<span style="color: #008000; font-style: regular;">/*
Output: 
    EXPERIMENT
         +---SAMPLE
         |    +---RUNNUMBER = 45
         |    \---TEMPERATURE = 273.8
         \---DETECTOR
              +---TYPE = InGaAs
              \---COOLING = Liquid Nitrogen
*/</span></pre>
<p>いったん情報を保存すれば、保存内容をダンプして取り出すことができるようになります。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// ページストレージのすべての内容を出力</span>
page.<span style="color: #000080;">tree</span>.<span style="color: #000080;">=</span>;
<span style="color: #008000;">// またはプログラムでアクセス</span>
temperature <span style="color: #000080;">=</span> page.<span style="color: #000080;">tree</span>.<span style="color: #000080;">experiment</span>.<span style="color: #000080;">sample</span>.<span style="color: #000080;">temperature</span>;
string type<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> page.<span style="color: #000080;">tree</span>.<span style="color: #000080;">experiment</span>.<span style="color: #000080;">detector</span>.<span style="color: #000080;">Type</span><span style="color: #000080;">$</span>;
ty Using <span style="color: #000080;">%</span><span style="color: #000000;">(</span>type<span style="color: #000080;">$</span><span style="color: #000000;">)</span> at <span style="color: #000080;">$</span><span style="color: #000000;">(</span>temperature<span style="color: #000000;">)</span>K;</pre>
<p>ワークブックまたは行列ブックのページオーガナイザでツリーを表示できます。
</p>
<h3><a name="User_Tree_in_a_Worksheet"></a><span class="mw-headline">ワークシートのユーザツリー</span></h3>
<p>ワークブックのページレベルに保存されているツリーは、シートがアクティブであるかどうかに関係なく、アクセスできます。シートレベルでツリーを保存することもできます。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// ここではアクティブシートに2つのツリーを追加</span>
wks.<span style="color: #000080;">tree</span>.<span style="color: #000080;">add</span><span style="color: #000000;">(</span>Input<span style="color: #000000;">)</span>;
<span style="color: #008000;">// ブランチと値を動的に作成</span>
wks.<span style="color: #000080;">tree</span>.<span style="color: #000080;">input</span>.<span style="color: #000080;">Min</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
<span style="color: #008000;">// 別の値を追加</span>
wks.<span style="color: #000080;">tree</span>.<span style="color: #000080;">input</span>.<span style="color: #000080;">max</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
<span style="color: #008000;">// 2番目のツリーを追加</span>
wks.<span style="color: #000080;">tree</span>.<span style="color: #000080;">add</span><span style="color: #000000;">(</span>Output<span style="color: #000000;">)</span>;
<span style="color: #008000;">// 2つ以上の値を追加</span>
wks.<span style="color: #000080;">tree</span>.<span style="color: #000080;">output</span>.<span style="color: #000080;">min</span> <span style="color: #000080;">=</span> <span style="color: #000080;">-100</span>;
wks.<span style="color: #000080;">tree</span>.<span style="color: #000080;">output</span>.<span style="color: #000080;">max</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">100</span>;
&nbsp;
<span style="color: #008000;">// ツリーを出力</span>
wks.<span style="color: #000080;">tree</span>.<span style="color: #000080;">=</span>;
<span style="color: #008000;">// またはアクセス</span>
ty Input <span style="color: #000080;">$</span><span style="color: #000000;">(</span>wks.<span style="color: #000080;">tree</span>.<span style="color: #000080;">input</span>.<span style="color: #000080;">min</span><span style="color: #000000;">)</span> to <span style="color: #000080;">$</span><span style="color: #000000;">(</span>wks.<span style="color: #000080;">tree</span>.<span style="color: #000080;">input</span>.<span style="color: #000080;">max</span><span style="color: #000000;">)</span>;
ty Output <span style="color: #000080;">$</span><span style="color: #000000;">(</span>wks.<span style="color: #000080;">tree</span>.<span style="color: #000080;">output</span>.<span style="color: #000080;">min</span><span style="color: #000000;">)</span> to <span style="color: #000080;">$</span><span style="color: #000000;">(</span>wks.<span style="color: #000080;">tree</span>.<span style="color: #000080;">output</span>.<span style="color: #000080;">max</span><span style="color: #000000;">)</span>;
&nbsp;
<span style="color: #008000;">// rangeを使ってシートレベルのツリーにアクセス</span>
range rs <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>Book7<span style="color: #000000;">]</span>Sheet2<span style="color: #000080;">!</span>;
rs<span style="color: #000080;">!</span>wks.<span style="color: #000080;">tree</span>.<span style="color: #000080;">=</span>;</pre>
<p>ワークブックまたは行列ブックのページオーガナイザでツリーを表示できます。
</p>
<h3><a name="User_Tree_in_a_Worksheet_Column"></a><span class="mw-headline">ワークシート列のユーザツリー</span></h3>
<p>個々のワークシート列はツリー形式でメタデータを含むことができます。  ツリーノードを読みだすことはページレベルのツリーと非常に似ています。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// COLUMN ツリーを作成</span>
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">tree</span>.<span style="color: #000080;">add</span><span style="color: #000000;">(</span>Batch<span style="color: #000000;">)</span>;
<span style="color: #008000;">// ブランチを追加</span>
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">tree</span>.<span style="color: #000080;">batch</span>.<span style="color: #000080;">addsection</span><span style="color: #000000;">(</span>Mix<span style="color: #000000;">)</span>;
<span style="color: #008000;">// ブランチに2つの値を追加</span>
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">tree</span>.<span style="color: #000080;">batch</span>.<span style="color: #000080;">mix</span>.<span style="color: #000080;">ratio</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;20:15:2&quot;</span>;
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">tree</span>.<span style="color: #000080;">batch</span>.<span style="color: #000080;">mix</span>.<span style="color: #000080;">BatchNo</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">113210</span>;
<span style="color: #008000;">// 動的にブランチと値を追加</span>
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">tree</span>.<span style="color: #000080;">batch</span>.<span style="color: #000080;">Line</span>.<span style="color: #000080;">No</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">7</span>;
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">tree</span>.<span style="color: #000080;">batch</span>.<span style="color: #000080;">Line</span>.<span style="color: #000080;">Date</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span><span style="color: #000080;">/</span><span style="color: #0000dd;">15</span><span style="color: #000080;">/</span><span style="color: #0000dd;">2010</span>; 
&nbsp;
<span style="color: #008000;">// スクリプトウィンドウにツリーを出力</span>
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">tree</span>.<span style="color: #000080;">=</span>;
<span style="color: #008000;">// またはツリーにアクセス</span>
batch <span style="color: #000080;">=</span> wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">tree</span>.<span style="color: #000080;">batch</span>.<span style="color: #000080;">mix</span>.<span style="color: #000080;">batchno</span>;
string strDate<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">tree</span>.<span style="color: #000080;">batch</span>.<span style="color: #000080;">Line</span>.<span style="color: #000080;">Date</span><span style="color: #000080;">$</span>;
ty Batch <span style="color: #000080;">$</span><span style="color: #000000;">(</span>batch<span style="color: #000000;">)</span> made on <span style="color: #000080;">%</span><span style="color: #000000;">(</span>strDate<span style="color: #000080;">$</span><span style="color: #000000;">)</span> <span style="color: #000000;">[</span><span style="color: #000080;">$</span><span style="color: #000000;">(</span>date<span style="color: #000000;">(</span><span style="color: #000080;">%</span><span style="color: #000000;">(</span>strDate<span style="color: #000080;">$</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span><span style="color: #000000;">]</span>;</pre>
<p>列プロパティダイアログのユーザツリータブでこれらのツリーを表示できます。
</p>
<h3><a name="ROI"></a><span class="mw-headline">ROI</span></h3>
<p>SVG から作成された関心領域 (ROI) ボックスの場合、たとえば ROI が脳アトラスSVGから作成された場合、メタデータはバイナリ ストレージツリー<b><b>roi.info.tree</b></b>で保存およびアクセスできます。
</p>
<table class="simple">
<tr>
<th width="20%"> ツリーノード
</th>
<th> 説明
</th></tr>
<tr>
<td> <b>roi.info.tree.longname$</b>
</td>
<td> ROI ロングネームを割り当ておよび取得します。
<p>SVG画像から作成したROIボックスについては、頭文字の名前がROI名として設定され、フルネームはロングネームとして保存され、このバイトで検索することができます。 
</p>
</td></tr>
<tr>
<td> <b>roi.info.tree.svg$</b>
</td>
<td> SVG名にアクセスします。<b>ブックオーガナイザ</b>の<b>layer.info.tree.<i>BrainAtlas</i>.SVG$</b>のように、ユーザツリーからもアクセスできます。
</td></tr>
<tr>
<td> <b>roi.info.tree.slice$</b>
</td>
<td> ROI のスライス名にアクセスします。<b>ブックオーガナイザ</b>のユーザツリー<b>layer.info.tree.slice$</b>からもアクセスできます。
</td></tr></table>



    