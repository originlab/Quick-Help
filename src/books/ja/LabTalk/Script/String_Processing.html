<h1 class="firstheading">文字列の処理</h1><p class='urlname' style='display: none'>String-Processing</p>
<div id="toc" class="toc"><div id="toctitle"><h2>内容</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Using_String_MethodsString_ProcessingString_Method"><span class="tocnumber">1</span> <span class="toctext">文字列メソッドを使う</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Find_substring.2C_using_getFileName.28.29Substring"><span class="tocnumber">1.1</span> <span class="OIndex" style="display:none">getFileName()を使って部分文字列を探す</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Find_substring.2C_using_reverseFind.28.29.2C_mid.28.29_methods"><span class="tocnumber">1.2</span> <span class="toctext">reverseFind(), mid()メソッドを使って、部分文字列を探す</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Find_substring.2C_token-based"><span class="tocnumber">1.3</span> <span class="toctext">トークンを使って部分文字列を探す</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="#String_Concatenation"><span class="tocnumber">2</span> <span class="toctext">文字の連結</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Using_String_Registers"><span class="tocnumber">3</span> <span class="toctext">文字列レジスタを使う</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Extracting_Numbers_from_a_StringExtracting_String_Number"><span class="tocnumber">4</span> <span class="toctext">文字列から数値を抽出</span></a></li>
</ul>
</div>

<h3><a name="Using_String_MethodsString_ProcessingString_Method"></a><span class="mw-headline"><a href="../../LabTalk/LabTalk/String_(object).html" title="LabTalk:String(オブジェクト)">文字列メソッド</a>を使う</span></h3>
<p>これらのサンプルは、長い文字列(この例ではフルパスのファイル名)から、部分文字列(ファイル名)を取得する方法をいくつか示しています。  最後に、2つの文字列を連結する方法を示します。
</p>
<h4><a name="Find_substring.2C_using_getFileName.28.29Substring"></a><span class="mw-headline">getFileName()を使って部分文字列を探す</span></h4>
<p>この例では、文字列メソッドは、特定の事例として作成していますが、一般に必要な操作に使うことができます。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 組込みの文字列メソッド GetFileName()を使用</span>
string fname<span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;C:\Program Files\Origin 8\Samples\Import\S15-125-03.dat&quot;</span>;
string str1<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> fname.<span style="color: #000080;">GetFileName</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000080;">$</span>;
str1<span style="color: #000080;">$</span><span style="color: #000080;">=</span>;</pre>
<h4><a name="Find_substring.2C_using_reverseFind.28.29.2C_mid.28.29_methods"></a><span class="mw-headline">reverseFind(), mid()メソッドを使って、部分文字列を探す</span></h4>
<p>ここでは、文字列メソッドを組み合わせて使用します。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 関数ReverseFind と Mid を使ってファイル名を抽出</span>
string fname<span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;C:\Program Files\Origin 8\Samples\Import\S15-125-03.dat&quot;</span>;
<span style="color: #008000;">// 右から探すことで、最後の &apos;\&apos; の位置を見つける</span>
int nn<span style="color: #000080;">=</span>fname.<span style="color: #000080;">ReverseFind</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&apos;\&apos;</span><span style="color: #000000;">)</span>;
<span style="color: #008000;">// その位置の後に開始し、終わりまでの部分文字列を取得</span>
string str2<span style="color: #000080;">$</span><span style="color: #000080;">=</span>fname.<span style="color: #000080;">Mid</span><span style="color: #000000;">(</span>nn<span style="color: #000080;">1</span><span style="color: #0000dd;">)</span><span style="color: #000080;">$</span>;
<span style="color: #008000;">// ファイル名をスクリプトウィンドウに出力</span>
str2<span style="color: #000080;">$</span><span style="color: #000080;">=</span>;</pre>
<h4><a name="Find_substring.2C_token-based"></a><span class="mw-headline">トークンを使って部分文字列を探す</span></h4>
<p><span class="OIndex" style="display:none">Token</span>
</p><p>ここでは、別の一般的な探索方法を使って、操作を完了させます。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// トークンを使って、ファイル名を抽出</span>

string fname<span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;C:\Program Files\Origin 8\Samples\Import\S15-125-03.dat&quot;</span>;
<span style="color: #008000;">//  &apos;\&apos; 記号で区切られたトークンの数を取得</span>
int nn<span style="color: #000080;">=</span>fname.<span style="color: #000080;">GetNumTokens</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&apos;\&apos;</span><span style="color: #000000;">)</span>;           
<span style="color: #008000;">// 最後のトークンを取得</span>
string str3<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> fname.<span style="color: #000080;">GetToken</span><span style="color: #000000;">(</span>nn, <span style="color: #ff00ff;">&apos;\&apos;</span><span style="color: #000000;">)</span><span style="color: #000080;">$</span>;  
<span style="color: #008000;">// そのトークンの値をスクリプトウィンドウに出力</span>
str3<span style="color: #000080;">$</span><span style="color: #000080;">=</span>;</pre>
<h3><a name="String_Concatenation"></a><span class="mw-headline">文字列の連結</span></h3>
<p>&apos;+&apos; 演算子を使って、<span class="OIndex">文字列を連結</span>することができます。以下に示すように行います。
</p>
<pre class="lt" style="font-family:monospace;">string aa<span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;reading&quot;</span>;
string bb<span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;he likes &quot;</span> <span style="color: #000080;">+</span> aa<span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot; books&quot;</span>;
type <span style="color: #ff00ff;">&quot;He said &quot;</span> <span style="color: #000080;">+</span> bb<span style="color: #000080;">$</span>;</pre>
<p><b>insert</b> 文字列メソッドを使って、2つの文字列を連結することができます。
</p>
<pre class="lt" style="font-family:monospace;">string aa<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Happy&quot;</span>;
string bb<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot; Go Lucky&quot;</span>;
<span style="color: #008000;">// 文字列 &apos;aa&apos; を文字列 &apos;bb&apos; に位置1で挿入 </span>
bb.<span style="color: #000080;">insert</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,aa<span style="color: #000080;">$</span><span style="color: #000000;">)</span>;            
bb<span style="color: #000080;">$</span><span style="color: #000080;">=</span>;</pre>
<p>サポートされている文字列メソッドの一覧と説明については、<a href="../../LabTalk/LabTalk/String_(object).html" title="LabTalk:String(オブジェクト)">String (オブジェクト)</a>をご覧下さい。
</p>
<h3><a name="Using_String_Registers"></a><span class="mw-headline">文字列レジスタを使う</span></h3>
<p><a href="../../LabTalk/LabTalk/String_registers.html" title="LabTalk:文字列レジスタ"><span class="OIndex">文字列レジスタ</span></a>は、より簡単で強力に使うことができますが、文字列変数とそのメソッドに比べ、読み込みが難しくなります。また、これらは、グローバル(セッションスコープ)なので、他のプログラムにより修正されることが少なくなります。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// ２つの文字列を文字列レジスタを使って連結</span>
&nbsp;
<span style="color: #000080;">%</span>A<span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Left&quot;</span>;
<span style="color: #000080;">%</span>B<span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Handed&quot;</span>;
<span style="color: #000080;">%</span>N<span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;%A %B&quot;</span>;
<span style="color: #000080;">%</span>N<span style="color: #000080;">=</span>          <span style="color: #008000;">// &quot;Left Handed&quot;</span></pre>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 長いファイルパスの文字列からファイル名の部分文字列を抽出</span>
<span style="color: #000080;">%</span>N<span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;C:\Program Files\Origin 8\Samples\Import\S15-125-03.dat&quot;</span>;
for<span style="color: #000000;">(</span>done<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;done<span style="color: #000080;">==</span><span style="color: #0000dd;">0</span>; <span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
    <span style="color: #000080;">%</span>M<span style="color: #000080;">=</span><span style="color: #000080;">%</span><span style="color: #000000;">[</span><span style="color: #000080;">%</span>N,<span style="color: #000080;">&gt;</span><span style="color: #ff00ff;">&apos;\&apos;</span><span style="color: #000000;">]</span>;
    if<span style="color: #000000;">(</span><span style="color: #000080;">%</span><span style="color: #000000;">[</span><span style="color: #000080;">%</span>M<span style="color: #000000;">]</span><span style="color: #000080;">&gt;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span> <span style="color: #000080;">%</span>N <span style="color: #000080;">=</span> <span style="color: #000080;">%</span>M;
    else done <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
<span style="color: #000000;">}</span>
<span style="color: #000080;">%</span>N<span style="color: #000080;">=</span>;</pre>
<h3><a name="Extracting_Numbers_from_a_StringExtracting_String_Number"></a><span class="mw-headline">文字列から数値を抽出</span></h3>
<p>このサンプルは、文字列から数値を抽出する複数の方法を示しています。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 文字列変数は多くのメソッドをサポート</span>
string fname<span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;S15-125-03.dat&quot;</span>;
&nbsp;
int nn<span style="color: #000080;">=</span>fname.<span style="color: #000080;">Find</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&apos;S&apos;</span><span style="color: #000000;">)</span>;
string str1<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> fname.<span style="color: #000080;">Mid</span><span style="color: #000000;">(</span>nn<span style="color: #000080;">+</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">2</span><span style="color: #000000;">)</span><span style="color: #000080;">$</span>;
type <span style="color: #ff00ff;">&quot;1st number =&nbsp;%(str1$)&quot;</span>;
&nbsp;
string str2<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> fname.<span style="color: #000080;">Between</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;-&quot;</span>, <span style="color: #ff00ff;">&quot;-&quot;</span><span style="color: #000000;">)</span><span style="color: #000080;">$</span>;
type <span style="color: #ff00ff;">&quot;2nd number =&nbsp;%(str2$)&quot;</span>;
&nbsp;
int nn <span style="color: #000080;">=</span> fname.<span style="color: #000080;">ReverseFind</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&apos;-&apos;</span><span style="color: #000000;">)</span>;
int oo <span style="color: #000080;">=</span> fname.<span style="color: #000080;">ReverseFind</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&apos;.&apos;</span><span style="color: #000000;">)</span>;
string str3<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> fname.<span style="color: #000080;">Mid</span><span style="color: #000000;">(</span>nn <span style="color: #000080;">+</span> <span style="color: #0000dd;">1</span>, oo <span style="color: #000080;">-</span> nn <span style="color: #000080;">-</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">)</span><span style="color: #000080;">$</span>;
type <span style="color: #ff00ff;">&quot;3rd number = %(str3$)&quot;</span>;
&nbsp;
type <span style="color: #000080;">$</span><span style="color: #000000;">(</span><span style="color: #000080;">%</span><span style="color: #000000;">(</span>str2<span style="color: #000080;">$</span><span style="color: #000000;">)</span> <span style="color: #000080;">-</span> <span style="color: #000080;">%</span><span style="color: #000000;">(</span>str1<span style="color: #000080;">$</span><span style="color: #000000;">)</span> <span style="color: #000080;">*</span> <span style="color: #000080;">%</span><span style="color: #000000;">(</span>str3<span style="color: #000080;">$</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
&nbsp;
<span style="color: #008000;">// 文字列レジスタを使って、部分文字列の表記を使用可能</span>
<span style="color: #000080;">%</span>M <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;S15-125-03.dat&quot;</span>;
<span style="color: #000080;">%</span>N <span style="color: #000080;">=</span> <span style="color: #000080;">%</span><span style="color: #000000;">[</span><span style="color: #000080;">%</span>M,<span style="color: #0000dd;">2</span><span style="color: #000000;">:</span><span style="color: #0000dd;">3</span><span style="color: #000000;">]</span>;  <span style="color: #008000;">// 開始と終了を指定</span>
type <span style="color: #ff00ff;">&quot;1st number = %N&quot;</span>;
<span style="color: #000080;">%</span>N <span style="color: #000080;">=</span> <span style="color: #000080;">%</span><span style="color: #000000;">[</span><span style="color: #000080;">%</span>M,<span style="color: #000080;">&gt;</span><span style="color: #ff00ff;">&apos;S&apos;</span><span style="color: #000000;">]</span>; <span style="color: #008000;">// &apos;S&apos;の後の文字列を探す</span>
<span style="color: #000080;">%</span>N <span style="color: #000080;">=</span> <span style="color: #000080;">%</span><span style="color: #000000;">[</span><span style="color: #000080;">%</span>N,<span style="color: #ff00ff;">&apos;-&apos;</span><span style="color: #000000;">]</span>;  <span style="color: #008000;">//  &apos;-&apos;の前の残りを探す</span>
type <span style="color: #ff00ff;">&quot;1st number = %N&quot;</span>;
<span style="color: #000080;">%</span>O <span style="color: #000080;">=</span> <span style="color: #000080;">%</span><span style="color: #000000;">[</span><span style="color: #000080;">%</span>M,#<span style="color: #0000dd;">2</span>,\x2D<span style="color: #000000;">]</span>;  <span style="color: #008000;">//  &apos;-&apos; (16進数で 2D)で区切られた2番目のトークンを探す</span>
type <span style="color: #ff00ff;">&quot;2nd number = %O&quot;</span>;
<span style="color: #000080;">%</span>P <span style="color: #000080;">=</span> <span style="color: #000080;">%</span><span style="color: #000000;">[</span><span style="color: #000080;">%</span>M,<span style="color: #ff00ff;">&apos;.&apos;</span><span style="color: #000000;">]</span>;  <span style="color: #008000;">// 拡張子を取る</span>
<span style="color: #000080;">%</span>P <span style="color: #000080;">=</span> <span style="color: #000080;">%</span><span style="color: #000000;">[</span><span style="color: #000080;">%</span>P,<span style="color: #000080;">&gt;</span><span style="color: #ff00ff;">&apos;-&apos;</span><span style="color: #000000;">]</span>; <span style="color: #008000;">// 最初の &apos;-&apos;の後</span>
<span style="color: #000080;">%</span>P <span style="color: #000080;">=</span> <span style="color: #000080;">%</span><span style="color: #000000;">[</span><span style="color: #000080;">%</span>P,<span style="color: #000080;">&gt;</span><span style="color: #ff00ff;">&apos;-&apos;</span><span style="color: #000000;">]</span>; <span style="color: #008000;">// 2番目の &apos;-&apos;の後</span>
type <span style="color: #ff00ff;">&quot;3rd number = %P&quot;</span>;
type <span style="color: #000080;">$</span><span style="color: #000000;">(</span><span style="color: #000080;">%</span>O <span style="color: #000080;">-</span> <span style="color: #000080;">%</span>N <span style="color: #000080;">*</span> <span style="color: #000080;">%</span>P<span style="color: #000000;">)</span>;</pre>







    