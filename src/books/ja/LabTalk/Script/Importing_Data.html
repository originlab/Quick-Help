<h1 class="firstheading">データのインポート</h1><p class='urlname' style='display: none'>Importing-Data</p>
<p>次のサンプルは、外部ファイルからデータをインポートする方法を説明するものです。  サンプルはASCIIファイルをインポートしますが、目的のファイルタイプ(例えばMatlab)に応じて置き換えることができます。シンタックスやサポートしているコマンドは同じです。  これらのサンプルはOriginサンプルファイルをインポートするので、このサンプルをスクリプトウィンドウまたはコマンドウィンドウに直接入力したり、貼り付けて、実行することができます。
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Import_an_ASCII_Data_File_Into_a_Worksheet_or_Matrix"><span class="tocnumber">1</span> <span class="toctext">ASCIIデータファイルをワークシートまたは行列にインポートする</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Data_Connector_Methods"><span class="tocnumber">1.1</span> <span class="toctext">データコネクタの方法</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#X-Function_Methods"><span class="tocnumber">1.2</span> <span class="toctext">Xファンクションの方法</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4"><a href="#Import_ASCII_Data_with_Options_Specified"><span class="tocnumber">2</span> <span class="toctext">オプションを指定してASCIIデータをインポートする</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Import_Multiple_Data_Files"><span class="tocnumber">3</span> <span class="toctext">複数データファイルをインポートする</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#Data_Connector_Methods_2"><span class="tocnumber">3.1</span> <span class="toctext">データコネクタの方法</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#X-Function_Methods_2"><span class="tocnumber">3.2</span> <span class="toctext">Xファンクションの方法</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8"><a href="#Import_an_ASCII_File_to_Worksheet_and_Convert_to_Matrix"><span class="tocnumber">4</span> <span class="toctext">ASCIIファイルをワークシートにインポートして、行列に変換する</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Related:_the_Open_Command"><span class="tocnumber">5</span> <span class="toctext">Openコマンド</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#Import_with_Themes_and_Filters"><span class="tocnumber">6</span> <span class="toctext">テーマとフィルタを使ってインポートする</span></a>
<ul>
<li class="toclevel-2 tocsection-11"><a href="#Import_with_a_Theme"><span class="tocnumber">6.1</span> <span class="toctext">テーマを使ったインポート</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Import_with_an_Import_Wizard_Filter_File"><span class="tocnumber">6.2</span> <span class="toctext">インポートウィザードフィルタファイルを使ったインポート</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-13"><a href="#Import_from_a_Database"><span class="tocnumber">7</span> <span class="toctext">データベースからインポートする</span></a></li>
</ul>
</div>

<h2><a name="Import_an_ASCII_Data_File_Into_a_Worksheet_or_Matrix"></a><span class="mw-headline">ASCIIデータファイルをワークシートまたは行列にインポートする</span></h2>
<h3><a name="Data_Connector_Methods"></a><span class="mw-headline">データコネクタの方法</span></h3>
<p><a class="external text" href="../../UserGuide/Category/Data_Connector.html">データコネクタ</a>を使って単一ファイルをインポートするサンプルです。
</p>
<pre class="lt" style="font-family:monospace;">string path<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Import and Export\ASCII CSV with Quotes.csv&quot;</span>;
newbook;
wbook.<span style="color: #000080;">dc</span>.<span style="color: #000080;">add</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;CSV&quot;</span><span style="color: #000000;">)</span>;
wks.<span style="color: #000080;">dc</span>.<span style="color: #000080;">source</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> path<span style="color: #000080;">$</span>;
wks.<span style="color: #000080;">dc</span>.<span style="color: #000080;">import</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</pre>
<p><a class="external text" href="../../LabTalk/LabTalk/Wks.DC_(object).html">wks.dc objects</a>と<a class="external text" href="../../LabTalk/LabTalk/Wbk.DC_(object).html">wbk.dc objects</a>の完全なリストを参照してください。
</p>
<h3><a name="X-Function_Methods"></a><span class="mw-headline">Xファンクションの方法</span></h3>
<p>このサンプルは、<span class="OIndex">ASCII</span>ファイル(この場合、拡張子 <b>*.txt</b>)をアクティブワークシートや行列にインポートします。  別のXファンクション <a class="external text" href="../../XFunction/X-Function/FindFiles.html"><b>findfiles</b></a> を使って、他の多くのファイルを含むディレクトリ(変数<b>path$</b>に割り当て)にある特定のファイルを探すことができます。  findfiles Xファンクションの出力は、希望のファイル名を含む文字列変数で、デフォルトで <b>fname$</b>という変数名に割り当てます。  <a class="external text" href="../../XFunction/X-Function/ImpASC.html"><b>impASC</b></a> Xファンクションのデフォルトの入力引数も <b>fname$</b>という変数名となっています。
</p>
<pre class="lt" style="font-family:monospace;">string path<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Import and Export\&quot;</span>;
findfiles ext<span style="color: #000000;">:</span><span style="color: #000080;">=</span>matrix_data_with_xy.<span style="color: #000080;">txt</span>;
impASC;</pre>
<h2><a name="Import_ASCII_Data_with_Options_Specified"></a><span class="mw-headline">オプションを指定してASCIIデータをインポートする</span></h2>
<p>このサンプルは、 <a class="external text" href="../../XFunction/X-Function/ImpASC.html"><b>impASC</b></a> Xファンクションの多くの詳細オプションの使用方法を説明します。  これはファイルを新しいブックにインポートし、<b>impASC</b> Xファンクションのオプションを使って、名前を変更します。  すべてが <b>impASC</b> の呼び出しの一部であることを示すセミコロン (すべての<b>オプション</b>の割り当てに続く) が1つだけであることに注意してください。 
</p>
<pre class="lt" style="font-family:monospace;">string fn<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Spectroscopy\HiddenPeaks.dat&quot;</span>; 
impasc fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>fn<span style="color: #000080;">$</span> 
options.<span style="color: #000080;">ImpMode</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span>                        <span style="color: #008000; font-style: regular;">/* 新しいブックで開始 */</span>
options.<span style="color: #000080;">Sparklines</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>                     <span style="color: #008000; font-style: regular;">/* スパークラインオフ */</span>
options.<span style="color: #000080;">Names</span>.<span style="color: #000080;">AutoNames</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>                <span style="color: #008000; font-style: regular;">/* 自動名前変更オフ */</span>
options.<span style="color: #000080;">Names</span>.<span style="color: #000080;">FNameToSht</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>               <span style="color: #008000; font-style: regular;">/* シート名をファイル名にする */</span>
options.<span style="color: #000080;">Miscellaneous</span>.<span style="color: #000080;">LeadingZeros</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;    <span style="color: #008000; font-style: regular;">/* 先行ゼロを削除 */</span></pre>
<h2><a name="Import_Multiple_Data_Files"></a><span class="mw-headline">複数データファイルをインポートする</span></h2>
<h3><a name="Data_Connector_Methods_2"></a><span class="mw-headline">データコネクタの方法</span></h3>
<p>このサンプルでは、<a class="external text" href="../../UserGuide/Category/Data_Connector.html">データコネクタ</a>を使って複数のCSVファイルを新しいワークブックにインポートします。このスクリプトは、ファイルごとに新しいワークブックを作成します。
</p>
<pre class="lt" style="font-family:monospace;">string folder<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Batch Processing\&quot;</span>;
string files<span style="color: #000080;">$</span>;
findfiles path<span style="color: #000000;">:</span><span style="color: #000080;">=</span>folder<span style="color: #000080;">$</span> ext<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;.csv&quot;</span> fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>files<span style="color: #000080;">$</span>;
int num <span style="color: #000080;">=</span> files.<span style="color: #000080;">GetNumTokens</span><span style="color: #000000;">(</span>CRLF<span style="color: #000000;">)</span>;
for <span style="color: #000000;">(</span>int ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; ii <span style="color: #000080;">&lt;=</span> num; ii<span style="color: #000080;">++</span> <span style="color: #000000;">)</span> <span style="color: #000000;">{</span>
	newbook;wbook.<span style="color: #000080;">dc</span>.<span style="color: #000080;">add</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;CSV&quot;</span><span style="color: #000000;">)</span>;
	wks.<span style="color: #000080;">dc</span>.<span style="color: #000080;">source</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> files.<span style="color: #000080;">gettoken</span><span style="color: #000000;">(</span>ii, CRLF<span style="color: #000000;">)</span><span style="color: #000080;">$</span>;
	wks.<span style="color: #000080;">dc</span>.<span style="color: #000080;">Import</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;
<span style="color: #000000;">}</span></pre>
<p>このサンプルは、同じファイルを1つのワークブックにインポートします。
</p>
<pre class="lt" style="font-family:monospace;">string folder<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Batch Processing\&quot;</span>;
string files<span style="color: #000080;">$</span>;
findfiles path<span style="color: #000000;">:</span><span style="color: #000080;">=</span>folder<span style="color: #000080;">$</span> ext<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;.csv&quot;</span> fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>files<span style="color: #000080;">$</span>;
int num <span style="color: #000080;">=</span> files.<span style="color: #000080;">GetNumTokens</span><span style="color: #000000;">(</span>CRLF<span style="color: #000000;">)</span>;
newbook;
page.<span style="color: #000080;">nlayers</span> <span style="color: #000080;">=</span> num;
wbook.<span style="color: #000080;">dc</span>.<span style="color: #000080;">add</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;CSV&quot;</span><span style="color: #000000;">)</span>;
for <span style="color: #000000;">(</span>int ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; ii <span style="color: #000080;">&lt;=</span> num; ii<span style="color: #000080;">++</span> <span style="color: #000000;">)</span> <span style="color: #000000;">{</span>
	page.<span style="color: #000080;">active</span> <span style="color: #000080;">=</span> ii;
	wks.<span style="color: #000080;">dc</span>.<span style="color: #000080;">sel</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;&quot;</span>;<span style="color: #008000;">//ソースの前にある必要がありシートを接続するのに役立つ</span>
	wks.<span style="color: #000080;">dc</span>.<span style="color: #000080;">source</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> files.<span style="color: #000080;">gettoken</span><span style="color: #000000;">(</span>ii, CRLF<span style="color: #000000;">)</span><span style="color: #000080;">$</span>;
<span style="color: #000000;">}</span>
wbook.<span style="color: #000080;">dc</span>.<span style="color: #000080;">Import</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</pre>
<p>この例では、ツリーごとにwks.dc.optn$の設定を使用してCSVを部分インポートします
</p>
<pre class="lt" style="font-family:monospace;">wbook.<span style="color: #000080;">dc</span>.<span style="color: #000080;">add</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;CSV&quot;</span><span style="color: #000000;">)</span>;
string str1<span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;%@O&quot;</span>;
str1<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> str1.<span style="color: #000080;">GetFilePath</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span><span style="color: #000080;">$</span>;
str1<span style="color: #000080;">$</span> <span style="color: #000080;">+</span><span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Samples\Statistics\automobile.dat&quot;</span>;
wks.<span style="color: #000080;">dc</span>.<span style="color: #000080;">source</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>str1<span style="color: #000080;">$</span>;

Tree tr1<span style="color: #000080;">=</span>wks.<span style="color: #000080;">dc</span>.<span style="color: #000080;">optn</span><span style="color: #000080;">$</span>;
tr1.<span style="color: #000080;">settings</span>.<span style="color: #000080;">partial</span>.<span style="color: #000080;">SetAttribute</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;Use&quot;</span>, <span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>;
tr1.<span style="color: #000080;">settings</span>.<span style="color: #000080;">partial</span>.<span style="color: #000080;">col</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;1:3&quot;</span>;
tr1.<span style="color: #000080;">ToString</span><span style="color: #000000;">(</span>wks.<span style="color: #000080;">dc</span>.<span style="color: #000080;">optn</span><span style="color: #000080;">$</span><span style="color: #000000;">)</span>;<span style="color: #008000;">//ツリーを文字列に変換</span>
wks.<span style="color: #000080;">dc</span>.<span style="color: #000080;">import</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</pre>
<h3><a name="X-Function_Methods_2"></a><span class="mw-headline">Xファンクションの方法</span></h3>
<p>このサンプルでは、新しいワークブックに複数のデータファイルをインポートします。それぞれのファイルで新しいワークシートを作成します。
</p>
<pre class="lt" style="font-family:monospace;">string fns, path<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Curve Fitting\&quot;</span>; 
findfiles fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>fns<span style="color: #000080;">$</span> ext<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;step1*.dat&quot;</span>;   <span style="color: #008000;">// &apos;path$&apos;内でマッチするファイルを検索</span>
int n <span style="color: #000080;">=</span> fns.<span style="color: #000080;">GetNumTokens</span><span style="color: #000000;">(</span>CRLF<span style="color: #000000;">)</span>;      <span style="color: #008000;">// 見つかったファイル数</span>
string bkName<span style="color: #000080;">$</span>;
newbook s<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> result<span style="color: #000000;">:</span><span style="color: #000080;">=</span>bkName<span style="color: #000080;">$</span>;
impasc fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>fns<span style="color: #000080;">$</span>                  <span style="color: #008000;">// impasc には多くのオプションがある</span>
options.<span style="color: #000080;">ImpMode</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span>     		    <span style="color: #008000;">//新しいシートで開始</span>
options.<span style="color: #000080;">Sparklines</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span> 		    <span style="color: #008000;">//50列以下ならスパークラインを追加</span>
options.<span style="color: #000080;">Cols</span>.<span style="color: #000080;">NumCols</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span>  	    <span style="color: #008000;">// 最初の3列のみをインポート </span>
options.<span style="color: #000080;">Names</span>.<span style="color: #000080;">AutoNames</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> 	    <span style="color: #008000;">// 自動名前変更をオフ</span>
options.<span style="color: #000080;">Names</span>.<span style="color: #000080;">FNameToBk</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>          <span style="color: #008000;">// ワークブック名を変更しない</span>
options.<span style="color: #000080;">Names</span>.<span style="color: #000080;">FNameToSht</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>         <span style="color: #008000;">// シートをファイル名に変更</span>
options.<span style="color: #000080;">Names</span>.<span style="color: #000080;">FNameToShtFrom</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span>     <span style="color: #008000;">// 4文字目以降のファイル名を削除</span>
options.<span style="color: #000080;">Names</span>.<span style="color: #000080;">FNameToBkComm</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>      <span style="color: #008000;">// ファイル名をワークブックコメントに追加</span>
options.<span style="color: #000080;">Names</span>.<span style="color: #000080;">FNameToColComm</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>     <span style="color: #008000;">// ファイル名を列コメントに追加</span>
options.<span style="color: #000080;">Names</span>.<span style="color: #000080;">FPathToComm</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>        <span style="color: #008000;">// ファイルパスをコメントに含める</span>
orng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span>bkName<span style="color: #000080;">$</span><span style="color: #000000;">]</span>A1<span style="color: #000080;">!</span>A<span style="color: #000000;">[</span><span style="color: #0000dd;">1</span><span style="color: #000000;">]</span><span style="color: #000000;">:</span>C<span style="color: #000000;">[</span><span style="color: #0000dd;">0</span><span style="color: #000000;">]</span>&nbsp;;</pre>
<h2><a name="Import_an_ASCII_File_to_Worksheet_and_Convert_to_Matrix"></a><span class="mw-headline">ASCIIファイルをワークシートにインポートして、行列に変換する</span></h2>
<p>このサンプルでは、 <a class="external text" href="../../XFunction/X-Function/ImpASC.html"><b>impASC</b></a> と一緒に動作する2つの役立つXファンクションを示します。1つは、<a class="external text" href="../../XFunction/X-Function/DlgFile.html"><b>dlgFile</b></a>で、これはインポートするファイルを選択するダイアログを作成します。もう1つは <a class="external text" href="../../XFunction/X-Function/W2m.html"><b>w2m</b></a> で、これはワークシートを行列に変換します。 
<b>w2m</b> Xファンクションは、最初の列に線形に増加するY値と最初の行に線形に増加するX値が必要です。これを確認するには、<b>Samples\Import and Export\</b> フォルダの<b>matrix_data_with_xy.txt</b>を使います。
</p>
<pre class="lt" style="font-family:monospace;">dlgfile g<span style="color: #000000;">:</span><span style="color: #000080;">=</span>ascii; <span style="color: #008000;">// ファイルを開くダイアログ</span>
impAsc; <span style="color: #008000;">// 選択したファイルをインポート</span>
<span style="color: #008000;">//  ワークシートを行列にするXファンクション, &apos;w2m&apos;を使い変換を行う</span>
w2m xy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> ycol<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> xlabel<span style="color: #000000;">:</span><span style="color: #000080;">=</span>row1</pre>
<h2><a name="Related:_the_Open_Command"></a><span class="mw-headline">Openコマンド</span></h2>
<p>Originにデータを入力する別の方法は、<a href="../../LabTalk/LabTalk/Open_(command).html" title="LabTalk:Open (コマンド)"><b>Open</b> (コマンド)</a>を使う方法です。
</p><p>Openコマンドにはいくつかのオプションがあり、そのうちの1つを使って、ファイルを開いてノートウィンドウに表示します。
</p>
<dl><dd><font color="navy"><i>open -n fileName [winName]</i></font></dd></dl>
<p>このスクリプト行は、ASCIIファイル<i>fileName</i> を<b>ノート</b> ウィンドウに開きます。  任意の<i>winName</i> が指定されていない場合、新しい<b>ノート</b>ウィンドウが作成されます。
</p><p>既知のファイルを使って操作するには次のコマンドを実行します。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000080;">%</span>b <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Import and Export\ASCII simple.dat&quot;</span>;
open <span style="color: #000080;">-</span>n <span style="color: #ff00ff;">&quot;%b&quot;</span>;</pre>
<h2><a name="Import_with_Themes_and_Filters"></a><span class="mw-headline">テーマとフィルタを使ってインポートする</span></h2>
<h3><a name="Import_with_a_Theme"></a><span class="mw-headline">テーマを使ったインポート</span></h3>
<p>OriginGUIからインポートする際には、インポート設定を<b><span class="OIndex">テーマ</span><span class="OIndex HasShownIndex" style="display:none">インポートデータテーマ</span>ファイル</b>に保存できます。  このようなテーマファイルは拡張子 *.OISを持ち、Originの<b>User Filesフォルダ</b>(UFF)の<b>\Themes\AnalysisAndReportTable\</b> サブフォルダに保存されます。  そして、それらは <b>-t</b> <a href="../../LabTalk/LabTalk/X-Function_Execution_Options.html" title="LabTalk:Xファンクションの実行オプション">オプションスイッチ</a>付きのXファンクションを使ってアクセスできます。  指定したテーマファイルに保存された設定に従ってインポートが実行されます。
</p>
<pre class="lt" style="font-family:monospace;">string fn<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Spectroscopy\HiddenPeaks.dat&quot;</span>; 
<span style="color: #008000;">// &quot;My Theme.OIS&quot; というテーマファイルがあることが前提 </span>
impasc fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>fn<span style="color: #000080;">$</span> <span style="color: #000080;">-</span>t <span style="color: #ff00ff;">&quot;My Theme&quot;</span>;</pre>
<h3><a name="Import_with_an_Import_Wizard_Filter_File"></a><span class="mw-headline">インポートウィザードフィルタファイルを使ったインポート</span></h3>
<p>ASCIIファイルおよび単純形式のバイナリファイルのカスタムインポートは<b>インポートウィザード</b>を使って実行することができます。この機能は、ファイル名やヘッダから変数を抽出したり、インポート後に実行するスクリプトを記述してデータの前処理を行うことなどが可能です。  このGUIで設定した内容は、拡張子.OIFの<b>インポートフィルタファイル</b>として様々な場所に保存できます。  このようなファイルは拡張子<b>.OIF</b> を持ち、複数の場所に保存できます。
</p><p><b>インポートウィザードの<span class="OIndex">インポートフィルタ</span>ファイル</b>を作成すると、<a class="external text" href="../../XFunction/X-Function/ImpFile.html"><b>impfile</b></a> Xファンクションを使って、インポートフィルタにアクセスでき、インポートフィルタファイルに保存した設定を使ってカスタムインポートを実行できます。
</p>
<pre class="lt" style="font-family:monospace;">string fname<span style="color: #000080;">$</span>, path<span style="color: #000080;">$</span>, filtername<span style="color: #000080;">$</span>;
<span style="color: #008000;">// ファイルパスを指定</span>
path<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Import and Export\&quot;</span>;
<span style="color: #008000;">// 仕様に合ったファイルを探す</span>
findfiles ext<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;S*.dat&quot;</span>;
<span style="color: #008000;">// インポートウィザードのインポートフィルタを指定</span>
string str<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Samples\Import and Export\VarsFromFileNameAndheader.oif&quot;</span>;
filtername<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> str<span style="color: #000080;">$</span>;  
<span style="color: #008000;">// データフォルダにあるフィルタを使って全てのファイルをインポート </span>
impfile location<span style="color: #000000;">:</span><span style="color: #000080;">=</span>data;</pre>
<h2><a name="Import_from_a_Database"></a><span class="mw-headline">データベースからインポートする</span></h2>
<p>Originは<span class="OIndex">データベース</span>クエリに対して4つの機能を提供しています。データベースインポートの基本機能は、以下のMicrosoft Officeで提供される標準のNorthwindデータベースを使った例に示すように2つの関数にカプセル化されています。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// dbedit 関数はクエリと接続文字列を作成し</span>
<span style="color: #008000;">// 詳細をワークシートに接続</span>
dbedit exec<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>
sql<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Select Customers.CompanyName, Orders.OrderDate,
[Order Details].Quantity, Products.ProductName From
((Customers Inner Join Orders On Customers.CustomerID = Orders.CustomerID)
Inner Join [Order Details] On Orders.OrderID = [Order Details].OrderID)
Inner Join Products On Products.ProductID = [Order Details].ProductID&quot;</span>
connect<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Provider=Microsoft.Jet.OLEDB.4.0;User ID=;
Data Source=C:\Program Files\Microsoft Office\OFFICE11\SAMPLES\Northwind.mdb;
Mode=Share Deny None;Extended Properties=&quot;</span><span style="color: #ff00ff;">&quot;;
Jet OLEDB:System database=&quot;</span><span style="color: #ff00ff;">&quot;;
Jet OLEDB:Registry Path=&quot;</span><span style="color: #ff00ff;">&quot;;
Jet OLEDB:Database Password=***;
Jet OLEDB:Engine Type=5;
Jet OLEDB:Database Locking Mode=1;
Jet OLEDB:Global Partial Bulk Ops=2;
Jet OLEDB:Global Bulk Transactions=1;
Jet OLEDB:New Database Password=&quot;</span><span style="color: #ff00ff;">&quot;;
Jet OLEDB:Create System Database=False;
Jet OLEDB:Encrypt Database=False;
Jet OLEDB:Don&apos;t Copy Locale on Compact=False;
Jet OLEDB:Compact Without Replica Repair=False;
Jet OLEDB:SFP=False;Password=&quot;</span>
&nbsp;
<span style="color: #008000;">// dbimport関数でインポートを完了</span>
dbimport;</pre>
<p>2つの追加の関数は、接続およびクエリ文字列の詳細を取り出し、プレビューと部分インポートを実行します。
</p>
<table class="simple">
<tr>
<th> 名前
</th>
<th> 説明
</th></tr>
<tr>
<td> <a class="external text" href="../../XFunction/X-Function/DbEdit.html">dbEdit</a>
</td>
<td>
<p>ワークシートのクエリを作成、編集、ロード、削除
</p>
</td></tr>
<tr>
<td> <a class="external text" href="../../XFunction/X-Function/DbImport.html">dbImport</a>
</td>
<td>
<p>特定のワークシートに保存したデータベースクエリを実行
</p>
</td></tr>
<tr>
<td> <a class="external text" href="../../XFunction/X-Function/DbInfo.html">dbInfo</a>
</td>
<td>
<p>ワークシートのデータベースクエリに含まれるSQL文字列と接続文字列を読みこむ
</p>
</td></tr>
<tr>
<td> <a class="external text" href="../../XFunction/X-Function/DbPreview.html">dbPreview</a>
</td>
<td>
<p>クエリの制限付き実行（デフォルトで50行）。これはクエリが必要な情報を返すのかを確認するのに便利です。
</p>
</td></tr>
</table>







    