<h1 class="firstheading">行列からワークシートに変換する</h1><p>分析または、グラフ作成時に、行列からワークシートに変換またはその反対の操作により、データを再構成する必要があるかもしれません。このページでは、行列をワークシートに変換する時のサンプルと情報を紹介します。なお、反対の操作は、<a href="../../LabTalk/Script/Converting_Worksheet_to_Matrix.html" title="Script:ワークシートから行列に変換">ワークシートを行列に変換する</a>を確認してください。
</p>
<h2><a name="Matrix_to_Worksheet"></a><span class="mw-headline">行列からワークシート</span></h2>
<p>行列のデータは、 <a class="external text" href="../../XFunction/X-Function/M2w.html">m2w</a> Xファンクションでワークシートに変換できます。このXファンクションは、X/Yマッピング有り、または無しで、直接データをワークシートに変換できます。または、データを再配置してワークシートのXYZ列に入るように変換します。
</p><p>次のサンプルは行列をワークシートに変換し、変換後のデータ形式により、異なる方法でグラフを作成する方法を示しています。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 新しい行列ブックを作成</span>
win <span style="color: #000080;">-</span>t matrix;
<span style="color: #008000;">//  行列の次数とX/Y値をセット</span>
mdim cols<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">21</span> rows<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">21</span> x1<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> x2<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">10</span> y1<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> y2<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">100</span>;
<span style="color: #008000;">// 行列X/Y値を表示</span>
page.<span style="color: #000080;">cntrl</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
<span style="color: #008000;">// 行列Z値を設定</span>
msetvalue formula<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;nlf_Gauss2D(x, y, 0, 1, 5, 2, 50, 20)&quot;</span>;
<span style="color: #008000;">// 行列ウィンドウ名を保持</span>
<span style="color: #000080;">%</span>P <span style="color: #000080;">=</span> <span style="color: #000080;">%</span>H;
<span style="color: #008000;">// 直接法で行列をワークシートに変換</span>
m2w ycol<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> xlabel<span style="color: #000000;">:</span><span style="color: #000080;">=</span>row1;
<span style="color: #008000;">// 仮想行列を使ってワークシートからグラフを作成</span>
plotvm irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span> format<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> ztitle<span style="color: #000000;">:</span><span style="color: #000080;">=</span>MyGraph type<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">242</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>new template<span style="color: #000000;">:</span><span style="color: #000080;">=</span>cmap<span style="color: #000080;">&gt;</span>;
<span style="color: #008000;">// 行列をXYZワークシートデータに変換</span>
sec <span style="color: #000080;">-</span>p <span style="color: #0000dd;">2</span>;
win <span style="color: #000080;">-</span>a <span style="color: #000080;">%</span>P;
m2w im<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000080;">!</span><span style="color: #0000dd;">1</span> method<span style="color: #000000;">:</span><span style="color: #000080;">=</span>xyz;
<span style="color: #008000;">// 3D散布図を作成</span>
worksheet <span style="color: #000080;">-</span>s <span style="color: #0000dd;">3</span>;
worksheet <span style="color: #000080;">-</span>p <span style="color: #0000dd;">240</span> 3D;</pre>
<p>行列データを直接ワークシートセルに変換した場合、 <a href="../../LabTalk/Script/Virtual_Matrix.html" title="Script:仮想行列">仮想行列</a> の機能を使用してデータをプロットできます。
</p>






    