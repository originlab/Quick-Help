<h1 class="firstheading">画像のインポート</h1><p class='urlname' style='display: none'>Importing-Images</p>
<p><span class="OIndex" style="display:none">Import Image</span><span class="OIndex" style="display:none">Image Import</span><a class="external text" href="../../XFunction/X-Function/ImpImage.html">ImpImage</a>Xファンクションは、スクリプトを使って画像ファイルをOriginにインポートします。  デフォルトで、画像ファイルはOriginに画像(RGB値など)として保存されます。  その画像をグレースケールに変換するオプションがあります。
</p><p>Multiple-file importing is supported.デフォルトで、複数の画像ファイルは、新しいレイヤを作成して、目的のページに追加されます。  行列にインポートする場合、各行列のレイヤはインポートするファイル名になります。
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>内容</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Import_Image_to_Matrix_and_Convert_to_Data"><span class="tocnumber">1</span> <span class="toctext">行列に画像をインポートしデータに変換する</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Import_Single_Image_to_Matrix"><span class="tocnumber">2</span> <span class="toctext">1つの画像を行列にインポートする</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Import_Multiple_Images_to_Matrixbook"><span class="tocnumber">3</span> <span class="toctext">複数の画像を行列ブックにインポートする</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Import_Image_to_Graph_Layer"><span class="tocnumber">4</span> <span class="toctext">画像をグラフレイヤにインポートする</span></a></li>
</ul>
</div>

<h2><a name="Import_Image_to_Matrix_and_Convert_to_Data"></a><span class="mw-headline">行列に画像をインポートしデータに変換する</span></h2>
<p>このサンプルは、1つの画像ファイルを行列にインポートし、(RGBカラー)画像をグレースケールに変換し、それらを新しい行列に保存します。
</p>
<pre class="lt" style="font-family:monospace;">newbook mat<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;              <span style="color: #008000;">// 新しい行列ブックを作成</span>
fpath<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Samples\Image Processing and Analysis\car.bmp&quot;</span>;
string fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> fpath<span style="color: #000080;">$</span>;
&nbsp;
<span style="color: #008000;">// アクティブウィンドウにパス &apos;fname$&apos; のイメージをインポート </span>
<span style="color: #008000;">//(新しい行列ブック)</span>
impimage;    
&nbsp;
<span style="color: #008000;">// イメージをグレースケールに変換し、新しい行列に入れる  </span>
<span style="color: #008000;">// &apos;type&apos; はビット深度を指定。  0=short (2バイト/16ビット、デフォルト) </span>
<span style="color: #008000;">// 1=byte (1バイト/8ビット)                                        </span>
img2m type<span style="color: #000000;">:</span><span style="color: #000080;">=</span>byte;</pre>
<h2><a name="Import_Single_Image_to_Matrix"></a><span class="mw-headline">1つの画像を行列にインポートする</span></h2>
<p>このサンプルは新しい行列ブックに一連の *.TIF画像をインポートします。  上記で示した <a class="external text" href="../../XFunction/X-Function/Img2m.html"><b>img2m</b></a> Xファンクションの代替として、キーボードショートカット <b>Ctrl+Shift+d</b> と <b>Ctrl+Shift+i</b> を使って、行列データと画像データの表示を切り替えることができます。
</p>
<pre class="lt" style="font-family:monospace;">newbook mat<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
fpath<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Samples\Image Processing and Analysis\&quot;</span>;
string fns, path<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> fpath<span style="color: #000080;">$</span>;
<span style="color: #008000;">// 「myocyte」からはじまるファイル名のファイルを検索</span>
findfiles f<span style="color: #000000;">:</span><span style="color: #000080;">=</span>fns<span style="color: #000080;">$</span> e<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;myocyte*.tif&quot;</span>;
<span style="color: #008000;">// 各ファイルを新しいシートにインポート (options.Mode = 4)                 </span>
impimage options.<span style="color: #000080;">Mode</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span> fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>fns<span style="color: #000080;">$</span>;</pre>
<h2><a name="Import_Multiple_Images_to_Matrixbook"></a><span class="mw-headline">複数の画像を行列ブックにインポートする</span></h2>
<p>このサンプルは、JPG画像のフォルダを異なる行列ブックにインポートします。
</p>
<pre class="lt" style="font-family:monospace;">string pth1<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;C:\Documents and Settings\All Users\&quot;</span>
string pth2<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Documents\My Pictures\Sample Pictures\&quot;</span>;
string fns, path<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> pth1<span style="color: #000080;">$</span> <span style="color: #000080;">+</span> pth2<span style="color: #000080;">$</span>;
<span style="color: #008000;">// すべての *.JPG ファイルを探す (デフォルトで、「path$」にある)</span>
findfiles fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>fns<span style="color: #000080;">$</span> ext<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;*.jpg&quot;</span>;   
<span style="color: #008000;">// 見つかったファイル数をint変数「n」に割り当てる</span>
<span style="color: #008000;">// 「CRLF」 ==&gt; ファイルを「carriage-return line-feed」で分ける    </span>
int n <span style="color: #000080;">=</span> fns.<span style="color: #000080;">GetNumTokens</span><span style="color: #000000;">(</span>CRLF<span style="color: #000000;">)</span>;            
string bkName<span style="color: #000080;">$</span>;
string fname<span style="color: #000080;">$</span>;
<span style="color: #008000;">// すべてのファイルをループし、それぞれを新しい行列ブックにインポート</span>
for<span style="color: #000000;">(</span>int ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; ii<span style="color: #000080;">&lt;=</span>n; ii<span style="color: #000080;">++</span><span style="color: #000000;">)</span>               
<span style="color: #000000;">{</span>
    fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> fns.<span style="color: #000080;">GetToken</span><span style="color: #000000;">(</span>ii, CRLF<span style="color: #000000;">)</span><span style="color: #000080;">$</span>;

    <span style="color: #008000;">//新しい行列ページを作成</span>
    newbook s<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> mat<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> result<span style="color: #000000;">:</span><span style="color: #000080;">=</span>bkName<span style="color: #000080;">$</span>;   
    <span style="color: #008000;">//行列ページの最初のレイヤにイメージをインポート</span>
    <span style="color: #008000;">//デフォルトのファイル名はfname$ </span>
    impimage orng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span>bkName<span style="color: #000080;">$</span><span style="color: #000000;">]</span>msheet1;       
<span style="color: #000000;">}</span></pre>
<h2><a name="Import_Image_to_Graph_Layer"></a><span class="mw-headline">画像をグラフレイヤにインポートする</span></h2>
<p>既存のグラフレイヤに画像をインポートすることもできます。  この画像は表示のためだけのものです。(行列に変換しなければ、データは表示されません。)
</p>
<pre class="lt" style="font-family:monospace;">string fpath<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Samples\Image Processing and Analysis\cell.jpg&quot;</span>;
string fn<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> fpath<span style="color: #000080;">$</span>;
insertImg2g fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>fn<span style="color: #000080;">$</span> ipg<span style="color: #000000;">:</span><span style="color: #000080;">=</span>graph1;</pre>







    