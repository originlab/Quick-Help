<h1 class="firstheading">外部アプリケーションから</h1><p class='urlname' style='display: none'>From-an-External-Application</p>
<p><span class="OIndex" style="display:none">外部のアプリケーション</span>はOriginを<span class="OIndex">COM サーバ</span>にしてデータのやり取りができます。OriginのCOMオブジェクトは、他のアプリケーションと接続するためのさまざまなプロパティとメソッドを公開しています。完全に制御するため、OriginにはLabTalkから呼び出して実行できるXファンクションおよびOrigin C関数を含み、LabTalkで利用できる<b>Execute</b>メソッドがあります。
このサンプルでは、Visual Basicのシンタックスを使って、Originを開始し、いくつかのデータをインポートし、ガウスフィットして、ピークの中心を出力します。
</p>
<pre class="vb" style="font-family:monospace;">    <span style="color: #008000;">&apos; Start Origin
</span>    <span style="color: #151B8D; font-weight: bold;">Dim</span> oa
    <span style="color: #151B8D; font-weight: bold;">Set</span> oa = <span style="color: #E56717; font-weight: bold;">GetObject</span>(<span style="color: #800000;">&quot;&quot;</span>, <span style="color: #800000;">&quot;Origin.Application&quot;</span>)
    <span style="color: #008000;">&apos;oa.Execute (&quot;doc -m 1&quot;) &apos; Uncomment if you want to see Origin
</span>    <span style="color: #151B8D; font-weight: bold;">Dim</span> strCmd, strVar <span style="color: #151B8D; font-weight: bold;">As</span> <span style="color: #F660AB; font-weight: bold;">String</span>
    <span style="color: #151B8D; font-weight: bold;">Dim</span> dVar <span style="color: #151B8D; font-weight: bold;">As</span> <span style="color: #F660AB; font-weight: bold;">Double</span>

    <span style="color: #008000;">&apos; Wait for Origin to finish startup compile
</span>    <span style="color: #008000;">&apos; (30 seconds is specified here, 
</span>    <span style="color: #008000;">&apos;  but function may return in less than 1 second)
</span>    oa.Execute (<span style="color: #800000;">&quot;sec -poc 30&quot;</span>)
    
    <span style="color: #008000;">&apos;Project is empty so create a workbook and import some data
</span>    oa.Execute (<span style="color: #800000;">&quot;newbook&quot;</span>)
    strVar = oa.LTStr(<span style="color: #800000;">&quot;SYSTEM.PATH.PROGRAM$&quot;</span>) + _
             <span style="color: #800000;">&quot;Samples\Curve Fitting\Gaussian.DAT&quot;</span>
    oa.Execute (<span style="color: #800000;">&quot;string fname&quot;</span>) <span style="color: #008000;">&apos; Declare string in Origin
</span>    oa.LTStr(<span style="color: #800000;">&quot;fname$&quot;</span>) = strVar <span style="color: #008000;">&apos; Set its value
</span>    oa.Execute (<span style="color: #800000;">&quot;impasc&quot;</span>)       <span style="color: #008000;">&apos; Import
</span>
    <span style="color: #008000;">&apos; Do a nonlinear fit (Gauss)
</span>    strCmd = <span style="color: #800000;">&quot;nlbegin 2 Gauss;nlfit;nlend;&quot;</span>
    oa.Execute (strCmd)
    <span style="color: #008000;">&apos; Get peak center
</span>    dVar = oa.LTVar(<span style="color: #800000;">&quot;nlt.xc&quot;</span>)
    strVar = <span style="color: #800000;">&quot;Peak Center at &quot;</span> + CStr(dVar)
    bRet = MsgBox(strVar, vbOKOnly, <span style="color: #800000;">&quot;Gauss Fit&quot;</span>)

    oa.<span style="color: #E56717; font-weight: bold;">Exit</span>
    <span style="color: #151B8D; font-weight: bold;">Set</span> oa = <span style="color: #00C2FF; font-weight: bold;">Nothing</span>
    <span style="color: #8D38C9; font-weight: bold;">End</span></pre>
<p><b><b>Samples\COM Server and Client</b> </b>フォルダには、COMクライアントアプリケーションの詳細なサンプルがあります。
</p>






    