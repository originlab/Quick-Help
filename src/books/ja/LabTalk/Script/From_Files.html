<h1 class="firstheading">ファイルから</h1><p class='urlname' style='display: none'>From-Files</p>
<p>LabTalk<span class="OIndex">スクリプト</span>は通常、Originオブジェクトを要求し、開いたプロジェクトに制限されます。スクリプトはファイルに保存され、どのプロジェクトからでも呼び出すことができます。スクリプトファイルは5つの引数まで、共に呼び出すことができます。このセクションは、ファイルに保存したLabTalkスクリプトの使用の概要です。
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>内容</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Creating_and_Saving_Script_FilesSave_Script_Filescript_files.2C_creating.2FsavingCreate_Script_File"><span class="tocnumber">1</span> <span class="toctext">スクリプトファイルを作成/保存する</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#The_OGS_File_Extension"><span class="tocnumber">2</span> <span class="toctext">OGSファイルの拡張子</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Sections_in_an_OGS_FileSectionScript_Section"><span class="tocnumber">3</span> <span class="toctext">OGSファイル内のセクション</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Running_an_OGS_File"><span class="tocnumber">4</span> <span class="toctext">OGSファイルを実行する</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Passing_Arguments_in_ScriptsArgument.2C_Script_FilePass_Arguments_in_Script"><span class="tocnumber">5</span> <span class="toctext">スクリプトに引数を渡す</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#Passing_Numeric_Variables_by_ReferencePass_Variables_by_Reference"><span class="tocnumber">5.1</span> <span class="toctext">数値変数の参照による引き渡し</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Passing_Numeric_Variables_by_ValuePass_Variables_by_Value"><span class="tocnumber">5.2</span> <span class="toctext">数値変数の値による引き渡し</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8"><a href="#Guidelines_for_Naming_OGS_Files_and_Sections"><span class="tocnumber">6</span> <span class="toctext">OGSファイルとセクションの名前のガイドライン</span></a>
<ul>
<li class="toclevel-2 tocsection-9"><a href="#When_Using_the_Run.section.28.29_Method"><span class="tocnumber">6.1</span> <span class="toctext">Run.section() メソッドを使うとき</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#When_Using_the_Command_Method"><span class="tocnumber">6.2</span> <span class="toctext">コマンドによる方法を使うとき</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Section_Name_Rules_.28When_Using_Either_Method.29"><span class="tocnumber">6.3</span> <span class="toctext">セクション名の規則(どちらかの方法を使うとき)</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-12"><a href="#Setting_the_Path"><span class="tocnumber">7</span> <span class="toctext">パスを設定する</span></a></li>
<li class="toclevel-1 tocsection-13"><a href="#Running_LabTalk_from_Origin_C"><span class="tocnumber">8</span> <span class="toctext">Origin CからLabTalkを実行する</span></a></li>
</ul>
</div>

<h2><a name="Creating_and_Saving_Script_FilesSave_Script_Filescript_files.2C_creating.2FsavingCreate_Script_File"></a><span class="mw-headline">スクリプトファイルを作成/保存する</span></h2>
<p>LabTalkスクリプトは、Originの <span class="OIndex">コードビルダ</span>を含むテキストエディタで作成し、保存できます。コードビルダを開くには、標準ツールバーの <a  class="image"><img alt="Button Code Builder.png" src="../images/From_Files/Button_Code_Builder.png" width="23"  /></a> ボタンをクリックします。  エディタウィンドウにコードを入力したり、貼り付けて新しいドキュメントを作成し、フォルダおよびファイル名を付けて保存します(<a href="#The_OGS_File_Extension">OGSという拡張子</a>になります)。
</p>
<h2><a name="The_OGS_File_Extension"></a><span class="mw-headline">OGSファイルの拡張子</span></h2>
<p>LabTalkスクリプトは、ファイルに保存でき、どんな拡張子でも構いませんが、 <span class="OIndex">OGS</span> という拡張子が標準のもので、柔軟性が高くなります。ですので、<b>OGSファイル</b>を使うことをお勧めします。  ファイルシステムのアクセス可能なフォルダにスクリプトファイルを保存できますが、特定の位置にするといくつかの利点があります。  OGSファイルが<span class="OIndex">User Filesフォルダ</span>にある場合、スクリプトを実行する際に、<a href="#Setting_the_Path">パス</a>を指定する必要はありません。
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/From_Files/Tip_icon.png" width="57"  border="0" /></td><td><p>OGSファイルは、ファイルとしてディスクに保存するのではなく、Originプロジェクト(OPJ)に付加することができます。  ファイルはコードビルダの<b>Project</b> ノードに追加することができ、プロジェクトと一緒に保存できます。保存の際には、ユーザフォルダからファイルをドラッグし、プロジェクトフォルダにドロップします。このように接続されたOGSファイル内のスクリプトのセクションをファイル内のセクションを呼び出すのと同様、 <a href="../../LabTalk/LabTalk/Run_(object).html#Methods:" title="LabTalk:Run (オブジェクト)"><b>run.section()</b> オブジェクトメソッド</a> を使って呼び出すことができます。Originは最初にプロジェクト内のファイルを探すので、ファイル名だけを指定する必要があります。プロジェクトに接続したファイルとセクションが見つかったらコードを実行します。 
</p></td></tr></table>
<h2><a name="Sections_in_an_OGS_FileSectionScript_Section"></a><span class="mw-headline">OGSファイル内のセクション</span></h2>
<p>コードがモジュール方式で書かれていると、スクリプトの実行は分かりやすく、デバッグもしやすくなります。  モジュールスクリプトをサポートするため、LabTalkスクリプトファイルをセクションに分割します。セクションは各括弧[ ]の中にセクション名を付けて宣言します。
</p>
<dl><dd><font color="navy">[<i>SectionName</i>]</font></dd></dl>
<p>セクション宣言の下のスクリプト行がそのセクションに属します。セクション内のLabTalkスクリプトは、別のセクション宣言が見つかったとき、returnステートメントが実行されたとき、コマンドエラーが発生したときに終了します。通常、複数のセクションを持つOGSファイルのフレームワークは次のようなものです。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">[</span>Main<span style="color: #000000;">]</span>
<span style="color: #008000;">// スクリプト行</span>
ty In section Main;
&nbsp;
<span style="color: #000000;">[</span>Section <span style="color: #0000dd;">1</span><span style="color: #000000;">]</span>
<span style="color: #008000;">// スクリプト行</span>
ty In section <span style="color: #0000dd;">1</span>;
&nbsp;
<span style="color: #000000;">[</span>Section <span style="color: #0000dd;">2</span><span style="color: #000000;">]</span>
<span style="color: #008000;">// スクリプト行</span>
ty In section <span style="color: #0000dd;">2</span>;</pre>
<p>ここで、<b>ty</b> は <b>type</b> コマンドのことで、文字&apos;ty&apos;で始まるコマンドが他に存在しない場合、このように省略することができます。
</p>
<h2><a name="Running_an_OGS_File"></a><span class="mw-headline">OGSファイルを実行する</span></h2>
<p><span class="OIndex" style="display:none">OGSファイルを実行する</span>
</p><p>スクリプトファイルの実行には<a href="../../LabTalk/LabTalk/Run_(object).html" title="LabTalk:Run (オブジェクト)"><b>run</b> オブジェクト</a> を使用します。
</p>
<dl><dd><i><a href="../../LabTalk/LabTalk/Run_(object).html" title="LabTalk:Run (オブジェクト)">run.section(OGSFileName, SectionName[,arg1 arg2 ... arg5])</a></i> </dd></dl>
<dl><dd><i><a href="../../LabTalk/LabTalk/Run_(object).html" title="LabTalk:Run (オブジェクト)">run.file(OGSFileName)</a></i> </dd></dl>
<table class="note">

<tr>
<td><b>重要な注意点：</b>
<p>以前の<a href="../../LabTalk/LabTalk/OGSFileName_(command).html" title="LabTalk:OGSFileName (コマンド)"><b>コマンド</b>オブジェクト</a>または<a href="../../LabTalk/LabTalk/Run_(command).html#no_option.3B_Run_the_script_file_scriptfileName" title="LabTalk:Run (コマンド)"><b>run</b>コマンド</a>メソッドより堅牢なので、<b>run.file()</b> や <b>run.section()</b>メソッドを使用してLabTalkOGSファイルを実行することを<i>強くお勧め</i>します。
</p><p><a href="../../LabTalk/LabTalk/Run_(object).html" title="LabTalk:Run (オブジェクト)"><b>run</b>オブジェクト</a>を使用するときに、OGSファイルがユーザファイルフォルダにある場合は、ファイルへのパスを指定する必要はありません。UFFのサブフォルダにある場合は、相対パスを使用します。UFF外にある場合は、フルパスでファイルを指定します。
</p>
</td></tr></table>
<p><br />
つまり、<b>test.ogs</b> ファイルを呼び出すファイルがユーザファイルフォルダにある場合
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// run.section() シンタックスを使って、test.ogsの section1 のみ実行</span>
run.<span style="color: #000080;">section</span><span style="color: #000000;">(</span>test, section1<span style="color: #000000;">)</span></pre>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// run.file()構文を使用してtest.ogsを実行:</span>
run.<span style="color: #000080;">file</span><span style="color: #000000;">(</span>test<span style="color: #000000;">)</span></pre>
<h2><a name="Passing_Arguments_in_ScriptsArgument.2C_Script_FilePass_Arguments_in_Script"></a><span class="mw-headline">スクリプトに引数を渡す</span></h2>
<p><b><a href="../../LabTalk/LabTalk/Run_(object).html" title="LabTalk:Run (オブジェクト)">run.section()</a></b> オブジェクトメソッドを使って、スクリプトファイル(またはそのセクションの1つ)またはマクロを呼び出すとき、引数を渡すことができます。  引数は、テキスト、数値、数値変数、文字列変数のいずれかです。  
</p><p>引数をスクリプトファイルセクションやマクロに引き渡す際
</p>
<ul><li>セクションやマクロの呼び出しで、引数と引数の間はスペースで区切る必要があります。run.sectionを使う場合、カンマは、最初の引数からセクション名を区切ります。</li></ul>
<ul><li>引数がテキスト、あるいは文字列変数の場合、個々の引数は(内容が1語以上、又は負の数の場合)2重引用符で囲まれている必要があります。  数値や数値変数を引き渡す場合は、値が負の数の時を除いて、2重引用符で囲む必要はありません。 </li></ul>
<ul><li>スクリプトファイルセクションやマクロに引き渡せる引数の数は、<b>スペース</b>で区切った5つまでです。引き渡された引数は、スクリプトファイルセクション、または、マクロの定義内の引数の受け渡し変数に置かれます。  引数の受け渡し変数には%1,%2,%3,%4,%5があります。最初に引き渡された引数は%1に、2番目の引数は%2に、といった要領で、<span class="OIndex">割当て</span>が行なわれます。受け渡し変数は文字列変数と同じような働きをします。つまり、これらの変数は、埋め込まれているコマンドの実行前に置換されます。引き渡された引数の数は<i>macro.narg</i> に登録されます。</li></ul>
<p>文字列を%1, %2, などが受け取る引数として渡すサンプルです。TEST.OGSファイルには次のセクションが含まれます。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">[</span>output<span style="color: #000000;">]</span>
type <span style="color: #ff00ff;">&quot;%1 %2 %3&quot;</span>;</pre>
<p>次のスクリプトを実行したとします。
</p>
<pre class="lt" style="font-family:monospace;">run.<span style="color: #000080;">section</span><span style="color: #000000;">(</span>test.<span style="color: #000080;">ogs</span>, output, <span style="color: #ff00ff;">&quot;Hello World&quot;</span> from LabTalk<span style="color: #000000;">)</span>;</pre>
<p>ここで、%1には&quot;Hello World&quot;、%2には&quot;from&quot;、%3には&quot;LabTalk&quot;が、引き渡たされます。  文字列の置換後、typeコマンドによってスクリプトウィンドウに出力されます。 
</p>
<pre class="lt" style="font-family:monospace;">Hello World from LabTalk</pre>
<p>をスクリプトウィンドウに出力します。  もし、スクリプトファイルセクション呼び出し内で、2重引用符が省略されると、%1に&quot;Hello&quot;,%2に&quot;World&quot;,%3に&quot;from&quot;が受け渡されてしまい、Hello World fromとなり、  Originは次のように出力します。 
</p>
<pre class="lt" style="font-family:monospace;">Hello World from</pre>
<h3><a name="Passing_Numeric_Variables_by_ReferencePass_Variables_by_Reference"></a><span class="mw-headline">数値変数の参照による引き渡し</span></h3>
<p>数値変数引数の参照による引き渡しは、スクリプトファイルセクションやマクロの中から、元の変数の値の変更を可能にします。  
</p><p>例えば、あるアプリケーションで<b>LastRow</b>という変数が、値を含む列B内の最後の行番号を保持しているものとします。  更に、現在の<b>LastRow</b>の値が10だとします。  列Bに5つの値を（現在の最後の行に）追加するようなスクリプトファイルセクションに、変数<b>LastRow</b>を引き渡したとします。値の追加後、スクリプトファイルセクションによって、変数<b>LastRow</b>の値を増やして、<b>LastRow</b>の値を15に更新することができます。  
</p><p>サンプル:
</p><p>つまり、TEST.OGSが次のようなadddataセクションを含んでいるとします。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">[</span>adddata<span style="color: #000000;">]</span>	
	loop <span style="color: #000000;">(</span>n, <span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">5</span><span style="color: #000000;">)</span>
	<span style="color: #000000;">{</span>
	    <span style="color: #000080;">%</span>1<span style="color: #000000;">[</span><span style="color: #000080;">%</span>2 <span style="color: #000080;">+</span> n<span style="color: #000000;">]</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">100</span>;
	<span style="color: #000000;">}</span>;
	<span style="color: #000080;">%</span>2 <span style="color: #000080;">=</span> <span style="color: #000080;">%</span>2 <span style="color: #000080;">+</span> <span style="color: #000000;">(</span>n <span style="color: #000080;">-</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>;
	return <span style="color: #0000dd;">0</span>;</pre>
<p>次に以下のスクリプトを実行するとします。
</p>
<pre class="lt" style="font-family:monospace;">col<span style="color: #000000;">(</span>b<span style="color: #000000;">)</span> <span style="color: #000080;">=</span> data<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">10</span><span style="color: #000000;">)</span>;   <span style="color: #008000;">// データ1_b を値で埋める</span>
get col<span style="color: #000000;">(</span>b<span style="color: #000000;">)</span> <span style="color: #000080;">-</span>e lastrow;  <span style="color: #008000;">// lastrowに最後の行の値を入れる</span>
run.<span style="color: #000080;">section</span><span style="color: #000000;">(</span>test.<span style="color: #000080;">ogs</span>, adddata, col<span style="color: #000000;">(</span>b<span style="color: #000000;">)</span> lastrow<span style="color: #000000;">)</span>;
lastrow <span style="color: #000080;">=</span>&nbsp;;</pre>
<p>変数<b>LastRow</b>は参照によって引き渡され、値に15を持つように更新されます。
</p>
<h3><a name="Passing_Numeric_Variables_by_ValuePass_Variables_by_Value"></a><span class="mw-headline">数値変数の値による引き渡し</span></h3>
<p>数値変数引数の値による引き渡しは、<a href="../../LabTalk/LabTalk/Numeric_to_String_Conversion.html" title="LabTalk:数値から文字列への変換">置換表記$()</a>を使って行われます。  この表記法は、引数をスクリプトファイルセクション、又はマクロに引き渡す前に、インタープリタに引数の評価を強制します。  この引き渡しのテクニックは、計算の結果値を変更せずそのまま後で使うような場合に有効です。  それに引き換え、引数が<a href="#Passing_Numeric_Variables_by_ReferencePass_Variables_by_Reference">参照</a>によって引き渡されると、式が解釈される度に、式全体が計算されます。
</p><p>次のスクリプトファイルのサンプルでは、数値変数 <i>var</i> が参照および値で渡されます。%1は、参照で渡される引数を保持し、%2は値で渡される引数を保持します。更に、2語からなる文字列変数(%A)も1つの引数として%3に引き渡されています。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">[</span>typing<span style="color: #000000;">]</span>
	type <span style="color: #000080;">-</span>b <span style="color: #ff00ff;">&quot;The value of&nbsp;%1 =&nbsp;%2&nbsp;%3&quot;</span>;
	return <span style="color: #0000dd;">0</span>;</pre>
<p>セクションを<i>Test.OGS</i>に保存し、コマンドウィンドウで次のスクリプトを実行します。
</p>
<pre class="lt" style="font-family:monospace;">var <span style="color: #000080;">=</span> <span style="color: #0000dd;">22</span>;
<span style="color: #000080;">%</span>A <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;degrees Celsius&quot;</span>;
run.<span style="color: #000080;">section</span><span style="color: #000000;">(</span>test.<span style="color: #000080;">ogs</span>, typing, var <span style="color: #000080;">$</span><span style="color: #000000;">(</span>var<span style="color: #000000;">)</span> <span style="color: #ff00ff;">&quot;%A&quot;</span><span style="color: #000000;">)</span>;</pre>
<p>すると、&quot;The value of var = 22 degrees Celsius&quot;と表示したダイアログが開きます。
</p>
<h2><a name="Guidelines_for_Naming_OGS_Files_and_Sections"></a><span class="mw-headline">OGSファイルとセクションの名前のガイドライン</span></h2>
<p>OGSスクリプトファイルの命名規則は、その呼び出し方によって異なります。  上記のセクションでは、2つの方法を説明しています。<b>run.section()</b> メソッドまたは<b>command</b>メソッドを使った呼び出しとスクリプトまたはコマンドウィンドウからの呼び出し (<b>コマンド</b> による方法)です。
</p>
<h3><a name="When_Using_the_Run.section.28.29_Method"></a><span class="mw-headline"><a href="../../LabTalk/LabTalk/Run_(object).html" title="LabTalk:Run (オブジェクト)">Run.section() </a>メソッドを使うとき</span></h3>
<ul><li> OGSファイルの名前に使用する文字の種類や長さには制限がありません。</li>
<li> OGSという拡張子を持つファイルに対し、ファイルの拡張子の指定は任意です。</li>
<li> OGSファイル内でrun.section( )を使って同じOGSファイルの別のセクションを呼び出すとき、ファイル名を省略できます。例えば</li></ul>
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">[</span>main<span style="color: #000000;">]</span>
run.<span style="color: #000080;">section</span><span style="color: #000000;">(</span> , calculate<span style="color: #000000;">)</span>;

<span style="color: #000000;">[</span>calculate<span style="color: #000000;">]</span>
cc <span style="color: #000080;">=</span> aa <span style="color: #000080;">+</span> bb;</pre>
<h3><a name="When_Using_the_Command_Method"></a><span class="mw-headline">コマンドによる方法を使うとき</span></h3>
<ul><li> OGSファイルの名前は、コマンド名の制限準拠している必要があります。制限とは、25文字以下で、数字または特殊文字で始まらず、スペースまたはアンダースコア文字を含めない、というものです。</li>
<li> ファイル名の拡張子はOGSに<i>しなければならず</i>、指定する<i>必要はありません</i>。</li></ul>
<h3><a name="Section_Name_Rules_.28When_Using_Either_Method.29"></a><span class="mw-headline">セクション名の規則(どちらかの方法を使うとき)</span></h3>
<ul><li> セクション名が省略されているとき</li></ul>
<dl><dd><ol><li> Originは <b>[Main]</b> というセクションを探し、それが見つかると実行します。</li>
<li> <b>[Main]</b>セクションが見つからず、セクションの名前のないファイルの最初にコードがある場合は、そのコードを実行します。</li>
<li> 何もない場合には、Originは何も実行せずエラーも出ません。</li></ol></dd></dl>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/From_Files/Tip_icon.png" width="57"  border="0" /></td><td><p>OGSファイルは、既存の<a href="../../LabTalk/Category/Alphabetical_Listing_of_Functions_(LabTalk).html" title="Category:アルファベット順関数の一覧 (LabTalk)">Originの関数</a> や <a class="external text" href="../../XFunction/X-Function/Alphabetic_List_to_X-Functions.html">Xファンクション</a>と同じ名前にすることはできません。
</p></td></tr></table>
<h2><a name="Setting_the_Path"></a><span class="mw-headline">パスを設定する</span></h2>
<p>Origin7.5では、スクリプトファイル（.OGS）はOriginシステムとUser Filesフォルダの両方から実行できました。これがデフォルトで<span class="OIndex">現在の作業フォルダ</span>にあたります。スクリプトファイルがそこにあれば、<span class="OIndex">パス</span>を変更する必要はありません。しかし、スクリプトファイルが、これら2つのフォルダのどちらにも存在しない場合、 <a href="../../LabTalk/LabTalk/Run_(object).html#Methods:" title="LabTalk:Run (オブジェクト)">run.section()オブジェクトメソッド</a> フルパスで指定する必要がありました。Origin 8以降、<span class="OIndex">現在の作業フォルダ</span>(CWF)という考えが導入され、選択したCWFの場所で、スクリプトファイルやXファンクションを実行することができます。
</p><p>MS-DOSでの慣習にならい、Originでも <a class="external text" href="../../XFunction/X-Function/Cd.html">cd</a> Xファンクションを使ってCWFを表示することができます。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// このコマンドを入力し、スクリプトウィンドウに </span>
<span style="color: #008000;">//現在の作業フォルダを表示</span>
cd</pre>
<p>デフォルトから変更されていない限り、出力は以下のようなディレクトリです。
</p>
<pre>
現ワーキングディレクトリ:
C:\Documents and Settings\User\My Documents\OriginLab\Origin8.1\User Files\ 
</pre>
<p>しかし、多くのスクリプトを書いていると、ファイルをフォルダ内に統合し、そのファイルが存在する場所からスクリプトを呼び出します。  また、Originはそれぞれのディレクトリから実行できるサンプルスクリプトを提供しています。
</p><p>run.section( )スクリプトがUser Filesフォルダのサブフォルダにある場合、相対リファレンスを使う事ができます。例えば、
</p>
<pre class="lt" style="font-family:monospace;">run.<span style="color: #000080;">section</span><span style="color: #000000;">(</span>subfolder1\scriptA,main<span style="color: #000000;">)</span>; <span style="color: #008000;">// ScriptA.ogs は subfolder1にある</span>
run.<span style="color: #000080;">section</span><span style="color: #000000;">(</span>subfolder2\scriptA,main<span style="color: #000000;">)</span>; <span style="color: #008000;">// ScriptA.ogs は subfolder2にある</span></pre>
<p>スクリプトを使用して、現在の作業フォルダをセットできます。  例えば、Originのシステムサブフォルダ<b>Samples\LabTalk Script Examples</b>にある、<b>ave_curves.ogs</b>というOGSファイルを実行するために、次のスクリプトを実行します。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 文字列変数を作成し、目的のスクリプトファイルに</span>
<span style="color: #008000;">//Originのシステムパスにフォルダのパスを追加して</span>
<span style="color: #008000;">// 完全なパスを保持する 
</span>
path<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\LabTalk Script Examples\&quot;</span>;
<span style="color: #008000;">// 目的のパスを現在の作業フォルダに設定</span>
cd path<span style="color: #000080;">$</span>;
<span style="color: #008000;">// 関数を呼び出す</span>
ave_curves;</pre>
<p>事前定義のパスのセットを作成できます。<a class="external text" href="../../XFunction/X-Function/Cdset.html">cdset</a> Xファンクションは、事前定義したパスを全てリストし、CWFを追加/削除することができます。次のように入力します。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//  &apos;cdset&apos; コマンドはスクリプトウィンドウに </span>
<span style="color: #008000;">//事前定義のパスを表示</span>
cdset</pre>
<p>まだ変更していないならば、以下のようなパスが表示されます。
</p>
<pre>
1 = C:\Documents and Settings\User\My Documents\OriginLab\Origin8.1\User Files\
2 = C:\Program Files\OriginLab\Origin81\Samples\LabTalk Script Examples\
3 = C:\Program Files\OriginLab\Origin81\ 
</pre>
<p>上記の2番目のパスをCWFにセットするには、次のように入力します。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// CWFを事前定義パス2に変更</span>
cd <span style="color: #0000dd;">2</span></pre>
<p>事前定義してあるフォルダセットに、新しいパスを追加するには、新しいパスを変更し、次に<b>cdset</b> Xファンクションを特定のインデックスでセットします。例えば、
</p>
<pre class="lt" style="font-family:monospace;">cd D<span style="color: #000000;">:</span>\Files\Filetype\Script;  <span style="color: #008000;">// このパスを CWFとしてセット</span>
<span style="color: #008000;">// このパスを事前定義リスト4番目の位置（index 4）に追加</span>
<span style="color: #008000;">// 既にindex 4がある場合、上書き</span>
cdset <span style="color: #0000dd;">4</span>;
<span style="color: #008000;">// CWFが手動で変更された場合、次のように再セット可能</span>
<span style="color: #008000;">// &apos;cd 4&apos;と入力する事で以下のように再セット可能　&apos;D:\Files\Filetype\Script\&apos; </span></pre>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/From_Files/Tip_icon.png" width="57"  border="0" /></td><td><p><b>cdset</b> コマンドの操作については、知っておくと便利なポイントがいくつかあります。
</p>
<ul><li> あるプロジェクトで事前定義パスに新しいパスを追加すると、それは保存され、別のプロジェクトでも使用できます。  </li>
<li> 現在のパスをスクリプトウィンドウに表示するには、スクリプトウィンドウで &apos;cdset&apos; と入力します。</li>
<li> 最大9つまでのパスを定義することができます。</li>
<li> インデックス番号を自分で割り当てることはできません。</li>
<li> 現在のパスが存在しているインデックスに新しいパスを割り当てると、現在のパスが上書きされます。</li></ul>
</td></tr></table>
<p>上記で記載された3つの事前定義パスで、2つ目は複数のスクリプトのファイルを有します（拡張子<b>OGS</b>）。DOSと同じように、<i>cd 2</i>でこのフォルダに移動できます。有効なOGSの確認には<a class="external text" href="../../XFunction/X-Function/Dir.html">dir</a> Xファンクションを使う事ができます。そして使用可能なスクリプトを実行します。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 2番目のフォルダを CWFとしてセット</span>
cd <span style="color: #0000dd;">2</span>;
<span style="color: #008000;">// CWF内の全ての ogsとXファンクションをリスト</span>
dir;
<span style="color: #008000;">// スクリプトファイルの実行</span>
<span style="color: #008000;">// 呼び出す時にファイルの拡張子は必要ない</span>
autofit;</pre>
<p>また、 <a href="../../LabTalk/LabTalk/Ed_(object).html" title="LabTalk:Ed (オブジェクト)">ed.open()</a>メソッドを使用すると、CWFのスクリプトファイルをコードビルダにロードできます。例えば、次のようになります。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// この場合、ファイル名のOGS拡張子が必要です</span>
ed.<span style="color: #000080;">open</span><span style="color: #000000;">(</span>pick_bad_data.<span style="color: #000080;">ogs</span><span style="color: #000000;">)</span></pre>
<h2><a name="Running_LabTalk_from_Origin_C"></a><span class="mw-headline">Origin CからLabTalkを実行する</span></h2>
<p>.OGSファイルを直接実行するだけでなく、LabTalkコマンドおよびスクリプトはOrigin Cから実行することもできます。詳細については、Origin Cヘルプファイルの <a class="external text" href="../../OriginC/Category/LabTalk_Interface_(global_function).html">LabTalkインターフェース</a> のグローバル関数をご覧ください。
</p>


    