<h1 class="firstheading">ワークシートの基本操作</h1><p class='urlname' style='display: none'>Worksheet-Basic-Operation</p>
<p>ワークブックへのシート追加や、ワークシートのアクティブ化、ワークシートプロパティの設定、ワークシート削除などが基本的なワークシート操作に含まれます。これらの操作は、<a href="../../LabTalk/Script/LabTalk-Supported_X-Functions.html#Data_Manipulation" title="スクリプト：LabTalkがサポートするX-FUnction">データ操作用のXファンクション</a>とあわせ、<a href="../../LabTalk/LabTalk/Page_(object).html" title="LabTalk:Page(オブジェクト)">Page </a>および <a href="../../LabTalk/LabTalk/Wks_(object).html" title="LabTalk:Wks(オブジェクト)">Wks</a> オブジェクトを使用して実行します。以下にいくつか実践的なサンプルがあります。
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Add_New_Worksheet"><span class="tocnumber">1</span> <span class="toctext">新しいワークシートを追加する </span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Activate_a_Worksheet"><span class="tocnumber">2</span> <span class="toctext">ワークシートをアクティブにする</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Modify_Worksheet_Properties"><span class="tocnumber">3</span> <span class="toctext">ワークシートプロパティを修正する</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Using_Worksheet_Object"><span class="tocnumber">3.1</span> <span class="toctext">ワークシートオブジェクトを使う</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Using_X-Functions"><span class="tocnumber">3.2</span> <span class="toctext">Xファンクションを使う</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Delete_Worksheet"><span class="tocnumber">4</span> <span class="toctext">ワークシートを削除する</span></a></li>
</ul>
</div>

<h2><a name="Add_New_Worksheet"></a><span class="mw-headline">新しいワークシートを追加する</span></h2>
<p><a class="external text" href="../../XFunction/X-Function/Newsheet.html">newsheet </a>Xファンクションは、新しいシートを追加するのに使います。
</p>
<pre class="lt" style="font-family:monospace;">// 3つのワークシートを持つワークブックを作成 
<span style="color: #008000;">// そしてロングネームとショートネームを&quot;mydata&quot;にする</span>
newbook name<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;mydata&quot;</span> sheet<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span> option<span style="color: #000000;">:</span><span style="color: #000080;">=</span>lsname;
<span style="color: #008000;">// 4列持つ &quot;source&quot; という名前のシートを現在のワークブックに追加</span>
newsheet name<span style="color: #000000;">:</span><span style="color: #000080;">=</span>source cols<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span>;</pre>
<h2><a name="Activate_a_Worksheet"></a><span class="mw-headline">ワークシートをアクティブにする</span></h2>
<p><a href="../../LabTalk/Category/LT_Workbooks.html" title="Category：LT ワークブック">ワークブック</a>はOriginのオブジェクトで列を含むワークシートで構成されています。 
ブック内のワークシートは、<a href="../../LabTalk/LabTalk/Page_(object).html" title="LabTalk:Page (オブジェクト)">page</a>にある内部的なレイヤです。言い換えれば、ワークシートはレイヤオブジェクトから派生し、ワークブックはページオブジェクトから派生したものです。ページのアクティブレイヤは、<i>page.active</i> または <i>page.active$</i> プロパティで表され、ワークシートをアクティブにするのに使用されます。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 4つのワークシートをもつ新たなブックを作成</span>
newbook sheet<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span>;
&nbsp;
page.<span style="color: #000080;">active</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;	<span style="color: #008000;">// インデックスでワークシートをアクティブ</span>
page.<span style="color: #000080;">active</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> sheet3;	<span style="color: #008000;">// 名前でワークシートをアクティブ</span></pre>
<h2><a name="Modify_Worksheet_Properties"></a><span class="mw-headline">ワークシートプロパティを修正する</span></h2>
<h4><a name="Using_Worksheet_Object"></a><span class="mw-headline">ワークシートオブジェクトを使う</span></h4>
<p>ワークシートがアクティブなとき、<b>wks.=</b> と入力し、Enterキーを押して、すべての<a href="../../LabTalk/LabTalk/Wks_(object).html" title="LabTalk:Wks(オブジェクト)">ワークシートプロパティ</a>を一覧表示します。これらのプロパティのほとんどは書き込み可能で、直接修正することができます。例えば、
<span class="OIndex" style="display:none">ワークシート名変更</span>
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// ワークシートの名前を変更</span>
wks.<span style="color: #000080;">name</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Raw Data;
<span style="color: #008000;">// 列の数を4にセット</span>
wks.<span style="color: #000080;">ncols</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">4</span>;
<span style="color: #008000;">// 列幅を8文字に修正</span>
wks.<span style="color: #000080;">colwidth</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">8</span>;
<span style="color: #008000;">// ワークシートヘッダの最初のユーザ定義パラメータを表示</span>
wks.<span style="color: #000080;">userparam1</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;</pre>
<p>wks.maxRows と wks.nRows の2つのプロパティは似ています。前者は、ワークシート内で値がある最も大きな行インデックス、後者はワークシートの行数の読み書きを行います。次のスクリプトで違いを見ることができます。
</p>
<pre class="lt" style="font-family:monospace;">newbook;  <span style="color: #008000;">// 新しいワークブックを作成</span>
col<span style="color: #000000;">(</span>b<span style="color: #000000;">)</span> <span style="color: #000080;">=</span> <span style="color: #000000;">{</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">10</span><span style="color: #000000;">}</span>;  <span style="color: #008000;">// 列Bの第1セルから10セルまでに、1から10を入力</span>
wks.<span style="color: #000080;">maxRows</span> <span style="color: #000080;">=</span>&nbsp;;
wks.<span style="color: #000080;">nRows</span> <span style="color: #000080;">=</span>&nbsp;;</pre>
<p>Originは、wks.maxRowsに対して10を出力し、wks.nRowsに対しては32を出力します。
</p><p>もし、ワークシートがアクティブではない場合、<b>wks</b>オブジェクトの前に、ワークシート名（またはワークブック名）を指定するために以下のシンタックスを使用します。
</p><p><b>[<i>WorkbookName</i>]<i>WorksheetNameOrIndex</i>!wks</b>
</p><p>または、ワークシートのrange変数を使用できます。例えば
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// プロジェクトを開く</span>
string strOpj<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span>;
strOpj<span style="color: #000080;">$</span> <span style="color: #000080;">+</span><span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Samples\COM Server and Client\Basic Stats on Data.opj&quot;</span>;
doc <span style="color: #000080;">-</span>o <span style="color: #000080;">%</span><span style="color: #000000;">(</span>strOpj<span style="color: #000080;">$</span><span style="color: #000000;">)</span>;

wks.<span style="color: #000080;">nCols</span> <span style="color: #000080;">=</span>&nbsp;;  <span style="color: #008000;">// アクティブなワークシートの列数を出力</span>
<span style="color: #008000;">// ワークシート[RawData]Data!の列数を出力</span>
<span style="color: #000000;">[</span>RawData<span style="color: #000000;">]</span>Data<span style="color: #000080;">!</span>wks.<span style="color: #000080;">nCols</span> <span style="color: #000080;">=</span>&nbsp;;  
<span style="color: #008000;">// RawDataワークブックの第1ワークシートの名前を出力</span>
<span style="color: #000000;">[</span>RawData<span style="color: #000000;">]</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span>wks.<span style="color: #000080;">name</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span>&nbsp;;  
&nbsp;
<span style="color: #008000;">// rangeを使用</span>
range rWks <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>RawData<span style="color: #000000;">]</span>Data<span style="color: #000080;">!</span>;  <span style="color: #008000;">// RawDataワークブックのDataシートのためのrange変数</span>
rWks.<span style="color: #000080;">userparam1</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;  <span style="color: #008000;">// ワークシートの第一ユーザパラメータを表示</span></pre>
<h4><a name="Using_X-Functions"></a><span class="mw-headline">Xファンクションを使う</span></h4>
<p><a href="../../LabTalk/LabTalk/Wks_(object).html" title="LabTalk:Wks(オブジェクト)">wksオブジェクト</a>以外に、Xファンクションを使って、ワークシートプロパティを修正することができます。これらのXファンクションの名前は、通常、&quot;w&quot;で始まります。<a class="external text" href="../../XFunction/X-Function/Wcolwidth.html">wcolwidth</a>, <a class="external text" href="../../XFunction/X-Function/Wcellformat.html">wcellformat</a>, <a class="external text" href="../../XFunction/X-Function/Wclear.html">wclear</a>などになります。wks.colwidthを使わずに、下記のように列のサイズを変更することもできます。
</p>
<pre class="lt" style="font-family:monospace;">wcolwidth <span style="color: #0000dd;">2</span> <span style="color: #0000dd;">10</span>; <span style="color: #008000;">// 2番目の列幅を10にセット</span></pre>
<h2><a name="Delete_Worksheet"></a><span class="mw-headline">ワークシートを削除する</span></h2>
<p><b><a href="../../LabTalk/LabTalk/Layer_(command).html#-d.3B_delete_the_active_layer" title="LabTalk:Layer (コマンド)">layer -d</a></b> コマンドは、ワークシートまたはグラフレイヤを削除するのに使用します。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 6つのワークシートをもつワークブックを作成し、</span>
<span style="color: #008000;">// ワークブック名をMyBook$とする</span>
<span style="color: #008000;">// 最初のワークシートがアクティブになる</span>
newbook sheet<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">6</span> result<span style="color: #000000;">:</span><span style="color: #000080;">=</span>MyBook<span style="color: #000080;">$</span>;
&nbsp;
<span style="color: #008000;">// 新しくワークシートを作成し、名前を &quot;My Sheet&quot;とする</span>
newsheet name<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;My Sheet&quot;</span>;
&nbsp;
page.<span style="color: #000080;">active</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;  <span style="color: #008000;">// 最初のワークシートをアクティブにする</span>
layer <span style="color: #000080;">-</span>d;  <span style="color: #008000;">// アクティブワークシートの削除</span>
&nbsp;
<span style="color: #008000;">// インデックスによるワークシートの削除</span>
<span style="color: #008000;">// アクティブワークブック（またはグラフ）内の3番目のシート（またはレイヤ）を削除</span>
layer <span style="color: #000080;">-</span>d <span style="color: #0000dd;">3</span>;
&nbsp;
<span style="color: #008000;">// ワークシート名で削除</span>
layer <span style="color: #000080;">-</span>d <span style="color: #ff00ff;">&quot;Sheet5&quot;</span>;
&nbsp;
<span style="color: #008000;">// rangeによる特定ワークシートの削除</span>
range rs <span style="color: #000080;">=</span> <span style="color: #000000;">[</span><span style="color: #000080;">%</span><span style="color: #000000;">(</span>MyBook<span style="color: #000080;">$</span><span style="color: #000000;">)</span><span style="color: #000000;">]</span><span style="color: #ff00ff;">&quot;My Sheet&quot;</span><span style="color: #000080;">!</span>;  <span style="color: #008000;">// 特定シートのrangeを定義</span>
layer <span style="color: #000080;">-</span>d rs;
&nbsp;
<span style="color: #008000;">// 文字列変数に保存された名称のワークシートの削除</span>
string strSheet<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Sheet3&quot;</span>;
layer <span style="color: #000080;">-</span>d <span style="color: #000080;">%</span><span style="color: #000000;">(</span>strSheet<span style="color: #000080;">$</span><span style="color: #000000;">)</span>;</pre>
<p>文字列変数として保存された名称のワークシートを削除するには、
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//__report$ にはOriginが作成した最後のレポートシートの名前を保持</span>
layer <span style="color: #000080;">-</span>d <span style="color: #000080;">%</span><span style="color: #000000;">(</span>__report<span style="color: #000080;">$</span><span style="color: #000000;">)</span>;</pre>
<p>変数 <b>__report$</b> は、特定のオブジェクトの最後に使ったインスタンスを記録するシステム作成の文字列変数の例です。このような変数の一覧は、<a href="../../LabTalk/LabTalk/Last_Used_System_Variables.html" title="LabTalk:最後に使ったシステム変数">リファレンステーブル</a>にあります。
</p>






    