<h1 class="firstheading">仮想行列</h1><p class='urlname' style='display: none'>Virtual-Matrix</p>
<p>ワークシートセルのグループとして配置されたデータを行列として扱うことができ、3D曲面, 3D棒グラフ, 等高線などのさまざまなプロットをこのようなデータから作成できます。この機能については、「仮想行列」を参照してください。XおよびY座標の値は、任意で最初の列と最初の行のデータブロックに含めることができます。行はワークシートのヘッダ行にすることができます。 
</p><p>Origin内の行列オブジェクトはXY座標の線形マッピングのみをサポートしていますが、仮想行列は非線形または不等間隔のXY座標をサポートしています。
</p><p>ワークシートにあるデータを使ってプロットを作成するとき、仮想行列が定義されます。<a class="external text" href="../../XFunction/X-Function/Plotvm.html">plotvm</a> Xファンクションを使ってプロットを作成します。
</p><p>次のサンプルは、Xファンクションplot_vmの使用例です。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 新しいワークブックを作成し、サンプルデータをインポート</span>
newbook;
string fname<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Graphing\VSurface 1.dat&quot;</span>;
impasc;
<span style="color: #008000;">// シート全体を仮想行列として扱い、カラーマップ曲面を作成</span>
plotvm irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span> format<span style="color: #000000;">:</span><span style="color: #000080;">=</span>xacross rowpos<span style="color: #000000;">:</span><span style="color: #000080;">=</span>selrow1 colpos<span style="color: #000000;">:</span><span style="color: #000080;">=</span>selcol1
 ztitle<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;VSurface 1&quot;</span> type<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">242</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>new template<span style="color: #000000;">:</span><span style="color: #000080;">=</span>cmap<span style="color: #000080;">&gt;</span>;
<span style="color: #008000;">// X軸スケールを対数に変更</span>
layer.<span style="color: #000080;">x</span>.<span style="color: #000080;">type</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>;</pre>







    