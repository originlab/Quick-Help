<h1 class="firstheading">グラフのエクスポート</h1><p class='urlname' style='display: none'>Exporting-Graphs</p>
<p>LabTalkから呼ばれる <a class="external text" href="../../XFunction/X-Function/ExpGraph.html"><b>expGraph</b></a> Xファンクションを使ってグラフをエクスポートする3つのサンプルです。
</p>
<h2><a name="Export_a_Graph_with_Specific_Width_and_Resolution_.28DPI.29"></a><span class="mw-headline">幅と解像度(DPI)を指定してグラフをエクスポート</span></h2>
<p><b>expGraph</b> Xファンクションを使うとグラフを<span class="OIndex">画像</span>としてエクスポートできます。  イメージサイズのオプションは<b>tr1</b>というツリー変数のノードに保存され、解像度のオプション(すべてのラスター画像に対して)は、<b>tr2</b>というツリー変数のノードに保存されます。
</p><p>一般的なアプリケーションは、画像の幅と<span class="OIndex">解像度</span>の<i>両方</i>を指定して、希望の画像形式にグラフをエクスポートします。  例えば、グラフを高解像度(1200<span class="OIndex">DPI</span>)の3.2インチ幅の*.tifファイルと指定された2段組の刊行物を考えます。 
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// アクティブグラフウィンドウをD:\TestImages\TEST.TIFにエクスポート</span>
<span style="color: #008000;">// 幅 = 3.2インチ, 解像度 = 1200 DPI</span>
&nbsp;
expGraph type<span style="color: #000000;">:</span><span style="color: #000080;">=</span>tif path<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;D:\TestImages&quot;</span> filename<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;TEST&quot;</span> 
	 tr1.<span style="color: #000080;">unit</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>
	 tr1.<span style="color: #000080;">width</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3.2</span>
	 tr2.<span style="color: #000080;">tif</span>.<span style="color: #000080;">dotsperinch</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1200</span>;</pre>
<p>tr1.unitの利用可能な値
</p>
<ul><li> 0 = インチ </li>
<li> 1 = cm </li>
<li> 2 = ピクセル </li>
<li> 3 = ページの比</li></ul>
<p><b>Note</b>: これは特定の出力タイプを指定するためにツリー構造に保存されているデータにアクセスする良い例です。  <a class="external text" href="../../UserGuide/UserGuide/The_Export_Graph_Dialog_Box.html#Image_Size"><b>tr1</b>の説明</a>は製品のオンラインヘルプにあります。 
</p>
<h2><a name="Exporting_All_Graphs_in_the_Project"></a><span class="mw-headline">プロジェクト内のすべてのグラフをエクスポートする</span></h2>
<p>プロジェクト内の指定したすべてのオブジェクトをループする <a href="../../LabTalk/LabTalk/Document_(command).html" title="LabTalk:Document (コマンド)"><b>doc -e</b> コマンド</a>と<b>expGraph</b> Xファンクションを組み合わせて使用すれば、Originプロジェクトからすべてのグラフをエクスポートすることができます。  
</p><p>例えば、現在のプロジェクトのすべてのグラフをビットマップ(BMP)にエクスポートするには
</p>
<pre class="lt" style="font-family:monospace;">doc <span style="color: #000080;">-</span>e P
<span style="color: #000000;">{</span>
  <span style="color: #008000;">// %Hはアクティブウィンドウ名を保持する文字列レジスタ</span>
  expGraph type<span style="color: #000000;">:</span><span style="color: #000080;">=</span>bmp path<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;d:\TestImages&quot;</span> filename<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000080;">%</span>H 
           tr1.<span style="color: #000080;">unit</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>  
           tr1.<span style="color: #000080;">width</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">640</span>;
<span style="color: #000000;">}</span></pre>  
<p><b>doc -e</b> のいくつかのサンプルを見ると <a href="../../LabTalk/Script/Looping_Over_Objects.html" title="Script:オブジェクトのループ">オブジェクト間をループ</a>しているのが分かります。
</p>
<h2><a name="Exporting_Graph_with_Path_and_File_Name"></a><span class="mw-headline">パスとファイル名を付けてグラフをエクスポートする</span></h2>
<p><a href="../../LabTalk/LabTalk/String_registers.html" title="LabTalk:文字列レジスタ">文字列レジスタ</a>, %G と %Xは、現在のプロジェクトファイル名とパスを保持しています。<a href="../../LabTalk/LabTalk/Label_(command).html" title="LabTalk:Label (コマンド)">label コマンド</a>と組み合わせて、グラフのエクスポート時にこれらの情報をページ内に配置することができます。例えば、
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// プロジェクトのパス</span>
string proPath<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Graphing\Multi-Curve Graphs.opj&quot;</span>;
<span style="color: #008000;">// プロジェクトを開く</span>
doc <span style="color: #000080;">-</span>o <span style="color: #000080;">%</span><span style="color: #000000;">(</span>proPath<span style="color: #000080;">$</span><span style="color: #000000;">)</span>;
<span style="color: #008000;">// グラフにファイルパスと名前を追加</span>
win <span style="color: #000080;">-</span>a Graph1;
label <span style="color: #000080;">-</span>s <span style="color: #000080;">-</span>px <span style="color: #0000dd;">0</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">-</span>n ForPrintOnly \v<span style="color: #000000;">(</span><span style="color: #000080;">%</span>X<span style="color: #000080;">%</span>G.<span style="color: #000080;">opj</span><span style="color: #000000;">)</span>;
<span style="color: #008000;">// グラフをドライブ Dにエクスポート</span>
expGraph type<span style="color: #000000;">:</span><span style="color: #000080;">=</span>png filename<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000080;">%</span>H path<span style="color: #000000;">:</span><span style="color: #000080;">=</span>D<span style="color: #000000;">:</span>\;
<span style="color: #008000;">// ファイルパスと名前を削除 </span>
label <span style="color: #000080;">-</span>r ForPrintOnly;</pre>







    