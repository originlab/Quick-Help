<h1 class="firstheading">Xファンクション概要</h1><p class='urlname' style='display: none'>XFs-Overview</p>
<p><span class="OIndex">Xファンクション</span>は、LabTalkスクリプトからOriginの機能のほとんどすべてを同じ方法で利用することができます。  Xファンクションを使う最も良い方法は、Xファンクションを使う多くのサンプルを利用することです。スクリプトからアクセスできるXファンクションの一覧は<a href="../../LabTalk/Script/LabTalk-Supported_X-Functions.html" title="Script:LabTalkがサポートするXファンクション">LabTalkでサポートしているXファンクション</a>のセクションにあります。
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Syntax"><span class="tocnumber">1</span> <span class="toctext">シンタックス</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Examples"><span class="tocnumber">2</span> <span class="toctext">サンプル</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Follow_the_argument_order_and_explicitly_write_argument_names"><span class="tocnumber">2.1</span> <span class="toctext">引数の順序に従い引数名を明示的に記述</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Argument_names_can_be_skipped_if_following_the_argument_order"><span class="tocnumber">2.2</span> <span class="toctext">引数の順序に従う場合引数名はスキップ可能</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Explicitly_write_argument_names_so_no_need_to_follow_argument_order"><span class="tocnumber">2.3</span> <span class="toctext">明示的な引数名の場合引数の順序に従わずに記述可能</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Partly_follow_argument_order"><span class="tocnumber">2.4</span> <span class="toctext">部分的に引数の順序に従う</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Argument_names_shortened_as_long_as_it.27s_unique_in_the_argument_list"><span class="tocnumber">2.5</span> <span class="toctext">引数リスト内で一意である限り引数名は短縮可能</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Write_the_X-Function_call_in_multi-lines"><span class="tocnumber">2.6</span> <span class="toctext">複数行でXファンクションの呼び出しを記述</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-9"><a href="#Option_Switches"><span class="tocnumber">3</span> <span class="toctext">オプションスイッチ</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#Generate_Script_from_Dialog_Settings"><span class="tocnumber">4</span> <span class="toctext">ダイアログ設定からスクリプトを生成</span></a></li>
</ul>
</div>

<h2><a name="Syntax"></a><span class="mw-headline">シンタックス</span></h2>
<p>スクリプト例のXファンクションは、その独特の構文で認識できます。
</p><p>xFunctionName [argument1:=&lt;range,name or value&gt; argument2:=&lt;range,name or value&gt; ...][ -switch];
</p><p><b>一般的な注意点</b>:
</p>
<ul><li> 引数は入力、出力、または必要なパラメータです。</li>
<li> 複数の入力、出力、パラメータが存在する場合があります。</li>
<li> 通常、各引数にはデフォルト値があるため、Xファンクションは引数のサブセットを使用して呼び出すことができます。</li></ul>
<p><br />
<b><span class="OIndex">Xファンクション引数の順序</span>に関する注意<span class="OIndex HasShownIndex" style="display:none">Argument Order</span></b>:
</p>
<ul><li> Xファンクションはデフォルトで、その入力と出力の引数が特定の順序で入力されます。<b>X-Function -h</b> を実行してヘルプを表示します。</li>
<li> Originの指定順序で引数が指定された場合、引数名を入力する必要はありません。  </li>
<li> 引数名を明示的に入力する場合、任意の順序で引数を指定できます。 </li>
<li> 省略された引数が指定された順序で最初に来て、その後に任意の順序で明示的に入力された引数が続くのであれば、引数の処理を混在させることができます。</li>
<li> 引数名は、引数名の後ろにある文字をトリミングして短縮可能ですが、短縮名は固有である必要があります。</li></ul>
<p>次のサンプルは、<b>fitpoly</b> Xファンクションを使って、これらについて説明しています。
</p>
<h2><a name="Examples"></a><span class="mw-headline">サンプル</span></h2>
<p>xfunctionname -hvを実行して引数と順序を確認します。
</p>
<pre class="lt" style="font-family:monospace;">fitpoly <span style="color: #000080;">-</span>hv; <span style="color: #008000;">//全変数を表示</span>
Variables<span style="color: #000000;">:</span>
  iy<span style="color: #000000;">:</span> <span style="color: #000000;">[</span>in<span style="color: #000000;">]</span> 
  polyorder<span style="color: #000000;">:</span> <span style="color: #000000;">[</span>in<span style="color: #000000;">]</span> 
  fixint<span style="color: #000000;">:</span> <span style="color: #000000;">[</span>in<span style="color: #000000;">]</span> 
  intercept<span style="color: #000000;">:</span> <span style="color: #000000;">[</span>in<span style="color: #000000;">]</span> 
  coef<span style="color: #000000;">:</span> <span style="color: #000000;">[</span>out<span style="color: #000000;">]</span> 
  oy<span style="color: #000000;">:</span> <span style="color: #000000;">[</span>out<span style="color: #000000;">]</span> 
  N<span style="color: #000000;">:</span> <span style="color: #000000;">[</span>out<span style="color: #000000;">]</span> 
  AdjRSq<span style="color: #000000;">:</span> <span style="color: #000000;">[</span>out<span style="color: #000000;">]</span> 
  RSqCOD<span style="color: #000000;">:</span> <span style="color: #000000;">[</span>out<span style="color: #000000;">]</span> 
  err<span style="color: #000000;">:</span> <span style="color: #000000;">[</span>out<span style="color: #000000;">]</span></pre>
<p>fitpolyを呼び出すときに、Originは変数セクションにリストされている引数を待ちます。
</p><p><b>fitpoly iy:=<i>XYrange</i> polyorder:=<i>int</i> fixint:=<i>int</i> intercept:=<i>double</i> coef:=<i>vector</i> oy:=<i>XYRange</i> N:=<i>int</i> adjRSq:=<i>double</i> RSqCOD:=<i>double</i> err:=<i>vector</i>;</b>

</p>
<h3><a name="Follow_the_argument_order_and_explicitly_write_argument_names"></a><span class="mw-headline">引数の順序に従い引数名を明示的に記述</span></h3>
<pre class="lt" style="font-family:monospace;">fitpoly iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">)</span> polyorder<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span> fixint<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> intercept<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> coef<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span> oy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">(</span><span style="color: #0000dd;">4</span>,<span style="color: #0000dd;">5</span><span style="color: #000000;">)</span> N<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">100</span> AdjRSq<span style="color: #000000;">:</span><span style="color: #000080;">=</span>adjr2 RSqCOD<span style="color: #000000;">:</span><span style="color: #000080;">=</span>cod err<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">6</span>;</pre>
<p>これはOriginに以下の指示をします。 
</p>
<dl><dd><ul><li> iy:=(1,2) - XYデータをフィット (Xはアクティブシートの列1、Yはアクティブシートの列2) </li>
<li> polyorder:=4 - 4次 </li>
<li> fixint:=0 - 切片固定なし </li>
<li> intercept:=0 - 切片ｎの初期値は0 </li>
<li> coef:=3 - アクティブシートの3列目に座標を配置 </li>
<li> oy:=(4,5) - フィット後のXYデータを配置 (xはアクティブシートの列4、Yはアクティブシートの列5) </li>
<li> N:=100 -  出力XYデータのポイント数は100</li>
<li> AdjRSq:=adjr2 - 計算されたAdjRSq値は変数adjr2に置く </li>
<li> RSqCOD:=cod - 計算されたRSqCOD値は変数codに置く </li>
<li> err:=6 - 多項式係数エラーをアクティブシートの列6に置く</li></ul></dd></dl>
<h3><a name="Argument_names_can_be_skipped_if_following_the_argument_order"></a><span class="mw-headline">引数の順序に従う場合引数名はスキップ可能</span></h3>
<pre class="lt" style="font-family:monospace;">fitpoly <span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">)</span> <span style="color: #0000dd;">4</span> <span style="color: #0000dd;">0</span> <span style="color: #0000dd;">0</span> <span style="color: #0000dd;">3</span> <span style="color: #000000;">(</span><span style="color: #0000dd;">4</span>,<span style="color: #0000dd;">5</span><span style="color: #000000;">)</span> <span style="color: #0000dd;">100</span> adjr2 cod <span style="color: #0000dd;">6</span>;</pre>
<p>それぞれの値は対応する引数に割り当てられます。例えば、(1,2)は<i>iy</i>に、4は<i>polyorder</i>のように割り当てられます。(1,2)のように括弧内の値は一つの引数に割り当てられます。
</p>
<h3><a name="Explicitly_write_argument_names_so_no_need_to_follow_argument_order"></a><span class="mw-headline">明示的な引数名の場合引数の順序に従わずに記述可能</span></h3>
<pre class="lt" style="font-family:monospace;">fitpoly coef<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span> N<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">100</span> polyorder<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span> oy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">(</span><span style="color: #0000dd;">4</span>,<span style="color: #0000dd;">5</span><span style="color: #000000;">)</span> iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">)</span>;</pre>
<p>リストされていない引数については、Xファンクションで定義されたデフォルトの値が使用されます。例えば、
</p>
<dl><dd><ul><li> 切片は固定せず0で開始</li>
<li> AdjRSq、RSqCOD、多項式係数エラーは出力しない</li></ul></dd></dl>
<h3><a name="Partly_follow_argument_order"></a><span class="mw-headline">部分的に引数の順序に従う</span></h3>
<pre class="lt" style="font-family:monospace;">fitpoly <span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">)</span> <span style="color: #0000dd;">4</span> oy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">(</span><span style="color: #0000dd;">4</span>,<span style="color: #0000dd;">5</span><span style="color: #000000;">)</span> N<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">100</span> coef<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span>;</pre>
<p>最初の2つの引数は定義された順序に従うため、引数名はスキップします。そのあとの引数は明示的に記述してランダムに記述します。引数がリストされていない場青、デフォルト値を使用します。
</p>
<h3><a name="Argument_names_shortened_as_long_as_it.27s_unique_in_the_argument_list"></a><span class="mw-headline">引数リスト内で一意である限り引数名は短縮可能</span></h3>
<p>以下のコードでは、<b>poly</b> は<b> polyorder</b> 、<b>co</b> は<b> coef</b>、<b>o</b> は <b>oy</b>の短縮形です。これらは全て一意です。
</p>
<pre class="lt" style="font-family:monospace;">fitpoly iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">)</span> poly<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span> co<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span> o<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">(</span><span style="color: #0000dd;">4</span>,<span style="color: #0000dd;">5</span><span style="color: #000000;">)</span> N<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">100</span>;</pre>
<p><br />
次の例では、<b>i</b> から始まる2つの引数(<b>iy</b> と <b>intercept</b>) があるため、エラーになります。Originは、<b>i</b>がどの引数であるか判断できません。
</p>
<pre class="lt" style="font-family:monospace;">fitpoly i<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">)</span> poly<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span> co<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span> o<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">(</span><span style="color: #0000dd;">4</span>,<span style="color: #0000dd;">5</span><span style="color: #000000;">)</span> N<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">100</span>;</pre>
<h3><a name="Write_the_X-Function_call_in_multi-lines"></a><span class="mw-headline">複数行でXファンクションの呼び出しを記述</span></h3>
<pre class="lt" style="font-family:monospace;">fitpoly 
coef<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span> 
N<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">100</span> 
polyorder<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span> 
oy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">(</span><span style="color: #0000dd;">4</span>,<span style="color: #0000dd;">5</span><span style="color: #000000;">)</span> 
iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">)</span>;</pre>
<p>Xfannkusyonn 呼び出しは、引数名が明示的に入力されている場合複数行で記述できます。
</p>
<h2><a name="Option_Switches"></a><span class="mw-headline">オプションスイッチ</span></h2>
<p><b>-h</b> や <b>-d</b> のような<span class="OIndex">オプションスイッチ</span>は、スクリプトからXファンクションを実行する代替のモードにアクセスします。  これらは、ほかの引数の有無にかかわらず使用できます。  オプションスイッチ (および該当する場合はその値) は、引数リストのどこにでも配置できます。  表では、Xファンクションの主要なオプションスイッチをまとめています。
</p>
<table class="simple">
<tr>
<th>名前
</th>
<th>関数
</th></tr>
<tr>
<td> -h
</td>
<td> スクリプトウィンドウにヘルプファイルの内容を出力
</td></tr>
<tr>
<td> -e
</td>
<td> XファンクションビルダでXファンクションを表示して定義内容を確認
</td></tr>
<tr>
<td> -d
</td>
<td> パラメータ入力のためにグラフィカルユーザインタフェースダイアログを開く
</td></tr>
<tr>
<td> -s
</td>
<td> サイレントモードで実行。結果は結果ログに送られない
</td></tr>
<tr>
<td> -t &lt;<i>themeName</i>&gt;
</td>
<td> 事前保存テーマを使用
</td></tr>
<tr>
<td> -r &lt;<i>value</i>&gt;
</td>
<td> 再計算モードを設定し、入力が変更した場合の出力を手動/自動で更新
</td></tr></table>
<p>オプションスイッチについての詳細は、<a href="../../LabTalk/LabTalk/X-Function_Execution_Options.html" title="LabTalk:Xファンクションの実行オプション">Xファンクションの実行オプション</a>をご覧下さい。 
</p><p><br />
</p>
<h2><a name="Generate_Script_from_Dialog_Settings"></a><span class="mw-headline">ダイアログ設定からスクリプトを生成</span></h2>
<p>Ｘファンクションを呼ぶ最も簡単な方法は、 <i>-d</i> オプションを使い、ユーザインターフェース(GUI)を使ってその設定を行うことです。
</p><p>GUIで、ダイアログ設定が行われると、ダイアログテーマのフライアウトメニューの<b>スクリプトを生成</b> を選んで、設定に対応するLabTalkスクリプトを生成することができます。現在のGUI設定に合致するスクリプトがスクリプトウィンドウに出力され、それをバッチ用のOGSファイル、または他のプロジェクトにコピー＆ペーストすることができます。
</p><p><b>Note:</b> <b>ダイアログテーマ</b>ボックスと、対応する<b>スクリプトの生成</b>フライアウトメニューは、<i>-d</i> オプションで開く全てのXファンクションダイアログで利用可能ではありません。例えば、<b>rnormalize -d</b>では利用できますが、<b>fitpoly -d</b>では利用できません。
</p>






    