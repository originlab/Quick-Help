<h1 class="firstheading">ワークブックの基本操作</h1><p>ワークブックは<a href="../../LabTalk/LabTalk/Page_(object).html" title="LabTalk:Page (オブジェクト)">Page</a>オブジェクトと <a href="../../LabTalk/LabTalk/Window_(command).html" title="LabTalk:Window (コマンド)">Window</a>コマンドで操作できます。また、<a href="../../LabTalk/Script/LabTalk-Supported_X-Functions.html#Data_Manipulation" title="スクリプト：LabTalkがサポートするX-FUnction">データ操作用のXファンクション</a>を使うこともできます。これらのツールを使用すると、新しいワークブックの作成、ワークブックの複製、ワークブックをテンプレートとして保存等を行えます。実践的なサンプルは以下の通りです。
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>目次</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Create_New_Workbook"><span class="tocnumber">1</span> <span class="toctext">新しいワークブックを作成する</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Open_Workbook"><span class="tocnumber">2</span> <span class="toctext">ワークブックを開く</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Save_Workbook"><span class="tocnumber">3</span> <span class="toctext">ワークブックを保存する</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Close_Workbook"><span class="tocnumber">4</span> <span class="toctext">ワークブックを閉じる</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Show_or_Hide_Workbook"><span class="tocnumber">5</span> <span class="toctext">ワークブックの表示と非表示</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Name_and_Label_Workbook"><span class="tocnumber">6</span> <span class="toctext">ワークブックに名前とラベルを付ける</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Activate_Workbook"><span class="tocnumber">7</span> <span class="toctext">ワークブックをアクティブにする</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Delete_Workbook"><span class="tocnumber">8</span> <span class="toctext">ワークブックを削除する</span></a></li>
</ul>
</div>

<h2><a name="Create_New_Workbook"></a><span class="mw-headline">新しいワークブックを作成する</span></h2>
<p><a class="external text" href="../../XFunction/X-Function/Newbook.html">newbook</a>  Xファンクションを使うと、新しいワークブックを作成できます。このXファンクションの引数として、新たに作成するワークブックのロングネーム、シート数、使用するテンプレート、非表示にするか等を選択できます。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//ロングネーム&quot;MyResultBook&quot;の新しいワークブックを作成</span>
newbook MyResultBook;
&nbsp;
<span style="color: #008000;">// 3つのワークシートを持つ新しいワークブックを作成</span>
<span style="color: #008000;">// ロングネームとショートネームに &quot;MyData&quot; を使用</span>
newbook name<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;MyData&quot;</span> sheet<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span> option<span style="color: #000000;">:</span><span style="color: #000080;">=</span>lsname;
&nbsp;
<span style="color: #008000;">// 非表示の新しいワークブックを作成</span>
<span style="color: #008000;">// ワークブックの名前は myBkName$ 変数に格納</span>
newbook hidden<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> result<span style="color: #000000;">:</span><span style="color: #000080;">=</span>myBkName<span style="color: #000080;">$</span>;
<span style="color: #008000;">// ワークブック名を出力</span>
myBkName<span style="color: #000080;">$</span> <span style="color: #000080;">=</span>&nbsp;;
&nbsp;
<span style="color: #008000;">// デフォルトでは、ビルトインテンプレートである&quot;Origin&quot;が使われる</span>
<span style="color: #008000;">// 新しいワークブックを作成すると特定のテンプレートを使用可能</span>
<span style="color: #008000;">// XYZ テンプレートを使用して、新しいワークブックを作成</span>
newbook template<span style="color: #000000;">:</span><span style="color: #000080;">=</span>XYZ;</pre>
<p><a href="../../LabTalk/LabTalk/Window_(command).html#-ti.3B_Create_a_minimized_new_window_from_the_template_file" title="LabTalk:Window (コマンド)">win -ti</a>コマンドはテンプレートファイルから最小化した新しいワークブックを作成できます。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//  FFT テンプレートを使用して新しいワークブックを作成</span>
<span style="color: #008000;">// ロングネームとショートネームを MyFFT に設定し、最小化</span>
win <span style="color: #000080;">-</span>ti wks FFT MyFFT;</pre>
<h2><a name="Open_Workbook"></a><span class="mw-headline">ワークブックを開く</span></h2>
<p>ワークブックのデータが拡張子ogwのファイルとして保存されている場合、<a href="../../LabTalk/LabTalk/Document_(command).html#-o_projectName.3B_Open_a_project" title="LabTalk:Document (コマンド)">doc -o</a>コマンドで開く事ができます。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 開くワークブックのパス</span>
string strName<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span>;
strName<span style="color: #000080;">$</span> <span style="color: #000080;">+</span><span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Samples\Graphing\Automobile Data.ogw&quot;</span>;
<span style="color: #008000;">// ワークブックを開く</span>
doc <span style="color: #000080;">-</span>o <span style="color: #000080;">%</span><span style="color: #000000;">(</span>strName<span style="color: #000080;">$</span><span style="color: #000000;">)</span>;</pre>
<h2><a name="Save_Workbook"></a><span class="mw-headline">ワークブックを保存する</span></h2>
<p>Originはワークブックのデータをファイル（拡張子 .ogw）として保存、データなしのテンプレートで保存（拡張子 .otw）、分析を行ったワークブックに関しては分析テンプレート（拡張子 .ogw）として保存できます。
</p>
<ol>
<li><a href="../../LabTalk/LabTalk/Save_(command).html#-i.3B_Save_the_active_worksheet.2C_graph.2C_or_matrix_window_to_a_file" title="LabTalk:Save (コマンド)">save -i</a>コマンドはアクティブなワークブックをogwファイルとして保存できます。
</li>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 新しいワークブックを作成</span>
newbook;
<span style="color: #008000;">// col(1)に適当なデータを入力</span>
col<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span> <span style="color: #000080;">=</span> uniform<span style="color: #000000;">(</span><span style="color: #0000dd;">32</span><span style="color: #000000;">)</span>;
<span style="color: #008000;">// このデータ付きのワークブックをUser Filesフォルダ内にMyData.ogw として保存</span>
save <span style="color: #000080;">-</span>i <span style="color: #000080;">%</span>YMyData.<span style="color: #000080;">ogw</span>;</pre>
<li><a class="external text" href="../../XFunction/X-Function/Template_saveas.html">template_saveas</a> Xファンクションはワークブックをテンプレートとして保存する時に使用します。
</li>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 3つのシートを持った新しいワークブックを作成</span>
newbook sheet<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span>;
<span style="color: #008000;">// このワークブックをテンプレートとしてMy3SheetsBookという名前で</span>
<span style="color: #008000;">// User Filesフォルダ（デフォルト）に保存</span>
template_saveas template<span style="color: #000000;">:</span><span style="color: #000080;">=</span>My3SheetsBook;</pre>
<li>行った分析と共にワークブックを保存するには、<a href="../../LabTalk/LabTalk/Save_(command).html#-ik.3B_Save_the_active_workbook_as_an_analysis_template" title="LabTalk:Save (コマンド)">save -ik</a>を使用します。
</li>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// プロジェクトを作成</span>
string strOpj<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Analysis.opj&quot;</span>;
doc <span style="color: #000080;">-</span>o <span style="color: #000080;">%</span><span style="color: #000000;">(</span>strOpj<span style="color: #000080;">$</span><span style="color: #000000;">)</span>;

<span style="color: #008000;">// 分析テンプレートとしてワークブックを保存するためワークブックをアクティブに</span>
win <span style="color: #000080;">-</span>a Book1J;

<span style="color: #008000;">// このワークブックを分析テンプレートとして</span>
<span style="color: #008000;">// MyAnalysis.ogw というファイル名でUser Filesフォルダに保存</span>
save <span style="color: #000080;">-</span>ik <span style="color: #000080;">%</span>YMyAnalysis.<span style="color: #000080;">ogw</span>;</pre>
</ol>
<h2><a name="Close_Workbook"></a><span class="mw-headline">ワークブックを閉じる</span></h2>
<p>ワークブックを閉じるには、ワークブックの右上にある閉じるボタンをクリックするだけです。この挙動は<a href="../../LabTalk/LabTalk/Window_(command).html#-ca.3B_Close_the_winName_window" title="LabTalk:Window (コマンド)">win -ca</a>コマンドで実行でき、ダイアログがポップアップしてユーザに削除か非表示を選択するように求めます。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// ワークブックを作成し、名前は変数MyBook$ に格納</span>
newbook result<span style="color: #000000;">:</span><span style="color: #000080;">=</span>MyBook<span style="color: #000080;">$</span>;
&nbsp;
<span style="color: #008000;">// 閉じるボタンをクリックする様子をシミュレートする</span>
win <span style="color: #000080;">-</span>ca <span style="color: #000080;">%</span><span style="color: #000000;">(</span>MyBook<span style="color: #000080;">$</span><span style="color: #000000;">)</span>;</pre>
<p>ポップアップをせずにワークブックを閉じて全てのデータを削除するには<a href="../../LabTalk/LabTalk/Window_(command).html#-cd.3B_Close_the_workbook_and_delete_all_the_data" title="LabTalk:Window (コマンド)">win -cd</a>コマンドを使用できます。この操作は以下にある<a href="../../LabTalk/Script/Basic_Workbook_Operation.html#Delete_Workbook" title="Script: ワークブックの基本操作">ワークブックを削除する</a>項目と同じです。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 閉じるために新しいワークブックを作成</span>
newbook;
&nbsp;
<span style="color: #008000;">// ポップアップなしでワークブックを閉じて全てのデータを削除</span>
win <span style="color: #000080;">-</span>cd <span style="color: #000080;">%</span>H;</pre>
<h2><a name="Show_or_Hide_Workbook"></a><span class="mw-headline">ワークブックの表示と非表示</span></h2>
<p><a href="../../LabTalk/LabTalk/Window_(command).html" title="LabTalk:Window (コマンド)">win</a>コマンドには3つのスイッチ（ <i>-ch</i>, <i>-h</i>, <i>-hc</i>） があり、ワークブックの表示と非表示を切り替える事ができます。 
</p>
<pre class="lt" style="font-family:monospace;">// 非表示にするために3つのワークブックを作成
newbook name:=MyBook1 option:=lsname;  // 1番目のワークブック、 MyBook1
newbook name:=MyBook2 option:=lsname;  // 2つ目のワークブック、MyBook2
newbook name:<span style="color: #008000;">=</span>MyBook3 option<span style="color: #000000;">:</span><span style="color: #000080;">=</span>lsname;  <span style="color: #000000;">// 3つ目のワークブック、 MyBook3;</span>
&nbsp;
<span style="color: #000080;">//  -chを使ってアクティブなワークブック、MyBook3を非表示にする</span>
<span style="color: #008000;">// プロジェクト・エクスプローラの表示モードは非表示</span>
win <span style="color: #000000;">-</span>ch <span style="color: #000080;">1</span>;
&nbsp;
<span style="color: #000000;">// -hc を使用して1番目のワークブック（アクティブではありません）// MyBook1を非表示にする</span>
<span style="color: #000080;">// プロジェクト・エクスプローラの表示モードは非表示</span>
win <span style="color: #008000;">-</span>hc <span style="color: #000000;">1</span> MyBook1;
&nbsp;
<span style="color: #000080;">// -h を選択して2番目のワークブック（アクティブなワークブック）// MyBook2を非表示にする</span>
<span style="color: #000000;">// プロジェクト・エクスプローラの表示モードはまだ通常通り</span>
win <span style="color: #000080;">-</span>h <span style="color: #008000;">1</span>;
&nbsp;
<span style="color: #008000;">// 実際、 MyBook2 はまだアクティブなワークブックなので、</span>
<span style="color: #008000;">// 以下のようにすると表示可能</span>
win <span style="color: #000080;">-</span>h <span style="color: #0000dd;">0</span>;
&nbsp;
<span style="color: #008000;">// MyBook1 と MyBook3を表示するには、-hcスイッチを使用して、</span>
<span style="color: #008000;">// ワークブック名を指定する必要がある</span>
win <span style="color: #000080;">-</span>hc <span style="color: #0000dd;">0</span> MyBook1;
win <span style="color: #008000;">-</span>hc <span style="color: #008000;">0</span> MyBook3;</pre>
<h2><a name="Name_and_Label_Workbook"></a><span class="mw-headline">ワークブックに名前とラベルを付ける</span></h2>
<p>ワークブックにはショートネーム、ロングネーム、コメントがあります。ワークブックの名前（ショートネーム）を変更するには<a href="../../LabTalk/LabTalk/Window_(command).html#-r.3B_Rename_windowName_with_the_given_newName" title="LabTalk:Window (コマンド)">win -r</a>コマンドを使用し、<a href="../../LabTalk/LabTalk/Page_(object).html" title="LabTalk:Page(オブジェクト)">page</a>オブジェクトを使用すると、ワークブックのタイトル（ショートネーム、ロングネーム、両方）表示を含む、ロングネームとコメントを制御できます。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// &quot;Data&quot;と名前がつけた新しいワークブックを作成</span>
<span style="color: #008000;">// 両方の名前をタイトルに表示</span>
<span style="color: #008000;">// ショートネームとロングネームは同じです</span>
<span style="color: #008000;">// ワークブックのタイトルはショートネームのみを表示</span>
newbook name<span style="color: #000000;">:</span><span style="color: #000080;">=</span>Data option<span style="color: #000000;">:</span><span style="color: #000080;">=</span>lsname;
&nbsp;
<span style="color: #008000;">// ワークブックの名前を&quot;RawData&quot;に変更</span>
win <span style="color: #000080;">-</span>r Data RawData;
&nbsp;
<span style="color: #008000;">// ロングネームを &quot;FFT Data&quot;に変更</span>
page.<span style="color: #000080;">longname</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;FFT Data&quot;</span>;
<span style="color: #008000;">// コメント&quot;1st group data for fft&quot;を追加</span>
page.<span style="color: #000080;">comments</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;1st group data for fft&quot;</span>;
&nbsp;
<span style="color: #008000;">// ワークブックのタイトルにロングネームのみを表示するように変更</span>
page.<span style="color: #000080;">title</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;  <span style="color: #008000;">// 1 = ロングネーム、 2 = ショートネーム、3 = 両方</span></pre>
<h2><a name="Activate_Workbook"></a><span class="mw-headline">ワークブックをアクティブにする</span></h2>
<p>ワークブックをアクティブにするには、<a href="../../LabTalk/LabTalk/Window_(command).html#-a.3B_Set_winName_as_the_active_window" title="LabTalk:Window (コマンド)">win -a</a>を使用します。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 開くプロジェクトのパスを表示</span>
string strOpj<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span>;
strOpj<span style="color: #000080;">$</span> <span style="color: #000080;">+</span><span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Samples\Curve Fitting\Intro_to_Nonlinear_Curve_Fit_Tool.opj&quot;</span>;
<span style="color: #008000;">// プロジェクトを開く</span>
doc <span style="color: #000080;">-</span>o <span style="color: #000080;">%</span><span style="color: #000000;">(</span>strOpj<span style="color: #000080;">$</span><span style="color: #000000;">)</span>;
&nbsp;
<span style="color: #008000;">// プロジェクトの2番目のサブフォルダにあるBook1をアクティブにする</span>
win <span style="color: #000080;">-</span>a Book1;
&nbsp;
<span style="color: #008000;">// ワークブック名を変数に入れる事も可能</span>
<span style="color: #008000;">// プロジェクトにワークブック Gaussian の名前を入れる</span>
string strGau<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Gaussian;
<span style="color: #008000;">// 1番目のサブフォルダにあるGauusianワークブックをアクティブにする</span>
win <span style="color: #000080;">-</span>a <span style="color: #000080;">%</span><span style="color: #000000;">(</span>strGau<span style="color: #000080;">$</span><span style="color: #000000;">)</span>;</pre>
<p>ほとんどのOriginコマンドはアクティブウィンドウに対して操作しますので、 <i>win -a</i> コマンドを使って、ワークブックをアクティブにし、スクリプトを実行するとアクティブなワークブックになると思い、実行する事もあるでしょう。これは、簡単なコードで動作しますが、長いスクリプトに対しては、タイミングの問題があるかもしれません。代わりに、 <a href="../../LabTalk/LabTalk/Window_(command).html#-o.3B_Execute_the_specified_script_for_the_named_window" title="LabTalk:Window (コマンド)">window -o <i>winName</i> {<i>script</i>}</a> を使うことをお勧めします。詳細は、<a href="../../LabTalk/Category/LT_Running_Scripts.html" title="カテゴリー:LT スクリプトの実行">スクリプトが操作するオブジェクトについての注意</a>をご覧下さい。
</p>
<h2><a name="Delete_Workbook"></a><span class="mw-headline">ワークブックを削除する</span></h2>
<p>ワークブックを削除するには<a href="../../LabTalk/LabTalk/Window_(command).html#-c.3B_Delete_the_winName_window" title="LabTalk:Window (コマンド)">win -c</a>コマンドを使用します。このコマンドはポップアップを表示せずに、直接ウィンドウを削除します。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// プロジェクトを開くパス</span>
string strOpj<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Curve Fitting\2D Bin and Fit.opj&quot;</span>;
<span style="color: #008000;">// プロジェクトを開く</span>
doc <span style="color: #000080;">-</span>o <span style="color: #000080;">%</span><span style="color: #000000;">(</span>strOpj<span style="color: #000080;">$</span><span style="color: #000000;">)</span>;
<span style="color: #008000;">// ワークブックBook1 プロジェクトから削除</span>
win <span style="color: #000080;">-</span>c Book1;
&nbsp;
<span style="color: #008000;">// アクティブなワークブックを削除する場合、ワークブック名は無視可能</span>
<span style="color: #008000;">// または、&nbsp;%H を使用してワークブック名を参照</span>
win <span style="color: #000080;">-</span>a MatrixFit1;  <span style="color: #008000;">// ワークブックMatrixFit1 をアクティブにする</span>
win <span style="color: #000080;">-</span>c;  <span style="color: #008000;">// ワークブックを削除</span>
<span style="color: #008000;">// または、次を使用</span>
<span style="color: #008000;">// win -c&nbsp;%H;</span>
&nbsp;
<span style="color: #008000;">// これは、変数にワークブック名が格納されているワークブックも削除可能</span>
<span style="color: #008000;">// newbook X-Function を使用して新しいワークブックを作成</span>
<span style="color: #008000;">// このワークブックの名前は文字列変数 ToDel$ に格納される</span>
newbook result<span style="color: #000000;">:</span><span style="color: #000080;">=</span>ToDel<span style="color: #000080;">$</span>;
<span style="color: #008000;">// いま作成したワークブックを削除</span>
win <span style="color: #000080;">-</span>c <span style="color: #000080;">%</span><span style="color: #000000;">(</span>ToDel<span style="color: #000080;">$</span><span style="color: #000000;">)</span>;</pre>







    