<h1 class="firstheading">行列のエクスポート</h1><p class='urlname' style='display: none'>行列のエクスポート</p>
<p>Originの行列には、数値データだけでなく、画像データを保存することができます。  実際、Origin内の<i>すべての</i> 画像は、行列で保存され、図はピクセルデータで表示されます。  <span class="OIndex">行列</span>は、保持している内容に関係なくエクスポートできます。
</p><p>スクリプトを使用した行列のエクスポートは、非画像行列の場合は<b>expMatAsc</b>、画像行列の場合は<b>expImage</b>の2つのXファンクションを使用して実行されます。
</p>
<h2><a name="Exporting_a_Non-Image_Matrix"></a><span class="mw-headline">画像でない行列のエクスポート</span></h2>
<p>画像でない行列をASCIIファイルにエクスポートするには、 <a class="external text" href="../../XFunction/X-Function/ExpMatASC.html"><b>expMatAsc</b> Xファンクション</a>を使います。  エクスポートする際の拡張子は、*.dat (type:=0), *.txt (type:=1), *.csv (type:=2), すべての種類 (type:=3)を利用できます。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// XYグリッディングを有効にしてTEST.CSV という名前の *.csv 形式の </span>
<span style="color: #008000;">// ファイルに行列 (Matrix Book 1のMatrix Sheet 1) をエクスポート</span>

expMatASC im<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span>MBook1<span style="color: #000000;">]</span>MSheet1 type<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span> path<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;D:\TEST.CSV&quot;</span> xygrid<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;</pre>
<p><a href="../../LabTalk/LabTalk/Export.html#Export_Data" title="LabTalk:エクスポート">より詳しいデータエクスポートの例</a>については、<b>グラフ/データ/ビデオ のエクスポート</b>のページをご覧ください。
</p>
<h2><a name="Exporting_an_Image_Matrix"></a><span class="mw-headline">画像の行列のエクスポート</span></h2>
<p>Originの行列ウィンドウには、複数シートを含めることができ、各シートには複数の行列オブジェクトを含めることができます。  行列オブジェクトはRGB値(デフォルト、1つの行列セルに3つの数字を持つ、各行列セルはピクセルに対応)またはグレースケールデータ(各行列セルには1つのグレースケール値)の画像を含めることができます。 
</p><p>例えば、画像を行列オブジェクト(RGB値として)にインポートして、後で、<b>イメージ</b>メニューを使って、グレースケールデータ(例えば、グレースケールのピクセル値)に変換できます 。  行列オブジェクトにRGB値またはグレースケールデータが含まれていれば、 <a class="external text" href="../../XFunction/X-Function/ExpImage.html"><b>expImage</b> Xファンクション</a>を使って、行列の内容を画像ファイルにエクスポートできます。  例えば、次のスクリプトコマンドは、行列ブックMBook 1のSheet1の最初の行列オブジェクトをエクスポートします。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 画像行列を *.tif 画像としてエクスポート</span>
expImage im<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span>MBook1<span style="color: #000000;">]</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #0000dd;">1</span> type<span style="color: #000000;">:</span><span style="color: #000080;">=</span>tif fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;c:\flower&quot;</span></pre>
<p>ラスター画像形式(JPEG, GIF, PNG, TIFを含む)をエクスポートする時、ビット階調や解像度(DPI)を指定したい場合があります。  これは、<b>expImage</b> のオプションツリー <b>tr</b>で指定することができます。  これらのオプションを指定したXファンクションの呼び出しは次のようになります。
</p>
<pre class="lt" style="font-family:monospace;">expImage im<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span>MBook1<span style="color: #000000;">]</span>MSheet1<span style="color: #000080;">!</span> type<span style="color: #000000;">:</span><span style="color: #000080;">=</span>png fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;D:\TEST.PNG&quot;</span>
tr.<span style="color: #000080;">PNG</span>.<span style="color: #000080;">bitsperpixel</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;24-bit Color&quot;</span>
tr.<span style="color: #000080;">PNG</span>.<span style="color: #000080;">dotsperinch</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">300</span>;</pre>
<p><a class="external text" href="../../XFunction/X-Function/Details_of_Image_Settings_in_Export_Image.html">ツリー<b>tr</b>のすべてのノード</a>は、オンラインヘルプにあります。
</p>






    