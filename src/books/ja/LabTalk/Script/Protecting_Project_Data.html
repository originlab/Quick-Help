<h1 class="firstheading">プロジェクトデータの保護</h1><p class='urlname' style='display: none'>Protecting_Project_Data</p>
<p>Origin 9.1で紹介されているように、LabTalkコマンドはワークシートやワークブックの様々な保護が行えます。これには、オブジェクトレベルの保護を修正できるプロジェクトレベルの<b>Admin</b> モードを含みます。AdminモードなしでもOriginオブジェクトの状態を保護制御できますが、これらは安全ではありません。誰でもLabTalkコマンドを実行して保護を解くことができます。 
</p><p>安全な保護のためには、<b>Admin</b> パスワードをOriginプロジェクトに設定し、正しいパスワードが入力されない限りOriginオブジェクトを変更できないようにします。安全性が問題ではない場合(例えば、意図しない変更やブックおよびシートの削除から保護する場合)、Adminパスワードなしでオブジェクトレベルの保護を追加できます。Adminパスワードの設定についての情報は、<a href="../../LabTalk/Script/Protecting_Project_Data.html#Password_Protection_against_Modifying_the_OPJ:_Admin_Mode" title="スクリプト：プロジェクトデータの保護">Adminモード</a>を確認してください。
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>内容</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Project-level_Protections"><span class="tocnumber">1</span> <span class="toctext">プロジェクトレベルの保護</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Password_Protection_Against_Opening_the_OPJ"><span class="tocnumber">1.1</span> <span class="toctext">OPJ開封を防ぐパスワード保護</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Password_Protection_against_Modifying_the_OPJ:_Admin_Mode"><span class="tocnumber">1.2</span> <span class="toctext">OPJ編集を防ぐパスワード保護：Adminモード</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#App_Title_Bar_Indication_of_Admin_Mode"><span class="tocnumber">1.3</span> <span class="toctext">Adminモードを示すタイトルバー</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Admin_Mode_and_Saving_the_OPJ"><span class="tocnumber">1.4</span> <span class="toctext">AdminモードとOPJの保存</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Worksheet-_and_Workbook-level_Protections"><span class="tocnumber">2</span> <span class="toctext">ワークシートおよびワークブックレベルの保護</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#Layer_and_Page_Protection_Flags"><span class="tocnumber">2.1</span> <span class="toctext">レイヤおよびページの保護フラグ</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Layer_and_Page_Protection_Examples"><span class="tocnumber">2.2</span> <span class="toctext">レイヤおよびページの保護サンプル</span></a>
<ul>
<li class="toclevel-3 tocsection-9"><a href="#Examples:_Setting_worksheet_write_access_flags"><span class="tocnumber">2.2.1</span> <span class="toctext">サンプル：ワークシート書き込みアクセスフラグの設定</span></a></li>
<li class="toclevel-3 tocsection-10"><a href="#Examples:_Setting_workbook_write_access_flags"><span class="tocnumber">2.2.2</span> <span class="toctext">サンプル：ワークブック書き込みアクセスフラグの設定</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-11"><a href="#Print_out_current_protection_flags"><span class="tocnumber">2.3</span> <span class="toctext">現在の保護フラグを印字</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Exclusion_Zones_on_a_Read-Only_Sheet"><span class="tocnumber">2.4</span> <span class="toctext">読み取り専用シートの排除ゾーン</span></a>
<ul>
<li class="toclevel-3 tocsection-13"><a href="#Commands_to_manage_Exclusion_Zones"><span class="tocnumber">2.4.1</span> <span class="toctext">排除ゾーンを制御するコマンド</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-14"><a href="#Protecting_Graphs"><span class="tocnumber">2.5</span> <span class="toctext">グラフの保護</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="#Script_Example"><span class="tocnumber">2.6</span> <span class="toctext">スクリプトサンプル</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="Project-level_Protections"></a><span class="mw-headline">プロジェクトレベルの保護</span></h2>
<p>2種類のプロジェクトレベルのパスワード保護があります。
</p>
<ul><li> Originプロジェクトにパスワードを追加し、権限のない人間がOPJを開くのを防ぎます。  この方法は、<a class="external text" href="../../UserGuide/UserGuide/Protecting_Origin_Projects.html#Password_Protection_Against_Opening_the_OPJ">GUIから</a>とLabTalkスクリプトからの方法があります。</li>
<li> プロジェクトにAdminパスワードを追加して、権限のない人間のOPJの編集を防ぎます。この方法はOPJのアクセスは制限しませんが、OPJの編集や新しいファイルへの保存を防ぎます。この方法はLabTalkからのみ利用できます。</li></ul>
<h3><a name="Password_Protection_Against_Opening_the_OPJ"></a><span class="mw-headline">OPJ開封を防ぐパスワード保護</span></h3>
<p>この種類のパスワード保護が有効な場合、Originプロジェクト(OPJ)を開くときにパスワードの入力が必要です。これは、追加による開封や、ス繰王とによる開封などでも適用されます。
権限のない開封からプロジェクトを保護するには、
</p>
<ul><li> プロジェクトファイルを開き、スクリプトウィンドウかコマンドウィンドウで、次のように入力します。</li></ul>
<pre class="lt" style="font-family:monospace;">doc <span style="color: #000080;">-</span>pwd</pre>
<p>これによりパスワードダイアログが開き、プロジェクトパスワードの設定と変更が可能です。
</p>
<ul><li> GUIでのアクセスは、<b>ツール：</b><b>データ保護：</b><b>パスワード保護</b>を選択し、パスワードを入力します。</li></ul>
<h3><a name="Password_Protection_against_Modifying_the_OPJ:_Admin_Mode"></a><span class="mw-headline">OPJ編集を防ぐパスワード保護：Adminモード</span></h3>
<p>Adminモードの概念は、Originプロジェクトに追加されます。プロジェクトがAdminモードで保護されると、AdminとしてOPJにログインしない限り、プロジェクトの編集やワークブック、ワークシートの保護機能を変更することはできません。 
</p><p>OPJのAdmin保護を行うには、スクリプトウィンドウで以下のように入力します。
</p>
<pre class="lt" style="font-family:monospace;">doc <span style="color: #000080;">-</span>pwa <span style="color: #000000;">[</span>password<span style="color: #000000;">]</span> <span style="color: #008000;">// Adminパスワード &apos;&apos;password&apos;&apos; をOPJに追加</span></pre>
<p>角括弧で示したように、パスワードの選択はオプションです。もし、パスワードを選択しない場合、Adminモードでのログイン時に要求されません。
</p><p>パスワードを作成した場合、またはデフォルト(&quot;origin&quot;)を使用した場合、次のようなコマンドを入力してAdminモードにログインします。
</p>
<pre class="lt" style="font-family:monospace;">doc <span style="color: #000080;">-</span>pw <span style="color: #000000;">[</span>password<span style="color: #000000;">]</span> <span style="color: #008000;">// Adminモードにログインパスワードが指定された場合、パスワードを与える</span></pre> 
<p>追加のコマンド
</p>
<pre class="lt" style="font-family:monospace;">doc <span style="color: #000080;">-</span>pwx <span style="color: #008000;">// Adminモードのログアウト保護へのアクセスなし</span></pre>
<pre class="lt" style="font-family:monospace;">doc <span style="color: #000080;">-</span>pwr <span style="color: #008000;">// パスワード削除。実行のためにはログインが必要</span></pre>
<pre class="lt" style="font-family:monospace;">doc <span style="color: #000080;">-</span>pwta <span style="color: #008000;">// 保護が有効なブックとシートを表示</span></pre>
<table class="note">

<tr>
<td><b>document</b>コマンドについての詳細は、<a class="external text" href="../../LabTalk/LabTalk/Document_(command).html">document</a>コマンドを確認してください。
</td></tr></table>
<h3><a name="App_Title_Bar_Indication_of_Admin_Mode"></a><span class="mw-headline">Adminモードを示すタイトルバー</span></h3>
<p>Originのタイトルバーは、OriginプロジェクトのAdmin状態を表示します。
</p>
<ul><li> OPJのAdminモードなし(通常の状態)</li></ul>
<dl><dd> <a  class="image"><img alt="No admin mode.png" src="../images/Protecting_Project_Data/No_admin_mode.png" width="205"  /></a></dd></dl>
<ul><li> OPJのAdminモードが有効でAdminとしてのログインなし</li></ul>
<dl><dd> <a  class="image"><img alt="Exist admin mode.png" src="../images/Protecting_Project_Data/Exist_admin_mode.png" width="215"  /></a></dd></dl>
<ul><li> OPJのAdminモードが有効でAdminとしてログイン</li></ul>
<dl><dd> <a  class="image"><img alt="Login admin mode1.png" src="../images/Protecting_Project_Data/Login_admin_mode1.png" width="209"  /></a></dd></dl>
<h3><a name="Admin_Mode_and_Saving_the_OPJ"></a><span class="mw-headline">AdminモードとOPJの保存</span></h3>
<p>プロジェクトのAdminモードを有効にすると、ログインなしでのOrigin上での上書きは行えません。Adminが有効なOPJを開き、ログインせずに保護されていない領域(<a href="../../LabTalk/Script/Protecting_Project_Data.html#Worksheet-_and_Workbook-level_Protections" title="スクリプト：プロジェクトデータの保護">ワークブックおよびワークシートレベルの保護</a>を参照)でOPJを修正すると、Originのタイトルバーのファイル名にアスタリスク(*) が付きます。 
</p>
<ul><li> 未修正ファイル</li></ul>
<dl><dd> <a  class="image"><img alt="Admin mode clean.png" src="../images/Protecting_Project_Data/Admin_mode_clean.png" width="132"  /></a></dd></dl>
<ul><li> 修正されたファイル</li></ul>
<dl><dd> <a  class="image"><img alt="Admin mode dirty.png" src="../images/Protecting_Project_Data/Admin_mode_dirty.png" width="138"  /></a></dd></dl>
<p>アスタリスクは、OPJが修正されたことを示していますが、保存前にログインしない限りOPJを保存できません。保存やログインせずにOPJを閉じることはできます。
</p>
<h2><a name="Worksheet-_and_Workbook-level_Protections"></a><span class="mw-headline">ワークシートおよびワークブックレベルの保護</span></h2>
<p>以下の保護方法は<a href="../../LabTalk/Script/Protecting_Project_Data.html#Password_Protection_against_Modifying_the_OPJ:_Admin_Mode" title="スクリプト：プロジェクトデータの保護">Adminモード</a>にすることなく適用できます。しかし、Adminモードがないので、これらの保護削除からのファイルアクセスを防ぐことはできません。
</p><p>次のコマンド構文を使用してシートレベルで保護を適用できます。
</p>
<pre class="lt" style="font-family:monospace;">layer <span style="color: #000080;">-</span>lw hex<span style="color: #000000;">(</span>hex value<span style="color: #000000;">)</span></pre>
<p>次のコマンド構文を使用してブックレベルで保護を適用できます。
</p>
<pre class="lt" style="font-family:monospace;">page <span style="color: #000080;">-</span>lw hex<span style="color: #000000;">(</span>hex value<span style="color: #000000;">)</span></pre>
<p>保護フラグには、一般の継承の規則があります。ブックに保護を設定すると、ブック内の全てのシートはブックからフラグが継承されます。この決まりの例外は<b>Delete</b>フラグです。ブックとシートの削除フラグは分けて制御する必要があります（例えば、ブックの編集を許可しなくても、個別シートの削除は許可されます）。
</p>
<h3><a name="Layer_and_Page_Protection_Flags"></a><span class="mw-headline">レイヤおよびページの保護フラグ</span></h3>
<p>レイヤやページの保護には、以下の<i>hex value</i> をとります。
</p>
<table class="simple">
<tr>
<th> Hex Value
</th>
<th> 説明
</th></tr>
<tr>
<td> --
</td>
<td>全ての保護ビットをオン
</td></tr>
<tr>
<td>0
</td>
<td>アクティブワークシート/ワークブックから全ての保護を削除
</td></tr>
<tr>
<td>2
</td>
<td> <b>データ</b>：ワークシート内の全てのセル、データセルやラベルセルを含む
</td></tr>
<tr>
<td> 80
</td>
<td> <b>構造</b>：シート内の列を変更せずに保持。列の挿入/削除、移動を防ぐ。しかし、行は変更可能。
</td></tr>
<tr>
<td> 100
</td>
<td> <b>名前の変更</b>：シート名の変更を防ぐ(ワークブックに)
</td></tr>
<tr>
<td> 400
</td>
<td> <b>削除</b>：オブジェクトの削除を防ぐ
</td></tr></table>
<table class="note">

<tr>
<td><b>Note:</b> 保護を適用する前に、<a href="../../LabTalk/Script/Protecting_Project_Data.html#Commands_to_manage_Exclusion_Zones" title="スクリプト：プロジェクトデータの保護">排除ゾーンの注意</a>を確認してください。
</td></tr></table>
<h3><a name="Layer_and_Page_Protection_Examples"></a><span class="mw-headline">レイヤおよびページの保護サンプル</span></h3>
<p>次のサンプルは複数の保護フラグを統合(hex valueを追加)し、保護するものを高度に制御することを示したサンプルです。 
</p>
<h4><a name="Examples:_Setting_worksheet_write_access_flags"></a><span class="mw-headline">サンプル：ワークシート書き込みアクセスフラグの設定</span></h4>
<pre class="lt" style="font-family:monospace;">lay <span style="color: #000080;">-</span>lw hex<span style="color: #000000;">(</span><span style="color: #0000dd;">82</span><span style="color: #000000;">)</span>; <span style="color: #008000;">//データと構造保護のためにアクティブシートをセット</span>
lay <span style="color: #000080;">-</span>lw; <span style="color: #008000;">//全て保護</span>
lay <span style="color: #000080;">-</span>lw <span style="color: #0000dd;">2</span>; <span style="color: #008000;">//データのみ保護</span>
lay <span style="color: #000080;">-</span>lw hex<span style="color: #000000;">(</span><span style="color: #0000dd;">180</span><span style="color: #000000;">)</span>; <span style="color: #008000;">//列/行の挿入/削除なし、シート名変更なし</span>
lay <span style="color: #000080;">-</span>lw <span style="color: #0000dd;">0</span>; <span style="color: #008000;">//現在のシートの全ての保護を削除</span></pre>
<p>... ここで<i>hex value</i> は<a href="../../LabTalk/Script/Protecting_Project_Data.html#Layer_and_Page_Protection_Flags" title="スクリプト：プロジェクトデータの保護">上の表</a>で与えられた値です。
</p>
<h4><a name="Examples:_Setting_workbook_write_access_flags"></a><span class="mw-headline">サンプル：ワークブック書き込みアクセスフラグの設定</span></h4>
<pre class="lt" style="font-family:monospace;">page <span style="color: #000080;">-</span>lw; <span style="color: #008000;">//ブックと全てのシートをロック。変更不可。ブックやシートの削除不可。</span>
page <span style="color: #000080;">-</span>lw hex<span style="color: #000000;">(</span><span style="color: #0000dd;">482</span><span style="color: #000000;">)</span>; <span style="color: #008000;">//削除、構造変更、データ編集をロック</span>
&nbsp;
<span style="color: #008000;">// ロックするアクティブシートにブックを用意</span>
<span style="color: #008000;">// 分析結果のブックへの追加を許可</span>
lay <span style="color: #000080;">-</span>lw hex<span style="color: #000000;">(</span><span style="color: #0000dd;">582</span><span style="color: #000000;">)</span>; <span style="color: #008000;">//削除、名前変更、列/行の追加/挿入/移動、編集なし</span>
&nbsp;
page <span style="color: #000080;">-</span>lw hex<span style="color: #000000;">(</span><span style="color: #0000dd;">400</span><span style="color: #000000;">)</span>; <span style="color: #008000;">//ブック削除なし</span></pre>
<p>... ここで<i>hex value</i> は<a href="../../LabTalk/Script/Protecting_Project_Data.html#Layer_and_Page_Protection_Flags" title="スクリプト：プロジェクトデータの保護">上の表</a>で与えられた値です。
</p>
<table class="note">

<tr>
<td><b>Note</b>: Origin 2015 SR1では、次のコマンド
<pre class="lt" style="font-family:monospace;">page <span style="color: #000080;">-</span>lw; <span style="color: #008000;">// ブックと全シートのロック</span></pre>
<p>はワークブックの名前変更を防ぐことができません。
</p>
</td></tr></table>
<h3><a name="Print_out_current_protection_flags"></a><span class="mw-headline">現在の保護フラグを印字</span></h3>
<pre class="lt" style="font-family:monospace;">layer <span style="color: #000080;">-</span>lt <span style="color: #008000;">// 現在のシート保護フラグを印字</span></pre>
<pre class="lt" style="font-family:monospace;">layer <span style="color: #000080;">-</span>lt <span style="color: #008000;">// 現在のシート保護フラグを印字</span></pre>
<table class="note">

<tr>
<td>
<ul><li> <b>layer</b>コマンドについての詳細は、<a class="external text" href="../../LabTalk/LabTalk/Layer_(command).html">layer</a>コマンドを確認してください。</li>
<li> <b>page</b>コマンドについての詳細は、<a class="external text" href="../../LabTalk/LabTalk/Page_(command).html">page</a>コマンドを確認してください。</li></ul>
</td></tr></table>
<h3><a name="Exclusion_Zones_on_a_Read-Only_Sheet"></a><span class="mw-headline">読み取り専用シートの排除ゾーン</span></h3>
<p>ワークシートの修正をロックしたとき、シート内の全てのセルは読み取り専用になります。選択的なシートの修正をユーザができるようにしたいときがあります(例えばフォームとしてシートを設定)。シートの<b>排除ゾーン</b>の作成と管理の方法を説明します。
</p>
<h4><a name="Commands_to_manage_Exclusion_Zones"></a><span class="mw-headline">排除ゾーンを制御するコマンド</span></h4>
<pre class="lt" style="font-family:monospace;">layer <span style="color: #000080;">-</span>les n</pre>
<p>...ここで、<i>n</i> は次のいずれかです。
</p>
<table class="simple">
<tr>
<th> 値
</th>
<th> 説明
</th></tr>
<tr>
<td>0
</td>
<td>アクティブシートから排除ゾーンをクリア
</td></tr>
<tr>
<td>1
</td>
<td>現在の選択、1つ範囲またはCTRL+選択による複数範囲を追加し、新しい排除ゾーンとする
</td></tr>
<tr>
<td>2
</td>
<td>スクリプトウィンドウで排除ゾーンをリスト表示
</td></tr></table>
<table class="note">

<tr>
<td> <b>Note:</b> 排除ゾーンの修正は、シートが保護されていないときだけ可能です。シートをフォームとして設定するには、(1) 必要な排除ゾーンを追加し、(2) <b>lay -lw</b>でシートを修正から保護します。
</td></tr></table>
<h3><a name="Protecting_Graphs"></a><span class="mw-headline">グラフの保護</span></h3>
<p>ここで概説されたスクリプトコマンドはワークブックやワークシートに実行されますが、<b>Delete</b> フラグは一般にグラフ保護に使用でき、次のようにします。
</p>
<pre class="lt" style="font-family:monospace;">repeat <span style="color: #0000dd;">10</span> <span style="color: #000000;">{</span>win <span style="color: #000080;">-</span>t plot<span style="color: #000000;">}</span>; <span style="color: #008000;">//10このグラフウィンドウを作成</span>
win <span style="color: #000080;">-</span>o graph4 <span style="color: #000000;">{</span>page <span style="color: #000080;">-</span>lw hex<span style="color: #000000;">(</span><span style="color: #0000dd;">400</span><span style="color: #000000;">)</span><span style="color: #000000;">}</span>; <span style="color: #008000;">//graph4 に保護を設定</span>
doc <span style="color: #000080;">-</span>e P <span style="color: #000000;">{</span>win <span style="color: #000080;">-</span>c<span style="color: #000000;">}</span>; <span style="color: #008000;">//OPJ内の全てのグラフの削除をループGraph4 は保護されます。</span></pre>
<h3><a name="Script_Example"></a><span class="mw-headline">スクリプトサンプル</span></h3>
<p>以下のスクリプトは、ワークブックに対してデータシートのロックを設定し、ワークブックを削除から保護します。OPJは保存でき、共有できます。他のユーザは表示、グラフ作図、データ分析は行えますが、編集と削除はできません。 
</p><p>分析結果は追加のシートに出力されるので、このサンプルのデータシートは編集から保護されているので、<b>Smooth</b> 等で生成された結果のルーチンは他のシートに出力するように構成されます。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// サンプルファイルをインポート</span>
newbook;
string fname<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span><span style="color: #000080;">+</span><span style="color: #ff00ff;">&quot;Samples\Curve Fitting\Gaussian.dat&quot;</span>;
impasc;
<span style="color: #008000;">// パスワードを設定しログイン - パスワードン文字列としてmypwdを設定</span>
doc <span style="color: #000080;">-</span>pwa mypwd;
doc <span style="color: #000080;">-</span>pw mypwd;
<span style="color: #008000;">// データシート構造保護、編集と削除の禁止</span>
lay <span style="color: #000080;">-</span>lw hex<span style="color: #000000;">(</span><span style="color: #0000dd;">482</span><span style="color: #000000;">)</span>;
<span style="color: #008000;">// ページ削除禁止</span>
page <span style="color: #000080;">-</span>lw hex<span style="color: #000000;">(</span><span style="color: #0000dd;">400</span><span style="color: #000000;">)</span>;
<span style="color: #008000;">// ログアウト</span>
doc <span style="color: #000080;">-</span>pwx;
<span style="color: #008000;">// これでOPJを保存でき、他のユーザはデータの表示、グラフ作成、分析操作が可能</span>
<span style="color: #008000;">// 分析結果は同じシートの新しい列でなく新しいシートに追加される</span></pre>







    