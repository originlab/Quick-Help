<h1 class="firstheading">プロジェクトを管理する</h1>
<p class="urlname" style="display: none;">Managing-the-Project</p>
<div id="toc" class="toc">
<div id="toctitle">
<h2>内容</h2>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#The_DOCUMENT_CommandManage_ProjectProject_Management"><span class="tocnumber">1</span> <span class="toctext">DOCUMENTコマンド</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Start_a_New_ProjectStart_a_New_Project"><span class="tocnumber">1.1</span> <span class="toctext">新規プロジェクトを開始する</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Open.2FSave_a_project"><span class="tocnumber">1.2</span> <span class="toctext">プロジェクトを開く/保存する</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Append_projectsAppend_projectorigin_project.2C_append"><span class="tocnumber">1.3</span> <span class="toctext">プロジェクトを追加する</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Save.2FLoad_Child_WindowsSave_WindowLoad_Window"><span class="tocnumber">1.4</span> <span class="toctext">子ウィンドウを保存する/ロードする</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Saving_External_Excel_Book"><span class="tocnumber">1.5</span> <span class="toctext">外部Excelブックを保存する</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Refresh_Windows"><span class="tocnumber">1.6</span> <span class="toctext">ウィンドウのリフレッシュ</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8"><a href="#Project_Explorer_X-Functions"><span class="tocnumber">2</span> <span class="toctext">プロジェクトエクスプローラのXファンクション</span></a></li>
</ul>
</div>
<h2><a name="The_DOCUMENT_CommandManage_ProjectProject_Management" id="The_DOCUMENT_CommandManage_ProjectProject_Management"></a><span class="mw-headline">DOCUMENTコマンド</span></h2>
<p><b><span class="OIndex">Document</span></b> コマンドは、LabTalkコマンドで、Originプロジェクトに関するさまざまな操作を実行します。 <a href="../../LabTalk/LabTalk/Document_(command).html" title="LabTalk:Document (コマンド)"><b>document</b>コマンド</a>のシンタックスは次のようになっています。</p>
<pre class="lt" style="font-family: monospace;">
document <span style="box-sizing: border-box; color: #000080;">-</span>option value;
</pre>
<p>Note:</p>
<ul>
<li><i>value</i> は、いくつかのオプションに対しては利用できず、コマンドから除外されます。</li>
<li>詳細はDoc (Object)を確認してください。</li>
</ul>
<p>内部的に、Originはプロジェクトを修正した事を示すプロパティを更新します。現在のプロジェクトが修正されているときにプロジェクトを開こうとすると、通常、現在のプロジェクトを保存を促します。documentコマンドは、このプロパティを制御するオプションがあります。</p>
<h3><a name="Start_a_New_ProjectStart_a_New_Project" id="Start_a_New_ProjectStart_a_New_Project"></a><span class="mw-headline">新規プロジェクトを開始する</span></h3>
<pre class="lt" style="font-family: monospace;">
<span style="color: #008000;">注意保存するかどうかを尋ねるプロンプトがオフ</span>
document <span style="color: #000080;">-</span>s; <span style="color: #008000;">
// &amp;apos;&amp;apos;doc&amp;apos;&amp;apos; は &amp;apos;&amp;apos;document&amp;apos;&amp;apos; の短縮形、 &amp;apos;&amp;apos;n&amp;apos;&amp;apos; は &amp;apos;&amp;apos;new&amp;apos;&amp;apos;の短縮形</span>
doc <span style="color: #000080;">-</span>n;
</pre>
<h3><a name="Open.2FSave_a_project" id="Open.2FSave_a_project"></a><span class="mw-headline">プロジェクトを開く/保存する</span></h3>
<p><a href="../../LabTalk/LabTalk/Document_(command).html#-o_projectName.3B_Open_a_project" title="LabTalk:Document (コマンド)">doc -oコマンド</a>を使って、<span class="OIndex">プロジェクトを開く/保存</span>、<a href="../../LabTalk/LabTalk/Save_(command).html" title="LabTalk:Save (コマンド)">saveコマンド</a>でプロジェクトを保存します。</p>
<pre class="lt" style="font-family: monospace;">
<span style="color: #008000;">// Originプロジェクトファイルを開く</span>
string fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> SYSTEM.<span style="color: #000080;">PATH</span>.<span style="color: #000080;">PROGRAM</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">"Origin.opj"</span>;
doc <span style="color: #000080;">-</span>o <span style="color: #000080;">%</span><span style="color: #000000;">(</span>fname<span style="color: #000080;">$</span><span style="color: #000000;">)</span>;   <span style="color: #008000;">// &amp;apos;&amp;apos;document -open&amp;apos;&amp;apos;の短縮形</span><span style="color: #008000;">
// 変更を行う</span><span style="color: #000080;">
%</span><span style="color: #000000;">(</span>Data1,<span style="color: #0000dd;">1</span><span style="color: #000000;">)</span> <span style="color: #000080;">=</span> data<span style="color: #000000;">(</span><span style="color: #0000dd;">0</span>,<span style="color: #0000dd;">100</span><span style="color: #000000;">)</span>;<span style="color: #000080;">
%</span><span style="color: #000000;">(</span>Data1,<span style="color: #0000dd;">2</span><span style="color: #000000;">)</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">100</span> <span style="color: #000080;">*</span> uniform<span style="color: #000000;">(</span><span style="color: #0000dd;">101</span><span style="color: #000000;">)</span>;<span style="color: #008000;">
// 新しい場所に新しい名前でプロジェクトを保存</span>
fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> SYSTEM.<span style="color: #000080;">PATH</span>.<span style="color: #000080;">APPDATA</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">"My Project.opj"</span>;
save <span style="color: #000080;">%</span><span style="color: #000000;">(</span>fname<span style="color: #000080;">$</span><span style="color: #000000;">)</span>;
</pre>
<h3><a name="Append_projectsAppend_projectorigin_project.2C_append" id="Append_projectsAppend_projectorigin_project.2C_append"></a><span class="mw-headline">プロジェクトを追加する</span></h3>
<p>前のスクリプトに続けて、別のプロジェクトを追加することができます。Originは、同時に1つのプロジェクトファイルのみをサポートするため、既存のプロジェクトと追加されたプロジェクトがひとつのプロジェクトになります。</p>
<pre class="lt" style="font-family: monospace;">
<span style="color: #008000;">// Originプロジェクトファイルを現在のファイルに追加</span>
fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> SYSTEM.<span style="color: #000080;">PATH</span>.<span style="color: #000080;">PROGRAM</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">"Origin.opj"</span>;
doc <span style="color: #000080;">-</span>a <span style="color: #000080;">%</span><span style="color: #000000;">(</span>fname<span style="color: #000080;">$</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// Abbreviation of &amp;apos;&amp;apos;document -append&amp;apos;&amp;apos;</span><span style="color: #008000;">
// 現在のプロジェクトを保存 - これは &amp;apos;&amp;apos;My Project.opj&amp;apos;&amp;apos;</span>
save;<span style="color: #008000;">
// 新しい名前で現在のプロジェクトを新しい場所に保存</span>
save C<span style="color: #000000;">:</span>\Data Files\working.<span style="color: #000080;">opj</span>;
</pre>
<h3><a name="Save.2FLoad_Child_WindowsSave_WindowLoad_Window" id="Save.2FLoad_Child_WindowsSave_WindowLoad_Window"></a><span class="mw-headline">子ウィンドウを保存する/ロードする</span></h3>
<p>Originで、グラフ、ワークブック、行列、Excelブックなどの子ウィンドウを1つのファイルに保存することができます。Appendは、別のプロジェクトにファイルを追加するのに使うことができます。ワークブック、行列、グラフに対しては、適切な拡張子が自動的に追加されますが、Excelウィンドウには.XLSを指定する必要があります。</p>
<pre class="lt" style="font-family: monospace;">
<span style="color: #008000;">// saveコマンドはアクティブウィンドウに対して行われる</span>
save <span style="color: #000080;">-</span>i C<span style="color: #000000;">:</span>\Data\MyBook;
</pre>
<p><b>Append</b> は、次のウィンドウの種類をロードするのに使うことができます。</p>
<pre class="lt" style="font-family: monospace;">
<span style="color: #008000;">// ワークブック(*.OGW), 行列(*.OGM), グラフ(*.OGG), Excel(*.XLS)</span>
dlgfile group<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000080;">*</span>.<span style="color: #000080;">ogg</span>; <span style="color: #008000;">
// fnameはdlgfile Ｘファンクションでセットされる文字列変数</span>
doc <span style="color: #000080;">-</span>a <span style="color: #000080;">%</span><span style="color: #000000;">(</span>fname<span style="color: #000080;">$</span><span style="color: #000000;">)</span>;
</pre>
<p>Excelに対して、ExcelファイルをExcelとして開くのではなく、インポートするように指定することができます。</p>
<pre class="lt" style="font-family: monospace;">
doc <span style="color: #000080;">-</span>ai <span style="color: #ff00ff;">"C:\Data\Excel\Current Data.xls"</span>;
</pre>
<p>ノートウィンドウは、特殊なオプションスイッチを使った特別なケースです。</p>
<pre class="lt" style="font-family: monospace;">
<span style="color: #008000;">// Notes1という名前のノートウィンドウを保存</span>
save <span style="color: #000080;">-</span>n Notes1 C<span style="color: #000000;">:</span>\Data\Notes\Today.<span style="color: #000080;">TXT</span>; <span style="color: #008000;">
// MyNotesという名前のノートウィンドウにテキストファイルを読み込む</span>
open <span style="color: #000080;">-</span>n C<span style="color: #000000;">:</span>\Data\Notes\Today.<span style="color: #000080;">txt</span> MyNotes;
</pre>
<h3><a name="Saving_External_Excel_Book" id="Saving_External_Excel_Book"></a><span class="mw-headline">外部Excelブックを保存する</span></h3>
<p>これはOrigin 8.1から導入された機能で、外部的にリンクした<span class="OIndex">Excelブック</span>を現在のファイル名で保存します。</p>
<pre class="lt" style="font-family: monospace;">
save <span style="color: #000080;">-</span>i;
</pre>
<h3><a name="Refresh_Windows" id="Refresh_Windows"></a><span class="mw-headline">ウィンドウのリフレッシュ</span></h3>
<p>次のコマンドを使って、<span class="OIndex">ウィンドウをリフレッシュ</span>することができます。</p>
<pre class="lt" style="font-family: monospace;">
doc <span style="color: #000080;">-</span>u;
</pre>
<h2><a name="Project_Explorer_X-Functions" id="Project_Explorer_X-Functions"></a><span class="mw-headline">プロジェクトエクスプローラのXファンクション</span></h2>
<p>次のXファンクションは、DOSコマンドのように利用して、プロジェクトのサブフォルダを作成したり、削除したり、移動することができます。</p>
<table class="simple">
<tr>
<th>名前</th>
<th>説明</th>
</tr>
<tr>
<td><a class="external text" href="../../XFunction/X-Function/Pe_dir.html">pe_dir</a></td>
<td>
<p>アクティブフォルダの内容を表示します。</p>
</td>
</tr>
<tr>
<td><a class="external text" href="../../XFunction/X-Function/Pe_cd.html">pe_cd</a></td>
<td>
<p>別のフォルダに変更します。</p>
</td>
</tr>
<tr>
<td><a class="external text" href="../../XFunction/X-Function/Pe_move.html">pe_move</a></td>
<td>
<p>フォルダまたはウィンドウを移動します。</p>
</td>
</tr>
<tr>
<td><a class="external text" href="../../XFunction/X-Function/Pe_path.html">pe_path</a></td>
<td>
<p>現在のパスをレポートします。</p>
</td>
</tr>
<tr>
<td><a class="external text" href="../../XFunction/X-Function/Pe_rename.html">pe_rename</a></td>
<td>
<p>フォルダまたはウィンドウの名前を変更します。</p>
</td>
</tr>
<tr>
<td><a class="external text" href="../../XFunction/X-Function/Pe_mkdir.html">pe_mkdir</a></td>
<td>
<p>フォルダを作成します。</p>
</td>
</tr>
<tr>
<td><a class="external text" href="../../XFunction/X-Function/Pe_rmdir.html">pe_rmdir</a></td>
<td>
<p>フォルダを削除します。</p>
</td>
</tr>
</table>
<p>この例では</p>
<pre class="lt" style="font-family: monospace;">
doc <span style="color: #000080;">-</span>s;                      <span style="color: #008000;">// Originの保存フラグを消去</span>
doc <span style="color: #000080;">-</span>n;                      <span style="color: #008000;">// 新しいプロジェクトを開始</span>
pe_cd <span style="color: #000080;">/</span>;                     <span style="color: #008000;">// トップレベルに移動</span>
pe_mkdir <span style="color: #ff00ff;">"Test Subjects"</span>;    <span style="color: #008000;">// フォルダを作成</span>
pe_cd <span style="color: #ff00ff;">"Test Subjects"</span>;       <span style="color: #008000;">// フォルダに移動</span>
pe_mkdir <span style="color: #ff00ff;">"Trials"</span>;           <span style="color: #008000;">// サブフォルダを作成</span>
pe_mkdir <span style="color: #ff00ff;">"Results"</span>;          <span style="color: #008000;">//  もう一つ作成</span>
pe_cd <span style="color: #000080;">/</span>;                     <span style="color: #008000;">// トップレベルに移動</span>
pe_mkdir <span style="color: #ff00ff;">"Control Subjects"</span>; <span style="color: #008000;">// 別のフォルダを作成</span>
pe_cd <span style="color: #ff00ff;">"Control Subjects"</span>;    <span style="color: #008000;">// そのフォルダに移動</span>
pe_mkdir <span style="color: #ff00ff;">"Trials"</span>;           <span style="color: #008000;">// サブフォルダを作成</span>
pe_mkdir <span style="color: #ff00ff;">"Results"</span>;          <span style="color: #008000;">//  別のフォルダを作成</span>
pe_cd <span style="color: #000080;">/</span>;                     <span style="color: #008000;">// トップレベルに移動</span>
pe_mkdir <span style="color: #ff00ff;">"Comparison"</span>;       <span style="color: #008000;">// フォルダを作成</span>
</pre>
<p>プロジェクトエクスプローラ内で下図のようにフォルダ構造を作成しています。&#160;:<br />
<a class="image"><img alt="PE TREE.png" src="../images/Managing_the_Project/PE_TREE.png" width="214" border="0" /></a><br /></p>
<p>環境設定 ：オプション ：オープン/クローズで、<b>サブフォルダ中にオープンする</b>が有効の場合、Options&#160;:<b>Folder1</b>という名前のフォルダを追加します。</p>
