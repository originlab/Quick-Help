<h1 class="firstheading">図形オブジェクトから</h1><p class='urlname' style='display: none'>From-Graphical-objs</p>
<p><span class="OIndex" style="display:none">図形オブジェクト</span>(テキスト、線、図形)をイベントと結びつけ、そのイベントで実行される<span class="OIndex">スクリプト</span>を含めることができます。図形オブジェクトはページと結びつけられるので、テンプレート、ウィンドウファイル、プロジェクトファイルに保存されます。
</p>
<h2><a name="Buttons"></a><span class="mw-headline">ボタン</span></h2>
<p>頻繁に使われるスクリプトのいくつかをOriginのユーザインターフェース(GUI)のボタンに割り当てて、スクリプトの実行を自動化することもできます。  これには、次のステップを行います。
</p><p>新しく開いたOriginプロジェクトから
</p>
<ol><li> プロジェクトウィンドウの左にあるツールメニューからテキストツールを選択します。 --&gt;<a  class="image"><img alt="Button Text Tool.png" src="../images/From_Graphical_Objects/Button_Text_Tool.png" width="23"  /></a></li>
<li> <b>Book1</b> ウィンドウの空白ワークシートの2つの空の列の右にある領域をクリックします。  テキストボックスが開きます。  テキストボックスに&quot;Hello&quot;と入力し、Enterを押します。これでボタン用のラベルが入力できました。</li>
<li> 次に、ALTキーを押しながら、今作成したテキストをダブルクリックします。  <b>オブジェクトのプログラム制御</b>というウィンドウが開きます。</li>
<li> ダイアログの左上にある「オブジェクト名」の項目を、<b>Greeting </b>に変更します。</li>
<li> <b>オブジェクトのプログラム制御</b> ウィンドウの下側のテキストボックスで、スクリプトをそのまま入力します。<pre class="lt" style="font-family:monospace;">type <span style="color: #000080;">-</span>b <span style="color: #ff00ff;">&quot;Hello World&quot;</span>;</pre></li>
<li> また、<b>オブジェクトのプログラム制御</b>ウィンドウで、<b>～のあとでスクリプトを実行</b>ボックスで、<b>ボタンアップ</b>を選び、<b>OK</b>をクリックします。</li>
<li> これでボタンが作成できました。ボタンを押すと、スクリプトが実行され、ポップアップウィンドウに &quot;Hello World&quot; と出力されます。</li></ol>
<p><b>スクリプトウィンドウ</b>にのみ存在しているテキストスクリプトとは異なり、このボタンとスクリプトは、Originプロジェクトを保存するときに保存されます。
</p><p>また、グラフィックオブジェクトに設定されたスクリプトは、オブジェクト名とrunメソッドを使用して実行できます。<b>コマンドウィンドウ</b>を開き、以下のように入力します。
</p>
<pre class="lt" style="font-family:monospace;">greeting.<span style="color: #000080;">run</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span></pre>
<p>そしてENTERキーを押して実行します。
</p>
<h2><a name="Lines"></a><span class="mw-headline">線</span></h2>
<p>以下は、直線を移動すると、その直線があるX位置にあるデータの補間値を出力するようにグラフ上に垂直線を作成するスクリプトです。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//グラフ上に垂直線を作成</span>
draw <span style="color: #000080;">-</span>n MyCursor <span style="color: #000080;">-</span>l <span style="color: #000080;">-</span>v <span style="color: #000080;">$</span><span style="color: #000000;">(</span>x1<span style="color: #000080;">+</span><span style="color: #000000;">(</span>x2<span style="color: #000080;">-</span>x1<span style="color: #000000;">)</span><span style="color: #000080;">/</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span>;
MyCursor.<span style="color: #000080;">HMOVE</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;               <span style="color: #008000;">// 水平移動可能</span>
MyCursor.<span style="color: #000080;">color</span> <span style="color: #000080;">=</span> color<span style="color: #000000;">(</span>orange<span style="color: #000000;">)</span>;   <span style="color: #008000;">// オレンジ色に変更</span>
MyCursor.<span style="color: #000080;">linewidth</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;           <span style="color: #008000;">// 線を太くする</span>
<span style="color: #008000;">// グラフにラベルを追加</span>
label <span style="color: #000080;">-</span>sl <span style="color: #000080;">-</span>a <span style="color: #000080;">$</span><span style="color: #000000;">(</span>MyCursor.<span style="color: #000080;">x</span><span style="color: #000000;">)</span> <span style="color: #000080;">$</span><span style="color: #000000;">(</span>Y2<span style="color: #000080;">+</span><span style="color: #0000dd;">0.05</span><span style="color: #000080;">*</span><span style="color: #000000;">(</span>Y2<span style="color: #000080;">-</span>Y1<span style="color: #000000;">)</span><span style="color: #000000;">)</span> <span style="color: #000080;">-</span>n MyLabel <span style="color: #000080;">$</span><span style="color: #000000;">(</span><span style="color: #000080;">%</span>C<span style="color: #000000;">(</span>MyCursor.<span style="color: #000080;">x</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;
<span style="color: #008000;">// 線にスクリプトを割り当て</span>
MyCursor.<span style="color: #000080;">script</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;MyLabel.x = MyCursor.x;
MyLabel.y = Y2 + MyLabel.dy;
doc -uw;&quot;</span>;
<span style="color: #008000;">// 線が動いた後スクリプトを実行するようにする</span>
MyCursor.<span style="color: #000080;">Script</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;</pre>
<h2><a name="Other_Objects"></a><span class="mw-headline">その他のオブジェクト</span></h2>
<p>グラフィカルオブジェクト(テキスト、線、図形)に、イベントが発生したときに実行するスクリプトを添付することができます。
</p><p>この例では、グラフ上の四角形(オブジェクト名RECT)が移動またはサイズ変更した時にスクリプトが実行されるように設定されています。
</p>
<ol>
<li> <b>プロット操作・オブジェクト作成</b>ツールバーの四角形ツールを使って、グラフに矩形を描きます。
<li> <b>オブジェクト編集</b>ツールバーのプロット後部に移すボタンを使って、データの後ろに矩形を配置します。
<li> Altキーを押しながら、矩形をダブルクリックして、<b>オブジェクトのプログラム制御</b>を開きます。オブジェクト名がRectであることを確認します。
<li> 次のスクリプトを入力します。
<pre class="lt" style="font-family:monospace;"><span style="color: #000080;">%</span>B <span style="color: #000080;">=</span> <span style="color: #000080;">%</span>C;
<span style="color: #000080;">%</span>A <span style="color: #000080;">=</span> xof<span style="color: #000000;">(</span><span style="color: #000080;">%</span>B<span style="color: #000000;">)</span>;
dataset dsRect;
dsRect <span style="color: #000080;">=</span> <span style="color: #000000;">(</span><span style="color: #000000;">(</span><span style="color: #000080;">%</span>A <span style="color: #000080;">&gt;=</span> rect.<span style="color: #000080;">x1</span><span style="color: #000000;">)</span> <span style="color: #000080;">&amp;&amp;</span> <span style="color: #000000;">(</span><span style="color: #000080;">%</span>A <span style="color: #000080;">&lt;=</span> rect.<span style="color: #000080;">x2</span><span style="color: #000000;">)</span> <span style="color: #000080;">&amp;&amp;</span> 
          <span style="color: #000000;">(</span><span style="color: #000080;">%</span>B <span style="color: #000080;">&gt;=</span> rect.<span style="color: #000080;">y3</span><span style="color: #000000;">)</span> <span style="color: #000080;">&amp;&amp;</span> <span style="color: #000000;">(</span><span style="color: #000080;">%</span>B <span style="color: #000080;">&lt;=</span> rect.<span style="color: #000080;">y1</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>?<span style="color: #000080;">%</span>B<span style="color: #000000;">:</span><span style="color: #0000dd;">0</span><span style="color: #000080;">/</span><span style="color: #0000dd;">0</span>;
stats dsRect;
delete dsRect;
type <span style="color: #000080;">-</span>a Mean of <span style="color: #000080;">$</span><span style="color: #000000;">(</span>stats.<span style="color: #000080;">mean</span><span style="color: #000000;">)</span>;</pre>
<li> ～のあとでスクリプトを実行ドロップダウンリストで<b>移動／サイズ変更</b>を選びます。
<li> OKをクリックします。
</ol>
<p>この矩形を移動したり、サイズ変更すると、スクリプトが矩形の範囲内にあるすべてのデータポイントの平均を計算し、スクリプトウィンドウに出力します。グラフィックオブジェクト範囲を定義して以下のように実行することもできます。
</p>
<pre class="lt" style="font-family:monospace;">GObject gobj <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>Graph1<span style="color: #000000;">]</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span>rect;
gobj.<span style="color: #000080;">run</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;</pre>







    