<h1 class="firstheading">数値と文字列の入力を取得する</h1><p class='urlname' style='display: none'>Getting-Numeric-and-String-Input</p>
<p>このセクションは、スクリプト実行中に3種類のユーザの入力を促すサンプルです。 
</p>
<ol><li> <a href="#Get_a_Yes.2FNo_Response">はい/いいえの応答</a></li>
<li> <a href="#Get_a_String">1つの文字列</a></li>
<li> <a href="#Get_Multiple_Values">様々なタイプの入力 (GetN)</a></li></ol>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Getting_Numeric_and_String_Input/Tip_icon.png" width="57"  border="0" /></td><td><pre> <b>ユーザインターフェースモジュール</b> (<b>UIM</b>)は、複雑なユーザインターフェースコントロールの構築を可能にします。<a href="../../LabTalk/LabTalk/UIM.html" title="LabTalk:UIM"><b>UIM オブジェクト</b></a> ページを確認してください。
</pre>
</td></tr></table>
<h2><a name="Get_a_Yes.2FNo_Response"></a><span class="mw-headline">はい/いいえの応答を得る</span></h2>
<p><a href="../../LabTalk/LabTalk/GetYesNo_(command).html" title="LabTalk:GetYesNo (コマンド)"><span class="OIndex">GetYesNoコマンド</span></a> は、ユーザから「はい」または「いいえ」の応答を得るのに使うことができます。  コマンドは3つの引数を取ります。
</p><p>構文: <b>getyesno</b> <i>stringMessageToUser</i> <i>numericVariableName</i> <i>windowTitle</i>
</p><p>例えば、スクリプトウィンドウに次の行を入力すると、<b>Check Sign of X</b> というウィンドウタイトルで、ユーザに<b>Should X be positive?</b>という<b>はい</b>か<b>いいえ</b><b>キャンセル</b>で答える質問のポップアップを開きます。  <b>はい</b> を選択すると、<b>xpos</b> に値1が割り当てられます。  <b>いいえ</b>を選択すると、<b>xpos</b> に値0が割り当てられます。  <b>キャンセル</b>を選択すると、<b>#Command Error!</b>が出力され、実行が停止します。
</p>
<pre class="lt" style="font-family:monospace;">getyesno <span style="color: #ff00ff;">&quot;Should X be positive?&quot;</span> xpos <span style="color: #ff00ff;">&quot;Check Sign of X&quot;</span></pre> 
<p>追加のスクリプト処理がイベントで必要となる場合、このコマンドを他の場所で呼び出し、数値をテストすることができます。次のサンプルは、<b>getyesno</b> をコードの<b>Main</b> セクションから呼び出し、2つの文字列入力を引数としてセクションに渡します。 
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">[</span>Main<span style="color: #000000;">]</span>
<span style="color: #008000;">// 呼び出しコード</span>
int iVal <span style="color: #000080;">=</span> <span style="color: #000080;">-</span><span style="color: #0000dd;">1</span>;
run.<span style="color: #000080;">section</span><span style="color: #000000;">(</span>,myGetYesNo,<span style="color: #ff00ff;">&quot;Create a Graph of results?&quot;</span><span style="color: #ff00ff;">&quot;Graphing Option&quot;</span><span style="color: #000000;">)</span>;
if<span style="color: #000000;">(</span> iVal <span style="color: #000080;">&gt;</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
   type <span style="color: #ff00ff;">&quot;Graph generated&quot;</span>;        <span style="color: #008000;">// はいの応答  </span>
<span style="color: #000000;">}</span>
else
<span style="color: #000000;">{</span>
   type <span style="color: #ff00ff;">&quot;Graph NOT generated&quot;</span>;    <span style="color: #008000;">// いいえまたはキャンセルの応答</span>
<span style="color: #000000;">}</span>
&nbsp;
<span style="color: #008000;">// &apos;myGetYesNo&apos; セクション</span>
<span style="color: #000000;">[</span>myGetYesNo<span style="color: #000000;">]</span>
getyesno <span style="color: #000000;">(</span><span style="color: #000080;">%</span>1<span style="color: #000000;">)</span> iVal <span style="color: #000000;">(</span><span style="color: #000080;">%</span>2<span style="color: #000000;">)</span>;</pre>
<p>上記のLabTalkスクリプトには2つのセクション<b>Main</b> および <b>myGetYesNo</b>が含まれているので、スクリプトウィンドウで直接実行することはできません。OGSファイルとして保存してから、スクリプトウィンドウで<b>run.section(test.ogs,main)</b> と入力し、ENTERキーを押し実行してください。詳細は<a class="external text" href="../../LabTalk/Script/From_Files.html#Sections_in_an_OGS_FileSectionScript_Section">OGSファイルのセクション</a>を参照してください。
</p>
<h2><a name="Get_a_String"></a><span class="mw-headline">文字列を取得</span></h2>
<p><i><b><a href="../../LabTalk/LabTalk/GetString_(command).html" title="LabTalk:GetString (コマンド)"><span class="OIndex">GetString</span></a></b></i> は、ユーザが入力する1つの文字列に対して使用します。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000080;">%</span>B <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;&quot;</span>;
GetString <span style="color: #000000;">(</span>Enter as Last, First<span style="color: #000000;">)</span> Last <span style="color: #000000;">(</span>Your Name<span style="color: #000000;">)</span>;
<span style="color: #008000;">// キャンセルはGetYesNoのテクニックを使わずに中断</span>
if<span style="color: #000000;">(</span><span style="color: #ff00ff;">&quot;%B&quot;</span><span style="color: #000080;">!</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Last&quot;</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
    type User entered <span style="color: #000080;">%</span>B.;
<span style="color: #000000;">}</span>
else
<span style="color: #000000;">{</span>
    type User clicked OK, but did not modify text;
<span style="color: #000000;">}</span></pre>
<h2><a name="Get_Multiple_Values"></a><span class="mw-headline">複数の値を取得</span></h2>
<p><a href="../../LabTalk/LabTalk/GetNumber_(command).html" title="LabTalk:GetNumber (コマンド)"><span class="OIndex">GetN</span></a> または <a href="../../LabTalk/LabTalk/GetNumber_(command).html" title="LabTalk:GetNumber (コマンド)"><span class="OIndex">GetNumber ダイアログ</span></a> は、数字、文字、リスト、または制御から選んで入力します。(Originの古いバージョンでは、数値のみが可能でした)  バージョン8.1より前のバージョンでは、GetNumberは文字列入力用の文字列レジスタ（%Aなど）のみをサポートしていました。<a href="../../LabTalk/LabTalk/GetNumber_(command).html#Using_Origin_C.27s_GetNBox_from_LabTalk" title="LabTalk:GetNumber (コマンド)">Origin8.1以降のバージョン</a>の場合、<b>GetNumber</b>では文字列変数（string str1$ など）と文字列レジスタの両方が使用できます。<b>GetN</b>は、現在、ダイアログタイトルに加えて50つまでの変数を受け付けます。
</p><p>文字列を最初に宣言する必要があることに注意してください。  代入による方法ではなく、変数を作成する方法は常に良い方法となります。詳細は、<a href="../../LabTalk/LabTalk/Data_Types_and_Variables.html#Scope_of_Variables" title="LabTalk:データ型と変数">(文字列)変数のスコープ</a>を参照して下さい。  例えば:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 最初に、使用する変数を宣言</span>
double nn <span style="color: #000080;">=</span> <span style="color: #0000dd;">3.2</span>;
string measurement<span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;length&quot;</span>, units<span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;inches&quot;</span>, event<span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Experiment #2&quot;</span>;
&nbsp;
<span style="color: #008000;">// GetNダイアログを使ってユーザデータを収集</span>
getn
<span style="color: #000000;">(</span>Value<span style="color: #000000;">)</span> nn 
<span style="color: #000000;">(</span>Measurement Type<span style="color: #000000;">)</span> measurement<span style="color: #000080;">$</span>
<span style="color: #000000;">(</span>Units<span style="color: #000000;">)</span> units<span style="color: #000080;">$</span>
<span style="color: #000000;">(</span>Event Name<span style="color: #000000;">)</span> event<span style="color: #000080;">$</span>
<span style="color: #000000;">(</span>Dialog Title<span style="color: #000000;">)</span>;</pre>
<p>これにより、次のダイアログが開き、ユーザに入力を促します。
</p><p><a  class="image"><img alt="GetN Dialog.png" src="../images/Getting_Numeric_and_String_Input/GetN_Dialog.png" width="329"  /></a>
</p><p>このダイアログに入力された値は、宣言した変数に割り当てられます。   変数は初期値(以前<b>GetN</b> が呼び出されていた)を持つ場合、その値は入力ボックスに表示され、それ以外の場合、入力ボックスは空白となります。  どちらの場合も、初期値を変更したり、そのまま使用することができます。
</p><p>入力されたデータをチェックするには、次のスクリプトを実行します。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// データを出力</span>
type In <span style="color: #000080;">%</span><span style="color: #000000;">(</span>event<span style="color: #000080;">$</span><span style="color: #000000;">)</span>, the <span style="color: #000080;">%</span><span style="color: #000000;">(</span>measurement<span style="color: #000080;">$</span><span style="color: #000000;">)</span> was <span style="color: #000080;">$</span><span style="color: #000000;">(</span>nn<span style="color: #000000;">)</span> <span style="color: #000080;">%</span><span style="color: #000000;">(</span>units<span style="color: #000080;">$</span><span style="color: #000000;">)</span>;</pre>
<hr />
<p>次のサンプルスクリプトは、Graphがアクティブウィンドウ場合に、情報の入力を求めて折れ線とラベルを描画します。  <b>GetN</b> の呼び出しは、入力として文字列レジスタと事前定義のリストを使用します。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000080;">%</span>A<span style="color: #000080;">=</span>Minimum;
iColor <span style="color: #000080;">=</span> <span style="color: #0000dd;">15</span>;
dVal <span style="color: #000080;">=</span> <span style="color: #0000dd;">2.75</span>;
iStyle <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
&nbsp;
<span style="color: #008000;">// GetNダイアログを開く</span>
<span style="color: #008000;">// %Aの前の余計な %記号は、変数名として扱うのではなく </span>
<span style="color: #008000;">// 文字列レジスターを文字通りに解釈</span>
getn <span style="color: #000000;">(</span>Label Quantile<span style="color: #000000;">)</span> <span style="color: #000080;">%%</span>A 
<span style="color: #000000;">(</span>Color<span style="color: #000000;">)</span> iColor<span style="color: #000000;">:</span>@C 
<span style="color: #000000;">(</span>Style<span style="color: #000000;">)</span> iStyle<span style="color: #000000;">:</span>@D 
<span style="color: #000000;">(</span>Value<span style="color: #000000;">)</span> dVal 
<span style="color: #000000;">(</span>Set Quantile<span style="color: #000000;">)</span>;
&nbsp;
draw <span style="color: #000080;">-</span>n <span style="color: #000080;">%</span>A <span style="color: #000080;">-</span>l <span style="color: #000080;">-</span>h dVal;     <span style="color: #008000;">// 名前を付けた水平線を描画</span>
<span style="color: #000080;">%</span>A.<span style="color: #000080;">color</span> <span style="color: #000080;">=</span> iColor;         <span style="color: #008000;">// 線の色をセット</span>
<span style="color: #000080;">%</span>A.<span style="color: #000080;">linetype</span> <span style="color: #000080;">=</span> iStyle;      <span style="color: #008000;">// 線種をセット</span>
&nbsp;
<span style="color: #008000;">// 線の右端にQLabelという名前のテキストラベルを</span>
<span style="color: #008000;">// 作成</span>
label <span style="color: #000080;">-</span>s <span style="color: #000080;">-</span>a x2 dVal <span style="color: #000080;">-</span>n QLabel <span style="color: #000080;">%</span>A; 
&nbsp;
<span style="color: #000080;">%</span>A.<span style="color: #000080;">Connect</span><span style="color: #000000;">(</span>QLabel,<span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>;       <span style="color: #008000;">// 2つのオブジェクトを接続</span></pre>
<p>スクリプトは、%Aが1つの語句で、オブジェクト<i>QLabel</i> が存在しないことを前提としています。
</p><p><b>@</b>文字で始まる次の文字シーケンスは、<b>GetN</b>引数の事前定義されたリストにアクセスします。
</p>
<table class="simple">
<tr>
<th> リスト</th>
<th> 説明
</th></tr>
<tr>
<td>&nbsp;:@B
</td>
<td> オブジェクトの背景属性のリスト
</td></tr>
<tr>
<td>&nbsp;:@C
</td>
<td> 基本の色リスト
</td></tr>
<tr>
<td>&nbsp;:@D
</td>
<td> 線種のリスト
</td></tr>
<tr>
<td>&nbsp;:@P
</td>
<td> パターンリスト
</td></tr>
<tr>
<td>&nbsp;:@S
</td>
<td> フォントサイズリスト
</td></tr>
<tr>
<td>&nbsp;:@T
</td>
<td> フォントリスト
</td></tr>
<tr>
<td>&nbsp;:@W
</td>
<td> 線の太さのリスト
</td></tr>
<tr>
<td>&nbsp;:@Z
</td>
<td> シンボルサイズのリスト
</td></tr></table>
<p><b>GetN</b> ダイアログ内でリスト項目が選択されたときに返される値は、リスト内の項目のインデックスです。  例えば、<b>GetN</b> のリストの1つが下記のようであれば:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">(</span>Font Size<span style="color: #000000;">)</span> fs<span style="color: #000000;">:</span>@S</pre>
<p>ダイアログのドロップダウンリストから <b>18</b> を選ぶと、18はリストの8番目の項目なので、変数 <b>fs</b> には値 <b>8</b>が入ります。
</p><p><br />
</p>
<hr />
<p>以下は、散布図を線＋シンボルに変更したり、その逆の変更を実行するサンプルスクリプトです。
</p>
<pre class="lt" style="font-family:monospace;">get <span style="color: #000080;">%</span>C <span style="color: #000080;">-</span>z iSymbolSize;  <span style="color: #008000;">// 現在のシンボルサイズを取得</span>
get <span style="color: #000080;">%</span>C <span style="color: #000080;">-</span>cl iLineColor;  <span style="color: #008000;">// 現在の線の色を取得</span>
iUseLine <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
<span style="color: #008000;">// ダイアログを開く</span>
getn <span style="color: #000000;">(</span>Symbol Size<span style="color: #000000;">)</span> iSymbolSize
     <span style="color: #000000;">(</span>Use Line<span style="color: #000000;">)</span> iUseLine<span style="color: #000000;">:</span>2s
     <span style="color: #000000;">(</span>Line Color<span style="color: #000000;">)</span> iLineColor<span style="color: #000000;">:</span>@C
     <span style="color: #000000;">(</span>Set Plot Style<span style="color: #000000;">)</span>;
<span style="color: #008000;">// 折れ線の場合</span>
if<span style="color: #000000;">(</span>iUseLine <span style="color: #000080;">==</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
    set <span style="color: #000080;">%</span>C <span style="color: #000080;">-</span>l <span style="color: #0000dd;">1</span>;           <span style="color: #008000;">// 線を表示</span>
    set <span style="color: #000080;">%</span>C <span style="color: #000080;">-</span>cl iLineColor; <span style="color: #008000;">// 線の色を設定</span>
<span style="color: #000000;">}</span>
<span style="color: #008000;">// .. そうでなければ</span>
else
    set <span style="color: #000080;">%</span>C <span style="color: #000080;">-</span>l <span style="color: #0000dd;">0</span>;           <span style="color: #008000;">// 線を非表示</span>
set <span style="color: #000080;">%</span>C <span style="color: #000080;">-</span>z iSymbolSize;     <span style="color: #008000;">// シンボルサイズを設定</span></pre>
<hr />



    