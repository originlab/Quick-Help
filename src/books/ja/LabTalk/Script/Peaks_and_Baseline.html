<h1 class="firstheading">ピークと基線</h1><p class='urlname' style='display: none'>Peaks-and-Baseline</p>
<p>このセクションでは、ピークと基線の計算を実行するOriginのXファンクション、特に<span class="OIndex">スペクトル分析</span>で役立つ分析を扱います。
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>内容</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#X-Functions_For_Peak_Analysis"><span class="tocnumber">1</span> <span class="toctext">ピーク分析のためのXファンクション</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Creating_a_Baseline"><span class="tocnumber">2</span> <span class="toctext">基線の作成</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Finding_Peaks"><span class="tocnumber">3</span> <span class="toctext">ピークの検索</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Integrating_and_Fitting_Peaks"><span class="tocnumber">4</span> <span class="toctext">ピークの積分とフィット</span></a></li>
</ul>
</div>

<h2><a name="X-Functions_For_Peak_Analysis"></a><span class="mw-headline">ピーク分析のためのXファンクション</span></h2>
<p>次の表は、<span class="OIndex">ピーク分析</span>で利用できるXファンクションを一覧表示します。これらの関数についての情報は、Xファンクションリファレンスヘルプにあります。
</p>
<table class="simple">
<tr>
<th> 名前</th>
<th> 説明
</th></tr>
<tr>
<td> <a class="external text" href="../../XFunction/X-Function/Pa.html">pa</a>
</td>
<td>
<p>事前に保存した<b>ピークアナライザ</b>テーマファイルを使ってピーク分析を実行します。
</p>
</td></tr>
<tr>
<td> <a class="external text" href="../../XFunction/X-Function/PaMultiY.html">paMultiY</a>
</td>
<td> 複数のYデータセットに対してピーク分析のバッチ処理を実行します。
</td></tr>
<tr>
<td> <a class="external text" href="../../XFunction/X-Function/PkFind.html">pkFind</a>
</td>
<td>
<p>ピークを検出します。 
</p>
</td></tr>
<tr>
<td> <a class="external text" href="../../XFunction/X-Function/Fitpeaks.html">fitpeaks</a>
</td>
<td>
<p>複数ピークをフィットします。
</p>
</td></tr>
<tr>
<td> <a class="external text" href="../../XFunction/X-Function/Blauto.html">blauto</a>
</td>
<td>
<p>基線のアンカーポイントを作成します。
</p>
</td></tr>
<tr>
<td> <a class="external text" href="../../XFunction/X-Function/Interp1xy.html">interp1xy</a>
</td>
<td>
<p>基線のアンカーポイントを補間し、基線を作成します。 
</p>
</td></tr>
<tr>
<td> <a class="external text" href="../../XFunction/X-Function/Subtract_ref.html">subtract_ref</a>
</td>
<td>
<p>既存の基線データセットを元のデータから減算します。 
</p>
</td></tr>
<tr>
<td> <a class="external text" href="../../XFunction/X-Function/Smooth.html">smooth</a>
</td>
<td>
<p>ピーク分析を実行する前に入力をスムージングします。 
</p>
</td></tr>
<tr>
<td> <a class="external text" href="../../XFunction/X-Function/Integ1.html">integ1</a>
</td>
<td>
<p>選択した範囲またはピークに積分を実行します。 
</p>
</td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Peaks_and_Baseline/Tip_icon.png" width="57"  border="0" /></td><td><p>基線の処理やその他のオプションを必要としないピークに対して、ピーク関数を使って非線形フィットを実行できます。スクリプトから非線形フィットを実行する詳細な情報は、<a href="../../LabTalk/Category/LT_Curve_Fitting.html" title="カテゴリー:LT カーブフィット">曲線フィット</a>セクションをご覧ください。
</p></td></tr></table>
<p>次のセクションは、ピーク分析のサンプルを提供するものです。
</p>
<h2><a name="Creating_a_Baseline"></a><span class="mw-headline">基線を作成する</span></h2>
<p>このサンプルは、サンプルデータファイルをインポートし、<b><a class="external text" href="../../XFunction/X-Function/Blauto.html">blauto</a></b> Xファンクションを使って、<span class="OIndex">基線</span>のアンカーポイントを作成します。
</p>
<pre class="lt" style="font-family:monospace;">newbook;
filepath<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Samples\Spectroscopy\Peaks on Exponential Baseline.dat&quot;</span>;
fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> filepath<span style="color: #000080;">$</span>;
impASC;
&nbsp;
<span style="color: #008000;">//20個の基線のアンカーポイントを作成</span>
range rData <span style="color: #000080;">=</span> <span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">)</span>, rBase <span style="color: #000080;">=</span><span style="color: #000000;">(</span><span style="color: #0000dd;">3</span>, <span style="color: #0000dd;">4</span><span style="color: #000000;">)</span>;
blauto iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span>rData number<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">20</span> oy<span style="color: #000000;">:</span><span style="color: #000080;">=</span>rBase;</pre>
<p>同じグラフにデータとアンカーポイントをプロットします。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// データの折れ線グラフをプロット</span>
plotxy rData <span style="color: #0000dd;">200</span> o<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span><span style="color: #000080;">&lt;</span>new<span style="color: #000080;">&gt;</span><span style="color: #000000;">]</span>;
<span style="color: #008000;">// 基線のポイントを同じレイヤに散布図でプロット</span>
plotxy rBase <span style="color: #0000dd;">201</span> color<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span> o<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span>;</pre>
<h2><a name="Finding_Peaks"></a><span class="mw-headline">ピークを検索する</span></h2>
<p>このサンプルは、<a class="external text" href="../../XFunction/X-Function/PkFind.html"><b>pkfind</b></a> Xファンクションを使って、XYデータの<span class="OIndex">ピークを探し</span>ます。
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// サンプルのパルスデータをインポート</span>
newbook;
fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Spectroscopy\Sample Pulses.dat&quot;</span>;
impASC;
<span style="color: #008000;">// ピーク高さ0.2以上のすべての正ピークを探す</span>
range rin<span style="color: #000080;">=</span><span style="color: #000000;">(</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">)</span>;
range routx <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>, routy<span style="color: #000080;">=</span><span style="color: #0000dd;">4</span>;
pkfind iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span>rin dir<span style="color: #000000;">:</span><span style="color: #000080;">=</span>p method<span style="color: #000000;">:</span><span style="color: #000080;">=</span>max npts<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">5</span> filter<span style="color: #000000;">:</span><span style="color: #000080;">=</span>h value<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0.2</span>
       ocenter<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>none<span style="color: #000080;">&gt;</span> ocenter_x<span style="color: #000000;">:</span><span style="color: #000080;">=</span>routx ocenter_y<span style="color: #000000;">:</span><span style="color: #000080;">=</span>routy;</pre>
<p>データを折れ線グラフでプロットし、ピークのxyデータを散布図でプロット
</p>
<pre class="lt" style="font-family:monospace;">plotxy iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span>rin plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">200</span>;
<span style="color: #008000;">// x出力列をXとしてセットし、Y列をプロット</span>
routx.<span style="color: #000080;">type</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">4</span>; 
plotxy iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span>routy plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">201</span> color<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span> o<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;</pre>
<h2><a name="Integrating_and_Fitting_Peaks"></a><span class="mw-headline">ピークの積分とフィット</span></h2>
<p>Xファンクションは、直接<span class="OIndex">ピークを積分するか</span>、複数のピークをフィットすることを目的にするよう指定します。そのため、ピークフィットまたは積分を実行するには、まず、<b>ピークアナライザ</b>ダイアログを作成し、それをテーマファイルとして保存します。テーマファイルを保存したら、 <a class="external text" href="../../XFunction/X-Function/Pa.html"><b>pa</b></a> または <a class="external text" href="../../XFunction/X-Function/PaMultiY.html"><b>paMultiY</b></a> Xファンクションを利用して、スクリプトから積分またはピークフィットを実行します。
</p>


    