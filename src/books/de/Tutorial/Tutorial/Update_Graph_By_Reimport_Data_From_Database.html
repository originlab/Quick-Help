<h1 class="firstHeading">Diagramm durch Neuimport von Daten aus Datenbank aktualisieren</h1>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>Inhalt</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1"><a href="#Summary"><span class="tocnumber">1</span> <span class="toctext">Zusammenfassung</span></a></li>

      <li class="toclevel-1 tocsection-2"><a href="#What_you_will_learn"><span class="tocnumber">2</span> <span class="toctext">Was Sie lernen werden</span></a></li>

      <li class="toclevel-1 tocsection-3">
        <a href="#Steps"><span class="tocnumber">3</span> <span class="toctext">Schritte</span></a>

        <ul>
          <li class="toclevel-2 tocsection-4"><a href="#Import_Data_from_Database"><span class="tocnumber">3.1</span><span class="toctext">Daten aus einer Datenbank importieren</span></a></li>

          <li class="toclevel-2 tocsection-5"><a href="#Create_Pivot_Table_and_Do_Column_Calculations"><span class="tocnumber">3.2</span> <span class="toctext">Pivot-Tabelle erstellen und Spaltenberechnungen durchführen</span></a></li>

          <li class="toclevel-2 tocsection-6"><a href="#Create_Graph_and_Customize_Graph"><span class="tocnumber">3.3</span> <span class="toctext">Diagramm erstellen und benutzerdefiniert anpassen</span></a></li>

          <li class="toclevel-2 tocsection-7"><a href="#Add_Button_to_Run_LabTalk_Script"><span class="tocnumber">3.4</span> <span class="toctext">Schaltfläche zum Ausführen eines LabTalk-Skripts hinzufügen</span></a></li>
        </ul>
      </li>
    </ul>
  </div>

  <h2><a name="Summary"></a><span class="mw-headline">Zusammenfassung</span></h2>

  <p>Dieses Tutorial zeigt, wie Daten aus der Datenbank importiert und diese Daten analysiert und grafisch dargestellt werden. Es wird eine Schaltfläche zum Diagramm hinzugefügt, um die Datenbankanfrage zu aktualisieren und Daten mit Hilfe von Origins LabTalk-Skript erneut zu importieren.</p>

  <p>Die SQL-Datenbank, die hier verwendet wird, ist die <a class="external text" href="http://msftdbprodsamples.codeplex.com/releases/view/93587" target="_blank">AdventureWorks-Datenbank</a>. Einzelheiten dazu, wie eine AdventureWorks-Datenbank verbunden wird, finden Sie auf der <a class="external text" href="http://msftdbprodsamples.codeplex.com/releases/view/93587" target="_blank">Webseite von CodePlex</a>.</p>

  <table class="noborder">
    <tr>
      <td style="vertical-align:top" width="60"><img src="../images/Update_Graph_By_Reimport_Data_From_Database/Alert_icon.png" width="57" border="0" alt=""></td>

      <td>
        <p>Die Schritte im Tutorial dienen nur Demonstrationszwecken, was Anwender lokal mit ihrer Datenbank machen könnten. Bitte befolgen Sie die Schritte nicht.</p>
      </td>
    </tr>
  </table>

  <h2><a name="What_you_will_learn"></a><span class="mw-headline">Was Sie lernen werden</span></h2>

  <p>Dieses Tutorial zeigt Ihnen, wie Sie:</p>

  <ul>
    <li>Daten aus einer Datenbank importieren unter Verwendung von LabTalk-Variablen in der SQL-Anfrage, die den Datenbereich der Anfrage definieren.</li>

    <li>eine Pivot-Tabelle erstellen und ein Diagramm zum Analysieren der Daten zeichnen.</li>

    <li>eine Schaltfläche zum Diagramm hinzufügen, um den Datenbereich der Anfrage zu modifizieren und einen neuen Import aus der Datenbank durchzuführen.</li>
  </ul>

  <h2><a name="Steps"></a><span class="mw-headline">Schritte</span></h2>

  <p><font color="blue"><b>Angenommen, Sie haben bereits einen SQL-Server mit dem Namen <i>AdventureWorks2008</i> auf einem Server <i>noho</i> eingerichtet.</b></font></p>

  <h3><a name="Import_Data_from_Database"></a><span class="mw-headline">Daten aus einer Datenbank importieren</span></h3>

  <ol>
    <li>Öffnen Sie ein neues Projekt. Öffnen Sie den <b>SQL-Editor</b>, indem Sie auf die Schaltfläche <b>SQL-Editor öffnen</b> auf der Symbolleiste <b>Datenbankzugriff</b> klicken.

      <dl>
        <dd><a class="image"><img alt="ImportDataDatabase 1.png" src="../images/Update_Graph_By_Reimport_Data_From_Database/ImportDataDatabase_1.png" width="257"></a></dd>
      </dl>
    </li>

    <li>Wählen Sie im Menü <b>Datei: Verbindungszeichenkette bearbeiten</b> und geben Sie die Verbindungszeichenkette unten im Textfeld ein.
      <pre class="sql" style="font-family:monospace;">
Provider<span style="color: #66cc66;">=</span>SQLOLEDB<span style="color: #66cc66;">.</span>1; Password<span style="color: #66cc66;">=</span>labtalk2015; Persist Security Info<span style="color: #66cc66;">=</span><span style="color: #993333; font-weight: bold;">TRUE</span>; <span style="color: #993333; font-weight: bold;">USER</span> ID<span style="color: #66cc66;">=</span><span style="color: #993333; font-weight: bold;">CONNECT</span>; Initial Catalog<span style="color: #66cc66;">=</span>AdventureWorks2008; <span style="color: #993333; font-weight: bold;">DATA</span> <span style="color: #993333; font-weight: bold;">SOURCE</span><span style="color: #66cc66;">=</span>noho
</pre>
    </li>

    <li>Klicken Sie auf die Schaltfläche <b>Test</b>, um zu prüfen, ob die Verbindung in Ordnung ist. Wenn er in Ordnung ist, klicken Sie auf die Schaltfläche <b>OK</b>, um die Verbindung zur Datenbank herzustellen.</li>

    <li>Wählen Sie im Menü des <b>SQL-Editors</b> <b>Anfrage: LabTalk...</b>, um den Dialog <b>Einstellungen der Unterstützung von LabTalk</b> zu öffnen. Aktivieren Sie in diesem Dialog das Kontrollkästchen <b>Substitution durch LabTalk (%, $) aktivieren</b> und geben Sie folgendes Skript in das Textfeld ein.
      <pre class="lt" style="font-family:monospace;">
string pastFrom<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">""</span>; string pastTo<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">""</span>; string curFrom<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">""</span>; string curTo<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">""</span>; if<span style="color: #000000;">(</span>exist<span style="color: #000000;">(</span>strPast1<span style="color: #000080;">$</span>, <span style="color: #0000dd;">18</span><span style="color: #000000;">)</span> <span style="color: #000080;">==</span> <span style="color: #0000dd;">18</span><span style="color: #000000;">)</span>  <span style="color: #008000;">// Check if strPast1$ has value</span> <span style="color: #000000;">{</span> <span style="color: #008000;">// If strPast1$ has value</span> pastFrom<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> strPast1<span style="color: #000080;">$</span>;  <span style="color: #008000;">// Assign strPast1$ to pastFrom$</span> <span style="color: #000000;">}</span> else  <span style="color: #008000;">// If strPast1$ is not defined</span> <span style="color: #000000;">{</span> pastFrom<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"1/1/2003"</span>;  <span style="color: #008000;">// Assign a const string to pastFrom$</span> <span style="color: #000000;">}</span> if<span style="color: #000000;">(</span>exist<span style="color: #000000;">(</span>strPast2<span style="color: #000080;">$</span>, <span style="color: #0000dd;">18</span><span style="color: #000000;">)</span> <span style="color: #000080;">==</span> <span style="color: #0000dd;">18</span><span style="color: #000000;">)</span> <span style="color: #000000;">{</span> pastTo<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> strPast2<span style="color: #000080;">$</span>; <span style="color: #000000;">}</span> else <span style="color: #000000;">{</span> pastTo<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"3/31/2003"</span>; <span style="color: #000000;">}</span> if<span style="color: #000000;">(</span>exist<span style="color: #000000;">(</span>strCurrent1<span style="color: #000080;">$</span>, <span style="color: #0000dd;">18</span><span style="color: #000000;">)</span> <span style="color: #000080;">==</span> <span style="color: #0000dd;">18</span><span style="color: #000000;">)</span> <span style="color: #000000;">{</span> curFrom<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> strCurrent1<span style="color: #000080;">$</span>; <span style="color: #000000;">}</span> else <span style="color: #000000;">{</span> curFrom<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"4/1/2003"</span>; <span style="color: #000000;">}</span> if<span style="color: #000000;">(</span>exist<span style="color: #000000;">(</span>strCurrent2<span style="color: #000080;">$</span>, <span style="color: #0000dd;">18</span><span style="color: #000000;">)</span> <span style="color: #000080;">==</span> <span style="color: #0000dd;">18</span><span style="color: #000000;">)</span> <span style="color: #000000;">{</span> curTo<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> strCurrent2<span style="color: #000080;">$</span>; <span style="color: #000000;">}</span> else <span style="color: #000000;">{</span> curTo<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"6/30/2003"</span>; <span style="color: #000000;">}</span>
</pre>

      <dl>
        <dd><a class="image"><img alt="Update Graph Database 01.png" src="../images/Update_Graph_By_Reimport_Data_From_Database/Update_Graph_Database_01.png" width="545"></a></dd>
      </dl>
    </li>

    <li>Klicken Sie auf OK, um zum SQL-Editor zurückzukehren. Geben Sie im rechten Textfeld die folgenden SQL-Aussagen ein.
      <pre class="sql" style="font-family:monospace;">
<span style="color: #993333; font-weight: bold;">SELECT</span> OrderDateTotalDueAndProductSubcategoryID<span style="color: #66cc66;">.</span>OrderDate <span style="color: #993333; font-weight: bold;">AS</span> <span style="color: #ff0000;">'Order Date'</span><span style="color: #66cc66;">,</span> <span style="color: #ff0000;">'Date Range'</span> <span style="color: #66cc66;">=</span> <span style="color: #993333; font-weight: bold;">CASE</span> <span style="color: #993333; font-weight: bold;">WHEN</span> OrderDateTotalDueAndProductSubcategoryID<span style="color: #66cc66;">.</span>OrderDate <span style="color: #66cc66;">&lt;</span> <span style="color: #ff0000;">'%(curFrom$)'</span> <span style="color: #993333; font-weight: bold;">THEN</span> <span style="color: #ff0000;">'Past'</span> <span style="color: #993333; font-weight: bold;">ELSE</span> <span style="color: #ff0000;">'Current'</span> <span style="color: #993333; font-weight: bold;">END</span><span style="color: #66cc66;">,</span> Production<span style="color: #66cc66;">.</span>ProductSubcategory<span style="color: #66cc66;">.</span>Name <span style="color: #993333; font-weight: bold;">AS</span> <span style="color: #ff0000;">'Subcategory Name'</span><span style="color: #66cc66;">,</span> OrderDateTotalDueAndProductSubcategoryID<span style="color: #66cc66;">.</span>TotalDue <span style="color: #993333; font-weight: bold;">AS</span> <span style="color: #ff0000;">'Total Due'</span> <span style="color: #993333; font-weight: bold;">FROM</span> <span style="color: #66cc66;">(</span><span style="color: #993333; font-weight: bold;">SELECT</span> OrderDateAndTotalDue<span style="color: #66cc66;">.</span>OrderDate<span style="color: #66cc66;">,</span> OrderDateAndTotalDue<span style="color: #66cc66;">.</span>TotalDue<span style="color: #66cc66;">,</span> Production<span style="color: #66cc66;">.</span>Product<span style="color: #66cc66;">.</span>ProductSubcategoryID <span style="color: #993333; font-weight: bold;">FROM</span> <span style="color: #66cc66;">(</span><span style="color: #993333; font-weight: bold;">SELECT</span> Sales<span style="color: #66cc66;">.</span>SalesOrderHeader<span style="color: #66cc66;">.</span>OrderDate<span style="color: #66cc66;">,</span> Sales<span style="color: #66cc66;">.</span>SalesOrderDetail<span style="color: #66cc66;">.</span>ProductID<span style="color: #66cc66;">,</span> Sales<span style="color: #66cc66;">.</span>SalesOrderHeader<span style="color: #66cc66;">.</span>TotalDue <span style="color: #993333; font-weight: bold;">FROM</span> Sales<span style="color: #66cc66;">.</span>SalesOrderHeader <span style="color: #993333; font-weight: bold;">INNER</span> <span style="color: #993333; font-weight: bold;">JOIN</span> Sales<span style="color: #66cc66;">.</span>SalesOrderDetail <span style="color: #993333; font-weight: bold;">ON</span> Sales<span style="color: #66cc66;">.</span>SalesOrderHeader<span style="color: #66cc66;">.</span>SalesOrderID<span style="color: #66cc66;">=</span>Sales<span style="color: #66cc66;">.</span>SalesOrderDetail<span style="color: #66cc66;">.</span>SalesOrderID <span style="color: #993333; font-weight: bold;">WHERE</span> <span style="color: #66cc66;">(</span>Sales<span style="color: #66cc66;">.</span>SalesOrderHeader<span style="color: #66cc66;">.</span>OrderDate <span style="color: #993333; font-weight: bold;">BETWEEN</span> <span style="color: #ff0000;">'%(pastFrom$)'</span> <span style="color: #993333; font-weight: bold;">AND</span> <span style="color: #ff0000;">'%(pastTo$)'</span> <span style="color: #993333; font-weight: bold;">OR</span> Sales<span style="color: #66cc66;">.</span>SalesOrderHeader<span style="color: #66cc66;">.</span>OrderDate <span style="color: #993333; font-weight: bold;">BETWEEN</span> <span style="color: #ff0000;">'%(curFrom$)'</span> <span style="color: #993333; font-weight: bold;">AND</span> <span style="color: #ff0000;">'%(curTo$)'</span><span style="color: #66cc66;">)</span><span style="color: #66cc66;">)</span> <span style="color: #993333; font-weight: bold;">AS</span> OrderDateAndTotalDue <span style="color: #993333; font-weight: bold;">INNER</span> <span style="color: #993333; font-weight: bold;">JOIN</span> Production<span style="color: #66cc66;">.</span>Product <span style="color: #993333; font-weight: bold;">ON</span> OrderDateAndTotalDue<span style="color: #66cc66;">.</span>ProductID<span style="color: #66cc66;">=</span>Production<span style="color: #66cc66;">.</span>Product<span style="color: #66cc66;">.</span>ProductID<span style="color: #66cc66;">)</span> <span style="color: #993333; font-weight: bold;">AS</span> OrderDateTotalDueAndProductSubcategoryID <span style="color: #993333; font-weight: bold;">INNER</span> <span style="color: #993333; font-weight: bold;">JOIN</span> Production<span style="color: #66cc66;">.</span>ProductSubcategory <span style="color: #993333; font-weight: bold;">ON</span> OrderDateTotalDueAndProductSubcategoryID<span style="color: #66cc66;">.</span>ProductSubcategoryID<span style="color: #66cc66;">=</span>Production<span style="color: #66cc66;">.</span>ProductSubcategory<span style="color: #66cc66;">.</span>ProductSubcategoryID
</pre>

      <dl>
        <dd><a class="image"><img alt="Update Graph Database 02.png" src="../images/Update_Graph_By_Reimport_Data_From_Database/Update_Graph_Database_02.png" width="618"></a></dd>
      </dl>

      <p>Wie Sie sehen können, werden in den Aussagen drei LabTalk-Variablen verwendet.</p>
    </li>

    <li>Klicken Sie einfach auf die letzte Schaltfläche der Symbolleiste und Sie können die Substitutionen sehen.

      <dl>
        <dd><a class="image"><img alt="Update Graph Database 03.png" src="../images/Update_Graph_By_Reimport_Data_From_Database/Update_Graph_Database_03.png" width="838"></a></dd>
      </dl>
    </li>

    <li>Wählen Sie im Menü <b>Datei: Im aktiven Arbeitsblatt speichern</b>, um diese Einstellungen im Arbeitsblatt zu speichern. Klicken Sie auf die Schaltfläche <b>Daten in Arbeitsblatt importieren</b> <a class="image"><img alt="Button db Import Data.png" src="../images/Update_Graph_By_Reimport_Data_From_Database/Button_db_Import_Data.png" width="25"></a>, um die Daten in das Arbeitsblatt zu importieren, und schließen Sie dann den SQL-Editor. Sie können die importierten Daten sehen, wie das folgende Bild zeigt. Ein gelbes Symbol wird oben links im Arbeitsblatt angezeigt, um zu kennzeichnen, dass eine Datenbankverbindung im Arbeitsblatt gespeichert ist.

      <dl>
        <dd><a class="image"><img alt="Update Graph Database 04.png" src="../images/Update_Graph_By_Reimport_Data_From_Database/Update_Graph_Database_04.png" width="468"></a></dd>
      </dl>
    </li>
  </ol>

  <h3><a name="Create_Pivot_Table_and_Do_Column_Calculations"></a><span class="mw-headline">Pivot-Tabelle erstellen und Spaltenberechnungen durchführen</span></h3>

  <ol>
    <li>Beginnen Sie mit den importierten Daten. Markieren Sie Spalte C und wählen Sie im Menü <b>Worksheet: Pivot-Tabelle</b>, um den Dialog <b>Data Manipulation\Worksheet: wpivot</b> zu öffnen.</li>

    <li>Setzen Sie die Neuberechnung auf Auto.</li>

    <li>Wählen Sie Spalte B für <b>Spaltenquelle der Pivot-Tabelle</b>, indem Sie auf die dreieckige Schaltfläche rechts klicken.</li>

    <li>Wählen Sie <i>Summe</i> unter <b>Zusammenfassen nach</b>. Sie können oben dann die Zeile <b>Datenquelle der Pivot-Tabelle</b> sehen. Wählen Sie einfach Spalte D für sie, indem Sie auf die dreieckige Schaltfläche rechts klicken.</li>

    <li>Erweitern Sie den Knoten <b>Optionen</b> und setzen Sie <b>Ausgabespalten sortieren</b> auf <i>Kein</i>.

      <dl>
        <dd><a class="image"><img alt="Update Graph Database 05.png" src="../images/Update_Graph_By_Reimport_Data_From_Database/Update_Graph_Database_05.png" width="464"></a></dd>
      </dl>
    </li>

    <li>Klicken Sie auf die Schaltfläche <b>OK</b>, um die Pivot-Tabelle mit Hilfe der Einstellungen zu erstellen.

      <dl>
        <dd><a class="image"><img alt="Update Graph Database 06.png" src="../images/Update_Graph_By_Reimport_Data_From_Database/Update_Graph_Database_06.png" width="456"></a></dd>
      </dl>
    </li>

    <li>Klicken Sie zweimal auf die Schaltfläche <b>Neue Spalten anhängenColumns</b> <a class="image"><img alt="Update Graph Database 07.png" src="../images/Update_Graph_By_Reimport_Data_From_Database/Update_Graph_Database_07.png" width="20"></a>, um zwei Spalten hinzuzufügen.</li>

    <li>Ändern Sie ihren Langnamen in <i>Percent Change</i> bzw. <i>Gain/Loss</i>.</li>

    <li>In F(x)= Zelle der Spalte D:

      <dl>
        <dd>Wenn Sie Origin 2017 verwenden, geben Sie ein:</dd>
      </dl>
      <pre class="lt" style="font-family:monospace;">
B<span style="color: #000080;">==</span><span style="color: #0000dd;">0</span>? <span style="color: #0000dd;">100</span> <span style="color: #000000;">:</span> <span style="color: #0000dd;">100</span><span style="color: #000080;">*</span><span style="color: #000000;">(</span>C<span style="color: #000080;">-</span>B<span style="color: #000000;">)</span><span style="color: #000080;">/</span>B
</pre>

      <dl>
        <dd>Wenn Sie Versionen vor Origin 2017 verwenden, geben Sie ein:</dd>
      </dl>
      <pre class="lt" style="font-family:monospace;">
col<span style="color: #000000;">(</span>B<span style="color: #000000;">)</span><span style="color: #000080;">==</span><span style="color: #0000dd;">0</span>? <span style="color: #0000dd;">100</span> <span style="color: #000000;">:</span> <span style="color: #0000dd;">100</span><span style="color: #000080;">*</span><span style="color: #000000;">(</span>col<span style="color: #000000;">(</span>C<span style="color: #000000;">)</span><span style="color: #000080;">-</span>col<span style="color: #000000;">(</span>B<span style="color: #000000;">)</span><span style="color: #000000;">)</span><span style="color: #000080;">/</span>col<span style="color: #000000;">(</span>B<span style="color: #000000;">)</span>
</pre>
    </li>

    <li>In F(x)= Zelle der Spalte E:

      <dl>
        <dd>Wenn Sie Origin 2017 verwenden, geben Sie ein:</dd>
      </dl>
      <pre class="lt" style="font-family:monospace;">
D <span style="color: #000080;">&gt;</span> <span style="color: #0000dd;">0</span>? <span style="color: #0000dd;">12</span> <span style="color: #000000;">:</span> <span style="color: #0000dd;">2</span>
</pre>

      <dl>
        <dd>Wenn Sie Versionen vor Origin 2017 verwenden, geben Sie ein:</dd>
      </dl>
      <pre class="lt" style="font-family:monospace;">
col<span style="color: #000000;">(</span>D<span style="color: #000000;">)</span> <span style="color: #000080;">&gt;</span> <span style="color: #0000dd;">0</span>? <span style="color: #0000dd;">12</span> <span style="color: #000000;">:</span> <span style="color: #0000dd;">2</span>
</pre>
    </li>

    <li style="list-style: none">
      <p>Das Ergebnis sieht folgendermaßen aus:</p>

      <dl>
        <dd><a class="image"><img alt="Update Graph Database 10.png" src="../images/Update_Graph_By_Reimport_Data_From_Database/Update_Graph_Database_10.png" width="625"></a></dd>
      </dl>
    </li>
  </ol>

  <h3><a name="Create_Graph_and_Customize_Graph"></a><span class="mw-headline">Diagramm erstellen und benutzerdefiniert anpassen</span></h3>

  <ol>
    <li>Markieren Sie im Arbeitsblatt <b>Pivot1</b> die Spalten C und D und wählen Sie im Menü <b>Zeichnen: Mehrere Felder: Stapeln</b>.</li>

    <li>Ändern Sie im Dialog die Einstellungen, wie folgt.

      <dl>
        <dd><a class="image"><img alt="Update Graph Database 14.png" src="../images/Update_Graph_By_Reimport_Data_From_Database/Update_Graph_Database_14.png" width="529"></a></dd>
      </dl>
    </li>

    <li>Klicken Sie auf OK. Es wird ein Diagramm mit zwei Feldern erstellt.

      <dl>
        <dd><a class="image"><img alt="Update Graph Database 15.png" src="../images/Update_Graph_By_Reimport_Data_From_Database/Update_Graph_Database_15.png" width="642"></a></dd>
      </dl>
    </li>

    <li>Klicken Sie doppelt auf die untere Achse im linken Bedienfeld. Setzen Sie auf der Registerkarte <b>Beschriftung der Hilfsstriche</b> den <b>Teilungsfaktor</b> auf <i>1000000</i> (eine Million) und das <b>Suffix</b> auf <i>M</i>. Setzen Sie auf der Registerkarte Skalierung <b>Von</b> und <b>Bis</b> auf die Werte <i>0</i> bis <i>120</i>. Setzen Sie den Typ der Großen Hilfsstriche auf Nach Inkrement und den Wert auf 20. Wählen Sie Vertikal im linken Bedienfeld des Dialogs Achsen. Setzen Sie Neuskalierung auf Auto. Klicken Sie auf OK.</li>

    <li>Klicken Sie doppelt auf die untere Achse im rechten Bedienfeld. Setzen Sie auf der Registerkarte <b>Skalierung</b> die Werte für <b>Von</b> und <b>Bis</b> auf <i>-100</i> und <i>400</i>. Setzen Sie den Typ der Großen Hilfsstriche auf Nach Inkrement und den Wert auf 100. Wählen Sie Vertikal im linken Bedienfeld des Dialogs Achsen. Setzen Sie Neuskalierung auf Auto. Gehen Sie zur Registerkarte <b>Gitternetze</b>. Im linken Bedienfeld wird jetzt <b>Horizontal</b> gezeigt. Aktivieren Sie das Kontrollkästchen Y=0 unten auf der Registerkarte. Wählen Sie auf der Registerkarte <b>Spezielle Hilfsstriche</b> die Option Unten im linken Bedienfeld. Setzen Sie in der Zeile <b>Achsenbeginn</b> die Option <b>Zeigen</b> auf <i>Verstecken</i>. Ansonsten überschneidet sich die letzte Hilfsstrichsbeschriftung des linken Diagramms mit der ersten Beschriftung des rechten Diagramms. Klicken Sie auf OK.</li>

    <li>Löschen Sie Legenden, die Hilfsstrichsbeschriftungen der rechten Achse etc., so dass das Diagramm folgendermaßen aussieht.

      <dl>
        <dd><a class="image"><img alt="Update Graph Database 16.png" src="../images/Update_Graph_By_Reimport_Data_From_Database/Update_Graph_Database_16.png" width="637"></a></dd>
      </dl>
    </li>

    <li>Legen Sie die Füllfarbe des linken Balkendiagramms auf Zyan hell fest.</li>

    <li>Legen Sie die Füllfarbe des rechten Balkendiagramms auf den Index von Spalte E (Gain/Loss) fest. Aktivieren Sie die Beschriftungen und setzen Sie <b>Beschriftungsformat</b> auf <i>Benutzerdefiniert</i> und die <b>Formatzeichenkette</b> auf <i>$(Y, .1)%</i>, um den Y-Wert mit 1 Dezimalstelle und dem Suffix % anzuzeigen.</li>

    <li>Sie können die Achse benutzerdefiniert anpassen, zum Beispiel die Achsenrahmen oben, rechts und unten löschen. Blenden Sie die Gitternetzlinien ein. Verbergen Sie die großen und kleinen Hilfsstriche auf der linken Achse etc. Das Diagramm sieht dann folgendermaßen aus:

      <dl>
        <dd><a class="image"><img alt="Update Graph Database 18.png" src="../images/Update_Graph_By_Reimport_Data_From_Database/Update_Graph_Database_18.png" width="635"></a></dd>
      </dl>
    </li>
  </ol>

  <h3><a name="Add_Button_to_Run_LabTalk_Script"></a><span class="mw-headline">Schaltfläche zum Ausführen eines LabTalk-Skripts hinzufügen</span></h3>

  <ol>
    <li>Klicken Sie mit der rechten Maustaste unten rechts auf das Diagramm und wählen Sie <b>Text hinzufügen</b>. Geben Sie <b>Update</b> ein, um eine Textbeschriftung zu erstellen.</li>

    <li>Klicken Sie mit der rechten Maustaste auf den Text <b>Update</b> und wählen Sie <b>Einstellungen</b> im Kontextmenü, um den Dialog <b>Textobjekt</b> zu öffnen. Gehen Sie zur Registerkarte <b>Programmierung</b>. Hinweis: Wählen Sie in Versionen vor Origin 2017 <b>Programmierablauf</b> im Menü, um den Dialog <b>Programmierablauf</b> zu öffnen.</li>

    <li>Setzen Sie <b>Kriterien für Skriptausführung</b> auf <i>Mausklick</i> und geben Sie das folgende Skript in das untere Textfeld ein. Klicken Sie auf <b>OK</b>.
      <pre class="lt" style="font-family:monospace;">
double pastDate1 <span style="color: #000080;">=</span> date<span style="color: #000000;">(</span><span style="color: #0000dd;">1</span><span style="color: #000080;">/</span><span style="color: #0000dd;">1</span><span style="color: #000080;">/</span><span style="color: #0000dd;">2003</span><span style="color: #000000;">)</span>; double pastDate2 <span style="color: #000080;">=</span> date<span style="color: #000000;">(</span><span style="color: #0000dd;">3</span><span style="color: #000080;">/</span><span style="color: #0000dd;">31</span><span style="color: #000080;">/</span><span style="color: #0000dd;">2003</span><span style="color: #000000;">)</span>; double currentDate1 <span style="color: #000080;">=</span> date<span style="color: #000000;">(</span><span style="color: #0000dd;">4</span><span style="color: #000080;">/</span><span style="color: #0000dd;">1</span><span style="color: #000080;">/</span><span style="color: #0000dd;">2003</span><span style="color: #000000;">)</span>; double currentDate2 <span style="color: #000080;">=</span> date<span style="color: #000000;">(</span><span style="color: #0000dd;">6</span><span style="color: #000080;">/</span><span style="color: #0000dd;">30</span><span style="color: #000080;">/</span><span style="color: #0000dd;">2003</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// Check if strPast1$, strPast2$, strCurrent1$, strCurrent2$ exist the same time</span> if<span style="color: #000000;">(</span><span style="color: #000000;">(</span>exist<span style="color: #000000;">(</span>strPast1<span style="color: #000080;">$</span>, <span style="color: #0000dd;">18</span><span style="color: #000000;">)</span> <span style="color: #000080;">==</span> <span style="color: #0000dd;">18</span><span style="color: #000000;">)</span> <span style="color: #000080;">&amp;&amp;</span> <span style="color: #000000;">(</span>exist<span style="color: #000000;">(</span>strPast2<span style="color: #000080;">$</span>, <span style="color: #0000dd;">18</span><span style="color: #000000;">)</span> <span style="color: #000080;">==</span> <span style="color: #0000dd;">18</span><span style="color: #000000;">)</span> <span style="color: #000080;">&amp;&amp;</span> <span style="color: #000000;">(</span>exist<span style="color: #000000;">(</span>strCurrent1<span style="color: #000080;">$</span>, <span style="color: #0000dd;">18</span><span style="color: #000000;">)</span> <span style="color: #000080;">==</span> <span style="color: #0000dd;">18</span><span style="color: #000000;">)</span> <span style="color: #000080;">&amp;&amp;</span> <span style="color: #000000;">(</span>exist<span style="color: #000000;">(</span>strCurrent2<span style="color: #000080;">$</span>, <span style="color: #0000dd;">18</span><span style="color: #000000;">)</span> <span style="color: #000080;">==</span> <span style="color: #0000dd;">18</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span> <span style="color: #000000;">{</span> <span style="color: #008000;">// If yes, set to double value, so to show on the dialog</span> pastDate1 <span style="color: #000080;">=</span> date<span style="color: #000000;">(</span>strPast1<span style="color: #000080;">$</span><span style="color: #000000;">)</span>; pastDate2 <span style="color: #000080;">=</span> date<span style="color: #000000;">(</span>strPast2<span style="color: #000080;">$</span><span style="color: #000000;">)</span>; currentDate1 <span style="color: #000080;">=</span> date<span style="color: #000000;">(</span>strCurrent1<span style="color: #000080;">$</span><span style="color: #000000;">)</span>; currentDate2 <span style="color: #000080;">=</span> date<span style="color: #000000;">(</span>strCurrent2<span style="color: #000080;">$</span><span style="color: #000000;">)</span>; <span style="color: #000000;">}</span> <span style="color: #008000;">// Dialog for date settings</span> GetN <span style="color: #000000;">(</span>Last Seaon<span style="color: #000000;">)</span> <span style="color: #000000;">:</span>@G <span style="color: #000000;">(</span>From<span style="color: #000000;">)</span> pastDate1<span style="color: #000000;">:</span>@FD0 <span style="color: #000000;">(</span>To<span style="color: #000000;">)</span> pastDate2<span style="color: #000000;">:</span>@FD0 <span style="color: #000000;">(</span><span style="color: #000080;">-</span><span style="color: #000000;">)</span> <span style="color: #000000;">:</span>@G <span style="color: #000000;">(</span>Current Seaon<span style="color: #000000;">)</span> <span style="color: #000000;">:</span>@G <span style="color: #000000;">(</span>From<span style="color: #000000;">)</span> currentDate1<span style="color: #000000;">:</span>@FD0 <span style="color: #000000;">(</span>To<span style="color: #000000;">)</span> currentDate2<span style="color: #000000;">:</span>@FD0 <span style="color: #000000;">(</span><span style="color: #000080;">-</span><span style="color: #000000;">)</span> <span style="color: #000000;">:</span>@G <span style="color: #000000;">(</span>Set Date<span style="color: #000000;">)</span>; <span style="color: #008000;">// Get the set dates, and convert to string</span> string strPast1<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">$</span><span style="color: #000000;">(</span>pastDate1, D0<span style="color: #000000;">)</span>; string strPast2<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">$</span><span style="color: #000000;">(</span>pastDate2, D0<span style="color: #000000;">)</span>; string strCurrent1<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">$</span><span style="color: #000000;">(</span>currentDate1, D0<span style="color: #000000;">)</span>; string strCurrent2<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">$</span><span style="color: #000000;">(</span>currentDate2, D0<span style="color: #000000;">)</span>; <span style="color: #008000;">// Reimport data from database according to the set dates</span> dbimport iw<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">[</span>book1<span style="color: #000000;">]</span>sheet1<span style="color: #000080;">!</span>; range rPivot <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>Book1<span style="color: #000000;">]</span>Pivot1<span style="color: #000080;">!</span>;  <span style="color: #008000;">// Pivot table range</span> layer.<span style="color: #000080;">x</span>.<span style="color: #000080;">to</span> <span style="color: #000080;">=</span> rPivot.<span style="color: #000080;">maxRows</span><span style="color: #000080;">+</span><span style="color: #0000dd;">0.5</span>;  <span style="color: #008000;">// Set to value of vertical axis</span> rPivot.<span style="color: #000080;">runfilter</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>;  <span style="color: #008000;">// Run the data filter</span>
</pre>

      <p>Das Textobjekt verwandelt sich in eine Schaltfläche und das Skript darin wird ausgeführt, wenn Sie auf die Schaltfläche klicken.</p>

      <dl>
        <dd><a class="image"><img alt="Update Graph Database 30.png" src="../images/Update_Graph_By_Reimport_Data_From_Database/Update_Graph_Database_30.png" width="642"></a></dd>
      </dl>
    </li>

    <li>Klicken Sie auf diese Schaltfläche. Ein Dialog mit den Standarddaten (zum ersten Mal, falls nicht zum ersten Mal, die beim letzten Mal festgelegten Daten) wird aufgerufen.</li>

    <li>Ändern Sie den Zeitraum. Geben Sie zum Beispiel für Last Season Von 01.01.2004 Bis 31.03.2004 ein und für Current Season Von 01.04.2004 Bis 30.06.2004.

      <dl>
        <dd><a class="image"><img alt="Update Graph Database 31.png" src="../images/Update_Graph_By_Reimport_Data_From_Database/Update_Graph_Database_31.png" width="250"></a></dd>
      </dl>
    </li>

    <li>Klicken Sie auf <b>OK</b>. Die Daten aus dem festgelegten Datenbereich werden erneut ins Arbeitsblatt importiert und das Arbeitsblatt Pivot1 wird aktualisiert. Das Diagramm wird ebenfalls aktualisiert. Die Balkenfarbe wird auf den Index der Spalte Gain/Loss im Blatt Pivot1 gesetzt. Sie können einfach feststellen, dass es bei einem Produkt einen Verlust gibt.

      <dl>
        <dd><a class="image"><img alt="Update Graph Database 32.png" src="../images/Update_Graph_By_Reimport_Data_From_Database/Update_Graph_Database_32.png" width="639"></a></dd>
      </dl>
    </li>
  </ol>
