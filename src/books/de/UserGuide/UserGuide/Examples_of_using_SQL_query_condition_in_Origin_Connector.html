<h1 class="firstHeading">Referenz zur Verwendung der SQL-Abfrage mit dem Origin-Konnektor</h1>

  <p class='urlname' style='display: none'>Origin-Connect-Refer</p>

  <p>Seit Origin 2020 unterstützt der Origin-Dateikonnektor die Sprache der SQL-Abfrage zum Auswählen der gewünschten Daten, die in einer Origin-Projektdatei gespeichert sind. SQL arbeitet mit einfachen, deklarativen Anweisungen. Es macht die Datenextraktion flexibler, hilft beim Organisieren von Daten in einem Origin-Projekt und bei ihrer Pflege.</p>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>Inhalt</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1">
        <a href="#Syntax:"><span class="tocnumber">1</span> <span class="toctext">Syntax</span></a>

        <ul>
          <li class="toclevel-2 tocsection-2"><a href="#Range_to_search"><span class="tocnumber">1.1</span> <span class="toctext">Zu durchsuchender Bereich</span></a></li>

          <li class="toclevel-2 tocsection-3">
            <a href="#key_words_in_Condition"><span class="tocnumber">1.2</span> <span class="toctext">Schlüsselwörter in Bedingung</span></a>

            <ul>
              <li class="toclevel-3 tocsection-4"><a href="#Column_Type"><span class="tocnumber">1.2.1</span> <span class="toctext">Spaltentyp</span></a></li>

              <li class="toclevel-3 tocsection-5"><a href="#Column_Y"><span class="tocnumber">1.2.2</span> <span class="toctext">Column_Y</span></a></li>

              <li class="toclevel-3 tocsection-6"><a href="#Column_Z"><span class="tocnumber">1.2.3</span> <span class="toctext">Column_Z</span></a></li>

              <li class="toclevel-3 tocsection-7"><a href="#Column_SName"><span class="tocnumber">1.2.4</span> <span class="toctext">Column_SName</span></a></li>

              <li class="toclevel-3 tocsection-8"><a href="#Column_LName"><span class="tocnumber">1.2.5</span> <span class="toctext">Column_LName</span></a></li>

              <li class="toclevel-3 tocsection-9"><a href="#Column_Comments"><span class="tocnumber">1.2.6</span> <span class="toctext">Column_Comments</span></a></li>

              <li class="toclevel-3 tocsection-10"><a href="#Column_Visible"><span class="tocnumber">1.2.7</span> <span class="toctext">Column_Visible</span></a></li>

              <li class="toclevel-3 tocsection-11"><a href="#Column_Pn"><span class="tocnumber">1.2.8</span> <span class="toctext">Column_Pn</span></a></li>

              <li class="toclevel-3 tocsection-12"><a href="#Column_Dn"><span class="tocnumber">1.2.9</span> <span class="toctext">Column_Dn</span></a></li>

              <li class="toclevel-3 tocsection-13"><a href="#Column_SampleID"><span class="tocnumber">1.2.10</span> <span class="toctext">Column_SampleID</span></a></li>

              <li class="toclevel-3 tocsection-14"><a href="#Sheet_SName"><span class="tocnumber">1.2.11</span> <span class="toctext">Sheet_SName</span></a></li>

              <li class="toclevel-3 tocsection-15"><a href="#Sheet_Comments"><span class="tocnumber">1.2.12</span> <span class="toctext">Sheet_Comments</span></a></li>

              <li class="toclevel-3 tocsection-16"><a href="#Book_Comments"><span class="tocnumber">1.2.13</span> <span class="toctext">Book_Comments</span></a></li>

              <li class="toclevel-3 tocsection-17"><a href="#Book_SName"><span class="tocnumber">1.2.14</span> <span class="toctext">Book_SName</span></a></li>

              <li class="toclevel-3 tocsection-18"><a href="#Book_LName"><span class="tocnumber">1.2.15</span> <span class="toctext">Book_LName</span></a></li>
            </ul>
          </li>
        </ul>
      </li>

      <li class="toclevel-1 tocsection-19">
        <a href="#Examples"><span class="tocnumber">2</span> <span class="toctext">Beispiele</span></a>

        <ul>
          <li class="toclevel-2 tocsection-20"><a href="#Example_1"><span class="tocnumber">2.1</span> <span class="toctext">Beispiel 1</span></a></li>

          <li class="toclevel-2 tocsection-21"><a href="#Example_2"><span class="tocnumber">2.2</span> <span class="toctext">Beispiel 2</span></a></li>
        </ul>
      </li>
    </ul>
  </div>

  <h2><a name="Syntax:"></a><span class="mw-headline">Syntax:</span></h2>
  <pre class="lt" style="font-family:monospace;">
SELECT COLUMN FROM Range WHERE Condition
</pre>

  <p><b>Hinweis</b>: Es werden nur Datenspalten als Objekt unterstützt, die im Origin-Dateikonnektor verwendet werden.</p>

  <h3><a name="Range_to_search"></a><span class="mw-headline">Zu durchsuchender Bereich</span></h3>

  <p>FROM unterstützt Projektpfad und Bereichsnotation von Arbeitsmappe bzw. Blatt. Die folgenden Sondertasten sind ebenfalls verfügbar.</p>

  <ul>
    <li>PROJECT,</li>

    <li>ACTIVEFOLDER,</li>

    <li>FAVORITEFOLDER</li>
  </ul>

  <h3><a name="key_words_in_Condition"></a><span class="mw-headline">Schlüsselwörter in Bedingung</span></h3>

  <h4><a name="Column_Type"></a><span class="mw-headline">Column_Type</span></h4>

  <p>Wählen Sie Spalten mit festgelegter Diagrammzuordnung aus.</p>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">//search the whole project and select unhidden X columns</span>  Die Spalte aus dem Projekt wird ausgewählt, bei der <span style="color: #000000;">(</span>Column_Type <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"X"</span> und Column_Visible <span style="color: #000080;">=</span> True<span style="color: #000000;">)</span>;
</pre>

  <h4><a name="Column_Y"></a><span class="mw-headline">Column_Y</span></h4>

  <p>Wenn Sie eine Y-Spalte auswählen, wird auch die zugehörige X-Spalte importiert.</p>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">//search the whole project and select columns with long name starting by “Trial”</span> <span style="color: #008000;">//and import both the selected columns and their X columns</span> Die Spalte aus dem Projekt wird ausgewählt, bei der <span style="color: #000000;">(</span>Column_LName wie <span style="color: #ff00ff;">"Trial*"</span> und Column_Y <span style="color: #000080;">=</span> True<span style="color: #000000;">)</span>;
</pre>

  <h4><a name="Column_Z"></a><span class="mw-headline">Column_Z</span></h4>

  <p>Wenn Sie eine Z-Spalte auswählen, werden auch die zugehörigen X- und Y-Spalten importiert.</p>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">//search the whole project and select columns with long name starting by “Trial”</span> <span style="color: #008000;">//and import the selected columns and their associated X&amp;Y columns</span> Die Spalte aus dem Projekt wird ausgewählt, bei der <span style="color: #000000;">(</span>Column_LName wie <span style="color: #ff00ff;">"Trial*"</span> und Column_Z <span style="color: #000080;">=</span> True<span style="color: #000000;">)</span>;
</pre>

  <h4><a name="Column_SName"></a><span class="mw-headline">Column_SName</span></h4>

  <p>Die Spalten des festgelegten Kurznamens werden ausgewählt.</p>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">//search the active workbook and select column with short name “A”</span> Die Spalte aus <span style="color: #000080;">%</span>H wird ausgewählt, bei der Column_SName wie <span style="color: #ff00ff;">"A"</span>;
</pre>

  <h4><a name="Column_LName"></a><span class="mw-headline">Column_LName</span></h4>

  <p>Die Spalten des festgelegten Langnamens werden ausgewählt. Platzhalter “*” und “?” werden unterstützt. “*” stellt jede Zeichenkette dar, und “?” stellt ein einzelnes Zeichen dar.</p>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">//search the whole project and select column whose long name starting with “Trial”</span> Die Spalte aus dem Projekt wird ausgewählt, bei der Column_LName wie <span style="color: #ff00ff;">"Trial*"</span>;
</pre>

  <h4><a name="Column_Comments"></a><span class="mw-headline">Column_Comments</span></h4>

  <p>Die Spalten, deren Kommentare mit der angegebenen Bedingung übereinstimmen, werden ausgewählt. Platzhalter werden unterstützt.</p>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">//search the whole project and select column with comment starting by letter “S” and end by digit “3”</span> Die Spalte aus dem Projekt wird ausgewählt, bei der Column_Comments wie <span style="color: #ff00ff;">"S*3"</span>;
</pre>

  <h4><a name="Column_Visible"></a><span class="mw-headline">Column_Visible</span></h4>

  <p>Durch Festlegen dieser Option wird um aus den sichtbaren bzw. verborgenen Spalten ausgewählt.</p>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">//search the whole project and select the hidden Y columns</span> Die Spalte aus dem Projekt wird ausgewählt, bei der <span style="color: #000000;">(</span>Column_Type <span style="color: #000080;">=</span> <span style="color: #ff00ff;">"Y"</span> und Column_Visible <span style="color: #000080;">=</span> False<span style="color: #000000;">)</span>;
</pre>

  <h4><a name="Column_Pn"></a><span class="mw-headline">Column_Pn</span></h4>

  <p>Die Spalten, deren Headerzeile Parameter <i>n</i> mit der angegebenen Bedingung übereinstimmt, werden ausgewählt. Platzhalter werden unterstützt.</p>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">//search the whole project and select columns whose Parameter 1 including character “y”.</span> Es wird die Spalte aus dem Projekt ausgewählt, bei der Column_P1  gleich <span style="color: #ff00ff;">"*y*"</span>;
</pre>

  <h4><a name="Column_Dn"></a><span class="mw-headline">Column_Dn</span></h4>

  <p>Die Spalten, deren Benutzerdefinierte Headerzeile Parameter <i>n</i> mit der angegebenen Bedingung übereinstimmt, werden ausgewählt. Platzhalter werden unterstützt.</p>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">//search the whole project and select columns whose Parameter1 including character “y” </span> <span style="color: #008000;">//and value in the 1st User-Defined Parameter larger than 3.</span> Es wird die Spalte aus dem Projekt ausgewählt, bei der   <span style="color: #000000;">(</span>Column_P1 gleich <span style="color: #ff00ff;">"*y*"</span> und Column_D1 <span style="color: #000080;">&gt;</span> <span style="color: #0000dd;">3</span><span style="color: #000000;">)</span>;
</pre>

  <h4><a name="Column_SampleID"></a><span class="mw-headline">Column_SampleID</span></h4>

  <p>Die Spalten, deren Benutzerdefinierte Headerzeile Parameter <i>SampleID</i> mit der angegebenen Bedingung übereinstimmt, werden ausgewählt. Falls der Name Leerzeichen enthält, verwenden Sie [<i>SampleID</i>]. Platzhalter werden in der Bedingung unterstützt.</p>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">//search the active folder and select columns whose parameter row “Population Mean” is larger than 100.</span> Es werden die Spalten aus ACTIVEFOLDER ausgewählt, bei denen Column_<span style="color: #000000;">[</span>Population Mean<span style="color: #000000;">]</span> <span style="color: #000080;">&gt;</span> <span style="color: #0000dd;">100</span>;
</pre>

  <h4><a name="Sheet_SName"></a><span class="mw-headline">Sheet_SName</span></h4>

  <p>Die Spalten in Arbeitsblättern, deren Kurzname mit der angegebenen Bedingung übereinstimmt, werden ausgewählt. Platzhalter werden unterstützt.</p>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">//search the Favorite folder and select columns in sheets named “Trial…”.</span> Es wird die Spalte aus dem FAVORITEFOLDER ausgewählt, bei der Sheet_SName  gleich <span style="color: #ff00ff;">"Trial*"</span>;
</pre>

  <h4><a name="Sheet_Comments"></a><span class="mw-headline">Sheet_Comments</span></h4>

  <p>Es werden die Spalten aus dem Projekt ausgewählt, deren sheet Comments die festgelegte Bedingung erfüllt. Platzhalterzeichen werden unterstützt.</p>
  <pre class="lt" style="font-family:monospace;">
Es werden Spalten aus dem Projekt ausgewählt, bei denen Sheet_Comments wie <span style="color: #ff00ff;">"Sheet1"</span> und Book_Comments wie <span style="color: #ff00ff;">"Book1"</span> aussehen.
</pre>

  <h4><a name="Book_Comments"></a><span class="mw-headline">Book_Comments</span></h4>

  <p>Es werden die Spalten aus dem Projekt ausgewählt, deren book_Comments die festgelegte Bedingung erfüllt. Platzhalterzeichen werden unterstützt.</p>
  <pre class="lt" style="font-family:monospace;">
Es werden Spalten aus dem Projekt ausgewählt, bei denen Book_Comments wie <span style="color: #ff00ff;">"Trial Run*"</span> aussehen.
</pre>

  <h4><a name="Book_SName"></a><span class="mw-headline">Book_SName</span></h4>

  <p>Die Spalten in Arbeitsmappen, deren Kurzname mit der angegebenen Bedingung übereinstimmt, werden ausgewählt. Platzhalter werden unterstützt.</p>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">//search the whole project and select columns in books with Short Nam beginning with “Book”.</span> Es wird die Spalte aus dem Projekt ausgewählt, bei der <span style="color: #000000;">(</span>Book_SName wie <span style="color: #ff00ff;">"Book*"</span><span style="color: #000000;">)</span>;
</pre>

  <h4><a name="Book_LName"></a><span class="mw-headline">Book_LName</span></h4>

  <p>Die Spalten in Arbeitsmappen, deren Langname mit der angegebenen Bedingung übereinstimmt, werden ausgewählt. Platzhalter werden unterstützt.</p>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">//search the whole project and select columns in books with Short Nam beginning with “Book”,</span> <span style="color: #008000;">//or books with Long Name beginning with “fit”.</span> Es wird die Spalte aus dem Projekt ausgewählt, bei der <span style="color: #000000;">(</span>Book_SName wie <span style="color: #ff00ff;">"Book*"</span> oder Book_LName wie <span style="color: #ff00ff;">"*fit*"</span><span style="color: #000000;">)</span>;
</pre>

  <p> </p>

  <h2><a name="Examples"></a><span class="mw-headline">Beispiele</span></h2>

  <h5><a name="Example_1"></a><span class="mw-headline">Beispiel 1</span></h5>

  <ol>
    <li>Wählen Sie <b>Daten: Mit Datei verbinden: Origin Connector</b>. Wählen Sie die Datei <i>&lt;OriginLab-Installationsordner&gt;\Samples\Tutorial Data.opj</i>.</li>

    <li>Klicken Sie im Dialog "Auswählen" auf die Schaltfläche <b>Abfrage auswählen</b> <a class="image"><img alt="Select Query button.png" src="../images/Examples_of_using_SQL_query_condition_in_Origin_Connector/Select_Query_button.png" width="44"></a>, um den Dialog <b>Abfrage auswählen</b> zu öffnen.</li>

    <li>Geben Sie die folgende Zeichenkette ein:
      <pre class="lt" style="font-family:monospace;">
Die Spalte aus dem Projekt wird ausgewählt, bei der <span style="color: #000000;">(</span>Column_LName wie <span style="color: #ff00ff;">"Year"</span> UND Column_Type <span style="color: #000080;">=</span> X<span style="color: #000000;">)</span> oder <span style="color: #000000;">(</span>Column_LName wie <span style="color: #ff00ff;">"Value*"</span> und Column_Type <span style="color: #000080;">=</span> Y<span style="color: #000000;">)</span>
</pre>
    </li>

    <li>Klicken Sie auf <b>OK</b>, um sie zum unteren Bedienfeld hinzuzufügen.</li>

    <li>Klicken Sie auf <b>OK</b>, um X-Spalten mit dem Langnamen "Year" und Y-Spalten mit Langnamen, die mit der Zeichenkette "Value" beginnen, zu importieren.</li>
  </ol>

  <p> </p>

  <h5><a name="Example_2"></a><span class="mw-headline">Beispiel 2</span></h5>

  <ol>
    <li>Wählen Sie <b>Hilfe: Lernzentrum</b>. Wählen Sie im aufgerufenen Dialog das Projekt <i>Statistical Graphs - Pyramid Plot of Australia Population</i> aus, um es zu öffnen.</li>

    <li>Führen Sie das folgende LabTalk-Skript im <b>Befehlsfenster</b> aus, um die Daten der männlichen Bevölkerung, die 5.000.000 übersteigen, in eine neue Arbeitsmappe zu extrahieren.
      <pre class="lt" style="font-family:monospace;">
wo <span style="color: #000080;">-</span>qn Select Column from <span style="color: #000000;">[</span><span style="color: #ff00ff;">"Austrialia Population from 1960 to 2017"</span><span style="color: #000000;">]</span>UnstackCols2<span style="color: #000080;">!</span> wobei <span style="color: #000000;">(</span>Column_Comments wie <span style="color: #ff00ff;">"male*"</span> und Column_N <span style="color: #000080;">&gt;</span> <span style="color: #0000dd;">5000000</span><span style="color: #000000;">)</span>;
</pre>

      <p>Hinweis: Einzelheiten zum LabTalk-Befehl "worksheet -qn" finden Sie auf <a class="external text" href="../../LabTalk/LabTalk/Worksheet_(command).html#-qn.3B_Extract_columns_satisfied_with_specified_SQL_query_and_put_to_a_new_book">dieser Seite</a>.</p>
    </li>
  </ol>
