<h1 class="firstHeading">Der Dialog SQL-Editor</h1>

  <p class='urlname' style='display: none'>ImpDatabase-SQLEditor-Dialog</p>

  <p>&#160;</p>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>Inhalt</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1"><a href="#Database_Overview"><span class="tocnumber">1</span> <span class="toctext">Datenbankübersicht</span></a></li>

      <li class="toclevel-1 tocsection-2"><a href="#The_SQL_Editor"><span class="tocnumber">2</span> <span class="toctext">Der SQL-Editor</span></a></li>

      <li class="toclevel-1 tocsection-3">
        <a href="#Dialog_Settings"><span class="tocnumber">3</span> <span class="toctext">Dialogeinstellungen</span></a>

        <ul>
          <li class="toclevel-2 tocsection-4"><a href="#The_File_menu"><span class="tocnumber">3.1</span> <span class="toctext">Das Menü Datei</span></a></li>

          <li class="toclevel-2 tocsection-5"><a href="#The_View_menu"><span class="tocnumber">3.2</span> <span class="toctext">Das Menü Ansicht</span></a></li>

          <li class="toclevel-2 tocsection-6"><a href="#The_Query_menu"><span class="tocnumber">3.3</span> <span class="toctext">Das Menü Anfrage</span></a></li>

          <li class="toclevel-2 tocsection-7"><a href="#The_Settings_menu"><span class="tocnumber">3.4</span> <span class="toctext">Das Menü Einstellungen</span></a></li>

          <li class="toclevel-2 tocsection-8"><a href="#Buttons"><span class="tocnumber">3,5</span> <span class="toctext">Schaltflächen</span></a></li>
        </ul>
      </li>
    </ul>
  </div>

  <h2><a name="Database_Overview"></a><span class="mw-headline">Datenbankübersicht</span></h2>

  <p>Origins Datenbankkonnektivität und Importfunktionalität wurde aktualisiert. Weitere Informationen können Sie in diesen Blogeinträgen nachlesen:</p>

  <ul>
    <li><a class="external text" href="http://blog.originlab.com/data-handling/better-faster-database-support-in-origin-2020" target="_blank">Bessere, schnellere Datenbankunterstützung in Origin 2020</a></li>

    <li><a class="external text" href="http://blog.originlab.com/data-import/the-sql-editor-dialog" target="_blank">Der Dialog SQL-Editor</a></li>

    <li><a class="external text" href="http://blog.originlab.com/data-import/connecting-to-a-database-and-importing-data" target="_blank">Verbindung zu einer Datenbank herstellen und Daten importieren</a></li>

    <li><a class="external text" href="http://blog.originlab.com/origin-2020/things-to-know-about-origin-database-connectivity" target="_blank">Wichtige Informationen zu Origins Datenbankkonnektivität</a></li>

    <li><a class="external text" href="http://blog.originlab.com/sqlite-support-in-origin" target="_blank">SQLite-Unterstützung in Origin</a></li>
  </ul>

  <h2><a name="The_SQL_Editor"></a><span class="mw-headline">Der SQL-Editor</span></h2>

  <dl>
    <dd>
      <dl>
        <dd><a class="image"><img alt="Sqleditor.png" src="../images/The_SQL_Editor_Dialog_Box/Sqleditor.png" width="740"></a></dd>
      </dl>
    </dd>
  </dl>

  <p>Der SQL-Editor ist eine einfache Benutzeroberfläche, um eine Verbindung zur Datenbank herzustellen, SQL-Zeichenketten zu bearbeiten und Datenbankdaten zu importieren. Der Dialog umfasst:</p>

  <ul>
    <li><b>Tabellenliste</b>: Liste der Tabellen in der ausgewählten Datenbank. Für jede Tabelle gibt es eine Felderliste. Um Elemente zur SQL-Abfrage hinzuzufügen, die im Bearbeitungsfeld SQL-Anweisung erstellt wird, klicken Sie doppelt auf sie.</li>

    <li><b>Bearbeitungsfeld SQL-Anweisung</b>: Geben Sie hier manuell die SQL-Abfrage ein. Klicken Sie doppelt auf die Tabellenliste, um Elemente aus der Liste zur SQL hinzuzufügen.</li>

    <li><b>Sichtbarkeit des Vorschaufelds umschalten</b>: Klicken Sie, um das Vorschaufeld zu zeigen oder zu verbergen.</li>

    <li><b>Vorschaufeld</b>: Zeigt die Vorschau der Daten an, wenn auf die Schaltfläche Vorschau geklickt wird.</li>

    <li><b>Vorschau erzeugen</b>: Klicken Sie auf Vorschau, um bis zu 50 Zeilen der Vorschaudaten zu erzeugen.</li>

    <li><b>Daten importieren</b>: Klicken Sie auf OK, um den Dialog SQL-Editor zu schließen, die Abfrage im Arbeitsblatt zu speichern und die von der Abfrage festgelegten Daten im Arbeitsblatt zu speichern.</li>
  </ul>

  <table class="noborder">
    <tr>
      <td style="vertical-align:top" width="60"><img src="../images/The_SQL_Editor_Dialog_Box/Tip_icon.png" width="57" border="0" alt=""></td>

      <td>
        <p>Um die Höhe des oberen Bedienfelds anzupassen, deaktivieren Sie das Feld der Vorschau (klicken Sie doppelt auf den nach oben weisenden Pfeil auf der rechten Seite) und ziehen Sie dann, um die Höhe anzupassen.</p>
      </td>
    </tr>
  </table>

  <table class="note">
    <tr>
      <td><b>Hinweis:</b> Standardmäßig werden die Ansichten in der Tabellenliste des SQL-Editors verborgen. Sie können die Ansichten aktivieren, indem Sie den Wert der LabTalk-Systemvariable auf <a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#D">@DBSV = 1</a> festlegen. Informationen zum Ändern des Werts einer LabTalk-Systemvariablen finden Sie unter <a class="external text" href="../../QuickHelp/QuickHelp/How_do_I_permanently_change_the_value_of_a_system_variable.html">FAQ-708 Wie ändere ich permanent den Wert einer Systemvariablen?</a>.</td>
    </tr>
  </table>

  <h2><a name="Dialog_Settings"></a><span class="mw-headline">Dialogeinstellungen</span></h2>

  <h3><a name="The_File_menu"></a><span class="mw-headline">Das Menü Datei</span></h3>

  <p>Die Optionen in diesem Menü dienen zum Herstellen einer Datenbankverbindung und Verwalten der Verbindung und Abfragedateien (<a class="external text" href="http://blog.originlab.com/data-import/the-sql-editor-dialog*" target="_blank">Siehe eine Erklärung zu ODS- und ODQ-Dateien in diesem Blogeintrag</a>).</p>

  <table class="dialogcontroltable">
    <tr>
      <th>Neu</th>

      <td>Öffnen Sie eine komplett neue Verbindung mit einer leeren SQL-Abfrage. Dadurch wird der Dialog <b>Eigenschaften der Datenverbindung</b> geöffnet.</td>
    </tr>

    <tr>
      <th>Öffnen</th>

      <td>Öffnet eine existierende Abfragedatei (<a href="../../UserGuide/UserGuide/Database_Terminology.html" title="UserGuide:Database Terminology">*.ODQ-Datei</a>) oder eine Datenquelldatei (<a href="../../UserGuide/UserGuide/Database_Terminology.html" title="UserGuide:Database Terminology">*.ODS-Datei</a>).</td>
    </tr>

    <tr>
      <th>Im aktiven Arbeitsblatt speichern</th>

      <td>Speichert die Verbindungsinformationen und die SQL-Anweisung im aktiven Arbeitsblatt. Dies ist eine gute Option, wenn Sie diese Informationen speichern, die Daten aber nicht sofort importieren möchten. Klicken Sie auf <b>Datei: Schließen</b>, um den Dialog danach zu schließen.</td>
    </tr>

    <tr>
      <th>Verbindung speichern unter</th>

      <td>Erstellen Sie eine <a href="../../UserGuide/UserGuide/Database_Terminology.html" title="UserGuide:Database Terminology">*.ODS-Datei</a> aus den aktuellen Verbindungsinformationen. Wenn Sie die Zugangsdaten in die Verbindung einschIießen wollen, verschlüsseln Sie sie zuvor nicht.</td>
    </tr>

    <tr>
      <th>Verbindungszeichenkette zeigen</th>

      <td>Die <a href="../../UserGuide/UserGuide/Database_Terminology.html" title="UserGuide:Database Terminology">Verbindungszeichenkette</a> für die aktuelle Verbindung wird auf der Registerkarte <b>Meldungen</b> im Vorschaufeld angezeigt.</td>
    </tr>

    <tr>
      <th>Verbindungszeichenkette bearbeiten</th>

      <td>Modifizieren Sie einen Teil der aktuellen Verbindungszeichenkette. Oder verwenden Sie die Option zum Kopieren der Verbindungszeichenkette in die Zwischenablage.</td>
    </tr>

    <tr>
      <th>Verbidnung und Abfrage speichern unter</th>

      <td>Erstellen Sie eine <a href="../../UserGuide/UserGuide/Database_Terminology.html" title="UserGuide:Database Terminology">*.ODQ-Datei</a> aus den aktuellen Verbindungsinformationen und der SQL-Anweisung.</td>
    </tr>

    <tr>
      <th>Schließen</th>

      <td>Der Dialog wird geschlossen.</td>
    </tr>
  </table>

  <h3><a name="The_View_menu"></a><span class="mw-headline">Das Menü Ansicht</span></h3>

  <table class="dialogcontroltable">
    <tr>
      <th>Textgröße</th>

      <td>Passen Sie die Schriftgröße des SQL-Anweisungseditors an.</td>
    </tr>

    <tr>
      <th>Tabellenliste zeigen</th>

      <td>Linkes Feld zeigen/verbergen Origin liest Datenbankmetadaten zum Erzeugen dieser Tabelle. Das Erzeugen kann eine Weile dauern. Das Verbergen der Tabelle kann die Verbindungsdauer zu einer großen Datenbank verkürzen. Klicken Sie doppelt auf den Knoten, um ihn zum rechten Bearbeitungsfeld der SQL-Anweisung hinzuzufügen.</td>
    </tr>

    <tr>
      <th>Tabellenansichten in Tabellenliste zeigen</th>

      <td>Zeigen oder verbergen Sie die Tabellenansichten in der Tabellenliste.</td>
    </tr>
  </table>

  <h3><a name="The_Query_menu"></a><span class="mw-headline">Das Menü Anfrage</span></h3>

  <table class="dialogcontroltable">
    <tr>
      <th>LabTalk</th>

      <td>
        Der Dialog <b>Einstellungen der Unterstützung von LabTalk</b> wird geöffnet. Mit diesem Dialog können Sie LabTalk-Variablen definieren, Labtalk-Skript ausführen und LabTalk in Ihrer SQL-Zeichenkette verwenden. Die Dialogoptionen umfassen:

        <ul>
          <li><b>Substitution durch LabTalk (%, $) aktivieren</b><br>
          Aktivieren Sie dieses Kontrollkästchen, um LabTalk-Substitution in SQL-Zeichenketten zu aktivieren.</li>

          <li><b>Platzhalter in einfachen Anführungszeichen ignorieren</b><br>
          Aktivieren Sie dieses Kontrollkästchen, um die Substitution innerhalb ' ' zu ignorieren.</li>

          <li><b>Skript vor Anfrage</b><br>
          Skript, das vor Anwendung einer SQL-Zeichenkette ausgeführt wird. Dies wird verwendet, um LabTalk-Variablen etc. zu definieren.</li>
        </ul>

        <p>Weitere Informationen finden Sie in dem unten stehenden Beispiel.</p>
      </td>
    </tr>

    <tr>
      <th>Vorschau der Substitutionszeichenkette</th>

      <td>Vorschau der tatsächlichen SQL-Zeichenkette beim Verwenden von LabTalk im rechten Bedienfeld. Wenn diese Option aktiviert ist, kann das SQL-Bearbeitungsfeld nicht mehr bearbeitet werden.</td>
    </tr>

    <tr>
      <th>Vorschau</th>

      <td>Sie können die SQL-Abfrageergebnisse auf der Registerkarte Vorschau unten anzeigen.</td>
    </tr>
  </table>

  <p><br>
  <i><b>Beispiel: LabTalk in Ihrer SQL-Zeichenkette verwenden</b></i></p>

  <p>Angenommen die ursprüngliche SQL-Zeichenkette lautet:</p>
  <pre class="sql" style="font-family:monospace;">
<span style="color: #993333; font-weight: bold;">SELECT</span> country<span style="color: #66cc66;">,</span> years<span style="color: #66cc66;">,</span> amount <span style="color: #993333; font-weight: bold;">FROM</span> salesrecords <span style="color: #993333; font-weight: bold;">WHERE</span> country <span style="color: #66cc66;">=</span> <span style="color: #ff0000;">'USA'</span> <span style="color: #993333; font-weight: bold;">AND</span> years <span style="color: #66cc66;">=</span> <span style="color: #cc66cc;">2010</span>
</pre>

  <p>Um die Bedingung zu ändern, können Sie die LabTalk-Variable in der Anweisung WHERE verwenden. Öffnen Sie beispielsweise die <b>Einstellungen der Unterstützung von LabTalk</b> und geben Sie <b>Skript vor Anfrage</b> ein:</p>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #000080;">%</span>A <span style="color: #000080;">=</span> Japan; <span style="color: #008000;">//define a string variable</span> int YY <span style="color: #000080;">=</span> <span style="color: #0000dd;">2010</span>; <span style="color: #008000;">//define an integer variable</span>
</pre>

  <p>Ändern Sie die SQL in</p>
  <pre class="sql" style="font-family:monospace;">
<span style="color: #993333; font-weight: bold;">SELECT</span> country<span style="color: #66cc66;">,</span> years<span style="color: #66cc66;">,</span> amount <span style="color: #993333; font-weight: bold;">FROM</span> salesrecords <span style="color: #993333; font-weight: bold;">WHERE</span> country <span style="color: #66cc66;">=</span> <span style="color: #ff0000;">'%A'</span> <span style="color: #993333; font-weight: bold;">AND</span> years <span style="color: #66cc66;">=</span> $<span style="color: #66cc66;">(</span>YY<span style="color: #66cc66;">)</span>
</pre>

  <p>Dann könnte die sich ergebende SQL folgendermaßen lauten:</p>

  <ol>
    <li>
      <b>Enable LabTalk (%, $) Substitution</b> -- Unchecked.
      <pre class="sql" style="font-family:monospace;">
<span style="color: #993333; font-weight: bold;">SELECT</span> country<span style="color: #66cc66;">,</span> years<span style="color: #66cc66;">,</span> amount <span style="color: #993333; font-weight: bold;">FROM</span> salesrecords <span style="color: #993333; font-weight: bold;">WHERE</span> country <span style="color: #66cc66;">=</span> <span style="color: #ff0000;">'%A'</span> <span style="color: #993333; font-weight: bold;">AND</span> years <span style="color: #66cc66;">=</span> $<span style="color: #66cc66;">(</span>YY<span style="color: #66cc66;">)</span>
</pre>
    </li>

    <li>
      <b>Enable LabTalk (%, $) Substitution</b> -- Checked, <b>Ignore Substitution Inside Single Quotes</b> -- Unchecked.
      <pre class="sql" style="font-family:monospace;">
<span style="color: #993333; font-weight: bold;">SELECT</span> country<span style="color: #66cc66;">,</span> years<span style="color: #66cc66;">,</span> amount <span style="color: #993333; font-weight: bold;">FROM</span> salesrecords <span style="color: #993333; font-weight: bold;">WHERE</span> country <span style="color: #66cc66;">=</span> <span style="color: #ff0000;">'Japan'</span> <span style="color: #993333; font-weight: bold;">AND</span> years <span style="color: #66cc66;">=</span> <span style="color: #cc66cc;">2010</span>
</pre>
    </li>

    <li>
      <b>Enable LabTalk (%, $) Substitution</b> -- Checked, <b>Ignore Substitution Inside Single Quotes</b> -- Checked.
      <pre class="sql" style="font-family:monospace;">
<span style="color: #993333; font-weight: bold;">SELECT</span> country<span style="color: #66cc66;">,</span> years<span style="color: #66cc66;">,</span> amount <span style="color: #993333; font-weight: bold;">FROM</span> salesrecords <span style="color: #993333; font-weight: bold;">WHERE</span> country <span style="color: #66cc66;">=</span> <span style="color: #ff0000;">'%A'</span> <span style="color: #993333; font-weight: bold;">AND</span> years <span style="color: #66cc66;">=</span> <span style="color: #cc66cc;">2010</span>
</pre>
    </li>
  </ol>

  <table class="noborder">
    <tr>
      <td style="vertical-align:top" width="60"><img src="../images/The_SQL_Editor_Dialog_Box/Tip_icon.png" width="57" border="0" alt=""></td>

      <td>
        <p>Um ein tatsächliches '%'-Zeichen zu verwenden, wenn Sie <b>Platzhalter in einfachen Anführungszeichen ignorieren</b> deaktiviert haben, verwenden Sie stattdessen ein doppeltes Prozentzeichen '%%'.</p>
      </td>
    </tr>
  </table>

  <h3><a name="The_Settings_menu"></a><span class="mw-headline">Das Menü Einstellungen</span></h3>

  <table class="dialogcontroltable">
    <tr>
      <th>Daten durch OLE DB importieren</th>

      <td>Verwenden Sie OLE DB zum Importieren von Daten. (Aktiviert für OLE DB und ODBC).</td>
    </tr>

    <tr>
      <th>Daten durch ODBC importieren</th>

      <td>Verwenden Sie ODBC zum Importieren von Daten. (Nur für ODBC-Verbindungen aktiviert).</td>
    </tr>

    <tr>
      <th>Automatisches Ändern der Größe des Arbeitsblatts</th>

      <td>Die Breite der Arbeitsblattspalten wird automatisch an die Größe der Daten angepasst.</td>
    </tr>

    <tr>
      <th>Anmeldedaten verschlüsseln</th>

      <td>Verschlüsseln Sie die Zugangsdaten, so dass sie von Menschen nicht mehr einfach gelesen werden können, wenn sie in Origin angezeigt werden.</td>
    </tr>
  </table>

  <h3><a name="Buttons"></a><span class="mw-headline">Schaltflächen</span></h3>

  <p>Es werden Schaltflächen für die am häufigsten verwendeten Menüs in diesem Dialog angeboten, einschließlich:</p>

  <table class="dialogcontroltable">
    <tr>
      <th>Öffnen <a class="image"><img alt="Db editor open.png" src="../images/The_SQL_Editor_Dialog_Box/Db_editor_open.png" width="23"></a></th>

      <td>Menü <b>Datei: Öffnen...</b></td>

      <td>Öffnen Sie eine <a href="../../UserGuide/UserGuide/Database_Terminology.html" title="UserGuide:Database Terminology">.ODQ-</a> oder <a href="../../UserGuide/UserGuide/Database_Terminology.html" title="UserGuide:Database Terminology">.ODS-</a>Datei.</td>
    </tr>

    <tr>
      <th>Speichern <a class="image"><img alt="Db editor save.png" src="../images/The_SQL_Editor_Dialog_Box/Db_editor_save.png" width="23"></a></th>

      <td>Menü <b>Datei: In aktivem Arbeitsblatt speichern/Verbindung und Abfrage speichern</b></td>

      <td>
        Wenn der Dialog über <b>Datei: Neu...</b> geöffnet wird und die <a href="../../UserGuide/UserGuide/Database_Terminology.html" title="UserGuide:Database Terminology">.ODQ</a>-Datei noch nicht gespeichert ist, zeigt der Dialogtitel des SQL-Editors <i>Untitled.ODQ</i> an. Die Schaltfläche <b>Speichern</b> speichert die Verbindung und Anfrage nur im aktivem Arbeitsblatt. Wenn die aktuelle Verbindung oder Abfrage aus einer .ODQ-Datei geladen wird oder als .ODQ-Datei gespeichert wird, zeigt der Dialogtitel des SQL-Editors den Dateinamen. Die Schaltfläche <b>Speichern</b> speichert dann in die entsprechende Datei.

        <p>Hinweis: Die Verbindung und Abfrage wird automatisch in das aktive Arbeitsblatt gespeichert, sobald Sie auf die Schaltfläche Import klicken. Wenn Sie den SQL-Editor erneut öffnen, lädt Origin tatsächlich die Abfrage aus dem Blatt und zeigt den Mappen- und Blattname <i>[Book1]Sheet1</i> im Dialogtitel. Wenn Sie die Änderung erneut vornehmen und auf Speichern klicken, wird in das aktive Arbeitsblatt gespeichert.</p>
      </td>
    </tr>

    <tr>
      <th>Vorschau <a class="image"><img alt="Db editor preview.png" src="../images/The_SQL_Editor_Dialog_Box/Db_editor_preview.png" width="23"></a></th>

      <td>Menü <b>Anfrage: Vorschau</b></td>

      <td>Vorschau der SQL-Abfrageergebnisse</td>
    </tr>

    <tr>
      <th>Import <a class="image"><img alt="Db editor import.png" src="../images/The_SQL_Editor_Dialog_Box/Db_editor_import.png" width="23"></a></th>

      <td>Menü <b>Anfrage: Import</b></td>

      <td>Importieren Sie die Datenbankdaten in das Arbeitsblatt.</td>
    </tr>

    <tr>
      <th>Vorschau der Abfragezeichenkette nach der Substitution aller LabTalk-Variablen <a class="image"><img alt="Db editor labtalk.png" src="../images/The_SQL_Editor_Dialog_Box/Db_editor_labtalk.png" width="23"></a></th>

      <td>Menü <b>Anfrage: Vorschau der Substitutionszeichenkette</b></td>

      <td>Zeigen Sie die Vorschau der tatsächlichen SQL-Zeichenkette an, wenn die LabTalk-Variablen definiert sind und Substitution durch LabTalk (%,$) im Dialog <b>Anfrage: LabTalk...</b> aktiviert ist.</td>
    </tr>
  </table>
