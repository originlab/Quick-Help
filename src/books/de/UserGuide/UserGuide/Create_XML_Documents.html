<h1 class="firstHeading">MSXML-Parser zum Konvertieren eines Origin-Arbeitsblatts in ein XML-Dokument verwenden</h1>

  <p class='urlname' style='display: none'>Create-XML</p>

  <p><br>
  Origin Cs COM-Unterstützung kann verwendet werden, um programmatisch XML-Dokumente zu erstellen. Um zu sehen, wie der Code aussehen könnte, sehen Sie sich bitte folgende Datei an: <a class="external text" href="http://www.originlab.com/pdfs/origin_c_examples/WksToXML_1.pdf" target="_blank">WksToXML.PDF</a>.</p>

  <dl>
    <dd>
      <dl>
        <dd><a class="image"><img alt="WKSTOXML.png" src="../images/Create_XML_Documents/400px-WKSTOXML.png" width="400" height="255" srcset="/images/docwiki/3/36/WKSTOXML.png 1.5x, /images/docwiki/3/36/WKSTOXML.png 2x"></a></dd>
      </dl>
    </dd>
  </dl>

  <p>Die Funktionen in dem Programm verwenden den Microsoft MSXML Parser (Version 3 - es können auch andere Versionen verwendet werden), um ein Origin-Arbeitsblatt in ein XML-Dokument zu konvertieren, und zwar mit Hilfe der Funktion <b>WksToXML</b>. Die Funktion hat zwei Argumente:</p>

  <dl>
    <dd>
      <dl>
        <dd>1. <b>String</b> - Der Standard dieser Zeichenkette lautet Data1, kann aber ein beliebiger Arbeitsblattname sein, einschließlich einer LabTalk-Zeichenkettenvariable (z.B. %H - der aktive Fenstertitel). Die Verwendung einer LabTalk-Zeichenkettenvariable macht das Durchführen eines Prozesses per Stapelverarbeitung, bei dem mehrere Arbeitsblätter in XML-Dateien gespeichert werden, einfacher.</dd>

        <dd>2. <b>String</b> - Diese Zeichenkette verweist per Standard auf Laufwerk C (z.B. C:\), kann aber jeder gültoge Pfad sein.</dd>
      </dl>
    </dd>
  </dl>

  <p>Sobald die C-Datei im Code Builder (Origin's Integrated Development Environment) kompiliert wurde, kann die Funktion WKSToXML entweder mittels Origin C oder die LabTalk-Syntax aufgerufen werden. Der Aufruf würde folgendermaßen aussehen:</p>

  <table class="simple" width="80%">
    <tr>
      <th width="40%">In Origin C</th>

      <th width="40%">In LabTalk</th>
    </tr>

    <tr>
      <td>WKSToXML(<i>MyWorksheet,C:\Temp</i>);</td>

      <td>WKSToXML <i>MyWorksheet C:\Temp</i>;</td>
    </tr>
  </table>

  <p>Mit einer weiteren Funktion in dieser Datei, <b>XMLToWks</b>, können Sie ein XML-Dokument in ein Origin-Arbeitsblatt importieren. Die Funktion verwendet ein Argument, den Pfad und den Dateinamen, als eine Zeichenkette. Ein ordnungsgemäßer Funktionsaufruf unter Verwendung der Funktion sähe folgendermaßen aus:</p>

  <table class="simple" width="80%">
    <tr>
      <th width="40%">In Origin C</th>

      <th width="40%">In LabTalk</th>
    </tr>

    <tr>
      <td>XMLToWks(<i>C:\Temp</i>);</td>

      <td>XMLToWks <i>C:\Temp</i>;</td>
    </tr>
  </table>

  <p><font>Hinweis</font>: Dieses Beispiel steht auch im Unterordner <b>\Samples\COM Server and Client\XML\Client</b> in Origin zur Verfügung. Der Name lautet <b>WksToXML.c</b>.</p>
