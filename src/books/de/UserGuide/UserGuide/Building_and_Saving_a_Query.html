<h1 class="firstHeading">Eine Abfrage erstellen und speichern</h1>

  <p class='urlname' style='display: none'>ImpDatabase-BuildSave-Query</p>

  <p>&#160;</p>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>Inhalt</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1">
        <a href="#Connecting_to_a_Datasource"><span class="tocnumber">1</span> <span class="toctext">Mit einer Datenquelle verbinden</span></a>

        <ul>
          <li class="toclevel-2 tocsection-2"><a href="#Connection_String"><span class="tocnumber">1.1</span> <span class="toctext">Verbindungszeichenkette</span></a></li>

          <li class="toclevel-2 tocsection-3"><a href="#OBDC_data_source"><span class="tocnumber">1.2</span> <span class="toctext">OBDC-Datenquelle</span></a></li>

          <li class="toclevel-2 tocsection-4"><a href="#ODBC_driver"><span class="tocnumber">1.3</span> <span class="toctext">ODBC-Treiber</span></a></li>

          <li class="toclevel-2 tocsection-5"><a href="#Windows_.22Data_Link_Properties.22_dialog"><span class="tocnumber">1.4</span> <span class="toctext">Windows-Dialog "Datenverknüpfungseigenschaften"</span></a></li>

          <li class="toclevel-2 tocsection-6"><a href="#OLE_DB"><span class="tocnumber">1.5</span> <span class="toctext">OLE DB</span></a></li>
        </ul>
      </li>

      <li class="toclevel-1 tocsection-7"><a href="#Building_a_query"><span class="tocnumber">2</span> <span class="toctext">Eine Abfrage erzeugen</span></a></li>

      <li class="toclevel-1 tocsection-8"><a href="#Saving_a_query"><span class="tocnumber">3</span> <span class="toctext">Eine Abfrage speichern</span></a></li>
    </ul>
  </div>

  <h2><a name="Connecting_to_a_Datasource"></a><span class="mw-headline">Mit einer Datenquelle verbinden</span></h2>

  <p>Um SQL-Daten zu importieren, starten Sie mit dem Menübefehl <b>Daten: Mit Datenbank verbinden</b>:</p>

  <ul>
    <li>Um eine gespeicherte Verbindung (ODS) oder eine Abfragedatei (ODQ) zu öffnen, klicken Sie auf <b>Öffnen</b>. Wenn Ihre Verbindung funktioniert, wird der <a href="../../UserGuide/UserGuide/The_SQL_Editor_Dialog_Box.html" title="UserGuide:The SQL Editor Dialog Box">Dialog <b>SQL-Editor</b></a> geöffnet.</li>

    <li>Wenn Sie vorher <i>nicht</i> mit Ihrer Datenquelle verbunden haben, müssen Sie eine Verbindung einrichten.</li>
  </ul>

  <dl>
    <dd>
      <ol>
        <li>Klicken Sie auf <b>Neu</b>, um den Dialog <b>Datenbankkonnektor</b> zu öffnen.</li>
      </ol>

      <dl>
        <dd><a class="image"><img alt="DB database connector dialog.png" src="../images/Building_and_Saving_a_Query/DB_database_connector_dialog.png" width="327"></a></dd>
      </dl>

      <ul>
        <li><b>Verbindungszeichenkette</b>:&#160;Wählen Sie diese Option, wenn Sie bereits eine textbasierte Verbindungszeichenkette für eine gegebene Datenquelle haben (ODBC oder OLE DB).</li>

        <li><b>ODBC-Datenquelle</b>:&#160;Wählen Sie diese Option, wenn Sie eine ODBC-Datenquelle über das&#160;Windows-Applet&#160;<b>ODBC-Datenquellen-Administrator</b>&#160;definiert haben.</li>

        <li><b>ODBC-Treiber</b>:&#160;Wählen Sie diese Option, wenn Sie einen ODBC-Treiber haben und eine Datenquelle erstellen möchten, die auf diese Datenkonnektorinstanz anwendbar ist.</li>

        <li><b>Windows-Dialog Datenverknüpfungseigenschaften</b>:&#160;Wählen Sie diese Option, wenn Sie eine OLE-DB-basierte Datenquelle wie SQL-Server&#160;oder&#160;Access-Client-Library verwenden.</li>
      </ul>
    </dd>
  </dl>

  <h3><a name="Connection_String"></a><span class="mw-headline">Verbindungszeichenkette</span></h3>

  <p>Verbindungszeichenketten sind eine nützliche Methode zum schnellen Herstellen einer neuen Verbindung von einer existierenden Verbindung aus.</p>

  <ol>
    <li>Falls Sie bereits eine gültige Verbindungszeichenkette zu einer ODBC- oder OLE-DB-Datenquelle haben, wählen Sie diese Option und geben Sie Ihre Verbindungszeichenkette ein.</li>

    <li>Falls die Authentifizierungs-/Login-Daten in einer Verbindungszeichenkette verschlüsselt sind, werden Sie aufgefordert, diese Infos erneut einzugeben. Wenn Ihre Verbindungszeichenkette gültig ist, wird der <a href="../../UserGuide/UserGuide/The_SQL_Editor_Dialog_Box.html" title="UserGuide:The SQL Editor Dialog Box">Dialog <b>SQL-Editor</b></a> geöffnet.</li>
  </ol>

  <h3><a name="OBDC_data_source"></a><span class="mw-headline">OBDC-Datenquelle</span></h3>

  <p>Um eine neue Verbindung zu einer ODBC-Datenquelle herzustellen, wählen Sie diese Option:</p>

  <dl>
    <dd><a class="image"><img alt="UG database connector dialog.png" src="../images/Building_and_Saving_a_Query/UG_database_connector_dialog.png" width="678"></a></dd>
  </dl>

  <ol>
    <li>Wählen Sie im Dialog Datenbankkonnektor die Option <b>ODBC-Datenquelle</b> und klicken Sie auf <b>OK</b>.</li>

    <li><b>Wählen Sie eine Datenquelle (DSN)</b> und geben Sie Verbindungsparameter im Dialog <b>Über ODBC verbinden</b>.</li>
  </ol>

  <h3><a name="ODBC_driver"></a><span class="mw-headline">ODBC-Treiber</span></h3>

  <p>Wählen Sie diese Option, wenn Sie einen ODBC-Treiber haben und eine Datenquelle erstellen möchten, die auf diese Datenkonnektorinstanz anwendbar ist.</p>

  <dl>
    <dd><a class="image"><img alt="DB ODBC Driver.png" src="../images/Building_and_Saving_a_Query/DB_ODBC_Driver.png" width="709"></a></dd>
  </dl>

  <h3><a name="Windows_.22Data_Link_Properties.22_dialog"></a><span class="mw-headline">Windows-Dialog "Datenverknüpfungseigenschaften"</span></h3>

  <h3><a name="OLE_DB"></a><span class="mw-headline">OLE DB</span></h3>

  <dl>
    <dd>
      <dl>
        <dd><a class="image"><img alt="DB Database Connector Data Link Properties dialog.png" src="../images/Building_and_Saving_a_Query/DB_Database_Connector_Data_Link_Properties_dialog.png" width="327"></a></dd>
      </dl>
    </dd>
  </dl>

  <ol>
    <li>Wählen Sie im Dialog Datenbankkonnektor den <b>Windows-Dialog "Datenverknüpfungseigenschaften".</b></li>

    <li>Wählen Sie auf der Registerkarte <b>Provider</b> einen OLE DB Provider und klicken Sie dann auf <b>Weiter</b>, um zur Registerkarte <b>Verbindung</b> zu gelangen.</li>

    <li style="list-style: none">
      <p><a class="image"><img alt="DB Data Link Properties.png" src="../images/Building_and_Saving_a_Query/DB_Data_Link_Properties.png" width="363"></a></p>
    </li>

    <li><b>Wählen Sie einen Servernamen aus oder geben Sie diesen ein</b> (Wenn der Server nicht aufgelistet ist, geben Sie einfach dessen Namen ein).</li>

    <li>Geben Sie einen <b>Anwendernamen</b> und ein <b>Passwort</b> ein.</li>

    <li>Klicken Sie auf <b>OK</b> (andere Einstellungen der Registerkarte sind optional), um die Verbindung zu Ihrer Datenquelle herzustellen.</li>
  </ol>

  <h2><a name="Building_a_query"></a><span class="mw-headline">Eine Anfrage erzeugen</span></h2>

  <p>Sobald Sie eine Verbindung zu Ihrer Datenquelle hergestellt haben, sehen Sie eine Liste von Objekten auf der linken Seite (Tabellenliste) des Dialogs <b>SQL-Editor</b>.</p>

  <p>Ein Doppelklick auf den Tabellenknoten fügt den Tabellenknoten zum Bearbeitungsfeld des Anweisungsfelds im rechten Bedienfeld hinzu. Sie können die SQL-Abfrage auch direkt in das Bearbeitungsfeld der SQL-Anweisung einfügen.</p>

  <dl>
    <dd><a class="image"><img alt="Sqleditor.png" src="../images/Building_and_Saving_a_Query/Sqleditor.png" width="740"></a></dd>
  </dl>

  <p>Ein funktionierendes Beispiel für eine Abfrage finden Sie in diesem OriginLab-Blogeintrag unter <a class="external text" href="http://blog.originlab.com/connecting-to-a-database-and-importing-data" target="_blank"><b>Mit einer Datenbank verbinden und Daten importieren</b></a>.</p>

  <h2><a name="Saving_a_query"></a><span class="mw-headline">Eine Anfrage speichern</span></h2>

  <p>Sie können eine Abfrage in einer Arbeitsmappe oder einer ODQ-Datei speichern, indem Sie entweder <b>Datei: In aktives Blatt speichern</b> oder <b>Datei: Verbindung und Anfrage speichern unter</b> im Menü wählen. Außerdem wird durch Klicken auf die Schaltfläche <b>Import</b> im Dialog <b>SQL-Editor</b> die Abfrage automatisch in einer Zielarbeitsmappe gespeichert.</p>

  <p>Das Speichern einer Abfrage in der Arbeitsmappe (<b>Datei: Fenster speichern unter</b>) ermöglicht es Ihnen, die Daten in der Arbeitsmappe in der Vorschau zu sehen und die Daten jederzeit zu importieren. Die Arbeitsmappe kann als Vorlage gespeichert werden (<b>Datei: Template speichern unter</b>), in der auch Informationen bezüglich der Formatierung der Arbeitsmappe gespeichert werden können. Wenn Sie die Vorlage das nächste Mal öffnen, haben Sie eine formatierte Arbeitsmappe mit der gespeicherten benutzerdefinierten Anfrage. Indem Sie auf das Symbol des Datenbankkonnektors <a class="image"><img alt="Button database connector icon.png" src="../images/Building_and_Saving_a_Query/Button_database_connector_icon.png" width="19"></a> in der oberen linken Ecke der Vorlage klicken, können Sie den <b>Import</b> durchführen und die formatierte Arbeitsmappe mit Daten füllen, die aus der Datenquelle stammen. Um eine gespeicherte Abfrage im aktiven Arbeitsblatt anzuzeigen oder zu modifizieren, klicken Sie auf das Symbol des Datenbankkonnektors und wählen Sie <b>SQL-Editor</b>.</p>

  <p>Die gespeicherten Abfragedateien (ODQ) können über das Menü <b>Daten: Mit einer Datenbank verbinden: Öffnen</b> oder durch Navigieren und Klicken auf eine der gespeicherten Dateien in der Liste "Zuletzt verwendet" geladen werden. Nachdem eine *.ODQ-Datei geladen ist, können Sie ihre Vorschau anzeigen oder sie in die aktive Arbeitsmappe importieren. Dies ist nützlich, wenn Sie die Abfrage auf mehrere Arbeitsmappen anwenden möchten.</p>
