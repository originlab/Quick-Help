<h1 class="firstHeading">Mathematische Operationen mit Datum und Zeit</h1>

  <p class='urlname' style='display: none'>Date-Time-Math-Operations</p>

  <p>Das Importieren von Datums-/Zeit-Daten wurde für die neueren Versionen von Origin stark verbessert. <b>Origin 2020b</b> fügte einen verbesserten Import von Datums-/Zeitdaten für den <a class="external text" href="../../UserGuide/UserGuide/Connecting_to_File.html#Text.2FCSV_Connector"><b>Text-/CSV-Konnektor</b></a> hinzu und <b>Origin 2021</b> verbesserte den Umgang mit Datums/-Zeitdaten beim <a class="external text" href="../../QuickHelp/QuickHelp/How_to_paste_date_time_from_Excel.html">Kopieren/Einfügen von MS Excel</a>.</p>

  <p>In Bezug auf den älteren, auf X-Funktionen basierenden Import: Ihre Daten werden wahrscheinlich als <a href="../../UserGuide/UserGuide/Dates_and_Times_in_the_Worksheet.html#Formatting_Date_and_Time_Data" title="UserGuide:Dates and Times in the Worksheet">Text behandelt</a> werden, es sei denn, Sie importieren Datums-/Zeitdaten mit Hilfe eines Filters oder durch Festlegen eines benutzerdefinierten Formats in ASCII-Optionen (Sie können eine schnelle Prüfung durchführen, indem Sie nachsehen, ob die Datums-/Zeitdaten im Arbeitsblatt links ausgerichtet sind (Text) oder rechts (numerisch)). Um Ihre Datums-/Zeit-Daten in mathematischen Operationen zu verwenden (z. B. Berechnungen der abgelaufenen Zeit), müssen Sie sicherstellen, dass sie <a href="../../UserGuide/UserGuide/Dates_and_Times_in_the_Worksheet.html#Formatting_Date_and_Time_Data" title="UserGuide:Dates and Times in the Worksheet">passend formatiert</a> sind und als numerische Daten behandelt werden.</p>

  <p>Wenn Sie mathematische Operationen für Datums-/Zeitdaten durchführen müssen, achten Sie darauf, dass es in Origin eine große Anzahl von Standardfunktionen für <a class="external text" href="../../LabTalk/Script/LabTalk-Supported_Functions.html#Date_and_Time_Functions"><b>date-time</b></a>, <a class="external text" href="../../LabTalk/Script/LabTalk-Supported_Functions.html#String_Functions"><b>string</b></a> und <a class="external text" href="../../LabTalk/Script/LabTalk-Supported_Functions.html#Math_Functions"><b>math</b></a> gibt, mit denen numerische Datums-/Zeitdaten und Datums-/Zeitzeichenketten bearbeitet werden können.</p>

  <table class="noborder">
    <tr>
      <td style="vertical-align:top" width="60"><img src="../images/Date_Time_Math_Operations/Tip_icon.png" width="57" border="0" alt=""></td>

      <td>
        <p>Standardmäßig werden Datum-Zeit in Origin (<b>Format</b> = <b>Datum</b>, aber Datum schließt eine Zeitkomponente ein) intern als <a href="../../UserGuide/UserGuide/Dates_and_Times_in_Origin.html" title="UserGuide:Dates and Times in Origin">Julianische Tag</a>eswerte (double) gespeichert, wobei der ganzzahlige Anteil des Werts Tag ist und die Bruchteile Sekunden sind. Ausgehend von aktuellen Daten, ist die Auslösung in diesem System auf 0,0001 Sekunden begrenzt, wenn bei der vierten Dezimalstelle gerundet wird. Beachten Sie, dass seit Version 2019 Origin ein <a href="../../UserGuide/UserGuide/Dates_and_Times_in_Origin.html#Alternate_Date-Time_Systems_in_Origin" title="UserGuide:Dates and Times in Origin">"<b>2018</b>"-Datumssystem</a> unterstützt, in dem der "Zeitpunkt Null" mit dem 1. Januar 2018 00:00 definiert wird. In diesem System ist der ganzzahlige Teil kleiner und lässt eine höhere Auflösung für den Bruchteil zu. In diesem "2018"-System können Messungen von bis zu 10<sup>-8</sup> Sekunden unterstützt werden.</p>
      </td>
    </tr>
  </table>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>Inhalt</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1"><a href="#Date.2C_Time.2C_Month.2C_Day_of_the_Week"><span class="tocnumber">1</span> <span class="toctext">Datum, Zeit, Monat, Wochentag</span></a></li>

      <li class="toclevel-1 tocsection-2"><a href="#Date_and_time_math_operations:_dates_and_times"><span class="tocnumber">2</span> <span class="toctext">Mathematische Operationen mit Datum und Zeit: Datum- und Zeitangaben</span></a></li>

      <li class="toclevel-1 tocsection-3"><a href="#Date_and_time_math_operations:_months"><span class="tocnumber">3</span> <span class="toctext">Mathematische Operationen mit Datum und Zeit: Monate</span></a></li>

      <li class="toclevel-1 tocsection-4"><a href="#Date_and_time_math_operations:_days"><span class="tocnumber">4</span> <span class="toctext">Mathematische Operationen mit Datum und Zeit: Monate</span></a></li>
    </ul>
  </div>

  <h2><a name="Date.2C_Time.2C_Month.2C_Day_of_the_Week"></a><span class="mw-headline">Datum, Zeit, Monat, Wochentag</span></h2>

  <p>Datums- und Datum-/Zeit-Werte in Origin werden intern gespeichert als <a href="../../UserGuide/UserGuide/Dates_and_Times_in_Origin.html" title="UserGuide:Dates and Times in Origin">astronomische Julianische Tageszahlen</a> des Datentyps <b>double(8)</b>. Es ist wichtig, daran zu denken, dass diese intern gespeicherten Werte unabhängig von jeder <b>Anzeige</b>option sind, die Sie für Ihre Datums-/Zeit-Daten wählen mögen. Es sind diese Julianischen Tageswerte, die für das Durchführen von mathematische Operationen auf Datums- und Zeitdaten verwendet werden.</p>

  <dl>
    <dd>
      <dl>
        <dd><a class="image"><img alt="Date Time Math 02.png" src="../images/Date_Time_Math_Operations/Date_Time_Math_02.png" width="551"></a></dd>
      </dl>
    </dd>
  </dl>

  <p>Die andere Sache, die wichtig zu beachten wäre, ist, dass Sie ohne Präzisionsverlust frei zwischen allen unterstützten <b>Anzeige</b>optionen für Datum und Zeit wechseln können, weil der intern gespeicherte Wert nicht von der Wahl des <b>Anzeige</b>formats beeinflusst wird (d. h., der Wechsel von einem in Teilsekunden formatierten Datums-/Zeit-Wert zu Monat und zurück zum ursprünglichen Datums-/Zeit-Wert macht keinen Unterschied für den zugrunde liegenden Wert -- von der Präzision geht nichts verloren).</p>

  <p>Origin unterstützt vier grundlegende <b>Formate</b>: <b>Datum</b>, <b>Zeit</b>, <b>Monat</b> und <b>Wochentag</b>. Für jedes dieser Formate gibt es eine Anzahl von unterstützten <b>Anzeige</b>optionen (z. B. Monat kann "Jan", "Januar" oder "J" sein zusätzlich zu den Anzeigeoptionen für Monat, die in den Datumsnotationen verwendet werden).</p>

  <p><br>
  <i><b>Weitere Informationen finden Sie unter:</b></i></p>

  <ul>
    <li>Die Optionen für <a href="../../UserGuide/UserGuide/The_(Column_Properties)_Properties_Tab.html#Format" title="UserGuide:The (Column Properties) Properties Tab"><b>Format</b></a> im Dialog <b>Spalteneigenschaften</b></li>

    <li>Die Optionen für <a href="../../UserGuide/UserGuide/The_(Column_Properties)_Properties_Tab.html#Display" title="UserGuide:The (Column Properties) Properties Tab"><b>Anzeige</b></a> im Dialog <b>Spalteneigenschaften</b></li>
  </ul>

  <table class="noborder">
    <tr>
      <td style="vertical-align:top" width="60"><img src="../images/Date_Time_Math_Operations/Tip_icon.png" width="57" border="0" alt=""></td>

      <td>
        <p>Wenn Ihre Datums-/Zeitspalte fehlende Werte ("--") enthält, siehe diesen <a href="../../UserGuide/UserGuide/Dates_and_Times_in_the_Worksheet.html#A_Note_about_Missing_Values_in_Date-Time_Data" title="UserGuide:Dates and Times in the Worksheet">Hinweis zu fehlenden Werten in Datums-/Zeitdaten</a>.</p>
      </td>
    </tr>
  </table>

  <h2><a name="Date_and_time_math_operations:_dates_and_times"></a><span class="mw-headline">Mathematische Operationen mit Datum und Zeit: Datums- und Zeitangaben</span></h2>

  <p>Wenn Sie ein Arbeitsblatt haben, in dem die Spalte "A" einige Datums-/Zeitwerte enthält und die Spalte "B" einige Messungen, die bei jedem Datums-/Zeitwert in Spalte "A" gemacht wurden, möchten Sie vielleicht wissen, wie viel Zeit zwischen jeder Messung vergangen ist. Sie können dies einfach bestimmen, indem Sie eine dritte Spalte "C" erstellen und dann <a href="../../UserGuide/UserGuide/Quick_Start_SetColumnValues.html" title="UserGuide:Quick Start SetColumnValues">den Dialog <b>Werte setzen</b></a> verwenden, um einen Datensatz der vergangenen Zeit zwischen den Messungen zu erzeugen.</p>
  <pre class="lt" style="font-family:monospace;">
A<span style="color: #000000;">[</span>i<span style="color: #000000;">]</span><span style="color: #000080;">-</span>A<span style="color: #000000;">[</span>i<span style="color: #000080;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">]</span>   <span style="color: #008000;">//for i = 2 to last row of column A</span>
</pre>

  <dl>
    <dd>
      <dl>
        <dd><a class="image"><img alt="Date Time Math 01.png" src="../images/Date_Time_Math_Operations/Date_Time_Math_01.png" width="713"></a></dd>
      </dl>
    </dd>
  </dl>

  <table class="noborder">
    <tr>
      <td style="vertical-align:top" width="60"><img src="../images/Date_Time_Math_Operations/Alert_icon.png" width="57" border="0" alt=""></td>

      <td>
        <p><b>Origin 2021b</b> erhöhte die Beschränkung der <i>Zeit</i>formate <i>von 240 auf 548 Tage</i> (d. h., Sie können jetzt 13151:00 in eine <i>Zeit</i>spalte eingeben, die auf <b>Anzeige</b> = <i>HH:mm</i> gesetzt ist, und es wird 13151:00 angezeigt. Die Eingabe von 13152:00 dagegen zeigt 00:00 an). Beim Berechnen von verstrichenen Zeiträumen, die den Verlauf von mehr als 548 Tagen betreffen, erlaubt das Ändern der Spalte <b>Format</b> von <i>Zeit</i> auf <i>Numerisch</i> Ihnen, die Zeit in Tagen nachzuverfolgen, einschließlich fraktionale Komponenten.</p>
      </td>
    </tr>
  </table>

  <h2><a name="Date_and_time_math_operations:_months"></a><span class="mw-headline">Mathematische Operationen mit Datum und Zeit: Monate</span></h2>

  <p>Wie erwähnt gibt es eine Anzahl von Origin-Funktionen, die verwendet werden können, um numerische und Datums-/Zeit-Textzeichenketten zu bearbeiten. Eine Liste <a class="external text" href="../../LabTalk/Script/LabTalk-Supported_Functions.html">dieser Funktionen</a> befindet sich im LabTalk Scripting Guide. Beim Konvertieren von numerischen Werten in Monatsdarstellungen verwendet Origin eine dieser Funktionen - die Funktion <b>mod</b> (modulus).</p>

  <p><b>Monate</b> werden von Januar (1) bis Dezember (12) durchnummeriert. Zahlen größer als 12 werden bei der Umwandlung in einen <b>Monat</b> mit einer Modulo-Funktion umgerechnet (siehe <a class="external text" href="../../LabTalk/LabTalk/Mod_(function).html">Mod</a>). Die LabTalk Modulo-Funktion verwendet die folgende Syntax:</p>

  <p><b>mod(x,y)</b> = der Rest der Division der Ganzzahl x geteilt durch die Ganzzahl y.</p>

  <p>Zum Beispiel:</p>

  <p>46 wird z.B. in Oktober umgewandelt, da <b>mod(46,12)</b> 10 entspricht und 10 für Oktober steht (Dezember entspricht in diesem Fall 0).</p>

  <p>Beachten Sie, dass Sie keine Werte in eine Zelle eingeben können, die sich außerhalb des Bereichs von 1 bis 12 befinden, wenn in dieser Zelle das <b>Format</b> auf <b>Monat</b> festgelegt wurde. Falls Sie dies dennoch machen, zeigt Origin einen fehlenden Wert in dieser Zelle an. Um solche Werte in ein Arbeitsblatt einzugeben, legen Sie das Format auf <b>Text &amp; Numerisch</b> fest und geben Sie Ihre Zahlen ein. Danach können Sie das <b>Format</b> der Spalten auf <b>Monat</b> zurücksetzen.</p>

  <h2><a name="Date_and_time_math_operations:_days"></a><span class="mw-headline">Mathematische Operationen mit Datum und Zeit: Tage</span></h2>

  <p><b>Wochentage</b> sind von Sonntag (0) bis Samstag (6) durchnummeriert. Zahlen größer als 6 werden bei der Umwandlung in einen <b>Tag</b> mit einer <a class="external text" href="../../LabTalk/LabTalk/Mod_(function).html">Modulo-Funktion</a> umgerechnet.</p>

  <p>Zum Beispiel:</p>

  <p>46 wird z.B. in Donnerstag umgewandelt, da <b>mod(46,7)</b> 4 ergibt und 4 für Donnerstag steht.</p>

  <p>Beachten Sie, dass Sie keine Werte in eine Zelle einer Spalte eingeben können, die sich außerhalb des Bereichs von 0 bis 6 befinden, wenn in dieser Zelle das <b>Format</b> auf <b>Tag</b> festgelegt wurde. Falls Sie dies dennoch machen, zeigt Origin einen fehlenden Wert in dieser Zelle an. Um solche Werte in ein Arbeitsblatt einzugeben, legen Sie das <b>Format</b> auf <b>Text &amp; Numerisch</b> fest und geben Sie Ihre Zahlen ein. Danach können Sie das <b>Format</b> der Spalten auf <b>Tag</b> zurücksetzen.</p>
