<h1 class="firstHeading">Mit Web verbinden</h1>

  <p class='urlname' style='display: none'>Connect-to-Web</p>

  <p>Die Funktion <b>Mit Web verbinden</b> stellt eine Verbindung zwischen Origin-Arbeitsblatt und Datendatei her, die entweder aus einem Online-Pfad oder einer Tabelle auf einer Webseite stammt. Wenn sich die Datenquelle ändert, können Sie die Daten einfach erneut importieren, um alles auf dem aktuellen Stand zu haben.</p>

  <table class="noborder">
    <tr>
      <td style="vertical-align:top" width="60"><img src="../images/Connecting_to_Web/Alert_icon.png" width="57" border="0" alt=""></td>

      <td>
        <p><a class="external text" href="../../License/Category/Single-User_Node-Locked_License(License).html">Node-Locked</a>- und <a class="external text" href="../../License/Category/Concurrent_License(License).html">Concurrent</a>-Anwender können den Menübefehl <b>Mit Web verbinden</b> nicht verwenden, bevor sie ihr Origin nicht richtig aktiviert haben. Weitere Einzelheiten finden Sie in <a class="external text" href="../../QuickHelp/QuickHelp/Why_my_Connect_to_Wed/Cloud_menu_grey_out.html">dieser FAQ</a>.</p>
      </td>
    </tr>
  </table>

  <p><br>
  <span class='headerInParagraph'>Zum Öffnen von Datenkonnektoren</span></p>

  <ol>
    <li>Wählen Sie bei aktivem/r Arbeitsblatt/Matrix das Menü <b>Daten: Mit Web verbinden</b> und wählen Sie dann den gewünschten Dateityp. Es werden viele Datentypen, einschließlich CSV, JSON, HTML-Tabelle, Origin-Projekt etc., unterstützt. Sie können auch die App des Datenkonnektors für einen neuen Datentyp über das Menü ‘’’Neu hinzufügen’’’ installieren.</li>
  </ol>

  <p>Der Dialog <b>Mit Web verbinden</b> wird geöffnet.</p>

  <table class="noborder">
    <tr>
      <td style="vertical-align:top" width="60"><img src="../images/Connecting_to_Web/Tip_icon.png" width="57" border="0" alt=""></td>

      <td>
        <p>Daten, die über <b>Mit Web verbinden</b> importiert wurden, werden für einen Zeitraum im Zwischenspeicher gespeichert, der <a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#C"><b>@CFDT</b></a> Sekunden pro 100 kB der Dateigröße entspricht (z. B. werden verbundene Daten in einer Datei von 10 MB für 900 * 100 = 90.000 s oder ~24 h gespeichert). Daher verwendet ein erneuter Import der verbundenen Daten in das Projekt die zwischengespeicherten Daten, falls der Zeitraum nicht überschritten wurde. Wenn der Zeitraum abgelaufen ist, werden die zwischengespeicherten Daten gelöscht, wodurch es möglich ist, dass die Daten beim Import aktualisiert werden. Um die zwischengespeicherten Daten manuell zu löschen, siehe <a class="external text" href="../../LabTalk/LabTalk/Delete_(command).html#-web.3B_Clear_the_URL-to-File_cache_used_by_Web_Connectors_.28Data:_Connect_to_Web.29"><b>delete -web</b></a>.</p>
      </td>
    </tr>
  </table>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>Inhalt</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1">
        <a href="#Basic_operation"><span class="tocnumber">1</span> <span class="toctext">Einfache Operation</span></a>

        <ul>
          <li class="toclevel-2 tocsection-2"><a href="#HTML_Connector_Options"><span class="tocnumber">1.1</span> <span class="toctext">Optionen des HTML-Konnektors</span></a></li>
        </ul>
      </li>

      <li class="toclevel-1 tocsection-3">
        <a href="#Advanced_operation"><span class="tocnumber">2</span> <span class="toctext">Erweiterte Operation</span></a>

        <ul>
          <li class="toclevel-2 tocsection-4"><a href="#URL_Parts"><span class="tocnumber">2.1</span> <span class="toctext">URL-Teile</span></a></li>

          <li class="toclevel-2 tocsection-5"><a href="#POST_Data"><span class="tocnumber">2.2</span> <span class="toctext">POST-Daten</span></a></li>
        </ul>
      </li>

      <li class="toclevel-1 tocsection-6"><a href="#Examples"><span class="tocnumber">3</span> <span class="toctext">Beispiele</span></a></li>
    </ul>
  </div>

  <h2><a name="Basic_operation"></a><span class="mw-headline">Einfache Operation</span></h2>

  <dl>
    <dd><a class="image"><img alt="Data connector from web basic.png" src="../images/Connecting_to_Web/Data_connector_from_web_basic.png" width="511"></a></dd>
  </dl>

  <ol>
    <li>Geben Sie im <b>einfachen</b> Modus einen URL-Link in das Bearbeitungsfeld <b>URL</b> ein oder fügen Sie ihn ein. Um eine zuvor aufgerufene URL zu laden, klicken Sie auf <b>Zuletzt verwendete URLs</b>.

      <table class="noborder">
        <tr>
          <td style="vertical-align:top" width="60"><img src="../images/Connecting_to_Web/Tip_icon.png" width="57" border="0" alt=""></td>

          <td>
            <ul>
              <li>Die <b>Zuletzt verwendeten URLs</b> listen weiterhin Ihre Verbindungen auf, während die <b>Sample URLs</b> einige Beispielverbindungen in Formaten wie <b>CSV</b>, <b>HTML</b>, <b>JSON</b> und <b>MATLAB</b> aufführen.</li>
            </ul>

            <dl>
              <dd><a class="image"><img alt="Connect to web dialog samples 2023.png" src="../images/Connecting_to_Web/Connect_to_web_dialog_samples_2023.png" width="668"></a></dd>
            </dl>

            <ul>
              <li>Falls gewünscht, können Sie LabTalk-Variablen vordefinieren und sie dann für Substitutionen im URL-Link verwenden. Die LabTalk-Variablen müssen mit Prozent kodiert sein, zum Beispiel:
                <pre class="lt" style="font-family:monospace;">
https<span style="color: #000000;">:</span><span style="color: #008000;">//.....%(var$)...</span>
</pre>. Sie können die eigentliche Zeichenkette der URL in der <b>URL-Vorschau</b> sehen.
              </li>
            </ul>

            <dl>
              <dd><a class="image"><img alt="Data connector from web lt variable.png" src="../images/Connecting_to_Web/450px-Data_connector_from_web_lt_variable.png" width="450"></a></dd>
            </dl>
          </td>
        </tr>
      </table>
    </li>

    <li>Klicken Sie auf <b>OK</b>, um eine Verbindung zum Webserver herzustellen.</li>

    <li>Wählen Sie im Dialog <b>Auswählen...</b> die gewünschte Tabelle aus und klicken Sie auf den nach unten weisenden Pfeil, um sie zum unteren Feld hinzuzufügen. Klicken Sie zum Importieren auf <b>OK</b>. Beachten Sie, dass Sie den <a href="../../UserGuide/UserGuide/Data_Navigator.html#Connect_to_Multi-page_Files" title="UserGuide:Data Navigator">Datennavigator</a> verwenden können, um andere Tabellen später zu importieren.</li>
  </ol>

  <table class="note">
    <tr>
      <td>
        <b>Hinweise:</b>

        <ul>
          <li><b>Mit Web verbinden</b> unterstützt HTTP, HTTPS und FTP (Site muss einen anonymen Login für Benutzername und Passwort zulassen).</li>

          <li>Um Daten aus der DropBox zu teilen: können Sie einen Freigabelink erstellen und dann den Linktext für die URL des Datenkonnektors verwenden. Zusätzlich müssen Sie:

            <ol>
              <li>Ändern Sie den letzten Teil des Freigabelinks von <code>?dl=0</code> in&#160;<code>?dl=1</code>, ansonsten funktioniert der Link nicht.</li>

              <li>Setzen Sie die <a href="../../UserGuide/UserGuide/Set_System_Variables_Dialog_Box.html" title="UserGuide:Set System Variables Dialog Box">Systemvariable</a> vor dem Importieren der Daten auf <code>@HTTPMR = 1;</code>.</li>
            </ol>
          </li>
        </ul>
      </td>
    </tr>
  </table>

  <h3><a name="HTML_Connector_Options"></a><span class="mw-headline">Optionen des HTML-Konnektors</span></h3>

  <p>Klicken Sie nach dem Import auf das Konnektorsymbol <a class="image"><img alt="Dadta connector icon connect.png" src="../images/Connecting_to_Web/Dadta_connector_icon_connect.png" width="16"></a> und wählen Sie <b>Optionen</b> im Menü, um den Dialog <b>Optionen des HTML-Konnektors</b> zu öffnen.</p>

  <p><a class="image"><img alt="Connect to Web Options dialog.png" src="../images/Connecting_to_Web/Connect_to_Web_Options_dialog.png" width="349"></a></p>

  <table class="simple">
    <tr>
      <th>Website-Skripte ausführen<br>
      Direkter URL-Zugriff</th>

      <td>
        <p>Falls die importierte HTML-Tabelle Webseitencode (z B. CSS) enthält und Sie möchten, dass die importierten Daten genauso aussehen wie die Inhalte der Webseite, müssen Sie beide Kontrollkästchen aktivieren.</p>

        <p><b>Direkter URL-Zugriff (ohne einen lokalen Datenzwischenspeicher)</b> stellt eine direkte Verbindung zum URL-Link her. Ansonsten wird ein lokaler Dateizwischenspeicher verwendet.</p>
      </td>
    </tr>

    <tr>
      <th width="22%">Partieller Import von Tabellenspalten</th>

      <td>
        <p>Der partielle Import von Tabellenspalten verwendet die gleiche Syntax wie der CSV-Konnektor.</p>

        <p>Siehe <a href="../../UserGuide/Category/Partial_Importing_and_Re_Importing.html#Partial_Import_Controls_used_by_Import_From_File" title="Category:Partial Importing and Re Importing">Beschreibung des "benutzerdefinierten" Optionselements in der Tabelle</a>, um mehr über die Syntax zu erfahren, die im partiellen Import verwendet werden kann.</p>
      </td>
    </tr>

    <tr>
      <th>Partiellen Tabellenname verwenden</th>

      <td>
        <p>Verwenden Sie den partiellen Tabellenname als Blattname durch die folgende Syntax.</p>

        <ul>
          <li>Leerzeichen ( ) = "and".</li>

          <li>Doppelpunkt (:) trennt <b>Von</b> und <b>Bis</b>.</li>
        </ul>

        <p><b>Beispiel</b>: Angenommen, der Tabellenname lautet "<i>The eight metropolitan statistical areas of the Commonwealth</i>".</p>

        <dl>
          <dd><code>1 3 5 7 9</code> benennt das Blatt als <i>Teegt</i>.</dd>

          <dd><code>5:22</code> benennt das Blatt um als <i>eight metropolitan</i>.</dd>
        </dl>
      </td>
    </tr>
  </table>

  <h2><a name="Advanced_operation"></a><span class="mw-headline">Erweiterte Operation</span></h2>

  <p>Einige Webanfragen über <b>Datenkonnektor</b> sind möglicherweise komplexer und erfordern das Festlegen <b>erweiterter</b> Einstellungen im Dialog <b>Mit Web verbinden</b>.</p>

  <h3><a name="URL_Parts"></a><span class="mw-headline">URL-Teile</span></h3>

  <p>In einem weiteren Beispiel besteht die folgende URL aus einer Reihe von Variablen in Form von <i>Pfadkomponenten</i> oder <i>Teilen</i>.</p>
  <pre>
https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/2244
</pre>

  <p>In diesem Fall können die <i>Pfadkomponenten</i> heruntergebrochen werden auf:</p>
  <pre>
https://pubchem.ncbi.nlm.nih.gov/rest/pug /compound /cid /2244
</pre>

  <p>Auch wenn es nicht immer unbedingt notwendig ist, die URL auf ihre unterschiedlichen Teile herunterzubrechen, kann es vorkommen, dass es sich aus Gründen der Klarheit anbietet, wie im obigen Fall. Im Dialog <b>Mit Web verbinden</b> würden diese Teile, wie unten gezeigt, angegeben:</p>

  <p><a class="image"><img alt="Data connector from web advance2.png" src="../images/Connecting_to_Web/450px-Data_connector_from_web_advance2.png" width="450"></a></p>

  <p>Beachten Sie, dass die Schaltfläche <b>Teil hinzufügen</b> eine neue Gruppe von Bedienelementen zum Festlegen der <b>URL-Teile</b> hinzufügt. Beachten Sie außerdem, dass es für jedes Teil einen Pfeil <b>nach oben</b> und <b>nach unten</b>zum Ändern der Reihenfolge der Teile mitsamt einer <span style="font-size: 1.5em;"><b>�</b></span>-Schaltfläche zum Entfernen des Teils gibt.</p>

  <p><b>Hinweis:</b> Für URL-Teile wird die LabTalk-Substitution unterstützt.</p>

  <p>Mit dem optionalen Bedienelement <b>Zeitüberschreitung für Befehl in Minuten</b> (Command Timeout) können Anwender die Anzahl der Minuten bestimmen, nach der die Anfrage von Daten abgebrochen wird. Bleibt diese Angabe leer <i>(was im Allgemeinen empfohlen wird)</i>, läuft die Anfrage solange wie notwendig oder bis der Server selbst die Anfrage abbricht.</p>

  <p>Der optionale Bedienelementabschnitt <b>Headerparameter der HTTP-Anfrage</b> ist wahrscheinlich der Grund für die Verwendung der <b>Erweiterten</b> Einstellungen. Zusätzlich zu einer URL können einige Webservice-APIs einen oder mehrere beliebige <a class="external text" href="https://en.wikipedia.org/wiki/List_of_HTTP_header_fields#Standard_request_fields" target="_blank">HTTP -Anfrageheader</a> mit der Anfrage zusammen erfordern. <i>Dies hängt stark von den Anforderungen des Webservices ab - diesbezüglich gibt es keine Regeln.</i></p>

  <p>Wenn Sie aus einer <b>Auswahlliste</b> allgemeine Anfrageheadernamen auswählen und dann auf die Schaltfläche <b>Hinzufügen</b> klicken, werden zwei Textfeldelemente erzeugt, eines für den Headernamen und eines für den Headerwert. Benutzerdefinierte Header können ebenfalls hinzugefügt werden, indem <b>--- Benutzerdefiniert ---</b> in der Auswahlliste ausgewählt oder einfach der Name eines bereits enthaltenen Headers überschrieben wird.</p>

  <p>Für die in diesem Beispiel angegebene URL ist ein <b>Accept</b>-Header erforderlich. Sein Wert muss auf <a class="external text" href="https://en.wikipedia.org/wiki/Media_type" target="_blank">Medientyp</a> gesetzt sein, damit der Datentyp ausgegeben werden kann. In diesem Fall ist das <b>application/json</b>.</p>

  <table class="note">
    <tr>
      <td><b>Hinweis:</b> Ein Anfrageheader mit dem Namen <b>Authorization</b> ist in der Liste enthalten. <i><b>Gehen Sie nicht davon aus, dass es sich bei diesem Header automatisch um ein Passwort handelt!</b></i> Nicht alle Webservices benötigen diesen Header. Der Webservice selbst muss definieren, wie der Wert aussehen soll. <i>Es gibt keine Regeln in Bezug darauf, was einen angemessenen Wert ausmacht.</i></td>
    </tr>
  </table>

  <h3><a name="POST_Data"></a><span class="mw-headline">POST-Daten</span></h3>

  <p>Einige Web-Services erwarten eine POST-Anfrage mit verschiedenen Parameter im Anfragekörper. Sie tun dies, so dass einige Parameter nicht Teil einer einfach sichtbaren URL sind oder falls mehr Infos bereitgestellt werden müssen, die eine GET-Anfrage eingefügt werden können.</p>

  <p>Aktivieren Sie diese Option, indem Sie auf das Kästchen klicken. Hinzugefügter Text wird der "Anfragenkörper." Es gibt keine Prüfung, das heißt, der Anwender ist verantwortlich dafür sicherzustellen, dass der Text für eine POST-Anfrage richtig formatiert ist.</p>

  <dl>
    <dd><a class="image"><img alt="Web Connect Post Data.png" src="../images/Connecting_to_Web/Web_Connect_Post_Data.png" width="746"></a></dd>
  </dl>

  <p><br>
  <i><b>Beispiel für eine POST-Anfrage:</b></i></p>

  <p><b>URL</b>: <i><a class="external free" href="https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/property/MolecularFormula,MolecularWeight/CSV" target="_blank">https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/property/MolecularFormula,MolecularWeight/CSV</a></i><br>
  <b>Request Body</b>: <i>cid=1,2,3,4,5</i><br>
  <b>HTTP Request Header Parameters</b>: <i>Content-Type - application/x-www-form-urlencoded</i><br>
  <b>Header</b>: <i>Accept</i></p>

  <p>Die erwartete Antwort entspricht in etwa dieser:<br>
  ResponseBody: "CID","MolecularFormula","MolecularWeight"<br>
  1,"C9H17NO4",203.238000<br>
  2,"C9H18NO4+",204.246000<br>
  3,"C7H8O4",156.137000<br>
  4,"C3H9NO",75.111000<br>
  5,"C3H8NO5P",169.073000</p>

  <h2><a name="Examples"></a><span class="mw-headline">Beispiele</span></h2>

  <p><span class='headerInParagraph'>Beispiel 1</span></p>

  <p><a class="external text" href="http://blog.originlab.com/data-import/data-connector-json?tdsourcetag=s_pcqq_aiomsg" target="_blank">Tutorial des Web-Datenkonnektors von Origin</a></p>

  <p><span class='headerInParagraph'>Beispiel 2</span></p>

  <p>Öffnen Sie <i>Signal Processing - FFT Gadget with Data Connector.opju</i>, um ein Beispiel für eine mit dem Web verbundene Datei mit Daten zu Sonnenflecken zu sehen:</p>

  <ol>
    <li>Wählen Sie <b>Hilfe: Lernzentrum</b>.</li>

    <li>Aktivieren Sie im Dialog die Registerkarte Analysebeispiel. Wählen Sie <b>Signalverarbeitung</b> in der Auswahlliste <b>Beispiele in</b>.</li>

    <li>Klicken Sie doppelt auf <b>Minitool FFT mit Datenkonnektor</b>, um das Beispiel zu öffnen.</li>
  </ol>
