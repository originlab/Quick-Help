<h1 class="firstHeading">FAQ-800 Wie richte ich SQL ein?</h1>

  <p class='urlname' style='display: none'>set-up-sql</p>

  <p class='faqID'>Letztes Update: 18.07.2018</p>

  <p>Origin enthält mehrere Tutorials, die bedienfreundliche Hilfsmittel frür den Zugriff auf Datenbanken vorstellen. Um diese Tutorials auf Ihrem eigenen Computer zu üben, verwenden Sie die Datenbank AdventureWorks. Der folgende Abschnitt erläutert die Konfiguration Ihres SQL-Servers und wie Sie eine AdventureWorks-Datenbank mit Ihrem SQL-Server anhängen und mit Origin verbinden.</p>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>Inhalt</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1"><a href="#Download_the_AdventureWorks_database"><span class="tocnumber">1</span> <span class="toctext">AdventureWorks-Datenbank herunterladen</span></a></li>

      <li class="toclevel-1 tocsection-2"><a href="#Set_up_your_SQL_Server"><span class="tocnumber">2</span> <span class="toctext">SQL-Server einrichten</span></a></li>

      <li class="toclevel-1 tocsection-3"><a href="#Configure_the_Data_Sources_.28ODBC.29"><span class="tocnumber">3</span> <span class="toctext">Datenquellen (ODBC) konfigurieren</span></a></li>

      <li class="toclevel-1 tocsection-4"><a href="#Connect_the_database_in_Origin"><span class="tocnumber">4</span> <span class="toctext">Datenbank in Origin verbinden</span></a></li>
    </ul>
  </div>

  <h3><a name="Download_the_AdventureWorks_database"></a><span class="mw-headline">AdventureWorks-Datenbank herunterladen</span></h3>

  <p>Laden Sie die Datenbank AdventureWorks über <a class="external text" href="https://msftdbprodsamples.codeplex.com/releases/view/125550" target="_blank">diesen Link</a> herunter. Bitte wählen Sie <a class="external text" href="https://msftdbprodsamples.codeplex.com/downloads/get/880661" target="_blank">Adventure Works 2014 Full Database Backup.zip</a> für den Download und extrahieren Sie die Datei auf Ihrer Festplatte, z.B.: <i>E:\</i>. Die extrahierte Datei heißt <i>AdventureWorks2014.bak</i>.</p>

  <h3><a name="Set_up_your_SQL_Server"></a><span class="mw-headline">SQL-Server einrichten</span></h3>

  <p>Bevor Sie die Datenbank AdventureWorks installieren, müssen Sie eine Instanz des SQL-Servers auf Ihrem lokalen Rechner installiert haben. Die folgenden Schritte zeigen, wie Sie Microsoft SQL Server 2014 Express installieren:</p>

  <p><b>Hinweis:</b> Ihr Betriebssystem sollte <b>Windows 7</b> oder höher sein.</p>

  <ol>
    <li>Öffnen Sie die <a class="external text" href="https://www.microsoft.com/en-us/download/details.aspx?id=42299" target="_blank">Download-Webseite</a>. Möglicherweise müssen Sie sich in Ihrem Microsoft-Konto anmelden. Klicken Sie dann auf DOWNLOAD.</li>

    <li>Wählen Sie die Datei <b>ExpressAdv 32BIT\SQLEXPRADV_x86_ENU.exe</b> (für 32-Bit-System) oder <b>ExpressAdv 64BIT\SQLEXPRADV_x64_ENU.exe</b> (für 64 Bit-System) und klicken Sie dann auf <b>Weiter</b>, um den Download zu starten.</li>

    <li>Auf der Downloadseite gibt es eine kurze <b>Installationsanweisung</b>. Sie können beim Installieren alle Standardeinstellungen übernehmen.</li>

    <li>Wenn die Installation beendet ist, gehen Sie bitte zum Menü <b>Start</b> von Windows, klicken auf <b>Alle Programme</b> und navigieren zu <b>Microsoft SQL Server 2014: SQL Server 2014 Management Studio</b>, um den SQL-Server zu öffnen.</li>

    <li>Der Dialog <b>Mit Server verbinden</b> wird aufgerufen, um die Verbindungseinstellung festzulegen. Bitte wählen Sie den <b>Servertyp</b> und die <b>Authentifizierung</b> wie im Bild unten und klicken Sie dann auf <b>Verbinden</b>.

      <dl>
        <dd><a class="image"><img alt="SQL initialize.png" src="../images/How_to_set_up_the_SQL/SQL_initialize.png" width="426"></a></dd>
      </dl>
    </li>

    <li>Klicken Sie mit der rechten Maustaste auf <b>Datenbank</b> im Feld <b>Objekt-Explorer</b> und wählen Sie Datenbank wiederherstellen, um den Dialog zu öffnen.

      <dl>
        <dd><a class="image"><img alt="SQL restore.png" src="../images/How_to_set_up_the_SQL/SQL_restore.png" width="386"></a></dd>
      </dl>
    </li>

    <li>Wählen Sie das Gerät im Abschnitt Quelle, suchen Sie und fügen Sie die Datei <i>AdventureWorks2014.bak</i> hinzu, die wir im vorherigen Abschnitt heruntergeladen haben. Klicken Sie auf OK, um diese Einstellungen anzuwenden.</li>
  </ol>

  <p><a class="image"><img alt="SQL database.png" src="../images/How_to_set_up_the_SQL/SQL_database.png" width="878"></a> 8. Jetzt haben Sie die Datenbank erfolgreich importiert.</p>

  <h3><a name="Configure_the_Data_Sources_.28ODBC.29"></a><span class="mw-headline">Datenquellen (ODBC) konfigurieren</span></h3>

  <ol>
    <li>Klicken Sie auf die Schaltfläche <b>Start</b> in Windows und geben Sie <b>Datenquellen</b> im Feld <b>Programme und Dateien suchen</b> ein. Wenn Sie diese Anwendung in der Liste finden, klicken Sie auf das Element, um den Dialog zu öffnen.

      <dl>
        <dd><a class="image"><img alt="SQL source.png" src="../images/How_to_set_up_the_SQL/SQL_source.png" width="228"></a></dd>
      </dl>
    </li>

    <li>Wechseln Sie zur Registerkarte <b>System DSN</b> in dem Dialog, klicken Sie auf <b>Hinzufügen</b>, um den Dialog <b>Neue Datenquelle erstellen</b> zu öffnen, und wählen Sie <b>ODBC Driver 11 for SQL Server</b>.

      <dl>
        <dd><a class="image"><img alt="SQL odbc.png" src="../images/How_to_set_up_the_SQL/SQL_odbc.png" width="478"></a></dd>
      </dl>
    </li>

    <li>Klicken Sie auf <b>Fertigstellen</b>. Ein neuer Dialog wird aufgerufen. Bitte legen Sie den Namen fest, beispielsweise: New_test, und wählen Sie (local) als Server aus.

      <dl>
        <dd><a class="image"><img alt="SQL odbc2.png" src="../images/How_to_set_up_the_SQL/SQL_odbc2.png" width="580"></a></dd>
      </dl>
    </li>

    <li>Klicken Sie auf <b>Fertigstellen</b>. Der Setup-Dialog des ODBC Microsoft SQL Server wird geöffnet. Sie können auf die Schaltfläche <b>Datenquelle testen</b> klicken.

      <dl>
        <dd><a class="image"><img alt="SQL odbc3.png" src="../images/How_to_set_up_the_SQL/SQL_odbc3.png" width="408"></a></dd>

        <dd>Wenn alles gut geht, informiert eine Meldung Sie darüber, dass: Test erfolgreich abgeschlossen! Klicken Sie in jedem Dialog auf OK, um diese Einstellungen anzuwenden.</dd>

        <dd><a class="image"><img alt="SQL odbc4.png" src="../images/How_to_set_up_the_SQL/SQL_odbc4.png" width="378"></a></dd>
      </dl>
    </li>
  </ol>

  <h3><a name="Connect_the_database_in_Origin"></a><span class="mw-headline">Datenbank in Origin verbinden</span></h3>

  <ol>
    <li>Öffnen Sie Origin und klicken Sie auf <a class="image"><img alt="Button Open SQL Editer.png" src="../images/How_to_set_up_the_SQL/Button_Open_SQL_Editer.png" width="24"></a> in der Symbolleiste Datenbankzugriff, um den SQL-Editor zu öffnen. Klicken Sie auf <a class="image"><img alt="Db editor connect.png" src="../images/How_to_set_up_the_SQL/Db_editor_connect.png" width="23"></a>, um den Dialog <b>Datenverknüpfungseigenschaften</b> zu öffnen, und wählen Sie <b>Microsoft OLE DB Provider for ODBC Drivers</b>:

      <dl>
        <dd><a class="image"><img alt="SQL odbc5.png" src="../images/How_to_set_up_the_SQL/SQL_odbc5.png" width="377"></a></dd>
      </dl>
    </li>
  </ol>

  <p>Klicken Sie auf <b>Weiter</b>, um die <b>Verbindung</b> festzulegen, wählen Sie <b>New_test</b> in Datenquellenname verwenden aus und dann <b>AdventureWorks2014</b> unter Wählen Sie die Datenbank auf dem Server aus.</p>

  <ol>
    <li>
      <dl>
        <dd><a class="image"><img alt="SQL odbc6.png" src="../images/How_to_set_up_the_SQL/SQL_odbc6.png" width="377"></a></dd>
      </dl>
    </li>

    <li>Sie können auf die Schaltfläche <b>Verbindung testen</b>. Wenn die Verbindung erfolgreich hergestellt wurde, wird die Meldung angezeigt: Verbindung testen erfolgreich!</li>

    <li>Klicken Sie auf OK, um diese Einstellungen anzuwenden. Klicken Sie nur im Fenster Anmeldung auf OK. Ihnen wird eine Tabellengruppe im rechten Bedienfeld gezeigt.

      <dl>
        <dd><a class="image"><img alt="SQL odbc7.png" src="../images/How_to_set_up_the_SQL/SQL_odbc7.png" width="476"></a></dd>
      </dl>
    </li>

    <li>Geben Sie die SQL-Abfrage im linken Eingabefeld für einen Test ein:</li>
  </ol>
  <pre class="sql" style="font-family:monospace;">
<span style="color: #993333; font-weight: bold;">SELECT</span> e<span style="color: #66cc66;">.</span>BusinessEntityID<span style="color: #66cc66;">,</span> p<span style="color: #66cc66;">.</span>FirstName<span style="color: #66cc66;">,</span> p<span style="color: #66cc66;">.</span>MiddleName<span style="color: #66cc66;">,</span> p<span style="color: #66cc66;">.</span>LastName <span style="color: #993333; font-weight: bold;">FROM</span> HumanResources<span style="color: #66cc66;">.</span>Employee <span style="color: #993333; font-weight: bold;">AS</span> e <span style="color: #993333; font-weight: bold;">INNER</span> <span style="color: #993333; font-weight: bold;">JOIN</span> Person<span style="color: #66cc66;">.</span>Person <span style="color: #993333; font-weight: bold;">AS</span> p <span style="color: #993333; font-weight: bold;">ON</span> p<span style="color: #66cc66;">.</span>BusinessEntityID <span style="color: #66cc66;">=</span> e<span style="color: #66cc66;">.</span>BusinessEntityID
</pre>

  <ol>
    <li>Klicken Sie auf die Schaltfläche <b>Ergebnisdaten in Vorschau zeigen</b> <a class="image"><img alt="SQL editor preview.png" src="../images/How_to_set_up_the_SQL/SQL_editor_preview.png" width="25"></a>, um die Daten in der Vorschau zu sehen. Wenn die Vorschau gut aussieht, klicken Sie auf die Schaltfläche <b>Daten in Arbeitsblatt importieren</b> <a class="image"><img alt="Button db Import Data.png" src="../images/How_to_set_up_the_SQL/Button_db_Import_Data.png" width="25"></a>, um diese Daten zu importieren. Die Ergebnisse sollten folgendermaßen aussehen:

      <dl>
        <dd><a class="image"><img alt="SQL odbc8.png" src="../images/How_to_set_up_the_SQL/SQL_odbc8.png" width="481"></a></dd>
      </dl>
    </li>
  </ol>
