<h1 class="firstHeading">FAQ-1078 How do I write code for use interchangeably with embedded and external Python?</h1>

  <p class='urlname' style='display: none'>Dual-purpose-code-embedded-external-python</p>

  <p class='faqID'>Last Update: 12/22/2020</p>

  <p>The originpro Python package works almost exactly the same for the Python interpreter embedded into Origin and a Python interpreter accessing Origin externally. This means that you could write a <b>portable script</b> that works for both types of interpreter.</p>

  <p>However, there are two small additions that need to be made to such a script. Those additions are illustrated in the code below. They both target originpro only when run from an external Python interpreter.</p>

  <p>The first addition sets the visibility of the instance of Origin that launches, while the second shuts down the running instance of Origin. Simply wrap your originpro code in these two code blocks and your script can become portable between interpreters.</p>
  <pre class="python" style="font-family:monospace;">
<span style="color: #ff7700;font-weight:bold;">import</span> originpro <span style="color: #ff7700;font-weight:bold;">as</span> op

<span style="color: #d00; font-style: italic;"># Set Origin instance visibility.</span>
<span style="color: #d00; font-style: italic;"># Important for only external Python.</span>
<span style="color: #d00; font-style: italic;"># Should not be used with embedded Python. </span>
<span style="color: #ff7700;font-weight:bold;">if</span> op.<span style="color: #000;">oext</span>:
    op.<span style="color: #000;">set_show</span><span style="color: #000;">(</span><span style="color: #900090;">True</span><span style="color: #000;">)</span>


<span style="color: #d00; font-style: italic;"># Your originpro-based Python code goes here.</span>


<span style="color: #d00; font-style: italic;"># Exit running instance of Origin.</span>
<span style="color: #d00; font-style: italic;"># Required for external Python but don't use with embedded Python.</span>
<span style="color: #ff7700;font-weight:bold;">if</span> op.<span style="color: #000;">oext</span>:
    op.<span style="color: #000;">exit</span><span style="color: #000;">(</span><span style="color: #000;">)</span>
</pre>
  <hr class='keywordshr'>

  <p><span class='keywords'>Keywords:</span><span class='keywordsInput'>Python, originpro, embedded, external, interpreter, portable, dual</span></p>
