<h1 class="firstHeading">FAQ-942 Origin Slows Down or Uses An Excessive Amount of Memory When Importing via Origin C or LabTalk</h1>

  <p class='urlname' style='display: none'>Origin-slow-when-importing-by-OC-or-LT</p>

  <p class='faqID'>Last Update: 6/7/2018</p>

  <p>If you have written Origin C or LabTalk code to import multiple files in a loop and are experiencing a dramatic slowdown or dramatically increased memory usage, it is most likely related to the mechanism Origin uses to enable Undo of importing.</p>

  <p>To remedy these issues, you can temporarily turn off Undo support by setting the @UN system variable to 0 before importing and restore it afterwards.</p>

  <p>To do it in Origin C, use code similar to this example function:</p>
  <pre class="lt" style="font-family:monospace;">
void DoImport<span style="color: #000000;">(</span><span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
    <span style="color: #008000;">// This class sets a system variable to a new value</span>
    <span style="color: #008000;">// while storing the old value.</span>
    <span style="color: #008000;">// When the instance of the class goes out of scope,</span>
    <span style="color: #008000;">// the instance is destroyed and the system variable</span>
    <span style="color: #008000;">// restored to it's previous value.</span>
 
   LTVarTempChange junk<span style="color: #000000;">(</span><span style="color: #ff00ff;">"@UN"</span>, <span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>;

   <span style="color: #008000;">// Perform all importing in same scope as above class instance until done.</span>
<span style="color: #000000;">}</span>
</pre>

  <p>To do it in LabTalk:</p>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">// Save current value of @UN.</span>
int nOld <span style="color: #000080;">=</span> @UN;

<span style="color: #008000;">// Turn off Undo.</span>
@UN <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;

<span style="color: #008000;">// Perform all importing until done.</span>

<span style="color: #008000;">// Finally restore previous value of @UN.</span>
@UN <span style="color: #000080;">=</span> nOld;
</pre>

  <p> </p>
  <hr class='keywordshr'>

  <p><span class='keywords'>Keywords:</span><span class='keywordsInput'>LabTalk,Origin C,import,multiple,many,files,loop,speed,slow,memory</span></p>
