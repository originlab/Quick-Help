<h1 class="firstHeading">FAQ-810 Wie erstelle ich ein Wasserfalldiagramm mit Origin C?</h1>

  <p class='urlname' style='display: none'>waterfall-by-OC</p>

  <p class='faqID'>Letztes Update: 04.01.2016</p>

  <p>Bitte verwenden Sie den folgenden Beispielcode:</p>
  <pre class="oc" style="font-family:monospace;">
<span style="color: #008000;">//The function below is to plot a waterfall</span> <span style="color: #008000;">//When bYColMap = TRUE, it will plot a waterfall color map to Y. </span> <span style="color: #008000;">// When bYColMap = FALSE, it will plot a waterfall color map to Z. </span> <span style="color: #0000ff;">void</span> plot_waterfall<span style="color: #000000;">(</span><span style="color: #0000ff;">BOOL</span> bYColMap <span style="color: #000080;">=</span> <span style="color: #0000ff;">TRUE</span>, <span style="color: #0000ff;">int</span> nEndYCol <span style="color: #000080;">=</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span> <span style="color: #000000;">{</span> Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #000040;">!</span>wks <span style="color: #000000;">)</span> <span style="color: #0000ff;">return</span>; <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> nEndYCol <span style="color: #000080;">&lt;</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">)</span> <span style="color: #008000;">// -1 means to the end column</span> nEndYCol <span style="color: #000080;">=</span> wks.<span style="color: #000000;">GetNumCols</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span> <span style="color: #000040;">-</span> <span style="color: #0000dd;">1</span>; <span style="color: #008000;">// create a graph window</span> GraphPage gp; gp.<span style="color: #000000;">Create</span><span style="color: #000000;">(</span><span style="color: #ff00ff;">"Waterfal"</span><span style="color: #000000;">)</span>; GraphLayer gl <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// get the first layer      </span> <span style="color: #008000;">// prepare DataRange</span> DataRange dr; dr.<span style="color: #000000;">Add</span><span style="color: #000000;">(</span>wks, <span style="color: #0000dd;">0</span>, <span style="color: #ff00ff;">"X"</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// col(1): x column       </span> <span style="color: #0000ff;">for</span><span style="color: #000000;">(</span><span style="color: #0000ff;">int</span> nYCol <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; nYCol <span style="color: #000080;">&lt;=</span> nEndYCol; nYCol<span style="color: #000040;">++</span><span style="color: #000000;">)</span> dr.<span style="color: #000000;">Add</span><span style="color: #000000;">(</span>wks, nYCol, <span style="color: #ff00ff;">"Y"</span><span style="color: #000000;">)</span>; <span style="color: #008000;">// add y columns into dr DataRange               </span> <span style="color: #008000;">// do plot</span> gl.<span style="color: #000000;">AddPlot</span><span style="color: #000000;">(</span>dr, IDM_PLOT_LINE<span style="color: #000000;">)</span>; <span style="color: #008000;">// set colormap     </span> GroupPlot group; group <span style="color: #000080;">=</span> gl.<span style="color: #000000;">Groups</span><span style="color: #000000;">(</span><span style="color: #0000dd;">0</span><span style="color: #000000;">)</span>; <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> group <span style="color: #000000;">)</span> <span style="color: #000000;">{</span> Tree tr; tr.<span style="color: #000000;">Line</span>.<span style="color: #000000;">Color</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> bYColMap? 0x60FFFF <span style="color: #000000;">:</span> 0x500000 <span style="color: #000040;">|</span> <span style="color: #000000;">(</span> ModifyColBeg <span style="color: #000040;">+</span> <span style="color: #0000dd;">1</span> <span style="color: #000000;">)</span>; <span style="color: #0000ff;">if</span><span style="color: #000000;">(</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> group.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">(</span>tr<span style="color: #000000;">)</span> <span style="color: #000000;">)</span> group.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">(</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">)</span>; <span style="color: #000000;">}</span> gl.<span style="color: #000000;">Rescale</span><span style="color: #000000;">(</span><span style="color: #000000;">)</span>; <span style="color: #000000;">}</span>
</pre>

  <p> </p>
  <hr class='keywordshr'>

  <p><span class='keywords'>Schlüsselwörter:</span><span class='keywordsInput'>Wasserfall, Origin C</span></p>
