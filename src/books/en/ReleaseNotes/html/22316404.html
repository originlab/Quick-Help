<link rel="stylesheet" href="//d2mvzyuse3lwjc.cloudfront.net/global/confWiki.css?t=201612160906" />
<div id="page">
    <div id="main" class="aui-page-panel">
        <div id="main-header">
            <h1 id="title-heading" class="pagetitle">
                <span id="title-text">
                    Origin C Improvements
                </span>
            </h1>
        </div>
        <div id="content" class="view">
            <div id="main-content" class="wiki-content group">
                <p></p><div class="toc-macro client-side-toc-macro  conf-macro output-block"> <ul class="toc-indentation"><li><a href="#OriginCImprovements-CodeBuilder">Code Builder</a><ul class="toc-indentation"><li><a href="#OriginCImprovements-ImproveTreeNodedisplayinCodeBuilderVariablewindow(ORG-8689)">Improve TreeNode display in Code Builder Variable window (ORG-8689)</a></li><li><a href="#OriginCImprovements-ChangehotkeyinCodeBuilder,Ctrl+Shift+Fforfindinfiles,andCtrl+Shift+Cforcopyfullpath(ORG-7919)">Change hot key in Code Builder, Ctrl+Shift+F for find in files, and Ctrl+Shift+C for copy full path (ORG-7919)</a></li></ul></li><li><a href="#OriginCImprovements-OriginC">Origin C</a><ul class="toc-indentation"><li><a href="#OriginCImprovements-AddmorePageandLayerclassesLabTalkevaluationfunctions(ORG-8470)">Add more Page and Layer classes LabTalk evaluation functions (ORG-8470)</a></li><li><a href="#OriginCImprovements-OCvector::SetSubVectorsupportscopybycountingelements(ORG-8024)">OC vector::SetSubVector supports copy by counting elements (ORG-8024)</a></li><li><a href="#OriginCImprovements-ExposeColumnmethodGetAdditionalInfotoOCforgettingadditionaltext(ORG-9101)">Expose Column method GetAdditionalInfo to OC for getting additional text (ORG-9101)</a></li><li><a href="#OriginCImprovements-ImprovespeedofOCcompiler(ORG-8697)">Improve speed of OC compiler (ORG-8697)</a></li></ul></li></ul></div><h2 id="OriginCImprovements-CodeBuilder">Code Builder</h2><h3 id="OriginCImprovements-ImproveTreeNodedisplayinCodeBuilderVariablewindow(ORG-8689)">Improve TreeNode display in Code Builder Variable window (<a class="external-link" href="https://originlab.jira.com/browse/ORG-8689" title="Improve TreeNode display in Code Builder Variable window" rel="nofollow">ORG-8689</a><a class="external-link" href="https://originlab.jira.com/browse/ORG-8689" title="Improve TreeNode display in Code Builder Variable window" rel="nofollow">)</a></h3><p>Run</p><div class="code panel pdl conf-macro output-block" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre">void test_treenode()
{
	Tree tr;
	tr.a.nVal = 10;
	tr.b.strVal = &quot;Fol&quot;;
	
	vector&lt;int&gt; vn = {1,2};
	tr.c.nVals = vn;
	vector&lt;string&gt; vs = {&quot;a&quot;,&quot;b&quot;};
	tr.d.strVals = vs;
	
	tr.e.a.strVals = vs;
	
	TreeNode trA = tr.a;	
	TreeNode trB = tr.b;	
	TreeNode trC = tr.c;
	TreeNode trD = tr.d;
	TreeNode trE = tr.e;
}</pre>
</div></div><p>And get:</p><p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="../images/attachments/22316404/att22577169.png" /></span></p><p> </p><h3 id="OriginCImprovements-ChangehotkeyinCodeBuilder,Ctrl+Shift+Fforfindinfiles,andCtrl+Shift+Cforcopyfullpath(ORG-7919)">Change hot key in Code Builder, Ctrl+Shift+F for find in files, and Ctrl+Shift+C for copy full path (<a class="external-link" href="https://originlab.jira.com/browse/ORG-7919" title="Hot key in Code Builder" rel="nofollow">ORG-7919</a><a class="external-link" href="https://originlab.jira.com/browse/ORG-7919" title="Hot key in Code Builder" rel="nofollow">)</a></h3><h2 id="OriginCImprovements-OriginC">Origin C</h2><h3 id="OriginCImprovements-AddmorePageandLayerclassesLabTalkevaluationfunctions(ORG-8470)">Add more Page and Layer classes LabTalk evaluation functions (<a class="external-link" href="https://originlab.jira.com/browse/ORG-8470" title="more Page&amp;Layer labtalk evaluation functions needed" rel="nofollow">ORG-8470</a><a class="external-link" href="https://originlab.jira.com/browse/ORG-8470" title="more Page&amp;Layer labtalk evaluation functions needed" rel="nofollow">)</a></h3><div class="code panel pdl conf-macro output-block" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre">BOOL LT_evaluate(LPCSTR lpcszLabTalkExpression, double * lpdbResult);
BOOL LT_get_var(LPCSTR lpcszLabTalkVarName, double * lpdbResult);
BOOL LT_set_var(LPCSTR lpcszLabTalkVarName, double dbValue);
BOOL LT_get_str(LPCSTR lpcszLabTalkString, char* pBuffer, int nBufferSize);
BOOL LT_set_str(LPCSTR lpcszVar, LPCSTR lpcszContent);</pre>
</div></div><p> </p><h3 id="OriginCImprovements-OCvector::SetSubVectorsupportscopybycountingelements(ORG-8024)">OC vector::SetSubVector supports copy by counting elements (<a class="external-link" href="https://originlab.jira.com/browse/ORG-8024" title="OC vector::SetSubVector support counting elements to copy" rel="nofollow">ORG-8024</a><a class="external-link" href="https://originlab.jira.com/browse/ORG-8024" title="OC vector::SetSubVector support counting elements to copy" rel="nofollow">)</a></h3><div class="code panel pdl conf-macro output-block" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre">int vectorbase::SetSubVector(vectorbase&amp; vbSource, int c1 = 0, int nCount = -1);
int vector&lt;string&gt;::SetSubVector(vectorbase&amp; vbSource, int c1 = 0, int nCount = -1);</pre>
</div></div><p> </p><h3 id="OriginCImprovements-ExposeColumnmethodGetAdditionalInfotoOCforgettingadditionaltext(ORG-9101)">Expose Column method GetAdditionalInfo to OC for getting additional text (<a class="external-link" href="https://originlab.jira.com/browse/ORG-9101" title="Need OC method to read SPC additional text" rel="nofollow">ORG-9101</a><a class="external-link" href="https://originlab.jira.com/browse/ORG-9101" title="Need OC method to read SPC additional text" rel="nofollow">)</a></h3><div class="code panel pdl conf-macro output-block" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre">void test_GetAdditionalInfo()
{
	Worksheet wks = Project.ActiveLayer();
	Column col(wks, 0);
	string strTextInfo;
	col.GetAdditionalInfo(strTextInfo);
	out_str(strTextInfo);
}</pre>
</div></div><h3 id="OriginCImprovements-ImprovespeedofOCcompiler(ORG-8697)">Improve speed of OC compiler (<a class="external-link" href="https://originlab.jira.com/browse/ORG-8697" title="OC compiler speed improvement" rel="nofollow">ORG-8697</a><a class="external-link" href="https://originlab.jira.com/browse/ORG-8697" title="OC compiler speed improvement" rel="nofollow">)</a></h3><p> </p>
            </div>
        </div>
    </div>
</div>
