<link rel="stylesheet" href="//d2mvzyuse3lwjc.cloudfront.net/global/confWiki.css?t=201612160906" />
<div id="page">
    <div id="main" class="aui-page-panel">
        <div id="main-header">
            <h1 id="title-heading" class="pagetitle">
                <span id="title-text">
                    Origin 2017 Support communicate with individual instance of Mathematica
                </span>
            </h1>
        </div>
        <div id="content" class="view">
            <div id="main-content" class="wiki-content group">
                <p>

    

            



    <span class="confluence-jim-macro jira-issue conf-macro output-block">
                <a href="https://originlab.jira.com/browse/ORG-2968" class="jira-issue-key"><span class="aui-icon aui-icon-wait issue-placeholder"> </span>ORG-2968</a>
                    -
            <span class="summary">Getting issue details...</span>
                                    <span class="aui-lozenge aui-lozenge-subtle aui-lozenge-default issue-placeholder">STATUS</span>
            </span>
</p><p>To communicate with 64-bit MathKernel.exe, Origin 2017 Beta1 updated Sequencer.exe and renamed it to O<span>Sequencer.exe</span>. Origin 2017 is therefore able to communicate with individual instance of Mathematica.</p><h2 id="Origin2017SupportcommunicatewithindividualinstanceofMathematica-ProcedureofUsingMathematicaLink">Procedure of Using Mathematica Link</h2><h4 id="Origin2017SupportcommunicatewithindividualinstanceofMathematica-LaunchingtheMathematicaLinkTool"><span style="color: rgb(0,0,255);">Launching the Mathematica Link Tool</span></h4><p>Before launching the tool, you will need to set up the Kernel configuration in Mathematica to link to Origin's kernel OSequencer.exe</p><blockquote><p><span style="color: rgb(255,0,0);"><strong>Note</strong></span>: <span style="color: rgb(0,0,0);">If you installed Mathematica in the system disk, e.g. <em>C:\Program Files\Wolfram Research\Mathematica\</em>, before doing the following steps, you will need to copy &amp; paste OSequencer.exe to Mathematica's installation folder manually.</span></p></blockquote><ol><li>Start Mathematica, select <strong>Evaluate: Kernel Configuration Options</strong> from Mathematica main menu to open a dialog.</li><li>Click <strong>Add</strong> button to bring up the <strong>Kernel Properties</strong> dialog.</li><li>Set Arguments to MLOpen as <em>-LinkName &quot;OSequencer -mathlink -noicon&quot;</em>.<br /><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="250" src="../images/attachments/110100483/att110100485.png" /></span><br />The kernel named &quot;OSequncer&quot; is added to the list.</li></ol><p>You can then launch the Mathematica Link tool in Origin.</p><ol><li>Select from Origin main menu <strong>Tools: Mathematica Link</strong>, Origin will ask for Mathematica's Kernel for the first time. </li><li>Locate the exe folder of Mathematica, and then select MathKernel.exe.</li><li>The <strong>Origin Link for Mathematica</strong> dialog is then open.</li></ol><blockquote><p><span style="color: rgb(255,0,0);"><strong>Note</strong></span>: Y<span style="color: rgb(0,0,0);">ou can then go to User Files Folder and open the <em>OMAthLinkConfig.INI</em> file.</span></p><p>[MathKernelExecutable]<br />Location=C:\Program Files\Wolfram Research\Mathematica\11.0\MathKernel.exe</p><p><span style="color: rgb(0,0,0);">Check if the path points to the correct Mathematica installation folder to which you want Origin to communicate. It is especially important when you installed more than one version of Mathematica. If not, you can</span></p><ul><li><span style="color: rgb(0,0,0);">Change the path directly and re-save<em> ORIGINML.INI</em>. Then re-start Origin</span></li></ul><p><em><span style="color: rgb(0,0,0);">Or</span></em></p><ul><li><span style="color: rgb(0,0,0);">Delete <em>ORIGINML.INI</em> and then re-start Origin. Origin will ask for the Kernel again.</span></li></ul></blockquote><h4 id="Origin2017SupportcommunicatewithindividualinstanceofMathematica-ExchangeDatabetweenOriginandMathematica"><span style="color: rgb(0,0,255);">Exchange Data between Origin and Mathematica</span></h4><p>You can send and receive data between an Origin worksheet/Matrix book and Mathematica by using the <strong>Origin Link for Mathematica</strong> dialog.</p><ul><li>Go to <a rel="nofollow">Column tab</a> to send and receive worksheet data to and from Mathematica.</li><li>Go to <a rel="nofollow">Matrix tab</a> to send data and receive matrix data to and from Mathematica.</li><li>Go to <a rel="nofollow">Function tab</a> to create and plot Origin datasets using Mathematica functions.</li><li>Go to <a rel="nofollow">Evaluate tab</a> to evaluate any Mathematica expression that resolves to a scalar.</li></ul><h4 id="Origin2017SupportcommunicatewithindividualinstanceofMathematica-Examples"><span style="color: rgb(0,0,255);">Examples</span></h4><p>Before attempting the examples, please launch the <strong>Mathematica Link</strong> in Origin using the procedure in the previous section.</p><p><strong>Example 1</strong></p><ol><li>Open <em>&lt;exe folder&gt;/Samples/Matrix Conversion and Gridding/2D Gaussian.ogm</em>.</li><li>Go to the <strong>Origin Link for Mathematica</strong> dialog and activate the Matrix tab. In the Send Matrix group, set as below<br /><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="250" src="../images/attachments/110100483/att110100488.png" /></span><br />Click <strong>Send</strong> button</li><li>Go to Mathematica and execute the following script<br /><br />invmat = Inverse[mat] <br /><br /><br /></li><li>Go back to Origin. In the Matrix tab, set the Receive Matrix group as follow:<br /><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="250" src="../images/attachments/110100483/att110100490.png" /></span></li><li>Click <strong>Receive</strong> button, you will get the inverse of the original matrix to replace the original one.</li></ol><p><strong>Example 2</strong></p><ol><li>Open Mathematica if not already started.,Create a new notebook. Select menu  menu <strong>Evaluation: Notebook's Kernel</strong>, make sure the kernel &quot;OSequencer&quot; is selected.. Now the current notebook of Mathematica can communicate with Origin.</li><li>Define a function as follow: <br />f1[x_] := (FresnelS[x] + 1/2)^2 + (FresnelC[x] + 1/2)</li><li><p>Go back to Origin. In the Function tab of <strong>Origin Link for Mathematica</strong> dialog, type the following formula in<strong> f(x) =</strong> edit box:<br />f1[x^2+2]Then specify the curve range and number of data points<br /><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="250" src="../images/attachments/110100483/att111116295.png" /></span></p></li><li><p>Click <strong>Plot</strong> button. You will get a new graph.</p><p><br /></p></li></ol><p><br /></p>
            </div>
        </div>
    </div>
</div>
