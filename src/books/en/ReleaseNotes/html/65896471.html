<link rel="stylesheet" href="//d2mvzyuse3lwjc.cloudfront.net/global/confWiki.css?t=201612160906" />
<div id="page">
    <div id="main" class="aui-page-panel">
        <div id="main-header">
            <h1 id="title-heading" class="pagetitle">
                <span id="title-text">
                    Batch Process improvements
                </span>
            </h1>
        </div>
        <div id="content" class="view">
            <div id="main-content" class="wiki-content group">
                <div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="confluenceTh"><span>Support Before Script in Batch Processing</span></th></tr><tr><td class="confluenceTd"><p><a class="external-link" href="https://originlab.jira.com/browse/ORG-8482" rel="nofollow">ORG-8482</a></p></td></tr><tr><td class="confluenceTd"><p>In the <strong>Batch Processing</strong> or <strong>Batch Peak Analysis Using Theme</strong> dialog, we can run labtalk script before running the analysis.</p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-external-resource" width="600" src="https://d2mvzyuse3lwjc.cloudfront.net/ftp/ConfWikiLinks/WikiImg6/93_batch_processing_script_before.png" /></span></p><h2 id="BatchProcessimprovements-Howto...">How to...</h2><p>Example 1: Data selection before running batch peak searching.</p><ol><li>In this case, we want to do peak search only on spectrum of column B,C,D,E and ignore noise column F1, G1.</li></ol><p> </p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-external-resource" width="600" src="https://d2mvzyuse3lwjc.cloudfront.net/ftp/ConfWikiLinks/WikiImg6/93_batch_processing_script_before_worksheet.png" /></span></p><p> </p><p>2. Highlight the whole worksheet and go to<strong> Analysis:Peaks And Baseline:Batch Peak Analysis Using Theme dialog. </strong>Input Labtalk script to skip the columns with noise (Maximum column value is less than 100 ).<strong> </strong></p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-external-resource" width="800" src="https://d2mvzyuse3lwjc.cloudfront.net/ftp/ConfWikiLinks/WikiImg6/93_batch_processing_script_before_dialog.png" /></span></p><p>3. In the result sheet, Data of B,C,D,E columns are analyzed.</p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-external-resource" width="500" src="https://d2mvzyuse3lwjc.cloudfront.net/ftp/ConfWikiLinks/WikiImg6/93_batch_processing_script_before_worksheet_after.png" /></span></p><p> </p><p> </p><p>Example 2: Data filtering before batch processing.</p><ol><li>If want to do batch processing with the following template where column B is filtered before doing linear regression.</li></ol><p> </p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-external-resource" width="400" src="https://d2mvzyuse3lwjc.cloudfront.net/ftp/ConfWikiLinks/WikiImg6/93_batch_processing_script_before_example1.png" /></span></p><p>2. In the <strong>Batch Processing</strong> dialog, we input the following script to activate the filter of each imported data.</p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-external-resource" width="600" src="https://d2mvzyuse3lwjc.cloudfront.net/ftp/ConfWikiLinks/WikiImg6/93_batch_processing_script_before_example2.png" /></span></p><p> </p><p>3. In the result sheets, the filter in each dataset is activated before analysis.</p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-external-resource" width="800" src="https://d2mvzyuse3lwjc.cloudfront.net/ftp/ConfWikiLinks/WikiImg6/93_batch_processing_script_before_example3.png" /></span></p><p> </p><p> </p><p> </p></td></tr><tr><th colspan="1" class="confluenceTh"><span style="color: rgb(0,0,0);">Support </span><span style="color: rgb(0,0,0);"> append results by columns</span></th></tr><tr><td colspan="1" class="confluenceTd"><p><a class="external-link" href="https://originlab.jira.com/browse/ORG-6141" rel="nofollow">ORG-6141</a></p></td></tr><tr><td colspan="1" class="confluenceTd"><p><span>Analysis result can be appended vertically in the report sheet.</span></p><p><span><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-external-resource" width="600" src="https://d2mvzyuse3lwjc.cloudfront.net/ftp/ConfWikiLinks/WikiImg6/93_batch_processing_append_by_columns.png" /></span></span></p></td></tr><tr><th colspan="1" class="confluenceTh"><span>Batch Processing with Analysis Template Support Import Multiple Files into Sequential Worksheets</span></th></tr><tr><td colspan="1" class="confluenceTd"><p><a class="external-link" href="https://originlab.jira.com/browse/ORG-12759" rel="nofollow">ORG-12759</a></p></td></tr><tr><td colspan="1" class="confluenceTd"><p>When the analysis template has multiple sheets as input for analysis, we can now insert multiple data files into individual worksheets in batch processing:</p><h2 id="BatchProcessimprovements-Howto....1">How to...</h2><ol><li>In batch processing dialog, when the datasheet(s) is set to auto, Origin will detect the number of input worksheets in the template. (The blue hint lines shows the detected worksheets)</li><li>The import file numbers should be multiple of worksheet number. Then each file will be imported into individual worksheet for later analysis.</li></ol><p> </p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-external-resource" width="800" src="https://d2mvzyuse3lwjc.cloudfront.net/ftp/ConfWikiLinks/WikiImg6/93_batch_processing_import_multiple_files_into_sequential_worksheet.png" /></span></p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-external-resource" width="600" src="https://d2mvzyuse3lwjc.cloudfront.net/ftp/ConfWikiLinks/WikiImg6/93_batch_processing_import_multiple_files_into_sequential_worksheet1.png" /></span></p><p> </p><p> </p><p> </p><p> </p><p> </p></td></tr><tr><th class="confluenceTh">Allow using X Data Info. as Dataset Identifier in Batch Processing</th></tr><tr><td colspan="1" class="confluenceTd"><a href="https://originlab.jira.com/browse/ORG-13400" class="external-link" rel="nofollow">ORG-13400</a></td></tr><tr><td colspan="1" class="confluenceTd"><p>Sometimes data information is in X data column instead of Y. In Batch Processing dialog (including Batch Peak Analysis using Theme dialog), user can set Dataset Identifier from X columns.</p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-external-resource" width="600" src="https://d2mvzyuse3lwjc.cloudfront.net/ftp/ConfWikiLinks/WikiImg8/93_batch_process_dataset_identifier_X.png" /></span></p><p> </p></td></tr></tbody></table></div><p> </p><div><span style="font-size: 24.0px;line-height: 30.0px;"><br /></span></div>
            </div>
        </div>
    </div>
</div>
