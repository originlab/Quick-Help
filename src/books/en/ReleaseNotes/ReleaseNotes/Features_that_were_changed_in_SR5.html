<h1 class="firstHeading">Features that were changed in SR5</h1><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Top_10_Reasons_to_Patch_to_SR5"><span class="tocnumber">1</span> <span class="toctext">Top 10 Reasons to Patch to SR5</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Installation"><span class="tocnumber">2</span> <span class="toctext">Installation</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Graphing"><span class="tocnumber">3</span> <span class="toctext">Graphing</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Customization"><span class="tocnumber">3.1</span> <span class="toctext">Customization</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Plotting"><span class="tocnumber">3.2</span> <span class="toctext">Plotting</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Plot_Setup_Improvements"><span class="tocnumber">3.3</span> <span class="toctext">Plot Setup Improvements</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Layer_Management_Improvements"><span class="tocnumber">3.4</span> <span class="toctext">Layer Management Improvements</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Merge_Graph_dialog_Improvements"><span class="tocnumber">3.5</span> <span class="toctext">Merge Graph dialog Improvements</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Save_Template_As_Improvements"><span class="tocnumber">3.6</span> <span class="toctext">Save Template As Improvements</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Data_Manipulation_in_Graph"><span class="tocnumber">3.7</span> <span class="toctext">Data Manipulation in Graph</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Miscellaneous"><span class="tocnumber">3.8</span> <span class="toctext">Miscellaneous</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-12"><a href="#Externally_Linked_Excel_Book_.28Open_Excel.29"><span class="tocnumber">4</span> <span class="toctext">Externally Linked Excel Book (Open Excel)</span></a></li>
<li class="toclevel-1 tocsection-13"><a href="#Import_and_Export"><span class="tocnumber">5</span> <span class="toctext">Import and Export</span></a></li>
<li class="toclevel-1 tocsection-14"><a href="#Analysis"><span class="tocnumber">6</span> <span class="toctext">Analysis</span></a>
<ul>
<li class="toclevel-2 tocsection-15"><a href="#General"><span class="tocnumber">6.1</span> <span class="toctext">General</span></a>
<ul>
<li class="toclevel-3 tocsection-16"><a href="#Dialog_Theme"><span class="tocnumber">6.1.1</span> <span class="toctext">Dialog Theme</span></a></li>
<li class="toclevel-3 tocsection-17"><a href="#Inside_Dialogs"><span class="tocnumber">6.1.2</span> <span class="toctext">Inside Dialogs</span></a></li>
<li class="toclevel-3 tocsection-18"><a href="#Output"><span class="tocnumber">6.1.3</span> <span class="toctext">Output</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-19"><a href="#Mathematics"><span class="tocnumber">6.2</span> <span class="toctext">Mathematics</span></a></li>
<li class="toclevel-2 tocsection-20"><a href="#Data_Exploration"><span class="tocnumber">6.3</span> <span class="toctext">Data Exploration</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="#Data_Manipulation"><span class="tocnumber">6.4</span> <span class="toctext">Data Manipulation</span></a></li>
<li class="toclevel-2 tocsection-22"><a href="#Fitting"><span class="tocnumber">6.5</span> <span class="toctext">Fitting</span></a></li>
<li class="toclevel-2 tocsection-23"><a href="#Signal_Processing"><span class="tocnumber">6.6</span> <span class="toctext">Signal Processing</span></a></li>
<li class="toclevel-2 tocsection-24"><a href="#Peaks_and_Baseline"><span class="tocnumber">6.7</span> <span class="toctext">Peaks and Baseline</span></a></li>
<li class="toclevel-2 tocsection-25"><a href="#Statistics"><span class="tocnumber">6.8</span> <span class="toctext">Statistics</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-26"><a href="#Worksheet"><span class="tocnumber">7</span> <span class="toctext">Worksheet</span></a></li>
<li class="toclevel-1 tocsection-27"><a href="#Miscellaneous_2"><span class="tocnumber">8</span> <span class="toctext">Miscellaneous</span></a></li>
<li class="toclevel-1 tocsection-28"><a href="#LabTalk"><span class="tocnumber">9</span> <span class="toctext">LabTalk</span></a></li>
<li class="toclevel-1 tocsection-29"><a href="#OriginC"><span class="tocnumber">10</span> <span class="toctext">OriginC</span></a></li>
</ul>
</div>

<h2><a name="Top_10_Reasons_to_Patch_to_SR5"></a><span class="mw-headline">Top 10 Reasons to Patch to SR5</span></h2>
<ol><li> New set of functions added to <b>F(x)</b> menu of <b>Set Column Values</b> and <b>Extract Worksheet</b> dialogs</li>
<li> Improvements to linking <b>OPJ</b> with external <b>Excel</b> files</li>
<li> Improvements to speed of <b>importing Excel</b> files and <b>copy-pasting</b> data into Origin</li>
<li> Enhanced GUI controls for <b>vertical and horizontal translation</b> of data plots in graphs</li>
<li> Multiple improvements to <b>Plot Setup</b>, <b>Layer Management</b>, and <b>Merge Graph</b> dialogs</li>
<li> New <b>Quick Curve Integration</b> tool for exploratory integration of plots </li>
<li> Improvements to Math tools such as <b>Average Curves</b> and <b>Differentiate</b></li>
<li> <b>Parameters</b> and <b>Bounds</b> tab for <b>Nonlinear Curve Fitter</b> and <b>Peak Analyzer</b> can be configured by user, and support sorting and reordering of parameters</li>
<li> Multiple improvements to <b>Peak Analyzer</b>, including support for <b>Recalculation</b> of results</li>
<li> Faster fitting of <b>Matrix</b> or <b>XYZ</b> data using <b>2D Fitting</b> functions</li></ol>
<h2><a name="Installation"></a><span class="mw-headline">Installation</span></h2>
<ol><li> New Program Shortcuts: After User Files Folder is chosen, two new folder shortcuts: <b>Origin Folder</b> and <b>Origin Samples Folder</b> are created in the User Files Folder (UFF) location. This allows user to easily navigate to the EXE path when viewing the UFF folder in file dialogs.</li></ol>
<h2><a name="Graphing"></a><span class="mw-headline">Graphing</span></h2>
<h3><a name="Customization"></a><span class="mw-headline">Customization</span></h3>
<ol><li> <b>Drawing bars that span layer:</b> On the <b>Line</b> tab of <b>Plot Details</b>, there is a <b>Fill Area under Curve</b>  check box. The drop-down associated with this check box has a <b>Span vertically broken by missing value</b> option which now allows any Y value to fill entire layer. One can then use a dataset to fill layer vertically. Missing values in the dataset can be used to create a break in the X direction. The data used for this purpose should be the first entry in the layer, or in the first layer in a multi-layer graph, for this to be effective. This technique is useful to create/indicate <a class="external text" href="http://wiki.originlab.com/~originla/wiki/index.php?title=Chart_with_Vertical_Bars" target="_blank">Recession bars in Economic Time series plots</a>.</li>
<li> Added <b>Auto Rescale Y Axis</b> to context menu of X Axis Scrollbar (Top or Bottom). Shown when right clicking Top or Bottom Scrollbar in Graph. Check it to auto rescale Y Axis as X Axis changes.</li>
<li> <b>Axis</b> dialog: <b>Tick Labels</b> tab:<b>Tick-indexed string</b> type: allows to use user-defined strings as tick labels.</li>
<li>Simpler grammar for custom legend. ID = 13121
<ol><li>\l(L color,thickness,dash)</li></ol></li>
<li>In Plot Details dialog, under Legend/Titles tab, the <b>Indicate Active DataSet</b> is unchecked by default so that clicking the legend does not change the active curve/dataset. ID=13344.</li>
<li>Copy and paste format will include status of layer frame show/hide. ID = 13417</li>
<li> When selecting a <b>Incremental Color list</b> on Style toolbar, the color list name shows on status toolbar.</li></ol>
<h3><a name="Plotting"></a><span class="mw-headline">Plotting</span></h3>
<ol><li> <b>plotgroup</b> X-Function&#160;: Added <b>Plot Type</b> and <b>Sort Worksheet by Groups Data</b> options. Typically, you should choose to sort. This X-Function has no menu option and can be called from script with <i>plotgroup -d;</i></li>
<li> <b>Template Library</b> button is enabled for Matrix window and is an added option under <b>Plot</b> menu.</li>
<li> Long names &amp; Comments in worksheet are used as axis titles in <b>3D</b> graphs.</li>
<li> Built-in <b>3D</b> graphs will be not affected by system theme by default.</li>
<li> Drag and drop YError, Labels column into Graph window.</li>
<li> <b>New graph template</b> added:
<ul><li> <b>Wind Rose plot</b></li>
<li> <b>Scatter with central XY axes</b></li>
<li> <b>Multi- Y Axes Plot</b> (3Y, 4Y)</li></ul></li>
<li> LT command <b>layer -il&#160;%C</b> is supported to add dataset as label in graph. Other options are 
<ul><li> -ilx (add X value of the data as label)</li>
<li> -ily (add Y value of the data as label)</li>
<li> -ilr (add row index of the data as label)</li>
<li> -ilxy (add X and Y values of the data as label)</li></ul></li></ol>
<ul><li> A "Scan User Template" button is added into Template Library to scan template files in User Files Folder, ID=13299</li></ul>
<h3><a name="Plot_Setup_Improvements"></a><span class="mw-headline">Plot Setup Improvements</span></h3>
<ol><li> Changed the previously combined Add/Replace button to two separate buttons.</li>
<li> Select Excel book on top panel will automatically update column information to Origin. User doesn't need to choose Update Origin in Excel first and then use Plot Setup to plot Excel data.</li>
<li> <b>Allow Row# as X</b> context menu added in middle panel to control if showing row number o Auto(x) in middle panel or not.</li></ol>
<h3><a name="Layer_Management_Improvements"></a><span class="mw-headline">Layer Management Improvements</span></h3>
<ol><li> <b>Arrange</b> tab supports arranging and linking together.</li>
<li> Support for <b>Hide Overlapped Axes/Ticks</b> when <b>Vertical Gap</b> and/or <b>Horizontal Gap</b> is set to zero on <b>Arrange</b> tab.</li>
<li> <b>Size/Position</b> tab reorganized with clearer design.</li>
<li> Text hints for using the dialog are more specific for <b>Arrange</b> and <b>Size/Position</b> tabs.</li>
<li> <b>OK</b> button will not be enabled unless you have actually Applied changes</li>
<li> <b>Icons</b> of selected layers are highlighted in Preview.</li></ol>
<h3><a name="Merge_Graph_dialog_Improvements"></a><span class="mw-headline">Merge Graph dialog Improvements</span></h3>
<ol><li> Default Merge setting is <b>All in Active Folder (Open)</b>. This excludes all graphs that are hidden or minimized.</li>
<li> Support for linking all added graphs to Layer1 for sizing/positioning purposes.</li>
<li> Support for <b>Hide Overlapped Axes/Ticks</b> when <b>Vertical Gap</b> and/or <b>Horizontal Gap</b> is set to zero.</li></ol>
<h3><a name="Save_Template_As_Improvements"></a><span class="mw-headline">Save Template As Improvements</span></h3>
<ol><li> If user is saving a template that originated from the EXE path, a dialog is brought up to inform user and allow them to provide  new name for the template.</li>
<li> If the template originated from the EXE path, the <b>Apply System Theme upon Loading</b> check box is forced to be off. This then prevents the system theme from changing user's settings in the template.</li></ol>
<h3><a name="Data_Manipulation_in_Graph"></a><span class="mw-headline">Data Manipulation in Graph</span></h3>
<ol><li> Added <b>Remove</b> right-click context menu for data plot in graph. If you right click on a data plot and select this context menu, the data plot will be removed from the graph. The data itself will not be deleted.</li>
<li> <b>Data Selector</b> Improvements
<ul><li> The default <b>Data Selector</b> color is now red, and the begin and end selectors span the entire layer vertically</li>
<li> The markers are now placed on graph with a margin at the ends so they do not run into axes and is easier to grab and move them.</li>
<li> Shift/Ctrl + Arrow keys can be used to move by more than one data point at a time</li></ul></li>
<li>When using the keyboard Left/Right Arrows to move Data Markers the speedup by holding Shift key accelerates and new variables control behavior. ID = 13227
<ol><li>@DRI = 50; // step <b>I</b>ncrement for accelerating in&#160;% of previous step</li>
<li>@DRM = 10; // <b>M</b>aximum step in&#160;% of dataplot size</li>
<li>@DRT = 200; // <b>T</b>ime in msec after which data reader begins accelerating</li>
<li>@DRD = 10000;    // <b>D</b>ata points (used to make data reader acceleration independent of data plot)</li></ol></li></ol>
<h3><a name="Miscellaneous"></a><span class="mw-headline">Miscellaneous</span></h3>
<ol><li> Maximum number of layers allowed in one Graph is now 255. Before SR5, the maximum number was 121.</li></ol>
<h2><a name="Externally_Linked_Excel_Book_.28Open_Excel.29"></a><span class="mw-headline">Externally Linked Excel Book (Open Excel)</span></h2>
<ol><li> <b>Do not Automatically Update</b> is renamed to <b>Open as read-only</b>. The Excel book title will show <b>[Read Only]</b> to inform user that saving of Origin OPJ will not write to that external Excel file.</li>
<li> When <b>Open as read-only</b> is <b>not</b> checked, then Origin has exclusive access to the file and attempts to open it by Excel will be denied and indicate who has the file open.</li>
<li> Added <b>Relative to OPJ Path</b> support. You can now link Excel files relative to the OPJ path, which moves your Excel file to the same folder as your Project file. This allows you to keep both OPJ and Excel file in a folder and then copy that folder from one computer to another using a USB drive for example. The link destination will be maintained. You can even open and edit your Excel file in Microsoft Excel and then see the changes the next time you open Origin.</li></ol>
<h2><a name="Import_and_Export"></a><span class="mw-headline">Import and Export</span></h2>
<ol><li><b>&lt;sheet&gt; themes</b>:
<ul><li>In SR5, many import routines support "&lt;sheet&gt; themes". This means that you can save your import options in a workbook and save as a template. The import options saved in a workbook can be used for future importing when you use this workbook as the target window for importing files of the same file type. </li>
<li>&lt;sheet&gt; themes also affect drag-and-drop importing. In Origin, you can drag-and-drop files onto the Origin Workspace or onto a Workbook. If you drop dragged files onto a Workbook that has a &lt;sheet&gt; theme that matches the file type dropped, then Origin uses that theme and the appropriate import filter is employed to perform the import.</li>
<li>Currently, import routines that support saving &lt;sheet&gt; themes include ASCII (impASC), CSV (impCSV), Excel (impExcel), Sound (impWAV), NI DIAdem (impNIDIAdem), HEKA (impHEKA), pClamp (imppClamp), JCAMP-DX (impJCAMP), Thermo (impSPC), Princeton Instruments (impSPE), Data Translation (impDT), Famos (impFamos), ETAS INCA MDF (impMDF), EarthProbe (impEP) and KaleidaGraph (impKG). (ID=12422)</li></ul></li>
<li><b>Options added to pClamp Import</b>
<ul><li> 'Shift Time by Holding Period' check box added.</li>
<li> 'Add Time Column' check box added. When selecting this option, only one X column is created for all Y columns. This X column presents the time values for all ranges as the range for the first sweep/episode.</li></ul></li>
<li><b>File: Import: Binary 2D Array</b> ( impBin2d.oxf ) was added to improve import of large binary datasets which take too long in the Import Wizard. This menu option is available for both Workbooks and Matrices.</li>
<li>The <b>Graph Export</b> dialog now provides a ... button to browse and specify file name/path and check if a file name has existed in specified folder or not.</li>
<li>Change Custom Format design
<ul><li>Custom Date Format has been added to CSV and ASCII import dialog, so user can specify custom date format.</li>
<li>All Custom Date Formats a user added successfully will be saved to their ORIGIN.INI file for future use. They will appear at the beginning of the dropdown list.</li></ul></li>
<li>Excel import related
<ul><li>Drag and drop Excel file improvements
<ul><li>Check if drop target is empty wks, if Yes, then directly import without asking.</li>
<li>Otherwise, go to old code to ask.</li></ul></li>
<li>Speed improvement on importing Excel file or copying data from Excel.</li>
<li>Designation combo is editable to specify user-defined designations, and default is changed to &lt;unchanged&gt;.</li>
<li>Support LT accessible string variable to control sheet selection for import by number or name.</li></ul></li></ol>
<pre class="lt" style="font-family:monospace;">impExcel sheet<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span><span style="color: #000000;">:</span><span style="color: #0000dd;">5</span>;  <span style="color: #008000;">// Import the third sheet and the fifth sheet</span>
impExcel sheet<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;July:August:September:December&quot;</span>;   <span style="color: #008000;">// Import the named sheets</span></pre>
<h2><a name="Analysis"></a><span class="mw-headline">Analysis</span></h2>
<h3><a name="General"></a><span class="mw-headline">General</span></h3>
<h4><a name="Dialog_Theme"></a><span class="mw-headline">Dialog Theme</span></h4>
<ol><li> Drag and drop to install dialog theme file (*.ois). When some one shares an ois file with you, you can drag and drop it into Origin workspace to install it. It then becomes available in the theme fly-out menu of dialog that it pertains to. </li>
<li> Indication on Dialog Theme chang:. After loading a dialog theme in a dialog, if some settings have been changed, a <b>*</b> character will show next to theme name.</li></ol>
<h4><a name="Inside_Dialogs"></a><span class="mw-headline">Inside Dialogs</span></h4>
<ol><li> Easier way to select all grouped datasets in Graph to analyze/fit: When you plot multiple datasets, they are grouped by default. Clicking once on any of the data plots in the graph will select all of them. Then when you open any analysis/statisitcs dialog that supports multiple input, e.g. NLFit, Linear Fit, etc., all datasets in the group are used as Input Data. Before SR5, only the active dataset was used as the Input data. If you want to analyze/fit only one dataset in the group, you can click once to select the group, and click a second time to select a specific dataset and then bring up the dialog. Then only that particular dataset will be selected for Input Data in the dialog.</li>
<li> Added <b>Zoom</b> toolbar in <b>Smooth'</b>s preview graph. ID = 12403</li>
<li> <b>Data Selector Marker</b> has option to become larger. Clicking on the Marks, status bar show message "Use space bar to toggle data marker size". Hitting space bar, the size of data marker will change to full span of layer or to initial size. ID = 12571.</li>
<li>Remove &lt;optional&gt; from x-functions' output in the dialog, while &lt;optional&gt; is kept in LabTalk, such as spline or bspline. In GUI, a checkbox is replaced where &lt;optional&gt; used to be. When it is checked, the Output is set as &lt;new&gt;. ID=13262.</li>
<li> Add <b>Preview</b> to <b>Interpolate/Extrapolate</b>,<b>Trace Interpolation</b> and <b>Average Multiple Curves</b> under <b>Mathematics</b>, also to xf <b>wtsmooth</b> and <b>wtdenoise</b>. ID=13260.</li></ol>
<h4><a name="Output"></a><span class="mw-headline">Output</span></h4>
<ol><li> Column long names will have quote marks in report sheet table.</li>
<li> Deleting the Locked Output columns and rows are now supported. A dialog box opens asking for confirmation. If the selection is a row, then all source column cells are deleted and moved up, and other locked columns will be updated or will be in need of update if Recalculate was set to Manual. Prior to SR5, it was not possible to delete locked columns or rows containing locked column cells. </li>
<li> Undo after analysis should remove comments created by analysis. ID = 13194</li>
<li> Improvements on output column's Long name and comments.</li>
<li> Consistent switching to show output in analysis ID = 13279
<ol><li>If just recalculate, original data will be kept active</li>
<li>If new sheet will be generated, selection message will be dumped by operation based tool.</li></ol></li>
<li> Lock generated in Graph window is button-like. When browsing over it, the cursor will be changed into a hand cursor so it's clearer for user to know it's clickable.</li>
<li> More context menus when right clicking tables in report sheet</li></ol>
<h3><a name="Mathematics"></a><span class="mw-headline">Mathematics</span></h3>
<ol><li> <b>Average Multiple Curves</b>: Preview added and GUI is greatly changed to be more intuitive. Themes and scripts from previous versions might not work.</li>
<li> <b>Differentiate</b> tool: Add back smoothing option. It was missing in released 8.0 but existing in 7.5. (ID=12546)</li>
<li> <b>Integrate</b> tool: Straight line baseline that simply joins end points, is now supported. (ID = 12250)</li>
<li><b>Normalize</b> (ID = 12615)
<ul><li>Normalize context menu when right clicking a column opens vnormalize.</li>
<li>With workbook active, Analysis: Mathematics: Normalize opens vnormalize.</li>
<li>With Graph active, Analysis: Mathematics: Normalize opens normalize.</li></ul></li>
<li> <b>Interpolate</b> tools:  Add Auto checkbox for Number of Points box (ID = 13261).</li></ol>
<h3><a name="Data_Exploration"></a><span class="mw-headline">Data Exploration</span></h3>
<ol><li> <b>Quick Curve Integration Tool</b>: Improvements made. More baseline options have been added, including existing dataset as baseline. </li>
<li> <b>Quick FFT Tool</b>. New in menu.</li></ol>
<h3><a name="Data_Manipulation"></a><span class="mw-headline">Data Manipulation</span></h3>
<ol><li> <b>Translate Curve</b>: Provides more controls in Context menu to control Translating data vertically and horizontally.</li>
<li> <b>Worksheet: Convert to XYZ</b>: provide more options to specify where X and Y data is.</li></ol>
<h3><a name="Fitting"></a><span class="mw-headline">Fitting</span></h3>
<ol><li> A new function is added in both Sigmoidal and Electrophysiology categories: <b>BoltzIV</b>, a surface function <b>Gauss2DRotated</b> will be removed in SR6</li>
<li> Added <b>Reduced Chi-Sqr</b> as an optional output for <b>Linear Fit</b>, <b>Polynomial Fit</b> and <b>Multiple Linear Regression</b> tools</li>
<li> <b>NLFit</b>
<ul><li> Theme structure has changed and this may affect some older themes such as ones created in SR0/SR1 so user may need to recreate them in SR5.</li>
<li> Users can now <b>minimize</b> NLFit dialog and <b>mask or change</b> input data, and then re-open dialog to continue fitting with changed data.</li>
<li> Users can <b>Configure/Add/Delete</b> Parameter tab and Bounds tab. This allows customizing and/or creating new tabs where one can specify which columns to display. (Use context menu of tabs or tables.)</li>
<li> Context menu has been added to Apply <b>significant digits</b> setting of one parameter to all parameters. (Use context menu of value.)</li>
<li> Added <b>Clear</b> context menu to some settings. </li>
<li> The following pertains to <b>Replica Fitting</b>:
<ul><li> <b>Sort Peaks</b> button: Sort peaks on <b>Parameters</b> and <b>Bounds</b> tabs based on a particular parameter. </li>
<li> <b>Reorder Peaks</b> button: After sorting Peaks, Peak index on Parameters and Bounds tab will not be in numerical order. <b>Reorder Peaks</b> button orders them 1, 2, 3 without rearrangement. </li>
<li> Label object added for peak number in Preview For Replica Fit</li>
<li> For replica fitting or multi-data fitting, added context menu on Parameters and Bounds tab to apply parameter value, fixed status, sharing, bounds to all other parameters of same kind. </li></ul></li>
<li> NLFit LabTalk command now supports output control
<ul><li> Added an output control tree. We expose the output control as a treenode to allow users to modify during fit. <p>The tree includes: </p>
<ul><li> Nodes under Advanced - Quantities to Compute </li>
<li> Nodes under Advanced - Residual Analysis </li>
<li> Nodes under Advanced - Find Specific X/Y (nlbeginz/nebeginm adds Find Specific Z) </li>
<li> All nodes in Fitted Curves page</li>
<li> All nodes in Output page</li></ul></li>
<li> Added a command to update the tree to fit report process
<ul><li> Added a new command - nlgui - to get &amp; set changes to the tree before nlend.</li></ul></li></ul></li></ul></li>
<li> <b>Speed improvements</b> have been made for Nonlinear Matrix Fitting.</li>
<li>Add bounds m&lt;150 and constraint m! = 0.5 to PearsonVII function. ID =  13288</li>
<li>Better Residual Calculation and Naming/Labeling Convention. ID = 13285
<ol><li>If fitting single dataset, comment row is removed.</li>
<li>If fitting multiple datasets, comment row will be used to show dataset names.</li>
<li>In Long Name Row output now uses <b>&lt;FunctionName&gt; of &lt;SheetName&gt; &lt;ColumnName&gt;</b>.</li></ol></li>
<li>Added a new variable <i>weight</i> in nlbegin xfunction which is used to specify weight method. ID = 13253</li>
<li>Improve legend in surface fit. ID = 13123
<ol><li>Residual Contour Lines</li>
<li>(a blue line) + xx% Outer Limit</li>
<li>(a red line) - xx% Outer Limit</li></ol></li>
<li>Show no function selected when open nonlinear curve fit dialog (opens faster). ID = 12878</li></ol>
<h3><a name="Signal_Processing"></a><span class="mw-headline">Signal Processing</span></h3>
<ol><li> <b>FFT</b>: The &lt;auto&gt; option for <b>Spectrum Type</b> will now result in only positive frequency part of the spectrum being reported in the output, when the input data has only Real component and no imaginary component. If the input data contains both real and imaginary parts, then &lt;auto&gt; will result in both halves of the spectrum being reported. In previous SRs &lt;auto&gt; always generated both positive and negative parts of the spectrum.</li></ol>
<h3><a name="Peaks_and_Baseline"></a><span class="mw-headline">Peaks and Baseline</span></h3>
<ol><li><b>Peak Analyzer</b>
<ul><li> <b>Recalculate</b> support: PA output results now support the Recalculate feature. This allows customers to create analysis templates based on PA and then change data to update results. This also allows to recall the dialog on existing results to change particular settings and recalculate the result.</li>
<li> <b>Integration Window Width</b>: More options to have been added to adjust the integration width, such as specifying a fixed width for all peaks </li>
<li> <b>Subtract Baseline</b>: A new goal has been added, that finds and subtracts baseline from the raw data.</li>
<li> <b>XPS Baseline</b>: Support has been added for special baseline methods (Shirley and Tougaard) for X-Ray Photoemission Spectra (XPS). This is now available in the <b>Baseline Mode</b> dropdown list.</li>
<li> When parameters are shared, editing any member of the group will automatically update the other members.</li>
<li> <b>Hide</b> button: A new check box called <b>Shared Group Except</b> has been added to the Hide dialog. It is a combo list which has same content as the Share column in the parameters grid. When it is selected, only those same shared group parameter rows will show on the grid.</li>
<li> Support has been added to specify/configure the output location for <b>Subtracted Data</b> and <b>Baseline</b>.</li>
<li> Support has been added to plot fitted curves onto source graph, and the "Update Legend on Source Graph" option is enabled when "Create Report Graph" is selected as &lt;Source Graph&gt;.</li></ul></li>
<li> The following changes pertain to the <b>Fit Control</b> dialog that can be opened from the fit page:
<ul><li> <b>Sort Peaks</b> button added: This allows sorting peaks based on one of the peak parameters such as Area. This is available on both <b>Parameters</b> and <b>Bounds</b> tabs. </li>
<li> <b>Reorder Peaks</b> button added: This will sort the peaks in ascending order of the peak center parameter. This is useful in cases where peaks are found/added not in order, or peaks were previous sorted based on some other parameter, and user then wants to sort them by peak center.  </li>
<li> <b>Context menu</b>: New right-click context menu items have been added on <b>Parameters</b> and <b>Bounds</b> tabs, that allow applying parameter value, fixed status, sharing, bounds to all other parameters of the same type. Thus for example one can specify a lower bound of <b>greater than zero</b> for one area parameter and then use the context menu to impose that bound on all other area parameters. </li>
<li> <b>Context menu</b>: A <b>Clear</b> context menu has been added to clear settings on all same paramters, such as say removing the fixed condition on all peak centers. </li>
<li> <b>Configurable tabs</b>: User can now configure/Add/Delete tabs for Parameters, Bounds etc. This allows user to customize what to display in each such tab. </li>
<li> <b>Formula</b>: A new tab has been added to show the equation/formula of the peak function. The tab gets updated when user clicks and select a particular row in the <b>Parameters</b> tab.</li></ul></li></ol>
<h3><a name="Statistics"></a><span class="mw-headline">Statistics</span></h3>
<ol><li> 2D Frequency Count/Binning improvements
<ul><li> Support output binning results to worksheet. </li>
<li> Specify X/Y Binning Range by Bin Center/End options added</li>
<li> Support different Quantities to computer in each binning, e.g. Min, Max, Sum, Count, Mean, Median, Frequency</li>
<li> Support Subtotal Count for each binned Y.</li>
<li> Support Matrix Plot output.</li></ul></li></ol>
<h2><a name="Worksheet"></a><span class="mw-headline">Worksheet</span></h2>
<ol><li> Copy Column changes. 
<ul><li> <b>Edit: Copy, Ctrl+C</b> -- copies formatted data. </li>
<li> <b>Edit: Copy (full precision), Ctrl+Alt+C</b> copies full precision data</li>
<li> <b>Edit: Copy (including label rows), Ctrl+Shift+C</b> -- is older version's default Ctrl+C behavior. It copies formatted data area and column header labels.</li></ul></li>
<li> Double click on border of column header to auto resize to fit all contents</li>
<li> <b>Worksheet</b>: <b>Reset Column Short Names</b> menu: Convert current short name to other label rows, such as long name, comments. User can specify prefix for new short names. </li>
<li> <b>Column Properties</b> dialog: <b>Date Custom Display</b> dropdown list improved. Some preset custom Date displays are listed. User can customize date diplay.  </li>
<li> Delete rows in worksheet with Auto Update in place. Before sr5, user can't delete rows if some column in worksheet is locked. </li>
<li> <b>Set Column Values</b> Dialog: <b>F(X): OC Functions</b> menu added for a new set of Origin C based functions. These functions are located in internal.c file, including date/time functions and other statistical functions. User can add their own functions there as well.</li>
<li> <b>Extract Worksheet Data</b> dialog: <b>F(X)</b> menu added similar as in <b>Set Column Values</b> dialog.</li>
<li> <b>Go to</b> dialog: Add <b>Extend Selection</b> checkbox to select a range from current selection cell.</li>
<li> <b>Convert to XYZ</b> supports to use label rows to specify X and Y. The output is changed to use XYZRange data type.</li></ol>
<h2><a name="Miscellaneous_2"></a><span class="mw-headline">Miscellaneous</span></h2>
<ol><li> New menu item: <b>Tools: Copy Origin Sub-VI to LabVIEW user.lib</b>: This menu item copies Origin Sub-VI from &lt;Origin Program Folder&gt;\Samples\Automation Server\LabVIEW\Palette to the user.lib subfolder under the LabVIEW installation folder, so that you can then access these OriginLab created sub-VIs in the LabVIEW function palette. The X-fFunction for this menu item is lvvicopy.</li>
<li> ctrl + up/down arrow key navigation can distinguish data region and column header region ID = 12782
<ol><li>When focus is in Data area, Ctrl+UP should go to first row of data.</li>
<li>When the focus is in column header area, Ctrl+UP and +Down should go to first row and last row of header area.</li></ol></li></ol>
<h2><a name="LabTalk"></a><span class="mw-headline">LabTalk</span></h2>
<ol><li> Add a new XF "WmergeXY" to combine All Y columns from multi-sheets which have the same X column.</li>
<li> XF "newlayer" will be removed in SR6 since it is duplicated with "layadd". It is suggested to use "layadd" instead.</li>
<li> Added more OC functions callable from LabTalk
<ul><li> Statistical Functions&#160;: Min, Max, Mean, Median, Total, Count, StdDev, StdDevP</li>
<li> Date Functions&#160;: Year, Month, Day, Hour, Minute, Second</li>
<li> Trigonometric Functions&#160;: asinh, acosh, atanh, Degrees, Radians, Angleint1, Angleint2, Distance, Distance3D</li></ul></li>
<li> LabTalk Control of Graphic Objects
<ul><li> New LabTalk variable type to allow control of graphic objects in any book/layer</li>
<li> New Connect method</li></ul></li>
<li> Date() function supports customized date format.
<dl><dd><pre class="lt" style="font-family:monospace;">e.<span style="color: #000080;">g</span>. <span style="color: #000080;">jdate</span> <span style="color: #000080;">=</span> date<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2008</span><span style="color: #000080;">-</span><span style="color: #0000dd;">18</span><span style="color: #000080;">-</span><span style="color: #0000dd;">12</span>, <span style="color: #ff00ff;">&quot;yyyy-dd-MM&quot;</span><span style="color: #000000;">&#41;</span></pre></dd></dl></li>
<li> Add LabTalk access to the script attached to a graphic object.ID = 13298
<dl><dd><pre class="lt" style="font-family:monospace;">Text1.<span style="color: #000080;">SCRIPT</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Type <span style="color: #000080;">-</span>a Hello World<span style="color: #000080;">!</span>; Text1.<span style="color: #000080;">SCRIPT</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; <span style="color: #008000;">// Run on Button up</span></pre></dd></dl></li>
<li>LT range notation declaration allow name to be substituted.ID = 13293
<dl><dd><pre class="lt" style="font-family:monospace;"> int i <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;range a<span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>i<span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;</pre></dd></dl></li>
<li>New Labtalk string used to refer last report in PA. ID = 13265
<dl><dd><pre class="lt" style="font-family:monospace;">range aa <span style="color: #000080;">=</span> <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>__PAINTEGPEAK<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>;<span style="color: #008000;">//get integpeaks sheet of project file</span></pre></dd></dl></li>
<li> Add a new string variable oname to store output. ID = 13247</li>
<li>Add Labtalk notation to get range string from range variable.ID = 13234
<dl><dd><pre class="lt" style="font-family:monospace;">range rr <span style="color: #000080;">=</span> <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>;type <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>rr<span style="color: #000000;">&#41;</span>;</pre></dd></dl></li>
<li> Sort and CopyFrom method are added into stringarray.ID = 13038</li>
<li>Delete command in LabTalk support deleting a range of rows.ID = 12758
<dl><dd><pre class="lt" style="font-family:monospace;">range r1 <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;range r2 <span style="color: #000080;">=</span> r1<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#93;</span>; delete r2;</pre></dd></dl></li>
<li> LT string function to get a substring between two char needed. ID=13452
<dl><dd><pre class="lt" style="font-family:monospace;"> string temp<span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;book1_my sheetkkk_test&quot;</span>; string result<span style="color: #000080;">=</span>temp.<span style="color: #000080;">Between</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;_&quot;</span>,<span style="color: #ff00ff;">&quot;kkk&quot;</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">$</span>; result<span style="color: #000080;">$</span><span style="color: #000080;">=</span>;</pre></dd></dl></li>
<li> Add <code>Page.isembedded$</code> property to access the source cell range of an embedded graph. ID = 12814.</li></ol>
<h2><a name="OriginC"></a><span class="mw-headline">OriginC</span></h2>
<ol><li>Add back ATI folder in 75. After Patch to latest Sr5, ATI folder will be added and contain 3 header files fitfundef.h LABSTR.h ORGDLL.h. ID = 12296</li></ol>






