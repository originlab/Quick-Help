<h1 class="firstHeading"> MOCA</h1><p class='hierarchy' style='display: none'>MOCA</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Introduction"><span class="tocnumber">1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Structure_of_a_MOCA_DLL"><span class="tocnumber">2</span> <span class="toctext">Structure of a MOCA DLL</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Create_a_MOCA_C.2B.2B_Project_in_Visual_Studio_2012"><span class="tocnumber">3</span> <span class="toctext">Create a MOCA C++ Project in Visual Studio 2012</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Create_an_MFC_DLL_Project"><span class="tocnumber">3.1</span> <span class="toctext">Create an MFC DLL Project</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Change_Project_Settings_to_Use_MOCA"><span class="tocnumber">3.2</span> <span class="toctext">Change Project Settings to Use MOCA</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Change_Existing_Source_Code_Files"><span class="tocnumber">3.3</span> <span class="toctext">Change Existing Source Code Files</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Add_New_Source_Code_Files"><span class="tocnumber">3.4</span> <span class="toctext">Add New Source Code Files</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Add_MOCA_Properties"><span class="tocnumber">3.5</span> <span class="toctext">Add MOCA Properties</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Add_MOCA_Methods"><span class="tocnumber">3.6</span> <span class="toctext">Add MOCA Methods</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-10"><a href="#Examples"><span class="tocnumber">4</span> <span class="toctext">Examples</span></a>
<ul>
<li class="toclevel-2 tocsection-11"><a href="#Real-time_Graphs"><span class="tocnumber">4.1</span> <span class="toctext">Real-time Graphs</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Setting_Up_a_Real-time_Graph"><span class="tocnumber">4.2</span> <span class="toctext">Setting Up a Real-time Graph</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-13"><a href="#MOCA_Classes_and_Functions"><span class="tocnumber">5</span> <span class="toctext">MOCA Classes and Functions</span></a>
<ul>
<li class="toclevel-2 tocsection-14"><a href="#CMOCAObjBase_Class"><span class="tocnumber">5.1</span> <span class="toctext">CMOCAObjBase Class</span></a>
<ul>
<li class="toclevel-3 tocsection-15"><a href="#CreateSubObject_Method"><span class="tocnumber">5.1.1</span> <span class="toctext">CreateSubObject Method</span></a></li>
<li class="toclevel-3 tocsection-16"><a href="#GetSpecialSubObjectPtr_Method"><span class="tocnumber">5.1.2</span> <span class="toctext">GetSpecialSubObjectPtr Method</span></a></li>
<li class="toclevel-3 tocsection-17"><a href="#InitAllocatedSubObjects_Method"><span class="tocnumber">5.1.3</span> <span class="toctext">InitAllocatedSubObjects Method</span></a></li>
<li class="toclevel-3 tocsection-18"><a href="#OnUnloadDLL_Method"><span class="tocnumber">5.1.4</span> <span class="toctext">OnUnloadDLL Method</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-19"><a href="#MoOriginWks_Class"><span class="tocnumber">5.2</span> <span class="toctext">MoOriginWks Class</span></a></li>
<li class="toclevel-2 tocsection-20"><a href="#MoOriginWks_Member_Functions"><span class="tocnumber">5.3</span> <span class="toctext">MoOriginWks Member Functions</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="#MoData_Class"><span class="tocnumber">5.4</span> <span class="toctext">MoData Class</span></a></li>
<li class="toclevel-2 tocsection-22"><a href="#MoData_Member_Functions"><span class="tocnumber">5.5</span> <span class="toctext">MoData Member Functions</span></a></li>
<li class="toclevel-2 tocsection-23"><a href="#MoMatrix_Class"><span class="tocnumber">5.6</span> <span class="toctext">MoMatrix Class</span></a></li>
<li class="toclevel-2 tocsection-24"><a href="#MoMatrix_Member_Functions"><span class="tocnumber">5.7</span> <span class="toctext">MoMatrix Member Functions</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="Introduction"></a><span class="mw-headline">Introduction</span></h2>
<p>MOCA allows you to expand Origin's functionality through Dynamic Link Libraries (DLL).  MOCA consists of a library of C++ classes.  These classes are how a MOCA DLL communicates with Origin.  There are classes for worksheets, datasets, matrices, and other major components of Origin.
</p><p>The functionality of a MOCA DLL is accessed through the properties and methods of a LabTalk object.  The DLL's author decides what properties and methods will be necessary to access the functionality offered by the DLL.  LabTalk's DLL command is used to map a MOCA DLL to a LabTalk object.
</p><p>A MOCA-based DLL would enable you to do the following:
</p>
<ul><li> Add string and numeric properties to LabTalk. </li>
<li> Add methods to LabTalk. </li>
<li> Add Windows interfaces (for example, dialog boxes, windows, and controls) to script code. </li>
<li> Access datasets, worksheets, and matrices from C++ code. </li>
<li> Calculate complex math equations faster than LabTalk. </li>
<li> Execute LabTalk script from C++ code.  </li>
<li> All the capabilities of a Windows DLL (communicating with other DLLs and EXEs).</li></ul>
<p>Note:  Origin also offers the Origin C programming language.  Origin C supports a nearly complete ANSI C language syntax as well as a subset of C++ features including internal and DLL-extended classes.  For more information on Origin C, see the Programming Guide.  For more information on DLL-extended classes see "Class Extender".
</p>
<table class="note">

<tr>
<td><b>Notes:</b> From <b>Origin 2017</b>, Origin does not ship MOCA files together with Origin. If you need these files, you can download them <a class="external text" href="http://blog.originlab.com/wp-content/uploads/2018/06/ATI.zip" target="_blank">here</a>.
</td></tr></table>
<h2><a name="Structure_of_a_MOCA_DLL"></a><span class="mw-headline">Structure of a MOCA DLL</span></h2>
<p>A MOCA DLL is simply a DLL using the shared MFC DLLs and linked with OriginLab's MOCA library.  It has a CWinApp-derived class and a single object of that application class, as does an executable MFC application (see the MFC documentation for more details on such DLLs).
</p><p>Each MOCA DLL must contain exactly one main object.  The class for the main object must be derived from the CMOCAObjBase class.
</p><p>Examining the DatasetObj.CPP file found in the MOCA\Dataset\ folder will show you how to structure your main object's CPP file.  Use the 
MOCA_ENTRY_POINT(&lt;class name&gt;) macro to define the function that Origin will use to communicate with your MOCA DLL.  Origin expects the exported function to be exported with an ordinal value of 70.  To do this simply add a "MocaEntry @70" to your project's .DEF file.
</p><p>The next three parts are used to map LabTalk properties, methods, and subobjects to member functions and data members of your main object's class.  The MOCA_BEGIN_PROP_MAP table is used to map LabTalk properties to member functions and/or data members.  There are various macros to use depending on the property data type and the amount of control necessary when setting and getting values.  The MOCA_BEGIN_METH_MAP table is used to map LabTalk methods to member functions while the MOCA_BEGIN_SUBOBJ_MAP is used to map subobjects to data members.
</p><p>The functions mapped to LabTalk properties and methods must be declared as follows:
</p><p>Numeric Integer Property:
BOOL GetFoo(int &amp;I);
BOOL SetFoo(int I);
</p><p>Numeric Real Property:
BOOL GetFoo(double &amp;d);
BOOL SetFoo(double d);
</p><p>String Property:
BOOL GetFoo(LPSTR pstr);
BOOL SetFoo(LPCTSTR pcstr);
</p><p>Method:
BOOL FooMethod(double &amp;dLabTalkReturn, CStringArray &amp;args);
</p>
<h2><a name="Create_a_MOCA_C.2B.2B_Project_in_Visual_Studio_2012"></a><span class="mw-headline">Create a MOCA C++ Project in Visual Studio 2012</span></h2>
<h3><a name="Create_an_MFC_DLL_Project"></a><span class="mw-headline">Create an MFC DLL Project</span></h3>
<p>First we create a project for creating a simple MFC DLL.
</p>
<ol><li> Start Visual Studio 2012</li>
<li> Choose File &gt; New &gt; Project...</li>
<li> In the New Project dialog:
<ol><li> In left panel choose Installed Templates.</li>
<li> Under Installed Templates choose Visual C++.</li>
<li> Under Visual C++ choose MFC.</li>
<li> In middle panel choose MFC DLL.</li>
<li> At bottom of dialog enter a name for your project.</li>
<li> Click the OK button to close dialog.</li></ol></li>
<li> In the MFC DLL Wizard dialog click the Finish button.</li></ol>
<p>Now you have a project for creating a 32-bit MFC DLL.
</p><p>If you want to make a 64-bit DLL too then follow the steps below.
</p>
<ol><li> In Solution Explorer right-click your project and choose Properties</li>
<li> In Property Pages dialog click the Configuration Manager button in the top right corner.</li>
<li> In the Configuration Manager dialog:
<ol><li> Choose New under Active solution Platform.</li>
<li> In the New Solution Platform dialog set Type to x64 and click OK.</li></ol></li>
<li> Click Close button to close the Configuration Manager dialog.</li></ol>
<p>Now you have a project that can create 32-bit and 64-bit DLLs.
</p>
<h3><a name="Change_Project_Settings_to_Use_MOCA"></a><span class="mw-headline">Change Project Settings to Use MOCA</span></h3>
<p>We need to tell the project where to get the MOCA header and library files.
</p>
<ol><li> In Solution Explorer right-click your project and choose Properties</li>
<li> In Property Pages dialog:
<ol><li> Set Configuration to All Configurations</li>
<li> Set Platform to All Platforms</li>
<li> In left panel expand Configuration Properties</li>
<li> Under Configuration Properties choose General</li>
<li> In right panel set Character Set to Use Multi-Byte Character Set</li>
<li> In left panel, under Configuration Properties expand C/C++</li>
<li> Under C/C++ choose General</li>
<li> In right panel set Additional Include Directories to the MOCA include folder.</li>
<li> Under C/C++ choose Preprocessor</li>
<li> In right panel add NO_SHOBJIDL_SORTDIRECTION to Preprocessor Definitions.</li>
<li> In left panel, under Configuration Properties, expand Linker</li>
<li> Under Linker choose General</li>
<li> In right panel set Additional Library Directories to the MOCA lib folder.</li>
<li> In left panel, under Linker, choose Input</li>
<li> In right panel you need to add the omocavc library to Additional Dependencies.
<ol><li> For making 32-bit DLL, set Platform to Win32 and add omocavc9.lib.</li>
<li> For making 64-bit DLL, set Platform to x64 and add omocavc9_64.lib.</li></ol></li>
<li> Click the OK button to close the Property Pages dialog.</li></ol></li></ol>
<p>The project's settings are now set for creating a MOCA DLL.
</p>
<h3><a name="Change_Existing_Source_Code_Files"></a><span class="mw-headline">Change Existing Source Code Files</span></h3>
<p>When Visual Studio created the project it also created a number of source code files.  We need to change three of these files and all three files have the same name as your project.  The three files are the .def, .h, and .cpp file.
</p><p>The first file we will change is the .def file.  Open the .def file and after the EXPORTS line add the following line:
</p>
<pre class="oc" style="font-family:monospace;">MocaEntry @5</pre>
<p>This is the exported function that Origin calls to communicate with the MOCA DLL.
</p><p>The next file to edit is your project's main header file.  It's name will be &lt;projectName&gt;.h.  Open the file and scroll to the class definition.  In the public overrides, add the following member function:
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">int</span> ExitInstance<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</pre>
<p>Remember the name of the class.  You will need it when editing the next file.  It will follow the syntax C&lt;projectName&gt;App, where &lt;projectName&gt; is the name you gave the Visual Studio project.
</p><p>The next file to edit is your project's main cpp file.  It's name will be &lt;projectName&gt;.cpp.  Open the file and after the existing include statements add:
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #ff00ff;">&quot;MOCADeclare.h&quot;</span></pre>
<p>Now scroll to the end of the file and add the following function definition:
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">int</span> CMyProjectApp<span style="color: #000000;">::</span><span style="color: #000000;">ExitInstance</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	MOCA_CLEANUP
	<span style="color: #0000ff;">return</span> CWinApp<span style="color: #000000;">::</span><span style="color: #000000;">ExitInstance</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<p>In the above function definition remember replace CMyProjectApp with your class name.
</p>
<h3><a name="Add_New_Source_Code_Files"></a><span class="mw-headline">Add New Source Code Files</span></h3>
<p>You need to add two new source code files to the project.  These new files will declare and define the class that will handle your MOCA object.
</p>
<ol><li> In <b>Solution Explorer</b> right-click your project and choose <b>Add New Item</b></li>
<li> In the <b>Add New Item</b> dialog:
<ol><li> In left panel expand <b>Visual C++</b> and select <b>Code</b></li>
<li> In middle panel select <b>Header File (.h)</b></li>
<li> In bottom of dialog give your file a name. In this example, we will name it as <b>CMyMocaObj.h</b> </li>
<li> Click the <b>Add</b> button.</li></ol></li></ol>
<p>Follow the above instructions again but instead of a new <b>Header File (.h)</b> you want to add a <b>C++ File (.cpp)</b>.
</p><p>Now open the header file (CMyMocaObj.h) and paste into it the following code:
</p>
<pre class="oc" style="font-family:monospace;">#ifndef _CMyMocaObj_h_
<span style="color: #0000ff;">#define</span> _CMyMocaObj_h_

<span style="color: #0000ff;">#include</span> <span style="color: #ff00ff;">&quot;mocamain.h&quot;</span> <span style="color: #008000;">// Required header file</span>

<span style="color: #0000ff;">class</span> CMyMocaObj <span style="color: #000000;">:</span> <span style="color: #0000ff;">public</span> CMOCAObjBase
<span style="color: #000000;">&#123;</span>
	MOCA_DECLARE_PROP_MAP<span style="color: #000000;">&#40;</span>CMyMocaObj<span style="color: #000000;">&#41;</span>;
	MOCA_DECLARE_METH_MAP<span style="color: #000000;">&#40;</span>CMyMocaObj<span style="color: #000000;">&#41;</span>

<span style="color: #0000ff;">public</span><span style="color: #000000;">:</span> <span style="color: #008000;">// constructor and destructor</span>
	CMyMocaObj<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	~CMyMocaObj<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;

<span style="color: #000000;">&#125;</span>;

<span style="color: #0000ff;">#endif</span> <span style="color: #008000;">// _CMyMocaObj_h_</span></pre>
<p>Now open the c++ file (.cpp) and paste into it the following code:
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #ff00ff;">&quot;stdafx.h&quot;</span>
<span style="color: #0000ff;">#include</span> <span style="color: #ff00ff;">&quot;CMyMocaObj.h&quot;</span> <span style="color: #008000;">// Use the header file created above</span>

MOCA_ENTRY_POINT<span style="color: #000000;">&#40;</span>CMyMocaObj<span style="color: #000000;">&#41;</span>

MOCA_BEGIN_PROP_MAP<span style="color: #000000;">&#40;</span>CMyMocaObj, CMOCAObjBase<span style="color: #000000;">&#41;</span>
MOCA_END_PROP_MAP<span style="color: #000000;">&#40;</span>CMyMocaObj, CMOCAObjBase<span style="color: #000000;">&#41;</span>

MOCA_BEGIN_METH_MAP<span style="color: #000000;">&#40;</span>CMyMocaObj, CMOCAObjBase<span style="color: #000000;">&#41;</span>
MOCA_END_METH_MAP<span style="color: #000000;">&#40;</span>CMyMocaObj, CMOCAObjBase<span style="color: #000000;">&#41;</span>

CMyMocaObj<span style="color: #000000;">::</span><span style="color: #000000;">CMyMocaObj</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
<span style="color: #000000;">&#125;</span>

CMyMocaObj<span style="color: #000000;">::</span>~CMyMocaObj<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
<span style="color: #000000;">&#125;</span></pre>
<p>The project is now ready for you to add methods and properties to your MOCA object.
</p>
<h3><a name="Add_MOCA_Properties"></a><span class="mw-headline">Add MOCA Properties</span></h3>
<p>There are two types of properties.  The first type simply gets mapped to a data member of your MOCA object class.  The second type uses member functions of your MOCA object class.
</p><p>Lets first add an integer property and a string property.  Open your MOCA object's header file and add the following to the end of the class declaration:
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">private</span><span style="color: #000000;">:</span>
    <span style="color: #0000ff;">int</span> m_nColumnIndex;
    CString m_strWksName;</pre>
<p>Now open your MOCA object's c++ file and scroll down to the MOCA_BEGIN_PROP_MAP.  Add the following between the MOCA_BEGIN_PROP_MAP and MOCA_END_PROP_MAP statements.
</p>
<pre class="oc" style="font-family:monospace;">MOCA_SIMPLE_PROP_INT<span style="color: #000000;">&#40;</span>m_nColumnIndex, <span style="color: #ff00ff;">&quot;ColumnIndex&quot;</span><span style="color: #000000;">&#41;</span>
MOCA_SIMPLE_PROP_STR<span style="color: #000000;">&#40;</span>m_strWksName, <span style="color: #ff00ff;">&quot;WksName&quot;</span><span style="color: #000000;">&#41;</span></pre>
<p>The MOCA_SIMPLE_PROP_INT and MOCA_SIMPLE_PROP_STR are macros that take two parameters.  The first parameter is the data member and the second parameter is the name that LabTalk will use to read and write the value into the data member.  If you wanted your integer property to be read-only then you would use the MOCA_SIMPLE_PROP_INT_GET macro.
</p><p>While simple properties are simple to implement they do not allow you to check or validate the values coming from or going to LabTalk.  If you need the ability to check and validate the values then you will not want to use the non SIMPLE macros.  Replace the code you added with the following:
</p>
<pre class="oc" style="font-family:monospace;">MOCA_PROP_INT<span style="color: #000000;">&#40;</span>GetColumnIndex, SetColumnIndex, <span style="color: #ff00ff;">&quot;ColumnIndex&quot;</span><span style="color: #000000;">&#41;</span>
MOCA_PROP_STR<span style="color: #000000;">&#40;</span>GetWksName, SetWksName, <span style="color: #ff00ff;">&quot;WksName&quot;</span><span style="color: #000000;">&#41;</span></pre>
<p>The MOCA_PROP_INT and MOCA_PROP_STR are macros that take three parameters.  The first parameter is the address of the member function called when getting the property, the second parameter is the address of the member function called when setting the property, and the third parameter is the name that LabTalk will use.
</p><p>Notice the first two parameters refer to member functions.  You need to declare and define these member functions.  Open the header file again and add the following to your MOCA object class:
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">public</span><span style="color: #000000;">:</span>
    <span style="color: #0000ff;">BOOL</span> GetColumnIndex<span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span><span style="color: #000040;">&amp;</span> nValue<span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">BOOL</span> SetColumnIndex<span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> nValue<span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">BOOL</span> GetWksName<span style="color: #000000;">&#40;</span>LPSTR strValue<span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">BOOL</span> SetWksName<span style="color: #000000;">&#40;</span>LPCTSTR strValue<span style="color: #000000;">&#41;</span>;</pre>
<p>Now go back to the cpp file, scroll to the end, and add the following:
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">BOOL</span> CMyMocaObj<span style="color: #000000;">::</span><span style="color: #000000;">GetColumnIndex</span><span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span><span style="color: #000040;">&amp;</span> nValue<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    nValue <span style="color: #000080;">=</span> m_nColumnIndex;
    <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">TRUE</span>;
<span style="color: #000000;">&#125;</span>
<span style="color: #0000ff;">BOOL</span> CMyMocaObj<span style="color: #000000;">::</span><span style="color: #000000;">SetColumnIndex</span><span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> nValue<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    <span style="color: #0000ff;">if</span> <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">10</span> <span style="color: #000080;">&lt;=</span> nValue <span style="color: #000040;">&amp;&amp;</span> nValue <span style="color: #000080;">&lt;=</span> <span style="color: #0000dd;">99</span><span style="color: #000000;">&#41;</span>
        m_nColumnIndex <span style="color: #000080;">=</span> nValue;
    <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">TRUE</span>;
<span style="color: #000000;">&#125;</span>
<span style="color: #0000ff;">BOOL</span> CMyMocaObj<span style="color: #000000;">::</span><span style="color: #000000;">GetWksName</span><span style="color: #000000;">&#40;</span>LPSTR strValue<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    lstrcpy<span style="color: #000000;">&#40;</span>strValue, m_strWksName<span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">TRUE</span>;
<span style="color: #000000;">&#125;</span>
<span style="color: #0000ff;">BOOL</span> CMyMocaObj<span style="color: #000000;">::</span><span style="color: #000000;">SetWksName</span><span style="color: #000000;">&#40;</span>LPCTSTR strValue<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    <span style="color: #0000ff;">if</span> <span style="color: #000000;">&#40;</span>lstrlen<span style="color: #000000;">&#40;</span>strValue<span style="color: #000000;">&#41;</span> <span style="color: #000080;">&lt;=</span> <span style="color: #0000dd;">50</span><span style="color: #000000;">&#41;</span>
        m_strWksName <span style="color: #000080;">=</span> strValue;
    <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">TRUE</span>;
<span style="color: #000000;">&#125;</span></pre>
<p>These member functions are called whenever LabTalk gets or sets the properties.  This allows you to check and verify the values to meet your specific requirements.
</p><p>Thats all there is to adding properties to a MOCA object. There are more macros and they are all defined in mocadef.h.
</p>
<h3><a name="Add_MOCA_Methods"></a><span class="mw-headline">Add MOCA Methods</span></h3>
<p>Open your MOCA object's header file and add the following to the end of the class declaration:
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">private</span><span style="color: #000000;">:</span>
    <span style="color: #0000ff;">BOOL</span> AppendColumnMeth<span style="color: #000000;">&#40;</span><span style="color: #0000ff;">double</span><span style="color: #000040;">&amp;</span> dReturn, CStringArray<span style="color: #000040;">&amp;</span> saArg<span style="color: #000000;">&#41;</span>;</pre>
<p>A member function that handles a MOCA method has the following requirements:
</p>
<ul><li> Return a BOOL</li>
<li> First argument is a reference to a double</li>
<li> Second argument is a reference to a CStringArray</li></ul>
<p>If the method returns FALSE then LabTalk will report a Command Error.  The first argument, the double, is the value returned by the LabTalk function call.  The second argument, the CStringArray, contains all the arguments passed to the LabTalk function call. 
</p><p>Now open your MOCA object's c++ file and scroll down to the MOCA_BEGIN_PROP_MAP. Add the following between the MOCA_BEGIN_METH_MAP and MOCA_END_METH_MAP statements.
</p>
<pre class="oc" style="font-family:monospace;">MOCA_METH_ENTRY<span style="color: #000000;">&#40;</span>AppendColumnMeth, <span style="color: #ff00ff;">&quot;AppendColumn&quot;</span><span style="color: #000000;">&#41;</span></pre>
<p>The MOCA_METH_ENTRY macro adds the MOCA method to the MOCA object's table of methods.  The first argument is the name of the member function in the MOCA object class that will be mapped to the LabTalk method.  The second argument is the name used by LabTalk to reference the method.
</p><p>Now scroll to the end of the file and add the following:
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">BOOL</span> CMyMocaObj<span style="color: #000000;">::</span><span style="color: #000000;">AppendColumnMeth</span><span style="color: #000000;">&#40;</span><span style="color: #0000ff;">double</span><span style="color: #000040;">&amp;</span> dReturn, CStringArray<span style="color: #000040;">&amp;</span> strArg<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    dReturn <span style="color: #000080;">=</span> NANUM;

    <span style="color: #008000;">// check for valid number of arguments</span>
    <span style="color: #008000;">// for this case we only accept 2 arguments</span>
    <span style="color: #0000ff;">if</span> <span style="color: #000000;">&#40;</span>strArg.<span style="color: #000000;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000040;">!</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>
        <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">FALSE</span>; <span style="color: #008000;">// LabTalk command error</span>

    <span style="color: #008000;">// 1st arg contains worksheet name</span>
    MoOriginWks wks<span style="color: #000000;">&#40;</span>strArg<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">if</span> <span style="color: #000000;">&#40;</span><span style="color: #000040;">!</span>wks.<span style="color: #000000;">IsValid</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>
        <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">FALSE</span>; <span style="color: #008000;">// LabTalk command error</span>

    <span style="color: #008000;">// 2nd arg contains column name</span>
    <span style="color: #0000ff;">char</span> szTmp<span style="color: #000000;">&#91;</span>MAX_PATH<span style="color: #000000;">&#93;</span>;
    lstrcpy<span style="color: #000000;">&#40;</span>szTmp, strArg<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">int</span> nRet <span style="color: #000080;">=</span> wks.<span style="color: #000000;">InsertColumn</span><span style="color: #000000;">&#40;</span>szTmp<span style="color: #000000;">&#41;</span>;

    <span style="color: #0000ff;">return</span> <span style="color: #000000;">&#40;</span>nRet <span style="color: #000080;">==</span> <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<p>In LabTalk we would call this function as follows:
</p>
<pre class="lt" style="font-family:monospace;">myObj.<span style="color: #000080;">AppendColumn</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;MyWksName&quot;</span>, <span style="color: #ff00ff;">&quot;MyNewColumnName&quot;</span><span style="color: #000000;">&#41;</span></pre>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p>The MOCA package contains the files necessary to build and run the following MOCA examples.
</p>
<table class="simple">
  
<tr>
<th> Example </th>
<th> Description
</th></tr>
<tr>
<td> Worksheet
</td>
<td> Access a worksheet.
</td></tr>
<tr>
<td> Dataset
</td>
<td> Access a worksheet's data.
</td></tr>
<tr>
<td> Matrix
</td>
<td> Access a matrix.
</td></tr>
<tr>
<td> Dialog
</td>
<td> Using dialog boxes and other resources.
</td></tr>
<tr>
<td> RTScope
</td>
<td> Multi-threaded and real-time updating of a Scope graph.
<p>For more information, see the following section.
</p>
</td></tr>
<tr>
<td> RTScroll
</td>
<td> Multi-threaded and real-time updating of a Scroll graph.
<p>For more information, see the following section.
</p>
</td></tr>
<tr>
<td> RTSweep
</td>
<td> Multi-threaded and real-time updating of a Sweep graph.
<p>For more information, see the following section.
</p>
</td></tr></table>
<h3><a name="Real-time_Graphs"></a><span class="mw-headline">Real-time Graphs</span></h3>
<p>Origin supports three real-time graphs:  Scope, Scroll, and Sweep.  MOCA includes three examples to demonstrate the new graphs:
</p>
<table class="simple">
<tr>
<th> Graph </th>
<th> Description
</th></tr>
<tr>
<td> Scope
</td>
<td> The Scope demo demonstrates the Scope graph.  The Scope graph shows the same range of data.  As the data values are changed, the graph updates only the data points.  The axis scales do not change.
</td></tr>
<tr>
<td> Scroll
</td>
<td> The Scroll demo demonstrates the Scroll graph.  The Scroll graph acts as a window on a large dataset.  As data is added to the dataset, the graph's data points and X axis scroll to the left by a user-specified number of points.  The right side of the graph displays the new data points.
</td></tr>
<tr>
<td> Sweep
</td>
<td> The Sweep demo demonstrates the Sweep graph.  The Sweep graph acts as a window on a large dataset.  As data is added to the dataset, a vertical line the length of the graph's height moves from the left side of the graph to the right side.  While the vertical line moves to the right, the data on its left side is replaced with the new data.
</td></tr></table>
<h3><a name="Setting_Up_a_Real-time_Graph"></a><span class="mw-headline">Setting Up a Real-time Graph</span></h3>
<p>The graph window that will contain the real-time graph must be created from a template.  Once the graph is created you must turn on its bitmap scroll buffer mode using LabTalk's <b>layer -b</b> command option.\
</p>
<pre class="lt" style="font-family:monospace;">layer <span style="color: #000080;">-</span>b b <span style="color: #0000dd;">0</span>;  <span style="color: #008000;">// Turn off buffer mode.</span>
layer <span style="color: #000080;">-</span>b b <span style="color: #0000dd;">1</span>;  <span style="color: #008000;">// Turn on buffer mode for Scroll graph.</span>
layer <span style="color: #000080;">-</span>b b <span style="color: #0000dd;">2</span>;  <span style="color: #008000;">// Turn on buffer mode for Sweep graph.</span></pre>
<p>Additionally, the redraw mode for the dataset that will be plotted must be 
set to MoData::REDRAW_REALTIME and MoData::REALTIME_ON_IDLE.  Use the MoData::set_redraw_mode function to set these two attributes.
</p><p>For the Scroll and Sweep graphs, the maximum number of data points must be predetermined and the worksheet must be updated to have enough rows to hold the data.  The worksheet can be updated by calling the MoOriginWks::SetWksRowSize() function.
</p><p>The real-time graph demos use a thread to update the dataset (Scope) or add to the dataset (Scroll and Sweep).  The thread for the Scroll and Sweep graphs should be terminated once the maximum number of data points has been reached.
</p><p>For the Scroll and Sweep graphs, the number of points being added should be 1/3 (or less) the total number of points displayed on the graph.  This is necessary to correctly scroll or sweep the graph.
</p>
<h2><a name="MOCA_Classes_and_Functions"></a><span class="mw-headline">MOCA Classes and Functions</span></h2>
<p>The following sections review the class and functions for the base class of all MOCA objects, as well as the MOCA classes and member functions for worksheet, dataset, and matrix manipulation.
</p>
<h3><a name="CMOCAObjBase_Class"></a><span class="mw-headline">CMOCAObjBase Class</span></h3>
<p>This section describes the class and functions for the base class of all MOCA objects.
</p><p>CMOCAObjBase is the base class for all MOCA objects.  It is declared in 
MOCADef.H.
</p>
<table class="simple">
<tr>
<th> Method </th>
<th> Description
</th></tr>
<tr>
<td> CreateSubObject
</td>
<td> Allocates pointers to a subobject.
</td></tr>
<tr>
<td> GetSpecialSubObjectPtr
</td>
<td> Returns a pointer to a MOCA subobject.
</td></tr>
<tr>
<td> InitAllocatedSubObjects
</td>
<td> Initializes subobjects allocated at run time.
</td></tr>
<tr>
<td> OnUnloadDLL
</td>
<td> Performs some saving or cleaning before the DLL is unloaded.
</td></tr></table>
<h4><a name="CreateSubObject_Method"></a><span class="mw-headline">CreateSubObject Method</span></h4>
<dl><dt> Declarations</dt>
<dd> <code>CMOCAObjBase* CreateSubObject(LPCSTR lpcszSubObjName)</code></dd>
<dt> Arguments</dt>
<dd> LPCSTR lpcszSubObjName - object name to allocate the pointer to.  </dd>
<dt> Return</dt>
<dd> Pointer to the specified object.   </dd>
<dt> Remarks</dt>
<dd> This is a special function used specifically for building MOCA projects that can be used as a library to create advanced MOCA projects using the functionalities of the first MOCA projects.  For MOCA projects that are intended to be expanded, the MOCA subobjects that are member objects of the main MOCA object should be allocated at run time.</dd>
<dt> LabTalk Equivalent</dt>
<dd> NA</dd></dl>
<h4><a name="GetSpecialSubObjectPtr_Method"></a><span class="mw-headline">GetSpecialSubObjectPtr Method</span></h4>
<dl><dt> Declarations</dt>
<dd> <code>virtual CMOCAObjBase* GetSpecialSubObjectPtr()</code></dd>
<dt> Arguments</dt>
<dd> None.  </dd>
<dt> Return</dt>
<dd> Pointer to a MOCA object.   </dd>
<dt> Remarks</dt>
<dd> This function can be overloaded to return a pointer to a MOCA subobject.  The properties, methods, and subobject tables of the subobject whose pointer is returned will become a part of the class from which this function is called.  In other words, the subobject whose pointer is returned at run time becomes a part of the object from which the function is called.  This should be declared as a private function.</dd>
<dt> LabTalk Equivalent</dt>
<dd> NA</dd></dl>
<h4><a name="InitAllocatedSubObjects_Method"></a><span class="mw-headline">InitAllocatedSubObjects Method</span></h4>
<dl><dt> Declarations</dt>
<dd> <code>virtual BOOL InitAllocatedSubObjects()</code></dd>
<dt> Arguments</dt>
<dd> None.  </dd>
<dt> Return</dt>
<dd> If initialization is successful then TRUE, else FALSE.   </dd>
<dt> Remarks</dt>
<dd> This is a virtual function used for some special initialization of the subobjects allocated at run time, if needed.  This is a simple virtual function so if partial work is done in the derived class, it must call the</dd></dl>
<p>base classes initialization before or after its own, as the need may be.
</p>
<dl><dt> LabTalk Equivalent</dt>
<dd> NA</dd></dl>
<h4><a name="OnUnloadDLL_Method"></a><span class="mw-headline">OnUnloadDLL Method</span></h4>
<dl><dt> Declarations</dt>
<dd> <code>virtual void OnUnloadDLL()</code></dd>
<dt> Arguments</dt>
<dd> None.  </dd>
<dt> Return</dt>
<dd> None.   </dd>
<dt> Remarks</dt>
<dd> This function can be overloaded from the main object (and only the main object) to do some saving or cleaning before the DLL is freed/unloaded.</dd>
<dt> LabTalk Equivalent</dt>
<dd> NA</dd></dl>
<h3><a name="MoOriginWks_Class"></a><span class="mw-headline">MoOriginWks Class</span></h3>
<p>This section describes the classes and functions for worksheet access from MOCA DLLs.  Examples of using some of these functions can be found in the Worksheet demo.
</p><p>MoOriginWks - the main class for accessing worksheets.  It is declared in MoWks.H.
</p><p>MoWksName - derived from MoString and used for handling 
worksheet names.
</p>
<h3><a name="MoOriginWks_Member_Functions"></a><span class="mw-headline">MoOriginWks Member Functions</span></h3>
<table class="simple">
<tr>
<th> Method </th>
<th> Description
</th></tr>
<tr>
<td> MoOriginWks
</td>
<td> Constructor.
</td></tr>
<tr>
<td> &amp;GetWksName
</td>
<td> Gets the name of the worksheet.
</td></tr>
<tr>
<td> ClearOfData
</td>
<td> Clears the worksheet of all its data.
</td></tr>
<tr>
<td> CreateDataAndPlot
</td>
<td> Creates a graph window and plots the worksheet data using the specified X and Y columns.
</td></tr>
<tr>
<td> Destroy
</td>
<td> Destroys the worksheet.
</td></tr>
<tr>
<td> GetAsText
</td>
<td> Gets the value, as text, in the worksheet at the specified column and row number.
</td></tr>
<tr>
<td> GetColLabel
</td>
<td> Gets the label of the column.
</td></tr>
<tr>
<td> GetColLabelMaxWidth
</td>
<td> Gets the label width for the column.
</td></tr>
<tr>
<td> GetColName
</td>
<td> Gets the name of the column.
</td></tr>
<tr>
<td> GetColNameWidth
</td>
<td> Gets the number of characters in the column's name.
</td></tr>
<tr>
<td> GetColumnType
</td>
<td> Gets the Display Type of the column.
</td></tr>
<tr>
<td> GetColumnWidth
</td>
<td> Gets the width of the column.
</td></tr>
<tr>
<td> GetDatasetName
</td>
<td> Gets the dataset name for the column.
</td></tr>
<tr>
<td> GetLargestContentsWidth
</td>
<td> Gets the maximum width of the contents of a column.
</td></tr>
<tr>
<td> GetNumCols
</td>
<td> Gets the number of columns in the worksheet.
</td></tr>
<tr>
<td> InsertColumn
</td>
<td> Inserts a new column into the worksheet and optionally sets its location and label.
</td></tr>
<tr>
<td> InsertMixedColumn
</td>
<td> Inserts a new column of Display Type=Text &amp; Numeric into the worksheet.
</td></tr>
<tr>
<td> InsertTextColumn
</td>
<td> Inserts a new column of Display Type=Text into the worksheet.
</td></tr>
<tr>
<td> IsValid
</td>
<td> Checks to see if the object refers to an existing Origin worksheet.
</td></tr>
<tr>
<td> RemoveColumn
</td>
<td> Removes (deletes) the column from the worksheet.
</td></tr>
<tr>
<td> SetColName
</td>
<td> Sets the name of the column.
</td></tr>
<tr>
<td> SetColNumDecPlaces
</td>
<td> Sets the significant number of decimal places for the data in the column.
</td></tr>
<tr>
<td> SetColumnAsMixed
</td>
<td> Sets the column to Display Type=Text &amp; Numeric.
</td></tr>
<tr>
<td> SetColumnAsNone
</td>
<td> Sets the column to have no plot designation.
</td></tr>
<tr>
<td> SetColumnAsNumeric
</td>
<td> Sets the column to Display Type=Numeric.
</td></tr>
<tr>
<td> SetColumnAsTextual
</td>
<td> Sets the column to Display Type=Text.
</td></tr>
<tr>
<td> SetColumnAsX
</td>
<td> Sets the column to be an X column.
</td></tr>
<tr>
<td> SetColumnAsY
</td>
<td> Sets the column to be a Y column.
</td></tr>
<tr>
<td> SetColumnHeadingHeight
</td>
<td> Sets the height of the column's heading.
</td></tr>
<tr>
<td> SetColumnLabel
</td>
<td> Sets the label of the column.
</td></tr>
<tr>
<td> SetColumnsToNiceWidths
</td>
<td> Auto-sets the width of all columns.
</td></tr>
<tr>
<td> SetColumnWidth
</td>
<td> Sets the width of the column.
</td></tr>
<tr>
<td> SetNiceColumnWidth
</td>
<td> Auto-sets the width of the column.
</td></tr>
<tr>
<td> SetValue
</td>
<td> Sets the value in the worksheet at the specified column and row number.
</td></tr>
<tr>
<td> SetWksLabel
</td>
<td> Sets the worksheet's label.
</td></tr>
<tr>
<td> SetWksRowSize
</td>
<td> Sets the number of rows in the worksheet.
</td></tr></table>
<h3><a name="MoData_Class"></a><span class="mw-headline">MoData Class</span></h3>
<p>This section describes the classes and functions for dataset access from MOCA DLLs.  Examples of using some of these functions can be found in the Dataset demo.
</p><p>MoData - the base class for Origin internal dataset access.  It is declared in MoData.H.  
</p><p>The following classes for dataset access are derived from MoData and are  
declared in MoData.H:
</p><p>MoSourceData - the class for the object corresponding to a source dataset.  The object must be interfaced with an existing dataset.
</p><p>MoTempData - the class for an "abstract" (in the sense that it is not associated with a real dataset) Y dataset object with an associated X dataset.
</p><p>MoTempDataset - the class for an "abstract" (in the sense that it is not associated with a real dataset) dataset object.
</p><p>The following classes, declared in ODLL.H, are also used with datasets: 
</p><p>MoDataSetName - the class for the dataset name.
</p><p>MoWksName - the class for the worksheet name.
</p><p>MoColumnNum - the class for the column number (first column is number 1).
</p>
<h3><a name="MoData_Member_Functions"></a><span class="mw-headline">MoData Member Functions</span></h3>
<table class="simple">
<tr>
<th> Method </th>
<th> Description
</th></tr>
<tr>
<td> MoSourceData
</td>
<td> Constructor.
</td></tr>
<tr>
<td> MoTempData
</td>
<td> Constructor.
</td></tr>
<tr>
<td> MoTempDataset
</td>
<td> Constructor.
</td></tr>
<tr>
<td> GetId
</td>
<td> Gets the dataset ID.
</td></tr>
<tr>
<td> GetMissingNum
</td>
<td> Gets the number of cells in the dataset that are not set to any value.
</td></tr>
<tr>
<td> GetNumericValueAsText
</td>
<td> Gets the value at the specified index in a dataset as text.
</td></tr>
<tr>
<td> GetSafeXY
</td>
<td> Gets a Y and associated X value.
</td></tr>
<tr>
<td> GetValue
</td>
<td> Gets the string value in the cell.
</td></tr>
<tr>
<td> GetXY
</td>
<td> Gets a Y and associated X value.
</td></tr>
<tr>
<td> GetYfromX
</td>
<td> Gets the Y for the specified X value.
</td></tr>
<tr>
<td> iRange1
</td>
<td> Gets the low bound (the smallest index) of the range of the dataset.
</td></tr>
<tr>
<td> iRange2
</td>
<td> Gets the high bound (the largest index) of the range of the dataset.
</td></tr>
<tr>
<td> IsEmpty
</td>
<td> Checks if the dataset is empty.
</td></tr>
<tr>
<td> IsTextualDataset
</td>
<td> Checks if the dataset is Display Type=Text.
</td></tr>
<tr>
<td> IsValid
</td>
<td> Checks that the MoSourceData object is associated with a valid dataset.
</td></tr>
<tr>
<td> LeftEnd
</td>
<td> Gets the value in the first row with data.
</td></tr>
<tr>
<td> ResetRange
</td>
<td> Resets the range to 0,0.
</td></tr>
<tr>
<td> RightEnd
</td>
<td> Gets the value in the last row with data.
</td></tr>
<tr>
<td> SetRange
</td>
<td> Sets the lowest and the highest index for the range of a dataset.
</td></tr>
<tr>
<td> SetSelRange
</td>
<td> Sets the selection range.
</td></tr>
<tr>
<td> SetValue
</td>
<td> Sets the value in a cell.
</td></tr>
<tr>
<td> SetXY
</td>
<td> Sets a Y and associated X value.
</td></tr>
<tr>
<th> Operator </th>
<th> Description
</th></tr>
<tr>
<td> *=
</td>
<td> Multiply a specified value or dataset values to the values in the dataset.
</td></tr>
<tr>
<td> /=
</td>
<td> Divide the dataset values by a specified value or dataset values.
</td></tr>
<tr>
<td> +=
</td>
<td> Add a specified value or dataset values to the values in the dataset.
</td></tr>
<tr>
<td> -=
</td>
<td> Subtract a specified value or dataset values from the values in the dataset.
</td></tr></table>
<h3><a name="MoMatrix_Class"></a><span class="mw-headline">MoMatrix Class</span></h3>
<p>This section describes the class and functions for matrix access from MOCA DLLs. Examples of using some of these functions can be found in the Matrix demo.
</p><p>MoMatrixName - the class for the matrix name. Derived from MoString.
</p><p>MoMatrix - the class for the object corresponding to a matrix. Derived from MoData.
</p>
<h3><a name="MoMatrix_Member_Functions"></a><span class="mw-headline">MoMatrix Member Functions</span></h3>
<table class="simple">
<tr>
<th> Method </th>
<th> Description
</th></tr>
<tr>
<td> MoSourceData
</td>
<td> Constructor.
</td></tr>

<tr>
<td> GetMatrixXY
</td>
<td> Gets the minimum and maximum X and Y values for the matrix.
</td></tr>

<tr>
<td> GetxMax
</td>
<td> Gets the maximum X value.
</td></tr>

<tr>
<td> GetxMin
</td>
<td> Gets the minimum X value.
</td></tr>

<tr>
<td> GetyMax
</td>
<td> Gets the maximum Y value.
</td></tr>

<tr>
<td> GetyMin
</td>
<td> Gets the minimum Y value.
</td></tr>

<tr>
<td> IsValid
</td>
<td> Checks if the MoMatrix object is associated with a valid matrix.
</td></tr>

<tr>
<td> nCols
</td>
<td> Gets the number of columns in the matrix.
</td></tr>

<tr>
<td> nRows
</td>
<td> Gets the number of rows in the matrix.
</td></tr>

<tr>
<td> SetDim
</td>
<td> Sets the dimensions of the matrix.
</td></tr>

<tr>
<td> SetVal
</td>
<td> Sets the value in the specified row and column.
</td></tr>

<tr>
<td> SetxMax
</td>
<td> Sets the maximum X coordinate for plotting.
</td></tr>

<tr>
<td> SetxMin
</td>
<td> Sets the minimum X coordinate for plotting.
</td></tr>

<tr>
<td> SetXY
</td>
<td> Sets the minimum and maximum X and Y values for the matrix.
</td></tr>

<tr>
<td> SetyMax
</td>
<td> Sets the maximum Y coordinate for plotting.
</td></tr>

<tr>
<td> SetyMin
</td>
<td> Sets the minimum Y coordinate for plotting.
</td></tr>
<tr>
<th> Operator </th>
<th> Description
</th></tr>
<tr>
<td> operator ()
</td>
<td> Gets the value in the specified row and column.
</td></tr>
</table>






