<h1 class="firstHeading">6.6.6 Grouped Stacked Column</h1><p class='urlname' style='display: none'>GroupedStackedColumn</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Summary"><span class="tocnumber">1</span> <span class="toctext">Summary</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#What_will_you_learn"><span class="tocnumber">2</span> <span class="toctext">What will you learn</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Create_a_Grouped_Stacked_Column_Plot"><span class="tocnumber">3</span> <span class="toctext">Create a Grouped Stacked Column Plot</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Method_1:_Using_the_Online_Template"><span class="tocnumber">3.1</span> <span class="toctext">Method 1: Using the Online Template</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Method_2:_Subgroup_the_Stacked_Columns"><span class="tocnumber">3.2</span> <span class="toctext">Method 2: Subgroup the Stacked Columns</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Add_Lables_for_Columns"><span class="tocnumber">4</span> <span class="toctext">Add Lables for Columns</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Create_a_Tick_Label_Table_for_X_Axis"><span class="tocnumber">5</span> <span class="toctext">Create a Tick Label Table for X Axis</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Customize_Column_Colors"><span class="tocnumber">6</span> <span class="toctext">Customize Column Colors</span></a></li>
</ul>
</div>

<p><br />
</p>
<table class="simple" style="width: 80%">

<tr style="vertical-align: top;">
<td style="width: 40%"><a  class="image"><img alt="Video Image.png" src="../images/Grouped_Stacked_Column/Video_Image.png?v=58041" width="33"  /></a> <a  class="image"><img alt="Video Text Image.png" src="../images/Grouped_Stacked_Column/Video_Text_Image.png?v=64565" width="135"  /></a>
<ul><li> <a class="external text" href="https://www.originlab.com/videos/details.aspx?id=99" target="_blank">Plot Error Bars in 2D Graph</a></li>
<li> <a class="external text" href="https://www.originlab.com/videos/details.aspx?id=10" target="_blank">Adding Error Bars to a Graph</a></li>
<li> <a class="external text" href="https://www.originlab.com/videos/details.aspx?id=253" target="_blank">Plot X and Y Error Bars</a></li>
<li> <a class="external text" href="https://www.originlab.com/videos/details.aspx?id=252" target="_blank">Plot Data with Different Y Plus and Minus Error Bars</a></li></ul>
</td>
<td style="width: 40%"><a  class="image"><img alt="Website blog icon circle.png" src="../images/Grouped_Stacked_Column/Website_blog_icon_circle.png?v=64566" width="31"  /></a> <a  class="image"><img alt="Blog Image 33x33px.png" src="../images/Grouped_Stacked_Column/Blog_Image_33x33px.png?v=64564" width="135"  /></a>
<ul><li> <a class="external text" href="http://blog.originlab.com/plotting-barcolumn-graphs-with-indexed-patterns" target="_blank">Plotting Bar/Column Graphs with Indexed Patterns</a></li>
<li> <a class="external text" href="http://blog.originlab.com/grouped-columns-with-gap-between-subgroups" target="_blank">Grouped Columns with Gap between Subgroups</a></li></ul>
</td></tr></table>
<p><br />
</p>
<h2><a name="Summary"></a><span class="mw-headline">Summary</span></h2>
<p>In Origin, multiple datasets can be plotted as a stacked column graph. Usually these datasets are grouped together by default. In addition, subgrouping is possible for stacked column graphs such as the one shown below with 2 subgroups:
<br /><a  class="image"><img alt="Grouped Stacked Column 08.png" src="../images/Grouped_Stacked_Column/Grouped_Stacked_Column_08.png?v=68939" width="561"  /></a><br />
</p>
<p class="version" >Minimum Origin Version Required: 2021 SR0</p>
<h2><a name="What_will_you_learn"></a><span class="mw-headline">What will you learn</span></h2>
<p>This tutorial will show you how to:
</p>
<ul><li> Plot a grouped stacked column graph with Online template</li>
<li> Subgroup a general stacked column to get a grouped stacked column</li>
<li> Add labels for columns</li>
<li> Create and customize an X axis table for the graph</li></ul>
<h2><a name="Create_a_Grouped_Stacked_Column_Plot"></a><span class="mw-headline">Create a Grouped Stacked Column Plot</span></h2>
<p>This tutorial is associated with the <i>Grouped Stacked Column</i> folder in the project <i>&lt;Origin EXE Folder&gt;\Samples\Tutorial Data.opj</i>. 
</p><p><b>Note:</b> You can also access this sample graph by double-clicking on its thumbnail under the <i>Column and Bar</i> graph sample in the <b>Learning Center</b> dialog(<b>Help: Learning Center</b> menu or press <b>F11</b>) .
</p><p><b>There are two methods to create s grouped stacked column plot:</b>
</p>
<ul><li> Since Origin 2021, Origin provides a lot of online templates, you can download the template "Side-by-side Stacked Columns" from <b>Template Center</b> and use it to plot a grouped staked column directly.  </li>
<li> Of course, you can still make a grouped staked column starting from a general stacked column graph. </li></ul>
<h3><a name="Method_1:_Using_the_Online_Template"></a><span class="mw-headline">Method 1: Using the Online Template</span></h3>
<ol><li> Highlight col(B)~col(G) , choose menu <b>Plot: Template Library</b> to open <b>Template Library</b>. Click the <b>Open Template Center</b> button in the upper-right corner. 
<dl><dd><a  class="image"><img alt="Grouped Stacked Column M1 01.png" src="../images/Grouped_Stacked_Column/750px-Grouped_Stacked_Column_M1_01.png?v=68893" width="750"   /></a></dd></dl></li>
<li> The <b>Template Center</b> will be opened. Search the online template "Side-by-side Stacked Columns" and download it.
<dl><dd><a  class="image"><img alt="Grouped Stacked Column M1 02.png" src="../images/Grouped_Stacked_Column/750px-Grouped_Stacked_Column_M1_02.png?v=68894" width="750"   /></a></dd></dl></li>
<li> After the template is downloaded, close the <b>Template Center</b>. This template will be listed in the <b>Template Library</b>. Select it and click <b>Plot</b> Button to plot the graph.
<dl><dd><a  class="image"><img alt="Grouped Stacked Column M1 03.png" src="../images/Grouped_Stacked_Column/750px-Grouped_Stacked_Column_M1_03.png?v=68896" width="750"   /></a></dd></dl></li>
<li> You will get the graph as below:
<dl><dd><a  class="image"><img alt="Grouped Stacked Column M1 04.png" src="../images/Grouped_Stacked_Column/Grouped_Stacked_Column_M1_04.png?v=68898" width="533"  /></a></dd></dl></li></ol>
<h3><a name="Method_2:_Subgroup_the_Stacked_Columns"></a><span class="mw-headline">Method 2: Subgroup the Stacked Columns</span></h3>
<ol><li> Activate the worksheet <b>Sheet1</b>, highlight col(B)~col(G) and select <b>Plot &gt; Bar, Pie, Area: Stacked Column</b> from the menu to create a stacked column graph:
<dl><dd><a  class="image"><img alt="Grouped Stacked Column 01.png" src="../images/Grouped_Stacked_Column/Grouped_Stacked_Column_01.png?v=68931" width="371"  /></a></dd></dl></li>
<li> Double-click on the column plot to open the <b>Plot Details</b> dialog. On the <b>Group</b> tab, select <b>By Size</b> for <b>Enable subgroup</b> and set <b>Subgroup Size</b> to <b>3</b>.
<dl><dd><a  class="image"><img alt="Grouped Stacked Column 02 2.png" src="../images/Grouped_Stacked_Column/Grouped_Stacked_Column_02_2.png?v=68932" width="661"  /></a></dd></dl></li>
<li> Select <b>Layer1</b> in left panel of <b>Plot Details</b> dialog and click the <b>Stack</b> tab. Check the <b>Offset Within Subgroup(in Group tab) for Cumulative/Incremental</b> check box. Click the <b>Apply</b> button. 
<dl><dd><a  class="image"><img alt="Grouped Stacked Column 05.png" src="../images/Grouped_Stacked_Column/Grouped_Stacked_Column_05.png?v=61734" width="548"  /></a></dd></dl></li>
<li> Click <b>OK</b> to close the dialog. Select <b>Graph: Rescale to Show All</b> from the main menu to rescale the layer. You will get the graph as below:
<dl><dd><a  class="image"><img alt="Grouped Stacked Column M2 01.png" src="../images/Grouped_Stacked_Column/Grouped_Stacked_Column_M2_01.png?v=68901" width="426"  /></a></dd></dl></li></ol>
<h2><a name="Add_Lables_for_Columns"></a><span class="mw-headline">Add Lables for Columns</span></h2>
<ol><li>Click on the column, and in the popup mini toolbar, click the <b>Show Data Labels</b> under the <b>Group</b> tab to show the data labels on the columns.
<dl><dd><a  class="image"><img alt="Grouped Stacked Column 03 2.png" src="../images/Grouped_Stacked_Column/Grouped_Stacked_Column_03_2.png?v=68903" width="490"  /></a></dd></dl></li>
<li>Click on the label,  and in the popup mini toolbar, click the <b>Label Source</b> button and select <b>Percent</b> from the dropdown list. 
<dl><dd><a  class="image"><img alt="Grouped Stacked Column 03 3.png" src="../images/Grouped_Stacked_Column/Grouped_Stacked_Column_03_3.png?v=68906" width="492"  /></a></dd>
<dd>Please note, to change the labels of all columns together with mini toolbar, you need select the first plot in current layer group. In this stacked column graph, the bottom one within the first subgroup should be the first plot.</dd></dl></li>
<li> Double-click on graph layer to open the <b>Plot Details</b> dialog. Select <b>Layer1</b> in left panel of <b>Plot Details</b> dialog and click the <b>Stack</b> tab. Check the <b>Show Total Label on Stacked Column/Bar</b>.
<dl><dd><a  class="image"><img alt="Grouped Stacked Column 09.png" src="../images/Grouped_Stacked_Column/650px-Grouped_Stacked_Column_09.png?v=61745" width="650"   /></a></dd></dl></li>
<li> You will get the graph with labels as below:
<dl><dd><a  class="image"><img alt="Grouped Stacked Column 03 4.png" src="../images/Grouped_Stacked_Column/Grouped_Stacked_Column_03_4.png?v=68912" width="676"  /></a></dd></dl></li></ol>
<h2><a name="Create_a_Tick_Label_Table_for_X_Axis"></a><span class="mw-headline">Create a Tick Label Table for X Axis</span></h2>
<ol><li> To create two rows of tick labels for the X axis, double-click on the X axis tick labels to open the <b>Axis</b> dialog. 
<ul><li> Go to <b>Bottom</b> icon with <b>Tick Labels</b> tab selected. </li>
<li> Under <b>Format</b> tab, change <b>Font Size</b> to <b>16</b></li>
<li> Under <b>Table</b> tab, check the <b>Enable</b> checkbox and set <b>Number of Rows</b> to <b>2</b>.  <b>Bottom</b> icon will change into <b>Bottom 1</b> and <b>Bottom 2</b> on the left panel. </li>
<li> Set the Table layout as shown below:
<dl><dd><a  class="image"><img alt="Grouped Stacked Column 06.png" src="../images/Grouped_Stacked_Column/Grouped_Stacked_Column_06.png?v=61737" width="565"  /></a></dd></dl></li>
<li> Select the <b>Bottom 2</b> icon and set <b>Dataset Name</b> to <i>[Book4]Sheet1!H</i> in <b>Display</b> tab, and set the <b>Font size</b> to 12 in the <b>Format</b> tab. This will change the tick label row to the car names from the worksheet <b>label (Y)</b> column.</li>
<li> Set the table layout as the dialog below:
<dl><dd><a  class="image"><img alt="Grouped Stacked Column 07.png" src="../images/Grouped_Stacked_Column/Grouped_Stacked_Column_07.png?v=49120" width="594"  /></a></dd></dl></li></ul></li>
<li>Click OK button to close the dialog. Move the Legend box inside the layer. Click on the legend box, and in the popup minitoolbar, click on the button <b>Data Plot Legend Translation Mode</b> to select <i>Long Name</i> from the drop-down list.
<ul><li><dl><dd><a  class="image"><img alt="Grouped Stacked Column 07b.png" src="../images/Grouped_Stacked_Column/Grouped_Stacked_Column_07b.png?v=68934" width="616"  /></a></dd></dl></li></ul></li>
<li> You will get the graph as below:
<dl><dd><a  class="image"><img alt="Grouped Stacked Column 07a.png" src="../images/Grouped_Stacked_Column/Grouped_Stacked_Column_07a.png?v=68935" width="571"  /></a></dd></dl></li></ol>
<h2><a name="Customize_Column_Colors"></a><span class="mw-headline">Customize Column Colors</span></h2>
<ol><li> Double-click on the column plot to open the <b>Plot Details</b> dialog. On <b>Group</b> tab, click the <a  class="image"><img alt="Button browser.png" src="../images/Grouped_Stacked_Column/Button_browser.png?v=24454" width="15"  /></a> button in the <b>Details</b> column of the <b>Fill Color</b> row. <b>Build Colors</b> dialog opens. </li>
<li> Select the first color, set <b>Red</b>, <b>Green</b> and <b>Blue</b> values to <b>165, 196</b> and <b>0</b>, then click <b>Replace</b> button to add this color to the color list. </li>
<li> Create five more custom colors using these RGB values: (<b>243, 62, 12</b>), (<b>243, 200, 30</b>), (<b>0, 64, 127</b>) (<b>119, 0, 31</b>), and (<b>124, 191, 243</b>).</li>
<li> Select all colors under color(6),  click <b>Delete</b> button to remove these colors so that you have just the six custom colors that you just created. Click <b>OK</b> to close the <b>Build Colors</b>.
<dl><dd><a  class="image"><img alt="Grouped Stacked Column 02.png" src="../images/Grouped_Stacked_Column/Grouped_Stacked_Column_02.png?v=68938" width="710"  /></a></dd></dl></li>
<li> Right-click on en empty portion of the graph window and select <b>Add/Modify Layer Title</b> from the context menu. Type <b>Sales</b> as a layer title. </li>
<li> Resize as needed, using the green selection handles. Finally, you will get the graph as the Summary shows.</li></ol>






