<h1 class="firstHeading">4.2.2.15 Fitting with Two Integrals using LabTalk Function</h1><p class='urlname' style='display: none'>Fitting-2Integral-LabTalk</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Summary"><span class="tocnumber">1</span> <span class="toctext">Summary</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#What_you_will_learn"><span class="tocnumber">2</span> <span class="toctext">What you will learn</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Example_and_Steps"><span class="tocnumber">3</span> <span class="toctext">Example and Steps</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#The_Fitting_Model"><span class="tocnumber">3.1</span> <span class="toctext">The Fitting Model</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Define_the_Function"><span class="tocnumber">3.2</span> <span class="toctext">Define the Function</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Fit_the_Curve"><span class="tocnumber">3.3</span> <span class="toctext">Fit the Curve</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="Summary"></a><span class="mw-headline">Summary</span></h2>
<p>In some circumstance, one may want to create fitting function with multiple integrals:
</p>
<dl><dd><img src="../images/Fitting_with_Two_Integrals_using_LabTalk_Function/math-f019cfb8b4ac68af260cab146da752ae.png?v=0" title="\int_{LL1}^{UL1} f(t, arg1, arg2, ...)~dt + \int_{LL2}^{UL2} g(x, arg3, arg4, ...)~dx" alt="\int_{LL1}^{UL1} f(t, arg1, arg2, ...)~dt + \int_{LL2}^{UL2} g(x, arg3, arg4, ...)~dx" class="tex"/></dd></dl>
<p>We refer to <a href="../../Tutorial/Tutorial/Fitting_with_Integral_using_LabTalk_Function.html" title="Tutorial:Fitting with Integral using LabTalk Function">Fitting with Integral using LabTalk Function</a> for detailed description of parameters in the expression. 
</p><p>In version Origin 8.6, however, <span class="db">Fitting Function Builder</span> just supports one integral in fitting function. Bypassing complex Origin C code, we can use <span class="db">Fitting Function Organizer</span> to reach the goal. 
</p><p>In this tutorial, we will show you how to create a fitting function comprised of two integrals using function organizer. Of course, one can include more integrals as desired.
</p>
<p class="version" >Minimum Origin Version Required: Origin 8.6</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Fitting_with_Two_Integrals_using_LabTalk_Function/Tip_icon.png?v=8477" width="57"  border="0" /></td><td><p>Beginning with Origin 2018b, you can define a an implicit function using integrals.
</p></td></tr></table>
<h2><a name="What_you_will_learn"></a><span class="mw-headline">What you will learn</span></h2>
<p>This tutorial will show you how to: 
</p>
<ul><li> Create a fitting function using the Fitting Function Organizer</li>
<li> Create a fitting function with two integrals using LabTalk function</li></ul>
<h2><a name="Example_and_Steps"></a><span class="mw-headline">Example and Steps</span></h2>
<h3><a name="The_Fitting_Model"></a><span class="mw-headline">The Fitting Model</span></h3>
<p>The fitting model is described as below:
</p>
<dl><dd><img src="../images/Fitting_with_Two_Integrals_using_LabTalk_Function/math-1bfc884f2e1467c2514df415278b963e.png?v=0" title="y=y_0+\int_{-5}^{x} A~t~dt - \int_{-\infty}^{x}B~t~\exp(-t^2/{w}^2)~ dt" alt="y=y_0+\int_{-5}^{x} A~t~dt - \int_{-\infty}^{x}B~t~\exp(-t^2/{w}^2)~ dt" class="tex"/></dd></dl>
<p>There are four parameters in the fitting function, and we need to pass three of them into the integrand, and use the independent variable as upper limit, to do integration.
</p>
<h3><a name="Define_the_Function"></a><span class="mw-headline">Define the Function</span></h3>
<ol>
<li> Press <span class="key">F9</span> to open <span class="db">Fitting Function Organizer</span> dialog. Add a new function by pressing <b>New Function</b> after you select a category in which you want to put your function. One can also add new category by pressing the <b>New Category</b> button. 

<br /><br /><a  class="image"><img alt="Fit Two Integral 001.jpg" src="../images/Fitting_with_Two_Integrals_using_LabTalk_Function/Fit_Two_Integral_001.jpg?v=13874" width="580"  /></a><br /><br />


<li> Specify the function name in the <b>Function Name</b> edit box as you like. Define <b>Independent Variables</b>, 
<b>Dependent Variables</b> and <b>Parameter Names</b> in corresponding edit box. 


<li> Select the <b>Function Form</b> in the drop box. One can find explanations in the <b>Hints</b> tab at the bottom of the dialog.

<br /><br /><a  class="image"><img alt="Fit Two Integral 002.jpg" src="../images/Fitting_with_Two_Integrals_using_LabTalk_Function/Fit_Two_Integral_002.jpg?v=13876" width="580"  /></a><br /><br />

<li> In the <b>Function</b> edit box, define your fitting function. The integrals are written in the form of LabTalk <b>integral</b> function. 
<pre class="lt" style="font-family:monospace;">y<span style="color: #000080;">=</span>integral<span style="color: #000000;">&#40;</span>polyint, <span style="color: #000080;">-</span><span style="color: #0000dd;">5</span>, x, a<span style="color: #000000;">&#41;</span><span style="color: #000080;">-</span>integral<span style="color: #000000;">&#40;</span>gaussint, <span style="color: #000080;">-</span>inf, x, b, wc<span style="color: #000000;">&#41;</span><span style="color: #000080;">+</span>y0</pre>
<p>As described in <a href="../../Tutorial/Tutorial/Fitting_with_Integral_using_LabTalk_Function.html" title="Tutorial:Fitting with Integral using LabTalk Function">Fitting with Integral using LabTalk Function</a>, <i>x</i>, <i>a</i>, <i>b</i> and <i>wc</i> are parameters passed into the integrand functions.  
</p>
<li> Press the button at the right corner of
 <b>Parameter Settings</b> box to active
 <span class="db">Parameter Settings</span> dialog. Set initial values as well as other constraints such as lower bounds, upper bounds for each parameter.

<br /><br /><a  class="image"><img alt="Fit Two Integral 003.jpg" src="../images/Fitting_with_Two_Integrals_using_LabTalk_Function/Fit_Two_Integral_003.jpg?v=13873" width="580"  /></a><br /><br />

<li> Define the two integrals in the
 <b>LabTalk Functions Definition and Initializations</b> box. In this case, the functions should be:

<pre class="lt" style="font-family:monospace;">function double polyint<span style="color: #000000;">&#40;</span>double t, double ia<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	return ia<span style="color: #000080;">*</span>t&#160;;

<span style="color: #000000;">&#125;</span>


function double gaussint<span style="color: #000000;">&#40;</span>t, ib, iwc<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	return ib <span style="color: #000080;">*</span>t<span style="color: #000080;">*</span> exp<span style="color: #000000;">&#40;</span><span style="color: #000080;">-</span><span style="color: #000000;">&#40;</span>t<span style="color: #000000;">&#41;</span><span style="color: #000080;">^</span><span style="color: #0000dd;">2</span><span style="color: #000080;">/</span>iwc<span style="color: #000080;">^</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>&#160;;
<span style="color: #000000;">&#125;</span></pre>
<li> We have successfully set our two integrals fitting function. You can set other information in corresponding box. Do not forget to <b>Save</b> your fitting function after you finish. 
</ol>
<h3><a name="Fit_the_Curve"></a><span class="mw-headline">Fit the Curve</span></h3>
<p>Copy and paste the following data into Origin worksheet:
</p>
<dl><dd><table class="simple" style="width:120px">
<tr>
<th> X
</th>
<th> Y
</th></tr>
<tr>
<td> -3
</td>
<td>2.47613
</td></tr>
<tr>
<td> -2.6
</td>
<td>2.24016
</td></tr>
<tr>
<td> -2.2
</td>
<td>2.01543
</td></tr>
<tr>
<td> -1.8
</td>
<td>1.83094
</td></tr>
<tr>
<td> -1.5
</td>
<td>1.85038
</td></tr>
<tr>
<td> -1.1
</td>
<td>2.17725
</td></tr>
<tr>
<td> -0.9
</td>
<td>2.44967
</td></tr>
<tr>
<td> -0.7
</td>
<td>2.61423
</td></tr>
<tr>
<td> -0.5
</td>
<td>3.02305
</td></tr>
<tr>
<td> -0.3
</td>
<td>3.23057
</td></tr>
<tr>
<td> -0.1
</td>
<td>3.37822
</td></tr>
<tr>
<td>0.1
</td>
<td>3.2827
</td></tr>
<tr>
<td>0.3
</td>
<td>3.18775
</td></tr>
<tr>
<td>0.5
</td>
<td>2.86194
</td></tr>
<tr>
<td>0.7
</td>
<td>2.69104
</td></tr>
<tr>
<td>0.9
</td>
<td>2.39315
</td></tr>
<tr>
<td>1.4
</td>
<td>2.04046
</td></tr>
<tr>
<td>1.8
</td>
<td>1.85287
</td></tr>
<tr>
<td>2.2
</td>
<td>1.85325
</td></tr>
<tr>
<td>2.6
</td>
<td>2.20569
</td></tr></table></dd></dl>
<p>Highlight the <i>Y</i> column, and press <span class="key">Ctrl + Y</span> to open the <span class="db">NLFit</span> dialog. Select the function you just defined, and click fit button <a  class="image"><img alt="Button Fit.png" src="../images/Fitting_with_Two_Integrals_using_LabTalk_Function/Button_Fit.png?v=1372" width="51"  /></a> to perform fitting. 
<br /><br /><a  class="image"><img alt="Fit Two Integral 004.png" src="../images/Fitting_with_Two_Integrals_using_LabTalk_Function/Fit_Two_Integral_004.png?v=33709" width="316"  /></a><br /><br />
</p>

