<h1 class="firstHeading">5.6.1 Principal Component Analysis</h1><p class='urlname' style='display: none'>Principal-Component-Analysis</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Summary"><span class="tocnumber">1</span> <span class="toctext">Summary</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Selecting_Principal_Methods"><span class="tocnumber">2</span> <span class="toctext">Selecting Principal Methods</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Request_Principal_Component_Plots"><span class="tocnumber">3</span> <span class="toctext">Request Principal Component Plots</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Interpreting_The_Results"><span class="tocnumber">4</span> <span class="toctext">Interpreting The Results</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Create_3D_Components_Plot"><span class="tocnumber">5</span> <span class="toctext">Create 3D Components Plot</span></a></li>
</ul>
</div>

<p><br />
</p>
<table class="simple" style="width: 80%">

<tr style="vertical-align: top;">
<td style="width: 40%"><a  class="image"><img alt="Video Image.png" src="../images/Principal_Component_Analysis/Video_Image.png?v=58041" width="33"  /></a> <a  class="image"><img alt="Video Text Image.png" src="../images/Principal_Component_Analysis/Video_Text_Image.png?v=64565" width="135"  /></a>
<ul><li> <a class="external text" href="https://www.originlab.com/videos/details.aspx?id=41" target="_blank">Principal Component Analysis</a></li></ul>
</td>
<td style="width: 40%"><a  class="image"><img alt="Website blog icon circle.png" src="../images/Principal_Component_Analysis/Website_blog_icon_circle.png?v=64566" width="31"  /></a> <a  class="image"><img alt="Blog Image 33x33px.png" src="../images/Principal_Component_Analysis/Blog_Image_33x33px.png?v=64564" width="135"  /></a>
<ul><li> <a class="external text" href="http://blog.originlab.com/performing-principal-component-analysis-for-chemometric-spectra-using-origins-app" target="_blank">Performing Principal Component Analysis for Chemometric Spectra Using Originâ€™s App</a></li></ul>
</td></tr></table>
<h2><a name="Summary"></a><span class="mw-headline">Summary</span></h2>
<p>Principal Component Analysis is useful for reducing and interpreting large multivariate data sets with underlying linear structures, and for discovering previously unsuspected relationships.  
</p><p>We will start with data measuring protein consumption in twenty-five European countries for nine food groups.  Using Principal Component Analysis, we will examine the relationship between protein sources and these European countries.
</p><p><br />
</p>
<h2><a name="Selecting_Principal_Methods"></a><span class="mw-headline">Selecting Principal Methods</span></h2>
<p>To determine the number of principal components to be retained, we should first run Principal Component Analysis and then proceed based on its result: 
</p>
<ol><li> Open a new project or a new workbook.  Import the data file <b>\samples\Statistics\Protein Consumption in Europe.dat</b></li>
<li> Select the entire worksheet and then select <b>Statistics: Multivariate Analysis: Principal Component Analysis</b>.</li>
<li> Accept the default settings in the open dialog box and click <b>OK</b>.</li>
<li> Select sheet <b>PCA Report</b>. </li>
<li> In the <b>Eigenvalues of the Correlation Matrix</b> table, we can see that the first four principal components explain 86% of the variance and the remaining components each contribute 5% or less.  We will keep four main components.
<dl><dd><a  class="image"><img alt="PCA.png" src="../images/Principal_Component_Analysis/PCA.png?v=14688" width="347"  /></a></dd></dl></li>
<li> A scree plot can be a useful visual aid for determining the appropriate number of principal components.  The number of components depends on the "elbow" point at which the remaining eigenvalues are relatively small and all about the same size.  This point is not very evident in the scree plot, but we can still say the fourth point is our "elbow" point.
<dl><dd><a  class="image"><img alt="Pca scree plot.png" src="../images/Principal_Component_Analysis/Pca_scree_plot.png?v=11830" width="564"  /></a></dd></dl></li>
<li>Click the lock icon <a  class="image"><img alt="Icon Recalculate Manual Green.png" src="../images/Principal_Component_Analysis/Icon_Recalculate_Manual_Green.png?v=1699" width="14"  /></a> in the results tree and select <b>Change Parameters</b> in the context menu.  In the <b>Settings</b> tab, set <b>Number of Components to Extract</b> to <b>4</b>.  Do not close the dialog; in the next steps, we will retrieve component diagrams.
<dl><dd><a  class="image"><img alt="DOC-2411 Pca ex1 dialog1a Magenta.png" src="../images/Principal_Component_Analysis/DOC-2411_Pca_ex1_dialog1a_Magenta.png?v=38932" width="492"  /></a></dd></dl></li></ol>
<h2><a name="Request_Principal_Component_Plots"></a><span class="mw-headline">Request Principal Component Plots</span></h2>
<p>In the <b>Plots</b> tab of the dialog, users can choose whether they want to create a scree plot or a component diagram.
</p>
<ul><li> <b>Scree Plot</b>
<dl><dd>The <b>scree plot</b> is a useful visual aid for determining an appropriate number of principal components.</dd></dl></li>
<li><b>Component Plot</b>
<dl><dd>Component plots show the component score of each observation or component loading of each variable for a pair of principal components.  In the <b>Select Principal Components to Plot</b> group, users can specify which pair of components to plot.  The component plots include:</dd></dl>
<ul><li><b>Loading Plot</b>
<dl><dd>The <b>loading plot</b> is a plot of the relationship between the original variables and the subspace dimension.  It is used to interpret relationships between variables.</dd></dl></li>
<li><b>Score Plot</b>
<dl><dd>The <b>score plot</b> is a projection of data onto subspace.  It is used to interpret relationships between observations.</dd></dl></li>
<li><b>BiPlot</b>
<dl><dd>The <b>biplot</b> shows both the loadings and the scores for two selected components in parallel.</dd></dl></li></ul></li></ul>
<ol><li>In the dialog that was opened in the preceding steps, select the <b>Plots</b> tab.  Make sure <b>Scree Plot</b>, <b>Loading Plot</b>, and <b>Biplot</b> are selected.</li>
<li>The first two components are usually responsible for the bulk of the variance.  This is why we are going to plot the component plot in the space of the first two principal components.  In the <b>Select Principal Components to Plot</b> group, set <b>Principal Component for X Axis</b> to <b>1</b>, and set <b>Principal Component for Y Axis</b> to <b>2</b>.  Click <b>OK</b>.
<dl><dd><a  class="image"><img alt="DOC-2411 Pca ex1 dialog2a Magenta.png" src="../images/Principal_Component_Analysis/DOC-2411_Pca_ex1_dialog2a_Magenta.png?v=70447" width="450"  /></a></dd></dl></li></ol>
<h2><a name="Interpreting_The_Results"></a><span class="mw-headline">Interpreting The Results</span></h2>
<ol><li>In the <b>Correlation Matrix</b>, we can see that the variables are highly correlated.  Many values are greater than <b>0.3</b>.  Principal Component Analysis is an appropriate tool for removing the collinearity.
<dl><dd><a  class="image"><img alt="Pca ex1 correlation matrix.png" src="../images/Principal_Component_Analysis/Pca_ex1_correlation_matrix.png?v=11849" width="779"  /></a></dd></dl></li>
<li>The main component variables are defined as linear combinations of the original variables.  The <b>Extracted Eigenvectors</b> table provides coefficients for equations.
<dl><dd><a  class="image"><img alt="Pca ex1 extracted eigenvectors.png" src="../images/Principal_Component_Analysis/Pca_ex1_extracted_eigenvectors.png?v=11852" width="616"  /></a></dd>
<dd><img src="../images/Principal_Component_Analysis/math-feba1e219cb45c132359767d4d2f958a.png?v=0" title="PC1=0.30261*RedMeat + 0.31056*WhiteMeat + 0.42668*Eggs + 0.37773*Milk + 0.13565*Fish  - 0.43774*Cereals + 0.29725*Starch - 0.42033*Nuts - 0.11042*FruitsVegetables" alt="PC1=0.30261*RedMeat + 0.31056*WhiteMeat + 0.42668*Eggs + 0.37773*Milk + 0.13565*Fish  - 0.43774*Cereals + 0.29725*Starch - 0.42033*Nuts - 0.11042*FruitsVegetables" class="tex"/></dd>
<dd><img src="../images/Principal_Component_Analysis/math-d4ed031400c694c96c1320ee17aa69c4.png?v=0" title="PC2=-0.05625*RedMeat - 0.23685*WhiteMeat - 0.03534*Eggs - 0.18459Milk + 0.64682*Fish - 0.23349*Cereals + 0.35283*Starch + 0.14331*Nuts + 0.53619*FruitsVegetables" alt="PC2=-0.05625*RedMeat - 0.23685*WhiteMeat - 0.03534*Eggs - 0.18459Milk + 0.64682*Fish - 0.23349*Cereals + 0.35283*Starch + 0.14331*Nuts + 0.53619*FruitsVegetables" class="tex"/></dd>
<dd><img src="../images/Principal_Component_Analysis/math-c39f7012f886c0976977d280d68674fd.png?v=0" title="PC3=-0.29758*RedMeat + 0.6239*WhiteMeat + 0.18153*Eggs - 0.38566*Milk - 0.32127*Fish + 0.09592*Cereals + 0.24298*Starch - 0.05439*Nuts + 0.40756*FruitsVegetables" alt="PC3=-0.29758*RedMeat + 0.6239*WhiteMeat + 0.18153*Eggs - 0.38566*Milk - 0.32127*Fish + 0.09592*Cereals + 0.24298*Starch - 0.05439*Nuts + 0.40756*FruitsVegetables" class="tex"/></dd>
<dd><img src="../images/Principal_Component_Analysis/math-f78144df54d05a8bdf0c4323196094ac.png?v=0" title="PC4=0.64648*RedMeat - 0.03699*WhiteMeat + 0.31316Eggs - 0.00332*Milk - 0.21596*Fish - 0.0062*Cereals - 0.33668*Starch + 0.33029*Nuts + 0.46206*FruitsVegetables" alt="PC4=0.64648*RedMeat - 0.03699*WhiteMeat + 0.31316Eggs - 0.00332*Milk - 0.21596*Fish - 0.0062*Cereals - 0.33668*Starch + 0.33029*Nuts + 0.46206*FruitsVegetables" class="tex"/></dd></dl></li>
<li>The <b>Loading Plot</b> reveals the relationships between variables in the space of the first two components.  In the loading plot, we can see that Red Meat, Eggs, Milk, and White Meat have similar heavy loadings for principal component 1.  Fish, fruit, and vegetables, however, have similar heavy loadings for principal component 2.
<dl><dd><a  class="image"><img alt="Pca ex1 loading plot.png" src="../images/Principal_Component_Analysis/Pca_ex1_loading_plot.png?v=14575" width="456"  /></a></dd></dl></li>
<li>The <b>biplot</b> shows both the loadings and the score for two selected components in parallel.  It can reveal the projection of an observation on the subspace with the score points.  It can also find the ratio of observations and variables in the subspace of the first two components.  (Note:  Double-click the graph to open and customize.)</li>
<li>We can use the Data Reader tool <a  class="image"><img alt="Button Data Reader.png" src="../images/Principal_Component_Analysis/Button_Data_Reader.png?v=1579" width="22"  /></a> to open the Data Info window and examine the plot in greater detail. Click on a data point to read component scores for each country. We can see that Spain and Portugal's protein sources differ from those of other European countries.  Spain and Portugal rely on fruits and vegetables, while eastern European countries such as Albania, Bulgaria, Yugoslavia, and Romania prefer cereals and nuts.
<dl><dd><a  class="image"><img alt="Pca ex1 biplot.png" src="../images/Principal_Component_Analysis/Pca_ex1_biplot.png?v=44699" width="577"  /></a></dd></dl></li></ol>
<table class="note">

<tr>
<td>To display country information in the <b>Data Info</b> window, as in the image above:
<ol><li>Right-click the <b>Data Info</b> window and select <b>Preferences...</b>.</li>
<li>Highlight <i>Country</i> in the left-panel, then click the Select button (the right-pointing arrow) to add Country to the Data Info display, then click <b>OK</b>.
<dl><dd><a  class="image"><img alt="Pca data info settings.png" src="../images/Principal_Component_Analysis/Pca_data_info_settings.png?v=60210" width="716"  /></a></dd></dl></li></ol>
<p><b>Note</b>: Since Origin 2019, you can simply hover on a data point to show a tooltip with data point coordinate information. Both the tooltip and the Data Info display are customizable. See <a class="external text" href="../../UserGuide/UserGuide/Data_info_Tool.html">The Data Info Window and Data Point Tooltip</a> for more information.
</p>
</td></tr></table>
<p><br />
</p>
<h2><a name="Create_3D_Components_Plot"></a><span class="mw-headline">Create 3D Components Plot</span></h2>
<ol><li>Click the lock icon <a  class="image"><img alt="Icon Recalculate Manual Green.png" src="../images/Principal_Component_Analysis/Icon_Recalculate_Manual_Green.png?v=1699" width="14"  /></a> in the results tree and select <b>Change Parameters</b> in the context menu.  </li>
<li>In the <b>Plots</b> tab,  set <b>Components Plot Type</b> to <b>3D</b>. And enter <b>4</b> in the <b>Principal Component for Z Axis</b>.
<dl><dd><a  class="image"><img alt="PCA 3D plot 01.png" src="../images/Principal_Component_Analysis/PCA_3D_plot_01.png?v=70495" width="450"  /></a></dd></dl></li>
<li> Click <b>OK</b> to close the dialog. Then the PCA Plot Data and 3D loading plot  will be created as follows. 
<dl><dd><a  class="image"><img alt="PCA 3D plot 02.png" src="../images/Principal_Component_Analysis/PCA_3D_plot_02.png?v=70496" width="796"  /></a></dd>
<dd><a  class="image"><img alt="PCA 3D plot 03.png" src="../images/Principal_Component_Analysis/PCA_3D_plot_03.png?v=70497" width="583"  /></a></dd></dl></li></ol>
<p><br />
</p>





