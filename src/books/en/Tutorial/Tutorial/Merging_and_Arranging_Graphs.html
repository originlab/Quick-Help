<h1 class="firstHeading">6.3.1 Merging and Arranging Graphs</h1><p class='urlname' style='display: none'>Customize-Merge-Arrange-Graph</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Summary"><span class="tocnumber">1</span> <span class="toctext">Summary</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#What_you_will_learn"><span class="tocnumber">2</span> <span class="toctext">What you will learn</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Aligning_Layers_using_the_Object_Edit_Toolbar"><span class="tocnumber">3</span> <span class="toctext">Aligning Layers using the Object Edit Toolbar</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Displaying_Opposite_Axes_with_a_Nonlinear_Formula"><span class="tocnumber">4</span> <span class="toctext">Displaying Opposite Axes with a Nonlinear Formula</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Using_Layer_Management_to_Link_and_Position_Layers"><span class="tocnumber">5</span> <span class="toctext">Using Layer Management to Link and Position Layers</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Merge_Multiple_Graphs"><span class="tocnumber">6</span> <span class="toctext">Merge Multiple Graphs</span></a></li>
</ul>
</div>

<p><br />
</p>
<table class="simple" style="width: 80%">

<tr style="vertical-align: top;">
<td style="width: 40%"><a  class="image"><img alt="Video Image.png" src="../images/Merging_and_Arranging_Graphs/Video_Image.png?v=58041" width="33"  /></a> <a  class="image"><img alt="Video Text Image.png" src="../images/Merging_and_Arranging_Graphs/Video_Text_Image.png?v=64565" width="135"  /></a>
<ul><li> <a class="external text" href="https://www.originlab.com/videos/details.aspx?id=57" target="_blank">Link Graph Layers</a></li>
<li> <a class="external text" href="https://www.originlab.com/videos/details.aspx?id=372" target="_blank">Align legend, multi-line text, layer &amp; text</a></li>
<li> <a class="external text" href="https://www.originlab.com/videos/details.aspx?id=166" target="_blank">Merge Graphs</a></li>
<li> <a class="external text" href="https://www.originlab.com/videos/details.aspx?id=346" target="_blank">Merge 2D and 3D Graphs into one Window</a></li>
<li> <a class="external text" href="https://www.originlab.com/videos/details.aspx?id=316" target="_blank">Merge Graphs in Specified Order and Label Them</a></li></ul>
</td>
<td style="width: 40%"><a  class="image"><img alt="Website blog icon circle.png" src="../images/Merging_and_Arranging_Graphs/Website_blog_icon_circle.png?v=64566" width="31"  /></a> <a  class="image"><img alt="Blog Image 33x33px.png" src="../images/Merging_and_Arranging_Graphs/Blog_Image_33x33px.png?v=64564" width="135"  /></a>
<ul><li> <a class="external text" href="http://blog.originlab.com/make-stacked-graph-with-same-axis-unit-length" target="_blank">Make Stacked Graph with Same Axis Unit Length</a></li>
<li> <a class="external text" href="http://blog.originlab.com/plot-multi-panel-graphs-by-group" target="_blank">Plot Multi-Panel Graphs by Group</a></li></ul>
</td></tr></table>
<h2><a name="Summary"></a><span class="mw-headline">Summary</span></h2>
<p>The <b>Merge Graph Windows</b> dialog allows you to select which graphs you wish to combine, choosing from any graph in the project. It also has controls to specify how you want the individual graphs arranged on the new page. 
</p><p>The <b>Object Edit</b> toolbar allows you to quickly align and size multiple layers.
</p><p>The <b>Layer Management</b> dialog lets you add, arrange and link layers on a single graph page.
</p><p>The <b>Mini Toolbar</b>(Since Origin 2020) lets you edit the graph elements more easily and interactively.
</p>
<h2><a name="What_you_will_learn"></a><span class="mw-headline">What you will learn</span></h2>
<p>This tutorial will show you how to:
</p>
<ul><li>Resize and align layers quickly</li>
<li>Add a second axis using a nonlinear relationship with the primary axis</li>
<li>Use Layer Management for more complex layer positioning and linking</li>
<li>Merge multiple graphs into one graph</li></ul>
<h2><a name="Aligning_Layers_using_the_Object_Edit_Toolbar"></a><span class="mw-headline">Aligning Layers using the Object Edit Toolbar</span></h2>
<ol>
<li>Select <b>File:Open</b> and open the OPJ <b>\<i>Samples</i>\<i>Graphing</i>\<i>Layer Management.opj</i></b> and go to the subfolder <b><i>Arranging Layers</i></b>. (If you don't see the subfolders, click <b>View: Project Explorer</b> to open the Origin Project Explorer window.)
</li>
<li>We want to use the <b>Object Edit</b> tools to rearrange the graph so make sure that this toolbar is visible. If it is not, you can open it from the <b>View: Toolbars</b> dialog box.<br />
<a  class="image"><img alt="Tutorial81 Merging and Arranging Graphs Object Toolbar.png" src="../images/Merging_and_Arranging_Graphs/Tutorial81_Merging_and_Arranging_Graphs_Object_Toolbar.png?v=5299" width="389"  /></a>
</li>
<li>On the graph, hold the <b>Shift</b> key down and click on all four layers to select them as a group. Press the <b>Uniform Width</b> <a  class="image"><img alt="Button Uniform Width.png" src="../images/Merging_and_Arranging_Graphs/Button_Uniform_Width.png?v=1611" width="23"  /></a> and <b>Uniform Height</b> <a  class="image"><img alt="Button Uniform Height.png" src="../images/Merging_and_Arranging_Graphs/Button_Uniform_Height.png?v=1612" width="23"  /></a> buttons on the <b>Object Edit</b> toolbar to apply a uniform height and width. Then click on the white space in the layer to deselect all graph layers.
</li>
<li>Hold <b>Shift</b> key to click and select the bottom two layers and then click the <b>Bottom</b> <a  class="image"><img alt="Button Bottom.png" src="../images/Merging_and_Arranging_Graphs/Button_Bottom.png?v=1608" width="23"  /></a> button on the Object Edit toolbar to align them. Click on the white space in the layer to deselect all graph layers.
<li>Hold <b>Shift</b> key to click and select the top two layers, then click the <b>Top</b> <a  class="image"><img alt="Button Top.png" src="../images/Merging_and_Arranging_Graphs/Button_Top.png?v=1607" width="23"  /></a> button to align them. Click on the white space in the layer to deselect all graph layers.
</li>
<li>Click and select the top and bottom in the left column, and click the <b>Left</b> align <a  class="image"><img alt="Button Left.png" src="../images/Merging_and_Arranging_Graphs/Button_Left.png?v=1605" width="23"  /></a>. Click on the white space in the layer to deselect all graph layers.
<li>Click and select the two in the right column and click the <b>Right</b> align <a  class="image"><img alt="Button Right.png" src="../images/Merging_and_Arranging_Graphs/Button_Right.png?v=1606" width="23"  /></a> button.
</li>
<li>Do not save changes to your project, as the same project will be used later to demonstrate the usage of Layer Management.</li>
</ol>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Merging_and_Arranging_Graphs/Tip_icon.png?v=8477" width="57"  border="0" /></td><td><p>The Object Edit toolbar provides a quick way to align and resize layers. The first layer you select is the reference layer and all others are adjusted relative to the first-selected layer.  The <b>Layer Management</b> tool provides additional options such as layer reordering and linking.
</p></td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Merging_and_Arranging_Graphs/Tip_icon.png?v=8477" width="57"  border="0" /></td><td><p>Another way to select layers in a multiple layer graph is to press CTRL or SHIFT while clicking on the graph layer icons.
</p></td></tr></table>
<h2><a name="Displaying_Opposite_Axes_with_a_Nonlinear_Formula"></a><span class="mw-headline">Displaying Opposite Axes with a Nonlinear Formula</span></h2>
<p>An Origin 2D graph layer is a set of X, Y axes, and opposite axes can be turned on for both X and Y. In addition, the opposite axes can also display labels using any user-specified nonlinear formula with respect to the primary axis.
</p>
<ol>
<li>Using the Project Explorer window, switch to the subfolder named <b>Nonlinear Axis</b>.
</li>
<li>Activate the graph window, click on the bottom X axis lines, the minitoolbar will pop up. Click the Show Opposite Axis button to show the top X axis.<br /> 
<a  class="image"><img alt="Merging and Arranging Graphs b1.png" src="../images/Merging_and_Arranging_Graphs/Merging_and_Arranging_Graphs_b1.png?v=61411" width="520"  /></a></li>
<li>Then, the top X will appear on the layer. Click on the axis line to expand the minitoolbar, click the <b>Show Tick Labels</b> button to show the axis labels and then click <b>Tick Style</b> button to set the tick to <b>In</b>.
<br /> 
<a  class="image"><img alt="Merging and Arranging Graphs b2.png" src="../images/Merging_and_Arranging_Graphs/Merging_and_Arranging_Graphs_b2.png?v=61412" width="632"  /></a></li>
<li>Double-click on the axis labels of top X axis to open the <b>Tick Labels</b> tab of <b>Axis</b> dialog. We want to display the labels on the top axis in units of Energy and the relationship between wavelength(bottom X) and energy(top X) is:<br />
Energy (eV) = 1240/Wavelength (nm). So enter <i>1240/x</i> in the <b>Formula</b> box. <br />
<a  class="image"><img alt="Merging and Arranging Graphs 001.png" src="../images/Merging_and_Arranging_Graphs/Merging_and_Arranging_Graphs_001.png?v=48833" width="440"  /></a> </li>
<li>Click OK button. The axis labels shows the correct relationship with bottom X. 
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Merging_and_Arranging_Graphs/Tip_icon.png?v=8477" width="57"  border="0" /></td><td><ul><li> If you are setting up a nonlinear relationship for the right Y-axis, in the <b>Formula</b> you still need to use <b>x</b> instead of <b>y</b>.</li>
<li> You can also do similar settings in the <b>Graph: Layer Management</b> dialog to add such opposite axis:<br /></li></ul>
<p><a  class="image"><img alt="Tutorial81 Merging and Arranging Graphs LM Top Axis.png" src="../images/Merging_and_Arranging_Graphs/Tutorial81_Merging_and_Arranging_Graphs_LM_Top_Axis.png?v=32905" width="513"  /></a>
</p></td></tr></table>
</li>
<li>Add a text object <b>Energy (eV)</b> as the top X-axis title (after creating this text object, right-click on it and choose <b>Properties</b>; then click the <b>Programming</b> tab and make sure that <b>Attach to</b> = <i>Layer Frame</i>).
<br /><a  class="image"><img alt="Tutorial81 Merging and Arranging Graphs Change Title.png" src="../images/Merging_and_Arranging_Graphs/Tutorial81_Merging_and_Arranging_Graphs_Change_Title.png?v=61416" width="447"  /></a>
</li>
<li>In the above image, the first tick label of the top axis is a missing value for energy that corresponds to zero wavelength. To hide it,  click on the top axis line to show up the mini toolbar, click the <b>Axis Dialogs</b> button to select <b>Special Ticks</b> from the context menu open the <b>Special Ticks</b> dialog.<br />
<a  class="image"><img alt="Merging and Arranging Graphs b3.png" src="../images/Merging_and_Arranging_Graphs/Merging_and_Arranging_Graphs_b3.png?v=61422" width="520"  /></a></li>
<li>In the opened dialog, select <b>Axis Begin</b> at the left panel and then select <b>Hide</b> for the <b>Show</b> drop-down list. Click <b>OK</b> to apply the settings and close the dialog.
<br /><a  class="image"><img alt="Tutorial81 Merging and Arranging Graphs Hide Tick.png" src="../images/Merging_and_Arranging_Graphs/Tutorial81_Merging_and_Arranging_Graphs_Hide_Tick.png?v=61423" width="543"  /></a>
</li>
</ol>
<h2><a name="Using_Layer_Management_to_Link_and_Position_Layers"></a><span class="mw-headline">Using Layer Management to Link and Position Layers</span></h2>
<p>The Layer Management tool can be used to position, resize, swap, and link layers:
</p>
<ol>
<li>Reopen the project <b>\<i>Samples</i>\<i>Graphing</i>\<i>Layer Management.opj</i></b> and then switch to the subfolder named <b><i>Arranging Layers</i></b>.  You can reopen the project by selecting <b>File: Recent Projects: Layer Management.opj</b>.  Do not save changes to the project.
</li>
<li>Bring up the <b>Layer Management</b> tool from <b>Graph: Layer Management</b>. In the left panel, double-click on the name to rename the layers so that they are, top to bottom: Peak 1, Peak 2, Peak 3, Peak 4.  The layer names now correspond to the legend for each layer. 
<br />
<a  class="image"><img alt="Tutorial81 Merging and Arranging Graphs LM Left Panel.png" src="../images/Merging_and_Arranging_Graphs/Tutorial81_Merging_and_Arranging_Graphs_LM_Left_Panel.png?v=61427" width="547"  /></a>
</li>
<li>Now switch to the <b>Arrange</b> tab and do the following: 
<ol>
<li>Check <b>Show Axes Frame</b>.  
<li>Set <b>Horizontal Gap</b> and <b>Vertical Gap</b> to 0.<br />
<a  class="image"><img alt="Tutorial81 Merging and Arranging Graphs Arrange Tab.png" src="../images/Merging_and_Arranging_Graphs/Tutorial81_Merging_and_Arranging_Graphs_Arrange_Tab.png?v=42837" width="589"  /></a></li>
<li>Click <b>Apply</b>.  
</ol>
<p>This resizes and repositions the layers so they are aligned, and hides ticks and labels where layers overlap. 
</p>
</li>
<li>Go to the <b>Axes</b> tab, hold down the <b>CTRL</b> key and select Peak 1 and 3 on left list, then expand the <b>Left</b> branch and set tick direction to <b>In</b>, and click <b>Apply</b>. <br />
<a  class="image"><img alt="Tutorial81 Merging and Arranging Graphs Axes Tab.png" src="../images/Merging_and_Arranging_Graphs/Tutorial81_Merging_and_Arranging_Graphs_Axes_Tab.png?v=48835" width="510"  /></a>
</li>
<li>Now select Peaks 3 and 4, set the <b>Bottom</b> tick direction to <b>In</b> and click <b>Apply</b>.  Then select Peaks 1 and 2, set the <b>Top</b> ticks to <b>In</b> and click <b>Apply</b>.
</li>
<li>Go to the <b>Link</b> tab and select Peaks 2, 3, and 4 in the left list and link them to layer 1, making sure you have the X-Axes linked <b>Straight(1 to 1)</b>, and click <b>Apply</b>.<br />
<a  class="image"><img alt="Tutorial81 Merging and Arranging Graphs Link Tab.png" src="../images/Merging_and_Arranging_Graphs/Tutorial81_Merging_and_Arranging_Graphs_Link_Tab.png?v=48836" width="626"  /></a><br />
Click <b>OK</b> to close the dialog box.
</li>
<li>Click and select the top left layer, layer 1, then drag and resize the layer, then move the layer.  Note that the child layers resize and move too, since they are dimensionally linked to layer 1.<br />
<a  class="image"><img alt="Tutorial81 Merging and Arranging Graphs Resize Layer.png" src="../images/Merging_and_Arranging_Graphs/Tutorial81_Merging_and_Arranging_Graphs_Resize_Layer.png?v=5314" width="361"  /></a>
</li>
<li>Click on the Top axis of Layer 1, and then click the <b>Axis Scale</b> button in the mini toolbar,  the <b>Axis Scale</b> dialog will be opened. Change the scale <b>From</b> <i>10</i> <b>To</b> <i>35</i>, and click <b>OK</b>. You'll see that all the other layers now display the same X-axis scale range.<br />
<a  class="image"><img alt="Tutorial81 Merging and Arranging Graphs Link X Axis.png" src="../images/Merging_and_Arranging_Graphs/Tutorial81_Merging_and_Arranging_Graphs_Link_X_Axis.png?v=62113" width="800"  /></a>
</li>
<li>With the graph active, choose <b>Graph: Fix Scale Factors</b>. This will reset all text labels on the page -- axis titles, tick labels, legend text -- to their true font size. </li>
<li>Finally,  using the Mini Toolbar <b>Font Size</b> drop-down, change axis tick labels and legend text to <b>Font Size</b> = <i>18</i>. Change axis titles to <b>Font Size</b> = <i>22</i>.</li>
</ol>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Merging_and_Arranging_Graphs/Tip_icon.png?v=8477" width="57"  border="0" /></td><td><p>If the layers are linked, they are treated as one unit. If you need to rearrange layers, you should first unlink them. You can re-link layers after arranging.
</p></td></tr></table>
<h2><a name="Merge_Multiple_Graphs"></a><span class="mw-headline">Merge Multiple Graphs</span></h2>
<p>In this section, we merge two graphs from different subfolders of the same project while treating the four layers in one graph as a unit.
</p>
<ol>
<li>Click on the <b>Rescale</b> button when the Graph 1 in the <b>Arranging Layers</b> subfolder is active.

<li>Select <b>Graph: Merge Graph Windows</b> in the main menu to open the dialog.

<li>Do the following:
<ul><li>Click the triangle button to the right of <b>Graphs</b> and from the flyout menu choose <b>All in Project</b>. <b>Graph1</b> and <b>Graph2</b> will show in the <b>Preview</b> panel (not shown).</li>
<li>Make sure <b>Number of Rows</b> = <b>2</b> and <b>Number of Columns</b> = <b>1</b>. </li>
<li>Make sure <b>Treat Each Source Graph As a Unit</b> is selected. </li></ul>

<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Merging_and_Arranging_Graphs/Tip_icon.png?v=8477" width="57"  border="0" /></td><td><p>When <b>Page Setup</b> &gt; <b>Orientation</b> = <i>Auto</i>, the final page size will be determined by the sum of the layer sizes plus margins/gaps and will therefore, be larger than the original page size. If you want to preserve the original page size, set <b>Orientation</b> = <i>Landscape</i> or <i>Portrait</i> and adjust gaps and margins, accordingly.
</p></td></tr></table>
<dl><dd><a  class="image"><img alt="Merging Graphs01.png" src="../images/Merging_and_Arranging_Graphs/Merging_Graphs01.png?v=67428" width="789"  /></a></dd></dl>
</li>
<li>Click <b>OK</b> to close the dialog box. A new merged graph page is created:
<br /><a  class="image"><img alt="Merging Graphs02.png" src="../images/Merging_and_Arranging_Graphs/Merging_Graphs02.png?v=67429" width="456"  /></a>
<ol></ol>
</li>
</li>
</li>
</ol>


