<h1 class="firstHeading">9.3.1 Import Data from a Database</h1><p class='urlname' style='display: none'>ImpData-from-DB</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Summary"><span class="tocnumber">1</span> <span class="toctext">Summary</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#What_you_will_learn"><span class="tocnumber">2</span> <span class="toctext">What you will learn</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Steps"><span class="tocnumber">3</span> <span class="toctext">Steps</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Import_data_using_SQL_Editor"><span class="tocnumber">3.1</span> <span class="toctext">Import data using SQL Editor</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Reimport_from_Database"><span class="tocnumber">3.2</span> <span class="toctext">Reimport from Database</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#LabTalk_Support_in_SQL_Editor"><span class="tocnumber">3.3</span> <span class="toctext">LabTalk Support in SQL Editor</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="Summary"></a><span class="mw-headline">Summary</span></h2>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Import_Data_from_a_Database/Alert_icon.png?v=0" width="57"  border="0" /></td><td><p>The database used in this tutorial has been set up on Microsoft Azure. 
</p>
	</td>
	</tr>
	</table>
<p>This tutorial shows  how to build the connection to a SQL server and extract desired data from specified tables using Origin's SQL Editor, define LabTalk variable in SQL script for easy modification, and save connect or connection &amp; query for future use. 
</p><p>The procedure is based on Origin 2023b.
</p>
<h2><a name="What_you_will_learn"></a><span class="mw-headline">What you will learn</span></h2>
<p>This tutorial will show you how to:
</p>
<ul><li> Import data from database.</li>
<li> Reimport data.</li>
<li> LabTalk support in the SQL Editor.</li></ul>
<h2><a name="Steps"></a><span class="mw-headline">Steps</span></h2>
<h3><a name="Import_data_using_SQL_Editor"></a><span class="mw-headline">Import data using SQL Editor</span></h3>
<ol>
<li> Start a new worksheet. Select from menu <b>Data: Connect to Database: New...</b>. In the <b>Database Connector</b> dialog, select <b>ODBC driver</b> and click <b>OK</b>.</li>
<p><a  class="image"><img alt="NewDB1.png" src="../images/Import_Data_from_a_Database/NewDB1.png?v=72138" width="336"  /></a><br />
<br />
<a  class="image"><img alt="NewDB2.png" src="../images/Import_Data_from_a_Database/NewDB2.png?v=72139" width="332"  /></a><br />
</p>
<li>Create the connection to a sample database. Specify the server information, including the log-in user name and password with the settings below:
<pre class="sql" style="font-family:monospace;">Server Driver<span style="color: #66cc66;">=</span><span style="color: #993333; font-weight: bold;">SQL</span> Server;
Server<span style="color: #66cc66;">=</span>olab<span style="color: #66cc66;">.</span><span style="color: #993333; font-weight: bold;">DATABASE</span><span style="color: #66cc66;">.</span>windows<span style="color: #66cc66;">.</span>net;
Port<span style="color: #66cc66;">=</span><span style="color: #cc66cc;">1433</span>;
<span style="color: #993333; font-weight: bold;">USER</span> Name<span style="color: #66cc66;">=</span>Olabts;
Password<span style="color: #66cc66;">=</span>Origin2023;</pre>
<p><a  class="image"><img alt="NewDB3.png" src="../images/Import_Data_from_a_Database/NewDB3.png?v=72143" width="331"  /></a><br />
<br />
Click the <b>Test</b> button to make sure the connection is successful. 
</p>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Import_Data_from_a_Database/Alert_icon.png?v=0" width="57"  border="0" /></td><td><p>If it fails to connect to the database, go to <a class="external text" href="https://learn.microsoft.com/en-us/sql/connect/odbc/download-odbc-driver-for-sql-server?view=sql-server-ver16" target="_blank">this</a> page to download and install the latest ODBC SQL driver. 
</p>
	</td>
	</tr>
	</table>
</li>
<li> Click the <a  class="image"><img alt="NewDB5.png" src="../images/Import_Data_from_a_Database/NewDB5.png?v=72147" width="21"  /></a> button to the right of the Database entry and make sure database <b>sample1</b> shows. <br />
Click the <b>OK</b> button to open the <b>SQL Editor</b> dialog. <br />
<li>All tables in the database are listed in the left panel. <br />
<a  class="image"><img alt="NewDB4.png" src="../images/Import_Data_from_a_Database/NewDB4.png?v=72144" width="709"  /></a><br />
<br /><i>Select menu <b>File: Show Connection String</b>, the connection string will show at the Message panel below. Alternatively, you can use this connection string in step 2 to create the connection.<br /></i>
<pre class="sql" style="font-family:monospace;">Driver<span style="color: #66cc66;">=</span><span style="color: #66cc66;">&#123;</span><span style="color: #993333; font-weight: bold;">SQL</span> Server<span style="color: #66cc66;">&#125;</span>;Server<span style="color: #66cc66;">=</span>olab<span style="color: #66cc66;">.</span><span style="color: #993333; font-weight: bold;">DATABASE</span><span style="color: #66cc66;">.</span>windows<span style="color: #66cc66;">.</span>net;Port<span style="color: #66cc66;">=</span><span style="color: #cc66cc;">1433</span>;<span style="color: #993333; font-weight: bold;">DATABASE</span><span style="color: #66cc66;">=</span>sample1;Uid<span style="color: #66cc66;">=</span>Olabts;Pwd<span style="color: #66cc66;">=</span>Origin2023;</pre>
</li>
<li> Select <b>File: Save Connection As...</b> to save the data source file as <i>MyDataSource.ods</i>.</li>
<li> Now we are going to extract data from the <b>Product</b> table to construct the product list. You can write SQL script from scratch. Double click node on left panel will help you add the table and field name in the editor. Create the query following the video below or copy the following SQL script in the right panel.<br />
<pre class="sql" style="font-family:monospace;"><span style="color: #993333; font-weight: bold;">SELECT</span> Name <span style="color: #66cc66;">,</span>ListPrice <span style="color: #66cc66;">,</span>SellStartDate <span style="color: #66cc66;">,</span>SellEndDate <span style="color: #66cc66;">,</span>ThumbNailPhoto  <span style="color: #993333; font-weight: bold;">FROM</span> SalesLT<span style="color: #66cc66;">.</span>Product</pre>
<p><a  class="image"><img alt="NewDB6.gif" src="../images/Import_Data_from_a_Database/NewDB6.gif?v=72149" width="934"  /></a><br />
</p>
</li>
<li> Click the <b>Preview the result data</b> button <a  class="image"><img alt="SQL editor preview.png" src="../images/Import_Data_from_a_Database/SQL_editor_preview.png?v=28236" width="25"  /></a> to preview the data. Select <b>File: Save Connection and Query As...</b> from menu to save the connection and query as <i>MyQuery.odq</i>. In the future, you can load the connection settings and the query script from menu <b>Data: Connect to database: MyQuery.odq</b>.</li>. 
<li> Click the <b>OK</b> button to import the data. Once imported, the worksheet is connected to the database, and a yellow icon will appear at the top-left of the worksheet.<br />
<a  class="image"><img alt="NewDB7.png" src="../images/Import_Data_from_a_Database/NewDB7.png?v=72153" width="741"  /></a></li>
</ol>
<h3><a name="Reimport_from_Database"></a><span class="mw-headline">Reimport from Database</span></h3>
<p>After the data is imported, the connection and the query are automatically saved in the data connector. You can click the <b>Database Connector</b> <a  class="image"><img alt="DBConnector.png" src="../images/Import_Data_from_a_Database/DBConnector.png?v=72156" width="20"  /></a> and select <b>Import</b> to import the data from the database again. Try the following steps.
</p>
<ol><li> Click <a  class="image"><img alt="DBConnector.png" src="../images/Import_Data_from_a_Database/DBConnector.png?v=72156" width="20"  /></a>, and select <b>Unlock Imported Data</b>.</li>
<li> Delete or make change to some data in the worksheet.</li>
<li> Click <a  class="image"><img alt="DBConnector.png" src="../images/Import_Data_from_a_Database/DBConnector.png?v=72156" width="20"  /></a> and select <b>Import</b>. The data should be back.</li>
<li> To modify the query, with the worksheet active, click <a  class="image"><img alt="DBConnector.png" src="../images/Import_Data_from_a_Database/DBConnector.png?v=72156" width="20"  /></a> and choose <b>SQL Editor</b>.</li>
<li> To setup a new SQL Query for same database, do one of the following
<ul><li> Duplicate the workbook (<b>Window: Duplicate</b> menu). In new book, click <a  class="image"><img alt="DBConnector.png" src="../images/Import_Data_from_a_Database/DBConnector.png?v=72156" width="20"  /></a> and choose SQL Editor to edit the query.</li>
<li> Start a new workbook. Choose <b>Data: Connect to DataBase</b> menu.  All saved and ODS and ODQ files are listed here.</li></ul></li>
<li> Choose MyQuery.ODQ. The DataBase Editor dialog will open with the saved SQL query. Click <b>OK</b> button to import.</li></ol>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Import_Data_from_a_Database/Tip_icon.png?v=8477" width="57"  border="0" /></td><td><p>By default, the imported data are not saved with the project (OPJU file) since big database can make OPJU file huge. If you do want to save the data with the project, click <a  class="image"><img alt="DBConnector.png" src="../images/Import_Data_from_a_Database/DBConnector.png?v=72156" width="20"  /></a> and uncheck <b>Exclude Imported When Saving</b>.  Then save the project.
</p></td></tr></table>
<h3><a name="LabTalk_Support_in_SQL_Editor"></a><span class="mw-headline">LabTalk Support in SQL Editor</span></h3>
<p>Now let's make changes to the SQL query to only retrieve the products with a unit price of less than $10. This section will show you how to define a Labtalk numeric variable of the price in the condition so it's easier to change the query in the future. 
</p>
<ol>
<li>Click <a  class="image"><img alt="DBConnector.png" src="../images/Import_Data_from_a_Database/DBConnector.png?v=72156" width="20"  /></a> and choose <b>SQL Editor</b></li>
<li>To add a Labtalk numeric variable, select <b>Query: LabTalk...</b> to open the <b>LabTalk Support Setting</b> dialog.<br />
<a  class="image"><img alt="Db LT Script1.png" src="../images/Import_Data_from_a_Database/Db_LT_Script1.png?v=72167" width="532"  /></a> </li>
<li> Check the <b>Enable LabTalk (%,$) substitution</b> checkbox.</li> 
<li> Type the script below to define a LabTalk numeric variable <b>priceToCompare</b>.  <pre class="lt" style="font-family:monospace;">double priceToCompare <span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span>;</pre> in the <b>Before Query Script</b> box. Click <b>OK</b>.<br />
<a  class="image"><img alt="Db LT Script2.png" src="../images/Import_Data_from_a_Database/Db_LT_Script2.png?v=72168" width="532"  /></a></li>
<li> At the end of SQL Script on the right panel, add <pre class="sql" style="font-family:monospace;"> <span style="color: #993333; font-weight: bold;">WHERE</span> ListPrice <span style="color: #66cc66;">&lt;</span> $<span style="color: #66cc66;">&#40;</span>priceToCompare<span style="color: #66cc66;">&#41;</span></pre> </li>
<li>Click the <a  class="image"><img alt="Db editor labtalk.png" src="../images/Import_Data_from_a_Database/Db_editor_labtalk.png?v=32572" width="23"  /></a> button to preview the SQL query string with LabTalk variable substituted in the SQL Editor box.<br /> 
<a  class="image"><img alt="Db LT import preview.png" src="../images/Import_Data_from_a_Database/Db_LT_import_preview.png?v=72169" width="686"  /></a></li>
<li> Click <b>OK</b> to import these data. </li>
<li>From now on, you only need to change the priceToCompare  value in <b>LabTalk Support Settings</b> dialog. No need to change the SQL Query.</li>
</ol>


