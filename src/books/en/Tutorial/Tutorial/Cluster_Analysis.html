<h1 class="firstHeading">5.6.2 Cluster Analysis</h1><p class='urlname' style='display: none'>Cluster-Analysis</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Summary"><span class="tocnumber">1</span> <span class="toctext">Summary</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Hierarchical_Cluster_Analysis"><span class="tocnumber">2</span> <span class="toctext">Hierarchical Cluster Analysis</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Analyzing_Original_Data_with_K-Means_Cluster"><span class="tocnumber">3</span> <span class="toctext">Analyzing Original Data with K-Means Cluster</span></a></li>
</ul>
</div>

<p><br />
</p>
<table class="simple" style="width: 80%">

<tr style="vertical-align: top;">
<td style="width: 40%"><a  class="image"><img alt="Video Image.png" src="../images/Cluster_Analysis/Video_Image.png?v=58041" width="33"  /></a> <a  class="image"><img alt="Video Text Image.png" src="../images/Cluster_Analysis/Video_Text_Image.png?v=64565" width="135"  /></a>
<ul><li> <a class="external text" href="https://www.originlab.com/videos/details.aspx?id=343" target="_blank">Cluster Analysis in OriginPro</a></li></ul>
</td>
<td style="width: 40%"><a  class="image"><img alt="Website blog icon circle.png" src="../images/Cluster_Analysis/Website_blog_icon_circle.png?v=64566" width="31"  /></a> <a  class="image"><img alt="Blog Image 33x33px.png" src="../images/Cluster_Analysis/Blog_Image_33x33px.png?v=64564" width="135"  /></a>
<ul><li> <a class="external text" href="http://blog.originlab.com/dendrograms-in-originpro-2020" target="_blank">Dendrograms in OriginPro 2020</a></li>
<li> <a class="external text" href="http://blog.originlab.com/performing-principal-component-analysis-for-chemometric-spectra-using-origins-app" target="_blank">Performing Principal Component Analysis for Chemometric Spectra Using Originâ€™s App</a></li></ul>
</td></tr></table>
<h2><a name="Summary"></a><span class="mw-headline">Summary</span></h2>
<p>We will perform cluster analysis for the mean temperatures of US cities over a 3-year-period.  
</p><p>The starting point is a hierarchical cluster analysis with randomly selected data in order to find the best method for clustering.  K-means analysis, a quick cluster method, is then performed on the entire original dataset.
</p>
<p class="version" >Minimum Origin Version Required: Updated Origin 2020</p>
<h2><a name="Hierarchical_Cluster_Analysis"></a><span class="mw-headline">Hierarchical Cluster Analysis</span></h2>
<ol><li> Start with a new project or a new workbook. Import the data file <b>\Samples\Graphing\US Mean Temperature.dat</b>.</li>
<li> Highlight Column D through Column O.</li>
<li> Select <b>Statistics: Multivariate Analysis: Hierarchical Cluster Analysis</b> and open the dialog.</li>
<li> Select <b>Input</b> tab, click the <b>triangle button</b> <a  class="image"><img alt="Button Select Data Right Triangle.png" src="../images/Cluster_Analysis/Button_Select_Data_Right_Triangle.png?v=26514" width="18"  /></a> next to <b>Variables</b>, and then click <b>Select Columns...</b> in the context menu.
<dl><dd><a  class="image"><img alt="Cluster ex2 hcluster dialog1.png" src="../images/Cluster_Analysis/Cluster_ex2_hcluster_dialog1.png?v=42703" width="567"  /></a></dd></dl></li>
<li> In the lower panel of the Column Browser dialog, click the <b>...</b> button.  Set the data range from <b>1</b> to <b>100</b>.  Click <b>OK</b>.
<dl><dd><a  class="image"><img alt="Cluster ex2 col browser.png" src="../images/Cluster_Analysis/Cluster_ex2_col_browser.png?v=11878" width="700"  /></a></dd></dl></li>
<li> Click on the <b>Settings</b> tab and set <b>Cluster</b> to <b>Observations</b>, and <b>Number of Clusters</b> is <b>1</b>.  For <b>Cluster Method</b>, select <b>Furthest Neighbor</b> and then click <b>OK</b>.
<dl><dd><a  class="image"><img alt="Hcluster ex2 dialog1.png" src="../images/Cluster_Analysis/Hcluster_ex2_dialog1.png?v=42704" width="386"  /></a></dd></dl></li>
<li> Go to the <b>Cluster 1</b> sheet. After examining the resulting dendrogram, we choose to cluster data into 5 groups. 
<dl><dd> <a  class="image"><img alt="Dendrogram2.PNG" src="../images/Cluster_Analysis/Dendrogram2.PNG?v=60289" width="708"  /></a></dd></dl></li>
<li> Click the lock icon in the dendrogram or the result tree, and then click <b>Change Parameters</b> in the context menu.</li>
<li> Set  <b>Number of Clusters</b> to <b>5</b> in the <b>Settings</b> tab and then select the <b>Cluster Center</b> check box in the <b>Quantities</b> tab. Click <b>OK</b>.
<dl><dd><a  class="image"><img alt="Cluster ex2 hcluster dialog.png" src="../images/Cluster_Analysis/Cluster_ex2_hcluster_dialog.png?v=42705" width="386"  /></a></dd>
<dd><a  class="image"><img alt="Cluster ex2 hcluster dialog01.png" src="../images/Cluster_Analysis/Cluster_ex2_hcluster_dialog01.png?v=42287" width="367"  /></a></dd></dl></li>
<li> In the resulting dendrogram, we can clearly see how observations are clustered. Note, that you can double-click on the embedded dendrogram in the report sheeet to open the dendrogram in its own window. From here, you can customize the dendrogram -- for instance, by adding text labels, arrows, etc -- then click the <b>Close</b> button <a  class="image"><img alt="Button close embedded.png" src="../images/Cluster_Analysis/Button_close_embedded.png?v=60297" width="32"  /></a> in the upper-right corner of the graph window to put changes back into the embedded graph in the report sheet.
<dl><dd><a  class="image"><img alt="Hcluster ex2 dendrogram.png" src="../images/Cluster_Analysis/Hcluster_ex2_dendrogram.png?v=60283" width="752"  /></a></dd></dl></li>
<li> To focus in on a particular subtree, click on a node to select it then right-click and choose <b>Duplicate Branch to New Window</b>. This opens the selected subtree in a new graph window.
<dl><dd><a  class="image"><img alt="Dendrogram zoom1.PNG" src="../images/Cluster_Analysis/Dendrogram_zoom1.PNG?v=60285" width="796"  /></a></dd></dl></li></ol>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Cluster_Analysis/Tip_icon.png?v=8477" width="57"  border="0" /></td><td><dl><dd> Note that beginning with Origin 2019b you will find, on the <b>Plot</b> tab of the <b>hcluster</b> dialog, a radio button for displaying <a class="external text" href="../../UserGuide/UserGuide/The_Hierarchical_Cluster_Analysis_Dialog_Box.html#Plot"><b>Similarity</b></a> on the Y axis of your Dendrogram (<b>Distance</b> is still default).</dd></dl>
</td></tr></table>
<h2><a name="Analyzing_Original_Data_with_K-Means_Cluster"></a><span class="mw-headline">Analyzing Original Data with K-Means Cluster</span></h2>
<ol><li> Right-click on <b>Cluster Center</b> and select <b>Create Copy as New Sheet</b> in the context menu. We are going to use the newly created <b>Cluster Center</b> as the <b>Initial Cluster Centers</b> in our k-means cluster analysis.
<dl><dd><a  class="image"><img alt="Cluster ex2 cluster center.png" src="../images/Cluster_Analysis/Cluster_ex2_cluster_center.png?v=11886" width="496"  /></a></dd></dl></li>
<li> Go back to the worksheet with the source data (US Mean Temperature), and highlight col(D) through col(O). Select <b>Statistics: Multivariate Analysis: K-Means Cluster Analysis</b>.</li>
<li> Select the <b>Specify Initial Cluster Centers</b> check box in the <b>Options</b> tab.  Click the <b>interactive button</b> <a  class="image"><img alt="Button Select Data Interactive.png" src="../images/Cluster_Analysis/Button_Select_Data_Interactive.png?v=1685" width="18"  /></a> next to <b>Initial Cluster Centers</b>. The dialog will "roll up".   </li>
<li> Go to <b>Cluster Center</b> and hightlight Col(D) through Col(O).  Click the button on the rolled-up dialog to restore the dialog. </li>
<li> In the <b>Plot</b> tab, select <b>Additional Group Graph</b>. Click the <b>interactive button</b> <a  class="image"><img alt="Button Select Data Interactive.png" src="../images/Cluster_Analysis/Button_Select_Data_Interactive.png?v=1685" width="18"  /></a> next to <b>X Range</b>. The dialog will "roll up". Go back to the source worksheet <b>US Mean Temperature</b>, and highlight <b>Col(B):Longtitude</b>.  Click the button in the rolled up dialog to restore. </li>
<li> Click the <b>triangle button</b><a  class="image"><img alt="Button Select Data Right Triangle.png" src="../images/Cluster_Analysis/Button_Select_Data_Right_Triangle.png?v=26514" width="18"  /></a> next to <b>Y Range</b>, and then select <b>C(Y), Latitude</b>.  Click <b>OK</b>.
<dl><dd><a  class="image"><img alt="Kmeans ex2 dialog.png" src="../images/Cluster_Analysis/Kmeans_ex2_dialog.png?v=70486" width="447"  /></a></dd></dl></li>
<li> Activate the worksheet <b>K-Means Plot Data1</b>.  Observe that data has been clustered into 5 groups corresponding to the latitudes of the cities.
<dl><dd> <a  class="image"><img alt="Group graph.png" src="../images/Cluster_Analysis/Group_graph.png?v=44700" width="421"  /></a></dd></dl></li></ol>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Cluster_Analysis/Tip_icon.png?v=8477" width="57"  border="0" /></td><td><p>User can also select the output destination of <b>Cluster Membership</b> column, such as next to input data, for further operation if needed
<p><a  class="image"><img alt="Cluster Membership.png" src="../images/Cluster_Analysis/Cluster_Membership.png?v=70487" width="586"  /></a>
</p>
</p></td></tr></table>


