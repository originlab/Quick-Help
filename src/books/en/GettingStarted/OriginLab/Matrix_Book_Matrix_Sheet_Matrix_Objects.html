<h1 class="firstHeading">9 Matrix Book Matrix Sheet Matrix Objects</h1><p class='urlname' style='display: none'>Matrix-Book-Matrix-Sheet-Matrix-Objects</p><a  class="image"><img alt="Less grand image matrices 650px.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Less_grand_image_matrices_650px.png?v=62578" width="650"  /></a>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Matrixbooks.2C_Matrixsheets_and_Matrix_Objects"><span class="tocnumber">1</span> <span class="toctext">Matrixbooks, Matrixsheets and Matrix Objects</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Naming_Matrixbooks.2C_Matrixsheets_and_Matrix_Objects"><span class="tocnumber">1.1</span> <span class="toctext">Naming Matrixbooks, Matrixsheets and Matrix Objects</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Different_Views_of_the_Matrix"><span class="tocnumber">1.2</span> <span class="toctext">Different Views of the Matrix</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Matrixbooks"><span class="tocnumber">1.3</span> <span class="toctext">Matrixbooks</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Matrixsheets"><span class="tocnumber">1.4</span> <span class="toctext">Matrixsheets</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Matrix_Objects"><span class="tocnumber">1.5</span> <span class="toctext">Matrix Objects</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Import_Image_to_Matrix"><span class="tocnumber">1.6</span> <span class="toctext">Import Image to Matrix</span></a>
<ul>
<li class="toclevel-3 tocsection-8"><a href="#Image_Thumbnails_and_Image_Slider"><span class="tocnumber">1.6.1</span> <span class="toctext">Image Thumbnails and Image Slider</span></a></li>
<li class="toclevel-3 tocsection-9"><a href="#Naming_Matrix_Objects"><span class="tocnumber">1.6.2</span> <span class="toctext">Naming Matrix Objects</span></a></li>
<li class="toclevel-3 tocsection-10"><a href="#Import_GeoTIFF_to_Matrix"><span class="tocnumber">1.6.3</span> <span class="toctext">Import GeoTIFF to Matrix</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-11"><a href="#Extracting_Information_from_the_Matrixsheet_or_Object"><span class="tocnumber">2</span> <span class="toctext">Extracting Information from the Matrixsheet or Object</span></a></li>
<li class="toclevel-1 tocsection-12"><a href="#Image_Plot"><span class="tocnumber">3</span> <span class="toctext">Image Plot</span></a></li>
<li class="toclevel-1 tocsection-13"><a href="#Image_Window"><span class="tocnumber">4</span> <span class="toctext">Image Window</span></a>
<ul>
<li class="toclevel-2 tocsection-14"><a href="#Image_and_Video_Import"><span class="tocnumber">4.1</span> <span class="toctext">Image and Video Import</span></a>
<ul>
<li class="toclevel-3 tocsection-15"><a href="#Import_GeoTIFF_as_Image"><span class="tocnumber">4.1.1</span> <span class="toctext">Import GeoTIFF as Image</span></a></li>
<li class="toclevel-3 tocsection-16"><a href="#Image_Import_Notes"><span class="tocnumber">4.1.2</span> <span class="toctext">Image Import Notes</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-17"><a href="#Image_Window_Navigation"><span class="tocnumber">4.2</span> <span class="toctext">Image Window Navigation</span></a></li>
<li class="toclevel-2 tocsection-18"><a href="#Image_Resize"><span class="tocnumber">4.3</span> <span class="toctext">Image Resize</span></a></li>
<li class="toclevel-2 tocsection-19"><a href="#Mini_Toolbars_for_Image_Window"><span class="tocnumber">4.4</span> <span class="toctext">Mini Toolbars for Image Window</span></a></li>
<li class="toclevel-2 tocsection-20"><a href="#ROIs_in_the_Image_Window"><span class="tocnumber">4.5</span> <span class="toctext">ROIs in the Image Window</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-21"><a href="#Profiling_Matrix_Data"><span class="tocnumber">5</span> <span class="toctext">Profiling Matrix Data</span></a></li>
<li class="toclevel-1 tocsection-22"><a href="#Setting_Matrix_Values"><span class="tocnumber">6</span> <span class="toctext">Setting Matrix Values</span></a></li>
<li class="toclevel-1 tocsection-23"><a href="#Manipulation_of_Matrix_Data"><span class="tocnumber">7</span> <span class="toctext">Manipulation of Matrix Data</span></a></li>
<li class="toclevel-1 tocsection-24"><a href="#Changing_the_Color_Scheme_of_a_Matrix"><span class="tocnumber">8</span> <span class="toctext">Changing the Color Scheme of a Matrix</span></a></li>
<li class="toclevel-1 tocsection-25"><a href="#Converting_Matrixes_to_Worksheets"><span class="tocnumber">9</span> <span class="toctext">Converting Matrixes to Worksheets</span></a>
<ul>
<li class="toclevel-2 tocsection-26"><a href="#Direct"><span class="tocnumber">9.1</span> <span class="toctext">Direct</span></a></li>
<li class="toclevel-2 tocsection-27"><a href="#XYZ_Columns"><span class="tocnumber">9.2</span> <span class="toctext">XYZ Columns</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-28"><a href="#Converting_Worksheets_to_Matrixes"><span class="tocnumber">10</span> <span class="toctext">Converting Worksheets to Matrixes</span></a></li>
<li class="toclevel-1 tocsection-29"><a href="#Virtual_Matrix"><span class="tocnumber">11</span> <span class="toctext">Virtual Matrix</span></a></li>
<li class="toclevel-1 tocsection-30"><a href="#Topics_for_Further_Reading"><span class="tocnumber">12</span> <span class="toctext">Topics for Further Reading</span></a></li>
</ul>
</div>

<h2><a name="Matrixbooks.2C_Matrixsheets_and_Matrix_Objects"></a><span class="mw-headline">Matrixbooks, Matrixsheets and Matrix Objects</span></h2>
<p>A matrix is a dataset of Z values arranged as an array of columns and rows which are linearly mapped to X and Y values.
<span class="OIndex" style="display:none">Limitations, Matrix</span>
The following table summarizes some important matrixbook limits:
</p>
<table class="simple">
<tr>
<th> Maximum Number of...
</th>
<th> 32Bit OS
</th>
<th> 64Bit OS
</th></tr>
<tr>
<td>
<p><b>Matrixsheets in a matrixbook</b><br />
<b>Matrix objects in a matrixsheet</b><br />
<b>Cells in a matrix (Note)</b><br />
</p>
</td>
<td>
<p>1024&#8224;<br />
65,527<br />
90,000,000<br />
</p>
</td>
<td>
<p>1024&#8224;<br />
65,527<br />
90,000,000<br />
</p>
</td></tr></table>
<p>â€  &gt; 255 sheets requires saving file to Unicode (e.g. *.opju) file format. Unicode formats not compatible with Origin versions prior to Origin 2018 SR0.
</p>
<table class="note">

<tr>
<td><b>Note:</b> The product of any combination of rows and columns must not be greater than 90,000,000.
</td></tr></table>
<h3><a name="Naming_Matrixbooks.2C_Matrixsheets_and_Matrix_Objects"></a><span class="mw-headline">Naming Matrixbooks, Matrixsheets and Matrix Objects</span></h3>
<p><span class="OIndex" style="display:none">Naming Matrixbooks</span>
<span class="OIndex" style="display:none">Matrixbooks, Naming</span>
<span class="OIndex" style="display:none">Matrixsheets, Naming</span>
<span class="OIndex" style="display:none">Naming Matrixsheets</span>
<span class="OIndex" style="display:none">Matrix Objects, Naming</span>
<span class="OIndex" style="display:none">Naming Matrix Objects</span>
</p>
<dl><dd><a  class="image"><img alt="Matrix Book Mult Object 2.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Matrix_Book_Mult_Object_2.png?v=68870" width="574"  /></a><br /><br /></dd></dl>
<table class="dialogcontroltable">

<tr>
<th> Matrixbook
</th>
<td>
<ul><li> The matrixbook has a <b>Short Name</b> whether you display it or not. Origin uses the <b>Short Name</b> for internal operations.</li>
<li> <b>Short Names</b> must be unique within the project file, cannot contain spaces, must begin with a letter, consist only of alphanumeric characters (A to Z and 0 to 9), and limited to 13 characters. You can use lowercase characters and the text will appear as such, but upper and lower case are not unique characters. (You cannot name one matrix MBOOK1 and another mbook1.)</li>
<li> <b>Long Names</b> are optional, need not be unique within the project file, can contain spaces, can begin with a letter, a number or a special character, and the length cannot exceed 520 characters, including spaces.</li></ul>
</td></tr>
<tr>
<th> Matrixsheets
</th>
<td>
<ul><li> The sheet <b>Name</b> must be unique within the matrixbook and is limited to 32 characters.</li>
<li> Can contain spaces and numbers.</li>
<li> Can contain special characters except <b>`!%"|()[]{}&lt;&gt;</b>.</li>
<li> Can begin with a letter, number or allowed special character.</li>
<li> Optionally, sheet can have <b>Label</b> and <b>Comments</b>.</li></ul>
</td></tr>
<tr>
<th> Matrix Objects
</th>
<td>
<ul><li> By default, Origin assigns a matrix object index number to each object, as it is created. This index number cannot be changed. </li>
<li> You can add a name to the object by clicking on the yellow object icon - <a  class="image"><img alt="Matrix object icon data.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Matrix_object_icon_data.png?v=23175" width="17"  /></a> for a data matrix or <a  class="image"><img alt="Matrix object icon image.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Matrix_object_icon_image.png?v=23176" width="17"  /></a> for an image matrix - in the upper right corner of the matrixsheet and choosing <b>Rename</b> from the menu. Alternately, you can double-click on the matrix object number/name below the thumbnail and enter a name.</li></ul>
</td></tr></table>
<h3><a name="Different_Views_of_the_Matrix"></a><span class="mw-headline">Different Views of the Matrix</span></h3>
<p><span class="OIndex" style="display:none">Matrix, Data Mode vs. Image Mode</span>
<span class="OIndex" style="display:none">Region of Interest</span>
<span class="OIndex" style="display:none">Images, Matrix</span>
In the worksheet, a dataset is contained in a single column and the dataset may consist of <b>X</b>,<b>Y</b>,<b>Z</b>, <b>Error</b>, or <b>Label</b> data. In the Origin matrix, a dataset is arranged in a specified dimension of rows and columns. The matrix contains a single dataset of <b>Z</b> values. 
</p>
<ul><li> Matrix columns are mapped to linearly-spaced X values. </li>
<li> Matrix rows are mapped to linearly-spaced Y values. </li></ul>
<p><br />
Note that the matrix window has two column and row heading view modes:
</p>
<ul><li> By default, matrix row and column headings display as row and column index numbers (<b>View: Show Column/Row</b> from the menu or press  <b>Ctrl+Shift+C</b>). </li>
<li> You can opt to view matrix row and column as X and Y values by choosing <b>View: Show X/Y</b> from the Origin menu (or press <b>Ctrl+Shift+X</b>). The displayed X and Y values are the X and Y coordinate values, calculated by linear interpolation of the axes <b>From</b> and <b>To</b> values by the number of columns and rows.</li></ul>
<dl><dd><a  class="image"><img alt="Matrix Row Index vs XYValues.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Matrix_Row_Index_vs_XYValues.png?v=65543" width="602"  /></a></dd></dl>
<p><br />
In addition to the two row and column heading view modes, there are <a class="external text" href="../../QuickHelp/QuickHelp/What_is_the_difference_between_data_and_image.html">two matrix display modes</a>:
</p>
<ul><li> In Data Mode (<b>View: Data Mode</b> from the menu or press <b>Ctrl+Shift+D</b>), the matrix object displays as raw numbers.</li>
<li> In Image Mode (<b>View: Image Mode</b> from the menu or press <b>Ctrl+Shift+I</b>), the matrix object displays as either a gray scale image or a color image, depending upon the type of data in the matrix. A matrix of real numbers or complex numbers displays as a gray-scale image while RGB values will display as a color image.<br /><br /></li></ul>
<dl><dd><a  class="image"><img alt="Datamode imagemode.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Datamode_imagemode.png?v=65527" width="602"  /></a></dd></dl>
<p><br />
</p>
<table class="note">

<tr>
<td><b>Note:</b> If the matrix object is an image, the object icon will display as <a  class="image"><img alt="Matrix object icon image.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Matrix_object_icon_image.png?v=23176" width="17"  /></a> whether you are viewing the matrix object in Image Mode (<b>View: Image Mode</b>) or Data Mode (<b>View: Data Mode</b>). Similarly, when you import numeric data into the matrix, the object icon will display as <a  class="image"><img alt="Matrix object icon data.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Matrix_object_icon_data.png?v=23175" width="17"  /></a> regardless of <b>View</b> mode.
</td></tr></table>
<h3><a name="Matrixbooks"></a><span class="mw-headline">Matrixbooks</span></h3>
<p><span class="OIndex" style="display:none">Matrix Objects</span>
Like the <a href="../../GettingStarted/OriginLab/Workbooks_Worksheets_Columns.html#Workbooks" title="OriginLab:Workbooks Worksheets Columns">workbook window</a>, the matrixbook window is created from a customizable template (.otmu file). The matrix template stores such things as number of sheets in the book, the names of the matrixsheets, matrix dimensions, data type, math functions, data import handling instructions as well as various style and format options. 
</p><p>When you create a new matrixbook, the book is named MBook<i>N</i>, with <i>N</i> reflecting the order of window creation. Appended to the book name, you will see something like ":1/3" where the first integer denotes the active matrix object and the second denotes the number of matrix objects in the active matrixsheet. Following the above example, if you click the yellow object icon to the right side of the matrix, the menu shows three matrix objects with the first being the active one - the one with a check mark placed beside it (note that in our illustration, the objects are empty).
</p>
<dl><dd><a  class="image"><img alt="Matrix window gsb.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Matrix_window_gsb.png?v=22973" width="521"  /></a></dd></dl>
<p><br />
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Tip_icon.png?v=8477" width="57"  border="0" /></td><td><p>You can right-click on a worksheet tab and <b>Add Matrix as Sheet</b> and insert a matrixbook into a workbook. This is useful when building <a href="../../GettingStarted/OriginLab/Workbooks_Worksheets_Columns.html#Workbooks_for_Analysis_and_Reporting" title="OriginLab:Workbooks Worksheets Columns">Analysis Templates</a> that involve matrix-based operations such as 3D surface fitting or 3D plotting operations.
<p><br />
</p>
</p>
<dl><dd><a  class="image"><img alt="Workbook add matrix.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Workbook_add_matrix.png?v=55650" width="184"  /></a></dd></dl>
</td></tr></table>
<h3><a name="Matrixsheets"></a><span class="mw-headline">Matrixsheets</span></h3>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Tip_icon.png?v=8477" width="57"  border="0" /></td><td><p>Prior to Origin 2018, an Origin matrixbook could have a maximum of 255 sheets. That number is now increased to 1024. When you have more than 255 sheets in a book, you will need to save the file using one of the new Unicode-compliant formats (opju, ogmu, etc).
</p></td></tr></table>
<p>A matrixbook can have up to 1024 matrixsheets. The default matrixbook template - ORIGIN.otmu - has a single matrixsheet containing 32 rows and 32 columns. Each matrixsheet can differ in dimensions(number of rows and columns and X &amp; Y range).
</p><p>To specify the dimensions of the matrixsheet:
</p>
<ol><li> Click on a tab to activate the sheet and choose <b>Matrix:Set Dimensions/Labels</b>. This opens the <b>Matrix Dimensions and Labels</b> dialog box.</li>
<li> Specify a number of columns (X dimension) and rows (Y dimension).</li>
<li> Specify a <b>From</b> and <b>To</b> value for X (columns) and Y (rows).</li></ol>
<p><br />
</p>
<table class="note">

<tr>
<td><b>Note:</b> The X and Y coordinates of the matrix are evenly spaced. The first X is mapped to the first matrix column and the last X is mapped to the last matrix column. The X coordinates of other columns are interpolated. Matrix rows are similarly mapped using the <b>From</b> Y and <b>To</b> Y values. When plotting or analyzing matrix data, the position of a point in 3D space is determined by the column X and row Y coordinate values (not column or row index) and the Z value contained in the cell intersected by the row and column.
</td></tr></table>
<h3><a name="Matrix_Objects"></a><span class="mw-headline">Matrix Objects</span></h3>
<p>A matrixsheet can contain up to 65,504 matrix objects, though the actual limit is likely to be far less (determined by system resources). Objects in a sheet share the same X/Y dimensions and column (X) and row (Y) headers, but every object can have its own <a class="external text" href="../../UserGuide/UserGuide/Matrix_Object_Headers.html">Z header</a>. Other matrix object properties include internal data type and numeric display options.
</p><p>Matrix object properties are set in the user interface via the <b>Matrix Properties</b> dialog box. To open the dialog box:
</p>
<ol><li> Make sure that the matrix object is active (check mark shows beside it in <a href="#Matrixbooks">the object menu</a>).</li>
<li> Choose <b>Matrix:Set Properties...</b> from the main menu. </li></ol>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Tip_icon.png?v=8477" width="57"  border="0" /></td><td><p>You can set properties for multiple matrix objects without closing the Matrix Properties dialog box by clicking the <b>&lt;&lt; Previous</b> or <b>Next &gt;&gt;</b> buttons at the top of the dialog box.
</p>
<dl><dd><a  class="image"><img alt="Apply properties other matrices.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Apply_properties_other_matrices.png?v=62138" width="399"  /></a></dd></dl>
</td></tr></table>
<h3><a name="Import_Image_to_Matrix"></a><span class="mw-headline">Import Image to Matrix</span></h3>
<p>Origin has two structures for importing multi-frame images -- the matrix window and the <a href="#Image_Window">Image window</a>. The matrix window is better-suited to performing data analysis tasks (e.g. surface fitting, statistics, mathematic transformations of data, etc.) and some graphing operations, but take note of the following:
</p>
<ul><li> When you import an image to the matrix, you can -- as with other matrix data -- switch between "Data Mode" (<b>View Data Mode</b>) and "Image Mode" (<b>View: Image Mode</b>).</li>
<li> However, until <a class="external text" href="../../UserGuide/UserGuide/Conversion.html">converted to data</a>, matrices contain RGB values (regardless of View mode), as seen in the second window in the sequence below. </li>
<li> Performing certain analysis or graphing tasks (e.g. <a class="external text" href="../../UserGuide/UserGuide/Fitting_2D_Surfaces_(OriginPro_Only).html">Nonlinear Matrix Fit</a> or creating an <a class="external text" href="../../UserGuide/UserGuide/Image_Plot.html">Image Plot</a>) requires that the matrix first be converted to Z values by choosing <b>Image: Conversion: Convert to Data</b>.</li></ul>
<dl><dd><a  class="image"><img alt="UG matrix image convert.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/UG_matrix_image_convert.png?v=68329" width="798"  /></a></dd></dl>
<p>For more information, see <a class="external text" href="../../UserGuide/UserGuide/Conversion.html"><b>Image Conversion</b></a> in the Origin Help File.
</p><p><br />
<i><b>To import an image or image stack to the matrix window:</b></i>
</p>
<ol><li> With the matrix active, choose <b>Data: Import From File: Image to Matrix</b>.</li>
<li> This opens the <b>Image to Matrix</b> (<b>impImage</b>) dialog. Note that there are are controls for <b>Import Grayscale GeoTIFF as Data</b>, <b>Show Image Thumbnails</b> and multi-file import-handling.</li></ol>
<dl><dd><a  class="image"><img alt="UG impImage dlg.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/UG_impImage_dlg.png?v=68031" width="477"  /></a></dd></dl>
<h4><a name="Image_Thumbnails_and_Image_Slider"></a><span class="mw-headline">Image Thumbnails and Image Slider</span></h4>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Tip_icon.png?v=8477" width="57"  border="0" /></td><td><p>When importing multi-frame TIF files, thumbnail/slider display is controlled by system variable <a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#M"><b>@MSS</b></a> (default value =<i>10</i>):
</p>
<ul><li> If the sheet contains a single frame, don't show thumbnail/slider.</li>
<li> For 1 &lt; frames &lt; 10, show thumbnail</li>
<li> For frames &gt; 10, show slider</li></ul>
</td></tr></table>
<p><br />
When the sheet contains multiple objects, you can display those objects as a series of thumbnails in a spacer at the top of the matrix window.
</p>
<ol><li> Right-click on the matrix window title bar and place a check mark beside <b>Show Image Thumbnails</b>.</li></ol>
<dl><dd><a  class="image"><img alt="UG Show Image Thumbnails.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/UG_Show_Image_Thumbnails.png?v=62430" width="644"  /></a></dd></dl>
<p><br />
Alternately, you can use a slider control to view these objects in the active matrixsheet. 
</p>
<dl><dd><a  class="image"><img alt="UG Matrix Slider Enabled.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/UG_Matrix_Slider_Enabled.png?v=62434" width="392"  /></a></dd></dl>
<p><br />
If you are seeing thumbnail images in the spacer at the top of the window, you can switch to the slider by doing the following:
</p>
<ol><li> Hover in the space between the thumbnails and when the cursor changes to a grid icon <a  class="image"><img alt="UG sheet toolbar cursor 2.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/UG_sheet_toolbar_cursor_2.png?v=61971" width="20"  /></a>, click to show the page Mini Toolbar (you can also click in the gray area to the right of your matrix image). </li>
<li> Toggle the <b>Slider or Thumbnails</b> button to show slider or thumbnails.
<dl><dd><a  class="image"><img alt="UG MT Matrix Slider Thumbnail.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/UG_MT_Matrix_Slider_Thumbnail.png?v=62615" width="384"  /></a></dd></dl></li>
<li> Likewise, you can turn off <i>both</i> thumbnails and slider by clicking the <b>Image Selector</b> button. Click the <b>View Image</b> button to toggle between <b>Data Mode</b> and <b>Image Mode</b>. </li></ol>
<dl><dd><dl><dd><a  class="image"><img alt="UG image-related-toggles.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/UG_image-related-toggles.png?v=65594" width="404"  /></a></dd></dl></dd></dl>
<h4><a name="Naming_Matrix_Objects"></a><span class="mw-headline">Naming Matrix Objects</span></h4>
<p>You can assign a name to a matrix object:
</p>
<ol><li> With the matrix object active, choose <b>Data: Define Name</b>.</li>
<li> Give the matrix a <b>Name</b>, set <b>Scope</b> and, optionally, add a <b>Comment</b>.</li></ol>
<p>Named ranges can be used in <b>Matrix: Set Values</b> (e.g. to perform math operations on other matrix objects of the same dimensions).
</p>
<h4><a name="Import_GeoTIFF_to_Matrix"></a><span class="mw-headline">Import GeoTIFF to Matrix</span></h4>
<p>GeoTIFF is a public-domain image format that stores spatial information in a TIFF file and which has applications in mapping. Origin supports import of GeoTIFF files to both matrices and <a href="#Import_GeoTIFF_as_Image">Image windows</a>.
</p><p><br />
<i><b>To import a GeoTIFF file to the active matrix:</b></i>
</p>
<ol><li> Click <b>Data: Import From File: Image to Matrix</b>.</li>
<li> In the Image to Matrix dialog (impImage), check the <b>Import Grayscale GeoTIFF as Data</b> box and click <b>OK</b>.</li></ol>
<p><a  class="image"><img alt="UG impImage GeoTIFF.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/UG_impImage_GeoTIFF.png?v=68032" width="584"  /></a>
</p><p>For more information, see the Origin Help file page for <a class="external text" href="../../UserGuide/Category/Geotiff_Importing_and_Processing.html"><b>GeoTIFF Importing and Processing</b></a>.
</p>
<h2><a name="Extracting_Information_from_the_Matrixsheet_or_Object"></a><span class="mw-headline">Extracting Information from the Matrixsheet or Object</span></h2>
<p>When viewing matrixsheets or matrix objects in Image Mode (<b>View: Image Mode</b>), you can extract information from the matrix using the <b>Region-of-Interest</b> (<b>ROI</b>) tools:
</p>
<ol><li> Go to <b>Tools: Region of Interest Tools</b> and verify that there is a check mark beside the menu item. If not, click on this item or press CTRL + SHIFT + T to enable the ROI tools. </li>
<li> To add an ROI, click on the displayed ROI tool (e.g. <b>Rectangle Tool</b> <a  class="image"><img alt="ROI rectangle tool.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/ROI_rectangle_tool.png?v=23338" width="22"  /></a>) on the <b>Tools</b> toolbar and choose an ROI shape from the flyout menu (rectangle, circle, polygon, region). Alternately, you can right-click on the image (make sure no existing ROI is selected) and choose <b>Add ROI</b> from the shortcut menu.</li>
<li> Using your mouse, drag out an area on the image (not needed if adding from the shortcut menu) and double-click to set your selection. Once the selection is set, additional clicks allow rotating, stretching, or skewing the ROI. </li>
<li> You can add multiple ROIs using either the <b>Add ROI</b> shortcut menu (hint: right-click on the matrix image) or with the <b>Tools</b> toolbar buttons. Note that when adding multiple ROIs using the toolbar buttons, you'll need to rename each as it is created (otherwise, it will be destroyed when you create a new ROI). Double-click on the ROI to open a small dialog and change the <b>Name</b> of the object (<b>hint</b>: simply append a unique number to each <b>Name</b>). </li>
<li> Right-click on your ROI and choose an option from the shortcut menu. To discard the selected ROI, press Delete:
<ul><li> <b>Crop</b>: Crop the image to the minimum rectangular area that will contain the ROI. By default, values outside the ROI will show black (zero values in Data Mode).</li>
<li> <b>Copy</b>: Rectangle only. Creates an image from the ROI.</li>
<li> <b>Clear</b>: Clear data within the ROI(s). Available only for TIFF stacks, <a class="external text" href="../../UserGuide/UserGuide/NetCDF_Manipulating.html#Clear_Data_in_ROI">NetCDF data</a>; otherwise unavailable (dimmed). </li>
<li> <b>Add ROI</b>: Adds and enumerates name of each ROI (so that manual renaming is unnecessary when adding multiple ROIs).</li>
<li> <b>Copy Positions</b>: Copy the position of the selected ROI.</li>
<li> <b>Paste Positions</b>: Paste the position of the selected ROI to another ROI (width, height...all). </li>
<li> <b>Export ROI</b>: Save the ROI object(s).</li>
<li> <b>Import ROI</b>: Replace the object(s) with those in a saved *.ROI file (hint: create a "dummy" ROI to import).</li>
<li> <b>Create ROI from XY</b>: Opens the <b>Create ROI from XY</b> (<a class="external text" href="../../XFunction/X-Function/Xy2roi.html">xy2roi</a>) dialog where you designate XY coordinates for creating ROI.</li>
<li> <b>Clear All ROIs</b>: Remove ROIs from matrixsheet.</li>
<li> <b>Create New</b>: Use the <b>mroi2mat</b> tool to generate a new matrix from the ROI.</li>
<li> <b>Extract as XYZ</b>: Use the <b>mroi2xyz</b> tool to generate a new worksheet of XYZ values.</li>
<li> <b>Intensity Profile</b>: Use the <b>mroiprofile</b> tool to generate statistics for the ROI.</li>
<li> <b>Convert to Data</b>: Convert RGB image to data.</li>
<li> <b>Convert to Gray</b>: Convert RGB image to grayscale.</li>
<li> <b>View Complex Image</b>: View components of the complex image.</li></ul></li></ol>
<p><br />
</p>
<dl><dd><a  class="image"><img alt="Matrix image crop.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Matrix_image_crop.png?v=68930" width="791"  /></a></dd></dl>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Tip_icon.png?v=8477" width="57"  border="0" /></td><td><p>ROI stats are automatically reported to the <a href="../../GettingStarted/OriginLab/The_Origin_Interface.html#The_Status_Bar" title="OriginLab:The Origin Interface"><b>Status Bar</b></a>. Right-click on the Status Bar to hide or show statistics.
</p>
<dl><dd><a  class="image"><img alt="UG ROI mat stat.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/UG_ROI_mat_stat.png?v=66996" width="719"  /></a></dd></dl>
</td></tr></table>
<h2><a name="Image_Plot"></a><span class="mw-headline">Image Plot</span></h2>
<p>Data in a matrix can be plotted as an <b>Image Plot</b>. Axis scales are determined by the matrix XY coordinates (when the matrix is active, choose <b>View: Show X/Y</b>). 
</p><p>Note that if you import an image to the matrix (<b>Data: Import From File: Image to Matrix</b>) you must first convert the image to data (<b>Image: Conversion: Convert to Data</b>) before creating your Image Plot (<b>Plot: Contour: Image Plot</b>).
</p>
<ol><li> Activate a matrix window and choose <b>Plot: Contour: Image Plot</b>.</li></ol>
<dl><dd><a  class="image"><img alt="Image plot generic.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Image_plot_generic.png?v=65583" width="507"  /></a></dd></dl>
<p>By default, the image plot will use the same colormap, Z scale range and missing value color, as matrix image mode (<b>View: Image Mode</b>). See <a href="#Manipulation_of_Matrix_Data"><b>Matrix: Apply Palette to Color Map</b></a>, below.
</p>
<h2><a name="Image_Window"></a><span class="mw-headline">Image Window</span></h2>
<p>The <b>Image Plot</b> described above is used to plot values in a single matrix object. The <b>Image Window</b> can be used to:
</p>
<ul><li> Open an image file for basic manipulation (flip, rotate, convert to gray-scale) using the Image Window's Mini Toolbar.</li>
<li> Edit an image inserted into a worksheet cell or graph window (double-click on the inserted image).</li>
<li> Import an image set such as the common "TIFF stack". </li>
<li> Import multiple discrete image files as an image stack.</li>
<li> Open and play a movie (.avi, .mov, .mp4) file.</li>
<li> Define one or more regions-of-interest (ROI) for which you can <b>Copy Positions</b>, <b>Paste Positions</b> (from another ROI), and <b>Export</b> or <b>Import</b> position information saved to an Origin *.ROI file (a text file with position information on each ROI on the image).</li>
<li> Open and operate on images inserted to worksheets or graphs: crop, copy, export ROI, etc.</li></ul>
<h3><a name="Image_and_Video_Import"></a><span class="mw-headline">Image and Video Import</span></h3>
<ol><li> Choose <b>File: New Image</b>, then choose an option from the flyout menu.</li></ol>
<dl><dd><ul><li> <b>Empty Window</b>: You can later add a file by right-clicking and choosing <b>Import</b> or <b>Import from Web</b>. Alternately, click the <b>New Image</b> button <a  class="image"><img alt="Button New Image.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Button_New_Image.png?v=68513" width="25"  /></a> on the Standard toolbar.</li></ul>
<dl><dd><a  class="image"><img alt="UG Empty Image Windowy.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/UG_Empty_Image_Windowy.png?v=67236" width="605"  /></a></dd></dl>
<ul><li> <b>Image/Video</b> (CTRL + ALT + I): Use the file type drop-down to specify an image or video file format.</li></ul>
<dl><dd><a  class="image"><img alt="Image window play movie.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Image_window_play_movie.png?v=65592" width="407"  /></a></dd></dl>
<ul><li> <b>Multiple Image Files</b> (CTRL + ALT + T): Specify which files to import as a stack, including <a href="#Import_GeoTIFF_as_Image">GeoTIFF</a>. Note that the resulting stack will show an image slider, by default. </li></ul>
<dl><dd><a  class="image"><img alt="Image Window Multiple File Stack.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Image_Window_Multiple_File_Stack.png?v=68511" width="678"  /></a></dd></dl>
<ul><li> <b>Web Image</b> (CTRL + ALT + L): Enter a URL in the dialog to link to a web-stored image. Hint: to grab an image URL, right-click on the web image and choose <b>Copy image link</b> or <b>Copy image address</b>.</li></ul>
<dl><dd><a  class="image"><img alt="UG enter image url.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/UG_enter_image_url.png?v=68507" width="603"  /></a></dd></dl></dd></dl>
<h4><a name="Import_GeoTIFF_as_Image"></a><span class="mw-headline">Import GeoTIFF as Image</span></h4>
<p>GeoTIFF is a public-domain image format that stores spatial information in a TIFF file and which has applications in mapping. Origin supports import of GeoTIFF files to both <a href="#Import_GeoTIFF_to_Matrix">matrices</a> and Image windows.
</p><p><i><b>To import a GeoTIFF file as an image:</b></i>
</p>
<ol><li> Click <b>File: New: Image: Image/Video</b> and choose the GeoTIFF image.</li></ol>
<p><br />
<i><b>To import multiple GeoTIFF files as image:</b></i>
</p>
<ol><li> Click <b>File: New: Image: Multiple Image Files</b> and choose your images. Images are imported to the active Image window and a slider is added to scroll images. </li></ol>
<dl><dd><a  class="image"><img alt="UG GTIFF multiple slider.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/UG_GTIFF_multiple_slider.png?v=68570" width="611"  /></a></dd></dl>
<dl><dd><ul><li> All Images must be the same size.</li>
<li> Negative numbers (e.g. -999) are treated as missing values. </li>
<li> The Image window Mini Toolbar has a button for setting <b>Missing Value Color</b> </li>
<li> Convert an Image window containing multiple GeoTIFF files to matrix using <b>Image: Convert to Matrix</b>. Each image in the stack becomes an <a href="#Matrix_Objects">object</a> in the output matrix.</li></ul></dd></dl>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Tip_icon.png?v=8477" width="57"  border="0" /></td><td><p>Click inside the window, somewhere near the top, to show the Mini Toolbar.
</p></td></tr></table>
<p><br />For more information, see the Origin Help file page for <a class="external text" href="../../UserGuide/Category/Geotiff_Importing_and_Processing.html"><b>GeoTIFF Importing and Processing</b></a>.
</p>
<h4><a name="Image_Import_Notes"></a><span class="mw-headline">Image Import Notes</span></h4>
<ul><li> To help control Origin project file size, right-click on an Image Window image and enable <b>Linked File</b>. This saves a link to the image file into the window but excludes the image from the saved project. When you reopen the saved project, the window will appear empty; at this point, you can decide whether you need to re-import the image (CTRL + 4 or <b>Import</b> from the window shortcut menu).</li>
<li> <b>Actual Size Mode</b> is turned on by default for images of max width or height of less than 800 pixels. The size threshold can be adjusted using system variable <a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#H.2CI.2CJ.2CK"><b>@IWP</b></a> (see <a class="external text" href="../../QuickHelp/QuickHelp/How_do_I_permanently_change_the_value_of_a_system_variable.html">this FAQ</a> for info on changing the value of a system variable).</li></ul>
<h3><a name="Image_Window_Navigation"></a><span class="mw-headline">Image Window Navigation</span></h3>
<p>Display of image information and navigation controls is enabled or disabled via the the <b>View</b> menu and/or the Image Window <b>Mini Toolbar</b> (<b>None</b>, <b>Thumbnails</b>, <b>Video</b> or <b>Slider</b>).
</p><p><a  class="image"><img alt="UG Image Window Toggle Nav Display.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/UG_Image_Window_Toggle_Nav_Display.png?v=67042" width="780"  /></a> 
</p><p>The same Mini Toolbar button is shown for GeoTIFF images: 
</p>
<dl><dd><dl><dd><a  class="image"><img alt="UG GTIFF multiple stack nav.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/UG_GTIFF_multiple_stack_nav.png?v=68573" width="611"  /></a></dd></dl></dd></dl>
<p><br />
<i><b>Additional Keyboard control for Video navigation</b></i>
</p>
<ul><li> Pressing the left/right arrow keys will move the frame by 1.</li>
<li> Shift + arrow key will move the frame by 5.</li>
<li> Shift + Ctrl + arrow key will move the frame by 20.</li></ul>
<h3><a name="Image_Resize"></a><span class="mw-headline">Image Resize</span></h3>
<p>To resize the image by one of several interpolative methods:
</p>
<ol><li> With the Image Window active, choose <b>Image: Resize</b>.</li>
<li> Choose options including your <b>Interpolation Method</b> (Nearest Neighbor, Bilinear, Bicubic, Pixel Area Relation, Lanczos) and click <b>OK</b>.</li></ol>
<dl><dd><dl><dd><a  class="image"><img alt="UG cvResize dialog.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/UG_cvResize_dialog.png?v=67240" width="292"  /></a></dd></dl></dd></dl>
<h3><a name="Mini_Toolbars_for_Image_Window"></a><span class="mw-headline">Mini Toolbars for Image Window</span></h3>
<p>Mini Toolbar buttons are available for performing simple image manipulation, including rotating, flipping or converting to grayscale.
</p>
<dl><dd><a  class="image"><img alt="UG MT Image Window Buttons.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/UG_MT_Image_Window_Buttons.png?v=67038" width="709"  /></a></dd></dl>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Tip_icon.png?v=8477" width="57"  border="0" /></td><td><p>You can apply a color palette to a grayscale image using the <b>Palette</b> button <a  class="image"><img alt="Button Palette.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Button_Palette.png?v=10816" width="23"  /></a> on the Style toolbar. Click <b>More Palettes</b> to open <a href="../../GettingStarted/OriginLab/Customizing_Graphs.html#Color_Manager" title="OriginLab:Customizing Graphs">the <b>Color Manager</b></a> dialog box and add more palettes.
</p></td></tr></table>
<h3><a name="ROIs_in_the_Image_Window"></a><span class="mw-headline">ROIs in the Image Window</span></h3>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Tip_icon.png?v=8477" width="57"  border="0" /></td><td><p>If your ROI is hard to see against the background image, you can select the ROI and use the Style toolbar <b>Line/Border Color</b> button <a  class="image"><img alt="Button Line Border Color.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Button_Line_Border_Color.png?v=47443" width="23"  /></a> to change outline color.
</p></td></tr></table>
<p>You can define one or more regions-of-interest in the Image window using the <b>Rectangle Tool</b> <a  class="image"><img alt="ROI tool.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/ROI_tool.png?v=51699" width="19"  /></a>) on the Tools toolbar.
</p>
<ol><li> Select the tool and drag out an ROI. Once added, adjustments to size and position can be made by selecting the object and dragging the blue selection handles.</li>
<li> To add <i>multiple</i> ROIs to an image, click on the <b>Rectangle Tool</b> and drag out your ROI; right-click on the image and choose <b>Add ROI</b> (CTRL + Q); or use the <b>Add ROI</b> button on the Image window Mini Toolbar. In either case, you'll need to rename added ROIs as you go: double-click on the ROI and give it a unique name so that it is not replaced by the next added ROI. </li></ol>
<dl><dd><dl><dd><a  class="image"><img alt="UG ROI Position Dialog.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/UG_ROI_Position_Dialog.png?v=67036" width="342"  /></a></dd></dl></dd></dl>
<p>Right-clicking on the ROI produces a context menu with the following options:
</p>
<dl><dd><dl><dd><a  class="image"><img alt="Image window ROI context menu.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Image_window_ROI_context_menu.png?v=69083" width="758"  /></a></dd></dl></dd></dl>
<dl><dd><dl><dd><ul><li> <b>Clip</b>: Available when the image is opened from a graph (e.g. by double-clicking the graph image). This clips the graph image to the Image window ROI. The original graph image size is reduced to the size of the clipped region. To restore the full image in the graph window, right-click outside of the ROI and choose <b>Remove Clipping</b>.</li>
<li><b>Crop</b>: Crop Image window image and graph image (if exists) to the ROI. Graph image size and position are kept. </li>
<li><b>Copy</b>: Copy the ROI as an image. You can then paste it to other windows inside Origin, e.g. a graph or worksheet window, or to other applications. For multi-frame image, only the active frame is copied.</li>
<li><b>Apply Scale to Graph</b>: Available when the image is inserted into a graph by <b>Image from Image Window</b>. This updates the graph image to the Image window ROI. </li>
<li><b>Copy Positions</b>: Copy the ROI box coordinates of 4 vertices. You can choose to paste it as plain numbers, or, <b>Paste Position</b> to another ROI box. For the latter option, you can choose to  paste only ROI <b>Width</b>/<b>Height</b>, or <b>Horizontal</b>/<b>Vertical</b> location.  </li>
<li><b>Export ROI</b>: Saves details (e.g. ROI name, position of vertices, etc.) to a .ROI file.</li>
<li> <b>Import ROI</b>: Applies details of a previously-saved ROI, to the selected ROI. </li>
<li> <b>Create New from XY</b>: Create a new ROI box of arbitrary shape from a set of XY coordinates (boundary) and index data. Support for gray-scale image only. See also <a class="external text" href="../../UserGuide/UserGuide/NetCDF_Manipulating.html#Create_ROI_from_XY">Create ROI from XY in NetCDF data</a>.</li>
<li><b>Create Linked Image</b>: Outputs the ROI to a new Image window. Changes to the ROI will be passed to the new Image window.</li>
<li><b>Create Linked Matrix</b>: Outputs the ROI data to a new matrix window. Changes to the Image window ROI will be passed to the matrix.This makes it easier to carry out many analysis and statistics operations that cannot be done on an Image window (i.e. a matrix is required).</li></ul></dd></dl></dd></dl>
<h2><a name="Profiling_Matrix_Data"></a><span class="mw-headline">Profiling Matrix Data</span></h2>
<p><span class="OIndex" style="display:none">Profiling Matrix Data</span>
<span class="OIndex" style="display:none">Matrix, Profiling</span>
<span class="OIndex" style="display:none">Profiling Images</span>
</p><p>Data in a matrix can be viewed in profile -- either in the X, Y or arbitrary cross-section.
</p>
<ol><li> Activate the matrix object and choose <b>Plot &gt; 2D: Profile: Image Profiles</b> from the main menu. </li></ol>
<p>This creates an image plot and opens the <b>Image/Contour Profile</b> dialog box. Use the dialog box to specify X and/or Y profile plots and the location and appearance of the cross-sectional lines. Note that this dialog box is interactive. You can make adjustments to your image profile -- move the cross-sectional lines or change the configuration or the appearance of the plots -- without closing the dialog box. After closed the dialog box, a button <b>Profiles...</b>will appear at the right-top corner of graph window, which can be used to reopen the <b>Image/Contour Profiles</b> dialog.<br />
</p>
<dl><dd><a  class="image"><img alt="Image profile XY.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Image_profile_XY.png?v=50483" width="601"  /></a></dd></dl>
<h2><a name="Setting_Matrix_Values"></a><span class="mw-headline">Setting Matrix Values</span></h2>
<p><span class="OIndex" style="display:none">Matrix, Set Values</span>
<span class="OIndex" style="display:none">Set Matrix Values</span>
The <b>Set Values</b> dialog box is used to generate or transform data in a matrix object. 
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Tip_icon.png?v=8477" width="57"  border="0" /></td><td><p>You can assign a name to a matrix object and use the name <b>Set Values</b> (e.g. to perform math operations on other matrix objects of the same dimensions). 
</p></td></tr></table>
<p>To open the <b>Set Values</b> dialog box, make sure that the matrix object is active, then:
</p>
<ol><li> From the menu, choose <b>Matrix: Set Values</b>. <br /></li></ol>
<p><i>or</i> <br />
</p>
<ol><li> Select the matrix by clicking in the upper-left corner (in the empty header cell just below the matrix icon/name), then right-click on the matrix and choose <b>Set Matrix Values</b> from the shortcut menu.<br /><br /></li></ol>
<dl><dd><a  class="image"><img alt="SetValues matrix.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/SetValues_matrix.png?v=32903" width="447"  /></a><br /><br /></dd></dl>
<table class="dialogcontroltable">

<tr>
<th> Menu Commands
</th>
<td>
<ul><li> <b>Formula</b>: Load a saved formula into the matrix formula box. Formula are saved using <b>Formula: Save</b> or <b>Formula: Save As...</b>.</li>
<li> <b>Mat(1)</b>: Use the menu to include matrix objects in either your matrix formula or your Before Formula Scripts (matrix object reference is inserted at the cursor). A Matrix Browser is available to help in selecting the correct objects. Objects are listed by object index.</li>
<li> <b>Mat(A)</b>: Similar to Mat(1) menu functionality but matrix objects are listed by object Long Name, if one exists.</li>
<li> <b>Function</b>: Add LabTalk functions to your expressions (function name is inserted at the cursor). </li>
<li> <b>Variables</b>: Add a variable or a constant to <b>Matrix Formula</b> or <b>Before Formula Scripts</b>; Add range variables (including by selection) or file metadata, to Before Formula Scripts.</li></ul>
</td></tr>
<tr>
<th> Matrix Formula
</th>
<td>
<ul><li> Add a single line expression for generating data. Functions, conditional operators and variables can be used.</li></ul>
</td></tr>
<tr>
<th> Before Formula Scripts
</th>
<td>
<ul><li> Enter one or more lines of LabTalk script to be executed before the expression in the Matrix formula box is executed. </li></ul>
</td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Tip_icon.png?v=8477" width="57"  border="0" /></td><td><p>Use the <b>Before Formula Scripts</b> panel at the bottom of the <b>Set Values</b> dialog box to define variables or LabTalk functions that you wish to use in your matrix formula.
</p><p>Click the <b>Search and Insert Functions</b> button <a  class="image"><img alt="Search Insert Functions.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Search_Insert_Functions.png?v=30619" width="23"  /></a> to search for built-in LabTalk functions.
</p></td></tr></table>
<h2><a name="Manipulation_of_Matrix_Data"></a><span class="mw-headline">Manipulation of Matrix Data</span></h2>
<p><span class="OIndex" style="display:none">Matrix, Manipulating Data</span>
</p>
<table class="simple" style="width: 95%">

<tr>
<th style="width: 40%">Utility
</th>
<th style="width: 55%">Menu Access
</th></tr>
<tr>
<td>
<ul><li> For an XY coordinate pair picked with the <a href="../../GettingStarted/OriginLab/Graphical_Exploration_of_Data.html#The_Screen_Reader_Tool" title="OriginLab:Graphical Exploration of Data">Screen Reader</a>, output Z values for for the matrix stack (multiple matrix objects) to a worksheet.</li></ul>
</td>
<td><b>Matrix: Pixel Extraction</b>
</td></tr>
<tr>
<td>
<ul><li> Flip or Rotate a matrix.</li></ul>
</td>
<td><b>Matrix: Rotate90</b><br /><b>Matrix: Flip: Vertical</b><br /><b>Matrix: Flip: Horizontal</b>
</td></tr>
<tr>
<td>
<ul><li> Resize a matrix using one of four methods (Expand, Shrink, Interpolate and Pad).</li></ul>
</td>
<td>  <b>Matrix: Resize</b>
</td></tr>
<tr>
<td>
<ul><li> Transpose a matrix.</li></ul>
</td>
<td>  <b>Matrix: Transpose</b>
</td></tr>
<tr>
<td>
<ul><li> Generate a 3-dimensional dataset by transforming XYZ values by formula.</li></ul>
</td>
<td><b>Matrix: Generate Grid</b>
</td></tr>

<tr>
<td>
<ul><li> Expand the matrix by scaling in the X and Y directions.</li></ul>
</td>
<td> <b>Matrix: Expand</b>
</td></tr>
<tr>
<td>
<ul><li> Shrink the matrix by some row/column factor, using one of several shrink methods.</li></ul>
</td>
<td> <b>Matrix: Shrink</b>
</td></tr>
<tr>
<td>
<ul><li> Use a palette file to transform a matrix in Image Mode. Set a system variable to apply a color palette (<b>Style</b> toolbar, <b>Palettes</b> button) to <i>all</i> matrix objects (@MAP=0, default) or only the <i>active</i> matrix object (@MAP=1).</li></ul>
</td>
<td><b>Matrix: Apply Palette to Color Map</b>
</td></tr>
<tr>
<td>
<ul><li> Convert a matrix of values to worksheet columns (see next section).</li></ul>
</td>
<td><b>Matrix: Convert to Worksheet</b>
</td></tr></table>
<h2><a name="Changing_the_Color_Scheme_of_a_Matrix"></a><span class="mw-headline">Changing the Color Scheme of a Matrix</span></h2>
<p>You can use the <b>Palette</b> <a  class="image"><img alt="Palettes Button.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Palettes_Button.png?v=66949" width="24"  /></a> button and the <b>Missing Value Color</b> <a  class="image"><img alt="Missing Value Color.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Missing_Value_Color.png?v=66950" width="24"  /></a> button in the Mini Toolbar to customize the color of the matrix window.
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Tip_icon.png?v=8477" width="57"  border="0" /></td><td><p>The selected palettes and missing value color will apply to all matrix objects in the active matrix sheet, but will not change the palettes and missing value colors of objects in other matrix sheets in the same matrix window.
</p></td></tr></table>
<h2><a name="Converting_Matrixes_to_Worksheets"></a><span class="mw-headline">Converting Matrixes to Worksheets</span></h2>
<p><span class="OIndex" style="display:none">Worksheets, Converting from Matrix</span>
<span class="OIndex" style="display:none">Matrix, Converting to Worksheet</span>
</p><p><br />
<i><b>To convert a matrix to worksheet:</b></i>
</p>
<ol><li> With a matrix active, choose <b>Matrix: Convert to Worksheet: Open Dialog</b>.</li></ol>
<p><br />
There are two methods for converting matrix data to worksheet data -- <b>Direct</b> and <b>XYZ Columns</b>. Starting, for instance, with the following arrangement:
</p>
<dl><dd><dl><dd><a  class="image"><img alt="Matrix Source.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Matrix_Source.png?v=50478" width="437"  /></a></dd></dl></dd></dl>
<h3><a name="Direct"></a><span class="mw-headline">Direct</span></h3>
<p>This copies the Z values in the matrix to a worksheet with no reordering. If the matrix consists of M rows by N columns of Z values, this method produces a worksheet which has M rows and N columns. By default, the X and Y coordinates of the matrix Z values are not copied to the worksheet. You can opt to copy X coordinates to the 1st worksheet row or a parameter row and the Y coordinates to the 1st worksheet column.
</p>
<dl><dd><dl><dd><a  class="image"><img alt="Matrix direct convert.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Matrix_direct_convert.png?v=50480" width="525"  /></a></dd></dl></dd></dl>
<h3><a name="XYZ_Columns"></a><span class="mw-headline">XYZ Columns</span></h3>
<p>When there is a single matrix object, this method produces a worksheet with three columns: X,Y, and Z, with X and Y columns containing the X and Y coordinate values and the Z column containing the matrix Z value at each XY coordinate. 
</p>
<dl><dd><dl><dd><a  class="image"><img alt="Matrix wks XYZ.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Matrix_wks_XYZ.png?v=47211" width="339"  /></a></dd></dl></dd></dl>
<p><br />
<i><b>In addition, this method:</b></i>
</p>
<ul><li> Saves matrix <i>object</i> <b>Long Name</b>, <b>Units</b> and <b>Comments</b> to the Z <a href="../../GettingStarted/OriginLab/Workbooks_Worksheets_Columns.html#Column_Label_Rows" title="OriginLab:Workbooks Worksheets Columns">column label rows</a>.</li>
<li> If the converted matrix contains a color image, the resulting Z column will display <a href="../../GettingStarted/OriginLab/Workbooks_Worksheets_Columns.html#Color_Format" title="OriginLab:Workbooks Worksheets Columns">a <b>Color</b> column</a> of HTML colors for each matrix cell.</li></ul>
<dl><dd><dl><dd><a  class="image"><img alt="UG carbmp m2w color.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/UG_carbmp_m2w_color.png?v=67203" width="564"  /></a></dd></dl></dd></dl>
<p><br />
<i><b>When converting multiple matrix objects:</b></i>
</p><p>When there are <i>N</i> matrix objects, you can set <b>Convert On</b> = <b>All Objects</b> and output columns as X, Y and Z x  <i>N</i> (i.e. <i>XYZZZ...</i>).
</p>
<dl><dd><a  class="image"><img alt="Matrix wks All Objects XYZZ.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Matrix_wks_All_Objects_XYZZ.png?v=66968" width="400"  /></a></dd></dl>
<h2><a name="Converting_Worksheets_to_Matrixes"></a><span class="mw-headline">Converting Worksheets to Matrixes</span></h2>
<ol><li> With the worksheet active, choose <b>Worksheet: Convert to Matrix</b> and choose one of the following methods:</li></ol>
<p><span class="OIndex" style="display:none">Worksheets, Converting to Matrix</span>
<span class="OIndex" style="display:none">Matrix, Converting Worksheet Data</span>
</p>
<table class="simple">
<tr>
<th> Method
</th>
<th width="200">Conversion Type
</th>
<th> Notes
</th></tr>
<tr>
<td> <b>Direct</b>
</td>
<td>
<ul><li> <b>X across columns</b></li>
<li> <b>Y across columns</b></li>
<li> <b>No X and Y</b></li></ul>
</td>
<td> Ideal for spreadsheet data that conforms to the following:
<ul><li> X data values in the 1st column, Y data values in the 1st row and Z values in columns 2 to N and rows 2 to M. </li>
<li> Y data values in the 1st column, X data values in the 1st row and Z values in columns 2 to N and rows 2 to M. </li></ul>
<p><b>Note</b>: See <b>Virtual Matrix</b>, <a href="#Virtual_Matrix">below</a>.
</p>
</td></tr>
<tr>
<td> <b>Expand</b>
</td>
<td>
<ul><li> <b>Row</b></li>
<li> <b>Column</b></li></ul>
</td>
<td> Some ASCII files have an upper limit for characters allowed on a single line. Use this method when your file breaks a single line of data across multiple lines.
<ul><li> Expand by <b>Row</b>: specifies the number of ASCII file rows comprising one matrix row.</li>
<li> Expand by <b>Column</b>: specifies the number of ASCII file columns comprising one matrix column.</li></ul>
</td></tr>
<tr>
<td> <b>XYZ Gridding</b>
</td>
<td>
<ul><li> <b>Regular</b></li>
<li> <b>Sparse</b> </li>
<li> <b>Random (Renka Cline)</b> </li>
<li> <b>Random (Shepard)</b> </li>
<li> <b>Random (Thin Plate Spline)</b> </li>
<li> <b>Random (Kriging Correlation)</b> </li>
<li> <b>Random (Weighted Average)</b></li></ul>
</td>
<td> Conversion Type depends upon XY spacing:
<ul><li> Choose <b>Regular</b> applied for data that are regularly spaced in XY.</li>
<li> Choose <b>Sparse</b> when you have missing values.</li>
<li> Choose <b>Renka-Cline</b>, <b>Shepard</b>, <b>TPS</b>, <b>Kriging</b> or <b>Weighted Average</b> methods for data that are irregularly spaced in XY. Option for <b>No Extrapolation outside Boundary</b>.</li></ul>
<p><b>Note</b>: a worksheet of XYZZZ... columns will be converted to a matrixsheet with each Z column as a separate object. 
</p>
</td></tr>
<tr>
<td> <b>XYZ Log Gridding</b>
</td>
<td> methods same as <b>XYZ Gridding</b>
</td>
<td> Calculates logarithmic values for X and Y, then performs <b>XYZ Gridding</b>. A worksheet of XYZZZ... columns will be converted to a matrixsheet with each Z column as a separate object.
</td></tr></table>
<h2><a name="Virtual_Matrix"></a><span class="mw-headline">Virtual Matrix</span></h2>
<p><span class="OIndex" style="display:none">Matrix, Virtual</span>
<span class="OIndex" style="display:none">Virtual Matrix</span>
Data arranged in a block of worksheet cells can be treated as a "virtual matrix". As is the case with regular matrix data, virtual matrix data can be used to create 3D plots, such as color mapped surfaces or contour plots. The data can include a column or label row with the X or Y values. Unlike a regular matrix which only supports a linear spacing in the X and Y dimensions, a virtual matrix supports irregular spacing of X and Y coordinate values (provided those values are in ascending or descending order).<br />
</p>
<dl><dd><dl><dd><a  class="image"><img alt="Viirtual matrix GSB remade.png" src="../images/Matrix_Book_Matrix_Sheet_Matrix_Objects/Viirtual_matrix_GSB_remade.png?v=23386" width="600"  /></a><br /></dd></dl></dd></dl>
<p><br />
</p>
<table class="note">

<tr>
<td><b>Note:</b> You can create <a href="../../GettingStarted/OriginLab/2D_Graphs.html#Origin_Graph_Types" title="OriginLab:2D Graphs">3D plots from <b>XYZ</b> columns of worksheet data</a> in which data are irregularly spaced in the X and Y dimensions. This is not considered a "virtual matrix."
</td></tr></table>
<h2><a name="Topics_for_Further_Reading"></a><span class="mw-headline">Topics for Further Reading</span></h2>
<ul><li> <a class="external text" href="../../UserGuide/Category/Matrix_Books_Matrix_Sheets_and_Matrix_Objects.html">Matrixbooks, Matrixsheets and Matrix Objects</a></li>
<li> <a class="external text" href="../../UserGuide/UserGuide/Basic_Matrix_Book_and_Matrix_Sheet_Operations.html">Matrixbook and Matrixsheet Operations</a></li>
<li> <a class="external text" href="../../UserGuide/UserGuide/What_is_Saved_with_the_Matrix_Template.html">What is Saved with the Matrix Template?</a></li>
<li> <a class="external text" href="../../UserGuide/UserGuide/Matrix_Sheet_Dimensions_and_XY_Coordinates.html">Matrix Dimensions and XY Coordinates</a></li>
<li> <a class="external text" href="../../UserGuide/UserGuide/Matrix_Object_Data_Properties.html">Matrix Object Data Properties</a></li>
<li> <a class="external text" href="../../UserGuide/Category/Setting_Matrix_Values.html">Setting Matrix Values</a></li>
<li> <a class="external text" href="../../UserGuide/Category/Matrix_Conversion_and_Gridding.html">Matrix Conversion and Gridding</a></li>
<li> <a class="external text" href="../../UserGuide/UserGuide/Creating_3D_and_Contour_Graphs_from_Virtual_Matrix.html">Creating 3D and Contour Graphs from a Virtual Matrix</a></li>
<li> <a class="external text" href="../../UserGuide/UserGuide/Viewing_and_Profiling_Matrix_Data.html">Viewing and Profiling Matrix Data</a></li></ul>


