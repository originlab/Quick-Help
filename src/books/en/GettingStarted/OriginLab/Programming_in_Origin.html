<h1 class="firstHeading">19 Programming in Origin</h1><p class='urlname' style='display: none'>Programming-in-Origin</p>
<p><br />
</p>
<dl><dd><a  class="image"><img alt="Programming image connectivity.png" src="../images/Programming_in_Origin/Programming_image_connectivity.png?v=64094" width="637"  /></a></dd></dl>
<p>As you gain experience with Origin, you may want to access Origin features programmatically, add your own custom routines and tools, or communicate with Origin from other applications. This chapter outlines basic programming options available in Origin. For more detailed information, see the following Origin programming-related resources:
</p>
<ul><li> Programming documentation including guides, language references, and examples are available from the <b>Help</b> menu in the product. </li>
<li> Online programming documentation is available at   <b>www.originlab.com/doc</b>. </li>
<li> You can typically locate online programming pages by performing a web search from your browser using phrases such as: <b>labtalk importing</b> , <b>originc interpolate</b>, or <b>labview origin send data</b>.</li>
<li> An Origin Programming Forum can be found at <b>www.originlab.com/forum</b>.</li>
<li> Sample files for LabTalk, Python, COM Server and Client, etc. can be found in the \Samples folder of your Origin software.</li></ul>
<p><span class="OIndex" style="display:none">Programming Origin</span>
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#LabTalk"><span class="tocnumber">1</span> <span class="toctext">LabTalk</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Python"><span class="tocnumber">2</span> <span class="toctext">Python</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#R"><span class="tocnumber">3</span> <span class="toctext">R</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#MATLAB"><span class="tocnumber">4</span> <span class="toctext">MATLAB</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Origin_C"><span class="tocnumber">5</span> <span class="toctext">Origin C</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#X-Function"><span class="tocnumber">6</span> <span class="toctext">X-Function</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Automation_Server"><span class="tocnumber">7</span> <span class="toctext">Automation Server</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#LabVIEW"><span class="tocnumber">8</span> <span class="toctext">LabVIEW</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Orglab"><span class="tocnumber">9</span> <span class="toctext">Orglab</span></a></li>
</ul>
</div>

<h2><a name="LabTalk"></a><span class="mw-headline">LabTalk</span></h2>
<p><span class="OIndex" style="display:none">Programming Origin, LabTalk</span>
<span class="OIndex" style="display:none">LabTalk</span>
<span class="OIndex" style="display:none">Scripting</span>
</p><p><b>LabTalk</b> is a scripting language that provides access to most of Origin's functionality. With LabTalk you can access and change properties of Origin objects such as worksheets, columns, graph layers, and data plots. LabTalk script can include calls to X-Functions to perform advanced data processing and analysis.
</p><p>There are many options for executing your LabTalk scripts. Multiple lines of script can be organized as sections in a file, and those individual sections can be executed from the user-interface at the command prompt in the <b>Script Window</b> or <b>Command Window</b>; from buttons added to worksheets and graphs; from included or custom-made toolbar buttons; or from custom menu commands. 
</p>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Programming_in_Origin/Tutorial_icon.png?v=0" width="57"  border="0" />
	</td>
	<td><p>The following "mini-tutorial" will demonstrate adding a button object to a worksheet, associating a short LabTalk script with the button, then using the button to execute the script and perform a basic statistical calculation while writing the results to the worksheet.
</p>
<ol>
<li>Run Origin and start a new project by clicking the <b>New Project</b> button <a  class="image"><img alt="Button New Project.png" src="../images/Programming_in_Origin/Button_New_Project.png?v=1381" width="22"  /></a> on the <b>Standard</b> toolbar.</li>
<li>Click <b>Data: Import from File: Single ASCII</b> and browse to the file \Samples\Graphing\Box Chart.dat. Select the file and click <b>Open</b>. The file is imported into the active worksheet window. </li>
<li>With the worksheet window active, click <b>Format: Worksheet</b>. In the <b>Worksheet Properties</b> dialog, click the <b>Size</b> tab and set <b>Gap from Top</b> to <i>25</i>, then click <b>OK</b>. A gap is added to worksheet window.</li>
<li>Click the <b>Text Tool</b> on the <b>Tools</b> toolbar. Click inside the gap that you just added and type "Add Mean Label Row" into the text object. Click outside the text object to exit edit mode.</li>
<li>Right-click on the text label and select <b>Properties...</b>. Choose <b>Programming Control</b> tab, set <b>Script Run After</b> to <b>Button Up</b>. Copy and paste the following script into the text box:</li>
<pre class="lt" style="font-family:monospace;">wks.<span style="color: #000080;">userParam1</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
wks.<span style="color: #000080;">userParam1</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Mean&quot;</span>;
for <span style="color: #000000;">&#40;</span>int ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>; ii <span style="color: #000080;">&lt;=</span> wks.<span style="color: #000080;">ncols</span>; ii<span style="color: #000080;">++</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	range rr <span style="color: #000080;">=</span> <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>ii<span style="color: #000000;">&#41;</span>;
	Col<span style="color: #000000;">&#40;</span><span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>ii<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span>D1<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>mean<span style="color: #000000;">&#40;</span>rr<span style="color: #000000;">&#41;</span>,.2<span style="color: #000080;">*</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<li>Click <b>OK</b> to apply settings and close the <b>Text Object</b> dialog box. Note that your text object now looks like a button.</li>
<li>Click the button. Note that a new header row labelled "Mean" is added to the worksheet and the mean value of each column of data is written to the Mean row cell above the corresponding column.</li>
</ol>
</td></tr></table>
<table class="note">

<tr>
<td>
<p><b>Note:</b> For more information on LabTalk, Origin's built-in scripting language, please consult your product documentation at <strong><a class="external text" href="../../LabTalk/Category/LT_Guide.html">Help: Programming: LabTalk</a></strong>.
</p><p>Sample files can be found in the \Samples\LabTalk Script Examples folder of your Origin software.
</p>
</td></tr></table>
<h2><a name="Python"></a><span class="mw-headline">Python</span></h2>
<p><span class="OIndex" style="display:none">Programming Origin, Python</span><span class="OIndex" style="display:none">PyOrigin Module</span><span class="OIndex" style="display:none">Python</span>
</p><p>Origin provides an embedded Python environment so that you can run Python in Origin. Origin supports command line execution of Python code from the <b>Python Console</b> or Origin's <b>Code Builder</b> IDE. As of December 2022, the embedded Python version is <a class="external text" href="https://www.python.org/downloads/" target="_blank">version 3.11</a>.
</p>
<table class="note">

<tr>
<td>
<p><b>Note:</b> For more information on integrated usage of Origin and Python, see these topics in the Python documentation:
</p>
<ul><li> <a class="external text" href="../../Python/Category/Python_(Python).html"><b>Introduction to Python in Origin</b></a></li>
<li> <a class="external text" href="../../Python/Python/RunPython_(Python).html"><b>Embedded Python</b></a></li>
<li> <a class="external text" href="../../Python/Python/Sample_Projects_with_Attached_Python_Codes.html"><b>Sample Projects with attached Python Code</b></a>.</li></ul>
</td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Programming_in_Origin/Tip_icon.png?v=8477" width="57"  border="0" /></td><td><ul><li>There is an API for calling Origin from Python. See note under <b>Automation Server</b>, below.</li>
<li>To prevent package version conflicts, Origin now supports multiple PyPackage folders (set system variable <b>@PYP</b>).</li></ul>
</td></tr></table>
<h2><a name="R"></a><span class="mw-headline">R</span></h2>
<p><span class="OIndex" style="display:none">Programming Origin, R</span><span class="OIndex" style="display:none">R</span>
Origin supports running R commands in the Origin environment. You can issue R commands in the Script Window or from the built-in R Console, or you can run .R files. All releases of R are supported up through version <b>3.6</b>.
</p><p>From Origin, you can connect with R in two ways: 
</p>
<ul><li><a class="external text" href="../../UserGuide/UserGuide/R_Console.html"><b>R</b></a>. Installed on your local computer. </li>
<li><a class="external text" href="../../UserGuide/UserGuide/R_Server.html"><b>Rserve</b></a>. Installed on a remote PC.</li></ul>
<table class="note">

<tr>
<td>
<p><b>Note:</b> For more information on integrating Origin and R, refer to the Origin Help file (<a class="external text" href="../../UserGuide/UserGuide/R_Console.html"><b>R Console</b></a> and <a class="external text" href="../../UserGuide/UserGuide/R_Server.html"><b>Rserve Console</b></a>) and the LabTalk Scripting Guide (<a class="external text" href="../../LabTalk/Category/LT_Running_R_in_Origin.html"><b>Running R in Origin</b></a>, <a class="external text" href="../../LabTalk/LabTalk/R_(object).html"><b>R Objects</b></a>, <a class="external text" href="../../LabTalk/LabTalk/Rserve_(object).html"><b>Rserve Objects</b></a>).
</p><p>Sample files can be found in the \Samples\R folder of your Origin software.
</p>
</td></tr></table>
<h2><a name="MATLAB"></a><span class="mw-headline">MATLAB</span></h2>
<p>The MATLAB Console allows Origin users to issue MATLAB commands from Origin, and to transfer data between the two applications either using a graphical interface or using a command line.
</p>
<ul><li> The Console requires both Origin and MATLAB be installed on the same computer. </li>
<li> Origin also supports importing MATLAB (MAT) files from disk. There are two import routines, the older <a class="external text" href="../../UserGuide/UserGuide/Importing_Third_Party_Files.html"><b>Data: Import from File</b></a> and the new Connector-based <a class="external text" href="../../UserGuide/UserGuide/Connecting_to_File.html#JSON.5CMATLAB_file"><b>Data&#160;: Connect to File: MATLAB</b></a>. Importing MAT files does <i>not</i> require that MATLAB be installed.</li></ul>
<table class="note">

<tr>
<td>
<p><b>Note:</b> For more information on the MATLAB Console, refer to the Origin Help file (<a class="external text" href="../../UserGuide/Category/MATLAB_console.html"><b>MATLAB Console</b></a>.
</p><p>The &lt;<i>Origin Program Folder</i>&gt;\Samples\COM Server and Client\MATLAB subfolder contains an example (CreatePlotInOrigin.m, CreatePlotInOrigin.OPJ) that illustrates how to connect to an Origin COM server from a MATLAB client (requires MATLAB).
</p>
</td></tr></table>
<h2><a name="Origin_C"></a><span class="mw-headline">Origin C</span></h2>
<p><span class="OIndex" style="display:none">Programming Origin, Origin C</span><span class="OIndex" style="display:none">NAG Numerical Library</span>
<b>Origin C</b> is a full-featured high-level programming language based on the ANSI C programming language syntax. <span class="OIndex">Origin C</span> also supports a number of C++ features and a few C# features. Origin C provides access to all aspects of Origin including data import, data handling, graphing, analysis, and exporting. You can access Origin C functions from interface controls such as buttons, toolbars, and menu items, using LabTalk script.
</p><p>Origin C is organized as a set of functions with support for passing arguments. Origin C functions are compiled to object code and then loaded and executed inside of Origin. Origin C provides increased reliability and manageability for developing and debugging code of greater scope and complexity.
</p><p>Origin C also provides access to the <b>NAG Numerical Library</b> functions included in your Origin installation. NAG functions provide you with a large selection of algorithms for performing computations ranging from simple statistics and Fourier transforms to linear algebra and multivariate analysis. Origin currently supports NAG Library Version <b>Mark 26.1</b>.
</p>
<table class="note">

<tr>
<td>
<p><b>Note:</b> For more information on Origin C, please refer to the Origin C documentation: 
</p><p><b>Help: Programming: <a class="external text" href="../../OriginC/Category/Origin_C_Programming_Guide.html">Origin C</a></b>
</p><p>There you will find usage information, a language reference, developer notes, examples, etc.
</p><p>Sample files can be found in the \Samples\Origin C Examples folder of your Origin software.
</p>
</td></tr></table>
<h2><a name="X-Function"></a><span class="mw-headline">X-Function</span></h2>
<p><span class="OIndex" style="display:none">X-Functions</span><span class="OIndex" style="display:none">Programming Origin, X-Functions</span>
An X-Function is a self-contained XML file that can be loaded in Origin as a special type of global function. Origin C is the language used to create X-Functions. X-Functions provide a way to expand the functionality of Origin by adding custom data processing features. Many of the built-in tools in Origin are based on X-Functions. Once an X-Function has been created, it can be accessed from anywhere in the interface that allows for script execution, such as the script window, toolbar buttons, or custom menu items.
</p>
<table class="note">

<tr>
<td>
<p><b>Note:</b> For more information on X-Functions, please refer to your product documentation that is installed with your software: 
</p><p><b>Help: Programming: <a class="external text" href="../../XFunction/Category/X-Function_Programming_Guide.html">X-Functions</a></b>
</p><p>There, you will find information on creating and using X-Functions, a language reference, and tutorials.
</p>
</td></tr></table>
<h2><a name="Automation_Server"></a><span class="mw-headline">Automation Server</span></h2>
<p><span class="OIndex" style="display:none">Automation Server, Origin as</span><span class="OIndex" style="display:none">Visual Basic/Visual C/C#</span>
<span class="OIndex" style="display:none">Excel</span>
Origin can be used as an <b>Automation Server</b>. Client applications such as National Instruments™ <b>LabVIEW™</b>, Microsoft <b>Excel</b>, <b>Python</b>, or custom VB/VC/C# applications can exchange data with Origin, and can also send commands to be executed within Origin.
</p>
<table class="note">

<tr>
<td>
<p><b>Note:</b> For more information on Origin's Automation Server functionality, refer to the product documentation installed with your Origin software: 
</p><p><b>Help: Programming: <a class="external text" href="../../AutomationServer/Category/COM_Server.html">Automation Server</a></b>. 
</p><p>There you will find examples and language reference information.
Sample files can be found in the \Samples\COM Server and Client folder of your Origin software.
</p>
</td></tr></table>
<h2><a name="LabVIEW"></a><span class="mw-headline">LabVIEW</span></h2>
<p><span class="OIndex">National Instruments™ LabVIEW™</span> is widely used for data collection. For example, many instrument and sensor vendors provide <span class="OIndex">LabVIEW</span><span class="OIndex HasShownIndex" style="display:none">LabVIEW™</span> drivers for acquiring data. Once the data is collected, the end user will need to graph and analyze the data, and create reports for presentation. Origin provides powerful data analysis and graphing tools, including the Analysis Template feature, which allows for repeat analysis on newly acquired data. The ability to communicate between LabVIEW and Origin can thus greatly improve the efficiency of post-acquisition analysis and presentation.
</p><p>Origin ships with a collection of LabVIEW sub-VIs. LabVIEW users can simply incorporate these custom sub-VIs in their main LabVIEW application to communicate seamlessly with Origin. 
</p>
<table class="note">

<tr>
<td>
<p><b>Note:</b> For more information on Origin-LabVIEW connectivity, see the product documentation installed with your Origin software: 
</p><p><b>Help: <a class="external text" href="../../LabVIEW/Category/LabVIEW_VI.html">LabVIEW VI</a></b>
</p><p>Examples and tutorials are provided. 
</p>
</td></tr></table>
<p><br />
</p>
<h2><a name="Orglab"></a><span class="mw-headline">Orglab</span></h2>
<p><span class="OIndex">Orglab</span> is a freely distributed component DLL for directly creating or reading Origin Project (.opj) and other Origin file types (.ogg, .ogw and .ogm). It is available as a free download. An Origin license is not required to use Orglab. Typical use of Orglab is for instrument manufacturers and other third-party vendors to allow their frontend software to output data as Origin files.
</p>
<table class="note">

<tr>
<td>
<p>The Orglab module is available for 64-bit systems. To find out more about Orglab and to download the Orglab module, go to the <b>Products &gt; <a class="external text" href="http://originlab.com/index.aspx?go=Products/Orglab" target="_blank">Orglab</a></b> page of <b>www.originlab.com</b>.
</p>
</td></tr></table>


