<h1 class="firstHeading">17.5.6.2 Algorithms (Kruskal-Wallis ANOVA)</h1><p class='urlname' style='display: none'>KW-ANOVA-Algorithm</p>
<p>The procedure below draws on NAG algorithms.
</p>
<ol><li>Rank all observation in ascending order. Average ranks are assigned to tied scores</li>
<li>Sum up the ranks of observations in each group, to give the ranks sums <img src="../images/Algorithm_(kwanova)/math-6cf4401f49e69d4a93f489104fd34474.png?v=0" title=" R_i \,\!" alt=" R_i \,\!" class="tex"/>, for <img src="../images/Algorithm_(kwanova)/math-4ef08e127bbc112d645d462efa9f3b5d.png?v=0" title=" i=1,2,\ldots ,k \,\!" alt=" i=1,2,\ldots ,k \,\!" class="tex"/></li>
<li>The Kruskal-Wallis test statistic <img src="../images/Algorithm_(kwanova)/math-a2596afee8670c8ad332ca72d2d1b35d.png?v=0" title=" H \,\!" alt=" H \,\!" class="tex"/> is computed as: <img src="../images/Algorithm_(kwanova)/math-070e48b5443fd11c01cd49ccfc8263c6.png?v=0" title=" H=\frac{12}{N(N+1)}\sum_{i=1}^k\frac{R_i^2}{l_i}-3(N+1) \,\!" alt=" H=\frac{12}{N(N+1)}\sum_{i=1}^k\frac{R_i^2}{l_i}-3(N+1) \,\!" class="tex"/> where <img src="../images/Algorithm_(kwanova)/math-4b382581f2f870c7449baa3e9c477efb.png?v=0" title=" N=\sum_{i=1}^kl_i\,\!" alt=" N=\sum_{i=1}^kl_i\,\!" class="tex"/>, i.e. <img src="../images/Algorithm_(kwanova)/math-dddfbab30f141da749dec815073642cc.png?v=0" title=" N \,\!" alt=" N \,\!" class="tex"/> is the total number of observations. If there are tied scores, <img src="../images/Algorithm_(kwanova)/math-a2596afee8670c8ad332ca72d2d1b35d.png?v=0" title=" H \,\!" alt=" H \,\!" class="tex"/>is corrected by dividing by <img src="../images/Algorithm_(kwanova)/math-b3d4d467162e11667188bdb8fd11355c.png?v=0" title=" 1-\frac{\sum (t^3-t)}{N^3-N}\,\!" alt=" 1-\frac{\sum (t^3-t)}{N^3-N}\,\!" class="tex"/>where <img src="../images/Algorithm_(kwanova)/math-444ded531df49dd5e9d60e42154722ce.png?v=0" title=" t \,\!" alt=" t \,\!" class="tex"/> is the number of tied scores in a group and the summation is overall tied groups. </li></ol>
<p>The significance level is based on the <img src="../images/Algorithm_(kwanova)/math-c15009ca5cbb034d023f145a4ed23b8d.png?v=0" title="\chi ^2\,\!" alt="\chi ^2\,\!" class="tex"/> distribution, with <img src="../images/Algorithm_(kwanova)/math-777fa234183c06685e04a5579229be52.png?v=0" title=" k-1 \,\!" alt=" k-1 \,\!" class="tex"/> degree of freedom.
</p><p>For more details of the algorithm, please refer to
<a class="external text" href="http://www.originlab.com/pdfs/nagcl09/manual/pdf/g08/g08afc.pdf" target="_blank"><b>nag_kruskal_wallis_test (g08afc)</b></a>
</p>





