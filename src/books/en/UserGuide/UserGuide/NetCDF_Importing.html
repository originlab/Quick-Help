<h1 class="firstHeading">21.1 NetCDF Importing</h1><p class='urlname' style='display: none'>NetCDF-Importing</p>
<p>In Origin, we support NetCDF Connector to import and partial import  
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Import_NetCDF"><span class="tocnumber">1</span> <span class="toctext">Import NetCDF</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#NetCDF_file_location"><span class="tocnumber">1.1</span> <span class="toctext">NetCDF file location</span></a>
<ul>
<li class="toclevel-3 tocsection-3"><a href="#To_import_a_.nc_file_on_local_PC_or_network"><span class="tocnumber">1.1.1</span> <span class="toctext">To import a .nc file on local PC or network</span></a></li>
<li class="toclevel-3 tocsection-4"><a href="#To_import_a_.nc_data_on_web"><span class="tocnumber">1.1.2</span> <span class="toctext">To import a .nc data on web</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-5"><a href="#Data_Connector_Browser"><span class="tocnumber">1.2</span> <span class="toctext">Data Connector Browser</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#More_Import_options"><span class="tocnumber">1.3</span> <span class="toctext">More Import options</span></a>
<ul>
<li class="toclevel-3 tocsection-7"><a href="#Connector_icon"><span class="tocnumber">1.3.1</span> <span class="toctext">Connector icon</span></a></li>
<li class="toclevel-3 tocsection-8"><a href="#Browser_panel"><span class="tocnumber">1.3.2</span> <span class="toctext">Browser panel</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-9"><a href="#Import_NetCDF_with_different_Dimensional_Variable"><span class="tocnumber">2</span> <span class="toctext">Import NetCDF with different Dimensional Variable</span></a>
<ul>
<li class="toclevel-2 tocsection-10"><a href="#Import_1_Dimensional_Variable"><span class="tocnumber">2.1</span> <span class="toctext">Import 1 Dimensional Variable</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Import_2_Dimensional_Variable"><span class="tocnumber">2.2</span> <span class="toctext">Import 2 Dimensional Variable</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Import_3_Dimensional_Variable"><span class="tocnumber">2.3</span> <span class="toctext">Import 3 Dimensional Variable</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#Import_4_Dimensional_Variable"><span class="tocnumber">2.4</span> <span class="toctext">Import 4 Dimensional Variable</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#Import_a_Pixel_Value_in_3D.2F4D_variable_into_Worksheet_Column"><span class="tocnumber">2.5</span> <span class="toctext">Import a Pixel Value in 3D/4D variable into Worksheet Column</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-15"><a href="#Partial_import_NetCDF"><span class="tocnumber">3</span> <span class="toctext">Partial import NetCDF</span></a>
<ul>
<li class="toclevel-2 tocsection-16"><a href="#Specify_the_time_range_for_importing_data"><span class="tocnumber">3.1</span> <span class="toctext">Specify the time range for importing data</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="#Calculate_annual.2Fmonthly_average_during_import"><span class="tocnumber">3.2</span> <span class="toctext">Calculate annual/monthly average during import</span></a></li>
<li class="toclevel-2 tocsection-18"><a href="#Subregion_to_Import"><span class="tocnumber">3.3</span> <span class="toctext">Subregion to Import</span></a></li>
<li class="toclevel-2 tocsection-19"><a href="#Longitude_Shift"><span class="tocnumber">3.4</span> <span class="toctext">Longitude Shift</span></a></li>
<li class="toclevel-2 tocsection-20"><a href="#Latitude_Flip"><span class="tocnumber">3.5</span> <span class="toctext">Latitude Flip</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="#Formula"><span class="tocnumber">3.6</span> <span class="toctext">Formula</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-22"><a href="#Connection_String"><span class="tocnumber">4</span> <span class="toctext">Connection String</span></a></li>
<li class="toclevel-1 tocsection-23"><a href="#View_Mode"><span class="tocnumber">5</span> <span class="toctext">View Mode</span></a></li>
</ul>
</div>

<h2><a name="Import_NetCDF"></a><span class="mw-headline">Import NetCDF</span></h2>
<p>NetCDF file can only be imported into workbook/matrixbook. When you import .nc file, make sure workbook window or matrix window is active.
</p>
<h3><a name="NetCDF_file_location"></a><span class="mw-headline">NetCDF file location</span></h3>
<h5><a name="To_import_a_.nc_file_on_local_PC_or_network"></a><span class="mw-headline">To import a .nc file on local PC or network</span></h5>
<ol>
<li>To import a .nc file on local PC or network:
<ul><li> Drag .nc file from Windows Explorer into Origin workspace, Workbook or Matrix.</li></ul>
or
<ul><li> Choose <b>Data: Connect to File: NetCDF...</b> menu to pick the .nc file and click <b>OK</b>.</li></ul>
<li> <b>Data Connector Brower</b> dialog opens.
</ol>
<dl><dd><a  class="image"><img alt="NetCDF Importing 01.png" src="../images/NetCDF_Importing/NetCDF_Importing_01.png?v=93686" width="805"  /></a></dd></dl>
<h5><a name="To_import_a_.nc_data_on_web"></a><span class="mw-headline">To import a .nc data on web</span></h5>
<ol>
<li> Choose <b>Data: Connect to Web</b>.
 
<li> In the <b> Connect to Web</b> dialog, set <b>File Type</b> to <i>NetCDF</i> (optional) and enter URL link (e.g. <i>https://psl.noaa.gov/thredds/fileServer/Datasets/cpc_us_precip/precip.V1.0.1948.nc</i>),  or click Recent URLs if you have down import in the past. Then click <b>OK</b>.
<li> <b>Data Connector Brower</b> dialog opens.
</ol>
<h3><a name="Data_Connector_Browser"></a><span class="mw-headline">Data Connector Browser</span></h3>
<p>In the <b>Data Connector Brower</b> dialog, all variables list on the left panel with basic info. Origin only supports importing one variable at a time.
</p><p>Click variable on the left to view extra info. on the right panel. E.g. <i><b>sst</b></i> (in above image of <a href="#To_import_a_.nc_file_on_local_PC_or_network">first section</a>)  is a 3 dimensional data.
</p>
<ol>
<li> Double click or click the down arrow button to add it to the bottom panel. 

<li> If a Workbook is active and the file can be imported to either Matrix or Workbook, a dialog will popup for you to choose
<dl><dd><a  class="image"><img alt="NetCDF rmatrix.png" src="../images/NetCDF_Importing/NetCDF_rmatrix.png?v=93619" width="276"  /></a></dd></dl>
<ul><li> <b>Use a new Matrixbook</b>: this is the most straightforward way.</li>
<li> <b>Use an embedded Matrixbook</b>&#160;: this will import data into matrix but the Matrix is embedded as a sheet in Workbook.</li>
<li> <b>Worksheet Columns (can be slow)</b>&#160;: this will import each time frame of Matrix into multiple columns so it can create a Worksheet with many many columns and cause slowness if data is big. </li></ul>

<li> Click the <b>Import Options</b> button (the "pencil" icon) and choose your options. Here, you can specify a partial import, convert longitude or flip your Matrix vertically, or transform data using a formula.
<dl><dd><a  class="image"><img alt="OH netcdf import options.png" src="../images/NetCDF_Importing/OH_netcdf_import_options.png?v=87690" width="779"  /></a></dd></dl>

<li> Click <b>OK</b> to close Import Options and click <b>OK</b> again to close the Browser and import your data. Large files may take some time to import. When the file is imported a Browser panel is added to the left side of the Matrix or Workbook. 

<ul><li>If import to a Matrix, the slider at the top of the matrix window for viewing individual matrix objects.</li></ul>
<dl><dd><dl><dd><a  class="image"><img alt="OH matrix slider after import.png" src="../images/NetCDF_Importing/OH_matrix_slider_after_import.png?v=87694" width="799"  /></a></dd></dl></dd></dl>

<ul><li>If import to a Workbook, all columns are imported into a sheet.</li></ul>
</ol>
<h3><a name="More_Import_options"></a><span class="mw-headline">More Import options</span></h3>
<h4><a name="Connector_icon"></a><span class="mw-headline">Connector icon</span></h4>
<p>After importing, the <b>Connector</b> icon <a  class="image"><img alt="Dadta connector icon connect.png" src="../images/NetCDF_Importing/Dadta_connector_icon_connect.png?v=87163" width="16"  /></a> is shown on the top-left corner of the Workbook or Matrix. 
</p><p>Clicking on the  <b>Connector</b> icon：
</p>
<ul><li> Choose <b>Select...</b> to change to import another data. It will replace the previously imported data.</li>
<li> Make changes to <b>Import Options</b> by choosing <b>Options</b>.</li></ul>
<dl><dd><a  class="image"><img alt="NetCDF Connector icon.png" src="../images/NetCDF_Importing/NetCDF_Connector_icon.png?v=93720" width="635"  /></a></dd></dl>
<h4><a name="Browser_panel"></a><span class="mw-headline">Browser panel</span></h4>
<p>In the left side  Browser panel, it lists all the variable in this .nc file. And you can right-click on other variables to add them.
</p>
<ul><li><b>Add and Connect Sheet(s)</b>: Add the selected variable in a new sheet of the Workbook/Matrix.</li></ul>
<dl><dd><a  class="image"><img alt="Add and Connect Sheet.png" src="../images/NetCDF_Importing/820px-Add_and_Connect_Sheet.png?v=93726" width="820"   /></a></dd></dl>
<ul><li><b>Add to Active sheet</b>：This option is only available in importing into WorkBook. Add the selected variable to new columns in the active Worksheet. </li></ul>
<dl><dd><a  class="image"><img alt="Add to Active Sheet.png" src="../images/NetCDF_Importing/820px-Add_to_Active_Sheet.png?v=93728" width="820"   /></a></dd></dl>
<h2><a name="Import_NetCDF_with_different_Dimensional_Variable"></a><span class="mw-headline">Import NetCDF with different Dimensional Variable</span></h2>
<h3><a name="Import_1_Dimensional_Variable"></a><span class="mw-headline">Import 1 Dimensional Variable</span></h3>
<p><b>lat</b>, <b>lon</b> and <b>time</b>, <b>level</b>, etc. are 1 dimensional data. They can be imported into Workbook or Matrix. 
<br /><br />
<b>Note:</b> 
Importing 1 dimensional data when the Workbook window active, the dialog for selecting Workbook or Matrix does not pop up. Origin will auto detect it is a single cell data and import it into worksheet column.
</p>
<ol><li> With Workbook window active, choose <b>Data: Connect to File</b> in the menu and pick a .nc file.</li>
<li> In the <b>Data Connector Brower</b> dialog, double click on a variable or click the down arrow to select the variable to import. </li>
<li> The variable will be put to bottom panel. </li>
<li> Click <b>OK</b> to import. </li>
<li> Click the Data Connector icon and click <b>Select...</b> to change to import another 1 dimensional data. It will replace the previously imported data.</li>
<li> All variables are listed on left panel of the workbook. Click on any other 1 dimensional data, right click and choose <b>Add to active sheet</b> to add it to current sheet. <br />Or choose <b>Add and connect sheets</b> to import the selected variable to a new sheet in same book.</li></ol>
<h3><a name="Import_2_Dimensional_Variable"></a><span class="mw-headline">Import 2 Dimensional Variable</span></h3>
<p><b>lat</b>*<b>lon</b>, etc. are 2 dimensional data. They can be imported into Workbook or Matrix.
</p>
<ol><li> With Matrix window active, choose <b>Data: Connect to File</b> in the menu and pick a .nc file.</li>
<li> Pick a double click on a 2 dimensional variable or click the down arrow to select the variable to import. </li>
<li> Choose <b>Use a new MatrixBook</b> to import it</li>
<li> The variable will be put to bottom panel.</li>
<li> Click <b>OK</b> to import. </li>
<li> Click the Data Connector icon and click <b>Select...</b> to change to import another 2 dimensional data. It will replace the previously imported data.</li>
<li> All variables are listed on left panel of the workbook. Click on any other 2 dimensional data, right click and choose <b>Add and connect sheets</b> to import the selected variable to a new sheet in same book.</li></ol>
<p><br />
</p>
<h3><a name="Import_3_Dimensional_Variable"></a><span class="mw-headline">Import 3 Dimensional Variable</span></h3>
<p>The 3 dimensional data can be imported into Workbook or Matrix. 
</p>
<ol><li> Choose <b>Data: Connect to File</b> in the menu and pick a .nc file. Like <b>sst</b> in above image of <a href="#To_import_a_.nc_file_on_local_PC_or_network">first section</a> is a 3 dimensional variable (e.g. <i>time * lat * lon</i>)</li>
<li> Double click or click the down arrow button to add it to the bottom panel. </li>
<li> Choose <b>Use a new MatrixBook</b> to import it</li>
<li> The variable will be listed at the bottom panel.</li>
<li> Click <b>OK</b> to import.</li></ol>
<h3><a name="Import_4_Dimensional_Variable"></a><span class="mw-headline">Import 4 Dimensional Variable</span></h3>
<p>The 4 dimensional data can be imported into Workbook or Matrix. 
</p>
<ol>
<li> If the variable's Dimensionality is 4, (e.g. <i>time[248] * level[18] * lat[180] * lon[360]</i>)  and choose <b>Use a new MatrixBook</b> to import it. By default, Origin will pick the first level to import. A matrix book with one matrix sheet will be created for that level and the level value will show as matrix sheet name, each time frame will show on one matrix object. You can drag the slider on top of matrix sheet to view all imported time frames.

<li>Click the the <b>Connector</b> icon and choose <b>Select..</b> to view the connection string (e.g. <i>NetCDF/t[z][10][y][x]</i>. indicating that level 10 was imported). 

<li>It supports import multiple levels as Matrix sheets. For example, you can modify it to be <i>NetCDF/t[z][2:5][y][x]</i> to import the levels from 2 to 5. 
<br />To import all levels into matrix, the string can be modified to <i>NetCDF/t[z][1:0][y][x]</i> or <i>NetCDF/t[z][s][y][x]</i> 

<li> Use the following LabTalk script to import all 18 levels of data into one matrix book, each level on one matrix sheet. 
</ol>
<pre class="lt" style="font-family:monospace;">newbook mat<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> sheet<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">18</span>; <span style="color: #008000;">//create a matrix book with 20 sheets.</span>
string fname<span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;c:\tmp\mynetCDF\aa.nc&quot;</span>; <span style="color: #008000;">//specify filename</span>
wbook.<span style="color: #000080;">dc</span>.<span style="color: #000080;">add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;netCDF&quot;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//add netCDF connector to the matrix book</span>
loop<span style="color: #000000;">&#40;</span>i, <span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">18</span><span style="color: #000000;">&#41;</span> 
<span style="color: #000000;">&#123;</span>
   page.<span style="color: #000080;">active</span><span style="color: #000080;">=</span>i; <span style="color: #008000;">//activate ith sheet</span>
   wks.<span style="color: #000080;">dc</span>.<span style="color: #000080;">source</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>fname<span style="color: #000080;">$</span>; <span style="color: #008000;">//specify source file of the connector to the active sheet</span>
   wks.<span style="color: #000080;">dc</span>.<span style="color: #000080;">sel</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;NetCDF/t[z][$(i)][y][x]&quot;</span>; <span style="color: #008000;">//specify which level to import</span>
   wks.<span style="color: #000080;">dc</span>.<span style="color: #000080;">import</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//import</span>
<span style="color: #000000;">&#125;</span></pre>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/NetCDF_Importing/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>When using Data Connector to import NetCDF variable into a matrix as 4D, the structure protection will prevent sheet modification. That means not allow insert/delete/add sheet in this matrix or drag sheet out into new book.
</p>
<dl><dd><a  class="image"><img alt="NetCDF Importing Structure Protection.png" src="../images/NetCDF_Importing/500px-NetCDF_Importing_Structure_Protection.png?v=93672" width="500"   /></a></dd></dl>
</td></tr></table>
<h3><a name="Import_a_Pixel_Value_in_3D.2F4D_variable_into_Worksheet_Column"></a><span class="mw-headline">Import a Pixel Value in 3D/4D variable into Worksheet Column</span></h3>
<p>Origin supports importing a single pixel value e.g. on certain latitude and longitude of all time frames into a worksheet column.
For example if youu have a 3D variable <b>tas</b> of time[300]*lat[145]*lon[192] and you want to import the value at 2nd latitude and 5th longitude of all time frames into a column.
</p>
<ol><li> With workbook window active, open netCDF data connector and choose the .nc file.</li>
<li> In Data Connector Browser dialog, double click variable <b>tas</b></li>
<li> In the prompt that shows, choose the 3rd option <b>Worksheet Columns (can be slow)</b>.
<dl><dd><a  class="image"><img alt="NetCDF sheetormatrix.png" src="../images/NetCDF_Importing/NetCDF_sheetormatrix.png?v=93671" width="276"  /></a></dd></dl></li>
<li> Then in bottom panel, add <i>[x][2][5]</i> and click OK.
<dl><dd><a  class="image"><img alt="NetCDF 3D to column.png" src="../images/NetCDF_Importing/NetCDF_3D_to_column.png?v=93464" width="644"  /></a></dd></dl></li>
<li> Then in the left panel of workbook, click <b>time</b> variable. Right click it and choose <b>Add to active Sheet</b> to add time column in same sheet. Set time column as X and tas as Y so you can do further analysis an plotting.</li></ol>
<dl><dd><b>Note</b>: For 4D variable time[300]*level[20]*lat[145]*lon[192], e.g. need to add <i>[x][1][2][5]</i> to import pixel values at 2nd latitude, 5th longitude of level1 in all time frames to a column.</dd></dl>
<h2><a name="Partial_import_NetCDF"></a><span class="mw-headline">Partial import NetCDF</span></h2>
<h3><a name="Specify_the_time_range_for_importing_data"></a><span class="mw-headline">Specify the time range for importing data</span></h3>
<p>In the <b>Data Connector Brower</b>, after select the importing dataset, you can click on the <b> Import Option - Slicing, Averaging, Formular</b> button <a  class="image"><img alt="NetCDF Import Option.png" src="../images/NetCDF_Importing/NetCDF_Import_Option.png?v=87836" width="44"  /></a> to open the <b> Import Option</b> dialog.
</p>
<ul><li> <b>From</b> &amp; <b>To</b>: data-time range to import.</li></ul>
<ul><li> <b>Time Axis Skipping</b>:  Read <i>m</i> records and skip <i>n</i> records and repeat. </li></ul>
<dl><dd>For example, if data is monthly, <b>Read</b>  = <i>1</i> and <b>Skip</b> = <i>11</i> would repeat the pattern of <i>read one month and skip 11</i> for the entire date-time range.</dd>
<dd><a  class="image"><img alt="NetCDF Importing 02.png" src="../images/NetCDF_Importing/NetCDF_Importing_02.png?v=87838" width="289"  /></a></dd></dl>
<h3><a name="Calculate_annual.2Fmonthly_average_during_import"></a><span class="mw-headline">Calculate annual/monthly average during import</span></h3>
<p>In the importing process, you can import the annual/monthly average directly. <b>Averaging</b> option perform an average based on an <b>Interval</b> and either <b>Sampling</b> by <b>Across Years</b> or <b>Consecutive</b>. 
</p><p><a  class="image"><img alt="NetCDF Importing 03.png" src="../images/NetCDF_Importing/NetCDF_Importing_03.png?v=87864" width="303"  /></a>
</p><p>In the <b> Import Option</b> dialog, expand the <b>Averaging</b> section to set it.
</p>
<table class="dialogcontroltable">

<tr>
<th>Sampling
</th>
<td>
<dl><dd><ul><li><b>Consecutive</b>: Calculate an average for consecutives time.  For example, There is a dataset with 5 years. Set <b>Interval</b> = y, which means continuous 12 months. So that it is get 5 matrixes with annual average value.</li></ul></dd></dl>
<dl><dd><ul><li><b>Across Years</b>: Calculate an average for the same month across the year.  For example, There is a dataset with 5 years. Set <b>Interval</b> = m, then it get 12 matrixes and each matrix is the average value of the five years in the current month.</li></ul></dd></dl>
</td></tr>
<tr>
<th>Interval
</th>
<td>
<p>Enter numeric to indicate consecutive months.
</p><p>Enter letter: d=daily, m=monthly, y=yearly, q=quarterly
</p>
</td></tr></table>
<p><br />
Here, we use two samples to show how use <b>Time Axis Skipping</b> and <b>Averaging</b> options to import the average of yearly data in specified months.
</p><p><b>Sample 1：</b> Import the average value of 3 months (April, May and June) of each year (from 1900 to 1903)
</p>
<dl><dd><a  class="image"><img alt="NetCDF Import Average Consecutive.gif" src="../images/NetCDF_Importing/NetCDF_Import_Average_Consecutive.gif?v=90858" width="852"  /></a></dd></dl>
<p><br />
<b>Sample 2：</b> Import the average value of 4 years (from 1900 to 1903) in April, May and June three months
</p>
<dl><dd><a  class="image"><img alt="NetCDF Import Average Across Years.gif" src="../images/NetCDF_Importing/NetCDF_Import_Average_Across_Years.gif?v=90859" width="852"  /></a></dd></dl>
<p><br />
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/NetCDF_Importing/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><ul><li>From 2023b, when import consecutive daily average for a range data, <i>e.g. 2022-10-01 1:00 - 2022-10:01: 23:00</i>, we will show the matrix name only with date skipping time part <b>yyyy-mm-dd</b>, like <i>2022-10-01</i>.</li></ul>
<ul><li>Also, for consecutive yearly average, the matrix name will be shown with year, like <i>2022</i>. If you want to disable this setting, you can run the system variable <i><b>@MOL = 1</b></i>.</li></ul>
</td></tr></table>
<p><br />
</p>
<h3><a name="Subregion_to_Import"></a><span class="mw-headline">Subregion to Import</span></h3>
<p>In the <b> Import Option</b> dialog, expand the <b>Subregion</b> section to specify the importing region part with longitude and latitude, corresponding index of latitude and longitude will be found and used in connection string.
</p>
<dl><dd><a  class="image"><img alt="NetCDF subregion.png" src="../images/NetCDF_Importing/NetCDF_subregion.png?v=93483" width="561"  /></a></dd></dl>
<p>For large data, user can also do subregion + skip every N rows or columns. E.g. NetCDF/analysed_sst[z][2100:4800|1-40#][300:6600|1-50], means for for latitude from index 2100 to 4800, import 1, skip 40, # means latitude flipped, for longitude from index 300 to 6600, import 1 and skip 50.
</p>
<dl><dd><a  class="image"><img alt="NetCDF subregion skip.png" src="../images/NetCDF_Importing/NetCDF_subregion_skip.png?v=93485" width="826"  /></a></dd></dl>
<h3><a name="Longitude_Shift"></a><span class="mw-headline">Longitude Shift</span></h3>
<p>If the longitude is in approximately (0, 360) range, check this checkbox. Longitude will be shifted to (-180, 180).
</p>
<h3><a name="Latitude_Flip"></a><span class="mw-headline">Latitude Flip</span></h3>
<p>By default, the imported data is from south to north. Select this checkbox to change latitude to from north to south.
</p>
<h3><a name="Formula"></a><span class="mw-headline">Formula</span></h3>
<p>In the importing process, you can calculate new value in the matrix by formula. 
</p><p>For example, if you want to convert imported temperature data from Celsius to Fahrenheit, you can enter this formula in this edited box. <i><b>v</b></i> represent the original imported matrix cell value.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">&#40;</span>v<span style="color: #000080;">*</span><span style="color: #0000dd;">9</span><span style="color: #000080;">/</span><span style="color: #0000dd;">5</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">+</span><span style="color: #0000dd;">32</span></pre>
<h2><a name="Connection_String"></a><span class="mw-headline">Connection String</span></h2>
<p>Once you've set import options and closed the dialog, the connection string at the bottom of the left side will be updated to show the syntax we used to customize the import. You can directly double click on the string to edit/modify it. 
</p>
<dl><dd><dl><dd><a  class="image"><img alt="OH partial import connection string 1.png" src="../images/NetCDF_Importing/OH_partial_import_connection_string_1.png?v=87743" width="511"  /></a></dd></dl></dd></dl>
<p>While the connection string syntax can be complex, it follows the basic form of ...
</p>
<pre class="lt" style="font-family:monospace;">NetCDF<span style="color: #000080;">/</span>variable<span style="color: #000000;">&#91;</span>z<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#91;</span>y<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#91;</span>x<span style="color: #000000;">&#93;</span></pre>
<p>... where "variable" is the variable that you are importing, and [z],[y] and [x] specify handling, including partial import, of z, y and x dimension data. 
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/NetCDF_Importing/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><dl><dd><dl><dd> We recommend using Import Options dialog to customize import to build the Connection string.</dd>
<dd> When import 4D variable, first click the pencil button to customize how to import one level. Then get the string and modify the part between [z] &amp; [y] for level. E.g. modify the loop part in <b>Import 4 Dimensional Variables</b> section. E.g. loop i from 1 to 9, and use wks.dc.sel$="NetCDF/t[1:0|ave-d][$(i*2)][y][x]" to import every other level 2, 4, 6, ..., 18, and instead of importing all frames, import daily average. </dd></dl></dd></dl>
</td></tr></table>
<p><br />
</p>
<h2><a name="View_Mode"></a><span class="mw-headline">View Mode</span></h2>
<p>The NetCDF Matrix can be showed in <b>Data Mode</b> and <b>Image Mode</b>. You can modify it by choosing <b>View: Data Mode/ View Mode</b>. When import a new NetCDF file, the Matrix shows in <b>Data Mode</b> or <b>Image Mode</b> that depends on matrix size.
</p>
<ul><li> Generally, the matrix will shows in <b>Image Mode</b>.</li>
<li> If the matrix dimension (rows*columns) is small, <b>Data Mode</b> will be used instead of <b>Image Mode</b>. System variable <i>@VIM</i> control the minimum number of pixels to set view image on initial import. By default, <i>@VIM=400</i>.</li>
<li> The selected <b>View Mode</b> is kept , when you reimport a file in the Matrix. This is not affected by the matrix dimension.</li></ul>


