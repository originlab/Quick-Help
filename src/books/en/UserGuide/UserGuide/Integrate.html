<h1 class="firstHeading">16.7 Integrate</h1><p class='urlname' style='display: none'>Math-Integrate</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#To_Use_Integration_Tool"><span class="tocnumber">1.1</span> <span class="toctext">To Use Integration Tool</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-3"><a href="#Dialog_Options"><span class="tocnumber">2</span> <span class="toctext">Dialog Options</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Algorithm"><span class="tocnumber">3</span> <span class="toctext">Algorithm</span></a></li>
</ul>
</div>

<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p><a  class="image"><img alt="NumericalIntegration.png" src="../images/Integrate/400px-NumericalIntegration.png?v=71173" width="400"   /></a><br /><br />
<b>Integration</b> tool performs numerical integration on the active data plot using the trapezoidal rule. You can choose to calculate the <b>Mathematical Area</b> (the algebraic sum of trapezoids) or an <b>Absolute Area</b> (the sum of absolute trapezoid values). Missing values are ignored. 
</p>
<h5><a name="To_Use_Integration_Tool"></a><span class="mw-headline">To Use Integration Tool</span></h5>
<ol><li>Create a new worksheet with input data.</li>
<li>Highlight the selected data.</li>
<li>Select <b>Analysis: Mathematics: Integrate</b> from the Origin menu to open the <b>Integ1</b> dialog box. </li></ol>
<p>The X-Function <a class="external text" href="../../XFunction/X-Function/Integ1.html">Integ1</a> is called to perform the calculation. The user has the option to specify that the area, peak location, peak width, and peak height (maximum deflection from the X axis), are written to the Result Log. In addition, you can choose to integrate using a simple baseline defined by a straight line connecting the end points of the curve and to create a plot of the integral curve.
</p>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Integrate/Alert_icon.png?v=9649" width="57"  border="0" /></td><td><p>Note: This tool uses pure, math-based integration which may produce unexpectedly negative results for area when the X values used in the integration are in descending order. This is normal behavior due to the nature of the integration calculations.
</p>
	</td>
	</tr>
	</table>
<h2><a name="Dialog_Options"></a><span class="mw-headline">Dialog Options</span></h2>
<table class="dialogcontroltable">

<tr>
<th> Results Log Output
</th>
<td> Select to output area, peak location, peak width, and peak height to the Results Log.
</td></tr>
<tr>
<th><b>Recalculate</b>
</th>
<td>
<p>Controls recalculation of analysis results
</p>
<ul><li><b>None</b> </li>
<li><b>Auto</b> </li>
<li><b>Manual</b>  </li></ul>
<p>For more information, see: <a class="external text" href="../../UserGuide/UserGuide/Recalculating_Analysis_Results.html">Recalculating Analysis Results</a>
</p>
</td></tr>
<tr>
<th>Input
</th>
<td>
<p>Specify the input data to be integrated.
</p><p>For help with range controls, see: <a class="external text" href="../../UserGuide/UserGuide/Specifying_Your_Input_Data.html">Specifying Your Input Data</a>
</p>
</td></tr>
<tr>
<th>Use End Points Straight Line as Baseline
</th>
<td>
<p>Specify whether to create a straight line that crosses the end points and use it as the baseline for the integration. 
</p>
</td></tr>
<tr>
<th>Area Type
</th>
<td>
<p>Specify the integral area type. Please see the Algorithm section below, for more details. 
</p>
<ul><li><b>Mathematical Area</b>
<dl><dd>The area is the algebraic sum of trapezoids.</dd></dl></li>
<li><b>Absolute Area</b>
<dl><dd>The area is sum of absolute trapezoid values.  </dd></dl></li></ul>
</td></tr>
<tr>
<th>Output Quantities
</th>
<td>
<p>Specify the quantities to be outputted when the <b>Integration Result</b> box is checked (see below).
</p>
<ul><li><b>Dataset Identifier</b>
<dl><dd>Choose a dataset identifier for use when the <b>Integration Result</b> box is checked.</dd></dl></li>
<li><b>Beginning Row Index</b>
<dl><dd>Specify whether to output the beginning row index.</dd></dl></li>
<li><b>Ending Row Index</b>
<dl><dd>Specify whether to output the ending row index.</dd></dl></li>
<li><b>Beginning X</b>
<dl><dd>Specify whether to output the beginning X value.</dd></dl></li>
<li><b>Ending X</b> 
<dl><dd>Specify whether to output the ending X value.</dd></dl></li>
<li><b>Max Height</b>
<dl><dd>Specify whether to output the maximum height, as computed from the baseline.</dd></dl></li>
<li><b>X at Max Height</b>
<dl><dd>Specify whether to output the X value that corresponds to the maximum height.</dd></dl></li>
<li><b>Area</b>
<dl><dd>Specify whether to output the integration area.</dd></dl></li>
<li><b>FWHM</b>
<dl><dd>Specify whether to output the peak width at half height of the source curve.</dd></dl></li></ul>
<p><b>Note:</b> The beginning and ending X values and the integrated area are output to the Comments row of the integration results column, regardless of whether the Output Quantities <b>Beginning X</b>, <b>Ending X</b> and <b>Area</b> are enabled.
</p>
</td></tr>
<tr>
<th>Integral Curve Data
</th>
<td>
<p>Specify the range to output the cumulative result. 
</p>
</td></tr>
<tr>
<th>Integration Result
</th>
<td>
<p>Specify whether output the intergration result in a report sheet.
</p>
</td></tr>
<tr>
<th>Plot Integral Curve
</th>
<td>
<p>Specify whether to plot the integral curve, and where to plot the integral curve.
</p>
<ul><li><b>None</b>
<dl><dd>Do not plot the integral curve.</dd></dl></li>
<li><b>New Graph</b>
<dl><dd>Plot the integral to a new graph. </dd></dl></li>
<li><b>Source Graph</b>
<dl><dd>Plot the integral in the source graph. This option is available when a graph window is the active window. </dd></dl></li></ul>
</td></tr>
<tr>
<th>Rescale Source Graph
</th>
<td>
<p>Rescale the source graph when the integral is plotted into it. This check-box is available when the <b>Plot Integral Curve</b> is <b>Source Graph</b>.
</p>
</td></tr></table>
<h2><a name="Algorithm"></a><span class="mw-headline">Algorithm</span></h2>
<p>Numerical integration involves calculating a definite integral by an approximate function:
</p>
<dl><dd><img src="../images/Integrate/math-db625ff0285f87a97833a1a0536c0781.png?v=0" title="\int _{a}^{b}f(x)dx" alt="\int _{a}^{b}f(x)dx" class="tex"/></dd></dl>
<p>Since the original data are discrete, we use a pair of adjacent values to form a trapezoid for approximating the area beneath the segment of the curve defined by the two points:
</p><p><a  class="image"><img alt="Integ.png" src="../images/Integrate/Integ.png?v=22088" width="299"  /></a>
</p><p>As illustrated above, the curve is divided into pieces and we calculate the sum of each trapezoid to estimate the integral by:
</p>
<dl><dd><img src="../images/Integrate/math-02e1de68d6e5a54203ad7578c5a02844.png?v=0" title="\int _{x_1}^{x_n}f(x)dx \approx \sum _{i=1}^{n-1}( x_{i+1} -x_i) \frac{1}{2}[f(x_{i+1})+f(x_i)] " alt="\int _{x_1}^{x_n}f(x)dx \approx \sum _{i=1}^{n-1}( x_{i+1} -x_i) \frac{1}{2}[f(x_{i+1})+f(x_i)] " class="tex"/></dd></dl>
<ul><li><b>Difference between Mathematical Area and Absolute Area</b></li></ul>
<p>Given a baseline <img src="../images/Integrate/math-dd1e934594d651730dec0b7e28d8db3a.png?v=0" title="y=f(x_0 )\!" alt="y=f(x_0 )\!" class="tex"/>, the mathematical area of <img src="../images/Integrate/math-a71c9a0cb0b8e83221630349cf929fad.png?v=0" title="f(x)\!" alt="f(x)\!" class="tex"/> can be calculated by
</p>
<dl><dd><img src="../images/Integrate/math-a25d330f4319359dc2e20213e8096e19.png?v=0" title="\int _{x_1}^{x_n} \left[f \left( x \right)-f \left( x_0 \right) \right] \,dx \approx \sum _{i=1}^{n-1} \frac{1}{2} \left( x_{i+1} -x_i \right) \left[ \left( f \left( x_{i+1} \right) -f \left( x_0 \right) \right) + \left( f \left( x_i \right) -f \left( x_0 \right) \right) \right]" alt="\int _{x_1}^{x_n} \left[f \left( x \right)-f \left( x_0 \right) \right] \,dx \approx \sum _{i=1}^{n-1} \frac{1}{2} \left( x_{i+1} -x_i \right) \left[ \left( f \left( x_{i+1} \right) -f \left( x_0 \right) \right) + \left( f \left( x_i \right) -f \left( x_0 \right) \right) \right]" class="tex"/></dd></dl>
<p>If the sum of each trapezoid's area absolute value is computed, we can get the absolute area:
</p>
<dl><dd><img src="../images/Integrate/math-2c032ecbce6257d0ec1dfd6f4510b0ad.png?v=0" title="\int _{x_1}^{x_n} | \left[f \left( x \right)-f \left( x_0 \right) \right] | \,dx \approx \sum _{i=1}^{n-1} \frac{1}{2} \left( x_{i+1} -x_i \right) | \left[ \left( f \left( x_{i+1} \right) -f \left( x_0 \right) \right) + \left( f \left( x_i \right) -f \left( x_0 \right) \right) \right] |" alt="\int _{x_1}^{x_n} | \left[f \left( x \right)-f \left( x_0 \right) \right] | \,dx \approx \sum _{i=1}^{n-1} \frac{1}{2} \left( x_{i+1} -x_i \right) | \left[ \left( f \left( x_{i+1} \right) -f \left( x_0 \right) \right) + \left( f \left( x_i \right) -f \left( x_0 \right) \right) \right] |" class="tex"/></dd></dl>
<p><a  class="image"><img alt="Integ22.png" src="../images/Integrate/Integ22.png?v=22152" width="493"  /></a>
</p><p>As illustrated above, the baseline is <img src="../images/Integrate/math-dd1e934594d651730dec0b7e28d8db3a.png?v=0" title="y=f(x_0 )\!" alt="y=f(x_0 )\!" class="tex"/> and the curve is divided into five trapezoids (or triangles). The area of each trapezoid (or triangle) is calculated by
</p>
<dl><dd><img src="../images/Integrate/math-741a03a31a9c340fc809dbde0bfd9d03.png?v=0" title="A_i = \frac{1}{2} \left( x_{i+1} -x_i \right) \left[ \left( f \left( x_{i+1} \right) -f \left( x_0 \right) \right) + \left( f \left( x_i \right) -f \left( x_0 \right) \right) \right]" alt="A_i = \frac{1}{2} \left( x_{i+1} -x_i \right) \left[ \left( f \left( x_{i+1} \right) -f \left( x_0 \right) \right) + \left( f \left( x_i \right) -f \left( x_0 \right) \right) \right]" class="tex"/></dd></dl>
<p>From the expression, we determine that <img src="../images/Integrate/math-49d13e07a9447d5e630f87b63c85691b.png?v=0" title="A_1\!" alt="A_1\!" class="tex"/>, <img src="../images/Integrate/math-592b3a7638d6da52b3853f3fdf596a50.png?v=0" title="A_2\!" alt="A_2\!" class="tex"/> and <img src="../images/Integrate/math-375589569aca2679e52b2a1aede0cf7f.png?v=0" title="A_3\!" alt="A_3\!" class="tex"/>, which are above the baseline, are positive, but <img src="../images/Integrate/math-0f938ef309155e541908ff183035eb41.png?v=0" title="A_4\!" alt="A_4\!" class="tex"/> and <img src="../images/Integrate/math-c01ef2db69dcb67463804b4c2dc3b23e.png?v=0" title="A_5\!" alt="A_5\!" class="tex"/>, which are beneath the baseline, are negative.
</p><p>So the mathematical area of this curve should be <img src="../images/Integrate/math-f51515e5e9a0971b5006e88db4a39fbe.png?v=0" title="A_1+A_2+A_3+A_4+A_5\!" alt="A_1+A_2+A_3+A_4+A_5\!" class="tex"/> and the absolute area of this curve should be <img src="../images/Integrate/math-b00d4d4f70cba159c582ac2a35e64d67.png?v=0" title="|A_1|+|A_2|+|A_3|+|A_4|+|A_5|=A_1+A_2+A_3-A_4-A_5\!" alt="|A_1|+|A_2|+|A_3|+|A_4|+|A_5|=A_1+A_2+A_3-A_4-A_5\!" class="tex"/>.
</p>

