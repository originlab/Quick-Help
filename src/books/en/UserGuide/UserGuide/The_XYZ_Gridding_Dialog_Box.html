<h1 class="firstHeading">14.2.1 The XYZ Gridding (XYZ Log Gridding) Dialog Box</h1><p class='urlname' style='display: none'>XYZGridding-Dialog</p>
<p><br />
The <b>XYZ Gridding</b> and <b>XYZ Log Gridding</b> dialog box can be accessed by selecting <b>Worksheet: Convert to Matrix: XYZ Gridding</b> and <b>Worksheet: Convert to Matrix: XYZ Log Gridding</b> from the menu respectively. Both dialog boxes have two panels: the left panel provides parameter controls, while the right panel provides several feature preview tabs, and the settings are the same in each. 
</p>
<dl><dd><a  class="image"><img alt="The XYZ Gridding Dialog Box.png" src="../images/The_XYZ_Gridding_Dialog_Box/The_XYZ_Gridding_Dialog_Box.png?v=88984" width="799"  /></a></dd></dl>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Input_Data"><span class="tocnumber">1</span> <span class="toctext">Input Data</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Data_Examination"><span class="tocnumber">2</span> <span class="toctext">Data Examination</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Gridding_Method_and_Parameters"><span class="tocnumber">3</span> <span class="toctext">Gridding Method and Parameters</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Advanced"><span class="tocnumber">4</span> <span class="toctext">Advanced</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#No_Extrapolation_outside_Boundary"><span class="tocnumber">5</span> <span class="toctext">No Extrapolation outside Boundary</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Preview_Plot_Type"><span class="tocnumber">6</span> <span class="toctext">Preview Plot Type</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Output"><span class="tocnumber">7</span> <span class="toctext">Output</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Preview.28Right.29_Panel:"><span class="tocnumber">8</span> <span class="toctext">Preview(Right) Panel:</span></a></li>
</ul>
</div>

<h2><a name="Input_Data"></a><span class="mw-headline">Input Data</span></h2>
<p>One or more Z columns in a worksheet are required. If you highlight Z column(s) before opening the XYZ Gridding or XYZ Log Gridding dialog box, Origin will set the range according to the selection. Once the dialog is open, you can modify the range with the dialog controls in the Advanced branch.
</p><p>If multiple Z columns are specified, each Z column will be converted to a matrix object of the same matrix sheet.
</p>
<dl><dd><a  class="image"><img alt="UG convert XYZZZ 2 matrix.png" src="../images/The_XYZ_Gridding_Dialog_Box/UG_convert_XYZZZ_2_matrix.png?v=93531" width="741"  /></a></dd></dl>
<h2><a name="Data_Examination"></a><span class="mw-headline">Data Examination</span></h2>
<p>Multiple Z values that correspond to the same XY data pairs are not allowed. There are three controls are used to determine (a) whether two XY pairs should be treated as the same and (b) how Z values associated with such duplicate pairs should be handled.
</p>
<table class="dialogcontroltable">

<tr>
<th> Tolerance for Duplicate X
</th>
<td> Specify the tolerance used to detect duplicate X coordinate data. For two adjacent points (x<sub>1</sub>, y<sub>1</sub>, z<sub>1</sub>) and (x<sub>2</sub>, y<sub>2</sub>, z<sub>2</sub>), if
<dl><dd><img src="../images/The_XYZ_Gridding_Dialog_Box/math-a059807ad61e3d2967d7ac0fd59d5b34.png?v=0" title="\left | \frac{x_1-x_2}{x_1+x_2} \right | &lt; Tolerance" alt="\left | \frac{x_1-x_2}{x_1+x_2} \right | &lt; Tolerance" class="tex"/></dd></dl>
<p>These two X values will be considered to be duplicates. The <b>Tolerance of Duplicate X</b> value should between (0, 1).
</p>
</td></tr>
<tr>
<th> Tolerance for Duplicate Y
</th>
<td> Specify the tolerance used to detect duplicate Y coordinate data. For two adjacent points (x<sub>1</sub>, y<sub>1</sub>, z<sub>1</sub>) and (x<sub>2</sub>, y<sub>2</sub>, z<sub>2</sub>), if
<dl><dd><img src="../images/The_XYZ_Gridding_Dialog_Box/math-d6c8801878c117379a624b49d0884e40.png?v=0" title="\left | \frac{y_1-y_2}{y_1+y_2} \right | &lt; Tolerance" alt="\left | \frac{y_1-y_2}{y_1+y_2} \right | &lt; Tolerance" class="tex"/></dd></dl>
<p>These two Y values will be considered to be duplicates. The <b>Tolerance of Duplicate Y</b> value should between (0, 1).
</p>
</td></tr>
<tr>
<th> Replace Duplicates With
</th>
<td> If two Z values correspond to the same XY data pairs (tolerances are considered), these Z values should be merged into a new value. Use this drop-down list to specify the new value. It could be <b>Mean</b>, <b>Median</b>, <b>Maximum</b>, <b>Minimum</b> or <b>Sum</b>.
</td></tr></table>
<p>After handling the duplicate XY pair data, it will be examined whether the data are regularly spaced.There are two controls which are used to examine whether the data are regularly spaced in both X dimension and Y dimension.
</p>
<table class="dialogcontroltable">

<tr>
<th> Tolerance for Even X Step
</th>
<td>
<p>Specify the tolerance used to examine the regularity of X data. For every two adjacent points (x<sub>i</sub>, y<sub>i</sub>, z<sub>i</sub>) and (x<sub>i+1</sub>, y<sub>i+1</sub>, z<sub>i+1</sub>), if
</p>
<dl><dd><img src="../images/The_XYZ_Gridding_Dialog_Box/math-6014690389b02c64a7fe383762f806a0.png?v=0" title="\frac{\left|x_i-x_{i+1}\right| \bmod I_x}{I_x}&lt; Tolerance" alt="\frac{\left|x_i-x_{i+1}\right| \bmod I_x}{I_x}&lt; Tolerance" class="tex"/></dd></dl>
<p>or
</p>
<dl><dd><img src="../images/The_XYZ_Gridding_Dialog_Box/math-51652bfbe244e0dfe2011a29bcf02186.png?v=0" title="\frac{\left|x_i-x_{i+1}\right| \bmod I_x}{I_x}&gt;1 - Tolerance" alt="\frac{\left|x_i-x_{i+1}\right| \bmod I_x}{I_x}&gt;1 - Tolerance" class="tex"/></dd></dl>
<p>where <b>I<sub>x</sub></b> is the average interval between X data.<br />
</p><p>These X data will be considered to be regularly spaced. The <b>Tolerance of Even X step</b> should between (0, 1).
</p>
</td></tr>
<tr>
<th> Tolerance for Even Y Step
</th>
<td>
<p>Specify the tolerance used to examine the regularity of Y data. For every two adjacent points (x<sub>i</sub>, y<sub>i</sub>, z<sub>i</sub>) and (x<sub>i+1</sub>, y<sub>i+1</sub>, z<sub>i+1</sub>), if
</p>
<dl><dd><img src="../images/The_XYZ_Gridding_Dialog_Box/math-2e8f2aac7bb10cae2ecbe0a3113ac8d6.png?v=0" title="\frac{\left|y_i-y_{i+1}\right| \bmod I_y}{I_y}&lt; Tolerance" alt="\frac{\left|y_i-y_{i+1}\right| \bmod I_y}{I_y}&lt; Tolerance" class="tex"/></dd></dl>
<p>or
</p>
<dl><dd><img src="../images/The_XYZ_Gridding_Dialog_Box/math-1f9479d0b932c9bfd3c40c0328517d3a.png?v=0" title="\frac{\left|y_i-y_{i+1}\right| \bmod I_y}{I_y}&gt;1 - Tolerance" alt="\frac{\left|y_i-y_{i+1}\right| \bmod I_y}{I_y}&gt;1 - Tolerance" class="tex"/></dd></dl>
<p>where <b>I<sub>y</sub></b> is the average interval between Y data.<br />
</p><p>These Y data will be considered to be regularly spaced. The <b>Tolerance of Even Y step</b> should between (0, 1).
</p>
</td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/The_XYZ_Gridding_Dialog_Box/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>Only if the data is considered to be regularly spaced, the <b><a href="../../UserGuide/UserGuide/Gridding_of_Regularly_Spaced_Data.html" title="UserGuide:Gridding of Regularly Spaced Data">Regular</a></b> and the <b><a href="../../UserGuide/UserGuide/Gridding_of_Sparse_or_Missing_Data.html" title="UserGuide:Gridding of Sparse or Missing Data">Sparse</a></b> can be selected in the drop-down list of <b>Gridding Method and Parameters</b>. If not, you can try random conversion method, or try to increase the tolerances for duplicate and even step.
</p></td></tr></table>
<h2><a name="Gridding_Method_and_Parameters"></a><span class="mw-headline">Gridding Method and Parameters</span></h2>
<p>Select the gridding methods and configure the gridding parameters. Note that the controls vary by gridding method. 
</p>
<table class="dialogcontroltable">

<tr>
<th> Gridding Method and Parameters
</th>
<td>
<p>Specify the gridding method.
</p>
<ul><li> <a href="../../UserGuide/UserGuide/Gridding_of_Regularly_Spaced_Data.html" title="UserGuide:Gridding of Regularly Spaced Data">Regular</a></li>
<li> <a href="../../UserGuide/UserGuide/Gridding_of_Sparse_or_Missing_Data.html" title="UserGuide:Gridding of Sparse or Missing Data">Sparse</a></li>
<li> <a href="../../UserGuide/UserGuide/Gridding_Methods_for_Randomly_Spaced_Data.html#Renka_Cline" title="UserGuide:Gridding Methods for Randomly Spaced Data">Renka Cline</a></li>
<li> <a href="../../UserGuide/UserGuide/Gridding_Methods_for_Randomly_Spaced_Data.html#Shepard" title="UserGuide:Gridding Methods for Randomly Spaced Data">Shepard</a></li>
<li> <a href="../../UserGuide/UserGuide/Gridding_Methods_for_Randomly_Spaced_Data.html#Thin_Plate_Spline_.28TPS.29" title="UserGuide:Gridding Methods for Randomly Spaced Data">Thin Plate Spline</a></li>
<li> <a href="../../UserGuide/UserGuide/Gridding_Methods_for_Randomly_Spaced_Data.html#Kriging_Correlation" title="UserGuide:Gridding Methods for Randomly Spaced Data">Kriging Correlation</a></li>
<li> <a href="../../UserGuide/UserGuide/Gridding_Methods_for_Randomly_Spaced_Data.html#Weighted_Average" title="UserGuide:Gridding Methods for Randomly Spaced Data">Weighted Average</a></li></ul>
</td></tr>
<tr>
<th> Columns
</th>
<td>
<p>Specify the number of columns of the output matrix.  
</p>
</td></tr>
<tr>
<th> Rows
</th>
<td>
<p>Specify the number of rows of the output matrix.
</p>
</td></tr>
<tr>
<th> Quadratic Interpolant Locality Factor
<p>(q)
</p>
</th>
<td>
<p>This is only available when <b>Random (Shepard)</b> is selected in the <b>Gridding Method and Parameters</b> drop-down list.
</p><p>Use the quadratic interpolant locality factor (q) to calculate the influence radius of the local approximate quadratic fitted function for each node when using the <a href="../../UserGuide/UserGuide/Gridding_Methods_for_Randomly_Spaced_Data.html#Shepard" title="UserGuide:Gridding Methods for Randomly Spaced Data">Shepard</a> gridding method.  
</p><p>By default, <b> <i>q</i> = 18 </b>.  For best results,  <b> <i>q</i> </b> should approximately equal <b>2<i>w</i></b> and <i><b>w</b></i> should be greater than <b>0</b>. Modifying these factors may increase gridding accuracy, though computation time will increase significantly for large values (i.e. values that decrease the locality of the method.)
</p>
</td></tr>
<tr>
<th> Weight Function Locality Factor
<p>(w)
</p>
</th>
<td>
<p>This is only available when <b>Random (Shepard)</b> is selected in the <b>Gridding Method and Parameters</b> drop-down list.
</p><p>Use it to specify the weight function locality factor w, which is used to calculate the weighting radius for each node. 
</p><p>By default,<b> <i>w</i> = 9</b>. For best results,  <i><b>q</b></i> should approximately equal <b>2<i>w</i></b> and <i><b>w</b></i> should be greater than <b>0</b>. Modifying these factors may increase gridding accuracy, though computation time will increase significantly for large values (i.e. values that decrease the locality of the method.)
</p>
</td></tr>
<tr>
<th> Smoothing
</th>
<td>
<p>This is only available when either <a href="../../UserGuide/UserGuide/Gridding_Methods_for_Randomly_Spaced_Data.html#Thin_Plate_Spline_.28TPS.29" title="UserGuide:Gridding Methods for Randomly Spaced Data">Thin Plate Spline</a> or <a href="../../UserGuide/UserGuide/Gridding_Methods_for_Randomly_Spaced_Data.html#Kriging_Correlation" title="UserGuide:Gridding Methods for Randomly Spaced Data">Kriging Correlation</a> is selected in the <b>Gridding Method and Parameters</b> drop-down list.
</p><p>This non-negative value specifies the extent to which the gridding surface will depart from the input data points.  If the smoothing factor is zero, no smoothing is performed and the interpolated surface will pass though all data points.  A positive smoothing factor will smooth the surface. However, a factor that is too large will obscure the original data.
</p>
</td></tr>
<tr>
<th> Extrapolation
</th>
<td>
<p>This is only available when <a href="../../UserGuide/UserGuide/Gridding_Methods_for_Randomly_Spaced_Data.html#Thin_Plate_Spline_.28TPS.29" title="UserGuide:Gridding Methods for Randomly Spaced Data">Thin Plate Spline</a>  is selected in the <b>Gridding Method and Parameters</b> drop-down list.
</p><p>Please see <a href="../../UserGuide/UserGuide/Gridding_Methods_for_Randomly_Spaced_Data.html#Thin_Plate_Spline_.28TPS.29" title="UserGuide:Gridding Methods for Randomly Spaced Data">the algorithm description</a> for details.
</p>
</td></tr>
<tr>
<th> Search Radius
</th>
<td>
<p>This is only available when either <a href="../../UserGuide/UserGuide/Gridding_Methods_for_Randomly_Spaced_Data.html#Weighted_Average" title="UserGuide:Gridding Methods for Randomly Spaced Data">Weighted Average</a> or <a href="../../UserGuide/UserGuide/Gridding_Methods_for_Randomly_Spaced_Data.html#Kriging_Correlation" title="UserGuide:Gridding Methods for Randomly Spaced Data">Kriging Correlation</a> is selected in the <b>Gridding Method and Parameters</b> drop-down list.
</p><p>Please see <a href="../../UserGuide/UserGuide/Gridding_Methods_for_Randomly_Spaced_Data.html" title="UserGuide:Gridding Methods for Randomly Spaced Data">the algorithm description</a> for details.
</p>
</td></tr>
<tr>
<th> Minimum Points
</th>
<td>
<p>This is only available when either <a href="../../UserGuide/UserGuide/Gridding_Methods_for_Randomly_Spaced_Data.html#Kriging_Correlation" title="UserGuide:Gridding Methods for Randomly Spaced Data">Kriging Correlation</a> is selected in the <b>Gridding Method and Parameters</b> drop-down list.
</p><p>Please see <a href="../../UserGuide/UserGuide/Gridding_Methods_for_Randomly_Spaced_Data.html#Kriging_Correlation" title="UserGuide:Gridding Methods for Randomly Spaced Data">the algorithm description</a> for details.
</p>
</td></tr></table>
<h2><a name="Advanced"></a><span class="mw-headline">Advanced</span></h2>
<p>Advanced options for gridding ranges and matrix coordinates.
</p>
<table class="dialogcontroltable">

<tr>
<th> Range Restriction
</th>
<td>
<p>Specify the boundary of the input data range. By default, all data points are included. In order to exclude bad or unwanted data points, you can restrict the input data range by editing the minimum and maximum XY coordinates (<b>Note:</b> You can see the effects on the XY Range tab of the preview panel). 
</p>
<dl><dd><b>X Minimum</b> 
<dl><dd>the minimum X value of the output matrix.</dd></dl></dd>
<dd><b>X Maximum</b>
<dl><dd>the maximum X value of the output matrix.</dd></dl></dd>
<dd><b>Y Minimum</b> 
<dl><dd>the minimum Y value of the output matrix.</dd></dl></dd>
<dd><b>Y Maximum</b> 
<dl><dd>the maximum Y value of the output matrix.</dd></dl></dd></dl>
</td></tr></table>
<h2><a name="No_Extrapolation_outside_Boundary"></a><span class="mw-headline">No Extrapolation outside Boundary</span></h2>
<p>This check box is shown for <b>Gridding Method and Parameters</b> options except <i>Regular</i> or <i>Sparse</i>. The box is unchecked by default.
</p><p>Checking this box causes grid points outside the data boundary (as determined by triangulation of input points) to be treated as missing values. As you increase the number of <b>Columns</b> and <b>Rows</b> (under <a href="#Gridding_Method_and_Parameters"><b>Gridding Method and Parameters</b></a>) the outermost grid points will approach the true data boundary.
</p>
<dl><dd><a  class="image"><img alt="No Extrapolation outside Boundary.png" src="../images/The_XYZ_Gridding_Dialog_Box/No_Extrapolation_outside_Boundary.png?v=88998" width="579"  /></a></dd></dl>
<p>This option uses the algorithm of the <a href="../../UserGuide/UserGuide/Creating_Contour_Graphs.html#Generate_Grid_from_XYZ_Contour_Plot" title="UserGuide:Creating Contour Graphs">Generate Grid from XYZ Contour Plot</a> feature.
</p>
<h2><a name="Preview_Plot_Type"></a><span class="mw-headline">Preview Plot Type</span></h2>
<p>Control the plot type depicted on the <b>Preview Result</b> tab:
</p>
<ul><li> <b>3D Color Map Surface</b></li></ul>
<ul><li> <b>Contour - Color Fill</b></li></ul>
<ul><li> <b>3D Wire Frame</b></li></ul>
<h2><a name="Output"></a><span class="mw-headline">Output</span></h2>
<p>Specify whether and how to output the gridding data:
</p>
<ul><li><b>Output Matrix</b></li></ul>
<p>Select to output gridding data as a matrix.
</p>
<ul><li><b>Output Virtual Matrix</b></li></ul>
<p>Select to output gridding data as a worksheet arranged as a virtual matrix. When multi-Z columns are specified as input, Virtual Matrix is not supported.
</p>
<h2><a name="Preview.28Right.29_Panel:"></a><span class="mw-headline">Preview(Right) Panel:</span></h2>
<p>This panel provides various preview options.  
</p>
<table class="dialogcontroltable">

<tr>
<th> XY Range
</th>
<td>
<p>The plot on the XY Range tab provides a 2D view of your XY coordinate data.  
</p>
</td></tr>
<tr>
<th> X/Y Steps
</th>
<td>
<p>The distribution of steps in X or Y coordinates. Because the rows and columns of gridding are associated with X step and Y step, the value will change synchronously when you edit one of them.
</p>
</td></tr>
<tr>
<th> Preview Result
</th>
<td>
<p>Preview the gridding result.  The preview plot type is determined by the <b>Preview Plot Type</b> list selection. Note that the display of the preview graph may be slow with very large data sets.
</p>
</td></tr></table>


