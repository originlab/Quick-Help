<h1 class="firstHeading">4.4.18 Pivot Table</h1><p class='urlname' style='display: none'>Wks-Pivot-Table</p>
<p><br />
</p>
<div style="text-align: left; direction: ltr; margin-left: 1em;">
<p><a  class="image"><img alt="Video Image.png" src="../images/Pivot_Table/Video_Image.png?v=29468" width="33"  /></a> See more related video:<a class="external text" href="http://www.originlab.com/index.aspx?go=Products/Origin/DataAnalysis&amp;ss=chm&amp;pid=1574" target="_blank">Pivot Table</a>

</p></div>
<p>A pivot table is a data summary tool commonly found in data-analysis software. The table is constructed by taking a dataset consisting of observations collected across a number of variables, picking two categorical variables of interest -- let's call them <i>var1</i> and <i>var2</i> -- then letting all possible values of <i>var1</i> define rows in the table, and all possible values of <i>var2</i> define columns in the table. Table cells would then contain values that result from the intersection of row and column values. A parallel of pivot table is a matrix, with the <i>var1</i> as rows,  <i>var2</i> as columns, pivot table data as the elements of the matrix. By saving an analysis template with pivot table, you can quickly create similar data summary for different dataset. 
Origin's pivot table tool includes support for the following:
</p>
<dl><dd><ul><li> Summarize data by counts, or report a sum, a mean or min/max values. </li>
<li> Provide totals on rows and columns.</li>
<li> Sort output rows and columns by row totals or labels.</li>
<li> Normalize by fractions or percentages.</li>
<li> Combine smaller values into an "other" column.</li>
<li> Adjust parameters and instantly recalculate.</li></ul></dd></dl>
<p>To open this tool:
</p>
<ol><li> Click on the worksheet that you want to analyze.</li>
<li> Click <b>Restructure: Pivot Table</b>... to open the <b>wpivot</b> dialog box.</li></ol>
<p>The wpivot dialog uses the <a class="external text" href="../../XFunction/X-Function/Wpivot.html">the wpivot X-Function</a>.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Dialog_Options"><span class="tocnumber">1</span> <span class="toctext">Dialog Options</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Pivot_Table_Row_Source"><span class="tocnumber">1.1</span> <span class="toctext">Pivot Table Row Source</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Pivot_Table_Column_Source"><span class="tocnumber">1.2</span> <span class="toctext">Pivot Table Column Source</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Pivot_Table_Data_Source"><span class="tocnumber">1.3</span> <span class="toctext">Pivot Table Data Source</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Combine_Smaller_Values"><span class="tocnumber">1.4</span> <span class="toctext">Combine Smaller Values</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Options"><span class="tocnumber">1.5</span> <span class="toctext">Options</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Output_Result_Table_to"><span class="tocnumber">1.6</span> <span class="toctext">Output Result Table to</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="Dialog_Options"></a><span class="mw-headline">Dialog Options</span></h2>
<dl><dd><a  class="image"><img alt="Pivot Table Dialog.png" src="../images/Pivot_Table/Pivot_Table_Dialog.png?v=48646" width="478"  /></a></dd></dl>
<h3><a name="Pivot_Table_Row_Source"></a><span class="mw-headline">Pivot Table Row Source</span></h3>
<p>Specify the column range that will be used as the row source of the pivot table. Data in the source worksheet with the same name in row source range will be displayed as a single row in the pivot table.The following diagram illustrates the definition of row source.  You can choose one or more data range as pivot table row source. 
</p><p><a  class="image"><img alt="Pv rowresource.png" src="../images/Pivot_Table/Pv_rowresource.png?v=48829" width="1011"  /></a> <br />
</p><p>The following diagram illustrate the definition of multiple row source in pivot table.
</p><p><a  class="image"><img alt="Pv rowresourcemm.png" src="../images/Pivot_Table/Pv_rowresourcemm.png?v=48825" width="1053"  /></a>
</p><p>This part includes a display box and a toolbar with five buttons <a  class="image"><img alt="Group List Toolbar.png" src="../images/Pivot_Table/Group_List_Toolbar.png?v=47304" width="160"  /></a>:
</p>
<table class="simple">

<tr>
<th width="200">Display Box
</th>
<td>The selected column(s) will display in this box. To do this analysis, you must select at least 1 column for the row source.
</td></tr>
<tr>
<th>Triangle Button for <b>Select</b> <a  class="image"><img alt="Button Group List Add.png" src="../images/Pivot_Table/Button_Group_List_Add.png?v=38531" width="17"  /></a>
</th>
<td>Click this button then choose a column from menu, or click <b>Select Columns</b> to open the <a href="../../UserGuide/UserGuide/Specifying_Your_Input_Data.html#Column_Browser" title="UserGuide:Specifying Your Input Data">Column Browser</a> and add column(s) to the <b>Display Box</b> as row source of pivot table. Click this button again to add another column as additional row source.
</td></tr>
<tr>
<th><b>Remove</b> button <a  class="image"><img alt="Button Group List Remove.png" src="../images/Pivot_Table/Button_Group_List_Remove.png?v=38532" width="14"  /></a>
</th>
<td>Remove the selected data range(s) from the <b>Display Box</b>. This button is available when you select one or more selected column(s) in the box.
</td></tr>
<tr>
<th><b>Move Up</b> button <a  class="image"><img alt="Button Group List Move Up.png" src="../images/Pivot_Table/Button_Group_List_Move_Up.png?v=38533" width="16"  /></a>
</th>
<td>Move the selected data range(s) up in the <b>Display Box</b>. Use this button to order the row source columns and the pivot table results will follow this order.
</td></tr>
<tr>
<th><b>Move Down</b> button <a  class="image"><img alt="Button Group List Move Down.png" src="../images/Pivot_Table/Button_Group_List_Move_Down.png?v=38534" width="13"  /></a>
</th>
<td>Move the selected data range(s) down in the <b>Display Box</b>. Use this button to order the row source columns and the pivot table results will follow this order.
</td></tr>
<tr>
<th><b>Select All</b> button <a  class="image"><img alt="Button Group List Select All.png" src="../images/Pivot_Table/Button_Group_List_Select_All.png?v=45398" width="18"  /></a>
</th>
<td>Select all data range(s) down in the <b>Display Box</b>.
</td></tr></table>
<h3><a name="Pivot_Table_Column_Source"></a><span class="mw-headline">Pivot Table Column Source</span></h3>
<p>Specify the column range that will be used as the column source of the pivot table. Data in the source worksheet with the same name in column source range will be displayed as a single row in the pivot table. The following diagram illustrate the definition of column source. It should be noted that the column information can be designated into other column label rows. You can choose one or more data range as pivot table column source. The column source arrangement in the pivot table would be similar to those of row source.
</p><p><a  class="image"><img alt="Pv column resource.png" src="../images/Pivot_Table/Pv_column_resource.png?v=49138" width="1002"  /></a>
</p>
<table class="note">

<tr>
<td><b>Note:</b>
<ol><li> This part includes a display box and a toolbar with five buttons <a  class="image"><img alt="Group List Toolbar.png" src="../images/Pivot_Table/Group_List_Toolbar.png?v=47304" width="160"  /></a>.To know more about the controls, please refer to the table under the <a href="../../UserGuide/UserGuide/Pivot_Table.html#Pivot_Table_Row_Source" title="UserGuide:Pivot Table"><b>Pivot Table Row Source section</b></a>.</li>
<li> The value of <b>Column Source</b> has been put into the <i>Comments</i> column label row by default; in fact, it can be also put into other column label rows, such as <i>Long Name</i> by configuring the <b>Put Column Info. to</b> drop-down list of <a href="../../UserGuide/UserGuide/Pivot_Table.html#Options" title="UserGuide:Pivot Table"><b>Options</b></a>.</li></ol>
</td></tr></table>
<h3><a name="Pivot_Table_Data_Source"></a><span class="mw-headline">Pivot Table Data Source</span></h3>
<p>This is available only when <b>Count</b> is not selected for <b>Summarize by</b> (the <b>Method</b> variable). These are the data values to be summarized from one dimension column into two dimension matrix-like pivot table. 
</p><p><br />
</p>
<ul><li><b>Summarize Data by Max, Min, Mean, or Sum</b> </li></ul>
<dl><dd>The way data arranged in pivot table is similar when summarizing data by <b>Max</b> <b>Min</b>, <b>Mean</b> or <b>Sum</b>. The following screenshot is an example to summarize data by <b>Sum</b><br /> </dd>
<dd><a  class="image"><img alt="Pv data.png" src="../images/Pivot_Table/Pv_data.png?v=48673" width="435"  /></a></dd></dl>
<dl><dd>In the following example, the total cost data of cell (2001, <i>Bikes</i>) is the sum of those cells in Column <i>TotalCost</i>  with  criteria as follow: <i>ProductCategory</i> as <i>Bikes</i>, and <i>YEAR</i>  as <i>2001</i>. </dd></dl>
<dl><dd><a  class="image"><img alt="Pv data1.png" src="../images/Pivot_Table/Pv_data1.png?v=48744" width="916"  /></a></dd></dl>
<ul><li><b>Summarize Data by Count</b></li></ul>
<dl><dd>On the contrary, if <b>Count</b> is selected in the <b>Summarized by</b> drop-down list, the table would only fill in the count number that simultaneously meeting its cell position that related row resource and column resource.</dd></dl>
<h3><a name="Combine_Smaller_Values"></a><span class="mw-headline">Combine Smaller Values</span></h3>
<p><b>Combine Smaller Values</b> allows smaller values to be combined into an "Other" category so as to have fewer final categories to be displayed. More details can refer to the example below. 
</p><p><br />
</p>
<ul><li><b>Combine Direction</b>: If not "None", then choose either <b>Row</b> categories or <b>Column</b> categories to enable the feature. But combination smaller values at both row and categories is not supported currently.</li></ul>
<p><br />
</p>
<ul><li><b>Mode</b>: This drop-down list specifies the specific method for combining smaller values of the summarized values, which can be <b>Count</b>, <b>Sum</b>, <b>Mean</b>, <b>Min</b> or <b>Max</b>.</li></ul>
<table class="note">

<tr>
<td><b>Note:</b> Once <b>Mode</b> is selected, you can also specify other supplementary options, such as <b>Percent</b>, <b>Reference Row/Column Value</b>, <b>Top N</b>, and <b>Column/Row Label</b>, beneath the <b>Mode</b> drop-down list, which would change according to the selected mode.
</td></tr></table>
<dl><dd><ul><li><b>By Percent of Grand Total</b>: Row/Column categories with the percentage of the summarized value (<b>Count</b>/<b>Sum</b>/<b>Mean</b>/<b>Min</b>/<b>Max</b>) accounts for that of grand total exceeding a threshold percent, will be listed; while the rest will be reduced and combined into the <b>Others</b> category by default.You can specify the threshold percent in <b>Percent</b> beneath <b>Mode</b> drop-down list. </li></ul></dd></dl>
<dl><dd><dl><dd><a  class="image"><img alt="Combine-PVT1.png" src="../images/Pivot_Table/Combine-PVT1.png?v=48875" width="434"  /></a></dd></dl></dd></dl>
<dl><dd><dl><dd>To change the default name of the reduced category, specify the new name in <b>Row(or Column) Label</b> in the beneath <b>Mode</b> drop-down list.  In the following screenshot, the default name of the reduced category has been renamed as <b>Other Smaller Item</b> and other categories with smaller percentages has been reduced into this category.</dd></dl></dd></dl>
<dl><dd><dl><dd><a  class="image"><img alt="Combine-PVT2.png" src="../images/Pivot_Table/Combine-PVT2.png?v=48874" width="446"  /></a>  </dd></dl></dd></dl>
<dl><dd><ul><li><b>By Percent of Reference Row/Column</b>: Row/Column categories with the percentage of the summarized value in reference column/row category accounts for that of grand total exceeding a threshold percent, will be listed; while the rest will be reduced and combined into the <b>Other</b>(default) category. Choose one of the available value displayed to specify the reference column/row category in <b>Reference Column/Row Value</b>. For the customization of threshold percent and reduced column name, please refer to <b>By Percent of Grand Total</b> below. </li></ul></dd></dl>
<dl><dd><ul><li><b>Top N of Grand Total</b>:The summarized value of each row/column category will be ranked and the top N row/column categories will be listed. Specify the <b>Top N</b> and the <b>Row(or Column) Label</b> beneath <b>Mode</b> drop-down list.</li></ul></dd></dl>
<dl><dd><ul><li><b>Top N of Reference Row/Column</b>&#160;:The summarized value of each row/column category in column/row reference category will be ranked and the top N row/column categories will be listed. Specify the <b>Top N</b> and the <b>Row(or Column) Label</b> beneath <b>Mode</b> drop-down list.</li></ul></dd></dl>
<dl><dd><ul><li><b>Reference Row/Column Value</b>: Specify the reference row/column when either <b>By Percent of Reference Row/Column</b> or <b>Top N of Reference Row/Column</b> is selected for <b>Mode</b>.</li></ul></dd></dl>
<dl><dd><ul><li><b>Percent</b>: Specify the percent for qualifying the smaller values when either <b>By Percent of Grand Total</b> or <b>By Percent of Reference Row/Column</b> is selected for <b>Mode</b>.</li></ul></dd></dl>
<dl><dd><ul><li><b>Column/Row Label</b>: Customize the reduced category name when combining smaller values.</li></ul></dd></dl>
<h3><a name="Options"></a><span class="mw-headline">Options</span></h3>
<ul><li><b>Total for Rows</b>:This option would add a column for row total.</li></ul>
<p><br />
</p>
<dl><dd><a  class="image"><img alt="Row label ac222e.png" src="../images/Pivot_Table/Row_label_ac222e.png?v=48822" width="459"  /></a></dd></dl>
<ul><li><b>Sort Output Rows</b>:This option define the sort order of output rows.</li></ul>
<dl><dd><ul><li><b>Row Label Ascending</b>：This option will sort the rows according to the Row Labels in ascending order. <br />See the following example. When only using <i>Year</i> as the only row source,  the year has been sorted in ascending way. See the following example. When more than one range is select as row sources, the pivot table would arrange the data according to the sequence of row sources. </li></ul></dd></dl>
<dl><dd><a  class="image"><img alt="Row label ac.png" src="../images/Pivot_Table/Row_label_ac.png?v=48827" width="1011"  /></a></dd></dl>
<dl><dd><ul><li><b>Row Label Ascending</b>: This option will sort the rows according to the Row Labels in descending order, which similar to the case of <b>Row Label Ascending</b> but with reverse sequence of the sorting data. </li></ul></dd></dl>
<dl><dd><ul><li><b>Ascending by Row Totals</b>: This option would sort Row Totals in ascending order. Under this circumstance, only number data is permitted to be designated in the <b>Pivot Table Data Source</b>. Note that this option can be selected whether the box of <b>Totals for Rows</b> is selected or not.</li></ul></dd></dl>
<dl><dd><ul><li><b>Dscending by Row Totals</b>: This option would sort Row Totals in dscending order. Similar to <b>Ascending by Row Totals</b>, only number data is permitted to be designated in the <b>Pivot Table Data Source</b> under this circumstance.</li></ul></dd></dl>
<dl><dd><ul><li><b>None</b>: Do not sort the rows.</li></ul></dd></dl>
<ul><li><b>Total for Columns</b>: Similar to <b>Total for Rows</b>, add a row for column total.</li></ul>
<ul><li><b>Sort Output Columns</b>:Similar to <b>Sort Output Rows</b>,  sort according to Column Label or Column Total in ascending/descending way, if not <b>None</b>.</li></ul>
<ul><li><b>Normalize by Column Totals</b></li></ul>
<dl><dd><ul><li><b>None</b>: Do not normalize the data.</li></ul></dd></dl>
<dl><dd><ul><li><b>Fraction</b>: Normalize the data in each column by the column total and report in fractional notation.</li></ul></dd></dl>
<dl><dd><ul><li><b>Percent</b>: Normalize the data in each column by the column total and report in percentage notation.</li></ul></dd></dl>
<ul><li><b>Show Zero when Empty</b>: Display 0 instead of missing values for empty cells. It is only available when Summarize by is not by Count.</li></ul>
<ul><li><b>Row Source Extra Values</b>: This option is used less often, please refer to <b>Column Source Extra Values</b> below. </li></ul>
<ul><li><b>Column Source Extra Values</b>: This option provide additional categories that might be missing in the source data column. This is useful when you want to ensure all needed categories will be present in the result table. Categories missing in the input data may show as <i>0</i> (when summarized by <b>count</b> and <b>sum</b>) or missing values "--" (when summarized by <b>min</b> or <b>max</b>).  </li></ul>
<p>Suppose you have the following dataset(See source worksheet in the screenshot below). It is sales summary of several products(<i>Bike</i>, <i>Accessories</i>,and <i>Clothing</i>) in different countries from year 2001 to year 2004. You want to create a summary presenting the total cost of different products on each year. You can specify <i>YEAR</i> as column category and <i>Categories</i> as row category.  However, the sales record of <i>Accessories</i> and <i>Clothing</i> in 2001 and 2002 are missing. The following two situations display the different result of whether or not using <b>Column Source Extra Values</b>.
</p>
<dl><dd><ul><li><b>Without Column Extra Values</b> </li></ul>
<dl><dd>If using the worksheet query to display the data with Condition as: <i>YEAR &lt;= 2002</i>, then create a pivot table of sum of total cost without specifying <b>Column Extra Value</b> based on the new extracted query data.  The pivot table would exclude the category <i>Accessories</i> and <i>Clothing</i>, only displaying the category <i>Bikes</i>, which has extant data record of <i>YEAR</i> 2001 and 2002 in the source worksheet. </dd></dl></dd></dl>
<dl><dd><dl><dd><a  class="image"><img alt="Pv filter 0.png" src="../images/Pivot_Table/Pv_filter_0.png?v=48719" width="433"  /></a></dd></dl></dd></dl>
<dl><dd><dl><dd><a  class="image"><img alt="Pv filter 1.png" src="../images/Pivot_Table/Pv_filter_1.png?v=48794" width="869"  /></a></dd></dl></dd></dl>
<dl><dd><ul><li><b>Using Column Extra Value</b></li></ul></dd></dl>
<dl><dd><dl><dd>On the contrary, if creating a similar pivot table but specifying the <b>Column Extra Value</b>, the pivot table would display all three categories, despite of missing records. These two missing categories would be shown with zero sum. </dd></dl></dd></dl>
<dl><dd><dl><dd><a  class="image"><img alt="Pv filter 2.png" src="../images/Pivot_Table/Pv_filter_2.png?v=48720" width="433"  /></a></dd></dl></dd></dl>
<dl><dd><dl><dd><a  class="image"><img alt="Pv filter 3.png" src="../images/Pivot_Table/Pv_filter_3.png?v=48796" width="1021"  /></a></dd></dl></dd></dl>
<dl><dd><dl><dd><table class="note">

<tr>
<td><b>Note:</b>
<p><b>Column Extra Value</b> feature is extremely important when you are using the pivot table to plot a graph. In this situation, you might want all categories presented even if the records of some categories in source worksheet is not complete. Setting <b>Column Extra Value</b> would automatically treat the  missing data as zero but still regard the related categories as data groups in the graph.
</p>
</td></tr></table></dd></dl></dd></dl>
<dl><dd><dl><dd><a  class="image"><img alt="Pv filter 4.png" src="../images/Pivot_Table/Pv_filter_4.png?v=48797" width="810"  /></a></dd></dl></dd></dl>
<ul><li><b>Put Column Info. to</b>: The names of column categories will be put into the pivot table Comment column label row by default, But categories name can be put into the any column label rows you specified in this drop-down list. </li></ul>
<dl><dd><ul><li><b>Long Name</b>: Output column categories name into Long Name column label row.</li></ul></dd></dl>
<dl><dd><ul><li><b>Comments</b>: Output column categories name into Comment column label row.</li></ul></dd></dl>
<dl><dd><ul><li><b>Append to Column's Long Name</b>: Append the Long Name of column category in source worksheet to the Long Name column label row in pivot table.</li></ul></dd></dl>
<dl><dd><ul><li><b>User Defined Parameters</b>: Output other information (Short Name or Long Name of column categories in source worksheet) of the column categories into User Defined Parameters column label row in pivot table.  </li></ul></dd></dl>
<ul><li><b>From Column</b>:  Specify the source value of User Defined Parameters,only available when User Defined Parameters selected from Put Column Info. to.</li></ul>
<dl><dd><ul><li><b>Short Name</b>: Choose Short Name of column categories in source worksheet as input information  for User Defined Parameters. </li></ul></dd></dl>
<dl><dd><ul><li><b>Long Name</b>: Choose Long Name of column categories in source worksheet as input information  for User Defined Parameters.</li></ul></dd></dl>
<h3><a name="Output_Result_Table_to"></a><span class="mw-headline">Output Result Table to</span></h3>
<p>Specify where to output the result pivot table. Click the triangle button to specify output method.<br /> 
</p><p><b>[&lt;input&gt;]&lt;input&gt;</b>: Input the pivot table into the current worksheet.
</p><p><b>&lt;new&gt;</b>: Put pivot table into a new sheet of the current workbook.
</p><p><b>[&lt;new&gt;]&lt;new&gt;</b>: Put pivot table into a new workbook.
</p>





