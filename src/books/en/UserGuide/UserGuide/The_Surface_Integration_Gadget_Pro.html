<h1 class="firstHeading">11.12 2D Integration Gadget (Pro Only)</h1><p class='urlname' style='display: none'>surface-integ-gadget</p>
<div class="toclimit-2"><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Overview"><span class="tocnumber">1</span> <span class="toctext">Overview</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#ROI_Box_.28roi.29"><span class="tocnumber">2</span> <span class="toctext">ROI Box (roi)</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Shape"><span class="tocnumber">2.1</span> <span class="toctext">Shape</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Shape_Position_.28shapeProp.29"><span class="tocnumber">2.2</span> <span class="toctext">Shape Position (shapeProp)</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Show_Tool_Name_.28toolname.29"><span class="tocnumber">2.3</span> <span class="toctext">Show Tool Name (toolname)</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Show_on_Center-Top_of_ROI_Box_.28showtop.29"><span class="tocnumber">2.4</span> <span class="toctext">Show on Center-Top of ROI Box (showtop)</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Fill_Color_.28rectcolor.29"><span class="tocnumber">2.5</span> <span class="toctext">Fill Color (rectcolor)</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8"><a href="#Baseline_.28baseline.29"><span class="tocnumber">3</span> <span class="toctext">Baseline (baseline)</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Integration_.28integration.29"><span class="tocnumber">4</span> <span class="toctext">Integration (integration)</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#Output_.28Output.29"><span class="tocnumber">5</span> <span class="toctext">Output (Output)</span></a>
<ul>
<li class="toclevel-2 tocsection-11"><a href="#Output_Quantities_to_.28outputQuantitiesTo.29"><span class="tocnumber">5.1</span> <span class="toctext">Output Quantities to (outputQuantitiesTo)</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Quantities_Branch_.28quantities.29"><span class="tocnumber">5.2</span> <span class="toctext">Quantities Branch (quantities)</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#Baseline_.28baselineOutput.29"><span class="tocnumber">5.3</span> <span class="toctext">Baseline (baselineOutput)</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-14"><a href="#The_Fly-out_Menu"><span class="tocnumber">6</span> <span class="toctext">The Fly-out Menu</span></a></li>
</ul>
</div>
</div>
<h2><a name="Overview"></a><span class="mw-headline">Overview</span></h2>
<p>The 2D Integration Gadget tool (uses the <a class="external text" href="../../XFunction/X-Function/Addtool_surface_integ.html">addtool_integ2</a> X-Function) allows you to calculate the 2D integration for a contour or image graph created from uniformly spaced matrix or non-uniformly spaced <a class="external text" href="../../GettingStarted/OriginLab/Matrix_Book_Matrix_Sheet_Matrix_Objects.html#Virtual_Matrix">virtual matrix</a> or XYZ worksheet data.
</p><p>To use this gadget tool, create a contour plot from your data, activate the graph and select <b>Gadgets:2D Integrate</b> from top menu.
</p>
<dl><dd><a  class="image"><img alt="2d integrate.png" src="../images/The_Surface_Integration_Gadget_Pro/350px-2d_integrate.png?v=70510" width="350"   /></a></dd></dl>
<table class="note">

<tr>
<td><b>Notes:</b>  The options for the X-Function of gadget is organized as tree variable, the tree node names to be called for each options/branches are listed in the bracket next to the option name(tree node labels).
</td></tr></table>
<h2><a name="ROI_Box_.28roi.29"></a><span class="mw-headline">ROI Box (roi)</span></h2>
<p>The ROI (region of interest) box defines the area for surface integration calculation. 
</p>
<h3><a name="Shape"></a><span class="mw-headline">Shape</span></h3>
<p>Define the shape of ROI box. 
</p>
<table class="dialogcontroltable">

<tr>
<th> Rectangle
</th>
<td> Specify the shape and postion of the rectangle ROI in <b>Shape Postion</b> below.
</td></tr>
<tr>
<th> Circle
</th>
<td> Specify the shape and postion of the circle ROI in <b>Shape Position</b> below.
</td></tr>
<tr>
<th> Arbitray Shape
</th>
<td> After clicking <b>OK</b> button, a <b>Create ROI</b> mini dialog box will open, allowing you to choose the drawing tool to draw arbitrary shape on the graph to add ROI box.
<p><a  class="image"><img alt="Create ROI Dialog.png" src="../images/The_Surface_Integration_Gadget_Pro/Create_ROI_Dialog.png?v=92911" width="245"  /></a>
</p>
<ul><li><b>Rectangle</b><a  class="image"><img alt="Button Rectangle Tool.png" src="../images/The_Surface_Integration_Gadget_Pro/Button_Rectangle_Tool.png?v=1874" width="22"  /></a> &amp;&amp; <b>Circle</b><a  class="image"><img alt="Button Circle Tool.png" src="../images/The_Surface_Integration_Gadget_Pro/Button_Circle_Tool.png?v=1722" width="22"  /></a> button: draw a square/rectangle/circle/oval object to add ROI. Refer to <a href="../../UserGuide/Category/Creating_Drawing_Objects.html#Drawing_two-dimensional_objects" title="Category:Creating Drawing Objects">this page</a> for detailed use of these tools.</li>
<li><b>Polygon</b><a  class="image"><img alt="Button Polygon Tool.png" src="../images/The_Surface_Integration_Gadget_Pro/Button_Polygon_Tool.png?v=1865" width="22"  /></a> &amp;&amp; <b>Region</b><a  class="image"><img alt="Button Region Tool.png" src="../images/The_Surface_Integration_Gadget_Pro/Button_Region_Tool.png?v=1877" width="22"  /></a> button: draw a freestyle object to add ROI. Refer to <a href="../../UserGuide/Category/Creating_Drawing_Objects.html#Drawing_two-dimensional_objects" title="Category:Creating Drawing Objects">this page</a> for detailed use of these tools.</li>
<li><b>Curve</b> button <a  class="image"><img alt="Button Curve Tool.png" src="../images/The_Surface_Integration_Gadget_Pro/Button_Curve_Tool.png?v=85228" width="22"  /></a>: draw a closed curve to add ROI. Refer to <a href="../../UserGuide/Category/Creating_Drawing_Objects.html#Drawing_smooth_curve" title="Category:Creating Drawing Objects">this page</a> for detailed use of this tool.</li></ul>
</td></tr></table>
<p><br />
<b>Note:</b>After adding a ROI to the graph, you can always click the triangle button at the top-right corner of the ROI box and select <b>Modify ROI</b> menu to open the <b>Create ROI</b> dialog to change the ROI shape again.
</p>
<h3><a name="Shape_Position_.28shapeProp.29"></a><span class="mw-headline">Shape Position (shapeProp)</span></h3>
<p>You can define the position of ROI box by giving values for XY coordinates.
</p>
<table class="dialogcontroltable">

<tr>
<th> X1 (xFrom)
</th>
<td> Enter a value for the X coordinate for the leftmost line in the ROI box.
</td></tr>
<tr>
<th> X2 (xTo)
</th>
<td> Enter a value for the X coordinate for the rightmost line in the ROI box.
</td></tr>
<tr>
<th> Y1 (yFrom)
</th>
<td> Enter a value for the Y coordinate for the bottom line in the ROI box.
</td></tr>
<tr>
<th> Y2 (yTo)
</th>
<td> Enter a value for the Y coordinate for the top line in the ROI box.
</td></tr>
<tr>
<th> Fixed(Prevent moving by ROI) (fix_roi_loc)
</th>
<td> Specify whether to prevent manually moving the ROI box.
</td></tr></table>
<p><br />
</p>
<h3><a name="Show_Tool_Name_.28toolname.29"></a><span class="mw-headline">Show Tool Name (toolname)</span></h3>
<p>Specify whether to show a tool name at the top left corner of the ROI box. The tool name can be further specified in the text box if this check box is selected.
</p><p><br />
</p>
<h3><a name="Show_on_Center-Top_of_ROI_Box_.28showtop.29"></a><span class="mw-headline">Show on Center-Top of ROI Box (showtop)</span></h3>
<p>Specify whether to show the results of corresponding quantity on center top of the ROI box.
</p>
<table class="dialogcontroltable">

<tr>
<th> Volume (topVolume)
</th>
<td> The volume integrated from base to the source surface.
</td></tr>
<tr>
<th> FWHM (topFwhm)
</th>
<td> The full width at half the height of the source surface.
</td></tr>
<tr>
<th> N (topN)
</th>
<td> The number of data points.
</td></tr>
<tr>
<th> Minimum (topMinimum)
</th>
<td> The minimum Z value.
</td></tr>
<tr>
<th> Maximum (topMaximum)
</th>
<td> The maximum Z value.
</td></tr>
<tr>
<th> Mean (topMean)
</th>
<td> The mean of Z values.
</td></tr>
<tr>
<th> Median (topMedian)
</th>
<td> The median of Z values.
</td></tr>
<tr>
<th> SD (topSD)
</th>
<td> The standard deviation of all Z values.
</td></tr>
<tr>
<th> Sum (topSum)
</th>
<td> The sum of Z values.
</td></tr></table>
<h3><a name="Fill_Color_.28rectcolor.29"></a><span class="mw-headline">Fill Color (rectcolor)</span></h3>
<p>Specify the fill color for the ROI box.
</p>
<h2><a name="Baseline_.28baseline.29"></a><span class="mw-headline">Baseline (baseline)</span></h2>
<table class="dialogcontroltable">

<tr>
<th>Mode (method)
</th>
<td>Select a mode for the base.
<ul><li><b>None</b>
<dl><dd>There will be no baseline, the integration will be from the zero plane.</dd></dl></li>
<li><b>Constant</b>
<dl><dd>Use a flat plane parallel to the XY plane at the pre-defined Z value.</dd></dl></li>
<li><b>Plane</b>
<dl><dd>Create a fitted plane as baseline using boundary points.  </dd></dl></li></ul>
</td></tr>
<tr>
<th>Constant (constantMode)
</th>
<td>This is only available when the <b>Mode</b> is set to <b>Constant</b>. It is used to specify the Z value for the baseline plane.
<ul><li><b>Custom</b>
<dl><dd>Use a custom Z value, this is defined in the <b>Z=</b> text box.</dd></dl></li>
<li><b>Minimum</b>
<dl><dd>Use the minimum Z value.</dd></dl></li>
<li><b>Maximum</b>
<dl><dd>Use the maximum Z value.</dd></dl></li></ul>
</td></tr>
<tr>
<th>Z= (zvalue)
</th>
<td>This is only available when <b>Constant</b> is set to <b>Custom</b>. It is used to specify a custom Z value for baseline plane.
</td></tr>
<tr>
<th>Boundary Tolerance (%) (boundtor)
</th>
<td>This is only available when <b>Mode</b> is set to <b>Plane</b>. The boundary is determined by the option selected for <b>Range</b>. The tolerance in percentage decides a tolerance width or height. The points whose distance from the boundary is less than the tolerance width or height. Tolerance width/height = Tolerance (%) * Width/Height.
</td></tr>
<tr>
<th>Range (range)
</th>
<td>This is not available when the <b>Mode</b> is set to <b>None</b> or <b>Custom</b> is selected for the <b>Constant</b> drop-down menu. It is used to specify the data range considered when determining base plane.
<ul><li><b>Full Plot Range</b>
<dl><dd>The full plot range boundary is used to fit base plane, or the min/max value is found within the full plot range.</dd></dl></li>
<li><b>Plot Within ROI</b>
<dl><dd>Only the boundary of the plot within the ROI box is used to fit base plane, or the min/max value is found within the data range defined by ROI box.</dd></dl></li></ul>
</td></tr></table>
<h2><a name="Integration_.28integration.29"></a><span class="mw-headline">Integration (integration)</span></h2>
<p>You can specify options for integration in this tab.
</p><p>If <b>Interpolate for Missing Values</b> (<b>interpmissing</b>) is checked, the interpolation will also taken consideration the missing values.
</p><p>If <b>Show Baseline-Subtracted Surface</b> (<b>showsurface</b>) is checked, the subtracted surface (subtracted from source data and baseline plane) will be shown.
</p>
<h2><a name="Output_.28Output.29"></a><span class="mw-headline">Output (Output)</span></h2>
<h3><a name="Output_Quantities_to_.28outputQuantitiesTo.29"></a><span class="mw-headline">Output Quantities to (outputQuantitiesTo)</span></h3>
<p>Customize the output results. 
</p>
<table class="dialogcontroltable">

<tr>
<th><b>Script Window</b> (<b>script</b>)
</th>
<td> Specify whether to output the results to the Script window.
</td></tr>
<tr>
<th><b>Results Log</b> (<b>reslog</b>)
</th>
<td>Specify whether to output the result to the Results Log.
</td></tr>
<tr>
<th><b>Append to Worksheet</b> (<b>appendwks</b>)
</th>
<td>Specify whether to append the results to a worksheet.
</td></tr>
<tr>
<th><b>Result Worksheet Name</b> (<b>wbkName</b>)
</th>
<td>This is only available when <b>Append to Worksheet</b> (<b>appendwks</b>) is selected.
<p>If you choose to send output to a Worksheet, you have these options:
</p>
<ul><li> When you generate new output, results are output to <b>[%H-Integ2d]Result</b>  by default (here <b>%H</b> means the Short Name of source graph), but other books and sheets can be specified. If the book and sheet do not exist, they will be created on output.</li>
<li> Alternately, you can click the flyout button <a  class="image"><img alt="Gadget flyout button.png" src="../images/The_Surface_Integration_Gadget_Pro/Gadget_flyout_button.png?v=84659" width="18"  /></a> to the right of <b>Result Worksheet Name</b> and choose <b>Sheet in Input Book</b>. This fills the edit box with <b>[&lt;input&gt;]Result</b>. When you generate new output, results are output to a sheet named <b>Result</b> in the source book.</li></ul>
</td></tr></table>
<h3><a name="Quantities_Branch_.28quantities.29"></a><span class="mw-headline">Quantities Branch (quantities)</span></h3>
<p>Specify the quantities to be outputted. 
</p>
<table class="dialogcontroltable">

<tr>
<th> <b>Dataset Identifier (name)</b>
</th>
<td>Specify a dataset identifier in the drop-down list.
</td></tr>
<tr>
<th> <b>Index Range (index_rng)</b>
</th>
<td>Specify whether to output the indices for the dimension limited by the ROI box. This is only available when the input data is not XYZ range.
</td></tr>
<tr>
<th> <b>X Range (x_rng)</b>
</th>
<td>Specify whether to output the indices for X range.
</td></tr>
<tr>
<th> <b>Y Range (y_rng)</b>
</th>
<td>Specify whether to output the indices for Y range.
</td></tr>
<tr>
<th><b>Max Height (max_height)</b>
</th>
<td> Specify whether to output the maximum height from source surface to baseline.
</td></tr>
<tr>
<th><b>Volume (volume)</b>
</th>
<td> Specify whether to output The volume integrated from base to the source surface.
</td></tr>
<tr>
<th> <b>Area of Surface (area)</b>
</th>
<td> Specify whether to output the area of the source surface.
</td></tr>
<tr>
<th> <b>Centroid (centroid)</b>
</th>
<td> Specify whether to output the coordinate of centroid for the selected region.
</td></tr>
<tr>
<th><b>FWHM (fwhm)</b>
</th>
<td> Specify whether to output the full width at half the height of the source surface.
</td></tr>
<tr>
<th><b>Half Width (half_width)</b>
</th>
<td> Specify whether to output the half width.
</td></tr>
<tr>
<th> <b>Z Max (zmax)</b>
</th>
<td> Specify whether to output the maximum value of Z.
</td></tr>
<tr>
<th> <b>Index at ZMax (index_zmax)</b>
</th>
<td> Specify whether to output the column/row index for the data point at maximum Z value.
</td></tr>
<tr>
<th> <b>(x,y) at ZMax (xy_zmax)</b>
</th>
<td> Specify whether to output the X and Y values for the data point at maximum Z value.
</td></tr>
<tr>
<th> <b>Statistics (QStatistics)</b>
</th>
<td> Specify whether to output the statistic results based on Z values, available quantities are:
<ul><li><b>N (qsN)</b>:Number of data points.</li>
<li><b>Minimum (qsMinimum)</b>:Minimum of Z values.</li>
<li><b>Maximum (qsMaximum)</b>:Maximum of Z values.</li>
<li><b>Mean (qsMean)</b>:Mean of Z values</li>
<li><b>Median (qsMedian)</b>:Median of Z values.</li>
<li><b>SD (qsSD)</b>:Standard deviation of Z values.</li>
<li><b>Sum (qsSum)</b>:Sum of Z values.</li></ul>
</td></tr></table>
<h3><a name="Baseline_.28baselineOutput.29"></a><span class="mw-headline">Baseline (baselineOutput)</span></h3>
<table class="dialogcontroltable">

<tr>
<th> <b>Baseline</b> (<b>baseline</b>)
</th>
<td> Specify whether to output the baseline information.
</td></tr>
<tr>
<th><b>Output To</b> (<b>OutputTo</b>)
</th>
<td>Specify where to output the result .
</td></tr></table>
<p><br />
</p>
<table class="note">

<tr>
<td><b>Notes:</b>  The name in the brackets is the tree node name, and the name outside is the tree node label. When an X-function executes by script, you have to assign values to tree nodes using their names. Special characters and spaces are not allowed in tree node names. However, you can use special characters and white space in the tree node label.
</td></tr></table>
<h2><a name="The_Fly-out_Menu"></a><span class="mw-headline">The Fly-out Menu</span></h2>
<p>Click the triangle button <a  class="image"><img alt="ROI menu.png" src="../images/The_Surface_Integration_Gadget_Pro/ROI_menu.png?v=21045" width="21"  /></a> near the top right corner of the ROI to open a fly-out menu that offers the following options:
</p>
<table class="dialogcontroltable">

<tr>
<th><b>New Output</b>
</th>
<td>Output the result.
</td></tr>
<tr>
<th><b>Go to Report Worksheet</b>
</th>
<td> Go to the result worksheet once the result has been output to worksheet.
</td></tr>
<tr>
<th>Output to Clipboard
</th>
<td>When selected (menu item checked) <b>New Output</b> will be placed on the Clipboard.
</td></tr>
<tr>
<th><b>Change Data</b>
</th>
<td> Change the input data.
<ul><li> By default, <b>Auto</b> mode is enabled.  When <b>Auto</b> is enabled, plot selection is controlled by clicking on a plot in the graph window or Object Manager.  Prior to Origin 2019, Origin did not support Auto; to change target plot/data in older versions, you must select a plot from the fly-out menu. </li>
<li> Place a check mark in front of any plot to select that plot.</li>
<li> Click <b>Select...</b> or <b>More ...</b> to open the <b>Select Plot(s)</b> dialog and change selection.</li></ul>
</td></tr>
<tr>
<th><b>Expand to Full Plot(s) Range</b>
</th>
<td> Expand the ROI box to the full Plots range.
</td></tr>
<tr>
<th><b>Expand to Full Layer Width</b>
</th>
<td> Expand the ROI box to the full layer width.
</td></tr>
<tr>
<th><b>Expand to Full Layer Height</b>
</th>
<td> Expand the ROI box to the full layer height.
</td></tr>
<tr>
<th><b>Save Theme</b>
</th>
<td> Save the settings in this dialog as a dialog theme.
</td></tr>
<tr>
<th><b>Save as &lt;default&gt;</b>
</th>
<td> Save the setting in this dialog as &lt;default&gt; theme.
</td></tr>
<tr>
<th><b>Load Theme</b>
</th>
<td> Load the dialog theme pre-saved.
</td></tr>
<tr>
<th><b>Preferences</b>
</th>
<td> Open the Preferences dialog.
</td></tr></table>






