<h1 class="firstHeading">16.5 2D Interpolate/Extrapolate</h1><p class='urlname' style='display: none'>Math-2D-Inter-Extrapolate</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Overview"><span class="tocnumber">1</span> <span class="toctext">Overview</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Interpolate_From_XY"><span class="tocnumber">1.1</span> <span class="toctext">Interpolate From XY</span></a>
<ul>
<li class="toclevel-3 tocsection-3"><a href="#To_Interpolate_Z_from_XY"><span class="tocnumber">1.1.1</span> <span class="toctext">To Interpolate Z from XY</span></a></li>
<li class="toclevel-3 tocsection-4"><a href="#Dialog_Options_for_Interpolate_Z_from_XY"><span class="tocnumber">1.1.2</span> <span class="toctext">Dialog Options for Interpolate Z from XY</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-5"><a href="#2D_Interpolation_on_Matrix"><span class="tocnumber">1.2</span> <span class="toctext">2D Interpolation on Matrix</span></a>
<ul>
<li class="toclevel-3 tocsection-6"><a href="#To_Perform_2D_Interpolation_on_Matrix"><span class="tocnumber">1.2.1</span> <span class="toctext">To Perform 2D Interpolation on Matrix</span></a></li>
<li class="toclevel-3 tocsection-7"><a href="#Dialog_Options_for_2D_Interpolation_on_Matrix"><span class="tocnumber">1.2.2</span> <span class="toctext">Dialog Options for 2D Interpolation on Matrix</span></a></li>
<li class="toclevel-3 tocsection-8"><a href="#Algorithm_for_Interpolation_on_Matrix"><span class="tocnumber">1.2.3</span> <span class="toctext">Algorithm for Interpolation on Matrix</span></a></li>
<li class="toclevel-3 tocsection-9"><a href="#References"><span class="tocnumber">1.2.4</span> <span class="toctext">References</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>

<h2><a name="Overview"></a><span class="mw-headline">Overview</span></h2>
<p>2D Interpolation/Extrapolation allows you to interpolate/extrapolate either on a group of existing XYZ data for a given XY dataset or a specified matrix object.
</p>
<h3><a name="Interpolate_From_XY"></a><span class="mw-headline">Interpolate From XY</span></h3>
<p><a  class="image"><img alt="InterpolateZfromXY.png" src="../images/2D_Interpolate_Extrapolate/400px-InterpolateZfromXY.png?v=71151" width="400"   /></a><br /><br />
<b>Interpolate Z From XY</b> tool allows you to specify a set of XY values for interpolation/extrapolation so that it offers additional freedom in 2D interpolation/extrapolation for non-uniformly spaced XY dataset. Origin supports 8 interpolation methods for interpolating Z from XY: <b>Nearest</b>, <b>Random Kriging</b>, <b>Random Renka Cline</b>, <b>Random Shepard</b>, <b>Random TPS</b>, <b>Spline</b>, <b>Triangle</b>, <b>Weight Average</b>.
</p>
<h5><a name="To_Interpolate_Z_from_XY"></a><span class="mw-headline">To Interpolate Z from XY</span></h5>
<ol><li>Activate the workbook that contains your input data.</li>
<li>Select <b>Analysis: Mathematics: Interpolate Z from XY...</b> from the menu. This opens the <a class="external text" href="../../XFunction/X-Function/Interp2.html">interp2</a> dialog box. </li>
<li> Choose your input options and click <b>OK</b>. The X-Function <b>interp2</b> is called to complete the calculation.</li></ol>
<p><br />
</p>
<h4><a name="Dialog_Options_for_Interpolate_Z_from_XY"></a><span class="mw-headline">Dialog Options for Interpolate Z from XY</span></h4>
<p>Refer to the documentaion of X function <a class="external text" href="../../XFunction/X-Function/Interp2.html">interp2</a> for details of dialog control of Interpolate Z from XY tool.
<br /><br />
</p>
<h3><a name="2D_Interpolation_on_Matrix"></a><span class="mw-headline">2D Interpolation on Matrix</span></h3>
<p><a  class="image"><img alt="2DInterpolationOnMatrix.png" src="../images/2D_Interpolate_Extrapolate/2DInterpolationOnMatrix.png?v=71152" width="323"  /></a><br /><br />
Two-dimensional interpolation/extrapolation can also be performed on data stored in an Origin matrix. Origin supports five methods for interpolation on Matrix: <b>Nearest</b>, <b>Bilinear</b>, <b>Bicubic</b>, <b>Spline</b>, <b>Biquadratic</b>. You can also specify the interpolation output ranges for X and Y.
</p>
<h5><a name="To_Perform_2D_Interpolation_on_Matrix"></a><span class="mw-headline">To Perform 2D Interpolation on Matrix</span></h5>
<ol><li>Activate the matrix that contains your input data.</li>
<li>Select <b>Analysis: Mathematics: 2D Interpolation/Extrapolation</b> from the menu. This opens the minterp2 dialog box. </li>
<li> Choose your input options and click <b>OK</b>. The <a class="external text" href="../../XFunction/X-Function/Minterp2.html">minterp2</a> X-Function is called to complete the calculation.</li></ol>
<h4><a name="Dialog_Options_for_2D_Interpolation_on_Matrix"></a><span class="mw-headline">Dialog Options for 2D Interpolation on Matrix</span></h4>
<table class="dialogcontroltable">

<tr>
<th><b>Recalculate</b>
</th>
<td>
<p>Controls recalculation of analysis results
</p>
<ul><li><b>None</b> </li>
<li><b>Auto</b> </li>
<li><b>Manual</b>  </li></ul>
<p>For more information, see: <a class="external text" href="../../UserGuide/UserGuide/Recalculating_Analysis_Results.html">Recalculating Analysis Results</a>
</p>
</td></tr>
<tr>
<th>Input Matrix
</th>
<td>
<p>Specify the matrix that contains the data to be interpolated/extrapolated.
</p><p>For help with range controls, see: <a class="external text" href="../../UserGuide/UserGuide/Specifying_Your_Input_Data.html">Specifying Your Input Data</a>
</p>
</td></tr>
<tr>
<th>Method
</th>
<td>
<p>Specify the interpolation/extrapolation method. 
</p>
<ul><li><b>Nearest</b>
<dl><dd>Interpolate using the nearest points.</dd></dl></li>
<li><b>Bilinear</b>
<dl><dd>Two dimensional linear interpolation.</dd></dl></li>
<li><b>Bicubic Convolution</b>
<dl><dd>Two dimensional interpolation using bicubic convolution.</dd></dl></li>
<li><b>Spline</b>
<dl><dd>Two dimensional spline interpolation.</dd></dl></li>
<li><b>Biquadratic</b>
<dl><dd>Two dimensional quadratic interpolation.</dd></dl></li>
<li><b>Bicubic Lagrange</b>
<dl><dd>Two dimensional interpolation using Lagrange polynomials.</dd></dl></li></ul>
</td></tr>
<tr>
<th>Number of Cols
</th>
<td>
<p>The number of columns in the output matrix.
</p>
</td></tr>
<tr>
<th>Number of Rows
</th>
<td>
<p>The number of rows in the output matrix.
</p>
</td></tr>
<tr>
<th>Missing Value Pretreatment
</th>
<td>
<p>Specify the method to preprocess missing values in 2D interpolation
</p>
<dl><dd><b>Skip</b>
<dl><dd>Remove all missing values first and then run interpolation.</dd></dl></dd>
<dd><b>Interpolated with Renka Cline </b>
<dl><dd>Renka Cline: For an arbitrary point P, compute the interpolated value using the data values and gradient estimates at each of the three vertices of the triangle which contains P.</dd></dl></dd></dl>
</td></tr>
<tr>
<th>Coordinates
</th>
<td>
<p>Specify <a href="../../UserGuide/UserGuide/Matrix_Sheet_Dimensions_and_XY_Coordinates.html" title="UserGuide:Matrix Sheet Dimensions and XY Coordinates">the coordinates/XY mapping</a> of the output matrix.
</p>
<dl><dd><b>First X</b>
<dl><dd>The first x value of the output matrix.</dd></dl></dd>
<dd><b>Last X</b>
<dl><dd>The first x value of the output matrix.</dd></dl></dd>
<dd><b>First Y</b>
<dl><dd>The first y value of the output matrix.</dd></dl></dd>
<dd><b>Last Y</b>
<dl><dd>The last y value of the output matrix.</dd></dl></dd></dl>
</td></tr>
<tr>
<th>Output Matrix
</th>
<td>
<p>Specify the output matrix for the interpolated/extrapolated data.
</p>
</td></tr></table>
<h4><a name="Algorithm_for_Interpolation_on_Matrix"></a><span class="mw-headline">Algorithm for Interpolation on Matrix</span></h4>
<p><b>Nearest (neighbor) interpolation:</b>
</p><p>Calculate the interpolated value using the nearest grid points.
</p><p><b>Polynomial interpolation:</b>
</p><p>This type of interpolation includes <b>Bilinear</b>, <b>Biquadratic</b>, <b>Bicubic Convolution</b> and <b>Bicubic Lagrange</b> methods, all of which operate similarly. For instance, to calculate the value at point <img src="../images/2D_Interpolate_Extrapolate/math-c97cc0a129342152d901ad67de39c031.png?v=0" title="P(x,y)\!" alt="P(x,y)\!" class="tex"/> by the biquadratic interpolation method, we first perform 1D quadratic interpolation vertically, based on data points <img src="../images/2D_Interpolate_Extrapolate/math-1d52943387a339b16f3993f2e5d6092d.png?v=0" title="P_{(i,i)}\!" alt="P_{(i,i)}\!" class="tex"/>, <img src="../images/2D_Interpolate_Extrapolate/math-c0309cf8d1395bb0c49233821e578975.png?v=0" title="P_{(i,i+1)}\!" alt="P_{(i,i+1)}\!" class="tex"/>, <img src="../images/2D_Interpolate_Extrapolate/math-4369012a5b5764f77697b10385b9619f.png?v=0" title="P_{(i,i+2)}\!" alt="P_{(i,i+2)}\!" class="tex"/> to generate<img src="../images/2D_Interpolate_Extrapolate/math-ee7148e71fba7eb438b11e7e75cb4793.png?v=0" title="p_i^{\prime }" alt="p_i^{\prime }" class="tex"/>, which has the same <img src="../images/2D_Interpolate_Extrapolate/math-301530a7f5da08f6e75622d6438fbd91.png?v=0" title="y\!" alt="y\!" class="tex"/> value as <img src="../images/2D_Interpolate_Extrapolate/math-159f12ce9148954f5f1c7dedd3def78f.png?v=0" title="P\!" alt="P\!" class="tex"/>. Then we calculate <img src="../images/2D_Interpolate_Extrapolate/math-de082b0d33d08a600072c70086fedc47.png?v=0" title="P_{i+1}^{\prime }" alt="P_{i+1}^{\prime }" class="tex"/>, and <img src="../images/2D_Interpolate_Extrapolate/math-2c3fe365dc042b89e824fcaf52236ea1.png?v=0" title="P_{i+2}^{\prime }" alt="P_{i+2}^{\prime }" class="tex"/>. Values <img src="../images/2D_Interpolate_Extrapolate/math-8647073d2387178c56d99ab02871b8dc.png?v=0" title="P_{i}^{\prime }" alt="P_{i}^{\prime }" class="tex"/>, <img src="../images/2D_Interpolate_Extrapolate/math-76254aef32e50426815bd4683bfbb998.png?v=0" title="p_{i+1}^{\prime }" alt="p_{i+1}^{\prime }" class="tex"/> and <img src="../images/2D_Interpolate_Extrapolate/math-56cfd58f2d00b4200a28b465046def68.png?v=0" title="p_{i+2}^{\prime }" alt="p_{i+2}^{\prime }" class="tex"/> define a line through <img src="../images/2D_Interpolate_Extrapolate/math-159f12ce9148954f5f1c7dedd3def78f.png?v=0" title="P\!" alt="P\!" class="tex"/>. We then perform 1D quadratic interpolation horizontally to evaluate the value at <img src="../images/2D_Interpolate_Extrapolate/math-159f12ce9148954f5f1c7dedd3def78f.png?v=0" title="P\!" alt="P\!" class="tex"/>.
</p>
<dl><dd><a  class="image"><img alt="2D interpolation Algorithm.gif" src="../images/2D_Interpolate_Extrapolate/2D_interpolation_Algorithm.gif?v=21915" width="317"  /></a></dd></dl>
<p>The difference between Bilinear, Biquadratic, Bicubic Convolution and Bicubic Lagrange methods is in the use of different order polynomial functions. The interpolating polynomial of order <i>n</i>-1 through <i>n</i> points is:
</p><p><img src="../images/2D_Interpolate_Extrapolate/math-c12dedab516f392f6755fdfca9d61331.png?v=0" title="P(x) = \cfrac{(x-x_1)(x-x_2)\cdots (x-x_{n-1})}{(x_0-x_1)(x_0-x_2)\cdots (x_0-x_{n-1})}y_0 " alt="P(x) = \cfrac{(x-x_1)(x-x_2)\cdots (x-x_{n-1})}{(x_0-x_1)(x_0-x_2)\cdots (x_0-x_{n-1})}y_0 " class="tex"/>
<img src="../images/2D_Interpolate_Extrapolate/math-e9663202bdbad31bfd18f2f0c48e60cb.png?v=0" title="+\cfrac{(x-x_1)(x-x_2)\cdots (x-x_{n-1})}{(x_1-x_1)(x_1-x_2)\cdots (x_1-x_{n-1})}y_1+ \cdots" alt="+\cfrac{(x-x_1)(x-x_2)\cdots (x-x_{n-1})}{(x_1-x_1)(x_1-x_2)\cdots (x_1-x_{n-1})}y_1+ \cdots" class="tex"/> 
<img src="../images/2D_Interpolate_Extrapolate/math-591c278aef54cab2d0a0ff050a2eaa2b.png?v=0" title="+ \cfrac{(x-x_1)(x-x_2)\cdots (x-x_{n-1})}{(x_{n-1}-x_1)(x_{n-1}-x_2)\cdots (x_{n-1}-x_{n-1})}y_{n-1}" alt="+ \cfrac{(x-x_1)(x-x_2)\cdots (x-x_{n-1})}{(x_{n-1}-x_1)(x_{n-1}-x_2)\cdots (x_{n-1}-x_{n-1})}y_{n-1}" class="tex"/> 
<br /><br />
<b>Spline interpolation:</b>
</p><p>This method calculates values of the bicubic spline <img src="../images/2D_Interpolate_Extrapolate/math-bfe54647b6c8b76b2ae64eff5ad8a4dd.png?v=0" title="s(x,y)\!" alt="s(x,y)\!" class="tex"/> by:
</p><p><img src="../images/2D_Interpolate_Extrapolate/math-af680a713f45eca2f76d3a987d33a580.png?v=0" title="s(x,y)=\sum_{i,j} c_{ij}M_i(x)N_j(y)\,\!" alt="s(x,y)=\sum_{i,j} c_{ij}M_i(x)N_j(y)\,\!" class="tex"/>
</p><p>where <img src="../images/2D_Interpolate_Extrapolate/math-91a600ad034735ce3ad751b68829a8de.png?v=0" title="M_i(x)\!" alt="M_i(x)\!" class="tex"/> and <img src="../images/2D_Interpolate_Extrapolate/math-4f77311a720eb44d154037d4d3f0a915.png?v=0" title="N_j(y)\!" alt="N_j(y)\!" class="tex"/> denote normalized cubic B-splines and <img src="../images/2D_Interpolate_Extrapolate/math-a7048e01820bfccf6ad70659c5dc2e91.png?v=0" title="c_{ij}\!" alt="c_{ij}\!" class="tex"/> is the spline coefficient. 
</p><p>For more information about 2D spline interpolation, please read documentation for the NAG function <a class="external text" href="http://www.originlab.com/pdfs/nagcl09/manual/pdf/e02/e02dec.pdf" target="_blank">e02dec</a>.
</p>
<h4><a name="References"></a><span class="mw-headline">References</span></h4>
<ol><li> Willian H. Press, etc. <i>Numerical Recipes in C++, 2<sup>nd</sup> Edition</i>. Cambridge University Press. (2002)</li></ol>






