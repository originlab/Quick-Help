<h1 class="firstHeading">5.6.1.2 Entering Expressions in the Set Values Dialog</h1><p class='urlname' style='display: none'>SetMatVal-EnterExpression</p>
<p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Expression_Basics"><span class="tocnumber">1</span> <span class="toctext">Expression Basics</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Add_Expressions_only_in_Formula"><span class="tocnumber">2</span> <span class="toctext">Add Expressions only in <i>Formula</i></span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Add_Expressions_only_in_Before_Formula_Scripts"><span class="tocnumber">3</span> <span class="toctext">Add Expressions only in <i>Before Formula Scripts</i></span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Add_Expressions_in_both_Formula_and_Before_Formula_Scripts"><span class="tocnumber">4</span> <span class="toctext">Add Expressions in both <i>Formula</i> and <i>Before Formula Scripts</i></span></a></li>
</ul>
</div>

<h2><a name="Expression_Basics"></a><span class="mw-headline">Expression Basics</span></h2>
<p>The expression used in the <b>Set Values</b> dialog should follow LabTalk syntax. The expression can contain <a class="external text" href="../../LabTalk/LabTalk/Operators.html#Arithmetic_Operators">arithmetic operators</a>, <a class="external text" href="../../LabTalk/LabTalk/Range_Notation.html">range variables</a>, <a class="external text" href="../../LabTalk/Script/LabTalk-Supported_Functions.html">built-in LabTalk functions</a> and <a href="../../UserGuide/UserGuide/Create_a_User_Defined_Function_for_Set_Column_Values.html" title="UserGuide:Create a User Defined Function for Set Column Values">user-defined functions</a> etc. There are two places to define expressions:
</p>
<ul><li><b>Formula</b>. Only a single-line expression can be input here. Note how this expression is the right-hand part of a complete statement:</li></ul>
<p>Cell(i,j) = <b>c1*sin(i) + c2*cos(j)</b>.
</p>
<ul><li><b>Before Formula Scripts</b>. Multi-line LabTalk scripts can be input here, which will be executed before matrix values are set with the formula in the <b>Formula</b> edit box.</li></ul>
<dl><dd><a  class="image"><img alt="SetMatrixValuesPanel.png" src="../images/Entering_Expressions_in_the_Set_Values_Dialog/SetMatrixValuesPanel.png?v=47285" width="540"  /></a></dd></dl>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Entering_Expressions_in_the_Set_Values_Dialog/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><ol><li>Origin offers lots of <a class="external text" href="../../LabTalk/Script/LabTalk-Supported_Functions.html">built-in functions</a> under the <b> Function</b> menu, which can be directly used in the expression. You can also <a href="../../UserGuide/UserGuide/Create_a_User_Defined_Function_for_Set_Column_Values.html" title="UserGuide:Create a User Defined Function for Set Column Values">create a User-Defined Function</a> yourself.</li>
<li>The letter <b>i</b> and <b>j</b> are system variables that store the current row index and column index while the letter <b>x</b> and <b>y</b> represent the current X and Y values. You can use them in the <b>Formula</b> edit box.</li></ol>
</td></tr></table>
<h2><a name="Add_Expressions_only_in_Formula"></a><span class="mw-headline">Add Expressions only in <i>Formula</i></span></h2>
<p>You can add a single-line expression in the <b>Formula</b> edit box and leave the <b>Before Formula Scripts</b> panel empty. The expression in the <b>Formula</b> edit box can include built-in functions and user-defined functions. The following is an example that shows how functions can be used. 
</p><p><b>Example 1:</b>
</p>
<ol><li>Create a new matrix. Then click the <a  class="image"><img alt="AddMatrixMenu.png" src="../images/Entering_Expressions_in_the_Set_Values_Dialog/AddMatrixMenu.png?v=18313" width="17"  /></a> icon on the upper-right corner of the matrix and select <b>Add</b> to add a new matrix object.</li>
<li>Select <b>Matrix: Set Values</b> to open the <b>Set Values</b> dialog. Then input <b>i</b> in the <b>Formula</b> edit box and click the <b>Apply</b> button to generate data for it.</li>
<li>Click the next <a  class="image"><img alt="SetValuesNext.png" src="../images/Entering_Expressions_in_the_Set_Values_Dialog/SetValuesNext.png?v=18315" width="20"  /></a> button to set values for the second matrix object. Select <b>Function: Math: Cos(x)</b> from the menu of the dialog to add <b>cos()</b> to the <b>Formula</b> edit box. The cursor is positioned within the parentheses. Select <b>Mat(1): Mat(1)</b> from the menu. Then the expression will be <b>cos(Mat(1))</b>. Click the <b>OK</b> button to execute the formula.</li></ol>
<h2><a name="Add_Expressions_only_in_Before_Formula_Scripts"></a><span class="mw-headline">Add Expressions only in <i>Before Formula Scripts</i></span></h2>
<p>You can input multi-line LabTalk scripts in the <b>Before Formula Scripts</b> edit box and leave the <b>Formula</b> edit box empty. In addition to built-in functions or user-defined functions, any LabTalk scripts are supported here. So you can use range variables, string variables, loops and LabTalk accessible X-Functions. 
</p><p>The following example will get the same results as Example 1.
</p><p><b>Example 2:</b>
</p>
<ol><li>Create a new matrix. Then click the <a  class="image"><img alt="AddMatrixMenu.png" src="../images/Entering_Expressions_in_the_Set_Values_Dialog/AddMatrixMenu.png?v=18313" width="17"  /></a> icon on the upper-right corner of the matrix and select <b>Add</b> from the short-cut menu to add a new matrix object.</li>
<li>Select <b>Matrix: Set Values</b> to open the <b>Set Values</b> dialog. Then input <b>i</b> in the <b>Formula</b> edit box and click the <b>Apply</b> button to generate data for it.</li>
<li>Click the next <a  class="image"><img alt="SetValuesNext.png" src="../images/Entering_Expressions_in_the_Set_Values_Dialog/SetValuesNext.png?v=18315" width="20"  /></a> button to set values for the second matrix object. Enter <b>Mat(2)=cos(Mat(1))</b> in <b>Before Formula Scripts</b> and click the <b>OK</b> button to generate the data.</li></ol>
<h2><a name="Add_Expressions_in_both_Formula_and_Before_Formula_Scripts"></a><span class="mw-headline">Add Expressions in both <i>Formula</i> and <i>Before Formula Scripts</i></span></h2>
<p>Often, we need to enter scripts in both the <b>Formula</b> edit box and the <b>Before Formula Scripts</b> panel. For example, you can define range variables in <b>Before Formula Scripts</b> and then use them in <b>Formula</b>. 
</p><p><b>Example 3:</b>
</p>
<ol><li>Create a new project. </li>
<li>Create a new matrix which should be named as <b>MBook1</b>. Then click the <a  class="image"><img alt="AddMatrixMenu.png" src="../images/Entering_Expressions_in_the_Set_Values_Dialog/AddMatrixMenu.png?v=18313" width="17"  /></a> icon on the upper-right corner of the matrix and select <b>Add</b> from the short-cut menu to add a new matrix object. We will fill some numbers in them and use the numbers later.</li>
<li>Highlight <b>MBook1</b>. Right-click and select <b>Set Matrix Values</b> from the short-cut menu. Then input <b>i</b> in the <b>Formula</b> edit box. Click the <b>Apply</b> button to generate data for it.</li>
<li>Click the next <a  class="image"><img alt="SetValuesNext.png" src="../images/Entering_Expressions_in_the_Set_Values_Dialog/SetValuesNext.png?v=18315" width="20"  /></a> button to set values for the second matrix object. Input <b>j</b> in the <b>Formula</b> edit box. Click the <b>OK</b> button to generate data for it.</li>
<li>Create another matrix. It should be named <b>MBook2</b>. </li>
<li>Right-click in the empty, gray box in the upper left of MBook2 and select <b>Set Matrix Values</b> from the short-cut menu to open the <b>Set Values</b> dialog. We will define two range variables which refer to the two matrix objects of MBook1 in <b>Before Formula Scripts</b> and use them in the <b>Formula</b> edit box as shown in the following screenshot: 
<dl><dd><a  class="image"><img alt="SetMatrixRangeVariables.png" src="../images/Entering_Expressions_in_the_Set_Values_Dialog/SetMatrixRangeVariables.png?v=47221" width="426"  /></a></dd></dl></li>
<li>Click the <b>OK</b> button to generate data for MBook2. The results should look like:
<dl><dd><a  class="image"><img alt="SetMatrixValuesResults.png" src="../images/Entering_Expressions_in_the_Set_Values_Dialog/SetMatrixValuesResults.png?v=47222" width="382"  /></a></dd></dl></li></ol>


