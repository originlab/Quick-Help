<h1 class="firstHeading">16.2 Interpolate/Extrapolate Y from X</h1><p class='urlname' style='display: none'>Math-Inter-Extrapoltate-YfromX</p>
<div style="text-align: left; direction: ltr; margin-left: 1em;"><p><a  class="image"><img alt="Video Image.png" src="../images/Interpolate_Extrapolate_Y_from_X/Video_Image.png?v=29468" width="33"  /></a> See more related video:<a class="external text" href="http://www.originlab.com/Index.aspx?go=Support/VideoTutorials&amp;ss=chm&amp;pid=1889" target="_blank">Origin VT-0010 Interpolation</a>
</p></div>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Overview"><span class="tocnumber">1</span> <span class="toctext">Overview</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#To_Interpolate_Y_from_X"><span class="tocnumber">1.1</span> <span class="toctext">To Interpolate Y from X</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-3"><a href="#Dialog_Options"><span class="tocnumber">2</span> <span class="toctext">Dialog Options</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Algorithm"><span class="tocnumber">3</span> <span class="toctext">Algorithm</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#References"><span class="tocnumber">4</span> <span class="toctext">References</span></a></li>
</ul>
</div>

<h2><a name="Overview"></a><span class="mw-headline">Overview</span></h2>
<p><a  class="image"><img alt="InterpolateYFromX 1.png" src="../images/Interpolate_Extrapolate_Y_from_X/InterpolateYFromX_1.png?v=71139" width="443"  /></a><br />
Interpolation is a method of estimating and constructing new data points from a discrete set of known data points. Given an X vector, this function interpolates a vector Y based on the input curve (XY Range). Origin provides four options for data interpolation: <i>Linear</i>, <i>Cubic spline</i>, <i>Cubic B-spline</i>, <i>Akima Spline</i>.
</p><p><i>Linear interpolation</i> is the simplest and fastest data interpolation method. In linear interpolation, the arithmetic mean of two adjacent data points is calculated. This method is useful in situations where low precision can be tolerated. Linear interpolation is also useful for extremely large data sets, because the calculations are not time- or computation-power intensive.
</p><p>The generalization of linear interpolation is polynomial interpolation. Polynomial interpolation requires much more computation power than linear interpolation and when the polynomial order is high, the fit of the data oscillates wildly. These disadvantages can be avoided by using low-order polynomial fitting, or spline interpolation.
</p><p>The <i>Cubic spline</i> method uses 3<sup>rd</sup> order polynomials, and executes data-fitting in a piecewise fashion. Spline interpolation incurs less error than linear interpolation, and the interpolant is smoother.
</p><p>Similar to <i>Cubic spline</i> interpolation, <i>Cubic B-spline</i> interpolation also fits the data in a piecewise fashion, but it uses 3<sup>rd</sup> order Bezier splines to approximate the data. Cubic B-Splines allow the accurate modeling of more general classes of geometry.
</p>
<h5><a name="To_Interpolate_Y_from_X"></a><span class="mw-headline">To Interpolate Y from X</span></h5>
<ol><li>Create a new worksheet with input data.</li>
<li>Select desired data.</li>
<li>Select <b>Analysis: Mathematics:Interpolate/Extrapolate Y from X.</b> This opens the <b>interp1</b> dialog.</li></ol>
<p>The <a class="external text" href="../../XFunction/X-Function/Interp1.html">interp1</a> X-Function is called to perform the calculation.
</p><p><b>Note:</b> To generate uniform linearly spaced interpolated values, use the <a href="../../UserGuide/UserGuide/Interpolate_Extrapolate.html" title="UserGuide:Interpolate Extrapolate"><b>Interpolate/Extrapolate...</b></a> menu command.
</p>
<h2><a name="Dialog_Options"></a><span class="mw-headline">Dialog Options</span></h2>
<table class="dialogcontroltable">

<tr>
<th><b>Recalculate</b>
</th>
<td>
<p>Controls recalculation of analysis results
</p>
<ul><li><b>None</b> </li>
<li><b>Auto</b> </li>
<li><b>Manual</b>  </li></ul>
<p>For more information, see: <a class="external text" href="../../UserGuide/UserGuide/Recalculating_Analysis_Results.html">Recalculating Analysis Results</a>
</p>
</td></tr>
<tr>
<th>X Values to Interpolate
</th>
<td>
<p>The X column to interpolate on.
</p>
</td></tr>
<tr>
<th>Input
</th>
<td>
<p>The reference XY column(s) by which to interpolate Y from specify X column. Multiple XY columns can be choosed. If multi-XY are selected, each set of XY will be used as reference to interpolate the same X column and output the corresponding Y column and the coefficient value.
</p><p>For help with range controls, see: <a class="external text" href="../../UserGuide/UserGuide/Specifying_Your_Input_Data.html">Specifying Your Input Data</a>
</p>
</td></tr>
<tr>
<th>Method
</th>
<td>
<p>Specify interpolation methods 
</p>
<ul><li><b>Linear </b>
<dl><dd>Linear interpolation is a fast method of estimating a data point by constructing a line between two neighboring data points. The resulting point may not be an accurate estimation of the missing data. </dd></dl></li>
<li><b>Cubic Spline</b>
<dl><dd>This method splits the input data into a given number of pieces, and fits each segment with a cubic polynomial. The second derivative of each cubic function is set equal to zero. With these boundary conditions met, an entire function can be constructed in a piece-wise manner. </dd></dl></li>
<li><b>Cubic B-Spline</b>
<dl><dd>This method also splits the input data into pieces, each segment is fitted with discrete Bezier splines. </dd></dl></li>
<li><b>Akima Spline</b>
<dl><dd>This method is based on a piecewise function composed of a set of polynomials. The akima interpolation is stable to outliers.</dd></dl></li></ul>
</td></tr>
<tr>
<th>Extrapolate Option
</th>
<td>
<p>When parts of the data range specified by <b>X Values to Interpolate</b> is outside that of the X range specified in <b>Input</b>, these range parts will be considered as the extrapolated range, because the resulted Y values for these parts will be computed from extrapolation. This option can then be used to specify how to extrapolate the corresponding Y values.
</p>
<ul><li><b>Extrapolate</b> 
<dl><dd> Extrapolate Y using the last two points</dd></dl></li>
<li><b>Set missing</b>
<dl><dd> Set all Y values in the extrapolated range to be missing values.</dd></dl></li>
<li><b>Repeat the last value</b>
<dl><dd> Use the Y value of the closest input X value for all values in the extrapolated range.</dd></dl></li></ul>
</td></tr>
<tr>
<th>Boundary
</th>
<td>
<p>Boundary condition is only available in cubic spline method. 
</p>
<ul><li><b>Natural</b> 
<dl><dd>2nd derivatives are 0 on both ends. </dd></dl></li>
<li><b>Not-A-Knot</b>
<dl><dd>3rd derivatives are continuous on the second and last-second point.</dd></dl></li></ul>
</td></tr>
<tr>
<th>Smoothing Factor
</th>
<td>
<p>Smoothing is only available in Cubic B-Spline method.
</p>
</td></tr>
<tr>
<th>Result of interpolation
</th>
<td>
<p>The Y column(s) to output the inteplated Y values.
</p>
</td></tr>
<tr>
<th>Coefficients
</th>
<td>
<p>Output the coefficients for Spline or B-spline method or not, and show them in which column.
</p>
</td></tr></table>
<h2><a name="Algorithm"></a><span class="mw-headline">Algorithm</span></h2>
<p>Given a sequence of distinct pairs of data (<i><img src="../images/Interpolate_Extrapolate_Y_from_X/math-0a645fc515fe6128f91758f996ebe307.png?v=0" title="x_i\," alt="x_i\," class="tex"/></i>, <i><img src="../images/Interpolate_Extrapolate_Y_from_X/math-b19930487b77bb2b470dafd74c4e60fa.png?v=0" title="y_i\," alt="y_i\," class="tex"/></i>), where <img src="../images/Interpolate_Extrapolate_Y_from_X/math-4761687a623ae077b0cba0b0b8c1c1cf.png?v=0" title="i= 0, 1, ... n-1\!" alt="i= 0, 1, ... n-1\!" class="tex"/>. we are looking for the interpolated <img src="../images/Interpolate_Extrapolate_Y_from_X/math-301530a7f5da08f6e75622d6438fbd91.png?v=0" title="y\!" alt="y\!" class="tex"/> at <img src="../images/Interpolate_Extrapolate_Y_from_X/math-3a427d888687d9dfe0f72040d9fa53a4.png?v=0" title="x\!" alt="x\!" class="tex"/> by the following methods:
</p><p>1.  <b>Linear interpolation</b> (<i>interp1q</i>)
</p><p>For <img src="../images/Interpolate_Extrapolate_Y_from_X/math-2286d9f15cd7aa4b33fb66b32093db69.png?v=0" title="x&lt;x_{0,}y=y_0+\frac{y_1-y_0}{x_1-x_0}\times (x-x_0)" alt="x&lt;x_{0,}y=y_0+\frac{y_1-y_0}{x_1-x_0}\times (x-x_0)" class="tex"/>
</p><p>For <img src="../images/Interpolate_Extrapolate_Y_from_X/math-764955aa4711750a4f91d4369c8a26df.png?v=0" title="x&gt;x_{n-1,}y=y_{n-1}+\frac{y_{n-1}-y_{n-2}}{x_{n-1}-x_{n-2}}\times (x-x_{n-1})" alt="x&gt;x_{n-1,}y=y_{n-1}+\frac{y_{n-1}-y_{n-2}}{x_{n-1}-x_{n-2}}\times (x-x_{n-1})" class="tex"/>
</p><p>For <img src="../images/Interpolate_Extrapolate_Y_from_X/math-ae2d45ac8ead21449027a8625ff3a321.png?v=0" title="x_i&lt;x&lt;x_{i+1,}y=y_i+\frac{(y_{i+1}-y_{i)}}{(x_{i+1}-x_{i)}}\times (x-x_i)" alt="x_i&lt;x&lt;x_{i+1,}y=y_i+\frac{(y_{i+1}-y_{i)}}{(x_{i+1}-x_{i)}}\times (x-x_i)" class="tex"/>
</p><p>2.  <b>Cubic spline</b> (<i>spline</i>)
</p><p>Origin uses the natural cubic spline to do interpolation:
</p>
<dl><dd><img src="../images/Interpolate_Extrapolate_Y_from_X/math-37df50772f83cc096665cc3301a54541.png?v=0" title="y=Ay_i+By_{i+1}+Cy_i^{&#39;&#39;}+Dy_{i+1}^{&#39;&#39;} " alt="y=Ay_i+By_{i+1}+Cy_i^{&#39;&#39;}+Dy_{i+1}^{&#39;&#39;} " class="tex"/></dd></dl>
<p>where:
</p><p><img src="../images/Interpolate_Extrapolate_Y_from_X/math-23202931938360581de341a20f402ce5.png?v=0" title="A\equiv \frac{x_{i+1}-x}{x_{i+1}-x_i},B\equiv 1-A,C\equiv \frac 16\left( A^3-A\right) \left( x_{i+1}-x_i\right) ^2,D\equiv \frac 16(B^3-B)(x_{i+1}-x_i)^2" alt="A\equiv \frac{x_{i+1}-x}{x_{i+1}-x_i},B\equiv 1-A,C\equiv \frac 16\left( A^3-A\right) \left( x_{i+1}-x_i\right) ^2,D\equiv \frac 16(B^3-B)(x_{i+1}-x_i)^2" class="tex"/>
</p><p>And <img src="../images/Interpolate_Extrapolate_Y_from_X/math-f45e2aef61a1fc1dc82962f9c936286f.png?v=0" title="y_i^{&#39;&#39;}" alt="y_i^{&#39;&#39;}" class="tex"/>can be generated from:
</p><p><img src="../images/Interpolate_Extrapolate_Y_from_X/math-87eda369c25995b4ead9091695bc4c99.png?v=0" title="\frac{x_i-x_{i-1}}6y_{i-1}+\frac{x_{i+1}-x_{i-1}}3y_i+\frac{x_{i+1}-x_i}6y_{i+1}=\frac{y_{i+1}-y_i}{x_{i+1}-x_i}-\frac{y_i-y_{i-1}}{x_i-x_{i-1}}" alt="\frac{x_i-x_{i-1}}6y_{i-1}+\frac{x_{i+1}-x_{i-1}}3y_i+\frac{x_{i+1}-x_i}6y_{i+1}=\frac{y_{i+1}-y_i}{x_{i+1}-x_i}-\frac{y_i-y_{i-1}}{x_i-x_{i-1}}" class="tex"/>
</p><p>For boundary points, we set <img src="../images/Interpolate_Extrapolate_Y_from_X/math-f40f11403d7728f77fb3e6b752a3ba6c.png?v=0" title="y_o^{&#39;&#39;}" alt="y_o^{&#39;&#39;}" class="tex"/> and <img src="../images/Interpolate_Extrapolate_Y_from_X/math-dab9eb68306a521b23cb3c61ccbd22da.png?v=0" title="y_{n-1}^{&#39;&#39;}" alt="y_{n-1}^{&#39;&#39;}" class="tex"/>equal to zero.
</p><p>3.  <b>Cubic B-spline</b> (<i>bspline</i>)
</p><p>For <img src="../images/Interpolate_Extrapolate_Y_from_X/math-9085c488d167a78461c4bd7a4c930a8b.png?v=0" title="x&lt;x_0\! " alt="x&lt;x_0\! " class="tex"/> or <img src="../images/Interpolate_Extrapolate_Y_from_X/math-f490bf141f6bfc5b6130848b2dc4c510.png?v=0" title="x&gt;x_{n-1}\!" alt="x&gt;x_{n-1}\!" class="tex"/>perform linear interpolation.
</p><p>For <img src="../images/Interpolate_Extrapolate_Y_from_X/math-be300f3fad7d0a81a73fec2bbf5ff175.png?v=0" title="x_0&lt;x&lt;x_{n-1},y=\sum_{i=1}^{n-4} c_iN_i(x)" alt="x_0&lt;x&lt;x_{n-1},y=\sum_{i=1}^{n-4} c_iN_i(x)" class="tex"/>
</p><p>Here, <img src="../images/Interpolate_Extrapolate_Y_from_X/math-76579a5927afb649d2ad05211b349820.png?v=0" title="N(x)\!" alt="N(x)\!" class="tex"/> denotes the normalized cubic B-spline defined upon the knots <i><img src="../images/Interpolate_Extrapolate_Y_from_X/math-0a645fc515fe6128f91758f996ebe307.png?v=0" title="x_i\," alt="x_i\," class="tex"/></i>, <i><img src="../images/Interpolate_Extrapolate_Y_from_X/math-d52d60e99594ed33534fa1f75063caa2.png?v=0" title="x_i+1\," alt="x_i+1\," class="tex"/></i>, ..., <i><img src="../images/Interpolate_Extrapolate_Y_from_X/math-dbae88edddc31159993eb1f5ef14a5b6.png?v=0" title="x_i+4\," alt="x_i+4\," class="tex"/></i>, And <i><img src="../images/Interpolate_Extrapolate_Y_from_X/math-c528b0c61dee3193e34bed7c699eae72.png?v=0" title="c_i\," alt="c_i\," class="tex"/></i> denotes the coefficient of the corresponding function.
</p><p>The total number <img src="../images/Interpolate_Extrapolate_Y_from_X/math-a3904f143141153cc70766aff62f962c.png?v=0" title="n\!" alt="n\!" class="tex"/> of these knots and their values <i><img src="../images/Interpolate_Extrapolate_Y_from_X/math-f8e02b93931569df742620719c191421.png?v=0" title="x_1\," alt="x_1\," class="tex"/></i>, ..., <i><img src="../images/Interpolate_Extrapolate_Y_from_X/math-1c163dcc48d8a0b9331c99c021e07795.png?v=0" title="x_n\," alt="x_n\," class="tex"/></i> are chosen automatically by the function. The knots <i><img src="../images/Interpolate_Extrapolate_Y_from_X/math-b094c32c305423b0709cea53882770c9.png?v=0" title="x_5\," alt="x_5\," class="tex"/></i>, ...,  <i><img src="../images/Interpolate_Extrapolate_Y_from_X/math-f48235bca82ccf864fbb7831bf429ab8.png?v=0" title="x_n-4\," alt="x_n-4\," class="tex"/></i> are the interior knots; they divide the approximation interval [<i><img src="../images/Interpolate_Extrapolate_Y_from_X/math-f8e02b93931569df742620719c191421.png?v=0" title="x_1\," alt="x_1\," class="tex"/></i>, <i><img src="../images/Interpolate_Extrapolate_Y_from_X/math-84223fd0948413a7aff9e81d3610c059.png?v=0" title="x_m\," alt="x_m\," class="tex"/></i>] in to <img src="../images/Interpolate_Extrapolate_Y_from_X/math-0c39bb827a5c8e3b452374f034903183.png?v=0" title="n-7\!" alt="n-7\!" class="tex"/> sub-intervals. The coefficients <i><img src="../images/Interpolate_Extrapolate_Y_from_X/math-fd237b57e2c5d682b1ede37fd5191203.png?v=0" title="c_1\," alt="c_1\," class="tex"/></i>, <i><img src="../images/Interpolate_Extrapolate_Y_from_X/math-a2f5b11993679dafa520d1e60db8c27f.png?v=0" title="c_2\," alt="c_2\," class="tex"/></i>, ..., <i><img src="../images/Interpolate_Extrapolate_Y_from_X/math-ab4cb6018e67ab7a62baad1ed3dacb8c.png?v=0" title="c_n-4\," alt="c_n-4\," class="tex"/></i> are then determined as the solution of the following constrained minimization problem:
</p><p>minimize
</p>
<dl><dd><dl><dd><dl><dd><img src="../images/Interpolate_Extrapolate_Y_from_X/math-153df0ebe8c878cc55e4feb7aeac6321.png?v=0" title="\eta =\sum_{i=5}^{n-4}\delta _i^2\," alt="\eta =\sum_{i=5}^{n-4}\delta _i^2\," class="tex"/></dd></dl></dd></dl></dd></dl>
<p>subject to the constraint
</p>
<dl><dd><dl><dd><dl><dd><img src="../images/Interpolate_Extrapolate_Y_from_X/math-c67f0b7e96f227a7e2c1517212c54d6b.png?v=0" title="\theta =\sum_{r=1}^m\varepsilon _r^2\leq S\," alt="\theta =\sum_{r=1}^m\varepsilon _r^2\leq S\," class="tex"/></dd></dl></dd></dl></dd></dl>
<p>where  <i><img src="../images/Interpolate_Extrapolate_Y_from_X/math-551f23ff7eff19a995a74585d9ae89c2.png?v=0" title="\delta _i\," alt="\delta _i\," class="tex"/></i>  stands for the discontinuity jump in the third order derivative of <img src="../images/Interpolate_Extrapolate_Y_from_X/math-301530a7f5da08f6e75622d6438fbd91.png?v=0" title="y\!" alt="y\!" class="tex"/> at the interior knot <i><img src="../images/Interpolate_Extrapolate_Y_from_X/math-0a645fc515fe6128f91758f996ebe307.png?v=0" title="x_i\," alt="x_i\," class="tex"/></i>, <img src="../images/Interpolate_Extrapolate_Y_from_X/math-fb2b5e85803d6d4f85e8c5147815edeb.png?v=0" title="\varepsilon _r\," alt="\varepsilon _r\," class="tex"/> denotes the weighted residual <img src="../images/Interpolate_Extrapolate_Y_from_X/math-4c837daf72b6acd558569ecc29af63cc.png?v=0" title="w_r (y_r-y(x_r))\," alt="w_r (y_r-y(x_r))\," class="tex"/>, and S is a non-negatative number to be specified by the user.
</p><p>The quantity <i><img src="../images/Interpolate_Extrapolate_Y_from_X/math-e2ba1b68ce44f2bb523e4c1f58ca0c42.png?v=0" title="\eta\," alt="\eta\," class="tex"/></i> can be seen as a measure of the (lack of) smoothness of <img src="../images/Interpolate_Extrapolate_Y_from_X/math-301530a7f5da08f6e75622d6438fbd91.png?v=0" title="y\!" alt="y\!" class="tex"/>, while closeness of fit is measured through <i><img src="../images/Interpolate_Extrapolate_Y_from_X/math-91021c9f520a03331f431a3ceadcccc8.png?v=0" title="\theta\," alt="\theta\," class="tex"/></i>. By means of the parameter <img src="../images/Interpolate_Extrapolate_Y_from_X/math-31ea319361d1b03c9f77c6fbdb6833bd.png?v=0" title="S\!" alt="S\!" class="tex"/>, 'the smoothing factor', the user will then control the balance between these two (usually conflicting) properties. If <img src="../images/Interpolate_Extrapolate_Y_from_X/math-31ea319361d1b03c9f77c6fbdb6833bd.png?v=0" title="S\!" alt="S\!" class="tex"/> is too large, the spline will be too smooth and signal will be lost (underfit); if <img src="../images/Interpolate_Extrapolate_Y_from_X/math-31ea319361d1b03c9f77c6fbdb6833bd.png?v=0" title="S\!" alt="S\!" class="tex"/> is too small, the spline will pick up too much noise (overfit). In the extreme cases the function will return an interpolating spline (<i><img src="../images/Interpolate_Extrapolate_Y_from_X/math-91021c9f520a03331f431a3ceadcccc8.png?v=0" title="\theta\," alt="\theta\," class="tex"/></i>=0) is <img src="../images/Interpolate_Extrapolate_Y_from_X/math-31ea319361d1b03c9f77c6fbdb6833bd.png?v=0" title="S\!" alt="S\!" class="tex"/> is set to zero, and the weighted least-squares cubic polynomial (<i><img src="../images/Interpolate_Extrapolate_Y_from_X/math-e2ba1b68ce44f2bb523e4c1f58ca0c42.png?v=0" title="\eta\," alt="\eta\," class="tex"/></i>=0) is <img src="../images/Interpolate_Extrapolate_Y_from_X/math-31ea319361d1b03c9f77c6fbdb6833bd.png?v=0" title="S\!" alt="S\!" class="tex"/> if set very large. Experimenting with <img src="../images/Interpolate_Extrapolate_Y_from_X/math-31ea319361d1b03c9f77c6fbdb6833bd.png?v=0" title="S\!" alt="S\!" class="tex"/> values between these two extremes should result in a good compromise.
</p><p>4. <b>Akima Spline</b> (<i>akima</i>)
</p><p>The Akima interpolation method is based on a piecewise function composed of a set of polynomials(third degree at most). This piecewise function can be applied to successive intervals of the given XY points. The slope of the input data plot at each given point can be assumed to be determined by the XY coordinates of 4 neighbor points and the point itself. Then from the slopes at two paired given points and their coordinates, a third degree polynomial is calculated, representing the interval curve between these two points, and the interpolation is then carried out based on the combination of polynomials. An additional estimation is made when calculating polynomials for end points.
</p><p>Firstly the curve slope <img src="../images/Interpolate_Extrapolate_Y_from_X/math-e358efa489f58062f10dd7316b65649e.png?v=0" title="t" alt="t" class="tex"/> at a given point will be calculated. For a given point (point 3), there will then be five data points 1,2,3,4,5, and <img src="../images/Interpolate_Extrapolate_Y_from_X/math-e281d4c28ba868770a36ef30bb48d90a.png?v=0" title="m_{1}, m_{2}, m_{3}, m_{4}" alt="m_{1}, m_{2}, m_{3}, m_{4}" class="tex"/> are slopes of line segments <img src="../images/Interpolate_Extrapolate_Y_from_X/math-285419bc5975edd9dfcfacd932e1fd59.png?v=0" title="\bar{12}, \bar{23}, \bar{34}, \bar{45}" alt="\bar{12}, \bar{23}, \bar{34}, \bar{45}" class="tex"/> respectively, and <img src="../images/Interpolate_Extrapolate_Y_from_X/math-7d627446c33c02b2908d5ef7dc3dc3e4.png?v=0" title="m_i=(y_{i+1}-y_i)/(x_{i+1}-x_i)" alt="m_i=(y_{i+1}-y_i)/(x_{i+1}-x_i)" class="tex"/>. The curve slope <img src="../images/Interpolate_Extrapolate_Y_from_X/math-e358efa489f58062f10dd7316b65649e.png?v=0" title="t" alt="t" class="tex"/> is then determined by the following equations under different conditions:
</p><p>When <img src="../images/Interpolate_Extrapolate_Y_from_X/math-014c7bf63dc8b9770b6bc4a314b253f3.png?v=0" title="m_{1}\neq m_{2}" alt="m_{1}\neq m_{2}" class="tex"/> or <img src="../images/Interpolate_Extrapolate_Y_from_X/math-4311060944c0f9b6daf5e27c4ee01789.png?v=0" title="m_{3}\neq m_{4}" alt="m_{3}\neq m_{4}" class="tex"/>,
</p>
<dl><dd><img src="../images/Interpolate_Extrapolate_Y_from_X/math-f224d95c7af4ace0a9ca76f828fe8eb6.png?v=0" title="t = \left ( \left | m_{4} - m_{3} \right |m_{2} + \left | m_{2} - m_{1} \right |m_{3} \right  )/\left ( \left | m_{4} - m_{3} \right | + \left | m_{2} - m_{1} \right |\right  )" alt="t = \left ( \left | m_{4} - m_{3} \right |m_{2} + \left | m_{2} - m_{1} \right |m_{3} \right  )/\left ( \left | m_{4} - m_{3} \right | + \left | m_{2} - m_{1} \right |\right  )" class="tex"/></dd></dl>
<p>When <img src="../images/Interpolate_Extrapolate_Y_from_X/math-75ba7702cdab7b6144e6ec0073cf9f1d.png?v=0" title="m_{1} = m_{2}" alt="m_{1} = m_{2}" class="tex"/> and <img src="../images/Interpolate_Extrapolate_Y_from_X/math-b0468899102e50fb6f03acaedf9a08d9.png?v=0" title="m_{3} = m_{4}" alt="m_{3} = m_{4}" class="tex"/>,
</p>
<dl><dd><img src="../images/Interpolate_Extrapolate_Y_from_X/math-0ee8fff3c27ce3ed8a66e19e19a0567a.png?v=0" title=" t = \frac{(x_4-x_3)m_2 + (x_3-x_2)m_3}{x_4-x_2}" alt=" t = \frac{(x_4-x_3)m_2 + (x_3-x_2)m_3}{x_4-x_2}" class="tex"/></dd></dl>
<p>Slopes for two end points need to be estimated at each end of the curve. To estimate them, we calculate its slope by interpolating a parabolic curve from its adjacent three points, e.g. for the first point's slope, we can interpolate a parabolic curve from first three points, and the first point's slope can be calculated by the derivative of the interpolated curve.
</p><p>Then the polynomial for an interval <img src="../images/Interpolate_Extrapolate_Y_from_X/math-b9ecd49b3245fff5c8a6ccb8e4a645be.png?v=0" title="[x_i, x_{i+1}]" alt="[x_i, x_{i+1}]" class="tex"/> between two consecutive data points <img src="../images/Interpolate_Extrapolate_Y_from_X/math-77f147b98729e0b8c06465d522c7039f.png?v=0" title="\left ( x_i, y_i \right )" alt="\left ( x_i, y_i \right )" class="tex"/> and <img src="../images/Interpolate_Extrapolate_Y_from_X/math-2798950c5b772d16c859b3b35db673b7.png?v=0" title="\left ( x_{i+1}, y_{i+1} \right )" alt="\left ( x_{i+1}, y_{i+1} \right )" class="tex"/> are determined by the following four conditions:
</p>
<dl><dd><img src="../images/Interpolate_Extrapolate_Y_from_X/math-69b84550afd635503768b7f0e3deb5d0.png?v=0" title="y|_{x=x_i} = y_i" alt="y|_{x=x_i} = y_i" class="tex"/> </dd></dl>
<dl><dd><img src="../images/Interpolate_Extrapolate_Y_from_X/math-09a6f71e3d4a4f5baa4c9b3dd7879afb.png?v=0" title="y&#39;|_{x=x_i}=t_i" alt="y&#39;|_{x=x_i}=t_i" class="tex"/></dd></dl>
<dl><dd><img src="../images/Interpolate_Extrapolate_Y_from_X/math-51f7e29278a095db5cc0c8b6866b8e98.png?v=0" title="y|_{x=x_{i+1}} = y_{i+1}" alt="y|_{x=x_{i+1}} = y_{i+1}" class="tex"/> </dd></dl>
<dl><dd><img src="../images/Interpolate_Extrapolate_Y_from_X/math-e9145ab06cc9e563677f8e435b6b0ea8.png?v=0" title="y&#39;|_{x=x_{i+1}}=t_{i+1}" alt="y&#39;|_{x=x_{i+1}}=t_{i+1}" class="tex"/></dd></dl>
<p>where <img src="../images/Interpolate_Extrapolate_Y_from_X/math-f406db9a09c0430f7e54c1a3bb217c3e.png?v=0" title="t_i" alt="t_i" class="tex"/> and <img src="../images/Interpolate_Extrapolate_Y_from_X/math-9269d66b512bd8284a9ec8d7f56a021b.png?v=0" title="t_{i+1}" alt="t_{i+1}" class="tex"/> are the slopes at the two points.
</p>
<h2><a name="References"></a><span class="mw-headline">References</span></h2>
<p>1.  Michelle Schatzman. <i>Numerical Analysis: A Mathematical Introduction, Chapters 4 and 6</i>. Clarendon Press, Oxford (2002).
</p><p>2.  William H. Press, etc. <i>Numerical Recipes in C++. 2<sup>nd</sup> Edition</i>. Cambridge University Press (2002).
</p><p>3.  Nag C Library Function Document, nag_1d_spline_fit (e02bec).
</p><p>4.  Hiroshi Akima, <i>Journal of the Association for Computing Machinery</i>, Vol. 17, No. 4, (1970)
</p>





