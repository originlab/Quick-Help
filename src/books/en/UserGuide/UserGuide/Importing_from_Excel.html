<h1 class="firstHeading">6.1 Importing from Excel</h1><p class='urlname' style='display: none'>Import-Excel</p>
<h2><a name="Importing_Excel_Data_using_the_Import_Excel_Data_Connector_Dialog"></a><span class="mw-headline">Importing Excel Data using the Import Excel Data Connector Dialog</span></h2>
<p><a href="../../UserGuide/Category/Data_Connector.html" title="Category:Data Connector"><b>Data Connectors</b></a> are a relatively new general import mechanism. For Origin 2021b, the <b>Import Excel</b> toolbar button has been re-coded to use the Excel Connector, in place of the older <a href="#Importing_Excel_Data_using_the_impMSExcel_X-Function_Dialog"><b>impMSExcel</b></a> routine.
</p>
<dl><dd><dl><dd><a  class="image"><img alt="Excel import option dlg.png" src="../images/Importing_from_Excel/Excel_import_option_dlg.png?v=91061" width="325"  /></a></dd></dl></dd></dl>
<ol><li> With a worksheet active, choose <b>Data: Connect to File</b>; or click the <b>Import Excel</b> button <a  class="image"><img alt="Button Import Excel.png" src="../images/Importing_from_Excel/Button_Import_Excel.png?v=87520" width="25"  /></a> on the Import toolbar at the top of your workspace.</li>
<li> If your Excel file has multiple sheets, specify one <b>Excel Sheet</b> to connect (you will have the chance to connect additional sheets after the connection is made).</li>
<li> The <b>Auto</b> box is checked for <b>Main header lines</b>, by default. Header lines will be added to a <b>File Header</b> label row.</li>
<li> If you clear <b>Auto</b> and enter the number of <b>Main header lines</b>, an additional <b>Save file header to</b> drop-down is added to the dialog. Use this to specify saving header info to the <a href="../../UserGuide/UserGuide/Displaying_Supporting_Data_in_Worksheet_Header_Rows.html" title="UserGuide:Displaying Supporting Data in Worksheet Header Rows"><b>Worksheet label area</b></a> or the <a href="../../UserGuide/UserGuide/The_Workbook_Organizer.html" title="UserGuide:The Workbook Organizer"><b>Book organizer</b></a>.</li>
<li> When sub-header lines are detected, the <b>Column Labels</b> box is checked and <b>Long Name</b> and <b>Units</b> rows are automatically specified. To manually specify the location of <b>Column Labels</b>, including <b>Comments From</b> and <b>Comments To</b>, edit the accompanying combo boxes.</li>
<li> For partial import, check <b>Partial Import</b> and enter ranges for <b>Column</b> and <b>Row</b> following the in-dialog examples or by referring to the <b>Custom</b> syntax outlined in <a href="../../UserGuide/Category/Partial_Importing_and_Re_Importing.html#Partial_Import_Controls_used_by_Import_From_File" title="Category:Partial Importing and Re Importing">this table</a>.</li>
<li> To add <a class="external text" href="../../QuickHelp/QuickHelp/What_is_a_Sparkline_and_how_do_I_customize_it.html">sparklines</a> on import, click the <b>Other Options</b> button (to the left of <b>OK</b>) and select a radio button. To disable sparklines on import, set <a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#H.2CI.2CJ.2CK"><b>@IMPS</b> = <i>0</i></a>.</li>
<li> If your import Excel file has <i>merged data cells</i>:
<ul><li> For merged cells in the <i>label rows</i> that are designated as <b>Comments</b> in <b>Excel Import Options</b>, (<b>1</b>) vertically-merged values are imported as one value; (<b>2</b>) horizontally-merged values are duplicated across merged cells.</li>
<li> Merged cells in the <i>data area</i> (<b>3</b>) are not kept; merged cell values will be duplicated across merged cells.</li></ul>
<dl><dd><a  class="image"><img alt="UG merge cells on XLS import.png" src="../images/Importing_from_Excel/UG_merge_cells_on_XLS_import.png?v=93507" width="623"  /></a></dd></dl></li>
<li> To run LabTalk scripts after import for post-processing, click the <b>Other Options</b> button and enter the scripts in the <b>Post Import LabTalk Script</b> edit box.</li>
<li> Once you have imported your file, you can <b>Add and Connect Sheet(s)</b> to add other sheets in your Excel file using the <a href="../../UserGuide/UserGuide/Data_Navigator.html" title="UserGuide:Data Navigator">the <b>Data Navigator</b></a> panel.</li></ol>
<h2><a name="Importing_Excel_Data_using_the_impMSExcel_X-Function_Dialog"></a><span class="mw-headline">Importing Excel Data using the impMSExcel X-Function Dialog</span></h2>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Importing_from_Excel/Alert_icon.png?v=9649" width="57"  border="0" /></td><td><p>Beginning with <b>Origin 2021b</b>, clicking the <b>Import Excel</b> button <a  class="image"><img alt="Button Import Excel.png" src="../images/Importing_from_Excel/Button_Import_Excel.png?v=87520" width="25"  /></a> will open the <b>Excel Import Options</b> Data Connector dialog box. To revert to previous behavior where this button opened the <b>impMSExcel</b> dialog box, set LabTalk system variable <a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#T"><b>@TIB</b> = <i>2</i></a>. To change the value of a system variable, see <a class="external text" href="../../QuickHelp/QuickHelp/How_do_I_permanently_change_the_value_of_a_system_variable.html">this FAQ</a>.
</p>
	</td>
	</tr>
	</table>
<p><b>To import an Excel file:</b>
</p>
<ol><li>Select <b>Data: Import from File: Excel (XLS, XLSX, XLSM)...</b>, or click the <b>Import Excel</b> button <a  class="image"><img alt="Button Import Excel.png" src="../images/Importing_from_Excel/Button_Import_Excel.png?v=87520" width="25"  /></a> located in the <b>Standard</b> toolbar. This opens the Excel dialog box. </li>
<li>Add your files one at a time or press CTRL or SHIFT to select multiple files, and click <b>Add File(s)</b>. After choosing all the files, click the OK button. For more information about this setting, please see below. </li>
<li>Make necessary adjustments in the <a class="external text" href="../../XFunction/X-Function/ImpMSExcel.html">impMSExcel</a> dialog box, then click the <b>OK</b> button to import the files into Origin. </li></ol>
<p><br />
<i><b>Additional Excel dialog box controls</b></i>
</p>
<ul><li>Use the <b>Remove File(s)</b> button to remove selected files from the import file list. </li>
<li>Click the <b>buttons</b> (see the picture below) over the import file list to sort the files by <b>File Name</b>, <b>Size</b> or <b>Modified</b> date. </li></ul>
<dl><dd><a  class="image"><img alt="Importing from Excel-1.png" src="../images/Importing_from_Excel/Importing_from_Excel-1.png?v=8340" width="443"  /></a></dd></dl>
<ul><li>Origin opens a secondary dialog box -- the <a class="external text" href="../../XFunction/X-Function/ImpMSExcel.html">impMSExcel</a> dialog box -- when you click the <b>OK</b> button. </li></ul>
<p><br />
<b>To re-import one or multiple Excel sheets:</b>
</p><p>From Origin 2015, you are allowed to re-import multiple sheets from Excel to Origin. During Excel re-importing, a link is maintained so that Origin is able to use up-to-date data.
</p><p>To re-import Excel files, go to <b>Data: Re-Import Directly</b> or use Ctrl+4 keys to re-import Excel sheets with same settings as before. Or you can go to <b>File: Re-Import...</b> to bring up dialog box to change import settings for files to be re-imported.
</p><p>You can also type command <b>reimport -d</b> in command window to re-import Excel files.
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Importing_from_Excel/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>One advantage of the <b>Excel Connector</b> (and Data Connectors, in general) is that it can be automatically configured to update your project upon data changes in the connected Excel file. See <a href="../../UserGuide/Category/Working_with_Microsoft_Excel.html#Reimport_Data_if_Changed" title="Category:Working with Microsoft Excel"><b>Working with Microsoft Excel</b></a> for information.
</p></td></tr></table>
<p><br />
The <b>impMSExcel</b> dialog box allows more controls over the way in which .XLS or .XLSX or .XLSM files are imported: 
</p>
<table class="dialogcontroltable">

<tr>
<th>File Name
</th>
<td>
<p>The <b>File Name</b> box lists all the files that have been chosen in the <b>Excel</b> dialog. Note that you can click the <b>Browse</b> button to the right to re-select your files. 
</p>
</td></tr>
<tr>
<th>File Info
</th>
<td>
<p>Node gives file size and sheet structure of selected excel file(s):
</p>
<ul><li> The read-only <b>Info</b> box shows the size of the Excel file. </li>
<li> All sheets in the Excel file are shown. Choose sheet(s) to be imported using the check box next to each sheet.</li></ul>
</td></tr>
<tr>
<th>1st File Import Mode
</th>
<td>
<p>Import mode for the first file to be imported. Choose from:
</p>
<ul><li> <b>Replace Existing Data</b> to import data by replacing the existing Excel data in target window.</li>
<li> <b>Start New Books</b> to import the first file to a new workbook.</li>
<li> <b>Start New Sheets</b> to import the first file into the empty sheets following the active sheet, if it exists; Otherwise, import file into new sheets following the active sheet. A maximum of 1024 sheets can be added to a book before a new book will be created.</li>
<li> <b>Start New Columns for Each Sheet</b> to import each sheet in the first Excel file as new columns in the specified worksheet.</li>
<li> <b>Start New Books for Each Sheet</b> to import each sheet in the first Excel file into a new book.</li></ul>
</td></tr>
<tr>
<th>Multi-File (except 1st) Import Mode
</th>
<td>
<p>Import Mode for files after the first file. Choose from:
</p>
<ul><li> <b>Start New Books</b> to import each file to a new workbook.</li>
<li> <b>Start New Sheets</b> to import files into empty sheets following the active sheet in the workbook into which data were first imported, if it exists; otherwise import file into new sheets following active sheet. A maximum of 1024 sheets can be added to a book before a new book will be created.</li>
<li> <b>Start New Columns for Each Sheet</b> to import each worksheet in the Excel file as new columns to the Origin worksheet into which the first file was imported.</li>
<li> <b>Start New Books for Each Sheet</b> to import each sheet in file(s) following the first Excel file, into a new book.</li></ul>
</td></tr>
<tr>
<th>Template Name
</th>
<td>
<p>For data import, a workbook template (*.otw) or an analysis template (*.ogw) can be used. Select a template from the list, or click the browse button. 
</p>
<ul><li> By default, an Origin prototype workbook template <i>&lt;default&gt;</i> is used. </li>
<li> Origin also provides a special template named <i>&lt;clone&gt;</i>, which allows importing data files into a worksheet/workbook cloned from active worksheet/workbook. </li></ul>
<p><b>Note:</b> when importing a multi-sheets Excel book into the specified workbook template which contains empty worksheet(s), you can refer to <a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#H.2CI.2CJ.2CK">system variable @ISE</a> for additional control over importing behavior.
</p>
</td></tr>
<tr>
<th>Column Designations
</th>
<td>
<p>Apply Origin column <a href="../../UserGuide/UserGuide/Set_Column_Designation.html" title="UserGuide:Set Column Designation">plot designations</a> to imported Excel workbook data. Make a selection from the drop-down list, or type the designation directly. This option supports the column designation syntax (such as repeat designations) same as Import Wizard. You can refer to <a href="../../UserGuide/UserGuide/Import_Wizard_Data_Columns_Page_(ASCII).html#Column_Designations" title="UserGuide:Import Wizard Data Columns Page (ASCII)">this page</a> for more details.
</p><p><b>Note:</b> the specified column designation will be applied to all sheets automatically.
</p>
</td></tr>
<tr>
<th>Add Sparklines
</th>
<td>
<p>Add sparklines for the data:
</p>
<ul><li> <b>No</b>: disable sparklines.</li>
<li> <b>Yes</b>: to add sparklines.</li>
<li> <b>Yes(if less than 50 columns)</b> to add sparklines if there are less than 50 columns.</li></ul>
</td></tr>
<tr>
<th>Import Cell Formats
</th>
<td>
<p>Specify whether to import cell formats (text color, font, cell height, .etc) in the Excel file.
</p>
</td></tr>
<tr>
<th>Maximum Number of Empty Columns (-1 for all)
</th>
<td>
<p>Specify the maximum number of empty columns that will be imported into Origin.
</p>
</td></tr>
<tr>
<th>Exclude Empty Sheets
</th>
<td>
<p>Specify whether input the empty sheets into target window. If it is chekced, empty sheets will not appear in the <b>File Sheet(s)</b> branch under the File Info branch.
</p>
</td></tr>
<tr>
<th>Apply Header to All Sheets
</th>
<td>
<p>Specify whether apply the header settings in the Header Lines branch to all Excel sheets.
</p>
</td></tr>
<tr>
<th>(Re)Naming Worksheet and Workbook
</th>
<td>
<p>Specify how to rename the worksheet and workbook.
</p>
<ul><li><b>Auto Rename Using File Name</b>: If it is checked, Origin will use the default settings to rename the worksheet and workbook name, which is, (1)using the whole filename (includes the file extension) as workbook name, (2)using Excel sheet name as worksheet name.</li>
<li><b>Rename Sheet with Excel Sheet Name</b>: Specify whether rename the sheet with the Excel sheet name.</li>
<li><b>Rename Book with (Partial) Filename</b>: Check this to use part of the file name as workbook name.</li>
<li><b>Trim Filename From</b>: Specify the start of the name.</li>
<li><b>Trim Filename To</b>: Specify the end of the name.</li>
<li><b>Rename Long Name for Book only</b>: Check this to rename the long name for book only, but not short name.</li>
<li><b>Include File Path when Renaming Book</b>: Specify if the file path should be included for the workbook name.</li>
<li><b>Append Filename to Workbook Comment</b>: Specify if the file name should be appended to the workbook comment.</li>
<li><b>Append Filename to Worksheet Comment</b>: Specify if the file name should be appended to the worksheet comment.</li>
<li><b>Append Filename to Column Comment</b>: Specify if the file name should be appended to the column Comment row.</li>
<li><b>Add Filename User Parameters Row</b>: Specify if the file name should be put to the column User Parameter row "SourceFile".</li>
<li><b>Include File Path when Appending Filename</b>: When this is checked, the import file path is included to the appended file name (so as file extension).</li>
<li><b>Add Sheetname User Parameter Row</b>: Specify if the sheet name should be put to the column User Parameter row "SourceSheet".</li></ul>
</td></tr>
<tr>
<th>Header Lines
</th>
<td>
<p>Use these branch to specify which rows, if any, should be supply Origin worksheet column <b>Long Name</b>, <b>Unit</b> and <b>Comment</b>. The <b>Number of Main Header Lines</b> and <b>Number of Subheader Lines</b> can be specified too.
</p>
<ul><li><b>Number of Main Header Lines(exclude subheader lines)</b>: Specify the number of the main header lines, which will be skipped upon importing.</li>
<li><b>Number of Subheader Lines</b>: Specify the number of the subheader lines.</li>
<li><b>Long Names</b>: Specify the row index for column long name row.</li>
<li><b>Units</b>: Specify the row index for column units row.</li>
<li><b>Comments From</b>: Specify the starting index of the comments rows.</li>
<li><b>Comments To</b>: Specify the ending index of the comments rows.</li>
<li><b>System Parameters From</b>: Specify the starting index of the system parameters rows.</li>
<li><b>System Parameters To</b>: Specify the ending index of the system parameters rows.</li>
<li><b>User Parameters From</b>: Specify the starting index of the user parameters rows.</li>
<li><b>User Parameters To</b>: Specify the ending index of the user parameters rows.</li></ul>
</td></tr>
<tr>
<th>Partial Import
</th>
<td> Select columns and/or rows to import by specifying a regularly repeating pattern; or use <b>Custom</b> and the notation listed in <a href="../../UserGuide/Category/Partial_Importing_and_Re_Importing.html" title="Category:Partial Importing and Re Importing">Partial Import and Re-import</a> to select columns for import. Note that for columns or rows, specifying <b>To = 0</b> means "read to the end."
<ul><li><b>Partial Import</b>: Apply partial import settings to <b>All Files</b> or <b>From Second File On</b>.</li>
<li><b>Partial Columns</b>: Use these controls to specify a regular pattern of columns to import, beginning with the starting column (<b>From</b>), read <i>m</i> number of columns (<b>Read</b>), then skip <i>n</i> columns (<b>Skip</b>), repeating pattern until you reach the last column (<b>To</b>).</li>
<li><b>Partial Rows</b>: Use these controls to specify a regular pattern of rows to import, beginning with the starting row (<b>From</b>), read <i>m</i> number of rows (<b>Read</b>), then skip <i>n</i> rows (<b>Skip</b>), repeating pattern until you reach the last row (<b>To</b>).</li></ul>
<p>For <b>Custom</b>, see  <a href="../../UserGuide/Category/Partial_Importing_and_Re_Importing.html" title="Category:Partial Importing and Re Importing">Partial Import and Re-import</a> for the notation used to specify data range selection.
</p>
</td></tr>
<tr>
<th>Scripts
</th>
<td>
<p>Third branch Script is used to specify the LabTalk scripts to be run after file(s) being imported.
</p>
<ul><li><b>Script after Each File Imported</b>: Enter LabTalk scripts in the edit box to be run after each file is imported.</li>
<li><b>Script after All Files Imported</b>: Enter LabTalk scripts in the edit box to be run only after all files are imported.</li></ul>
</td></tr></table>


