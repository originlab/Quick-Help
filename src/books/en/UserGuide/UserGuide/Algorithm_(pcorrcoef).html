<h1 class="firstHeading">17.1.10.2 Algorithm (Partial Correlation Coefficient)</h1><p class='urlname' style='display: none'>Parial-Corr-Coef-Algorithm</p>
<p><br />
Partial correlation coefficient is used to describe the relation between two variables in the presence of controlling variables.
</p>
<h2><a name="Partial_Correlation_Coefficient"></a><span class="mw-headline">Partial Correlation Coefficient</span></h2>
<p>For a set of <img src="../images/Algorithm_(pcorrcoef)/math-88449ca5365fc85a4051a4f39cf72e31.png?v=0" title="n_y" alt="n_y" class="tex"/> random variables <b>Y</b>  and <img src="../images/Algorithm_(pcorrcoef)/math-d037fcd5fa24c8673763af9c9253cdb1.png?v=0" title="n_x" alt="n_x" class="tex"/> controlling variables <b>X</b>, combine two sets of variables <b>X</b> and <b>Y</b>, its variance-covariance matrix can be expressed as:
</p>
<div class="center"><img src="../images/Algorithm_(pcorrcoef)/math-90b8ce2774c5073b1124c7e9a4b41957.png?v=0" title="&#10;\begin{pmatrix}&#10;\Sigma_{xx} &amp; \Sigma_{xy} \\&#10;\Sigma_{yx} &amp; \Sigma_{yy}&#10;\end{pmatrix}&#10;" alt="&#10;\begin{pmatrix}&#10;\Sigma_{xx} &amp; \Sigma_{xy} \\&#10;\Sigma_{yx} &amp; \Sigma_{yy}&#10;\end{pmatrix}&#10;" class="tex"/></div>
<p>The variance-covariance matrix of <b>Y</b> variables for controlling variables <b>X</b> is given by:
</p>
<div class="center"><img src="../images/Algorithm_(pcorrcoef)/math-a497642b29af9eda7964583875b85002.png?v=0" title="&#10;\Sigma_{y|x} = \Sigma_{yy}-\Sigma_{yx}\Sigma_{xx}^{-1}\Sigma_{xy}&#10;" alt="&#10;\Sigma_{y|x} = \Sigma_{yy}-\Sigma_{yx}\Sigma_{xx}^{-1}\Sigma_{xy}&#10;" class="tex"/></div>
<p>The partial correlation coefficient matrix is calculated by:
</p>
<div class="center"><img src="../images/Algorithm_(pcorrcoef)/math-dc013e6067313a0ed2ca5041a49ac91b.png?v=0" title="&#10;\text{diag}(\Sigma_{y|x})^{-1/2} \Sigma_{y|x} \text{diag}(\Sigma_{y|x})^{-1/2}.&#10;" alt="&#10;\text{diag}(\Sigma_{y|x})^{-1/2} \Sigma_{y|x} \text{diag}(\Sigma_{y|x})^{-1/2}.&#10;" class="tex"/></div>
<h2><a name="Significance_of_Partial_Correlation_Coefficient"></a><span class="mw-headline">Significance of Partial Correlation Coefficient</span></h2>
<p>A t-Test can be used to test the hypothesis that a partial correlation coefficient is zero.
</p><p>The degrees of freedom are:<br />
</p>
<div class="center"><img src="../images/Algorithm_(pcorrcoef)/math-0613eb5b6527b5b309de243d94b08a47.png?v=0" title="df=n-n_x-2" alt="df=n-n_x-2" class="tex"/></div>
<p>where <b>n</b> is the number of observations in the calculation of the full correlation. For pairwise deletion of missing values, in the calculation of partial correlation of two variables <img src="../images/Algorithm_(pcorrcoef)/math-cca0d5b689e524b619b30538d3432266.png?v=0" title="Y_i, Y_j" alt="Y_i, Y_j" class="tex"/> given controlling variables <b>X</b>, <b>n</b> is the minimum number of observations in the pairs of <img src="../images/Algorithm_(pcorrcoef)/math-9f58a707e9db8318aac1bb009020990d.png?v=0" title="(Y_i, Y_j), (Y_i, X), (Y_j, X)" alt="(Y_i, Y_j), (Y_i, X), (Y_j, X)" class="tex"/> and pairs in <b>X</b>.
</p><p>t Statistic is:
</p>
<div class="center"><img src="../images/Algorithm_(pcorrcoef)/math-14450f33ce8531f5a46e17c259af12b7.png?v=0" title="&#10;t = |r| \sqrt{ \frac {df} {1-r^2} }&#10;" alt="&#10;t = |r| \sqrt{ \frac {df} {1-r^2} }&#10;" class="tex"/></div>
<p>where <b>r</b> is the partial correlation coefficient.
</p><p>The two-tailed significance level <img src="../images/Algorithm_(pcorrcoef)/math-550e9bcd0b294b7167dd9b8a1472af23.png?v=0" title="\text{Prob}&gt;|t|" alt="\text{Prob}&gt;|t|" class="tex"/> can be calculated as:
</p>
<div class="center"><img src="../images/Algorithm_(pcorrcoef)/math-704674c897463ad5d94a0842cbdadd58.png?v=0" title="&#10;2(1 - \text{tcdf}(t, df)).&#10;" alt="&#10;2(1 - \text{tcdf}(t, df)).&#10;" class="tex"/></div>
<h2><a name="References"></a><span class="mw-headline">References</span></h2>
<ol><li> Morrison, D. F. (1976), <i>Multivariate Statistical Methods</i>, Second Edition, New York: McGraw-Hill.</li>
<li> <a class="external text" href="http://www.originlab.com/pdfs/nagcl09/manual/pdf/g02/g02byc.pdf" target="_blank">nag_partial_corr (g02byc)</a></li></ol>






