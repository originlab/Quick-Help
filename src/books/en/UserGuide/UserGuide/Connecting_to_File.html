<h1 class="firstHeading">6.5.1 Connecting to File</h1><p class='urlname' style='display: none'>Connect-to-File</p>
<p>Data Connectors build connections between an Origin worksheet/matrix and a data file on your PC or local network. Many common file types are supported. 
</p><p>For a summary of key differences between Connectors and older import methods, see <a class="external text" href="../../QuickHelp/QuickHelp/Data_Connector_Difference_Import_From_File.html"><b>FAQ-1020 Is there a difference between Connect and Import?</b></a>.
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Connecting_to_File/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p><font color="blue">'<b>To add new plot types by Add New menu, </b></font>
</p><p>Connectors for additional file types can be added by choosing the <b>Add New...</b> menu item at the bottom of the <b>Data: Connect to File</b> menu. This opens the App Center to show only uninstalled Connectors. Click the <b>Download and Install</b> icon to install the Connector App on your PC.
</p><p>Alternately, go to the <a class="external text" href="https://www.originlab.com/Fileexchange/index.aspx?t=App&amp;c=000001&amp;v2=NULL&amp;o=UpdateOnDESC" target="_blank">Origin File Exchange</a> on the OriginLab website and select a Connector from the list. On the App page, click the <b>Download File</b> button and when the download completes, drag the file to the Origin workspace. For App documentation, see the App page's <b>Description</b> section.
</p><p><font color="blue"><b>To customize Connect to File menu, </b></font>
</p><p>You are allowed to customize the <b>Data&#160;: Connect to File</b> menu by selecting <b>Data&#160;: Connect to File&#160;: Customize...</b><br />
<p><a  class="image"><img alt="Menu Customization.png" src="../images/Connecting_to_File/Menu_Customization.png?v=91576" width="286"  /></a>
</p>
</p><p>All installed data connectors will listed here, you can use the check boxes to decide which ones of them will show under the <b>Data&#160;: Connect to File</b> menu.
</p></td></tr></table>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Adding_a_Connector_to_the_Book"><span class="tocnumber">1</span> <span class="toctext">Adding a Connector to the Book</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Text.2FCSV_Connector"><span class="tocnumber">2</span> <span class="toctext">Text/CSV Connector</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Extract_variable_from_data_cells"><span class="tocnumber">2.1</span> <span class="toctext">Extract variable from data cells</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Data_Block_Markers"><span class="tocnumber">2.2</span> <span class="toctext">Data Block Markers</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Customize_File_Extensions"><span class="tocnumber">2.3</span> <span class="toctext">Customize File Extensions</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Excel"><span class="tocnumber">3</span> <span class="toctext">Excel</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#JSON.2FXML"><span class="tocnumber">4</span> <span class="toctext">JSON/XML</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#MATLAB"><span class="tocnumber">5</span> <span class="toctext">MATLAB</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#HDF"><span class="tocnumber">6</span> <span class="toctext">HDF</span></a>
<ul>
<li class="toclevel-2 tocsection-10"><a href="#Tips_for_HDF_Import"><span class="tocnumber">6.1</span> <span class="toctext">Tips for HDF Import</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-11"><a href="#TDMS"><span class="tocnumber">7</span> <span class="toctext">TDMS</span></a></li>
<li class="toclevel-1 tocsection-12"><a href="#N42"><span class="tocnumber">8</span> <span class="toctext">N42</span></a></li>
<li class="toclevel-1 tocsection-13"><a href="#NetCDF"><span class="tocnumber">9</span> <span class="toctext">NetCDF</span></a></li>
<li class="toclevel-1 tocsection-14"><a href="#Shapefile"><span class="tocnumber">10</span> <span class="toctext">Shapefile</span></a></li>
<li class="toclevel-1 tocsection-15"><a href="#Origin_File"><span class="tocnumber">11</span> <span class="toctext">Origin File</span></a></li>
<li class="toclevel-1 tocsection-16"><a href="#HTML_Table"><span class="tocnumber">12</span> <span class="toctext">HTML Table</span></a></li>
<li class="toclevel-1 tocsection-17"><a href="#Connect_Multiple_Files"><span class="tocnumber">13</span> <span class="toctext">Connect Multiple Files</span></a></li>
<li class="toclevel-1 tocsection-18"><a href="#Import_a_File_with_Filter"><span class="tocnumber">14</span> <span class="toctext">Import a File with Filter</span></a></li>
<li class="toclevel-1 tocsection-19"><a href="#Clone_Import"><span class="tocnumber">15</span> <span class="toctext">Clone Import</span></a></li>
<li class="toclevel-1 tocsection-20"><a href="#Connect_Files_by_Appending_Rows_to_Current_Sheet"><span class="tocnumber">16</span> <span class="toctext">Connect Files by Appending Rows to Current Sheet</span></a></li>
</ul>
</div>

<h2><a name="Adding_a_Connector_to_the_Book"></a><span class="mw-headline">Adding a Connector to the Book</span></h2>
<p>To add a Data Connector to the book and import data:
</p>
<ol><li> With a worksheet/matrix active, choose <b>Data: Connect to File: <i>Data Type</i></b>. </li>
<li> Select the desired data file from the <b>Open</b> dialog box.</li></ol>
<p><br />
This opens a Connector-specific dialog box where you can configure your import options. 
</p>
<dl><dd><ul><li> For multi-page files such as MS Excel or MATLAB, you will choose an initial sheet to import (e.g. <b>Excel Sheet</b>). Upon import, a collapsible <a href="../../UserGuide/UserGuide/Data_Navigator.html" title="UserGuide:Data Navigator"><b>Data Navigator</b></a> panel is added to the book giving you access to the files remaining sheets.</li>
<li> The name of the connected file is added as the book <a href="../../UserGuide/UserGuide/Origin_Child_Window_Naming_Conventions.html" title="UserGuide:Origin Child Window Naming Conventions"><b>Long Name</b></a> (does not apply to CSV or Origin files).</li></ul>
<dl><dd><a  class="image"><img alt="DC Rename book on import.png" src="../images/Connecting_to_File/DC_Rename_book_on_import.png?v=86108" width="568"  /></a></dd></dl>
<ul><li> When connecting matrixbooks to files, <a href="../../UserGuide/UserGuide/Viewing_and_Profiling_Matrix_Data.html" title="UserGuide:Viewing and Profiling Matrix Data"><b>Image Mode</b> and <b>Image Thumbnails/Slider</b></a> are automatically enabled when the number of imported matrices exceeds the value of system variable <a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#M"><b>@MSS</b></a> (default = 10). Does not apply to Origin files. For information on changing the value of a system variable, see <a class="external text" href="../../QuickHelp/QuickHelp/How_do_I_permanently_change_the_value_of_a_system_variable.html">this FAQ</a>.</li></ul></dd></dl>
<h2><a name="Text.2FCSV_Connector"></a><span class="mw-headline">Text/CSV Connector</span></h2>
<p>Use the Text/CSV Connector to import text files such as CSV, TXT, and ASC.
</p>
<ul>
<li> Auto determine <b>Main header lines</b> or clear the check box and specify the main header and the sub-header, including column Long Name, Units and Comments, manually. <b>Hint</b>: a blue hint will show the number of auto-detected Main header lines.</li> 
<li> When main header lines are detected or manually specified, the import dialog shows a <b>Save file header to</b> drop-down list with options to save the file header to the <a href="../../UserGuide/UserGuide/Displaying_Supporting_Data_in_Worksheet_Header_Rows.html" title="UserGuide:Displaying Supporting Data in Worksheet Header Rows"><b>Worksheet label area</b></a> or the <a href="../../UserGuide/UserGuide/The_Workbook_Organizer.html" title="UserGuide:The Workbook Organizer"><b>Book organizer</b></a>.
<table class="simple">
<tr>
<th> CSV Import Options
</th>
<th> CSV Import Options, Main Header Lines
</th></tr>
<tr>
<td align="center"><a  class="image"><img alt="Csv import option dlg.png" src="../images/Connecting_to_File/Csv_import_option_dlg.png?v=89134" width="372"  /></a>
</td>
<td align="center"><a  class="image"><img alt="Csv import option dlg-Organizer.png" src="../images/Connecting_to_File/Csv_import_option_dlg-Organizer.png?v=89135" width="376"  /></a>
</td></tr></table>
</li>
<li> If the imported file (some *.pil files for example) has separator line to split header and data part, something like "&gt;END OF HEADER", uncheck <b>Auto</b> next to <b>Main header lines</b>, enter 0 for <b>Main header lines</b>, check <b>Main header ends with</b> checkbox and enter the defined separator text in the combo box.
<a  class="image"><img alt="CSV end of header lines.png" src="../images/Connecting_to_File/CSV_end_of_header_lines.png?v=89661" width="569"  /></a></li>
<li> You can opt to <b>Import first 50 lines as preview</b> <i>or</i> for <a href="../../UserGuide/Category/Partial_Importing_and_Re_Importing.html#Partial_Import" title="Category:Partial Importing and Re Importing">partial import</a>.</li>
<li> Click the <b>Other Options</b> button (to the left of <b>OK</b>) for more options: 
<ul><li> <b>Add Sparklines</b>: Enable <a class="external text" href="../../QuickHelp/QuickHelp/What_is_a_Sparkline_and_how_do_I_customize_it.html">sparklines</a> on import. To disable sparklines on import, set <a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#H.2CI.2CJ.2CK"><b>@IMPS</b> = <i>0</i></a>.</li>
<li> <b>Rename using File Name</b>: CSV only. Options for <b>Sheet</b> and <b>Book Long Name</b>.</li>
<li> <b>Set as Default</b>: CSV only: Button for setting <b>Sparklines</b> and <b>Rename using File Name</b> settings as default.</li>
<li> <b>Post Import LabTalk Script</b>: Run script for post-processing of data on import.</li></ul>
<dl><dd><a  class="image"><img alt="CSV post import lt scripts.png" src="../images/Connecting_to_File/CSV_post_import_lt_scripts.png?v=93512" width="556"  /></a></dd></dl>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Connecting_to_File/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p><b>Post Import LabTalk Script</b> can be used to extract variable from data cells ()rather than header rows. See an example in the <a href="#Extract_variable_from_data_cells">next section</a>. 
</p></td></tr></table>
</li>
<li> You can sort the whole worksheet by a selected column (right-click and select <b>Sort Worksheet</b>) after importing data by <b>CSV Data Connector</b>.
<li> If you want to import multiple CSV files in to the same worksheet and append them by rows, you can use LabTalk scripts to do it. Please refer to "EX2" on <a class="external text" href="../../LabTalk/Category/Wks.DC_(object).html#Examples">this LabTalk document page</a>.
</ul>
<h3><a name="Extract_variable_from_data_cells"></a><span class="mw-headline">Extract variable from data cells</span></h3>
<p>To extract information from a data cell and store it in a worksheet variable, you can use <b>Post Import LabTalk Script</b> dialog.
</p><p>In the following example, the first column contains the experiment date and we want to extract it to an user-defined variable. We can run the below <b>post import LabTalk scripts</b> to add a string variable "MDate" in the sheet level and assign the first cell value to it.
</p>
<pre class="lt" style="font-family:monospace;">page.<span style="color: #000080;">info</span>.<span style="color: #000080;">add</span><span style="color: #000000;">&#40;</span>user<span style="color: #000000;">&#41;</span>;
page.<span style="color: #000080;">info</span>.<span style="color: #000080;">user</span>.<span style="color: #000080;">addsection</span><span style="color: #000000;">&#40;</span>variables<span style="color: #000000;">&#41;</span>;
string str1<span style="color: #000080;">=</span>left<span style="color: #000000;">&#40;</span>col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span>, <span style="color: #0000dd;">10</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">$</span>;
page.<span style="color: #000080;">info</span>.<span style="color: #000080;">user</span>.<span style="color: #000080;">variables</span>.<span style="color: #000080;">addstring</span><span style="color: #000000;">&#40;</span>MDate, <span style="color: #ff00ff;">&quot;%(str1$)&quot;</span><span style="color: #000000;">&#41;</span>;
del col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span>;</pre> 
<p>After import, you can check this variable, "MDate" in the Workbook Organizer.
</p>
<dl><dd><a  class="image"><img alt="Extract variable from data cells via Post Import LT Script.png" src="../images/Connecting_to_File/Extract_variable_from_data_cells_via_Post_Import_LT_Script.png?v=95427" width="651"  /></a></dd></dl>
<h3><a name="Data_Block_Markers"></a><span class="mw-headline">Data Block Markers</span></h3>
<p>If your file is a mix of data and non-data, you can define those characters which delineate data blocks:
</p>
<ul><li> Use the <b>Start</b> box to define the sequence of characters which mark the start of your data. If that sequence of characters uses section notation (i.e. is enclosed in square brackets as in <i>[Data]</i>), then <b>End</b> should be left blank. </li>
<li> When using section notation, make sure <b>Main header lines</b> = <i>Auto</i>. </li>
<li> Support for asterisk ("*") wildcard (e.g. "-*" will look for dash string of any length).</li>
<li> When a blank line marks the end of the data block, you can specify <b>End</b> = <i>&lt;blank&gt;</i>.</li></ul>
<p><a  class="image"><img alt="OriginHelp Data Block Marker.png" src="../images/Connecting_to_File/900px-OriginHelp_Data_Block_Marker.png?v=84242" width="900"   /></a>
</p>
<h3><a name="Customize_File_Extensions"></a><span class="mw-headline">Customize File Extensions</span></h3>
<p>You can customize the file extension settings in the CSV Connetor, which will show in the <b>File Type</b> drop-down list on the file browser when you open the connector.
</p><p>To customize file extensions:
</p>
<ol><li>Activate Connectors tab of App Gellary docked at the right side of Origin workspace. </li>
<li>Right click on the CSV Connector icon and select <b>Customize File Extensions</b>.</li></ol>
<p><a  class="image"><img alt="CSV Data Connector Customize File Extensions.png" src="../images/Connecting_to_File/CSV_Data_Connector_Customize_File_Extensions.png?v=94125" width="657"  /></a>
</p>
<ol>
<li>Extensions are separated by <i>";"</i>.
<li>Click <b>Reset</b> button to reset to the system default file extension settings.
<li>You can also edit the file extension in <i>Origin.ini</i> file.
<ul>
<li>Select <b>Help: Open Folder: User Files Folder</b>. In the User Files folder that opens, find the <i>Origin.ini</i> file.
<li>Open <i>Origin.ini</i> file in a text editor, Notepad for example. Locate the <b>[DCFileGroup]</b> section. Add your customized file extension settings (with connector name as key) below this section. <br />For example, following will change default file extension of CSV Data Connector to "All File (*.*)".
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">&#91;</span>DCFileGroup<span style="color: #000000;">&#93;</span>
CSV Connector<span style="color: #000080;">=</span><span style="color: #000080;">*</span>.<span style="color: #000080;">*</span></pre>
</ul>
</ol>
<h2><a name="Excel"></a><span class="mw-headline">Excel</span></h2>
<p>For information on the Excel Connector, see <a href="../../UserGuide/UserGuide/Importing_from_Excel.html" title="UserGuide:Importing from Excel">Importing from Excel</a>.
</p>
<h2><a name="JSON.2FXML"></a><span class="mw-headline">JSON/XML</span></h2>
<p>The <b>Data Connector Browser</b> dialog will open.
</p><p><a  class="image"><img alt="JSON DC dialog.png" src="../images/Connecting_to_File/JSON_DC_dialog.png?v=84434" width="394"  /></a>
</p><p>The upper panel loads the structure of the imported file. 
</p>
<ol><li> Click on one branch to view the meta data in the right panel. </li>
<li> Choose the desired branch and click the down arrow to add it to the lower panel. </li>
<li> Click <b>OK</b> button to connect and import selected data.</li>
<li> If your file contains multiple arrays, variables, etc., use <a href="../../UserGuide/UserGuide/Data_Navigator.html" title="UserGuide:Data Navigator">the <b>Data Navigator</b></a> to connect to additional data, as needed.</li></ol>
<p><br />
<i><b>Tips...</b></i> 
</p>
<ul><li> When connecting to <b>MATLAB</b>, <b>JSON</b> and <b>NetCDF</b> files -- either local files or <a href="../../UserGuide/UserGuide/Connecting_to_Web.html" title="UserGuide:Connecting to Web">web files</a> -- <a class="external text" href="../../QuickHelp/QuickHelp/Add_Worksheet_Comment_and_Name.html">custom sheet names</a> will be kept when reconnecting to your data file (<b>Import</b> or <b>Import All Books</b> from the Data Connector menu <a  class="image"><img alt="Dadta connector icon connect.png" src="../images/Connecting_to_File/Dadta_connector_icon_connect.png?v=87163" width="16"  /></a>). This applies only to file types that use a tree framework and does NOT apply to other file types such as Excel or Text/CSV.</li>
<li> The metadata from imported JSON/XML/Preship XML file will be stored in <a href="../../UserGuide/UserGuide/The_Workbook_Organizer.html" title="UserGuide:The Workbook Organizer">Workbook Organizer</a>. To view metadata, click <b>&#709;</b> button at the left-bottom area of worksheet to turn on Organizer panel. To insert metadata to worksheet label rows, right click the desired tree node in Organizer and select <b>Copy Node Path</b>, and then go to the column label cell, right click and select <b>Paste Link</b>.</li></ul>
<h2><a name="MATLAB"></a><span class="mw-headline">MATLAB</span></h2>
<p>The <b>Data Connector Browser</b> dialog will open.
</p><p><a  class="image"><img alt="MATLAB DC dialog.png" src="../images/Connecting_to_File/MATLAB_DC_dialog.png?v=93936" width="493"  /></a>
</p><p>The upper panel lists all variables in the import file as a tree. There is a column on the right of each variable to indicate where each variable can be imported. Options include Worksheet, Matrix sheet or both.
</p>
<ol><li> Choose the desired branch and click the down arrow to add it to the lower panel. </li>
<li> If a workbook is active and the file must be imported to matrix, a dialog will popup for you to choose
<dl><dd><a  class="image"><img alt="NetCDF rmatrix.png" src="../images/Connecting_to_File/NetCDF_rmatrix.png?v=93619" width="276"  /></a>
<ul><li><b>Use a new Matrixbook</b> - this is the most straightforward way.</li>
<li><b>Use an embedded Matrixbook</b> - this will import data into matrix but the matrix is embedded as a sheet in workbook.</li>
<li><b>Worksheet Columns (can be slow)</b> -- this will import each time frame of matrix into multiple columns so it can create a worksheet with many many columns and cause slowness if data is big.</li></ul></dd></dl></li>
<li> Choose desired option and click <b>OK</b> to import the data.</li>
<li> If your file contains multiple arrays, variables, etc., use <a href="../../UserGuide/UserGuide/Data_Navigator.html" title="UserGuide:Data Navigator">the <b>Data Navigator</b></a> to connect to additional data, as needed.</li></ol>
<h2><a name="HDF"></a><span class="mw-headline">HDF</span></h2>
<p>The HDF Connector can be used to import HDF5 (.h5, .he5, .hdf5) or MATLAB's version 7.3 mat files stored locally or on <a href="../../UserGuide/UserGuide/Connecting_to_Web.html" title="UserGuide:Connecting to Web">the web</a>. For more information, see <a class="external text" href="https://www.originlab.com/FileExchange/details.aspx?fid=535" target="_blank">this OriginLab File Exchange page</a>.
</p><p>Note that when you initiate a connection to a file, the <b>Data Connector Browser</b> opens, listing all variables in the file as a tree. There is a column on the right of each variable to indicate where each variable can be imported. Options include <b>Worksheet</b>, <b>Matrix</b> sheet or <i>both</i>, as shown in the following diagram.
</p>
<dl><dd><a  class="image"><img alt="Data Connector Browser H5.png" src="../images/Connecting_to_File/Data_Connector_Browser_H5.png?v=87312" width="727"  /></a></dd></dl>
<p>You can connect directly to any node in the file. If a worksheet is active and the variable is marked with <b>Matrix</b>, you will be prompted to import the node to a matrixbook. However, you can opt to import the matrix data into a workbook and Origin will automatically <a href="../../UserGuide/UserGuide/Adding_Existing_Graphs_Matrixs_as_Sheets.html" title="UserGuide:Adding Existing Graphs Matrixs as Sheets">add the node as a matrixsheet in the active workbook</a>.
</p><p>If you connect to the root of the file, the <a href="../../UserGuide/UserGuide/Data_Navigator.html" title="UserGuide:Data Navigator"><b>Data Navigator</b></a> opens, allowing you to selectively connect to individual nodes. As mentioned, if the data are compatible with the active sheet, they are imported into the sheet. If another sheet type is needed, it is added to the active book.
</p>
<dl><dd><a  class="image"><img alt="Data Navigator Add Matrixsheet.png" src="../images/Connecting_to_File/Data_Navigator_Add_Matrixsheet.png?v=87315" width="664"  /></a></dd></dl>
<h3><a name="Tips_for_HDF_Import"></a><span class="mw-headline">Tips for HDF Import</span></h3>
<ul><li> As with other complexly-structured files (incl. NetCDF), there is a <b>Navigator</b> panel shortcut menu. The HDF Connector has one unique entry -- <b>Copy Path</b> -- that may interest those who are scripting data import. As copying a path deep within a complex tree structure is difficult, you can click on the entry and <b>Copy Path</b>.</li></ul>
<dl><dd><a  class="image"><img alt="OH HDF5 shortcut menu copy path.png" src="../images/Connecting_to_File/OH_HDF5_shortcut_menu_copy_path.png?v=92554" width="494"  /></a></dd></dl>
<ul><li> When scripting import with HDF Connector, you can significantly speed up the data import by not showing the <b>Navigator</b> panel. This you can do by adding an argument ("1") when adding the Connector.</li></ul>
<pre class="lt" style="font-family:monospace;">wbk.<span style="color: #000080;">dc</span>.<span style="color: #000080;">add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;HDF&quot;</span>, <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;</pre>
<h2><a name="TDMS"></a><span class="mw-headline">TDMS</span></h2>
<p>Origin's <b>TDMS Connector</b> can be used to import data from .tdm and .tdms files. 
</p><p><br />
<i><b>To import a TDMS file:</b></i>
</p>
<ol><li> Open a new workbook and choose <b>Data: Connect to File: TDMS</b>. Choose a file and click <b>Open</b>.</li>
<li> In the <b>Data Connector Browser</b>, double-click on a node; or select it in the Browser and click the <b>Select data to import</b> button. The node is added to the bottom panel. Note that you can modify the connection string to do a <a href="../../UserGuide/Category/Partial_Importing_and_Re_Importing.html#Partial_Import_by_TDMS_Connector" title="Category:Partial Importing and Re Importing">partial import</a>.</li>
<li> Click <b>OK</b> to import data. </li></ol>
<p>If you have opted to import all nodes (by selecting <i>TDMS</i> at the top of the Browser), each channel will be imported into a separate sheet named as the channel. Metadata will be added to each column (<b>Long Name</b>, <b>Units</b>, etc., including into a user-parameter row labeled as <i>node_source_attributes</i>). Sheets are named as the channel and the file name is added as book <b>Long Name</b>. If you opt to <b>Import All Groups to Same Worksheet</b>, attributes are saved to the <a href="../../UserGuide/UserGuide/Displaying_Supporting_Data_in_Worksheet_Header_Rows.html" title="UserGuide:Displaying Supporting Data in Worksheet Header Rows">column label row</a> area but the sheet name is not changed.
</p><p><br />
<i><b>Possible topics of interest:</b></i>
</p>
<ul><li> <a href="../../UserGuide/Category/Partial_Importing_and_Re_Importing.html#Partial_Import_by_TDMS_Connector" title="Category:Partial Importing and Re Importing">Partial Import</a></li>
<li> <a class="external text" href="../../LabTalk/LabTalk/Column_Label_Row_Characters.html">LabTalk Access to Column Label Row Data</a></li></ul>
<h2><a name="N42"></a><span class="mw-headline">N42</span></h2>
<p>Origin's <b>N42 Connector</b> is used to import data generated by various radiation instruments.
</p><p><br />
<i><b>To import an N42 file:</b></i>
</p>
<ol><li> Open a new workbook and choose <b>Data: Connect to File: N42</b>. Choose a file and click <b>Open</b>.</li></ol>
<h2><a name="NetCDF"></a><span class="mw-headline">NetCDF</span></h2>
<p>The NetCDF file is a self-describing, scalable format for storing arrays of variables. Designed as a flexible format for exchange of scientific data, it is readily adaptable to geographic studies and is widely used in atmospheric and climate science. Starting with version <b>2021b</b>, Origin's NetCDF Connector has been improved to handle the kinds of datasets used in geographic-based studies. 
</p>
<dl><dd><a  class="image"><img alt="Help connect netCDF import ch 1.png" src="../images/Connecting_to_File/Help_connect_netCDF_import_ch_1.png?v=89087" width="800"  /></a></dd></dl>
<p>In addition to such things as <a href="../../UserGuide/Category/Partial_Importing_and_Re_Importing.html#Partial_Import_by_NetCDF_Connector" title="Category:Partial Importing and Re Importing">partial import</a> (specify a date range, read/skip or averaging), longitude conversion, flipping latitude and specifying a sub-region by lat and lon, and an option to transform matrix values on import, the user will find these tools helpful:
</p>
<ul><li> Import to Origin matrixsheet with option to <a class="external text" href="../../GettingStarted/OriginLab/Matrix_Book_Matrix_Sheet_Matrix_Objects.html#Image_Thumbnails_and_Image_Slider">view object <b>thumbnails</b> or scroll objects with <b>slider</b></a>.</li>
<li> <a href="../../UserGuide/UserGuide/Data_Navigator.html" title="UserGuide:Data Navigator"><b>Data Navigator</b></a> panel for imported matrix, with access to file metadata.</li>
<li> Tools for analyzing and manipulating matrix data: <a class="external text" href="../../GettingStarted/OriginLab/Matrix_Book_Matrix_Sheet_Matrix_Objects.html#Manipulation_of_Matrix_Data"><b>pixel extraction</b>, <b>linear fit</b>, <b>descriptive statistics</b>, <b>subtraction</b>, <b>transpose</b>, etc.</a></li>
<li> Tools for extracting sub-regions from the matrix: <a class="external text" href="../../GettingStarted/OriginLab/Matrix_Book_Matrix_Sheet_Matrix_Objects.html#Manipulation_of_Matrix_Data"><b>pixel extraction</b>, <b>extract as xyz</b>, <b>crop</b>, <b>export region-of-interest</b>, etc.</a></li>
<li> <a class="external text" href="../../UserGuide/UserGuide/Image_Plot.html"><b>Image Plots</b></a> using standard or custom color palettes. Palettes can now be added to Origin by <a class="external text" href="../../QuickHelp/QuickHelp/Can_I_use_external_color_palette_files_to_apply_color_to_contour_plots_and_other.html">drag-and-drop</a>.</li></ul>
<dl><dd><a  class="image"><img alt="Help connect netCDF import ch 2.png" src="../images/Connecting_to_File/Help_connect_netCDF_import_ch_2.png?v=87701" width="796"  /></a></dd></dl>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Connecting_to_File/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>When working with map data, activate an Image Plot, click the <b>Insert</b> menu and insert map boundaries for Continental USA or World.
</p></td></tr></table>
<p><br />
<i><b>To import a local .nc file:</b></i>
</p>
<ol><li> With a workbook or matrixbook active, choose <b>Data: Connect to File</b>. </li>
<li> Continue with <i><b>Data Connector Browser</b></i>, below.</li></ol>
<p><br />
<i><b>To import web-stored .nc data by specifying a URL:</b></i>
</p>
<ol><li> With a workbook or matrixbook active, choose <b>Data: Connect to Web</b>.</li>
<li> In the dialog that opens, set <b>File Type</b> to <i>NetCDF</i> (optional) and either (a) click on <b>Recent URLs</b> and choose a .nc file from the list or (b) directly enter a <b>URL</b> in the text box (e.g. <i>https://psl.noaa.gov/thredds/fileServer/Datasets/cpc_us_precip/precip.V1.0.1948.nc</i>), then click <b>OK</b>.</li>
<li> Continue with <i><b>Data Connector Browser</b></i>, below.</li></ol>
<p><br />
<i><b>Data Connector Browser:</b></i>
</p>
<ol><li> Select the multi-dimensional variable (e.g. <i>time * lat * lon</i>) that you want to import and click the <b>Select data to import</b> button, adding the data to the bottom panel. If a workbook is active and the file requires a matrixbook, you will be asked if you want to (a) open a new matrixbook, (b) embed a matrixbook in the active workbook, or (c) import data to worksheet columns. Typically, single-dimensional variables should be imported into workbooks while multi-dimensional variables should imported into matrixbooks.</li>
<li> Click the <b>Import Options</b> button (the "pencil" icon) and choose your options. Here, you can specify a partial import, convert longitude or flip your matrix vertically, or transform data using a formula.
<dl><dd><a  class="image"><img alt="OH netcdf import options.png" src="../images/Connecting_to_File/OH_netcdf_import_options.png?v=87690" width="779"  /></a></dd></dl></li>
<li> Click <b>OK</b> to close Import Options and click <b>OK</b> again to close the Browser and import your data. Large files may take some time to import. When the file is imported a Browser panel is added to the left side of the matrix. Note the slider at the top of the matrix window for viewing individual matrix objects.</li></ol>
<dl><dd><dl><dd><a  class="image"><img alt="OH matrix slider after import.png" src="../images/Connecting_to_File/OH_matrix_slider_after_import.png?v=87694" width="799"  /></a></dd></dl></dd></dl>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Connecting_to_File/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>Once a file is imported, you can make changes to <b>Import Options</b> by clicking the <b>Connector</b> icon and choosing <b>Options</b>.
</p>
<dl><dd><dl><dd><a  class="image"><img alt="Help connect netCDF import ch 3.png" src="../images/Connecting_to_File/Help_connect_netCDF_import_ch_3.png?v=87711" width="465"  /></a></dd></dl></dd></dl>
</td></tr></table>
<h2><a name="Shapefile"></a><span class="mw-headline">Shapefile</span></h2>
<ul><li> To connect to a local file, select <b>Data: Connect to File: Shapefile</b>. To connect to web data, select <b>Data: Connect to Web</b> and enter the URL. </li>
<li> Shapefile Connector will open a simple <b>Import Options</b> dialog. You can select the <b>Load Attributes</b> checkbox to import the columnar attributes for each shape. Columnar attributes is a .dbf file having the same name of the .shp file and saved in the same folder. <b>Convert to WGS84</b> check box converts shapefiles with distances in meters, to the WGS system with longitude and latitude.</li></ul>
<dl><dd><a  class="image"><img alt="UG shapeifle options wgs84.png" src="../images/Connecting_to_File/UG_shapeifle_options_wgs84.png?v=93514" width="278"  /></a></dd></dl>
<ul><li> After import, you will see at least 3 columns in the worksheet: <i>X</i>, <i>Y</i> and <i>Feature ID</i>. <i>X</i> and <i>Y</i> coordinates are separated by missing values to represent different segments. Multiple segments may share one <i>Feature ID</i>. </li></ul>
<p>For more information, see <a class="external text" href="https://www.originlab.com/fileExchange/details.aspx?fid=610" target="_blank"><b>Shapefile Connection</b></a> page in File Exchange.
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Connecting_to_File/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>See <a href="../../UserGuide/UserGuide/The_(Plot_Details)_Line_Tab.html#Fill_Area_Under_Curve" title="UserGuide:The (Plot Details) Line Tab"><b>Fill Area Under Curve</b> &gt; <b>Fill Shapes by Orientation</b></a>, for information on filling shapefile polygons.
</p></td></tr></table>
<h2><a name="Origin_File"></a><span class="mw-headline">Origin File</span></h2>
<p>The <b>Origin Connector</b> imports data from an Origin project (opj(u)) or workbook (ogw(u)) file. This allows you to use Origin files as a data repository. 
</p><p>When connecting to data in an Origin file -- whether it be a project file or a multi-page workbook -- the <b>Data Connector Browser</b> opens. Here, you can selectively pick the data that you want to import. Once you have added a Connector to the workbook, you can import other worksheets as needed by right-clicking on a column in the <a href="../../UserGuide/UserGuide/Data_Navigator.html" title="UserGuide:Data Navigator"><b>Data Navigator</b></a> and choosing <b>Add and Connect Sheet(s)</b>.
</p><p>Additionally, beginning with Origin 2020, the Origin Connector supports an SQL-like <a href="../../UserGuide/UserGuide/Examples_of_using_SQL_query_condition_in_Origin_Connector.html" title="UserGuide:Examples of using SQL query condition in Origin Connector"><b>query language</b></a> for searching and extracting the desired data from your Origin files. 
</p><p><a  class="image"><img alt="Project DC dialog.png" src="../images/Connecting_to_File/Project_DC_dialog.png?v=84180" width="487"  /></a>
</p>
<ol><li>In the <b>Select...</b> dialog,  click <b>Select Query</b> button <a  class="image"><img alt="Select Query button.png" src="../images/Connecting_to_File/Select_Query_button.png?v=84054" width="44"  /></a> to open <b>Select Query</b> dialog.</li>
<li>Enter query strings in the edit box to, for example, search in the entire project and pull all the columns with the specified LongName and plot designation.</li>
<li>Clicking <b>OK</b> button will add the query to the lower panel. Click <b>OK</b> again to import columns that meets the condition to a new workbook.</li>
<li> In addition to query capabilities, you can use <a href="../../UserGuide/UserGuide/Data_Navigator.html" title="UserGuide:Data Navigator">the <b>Data Navigator</b></a> to connect to additional sheets in the Origin project, as needed.</li></ol>
<h2><a name="HTML_Table"></a><span class="mw-headline">HTML Table</span></h2>
<p>The <b>Data Connector Browser</b> dialog will open. 
</p><p><a  class="image"><img alt="Json DC dialog.png" src="../images/Connecting_to_File/Json_DC_dialog.png?v=82816" width="379"  /></a>
</p><p>The upper panel loads all the tables on the web page. Choose the desired table and click the down arrow to add it to the lower panel. Click <b>OK</b> button to import.
</p>
<h2><a name="Connect_Multiple_Files"></a><span class="mw-headline">Connect Multiple Files</span></h2>
<p>Use this menu to connect to multiple files of identical file type and structure.
</p>
<ol><li> With the workbook or matrixbook active, choose <b>Data: Connect Multiple Files</b>.</li></ol>
<dl><dd><a  class="image"><img alt="DC connect multiple files files2dc.png" src="../images/Connecting_to_File/DC_connect_multiple_files_files2dc.png?v=89143" width="522"  /></a></dd></dl>
<ul><li> For CSV files, checking <b>Same Book</b> will mean that the book is named with the name of the first file. If imported to separate books, each book will be name with the file name.</li>
<li> Check the <b>Open Dialog for First File</b> box to adjust import settings before file import.</li>
<li> Use the <b>Set Column Designations</b> combo box to specify worksheet <a href="../../UserGuide/UserGuide/Set_Column_Designation.html#Column_Designation_Symbols" title="UserGuide:Set Column Designation">column designations</a> on import.</li>
<li> If you choose to import <b>Files in Specified Folder</b> and import them into <b>Same Book</b>, and turn on <b>Auto Import: On Folder Change</b>, when you add, remove, or update data file(s) in the <b>Source</b> folder later, Origin will scan the folder to reimport all data files again.<br />In this case, if you save the working project, the connection will be saved as relative path by default.</li></ul>
<dl><dd><a  class="image"><img alt="Auto Import on Folder Change Multiple Files.png" src="../images/Connecting_to_File/Auto_Import_on_Folder_Change_Multiple_Files.png?v=95710" width="882"  /></a></dd></dl>
<ul><li> If choosing <b>Data Connector</b> = <b>Import Filter</b>, see the next section.</li></ul>
<h2><a name="Import_a_File_with_Filter"></a><span class="mw-headline">Import a File with Filter</span></h2>
<p>This option lets you use Data Connectors with an <a href="../../UserGuide/UserGuide/Import_Wizard_Basics.html#Creating_and_saving_data_import_instructions_using_the_Import_Wizard" title="UserGuide:Import Wizard Basics">import filter file (*.OIF)</a> that you created with the <b>Import Wizard</b>.
</p><p><i><b>When Connecting to a Single File</b></i>:<br />
</p>
<ol><li> With a worksheet/matrix active, choose <b>Data: Connect to File: Import Filter</b>.</li>
<li> Select a desired data file from the opened browser.</li>
<li> In the <b>Select Filter</b> dialog, select the desired filter. Click <b>OK</b> to import.</li></ol>
<dl><dd><a  class="image"><img alt="Select filter dialog.png" src="../images/Connecting_to_File/Select_filter_dialog.png?v=82771" width="366"  /></a></dd></dl>
<p><br />
<i><b>When Connecting Multiple Files</b></i>:<br />
</p>
<ol><li> Choose <b>Data: Connect Multiple Files</b> or click the <b>Connect Multiple Files</b> button <a  class="image"><img alt="Button connect multiple files.png" src="../images/Connecting_to_File/Button_connect_multiple_files.png?v=87245" width="25"  /></a> on the Import toolbar.</li>
<li> Set <b>Data Connector</b> = <b>Import Filter</b>.</li>
<li> Choose files and decide whether you want them imported into the same book or separate books, then click <b>OK</b>.</li></ol>
<p>When choosing this option, there is no <b>Open Dialog</b>.... check box in the <a class="external text" href="../../XFunction/X-Function/Files2dc.html">files2dc</a> dialog box. Instead, an Import Filter dialog opens where you can browse to and select your import filter file.
</p>
<dl><dd><a  class="image"><img alt="DC connect multiple files importFilter.png" src="../images/Connecting_to_File/DC_connect_multiple_files_importFilter.png?v=87241" width="715"  /></a></dd></dl>
<p><br />
<i><b>Starting New Sheets</b></i>:
</p><p>As with the <b>Import Wizard</b>, the Import Filter Connector supports <a href="../../UserGuide/UserGuide/Import_Wizard_Data_Selection_Page_(ASCII_Binary).html#Non-Numeric_Data_in_a_Numeric_Field_Controls_.28ASCII_Only.29" title="UserGuide:Import Wizard Data Selection Page (ASCII Binary)">starting new sheets</a> when non-numeric data is encountered in a numeric field.
</p>
<table class="note">

<tr>
<td><b>Notes:</b>
<p>You can customize file extension settings of Import Filter Connector by right click on this connector icon in Apps Gellay and select <b>Customize File Extensions</b> context menu. Refer to <a href="../../UserGuide/UserGuide/Connecting_to_File.html#Customize_File_Extensions" title="UserGuide:Connecting to File">this section of CSV Connector</a> for details.
</p>
</td></tr></table>
<h2><a name="Clone_Import"></a><span class="mw-headline">Clone Import</span></h2>
<p>This is another way to connect to multiple files. However, this is much more than a simple multi-file import mechanism. The real value of "cloning" is in rapidly duplicating graphing and analysis operations carried out on a prototype file, on subsequent files of the same type and structure. Once you have a prototype, cloning is trivial:
</p>
<ol><li> Import your prototype data file using <b>Data: Connect to File</b>, then perform the desired graphing and/or analysis operations.</li>
<li> With the data-containing workbook or matrixbook active, choose <b>Data: Clone Import</b>; or click the <b>Clone Import</b> button <a  class="image"><img alt="Button clone import.png" src="../images/Connecting_to_File/Button_clone_import.png?v=87161" width="25"  /></a> on the <b>Import</b> toolbar.</li>
<li> Choose files and click <b>OK</b>.</li></ol>
<p><br />
See the tutorial <a class="external text" href="../../Tutorial/Tutorial/Importing_Multiple_Files_into_Workbooks_Cloned_from_Active_Workbook.html">"Importing Multiple Files into Workbooks Cloned from Active Workbook"</a> for more information.
</p>
<h2><a name="Connect_Files_by_Appending_Rows_to_Current_Sheet"></a><span class="mw-headline">Connect Files by Appending Rows to Current Sheet</span></h2>
<p>This method of connecting to multiple files is only supported by Text/CSV as of version 2021. Files must be appended one-by-one and will be imported by appending rows to the current worksheet.
</p>
<ol><li> Use the <b>Text/CSV</b> Connector to import a file into the worksheet. Be sure to specify a <b>Data Block Marker</b> if your file uses one.</li>
<li> With the worksheet active, open the <a class="external text" href="../../GettingStarted/OriginLab/The_Origin_Interface.html#The_Command_Window_and_Script_Window">Script Window</a> (<b>Window: Script Window</b>), type the following and press Enter:
<dl><dd><pre class="lt" style="font-family:monospace;">wks.<span style="color: #000080;">dc</span>.<span style="color: #000080;">flags</span><span style="color: #000080;">=</span><span style="color: #0000dd;">256</span></pre></dd></dl></li>
<li> Return to the active worksheet and click the green Data Connector icon <a  class="image"><img alt="Dadta connector icon connect.png" src="../images/Connecting_to_File/Dadta_connector_icon_connect.png?v=87163" width="16"  /></a>.</li>
<li> Choose <b>Data Source</b>, set <b>File Path</b> to the file you want to append and click <b>OK</b>.</li>
<li> Choose connection options including <b>Data Block Marker</b>, then click <b>OK</b> to import the file by appending data to the current worksheet as new rows.</li></ol>


