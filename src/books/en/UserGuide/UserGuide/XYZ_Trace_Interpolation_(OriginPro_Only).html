<h1 class="firstHeading">16.4 XYZ Trace Interpolation</h1><p class='urlname' style='display: none'>Math-XYZ-TraceInterp</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#To_Perform_Trace_Interpolation_on_XYZ_Data"><span class="tocnumber">1.1</span> <span class="toctext">To Perform Trace Interpolation on XYZ Data</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-3"><a href="#Dialog_Options"><span class="tocnumber">2</span> <span class="toctext">Dialog Options</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Examples"><span class="tocnumber">3</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Algorithm"><span class="tocnumber">4</span> <span class="toctext">Algorithm</span></a></li>
</ul>
</div>

<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p><a  class="image"><img alt="XYZTraceInterpolation.png" src="../images/XYZ_Trace_Interpolation_(OriginPro_Only)/400px-XYZTraceInterpolation.png?v=71146" width="400"   /></a><br /><br />
<b>XYZ Trace Interpolation</b> performs two-dimensional interpolation on data exhibiting some periodicity. Ordinary interpolation methods perform "nearest neighbor" calculations which have the potential to ignore trends in cyclic data. Trace interpolation acts on the curve based on row index number, thus preserving the sequential aspect of the data. Choose from one of three methods: <b>Linear</b>, <b>Cubic Spline</b> and <b>Cubic B-Spline</b>. 
</p>
<h5><a name="To_Perform_Trace_Interpolation_on_XYZ_Data"></a><span class="mw-headline">To Perform Trace Interpolation on XYZ Data</span></h5>
<ol><li>Select <b>Analysis: Mathematics: XYZ Trace Interpolation...</b>. This opens the <a class="external text" href="../../XFunction/X-Function/Interpxyz.html"><b>interpxyz</b></a> dialog box.</li>
<li>Specify the <b>Input</b> and desired <b>Method</b> as well as <b>Number of Points</b>.</li>
<li>Upon clicking <b>OK</b>, three new columns containing XYZ interpolated values are added on the initial data worksheet (other output options are available).</li></ol>
<h2><a name="Dialog_Options"></a><span class="mw-headline">Dialog Options</span></h2>
<table class="dialogcontroltable">

<tr>
<th><b>Recalculate</b>
</th>
<td>
<p>Controls recalculation of analysis results
</p>
<ul><li><b>None</b> </li>
<li><b>Auto</b> </li>
<li><b>Manual</b>  </li></ul>
<p>For more information, see: <a class="external text" href="../../UserGuide/UserGuide/Recalculating_Analysis_Results.html">Recalculating Analysis Results</a>
</p>
</td></tr>
<tr>
<th>Input
</th>
<td>
<p>Specifies the XYZ range to be interpolated. 
</p><p>For help with range controls, see: <a class="external text" href="../../UserGuide/UserGuide/Specifying_Your_Input_Data.html">Specifying Your Input Data</a>
</p>
</td></tr>
<tr>
<th>Method
</th>
<td>
<p>Specify the interpolation/extrapolation method. 
</p>
<ul><li><b>Linear</b>
<dl><dd>Linear interpolation is a fast method of estimating a data point by constructing a line between two neighboring data points. This method is generally less accurate than more computationally-intensive methods.</dd></dl></li>
<li><b>Cubic Spline</b>
<dl><dd>This method splits the input data into a given number of pieces, and fits each segment with a cubic polynomial. The second derivative of each cubic function is set equal to zero. With these boundary conditions met, an entire function can be constructed in a piece-wise manner.</dd></dl></li>
<li><b>Cubic B-Spline</b>
<dl><dd>This method also splits the input data into pieces. Each segment is fitted with discrete Bezier splines. </dd></dl></li></ul>
</td></tr>
<tr>
<th>Number of Points
</th>
<td>
<p>The number of interpolated points.
</p>
</td></tr>
<tr>
<th>Output
</th>
<td>
<p>Specifies the output XY data range 
</p>
</td></tr></table>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<ol><li>Import <i>Interpolation.dat</i>, which is in the <i>&lt;Origin Installation Directory&gt;\Samples\Mathematics\</i> folder.</li>
<li>Highlight Column C and set the column designation to Z. Then select <b>Analysis: Mathematics: XYZ Trace Interpolation</b> from the Origin menu to bring up the dialog.</li>
<li>Note that the <b>Input</b> branch has been filled with the proper data range. Then select the <b>Cubic Spline</b> interpolation method. 
<dl><dd><a  class="image"><img alt="Interpxyz example dialog.png" src="../images/XYZ_Trace_Interpolation_(OriginPro_Only)/Interpxyz_example_dialog.png?v=43621" width="337"  /></a> </dd></dl></li>
<li>Click <b>OK</b> to perform the interpolation.</li></ol>
<h2><a name="Algorithm"></a><span class="mw-headline">Algorithm</span></h2>
<p>In general, between two adjacent data points, the data points will be interpolated so that the number of data points in the final result data set will be equal to the <b>Number of Points</b> variable.
</p><p>The detailed algorithm is described below:
</p><p>Given a sequence of distinct triplets of data (<i><img src="../images/XYZ_Trace_Interpolation_(OriginPro_Only)/math-0a645fc515fe6128f91758f996ebe307.png?v=0" title="x_i\," alt="x_i\," class="tex"/></i>, <i><img src="../images/XYZ_Trace_Interpolation_(OriginPro_Only)/math-b19930487b77bb2b470dafd74c4e60fa.png?v=0" title="y_i\," alt="y_i\," class="tex"/></i>,<i><img src="../images/XYZ_Trace_Interpolation_(OriginPro_Only)/math-35664ab219b2826ca92e3df62da5b341.png?v=0" title="z_i\," alt="z_i\," class="tex"/></i>), where <i>i</i> = 0, 1, ... <i>n</i>-1: 
</p><p>For <img src="../images/XYZ_Trace_Interpolation_(OriginPro_Only)/math-a50bf741606f2c85fb3829b5f18a3196.png?v=0" title="x_i&lt;x&lt;x_{i+1},x=x_i+\frac j{npts}\left( x_{i+1}-x_i\right)" alt="x_i&lt;x&lt;x_{i+1},x=x_i+\frac j{npts}\left( x_{i+1}-x_i\right)" class="tex"/>,
</p><p>For <img src="../images/XYZ_Trace_Interpolation_(OriginPro_Only)/math-02fa42913b4fdf4c28452e69ae4fb6ba.png?v=0" title="y_i&lt;y&lt;y_{i+1},y=y_i+\frac j{npts}\left( y_{i+1}-y_i\right)" alt="y_i&lt;y&lt;y_{i+1},y=y_i+\frac j{npts}\left( y_{i+1}-y_i\right)" class="tex"/>,
</p><p>For <img src="../images/XYZ_Trace_Interpolation_(OriginPro_Only)/math-acf2ac4544594daccad6f286d3999502.png?v=0" title="z_i&lt;z&lt;z_{i+1},z=z_i+\frac j{npts}\left( z_{i+1}-z_i\right)" alt="z_i&lt;z&lt;z_{i+1},z=z_i+\frac j{npts}\left( z_{i+1}-z_i\right)" class="tex"/>,
</p><p>where  <i>j</i>=1,2,3...(<i>npts-1</i>), and <i>npts</i> is the value of <b>Number of Points</b>.
</p>





