<h1 class="firstHeading">19.1.10.9 Peak Analyzer, Find Peaks Page</h1><p class='urlname' style='display: none'>PeakAnalyzer-FindPeaks</p>
<p>This page is available <a href="../../UserGuide/UserGuide/Peak_Analyzer,_Start_Page.html#Goal_Page_Controls" title="UserGuide:Peak Analyzer, Start Page">when <b>Goal</b> = <b>Integrate Peaks</b>, <b>Find Peaks</b> or <b>Fit Peaks(Pro)</b></a>. 
</p>
<dl><dd><a  class="image"><img alt="PA FindPeaks Page.png" src="../images/Peak_Analyzer,_Find_Peaks_Page/700px-PA_FindPeaks_Page.png?v=82337" width="700"   /></a>
<ul><li><i>Menu Command:</i> <b>Analysis</b>: <b>Peaks and Baseline</b>: <b>Peak Analyzer</b>: <b>Open Dialog</b></li>
<li><i>Window Types</i>: Workbook, Graph</li></ul></dd></dl>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Dialog_Theme"><span class="tocnumber">1</span> <span class="toctext">Dialog Theme</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Find_Peaks_Controls"><span class="tocnumber">2</span> <span class="toctext">Find Peaks Controls</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#The_Peak_Finding_Settings_Group"><span class="tocnumber">2.1</span> <span class="toctext">The Peak Finding Settings Group</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#The_Peak_Filtering_Group"><span class="tocnumber">2.2</span> <span class="toctext">The Peak Filtering Group</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#The_Labels_and_Markers_Group"><span class="tocnumber">2.3</span> <span class="toctext">The Labels and Markers Group</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#The_Output_Baseline_Subtracted_Peaks_check_box"><span class="tocnumber">2.4</span> <span class="toctext">The Output Baseline Subtracted Peaks check box</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#The_Peak_Fitting_Bounds_Group"><span class="tocnumber">2.5</span> <span class="toctext">The Peak Fitting Bounds Group</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="Dialog_Theme"></a><span class="mw-headline">Dialog Theme</span></h2>
<table class="dialogcontroltable">

<tr>
<th>Dialog Theme
</th>
<td> See <a href="../../UserGuide/UserGuide/The_peak_analyzer_themes.html" title="UserGuide:The peak analyzer themes">Peak Analyzer Themes</a>.
</td></tr>
</table>
<h2><a name="Find_Peaks_Controls"></a><span class="mw-headline">Find Peaks Controls</span></h2>
<table class="dialogcontroltable">

<tr>
<th> Current Number of Peaks
</th>
<td>
<p>This is read-only. It shows the number of peaks that have been found.
</p>
</td></tr>
<tr>
<th> Enable Auto Find
</th>
<td>
<p>Use this to specify whether you want the <b>Peak Analyzer</b> to find the peaks automatically. When this check box is selected, the <b>Add</b>, <b>Modify/Del</b>, <b>Clear All</b> and <b>Load</b> buttons are disabled.
</p>
</td></tr>
<tr>
<th> Find
</th>
<td>
<p>This button makes Origin find peaks using the current settings in the <b>Find Peaks Settings</b> and <b>Peak Filtering</b> groups.
</p>
</td></tr>
<tr>
<th> Add
</th>
<td>
<p>This button is enabled only when the <b>Auto Find</b> check box is not selected. When this button is clicked, you are allowed to add peaks manually, by double-clicking on the preview graph. The coordinates of mouse click will be shown in <a href="../../UserGuide/UserGuide/The_Data_Display_Tool.html" title="UserGuide:The Data Display Tool">Data Display Window</a> for better selection.
</p>
</td></tr>
<tr>
<th> Modify/Del
</th>
<td>
<p>This button is enabled only when the <b>Auto Find</b> check box is not selected. When this button is clicked, you are allowed to modify or delete the peaks on the preview graph. The coordinates of selected anchor points will be shown in <a href="../../UserGuide/UserGuide/The_Data_Display_Tool.html" title="UserGuide:The Data Display Tool">Data Display Window</a> for better identification.
</p>
</td></tr>
<tr>
<th> Clear All
</th>
<td>
<p>This button is enabled only when the <b>Auto Find</b> check box is not selected. When this button is clicked, all existing peaks are removed. 
</p>
</td></tr>
<tr>
<th> Save
</th>
<td>
<p>Click this button to save the current peak info to a .dat file.
</p>
</td></tr>
<tr>
<th> Load
</th>
<td>
<p>This button is enabled only when the <b>Auto Find</b> check box is not selected. When this button is clicked, you can load peak info from a file.
</p>
</td></tr>
<tr>
<th> Peaks Info
</th>
<td>
<p>When this button is clicked, the <b>Peak Info</b> dialog opens, showing you the information (centers and heights) of the peaks. You can sort peaks, add or delete a peak, and edit the peak info in the dialog, if the <b>Auto Find</b> check box is not selected. You can also copy the peak info or paste a specific center/height value for a peak by the Copy/Paste button.
</p><p><b>Peak Info</b> Dialog Button Group<br />
<a  class="image"><img alt="Sort Anchor Points Button.png" src="../images/Peak_Analyzer,_Find_Peaks_Page/Sort_Anchor_Points_Button.png?v=69007" width="25"  /></a> - Sort peak anchor points in ascending order by peak centers.<br />
<a  class="image"><img alt="Copy Anchor Points Button.png" src="../images/Peak_Analyzer,_Find_Peaks_Page/Copy_Anchor_Points_Button.png?v=69008" width="25"  /></a> - Copy selected peak anchor points in anchor points list.<br />
<a  class="image"><img alt="Paste Anchor Points Button.png" src="../images/Peak_Analyzer,_Find_Peaks_Page/Paste_Anchor_Points_Button.png?v=69009" width="25"  /></a> - Paste copied peak anchor points in clipboard into the peak anchor points list in <b>Peak Info</b> dialog.<br />
<a  class="image"><img alt="Add Anchor Points Button.png" src="../images/Peak_Analyzer,_Find_Peaks_Page/Add_Anchor_Points_Button.png?v=69010" width="25"  /></a> - Add a peak anchor point to the end of peak anchor points list.<br />
<a  class="image"><img alt="Delete Anchor Points Button.png" src="../images/Peak_Analyzer,_Find_Peaks_Page/Delete_Anchor_Points_Button.png?v=69011" width="25"  /></a> - Remove selected peak anchor point(s) in anchor points list.<br />
</p>
</td></tr>
<tr>
<th> Snap to Spectrum
</th>
<td>
<p>This checkbox is enabled only when <b>Enable Auto Find</b> is unchecked. Use this checkbox to specify whether you want the peak center anchor points to be snapped to the spectrum data. If this is selected, the peak center anchor points will be pulled onto the spectrum as you add or move them.
</p>
</td></tr></table>
<h3><a name="The_Peak_Finding_Settings_Group"></a><span class="mw-headline">The Peak Finding Settings Group</span></h3>
<table class="dialogcontroltable">

<tr>
<th> Show 2nd Derivative
</th>
<td>
<p>Use this check box to show or hide the panel that plots the second derivative of the spectrum data and its smoothed data(in red color) in the preview graph. The second derivative can be helpful in locating peaks (including hidden peaks) in the spectrum.
</p>
</td></tr>
<tr>
<th> Smooth Window Size
</th>
<td>
<p>Savitzky-Golay smoothing can be performed on the spectrum data before the peak finding. If you want to perform the smoothing, enter the desired window size (a positive integer) in the moving window for the Savitzky-Golay smoothing. Otherwise, enter 0 in this text box. There is an <b>Auto</b> check box to the right. When it is selected, the smooth points will be determined by the <b>Peak Analyzer</b> automatically. If you want to specify the smooth points, uncheck this box.
</p>
</td></tr>
<tr>
<th> Method
</th>
<td>
<p>Use this drop-down list to select the method to find the peaks.
</p>
<ul><li><b>Local Maximum</b>: Use the Local Maximum method to find the peaks in the spectrum.</li>
<li><b>Window Search</b>: Use the Window Search method to find the peaks in the spectrum.</li>
<li><b>1st Derivative</b>: Use the first derivative method to find the peaks in the spectrum.</li>
<li><b>2nd Derivative (Search Hidden Peaks)</b>(OriginPro only): Use the 2nd Derivative method to find the peaks in the spectrum. This method is capable of detecting hidden peaks in the data.</li>
<li><b>Residual after 1st Derivative (Search Hidden Peaks)</b>(OriginPro only): Use the Residual after 1st Derivative method to find the peaks in the spectrum. This method is capable of detecting hidden peaks in the data.</li>
<li><b>Fourier Self-Deconvolution(Pro)</b>:Use the Fourier Self-Deconvolution algorithm to find overlapping peaks in the spectrum. Note: The position and integrated area for each peak are preserved in the deconvolved spectrum.</li></ul>
</td></tr>
<tr>
<th> Direction
</th>
<td>
<p>Use this drop-down list to specify whether or not to find peaks with a specified direction only.
</p>
<ul><li><b>Positive</b>: Find positive peaks only.</li>
<li><b>Negative</b>: Find negative peaks only.</li>
<li><b>Both</b>: Find both positive and negative peaks.</li></ul>
</td></tr>
<tr>
<th> Local Points
</th>
<td>
<p>This is available only when <b>Local Maximum</b> or <b>Fourier Self-Deconvolution(Pro)</b> is selected in the <b>Method</b> drop-down list. It specifies the number of points in the local area, which will be used for finding the peaks with the Local Maximum or Fourier Self-Deconvolution(Pro) method.
</p>
</td></tr>
<tr>
<th> Size Option
</th>
<td>
<p>This is available only when <b>Window Search</b> is selected in the <b>Method</b> drop-down list. This drop-down list specifies how the <b>Height</b> and <b>Width</b> values (see below) are interpreted. 
</p>
<ul><li><b>Raw Size</b>: The values will be interpreted as raw sizes.</li>
<li><b>Percent of Raw Data</b>: The values will be interpreted as the percentages with respect to the total width or maximum height of the spectrum data.</li></ul>
</td></tr>
<tr>
<th> Height
</th>
<td>
<p>This is available only when <b>Window Search</b> is selected in the <b>Method</b> drop-down list. It specifies the height of the rectangle, which is used to find the peaks. There is an <b>Auto</b> check box to the right. If it is selected, the <b>Peak Analyzer</b> will determine the value automatically. Therefore, if you want to edit the value, please uncheck this check box.
</p>
</td></tr>
<tr>
<th> Width
</th>
<td>
<p>This is available only when <b>Window Search</b> is selected in the <b>Method</b> drop-down list. It specifies the width of the rectangle, which is used to find the peaks. There is an <b>Auto</b> check box to the right. If it is selected, the <b>Peak Analyzer</b> will determine the value automatically. Therefore, if you want to edit the value, please uncheck this check box.
</p>
</td></tr>
<tr>
<th> Smooth Derivative
</th>
<td>
<p>This is available only when <b>1st Derivative</b>(None and SG only), <b>2nd Derivative (Search Hidden Peaks)</b> or <b>Residual after 1st Derivative (Search Hidden Peaks) </b>(None and SG only) is selected in the <b>Method</b> drop-down list. Specifies the method to smooth the derivative of spectrum data.
</p>
<dl><dd><b>Method</b>
<dl><dd>Specifies the smoothing method.
<ul><li><b>None</b>: Do not use any smoothing method.</li>
<li><b>FFT</b>: Specifies the <b>FFT Filter</b> method to smooth derivative.</li>
<li><b>ADJ</b>: Specifies the <b>Adjacent Averaging</b> method to smooth derivative.</li>
<li><b>SG</b>: Specifies the <b>Savitsky-Golay</b> method to get smooth derivative. </li>
<li><b>Quadratic SG</b>: Specifies the <b>Quadratic Savitsky-Golay</b> method to smooth derivative. </li></ul></dd></dl></dd>
<dd><b>Cut Off Frequency</b>
<dl><dd>It is available only when the <b>Smooth Derivative</b> drop-down list selected to <b>FFT</b>. It specifies the cutoff frequency.</dd></dl></dd>
<dd><b>Points of Window</b>
<dl><dd>It is available only when the <b>Smooth Derivative</b> drop-down list selected to <b>ADJ</b>, <b>SG</b> and <b>Quadratic SG</b>. The greater this value, the greater the degree of smoothing. A value of zero for this parameter will leave the data unsmoothed. </dd></dl></dd>
<dd><b>Polynominal Order</b>
<dl><dd>It is available when the Smooth Derivative drop-down list selected to <b>ADJ</b> and <b>Quadratic SG.</b> It specifies the polynomial order.</dd></dl></dd></dl>
</td></tr>
<tr>
<th> Gamma
</th>
<td>This is available only when <b>Fourier Self-Deconvolution(Pro)</b> is selected in the <b>Method</b> drop-down list.
<p>Specify the line shape width. A default value is provided for <b>Gamma</b>; Uncheck <b>Auto</b> checkbox to specify a custom value. The line shape will be used to deconvolve the spectrum. Generally the larger Gamma is, the narrower the deconvolved peak becomes.
</p>
</td></tr>
<tr>
<th> Smoothing Factor(0-1)
</th>
<td>
<p>This is available only when <b>Fourier Self-Deconvolution(Pro)</b> is selected in the <b>Method</b> drop-down list.
</p><p>Specify Smoothing Factor to smooth the deconvolved spectrum. Smoothing factor must be between 0 and 1. The larger the factor, the smoother the deconvolved spectrum, and the wider the deconvolved peaks.
</p>
</td></tr></table>
<h3><a name="The_Peak_Filtering_Group"></a><span class="mw-headline">The Peak Filtering Group</span></h3>
<table class="dialogcontroltable">

<tr>
<th> Method
</th>
<td>
<p>Use this drop-down list to specify whether you want to limit the number of found peaks or the height of the peaks.
</p>
<ul><li><b>None</b>: Select this option if you do not want to limit the number of found peaks nor the heights of the peaks.</li>
<li><b>By Height%</b>: When you select this option and specify a threshold height in percentage with the <b>Threshold Height(%)</b> text box, only the peaks whose heights are not less than the threshold height will be found when you click the <b>Find</b> button. There is an <b>Auto</b> check box to the right. When it is selected, the threshold value will be determined by the <b>Peak Analyzer</b> automatically. If you want to specify the height, make sure the clear this check box.</li>
<li><b>By Number</b>: If you select this option and enter a value in the <b>Number of Peaks</b> text box, you can limit the number of peaks that will be found after you click the <b>Find</b> button. There is an <b>Auto</b> check box to the right. When it is selected, the smooth points will be determined by the <b>Peak Analyzer</b> automatically. If you want to specify the number of peaks, make sure the clear this check box.</li>
<li><b>By Height Value</b>: When you select this option and specify a actual threshold height with the <b>Threshold Height</b> text box, only the peaks whose heights are not less than the threshold height will be found when you click the <b>Find</b> button. There is an <b>Auto</b> check box to the right. When it is selected, the threshold value will be determined by the <b>Peak Analyzer</b> automatically. If you want to specify the height, make sure the clear this check box.</li>
<li><b>Custom</b>: If you select this option, you can enter the custom condition to combine more than one filtering methods to find the peaks.</li></ul>
</td></tr>
<tr>
<th> Threshold Height(%)
</th>
<td>
<p>This text box is available only when <b>By Height&#160;%</b> is selected in the <b>Filter Method</b> drop-down list. You can use it to specify the minimum height of the found peaks. It is a percent of a reference value, which is defined as follows: 
</p><p>First, get the maximum value and the minimum value of the spectrum (if a baseline has been subtracted from it, use the spectrum after subtraction). Then compare the absolute values of the maximum value and the minimum value. The greater one will be regarded as the reference value of the <b>Threshold Height</b>.
</p>
</td></tr>
<tr>
<th> Number of Peaks
</th>
<td>
<p>This text box is available only when <b>By Number</b> is selected in the <b>Filter Method</b> drop-down list. You can use it to specify the maximum number of the found peaks.
</p>
</td></tr>
<tr>
<th> Threshold Height
</th>
<td>
<p>This text box is available only when <b>By Height Value</b> is selected in the <b>Filter Method</b> drop-down list. You can use it to specify the minimum height of the found peaks. It is a actual height value, which is different from the <b>Threshold Height(%)</b>.
</p>
</td></tr>
<tr>
<th> Filter Condition
</th>
<td>
<p>This text box is available only when <b>Custom</b> is selected in the <b>Filter Method</b> drop-down list. You can enter different combined conditions to filter the peaks, such as "n&lt;=3 AND hp&gt;=0.2" which means peak number is less than or equal to 3 and meanwhile the Height Percent is larger than or equal to 20%.
Here, Origin supports 4 predefined keywords(<i>hp</i>=Height Percent, <i>h</i>=Height Value, <i>n</i>=Peak Number and <i>x</i>=Peak's X Value) which can be combined to filter the peaks.
</p><p>Please note, you can use natural language logical operators "AND", "OR", "NOT" and "LIKE" or you can use their symbolic equivalents (see <a class="external text" href="../../LabTalk/LabTalk/Operators.html#Logical_and_Relational_Operators">Logical and Relational Operators</a>).
</p>
</td></tr></table>
<h3><a name="The_Labels_and_Markers_Group"></a><span class="mw-headline">The Labels and Markers Group</span></h3>
<table class="dialogcontroltable">

<tr>
<th> Show Center Label
</th>
<td>
<p>Use this check box to specify whether or not to show a label for each peak center.
</p>
</td></tr>
<tr>
<th> Center Label
</th>
<td>
<p>Select the type of center labels.
</p>
<ul><li><b>X of Peaks</b>: Use the X coordinates of the peak centers as center labels.</li>
<li><b>Y of Peaks</b>: Use the Y coordinates of the peak centers as center labels.</li>
<li><b>Indices</b>: Use the indices of the peaks as center labels.</li>
<li><b>(X,Y) of Peaks</b>: Use the X and Y coordinates of the peak centers as center labels.</li></ul>
</td></tr>
<tr>
<th> Rotate Center Label
</th>
<td>
<p>Use this check box to specify whether or not to rotate the center labels.
</p>
</td></tr></table>
<h3><a name="The_Output_Baseline_Subtracted_Peaks_check_box"></a><span class="mw-headline">The Output Baseline Subtracted Peaks check box</span></h3>
<p>This check box is available only <a href="../../UserGuide/UserGuide/Peak_Analyzer,_Start_Page.html#Goal_Page_Controls" title="UserGuide:Peak Analyzer, Start Page">when <b>Goal</b> is set to <b>Find Peaks</b></a>, since Origin 2019b.
</p><p>Once you have specified the baseline for the input curve to find peaks, you might need to output the peak-finding results without the baseline. Then you can check this check box to subtract the baseline from the peak height. The output results can be as below:
</p>
<dl><dd><a  class="image"><img alt="Subtract baseline results.png" src="../images/Peak_Analyzer,_Find_Peaks_Page/Subtract_baseline_results.png?v=82342" width="632"  /></a></dd></dl>
<p>Please note, when the <a href="../../UserGuide/UserGuide/Peak_Analyzer,_Baseline_Mode_Page.html" title="UserGuide:Peak Analyzer, Baseline Mode Page">Baseline Mode</a> is set to <b>None</b> or <b>Min&amp;Max</b>, this check box will not be available.
</p>
<h3><a name="The_Peak_Fitting_Bounds_Group"></a><span class="mw-headline">The Peak Fitting Bounds Group</span></h3>
<p>This group is available only <a href="../../UserGuide/UserGuide/Peak_Analyzer,_Start_Page.html#Goal_Page_Controls" title="UserGuide:Peak Analyzer, Start Page">when <b>Goal</b> is set to <b>Fit Peaks</b></a>.
</p>
<table class="dialogcontroltable">

<tr>
<th> Preset Bounds by
</th>
<td>
<p>Use this drop-down list to specify whether and how you want to set boundaries to the found peaks while fitting.
</p>
<ul><li><b>None</b>: Select this option if you do not want to preset the boundaries of the peak center, widths nor heights of found peaks.</li>
<li><b>By Difference</b>: Specify boundaries by difference between center and upper/lower bound. When you select this option and specify values of <b>Center</b>, <b>Width</b> and/or <b>Height/Area</b>, peaks fitting will be limited to the center, width and/or height boundaries you set. </li>
<li><b>By Percentage</b>: Specify boundaries by the percentage of the difference between center and upper/lower bound. When you select this option and specify the percentage values of <b>Center(%)</b>, <b>Width(%)</b> or <b>Height/Area(%)</b>, peaks fitting will be limited to the center, width and/or height boundaries you set. </li></ul>
</td></tr>
<tr>
<th>Center
</th>
<td>This option is available only when <b>By Difference</b> is selected for <b>Preset Bounds by</b>. Check the checkbox and specify the upper and lower bounds for peak center.
</td></tr>
<tr>
<th>Width
</th>
<td>This option is available only when <b>By Difference</b> is selected for <b>Preset Bounds by</b>. Check the checkbox and specify the the upper and lower bounds for peak width.
</td></tr>
<tr>
<th>Height(Area)
</th>
<td>This option is available only when <b>By Difference</b> is selected for <b>Preset Bounds by</b>. Check the checkbox and specify the upper and lower bounds of peak height or peak area.
</td></tr>
<tr>
<th>Center(%)
</th>
<td>This option is available only when <b>By Percentage</b> is selected for <b>Preset Bounds by</b>. Check the checkbox and specify the upper and lower bounds in percentage of peak center.
</td></tr>
<tr>
<th>Width(%)
</th>
<td>This option is available only when <b>By Percentage</b> is selected for <b>Preset Bounds by</b>. Check the checkbox and specify the upper and lower bounds in percentage of peak width.
</td></tr>
<tr>
<th>Height(Area)(%)
</th>
<td>This option is available only when <b>By Percentage</b> is selected for <b>Preset Bounds by</b>. Check the checkbox and specify the upper and lower bounds in percentage of peak height or peak area.
</td></tr></table>






