<h1 class="firstHeading">24.3 Package Manager</h1><p class='urlname' style='display: none'>FileShare-PackageManager</p>
<p>The <b>Package Manager</b> is Origin's new replacement for OPK files.  The old OPK files are binary files and were limited when it came to being used for module installation.  The new OPX files are XML and have been designed with the goal of making module installation simpler for the user.  You access the <b>Package Manager</b> dialog from the <b>Tools</b> menu.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Dialog:_File_Menu"><span class="tocnumber">1</span> <span class="toctext">Dialog: File Menu</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Dialog:_Tree_View"><span class="tocnumber">2</span> <span class="toctext">Dialog: Tree View</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Dialog:_Buttons"><span class="tocnumber">3</span> <span class="toctext">Dialog: Buttons</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Dialog:_File_List"><span class="tocnumber">4</span> <span class="toctext">Dialog: File List</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#OriginC"><span class="tocnumber">5</span> <span class="toctext">OriginC</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Internal_Behavior"><span class="tocnumber">6</span> <span class="toctext">Internal Behavior</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Silent_Install"><span class="tocnumber">7</span> <span class="toctext">Silent Install</span></a></li>
</ul>
</div>

<h2><a name="Dialog:_File_Menu"></a><span class="mw-headline">Dialog: File Menu</span></h2>
<p>The Package Manager dialog has a single File menu.  This menu contains the following items:
</p>
<table class="dialogcontroltable">

<tr>
<th> New
</th>
<td>
<p>Create a new package.  This will cause the current package, if one is open, to be closed.  If the current package has been changed but not saved then you will be prompted to save or discard the changes or cancel the creation of a new package.
</p>
</td></tr>
<tr>
<th> Open...
</th>
<td>
<p>Open an existing package file.  This will cause the current package, if one is open, to be closed.  If the current package has been changed but not saved then you will be prompted to save or discard the changes or cancel the creation of a new package.
</p>
</td></tr>
<tr>
<th> Save
</th>
<td>
<p>Save the current package to disk using it's current file name.  If the package is new and does not yet have a file name then you will be prompted for a file name.
</p>
</td></tr>
<tr>
<th> Save As...
</th>
<td>
<p>Save the current package using a new file name.
</p>
</td></tr>
<tr>
<th> Install a Package
</th>
<td>
<p>You will be prompted with a file dialog to choose a package file.  After choosing a package file and clicking Open the package will be installed.
</p>
</td></tr>
<tr>
<th> Uninstall a Package
</th>
<td>
<p>This item will show you the "Installed Packages" dialog.  This dialog lists all the packages currently installed.  Simply select the packages you want to uninstall and click the Uninstall button.
</p>
</td></tr>
<tr>
<th> Extract a Package
</th>
<td>
<p>Extracting a package is different than installing a package.  Extracting a package is used when you only want to get the files out of the package.  The before and after scripts will not be executed.  You also will be prompted to choose the target folder which can be any folder you choose.  The target folder does not have to be Origin's user nor system folder.
</p>
</td></tr>
<tr>
<th> Close
</th>
<td>
<p>Close the dialog.  If changes were made to current package and have not been saved you will be prompted.
</p>
</td></tr></table>
<h2><a name="Dialog:_Tree_View"></a><span class="mw-headline">Dialog: Tree View</span></h2>
<p>The tree view is where the package settings are edited.  The following describes the settings.
</p>
<table class="dialogcontroltable">
<tr>
<th>Package
</th>
<td>
<ul><li>Module Name
<dl><dd>The name of the module.  The name should remain the same for each *version released.</dd>
<dd>During installation the Module Name is compared to the names of the packages already installed.  If a match is found then the Version fields are compared and the user is notified that an older, newer, or same version of the package is already installed.  The user is given the option to continue or cancel the installation.</dd></dl></li>
<li>Description
<dl><dd>A description of the module or package contents.</dd></dl></li>
<li>Version
<dl><dd>The version of the module contained in the package.</dd>
<dd>During installation the Module Name is compared to the names of the packages already installed.  If a match is found then the Version fields are compared and the user is notified that an older, newer, or same version of the package is already installed.</dd></dl></li>
<li>Author
<dl><dd>Who created the module contained in the package.</dd></dl></li></ul>
</td></tr>
<tr>
<th>Apps
</th>
<td>
<ul><li>Icon
<dl><dd>The bmp image to used as App icon in <a href="../../UserGuide/UserGuide/Apps.html#The_Apps_Gallery" title="UserGuide:Apps">Apps Gallery</a>.</dd></dl></li>
<li>Launch Script
<dl><dd>The LabTalk script to be run when launching the App.</dd></dl></li></ul>
</td></tr>
<tr>
<th>Origin Version Required
</th>
<td>
<p>The version of Origin required to use the module contained in the package.
</p>
</td></tr>
<tr>
<th>Target Path
</th>
<td>
<p>The Target Path is used during installation and tells Package Manager where to install the contents of the package.
</p>
<ul><li>User = The User Files folder.</li>
<li>System = The Origin program folder.</li>
<li>Auto = Check the User and System paths for write access.  If only one has write access then install there.  If both have write access then prompt user to choose the target path.</li></ul>
</td></tr>
<tr>
<th>Toolbar
</th>
<td>
<ul><li>Button Group File
<dl><dd>If the package contains a button group file and you want the button group to be added to Origin's User Defined button groups during package installation then specify the button group file here.</dd>
<dd>The simplest way to set this field is to first add the button group file to the package.  Once added you can select it in the list of files and then click the "Set Toolbar" button.</dd></dl></li>
<li>Create Toolbar
<dl><dd>This determines if a toolbar will be created, from the button group, during package installation.</dd>
<dd>Check the box to create a toolbar or uncheck the box to not create a toolbar.</dd></dl></li></ul>
</td></tr>
<tr>
<th>LabTalk Script
</th>
<td>
<ul><li>Before Installation
<dl><dd>The LabTalk code entered here is executed before the package is installed.  If a LabTalk command error occurs then the installation will be canceled.  If your script code does some checking and determines that installation should not continue then you can force a command error with 'break 1;' or set OPXERR to a non-zero value.</dd></dl></li>
<li>After Installation
<dl><dd>The LabTalk code entered here is executed after the package is installed.</dd></dl></li>
<li>Before UnInstalling
<dl><dd>The LabTalk code entered here is executed before the files that were installed are uninstalled/removed.  Use this to undo any changes you may have done in the Before Installation or After Installation scripts.  If your script code does some checking and determines that the uninstallation should not continue then you can force a command error with 'break 1;' or set OPXERR to a non-zero value.</dd></dl></li></ul>
</td></tr>
<tr>
<th>Source Path
</th>
<td>
<p>This field shows the source path for all the packed files.  All files added to the package must come from the same source path.  The Source Path is set when you add your first folder or file.
</p>
<dl><dd><ul><li>If your first folder or file comes from the Origin program folder or one of it's sub-folders then the Source Path is set to the Origin program path.</li>
<li>If your first folder or file comes from the User Files folder or one of it's sub-folders the the Source Path is set to the User Files folder.</li>
<li>If your first folder or file does not come from the Origin program folder nor the User Files folder then the Source Path is set to the path of the folder above the folder be added or to the path of the folder containing the file being added.</li></ul></dd>
<dd>If the location of the files change then you can manually edit the Source Path.  Once you change the Source Path setting to the new location you can use the Repack Files button when you want to update any changed files in the package.  Being able to change the Source Path allows you to also repack packages that were made on other computers.</dd></dl>
</td></tr></table>
<h2><a name="Dialog:_Buttons"></a><span class="mw-headline">Dialog: Buttons</span></h2>
<p>Below the tree view are six buttons.  The following describes the buttons.
</p>
<table class="dialogcontroltable">
<tr>
<th>Repack Files
</th>
<td>
<p>Click this button to repack all the files that have been added to the package.  This button is useful when you change a file and want to put the file changes into the package.  Instead of removing the file and adding it again you can simply click this button and all the new changes to your files will be repacked into the package.
</p><p>This button is disabled until the package contains at least one file.
</p>
</td></tr>
<tr>
<th>Set Toolbar
</th>
<td>
<p>Click this button to set the Button Group File setting in the Toolbar branch of the tree view.
</p><p>This button is disabled until you select a single file in the File List.
</p>
</td></tr>
<tr>
<th>Add Folder...
</th>
<td>
<p>Click this button to add a folder and all the files and subfolders contained in the chosen folder.
</p><p>The Source Path field, in the tree view, will be set when adding the first folder or file to the package.  For more information see Source Path.
</p>
</td></tr>
<tr>
<th>Add Files...
</th>
<td>
<p>Click this button to add files to the package.  You will be prompted with a "Add Files To Package" file dialog.
</p><p>The Source Path field, in the tree view, will be set when adding the first folder or file to the package.  For more information see Source Path.
</p>
</td></tr>
<tr>
<th>Remove Files
</th>
<td>
<p>Click this button to remove all the selected files from the package.
</p><p>This buttion is disabled until you select one or more files in the File List.
</p>
</td></tr></table>
<p>The right-most button is used to show and hide the File List.
</p>
<h2><a name="Dialog:_File_List"></a><span class="mw-headline">Dialog: File List</span></h2>
<p>The file list shows all the files that are currently in the package.  The number of files in the list and the number of selected files will change the state of the buttons as described above.
</p>
<h2><a name="OriginC"></a><span class="mw-headline">OriginC</span></h2>
<p>The Package Manager dialog is handled by OriginC code in OriginC\OriginLab\XMLPackage.c
</p><p>The XMLPackage.c file calls a collection of Origin exported functions for working with packages.  The following functions are declared in oUtils.h and exported from Origin's okUtil80.dll:
</p>
<ul><li> okutil_create_package_tree</li>
<li> okutil_create_package_file</li>
<li> okutil_install_package_file</li>
<li> okutil_uninstall_package_file</li>
<li> okutil_get_installed_package_names</li>
<li> okutil_add_folder_to_package</li>
<li> okutil_add_files_to_package</li>
<li> okutil_remove_files_from_package</li>
<li> okutil_get_packed_file_names</li>
<li> okutil_repack_files</li></ul>
<p>See OriginC's oUtils.h for the function's return type and the argument accepted by each function.
</p>
<h2><a name="Internal_Behavior"></a><span class="mw-headline">Internal Behavior</span></h2>
<p>When installing a package Origin will first check to see if the package has already been installed.  If it has already been installed then Origin will inform the user that the package is already installed and ask if the installing should continue.  If the user chooses to continue the installation then Origin will first uninstall the previous installation and then continue to install the current package.
</p><p>For each package that gets installed Origin will copy the package, without the packed files, to a package list file.  The package list file is OPXList.xml and is stored in the User Files folder.
</p>
<h2><a name="Silent_Install"></a><span class="mw-headline">Silent Install</span></h2>
<p>To make an OPX that can be silently installed you need to have the following settings:
</p>
<ul><li>Set the <b>LabTalk Script &gt; Before Installation</b> setting to blank or any script that does not provoke a user prompt.</li>
<li>Set the <b>LabTalk Script &gt; After Installation</b> setting to any script that does not provoke a user prompt followed by the following two additional commands:</li></ul>
<pre class="lt" style="font-family:monospace;">doc <span style="color: #000080;">-</span>s; 
exit;</pre>
<p>After making the necessary changes to the OPX it is now possible to launch Origin, install the OPX, and exit Origin without any human interaction.  The following command line demonstrates how to perform the silent install of the OPX.
</p>
<pre class="lt" style="font-family:monospace;">Origin8.<span style="color: #000080;">exe</span> <span style="color: #000080;">-</span>h <span style="color: #000080;">-</span>R <span style="color: #ff00ff;">&quot;instOPX OPXFileName.opx&quot;</span></pre>
<p>The above command line will need to be edited to use the file name of your OPX.
</p>





