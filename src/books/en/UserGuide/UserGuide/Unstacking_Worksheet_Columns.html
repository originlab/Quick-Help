<h1 class="firstHeading">4.4.9.2 Unstacking Worksheet Columns</h1><p class='urlname' style='display: none'>Wks-Unstacking-Cols</p>
<p><br />
This function is used to unstack grouped data into multiple columns. During unstacking, the missing values can be placed in one group. Optionally, you can include columns that are not part of the group in the output. 
</p><p>To use this function:
</p>
<ol><li> Create a new worksheet with input data.</li>
<li> Select <b>Restructure: Unstack Columns</b> from the Origin menu to open the <b>wunstackcol</b> dialog box. </li></ol>
<p>In fact, the <a class="external text" href="../../XFunction/X-Function/Wunstackcol.html">wunstackcol</a> X-Function is called to start this function. 
</p>
<dl><dd><a  class="image"><img alt="UnstackColumnsDialog.png" src="../images/Unstacking_Worksheet_Columns/UnstackColumnsDialog.png?v=48102" width="787"  /></a></dd></dl>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Dialog_Controls"><span class="tocnumber">1</span> <span class="toctext">Dialog Controls</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#How_to_Unstack_Columns"><span class="tocnumber">2</span> <span class="toctext">How to Unstack Columns</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Examples"><span class="tocnumber">3</span> <span class="toctext">Examples</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Example_1:_Basic_Unstacking"><span class="tocnumber">3.1</span> <span class="toctext">Example 1: Basic Unstacking</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Example_2:_Unstacking_by_Date_or_Time"><span class="tocnumber">3.2</span> <span class="toctext">Example 2: Unstacking by Date or Time</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Example_3:_Reorder_Unstacked_Columns"><span class="tocnumber">3.3</span> <span class="toctext">Example 3: Reorder Unstacked Columns</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="Dialog_Controls"></a><span class="mw-headline">Dialog Controls</span></h2>
<table class="dialogcontroltable">

<tr>
<th>Recalculate
</th>
<td>
<p>Specify how to recalculate the results. See details in <a href="../../UserGuide/UserGuide/Recalculating_Analysis_Results.html" title="UserGuide:Recalculating Analysis Results">Recalculating Analysis Results</a>.
</p>
</td></tr>
<tr>
<th>Data to be Unstacked
</th>
<td>
<p>Specify the data to be unstacked. 
</p>
</td></tr>
<tr>
<th>Group Column(s)
</th>
<td>
<p>Multiple grouping columns contains grouping information can be inserted into the <b>Group Column(s)</b> box. Unstacking columns is in accordance with this group. You can add, remove, order grouping columns via controlling buttons: <b>Move Up</b> button <a  class="image"><img alt="Button Group List Move Up.png" src="../images/Unstacking_Worksheet_Columns/Button_Group_List_Move_Up.png?v=38533" width="16"  /></a>, <b>Move Down</b> button <a  class="image"><img alt="Button Group List Move Down.png" src="../images/Unstacking_Worksheet_Columns/Button_Group_List_Move_Down.png?v=38534" width="13"  /></a>, <b>Remove</b> button <a  class="image"><img alt="Button Group List Remove.png" src="../images/Unstacking_Worksheet_Columns/Button_Group_List_Remove.png?v=38532" width="14"  /></a>, <b>Select All</b> button <a  class="image"><img alt="Button Group List Select All.png" src="../images/Unstacking_Worksheet_Columns/Button_Group_List_Select_All.png?v=45398" width="18"  /></a>, <b>Select</b> button <a  class="image"><img alt="Button Group List Add.png" src="../images/Unstacking_Worksheet_Columns/Button_Group_List_Add.png?v=38531" width="17"  /></a> in toolbar <a  class="image"><img alt="Group List Toolbar.png" src="../images/Unstacking_Worksheet_Columns/Group_List_Toolbar.png?v=47304" width="160"  /></a>.
<br />The grouping columns are set as categorical if most of the column values are text. So you can easily reorder the output columns.
</p>
</td></tr>
<tr>
<th>Options
</th>
<td>
<p><b>Include Other Column(s)</b>
</p>
<dl><dd>Specify whether to include those non-unstack columns in the original sheet to the result sheet. </dd></dl>
<p><b>Other Column(s)</b>
</p>
<dl><dd>Specify the data range(s) which will be the non-unstack column(s) to output to the result sheet. It is available when <b>Include Other Column(s)</b> is checked. </dd></dl>
<p><b>Extract Rule for Other Columns Values</b>
</p>
<dl><dd>Specify how to arrange the data in <b>Other Column(s)</b>. It is available when <b>Include Other Column(s)</b> is checked.
<ul><li><b>Matching Longest Group</b>
<dl><dd>Use this option when there are an equal number of individuals for each value of the grouping variable(s) (<b>Group Column(s)</b>) and an equal number of individuals for each value of non-grouped variables (<b>Other Column(s)</b>). For example, suppose that there are 6 individuals to be unstacked to two columns, G1 and G2. For our non-grouping variable there are 3 values -- g1, g2 and g3.  To use this option, G1 and G2 should have three individuals each and the non-grouped variable should have 2 individuals in g1, two in g2 and two in g3. <b>Note</b> that before choosing this option, you should be perform a <a href="../../UserGuide/UserGuide/Sorting_Worksheet_Data.html#Nested_Sorting" title="UserGuide:Sorting Worksheet Data">nested sort</a> (primarily sorted by <b>Group Column(s)</b> and secondarily sorted by <b>Other Column(s)</b>).</dd></dl></li>
<li><b>Combining All Groups</b>
<dl><dd>This option combines the data in <b>Group Column(s)</b> and the data in <b>Other Column(s)</b> and uses it as the index for the unstacked data. So it requires the combination of the data in <b>Group Column(s)</b> and the data in <b>Other Column(s)</b> to be unique.</dd></dl></li></ul></dd></dl>
<p><b>Include Missing as One Group</b>
</p>
<dl><dd>Specify whether to consider missing values as one group. </dd></dl>
</td></tr>
<tr>
<th>Output Settings
</th>
<td>
<p><b>Sort Output Columns By</b>
</p>
<dl><dd>Specify how to sort the output columns.
<ul><li><b>Group Variables</b>
<dl><dd>Sort the output columns alphanumerically by group variable value. For example, group variable "Make" has two values, "Acura" and "Buick". After unstacking, the columns appear in the order "Acura", then "Buick".</dd></dl></li>
<li><b>Data to be Unstacked</b>
<dl><dd>Preserve the order of the <b>Data to be Unstacked</b>. For example, <b>Data to be Unstacked</b> = <i>[Book1]Sheet1!(3,4)</i>. When unstacked, column 3 data columns are listed first; column 4 data columns follow. If <b>Data to be Unstacked</b> = <i>[Book1]Sheet1!(4,3)</i>, then column 4 data columns are listed first; column 3 data columns follow.</dd></dl></li></ul></dd></dl>
<p><b>Output Worksheet</b>
</p>
<dl><dd>Specify where to store the output unstacked results. </dd></dl>
<p><b>Put Grouping Info. to</b>
</p>
<dl><dd>Specify where to put the grouping information. 
<ul><li><b>Long Name</b>
<dl><dd>Output the grouping information to the Long Name row.</dd></dl></li>
<li><b>Comments</b>
<dl><dd>Output the grouping information to the Comments row. </dd></dl></li>
<li><b>Append to Data Column's Long Name</b>
<dl><dd>Append the grouping information to the Long Name row. </dd></dl></li>
<li><b>User Defined Parameters</b>
<dl><dd>Output the grouping information to the user defined parameter row. This row's name is specified by <b>From Group Columns</b>.</dd></dl></li>
<li><b>Custom</b>
<dl><dd>Fill <a class="external text" href="../../LabTalk/LabTalk/Column_Label_Row_Characters.html">label abbreviation</a> for every grouping column. The number of labels should be equal to number of group columns. Information of each group column will be put in the one label row. For example, if we have two group columns in input, fill <b>LC</b> in the option. Info of group1 will be set as Long Name and  and info. of group2 will be set as Comment</dd></dl></li></ul></dd></dl>
<p><b>From Group Columns</b>
</p>
<dl><dd>This drop-down list is only available when <b>Put Group Info. to</b> is set as <b>User Defined Parameters</b>. It is used to name the user defined parameter row for storing grouping information. The name is from the label row of the Group column in the source worksheet. The selected label row must contain string for naming the user defined parameter row, or there will be an error message. In GUI, the possible options include (depends on which label row is shown in the source worksheet):
<ul><li><b>Short Name</b>
<dl><dd>From the Short Name of the group columns.</dd></dl></li>
<li><b>Long Name</b>
<dl><dd>From the Long Name row of the group columns.</dd></dl></li>
<li><b>Units</b>
<dl><dd>From the Units row of the group columns.</dd></dl></li>
<li><b>Comments</b>
<dl><dd>From the Comments row of the group columns.</dd></dl></li></ul></dd></dl>
</td></tr></table>
<h2><a name="How_to_Unstack_Columns"></a><span class="mw-headline">How to Unstack Columns</span></h2>
<p>This function is the inverse operation of <a href="../../UserGuide/UserGuide/Stacking_Worksheet_Columns.html" title="UserGuide:Stacking Worksheet Columns">stack columns</a>. During unstacking columns, it allows including other non-unstacked columns into the unstacked result.
</p>
<ul><li><b>Unstack</b>
<dl><dd>Unstack grouped data into multiple columns.</dd>
<dd><a  class="image"><img alt="Unstack Without Enable Options.png" src="../images/Unstacking_Worksheet_Columns/Unstack_Without_Enable_Options.png?v=33994" width="258"  /></a></dd></dl></li>
<li><b>Unstack and Include Other Columns</b>
<dl><dd>Unstack grouped data into multiple columns including ungrouped data columns.
<ul><li>Using the <b>Matching Longest Group</b> option
<dl><dd><a  class="image"><img alt="Unstack With Ungrouped Data.png" src="../images/Unstacking_Worksheet_Columns/Unstack_With_Ungrouped_Data.png?v=33997" width="343"  /></a></dd></dl></li>
<li>Using the <b>Combining All Groups</b> option
<dl><dd><a  class="image"><img alt="Unstack With Ungrouped Data1.png" src="../images/Unstacking_Worksheet_Columns/Unstack_With_Ungrouped_Data1.png?v=33996" width="329"  /></a></dd></dl></li></ul></dd></dl></li></ul>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<h3><a name="Example_1:_Basic_Unstacking"></a><span class="mw-headline">Example 1: Basic Unstacking</span></h3>
<p>This example will unstack the grouped data (&lt;Origin Program Directory&gt;\Samples\Statistics\body.dat) into multiple columns. 
</p>
<ol><li>Import the file <i>&lt;Origin Program Directory&gt;\Samples\Statistics\body.dat</i> into a new workbook.
<dl><dd><a  class="image"><img alt="Wunstackcol example 1.png" src="../images/Unstacking_Worksheet_Columns/400px-Wunstackcol_example_1.png?v=46383" width="400"   /></a></dd></dl></li>
<li>Highlight column D, E, then select the menu <b>Worksheet: Unstack Columns</b> (or type <code>wunstackcol -d;</code> in Command Window) to bring up the <b>wunstackcol</b> dialog.</li>
<li>Click the triangular button next to the <b>Group Column(s)</b> and choose <b>C(Y): gender</b>. </li>
<li>In the <b>Options</b> tree, check the box next to the <b>Include Other Column(s)</b>. Use the default range in the <b>Other Column(s)</b>.</li>
<li>Select <b>Combining All Groups</b> from the dropdown list of <b>Extract Rule for Other Columns Values</b>.</li>
<li>In the <b>Output Settings</b> tree, select <b>User Defined Parameters</b> for <b>Put Grouping Info. to</b>, and then set <b>From Group Columns</b> as <b>Long Name</b>. Keep other settings as the default values.
<dl><dd><a  class="image"><img alt="Wunstackcol example 2.png" src="../images/Unstacking_Worksheet_Columns/Wunstackcol_example_2.png?v=46384" width="562"  /></a></dd></dl></li>
<li>Click the <b>OK</b> button to unstack columns. Results are shown below.
<dl><dd><a  class="image"><img alt="Wunstackcol example 3.png" src="../images/Unstacking_Worksheet_Columns/400px-Wunstackcol_example_3.png?v=46385" width="400"   /></a></dd></dl></li></ol>
<h3><a name="Example_2:_Unstacking_by_Date_or_Time"></a><span class="mw-headline">Example 2: Unstacking by Date or Time</span></h3>
<p>This example groups data by keying on a single component of a complex date-time string.
</p>
<ol>
<li>Start with a fresh workbook, choose <b>Data: Import from File: Single ASCII</b> and import &lt;Origin Program Directory&gt;\Samples\Import and Export\Custom Date and Time.dat.</li>
<li>Click on the A(X) column heading to select the column, then right-click and choose <b>Properties</b>.
<li>On the <b>Properties</b> tab, set <b>Format</b> to <b>Date</b>, set <b>Display</b> to <b>Custom Display</b> and in the Custom Display combo box, enter the following and click <b>OK</b>.
<pre>
dd.MM.yyyy HH:mm:ss.##
</pre>
<dl><dd> What this does is to convert what Origin "sees" as a text string, to a date-time string that is treated internally as a numeric value that can be used for math operations, etc.</li></dd></dl>
<li>Scroll the data sheet and note that the time portion of the string (<i>HH:mm:ss.##</i>) shows readings were taken at close intervals beginning at 09 hours. Suppose that we wanted to break B(Y) column data readings out into groups by hour and minute?  The way to do this is to re-select column A(X), right-click and choose <b>Properties</b> and on the <b>Properties</b> tab, set <b>Format</b> to <b>Time</b> and select <i>HH:mm</i> for <b>Display</b> drop-down list.<br />
Your worksheet should now look like this.</li>
<p><a  class="image"><img alt="Wunstackcol example 4.png" src="../images/Unstacking_Worksheet_Columns/Wunstackcol_example_4.png?v=74098" width="333"  /></a><br />
</p>
<li>Highlight both columns in the worksheet and select <b>Worksheet: Unstack Columns: Open Dialog</b>.</li>
<li>Set <b>Group Column(s)</b> to A(X). Accept other defaults and click <b>OK</b>. Data are grouped by <code>HH:mm</code> and grouping info is saved in the <b>Comments</b> label row of a new worksheet.</li>
<p><a  class="image"><img alt="Wunstackcol example 5.png" src="../images/Unstacking_Worksheet_Columns/Wunstackcol_example_5.png?v=74099" width="738"  /></a>
</p>
</ol>
<h3><a name="Example_3:_Reorder_Unstacked_Columns"></a><span class="mw-headline">Example 3: Reorder Unstacked Columns</span></h3>
<p>This example will unstack <b>Power</b> column of <b>&lt;Origin Program Directory&gt;\Samples\Statistics\automobile.dat</b> by <b>Make</b>, and reorder the output. 
</p>
<ol><li>Import the file <i>&lt;Origin Program Directory&gt;\Samples\Statistics\automobile.dat</i> into a new workbook.</li>
<li>Highlight column C, then select the menu <b>Worksheet: Unstack Columns</b> to bring up the <b>wunstackcol</b> dialog.</li>
<li>Click the triangular button next to the <b>Group Column(s)</b> and choose <b>B(Y): Make</b>. </li>
<li>Change <b>Recalculate</b> to <b>Auto</b> and accept the default settings.
<dl><dd><a  class="image"><img alt="Wunstackcol example 6.png" src="../images/Unstacking_Worksheet_Columns/Wunstackcol_example_6.png?v=81370" width="499"  /></a></dd></dl></li>
<li>Click the <b>OK</b> button to unstack columns. Note that col(B) is set as categorical.</li>
<li>Highlight all data in <i>UnstackCols1</i> sheet and select from menu <b>Plot&gt; Multi-Panel/Axis: Multiple Panels by Label...</b>. </li>
<li>Set <b>Group by</b> as <b>Comments</b>. Click <b>OK</b> to plot a multi-panel graph. Note that the panel order follows the column order in the <i>UnstackCol1</i> sheet. </li>
<li>If you want to adjust the panel order, e.g. the alphabetical order of the Makers, the best way is to adjust the categorical order in the source worksheet. Go back to the <i>automobile</i> sheet. Double click the header cell in the Categories row of col(B). </li>
<li>In the <b>Categories</b> dialog, check <b>Customize Categories(Add, Delete, Set Aribitrary Order)</b>. Click Category header in the table to sort it alphabetically. Click <b>OK</b>.<br />Both column order in <b>UnstackCols1</b> and panels in the graph get updated.</li></ol>






