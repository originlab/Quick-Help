<h1 class="firstHeading">4.6.8.3 Entering Expressions in the Set Values Dialog</h1><p class='urlname' style='display: none'>Wks-SetColVal-Expression</p>
<p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Expression_Basics"><span class="tocnumber">1</span> <span class="toctext">Expression Basics</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Useful_Tips_for_Inputting_Expressions"><span class="tocnumber">1.1</span> <span class="toctext">Useful Tips for Inputting Expressions</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-3"><a href="#Add_Expressions_only_in_Column_Formula"><span class="tocnumber">2</span> <span class="toctext">Add Expressions only in <i>Column Formula</i></span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Add_Expressions_only_in_Before_Formula_Scripts"><span class="tocnumber">3</span> <span class="toctext">Add Expressions only in <i>Before Formula Scripts</i></span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Add_Expressions_in_both_Column_Formula_and_Before_Formula_Scripts"><span class="tocnumber">4</span> <span class="toctext">Add Expressions in both <i>Column Formula</i> and <i>Before Formula Scripts</i></span></a></li>
</ul>
</div>

<h2><a name="Expression_Basics"></a><span class="mw-headline">Expression Basics</span></h2>
<p>The expression used in the <b>Set Values</b> dialog should follow the logic of LabTalk. The expression can contain <a class="external text" href="../../LabTalk/LabTalk/Operators.html#Arithmetic_Operators">arithmetic operators</a>, <a class="external text" href="../../LabTalk/LabTalk/Range_Notation.html">range variables</a>, <a class="external text" href="../../LabTalk/Script/LabTalk-Supported_Functions.html">built-in LabTalk functions</a> and <a href="../../UserGuide/UserGuide/Create_a_User_Defined_Function_for_Set_Column_Values.html" title="UserGuide:Create a User Defined Function for Set Column Values">user-defined functions</a> etc. There are two places to define expressions:
</p>
<ul><li><b>Column Formula</b>. Only a single-line expression can be input here.</li>
<li><b>Before Formula Scripts</b>. Multi-line LabTalk scripts can be input here, which will be executed before column values are set with the formula in the <b>Column Formula</b> edit box.</li></ul>
<p>Please note that several samples are available for you. You can select <b>Formula: Load Sample</b> to retrieve them.
</p>
<dl><dd><a  class="image"><img alt="SetColumnValue1.png" src="../images/Entering_Expressions_in_the_Set_Column_Dialog/SetColumnValue1.png?v=77136" width="750"  /></a></dd></dl>
<h3><a name="Useful_Tips_for_Inputting_Expressions"></a><span class="mw-headline">Useful Tips for Inputting Expressions</span></h3>
<p>Beginning with Origin 2017 SR0, <a href="../../UserGuide/UserGuide/Folder_and_Window_Properties_Dialog.html#The_User_Tree_tab" title="UserGuide:Folder and Window Properties Dialog">Spreadsheet Cell Notation (SCN)</a> is enabled by default. When SCN is enabled, you can use the new notation or you can use the pre-2017 notation in either the <b>Set Values Column Formula</b> box or in the <a href="../../UserGuide/UserGuide/Displaying_Supporting_Data_in_Worksheet_Header_Rows.html#F.28x.29.3D" title="UserGuide:Displaying Supporting Data in Worksheet Header Rows">the <b>F(x)=</b> column label row</a>. Note, however, that when using the <b>col()</b> or <b>wcol()</b> functions, entering a script into the <b>Before Formula Scripts</b> panel, or when your expression uses brackets "<b>{}</b>", <i><b><a href="../../UserGuide/UserGuide/Quick_Start_SetColumnValues.html#A_Note:_When_Column_Formulas_do_not_Automatically_Update" title="UserGuide:Quick Start SetColumnValues">some limitations apply</a></b></i>.
</p>
<ul><li>When referring to a column by its Short Name, the Short Name must be limited to no more than 3 characters. Otherwise such column reference cannot be recognized. When Short Names exceed 3 characters, use the "old" notation (<b>col()</b> or <b>wcol()</b>) instead. The pre-2017 notation doesn't have this limitation.</li>
<li>From Origin 2022b, if there are multiple columns with the same Long Name in a worksheet, you can use both Short Name and Long Name to specify the column with duplicated Long Name. The syntax is <pre class="lt" style="font-family:monospace;">col<span style="color: #000000;">&#40;</span>ShortName<span style="color: #ff00ff;">&quot;LongName&quot;</span><span style="color: #000000;">&#41;</span></pre> If Short Name is omitted, the left-most column with this <i>LongName</i> will be referred to.</li>
<li> <a href="../../UserGuide/UserGuide/Menu_Options_and_Dialog_Controls.html#Variables_Menu" title="UserGuide:Menu Options and Dialog Controls">The Variables menu</a> can help you define variables used in the expression. </li>
<li> Origin offers many <a class="external text" href="../../LabTalk/Script/LabTalk-Supported_Functions.html">built-in functions</a> under the <b> Function</b> menu, which can be directly used in the expression. The <b>Search and Insert Functions</b> dialog can be used to search for built-in functions.</li>
<li> You can also <a href="../../UserGuide/UserGuide/Create_a_User_Defined_Function_for_Set_Column_Values.html" title="UserGuide:Create a User Defined Function for Set Column Values">create a User-Defined Function</a> yourself.</li>
<li> If you use the new simplified column notation in a function with string parameter, such as <a class="external text" href="../../LabTalk/LabTalk/Token_(function).html">Token</a>, you should use double quote instead of single quote.</li>
<li> The letters <b>i</b> and <b>j</b> are reserved <a class="external text" href="../../LabTalk/LabTalk/System_Variables.html#X.2C_Y.2C_Z.2C_I.2C_J.2C_E.2C_T.2C_Count">system variables</a> that store the current row index and column index, respectively. If you want to fill the column with row numbers or column index numbers, you can directly input <b>i</b> or <b>j</b> in <b>Column Formula</b>.</li>
<li> When using <b>i</b> and <b>j</b> in your Column Formula (or in an <a href="../../UserGuide/UserGuide/Displaying_Supporting_Data_in_Worksheet_Header_Rows.html#F.28x.29.3D" title="UserGuide:Displaying Supporting Data in Worksheet Header Rows">F(x)= cell</a>), you must refer to them using lowercase letters to prevent conflict with column short names.</li>
<li> You can use LabTalk's <a class="external text" href="../../LabTalk/LabTalk/Operators.html#Conditional_Operator_.28.3F:.29">Conditional operator</a> to fill a column or range. For example (when the 4th column is the target), you can input <b>col(3)==1?col(1):col(2)</b> in <b>Column Formula</b> to either copy the values of the first column or the second column according to the values in the third column.</li>
<li> The <b>{}</b> notation can be used in <b>Column Formula</b> to fill the selected column(s) with a series of equi-spaced numbers. </li></ul>
<dl><dd><ul><li> <b>{begin:step:end}</b> fills the column(s) with numbers beginning at <b>begin</b>, ending at <b>end</b> and incrementing by <b>step</b>. </li>
<li> <b>{begin:end}</b> fills the column(s) with numbers beginning at <b>begin</b>, ending at <b>end</b> and incrementing by <b>1</b>.</li></ul></dd></dl>
<ul><li> Data from other books and sheets can be accessed in several ways:</li></ul>
<dl><dd><ul><li> Using <a href="../../UserGuide/UserGuide/Quick_Start_SetColumnValues.html#Column_Formula_Examples" title="UserGuide:Quick Start SetColumnValues">direct references</a> to, for instance, [Book3]Sheet1!C (column) or [Book3]Sheet1!C1 (cell).</li>
<li> <a href="../../UserGuide/UserGuide/Menu_Options_and_Dialog_Controls.html#Variables_Menu" title="UserGuide:Menu Options and Dialog Controls">The Variables menu</a>.</li>
<li> By directly typing LabTalk <a class="external text" href="../../LabTalk/LabTalk/String_Substitution.html#Calculation_Involving_Datasets_from_Another_Sheet">substitution notation</a> in the formula edit box. </li></ul></dd></dl>
<ul><li> When setting values for Col(i), you can type in expression directly, rather than type in equation like "Col(i)= ..." in the formula.</li>
<li> Expressions feature syntax-coloring: <a class="external text" href="../../LabTalk/Script/LabTalk-Supported_Functions.html">LabTalk functions</a> are <b>Wine</b>, <a href="../../UserGuide/UserGuide/Worksheet_Column_and_Cell_Range_Naming_Conventions.html#Origin_worksheet_column_naming_conventions" title="UserGuide:Worksheet Column and Cell Range Naming Conventions">column Short Names</a> are <b>Red</b> and <a class="external text" href="../../LabTalk/LabTalk/Data_Types_and_Variables.html#Variables">LabTalk variables</a> are <b>Navy</b>.</li></ul>
<h2><a name="Add_Expressions_only_in_Column_Formula"></a><span class="mw-headline">Add Expressions only in <i>Column Formula</i></span></h2>
<p>You can add a single-line expression in the <b>Column Formula</b> edit box and leave the <b>Before Formula Scripts</b> panel empty. The expression in the <b>Column Formula</b> edit box can include built-in functions and user-defined functions. The following example shows how these functions can be used. 
</p><p><b>Example 1:</b>
</p>
<ol><li>Create a new workbook. </li>
<li>Highlight column A. Right-click on it and select <b>Fill With: Row Numbers</b>.</li>
<li>Highlight column B and right-click on it to select <b>Set Column Values</b> to open the <b>Set Values</b> dialog. Select <b>Function: Trigonometric/Hyperbolic: Cos(x)</b> to add <b>cos(x)</b> to the <b>Column Formula</b> edit box. Highlight the "x" variable in the formula and from the Set Values menu, select <b>Col(A): Col(A)</b> . The expression now reads <b>cos(A)</b>. Click the <b>OK</b> and the column is filled with values calculated by taking the cosine of each column A value.</li></ol>
<h2><a name="Add_Expressions_only_in_Before_Formula_Scripts"></a><span class="mw-headline">Add Expressions only in <i>Before Formula Scripts</i></span></h2>
<p>You can input multi-line LabTalk scripts in the <b>Before Formula Scripts</b> edit box and leave the<b> Column Formula</b> edit box empty. In addition to the built-in functions or user-defined functions, any other LabTalk scripts are supported here. So you can use range variables, string variables, loops, and LabTalk accessible X-Functions. 
</p><p>The following example will get the same results as Example 1.
</p><p><b>Example 2:</b>
</p>
<ol><li>Create a new workbook. </li>
<li>Highlight column A and right-click on it to select <b>Fill Column with: Row Numbers</b>. </li>
<li>Highlight column B and right-click on it to select <b>Set Column Values</b> to open the <b>Set Values</b> dialog. </li>
<li>In <b>Before Formula Scripts</b>, enter <b>Col(B)=cos(Col(A))</b>  and click the <b>OK</b> button to generate the data. </li></ol>
<p>The following example will load a sample expression which contains multi-line scripts for normalizing data.
</p><p><b>Example 3</b>
</p>
<ol><li>Create a new workbook. </li>
<li>Highlight column A. Right-click on it and select <b>Fill Column with: Row Numbers</b> from the short-cut menu. </li>
<li>Right-click on column A again and select  <b>Set Column Values</b> from the short-cut menu to open the <b>Set Values</b> dialog. </li>
<li>Select <b>Formula: Load Samples: Normalize column to (0, 1)</b> from the menu of the <b>Set Values</b> dialog to load scripts in the <b>Before Formula Scripts</b>. Then click the <b>OK</b> button to normalize the data. </li></ol>
<table class="note">

<tr>
<td>
<p><b>Note:</b>  Each line of LabTalk script in the <b>Before Formula Scripts</b> panel should be terminated with a semicolon.  
</p>
</td></tr></table>
<p><br />
<b>Example 4</b>
</p>
<ol>
<li> Create a new workbook.</li>
<li>Click the <b>Import Wizard</b> button <a  class="image"><img alt="Button Import Wizard.png" src="../images/Entering_Expressions_in_the_Set_Column_Dialog/Button_Import_Wizard.png?v=1807" width="23"  /></a> to open the dialog.</li>
<li>Under <b>Data Source</b>, select the file <i>\Samples\Graphing\Waterfall.dat</i>. Click <b>Finish</b> to import the data.
<li>Activate the worksheet, click the <b>Add New Columns</b> button <a  class="image"><img alt="Button Add New Columns.png" src="../images/Entering_Expressions_in_the_Set_Column_Dialog/Button_Add_New_Columns.png?v=23250" width="22"  /></a>. Scroll to the end of the worksheet and note column <b>DW(Y)</b>.</li> 
<li>Hightlight this column <b>DW(Y)</b>, right-click and select <b>Set Column Values</b> from the short-cut menu to open the Set Values dialog.</li>
<li>Input the following script into the <b>Before Formula Scripts</b> box.</li>
<pre class="lt" style="font-family:monospace;">range r1 <span style="color: #000080;">=</span> col<span style="color: #000000;">&#40;</span>DW<span style="color: #000000;">&#41;</span>;   <span style="color: #008000;">//  Set range variable to the added column</span>
r1 <span style="color: #000080;">=</span> wcol<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>;   <span style="color: #008000;">// Set initial value of the range</span>
int nc <span style="color: #000080;">=</span> wks.<span style="color: #000080;">ncols</span>;   <span style="color: #008000;">// Retrieve the total number of the columns</span>

<span style="color: #008000;">// Loop over all y columns to sum them up</span>
for<span style="color: #000000;">&#40;</span>page.<span style="color: #000080;">v1</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span>; page.<span style="color: #000080;">v1</span><span style="color: #000080;">&lt;=</span> nc<span style="color: #000080;">-</span><span style="color: #0000dd;">1</span> &#160;; page.<span style="color: #000080;">v1</span><span style="color: #000080;">+</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
  range rY <span style="color: #000080;">=</span> wcol<span style="color: #000000;">&#40;</span>page.<span style="color: #000080;">v1</span><span style="color: #000000;">&#41;</span>;
  r1 <span style="color: #000080;">+</span><span style="color: #000080;">=</span> rY;
<span style="color: #000000;">&#125;</span>

r1 <span style="color: #000080;">=</span> r1<span style="color: #000080;">/</span><span style="color: #000000;">&#40;</span>nc<span style="color: #000080;">-</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Calculate the average of y columns</span></pre>
<li>Click <b>OK</b> to apply. The average of all y columns is calculated and input into column <b>DW(Y)</b>.</li>
</ol>
<h2><a name="Add_Expressions_in_both_Column_Formula_and_Before_Formula_Scripts"></a><span class="mw-headline">Add Expressions in both <i>Column Formula</i> and <i>Before Formula Scripts</i></span></h2>
<p>Often, we need to enter scripts in both the <b>Column Formula</b> edit box and the <b>Before Formula Scripts</b> panel. For example, you can define range variables in <b>Before Formula Scripts</b> and then use them in <b>Column Formula</b>. 
</p><p><b>Example 5:</b>
</p>
<ol><li>Create a new project. There should be a empty workbook named "Book1".</li>
<li>Highlight column A. Right-click and select <b>Fill Column With: Row Numbers</b> from the short-cut menu.</li>
<li>Highlight column B. Right-click and  select <b>Fill Column With: Normal Random Numbers</b> from the short-cut menu.</li>
<li>Create another workbook named "Book2".</li>
<li>Highlight column A in Book2. Right-click and select <b>Fill Column With: Row Numbers</b>. </li>
<li>Highlight column B in this workbook. Right-click and select <b>Set Column Values</b> from the short-cut menu to open the <b>Set Values</b> dialog. </li>
<li>Now we insert two range variables which point to the columns in <b>Book1</b>. Select <b>Variables: Add Range Variables...</b> from the menu of the <b>Set Values</b> dialog. The <b>Range Browser</b> appears. Choose two ranges in the dialog as the following screenshot shows (make sure that <b>List Columns</b> is set to <b>in Current Project</b>):
<dl><dd><dl><dd><a  class="image"><img alt="SetColumnValue2.png" src="../images/Entering_Expressions_in_the_Set_Column_Dialog/SetColumnValue2.png?v=47216" width="704"  /></a></dd></dl></dd>
<dd>Click <b>OK</b> to return to the <b>Set Values</b> dialog.</dd></dl></li>
<li>Enter <b>r1+r2</b> into <b>Column Formula</b>. The <b>Set Values</b> dialog should look like:
<dl><dd><dl><dd><a  class="image"><img alt="SetColumnValue3.png" src="../images/Entering_Expressions_in_the_Set_Column_Dialog/SetColumnValue3.png?v=47217" width="427"  /></a></dd></dl></dd></dl></li>
<li>Click the <b>OK</b> button to generate data for column B. Each element in column B should be the sum of the elements in the corresponding row in Book1.
<dl><dd><dl><dd><a  class="image"><img alt="SetColumnValue4.png" src="../images/Entering_Expressions_in_the_Set_Column_Dialog/SetColumnValue4.png?v=47218" width="404"  /></a></dd></dl></dd></dl></li></ol>
<p><b>Example 6:</b>
</p><p>This is an example to show how to calculate the integral at each given T value using both <a class="external text" href="../../LabTalk/LabTalk/Integral_(function).html">integral function</a> and <a class="external text" href="../../LabTalk/LabTalk/Functions.html#User-Defined_Functions">User Defined function</a>.
</p>
<ol>
<li>Create a new Book.
<li>Set column A <b>Long Name</b> as <i>T</i> and set formula for Column A using the formula below:
<pre class="lt" style="font-family:monospace;">data<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">10</span>,<span style="color: #0000dd;">0.5</span><span style="color: #000000;">&#41;</span></pre>
<li>Set column B <b>Long Name</b> as <i>Integral</i>, highlight column B and right click to select <b>Set Column Values</b> to open dialog.
<li>Input integrand function as shown below in <b>Before Formula Scripts</b> and integral expression in <b>Col(B)=</b> edit box as shown below:<br />
<dl><dd><dl><dd><a  class="image"><img alt="SetFunValues5.png" src="../images/Entering_Expressions_in_the_Set_Column_Dialog/SetFunValues5.png?v=69189" width="492"  /></a></dd></dl></dd></dl>
<li>Click <b>OK</b> to apply. The calculated integral is shown below:
<dl><dd><dl><dd><a  class="image"><img alt="SetFunValues6.png" src="../images/Entering_Expressions_in_the_Set_Column_Dialog/SetFunValues6.png?v=66242" width="403"  /></a></dd></dl></dd></dl>
</ol>
<p>The <b>Before Formula Scripts</b> is also provided below:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Define Integrand</span>
function double Myintg<span style="color: #000000;">&#40;</span>double x, double T<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
<span style="color: #008000;">//Define constants</span>
      Double h <span style="color: #000080;">=</span> <span style="color: #0000dd;">1.23</span><span style="color: #000080;">*</span><span style="color: #0000dd;">10</span><span style="color: #000080;">^</span><span style="color: #000000;">&#40;</span><span style="color: #000080;">-</span><span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span>; 
      Double k <span style="color: #000080;">=</span> <span style="color: #0000dd;">8.61</span><span style="color: #000080;">*</span><span style="color: #0000dd;">10</span><span style="color: #000080;">^</span><span style="color: #000000;">&#40;</span><span style="color: #000080;">-</span><span style="color: #0000dd;">5</span><span style="color: #000000;">&#41;</span>;
 
      return <span style="color: #0000dd;">1</span><span style="color: #000080;">/</span><span style="color: #000000;">&#40;</span>exp<span style="color: #000000;">&#40;</span>h<span style="color: #000080;">*</span>x<span style="color: #000080;">/</span><span style="color: #000000;">&#40;</span>k<span style="color: #000080;">*</span>T<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">-</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>






