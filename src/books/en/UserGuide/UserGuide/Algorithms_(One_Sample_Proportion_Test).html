<h1 class="firstHeading">17.3.7.2 Algorithms (One Sample Proportion Test)</h1><p class='urlname' style='display: none'>One-Prop-algorithm</p>
<p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Hypotheses"><span class="tocnumber">1</span> <span class="toctext">Hypotheses</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Normal_approximation"><span class="tocnumber">2</span> <span class="toctext">Normal approximation</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#P_Value"><span class="tocnumber">2.1</span> <span class="toctext">P Value</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Confidence_Interval"><span class="tocnumber">2.2</span> <span class="toctext">Confidence Interval</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="#Binomial_Test"><span class="tocnumber">3</span> <span class="toctext">Binomial Test</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#Exact_P_value"><span class="tocnumber">3.1</span> <span class="toctext">Exact P_value</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Exact_Confidence_Interval"><span class="tocnumber">3.2</span> <span class="toctext">Exact Confidence Interval</span></a></li>
</ul>
</li>
</ul>
</div>

<h3><a name="Hypotheses"></a><span class="mw-headline">Hypotheses</span></h3>
<p>Let <img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-a3904f143141153cc70766aff62f962c.png?v=0" title="n\!" alt="n\!" class="tex"/> be the sample size and <img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-2fccdd06e4c2b79e4f65f2f532fdf9ec.png?v=0" title="n_{1}\!" alt="n_{1}\!" class="tex"/>be the number of events or successes. Then the sample proportion <img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-059dd42e5c1758bf5ac9b735c33d9897.png?v=0" title="\tilde{p}\!" alt="\tilde{p}\!" class="tex"/> can be expressed:<img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-74b78268fb8edf8f3c550eb3a02a9da4.png?v=0" title="\tilde{p}=\frac{n_{1}}{n}" alt="\tilde{p}=\frac{n_{1}}{n}" class="tex"/>
</p><p>Let <img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-2225a33c170f19586f1ee1de06e36962.png?v=0" title="p\!" alt="p\!" class="tex"/> be the sample proportion and the <img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-98a2a58d47208a196dce8aebf1187a7b.png?v=0" title="p_{0}\!" alt="p_{0}\!" class="tex"/> is the hypothetical proportion, this function tests the hypotheses:
</p><p><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-e6439f7e3ffa3e9be5825528b7bd98ca.png?v=0" title="H_0:p=p_{0}\!" alt="H_0:p=p_{0}\!" class="tex"/> vs  <img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-001ce83ba7f68612061a4f6535289a14.png?v=0" title="H_1:p \ne p_{0}\!" alt="H_1:p \ne p_{0}\!" class="tex"/>, for a two-tailed test.
</p><p><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-77393df8f4ba31f7392f313ebd9a6a01.png?v=0" title="H_0: p\ge p_{0}\!" alt="H_0: p\ge p_{0}\!" class="tex"/> vs <img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-2efa1b2d6fe683e736fc4a3c72f338d0.png?v=0" title="H_1:p &lt; p_{0}\!" alt="H_1:p &lt; p_{0}\!" class="tex"/>, for a lower-tailed test.
</p><p><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-9a14db95eaad70a65f7cde4742e6cfec.png?v=0" title="H_0:p\le p_{0}\!" alt="H_0:p\le p_{0}\!" class="tex"/> vs <img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-e676757568c1548bc0a04e938d5970f4.png?v=0" title="H_1:p &gt; p_{0}\!" alt="H_1:p &gt; p_{0}\!" class="tex"/>, for an upper-tailed test.
</p>
<h3><a name="Normal_approximation"></a><span class="mw-headline">Normal approximation</span></h3>
<h4><a name="P_Value"></a><span class="mw-headline">P Value</span></h4>
<p>When <img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-949e1609f9a8555500d11bfd80fd252f.png?v=0" title="n_{1}\ge10\!" alt="n_{1}\ge10\!" class="tex"/> and <img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-6dad1a4a3be6aa277f8d81cab11744ca.png?v=0" title="n-n_{1}\ge10\!" alt="n-n_{1}\ge10\!" class="tex"/>, we can compute a p-value using a normal approximation of a binomial distribution. To perform the test, compute the <img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-814b9f64b478b6caf94e723a0e6814c5.png?v=0" title="z\!" alt="z\!" class="tex"/> and <img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-c619dfb3f0ada810733c791d3e461ade.png?v=0" title=" p_{value}\!" alt=" p_{value}\!" class="tex"/> value by:
</p><p><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-5e43bb1a14561bd36062237b108f17a1.png?v=0" title="z=\frac{\tilde{p}-p_{0}}{\sqrt{\frac{p_{0}(1-p_{0})}{n}}}\!" alt="z=\frac{\tilde{p}-p_{0}}{\sqrt{\frac{p_{0}(1-p_{0})}{n}}}\!" class="tex"/>
</p><p><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-5333752eab96d7d78da0ddc4e3d9da72.png?v=0" title="p_{value}=2p(Z&gt;|z||p=p_{0})\!" alt="p_{value}=2p(Z&gt;|z||p=p_{0})\!" class="tex"/>,for two tailed test
</p><p><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-23cc99079273c727425f7f2b249939fc.png?v=0" title="p_{value}=p(Z\le z|p=p_{0})\!" alt="p_{value}=p(Z\le z|p=p_{0})\!" class="tex"/>,for upper tailed test
</p><p><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-b454c9285e4a909cd7a23c7c233ca221.png?v=0" title="p_{value}=p(Z\ge z|p=p_{0})\!" alt="p_{value}=p(Z\ge z|p=p_{0})\!" class="tex"/>for lower tailed test
</p>
<h4><a name="Confidence_Interval"></a><span class="mw-headline">Confidence Interval</span></h4>
<p>confidence level is equal to <img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-378df00d12056b404d7d02aef9d8650b.png?v=0" title="1-\alpha" alt="1-\alpha" class="tex"/>, the confidence interval for the sample proportion can be generated by:
</p>
<table class="simple">
<tr>
<th>Null Hypothesis
</th>
<th>Confidence Interval
</th></tr>
<tr>
<td><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-e6439f7e3ffa3e9be5825528b7bd98ca.png?v=0" title="H_0:p=p_{0}\!" alt="H_0:p=p_{0}\!" class="tex"/>
</td>
<td><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-45e3a879d9177162292d8b92c1e74936.png?v=0" title="\left[\tilde{p}- Z_{\frac{\alpha}{2}}\sqrt{\frac{\tilde{p}(1-\tilde{p})}{n}}, \tilde{p}+ Z_{\frac{\alpha}{2}}\sqrt{\frac{\tilde{p}(1-\tilde{p})}{n}}\right]" alt="\left[\tilde{p}- Z_{\frac{\alpha}{2}}\sqrt{\frac{\tilde{p}(1-\tilde{p})}{n}}, \tilde{p}+ Z_{\frac{\alpha}{2}}\sqrt{\frac{\tilde{p}(1-\tilde{p})}{n}}\right]" class="tex"/>
</td></tr>
<tr>
<td><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-77393df8f4ba31f7392f313ebd9a6a01.png?v=0" title="H_0: p\ge p_{0}\!" alt="H_0: p\ge p_{0}\!" class="tex"/>
</td>
<td><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-b1f8f1563d875c1b9ad0781525e22d66.png?v=0" title="\left[\tilde{p}- Z_{\alpha}\sqrt{\frac{\tilde{p}(1-\tilde{p})}{n}}, 1\right]" alt="\left[\tilde{p}- Z_{\alpha}\sqrt{\frac{\tilde{p}(1-\tilde{p})}{n}}, 1\right]" class="tex"/>
</td></tr>
<tr>
<td><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-9a14db95eaad70a65f7cde4742e6cfec.png?v=0" title="H_0:p\le p_{0}\!" alt="H_0:p\le p_{0}\!" class="tex"/>
</td>
<td><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-ddaa6748a4f7d5d7ec97a10b6094c9ab.png?v=0" title="\left[0, \tilde{p}+ Z_{\alpha}\sqrt{\frac{\tilde{p}(1-\tilde{p})}{n}}\right]" alt="\left[0, \tilde{p}+ Z_{\alpha}\sqrt{\frac{\tilde{p}(1-\tilde{p})}{n}}\right]" class="tex"/>
</td></tr></table>
<h3><a name="Binomial_Test"></a><span class="mw-headline">Binomial Test</span></h3>
<h4><a name="Exact_P_value"></a><span class="mw-headline">Exact P_value</span></h4>
<p>In Origin, the exact test for one proportion is based on the Binomial Test .
</p><p><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-77393df8f4ba31f7392f313ebd9a6a01.png?v=0" title="H_0: p\ge p_{0}\!" alt="H_0: p\ge p_{0}\!" class="tex"/>  <img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-236283f94349ab58667bb20e23c48c62.png?v=0" title="P_{value}=p(X\le n_{1}|p_0)" alt="P_{value}=p(X\le n_{1}|p_0)" class="tex"/>
</p><p><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-9a14db95eaad70a65f7cde4742e6cfec.png?v=0" title="H_0:p\le p_{0}\!" alt="H_0:p\le p_{0}\!" class="tex"/>   <img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-1b70aa97ad67ad73ec03a8b86eaa5378.png?v=0" title="P_{value}=p(X\ge n_{1}|p_0)" alt="P_{value}=p(X\ge n_{1}|p_0)" class="tex"/>
</p><p><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-e6439f7e3ffa3e9be5825528b7bd98ca.png?v=0" title="H_0:p=p_{0}\!" alt="H_0:p=p_{0}\!" class="tex"/>:
</p><p>Let <img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-ed8fc8393999c826e034ba7eda3820a5.png?v=0" title="M=n*p_0\!" alt="M=n*p_0\!" class="tex"/>,
</p><p>when <img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-d71e7a494c74e9f4dc1befc9fc3f5985.png?v=0" title="n_1=M\!" alt="n_1=M\!" class="tex"/>   <img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-3b7c3f8394db8c7ddbd64c20296e4816.png?v=0" title="P_{value}=1\!" alt="P_{value}=1\!" class="tex"/>
</p><p>when <img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-5dc733247724ff9e5663466f3ba1aa52.png?v=0" title="n_1\le M\!" alt="n_1\le M\!" class="tex"/> <img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-a279ad1020d1230bcaca3b34763a1871.png?v=0" title="P_{value}=P(X\le n_1)+P(X\ge n-y+1)" alt="P_{value}=P(X\le n_1)+P(X\ge n-y+1)" class="tex"/>, where y is the count for z such that <img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-972f03c6782e959c6296bd6454b4c3c1.png?v=0" title="P(z)\le p(n_1)" alt="P(z)\le p(n_1)" class="tex"/> and <img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-91f2fe6954e96740db5e5363be3214fc.png?v=0" title="n\ge z\ge \left \lfloor M \right \rfloor+1" alt="n\ge z\ge \left \lfloor M \right \rfloor+1" class="tex"/>
</p><p>when <img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-33889b4adcda5ccfd42a486618a2e393.png?v=0" title="n_1\ge M\!" alt="n_1\ge M\!" class="tex"/> <img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-6d9ce680825cccb7345526c42f52d588.png?v=0" title="P_{value}=P(X\le y-1)+P(X\ge n_1)" alt="P_{value}=P(X\le y-1)+P(X\ge n_1)" class="tex"/>, where y is the count  for z such that <img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-972f03c6782e959c6296bd6454b4c3c1.png?v=0" title="P(z)\le p(n_1)" alt="P(z)\le p(n_1)" class="tex"/> and <img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-63f49135aa0df4deb4d2af7319868d98.png?v=0" title="0\le z\le \left \lfloor M \right \rfloor" alt="0\le z\le \left \lfloor M \right \rfloor" class="tex"/>
</p>
<h4><a name="Exact_Confidence_Interval"></a><span class="mw-headline">Exact Confidence Interval</span></h4>
<p>Exact Confidence interval:
confidence levels is <img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-378df00d12056b404d7d02aef9d8650b.png?v=0" title="1-\alpha" alt="1-\alpha" class="tex"/>
</p>
<table class="simple">
<tr>
<th>Null Hypothesis
</th>
<th>Confidence Interval
</th></tr>
<tr>
<td><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-e6439f7e3ffa3e9be5825528b7bd98ca.png?v=0" title="H_0:p=p_{0}\!" alt="H_0:p=p_{0}\!" class="tex"/>
</td>
<td>
<p><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-1f8c9b67e8071ca56485f823a54f73b7.png?v=0" title="\left[QBETA_{(1 - \alpha/2, n_1 + 1, n - n_1)}, QBETA_{(\alpha/2, n_1, n - n_1 + 1)}\right]" alt="\left[QBETA_{(1 - \alpha/2, n_1 + 1, n - n_1)}, QBETA_{(\alpha/2, n_1, n - n_1 + 1)}\right]" class="tex"/>
</p>
</td></tr>
<tr>
<td><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-77393df8f4ba31f7392f313ebd9a6a01.png?v=0" title="H_0: p\ge p_{0}\!" alt="H_0: p\ge p_{0}\!" class="tex"/>
</td>
<td>
<p><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-e36a48eef8fc383a8d311fc6fdcdae83.png?v=0" title="\left[QBETA_{(1 - \alpha, n_1 + 1, n - n_1)}, 1\right]" alt="\left[QBETA_{(1 - \alpha, n_1 + 1, n - n_1)}, 1\right]" class="tex"/>
</p>
</td></tr>

<tr>
<td><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-9a14db95eaad70a65f7cde4742e6cfec.png?v=0" title="H_0:p\le p_{0}\!" alt="H_0:p\le p_{0}\!" class="tex"/>
</td>
<td>
<p><img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-94e921d28056ad0a1a1a0b9697535d58.png?v=0" title="\left[0, QBETA_{(\alpha, n_1, n - n_1 + 1)}\right]" alt="\left[0, QBETA_{(\alpha, n_1, n - n_1 + 1)}\right]" class="tex"/>
</p>
</td></tr></table>
<p>where <img src="../images/Algorithms_(One_Sample_Proportion_Test)/math-bac83f0f16753d22b8473eaef9e3ed0c.png?v=0" title="QBETA" alt="QBETA" class="tex"/> denotes the quantile function of Beta distribution.
</p>





