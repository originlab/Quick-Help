<h1 class="firstHeading">17.7.3.1 The Hierarchical Cluster Analysis Dialog Box</h1><p class='urlname' style='display: none'>HCA-Dialog</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Dialog_Theme"><span class="tocnumber">1</span> <span class="toctext">Dialog Theme</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Recalculate"><span class="tocnumber">2</span> <span class="toctext">Recalculate</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Input"><span class="tocnumber">3</span> <span class="toctext">Input</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Settings"><span class="tocnumber">4</span> <span class="toctext">Settings</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Quantities"><span class="tocnumber">5</span> <span class="toctext">Quantities</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Plot"><span class="tocnumber">6</span> <span class="toctext">Plot</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Output_Settings"><span class="tocnumber">7</span> <span class="toctext">Output Settings</span></a></li>
</ul>
</div>

<p><br />
</p>
<h2><a name="Dialog_Theme"></a><span class="mw-headline">Dialog Theme</span></h2>
<p>Load or save <a href="../../UserGuide/UserGuide/Dialog_Themes.html" title="UserGuide:Dialog Themes">Dialog Theme</a>. Additionally, <a class="external text" href="../../XFunction/X-Function/Calling_X-Functions_from_Script.html#Generate_Script_from_X-Function_Dialog">generate script</a> for the X-Function using the current dialog box settings.
</p>
<h2><a name="Recalculate"></a><span class="mw-headline">Recalculate</span></h2>
<p>Set the <a href="../../UserGuide/UserGuide/Recalculating_Analysis_Results.html" title="UserGuide:Recalculating Analysis Results"><b>Recalculate</b> mode</a>.
</p>
<h2><a name="Input"></a><span class="mw-headline">Input</span></h2>
<table class="dialogcontroltable">

<tr>
<th>Variables
</th>
<td>Select data for the <b>Hierarchical Cluster Analysis</b>. Data in each column corresponds to a variable and each row to an observation.
</td></tr>
<tr>
<th>Observation Labels
</th>
<td>Select labels for observations. If labels are chosen, they will be shown as X axis ticks in the dendrogram. Enabled only when the objects to cluster are observations. The label column will be set as categorical if Text column.
</td></tr></table>
<h2><a name="Settings"></a><span class="mw-headline">Settings</span></h2>
<p>Specify the settings for the <b>Hierarchical Cluster Analysis</b>.
</p>
<table class="dialogcontroltable">

<tr>
<th>Cluster
</th>
<td>Specify the type of objects to cluster.
<ul><li> <b>Observations</b></li></ul>
<dl><dt><dl><dd>Cluster observations. Rows in the input data are classified into groups.</dt></dl></dd></dl>
<ul><li> <b>Variables</b></li></ul>
<dl><dt><dl><dd>Cluster variables. Columns in the input data are classified into groups.</dt></dl></dd></dl>
<p><b>Note</b> that for different types of objects to cluster, available distance types are also different.
</p>
</td></tr>
<tr>
<th>Cluster Method
</th>
<td>Select the linkage method to calculate the distance between a cluster and a new cluster. Six methods are available.
<ul><li> <b>Nearest neighbor</b></li></ul>
<dl><dt><dl><dd>The minimum of two distances between a cluster and two clusters merged to a new cluster. Also called single linkage.</dt></dl></dd></dl>
<ul><li> <b>Furthest neighbor</b></li></ul>
<dl><dt><dl><dd>The maximum  of distances between a cluster and two clusters merged to a new cluster. Also called complete linkage.</dt></dl></dd></dl>
<ul><li> <b>Group average</b></li></ul>
<dl><dt><dl><dd>The mean of two distances between a cluster and two clusters merged to a new cluster.</dt></dl></dd></dl>
<ul><li> <b>Centroid</b></li></ul>
<dl><dt><dl><dd>Clusters are produced that maximize the distance between the centers of clusters.</dt></dl></dd></dl>
<ul><li> <b>Median</b></li></ul>
<dl><dt><dl><dd>The median distance between an item in one cluster and an item in the other cluster.</dt></dl></dd></dl>
<ul><li> <b>Ward</b></li></ul>
<dl><dt><dl><dd>Clusters are produced that minimize the within-cluster variance.</dt></dl></dd></dl>
<p><br />To learn more about linkage methods, see <a href="../../UserGuide/UserGuide/Algorithm_(Hierarchical_Cluster_Analysis).html#Linkage_Method" title="UserGuide:Algorithm (Hierarchical Cluster Analysis)">the algorithm of linkage methods</a>.
</p>
</td></tr>
<tr>
<th>Distance Type
</th>
<td>Select a distance type in the <b>Hierarchical Cluster Analysis</b>.
<p>For observations to cluster, three methods are available:
</p>
<ul><li> <b>Euclidean</b></li></ul>
<dl><dt><dl><dd> The square root of the sum of the squared differences between two observations.</dt></dl></dd></dl>
<ul><li> <b>Squared Euclidean</b></li></ul>
<dl><dt><dl><dd> The sum of the squared differences between two observations.</dt></dl></dd></dl>
<ul><li> <b>City block</b></li></ul>
<dl><dt><dl><dd> The sum of the absolute differences between two observations. Also known as Manhattan distance.</dt></dl></dd></dl>
<ul><li> <b>Cosine</b></li></ul>
<dl><dt><dl><dd> The difference between 1 and the cosine coefficient of two observations. Cosine coefficient is the cosine of the angle between two vectors.</dt></dl></dd></dl>
<ul><li> <b>Pearson correlation</b></li></ul>
<dl><dt><dl><dd> The difference between 1 and the correlation of two observations.</dt></dl></dd></dl>
<ul><li> <b>Jaccard</b></li></ul>
<dl><dt><dl><dd> The difference between 1 and the Jaccard coefficient of two observations. For binary data, Jaccard coefficient equals the ratio of sizes of intersection and union of two observations.</dt></dl></dd></dl>
<p><br />For variables to cluster, two methods are available. Missing values are excluded in a pairwise manner to calculate the correlation.
</p>
<ul><li> <b>Correlation</b></li></ul>
<dl><dt><dl><dd> The difference between 1 and the correlation of two variables.</dt></dl></dd></dl>
<ul><li> <b>Absolute correlation</b></li></ul>
<dl><dt><dl><dd> The difference between 1 and the absolute correlation of two variables.</dt></dl></dd></dl>
<p><br />To learn how to calculate distance, see <a href="../../UserGuide/UserGuide/Algorithm_(Hierarchical_Cluster_Analysis).html#Distance_Matrix" title="UserGuide:Algorithm (Hierarchical Cluster Analysis)">the distance algorithm</a>.
</p>
</td></tr>
<tr>
<th>Standardize Variables
</th>
<td>Specify the method to standardize variables. Available only when objects to cluster are observations.
<ul><li> <b>None</b></li></ul>
<dl><dt><dl><dd>Variables are not standardized.</dt></dl></dd></dl>
<ul><li> <b>Z scores (standardize to N(0, 1))</b></li></ul>
<dl><dt><dl><dd>Variables are standardized with zero mean and unit standard deviation.</dt></dl></dd></dl>
<ul><li> <b>Normalize to (0,1)</b></li></ul>
<dl><dt><dl><dd>Variable are standardized in the range of 0 and 1.</dt></dl></dd></dl>
</td></tr>
<tr>
<th>Number of Clusters
</th>
<td>Specify the number of clusters. The value should be greater than 0 and no more than the number of effective observations (cluster observations) or variables (cluster variables).
</td></tr>
<tr>
<th>Find Clustroid by
</th>
<td>Specify the method to find the clustroid: the most/least representative variable/observation
<ul><li> <b>Sum of distances</b></li></ul>
<dl><dt><dl><dd> Find Clustroid using the sum of distances measured from all other observations/variables in the cluster. In a cluster, the most representative variable/observation would have the minimum <i>Sum of distances</i>; the least representative variable/observation would have the maximum <i>Sum of distances</i>.</dt></dl></dd></dl>
<ul><li> <b>Maximum distance</b></li></ul>
<dl><dt><dl><dd> Find Clustroid using the Maximum distance among all distances measured from other observations/variables in the cluster. In a cluster, the most representative variable/observation would have the smallest <i>Maximum distance</i>; the least representative variable/observation would have the biggest <i>Maximum distance</i>.</dt></dl></dd></dl>
<ul><li> <b>Sum of squares of distances</b></li></ul>
<dl><dt><dl><dd> Find Clustroid using the sum of the squares of distances measured from all other observations/variables in the cluster. In a cluster, the most representative variable/observation would have the minimum <i>Sum of squares of distances</i>; the least representative variable/observation would have the maximum <i>Sum of squares of distances</i>.</dt></dl></dd></dl>
</td></tr></table>
<h2><a name="Quantities"></a><span class="mw-headline">Quantities</span></h2>
<p>Specify the quantities to calculate for the <b>Hierarchical Cluster Analysis</b>. <b>Note</b> that descriptive statistics and cluster membership are included in the result of <b>Hierarchical Cluster Analysis</b> by default.
</p>
<table class="dialogcontroltable">

<tr>
<th>Dissimilarity Matrix
</th>
<td>Specify whether to output the distance matrix. For a large number of objects, the distance matrix will be shown in a sheet instead of the report.
</td></tr>
<tr>
<th>Cluster Stages
</th>
<td>Specify whether to output the cluster stages. In each stage two clusters are merged to a new cluster.
</td></tr>
<tr>
<th>Cluster Center
</th>
<td>Specify whether to calculate cluster centers. It is available only when objects to cluster are observations. When a standardization method is chosen in <b>Standardize Variables</b> of the <b>Settings</b> branch, cluster centers are calculated from standardized variables.
</td></tr>
<tr>
<th>Distance between Cluster Centers
</th>
<td>Specify whether to calculate the distances between cluster centers. It is available only when objects to cluster are observations.
</td></tr>
<tr>
<th>Distance between Observations and Clusters
</th>
<td>Specify whether to calculate the distance between each observation and cluster centers. It is available only when objects to cluster are observations.
</td></tr>
<tr>
<th>Clustroid Info
</th>
<td>Specify whether to list the most/least representative variable or observation.
</td></tr></table>
<h2><a name="Plot"></a><span class="mw-headline">Plot</span></h2>
<p>Specify whether and how to show the dendrogram.
</p>
<table class="dialogcontroltable">

<tr>
<th>Dendrogram
</th>
<td>Specify whether to show the dendrogram. Note that the default dendrogram can be exchanged for a more dynamic "Phylogenetic Tree" in which nodes and subtrees can be <a href="../../UserGuide/UserGuide/Interpreting_Results_of_Hierarchical_Cluster_Analysis.html#Dendrogram" title="UserGuide:Interpreting Results of Hierarchical Cluster Analysis">highlighted and swapped</a>.
</td></tr>
<tr>
<th>Show Y Axis with
</th>
<td>
<ul><li> <b>Distance</b></li></ul>
<dl><dt><dl><dd> Distance as computed by <a href="../../UserGuide/UserGuide/Algorithm_(Hierarchical_Cluster_Analysis).html#Cluster_Observations" title="UserGuide:Algorithm (Hierarchical Cluster Analysis)">Distance Type</a>.</dt></dl></dd></dl>
<ul><li> <b>Similarity</b></li></ul>
<dl><dt><dl><dd> Similarity is computed as 100*(1-d/dmax), where d is the distance, dmax is the maximum distance for all observations, i.e. the last distance calculation in the <b>Cluster Stages</b> table. If you have opted to plot a separate graph for each cluster (<b>Plot</b> tab &gt; <b>Show Dendrogram</b> button), then dmax is the maximum for all graphs.</dt></dl></dd></dl>
<p><a  class="image"><img alt="Hierarchical cluster dialog box image001.png" src="../images/The_Hierarchical_Cluster_Analysis_Dialog_Box/Hierarchical_cluster_dialog_box_image001.png?v=83003" width="611"  /></a>
</p>
</td></tr>
<tr>
<th>Show Dendrogram
</th>
<td>Specify whether to show the dendrogram in a single graph or in separate graphs for clusters. Enabled only when <b>Dendrogram</b> is checked.
<ul><li> <b>in a single graph</b></li></ul>
<dl><dt><dl><dd> Show the dendrogram in a single graph. Different clusters are shown in different colors.</dt></dl></dd></dl>
<ul><li> <b>in separate graphs for clusters</b></li></ul>
<dl><dt><dl><dd> Show the dendrogram in separate graphs for clusters. Each cluster is output to separate graph.</dt></dl></dd></dl>
</td></tr>
<tr>
<th>Orientation
</th>
<td>Specify the orientation of the dendrogram. Enabled only when <b>Dendrogram</b> is checked.
<ul><li> <b>Vertical</b></li></ul>
<dl><dt><dl><dd> Plot Dendrogram vertically.</dt></dl></dd></dl>
<ul><li> <b>Horizontal</b></li></ul>
<dl><dt><dl><dd> Plot Dendrogram horizontally.</dt></dl></dd></dl>
<ul><li> <b>Circular</b></li></ul>
<dl><dt><dl><dd> Plot circular Dendrogram </dt></dl></dd></dl>
</td></tr></table>
<h2><a name="Output_Settings"></a><span class="mw-headline">Output Settings</span></h2>
<p>Specify the destination of output results for the <b>Hierarchical Cluster Analysis</b>.
</p>
<table class="dialogcontroltable">

<tr>
<th>Cluster Report
</th>
<td>Specify the sheet for the <b>Hierarchical Cluster Analysis</b> report. The default value is a new sheet in the workbook of input data.
</td></tr>
<tr>
<th>Cluster Membership
</th>
<td>Specify the sheet for cluster membership and distance between observations and clusters. The default value is a new sheet in the workbook of input data.
</td></tr></table>
<p><br />
</p>





