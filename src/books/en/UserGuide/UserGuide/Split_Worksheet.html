<h1 class="firstHeading">4.4.7 Splitting Worksheet into New Sheets</h1><p class='urlname' style='display: none'>split-wks-into-sheets</p>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p><a  class="image"><img alt="SplitWorksheet.png" src="../images/Split_Worksheet/SplitWorksheet.png?v=71619" width="846"  /></a>
<br /><br />
Origin has a tool for splitting a worksheet into multiple worksheets. You can specify that every <i>n</i> columns be split into a new sheet; that every <i>n</i> rows be split into a new sheet; or that columns that share a column header row label be grouped into a new sheet. The <b>wsplit</b> dialog box uses the <a class="external text" href="../../XFunction/X-Function/Wsplit.html">wsplit</a> X-Function.
</p>
<h5><a name="To_Split_Your_Worksheet"></a><span class="mw-headline">To Split Your Worksheet</span></h5>
<ol><li> Activate the intended worksheet.</li>
<li> Click <b>Resturcture: Split Worksheet...</b> and open the <b>wsplit</b> dialog box.</li></ol>
<h2><a name="Dialog_Options"></a><span class="mw-headline">Dialog Options</span></h2>
<table class="dialogcontroltable">

<tr>
<th>Recalculate
</th>
<td>
<p>Specify the <a href="../../UserGuide/UserGuide/Recalculating_Analysis_Results.html" title="UserGuide:Recalculating Analysis Results">Recalculate Mode</a>.
</p>
<ul><li><b>None</b></li>
<li><b>Auto</b></li>
<li><b>Manual</b></li></ul>
</td></tr>
<tr>
<th>Input Worksheet
</th>
<td>
<p>The worksheet to be split. Note that starting with Origin 2017b, you can CTRL + select a column range to be split (no need to split the entire sheet).
</p><p>For help with range controls, see: <a class="external text" href="../../UserGuide/UserGuide/Specifying_Your_Input_Data.html">Specifying Your Input Data</a>
</p>
</td></tr>
<tr>
<th>Split Mode
</th>
<td>
<p>Determine how the worksheet is to be split:
</p>
<ul><li><b>By Number of Columns</b> 
<dl><dd>Every <i>n</i> columns will be split into a new worksheet. Specify <i>n</i> in the <b>By Number of Columns</b> box.</dd></dl></li>
<li><b>By Number of Rows</b> 
<dl><dd>Every <i>n</i> rows will be split into a new worksheet. Specify <i>n</i> in the <b>By Number of Rows</b> box.</dd></dl></li>
<li><b>By Column Label</b>
<dl><dd>Columns sharing a specified header row label will be split into a new worksheet. Specify <a href="../../UserGuide/UserGuide/Displaying_Supporting_Data_in_Worksheet_Header_Rows.html" title="UserGuide:Displaying Supporting Data in Worksheet Header Rows">the label-containing header row</a> in the <b>By Column Label</b> box.</dd></dl></li>
<li><b>By Reference Columns</b>
<dl><dd>Columns will be split into new worksheets by values or conditions in Reference Columns. Note that list order is important when splitting by values in multiple reference columns.</dd></dl></li></ul>
</td></tr>
<tr>
<th>Number of Columns
</th>
<td>Available when <b>Split Mode</b> = <b>By Number of Columns</b>. Specify every <i>n</i> columns to create a new worksheet (not available for <b>By Reference Columns</b>).
</td></tr>
<tr>
<th>Retain 1st N Columns
</th>
<td>Available when <b>Split Mode</b> = <b>By Number of Columns</b> or <b>By Column Label</b>. Specify first <i>n</i> columns of the source Worksheet to keep them in all split result sheet. And these first <i>n</i> columns are excluded from splitting <b>By Number of Columns</b> or <b>By Column Label</b>.
</td></tr>
<tr>
<th>Number of Rows
</th>
<td>Available when <b>Split Mode</b> = <b>By Number of Rows</b>. Specify every <i>n</i> rows to create a new worksheet (not available for <b>By Reference Columns</b>).
</td></tr>
<tr>
<th>Column Label
</th>
<td>Available when <b>Split Mode</b> = <b>By Column Label</b>. Specify the column label row for grouping columns into new worksheets.
</td></tr>
<tr>
<th>Reference Columns
</th>
<td>Available when <b>Split Mode</b> = <b>Reference Columns</b>. Specify column(s) containing grouping variable(s). <br />
<p>When multiple columns are chosen, list order determines how data are split. <br />
When single column is chosen, a further control <b>Split</b> drop-down list will show up to let you decide whether split the columns by values or other conditions(such as reference values jumping or turning).
</p>
</td></tr>
<tr>
<th>Split
</th>
<td>This control is only available for single reference column selected. Specify how to split the worksheet according to the selected reference column:
<ul><li><b>By Value</b>
<dl><dd>Split the worksheet rows according to the values in reference column. The rows with same value in reference column will be split and extracted into a new worksheet. Tolerance is allowed for numeric values. This is the default selection for the <b>Split</b> control of selected single reference column.</dd></dl></li>
<li><b>By Direction Change</b>
<dl><dd>Split the worksheet rows when the direction of the values in reference column changed, from ascending to descending, or vice versa.</dd></dl></li>
<li><b>By Direction Reset</b>
<dl><dd>Split the worksheet rows when the reference values finished going up/down and have been reset to the base. </dd></dl></li>
<li><b>By Value Change</b>
<dl><dd>Split the worksheet rows when the reference value changes. Tolerance is allowed for numeric values. Reference values will be used as identifier and set as <a href="../../UserGuide/UserGuide/Basic_Operations_on_Worksheet.html#Name_and_Notes" title="UserGuide:Basic Operations on Worksheet">sheet label</a> of each result sheet.</dd></dl></li></ul>
<p><a  class="image"><img alt="Split By Reference Columns.png" src="../images/Split_Worksheet/Split_By_Reference_Columns.png?v=86455" width="803"  /></a>
</p>
</td></tr>
<tr>
<th>Tolerance
</th>
<td>When you selected <b>Split Mode</b> = <b>Reference Columns</b> and <b>Split</b> = <b>By Value</b>/<b>By Value Change</b>, you can use this drop box to consider a tolerance when determine when determine if the numeric values change.
</td></tr>
<tr>
<th>Include Turning Point in
</th>
<td>When you selected <b>By Direction Change</b> for the <b>Split</b> control, you can use this drop box to decide how to deal with the turning points, to include them in the previous group or next group.
</td></tr>
<tr>
<th>Keep Reference Columns in Result
</th>
<td>Output Reference Column data with split results (applies to <b>By Reference Columns</b> only).
</td></tr>
<tr>
<th>Sort Result by Reference Columns
</th>
<td>Specify whether sort the split results rows by the reference values when you checked <b>Keep Reference Columns in Result</b>.
<p>This check box is only available for the Split control set to  <b>By Direction Change</b> or <b>By Direction Reset</b>. 
</p>
</td></tr>
<tr>
<th>Exclude Missing Value
</th>
<td>Exclude empty cells or cells containing Origin's missing value character (<b>"--"</b>), from split result (applies to <b>By Reference Columns</b> only).
</td></tr>
<tr>
<th>Copy Column Formula to Result
</th>
<td>If the source worksheet contains column formjula, control how to deal with the formula.
<ul><li><b>None</b>
<dl><dd>Do not copy the column formula</dd></dl></li>
<li><b>Copy and Execute</b>
<dl><dd>Copy column formula to the result sheets and execute it.</dd></dl></li>
<li><b>Copy Formula Text</b>
<dl><dd>Copy the text of column formula to the result sheets but not execute it. You will need to manually execute it later.</dd></dl></li></ul>
</td></tr>
<tr>
<th>Keep Source Worksheet
</th>
<td>Keep the source worksheet intact. Otherwise the source worksheet is deleted.
</td></tr>
<tr>
<th>Show Sparklines
</th>
<td>Show Sparklines for the columns in the output worksheets.
</td></tr>
<tr>
<th>Output Worksheet
</th>
<td>Specify output worksheet.
<p>For help with the range controls, see: <a class="external text" href="../../UserGuide/UserGuide/Output_Results.html">Output Results</a>
</p>
</td></tr>
<tr>
<th>Preset Result Sheet Name
</th>
<td>Available when <b>Split Mode</b> = <b>By Reference Columns</b> and <b>Split</b> = <b>By Value</b>:<br />
<p><br />
<b>%N: Long Name or Short Name of Reference Column</b> (e.g. <i>LongName</i>, <i>LongName</i>1, etc.)<br />
<b>%C: Dataset Name of Reference Column</b> (e.g. <i>Book1_A</i>, <i>Book1_A</i>1, etc.)<br />
<b>%M: Comment of Reference Column</b> (e.g. <i>Comments</i>, <i>Comments</i>1, etc.)<br />
<b>%U: Units of Reference Column</b> (e.g. <i>Units</i>, <i>Units</i>1, etc.)<br />
<b>%V: Cell Value of Reference Column</b> (e.g. <i>Group 1</i>, <i>Group 2</i>, etc.)<br />
<br />
Note that names can be comprised of concatenated variables and include arbitrary text (e.g. "%N=%V" will produce sheets named as "<i>Column Name</i>=<i>Cell Value</i>").
</p><p>Since Origin 2019b, this option has been set to <b>%V</b> by default to output each subgroup to a new sheet with the group-info sheet name.
</p>
</td></tr></table>
<p><br />
</p>
<table class="note">

<tr>
<td> <b>Note:</b> From Origin 2017 <a href="../../UserGuide/UserGuide/Column_Short_Name_Restriction.html" title="UserGuide:Column Short Name Restriction">column Short Name is restricted</a> to alphabetical order and it cannot be edited by default. For this reason, the <b>Keep Short Name</b> option is hidden in this dialog. If you are opening a pre-Origin 2017 project or if <a href="../../UserGuide/UserGuide/Folder_and_Window_Properties_Dialog.html#The_Properties_tab" title="UserGuide:Folder and Window Properties Dialog">you have turned off Spreadsheet Cell Notation in the current book</a>, and you want to keep customized column Short Names after splitting the worksheet, you need to:
<ol>
<li>Open the <b>Command Window</b> or <b>Script Window</b>, type the following and press Enter:</li>
<pre class="lt" style="font-family:monospace;">@SSG <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span></pre> 
<li>When you open the <b>wsplit</b> dialog, check the <b>Keep Short Name</b> check box when specifying your options.</li>
</ol>
</td></tr></table>






