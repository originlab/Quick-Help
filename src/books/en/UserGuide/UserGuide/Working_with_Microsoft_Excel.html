<h1 class="firstHeading">7.1 Working with Microsoft Excel Basic Operations</h1><p class='urlname' style='display: none'>Work-Excel-Basic</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Importing_Excel_Data_using_the_Import_Excel_Data_Connector_Dialog"><span class="tocnumber">1</span> <span class="toctext">Importing Excel Data using the Import Excel Data Connector Dialog</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Importing_Excel_Data_using_the_impMSExcel_X-Function_Dialog"><span class="tocnumber">2</span> <span class="toctext">Importing Excel Data using the impMSExcel X-Function Dialog</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Working_with_Excel_Books_inside_Origin"><span class="tocnumber">3</span> <span class="toctext">Working with Excel Books inside Origin</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Working_with_Excel_Workbooks"><span class="tocnumber">4</span> <span class="toctext">Working with Excel Workbooks</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="#Open.2C_Create_and_Save_Excel_Workbook"><span class="tocnumber">4.1</span> <span class="toctext">Open, Create and Save Excel Workbook</span></a>
<ul>
<li class="toclevel-3 tocsection-6"><a href="#To_Open.2FCreate_Excel_Workbook_in_Origin"><span class="tocnumber">4.1.1</span> <span class="toctext">To Open/Create Excel Workbook in Origin</span></a></li>
<li class="toclevel-3 tocsection-7"><a href="#To_Make_Excel_Workbook_Window_the_Default_Child_Window_Upon_Origin_Start"><span class="tocnumber">4.1.2</span> <span class="toctext">To Make Excel Workbook Window the Default Child Window Upon Origin Start</span></a></li>
<li class="toclevel-3 tocsection-8"><a href="#To_Save_Origin_Project_with_Links_to_External_Excel_File"><span class="tocnumber">4.1.3</span> <span class="toctext">To Save Origin Project with Links to External Excel File</span></a></li>
<li class="toclevel-3 tocsection-9"><a href="#To_Save_Excel_File_in_a_Relative_Path_with_Origin_Project"><span class="tocnumber">4.1.4</span> <span class="toctext">To Save Excel File in a Relative Path with Origin Project</span></a></li>
<li class="toclevel-3 tocsection-10"><a href="#To_Update_Linked_Source_Excel_Files"><span class="tocnumber">4.1.5</span> <span class="toctext">To Update Linked Source Excel Files</span></a></li>
<li class="toclevel-3 tocsection-11"><a href="#To_Change_an_Internal_Excel_Workbook_into_External"><span class="tocnumber">4.1.6</span> <span class="toctext">To Change an Internal Excel Workbook into External</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-12"><a href="#Use_Excel_Data_to_Plot"><span class="tocnumber">4.2</span> <span class="toctext">Use Excel Data to Plot</span></a>
<ul>
<li class="toclevel-3 tocsection-13"><a href="#To_Make_a_Plot_Using_Excel_Workbook_Data"><span class="tocnumber">4.2.1</span> <span class="toctext">To Make a Plot Using Excel Workbook Data</span></a></li>
<li class="toclevel-3 tocsection-14"><a href="#To_Plot_Excel_Data_by_Drag_and_Drop"><span class="tocnumber">4.2.2</span> <span class="toctext">To Plot Excel Data by Drag and Drop</span></a></li>
<li class="toclevel-3 tocsection-15"><a href="#To_Add_Excel_Data_to_Existing_Graph"><span class="tocnumber">4.2.3</span> <span class="toctext">To Add Excel Data to Existing Graph</span></a></li>
<li class="toclevel-3 tocsection-16"><a href="#To_Plot_Excel_Data_into_Multiple_Layers"><span class="tocnumber">4.2.4</span> <span class="toctext">To Plot Excel Data into Multiple Layers</span></a></li>
<li class="toclevel-3 tocsection-17"><a href="#To_Directly_Plot_Excel_Data_Without_Specifying_Designations"><span class="tocnumber">4.2.5</span> <span class="toctext">To Directly Plot Excel Data Without Specifying Designations</span></a></li>
<li class="toclevel-3 tocsection-18"><a href="#To_Make_3D_Surface_Plot_from_Excel_Data"><span class="tocnumber">4.2.6</span> <span class="toctext">To Make 3D Surface Plot from Excel Data</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-19"><a href="#Name_Excel_Workbook_and_Worksheet"><span class="tocnumber">4.3</span> <span class="toctext">Name Excel Workbook and Worksheet</span></a>
<ul>
<li class="toclevel-3 tocsection-20"><a href="#To_Rename_Excel_Workbook_in_Origin"><span class="tocnumber">4.3.1</span> <span class="toctext">To Rename Excel Workbook in Origin</span></a></li>
<li class="toclevel-3 tocsection-21"><a href="#To_Relink_Renamed_Excel_Workbook_Data_to_Origin_Plot"><span class="tocnumber">4.3.2</span> <span class="toctext">To Relink Renamed Excel Workbook Data to Origin Plot</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-22"><a href="#Run_Excel_Macros_and_Visual_Basic_Application_Functions"><span class="tocnumber">4.4</span> <span class="toctext">Run Excel Macros and Visual Basic Application Functions</span></a>
<ul>
<li class="toclevel-3 tocsection-23"><a href="#To_Run_Excel_Macros_in_Origin"><span class="tocnumber">4.4.1</span> <span class="toctext">To Run Excel Macros in Origin</span></a></li>
<li class="toclevel-3 tocsection-24"><a href="#To_Invoke_Visual_Basic_Application_Functions_in_Origin"><span class="tocnumber">4.4.2</span> <span class="toctext">To Invoke Visual Basic Application Functions in Origin</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-25"><a href="#Copy_Excel_Data_Outside_and_Paste.2FPaste_Link_into_Origin"><span class="tocnumber">5</span> <span class="toctext">Copy Excel Data Outside and Paste/Paste Link into Origin</span></a>
<ul>
<li class="toclevel-2 tocsection-26"><a href="#To_Copy_from_Excel_with_External_Relative_Path_.28Recommended.29"><span class="tocnumber">5.1</span> <span class="toctext">To Copy from Excel with External Relative Path (Recommended)</span></a></li>
<li class="toclevel-2 tocsection-27"><a href="#To_Copy_from_Excel_with_Absolute_External_Path"><span class="tocnumber">5.2</span> <span class="toctext">To Copy from Excel with Absolute External Path</span></a></li>
<li class="toclevel-2 tocsection-28"><a href="#To_Display_the_Cells_with_DDE_link_to_Gray_background"><span class="tocnumber">5.3</span> <span class="toctext">To Display the Cells with DDE link to Gray background</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-29"><a href="#FAQs"><span class="tocnumber">6</span> <span class="toctext">FAQs</span></a></li>
<li class="toclevel-1 tocsection-30"><a href="#See_Also"><span class="tocnumber">7</span> <span class="toctext">See Also</span></a></li>
</ul>
</div>

<h2><a name="Importing_Excel_Data_using_the_Import_Excel_Data_Connector_Dialog"></a><span class="mw-headline">Importing Excel Data using the Import Excel Data Connector Dialog</span></h2>
<p><a href="../../UserGuide/Category/Data_Connector.html" title="Category:Data Connector"><b>Data Connectors</b></a> are a relatively new data import mechanism. OriginLab recommends using the <b>Excel Connector</b> for importing your MS Excel data. 
</p><p>For information on importing with the Excel Connector, see <a href="../../UserGuide/UserGuide/Importing_from_Excel.html#Importing_Excel_Data_using_the_Import_Excel_Data_Connector_Dialog" title="UserGuide:Importing from Excel">Importing Excel Data using the Import Excel Data Connector Dialog</a>.
</p>
<h2><a name="Importing_Excel_Data_using_the_impMSExcel_X-Function_Dialog"></a><span class="mw-headline">Importing Excel Data using the impMSExcel X-Function Dialog</span></h2>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Working_with_Microsoft_Excel/Alert_icon.png?v=9649" width="57"  border="0" /></td><td><p>Beginning with <b>Origin 2021b</b>, clicking the <b>Import Excel</b> button <a  class="image"><img alt="Button Import Excel.png" src="../images/Working_with_Microsoft_Excel/Button_Import_Excel.png?v=87520" width="25"  /></a> will open the <b>Excel Import Options</b> Data Connector dialog box. To revert to previous behavior where this button opened the <b>impExcel</b> dialog box, set LabTalk system variable <a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#T"><b>@TIB</b> = <i>2</i></a>. To change the value of a system variable, see <a class="external text" href="../../QuickHelp/QuickHelp/How_do_I_permanently_change_the_value_of_a_system_variable.html">this FAQ</a>.
</p>
	</td>
	</tr>
	</table>
<p>If you prefer to use the older impExcel X-Function dialog to import your Excel data, see <a href="../../UserGuide/UserGuide/Importing_from_Excel.html#Importing_Excel_Data_using_the_impMSExcel_X-Function_Dialog" title="UserGuide:Importing from Excel">Importing Excel Data using the impMSExcel X-Function Dialog</a>
</p>
<h2><a name="Working_with_Excel_Books_inside_Origin"></a><span class="mw-headline">Working with Excel Books inside Origin</span></h2>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Working_with_Microsoft_Excel/Alert_icon.png?v=9649" width="57"  border="0" /></td><td><p>For many years, Origin supported an OLE instance of MS Excel within the Origin workspace, even though it severely limited access to Origin functionality. Over time, users have reported an increase in problems and as a result, OriginLab decided to remove user interface controls for opening an Excel file directly in Origin (<b>File: Open Excel</b>) and for opening a new Excel workbook in Origin (<b>File: New Excel</b>). We urge you to consider using the Excel <b>Data Connector</b> (described above), for importing Excel data. The Excel Connector is fast and you have full access to Origin's graphing and analysis tools. If using the Excel Connector is not an option, you can restore OLE access by changing the value of LabTalk system variable <a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#M"><b>@MOE</b></a>. 
</p>
<pre class="lt" style="font-family:monospace;">@MOE<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>; <span style="color: #008000;">// 0 (default), 1 = show File: Open Excel, 2 = show File: New Excel, 3 = show Open + New</span></pre>
<p>For information on changing the value of a system variable, see <a class="external text" href="../../QuickHelp/QuickHelp/How_do_I_permanently_change_the_value_of_a_system_variable.html">this FAQ</a>.
</p>
	</td>
	</tr>
	</table>
<p><i><b>The remainder of this section assumes that you have restored Origin menu access to Excel files and windows</b></i>
</p><p>When an OLE instance of Excel is open inside of Origin, both Origin and Excel Standard toolbars display as illustrated below. Only Origin's <b>File</b>, <b>Plot</b> and <b>Window</b> menus are available when an Excel workbook window is active. This prevents data stored in an Excel workbook from accessing Origin's worksheet based data analysis and manipulation. 
<br /><a  class="image"><img alt="Working with Excel 01a.png" src="../images/Working_with_Microsoft_Excel/Working_with_Excel_01a.png?v=74734" width="800"  /></a><br />
</p><p>As you switch from Excel workbook windows to Origin workbook windows, you will see a toolbar spacer appear under Origin's toolbars. This spacer is used to stabilize the toolbar region when switching between Excel and Origin child windows. You can choose to turn it off by right-clicking on the spacer and selecting <b>Hide Toolbar Spacer</b> from the shortcut menu.
</p><p>The Excel workbook is managed as a special type of Origin child window. You can rename, arrange, save, or delete the Excel workbook window. You can also open multiple Excel workbook windows within an Origin project. Like the Origin workbook, you can view text or numeric data in a Excel workbook window and view the graphic representation of the data in an Origin graph window.
</p><p>Data in an Excel sheet can be dynamically linked to data in Origin worksheet. When you copy data from an open Excel sheet inside Origin, you can choose to paste the data into Origin worksheet as a link so that when data in Excel file changes, it will update corresponding data in the Origin worksheet.
</p><p>Menu control of the Excel workbook is available by right-clicking on the Excel workbook window title bar:
</p>
<table class="dialogcontroltable">

<tr>
<th> Save
</th>
<td>
<p>Save the changes made to the workbook data. This command is available after you save the workbook window. Note that when the Excel workbook is read-only, this command is unavailable.
</p>
</td></tr>
<tr>
<th> Save Workbook As
</th>
<td>
<p>Save the active workbook to a file using a new name. Open the <span class="db">Save As</span> dialog box. 
</p>
</td></tr>
<tr>
<th> Update Origin
</th>
<td>
<p>If you rename a workbook sheet that contains data that is plotted in a graph window, this shortcut menu command updates the connection between the data plot and its source sheet.   After selecting the command, Origin opens the <span class="db">Associate Excel Worksheet</span> dialog box.  Edit this dialog box to re-establish the connection between the data plot and the sheet.  
Occasionally, the workbook window, or other windows containing workbook data, may become inactive.  This condition is apparent when the window containing workbook data has a blank display.  To reactivate the window and restore its display, select this shortcut menu command. 
</p>
</td></tr>
<tr>
<th> Help Contents
</th>
<td>
<p>Opens Origin's Help file.
</p>
</td></tr>
<tr>
<th> Properties
</th>
<td>
<p>Opens the <span class="db">Workbook Properties</span> dialog box.   Edit this dialog box to rename the workbook window and control how the workbook is saved when you save your project.  
</p><p>This dialog box also lists the workbook sheets that contain plotted data, and the associated Origin index numbers.  Index numbers are included in the names of data plots that contain workbook data. 
</p>
</td></tr></table>
<h2><a name="Working_with_Excel_Workbooks"></a><span class="mw-headline">Working with Excel Workbooks</span></h2>
<p>The Excel workbook window has features that distinguish it from other Origin child windows. The following sections discuss procedures that are unique to the Excel workbook window.
</p>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Working_with_Microsoft_Excel/Alert_icon.png?v=9649" width="57"  border="0" /></td><td><p>Before reading through the following sections, be sure you have read the "alert" in <a href="#Working_with_Excel_Books_inside_Origin">at the beginning of this page</a>.
</p>
	</td>
	</tr>
	</table>
<h3><a name="Open.2C_Create_and_Save_Excel_Workbook"></a><span class="mw-headline">Open, Create and Save Excel Workbook</span></h3>
<p>Among the child windows, Excel workbooks are special in that they can be saved as internal objects of the project or as links to external Excel files. 
</p><p>Saving the Excel workbooks internally to the project enhances the project's portability. You can open the project on any computer that has Origin and Excel installed and have full access to your Excel workbook data. Note for internal Excel file, dynamically linking a formula in an Excel workbook to source data in another Excel workbook is not supported.
Whereas, saving the Excel workbooks as links to external files allows you to maintain separate Excel files that are updated when changes are made to the associated workbooks in Origin. The files are available for other applications such as Microsoft Excel.
</p><p>When you open a project that includes links to external Excel file(s), Origin opens those workbook(s) in the project. If Origin can't find the Excel file at the location specified in the <b>Linked File Path</b> field of the workbook's <b>Workbook Properties</b> dialog box, then Origin opens the <b>File Name</b> dialog box and asks you to locate the Excel file. In this case, you can either type the correct external file path and file name in this dialog box and click OK, or if the Excel file isn't available, click <b>Ignore</b> (or <b>Ignore All</b>). In such cases, Origin opens the project and displays a placeholder for each workbook whose source isn't available. Additionally, data plots created from the missing workbook(s) are not displayed in the graph window(s).
</p><p>Origin displays the full path and file name of the linked source Excel file in the <a href="../../UserGuide/UserGuide/The_Workbook_Properties_Dialog_Box.html#Linked_File_Path_Field" title="UserGuide:The Workbook Properties Dialog Box">Linked File Name</a> group. If the workbook window was created in Origin, the default path is determined by the Excel path specified on the <a href="../../UserGuide/UserGuide/The_(Options)_File_Locations_Tab.html" title="UserGuide:The (Options) File Locations Tab">File Location tab</a> of the <b>Options</b> dialog box.
</p>
<h5><a name="To_Open.2FCreate_Excel_Workbook_in_Origin"></a><span class="mw-headline">To Open/Create Excel Workbook in Origin</span></h5>
<dl><dd><dl><dd>Select menu <b>File: Open Excel...</b> to open an Excel workbook in Origin. Select menu <b>File: New: Excel</b> to create a new Excel workbook in Origin.</dd></dl></dd></dl>
<h5><a name="To_Make_Excel_Workbook_Window_the_Default_Child_Window_Upon_Origin_Start"></a><span class="mw-headline">To Make Excel Workbook Window the Default Child Window Upon Origin Start</span></h5>
<dl><dd><dl><dd> Select menu <b>Window: Origin Options</b> when an Excel workbook is active, or <b>Preference: Options</b> when any other child window is active. Both menu commands open the <b>Options</b> dialog box. Then select the <b>Open/Close</b> tab. Select <b>Excel Workbook</b> from the <b>Start New Project</b> drop-down list and Click <b>OK</b>. In the <b>Save as Origin's startup options?</b> prompt, select <b>Yes</b> to apply settings for future Origin sessions or <b>No</b> to apply to current Origin session only.</dd></dl></dd></dl>
<h5><a name="To_Save_Origin_Project_with_Links_to_External_Excel_File"></a><span class="mw-headline">To Save Origin Project with Links to External Excel File</span></h5>
<dl><dd><dl><dd> Right-click on the title bar of the Excel workbook. Select <b>Properties</b> from the shortcut menu. This opens the <b>Workbook Properties</b> dialog box. Select the <b>Internal</b> radio button in the <b>Save As</b> group. Then click the <b>OK</b> button to close this dialog box. After the above operation is performed, Origin will not update the original source Excel file (if the current Excel workbook comes from an external Excel file) when you select <b>File: Save Project or File: Save Project As</b>, or when you click the <b>Save Project</b> button on the Standard toolbar. Additionally, any new changes made to the original source Excel file will not affect the Origin project.</dd></dl></dd></dl>
<h5><a name="To_Save_Excel_File_in_a_Relative_Path_with_Origin_Project"></a><span class="mw-headline">To Save Excel File in a Relative Path with Origin Project</span></h5>
<dl><dd><dl><dd> If you haven’t saved the Origin project yet, or the Origin project was saved to a folder totally different from Excel file location. Right click on the title bar of the Excel book and selecting <b>Properties</b>. In the dialog, click <b>Switch to OPJ Path upon Saving</b> button. The next time the OPJ is saved, it will place a copy of the Excel file in that same folder.</dd></dl></dd></dl>
<dl><dd><dl><dd> If you already saved the Origin project in the same folder as the Excel file or some folder above the Excel file, you still need to check the <b>Relative to current project (OPJ) path</b> checkbox. In such case the <b>Switch to OPJ Path upon Saving</b> button is greyed out. No extra copy of the Excel file will be saved in such case when save this Origin project.</dd></dl></dd></dl>
<h5><a name="To_Update_Linked_Source_Excel_Files"></a><span class="mw-headline">To Update Linked Source Excel Files</span></h5>
<dl><dd><dl><dd> If your Origin project contains a link to an external Excel file, Origin will automatically update the source Excel when the project is saved. However, if you have selected either <b>Before Saving</b> or <b>Before Save Project As</b> from the <b>Saving Excel Workbooks</b> drop-down list on <a href="../../UserGuide/UserGuide/The_(Options)_Excel_Tab.html" title="UserGuide:The (Options) Excel Tab">the <b>Excel</b> tab</a> of the Options dialog box, the <b>Save Excel Workbooks</b> dialog box will open after selecting one of the project saving options.  </dd>
<dd> To update the source Excel file, the associated check box must be selected from the <b>External</b> list box. In addition, you can choose to save the data in the Excel workbook to the source file manually so as to update the external file at any time you want. To do so, right-click on the workbook window title bar and select <b>Save Workbook As</b> from the shortcut menu.</dd></dl></dd></dl>
<h5><a name="To_Change_an_Internal_Excel_Workbook_into_External"></a><span class="mw-headline">To Change an Internal Excel Workbook into External</span></h5>
<dl><dd><dl><dd> When you click the <b>New Excel</b> button on the Standard toolbar to open a new workbook in Origin, Origin creates an internal Excel workbook by default. To change it into a link to an external file, right-click on the title bar and select <b>Properties</b> from the shortcut menu.  This menu command opens the <a href="../../UserGuide/UserGuide/The_Workbook_Properties_Dialog_Box.html" title="UserGuide:The Workbook Properties Dialog Box">Workbook Properties</a> dialog box.  Select the <b>External</b> radio button and click <b>OK</b>. </dd>
<dd> Alternatively, right-click on the title bar and select <b>Save Workbook As</b> from the shortcut menu.  This menu command opens the <b>Save As</b> dialog box.  Type a file name in the <b>File name:</b> text box and click <b>OK</b>.  </dd>
<dd> If you save your project after, a link to the external Excel workbook file will be saved.</dd></dl></dd></dl>
<h3><a name="Use_Excel_Data_to_Plot"></a><span class="mw-headline">Use Excel Data to Plot</span></h3>
<p>There are basically two ways you can make a plot in Origin using Excel workbook data: directly creating a new Origin graph, adding Excel workbook data to an existing Origin graph window. 
</p><p>The direct plotting process is mainly controlled by <a href="../../UserGuide/UserGuide/Select_Data_for_Plotting_Dialog_Box.html" title="UserGuide:Select Data for Plotting Dialog Box">Select Data for Plotting dialog</a>, where you can interactively select data from Excel workbook, assign its plot designation (X, Y, Z, etc.) and create the plot. Multiple data plots can be plotted into a single layer (by default), multiple different layers or even separate graph windows. Origin also provides an option to use default plot assignments to allow you directly highlight plotting data and select a graph type to plot without an intermediary dialog box.
</p><p>The most direct way of adding data to existing graph window is by highlighting and dragging and dropping data into it. Also, <a href="../../UserGuide/UserGuide/Select_Data_for_Plotting_Dialog_Box.html" title="UserGuide:Select Data for Plotting Dialog Box">Select Data for Plotting dialog</a>, <a href="../../UserGuide/Category/Plot_Setup.html" title="Category:Plot Setup">Plot Setup dialog</a> or <a href="../../UserGuide/UserGuide/The_Layer_n_Dialog_Box.html" title="UserGuide:The Layer n Dialog Box">Layer Contents dialog</a> can be used to serve the same purpose. These dialogs display dataset name using range notation including book name, sheet name, and column long or short names. This allows for easy identification of datasets that originate from either Origin or Excel workbooks.
The Excel workbook dataset naming convention is similar to the Origin workbook dataset naming convention:
</p>
<pre class="lt" style="font-family:monospace;">ExcelWorkbookName_ColumnName@SheetNumber</pre>
<p>Where <i>ExcelWorkbookName</i> is the workbook name, <i>ColumnName</i> is the column name, and <i>SheetNumber</i> is a numeric value reflecting the order in which data was plotted from the sheets in the workbook (see note, below).  
</p><p>To verify the <i>@SheetNumber</i> value for each sheet that contains plotted data, right-click on the workbook window title bar and select <b>Properties</b> from the shortcut menu. The workbook sheets and their associated <i>@SheetNumber</i> values display in the <b>Sheet Name - Origin Index</b> list box. 
</p><p><b>Note:</b> The @SheetNumber value is not the <b>Sheetn</b> number that displays at the bottom of the Excel workbook tab. When referencing the first plotted sheet, Origin does not use @1.
</p><p>References to plotted Excel workbook data are found in the same locations as are references to plotted Origin workbook data. These locations include: the data list at the bottom of the <b>Data</b> menu and <b>Layer Contents</b> dialog box.
</p><p>When adding data to an existing graph window, the data are plotted using the style of the graph template (for example, line or scatter). If you have created a custom template with data plot style holders, Origin will use the first available style holder. If there are no style holders available, Origin plots the data using the style of the graph template.
</p><p>You can continue to add data to a graph using this dialog box as long as you do not click <b>Close</b>.  However, if you created a graph using a different plotting method or if you closed the <b>Select Data for Plotting</b> dialog box after creating a graph, then you must manually reopen the dialog box to activate this plotting method.  
</p><p><b>Note:</b> Each graph type has specific data requirements (for example, a ternary diagram requires X, Y, and Z data).  To learn more, see the specific plot type in the Appendix section on <a href="../../UserGuide/Category/Appendix_2_-_Graph_Types.html" title="Category:Appendix 2 - Graph Types"><b>Graph Types</b></a>. 
</p>
<h5><a name="To_Make_a_Plot_Using_Excel_Workbook_Data"></a><span class="mw-headline">To Make a Plot Using Excel Workbook Data</span></h5>
<dl><dd><dl><dd> Take scatter plot for example. Select menu <b>Plot: Symbol: Scatter</b> or click scatter button <a  class="image"><img alt="Button Scatter.png" src="../images/Working_with_Microsoft_Excel/Button_Scatter.png?v=68669" width="22"  /></a> in <a href="../../UserGuide/UserGuide/The_2D_Graphs_Toolbar.html" title="UserGuide:The 2D Graphs Toolbar">2D Graphs Toolbar</a>  to open <b>Select Data for Plotting <i>BookName</i></b> dialog. Select a range of cells or a column in Excel sheet and click <b>X</b> button to assign X data. Similarly, select Y data and click <b>Plot</b> button to make a scatter plot. 3D graphs can be made the same way but need to further assign data to Z. When the first row is column title row, you can simply include that row in data selection and it will be automatically assigned as <b>Title Row</b> and later shown as axis title. You can also specify a certain row as label row by selecting that row and click <b>Title Row</b> button. Data requirements for each graph type may differ, refer to <a href="../../UserGuide/UserGuide/Graph_Type_Data_Requirements.html" title="UserGuide:Graph Type Data Requirements">this table</a> for details.</dd></dl></dd></dl>
<h5><a name="To_Plot_Excel_Data_by_Drag_and_Drop"></a><span class="mw-headline">To Plot Excel Data by Drag and Drop</span></h5>
<dl><dd><dl><dd> First specify a plot type for your data. Select menu <b>Window:Origin Options</b> when a workbook is active or <b>Preference: Options</b> when any other child window is active.  This opens the <b>Options</b> dialog box. Select the <b>Drag and Drop Plot</b> type such as <b>Line</b>, <b>Scatter</b>, or <b>Line+Symbol</b> on the <b>Graph</b> tab or select <b>Current</b> to use the style of the active graph window template.</dd>
<dd> Then plot data using the drag and drop method. Select your workbook data. With your mouse, point to the right edge of the selection area when the mouse cursor is <a  class="image"><img alt="Highlighting and Dragging Data into the Graph Window 1.png" src="../images/Working_with_Microsoft_Excel/Highlighting_and_Dragging_Data_into_the_Graph_Window_1.png?v=68670" width="25"  /></a>. Hold down the left mouse button and drag the highlighted data into the graph window and release the mouse button.</dd></dl></dd></dl>
<dl><dd><dl><dd> This method provides no dialog box to serve as an intermediary plotting tool, therefore this method must make assumptions as to how to treat the highlighted data. If one column (or a range from one column) is highlighted, this column supplies the Y values for the data plot. The data are plotted versus row number; if multiple columns (or a range from multiple columns) are highlighted, the leftmost column supplies the X values. All other columns supply the Y values. The data are plotted versus the X values; if multiple columns (or a range from multiple columns) are highlighted and the CTRL key is depressed while dragging the data, all the columns are treated as Y values. The data are plotted versus row number; if the graph window contains multiple layers, dropped data plot in the active graph layer (note that dropping data onto a single layer graph will activate this graph and this layer); if data are dropped onto a layer icon, the data plots in that layer.</dd></dl></dd></dl>
<dl><dd><dl><dd> Note that the resultant plot type is determined by the Drag and Drop Plot drop-down list selection on the <a href="../../UserGuide/UserGuide/The_(Options)_Graph_Tab.html" title="UserGuide:The (Options) Graph Tab">Graph tab</a> of the Options dialog box. This plotting method is available whenever a workbook is active and a graph window is open in the project (excluding minimized and hidden graph windows).</dd></dl></dd></dl>
<h5><a name="To_Add_Excel_Data_to_Existing_Graph"></a><span class="mw-headline">To Add Excel Data to Existing Graph</span></h5>
<dl><dd><dl><dd>Activate that Excel workbook window. Create the new data plot association(s) by selecting data and clicking the plot designation buttons in <b>Select Data for Plotting <i>BookName</i></b> dialog. Then redirect window activity back to the graph window. Click the <b>Add Plot</b> button to add the data plot(s) to the active graph layer.</dd></dl></dd></dl>
<dl><dd><dl><dd>Alternatively, you can use <a href="../../UserGuide/Category/Plot_Setup.html" title="Category:Plot Setup">Plot Setup</a> or <a href="../../UserGuide/UserGuide/The_Layer_n_Dialog_Box.html" title="UserGuide:The Layer n Dialog Box">Layer Contents</a> dialog to add data to existing graph window.</dd></dl></dd></dl>
<h5><a name="To_Plot_Excel_Data_into_Multiple_Layers"></a><span class="mw-headline">To Plot Excel Data into Multiple Layers</span></h5>
<dl><dd><dl><dd> Select a plot type from menu or click a plot type through toolbars to bring up <b>Select Data for Plotting <i>BookName</i></b> dialog. After you specified data for X and multiple column data for Y, the <b>Plot Into</b> drop-down list becomes active. Select <b>Multiple Layers</b> from that list and click <b>Plot</b> button to plot each data plot into its own layer in the same graph window. You can click <b>Save Settings</b> button to save the selection from the <b>Plot Into</b> drop-down list for future instances of this dialog box in the current Origin session.</dd></dl></dd></dl>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Working_with_Microsoft_Excel/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>To select multiple Y columns, you can click and drag through the desired column headings, SHIFT+clicking on a range of columns, or CTRL+clicking on nonadjacent columns. You can also select a range of data in a column by click and drag through the desired cells and use CTRL+click to select additional cells.
</p></td></tr></table>
<h5><a name="To_Directly_Plot_Excel_Data_Without_Specifying_Designations"></a><span class="mw-headline">To Directly Plot Excel Data Without Specifying Designations</span></h5>
<dl><dd><dl><dd> Highlight all data to be plotted in Excel workbook, and select a plot type to bring up <b>Select Data for Plotting</b> dialog. Click <b>Use Default</b> button and click <b>Yes</b> in prompt window. Then the plot will be created using Origin's default plot assignments for the selected graph type instead of establishing plot associations each time in the dialog box. E.g., if you select two workbook columns to make a Y error bar plot, Origin uses the row index number for X values, the left column for Y values, and the right column for Y error bar values. For X and Y Error bars, the leftmost column for X values, the second column for Y values, the third column for X error bar values, and the last column for Y error bar values. </dd>
<dd> This is very useful in creating some special graph types, e.g., XYAM vector, XYXY vector where you cannot specify two columns as X using <a href="../../UserGuide/UserGuide/Select_Data_for_Plotting_Dialog_Box.html" title="UserGuide:Select Data for Plotting Dialog Box">Select Data for Plotting</a> dialog. Refer to <a href="../../UserGuide/UserGuide/Graph_Type_Data_Requirements.html" title="UserGuide:Graph Type Data Requirements">this table</a> for default plot assignments details for each graph type.</dd></dl></dd></dl>
<dl><dd><dl><dd> If you want to reopen <b>Select Data For Plotting</b> dialog for plotting, clear the <b>Default Plot Assignments</b> check box on the <b>Excel</b> tab of the <b>Options</b> dialog box, which can be accessed from menu <b>Window: Origin Options</b> when a workbook is active or <b>Preference: Options</b> when any other child window is active.</dd></dl></dd></dl>
<h5><a name="To_Make_3D_Surface_Plot_from_Excel_Data"></a><span class="mw-headline">To Make 3D Surface Plot from Excel Data</span></h5>
<dl><dd><dl><dd> You can select a contiguous range of Excel workbook data and create an Origin matrix directly. To create the matrix highlight the workbook data. Select <b>Window:Create Matrix</b> from the menu bar. This menu command opens a new matrix window and fills the matrix with the highlighted data. In this way, you can create an array of Z values that can be used to generate a 3D surface plot.</dd></dl></dd></dl>
<h3><a name="Name_Excel_Workbook_and_Worksheet"></a><span class="mw-headline">Name Excel Workbook and Worksheet</span></h3>
<p>The naming of Excel workbook is controlled in <b>Workbook Properties</b> dialog accessed by right clicking on the Excel workbook window title bar and select <b>Properties...</b> from shortcut menus. In this dialog, you can not only name the workbook via <b>Short Name</b> or <b>Long Name</b> but also add <b>Comments</b> to it. If you create an Origin data plot from your Excel workbook data and, subsequently, you rename the workbook sheet, you lose the association between the data plot and the workbook data. 
</p><p>For externally saved Excel workbook, the full path and file name also display in the title bar.
</p>
<h5><a name="To_Rename_Excel_Workbook_in_Origin"></a><span class="mw-headline">To Rename Excel Workbook in Origin</span></h5>
<dl><dd><dl><dd> Right-click on the Excel workbook window title bar and select <b>Properties</b> from the shortcut menu. This menu command opens the <b>Workbook Properties</b> dialog box. Type a new name in the <b>Window Title</b> text box and click <b>OK</b>. Note that if the workbook is saved externally to the project, the full path and file name also display in the title bar.</dd></dl></dd></dl>
<h5><a name="To_Relink_Renamed_Excel_Workbook_Data_to_Origin_Plot"></a><span class="mw-headline">To Relink Renamed Excel Workbook Data to Origin Plot</span></h5>
<dl><dd><dl><dd> To rebuild the link, right-click on the workbook window title bar and select <b>Update Origin</b> from the shortcut menu. This opens the <b>Associate Excel Worksheet</b> dialog box. Highlight the renamed workbook sheet and click <b>OK</b>.</dd></dl></dd></dl>
<h3><a name="Run_Excel_Macros_and_Visual_Basic_Application_Functions"></a><span class="mw-headline">Run Excel Macros and Visual Basic Application Functions</span></h3>
<p>When an Excel workbook is the active child window, the user-interface is -- with the exception of a small subset of Origin window and plotting options -- provided by Excel.  Thus, when a workbook is active, the <b>Format</b>, <b>Tools</b>, and <b>Data</b> menus are Excel menus.  However, Origin does provide access to your Excel workbook data using LabTalk, Origin's built-in scripting language.
</p>
<h5><a name="To_Run_Excel_Macros_in_Origin"></a><span class="mw-headline">To Run Excel Macros in Origin</span></h5>
<dl><dd><dl><dd> Origin uses an <a class="external text" href="../../LabTalk/LabTalk/Excel_(object).html"><b>excel</b></a> object method to run Excel macros from Origin. For the Excel macro to run properly, you must supply the correct arguments using the excel object method. LabTalk will accept no more than five arguments. Additionally, the workbook containing the Excel macro must be the active window. To run the macro, type the following in the Script window and press ENTER:</dd></dl></dd></dl>
<dl><dd><dl><dd> excel.run(<i>SheetName</i>.<i>MacroName</i>) or excel.run(<i>ModuleName</i>.<i>MacroName</i>)</dd></dl></dd></dl>
<dl><dd><dl><dd> To select a range for running Macro, run the following command:</dd></dl></dd></dl>
<dl><dd><dl><dd> Excel.RunRange(SheetName,RangeName,Arg1,Arg2,&amp;ldots;,Arg5)</dd></dl></dd></dl>
<dl><dd><dl><dd> Where <i><b>SheetName</b></i> is the name of the sheet containing the macro, <i><b>RangeName</b></i> is the name of the cell on the sheet where the macro starts (for example, C6), and Argn are the correct arguments for the macro (not to exceed five arguments). The return value after executing the <b>excel</b> object method comes from the macro.</dd></dl></dd></dl>
<h5><a name="To_Invoke_Visual_Basic_Application_Functions_in_Origin"></a><span class="mw-headline">To Invoke Visual Basic Application Functions in Origin</span></h5>
<dl><dd><dl><dd> To run the Visual Basic application function, type the following in the Command Window and press ENTER:</dd></dl></dd></dl>
<dl><dd><dl><dd> Excel.Run(FunctionName,Arg1,Arg2,&amp;ldots;,Arg5)</dd></dl></dd></dl>
<dl><dd><dl><dd> Where FunctionName is the Visual Basic application function, and Argn are the correct arguments for the function (not to exceed five arguments).The return value after executing the excel object method comes from the function.</dd></dl></dd></dl>
<h2><a name="Copy_Excel_Data_Outside_and_Paste.2FPaste_Link_into_Origin"></a><span class="mw-headline">Copy Excel Data Outside and Paste/Paste Link into Origin</span></h2>
<p>Copying Excel data from a workbook opened in Excel and paste/paste link into Origin enable user to full access Origin's powerful graphing and analysis features. And 
</p><p>If you choose Paste Link, you will create a DDE link between the Excel data and Origin workbook. Any change in that Excel data will dynamically update Origin workbook.
</p><p>When you click on the Worksheet cells with the DDE link, the path from Excel will show on Status bar. If the pastes contents is a range (not a single cell), the Worksheet cells in that ranges will share the same path of the links. 
</p>
<h5><a name="To_Copy_from_Excel_with_External_Relative_Path_.28Recommended.29"></a><span class="mw-headline">To Copy from Excel with External Relative Path (Recommended)</span></h5>
<dl><dd><ol><li> Open the external Excel file in Origin. Save the project file.</li>
<li> <a href="../../UserGuide/Category/Working_with_Microsoft_Excel.html#Setting_External_Excel_File_Path_Relative_to_OPJ_Path" title="Category:Working with Microsoft Excel">Set the external Excel file path relative to OPJ</a>. </li>
<li> Copy data from the Excel file opened in Origin and paste link to Origin workbook</li>
<li> Change data in the external Excel file</li>
<li> Reopen the Origin project file</li>
<li> Data in Origin will be updated accordingly</li></ol></dd></dl>
<h5><a name="To_Copy_from_Excel_with_Absolute_External_Path"></a><span class="mw-headline">To Copy from Excel with Absolute External Path</span></h5>
<dl><dd><ol><li> Open the external Excel file in Excel.</li>
<li> Copy data from the Excel file and paste link to Origin workbook</li>
<li> Change data in Excel</li>
<li> Data in Origin will be updated dynamically.</li></ol>
<dl><dd><b>Notes:</b> Please note that data from absolute external path is "path dependent". Whenever the Excel file is moved to a different folder, or the related OPJ is opened on a different computer, There is always a dialog pops up to remind you that the DDE Link is broken. </dd></dl></dd></dl>
<h5><a name="To_Display_the_Cells_with_DDE_link_to_Gray_background"></a><span class="mw-headline">To Display the Cells with DDE link to Gray background</span></h5>
<p>Select <b>Edit: Edit Mode</b> or press <i><b>Ctrl + Alt + B</b></i> to open the Edit Mode. The Worksheet cells with DDE link will display to Gray background.
</p><p><br />
</p>
<table class="note">

<tr>
<td><b>Notes:</b>
<ul><li>Copying data/text from the external Excel file in Excel and then pasting it to Origin graph directly (use <b>Paste</b> menu or <b>Ctrl</b>+<b>V</b>) will paste as text instead of Excel object. If you want to paste as Excel file, please use <b>Paste Link</b>.</li>
<li>The system variables, <a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#D"><b>@DDES</b></a> and <a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#D"><b>DDEL</b></a>, can be used to turn off the <b>DDE related messages</b> which remind you the file location is changed.</li>
<li>The system variable <a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#D"><b>@DDEN</b></a> can be used to depress the <b>Start DDE Link</b> dialog. Refer to <a class="external text" href="../../QuickHelp/QuickHelp/How_to_remove_DDE_links_in_a_project.html">this FAQ</a> for details.</li>
<li>Copying "TURE" and "FALSE" from Excel will paste as numeric value "1" and "0" in Origin</li></ul>
</td></tr></table>
<h2><a name="FAQs"></a><span class="mw-headline">FAQs</span></h2>
<ul><li> <u><a class="external text" href="../../QuickHelp/QuickHelp/How_to_paste_date_time_from_Excel.html"><b>How do I copy and paste date-time data from MS Excel?</b></a></u> </li>
<li> <u><a class="external text" href="../../QuickHelp/QuickHelp/When_I_copy_data_from_Microsoft_Excel_how_can_I_have_the_text_automatically_appear.html"><b>How can I copy header information in Excel into column labels in Origin?</b></a></u></li>
<li> <u><a class="external text" href="../../QuickHelp/QuickHelp/Import_Certain_Column_Excel.html"><b>How to import certain columns from different Excel sheets to Origin?</b></a></u></li>
<li> <u><a class="external text" href="../../QuickHelp/QuickHelp/What_is_the_difference_between_the_underlying_mathematical_system.html"><b>How can I convert date data from Excel to Origin?</b></a></u></li>
<li> <u><a class="external text" href="../../QuickHelp/QuickHelp/Why_does_Excel_Fail_to_Open_in_Origin_64-bit.html"><b>What to do if I see error message "Origin is unable to detect a proper installation of Excel on your computer"?</b></a></u></li>
<li> <u><a class="external text" href="../../QuickHelp/QuickHelp/Why_does_Excel_Fail_to_Open_in_Origin_64-bit.html"><b>When I copy more than 65536 rows from Excel into Origin 8.5 or prior version, it got truncated. What can I do?</b></a></u></li></ul>
<h2><a name="See_Also"></a><span class="mw-headline">See Also</span></h2>
<ul><li> <a class="external text" href="http://blog.originlab.com/graphing/dynamic-data-exchange-dde-with-excel-workbooks-in-origin-2017" target="_blank">Blog:Use Excel Workbooks in Origin 2017</a></li>
<li> <a  class="image"><img alt="Video Image 2016.png" src="../images/Working_with_Microsoft_Excel/Video_Image_2016.png?v=61345" width="20"  /></a> <a class="external text" href="http://www.originlab.com/index.aspx?go=Support/VideoTutorials&amp;ss=chm&amp;pid=1558" target="_blank">Working with Excel</a> </li>
<li> <a  class="image"><img alt="Video Image 2016.png" src="../images/Working_with_Microsoft_Excel/Video_Image_2016.png?v=61345" width="20"  /></a> <a class="external text" href="http://www.originlab.com/index.aspx?go=Support/VideoTutorials&amp;ss=chm&amp;pid=1517" target="_blank">Copy Origin 8 Data and Paste to Excel</a></li>
<li> <a  class="image"><img alt="Video Image 2016.png" src="../images/Working_with_Microsoft_Excel/Video_Image_2016.png?v=61345" width="20"  /></a> <a class="external text" href="http://www.originlab.com/index.aspx?go=Products/Origin/ImportingData/TP&amp;ss=chm&amp;pid=1217" target="_blank">Copy Excel Data and Paste to Origin 8</a></li></ul>


