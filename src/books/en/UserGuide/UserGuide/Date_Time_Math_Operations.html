<h1 class="firstHeading">4.5.3 Date and Time Math Operations</h1><p class='urlname' style='display: none'>Date-Time-Math-Operations</p>
<p>Importing of date-time data is much improved for newer versions of Origin. <b>Origin 2020b</b> added improved date-time import for the <a class="external text" href="../../UserGuide/UserGuide/Connecting_to_File.html#Text.2FCSV_Connector"><b>Text/CSV Connector</b></a> and <b>Origin 2021</b> added improved handling of date-time when <a class="external text" href="../../QuickHelp/QuickHelp/How_to_paste_date_time_from_Excel.html">copy/pasting from MS Excel</a>. 
</p><p>With regard to older, X-Function-based import, unless you are importing date-time data using a filter or by specifying a custom format in ASCII options, your data are likely to be <a href="../../UserGuide/UserGuide/Dates_and_Times_in_the_Worksheet.html#Formatting_Date_and_Time_Data" title="UserGuide:Dates and Times in the Worksheet">treated as text</a> (you can do a quick check by looking to see if the date-time data are left-aligned (text) or right-aligned (numeric), in the worksheet). In order to use your date-time data in math operations (e.g. calculations of elapsed time), you will need to make sure that they are <a href="../../UserGuide/UserGuide/Dates_and_Times_in_the_Worksheet.html#Formatting_Date_and_Time_Data" title="UserGuide:Dates and Times in the Worksheet">properly formatted</a> and, thus, being treated as numeric data.
</p><p>Also, if you need to perform math operations on date-time data, be aware that there are a large number of <a class="external text" href="../../LabTalk/Script/LabTalk-Supported_Functions.html#Date_and_Time_Functions"><b>date-time</b></a>, <a class="external text" href="../../LabTalk/Script/LabTalk-Supported_Functions.html#String_Functions"><b>string</b></a> and <a class="external text" href="../../LabTalk/Script/LabTalk-Supported_Functions.html#Math_Functions"><b>math</b></a> functions built into Origin for manipulation of date-time numerics and date-time strings.
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Date_Time_Math_Operations/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>By default, date-time in Origin (<b>Format</b> = <b>Date</b>, but data include a time component) are stored internally as <a href="../../UserGuide/UserGuide/Dates_and_Times_in_Origin.html" title="UserGuide:Dates and Times in Origin">Julian-day</a> (double) values where the integer part of the value is days and the fractional part is seconds. In this system, assuming contemporary dates, resolution is limited to 0.0001 seconds when rounded at the fourth decimal digit. Beginning with Origin 2019, you can choose <a href="../../UserGuide/UserGuide/Dates_and_Times_in_Origin.html#Alternate_Date-Time_Systems_in_Origin" title="UserGuide:Dates and Times in Origin">a "<b>2018</b>" system</a> in which "time zero" is January 1, 2018 at 00:00. In this system, the integer part is smaller allowing for more resolution for the fractional part.  In this "2018" system, measurements to 10<sup>-8</sup> seconds can be supported.
</p></td></tr></table>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Date.2C_Time.2C_Month.2C_Day_of_the_Week"><span class="tocnumber">1</span> <span class="toctext">Date, Time, Month, Day of the Week</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Date_and_time_math_operations:_dates_and_times"><span class="tocnumber">2</span> <span class="toctext">Date and time math operations: dates and times</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Date_and_time_math_operations:_months"><span class="tocnumber">3</span> <span class="toctext">Date and time math operations: months</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Date_and_time_math_operations:_days"><span class="tocnumber">4</span> <span class="toctext">Date and time math operations: days</span></a></li>
</ul>
</div>

<h2><a name="Date.2C_Time.2C_Month.2C_Day_of_the_Week"></a><span class="mw-headline">Date, Time, Month, Day of the Week</span></h2>
<p>Date and date-time values in Origin are stored internally as <a href="../../UserGuide/UserGuide/Dates_and_Times_in_Origin.html" title="UserGuide:Dates and Times in Origin">Astronomical Julian Day Numbers</a> of data type <b>double(8)</b>. It is important to remember that it is these internally-stored values are independent of any <b>Display</b> option that you might chosen for your date-time data. It is these Julian Day values that are used when performing math operations on date and time data. 
</p>
<dl><dd><dl><dd><a  class="image"><img alt="Date Time Math 02.png" src="../images/Date_Time_Math_Operations/Date_Time_Math_02.png?v=81692" width="551"  /></a></dd></dl></dd></dl>
<p>The other thing to note is that you can freely switch back and forth between any supported date-time <b>Display</b> option without any loss of precision, because the internally stored value is unaffected by your choice of <b>Display</b> format (i.e. switching from a date-time value formatted to the fractional second to month and back to the original date-time value, makes no change to the underlying value -- there is no loss of precision).
</p><p>Origin supports four basic <b>Formats</b>: <b>Date</b>, <b>Time</b>, <b>Month</b> and <b>Day of the Week</b>, and there are a number of supported <b>Display</b> options for each of these (e.g. Month can "Jan", "January" or "J" in addition to the month display options used in date notations). 
</p><p><br />
<i><b>For more information, see:</b></i>
</p>
<ul><li> The <b>Column Properties</b> dialog box <a href="../../UserGuide/UserGuide/The_(Column_Properties)_Properties_Tab.html#Format" title="UserGuide:The (Column Properties) Properties Tab"><b>Format</b></a> options.</li>
<li> The <b>Column Properties</b> dialog box <a href="../../UserGuide/UserGuide/The_(Column_Properties)_Properties_Tab.html#Display" title="UserGuide:The (Column Properties) Properties Tab"><b>Display</b></a> options.</li></ul>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Date_Time_Math_Operations/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>If your date-time column contains missing values ("--"), see this <a href="../../UserGuide/UserGuide/Dates_and_Times_in_the_Worksheet.html#A_Note_about_Missing_Values_in_Date-Time_Data" title="UserGuide:Dates and Times in the Worksheet">Note about Missing Values in Date-Time Data</a>.
</p></td></tr></table>
<h2><a name="Date_and_time_math_operations:_dates_and_times"></a><span class="mw-headline">Date and time math operations: dates and times</span></h2>
<p>If you have a worksheet where your column "A" contains some date-time values and your column "B" contains some measurement made at each date-time value in column "A", you might want to know how much time had elapsed between each measurement. You can easily determine this by creating a third column "C", then use <a href="../../UserGuide/UserGuide/Quick_Start_SetColumnValues.html" title="UserGuide:Quick Start SetColumnValues">the <b>Set Values</b> dialog box</a> to generate a dataset of elapsed time between measurements.
</p>
<pre class="lt" style="font-family:monospace;">A<span style="color: #000000;">&#91;</span>i<span style="color: #000000;">&#93;</span><span style="color: #000080;">-</span>A<span style="color: #000000;">&#91;</span>i<span style="color: #000080;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span>   <span style="color: #008000;">//for i = 2 to last row of column A</span></pre>
<dl><dd><dl><dd><a  class="image"><img alt="Date Time Math 01.png" src="../images/Date_Time_Math_Operations/Date_Time_Math_01.png?v=81693" width="713"  /></a></dd></dl></dd></dl>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Date_Time_Math_Operations/Alert_icon.png?v=9649" width="57"  border="0" /></td><td><p><b>Origin 2021b</b> increased the limitation of <i>Time</i> formats <i>from 240 to 548 days</i> (i.e. you can now enter 13151:00 into a <i>Time</i> column set to <b>Display</b> = <i>HH:mm</i> and it will display as 13151:00, but entering 13152:00 will display as 00:00). When doing elapsed time calculations involving the passage of 548+ days, changing column <b>Format</b> from <i>Time</i> to <i>Numeric</i> will allow you to track time in days, including any fractional component.
</p>
	</td>
	</tr>
	</table>
<h2><a name="Date_and_time_math_operations:_months"></a><span class="mw-headline">Date and time math operations: months</span></h2>
<p>As mentioned, there are a number of Origin functions that can be used to manipulate numeric and date-time text strings. A listing of <a class="external text" href="../../LabTalk/Script/LabTalk-Supported_Functions.html">these functions</a> is found in the LabTalk Scripting Guide. When converting numeric values to month representations, Origin uses one of these functions - the <b>mod</b> (modulus) function.
</p><p><b>Months</b> are enumerated from January (1) to December (12). Numbers greater than 12 are handled by a modulus function (see <a class="external text" href="../../LabTalk/LabTalk/Mod_(function).html">Mod</a>) when converted to <b>Month</b>. The LabTalk modulus function uses the following syntax:
</p><p><b>mod(x,y)</b> = the remainder from division of integer x divided by integer y.
</p><p>For Example:
</p><p>46 translates to October because <b>mod(46,12)</b> is 10, and 10 is October (December = 0).  
</p><p>Note that you cannot type values outside the range 1 to 12 into a cell in a column in which <b>Format</b> has been set to <b>Month</b>. If you do so, Origin displays a missing value in the cell. To type such numbers into the worksheet, set the Format to <b>Text &amp; Numeric</b> and enter your numbers. Then, you can return the column <b>Format</b> to <b>Month</b>.
</p>
<h2><a name="Date_and_time_math_operations:_days"></a><span class="mw-headline">Date and time math operations: days</span></h2>
<p><b>Day of Week</b> is enumerated from Sunday (0) to Saturday (6). Numbers greater than 6 are handled by a <a class="external text" href="../../LabTalk/LabTalk/Mod_(function).html">modulus function</a> when converted to <b>Day</b>.
</p><p>For Example:
</p><p>46 translates to Thursday because <b>mod(46,7)</b> is 4, and 4 is Thursday.  
</p><p>Note that you cannot type values outside the range 0 to 6 into a cell in a column in which <b>Format</b> has been set to <b>Day of Week</b>. If you do so, Origin displays a missing value in the cell. To type such numbers into the worksheet, set the <b>Format</b> to <b>Text &amp; Numeric</b> and enter your numbers. Then, you can return the column <b>Format</b> to <b>Day of Week</b>.
</p>

