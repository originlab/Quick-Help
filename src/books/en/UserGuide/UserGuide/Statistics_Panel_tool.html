<h1 class="firstHeading">11.15 The Statistics Gadget</h1><p class='urlname' style='display: none'>Gadget-Statistics</p>
<div class="toclimit-2"><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Overview"><span class="tocnumber">1</span> <span class="toctext">Overview</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#To_Use_Statistics_Gadget"><span class="tocnumber">1.1</span> <span class="toctext">To Use Statistics Gadget</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-3"><a href="#ROI_Box_tab"><span class="tocnumber">2</span> <span class="toctext">ROI Box tab</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Show_on_Center-Top_of_ROI_Box_tab"><span class="tocnumber">3</span> <span class="toctext">Show on Center-Top of ROI Box tab</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Output_To_tab"><span class="tocnumber">4</span> <span class="toctext">Output To tab</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Quantities_tab"><span class="tocnumber">5</span> <span class="toctext">Quantities tab</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Fly-out_Menu"><span class="tocnumber">6</span> <span class="toctext">Fly-out Menu</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Example"><span class="tocnumber">7</span> <span class="toctext">Example</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Algorithm"><span class="tocnumber">8</span> <span class="toctext">Algorithm</span></a></li>
</ul>
</div>
</div>
<h2><a name="Overview"></a><span class="mw-headline">Overview</span></h2>
<p>The <b>Statistics Gadget</b> (the <a class="external text" href="../../XFunction/X-Function/Addtool_curve_stats.html">addtool_curve_stats</a> X-Function) can be used to obtain basic statistics information on data covered by the rectangle of the Region Of Interest (ROI).
</p>
<dl><dd><dl><dd><a  class="image"><img alt="Statistics Gadget.png" src="../images/Statistics_Panel_tool/350px-Statistics_Gadget.png?v=70993" width="350"   /></a></dd></dl></dd></dl>
<p>With this gadget you can:
</p>
<ul><li> Display results on the top of the ROI.</li>
<li> Display mean and nth Standard Deviation lines inside the ROI.</li>
<li> Display updated results when moving ROI.</li>
<li> Easily select a data plot from existing plots in the graph layer.</li></ul>
<h5><a name="To_Use_Statistics_Gadget"></a><span class="mw-headline">To Use Statistics Gadget</span></h5>
<p>To use this tool, select <b>Gadgets: Statistics</b> from the Origin menu when a graph is active.
</p>
<h2><a name="ROI_Box_tab"></a><span class="mw-headline">ROI Box tab</span></h2>
<dl><dd><a  class="image"><img alt="Statistics Gadget ROI Box Tab.png" src="../images/Statistics_Panel_tool/Statistics_Gadget_ROI_Box_Tab.png?v=82405" width="369"  /></a></dd></dl>
<table class="dialogcontroltable">

<tr>
<th>X Scale (XScale)
</th>
<td> Specify the X Data range for the ROI.
<dl><dd><b>From (leftx)</b>
<dl><dd>The beginning of X scale.</dd></dl></dd>
<dd><b>To (rightx)</b>
<dl><dd>The ending of X scale.</dd></dl></dd>
<dd><b>Fixed (Prevent moving by ROI) (fixscale)</b>
<dl><dd>Fix the X scale to prevent from moving by ROI box.</dd></dl></dd></dl>
</td></tr>
<tr>
<th><b>Show Tool Name (toolname)</b>
</th>
<td> Specify whether to show the tool name in the top-left corner of the rectangle in the graph.
</td></tr>
<tr>
<th><b>Fill Color (rectcolor)</b>
</th>
<td> Assign a color to the region-of-interest (ROI). For help with Origin's Color Chooser, see <a href="../../UserGuide/UserGuide/Customizing_Data_Plot_Colors.html" title="UserGuide:Customizing Data Plot Colors">Customizing Data Plot Colors</a>.
</td></tr>
<tr>
<th><b>Show Mean Line (meanline)</b>
</th>
<td> Specify whether to show the mean line of the covered data by the rectangle. The default setting is <b>1</b>.
<dl><dd><b>Style (style)</b>
<dl><dd>Select the desired line connection from this drop-down list.</dd></dl></dd>
<dd><b>Width (width)</b>
<dl><dd>Type or select the desired line width in this combination box. The line width is measured in points, where 1 point=1/72 inch.</dd></dl></dd>
<dd><b>Color (color)</b>
<dl><dd>Select the desired line color from this drop-down list. For help with Origin's Color Chooser, see <a href="../../UserGuide/UserGuide/Customizing_Data_Plot_Colors.html" title="UserGuide:Customizing Data Plot Colors">Customizing Data Plot Colors</a></dd></dl></dd></dl>
</td></tr>
<tr>
<th><b>Show Standard Deviation Lines (sdline)</b>
</th>
<td> Specify whether to show the standard deviation line of the covered data by the rectangle. The default setting is 0 (unchecked).
<dl><dd><b>Multiple of SD (nSD)</b>
<dl><dd>Specify the factor for the standard deviation value, to plot the standard deviation line.</dd></dl></dd>
<dd><b>Style (style)</b>
<dl><dd>Select the desired line connection from this drop-down list.</dd></dl></dd>
<dd><b>Width (width)</b>
<dl><dd>Type or select the desired line width in this combination box.</dd></dl></dd>
<dd><b>Color (sdcolor)</b>
<dl><dd>Specify the color of the standard deviation line. For help with Origin's Color Chooser, see <a href="../../UserGuide/UserGuide/Customizing_Data_Plot_Colors.html" title="UserGuide:Customizing Data Plot Colors">Customizing Data Plot Colors</a></dd></dl></dd></dl>
</td></tr>
<tr>
<th><b>Show Minimum and Maximum Lines (extremumline)</b>
</th>
<td>Specify whether to show the minimun and maximum lines of the covered data by the rectangle. The default setting is 0 (unchecked).
<dl><dd><b>Style (style)</b>
<dl><dd>Select the desired line connection from this drop-down list.</dd></dl></dd>
<dd><b>Width (width)</b>
<dl><dd>Type or select the desired line width in this combination box.</dd></dl></dd>
<dd><b>Color (color)</b>
<dl><dd>Specify the color of the maximum and minimum lines. For help with Origin's Color Chooser, see <a href="../../UserGuide/UserGuide/Customizing_Data_Plot_Colors.html" title="UserGuide:Customizing Data Plot Colors">Customizing Data Plot Colors</a></dd></dl></dd>
<dd><b>Value (valForm)</b>
<dl><dd>Specify the quantities used for label of maxmimum and minimum from this drop-down list: <b>&lt;X,Y&gt;</b> uses both X and Y values of the maximum and minimu data as labels, while <b>Y</b> uses only Y value as labels.</dd></dl></dd></dl>
</td></tr>
<tr>
<th><b>Line Length (linelength)</b>
</th>
<td>Specify the length of Mean and/or SD line. Options include:
<ul><li><b>Within ROI Box (0)</b>: Show line(s) within ROI rectangle.</li>
<li><b>Span to Layer (1)</b>: Expand to show line(s) in whole layer.</li>
<li><b>Custom (2)</b>: Specify to show line(s) within a range defined by <b>From</b> and <b>To</b>.</li></ul>
</td></tr>
<tr>
<th><b>Line Label Position (linelabelpos)</b>
</th>
<td>Specify where to put the label of the line. Options include:
<ul><li><b>None (0)</b>: Do not show the label of line.</li>
<li><b>Inner Left (1)</b>: Show the label of line in the left side of the rectangle.</li>
<li><b>Inner Right (2)</b>: Show the label of line in the right side of the rectangle.</li>
<li><b>Outer Left (3)</b>: Show the label of line to the left of the rectangle.</li>
<li><b>Outer Right (4)</b>: Show the label of line to the right of the rectangle.</li></ul>
</td></tr>
<tr>
<th> <b>Label Form (labelform)</b>
</th>
<td>
<ul><li><b>Value (0)</b>: Tag mean and std. deviation lines with their respective values.</li>
<li><b>Label (1)</b>: Tag mean and std. deviation lines with their respective labels.</li>
<li><b>Both (2)</b>: Tag with both labels and values.</li></ul>
</td></tr></table>
<h2><a name="Show_on_Center-Top_of_ROI_Box_tab"></a><span class="mw-headline">Show on Center-Top of ROI Box tab</span></h2>
<dl><dd><a  class="image"><img alt="Statistics Gadget Show Top Tab.png" src="../images/Statistics_Panel_tool/Statistics_Gadget_Show_Top_Tab.png?v=82390" width="369"  /></a></dd></dl>
<table class="dialogcontroltable">

<tr>
<th><b>N (n)</b>
</th>
<td> Specify whether to show the number of selected data points at the top of the ROI. The default setting is <b>checked (1)</b>.
</td></tr>
<tr>
<th><b>Mean (mean)</b>
</th>
<td> Specify whether to show the mean value of the selected data points at the top of the ROI. The default setting is <b>checked (1)</b>.
</td></tr>
<tr>
<th><b>SD (sd)</b>
</th>
<td> Specify whether to show the standard deviation of the selected data points at the top of the ROI. The default setting is <b>checked (1)</b>.
</td></tr>
<tr>
<th><b>Minimum (min)</b>
</th>
<td> Specify whether to show the minimum Y value of the selected data points at the top of the ROI. The default setting is <b>unchecked (0)</b>.
</td></tr>
<tr>
<th><b>X at Minimum (xmin)</b>
</th>
<td> Specify whether to show the X coordinate of the minimum data point at the top of the ROI. The default setting is <b>unchecked (0)</b>.
</td></tr>
<tr>
<th><b>Maximum (max)</b>
</th>
<td> Specify whether to show the maximum Y value of the selected data points at the top of the ROI. The default setting is <b>unchecked (0)</b>.
</td></tr>
<tr>
<th><b>X at Maximum (xmax)</b>
</th>
<td> Specify whether to show the X coordinate of the maximum data point at the top of the ROI. The default setting is <b>unchecked (0)</b>.
</td></tr>
<tr>
<th><b>Sum (sum)</b>
</th>
<td> Specify whether to show the sum of the selected data points at the top of the ROI. The default setting is <b>unchecked (0)</b>.
</td></tr>
<tr>
<th><b>Custom Label</b>
</th>
<td>
<p>Check this box to define a custom label in the accompanying text box. 
</p>
<dl><dd><a  class="image"><img alt="UG stats gadget custom label.png" src="../images/Statistics_Panel_tool/UG_stats_gadget_custom_label.png?v=91650" width="667"  /></a></dd></dl>
<ul><li> Must have <b>Origin 2022b</b> or later.</li>
<li> Build your custom label using a mix of (a) literal text (b) <a class="external text" href="../../UserGuide/UserGuide/Escape_Sequences.html#Available_text_formatting_commands">escape sequences</a> (e.g. Greek symbols or superscripts) and (c) custom variables (listed below). Specify decimal places, etc. using <a class="external text" href="../../UserGuide/UserGuide/Custom_Numeric_Format.html#Significant_Digits.2C_Decimal_Places.2C_Scientific_and_Engineering_Formats">Origin custom formats</a>.</li>
<li> Custom labels are preserved and updated when you select new output. </li>
<li> Custom labels can be saved as part of a <a href="../../UserGuide/UserGuide/Dialog_Themes.html" title="UserGuide:Dialog Themes"><b>Dialog Theme</b></a>.</li></ul>
<dl><dd><table class="simple" style="width: 95%">
<tr>
<th style="width: 20%">Dialog Label
</th>
<th style="width: 20%">Custom Variable
</th>
<th style="width: 55%">Example
</th></tr>
<tr>
<td> N
</td>
<td> n
</td>
<td> Count = $(n)
</td></tr>
<tr>
<td> Mean
</td>
<td> mean
</td>
<td> \g(m) = $(mean, *4)
</td></tr>
<tr>
<td> SD
</td>
<td> sd
</td>
<td> \g(s) = $(sd, .2)
</td></tr>
<tr>
<td> Minimum
</td>
<td> min
</td>
<td> Min = $(min, .2)
</td></tr>
<tr>
<td> X at Minimum
</td>
<td> xminy
</td>
<td> X Min = $(xminy, .2)
</td></tr>
<tr>
<td> Maximum
</td>
<td> max
</td>
<td> Max = $(max, .2)
</td></tr>
<tr>
<td> X at Maximum
</td>
<td> xmaxy
</td>
<td> X max = $(xmaxy), .2)
</td></tr>
<tr>
<td> Sum
</td>
<td> sum
</td>
<td> \g(S) = $(sum, .1)
</td></tr></table></dd></dl>
</td></tr></table></dd></dl>
<h2><a name="Output_To_tab"></a><span class="mw-headline">Output To tab</span></h2>
<dl><dd><a  class="image"><img alt="Statistics Gadget Output To Tab.png" src="../images/Statistics_Panel_tool/Statistics_Gadget_Output_To_Tab.png?v=93990" width="395"  /></a></dd></dl>
<table class="dialogcontroltable">

<tr>
<th><b>Script Window (script)</b>
</th>
<td> Specify whether to output the results to the Script window.  The default setting is <b>checked (1)</b>.
</td></tr>
<tr>
<th><b>Result Log (reslog)</b>
</th>
<td> Specify whether to output the results to the Results Log.  The default setting is <b>checked (1)</b>.
</td></tr>
<tr>
<th><b>Append to Worksheet (appendwks)</b>
</th>
<td> Specify whether to append the results to a worksheet.  The default setting is <b>unchecked (0)</b>.
</td></tr>
<tr>
<th><b>Result Worksheet Name</b>
<p>(wksName)
</p>
</th>
<td> This is only available when <b>Append to Worksheet (appendwks)</b> is selected. It is used to specify the name of the worksheet:
<ul><li> When you generate new output, results are output to <b>[%H-QkStats]Result</b>  by default (here <b>%H</b> means the Short Name of source graph), but other books and sheets can be specified. If the book and sheet do not exist, they will be created on output.</li>
<li> Alternately, you can click the flyout button <a  class="image"><img alt="Gadget flyout button.png" src="../images/Statistics_Panel_tool/Gadget_flyout_button.png?v=84659" width="18"  /></a> to the right of <b>Result Worksheet Name</b> and choose <b>Sheet in Input Book</b>. This fills the edit box with <b>[&lt;input&gt;]Result</b>. When you generate new output, results are output to a sheet named <b>Result</b> in the source book.</li></ul>
</td></tr></table>
<h2><a name="Quantities_tab"></a><span class="mw-headline">Quantities tab</span></h2>
<dl><dd><a  class="image"><img alt="Statistics Gadget Quantities Tab.png" src="../images/Statistics_Panel_tool/Statistics_Gadget_Quantities_Tab.png?v=82391" width="369"  /></a></dd></dl>
<table class="dialogcontroltable">

<tr>
<th><b>Dataset Identifier (name)</b>
</th>
<td> Specify a dataset identifier in the drop-down list. The default setting is <b>Plot Legend (5)</b>.
</td></tr>
<tr>
<th><b>Input Range Index (range)</b>
</th>
<td>Specify whether to output the input range index. The default setting is <b>checked (1)</b>.
</td></tr>
<tr>
<th><b>N (n)</b>
</th>
<td>Specify whether to output the number of input data points. The default setting is <b>checked (1)</b>.
</td></tr>
<tr>
<th><b>Sum (sum)</b>
</th>
<td>Specify whether to output the sum of the input data range.  The default setting is <b>checked (1)</b>.
</td></tr>
<tr>
<th><b>Mean (mean)</b>
</th>
<td>Specify whether to output the mean of the input data range.  The default setting is <b>checked (1)</b>.
</td></tr>
<tr>
<th><b>Median (median)</b>
</th>
<td>Specify whether to output the median of the input data range.  The default setting is <b>checked (1)</b>.
</td></tr>
<tr>
<th><b>SD (sd)</b>
</th>
<td>Specify whether to output the standard deviation of the input data range.  The default setting is <b>checked (1)</b>.
</td></tr>
<tr>
<th><b>Minimum (min)</b>
</th>
<td>Specify whether to output the minimum Y value of the input data points. The default setting is <b>checked (1)</b>.
</td></tr>
<tr>
<th><b>X at Minimum (xmin)</b>
</th>
<td> Specify whether to output the X coordinate of the minimum data point. The default setting is <b>unchecked (0)</b>.
</td></tr>
<tr>
<th><b>Maximum (max)</b>
</th>
<td>Specify whether to output the maximum Y value of the input data points. The default setting is <b>checked (1)</b>.
</td></tr>
<tr>
<th><b>X at Maximum (xmax)</b>
</th>
<td> Specify whether to output the X coordinate of the maximum data point. The default setting is <b>unchecked (0)</b>.
</td></tr>
<tr>
<th><b>SE of Mean (sem)</b>
</th>
<td>Specify whether to output the Standar Error of mean. The default setting is <b>unchecked (0)</b>.
</td></tr>
<tr>
<th><b>Lower 95% CI of Mean (LCL)</b>
</th>
<td>Specify whether to output the lower limit of the 95% confidence interval of mean. The default setting is <b>unchecked (0)</b>.
</td></tr>
<tr>
<th><b>Upper 95% CI of Mean (UCL)</b>
</th>
<td>Specify whether to output the upper limit of the 95% confidence interval of mean. The default setting is <b>unchecked (0)</b>.
</td></tr>
<tr>
<th><b>Percentitle(s) (percentile)</b>
</th>
<td>Specify whether to output the custom percentiles. The percentile value can be typed in <b>Percentile List</b> combo box below. The default setting is <b>unchecked (0)</b>.
</td></tr>
<tr>
<th><b>Percentile List (percentileList)</b>
</th>
<td>Specify the custom percentile values. Allow space separated numbers. The default setting is <b>90 95 99</b>.
</td></tr></table>
<h2><a name="Fly-out_Menu"></a><span class="mw-headline">Fly-out Menu</span></h2>
<table class="dialogcontroltable">

<tr>
<th>New Output (0)
</th>
<td>Output the new results. The destination of the output is specified on the <b>Output To</b> tab of the <b>Statistics Preferences</b> dialog.
</td></tr>
<tr>
<th>Go to Report Worksheet
</th>
<td>Activate the report worksheet, if there is one.
</td></tr>
<tr>
<th>Output to Clipboard
</th>
<td>When selected (menu item checked) <b>New Output</b> will be placed on the Clipboard.
</td></tr>
<tr>
<th>Tag Lines
</th>
<td>Add the shown lines(mean line and SD line) as line object. And the label attach to the line will be added as text object which can be deleted or modified. Close the gadget will not delete the line and text.
</td></tr>
<tr>
<th>Change Data
</th>
<td>Change the source data set. This is applicable only when there are multiple curves on the graph layer. By default, all plots in current layer will be selected. Change fitting data/plot. By default, all plots in current layer will be selected.
<ul><li> Clear the check marks in front of <b>All Plots</b> to deselect all.</li>
<li> Place a check mark in front of any plot to select that plot.</li>
<li> Click <b>Select...</b> or <b>More...</b> to open the <b>Select Plot(s)</b> dialog.</li>
<li> <b>Auto</b> mode is initially dimmed but can be enabled once <b>All Plots</b> is cleared. When checked, the target data/plot will follow the data plot selection/highlighting outside the ROI box on the graph. In Origin 2019 and earlier versions, Origin doesn't support this <i>auto</i> behavior; to change the target plot/data, you have to select from the fly-out list or the <b>Select Plot(s)</b> dialog.</li></ul>
</td></tr>
<tr>
<th>Expand to Full Plot(s) Range
</th>
<td>Expand the ROI box to full plot range.
</td></tr>
<tr>
<th>Fix ROI Position
</th>
<td>Fix the ROI position, then you cannot move it any more.
</td></tr>
<tr>
<th>Save Theme
</th>
<td>Save theme for the dialog settings.
</td></tr>
<tr>
<th>Save as &lt;default&gt;
</th>
<td>Save the current dialog settings as default theme.
</td></tr>
<tr>
<th>Load Theme
</th>
<td>Load the existed theme to apply the dialog settings.
</td></tr>
<tr>
<th>Preferences
</th>
<td>Open the <b>Statistics Preferences</b> dialog, which is similar to the one when starting the gadget by selecting menu <b>Gadgets: Statistics</b>.
</td></tr></table>
<h2><a name="Example"></a><span class="mw-headline">Example</span></h2>
<ol><li>Create a new worksheet.</li>
<li>Import the Origin sample data file <i>not_monotonic_multicurve.dat</i>, which is located in <i>&lt;Origin Program Folder&gt;\Samples\Data Manipulation</i>. </li>
<li>Highlight col(B) and select <b>Plot: Line: Line</b> from the Origin menu to draw a graph.
<dl><dd><a  class="image"><img alt="Quick Statistic tool 01.png" src="../images/Statistics_Panel_tool/Quick_Statistic_tool_01.png?v=68568" width="419"  /></a></dd></dl></li>
<li>Select <b>Gadgets: Statistics: Open Dialog</b> from the Origin menu when the graph window is active, to bring up the <b>Data Exploration: addtool_curve_stats</b> dialog box.</li>
<li>Keep the default settings and click <b>OK</b> to add the ROI box to the graph. Adjust the size and position of the ROI box to select a data range as below.
<dl><dd><a  class="image"><img alt="Quick Statistic tool 02.png" src="../images/Statistics_Panel_tool/Quick_Statistic_tool_02.png?v=68569" width="419"  /></a></dd></dl></li>
<li>Click the <a  class="image"><img alt="ROI arrow.png" src="../images/Statistics_Panel_tool/ROI_arrow.png?v=21409" width="11"  /></a> button at the top of the rectangle to select <b>New Output</b> from the fly-out menu. The result is output to the <b>Script Window</b> and the <b>Results Log</b>, which is the default output destination.
<dl><dd><a  class="image"><img alt="Quick Statistic tool 03.png" src="../images/Statistics_Panel_tool/Quick_Statistic_tool_03.png?v=68570" width="419"  /></a></dd></dl></li>
<li>Click the <a  class="image"><img alt="ROI arrow.png" src="../images/Statistics_Panel_tool/ROI_arrow.png?v=21409" width="11"  /></a> button again to select <b>Tag Lines</b> from the fly-out menu. A line with the mean value is added.
<dl><dd><a  class="image"><img alt="Quick Statistic tool 04.png" src="../images/Statistics_Panel_tool/Quick_Statistic_tool_04.png?v=68571" width="419"  /></a></dd></dl></li></ol>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Statistics_Panel_tool/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>To toggle the display of all gadget ROI boxes in a graph at the same time, click the <b>H</b> button <a  class="image"><img alt="H Button.png" src="../images/Statistics_Panel_tool/H_Button.png?v=48156" width="19"  /></a> in the top right corner of the graph, which enables users to export the graph with gadget results.
</p></td></tr></table>
<h2><a name="Algorithm"></a><span class="mw-headline">Algorithm</span></h2>
<p>This tool is designed to perform descriptive statistics on a curve in the graph window. For more information about calculation, please refer to <a class="external text" href="../../XFunction/X-Function/Stats.html#Algorithm">the algorithm of X-Function <b>stats</b></a>.
</p>

