<h1 class="firstHeading">8.6.1.3 Linking Text Labels to Data and Variables</h1><p class='urlname' style='display: none'>LinkVar-TextLabel</p>
<p>Text labels can as simple as a static literal text or <a class="external text" href="../../LabTalk/Category/Substitution_Notation.html">LabTalk substitution notation</a> string which does run-time string substitution to show a wide variety of project information, such as workbook, worksheet, column, cell values or metadata, data file info, or even data statistics, etc.  
</p>
<dl><dd><dl><dd><a  class="image"><img alt="Link to cell.png" src="../images/Linking_Text_Labels_to_Data_and_Variables/Link_to_cell.png?v=94479" width="240"  /></a></dd></dl></dd></dl>
<p>Some of the text labels are auto generated by Origin, such as axis titles, legends, data point labels, while others are manually added by the <b>Text</b> or <b>Annotation</b> tools. For manually added labels, please make sure the <b>Link to Substitution</b> is checked or set to 1 or above on <b>Programming</b> tab of <b>Text Object</b> dialog.
</p>
<dl><dd><a  class="image"><img alt="Link to SubStitution.png" src="../images/Linking_Text_Labels_to_Data_and_Variables/Link_to_SubStitution.png?v=94478" width="633"  /></a></dd></dl>
<p>Within the context of the graph window, text labels can be lumped into two groups:
</p>
<ul><li> <b>Graph text labels</b>: These include auto generated axis titles and graph legends, as well as labels added with the <b>Text</b> tool <a  class="image"><img alt="Button Text Tool.png" src="../images/Linking_Text_Labels_to_Data_and_Variables/Button_Text_Tool.png?v=1948" width="23"  /></a>. We will mainly discuss labels added by <b>Text</b> tool here. See these pages for information on <a href="../../UserGuide/Category/Graph_Legends_and_Color_Scales.html" title="Category:Graph Legends and Color Scales">Graph Legends</a> or <a href="../../UserGuide/UserGuide/Title_2.html#Text" title="UserGuide:Title 2">Axis Titles</a>.</li>
<li> <b>Data Plot Labels</b>: These are labels applied to data points (single points or entire datasets) either using the <b>Annotation</b> tool or by enabling labels using Plot Details Label tab controls. See <a href="../../UserGuide/UserGuide/Labelling_Data_Points.html" title="UserGuide:Labelling Data Points">Labeling Data Points</a> for information.</li></ul>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Substituting_Worksheet_Cell_Values_in_Text_Labels"><span class="tocnumber">1</span> <span class="toctext">Substituting Worksheet Cell Values in Text Labels</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Substituting_Column_Label_Row_Values_.28Metadata.29_in_Text_Labels"><span class="tocnumber">2</span> <span class="toctext">Substituting Column Label Row Values (Metadata) in Text Labels</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Substituting_Dataset_Statistics_in_Text_Labels"><span class="tocnumber">3</span> <span class="toctext">Substituting Dataset Statistics in Text Labels</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Substituting_Info_Variable_in_Text_Labels"><span class="tocnumber">4</span> <span class="toctext">Substituting Info Variable in Text Labels</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Substituting_Variable_Values_in_Text_Labels"><span class="tocnumber">5</span> <span class="toctext">Substituting Variable Values in Text Labels</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#Example_1._Use_Reserved_String_Registers"><span class="tocnumber">5.1</span> <span class="toctext">Example 1. Use Reserved String Registers</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Example_2._Numeric_Substitution"><span class="tocnumber">5.2</span> <span class="toctext">Example 2. Numeric Substitution</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8"><a href="#Resolving_Math_Expressions_in_Text_Labels"><span class="tocnumber">6</span> <span class="toctext">Resolving Math Expressions in Text Labels</span></a>
<ul>
<li class="toclevel-2 tocsection-9"><a href="#Example._Resolving_pi_in_text_label"><span class="tocnumber">6.1</span> <span class="toctext">Example. Resolving pi in text label</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-10"><a href="#Adding_Date-Time_in_Text_Labels"><span class="tocnumber">7</span> <span class="toctext">Adding Date-Time in Text Labels</span></a>
<ul>
<li class="toclevel-2 tocsection-11"><a href="#As_a_static_text_object"><span class="tocnumber">7.1</span> <span class="toctext">As a static text object</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#As_a_dynamic_text_object"><span class="tocnumber">7.2</span> <span class="toctext">As a dynamic text object</span></a>
<ul>
<li class="toclevel-3 tocsection-13"><a href="#Adding_a_date-time_label_using_LabTalk_substitution"><span class="tocnumber">7.2.1</span> <span class="toctext">Adding a date-time label using LabTalk substitution</span></a></li>
<li class="toclevel-3 tocsection-14"><a href="#Adding_date-time_by_running_LabTalk_script_in_the_label"><span class="tocnumber">7.2.2</span> <span class="toctext">Adding date-time by running LabTalk script in the label</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>

<h2><a name="Substituting_Worksheet_Cell_Values_in_Text_Labels"></a><span class="mw-headline">Substituting Worksheet Cell Values in Text Labels</span></h2>
<p>The simplest way to show worksheet cell value in Text Labels is by copy and paste link.
</p>
<dl><dd><ol><li> Click on a worksheet cell and press CTRL+C (or right-click and <b>Copy</b>). </li>
<li> Use the <b>Text</b> tool to create your literal text (e.g. <i>The value of y is:</i>), then while still in label edit mode, right-click and choose <b>Paste Link</b>.</li>
<li> Origin adds the worksheet cell subtitution notation for you. </li></ol></dd></dl>
<p>A change to the worksheet cell value will trigger a change to the value shown in your label.
</p><p>Though paste link is adequate for most users, it's still good to understand the worksheet cell <a class="external text" href="../../LabTalk/Category/Substitution_Notation.html">Substitution</a> to know what options there is in Origin.
</p><p>For substitution to work, please first click on text label and check <b>Link to Substitution</b> on mini toolbar. Or right-click on the text label and choose Properties. On the Programming tab, set <b>Link to (%,$), Substitution Level</b> to <b>1</b> and click OK.
</p><p><br />
</p>
<table class="simple" style="width: 90%">
<tr>
<th style="width: 15%">Syntax
</th>
<th style="width: 20%">Description
</th>
<th style="width: 55%">Example
</th></tr>
<tr>
<td>
<p><i>%(workbookName, Column, row#[, format])</i> 
</p>
</td>
<td> column, row of active sheet in workbook
</td>
<td>
<pre>//book1, active sheet, 2nd column, 5th row, full precision
%(Book1,2,5) 
//book1, active sheet, column B, row, 2 decimal places
%(Book1,B,5, .2) 
</pre>
</td></tr>
<tr>
<td><i>%([workbookName]Sheet, Column, row#[, format])</i>
</td>
<td> column, row of specified sheet in workbook
</td>
<td>
<pre>//book1, sheet1, 2nd col, 5th row, full precision
%([Book1]Sheet1,2,5) 
</pre>
<p>//book1, sheet1, 2nd col, 5th row, 3 significant digits
</p>
<pre>%([Book1]Sheet1,2,5, *3) 
</pre>
</td></tr>
<tr>
<td><i>%(workbookName, @WL, column[row] [,format])</i>
</td>
<td> column, row of active sheet in workbook
</td>
<td>
<pre>//book1, active sheet, column 2, 5th row, full precision
%(Book1, @WL, 2[5])
//book1, active sheet, column B, 5th row
%(Book1,@WL, B[5], .2)
</pre>
</td></tr>
<tr>
<td><i>%([workbookName]sheetName, @WL, column[row] [,format])</i>
</td>
<td> column, row of specified sheet in workbook
</td>
<td>
<pre>//show value of book1, sheet1, 2nd col, 5th row, full precision
%([Book1]Sheet1,@WL, 2[5]) 
//book1, sheet1, 2nd col, 5th row, same display as worksheet cell
%([Book1]Sheet1,@WL, B[5], W)
</pre>
</td></tr>
<tr>
<td> <i>%(plotindex, @WT, column, row[, format]</i>)
</td>
<td> column, or of source worksheet of specified plot
</td>
<td>
<pre>//1st plot's worksheet, column F, row 5
%(1, @WT,F,5) 
//2nd plot's Y data sheet, 6th col, 5th row, 2 decimal places
%(2Y, @WT,6,5, .2) 
</pre>
</td></tr></table>
<p>Note:
</p>
<dl><dd><ul><li> The advantage of the <b>@WT</b> method is that the worksheet column that @WT refers is identified by plot source. When you save the graph as a Graph Template and reuse it later, the display content of the text label will automatically update according to the new data, even if dataset name is changed.</li>
<li> The  <b>%(1, @WT,<i>ColIndex</i>,<i>RowIndex</i>)</b> notation can be used to reference a matrixsheet value. </li>
<li> format is optional. If skipped, it will use full precision. See supported <a class="external text" href="../../LabTalk/LabTalk/Origin_Formats.html">Origin Formats</a>.</li>
<li> for <b>@WL</b>, the format can be <b>W</b>  to use the cell format or column format in worksheet so WYSIWYG</li></ul></dd></dl>
<p>The following graph shows a text label of Start Date with a customized A1 cell value in MM/DD/YYYY format
</p>
<dl><dd><a  class="image"><img alt="Text label cell.png" src="../images/Linking_Text_Labels_to_Data_and_Variables/Text_label_cell.png?v=94470" width="579"  /></a></dd></dl>
<h2><a name="Substituting_Column_Label_Row_Values_.28Metadata.29_in_Text_Labels"></a><span class="mw-headline">Substituting Column Label Row Values (Metadata) in Text Labels</span></h2>
<p>In addition to data row cells, you can substitute values from column label row cells in your text labels. Again, for substitution to work, click on text label and check <b>Link to Substitution</b> on mini toolbar. Or right-click on the text label and choose Properties. On the Programming tab, set <b>Link to (%,$), Substitution Level</b> to <b>1</b> and click OK.
</p><p>There are several syntaxes that will work, depending upon your needs.
</p>
<dl><dd><ul><li> <b>%(PlotIndex, @option<i>[,arguemnt]</i> )</b> </li>
<li> <b>%(PlotIndex[PlotDesignChar], @option)</b></li>
<li> <b>%(PlotIndex,@WT,ColIndex, LabelRowChar)</b></li></ul></dd></dl>
<p>The last option uses a <a class="external text" href="../../LabTalk/LabTalk/Column_Label_Row_Characters.html">Column Label Row Character</a> (LabelRowChar).
</p>
<table class="simple" style="width: 80%">
<tr>
<th style="width: 20%">Example
</th>
<th style="width: 60%">Description
</th></tr>
<tr>
<td>&#160;%(1, @LD"Mean")
</td>
<td> User-defined parameter row value of 1st plot's column
</td></tr>
<tr>
<td>&#160;%(1, @LF, B)
</td>
<td> 1st plot's B column filter condition
</td></tr>
<tr>
<td> $(%(2Y, @LC), .2)
</td>
<td> comment of 2nd plot's Y column, show 2 decimal places
</td></tr>
<tr>
<td>&#160;%(1X, @WT, 5, D2)
</td>
<td> 5th column's 2nd user-parameter row value on worksheet where 1st plot's X data is located
</td></tr></table>
<p>The following graph is plotted with column C and D. Text label shows column B's filter condition.
</p>
<dl><dd><a  class="image"><img alt="Link to b filter.png" src="../images/Linking_Text_Labels_to_Data_and_Variables/Link_to_b_filter.png?v=94486" width="576"  /></a></dd></dl>
<p><br />
</p>
<h2><a name="Substituting_Dataset_Statistics_in_Text_Labels"></a><span class="mw-headline">Substituting Dataset Statistics in Text Labels</span></h2>
<p>You can also LabTalk functions to calculate dataset statistics and show the result in text label. Again, for substitution to work, click on text label and check <b>Link to Substitution</b> on mini toolbar. Or right-click on the text label and choose Properties. On the Programming tab, set <b>Link to (%,$), Substitution Level</b> to <b>1</b> and click OK.
</p><p>The syntax is 
</p>
<dl><dd> <b>$(function(Dataset)<i>[, format])</i></b> </dd></dl>
<p>where
</p>
<dl><dd><ul><li> the function should return a scalar value instead of a dataset, e.g. total(), mean(), etc.</li>
<li> dataset can be string register for dataset or range variable, plot or worksheet column</li>
<li> format is optional, see <a href="../../LabTalk/LabTalk/Origin_Formats&amp;action=edit&amp;redlink=1.html" class="new" title="LabTalk:Origin Formats (page does not exist)">Origin Formats</a></li></ul></dd></dl>
<p>The following table uses LabTalk function total() as an example. $( ) substitution is used to convert the calculation into a string with optional Origin format to customize the display. 
</p>
<table class="simple" style="width: 90%">
<tr>
<th style="width: 15%">Dataset
</th>
<th style="width: 40%">Description
</th>
<th style="width: 35%">Example
</th></tr>
<tr>
<td>&#160;%C
</td>
<td> String register for Active Dataset
</td>
<td>
<pre>$(total(%C)) //total of current dataset
$(total(%C), .2) //total of current dataset, show 2 decimal places
</pre>
</td></tr>
<tr>
<td>&#160;%(<i>plotindex</i>, @D)
</td>
<td> Dataset of specified plot
</td>
<td>
<pre>$(total(%(1, @D)) //total of 1st plot, for 2D, it refers to Y dataset
$(total(%(2X, @D)), *3) //total of 2nd plot's X dataset, show 3 significant digits
$(total(%(2.1, @D))) //total of 2nd layer, 1st plot's Y data 
</pre>
</td></tr>
<tr>
<td>&#160;%(<i>plotindex</i>, @WT, columnNameorIndex)
</td>
<td> Dataset of specified plot
</td>
<td>
<pre>$(total(%(1, @WT, 5))) //total of 5th column on worksheet where the 1st plot is from
$(total(%(2X, @WT, E))) //total of column E on worksheet where 2nd X data is from
$(total(%(1, @WT, "Decay 2"))) //total of column (long name "Decay 2") on 1st plot's sheet
</pre>
</td></tr>
<tr>
<td> <i>%([book]Sheet, column)</i>
</td>
<td> Worksheet Column Substitution
</td>
<td>
<pre>$(total(%([book1]1, C )) //total of column C on 1st sheet of book1
</pre>
</td></tr>
<tr>
<td> <i>ds</i> or <i>ra</i>
</td>
<td> Dataset or Range variable or expression
</td>
<td>
<pre>$(total(ds)) //suppose dataset ds={1,2,3};
$(total({2,4,6})) //total of {2,4,6}
$(total(ra), .0) //suppose range ra=[book1]sheet1!B, show 0 decimal places
$(total([book1]1!C[5:0])) //total of range column C of Book1, 1st sheet, 5th row to end
</pre>
</td></tr></table>
<p>The following text label calculate total value of the plot. The value is customized to use comma separator and 0 decimal places
</p>
<dl><dd><a  class="image"><img alt="Text label total.png" src="../images/Linking_Text_Labels_to_Data_and_Variables/Text_label_total.png?v=94468" width="767"  /></a></dd></dl>
<p><br />
</p>
<h2><a name="Substituting_Info_Variable_in_Text_Labels"></a><span class="mw-headline">Substituting Info Variable in Text Labels</span></h2>
<p>In in-place edit mode of text label, right click and choose Insert: Info. Variable (Ctrl+L) to insert information of plotted data's file, book, sheet, column information.
</p>
<dl><dd><a  class="image"><img alt="Link to info var.png" src="../images/Linking_Text_Labels_to_Data_and_Variables/Link_to_info_var.png?v=94481" width="495"  /></a></dd></dl>
<p>Select book, sheet or plot's X and Y column node on right. Then go to <b>Info</b> or <b>Label</b> tab to pick the info. to insert. By default it will be inserted with substitution notation.
</p>
<dl><dd><a  class="image"><img alt="Link to info var db.png" src="../images/Linking_Text_Labels_to_Data_and_Variables/Link_to_info_var_db.png?v=94488" width="854"  /></a></dd></dl>
<h2><a name="Substituting_Variable_Values_in_Text_Labels"></a><span class="mw-headline">Substituting Variable Values in Text Labels</span></h2>
<p>Besides displaying worksheet values, you can include variable values in text labels. Again, for substitution to work, click on text label and check <b>Link to Substitution</b> on mini toolbar. Or right-click on the text label and choose Properties. On the Programming tab, set <b>Link to (%,$), Substitution Level</b> to <b>1</b> and click OK.
</p>
<table class="simple" style="width: 80%">
<tr>
<th style="width: 20%">Type
</th>
<th style="width: 20%">Example
</th>
<th style="width: 40%">Description
</th></tr>
<tr>
<td> String Register
</td>
<td>&#160;%X%G.opju
</td>
<td> show current project path and file name with .opju at the end
</td></tr>
<tr>
<td> String Variable
</td>
<td>&#160;%(user$)
</td>
<td> show string user$ content
</td></tr>
<tr>
<td> Numeric Variable
</td>
<td> $(myvalue, .2)
</td>
<td> show variable myvalue with two decimal place
</td></tr></table>
<p><br />
</p>
<h3><a name="Example_1._Use_Reserved_String_Registers"></a><span class="mw-headline">Example 1. Use Reserved String Registers</span></h3>
<p><a class="external text" href="../../LabTalk/LabTalk/String_registers.html">String Registers</a> are one means of handling string data in Origin and some are reserved system string registers that holds important information, such as project path&#160;%X, project file name&#160;%G, current active data&#160;%C, etc.  
</p><p>Assume that your current project <i>MYPROJECT.OPJ</i> is saved to <i>C:\MYFILES\</i>.
</p>
<ol><li>Using <a href="../../UserGuide/Category/Creating_Text_Labels.html" title="Category:Creating Text Labels">WYSIWYG text labeling methods</a>, type the following into a text label in a graph window:
<dl><dd><b>This project is saved to&#160;%X%G.OPJ.</b></dd></dl></li>
<li>Exit the typing mode, right-click to select the label and choose <b>Properties</b> and go to <b>Programming</b> tab in the dialog.</li>
<li>Set the <b>Link to (%,$), Substitution Level</b> list to <b>1</b>.</li>
<li>Go to <b>Text</b> tab and check the <b>Verbatim</b> check box (this causes the "\" character to be handled as a literal character instead of an escape character -- see below). The label should display the drive path and name of the current project.
<dl><dd><b>This project is saved to C:\MYFILES\MYPROJECT.OPJ.</b></dd></dl></li></ol>
<p>For information on use of the <b>Verbatim</b> option see <a href="../../UserGuide/UserGuide/Escape_Sequences.html#A_note_on_entering_the_backslash_.22.5C.22_character_in_text_labels" title="UserGuide:Escape Sequences">Use of the backslash "\" character in the Object Properties dialog box</a>.
</p>
<h3><a name="Example_2._Numeric_Substitution"></a><span class="mw-headline">Example 2. Numeric Substitution</span></h3>
<p>Using LabTalk, you can define any number of variables for use in your work. As an introduction to the concepts of "variables" and "scope", we recommend that you <a class="external text" href="../../LabTalk/LabTalk/Data_Types_and_Variables.html#Variables">read this topic</a>. To illustrate basic numeric substitution, we give the following simple example:  
</p>
<ol>
<li>On the main menu, click <b>Window: Script Window</b>.</li>
<li>Click inside the Script Window and at the cursor, type:
<dl><dd><pre class="lt" style="font-family:monospace;">MyVariable<span style="color: #000080;">=</span><span style="color: #0000dd;">5</span></pre><br /></dd></dl>
and press Enter.</li>
<li>From the <b>Tools</b> toolbar, select the <b>Text Tool</b>, click in an empty space on a graph or worksheet window and enter the following:
<dl><dd><pre class="lt" style="font-family:monospace;">MyVariable<span style="color: #000080;">=</span><span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>MyVariable<span style="color: #000000;">&#41;</span></pre></li></dd></dl>
<li>Right-click on the text label, choose <b>Properties</b> and go to <b>Programming</b> tab in the dialog, set the <b>Link to (%,$), Substitution Level</b> list to <b>1</b>, then click <b>OK</b>. Your text label should now display the numeric value of <i>MyVariable</i>.
<dl><dd><i>MyVariable=5</i></li></dd></dl>
</ol>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Linking_Text_Labels_to_Data_and_Variables/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>To see a list of available LabTalk variables, open the Script Window (<b>Window: Script Window</b>) and click <b>Tools: Variables...</b> or type "ed" at the command line.
</p></td></tr></table>
<h2><a name="Resolving_Math_Expressions_in_Text_Labels"></a><span class="mw-headline">Resolving Math Expressions in Text Labels</span></h2>
<p>We've seen that Origin supports substitution notation when creating text labels using <a href="../../UserGuide/Category/Creating_Text_Labels.html" title="Category:Creating Text Labels">the standard WYSIWYG text editing methods</a> or when editing text in the <a href="../../UserGuide/Category/Text_and_Drawing_Objects.html" title="Category:Text and Drawing Objects"><b>Object Properties</b></a> dialog box. You can also use this notation to resolve a mathematical expression to a value in the text label:
</p>
<dl><dd><i>$(expression)</i></dd></dl>
<p>In this substitution notation, <i>expression</i> is resolved to a value each time the text label is redrawn.  The text label is redrawn whenever you move the label or redraw the graph window.
</p>
<h3><a name="Example._Resolving_pi_in_text_label"></a><span class="mw-headline">Example. Resolving pi in text label</span></h3>
<ol><li>Type the following text in WYSIWYG edit mode or enter the expression in <b>Text</b> tab of the <b>Object Properties</b> dialog box and click <b>OK</b>.
<dl><dd> <i>The value of X is $(pi^2)</i></dd></dl></li>
<li>Right-click on your text label, select <b>Properties...</b> and go to <b>Programming</b> tab. Or, press the <i>ALT</i> key while double-clicking on the text label.</li>
<li>Set <b>Link to (%,$), Substitution Level</b> to <b>1</b> and click <b>OK</b>.  The label now reads:
<dl><dd><i>The value of X is 9.8696</i></dd></dl></li></ol>
<p>You may need to click the <b>Refresh</b> button <a  class="image"><img alt="Button Refresh.png" src="../images/Linking_Text_Labels_to_Data_and_Variables/Button_Refresh.png?v=1876" width="23"  /></a> on the <b>Standard</b> toolbar to see the change.
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Linking_Text_Labels_to_Data_and_Variables/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>When Origin starts, a text file in the program folder named ORGSYS.CNF is read. It is in this file that the value of <i>pi</i> is defined, in exactly the same way as you would define a constant or a variable at in the <b>Script Window</b> or the <b>Set Column Values</b> dialog box:<br />
</p>
<pre class="lt" style="font-family:monospace;">const pi <span style="color: #000080;">=</span> <span style="color: #0000dd;">3.141592653589793</span></pre>
<p>If you have mathematical constants that you regularly use in your work, the CONST.CNF file under User File Folder is a good place to define them, as they will always be available when Origin runs (the .CNF file is a text file that you can edit in a simple text editor).
</p></td></tr></table>
<h2><a name="Adding_Date-Time_in_Text_Labels"></a><span class="mw-headline">Adding Date-Time in Text Labels</span></h2>
<p>There are a couple of ways to add date-time information as a text label, to your graph, worksheet, etc. 
</p>
<h3><a name="As_a_static_text_object"></a><span class="mw-headline">As a static text object</span></h3>
<p>You can add a date and time stamp to the your graph by clicking the <b>Date &amp; Time</b> button <a  class="image"><img alt="Button Date Time.png" src="../images/Linking_Text_Labels_to_Data_and_Variables/Button_Date_Time.png?v=47154" width="23"  /></a> on the <b>Tools</b> toolbar. 
</p><p>Note that this is a static text object and it will keep the current date-time until and unless you click the <b>Date &amp; Time</b> button <a  class="image"><img alt="Button Date Time.png" src="../images/Linking_Text_Labels_to_Data_and_Variables/Button_Date_Time.png?v=47154" width="23"  /></a> again.
</p><p>See <a class="external text" href="../../QuickHelp/QuickHelp/How_do_I_add_date_time_stamp_to_my_graph.html">this FAQ</a> for more information.
</p>
<h3><a name="As_a_dynamic_text_object"></a><span class="mw-headline">As a dynamic text object</span></h3>
<p>There are a couple of ways to incorporate the current date-time into a text label. Unlike the <b>Date &amp; Time</b> button, such a text label could be saved with your graph template and used to stamp the graph with the date and time of window creation. Note that when you save the template with a text object created using one of the following methods, you are saving the label's <i>underlying code</i> -- not the literal text of the current date-time. 
</p><p>The basic process would go like this:
</p>
<ol><li> Customize your graph, <i>including adding a date-time text object as described below</i>.</li>
<li> <a href="../../UserGuide/UserGuide/What_is_Saved_with_the_Graph_Template.html#Saving_graph_customizations_to_a_template_file" title="UserGuide:What is Saved with the Graph Template">Save your custom template</a> to your <a href="../../UserGuide/UserGuide/The_User_Files_Folder.html" title="UserGuide:The User Files Folder">User Files</a> folder.</li>
<li> Select the data to be plotted and choose your custom template from <b>Plot</b> &gt; <b>My Templates</b>.</li></ol>
<h4><a name="Adding_a_date-time_label_using_LabTalk_substitution"></a><span class="mw-headline">Adding a date-time label using LabTalk substitution</span></h4>
<p>Use the <b>@D</b> or <b>@T</b> syntax to add a date-time label to the graph:
</p>
<ol>
<li> Choose the <b>Text Tool</b> <a  class="image"><img alt="Button Text Tool.png" src="../images/Linking_Text_Labels_to_Data_and_Variables/Button_Text_Tool.png?v=1948" width="23"  /></a> then click on the graph and enter the following at the cursor:
<pre class="lt" style="font-family:monospace;"> <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>@D, DMM<span style="color: #000080;">-</span>dd<span style="color: #000080;">-</span>yyyy HH<span style="color: #000000;">:</span>mm<span style="color: #000000;">:</span>ss<span style="color: #000000;">&#41;</span></pre></li>
<li>Click off of the text object to exit edit mode.</li>
<li>Select the text object and the click the <b>Link to Substitution</b> button on the Mini Toolbar.
<a  class="image"><img alt="OH date time text label DT syntax.png" src="../images/Linking_Text_Labels_to_Data_and_Variables/OH_date_time_text_label_DT_syntax.png?v=92925" width="626"  /></a></li>
</ol>
<table class="note">

<tr>
<td><b>Note:</b> The particular date-time format used here is just one example. To find out more about formatting for <b>@D</b> and <b>@T</b>, see <a class="external text" href="../../LabTalk/LabTalk/Origin_Formats.html#Converting_Current_Date-Time_to_String">this section</a> of the LabTalk Reference.
</td></tr></table>
<h4><a name="Adding_date-time_by_running_LabTalk_script_in_the_label"></a><span class="mw-headline">Adding date-time by running LabTalk script in the label</span></h4>
<p>This method works by adding a short line of script to the text object. That script is triggered on <b>Window Create</b>, thus stamping the graph with date-time that the graph is made.
</p>
<ol>
<li> Choose the <b>Text Tool</b> <a  class="image"><img alt="Button Text Tool.png" src="../images/Linking_Text_Labels_to_Data_and_Variables/Button_Text_Tool.png?v=1948" width="23"  /></a> then click on the graph and enter the following at the cursor:
<pre class="lt" style="font-family:monospace;"><span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>dt<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span></pre></li>
<li>Click off of the text object to exit edit mode.</li>
<li>Right click on the text object and choose <b>Properties</b>.</li>
<li>In the dialog, click on the <b>Programming</b> tab and recreate the following settings (the <b>Text</b> tab should also look as shown):
<a  class="image"><img alt="OH date time text label string var script.png" src="../images/Linking_Text_Labels_to_Data_and_Variables/OH_date_time_text_label_string_var_script.png?v=92935" width="775"  /></a></li>
<li>Click <b>OK</b> to close the dialog and render the current date-time.</li>
</ol>
<table class="note">

<tr>
<td><b>Note:</b> The combination of Origin date-time function and date-time format used here is just one example.
<ul><li> For Origin's date-time functions, see <a class="external text" href="../../LabTalk/Script/LabTalk-Supported_Functions.html#Date_and_Time_Functions">this page</a> in the LabTalk Reference.</li>
<li> For building a date-time string, see <a class="external text" href="../../LabTalk/LabTalk/Date_and_Time_Format_Specifiers.html">Date and Time Format Specifiers</a>.</li></ul>
</td></tr></table>


