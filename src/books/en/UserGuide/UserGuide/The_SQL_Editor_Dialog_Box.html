<h1 class="firstHeading">6.9.2 The SQL Editor Dialog Box</h1><p class='urlname' style='display: none'>ImpDatabase-SQLEditor-Dialog</p>
<p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Database_Overview"><span class="tocnumber">1</span> <span class="toctext">Database Overview</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#The_SQL_Editor"><span class="tocnumber">2</span> <span class="toctext">The SQL Editor</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Dialog_Settings"><span class="tocnumber">3</span> <span class="toctext">Dialog Settings</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#The_File_menu"><span class="tocnumber">3.1</span> <span class="toctext">The File menu</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#The_View_menu"><span class="tocnumber">3.2</span> <span class="toctext">The View menu</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#The_Query_menu"><span class="tocnumber">3.3</span> <span class="toctext">The Query menu</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#The_Settings_menu"><span class="tocnumber">3.4</span> <span class="toctext">The Settings menu</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Buttons"><span class="tocnumber">3.5</span> <span class="toctext">Buttons</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="Database_Overview"></a><span class="mw-headline">Database Overview</span></h2>
<p>Origin's database connectivity and import functionality has been updated. For more information, we suggest these blog posts:
</p>
<ul><li> <a class="external text" href="http://blog.originlab.com/data-handling/better-faster-database-support-in-origin-2020" target="_blank">Better, Faster Database Support in Origin 2020</a></li>
<li> <a class="external text" href="http://blog.originlab.com/data-import/the-sql-editor-dialog" target="_blank">The SQL Editor Dialog Box</a></li>
<li> <a class="external text" href="http://blog.originlab.com/data-import/connecting-to-a-database-and-importing-data" target="_blank">Connecting to a Database and Importing Data</a></li>
<li> <a class="external text" href="http://blog.originlab.com/origin-2020/things-to-know-about-origin-database-connectivity" target="_blank">Things to Know About Origin Database Connectivity</a></li>
<li> <a class="external text" href="http://blog.originlab.com/sqlite-support-in-origin" target="_blank">SQLite Support in Origin</a></li></ul>
<h2><a name="The_SQL_Editor"></a><span class="mw-headline">The SQL Editor</span></h2>
<dl><dd><dl><dd><a  class="image"><img alt="Sqleditor.png" src="../images/The_SQL_Editor_Dialog_Box/Sqleditor.png?v=84550" width="740"  /></a></dd></dl></dd></dl>
<p>The SQL Editor is a simple GUI for setting up database connections, editing SQL strings and importing database data. The dialog includes:
</p>
<ul><li> <b>Table list</b>: List of tables in the selected database. For each table, there is a list of fields. Items may be double-clicked to add them to the SQL query being built in the SQL statement edit box.</li>
<li> <b>SQL statement edit box</b>: Manually type in SQL here.  Double-click in Table list to add items from the list to the SQL.</li>
<li> <b>Toggle preview panel visibility</b>: Click to show or hide the preview panel.</li>
<li> <b>Preview panel</b>: Displays preview of data when the Preview button is clicked.</li>
<li> <b>Generate preview</b>: Click Preview to generate up to 50 rows of preview data.</li>
<li> <b>Import data</b>: Click OK to close the SQL Editor dialog, save the query to the worksheet, and import data specified by the query into the worksheet.</li></ul>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/The_SQL_Editor_Dialog_Box/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>To adjust the height of top panel, toggle the Preview panel off (click the double up-arrow on the right), then drag to adjust height.
</p></td></tr></table>
<table class="note">

<tr>
<td><b>Note:</b> By default, views are hidden in the SQL Editor table list. You can enable views by setting the value of LabTalk system variable <a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#D">@DBSV = 1</a>. For information on changing the value of LabTalk system variable see <a class="external text" href="../../QuickHelp/QuickHelp/How_do_I_permanently_change_the_value_of_a_system_variable.html">FAQ-708 How do I permanently change the value of a system variable?</a>
</td></tr></table>
<h2><a name="Dialog_Settings"></a><span class="mw-headline">Dialog Settings</span></h2>
<h3><a name="The_File_menu"></a><span class="mw-headline">The File menu</span></h3>
<p>Options in this menu work for establishing a database connection, and managing the connection and query files (<a class="external text" href="http://blog.originlab.com/data-import/the-sql-editor-dialog*" target="_blank">See this blog post for an explanation of *.ODS and *.ODQ files</a>).
</p>
<table class="dialogcontroltable">

<tr>
<th> New
</th>
<td> Start a completely new connection with a blank SQL query. Opens the <b>Data Link Properties</b> dialog.
</td></tr>
<tr>
<th> Open
</th>
<td> Opens an existing Query file (<a href="../../UserGuide/UserGuide/Database_Terminology.html" title="UserGuide:Database Terminology">*.ODQ file</a>) or a Data Source file (<a href="../../UserGuide/UserGuide/Database_Terminology.html" title="UserGuide:Database Terminology">*.ODS file</a>).
</td></tr>
<tr>
<th> Save to Active Worksheet
</th>
<td> Saves connection information and SQL statement to the active worksheet. Good option if you want to save that information but donâ€™t want to import data immediately. Use <b>File: Close</b> to close the dialog afterwards.
</td></tr>
<tr>
<th> Save Connection As
</th>
<td>  Creates an <a href="../../UserGuide/UserGuide/Database_Terminology.html" title="UserGuide:Database Terminology">*.ODS file</a> from current connection information. If you  want to include credentials/login info in the connection, do not encrypt it beforehand.
</td></tr>
<tr>
<th> Show Connection String
</th>
<td> Displays the <a href="../../UserGuide/UserGuide/Database_Terminology.html" title="UserGuide:Database Terminology">connection string</a> for current connection in the <b>Message</b> tab of the preview panel.
</td></tr>
<tr>
<th> Edit Connection String
</th>
<td> Modify some part of the current connection string. Or use it to copy connection string to clipboard.
</td></tr>
<tr>
<th> Save Connection and Query As
</th>
<td>  Creates an <a href="../../UserGuide/UserGuide/Database_Terminology.html" title="UserGuide:Database Terminology">*.ODQ files</a> from current connection information and SQL statement.
</td></tr>
<tr>
<th> Close
</th>
<td> Closes the dialog.
</td></tr></table>
<h3><a name="The_View_menu"></a><span class="mw-headline">The View menu</span></h3>
<table class="dialogcontroltable">

<tr>
<th> Text Size
</th>
<td> Adjust SQL statement editor font size.
</td></tr>
<tr>
<th> Show Table List
</th>
<td> Show or hide left panel. Origin reads database metadata to construct this table. This may take time to construct. Hiding the table list can speed up connecting to a large database. Double-click a node to add it to the right SQL statement edit box.
</td></tr>
<tr>
<th> Show Table Views in Table List
</th>
<td> Show or hide table views in the table list.
</td></tr></table>
<h3><a name="The_Query_menu"></a><span class="mw-headline">The Query menu</span></h3>
<table class="dialogcontroltable">

<tr>
<th> LabTalk
</th>
<td> Opens the <b>LabTalk Support Settings</b> dialog. This dialog lets you define LabTalk variables, execute Labtalk script and use in LabTalk in your SQL string. The dialog options include:
<ul>
<li> <b>Enable LabTalk (%, $) Substitution</b>:<br />
Check to enable LabTalk substitution in SQL string.
<li> <b>Ignore Substitution Inside Single Quotes</b>:<br />
Check to ignore substitution inside '  '.
<li> <b>Before Query Script</b>:<br />
Script that runs before applying a SQL string. This is used to define LabTalk variables, etc.
</ul>
<p>More information, please see the examples below.
</p>
</td></tr>
<tr>
<th> Preview Substituted String
</th>
<td> Preview the actual SQL string when using LabTalk in right panel. When it's checked, the SQL statement edit box isn't editable.
</td></tr>
<tr>
<th> Preview
</th>
<td> Preview the SQL query results in bottom Preview tab.
</td></tr></table>
<p><br />
<i><b>Examples: Use LabTalk in your SQL string</b></i>
</p><p>Suppose the original SQL string is:
</p>
<pre class="sql" style="font-family:monospace;"><span style="color: #993333; font-weight: bold;">SELECT</span> country<span style="color: #66cc66;">,</span> years<span style="color: #66cc66;">,</span> amount <span style="color: #993333; font-weight: bold;">FROM</span> salesrecords
<span style="color: #993333; font-weight: bold;">WHERE</span> country <span style="color: #66cc66;">=</span> <span style="color: #ff0000;">'USA'</span> <span style="color: #993333; font-weight: bold;">AND</span> years <span style="color: #66cc66;">=</span> <span style="color: #cc66cc;">2010</span></pre>
<p>To change the condition, you can use LabTalk variables in a WHERE clause. For example, open <b>LabTalk Support Settings</b> (<b>Query: LabTalk</b>) and enter a <b>Before Query Script</b> like this:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000080;">%</span>A <span style="color: #000080;">=</span> Japan; <span style="color: #008000;">//define a string variable</span>
int YY <span style="color: #000080;">=</span> <span style="color: #0000dd;">2010</span>; <span style="color: #008000;">//define an integer variable</span></pre> 
<p>And change the SQL into
</p>
<pre class="sql" style="font-family:monospace;"><span style="color: #993333; font-weight: bold;">SELECT</span> country<span style="color: #66cc66;">,</span> years<span style="color: #66cc66;">,</span> amount <span style="color: #993333; font-weight: bold;">FROM</span> salesrecords
<span style="color: #993333; font-weight: bold;">WHERE</span> country <span style="color: #66cc66;">=</span> <span style="color: #ff0000;">'%A'</span> <span style="color: #993333; font-weight: bold;">AND</span> years <span style="color: #66cc66;">=</span> $<span style="color: #66cc66;">&#40;</span>YY<span style="color: #66cc66;">&#41;</span></pre>
<p>Then the resulting SQL would be:
</p>
<ol>
<li> <b>Enable LabTalk (%, $) Substitution</b> -- Unchecked.
<pre class="sql" style="font-family:monospace;"><span style="color: #993333; font-weight: bold;">SELECT</span> country<span style="color: #66cc66;">,</span> years<span style="color: #66cc66;">,</span> amount <span style="color: #993333; font-weight: bold;">FROM</span> salesrecords
<span style="color: #993333; font-weight: bold;">WHERE</span> country <span style="color: #66cc66;">=</span> <span style="color: #ff0000;">'%A'</span> <span style="color: #993333; font-weight: bold;">AND</span> years <span style="color: #66cc66;">=</span> $<span style="color: #66cc66;">&#40;</span>YY<span style="color: #66cc66;">&#41;</span></pre>
<li> <b>Enable LabTalk (%, $) Substitution</b> -- Checked, <b>Ignore Substitution Inside Single Quotes</b> -- Unchecked.
<pre class="sql" style="font-family:monospace;"><span style="color: #993333; font-weight: bold;">SELECT</span> country<span style="color: #66cc66;">,</span> years<span style="color: #66cc66;">,</span> amount <span style="color: #993333; font-weight: bold;">FROM</span> salesrecords
<span style="color: #993333; font-weight: bold;">WHERE</span> country <span style="color: #66cc66;">=</span> <span style="color: #ff0000;">'Japan'</span> <span style="color: #993333; font-weight: bold;">AND</span> years <span style="color: #66cc66;">=</span> <span style="color: #cc66cc;">2010</span></pre>
<li> <b>Enable LabTalk (%, $) Substitution</b> -- Checked, <b>Ignore Substitution Inside Single Quotes</b> -- Checked.
<pre class="sql" style="font-family:monospace;"><span style="color: #993333; font-weight: bold;">SELECT</span> country<span style="color: #66cc66;">,</span> years<span style="color: #66cc66;">,</span> amount <span style="color: #993333; font-weight: bold;">FROM</span> salesrecords
<span style="color: #993333; font-weight: bold;">WHERE</span> country <span style="color: #66cc66;">=</span> <span style="color: #ff0000;">'%A'</span> <span style="color: #993333; font-weight: bold;">AND</span> years <span style="color: #66cc66;">=</span> <span style="color: #cc66cc;">2010</span></pre>
</ol>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/The_SQL_Editor_Dialog_Box/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>To use an actual '%' sign when you have unchecked <b>Ignore Substitution Inside Single Quotes</b>, use a double percent, '%%', instead.
</p></td></tr></table>
<h3><a name="The_Settings_menu"></a><span class="mw-headline">The Settings menu</span></h3>
<table class="dialogcontroltable">

<tr>
<th> Import Data by OLE DB
</th>
<td>  Use OLE DB for importing data. (Enabled for both OLE DB and ODBC).
</td></tr>
<tr>
<th> Import Data by ODBC
</th>
<td>  Use ODBC for importing data. (Only enabled for ODBC connections).
</td></tr>
<tr>
<th> Auto Resize Worksheet
</th>
<td> Auto resize worksheet column width to fit record size.
</td></tr>
<tr>
<th> Encrypt Login Info
</th>
<td> Encrypts credentials/login info such that it is no longer human-readable when displayed in Origin.
</td></tr></table>
<h3><a name="Buttons"></a><span class="mw-headline">Buttons</span></h3>
<p>Butons are provided for most frequently used menus in this dialog, including:
</p>
<table class="dialogcontroltable">

<tr>
<th> Open <a  class="image"><img alt="Db editor open.png" src="../images/The_SQL_Editor_Dialog_Box/Db_editor_open.png?v=25120" width="23"  /></a>
</th>
<td> <b>File: Open...</b> menu
</td>
<td> Open an <a href="../../UserGuide/UserGuide/Database_Terminology.html" title="UserGuide:Database Terminology">.ODQ</a> or <a href="../../UserGuide/UserGuide/Database_Terminology.html" title="UserGuide:Database Terminology">.ODS</a> file.
</td></tr>
<tr>
<th> Save <a  class="image"><img alt="Db editor save.png" src="../images/The_SQL_Editor_Dialog_Box/Db_editor_save.png?v=25122" width="23"  /></a>
</th>
<td> <b>File: Save to Active Worksheet/Save Connection and Query</b> menu.
</td>
<td> If the dialog is opened by <b>File: New...</b> menu and not saved as <a href="../../UserGuide/UserGuide/Database_Terminology.html" title="UserGuide:Database Terminology">.ODQ</a> file yet, SQL Editor dialog title will show <i>Untitled.ODQ</i>. Then <b>Save</b> button will save Connection and Query to active worksheet only. If the current connection or query is loaded from .ODQ file or has been saved as .ODQ file, the SQL Editor dialog title will show the file name. Then <b>Save</b> button will save to the corresponding file.
<p>Note: Anytime you click Import button, the connect and Query will be automatically saved to active worksheet. If you open the SQL Editor again, Origin actually loads the query from the sheet and show the book and sheet name <i>[Book1]Sheet1</i> in dialog title. If you make change again, and click Save, it will save to active worksheet. 
</p>
</td></tr>
<tr>
<th> Preview <a  class="image"><img alt="Db editor preview.png" src="../images/The_SQL_Editor_Dialog_Box/Db_editor_preview.png?v=25121" width="23"  /></a>
</th>
<td> <b>Query: Preview</b> menu
</td>
<td> Preview the SQL query results.
</td></tr>
<tr>
<th> Import <a  class="image"><img alt="Db editor import.png" src="../images/The_SQL_Editor_Dialog_Box/Db_editor_import.png?v=25118" width="23"  /></a>
</th>
<td> <b>Query: Import</b> menu
</td>
<td> Import database data into worksheet.
</td></tr>
<tr>
<th> Preview the query string after substituting all LabTalk variables <a  class="image"><img alt="Db editor labtalk.png" src="../images/The_SQL_Editor_Dialog_Box/Db_editor_labtalk.png?v=25119" width="23"  /></a>
</th>
<td> <b>Query: Preview Substituted String</b> menu
</td>
<td> Preview the actural SQL string when LabTalk variables are defined and enable LabTalk (%,$) Substitution is checked in <b>Query: LabTalk...</b> dialog.
</td></tr></table>


