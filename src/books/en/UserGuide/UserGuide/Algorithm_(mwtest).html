<h1 class="firstHeading">17.5.4.2 Algorithms (Mann-Whitney Test)</h1><p class='urlname' style='display: none'>MW-Test-Algorithm</p>
<p>Consider two independent samples <img src="../images/Algorithm_(mwtest)/math-5b1801852159ba06309a26beab0a5c80.png?v=0" title="F(x)\," alt="F(x)\," class="tex"/> and <img src="../images/Algorithm_(mwtest)/math-9756a2e5b64bdcdf316280aa3e4ec826.png?v=0" title="G(y)\," alt="G(y)\," class="tex"/>, with the size of <img src="../images/Algorithm_(mwtest)/math-8d88a43872d6db6535d8672a15f09ce2.png?v=0" title="n_1\,\!" alt="n_1\,\!" class="tex"/> and <img src="../images/Algorithm_(mwtest)/math-ede03c8aef1b07c898c7747b489fd765.png?v=0" title="n_2\,\! " alt="n_2\,\! " class="tex"/>, and the sample data is denoted as <img src="../images/Algorithm_(mwtest)/math-d79752c45b6e0288c460390908ff4157.png?v=0" title="x_1,x_2,\ldots ,x_{n_1}\,\!" alt="x_1,x_2,\ldots ,x_{n_1}\,\!" class="tex"/> and <img src="../images/Algorithm_(mwtest)/math-ba3bf26bc53cf72dd2f7e804e8351ba7.png?v=0" title="y_1,y_2,\ldots ,y_{n_1}\,\!" alt="y_1,y_2,\ldots ,y_{n_1}\,\!" class="tex"/> respectively.
</p><p>The null hypothesis, <img src="../images/Algorithm_(mwtest)/math-f60cc190b9efdc1a8dd50689509520e4.png?v=0" title="H_0: F(x) = G(y)\," alt="H_0: F(x) = G(y)\," class="tex"/>, is that the two distributions are the same. And this is to be tested against an alternative hypothesis <img src="../images/Algorithm_(mwtest)/math-7cd11b458088b7785f332b5101ecd466.png?v=0" title="H_1\," alt="H_1\," class="tex"/> which is:
</p>
<dl><dd><img src="../images/Algorithm_(mwtest)/math-442de29a07a0a1d2b14c2d251be35c0b.png?v=0" title="H_1: F(x) \neq G(y)\," alt="H_1: F(x) \neq G(y)\," class="tex"/>; or</dd></dl>
<dl><dd><img src="../images/Algorithm_(mwtest)/math-96afea18e20fea6dbe701b05689c166d.png?v=0" title="H_1: F(x) &lt; G(y)\,\!" alt="H_1: F(x) &lt; G(y)\,\!" class="tex"/>, the <img src="../images/Algorithm_(mwtest)/math-6b206a28e60f665e235f89f460448467.png?v=0" title="x\," alt="x\," class="tex"/>'s tend to be greater than the <img src="../images/Algorithm_(mwtest)/math-ec9ff0a12771e750c2685d3b89a37c79.png?v=0" title="y\," alt="y\," class="tex"/>'s; or</dd></dl>
<dl><dd><img src="../images/Algorithm_(mwtest)/math-dd4112d1dfe28bb3868d87af588e6c1c.png?v=0" title="H_1: F(x) &gt; G(y)\,\!" alt="H_1: F(x) &gt; G(y)\,\!" class="tex"/>, the <img src="../images/Algorithm_(mwtest)/math-6b206a28e60f665e235f89f460448467.png?v=0" title="x\," alt="x\," class="tex"/>'s tend to be less than the <img src="../images/Algorithm_(mwtest)/math-ec9ff0a12771e750c2685d3b89a37c79.png?v=0" title="y\," alt="y\," class="tex"/>'s.</dd></dl>
<p>The test procedure includes the following steps:
</p>
<ul>
<li>Combine <img src="../images/Algorithm_(mwtest)/math-312ce869e8967ee6fff1453ef5e28c4c.png?v=0" title=" x_i \,\!" alt=" x_i \,\!" class="tex"/>, <img src="../images/Algorithm_(mwtest)/math-015fcddf5978e5b63ac9135bd7bdae23.png?v=0" title=" y_i\,\!" alt=" y_i\,\!" class="tex"/> in a group.

<li>Rank them in ascending order. Ties receive the average of their ranks. Let <img src="../images/Algorithm_(mwtest)/math-56a7a6ec92f118977b8523a962828446.png?v=0" title="r_{1i}\,\!" alt="r_{1i}\,\!" class="tex"/>be the ranks assigned to<img src="../images/Algorithm_(mwtest)/math-312ce869e8967ee6fff1453ef5e28c4c.png?v=0" title=" x_i \,\!" alt=" x_i \,\!" class="tex"/>, for <img src="../images/Algorithm_(mwtest)/math-b57947ce6a9bae17d7506e4f7c01f818.png?v=0" title=" i=1,2,\ldots ,n_1" alt=" i=1,2,\ldots ,n_1" class="tex"/> and be the ranks assigned to <img src="../images/Algorithm_(mwtest)/math-015fcddf5978e5b63ac9135bd7bdae23.png?v=0" title=" y_i\,\!" alt=" y_i\,\!" class="tex"/>, for <img src="../images/Algorithm_(mwtest)/math-1dae3723ecc58382e25c7a34892865a5.png?v=0" title=" j=1,2,\ldots ,n_2" alt=" j=1,2,\ldots ,n_2" class="tex"/>.
<li>Calculate sum of ranks:

<dl><dd><img src="../images/Algorithm_(mwtest)/math-e9f090c9bc2e4925efed578d5fc957d4.png?v=0" title=" S_1=\sum_{I=1}^{n_1}r_{1i}\,\!" alt=" S_1=\sum_{I=1}^{n_1}r_{1i}\,\!" class="tex"/>, and <img src="../images/Algorithm_(mwtest)/math-443e369d22f03a15147ddce7585c5b22.png?v=0" title=" S_2=\sum_{I=1}^{n_2}r_{2j}\,\!" alt=" S_2=\sum_{I=1}^{n_2}r_{2j}\,\!" class="tex"/></dd></dl>

<li>Test statistic <img src="../images/Algorithm_(mwtest)/math-6f3d5ad4b0e22c80e2db450cf7238ea9.png?v=0" title="U\," alt="U\," class="tex"/> is defined as follow:

<dl><dd><img src="../images/Algorithm_(mwtest)/math-42f3622e67a4b7662e78f6c155b8ec10.png?v=0" title=" U=S_1-\frac{n_1(n_1+1)}2\," alt=" U=S_1-\frac{n_1(n_1+1)}2\," class="tex"/></dd></dl>

<li>The approximate Normal test statistic <img src="../images/Algorithm_(mwtest)/math-77698ae92ac0435f8da1e266eeb528e3.png?v=0" title="z\," alt="z\," class="tex"/>is calculated as:

<dl><dd><img src="../images/Algorithm_(mwtest)/math-2590c4a4b785dfcc8e3983885df66db6.png?v=0" title="z=\frac{U-M(U)\pm \frac 12}{\sqrt{Var(U)}} \," alt="z=\frac{U-M(U)\pm \frac 12}{\sqrt{Var(U)}} \," class="tex"/></dd></dl>

where

<dl><dd><img src="../images/Algorithm_(mwtest)/math-28ce0d26a8607fa489594ca9a1d7cc31.png?v=0" title="M(U)=\frac{n_1n_2}2 \," alt="M(U)=\frac{n_1n_2}2 \," class="tex"/></dd></dl>

and

<dl><dd><img src="../images/Algorithm_(mwtest)/math-ef94a3f17a70689ec4c0b3b8808715e6.png?v=0" title="Var(U)=\frac{n_1n_2(n_1+n_2+1)}{12}-\frac{n_1n_2}{(n_1+n_2)(n_1+n_2-1)}\times TS \," alt="Var(U)=\frac{n_1n_2(n_1+n_2+1)}{12}-\frac{n_1n_2}{(n_1+n_2)(n_1+n_2-1)}\times TS \," class="tex"/></dd></dl>

where

<dl><dd><img src="../images/Algorithm_(mwtest)/math-2318b3a335f87d5d4da6d984610d7fc9.png?v=0" title="TS=\sum_{j=1}^\tau \frac{(t_j)(t_j-1)(t_j+1)}{12}\," alt="TS=\sum_{j=1}^\tau \frac{(t_j)(t_j-1)(t_j+1)}{12}\," class="tex"/>.</dd></dl>

<img src="../images/Algorithm_(mwtest)/math-877f2649839d34ed84de578db8e58a47.png?v=0" title=" \tau \," alt=" \tau \," class="tex"/>is the number of ties in the sample and <img src="../images/Algorithm_(mwtest)/math-df204135239c5bf5c4634a38c3b9b470.png?v=0" title=" t_j\," alt=" t_j\," class="tex"/>is the number of ties in the <i>j</i>th group.<br />

Note that if no ties are present, the variance of <img src="../images/Algorithm_(mwtest)/math-d48c86a2e46b00c5cd98ca6169fed589.png?v=0" title="U \," alt="U \," class="tex"/> reduces to 
<img src="../images/Algorithm_(mwtest)/math-5e07afd040fd2b8d17dca3a17cf6a170.png?v=0" title="\frac{n_1n_2(n_1+n_2+1)}{12}\," alt="\frac{n_1n_2(n_1+n_2+1)}{12}\," class="tex"/>
</ul>
<p>For more details of the algorithm, please refer to <a class="external text" href="http://www.originlab.com/pdfs/nagcl09/manual/pdf/g08/g08amc.pdf" target="_blank"><b>nag_mann_whitney (g08amc)</b></a>
</p>





