<h1 class="firstHeading">25.6.5 Using the MSXML Parser to Convert an Origin Worksheet into an XML Document</h1><p class='urlname' style='display: none'>Create-XML</p>
<p><br />
Origin C's COM support can be used to programmatically create XML documents. To see what the code might look like, take a look at the <a class="external text" href="http://www.originlab.com/pdfs/origin_c_examples/WksToXML_1.pdf" target="_blank">WksToXML.PDF</a>.
</p>
<dl><dd><dl><dd><a  class="image"><img alt="WKSTOXML.png" src="../images/Create_XML_Documents/400px-WKSTOXML.png?v=71019" width="400"   /></a></dd></dl></dd></dl>
<p>The functions in the program use the Microsoft MSXML parser (version 3 - other versions can be used) to convert an Origin worksheet into an XML document in the function called <b>WksToXML</b>. The function takes two arguments:
<br />
</p>
<dl><dd><dl><dd>1. <b>A string</b> - This string defaults to Data1, but can be any worksheet name, including a LabTalk string variable (e.g.&#160;%H - the active window title). Using a LabTalk string variable would make it easier to perform a batch process where multiple worksheets are saved to XML files.</dd>
<dd>2. <b>A string</b> - This string defaults to the C drive (e.g. C:\), but can be any valid path.</dd></dl></dd></dl>
<p>Once the C file has been compiled in Code Builder (Origin's Integrated Development Environment), the WKSToXML function can be called using either Origin C or LabTalk syntax. The call would similar to the following:
</p>
<table class="simple" width="80%">
<tr>
<th width="40%">In Origin C
</th>
<th width="40%">In LabTalk
</th></tr>
<tr>
<td>WKSToXML(<i>MyWorksheet,C:\Temp</i>);
</td>
<td>WKSToXML <i>MyWorksheet C:\Temp</i>;
</td></tr></table>
<p>Another function in this file, <b>XMLToWks</b>, allows you to import an XML document into an Origin worksheet. The function takes one argument, the path and filename, as a string. A proper function call using this function would be as follows:
</p>
<table class="simple" width="80%">
<tr>
<th width="40%">In Origin C
</th>
<th width="40%">In LabTalk
</th></tr>
<tr>
<td>XMLToWks(<i>C:\Temp</i>);
</td>
<td>XMLToWks <i>C:\Temp</i>;
</td></tr></table>
<p><font>Note</font>: This example is also available in the <b>\Samples\COM Server and Client\XML\Client</b> subfolder in Origin. It is called <b>WksToXML.c</b>.
</p>





