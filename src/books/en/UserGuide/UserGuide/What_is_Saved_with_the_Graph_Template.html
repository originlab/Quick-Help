<h1 class="firstHeading">8.3.1.2 What is Saved with the Graph Template?</h1><p class='urlname' style='display: none'>Graph-Template-Elements</p>
<p>Graph windows are created from graph template files.  Origin graph template files have an <b>OTP</b> file extension.  Origin ships with a large number of built-in graph templates (system templates).  These templates are used to create all of Origin's 100+ graph types and they can be modified and saved, to preserve your custom settings.  
</p><p>A graph template file differs from a graph <i>window</i> file (.OGG) in that templates do not store data.  Rather, graph template files store important page and layer characteristics (page size, number of layers, scaling of text and drawing objects, etc.) and they also store data plot style information (plot type, plot colors, data labels, etc.).  For more information, see "Attributes saved with the graph template," below.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Saving_graph_customizations_to_a_template_file"><span class="tocnumber">1</span> <span class="toctext">Saving graph customizations to a template file</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Attributes_saved_with_the_graph_template"><span class="tocnumber">2</span> <span class="toctext">Attributes saved with the graph template</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#A_note_about_data_plot_style_holders"><span class="tocnumber">3</span> <span class="toctext">A note about data plot style holders</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Additional_Scripts_Saved_with_Template"><span class="tocnumber">4</span> <span class="toctext">Additional Scripts Saved with Template</span></a></li>
</ul>
</div>

<h2><a name="Saving_graph_customizations_to_a_template_file"></a><span class="mw-headline">Saving graph customizations to a template file</span></h2>
<p>To save the active graph window as a graph template (.OTP) file:
</p>
<ol><li>Activate the graph window and select <b>File:Save Template As...</b> </li></ol>
<p><i>or</i> 
</p>
<ol><li>Right-click on the window title bar and select <b>Save Template As...</b> from the shortcut menu.  </li></ol>
<p>Both actions open the  open the <b>template_saveas</b> dialog box. For information on dialog box controls, see <a href="../../UserGuide/UserGuide/Template_Files.html#Saving_a_customized_window_as_a_template" title="UserGuide:Template Files">Saving a customized window as a template</a>.
</p>
<h2><a name="Attributes_saved_with_the_graph_template"></a><span class="mw-headline">Attributes saved with the graph template</span></h2>
<p>The graph page, each graph layer on the page, the axes, the tick labels, the axes labels, and text or object annotations, as well as the data plots, all have properties that can be saved to a graph template.  
</p><p>Attributes controlled from the <b>Plot Details</b> dialog box are saved with a graph template:
</p>
<ul><li>The page tabs of the Plot Details dialog box.</li>
<li>The layer tabs of the Plot Details dialog box.</li>
<li>The data plot tabs of the Plot Details dialog box.</li>
<li>The function, data point, error, and label tabs of the Plot Details dialog box.</li></ul>
<p>The attributes controlled by these dialog boxes are saved with the graph template:
</p>
<ul><li>The <b>Axis</b> dialog box.  </li>
<li>The dialog boxes that control graph annotations (text and drawing objects). </li></ul>
<p>Additionally, the following graph window properties are saved to the template:
</p>
<ul><li>Graph Long Name. You can preset Long Name for graph create from this template.</li>
<li>Graph Short Name. You can preset Short Name for graph create from this template.</li></ul>
<table class="note">

<tr>
<td><b>Notes:</b>the graph Long Name/Short Name preset method can be accessed by theme. In the <b>Save Format as Theme</b> dialog, find branch
<ul><li><i>page.Misc.PagePresetLongName.strVal</i> to preset graph Long Name</li>
<li><i>page.Misc.PagePresetShortName.strVal</i> to preset graph Short Name  </li></ul>
</td></tr></table>
<p><br />
<i><b>Finally...</b></i>
</p>
<ul><li> If when saving the graph template, you marked it as a "cloneable template", then information about the relationship of graph window plots and the structure of the source data, is saved with the graph template. To find out more, see <a href="../../UserGuide/UserGuide/Graph_Template_Basics.html#Cloneable_Templates" title="UserGuide:Graph Template Basics">Cloneable Templates</a>.</li>
<li> A preview image of the graph at the time of saving the template, is saved with the graph template. This preview is used to represent your template in the <b>Plot</b> menu and in the <b>Template Library</b>.</li></ul>
<h2><a name="A_note_about_data_plot_style_holders"></a><span class="mw-headline">A note about data plot style holders</span></h2>
<p>The details (or data plot styles) of each of the data plots in your graph window are saved in data plot style holders.  <b>Data plot style holders</b> contain information about the type of data plot (for example, scatter, line, or column) and the settings for the data plot (for example, the settings on the Plot Details Symbol tab).  When you save a graph window as a template, each data plot in each layer of the graph window has an associated data plot style holder.  
</p><p>Thus, when you create a graph based on this custom template, for each layer in your graph, the first data plot in the layer will display according to the information stored in the first data plot style holder for that layer.  The second data plot in the layer will display according to the information stored in the second data plot style holder for that layer, and so on.  As you add data plots to the layer, Origin searches for a data plot style holder that is not currently in use (for example, if you removed a data plot from the layer contents), and displays the data plot using the first data plot style holder found.  If you add more data plots to the layer than there are style holders, Origin will display the data plot using the information in the last data plot style holder.
</p>
<h2><a name="Additional_Scripts_Saved_with_Template"></a><span class="mw-headline">Additional Scripts Saved with Template</span></h2>
<p>You are allowed to use specific commands to save some LabTalk scripts with the graph template. Here will have two commands supported since Origin 2021b:
</p><p><span class='headerInParagraph'>To execute a LabTalk command during plotting the graph, </span>
</p>
<ul><li> you can use the command <b>page.info.system.plotting.LT$=</b></li></ul>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/What_is_Saved_with_the_Graph_Template/Tutorial_icon.png?v=9654" width="57"  border="0" />
	</td>
	<td><ol>
<li>New a project, import <b>&lt;<i>Program Folder</i>&gt;\Samples\Graphing\Group.DAT</b> into a new workbook.
<li>Highlight first columns and select <b>Plot &gt; Basic 2D&#160;: Scatter</b> to create a plot. 
<li>Double-click on the plot to open the Plot Details dialog, select Solid Circle as symbol shape, select col(C) for <b>Size</b> and set <b>Scaling Factor</b> to 4, assign col(D) as Symbol Color mapping.<br />
<a  class="image"><img alt="Save Script With Template.png" src="../images/What_is_Saved_with_the_Graph_Template/Save_Script_With_Template.png?v=88279" width="695"  /></a></li>
<li> To prepare to save the this template with the Symbol Size mapping and Symbol Color mapping, you need to firstly run script below:
<pre class="lt" style="font-family:monospace;">page.<span style="color: #000080;">info</span>.<span style="color: #000080;">system</span>.<span style="color: #000080;">plotting</span>.<span style="color: #000080;">LT</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;worksheet -p 248 __TEMPLATE;&quot;</span></pre>
<p>Here, <code>worksheet -p 248 __TEMPLATE;</code> is the LabTalk command you want to save with the template to keep the column mapping information. <code>__TEMPLATE</code> is a key to notate the current window you want to save(as you haven't named it).
</p>
</li>
<li> Right click on window title, select <b>Save Template As</b> to open dialog, fill a name like myBnC, click OK.
<li> Activate back source workbook, select <b>Plot&#160;: My Templates&#160;: myBnC</b>, you can create a same graph.
</ol>
</td></tr></table>
<p><br />
<span class='headerInParagraph'>To execute a LabTalk command after plotted a graph,</span>
</p>
<ul><li> you can use the command <b>page.info.system.plotting.LTAfter$</b></li></ul>
<p>For example, if you want to <a href="../../UserGuide/UserGuide/Fitting_Page_to_Layers_and_Fitting_Layer_to_Page.html" title="UserGuide:Fitting Page to Layers and Fitting Layer to Page">"Fit Page to Layers"</a> with <b>Border Width</b> = <i>8</i> after plotting, you can run 
</p>
<pre class="lt" style="font-family:monospace;">page.<span style="color: #000080;">info</span>.<span style="color: #000080;">system</span>.<span style="color: #000080;">plotting</span>.<span style="color: #000080;">LTAfter</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;pfit2l borderwid:=8;&quot;</span></pre>


