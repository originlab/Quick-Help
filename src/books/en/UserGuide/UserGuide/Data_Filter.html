<h1 class="firstHeading">4.4.19 Data Filter</h1><p class='urlname' style='display: none'>Wks-DataFilter</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Status_of_Filter"><span class="tocnumber">1.1</span> <span class="toctext">Status of Filter</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-3"><a href="#Add.2FRemove_Data_Filter"><span class="tocnumber">2</span> <span class="toctext">Add/Remove Data Filter</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Enable.2FDisable_Data_Filter"><span class="tocnumber">3</span> <span class="toctext">Enable/Disable Data Filter</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Reapply_Data_Filter"><span class="tocnumber">4</span> <span class="toctext">Reapply Data Filter</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Copy_and_Paste_Data_Filter"><span class="tocnumber">5</span> <span class="toctext">Copy and Paste Data Filter</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Customize_Data_Filters"><span class="tocnumber">6</span> <span class="toctext">Customize Data Filters</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Menu_Options_and_Dialog_Controls"><span class="tocnumber">7</span> <span class="toctext">Menu Options and Dialog Controls</span></a>
<ul>
<li class="toclevel-2 tocsection-9"><a href="#Date_Filter"><span class="tocnumber">7.1</span> <span class="toctext">Date Filter</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Numeric_Filter"><span class="tocnumber">7.2</span> <span class="toctext">Numeric Filter</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Text_Filter"><span class="tocnumber">7.3</span> <span class="toctext">Text Filter</span></a>
<ul>
<li class="toclevel-3 tocsection-12"><a href="#Custom_Filter_.28Simple_Text.29"><span class="tocnumber">7.3.1</span> <span class="toctext">Custom Filter (Simple Text)</span></a></li>
<li class="toclevel-3 tocsection-13"><a href="#Custom_Filter_.28Advanced_Text.29"><span class="tocnumber">7.3.2</span> <span class="toctext">Custom Filter (Advanced Text)</span></a>
<ul>
<li class="toclevel-4 tocsection-14"><a href="#Specifying_your_Condition"><span class="tocnumber">7.3.2.1</span> <span class="toctext">Specifying your Condition</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-2 tocsection-15"><a href="#Custom_Data_Filter_dialog"><span class="tocnumber">7.4</span> <span class="toctext">Custom Data Filter dialog</span></a>
<ul>
<li class="toclevel-3 tocsection-16"><a href="#Custom_Data_Filter_Buttons"><span class="tocnumber">7.4.1</span> <span class="toctext">Custom Data Filter Buttons</span></a></li>
<li class="toclevel-3 tocsection-17"><a href="#Filter_Menu"><span class="tocnumber">7.4.2</span> <span class="toctext">Filter Menu</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-18"><a href="#Ignore_Hidden_Rows"><span class="tocnumber">8</span> <span class="toctext">Ignore Hidden Rows</span></a></li>
<li class="toclevel-1 tocsection-19"><a href="#Save_Data_Filter_into_Operation"><span class="tocnumber">9</span> <span class="toctext">Save Data Filter into Operation</span></a></li>
</ul>
</div>

<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<dl><dd><a  class="image"><img alt="DataFilter.png" src="../images/Data_Filter/DataFilter.png?v=71626" width="741"  /></a></dd></dl>
<p>Origin offers data filters of three data formats, date time, numeric, and text. The data filter could be added, removed, enabled, disabled, or reapplied by button click in the <b>Worksheet Data</b> toolbar and customized with user defined filtering conditions.
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Data_Filter/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>You can also apply a data filter to <a href="../../UserGuide/UserGuide/Displaying_Supporting_Data_in_Worksheet_Header_Rows.html" title="UserGuide:Displaying Supporting Data in Worksheet Header Rows">column label row</a> data by switching to Column List View (<b>View: Column List View</b>) and applying a data filter to a List View column. For more information, see <a href="../../UserGuide/UserGuide/Column_List_View.html#Applying_a_Data_Filter" title="UserGuide:Column List View">Column List View - Applying a Data Filter</a>.
</p></td></tr></table>
<h3><a name="Status_of_Filter"></a><span class="mw-headline">Status of Filter</span></h3>
<p>Once you have added a filter to a column, you can check the filtering status from the color of the filter icon on the column header.<br />
<a  class="image"><img alt="Data Filter 01.png" src="../images/Data_Filter/850px-Data_Filter_01.png?v=94610" width="850"   /></a>
</p>
<h2><a name="Add.2FRemove_Data_Filter"></a><span class="mw-headline">Add/Remove Data Filter</span></h2>
<p>To add or remove a data filter to the one or several columns:
</p>
<ol><li>Highlight the desired column(s).</li>
<li>Click the <b>Add/Remove Data Filter</b> button <a  class="image"><img alt="Button Add Remove Column Filter.png" src="../images/Data_Filter/Button_Add_Remove_Column_Filter.png?v=29260" width="21"  /></a>.</li></ol>
<p>When a data filter is added, it is by default an empty filter, no filtering condition is set. Once filtering conditions are set, the filter is automatically named by the filter condition and the filter icon is fully filled with color green.
</p><p><a  class="image"><img alt="Column Filter 001.png" src="../images/Data_Filter/Column_Filter_001.png?v=30698" width="69"  /></a>
</p><p>Clicking the <b>Add/Remove Data Filter</b> button on a selected column with an applied filter, removes the filter. The same thing is done when you clear a filter from the filter icon menu.
</p>
<ol><li>Highlight the desired column(s) with data filters.</li>
<li>Click the <b>Filter</b> icon and choose <b>Clear Filter</b> in the context menu.</li></ol>
<p><a  class="image"><img alt="Column Filter 002.png" src="../images/Data_Filter/Column_Filter_002.png?v=30697" width="140"  /></a>
</p><p>If you want to toggle your filter on or off without losing your filter, just <i>disable</i> the filter (see next).
</p>
<h2><a name="Enable.2FDisable_Data_Filter"></a><span class="mw-headline">Enable/Disable Data Filter</span></h2>
<p>When a data filter is added, it is possible to enable or disable it by either of the following:
</p>
<ol><li>Highlight the desired column(s).</li>
<li>Click the <b>Enable/Disable Data Filter</b> button <a  class="image"><img alt="Button Enable Disable Column Filter.png" src="../images/Data_Filter/Button_Enable_Disable_Column_Filter.png?v=29924" width="23"  /></a>.</li></ol>
<p>or
</p>
<ol><li>Highlight the desired column.</li>
<li>Click on the <b>Filter</b> icon and bring up context menu, check <b>Enable Filter</b> to enable and uncheck to disable.</li></ol>
<p><a  class="image"><img alt="Column Filter 003.png" src="../images/Data_Filter/Column_Filter_003.png?v=30695" width="140"  /></a>
</p><p>If multiple columns are selected in the second case, only the data filter of the leftmost selected column will be disabled/enabled.
</p><p>When a data filter is disabled, the filter icon turns to grey, and there is an "off" before the filter name.
</p><p><a  class="image"><img alt="Column Filter 004.png" src="../images/Data_Filter/Column_Filter_004.png?v=30714" width="71"  /></a>
</p><p>If your selected range of columns include both enabled and disabled columns, when you click the <a  class="image"><img alt="Button Enable Disable Column Filter.png" src="../images/Data_Filter/Button_Enable_Disable_Column_Filter.png?v=29924" width="23"  /></a> button, all columns will be disabled.
</p>
<h2><a name="Reapply_Data_Filter"></a><span class="mw-headline">Reapply Data Filter</span></h2>
<p>Like MS Excel, when you make changes to filtered data in a worksheet column, you must reapply the filter.  When the filter is in need of being reapplied, the filter icon will turn yellow. You can reapply the filter by clicking the <b>Reapply data filter</b> <a  class="image"><img alt="Button Reapply Column Filter.png" src="../images/Data_Filter/Button_Reapply_Column_Filter.png?v=29925" width="20"  /></a> button on the Worksheet Data toolbar.
</p>
<dl><dd><a  class="image"><img alt="Filter update pending.png" src="../images/Data_Filter/Filter_update_pending.png?v=94602" width="651"  /></a></dd></dl>
<p><br />
</p>
<table class="note">

<tr>
<td><b>Note:</b> We may introduce LabTalk variables into the filter condition. In general, the filter condition with the variables will be cached after the filter is run. Thus, the result will not change after you click the <b>Reapply Data Filter</b> button <a  class="image"><img alt="Button Reapply Column Filter.png" src="../images/Data_Filter/Button_Reapply_Column_Filter.png?v=29925" width="20"  /></a>, even you already change the values of the variables by LabTalk. If we want to update the LabTalk variables in filter condition regardless of the cache, use <a class="external text" href="../../LabTalk/LabTalk/Wks_(object).html#Methods">LabTalk method</a> <code>wks.runfilter()</code> to reapply filter.
</td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Data_Filter/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>By default, when saving a workbook with a <a href="../../UserGuide/Category/Data_Connector.html" title="Category:Data Connector">Data Connector</a>, imported data are excluded (not saved with the file). If you add a data filter to the workbook, when the file is reopened, the data filter is auto-run after import. If you do not want the data filter to auto-run on import, set <a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#U.2CV.2CW"><b>@WFI=0</b></a>. For information on changing the value of a LabTalk system variable, see <a class="external text" href="../../QuickHelp/QuickHelp/How_do_I_permanently_change_the_value_of_a_system_variable.html">this FAQ</a>.
</p></td></tr></table>
<h2><a name="Copy_and_Paste_Data_Filter"></a><span class="mw-headline">Copy and Paste Data Filter</span></h2>
<p>You can copy a data filter from one worksheet column and apply it to other columns. This includes custom filters in which use variables defined in <a href="#Custom_Data_Filter_dialog">the <b>Before Condition Script</b> panel</a>.
</p>
<ol><li> Click on the column's filter icon and choose <b>Copy Filter</b> menu item.</li>
<li> Select the target worksheet column, add a filter to it if no filter yet. Click on the filter icon and select <b>Paster Filter</b> menu item.</li></ol>
<p><i>OR</i>,
</p>
<ol><li> Right-click on the column's <b>Filter</b> cell and choose <b>Copy</b>; or click on the cell and press CTRL+C</li>
<li> Select the target worksheet column(s) and press Ctrl+V to paste the filter and apply it to data in those columns.</li></ol>
<p><i>OR, for numeric column,</i>
</p>
<ol><li> Click on the column's filter icon and choose <b>Save as</b> menu item. Save the filter settings to a name.</li>
<li> Select the target worksheet column, add a filter to it if no filter yet. Click on the filter icon and select <b>Load</b> menu item. Select the saved filter from its sub-menu.</li></ol>
<h2><a name="Customize_Data_Filters"></a><span class="mw-headline">Customize Data Filters</span></h2>
<p>Origin will detect the data type and automatically assign one of the three data filters (date, numeric, text) to the corresponding columns. The filtering conditions need to be set when customizing data filters.
</p><p>There are two ways to customize a data filter,
</p>
<ol><li>Click on the <b>Filter</b> icon to bring up a context menu.</li>
<li>For each data filter type, several quick menu items are available, choose one to open the corresponding <b>Simple Filter</b> dialog.</li>
<li>Set data filter conditions and click <b>OK</b>.</li></ol>
<p>or
</p>
<ol><li>Click on the <b>Filter</b> icon to bring up a context menu.</li>
<li>Select the <b>Custom Filter</b> to open the <b>Custom Data Filter</b> dialog.</li>
<li>Set data filter conditions and click <b>Apply</b> or <b>OK</b>.</li></ol>
<p><a  class="image"><img alt="Column Filter 005.png" src="../images/Data_Filter/Column_Filter_005.png?v=33824" width="143"  /></a>
</p><p><br />
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Data_Filter/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>Once you've added filter conditions, you can double-click on the <b>Filter</b> cell to edit the filter.
</p>
<dl><dd><a  class="image"><img alt="Filter cell customize.png" src="../images/Data_Filter/Filter_cell_customize.png?v=77998" width="530"  /></a></dd></dl>
</td></tr></table>
<h2><a name="Menu_Options_and_Dialog_Controls"></a><span class="mw-headline">Menu Options and Dialog Controls</span></h2>
<p>Three general types of filters are supported, grouped by Format:
</p>
<ul><li> <b>Date</b></li>
<li><b>Numeric</b></li>
<li><b>Text</b>, <b>Month</b> or <b>Day of Week</b>.</li></ul>
<p>Available menu options vary by Format. Origin uses the column's Format <a href="../../UserGuide/UserGuide/The_(Column_Properties)_Properties_Tab.html#Format" title="UserGuide:The (Column Properties) Properties Tab">Properties</a> to determine which menu options to display.
</p>
<h3><a name="Date_Filter"></a><span class="mw-headline">Date Filter</span></h3>
<p>When the column <a href="../../UserGuide/UserGuide/The_(Column_Properties)_Properties_Tab.html#Format" title="UserGuide:The (Column Properties) Properties Tab"><b>Format</b> = <b>Date</b></a>, you have the following filtering options:
</p>
<dl><dd><a  class="image"><img alt="Filter menu date.png" src="../images/Data_Filter/Filter_menu_date.png?v=93904" width="140"  /></a></dd></dl>
<p>Clicking <b>Equals</b>, <b>Before</b> or <b>After</b> will open the <b>Simple Date Filter</b> dialog box. Clicking <b>Between</b> provides a simple dialog for setting a date range.
</p>
<dl><dd><dl><dd><a  class="image"><img alt="Filter simple date filter.png" src="../images/Data_Filter/Filter_simple_date_filter.png?v=89181" width="487"  /></a></dd></dl></dd></dl>
<p>Set the <b>Formula Type</b>, <b>Value</b> and <b>Condition2</b> or <b>From</b> and <b>To</b>, to filter by date.
</p><p>The Simple Date Filter <b>Condition2</b> is used for <b>And/Or</b> filtering. The default state is <b>None</b> but you can set the drop-down to either <b>And</b> or <b>Or</b> and create a second filter condition.
</p>
<dl><dd><dl><dd><a  class="image"><img alt="Filter simple date condition2.png" src="../images/Data_Filter/Filter_simple_date_condition2.png?v=89180" width="233"  /></a></dd></dl></dd></dl>
<table class="dialogcontroltable">

<tr>
<th>None
</th>
<td>No second filter condition (default).
</td></tr>
<tr>
<th>And
</th>
<td>Keep rows where the date and time holds true for both query conditions, and hide others.
</td></tr>
<tr>
<th>Or
</th>
<td>Keep the rows where the date and time holds for either one of the two query conditions, and hide others.
</td></tr></table>
<p><br />
For more advanced filtering, use the <a href="../../UserGuide/UserGuide/Data_Filter.html#Custom_Data_Filter_dialog" title="UserGuide:Data Filter"><b>Custom Data Filter</b> dialog</a>, available when you click the <b>Custom Filter</b> menu item at the bottom of the Date filter menu.
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Data_Filter/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>Previously, <b>Value</b>, <b>To</b> and <b>From</b> used a standard date-picker control which has been replaced by a simple text field. To revert to the date-picker <a class="external text" href="../../QuickHelp/QuickHelp/How_do_I_permanently_change_the_value_of_a_system_variable.html">set system variable</a> <b>@DP</b> = <i>1</i>.
</p>
<dl><dd><a  class="image"><img alt="Filter revert date picker.png" src="../images/Data_Filter/Filter_revert_date_picker.png?v=89184" width="392"  /></a></dd></dl>
</td></tr></table>
<h3><a name="Numeric_Filter"></a><span class="mw-headline">Numeric Filter</span></h3>
<p>When the column <a href="../../UserGuide/UserGuide/The_(Column_Properties)_Properties_Tab.html#Format" title="UserGuide:The (Column Properties) Properties Tab"><b>Format</b> = <b>Numeric</b></a>, you have the following filtering options:
</p>
<dl><dd><dl><dd><a  class="image"><img alt="Filter menu numeric.png" src="../images/Data_Filter/Filter_menu_numeric.png?v=93903" width="140"  /></a></dd></dl></dd></dl>
<p>Clicking <b>Equals</b>, <b>Less Than</b> or <b>Greater Than</b> will open the <b>Simple Numeric Filter</b> dialog box. Clicking <b>Between</b> provides a simple dialog for setting a numeric range.
</p>
<dl><dd><dl><dd><a  class="image"><img alt="Filter simple numeric filter.png" src="../images/Data_Filter/Filter_simple_numeric_filter.png?v=75333" width="579"  /></a></dd></dl></dd></dl>
<p>Set the <b>Formula Type</b>, <b>Value</b> and <b>Condition2</b> or <b>From</b> and <b>To</b>, to filter by number.
</p><p>The Simple Numeric Filter <b>Condition2</b> is used for <b>And/Or</b> filtering. The default state is <b>None</b> but you can set the drop-down to either <b>And</b> or <b>Or</b> and create a second filter condition.
</p>
<dl><dd><dl><dd><a  class="image"><img alt="Filter simple numeric condition2.png" src="../images/Data_Filter/Filter_simple_numeric_condition2.png?v=75334" width="305"  /></a></dd></dl></dd></dl>
<table class="dialogcontroltable">

<tr>
<th>None
</th>
<td>No second filter condition (default).
</td></tr>
<tr>
<th>And
</th>
<td>Keep rows where the numeric condition holds true for both query conditions, and hide others.
</td></tr>
<tr>
<th>Or
</th>
<td>Keep rows where the numeric condition holds for either one of the two query conditions, and hide others.
</td></tr></table>
<p><br />
Clicking <b>Top 10</b> or <b>Bottom 10</b> opens the the <b>Top N</b> dialog box. Here you can filter out all but the highest or lowest values by number of <b>Items</b> or by <b>Percent</b>. 
</p>
<dl><dd><dl><dd><a  class="image"><img alt="Filter numeric topN.png" src="../images/Data_Filter/Filter_numeric_topN.png?v=75335" width="240"  /></a></dd></dl></dd></dl>
<p><br />
For more advanced filtering, use the <a href="../../UserGuide/UserGuide/Data_Filter.html#Custom_Data_Filter_dialog" title="UserGuide:Data Filter"><b>Custom Data Filter</b> dialog</a>, available when you click the <b>Custom Filter</b> menu item at the bottom of the Date filter menu.
</p>
<h3><a name="Text_Filter"></a><span class="mw-headline">Text Filter</span></h3>
<p>The text filter will be applied if the data format of the selected column is <b>Text</b>, <b>Month</b> or <b>Day of Week</b>.
</p><p>From the quick menu, you can select/deselect the check boxes to show/hide corresponding text entries.
</p><p><a  class="image"><img alt="Column Filter Menu 002.png" src="../images/Data_Filter/Column_Filter_Menu_002.png?v=93905" width="232"  /></a>
</p>
<h4><a name="Custom_Filter_.28Simple_Text.29"></a><span class="mw-headline">Custom Filter (Simple Text)</span></h4>
<p>Click the <b>Custom Filter</b> quick menu item to bring up the <b>Custom Filter(Simple Text)</b> dialog.
</p><p><a  class="image"><img alt="Column Filter Menu 003.png" src="../images/Data_Filter/Column_Filter_Menu_003.png?v=33848" width="558"  /></a>
</p>
<ul><li> The <b>Entry</b> column lists all the unique text entries from the selected range. The <b>Count</b> column lists the frequency of the corresponding text entry in the selected range.</li>
<li> Clicking on either column header will sort the results in the data panel by ascending or descending order.</li>
<li> Use check boxes to show or hide the rows corresponding to each entry. Clearing a box hides corresponding rows.</li></ul>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Data_Filter/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>After applying a text filter, the <b>Filter</b> label row will contain a list of the text entries which have not been hidden with the filter. By default, the entries in this cell are separated by a space (" "). The system variable <b>@TFS</b> can be used to switch the separator: 0=Enter, 1=Space, 2=Comma, 3=Semicolon.
</p>
<dl><dd><dl><dd><a  class="image"><img alt="Filter text label row.png" src="../images/Data_Filter/Filter_text_label_row.png?v=75375" width="240"  /></a></dd></dl></dd></dl>
<p>Another system variable <b>@TFL</b> can be used to set the max number of characters in the text filter label row. By default, this value is 50. The first string and last string will always show in full (sorting is alphabetical);  unlisted strings will be shown as "...".
</p><p>For information on these two LabTalk System Variables see the <a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#T">LabTalk System Variable List</a>.
</p></td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Data_Filter/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>When the X column of a column/bar graph contains text, this text is used to label major ticks, ordered by row index. Prior to Origin 2018, when applying a worksheet data filter, plots registered the vacant ticks and labels of filtered data, though the data points were not plotted. This was changed in Origin 2018 so that ticks associated with filtered data no longer display. This only applies to X columns that contain text and are NOT <a href="../../UserGuide/UserGuide/Displaying_Supporting_Data_in_Worksheet_Header_Rows.html#Categories" title="UserGuide:Displaying Supporting Data in Worksheet Header Rows">Set as Categorical</a>.
</p>
<dl><dd><a  class="image"><img alt="Filter X Label Data.png" src="../images/Data_Filter/Filter_X_Label_Data.png?v=76321" width="719"  /></a></dd></dl>
<p>You can restore the pre-2018 behavior using <code>wks.KHRA=1;</code> (you could, for instance, add this to  <a href="../../UserGuide/UserGuide/The_Workbook_Script_Panel.html" title="UserGuide:The Workbook Script Panel">the workbook Script Panel</a>).
</p></td></tr></table>
<h4><a name="Custom_Filter_.28Advanced_Text.29"></a><span class="mw-headline">Custom Filter (Advanced Text)</span></h4>
<p>Select the <b>Advanced</b> check box to bring up the <b>Custom Filter(Advanced Text)</b> dialog.
</p>
<dl><dd><a  class="image"><img alt="Column Filter Menu 004.png" src="../images/Data_Filter/Column_Filter_Menu_004.png?v=33814" width="558"  /></a></dd></dl>
<ul><li> The <b>Condition</b> panel is used to input filter conditions.</li>
<li> The <b>Before Condition Script</b> panel is used to define LabTalk script which will run <i>before</i> the filtering operation.</li></ul>
<p><br />
</p>
<h5><a name="Specifying_your_Condition"></a><span class="mw-headline">Specifying your Condition</span></h5>
<dl><dd><a  class="image"><img alt="Column Filter Menu 004 1.png" src="../images/Data_Filter/Column_Filter_Menu_004_1.png?v=82953" width="716"  /></a></dd></dl>
<p>You can use any combination of direct keyboard entry and menu selection to build your expression. The dialog box lists some key elements (wildcard characters, row index) and shows an example expression.
</p>
<ul><li> The <b>Variable to represent Col(N)</b> box lists an editable variable that you must use to represent the current column, when building your expression.</li>
<li> Click the triangle button to the right to open a fly-out menu. The menu lists <b>String</b> functions, <b>Logical</b> functions and <b>User Origin C</b> functions (if any). Select a function to enter it directly into the <b>Condition</b> box, then modify using your own arguments. For usage information on these functions, see <a class="external text" href="../../LabTalk/Script/LabTalk-Supported_Functions.html">LabTalk Supported Functions</a>.</li>
<li> You can use natural language logical operators "AND", "OR", "NOT" and "LIKE" or you can use their symbolic equivalents (see <a class="external text" href="../../LabTalk/LabTalk/Operators.html#Logical_and_Relational_Operators">Logical and Relational Operators</a>). For example, the following are equivalent ...</li></ul>
<dl><dd><table class="simple" style="white-space:nowrap">
<tr>
<td style="background: #C9C9C9; border: 1px solid black"><b> Example </b>
</td>
<td style="background: #C9C9C9; border: 1px solid black"><b> Description </b>
</td></tr>
<tr>
<td style="border: 1px solid black"> NOT(make="Buick" OR make="Chrysler")
</td>
<td style="border: 1px solid black"> Filter out "Buick" and "Chrysler"
</td></tr>
<tr>
<td style="border: 1px solid black">&#160;!(make="Buick" OR make="Chrysler")
</td>
<td style="border: 1px solid black"> Filter out "Buick" and "Chrysler"
</td></tr>
<tr>
<td style="border: 1px solid black"> !(make=&quot;Buick&quot; || make=&quot;Chrysler&quot;)
</td>
<td style="border: 1px solid black"> Filter out "Buick" and "Chrysler"
</td></tr></table></dd></dl>
<ul><li> Usage of wildcards:</li></ul>
<dl><dd><table class="simple" style="white-space:nowrap">
<tr>
<td style="background: #C9C9C9; border: 1px solid black"><b> Symbol </b>
</td>
<td style="background: #C9C9C9; border: 1px solid black"><b> Usage </b>
</td></tr>
<tr>
<td style="border: 1px solid black">&#160;?(question mark)
</td>
<td style="border: 1px solid black"> Stands for any single character, e.g. "a?c" finds "abc" or "adc" but will not find "abbc"
</td></tr>
<tr>
<td style="border: 1px solid black"> *(asterisk)
</td>
<td style="border: 1px solid black"> Stands for any string of characters, e.g. "abc*e" finds "abcde" or "abcdde" or "abce"
</td></tr>
<tr>
<td style="border: 1px solid black"> ==(two equation marks)
</td>
<td style="border: 1px solid black"> Stands for full match, e.g. x=="a*" finds exactly "a*" but not "abc"
</td></tr></table></dd></dl>
<ul><li> The variable <b>i</b> can be used in the <b>Condition</b> panel as a substitute for row index. For example, <i>i&gt;15</i> means the rows after the 15th row. Variable <b>i</b> also can be used in the <b>Custom Data Filter</b> dialog.</li></ul>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Data_Filter/Tutorial_icon.png?v=9654" width="57"  border="0" />
	</td>
	<td><p>The following short tutorial will show you how to use the wildcard control for text filter.
</p>
<ol><li>Import the <b>Automobile.dat</b> file from \Samples\Statistics\ into Origin.</li>
<li>Highlight column B and click the <b>Add/Remove Data Filter</b> button <a  class="image"><img alt="Button Add Remove Column Filter.png" src="../images/Data_Filter/Button_Add_Remove_Column_Filter.png?v=29260" width="21"  /></a>.</li>
<li>Click on the <b>Filter</b> icon and select <b>Custom Filter</b>.
<dl><dd><a  class="image"><img alt="Column Filter 006.png" src="../images/Data_Filter/Column_Filter_006.png?v=30703" width="245"  /></a></dd></dl></li>
<li>Check for the <b>Advanced</b> check box.</li>
<li>In the Query box, enter:<pre class="lt" style="font-family:monospace;">x LIKE <span style="color: #ff00ff;">&quot;S*&quot;</span></pre></li>
<li>Click <b>OK</b> and then <b>Yes</b> for the reminder message(if any).</li>
<li>Go back to the original worksheet, only the rows with text starting with "s" remain.</li></ol>
</td></tr></table>
<h3><a name="Custom_Data_Filter_dialog"></a><span class="mw-headline">Custom Data Filter dialog</span></h3>
<p>The <b>Custom Data Filter</b> dialog is used to perform advanced filtering of <b>Date</b> and <b>Numeric</b> data.
</p><p><a  class="image"><img alt="Column Filter Menu 001.png" src="../images/Data_Filter/Column_Filter_Menu_001.png?v=33827" width="558"  /></a>
</p>
<ul><li> Use the <b>Condition</b> panel to input filter conditions.  Note that you can click the triangle button <a  class="image"><img alt="Button Select Data Right Triangle.png" src="../images/Data_Filter/Button_Select_Data_Right_Triangle.png?v=1905" width="18"  /></a> to open a fly-out menu for inserting of date- and numeric-related functions. For information on these functions, see <a class="external text" href="../../LabTalk/Script/LabTalk-Supported_Functions.html">LabTalk Supported Functions</a>. For information on operators, see <a class="external text" href="../../LabTalk/LabTalk/Operators.html#Logical_and_Relational_Operators">Logical and Relational Operators</a>).</li></ul>
<ul><li> The <b>Before Condition</b> script panel (if not visible, click the <a  class="image"><img alt="Button Show Scripts.png" src="../images/Data_Filter/Button_Show_Scripts.png?v=36233" width="23"  /></a> button) is used to define LabTalk scripts to run before filtering. Note, again, the triangle button <a  class="image"><img alt="Button Select Data Right Triangle.png" src="../images/Data_Filter/Button_Select_Data_Right_Triangle.png?v=1905" width="18"  /></a> gives quick access to functions for use in your script.</li></ul>
<h4><a name="Custom_Data_Filter_Buttons"></a><span class="mw-headline">Custom Data Filter Buttons</span></h4>
<table class="dialogcontroltable">

<tr>
<th>Test
</th>
<td>The rows which meet the filter condition will be highlighted in the original worksheet, these rows will remain after filtering.
</td></tr>
<tr>
<th>OK
</th>
<td>Apply the change of filter conditions and close the dialog.
</td></tr>
<tr>
<th>Cancel
</th>
<td>Close the dialog without applying the modification of filter conditions.
</td></tr>
<tr>
<th>Apply
</th>
<td>Apply the change of filter conditions without closing the dialog.
</td></tr></table>
<p><br />
For numeric filtering, a few built-in LabTalk functions are not included in the fly-out menu. The following table documents these functions:
</p>
<table class="simple" style="white-space:nowrap">
<tr>
<td style="background: #C9C9C9; border: 1px solid black"><b> Expression </b>
</td>
<td style="background: #C9C9C9; border: 1px solid black"><b> Usage </b>
</td></tr>
<tr>
<td style="border: 1px solid black"> x.between(x1,x2)
</td>
<td style="border: 1px solid black"> Return the sub range of x between user-input values x1 and x2, equal to <pre class="lt" style="font-family:monospace;">x<span style="color: #000080;">&lt;=</span>x2 <span style="color: #000080;">&amp;&amp;</span> x<span style="color: #000080;">&gt;=</span>x1</pre>.
<p><b>*</b>See note below table.
</p>
</td></tr>
<tr>
<td style="border: 1px solid black"> x.top(10,0)
</td>
<td style="border: 1px solid black"> Return the top 10 values of x.
</td></tr>
<tr>
<td style="border: 1px solid black"> x.top(10,1)
</td>
<td style="border: 1px solid black"> Return the top 10% of values of x.
</td></tr>
<tr>
<td style="border: 1px solid black"> x.bottom(10,0)
</td>
<td style="border: 1px solid black"> Return the bottom 10 values of x.
</td></tr>
<tr>
<td style="border: 1px solid black"> x.bottom(10,1)
</td>
<td style="border: 1px solid black"> Return the bottom 10% of values of x.
</td></tr>
<tr>
<td style="border: 1px solid black"> x.top(n,0/1)
</td>
<td style="border: 1px solid black"> Return the top <i>n</i> values of x; when 0 is chosen, <i>n</i> is the number of items, when 1 is chosen, <i>n</i> is the percentage.
</td></tr>
<tr>
<td style="border: 1px solid black"> x.bottom(n,0/1)
</td>
<td style="border: 1px solid black"> Return the bottom <i>n</i> values of x; when 0 is chosen, <i>n</i> is the number of items, when 1 is chosen, <i>n</i> is the percentage.
</td></tr></table>
<p><b>*</b> In this expression, x1 and x2 are typically row numbers. If you wish to use variables in this expression, you should not use "x1" and "x2" as they are widely-used system variables and their values may change. Instead, consider using <a class="external text" href="../../LabTalk/LabTalk/System_Variables.html#V1.2C_V1.24.E2.80.93V4.2C_V4.24">page variables v1...v4</a>.
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Data_Filter/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>For Text, Date, and Numeric filters, Origin also supports the function <b>x.count()</b> to count the number of the duplicated data. For example: To keep text data which number is over 3, in the <b>Custom Data Filter</b> dialog you can set: <code><b>Condition:</b> x.count() &gt; 3</code>
</p></td></tr></table>
<h4><a name="Filter_Menu"></a><span class="mw-headline">Filter Menu</span></h4>
<p><a  class="image"><img alt="Custom Data Filter Filter Menu.png" src="../images/Data_Filter/Custom_Data_Filter_Filter_Menu.png?v=74797" width="566"  /></a>
</p><p>From the <b>Filter</b> menu you can:
</p>
<ul><li> Load samples</li>
<li> Load saved custom filters</li>
<li> Save custom filters</li></ul>
<p>Loaded filters display at the bottom of this menu (if none loaded, reads "Empty").
</p>
<h2><a name="Ignore_Hidden_Rows"></a><span class="mw-headline">Ignore Hidden Rows</span></h2>
<p>By default, rows hidden by a filter are ignored in graphing operations. You can change this behavior and include such rows using either of the following:
</p>
<ol><li>Activate a worksheet.</li>
<li>In the Command or Script window, run the script:</li></ol>
<pre class="lt" style="font-family:monospace;">wks.<span style="color: #000080;">ignorehidden</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;</pre>
<p><i>or</i>
</p>
<ol><li>From the top menu, select <b>Format:Worksheet</b> or press <b>F4</b> to open the <b>Worksheet Properties</b> dialog.</li>
<li>In the <b>Miscellaneous</b> tab, uncheck <b>Ignore Hidden Rows on Plotting and Analysis</b>.</li></ol>
<table class="note">
<tr>
<td><b>Note:</b> Hidden rows are not ignored in LT scripts and Set Values.
</td></tr></table>
<p><br />
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Data_Filter/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>When you apply a mask and add a data filter on the column data, the masked data is still shown on the column by default.
</p><p>Whether showing the masked data on the column with data filter, that is controlled by the system variable @FBM.
</p>
<ul><li>0:Hide</li>
<li>1:Show</li></ul>
</td></tr></table>
<h2><a name="Save_Data_Filter_into_Operation"></a><span class="mw-headline">Save Data Filter into Operation</span></h2>
<p>In the <a href="../../UserGuide/UserGuide/Recalculating_Analysis_Results.html" title="UserGuide:Recalculating Analysis Results">Recalculate</a> lock icon's context menu for <a href="../../UserGuide/UserGuide/Copy_Columns_to_New_Destination.html" title="UserGuide:Copy Columns to New Destination"><b>Copy Columns to...</b></a> and <a href="../../UserGuide/UserGuide/Pivot_Table.html" title="UserGuide:Pivot Table"><b>Pivot Table</b></a>, there are three worksheet filter options. They are used to control whether the results will be affected by further filter changes. 
</p><p><b>Note</b>: Recalculate Mode of Copy Columns and Pivot Table should be set to <b>Auto</b> or <b>Manual</b>.
</p><p><a  class="image"><img alt="Filters Lock.png" src="../images/Data_Filter/Filters_Lock.png?v=44605" width="264"  /></a>
</p>
<table class="dialogcontroltable">

<tr>
<th>Worksheet Filters:Lock
</th>
<td>
<p>When this option is selected, the result will be locked from data filter condition change of source column(s). So when the filter condition in the source column worksheet is changed, it will not trigger update in the result columns. 
</p>
</td></tr>
<tr>
<th>Worksheet Filters:Reload
</th>
<td>
<p>This option is only available when the <b>Worksheet Filter: Lock</b> has been selected already. It reloads the data filter condition from the source column(s) to the result column(s). i.e. after you changed the data filter condition of the source column(s), click this option to trigger the auto update of the locked result column(s), so that the same filter condition applies to result column(s) as well.
</p>
</td></tr>
<tr>
<th>Worksheet Filters:Push Back
</th>
<td>
<p>This option is only available when the <b>Worksheet Filter: Lock</b> has been selected already. It pushes the initial data filter condition back to the source column(s). i.e. after you changed the data filter condition of the source worksheet, click this option and the most recent data filter condition that has been applied from source column(s) to result column(s) will be pushed back to the source worksheet. Note that if you applied a data filter directly to result column(s), it will not be pushed back to source. 
</p>
</td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Data_Filter/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>You can add a text label to your graph that combines literal text with the current filter condition. For instance in the following example, we combine literal text "Make =" with a string "%(1, @LF)" to create a dynamic label that changes with the change in filter conditions (i.e. note that for the label to update, the filter cannot be locked).
</p>
<dl><dd><a  class="image"><img alt="Text label options @LF.png" src="../images/Data_Filter/Text_label_options__40LF.png?v=0" width="442"  /></a></dd></dl>
</td></tr></table>


