<h1 class="firstHeading">4.4.2 Join Multiple Sheets by Column</h1><p class='urlname' style='display: none'>join-multi-sheets-bycol</p>
<p><br />
When you have multiple worksheets and want to combine them by column, considering that there are reference columns which should be matched, you can use the <b>Join Multiple Sheets by Column</b> tool.
</p><p><br />
<span class='headerInParagraph'>To open this tool, </span>
</p>
<ul><li> with a workbook window active, select <b>Restructure: Join Multiple Sheets by Column</b> menu.</li></ul>
<dl><dd><a  class="image"><img alt="Join Multiple Sheets by Column 01.png" src="../images/Join_Multiple_Sheets_by_Column/Join_Multiple_Sheets_by_Column_01.png?v=94790" width="494"  /></a></dd></dl>
<p>This tool utilizes the <a class="external text" href="../../XFunction/X-Function/Wjoinbycol.html">Wjoinbycol</a> X-Function.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Recalculate"><span class="tocnumber">1</span> <span class="toctext">Recalculate</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Input_Worksheets"><span class="tocnumber">2</span> <span class="toctext">Input Worksheets</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Matching_Columns"><span class="tocnumber">3</span> <span class="toctext">Matching Columns</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Sort_Output"><span class="tocnumber">4</span> <span class="toctext">Sort Output</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Drop_Non-matches"><span class="tocnumber">5</span> <span class="toctext">Drop Non-matches</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Options"><span class="tocnumber">6</span> <span class="toctext">Options</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#Drop_Multiples"><span class="tocnumber">6.1</span> <span class="toctext">Drop Multiples</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Match_with_All_Combinations"><span class="tocnumber">6.2</span> <span class="toctext">Match with All Combinations</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Merge_Matched_Columns_as_One"><span class="tocnumber">6.3</span> <span class="toctext">Merge Matched Columns as One</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Consider_Missing_Value"><span class="tocnumber">6.4</span> <span class="toctext">Consider Missing Value</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Dataset_Identifier"><span class="tocnumber">6.5</span> <span class="toctext">Dataset Identifier</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-12"><a href="#Output_Worksheet"><span class="tocnumber">7</span> <span class="toctext">Output Worksheet</span></a></li>
</ul>
</div>

<h2><a name="Recalculate"></a><span class="mw-headline">Recalculate</span></h2>
<p>Specify the <a href="../../UserGuide/UserGuide/Recalculating_Analysis_Results.html" title="UserGuide:Recalculating Analysis Results">Recalculate Mode</a>.
</p>
<h2><a name="Input_Worksheets"></a><span class="mw-headline">Input Worksheets</span></h2>
<p>Specify the input worksheets you want to join. See <a href="../../UserGuide/UserGuide/Append_worksheet.html#Dialog_Control" title="UserGuide:Append worksheet">the details about how to select input worksheets with the display box and toolbar</a>.
</p>
<h2><a name="Matching_Columns"></a><span class="mw-headline">Matching Columns</span></h2>
<ul><li> When a <b>Long Name</b> is shared among input sheets, you can click on one sheet in <b>Input Worksheets</b>, and then select the <b>Long Name</b> of the Matching Column in the dropdown list.</li></ul>
<ul><li> If the Matching Column with the same <b>Short Name</b> among input sheets,  you can enter the column <b>Short Name</b> in this edit box.</li></ul>
<ul><li> If the matching columns without the same  <b>Long Name</b> or  <b>Short Name</b> among input sheets, you can use "=" as connector for matching column for each sheet, and enter Book Name, Sheet Name, Column Short Name in this edit box. <br />The full syntax is:<br /></li></ul>
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">&#91;</span>BookName1<span style="color: #000000;">&#93;</span>SheetName1<span style="color: #000080;">!</span>ColumnShortName1<span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>BookName2<span style="color: #000000;">&#93;</span>SheetName2<span style="color: #000080;">!</span>ColumnShortName2<span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>BookName3<span style="color: #000000;">&#93;</span>SheetName3<span style="color: #000080;">!</span>ColumnShortName3</pre>
<h2><a name="Sort_Output"></a><span class="mw-headline">Sort Output</span></h2>
<p>Control the order of matched values in the result sheet.
</p>
<ul><li><b>Matching Columns -- Ascending</b></li></ul>
<ul><li><b>Matching Columns -- Descending</b></li></ul>
<ul><li><b>Preserve 1st sheet order</b> <i>(By default)</i></li></ul>
<p>If <b>Merge Matched Columns as One</b> is not selected, <b>Matching Columns â€“ Ascending/Descending</b> will sort output columns rather than matching columns by the first sheet order.
</p><p><br />
</p>
<h2><a name="Drop_Non-matches"></a><span class="mw-headline">Drop Non-matches</span></h2>
<p>To exclude the unmatched cells from the joined worksheet, check this checkbox. Otherwise, columns of non-match values will fill with missing values.
</p>
<dl><dd><a  class="image"><img alt="Join Multiple Sheets Drop Non-matches.png" src="../images/Join_Multiple_Sheets_by_Column/Join_Multiple_Sheets_Drop_Non-matches.png?v=95045" width="710"  /></a></dd></dl>
<h2><a name="Options"></a><span class="mw-headline">Options</span></h2>
<h3><a name="Drop_Multiples"></a><span class="mw-headline">Drop Multiples</span></h3>
<p>This is supposed to be used when there are multiple matched cells for one value. Check this checkbox to merge the multiples by statistics value specified in <b>Merge Multiples by</b> and the replica will be dropped.
</p><p><b>Merge Multiples by</b>: First, Last, Max, Min, Average &amp; Sum.
</p><p>When the <b>Drop Non-matches</b> option is checked, and set <b>Merge Multiples by</b> to <b>Average</b>,  you get the result like this:
</p>
<dl><dd><a  class="image"><img alt="Join Multiple Sheets Drop Multiples.png" src="../images/Join_Multiple_Sheets_by_Column/Join_Multiple_Sheets_Drop_Multiples.png?v=95046" width="680"  /></a></dd></dl>
<h3><a name="Match_with_All_Combinations"></a><span class="mw-headline">Match with All Combinations</span></h3>
<p>When there are multiple matched cells for one value, you can check this check box to show all possible combinations in result worksheet.
</p>
<dl><dd><a  class="image"><img alt="Join Multiple Sheets Match with All Combinations.png" src="../images/Join_Multiple_Sheets_by_Column/Join_Multiple_Sheets_Match_with_All_Combinations.png?v=95047" width="701"  /></a></dd></dl>
<p><br />
</p>
<h3><a name="Merge_Matched_Columns_as_One"></a><span class="mw-headline">Merge Matched Columns as One</span></h3>
<p>Specify whether to keep only one matched column in the result worksheet.
</p>
<dl><dd><a  class="image"><img alt="Join Multiple Sheets Merge Matched Columns as One.png" src="../images/Join_Multiple_Sheets_by_Column/Join_Multiple_Sheets_Merge_Matched_Columns_as_One.png?v=95048" width="786"  /></a></dd></dl>
<h3><a name="Consider_Missing_Value"></a><span class="mw-headline">Consider Missing Value</span></h3>
<p>Check this checkbox to consider missing value in the matching columns as a value to be compared. Uncheck will ignore rows with missing value.
</p>
<h3><a name="Dataset_Identifier"></a><span class="mw-headline">Dataset Identifier</span></h3>
<p>Specify whether to add a parameter label row named <b>Source</b> to the joined worksheet for identifying the source of dataset.
</p>
<ul><li><b>None</b>: identifier label row will not be added.</li>
<li><b>Range</b> /<b>Book Name</b> /<b>Sheet Name</b>: show <b>Range/Book Name/Sheet Name</b> as Identifier</li>
<li><b>Index</b>: identify source sheet by index specified in <b>Index</b>. Format is <b><i>StartIndex</i>:<i>Increment</i></b>.<br /> For example, <code>1:1</code> will identify source worksheets as <i>1,2,3,...</i></li>
<li><b>Sheet Label</b>: Show the <a href="../../UserGuide/UserGuide/Basic_Operations_on_Worksheet.html#Name_and_Notes" title="UserGuide:Basic Operations on Worksheet">sheet label</a> of source worksheet.</li></ul>
<table class="note">

<tr>
<td><b>Note:</b> When <b>Merge Matched Column by On</b> is checked, and <b>Range/Book Name/Sheet Name/Index</b> is selected as Identifier, <b>Source</b> label row of the matched column will show <i>Merged</i>.
</td></tr></table>
<h2><a name="Output_Worksheet"></a><span class="mw-headline">Output Worksheet</span></h2>
<p>Specify the output worksheet.
</p>





