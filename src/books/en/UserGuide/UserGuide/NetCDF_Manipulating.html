<h1 class="firstHeading">21.2 NetCDF Manipulating</h1><p class='urlname' style='display: none'>NetCDF-Manipulating</p>
<p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Manipulation_on_Matrix_Data"><span class="tocnumber">1</span> <span class="toctext">Manipulation on Matrix Data</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Linear_Fit_on_Matrix_Stack"><span class="tocnumber">1.1</span> <span class="toctext">Linear Fit on Matrix Stack</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Descriptive_Statistics_on_Matrix"><span class="tocnumber">1.2</span> <span class="toctext">Descriptive Statistics on Matrix</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Subtraction"><span class="tocnumber">1.3</span> <span class="toctext">Subtraction</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Subtract_Period_Average"><span class="tocnumber">1.4</span> <span class="toctext">Subtract Period Average</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Pixel_Extraction"><span class="tocnumber">1.5</span> <span class="toctext">Pixel Extraction</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Interpolation"><span class="tocnumber">1.6</span> <span class="toctext">Interpolation</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8"><a href="#Profiling_Matrix_Data_on_ROI"><span class="tocnumber">2</span> <span class="toctext">Profiling Matrix Data on ROI</span></a>
<ul>
<li class="toclevel-2 tocsection-9"><a href="#Copy_and_Paste_Positions"><span class="tocnumber">2.1</span> <span class="toctext">Copy and Paste Positions</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Export_and_Import_ROI"><span class="tocnumber">2.2</span> <span class="toctext">Export and Import ROI</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Create_ROI_from_XY"><span class="tocnumber">2.3</span> <span class="toctext">Create ROI from XY</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Create_New"><span class="tocnumber">2.4</span> <span class="toctext">Create New</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#Extract_as_XYZ"><span class="tocnumber">2.5</span> <span class="toctext">Extract as XYZ</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#Intensity_Profile"><span class="tocnumber">2.6</span> <span class="toctext">Intensity Profile</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="#Clear_Data_in_ROI"><span class="tocnumber">2.7</span> <span class="toctext">Clear Data in ROI</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#Across_Multiple_Matrix_Sheets"><span class="tocnumber">2.8</span> <span class="toctext">Across Multiple Matrix Sheets</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="Manipulation_on_Matrix_Data"></a><span class="mw-headline">Manipulation on Matrix Data</span></h2>
<p>After importing a NetCDF file into matrix stack, you can perform <a class="external text" href="../../GettingStarted/OriginLab/Data_Analysis.html#Mathematics">manipulation on matrix data</a>.
</p><p>The following examples show how to use these tools on NetCDF data.
</p>
<h4><a name="Linear_Fit_on_Matrix_Stack"></a><span class="mw-headline">Linear Fit on Matrix Stack</span></h4>
<p>Select <b>Analysis: Linear Fit on Matrix Stack</b> to open the dialog, perform a linear fit on the  NetCDF matrix stack. 
</p>
<dl><dd><a  class="image"><img alt="NetCDF Linear Fit 01.gif" src="../images/NetCDF_Manipulating/NetCDF_Linear_Fit_01.gif?v=89263" width="852"  /></a></dd></dl>
<h4><a name="Descriptive_Statistics_on_Matrix"></a><span class="mw-headline">Descriptive Statistics on Matrix</span></h4>
<p>Select <b>Analysis: Descriptive Statistics</b> to open the dialog to get the descriptive statistics (<b>Mean</b>, <b>SD</b>, <b>Min</b>, <b>Max</b>, <b>Median</b> and <b>Sum</b>) for the matrix stack.
</p>
<dl><dd><a  class="image"><img alt="NetCDF Descriptive Statistics 01.gif" src="../images/NetCDF_Manipulating/NetCDF_Descriptive_Statistics_01.gif?v=89277" width="852"  /></a></dd></dl>
<h4><a name="Subtraction"></a><span class="mw-headline">Subtraction</span></h4>
<p>Select <b>Analysis:  Mathematics: Subtract </b> to open the dialog, perform subtraction between two same-sized matrice stacks to get the difference between them.
</p><p>In the following illustration, we'll get the mean value of the matrix from and then perform subtraction with two mean value matrices to get the difference of them.
</p>
<dl><dd><a  class="image"><img alt="NetCDF Subtraction 01.gif" src="../images/NetCDF_Manipulating/NetCDF_Subtraction_01.gif?v=89285" width="852"  /></a></dd></dl>
<h4><a name="Subtract_Period_Average"></a><span class="mw-headline">Subtract Period Average</span></h4>
<p><i><b>User Story:</b></i> 
</p>
<ol><li> Beginning with a new matrix window, the user imports a data file of monthly average temperature, for a time span of January 1901 to December 2018. This results in a matrix (matrixsheet) containing 1416 matrix objects -- one object for each month of the time span.</li>
<li> The user then re-imports the same file but this time, chooses option of <b>Averaging Across Years</b> at <b>m=monthly</b> intervals. This results in a matrix (matrixsheet) containing 12 matrix objects -- obtained by averaging temperatures by month, over the time span January 1901 to December 2018.</li>
<li> The user wants to subtract the monthly average obtained in step #2 from each month's data, over the original time span. This results in a matrix (matrixsheet) of 1416 matrix objects, each containing the deviation from monthly average, over the January 1901 to December 2018 time span.</li></ol>
<dl><dd><dl><dd><a  class="image"><img alt="OH netCDF simple math mmathtool.png" src="../images/NetCDF_Manipulating/OH_netCDF_simple_math_mmathtool.png?v=92530" width="391"  /></a></dd></dl></dd></dl>
<ol><li> To perform step #3, the user chooses <b>Analysis</b>: <b>Mathematics</b>: <b>Simple Math</b>.
<ul><li> For matrix <b>A</b>, choose the matrix containing readings from January 1901 to December 2018 (1416 matrix objects).</li>
<li> For matrix <b>B</b>, choose the matrix containing the average monthly temperatures over the time span January 1901 to December 2018 (12 matrix objects).</li>
<li> Enter your formula <b>A - B</b></li>
<li> For <b>B Selection</b>, choose <b>Periodic matrices in B</b>.</li></ul></li>
<li> Alternately, the user can choose <b>Analysis: Mathematics: Subtract</b>, choose matrix <b>A</b> and matrix <b>B</b>, choose the output matrix and set <b>Subtract</b> = <b>Periodic matrices in B</b>. Either tool should produce the same output, given the above inputs.</li></ol>
<h4><a name="Pixel_Extraction"></a><span class="mw-headline">Pixel Extraction</span></h4>
<p>Select <b>Matrix: Pixel Extraction</b> to open the dialog, extract the Z value for specified XY coordinates for all matrices in the matrix stack.
</p><p>To specified XY coordinate values, you can: 
</p>
<ul><li> Use <a class="external text" href="../../GettingStarted/OriginLab/Graphical_Exploration_of_Data.html#The_Screen_Reader_Tool">Screen Reader</a> pick the point on the matrix.</li></ul>
<p><i>or</i>
</p>
<ul><li> Manually specify longitude and latitude values in the dialog.</li></ul>
<p><i>or</i>
</p>
<ul><li> Specify longitude and latitude by reference columns. Then extract z values for multiple XY coordinate pairs all at once.</li></ul>
<dl><dd>Note: You can use the longitude and latitude dataset from shapefiles imported by <a class="external text" href="https://www.originlab.com/FileExchange/details.aspx?fid=285" target="_blank"><b>Import Shapefile App</b></a></dd></dl>
<dl><dd><a  class="image"><img alt="NetCDF Pixel Extraction.gif" src="../images/NetCDF_Manipulating/NetCDF_Pixel_Extraction.gif?v=89289" width="852"  /></a></dd></dl>
<p><br />
</p>
<h4><a name="Interpolation"></a><span class="mw-headline">Interpolation</span></h4>
<p>Select <b>Matrix: Resize</b> to open the <a class="external text" href="../../XFunction/X-Function/Msresize.html">msresize</a> dialog, you choose <b>Interpolate</b> as <b>Resize Option</b> to get more detailed information from NC files.
</p>
<h2><a name="Profiling_Matrix_Data_on_ROI"></a><span class="mw-headline">Profiling Matrix Data on ROI</span></h2>
<p>When a matrix is in <a class="external text" href="../../QuickHelp/QuickHelp/What_is_the_difference_between_data_and_image.html">Image Mode</a>, you can use first select an area using the <b>Rectangle/ Circle/ Polygon/ Region</b> tool <a  class="image"><img alt="ROI Rectangle Button.png" src="../images/NetCDF_Manipulating/ROI_Rectangle_Button.png?v=87938" width="22"  /></a> as region-of-interest (ROI), and then extract data from it.
</p><p>Right-click on the ROI and choose an option from the shortcut menu. To discard the ROI, press Delete.
</p>
<dl><dd><a  class="image"><img alt="ROI shortcut menu.png" src="../images/NetCDF_Manipulating/ROI_shortcut_menu.png?v=90076" width="168"  /></a></dd></dl>
<p><i><b>To add multiple ROIs:</b></i>
</p><p>Each ROI is added with a default name (e.g. ROI). You can add multiple ROIs to your matrix image but you need to rename each ROI before you can add another.
</p>
<dl><dd><a  class="image"><img alt="ROI renaming multiple.png" src="../images/NetCDF_Manipulating/ROI_renaming_multiple.png?v=89010" width="347"  /></a></dd></dl>
<ol><li> Double-click on the ROI to open the <b>ROI Position</b> dialog box.</li>
<li> Give the ROI a meaningful (unique) name and click OK.</li></ol>
<p><br />
</p>
<h4><a name="Copy_and_Paste_Positions"></a><span class="mw-headline">Copy and Paste Positions</span></h4>
<p>Copy the position of the selected ROI. Then paste the position of the selected ROI to another ROI (width, height...all). 
</p>
<dl><dd><a  class="image"><img alt="NetCDF Copy and Paste Positions.gif" src="../images/NetCDF_Manipulating/NetCDF_Copy_and_Paste_Positions.gif?v=89290" width="852"  /></a></dd></dl>
<h4><a name="Export_and_Import_ROI"></a><span class="mw-headline">Export and Import ROI</span></h4>
<p>Save the ROI object(s).
<br />Replace the object(s) with those in a saved .ROI file  (hint: create a "dummy" ROI to import).
</p>
<dl><dd><a  class="image"><img alt="NetCDF Export Import ROI.gif" src="../images/NetCDF_Manipulating/NetCDF_Export_Import_ROI.gif?v=89291" width="852"  /></a></dd></dl>
<h4><a name="Create_ROI_from_XY"></a><span class="mw-headline">Create ROI from XY</span></h4>
<p>Add ROI on the matrix, right-click on the ROI in the Matrix, select <b>Create ROI from XY</b>, and use <b>xy2roi</b> tool to import the Worksheet XY data for defining the ROI.
<br /><br />
<i>For example, there is a dataset from shapefiles, you can import it into the NetCDF matrix.</i>
</p>
<dl><dd><a  class="image"><img alt="NetCDF Create ROI from XY.gif" src="../images/NetCDF_Manipulating/NetCDF_Create_ROI_from_XY.gif?v=89292" width="852"  /></a></dd></dl>
<h4><a name="Create_New"></a><span class="mw-headline">Create New</span></h4>
<p>Use the <b>mroi2mat</b> tool to generate a new matrix from the ROI.
</p>
<dl><dd><a  class="image"><img alt="NetCDF Create New.gif" src="../images/NetCDF_Manipulating/NetCDF_Create_New.gif?v=89294" width="852"  /></a></dd></dl>
<h4><a name="Extract_as_XYZ"></a><span class="mw-headline">Extract as XYZ</span></h4>
<p>Use the <b>mroi2xyz</b> tool to generate a new worksheet of XYZ values in the ROI.
</p>
<h4><a name="Intensity_Profile"></a><span class="mw-headline">Intensity Profile</span></h4>
<p>Use the <b>mroiprofile</b> tool to generate the descriptive statistics value (<b>Mean</b>, <b>SD</b>, <b>Min</b>, <b>Max</b>, <b>Median</b>, <b>Sum</b>, <b>XY of Min</b> and <b>XY of Max</b>) for the ROI. The <b>Intensity Profile</b> dialog gets a <b>Weighted ROI</b> check box. When this option is selected, each pixel is weighted by the area of the intersection of the pixel rectangle and the ROI polygon. This is to improve results when the ROI coordinates do not fully cover a pixel.
</p><p>For example, after add a shapefiles dataset as the ROI (<a href="../../UserGuide/UserGuide/NetCDF_Manipulating.html#Create_ROI_from_XY" title="UserGuide:NetCDF Manipulating"><b>Create ROI from XY</b></a> tool), you can use use Intensity Profile tool to analysis the ROI dataset.
</p>
<dl><dd><a  class="image"><img alt="NetCDF Intensity Profile.gif" src="../images/NetCDF_Manipulating/NetCDF_Intensity_Profile.gif?v=89293" width="852"  /></a></dd></dl>
<p><br />
Refer to the X-Function <a class="external text" href="../../XFunction/X-Function/Mroiprofile.html">Mroiprofile</a> to know more about this dialog.
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/NetCDF_Manipulating/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>There can be a speed issue when there are many ROIs, <b>Profile on</b> = <b>All ROIs on Matrix</b> and <b>Data Layout</b> = <b>Matrix Rowwise</b>. The slowness is caused by maintaining output columns of Report Data. In such cases, if the original output has number of columns greater than <a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#R%7C"><b>@RDRC</b></a>, output will simply remove all original columns. However, it should be noted that removing all output columns will also cause plots made from output, to be destroyed.
</p></td></tr></table>
<h4><a name="Clear_Data_in_ROI"></a><span class="mw-headline">Clear Data in ROI</span></h4>
<p>Add ROI on the matrix, right-click on the ROI and select <b>Clear</b>.
</p>
<dl><dd><a  class="image"><img alt="NetCDF Clear ROI Data.png" src="../images/NetCDF_Manipulating/NetCDF_Clear_ROI_Data.png?v=90073" width="222"  /></a></dd></dl>
<p><br />
</p>
<h4><a name="Across_Multiple_Matrix_Sheets"></a><span class="mw-headline">Across Multiple Matrix Sheets</span></h4>
<p>For the 4D matrix book matrix book (the 4th dimension is sheets), the single ROI will be displayed across matrix sheets.  And the ROI will be displayed on the active sheet.
</p><p>For this ROI, it also supports <a href="#Create_New"><b>Create New</b></a>, <a href="#Extract_as_XYZ"><b>Extract XYZ</b></a> and <a href="#Intensity_Profile"><b>Intensity Profile</b></a> tool. And it will generate the active matrix sheet’s result. Switching sheets, the result will update for the active sheet.
</p>
<dl><dd><a  class="image"><img alt="NetCDF ROI Across Multiple Matrix Sheets.gif" src="../images/NetCDF_Manipulating/NetCDF_ROI_Across_Multiple_Matrix_Sheets.gif?v=94082" width="852"  /></a></dd></dl>


