<h1 class="firstHeading">24.1 Attaching Files to the Origin Project</h1><p class='urlname' style='display: none'>FileShare-Append-to-OPJ</p>
<p>Use <b>Code Builder</b> to attach or retrieve third-party files stored with the Origin project file. 
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Attaching_files_to_the_OPJ"><span class="tocnumber">1</span> <span class="toctext">Attaching files to the OPJ</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Locating_and_opening_attached_third-party_files"><span class="tocnumber">2</span> <span class="toctext">Locating and opening attached third-party files</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Special_Handling_of_Origin_C_and_OGS_files"><span class="tocnumber">3</span> <span class="toctext">Special Handling of Origin C and OGS files</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#How_attached_third-party_files_are_handled_when_appending_OPJ_files"><span class="tocnumber">4</span> <span class="toctext">How attached third-party files are handled when appending OPJ files</span></a></li>
</ul>
</div>

<h2><a name="Attaching_files_to_the_OPJ"></a><span class="mw-headline">Attaching files to the OPJ</span></h2>
<p>To attach files to the OPJ:
</p>
<ol><li>Click the <b>Code Builder </b> <a  class="image"><img alt="Button Code Builder.png" src="../images/Attaching_Files_to_the_Origin_Project/Button_Code_Builder.png?v=1726" width="23"  /></a>button on the Standard toolbar.</li>
<li>Right-click on the <b>Project</b> subfolder in the Origin C Workspace tree and choose <b>Add Files</b>.
<dl><dd><a  class="image"><img alt="Attaching Files to the Origin Project-1.png" src="../images/Attaching_Files_to_the_Origin_Project/Attaching_Files_to_the_Origin_Project-1.png?v=12458" width="212"  /></a></dd></dl></li>
<li>Browse to and select the file(s) that you want to attach to the OPJ file (Note that you can also drag-and-drop files from the <b>User</b> and <b>Temp</b> folders to the <b>Project</b> folder). </li>
<li>When you save the Origin project file, all files in the <b>Project</b> folder are appended and saved inside the OPJ.  The Project folder tracks with the OPJ;  the contents of this folder do not change when you change your workspace in Code Builder.</li></ol>
<h2><a name="Locating_and_opening_attached_third-party_files"></a><span class="mw-headline">Locating and opening attached third-party files</span></h2>
<p>When you open an OPJ file to which files have been attached, support files are extracted and stored in a temporary subfolder.  
</p><p>To show the path to that subfolder and open the files:
</p>
<ol><li>Right-click on the <b>Project</b> folder in Origin C Workspace tree, and select <b>Show Full Path</b>.</li>
<li>The attached files can be opened by double-clicking on the file name:</li></ol>
<ul><li>If the file type is recognized by Code Builder (Origin C and OGS files are specially handled), these files are opened in new windows in the Code Builder Multiple Document Interface (MDI).</li>
<li>If the file type is not recognized by Code Builder, Origin passes the file to the Windows OS for opening.  For instance, if a Microsoft Word file were attached and you were to double-click on this file, the file would open in the Microsoft Word application.</li></ul>
<p>Alternately, you could navigate to the temporary subfolder and launch the file through Windows Explorer.  Note that when the project is closed, this subfolder is removed from the system.
</p>
<h2><a name="Special_Handling_of_Origin_C_and_OGS_files"></a><span class="mw-headline">Special Handling of Origin C and OGS files</span></h2>
<p>Special handling of OC and OGS files makes it possible to attach custom code to OPJ files and create custom solutions that are easily delivered to other Origin users.
</p><p>Origin C files that are attached to the project are compiled and loaded when the project to which they are attached is opened.  All functions defined in the OC files are accessible to the user from the Origin interface, upon project opening. 
</p><p>With OGS files, you can access script sections in the attached OPJ from the interface when the project is open.  For example, if you had attached a file named MyScripts.OGS, once the OPJ file was opened, you could issue this command in the Script Window:
</p>
<pre class="lt" style="font-family:monospace;">Run.<span style="color: #000080;">section</span><span style="color: #000000;">&#40;</span>MyScripts, MySection<span style="color: #000000;">&#41;</span>;</pre>
<p>Origin will look to see whether there is a file called MyScripts.OGS that is attached to the open OPJ, then will look to see if MySection exists within the OGS file.  If found, this section is run.  If no such attached file is found, Origin searches your User Files folder, then finally the EXE path for the named OGS file. 
</p>
<h2><a name="How_attached_third-party_files_are_handled_when_appending_OPJ_files"></a><span class="mw-headline">How attached third-party files are handled when appending OPJ files</span></h2>
<p>You can append an Origin project file to the open project file.  This adds the contents of the appended project to the current project.  When appending projects, Origin handles attached third-party files in this way:
</p>
<ul><li>If a third-party file of the same name is not attached to the open project, the third-party file is attached to the open project.</li>
<li>If a third-party file of the same name is attached to the open project, the file contents are compared.  If the contents are identical, the second third-party file is discarded.  </li>
<li>If attached file names are the same but the file contents differ, the filename of the second file is enumerated (e.g. "TestData.txt" becomes "TestData1.txt"), and the file is attached.</li></ul>






