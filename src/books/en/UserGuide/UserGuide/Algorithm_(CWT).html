<h1 class="firstHeading">18.12.1.2 Algorithms (Continuous Wavelet Transform)</h1><p class='urlname' style='display: none'>CWT-Algorithm</p>
<p><br />
</p>
<h2><a name="Continuous_Wavelet_Transform"></a><span class="mw-headline">Continuous Wavelet Transform</span></h2>
<p>This function computes the real continuous wavelet coefficient for each given scale presented in the <b>Scale</b> vector and each position <i>b</i> from 1 to n, where n is the size of the input signal. 
</p><p>Let <i>x(t)</i> be the input signal and <i>Ïˆ </i>be the chosen wavelet function, the continuous wavelet coefficient of <i>x(t)</i> at scale <i>a</i> and position <i>b</i> is: 
</p><p><img src="../images/Algorithm_(CWT)/math-72d1f6f4f05fad5f118b188e9bf031e6.png?v=0" title="C_{a,b}  = \int_R {x(t)\frac{1}{{\sqrt a }}\psi^* } (\frac{{t - b}}{a})dt" alt="C_{a,b}  = \int_R {x(t)\frac{1}{{\sqrt a }}\psi^* } (\frac{{t - b}}{a})dt" class="tex"/>
</p><p>The computation is implemented with a NAG function: nag_cwt_real(). It does not compute the coefficients with the definition of CWT. Instead, the integrals of the scaled, shifted wavelet function are approximated and the convolution is then computed.
</p>
<h2><a name="Origin_Wavelet_Types"></a><span class="mw-headline">Origin Wavelet Types</span></h2>
<ul><li><b>Morlet</b>
<dl><dd>The Morlet wavelet:</dd>
<dd><img src="../images/Algorithm_(CWT)/math-b808488aa445ffa6f9550ca3d68ffed7.png?v=0" title="\psi (x) = \pi ^{ - 1/4} \cos (kx)e^{ - x^2 /2}" alt="\psi (x) = \pi ^{ - 1/4} \cos (kx)e^{ - x^2 /2}" class="tex"/></dd>
<dd>where k is the wave number. </dd></dl></li>
<li><b>DGauss</b>
<dl><dd>The Derivative of a Gaussian wavelet, which is the pth derivative of the Gaussian function: </dd>
<dd><img src="../images/Algorithm_(CWT)/math-da60ed4f7040c20521ad2525e076c885.png?v=0" title="\psi (x) = (\frac{2}{\pi })^{ - 1/4} e^{ - x^2 }" alt="\psi (x) = (\frac{2}{\pi })^{ - 1/4} e^{ - x^2 }" class="tex"/></dd>
<dd>where p is the derivative order. </dd></dl></li>
<li><b>MexHat</b>
<dl><dd>The Mexican Hat Wavelet:</dd>
<dd><img src="../images/Algorithm_(CWT)/math-d1b98fb2e9ab52f906934f1256ab2b97.png?v=0" title="\psi (x) = \frac{2}{{\sqrt 3 }}\pi ^{ - 1/4} (1 - x^2 )e^{ - x^2 /2} " alt="\psi (x) = \frac{2}{{\sqrt 3 }}\pi ^{ - 1/4} (1 - x^2 )e^{ - x^2 /2} " class="tex"/></dd></dl></li></ul>
<h2><a name="Convert_Scale_to_Pseudo_Frequency"></a><span class="mw-headline">Convert Scale to Pseudo Frequency</span></h2>
<p>For a given wavelet, you can map a scale and convert to  pseudo-frequency by ways below:
</p><p><img src="../images/Algorithm_(CWT)/math-ede1a5d47afd1afaf5aa17f8a17954e5.png?v=0" title="F_a=\frac{F_c}{s\cdot \Delta }" alt="F_a=\frac{F_c}{s\cdot \Delta }" class="tex"/> 
</p><p>In this formula:
</p>
<ul><li>s is a scale.</li>
<li><img src="../images/Algorithm_(CWT)/math-967878d1da852d4b07a961e3168b0fff.png?v=0" title="\Delta" alt="\Delta" class="tex"/> is the sampling period.</li>
<li><img src="../images/Algorithm_(CWT)/math-0dce40d4e6911723f6409624cd67707b.png?v=0" title="F_c" alt="F_c" class="tex"/> is the center frequency of a wavelet in Hz.</li>
<li><img src="../images/Algorithm_(CWT)/math-f705c4aa988b41136eb668bf50a6c5af.png?v=0" title="F_a" alt="F_a" class="tex"/> is the pseudo-frequency corresponding to the scale a, in Hz.</li></ul>
<p>The <img src="../images/Algorithm_(CWT)/math-0dce40d4e6911723f6409624cd67707b.png?v=0" title="F_c" alt="F_c" class="tex"/> is the frequency contributes most to the variability of the wavelet, and it can be derived from maximizing the FFT of the wavelet modulus.
</p><p><a  class="image"><img alt="CWTFreq.png" src="../images/Algorithm_(CWT)/CWTFreq.png?v=46870" width="599"  /></a>
</p>





