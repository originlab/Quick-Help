<h1 class="firstHeading">8.10.3 Creating 3D and Contour Graphs from Virtual Matrix</h1><p class='urlname' style='display: none'>Plot-3D-Contour-VirtMat</p>
<p><br />
</p>
<div style="text-align: left; direction: ltr; margin-left: 1em;"><p><a  class="image"><img alt="Video Image.png" src="../images/Creating_3D_and_Contour_Graphs_from_Virtual_Matrix/Video_Image.png?v=29468" width="33"  /></a> See more related video:<a class="external text" href="http://www.originlab.com/index.aspx?go=Products/Origin/DataManagement/WorkbooksAndWorksheets&amp;ss=chm&amp;pid=1721" target="_blank">Creating Intersecting Surfaces Plots from Worksheets and Setting Transparency</a>
</p></div>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#What_is_a_Virtual_Matrix.3F"><span class="tocnumber">1</span> <span class="toctext">What is a Virtual Matrix?</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Available_3D_and_Contour_Graph_Types_that_can_be_Created_from_Virtual_Matrices"><span class="tocnumber">2</span> <span class="toctext">Available 3D and Contour Graph Types that can be Created from Virtual Matrices</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#How_to_Create_3D_and_Contour_Graphs_from_a_Virtual_Matrix"><span class="tocnumber">3</span> <span class="toctext">How to Create 3D and Contour Graphs from a Virtual Matrix</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Dialog_Controls_of_the_plotvm_Dialog"><span class="tocnumber">4</span> <span class="toctext">Dialog Controls of the <i>plotvm</i> Dialog</span></a></li>
</ul>
</div>

<h2><a name="What_is_a_Virtual_Matrix.3F"></a><span class="mw-headline">What is a Virtual Matrix?</span></h2>
<p>When looking to create a <b>contour plot</b> or <b>3D surface plot</b> in Origin, there are three basic data arrangements that can be used: <b>XYZ worksheet columns</b>, a <b>matrix</b> of Z values, or what we call a <b>Virtual Matrix</b>. Unlike the regular matrix, the Virtual Matrix supports uneven-spacing of X and Y values as long as they are sorted.
</p><p>The Virtual Matrix typically starts from a worksheet that is arranged (1) with a row of Y coordinate values along the top of the worksheet and (2) column of X coordinate values in the first column of the worksheet (or <i>vice versa</i>), plus a 2D array of "Z" values in a block defined by the intersections of all X and Y coordinate pairs. 
</p><p>X or Y coordinate values may be in the first row or column of the data portion of the worksheet; they may be stored in the column label row area of the worksheet; or they may be in another portion of the worksheet that you define using, for instance, the interactive <b>X Range</b> or <b>Y Range</b> selection control.
</p>
<dl><dd><a  class="image"><img alt="VM Worksheet Small.png" src="../images/Creating_3D_and_Contour_Graphs_from_Virtual_Matrix/400px-VM_Worksheet_Small.png?v=83115" width="400"   /></a></dd></dl>
<p><br />
If you have imported data from MS Excel or perhaps have imported an ASCII file that was instrument-generated, and your data arrangement resembles that in the worksheet above, it may be in a form that can be used in creating a Virtual Matrix.
</p>
<ul><li> <b>Data Layout</b>: Y data across columns or X (data across columns).</li>
<li> <b>X Values</b>/<b>Y Values</b> in <b>1st row in selection</b> or <b>1st column in selection</b>, in <b>column label row</b> or by <b>interactive range selection</b>.</li></ul>
<dl><dd><a  class="image"><img alt="Data selection virtual matrix.png" src="../images/Creating_3D_and_Contour_Graphs_from_Virtual_Matrix/Data_selection_virtual_matrix.png?v=95928" width="871"  /></a></dd></dl>
<h2><a name="Available_3D_and_Contour_Graph_Types_that_can_be_Created_from_Virtual_Matrices"></a><span class="mw-headline">Available 3D and Contour Graph Types that can be Created from Virtual Matrices</span></h2>
<p>The following are all the graph types that can be created from a Virtual Matrix.
</p>
<ul><li> 3D Color Fill Surface</li>
<li> 3D X constant with Base</li>
<li> 3D Y constant with Base</li>
<li> 3D Color Map Surface (and Color Map Surface with Projection)</li>
<li> Gray Scale Map 3D Scatter</li>
<li> 3D Wire Frame</li>
<li> 3D Wire Surface</li>
<li> Matrix 3D Bars</li>
<li> Contour â€“ Color Fill</li>
<li> Contour B/W lines</li>
<li> Heatmap</li></ul>
<h2><a name="How_to_Create_3D_and_Contour_Graphs_from_a_Virtual_Matrix"></a><span class="mw-headline">How to Create 3D and Contour Graphs from a Virtual Matrix</span></h2>
<p>To create contour or 3D plot from a Virtual Matrix:
</p>
<ol><li> Select the worksheet or a range of worksheet cells, then click the <b>Plot</b> menu to <a href="#Available_3D_and_Contour_Graph_Types_that_can_be_Created_from_Virtual_Matrices">select your 3D graph type</a>.</li>
<li> In the <a href="#Dialog_Controls_of_the_plotvm_Dialog"><b>plotvm Dialog</b></a> that opens, specify how your worksheet data are to be treated when converting to a Virtual Matrix.</li></ol>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Creating_3D_and_Contour_Graphs_from_Virtual_Matrix/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>See the tutorial <a class="external text" href="../../Tutorial/Tutorial/Creating_Intersecting_Surface_Plots_from_Worksheets.html">Creating Intersecting Surface Plots from Worksheets</a> for step-by-step instructions on creating 3D graphs from Virtual Matrices.
</p></td></tr></table>
<h2><a name="Dialog_Controls_of_the_plotvm_Dialog"></a><span class="mw-headline">Dialog Controls of the <i>plotvm</i> Dialog</span></h2>
<table class="dialogcontroltable">

<tr>
<th><b>Input</b>
</th>
<td>Specify the Z-values for plotting a 3D or Contour graph. You can select an existing virtual matrix as input from fly-out menu or Virtual Matrix Manager.
<p><b>Note</b>: if you select a whole worksheet, the virtual matrix will be dynamic updated when you add or delete columns/rows in the source worksheet. If you select a worksheet cell block from a certain column/row to the end column, for example from 5th column to end, and want the virtual matrix be dynamic updated, right click on the triangle button to the right of <b>Input</b> and select <b>Dynamic Ends</b>. 
</p>
</td></tr>
<tr>
<th>Data Layout
</th>
<td>Specify which way to set the X- and Y-values for the graph.  Available options include:
<ul><li><b>Y across columns</b> 
<dl><dd>Use the values in a row as the Y-values and the values in a column as the X-values. </dd></dl></li>
<li><b>X across columns</b> 
<dl><dd>Use the values in a row as the X-values and the values in a column as the Y-values. </dd></dl></li></ul>
</td></tr>
<tr>
<th>Y Values in / X Values in
</th>
<td>The two drop-down lists are used to specify the X and Y data range when creating virtual matrix. The sequence of these two changes dynamically depending on the selection of <b>Data Layout</b>, and the upper one is used to specify a row, while the lower one is used to specify a column. The available options are as below:
<ul><li><b>None</b>
<dl><dd> Use row index or column index. </dd></dl></li>
<li><b>1st row/column in selection</b>
<dl><dd> Use the values of the first row/column in the current selection.</dd></dl></li>
<li><b>1st row/column in worksheet</b>
<dl><dd> Use the values of the first row/column in the current worksheet. </dd></dl></li>
<li><b>Column label</b>
<dl><dd> This is only available when a row is to specified. Uses the values of the column labels in the worksheet. It will allow you to select a column label row from the <b>Column Label</b> drop-down list. Please note that if only a range of the worksheet has been selected as <b>Input</b> data, then this tool will automatically use the corresponding part of the column label values. </dd></dl></li>
<li><b>Custom</b>
<dl><dd> Use this option to allow manual selection of data with the <b>X Range</b> (or <b>Y Range</b>) box. Please note the X(or Y)-values can only be selected from the same worksheet. </dd></dl></li></ul>
</td></tr>
<tr>
<th><b>Format Y Data</b> / <b>Format X Data</b>
</th>
<td>Specify the data format of the Y/X data as <b>Numeric</b> (default), <b>Text</b>, <b>Time</b> or <b>Date</b>. Select this checkbox and click the <b>...</b> button on the right of the text box to open the <b>Format Data</b> dialog, and select <b>Format</b> and <b>Display</b> to be applied to the Y/X data.
<p>When <b>Y Values in</b>/<b>X Values in</b> is set to None, this check box will be disabled. 
</p>
</td></tr>
<tr>
<th><b>X Title</b> / <b>Y Title</b> / <b>Z Title</b>
</th>
<td>Specify the axis title for X Y or Z axis, respectively.  Uncheck the check box at the end of the control, you can click the arrow button to select the source sheet information as title from the fly-out list.
<p>Selecting any item from the fly-out list will insert the <a class="external text" href="../../LabTalk/LabTalk/Syntax_and_notations_used_in_plot_label.html">corresponding notaion</a> into the box; the actual titles will be shown under the controls as a blue hint:
</p>
<ul><li> <b>LG: Long Name and Units</b>: Selecting it will insert the notaion&#160;%(%@H, 1, LG)</li>
<li> <b>L: Long Name</b>: Selecting it will insert the notaion&#160;%(%@H, 1, L)</li>
<li> <b>U: Units</b>:Selecting it will insert the notaion&#160;%(%@H, 1, U)</li>
<li> <b>C: Comments</b>:Selecting it will insert the notaion&#160;%(%@H, 1, C)</li>
<li> <b>P1: First Parameter</b>:Selecting it will insert the notaion&#160;%(%@H, 1, P1)</li>
<li> <b>D1: First User Parameter</b>:Selecting it will insert the notaion&#160;%(%@H, 1, D1)</li>
<li> <b>LH1: First User Parameter Name</b>: Selecting it will insert the notaion&#160;%(%@H, @LH1)</li>
<li> <b>SN: Sheet Name</b>: Selecting it will insert the notaion&#160;%(%@H, @SN)</li>
<li> <b>PNL: Book Long Name</b>: Selecting it will insert the notaion&#160;%(%@H, @PNL)</li>
<li> <b>Select from Worksheet</b>: Selecting it will open a dialog to let you click a cell in the worksheet. The notation for selected cell will show. For example, if you select a cell(1st column, 3rd row) in source sheet of VM, the notation is&#160;%(%@H, 1, 3); if you select a cell that is not in source sheet, we create&#160;%([Book1]Sheet1, 1, 3, W) just like <a href="../../UserGuide/UserGuide/The_Insert_Info_Variables_Dialog_Box.html" title="UserGuide:The Insert Info Variables Dialog Box">the Insert Variables dialog</a>.</li></ul>
</td></tr>
<tr>
<th><b>Virtual Matrix Name </b>
</th>
<td>Specify the short name of virtual matrix object to be created. All virtual matrices created during plotting will be listed and managed in <a href="../../UserGuide/UserGuide/Managing_Virtual_Matrix.html" title="UserGuide:Managing Virtual Matrix">Virtual Matrix Manager</a>.
</td></tr></table>


