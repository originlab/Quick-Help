<h1 class="firstHeading">9.3.2 Using a Dataset to Control Plot Color</h1><p class='urlname' style='display: none'>PlotColor-DatasetControl</p>
<p><br />
You can use a column of values in an Origin worksheet (or Excel workbook) to control data plot colors for plots of data from the same worksheet or workbook:
</p>
<ul><li> Any one of up to 155 columns on either side of the plotted data can be designated as the color control dataset. </li>
<li> If the source worksheet has more than 155 columns to the right of Y dataset, columns up to 155 can be listed as color control columns, starting from (and including) the values in plotted Y column. </li>
<li> If the worksheet has fewer than 155 columns to the right of the Y dataset, then columns located both at left and right sides of Y dataset can be used. </li></ul>
<p>Setting color control by dataset is done via a data plot element's color button (for example, the <b>Symbol Color</b> button in the Plot Details dialog box). 
</p><p><a  class="image"><img alt="Dataset Color Control.png" src="../images/Using_a_Dataset_to_Control_Plot_Color/Dataset_Color_Control.png?v=80992" width="448"  /></a>
</p><p>There are several types of dataset color control, available from <a href="../../UserGuide/UserGuide/Customizing_Data_Plot_Colors.html#Opening_the_Color_Chooser" title="UserGuide:Customizing Data Plot Colors">the <b>By Points</b> tab of the <b>Color Chooser</b></a>. The first three modes are available for general graph types, the remainder are reserved for specific graph types. 
</p>
<ul><li> <b>Indexing</b>: This option uses a dataset of integers or text strings that are indexed to colors in a specific <b>Color List</b>.</li>
<li> <b>Direct RGB</b>: This option uses a dataset of RGB composite values, each calculated from a separate R,G and B value. </li>
<li> <b>Color Mapping</b>: This option uses a dataset of real numbers that are binned and the customizable bin ranges are mapped to a customizable list of colors.</li>
<li> <b>Density Color Mapping</b>. Used only with the <a href="../../UserGuide/UserGuide/Customizing_Data_Plot_Colors.html#Using_Column_Values_to_Apply_Color_By_Points" title="UserGuide:Customizing Data Plot Colors">Density Dots</a> scatter template.</li>
<li><b>Y Value: Color Mapping</b>: When there are multiple Y data plots in a graph,  this option set the colormap based on Y value respective, and with the same the colormap level and fill setting.</li>
<li> <b>Y Value: Plus-Minus-Total</b>: This option fills columns/bars with different colors according to the condition that if the corresponding Y value is Positive, Negative or Total. (Only available for <a href="../../UserGuide/UserGuide/Bridge_Chart.html" title="UserGuide:Bridge Chart">Bridge Chart</a>)</li></ul>
<p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Indexing"><span class="tocnumber">1</span> <span class="toctext">Indexing</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Direct_RGB"><span class="tocnumber">2</span> <span class="toctext">Direct RGB</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Color_Mapping"><span class="tocnumber">3</span> <span class="toctext">Color Mapping</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Y_Value:_Color_Mapping"><span class="tocnumber">4</span> <span class="toctext">Y Value: Color Mapping</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Y_Value:_Plus-Minus-Total"><span class="tocnumber">5</span> <span class="toctext">Y Value: Plus-Minus-Total</span></a></li>
</ul>
</div>

<h2><a name="Indexing"></a><span class="mw-headline">Indexing</span></h2>
<p>This option uses a dataset of integers or <a href="../../UserGuide/UserGuide/Displaying_Supporting_Data_in_Worksheet_Header_Rows.html#Categories" title="UserGuide:Displaying Supporting Data in Worksheet Header Rows">categorical values</a> that are indexed to colors in a specific Color List.  
</p><p><b>To use this option:</b>
</p>
<ol><li>Double-click on the data plot that you wish to modify.  This opens the <b>Plot Details</b> dialog box.</li>
<li>Select the <b>Symbol</b> tab, <b>Pattern</b> tab, etc.</li>
<li>Click the <b>Symbol Color</b> button, <b>Fill Color</b> button, etc. When the Color Chooser opens, go to the <b>By Points</b> tab and select <b>Indexing</b>: <i><b>Dataset</b></i> (<i><b>Dataset</b></i> being the name of the column that stores the color control data).</li>
<li> Click <b>Apply</b>.</li></ol>
<p><a  class="image"><img alt="Indexing Color ByPoints.png" src="../images/Using_a_Dataset_to_Control_Plot_Color/Indexing_Color_ByPoints.png?v=80993" width="446"  /></a>
</p>
<table class="note">
<tr>
<td>
<p><b>Note:</b> The column <b>Format</b> of the indexing column must be either<b> Numeric</b> or <b>Text &amp; Numeric</b> and the column should contain integers or, in the case of categorical data, strings corresponding to categories. Any numbers to the right of a decimal point will be dropped.
</p>
</td></tr></table>
<p><br />
<b>To customize index colors:</b>
<br />
<br />
Prior to Origin 2019, indexing to a column of worksheet values added a <b>Color List</b> tab to Plot Details and it was on this tab that you could customize the color list. Beginning with Origin 2019, you customize the color  list in this way:
</p>
<ol><li> Click the element's color button (e.g. for symbol = <b>Symbol Color</b>).</li>
<li> Click on the pencil icon <a  class="image"><img alt="Button edit pencil.png" src="../images/Using_a_Dataset_to_Control_Plot_Color/Button_edit_pencil.png?v=81176" width="22"  /></a> to the right-side of the current <b>Color List</b>.</li>
<li> Follow these procedures for <a href="../../UserGuide/UserGuide/Customizing_Data_Plot_Colors.html" title="UserGuide:Customizing Data Plot Colors">loading, modifying and saving your color lists</a>.</li></ol>
<h2><a name="Direct_RGB"></a><span class="mw-headline">Direct RGB</span></h2>
<p>To apply RGB colors to your Origin plots, you must generate an <b>RGB composite</b> value. The RGB composite value is calculated from:
</p>
<ul><li> Worksheet columns containing triplet components of <b>R</b>ed, <b>G</b>reen, and <b>B</b>lue. The <b>R</b>, <b>G</b>, and <b>B</b> component values range from 0 to 255 (e.g. (255,0,0)). </li>
<li> A Worksheet column of <b>HTML color</b> values (e.g. #FF0000).</li></ul>
<p><br />
<i><b>To Compute the RGB Composite:</b></i>
</p>
<ol><li> Use <a class="external text" href="../../LabTalk/LabTalk/Color_(function).html">the <b>color()</b> function</a>, in conjunction with the <a href="../../UserGuide/UserGuide/Quick_Start_SetColumnValues.html" title="UserGuide:Quick Start SetColumnValues"><b>Set Values</b></a> feature to calculate your composite values, as shown in the following image (note use of <a href="../../UserGuide/UserGuide/Quick_Start_SetColumnValues.html#Spreadsheet_Cell_Notation" title="UserGuide:Quick Start SetColumnValues">spreadsheet cell notation</a> in the <b>F(x)=</b> row, highlighted in yellow):</li></ol>
<dl><dd><a  class="image"><img alt="RGB using SCV.png" src="../images/Using_a_Dataset_to_Control_Plot_Color/RGB_using_SCV.png?v=73625" width="773"  /></a></dd></dl>
<p>Once you have a dataset of RGB composite values:
</p>
<ol><li>Double-click on the data plot that you wish to modify.  This opens the <span class="db">Plot Details</span> dialog box.</li>
<li>Select the <b>Symbol</b> tab, <b>Pattern</b> tab, etc.</li>
<li>Click the color button (e.g.<b>Edge Color</b>), click the <b>By Points</b> tab, then select <b>Direct RGB</b>: <i><b>Dataset</b></i>, where <i><b>Dataset</b></i> contains the RGB composite values.</li></ol>
<dl><dd><a  class="image"><img alt="RGB using color plot.png" src="../images/Using_a_Dataset_to_Control_Plot_Color/RGB_using_color_plot.png?v=81033" width="767"  /></a></dd></dl>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Using_a_Dataset_to_Control_Plot_Color/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>You can use the <a class="external text" href="../../LabTalk/LabTalk/Color_(function).html">color() function</a> to return a single RGB composite value in the Script Window or Command Window, using either HTML color codes or RGB triplets: 
</p>
<ol><li> Open the Command Window (<b>Window: Command Window</b>) or Script Window (<b>Window: Script Window</b>).</li>
<li> Enter your values in either form, as shown in the following examples, then press &lt;Enter&gt;:</li></ol>
<pre class="lt" style="font-family:monospace;">color<span style="color: #000000;">&#40;</span>#FF0000<span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>
color<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">255</span>,<span style="color: #0000dd;">0</span>,<span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span></pre>
<dl><dd>Origin returns:</dd></dl>
<pre class="lt" style="font-family:monospace;">color<span style="color: #000000;">&#40;</span>#FF0000<span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span><span style="color: #0000dd;">16777471</span>
color<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">255</span>,<span style="color: #0000dd;">0</span>,<span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span><span style="color: #0000dd;">16777471</span></pre>
</td></tr></table>
<h2><a name="Color_Mapping"></a><span class="mw-headline">Color Mapping</span></h2>
<p>With this option you create a mapping relationship between ranges of 2D Y values or 3D Z values and an associated scale of colors.  The 2D Y values or 3D Z values are then used to determine the color of the associated data point, based on the assigned color map. The Y or Z values are real numbers. 
</p>
<ol><li>Double-click on the data plot that you wish to modify.  This opens the <b>Plot Details</b> dialog box.</li>
<li>Select the <b>Symbol</b> tab, <b>Pattern</b> tab, etc.</li>
<li>Click the <b>Symbol Color</b> button, <b>Fill Color</b> button, etc. and on the <b>By Points</b> tab, select <b>Color Mapping:</b> and choose a color control dataset from the popup menu.  </li>
<li> Click the color button once again (e.g. <b>Symbol Color</b>), click on (1) <b>Color List</b> and  (2) click on the displayed color list, including one of several tint-and-shade variants shown below the color list or (3) click the drop-down next to the displayed color list and choose another color list.</li></ol>
<dl><dd><a  class="image"><img alt="Setting a Color List for Symbol.png" src="../images/Using_a_Dataset_to_Control_Plot_Color/Setting_a_Color_List_for_Symbol.png?v=87125" width="377"  /></a></dd></dl>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Using_a_Dataset_to_Control_Plot_Color/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>You can also apply a colormap and change color lists using controls on the plot-level <b>Mini Toolbar</b>. Select a plot and use the plot symbol's color control button (e.g. <b>Symbol Edge Color</b>) to access controls.
</p>
<dl><dd><a  class="image"><img alt="MT color mapping controls.png" src="../images/Using_a_Dataset_to_Control_Plot_Color/MT_color_mapping_controls.png?v=87131" width="394"  /></a></dd></dl>
</td></tr></table>
<p><br />
<i><b>An Exampleï¼š</b></i>
</p>
<ol><li>Start with a new project or a new workbook. Import the data file &lt;Origin Program Folder&gt;\Samples\Graphing\Template.dat by clicking <b>Import Single ASCII</b> <a  class="image"><img alt="Import Single ASCII.png" src="../images/Using_a_Dataset_to_Control_Plot_Color/Import_Single_ASCII.png?v=331" width="26"  /></a> on the Import toolbar.</li>
<li>Highlight column(A) and column(B),and then select <b>Plot &gt; Basic 2D: Scatter</b> to create the plot.
<dl><dd> <a  class="image"><img alt="Color Mapping 1.png" src="../images/Using_a_Dataset_to_Control_Plot_Color/Color_Mapping_1.png?v=25488" width="367"  /></a></dd></dl></li>
<li>Double-click on the data line in the above graph.  This opens the <b>Plot Details</b> dialog box.</li>
<li>Select the <b>Symbol</b> tab.</li>
<li>Click the <b>Symbol Color</b> button, go to <b>By Points</b> tab and select <b>Color Mapping:</b> <i><b>Col("SVep")</b></i>. </li></ol>
<dl><dd><dl><dd><a  class="image"><img alt="Color Mapping 2.png" src="../images/Using_a_Dataset_to_Control_Plot_Color/Color_Mapping_2.png?v=81035" width="437"  /></a></dd></dl></dd>
<dd>The graph should look like the picture below:
<dl><dd><a  class="image"><img alt="Color Mapping 3.png" src="../images/Using_a_Dataset_to_Control_Plot_Color/Color_Mapping_3.png?v=25491" width="367"  /></a></dd></dl></dd></dl>
<p>Origin automatically creates a color scale of 8 colors (and 8 equal scale increments) spanning the range of Y or Z values, then adds one color above and one below max/min values, to represent values outside the data range. Each data point is then mapped to the color scale.
</p><p>To simply change the color list, follow instructions at the beginning of this Color Mapping topic. If you wish to change other properties of the colormap -- number of levels, increment, etc. -- you can do so using controls on the <b>Colormap</b> tab of Plot Details:
</p>
<ol><li>Double-click on the plot to open Plot Details, then select the <b>Colormap</b> tab. Click on the <b>Level</b> or <b>Fill</b> column header to assign custom Y or Z value ranges to associated colors.  </li>
<li>Select <b>Insert: Color Scale</b> to display a color scale and the associated dataset mapping relationship in the graph.</li></ol>
<table class="note">

<tr>
<td><b>Note</b>: Double-click on the scale to open the Color Scale Control dialog box and modify the scale. For more information, see <a href="../../UserGuide/UserGuide/Color_Scales.html" title="UserGuide:Color Scales">Color Scales</a>.
</td></tr></table>
<h2><a name="Y_Value:_Color_Mapping"></a><span class="mw-headline">Y Value: Color Mapping</span></h2>
<p>This option is only available for the 2D Group plot with Dependent edit mode. When there are multiple Y data plots in a graph, you can use this option to set the colormap based on Y value respective,  and with the same the colormap level and fill setting.
</p><p><b>An example</b>
</p>
<ol>
<li>Start with a new project or a new workbook. Import the data file  \Samples\Curve Fitting\Composite Spectrum.dat by using "Import Single ASCII" button, <a  class="image"><img alt="Import Single ASCII.png" src="../images/Using_a_Dataset_to_Control_Plot_Color/Import_Single_ASCII.png?v=331" width="26"  /></a></li>
<li>Highlight all columns, and then select <b>Plot: Basic 2D: Stacked Lines by Y Offsets</b> to create the plot.</li>
<p><a  class="image"><img alt="Y Value Color Mapping 1.png" src="../images/Using_a_Dataset_to_Control_Plot_Color/Y_Value_Color_Mapping_1.png?v=80661" width="382"  /></a>
</p>
<li>Select <b>Format: Plot...</b> to opens the <b>Plot Details</b> dialog.</li>
<li>Select the <b>Line</b> tab. </li>
<li>Click the <b>Color</b> button, go to <b>By Points</b> tab and select <b> Y Value: Color Mapping</b></li>
<p><a  class="image"><img alt="Y Value Color Mapping 2.png" src="../images/Using_a_Dataset_to_Control_Plot_Color/Y_Value_Color_Mapping_2.png?v=81036" width="714"  /></a>
</p>
<li>Go to <b>Colormap</b> tab. Set colormap as the image below:</li>
<p><a  class="image"><img alt="Y Value Color Mapping 3.png" src="../images/Using_a_Dataset_to_Control_Plot_Color/Y_Value_Color_Mapping_3.png?v=82415" width="650"  /></a>
</p>
<li>Finally, if you wish to add a color scale to the graph, click the <b>Color Scale</b> button <a  class="image"><img alt="Colorscale.png" src="../images/Using_a_Dataset_to_Control_Plot_Color/Colorscale.png?v=5905" width="24"  /></a> on the <b>Add Object to Graph</b> toolbar.</li>
<p><a  class="image"><img alt="Y Value Color Mapping 4.png" src="../images/Using_a_Dataset_to_Control_Plot_Color/Y_Value_Color_Mapping_4.png?v=82417" width="431"  /></a>
</p>
</ol>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Using_a_Dataset_to_Control_Plot_Color/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>A color scale is the default legend type for a color-mapped plot but you can add an independent color scale to any plot. For more information, see <a href="../../UserGuide/UserGuide/Color_Scales.html#Adding_an_independent_color_scale" title="UserGuide:Color Scales"><b>Adding an independent color scale</b></a>.
</p></td></tr></table>
<h2><a name="Y_Value:_Plus-Minus-Total"></a><span class="mw-headline">Y Value: Plus-Minus-Total</span></h2>
<p>This option is only available for the Bridge chart (also call McKinsey-style waterfall plot). The Bridge chart is a special column/bar plot with <b>Enable Brigde Chart</b> selected on <b>Bridge Chart</b> tab in layer level. 
</p><p>This option is accessible from Fill Color/Pattern Color drop-down list on <a href="../../UserGuide/UserGuide/The_(Plot_Details)_Pattern_Tab.html#Color" title="UserGuide:The (Plot Details) Pattern Tab">Pattern tab</a> of <b>Plot Details</b> dialog. It fills columns/bars with different colors according to the condition that if the corresponding Y value is Positive, Negative or Total. The Total can be set in <b>Data Indices for Total/Subtotal</b> option on <b>Bridge Chart</b> tab. 
</p><p><a  class="image"><img alt="Y Value Plus Minus Total 1.png" src="../images/Using_a_Dataset_to_Control_Plot_Color/Y_Value_Plus_Minus_Total_1.png?v=81037" width="737"  /></a>
</p><p>You can see the fill color sequence in Color List at the bottom. Note that only the first 3 colors will be used for <b>Y Value: Plus-Minus-Total</b> option: The 1st color in the list will be assigned to Positive Y, the 2nd color to Negative Y, and the 3rd to Total. 
</p><p>You can modify the color list by Ctrl+Clicking the Color List bar to open  <a href="../../UserGuide/UserGuide/Customizing_Data_Plot_Colors.html#The_Increment_Editor" title="UserGuide:Customizing Data Plot Colors">the <b>Increment Editor</b></a>.
</p>

