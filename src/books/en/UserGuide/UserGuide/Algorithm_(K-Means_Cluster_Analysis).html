<h1 class="firstHeading">17.7.3.6 Algorithms (K-Means Cluster Analysis)</h1><p class='urlname' style='display: none'>KCA-Algorithm</p>
<p><br />
<b>K-Means Cluster Analysis</b> uses minimum sum of squares to assign observations to groups.
</p><p>An observation containing one or more missing values will be excluded before <b>K-Means Cluster Analysis</b>.
</p><p>For a matrix <i>X</i> with <i>n</i> observations by <i>p</i> variables, initial cluster centers can be specified with a <i>K</i>-by-<i>p</i> matrix, or chosen from the matrix <i>X</i> with a predefined number of clusters.
</p>
<ul><li> Select Initial Cluster Centers from Observations
<ol><li> The first <i>K</i> observations are assigned as cluster centers.</li>
<li> Loop each remaining observation to see whether it can replace current cluster centers.</li></ol></li></ul>
<dl><dd><dl><dd><dl><dd> If the distance between the observation and its closest cluster center is greater than the distance between the two closest cluster centers(Cluster <i>i</i> and Cluster <i>j</i>), then the observation will replace the cluster center of Cluster <i>i</i> or <i>j</i> depending on which one is closer to the observation.</dd>
<dd> Otherwise if the distance between the observation and the second closest cluster center is greater than the closest distance between the closest cluster center and other cluster centers, then the observation will replace the closest cluster center.</dd></dl></dd></dl></dd></dl>
<ul><li> Allocate Observations to the Closest Cluster</li></ul>
<dl><dd> Each observation is allocated to the closest cluster, and the distance between an observation and a cluster is calculated from the <b>Euclidean</b> distance between the observation and the cluster center.</dd></dl>
<dl><dd> If the <i>i</i>th observation is allocated to the <i>k</i>th cluster, then the distance between the observation and the <i>k</i>th cluster is corrected as <img src="../images/Algorithm_(K-Means_Cluster_Analysis)/math-cedef1aea230e2899f28ff3b14ff48b2.png?v=0" title="\bar{d}_{ik}=n_k/(n_k-1)d_{ik}" alt="\bar{d}_{ik}=n_k/(n_k-1)d_{ik}" class="tex"/>, and the distance between the observation and other clusters is corrected as <img src="../images/Algorithm_(K-Means_Cluster_Analysis)/math-cc1852317b9341b92b6a403752aa9c12.png?v=0" title="\bar{d}_{ij}=n_j/(n_j+1)d_{ij}" alt="\bar{d}_{ij}=n_j/(n_j+1)d_{ij}" class="tex"/>, where <img src="../images/Algorithm_(K-Means_Cluster_Analysis)/math-fd91d2523217931bfcd6f684555f4d7f.png?v=0" title="n_k\ " alt="n_k\ " class="tex"/> and <img src="../images/Algorithm_(K-Means_Cluster_Analysis)/math-f898efd8ac64b6621a2aeed350ce3164.png?v=0" title="n_j\ " alt="n_j\ " class="tex"/> are the number of observations in the <i>k</i>th cluster and <i>j</i>th cluster. If the corrected distance between the observation and the <i>l</i>th cluster is minimum and <img src="../images/Algorithm_(K-Means_Cluster_Analysis)/math-cb7d6f01169691ad7f49df88fe07a026.png?v=0" title="l \ne k\ " alt="l \ne k\ " class="tex"/>, then the observation will be allocated to the <i>l</i>th cluster instead of the <i>k</i>th cluster.</dd></dl>
<dl><dd> Each cluster center will then be updated as the mean for observations in each cluster.</dd>
<dd>The within-cluster sum of squares is:
<dl><dd><img src="../images/Algorithm_(K-Means_Cluster_Analysis)/math-d70a8fe7cc57982f3b8f0d400ab1c27e.png?v=0" title="\sum_{k=1}^K \sum_{i\in S_k} \sum_{j=1}^{p} (x_{ij}-\bar{x}_{kj})^2" alt="\sum_{k=1}^K \sum_{i\in S_k} \sum_{j=1}^{p} (x_{ij}-\bar{x}_{kj})^2" class="tex"/></dd></dl></dd>
<dd>where <img src="../images/Algorithm_(K-Means_Cluster_Analysis)/math-0682d2d74c6ab43ef8f1268d2254691f.png?v=0" title="S_k\ " alt="S_k\ " class="tex"/> is the set of observations in the <i>k</i>th cluster and <img src="../images/Algorithm_(K-Means_Cluster_Analysis)/math-868a6eb27b3cae22a9d545f9c41d4d0b.png?v=0" title="\bar{x}_{kj}\ " alt="\bar{x}_{kj}\ " class="tex"/> is  the <i>j</i>th variable of the cluster center for the <i>k</i>th cluster.</dd></dl>
<dl><dd>Using updated cluster centers, repeat the process, allocate each observation, and update cluster centers. The iteration will stop when the maximum number of iterations is reached or the change of within-cluster sum of squares in two successive iterations is less than the threshold value. The updated cluster centers for the last iteration are called <b>Final Cluster Centers</b>.</dd></dl>
<dl><dd>Origin's default maximum number of iterations is 10.</dd></dl>
<ul><li> Distance from Cluster</li></ul>
<dl><dd> <b>Euclidean</b> distance is used to calculate the distance between the <i>i</i>th observation and the <i>k</i>th cluster.
<dl><dd> <img src="../images/Algorithm_(K-Means_Cluster_Analysis)/math-f8290cc4abbfcc45ce670e3143067d20.png?v=0" title="d_{ik}=\sqrt{\sum_{j=1}^{p} (x_{ij}-\bar{x}_{kj})^2}" alt="d_{ik}=\sqrt{\sum_{j=1}^{p} (x_{ij}-\bar{x}_{kj})^2}" class="tex"/></dd></dl></dd></dl>






