<h1 class="firstHeading">27.6.3 The Button Settings Dialog Box</h1><p class='urlname' style='display: none'>ButtonSetting-Dialog</p>
<p><br />
</p>
<dl><dd><dl><dd><a  class="image"><img alt="The Button Settings Dialog Box.png" src="../images/The_Button_Settings_Dialog_Box/The_Button_Settings_Dialog_Box.png?v=48735" width="540"  /></a></dd></dl></dd></dl>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#The_File_Name_Text_Box"><span class="tocnumber">1</span> <span class="toctext">The File Name Text Box</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#The_Section_Name_Text_Box"><span class="tocnumber">2</span> <span class="toctext">The Section Name Text Box</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#The_Argument_List_Text_Box"><span class="tocnumber">3</span> <span class="toctext">The Argument List Text Box</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#The_Tool_Tip_Text_and_Status_Bar_Text_Boxes"><span class="tocnumber">4</span> <span class="toctext">The Tool Tip Text and Status Bar Text Boxes</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#The_Context_Group"><span class="tocnumber">5</span> <span class="toctext">The Context Group</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#LabTalk_Expression_to_enable"><span class="tocnumber">5.1</span> <span class="toctext">LabTalk Expression to enable</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#LabTalk_Variable_to_toggle:"><span class="tocnumber">5.2</span> <span class="toctext">LabTalk Variable to toggle:</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Split_Buttons:_adding_a_drop-down_menu_to_a_button"><span class="tocnumber">5.3</span> <span class="toctext">Split Buttons: adding a drop-down menu to a button</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="The_File_Name_Text_Box"></a><span class="mw-headline">The File Name Text Box</span></h2>
<p>Specify the LabTalk script file that contains the script for this button. You can specify a built-in script file or a custom script file that you or another Origin user created. Script files have the file name extension .OGS. 
</p><p>The script file is a text file that is organized in sections. Each of these sections is identified by the name of the section, surrounded by square brackets. This is a section from one of the .OGS files that is installed with your Origin software.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Filename:  Arrow.ogs</span>

<span style="color: #008000;">// Creation:  10/31/1996</span>

<span style="color: #008000;">// Purpose:  Script to be called from the Arrow toolbar</span>

<span style="color: #008000;">//////////////////////////////////////////////////////////////////</span>

<span style="color: #000000;">&#91;</span>Horizontal<span style="color: #000000;">&#93;</span>

select <span style="color: #000080;">-</span>toggle horz;

<span style="color: #000000;">&#91;</span>Vertical<span style="color: #000000;">&#93;</span>

select <span style="color: #000080;">-</span>toggle vert;</pre>
<table class="note">

<tr>
<td>
<p><b>Note:</b> To view an example LabTalk script file:
</p>
<ol><li> Select <b>File: Open</b>.</li>
<li> Select LabTalk Script (*.OGS) from the <b>Files of Type</b> drop-down list.</li>
<li> Select a script file.</li>
<li> Click <b>Open</b>. </li></ol>
<p>For example, select ARROW.OGS. The script file opens in a LabTalk Editor window.
</p>
</td></tr></table>
<h2><a name="The_Section_Name_Text_Box"></a><span class="mw-headline">The Section Name Text Box</span></h2>
<p>Specify the script file section name (without brackets) that contains the script for this button in the <b>Section Name</b> text box.
</p><p>In the script file, section names are enclosed in brackets. For example:
</p>
<pre class="lt" style="font-family:monospace;"> <span style="color: #000000;">&#91;</span>SectionName<span style="color: #000000;">&#93;</span></pre>
<h2><a name="The_Argument_List_Text_Box"></a><span class="mw-headline">The Argument List Text Box</span></h2>
<p>To pass the script file section an argument (or arguments), type the argument(s) in the <b>Argument List</b> text box.
</p><p>Up to five arguments may be passed and must be space separated. Protect spaces within an argument with cotes or parentheses. All arguments are passed as text with any text substitution occurring before being passed to the script:
</p><p>Example ( Assume&#160;%A = "myvar" and myvar = 3 )&#160;:
</p><p>"one is the first"&#160;%A $(%A) $(pi) (five is the fifth argument)
</p><p>gets passed the script as these five text strings&#160;:
</p><p>"one is the first" "myvar" "3" "3.14159" "five is the fifth argument"
</p>
<h2><a name="The_Tool_Tip_Text_and_Status_Bar_Text_Boxes"></a><span class="mw-headline">The Tool Tip Text and Status Bar Text Boxes</span></h2>
<p>Specify the ToolTip and status bar messages for the button in the respective text boxes.
</p>
<h2><a name="The_Context_Group"></a><span class="mw-headline">The Context Group</span></h2>
<p>You can restrict a button's availability to instances when the active window is (a) created from a particular template or (b) is of a particular window type. 
</p>
<dl><dd><dl><dd><a  class="image"><img alt="Button settings context group.png" src="../images/The_Button_Settings_Dialog_Box/Button_settings_context_group.png?v=89220" width="613"  /></a></dd></dl></dd></dl>
<p><br />
</p>
<h3><a name="LabTalk_Expression_to_enable"></a><span class="mw-headline">LabTalk Expression to enable</span></h3>
<p>You can further restrict a button's availability based on the value of a specified variable or test condition. Do this by typing the variable name or a test condition in the <b>LabTalk Expression to enable</b> text box.
</p><p>To determine button availability, Origin first checks template and window type restrictions. If the button passes these criteria, Origin checks to see if a variable or object property has been associated with the button.
</p>
<ul><li> <b>Variable Name</b>: If you enter a variable name in the <b>LabTalk Expression...</b> text box, Origin checks the current numeric value of the variable. If the current variable value is zero (0), Origin disables the button. Otherwise, Origin enables the button. For example, if you enter ...</li></ul>
<p><b>wks.sel</b>
</p><p>... then whenever there is a selection in the worksheet, <a class="external text" href="../../LabTalk/LabTalk/Wks_(object).html"><b>wks.sel</b></a> will be non-zero, and the button will be enabled. 
</p>
<ul><li> <b>Test Condition</b>: If you enter a test condition in the <b>LabTalk Expression...</b> text box, Origin checks to see if the test condition is False (zero) or True (non-zero). If the test condition is False, Origin disables the button. If the test condition is True, Origin enables the button. For example, if you enter ...</li></ul>
<p><b>wks.sel</b> == <b>8</b>
</p><p>... then whenever a range of data is selected in the worksheet, this condition will be True and the button will be enabled.
</p>
<h3><a name="LabTalk_Variable_to_toggle:"></a><span class="mw-headline">LabTalk Variable to toggle:</span></h3>
<p>A button can be made to show different states using different icons, using the <b>LabTalk Variable to toggle</b> text box. For example, if you enter ...
</p><p><b>state:3</b>
</p><p>... then the button will use the selected icon, plus the two following in the bitmap based on the value of LabTalk variable <b>state</b> rounded by 3.
</p><p>The following is a special case: if you entered ...
</p><p><b>state:1</b> or <b>state</b>
</p><p>... then the button will toggle between the "button-up" (not pressed) and "button-down" (pressed) states.
</p><p>Note that the button will be disabled if LabTalk variable <b>state</b> is not defined or the value is missing, and the toggle variable will be passed as an extra argument at the end of the argument list internally.
</p>
<h3><a name="Split_Buttons:_adding_a_drop-down_menu_to_a_button"></a><span class="mw-headline">Split Buttons: adding a drop-down menu to a button</span></h3>
<p>A custom button can display a drop-down button using a syntax similar to that shown for the <b>state</b> variable mentioned above, but leaving out the variable <b>state</b>. 
</p><p>For instance, to attach a six-button drop-down menu to the the selected custom button (select a button under <b>Buttons</b> and click <b>Settings</b>), you would enter ...
</p><p><b>:6</b>
</p><p>... in the <b>LabTalk Variable to toggle</b> field. The menu will use six icons (the current icon plus the next five) to generate the drop-down list.
</p>
<dl><dd><a  class="image"><img alt="Custom button drop-down menu.png" src="../images/The_Button_Settings_Dialog_Box/Custom_button_drop-down_menu.png?v=89224" width="828"  /></a></dd></dl>






