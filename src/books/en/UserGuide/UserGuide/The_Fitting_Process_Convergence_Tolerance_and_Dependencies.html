<h1 class="firstHeading">15.4.5 The Reason Why Fail to Converge</h1><p class='urlname' style='display: none'>The_Reason_Why_Fail_to_Converge</p>
<p>The <a href="../../UserGuide/Category/Theory_of_Nonlinear_Curve_Fitting.html" title="Category:Theory of Nonlinear Curve Fitting">nonlinear fitting</a> process is iterative. The process completes when the difference between reduced chi-square values of two successive iterations is less than a certain tolerance value.  When the process completes, we say that the fit has converged.  To illustrate, we'll use a model with one parameter:
</p><p><a  class="image"><img alt="The Fitting Process Convergence,Tolerance and Dependencies-1.jpg" src="../images/The_Fitting_Process_Convergence_Tolerance_and_Dependencies/The_Fitting_Process_Convergence_2CTolerance_and_Dependencies-1.jpg?v=0" width="343"  /></a>
</p><p>The curve denotes the change of reduced <img src="../images/The_Fitting_Process_Convergence_Tolerance_and_Dependencies/math-2cc00eb1d9b5c363fe3f2cb960ce0636.png?v=0" title="\chi^2\,\!" alt="\chi^2\,\!" class="tex"/> during a fitting procedure. Starting from an initial value <img src="../images/The_Fitting_Process_Convergence_Tolerance_and_Dependencies/math-b45cefc3373fceeba09ddfc7b558ef92.png?v=0" title="\theta _0\,\!" alt="\theta _0\,\!" class="tex"/>, the parameter value is adjusted so that the <img src="../images/The_Fitting_Process_Convergence_Tolerance_and_Dependencies/math-2cc00eb1d9b5c363fe3f2cb960ce0636.png?v=0" title="\chi^2\,\!" alt="\chi^2\,\!" class="tex"/> value is reduced.  The fit has converged when ∆ <img src="../images/The_Fitting_Process_Convergence_Tolerance_and_Dependencies/math-2cc00eb1d9b5c363fe3f2cb960ce0636.png?v=0" title="\chi^2\,\!" alt="\chi^2\,\!" class="tex"/> ≤ Tolerance.
</p><p>The purpose of the nonlinear curve fitting procedure is to find the absolute minimum value of reduced <img src="../images/The_Fitting_Process_Convergence_Tolerance_and_Dependencies/math-2cc00eb1d9b5c363fe3f2cb960ce0636.png?v=0" title="\chi^2\,\!" alt="\chi^2\,\!" class="tex"/>. However, sometimes the minimization procedure does not reach this absolute minimum value (the fit does not converge).  Failure to converge can frequently be traced to one of the following:
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Poor_initial_parameter_values"><span class="tocnumber">1</span> <span class="toctext">Poor initial parameter values</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Relative_vs_absolute_minima"><span class="tocnumber">2</span> <span class="toctext">Relative vs absolute minima</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Non-unique_parameter_values"><span class="tocnumber">3</span> <span class="toctext">Non-unique parameter values</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Over-parameterized_functions"><span class="tocnumber">4</span> <span class="toctext">Over-parameterized functions</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Bad_data"><span class="tocnumber">5</span> <span class="toctext">Bad data</span></a></li>
</ul>
</div>

<h2><a name="Poor_initial_parameter_values"></a><span class="mw-headline">Poor initial parameter values</span></h2>
<p>Initial values are very important to a fitting procedure. They can be empirical values from previous work or estimated values derived by transforming the formula into an approximate form.  With good initial values, it will take less time to perform the fitting.
</p>
<h2><a name="Relative_vs_absolute_minima"></a><span class="mw-headline">Relative vs absolute minima</span></h2>
<p>It is not uncommon for the iterative procedure to find a relative -- as opposed to an absolute -- minimum.  In this example, the procedure actually converges in the sense that a further decrease of reduced <img src="../images/The_Fitting_Process_Convergence_Tolerance_and_Dependencies/math-2cc00eb1d9b5c363fe3f2cb960ce0636.png?v=0" title="\chi^2\,\!" alt="\chi^2\,\!" class="tex"/> seems impossible.
</p><p><a  class="image"><img alt="The Fitting Process Convergence Tolerance and Dependencies-2.jpg" src="../images/The_Fitting_Process_Convergence_Tolerance_and_Dependencies/The_Fitting_Process_Convergence_Tolerance_and_Dependencies-2.jpg?v=10762" width="340"  /></a>
</p><p>The problem is that you do not even know if the routine has reached an absolute or a relative minimum. The only way to be certain that the iterative procedure is reaching an absolute minimum is to start fitting from several different initial parameter values and observe the results.  If you repeatedly get the same final result, it is unlikely that a local minimum has been found.
</p>
<h2><a name="Non-unique_parameter_values"></a><span class="mw-headline">Non-unique parameter values</span></h2>
<p>The most common problem that arises in nonlinear fitting is that no matter how you choose the initial parameter values, the fit does not seem to converge.  Some or all parameter values continue to change with successive iterations and they eventually diverge, producing arithmetic overflow or underflow. This should indicate that you need to do something about the fitting function and/or data you are using. There is simply no single set of parameter values which best fit your data.
</p>
<h2><a name="Over-parameterized_functions"></a><span class="mw-headline">Over-parameterized functions</span></h2>
<p>If the function parameters have the same differential with respect to independent variables, it may suggest that the function is overparameterized.  In such cases, the fitting procedure will not converge.  For example in the following model
</p><p><img src="../images/The_Fitting_Process_Convergence_Tolerance_and_Dependencies/math-4348fab613601f6914fd30533fe324d4.png?v=0" title="y=Ae^{x-x_0}" alt="y=Ae^{x-x_0}" class="tex"/>            
</p><p>A is the amplitude and x0 is the horizontal offset.  However, you can rewrite the function as
</p><p><img src="../images/The_Fitting_Process_Convergence_Tolerance_and_Dependencies/math-c15c5655c0df1100a4cc67b3566b291a.png?v=0" title="y=Ae^{x-x_0}=A\frac 1{e^{x_0}}e^x=Be^x" alt="y=Ae^{x-x_0}=A\frac 1{e^{x_0}}e^x=Be^x" class="tex"/>
</p><p>In other words, if, during the fitting procedure, the values of A and <img src="../images/The_Fitting_Process_Convergence_Tolerance_and_Dependencies/math-7d0cdef5493ee4f7310651be4b94e81b.png?v=0" title="x_0\,\!" alt="x_0\,\!" class="tex"/> change so that the combination B remains the same, the reduced <img src="../images/The_Fitting_Process_Convergence_Tolerance_and_Dependencies/math-2cc00eb1d9b5c363fe3f2cb960ce0636.png?v=0" title="\chi^2\,\!" alt="\chi^2\,\!" class="tex"/> value will not change.  Any attempts to further improve the fit are not likely to be productive.
</p><p><a  class="image"><img alt="The Fitting Process Convergence Tolerance and Dependencies-3.jpg" src="../images/The_Fitting_Process_Convergence_Tolerance_and_Dependencies/The_Fitting_Process_Convergence_Tolerance_and_Dependencies-3.jpg?v=10770" width="398"  /></a>
</p><p>If you see one of the following, it indicates that something is wrong:
</p>
<ul><li>The parameter error is very large relative to the parameter value.  For example, if the width of the Gaussian curve is 0.5 while the error is 10, the result for the width will be meaningless as the fit has not converged.</li></ul>
<ul><li>The parameter dependence (for one or more parameters) is very close to one. You should probably remove or fix the value of parameters whose dependency is close to one, since the fit does not seem to depend upon the parameter.</li></ul>
<p>Note, however, that over-parameterization does not necessarily mean that the parameters in the model have no physical meanings.  It may suggest that there are infinite solutions and you should apply constraints to the fit process.
</p>
<h2><a name="Bad_data"></a><span class="mw-headline">Bad data</span></h2>
<p>Even when the function is not theoretically overparameterized, the iterative procedure may behave as if it were, due to the fact that the data do not contain enough information for some or all of the parameters to be determined.  This usually happens when the data are available only in a limited interval of the independent variable(s).  For example, if you are fitting a non-monotonic function such as the Gaussian to monotonic data, the nonlinear fitter will experience difficulties in determining the peak center and peak width, since the data can describe only one flank of the Gaussian peak.
</p>





