<h1 class="firstHeading">6.4.2 Extracting Variables from the File Name and Header</h1><p class='urlname' style='display: none'>ImpWiz-ExtractVar</p>
<p><br />
When importing files with the Import Wizard, you have the opportunity to identify file name or header information as variables.  The extraction of the information can be customized in the <b>Variable Extraction</b> page.  After the variables are extracted, they are saved in the target page for future use. 
</p><p>From the file name, four standard file name variables (path + filename.extension, path, filename.extension, filename) can be extracted.  Additionally, all of the header lines ( <a href="../../UserGuide/UserGuide/Customizing_the_ASCII_Import_Options.html#Header_Lines" title="UserGuide:Customizing the ASCII Import Options">the main header lines and subheader lines</a>) can supply variables.  You can specify the number of the header lines in the <b>Number of main header lines</b> box and the <b>Number of subheader lines</b> box in the <b>Header Lines</b> page of the Import Wizard.
</p>
<h2><a name="File_information_storage"></a><span class="mw-headline">File information storage</span></h2>
<p>Extracted variables are stored in the information storage object of the destination page.  There are two areas where the variables can be saved: 
</p>
<ul><li><b>page.info</b>.  The page.info area only holds variables extracted from the last imported file. </li></ul>
<ul><li><b>binary storage</b>.  Binary storage saves variables extracted from all files imported into the window. </li></ul>
<p>These variables can be inserted into text labels or worksheet cells using the <b>Insert Variables</b> shortcut menu command.  Variables can be listed from the command line using the <b>impinfo</b> X-Function or the following script command:
</p><p>Page.info.user.=
</p>
<table class="note">

<tr>
<td>
<p><b>Note:</b>  Please see the <a href="../../UserGuide/Category/Accessing_Metadata_Associated_with_Imported_Files.html" title="Category:Accessing Metadata Associated with Imported Files">Accessing Metadata Associated with Imported Files</a> section later in this chapter for more information.
</p>
</td></tr></table>
<h2><a name="Using_variables_for_annotation"></a><span class="mw-headline">Using variables for annotation</span></h2>
<p>There are numerous ways in which you might use stored variable information in text annotations on graphs or worksheets. One possible use of this information might be to add it to a graph legend.  In this example, assume that we have imported a data file in which we have specified saving some portion of the file name or header information to a variable and we will proceed to insert the file name into the graph legend.
</p>
<ol><li>Start a new project. </li>
<li>Open the Import Wizard by clicking the <b>Import Wizard</b> button <a  class="image"><img alt="Button Import Wizard.png" src="../images/Extracting_Variables_from_the_File_Name_and_Header/Button_Import_Wizard.png?v=1807" width="23"  /></a> on the Standard toolbar.</li>
<li>Click the <b>Browse</b> button to the right of the <b>File</b> list.  Navigate to the Origin \Samples\Signal processing\ subfolder.  Add Average Sunspot.dat and click <b>OK</b>.</li>
<li>Click <b>Next</b>.</li>
<li>On the <b>Header Lines</b> page, make sure that the first two lines are identified as header lines.</li>
<li>Click <b>Next</b>.</li>
<li>On the <b>Variable Extraction</b> page, select <b>Specify location of variable names and values using delimiters</b>.  Note that when you do this, <b>Add variables to page info</b> is automatically selected.</li>
<li>Click <b>Next</b>. </li>
<li>On the <b>Variable Extraction by Delimiter</b> page, choose <b>FN04</b> from the <b>Line</b> drop-down list.  Enter <b>fname</b> in the <b>Enter variable name</b> text box.  Click <b>Add</b>.  </li>
<li>Click <b>Finish</b>.  The file is imported into the workbook.</li>
<li>Highlight the second column of the workbook.  Click the <b>Line</b> button <a  class="image"><img alt="Button Line.png" src="../images/Extracting_Variables_from_the_File_Name_and_Header/Button_Line.png?v=1819" width="22"  /></a> on the <b>2D Graphs</b> toolbar to create a plot.</li>
<li>Double-click on the graph legend so that you can edit it.  Delete "<b>%(1)</b>".  Hold down the CTRL key, and press the <b>H</b> key on your keyboard.  This opens the <b>Insert Info Variables</b> dialog box.</li>
<li>In the Insert Info Variables dialog box, select <b>fname</b> under <b>User.Variables</b>. Click <b>Insert</b>.  The graph legend should now read <b>Average Sunspot</b>.</li></ol>






