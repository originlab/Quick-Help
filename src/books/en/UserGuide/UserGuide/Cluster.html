<h1 class="firstHeading">11.4 The Cluster Gadget (Pro Only)</h1><p class='urlname' style='display: none'>Gadget-Cluster</p>
<p><br />
</p>
<div style="text-align: left; direction: ltr; margin-left: 1em;"><p><a  class="image"><img alt="Video Image.png" src="../images/Cluster/Video_Image.png?v=29468" width="33"  /></a> See more related video:<a class="external text" href="http://www.originlab.com/Index.aspx?go=Support/VideoTutorials&amp;ss=chm&amp;pid=1845" target="_blank">Cluster Gadget</a>
</p></div>
<div class="toclimit-2"><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Overview"><span class="tocnumber">1</span> <span class="toctext">Overview</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#To_Use_Cluster_Gadget"><span class="tocnumber">1.1</span> <span class="toctext">To Use Cluster Gadget</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-3"><a href="#The_Gadget_Dialog.27s_Toolbar_Buttons"><span class="tocnumber">2</span> <span class="toctext">The Gadget Dialog's Toolbar Buttons</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Create_ROI"><span class="tocnumber">2.1</span> <span class="toctext">Create ROI</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Create_Categorical_Value"><span class="tocnumber">2.2</span> <span class="toctext">Create Categorical Value</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#The_Gadget_Dialog.27s_Menu_Settings"><span class="tocnumber">3</span> <span class="toctext">The Gadget Dialog's Menu Settings</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#Edit"><span class="tocnumber">3.1</span> <span class="toctext">Edit</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Data"><span class="tocnumber">3.2</span> <span class="toctext">Data</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Settings"><span class="tocnumber">3.3</span> <span class="toctext">Settings</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-10"><a href="#The_Preferences_Dialog_Settings"><span class="tocnumber">4</span> <span class="toctext">The Preferences Dialog Settings</span></a>
<ul>
<li class="toclevel-2 tocsection-11"><a href="#ROI_Box"><span class="tocnumber">4.1</span> <span class="toctext">ROI Box</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Output_To"><span class="tocnumber">4.2</span> <span class="toctext">Output To</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#Calculation"><span class="tocnumber">4.3</span> <span class="toctext">Calculation</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-14"><a href="#Context_Menu_in_Lower_Panel"><span class="tocnumber">5</span> <span class="toctext">Context Menu in Lower Panel</span></a>
<ul>
<li class="toclevel-2 tocsection-15"><a href="#Context_menu_brought_up_by_right-clicking_any_column_title"><span class="tocnumber">5.1</span> <span class="toctext">Context menu brought up by right-clicking any column title</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#Context_menu_brought_up_by_right-clicking_any_cell"><span class="tocnumber">5.2</span> <span class="toctext">Context menu brought up by right-clicking any cell</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-17"><a href="#ROI_Fly-Out_Menu"><span class="tocnumber">6</span> <span class="toctext">ROI Fly-Out Menu</span></a></li>
<li class="toclevel-1 tocsection-18"><a href="#Example"><span class="tocnumber">7</span> <span class="toctext">Example</span></a></li>
<li class="toclevel-1 tocsection-19"><a href="#Algorithm"><span class="tocnumber">8</span> <span class="toctext">Algorithm</span></a></li>
</ul>
</div>
</div>
<h2><a name="Overview"></a><span class="mw-headline">Overview</span></h2>
<p>The <b>Cluster Gadget</b> performs simple statistics on a <a href="../../UserGuide/Category/Gadgets.html" title="Category:Gadgets">ROI</a> (Region of Interest) in a graph. The gadget can also be used to edit, clear, or mask data points. The statistics results are dynamically updated as the ROI object is moved or resized. There are two panels in this gadget dialog. The upper panel provides tools to manipulate the ROI data points, while the lower panel shows basic statistical information with ROI.
</p><p><a  class="image"><img alt="Cluster Gadget Overview.png" src="../images/Cluster/400px-Cluster_Gadget_Overview.png?v=70934" width="400"   /></a>
</p><p><br />
With the Cluster gadget, you can:
</p>
<ul><li> Quickly perform basic statistics on a cluster of data.</li>
<li> Easily edit the data points using menu options or buttons.</li>
<li> Switch between rectangular or elliptical ROI.</li>
<li> View statistics of points inside and outside of the ROI.</li>
<li> Output results for inner and outer points to worksheet.</li></ul>
<table class="note">

<tr>
<td><b>Notes:</b>
<ul>
<li> The statistics results in the lower panel will display once you move or resize the ROI.
<li> Right-click inside the results panel to view context menu to turn on/off data plots to be included in the computation.
<li> Operations such as masking and clearing are controlled by buttons in the dialog. The <b>Data</b> menu can be used to determine which data plots will be affected by these buttons.
</ul>
</td></tr></table>
<h5><a name="To_Use_Cluster_Gadget"></a><span class="mw-headline">To Use Cluster Gadget</span></h5>
<p>To use the <b>Cluster</b> gadget, select <b>Gadgets: Cluster</b> from the main menu when a graph is active.
</p>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Cluster/Alert_icon.png?v=9649" width="57"  border="0" /></td><td><p>Most of Origin's analysis tools do not allow modifying imported data. However, some functions of the Cluster Gadget allow data modification (e.g. the <b>Set Value</b> button and accompanying edit box). Thus, if you are importing data using a <a href="../../UserGuide/Category/Data_Connector.html" title="Category:Data Connector"><b>Data Connector</b></a>, and you intend to use functions which modify imported data, you should <a class="external text" href="../../QuickHelp/QuickHelp/How_to_allow_changing_data_when_data_connector_is_used.html">unlock data in the import workbook</a>.
</p>
	</td>
	</tr>
	</table>
<h2><a name="The_Gadget_Dialog.27s_Toolbar_Buttons"></a><span class="mw-headline">The Gadget Dialog's Toolbar Buttons</span></h2>
<p>These buttons are used to manipulate data points within ROI range. You can select from <b>Data</b> menu to change working plots. You can also use options in <b>Edit</b> menu to work on data points.
</p>
<table class="dialogcontroltable">

<tr>
<th><b>Output Statistics Report</b>
<p><a  class="image"><img alt="Region stats outputstats.png" src="../images/Cluster/Region_stats_outputstats.png?v=88931" width="28"  /></a>
</p>
</th>
<td> Click to output statistics report. The content of the report can be set in Cluster Manipulation Preferences.
</td></tr>
<tr>
<th><b>Go to Report Worksheet</b>
<p><a  class="image"><img alt="Region stats gotoreport.png" src="../images/Cluster/Region_stats_gotoreport.png?v=88932" width="28"  /></a>
</p>
</th>
<td> Click to go to the results worksheet. It is only available after the report worksheet has been created.
</td></tr>
<tr>
<th><b>Go to Source Worksheet</b>
<p><a  class="image"><img alt="Region stats gotosource.png" src="../images/Cluster/Region_stats_gotosource.png?v=88933" width="28"  /></a>
</p>
</th>
<td> Click to go to the worksheet for the selected data points. If plots come from different worksheets, it will go to the worksheet of the first selected plot.
</td></tr>
<tr>
<th><b>Modify ROI</b>
<p><a  class="image"><img alt="Region stats modifyroi.png" src="../images/Cluster/Region_stats_modifyroi.png?v=88944" width="28"  /></a>
</p>
</th>
<td> Click to open the <b>Create ROI</b> dialog box. Select a shape and drag it out on your graph. The dialog will stay open until you click Done (allowing you to start over with another ROI shape, if needed).
</td></tr>
<tr>
<th><b>Add New ROI</b>
<p><a  class="image"><img alt="Region stats addnewroi.png" src="../images/Cluster/Region_stats_addnewroi.png?v=88943" width="28"  /></a>
</p>
</th>
<td> Click to add additional ROI(s) to the graph. When you have added a new ROI, click <b>Done</b> . If you wish to add another ROI, click the <b>Add New ROI</b> button again and repeat the process. Each added ROI will be assigned a different color and shown in the <b>ROI</b> column of the Cluster Gadget. Switch ROIs by clicking on the ROI in the graph.
<ul><li> ROIs within the graph window will share <a href="#The_Preferences_Dialog_Settings"><b>Preferences</b></a> except <b>Fill Color</b>, <b>Shape</b> and <b>Shape Position</b>. </li>
<li> ROI <a href="#ROI_Box"><b>Fill Color</b></a> will show as the first column of the tool to identify the active ROI.</li>
<li> When multiple ROIs exist and <a href="#ROI_Box"><b>Color Inner Points</b></a> is checked, only points in active ROI will be colored.</li></ul>
</td></tr>
<tr>
<th><b>Switch Inner/Outer Points</b>
<p><a  class="image"><img alt="Region stats switchiopoints.png" src="../images/Cluster/Region_stats_switchiopoints.png?v=88934" width="28"  /></a>
</p>
</th>
<td> Click to determine whether points inside or outside ROI will be edited by operations such as masking and clearing data. The dialog title will indicate the status of this button.
</td></tr>
<tr>
<th><b>Undo Last Change</b>
<p><a  class="image"><img alt="Region stats undo.png" src="../images/Cluster/Region_stats_undo.png?v=88935" width="28"  /></a>
</p>
</th>
<td> Click to undo the last action.
</td></tr>
<tr>
<th><b>Copy Data</b>
<p><a  class="image"><img alt="Region stats copy.png" src="../images/Cluster/Region_stats_copy.png?v=88936" width="28"  /></a>
</p>
</th>
<td> Click to copy the values of the selected data points.
</td></tr>
<tr>
<th><b>Clear Data</b>
<p><a  class="image"><img alt="Region stats clear.png" src="../images/Cluster/Region_stats_clear.png?v=88937" width="28"  /></a>
</p>
</th>
<td> Click to clear the cells of the selected data points in the source worksheet.
</td></tr>
<tr>
<th><b>Delete Worksheet Rows</b>
<p><a  class="image"><img alt="Region stats delete.png" src="../images/Cluster/Region_stats_delete.png?v=88938" width="28"  /></a>
</p>
</th>
<td> Click to delete rows corresponding to cells of the selected data points in the source worksheet.
</td></tr>
<tr>
<th><b>Mask Data Points</b>
<p><a  class="image"><img alt="Region stats maskdp.png" src="../images/Cluster/Region_stats_maskdp.png?v=88939" width="28"  /></a>
</p>
</th>
<td> Click this button to mask the cells of the selected data points in the source worksheet.
</td></tr>
<tr>
<th><b>Unmask Data Points</b>
<p><a  class="image"><img alt="Region stats unmaskdp.png" src="../images/Cluster/Region_stats_unmaskdp.png?v=88940" width="28"  /></a>
</p>
</th>
<td> Click to unmask the cells of the selected data points in the source worksheet.
</td></tr>
<tr>
<th><b>Create Categories</b>
<p><a  class="image"><img alt="Region stats create categories.png" src="../images/Cluster/Region_stats_create_categories.png?v=88941" width="28"  /></a>
</p>
</th>
<td> Create a category group, add data within current ROI into that group and set categorical values. The <a href="../../UserGuide/UserGuide/Cluster.html#Create_Categorical_Value" title="UserGuide:Cluster"><b>Create Categorical Value</b></a> dialog will open by clicking this button, allowing you to set category. Category group column(s) will be added to the source worksheet.
<p>Note that once you have defined a <b>Category</b>, you can move the ROI around the graph with your mouse, pressing hotkey "C" to add additional points to the same category (without opening the <b>Create Categorical Value</b> dialog again).
</p>
</td></tr>
<tr>
<th><b>Set Value</b>
<p><a  class="image"><img alt="Region stats set.png" src="../images/Cluster/Region_stats_set.png?v=88942" width="28"  /></a>
</p>
</th>
<td> Click this button to set the value of the selected data points in the source worksheet to the value entered in the edit box to the right of this button.
</td></tr>
<tr>
<th><b>Show/Hide Bottom Panel</b>
<p><a  class="image"><img alt="Region stats hide.png" src="../images/Cluster/Region_stats_hide.png?v=24803" width="24"  /></a>
</p>
</th>
<td> Click this button to show/hide the dialog's bottom panel.
</td></tr></table>
<table class="note">

<tr>
<td><b>Notes:</b>
<ul>
<li>These edit buttons (such as <b>Clear Data</b>, <b>Delete Worksheet Rows</b>, <b>Mask Data Points</b>, <b>Unmask Data Points</b>, <b>Set Value</b>) will be disabled when locked analysis plots are selected.</li>
<li>A data point can belong to only one category (group). If a data point is set to one group and then set to another, it will be overridden by the later assignment.</li></ul>
</td></tr></table>
<h3><a name="Create_ROI"></a><span class="mw-headline">Create ROI</span></h3>
<p>Use this small dialog to add ROIs of a given shape to the current graph window. If you wish to add multiple ROIs, you will need to click <b>Done</b> when you've added the current ROI and initiate drawing a new ROI by clicking the <b>Add New ROI</b> button <a  class="image"><img alt="Region stats addnewroi.png" src="../images/Cluster/Region_stats_addnewroi.png?v=88943" width="28"  /></a> on the Cluster Gadget's toolbar.
</p>
<dl><dd><dl><dd><a  class="image"><img alt="OH cluster gadget create ROI.png" src="../images/Cluster/OH_cluster_gadget_create_ROI.png?v=88948" width="245"  /></a></dd></dl></dd></dl>
<p>For assistance with creating shapes, see <a href="../../UserGuide/Category/Creating_Drawing_Objects.html" title="Category:Creating Drawing Objects"><b>Drawing a Smooth Curve</b></a> and <a href="../../UserGuide/Category/Creating_Drawing_Objects.html#Drawing_two-dimensional_objects" title="Category:Creating Drawing Objects"><b>Drawing 2D Objects</b></a>.
</p>
<h3><a name="Create_Categorical_Value"></a><span class="mw-headline">Create Categorical Value</span></h3>
<p><a  class="image"><img alt="Region stats create categories dialog.png" src="../images/Cluster/Region_stats_create_categories_dialog.png?v=78957" width="363"  /></a>
</p><p>Create a category with the data points in current ROI and set its value.
</p>
<table class="dialogcontroltable">

<tr>
<th>Category Group Name
</th>
<td> Enter a name for the category group. This group name will be the <b>Long Name</b> of the Categories column.
</td></tr>
<tr>
<th>Category
</th>
<td> Enter a category value for the group. It can be numeric data or text string. For a group, you can add multiple categories.
</td></tr>
<tr>
<th>Color Data by Category
</th>
<td> Specify whether to set the new categorical column value as the data plot color index.
</td></tr>
<tr>
<th>Add Group Column for Each Data Plot
</th>
<td> Specify whether to add category group column for the selected plot(s) (by <a href="../../UserGuide/UserGuide/Cluster.html#Data" title="UserGuide:Cluster"><b>Data</b></a> menu) only or add group columns for all plots in the layer, one for each plot respectively. It is unchecked by default.
</td></tr>
<tr>
<th>Clear Category
</th>
<td> To clear the data points from the category in current ROI, and the data points category information will be set to <b>undefined</b>.
</td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Cluster/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>Once you have defined a <b>Category</b>, you can move the ROI around the graph with your mouse, pressing hotkey "C" to add additional points to the same category.
</p></td></tr></table>
<h2><a name="The_Gadget_Dialog.27s_Menu_Settings"></a><span class="mw-headline">The Gadget Dialog's Menu Settings</span></h2>
<h3><a name="Edit"></a><span class="mw-headline">Edit</span></h3>
<p>Use these menu options to edit selected data points in the source worksheet.
</p>
<table class="dialogcontroltable">

<tr>
<th>Undo
</th>
<td>Undo the last action.
</td></tr>
<tr>
<th>Copy Data
</th>
<td>Copy the values of the selected data points.
</td></tr>
<tr>
<th>Clear Data
</th>
<td>Clear the cells of the selected data points in the source worksheet.
</td></tr>
<tr>
<th>Delete Worksheet Rows
</th>
<td>Delete rows corresponding to cells of the selected data points in the source worksheet.
</td></tr>
<tr>
<th>Mask Data Points
</th>
<td>Mask the cells of the selected data points in the source worksheet.
</td></tr>
<tr>
<th>Unmask Data Points
</th>
<td>Unmask the cells of the selected data points in the source worksheet.
</td></tr>
<tr>
<th>Create Categories
</th>
<td>Create a category group, add data within current ROI into that group and set categorical values. The <a href="../../UserGuide/UserGuide/Cluster.html#Create_Categorical_Value" title="UserGuide:Cluster"><b>Create Categorical Value</b></a> dialog will open by selecting this menu, allowing you to set category. Category group column(s) will be added next to data plot(s) in the source worksheet.
</td></tr></table>
<table class="note">

<tr>
<td><b>Notes:</b> These menu options (such as <b>Clear Data</b>, <b>Delete Worksheet Rows</b>, <b>Mask Data Points</b>, <b>Unmask Data Points</b>) will be disabled when locked analysis plots are selected.
</td></tr></table>
<h3><a name="Data"></a><span class="mw-headline">Data</span></h3>
<p>This menu specifies which data plots will be affected by buttons such as for clearing and masking data.<br />
<b>Note:</b> Data plots and stats displayed in lower panel are not affected by this menu. To control lower panel entries, right click inside panel and use the context menu.
</p>
<table class="dialogcontroltable">

<tr>
<th>Plot(n)
</th>
<td>Select the nth plot in the active layer.
<p>This menu will show first 20 datasets/plots. If there are more than 20 plots in the graph, you can click <b>More...</b> at the bottom of the plots list to open the <b>Select Plot(s)</b> dialog to select other plots.
</p>
</td></tr>
<tr>
<th>Show Locked Analysis Plot(s)
</th>
<td>Determine whether to show locked analysis plot(s) in <b>Data</b> menu. Locked plots are usually generated from other analysis tools, like fitting, smoothing, etc.
</td></tr>
<tr>
<th>All Plots
</th>
<td>Select all plots listed in <b>Data</b> menu. Note that if locked analysis plots are not shown in <b>Data</b> menu, they will not be selected.
</td></tr>
<tr>
<th>Inner Points
</th>
<td>Check to work on data points inside ROI.
</td></tr>
<tr>
<th>Outer Points
</th>
<td>Check to work on data points outside ROI.
</td></tr></table>
<h3><a name="Settings"></a><span class="mw-headline">Settings</span></h3>
<table class="dialogcontroltable">

<tr>
<th>Use Circular ROI Box
</th>
<td>Toggle the shape of the current ROI between rectangle or circular (only available for these ROI shapes).
</td></tr>
<tr>
<th>Expand to Full Plot(s) Range
</th>
<td>Expand the ROI's width and height to fit all selected plots.
</td></tr>
<tr>
<th>Expand to Full Layer Width
</th>
<td>Expand the ROI's width to the selected layer's width.
</td></tr>
<tr>
<th>Expand to Full Layer Height
</th>
<td>Expand the ROI's height to the selected layer's height.
</td></tr>
<tr>
<th>Reset ROI Position
</th>
<td>Reset ROI's position to default.
</td></tr>
<tr>
<th>Show Attached Buttons
</th>
<td>Show <b>Close</b> button and <b>Context</b> menu at the top right of the ROI.
</td></tr>
<tr>
<th>Real-time Calculation
</th>
<td>Real-time calculation when moving ROI. We suggest to uncheck this option when working on large datasets.
</td></tr>
<tr>
<th>Save as &lt;default&gt;
</th>
<td>Save the current dialog's setting as the default theme.
</td></tr>
<tr>
<th>Save Theme
</th>
<td>Save the current dialog's setting as a theme.
</td></tr>
<tr>
<th>Load Theme
</th>
<td>Load a theme from its theme list.
</td></tr>
<tr>
<th>Preferences
</th>
<td>Bring up the <a href="#The_Preferences_Dialog_Settings">Cluster Manipulation Preferences</a> dialog for customizing the gadget.
</td></tr></table>
<h2><a name="The_Preferences_Dialog_Settings"></a><span class="mw-headline">The Preferences Dialog Settings</span></h2>
<p>This dialog can be opened by 
</p>
<ol><li>Selecting <b>Gadgets: Cluster</b> from the Origin menu.</li>
<li>Selecting <b>Settings: Preferences</b> from <b>Cluster Gadget</b> dialog's menu.</li>
<li>Selecting <b>Preferences</b> from the ROI's fly-out menu.</li></ol>
<p><br />
Multiple ROIs within the same graph window will share <b>Preferences</b> except <b>ROI Box</b> tab settings <b>Fill Color</b>, <b>Shape</b> and <b>Shape Position</b>.
</p>
<h3><a name="ROI_Box"></a><span class="mw-headline">ROI Box</span></h3>
<table class="dialogcontroltable">

<tr>
<th>Show Close Button and Context Menu
</th>
<td>Specify whether to show <b>Close</b> button and <b>Context</b> menu at the top right of the ROI.
</td></tr>
<tr>
<th>Show Tool Name
</th>
<td>Specify whether to show the tool's name at the top of the ROI.
</td></tr>
<tr>
<th>Fill Color
</th>
<td>When <b>Point Indicate Mode</b> = <b>None</b> or <b>Color Inner Points</b>, specify fill color of ROI.
</td></tr>
<tr>
<th>Border Color
</th>
<td>When <b>Point Indicate Mode</b> = <b>Fade-out Outer</b>, specify border color of ROI. In this mode, the ROI displays no fill color.
</td></tr>
<tr>
<th>Point Indicate Mode
</th>
<td>Specify how to handle indicating point selection with respect to the ROI: <b>Color Inner Points</b>, <b>Fade-out Outer</b> or <b>None</b>.
<dl><dd><a  class="image"><img alt="UG cluster gadget fade-out outer.png" src="../images/Cluster/UG_cluster_gadget_fade-out_outer.png?v=93502" width="499"  /></a></dd></dl>
</td></tr>
<tr>
<th>Shape
</th>
<td>Specify the shape of the ROI. It can be either <b>Rectangle</b>, <b>Circular</b> or <b>Arbitrary Shape</b>. See the details about these shapes <a href="../../UserGuide/UserGuide/The_Surface_Integration_Gadget_Pro.html#Shape" title="UserGuide:The Surface Integration Gadget Pro">here</a>.
</td></tr>
<tr>
<th>Shape Position
</th>
<td>This group of settings allows you to set the precise position of the ROI. If <b>Circular</b> is selected in the <b>Shape</b> drop-down list, the settings below actually define a rectangle whose sides lie tangent to the circular ROI.
<ul><li><b>X1</b>: Specify the left X position of the rectangle.</li>
<li><b>X2</b>: Specify the right X position of the rectangle.</li>
<li><b>Y1</b>: Specify the bottom Y position of the rectangle.</li>
<li><b>Y2</b>: Specify the top Y position of the rectangle.</li></ul>
</td></tr></table>
<h3><a name="Output_To"></a><span class="mw-headline">Output To</span></h3>
<table class="dialogcontroltable">

<tr>
<th>Script Window
</th>
<td>Specify whether to output the results to the <b>Script Window</b>.
</td></tr>
<tr>
<th>Result Log
</th>
<td>Specify whether to output the results to the <b>Results Log</b>.
</td></tr>
<tr>
<th>Append to Worksheet
</th>
<td>Specify whether to append the results to a worksheet.
</td></tr>
<tr>
<th>Result Worksheet Name
</th>
<td> If you check the <b>Append to Worksheet</b> box, use this edit box to specify the name of the output worksheet:
<ul><li> When you generate new output, results are output to <b>[%H-Cluster]RegionStats</b>  by default (here <b>%H</b> means the Short Name of source graph), but other books and sheets can be specified. If the book and sheet do not exist, they will be created on output.</li>
<li> Alternately, you can click the flyout button <a  class="image"><img alt="Gadget flyout button.png" src="../images/Cluster/Gadget_flyout_button.png?v=84659" width="18"  /></a> to the right of <b>Result Worksheet Name</b> and choose <b>Sheet in Input Book</b>. This fills the edit box with <b>[&lt;input&gt;]RegionStats</b>. When you generate new output, results are output to a sheet named <b>RegionStats</b> in the source book.</li></ul>
</td></tr></table>
<h3><a name="Calculation"></a><span class="mw-headline">Calculation</span></h3>
<table class="dialogcontroltable">
<tr>
<th>Calculate Outer Points
</th>
<td>Specify whether to compute statistics for points out of the ROI.
</td></tr>
<tr>
<th>Real-time Calculation
</th>
<td>Specify whether to show the real-time result in the <b>Cluster Gadget</b> dialog when moving the ROI. When this check box is cleared, A message "Real-time Calculation is off" will be shown on the top of ROI.
</td></tr>
<tr>
<th>Input Legend
</th>
<td>Specify whether to output the legend text for the source dataset.
</td></tr>
<tr>
<th>Shape
</th>
<td>Specify whether to output the shape of the ROI.
</td></tr>
<tr>
<th>Data Points Info
</th>
<td>This group is used to specify data points info for output.
<dl><dd><b>Indices</b>
<dl><dd> Specify whether to output the data points' indices.</dd></dl></dd>
<dd><b>Values</b>
<dl><dd> Specify whether to output the data points' values.</dd></dl></dd></dl>
</td></tr>
<tr>
<th>Statistics on
</th>
<td>This group is used to specify whether to compute the statistical quantities for X, Y and Colormap values, within the ROI.
<dl><dd><b>X Value</b>
<dl><dd>Specify whether to compute statistical quantities for X coordinate values.</dd></dl></dd>
<dd><b>Y Value</b>
<dl><dd>Specify whether to compute statistical quantities for Y coordinate values.</dd></dl></dd>
<dd><b>Color</b>
<dl><dd>When scatter points are colormapped to a column of values, compute statistics on the "color" column. </dd></dl></dd></dl>
</td></tr>
<tr>
<th>Quantities to Compute
</th>
<td>This group is used to specify statistical quantities to compute, within the ROI.
<dl><dd><b>N</b>
<dl><dd>Specify whether to output the number of data points.</dd></dl></dd>
<dd><b>Sum</b>
<dl><dd>Specify whether to output the sum of the data points.</dd></dl></dd>
<dd><b>Mean</b>
<dl><dd>Specify whether to output the mean of the data points.</dd></dl></dd>
<dd><b>Median</b>
<dl><dd>Specify whether to output the median of the data points.</dd></dl></dd>
<dd><b>SD</b>
<dl><dd>Specify whether to output the standard deviation of the data points.</dd></dl></dd>
<dd><b>Minimum</b>
<dl><dd>Specify whether to output the minimum value (specified by <b>Statistics on</b>) of the data points.</dd></dl></dd>
<dd> <b>X/Y at Minimum</b>
<dl><dd> Specify whether to output the X coordinate (if <b>Statistics on</b> = <b>Y Value</b>)/ Y coordinate (if <b>Statistics on</b> = <b>X Value</b>) of the minimum data point.</dd></dl></dd>
<dd><b>Maximum</b>
<dl><dd>Specify whether to output the maximum value (specified by <b>Statistics on</b>) of the data points.</dd></dl></dd>
<dd><b>X/Y at Maximum</b>
<dl><dd> Specify whether to output the X coordinate (if <b>Statistics on</b> = <b>Y Value</b>)/ Y coordinate (if <b>Statistics on</b> = <b>X Value</b>) of the maximum data points.</dd></dl></dd></dl>
</td></tr></table>
<h2><a name="Context_Menu_in_Lower_Panel"></a><span class="mw-headline">Context Menu in Lower Panel</span></h2>
<p>Results of all the plots in the graph are listed here in rows. Different quantities of statistics results are listed in different columns.
</p>
<h3><a name="Context_menu_brought_up_by_right-clicking_any_column_title"></a><span class="mw-headline">Context menu brought up by right-clicking any column title</span></h3>
<dl><dd><a  class="image"><img alt="Region stats iotab.png" src="../images/Cluster/Region_stats_iotab.png?v=49129" width="445"  /></a></dd></dl>
<p>Right-click on any column title to bring up the context menu to specify what kind of statistic results shown here.
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Cluster/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>Right-clicking menu list includes "Z" stats for an XY scatter plot that is color-mapped to a Z column of values.
</p></td></tr></table>
<table class="note">

<tr>
<td><b>Notes:</b> The contents in statistics report output are controlled in <a href="#The_Preferences_Dialog_Settings">Cluster Manipulation Preferences</a>, not from the context menu here.
</td></tr></table>
<h3><a name="Context_menu_brought_up_by_right-clicking_any_cell"></a><span class="mw-headline">Context menu brought up by right-clicking any cell</span></h3>
<dl><dd><a  class="image"><img alt="Region stats iotab2.png" src="../images/Cluster/Region_stats_iotab2.png?v=49130" width="514"  /></a></dd></dl>
<p>Right-click on the cells to bring up context menu and select displaying statistic results for which plots
</p>
<table class="note">

<tr>
<td><b>Notes:</b> The plots you manipulating on are controlled by <b>Data</b> menu, not the context menu here.
</td></tr></table>
<h2><a name="ROI_Fly-Out_Menu"></a><span class="mw-headline">ROI Fly-Out Menu</span></h2>
<p>Click the triangle button <a  class="image"><img alt="ROI menu.png" src="../images/Cluster/ROI_menu.png?v=21045" width="21"  /></a> beside the top right corner of the ROI to open the fly-out menu. If you do not see the button, you can enable it by doing one of the following:
</p>
<ul><li> From the main menu choose <b>Gadgets: Cluster</b>. On the <b>ROI Box</b> tab, check the <b>Show Close Button and Context Menu</b> box.</li>
<li> If the Cluster Gadget tool is open, click <b>Settings</b> and verify that <b>Show Attached Buttons</b> is checked. </li></ul>
<p><br />
Fly-out menu commands are as follows:
</p>
<table class="dialogcontroltable">

<tr>
<th> <b>New Statistics Output</b>
</th>
<td> Select the option to output the results to what are specified in <b>Output To</b> tab of <b>Cluster Manipulation Preferences</b> dialog.
</td></tr>
<tr>
<th> <b>Go to Report Worksheet</b>
</th>
<td> Go to the results worksheet. It is only available after the report worksheet has been created.
</td></tr>
<tr>
<th> <b>Go to Source Worksheet</b>
</th>
<td> Go to the worksheet for the selected data points. If the plots come from different worksheets, it will go to the worksheet of the first selected plot.
</td></tr>
<tr>
<th>Output to Clipboard
</th>
<td>When selected (menu item checked) <b>New Output</b> will be placed on the Clipboard.
</td></tr>
<tr>
<th> <b>Change Data</b>
</th>
<td> Select data plots and ROI or non-ROI.
<dl><dd><b>Plot(n)</b>
<dl><dd>Select the nth plot in the active layer.</dd></dl></dd>
<dd><b>Show Locked Analysis Plot(s)</b>
<dl><dd>Determine whether to show locked analysis plot(s) in the fly-out menu.</dd></dl></dd>
<dd><b>All Plots</b>
<dl><dd>Select all plots listed in the fly-out menu. Note that if locked analysis plots are not shown in the menu, they will not be selected.</dd></dl></dd>
<dd><b>Inner Points</b>
<dl><dd>Select data points in the ROI. When it is checked, <b>Outer Points</b> will be cleared. And the dialog's title will be updated to show "Editing Inner Points". </dd></dl></dd>
<dd><b>Outer Points</b>
<dl><dd>Select data points out of the ROI. When it is checked, <b>Inner Points</b> will be cleared. And the dialog's title will be updated to show "Editing Outer Points".</dd></dl></dd></dl>
</td></tr>
<tr>
<th> <b>Expand to Full Plot Range</b>
</th>
<td> Expand the ROI range to fit all selected plots.
</td></tr>
<tr>
<th> <b>Expand to Full Layer Width</b>
</th>
<td> Expand the ROI's width to the selected layer's width.
</td></tr>
<tr>
<th> <b>Expand to Full Layer Height</b>
</th>
<td> Expand the ROI's height to the selected layer's height.
</td></tr>
<tr>
<th> <b>Use Circular ROI Box</b>
</th>
<td> Specify whether to use a circular ROI.
</td></tr>
<tr>
<th> <b>Save Theme</b>
</th>
<td> Save the current dialog's setting as a theme, which will open the <b>Theme Save as</b> dialog, and you can specify the theme name in the edit box.
</td></tr>
<tr>
<th> <b>Save as &lt;default&gt;</b>
</th>
<td> Save the current dialog's setting as the default theme.
</td></tr>
<tr>
<th> <b>Load Theme</b>
</th>
<td> Load a theme from its theme list.
</td></tr>
<tr>
<th> <b>Preferences</b>
</th>
<td> Bring up the <b>Cluster Manipulation Preferences</b> dialog for customizing the gadget.
</td></tr></table>
<h2><a name="Example"></a><span class="mw-headline">Example</span></h2>
<ol>
<li> Create a new worksheet and import the data file <i>Multiple Gaussians.dat</i>, which is located in the folder <i>&lt;Origin Program Folder&gt;\Samples\Curve Fitting</i>. 

<li>Highlight the entire worksheet and from the main menu, select <b>Plot: Basic 2D: Scatter</b>.

<li> Select <b>Gadgets: Cluster</b> from the Origin menu. Keep the default settings and click <b>OK</b>. A yellow <b>ROI</b> object is added to the plot, the color of the selected scatter points is changed, and the <b>Cluster Gadget</b> opens. 

<li>Select <b>Settings: Show Attached Buttons</b> from <b>Cluster Gadget</b> dialog's menu. A <b>Close</b> button and context menu will be shown in the top right corner of the ROI.

<dl><dd><a  class="image"><img alt="Region stats graph.png" src="../images/Cluster/Region_stats_graph.png?v=36680" width="449"  /></a></dd>
<dd><a  class="image"><img alt="Region stats graph2.png" src="../images/Cluster/Region_stats_graph2.png?v=88971" width="587"  /></a></dd></dl>

<li> Move the <b>ROI</b> and see how the results change.
<li> Click <b>Mask Data Points</b> button in the <b>Cluster Gadget</b> dialog to mask the data in the source worksheet. You will find that the inner points in the source worksheet have been masked.

<dl><dd><a  class="image"><img alt="Region stats maskedwks.png" src="../images/Cluster/Region_stats_maskedwks.png?v=22443" width="424"  /></a></dd></dl>
</ol>
<p><br />
For more instruction in use of the <b>Cluster Gadget</b>, see <a class="external text" href="../../Tutorial/Tutorial/Cluster_Gadget.html">this tutorial</a>.
</p>
<h2><a name="Algorithm"></a><span class="mw-headline">Algorithm</span></h2>
<p>This tool performs descriptive statistics on the curve in the graph window. For more information about calculation, please refer to <a class="external text" href="../../XFunction/X-Function/Stats.html#Algorithm">the algorithm of X-Function <b>stats</b></a>.
</p>

