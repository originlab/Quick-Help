<h1 class="firstHeading">17.1.8.2 Algorithms (Normality Test)</h1><p class='urlname' style='display: none'>NormalityTest-Algorithm</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Shapiro-Wilk_normality_test"><span class="tocnumber">1</span> <span class="toctext">Shapiro-Wilk normality test</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Kolmogorov-Smirnov_normality_test"><span class="tocnumber">2</span> <span class="toctext">Kolmogorov-Smirnov normality test</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Lilliefors_normality_test"><span class="tocnumber">3</span> <span class="toctext">Lilliefors normality test</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Anderson-Darling_Test"><span class="tocnumber">4</span> <span class="toctext">Anderson-Darling Test</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#D.27Agostino-K_Squared"><span class="tocnumber">5</span> <span class="toctext">D'Agostino-K Squared</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Chen-Shapiro_Test"><span class="tocnumber">6</span> <span class="toctext">Chen-Shapiro Test</span></a></li>
</ul>
</div>

<h4><a name="Shapiro-Wilk_normality_test"></a><span class="mw-headline">Shapiro-Wilk normality test</span></h4>
<p>Given a set of observations <img src="../images/Algorithm_(Normality)/math-da816f52afb28c9a4d5be1c09a730848.png?v=0" title="X\{x_1,x_2,\ldots x_n\}" alt="X\{x_1,x_2,\ldots x_n\}" class="tex"/> sorted into either ascending or descending order, the Shapiro Wilk W statistic is defined as: 
</p><p><img src="../images/Algorithm_(Normality)/math-2b8c2f54db785f51cff535b5a14dd64c.png?v=0" title="w=\frac{\left (\sum_{i=1}^n a_ix_i\right)^2}{\sum_{i=1}^n (x_i-\bar{x})^2}" alt="w=\frac{\left (\sum_{i=1}^n a_ix_i\right)^2}{\sum_{i=1}^n (x_i-\bar{x})^2}" class="tex"/>
</p><p>where
</p><p><img src="../images/Algorithm_(Normality)/math-5062c945b80017e06b87807c8a9604c7.png?v=0" title="\bar{x}=\frac{1}{n}\sum_{1}^n x_i" alt="\bar{x}=\frac{1}{n}\sum_{1}^n x_i" class="tex"/>
</p><p>is the sample mean and ai, for i=1, 2,...n are a set of mathematical weights, the values of which depend only on the sample size n. 
</p><p>The algorithm used by Origin is from the Applied Statistics Algorithm R94 described by Patrick Royston (1995). The function supports sample sizes of 3.
</p><p>Degree of freedom (DF) is equal to the sample size.
</p>
<h4><a name="Kolmogorov-Smirnov_normality_test"></a><span class="mw-headline">Kolmogorov-Smirnov normality test</span></h4>
<p>Origin calls a NAG function <a class="external text" href="http://www.originlab.com/pdfs/nagcl09/manual/pdf/g08/g08cbc.pdf" target="_blank">nag_1_sample_ks_test (g08cbc)</a> , to compute the statistics. Please refer to related NAG document, for more details on the algorithm.
</p>
<h4><a name="Lilliefors_normality_test"></a><span class="mw-headline">Lilliefors normality test</span></h4>
<p>Lilliefors test is adapted from the Kolmogorov-Smirnov test, and the statistics is computed in the same way as that of Kolmogorov-Smirnov test. However, the p-value is different because Lilliefors test does not care about the mean score and variance of the data while Kolmogorov-Smirnov test does. Dallal and Wilkinson (1986) Method is used for p-value computation.
</p>
<h4><a name="Anderson-Darling_Test"></a><span class="mw-headline">Anderson-Darling Test</span></h4>
<p>Given a set of observations <img src="../images/Algorithm_(Normality)/math-da816f52afb28c9a4d5be1c09a730848.png?v=0" title="X\{x_1,x_2,\ldots x_n\}" alt="X\{x_1,x_2,\ldots x_n\}" class="tex"/> sorted into either ascending order, the Anderson Darling statistic is defined as 
</p><p><img src="../images/Algorithm_(Normality)/math-66ac66e5ca0bd8aa06d15da1c0bdff08.png?v=0" title="A^2= - n - S  " alt="A^2= - n - S  " class="tex"/>
</p><p>where
</p><p><img src="../images/Algorithm_(Normality)/math-ae48327d0646764802f5ab65b0a0629c.png?v=0" title="S=\sum_{i=1}^n \frac{2i-1}{n}[lnF(x_i)+ln(1-F(x_n+1-i))]" alt="S=\sum_{i=1}^n \frac{2i-1}{n}[lnF(x_i)+ln(1-F(x_n+1-i))]" class="tex"/>
</p><p><img src="../images/Algorithm_(Normality)/math-800618943025315f869e4e1f09471012.png?v=0" title="F" alt="F" class="tex"/> is the cumulative distribution function of the <img src="../images/Algorithm_(Normality)/math-800618943025315f869e4e1f09471012.png?v=0" title="F" alt="F" class="tex"/> distribution
</p>
<h4><a name="D.27Agostino-K_Squared"></a><span class="mw-headline">D'Agostino-K Squared</span></h4>
<ul><li> <b>Skewness statistic</b>
<ol><li> Compute the Skewness <img src="../images/Algorithm_(Normality)/math-7690463eb72806a32d3a9068b55863ac.png?v=0" title="\sqrt{b_1}" alt="\sqrt{b_1}" class="tex"/> from the data
<dl><dd> <img src="../images/Algorithm_(Normality)/math-1decae5bdca182cf7cbacd718f49102c.png?v=0" title="\sqrt{b_1}= \frac{\frac{1}{n} \sum_{i=1}^n \left( x_i - \bar{x} \right)^3}{\left( \frac{1}{n} \sum_{i=1}^n \left( x_i - \bar{x} \right)^2 \right)^{3/2}}" alt="\sqrt{b_1}= \frac{\frac{1}{n} \sum_{i=1}^n \left( x_i - \bar{x} \right)^3}{\left( \frac{1}{n} \sum_{i=1}^n \left( x_i - \bar{x} \right)^2 \right)^{3/2}}" class="tex"/></dd></dl></li>
<li> Compute
<dl><dd><img src="../images/Algorithm_(Normality)/math-01152369e9c29f2e35613869b83e53cc.png?v=0" title="Y=\sqrt{b_1}[\frac{(n+1)(n+3)}{6(n-2)}]^{1/2}" alt="Y=\sqrt{b_1}[\frac{(n+1)(n+3)}{6(n-2)}]^{1/2}" class="tex"/></dd>
<dd><img src="../images/Algorithm_(Normality)/math-d5a0c389a3eb414a5324941032844df8.png?v=0" title="\beta_2(\sqrt{b_1})=\frac{3(n^2+27n-70)(n+1)(n+3)}{(n-2)(n+5)(n+7)(n+9)}" alt="\beta_2(\sqrt{b_1})=\frac{3(n^2+27n-70)(n+1)(n+3)}{(n-2)(n+5)(n+7)(n+9)}" class="tex"/></dd>
<dd><img src="../images/Algorithm_(Normality)/math-3ae054509a5c4ccc6be16ad180024d78.png?v=0" title="W^2=-1+[2(\beta_2(\sqrt{b_1})-1)]^{1/2}" alt="W^2=-1+[2(\beta_2(\sqrt{b_1})-1)]^{1/2}" class="tex"/></dd>
<dd><img src="../images/Algorithm_(Normality)/math-9004906fc6ab53eea87c11b75c7d4263.png?v=0" title="\delta=\frac{1}{\sqrt{lnW}}" alt="\delta=\frac{1}{\sqrt{lnW}}" class="tex"/></dd>
<dd><img src="../images/Algorithm_(Normality)/math-91a6bbdf6084b1d5811d8af2b87a79c9.png?v=0" title="\alpha=[\frac{2}{(W^2-1)}]^{1/2}" alt="\alpha=[\frac{2}{(W^2-1)}]^{1/2}" class="tex"/></dd></dl></li>
<li> The <b>Skewness statistic</b> <img src="../images/Algorithm_(Normality)/math-26bedb673ea546798ab56abb512b9da6.png?v=0" title="Z(\sqrt{b_1})" alt="Z(\sqrt{b_1})" class="tex"/> can be computed with equation below
<dl><dd> <img src="../images/Algorithm_(Normality)/math-eb19edacbadd9bcaa79aa1a91f693c81.png?v=0" title="Z(\sqrt{b_1}) = \delta ln(Y/\alpha+[(Y/\alpha)^2+1]^{1/2})" alt="Z(\sqrt{b_1}) = \delta ln(Y/\alpha+[(Y/\alpha)^2+1]^{1/2})" class="tex"/></dd></dl></li></ol></li></ul>
<ul><li> <b>Kurtosis Statistic</b>
<ol><li> Compute the <b>Kurtosis</b> <img src="../images/Algorithm_(Normality)/math-738f96a4cb37df3457c637024d23a488.png?v=0" title="b_2" alt="b_2" class="tex"/> from the data
<dl><dd> <img src="../images/Algorithm_(Normality)/math-37d6ea61d3b29518453cbbc499d7afa6.png?v=0" title="b_2 =  \frac{\frac{1}{n} \sum_{i=1}^n \left( x_i - \bar{x} \right)^4}{\left( \frac{1}{n} \sum_{i=1}^n \left( x_i - \bar{x} \right)^2 \right)^2} - 3 " alt="b_2 =  \frac{\frac{1}{n} \sum_{i=1}^n \left( x_i - \bar{x} \right)^4}{\left( \frac{1}{n} \sum_{i=1}^n \left( x_i - \bar{x} \right)^2 \right)^2} - 3 " class="tex"/></dd></dl></li>
<li> Compute the mean and variance of <img src="../images/Algorithm_(Normality)/math-738f96a4cb37df3457c637024d23a488.png?v=0" title="b_2" alt="b_2" class="tex"/>
<dl><dd> <img src="../images/Algorithm_(Normality)/math-9c5170e1270b112d5f0e7c3e023f2079.png?v=0" title="E(b_2)=\frac{3(n-1)}{n+1}" alt="E(b_2)=\frac{3(n-1)}{n+1}" class="tex"/></dd>
<dd> <img src="../images/Algorithm_(Normality)/math-5119d8fe80d8a996b7186f862b846a34.png?v=0" title="var(b_2)=\frac{24n(n-2)(n-3)}{(n+1)^2(n+3)(n+5)}" alt="var(b_2)=\frac{24n(n-2)(n-3)}{(n+1)^2(n+3)(n+5)}" class="tex"/></dd></dl></li>
<li> Compute the standardized moment of <img src="../images/Algorithm_(Normality)/math-738f96a4cb37df3457c637024d23a488.png?v=0" title="b_2" alt="b_2" class="tex"/>
<dl><dd> <img src="../images/Algorithm_(Normality)/math-06af60d0caee81c311554a75e2e0ff98.png?v=0" title="\sqrt{\beta_1(b_2)}=\frac{6(n^2-5n+2)}{(n+7)(n+9)}\sqrt{\frac{6(n+3)(n+5)}{n(n-2)(n-3)}} " alt="\sqrt{\beta_1(b_2)}=\frac{6(n^2-5n+2)}{(n+7)(n+9)}\sqrt{\frac{6(n+3)(n+5)}{n(n-2)(n-3)}} " class="tex"/></dd></dl></li>
<li> Compute
<dl><dd> <img src="../images/Algorithm_(Normality)/math-83a081ae4ce291a0addf3ec000adbcc1.png?v=0" title="A=6+\frac{8}{\sqrt{\beta_1(b_2)}} [\frac{2}{\sqrt{\beta_1(b_2)}}+\sqrt{1+\frac{4}{\beta_1(b_2)}}]" alt="A=6+\frac{8}{\sqrt{\beta_1(b_2)}} [\frac{2}{\sqrt{\beta_1(b_2)}}+\sqrt{1+\frac{4}{\beta_1(b_2)}}]" class="tex"/></dd></dl></li>
<li> The <b>Kurtosis statistic</b> <img src="../images/Algorithm_(Normality)/math-fa255dd0910e58e3bad70422770976e7.png?v=0" title="Z(b_2)" alt="Z(b_2)" class="tex"/> can be computed by formula below
<dl><dd> <img src="../images/Algorithm_(Normality)/math-4df1512dfa6fb980194394476ad95e1b.png?v=0" title="Z(b_2)=((1-\frac{2}{9A})-[\frac{1-2/A}{1+x\sqrt{2/(A-4)}}]^{1/3})/\sqrt{2/(9A)}" alt="Z(b_2)=((1-\frac{2}{9A})-[\frac{1-2/A}{1+x\sqrt{2/(A-4)}}]^{1/3})/\sqrt{2/(9A)}" class="tex"/></dd></dl></li></ol></li></ul>
<ul><li><b>D'Agostino's Chi2 Statistic</b>
<dl><dd><img src="../images/Algorithm_(Normality)/math-a5e3c8eb5a6c80114c9e364ed56ffdcb.png?v=0" title="K^2 = Z^2(\sqrt{b_1})+Z^2(b_2)" alt="K^2 = Z^2(\sqrt{b_1})+Z^2(b_2)" class="tex"/></dd></dl></li></ul>
<h4><a name="Chen-Shapiro_Test"></a><span class="mw-headline">Chen-Shapiro Test</span></h4>
<p>Given a set of observations <img src="../images/Algorithm_(Normality)/math-da816f52afb28c9a4d5be1c09a730848.png?v=0" title="X\{x_1,x_2,\ldots x_n\}" alt="X\{x_1,x_2,\ldots x_n\}" class="tex"/> sorted into either ascending order, the Chen-Shapiro statistic is defined as 
</p><p><img src="../images/Algorithm_(Normality)/math-975d1e28fe61f14ce5355ade53915fa6.png?v=0" title="QH =\sqrt{N}(1-\frac{1}{(n-1)S}\sum_{i=1}^{n-1}\frac{x_{i+1}-x_i}{H_{i+1}-H_i})" alt="QH =\sqrt{N}(1-\frac{1}{(n-1)S}\sum_{i=1}^{n-1}\frac{x_{i+1}-x_i}{H_{i+1}-H_i})" class="tex"/>
</p><p>where
</p><p><img src="../images/Algorithm_(Normality)/math-785f74b0073d58b9c79e700c7c03e930.png?v=0" title="H_i = \Phi^{-1} ((i-3/8)/(n+1/4))" alt="H_i = \Phi^{-1} ((i-3/8)/(n+1/4))" class="tex"/> and <img src="../images/Algorithm_(Normality)/math-6961e78be39c8a325c23ee3b4b5bf3ca.png?v=0" title="\Phi^{-1}" alt="\Phi^{-1}" class="tex"/> is the inverse of teh standard normal distribution
</p>





