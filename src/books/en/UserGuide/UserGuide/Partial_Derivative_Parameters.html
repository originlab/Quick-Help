<h1 class="firstHeading">15.3.4.2 Specifying Partial Derivative of Parameters</h1><p class='urlname' style='display: none'>FitRef-PartDerivPara</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#How_to_Set_Partial_Derivative_Parameters"><span class="tocnumber">1</span> <span class="toctext">How to Set Partial Derivative Parameters</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Using_Function_Builder"><span class="tocnumber">1.1</span> <span class="toctext">Using Function Builder</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Using_Function_Organizer"><span class="tocnumber">1.2</span> <span class="toctext">Using Function Organizer</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4"><a href="#Defining_Partial_Derivative"><span class="tocnumber">2</span> <span class="toctext">Defining Partial Derivative</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="#By_Origin_C"><span class="tocnumber">2.1</span> <span class="toctext">By Origin C</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#By_Labtalk"><span class="tocnumber">2.2</span> <span class="toctext">By Labtalk</span></a></li>
</ul>
</li>
</ul>
</div>

<p>Iterative procedure of <a href="../../UserGuide/Category/Theory_of_Nonlinear_Curve_Fitting.html#Levenberg-Marquardt_.28L-M.29_Algorithm" title="Category:Theory of Nonlinear Curve Fitting">L-M algorithm</a> need to calculate the partial derivatives of fitting functions to go forward to the best fit. So when you define your  <a href="../../UserGuide/UserGuide/User-Defined_Fitting_Functions.html" title="UserGuide:User-Defined Fitting Functions">user-defined function</a>, specifying partial derivatives can reduce the time it takes to perform a set of iterations. 
</p><p>If you wish to specify partial derivatives, note that you must specify the derivatives of the function of the dependent variable in terms of the fit parameters.  
</p><p>If you did not specify partial derivatives, Origin will solve the partial derivatives of fitting functions with <a href="../../UserGuide/UserGuide/Differentiate.html#Algorithm" title="UserGuide:Differentiate">numeric methods</a>.
</p>
<table class="note">

<tr>
<td><b>Notes</b>: However, given the much-enhanced speed of fitting achieved with Origin C, specifying partial derivatives may not be necessary.
</td></tr></table>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Partial_Derivative_Parameters/Alert_icon.png?v=9649" width="57"  border="0" /></td><td><ul><li> Specify partial derivatives is only supported in defining <a href="../../UserGuide/UserGuide/User-Defined_Fitting_Functions.html" title="UserGuide:User-Defined Fitting Functions">User-defined Function</a></li>
<li> Specify partial derivatives is only supported for two function form of the fitting function
<ul><li> Origin C</li>
<li> Labtalk Script (Not recommend to use)</li></ul></li></ul>
	</td>
	</tr>
	</table>
<p><br />
</p>
<h2><a name="How_to_Set_Partial_Derivative_Parameters"></a><span class="mw-headline">How to Set Partial Derivative Parameters</span></h2>
<h3><a name="Using_Function_Builder"></a><span class="mw-headline">Using Function Builder</span></h3>
<ol><li> In the <a href="../../UserGuide/UserGuide/The_Name_and_Type_Page.html" title="UserGuide:The Name and Type Page">Name and Type</a> page of <a href="../../UserGuide/Category/The_Fitting_Function_Builder.html" title="Category:The Fitting Function Builder">Fitting Function Builder</a>, set <b>Function Type</b> to be <b>Origin C</b> or <b>Labtalk Script</b>
<dl><dd> <a  class="image"><img alt="Partial Derivative Parameters 01.png" src="../images/Partial_Derivative_Parameters/500px-Partial_Derivative_Parameters_01.png?v=75579" width="500"   /></a></dd></dl></li>
<li> Continue to go to the <a href="../../UserGuide/UserGuide/The_Function_Body_Page.html" title="UserGuide:The Function Body Page">Function Body</a> page, make sure to select the <b>Use Derivatives</b> check box. Then click the <b>Open Code Builder</b> Button <a  class="image"><img alt="Ffb open codebuilder.png" src="../images/Partial_Derivative_Parameters/Ffb_open_codebuilder.png?v=23178" width="23"  /></a>
<dl><dd><a  class="image"><img alt="Partial Derivative Parameters 02.png" src="../images/Partial_Derivative_Parameters/500px-Partial_Derivative_Parameters_02.png?v=75580" width="500"   /></a></dd></dl></li>
<li> Define the function and partial derivation equations in the fitting function body
<dl><dd><a  class="image"><img alt="Partial Derivative Parameters 03.png" src="../images/Partial_Derivative_Parameters/400px-Partial_Derivative_Parameters_03.png?v=75581" width="400"   /></a></dd></dl></li></ol>
<h3><a name="Using_Function_Organizer"></a><span class="mw-headline">Using Function Organizer</span></h3>
<p>In the <a href="../../UserGuide/UserGuide/The_Fitting_Function_Organizer_Dialog_Box.html" title="UserGuide:The Fitting Function Organizer Dialog Box">Fitting Function Organizer</a>
</p>
<ol><li> Choose <b>Function Form</b> to be "Y-Script" or <b>Origin C</b></li>
<li> Select the <b>Derivative</b> check box</li>
<li> Click the <b>Open Code Builder</b> Button <a  class="image"><img alt="Ffb open codebuilder.png" src="../images/Partial_Derivative_Parameters/Ffb_open_codebuilder.png?v=23178" width="23"  /></a> next to the <b>Function</b> box</li>
<li> Define the function and partial derivation equations in the fitting function body</li>
<li><a  class="image"><img alt="Partial Derivative Parameters 04.png" src="../images/Partial_Derivative_Parameters/700px-Partial_Derivative_Parameters_04.png?v=75583" width="700"   /></a></li></ol>
<h2><a name="Defining_Partial_Derivative"></a><span class="mw-headline">Defining Partial Derivative</span></h2>
<h3><a name="By_Origin_C"></a><span class="mw-headline">By Origin C</span></h3>
<p>If you have chosen to define the function using Origin C, the variables for the partial derivatives will be pre-defined in Code Builder.  You just need to enter the expression for them.
</p>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Partial_Derivative_Parameters/Tutorial_icon.png?v=9654" width="57"  border="0" />
	</td>
	<td><p>For example, if the function is:
</p>
<dl><dd><img src="../images/Partial_Derivative_Parameters/math-2b6447148944ae93962b05146ebc1748.png?v=0" title="y=P_1+P_2x+e^{P_3x}" alt="y=P_1+P_2x+e^{P_3x}" class="tex"/>                </dd></dl>
<p>The partial derivatives for each parameter should be:
</p>
<dl><dd><img src="../images/Partial_Derivative_Parameters/math-4bb0cf3dc16749b13f9eac8ab1e2a9fa.png?v=0" title="\frac{\partial y}{\partial P_1}=1" alt="\frac{\partial y}{\partial P_1}=1" class="tex"/>	</dd>
<dd><img src="../images/Partial_Derivative_Parameters/math-15949c1acb33949bb938717952fff554.png?v=0" title="\frac{\partial y}{\partial P_2}=x" alt="\frac{\partial y}{\partial P_2}=x" class="tex"/>	</dd>
<dd><img src="../images/Partial_Derivative_Parameters/math-e89b0bc238ed581952c7ab1eb507cd14.png?v=0" title="\frac{\partial y}{\partial P_3}=xe^{P_3x}" alt="\frac{\partial y}{\partial P_3}=xe^{P_3x}" class="tex"/>            </dd></dl>
<p>Then if you define an Origin C fitting function, the variables dy_P1, dy_P2, and dy_P3 will be available, and can define the function with partial derivatives by:
</p>
<pre class="oc" style="font-family:monospace;">y <span style="color: #000080;">=</span> p1 <span style="color: #000040;">+</span> p2<span style="color: #000040;">*</span>x <span style="color: #000040;">+</span> <span style="color: #000000;">exp</span><span style="color: #000000;">&#40;</span>p3<span style="color: #000040;">*</span>x<span style="color: #000000;">&#41;</span>;
dy_p1 <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
dy_p2 <span style="color: #000080;">=</span> x;
dy_p3 <span style="color: #000080;">=</span> x <span style="color: #000040;">*</span> <span style="color: #000000;">exp</span><span style="color: #000000;">&#40;</span>p3<span style="color: #000040;">*</span>x<span style="color: #000000;">&#41;</span>;</pre>
<dl><dd><a  class="image"><img alt="Partial Derivative Parameters 05.png" src="../images/Partial_Derivative_Parameters/Partial_Derivative_Parameters_05.png?v=75589" width="348"  /></a></dd></dl>
</td></tr></table>
<h3><a name="By_Labtalk"></a><span class="mw-headline">By Labtalk</span></h3>
<p>If you want to define your function using LabTalk, select <i>Y-Script</i> in <a href="../../UserGuide/UserGuide/The_Fitting_Function_Organizer_Dialog_Box.html" title="UserGuide:The Fitting Function Organizer Dialog Box">Fitting Function Organizer</a> or <i>Labtalk Script</i> in <a href="../../UserGuide/Category/The_Fitting_Function_Builder.html" title="Category:The Fitting Function Builder">Fitting Function Builder</a>, Use <b>d_VarName</b> to represent the derivative variables.
</p><p>However, <a href="#By_Origin_C">Origin C</a> is easier to use because it enables user to compile and evaluate the functions before they really use it. Now we don't recommend specifying partial derivative using Labtalk.  
</p>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Partial_Derivative_Parameters/Tutorial_icon.png?v=9654" width="57"  border="0" />
	</td>
	<td><p>For the same example as in tutorial of <a href="#By_Origin_C">above section</a>
<p>Function: <img src="../images/Partial_Derivative_Parameters/math-2b6447148944ae93962b05146ebc1748.png?v=0" title="y=P_1+P_2x+e^{P_3x}" alt="y=P_1+P_2x+e^{P_3x}" class="tex"/>  
</p>
</p><p>The function and the partial derivatives can be defined by Labtalk as below
</p>
<pre class="lt" style="font-family:monospace;">y <span style="color: #000080;">=</span> p1 <span style="color: #000080;">+</span> p2<span style="color: #000080;">*</span>x <span style="color: #000080;">+</span> exp<span style="color: #000000;">&#40;</span>p3<span style="color: #000080;">*</span>x<span style="color: #000000;">&#41;</span>;
dy_p1 <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
dy_p2 <span style="color: #000080;">=</span> x;
dy_p3 <span style="color: #000080;">=</span> x <span style="color: #000080;">*</span> exp<span style="color: #000000;">&#40;</span>p3<span style="color: #000080;">*</span>x<span style="color: #000000;">&#41;</span>;</pre>
<p><a  class="image"><img alt="Partial Derivative Parameters 06.png" src="../images/Partial_Derivative_Parameters/400px-Partial_Derivative_Parameters_06.png?v=75594" width="400"   /></a>
</p></td></tr></table>


