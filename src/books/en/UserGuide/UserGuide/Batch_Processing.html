<h1 class="firstHeading">27.3 Batch Processing</h1><p class='urlname' style='display: none'>Batch-Processing</p>
<p><br />
</p>
<div style="text-align: left; direction: ltr; margin-left: 1em;"><p><a  class="image"><img alt="Video Image.png" src="../images/Batch_Processing/Video_Image.png?v=29468" width="33"  /></a> See more related video:<a class="external text" href="http://www.originlab.com/Index.aspx?go=Support/VideoTutorials&amp;ss=chm&amp;pid=1559" target="_blank">Batch Processing</a>, <a class="external text" href="http://www.originlab.com/Index.aspx?go=Support/VideoTutorials&amp;ss=chm&amp;pid=1886" target="_blank">Batch Processing of Peak Data using Theme</a>
</p></div>
 <div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#The_Batch_Processing_Dialog_Box"><span class="tocnumber">1</span> <span class="toctext">The Batch Processing Dialog Box</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Examples"><span class="tocnumber">2</span> <span class="toctext">Examples</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Example_1:_Import_.DAT_files_and_perform_nonlinear_curve_fitting"><span class="tocnumber">2.1</span> <span class="toctext">Example 1: Import .DAT files and perform nonlinear curve fitting</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Example_2:_Perform_batch_analysis_on_groups_of_CSV_files"><span class="tocnumber">2.2</span> <span class="toctext">Example 2: Perform batch analysis on groups of CSV files</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Example_3:_Perform_batch_analysis_and_create_reports_using_a_custom_MS_Word_template"><span class="tocnumber">2.3</span> <span class="toctext">Example 3: Perform batch analysis and create reports using a custom MS Word template</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Example_4:_Perform_batch_processing_on_worksheets_in_your_project_file"><span class="tocnumber">2.4</span> <span class="toctext">Example 4: Perform batch processing on worksheets in your project file</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Example_5:_Perform_batch_processing_on_datasets_grouped_by_worksheet_column"><span class="tocnumber">2.5</span> <span class="toctext">Example 5: Perform batch processing on datasets grouped by worksheet column</span></a></li>
</ul>
</li>
</ul>
</div>

<dl><dd><a  class="image"><img alt="UserGuide Batch Processing 001.png" src="../images/Batch_Processing/650px-UserGuide_Batch_Processing_001.png?v=95239" width="650"   /></a><br /></dd></dl>
<p>The <b>Batch Processing</b> tool allows you to perform repeat analysis on multiple datasets using an existing <b><a href="../../UserGuide/UserGuide/Analysis_Templates.html" title="UserGuide:Analysis Templates">Analysis Template</a></b> and optionally output analyzed results to a Word Template for reporting. You can process multiple data files from disk, or loop over data already in your project.
</p><p>To create an <a href="../../UserGuide/UserGuide/Analysis_Templates.html" title="UserGuide:Analysis Templates">Analysis Template</a>, perform an operation (e.g., curve fitting) and set <b><a href="../../UserGuide/UserGuide/Recalculating_Analysis_Results.html" title="UserGuide:Recalculating Analysis Results">Recalculate</a></b> to Auto or Manual.  You can optionally add a Result Sheet, which contains paste-linked results (e.g., the file name, or a subset of values from the parameter table generated by a curve fitting) from the analysis operation.  You can then use the Batch Processing tool to create a Summary Report compiling Result Sheet data from multiple files or datasets.
</p><p>Optionally you can choose to output analyzed results directly into a Word/PDF file using bookmarks in a Word template. The bookmarks in a Word template can only be utilized when added to a specified analysis template using <a href="../../UserGuide/UserGuide/Add_Word_Bookmarks_to_Analysis_Template_Dialog.html" title="UserGuide:Add Word Bookmarks to Analysis Template Dialog">Add Word Bookmarks to Analysis Template</a> dialog. An additional <i><b>Bookmarks</b></i> worksheet will be automatically generated to store the bookmarks, analysis results cell-linked from the analysis report and sizes of graphs to be exported.
</p><p>When the tool is used to process multiple disk files, the import settings (e.g., custom ASCII settings, or filter settings from the Import Wizard) can be saved as part of the <b>Analysis Template</b>.  Variables extracted while importing can be paste-linked into the <b>Result Sheet</b>, and this information will then appear in the <b>Summary</b> report create by the Batch Processing tool.
</p><p>The <b>Analysis Template</b> can include:
</p>
<ol><li>The <b>Raw Data</b> worksheet.</li>
<li>The <b>Analysis Report</b> worksheet. These are report sheets generated by analysis procedures (e.g., nonlinear fitting).</li>
<li>An optional <b>Result Sheet</b> containing analysis results cell-linked from the analysis report, and import variables, such as the file name or any parameters extracted from the file header. </li>
<li>An optional <b>Bookmarks</b> worksheet automatically generated when adding bookmarks from a Word template to the analysis template. The <i><b>Bookmarks</b></i> worksheet contains a <i>Bookmarks</i> column to store bookmarks from the Word template, a <i>Links</i> column to store analysis results cell-linked from the analysis report and a <i>GraphWidth</i> column to adjust the size of graphs to be exported to word/pdf files.</li></ol>
<p>After completing all desired settings in the <b>Batch Processing</b> dialog and click <b>OK</b>, every setting except <b>Batch Processing Mode</b> and contents in <b>File list</b> will be saved into the analysis template for future use. For <b>Batch Processing Mode</b> set to <b>Repeatedly Import into Active Window</b>, the analysis template will be saved to UFF by default. For <b>Batch Processing Mode</b> set to <b>Load Analysis Template</b>, it will update the original template (in this case the analysis template should not be in Origin installation folder or subfolder, otherwise it will be saved to UFF).
</p>
<table class="note">

<tr>
<td><b>Note:</b>
<ol><li> The batch processing settings will be saved only when open the <b>Batch Processing</b> dialog. If running batchprocessing X-Function from scripts, the settings will not be saved.</li>
<li> If you want to save the dialog settings to another path other than the default, you can set system variable @BST = -1 to open the <b>save batch processing dialog settings into analysis template</b> message box after clicking <b>OK</b> in the <b>Batch Processing</b> dialog, which allows you to choose whether to save the settings and where to save. You can set @BST by selecting <b>Tools: </b><a class="external text" href="../../UserGuide/UserGuide/Set_System_Variables_Dialog_Box.html">System Variables </a><b>.</b></li></ol>
<dl><dd><a  class="image"><img alt="UserGuide Batch Processing 002.png" src="../images/Batch_Processing/UserGuide_Batch_Processing_002.png?v=79113" width="537"  /></a></dd></dl>
</td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Batch_Processing/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>While not as flexible or powerful as the Batch Processing, you can "clone" import and analysis operations in the active workbook, using the procedure outlined in <a class="external text" href="../../Tutorial/Tutorial/Importing_Multiple_Files_into_Workbooks_Cloned_from_Active_Workbook.html">this tutorial</a>.
</p></td></tr></table>
<h2><a name="The_Batch_Processing_Dialog_Box"></a><span class="mw-headline">The Batch Processing Dialog Box</span></h2>
<p>To open, click <b>File</b>, and then click <b>Batch Processing</b>.
</p>
<table class="dialogcontroltable">

<tr>
<th> Batch Processing Mode
</th>
<td> Specifies how to perform batch processing.
<ul><li> <b>Repeatedly Import into Active Window</b>
<dl><dd> Repeatedly import data into the active workbook window, assuming the workbook has already been set up as an Analysis Template.</dd></dl></li>
<li> <b>Load Analysis Template</b>
<dl><dd> Load a specific Analysis Template workbook (.OGW) from disk.</dd></dl></li></ul>
</td></tr>
<tr>
<th> Analysis Template
</th>
<td> Available when <b>Batch Processing Mode</b> is set to <b>Load Analysis Template</b>. Use this to specify the analysis template for the batch processing.
</td></tr>
<tr>
<th> Export to
</th>
<td> Only available when active/loaded analysis template contains a sheet named <i><b>Bookmarks</b></i>. Use this option to specify which file type the analysis report to be exported, options are:
<ul><li><b>None</b> 
<dl><dd> Do not export files.</dd></dl></li>
<li><b>Word</b>
<dl><dd> Export to a Word file.</dd></dl></li>
<li><b>PDF</b>
<dl><dd> Export to a PDF file.</dd></dl></li>
<li><b>Word&amp;PDF</b>
<dl><dd> Export to both a Word and a PDF file.</dd></dl></li></ul>
</td></tr>
<tr>
<th> Word Template
</th>
<td> Only available when active/loaded analysis template contains a sheet named <i><b>Bookmarks</b></i>. Use this option to specify the Word template for reporting the batch analysis results.
</td></tr>
<tr>
<th> Export Path
</th>
<td> Only available when active/loaded analysis template contains a sheet named <i><b>Bookmarks</b></i>. Use this option to specify where to export batch analyzed results using bookmarks in a Word template. Note the Word and PDF files will be exported to same location.
</td></tr>
<tr>
<th> Export as<br /> multi-page File
</th>
<td> Check this box to combine all PDF or Word files into a single file.
</td></tr>
<tr>
<th> Data Source
</th>
<td> Data source can be
<ul><li> <b>Import Specified Files</b>
<dl><dd> Import data from specified files. If the analysis template includes Data Connector, <b>Data Source</b> must be <b>Import Specified Files</b>.</dd></dl></li>
<li> <b>Import All Files from Folder</b>
<dl><dd> Import all files from specified folder.</dd></dl></li>
<li> <b>Use Existing XY Datasets</b>
<dl><dd> Perform batch processing on <b>XY Range Data</b> in the current project. </dd></dl></li>
<li> <b>Use Existing XYZ Datasets</b>
<dl><dd> Perform batch processing on <b>XYZ Range Data</b> in the current project. </dd></dl></li>
<li> <b>Use Existing Worksheets</b>
<dl><dd> Perform batch processing on selected worksheets in the current project.</dd></dl></li></ul>
<p><br />This option will be useful for statistics tools that don't look at data. If you have set the worksheets up with same structure, selecting this option will copy worksheet contents to the analysis template and take the process one by one. 
</p>
<ul><li> <b>Use Existing Ranges</b>
<dl><dd> Perform batch processing on selected ranges in the current project.</dd></dl></li></ul>
</td></tr>
<tr>
<th> Use Import Setting in Workbook
</th>
<td> Only available when <b>Data Source</b> is <b>Import Specified Files</b>.  Specify whether to use the last data import settings.
</td></tr>
<tr>
<th> File List
</th>
<td> Available when <b>Import Specified Files</b> is used. Select data files for batch processing. *.dat, *.txt, *.csv, *.xls, *.xlsx, *.xlsm files are supported.
<p>Beginning with Origin 2018b, you can <a href="../../UserGuide/UserGuide/Adding_Existing_Graphs_Matrixs_as_Sheets.html#Embedding_Graphs_and_Matrices_in_Analysis_Templates" title="UserGuide:Adding Existing Graphs Matrixs as Sheets">embed matrices in workbooks, including <b>Analysis Templates</b></a> and these matrices can supply the source data that drive your batch analysis. Because matrices can store <a class="external text" href="../../QuickHelp/QuickHelp/What_is_the_difference_between_data_and_image.html">data or images</a>, you can import data files (*.dat, *.txt, etc.) to a matrix that is set to display in data mode or image mode; or you can import image files (*.jpg, *.tif, etc.). You can import files into matrices in either <b>Batch Processing Mode</b>.
</p>
</td></tr>
<tr>
<th> Folder
</th>
<td> Available when <b>Data Source</b> is <b>Import All Files from Folder</b>. Specify the folder for the imported files.
</td></tr>
<tr>
<th> File Extension
</th>
<td> Available when <b>Data Source</b> is <b>Import All Files from Folder</b>. Specify the extension for the imported files. It  supports multiple extensions separated by semicolon.
<p><i>For example:</i> <b>*.dat*; *.csv*</b>
</p>
</td></tr>
<tr>
<th> Input
</th>
<td> Available when <b>Data Source</b> is set to <b>Use Existing XY(Z) Datasets</b>. Specify the <b>XY(Z) Range</b> for analysis from anywhere in the project, such as the current sheet, current book, or any selection performed with the <b>Dataset Browser</b> tool.  (To access the Dataset Browser tool, click the <b>arrow</b> to the right of <b>Input </b>, and then click <b>Select Columns...</b> )
</td></tr>
<tr>
<th> Worksheets
</th>
<td> Available when <b>Data Source</b> is set to <b>Use Existing Worksheets</b>. Click the rightward-pointing arrow to filter by <b>Sheets in Book</b>, <b>Sheets in Folder</b>, <b>Sheets in Folder(Recursive)</b> or <b>Sheets in Project</b>. Alternately, you can choose Select Worksheets to open the <b>Sheet Browser</b>. <b>Reset</b> will clear the selection window.
</td></tr>
<tr>
<th> Fixed Range
</th>
<td> Available when <b>Data Source</b> is set to <b>Use Existing Ranges</b>. Specify the fixed ranges which will just be copied to the corresponding columns in the data sheet of template but do not take part in calculation during each processing loop.
</td></tr>
<tr>
<th> Batch Range
</th>
<td> Available when <b>Data Source</b> is set to <b>Use Existing Ranges</b>. Specify the batch ranges which are used as input for the calculation during batch processing.
</td></tr>
<tr>
<th> Dataset Identifier
</th>
<td> Specify whether to add a column with the Long Name "Dataset" to the Result Worksheet for identifying each analysis dataset.
<ul><li> If <b>None</b>, this column will not be added. </li>
<li> When <b>Data Source</b> is <b>Import Specified Files</b>, options are <b>File Name</b> plus the designated data sheet's displayed <a href="../../UserGuide/UserGuide/Displaying_Supporting_Data_in_Worksheet_Header_Rows.html" title="UserGuide:Displaying Supporting Data in Worksheet Header Rows">Column Label Rows</a>. </li>
<li> When <b>Data Source</b> is <b>Import All Files from Folder</b>, options are <b>File Name</b> plus the designated data sheet's displayed <a href="../../UserGuide/UserGuide/Displaying_Supporting_Data_in_Worksheet_Header_Rows.html" title="UserGuide:Displaying Supporting Data in Worksheet Header Rows">Column Label Rows</a>. </li>
<li> When <b>Data Source</b> is <b>Use Existing XY(Z) Datasets</b>, options are <b>File Name</b> plus the designated data sheet's displayed <a href="../../UserGuide/UserGuide/Displaying_Supporting_Data_in_Worksheet_Header_Rows.html" title="UserGuide:Displaying Supporting Data in Worksheet Header Rows">Column Label Rows</a>.</li>
<li> When <b>Data Source</b> is <b>Use Existing Worksheets</b>, options are <b>Range</b>, <b>Book Name</b> and <b>Sheet Name</b>.</li>
<li> When <b>Data Source</b> is <b>Use Existing Ranges</b>, options are <b>Range</b>, <b>Book Name</b> and <b>Sheet Name</b>.</li></ul>
</td></tr>
<tr>
<th> Designation
</th>
<td> This control is added when you set <b>Dataset Identifier</b> to a displayed <a href="../../UserGuide/UserGuide/Displaying_Supporting_Data_in_Worksheet_Header_Rows.html" title="UserGuide:Displaying Supporting Data in Worksheet Header Rows">Column Label Row</a> in the Analysis Template (not available when <b>Mode</b> = <b>Repeatedly Import...</b> and <b>Source</b> = <b>Import Specified Files</b> or <b>Import All Files from Folder</b>).
<p>Use to specify which column supplies the dataset identifier. Default <b>&lt;auto&gt;</b> uses the current setting. 
</p>
</td></tr>
<tr>
<th> Data Sheet(s)
</th>
<td> Specify the name of the sheet in the Analysis Template into which the raw data should be imported. If there are multiple data sheets in the Template, option <b>&lt;auto&gt;</b> should be selected so that grouped files can be imported sequentially into corresponding data sheets. Furthermore, there is another option <b>&lt;custom&gt;</b> which can be used to add and remove the data sheets found by the default option <b>&lt;Auto&gt;</b>.
<p>Files can be sorted by Name, Size or Date by clicking column headings in the lower panel of the <b>Open</b> dialog, when selecting files to import (under <b>Data Source</b>).
Note that you can save import settings, such as custom ASCII import settings or Import Wizard filters, to the data sheet in your Analysis Template. See <a href="../../UserGuide/UserGuide/Customizing_the_ASCII_Import_Options.html" title="UserGuide:Customizing the ASCII Import Options">saving ASCII settings</a> and <a href="../../UserGuide/UserGuide/Import_Wizard_Save_Filters_Page_(All_Data_Types).html" title="UserGuide:Import Wizard Save Filters Page (All Data Types)">Save Filters page</a> for more details.
</p>
</td></tr>
<tr>
<th> Result Sheet
</th>
<td> Specify a <b>Result Sheet</b> (optional) in the Analysis Template, to contain the information you want to summarize for each dataset or file processed by the Batch Processing tool. When <b>Result Sheet</b> is <i>&lt;none&gt;</i>, <b>Data Identifier</b> is disabled.
</td></tr>
<tr>
<th> Output Sheet
</th>
<td> Content from the <b>Result Sheet</b> will be appended to the <b>Output Sheet</b> specified in this field:
<ul><li> The default -- <b>[Summary]Results&lt;new template:=BatchResult&gt;!</b> -- writes output to sheet named <b>Results</b> in a book created from the <b>BatchResult</b> template that resides in the Origin program folder.</li>
<li> Choosing <b>&lt;new&gt;</b> from the flyout menu writes output to an Output Sheet in the active workbook or if no workbook exists, to a new workbook.</li>
<li> Choosing <b>[&lt;new&gt;]&lt;new&gt;</b> from the flyout menu writes output to an Output Sheet in a new workbook.</li>
<li> Choosing an existing sheet writes output to that sheet.</li></ul>
<p>When <b>Result Sheet</b> is <i>&lt;none&gt;</i>, <b>Output Sheet</b> is unavailable.
</p>
<table class="note">

<tr>
<td><b>Note:</b> When (1) <b>Batch Processing Mode</b> = <i>Load Analysis Template</i>, (2) <b>Data Source</b> = <i>Import Specified Files</i> and (3) <b>Output Sheet</b> = <i>[Summary]Results&lt;new template:=BatchResult&gt;!</i>, the BatchResult template will show three buttons in the spacer at the top of the window:
<ul><li> <b>Open Book(s)</b>: If you enable <b>Delete Intermediate Workbook</b> (see next), then later decide you need that data, you can highlight corresponding rows in the <i>Results</i> sheet and click this button to regenerate deleted books.</li>
<li> <b>Reprocess</b>: Click this button to re-run import of selected files and update results when there have been changes to external data files.</li>
<li> <b>Update</b>: Click this button to update results for selected files when something is changed on the input side of your analysis (e.g. masking of data in your data sheets).</li></ul>
</td></tr></table>
</td></tr>
<tr>
<th> Delete Intermediate Workbook
</th>
<td>
<p>Specify whether to delete the intermediate analysis outputs after the process. 
</p><p>See the "Note" under <b>Output Sheet</b>, above.
</p>
</td></tr>
<tr>
<th> Options
</th>
<td> Including:
<ul><li><b>Starting Row of Output Sheet</b>
<dl><dd> Specify the beginning row in the Output sheet to append results. </dd></dl></li>
<li> <b>Clear Output Sheet on Start</b>
<dl><dd> Clear the output sheet when starting batch processing. Clear this check box if you are repeating the analysis on a new set of files or datasets and you want the summary information appended to existing summary information from previous batch analysis.</dd></dl></li>
<li> <b>Append Label Rows</b>
<dl><dd> This check box is unselected by default. It is used to specify whether append the label rows to the column cells below the column label rows. </dd>
<dd> When output sheet is Excel sheet, as there is no column label row at the beginning of sheet, you can use this option to append the labels to the column cells. </dd></dl></li>
<li> <b>Append by</b>
<dl><dd> Specify how to append the analysis results, by <b>Rows</b> or by <b>Columns</b> For <b>Rows</b> option, see <b>Output Sheet</b> setting, above. When you choose the <b>Columns</b> option, a user-defined parameter row labeled <i>Dataset ID</i>, will be added to identify the data source.</dd></dl></li></ul>
<dl><dd><dl><dd><a  class="image"><img alt="BatchProcess Append by Cols.png" src="../images/Batch_Processing/BatchProcess_Append_by_Cols.png?v=79218" width="443"  /></a></dd></dl></dd></dl>
</td></tr>
<tr>
<th>Script
</th>
<td>Including:
<ul><li> <b>Script Before Each Process</b>
<dl><dd> LabTalk script to run before each file or dataset has been processed. Note that:</dd>
<dd><b>fname$</b> refers to the i-th file</dd>
<dd><b>_rx</b> refers to the range of i-th x dataset</dd>
<dd><b>_ry</b> refers to the range of i-th y dataset</dd>
<dd><b>_skip</b> determines if i-th file/dataset will be skipped</dd>
<dd><b>_i1</b> refers to the starting row index of the i-th dataset</dd>
<dd><b>_i2</b> refers to the ending row index of the i-th dataset</dd></dl></li>
<li> <b>Script after Each Process</b>
<dl><dd> LabTalk script to run after each file or dataset has been processed. Note that:</dd>
<dd> <b>_i</b> refers to the index of i-th file/dataset</dd>
<dd> <b>_book$</b> refers to the i-th book name</dd>
<dd> Variable <b>i</b>  and <b>__BATCHBOOK$</b> defined in earlier version are replaced by <b>_i</b> and <b>_book$</b>, respectively.</dd></dl></li>
<li> <b>Script at the End</b>
<dl><dd> LabTalk script to run at the end of the process.</dd></dl></li></ul>
</td></tr></table>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<h3><a name="Example_1:_Import_.DAT_files_and_perform_nonlinear_curve_fitting"></a><span class="mw-headline">Example 1: Import .DAT files and perform nonlinear curve fitting</span></h3>
<p>In this example, we will import three .dat files and perform a nonlinear curve fitting.
</p>
<ol><li>On the main menu, click <b>File</b>, and then click <b>Batch Processing...</b> to open the <b>Batch Processing</b> dialog.</li>
<li>Make sure <b>Load Analysis Template</b> is selected. Click the <a  class="image"><img alt="BatchBrowseButton.png" src="../images/Batch_Processing/BatchBrowseButton.png?v=24091" width="17"  /></a> button to the right of <b>Analysis Template</b>. Navigate to the Origin installation folder, and then <i>\ Samples\ Curve Fitting</i> to select <i>Linear Regression.ogw</i>.</li>
<li>Make sure <b>Data Source</b> is set to <b>Import From Files</b>. Click the <a  class="image"><img alt="BatchBrowseButton.png" src="../images/Batch_Processing/BatchBrowseButton.png?v=24091" width="17"  /></a> button to the right of <b>File List</b>, and then navigate to <i>\ Samples\ Curve Fitting</i>  to add <i>Sensor01.dat</i>, <i>Sensor02.dat</i>, and <i>Sensor03.dat</i>. Set the remaining dialog values as in the image below:
<dl><dd><a  class="image"><img alt="BatchProcessingDialgo.png" src="../images/Batch_Processing/BatchProcessingDialgo.png?v=68802" width="656"  /></a></dd></dl></li>
<li>Click <b>OK</b> to process the three .dat files and output statistics to a Result Sheet.
<dl><dd><a  class="image"><img alt="BatchProcessingResults.png" src="../images/Batch_Processing/BatchProcessingResults.png?v=65941" width="597"  /></a></dd></dl></li></ol>
<h3><a name="Example_2:_Perform_batch_analysis_on_groups_of_CSV_files"></a><span class="mw-headline">Example 2: Perform batch analysis on groups of CSV files</span></h3>
<p><a class="external text" href="../../Tutorial/Tutorial/Batch_Processing_Grouped_Datasets_Using_Multi_Data_Sheets_Analysis_Template.html">This Tutorial</a> illustrates how to perform batch analysis on grouped datasets using an analysis template with multiple data sheets.
</p>
<h3><a name="Example_3:_Perform_batch_analysis_and_create_reports_using_a_custom_MS_Word_template"></a><span class="mw-headline">Example 3: Perform batch analysis and create reports using a custom MS Word template</span></h3>
<p><a class="external text" href="../../Tutorial/Tutorial/Batch_Processing_with_Word_Template_for_Reporting.html">This tutorial</a> illustrates how to perform batch analysis with Word template for reporting.
</p>
<h3><a name="Example_4:_Perform_batch_processing_on_worksheets_in_your_project_file"></a><span class="mw-headline">Example 4: Perform batch processing on worksheets in your project file</span></h3>
<p>If you have already imported source data into multiple worksheets in the project, or you want to perform batch processing on multiple worksheets which are the intermediate results of pre-processing, <b>Data Source</b> = <b>Use Existing Worksheets</b> is used. The following example shows you how to perform batch processing on mulitple worksheets.
</p><p>We use Excel file <i>HouseholdCareSamples.xls</i> under folder <i>&lt;Origin installation folder&gt;\Origin2018\Samples\Statistics\</i> in this example. The Excel file contains multiple worksheets, each has the cleaning product stocks of a super market. We are going to calculate stocks of different kinds of every market and summarize them in a result sheet.
</p><p><font color="blue">We need to prepare the analysis template first</font>
</p>
<ol>
<li>Select <b>Data: Import from File: Excel(XLS, XLSX, XLSM)...</b> from the main menu. Specify as follow and click <b>OK</b> 
<ul><li>Browse and select <i>&lt;Origin installation folder&gt;\Origin2018\Samples\Statistics\HouseholdCareSamples.xls</i> for <b>File Name</b>. </li>
<li>Expand <b>File Info: File Sheet(s)</b> and select only <i>HQ Family Mart</i> to import the first sheet of the file. </li>
<li>Expand <b>Header Lines</b> branch. Set <b>Number of Subheader Lindes</b> to 1 and <b>Long Names</b> to 1 to set the first line as Long Name, </li></ul>
<li>With the imported <b>HQ Family Mart</b> worksheet active, highlight col("Number") and select <b>Statistics: Descriptive Statistics: Statistics on Columns</b>. In the dialog that opens, specify as follow and click <b>OK</b>.
<ul><li>On the Input tab, select column <b>E(Y): Category</b> for <b>Group</b>,</li>
<li>On the Quantities tab, make sure <b>N total</b>, <b>Sum</b>, <b>Minimum</b>, <b>Median</b> and <b>Maximum</b> are checked and uncheck <b>Mean</b> and <b>Standard Deviation</b>.</li></ul>
<li>The <i>DescStatsQuantities</i> worksheet is the result sheet we want. Rename it to <i>StatsResult'</i>. And rename <i>HQ Family Mart</i> worksheet to <i>Data</i>. Right click on the title bar of the workbook window and select <b>Sav as Analysis Template</b> to save it to <i>MyDesStats.ogwu</i>.
</ol>
<p><font color="blue">We can then import the whole Excel file and perform batch processing.</font>
</p>
<ol>
<li>Select <b>Data: Import from File: Excel(XLS, XLSX, XLSM)...</b> from the main menu to import file <i>&lt;Origin installation folder&gt;\Origin2018\Samples\Statistics\HouseholdCareSamples.xls</i>. Specify as follow and click <b>OK</b>.
<ul><li>Set <b>Multi-File (except 1st) Import Mode</b> to <b>Start New Sheets</b>, *Expand <b>Header Lines</b> branch. Set <b>Number of Subheader Lindes</b> to 1 and <b>Long Names</b> to 1,</li>
<li>check <b>Apply Header to All Sheets</b>. </li></ul>
<li>With the imported workbook active, select <b>File: Batch Processing...</b> from the main menu to open the <b>Batch Processing</b> dialog.
<li>Make sure Load Analysis Template is selected. Click <a  class="image"><img alt="BatchBrowseButton.png" src="../images/Batch_Processing/BatchBrowseButton.png?v=24091" width="17"  /></a> button to the right of <b>Analysis Template</b>, and then select the analysis template we saved in the previous steps.
<li>Change <b>Data Source</b> to <b>Use Existing Worksheets</b>. Click the triangle button of <b>Worksheet</b> and select <b>Sheets in Book</b> from the fly-out menu to add all sheets. 
<li>Set <b>Dataset Identifier</b> to <b>Sheet Name</b>, Data Sheet(s) to <i>Data</i> and <b>Result Sheet</b> to <b>StatsResult</b>. Click <b>OK</b> to process the 9 sheets and output statistics to a Result Sheet.
</ol>
<h3><a name="Example_5:_Perform_batch_processing_on_datasets_grouped_by_worksheet_column"></a><span class="mw-headline">Example 5: Perform batch processing on datasets grouped by worksheet column</span></h3>
<p>Select <b>Help:Origin Central</b> - <b>Analysis Samples</b> tab, set <b>Samples in</b> to Batch Processing, and then click <b>Batch Processing Grouping Columns</b> to see an example of how to use multiple ranges with grouping info as input to perform batch statistics.
</p>

