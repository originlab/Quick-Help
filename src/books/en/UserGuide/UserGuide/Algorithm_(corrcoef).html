<h1 class="firstHeading">17.1.11.2 Algorithm (Correlation Coefficient)</h1><p class='urlname' style='display: none'>CorrCoef-Algorithm</p>
<p>There are a number of coefficients which are appropriate to use under different circumstances. Among them, the most frequently-used one is Pearson's product moment correlation coefficient.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Correlation_Coefficients"><span class="tocnumber">1</span> <span class="toctext">Correlation Coefficients</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Pearson.27s_product_moment_correlation_coefficient"><span class="tocnumber">1.1</span> <span class="toctext">Pearson's product moment correlation coefficient</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Spearman_Rank_Correlation_Coefficient"><span class="tocnumber">1.2</span> <span class="toctext">Spearman Rank Correlation Coefficient</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Kendall_correlation_coefficient"><span class="tocnumber">1.3</span> <span class="toctext">Kendall correlation coefficient</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="#Significance_of_R"><span class="tocnumber">2</span> <span class="toctext">Significance of R</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#Pearson_and_Spearman_types"><span class="tocnumber">2.1</span> <span class="toctext">Pearson and Spearman types</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Kendall_type"><span class="tocnumber">2.2</span> <span class="toctext">Kendall type</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="Correlation_Coefficients"></a><span class="mw-headline">Correlation Coefficients</span></h2>
<h3><a name="Pearson.27s_product_moment_correlation_coefficient"></a><span class="mw-headline">Pearson's product moment correlation coefficient</span></h3>
<p>Pearson's  product moment correlation coefficient measures the linear relations between two variables.
</p><p>Let <img src="../images/Algorithm_(corrcoef)/math-ea2fb250ea955e9548d7d78941d80ec0.png?v=0" title="\sigma _x\," alt="\sigma _x\," class="tex"/> .and <img src="../images/Algorithm_(corrcoef)/math-5b7011069d54d7494a581c5a39afc3a0.png?v=0" title="\sigma _y\," alt="\sigma _y\," class="tex"/> be the standard deviations of two random variables <i>X</i> and<i> Y</i> respectively. Then the Pearson's  product moment correlation coefficient between the variables is
</p><p><img src="../images/Algorithm_(corrcoef)/math-28e6ed2438f8ba9a554b7c2c5bfdcbbb.png?v=0" title="\rho _{x,y}=\frac{cov(X,Y)}{\sigma _x\sigma _y}=\frac{E((X-E(X))(Y-E(Y)))}{\sigma _x\sigma _y}" alt="\rho _{x,y}=\frac{cov(X,Y)}{\sigma _x\sigma _y}=\frac{E((X-E(X))(Y-E(Y)))}{\sigma _x\sigma _y}" class="tex"/>
</p><p>where <i>E(.)</i> denotes the expected value of the variable, and cov(.) means covariance.
</p><p>To use this method, one should make sure that the interval data comes from paired observations, and that the variables are normally distributed. The data should not contain any extreme values, because they are apt to affect the result. Pearson's  product moment correlation coefficient could sometimes be misleadingly small when the variables have a non-linear relationship.
</p>
<h3><a name="Spearman_Rank_Correlation_Coefficient"></a><span class="mw-headline">Spearman Rank Correlation Coefficient</span></h3>
<p>Spearman Rank correlation coefficient is a non-parametric measure; therefore, it is suitable for data that is not normally distributed. It works better in detecting a non-linear relationship between two variables. It can be defined as
</p><p><img src="../images/Algorithm_(corrcoef)/math-30e2b8b2169b7c14da1f976316e7c59c.png?v=0" title="r^{\prime }=1-6\sum \frac{d^2}{N(N^2-1)}" alt="r^{\prime }=1-6\sum \frac{d^2}{N(N^2-1)}" class="tex"/>
</p><p>where <i>d</i> is the difference in statistical rank of corresponding variables.
</p><p>Because statistical rank is just the ordinal number of a value in a list, Spearman Rank correlation coefficient can be computed even when actual values of the variables are unknown.
</p>
<h3><a name="Kendall_correlation_coefficient"></a><span class="mw-headline">Kendall correlation coefficient</span></h3>
<p>Kendall correlation coefficient, or Kendall tau, is equivalent to Spearman R in terms of their assumptions and statistical power. However, Kendal correlation coefficient has a more intuitive interpretation. And its algebraic structure is simpler. Furthermore, it does not require ordering of the data before the computation.
</p><p>Kendall correlation coefficient can be computed by
</p><p><img src="../images/Algorithm_(corrcoef)/math-e77b5d7ffbaeb1048e2202d9f7dcec6c.png?v=0" title="t=\frac{C-D}{\sqrt{q}}" alt="t=\frac{C-D}{\sqrt{q}}" class="tex"/>
</p><p>where <i>C</i> is the number of concordant pairs (pairs of observations that have the same signs), <i>D</i> is the number of discordant pairs (pairs of observations that have opposite signs), and <i>q</i> is defined in <a href="#Significance_of_R">Significance Level of r</a>.
</p>
<h2><a name="Significance_of_R"></a><span class="mw-headline">Significance of R</span></h2>
<h3><a name="Pearson_and_Spearman_types"></a><span class="mw-headline">Pearson and Spearman types</span></h3>
<p>For <b>Pearson</b> and <b>Spearman</b> correlation types, let
</p>
<dl><dd><img src="../images/Algorithm_(corrcoef)/math-24747472afeca9759e13e01893745921.png?v=0" title="&#10;t = |r\sqrt{\frac{N-2}{1-r^2}}|&#10;" alt="&#10;t = |r\sqrt{\frac{N-2}{1-r^2}}|&#10;" class="tex"/></dd></dl>
<p>where r is the correlation of two variables and N is number of observations.
</p><p>Then t follows a t-distribution with N-2 degrees of freedom. The two-tailed significance level can be calculated as:
</p>
<dl><dd><img src="../images/Algorithm_(corrcoef)/math-ca08a21786c0a0775c6a839bc73e1a0b.png?v=0" title="&#10;p=2(1-\mbox{tcdf} (t,N-2))\;&#10;" alt="&#10;p=2(1-\mbox{tcdf} (t,N-2))\;&#10;" class="tex"/></dd></dl>
<h3><a name="Kendall_type"></a><span class="mw-headline">Kendall type</span></h3>
<p>For <b>Kendall</b> correlation type, let
</p>
<dl><dd><img src="../images/Algorithm_(corrcoef)/math-c939a27ffcf3bc1776bfe8fb5a0eac2c.png?v=0" title="&#10;z=\frac{r\sqrt{q}}{\sqrt{v}}&#10;" alt="&#10;z=\frac{r\sqrt{q}}{\sqrt{v}}&#10;" class="tex"/></dd></dl>
<p>where
</p>
<dl><dd><img src="../images/Algorithm_(corrcoef)/math-548bc5538f0ef9eacf0ae3c5be40f69c.png?v=0" title="v_0 = N(N-1)(2N+5)\;" alt="v_0 = N(N-1)(2N+5)\;" class="tex"/></dd>
<dd><img src="../images/Algorithm_(corrcoef)/math-5caaeb544cb4ccce475311401745a3c6.png?v=0" title="\tau = \sum_{k} t_k (t_k-1)\;" alt="\tau = \sum_{k} t_k (t_k-1)\;" class="tex"/></dd>
<dd><img src="../images/Algorithm_(corrcoef)/math-e6c7791706cf93f4232f2c8534736995.png?v=0" title="\tau_1 = \sum_{k} t_k (t_k-1)(t_k-2)\;" alt="\tau_1 = \sum_{k} t_k (t_k-1)(t_k-2)\;" class="tex"/></dd>
<dd><img src="../images/Algorithm_(corrcoef)/math-eb2c6e9601d25f02e8838ef730b5bd67.png?v=0" title="\tau_2 = \sum_{k} t_k (t_k-1)(2t_k+5)\;" alt="\tau_2 = \sum_{k} t_k (t_k-1)(2t_k+5)\;" class="tex"/></dd>
<dd><img src="../images/Algorithm_(corrcoef)/math-c9f02f1e1911eedbf05988df3ce43feb.png?v=0" title="t_k \mbox{ is the number of tied values in the kth group of ties for a variable.}\;" alt="t_k \mbox{ is the number of tied values in the kth group of ties for a variable.}\;" class="tex"/></dd>
<dd><img src="../images/Algorithm_(corrcoef)/math-a407e02e1a2d60aaea82067fef66b721.png?v=0" title="q=(N(N-1)/2-\tau(i)/2)(N(N-1)/2-\tau(j)/2)\;" alt="q=(N(N-1)/2-\tau(i)/2)(N(N-1)/2-\tau(j)/2)\;" class="tex"/></dd>
<dd><img src="../images/Algorithm_(corrcoef)/math-ca7363f711e3049973f2371b26b477d6.png?v=0" title="v=(v_0-\tau_2(i)-\tau_2(j))/18 + \tau (i)\tau (j)/(2N(N-1)) + \tau_1 (i)\tau_1 (j)/(9N(N-1)(N-2)) \;" alt="v=(v_0-\tau_2(i)-\tau_2(j))/18 + \tau (i)\tau (j)/(2N(N-1)) + \tau_1 (i)\tau_1 (j)/(9N(N-1)(N-2)) \;" class="tex"/></dd>
<dd><img src="../images/Algorithm_(corrcoef)/math-046af118cd5a4fed647d9ee0185f654a.png?v=0" title="r \mbox{ is the correlation between variable } i \mbox{ and variable } j. \;" alt="r \mbox{ is the correlation between variable } i \mbox{ and variable } j. \;" class="tex"/></dd></dl>
<p>Then <i>z</i> is approximated by a standard normal distribution. And the two-tailed significance level is:
</p>
<dl><dd><img src="../images/Algorithm_(corrcoef)/math-2edf21ee0d07e7b466bf4ebb5bfec769.png?v=0" title="&#10;p=2(1-\mbox{normcdf} (\mbox{abs} (z)))\;&#10;" alt="&#10;p=2(1-\mbox{normcdf} (\mbox{abs} (z)))\;&#10;" class="tex"/></dd></dl>






