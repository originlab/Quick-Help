<h1 class="firstHeading">15.3.4.4.1 A Simple Example</h1><p class='urlname' style='display: none'>ScriptEx-FitFuncBuilder-NewFitFunc</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Summary"><span class="tocnumber">1</span> <span class="toctext">Summary</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#What_you_will_learn"><span class="tocnumber">2</span> <span class="toctext">What you will learn</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Steps"><span class="tocnumber">3</span> <span class="toctext">Steps</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Where_to_Access_the_User-defined_Function"><span class="tocnumber">4</span> <span class="toctext">Where to Access the User-defined Function</span></a></li>
</ul>
</div>

<h2><a name="Summary"></a><span class="mw-headline">Summary</span></h2>
<p>This tutorial will show you how to create a fitting function with the <b>Fitting Function Builder</b>.
</p><p>Minimum Origin Version Required: <b>Origin 8.5 SR0</b>
</p>
<h2><a name="What_you_will_learn"></a><span class="mw-headline">What you will learn</span></h2>
<ul><li>How to define a peak fitting function</li>
<li>How to write function body</li>
<li>How to write initialization codes</li>
<li>How to set bounds for parameters</li></ul>
<p><br />
</p>
<h2><a name="Steps"></a><span class="mw-headline">Steps</span></h2>
<ol><li>In Origin's main menu, click <b>Tools</b>, and then click <b>Fitting Function Builder</b> to open the tool. Click <b>Create a New Function</b> on the first (<b>Goal</b>) page, and then click <b>Next</b> to go to the <b>Name and Type</b> page.</li>
<li>On the <b>Name and Type</b> page, we will create a category for the new fitting function, then name the function and select a <b>Function Type</b>.
<ul><li>Click <b>New</b> to open the <b>Category Name</b> dialog, and input <b>MyPeakFitting</b> as the new category name. </li>
<li>Input <b>AsymmetricGauss</b> in the <b>Function Name</b> edit box.</li>
<li>Select <b>Origin C</b> from the <b>Function Type</b> list. You should find that the <b>Hints</b> in the left panel have updated accordingly. </li>
<li>Click the <b>Next</b> button to go to the <b>Variables and Parameters</b> page.</li></ul></li>
<li>On the <b>Variables and Parameters</b> page, we will do the following:
<ul><li>Input <b>x</b> and <b>Y</b> as the independent variable and the dependent variable. </li>
<li>Input <b>y0</b>,<b>xc</b>,<b>sig1</b>,<b>sig2</b> and <b>A</b> in the <b>Parameters</b> edit box. </li>
<li>Enable the <b>Peak Function</b> box so we can use this function for replica fitting in the <b>NLFit</b> tool or fitting peaks in the <b>Peak Analyzer</b>. ( <b>Note:</b> Before using it in the <b>Peak Analyzer</b>, make sure you have shared this function to the <b>PFW</b> category in the <b>Fitting Function Organizer</b>.)</li>
<li>Click <b>Next</b> to go to the <b>Function Body</b> page.</li></ul></li>
<li>On the <b>Function Body</b> page, we will input the function body and choose the peak attribute for each parameter. 
<ul><li>Click the cell in the <b>Peak Attribute</b> column and <b>xc</b> row of the <b>Parameters</b> tab.  Select <b>X Center</b> as the peak attribute. Then select <b>X Width</b> and <b>Amplitude/Area</b> for the parameters <b>sig1</b> and <b>A</b>.</li>
<li>Enter initial values and parameter meanings in the <b>Initial Value</b> and <b>Meaning</b> columns. </li>
<li>Copy and paste all of the following lines into the <b>Function Body</b> edit box.</li></ul>
<dl><dd><dl><dd><dl><dd><dl><dd><i>double B,sig;</i></dd>
<dd><i>B=A/(0.5*(sig1+sig2)*sqrt(2*pi));</i></dd>
<dd><i>sig = x&lt;xc&#160;? sig1:sig2;</i></dd>
<dd><i>y = y0 + B * exp(-0.5 *((x-xc)/sig)^2);</i></dd></dl></dd></dl></dd></dl></dd></dl>
<ul><li>After entering values for the independent variables, click the Evaluate button <a  class="image"><img alt="Ffb evaluate.png" src="../images/A_Simple_Example_to_Show_You_How_to_Create_A_New_Fitting_Function_with_The_Fitting_Function_Builder/Ffb_evaluate.png?v=23176" width="23"  /></a> to quickly check the fitting function.</li></ul>
<dl><dd><a  class="image"><img alt="Ffb tutorial 5.png" src="../images/A_Simple_Example_to_Show_You_How_to_Create_A_New_Fitting_Function_with_The_Fitting_Function_Builder/Ffb_tutorial_5.png?v=23351" width="788"  /></a></dd></dl></li>
<li>Click <b>Next</b> to go to the <b>Parameter Initialization Code</b> page, and enter the following codes into the <b>Initialization Code</b> edit box.
<dl><dd><dl><dd><dl><dd><dl><dd><i>double cent;</i></dd>
<dd><i>double sig;</i></dd>
<dd><i>xc = peak_pos(x_y_curve, &amp;sig, &amp;y0, NULL, &amp;A, &amp;cent);</i></dd>
<dd><i>sig1 = 0.42466 * (sig - 2 * (cent-xc));</i></dd>
<dd><i>sig2 = 0.42466 * (sig + 2 * (cent-xc));</i></dd></dl></dd></dl></dd></dl></dd>
<dd><a  class="image"><img alt="Ffb tutorial 7.png" src="../images/A_Simple_Example_to_Show_You_How_to_Create_A_New_Fitting_Function_with_The_Fitting_Function_Builder/Ffb_tutorial_7.png?v=23358" width="788"  /></a></dd></dl></li>
<li>Click <b>Next</b> to go the <b>Bounds and General Linear Constraints</b> dialog, and then set the dialog as in the image below:
<dl><dd><a  class="image"><img alt="Ffb tutorial 6.png" src="../images/A_Simple_Example_to_Show_You_How_to_Create_A_New_Fitting_Function_with_The_Fitting_Function_Builder/Ffb_tutorial_6.png?v=23352" width="788"  /></a></dd></dl></li>
<li>Click <b>Finish</b>.</li></ol>
<table class="note">

<tr>
<td><b>NOTE</b>: To define a peak function available in <a href="../../UserGuide/UserGuide/Quick_Peaks_Gadget.html" title="UserGuide:Quick Peaks Gadget">Quick Peaks Gadget</a> or <a href="../../UserGuide/UserGuide/Fitting_Multiple_Peaks_with_the_Multiple_Peak_Fit_Tool.html" title="UserGuide:Fitting Multiple Peaks with the Multiple Peak Fit Tool">Multiple Peak Fit tool</a>, the user-defined peak function must be in the category of <b>Peak Functions</b>.
</td></tr></table>
<h2><a name="Where_to_Access_the_User-defined_Function"></a><span class="mw-headline">Where to Access the User-defined Function</span></h2>
<ol><li>Use the user-defined function to perform curve fitting with the <b>Nonlinear Fitter</b>. For more details about the <b>Nonlinear Fitter</b>, please refer to <a href="../../UserGuide/Category/Nonlinear_Curve_Fitting.html" title="Category:Nonlinear Curve Fitting">Nonlinear Curve Fitting</a>.
<dl><dd><a  class="image"><img alt="Ffb tutorial 8.png" src="../images/A_Simple_Example_to_Show_You_How_to_Create_A_New_Fitting_Function_with_The_Fitting_Function_Builder/Ffb_tutorial_8.png?v=23355" width="605"  /></a></dd></dl></li>
<li>Find the function in the <b>Fitting Function Organizer</b>. For more details about the <b>Fitting Function Organizer</b>, please refer to <a href="../../UserGuide/Category/Origin_Fitting_Functions,_the_Fitting_Function_Organizer_and_the_Fitting_Function_Builder.html" title="Category:Origin Fitting Functions, the Fitting Function Organizer and the Fitting Function Builder">Fitting Function Organizer</a>.
<dl><dd><a  class="image"><img alt="Ffb tutorial 9.png" src="../images/A_Simple_Example_to_Show_You_How_to_Create_A_New_Fitting_Function_with_The_Fitting_Function_Builder/Ffb_tutorial_9.png?v=23356" width="632"  /></a></dd></dl></li>
<li> In the <b>Fitting Function Organizer</b>, right-click this function and select <b>Share To</b> to share this function to the <b>PFW</b> category. You can then use the function to perform peak fitting with the <b><a href="../../UserGuide/Category/Peak_Analyzer.html" title="Category:Peak Analyzer">Peak Analyzer</a></b>. 
<dl><dd><a  class="image"><img alt="Ffb pafit.png" src="../images/A_Simple_Example_to_Show_You_How_to_Create_A_New_Fitting_Function_with_The_Fitting_Function_Builder/Ffb_pafit.png?v=23390" width="726"  /></a></dd></dl></li></ol>






