<h1 class="firstHeading">16.15 Custom Filter</h1><p class='urlname' style='display: none'>Math-CustomFilter</p>
<p><br />
</p>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>The <a class="external text" href="../../XFunction/X-Function/Filter2.html">filter2</a> X-Function applies a square filter matrix to a source matrix. The filter matrix is centered over each cell of the source matrix.  
</p><p>For user-interface access to this function:
</p>
<ol><li>Create two matrixes with data. One will be the source matrix; the other is the filter matrix.</li>
<li>Activate the source matrix.</li>
<li>Select <b>Analysis: Mathematics:Custom Filter</b> from the Origin menu to open the <b>filter2</b> dialog.</li></ol>
<h2><a name="Dialog_Options"></a><span class="mw-headline">Dialog Options</span></h2>
<table class="dialogcontroltable">

<tr>
<th><b>Recalculate</b>
</th>
<td>
<p>Controls recalculation of analysis results
</p>
<ul><li><b>None</b> </li>
<li><b>Auto</b> </li>
<li><b>Manual</b>  </li></ul>
<p>For more information, see: <a class="external text" href="../../UserGuide/UserGuide/Recalculating_Analysis_Results.html">Recalculating Analysis Results</a>
</p>
</td></tr>
<tr>
<th>Input Matrix
</th>
<td>
<p>The input matrix object. 
</p><p>For help with range controls, see: <a class="external text" href="../../UserGuide/UserGuide/Specifying_Your_Input_Data.html">Specifying Your Input Data</a>
</p>
</td></tr>
<tr>
<th>Filter Matrix
</th>
<td>
<p>The filter matrix object.
</p>
</td></tr>
<tr>
<th>Padding Option
</th>
<td>
<p>The filter matrix may lie outside the source matrix at the edges. Choose a padding method (see Algorithm, below).
</p>
<ul><li><b>ZeroPadding </b>
<dl><dd>Pad with zeroes.</dd></dl></li>
<li><b>MapPadding</b>
<dl><dd>Map the corresponding inside cell values to outside. </dd></dl></li>
<li><b>RepeatPadding</b>
<dl><dd>Repeat edge values.</dd></dl></li></ul>
</td></tr>
<tr>
<th>Normalize
</th>
<td>
<p>If selected, normalize replacement value with weight of filter.
</p>
</td></tr>
<tr>
<th>Output Matrix
</th>
<td>
<p>The output matrix object.
</p><p>For help with the range controls, see: <a class="external text" href="../../UserGuide/UserGuide/Output_Results.html">Output Results</a>
</p>
</td></tr></table>
<h2><a name="Algorithm"></a><span class="mw-headline">Algorithm</span></h2>
<p>This function takes an <img src="../images/Custom_Filter/math-6d3fb1243abbe7c6cb01ba1a09e68ae8.png?v=0" title="N\!" alt="N\!" class="tex"/> by <img src="../images/Custom_Filter/math-6d3fb1243abbe7c6cb01ba1a09e68ae8.png?v=0" title="N\!" alt="N\!" class="tex"/> filter matrix and places it centered over each cell of the source matrix. For each cell in the filter, the function computes the product of the filter element with the overlaid cell of the original matrix, sums all of the products, normalizes to the weight of the filter (if selected), and then replaces the pixel in the original image with the recalculated value.
</p><p>For example:
</p><p><img src="../images/Custom_Filter/math-8d35f1a8663106d2e452a182bad4f2b3.png?v=0" title="\begin{pmatrix}2 &amp; 3&amp; 4 &amp;5\\3 &amp; 4 &amp;5 &amp;6\\4 &amp; 5 &amp;6 &amp;7\\5 &amp; 6 &amp; 7 &amp;8 \end{pmatrix}+\begin{pmatrix}1&amp; 1&amp; 1\\1&amp; 2&amp;1 \\1 &amp; 1 &amp;1 \end{pmatrix}=\begin{pmatrix}1.4&amp; 2.4&amp; 3.1 &amp;2.5\\2.4 &amp; 4 &amp;5 &amp;3.9\\3.1 &amp; 5 &amp;6 &amp;4.6\\2.5 &amp; 3.9 &amp; 4.6 &amp;3.6 \end{pmatrix}" alt="\begin{pmatrix}2 &amp; 3&amp; 4 &amp;5\\3 &amp; 4 &amp;5 &amp;6\\4 &amp; 5 &amp;6 &amp;7\\5 &amp; 6 &amp; 7 &amp;8 \end{pmatrix}+\begin{pmatrix}1&amp; 1&amp; 1\\1&amp; 2&amp;1 \\1 &amp; 1 &amp;1 \end{pmatrix}=\begin{pmatrix}1.4&amp; 2.4&amp; 3.1 &amp;2.5\\2.4 &amp; 4 &amp;5 &amp;3.9\\3.1 &amp; 5 &amp;6 &amp;4.6\\2.5 &amp; 3.9 &amp; 4.6 &amp;3.6 \end{pmatrix}" class="tex"/>
</p><p>The value of cell(2,2) in the output matrix is:
</p><p><img src="../images/Custom_Filter/math-901c5a790cf8fc9ee5274c77d41e82b9.png?v=0" title="Cell(2,2)=\frac{2\times 1+3\times 1+4\times 1+3\times 1+4\times 2+5\times 1+4\times 1+5\times 1+6\times 1}{1+1+1+1+2+1+1+1+1}=4" alt="Cell(2,2)=\frac{2\times 1+3\times 1+4\times 1+3\times 1+4\times 2+5\times 1+4\times 1+5\times 1+6\times 1}{1+1+1+1+2+1+1+1+1}=4" class="tex"/>
</p><p>If the <b>Normalize</b> check box is selected, the overlaid cells' products will be normalized by the weight of the corresponding cell of the filter.
</p><p>When applying a filter to the edge of the source matrix, some part of the filter may lie outside the source matrix boundary. When this occurs, the user can opt to pad the area outside the source matrix with zeros (Zero Padding), by reflection padding (Map Padding), or repeating edge values (Repeat Padding).
</p>





