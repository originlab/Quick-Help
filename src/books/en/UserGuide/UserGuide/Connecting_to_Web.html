<h1 class="firstHeading">6.5.3 Connecting to Web</h1><p class='urlname' style='display: none'>Connect-to-Web</p>
<p><b>Connect to Web</b> builds connection between Origin worksheet and data file from an online path or a table on a webpage. Once the data source is changed, you can simply reimport the data to get everything update. 
</p>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Connecting_to_Web/Alert_icon.png?v=9649" width="57"  border="0" /></td><td><p>For <a class="external text" href="../../License/Category/Single-User_Node-Locked_License(License).html">Node-Locked</a> and <a class="external text" href="../../License/Category/Concurrent_License(License).html">Concurrent</a> users, <b>Connect to Web</b> cannot be used before you activate your Origin properly. Refer to <a class="external text" href="../../QuickHelp/QuickHelp/Why_my_Connect_to_Wed/Cloud_menu_grey_out.html">this FAQ</a> for details.
</p>
	</td>
	</tr>
	</table>
<p><br />
<span class='headerInParagraph'>To open Data Connector</span>
</p>
<ol><li> With a worksheet/matrix active, select menu <b>Data: Connect to Web</b> and further choose the desired file type. Many data types, including CSV, JSON, HTML table, Origin project, etc., are supported. You can also install the data connector App of new type from ‘’’Add New’’’ menu.</li></ol>
<p>The <b>Connect to Web</b> dialog will open. 
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Connecting_to_Web/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>Data imported by <b>Connect to Web</b> is cached for a time period equal to <a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#C"><b>@CFDT</b></a> seconds per 100kB of file size (e.g connected data in a 10MB file is cached for 900 * 100 = 90,000 sec or ~24 hr). Thus, re-import of connected data into the project will use cached data if the time period has not been exceeded. Once the time period is exceeded, the cached data are deleted thus allowing for the data to be refreshed on import. To manually clear this cached data, see <a class="external text" href="../../LabTalk/LabTalk/Delete_(command).html#-web.3B_Clear_the_URL-to-File_cache_used_by_Web_Connectors_.28Data:_Connect_to_Web.29"><b>delete -web</b></a>
</p></td></tr></table>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Basic_operation"><span class="tocnumber">1</span> <span class="toctext">Basic operation</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#HTML_Connector_Options"><span class="tocnumber">1.1</span> <span class="toctext">HTML Connector Options</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-3"><a href="#Advanced_operation"><span class="tocnumber">2</span> <span class="toctext">Advanced operation</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#URL_Parts"><span class="tocnumber">2.1</span> <span class="toctext">URL Parts</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#POST_Data"><span class="tocnumber">2.2</span> <span class="toctext">POST Data</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Examples"><span class="tocnumber">3</span> <span class="toctext">Examples</span></a></li>
</ul>
</div>

<h2><a name="Basic_operation"></a><span class="mw-headline">Basic operation</span></h2>
<dl><dd><a  class="image"><img alt="Data connector from web basic.png" src="../images/Connecting_to_Web/Data_connector_from_web_basic.png?v=93508" width="511"  /></a></dd></dl>
<ol>
<li> In <b>Basic</b> mode, enter or paste a URL link in the <b>URL</b> edit box. To load a previously-accessed URL, click on <b>Recent URLs</b>. 
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Connecting_to_Web/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><ul><li> The <b>Recent URLs</b> will continue to list your connections, while <b>Sample URLs</b> will list some example connections in formats such as <b>CSV</b>, <b>HTML</b>, <b>JSON</b>, and <b>MATLAB</b>.</li></ul>
<dl><dd><a  class="image"><img alt="Connect to web dialog samples 2023.png" src="../images/Connecting_to_Web/Connect_to_web_dialog_samples_2023.png?v=93510" width="668"  /></a></dd></dl>
<ul><li> If desired, you can predefine LabTalk variables and then use the use them for substitutions in the URL link. The LabTalk variables must be percent encoded, for instance <pre class="lt" style="font-family:monospace;">https<span style="color: #000000;">:</span><span style="color: #008000;">//.....%(var$)...</span></pre>. You can see the actual URL string in the <b>URL Preview</b>. </li></ul>
<dl><dd> <a  class="image"><img alt="Data connector from web lt variable.png" src="../images/Connecting_to_Web/450px-Data_connector_from_web_lt_variable.png?v=82281" width="450"   /></a></dd></dl>
</td></tr></table>
</li>
<li> Click <b>OK</b> to connect to the web server.
<li> In the <b>Selection</b> dialog, select the desired table and click down-arrow button to add it to the bottom panel. Click <b>OK</b> to import. Note that you can use <a href="../../UserGuide/UserGuide/Data_Navigator.html#Connect_to_Multi-page_Files" title="UserGuide:Data Navigator">Data Navigator</a> to import other tables later.
</ol>
<table class="note">

<tr>
<td><b>Notes</b>:
<ul>
<li><b>Connect to Web</b> supports HTTP, HTTPS, and FTP (site must allow Anonymous login for both username and password).</li>
<li>To share data from DropBox. you can create a shared link and then get the link text to use for the Data Connector URL. In addition, you'll need to:
<ol><li> Modify the last part of the share link from <code>?dl=0</code> to <code>?dl=1</code> or the link won't work;</li>
<li> Set <a href="../../UserGuide/UserGuide/Set_System_Variables_Dialog_Box.html" title="UserGuide:Set System Variables Dialog Box">system variable</a> <code>@HTTPMR=1;</code> before importing data.</li></li></ol>
</ul>
</td></tr></table>
<h3><a name="HTML_Connector_Options"></a><span class="mw-headline">HTML Connector Options</span></h3>
<p>After import, click the Connector icon <a  class="image"><img alt="Dadta connector icon connect.png" src="../images/Connecting_to_Web/Dadta_connector_icon_connect.png?v=87163" width="16"  /></a> and select <b>Options</b> from the menu to open the <b>HTML Connector Options</b> dialog.
</p><p><a  class="image"><img alt="Connect to Web Options dialog.png" src="../images/Connecting_to_Web/Connect_to_Web_Options_dialog.png?v=94431" width="349"  /></a>
</p>
<table class="simple">
<tr>
<th> Run Website Scripts <br />Direct URL Access
</th>
<td>
<p>If the imported HTML table has website scripts (CSS, for example) and you want the imported data to look the same as what is on the website, you will need to check both boxes.
</p><p><b>Direct URL Access (without using a local file cache)</b> will connect to the URL link directly, otherwise a local file cache will be used.
</p>
</td></tr>
<tr>
<th width="22%">Partial Import Table Columns
</th>
<td>
<p>Partial import table columns using the same syntax as CSV Connector. 
</p><p>See <a href="../../UserGuide/Category/Partial_Importing_and_Re_Importing.html#Partial_Import_Controls_used_by_Import_From_File" title="Category:Partial Importing and Re Importing">description of "Custom" option item in the table</a> for syntax can be used in partial import.
</p>
</td></tr>
<tr>
<th> Use Partial Table Name
</th>
<td>
<p>Use partial table name as sheet name by following syntax.
</p>
<ul><li>space ( ) = "and".</li>
<li>colon(:) separates <b>From</b> and <b>To</b>.</li></ul>
<p><b>For example</b>, suppose the table name is "<i>The eight metropolitan statistical areas of the Commonwealth</i>"
</p>
<dl><dd><code>1 3 5 7 9</code> rename sheet as <i>Teegt</i></dd>
<dd><code>5:22</code> rename sheet as <i>eight metropolitan</i></dd></dl>
</td></tr></table>
<h2><a name="Advanced_operation"></a><span class="mw-headline">Advanced operation</span></h2>
<p>Some <b>Data Connector</b> web requests may be more complex and will require specifying <b>Advanced</b> settings in the <b>Connect to Web</b> dialog.
</p>
<h3><a name="URL_Parts"></a><span class="mw-headline">URL Parts</span></h3>
<p>In another example, the following URL consists or a series of variables in the form of <i>path components</i> or <i>parts</i>.
</p>
<pre>https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/2244</pre>
<p>In this case the <i>path components</i> can be broken down into:
</p>
<pre>
https://pubchem.ncbi.nlm.nih.gov/rest/pug
/compound
/cid
/2244
</pre>
<p>While it is not always strictly necessary to break down the URL into different parts, there may be times when it is appropriate to do so for clarity such as in the case above. In the <b>Connect to Web</b> dialog, those parts would be specified as illustrated below:
</p><p><a  class="image"><img alt="Data connector from web advance2.png" src="../images/Connecting_to_Web/450px-Data_connector_from_web_advance2.png?v=84354" width="450"   /></a>
</p><p>Observe that the <b>Add Part</b> button will add a new group of controls for specifying <b>URL Parts</b>. Also observe that, for each part, there are <b>up</b> and <b>down arrow</b>s for changing the order of the parts along with a <span style="font-size: 1.5em;"><b>&#xd7;</b></span> button for removing the part.
</p><p><b>Note:</b> LabTalk substitution is supported for URL parts.
</p><p>The optional <b>Command timeout in minutes</b> control allows the user to specify the number of minutes after which the request for data will abort. If left blank <i>(which is generally recommended)</i>, the request will take as long as necessary to complete or until the server decides to abort the request itself.
</p><p>The optional <b>HTTP request header parameters</b> control section is most likely the reason for using the <b>Advanced</b> settings. In addition to a URL, some web service APIs may require one or more arbitrary <a class="external text" href="https://en.wikipedia.org/wiki/List_of_HTTP_header_fields#Standard_request_fields" target="_blank">HTTP request headers</a> be provided with the request. <i>This is highly dependent on the requirements of the web service- there are no set rules in this regard.</i>
</p><p>Selecting from a <b>drop down list</b> of common request header names and then clicking the <b>Add</b> button generates two text box controls, one for the header name and one for the header value. Custom headers may also be added by choosing <b>--- Custom ---</b> from the drop down or simply overwriting the name of a header already added.
</p><p>For the URL provided in this particular example, an <b>Accept</b> header is required and it's value must be set to the <a class="external text" href="https://en.wikipedia.org/wiki/Media_type" target="_blank">media type</a> for the type of data to be return. In this case, it is <b>application/json</b>.
</p>
<table class="note">

<tr>
<td><b>Note:</b> A request header named <b>Authorization</b> is included in the list. <i><b> Do not assume that this header is automatically a password!</b></i> Not all web services require this header and it is up to the web service itself to define what the value should be. <i>There are no set rules with regard to what constitutes a proper value.</i>
</td></tr></table>
<h3><a name="POST_Data"></a><span class="mw-headline">POST Data</span></h3>
<p>Some web services expect a POST request with various parameters in the request body. They do this so that some parameters are not part of a easily visible URL; or if more info needs to be provided than can be put into a GET request.
</p><p>Enable this option by clicking the box. Added text becomes the "request body." There is no checking so the user is responsible for making sure the text is properly formatted for a POST request.
</p>
<dl><dd><a  class="image"><img alt="Web Connect Post Data.png" src="../images/Connecting_to_Web/Web_Connect_Post_Data.png?v=91071" width="746"  /></a></dd></dl>
<p><br />
<i><b>Example of a POST request:</b></i>
</p><p><b>URL</b>: <i><a class="external free" href="https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/property/MolecularFormula,MolecularWeight/CSV" target="_blank">https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/property/MolecularFormula,MolecularWeight/CSV</a></i><br />
<b>Request Body</b>:  <i>cid=1,2,3,4,5</i> <br />
<b>HTTP Request Header Parameters</b>: <i>Content-Type - application/x-www-form-urlencoded</i> <br />
<b>Header</b>: <i>Accept</i> <br />
</p><p>Expected response will be something like:<br />
ResponseBody: "CID","MolecularFormula","MolecularWeight"<br />
1,"C9H17NO4",203.238000<br />
2,"C9H18NO4+",204.246000<br />
3,"C7H8O4",156.137000<br />
4,"C3H9NO",75.111000<br />
5,"C3H8NO5P",169.073000<br />
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p><span class='headerInParagraph'>Example 1 </span>
</p><p><a class="external text" href="http://blog.originlab.com/data-import/data-connector-json?tdsourcetag=s_pcqq_aiomsg" target="_blank">Tutorial of Origin Web Data Connector</a>
</p><p><span class='headerInParagraph'>Example 2 </span>
</p><p>Open <i>Signal Processing - FFT Gadget with Data Connector.opju</i> to see an example of connecting web file for sunspot data:
</p>
<ol><li>Select <b>Help: Learning Center</b>.</li>
<li>In the dialog, activate Analysis Samples tab. Select <b>Signal Processing</b> from <b>Samples in</b> drop down list. </li>
<li>Double click on <b>FFT Gadget with Data Connector</b> to open it.</li></ol>


