<h1 class="firstHeading">16.10 Average Multiple Curves</h1><p class='urlname' style='display: none'>Math-AveCurve</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Overview"><span class="tocnumber">1</span> <span class="toctext">Overview</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#To_Use_Average_Multiple_Curves_Tool"><span class="tocnumber">1.1</span> <span class="toctext">To Use Average Multiple Curves Tool</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-3"><a href="#Dialog_Options"><span class="tocnumber">2</span> <span class="toctext">Dialog Options</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Algorithm"><span class="tocnumber">3</span> <span class="toctext">Algorithm</span></a></li>
</ul>
</div>

<h2><a name="Overview"></a><span class="mw-headline">Overview</span></h2>
<p><a  class="image"><img alt="Math Average Curve.png" src="../images/Average_Multiple_Curves/400px-Math_Average_Curve.png?v=71184" width="400"   /></a><br /><br />
The <b>Average Multiple Curves</b> tool can average or concatenate input curves, and output the result as XY Range. If the <b>Method</b> is set to <b>Concatenate</b>, the input curves will be concatenated to create a new curve. If the <b>Method</b> is set to <b>Average</b>, the input curves will be averaged to create a new curve. Other additional outputs such as standard deviations, standard errors, and number of points can be also outputted when the <b>Method</b> is set to <b>Average</b>.
</p>
<h5><a name="To_Use_Average_Multiple_Curves_Tool"></a><span class="mw-headline">To Use Average Multiple Curves Tool</span></h5>
<ol><li>Create a new worksheet with input data.</li>
<li>Activate the worksheet.</li>
<li>Select <b>Analysis: Mathematics: Average Multiple Curves</b> from the Origin menu to open the <b>avecurves</b> dialog box.</li>
<li>Choose options and click OK. The X-Function <a class="external text" href="../../XFunction/X-Function/Avecurves.html">avecurves</a> is called to perform the computation.</li></ol>
<h2><a name="Dialog_Options"></a><span class="mw-headline">Dialog Options</span></h2>
<table class="dialogcontroltable">

<tr>
<th><b>Recalculate</b>
</th>
<td>
<p>Controls recalculation of analysis results
</p>
<ul><li><b>None</b> </li>
<li><b>Auto</b> </li>
<li><b>Manual</b>  </li></ul>
<p>For more information, see: <a class="external text" href="../../UserGuide/UserGuide/Recalculating_Analysis_Results.html">Recalculating Analysis Results</a>
</p>
</td></tr>
<tr>
<th>Input
</th>
<td>
<p>Specifies multiple curves to be averaged or concatenated. 
</p><p>For help with range controls, see: <a class="external text" href="../../UserGuide/UserGuide/Specifying_Your_Input_Data.html">Specifying Your Input Data</a>
</p>
</td></tr>
<tr>
<th>Method
</th>
<td>
<p>Specifies the average method. 
</p>
<ul><li><b>Average</b>
<dl><dd>Average the input curves.</dd></dl></li>
<li><b>Concatenate</b>
<dl><dd>Concatenates the input curves. </dd></dl></li></ul>
</td></tr>
<tr>
<th>Averaged X
</th>
<td>
<p>Available only when <b>Method</b> = <b>Average</b>. Determines how X values will be computed for the averaged curve.
</p>
<dl><dd><b>Same as Source X </b>
<dl><dd>For each unique X in all datasets, all Y datasets that have values at that X are averaged. X values within <b>Tolerance for Common X Values</b> limit (see below) will be treated as the same point and averaged.</dd></dl></dd>
<dd><b>Common X Range </b>
<dl><dd>Create a set of “Number of Points” of equally spaced X values from the largest minimum X to the smallest maximum X and calculate an average of all interpolated Y. Use the Interpolate list (see below) to control interpolation method.  </dd></dl></dd>
<dd><b>Full X Range </b>
<dl><dd>Create a set of “Number of Points” of equally spaced X values from the smallest minimum X to the largest maximum X and calculate an average of all interpolated Y. Use the Interpolate list (see below) to control interpolation method. </dd></dl></dd>
<dd><b>Custom </b>
<dl><dd>Create a set of “Number of Points” of equally spaced X values where you define the minimum and maximum X and calculate an average of all interpolated Y. Use the Interpolate list (see below) to control interpolation method. </dd></dl></dd>
<dd><b>Follow Curve Trace </b>
<dl><dd>Create a set of “Number of Points” of trace interpolated X values and calculate an average of all interpolated Y. Use the Interpolate list to control interpolation method. This method is used with cyclic or periodic data. </dd></dl></dd></dl>
</td></tr>
<tr>
<th>Tolerance for Common X Values
</th>
<td>
<p>Available only when <b>Same as Source X</b> is selected for <b>Averaged X</b>. Values of X within the tolerance, will be averaged. 
</p>
</td></tr>
<tr>
<th>Number of Points
</th>
<td>
<p>It is available when <b>Averaged X</b> is not set to <b>Same as Source X</b>. It specifies the number of points of the interpolated curves. It computes a number automatically if the nearby <b>Auto</b> checkbox is enabled. You can also disable the <b>Auto</b> checkbox and specify the values by yourself. 
</p>
</td></tr>
<tr>
<th>X Minimun
</th>
<td>
<p>Editable only when <b>Custom</b> is selected for <b>Averaged X</b> (read-only for <b>Common X Range, Full X Range</b>). Specifies the minimum X value of the averaged curve. Computes a number automatically if the <b>Auto</b> check box is selected. Alternately, clear the <b>Auto</b> check box and enter a value. 
</p>
</td></tr>
<tr>
<th>X Maximum
</th>
<td>
<p>Editable only when <b>Custom</b> is selected for <b>Averaged X</b> (read-only for <b>Common X Range, Full X Range</b>). Specifies the maximum X value of the averaged curve. Computes a number automatically if the <b>Auto</b> check box is selected. Alternately, clear the <b>Auto</b> check box and enter a value. 
</p>
</td></tr>
<tr>
<th>Interpolate
</th>
<td>
<p>Available only when <b>Averaged X</b> is not set to <b>Same as Source X</b>. Determines how to interpolate the X values before the averaging the input curves. 
</p>
<dl><dd><b>Linear</b>
<dl><dd>Perform linear interpolation on the X values.</dd></dl></dd>
<dd><b>Spline</b>
<dl><dd>Perform spline interpolation on the X values.</dd></dl></dd>
<dd><b>B-Spline</b>
<dl><dd>Perform B-Spline interpolation on the X values.</dd></dl></dd></dl>
</td></tr>
<tr>
<th>No Extrapolation
</th>
<td>
<p>Available only when <b>Averaged X</b> is not set to <b>Full X Range</b>, <b>Custom</b>, and <b>Follow Curve Trace</b>. Determines whether to extrapolate the curves when the input curves have different X ranges. 
</p>
</td></tr>
<tr>
<th>Sort X
</th>
<td>
<p>Available only when <b>Method</b> = <b>Concatenate</b>. Determines how to sort the X values of the averaged curve. Y values will be reordered accordingly. 
</p>
<dl><dd><b>None </b>
<dl><dd>Do not sort the X values. </dd></dl></dd>
<dd><b>Ascending </b>
<dl><dd>Sort the X values from smallest to largest.</dd></dl></dd>
<dd><b>Descending</b>
<dl><dd>Sort the X values from largest to smallest.</dd></dl></dd></dl>
</td></tr>
<tr>
<th>Additional Output
</th>
<td>
<p>These options are only available when <b>Method</b> = <b>Average</b>.
</p>
<dl><dd><b>Std Dev</b> 
<dl><dd>Compute the standard deviation of the averaged curve. </dd></dl></dd></dl>
<dl><dd><b>Std Err</b>
<dl><dd>Compute the standard error of the averaged curve. </dd></dl></dd></dl>
<dl><dd><b>N</b>
<dl><dd>Compute the counts of input data points that correspond to each averaged X value. </dd></dl></dd></dl>
<dl><dd><b>Minimum</b>
<dl><dd>Output the minimum value. </dd></dl></dd></dl>
<dl><dd><b>Maximum</b>
<dl><dd>Output the maximum value. </dd></dl></dd></dl>
<dl><dd><b>SD times 2</b>
<dl><dd>Compute the standard deviation times 2.</dd></dl></dd></dl>
<dl><dd><b>SD times 3</b>
<dl><dd>Compute the standard deviation times 3.</dd></dl></dd></dl>
</td></tr>
<tr>
<th>Output
</th>
<td>
<p>Determine where to output results. The Long Name and Unit of input plots will be carried over if all the plots share the same.
</p><p>For help with the range controls, see: <a class="external text" href="../../UserGuide/UserGuide/Output_Results.html">Output Results</a>
</p>
</td></tr></table>
<h2><a name="Algorithm"></a><span class="mw-headline">Algorithm</span></h2>
<p>When the <b>Method</b> variable is set to <b>Concatenate</b>, all the input ranges are simply joined together and the data points from every input curve are concatenated one by one.
</p><p>When the <b>Method</b> variable is set to <b>Average</b>, the X and Y values of the averaged curve are computed. This X-Function supports five methods to compute the X values of the averaged curve. 
</p><p><b>Same as Source X</b>: The simplest way to compute X values is to specify a tolerance and then treat two X values, X1 and X2, as the same and averaging them if <img src="../images/Average_Multiple_Curves/math-c4f5400f133aaabbcde82615388b3c4e.png?v=0" title="\frac{\mid X1-X2\mid }{\mid X1\mid +\mid X2\mid }&lt;Tolerance" alt="\frac{\mid X1-X2\mid }{\mid X1\mid +\mid X2\mid }&lt;Tolerance" class="tex"/>. The corresponding Y values will not be averaged. The resulting X are sorted in ascending order. 
</p><p><b>Common X Range</b>, <b>Full X Range</b> and <b>Custom</b>: These three methods compute the X values of the averaged curve by performing linear, spline or B-spline interpolation on X range input. The first step is to determine what range of X values should be interpolated. Origin interpolates the input curves individually to establish a common set of X values. The corresponding Y values are then obtained by averaging Y values at each X. 
</p><p><b>Follow Curve Trace</b>: This method uses <a href="../../UserGuide/UserGuide/Trace_Interpolation_(OriginPro_Only).html" title="UserGuide:Trace Interpolation (OriginPro Only)">trace interpolation</a> to compute the XY values. This method is useful for interpolating periodic or cyclic data and can create a new curve whose shape is similar to that of the input curves.
</p>





