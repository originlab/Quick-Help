<h1 class="firstHeading">15.4.4 Residual Plot Analysis</h1><p class='urlname' style='display: none'>Residual-Plot-Analysis</p>
<p>The residual is defined as:
</p><p><img src="../images/Graphic_Residual_Analysis/math-04f8f09e63a269a044ceeee72a32143d.png?v=0" title="r_i=y_i-y=observed\,value\,of\,y-predicted\,value\,of\,y" alt="r_i=y_i-y=observed\,value\,of\,y-predicted\,value\,of\,y" class="tex"/>
</p><p>The regression tools below provide the options to calculate the residuals and output the customized residual plots:
</p>
<table class="tbl">

<tr>
<td>
<ul><li> <a href="../../UserGuide/UserGuide/Linear_Regression_Dialog.html#Residual_Plots" title="UserGuide:Linear Regression Dialog">Linear Fit</a></li></ul>
</td>
<td>
<ul><li> <a href="../../UserGuide/UserGuide/Linear_Fit_with_X_Error_Dialog.html#Residual_Plots" title="UserGuide:Linear Fit with X Error Dialog">Linear Fit with X Error</a></li></ul>
</td>
<td>
<ul><li> <a href="../../UserGuide/UserGuide/Polynomial_Regression_Dialog.html#Residual_Plots" title="UserGuide:Polynomial Regression Dialog">Polynomial Fit</a></li></ul>
</td></tr>
<tr>
<td>
<ul><li> <a href="../../UserGuide/UserGuide/Multiple_Linear_Regression_Dialog.html#Plots" title="UserGuide:Multiple Linear Regression Dialog">Multiple Linear Regression</a></li></ul>
</td>
<td>
<ul><li> <a href="../../UserGuide/UserGuide/Settings_Tab_Upper_Panel.html#Advanced" title="UserGuide:Settings Tab Upper Panel">Nonlinear Fit</a></li></ul>
</td></tr></table>
<h5><a name="To_perform_residual_analysis_in_the_fitting_tools"></a><span class="mw-headline">To perform residual analysis in the fitting tools</span></h5>
<p>All the fitting tools has two tabs, In the <b>Residual Analysis</b> tab, you can select methods to calculate and output residuals, while with the <b>Residual Plots</b> tab, you can customize the residual plots
</p>
<table class="noborder">

<tr style="vertical-align: top;">
<td><a  class="image"><img alt="Residual Analysis.png" src="../images/Graphic_Residual_Analysis/300px-Residual_Analysis.png?v=70768" width="300"   /></a>
</td>
<td><a  class="image"><img alt="Residual Plot.png" src="../images/Graphic_Residual_Analysis/300px-Residual_Plot.png?v=70769" width="300"   /></a>
</td></tr></table>
<p>Residual plots can be used to assess the quality of a regression. Currently, six types of residual plots are supported by the linear fitting dialog box:
</p>
<ul><li> <b>Residual</b> vs. <b>Independent</b></li>
<li> <b>Residual</b> vs. <b>Predicted Value</b></li>
<li> <b>Residual</b> vs. <b>Order of the Data</b></li>
<li> <b>Histogram of the Residual</b></li>
<li> <b>Residual Lag Plot</b></li>
<li><b>Normal Probability Plot of Residuals</b></li></ul>
<p>These residual plots can be used to assess the quality of the regression.  You can examine the underlying statistical assumptions about residuals such as constant variance, independence of variables and normality of the distribution. For these assumptions to hold true for a particular regression model, the residuals would have to be randomly distributed around zero. 
</p><p>Different types of residual plots can be used to check the validity of these assumptions and provide information on how to improve the model. For example, the scatter plot of the residuals will be disordered if the regression is good.  The residuals should not show any trend. A trend would indicate that the residuals were not independent. On the other hand, a histogram plot of the residuals should exhibit a symmetric bell-shaped distribution, indicating that the normality assumption is likely to be true.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#To_perform_residual_analysis_in_the_fitting_tools"><span class="tocnumber">1</span> <span class="toctext">To perform residual analysis in the fitting tools</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Checking_the_error_variance"><span class="tocnumber">2</span> <span class="toctext">Checking the error variance</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Checking_the_process_drift"><span class="tocnumber">3</span> <span class="toctext">Checking the process drift</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Checking_independence_of_the_error_term"><span class="tocnumber">4</span> <span class="toctext">Checking independence of the error term</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Checking_normality_of_variance"><span class="tocnumber">5</span> <span class="toctext">Checking normality of variance</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Improving_the_regression_model_using_residuals_plots"><span class="tocnumber">6</span> <span class="toctext">Improving the regression model using residuals plots</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Detecting_outliers_by_transforming_residuals"><span class="tocnumber">7</span> <span class="toctext">Detecting outliers by transforming residuals</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Residual_contour_plots_for_surface_fitting"><span class="tocnumber">8</span> <span class="toctext">Residual contour plots for surface fitting</span></a></li>
</ul>
</div>

<h2><a name="Checking_the_error_variance"></a><span class="mw-headline">Checking the error variance</span></h2>
<p>A residuals plot (see the picture below) which has an increasing trend suggests that the error variance increases with the independent variable; while a distribution that reveals a decreasing trend indicates that the error variance decreases with the independent variable. Neither of these distributions are constant variance patterns. Therefore they indicate that the assumption of constant variance is not likely to be true and the regression is not a good one. On the other hand, a horizontal-band pattern suggests that the variance of the residuals is constant.
</p>
<dl><dd><a  class="image"><img alt="Graphic Residual Analysis-1.png" src="../images/Graphic_Residual_Analysis/Graphic_Residual_Analysis-1.png?v=10726" width="476"  /></a></dd></dl>
<h2><a name="Checking_the_process_drift"></a><span class="mw-headline">Checking the process drift</span></h2>
<p>The <b>Residual</b> vs. <b>Order of the Data</b> plot can be used to check the drift of the variance (see the picture below) during the experimental process, when data are time-ordered. If the residuals are randomly distributed around zero, it means that there is no drift in the process.
</p><p><a  class="image"><img alt="Graphic Residual Analysis-2.jpg" src="../images/Graphic_Residual_Analysis/Graphic_Residual_Analysis-2.jpg?v=10728" width="434"  /></a>
</p>
<h2><a name="Checking_independence_of_the_error_term"></a><span class="mw-headline">Checking independence of the error term</span></h2>
<p>The Residual Lag Plot (see the picture below), constructed by plotting residual (<i>i</i>) against residual (<i>i</i>-1), is useful for examining the dependency of the error terms. Any non-random pattern in a lag plot suggests that the variance is not random.
</p><p><a  class="image"><img alt="Graphic Residual Analysis-3.jpg" src="../images/Graphic_Residual_Analysis/Graphic_Residual_Analysis-3.jpg?v=10730" width="392"  /></a>
</p><p><br />
If the data being analyzed is time series data (data recorded sequentially), the <b>Residual</b> vs. <b>Order of the Data</b> plot will reflect the correlation between the error term and time. Fluctuating patterns around zero will indicate that the error term is dependent.
</p><p><a  class="image"><img alt="Graphic Residual Analysis-4.jpg" src="../images/Graphic_Residual_Analysis/Graphic_Residual_Analysis-4.jpg?v=10731" width="430"  /></a>
</p><p><i>Residual Lag Plot showing that the error term is independent.</i>
</p><p><a  class="image"><img alt="Graphic Residual Analysis-3.jpg" src="../images/Graphic_Residual_Analysis/Graphic_Residual_Analysis-3.jpg?v=10730" width="392"  /></a>
</p><p><i><b>Residual plots for time series data</b></i>.
</p><p><a  class="image"><img alt="Graphic Residual Analysis-4.jpg" src="../images/Graphic_Residual_Analysis/Graphic_Residual_Analysis-4.jpg?v=10731" width="430"  /></a>
</p>
<h2><a name="Checking_normality_of_variance"></a><span class="mw-headline">Checking normality of variance</span></h2>
<p>The Histogram of the Residual can be used to check whether the variance is normally distributed.  A symmetric bell-shaped histogram which is evenly distributed around zero indicates that the normality assumption is likely to be true.  If the histogram indicates that random error is not normally distributed, it suggests that the model's underlying assumptions may have been violated.
</p><p><i><b>Histogram of the Residuals showing that the deviation is normally distributed.</b></i>
</p><p><a  class="image"><img alt="Graphic Residual Analysis-5.jpg" src="../images/Graphic_Residual_Analysis/Graphic_Residual_Analysis-5.jpg?v=10739" width="397"  /></a>
</p><p>A normal probability plot of the residuals can be used to check whether the variance is normally distributed as well. If the resulting plot is approximately linear, we proceed assuming that the error terms are normally distributed. The plot is based on the percentiles versus ordered residual, the  percentiles is estimated by 
</p><p><img src="../images/Graphic_Residual_Analysis/math-ec995bff3922b2290f85bed243de5eb3.png?v=0" title="\frac{(i-\frac{3}{8})}{(n+\frac{1}{4})}" alt="\frac{(i-\frac{3}{8})}{(n+\frac{1}{4})}" class="tex"/> 
</p><p>where <i>n</i> is the total number of dataset and  <i>i</i> is the <i>i</i> th data. The normal probability plot of the residuals is like this:
</p><p><i><b>Normal Probability Plot of the Residuals</b></i>
</p><p><a  class="image"><img alt="PP-PLOT.png" src="../images/Graphic_Residual_Analysis/PP-PLOT.png?v=46516" width="314"  /></a>
</p>
<h2><a name="Improving_the_regression_model_using_residuals_plots"></a><span class="mw-headline">Improving the regression model using residuals plots</span></h2>
<p>The pattern structures of residual plots not only help to check the validity of a regression model, but they can also provide hints on how to improve it. For example, a curved pattern in the <b>Residual vs. Independent</b> plot suggests that a higher order term should be introduced to the fitting model. 
</p><p><a  class="image"><img alt="Graphic Residual Analysis-6.png" src="../images/Graphic_Residual_Analysis/Graphic_Residual_Analysis-6.png?v=10741" width="400"  /></a>
</p><p>This is only one example and, certainly, there is much more that can be surmised from studying residual plot patterns.  We suggest that you refer to the statistical references given at the end of this chapter/section, for more information.
</p>
<h2><a name="Detecting_outliers_by_transforming_residuals"></a><span class="mw-headline">Detecting outliers by transforming residuals</span></h2>
<p>When looking for outliers in your data, it may be useful to transform the residuals to obtain <b>standardized</b>, <b>studentized</b> or <b>studentized deleted</b> residuals. These transformed residuals are computed as follows:
</p><p><i><b>Standardized</b></i>
</p><p><img src="../images/Graphic_Residual_Analysis/math-9ffd8a8883cc3fd6bfe38b2745f3338e.png?v=0" title="r_i^{\prime }=\frac{r_i}s" alt="r_i^{\prime }=\frac{r_i}s" class="tex"/>
</p><p><i><b>Studentized</b></i>
</p><p>Also known as internally studentized residual.
</p><p><img src="../images/Graphic_Residual_Analysis/math-3221975524454d794f9af389fbb5cf78.png?v=0" title="r_i^{\prime }=RI_i=\frac{r_i}{s\sqrt{1-h_i}}" alt="r_i^{\prime }=RI_i=\frac{r_i}{s\sqrt{1-h_i}}" class="tex"/>
</p><p><i><b>Studentized deleted</b></i>
</p><p>Also known as externally studentized residual.
</p><p><img src="../images/Graphic_Residual_Analysis/math-747d32a78c8f4a3a011fcf3515de7db5.png?v=0" title="r_i^{\prime }=RE_i=\frac{r_i}{s_{-i}\sqrt{1-h_i}}=RI_i\sqrt{\frac{n-p-1}{n-p-RI_i^2}}" alt="r_i^{\prime }=RE_i=\frac{r_i}{s_{-i}\sqrt{1-h_i}}=RI_i\sqrt{\frac{n-p-1}{n-p-RI_i^2}}" class="tex"/>
</p><p><br />
In the equations for the <b>Studentized</b> and <b>Studentized deleted</b> residuals, <img src="../images/Graphic_Residual_Analysis/math-57339b77b3af15427b7154f4daf8a223.png?v=0" title="h_i" alt="h_i" class="tex"/> is the <i>i</i>th diagonal element of the matrix, <i>P</i>:
</p><p><img src="../images/Graphic_Residual_Analysis/math-ec67346fb4efce792368cdc19156d0c2.png?v=0" title="P=F(F&#39;F)^{-1}F^{\prime }" alt="P=F(F&#39;F)^{-1}F^{\prime }" class="tex"/>
</p><p>where <i>F</i> is the partial derivatives matrix for a nonlinear regression model. 
</p><p>In a linear regression model, the independent matrix, X, is simply equal to <i>F</i>:
</p><p><img src="../images/Graphic_Residual_Analysis/math-609f90ce395d2346200e55f1a632bab0.png?v=0" title="P=X(X&#39;X)^{-1}X^{\prime }" alt="P=X(X&#39;X)^{-1}X^{\prime }" class="tex"/>
</p><p>As an example of the use of transformed residuals, standardized residuals rescale residual values by the regression standard error, so if the regression assumptions hold -- that is, the data are distributed normally -- about 95% data points should fall within 2σ around the fitted curve.  Consequently, 95% of the standardized residuals will fall between -2 and +2 in the residual plot.
</p><p>These variations of residual plots are very useful in detecting outliers. For example, in the Standardized Residual vs. Independent Plots, the residuals are rescaled by the regression standard error. If the regression assumption holds, that is, the data is distributed normally, about 95% data points should be located within 2σ around the fitted curve, and consequently, 95% of the standardized residuals will fall between -2 and +2, as shown in the graph below. 
</p><p><a  class="image"><img alt="Graphic Residual Analysis 7.png" src="../images/Graphic_Residual_Analysis/Graphic_Residual_Analysis_7.png?v=21511" width="319"  /></a>
</p><p>So residuals out of this range should be more closely examined, because these points may be outliers.
</p>
<h2><a name="Residual_contour_plots_for_surface_fitting"></a><span class="mw-headline">Residual contour plots for surface fitting</span></h2>
<p>When fitting a surface with an OriginPro built-in function, a contour plot of residuals in the XY plane is produced.  Contour intervals are determined by the sigma value (the model error).  As in the case of 2D fitting, a good fit of the regression surface should produce no recognizable patterns in the contour plot of the residuals
</p>





