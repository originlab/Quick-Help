<h1 class="firstHeading">4.4.9.1 Stacking Worksheet Columns</h1><p class='urlname' style='display: none'>Wks-Stacking-Cols</p>
<p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Stacking_Columns_by_Column_Label"><span class="tocnumber">1</span> <span class="toctext">Stacking Columns by Column Label</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Dialog_Controls"><span class="tocnumber">1.1</span> <span class="toctext">Dialog Controls</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#How_to_Stack_Columns"><span class="tocnumber">1.2</span> <span class="toctext">How to Stack Columns</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Example"><span class="tocnumber">1.3</span> <span class="toctext">Example</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="#Stacking_Columns_by_Column_Designation"><span class="tocnumber">2</span> <span class="toctext">Stacking Columns by Column Designation</span></a></li>
</ul>
</div>

<h2><a name="Stacking_Columns_by_Column_Label"></a><span class="mw-headline">Stacking Columns by Column Label</span></h2>
<p>The Stacking Worksheet Columns tool is for converting data from the raw mode into index mode. In the original dataset, samples belong to different groups is stored in different columns. After stacking, they will be in different rows in the same column, with an additional column in the worksheet providing the group information (the group from which the original sample is from).
</p><p>To use this function:
</p>
<ol><li> Create a new worksheet with input data. </li>
<li> Highlight the selected data. </li>
<li> Select <b>Restructure: Stack Columns</b> from the Origin menu to open the <b>wstackcol</b> dialog box. </li></ol>
<p>In fact, the <a class="external text" href="../../XFunction/X-Function/Wstackcol.html">wstackcol</a> X-Function is called to start this function.
</p>
<dl><dd><a  class="image"><img alt="Stacking Worksheet Columns 1.png" src="../images/Stacking_Worksheet_Columns/Stacking_Worksheet_Columns_1.png?v=46393" width="829"  /></a></dd></dl>
<h3><a name="Dialog_Controls"></a><span class="mw-headline">Dialog Controls</span></h3>
<table class="dialogcontroltable">

<tr>
<th>Recalculate
</th>
<td>
<p>Specify how to recalculate the results. See details in <a href="../../UserGuide/UserGuide/Recalculating_Analysis_Results.html" title="UserGuide:Recalculating Analysis Results">Recalculating Analysis Results</a>.
</p>
</td></tr>
<tr>
<th>Input Stack Column(s)
</th>
<td>
<p>Specify the columns, from which the source data is. There should be at least two columns.
</p>
</td></tr>
<tr>
<th>Group Identifier
</th>
<td>
<dl><dd><b>Group Row(s)</b>
<dl><dd>Select the column label rows which contain the group information. With this information, the tool identifies the group to which the samples belong. If there are multiple rows selected, the selected order of the groups will show in the lower text box.</dd></dl></dd></dl>
</td></tr>
<tr>
<th>Options
</th>
<td>
<p>The stacking options.
</p>
<dl><dd><b>Include Other Column(s)</b>
<dl><dd>Specify whether to Include Other Column(s) in the output. If this check box is selected, you are allowed to pick the columns to be included.</dd></dl></dd>
<dd><b>Stack into Subgroups</b>
<dl><dd>Specify whether to stack the original samples into several subgroups. If this is not selected, all of the input samples will be stored in one column only. If this check box is selected, you are allowed to specify the number the subgroups, or the number of columns into which the samples are stacked.</dd>
<dd>Suppose there are 6 groups in the original data and you choose to stack them into two subgroups, the first, third, and fifth groups will be in the first subgroup while the rest will be in the second subgroup.</dd></dl></dd>
<dd><b>Stack by Rows</b>
<dl><dd>Specify whether to interlace samples from different groups. </dd>
<dd>Suppose there are two groups in the original dataset and this option is selected, the even rows in the output column will be samples that belong to the first group, while the odd rows will be samples from the second group. If this check box is not selected, the first <i>n</i> rows in the output column (<i>n</i> is the number of samples in the first group) will contain the samples from the first group while the rest rows will contain the samples from the second group.</dd></dl></dd>
<dd><b>Exclude Missing Rows</b>
<dl><dd>Specify whether to ignore rows that contain missing values in the source columns.</dd></dl></dd></dl>
</td></tr>
<tr>
<th>Output Settings
</th>
<td>
<dl><dd><b>Group Column Long Name</b>
<dl><dd>Specify the long name for the group column. Options include:
<ul><li><b>&lt;Group Row Header&gt;</b>
<dl><dd>The row header from which the group information is from, in other words, the selection of <b>Group Row(s)</b> (see above).</dd></dl></li>
<li><b>Group</b>
<dl><dd>Group<i>n</i>.</dd></dl></li>
<li><b>Class</b>
<dl><dd>Class<i>n</i>.</dd></dl></li></ul></dd></dl></dd>
<dd><b>Data Column Long Name</b>
<dl><dd>Enter the long name for the output data column. The long name will be enumerated.</dd></dl></dd>
<dd><b>Output Worksheet</b>
<dl><dd>Specify the worksheet for outputting the results.</dd></dl></dd></dl>
</td></tr></table>
<p><br />
</p>
<h3><a name="How_to_Stack_Columns"></a><span class="mw-headline">How to Stack Columns</span></h3>
<p>This function can stack columns, stack columns by row. It also allow including other columns and specifying the number of subgroups. So, combined with each other, there are several ways of stacking columns as following.
</p>
<ul><li><b>Stack</b></li></ul>
<dl><dd>Stack values from several columns into several rows in a group.</dd>
<dd><a  class="image"><img alt="Stack Columns.png" src="../images/Stacking_Worksheet_Columns/Stack_Columns.png?v=24896" width="342"  /></a></dd></dl>
<ul><li><b>Stack by Row</b></li></ul>
<dl><dd>Stack columns according to their rows instead of stacking one column underneath another. It interleaves the column's values.</dd>
<dd><a  class="image"><img alt="Stack by Row.png" src="../images/Stacking_Worksheet_Columns/Stack_by_Row.png?v=24899" width="342"  /></a></dd></dl>
<ul><li><b>Stack and Include Other Column(s)</b></li></ul>
<dl><dd>This kind of stacking will Include Other Column(s) from the original worksheet plus the newly stacked columns in new worksheet.</dd>
<dd><a  class="image"><img alt="Include Non-stack Columns.png" src="../images/Stacking_Worksheet_Columns/Include_Non-stack_Columns.png?v=24900" width="341"  /></a></dd></dl>
<ul><li><b>Stack by Row and Include Other Column(s)</b></li></ul>
<dl><dd>Stack columns according to the rows and include non-stack columns from the original worksheet.</dd>
<dd><a  class="image"><img alt="Interleave Groups and Include Other Columns.png" src="../images/Stacking_Worksheet_Columns/Interleave_Groups_and_Include_Other_Columns.png?v=24902" width="342"  /></a></dd></dl>
<ul><li><b>Stack into Subgroups</b></li></ul>
<dl><dd>Stack multiple columns into two or more groups.</dd>
<dd><a  class="image"><img alt="Multiple Output Variable Groups.png" src="../images/Stacking_Worksheet_Columns/Multiple_Output_Variable_Groups.png?v=24903" width="342"  /></a></dd></dl>
<ul><li><b>Stack by Rows and Stack into Subgroups</b></li></ul>
<dl><dd>Stack multiple columns into two or more groups according to their rows.</dd>
<dd><a  class="image"><img alt="Interleave Groups and Divided Groups.png" src="../images/Stacking_Worksheet_Columns/Interleave_Groups_and_Divided_Groups.png?v=24904" width="342"  /></a></dd></dl>
<ul><li><b>Stack into Subgroups and Include Other Column(s)</b></li></ul>
<dl><dd>Stack multiple columns into two or more groups and include non-stack columns from the original worksheet.</dd>
<dd><a  class="image"><img alt="Divide Groups and Include Other Columns.png" src="../images/Stacking_Worksheet_Columns/Divide_Groups_and_Include_Other_Columns.png?v=24901" width="341"  /></a></dd></dl>
<ul><li><b>Stack by Rows, Stack into Subgroups and Include Other Column(s)</b></li></ul>
<dl><dd>Stack multiple columns into two or more groups according to their rows and include non-stack columns from the original worksheet.</dd>
<dd><a  class="image"><img alt="Interleave and Divide and Include Other Columns.png" src="../images/Stacking_Worksheet_Columns/Interleave_and_Divide_and_Include_Other_Columns.png?v=24905" width="342"  /></a></dd></dl>
<h3><a name="Example"></a><span class="mw-headline">Example</span></h3>
<p>The following example will stack columns in a sample data file so that it is displayed in another form.
</p>
<ol><li>Open the file <i>\Samples\Statistics\Body.ogw</i>.
<dl><dd><a  class="image"><img alt="Wstackclos example 2.png" src="../images/Stacking_Worksheet_Columns/Wstackclos_example_2.png?v=46390" width="390"  /></a></dd></dl></li>
<li>Highlight column B, C and D in the Male worksheet and then select <b>Worksheet: Stack Columns</b> from the Origin menu to bring up the <b>wstackcol</b> dialog.</li>
<li>Select <b>Include Other Column(s)</b> check-box and <b>Stack by Rows</b> check-box, other settings keep the default values. 
<dl><dd><a  class="image"><img alt="Wstackcol example 3.png" src="../images/Stacking_Worksheet_Columns/Wstackcol_example_3.png?v=46391" width="823"  /></a></dd></dl></li>
<li>Click <b>OK</b> to execute. You will get the following result:
<dl><dd><a  class="image"><img alt="Wstackclos example 1.png" src="../images/Stacking_Worksheet_Columns/Wstackclos_example_1.png?v=46392" width="321"  /></a></dd></dl></li></ol>
<h2><a name="Stacking_Columns_by_Column_Designation"></a><span class="mw-headline">Stacking Columns by Column Designation</span></h2>
<p>We can also stack worksheet columns by <a href="../../UserGuide/UserGuide/Set_Column_Designation.html" title="UserGuide:Set Column Designation"><b>Column (Plot) Designation</b></a>. The <a class="external text" href="../../XFunction/X-Function/Coljoinbydesig.html">coljoinbydesig</a> X-Function dialog is not available from the menu but it it can be opened in the user-interface:
</p>
<ol><li> Click on the <b>Window</b> menu and open the <b>Script Window</b> or <b>Command Window</b>.</li>
<li> At the prompt, copy and paste (or type) the following and press Enter:</li></ol>
<pre class="lt" style="font-family:monospace;">coljoinbydesig <span style="color: #000080;">-</span>d</pre>
<dl><dd><a  class="image"><img alt="XF coljoinbydesig db.png" src="../images/Stacking_Worksheet_Columns/XF_coljoinbydesig_db.png?v=82795" width="365"  /></a></dd></dl>
<p><br />
Use of the dialog controls is straightforward:
</p>
<ul><li> <b>Input</b> is the worksheet data that you wish to stack by column designation.</li>
<li> <b>Output</b> is where you wish to output the stacked data (new sheet, new book, etc.).</li></ul>
<dl><dd><a  class="image"><img alt="Output coljoinbydesig db.png" src="../images/Stacking_Worksheet_Columns/Output_coljoinbydesig_db.png?v=82796" width="706"  /></a></dd></dl>






