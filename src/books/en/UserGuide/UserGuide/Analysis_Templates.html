<h1 class="firstHeading">27.2 Analysis Templates</h1><p class='urlname' style='display: none'>Analysis-Templates</p>
<p><br />
</p>
<div style="text-align: left; direction: ltr; margin-left: 1em;"><p><a  class="image"><img alt="Video Image.png" src="../images/Analysis_Templates/Video_Image.png?v=29468" width="33"  /></a> See more related video:<a class="external text" href="http://www.originlab.com/Index.aspx?go=Support/VideoTutorials&amp;ss=chm&amp;pid=1171" target="_blank">Creating an Analysis Template</a>
</p></div>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Introduction"><span class="tocnumber">1</span> <span class="toctext">Introduction</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Saving_Analysis_Operations_into_a_Template"><span class="tocnumber">1.1</span> <span class="toctext">Saving Analysis Operations into a Template</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Using_Saved_Template_to_Handle_Repetitive_Tasks"><span class="tocnumber">1.2</span> <span class="toctext">Using Saved Template to Handle Repetitive Tasks</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Use_Active_Workbook_as_Template_to_Handle_Repetitive_Tasks"><span class="tocnumber">1.3</span> <span class="toctext">Use Active Workbook as Template to Handle Repetitive Tasks</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Reporting_Batch_Analyzed_Results"><span class="tocnumber">1.4</span> <span class="toctext">Reporting Batch Analyzed Results</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Example"><span class="tocnumber">2</span> <span class="toctext">Example</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Other_Materials"><span class="tocnumber">3</span> <span class="toctext">Other Materials</span></a></li>
</ul>
</div>

<h2><a name="Introduction"></a><span class="mw-headline">Introduction</span></h2>
<p>The Origin workbook is capable of storing raw data, metadata, mathematical formulae, scripts and analysis results (including graphs and matrix). Combine this ability to store complex information with Origin's <a href="../../UserGuide/UserGuide/Recalculating_Analysis_Results.html" title="UserGuide:Recalculating Analysis Results">Recalculate</a> analysis feature and you have the potential to create an <b>Analysis Template</b>.   
</p><p>The Analysis Template concept differs from Origin's <a href="../../UserGuide/UserGuide/What_is_Saved_with_the_Workbook_Template.html" title="UserGuide:What is Saved with the Workbook Template">workbook template</a> concept in at least one very important way: when you save a workbook template (<b>File: Save Template As</b>) and save the file as an OTW(U) file, <i>all</i> data are destroyed. By contrast, when you perform some operation and save an analysis template (<b>File: Save Workbook as Analysis Template</b>) as an OGW(U) file, the workbook will not only retain information on the number of columns and sheets, column designation and order, format and style options -- the sorts of things that are saved with the OTW(U) file -- but you also save information on what sort of analyses you have performed and what sort of output you chose to generate. When supplied with the proper data, an Analysis Template will crunch your numbers and automatically create output in the form of worksheet data, matrix data, and analysis report sheets that summarize your results with a combination of tables and graphs. The Analysis Template can be an integral part of your Origin <a class="external text" href="../../UserGuide/UserGuide/Batch_Processing.html">batch operations</a>.
</p>
<dl><dd><dl><dd><a  class="image"><img alt="Product Page BatchProcessing 04.png" src="../images/Analysis_Templates/Product_Page_BatchProcessing_04.png?v=78046" width="702"  /></a></dd></dl></dd></dl>
<h3><a name="Saving_Analysis_Operations_into_a_Template"></a><span class="mw-headline">Saving Analysis Operations into a Template</span></h3>
<p>If all your analysis operations are consolidated into one workbook, you can select menu <b>File: Save Workbook as Analysis Template...</b> to save the workbook as an Analysis Template (*.OGW(U) file). You can directly drag this OGW(U) file into Origin to open it, and you will find all analysis related data are cleared but the analysis operations are kept as indicated by the green locks.
</p>
<ul>
If your analysis operations are also associated with matrixbooks or independent graph windows, you can 
<li><a href="../../UserGuide/UserGuide/Adding_Existing_Graphs_Matrixs_as_Sheets.html" title="UserGuide:Adding Existing Graphs Matrixs as Sheets">add these matrixbooks/graph windows as new sheets</a> into the source workbook(this capability is available since Origin 2018b) and save the workbook as an Analysis Template as below shows. 
<li>choose to save the entire project as a project-level analysis template. The saved project then becomes the "template" to which you add new data. To save the current project as a template, click <b>File: Clone current Project</b> . This will <i>duplicate</i> the current project file with all windows and operations but clear all imported data. If the project file has been modified since opening, the user is prompted to save the operations and graph customizations in the project file before cloning. A new <b>UNTITLED.opju</b> is created and immediately opened after duplication.</li>
</ul>
<h3><a name="Using_Saved_Template_to_Handle_Repetitive_Tasks"></a><span class="mw-headline">Using Saved Template to Handle Repetitive Tasks</span></h3>
<p>If you only want to use a saved template to process another dataset, workbook-as-template works the same as project-as-template where both require importing new data into the template to update all analysis related graphs and results.
</p><p>The added advantage of the workbook-as-template method is that the <a href="../../UserGuide/UserGuide/Batch_Processing.html" title="UserGuide:Batch Processing"><b>Batch Processing</b></a> dialog, opened by clicking button <a  class="image"><img alt="Button Batch Processing.png" src="../images/Analysis_Templates/Button_Batch_Processing.png?v=21657" width="23"  /></a> or from menu <b>File: Batch Processing</b>, can be used to process multiple files or datasets automatically.
</p>
<h3><a name="Use_Active_Workbook_as_Template_to_Handle_Repetitive_Tasks"></a><span class="mw-headline">Use Active Workbook as Template to Handle Repetitive Tasks</span></h3>
<p>If you have analyzed one of your data files within one workbook, you can easily do the same analysis for all other files by importing them into the workbooks cloned from the active workbook. This is done setting <b>Template Name</b> to <i>&lt;clone&gt;</i> in the file type's import dialog.
</p>
<dl><dd><dl><dd><a  class="image"><img alt="Analysis Template clone worksheet.png" src="../images/Analysis_Templates/Analysis_Template_clone_worksheet.png?v=78054" width="600"  /></a></dd></dl></dd></dl>
<h3><a name="Reporting_Batch_Analyzed_Results"></a><span class="mw-headline">Reporting Batch Analyzed Results</span></h3>
<p>To summarize and report analyzed results, you can create a <a class="external text" href="../../Tutorial/Tutorial/Creating_a_Custom_Report_Sheet.html">Custom Report sheet</a> which contains tables, graphs, external images, such as logos, etc., and link all those elements with the output of analysis operations in an analysis template. 
</p><p>Alternatively, you can choose to output results obtained from an analysis template directly into a pre-customized Word template to create a Word or PDF file for reporting. 
</p><p>To do so, first you have to prepare a Word template with favorable cells bookmarked. The bookmarks can be added to an analysis template in a special worksheet with name <i><b>Bookmarks</b></i>, by selecting menu <b>File:Add Word Bookmarks to Analysis Template</b> to open <a href="../../UserGuide/UserGuide/Add_Word_Bookmarks_to_Analysis_Template_Dialog.html" title="UserGuide:Add Word Bookmarks to Analysis Template Dialog">Add Word Bookmarks to Analysis Template</a> dialog. 
</p><p>To pass analyzed results via Word bookmarks to Word template, you have to copy results from the analysis template and paste them as links to the corresponding cells where Word bookmarks are added. When done, you can re-save current analysis template and use it along with the Word template to export batch analyzed results directly to a Word or PDF file.
</p>
<h2><a name="Example"></a><span class="mw-headline">Example</span></h2>
<p>This simple example will illustrate the concept:
</p>
<ol><li>Open a new Origin project, click the <b>Import Single ASCII</b> button <a  class="image"><img alt="Button Import Single ASCII.png" src="../images/Analysis_Templates/Button_Import_Single_ASCII.png?v=1806" width="23"  /></a> and open \Samples\Curve Fitting\Linear Fit.dat.  The file is imported into the active worksheet.  The sheet is renamed <b>Linear Fit</b>.</li>
<li>Highlight columns <b>B</b> through <b>D</b>, select <b>Analysis: Fitting: Linear Fit</b> from the menu, and open the <b>Linear Fit</b> dialog box.</li>
<li>Set  <b>Recalculate</b> to <b>Auto</b>.</li>
<li>Accept other defaults and click <b>OK</b> to perform your linear fit.  You can answer "No" to the attention message.</li>
<li>Right-click in the gray area to the right of the <b>Linear Fit</b> worksheet and choose <b>Clear Worksheet</b> from the shortcut menu. Click <b>OK</b> to verify that you wish to remove all data.  This will also clear all of the output data (you can verify by clicking on the FitLinear1 and FitLinearCurve1 sheets) as that output is "dependent" upon the presence of the Linear Fit data. Note that, at this point, you have not saved your <b>Analysis Template</b> (you are merely working in an untitled Origin project file).  There are a couple of options for saving, depending upon your needs:  
<ul><li>If you wish to save a pared-down Analysis Template -- the smallest functioning unit, if you will -- and all of your input and output can be contained within the workbook itself, then you can save an Origin <b>window</b> file.  Select <b>File: Save Window As</b> -- not <b>Save Template As</b> -- and save your workbook as an <b>OGW(U)</b> file.  </li>
<li>If you need to include your Analysis Template in a more complex project -- one that perhaps contains separate graph, matrix or layout windows -- then you could save your workbook as part of your <b>project</b> file (<b>File: Save Project As</b>).  Note, however, that if you save your workbook as an <b>OGW(U)</b> file as prescribed above, you can always add it to an Origin project file with the <b>File: Open</b> menu command.</li></ul></li>
<li> Once you have chosen an option for saving, you can see a demonstration of the Analysis Template by clicking the <b>Import Single ASCII</b> button <a  class="image"><img alt="Button Import Single ASCII.png" src="../images/Analysis_Templates/Button_Import_Single_ASCII.png?v=1806" width="23"  /></a> and re-import \Samples\Curve Fitting\Linear Fit.dat.  The file is imported into the active worksheet, the curve fit is performed and the results are written to the <b>FitLinear</b> and <b>FittedValues</b> worksheets. </li></ol>
<table class="note">
<tr>
<td>
<p><b>Note to Advanced Users:</b> If your Analysis Template procedure is performed by a user-defined X-Function and you intend to save the Template as an <b>OGW(U)</b> file and share it with a colleague, you will need to check the <b>Save with Object</b> check box (<b>X-Function Builder</b> &gt; <b>Tree View</b>) when creating your X-Function. 
</p>
</td></tr></table>
<h2><a name="Other_Materials"></a><span class="mw-headline">Other Materials</span></h2>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Analysis_Templates/Tutorial_icon.png?v=9654" width="57"  border="0" />
	</td>
	<td><p>The <a class="external text" href="../../Tutorial/Tutorial/Importing_Multiple_Files_into_Workbooks_Cloned_from_Active_Workbook.html">Importing Multiple Files into Workbooks Cloned from Active Workbook</a> tutorial gives you step by step guidance to use current workbook as analysis template to batch process multiple files.
</p><p>The <a class="external text" href="../../Tutorial/Tutorial/Creating_and_Using_Analysis_Templates.html">Creating and Using Analysis Templates</a> tutorial gives you a quick start to use Analysis Template.
</p><p>The <a class="external text" href="../../Tutorial/Tutorial/Batch_Processing_with_Word_Template_for_Reporting.html">Batch Processing with Word Template for Reporting</a> tutorial gives you step by step guidance to use Word template and Analysis Template to make Word/PDF reports.
</p><p><br />
</p></td></tr></table>


