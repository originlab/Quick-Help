<h1 class="firstHeading">17.5.7.2 Algorithms (Moods Median Test)</h1><p class='urlname' style='display: none'>Median-Algorithm</p>
<p>The procedure below draws on NAG algorithms.
</p><p>The median test investigates the difference between <img src="../images/Algorithm_(median)/math-07ab8bd2ced78ca04d507625c0c5c584.png?v=0" title="K\,\!" alt="K\,\!" class="tex"/> samples of sizes <img src="../images/Algorithm_(median)/math-e3892b2f81bff2a1c12e4f5fc4137fdd.png?v=0" title="n_1,n_2,...,n_k\,\!" alt="n_1,n_2,...,n_k\,\!" class="tex"/> denoted by 
</p><p><img src="../images/Algorithm_(median)/math-efdfa1d8d399dc969bdb8d05cf79116c.png?v=0" title="x_1,x_2,....x_{n_1};x_{n_1+1},x_{n_1+2},...,x_{n_1+n_2};...;x_{n_1+n_2+...+n_{i-1}+1},...x_{n_1+n_2+...+n_i}" alt="x_1,x_2,....x_{n_1};x_{n_1+1},x_{n_1+2},...,x_{n_1+n_2};...;x_{n_1+n_2+...+n_{i-1}+1},...x_{n_1+n_2+...+n_i}" class="tex"/>
</p><p>If the median value is not given by the user, the combined data from all groups are sorted and the median is calculated:
</p><p><img src="../images/Algorithm_(median)/math-de826035b962a7fd5705d750b9fd0d83.png?v=0" title="md=(x_{(n/2)}+x_{(n/2+1)})/2\,\!" alt="md=(x_{(n/2)}+x_{(n/2+1)})/2\,\!" class="tex"/> ,if n is even;<img src="../images/Algorithm_(median)/math-5376086378bef4c420780f8f4edd4b1d.png?v=0" title="md=x_{((n+1)/2)}\,\!" alt="md=x_{((n+1)/2)}\,\!" class="tex"/>, if n is odd.
</p><p>Where  <img src="../images/Algorithm_(median)/math-cf499856225c05cdde6e54eb4dbcf6d7.png?v=0" title="n= \sum_{i=1}^k n_i" alt="n= \sum_{i=1}^k n_i" class="tex"/>,<img src="../images/Algorithm_(median)/math-4d70cdaba8c6afb7571ebd312961e90f.png?v=0" title="x_{(1)},...,x_{(n)}\,\!" alt="x_{(1)},...,x_{(n)}\,\!" class="tex"/> is the ordered data of all observations from small to large. 
</p><p>The test proceeds by forming a frequency table, giving the number of scores in each sample above and below the median of the pooled sample:
</p>
<table class="simple">
<tr>
<td>
</td>
<td>Sample 1
</td>
<td>Sample 2
</td>
<td>……
</td>
<td>Sample K
</td>
<td>Total
</td></tr>
<tr>
<td><img src="../images/Algorithm_(median)/math-a2420521c0cb4d3b8fa937126d55adf9.png?v=0" title="Score \le md" alt="Score \le md" class="tex"/>
</td>
<td><img src="../images/Algorithm_(median)/math-1e796779bf5356266616c75e9ca23c69.png?v=0" title="n_{11}\,\!" alt="n_{11}\,\!" class="tex"/>
</td>
<td><img src="../images/Algorithm_(median)/math-8ea602aa47643a586c7ad5d3a7f92436.png?v=0" title="n_{12}\,\!" alt="n_{12}\,\!" class="tex"/>
</td>
<td>
</td>
<td><img src="../images/Algorithm_(median)/math-498c7aedd5e9fd58c13dfe3b65c1aabd.png?v=0" title="n_{1k}\,\!" alt="n_{1k}\,\!" class="tex"/>
</td>
<td><img src="../images/Algorithm_(median)/math-f3e66ae4ff878c7732ac9e70740a05e5.png?v=0" title="R_{1}\,\!" alt="R_{1}\,\!" class="tex"/>
</td></tr>
<tr>
<td><img src="../images/Algorithm_(median)/math-7f3acb829bee05cb06afa7c68c824143.png?v=0" title="Score &gt; md\,\!" alt="Score &gt; md\,\!" class="tex"/>
</td>
<td><img src="../images/Algorithm_(median)/math-8115c272068040fbf82f5a6329571ae2.png?v=0" title="n_{21}\,\!" alt="n_{21}\,\!" class="tex"/>
</td>
<td><img src="../images/Algorithm_(median)/math-e17f0b1c025b09b2770ffc8957450930.png?v=0" title="n_{22}\,\!" alt="n_{22}\,\!" class="tex"/>
</td>
<td>
</td>
<td><img src="../images/Algorithm_(median)/math-2187cbcffb8d9747727f583b4cec1183.png?v=0" title="n_{2k}\,\!" alt="n_{2k}\,\!" class="tex"/>
</td>
<td><img src="../images/Algorithm_(median)/math-78a63178b657eaea9b89208cb48f9a18.png?v=0" title="R_{2}\,\!" alt="R_{2}\,\!" class="tex"/>
</td></tr>
<tr>
<td><b>Total</b>
</td>
<td><img src="../images/Algorithm_(median)/math-7ae76161358672724be28c2a08a628ab.png?v=0" title="n_{1}\,\!" alt="n_{1}\,\!" class="tex"/>
</td>
<td><img src="../images/Algorithm_(median)/math-c133b543b65a4bc86c423aea7e6eb74a.png?v=0" title="n_{2}\,\!" alt="n_{2}\,\!" class="tex"/>
</td>
<td>
</td>
<td><img src="../images/Algorithm_(median)/math-9b28262783cadfc3813abd0bc2299236.png?v=0" title="n_{k}\,\!" alt="n_{k}\,\!" class="tex"/>
</td>
<td><img src="../images/Algorithm_(median)/math-baa52b85c066dbd5eeff3c078a69205b.png?v=0" title="n\,\!" alt="n\,\!" class="tex"/>
</td></tr></table>
<p>The <img src="../images/Algorithm_(median)/math-cfebfa945941b02f58dc453d7b14aeb5.png?v=0" title="x^2\,\!" alt="x^2\,\!" class="tex"/>statistic foe all nonempty samples is calculated as: 
</p><p><img src="../images/Algorithm_(median)/math-ef2be729a791fb8acec1fd6850edf7d8.png?v=0" title="x^2=\sum_{j=1}^k\sum_{i=1}^2(n_{ij}-e_{ij})^2/e_{ij}\,\!" alt="x^2=\sum_{j=1}^k\sum_{i=1}^2(n_{ij}-e_{ij})^2/e_{ij}\,\!" class="tex"/> where <img src="../images/Algorithm_(median)/math-de73c78d7e86e0f4bfc60f8827595940.png?v=0" title="e_{ij}=R_in_j/n\,\!" alt="e_{ij}=R_in_j/n\,\!" class="tex"/>
</p><p>The significance level is from the <img src="../images/Algorithm_(median)/math-cfebfa945941b02f58dc453d7b14aeb5.png?v=0" title="x^2\,\!" alt="x^2\,\!" class="tex"/> distribution with <img src="../images/Algorithm_(median)/math-4dd90bab747a167e7975e1f8fb397a4d.png?v=0" title="k-1\,\!" alt="k-1\,\!" class="tex"/> degrees of freedom, where <img src="../images/Algorithm_(median)/math-4dd90bab747a167e7975e1f8fb397a4d.png?v=0" title="k-1\,\!" alt="k-1\,\!" class="tex"/> is the number of nonempty samples. A message is printed if any cell has an expected value less than one, or more than 20% of the cells have expected values less than five.
</p>





