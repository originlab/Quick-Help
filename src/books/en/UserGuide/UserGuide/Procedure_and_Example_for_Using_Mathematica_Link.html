<h1 class="firstHeading">25.2.6 Procedure and Examples for Using Mathematica Link</h1><p class='urlname' style='display: none'>Mathematica-Procedure-EX</p>
<p>In this page, we will talk about the procedure of using <b>Origin's Mathematica Link</b>, and also include examples. The version of Mathematica used here is Mathematica 10.0. 
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Start_Mathematica_Link_in_Origin"><span class="tocnumber">1</span> <span class="toctext">Start Mathematica Link in Origin</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Examples"><span class="tocnumber">2</span> <span class="toctext">Examples</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Example_1"><span class="tocnumber">2.1</span> <span class="toctext">Example 1</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Example_2"><span class="tocnumber">2.2</span> <span class="toctext">Example 2</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Example_3"><span class="tocnumber">2.3</span> <span class="toctext">Example 3</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="Start_Mathematica_Link_in_Origin"></a><span class="mw-headline">Start Mathematica Link in Origin</span></h2>
<p>Before launching the tool, you will need to set up the Kernel configuration in Mathematica to link to Origin's kernel OSequencer.exe. Refer to <a href="../../UserGuide/UserGuide/Launching_the_tool.html" title="UserGuide:Launching the tool">this page</a> for detailed steps.
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p>Before attempting these examples, please launch the Mathematica Link in Origin using the procedure in the previous section. 
</p>
<h3><a name="Example_1"></a><span class="mw-headline">Example 1</span></h3>
<p>This example sends worksheet data to and receive from Methematica
</p>
<ol><li> Import the data <i>&lt;Origin Installation Directory&gt;/Samples/Signal Processing/fftfilter1.DAT</i> to a new worksheet by using the system default theme, in order to make sure that the workbook name and worksheet name are renamed with the file name, <i>fftfilter1</i>.</li>
<li> Activate the <b>Origin Link for Mathematica</b> dialog, and go to the <b>Column</b> tab.  In the <b>Send Column</b> group, set <b>Mathematica Variable</b> and <b>Orgin Dataset</b> as <i>raw</i> and <i>[fftfilter1]fftfilter1!col(b)</i> respectively.
<dl><dd> <a  class="image"><img alt="Mathematica Link Column Send.png" src="../images/Procedure_and_Example_for_Using_Mathematica_Link/Mathematica_Link_Column_Send.png?v=73456" width="329"  /></a></dd></dl></li>
<li> Click the <b>Send</b> button to send the second column of data to Mathematica.</li>
<li> Go to the <b>Evaluate</b> tab, type the following two lines for <b>Input</b>
<dl><dd> temp=Fourier[raw]</dd>
<dd> realpart=Re[temp]</dd></dl></li>
<li> Click the <b>Evaluate</b> button to get the results.
<dl><dd> <a  class="image"><img alt="Mathematica Link Evaluate.png" src="../images/Procedure_and_Example_for_Using_Mathematica_Link/Mathematica_Link_Evaluate.png?v=73457" width="483"  /></a></dd></dl></li>
<li> Go to the worksheet, click the <b>Add New Columns</b><a  class="image"><img alt="Mathematica Link Add Col Button.png" src="../images/Procedure_and_Example_for_Using_Mathematica_Link/Mathematica_Link_Add_Col_Button.png?v=24708" width="23"  /></a> button in the Standard toolbar to add column C to the worksheet.</li>
<li> Go back to the <b>Origin Link for Mathematica</b> dialog and activate the <b>Column</b> tab. Set the <b>Receive Column</b> group as:
<dl><dd> <b>Mathematica Variable</b>: realpart</dd>
<dd> <b>Origin Dataset</b>: [fftfilter1]fftfilter1!col(c)</dd>
<dd> <a  class="image"><img alt="Mathematica Link Column Receive.png" src="../images/Procedure_and_Example_for_Using_Mathematica_Link/Mathematica_Link_Column_Receive.png?v=73458" width="483"  /></a></dd></dl></li>
<li> Click the <b>Receive</b> button, and the result will be placed into column C of the worksheet.
<dl><dd> <a  class="image"><img alt="Mathematica Link Worksheet Result.png" src="../images/Procedure_and_Example_for_Using_Mathematica_Link/Mathematica_Link_Worksheet_Result.png?v=73459" width="332"  /></a></dd></dl></li></ol>
<h3><a name="Example_2"></a><span class="mw-headline">Example 2</span></h3>
<p>This example sends and receives matrix data to and from Mathematica.
</p>
<ol><li> Open the matrix <i>&lt;Origin Installation Directory&gt;/Samples/Matrix Conversion and Gridding/2D Gaussian.ogm</i>.</li>
<li> Activate the <b>Origin Link for Mathematica</b> dialog and go to the <b>Matrix</b> tab. In the <b>Send Matrix</b> group, set <b>Mathematica Variable</b> and <b>Origin Matrix</b> as <i>mat</i> and <i>[MBook1]Data!1</i> respectively.
<dl><dd> <a  class="image"><img alt="Mathematica Link Matrix Send.png" src="../images/Procedure_and_Example_for_Using_Mathematica_Link/Mathematica_Link_Matrix_Send.png?v=73460" width="320"  /></a></dd></dl></li>
<li> Click the <b>Send</b> button.</li>
<li> Open Mathematica if not already started.,Create a new notebook. Select from menu <b>Evaluation: Notebook's Kernel</b>, make sure the kernel "OSequencer" is selected.. Now the current notebook of Mathematica can communicate with Origin.</li>
<li> Enter the following script<pre class="lt" style="font-family:monospace;">invmat <span style="color: #000080;">=</span> Inverse<span style="color: #000000;">&#91;</span>mat<span style="color: #000000;">&#93;</span></pre> and execute it.
<dl><dd> <a  class="image"><img alt="Mathematica Link Mathematica.png" src="../images/Procedure_and_Example_for_Using_Mathematica_Link/Mathematica_Link_Mathematica.png?v=73461" width="436"  /></a></dd></dl></li>
<li> Go back to Origin. Add a new matrix object to Data matrixsheet. Click the <b>D</b> icon at the top-right corner of Data matrixsheet. Select <b>Add</b> to add a new object.</li>
<li> Activate the <b>Origin Link for Mathematica</b> dialog, and set the <b>Receive Matrix</b> group as:
<dl><dd> <b>Mathematica Variable</b>: invmat</dd>
<dd> <b>Origin Matrix</b>: [MBook1]Data!2</dd>
<dd> <a  class="image"><img alt="Mathematica Link Matrix Receive.png" src="../images/Procedure_and_Example_for_Using_Mathematica_Link/Mathematica_Link_Matrix_Receive.png?v=73462" width="537"  /></a></dd></dl></li>
<li> Click the <b>Receive</b> button, you will get the inverse of the original matrix.
<dl><dd> <a  class="image"><img alt="Mathematica Link Matrix Result.png" src="../images/Procedure_and_Example_for_Using_Mathematica_Link/Mathematica_Link_Matrix_Result.png?v=73022" width="385"  /></a></dd></dl></li></ol>
<h3><a name="Example_3"></a><span class="mw-headline">Example 3</span></h3>
<p>This example creates and plots a user function defined in Mathematica.
</p>
<ul>
<li>Open Mathematica if not already started.,Create a new notebook. Select menu  menu Evaluation: Notebook's Kernel, make sure the kernel "OSequencer" is selected.. Now the current notebook of Mathematica can communicate with Origin.</li>
<li>Define a function as follow: <br />
<pre class="lt" style="font-family:monospace;">f1<span style="color: #000000;">&#91;</span>x_<span style="color: #000000;">&#93;</span> <span style="color: #000000;">:</span><span style="color: #000080;">=</span> <span style="color: #000000;">&#40;</span>FresnelS<span style="color: #000000;">&#91;</span>x<span style="color: #000000;">&#93;</span> <span style="color: #000080;">+</span> <span style="color: #0000dd;">1</span><span style="color: #000080;">/</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">^</span><span style="color: #0000dd;">2</span> <span style="color: #000080;">+</span> <span style="color: #000000;">&#40;</span>FresnelC<span style="color: #000000;">&#91;</span>x<span style="color: #000000;">&#93;</span> <span style="color: #000080;">+</span> <span style="color: #0000dd;">1</span><span style="color: #000080;">/</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span></pre></li>
<li>Go back to Origin. In the <b>Function</b> tab of <b>Origin Link for Mathematica</b> dialog, specify the formula and the curve range and number of data points as follow<br />
<table class="noborder">

<tr style="vertical-align: top;">
<td>
<p><b>f(x) =</b>: f1[x^2+2]<br />
<b>From</b>: 0<br />
<b>To</b>: 10<br />
<b>Points</b>: 2000 
</p>
</td>
<td><a  class="image"><img alt="Mathematica Link Function.png" src="../images/Procedure_and_Example_for_Using_Mathematica_Link/Mathematica_Link_Function.png?v=73463" width="382"  /></a>
</td></tr></table></li>
<li>Click the <b>Plot</b> button, the user-defined function is plotted.
<br /><a  class="image"><img alt="Mathematica Link Function Plot.png" src="../images/Procedure_and_Example_for_Using_Mathematica_Link/Mathematica_Link_Function_Plot.png?v=73464" width="396"  /></a></li>
</ul>






