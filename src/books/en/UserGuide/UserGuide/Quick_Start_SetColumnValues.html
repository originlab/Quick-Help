<h1 class="firstHeading">4.6.8.1 Quick Start</h1><p class='urlname' style='display: none'>Wks-SetColVal-QuickStart</p>
<p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Set_Values_Dialog_Box_Key_Features"><span class="tocnumber">1</span> <span class="toctext">Set Values Dialog Box Key Features</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Spreadsheet_Cell_Notation"><span class="tocnumber">2</span> <span class="toctext">Spreadsheet Cell Notation</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#References_to_Columns_and_Cells"><span class="tocnumber">2.1</span> <span class="toctext">References to Columns and Cells</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#References_to_Other_Sheets_and_Books"><span class="tocnumber">2.2</span> <span class="toctext">References to Other Sheets and Books</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="#What_Can_I_Enter_in_the_Column_Formula_or_Before_Formula_Scripts_Boxes.3F"><span class="tocnumber">3</span> <span class="toctext">What Can I Enter in the Column Formula or Before Formula Scripts Boxes?</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#Column_Formula_Examples"><span class="tocnumber">3.1</span> <span class="toctext">Column Formula Examples</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Autocomplete"><span class="tocnumber">3.2</span> <span class="toctext">Autocomplete</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8"><a href="#Reusing_Formulas"><span class="tocnumber">4</span> <span class="toctext">Reusing Formulas</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#A_Note:_When_Column_Formulas_do_not_Automatically_Update"><span class="tocnumber">5</span> <span class="toctext">A Note: When Column Formulas do not Automatically Update</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#Additional_Information"><span class="tocnumber">6</span> <span class="toctext">Additional Information</span></a></li>
<li class="toclevel-1 tocsection-11"><a href="#Two_Quick_Examples"><span class="tocnumber">7</span> <span class="toctext">Two Quick Examples</span></a>
<ul>
<li class="toclevel-2 tocsection-12"><a href="#Set_Values_for_a_Single_Column"><span class="tocnumber">7.1</span> <span class="toctext">Set Values for a Single Column</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#Set_Values_for_Multiple_Columns"><span class="tocnumber">7.2</span> <span class="toctext">Set Values for Multiple Columns</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-14"><a href="#The_Python_Function_Tab"><span class="tocnumber">8</span> <span class="toctext">The Python Function Tab</span></a>
<ul>
<li class="toclevel-2 tocsection-15"><a href="#Example"><span class="tocnumber">8.1</span> <span class="toctext">Example</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="Set_Values_Dialog_Box_Key_Features"></a><span class="mw-headline">Set Values Dialog Box Key Features</span></h2>
<p>The <b>Set Values</b> dialog box takes a one-line, user-defined expression and fills <a href="../../UserGuide/UserGuide/Entering_Expressions_in_the_Set_Column_Dialog.html" title="UserGuide:Entering Expressions in the Set Column Dialog">one or multiple worksheet columns</a> (or portions of columns) with values generated by the expression. The expression -- entered directly in the <b>Column Formula</b> box -- can incorporate arithmetic operators, column and cell references, functions, user-defined variables, constants, etc. (<a href="#What_Can_I_Enter_in_the_Column_Formula_or_Before_Formula_Scripts_Boxes.3F">see below</a>). The Set Values Dialog features syntax-coloring.
</p>
<dl><dd><a  class="image"><img alt="SCV dialog features8.png" src="../images/Quick_Start_SetColumnValues/SCV_dialog_features8.png?v=90466" width="799"  /></a></dd></dl>
<p><br />
<i><b>Optional Scripting Tabs:</b></i>
</p>
<dl><dd><dl><dd><a  class="image"><img alt="SCV BFS Python Tabs.png" src="../images/Quick_Start_SetColumnValues/SCV_BFS_Python_Tabs.png?v=87071" width="532"  /></a></dd></dl></dd></dl>
<ul><li> The <b>Before Formula Scripts</b> tab takes one or more lines of LabTalk script and runs the script before the expression in the <b>Column Formula</b> box is executed. This makes possible such things as pre-processing of input data, defining functions, variables and constants for use in the <b>Column Formula</b> box, etc. For more information on the use of Before Formula Scripts, see <a href="../../UserGuide/UserGuide/Entering_Expressions_in_the_Set_Column_Dialog.html" title="UserGuide:Entering Expressions in the Set Column Dialog">Entering Expressions in the Set Column Values Dialog</a>. For help with <b>Set Values</b> dialog box controls, see <a href="../../UserGuide/UserGuide/Menu_Options_and_Dialog_Controls.html" title="UserGuide:Menu Options and Dialog Controls">Menu Options and Dialog Controls</a>.</li>
<li> The <b>Python Function</b> tab allows you to define Python functions to be called in your column formulas. While you could save functions to an external file, using the <b>Python Function</b> tab allows you to save your code to an Origin template file for repeat use. Further, your Python functions can be called directly from the <b>Column Formula</b> box; or from LabTalk script on the neighboring <b>Before Formula Scripts</b> tab. For <a href="../../UserGuide/UserGuide/Quick_Start_SetColumnValues.html#The_Python_Function_Tab" title="UserGuide:Quick Start SetColumnValues">a quick example/tutorial</a> demonstrating the use of the <b>Python Function</b> tab, see below. For more in depth discussion of Python and Origin, see <a class="external text" href="../../Python/Category/Python_(Python).html">Origin's Python documentation</a>. </li></ul>
<dl><dd><dl><dd><a  class="image"><img alt="SCV BFS Call Python Tab.png" src="../images/Quick_Start_SetColumnValues/SCV_BFS_Call_Python_Tab.png?v=87087" width="584"  /></a></dd></dl></dd></dl>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Quick_Start_SetColumnValues/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>To load examples in the Set Values dialog box, click <b>Formula, Load Sample &gt;</b> and choose from the list of sample formulas.
</p></td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Quick_Start_SetColumnValues/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>Beginning with Origin 2018 SR0, <i>cell-level</i> (as opposed to column-level) calculations can be performed. See <a href="../../UserGuide/UserGuide/Using_Formulae_to_Set_Cell_Values.html" title="UserGuide:Using Formulae to Set Cell Values">Using a Formula to Set Cell Values</a>.
</p></td></tr></table>
<h2><a name="Spreadsheet_Cell_Notation"></a><span class="mw-headline">Spreadsheet Cell Notation</span></h2>
<p>Beginning with Origin 2017 SR0, <a href="../../UserGuide/UserGuide/Folder_and_Window_Properties_Dialog.html#The_Properties_tab" title="UserGuide:Folder and Window Properties Dialog">Spreadsheet Cell Notation (SCN)</a> is enabled by default. When SCN is ON, you can use the simplified SCN notation or you can use the pre-2017 notation in either the <b>Set Values Column Formula</b> box or in the <a href="../../UserGuide/UserGuide/Displaying_Supporting_Data_in_Worksheet_Header_Rows.html#F.28x.29.3D" title="UserGuide:Displaying Supporting Data in Worksheet Header Rows">the <b>F(x)=</b> column label row</a>. Note, however, that when using the older "col" or "wcol" syntax, <a href="../../UserGuide/UserGuide/Quick_Start_SetColumnValues.html#A_Note:_When_Column_Formulas_do_not_Automatically_Update" title="UserGuide:Quick Start SetColumnValues">some limitations apply</a>.
</p><p>When opening Origin files (OPJ, OGW, etc.) saved prior to Origin 2017, SCN will be OFF in the workbook. However, even in older files, SCN can be enabled via <a href="../../UserGuide/UserGuide/Folder_and_Window_Properties_Dialog.html" title="UserGuide:Folder and Window Properties Dialog">the <b>Window Properties</b> dialog box</a>. If you do not enable SCN (you leave <a href="../../UserGuide/UserGuide/Folder_and_Window_Properties_Dialog.html#Window_Properties_dialog" title="UserGuide:Folder and Window Properties Dialog">the <b>Spreadsheet Cell Notation</b> box</a> unchecked), you <i>must</i> use <a href="#Column_Formula_Examples">the older column and cell notation</a> in the <b>Set Values</b> and <b>F(x)=</b> formulas throughout the affected workbook.
</p><p>Note that the new spreadsheet cell notation <i>can only be used</i> in the <b>Column Formula</b> box and in the <b>F(x)=</b> label row. It cannot be used in the <b>Before Formula Scripts</b> box of Set Values or in LabTalk scripts elsewhere in Origin.
</p>
<h3><a name="References_to_Columns_and_Cells"></a><span class="mw-headline">References to Columns and Cells</span></h3>
<p>Within a given worksheet, column and cell references are now made in the following way:
</p>
<pre class="lt" style="font-family:monospace;">A; <span style="color: #008000;">// reference to column A in the same sheet</span>
A1; <span style="color: #008000;">// reference to column A, row 1, in the same sheet</span></pre>
<p>See <b>Column Formula Examples</b>, <a href="#Column_Formula_Examples">below</a>.
</p>
<h3><a name="References_to_Other_Sheets_and_Books"></a><span class="mw-headline">References to Other Sheets and Books</span></h3>
<p>Prior to Origin 2017, you had to define a range variable to use data in other sheets and books, in your <b>Set Values</b> formulas. As noted in the table above, using spreadsheet cell notation you can make direct references to data in other sheets and books. This is supported in both the <b>F(x)=</b> label row and the Set Values Column Formula box. Spreadsheet cell notation must be enabled in the target book(s).
</p><p>Use the following syntax:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span>A; <span style="color: #008000;">// reference to column A in first sheet in the same book</span>
Sheet1<span style="color: #000080;">!</span>A; <span style="color: #008000;">// reference to column A in a named sheet ([Sheet1]) in the same book</span>
<span style="color: #000000;">&#91;</span>Book1<span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span>A; <span style="color: #008000;">// reference to column A in the first sheet in another book ([Book1])</span>
<span style="color: #000000;">&#91;</span>Book2<span style="color: #000000;">&#93;</span>Sheet1<span style="color: #000080;">!</span>B2; <span style="color: #008000;">// reference to row 2 of column B, in a named sheet ([Sheet1]) in another book ([Book2])</span></pre>
<p>See <b>Column Formula Examples</b>, <a href="#Column_Formula_Examples">below</a>.
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Quick_Start_SetColumnValues/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>By default, Origin does not automatically substitute the sheet short name when entering references such as <code>2!a2</code> into the <b>F(x)=</b> row or into a cell formula. You can modify this behavior by <a href="../../UserGuide/UserGuide/Customizing_Origin_using_System_Variables.html#Changing_the_Value_of_a_System_Variable" title="UserGuide:Customizing Origin using System Variables">changing the value of LabTalk System Variable</a> <code><a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#S">@SCVU=0</a></code>.
</p></td></tr></table>
<h2><a name="What_Can_I_Enter_in_the_Column_Formula_or_Before_Formula_Scripts_Boxes.3F"></a><span class="mw-headline">What Can I Enter in the Column Formula or Before Formula Scripts Boxes?</span></h2>
<p>Expressions can include any of the following. Note that <a class="external text" href="../../LabTalk/LabTalk/Range_Notation.html#Types_of_Range_Data">range variables</a> must be predefined (e.g. in <b>Before Formula Scripts</b>) before you can use them in the <b>Column Formula</b> expression:
</p>
<table class="xfvar">
<tr>
<th width="20%">Data References
</th>
<th width="20%">Variables
</th>
<th width="20%">Operators
</th>
<th width="20%">Functions
</th>
<th width="20%">Constants
</th></tr>
<tr valign="top">
<td>
<ul><li> <a class="external text" href="../../LabTalk/LabTalk/Cell_(function).html">cell() Function</a></li>
<li> <a class="external text" href="../../LabTalk/LabTalk/Col_(function).html">col() &amp; wcol() Functions</a></li>
<li> <a href="../../UserGuide/UserGuide/Named_Range.html" title="UserGuide:Named Range">Named Ranges</a></li>
<li> <a class="external text" href="../../LabTalk/LabTalk/Range_Notation.html#Types_of_Range_Data">Range Variables</a><sup>&#134;</sup></li></ul>
</td>
<td>
<ul><li> <a class="external text" href="../../LabTalk/LabTalk/Data_Types_and_Variables.html#Variables">Project &amp; Session</a></li>
<li> <a href="../../UserGuide/UserGuide/The_Insert_Variables_Dialog_Box.html" title="UserGuide:The Insert Variables Dialog Box">SYSTEM and<br />USER Variables</a></li>
<li> <a href="../../UserGuide/UserGuide/Displaying_Supporting_Data_in_Worksheet_Header_Rows.html" title="UserGuide:Displaying Supporting Data in Worksheet Header Rows">Column Header Data</a></li></ul>
</td>
<td>
<ul><li> <a class="external text" href="../../LabTalk/LabTalk/Operators.html#Arithmetic_Operators">Arithmetic</a></li>
<li> <a class="external text" href="../../LabTalk/LabTalk/Operators.html#Logical_and_Relational_Operators">Logical &amp; Relational</a></li>
<li> <a class="external text" href="../../LabTalk/LabTalk/Operators.html#String_Concatenation">String Concatenation</a></li>
<li> <a class="external text" href="../../LabTalk/LabTalk/Operators.html#Conditional_Operator_.28.3F:.29">Conditional</a></li></ul>
</td>
<td>
<ul><li> <a class="external text" href="../../LabTalk/Script/LabTalk-Supported_Functions.html">Built-in</a></li>
<li> <a href="../../UserGuide/UserGuide/Create_a_User_Defined_Function_for_Set_Column_Values.html" title="UserGuide:Create a User Defined Function for Set Column Values">User-defined Origin C</a></li>
<li> <a class="external text" href="../../Python/Python/Calling_Python_Functions_from_LabTalk_and_Column_Formula.html">Python</a><sup>&#134;</sup></li></ul>
</td>
<td>
<ul><li> <a class="external text" href="../../LabTalk/LabTalk/Operators.html#Define_a_constant">Built-in</a></li>
<li> <a class="external text" href="../../LabTalk/LabTalk/Operators.html#Define_a_constant">User-defined</a></li></ul>
</td></tr></table>
<p><sup>&#134;</sup>Must be predefined in <b>Before Formula Scripts</b> panel, <b>Script Window</b>, etc.
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Quick_Start_SetColumnValues/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>Note that the Set Values menu commands <b>wcol(1)</b>, <b>Col(A)</b>, <b>Functions</b> and <b>Variables</b> are useful for browsing and inserting data references, functions, variables and constants into your Column Formula or Before Formula Scripts. Selected elements are inserted at the cursor. As of Origin 2017 SR0, these menu functions only support the older column and cell notation (not spreadsheet cell notation).
</p></td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Quick_Start_SetColumnValues/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>There is a quick way to load a conditional control or loop script when you are doing script in <b>Before Formula Script</b> box. Right click on <b>Before Formula Script</b> box to select <b>Conditional/Loop</b> at the bottom of the context menu, and then select a conditional structure or loop you desired in the flyout. The syntax will be added at cursor with simple comments.
</p></td></tr></table>
<p>For help with <b>Set Values</b> dialog box controls, see <a href="../../UserGuide/UserGuide/Menu_Options_and_Dialog_Controls.html" title="UserGuide:Menu Options and Dialog Controls"><b>Menu Options and Dialog Controls</b></a>.
</p>
<h3><a name="Column_Formula_Examples"></a><span class="mw-headline">Column Formula Examples</span></h3>
<p>These are examples of "stand alone" expressions that can be used in the <b>Column Formula</b> box.
</p>
<dl><dd><dl><dd><table class="simple" style="width: 80%">
<tr>
<th width="25%">New Spreadsheet Cell Notation
</th>
<th width="25%">Older Notation
</th>
<th width="50%">Description
</th></tr>
<tr>
<td> <b>B - C</b>
</td>
<td> <b>col(B)-col(C)</b>
</td>
<td> Returns the difference between col(B)[i] and col(C)[i].
</td></tr>
<tr>
<td> <b>2!B - 3!C</b>
</td>
<td> N/A
</td>
<td> Returns the difference between sheet index 2, col(B)[i] and sheet index 3, col(C)[i].
</td></tr>
<tr>
<td> <b>[Book2]Sheet1!A - [Book3]Sheet1!A</b>
</td>
<td> N/A
</td>
<td> Returns difference between [Book2]Sheet1!A[i] and [Book3]Sheet1!A[i]
</td></tr>
<tr>
<td> <b>[Book2]Sheet1!A - [Book3]Sheet1!A2</b>
</td>
<td> N/A
</td>
<td> Returns difference between [Book2]Sheet1!A[i] and [Book3]Sheet1!, cell A2
</td></tr>
<tr>
<td> <b>sin(pi*B)</b>
</td>
<td> <b>sin(pi*col(B))</b>
</td>
<td> Returns the sine of col(B)[i] times pi.
</td></tr>
<tr>
<td> <b>today()</b>
</td>
<td> no change
</td>
<td> Returns the current date.
</td></tr>
<tr>
<td> <b>A$ + B$</b>
</td>
<td> <b>col(A)$ + col(B)$</b>
</td>
<td> Internally converts column A and B into strings and concatenates them.
</td></tr>
<tr>
<td> <b>A&gt;0? A: Na()</b>
</td>
<td> <b>col(A)&gt;0? col(A): Na()</b>
</td>
<td> If col(A)&gt;0, returns value in col(A), otherwise returns missing value (see <a class="external text" href="../../LabTalk/LabTalk/NA_(function).html">LabTalk Utility Function, <b>Na()</b></a>).
</td></tr>
<tr>
<td> <b>B-B1</b>
</td>
<td> <b>col(B)-col(B)[1]</b>
</td>
<td> Subtracts the first point in column B from all other values in column B.
</td></tr>
<tr>
<td> <b>A + StartTime</b>
</td>
<td> N/A
</td>
<td> Adds the <a href="../../UserGuide/UserGuide/Named_Range.html" title="UserGuide:Named Range">named range</a> "StartTime" value to values in column A.
</td></tr>
<tr>
<td> <b>total(A[i-1:i+3])</b>
</td>
<td> <b>total(col(A)[i-3:i+3])</b>
</td>
<td> Returns the sum of a sub-range from i-3 to i+3 in col(A), where i is the row index.
</td></tr>
<tr>
<td> <b>sum(A:C, D:G, F)</b>
</td>
<td> N/A
</td>
<td> Returns the row-wise sum of a values in columns A to C, D to G, and F.
</td></tr>
<tr>
<td> <b>(wcol(j)*2)-1</b>
</td>
<td> no change
</td>
<td> Can be used to transform the <i>j</i><sup>th</sup> column (all selected columns) by multiplying each value by 2 and subtracting 1.
</td></tr></table></dd></dl></dd></dl>
<table class="note">
<tr>
<td><b>Note:</b> When using <b>i</b> and <b>j</b> in <b>Set Values</b> or in the <a class="external text" href="../../UserGuide/UserGuide/Displaying_Supporting_Data_in_Worksheet_Header_Rows.html#F.28x.29.3D"><b>F(x)=</b> column label row</a>, <i>you must refer to them using lowercase letters</i>. Uppercase <b>I</b> and <b>J</b> will be interpreted as worksheet column short names.
</td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Quick_Start_SetColumnValues/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>Use "end" or "0" to define the last cell in a column, e.g. <code>total(A[10:end])-B[i]</code> or <code>total(A[10:0])-B[i]</code>.
</p></td></tr></table>
<h3><a name="Autocomplete"></a><span class="mw-headline">Autocomplete</span></h3>
<p>Starting with <b>Origin 2022</b>, the column formula box in <b>Set Values</b> and <a href="../../UserGuide/UserGuide/Displaying_Supporting_Data_in_Worksheet_Header_Rows.html#F.28x.29.3D" title="UserGuide:Displaying Supporting Data in Worksheet Header Rows"><b>F(x)=</b> label row</a> get autocompletion support for <a class="external text" href="../../LabTalk/Script/LabTalk-Supported_Functions.html">LabTalk-supported functions</a> and <a href="../../UserGuide/UserGuide/Named_Range.html" title="UserGuide:Named Range">named ranges</a>. 
</p><p>If you do not wish to use the feature, you can disable it for column and/or <a href="../../UserGuide/UserGuide/Using_Formulae_to_Set_Cell_Values.html" title="UserGuide:Using Formulae to Set Cell Values">cell formulas</a>/F(x)=:
</p>
<ol><li> Click <b>Preferences: System Variables</b>.</li>
<li> In an empty <b>Variable</b> cell, type <a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#F.2CG"><b>FAC</b></a>.</li>
<li> Enter one of the following in the <b>Value</b> cell (values are additive): <i>0</i> = turn off autocomplete, <i>1</i> = enable for cell formula and the <b>F(x)=</b> label row, <i>2</i> = enable for column formula, <i>3</i> (default) = enable for cell formula/F(x)= and column formula.</li>
<li> Click <b>OK</b> to close the dialog.</li></ol>
<h2><a name="Reusing_Formulas"></a><span class="mw-headline">Reusing Formulas</span></h2>
<p>If you want to reuse your Set Values formulas, along with <b>Before Formula Scripts</b> and <b>Python Function</b> code, you can:
</p>
<ul><li> Save the formula by (1) clicking <b>Formula: Save As</b> on the Set Values menu bar or (2) by clicking the <b>Save Formula</b> button <a  class="image"><img alt="Button Save X Function.png" src="../images/Quick_Start_SetColumnValues/Button_Save_X_Function.png?v=21808" width="22"  /></a> in Set Values. To reload your formula in Set Values, click <b>Formula: Load</b> and choose your formula. With the column label row <a href="../../UserGuide/UserGuide/Displaying_Supporting_Data_in_Worksheet_Header_Rows.html#F.28x.29.3D" title="UserGuide:Displaying Supporting Data in Worksheet Header Rows"><b>F(x)=</b> cell</a> selected, choose <b>Column: Fill with User Formula</b> or right-click in the cell and choose <b>Load</b>.</li>
<li> You can save Set Values formulas with a <a href="../../UserGuide/UserGuide/What_is_Saved_with_the_Workbook_Template.html#Set_Values_dialog_box" title="UserGuide:What is Saved with the Workbook Template">workbook template</a>. When you open an instance of the workbook template, your Set Values formula(s) will be ready for use.</li></ul>
<h2><a name="A_Note:_When_Column_Formulas_do_not_Automatically_Update"></a><span class="mw-headline">A Note: When Column Formulas do not Automatically Update</span></h2>
<p>When using the new simplified syntax, you can define a column formula in column C that refers to values in column A and column B, then insert a column between column A and B and column references in the formula will update as column short names are reassigned. However, this behavior is not supported under <i>any</i> of the following conditions:
</p>
<ul><li> The column formula uses the <a class="external text" href="../../LabTalk/LabTalk/Col_(function).html"><b>col()</b></a> or <a class="external text" href="../../LabTalk/LabTalk/WCol_(function).html"><b>wcol()</b></a> functions.</li>
<li> Your column formula uses a script entered into the <a href="../../UserGuide/UserGuide/Entering_Expressions_in_the_Set_Column_Dialog.html#Add_Expressions_in_both_Column_Formula_and_Before_Formula_Scripts" title="UserGuide:Entering Expressions in the Set Column Dialog"><b>Before Formula Scripts</b></a> box in Set Values.</li>
<li> Your column formula contains brackets "<b>{}</b>".</li>
<li> Your column formula contains sheet index references as opposed to sheet name references (e.g. 1!A vs. Sheet1!A).</li></ul>
<p>When a column formula is affected by any of these conditions, the column formula will not be updated.
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">Additional Information</span></h2>
<dl><dd><ul><li> <a href="../../UserGuide/Category/Using_Formulae_to_Set_or_Transform_Worksheet_Column_Values.html" title="Category:Using Formulae to Set or Transform Worksheet Column Values">Opening the Set Values dialog box</a>.</li>
<li> <a href="../../UserGuide/UserGuide/Entering_Expressions_in_the_Set_Column_Dialog.html" title="UserGuide:Entering Expressions in the Set Column Dialog">Entering expressions in the Set Values dialog box</a>.</li>
<li> <a href="../../UserGuide/UserGuide/Displaying_Supporting_Data_in_Worksheet_Header_Rows.html#F.28x.29" title="UserGuide:Displaying Supporting Data in Worksheet Header Rows">Displaying and editing column formulas in column label rows</a>.</li>
<li> <a href="../../UserGuide/UserGuide/Menu_Options_and_Dialog_Controls.html" title="UserGuide:Menu Options and Dialog Controls">Set Values dialog box menu options and dialog box controls</a>. </li>
<li> <a class="external text" href="../../LabTalk/Script/LabTalk-Supported_Functions.html">LabTalk Supported Functions for use in the Set Values dialog box</a>.</li>
<li> <a href="../../UserGuide/UserGuide/Create_a_User_Defined_Function_for_Set_Column_Values.html" title="UserGuide:Create a User Defined Function for Set Column Values">Creating a user-defined function for use in the Set Values dialog box</a>.</li></ul></dd></dl>
<h2><a name="Two_Quick_Examples"></a><span class="mw-headline">Two Quick Examples</span></h2>
<h3><a name="Set_Values_for_a_Single_Column"></a><span class="mw-headline">Set Values for a Single Column</span></h3>
<p>The following short tutorial will show you how to use this dialog to generate data for a simulated gaussian curve.
</p>
<ol>
<li>Create a new workbook by clicking the <b>New Workbook</b> button <a  class="image"><img alt="New Workbook.png" src="../images/Quick_Start_SetColumnValues/New_Workbook.png?v=305" width="25"  /></a> on the <b>Standard</b> toolbar. 
<li>Highlight column A and right-click on it to select <b>Set Column Values</b> from the short-cut menu to open the <b>Set Values</b> dialog. 
<li>Enter <b>{-1:0.03:5}</b> in the <b>Column Formula</b> edit box and then click the <b>Apply</b> button. Column A should be filled with a series of numbers.
<li>Then we will use the one of the <a href="../../UserGuide/UserGuide/Menu_Options_and_Dialog_Controls.html#Column_First.2FNext.2FPrev.2FLast" title="UserGuide:Menu Options and Dialog Controls">navigation buttons</a> to let you input an expression for the second column without closing the dialog. Click the <b>Next</b> button <a  class="image"><img alt="Next Button.png" src="../images/Quick_Start_SetColumnValues/Next_Button.png?v=17532" width="20"  /></a>. You will see that column B is highlighted in the worksheet. 
<li>Now enter <b>1 + (5/(1.5*sqrt(PI/2)))*exp(-2*((A-2)/1.5)^2)</b> in the <b>Column Formula</b> edit box and choose <b>Auto</b> in the <b>Recalculate</b> drop-down list.
<li>Click the <b>OK</b> button. The <b>Set Values</b> dialog is closed. You will see the results in the following worksheet. <br />(If you create a line graph of column B, you will get a graph similar to the one next to the workbook.)
<dl><dd><a  class="image"><img alt="Quick Start SetColumnValues 1.png" src="../images/Quick_Start_SetColumnValues/Quick_Start_SetColumnValues_1.png?v=81698" width="763"  /></a></dd></dl>
<li>Double click on the <b>F(X)</b> column label row of column B, and change the formula to <b>1+5/(1.5*sqrt(PI/2))*exp(-2*(A-2)/1.5*2)</b>. You will find the value in the column B is updated automatically. <br />(Click the <b>Rescale</b> <a  class="image"><img alt="Button Rescale.png" src="../images/Quick_Start_SetColumnValues/Button_Rescale.png?v=1883" width="23"  /></a> button, the graph is also updated.)
<dl><dd><a  class="image"><img alt="Quick Start SetColumnValues 2.png" src="../images/Quick_Start_SetColumnValues/Quick_Start_SetColumnValues_2.png?v=81699" width="763"  /></a></dd></dl>
</ol>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Quick_Start_SetColumnValues/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>Origin supports using a sub-range of a column as function argument in the <b>Set Values</b> dialog.
</p><p><b>For example:</b>  To calculate the sum of a sub-range from <b>i-3</b> to <b>i+3</b> in column A (where " <b>i</b> " is the row index),  you can enter a formula in the <b>Column Formula</b> edit box.
</p>
<pre class="lt" style="font-family:monospace;">Total<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#91;</span>i<span style="color: #000080;">-</span><span style="color: #0000dd;">3</span><span style="color: #000000;">:</span>i<span style="color: #000080;">+</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span></pre> 
</td></tr></table>
<h3><a name="Set_Values_for_Multiple_Columns"></a><span class="mw-headline">Set Values for Multiple Columns</span></h3>
<p>The following short tutorial will show you how to use this dialog to set values for multiple columns simultaneously.
</p>
<ol>
<li> Create a new project by clicking the <b>New Project</b> button <a  class="image"><img alt="Button New Project.png" src="../images/Quick_Start_SetColumnValues/Button_New_Project.png?v=1846" width="22"  /></a> on the <b>Standard</b> toolbar.
<li> Click the <b>Import Multiple ASCII</b> button <a  class="image"><img alt="Button Import Multiple ASCII.png" src="../images/Quick_Start_SetColumnValues/Button_Import_Multiple_ASCII.png?v=1805" width="23"  /></a> to import the files <i>F1,dat</i> and <i>F2.dat</i> in the <i>&lt;Origin Folder&gt;\Samples\Import and Export\</i> path. In the <b>impASC</b> dialog, set <b>Multi-File (except 1st) Import Mode</b> to <b>Start New Books</b> and click <b>OK</b>.
<li> Two workbooks will be created, named as F1 and F2. Click the <b>New Workbook</b> button <a  class="image"><img alt="New Workbook.png" src="../images/Quick_Start_SetColumnValues/New_Workbook.png?v=305" width="25"  /></a> on the <b>Standard</b> toolbar to create another workbook.
<li> With the 3rd workbook active, click <b>Add New Columns</b> button <a  class="image"><img alt="Button Add New Columns.png" src="../images/Quick_Start_SetColumnValues/Button_Add_New_Columns.png?v=23250" width="22"  /></a> to add a column. Highlight all columns, select <b>Column: Set Multiple Columns Values</b> from the main menu or right-click the columns to select <b>Set Multiple Columns Values</b> in the context menu to open the <b>Set Values</b> dialog.
<li> Expand the bottom panel by clicking the Show Scripts button <a  class="image"><img alt="Button Show Scripts.png" src="../images/Quick_Start_SetColumnValues/Button_Show_Scripts.png?v=36233" width="23"  /></a>. Enter below scripts in the <b>Before Formula Scripts</b> edit box, 
<pre class="lt" style="font-family:monospace;">range r1<span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>F1<span style="color: #000000;">&#93;</span>F1<span style="color: #000080;">!</span>wcol<span style="color: #000000;">&#40;</span>j<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//&quot;j&quot; is the column index.</span>
range r2<span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>F2<span style="color: #000000;">&#93;</span>F2<span style="color: #000080;">!</span>wcol<span style="color: #000000;">&#40;</span>j<span style="color: #000000;">&#41;</span>;</pre>
<li> Enter <b>(r1+r2)/2</b> in the <b>Column Formula</b> edit box 
<li> Select <b>Options: Direct Edit Formula Cell</b> to uncheck the option. 
<li> Select <b>Options: Formula Text...</b> and enter <i>(F1+F2)/2</i> in the <b>Formula Text</b> dialog, then click <b>OK</b> button.
<li> Click the <b>OK</b> button in the <b>Set Values</b> dialog. You will see the results in the worksheet, and <i>(F1+F2)/2</i> will display in the <b>F(x)</b> column label row instead of the formula.
</ol>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Quick_Start_SetColumnValues/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>When defining variables in <b>Before Formula Scripts</b>, use lower-case letters for variable names (e.g "r1" not "R1"). Use of upper-case letters will generate an error like the following:
<p><font face="courier" color="red">Column short name restriction is on. R1 refers to cell and cannot be defined as variable. Failed to create operation for Book1_G due to error in Set Column Value scripts.</font>
</p>
</p></td></tr></table>
<h2><a name="The_Python_Function_Tab"></a><span class="mw-headline">The Python Function Tab</span></h2>
<p>Python functions can be called from the <b>Column Formula</b> box or from the <b>Before Formula Scripts</b> tab, depending upon your needs. Those functions can be defined in an external file or they can be defined in the <b>Python Function</b> tab of Set Values. The advantage to defining them in the Set Values dialog is that they are saved with the project; or with a template for repeat use.
</p><p>Python functions are defined on the tab in the form of ...
</p>
<pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">def</span> ff<span style="color: #000;">&#40;</span>a<span style="color: #000;">&#41;</span></pre>
<p>... and called on the <b>Before Formula Scripts</b> tab or in the <b>Column Formula</b> box as ...
</p>
<pre class="python" style="font-family:monospace;">py.<span style="color: #000;">ff</span><span style="color: #000;">&#40;</span>a<span style="color: #000;">&#41;</span></pre>
<p><br />
For more information on using Python in the Set Values dialog see <a class="external text" href="../../Python/Python/Set_Column_Values.html"><b>Using Python in Tools and Dialogs &gt; Set Column Values</b></a>.
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Quick_Start_SetColumnValues/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>If the <b>F(x)=</b> cell (1) begins "<b>py.</b>" and (2) calls a Python function defined in an external file, you can right-click on the <b>F(x)=</b> cell and choose <b>Open Python File</b> to open the Python function in <a class="external text" href="https://www.originlab.com/python/doc/originpro/annotated.html" target="_blank">the <b>Code Builder</b> IDE</a>
</p></td></tr></table>
<h3><a name="Example"></a><span class="mw-headline">Example</span></h3>
<p>This simple tutorial will show you how to define a function on the <b>Python Function</b> tab and call it in the <b>Column Formula</b> box:
</p>
<ol>
<li> Starting with a new workbook, click the <b>Import Single ASCII</b> button <a  class="image"><img alt="Button Import Single ASCII.png" src="../images/Quick_Start_SetColumnValues/Button_Import_Single_ASCII.png?v=1806" width="23"  /></a> on the <b>Import</b> toolbar.
<li> Browse to and open the file &lt;Origin Program Folder&gt;\Samples\Signal Processing\Signal with High Frequency Noise.dat.
<li> Click the <b>Add New Column</b> button <a  class="image"><img alt="Button Add New Columns.png" src="../images/Quick_Start_SetColumnValues/Button_Add_New_Columns.png?v=23250" width="22"  /></a> on the Standard toolbar.
<li> Click on the new column heading to select the column, then right-click and choose <b>Set Column Values</b>.
<li> If it is not displayed, expand the bottom panel by clicking the <b>Show Scripts</b> button <a  class="image"><img alt="Button Show Scripts.png" src="../images/Quick_Start_SetColumnValues/Button_Show_Scripts.png?v=36233" width="23"  /></a>.
<li> Click the <b>Python Functions</b> tab and copy and paste the following:
<pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">import</span> numpy <span style="color: #ff7700;font-weight:bold;">as</span> np
<span style="color: #ff7700;font-weight:bold;">from</span> scipy <span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #000;">signal</span>
<span style="color: #ff7700;font-weight:bold;">def</span> smooth<span style="color: #000;">&#40;</span>y<span style="color: #000;">,</span>npts<span style="color: #000;">,</span> norder<span style="color: #000;">&#41;</span>:
     <span style="color: #0a0;">&quot;&quot;&quot;
     F:Fii
     Perform Savitzky-Golay smoothing using scipy signal
     &quot;&quot;&quot;</span>
     <span style="color: #d00; font-style: italic;">#npts: number of points for smoothing window</span>
     <span style="color: #d00; font-style: italic;">#norder: polynomial order</span>
     y<span style="color: #000;">=</span><span style="color: #000;">signal</span>.<span style="color: #000;">savgol_filter</span><span style="color: #000;">&#40;</span> np.<span style="color: #000;">array</span><span style="color: #000;">&#40;</span>y<span style="color: #000;">&#41;</span><span style="color: #000;">,</span> npts<span style="color: #000;">,</span> norder <span style="color: #000;">&#41;</span>
     <span style="color: #ff7700;font-weight:bold;">return</span> y</pre>
<li> Click into the Column Formula box and enter the following:
<pre class="lt" style="font-family:monospace;">py.<span style="color: #000080;">smooth</span><span style="color: #000000;">&#40;</span>B,<span style="color: #0000dd;">101</span>,<span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span></pre>
<li> Click <b>OK</b> and the column is filled with smoothed values.
</ol>


