<h1 class="firstHeading">4.4.3 Join Two Sheets by Column</h1><p class='urlname' style='display: none'>join-worksheets-bycol</p>
<p><br />
When you have two worksheets and want to combine them by column, considering that there are reference columns which should be matched, you can use the <b>Join Two Sheets by Column</b> tool.
</p>
<table class="note">

<tr>
<td><b>Note:</b> If you have more than two worksheets to join together, please use the <a href="../../UserGuide/UserGuide/Join_Multiple_Sheets_by_Column.html" title="UserGuide:Join Multiple Sheets by Column">Join Multiple Sheets by Column</a> tool.
</td></tr></table>
<p><br />
<span class='headerInParagraph'>To open this tool, </span>
</p>
<ul><li> with a workbook window active, select <b>Restructure: Join Two Sheets by Column</b> menu.</li></ul>
<dl><dd><a  class="image"><img alt="Join Worksheets by Column 01.png" src="../images/Join_Worksheets_by_Column/Join_Worksheets_by_Column_01.png?v=89807" width="662"  /></a></dd></dl>
<p>This tool utilizes the <a class="external text" href="../../XFunction/X-Function/Wjoincols.html">Wjoincols</a> X-Function.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Recalculate"><span class="tocnumber">1</span> <span class="toctext">Recalculate</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Specify_worksheets_and_columns_to_join"><span class="tocnumber">2</span> <span class="toctext">Specify worksheets and columns to join</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Control_Options"><span class="tocnumber">2.1</span> <span class="toctext">Control Options</span></a>
<ul>
<li class="toclevel-3 tocsection-4"><a href="#Drop_Non-matches"><span class="tocnumber">2.1.1</span> <span class="toctext">Drop Non-matches</span></a></li>
<li class="toclevel-3 tocsection-5"><a href="#Drop_Multiples"><span class="tocnumber">2.1.2</span> <span class="toctext">Drop Multiples</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Specify_matching_columns"><span class="tocnumber">3</span> <span class="toctext">Specify matching columns</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#Matching_Columns"><span class="tocnumber">3.1</span> <span class="toctext">Matching Columns</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Match_with_All_Combinations"><span class="tocnumber">3.2</span> <span class="toctext">Match with All Combinations</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Merge_Matched_Columns_as_One"><span class="tocnumber">3.3</span> <span class="toctext">Merge Matched Columns as One</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Consider_Missing_Value"><span class="tocnumber">3.4</span> <span class="toctext">Consider Missing Value</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-11"><a href="#Output_worksheet"><span class="tocnumber">4</span> <span class="toctext">Output worksheet</span></a>
<ul>
<li class="toclevel-2 tocsection-12"><a href="#Sort_Output"><span class="tocnumber">4.1</span> <span class="toctext">Sort Output</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#Dataset_Identifier"><span class="tocnumber">4.2</span> <span class="toctext">Dataset Identifier</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="Recalculate"></a><span class="mw-headline">Recalculate</span></h2>
<p>Specify the <a href="../../UserGuide/UserGuide/Recalculating_Analysis_Results.html" title="UserGuide:Recalculating Analysis Results">Recalculate Mode</a>.
</p>
<h2><a name="Specify_worksheets_and_columns_to_join"></a><span class="mw-headline">Specify worksheets and columns to join</span></h2>
<p>The left panel of the dialog has two column tables, <b>w1</b> and <b>w2</b>. Checkboxes under each table control the settings of its owned sheet, respectively.
</p>
<ol><li>Select two sheets to join from <b>Sheet1 (w1)</b> and <b>Sheet2 (w2)</b> drop-down list, or <b>...</b> button next to it. </li>
<li>From the column tables, select the columns to combine in the joined worksheet. Unchecked columns will be excluded from the result sheet.</li></ol>
<h3><a name="Control_Options"></a><span class="mw-headline">Control Options</span></h3>
<h4><a name="Drop_Non-matches"></a><span class="mw-headline">Drop Non-matches</span></h4>
<p>To exclude the unmatched cells from the joined worksheet, check this checkbox. Otherwise, columns of non-match values will fill with missing values.
</p><p><a  class="image"><img alt="Join worksheet drop nonmatches.png" src="../images/Join_Worksheets_by_Column/Join_worksheet_drop_nonmatches.png?v=86949" width="498"  /></a>
</p>
<h4><a name="Drop_Multiples"></a><span class="mw-headline">Drop Multiples</span></h4>
<p>This is supposed to be used when there are multiple matched cells for one value. Check this checkbox to merge the multiples by statistics value specified in <b>Merge Multiples by</b> and the replica will be dropped.
</p><p><a  class="image"><img alt="Join worksheet drop multiples.png" src="../images/Join_Worksheets_by_Column/Join_worksheet_drop_multiples.png?v=87046" width="503"  /></a>
</p>
<h2><a name="Specify_matching_columns"></a><span class="mw-headline">Specify matching columns</span></h2>
<h3><a name="Matching_Columns"></a><span class="mw-headline">Matching Columns</span></h3>
<p>Check the matching columns in <b>w1</b> and <b>w2</b> column table and click <b>-&gt;</b> button to add the condition of joining worksheets in <b>Matching Columns</b> table. If multiple conditions exist, all conditions must be matched.
</p><p>For example, if <code>w1.A=w2.A</code> is specified in <b>Matching Columns</b>, all values in column A of both sheet w1 and w2 will be compared and the matched rows will be combined as the same row in the joined worksheet.. 
Suppose all options are set to 0:
</p><p><a  class="image"><img alt="Join worksheet matching columns.png" src="../images/Join_Worksheets_by_Column/Join_worksheet_matching_columns.png?v=86945" width="463"  /></a>
</p>
<h3><a name="Match_with_All_Combinations"></a><span class="mw-headline">Match with All Combinations</span></h3>
<p>When there are multiple matched cells for one value, you can check this check box to show all possible combinations in result worksheet. 
</p><p><a  class="image"><img alt="Join worksheet match with all combinations.png" src="../images/Join_Worksheets_by_Column/Join_worksheet_match_with_all_combinations.png?v=87047" width="518"  /></a>
</p>
<h3><a name="Merge_Matched_Columns_as_One"></a><span class="mw-headline">Merge Matched Columns as One</span></h3>
<p>Specify whether to keep only one matching column in the joined worksheet.
</p><p><a  class="image"><img alt="Join worksheet merge matched columns as one.png" src="../images/Join_Worksheets_by_Column/Join_worksheet_merge_matched_columns_as_one.png?v=87048" width="513"  /></a>
</p>
<h3><a name="Consider_Missing_Value"></a><span class="mw-headline">Consider Missing Value</span></h3>
<p>Check this checkbox to consider missing value in the matching columns as a value to be compared. Uncheck will ignore rows with missing value.
</p>
<h2><a name="Output_worksheet"></a><span class="mw-headline">Output worksheet</span></h2>
<h3><a name="Sort_Output"></a><span class="mw-headline">Sort Output</span></h3>
<p>Control how to sort the order of matched values in the joined sheet:
</p>
<dl><dd><ul><li><b>Matching Columns -- Ascending</b></li>
<li><b>Matching Columns -- Descending</b> <br />If <b>Merge Matched Columns as One</b>: merge all matched values into one column. If not selected, <b>Matching Columns â€“ Ascending/Descending</b> will sort output columns of each source sheet respectively.</li>
<li><b>Preserve sheet order</b>: sort by order of matched values found in the sheet specified in <b>Sheet</b>.</li>
<li><b>by Specified Columns -- Ascending</b>: sort the joined worksheet by column specified in <b>Column</b> ascendingly.</li>
<li><b>by Specified Columns -- Descending</b>: sort the joined worksheet by column specified in <b>Column</b> descendingly.</li></ul></dd></dl>
<h3><a name="Dataset_Identifier"></a><span class="mw-headline">Dataset Identifier</span></h3>
<p>Specify whether to add a parameter label row named <b>Source</b> to the joined worksheet for identifying the source of dataset.
</p>
<dl><dd><ul><li>If <b>None</b>, identifier label row will not be added.</li>
<li>When <b>Merge Matched Column by On</b> is checked, and <b>Range</b>/<b>Book Name</b>/<b>Sheet Name</b>/<b>Index</b> is selected as Identifier, <b>Source</b> label row of the matched column will show "Merged".</li>
<li><b>Index</b>: identify source sheet by index specified in <b>Index</b>. Format is <b><i>StartIndex</i>:<i>Increment</i></b>. For example, <code>1:2</code> will identify columns from w1 as "1" and w2 as "3".</li>
<li> <b>Sheet Label</b>: Show the <a href="../../UserGuide/UserGuide/Basic_Operations_on_Worksheet.html#Name_and_Notes" title="UserGuide:Basic Operations on Worksheet">sheet label</a> of source worksheet.</li></ul></dd></dl>






