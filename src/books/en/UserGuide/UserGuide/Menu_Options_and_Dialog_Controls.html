<h1 class="firstHeading">4.6.8.2 Menu Options and Dialog Controls</h1><p class='urlname' style='display: none'>Wks-SetColVal-MenuOpt-Dialog</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Formula_Menu"><span class="tocnumber">1</span> <span class="toctext">Formula Menu</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#wcol.281.29_Menu"><span class="tocnumber">2</span> <span class="toctext">wcol(1) Menu</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Col.28A.29_Menu"><span class="tocnumber">3</span> <span class="toctext">Col(A) Menu</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Function_Menu"><span class="tocnumber">4</span> <span class="toctext">Function Menu</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Variables_Menu"><span class="tocnumber">5</span> <span class="toctext">Variables Menu</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#Example:_Inserting_SYSTEM_variables_into_your_column_formula"><span class="tocnumber">5.1</span> <span class="toctext">Example: Inserting SYSTEM variables into your column formula</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-7"><a href="#Options_Menu"><span class="tocnumber">6</span> <span class="toctext">Options Menu</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Range.2FColumn_controls"><span class="tocnumber">7</span> <span class="toctext">Range/Column controls</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Target_Column"><span class="tocnumber">8</span> <span class="toctext">Target Column</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#Column_First.2FNext.2FPrev.2FLast"><span class="tocnumber">9</span> <span class="toctext">Column First/Next/Prev/Last</span></a></li>
<li class="toclevel-1 tocsection-11"><a href="#Column_Formula"><span class="tocnumber">10</span> <span class="toctext">Column Formula</span></a></li>
<li class="toclevel-1 tocsection-12"><a href="#Recalculate"><span class="tocnumber">11</span> <span class="toctext">Recalculate</span></a></li>
<li class="toclevel-1 tocsection-13"><a href="#Buttons"><span class="tocnumber">12</span> <span class="toctext">Buttons</span></a></li>
<li class="toclevel-1 tocsection-14"><a href="#Before_Formula_Scripts"><span class="tocnumber">13</span> <span class="toctext">Before Formula Scripts</span></a></li>
<li class="toclevel-1 tocsection-15"><a href="#Search_and_Insert_Functions"><span class="tocnumber">14</span> <span class="toctext">Search and Insert Functions</span></a></li>
</ul>
</div>

<h2><a name="Formula_Menu"></a><span class="mw-headline">Formula Menu</span></h2>
<p>The menu options under <b>Formula</b> are used to operate expressions, such as saving and loading expressions.
</p>
<table class="simple">

<tr>
<th><span class="menu">Load Sample</span>
</th>
<td>
<p>Load a sample formula.
</p>
</td></tr>
<tr>
<th><span class="menu">Load</span>
</th>
<td>
<p>Load a saved formula.
</p>
</td></tr>
<tr>
<th><span class="menu">Save</span>
</th>
<td>
<p>Save the current formula, including contents of <b>Before Formula Scripts</b> and <b>Python Function</b> tabs.
</p>
</td></tr>
<tr>
<th><span class="menu">Save As</span>
</th>
<td>
<p>Save the formula to another name.
</p>
</td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Menu_Options_and_Dialog_Controls/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>You can also load formulas directly in the column label row <a href="../../UserGuide/UserGuide/Displaying_Supporting_Data_in_Worksheet_Header_Rows.html#F.28x.29.3D" title="UserGuide:Displaying Supporting Data in Worksheet Header Rows"><b>F(x)=</b> cell</a>. Select the cell, then choose <b>Column: Fill with User Formula</b>; or right-click in the cell and choose <b>Load</b>.
</p></td></tr></table>
<h2><a name="wcol.281.29_Menu"></a><span class="mw-headline">wcol(1) Menu</span></h2>
<p>Origin lists all the columns of the current worksheet in the form of <b>WCol(<i>N</i>): Short Name"Long Name"</b>, where <b>N</b> is the index of a column. You can select one of them to add to <b>Column Formula</b> or <b>Before Formula Scripts</b> so that you can use the column in your expression. Whether to add the selected column to the <b>Column Formula</b> edit box or the <b>Before Formula Scripts</b> edit box depends on where the cursor is.
</p>
<table class="simple">

<tr>
<th><span class="menu">WCol(<i>N</i>): Short Name"Long Name"</span>
</th>
<td>
<p>You can select this menu option to add <b>wcol(<i>N</i>)</b> to <b>Column Formula</b> or <b>Before Formula Scripts</b>.  <i>N</i> is the index of a column.
</p>
</td></tr>
<tr>
<th><span class="menu">Column Browser</span>
</th>
<td>
<p>Select this to open the <b>Column Browser</b> dialog which helps you to choose the column to add.  
</p>
</td></tr></table>
<h2><a name="Col.28A.29_Menu"></a><span class="mw-headline">Col(A) Menu</span></h2>
<p>Origin lists all the columns of the current worksheet in the form of <b>Col(<i>Long Name</i>): <i>Short Name</i></b>, such as <i>Col("Time"): A</i>. You can select one of them to add to <b>Column Formula</b> or <b>Before Formula Scripts</b> so that you can use the column in your expression. Whether to add the selected column to the <b>Column Formula</b> edit box or the <b>Before Formula Scripts</b> edit box depends on where the cursor is.
</p>
<table class="simple">

<tr>
<th><span class="menu">Prefer Long Name</span>
</th>
<td>
<p>Prefer using the long name to specify the colomn name, Col(<i>Lone Name</i>): <i>Short Name</i>. Checked by default (Set system variable <a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#S">@SCVPL</a> to change the detault). 
</p>
</td></tr>
<tr>
<th><span class="menu">Col(<i>Short Name</i>): <i>Long Name</i></span>
</th>
<td>
<p>You can select this menu option to add <b>Col(<i>Long Name</i>)</b> to <b>Column Formula</b> or <b>Before Formula Scripts</b>.  
</p>
</td></tr>
<tr>
<th><span class="menu">Column Browser</span>
</th>
<td>
<p>Select this to open the <b>Column Browser</b> dialog which helps you to choose the column to add.  
</p>
</td></tr></table>
<h2><a name="Function_Menu"></a><span class="mw-headline">Function Menu</span></h2>
<p>This menu can be used to add functions for building the expression. You can select a function and insert it in either the <b>Column Formula</b> or the <b>Before Formula Scripts</b> edit box. Functions are inserted at the cursor. 
</p>
<table class="simple">

<tr>
<th><span class="menu">Recent Used</span>
</th>
<td>
<p>Functions which have been used are automatically added to this menu.
</p>
</td></tr>
<tr>
<th><span class="menu">Search and Insert...</span>
</th>
<td>
<p>Open the <a href="../../UserGuide/UserGuide/Menu_Options_and_Dialog_Controls.html#Search_and_Insert_Functions" title="UserGuide:Menu Options and Dialog Controls"><b>Search and Insert Functions</b></a> dialog to search for built-in functions. 
</p>
</td></tr>
<tr>
<th><span class="menu">Functions in different categories</span>
</th>
<td>
<p>Select a function to add to <b>Column Formula</b> or <b>Before Formula Scripts</b>. For more on these functions, refer to <a class="external text" href="../../LabTalk/Script/LabTalk-Supported_Functions.html">LabTalk supported functions</a>.
</p>
</td></tr></table>
<h2><a name="Variables_Menu"></a><span class="mw-headline">Variables Menu</span></h2>
<p>The options in this menu have been supported since <b>Origin 8.1 SR0</b>. Use menu commands to insert variables into the <b>Before Formula Script</b> edit box.
</p>
<table class="simple">

<tr>
<th><span class="menu">Predefined Variables</span>
</th>
<td>
<p>Add a variable or a constant to <b>Column Formula</b> or <b>Before Formula Scripts</b>. Available variables and constants include:
</p>
<ul><li><i>This</i>
<dl><dd>Use to denote the current column. Use This<i>n</i>  to refer to <i>n</i>th cell in the current column</dd>
<dd><b>Note</b>: this variable is only available when <a class="external text" href="../../UserGuide/UserGuide/Folder_and_Window_Properties_Dialog.html#Window_Properties_dialog%7C"><b>Spreadsheet Cell Notation</b></a> is turned on. And it cannot be used in the <b>Before Formula Script</b> edit box.</dd></dl></li>
<li><i>[i]</i>
<dl><dd>Use to denote the row index.</dd></dl></li>
<li><i>pi</i>
<dl><dd>This is the PI constant. </dd></dl></li>
<li><i>j</i>
<dl><dd>Use to denote the column index.</dd></dl></li>
<li><i>wcol(j)</i>
<dl><dd>This is the Current column(s).</dd></dl></li></ul>
</td></tr>
<tr>
<th>Project Variables
</th>
<td>Add project variables to <b>Column Formula</b> or <b>Before Formula Scripts</b>. Up to 10 project variables (and their values) are listed in the sub-menu. View and select all project variables from the <a href="../../UserGuide/UserGuide/The_Project_Variables_Dialog_Box.html" title="UserGuide:The Project Variables Dialog Box"><b>Project Variables</b></a> dialog opened by clicking <b>More...</b> sub-item.
</td></tr>
<tr>
<th>Add Range Variable
</th>
<td>
<p>Opens the <a class="external text" href="../../UserGuide/UserGuide/Specifying_Your_Input_Data.html#Dataset_Browser.2FRange_Browser"><b>Range Browser</b></a> and helps you to define range variables. 
</p>
</td></tr>
<tr>
<th>Add Info Variable
</th>
<td>
<p>Opens the <a href="../../UserGuide/UserGuide/The_Insert_Variables_Dialog_Box.html" title="UserGuide:The Insert Variables Dialog Box"><b>Insert Variable</b> dialog</a> Info tab, to help you insert variable values and file metadata stored in the page object.
</p><p>One of the more useful options here is to store key variable values in <a class="external text" href="../../LabTalk/LabTalk/System_Variables.html#V1.2C_V1.24.E2.80.93V4.2C_V4.24">System Variables <b>v1</b> - <b>v4</b></a>. This allows you to store a limited number of numeric values (type = double) in the workbook. For guidance, see the Example at the end of this section.
</p>
</td></tr>
<tr>
<th>Add Column Label Cell
</th>
<td>
<p>Opens the <a href="../../UserGuide/UserGuide/The_Insert_Variables_Dialog_Box.html" title="UserGuide:The Insert Variables Dialog Box"><b>Insert Variable</b> dialog</a> Label tab, to help you insert variables associated with column label cells. <b>Hint:</b> Use the panel to the right side to choose the book, sheet and column that contains the label cell data that you wish to insert.
</p>
</td></tr>
<tr>
<th>Add Range Variable by Selection...
</th>
<td> It minimizes the Set Column Values dialog to select the range variable from Worksheet to insert.
</td></tr>
<tr>
<th>Add Column Label Cell by Selection...
</th>
<td> It minimizes the Set Column Values dialog to insert variables that point to column label cells by selection.
</td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Menu_Options_and_Dialog_Controls/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>When a range variable has been added through <b>Add Range Variable by Selection</b> menu for the first time, an <b>Insert Mode</b> dialog pops up and you could select different syntax referring to a range. Available options are <b>Column Notation: Col(A)</b>, <b>Long Name&#160;: A</b>, <b>Short Name&#160;: A</b> and <b>Index&#160;: wcol(1)</b>.
</p></td></tr></table>
<h3><a name="Example:_Inserting_SYSTEM_variables_into_your_column_formula"></a><span class="mw-headline">Example: Inserting SYSTEM variables into your column formula</span></h3>
<p>The workbook can store four numeric (double) values and four string variable values. <a class="external text" href="../../LabTalk/LabTalk/System_Variables.html#V1.2C_V1.24.E2.80.93V4.2C_V4.24">These pre-defined SYSTEM variables</a> can be used, among other things, to store key workbook-specific values that you might use in column values calculations.
</p>
<ol>
<li>Begin by opening a fresh workbook window. This would be workbook that you intend to use for your column values calculations.</li>
<li>With this workbook window active, open the Script Window (<b>Window: Script Window</b>), type the following and press Enter.
<pre class="lt" style="font-family:monospace;">page.<span style="color: #000080;">v1</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1.117</span></pre></li>
<li>Right-click on the worksheet column you want to use in calculations and choose <b>Set Column Values</b>.</li>
<li>Let's assume we want to multiply our column <b>A</b> values by our new "v1" variable value of 1.117. Begin by entering "A" in the top, column formula box.</li>
<li>From the Set Values <b>Variables</b> menu, choose Add <b>Info Variable...</b></li>
<li>Expand the System Formula node, highlight your variable v1 (and its value of 1.117) and click <b>Insert</b>, then <b>Close</b>. Note that the Set Values dialog now displays the following expression in the <b>Before Formula Scripts</b> panel.
<pre class="lt" style="font-family:monospace;">double d1 <span style="color: #000080;">=</span> page.<span style="color: #000080;">info</span>.<span style="color: #000080;">SYSTEM</span>.<span style="color: #000080;">FORMULA</span>.<span style="color: #000080;">V1</span>;</pre></li>
<li>The value stored in v1 has now been assigned to a variable named d1 of type double. In order to use this to multiply our column A values by 1.117, we have to add it to the top panel expression:
<pre class="lt" style="font-family:monospace;">A <span style="color: #000080;">*</span> d1</pre></li>
<li>Click <b>Apply</b> or <b>OK</b> to perform your column calculation. Note that should you save the book as a separate window (apart from the project), the variable value will be saved in the book.</li>
</ol>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Menu_Options_and_Dialog_Controls/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>Note that another logical method for defining and saving variables for use in Set Values column formulas is to <a href="../../UserGuide/UserGuide/Entering_Expressions_in_the_Set_Column_Dialog.html#Add_Expressions_in_both_Column_Formula_and_Before_Formula_Scripts" title="UserGuide:Entering Expressions in the Set Column Dialog">use the <b>Before Formula Scripts</b> panel in Set Values</a>.
</p></td></tr></table>
<h2><a name="Options_Menu"></a><span class="mw-headline">Options Menu</span></h2>
<table class="simple">

<tr>
<th>Direct Edit Formula Cell
</th>
<td>This option is enabled by default. Checking this option allows direct editing of the formula in the cell.
</td></tr>
<tr>
<th>Formula Text...
</th>
<td>This option is available when <b>Direct Edit Formula Cell</b> is disabled. Selecting this option opens the <b>Formula Text</b> dialog box, prompting you to enter the text you want to be displayed in the formula cell in the <b>F(x)</b> label row. Note that if the <b>Formula Text</b> box is left empty, the column formula is displayed in the formula cell. <b>Hint</b>: If you want the formula cell to display nothing, you can type a space in the <b>Formula Text</b> box.
</td></tr>
<tr>
<th>Keep Text
</th>
<td>When checked, text in destination columns will be kept instead of becoming missing values when doing calculations.
</td></tr></table>
<h2><a name="Range.2FColumn_controls"></a><span class="mw-headline">Range/Column controls</span></h2>
<dl><dd><a  class="image"><img alt="RowRangeControl.png" src="../images/Menu_Options_and_Dialog_Controls/RowRangeControl.png?v=17599" width="215"  /></a></dd></dl>
<p>Define the range of the values whose values will be set with the expression.
</p><p>If you have selected part of a column(multiple columns) before opening the <span class="db">Set Values</span> dialog box, the starting and ending row indices will be automatically displayed in the <b>Row (i): From</b> and <b>To</b> boxes (selecting an entire column  will set both boxes to <b>&lt;auto&gt;</b>). Please note that non-contiguous range selection is not supported. To change the range, you can overwrite the values in the <b> From</b> and <b>To</b> boxes.
</p>
<dl><dd><a  class="image"><img alt="ColumnControl.png" src="../images/Menu_Options_and_Dialog_Controls/ColumnControl.png?v=36279" width="212"  /></a></dd></dl>
<p>Specify the columns whose values will be set with the expression. This control is only available when set multiple columns values. 
</p><p>If you have selected multiple columns before opening the <span class="db">Set Values</span> dialog box, the starting and ending columns indices will be automatically displayed in the <b>Col (j): From</b> and <b>To</b> boxes. Please note that non-contiguous columns are not supported. To change the columns, you can overwrite the values in the <b> From</b> and <b>To</b> boxes.
</p>
<h2><a name="Target_Column"></a><span class="mw-headline">Target Column</span></h2>
<p>This non-editable field identifies the column or columns to which the Column Formula and/or Before Formula Scripts expression(s) should apply.
</p>
<h2><a name="Column_First.2FNext.2FPrev.2FLast"></a><span class="mw-headline">Column First/Next/Prev/Last</span></h2>
<dl><dd><a  class="image"><img alt="NavagationButtons.png" src="../images/Menu_Options_and_Dialog_Controls/NavagationButtons.png?v=17664" width="116"  /></a></dd></dl>
<p>You can use this group of buttons to switch from one column to another. This allows you to use the <b>Set Values</b> dialog on multiple columns without closing the dialog.
</p>
<h2><a name="Column_Formula"></a><span class="mw-headline">Column Formula</span></h2>
<p>You can add a single line expression in this edit box for generating data. Functions, conditional operator and variables can be used here. 
</p>
<h2><a name="Recalculate"></a><span class="mw-headline">Recalculate</span></h2>
<table class="dialogcontroltable">

<tr>
<th><b>Recalculate</b>
</th>
<td>
<p>Controls recalculation of Set Values expressions:
</p>
<ul><li><b>None</b> </li>
<li><b>Auto</b> </li>
<li><b>Manual</b>  </li></ul>
<p>For more information, see: <a class="external text" href="../../UserGuide/UserGuide/Recalculating_Analysis_Results.html">Recalculating Analysis Results</a>
</p>
</td></tr></table>
<h2><a name="Buttons"></a><span class="mw-headline">Buttons</span></h2>
<table class="dialogcontroltable">

<tr>
<th> Search and Insert Functions dialog
</th>
<td>
<p>Open the <a href="../../UserGuide/UserGuide/Menu_Options_and_Dialog_Controls.html#Search_and_Insert_Functions" title="UserGuide:Menu Options and Dialog Controls"><b>Search and Insert Functions</b></a> dialog by clicking <a  class="image"><img alt="Search Insert Functions.png" src="../images/Menu_Options_and_Dialog_Controls/Search_Insert_Functions.png?v=46069" width="23"  /></a> button.
</p>
</td></tr>
<tr>
<th> Switch to Column Properties dialog
</th>
<td>
<p>Switch to the column properties dialog by clicking <a  class="image"><img alt="Open properties dialog.png" src="../images/Menu_Options_and_Dialog_Controls/Open_properties_dialog.png?v=29417" width="23"  /></a> button.
</p>
</td></tr>
<tr>
<th> Apply
</th>
<td>
<p>Set values with the expression without closing the dialog box.
</p>
</td></tr>
<tr>
<th> Cancel
</th>
<td>
<p>Close the dialog box and do nothing. 
</p>
</td></tr>
<tr>
<th>OK
</th>
<td>
<p>Set values with the expression and then close the dialog box.
</p>
</td></tr>
<tr>
<th>Show/Hide Scripts <br />(Up Arrow button)
</th>
<td>
<p>Show or hide the <b>Before Formula Scripts</b> panel.
</p>
</td></tr></table>
<h2><a name="Before_Formula_Scripts"></a><span class="mw-headline">Before Formula Scripts</span></h2>
<p>You can enter multi-line LabTalk scripts in this edit box and the scripts will be executed before the expression in <b>Column Formula</b> edit box is executed. You can click the <b>Show/Hide Scripts</b> button <a  class="image"><img alt="ShowOrHideButton.png" src="../images/Menu_Options_and_Dialog_Controls/ShowOrHideButton.png?v=17663" width="23"  /></a> to show/hide this edit box.
</p>
<h2><a name="Search_and_Insert_Functions"></a><span class="mw-headline">Search and Insert Functions</span></h2>
<p><a  class="image"><img alt="Search and Insert Functions.png" src="../images/Menu_Options_and_Dialog_Controls/Search_and_Insert_Functions.png?v=47579" width="563"  /></a>
</p><p>To search for a function, first enter keywords in function search input box and all related functions will be listed with function names and descriptions. You can then navigate to desired function and add the function to <b>Set Values</b> dialog box by double clicking the function name. To view more details of that function, you can go the corresponding function page by click the description part of the function.
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Menu_Options_and_Dialog_Controls/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>Besides in the <b>Set Values</b> dialog, you also can open the <b>Search and Insert Functions</b> dialog in these tool/ menu.
</p>
<ul><li> Click the <a  class="image"><img alt="FB FunSel.png" src="../images/Menu_Options_and_Dialog_Controls/FB_FunSel.png?v=86738" width="23"  /></a> button in the <a href="../../UserGuide/UserGuide/Using_Formulae_to_Set_Cell_Values.html#Edit_Cell_Formulas_in_Formula_Bar" title="UserGuide:Using Formulae to Set Cell Values">Formula Bar</a>.</li></ul>
<ul><li> Select <b> Tools: Search Functions</b> in the menu. In the dialog opened by this menu, you can select and copy formula information as text to paste to Notepad.</li></ul>
</td></tr></table>


