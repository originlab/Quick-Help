<h1 class="firstHeading">14 Matrix Conversion and Gridding</h1><p class='urlname' style='display: none'>Matrix-Conversion-Gridding</p>
<p><br />
Origin 9.0 introduced <b>3D surface</b> or <b>contour</b> plotting <a href="../../UserGuide/Category/3D_and_Contour_Graphing.html" title="Category:3D and Contour Graphing">directly from XYZ worksheet columns</a> or from a <a href="../../UserGuide/UserGuide/Creating_3D_and_Contour_Graphs_from_Virtual_Matrix.html" title="UserGuide:Creating 3D and Contour Graphs from Virtual Matrix">Virtual Matrix.</a>  Prior to that release, creating these plot types in Origin required gridding of worksheet data. The resulting <b>matrix</b> of Z values was used to create the contour or 3D surface. This section explains Origin's gridding options.
</p><p>There are two basic types of <b>worksheet to matrix conversions</b> in Origin: 
</p>
<dl><dd><ul><li><b>Direct Conversion</b>.  One common workbook data arrangement -- particularly for Excel users -- is for <b>X</b> and <b>Y</b> measurements to be stored in the first row and first column of the worksheet, with <b>Z</b> values stored in cells at the intersection of each XY data pair.</li>
<li><b>XYZ Gridding</b>. Gridding methods convert XYZ data into a matrix using a selected algorithm.</li>
<li><b>XYZ Log Gridding</b>. Calculate logarithmic values for X and Y first, and then perform <b>XYZ Gridding</b>.</li>
<li><b>Expand</b>. This method is used when an ASCII (or other) import produces multiple Worksheet rows for each single matrix row.</li></ul></dd></dl>
<p>Direct Conversion, then, merely copies the Z data contained in the worksheet to an Origin matrix -- either directly or while transposing the data -- much as if you had done a cut and paste operation.  
</p><p>The XYZ Gridding and XYZ Log Gridding operations, on the other hand, are more complex.  An Origin matrix is a rectangular array of Z values whose columns are linearly mapped to X values and whose rows are linearly mapped to Y values.  If the original worksheet XYZ data is regularly spaced in both the X and Y dimensions, we convert the data into a matrix using the <b>Regular</b> gridding method.  If the data are not regularly-spaced in the X and Y dimensions, one of several <b>Random</b> gridding methods must be used.
</p><p>For random data gridding methods, we can describe the problem mathematically:  Given a set of irregularly distributed points <i>(xi, yi, zi)</i>, we construct a function <i>F(x, y)</i> which interpolates the data as <i>F(xi, yi)=zi</i>.  In the XY plane, the data points must be distinct (multiple Z values for a given XY pair, are not allowed -- see Note 1). The constructed surface is continuous and has continuous first derivatives. 
</p><p>When interpolating, data points nearer the estimated grid point are given greater weight.  Both global and local strategies are used when defining the grid.  Global algorithms use all data points to estimate each grid point, while local strategies use only those XY data in close proximity to the estimated grid point.  Gridding results will, therefore, differ somewhat, depending upon the algorithm used.  Also, because a global algorithm must incorporate information from more XY pairs, it is, naturally, more computationally intensive (for a relative speed comparison, see <a href="../../UserGuide/Category/XYZ_Gridding_Methods.html" title="Category:XYZ Gridding Methods">XYZ Gridding Methods</a>).
</p>
<table class="note">
<tr>
<td>
<p><b>Note 1:</b>  Collinear data in a set is not allowed because it does not define a surface, so collinear points need to be removed. Also, multiple z values at a specific x,y point may have multiple options for determining a composite z value.
</p>
</td></tr></table>
<table class="note">
<tr>
<td>
<p><b>Note 2:</b>  The Origin matrixbook has two <b>heading</b> view modes:  <b>Row/Column (View: Show Column/Row)</b> and Show <b>X/Y (View: Show X/Y). </b> 
</p>
<ul><li>When you are in <b>Row/Column</b> mode, the matrix row and column <b>index</b> numbers display in the row and column headings.  </li>
<li>When you are in <b>X/Y</b> mode, the matrix X and Y <b>values</b> display in the row and column headings.</li></ul>
<dl><dd><a  class="image"><img alt="Matrix Conversion and Gridding1.gif" src="../images/Matrix_Conversion_and_Gridding/Matrix_Conversion_and_Gridding1.gif?v=12577" width="333"  /></a></dd>
<dd><a  class="image"><img alt="Matrix Conversion and Gridding2.gif" src="../images/Matrix_Conversion_and_Gridding/Matrix_Conversion_and_Gridding2.gif?v=12579" width="333"  /></a></dd></dl>
</td></tr></table>
<table class="topiclist">

<tr>
<td>
<p><i><b>Topics covered in this section:</b></i>
</p>
<div class="CategoryTreeTag" data-ct-mode="20" data-ct-options="{&quot;mode&quot;:20,&quot;hideprefix&quot;:10,&quot;showcount&quot;:false,&quot;namespaces&quot;:false}"><li> <a class="CategoryTreeLabel  CategoryTreeLabelNs114 CategoryTreeLabelPage" href="../../UserGuide/UserGuide/Direct_Worksheet_to_Matrix_Conversion.html">Direct Worksheet to Matrix Conversion</a></li>
		
		<li> <a class="CategoryTreeLabel  CategoryTreeLabelNs14 CategoryTreeLabelCategory" href="../../UserGuide/Category/XYZ_Gridding_Methods.html">XYZ Gridding Methods</a></li>
		
		<li> <a class="CategoryTreeLabel  CategoryTreeLabelNs114 CategoryTreeLabelPage" href="../../UserGuide/UserGuide/Expanding_Columns_During_Conversion.html">Expanding Columns During Conversion</a></li>
		
		<li> <a class="CategoryTreeLabel  CategoryTreeLabelNs114 CategoryTreeLabelPage" href="../../UserGuide/UserGuide/References,_Matrix_Conversion_and_Gridding.html">References, Matrix Conversion and Gridding</a></li>
		
		</div>
</td></tr></table>




