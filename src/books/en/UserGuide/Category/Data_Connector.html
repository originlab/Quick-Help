<h1 class="firstHeading">6.5 Data Connector</h1><p class='urlname' style='display: none'>Data-Connector</p>
<p><b>Connect</b>, or <b>Data Connector</b>, is a new import framework introduced in <b>OriginPro 2019b</b>. This new framework offers speed, simplicity and data integrity advantages over Origin's older file import methods. For differences between Connectors and older import methods, see:
</p>
<dl><dd><dl><dd><ul><li> <a class="external text" href="../../QuickHelp/QuickHelp/Data_Connector_Difference_Import_From_File.html"><b>FAQ-1020 Is there a difference between Connect and Import?</b></a></li></ul></dd></dl></dd></dl>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Data_Integrity"><span class="tocnumber">1</span> <span class="toctext">Data Integrity</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Adding_a_Connector_to_the_Sheet"><span class="tocnumber">2</span> <span class="toctext">Adding a Connector to the Sheet</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Dialogs_and_Menus"><span class="tocnumber">3</span> <span class="toctext">Dialogs and Menus</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Connector_menu:"><span class="tocnumber">3.1</span> <span class="toctext">Connector menu:</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Other_sub-menus_under_Data_menu:"><span class="tocnumber">3.2</span> <span class="toctext">Other sub-menus under Data menu:</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Excluding_or_Saving_Imported_Data"><span class="tocnumber">4</span> <span class="toctext">Excluding or Saving Imported Data</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Run_Script_After_Import"><span class="tocnumber">5</span> <span class="toctext">Run Script After Import</span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="#Post_Import_Script_Dialog"><span class="tocnumber">5.1</span> <span class="toctext">Post Import Script Dialog</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Embed_LabTalk_script_using_Worksheet_Properties_dialog"><span class="tocnumber">5.2</span> <span class="toctext">Embed LabTalk script using Worksheet Properties dialog</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-10"><a href="#Other_Manipulation"><span class="tocnumber">6</span> <span class="toctext">Other Manipulation</span></a></li>
</ul>
</div>

<h2><a name="Data_Integrity"></a><span class="mw-headline">Data Integrity</span></h2>
<p>Data Connectors offer a higher degree of data protection than older import methods:
</p>
<ul><li> Data are not editable in books that contain Data Connectors, by default. This protects against accidental modification and deletion.</li>
<li> Data imported using Text/CSV or Excel Connector can be sorted, by default (select column, the <b>Worksheet: Sort Worksheet</b>), but is otherwise not editable.</li>
<li> Data imported via Connector types other than Text/CSV and Excel, are not sortable by default (not editable, not sortable). </li>
<li> You can change both editing and sorting behaviors of Connector-imported data by manipulating the value of <a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#H.2CI.2CJ.2CK">LabTalk system variable <b>@IPDC</b></a>, BEFORE you import data via Connector.</li>
<li> Routine post-processing of connected data can be set up by <a href="#Run_Script_After_Import">embedding script</a> in the worksheet.  Post-processing may overcome any need to remove edit protections from connected data, thus helping to secure data.</li></ul>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Data_Connector/Alert_icon.png?v=9649" width="57"  border="0" /></td><td><p>Note that "protection" does not prevent you from adding columns to the end of the worksheet for the purpose of transforming the imported data (e.g. via <a href="../../UserGuide/UserGuide/Quick_Start_SetColumnValues.html" title="UserGuide:Quick Start SetColumnValues">Set Values</a>). Protection merely prevents you from altering the original data.
</p><p>Further, if you decide AFTER importing that you need to freely-edit imported data, you can remove Data Connectors by clicking the Connector icon <a  class="image"><img alt="Dadta connector icon connect.png" src="../images/Data_Connector/Dadta_connector_icon_connect.png?v=87163" width="16"  /></a> and (a) disconnecting the sheet (<b>Disconnect Sheet</b>), (b) removing the Data Connector altogether (<b>Remove Data Connector</b>) -- see <a href="#Connector_menu:"><b>Connector menu:</b></a>, below, for an explanation of the difference -- or (c) unlocking the data  (<b>Unlock Imported Data</b> -- available in <b>Origin 2021b</b> and later).
</p>
	</td>
	</tr>
	</table>
<h2><a name="Adding_a_Connector_to_the_Sheet"></a><span class="mw-headline">Adding a Connector to the Sheet</span></h2>
<p>Adding a Connector to a worksheet or matrix adds a Connector object to the top-left corner of the sheet. This object stores information used to maintain the connection to the data source. 
</p><p><br />
<i><b>To add a Connector to the active worksheet or matrix, do one of the following:</b></i>
</p>
<ul><li> Click <b>Data</b>: <b>Connect to File</b>, <b>Connect to Web</b> or <b>Connect to Database</b>.</li>
<li> Click the <b>Connectors</b> tab in the Apps Gallery and choose a Connector.</li>
<li> <a href="../../UserGuide/Category/Importing_Data_by_Drag_and_Drop.html" title="Category:Importing Data by Drag and Drop">Drag-and-drop a Connector-supported file</a> onto an Origin worksheet or matrix.</li></ul>
<p><br />
<i><b>Different connection states show different icons:</b></i>
</p>
<table class="simple" style="width: 50%">
<tr>
<th style="width: 5%"> Icon
</th>
<th style="width: 45%"> Connection State
</th></tr>
<tr>
<td> <a  class="image"><img alt="Dadta connector icon connect.png" src="../images/Data_Connector/Dadta_connector_icon_connect.png?v=87163" width="16"  /></a>
</td>
<td> the sheet is used as the destination of a data connector.
</td></tr>
<tr>
<td> <a  class="image"><img alt="Dadta connector icon empty.png" src="../images/Data_Connector/Dadta_connector_icon_empty.png?v=82090" width="16"  /></a> -
</td>
<td> the sheet is not yet used by a data connector.
</td></tr>
<tr>
<td> <a  class="image"><img alt="Dadta connector icon update.png" src="../images/Data_Connector/Dadta_connector_icon_update.png?v=82754" width="16"  /></a>
</td>
<td> there is updates in the data source.
</td></tr>
<tr>
<td> <a  class="image"><img alt="Dadta connector icon broken.png" src="../images/Data_Connector/Dadta_connector_icon_broken.png?v=82195" width="16"  /></a>
</td>
<td> the data source is from a file and the file does not exist.
</td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Data_Connector/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>When you mouse over a Connector icon, a tooltip displays the basic Connector information.  Right-click inside the tooltip and <b>Copy</b> the information to the Clipboard.
</p>
<dl><dd><dl><dd><a  class="image"><img alt="Data connector tooltip.png" src="../images/Data_Connector/400px-Data_connector_tooltip.png?v=82092" width="400"   /></a></dd></dl></dd></dl>
</td></tr></table>
<h2><a name="Dialogs_and_Menus"></a><span class="mw-headline">Dialogs and Menus</span></h2>
<p><i><b>For Connector-specific dialog settings, please see the following topics:</b></i>
</p>
<dl><dd><ul><li><a href="../../UserGuide/UserGuide/Connecting_to_Web.html" title="UserGuide:Connecting to Web">Connect to data on web</a></li>
<li><a href="../../UserGuide/UserGuide/Connecting_to_File.html" title="UserGuide:Connecting to File">Connect to disk file</a></li></ul></dd></dl>
<p><br />
Once a Connector is added, click the sheet's Connector icon to manage the connection.
</p>
<h3><a name="Connector_menu:"></a><span class="mw-headline">Connector menu:</span></h3>
<dl><dd><dl><dd><a  class="image"><img alt="Data connector contextmenu.png" src="../images/Data_Connector/Data_connector_contextmenu.png?v=94172" width="448"  /></a></dd></dl></dd></dl>
<dl><dd><table class="simple">
<tr>
<th style="width: 25%"> Data Source
</th>
<td> Open dialog to select or change data source
<p>For data source from a disk file, the <b>Data Source File Path</b> dialog is opened.
</p>
<dl><dd><a  class="image"><img alt="Dadta connector file path.png" src="../images/Data_Connector/400px-Dadta_connector_file_path.png?v=82225" width="400"   /></a></dd></dl>
<p>You can choose to browse and then save the data source path as
</p>
<dl><dd><ul><li>an absolute path</li>
<li>a relative path to the project saved folder. The current project must be saved before.</li>
<li>a relative path to the common data path you have set by <b>Common Data Path</b> context menu.</li></ul></dd></dl>
</td></tr>
<tr>
<th> Select
</th>
<td> Reopen dialog to adjust the import settings or select the branch to import.
</td></tr>
<tr>
<th> Options
</th>
<td> Available only for <b>HTML Table Connector</b> (<b>Connect to File/Web</b>). See <a href="../../UserGuide/UserGuide/Connecting_to_Web.html#HTML_Connector_Options" title="UserGuide:Connecting to Web">this page</a> for details.
</td></tr>
<tr>
<th> Post Import Scripts
</th>
<td> Enter LabTalk scripts to run after import. See <a href="#Run_Script_After_Import">"Run Script After Import" section</a> below for more of running post import scripts.
</td></tr>
<tr>
<th> Import<br />Import All Books
</th>
<td> Import the source data into
<ul><li> the active data-connected sheet (<b>Import</b>)</li>
<li> all data-connected sheets in the project file (<b>Import All Books</b>)</li></ul>
</td></tr>
<tr>
<th> Auto Import
</th>
<td> Auto import can be triggered in one of the following cases:
<ul><li> when open the project</li>
<li> when data source has changes</li></ul>
</td></tr>
<tr>
<th> Unlock Imported Data
</th>
<td> Check this to enable editting imported data. If you click the Connector icon and choose <b>Import</b> to reimport data, the edit protections will be restored.
</td></tr>
<tr>
<th> Reset Post Import Actions
</th>
<td> After importing, if you have some actions on imported data, e.g. delete some imported columns, you will need to select this menu to reset the actions before you can re-import data.
</td></tr>
<tr>
<th> Disconnect Sheet
</th>
<td> Remove the connection between the worksheet/matrix and the data source. Also remove edit protections.  The connector icon remains allowing you to reconnect to your data source (at which time, edit protections will be restored).
</td></tr>
<tr>
<th> Remove Data Connector<br />Remove Connectors from All Books
</th>
<td> Permanently remove Data Connectors from
<ul><li> all sheets in the active book (<b>Remove Data Connector</b>)</li>
<li> all books in the project file (<b>Remove Connectors from All Books</b>). </li></ul>
<p>Edit protections are removed from all sheets. In addition, remove <b>Exclude Imported When Saving</b> check mark.
</p>
</td></tr>

<tr>
<th> Exclude Imported When Saving<sup>&#8224;</sup>
</th>
<td> Check it to clear the imported data but keep the connection when saving the workbook or project, which helps to decrease the project size, and allows to simply re-import the data when needed. If a graph is plotted from the imported data, there is also a download button appearing on the graph after the imported data has been cleared.
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Data_Connector/Tutorial_icon.png?v=9654" width="57"  border="0" />
	</td>
	<td><p>For an example, open sample project <i>Statistics-Multivariate Analysis - Discriminant Analysis (Pro)</i> by <b>Help: Learning Center</b> and set <b>Samples in</b> = Statistics-Multivariate Analysis in Analysis Samples tab. Try menu "Data: Re-Import Directly" to reimport the data. And then try to check and uncheck <b>Exclude Imported When Saving</b> and see the difference of the project size. 
</p></td></tr></table>
</td></tr>
<tr>
<th> Common Data Path
</th>
<td> Set a common data path which can be used to quickly access source files by <b>Data Source</b> menu. This path shares between all books in the project and will be saved with the project.
<p>It is typical to set the parent folder as <b>Common Data Path</b>. The advantage is even greater if you set the <b>Common Data Path</b> to a shared folder accessed by your group members and then share the project with them.
</p>
</td></tr>
<tr>
<th> Pause Check File
</th>
<td> If the source file is found not existed after checking a few times, data connector will not check anymore, and this menu <b>Pause Check File</b> will show as checked. You will need to actively uncheck this menu to start the idle checking again.
</td></tr>
<tr>
<th> Duplicate Sheet with More Files
</th>
<td> Clone the current worksheet, e.g. import settings (including <b>Post Import Scripts</b>) and any analysis actions, and import new files selected in the pop-up dialog.
<p><a  class="image"><img alt="Duplicate Sheet with More Files.png" src="../images/Data_Connector/Duplicate_Sheet_with_More_Files.png?v=94175" width="566"  /></a>
</p><p>See also <b>Clone Import</b> in the <a href="#Other_sub-menus_under_Data_menu:">next section</a>.
</p>
</td></tr></table></dd></dl>
<h3><a name="Other_sub-menus_under_Data_menu:"></a><span class="mw-headline">Other sub-menus under Data menu:</span></h3>
<dl><dd><table class="simple">
<tr>
<th style="width: 20%"> Connect Multiple Files
</th>
<td>Currently some Connector types support import multiple files at a time, for example, CSV and Excel Connectors for workbook, Matlab, MetroPro, and WDF Connectors for matrix. <br />Refer to <a class="external text" href="../../XFunction/X-Function/Files2dc.html">this document</a> for dialog details.
</td></tr>
<tr>
<th> Clone Import
</th>
<td> Available for data imported by <b>Data: Import from File</b> menu. After you import a data file by <b>Import from File</b> menu, <b>Clone Import</b> will use the active workbook (including import settings) as template to import new file into a duplicate of current workbook. If the current workbook contains analysis, recalculation in the duplicate is triggered automatically regardless of the analysis tool's <b>Recalculate</b> mode. If the current workbook contains <i>N</i> import sheets, <b>Clone Import</b> will group every <i>N</i> data files in order of selection and import the same group in one book accordingly.
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Data_Connector/Tutorial_icon.png?v=9654" width="57"  border="0" />
	</td>
	<td><p>For an example, open sample project <i>Batch Processing - Clone Import</i> by <b>Help: Learning Center</b> and set <b>Samples in</b> = Batch Processing in Analysis Samples tab. Activate workbook and try menu "Data: Clone Import" and choose another data. See how the active workbook is cloned with the new data.  
</p></td></tr></table>
</td></tr></table></dd></dl>
<h2><a name="Excluding_or_Saving_Imported_Data"></a><span class="mw-headline">Excluding or Saving Imported Data</span></h2>
<p>By default, when connecting to files of less than <i>500kB</i> in size, data are saved with the project; data of larger files are not saved with the project.
</p><p><br />
<i><b>Modify default data exclusion behaviors using these LabTalk system variables:</b></i>
</p>
<dl><dd><ul><li> <a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#D"><b>@DNS</b></a>: Controls whether data are excluded.</li>
<li> <a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#F.2CG"><b>@FSE</b></a>: Controls threshold file size in kilobytes, for excluding data when saving the project.</li>
<li> <a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#F.2CG"><b>@FSEW</b></a>: Controls threshold size in number of Origin worksheet cells x 100 for excluding Web, JSON, Origin, MATLAB data upon save. </li></ul></dd></dl>
<p><br />
<i><b>To manually override default data excluding behaviors for a given window:</b></i>
</p><p>Regardless of import file size or the state of @DNS, @FSE or @FSEW, you can save data with the project in these ways:
</p>
<ul><li> Click on the Connector icon and clear the check mark beside <b>Exclude Imported When Saving</b>.</li>
<li> Right-click on the window title bar, open <b>Properties</b> and clear the check box beside <b>Exclude imported data when saving project</b>.</li></ul>
<h2><a name="Run_Script_After_Import"></a><span class="mw-headline">Run Script After Import</span></h2>
<p>You can post-process data upon import, regardless of the current value of <b>@IPDC</b>, and without breaking the connection to source data. This can be done by following 2 ways.
</p>
<h3><a name="Post_Import_Script_Dialog"></a><span class="mw-headline">Post Import Script Dialog</span></h3>
<p><span class='headerInParagraph'>To open the Post Import Script dialog,</span>
</p>
<ul><li> After import, click the connector icon <a  class="image"><img alt="Dadta connector icon connect.png" src="../images/Data_Connector/Dadta_connector_icon_connect.png?v=87163" width="16"  /></a> and select <b>Post Import Script</b>. </li></ul>
<dl><dd><a  class="image"><img alt="Post Import Scripts Dialog.png" src="../images/Data_Connector/Post_Import_Scripts_Dialog.png?v=94429" width="756"  /></a></dd>
<dd><b>Do Import on OK</b> is checked by default to reimport the data and execute the scripts right after you click <b>OK</b> button.</dd></dl>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Data_Connector/Tutorial_icon.png?v=9654" width="57"  border="0" />
	</td>
	<td><p>For example, after import table <i>January 1903 Boston Weather</i> from <a class="external text" href="https://www.extremeweatherwatch.com/cities/boston/year-1903" target="_blank">web page-Boston Weather in 1903</a>, we would like to add a user-defined parameter row "Mean" to show the mean value of each column.
</p>
<pre class="lt" style="font-family:monospace;">wks.<span style="color: #000080;">userparam</span><span style="color: #000000;">&#40;</span><span style="color: #000080;">++</span>Mean<span style="color: #000000;">&#41;</span>;
loop<span style="color: #000000;">&#40;</span>i,<span style="color: #0000dd;">2</span>,wks.<span style="color: #000080;">dc</span>.<span style="color: #000080;">c2</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> wcol<span style="color: #000000;">&#40;</span>i<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span>Mean<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;=Mean(this)&quot;</span>;<span style="color: #000000;">&#125;</span></pre>
<dl><dd><a  class="image"><img alt="Post Import Script Example 1.png" src="../images/Data_Connector/Post_Import_Script_Example_1.png?v=94427" width="641"  /></a></dd></dl>
<p>Then we can select multiple tables in the navigate panel (by dragging) and use <b>Connect by Duplicating Active Sheet</b> context menu to import all 12 months tables using the settings of the active sheet.
<a  class="image"><img alt="Post Import Script Example 2.png" src="../images/Data_Connector/Post_Import_Script_Example_2.png?v=94428" width="600"  /></a>
</p></td></tr></table>
<ul><li> Specially, for <a href="../../UserGuide/UserGuide/Connecting_to_File.html#Text.2FCSV_Connector" title="UserGuide:Connecting to File">CSV Connector</a>, click the <b>Other Options</b> button (to the left of <b>OK</b>). In the <b>Other Options</b> dialog that opens, enter LabTalk scripts in the <b>Post Import Script</b> edit box. </li></ul>
<dl><dd><a  class="image"><img alt="CSV post import lt scripts.png" src="../images/Data_Connector/450px-CSV_post_import_lt_scripts.png?v=93512" width="450"   /></a></dd></dl>
<p><br />
</p>
<h3><a name="Embed_LabTalk_script_using_Worksheet_Properties_dialog"></a><span class="mw-headline">Embed LabTalk script using Worksheet Properties dialog</span></h3>
<p>You can also embed LabTalk script using the worksheet's <a href="../../UserGuide/UserGuide/Script_tab_of_Worksheet_Properties.html" title="UserGuide:Script tab of Worksheet Properties">Properties dialog box</a> (<b>Worksheet: Worksheet Script</b>). 
</p>
<ol><li> Prior to importing data, activate the workbook and choose <b>Worksheet: Worksheet Script</b>.</li>
<li> Enter your script into the <b>Script</b> box and check the <b>After Import</b> box under <b>Run Script</b>. Connected data will not be locked to editing until your script is run.</li></ol>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Data_Connector/Tutorial_icon.png?v=9654" width="57"  border="0" />
	</td>
	<td><p>The following example shows calling the <b>wdeldup</b> X-Function to remove duplicate values in a reference column (column 1) by averaging associated values in other columns. 
</p>
<dl><dd><dl><dd><a  class="image"><img alt="DC run script after import.png" src="../images/Data_Connector/DC_run_script_after_import.png?v=94178" width="345"  /></a></dd></dl></dd></dl>
<p>See more examples in <a class="external text" href="http://blog.originlab.com/worksheet-script-after-data-connector-to-modify-data" target="_blank">this OriginLab blog post</a>.
</p></td></tr></table>
<p><br />
<i><b>Other things to note:</b></i>
</p>
<ul><li> There are methods of running Python script from LabTalk, as outlined <a class="external text" href="../../Python/Python/Running_Python_Code.html">here</a>.</li>
<li> The workbook and embedded script can be saved as a <a href="../../UserGuide/UserGuide/Template_Files.html#Saving_a_customized_window_as_a_template" title="UserGuide:Template Files">template file</a> for processing of similar data.</li>
<li> For an overview of post-processing of connected data, see <a class="external text" href="http://blog.originlab.com/worksheet-script-after-data-connector-to-modify-data" target="_blank">this OriginLab blog post</a>.</li></ul>
<h2><a name="Other_Manipulation"></a><span class="mw-headline">Other Manipulation</span></h2>
<p>Besides those supporting <b>Connect Multiple Files</b>, most Connector kinds can import one file/table at a time. If you want to import multiple table on the same webpage, or multiple files in the same path, you can use <b>Add Worksheet</b> menu to quickly import them to the same workbook.
</p><p><i><b>To import multiple files/tables into one book:</b></i>
</p>
<ol><li>Import a file/table by Data Connector.</li>
<li>Right clicking on the worksheet tab and choosing <b>Add</b>.</li></ol>
<dl><dd>A new worksheet with data connector is added. The data source is prefilled with the data source in the book but doesn't connect. You can change to import a new table.</dd></dl>
<p>Note that each workbook can have different data sources, but only one particular connector type (such as Text/CSV, JSON or OPJU). That is, each worksheet in it can have its own data source that is supported by that connector type.
</p><p><br />
<i><b>To import data types not in the default menu:</b></i>
</p>
<ol>
<li> Select <b>Data: Connect From File/Web: Add New</b>. 
<li>This will open <b>App Center</b> with category set to <b>Data Connector</b>. Browse and find the file type you want to connect, and download it. Once downloaded, it will be added to the <b>Data</b> menu automatically for you to use. You can also find the App in <b>Data Connector</b> tab of App Gallery. 
</ol>


