<h1 class="firstHeading">6.6 Importing Data by Drag-and-Drop</h1><p class='urlname' style='display: none'>Imp-DragDrop</p>
<p>Origin supports drag-and-drop import for many common file types. For historical reasons, there are multiple technologies used. When you drop a file onto an Origin worksheet or matrixsheet, a code-checking sequence occurs that determines which method is used. See <b>Import Code Reading Sequence</b>, below.
</p>
<table class="note">

<tr>
<td><b>Note:</b> You will not be able to drag and drop files if you are <a class="external text" href="../../QuickHelp/QuickHelp/Why_does_not_drag_and_drop_work.html">running Origin as an administrator.</a>
</td></tr></table>
<p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Import_Code_Reading_Sequence"><span class="tocnumber">1</span> <span class="toctext">Import Code Reading Sequence</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Data_Connectors_and_Drag-and-Drop"><span class="tocnumber">2</span> <span class="toctext">Data Connectors and Drag-and-Drop</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Save_Drag-and-Drop_Settings_into_the_Sheet"><span class="tocnumber">3</span> <span class="toctext">Save Drag-and-Drop Settings into the Sheet</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Using_the_Import_Wizard_to_Set_Up_D.26D_Import"><span class="tocnumber">4</span> <span class="toctext">Using the Import Wizard to Set Up D&amp;D Import</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="#Origin_Import_Filters"><span class="tocnumber">4.1</span> <span class="toctext">Origin Import Filters</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Target_Windows_and_Target_Window_Templates"><span class="tocnumber">4.2</span> <span class="toctext">Target Windows and Target Window Templates</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="Import_Code_Reading_Sequence"></a><span class="mw-headline">Import Code Reading Sequence</span></h2>
<p>When files are dropped into Origin, this sequence occurs:
</p>
<ol><li> The oldest method -- and that which is first checked -- calls a LabTalk section in a file called <b>DOFILE.OGS</b>. If found, the import routine is run. While the legacy code in DOFILE may still run satisfactorily, the user should not attempt to write new import routines using this method. </li>
<li> Next in the sequence, the active worksheet or matrixsheet is scanned for import filter information saved to the sheet (see <a href="#Save_Drag-and-Drop_Settings_into_the_Sheet">Save Drag-and-Drop Settings into the Sheet</a>, below).</li>
<li> If no filter information is saved to the sheet, the data folder is checked for a matching <a href="#Origin_Import_Filters"> Origin Import Filter (*.oif)</a>. </li>
<li> If no filter is found in the data folder, the <a class="external text" href="../../UserGuide/UserGuide/The_User_Files_Folder.html">User Files\Filters</a> folder is checked for a matching import filter. If a USER filter exists and the <b>Support Drag&amp;Drop</b> filter box is checked in <a class="external text" href="../../UserGuide/UserGuide/Introduction_to_Import_Filters_Manager.html">Filter Manager</a>, then this filter handles import. </li>
<li> If no matching filter is found in User Files\Filters, the code checks to see whether there is an installed <a class="external text" href="../../UserGuide/Category/Data_Connector.html">Data Connector</a> that matches the file type. If a matching Data Connector is found, the Data Connector handles import</li>
<li> If no Data Connector is found and the SYSTEM <b>Support Drag&amp;Drop</b> filter box is unchecked or does not show in Filter Manager, Origin opens an attention box asking if you want to open the <a class="external text" href="../../UserGuide/Category/The_Import_Wizard.html">Import Wizard</a> to import the file.</li></ol>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Importing_Data_by_Drag_and_Drop/Tip_icon.png?v=9614" width="57"  border="0" /></td><td><p>Drag-and-drop behavior for .dat, .xls/xlsx, .txt and .csv, can be modified by setting system variable <b>@IFS</b>. See <b>Notes</b> in the next section.
</p></td></tr></table>
<h2><a name="Data_Connectors_and_Drag-and-Drop"></a><span class="mw-headline">Data Connectors and Drag-and-Drop</span></h2>
<p><a href="../../UserGuide/Category/Data_Connector.html#Adding_a_Connector_to_the_Sheet" title="Category:Data Connector"><b>Data Connectors</b></a> are Origin's newest data import technology. Data Connectors offer simple import for common data files such as <b>Text/CSV</b> and <b>Excel</b>. Files are often handled automatically, without the need for configuration of dialog boxes or saving of settings to the sheet or to an external filter file. Both <b>Text/CSV</b> and <b>Excel</b> Connectors do a good job of handling date-time data: data should be automatically recognized and formatted in the sheet on import.
</p><p>If you have been using an Origin Import Filter (*.oif) -based routine, it should still be fully-supported (see <b>Note</b>, below). However, we encourage you to try importing your data using one of the available Connectors (<b>Data: Connect to</b> ...). Also, note that you <i>can</i> use your import filter with a Data Connector (<b>Data Connect to File: Import Filter</b>).
</p>
<ul><li> Import filters saved to the <i>sheet</i> or to the <i>data folder</i> as an Origin Import Filter (*.oif) file, will take precedence over use of a Data Connector.</li>
<li> Filters saved to User Files\Filters will take precedence over the Data Connector <i>if</i> the User folder filter's <b>Support Drag&amp;Drop</b> box is checked in Filter Manager (<b>Preferences: Import Filters Manager</b>). </li></ul>
<dl><dd><dl><dd><a  class="image"><img alt="OH filter manager supportDandD.png" src="../images/Importing_Data_by_Drag_and_Drop/OH_filter_manager_supportDandD.png?v=92614" width="588"  /></a></dd></dl></dd></dl>
<ul><li> If -- when you drop your file(s) -- multiple applicable filters are found, this opens the <b>Select Filter</b> dialog. Use the dialog to choose the filter you want to use; or choose to <b>Use Connector</b>.</li></ul>
<dl><dd><dl><dd><a  class="image"><img alt="OH select filter dialog.png" src="../images/Importing_Data_by_Drag_and_Drop/OH_select_filter_dialog.png?v=92584" width="271"  /></a></dd></dl></dd></dl>
<ul><li> Drag-and-drop behaviors of .dat, .xls/xlsx, .txt and .csv files can be modified by changing the value of system variable <a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#H.2CI.2CJ.2CK"><b>@IFS</b></a> (default = 0). For instance, if you (a) set <b>@IFS</b>=<i>1</i>, (b) you have at least one .dat file applicable filter in User Files\Filters and (c) <b>Support Drag&amp;Drop</b> is enabled for that filter, then dropping a .dat file onto Origin will open the <b>Select Filter</b> dialog. Here, you can choose a filter, including a System filter (these are generally not helpful); or you can choose to <b>Use Connector</b>.</li>
<li> Also worth noting: when you drag-and-drop a file that has an applicable filter in the <i>data folder</i>, this produces essentially the same result as choosing <b>Data: Connect to File: Import Filter</b>. The advantage here is you get to use your import filter to parse the file <i>and in addition</i>, a <a href="../../UserGuide/Category/Data_Connector.html#Adding_a_Connector_to_the_Sheet" title="Category:Data Connector"><b>Data Connector</b></a> is added to the sheet.</li></ul>
<h2><a name="Save_Drag-and-Drop_Settings_into_the_Sheet"></a><span class="mw-headline">Save Drag-and-Drop Settings into the Sheet</span></h2>
<p>When using one of the X-Function based dialogs for file import -- those found under <b>Data: Import from File</b> -- you have the option of saving the current dialog box configuration to a <a href="../../UserGuide/UserGuide/Dialog_Themes.html" title="UserGuide:Dialog Themes"><b>Dialog Theme</b></a> or to <b>Save Settings for Drag and Drop</b>.
</p><p>When you <b>Save Settings for Drag and Drop</b>, you are saving an import filter to the sheet itself. As long as the sheet -- or a duplicated sheet is active -- you can then drop new files of identical file type and structure and have them imported cleanly into the sheet.
</p>
<ol><li> Create a new workbook and choose a file format under <b>Data: Import from File</b> (e.g. <b>Single ASCII</b>).</li>
<li> Choose a matching file, make sure the <b>Show Options Dialog</b> box is checked and click <b>Open</b>.</li>
<li> Select options in the dialog so that file data will be properly parsed, then click the <a  class="image"><img alt="Dialog Theme Button.png" src="../images/Importing_Data_by_Drag_and_Drop/Dialog_Theme_Button.png?v=62758" width="21"  /></a> to the right of <b>Dialog Theme</b> (top of the dialog) and choose <b>Save Settings for Drag and Drop</b>.</li></ol>
<ul><li> At this point, you can drop another file of like type and structure onto the active sheet (note that depending on your dialog box <b>Import Mode</b> settings, you may overwrite the existing data or you may start a new sheet or book) and it will be handled by the settings saved to the sheet.</li>
<li> You can also save the window as a template (<b>File: Save Template As</b>) and recall the window configuration -- including drag-and-drop file handling -- for later use.</li></ul>
<h2><a name="Using_the_Import_Wizard_to_Set_Up_D.26D_Import"></a><span class="mw-headline">Using the Import Wizard to Set Up D&amp;D Import</span></h2>
<p>The <a href="../../UserGuide/Category/The_Import_Wizard.html" title="Category:The Import Wizard">Import Wizard</a> supports import of <b>ASCII</b> and simple <b>Binary</b> files ("simple" being an optional header section followed by a sequential binary structure). If your data do not fall easily into one of those two categories, you can write your own Origin C code (<b>User-Defined</b>) to handle data import.
</p><p>Regardless of <b>Data Type</b>, one of the chief advantages of using the Wizard to import your data files is that you can save your custom settings to an Origin import filter (*.oif) that can be used repeatedly to import identically-structured files. Once you've created your filter, subsequent files are easily imported by drag-and-drop.
</p>
<h3><a name="Origin_Import_Filters"></a><span class="mw-headline">Origin Import Filters</span></h3>
<p>When <a href="../../UserGuide/UserGuide/Import_Wizard_Basics.html" title="UserGuide:Import Wizard Basics">creating an import filter</a>, the normal sequence of events is to open the <a href="../../UserGuide/UserGuide/Import_Wizard_Basics.html" title="UserGuide:Import Wizard Basics"><b>Import Wizard</b></a>, select a data file, then step through a sequence of Wizard pages in which you interactively parse the file, select file and window naming options, select header information to be stored and re-used, etc.  When you have finalized your import settings, you can store them as an import filter (saving the filter is highly recommended if you plan to import the same or similar files in the future).
</p><p>When creating an import filter, you have the option of saving the filter (a) <b>in the data file folder</b>, (b) <b>in the User Files folder</b> or (c) <b>in the Window</b>. All options support drag-and-drop file import. 
</p>
<dl><dd><a  class="image"><img alt="OH save filters page storage options.png" src="../images/Importing_Data_by_Drag_and_Drop/OH_save_filters_page_storage_options.png?v=92618" width="727"  /></a></dd></dl>
<p>One advantage of saving the filter <b>in the Window</b> is that the filter travels with the window itself and, thus, it becomes part of the Origin project file (<b>*.opju</b>) or <a class="external text" href="../../GettingStarted/OriginLab/The_Origin_Interface.html#Origin_Child_Windows">child window file (<b>*.ogwu</b>)</a>.  
</p><p>The two other options (<b>data file folder</b> or <b>User Files folder</b>) require saving the filter as a separate *.oif file. The primary advantage here is a greater degree of flexibility when importing. You can choose to <i>always</i> use the filter (data folder) or to opt <i>not</i> to use the filter and use a Data Connector instead (by clearing the User filter's <b>Support Drag&amp;Drop</b> check box in Filter Manager (<b>Preference: Import Filters Manager</b>); or -- another great option -- to use a Data Connector <b>with</b> your import filter file settings (<b>Data: Connect to File: Import Filter</b>).
</p><p>Once created, an import filter file can be tweaked to import files that vary somewhat in their structure, without having to completely recreate every import specification.  The procedure here would be to open the Wizard, (1) pick the file for which you intend to modify your import filter, (2) load the import filter (you may have to clear the <b>List filters applicable...</b> check box to list User filters), (3) step through the Wizard, modifying settings as needed and (4) on the Save Filters page of the Wizard, save your filter settings to a new name.
</p><p>Your import filter can be narrowly-defined to work only with a particular file name (or variations on that file name) or it can be broadly-defined to apply to all files with a given file extension.  For instance, you might work with an instrument that automatically names data files in sequence using a scheme something like XYZ_001.CSV, XYZ_002.CSV, XYZ_003.CSV.  Using the "*" wildcard character, you could broadly target the filter to all .CSV files in your data file folder by specifying that the filter apply to any file with the name "*.CSV."  Conversely, you could narrowly-target the filter by specifying that the filter apply only to CSV files named "XYZ*.CSV."
</p>
<h3><a name="Target_Windows_and_Target_Window_Templates"></a><span class="mw-headline">Target Windows and Target Window Templates</span></h3>
<p>When defining an import filter for ASCII, binary or user-defined file types, you must specify a <b>Target Window</b> and <b>Target Window Template</b>. Note that only <b>Data Type</b> = <b>User-Defined</b> allow specifying something other than <b>Target Window = Workbook</b>.  Note, too that <b>User-Defined</b> allows you to bypass specifying the <b>Target Window</b> and <b>Target Window Template</b> (<b>Target Window</b> = <b>None</b>) if window creation is to be handled by your <b>Origin C</b> code (in which case, the code would handle window creation).  
</p>
<ul><li> The <b>Target Window</b> specifies the type of child window that will receive the imported data.  </li>
<li> The <b>Target Window Template</b> is a specific window template (may simply be &lt;default&gt; but could be a custom template with with your own configuration and format settings). The <b>Target Window Template</b> is called when drag-and-drop import operations require creating new windows.  </li></ul>
<p>Assuming that you have defined an import filter, if you drag-and-drop one or more data files into an active window and that window is of the <b>Target Window</b> type, then Origin will import the file(s) using the new window/new worksheet/new column settings specified in the filter.  If, for instance, (1) the filter <b>Import Mode</b> is set to <b>Start New Columns</b> and (2) the file(s) are dropped onto a workbook window (the Target Window type specified in the filter), then the file(s) are imported and added as columns into the active worksheet in the active workbook. If the active sheet had empty columns, they would be filled first. In this case, the active workbook was of the correct <b>Target Window</b> type and each file required only the creation of new columns. No new windows needed to be created so, therefore, the <b>Target Window Template</b> was not used.  
</p><p>If the filter <b>Import Mode</b> had been set to <b>Start New Books</b>, then the first file dropped would import into the active workbook if the columns in the active sheet were empty (again -- the <b>Target Window</b> was of the correct type), and each subsequent file would import into new workbook windows created using the Target Window Template.  Note that the <b>Target Window Template</b> may, or may not, be the same template that the active workbook window was based upon.  However, the default <b>Target Window Template</b> (&lt;<b>Default</b>&gt; from the drop-down list on the Import Wizard <b>Source</b> page) is the default Origin worksheet or matrix template.  Unless you have chosen a different default template, this would be ORIGIN.OTW (worksheet) or ORIGIN.OTM (matrix).
</p><p><br />
</p>

