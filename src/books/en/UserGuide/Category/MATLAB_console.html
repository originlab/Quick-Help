<h1 class="firstHeading">25.3 MATLAB Console</h1><p class='urlname' style='display: none'>MATLABConsole</p>
<div style="text-align: left; direction: ltr; margin-left: 1em;">
<p><a  class="image"><img alt="Video Image.png" src="../images/MATLAB_console/Video_Image.png?v=29468" width="33"  /></a> See more related video:<a class="external text" href="http://www.originlab.com/index.aspx?go=Support/VideoTutorials&amp;ss=chm&amp;pid=1778" target="_blank">Importing and Connecting with MATLAB</a>
</p></div>
<p>The "MATLAB Console" tool allows Origin users to issue MATLAB commands from within the Origin environment, and transfer data between the two applications either using a graphical interface, or by issuing commands.  
</p>
<ul><li> The Console requires both Origin and MATLAB be installed on the same computer.</li>
<li> Origin also supports importing MATLAB (MAT) files from disk. There are two import routines, the older <a href="../../UserGuide/UserGuide/Importing_Third_Party_Files.html" title="UserGuide:Importing Third Party Files"><b>Data: Import from File</b></a> and the new Connector-based <a href="../../UserGuide/UserGuide/Connecting_to_File.html#JSON.5CMATLAB_file" title="UserGuide:Connecting to File"><b>Data : Connect to File: MATLAB</b></a>. Importing MAT files does not require MATLAB to be installed.</li></ul>
<p><br />
To start the MATLAB console tool, select <b>Connectivity: MATLAB Console</b> from the Origin menu. A dialog will open asking if you want to connect to the existing MATLAB session. 
</p>
<dl><dd><ul><li>If yes, follow the prompted steps to issue the appropriate command in MATLAB to make the session a shared one and then reconnect to it. </li>
<li>If no, a new instance of the MATLAB application will be launched. You can issue the "desktop" command in the console to make the new MATLAB instance visible.</li></ul></dd>
<dd><a  class="image"><img alt="MATLAB Console.png" src="../images/MATLAB_console/MATLAB_Console.png?v=13710" width="454"  /></a></dd></dl>
<h3><a name="The_Import_Button"></a><span class="mw-headline">The Import Button</span></h3>
<p><a href="../../UserGuide/UserGuide/The_Import_button.html" title="UserGuide:The Import button">The <b>Import</b> button</a> in the top right corner of this dialog brings up the <b>MATLAB Import Dialog</b>. This dialog lists all variables in the current MATLAB workspace.   You can select a single variable, or use SHIFT + select to select multiple variables, and import them into Origin.  Note that when importing, you can either bring the data into a worksheet, or into a matrix.  Check box options allow you to update existing Origin matrices, and to add imported data to existing Origin worksheets.
</p>
<h3><a name="The_Export_Button"></a><span class="mw-headline">The Export Button</span></h3>
<p><a href="../../UserGuide/UserGuide/The_Export_button.html" title="UserGuide:The Export button">The <b>Export</b> button</a> in the top right corner of this dialog brings up the <b>MATLAB Export Dialog</b>. This dialog lists all variables in the current Origin project. User can assign a name for the variable in MATLAB using the Name column, then select desired Origin worksheet columns or matrices, and transfer the selected Origin data to MATLAB.
</p>
<h3><a name="Console_Commands"></a><span class="mw-headline">Console Commands</span></h3>
<p>In addition to using the import and export dialogs to interactively transfer data between the two applications, Origin also provides a set of commands that can be typed in the console window to perform data transfer. The following table lists available commands:
</p>
<table class="simple">

<tr>
<th>Command Syntax
</th>
<td>
<p><b>Description</b>
</p>
</td></tr>
<tr>
<th>gr matName1 matName2 ...
</th>
<td>
<p>Get real matrices named matName1, matName2, etc. from MATLAB.  
</p><p>New matrix windows of the same name are created in Origin.  Existing windows of the same name are overwritten.
</p>
</td></tr>
<tr>
<th>gc matName1 matName2...
</th>
<td>
<p>Get complex matrices named <b>matName1</b>, <b>matName2</b>, etc. from MATLAB. New matrix windows, for real and complex components, are created in Origin. Existing windows of the same name are overwritten.
</p>
</td></tr>
<tr>
<th>pr matName1 matName2...
</th>
<td>
<p>Put real matrices named <b>matName1</b>, <b>matName2</b> etc. from Origin to MATLAB. Existing windows of the same name are overwritten.
</p>
</td></tr>
<tr>
<th>pc matName1 matName2
</th>
<td>
<p>Put complex matrices named <b>matName1</b>, <b>matName2</b> etc. from Origin to MATLAB. Existing windows of the same name are overwritten.
</p>
</td></tr>
<tr>
<th>pwr wkbkrange marray
</th>
<td>
<p>Transfer real data from Origin workbook range <b>wkbkrange</b>, to  MATLAB array named <b>marray</b>.
</p><p>Note that <b>wkbkrange</b> should be a valid Origin range such as <i>col(index),</i> <i>[book1]sheet1!col(name)</i> etc.
</p>
</td></tr>
<tr>
<th>pwc wkbkrange marray
</th>
<td>
<p>Transfer complex data from Origin workbook range <b>wkbkrange</b>, to  MATLAB array named <b>marray</b>.
</p><p>Note that <b>wkbkrange</b> should be a valid Origin range such as <i>col(index),</i> <i>[book1]sheet1!col(name)</i> etc.
</p>
</td></tr>
<tr>
<th>pws wkbkrange marray
</th>
<td>
<p>Transfer strings from Origin workbook range wkbkrange, to  MATLAB array named marray.
</p><p>Note that wkbkrange should be a valid Origin range such as <i>col(index)</i>, <i>[book1]sheet1!col(name)</i> etc.
</p>
</td></tr>
<tr>
<th>gwkspace
<p>gwkspace m
</p>
</th>
<td>
<p>Get all MATLAB variables and place them in multiple matrix sheets and objects in a new matrix window in Origin
</p>
</td></tr>
<tr>
<th>gwkspace w
</th>
<td>
<p>Get all MATLAB variables and place them in multiple worksheets sheets in a new workbook window in Origin
</p>
</td></tr></table>
<table class="note">
<tr>
<td>
<p><b>Note</b>:  The \Samples\COM Server and Client\MATLAB subfolder contains an example (CreatePlotInOrigin.m, CreatePlotInOrigin.OPJ) that illustrates how to connect to an Origin COM server from a MATLAB client (requires MATLAB).
</p>
</td></tr></table>






