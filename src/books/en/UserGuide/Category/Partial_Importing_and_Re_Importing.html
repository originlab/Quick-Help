<h1 class="firstHeading">6.7 Partial Importing and Re-Importing</h1><p class='urlname' style='display: none'>PartialImport-ReImport</p>
<p><br />
</p>
<div style="text-align: left; direction: ltr; margin-left: 1em;">
<p><a  class="image"><img alt="Video Image.png" src="../images/Partial_Importing_and_Re_Importing/Video_Image.png?v=29468" width="33"  /></a> See more related video:<a class="external text" href="http://www.originlab.com/index.aspx?go=Products/Origin/ImportingData&amp;ss=chm&amp;pid=1164" target="_blank">Partial Import</a></p>
</div>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Partial_Import"><span class="tocnumber">1</span> <span class="toctext">Partial Import</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Partial_Import_Controls_used_by_Import_From_File"><span class="tocnumber">1.1</span> <span class="toctext">Partial Import Controls used by Import From File</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Partial_Import_by_NetCDF_Connector"><span class="tocnumber">1.2</span> <span class="toctext">Partial Import by NetCDF Connector</span></a>
<ul>
<li class="toclevel-3 tocsection-4"><a href="#Ultimate_partial-import_control_for_NetCDF"><span class="tocnumber">1.2.1</span> <span class="toctext">Ultimate partial-import control for NetCDF</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-5"><a href="#Partial_Import_by_TDMS_Connector"><span class="tocnumber">1.3</span> <span class="toctext">Partial Import by TDMS Connector</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Re-Import"><span class="tocnumber">2</span> <span class="toctext">Re-Import</span></a></li>
</ul>
</div>

<h2><a name="Partial_Import"></a><span class="mw-headline">Partial Import</span></h2>
<p>When you need to import only part of a data file -- for example, the file contains data that is of no interest or the file is large and slow to import -- you can opt for a <b>partial file import</b>. Note that only select routines support partial import. If a file format is not discussed here, it does not support partial import.
</p>
<ul><li> When importing via <b>Data: Import from File</b>, Origin supports partial import for <a href="../../UserGuide/UserGuide/Customizing_the_ASCII_Import_Options.html" title="UserGuide:Customizing the ASCII Import Options"><b>ASCII</b></a>, <b>binary</b> (using <a href="../../UserGuide/Category/The_Import_Wizard.html" title="Category:The Import Wizard">Import Wizard</a>), <a href="../../UserGuide/UserGuide/Importing_Third_Party_Files.html" title="UserGuide:Importing Third Party Files"><b>comma-separated</b> (CSV)</a>, <a href="../../UserGuide/UserGuide/Importing_from_Excel.html" title="UserGuide:Importing from Excel"><b>MS Excel</b></a> and third-party files of types <a href="../../UserGuide/UserGuide/Importing_Third_Party_Files.html" title="UserGuide:Importing Third Party Files"><b>pCLAMP</b> (ABF, DAT)</a> and <a href="../../UserGuide/UserGuide/Importing_Third_Party_Files.html" title="UserGuide:Importing Third Party Files"><b>Sound</b> (WAV)</a>.</li>
<li> The <a href="../../UserGuide/UserGuide/Importing_Third_Party_Files.html" title="UserGuide:Importing Third Party Files"><b>pCLAMP</b> (ABF, DAT)</a> and <a href="../../UserGuide/UserGuide/Importing_Third_Party_Files.html" title="UserGuide:Importing Third Party Files"><b>Sound</b> (WAV)</a> importing tools have their own controls for partial import of pCLAMP and WAV files. To learn more details, please refer to <a class="external text" href="../../XFunction/X-Function/Details_of_TreeNodes_in_Import_PClamp.html#trfiles">Import pClamp</a> and <a class="external text" href="../../XFunction/X-Function/Details_of_TreeNodes_in_Import_WAV.html#partial">Import WAV</a>.</li>
<li> When importing with the <a href="../../UserGuide/UserGuide/Connecting_to_File.html#Excel" title="UserGuide:Connecting to File"><b>CSV</b> or <b>Excel</b> Connectors</a> (<b>Data: Connect to File:</b>), you can opt for partial import. The CSV Connector shows only <b>Column</b> and <b>Row</b> controls (no <b>From</b>, <b>To</b>, <b>Read</b>, <b>Skip</b>, etc as, for instance, Import ASCII does). Therefore, follow the syntax and examples described under <b>Partial Import Controls</b> &gt; <b>Custom</b>, for <b>Column</b> and <b>Row</b> boxes.</li>
<li> Origin's NetCDF and TDMS Connectors (<b>Data: Connect to File:</b>) also support partial import. However, neither uses standard GUI controls and therefore, both will be discussed in separate sections, below.</li></ul>
<h3><a name="Partial_Import_Controls_used_by_Import_From_File"></a><span class="mw-headline">Partial Import Controls used by Import From File</span></h3>
<p><b>Partial Import</b> controls for the X-Function routines <b>ASCII</b>, <b>binary</b> (Import Wizard), <b>CSV</b> and <b>MS Excel</b> look like those shown in the following image and described in the table below. 
</p>
<dl><dd><dl><dd><a  class="image"><img alt="Partial Import.png" src="../images/Partial_Importing_and_Re_Importing/Partial_Import.png?v=83057" width="439"  /></a></dd></dl></dd></dl>
<table class="dialogcontroltable">

<tr>
<th><b>From</b> and <b>To</b>
</th>
<td>Specify the start and end column index which will be imported.
</td></tr>
<tr>
<th><b>Read</b> and <b>Skip</b>
</th>
<td>When you specify a number <i>l</i> for <b>Read</b> and a number <i>k</i> for <b>Skip</b>, <i>l</i> columns are imported and <i>k</i> columns are skipped for every <i>l</i>+<i>k</i> columns.
</td></tr>
<tr>
<th><b>Custom</b>
</th>
<td>Use the following characters in building your import string:
<dl><dd><ul><li>space ( ) = "and".</li>
<li>colon(:) separates <b>From</b> and <b>To</b>. </li>
<li>vertical bar(|) = "read <i>n</i> cols/rows".</li>
<li>dash(-) = "skip".</li>
<li>tilde(~) = "except".</li></ul></dd></dl>
<dl><dd><i><b>Examples</b></i>
<dl><dd><b>1 3 7</b> import cols/rows 1,3 and 7.</dd>
<dd><b>1:100 ~50:60</b> import cols/rows from 1 to 100, except 50 to 60.</dd>
<dd><b>1:200|3-2</b> import cols/rows from 1 to 200 by reading 3 then skipping 2. </dd>
<dd><b>1:1000 ~200:300 250:260</b> import cols/rows 1 to 1000, skipping 200 to 300 with the exception of 250 to 260. </dd>
<dd><b>1:100|3-7 5:100|2-8</b> imports cols/rows 1 to 100, read 3 then skip 7 and import cols/rows 5 to 100, read 2 then skip 8. The "and" (space) combination generates a repeating pattern of read 3, skip 1, read 2, skip 4 for every 10 cols/rows.</dd></dl></dd></dl>
</td></tr></table>
<h3><a name="Partial_Import_by_NetCDF_Connector"></a><span class="mw-headline">Partial Import by NetCDF Connector</span></h3>
<p>Origin's <a href="../../UserGuide/UserGuide/Connecting_to_File.html#NetCDF" title="UserGuide:Connecting to File"><b>NetCDF</b> Connector</a> has its own GUI controls for specifying partial import. If you are scripting, you can usually save yourself some time by using GUI controls to construct your connection string (see below).
</p>
<ol><li> When importing data via the GUI, the user selects <b>Data: Connect to File: NetCDF</b>. This opens the <b>Data Connector Browser</b>.</li>
<li> The user will then typically <a href="../../UserGuide/UserGuide/Connecting_to_File.html#NetCDF" title="UserGuide:Connecting to File">pick a multi-dimensional variable</a> and click <b>Select Data to Import</b>, adding the variable to the bottom panel. </li>
<li> The user then clicks the <b>Import Options</b> button and specifies partial import either by <b>From</b> and <b>To</b>,  <b>Time Axis Skipping</b> or <b>Averaging</b>, then clicks OK to close Options.
<ul><li> <b>From</b> &amp; <b>To</b>: data-time range to import.</li>
<li> <b>Time Axis Skipping</b>:  Read <i>m</i> records and skip <i>n</i> records and repeat. For example, if data is monthly, <b>Read</b>  = <i>1</i> and <b>Skip</b> = <i>11</i> would repeat the pattern of "read one month and skip 11" for the entire date-time range.</li>
<li> <b>Averaging</b>: Perform an average based on an <b>Interval</b> and either <b>Sampling</b> by <b>Across Years</b> or <b>Consecutive</b>. For example, <b>Across Years</b> and <b>Interval</b> = <i>m</i> would calculate an aggregate average for each month for the date-time range.</li></ul></li></ol>
<p>Once you've set import options and closed the dialog, note that your connection string displays beside the variable in the bottom panel. Note, also, that this string is editable (and for those who are scripting, can be copied) by double-clicking on the string.
</p>
<dl><dd><dl><dd><a  class="image"><img alt="OH partial import connection string 1.png" src="../images/Partial_Importing_and_Re_Importing/OH_partial_import_connection_string_1.png?v=87743" width="511"  /></a></dd></dl></dd></dl>
<p>While the connection string syntax can be complex, it follows the basic form of ...
</p>
<pre class="lt" style="font-family:monospace;">NetCDF<span style="color: #000080;">/</span>variable<span style="color: #000000;">&#91;</span>z<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#91;</span>y<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#91;</span>x<span style="color: #000000;">&#93;</span></pre>
<p>... where "variable" is the variable that you are importing, and [z],[y] and [x] specify handling, including partial import, of z, y and x dimension data. 
</p><p>Note that while specifying partial import of z-dimension data starts with the basic <b>Custom</b> syntax described above, there are some NetCDF Connector-specific modifiers that are best understood by going through the GUI, setting <b>Import Options</b>, then reading or copying the connection string in the Browser dialog. 
</p><p>For most GUI users, the connection string will be of no importance. For those who are scripting, once you obtain the connection string from the GUI, see documentation of the LabTalk <b>wks.dc</b> object for <a class="external text" href="../../LabTalk/Category/Wks.DC_(object).html#Examples">an Example</a> of usage. 
</p>
<h4><a name="Ultimate_partial-import_control_for_NetCDF"></a><span class="mw-headline">Ultimate partial-import control for NetCDF</span></h4>
<p>For GUI users or scripters who need the highest level of control over partial import, you can edit the connection string manually by doubling-clicking on it in the <b>Data Connector Browser</b>. Refer to the <b>Custom</b> table, above, for syntax.
</p><p><br />
<i><b>Example 1</b></i><br />
Let's say, for instance, that you have a dataset of monthly readings that spans Jan 1948 to Jun 2018. You know that in the calendar year of 1958, instrumentation was not reliable and therefore, you want to exclude just those 12 readings. Your connection string must, therefore, exclude 12 months from month 121 to month 132.
</p>
<pre class="lt" style="font-family:monospace;">precip<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">0</span>~<span style="color: #0000dd;">121</span><span style="color: #000000;">:</span><span style="color: #0000dd;">132</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">&#91;</span>y#<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#91;</span>x<span style="color: #000000;">&#93;</span>
precip<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">846</span>~<span style="color: #0000dd;">121</span><span style="color: #000000;">:</span><span style="color: #0000dd;">132</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">&#91;</span>y#<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#91;</span>x<span style="color: #000000;">&#93;</span> <span style="color: #008000;">// alternate syntax for &quot;From&quot; and &quot;To&quot; months</span></pre>
<p><br />
<i><b>Example 2</b></i><br />
There is no particular user-story with this example but what it does is to begin importing at matrix 1, skips 11, imports another, skips 11 etc. for 120 matrices. At matrix 121 it begins to import 2 and skip 10 until it reaches matrix 241. From matrix 241 until the last matrix (represented by "0"), it imports 3 matrices and skips 9. While the example is trivial, it demonstrates that complex connection strings can be built if one has the desire and the patience.
</p>
<pre class="lt" style="font-family:monospace;">precip<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">120</span><span style="color: #000080;">|</span><span style="color: #0000dd;">1</span><span style="color: #000080;">-</span><span style="color: #0000dd;">11</span> <span style="color: #0000dd;">121</span><span style="color: #000000;">:</span><span style="color: #0000dd;">240</span><span style="color: #000080;">|</span><span style="color: #0000dd;">2</span><span style="color: #000080;">-</span><span style="color: #0000dd;">10</span> <span style="color: #0000dd;">241</span><span style="color: #000000;">:</span><span style="color: #0000dd;">0</span><span style="color: #000080;">|</span><span style="color: #0000dd;">3</span><span style="color: #000080;">-</span><span style="color: #0000dd;">9</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">&#91;</span>y#<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#91;</span>x<span style="color: #000000;">&#93;</span></pre>
<h3><a name="Partial_Import_by_TDMS_Connector"></a><span class="mw-headline">Partial Import by TDMS Connector</span></h3>
<p>When specifying partial import for TDMS files using Origin's <b>TDMS Connector</b>, you can follow a similar (though simplified) strategy as laid out above for NetCDF files:
</p>
<ol><li> Activate a workbook and choose <b>Data: Connect to File: TDMS</b>.</li>
<li> Browse to your file and click <b>Open</b>.</li>
<li> In the Data Connector Browser, click a node and click <b>Select data to Import</b> at the bottom of the dialog.</li>
<li> To perform partial import, double-click on the connection string and modify the string by specifying range using the syntax described in <b>Custom</b>, in the above table. Note that partial ranges must be specified at the <i>end</i> of the string (e.g <i>TDMS/Dynamic Data Type (time domain, absolute)/Square with Uniform Noise[10:90]</i>).</li></ol>
<dl><dd><a  class="image"><img alt="OH partial import connection string 2.png" src="../images/Partial_Importing_and_Re_Importing/OH_partial_import_connection_string_2.png?v=87750" width="761"  /></a></dd></dl>
<h2><a name="Re-Import"></a><span class="mw-headline">Re-Import</span></h2>
<p><a class="external text" href="../../GettingStarted/OriginLab/Import_Data.html#Re-Importing_Data_Files"><b>Re-importing</b></a>, as the name suggests, allows you to repeat the import of a file that has been imported previously.  You may want to use this feature when the imported file has been updated -- direct import with no change of options -- or you want to use different import options.  Both are performed via menu commands on the <b>File: Import</b> menu.  The re-importing feature is available for <b>ASCII</b> and <a href="../../UserGuide/UserGuide/Importing_Third_Party_Files.html" title="UserGuide:Importing Third Party Files">some <b>third-party</b> files</a>.
</p><p>If you are using a <a href="../../UserGuide/UserGuide/Connecting_to_File.html" title="UserGuide:Connecting to File"><b>Data Connector</b></a> for import, data can be refreshed as needed; on import or at any time during the session by clicking the Connector icon and choosing <b>Import</b> or by clicking on the download icon in one of the project's graph windows (for information, see <a class="external text" href="../../QuickHelp/QuickHelp/Connector_Open_Project_Data_Missing.html">FAQ-1080 I used a Data Connector to import data but when I reopen my project, the data is missing</a>).
</p>





