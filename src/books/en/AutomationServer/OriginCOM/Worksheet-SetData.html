<h1 class="firstHeading">2.42.20 SetData</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Syntax"><span class="tocnumber">2</span> <span class="toctext">Syntax</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Parameters"><span class="tocnumber">3</span> <span class="toctext">Parameters</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Return"><span class="tocnumber">4</span> <span class="toctext">Return</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Remark"><span class="tocnumber">5</span> <span class="toctext">Remark</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Examples"><span class="tocnumber">6</span> <span class="toctext">Examples</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#VBA"><span class="tocnumber">6.1</span> <span class="toctext">VBA</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#C.23"><span class="tocnumber">6.2</span> <span class="toctext">C#</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#VC.2B.2B"><span class="tocnumber">6.3</span> <span class="toctext">VC++</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-10"><a href="#Version_Information"><span class="tocnumber">7</span> <span class="toctext">Version Information</span></a></li>
<li class="toclevel-1 tocsection-11"><a href="#See_Also"><span class="tocnumber">8</span> <span class="toctext">See Also</span></a></li>
</ul>
</div>

<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>Put two dimensional data into a specified Origin worksheet starting at a specified column and row.
</p><p>This method is the same as <a href="../../AutomationServer/OriginCOM/Application-PutWorksheet.html" title="OriginCOM:Application-PutWorksheet">Application.PutWorksheet</a>.
</p>
<h2><a name="Syntax"></a><span class="mw-headline">Syntax</span></h2>
<code><pre>
VB: Function SetData(data As ByVal Object, [ nRowOffset As ByVal Object ], [ nColOffset As ByVal Object ] ) As Boolean
</pre></code>
<code><pre>
C++: bool SetData(_variant_t data, _variant_t nRowOffset, _variant_t nColOffset )
</pre></code>
<code><pre>
C#: bool SetData(var data, var nRowOffset, var nColOffset )
</pre></code>
<h2><a name="Parameters"></a><span class="mw-headline">Parameters</span></h2>
<dl><dt>data</dt>
<dd>A two-dimensional safearray containing the data that will be put into the worksheet.</dd>
<dt>nRowOffset</dt>
<dd>Zero based index of the first row, in the worksheet, to receive the data.  Default is zero.  Use -1 to append the data.</dd>
<dt>nColOffset</dt>
<dd>Zero based index of the first column, in the worksheet, to receive the data.  Default is zero.  Use -1 to append the data.</dd></dl>
<h2><a name="Return"></a><span class="mw-headline">Return</span></h2>
<p>Returns true if successful else false.
</p>
<h2><a name="Remark"></a><span class="mw-headline">Remark</span></h2>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p>The following examples will connect to the currently running Origin and put data into the active worksheet.
</p><p>See examples at <a href="../../AutomationServer/OriginCOM/Column-SetData.html" title="OriginCOM:Column-SetData">Column.SetData</a> for more details about buffering data of different types.
</p>
<h3><a name="VBA"></a><span class="mw-headline">VBA</span></h3>
<p>Set numeric data into an Origin worksheet.
</p>
<pre class="vb" style="font-family:monospace;"><span style="color: #E56717; font-weight: bold;">Public</span> <span style="color: #E56717; font-weight: bold;">Sub</span> SetNumericData()
    <span style="color: #151B8D; font-weight: bold;">Dim</span> app <span style="color: #151B8D; font-weight: bold;">As</span> Origin.ApplicationSI
    <span style="color: #151B8D; font-weight: bold;">Dim</span> Wks <span style="color: #151B8D; font-weight: bold;">As</span> Origin.Worksheet
    <span style="color: #151B8D; font-weight: bold;">Dim</span> Data(1 <span style="color: #8D38C9; font-weight: bold;">To</span> 100, 1 <span style="color: #8D38C9; font-weight: bold;">To</span> 3) <span style="color: #151B8D; font-weight: bold;">As</span> <span style="color: #F660AB; font-weight: bold;">Double</span>
    <span style="color: #151B8D; font-weight: bold;">Dim</span> ii <span style="color: #151B8D; font-weight: bold;">As</span> <span style="color: #F660AB; font-weight: bold;">Integer</span>
    <span style="color: #008000;">'Set the 2D numeric array, which has 100 rows and 3 cols
</span>    <span style="color: #8D38C9; font-weight: bold;">For</span> ii = 1 <span style="color: #8D38C9; font-weight: bold;">To</span> 100
        Data(ii, 1) = ii * 0.01 - 1.23
        Data(ii, 2) = ii / 12.8 - 0.75
        Data(ii, 3) = ii + 0.123
    <span style="color: #8D38C9; font-weight: bold;">Next</span>
 
    <span style="color: #151B8D; font-weight: bold;">Set</span> app = <span style="color: #E56717; font-weight: bold;">New</span> Origin.ApplicationSI     <span style="color: #008000;">'Connect to the running Origin
</span>    <span style="color: #151B8D; font-weight: bold;">Set</span> Wks = app.FindWorksheet(<span style="color: #800000;">&quot;&quot;</span>)        <span style="color: #008000;">'Select the active worksheet
</span> 
    <span style="color: #008000;">'Send Numeric values to Origin
</span>    Wks.SetData (Data)

    <span style="color: #008000;">'Create a new graph page using Origin template
</span>    <span style="color: #151B8D; font-weight: bold;">Dim</span> glay <span style="color: #151B8D; font-weight: bold;">As</span> Origin.GraphLayer
    <span style="color: #151B8D; font-weight: bold;">Dim</span> dr <span style="color: #151B8D; font-weight: bold;">As</span> Origin.DataRange
    <span style="color: #151B8D; font-weight: bold;">Dim</span> dp <span style="color: #151B8D; font-weight: bold;">As</span> Origin.DataPlot
    <span style="color: #151B8D; font-weight: bold;">Set</span> glay = Wks.Application.GraphPages.Add(<span style="color: #800000;">&quot;Origin&quot;</span>).Layers(0)
    <span style="color: #151B8D; font-weight: bold;">Set</span> dr = Wks.NewDataRange(0, 0, -1, 2) <span style="color: #008000;">'create range to be plotted, all rows,A,B,C
</span>    <span style="color: #151B8D; font-weight: bold;">Set</span> dp = glay.DataPlots.Add(dr, IDM_PLOT_LINE)
    
    <span style="color: #008000;">'Save the project to Origin User folder
</span>    app.Save (app.Path(APPPATH_USER) + <span style="color: #800000;">&quot;COMServerExamples_WN.opj&quot;</span>)
 
<span style="color: #8D38C9; font-weight: bold;">End</span> <span style="color: #E56717; font-weight: bold;">Sub</span></pre>
<p>Set text data into an Origin worksheet.
</p>
<pre class="vb" style="font-family:monospace;"><span style="color: #E56717; font-weight: bold;">Public</span> <span style="color: #E56717; font-weight: bold;">Sub</span> SetTextData()
    <span style="color: #151B8D; font-weight: bold;">Dim</span> app <span style="color: #151B8D; font-weight: bold;">As</span> Origin.ApplicationSI
    <span style="color: #151B8D; font-weight: bold;">Dim</span> Wks <span style="color: #151B8D; font-weight: bold;">As</span> Origin.Worksheet
    <span style="color: #151B8D; font-weight: bold;">Dim</span> tData(1 <span style="color: #8D38C9; font-weight: bold;">To</span> 100, 1 <span style="color: #8D38C9; font-weight: bold;">To</span> 2) <span style="color: #151B8D; font-weight: bold;">As</span> <span style="color: #F660AB; font-weight: bold;">String</span>
    <span style="color: #151B8D; font-weight: bold;">Dim</span> ii <span style="color: #151B8D; font-weight: bold;">As</span> <span style="color: #F660AB; font-weight: bold;">Integer</span>
    <span style="color: #008000;">'Set the 2D string array, which has 100 rows and 2 cols
</span>    <span style="color: #8D38C9; font-weight: bold;">For</span> ii = 1 <span style="color: #8D38C9; font-weight: bold;">To</span> 100
        tData(ii, 1) = <span style="color: #800000;">&quot;abc&quot;</span> + Str(ii)
        tData(ii, 2) = <span style="color: #800000;">&quot;def&quot;</span> + Str(ii + 3)
    <span style="color: #8D38C9; font-weight: bold;">Next</span>
 
    <span style="color: #151B8D; font-weight: bold;">Set</span> app = <span style="color: #E56717; font-weight: bold;">New</span> Origin.ApplicationSI
    <span style="color: #151B8D; font-weight: bold;">Set</span> Wks = app.FindWorksheet(<span style="color: #800000;">&quot;&quot;</span>)
 
    <span style="color: #008000;">'Send Text to Origin
</span>    Wks.SetData (tData)
    
    <span style="color: #008000;">'Save the project to Origin User folder
</span>    app.Save (app.Path(APPPATH_USER) + <span style="color: #800000;">&quot;COMServerExamples_WT.opj&quot;</span>)
 
<span style="color: #8D38C9; font-weight: bold;">End</span> <span style="color: #E56717; font-weight: bold;">Sub</span></pre>
<p>The next example simulates real-time data being sent to the active worksheet.
</p>
<pre class="vb" style="font-family:monospace;"><span style="color: #E56717; font-weight: bold;">Private</span> <span style="color: #E56717; font-weight: bold;">Sub</span> SimulateRealTimeData()
   
    Const NUM_BLOCKS = 10000
    Const NUM_PTS_PER_BLOCK = 100

    <span style="color: #151B8D; font-weight: bold;">Dim</span> app <span style="color: #151B8D; font-weight: bold;">As</span> Origin.ApplicationSI
    <span style="color: #151B8D; font-weight: bold;">Dim</span> wks <span style="color: #151B8D; font-weight: bold;">As</span> Origin.Worksheet
    <span style="color: #151B8D; font-weight: bold;">Dim</span> block <span style="color: #151B8D; font-weight: bold;">As</span> <span style="color: #F660AB; font-weight: bold;">Integer</span>
    <span style="color: #151B8D; font-weight: bold;">Dim</span> data(1 <span style="color: #8D38C9; font-weight: bold;">To</span> NUM_PTS_PER_BLOCK, 1) <span style="color: #151B8D; font-weight: bold;">As</span> <span style="color: #F660AB; font-weight: bold;">Double</span>
    <span style="color: #151B8D; font-weight: bold;">Dim</span> point <span style="color: #151B8D; font-weight: bold;">As</span> <span style="color: #F660AB; font-weight: bold;">Integer</span>
    <span style="color: #151B8D; font-weight: bold;">Dim</span> startSecs <span style="color: #151B8D; font-weight: bold;">As</span> <span style="color: #F660AB; font-weight: bold;">Single</span>
    <span style="color: #151B8D; font-weight: bold;">Dim</span> row <span style="color: #151B8D; font-weight: bold;">As</span> <span style="color: #F660AB; font-weight: bold;">Integer</span>
    <span style="color: #151B8D; font-weight: bold;">Dim</span> bRet <span style="color: #151B8D; font-weight: bold;">As</span> <span style="color: #F660AB; font-weight: bold;">Integer</span>
    
    <span style="color: #151B8D; font-weight: bold;">Set</span> app = <span style="color: #E56717; font-weight: bold;">New</span> Origin.ApplicationSI
    <span style="color: #151B8D; font-weight: bold;">Set</span> wks = app.FindWorksheet(<span style="color: #800000;">&quot;&quot;</span>) <span style="color: #008000;">' active worksheet
</span>    <span style="color: #8D38C9; font-weight: bold;">If</span> wks <span style="color: #8D38C9; font-weight: bold;">Is</span> <span style="color: #00C2FF; font-weight: bold;">Nothing</span> <span style="color: #8D38C9; font-weight: bold;">Then</span>
        MsgBox (<span style="color: #800000;">&quot;Specified Worksheet not found&quot;</span>)
    <span style="color: #8D38C9; font-weight: bold;">Else</span>
    
    row = 0
    <span style="color: #8D38C9; font-weight: bold;">For</span> block = 1 <span style="color: #8D38C9; font-weight: bold;">To</span> NUM_BLOCKS
        <span style="color: #008000;">' generate some random data
</span>        <span style="color: #8D38C9; font-weight: bold;">For</span> point = 1 <span style="color: #8D38C9; font-weight: bold;">To</span> NUM_PTS_PER_BLOCK
            data(point, 0) = Rnd(1)
            data(point, 1) = Rnd(1)
        <span style="color: #8D38C9; font-weight: bold;">Next</span> point
        
        <span style="color: #008000;">' send data to worksheet
</span>        bRet = wks.SetData(data, row)
        
        <span style="color: #008000;">' calc target row for next block
</span>        row = row + NUM_PTS_PER_BLOCK

        <span style="color: #008000;">' pause before sending next block of data
</span>        startSecs = Timer
        <span style="color: #8D38C9; font-weight: bold;">Do</span> <span style="color: #8D38C9; font-weight: bold;">While</span> Timer &lt; startSecs + 2
            <span style="color: #8D38C9; font-weight: bold;">DoEvents</span>
        <span style="color: #8D38C9; font-weight: bold;">Loop</span>
    <span style="color: #8D38C9; font-weight: bold;">Next</span> block
    
    <span style="color: #8D38C9; font-weight: bold;">End</span> <span style="color: #8D38C9; font-weight: bold;">If</span>
    
<span style="color: #8D38C9; font-weight: bold;">End</span> <span style="color: #E56717; font-weight: bold;">Sub</span></pre>
<h3><a name="C.23"></a><span class="mw-headline">C#</span></h3>
<p>Set numeric data into an Origin worksheet.
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #6666cc; font-weight: bold;">void</span> SetNumericData<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>
<span style="color: #008000;">&#123;</span>
	<span style="color: #008080; font-style: italic;">// Create some data to put into the worksheet.</span>
	<span style="color: #6666cc; font-weight: bold;">float</span><span style="color: #008000;">&#91;</span>,<span style="color: #008000;">&#93;</span> data <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> <span style="color: #6666cc; font-weight: bold;">float</span><span style="color: #008000;">&#91;</span><span style="color: #FF0000;">100</span>, <span style="color: #FF0000;">3</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">;</span>
	<span style="color: #0600FF; font-weight: bold;">for</span> <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">int</span> i <span style="color: #008000;">=</span> <span style="color: #FF0000;">0</span><span style="color: #008000;">;</span> i <span style="color: #008000;">&lt;</span> <span style="color: #FF0000;">100</span><span style="color: #008000;">;</span> i<span style="color: #008000;">++</span><span style="color: #008000;">&#41;</span>
	<span style="color: #008000;">&#123;</span>
		data<span style="color: #008000;">&#91;</span>i, <span style="color: #FF0000;">0</span><span style="color: #008000;">&#93;</span> <span style="color: #008000;">=</span> <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">float</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#40;</span>i <span style="color: #008000;">*</span> <span style="color: #FF0000;">0.01</span> <span style="color: #008000;">-</span> <span style="color: #FF0000;">1.23</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		data<span style="color: #008000;">&#91;</span>i, <span style="color: #FF0000;">1</span><span style="color: #008000;">&#93;</span> <span style="color: #008000;">=</span> <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">float</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#40;</span>i <span style="color: #008000;">/</span> <span style="color: #FF0000;">12.8</span> <span style="color: #008000;">-</span> <span style="color: #FF0000;">0.75</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		data<span style="color: #008000;">&#91;</span>i, <span style="color: #FF0000;">2</span><span style="color: #008000;">&#93;</span> <span style="color: #008000;">=</span> <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">float</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#40;</span>i <span style="color: #008000;">+</span> <span style="color: #FF0000;">0.123</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
	<span style="color: #008000;">&#125;</span>

	<span style="color: #008080; font-style: italic;">// Connect to Origin.</span>
	Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">ApplicationSI</span> originApp <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">ApplicationSI</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>

	<span style="color: #008080; font-style: italic;">// Get the active worksheet.</span>
	Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">Worksheet</span> wks <span style="color: #008000;">=</span> originApp<span style="color: #008000;">.</span><span style="color: #0000FF;">FindWorksheet</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>

	<span style="color: #008080; font-style: italic;">// Put the data into the worksheet starting at column 1 and row 1.</span>
	wks<span style="color: #008000;">.</span><span style="color: #0000FF;">SetData</span><span style="color: #008000;">&#40;</span>data, <span style="color: #FF0000;">0</span>, <span style="color: #FF0000;">0</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
<span style="color: #008000;">&#125;</span></pre>
<p>Set text data into an Origin worksheet.
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #6666cc; font-weight: bold;">void</span> SetTextData<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>
<span style="color: #008000;">&#123;</span>
	<span style="color: #008080; font-style: italic;">// Create some data to put into the worksheet.</span>
	<span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#91;</span>,<span style="color: #008000;">&#93;</span> data <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> <span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#91;</span><span style="color: #FF0000;">100</span>, <span style="color: #FF0000;">2</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">;</span>
	<span style="color: #0600FF; font-weight: bold;">for</span> <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">int</span> i <span style="color: #008000;">=</span> <span style="color: #FF0000;">0</span><span style="color: #008000;">;</span> i <span style="color: #008000;">&lt;</span> <span style="color: #FF0000;">100</span><span style="color: #008000;">;</span> i<span style="color: #008000;">++</span><span style="color: #008000;">&#41;</span>
	<span style="color: #008000;">&#123;</span>
		data<span style="color: #008000;">&#91;</span>i, <span style="color: #FF0000;">0</span><span style="color: #008000;">&#93;</span> <span style="color: #008000;">=</span> <span style="color: #666666;">&quot;abc&quot;</span> <span style="color: #008000;">+</span> i<span style="color: #008000;">.</span><span style="color: #0000FF;">ToString</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		data<span style="color: #008000;">&#91;</span>i, <span style="color: #FF0000;">1</span><span style="color: #008000;">&#93;</span> <span style="color: #008000;">=</span> <span style="color: #666666;">&quot;def&quot;</span> <span style="color: #008000;">+</span> <span style="color: #008000;">&#40;</span>i <span style="color: #008000;">+</span> <span style="color: #FF0000;">3</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">.</span><span style="color: #0000FF;">ToString</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
	<span style="color: #008000;">&#125;</span>

	<span style="color: #008080; font-style: italic;">// Connect to Origin.</span>
	Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">ApplicationSI</span> originApp <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">ApplicationSI</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>

	<span style="color: #008080; font-style: italic;">// Get the active worksheet.</span>
	Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">Worksheet</span> wks <span style="color: #008000;">=</span> originApp<span style="color: #008000;">.</span><span style="color: #0000FF;">FindWorksheet</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>

	<span style="color: #008080; font-style: italic;">// Put the data into the worksheet starting at column 1 and row 1.</span>
	wks<span style="color: #008000;">.</span><span style="color: #0000FF;">SetData</span><span style="color: #008000;">&#40;</span>data, <span style="color: #FF0000;">0</span>, <span style="color: #FF0000;">0</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
<span style="color: #008000;">&#125;</span></pre>
<h3><a name="VC.2B.2B"></a><span class="mw-headline">VC++</span></h3>
<p>The following code will run a new instance of Origin and send data to a specified worksheet
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #ff00ff;">&quot;stdafx.h&quot;</span>
<span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>afxdisp.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span>        <span style="color: #008000;">// MFC classes, as to use COleSafeArray</span>
<span style="color: #008000;">//make sure Origin8.tlb in the same folder as this program</span>
#import <span style="color: #ff00ff;">&quot;Origin8.tlb&quot;</span> rename_namespace<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Origin&quot;</span><span style="color: #000000;">&#41;</span>
<span style="color: #0000ff;">using</span> <span style="color: #0000ff;">namespace</span> Origin;
 
<span style="color: #0000ff;">#define</span>	NUM_COLS <span style="color: #0000dd;">4</span>
<span style="color: #0000ff;">#define</span> NUM_ROWS <span style="color: #0000dd;">10</span>
<span style="color: #0000ff;">#define</span>	PAGE_TYPE_WKS	<span style="color: #0000dd;">2</span>
<span style="color: #0000ff;">#define</span>	PAGE_VISIBLE	<span style="color: #0000dd;">2</span> 
 
<span style="color: #0000ff;">bool</span> sendDataToWks<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	Origin<span style="color: #000000;">::</span><span style="color: #000000;">IOApplicationPtr</span> pOrigin;
	pOrigin.<span style="color: #000000;">CreateInstance</span><span style="color: #000000;">&#40;</span>__uuidof<span style="color: #000000;">&#40;</span>Application<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//use __uuidof(ApplicationSI) will connect to a running Origin instance</span>
	pOrigin<span style="color: #000040;">-</span><span style="color: #000080;">&gt;</span>PutVisible<span style="color: #000000;">&#40;</span>Origin<span style="color: #000000;">::</span><span style="color: #000000;">MAINWND_SHOW_BRING_TO_FRONT</span><span style="color: #000000;">&#41;</span>;
 
	pOrigin<span style="color: #000040;">-</span><span style="color: #000080;">&gt;</span>CreatePage<span style="color: #000000;">&#40;</span>PAGE_TYPE_WKS, <span style="color: #ff00ff;">&quot;Data&quot;</span>, <span style="color: #ff00ff;">&quot;w&quot;</span>, PAGE_VISIBLE<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//&quot;w&quot; is template name while &quot;Data&quot; as worksheet page name</span>
	Origin<span style="color: #000000;">::</span><span style="color: #000000;">WorksheetPagePtr</span> pPage <span style="color: #000080;">=</span> pOrigin<span style="color: #000040;">-</span><span style="color: #000080;">&gt;</span>GetActivePage<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	pPage<span style="color: #000040;">-</span><span style="color: #000080;">&gt;</span>Activate<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
 
	Origin<span style="color: #000000;">::</span><span style="color: #000000;">WorksheetPtr</span> pwks <span style="color: #000080;">=</span> pPage<span style="color: #000040;">-</span><span style="color: #000080;">&gt;</span>GetLayers<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000040;">-</span><span style="color: #000080;">&gt;</span>Add<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;abc&quot;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//new worksheet name is abc</span>
	pwks<span style="color: #000040;">-</span><span style="color: #000080;">&gt;</span>Activate<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
 
	COleSafeArray csarr;
	DWORD dwBound<span style="color: #000000;">&#91;</span><span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span>NUM_ROWS, NUM_COLS<span style="color: #000000;">&#125;</span>; <span style="color: #008000;">//declare the array as NUM_ROWS*NUM_COLS</span>
	csarr.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span>VT_UI2, <span style="color: #0000dd;">2</span>, dwBound<span style="color: #000000;">&#41;</span>;
 
	<span style="color: #0000ff;">long</span> nIndices<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#93;</span>;
	USHORT uData;
	<span style="color: #0000ff;">for</span> <span style="color: #000000;">&#40;</span> <span style="color: #0000ff;">int</span> ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; ii <span style="color: #000080;">&lt;</span> NUM_ROWS; ii<span style="color: #000040;">++</span> <span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		<span style="color: #0000ff;">for</span> <span style="color: #000000;">&#40;</span> <span style="color: #0000ff;">int</span> jj <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; jj <span style="color: #000080;">&lt;</span> NUM_COLS; jj<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span> 
		<span style="color: #000000;">&#123;</span>
			nIndices<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> ii;
			nIndices<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> jj;
			uData <span style="color: #000080;">=</span> <span style="color: #000000;">&#40;</span>ii <span style="color: #000040;">+</span> jj<span style="color: #000000;">&#41;</span><span style="color: #000040;">%</span>65536;
			csarr.<span style="color: #000000;">PutElement</span><span style="color: #000000;">&#40;</span>nIndices, <span style="color: #000040;">&amp;</span>uData<span style="color: #000000;">&#41;</span>;
		<span style="color: #000000;">&#125;</span>
	<span style="color: #000000;">&#125;</span>
 
	pwks<span style="color: #000040;">-</span><span style="color: #000080;">&gt;</span>SetData<span style="color: #000000;">&#40;</span>csarr, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
 
 	<span style="color: #000000;">System</span><span style="color: #000000;">::</span><span style="color: #000000;">Console</span><span style="color: #000000;">::</span><span style="color: #000000;">ReadKey</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;<span style="color: #008000;">//press key will exit Origin and this instance</span>
	pOrigin<span style="color: #000040;">-</span><span style="color: #000080;">&gt;</span><span style="color: #000000;">Exit</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span>;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Version_Information"></a><span class="mw-headline">Version Information</span></h2>
<p>8.0SR2
</p>
<h2><a name="See_Also"></a><span class="mw-headline">See Also</span></h2>
<p><a href="../../AutomationServer/OriginCOM/Worksheet-GetData.html" title="OriginCOM:Worksheet-GetData">GetData</a> | <a href="../../AutomationServer/OriginCOM/Application-PutWorksheet.html" title="OriginCOM:Application-PutWorksheet">Application.PutWorksheet</a> | <a href="../../AutomationServer/OriginCOM/Application-GetWorksheet.html" title="OriginCOM:Application-GetWorksheet">Application.GetWorksheet</a> | <a href="../../AutomationServer/OriginCOM/Column-SetData.html" title="OriginCOM:Column-SetData">Column.SetData</a> | <a href="../../AutomationServer/OriginCOM/Column-GetData.html" title="OriginCOM:Column-GetData">Column.GetData</a>
</p>





