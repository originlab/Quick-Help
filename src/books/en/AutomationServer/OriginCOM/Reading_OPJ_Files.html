<h1 class="firstHeading">1.1.2 Reading OPJ Files</h1><h2><a name="C.23"></a><span class="mw-headline">C#</span></h2>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">void</span> LoadData<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>
<span style="color: #008000;">&#123;</span>
    <span style="color: #6666cc; font-weight: bold;">string</span> strPathName <span style="color: #008000;">=</span> <span style="color: #666666;">&quot;C:<span style="color: #008080; font-weight: bold;">\\</span>Users<span style="color: #008080; font-weight: bold;">\\</span>developer.MICROCAL<span style="color: #008080; font-weight: bold;">\\</span>Desktop<span style="color: #008080; font-weight: bold;">\\</span>Test_DataType.opj&quot;</span><span style="color: #008000;">;</span>
    <span style="color: #6666cc; font-weight: bold;">int</span> Colsize<span style="color: #008000;">;</span>
    <span style="color: #6666cc; font-weight: bold;">int</span> ii, jj, kk <span style="color: #008000;">=</span> <span style="color: #FF0000;">0</span><span style="color: #008000;">;</span>

    Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">Application</span> org <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">Application</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    org<span style="color: #008000;">.</span><span style="color: #0000FF;">Load</span><span style="color: #008000;">&#40;</span>strPathName, <span style="color: #000000;">System</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Type</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Missing</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>

    <span style="color: #0600FF; font-weight: bold;">for</span> <span style="color: #008000;">&#40;</span>ii <span style="color: #008000;">=</span> <span style="color: #FF0000;">0</span><span style="color: #008000;">;</span> ii <span style="color: #008000;">&lt;</span> org<span style="color: #008000;">.</span><span style="color: #0000FF;">WorksheetPages</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Count</span><span style="color: #008000;">;</span> ii<span style="color: #008000;">++</span><span style="color: #008000;">&#41;</span>
    <span style="color: #008000;">&#123;</span> 
        Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">WorksheetPage</span> orgWkbk <span style="color: #008000;">=</span> org<span style="color: #008000;">.</span><span style="color: #0000FF;">WorksheetPages</span><span style="color: #008000;">&#91;</span>ii<span style="color: #008000;">&#93;</span><span style="color: #008000;">;</span>
        textBox<span style="color: #008000;">.</span><span style="color: #0000FF;">Text</span> <span style="color: #008000;">=</span> textBox<span style="color: #008000;">.</span><span style="color: #0000FF;">Text</span> <span style="color: #008000;">+</span> <span style="color: #008000;">&#40;</span>ii <span style="color: #008000;">+</span> <span style="color: #FF0000;">1</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">.</span><span style="color: #0000FF;">ToString</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">+</span> <span style="color: #666666;">&quot;. Book&quot;</span> <span style="color: #008000;">+</span> <span style="color: #008000;">&#40;</span>ii <span style="color: #008000;">+</span> <span style="color: #FF0000;">1</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">.</span><span style="color: #0000FF;">ToString</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">+</span> <span style="color: #666666;">&quot;<span style="color: #008080; font-weight: bold;">\r</span><span style="color: #008080; font-weight: bold;">\n</span>&quot;</span><span style="color: #008000;">;</span>
        
        <span style="color: #0600FF; font-weight: bold;">for</span> <span style="color: #008000;">&#40;</span>jj <span style="color: #008000;">=</span> <span style="color: #FF0000;">0</span><span style="color: #008000;">;</span> jj <span style="color: #008000;">&lt;</span> orgWkbk<span style="color: #008000;">.</span><span style="color: #0000FF;">Layers</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Count</span><span style="color: #008000;">;</span> jj<span style="color: #008000;">++</span><span style="color: #008000;">&#41;</span>
        <span style="color: #008000;">&#123;</span>
            Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">Worksheet</span> orgWks <span style="color: #008000;">=</span> <span style="color: #008000;">&#40;</span>Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">Worksheet</span><span style="color: #008000;">&#41;</span>orgWkbk<span style="color: #008000;">.</span><span style="color: #0000FF;">Layers</span><span style="color: #008000;">&#91;</span>jj<span style="color: #008000;">&#93;</span><span style="color: #008000;">;</span>
            textBox<span style="color: #008000;">.</span><span style="color: #0000FF;">Text</span> <span style="color: #008000;">=</span> textBox<span style="color: #008000;">.</span><span style="color: #0000FF;">Text</span> <span style="color: #008000;">+</span> <span style="color: #666666;">&quot;  &quot;</span> <span style="color: #008000;">+</span> <span style="color: #008000;">&#40;</span>jj <span style="color: #008000;">+</span> <span style="color: #FF0000;">1</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">.</span><span style="color: #0000FF;">ToString</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">+</span> <span style="color: #666666;">&quot;. Sheet&quot;</span> <span style="color: #008000;">+</span> <span style="color: #008000;">&#40;</span>jj <span style="color: #008000;">+</span> <span style="color: #FF0000;">1</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">.</span><span style="color: #0000FF;">ToString</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">+</span> <span style="color: #666666;">&quot;<span style="color: #008080; font-weight: bold;">\r</span><span style="color: #008080; font-weight: bold;">\n</span>&quot;</span><span style="color: #008000;">;</span>

            <span style="color: #0600FF; font-weight: bold;">for</span> <span style="color: #008000;">&#40;</span>kk <span style="color: #008000;">=</span> <span style="color: #FF0000;">0</span><span style="color: #008000;">;</span> kk <span style="color: #008000;">&lt;</span> orgWks<span style="color: #008000;">.</span><span style="color: #0000FF;">Columns</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Count</span><span style="color: #008000;">;</span> kk<span style="color: #008000;">++</span><span style="color: #008000;">&#41;</span>
            <span style="color: #008000;">&#123;</span>
                Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">Column</span> orgCol <span style="color: #008000;">=</span> orgWks<span style="color: #008000;">.</span><span style="color: #0000FF;">Columns</span><span style="color: #008000;">&#91;</span>kk<span style="color: #008000;">&#93;</span><span style="color: #008000;">;</span>
                <span style="color: #6666cc; font-weight: bold;">object</span><span style="color: #008000;">&#91;</span>,<span style="color: #008000;">&#93;</span> Col <span style="color: #008000;">=</span> orgCol<span style="color: #008000;">.</span><span style="color: #0000FF;">GetData</span><span style="color: #008000;">&#40;</span><span style="color: #FF0000;">0</span>, <span style="color: #000000;">System</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Type</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Missing</span>, Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">ARRAYDATAFORMAT</span><span style="color: #008000;">.</span><span style="color: #0000FF;">ARRAY2D_ORIGIN_TEXT_FULL_PRECESSION</span><span style="color: #008000;">&#41;</span> <span style="color: #0600FF; font-weight: bold;">as</span> <span style="color: #6666cc; font-weight: bold;">object</span><span style="color: #008000;">&#91;</span>,<span style="color: #008000;">&#93;</span><span style="color: #008000;">;</span>
                Colsize <span style="color: #008000;">=</span> Col<span style="color: #008000;">.</span><span style="color: #0000FF;">GetUpperBound</span><span style="color: #008000;">&#40;</span><span style="color: #FF0000;">1</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
                textBox<span style="color: #008000;">.</span><span style="color: #0000FF;">Text</span> <span style="color: #008000;">=</span> textBox<span style="color: #008000;">.</span><span style="color: #0000FF;">Text</span> <span style="color: #008000;">+</span> <span style="color: #666666;">&quot;---Col(&quot;</span> <span style="color: #008000;">+</span> <span style="color: #008000;">&#40;</span>kk <span style="color: #008000;">+</span> <span style="color: #FF0000;">1</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">.</span><span style="color: #0000FF;">ToString</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">+</span> <span style="color: #666666;">&quot;), Size=&quot;</span> <span style="color: #008000;">+</span> Colsize<span style="color: #008000;">.</span><span style="color: #0000FF;">ToString</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">+</span> <span style="color: #666666;">&quot;, DataFormat=&quot;</span> <span style="color: #008000;">+</span> orgCol<span style="color: #008000;">.</span><span style="color: #0000FF;">DataFormat</span><span style="color: #008000;">.</span><span style="color: #0000FF;">ToString</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">+</span> <span style="color: #666666;">&quot;<span style="color: #008080; font-weight: bold;">\r</span><span style="color: #008080; font-weight: bold;">\n</span>&quot;</span><span style="color: #008000;">;</span>
                textBox<span style="color: #008000;">.</span><span style="color: #0000FF;">Text</span> <span style="color: #008000;">=</span> textBox<span style="color: #008000;">.</span><span style="color: #0000FF;">Text</span> <span style="color: #008000;">+</span> <span style="color: #666666;">&quot;   Cell[1]= &quot;</span> <span style="color: #008000;">+</span> Col<span style="color: #008000;">&#91;</span><span style="color: #FF0000;">1</span>, <span style="color: #FF0000;">1</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">.</span><span style="color: #0000FF;">ToString</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">+</span> <span style="color: #666666;">&quot;, Cell[&quot;</span> <span style="color: #008000;">+</span> Colsize<span style="color: #008000;">.</span><span style="color: #0000FF;">ToString</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">+</span> <span style="color: #666666;">&quot;]= &quot;</span> <span style="color: #008000;">+</span> Col<span style="color: #008000;">&#91;</span>Colsize, <span style="color: #FF0000;">1</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">.</span><span style="color: #0000FF;">ToString</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">+</span> <span style="color: #666666;">&quot;<span style="color: #008080; font-weight: bold;">\r</span><span style="color: #008080; font-weight: bold;">\n</span>&quot;</span><span style="color: #008000;">;</span>
            <span style="color: #008000;">&#125;</span>
        <span style="color: #008000;">&#125;</span>
    <span style="color: #008000;">&#125;</span>
<span style="color: #008000;">&#125;</span></pre>






