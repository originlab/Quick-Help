<h1 class="firstHeading">2.1.19 GetWorksheet</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Syntax"><span class="tocnumber">2</span> <span class="toctext">Syntax</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Parameters"><span class="tocnumber">3</span> <span class="toctext">Parameters</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Return"><span class="tocnumber">4</span> <span class="toctext">Return</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Remark"><span class="tocnumber">5</span> <span class="toctext">Remark</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Examples"><span class="tocnumber">6</span> <span class="toctext">Examples</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#VBA"><span class="tocnumber">6.1</span> <span class="toctext">VBA</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#C.23"><span class="tocnumber">6.2</span> <span class="toctext">C#</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Python"><span class="tocnumber">6.3</span> <span class="toctext">Python</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-10"><a href="#Version_Information"><span class="tocnumber">7</span> <span class="toctext">Version Information</span></a></li>
<li class="toclevel-1 tocsection-11"><a href="#See_Also"><span class="tocnumber">8</span> <span class="toctext">See Also</span></a></li>
</ul>
</div>

<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>The GetWorksheet method transfers data from specified Origin worksheet.
</p>
<h2><a name="Syntax"></a><span class="mw-headline">Syntax</span></h2>
<code><pre>
VB: Function GetWorksheet(Name As ByVal String, [ r1 As ByVal Object ], [ c1 As ByVal Object ], [ r2 As ByVal Object ], [ c2 As ByVal Object ], [ format As ByVal Object ] ) As Object
</pre></code>
<code><pre>
C++: _variant_t GetWorksheet(LPCSTR Name, _variant_t r1, _variant_t c1, _variant_t r2, _variant_t c2, _variant_t format )
</pre></code>
<code><pre>
C#: var GetWorksheet(string Name, var r1, var c1, var r2, var c2, var format )
</pre></code>
<h2><a name="Parameters"></a><span class="mw-headline">Parameters</span></h2>
<dl><dt> Name</dt>
<dd> Name of Origin worksheet containing data.</dd>
<dt> r1</dt>
<dd> Starting (zero based) row index to get data from. This is optional argument, defaults to 0.</dd>
<dt> c1</dt>
<dd> Starting (zero based) column index to get data from. This is optional argument, defaults to 0.</dd>
<dt> r2</dt>
<dd> Ending (zero based) row index to get data from. This is optional argument, defaults to -1 (to the rest of worksheet).</dd>
<dt> c2</dt>
<dd> Ending (zero based) column index to get data from. This is optional argument, defaults to -1 (to the rest of worksheet).</dd>
<dt> format</dt>
<dd> one of the <a href="../../AutomationServer/OriginCOM/ARRAYDATAFORMAT.html" title="OriginCOM:ARRAYDATAFORMAT">ARRAYDATAFORMAT</a> enumeration, please use only the 2D ones. For example ARRAY2D_NUMERIC.</dd></dl>
<h2><a name="Return"></a><span class="mw-headline">Return</span></h2>
<p>Array as a variant. Actual array type is dependent on the format argument.
</p>
<h2><a name="Remark"></a><span class="mw-headline">Remark</span></h2>
<p>The Worksheet level GetData and the Application level GetWorksheet are going through the same code. This method is slower than the Column object GetData but it has the flexibility of getting a block of data from multiple columns.
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<h3><a name="VBA"></a><span class="mw-headline">VBA</span></h3>
<pre class="vb" style="font-family:monospace;"><span style="color: #E56717; font-weight: bold;">Public</span> <span style="color: #E56717; font-weight: bold;">Sub</span> GetWorksheet()
    <span style="color: #151B8D; font-weight: bold;">Dim</span> app <span style="color: #151B8D; font-weight: bold;">As</span> Origin.ApplicationSI
    <span style="color: #151B8D; font-weight: bold;">Dim</span> data <span style="color: #151B8D; font-weight: bold;">As</span> <span style="color: #F660AB; font-weight: bold;">Variant</span>

    <span style="color: #151B8D; font-weight: bold;">Set</span> app = <span style="color: #E56717; font-weight: bold;">New</span> Origin.ApplicationSI
    
    data = app.GetWorksheet(<span style="color: #800000;">&quot;[Book1]Sheet1&quot;</span>, 0, 0, -1, -1, ARRAY2D_VARIANT)
    <span style="color: #8D38C9; font-weight: bold;">If</span> data <span style="color: #8D38C9; font-weight: bold;">Is</span> <span style="color: #00C2FF; font-weight: bold;">Nothing</span> <span style="color: #8D38C9; font-weight: bold;">Then</span>
        MsgBox (<span style="color: #800000;">&quot;Failed to get worksheet&quot;</span>)
    <span style="color: #8D38C9; font-weight: bold;">Else</span>
        MsgBox (<span style="color: #800000;">&quot;get worksheet successfully&quot;</span>)
        Range(<span style="color: #800000;">&quot;A1&quot;</span>) = data(0, 0)
    <span style="color: #8D38C9; font-weight: bold;">End</span> <span style="color: #8D38C9; font-weight: bold;">If</span>

<span style="color: #8D38C9; font-weight: bold;">End</span> <span style="color: #E56717; font-weight: bold;">Sub</span></pre>
<h3><a name="C.23"></a><span class="mw-headline">C#</span></h3>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #6666cc; font-weight: bold;">void</span> GetWorksheet<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>
<span style="color: #008000;">&#123;</span>
    Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">ApplicationSI</span> app <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">ApplicationSI</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>

    <span style="color: #6666cc; font-weight: bold;">object</span> wksdata <span style="color: #008000;">=</span> app<span style="color: #008000;">.</span><span style="color: #0000FF;">GetWorksheet</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;[Book1]Sheet1&quot;</span>, <span style="color: #FF0000;">0</span>, <span style="color: #FF0000;">0</span>, <span style="color: #FF0000;">3</span>, <span style="color: #FF0000;">5</span>, ARRAYDATAFORMAT<span style="color: #008000;">.</span><span style="color: #0000FF;">ARRAY2D_VARIANT</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    <span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span>wksdata <span style="color: #008000;">==</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">&#41;</span>
    <span style="color: #008000;">&#123;</span>
        Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;Failed to get worksheet&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    <span style="color: #008000;">&#125;</span>
    <span style="color: #0600FF; font-weight: bold;">else</span>
    <span style="color: #008000;">&#123;</span>
        Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;get worksheet successfully<span style="color: #008080; font-weight: bold;">\n</span>&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>

        <span style="color: #008080; font-style: italic;">// You can cast wksdata as double[,] or byte[,] etc. for the data array of different types</span>
        <span style="color: #6666cc; font-weight: bold;">object</span><span style="color: #008000;">&#91;</span>,<span style="color: #008000;">&#93;</span> data <span style="color: #008000;">=</span> wksdata <span style="color: #0600FF; font-weight: bold;">as</span> <span style="color: #6666cc; font-weight: bold;">object</span><span style="color: #008000;">&#91;</span>,<span style="color: #008000;">&#93;</span><span style="color: #008000;">;</span>

        Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;data[1,1]=&quot;</span> <span style="color: #008000;">+</span> data<span style="color: #008000;">&#91;</span><span style="color: #FF0000;">1</span>,<span style="color: #FF0000;">1</span><span style="color: #008000;">&#93;</span> <span style="color: #008000;">+</span> <span style="color: #666666;">&quot;<span style="color: #008080; font-weight: bold;">\n</span>&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    <span style="color: #008000;">&#125;</span>
    Console<span style="color: #008000;">.</span><span style="color: #0000FF;">ReadLine</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>

<span style="color: #008000;">&#125;</span></pre>
<h3><a name="Python"></a><span class="mw-headline">Python</span></h3>
<pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">import</span> OriginExt <span style="color: #ff7700;font-weight:bold;">as</span> O
app <span style="color: #000;">=</span> O.<span style="color: #000;">Application</span><span style="color: #000;">&#40;</span><span style="color: #000;">&#41;</span><span style="color: #000;">;</span> app.<span style="color: #000;">Visible</span> <span style="color: #000;">=</span> app.<span style="color: #000;">MAINWND_SHOW</span>
pageName <span style="color: #000;">=</span> app.<span style="color: #000;">CreatePage</span><span style="color: #000;">&#40;</span>app.<span style="color: #000;">OPT_WORKSHEET</span><span style="color: #000;">&#41;</span>
testData <span style="color: #000;">=</span> <span style="color: #000;">&#91;</span><span style="color: #000;">&#91;</span><span style="color: #000;">5</span><span style="color: #000;">,</span><span style="color: #000;">87</span><span style="color: #000;">,</span><span style="color: #000;">90</span><span style="color: #000;">&#93;</span><span style="color: #000;">,</span> <span style="color: #000;">&#91;</span><span style="color: #000;">3.14</span><span style="color: #000;">,</span> <span style="color: #000;">24.6</span><span style="color: #000;">,</span> <span style="color: #000;">68.09</span><span style="color: #000;">&#93;</span><span style="color: #000;">&#93;</span>
app.<span style="color: #000;">PutWorksheet</span><span style="color: #000;">&#40;</span>pageName<span style="color: #000;">,</span> testData<span style="color: #000;">&#41;</span>
outputData <span style="color: #000;">=</span> app.<span style="color: #000;">GetWorksheet</span><span style="color: #000;">&#40;</span>pageName<span style="color: #000;">&#41;</span>
<span style="color: #ff7700;font-weight:bold;">print</span><span style="color: #000;">&#40;</span>outputData<span style="color: #000;">&#41;</span></pre>
<h2><a name="Version_Information"></a><span class="mw-headline">Version Information</span></h2>
<p>8.0SR2
</p>
<h2><a name="See_Also"></a><span class="mw-headline">See Also</span></h2>
<p><a href="../../AutomationServer/OriginCOM/Application-PutWorksheet.html" title="OriginCOM:Application-PutWorksheet">PutWorksheet</a> | <a href="../../AutomationServer/OriginCOM/Worksheet-SetData.html" title="OriginCOM:Worksheet-SetData">Worksheet.SetData</a> | <a href="../../AutomationServer/OriginCOM/Worksheet-GetData.html" title="OriginCOM:Worksheet-GetData">Worksheet.GetData</a> 
| <a href="../../AutomationServer/OriginCOM/Column-SetData.html" title="OriginCOM:Column-SetData">Column.SetData</a> | <a href="../../AutomationServer/OriginCOM/Column-GetData.html" title="OriginCOM:Column-GetData">Column.GetData</a>
</p>





