<h1 class="firstHeading">1.4.2 Saving Instrument Data to Worksheet</h1><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Sending_Instrument_Data_to_Origin"><span class="tocnumber">1</span> <span class="toctext">Sending Instrument Data to Origin</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Appending_Data_to_XYY_Worksheet"><span class="tocnumber">1.1</span> <span class="toctext">Appending Data to XYY Worksheet</span></a>
<ul>
<li class="toclevel-3 tocsection-3"><a href="#C.23_Example"><span class="tocnumber">1.1.1</span> <span class="toctext">C# Example</span></a></li>
<li class="toclevel-3 tocsection-4"><a href="#VB_Example"><span class="tocnumber">1.1.2</span> <span class="toctext">VB Example</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="#Y_Columns_with_Sampling_Intervals"><span class="tocnumber">2</span> <span class="toctext">Y Columns with Sampling Intervals</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#C.23_Example_2"><span class="tocnumber">2.1</span> <span class="toctext">C# Example</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#VBA_Example"><span class="tocnumber">2.2</span> <span class="toctext">VBA Example</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="Sending_Instrument_Data_to_Origin"></a><span class="mw-headline">Sending Instrument Data to Origin</span></h2>
<h3><a name="Appending_Data_to_XYY_Worksheet"></a><span class="mw-headline">Appending Data to XYY Worksheet</span></h3>
<h4><a name="C.23_Example"></a><span class="mw-headline">C# Example</span></h4>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #0600FF; font-weight: bold;">partial</span> <span style="color: #6666cc; font-weight: bold;">class</span> Form1 <span style="color: #008000;">:</span> Form
<span style="color: #008000;">&#123;</span>
    <span style="color: #6666cc; font-weight: bold;">object</span> <span style="color: #0600FF; font-weight: bold;">Default</span> <span style="color: #008000;">=</span> <span style="color: #000000;">System</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Type</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Missing</span><span style="color: #008000;">;</span>
    Column colx, coly1, coly2<span style="color: #008000;">;</span>
    Random random <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> Random<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    <span style="color: #6666cc; font-weight: bold;">double</span><span style="color: #008000;">&#91;</span><span style="color: #008000;">&#93;</span> xx <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> <span style="color: #6666cc; font-weight: bold;">double</span><span style="color: #008000;">&#91;</span><span style="color: #FF0000;">1</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">;</span>
    <span style="color: #6666cc; font-weight: bold;">double</span><span style="color: #008000;">&#91;</span><span style="color: #008000;">&#93;</span> yy1 <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> <span style="color: #6666cc; font-weight: bold;">double</span><span style="color: #008000;">&#91;</span><span style="color: #FF0000;">1</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">;</span>
    <span style="color: #6666cc; font-weight: bold;">double</span><span style="color: #008000;">&#91;</span><span style="color: #008000;">&#93;</span> yy2 <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> <span style="color: #6666cc; font-weight: bold;">double</span><span style="color: #008000;">&#91;</span><span style="color: #FF0000;">1</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">;</span>

    <span style="color: #0600FF; font-weight: bold;">public</span> Form1<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>
    <span style="color: #008000;">&#123;</span>
        InitializeComponent<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    <span style="color: #008000;">&#125;</span>
    <span style="color: #0600FF; font-weight: bold;">private</span> <span style="color: #6666cc; font-weight: bold;">void</span> ConnectOrigin_Click<span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">object</span> sender, EventArgs e<span style="color: #008000;">&#41;</span>
    <span style="color: #008000;">&#123;</span>
        Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">ApplicationSI</span> app <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">ApplicationSI</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
        app<span style="color: #008000;">.</span><span style="color: #0000FF;">NewProject</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
        WorksheetPage wbk <span style="color: #008000;">=</span> app<span style="color: #008000;">.</span><span style="color: #0000FF;">WorksheetPages</span><span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span><span style="color: #008000;">&#40;</span><span style="color: #0600FF; font-weight: bold;">Default</span>, <span style="color: #0600FF; font-weight: bold;">Default</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
        Worksheet wks <span style="color: #008000;">=</span> wbk<span style="color: #008000;">.</span><span style="color: #0000FF;">Layers</span><span style="color: #008000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #008000;">&#93;</span> <span style="color: #0600FF; font-weight: bold;">as</span> Worksheet<span style="color: #008000;">;</span>
        colx <span style="color: #008000;">=</span> wks<span style="color: #008000;">.</span><span style="color: #0000FF;">Columns</span><span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span><span style="color: #008000;">&#40;</span><span style="color: #0600FF; font-weight: bold;">Default</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
        coly1 <span style="color: #008000;">=</span> wks<span style="color: #008000;">.</span><span style="color: #0000FF;">Columns</span><span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span><span style="color: #008000;">&#40;</span><span style="color: #0600FF; font-weight: bold;">Default</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
        coly2 <span style="color: #008000;">=</span> wks<span style="color: #008000;">.</span><span style="color: #0000FF;">Columns</span><span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span><span style="color: #008000;">&#40;</span><span style="color: #0600FF; font-weight: bold;">Default</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>

        colx<span style="color: #008000;">.</span><span style="color: #0000FF;">DataFormat</span> <span style="color: #008000;">=</span> COLDATAFORMAT<span style="color: #008000;">.</span><span style="color: #0000FF;">DF_DATE</span><span style="color: #008000;">;</span>
        colx<span style="color: #008000;">.</span><span style="color: #0000FF;">DisplayFormat</span> <span style="color: #008000;">=</span> <span style="color: #FF0000;">10</span><span style="color: #008000;">;</span>
    <span style="color: #008000;">&#125;</span>
    <span style="color: #0600FF; font-weight: bold;">private</span> <span style="color: #6666cc; font-weight: bold;">void</span> AddItem_Click<span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">object</span> sender, EventArgs e<span style="color: #008000;">&#41;</span>
    <span style="color: #008000;">&#123;</span>
        xx<span style="color: #008000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #008000;">&#93;</span> <span style="color: #008000;">=</span> Date2Julian<span style="color: #008000;">&#40;</span>DateTime<span style="color: #008000;">.</span><span style="color: #0000FF;">Now</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
        yy1<span style="color: #008000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #008000;">&#93;</span> <span style="color: #008000;">=</span> random<span style="color: #008000;">.</span><span style="color: #0000FF;">Next</span><span style="color: #008000;">&#40;</span><span style="color: #FF0000;">1000</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
        yy2<span style="color: #008000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #008000;">&#93;</span> <span style="color: #008000;">=</span> <span style="color: #FF0000;">1000</span> <span style="color: #008000;">+</span> random<span style="color: #008000;">.</span><span style="color: #0000FF;">Next</span><span style="color: #008000;">&#40;</span><span style="color: #FF0000;">1000</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>

        colx<span style="color: #008000;">.</span><span style="color: #0000FF;">SetData</span><span style="color: #008000;">&#40;</span>xx, <span style="color: #008000;">-</span><span style="color: #FF0000;">1</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
        coly1<span style="color: #008000;">.</span><span style="color: #0000FF;">SetData</span><span style="color: #008000;">&#40;</span>yy1, <span style="color: #008000;">-</span><span style="color: #FF0000;">1</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
        coly2<span style="color: #008000;">.</span><span style="color: #0000FF;">SetData</span><span style="color: #008000;">&#40;</span>yy2, <span style="color: #008000;">-</span><span style="color: #FF0000;">1</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    <span style="color: #008000;">&#125;</span>
    <span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">double</span> Date2Julian<span style="color: #008000;">&#40;</span>DateTime vDate<span style="color: #008000;">&#41;</span>
    <span style="color: #008000;">&#123;</span>
        <span style="color: #6666cc; font-weight: bold;">double</span> JDN <span style="color: #008000;">=</span> vDate<span style="color: #008000;">.</span><span style="color: #0000FF;">Date</span><span style="color: #008000;">.</span><span style="color: #0000FF;">ToOADate</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">+</span> <span style="color: #FF0000;">2415019</span> <span style="color: #008000;">+</span> <span style="color: #008000;">&#40;</span>vDate<span style="color: #008000;">.</span><span style="color: #0000FF;">Hour</span> <span style="color: #008000;">-</span> <span style="color: #FF0000;">12</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">/</span> <span style="color: #FF0000;">24.0</span> <span style="color: #008000;">+</span> vDate<span style="color: #008000;">.</span><span style="color: #0000FF;">Minute</span> <span style="color: #008000;">/</span> <span style="color: #FF0000;">1440.0</span> <span style="color: #008000;">+</span> vDate<span style="color: #008000;">.</span><span style="color: #0000FF;">Second</span> <span style="color: #008000;">/</span> <span style="color: #FF0000;">86400.0</span><span style="color: #008000;">;</span>
        <span style="color: #0600FF; font-weight: bold;">return</span> JDN<span style="color: #008000;">;</span>
    <span style="color: #008000;">&#125;</span>
<span style="color: #008000;">&#125;</span></pre>
<h4><a name="VB_Example"></a><span class="mw-headline">VB Example</span></h4>
<pre class="vb" style="font-family:monospace;">Const NUMPTS = 100
    <span style="color: #151B8D; font-weight: bold;">Dim</span> app <span style="color: #151B8D; font-weight: bold;">As</span> Origin.Application
    <span style="color: #151B8D; font-weight: bold;">Dim</span> wbk <span style="color: #151B8D; font-weight: bold;">As</span> Origin.WorksheetPage
    <span style="color: #151B8D; font-weight: bold;">Dim</span> Wks <span style="color: #151B8D; font-weight: bold;">As</span> Origin.Worksheet
    <span style="color: #151B8D; font-weight: bold;">Dim</span> colx, coly1, coly2 <span style="color: #151B8D; font-weight: bold;">As</span> Origin.Column
    <span style="color: #151B8D; font-weight: bold;">Dim</span> ii <span style="color: #151B8D; font-weight: bold;">As</span> <span style="color: #F660AB; font-weight: bold;">Integer</span>
    <span style="color: #151B8D; font-weight: bold;">Dim</span> xx(0) <span style="color: #151B8D; font-weight: bold;">As</span> <span style="color: #F660AB; font-weight: bold;">Double</span>
    <span style="color: #151B8D; font-weight: bold;">Dim</span> yy1(0) <span style="color: #151B8D; font-weight: bold;">As</span> <span style="color: #F660AB; font-weight: bold;">Double</span>
    <span style="color: #151B8D; font-weight: bold;">Dim</span> yy2(0) <span style="color: #151B8D; font-weight: bold;">As</span> <span style="color: #F660AB; font-weight: bold;">Double</span>
    <span style="color: #151B8D; font-weight: bold;">Dim</span> data <span style="color: #151B8D; font-weight: bold;">As</span> <span style="color: #F660AB; font-weight: bold;">Variant</span>

<span style="color: #E56717; font-weight: bold;">Private</span> <span style="color: #E56717; font-weight: bold;">Sub</span> ConnectOrigin_Click()
    <span style="color: #151B8D; font-weight: bold;">Set</span> app = <span style="color: #E56717; font-weight: bold;">New</span> Origin.ApplicationSI
    app.NewProject
    <span style="color: #151B8D; font-weight: bold;">Set</span> wbk = app.WorksheetPages.Add
    <span style="color: #151B8D; font-weight: bold;">Set</span> Wks = wbk.Layers(0)
    <span style="color: #151B8D; font-weight: bold;">Set</span> colx = Wks.Columns.Add
    <span style="color: #151B8D; font-weight: bold;">Set</span> coly1 = Wks.Columns.Add
    <span style="color: #151B8D; font-weight: bold;">Set</span> coly2 = Wks.Columns.Add
    
    colx.<span style="color: #151B8D; font-weight: bold;">Type</span> = COLTYPE_X
    colx.DataFormat = DF_DATE
    colx.DisplayFormat = 10
    
<span style="color: #8D38C9; font-weight: bold;">End</span> <span style="color: #E56717; font-weight: bold;">Sub</span>

<span style="color: #E56717; font-weight: bold;">Private</span> <span style="color: #E56717; font-weight: bold;">Sub</span> AddItem_Click()
    xx(0) = Date2Julian(DateTime.<span style="color: #F660AB; font-weight: bold;">Date</span>, DateTime.Time)
    yy1(0) = Rnd(1000)
    yy2(0) = 1 + Rnd(1000)
    ii = colx.SetData(xx, -1)
    ii = coly1.SetData(yy1, -1)
    ii = coly2.SetData(yy2, -1)

<span style="color: #8D38C9; font-weight: bold;">End</span> <span style="color: #E56717; font-weight: bold;">Sub</span>

<span style="color: #E56717; font-weight: bold;">Public</span> <span style="color: #E56717; font-weight: bold;">Function</span> Date2Julian(<span style="color: #151B8D; font-weight: bold;">ByVal</span> vDate <span style="color: #151B8D; font-weight: bold;">As</span> <span style="color: #F660AB; font-weight: bold;">Variant</span>, <span style="color: #151B8D; font-weight: bold;">ByVal</span> vTime <span style="color: #151B8D; font-weight: bold;">As</span> <span style="color: #F660AB; font-weight: bold;">Variant</span>) <span style="color: #151B8D; font-weight: bold;">As</span> <span style="color: #F660AB; font-weight: bold;">Double</span>

    <span style="color: #151B8D; font-weight: bold;">Dim</span> DateDiff <span style="color: #151B8D; font-weight: bold;">As</span> <span style="color: #F660AB; font-weight: bold;">Double</span>
    DateDiff = DateTime.DateDiff(<span style="color: #800000;">&quot;d&quot;</span>, #12/31/1899#, vDate)
    Date2Julian = DateDiff + 2415019 + (hour(vTime) - 12) / 24 + minute(vTime) / 1440 + second(vTime) / 86400

<span style="color: #8D38C9; font-weight: bold;">End</span> <span style="color: #E56717; font-weight: bold;">Function</span></pre>
<h2><a name="Y_Columns_with_Sampling_Intervals"></a><span class="mw-headline">Y Columns with Sampling Intervals</span></h2>
<h3><a name="C.23_Example_2"></a><span class="mw-headline">C# Example</span></h3>
<p>In this example we use a simple Console application to generate two columns of data with Sampling Intervales to simulate instrument data and save into an Origin worksheet. Units and Long Names of both XY data in each column is also setup.
</p>
<dl><dt>Column 1</dt>
<dd>Temperature with units in degree C, samples are taken at 0.02 sec interval. </dd>
<dt>Column 2</dt>
<dd>Presure with units in kPa, samples also taken at 0.02 sec interval</dd></dl>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #6666cc; font-weight: bold;">void</span> doTest<span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">int</span> npts<span style="color: #008000;">&#41;</span>
<span style="color: #008000;">&#123;</span>
    <span style="color: #6666cc; font-weight: bold;">object</span> <span style="color: #0600FF; font-weight: bold;">Default</span> <span style="color: #008000;">=</span> <span style="color: #000000;">System</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Type</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Missing</span><span style="color: #008000;">;</span>
    <span style="color: #6666cc; font-weight: bold;">double</span><span style="color: #008000;">&#91;</span><span style="color: #008000;">&#93;</span> temp <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> <span style="color: #6666cc; font-weight: bold;">double</span><span style="color: #008000;">&#91;</span>npts<span style="color: #008000;">&#93;</span><span style="color: #008000;">;</span>
    <span style="color: #6666cc; font-weight: bold;">double</span><span style="color: #008000;">&#91;</span><span style="color: #008000;">&#93;</span> pres <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> <span style="color: #6666cc; font-weight: bold;">double</span><span style="color: #008000;">&#91;</span>npts<span style="color: #008000;">&#93;</span><span style="color: #008000;">;</span>
    <span style="color: #0600FF; font-weight: bold;">for</span> <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">int</span> ii <span style="color: #008000;">=</span> <span style="color: #FF0000;">0</span><span style="color: #008000;">;</span> ii <span style="color: #008000;">&lt;</span> npts<span style="color: #008000;">;</span> ii<span style="color: #008000;">++</span><span style="color: #008000;">&#41;</span>
    <span style="color: #008000;">&#123;</span>
        temp<span style="color: #008000;">&#91;</span>ii<span style="color: #008000;">&#93;</span> <span style="color: #008000;">=</span> ii <span style="color: #008000;">*</span> <span style="color: #FF0000;">0.1</span><span style="color: #008000;">;</span>
        pres<span style="color: #008000;">&#91;</span>ii<span style="color: #008000;">&#93;</span> <span style="color: #008000;">=</span> ii <span style="color: #008000;">*</span> <span style="color: #FF0000;">0.000831</span> <span style="color: #008000;">+</span> <span style="color: #FF0000;">2.3</span><span style="color: #008000;">;</span>
    <span style="color: #008000;">&#125;</span>

    Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">ApplicationSI</span> app <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">ApplicationSI</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    app<span style="color: #008000;">.</span><span style="color: #0000FF;">NewProject</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    WorksheetPage wbk <span style="color: #008000;">=</span> app<span style="color: #008000;">.</span><span style="color: #0000FF;">WorksheetPages</span><span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span><span style="color: #008000;">&#40;</span><span style="color: #0600FF; font-weight: bold;">Default</span>, <span style="color: #0600FF; font-weight: bold;">Default</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    Worksheet wks <span style="color: #008000;">=</span> wbk<span style="color: #008000;">.</span><span style="color: #0000FF;">Layers</span><span style="color: #008000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #008000;">&#93;</span> <span style="color: #0600FF; font-weight: bold;">as</span> Worksheet<span style="color: #008000;">;</span>
    Column colt <span style="color: #008000;">=</span> wks<span style="color: #008000;">.</span><span style="color: #0000FF;">Columns</span><span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span><span style="color: #008000;">&#40;</span><span style="color: #0600FF; font-weight: bold;">Default</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    Column colp <span style="color: #008000;">=</span> wks<span style="color: #008000;">.</span><span style="color: #0000FF;">Columns</span><span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span><span style="color: #008000;">&#40;</span><span style="color: #0600FF; font-weight: bold;">Default</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>

    wks<span style="color: #008000;">.</span><span style="color: #0000FF;">set_IsLabelVisible</span><span style="color: #008000;">&#40;</span>LABELTYPEVALS<span style="color: #008000;">.</span><span style="color: #0000FF;">LT_LONG_NAME</span>, <span style="color: #0600FF; font-weight: bold;">Default</span>, <span style="color: #0600FF; font-weight: bold;">true</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    wks<span style="color: #008000;">.</span><span style="color: #0000FF;">set_IsLabelVisible</span><span style="color: #008000;">&#40;</span>LABELTYPEVALS<span style="color: #008000;">.</span><span style="color: #0000FF;">LT_UNIT</span>, <span style="color: #0600FF; font-weight: bold;">Default</span>, <span style="color: #0600FF; font-weight: bold;">true</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    colt<span style="color: #008000;">.</span><span style="color: #0000FF;">Type</span> <span style="color: #008000;">=</span> COLTYPES<span style="color: #008000;">.</span><span style="color: #0000FF;">COLTYPE_Y</span><span style="color: #008000;">;</span>
    colp<span style="color: #008000;">.</span><span style="color: #0000FF;">Type</span> <span style="color: #008000;">=</span> COLTYPES<span style="color: #008000;">.</span><span style="color: #0000FF;">COLTYPE_Y</span><span style="color: #008000;">;</span>
    colt<span style="color: #008000;">.</span><span style="color: #0000FF;">LongName</span> <span style="color: #008000;">=</span> <span style="color: #666666;">&quot;Temperature&quot;</span><span style="color: #008000;">;</span>
    colt<span style="color: #008000;">.</span><span style="color: #0000FF;">Units</span> <span style="color: #008000;">=</span> <span style="color: #666666;">&quot;degree C&quot;</span><span style="color: #008000;">;</span>
    colp<span style="color: #008000;">.</span><span style="color: #0000FF;">LongName</span> <span style="color: #008000;">=</span> <span style="color: #666666;">&quot;Pressure&quot;</span><span style="color: #008000;">;</span>
    colp<span style="color: #008000;">.</span><span style="color: #0000FF;">Units</span> <span style="color: #008000;">=</span> <span style="color: #666666;">&quot;kPa&quot;</span><span style="color: #008000;">;</span>

    colt<span style="color: #008000;">.</span><span style="color: #0000FF;">SetEvenSampling</span><span style="color: #008000;">&#40;</span><span style="color: #FF0000;">0</span>, <span style="color: #FF0000;">20</span>, <span style="color: #666666;">&quot;ms&quot;</span>, <span style="color: #666666;">&quot;Time&quot;</span>, <span style="color: #0600FF; font-weight: bold;">Default</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    colp<span style="color: #008000;">.</span><span style="color: #0000FF;">SetEvenSampling</span><span style="color: #008000;">&#40;</span><span style="color: #FF0000;">0</span>, <span style="color: #FF0000;">30</span>, <span style="color: #666666;">&quot;ms&quot;</span>, <span style="color: #666666;">&quot;Time&quot;</span>, <span style="color: #0600FF; font-weight: bold;">Default</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>

    colt<span style="color: #008000;">.</span><span style="color: #0000FF;">SetData</span><span style="color: #008000;">&#40;</span>temp, <span style="color: #FF0000;">0</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    colp<span style="color: #008000;">.</span><span style="color: #0000FF;">SetData</span><span style="color: #008000;">&#40;</span>pres, <span style="color: #FF0000;">0</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
<span style="color: #008000;">&#125;</span></pre>
<h3><a name="VBA_Example"></a><span class="mw-headline">VBA Example</span></h3>
<pre class="vb" style="font-family:monospace;"><span style="color: #E56717; font-weight: bold;">Option</span> <span style="color: #E56717; font-weight: bold;">Explicit</span>

Const npts = 100
<span style="color: #E56717; font-weight: bold;">Public</span> <span style="color: #E56717; font-weight: bold;">Sub</span> doTest()

    <span style="color: #151B8D; font-weight: bold;">Dim</span> temp(npts), pres(npts) <span style="color: #151B8D; font-weight: bold;">As</span> <span style="color: #F660AB; font-weight: bold;">Double</span>
    <span style="color: #151B8D; font-weight: bold;">Dim</span> a <span style="color: #151B8D; font-weight: bold;">As</span> <span style="color: #F660AB; font-weight: bold;">Variant</span>
    <span style="color: #151B8D; font-weight: bold;">Dim</span> ii <span style="color: #151B8D; font-weight: bold;">As</span> <span style="color: #F660AB; font-weight: bold;">Integer</span>
    
    <span style="color: #151B8D; font-weight: bold;">Dim</span> app <span style="color: #151B8D; font-weight: bold;">As</span> Origin.Application
    <span style="color: #151B8D; font-weight: bold;">Dim</span> wbk <span style="color: #151B8D; font-weight: bold;">As</span> Origin.WorksheetPage
    <span style="color: #151B8D; font-weight: bold;">Dim</span> wks <span style="color: #151B8D; font-weight: bold;">As</span> Origin.Worksheet
    <span style="color: #151B8D; font-weight: bold;">Dim</span> colt <span style="color: #151B8D; font-weight: bold;">As</span> Origin.Column
    <span style="color: #151B8D; font-weight: bold;">Dim</span> colp <span style="color: #151B8D; font-weight: bold;">As</span> Origin.Column

    <span style="color: #8D38C9; font-weight: bold;">For</span> ii = 0 <span style="color: #8D38C9; font-weight: bold;">To</span> npts
        temp(ii) = 0.1 * ii
        pres(ii) = ii * 0.000831 + 2.3
    <span style="color: #8D38C9; font-weight: bold;">Next</span> ii

    <span style="color: #151B8D; font-weight: bold;">Set</span> app = <span style="color: #E56717; font-weight: bold;">New</span> Origin.ApplicationSI
    app.NewProject
    <span style="color: #151B8D; font-weight: bold;">Set</span> wbk = app.WorksheetPages.Add
    <span style="color: #151B8D; font-weight: bold;">Set</span> wks = wbk.Layers(0)
    <span style="color: #151B8D; font-weight: bold;">Set</span> colt = wks.Columns.Add
    <span style="color: #151B8D; font-weight: bold;">Set</span> colp = wks.Columns.Add
    
    wks.IsLabelVisible (LT_LONG_NAME) = <span style="color: #00C2FF; font-weight: bold;">true</span>
    wks.IsLabelVisible (LT_UNIT) = <span style="color: #00C2FF; font-weight: bold;">true</span>
    colt.<span style="color: #151B8D; font-weight: bold;">Type</span> = COLTYPE_Y
    colp.<span style="color: #151B8D; font-weight: bold;">Type</span> = COLTYPE_Y
    colt.LongName = <span style="color: #800000;">&quot;Temperature&quot;</span>
    colt.Units = <span style="color: #800000;">&quot;degree C&quot;</span>
    colp.LongName = <span style="color: #800000;">&quot;Pressure&quot;</span>
    colp.Units = <span style="color: #800000;">&quot;kPa&quot;</span>
    
    a = colt.SetEvenSampling(0, 20, <span style="color: #800000;">&quot;ms&quot;</span>, <span style="color: #800000;">&quot;Time&quot;</span>)
    a = colp.SetEvenSampling(0, 30, <span style="color: #800000;">&quot;ms&quot;</span>, <span style="color: #800000;">&quot;Time&quot;</span>)

    a = colt.SetData(temp)
    a = colp.SetData(pres)

<span style="color: #8D38C9; font-weight: bold;">End</span> <span style="color: #E56717; font-weight: bold;">Sub</span></pre>






