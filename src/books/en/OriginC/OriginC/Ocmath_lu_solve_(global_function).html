<h1 class="firstHeading">2.1.17.6.4 ocmath_lu_solve</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Syntax"><span class="tocnumber">2</span> <span class="toctext">Syntax</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Parameters"><span class="tocnumber">3</span> <span class="toctext">Parameters</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Return"><span class="tocnumber">4</span> <span class="toctext">Return</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Examples"><span class="tocnumber">5</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Remark"><span class="tocnumber">6</span> <span class="toctext">Remark</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#See_Also"><span class="tocnumber">7</span> <span class="toctext">See Also</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Header_to_Include"><span class="tocnumber">8</span> <span class="toctext">Header to Include</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Reference"><span class="tocnumber">9</span> <span class="toctext">Reference</span></a></li>
</ul>
</div>

<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>Solves a real system of linear equations with multiple right-hand sides.
</p>
<h2><a name="Syntax"></a><span class="mw-headline">Syntax</span></h2>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">int</span> ocmath_lu_solve<span style="color: #000000;">&#40;</span> <span style="color: #0000ff;">double</span> <span style="color: #000040;">*</span> pA, <span style="color: #0000ff;">double</span> <span style="color: #000040;">*</span> pB, <span style="color: #0000ff;">long</span> <span style="color: #000040;">*</span> pIpiv, <span style="color: #0000ff;">int</span> n, <span style="color: #0000ff;">int</span> nRhs <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span> <span style="color: #000000;">&#41;</span></pre>
<h2><a name="Parameters"></a><span class="mw-headline">Parameters</span></h2>
<dl><dt> pA</dt>
<dd>[modify](input)pointer to matrix A, of size n by n</dd>
<dd>(output)overwritten by the factors L and U; the unit diagonal elements of</dd>
<dd>L are not stored.</dd>
<dt> pB</dt>
<dd>[modify](input)pointer to right-hand side matrix B, of size n by r</dd>
<dd>(output)pointer to n by r solution matrix</dd>
<dt> pIpiv</dt>
<dd>[output]pointer to the pivot indices of size n by 1. Row i of the original</dd>
<dd>matrix is interchanged	with row mIpiv[i - 1] for i = 1,2, ..., n.</dd>
<dt> n</dt>
<dd>[input] order the matrix A</dd>
<dt> nRhs</dt>
<dd>[input] The number of right hand sides, i.e., the number of columns of the matrix B</dd></dl>
<h2><a name="Return"></a><span class="mw-headline">Return</span></h2>
<p>= OE_NOERROR:  successful exit
</p><p>= OE_INT_ARG_LT:  n or nRhs is less than 1
</p><p>= NE_SINGULAR: u(&lt;value&gt;, &lt;value&gt;) is exactly zero. The factorization has been completed but the factor U is exactly singular, and division by zero will occur if it is subsequently used to solve a system of linear equations or to invert A.
</p><p>= NE_ALLOC_FAIL: Memory allocation failed.
</p><p>= NE_BAD_PARAM: On entry, parameter had an illegal value.
</p><p>= NE_INTERNAL_ERROR: An internal error has occurred in this function. Check the function call and any array sizes. If the call is correct then please consult NAG for assistance.
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p><b>EX1</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">//Assume Matrix1 and Matrix2 contain data</span>
<span style="color: #0000ff;">void</span> ocmath_lu_solve_ex1<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    Matrix    matA<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;MBook1&quot;</span><span style="color: #000000;">&#41;</span>;
    Matrix    matB<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;MBook2&quot;</span><span style="color: #000000;">&#41;</span>;
    matrix<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">long</span><span style="color: #000080;">&gt;</span> matIPIV;
    <span style="color: #0000ff;">int</span> m <span style="color: #000080;">=</span> matB.<span style="color: #000000;">GetNumRows</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">int</span> n <span style="color: #000080;">=</span> matB.<span style="color: #000000;">GetNumCols</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    matIPIV.<span style="color: #000000;">SetSize</span><span style="color: #000000;">&#40;</span>m, <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
    ocmath_lu_solve<span style="color: #000000;">&#40;</span>matA, matB, matIPIV, m , n<span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Remark"></a><span class="mw-headline">Remark</span></h2>
<p>Solves a real system of linear equations with multiple right-hand sides, Ax = B, using LU decomposition.
</p><p>Then, the equation Ax = B can be transformed to two equations Ly = B and Ux = y. First, from solving the equation Ly = B, get y, and then from Ux = y, gain roots of the equation Ax = B.
</p>
<h2><a name="See_Also"></a><span class="mw-headline">See Also</span></h2>
<h2><a name="Header_to_Include"></a><span class="mw-headline">Header to Include</span></h2>
<p>origin.h
</p>
<h2><a name="Reference"></a><span class="mw-headline">Reference</span></h2>
<p>nag_dgetrf(f07adc)nag_dgetrf(f07adc), nag_dgetrs(f07aec)nag_dgetrf(f07adc)nag_dgetrf(f07adc), nag_dgetrs(f07aec), Nag Manual
</p>





