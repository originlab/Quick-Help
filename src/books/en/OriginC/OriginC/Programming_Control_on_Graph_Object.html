<h1 class="firstHeading">3.4.6 Programming Control on Graph Object</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Version_Info"><span class="tocnumber">1</span> <span class="toctext">Version Info</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Programming_Control_on_Line"><span class="tocnumber">2</span> <span class="toctext">Programming Control on Line</span></a></li>
</ul>
</div>

<p><br />
</p>
<h2><a name="Version_Info"></a><span class="mw-headline">Version Info</span></h2>
<p class="version" >Minimum Origin Version Required: Origin8 SR0</p>
<h2><a name="Programming_Control_on_Line"></a><span class="mw-headline">Programming Control on Line</span></h2>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">void</span> AddLine<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> gl <span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>		
		<span style="color: #008000;">// add vertical line and set position</span>
		GraphObject goVLine <span style="color: #000080;">=</span> gl.<span style="color: #000000;">CreateGraphObject</span><span style="color: #000000;">&#40;</span>GROT_LINE<span style="color: #000000;">&#41;</span>;
		goVLine.<span style="color: #000000;">SetName</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;vline&quot;</span><span style="color: #000000;">&#41;</span>;
		goVLine.<span style="color: #000000;">X</span> <span style="color: #000080;">=</span> gl.<span style="color: #000000;">X</span>.<span style="color: #000000;">From</span> <span style="color: #000040;">+</span> <span style="color: #000000;">&#40;</span>gl.<span style="color: #000000;">X</span>.<span style="color: #000000;">To</span> <span style="color: #000040;">-</span> gl.<span style="color: #000000;">X</span>.<span style="color: #000000;">From</span><span style="color: #000000;">&#41;</span> <span style="color: #000040;">/</span> <span style="color: #0000dd;">2</span>; <span style="color: #008000;">// set the init position of vertical line</span>
		
		<span style="color: #008000;">// set direction, script</span>
		string strScript <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;type -a &quot;</span> <span style="color: #000040;">+</span> <span style="color: #ff00ff;">&quot; <span style="color: #666666; font-weight: bold;">\&quot;</span>X = $(vline.X)<span style="color: #666666; font-weight: bold;">\&quot;</span> &quot;</span>; <span style="color: #008000;">// set this script, moving vertical line will print out X pos to Command window.</span>
		SetLineFormat<span style="color: #000000;">&#40;</span>goVLine, LN_VERTICAL, strScript, GRCT_MOVE<span style="color: #000000;">&#41;</span>;		
		
		
		<span style="color: #008000;">// add horizontal line and set position</span>
		GraphObject goHLine <span style="color: #000080;">=</span> gl.<span style="color: #000000;">CreateGraphObject</span><span style="color: #000000;">&#40;</span>GROT_LINE<span style="color: #000000;">&#41;</span>;
		goHLine.<span style="color: #000000;">SetName</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;hline&quot;</span><span style="color: #000000;">&#41;</span>;			
		goHLine.<span style="color: #000000;">Y</span> <span style="color: #000080;">=</span> gl.<span style="color: #000000;">Y</span>.<span style="color: #000000;">From</span> <span style="color: #000040;">+</span> <span style="color: #000000;">&#40;</span>gl.<span style="color: #000000;">Y</span>.<span style="color: #000000;">To</span> <span style="color: #000040;">-</span> gl.<span style="color: #000000;">Y</span>.<span style="color: #000000;">From</span><span style="color: #000000;">&#41;</span> <span style="color: #000040;">/</span> <span style="color: #0000dd;">2</span>;	<span style="color: #008000;">// set the init position of horizontal line</span>
		
		<span style="color: #008000;">// set direction, script</span>
		strScript <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;type -a &quot;</span> <span style="color: #000040;">+</span> <span style="color: #ff00ff;">&quot; <span style="color: #666666; font-weight: bold;">\&quot;</span>Y = $(hline.Y)<span style="color: #666666; font-weight: bold;">\&quot;</span> &quot;</span>; <span style="color: #008000;">// set this script, moving horizontal line will print out Y pos to Command window.</span>
		SetLineFormat<span style="color: #000000;">&#40;</span>goHLine, LN_HORIZONTAL, strScript, GRCT_MOVE<span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span>

<span style="color: #008000;">// set line object properties, script, format, color, width, attach mode, direction...</span>
<span style="color: #0000ff;">void</span> SetLineFormat<span style="color: #000000;">&#40;</span>GraphObject<span style="color: #000040;">&amp;</span> goLine, <span style="color: #0000ff;">int</span> nDirection, string strScript, <span style="color: #0000ff;">int</span> nExecMode<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	goLine.<span style="color: #000000;">Attach</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;<span style="color: #008000;">// 2, layer and scale</span>
	
	Tree tr;		
	tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Span</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; <span style="color: #008000;">// 1 to span over the whole layer</span>
	tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Direction</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> nDirection; <span style="color: #008000;">// vertical or horizontal	</span>
	tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Color</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> SYSCOLOR_RED;
	tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Width</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;
	tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Event</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> nExecMode;
	tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Script</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> strScript; <span style="color: #008000;">// set script, run it after the Event specified by nExecMode</span>
	
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> goLine.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">&#40;</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span> <span style="color: #008000;">// 0 means no error</span>
	<span style="color: #000000;">&#123;</span>
		<span style="color: #0000ff;">bool</span> bRet <span style="color: #000080;">=</span> goLine.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">&#40;</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// return true if applied format successfully</span>
	<span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>






