<h1 class="firstHeading">3.2.3 Worksheet Access Embedded Graphs</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Version_Info"><span class="tocnumber">1</span> <span class="toctext">Version Info</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#List_Embedded_Graphs"><span class="tocnumber">2</span> <span class="toctext">List Embedded Graphs</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Check_Graph_Page_if_Embedded"><span class="tocnumber">3</span> <span class="toctext">Check Graph Page if Embedded</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Sparklines"><span class="tocnumber">4</span> <span class="toctext">Sparklines</span></a></li>
</ul>
</div>

<h2><a name="Version_Info"></a><span class="mw-headline">Version Info</span></h2>
<p class="version" >Minimum Origin Version Required: Origin 8 SR0</p>
<h2><a name="List_Embedded_Graphs"></a><span class="mw-headline">List Embedded Graphs</span></h2>
<p>List all embedded graph pages in the active workbook, along with embedding information(Worksheet, Row, Column).
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">void</span> get_embedded_graphs<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    WorksheetPage wpg <span style="color: #000080;">=</span> Project.<span style="color: #000000;">Pages</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> wpg <span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        foreach<span style="color: #000000;">&#40;</span>Layer ly in wpg.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#41;</span>
        <span style="color: #000000;">&#123;</span>
            Worksheet wks <span style="color: #000080;">=</span> ly;
            foreach<span style="color: #000000;">&#40;</span>Page pgEmbedded in wks.<span style="color: #000000;">EmbeddedPages</span><span style="color: #000000;">&#41;</span>
            <span style="color: #000000;">&#123;</span>
                Worksheet   wksTest;
                <span style="color: #0000ff;">int</span>         nRow, nCol;
                <span style="color: #0000ff;">bool</span> bRet <span style="color: #000080;">=</span> pgEmbedded.<span style="color: #000000;">GetEmbeddingInfo</span><span style="color: #000000;">&#40;</span>wksTest, <span style="color: #000040;">&amp;</span>nRow, <span style="color: #000040;">&amp;</span>nCol<span style="color: #000000;">&#41;</span>; 
                <span style="color: #008000;">// TRUE if the object is embedded in a Datasheet, otherwise FALSE.</span>
                <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> bRet <span style="color: #000000;">&#41;</span>
                <span style="color: #000000;">&#123;</span>
                    <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;%s in [%s]%s!%s[%d:%d]<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, pgEmbedded.<span style="color: #000000;">GetName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>, wksTest.<span style="color: #000000;">GetPage</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>.<span style="color: #000000;">GetName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>, 
                    	wks.<span style="color: #000000;">GetName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>, wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">&#40;</span>nCol<span style="color: #000000;">&#41;</span>.<span style="color: #000000;">GetName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>, nRow<span style="color: #000040;">+</span><span style="color: #0000dd;">1</span>, nRow<span style="color: #000040;">+</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;      
                <span style="color: #000000;">&#125;</span>
            <span style="color: #000000;">&#125;</span>
        <span style="color: #000000;">&#125;</span>
    <span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Check_Graph_Page_if_Embedded"></a><span class="mw-headline">Check Graph Page if Embedded</span></h2>
<p><a href="../../OriginC/OriginC/PageBase-GetEmbeddingInfo.html" title="OriginC:PageBase-GetEmbeddingInfo">PageBase::GetEmbeddingInfo</a> also can used to check if page is embedded by return value like below.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">void</span> page_is_embedded<span style="color: #000000;">&#40;</span>string strGraph<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	GraphPage gp<span style="color: #000000;">&#40;</span>strGraph<span style="color: #000000;">&#41;</span>;
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #000040;">!</span>gp <span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		out_str<span style="color: #000000;">&#40;</span>strGraph <span style="color: #000040;">+</span> <span style="color: #ff00ff;">&quot; is not a valid graph&quot;</span><span style="color: #000000;">&#41;</span>;
		<span style="color: #0000ff;">return</span>;
	<span style="color: #000000;">&#125;</span>
	
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> gp.<span style="color: #000000;">GetEmbeddingInfo</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span> <span style="color: #008000;">// TRUE if the object is embedded in a Datasheet, otherwise FALSE.</span>
	<span style="color: #000000;">&#123;</span>
		out_str<span style="color: #000000;">&#40;</span>strGraph <span style="color: #000040;">+</span> <span style="color: #ff00ff;">&quot; is embedded graph&quot;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">&#125;</span>
	<span style="color: #0000ff;">else</span>
	<span style="color: #000000;">&#123;</span>
		out_str<span style="color: #000000;">&#40;</span>strGraph <span style="color: #000040;">+</span> <span style="color: #ff00ff;">&quot; is NOT embedded graph&quot;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Sparklines"></a><span class="mw-headline">Sparklines</span></h2>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// example to show how to create/update sparklines on all </span>
<span style="color: #008000;">// columns on the current worksheet with alternating blue/red colors</span>
<span style="color: #0000ff;">void</span> sparkline_colors<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	DWORD dwCntrl <span style="color: #000080;">=</span> EMBEDGRAPH_IN_LABELS <span style="color: #000040;">|</span> EMBEDGRAPH_HIDE_AXES <span style="color: #000040;">|</span> EMBEDGRAPH_HIDE_LEGENDS 
<span style="color: #000040;">|</span> EMBEDGRAPH_HIDE_SPECTRUMS <span style="color: #000040;">|</span> EMBEDGRAPH_HIDE_TEXT_OBJS <span style="color: #000040;">|</span> EMBEDGRAPH_SPARKLINE;
	Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span><span style="color: #000040;">!</span>wks<span style="color: #000000;">&#41;</span>
		<span style="color: #0000ff;">return</span>;
	
	<span style="color: #008000;">//add this will require theme_utils.c to be added to workspace</span>
	<span style="color: #008000;">//int nRowHeight = 20</span>
	<span style="color: #008000;">//wks_set_col_label_heights(wks, RCLT_SPARKLINE, nRowHeight, false);</span>
	
	waitCursor hrGlass;
	<span style="color: #0000ff;">for</span><span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> nC <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; nC <span style="color: #000080;">&lt;</span> wks.<span style="color: #000000;">GetNumCols</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; nC<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">&#40;</span>nC<span style="color: #000000;">&#41;</span>.<span style="color: #000000;">GetType</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000040;">!</span><span style="color: #000080;">=</span> OKDATAOBJ_DESIGNATION_Y <span style="color: #000040;">||</span> is_col_all_text<span style="color: #000000;">&#40;</span>wks, nC<span style="color: #000000;">&#41;</span> <span style="color: #000080;">&gt;</span> <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>
			<span style="color: #0000ff;">continue</span>;
		
		GraphPage gp;
		DataPlot dp <span style="color: #000080;">=</span> plot_col<span style="color: #000000;">&#40;</span>wks, nC, gp, IDM_PLOT_LINE, <span style="color: #0000ff;">true</span>, <span style="color: #ff00ff;">&quot;sparkline_label&quot;</span>, <span style="color: #0000ff;">true</span>, <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
		<span style="color: #0000ff;">int</span> ncolor <span style="color: #000080;">=</span> nC<span style="color: #000040;">%</span>2? SYSCOLOR_BLUE<span style="color: #000000;">:</span>SYSCOLOR_RED;
		dp.<span style="color: #000000;">SetColor</span><span style="color: #000000;">&#40;</span>ncolor<span style="color: #000000;">&#41;</span>;
		wks.<span style="color: #000000;">EmbedGraph</span><span style="color: #000000;">&#40;</span>RCLT_SPARKLINE, nC, gp, dwCntrl<span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>






