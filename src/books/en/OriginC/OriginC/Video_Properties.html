<h1 class="firstHeading">3.17.3 Video Properties</h1><p><br />
</p>
<h2><a name="Example"></a><span class="mw-headline">Example</span></h2>
<p class="version" >Minimum Origin Version Required: Origin 2016 SR0</p>
<p>The following example shows how to use OpenCV's cvGetCaptureProperty to get information about an existing video file. 
</p>
<pre class="oc" style="font-family:monospace;">#if _OC_VER <span style="color: #000080;">&gt;=</span> 0x0920
<span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>..\originlab\opencv.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span>
<span style="color: #0000ff;">#else</span>
<span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>opencv.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span>
<span style="color: #0000ff;">#endif</span>

<span style="color: #0000ff;">void</span> Video_Properties_ex1<span style="color: #000000;">&#40;</span>LPCSTR fileName<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	CvCapture<span style="color: #000040;">*</span> cap <span style="color: #000080;">=</span> cvCreateFileCapture<span style="color: #000000;">&#40;</span>fileName<span style="color: #000000;">&#41;</span>;
	<span style="color: #0000ff;">if</span> <span style="color: #000000;">&#40;</span>cap<span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		<span style="color: #0000ff;">int</span> width, height, fourcc;
		<span style="color: #0000ff;">double</span> fps, frcount;

		<span style="color: #008000;">// Call OpenCV's cvGetCaptureProperty function to get a property</span>
		<span style="color: #008000;">// of the video.  All the CV_CAP_PROP_* IDs are enumerated in the</span>
		<span style="color: #008000;">// opencv_highgui.h header file.</span>
		fourcc <span style="color: #000080;">=</span> <span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span><span style="color: #000000;">&#41;</span>cvGetCaptureProperty<span style="color: #000000;">&#40;</span>cap, CV_CAP_PROP_FOURCC<span style="color: #000000;">&#41;</span>;
		width <span style="color: #000080;">=</span> <span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span><span style="color: #000000;">&#41;</span>cvGetCaptureProperty<span style="color: #000000;">&#40;</span>cap, CV_CAP_PROP_FRAME_WIDTH<span style="color: #000000;">&#41;</span>;
		height <span style="color: #000080;">=</span> <span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span><span style="color: #000000;">&#41;</span>cvGetCaptureProperty<span style="color: #000000;">&#40;</span>cap, CV_CAP_PROP_FRAME_HEIGHT<span style="color: #000000;">&#41;</span>;
		fps <span style="color: #000080;">=</span> cvGetCaptureProperty<span style="color: #000000;">&#40;</span>cap, CV_CAP_PROP_FPS<span style="color: #000000;">&#41;</span>;
		frcount <span style="color: #000080;">=</span> cvGetCaptureProperty<span style="color: #000000;">&#40;</span>cap, CV_CAP_PROP_FRAME_COUNT<span style="color: #000000;">&#41;</span>;

		<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Four CC     =&#160;%d,%d,%d,%d<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>,
			LOBYTE<span style="color: #000000;">&#40;</span>LOWORD<span style="color: #000000;">&#40;</span>fourcc<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>, HIBYTE<span style="color: #000000;">&#40;</span>LOWORD<span style="color: #000000;">&#40;</span>fourcc<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>,
			LOBYTE<span style="color: #000000;">&#40;</span>HIWORD<span style="color: #000000;">&#40;</span>fourcc<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>, HIBYTE<span style="color: #000000;">&#40;</span>HIWORD<span style="color: #000000;">&#40;</span>fourcc<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;
		<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Size        =&#160;%d x&#160;%d<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, width, height<span style="color: #000000;">&#41;</span>;
		<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;FPS         =&#160;%f<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, fps<span style="color: #000000;">&#41;</span>;
		<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Frame Count =&#160;%f<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, frcount<span style="color: #000000;">&#41;</span>;
		<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Length      =&#160;%f second(s)<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, frcount <span style="color: #000040;">/</span> fps<span style="color: #000000;">&#41;</span>;

		cvReleaseCapture<span style="color: #000000;">&#40;</span><span style="color: #000040;">&amp;</span>cap<span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span>

<span style="color: #0000ff;">void</span> test_Video_Properties_ex1<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	<span style="color: #008000;">// Assuming you have a video named 'myvideo.avi' in your User Files folder.</span>
	string fileName <span style="color: #000080;">=</span> GetAppPath<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000040;">+</span> <span style="color: #ff00ff;">&quot;myvideo.avi&quot;</span>;
	Video_Properties_ex1<span style="color: #000000;">&#40;</span>fileName<span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<p class="version" >Minimum Origin Version Required: Origin 9.1 SR0</p>
<p>The following example shows how to use Origin C's new SystemShellItem class to get information about an existing video file.
</p><p>Note: The SystemShellItem class uses features available only in Windows Vista and later or Windows Server 2008 and later. 
</p>
<pre class="oc" style="font-family:monospace;">#if _OC_VER <span style="color: #000080;">&gt;=</span> 0x0920
<span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>..\originlab\opencv.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span>
<span style="color: #0000ff;">#else</span>
<span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>opencv.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span>
<span style="color: #0000ff;">#endif</span>
<span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>..\OriginLab\SystemShellItem.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span>

<span style="color: #0000ff;">void</span> Video_Properties_ex2<span style="color: #000000;">&#40;</span>LPCSTR fileName<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	SystemShellItem shellItem;

	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> shellItem.<span style="color: #000000;">Open</span><span style="color: #000000;">&#40;</span>fileName<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		string str;
		ULONG ui;

		<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> shellItem.<span style="color: #000000;">GetString</span><span style="color: #000000;">&#40;</span>OSHELLITEM_KEY_TITLE, str<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
			<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Title =&#160;%s<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, str<span style="color: #000000;">&#41;</span>;
		<span style="color: #0000ff;">else</span>
			<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Error&#160;%d<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, shellItem.<span style="color: #000000;">LastError</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;

		<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> shellItem.<span style="color: #000000;">GetString</span><span style="color: #000000;">&#40;</span>OSHELLITEM_KEY_SUBTITLE, str<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
			<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Subtitle =&#160;%s<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, str<span style="color: #000000;">&#41;</span>;
		<span style="color: #0000ff;">else</span>
			<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Error&#160;%d<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, shellItem.<span style="color: #000000;">LastError</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;

		<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> shellItem.<span style="color: #000000;">GetUInt32</span><span style="color: #000000;">&#40;</span>OSHELLITEM_KEY_RATING, <span style="color: #000040;">&amp;</span>ui<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
			<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Rating =&#160;%u<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, ui<span style="color: #000000;">&#41;</span>;
		<span style="color: #0000ff;">else</span>
			<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Error&#160;%d<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, shellItem.<span style="color: #000000;">LastError</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;

		<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> shellItem.<span style="color: #000000;">GetString</span><span style="color: #000000;">&#40;</span>OSHELLITEM_KEY_COMMENT, str<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
			<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Comments =&#160;%s<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, str<span style="color: #000000;">&#41;</span>;
		<span style="color: #0000ff;">else</span>
			<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Error&#160;%d<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, shellItem.<span style="color: #000000;">LastError</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;

		shellItem.<span style="color: #000000;">Close</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span>

<span style="color: #0000ff;">void</span> test_Video_Properties_ex2<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	<span style="color: #008000;">// Assuming you have a video named 'myvideo.mp4' in your User Files folder.</span>
	string fileName <span style="color: #000080;">=</span> GetAppPath<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000040;">+</span> <span style="color: #ff00ff;">&quot;myvideo.mp4&quot;</span>;
	Video_Properties_ex2<span style="color: #000000;">&#40;</span>fileName<span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>






