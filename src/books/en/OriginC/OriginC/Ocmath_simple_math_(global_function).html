<h1 class="firstHeading">2.1.17.8.15 ocmath_simple_math</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Syntax"><span class="tocnumber">2</span> <span class="toctext">Syntax</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Parameters"><span class="tocnumber">3</span> <span class="toctext">Parameters</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Return"><span class="tocnumber">4</span> <span class="toctext">Return</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Examples"><span class="tocnumber">5</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Remark"><span class="tocnumber">6</span> <span class="toctext">Remark</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#See_Also"><span class="tocnumber">7</span> <span class="toctext">See Also</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Header_to_Include"><span class="tocnumber">8</span> <span class="toctext">Header to Include</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Reference"><span class="tocnumber">9</span> <span class="toctext">Reference</span></a></li>
</ul>
</div>

<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>Perform arithmatic operation element-wised on two curves
</p>
<h2><a name="Syntax"></a><span class="mw-headline">Syntax</span></h2>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">int</span> ocmath_simple_math<span style="color: #000000;">&#40;</span> UINT nSize, <span style="color: #0000ff;">double</span> <span style="color: #000040;">*</span> pX, <span style="color: #0000ff;">double</span> <span style="color: #000040;">*</span> pY, UINT nSrcSize1, <span style="color: #0000ff;">const</span> <span style="color: #0000ff;">double</span> <span style="color: #000040;">*</span> pSrcX1, <span style="color: #0000ff;">const</span> <span style="color: #0000ff;">double</span> <span style="color: #000040;">*</span> pSrcY1, UINT nSrcSize2, <span style="color: #0000ff;">const</span> <span style="color: #0000ff;">double</span> <span style="color: #000040;">*</span> pSrcX2, <span style="color: #0000ff;">const</span> <span style="color: #0000ff;">double</span> <span style="color: #000040;">*</span> pSrcY2, <span style="color: #0000ff;">int</span> nOperator <span style="color: #000080;">=</span> MATHTOOL_OPT_ADD, <span style="color: #0000ff;">int</span> nRange <span style="color: #000080;">=</span> MATHTOOL_RNG_CUV, <span style="color: #0000ff;">int</span> nMethod <span style="color: #000080;">=</span> INTERP_TYPE_LINEAR, <span style="color: #0000ff;">double</span> dSmoothingFactor <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">&#41;</span></pre>
<h2><a name="Parameters"></a><span class="mw-headline">Parameters</span></h2>
<dl><dt> nSize</dt>
<dd>[input] the size of result curve</dd>
<dt> pX</dt>
<dd>[output] pointer to the x coordinates of result curve</dd>
<dt> pY</dt>
<dd>[output] pointer to the y coordinates of result curve</dd>
<dt> nSrcSize1</dt>
<dd>[input] the size of the first curve</dd>
<dt> pSrcX1</dt>
<dd>[input] pointer to the x coordinates of the first curve</dd>
<dt> pSrcY1</dt>
<dd>[input] pointer to the y coordinates of the first curve</dd>
<dt> nSrcSize2</dt>
<dd>[input] the size of the second curve</dd>
<dt> pSrcX2</dt>
<dd>[input] pointer to the x coordinates of the second curve</dd>
<dt> pSrcY2</dt>
<dd>[input] pointer to the y coordinates of the second curve</dd>
<dt> nOperator</dt>
<dd>[input] the operation between the two input curve</dd>
<dd>MATHTOOL_OPT_ADD		add operation</dd>
<dd>MATHTOOL_OPT_SUB		subtract operation</dd>
<dd>MATHTOOL_OPT_DIV		divide operation</dd>
<dd>MATHTOOL_OPT_MUL		multiply operation</dd>
<dd>MATHTOOL_OPT_EXP		exponent operation</dd>
<dt> nRange</dt>
<dd>[input] the range to perform the operation on</dd>
<dd>MATHTOOL_RNG_CUV		perform the operation on entire curves</dd>
<dd>MATHTOOL_RNG_COM		perform the operation on common x coordinates</dd>
<dd>MATHTOOL_RNG_UD			reserved for future</dd>
<dt> nMethod</dt>
<dd>[input] interpolating method, only available when use MATHTOOL_RNG_CUV.</dd>
<dd>INTERP_TYPE_LINEAR(linear interpolation),</dd>
<dd>INTERP_TYPE_SPLINE(cubic spline interpolation with not-a-knot boundary condition, and the not-a-knot boundary condition assume that the 3rd order derivative are continuous on the 2nd and last 2nd points),</dd>
<dd>INTERP_TYPE_BSPLINE(B-Spline curve fitting using method by Dierckx.P)</dd>
<dt> dSmoothingFactor</dt>
<dd>[input] This argument specifies the closeness to the original data, only available when nMethod = INTERP_TYPE_BSPLINE. dSmoothingFactor &gt;= 0.</dd>
<dd>By means of this parameter, the user can control the tradeoff between closeness of fit and smoothness of fit of the approximation.</dd>
<dd>If dSmoothingFactor is too large, the spline will be too smooth and signal will be lost&#160;; if it is too small the spline will pick up too much noise.</dd>
<dd>In the extreme cases the program will return an interpolating spline if  dSmoothingFactor=0 and the weighted least-squares polynomial of degree 3 if s is very large.</dd></dl>
<h2><a name="Return"></a><span class="mw-headline">Return</span></h2>
<p>Return OE_NOERROR if succeed, otherwise, non-zero error code is returned.
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p><b>EX1</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">//Assume there is a workbook named &quot;Book1&quot; in the current project</span>
<span style="color: #0000ff;">void</span> ocmath_simple_math_ex1<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    Worksheet wks<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Book1&quot;</span><span style="color: #000000;">&#41;</span>;
    vector vA, vB, vC;
    
    vA.<span style="color: #000000;">Data</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0.0</span>, <span style="color: #0000dd;">6.0</span>, <span style="color: #0000dd;">0.03</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">int</span> iCount <span style="color: #000080;">=</span> vA.<span style="color: #000000;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    vB.<span style="color: #000000;">SetSize</span><span style="color: #000000;">&#40;</span>iCount<span style="color: #000000;">&#41;</span>;
    vC.<span style="color: #000000;">SetSize</span><span style="color: #000000;">&#40;</span>iCount<span style="color: #000000;">&#41;</span>;
    
    <span style="color: #0000ff;">for</span><span style="color: #000000;">&#40;</span> <span style="color: #0000ff;">int</span> ii<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>; ii<span style="color: #000080;">&lt;</span>iCount; ii<span style="color: #000040;">++</span> <span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        vB<span style="color: #000000;">&#91;</span>ii<span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> <span style="color: #000000;">sin</span><span style="color: #000000;">&#40;</span>vA<span style="color: #000000;">&#91;</span>ii<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span>;
        vC<span style="color: #000000;">&#91;</span>ii<span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> <span style="color: #000000;">cos</span><span style="color: #000000;">&#40;</span>vA<span style="color: #000000;">&#91;</span>ii<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #000000;">&#125;</span>

    Dataset dsX<span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
    Dataset dsY<span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;

    dsX.<span style="color: #000000;">SetSize</span><span style="color: #000000;">&#40;</span>iCount<span style="color: #000000;">&#41;</span>;
    dsY.<span style="color: #000000;">SetSize</span><span style="color: #000000;">&#40;</span>iCount<span style="color: #000000;">&#41;</span>;
    vector vx<span style="color: #000000;">&#40;</span>iCount<span style="color: #000000;">&#41;</span>;
    vector vy<span style="color: #000000;">&#40;</span>iCount<span style="color: #000000;">&#41;</span>;
    ocmath_simple_math<span style="color: #000000;">&#40;</span>iCount, vx, vy, iCount, vA, vB, iCount, vA, vC, MATHTOOL_OPT_ADD<span style="color: #000000;">&#41;</span>;
    dsX <span style="color: #000080;">=</span> vx;
    dsY <span style="color: #000080;">=</span> vy;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Remark"></a><span class="mw-headline">Remark</span></h2>
<h2><a name="See_Also"></a><span class="mw-headline">See Also</span></h2>
<h2><a name="Header_to_Include"></a><span class="mw-headline">Header to Include</span></h2>
<p>origin.h
</p>
<h2><a name="Reference"></a><span class="mw-headline">Reference</span></h2>






