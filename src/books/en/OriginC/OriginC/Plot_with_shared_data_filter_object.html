<h1 class="firstHeading">3.3.14 Plot with Shared Data Filter Object</h1><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Plot_with_Shared_Data_Filter_Object"><span class="tocnumber">1</span> <span class="toctext">Plot with Shared Data Filter Object</span></a></li>
</ul>
</div>

<h2><a name="Plot_with_Shared_Data_Filter_Object"></a><span class="mw-headline">Plot with Shared Data Filter Object</span></h2>
<p>This example to show how to create new plot using Shared Data Filter Object
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">//pp_flt(2, 5, 3, &quot;3:&quot;between(11,15)&quot;&quot;, 4, &quot;3:&quot;between(1700,2200)&quot;&quot;)</span>
<span style="color: #0000ff;">void</span> pp_flt<span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> nx<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>, <span style="color: #0000ff;">int</span> ny<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>, <span style="color: #0000ff;">int</span> nShDF1 <span style="color: #000080;">=</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, string strShDF1 <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;&quot;</span>, <span style="color: #0000ff;">int</span> nShDF2 <span style="color: #000080;">=</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, string strShDF2 <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;&quot;</span>, <span style="color: #0000ff;">int</span> nPlotType <span style="color: #000080;">=</span> <span style="color: #0000dd;">201</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	Worksheet		wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span><span style="color: #000040;">!</span>wks<span style="color: #000000;">&#41;</span>
		<span style="color: #0000ff;">return</span>;
	string strBook, strSheet;
	wks.<span style="color: #000000;">GetPage</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>.<span style="color: #000000;">GetName</span><span style="color: #000000;">&#40;</span>strBook<span style="color: #000000;">&#41;</span>;
	wks.<span style="color: #000000;">GetName</span><span style="color: #000000;">&#40;</span>strSheet<span style="color: #000000;">&#41;</span>;

	DWORD			dwAuxTypeInfo, dwLTPlotInfo;
	string			strColPattern;
	uint			nExVal <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
	Tree			tr;
	vector<span style="color: #000080;">&lt;</span>string<span style="color: #000080;">&gt;</span>	vsWksPages;
	vector<span style="color: #000080;">&lt;</span>string<span style="color: #000080;">&gt;</span>	vsLayers;
	vsWksPages.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>strBook<span style="color: #000000;">&#41;</span>;
	vsLayers.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>strSheet<span style="color: #000000;">&#41;</span>;
	vector<span style="color: #000080;">&lt;</span>string<span style="color: #000080;">&gt;</span> vsCols;
	vector<span style="color: #000080;">&lt;</span>uint<span style="color: #000080;">&gt;</span> vpdesig;
	Column cx <span style="color: #000080;">=</span> wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">&#40;</span>nx<span style="color: #000000;">&#41;</span>;
	Column cy <span style="color: #000080;">=</span> wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">&#40;</span>ny<span style="color: #000000;">&#41;</span>;
	string strName;
	
	cx.<span style="color: #000000;">GetName</span><span style="color: #000000;">&#40;</span>strName<span style="color: #000000;">&#41;</span>;
	vsCols.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>strName<span style="color: #000000;">&#41;</span>;
	vpdesig.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>COLDESIG_X<span style="color: #000000;">&#41;</span>;
	
	cy.<span style="color: #000000;">GetName</span><span style="color: #000000;">&#40;</span>strName<span style="color: #000000;">&#41;</span>;
	vsCols.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>strName<span style="color: #000000;">&#41;</span>;
	vpdesig.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>COLDESIG_Y<span style="color: #000000;">&#41;</span>;
	
	IntArray		arrFilterCols;
	vector<span style="color: #000080;">&lt;</span>string<span style="color: #000080;">&gt;</span>	vsShDFs;
	<span style="color: #0000ff;">if</span> <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span> <span style="color: #000080;">&lt;=</span> nShDF1<span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		arrFilterCols.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>nShDF1<span style="color: #000000;">&#41;</span>;
		vsShDFs.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>strShDF1<span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">&#125;</span>
	<span style="color: #0000ff;">if</span> <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span> <span style="color: #000080;">&lt;=</span> nShDF2<span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		arrFilterCols.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>nShDF2<span style="color: #000000;">&#41;</span>;
		vsShDFs.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>strShDF2<span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">&#125;</span>
	<span style="color: #0000ff;">for</span> <span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> iShDF <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; iShDF <span style="color: #000080;">&lt;</span> arrFilterCols.<span style="color: #000000;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; iShDF<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		<span style="color: #0000ff;">if</span> <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span> <span style="color: #000080;">&lt;=</span> arrFilterCols<span style="color: #000000;">&#91;</span>iShDF<span style="color: #000000;">&#93;</span> <span style="color: #000040;">&amp;&amp;</span> <span style="color: #000040;">!</span>vsShDFs<span style="color: #000000;">&#91;</span>iShDF<span style="color: #000000;">&#93;</span>.<span style="color: #000000;">IsEmpty</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>
		<span style="color: #000000;">&#123;</span>
			Column cFilter <span style="color: #000080;">=</span> wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">&#40;</span>arrFilterCols<span style="color: #000000;">&#91;</span>iShDF<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span>;
			<span style="color: #0000ff;">if</span> <span style="color: #000000;">&#40;</span>cFilter.<span style="color: #000000;">IsValid</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>
			<span style="color: #000000;">&#123;</span>
				cFilter.<span style="color: #000000;">GetName</span><span style="color: #000000;">&#40;</span>strName<span style="color: #000000;">&#41;</span>;
				vsCols.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>strName<span style="color: #000000;">&#41;</span>;
				vpdesig.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>COLDESIG_FILTER<span style="color: #000000;">&#41;</span>;
			<span style="color: #000000;">&#125;</span>
			<span style="color: #0000ff;">else</span>
				<span style="color: #000000;">ASSERT</span><span style="color: #000000;">&#40;</span><span style="color: #0000ff;">FALSE</span><span style="color: #000000;">&#41;</span>;
		<span style="color: #000000;">&#125;</span>
		<span style="color: #0000ff;">else</span>
			<span style="color: #000000;">ASSERT</span><span style="color: #000000;">&#40;</span><span style="color: #0000ff;">FALSE</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">&#125;</span>
	
	DWORD dwCntrl <span style="color: #000080;">=</span> DPEDTVIEW_HIDE_LIMITS;
	<span style="color: #0000ff;">int</span>				nn <span style="color: #000080;">=</span> get_plot_type_info<span style="color: #000000;">&#40;</span>nPlotType, EXIST_WKS, <span style="color: #0000dd;">0</span>, dwAuxTypeInfo, dwLTPlotInfo, strColPattern<span style="color: #000000;">&#41;</span>;
	<span style="color: #0000ff;">int</span>	nRet <span style="color: #000080;">=</span>  <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> Project.<span style="color: #000000;">MakeDataplotsTree</span><span style="color: #000000;">&#40;</span>tr, nn, dwAuxTypeInfo, dwLTPlotInfo, strColPattern, nExVal, vpdesig, vsWksPages, vsLayers, vsCols, dwCntrl
				, <span style="color: #0000ff;">NULL</span>
				, <span style="color: #000040;">&amp;</span>vsShDFs	
				<span style="color: #000000;">&#41;</span>;
	
	GraphPage gp;
	gp.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;scatter&quot;</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// create scatter graph	</span>
	GraphLayer gl <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
	TreeNode		trLayer <span style="color: #000080;">=</span> tr.<span style="color: #000000;">FirstNode</span>;
	<span style="color: #0000ff;">int</span>				nNumPlotsAdded <span style="color: #000080;">=</span> gl.<span style="color: #000000;">AddPlots</span><span style="color: #000000;">&#40;</span>trLayer, ADDPLOTSFROMTREE_NEW<span style="color: #000000;">&#41;</span>;
	gl.<span style="color: #000000;">Rescale</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;

<span style="color: #000000;">&#125;</span></pre>






