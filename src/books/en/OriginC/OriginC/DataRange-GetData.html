<h1 class="firstHeading">2.2.4.9.10 DataRange::GetData</h1><p><span class="OIndex" style="display:none">GetData</span>
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Syntax"><span class="tocnumber">2</span> <span class="toctext">Syntax</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Parameters"><span class="tocnumber">3</span> <span class="toctext">Parameters</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Return"><span class="tocnumber">4</span> <span class="toctext">Return</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Examples"><span class="tocnumber">5</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Remark"><span class="tocnumber">6</span> <span class="toctext">Remark</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#See_Also"><span class="tocnumber">7</span> <span class="toctext">See Also</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Header_to_Include"><span class="tocnumber">8</span> <span class="toctext">Header to Include</span></a></li>
</ul>
</div>

<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>Get the data from indexed subrange
get data from all subrange if nIndex is negative.
</p><p><br />
It extracts data from the object.
</p><p><br />
It extracts matrix data from DataRange.
</p>
<h2><a name="Syntax"></a><span class="mw-headline">Syntax</span></h2>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">BOOL</span> GetData<span style="color: #000000;">&#40;</span> vectorbase <span style="color: #000040;">*</span> pData, <span style="color: #0000ff;">int</span> nIndex, DWORD dwRules2 <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">&#41;</span></pre>
<p><br />
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">int</span> GetData<span style="color: #000000;">&#40;</span> DWORD dwRules, <span style="color: #0000ff;">int</span> nIndex, DWORD <span style="color: #000040;">*</span> pouidAux, string <span style="color: #000040;">*</span> pstrDescriptive, vectorbase <span style="color: #000040;">*</span> pv, vector <span style="color: #000040;">*</span> pvIndep <span style="color: #000080;">=</span> <span style="color: #0000ff;">NULL</span>, matrix <span style="color: #000040;">*</span> pmMultiIndep <span style="color: #000080;">=</span> <span style="color: #0000ff;">NULL</span>, vector<span style="color: #000080;">&lt;</span>string<span style="color: #000080;">&gt;</span> <span style="color: #000040;">*</span> pstrFactors <span style="color: #000080;">=</span> <span style="color: #0000ff;">NULL</span>, vector <span style="color: #000040;">*</span> pvWeights <span style="color: #000080;">=</span> <span style="color: #0000ff;">NULL</span>, vector <span style="color: #000040;">*</span> pvErrDep <span style="color: #000080;">=</span> <span style="color: #0000ff;">NULL</span>, vector <span style="color: #000040;">*</span> pvErrIndep <span style="color: #000080;">=</span> <span style="color: #0000ff;">NULL</span>, Worksheet <span style="color: #000040;">*</span> pwksData <span style="color: #000080;">=</span> <span style="color: #0000ff;">NULL</span>, vector <span style="color: #000040;">*</span> pvYIndep <span style="color: #000080;">=</span> <span style="color: #0000ff;">NULL</span>, vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> <span style="color: #000040;">*</span> pvintRowsInSource <span style="color: #000080;">=</span> <span style="color: #0000ff;">NULL</span>, STGETDATAOUTPUTINFO <span style="color: #000040;">*</span> pstOutInfo <span style="color: #000080;">=</span> <span style="color: #0000ff;">NULL</span>, DWORD dwRules2 <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">&#41;</span></pre>
<p><br />
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">int</span> GetData<span style="color: #000000;">&#40;</span> DWORD dwRules, <span style="color: #0000ff;">int</span> nIndex, vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> <span style="color: #000040;">&amp;</span> vIndicesIn, vector <span style="color: #000040;">&amp;</span> vMainOut, vector <span style="color: #000040;">&amp;</span> vIndepOut, vector <span style="color: #000040;">&amp;</span> vYIndepOut <span style="color: #000080;">=</span> <span style="color: #0000ff;">NULL</span> <span style="color: #000000;">&#41;</span></pre>
<p><br />
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">int</span> GetData<span style="color: #000000;">&#40;</span> matrixbase <span style="color: #000040;">&amp;</span> m, DWORD dwRules <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>, <span style="color: #0000ff;">int</span> index <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>, DWORD dwRules2 <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">&#41;</span></pre>
<p><br />
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">int</span> GetData<span style="color: #000000;">&#40;</span>STDRGETDATAARGS <span style="color: #000040;">&amp;</span> gdInfoOut, STGETDATAOUTPUTINFO <span style="color: #000040;">*</span> pstOutInfo <span style="color: #000080;">=</span> <span style="color: #0000ff;">NULL</span><span style="color: #000000;">&#41;</span></pre>
<h2><a name="Parameters"></a><span class="mw-headline">Parameters</span></h2>
<dl><dt> pData</dt>
<dd>[output] it receives the data in range</dd>
<dt> nIndex</dt>
<dd>[input] the index of data</dd></dl>
<p><br />
</p>
<dl><dt> dwRules</dt>
<dd>[input]the optional bits from the DRR_ enumeration.</dd>
<dt> nIndex</dt>
<dd>[input]the index of the data. DataRange can reference multiple sets of data. Index starts from 0. See AddInput for an example.</dd>
<dt> pouidAux</dt>
<dd>[output] if supplied, it receives the dataplot UID stored in the DataRange object.</dd>
<dt> pstrDescriptive</dt>
<dd>[input]not used</dd>
<dt> pv</dt>
<dd>[output]it receives the main data values.</dd>
<dt> pvIndep</dt>
<dd>[output]it receives the X-independent data if DRR_GET_DEPENDENT or DRR_GET_Z_DEPENDENT rules bits are passed in.</dd>
<dt> pmMultiIndep</dt>
<dd>[output]it receives the (potentially) multiple X-independent data if DRR_GET_DEPENDENT and DRR_ONE_DEP_MULTIINDEP bits are passed in</dd>
<dd>(appropriate for Multiple Regression).</dd>
<dt> pstrFactors</dt>
<dd>[output]it receives the values of factors for each factor data that correspond to the values</dd>
<dd>returned into pv. The size of the returned vector is equal to the total number of factors.</dd>
<dt> pvWeights</dt>
<dd>[output]it receives the weight values</dd>
<dt> pvErrDep</dt>
<dd>[output]it receives the dependent error values</dd>
<dt> pvErrIndep</dt>
<dd>[output]it receives the independent error values</dd>
<dt> pwksData</dt>
<dd>[output] it is initialized to the Worksheet object to which the main data belongs.</dd>
<dt> pvYIndep</dt>
<dd>[output] it receives the Y-independent data. Used only if DRR_GET_Z_DEPENDENT rules bit is supplied.</dd></dl>
<dl><dt> pvintRowsInSource</dt>
<dd> [output] it receives the row indices in the source</dd>
<dt> pstOutInfo</dt>
<dd> [output]a pointer which points to output structure STGETDATAOUTPUTINFO. Keep it as NULL if the output is not necessary. STGETDATAOUTPUTINFO is defined in OC_types.h</dd>
<dt> dwRules2</dt>
<dd> bits from the DRR2_ enumeration.</dd></dl>
<p><br />
</p>
<dl><dt> dwRules</dt>
<dd>[input]the rules for extracting data from DRR_ enumeration.</dd>
<dt> nIndex</dt>
<dd>[input]the data index</dd>
<dt> vIndicesIn</dt>
<dd>[input]the row indices that need to be extracted</dd>
<dt> vMainOut</dt>
<dd>[output]the main data</dd>
<dt> vIndepOut</dt>
<dd>[output]the X independent data</dd>
<dt> vYIndepOut</dt>
<dd>[output]the Y-independent data (used only if DRR_GET_Z_DEPENDENT supplied in dwRules, which means XYZ data)</dd></dl>
<p><br />
</p>
<dl><dt> m</dt>
<dd>[output]the matrixbase object which will receive the matrix data.</dd>
<dt> dwRules</dt>
<dd>[input]not used, must be 0.</dd>
<dt> index</dt>
<dd>[input]data index in case DataRange refers to multiple matrices.</dd></dl>
<p><br />
</p>
<dl><dt> gdInfoOut</dt>
<dd>[modify]a STDRGETDATAARGS structure which includes all parameters except output structure STGETDATAOUTPUTINFO. STDRGETDATAARGS is defined in Range.h:</dd></dl>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">struct</span> STDRGETDATAARGS 
<span style="color: #000000;">&#123;</span>
	<span style="color: #0000ff;">int</span> nIndex;
	DWORD dwRules;
	DWORD dwRules2;
	DWORD <span style="color: #000040;">*</span>pouidAux;
	string <span style="color: #000040;">*</span>pstrDescriptive;
	vectorbase <span style="color: #000040;">*</span>pv;
	vector <span style="color: #000040;">*</span>pvIndep;
	matrix <span style="color: #000040;">*</span>pmMultiIndep;
	vector<span style="color: #000080;">&lt;</span>string<span style="color: #000080;">&gt;</span> <span style="color: #000040;">*</span>pstrFactors;
	vector <span style="color: #000040;">*</span>pvWeights;
	vector <span style="color: #000040;">*</span>pvErrDep;
	vector <span style="color: #000040;">*</span>pvErrIndep;
	Worksheet <span style="color: #000040;">*</span>pwksData;
	vector <span style="color: #000040;">*</span>pvYIndep;
	vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> <span style="color: #000040;">*</span>pvintRowsInSource;
<span style="color: #000000;">&#125;</span>;</pre>
<dl><dt> pstOutInfo</dt>
<dd>[output]a pointer which points to output structure STGETDATAOUTPUTINFO. Keep it as NULL if the output is not necessary. STGETDATAOUTPUTINFO is defined in OC_types.h:</dd></dl>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">struct</span> STGETDATAOUTPUTINFO
<span style="color: #000000;">&#123;</span>
    <span style="color: #0000ff;">int</span> nCountNegativeErrorValuesFound;
    <span style="color: #0000ff;">int</span> nCountZeroErrorValuesFound;
    <span style="color: #0000ff;">int</span> nCountMissingErrorValuesFound;
<span style="color: #000000;">&#125;</span>;</pre>
<h2><a name="Return"></a><span class="mw-headline">Return</span></h2>
<p>true if successfully, else false.
</p><p><br />
If it succeeds, it returns the index of the row (if the DRR_BY_ROWS rules bit passed in) or the column from which the main data is drawn, otherwise it returns a negative number.
</p><p><br />
If it succeeds, it returns the index of the row (if the DRR_BY_ROWS rules bit passed in) or the column from which the main data is drawn, otherwise it returns a negative number.
</p><p><br />
1 if success.
</p><p><br />
If it succeeds, it returns the index of the row (if the DRR_BY_ROWS rules bit passed in) or the column from which the main data is drawn, otherwise it returns a negative number.
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p><b>EX1</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// This example assumes a worksheet with two columns of data is active</span>
<span style="color: #0000ff;">void</span> DataRange_GetData_Ex1<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #000040;">!</span>wks <span style="color: #000000;">&#41;</span>
        <span style="color: #0000ff;">return</span>;
    
    DataRange dr;
    dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">0</span>, <span style="color: #ff00ff;">&quot;A&quot;</span><span style="color: #000000;">&#41;</span>;
    dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">1</span>, <span style="color: #ff00ff;">&quot;B&quot;</span><span style="color: #000000;">&#41;</span>;    
    
    vector vA, vB, vAll;
    dr.<span style="color: #000000;">GetData</span><span style="color: #000000;">&#40;</span><span style="color: #000040;">&amp;</span>vA, <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// get the data from Column A</span>
    dr.<span style="color: #000000;">GetData</span><span style="color: #000000;">&#40;</span><span style="color: #000040;">&amp;</span>vB, <span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// get the data from Column B</span>
    dr.<span style="color: #000000;">GetData</span><span style="color: #000000;">&#40;</span><span style="color: #000040;">&amp;</span>vAll, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<p><br />
<b>EX2</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// This example assumes a worksheet with one column of data is active</span>
<span style="color: #0000ff;">void</span> DataRange_GetData_Ex2<span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> nXCol <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> wks <span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>                
        DataRange dr;
        dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>wks, nXCol, <span style="color: #ff00ff;">&quot;X&quot;</span><span style="color: #000000;">&#41;</span>;
        
        vector vX;
        DWORD dwPlotID;
        dr.<span style="color: #000000;">GetData</span><span style="color: #000000;">&#40;</span>DRR_GET_MISSING <span style="color: #000040;">|</span> DRR_NO_FACTORS, <span style="color: #0000dd;">0</span>, <span style="color: #000040;">&amp;</span>dwPlotID, <span style="color: #0000ff;">NULL</span>, <span style="color: #000040;">&amp;</span>vX<span style="color: #000000;">&#41;</span>;
        vX <span style="color: #000040;">*</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">10.0</span>;
        dr.<span style="color: #000000;">SetData</span><span style="color: #000000;">&#40;</span>vX<span style="color: #000000;">&#41;</span>;
    <span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>
<p><b>EX3</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// costruct DataRange from Project.ActiveLayer()</span>
<span style="color: #0000ff;">void</span> DataRange_GetData_Ex3<span style="color: #000000;">&#40;</span>string strX <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;A&quot;</span>, string strY <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;B&quot;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    <span style="color: #008000;">// For this example, a workbook with X and Y column data is assumed to be active.</span>
    Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span><span style="color: #000040;">!</span>wks<span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;err, no wks&quot;</span><span style="color: #000000;">&#41;</span>;
        <span style="color: #0000ff;">return</span>;
    <span style="color: #000000;">&#125;</span>
    
    <span style="color: #008000;">// construct a tree with data from worksheet</span>
    Tree tr;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> construct_one_data_range<span style="color: #000000;">&#40;</span>tr, wks, strX, strY<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>    
    <span style="color: #000000;">&#123;</span>
        out_tree<span style="color: #000000;">&#40;</span>tr<span style="color: #000000;">&#41;</span>;

        <span style="color: #008000;">// create the DataRange object from the tree.</span>
        DataRange dr;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>dr.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span>tr<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>
        <span style="color: #000000;">&#123;</span>
            <span style="color: #008000;">// Call GetData to copy the xy data into vectors vx and vy</span>
            vector vx, vy;
            DWORD dwPlotID; <span style="color: #008000;">// this is to receive data plot UID if present</span>
            <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>dr.<span style="color: #000000;">GetData</span><span style="color: #000000;">&#40;</span> DRR_GET_MISSING <span style="color: #000040;">|</span>  DRR_GET_DEPENDENT <span style="color: #000040;">|</span> DRR_NO_FACTORS, <span style="color: #0000dd;">0</span>, <span style="color: #000040;">&amp;</span>dwPlotID, <span style="color: #0000ff;">NULL</span>, <span style="color: #000040;">&amp;</span>vy, <span style="color: #000040;">&amp;</span>vx<span style="color: #000000;">&#41;</span> <span style="color: #000080;">&lt;</span> <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>
            <span style="color: #000000;">&#123;</span>
                out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;failed to make data copy from data range&quot;</span><span style="color: #000000;">&#41;</span>;
                <span style="color: #0000ff;">return</span>;
            <span style="color: #000000;">&#125;</span>
            
            <span style="color: #008000;">// now we have made a copy of xy data into vectors vx and vy</span>
            <span style="color: #008000;">// so we can do analysis on the data, for example:</span>
            <span style="color: #0000ff;">double</span> xmin, xmax, ymin, ymax;
            vx.<span style="color: #000000;">GetMinMax</span><span style="color: #000000;">&#40;</span>xmin, xmax<span style="color: #000000;">&#41;</span>;
            vy.<span style="color: #000000;">GetMinMax</span><span style="color: #000000;">&#40;</span>ymin, ymax<span style="color: #000000;">&#41;</span>;
        
        <span style="color: #000000;">&#125;</span>
        
        <span style="color: #008000;">// no need to call dr.Destroy().</span>

    <span style="color: #000000;">&#125;</span>
    <span style="color: #008000;">// dr is destroyed when go out of scope</span>
<span style="color: #000000;">&#125;</span></pre>
<p><b>EX4</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// This example assumes a worksheet with three columns of data is active</span>
<span style="color: #0000ff;">void</span> DataRange_GetData_Ex4<span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> nXCol <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>, <span style="color: #0000ff;">int</span> nYCol <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>, <span style="color: #0000ff;">int</span> nZCol <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span> 
    Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #000040;">!</span>wks <span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;error, no active worksheet&quot;</span><span style="color: #000000;">&#41;</span>;
        <span style="color: #0000ff;">return</span>;
    <span style="color: #000000;">&#125;</span>                    
            
    DataRange drIn;
    drIn.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;X&quot;</span>, wks, <span style="color: #0000dd;">0</span>, nXCol, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, nXCol<span style="color: #000000;">&#41;</span>;
    drIn.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Y&quot;</span>, wks, <span style="color: #0000dd;">0</span>, nYCol, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, nYCol<span style="color: #000000;">&#41;</span>;
    drIn.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Z&quot;</span>, wks, <span style="color: #0000dd;">0</span>, nZCol, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, nZCol<span style="color: #000000;">&#41;</span>;

    vector vX, vY, vZ;
    DWORD dwRules <span style="color: #000080;">=</span> DRR_GET_MISSING <span style="color: #000040;">|</span> DRR_GET_Z_DEPENDENT <span style="color: #000040;">|</span> DRR_NO_FACTORS;
    DWORD dwPlotID;
    <span style="color: #008000;">// Use this overloaded version of GetData to find out how many rows of XYZ data</span>
    drIn.<span style="color: #000000;">GetData</span><span style="color: #000000;">&#40;</span>dwRules, <span style="color: #0000dd;">0</span>, <span style="color: #000040;">&amp;</span>dwPlotID, <span style="color: #0000ff;">NULL</span>, <span style="color: #000040;">&amp;</span>vZ, <span style="color: #000040;">&amp;</span>vX, <span style="color: #0000ff;">NULL</span>, <span style="color: #0000ff;">NULL</span>, <span style="color: #0000ff;">NULL</span>, <span style="color: #0000ff;">NULL</span>, <span style="color: #0000ff;">NULL</span>, <span style="color: #0000ff;">NULL</span>, <span style="color: #000040;">&amp;</span>vY<span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">int</span> iSizeIn <span style="color: #000080;">=</span> vX.<span style="color: #000000;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">int</span> iSizeOut <span style="color: #000080;">=</span> iSizeIn<span style="color: #000040;">/</span><span style="color: #0000dd;">2</span> <span style="color: #000040;">+</span> <span style="color: #0000dd;">1</span>;
    vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> vIndicesIn;
    vIndicesIn.<span style="color: #000000;">Data</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span>, iSizeIn <span style="color: #000040;">-</span> <span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #008000;">// Use this overloaded version of GetData with vIndicesIn to extract odd rows to new columns</span>
    drIn.<span style="color: #000000;">GetData</span><span style="color: #000000;">&#40;</span>dwRules, <span style="color: #0000dd;">0</span>, vIndicesIn, vZ, vX, vY<span style="color: #000000;">&#41;</span>;

    string strColDesigs <span style="color: #000080;">=</span> wks.<span style="color: #000000;">GetColDesignations</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    nXCol <span style="color: #000080;">=</span> wks.<span style="color: #000000;">AddCol</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;XOut&quot;</span><span style="color: #000000;">&#41;</span>;
    nYCol <span style="color: #000080;">=</span> wks.<span style="color: #000000;">AddCol</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;YOut&quot;</span><span style="color: #000000;">&#41;</span>;
    nZCol <span style="color: #000080;">=</span> wks.<span style="color: #000000;">AddCol</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;ZOut&quot;</span><span style="color: #000000;">&#41;</span>;
    strColDesigs <span style="color: #000040;">+</span><span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;XYZ&quot;</span>;
    wks.<span style="color: #000000;">SetColDesignations</span><span style="color: #000000;">&#40;</span>strColDesigs<span style="color: #000000;">&#41;</span>;

    DataRange drOut;
    drOut.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;X&quot;</span>, wks, <span style="color: #0000dd;">0</span>, nXCol, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, nXCol<span style="color: #000000;">&#41;</span>;
    drOut.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Y&quot;</span>, wks, <span style="color: #0000dd;">0</span>, nYCol, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, nYCol<span style="color: #000000;">&#41;</span>;
    drOut.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Z&quot;</span>, wks, <span style="color: #0000dd;">0</span>, nZCol, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, nZCol<span style="color: #000000;">&#41;</span>;
    drOut.<span style="color: #000000;">SetData</span><span style="color: #000000;">&#40;</span><span style="color: #000040;">&amp;</span>vZ, <span style="color: #000040;">&amp;</span>vY, <span style="color: #000040;">&amp;</span>vX<span style="color: #000000;">&#41;</span>;
    
<span style="color: #000000;">&#125;</span></pre>
<p><b>EX5</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// This example assumes 1 or more columns of main data, 1 column of factor or grouping data, and 1 column of weight data(see sample data)</span>
<span style="color: #0000ff;">void</span> DataRange_GetData_Ex5<span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> nXColStart <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>, <span style="color: #0000ff;">int</span> nXColEnd <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>, <span style="color: #0000ff;">int</span> nFCol <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>, <span style="color: #0000ff;">int</span> nWCol <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> wks <span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        DWORD dwRules <span style="color: #000080;">=</span> DRR_GET_MISSING <span style="color: #000040;">|</span> DRR_BAD_WEIGHT_TREATMENT;
        DataRange dr;
        dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;X&quot;</span>, wks, <span style="color: #0000dd;">0</span>, nXColStart, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, nXColEnd<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Main data</span>
        dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;F&quot;</span>, wks, <span style="color: #0000dd;">0</span>, nFCol, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, nFCol<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Factor data</span>
        dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;W&quot;</span>, wks, <span style="color: #0000dd;">0</span>, nWCol, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, nWCol<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Weight data</span>
        <span style="color: #0000ff;">int</span> nNumData <span style="color: #000080;">=</span> dr.<span style="color: #000000;">GetNumData</span><span style="color: #000000;">&#40;</span>dwRules<span style="color: #000000;">&#41;</span>;
        vector<span style="color: #000080;">&lt;</span>string<span style="color: #000080;">&gt;</span> vstrFactors;
        vector vData, vW;
        <span style="color: #0000ff;">double</span> dN, dMean, dMax, dMin;
        <span style="color: #0000ff;">for</span><span style="color: #000000;">&#40;</span> <span style="color: #0000ff;">int</span> ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; ii <span style="color: #000080;">&lt;</span> nNumData; ii<span style="color: #000040;">++</span> <span style="color: #000000;">&#41;</span>
        <span style="color: #000000;">&#123;</span>
            <span style="color: #0000ff;">int</span> nCol <span style="color: #000080;">=</span> dr.<span style="color: #000000;">GetData</span><span style="color: #000000;">&#40;</span>dwRules, ii, <span style="color: #0000ff;">NULL</span>, <span style="color: #0000ff;">NULL</span>, <span style="color: #000040;">&amp;</span>vData, <span style="color: #0000ff;">NULL</span>, <span style="color: #0000ff;">NULL</span>, <span style="color: #000040;">&amp;</span>vstrFactors, <span style="color: #000040;">&amp;</span>vW<span style="color: #000000;">&#41;</span>;
            <span style="color: #0000ff;">if</span> <span style="color: #000000;">&#40;</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">&lt;=</span> nCol <span style="color: #000000;">&#41;</span>
            <span style="color: #000000;">&#123;</span>
                vData <span style="color: #000040;">*</span><span style="color: #000080;">=</span> vW;
                dN <span style="color: #000080;">=</span> vData.<span style="color: #000000;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
                vData.<span style="color: #000000;">Sum</span><span style="color: #000000;">&#40;</span>dMean<span style="color: #000000;">&#41;</span>;
                dMean <span style="color: #000040;">/</span><span style="color: #000080;">=</span> dN;
                vData.<span style="color: #000000;">GetMinMax</span><span style="color: #000000;">&#40;</span>dMin, dMax<span style="color: #000000;">&#41;</span>;
                <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;<span style="color: #666666; font-weight: bold;">\n</span>Column =&#160;%s, Factor =&#160;%s<span style="color: #666666; font-weight: bold;">\n</span>Mean =&#160;%g<span style="color: #666666; font-weight: bold;">\n</span>Minimum =&#160;%g<span style="color: #666666; font-weight: bold;">\n</span>Maximum =&#160;%g<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, 
                        wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">&#40;</span>nCol<span style="color: #000000;">&#41;</span>.<span style="color: #000000;">GetName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>, vstrFactors<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#93;</span>, dMean, dMin, dMax<span style="color: #000000;">&#41;</span>;
            <span style="color: #000000;">&#125;</span>
        <span style="color: #000000;">&#125;</span>
    <span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>
<p><br />
<b>EX6</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// This example will create a new worksheet, the first two columns will be filled with 10 rows of random data,</span>
<span style="color: #008000;">// then even rows are extracted to the last two columns.</span>
<span style="color: #0000ff;">void</span> DataRange_GetData_Ex6<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    Worksheet wks;
    wks.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">int</span> nXCol,nYCol;
    nXCol<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;
    nYCol<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> wks <span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        <span style="color: #0000ff;">while</span><span style="color: #000000;">&#40;</span>wks.<span style="color: #000000;">DeleteCol</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;
        
        wks.<span style="color: #000000;">AddCol</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;A&quot;</span><span style="color: #000000;">&#41;</span>;
        wks.<span style="color: #000000;">AddCol</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;B&quot;</span><span style="color: #000000;">&#41;</span>;
 
        string strX,strY;
        strX<span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;A&quot;</span>;
        strY<span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;B&quot;</span>;
        <span style="color: #0000ff;">double</span> rr;
        <span style="color: #0000ff;">for</span><span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> j<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;j<span style="color: #000080;">&lt;</span><span style="color: #0000dd;">2</span>;j<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span>
        <span style="color: #000000;">&#123;</span>
            <span style="color: #0000ff;">for</span> <span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> i<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;i<span style="color: #000080;">&lt;</span><span style="color: #0000dd;">10</span>;i<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span>
            <span style="color: #000000;">&#123;</span>
                   rr<span style="color: #000080;">=</span>rnd<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
                   wks.<span style="color: #000000;">SetCell</span><span style="color: #000000;">&#40;</span>i,j,rr<span style="color: #000040;">*</span><span style="color: #0000dd;">100</span><span style="color: #000000;">&#41;</span>;
            <span style="color: #000000;">&#125;</span>
        <span style="color: #000000;">&#125;</span>
        DataRange drIn;
        drIn.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;X&quot;</span>, wks, <span style="color: #0000dd;">0</span>, nXCol, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, nXCol<span style="color: #000000;">&#41;</span>;
        drIn.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Y&quot;</span>, wks, <span style="color: #0000dd;">0</span>, nYCol, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, nYCol<span style="color: #000000;">&#41;</span>;

        vector vX, vY;
        DWORD dwRules <span style="color: #000080;">=</span> DRR_GET_MISSING <span style="color: #000040;">|</span> DRR_GET_DEPENDENT <span style="color: #000040;">|</span> DRR_NO_FACTORS;
        DWORD dwPlotID;
        <span style="color: #008000;">// use this overloaded version of GetData to find out how many rows</span>
        drIn.<span style="color: #000000;">GetData</span><span style="color: #000000;">&#40;</span>dwRules, <span style="color: #0000dd;">0</span>, <span style="color: #000040;">&amp;</span>dwPlotID, <span style="color: #0000ff;">NULL</span>, <span style="color: #000040;">&amp;</span>vY, <span style="color: #000040;">&amp;</span>vX<span style="color: #000000;">&#41;</span>;

        <span style="color: #0000ff;">int</span> iSizeIn <span style="color: #000080;">=</span> vX.<span style="color: #000000;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
        <span style="color: #0000ff;">int</span> iSizeOut <span style="color: #000080;">=</span> iSizeIn<span style="color: #000040;">/</span><span style="color: #0000dd;">2</span> <span style="color: #000040;">+</span> <span style="color: #0000dd;">1</span>;
        vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> vIndicesIn;
        vIndicesIn.<span style="color: #000000;">Data</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>, iSizeIn <span style="color: #000040;">-</span> <span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>;
        <span style="color: #008000;">// use this overloaded version of GetData with vIndicesIn to extract even rows to new columns</span>
        drIn.<span style="color: #000000;">GetData</span><span style="color: #000000;">&#40;</span>dwRules, <span style="color: #0000dd;">0</span>, vIndicesIn, vY, vX, <span style="color: #0000ff;">NULL</span><span style="color: #000000;">&#41;</span>;

        string strColDesigs <span style="color: #000080;">=</span> wks.<span style="color: #000000;">GetColDesignations</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
        out_str<span style="color: #000000;">&#40;</span>strColDesigs<span style="color: #000000;">&#41;</span>;
        nXCol <span style="color: #000080;">=</span> wks.<span style="color: #000000;">AddCol</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
        nYCol <span style="color: #000080;">=</span> wks.<span style="color: #000000;">AddCol</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
        strColDesigs <span style="color: #000040;">+</span><span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;XY&quot;</span>;
        wks.<span style="color: #000000;">SetColDesignations</span><span style="color: #000000;">&#40;</span>strColDesigs<span style="color: #000000;">&#41;</span>;

        DataRange drOut;
        drOut.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;X&quot;</span>, wks, <span style="color: #0000dd;">0</span>, nXCol, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, nXCol<span style="color: #000000;">&#41;</span>;
        drOut.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Y&quot;</span>, wks, <span style="color: #0000dd;">0</span>, nYCol, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, nYCol<span style="color: #000000;">&#41;</span>;
        drOut.<span style="color: #000000;">SetData</span><span style="color: #000000;">&#40;</span><span style="color: #000040;">&amp;</span>vY, <span style="color: #000040;">&amp;</span>vX<span style="color: #000000;">&#41;</span>;
    <span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>
<p><b>EX7</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// This example assumes a worksheet with three columns of data is active</span>
<span style="color: #0000ff;">void</span> DataRange_GetData_Ex7<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    Worksheet wks;
    wks.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">int</span> nXCol,nYCol,nZCol;
    nXCol<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;
    nYCol<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
    nZCol<span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>;
    
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> wks <span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        <span style="color: #0000ff;">while</span><span style="color: #000000;">&#40;</span>wks.<span style="color: #000000;">DeleteCol</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;
        
        wks.<span style="color: #000000;">AddCol</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;A&quot;</span><span style="color: #000000;">&#41;</span>;
        wks.<span style="color: #000000;">AddCol</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;B&quot;</span><span style="color: #000000;">&#41;</span>;
        wks.<span style="color: #000000;">AddCol</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;C&quot;</span><span style="color: #000000;">&#41;</span>;
        <span style="color: #0000ff;">double</span> rr;
        <span style="color: #0000ff;">for</span><span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> i<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;i<span style="color: #000080;">&lt;</span><span style="color: #0000dd;">3</span>;i<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span>
        <span style="color: #000000;">&#123;</span>
            <span style="color: #0000ff;">for</span> <span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> j<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;j<span style="color: #000080;">&lt;</span><span style="color: #0000dd;">10</span>;j<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span>
            <span style="color: #000000;">&#123;</span>
                   rr<span style="color: #000080;">=</span>rnd<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
                   wks.<span style="color: #000000;">SetCell</span><span style="color: #000000;">&#40;</span>j,i,rr<span style="color: #000040;">*</span><span style="color: #0000dd;">100</span><span style="color: #000000;">&#41;</span>;
            <span style="color: #000000;">&#125;</span>
        ÔΩù
            
        DataRange drIn;
        drIn.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;X&quot;</span>, wks, <span style="color: #0000dd;">0</span>, nXCol, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, nXCol<span style="color: #000000;">&#41;</span>;
        drIn.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Y&quot;</span>, wks, <span style="color: #0000dd;">0</span>, nYCol, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, nYCol<span style="color: #000000;">&#41;</span>;
        drIn.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Z&quot;</span>, wks, <span style="color: #0000dd;">0</span>, nZCol, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, nZCol<span style="color: #000000;">&#41;</span>;

        vector vX, vY, vZ;
        DWORD dwRules <span style="color: #000080;">=</span> DRR_GET_MISSING <span style="color: #000040;">|</span> DRR_GET_Z_DEPENDENT <span style="color: #000040;">|</span> DRR_NO_FACTORS;
        DWORD dwPlotID;
        <span style="color: #008000;">// Use this overloaded version of GetData to find out how many rows of XYZ data</span>
        drIn.<span style="color: #000000;">GetData</span><span style="color: #000000;">&#40;</span>dwRules, <span style="color: #0000dd;">0</span>, <span style="color: #000040;">&amp;</span>dwPlotID, <span style="color: #0000ff;">NULL</span>, <span style="color: #000040;">&amp;</span>vZ, <span style="color: #000040;">&amp;</span>vX, <span style="color: #0000ff;">NULL</span>, <span style="color: #0000ff;">NULL</span>, <span style="color: #0000ff;">NULL</span>, <span style="color: #0000ff;">NULL</span>, <span style="color: #0000ff;">NULL</span>, <span style="color: #0000ff;">NULL</span>, <span style="color: #000040;">&amp;</span>vY<span style="color: #000000;">&#41;</span>;
        <span style="color: #0000ff;">int</span> iSizeIn <span style="color: #000080;">=</span> vX.<span style="color: #000000;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
        <span style="color: #0000ff;">int</span> iSizeOut <span style="color: #000080;">=</span> iSizeIn<span style="color: #000040;">/</span><span style="color: #0000dd;">2</span> <span style="color: #000040;">+</span> <span style="color: #0000dd;">1</span>;
        vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> vIndicesIn;
        vIndicesIn.<span style="color: #000000;">Data</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span>, iSizeIn <span style="color: #000040;">-</span> <span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>;
        <span style="color: #008000;">// Use this overloaded version of GetData with vIndicesIn to extract odd rows to new columns</span>
        drIn.<span style="color: #000000;">GetData</span><span style="color: #000000;">&#40;</span>dwRules, <span style="color: #0000dd;">0</span>, vIndicesIn, vZ, vX, vY<span style="color: #000000;">&#41;</span>;

        string strColDesigs <span style="color: #000080;">=</span> wks.<span style="color: #000000;">GetColDesignations</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
        nXCol <span style="color: #000080;">=</span> wks.<span style="color: #000000;">AddCol</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
        nYCol <span style="color: #000080;">=</span> wks.<span style="color: #000000;">AddCol</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
        nZCol <span style="color: #000080;">=</span> wks.<span style="color: #000000;">AddCol</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
        strColDesigs <span style="color: #000040;">+</span><span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;XYZ&quot;</span>;
        wks.<span style="color: #000000;">SetColDesignations</span><span style="color: #000000;">&#40;</span>strColDesigs<span style="color: #000000;">&#41;</span>;

        DataRange drOut;
        drOut.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;X&quot;</span>, wks, <span style="color: #0000dd;">0</span>, nXCol, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, nXCol<span style="color: #000000;">&#41;</span>;
        drOut.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Y&quot;</span>, wks, <span style="color: #0000dd;">0</span>, nYCol, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, nYCol<span style="color: #000000;">&#41;</span>;
        drOut.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Z&quot;</span>, wks, <span style="color: #0000dd;">0</span>, nZCol, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, nZCol<span style="color: #000000;">&#41;</span>;
        drOut.<span style="color: #000000;">SetData</span><span style="color: #000000;">&#40;</span><span style="color: #000040;">&amp;</span>vZ, <span style="color: #000040;">&amp;</span>vY, <span style="color: #000040;">&amp;</span>vX<span style="color: #000000;">&#41;</span>;
    <span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>
<p><br />
<b>EX8</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// For this example to run, have two matrices, MBook1 and MBook2, and put some data into MBook2.</span>
<span style="color: #0000ff;">void</span> DataRange_GetData_Ex8<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    DataRange dr;
    string strRange;
    strRange <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;[MBook1]MSheet1!1&quot;</span>;
    <span style="color: #008000;">// Initialize the DataRange object:</span>
    <span style="color: #0000ff;">int</span> nn <span style="color: #000080;">=</span> dr.<span style="color: #000000;">AddInput</span><span style="color: #000000;">&#40;</span>strRange<span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">if</span> <span style="color: #000000;">&#40;</span>nn <span style="color: #000080;">&lt;</span> <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>
        <span style="color: #0000ff;">return</span>;        <span style="color: #008000;">// failed. Perhaps MBook1 does not exist.</span>

    matrix mm;
    Matrix mat2<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;MBook2&quot;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">if</span> <span style="color: #000000;">&#40;</span> dr.<span style="color: #000000;">GetData</span><span style="color: #000000;">&#40;</span>mm<span style="color: #000000;">&#41;</span> <span style="color: #000080;">&lt;=</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Failed to get matrix data&quot;</span><span style="color: #000000;">&#41;</span>;
        <span style="color: #0000ff;">return</span>;
    <span style="color: #000000;">&#125;</span>
    <span style="color: #008000;">// Set the result into mat2:                </span>
    mat2 <span style="color: #000080;">=</span> mm;
 
    <span style="color: #0000ff;">return</span>;
<span style="color: #000000;">&#125;</span></pre>
<p><b>EX9</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">//This example will get the data from the worksheet and do some operation on the data, </span>
<span style="color: #008000;">//then put the data to another three columns.</span>
<span style="color: #0000ff;">void</span> DataRange_GetData_Ex9<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
   <span style="color: #008000;">//Creat a worksheet with XYZ columns and fill with data.</span>
	Worksheet wks;
	wks.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;origin&quot;</span><span style="color: #000000;">&#41;</span>;
	wks.<span style="color: #000000;">AddCol</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	wks.<span style="color: #000000;">SetColDesignations</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;XYZ&quot;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #0000ff;">for</span> <span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> ii<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>; ii<span style="color: #000080;">&lt;</span><span style="color: #0000dd;">20</span>; ii<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		wks.<span style="color: #000000;">SetCell</span><span style="color: #000000;">&#40;</span>ii,<span style="color: #0000dd;">0</span>,ii<span style="color: #000000;">&#41;</span>;
		wks.<span style="color: #000000;">SetCell</span><span style="color: #000000;">&#40;</span>ii,<span style="color: #0000dd;">1</span>,ii<span style="color: #000040;">+</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
		wks.<span style="color: #000000;">SetCell</span><span style="color: #000000;">&#40;</span>ii,<span style="color: #0000dd;">2</span>,ii<span style="color: #000040;">*</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">&#125;</span>
	
    <span style="color: #008000;">//Get XYZ data.</span>
	DataRange dr;
	dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">0</span>, <span style="color: #ff00ff;">&quot;X&quot;</span><span style="color: #000000;">&#41;</span>;
	dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">1</span>, <span style="color: #ff00ff;">&quot;Y&quot;</span><span style="color: #000000;">&#41;</span>;
	dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">2</span>, <span style="color: #ff00ff;">&quot;Z&quot;</span><span style="color: #000000;">&#41;</span>;
	
	STDRGETDATAARGS gd;
	vector vX,vY,vZ;
	DWORD dwPlotID;
	gd.<span style="color: #000000;">nIndex</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
	gd.<span style="color: #000000;">pv</span> <span style="color: #000080;">=</span> <span style="color: #000040;">&amp;</span>vZ;
	gd.<span style="color: #000000;">pvIndep</span> <span style="color: #000080;">=</span> <span style="color: #000040;">&amp;</span>vX;
	gd.<span style="color: #000000;">pvYIndep</span> <span style="color: #000080;">=</span> <span style="color: #000040;">&amp;</span>vY;
	gd.<span style="color: #000000;">dwRules</span> <span style="color: #000080;">=</span> DRR_GET_MISSING <span style="color: #000040;">|</span>  DRR_GET_Z_DEPENDENT <span style="color: #000040;">|</span> DRR_NO_FACTORS;
	gd.<span style="color: #000000;">pouidAux</span> <span style="color: #000080;">=</span> <span style="color: #000040;">&amp;</span>dwPlotID;
	
    <span style="color: #008000;">//To get data from Worksheet XYZ columns to vX, vY, vZ vector.</span>
	dr.<span style="color: #000000;">GetData</span><span style="color: #000000;">&#40;</span>gd<span style="color: #000000;">&#41;</span>;
	
	vX<span style="color: #000040;">*</span><span style="color: #000080;">=</span><span style="color: #0000dd;">10.0</span>;
	vY<span style="color: #000040;">+</span><span style="color: #000080;">=</span><span style="color: #0000dd;">20.0</span>;
	vZ<span style="color: #000040;">-</span><span style="color: #000080;">=</span><span style="color: #0000dd;">30.0</span>;

    <span style="color: #008000;">//Add XYZ columns in the worksheet.	</span>
	string strColDesigs <span style="color: #000080;">=</span> wks.<span style="color: #000000;">GetColDesignations</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">int</span> nXCol <span style="color: #000080;">=</span> wks.<span style="color: #000000;">AddCol</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">int</span> nYCol <span style="color: #000080;">=</span> wks.<span style="color: #000000;">AddCol</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">int</span> nZCol <span style="color: #000080;">=</span> wks.<span style="color: #000000;">AddCol</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    wks.<span style="color: #000000;">SetColDesignations</span><span style="color: #000000;">&#40;</span>strColDesigs<span style="color: #000000;">&#41;</span>;
    
    <span style="color: #008000;">//Set data in the new columns.</span>
    DataRange drOut;
    drOut.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>wks, nXCol, <span style="color: #ff00ff;">&quot;X&quot;</span><span style="color: #000000;">&#41;</span>;
    drOut.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>wks, nYCol, <span style="color: #ff00ff;">&quot;Y&quot;</span><span style="color: #000000;">&#41;</span>;
    drOut.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>wks, nZCol, <span style="color: #ff00ff;">&quot;Z&quot;</span><span style="color: #000000;">&#41;</span>;
    
    drOut.<span style="color: #000000;">SetData</span><span style="color: #000000;">&#40;</span><span style="color: #000040;">&amp;</span>vZ, <span style="color: #000040;">&amp;</span>vY, <span style="color: #000040;">&amp;</span>vX<span style="color: #000000;">&#41;</span>;
	
<span style="color: #000000;">&#125;</span></pre>
<p><b>EX10</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">//This example will get the data from the worksheet selection, include label area</span>
<span style="color: #0000ff;">void</span> GetDataFromSelection<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #000040;">!</span>wks <span style="color: #000000;">&#41;</span> 
		<span style="color: #0000ff;">return</span>;
	
	Grid gg;
	<span style="color: #0000ff;">int</span> iRegions;	
	vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> vr1, vc1, vr2, vc2;	
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> gg.<span style="color: #000000;">Attach</span><span style="color: #000000;">&#40;</span>wks<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span> 
		iRegions <span style="color: #000080;">=</span> gg.<span style="color: #000000;">GetSelection</span><span style="color: #000000;">&#40;</span>vr1, vc1, vr2, vc2, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;
	
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> iRegions <span style="color: #000000;">&#41;</span>    
	<span style="color: #000000;">&#123;</span>
		<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;No range selected in&#160;%s!&quot;</span>, wks.<span style="color: #000000;">GetName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; 
		<span style="color: #0000ff;">return</span>; 
	<span style="color: #000000;">&#125;</span>		
	
	vector<span style="color: #000080;">&lt;</span>string<span style="color: #000080;">&gt;</span> vsData;
	<span style="color: #0000ff;">for</span><span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>&#160;; ii <span style="color: #000080;">&lt;</span> iRegions; ii<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span> 
	<span style="color: #000000;">&#123;</span>
		DataRange dr;
		dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Range&quot;</span>, wks, vr1<span style="color: #000000;">&#91;</span>ii<span style="color: #000000;">&#93;</span>, vc1<span style="color: #000000;">&#91;</span>ii<span style="color: #000000;">&#93;</span>, vr2<span style="color: #000000;">&#91;</span>ii<span style="color: #000000;">&#93;</span>, vc2<span style="color: #000000;">&#91;</span>ii<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span>; 	
		dr.<span style="color: #000000;">GetData</span><span style="color: #000000;">&#40;</span>vsData, <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">&#125;</span>
	out_int<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Data Size=&quot;</span>, vsData.<span style="color: #000000;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;
	out_str<span style="color: #000000;">&#40;</span>vsData<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Remark"></a><span class="mw-headline">Remark</span></h2>
<h2><a name="See_Also"></a><span class="mw-headline">See Also</span></h2>
<p><a href="../../OriginC/OriginC/Curve-Curve.html" title="OriginC:Curve-Curve">Curve::Curve</a>,<a href="../../OriginC/OriginC/Curvebase-AttachX.html" title="OriginC:Curvebase-AttachX">curvebase::AttachX</a>,<a href="../../OriginC/OriginC/DataRange-GetMaskedData.html" title="OriginC:DataRange-GetMaskedData">DataRange::GetMaskedData</a>,<a href="../../OriginC/OriginC/DataRange-GetMissingData.html" title="OriginC:DataRange-GetMissingData">DataRange::GetMissingData</a>,<a href="../../OriginC/OriginC/DataRange-GetNumData.html" title="OriginC:DataRange-GetNumData">DataRange::GetNumData</a>,<a href="../../OriginC/OriginC/DataRange-SetData.html" title="OriginC:DataRange-SetData">DataRange::SetData</a>
</p>
<h2><a name="Header_to_Include"></a><span class="mw-headline">Header to Include</span></h2>
<p>origin.h
</p>





