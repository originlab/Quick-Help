<h1 class="firstHeading">2.1.11.12 ocmath_diagnostic_residuals</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Syntax"><span class="tocnumber">2</span> <span class="toctext">Syntax</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Parameters"><span class="tocnumber">3</span> <span class="toctext">Parameters</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Return"><span class="tocnumber">4</span> <span class="toctext">Return</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Examples"><span class="tocnumber">5</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Remark"><span class="tocnumber">6</span> <span class="toctext">Remark</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#See_Also"><span class="tocnumber">7</span> <span class="toctext">See Also</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Header_to_Include"><span class="tocnumber">8</span> <span class="toctext">Header to Include</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Reference"><span class="tocnumber">9</span> <span class="toctext">Reference</span></a></li>
</ul>
</div>

<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>Function to compute diagnostic residual for fits(NLSF, LR, PR and MR)
</p>
<h2><a name="Syntax"></a><span class="mw-headline">Syntax</span></h2>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">int</span> ocmath_diagnostic_residuals<span style="color: #000000;">&#40;</span> <span style="color: #0000ff;">const</span> <span style="color: #0000ff;">int</span> nSize, <span style="color: #0000ff;">const</span> <span style="color: #0000ff;">int</span> nParam, <span style="color: #0000ff;">const</span> <span style="color: #0000ff;">double</span> dSSE, <span style="color: #0000ff;">int</span> nResid, <span style="color: #0000ff;">const</span> <span style="color: #0000ff;">double</span> <span style="color: #000040;">*</span> pResid, <span style="color: #0000ff;">const</span> <span style="color: #0000ff;">double</span> <span style="color: #000040;">*</span> pX, <span style="color: #0000ff;">double</span> <span style="color: #000040;">*</span> pStadRes, <span style="color: #0000ff;">double</span> <span style="color: #000040;">*</span> pStudRes, <span style="color: #0000ff;">double</span> <span style="color: #000040;">*</span> pStudDelRes, <span style="color: #0000ff;">double</span> <span style="color: #000040;">*</span> pCook, <span style="color: #0000ff;">double</span> <span style="color: #000040;">*</span> pAtkinson, <span style="color: #0000ff;">double</span> <span style="color: #000040;">*</span> pH <span style="color: #000080;">=</span> <span style="color: #0000ff;">NULL</span> <span style="color: #000000;">&#41;</span></pre>
<h2><a name="Parameters"></a><span class="mw-headline">Parameters</span></h2>
<dl><dt> nSize</dt>
<dd>[input] the number of data points</dd>
<dt> nParam</dt>
<dd>[input] the number of parameters fit by the regression.</dd>
<dt> dSSE</dt>
<dd>[input] the sum of square of residuals</dd>
<dt> nResid</dt>
<dd>[input] size of residuals</dd>
<dt> pResid</dt>
<dd>[input] pointer to residuals in the fits</dd>
<dt> pX</dt>
<dd>[input] pointer to matix of X, which is X in MR and partial derivatives matrix in NLSF</dd>
<dd>the matrix should have nParam columns and nSize rows. The variable won't be used if pH is specified</dd>
<dt> pStadRes</dt>
<dd>[output] pointer to stardardized residual. Its size is nResid</dd>
<dt> pStudRes</dt>
<dd>[output] pointer to studentized residual. Its size is nResid</dd>
<dt> pStudDelRes</dt>
<dd>[output] pointer to studentized deleted residual. Its size is nResid</dd>
<dt> pCook</dt>
<dd>[output] pointer to Cook'sD statistic. Its size is nResid</dd>
<dt> pAtkinson</dt>
<dd>[output] pointer to Atkinson's T statistic. Its size is nResid</dd>
<dt> pH</dt>
<dd>[input] optional output pointer to leverage. Only needed in MR. Its size is nSize</dd></dl>
<h2><a name="Return"></a><span class="mw-headline">Return</span></h2>
<p>Returns STATS_NO_ERROR on successful exit and a non-zero STATS error code on failure.
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p><b>EX1</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">//The example find studentized residuals for 2 order polynomial fit</span>
<span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>FDFTree.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span>
<span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>ONLSF.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span>
<span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>ocStats.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span>
<span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>stats_utils.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span>
<span style="color: #0000ff;">void</span> ocmath_diagnostic_residuals_ex1<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    string        strFDF <span style="color: #000080;">=</span> okutil_get_origin_path<span style="color: #000000;">&#40;</span>ORIGIN_PATH_SYSTEM, <span style="color: #ff00ff;">&quot;FitFunc&quot;</span><span style="color: #000000;">&#41;</span><span style="color: #000040;">+</span><span style="color: #ff00ff;">&quot;PARABOLA.FDF&quot;</span>;
    <span style="color: #0000ff;">int</span> nParam <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>; <span style="color: #008000;">//2th Order polynomial has 3 parameters. </span>
    Tree tr;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #000040;">!</span>nlsf_FDF_to_tree<span style="color: #000000;">&#40;</span> strFDF, <span style="color: #000040;">&amp;</span>tr <span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>
        <span style="color: #0000ff;">return</span>;
    
    NumericFunction    NF;
    NF.<span style="color: #000000;">SetTree</span><span style="color: #000000;">&#40;</span>tr<span style="color: #000000;">&#41;</span>;

    vector        vParas;
    vParas.<span style="color: #000000;">SetSize</span><span style="color: #000000;">&#40;</span>nParam<span style="color: #000000;">&#41;</span>;
    vParas<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">11.2717</span>;        <span style="color: #008000;">// a</span>
    vParas<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">3.81714</span>;        <span style="color: #008000;">// b</span>
    vParas<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0.4619</span>;    <span style="color: #008000;">// c</span>
    
    <span style="color: #008000;">// X-values:</span>
    <span style="color: #008000;">//vector vY={4, 3.3, 3.5, 3.8, 4.2, 5};</span>
    vector vX<span style="color: #000080;">=</span><span style="color: #000000;">&#123;</span><span style="color: #0000dd;">3</span>,<span style="color: #0000dd;">4</span>,<span style="color: #0000dd;">4.5</span>,<span style="color: #0000dd;">5</span>,<span style="color: #0000dd;">5.5</span>, <span style="color: #0000dd;">6</span><span style="color: #000000;">&#125;</span>; 
    <span style="color: #0000ff;">int</span>    nNumPts <span style="color: #000080;">=</span> vX.<span style="color: #000000;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;

    vector vA, vB, vC;
    vA.<span style="color: #000000;">SetSize</span><span style="color: #000000;">&#40;</span>nNumPts<span style="color: #000000;">&#41;</span>;
    vB.<span style="color: #000000;">SetSize</span><span style="color: #000000;">&#40;</span>nNumPts<span style="color: #000000;">&#41;</span>;
    vC.<span style="color: #000000;">SetSize</span><span style="color: #000000;">&#40;</span>nNumPts<span style="color: #000000;">&#41;</span>;
    
    <span style="color: #0000ff;">for</span> <span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> ipt <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; ipt <span style="color: #000080;">&lt;</span> nNumPts; ipt<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        <span style="color: #0000ff;">double</span>            arrPartialDerivs<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#93;</span>;
        <span style="color: #0000ff;">BOOL</span>            bb <span style="color: #000080;">=</span> NF.<span style="color: #000000;">EvalPartialDerivatives</span><span style="color: #000000;">&#40;</span>vParas, arrPartialDerivs, vX<span style="color: #000000;">&#91;</span>ipt<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span>;
        <span style="color: #0000ff;">if</span> <span style="color: #000000;">&#40;</span><span style="color: #000040;">!</span>bb<span style="color: #000000;">&#41;</span>
        <span style="color: #000000;">&#123;</span>
            out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Failed!&quot;</span><span style="color: #000000;">&#41;</span>;
            <span style="color: #0000ff;">return</span>;
        <span style="color: #000000;">&#125;</span>
        
        vA<span style="color: #000000;">&#91;</span>ipt<span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> arrPartialDerivs<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#93;</span>;
        vB<span style="color: #000000;">&#91;</span>ipt<span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> arrPartialDerivs<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span>;
        vC<span style="color: #000000;">&#91;</span>ipt<span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> arrPartialDerivs<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#93;</span>;
    <span style="color: #000000;">&#125;</span>
    
    matrix mDerivX; <span style="color: #008000;">//Patial derivative matrix</span>
    mDerivX.<span style="color: #000000;">SetSize</span><span style="color: #000000;">&#40;</span>nNumPts, nParam<span style="color: #000000;">&#41;</span>;
    mDerivX.<span style="color: #000000;">SetColumn</span><span style="color: #000000;">&#40;</span>vA, <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
    mDerivX.<span style="color: #000000;">SetColumn</span><span style="color: #000000;">&#40;</span>vB, <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
    mDerivX.<span style="color: #000000;">SetColumn</span><span style="color: #000000;">&#40;</span>vC, <span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>;
    
    <span style="color: #0000ff;">double</span> dSSE <span style="color: #000080;">=</span> <span style="color: #0000dd;">0.00629</span>;
    vector vRes <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">0.0226</span>, <span style="color: #000040;">-</span><span style="color: #0000dd;">0.0936</span>, <span style="color: #0000dd;">0.0519</span>, <span style="color: #0000dd;">0.0664</span>, <span style="color: #000040;">-</span><span style="color: #0000dd;">0.0500</span>, <span style="color: #0000dd;">0.0026</span><span style="color: #000000;">&#125;</span>;
    DiagResid psDiagResid_1<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">8</span><span style="color: #000000;">&#93;</span>;
    vector vStad<span style="color: #000000;">&#40;</span>nNumPts<span style="color: #000000;">&#41;</span>, vStud<span style="color: #000000;">&#40;</span>nNumPts<span style="color: #000000;">&#41;</span>, vStudDel<span style="color: #000000;">&#40;</span>nNumPts<span style="color: #000000;">&#41;</span>, vCook<span style="color: #000000;">&#40;</span>nNumPts<span style="color: #000000;">&#41;</span>, vAtkinson<span style="color: #000000;">&#40;</span>nNumPts<span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">int</span> nRet <span style="color: #000080;">=</span> ocmath_diagnostic_residuals<span style="color: #000000;">&#40;</span>nNumPts, nParam, dSSE, vRes.<span style="color: #000000;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>, vRes, mDerivX, vStad, vStud, vStudDel, vCook, vAtkinson<span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<p><b>EX2</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>stats_utils.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span>
<span style="color: #0000ff;">void</span> ocmath_diagnostic_residuals_ex2<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    <span style="color: #0000ff;">int</span> nRet;
    
    UINT nPts,nM;
    uint nSizeFitParams;
    LROptions psLROptions;
    RegStats stRegStats;
    RegANOVA stRegANOVA;
    matrix mX<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">6</span>,<span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span><span style="color: #000000;">&#123;</span><span style="color: #000000;">&#123;</span><span style="color: #0000dd;">1</span>,   <span style="color: #0000dd;">2</span>,   <span style="color: #0000dd;">3</span><span style="color: #000000;">&#125;</span>,
                     <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">3.2</span>, <span style="color: #0000dd;">1.1</span>, <span style="color: #0000dd;">3.4</span><span style="color: #000000;">&#125;</span>,
                     <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">1</span>,   <span style="color: #0000dd;">2.6</span>, <span style="color: #0000dd;">5</span><span style="color: #000000;">&#125;</span>,
                     <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">5</span>,   <span style="color: #0000dd;">5</span>,   <span style="color: #0000dd;">2.1</span><span style="color: #000000;">&#125;</span>,
                     <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">1</span>,   <span style="color: #0000dd;">6</span>,   <span style="color: #0000dd;">7</span><span style="color: #000000;">&#125;</span>,
                     <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">2</span>,    <span style="color: #0000dd;">8</span>,    <span style="color: #0000dd;">10</span><span style="color: #000000;">&#125;</span><span style="color: #000000;">&#125;</span>;
    vector vY <span style="color: #000080;">=</span><span style="color: #000000;">&#123;</span><span style="color: #0000dd;">4</span>,<span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">6</span>, <span style="color: #0000dd;">7</span>, <span style="color: #0000dd;">8</span>, <span style="color: #0000dd;">10</span><span style="color: #000000;">&#125;</span>;
    vector vWeight <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">1</span><span style="color: #000000;">&#125;</span>;
    psLROptions.<span style="color: #000000;">FixIntercept</span> <span style="color: #000080;">=</span> <span style="color: #0000ff;">false</span>;
    psLROptions.<span style="color: #000000;">Confidence</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0.95</span>;
    FitParameter psFitParameter_1<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">4</span><span style="color: #000000;">&#93;</span>;
    vector vH, vSE;
    matrix mCov, mCorr;
    nRet <span style="color: #000080;">=</span> stats_multiple_linear_regression<span style="color: #000000;">&#40;</span>mX, vY, vWeight, psLROptions, psFitParameter_1, <span style="color: #0000dd;">4</span>, <span style="color: #000040;">&amp;</span>stRegStats, <span style="color: #000040;">&amp;</span>stRegANOVA, mCov, mCorr, vH, vSE<span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">if</span> <span style="color: #000000;">&#40;</span>nRet <span style="color: #000040;">!</span><span style="color: #000080;">=</span> STATS_NO_ERROR<span style="color: #000000;">&#41;</span>
        <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;error in stats_multiple_linear_regression&quot;</span><span style="color: #000000;">&#41;</span>;

    vector vRes <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #000040;">-</span><span style="color: #0000dd;">0.46398</span>, <span style="color: #000040;">-</span><span style="color: #0000dd;">0.49247</span>, <span style="color: #0000dd;">1.1874</span>, <span style="color: #0000dd;">0.26653</span>, <span style="color: #000040;">-</span><span style="color: #0000dd;">0.5148</span>, <span style="color: #0000dd;">0.01732</span><span style="color: #000000;">&#125;</span>;
    <span style="color: #0000ff;">int</span> nNumPts <span style="color: #000080;">=</span> mX.<span style="color: #000000;">GetNumRows</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">int</span> nParam <span style="color: #000080;">=</span> mX.<span style="color: #000000;">GetNumCols</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000040;">+</span> <span style="color: #0000dd;">1</span>;
    vector vStad<span style="color: #000000;">&#40;</span>nNumPts<span style="color: #000000;">&#41;</span>, vStud<span style="color: #000000;">&#40;</span>nNumPts<span style="color: #000000;">&#41;</span>, vStudDel<span style="color: #000000;">&#40;</span>nNumPts<span style="color: #000000;">&#41;</span>, vCook<span style="color: #000000;">&#40;</span>nNumPts<span style="color: #000000;">&#41;</span>, vAtkinson<span style="color: #000000;">&#40;</span>nNumPts<span style="color: #000000;">&#41;</span>;
    nRet <span style="color: #000080;">=</span> ocmath_diagnostic_residuals<span style="color: #000000;">&#40;</span>nNumPts, nParam, stRegStats.<span style="color: #000000;">ReducedChiSq</span>, vRes.<span style="color: #000000;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>, vRes, mX, vStad, vStud, vStudDel, vCook, vAtkinson, vH<span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">if</span> <span style="color: #000000;">&#40;</span>nRet <span style="color: #000040;">!</span><span style="color: #000080;">=</span> STATS_NO_ERROR<span style="color: #000000;">&#41;</span>
        <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;error in ocmath_diagnostic_residuals&quot;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Remark"></a><span class="mw-headline">Remark</span></h2>
<h2><a name="See_Also"></a><span class="mw-headline">See Also</span></h2>
<h2><a name="Header_to_Include"></a><span class="mw-headline">Header to Include</span></h2>
<p>origin.h
</p>
<h2><a name="Reference"></a><span class="mw-headline">Reference</span></h2>






