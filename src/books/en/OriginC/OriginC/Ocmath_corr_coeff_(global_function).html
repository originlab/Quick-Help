<h1 class="firstHeading">2.1.24.4.14 ocmath_corr_coeff</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Syntax"><span class="tocnumber">2</span> <span class="toctext">Syntax</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Parameters"><span class="tocnumber">3</span> <span class="toctext">Parameters</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Return"><span class="tocnumber">4</span> <span class="toctext">Return</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Examples"><span class="tocnumber">5</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Remark"><span class="tocnumber">6</span> <span class="toctext">Remark</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#See_Also"><span class="tocnumber">7</span> <span class="toctext">See Also</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Header_to_Included"><span class="tocnumber">8</span> <span class="toctext">Header to Included</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Reference"><span class="tocnumber">9</span> <span class="toctext">Reference</span></a></li>
</ul>
</div>

<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>Calculates Pearson rank, Spearman rank and Kendall rank correlation coefficients. This is an OriginPro only function.
</p>
<h2><a name="Syntax"></a><span class="mw-headline">Syntax</span></h2>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">int</span> ocmath_corr_coeff<span style="color: #000000;">&#40;</span> UINT nRows, UINT nCols, <span style="color: #0000ff;">const</span> <span style="color: #0000ff;">double</span> <span style="color: #000040;">*</span> pData, <span style="color: #0000ff;">double</span> <span style="color: #000040;">*</span> pPeaCorr, <span style="color: #0000ff;">double</span> <span style="color: #000040;">*</span> pPeaSig, <span style="color: #0000ff;">double</span> <span style="color: #000040;">*</span> pSpeCorr, <span style="color: #0000ff;">double</span> <span style="color: #000040;">*</span> pSpeSig, <span style="color: #0000ff;">double</span> <span style="color: #000040;">*</span> pKenCorr, <span style="color: #0000ff;">double</span> <span style="color: #000040;">*</span> pKenSig, <span style="color: #0000ff;">int</span> nExcludeMissing <span style="color: #000080;">=</span> CORR_EXCLUDE_MISSING_PAIRWISE <span style="color: #000000;">&#41;</span></pre>
<h2><a name="Parameters"></a><span class="mw-headline">Parameters</span></h2>
<dl><dt> nRows</dt>
<dd>[input]row number of data matrix</dd>
<dt> nCols</dt>
<dd>[input]column number of data matrix</dd>
<dt> pData</dt>
<dd>[input]pointer to data points</dd>
<dt> pPeaCorr</dt>
<dd>[Output]pointer to matrix of Pearson rank correlation coefficients. Size of matrix should be nCols*nCols.</dd>
<dt> pPeaSig</dt>
<dd>[Output]pointer to matrix of Pearson rank correlation significants. Size of matrix should be nCols*nCols. Diagonal should be NANUM</dd>
<dt> pSpeCorr</dt>
<dd>[Output]pointer to matrix of Spearman rank correlation coefficients. Size of matrix should be nCols*nCols.</dd>
<dt> pSpeSig</dt>
<dd>[Output]pointer to matrix of Spearman rank correlation significants. Size of matrix should be nCols*nCols. Diagonal should be NANUM</dd>
<dt> pKenCorr</dt>
<dd>[Output]pointer to matrix of Kendall rank correlation coefficients. Size of matrix should be nCols*nCols.</dd>
<dt> pKenSig</dt>
<dd>[Output]pointer to matrix of Kendall rank correlation significants. Size of matrix should be nCols*nCols. Diagonal should be NANUM</dd>
<dt> nExcludeMissing</dt>
<dd>[input] if set as CORR_EXCLUDE_MISSING_PAIRWISE, will exclude the row when the whole row are missing values,</dd>
<dd>if set as CORR_EXCLUDE_MISSING_LISTWISE, will exclude the row when any cell is with mising value in that row.</dd></dl>
<h2><a name="Return"></a><span class="mw-headline">Return</span></h2>
<p>Returns STATS_NO_ERROR on successful exit or an STATS error code on failure.
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p><b>EX1</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">void</span> ocmath_corr_coeff_Ex1<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    matrix mData <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #000000;">&#123;</span><span style="color: #0000dd;">10</span>,<span style="color: #0000dd;">12</span>,<span style="color: #0000dd;">13</span>,<span style="color: #0000dd;">11</span><span style="color: #000000;">&#125;</span>,<span style="color: #000000;">&#123;</span><span style="color: #0000dd;">13</span>,<span style="color: #0000dd;">10</span>,<span style="color: #0000dd;">11</span>,<span style="color: #0000dd;">12</span><span style="color: #000000;">&#125;</span>,<span style="color: #000000;">&#123;</span><span style="color: #0000dd;">9</span>,<span style="color: #0000dd;">12</span>,<span style="color: #0000dd;">10</span>,<span style="color: #0000dd;">11</span><span style="color: #000000;">&#125;</span><span style="color: #000000;">&#125;</span>;
    <span style="color: #0000ff;">double</span> <span style="color: #000040;">*</span>pmData <span style="color: #000080;">=</span> mData;
    
    <span style="color: #0000ff;">int</span> nRet;
    <span style="color: #0000ff;">int</span> nRows <span style="color: #000080;">=</span> mData.<span style="color: #000000;">GetNumRows</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">int</span> nCols <span style="color: #000080;">=</span> mData.<span style="color: #000000;">GetNumCols</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    
    <span style="color: #0000ff;">double</span><span style="color: #000040;">*</span> pmPeaCov <span style="color: #000080;">=</span> <span style="color: #0000ff;">NULL</span>;
    <span style="color: #0000ff;">double</span><span style="color: #000040;">*</span> pmPeaSig <span style="color: #000080;">=</span> <span style="color: #0000ff;">NULL</span>;
    matrix mPeaCorr<span style="color: #000000;">&#40;</span>nCols, nCols<span style="color: #000000;">&#41;</span>;
    matrix mPeaSig<span style="color: #000000;">&#40;</span>nCols, nCols<span style="color: #000000;">&#41;</span>;
    pmPeaCov <span style="color: #000080;">=</span> mPeaCorr;
    pmPeaSig <span style="color: #000080;">=</span> mPeaSig;    
    
    <span style="color: #0000ff;">double</span><span style="color: #000040;">*</span> pmSpeCov <span style="color: #000080;">=</span> <span style="color: #0000ff;">NULL</span>;
    <span style="color: #0000ff;">double</span><span style="color: #000040;">*</span> pmSpeSig <span style="color: #000080;">=</span> <span style="color: #0000ff;">NULL</span>;
    matrix mSpeCorr<span style="color: #000000;">&#40;</span>nCols, nCols<span style="color: #000000;">&#41;</span>;
    matrix mSpeSig<span style="color: #000000;">&#40;</span>nCols, nCols<span style="color: #000000;">&#41;</span>;
    pmSpeCov <span style="color: #000080;">=</span> mSpeCorr;
    pmSpeSig <span style="color: #000080;">=</span> mSpeSig;    
    
    <span style="color: #0000ff;">double</span><span style="color: #000040;">*</span> pmKenCov <span style="color: #000080;">=</span> <span style="color: #0000ff;">NULL</span>;
    <span style="color: #0000ff;">double</span><span style="color: #000040;">*</span> pmKenSig <span style="color: #000080;">=</span> <span style="color: #0000ff;">NULL</span>;
    matrix mKenCorr<span style="color: #000000;">&#40;</span>nCols, nCols<span style="color: #000000;">&#41;</span>;
    matrix mKenSig<span style="color: #000000;">&#40;</span>nCols, nCols<span style="color: #000000;">&#41;</span>;
    pmKenCov <span style="color: #000080;">=</span> mKenCorr;
    pmKenSig <span style="color: #000080;">=</span> mKenSig;    
        
    nRet <span style="color: #000080;">=</span> ocmath_corr_coeff<span style="color: #000000;">&#40;</span>nRows, nCols, pmData, pmPeaCov, pmPeaSig, pmSpeCov, pmSpeSig, pmKenCov, pmKenSig<span style="color: #000000;">&#41;</span>;
    out_int<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;nRet=&quot;</span>, nRet<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// print out return value.</span>
    
    <span style="color: #0000ff;">int</span> ii, jj;
    out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Pearson&quot;</span><span style="color: #000000;">&#41;</span>;<span style="color: #008000;">//print out Pearson rank correlation coefficients</span>
    <span style="color: #0000ff;">for</span><span style="color: #000000;">&#40;</span>ii<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>; ii<span style="color: #000080;">&lt;</span>mPeaCorr.<span style="color: #000000;">GetNumRows</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; ii<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span> 
    <span style="color: #000000;">&#123;</span>
        <span style="color: #0000ff;">for</span><span style="color: #000000;">&#40;</span>jj <span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>; jj<span style="color: #000080;">&lt;</span>mPeaCorr.<span style="color: #000000;">GetNumCols</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; jj<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span>
            <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;%f<span style="color: #666666; font-weight: bold;">\t</span>&quot;</span>, mPeaCorr<span style="color: #000000;">&#91;</span>ii<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#91;</span>jj<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span>;
        <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #000000;">&#125;</span>
    
    out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Spearman&quot;</span><span style="color: #000000;">&#41;</span>;<span style="color: #008000;">//print out Spearman rank correlation coefficients</span>
    <span style="color: #0000ff;">for</span><span style="color: #000000;">&#40;</span>ii<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>; ii<span style="color: #000080;">&lt;</span>mSpeCorr.<span style="color: #000000;">GetNumRows</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; ii<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        <span style="color: #0000ff;">for</span><span style="color: #000000;">&#40;</span>jj <span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>; jj<span style="color: #000080;">&lt;</span>mSpeCorr.<span style="color: #000000;">GetNumCols</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; jj<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span>
            <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;%f<span style="color: #666666; font-weight: bold;">\t</span>&quot;</span>, mSpeCorr<span style="color: #000000;">&#91;</span>ii<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#91;</span>jj<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span>;
        <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #000000;">&#125;</span>
    
    out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Kendall&quot;</span><span style="color: #000000;">&#41;</span>;<span style="color: #008000;">//print out Kendall rank correlation coefficients</span>
    <span style="color: #0000ff;">for</span><span style="color: #000000;">&#40;</span>ii<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>; ii<span style="color: #000080;">&lt;</span>mKenCorr.<span style="color: #000000;">GetNumRows</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; ii<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        <span style="color: #0000ff;">for</span><span style="color: #000000;">&#40;</span>jj <span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>; jj<span style="color: #000080;">&lt;</span>mKenCorr.<span style="color: #000000;">GetNumCols</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; jj<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span>
            <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;%f<span style="color: #666666; font-weight: bold;">\t</span>&quot;</span>, mKenCorr<span style="color: #000000;">&#91;</span>ii<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#91;</span>jj<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span>;
        <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Remark"></a><span class="mw-headline">Remark</span></h2>
<h2><a name="See_Also"></a><span class="mw-headline">See Also</span></h2>
<h2><a name="Header_to_Included"></a><span class="mw-headline">Header to Included</span></h2>
<p>origin.h
</p>
<h2><a name="Reference"></a><span class="mw-headline">Reference</span></h2>






