<h1 class="firstHeading">3.3.15 Contour Plot from an XYZ Worksheet</h1><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Plot_XYZ_Contour_from_Worksheet_and_Custom_Lines"><span class="tocnumber">1</span> <span class="toctext">Plot XYZ Contour from Worksheet and Custom Lines</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Plot_XYZ_Contour_from_Worksheet_and_Custom_Labels"><span class="tocnumber">2</span> <span class="toctext">Plot XYZ Contour from Worksheet and Custom Labels</span></a></li>
</ul>
</div>

<h2><a name="Plot_XYZ_Contour_from_Worksheet_and_Custom_Lines"></a><span class="mw-headline">Plot XYZ Contour from Worksheet and Custom Lines</span></h2>
<p class="version" >Minimum Origin Version Required: Origin 8 SR0</p>
<p>This example to show how to plot XYZ contour and custom line colors, line styles, line thicknesses.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">void</span> plot_xyz_contour_ex1<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	<span style="color: #0000ff;">int</span> npts <span style="color: #000080;">=</span> <span style="color: #0000dd;">30</span>;
	Worksheet wks;
	wks.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;	    
	wks.<span style="color: #000000;">SetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>;
	wks.<span style="color: #000000;">SetColDesignations</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;XYZ&quot;</span><span style="color: #000000;">&#41;</span>;
	
	<span style="color: #008000;">// fill wks with some XYZ data</span>
	Dataset dsX<span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
	Dataset dsY<span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
	Dataset dsZ<span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>;
	dsX.<span style="color: #000000;">Data</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>, npts<span style="color: #000000;">&#41;</span>;
	dsX <span style="color: #000040;">*</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">0.05</span>;
	dsY.<span style="color: #000000;">Normal</span><span style="color: #000000;">&#40;</span>npts<span style="color: #000000;">&#41;</span>;
	dsY <span style="color: #000040;">+</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">1.2</span>;
	dsZ.<span style="color: #000000;">Normal</span><span style="color: #000000;">&#40;</span>npts<span style="color: #000000;">&#41;</span>;
	
	<span style="color: #008000;">// then we construct the XYZ data range</span>
	DataRange dr;
	dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">0</span>, <span style="color: #ff00ff;">&quot;X&quot;</span><span style="color: #000000;">&#41;</span>;
	dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">1</span>, <span style="color: #ff00ff;">&quot;Y&quot;</span><span style="color: #000000;">&#41;</span>;
	dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">2</span>, <span style="color: #ff00ff;">&quot;Z&quot;</span><span style="color: #000000;">&#41;</span>;
	
	<span style="color: #008000;">// in this example, we will create a new graph, but you can use any exisitng graph layer</span>
	<span style="color: #008000;">// as long as the layer is a 2D layer</span>
	GraphPage gp;
	<span style="color: #008000;">// You must use a 3D scatter/line template, you can first make a 3d scatter plot, </span>
	<span style="color: #008000;">// make needed modifications, then save your own</span>
	gp.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;TriContour&quot;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> gp <span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		GraphLayer gl <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
		<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> gl <span style="color: #000000;">&#41;</span>
		<span style="color: #000000;">&#123;</span>
			<span style="color: #0000ff;">int</span> nPlot <span style="color: #000080;">=</span> gl.<span style="color: #000000;">AddPlot</span><span style="color: #000000;">&#40;</span>dr, IDM_PLOT_TRI_CONTOUR<span style="color: #000000;">&#41;</span>;
			DataPlot dp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">&#40;</span>nPlot<span style="color: #000000;">&#41;</span>;
			gl.<span style="color: #000000;">Rescale</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;			
			
			set_contour_lines<span style="color: #000000;">&#40;</span>dp<span style="color: #000000;">&#41;</span>;
			gp.<span style="color: #000000;">Refresh</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
		<span style="color: #000000;">&#125;</span>
	<span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span>


<span style="color: #0000ff;">void</span> set_contour_lines<span style="color: #000000;">&#40;</span>DataPlot<span style="color: #000040;">&amp;</span> dp<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span><span style="color: #000040;">!</span>dp<span style="color: #000000;">&#41;</span>
		<span style="color: #0000ff;">return</span>;	

	<span style="color: #008000;">// now we will set the colormap, we have to assume here that the color spectrum gr object is already in the </span>
	<span style="color: #008000;">// layer to show the colormap</span>
	<span style="color: #0000ff;">double</span> dMin <span style="color: #000080;">=</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1.5</span>, dMax <span style="color: #000080;">=</span> <span style="color: #0000dd;">1.5</span>;
	<span style="color: #0000ff;">int</span> nLevels <span style="color: #000080;">=</span> <span style="color: #0000dd;">20</span>;
	<span style="color: #0000ff;">double</span> dInc <span style="color: #000080;">=</span> <span style="color: #000000;">&#40;</span> dMax <span style="color: #000040;">-</span> dMin <span style="color: #000000;">&#41;</span> <span style="color: #000040;">/</span> nLevels;
	vector vLevels;
	vLevels.<span style="color: #000000;">Data</span><span style="color: #000000;">&#40;</span>dMin, dMax, dInc<span style="color: #000000;">&#41;</span>;
	
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #000040;">!</span>dp.<span style="color: #000000;">SetColormap</span><span style="color: #000000;">&#40;</span>vLevels<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
		<span style="color: #0000ff;">return</span>;
	
	<span style="color: #008000;">// line color</span>
	<span style="color: #0000ff;">int</span> 			nNumColors <span style="color: #000080;">=</span> nLevels;
	vector<span style="color: #000080;">&lt;</span>uint<span style="color: #000080;">&gt;</span> 	vnColors;
	<span style="color: #0000ff;">int</span> nColorFrom <span style="color: #000080;">=</span> SYSCOLOR_YELLOW;
	<span style="color: #0000ff;">int</span> nColorTo <span style="color: #000080;">=</span> nColorFrom <span style="color: #000040;">+</span> nNumColors <span style="color: #000040;">-</span> <span style="color: #0000dd;">1</span>;		
	vnColors.<span style="color: #000000;">Data</span><span style="color: #000000;">&#40;</span>nColorFrom, nColorTo, <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>; 		
	
	<span style="color: #008000;">// line styles</span>
	vector<span style="color: #000080;">&lt;</span>uint<span style="color: #000080;">&gt;</span> vnStyles<span style="color: #000000;">&#40;</span>vnColors.<span style="color: #000000;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;
	vnStyles <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>; <span style="color: #008000;">// Dot</span>
	
	<span style="color: #008000;">// line thickness</span>
	vector vThickness<span style="color: #000000;">&#40;</span>vnColors.<span style="color: #000000;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;	
	vThickness <span style="color: #000080;">=</span> <span style="color: #0000dd;">2.0</span>; 
	
	<span style="color: #008000;">// set all lines are show</span>
	vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> vLines<span style="color: #000000;">&#40;</span>vnColors.<span style="color: #000000;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;
	vLines <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;

	Tree tr; 
	tr.<span style="color: #000000;">ColorMap</span>.<span style="color: #000000;">Details</span>.<span style="color: #000000;">ShowLines</span>.<span style="color: #000000;">nVals</span> <span style="color: #000080;">=</span> vLines; <span style="color: #008000;">// to show all lines</span>
	tr.<span style="color: #000000;">ColorMap</span>.<span style="color: #000000;">ColorFillControl</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; <span style="color: #008000;">// to remove fill color</span>
	tr.<span style="color: #000000;">ColorMap</span>.<span style="color: #000000;">Details</span>.<span style="color: #000000;">LineColors</span>.<span style="color: #000000;">nVals</span> <span style="color: #000080;">=</span> vnColors;
	tr.<span style="color: #000000;">ColorMap</span>.<span style="color: #000000;">Details</span>.<span style="color: #000000;">LineStyles</span>.<span style="color: #000000;">nVals</span> <span style="color: #000080;">=</span> vnStyles;	
	tr.<span style="color: #000000;">ColorMap</span>.<span style="color: #000000;">Details</span>.<span style="color: #000000;">LineWidths</span>.<span style="color: #000000;">dVals</span> <span style="color: #000080;">=</span> vThickness;		

	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span><span style="color: #000040;">!</span>dp.<span style="color: #000000;">SetColormap</span><span style="color: #000000;">&#40;</span>tr<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>
		<span style="color: #0000ff;">return</span>;	
	
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Plot_XYZ_Contour_from_Worksheet_and_Custom_Labels"></a><span class="mw-headline">Plot XYZ Contour from Worksheet and Custom Labels</span></h2>
<p class="version" >Minimum Origin Version Required: Origin 8.1 SR2</p>
<p>This example to show how to plot XYZ contour and custom labels color and font.
</p><p>To run this example, create a worksheet and import the following data first: <i>&lt;Origin Installation Directory&gt;\Samples\Matrix Conversion and Gridding\XYZ Random Gaussian.dat</i>.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">void</span> plot_xyz_contour_ex2<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
   Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// get active worksheet</span>
   <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #000040;">!</span>wks <span style="color: #000000;">&#41;</span>
       <span style="color: #0000ff;">return</span>;
   
    <span style="color: #008000;">// construct the XYZ data range</span>
    DataRange dr;
    dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">0</span>, <span style="color: #ff00ff;">&quot;X&quot;</span><span style="color: #000000;">&#41;</span>;
    dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">1</span>, <span style="color: #ff00ff;">&quot;Y&quot;</span><span style="color: #000000;">&#41;</span>;
    dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">2</span>, <span style="color: #ff00ff;">&quot;Z&quot;</span><span style="color: #000000;">&#41;</span>;
    
    GraphPage gp;
    gp.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;TriContour&quot;</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// create contour graph</span>
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> gp <span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        GraphLayer gl <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> gl <span style="color: #000000;">&#41;</span>
        <span style="color: #000000;">&#123;</span>
            <span style="color: #0000ff;">int</span> nPlot <span style="color: #000080;">=</span> gl.<span style="color: #000000;">AddPlot</span><span style="color: #000000;">&#40;</span>dr, IDM_PLOT_TRI_CONTOUR<span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// add contour plot to layer</span>
            DataPlot dp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">&#40;</span>nPlot<span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// get the added plot</span>
            gl.<span style="color: #000000;">Rescale</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;     <span style="color: #008000;">// rescale layer</span>
            
           <span style="color: #008000;">// set_contour_lines(dp);  </span>
           set_label_format<span style="color: #000000;">&#40;</span>dp<span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// set label format</span>
                
            gp.<span style="color: #000000;">Refresh</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// refresh graph</span>
        <span style="color: #000000;">&#125;</span>
    <span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span>

<span style="color: #0000ff;">void</span> set_label_format<span style="color: #000000;">&#40;</span>DataPlot<span style="color: #000040;">&amp;</span> dp<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span><span style="color: #000040;">!</span>dp<span style="color: #000000;">&#41;</span>
		<span style="color: #0000ff;">return</span>;
	
	vector vLevels;
	<span style="color: #0000ff;">BOOL</span> bLogScale;
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span><span style="color: #000040;">!</span>dp.<span style="color: #000000;">GetColormap</span><span style="color: #000000;">&#40;</span>vLevels, bLogScale<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>  <span style="color: #008000;">// get colormap of plot</span>
		<span style="color: #0000ff;">return</span>;
	
	<span style="color: #0000ff;">int</span> nNumLabels <span style="color: #000080;">=</span> vLevels.<span style="color: #000000;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000040;">-</span> <span style="color: #0000dd;">1</span>;  <span style="color: #008000;">// number of labels</span>
	vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> vnLabelShow<span style="color: #000000;">&#40;</span>nNumLabels<span style="color: #000000;">&#41;</span>;
	vnLabelShow <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;  <span style="color: #008000;">// show labels</span>
	
	Tree trFormat;
	trFormat.<span style="color: #000000;">Root</span>.<span style="color: #000000;">ColorMap</span>.<span style="color: #000000;">Details</span>.<span style="color: #000000;">Labels</span>.<span style="color: #000000;">nVals</span> <span style="color: #000080;">=</span> vnLabelShow;  <span style="color: #008000;">// show labels</span>
	trFormat.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Labels</span>.<span style="color: #000000;">Color</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> SYSCOLOR_MAGENTA;  <span style="color: #008000;">// color=magenta</span>
	trFormat.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Labels</span>.<span style="color: #000000;">Size</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">30</span>;  <span style="color: #008000;">// size=30</span>
	trFormat.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Labels</span>.<span style="color: #000000;">Bold</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000ff;">true</span>; 
	trFormat.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Labels</span>.<span style="color: #000000;">Italic</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000ff;">true</span>;
	
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> dp.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">&#40;</span>trFormat.<span style="color: #000000;">Root</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>
		<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span><span style="color: #000040;">!</span>dp.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">&#40;</span>trFormat, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>   <span style="color: #008000;">// apply format</span>
			out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Failed to apply format!&quot;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>






