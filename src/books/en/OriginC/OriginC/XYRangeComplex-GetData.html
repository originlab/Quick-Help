<h1 class="firstHeading">2.2.4.49.1 XYRangeComplex::GetData</h1><p><span class="OIndex" style="display:none">GetData</span>
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Syntax"><span class="tocnumber">2</span> <span class="toctext">Syntax</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Parameters"><span class="tocnumber">3</span> <span class="toctext">Parameters</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Return"><span class="tocnumber">4</span> <span class="toctext">Return</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Examples"><span class="tocnumber">5</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Remark"><span class="tocnumber">6</span> <span class="toctext">Remark</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#See_Also"><span class="tocnumber">7</span> <span class="toctext">See Also</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Header_to_Include"><span class="tocnumber">8</span> <span class="toctext">Header to Include</span></a></li>
</ul>
</div>

<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>Get xyz data from the datarange.
</p>
<h2><a name="Syntax"></a><span class="mw-headline">Syntax</span></h2>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">BOOL</span> GetData<span style="color: #000000;">&#40;</span> vector<span style="color: #000080;">&lt;</span>complex<span style="color: #000080;">&gt;</span> <span style="color: #000040;">&amp;</span> vy, vector <span style="color: #000040;">&amp;</span> vx, <span style="color: #0000ff;">int</span> nIndex <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">&#41;</span></pre>
<p><br />
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">BOOL</span> GetData<span style="color: #000000;">&#40;</span> vector <span style="color: #000040;">&amp;</span> vyReal, vector <span style="color: #000040;">&amp;</span> vyImag, vector <span style="color: #000040;">&amp;</span> vx, <span style="color: #0000ff;">int</span> nIndex <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">&#41;</span></pre>
<h2><a name="Parameters"></a><span class="mw-headline">Parameters</span></h2>
<dl><dt> vy</dt>
<dd> [output]Dependent data</dd>
<dt> vx</dt>
<dd> [output]Independent data</dd>
<dt> nIndex</dt>
<dd> [input]index of the sub range</dd></dl>
<p><br />
</p>
<dl><dt> vyReal</dt>
<dd> [output]Real part of dependent data</dd>
<dt> vyImag</dt>
<dd> [output]Image part of dependent data</dd>
<dt> vx</dt>
<dd> [output]Independent data</dd>
<dt> nIndex</dt>
<dd> [input]index of the sub range</dd></dl>
<h2><a name="Return"></a><span class="mw-headline">Return</span></h2>
<p>TRUE if success, FALSE if fail.
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p><b>EX1</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// The function first creates a worksheet and puts some input data</span>
<span style="color: #008000;">// into it. Then it initializes XYRangeComplex such that it refers to the data</span>
<span style="color: #008000;">// in the worksheet.</span>
<span style="color: #008000;">// Then it creates the output worksheet, extracts the data from the input (i.e. source)</span>
<span style="color: #008000;">// worksheet using XYRangeComplex::GetData() method, and puts them into the output worksheet.</span>
<span style="color: #0000ff;">void</span>    XYRangeComlex_GetData_ex1<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    Worksheet wksSource;
    wksSource.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #008000;">// Make sure there are at least 5 columns of data:</span>
    <span style="color: #0000ff;">while</span> <span style="color: #000000;">&#40;</span> wksSource.<span style="color: #000000;">Columns</span>.<span style="color: #000000;">Count</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">&lt;</span> <span style="color: #0000dd;">5</span> <span style="color: #000000;">&#41;</span>
        wksSource.<span style="color: #000000;">AddCol</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    
    
    DWORD dwRulesEx <span style="color: #000080;">=</span> DRR_GET_MISSING <span style="color: #000040;">|</span> DRR_BAD_WEIGHT_TREATMENT;
    <span style="color: #0000ff;">int</span> nNumRows <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>;
    
    <span style="color: #008000;">// Make columns 2 to 5 complex</span>
    <span style="color: #008000;">// and set some complex values into it:</span>
    <span style="color: #0000ff;">for</span> <span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> col <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; col <span style="color: #000080;">&lt;=</span> <span style="color: #0000dd;">4</span>; col<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        Column colObj <span style="color: #000080;">=</span> wksSource.<span style="color: #000000;">Columns</span><span style="color: #000000;">&#40;</span>col<span style="color: #000000;">&#41;</span>;
        colObj.<span style="color: #000000;">SetFormat</span><span style="color: #000000;">&#40;</span>OKCOLTYPE_NUMERIC<span style="color: #000000;">&#41;</span>;
        colObj.<span style="color: #000000;">SetInternalData</span><span style="color: #000000;">&#40;</span>FSI_COMPLEX<span style="color: #000000;">&#41;</span>;

        Dataset<span style="color: #000080;">&lt;</span>complex<span style="color: #000080;">&gt;</span>    ds<span style="color: #000000;">&#40;</span>wksSource, col<span style="color: #000000;">&#41;</span>;
        ds.<span style="color: #000000;">SetSize</span><span style="color: #000000;">&#40;</span>nNumRows<span style="color: #000000;">&#41;</span>;
        <span style="color: #0000ff;">for</span> <span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> row <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; row <span style="color: #000080;">&lt;</span> nNumRows; row<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span>
        <span style="color: #000000;">&#123;</span>
            <span style="color: #0000ff;">double</span>            rReal <span style="color: #000080;">=</span> <span style="color: #000000;">pow</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">10</span>, col<span style="color: #000000;">&#41;</span> <span style="color: #000040;">+</span> row;
            <span style="color: #0000ff;">double</span>            rImag <span style="color: #000080;">=</span> <span style="color: #000000;">&#40;</span>row <span style="color: #000040;">+</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span> <span style="color: #000040;">*</span> <span style="color: #000000;">pow</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">10</span>, col <span style="color: #000040;">-</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
            complex            cc<span style="color: #000000;">&#40;</span>rReal, rImag<span style="color: #000000;">&#41;</span>;
            
            ds<span style="color: #000000;">&#91;</span>row<span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> cc;
        <span style="color: #000000;">&#125;</span>
    <span style="color: #000000;">&#125;</span>
    
    <span style="color: #008000;">// Set X-values into the first column:</span>
    Dataset dsXSource<span style="color: #000000;">&#40;</span>wksSource, <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
    dsXSource.<span style="color: #000000;">SetSize</span><span style="color: #000000;">&#40;</span>nNumRows<span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">for</span> <span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> row <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; row <span style="color: #000080;">&lt;</span> nNumRows; row<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        dsXSource<span style="color: #000000;">&#91;</span>row<span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0.1</span> <span style="color: #000040;">*</span> <span style="color: #000000;">&#40;</span>row <span style="color: #000040;">+</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #000000;">&#125;</span>

    <span style="color: #008000;">// Initialize XYRangeComplex:</span>
    XYRangeComplex                dr;
    dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;X&quot;</span>, wksSource, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">0</span>, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
    dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Y&quot;</span>, wksSource, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">1</span>, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>;
    dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;S&quot;</span>, <span style="color: #0000ff;">NULL</span><span style="color: #000000;">&#41;</span>;
    dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;X&quot;</span>, wksSource, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">0</span>, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
    dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Y&quot;</span>, wksSource, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">3</span>, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>;
    dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Y&quot;</span>, wksSource, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">4</span>, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span>;
    
    <span style="color: #0000ff;">int</span>    nNumData <span style="color: #000080;">=</span> dr.<span style="color: #000000;">GetNumData</span><span style="color: #000000;">&#40;</span>dwRulesEx<span style="color: #000000;">&#41;</span>;
    
    <span style="color: #008000;">// Create worksheet for putting the extracted data into:</span>
    Worksheet wksOut;
    wksOut.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #008000;">// Make sure the worksheet has 2 * nNumData columns:</span>
    <span style="color: #0000ff;">while</span> <span style="color: #000000;">&#40;</span> wksOut.<span style="color: #000000;">Columns</span>.<span style="color: #000000;">Count</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">&lt;</span> <span style="color: #0000dd;">2</span> <span style="color: #000040;">*</span> nNumData <span style="color: #000000;">&#41;</span>
        wksOut.<span style="color: #000000;">AddCol</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    
    <span style="color: #008000;">// Get all the data and put them into the output worksheet:</span>
    <span style="color: #0000ff;">for</span> <span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> idata <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; idata <span style="color: #000080;">&lt;</span> nNumData; idata<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        vector<span style="color: #000080;">&lt;</span>complex<span style="color: #000080;">&gt;</span>        vc;
        vector                vx;
        <span style="color: #0000ff;">if</span> <span style="color: #000000;">&#40;</span> <span style="color: #000040;">!</span>dr.<span style="color: #000000;">GetData</span><span style="color: #000000;">&#40;</span>vc, vx, idata<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
        <span style="color: #000000;">&#123;</span>
            out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Failed to get complex data!&quot;</span><span style="color: #000000;">&#41;</span>;
            <span style="color: #0000ff;">return</span>;
        <span style="color: #000000;">&#125;</span>
        
        <span style="color: #008000;">// Set the column for complex values to be complex:</span>
        <span style="color: #0000ff;">int</span>                colIndexComplex <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span> <span style="color: #000040;">*</span> idata <span style="color: #000040;">+</span> <span style="color: #0000dd;">1</span>;
        Column            colObj <span style="color: #000080;">=</span> wksOut.<span style="color: #000000;">Columns</span><span style="color: #000000;">&#40;</span>colIndexComplex<span style="color: #000000;">&#41;</span>;
        colObj.<span style="color: #000000;">SetFormat</span><span style="color: #000000;">&#40;</span>OKCOLTYPE_NUMERIC<span style="color: #000000;">&#41;</span>;
        colObj.<span style="color: #000000;">SetInternalData</span><span style="color: #000000;">&#40;</span>FSI_COMPLEX<span style="color: #000000;">&#41;</span>;
        
        Dataset<span style="color: #000080;">&lt;</span>complex<span style="color: #000080;">&gt;</span>    dc<span style="color: #000000;">&#40;</span>wksOut, colIndexComplex<span style="color: #000000;">&#41;</span>;
        dc <span style="color: #000080;">=</span> vc;
        
        <span style="color: #008000;">// Set X-Values as well:</span>
        Dataset                dX<span style="color: #000000;">&#40;</span>wksOut, <span style="color: #0000dd;">2</span> <span style="color: #000040;">*</span> idata<span style="color: #000000;">&#41;</span>;
        dX <span style="color: #000080;">=</span> vx;
    <span style="color: #000000;">&#125;</span>
    
    <span style="color: #0000ff;">return</span>;
<span style="color: #000000;">&#125;</span></pre>
<p><br />
<b>EX2</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// The function first creates a worksheet and puts some input data</span>
<span style="color: #008000;">// into it. Then it initializes XYRangeComplex such that it refers to the data</span>
<span style="color: #008000;">// in the worksheet.</span>
<span style="color: #008000;">// Then it creates the output worksheet, extracts the data from the input (i.e. source)</span>
<span style="color: #008000;">// worksheet using XYRangeComplex::GetData() method, and puts them into the output worksheet.</span>
<span style="color: #0000ff;">void</span>    XYRangeComplex_GetData_ex2<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    Worksheet        wksSource;
    wksSource.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #008000;">// Make sure there are at least 5 columns of data:</span>
    <span style="color: #0000ff;">while</span> <span style="color: #000000;">&#40;</span> wksSource.<span style="color: #000000;">Columns</span>.<span style="color: #000000;">Count</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">&lt;</span> <span style="color: #0000dd;">5</span> <span style="color: #000000;">&#41;</span>
        wksSource.<span style="color: #000000;">AddCol</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    
    <span style="color: #0000ff;">int</span>                nNumRows <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>;
    
    <span style="color: #008000;">// Make columns 2 to 5 complex</span>
    <span style="color: #008000;">// and set some complex values into it:</span>
    <span style="color: #0000ff;">for</span> <span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> col <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; col <span style="color: #000080;">&lt;=</span> <span style="color: #0000dd;">4</span>; col<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        Column            colObj <span style="color: #000080;">=</span> wksSource.<span style="color: #000000;">Columns</span><span style="color: #000000;">&#40;</span>col<span style="color: #000000;">&#41;</span>;
        colObj.<span style="color: #000000;">SetFormat</span><span style="color: #000000;">&#40;</span>OKCOLTYPE_NUMERIC<span style="color: #000000;">&#41;</span>;
        colObj.<span style="color: #000000;">SetInternalData</span><span style="color: #000000;">&#40;</span>FSI_COMPLEX<span style="color: #000000;">&#41;</span>;

        Dataset<span style="color: #000080;">&lt;</span>complex<span style="color: #000080;">&gt;</span>    ds<span style="color: #000000;">&#40;</span>wksSource, col<span style="color: #000000;">&#41;</span>;
        ds.<span style="color: #000000;">SetSize</span><span style="color: #000000;">&#40;</span>nNumRows<span style="color: #000000;">&#41;</span>;
        <span style="color: #0000ff;">for</span> <span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> row <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; row <span style="color: #000080;">&lt;</span> nNumRows; row<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span>
        <span style="color: #000000;">&#123;</span>
            <span style="color: #0000ff;">double</span>            rReal <span style="color: #000080;">=</span> <span style="color: #000000;">pow</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">10</span>, col<span style="color: #000000;">&#41;</span> <span style="color: #000040;">+</span> row;
            <span style="color: #0000ff;">double</span>            rImag <span style="color: #000080;">=</span> <span style="color: #000000;">&#40;</span>row <span style="color: #000040;">+</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span> <span style="color: #000040;">*</span> <span style="color: #000000;">pow</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">10</span>, col <span style="color: #000040;">-</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
            complex            cc<span style="color: #000000;">&#40;</span>rReal, rImag<span style="color: #000000;">&#41;</span>;
            
            ds<span style="color: #000000;">&#91;</span>row<span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> cc;
        <span style="color: #000000;">&#125;</span>
    <span style="color: #000000;">&#125;</span>
    
    <span style="color: #008000;">// Set X-values into the first column:</span>
    Dataset                dsXSource<span style="color: #000000;">&#40;</span>wksSource, <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
    dsXSource.<span style="color: #000000;">SetSize</span><span style="color: #000000;">&#40;</span>nNumRows<span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">for</span> <span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> row <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; row <span style="color: #000080;">&lt;</span> nNumRows; row<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        dsXSource<span style="color: #000000;">&#91;</span>row<span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0.1</span> <span style="color: #000040;">*</span> <span style="color: #000000;">&#40;</span>row <span style="color: #000040;">+</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #000000;">&#125;</span>

    DWORD                dwRulesEx <span style="color: #000080;">=</span> DRR_GET_MISSING <span style="color: #000040;">|</span> DRR_BAD_WEIGHT_TREATMENT <span style="color: #000040;">|</span> DRR_COMPLEX <span style="color: #000040;">|</span> DRR_GET_DEPENDENT;
    
    <span style="color: #008000;">// Initialize XYRange:</span>
    XYRangeComplex dr;
    dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;X&quot;</span>, wksSource, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">0</span>, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
    dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Y&quot;</span>, wksSource, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">1</span>, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>;
    dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;S&quot;</span>, <span style="color: #0000ff;">NULL</span><span style="color: #000000;">&#41;</span>;
    dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;X&quot;</span>, wksSource, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">0</span>, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
    dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Y&quot;</span>, wksSource, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">3</span>, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>;
    dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Y&quot;</span>, wksSource, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">4</span>, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span>;
    
    <span style="color: #0000ff;">int</span>                    nNumData <span style="color: #000080;">=</span> dr.<span style="color: #000000;">GetNumData</span><span style="color: #000000;">&#40;</span>dwRulesEx<span style="color: #000000;">&#41;</span>;
    
    <span style="color: #008000;">// Create worksheet for putting the extracted data into:</span>
    Worksheet            wksOut;
    wksOut.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #008000;">// Make sure the worksheet has 3 * nNumData columns (X, YReal, and YImaginary for each data):</span>
    <span style="color: #0000ff;">while</span> <span style="color: #000000;">&#40;</span> wksOut.<span style="color: #000000;">Columns</span>.<span style="color: #000000;">Count</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">&lt;</span> <span style="color: #0000dd;">3</span> <span style="color: #000040;">*</span> nNumData <span style="color: #000000;">&#41;</span>
        wksOut.<span style="color: #000000;">AddCol</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    
    <span style="color: #008000;">// Get all the data and put them into the output worksheet:</span>
    <span style="color: #0000ff;">for</span> <span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> idata <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; idata <span style="color: #000080;">&lt;</span> nNumData; idata<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        vector                vReal, vImag;
        vector                vx;
        <span style="color: #008000;">// Extract real and imaginary parts into separate vectors:</span>
        <span style="color: #0000ff;">if</span> <span style="color: #000000;">&#40;</span> <span style="color: #000040;">!</span>dr.<span style="color: #000000;">GetData</span><span style="color: #000000;">&#40;</span>vReal, vImag, vx, idata<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
        <span style="color: #000000;">&#123;</span>
            out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Failed to get complex data!&quot;</span><span style="color: #000000;">&#41;</span>;
            <span style="color: #0000ff;">return</span>;
        <span style="color: #000000;">&#125;</span>
        
        Dataset                dsReal<span style="color: #000000;">&#40;</span>wksOut, <span style="color: #0000dd;">3</span> <span style="color: #000040;">*</span> idata <span style="color: #000040;">+</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
        dsReal <span style="color: #000080;">=</span> vReal;
        Dataset                dsImag<span style="color: #000000;">&#40;</span>wksOut, <span style="color: #0000dd;">3</span> <span style="color: #000040;">*</span> idata <span style="color: #000040;">+</span> <span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>;
        dsImag <span style="color: #000080;">=</span> vImag;
        
        <span style="color: #008000;">// Set X-Values as well:</span>
        Dataset                dX<span style="color: #000000;">&#40;</span>wksOut, <span style="color: #0000dd;">3</span> <span style="color: #000040;">*</span> idata<span style="color: #000000;">&#41;</span>;
        dX <span style="color: #000080;">=</span> vx;
    <span style="color: #000000;">&#125;</span>
    
    <span style="color: #0000ff;">return</span>;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Remark"></a><span class="mw-headline">Remark</span></h2>
<h2><a name="See_Also"></a><span class="mw-headline">See Also</span></h2>
<p><a href="../../OriginC/OriginC/XYRangeComplex-SetData.html" title="OriginC:XYRangeComplex-SetData">XYRangeComplex::SetData</a>, 
<a href="../../OriginC/OriginC/DataRange-GetData.html" title="OriginC:DataRange-GetData">DataRange::GetData</a>, <a href="../../OriginC/OriginC/DataRange-SetData.html" title="OriginC:DataRange-SetData">DataRange::SetData</a>
</p>
<h2><a name="Header_to_Include"></a><span class="mw-headline">Header to Include</span></h2>
<p>origin.h
</p>





