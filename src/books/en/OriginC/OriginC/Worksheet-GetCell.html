<h1 class="firstHeading">2.2.4.46.27 Worksheet::GetCell</h1><p><span class="OIndex" style="display:none">GetCell</span>
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Syntax"><span class="tocnumber">2</span> <span class="toctext">Syntax</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Parameters"><span class="tocnumber">3</span> <span class="toctext">Parameters</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Return"><span class="tocnumber">4</span> <span class="toctext">Return</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Examples"><span class="tocnumber">5</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Remark"><span class="tocnumber">6</span> <span class="toctext">Remark</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#See_Also"><span class="tocnumber">7</span> <span class="toctext">See Also</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Header_to_Include"><span class="tocnumber">8</span> <span class="toctext">Header to Include</span></a></li>
</ul>
</div>

<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>Get cell value as a string
</p>
<h2><a name="Syntax"></a><span class="mw-headline">Syntax</span></h2>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">BOOL</span> GetCell<span style="color: #000000;">&#40;</span> <span style="color: #0000ff;">int</span> nRow, <span style="color: #0000ff;">int</span> nCol, string <span style="color: #000040;">&amp;</span> strText <span style="color: #000000;">&#41;</span></pre>
<p><br />
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">BOOL</span> GetCell<span style="color: #000000;">&#40;</span> <span style="color: #0000ff;">int</span> nRow, <span style="color: #0000ff;">int</span> nCol, string <span style="color: #000040;">&amp;</span> strName, TreeNode <span style="color: #000040;">&amp;</span> tr <span style="color: #000000;">&#41;</span></pre>
<h2><a name="Parameters"></a><span class="mw-headline">Parameters</span></h2>
<dl><dt> nRow</dt>
<dd>[input] Row number with zero offset</dd>
<dt> nCol</dt>
<dd>[input] Column number with zero offset</dd>
<dt> strText</dt>
<dd>[output] String to store the value</dd></dl>
<p><br />
</p>
<dl><dt> nRow</dt>
<dd>[input] Row number with zero offset</dd>
<dt> nCol</dt>
<dd>[input] Column number with zero offset</dd>
<dt> strName</dt>
<dd>[output] A string to receive the name that the XML tree was saved with during SetCell</dd>
<dt> tr</dt>
<dd>[output] TreeNode to receive a copy of the tree</dd></dl>
<h2><a name="Return"></a><span class="mw-headline">Return</span></h2>
<p>TRUE for success, otherwise FALSE
</p><p><br />
FALSE if the specified cell dose not have associated XML tree, or there is error during retrival, TRUE for success
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p><b>EX1</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">//Get the cell value as a string.</span>
<span style="color: #0000ff;">int</span> Worksheet_GetCell_Ex1<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    WorksheetPage wp <span style="color: #000080;">=</span> Project.<span style="color: #000000;">WorksheetPages</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span><span style="color: #000040;">!</span>wp<span style="color: #000000;">&#41;</span>
        <span style="color: #0000ff;">return</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>;
    
    Worksheet wks<span style="color: #000000;">&#40;</span>wp.<span style="color: #000000;">GetName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;
    string strText;
    <span style="color: #0000ff;">int</span> iResult;

    wks.<span style="color: #000000;">SetCell</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">3.14</span><span style="color: #000000;">&#41;</span>;
    iResult <span style="color: #000080;">=</span> <span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span><span style="color: #000000;">&#41;</span> wks.<span style="color: #000000;">GetCell</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">0</span>, strText<span style="color: #000000;">&#41;</span>;
    <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Value at (0,0) location is&#160;%s<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, strText<span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">return</span> iResult;
<span style="color: #000000;">&#125;</span></pre>
<p><br />
<b>EX2</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">//Get a copy of the XML tree stored at the specified cell. </span>
<span style="color: #0000ff;">int</span> Worksheet_GetCell_Ex2<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    Tree tr;
    <span style="color: #0000ff;">int</span> nR <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>, nC <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
    <span style="color: #0000ff;">int</span> iResult;
    string strName <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;bogus&quot;</span>;
    wks.<span style="color: #000000;">GetCell</span><span style="color: #000000;">&#40;</span>nR, nC, strName, tr<span style="color: #000000;">&#41;</span>;
    out_tree<span style="color: #000000;">&#40;</span>tr<span style="color: #000000;">&#41;</span>;
    <span style="color: #008000;">// next we want to show that we can get the tree into a sub-branch</span>
    tr.<span style="color: #000000;">Junk</span>.<span style="color: #000000;">ID</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;    <span style="color: #008000;">// adding a new branch called Junk</span>
    <span style="color: #008000;">// tr.Junk will be replaced, including the tagName,</span>
    iResult <span style="color: #000080;">=</span> <span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span><span style="color: #000000;">&#41;</span> wks.<span style="color: #000000;">GetCell</span><span style="color: #000000;">&#40;</span>nR, nC, strName, tr.<span style="color: #000000;">Junk</span><span style="color: #000000;">&#41;</span>;
    out_tree<span style="color: #000000;">&#40;</span>tr<span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">return</span> iResult;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Remark"></a><span class="mw-headline">Remark</span></h2>
<p>Get a copy of the XML tree stored at the specified cell.
</p><p>If this function returns FALSE, then you can examine the strName to see if XML tree existed in cell or not. If function returns FALSE and strName is empty, then the cell does not have a tree. If XML tree existed but retrival failed, then function will also return FALSE but strName will not be empty, it will contain the name associated with the XML tree in the cell.
</p>
<h2><a name="See_Also"></a><span class="mw-headline">See Also</span></h2>
<p><a href="../../OriginC/OriginC/Datasheet-Cell.html" title="OriginC:Datasheet-Cell">Datasheet::Cell</a>,<a href="../../OriginC/OriginC/Datasheet-SetCell.html" title="OriginC:Datasheet-SetCell">Datasheet::SetCell</a>,<a href="../../OriginC/OriginC/Datasheet-TCell.html" title="OriginC:Datasheet-TCell">Datasheet::TCell</a>
</p>
<h2><a name="Header_to_Include"></a><span class="mw-headline">Header to Include</span></h2>
<p>origin.h
</p>





