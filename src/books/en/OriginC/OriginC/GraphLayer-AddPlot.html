<h1 class="firstHeading">2.2.4.17.3 GraphLayer::AddPlot</h1><p><span class="OIndex" style="display:none">AddPlot</span>
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Syntax"><span class="tocnumber">2</span> <span class="toctext">Syntax</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Parameters"><span class="tocnumber">3</span> <span class="toctext">Parameters</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Return"><span class="tocnumber">4</span> <span class="toctext">Return</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Examples"><span class="tocnumber">5</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Remark"><span class="tocnumber">6</span> <span class="toctext">Remark</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#See_Also"><span class="tocnumber">7</span> <span class="toctext">See Also</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Header_to_Include"><span class="tocnumber">8</span> <span class="toctext">Header to Include</span></a></li>
</ul>
</div>

<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>Before plotting with this method, please make sure to create a graph with <a href="../../OriginC/OriginC/How_Plot.html" title="OriginC:How Plot">the correct template and plot ID</a>. 
</p><p>Add one data plot to layer
</p><p><br />
It adds a copy of an existing dataplot to a graph layer.
</p><p><br />
Add DataPlot using a range that represent one or more data plots
</p><p><br />
Add one data plot to layer by using the existing styleholder. The styleholder
is usually used in templates to determine the type and other properties of
a dataplot which uses the styleholder when being added to a layer.
</p><p><br />
Add entire worksheet to layer.
</p><p><br />
Plot a Matrix into a graph layer
</p>
<h2><a name="Syntax"></a><span class="mw-headline">Syntax</span></h2>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">int</span> AddPlot<span style="color: #000000;">&#40;</span> Curve <span style="color: #000040;">&amp;</span> cData, <span style="color: #0000ff;">int</span> nPlotID <span style="color: #000080;">=</span> IDM_PLOT_UNKNOWN, uint dwCntrl <span style="color: #000080;">=</span> GAP_USE_TEMPLATE <span style="color: #000000;">&#41;</span></pre>
<p><br />
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">int</span> AddPlot<span style="color: #000000;">&#40;</span> DataPlot <span style="color: #000040;">&amp;</span> dp, DWORD dwOptions <span style="color: #000080;">=</span> ADDPLTPFROMPLT_ERRORBAR <span style="color: #000000;">&#41;</span></pre>
<p><br />
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">int</span> AddPlot<span style="color: #000000;">&#40;</span> <span style="color: #0000ff;">const</span> DataRange <span style="color: #000040;">&amp;</span> dr, <span style="color: #0000ff;">int</span> nPlotID <span style="color: #000080;">=</span> IDM_PLOT_SCATTER, uint dwCntrl <span style="color: #000080;">=</span> GAP_GROUP_PLOTS <span style="color: #000040;">|</span> GAP_USE_TEMPLATE <span style="color: #000040;">|</span> GAP_ALLOW_DUPLICATE_COL, <span style="color: #0000ff;">int</span> <span style="color: #000040;">*</span> pnAddtionalAddedPlots <span style="color: #000080;">=</span> <span style="color: #0000ff;">NULL</span>, <span style="color: #0000ff;">int</span> nAddtionalAddedPlotsBufferSize <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">&#41;</span></pre>
<p><br />
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">int</span> AddPlot<span style="color: #000000;">&#40;</span> Curve <span style="color: #000040;">&amp;</span> cData, StyleHolder <span style="color: #000040;">&amp;</span> style <span style="color: #000000;">&#41;</span></pre>
<p><br />
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">int</span> AddPlot<span style="color: #000000;">&#40;</span> Worksheet <span style="color: #000040;">&amp;</span> wks, <span style="color: #0000ff;">int</span> nPlotID <span style="color: #000080;">=</span> IDM_PLOT_UNKNOWN <span style="color: #000000;">&#41;</span></pre>
<p><br />
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">int</span> AddPlot<span style="color: #000000;">&#40;</span> MatrixObject <span style="color: #000040;">&amp;</span> matObj, <span style="color: #0000ff;">int</span> nPlotID <span style="color: #000080;">=</span> IDM_PLOT_MATRIX_IMAGE, uint dwCntrl <span style="color: #000080;">=</span> GAP_USE_TEMPLATE <span style="color: #000000;">&#41;</span></pre>
<h2><a name="Parameters"></a><span class="mw-headline">Parameters</span></h2>
<dl><dt> cData</dt>
<dd>[input] Data curve to add</dd>
<dt> nPlotID</dt>
<dd>[input] Specifies the plot type. The most common are </dd>
<dd>IDM_PLOT_LINE for line; </dd>
<dd>IDM_PLOT_SCATTER for scatter; </dd>
<dd>IDM_PLOT_LINESYMB for line + symbol. </dd>
<dd>For the list of all plot types, see <a href="../../OriginC/OriginC/How_Plot.html" title="OriginC:How Plot">Plot Type IDs</a>.</dd></dl>
<dl><dt> dwCntrl</dt>
<dd>additional control bits, see GraphAddPlotCtrls enum, like GAP_ALLOW_DUPLICATE_COL, GAP_NO_SET_X_TICK_TYPE</dd></dl>
<p><br />
</p>
<dl><dt> dp</dt>
<dd>[input] source dataplot</dd>
<dt> dwOptions</dt>
<dd>[input] optional options (see ADDPLTPFROMPLT_* bits in OC_const.h)</dd></dl>
<p><br />
</p>
<dl><dt> dr</dt>
<dd>[input] a DataRange that contains named subranges for plotting. It can be a singple XY or can be XYYY types to create multiple plots.</dd>
<dt> nPlotID</dt>
<dd>[input] Specifies the plot type. The most common are </dd>
<dd>IDM_PLOT_LINE for line; </dd>
<dd>IDM_PLOT_SCATTER for scatter; </dd>
<dd>IDM_PLOT_LINESYMB for line + symbol. </dd>
<dd>For the list of all plot types, see <a href="../../OriginC/OriginC/How_Plot.html" title="OriginC:How Plot">Plot Type IDs</a>.</dd>
<dt> dwCntrl</dt>
<dd>additional control bits, see GraphAddPlotCtrls enum, like GAP_USE_TEMPLATE, GAP_ALLOW_DUPLICATE_COL, GAP_GROUP_PLOTS, GAP_NO_SET_X_TICK_TYPE</dd>
<dt> pnAddtionalAddedPlots</dt>
<dd>[output, optional] if supplied, it will receive the indices of the dataplots beyond the first added dataplot (the index</dd>
<dd>of the first added dataplot is the return value of the method). On return, the value -1 inside the buffer pnAddtionalAddedPlots will</dd>
<dd>indicate the end. So, for example,  if there total of two plots added, the index of the first added plot will be returned from the method,</dd>
<dd>whereas the index of the second added plot will be put into *pnAddtionalAddedPlots; also, *(pnAddtionalAddedPlots + 1)</dd>
<dd>(provided nAddtionalAddedPlotsBufferSize &gt; 1) will be -1, indicating that there were no more added plots.</dd>
<dd>nAddtionalAddedPlotsBufferSize is the size of the buffer pnAddtionalAddedPlots.</dd>
<dt> nAddtionalAddedPlotsBufferSize</dt>
<dd></dd></dl>
<p><br />
</p>
<dl><dt> cData</dt>
<dd>[input]Data curve to add</dd>
<dt> style</dt>
<dd>[input]the style holder to use when creating the dataplot</dd></dl>
<p><br />
</p>
<dl><dt> wks</dt>
<dd>[input]worksheet object containing all data.</dd>
<dt> nPlotID</dt>
<dd>[input] Specifies the plot type. The most common are </dd>
<dd>IDM_PLOT_LINE for line; </dd>
<dd>IDM_PLOT_SCATTER for scatter; </dd>
<dd>IDM_PLOT_LINESYMB for line + symbol. </dd>
<dd>For the list of all plot types, see <a href="../../OriginC/OriginC/How_Plot.html" title="OriginC:How Plot">Plot Type IDs</a>.</dd></dl>
<p><br />
</p>
<dl><dt> matObj</dt>
<dd>[input] Matrix data object</dd>
<dt> nPlotID</dt>
<dd>[input] Specifies the plot type. The most common are </dd>
<dd>IDM_PLOT_LINE for line; </dd>
<dd>IDM_PLOT_SCATTER for scatter; </dd>
<dd>IDM_PLOT_LINESYMB for line + symbol. </dd>
<dd>For the list of all plot types, see <a href="../../OriginC/OriginC/How_Plot.html" title="OriginC:How Plot">Plot Type IDs</a>.</dd></dl>
<h2><a name="Return"></a><span class="mw-headline">Return</span></h2>
<p>0-offset data plot index of the dataplot added or -1 for error
</p><p><br />
If a dataplot added, returns its index in the layer, or -1 for failure. If there already
</p><p>existed a dataplot with the same dataset as the source dataplot, then, if dwOptions does not have ADDPLTPFROMPLT_FAIL_IF_DATASET_ALREADY_PRESENT
</p><p>and it does not have ADDPLTPFROMPLT_ADD_EVEN_IF_DATASET_PRESENT,
</p><p>the index of the existing dataplot is returned (no new dataplot added), otherwise -1 is returne;
</p><p>if it has ADDPLTPFROMPLT_FAIL_IF_DATASET_ALREADY_PRESENT, but not ADDPLTPFROMPLT_ADD_EVEN_IF_DATASET_PRESENT, it will
</p><p>return error (-1). if it has ADDPLTPFROMPLT_ADD_EVEN_IF_DATASET_PRESENT, but not ADDPLTPFROMPLT_FAIL_IF_DATASET_ALREADY_PRESENT, it will
</p><p>add a new dataplot regardless of whether it already has the same dataset. If both ADDPLTPFROMPLT_ADD_EVEN_IF_DATASET_PRESENT and
</p><p>ADDPLTPFROMPLT_FAIL_IF_DATASET_ALREADY_PRESENT are present, it will return error (-1) without doing anything.
</p><p><br />
0-offset data plot index of the dataplot added or -1 for error.
</p><p><br />
0-offset data plot index of the dataplot added or -1 for error
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p><b>EX1</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// For this example to run, a worksheet with columns &quot;A&quot; and &quot;B&quot; must</span>
<span style="color: #008000;">// exist with some numeric data in them.</span>
<span style="color: #008000;">// Draw a 2d scatter plot.</span>
<span style="color: #0000ff;">void</span>    GraphLayer_AddPlot_ex1<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    <span style="color: #008000;">// Construct the Curve object specifying the x and y datasets to be used for</span>
    <span style="color: #008000;">// the dataplot</span>
    Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">WorksheetPages</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>wks<span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        Curve        cc<span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
 
        <span style="color: #008000;">// the graph layer needs to be initialized:</span>
        GraphPage gp;
        gp.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;origin&quot;</span><span style="color: #000000;">&#41;</span>;
        GraphLayer    lay <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>lay<span style="color: #000000;">&#41;</span>
        <span style="color: #000000;">&#123;</span>                
            <span style="color: #008000;">// Add the dataplot to the graph:</span>
            <span style="color: #0000ff;">int</span>            nIndex <span style="color: #000080;">=</span> lay.<span style="color: #000000;">AddPlot</span><span style="color: #000000;">&#40;</span>cc, IDM_PLOT_SCATTER<span style="color: #000000;">&#41;</span>;
            lay.<span style="color: #000000;">Rescale</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
            <span style="color: #008000;">// Display the index of the data plot just added:</span>
            out_int<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Dataplot index = &quot;</span>, nIndex<span style="color: #000000;">&#41;</span>;
        <span style="color: #000000;">&#125;</span>
    <span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>
<p><br />
<b>EX2</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// For this example to run, the inactive source graph </span>
<span style="color: #008000;">// needs to have one dataplot in the first layer.</span>
<span style="color: #008000;">// Also, another empty graph needs to be active.</span>
<span style="color: #008000;">//Create a copy of the exist graph with error bar.</span>
<span style="color: #0000ff;">void</span>    GraphLayer_AddPlot_ex2<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    GraphLayer        grLayDest <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;    
    <span style="color: #0000ff;">if</span> <span style="color: #000000;">&#40;</span> <span style="color: #000040;">!</span>grLayDest <span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Invalid destination layer&quot;</span><span style="color: #000000;">&#41;</span>;
        <span style="color: #0000ff;">return</span>;
    <span style="color: #000000;">&#125;</span>
    
    GraphPage        grPgSource <span style="color: #000080;">=</span> Project.<span style="color: #000000;">GraphPages</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">if</span> <span style="color: #000000;">&#40;</span> <span style="color: #000040;">!</span>grPgSource <span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Invalid source page&quot;</span><span style="color: #000000;">&#41;</span>;
        <span style="color: #0000ff;">return</span>;
    <span style="color: #000000;">&#125;</span>
    
    GraphLayer        grLaySource <span style="color: #000080;">=</span> grPgSource.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">if</span> <span style="color: #000000;">&#40;</span> <span style="color: #000040;">!</span>grLaySource <span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Invalid source layer&quot;</span><span style="color: #000000;">&#41;</span>;
        <span style="color: #0000ff;">return</span>;
    <span style="color: #000000;">&#125;</span>
    
    DataPlot        dpSource <span style="color: #000080;">=</span> grLaySource.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">if</span> <span style="color: #000000;">&#40;</span><span style="color: #000040;">!</span>dpSource<span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Invalid source dataplot&quot;</span><span style="color: #000000;">&#41;</span>;
        <span style="color: #0000ff;">return</span>;
    <span style="color: #000000;">&#125;</span>
    
    <span style="color: #0000ff;">int</span>                nReturn <span style="color: #000080;">=</span> grLayDest.<span style="color: #000000;">AddPlot</span><span style="color: #000000;">&#40;</span>dpSource, ADDPLTPFROMPLT_FAIL_IF_DATASET_ALREADY_PRESENT<span style="color: #000040;">|</span>ADDPLTPFROMPLT_ERRORBAR<span style="color: #000000;">&#41;</span>;
    out_int<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;nReturn = &quot;</span>, nReturn<span style="color: #000000;">&#41;</span>;
    
    grLayDest.<span style="color: #000000;">Rescale</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    
    <span style="color: #0000ff;">return</span>;
<span style="color: #000000;">&#125;</span></pre>
<p><br />
<b>EX3</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// plot two XY ranges from two worksheets as a grouped line symbol plot</span>
<span style="color: #0000ff;">void</span> GraphLayer_AddPlot_ex3<span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> npts <span style="color: #000080;">=</span> <span style="color: #0000dd;">250</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	<span style="color: #008000;">// prepare worksheet 1</span>
 	WorksheetPage wksPage; 
 	wksPage.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Origin&quot;</span><span style="color: #000000;">&#41;</span>;
 	Worksheet wks <span style="color: #000080;">=</span> wksPage.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
 	wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>.<span style="color: #000000;">SetLongName</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Temperature (C<span style="color: #666666; font-weight: bold;">\+</span>(o))&quot;</span><span style="color: #000000;">&#41;</span>;
    wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>.<span style="color: #000000;">SetLongName</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Resistance (Ohms)&quot;</span><span style="color: #000000;">&#41;</span>;
 	
    Dataset dx1<span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
    dx1.<span style="color: #000000;">Data</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>, npts<span style="color: #000000;">&#41;</span>;
    dx1 <span style="color: #000040;">*</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">0.05</span>;
    
    Dataset dy1<span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
    dy1.<span style="color: #000000;">Normal</span><span style="color: #000000;">&#40;</span>npts<span style="color: #000000;">&#41;</span>;
    dy1 <span style="color: #000040;">+</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">1.2</span>;
    
 	<span style="color: #008000;">// prepare worksheet 2    </span>
 	WorksheetPage wksPage2; 
 	wksPage2.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Origin&quot;</span><span style="color: #000000;">&#41;</span>;
 	Worksheet wks2 <span style="color: #000080;">=</span> wksPage2.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;    
  	wks2.<span style="color: #000000;">Columns</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>.<span style="color: #000000;">SetLongName</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Temperature (C<span style="color: #666666; font-weight: bold;">\+</span>(o))&quot;</span><span style="color: #000000;">&#41;</span>;
    wks2.<span style="color: #000000;">Columns</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>.<span style="color: #000000;">SetLongName</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Ceramic body&quot;</span><span style="color: #000000;">&#41;</span>;    
    Dataset dx2<span style="color: #000000;">&#40;</span>wks2, <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
    dx2 <span style="color: #000080;">=</span> dx1 <span style="color: #000040;">*</span> <span style="color: #0000dd;">2</span>;    
    Dataset dy2<span style="color: #000000;">&#40;</span>wks2, <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
    dy2.<span style="color: #000000;">Normal</span><span style="color: #000000;">&#40;</span>npts<span style="color: #000000;">&#41;</span>;
    dy2 <span style="color: #000040;">+</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">2.2</span>;

    <span style="color: #008000;">// construct data range</span>
    DataRange dr;
    dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">0</span>, <span style="color: #ff00ff;">&quot;X&quot;</span><span style="color: #000000;">&#41;</span>;
    dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">1</span>, <span style="color: #ff00ff;">&quot;Y&quot;</span><span style="color: #000000;">&#41;</span>;
    dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;S&quot;</span>, <span style="color: #0000ff;">NULL</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// S:&lt;empty&gt;, add range separator to separate two XY ranges</span>
    
    dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>wks2, <span style="color: #0000dd;">0</span>, <span style="color: #ff00ff;">&quot;X&quot;</span><span style="color: #000000;">&#41;</span>;
    dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>wks2, <span style="color: #0000dd;">1</span>, <span style="color: #ff00ff;">&quot;Y&quot;</span><span style="color: #000000;">&#41;</span>;
 
    <span style="color: #008000;">// prepare graph window</span>
    GraphPage gp;
    gp.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;origin&quot;</span>, CREATE_HIDDEN<span style="color: #000000;">&#41;</span>;
    GraphLayer gl <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
 
    <span style="color: #008000;">//GAP_GROUP_PLOTS is specified by default, so if data range has multiple plots, they will be grouped</span>
    gl.<span style="color: #000000;">AddPlot</span><span style="color: #000000;">&#40;</span>dr, IDM_PLOT_LINESYMB<span style="color: #000000;">&#41;</span>;
 
    gl.<span style="color: #000000;">Rescale</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    legend_update<span style="color: #000000;">&#40;</span>gl<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// to update the legend loaded in from template</span>
    gp.<span style="color: #000000;">SetShow</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<p><b>EX4</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">//the following example shows how to plot the same column in a graph, first part using scatter, and second part using line</span>
<span style="color: #0000ff;">void</span> GraphLayer_AddPlot_ex4<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    Worksheet wks;
    wks.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;origin&quot;</span>, CREATE_HIDDEN<span style="color: #000000;">&#41;</span>;
    wks.<span style="color: #000000;">SetSize</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">50</span>,<span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>;
    
    <span style="color: #0000ff;">int</span> nXCol <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; <span style="color: #008000;">// test not using 1st X col</span>
    <span style="color: #0000ff;">int</span> nYCol <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
    Dataset dx<span style="color: #000000;">&#40;</span>wks, nXCol<span style="color: #000000;">&#41;</span>;
    dx.<span style="color: #000000;">Data</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">50</span><span style="color: #000000;">&#41;</span>;
    dx <span style="color: #000040;">*</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">0.05</span>;
    Dataset dy<span style="color: #000000;">&#40;</span>wks, nYCol<span style="color: #000000;">&#41;</span>;
    dy.<span style="color: #000000;">Normal</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">50</span><span style="color: #000000;">&#41;</span>;
    dy <span style="color: #000040;">+</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">1.2</span>;

    <span style="color: #0000ff;">int</span> nR1 <span style="color: #000080;">=</span> <span style="color: #0000dd;">20</span>;
    DataRange dr;
    dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;X&quot;</span>, wks, <span style="color: #0000dd;">0</span>, nXCol, nR1, nXCol<span style="color: #000000;">&#41;</span>;
    dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Y&quot;</span>, wks, <span style="color: #0000dd;">0</span>, nYCol, nR1, nYCol<span style="color: #000000;">&#41;</span>;
    
    GraphPage gp;
    gp.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;origin&quot;</span>, CREATE_HIDDEN<span style="color: #000000;">&#41;</span>;
    GraphLayer gl <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    gl.<span style="color: #000000;">AddPlot</span><span style="color: #000000;">&#40;</span>dr, IDM_PLOT_SCATTER<span style="color: #000000;">&#41;</span>;
    
    <span style="color: #008000;">// add 2nd plot of same range</span>
    DataRange dr2;
    dr2.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;X&quot;</span>, wks, nR1, nXCol, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, nXCol<span style="color: #000000;">&#41;</span>;
    dr2.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Y&quot;</span>, wks, nR1, nYCol, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, nYCol<span style="color: #000000;">&#41;</span>;
    gl.<span style="color: #000000;">AddPlot</span><span style="color: #000000;">&#40;</span>dr2, IDM_PLOT_LINE, GAP_ALLOW_DUPLICATE_COL <span style="color: #000040;">|</span> GAP_USE_TEMPLATE<span style="color: #000000;">&#41;</span>;
    
    gl.<span style="color: #000000;">Rescale</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    legend_update<span style="color: #000000;">&#40;</span>gl<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// to update the legend loaded in from template</span>
    gp.<span style="color: #000000;">SetShow</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<p><b>EX5</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">//the following example shows how to make a 3D scatter plot and change the drop line of the symbols</span>
<span style="color: #008000;">// assume active worksheet, will fill it with sample data    </span>
<span style="color: #0000ff;">void</span> GraphLayer_AddPlot_ex5<span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> npts <span style="color: #000080;">=</span> <span style="color: #0000dd;">30</span>, <span style="color: #0000ff;">int</span> nXCol <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>, <span style="color: #0000ff;">int</span> nYCol <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>, <span style="color: #0000ff;">int</span> nZCol <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> wks <span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        wks.<span style="color: #000000;">SetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>;
        wks.<span style="color: #000000;">SetColDesignations</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;XYZ&quot;</span><span style="color: #000000;">&#41;</span>;
        Dataset dsX<span style="color: #000000;">&#40;</span>wks, nXCol<span style="color: #000000;">&#41;</span>;
        Dataset dsY<span style="color: #000000;">&#40;</span>wks, nYCol<span style="color: #000000;">&#41;</span>;
        Dataset dsZ<span style="color: #000000;">&#40;</span>wks, nZCol<span style="color: #000000;">&#41;</span>;
        dsX.<span style="color: #000000;">Data</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>, npts<span style="color: #000000;">&#41;</span>;
        dsX <span style="color: #000040;">*</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">0.05</span>;
        dsY.<span style="color: #000000;">Normal</span><span style="color: #000000;">&#40;</span>npts<span style="color: #000000;">&#41;</span>;
        dsY <span style="color: #000040;">+</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">1.2</span>;
        dsZ.<span style="color: #000000;">Normal</span><span style="color: #000000;">&#40;</span>npts<span style="color: #000000;">&#41;</span>;

        DataRange dr;
        dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;X&quot;</span>, wks, <span style="color: #0000dd;">0</span>, nXCol, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, nXCol<span style="color: #000000;">&#41;</span>;
        dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Y&quot;</span>, wks, <span style="color: #0000dd;">0</span>, nYCol, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, nYCol<span style="color: #000000;">&#41;</span>;
        dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Z&quot;</span>, wks, <span style="color: #0000dd;">0</span>, nZCol, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, nZCol<span style="color: #000000;">&#41;</span>;

        GraphPage gp;
        <span style="color: #008000;">// You must use a 3D scatter/line template, you can first make a 3d scatter plot, </span>
        <span style="color: #008000;">//   make needed modifications, then save your own</span>
        gp.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;3D&quot;</span><span style="color: #000000;">&#41;</span>; 
        <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> gp <span style="color: #000000;">&#41;</span>
        <span style="color: #000000;">&#123;</span>
            GraphLayer gl <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
            <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> gl <span style="color: #000000;">&#41;</span>
            <span style="color: #000000;">&#123;</span>
                <span style="color: #0000ff;">int</span> nPlot <span style="color: #000080;">=</span> gl.<span style="color: #000000;">AddPlot</span><span style="color: #000000;">&#40;</span>dr, ID_3D_GRAPH_SCATTER<span style="color: #000000;">&#41;</span>;
                DataPlot dp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">&#40;</span>nPlot<span style="color: #000000;">&#41;</span>;
                Tree tr;
                tr <span style="color: #000080;">=</span> dp.<span style="color: #000000;">GetFormat</span><span style="color: #000000;">&#40;</span>FPB_ALL, FOB_ALL, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>; 
                <span style="color: #008000;">//set drop line to along Y axis only</span>
                TreeNode trdrop <span style="color: #000080;">=</span> tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">DropLines</span>;
                trdrop.<span style="color: #000000;">X</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
                trdrop.<span style="color: #000000;">Z</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
                trdrop.<span style="color: #000000;">Y</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
                dp.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">&#40;</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;
                gl.<span style="color: #000000;">Rescale</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
            <span style="color: #000000;">&#125;</span>
        <span style="color: #000000;">&#125;</span>
    <span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>
<p><b>EX6</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// This example shows how to plot a fill area graph into any</span>
<span style="color: #008000;">// graph layer (without the help of a fill-area template        </span>
<span style="color: #0000ff;">void</span> GraphLayer_AddPlot_ex6<span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> nY1 <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>, <span style="color: #0000ff;">int</span> nY2 <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>, <span style="color: #0000ff;">int</span> nX <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    DataRange dr;
    dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>wks, nX, <span style="color: #ff00ff;">&quot;X&quot;</span><span style="color: #000000;">&#41;</span>;
    dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>wks, nY1, <span style="color: #ff00ff;">&quot;Y&quot;</span><span style="color: #000000;">&#41;</span>;
    dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>wks, nY2, <span style="color: #ff00ff;">&quot;Y&quot;</span><span style="color: #000000;">&#41;</span>;
    GraphPage gp;
    gp.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// load with default template</span>
    GraphLayer gl <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
 
    <span style="color: #0000ff;">int</span> nPlot <span style="color: #000080;">=</span> gl.<span style="color: #000000;">AddPlot</span><span style="color: #000000;">&#40;</span>dr, IDM_PLOT_HILOCLOSE<span style="color: #000000;">&#41;</span>;
 
    DataPlot dp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">&#40;</span>nPlot<span style="color: #000000;">&#41;</span>;
 
    Tree tr;
    tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Line</span>.<span style="color: #000000;">Connect</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
    <span style="color: #0000ff;">int</span> nRet <span style="color: #000080;">=</span> dp.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">&#40;</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000080;">==</span>nRet<span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        dp.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">&#40;</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;
		gl.<span style="color: #000000;">Rescale</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #000000;">&#125;</span>
    <span style="color: #0000ff;">else</span>
        out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;plot settings tree construction error&quot;</span><span style="color: #000000;">&#41;</span>;
 
<span style="color: #000000;">&#125;</span></pre>
<p><br />
<b>EX7</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// For this example to run, a graph window must exist in the project.</span>
<span style="color: #008000;">// Also, a worksheet with columns &quot;A&quot; and &quot;B&quot; must</span>
<span style="color: #008000;">// exist with some numeric data in them.</span>
<span style="color: #008000;">// Draw a Box Chart graph.</span>
<span style="color: #0000ff;">void</span>    GraphLayer_AddPlot_ex7<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    <span style="color: #008000;">// Construct the Curve object specifying the x and y datasets to be used for</span>
    <span style="color: #008000;">// the dataplot</span>
    Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">WorksheetPages</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>wks<span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        Curve        cc<span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
 
        <span style="color: #008000;">// the graph layer needs to be initialized:</span>
        GraphPage gp;
        gp.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Box&quot;</span><span style="color: #000000;">&#41;</span>;
        GraphLayer    lay <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
        <span style="color: #008000;">// Get the first style holder in the layer.</span>
        StyleHolder style;
        style <span style="color: #000080;">=</span> lay.<span style="color: #000000;">StyleHolders</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>; 
 
        <span style="color: #008000;">// Check that the style holder is valid:</span>
        <span style="color: #0000ff;">if</span> <span style="color: #000000;">&#40;</span><span style="color: #000040;">!</span>style.<span style="color: #000000;">IsValid</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>
        <span style="color: #000000;">&#123;</span>
            out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;No style holders found!&quot;</span><span style="color: #000000;">&#41;</span>;
            <span style="color: #0000ff;">return</span>;
        <span style="color: #000000;">&#125;</span>
 
        <span style="color: #008000;">// Add the dataplot to the graph:</span>
        <span style="color: #0000ff;">int</span>            nIndex <span style="color: #000080;">=</span> lay.<span style="color: #000000;">AddPlot</span><span style="color: #000000;">&#40;</span>cc, style<span style="color: #000000;">&#41;</span>;
        lay.<span style="color: #000000;">Rescale</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
 
        <span style="color: #008000;">// Display the index of the data plot just added:</span>
        out_int<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Dataplot index = &quot;</span>, nIndex<span style="color: #000000;">&#41;</span>;
    <span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>
<p><br />
<b>EX8</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// For this example to run, a graph window must exist in the project.</span>
<span style="color: #008000;">// Also, a worksheet must exist with some numeric data.</span>
<span style="color: #0000ff;">void</span> GraphLayer_AddPlot_ex8<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">WorksheetPages</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>wks<span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        GraphPage gp;
        gp.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
        GraphLayer    gl <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>gl<span style="color: #000000;">&#41;</span>
        <span style="color: #000000;">&#123;</span>
            gl.<span style="color: #000000;">AddPlot</span><span style="color: #000000;">&#40;</span>wks<span style="color: #000000;">&#41;</span>;
        <span style="color: #000000;">&#125;</span>
    <span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>
<p><br />
<b>EX9</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// important step to set the correct template to make 3D plots</span>
<span style="color: #008000;">//IDM_PLOT_3D_MESH,        &quot;mesh&quot; // filled surface</span>
<span style="color: #008000;">//IDM_PLOT_3D_MESH,        &quot;cmap&quot; // colormap surface</span>
<span style="color: #008000;">//IDM_PLOT_3D_MESH,        &quot;3Dbars&quot;</span>
<span style="color: #008000;">//IDM_PLOT_3D_MESH,        &quot;wirefrm&quot; // wireframes</span>
<span style="color: #008000;">//IDM_PLOT_3D_MESH,        &quot;wireface&quot;  </span>
<span style="color: #008000;">//IDM_PLOT_CONTOUR,        &quot;contour&quot;</span>
<span style="color: #008000;">//IDM_PLOT_CONTOUR,        &quot;contline&quot;</span>
<span style="color: #008000;">//IDM_PLOT_CONTOUR,        &quot;contgray&quot;</span>
<span style="color: #008000;">//IDM_PLOT_MATRIX_IMAGE,&quot;image&quot;</span>

<span style="color: #008000;">// </span>
<span style="color: #008000;">// this function plots the given matrix into a new graph</span>
<span style="color: #008000;">// if nNewLevels is specified, will change the colormap to the specified number of levels</span>
<span style="color: #008000;">// for plots not using colormap, must pass in 0</span>
<span style="color: #0000ff;">bool</span> plot_matrix<span style="color: #000000;">&#40;</span>MatrixObject<span style="color: #000040;">&amp;</span> mobj, LPCSTR lpcszTemplate, <span style="color: #0000ff;">int</span> nNewLevels <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>, <span style="color: #0000ff;">int</span> nPlotID <span style="color: #000080;">=</span> IDM_PLOT_CONTOUR<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    GraphPage gp;
    gp.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span>lpcszTemplate, CREATE_HIDDEN<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// use template, create as hidden to avoid unneeded drawing            </span>
    GraphLayer glay <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    
    <span style="color: #0000ff;">int</span> nPlot <span style="color: #000080;">=</span> glay.<span style="color: #000000;">AddPlot</span><span style="color: #000000;">&#40;</span>mobj, nPlotID<span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>nPlot <span style="color: #000080;">&lt;</span> <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>
        <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span>;            
    
    string strTemp;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>nNewLevels<span style="color: #000000;">&#41;</span> <span style="color: #008000;">// to reset number of levels in color map</span>
    <span style="color: #000000;">&#123;</span>
        DataPlot dp <span style="color: #000080;">=</span> glay.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">&#40;</span>nPlot<span style="color: #000000;">&#41;</span>; 
        <span style="color: #0000ff;">BOOL</span> bLogScale;
        vector vLevels;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>dp.<span style="color: #000000;">GetColormap</span><span style="color: #000000;">&#40;</span>vLevels, bLogScale<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>
        <span style="color: #000000;">&#123;</span>                
            <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>nNewLevels <span style="color: #000040;">!</span><span style="color: #000080;">=</span> vLevels.<span style="color: #000000;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>
            <span style="color: #000000;">&#123;</span>
                <span style="color: #0000ff;">double</span> min <span style="color: #000080;">=</span> vLevels<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#93;</span>, max <span style="color: #000080;">=</span> vLevels<span style="color: #000000;">&#91;</span>vLevels.<span style="color: #000000;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span>;
                <span style="color: #0000ff;">double</span> step <span style="color: #000080;">=</span> <span style="color: #000000;">&#40;</span>max <span style="color: #000040;">-</span> min<span style="color: #000000;">&#41;</span> <span style="color: #000040;">/</span> <span style="color: #000000;">&#40;</span>nNewLevels <span style="color: #000040;">-</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
                vLevels.<span style="color: #000000;">Data</span><span style="color: #000000;">&#40;</span>min, max, step<span style="color: #000000;">&#41;</span>;
                
                <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>dp.<span style="color: #000000;">SetColormap</span><span style="color: #000000;">&#40;</span>vLevels<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>  
                    strTemp <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot; Colormap is modified, levels = &quot;</span> <span style="color: #000040;">+</span> nNewLevels;
            <span style="color: #000000;">&#125;</span>
        <span style="color: #000000;">&#125;</span>
    <span style="color: #000000;">&#125;</span>
    gp.<span style="color: #000000;">Label</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Plot created using template: &quot;</span> <span style="color: #000040;">+</span> <span style="color: #000000;">&#40;</span>string<span style="color: #000000;">&#41;</span>lpcszTemplate <span style="color: #000040;">+</span> strTemp;
    gp.<span style="color: #000000;">TitleShow</span> <span style="color: #000080;">=</span> WIN_TITLE_SHOW_BOTH;
    glay.<span style="color: #000000;">Rescale</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    gp.<span style="color: #000000;">SetShow</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;<span style="color: #008000;">// show it when all it ready</span>
    <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span>;
<span style="color: #000000;">&#125;</span>

<span style="color: #0000ff;">void</span> GraphLayer_AddPlot_ex9<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    MatrixLayer mlayer <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    MatrixObject mobj <span style="color: #000080;">=</span> mlayer.<span style="color: #000000;">MatrixObjects</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    
    plot_matrix<span style="color: #000000;">&#40;</span>mobj, <span style="color: #ff00ff;">&quot;contour&quot;</span>, <span style="color: #0000dd;">6</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// contour filled color</span>
    plot_matrix<span style="color: #000000;">&#40;</span>mobj, <span style="color: #ff00ff;">&quot;contour&quot;</span>, <span style="color: #0000dd;">22</span><span style="color: #000000;">&#41;</span>;<span style="color: #008000;">// contour lines only</span>
    plot_matrix<span style="color: #000000;">&#40;</span>mobj, <span style="color: #ff00ff;">&quot;image&quot;</span>, <span style="color: #0000dd;">0</span>, IDM_PLOT_MATRIX_IMAGE<span style="color: #000000;">&#41;</span>;
    plot_matrix<span style="color: #000000;">&#40;</span>mobj, <span style="color: #ff00ff;">&quot;cmap&quot;</span>, <span style="color: #0000dd;">18</span>, IDM_PLOT_3D_MESH<span style="color: #000000;">&#41;</span>;
    plot_matrix<span style="color: #000000;">&#40;</span>mobj, <span style="color: #ff00ff;">&quot;wirefrm&quot;</span>, <span style="color: #0000dd;">0</span>, IDM_PLOT_3D_MESH<span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Remark"></a><span class="mw-headline">Remark</span></h2>
<h2><a name="See_Also"></a><span class="mw-headline">See Also</span></h2>
<h2><a name="Header_to_Include"></a><span class="mw-headline">Header to Include</span></h2>
<p>origin.h
</p>





