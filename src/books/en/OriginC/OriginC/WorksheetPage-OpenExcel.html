<h1 class="firstHeading">2.2.4.47.5 WorksheetPage::OpenExcel</h1><p><span class="OIndex" style="display:none">OpenExcel</span>
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Syntax"><span class="tocnumber">2</span> <span class="toctext">Syntax</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Parameters"><span class="tocnumber">3</span> <span class="toctext">Parameters</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Return"><span class="tocnumber">4</span> <span class="toctext">Return</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Examples"><span class="tocnumber">5</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Remark"><span class="tocnumber">6</span> <span class="toctext">Remark</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#See_Also"><span class="tocnumber">7</span> <span class="toctext">See Also</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Header_to_Include"><span class="tocnumber">8</span> <span class="toctext">Header to Include</span></a></li>
</ul>
</div>

<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>Open or import an Excel file.
The int return version was added for Origin 8 and provides more useful error returns, while the BOOL return version was kept for backward compatible reason.
</p>
<h2><a name="Syntax"></a><span class="mw-headline">Syntax</span></h2>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">int</span> OpenExcel<span style="color: #000000;">&#40;</span> <span style="color: #0000ff;">int</span> nMode, LPCSTR lpcszxlsFile, LPCSTR lpcszSheet <span style="color: #000080;">=</span> <span style="color: #0000ff;">NULL</span>, DWORD dwCntrl <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>, <span style="color: #0000ff;">int</span> nMaxNumEmptyColumnsBeyondLastData <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">&#41;</span></pre>
<p><br />
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">int</span> OpenExcel<span style="color: #000000;">&#40;</span> <span style="color: #0000ff;">int</span> nMode, LPCSTR lpcszxlsFile, <span style="color: #0000ff;">int</span> nSheetIndex, DWORD dwCntrl <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>, <span style="color: #0000ff;">int</span> nMaxNumEmptyColumnsBeyondLastData <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">&#41;</span></pre>
<p><br />
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">BOOL</span> OpenExcel<span style="color: #000000;">&#40;</span> LPCSTR lpcszxlsFile, LPCSTR lpcszSheetName <span style="color: #000080;">=</span> <span style="color: #0000ff;">NULL</span> <span style="color: #000000;">&#41;</span></pre>
<p><br />
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">BOOL</span> OpenExcel<span style="color: #000000;">&#40;</span> LPCSTR lpcszxlsFile, <span style="color: #0000ff;">int</span> nSheetIndex <span style="color: #000080;">=</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span> <span style="color: #000000;">&#41;</span></pre>
<h2><a name="Parameters"></a><span class="mw-headline">Parameters</span></h2>
<dl><dt> nMode</dt>
<dd>[input] can be one of XL_OPEN, or XL_IMPORT. XL_OPEN will open the excel book as Excel. XL_IMPORT will import the Excel book as Origin Workbook.</dd>
<dt> lpcszxlsFile</dt>
<dd>[input]Path and name of the *.XLS file to be opened or imported.</dd>
<dt> lpcszSheet</dt>
<dd>[input]The name of the Excel sheet inside the workbook to open. If NULL, open/import all sheets in the Excel file, otherwise open/import the named sheet.</dd>
<dt> nSheetIndex</dt>
<dd>[input]The index(0,1,2) of the Excel sheet inside the workbook to open. An index of -1 will open the active (top) sheet in the book.</dd>
<dt> dwCntrl</dt>
<dd>[input] 0 will import both values and styles, but XLIMP_SKIP_STYLES will import values only and thus can be faster</dd>
<dt> nMaxNumEmptyColumnsBeyondLastData</dt>
<dd>[input] due to the presence of styles that may extend beyond the reaches of nonempty cells, additional columns mayy have to be added during import. nMaxNumEmptyColumnsBeyondLastData determines how many additonal columns at most may get added.</dd></dl>
<h2><a name="Return"></a><span class="mw-headline">Return</span></h2>
<pre> int OpenExcel( int nMode, LPCSTR lpcszxlsFile, ...) </pre>
<p>Returns 0 on successful exit and
</p><p>-1&#160;: if lpcszxlsFile is not found
</p><p>-2&#160;: if lpcszxlsFile lack the XLS extension
</p><p>-3&#160;: if lpcszxlsFile cannot be open/imported
</p>
<pre>BOOL OpenExcel( LPCSTR lpcszWorkbookFile, ...)</pre> 
<p>Returns TRUE on successful exit and FALSE on failure.
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p><b>EX1</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">//Assume there is already an excel file in C:\</span>

<span style="color: #0000ff;">int</span> WorksheetPage_OpenExcel_ex1<span style="color: #000000;">&#40;</span>string strFile <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;C:<span style="color: #666666; font-weight: bold;">\\</span>Book1.xls&quot;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    WorksheetPage wp;
    <span style="color: #0000ff;">int</span> nErr <span style="color: #000080;">=</span> wp.<span style="color: #000000;">OpenExcel</span><span style="color: #000000;">&#40;</span>XL_IMPORT, strFile<span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> wp <span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        Worksheet wks <span style="color: #000080;">=</span> wp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
        <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Opened [%s] as an Origin workbook (%s) with Sheet '%s' active&quot;</span>, strFile, wp.<span style="color: #000000;">GetName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>, wks.<span style="color: #000000;">GetName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #000000;">&#125;</span>
    <span style="color: #0000ff;">else</span>
        <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Import Excel failed, error code =&#160;%d<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, nErr<span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">return</span> nErr;
<span style="color: #000000;">&#125;</span></pre>
<p><br />
<b>EX2</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">int</span> WorksheetPage_OpenExcel_ex2<span style="color: #000000;">&#40;</span>string strWorkbookPathname <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;C:<span style="color: #666666; font-weight: bold;">\\</span>Book1.xls&quot;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    WorksheetPage wp;
    <span style="color: #0000ff;">BOOL</span> bOK <span style="color: #000080;">=</span> wp.<span style="color: #000000;">OpenExcel</span><span style="color: #000000;">&#40;</span>strWorkbookPathname, <span style="color: #ff00ff;">&quot;Sheet2&quot;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> wp <span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        Worksheet wks <span style="color: #000080;">=</span> wp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> wks <span style="color: #000000;">&#41;</span>
        <span style="color: #000000;">&#123;</span>
            <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Opened '%s' as an Origin workbook with '%s' active&quot;</span>, wp.<span style="color: #000000;">GetName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>, wks.<span style="color: #000000;">GetName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;
            <span style="color: #0000ff;">return</span> <span style="color: #0000dd;">0</span>;
        <span style="color: #000000;">&#125;</span>
    <span style="color: #000000;">&#125;</span>
    <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Invalid page or sheet!<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">return</span> <span style="color: #0000dd;">0</span>;
<span style="color: #000000;">&#125;</span></pre>
<p><b>EX3</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">int</span> WorksheetPage_OpenExcel_ex3<span style="color: #000000;">&#40;</span>string strWorkbookPathname,string strSheetName<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    WorksheetPage wp;
    <span style="color: #0000ff;">BOOL</span> bOK <span style="color: #000080;">=</span> wp.<span style="color: #000000;">OpenExcel</span><span style="color: #000000;">&#40;</span>strWorkbookPathname, strSheetName<span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> wp <span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        Worksheet wks <span style="color: #000080;">=</span> wp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> wks <span style="color: #000000;">&#41;</span>
        <span style="color: #000000;">&#123;</span>
            <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Opened '%s' as an Origin workbook with '%s' active&quot;</span>, wp.<span style="color: #000000;">GetName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>, wks.<span style="color: #000000;">GetName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;
            <span style="color: #0000ff;">return</span> <span style="color: #0000dd;">0</span>;
        <span style="color: #000000;">&#125;</span>
    <span style="color: #000000;">&#125;</span>    
    <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Invalid page or sheet!<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">return</span> <span style="color: #0000dd;">0</span>;
<span style="color: #000000;">&#125;</span></pre>
<p><br />
<b>EX4</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">int</span> WorksheetPage_OpenExcel_ex4<span style="color: #000000;">&#40;</span>string strWorkbookPathname<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    WorksheetPage wp;
    <span style="color: #0000ff;">BOOL</span> bOK <span style="color: #000080;">=</span> wp.<span style="color: #000000;">OpenExcel</span><span style="color: #000000;">&#40;</span>strWorkbookPathname, <span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> wp <span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        Worksheet wks <span style="color: #000080;">=</span> wp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> wks <span style="color: #000000;">&#41;</span>
        <span style="color: #000000;">&#123;</span>
            <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Opened '%s' as an Origin workbook with '%s' active&quot;</span>, wp.<span style="color: #000000;">GetName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>, wks.<span style="color: #000000;">GetName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;
            <span style="color: #0000ff;">return</span> <span style="color: #0000dd;">0</span>;
        <span style="color: #000000;">&#125;</span>
    <span style="color: #000000;">&#125;</span>    
    <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Invalid page or sheet!<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">return</span> <span style="color: #0000dd;">0</span>;
<span style="color: #000000;">&#125;</span></pre>
<p><b>EX5</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">int</span> WorksheetPage_OpenExcel_ex5<span style="color: #000000;">&#40;</span>string strWorkbookPathname<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    WorksheetPage wp;
    <span style="color: #0000ff;">BOOL</span> bOK <span style="color: #000080;">=</span> wp.<span style="color: #000000;">OpenExcel</span><span style="color: #000000;">&#40;</span>strWorkbookPathname, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> wp <span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        Worksheet wks <span style="color: #000080;">=</span> wp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> wks <span style="color: #000000;">&#41;</span>
        <span style="color: #000000;">&#123;</span>
            <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Opened '%s' as an Origin workbook with '%s' active&quot;</span>, wp.<span style="color: #000000;">GetName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>, wks.<span style="color: #000000;">GetName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;
            <span style="color: #0000ff;">return</span> <span style="color: #0000dd;">0</span>;
        <span style="color: #000000;">&#125;</span>
    <span style="color: #000000;">&#125;</span>    
    <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Invalid page or sheet!<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">return</span> <span style="color: #0000dd;">0</span>;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Remark"></a><span class="mw-headline">Remark</span></h2>
<h2><a name="See_Also"></a><span class="mw-headline">See Also</span></h2>
<p><a href="../../OriginC/OriginC/WorksheetPage-ExcelSheet.html" title="OriginC:WorksheetPage-ExcelSheet">WorksheetPage::ExcelSheet</a>
</p>
<h2><a name="Header_to_Include"></a><span class="mw-headline">Header to Include</span></h2>
<p>origin.h
</p>





