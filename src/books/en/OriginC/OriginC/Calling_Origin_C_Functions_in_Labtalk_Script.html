<h1 class="firstHeading">3.14 Calling Origin C Functions in Labtalk Script</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Argument_compatability_between_LabTalk_types_and_Origin_C_types"><span class="tocnumber">1</span> <span class="toctext">Argument compatability between LabTalk types and Origin C types</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Examples_of_Calling_Origin_C_Functions_From_LabTalk"><span class="tocnumber">2</span> <span class="toctext">Examples of Calling Origin C Functions From LabTalk</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Pass_int_by_Value"><span class="tocnumber">2.1</span> <span class="toctext">Pass int by Value</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Pass_int_by_Reference"><span class="tocnumber">2.2</span> <span class="toctext">Pass int by Reference</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Pass_double_by_Value"><span class="tocnumber">2.3</span> <span class="toctext">Pass double by Value</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Pass_double_by_Reference"><span class="tocnumber">2.4</span> <span class="toctext">Pass double by Reference</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Pass_string_by_Value"><span class="tocnumber">2.5</span> <span class="toctext">Pass string by Value</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Pass_string_by_Reference"><span class="tocnumber">2.6</span> <span class="toctext">Pass string by Reference</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Pass_int_Array_by_Value"><span class="tocnumber">2.7</span> <span class="toctext">Pass int Array by Value</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Pass_double_Array_by_Value"><span class="tocnumber">2.8</span> <span class="toctext">Pass double Array by Value</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Pass_string_Array_by_Value"><span class="tocnumber">2.9</span> <span class="toctext">Pass string Array by Value</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Pass_Matrix_as_vector"><span class="tocnumber">2.10</span> <span class="toctext">Pass Matrix as vector</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#Pass_Matrix_by_range_string_as_MatrixObject"><span class="tocnumber">2.11</span> <span class="toctext">Pass Matrix by range string as MatrixObject</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#Pass_Matrix_by_range_string_as_Matrix"><span class="tocnumber">2.12</span> <span class="toctext">Pass Matrix by range string as Matrix</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="#Pass_object_by_range_string_in_general"><span class="tocnumber">2.13</span> <span class="toctext">Pass object by range string in general</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="Argument_compatability_between_LabTalk_types_and_Origin_C_types"></a><span class="mw-headline">Argument compatability between LabTalk types and Origin C types</span></h2>
<p>The following table show what kind of LabTalk object can be passed as argument to the different kinds of Origin C function paramenter. 
</p><p><b>Y</b> = supported
</p><p><b>/</b> = not supported
</p>
<table class="simple">
<tr>
<th>OC argument type \ Tabtalk argument type
</th>
<th>int literal
</th>
<th>int variable
</th>
<th>double literal
</th>
<th>double variable
</th>
<th>string literal
</th>
<th>string variable
</th>
<th>string register
</th>
<th>dataset
</th>
<th>grobject
</th>
<th>tree
</th></tr>
<tr align="center">
<th>int
</th>
<td><b>Y</b>
</td>
<td><b>Y</b>
</td>
<td><b>Y</b>
</td>
<td><b>Y</b>
</td>
<td>/
</td>
<td>/
</td>
<td><b>Y</b>
</td>
<td><b>Y</b>
</td>
<td>/
</td>
<td>/
</td></tr>
<tr align="center">
<th>int&amp;
</th>
<td>/
</td>
<td><b>Y</b>
</td>
<td>/
</td>
<td><b>Y</b>
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td></tr>
<tr align="center">
<th>double
</th>
<td><b>Y</b>
</td>
<td><b>Y</b>
</td>
<td><b>Y</b>
</td>
<td><b>Y</b>
</td>
<td>/
</td>
<td>/
</td>
<td><b>Y</b>
</td>
<td><b>Y</b>
</td>
<td>/
</td>
<td>/
</td></tr>
<tr align="center">
<th>double&amp;
</th>
<td>/
</td>
<td><b>Y</b>
</td>
<td>/
</td>
<td><b>Y</b>
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td></tr>
<tr align="center">
<th> string
</th>
<td><b>Y</b>
</td>
<td>/
</td>
<td><b>Y</b>
</td>
<td>/
</td>
<td><b>Y</b>
</td>
<td><b>Y</b>
</td>
<td><b>Y</b>
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td></tr>
<tr align="center">
<th>string&amp;
</th>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td><b>Y</b>
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td></tr>
<tr align="center">
<th> vector&lt;int&gt;
</th>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td><b>Y</b>
</td>
<td>/
</td>
<td>/
</td></tr>
<tr align="center">
<th> vector&lt;int&gt;&amp;
</th>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td></tr>
<tr align="center">
<th> vector&lt;double&gt;
</th>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td><b>Y</b>
</td>
<td>/
</td>
<td>/
</td></tr>
<tr align="center">
<th> vector&lt;double&gt;&amp;
</th>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td></tr>
<tr align="center">
<th>  vector&lt;string&gt;
</th>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td><b>Y</b>
</td>
<td>/
</td>
<td>/
</td></tr>
<tr align="center">
<th> vector&lt;string&gt;&amp;
</th>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td></tr>
<tr align="center">
<th>vector&lt;complex&gt;
</th>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td><b>Y</b>
</td>
<td>/
</td>
<td>/
</td></tr>
<tr align="center">
<th>vector&lt;complex&gt;&amp;
</th>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td>
<td>/
</td></tr></table>
<p><br />
</p>
<h2><a name="Examples_of_Calling_Origin_C_Functions_From_LabTalk"></a><span class="mw-headline">Examples of Calling Origin C Functions From LabTalk</span></h2>
<p>This section provides examples on how to call Origin C functions in LabTalk script or directly run in Script Window. Assume that the OC function is saved in MyFunction.c and be included in current workspace.
</p>
<h3><a name="Pass_int_by_Value"></a><span class="mw-headline">Pass int by Value</span></h3>
<p>In LabTalk script, we support passing the different types of argument to OC function as an <b>Integer</b>. But be careful when pass <b>double</b> type, since it will be trimmed as an variable of Integer type, say <b>2.55</b> will be treated as <b>2</b>; and when pass a string register to it, make sure that the content in the register can be converted to an <b>Integer</b>, if can not, will be treated as <b>0</b>. The following code show how the OC function is defined and used in LabTalk script.
</p><p><b>OC Function</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">void</span> show_square<span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> a<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;%d *&#160;%d =&#160;%d<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, a, a, a <span style="color: #000040;">*</span> a<span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<p><b>Calling in LabTalk Script or Command Window</b>
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">&#91;</span>UserScript<span style="color: #000000;">&#93;</span>
	
<span style="color: #000080;">%</span>A <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>; <span style="color: #008000;">// string register</span>
show_square<span style="color: #000000;">&#40;</span><span style="color: #000080;">%</span>A<span style="color: #000000;">&#41;</span>;
	
show_square<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// const integer</span>
	
int r <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>; <span style="color: #008000;">// integer variable</span>
show_square<span style="color: #000000;">&#40;</span>r<span style="color: #000000;">&#41;</span>; 
	
double dd <span style="color: #000080;">=</span> <span style="color: #0000dd;">3.2</span>; <span style="color: #008000;">// double variable</span>
show_square<span style="color: #000000;">&#40;</span>dd<span style="color: #000000;">&#41;</span>;
	
show_square<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">5.5</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// const double</span>
	
dataset ds <span style="color: #000080;">=</span> data<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span>, <span style="color: #0000dd;">6</span>, <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
show_square<span style="color: #000000;">&#40;</span>ds<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//only the first item will be pass to OC function, that is 3.</span></pre>
<p><br />
</p>
<h3><a name="Pass_int_by_Reference"></a><span class="mw-headline">Pass int by Reference</span></h3>
<p><b>OC Function</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">int</span> increment<span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span><span style="color: #000040;">&amp;</span> a<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	<span style="color: #0000ff;">int</span> nOld <span style="color: #000080;">=</span> a;
	a<span style="color: #000040;">++</span>;
	<span style="color: #0000ff;">return</span> nOld;
<span style="color: #000000;">&#125;</span></pre>
<p><b>Calling in LabTalk Script or Command Window</b>
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">&#91;</span>UserScript<span style="color: #000000;">&#93;</span>
		
int r <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
int nOld <span style="color: #000080;">=</span> increment<span style="color: #000000;">&#40;</span>r<span style="color: #000000;">&#41;</span>;
	
double dd <span style="color: #000080;">=</span> <span style="color: #0000dd;">3.2</span>;
int nOld <span style="color: #000080;">=</span> increment<span style="color: #000000;">&#40;</span>dd<span style="color: #000000;">&#41;</span>;</pre>
<h3><a name="Pass_double_by_Value"></a><span class="mw-headline">Pass double by Value</span></h3>
<p><b>OC Function</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">double</span> square<span style="color: #000000;">&#40;</span><span style="color: #0000ff;">double</span> a<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    <span style="color: #0000ff;">return</span> a <span style="color: #000040;">*</span> a;
<span style="color: #000000;">&#125;</span></pre>
<p><b>Calling in LabTalk Script or Command Window</b>
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">&#91;</span>UserScript<span style="color: #000000;">&#93;</span>
	
<span style="color: #000080;">%</span>A <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>;
type <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>square<span style="color: #000000;">&#40;</span><span style="color: #000080;">%</span>A<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// 25</span>
    
type square<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">:</span> <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>square<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// square(3):9</span>
    
int r <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
double rr <span style="color: #000080;">=</span> square<span style="color: #000000;">&#40;</span>r<span style="color: #000000;">&#41;</span>;
type rr<span style="color: #000000;">:</span> <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>rr<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// rr: 4</span>
    
double dd <span style="color: #000080;">=</span> <span style="color: #0000dd;">3.2</span>;
double ss <span style="color: #000080;">=</span> square<span style="color: #000000;">&#40;</span>dd<span style="color: #000000;">&#41;</span>;
type ss<span style="color: #000000;">:</span> <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>ss<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// ss: 10.24</span>
    
type square<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">5</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">:</span> <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>square<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">5</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// square(5): 25</span>

dataset ds <span style="color: #000080;">=</span> data<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">10</span>, <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>ds; <span style="color: #008000;">// put 1,2..10 to Col(1)</span>
Col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> square<span style="color: #000000;">&#40;</span>Col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// put 1,4,...100 to Col(2);</span>
type put square of Col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span> to Col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>, done<span style="color: #000080;">!</span>;</pre>
<h3><a name="Pass_double_by_Reference"></a><span class="mw-headline">Pass double by Reference</span></h3>
<p><b>OC Function</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">double</span> increment<span style="color: #000000;">&#40;</span><span style="color: #0000ff;">double</span><span style="color: #000040;">&amp;</span> a, <span style="color: #0000ff;">double</span> dStep <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	<span style="color: #0000ff;">double</span> dOld <span style="color: #000080;">=</span> a;
	a <span style="color: #000040;">+</span><span style="color: #000080;">=</span> dStep;
	<span style="color: #0000ff;">return</span> dOld;
<span style="color: #000000;">&#125;</span></pre>
<p><b>Calling in LabTalk Script or Command Window</b>
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">&#91;</span>UserScript<span style="color: #000000;">&#93;</span>
		
int a <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;
increment<span style="color: #000000;">&#40;</span>a<span style="color: #000000;">&#41;</span>;
type <span style="color: #000080;">-</span>a <span style="color: #ff00ff;">&quot;a = $(a)&quot;</span>;
	
double d <span style="color: #000080;">=</span> <span style="color: #0000dd;">4</span>;
increment<span style="color: #000000;">&#40;</span>d, <span style="color: #0000dd;">6</span><span style="color: #000000;">&#41;</span>;
type <span style="color: #000080;">-</span>a <span style="color: #ff00ff;">&quot;d = $(d)&quot;</span>;</pre>
<h3><a name="Pass_string_by_Value"></a><span class="mw-headline">Pass string by Value</span></h3>
<p><b>OC Function</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">void</span> display<span style="color: #000000;">&#40;</span>string str<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Your input string is&#160;%s<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, str<span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<p><b>Calling in LabTalk Script or Command Window</b>
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">&#91;</span>UserScript<span style="color: #000000;">&#93;</span>
	
display<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1208</span><span style="color: #000000;">&#41;</span>;
	
display<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3.1415</span><span style="color: #000000;">&#41;</span>;
	
display<span style="color: #000000;">&#40;</span>good day<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//literal without quotes</span>
	
display<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;good bye&quot;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//literal with quotes</span>
	
string str<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Origin C&quot;</span>;
display<span style="color: #000000;">&#40;</span>str<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>;
	
<span style="color: #000080;">%</span>A <span style="color: #000080;">=</span> X<span style="color: #000080;">-</span>Functions;
display<span style="color: #000000;">&#40;</span><span style="color: #000080;">%</span>A<span style="color: #000000;">&#41;</span>;</pre>
<h3><a name="Pass_string_by_Reference"></a><span class="mw-headline">Pass string by Reference</span></h3>
<p><b>OC Function</b>
</p>
<pre class="oc" style="font-family:monospace;">string to_uppercase<span style="color: #000000;">&#40;</span>string<span style="color: #000040;">&amp;</span> str<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	string strOld <span style="color: #000080;">=</span> str;
	str.<span style="color: #000000;">MakeUpper</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #0000ff;">return</span> strOld; <span style="color: #008000;">//return old value</span>
<span style="color: #000000;">&#125;</span></pre>
<p><b>Calling in LabTalk Script or Command Window</b>
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">&#91;</span>UserScript<span style="color: #000000;">&#93;</span>	
string str<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> OriginLab;
string strOld<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> to_uppercase<span style="color: #000000;">&#40;</span>str<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">$</span>;
type <span style="color: #ff00ff;">&quot;%(strOld$) is changed to&#160;%(str$)&quot;</span>;</pre>
<h3><a name="Pass_int_Array_by_Value"></a><span class="mw-headline">Pass int Array by Value</span></h3>
<p><b>OC Function</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">int</span> get_min_max<span style="color: #000000;">&#40;</span>vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> vn, <span style="color: #0000ff;">int</span><span style="color: #000040;">&amp;</span> min, <span style="color: #0000ff;">int</span><span style="color: #000040;">&amp;</span> max<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	<span style="color: #0000ff;">if</span> <span style="color: #000000;">&#40;</span> vn.<span style="color: #000000;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">==</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">&#41;</span>
		<span style="color: #0000ff;">return</span> <span style="color: #0000dd;">0</span>;
	
	vn.<span style="color: #000000;">Sort</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	min <span style="color: #000080;">=</span> vn<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#93;</span>;
	max <span style="color: #000080;">=</span> vn<span style="color: #000000;">&#91;</span>vn.<span style="color: #000000;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000040;">-</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span>;
	<span style="color: #0000ff;">return</span> <span style="color: #0000dd;">1</span>;
<span style="color: #000000;">&#125;</span></pre>
<p><b>Calling in LabTalk Script or Command Window</b>
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">&#91;</span>UserScript<span style="color: #000000;">&#93;</span>
	
<span style="color: #008000;">//loose dataset</span>
dataset ds <span style="color: #000080;">=</span> data<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span>, <span style="color: #0000dd;">30</span>, <span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>;
int min, max;
get_min_max<span style="color: #000000;">&#40;</span>ds, min, max<span style="color: #000000;">&#41;</span>;
type <span style="color: #ff00ff;">&quot;min = $(min), max = $(max)&quot;</span>;
	
<span style="color: #008000;">//normal dataset from column, make sure to fill some data in Col(A) to see the result.</span>
get_min_max<span style="color: #000000;">&#40;</span>Col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span>, min, max<span style="color: #000000;">&#41;</span>;
type <span style="color: #ff00ff;">&quot;min = $(min), max = $(max)&quot;</span>;</pre>
<h3><a name="Pass_double_Array_by_Value"></a><span class="mw-headline">Pass double Array by Value</span></h3>
<p><b>OC Function</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">int</span> get_min_max_double_arr<span style="color: #000000;">&#40;</span>vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">double</span><span style="color: #000080;">&gt;</span> vd, <span style="color: #0000ff;">double</span><span style="color: #000040;">&amp;</span> min, <span style="color: #0000ff;">double</span><span style="color: #000040;">&amp;</span> max<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	<span style="color: #0000ff;">if</span> <span style="color: #000000;">&#40;</span> vd.<span style="color: #000000;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">==</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">&#41;</span>
		<span style="color: #0000ff;">return</span> <span style="color: #0000dd;">0</span>;
	vd.<span style="color: #000000;">GetMinMax</span><span style="color: #000000;">&#40;</span>min, max<span style="color: #000000;">&#41;</span>;
	<span style="color: #0000ff;">return</span> <span style="color: #0000dd;">1</span>;
<span style="color: #000000;">&#125;</span></pre>
<p><b>Calling in LabTalk Script or Command Window</b>
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">&#91;</span>UserScript<span style="color: #000000;">&#93;</span>
	
<span style="color: #008000;">//loose dataset</span>
dataset ds <span style="color: #000080;">=</span> data<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span>, <span style="color: #0000dd;">30</span>, <span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>;
double dMin, dMax;
get_min_max_double_arr<span style="color: #000000;">&#40;</span>ds, dMin, dMax<span style="color: #000000;">&#41;</span>;
type <span style="color: #ff00ff;">&quot;min = $(dMin), max = $(dMax)&quot;</span>;
	
<span style="color: #008000;">//normal dataset from column, make sure to fill some data in Col(A) to see the result.</span>
get_min_max_double_arr<span style="color: #000000;">&#40;</span>Col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span>, dMin,  dMax<span style="color: #000000;">&#41;</span>;
type <span style="color: #ff00ff;">&quot;min = $(dMin), max = $(dMax)&quot;</span>;</pre>
<h3><a name="Pass_string_Array_by_Value"></a><span class="mw-headline">Pass string Array by Value</span></h3>
<p><b>OC Function</b>
</p>
<pre class="oc" style="font-family:monospace;">string string_array_set_tokens<span style="color: #000000;">&#40;</span>StringArray sa, <span style="color: #0000ff;">char</span> nDelimiter <span style="color: #000080;">=</span> <span style="color: #ff00ff;">','</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	string str;
	str.<span style="color: #000000;">SetTokens</span><span style="color: #000000;">&#40;</span>sa, nDelimiter<span style="color: #000000;">&#41;</span>;
	<span style="color: #0000ff;">return</span> str;
<span style="color: #000000;">&#125;</span></pre>
<p><b>Calling in LabTalk Script or Command Window</b>
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">&#91;</span>UserScript<span style="color: #000000;">&#93;</span>
string mystr;
mystr<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> string_array_set_tokens<span style="color: #000000;">&#40;</span>Col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">$</span>;
mystr<span style="color: #000080;">$</span> <span style="color: #000080;">=</span>;</pre>
<p><br />
</p>
<h3><a name="Pass_Matrix_as_vector"></a><span class="mw-headline">Pass Matrix as vector</span></h3>
<p><b>OC Function</b>
</p>
<pre class="oc" style="font-family:monospace;">vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">double</span><span style="color: #000080;">&gt;</span> DotMultiply<span style="color: #000000;">&#40;</span><span style="color: #0000ff;">const</span> vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">double</span><span style="color: #000080;">&gt;</span> <span style="color: #000040;">&amp;</span>vs1, <span style="color: #0000ff;">const</span> vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">double</span><span style="color: #000080;">&gt;</span> <span style="color: #000040;">&amp;</span>vs2, <span style="color: #0000ff;">int</span> nRow, <span style="color: #0000ff;">int</span> nCol<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span>
	matrix mat1, mat2;
	mat1.<span style="color: #000000;">SetSize</span><span style="color: #000000;">&#40;</span>nRow, nCol<span style="color: #000000;">&#41;</span>;
	mat2.<span style="color: #000000;">SetSize</span><span style="color: #000000;">&#40;</span>nRow, nCol<span style="color: #000000;">&#41;</span>;
	mat1.<span style="color: #000000;">SetByVector</span><span style="color: #000000;">&#40;</span>vs1, <span style="color: #0000ff;">TRUE</span><span style="color: #000000;">&#41;</span>;
	mat2.<span style="color: #000000;">SetByVector</span><span style="color: #000000;">&#40;</span>vs2, <span style="color: #0000ff;">TRUE</span><span style="color: #000000;">&#41;</span>;
	mat1.<span style="color: #000000;">DotMultiply</span><span style="color: #000000;">&#40;</span>mat2<span style="color: #000000;">&#41;</span>;
	vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">double</span><span style="color: #000080;">&gt;</span> vs;
	mat1.<span style="color: #000000;">GetAsVector</span><span style="color: #000000;">&#40;</span>vs<span style="color: #000000;">&#41;</span>;
	<span style="color: #0000ff;">return</span> vs;
<span style="color: #000000;">&#125;</span></pre>
<p><b>Calling in LabTalk Script or Command Window</b>
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">&#91;</span>UserScript<span style="color: #000000;">&#93;</span>
dataset ds;
ds <span style="color: #000080;">=</span> DotMultiply<span style="color: #000000;">&#40;</span>Mat<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>, Mat<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>, wks.<span style="color: #000080;">nrows</span>, wks.<span style="color: #000080;">ncols</span><span style="color: #000000;">&#41;</span>;
mean<span style="color: #000000;">&#40;</span>ds<span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>;</pre>
<h3><a name="Pass_Matrix_by_range_string_as_MatrixObject"></a><span class="mw-headline">Pass Matrix by range string as MatrixObject</span></h3>
<p><b>OC Function</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">void</span> test_m<span style="color: #000000;">&#40;</span>string ra, string rb<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	MatrixObject ma<span style="color: #000000;">&#40;</span>ra<span style="color: #000000;">&#41;</span>;
	MatrixObject mb<span style="color: #000000;">&#40;</span>rb<span style="color: #000000;">&#41;</span>;
	<span style="color: #0000ff;">int</span> ncols <span style="color: #000080;">=</span> ma.<span style="color: #000000;">GetNumCols</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #0000ff;">int</span> nrows <span style="color: #000080;">=</span> ma.<span style="color: #000000;">GetNumRows</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	mb.<span style="color: #000000;">SetSize</span><span style="color: #000000;">&#40;</span>nrows, ncols<span style="color: #000000;">&#41;</span>;
	
	matrixbase<span style="color: #000040;">&amp;</span> m1 <span style="color: #000080;">=</span> ma.<span style="color: #000000;">GetDataObject</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	matrixbase<span style="color: #000040;">&amp;</span> m2 <span style="color: #000080;">=</span> mb.<span style="color: #000000;">GetDataObject</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	
	m2 <span style="color: #000080;">=</span> m1;
<span style="color: #000000;">&#125;</span></pre>
<p><b>Calling in LabTalk Script or Command Window</b>
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">&#91;</span>UserScript<span style="color: #000000;">&#93;</span>
test_m<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;[Mbook1]1!1&quot;</span>,<span style="color: #ff00ff;">&quot;[Mbook2]1!1&quot;</span><span style="color: #000000;">&#41;</span>;</pre>
<h3><a name="Pass_Matrix_by_range_string_as_Matrix"></a><span class="mw-headline">Pass Matrix by range string as Matrix</span></h3>
<p><b>OC Function</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">void</span> test_a<span style="color: #000000;">&#40;</span>string ra, string rb<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	Matrix ma<span style="color: #000000;">&#40;</span>ra<span style="color: #000000;">&#41;</span>;
	Matrix mb<span style="color: #000000;">&#40;</span>rb<span style="color: #000000;">&#41;</span>;
	<span style="color: #0000ff;">int</span> ncols <span style="color: #000080;">=</span> ma.<span style="color: #000000;">GetNumCols</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #0000ff;">int</span> nrows <span style="color: #000080;">=</span> ma.<span style="color: #000000;">GetNumRows</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	mb.<span style="color: #000000;">SetSize</span><span style="color: #000000;">&#40;</span>nrows, ncols<span style="color: #000000;">&#41;</span>;
	
	mb <span style="color: #000080;">=</span> ma;
<span style="color: #000000;">&#125;</span></pre>
<p><b>Calling in LabTalk Script or Command Window</b>
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">&#91;</span>UserScript<span style="color: #000000;">&#93;</span>
test_a<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;[Mbook1]1!1&quot;</span>,<span style="color: #ff00ff;">&quot;[Mbook2]1!1&quot;</span><span style="color: #000000;">&#41;</span>;</pre>
<h3><a name="Pass_object_by_range_string_in_general"></a><span class="mw-headline">Pass object by range string in general</span></h3>
<p><b>OC Function</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>xfutils.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span>
<span style="color: #0000ff;">void</span> test<span style="color: #000000;">&#40;</span>string strRangeString<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
        <span style="color: #008000;">// for example passing a matrix</span>
	MatrixObject mo;
        okxf_resolve_string_get_origin_object<span style="color: #000000;">&#40;</span>strRangeString, <span style="color: #000040;">&amp;</span>mo<span style="color: #000000;">&#41;</span>;

        <span style="color: #008000; font-style: regular;">/*
        Whatever you want to do next
        */</span>
<span style="color: #000000;">&#125;</span></pre>






