<h1 class="firstHeading">3.9.5.4 Eigenvalues and Eigenvectors</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Real_Symmetric_Matrix_Eigenproblem.28Origin8_SR1.29"><span class="tocnumber">1</span> <span class="toctext">Real Symmetric Matrix Eigenproblem(Origin8 SR1)</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Real_Matrix_Eigenproblem.28Origin8_SR1.29"><span class="tocnumber">2</span> <span class="toctext">Real Matrix Eigenproblem(Origin8 SR1)</span></a></li>
</ul>
</div>
 
<h2><a name="Real_Symmetric_Matrix_Eigenproblem.28Origin8_SR1.29"></a><span class="mw-headline">Real Symmetric Matrix Eigenproblem(Origin8 SR1)</span></h2>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>Origin.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span>
<span style="color: #008000;">////////////////////////////////////////////////////////////////////////////////////</span>


<span style="color: #008000;">////////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #008000;">// Include your own header files here.</span>
<span style="color: #0000ff;">#define</span> NMAX1 <span style="color: #0000dd;">4</span>
<span style="color: #0000ff;">#define</span> TDA1 NMAX1
<span style="color: #0000ff;">#define</span> TDV1 NMAX1
 
 
 
<span style="color: #0000ff;">void</span> real_symmetric_matrix_eigenproblem<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
  Integer  i, j, n;
  <span style="color: #0000ff;">double</span> a<span style="color: #000000;">&#91;</span>NMAX1<span style="color: #000040;">*</span>TDA1<span style="color: #000000;">&#93;</span>, r<span style="color: #000000;">&#91;</span>NMAX1<span style="color: #000000;">&#93;</span>, v<span style="color: #000000;">&#91;</span>NMAX1<span style="color: #000040;">*</span>TDV1<span style="color: #000000;">&#93;</span>;
 
  n <span style="color: #000080;">=</span> <span style="color: #0000dd;">4</span>;  <span style="color: #008000;">// assume that NMAX1 is larger than n</span>
  matrix mx <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #000000;">&#123;</span><span style="color: #0000dd;">0.5</span>,<span style="color: #0000dd;">0.0</span>,<span style="color: #0000dd;">2.3</span>,<span style="color: #000040;">-</span><span style="color: #0000dd;">2.6</span><span style="color: #000000;">&#125;</span>,<span style="color: #000000;">&#123;</span><span style="color: #0000dd;">0.0</span>,<span style="color: #0000dd;">0.5</span>,<span style="color: #000040;">-</span><span style="color: #0000dd;">1.4</span>,<span style="color: #000040;">-</span><span style="color: #0000dd;">0.7</span><span style="color: #000000;">&#125;</span>,<span style="color: #000000;">&#123;</span><span style="color: #0000dd;">2.3</span>,<span style="color: #000040;">-</span><span style="color: #0000dd;">1.4</span>,<span style="color: #0000dd;">0.5</span>,<span style="color: #0000dd;">0.0</span><span style="color: #000000;">&#125;</span>,<span style="color: #000000;">&#123;</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">2.6</span>,<span style="color: #000040;">-</span><span style="color: #0000dd;">0.7</span>,<span style="color: #0000dd;">0.0</span>,<span style="color: #0000dd;">0.5</span><span style="color: #000000;">&#125;</span><span style="color: #000000;">&#125;</span>;
 
 
  <span style="color: #008000;">//f02abc(n, (double *)a, (Integer)TDA1, r, (double *)v, (Integer)TDV1,</span>
         <span style="color: #008000;">//NAGERR_DEFAULT);</span>
 
  f02abc<span style="color: #000000;">&#40;</span>n, <span style="color: #000000;">&#40;</span><span style="color: #0000ff;">double</span> <span style="color: #000040;">*</span><span style="color: #000000;">&#41;</span>mx, n, r, <span style="color: #000000;">&#40;</span><span style="color: #0000ff;">double</span> <span style="color: #000040;">*</span><span style="color: #000000;">&#41;</span>v, n,
         NAGERR_DEFAULT<span style="color: #000000;">&#41;</span>;
 
  <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Eigenvalues<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span><span style="color: #000000;">&#41;</span>;
  <span style="color: #0000ff;">for</span> <span style="color: #000000;">&#40;</span>i<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>; i<span style="color: #000080;">&lt;</span>n; i<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;%9.4f &quot;</span>, r<span style="color: #000000;">&#91;</span>i<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span>;
  <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span><span style="color: #000000;">&#41;</span>;
 
  <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Eigenvectors<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span><span style="color: #000000;">&#41;</span>;
  <span style="color: #0000ff;">for</span> <span style="color: #000000;">&#40;</span> i<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>; i<span style="color: #000080;">&lt;</span>n; i<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span>
  <span style="color: #000000;">&#123;</span>
      <span style="color: #0000ff;">for</span> <span style="color: #000000;">&#40;</span>j<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>; j<span style="color: #000080;">&lt;</span>n; j<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span>
      <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;%9.4f &quot;</span>, v<span style="color: #000000;">&#91;</span>i<span style="color: #000040;">*</span>n<span style="color: #000040;">+</span>j<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span>;
      <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span><span style="color: #000000;">&#41;</span>;
  <span style="color: #000000;">&#125;</span>
 
<span style="color: #000000;">&#125;</span></pre>
<p><br />
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>Origin.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span>
<span style="color: #008000;">////////////////////////////////////////////////////////////////////////////////////</span>


<span style="color: #008000;">////////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #008000;">// Include your own header files here.</span>
<span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>OC_nag.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span>

<span style="color: #0000ff;">#define</span> NMAX2 <span style="color: #0000dd;">10</span>
<span style="color: #0000ff;">#define</span> TDA2 NMAX2
<span style="color: #0000ff;">#define</span> TDV2 NMAX2

<span style="color: #0000ff;">void</span> real_symmetric_matrix_eigenproblem_ex2<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
  Integer  i, j, n;
  <span style="color: #0000ff;">double</span> r<span style="color: #000000;">&#91;</span>NMAX2<span style="color: #000000;">&#93;</span>, v<span style="color: #000000;">&#91;</span>NMAX2<span style="color: #000040;">*</span>TDV2<span style="color: #000000;">&#93;</span>;
  
  <span style="color: #008000;">// get input matrix data from a matrix layer</span>
  MatrixLayer ml <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
  Matrix mData<span style="color: #000000;">&#40;</span>ml<span style="color: #000000;">&#41;</span>;<span style="color: #008000;">// Get the active Matrix from a MatrixLayer</span>
  n <span style="color: #000080;">=</span> mData.<span style="color: #000000;">GetNumRows</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// assume that NMAX is larger than n</span>
  <span style="color: #000000;">ASSERT</span><span style="color: #000000;">&#40;</span>mData.<span style="color: #000000;">GetNumRows</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">==</span>GetNumCols<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;
  
  
  f02abc<span style="color: #000000;">&#40;</span>n, <span style="color: #000000;">&#40;</span><span style="color: #0000ff;">double</span> <span style="color: #000040;">*</span><span style="color: #000000;">&#41;</span>mData, n, r, <span style="color: #000000;">&#40;</span><span style="color: #0000ff;">double</span> <span style="color: #000040;">*</span><span style="color: #000000;">&#41;</span>v, n,
         NAGERR_DEFAULT<span style="color: #000000;">&#41;</span>;
         
  <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Eigenvalues<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span><span style="color: #000000;">&#41;</span>;
  <span style="color: #0000ff;">for</span> <span style="color: #000000;">&#40;</span>i<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>; i<span style="color: #000080;">&lt;</span>n; i<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;%9.4f &quot;</span>, r<span style="color: #000000;">&#91;</span>i<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span>;
  <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span><span style="color: #000000;">&#41;</span>;
  
  <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Eigenvectors<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span><span style="color: #000000;">&#41;</span>;
  <span style="color: #0000ff;">for</span> <span style="color: #000000;">&#40;</span> i<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>; i<span style="color: #000080;">&lt;</span>n; i<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span>
  <span style="color: #000000;">&#123;</span>
  	  <span style="color: #0000ff;">for</span> <span style="color: #000000;">&#40;</span>j<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>; j<span style="color: #000080;">&lt;</span>n; j<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span>
      <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;%9.4f &quot;</span>, v<span style="color: #000000;">&#91;</span>i<span style="color: #000040;">*</span>n<span style="color: #000040;">+</span>j<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span>;
  	  <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span><span style="color: #000000;">&#41;</span>;
  <span style="color: #000000;">&#125;</span>
  
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Real_Matrix_Eigenproblem.28Origin8_SR1.29"></a><span class="mw-headline">Real Matrix Eigenproblem(Origin8 SR1)</span></h2>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>Origin.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span>
<span style="color: #008000;">////////////////////////////////////////////////////////////////////////////////////</span>


<span style="color: #008000;">////////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #008000;">// Include your own header files here.</span>
<span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>OC_nag.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span>

<span style="color: #0000ff;">void</span> general_real_matrix_eigenproblem<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
  Integer  i, j, n;

<span style="color: #008000;">// for a general real matrix, its eigenvalues and eigenvector may be complex</span>
<span style="color: #008000;">// so use complex matrix to store the result       	</span>
  matrix<span style="color: #000080;">&lt;</span>complex<span style="color: #000080;">&gt;</span> r, v;
  r.<span style="color: #000000;">SetSize</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span>;
  v.<span style="color: #000000;">SetSize</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">4</span>,<span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span>;
  Integer iter<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">4</span><span style="color: #000000;">&#93;</span>;
  matrix a <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #000000;">&#123;</span><span style="color: #0000dd;">1.5</span>,<span style="color: #0000dd;">0.1</span>,<span style="color: #0000dd;">4.5</span>,<span style="color: #000040;">-</span><span style="color: #0000dd;">1.5</span><span style="color: #000000;">&#125;</span>,<span style="color: #000000;">&#123;</span><span style="color: #000040;">-</span><span style="color: #0000dd;">22.5</span>,<span style="color: #0000dd;">3.5</span>,<span style="color: #0000dd;">12.5</span>,<span style="color: #000040;">-</span><span style="color: #0000dd;">2.5</span><span style="color: #000000;">&#125;</span>,<span style="color: #000000;">&#123;</span><span style="color: #000040;">-</span><span style="color: #0000dd;">2.5</span>,<span style="color: #0000dd;">0.3</span>,<span style="color: #0000dd;">4.5</span>,<span style="color: #000040;">-</span><span style="color: #0000dd;">2.5</span><span style="color: #000000;">&#125;</span>,<span style="color: #000000;">&#123;</span><span style="color: #000040;">-</span><span style="color: #0000dd;">2.5</span>,<span style="color: #0000dd;">0.1</span>,<span style="color: #0000dd;">4.5</span>,<span style="color: #0000dd;">2.5</span><span style="color: #000000;">&#125;</span><span style="color: #000000;">&#125;</span>;
  n <span style="color: #000080;">=</span> <span style="color: #0000dd;">4</span>;

  f02agc<span style="color: #000000;">&#40;</span>n, a, n, r, v,
         n, iter, NAGERR_DEFAULT<span style="color: #000000;">&#41;</span>;
         
   <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Eigenvalues<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span><span style="color: #000000;">&#41;</span>;
   <span style="color: #0000ff;">for</span> <span style="color: #000000;">&#40;</span>i<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>; i<span style="color: #000080;">&lt;</span>n; i<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span>
   <span style="color: #000000;">&#123;</span>
  	complex temp <span style="color: #000080;">=</span> r<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">&#91;</span>i<span style="color: #000000;">&#93;</span>;
  	<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;(%7.3f,&#160;%7.3f) <span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, temp.<span style="color: #000000;">m_re</span>, temp.<span style="color: #000000;">m_im</span><span style="color: #000000;">&#41;</span>;
   <span style="color: #000000;">&#125;</span>
    
   <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;<span style="color: #666666; font-weight: bold;">\n</span>Eigenvectors<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span><span style="color: #000000;">&#41;</span>;
   <span style="color: #0000ff;">for</span> <span style="color: #000000;">&#40;</span>i<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>; i<span style="color: #000080;">&lt;</span>n; i<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span>
    <span style="color: #0000ff;">for</span> <span style="color: #000000;">&#40;</span>j<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>; j<span style="color: #000080;">&lt;</span>n; j<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span>
      <span style="color: #000000;">&#123;</span>
	complex temp <span style="color: #000080;">=</span> v<span style="color: #000000;">&#91;</span>i<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#91;</span>j<span style="color: #000000;">&#93;</span>;
	<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;(%7.3f,&#160;%7.3f)&quot;</span>, temp.<span style="color: #000000;">m_re</span>, temp.<span style="color: #000000;">m_im</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>j<span style="color: #000040;">%</span>4<span style="color: #000080;">==</span><span style="color: #0000dd;">3</span> <span style="color: #000040;">||</span> j<span style="color: #000080;">==</span>n<span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>
	 <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span><span style="color: #000000;">&#41;</span>;	
      <span style="color: #000000;">&#125;</span>  
<span style="color: #000000;">&#125;</span></pre>






