<h1 class="firstHeading">2.2.4.46.24 Worksheet::FindColIndex</h1><p><span class="OIndex" style="display:none">FindColIndex</span>
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Syntax"><span class="tocnumber">2</span> <span class="toctext">Syntax</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Parameters"><span class="tocnumber">3</span> <span class="toctext">Parameters</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Return"><span class="tocnumber">4</span> <span class="toctext">Return</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Examples"><span class="tocnumber">5</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Remark"><span class="tocnumber">6</span> <span class="toctext">Remark</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#See_Also"><span class="tocnumber">7</span> <span class="toctext">See Also</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Header_to_Include"><span class="tocnumber">8</span> <span class="toctext">Header to Include</span></a></li>
</ul>
</div>

<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>Starting from a given column index, find a column with the required designation. The column
returned could be the first or last found, dependending on the options, and the search could
go to the left or to the right.
</p>
<h2><a name="Syntax"></a><span class="mw-headline">Syntax</span></h2>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">int</span> FindColIndex<span style="color: #000000;">&#40;</span> <span style="color: #0000ff;">int</span> nRefCol, <span style="color: #0000ff;">int</span> nColDesignation, DWORD dwCntrl <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">&#41;</span></pre>
<h2><a name="Parameters"></a><span class="mw-headline">Parameters</span></h2>
<dl><dt> nRefCol</dt>
<dd>[input] The index of the column from which to start the search.</dd>
<dt> nColDesignation</dt>
<dd>[input] The desired designation of the sought column (from the OKDATAOBJ_DESIGNATION_ enumeration).</dd>
<dt> dwCntrl</dt>
<dd>[input] Options - any combination of values from the enumeration:</dd>
<dd>enum {</dd>
<dd>						    	FCI_RIGHT		= 0x00001000, // search to the right of the starting column (if off, it will search to the left)</dd>
<dd>						    	FCI_LAST_FOUND	= 0x00002000, // if set, it will return the last column found in the given direction and	with the given designation, otherwise the first.</dd>
<dd>								};</dd>
<dd>						  default is 0.</dd></dl>
<h2><a name="Return"></a><span class="mw-headline">Return</span></h2>
<p>the column index if found, otherwise a negative number.
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p><b>EX1</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Indicate error columns and their associated value columns (to left)</span>
<span style="color: #0000ff;">void</span> Worksheet_FindColIndex_Ex1<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    Worksheet    wks;
    wks.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;origin&quot;</span>, CREATE_VISIBLE<span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">int</span>    ii, iCol, iColType;
    <span style="color: #0000ff;">for</span><span style="color: #000000;">&#40;</span> ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>&#160;; ii <span style="color: #000080;">&lt;=</span> <span style="color: #0000dd;">10</span>&#160;; ii<span style="color: #000040;">++</span> <span style="color: #000000;">&#41;</span>
        wks.<span style="color: #000000;">AddCol</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    wks.<span style="color: #000000;">SetColDesignations</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;XMYEYEXMYEYE&quot;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #008000;">// Let's go left to right looking for Error columns</span>
    <span style="color: #0000ff;">for</span><span style="color: #000000;">&#40;</span> ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>&#160;; ii <span style="color: #000080;">&lt;</span> wks.<span style="color: #000000;">GetNumCols</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>&#160;; ii<span style="color: #000040;">++</span> <span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        iColType <span style="color: #000080;">=</span> wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">&#40;</span>ii<span style="color: #000000;">&#41;</span>.<span style="color: #000000;">GetType</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> iColType <span style="color: #000080;">==</span> OKDATAOBJ_DESIGNATION_ERROR <span style="color: #000040;">||</span> iColType <span style="color: #000080;">==</span> OKDATAOBJ_DESIGNATION_X_ERROR<span style="color: #000000;">&#41;</span>
        <span style="color: #000000;">&#123;</span>
            <span style="color: #008000;">// Once an error column is found, find first data to the left (no dwCntrl needed)</span>
            <span style="color: #0000ff;">switch</span><span style="color: #000000;">&#40;</span>iColType<span style="color: #000000;">&#41;</span>
            <span style="color: #000000;">&#123;</span>
            <span style="color: #0000ff;">case</span> OKDATAOBJ_DESIGNATION_ERROR<span style="color: #000000;">:</span>
                <span style="color: #008000;">// A Y Error column, so find its Y</span>
                iCol <span style="color: #000080;">=</span> wks.<span style="color: #000000;">FindColIndex</span><span style="color: #000000;">&#40;</span> ii , OKDATAOBJ_DESIGNATION_Y <span style="color: #000000;">&#41;</span>;
                <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> iCol <span style="color: #000080;">&lt;</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">&#41;</span>
                    <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;No Y column found for YErr column&#160;%u<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, ii <span style="color: #000040;">+</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
                <span style="color: #0000ff;">else</span>
                    <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Y is column&#160;%u, YErr is column&#160;%u<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, iCol <span style="color: #000040;">+</span> <span style="color: #0000dd;">1</span>, ii <span style="color: #000040;">+</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
                <span style="color: #0000ff;">break</span>;
            <span style="color: #0000ff;">case</span> OKDATAOBJ_DESIGNATION_X_ERROR<span style="color: #000000;">:</span>
                <span style="color: #008000;">// An X Error column, so find its X</span>
                iCol <span style="color: #000080;">=</span> wks.<span style="color: #000000;">FindColIndex</span><span style="color: #000000;">&#40;</span> ii , OKDATAOBJ_DESIGNATION_X <span style="color: #000000;">&#41;</span>;
                <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> iCol <span style="color: #000080;">&lt;</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">&#41;</span>
                    <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;No X column found for XErr column&#160;%u<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, ii <span style="color: #000040;">+</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
                <span style="color: #0000ff;">else</span>
                    <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;X is column&#160;%u, XErr is column&#160;%u<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, iCol <span style="color: #000040;">+</span> <span style="color: #0000dd;">1</span>, ii <span style="color: #000040;">+</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
            <span style="color: #000000;">&#125;</span>
        <span style="color: #000000;">&#125;</span>
    <span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Remark"></a><span class="mw-headline">Remark</span></h2>
<h2><a name="See_Also"></a><span class="mw-headline">See Also</span></h2>
<p><a href="../../OriginC/OriginC/Worksheet-SetColDesignations.html" title="OriginC:Worksheet-SetColDesignations">Worksheet::SetColDesignations</a>, <a href="../../OriginC/OriginC/Column-SetType.html" title="OriginC:Column-SetType">Column::SetType</a>
</p>
<h2><a name="Header_to_Include"></a><span class="mw-headline">Header to Include</span></h2>
<p>origin.h
</p>





