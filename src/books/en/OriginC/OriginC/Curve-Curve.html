<h1 class="firstHeading">2.2.3.4.3 Curve::Curve</h1><p><span class="OIndex" style="display:none">Curve</span>
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Syntax"><span class="tocnumber">2</span> <span class="toctext">Syntax</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Parameters"><span class="tocnumber">3</span> <span class="toctext">Parameters</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Return"><span class="tocnumber">4</span> <span class="toctext">Return</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Examples"><span class="tocnumber">5</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Remark"><span class="tocnumber">6</span> <span class="toctext">Remark</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#See_Also"><span class="tocnumber">7</span> <span class="toctext">See Also</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Header_to_Include"><span class="tocnumber">8</span> <span class="toctext">Header to Include</span></a></li>
</ul>
</div>

<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>Default constructor for Curve class.
</p><p><br />
Copy constructor for Curve class. The original Y data set is copied into a new Curve object and is then associated with a copy of the original X data set. The Datasets of the original Curve object are not affected by operations on the copy Curve.
</p><p><br />
Constructor for Curve class. The Y data set is specified by name and, if it exists, the Y data set's internally associated X data set is automatically used for the X data set. Otherwise, row numbers are used for the X data set. Operations on the Curve object do affect the X and/or the specified Y dataset(s)
</p><p><br />
Constructor for Curve class. Both the X and Y data sets are specified by name. Operations on the Curve object do affect the specified X and Y data sets.
</p><p><br />
Construct a Curve from X and Y Datasets. Both the X and Y data sets are specified by Origin C Dataset objects which are attached to internal Origin data sets. Operations on the Curve object do not affect the	associated Origin X and Y data sets.
</p><p><br />
Construct a Curve from a Worksheet and X and Y column numbers. The X and Y data sets are specified by column number in an Origin C worksheet object. Operations on the Curve object do affect the associated Origin X and Y worksheet columns (data sets).
</p><p><br />
Construct a Curve from a Worksheet, a Y column number, and an associated X column. The Y data set is specified by column number in an Origin C worksheet object and, if it exists, the Y column's internally associated X column is automatically used for the X column. Otherwise, row numbers are used for the X data set. Operations on the Curve object do affect the X and/or the specified Y column(s).
</p><p><br />
Construct a Curve from a DataPlot. The X and Y data sets are specified by an Origin C DataPlot object. Operations on the Curve object do affect the associated data plot and underlying data sets in Origin.
</p><p><br />
Constructor for Curve class. It creates a temporary curve object from a curvebase reference such as Project.ActiveCurveBase(). 
It allows the handling of missing values, and specifying range (start and end indexes) to copy. The resulting Curve values are all doubles, and so can be used for analysis.
</p><p><br />
Construct a Curve from a DataPlot. When bTemp = true, the operations on the Curve object do not affect the associated data plot and underlying data sets in Origin.
</p><p><br />
Constructor for Curve class. The X and Y dataasets come from the supplied XYRange object. It can be used for XYRange's that are inputs of xfunctions.
</p>
<h2><a name="Syntax"></a><span class="mw-headline">Syntax</span></h2>
<pre class="oc" style="font-family:monospace;">Curve<span style="color: #000000;">&#40;</span> <span style="color: #000000;">&#41;</span></pre>
<p><br />
</p>
<pre class="oc" style="font-family:monospace;">Curve<span style="color: #000000;">&#40;</span> Curve crvOriginal <span style="color: #000000;">&#41;</span></pre>
<p><br />
</p>
<pre class="oc" style="font-family:monospace;">Curve<span style="color: #000000;">&#40;</span> LPCSTR lpcszYData <span style="color: #000000;">&#41;</span></pre>
<p><br />
</p>
<pre class="oc" style="font-family:monospace;">Curve<span style="color: #000000;">&#40;</span> LPCSTR lpcszXData, LPCSTR lpcszYData <span style="color: #000000;">&#41;</span></pre>
<p><br />
</p>
<pre class="oc" style="font-family:monospace;">Curve<span style="color: #000000;">&#40;</span> Dataset dsX, Dataset dsY <span style="color: #000000;">&#41;</span></pre>
<p><br />
</p>
<pre class="oc" style="font-family:monospace;">Curve<span style="color: #000000;">&#40;</span> Worksheet <span style="color: #000040;">&amp;</span> wks, <span style="color: #0000ff;">int</span> nColX, <span style="color: #0000ff;">int</span> nColY <span style="color: #000000;">&#41;</span></pre>
<p><br />
</p>
<pre class="oc" style="font-family:monospace;">Curve<span style="color: #000000;">&#40;</span> Worksheet <span style="color: #000040;">&amp;</span> wks, <span style="color: #0000ff;">int</span> nColY <span style="color: #000000;">&#41;</span></pre>
<p><br />
</p>
<pre class="oc" style="font-family:monospace;">Curve<span style="color: #000000;">&#40;</span> DataPlot <span style="color: #000040;">&amp;</span> dp <span style="color: #000000;">&#41;</span></pre>
<p><br />
</p>
<pre class="oc" style="font-family:monospace;">Curve<span style="color: #000000;">&#40;</span> curvebase <span style="color: #000040;">&amp;</span> cv, <span style="color: #0000ff;">int</span> <span style="color: #000040;">&amp;</span> nNumMissingInCopy, <span style="color: #0000ff;">int</span> <span style="color: #000040;">&amp;</span> nSrcOffset, DWORD dwOptions <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>, <span style="color: #0000ff;">int</span> nLower <span style="color: #000080;">=</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, <span style="color: #0000ff;">int</span> nUpper <span style="color: #000080;">=</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span> <span style="color: #000000;">&#41;</span></pre>
<p><br />
</p>
<pre class="oc" style="font-family:monospace;">Curve<span style="color: #000000;">&#40;</span> DataPlot<span style="color: #000040;">&amp;</span> dp, <span style="color: #0000ff;">BOOL</span> bTemp<span style="color: #000000;">&#41;</span>;</pre>
<p><br />
</p>
<pre class="oc" style="font-family:monospace;">Curve<span style="color: #000000;">&#40;</span> XYRange <span style="color: #000040;">&amp;</span>xy<span style="color: #000000;">&#41;</span>;</pre>
<h2><a name="Parameters"></a><span class="mw-headline">Parameters</span></h2>
<dl><dt> crvOriginal</dt>
<dd>[input] Curve object which is copied</dd></dl>
<p><br />
</p>
<dl><dt> lpcszYData</dt>
<dd>[input] Name of Y Dataset</dd></dl>
<p><br />
</p>
<dl><dt> lpcszXData</dt>
<dd>[input] Name of X Dataset</dd>
<dt> lpcszYData</dt>
<dd>[input] Name of Y Dataset</dd></dl>
<p><br />
</p>
<dl><dt> dsX</dt>
<dd>[input] Origin C Dataset object attached to internal Origin X data set</dd>
<dt> dsY</dt>
<dd>[input] Origin C Dataset object attached to internal Origin Y data set</dd></dl>
<p><br />
</p>
<dl><dt> wks</dt>
<dd>[input] Origin C Dataset object attached to an internal Origin worksheet</dd>
<dt> nColX</dt>
<dd>[input] 0 based offset or column number of X column (data set)</dd>
<dt> nColY</dt>
<dd>[input] 0 based offset or column number of Y column (data set)</dd></dl>
<p><br />
</p>
<dl><dt> wks</dt>
<dd>[input] Origin C Dataset object attached to an internal Origin worksheet</dd>
<dt> nColY</dt>
<dd>[input] 0 based offset or column number of Y column (data set)</dd></dl>
<p><br />
</p>
<dl><dt> dp</dt>
<dd>[input] the data plot object to construct curve</dd></dl>
<p><br />
</p>
<dl><dt> cv</dt>
<dd>[input] source curve</dd>
<dt> nNumMissingInCopy</dt>
<dd>[output] number of missing values in the created curve.</dd>
<dt> nSrcOffset</dt>
<dd>[output] index in source curve that the result curve's 1st point is copied from</dd>
<dt> dwOptions</dt>
<dd>[input] a combination of values from the enumeration
<dl><dd>enum {</dd>
<dd>CURVECOPY_SCAN_OVER_MISSING_FROM_LEFT	= 0x00000001,   // if on, it will scan from the left (see the parameter nLower) until it finds the first nonmissing value</dd>
<dd>CURVECOPY_SCAN_OVER_MISSING_FROM_RIGHT	= 0x00000002,   // if on, it will scan back from the right (see the parameter nUpper) until it finds the first nonmissing value</dd>
<dd>CURVECOPY_SKIP_MISSING_INSIDE			= 0x00000004,   // if on, it will not copy any missing values found in the middle</dd>
<dd>CURVECOPY_REPLACE_MISSING_INSIDE		= 0x00000008,   // if on, any missing values in the middle will be replaced with the average of neighboring points (not used if the bit CURVECOPY_SKIP_MISSING_INSIDE  is on)</dd>
<dd>};</dd></dl></dd></dl>
<dl><dt> nLower</dt>
<dd>[input] lower index to start from or &lt;0 (-1) to start from the lower bound.</dd>
<dt> nUpper</dt>
<dd>[input] upper index to end at, or &lt;0 (-1) to end at the upper bound.</dd></dl>
<p><br />
</p>
<dl><dt> bTemp</dt>
<dd>[input] When bTemp = true, the operations on the Curve object do not affect the associated data plot and underlying data sets in Origin.</dd></dl>
<p><br />
</p>
<dl><dt>xy</dt>
<dd>[input] one XYRange object used to construct the Curve object.</dd></dl>
<h2><a name="Return"></a><span class="mw-headline">Return</span></h2>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p><b>EX1</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">void</span> Curve_Curve_ex1<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	<span style="color: #008000;">// Assumes the active worksheet contains column A and column B with data</span>
	Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>wks<span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		Curve crv; <span style="color: #008000;">// Use default constructor to create unattached Origin C Curve object</span>
		crv.<span style="color: #000000;">Attach</span><span style="color: #000000;">&#40;</span> wks, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">1</span> <span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Attach Origin C Curve object to internal Origin data sets</span>
	<span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>
<p><br />
<b>EX2</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">void</span> Curve_Curve_ex2<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	<span style="color: #008000;">// Assumes the active worksheet contains column A and column B with data</span>
	Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>wks<span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		Curve crv1<span style="color: #000000;">&#40;</span> wks, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">1</span> <span style="color: #000000;">&#41;</span>;
		Curve crv2<span style="color: #000000;">&#40;</span> crv1 <span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>
<p><br />
<b>EX3</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">void</span> Curve_Curve_ex3<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	<span style="color: #008000;">// Assumes the active worksheet contains column A and column B with data</span>
	Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>wks<span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		Dataset ds2<span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
		string strB <span style="color: #000080;">=</span> ds2.<span style="color: #000000;">GetName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
		Curve crv<span style="color: #000000;">&#40;</span>strB<span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>
<p><br />
<b>EX4</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">void</span> Curve_Curve_ex4<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	<span style="color: #008000;">// Assumes the active worksheet contains column A and column B with data</span>
	Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>wks<span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		Dataset ds1<span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
		Dataset ds2<span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
		string strA <span style="color: #000080;">=</span> ds1.<span style="color: #000000;">GetName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
		string strB <span style="color: #000080;">=</span> ds2.<span style="color: #000000;">GetName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
		
		Curve crv<span style="color: #000000;">&#40;</span> strA, strB <span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>
<p><br />
<b>EX5</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">void</span> Curve_Curve_ex5<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	<span style="color: #008000;">// Assumes the active worksheet contains column A and column B with data</span>
	Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>wks<span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		Dataset ds1<span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
		Dataset ds2<span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;		
		Curve crv<span style="color: #000000;">&#40;</span> ds1, ds2 <span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>
<p><br />
<b>EX6</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">void</span> Curve_Curve_ex6<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	<span style="color: #008000;">// Assumes the active worksheet contains column A and column B with data</span>
	Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>wks<span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		Curve crv<span style="color: #000000;">&#40;</span> wks, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">1</span> <span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// column A as X, column B as Y</span>
	<span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>
<p><br />
<b>EX7</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">void</span> Curve_Curve_ex7<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	<span style="color: #008000;">// Assumes the active worksheet contains column A and column B with data</span>
	Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>wks<span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		Curve crv<span style="color: #000000;">&#40;</span> wks, <span style="color: #0000dd;">1</span> <span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// column A as X, column B as Y</span>
	<span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>
<p><br />
<b>EX8</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">void</span> Curve_Curve_ex8<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	<span style="color: #008000;">// Assumes Graph window with one or more data plots is active in Origin</span>
	GraphLayer    gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Get active layer in project file</span>
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>gl<span style="color: #000000;">&#41;</span>                                  <span style="color: #008000;">// If valid graph layer...</span>
	<span style="color: #000000;">&#123;</span>
	    DataPlot dp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;      <span style="color: #008000;">// Get first data plot in graph layer</span>
	    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>dp<span style="color: #000000;">&#41;</span>                              <span style="color: #008000;">// If valid DataPlot...</span>
	    <span style="color: #000000;">&#123;</span>
	        Curve crv<span style="color: #000000;">&#40;</span>dp<span style="color: #000000;">&#41;</span>;                  <span style="color: #008000;">// Get Curve from DataPlot</span>
	    <span style="color: #000000;">&#125;</span>
	<span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>
<p><b>EX9</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// This example shows how to create a copy of xy data into a Curve object. </span>
<span style="color: #008000;">// This Curve constructor creates a Curve object consisting of doubles, </span>
<span style="color: #008000;">// which can then be used for analysis such as ocmath_integrate.</span>
<span style="color: #0000ff;">void</span> Curve_Curve_Ex9<span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> i1<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>, <span style="color: #0000ff;">int</span> i2<span style="color: #000080;">=</span><span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	<span style="color: #008000;">// Use Curve constructor to make a copy of Project.ActiveCurveBase() which is all numeric, double, without missing values.</span>
	<span style="color: #0000ff;">int</span> nMissing;
	<span style="color: #0000ff;">int</span> nSrcOffset;
	Curve cc<span style="color: #000000;">&#40;</span>Project.<span style="color: #000000;">ActiveCurveBase</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>, nMissing, nSrcOffset, CURVECOPY_SCAN_OVER_MISSING_FROM_LEFT <span style="color: #000040;">|</span> CURVECOPY_SCAN_OVER_MISSING_FROM_RIGHT <span style="color: #000040;">|</span> CURVECOPY_REPLACE_MISSING_INSIDE, i1, i2<span style="color: #000000;">&#41;</span>;

	<span style="color: #008000;">// get the upper and lower value for the integration</span>
	Dataset dx;
	cc.<span style="color: #000000;">AttachX</span><span style="color: #000000;">&#40;</span>dx<span style="color: #000000;">&#41;</span>;
	i1 <span style="color: #000080;">=</span> cc.<span style="color: #000000;">GetLowerIndex</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	i2 <span style="color: #000080;">=</span> cc.<span style="color: #000000;">GetUpperIndex</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	
	<span style="color: #008000;">// the Curve object cc can be passed into ocmath_integrate(), which requires a pointer to double in the second argument.</span>
	IntegrationResult irResult;
	ocmath_integrate<span style="color: #000000;">&#40;</span>dx, cc, i1, i2, <span style="color: #000040;">&amp;</span>irResult<span style="color: #000000;">&#41;</span>;
	
<span style="color: #000000;">&#125;</span></pre>
<p><b>EX10</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// This example illustrates the argument dwOptions for handling missing values.</span>
<span style="color: #008000;">// To run this example, create a worksheet with x, y data of say 20 values. </span>
<span style="color: #008000;">// Delete the y value for the first 3, last 2 and some middle two indices such as 10 and 11.</span>
<span style="color: #008000;">// Then create a plot, and make the plot active, then run Curve_Curve_Ex9 in the script window and examine the output.</span>
<span style="color: #0000ff;">void</span> Curve_Curve_Ex10<span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> i1<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>, <span style="color: #0000ff;">int</span> i2<span style="color: #000080;">=</span><span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	<span style="color: #0000ff;">int</span> nMissing;
	<span style="color: #0000ff;">int</span> nSrcOffset;
	
	curvebase<span style="color: #000040;">&amp;</span> cb <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveCurveBase</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	
	Curve cc<span style="color: #000000;">&#40;</span>cb, nMissing, nSrcOffset, <span style="color: #0000dd;">0</span>, i1, i2<span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;NMissing=%d, nSrcoffset index =&#160;%d<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, nMissing, nSrcOffset<span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span><span style="color: #000000;">&#41;</span>;
		
	Curve cc1<span style="color: #000000;">&#40;</span>cb, nMissing, nSrcOffset, CURVECOPY_SCAN_OVER_MISSING_FROM_LEFT, i1, i2<span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;CURVECOPY_SCAN_OVER_MISSING_FROM_LEFT,<span style="color: #666666; font-weight: bold;">\n</span> NMissing=%d, nSrcoffset index =&#160;%d<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, nMissing, nSrcOffset<span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span><span style="color: #000000;">&#41;</span>;
	
	Curve cc2<span style="color: #000000;">&#40;</span>cb, nMissing, nSrcOffset, CURVECOPY_SCAN_OVER_MISSING_FROM_RIGHT, i1, i2<span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;CURVECOPY_SCAN_OVER_MISSING_FROM_RIGHT,<span style="color: #666666; font-weight: bold;">\n</span> NMissing=%d, nSrcoffset index =&#160;%d<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, nMissing, nSrcOffset<span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span><span style="color: #000000;">&#41;</span>;
	
	Curve cc3<span style="color: #000000;">&#40;</span>cb, nMissing, nSrcOffset, CURVECOPY_SKIP_MISSING_INSIDE, i1, i2<span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;CURVECOPY_SKIP_MISSING_INSIDE,<span style="color: #666666; font-weight: bold;">\n</span> NMissing=%d, nSrcoffset index =&#160;%d<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, nMissing, nSrcOffset<span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Note: Left, right and inside missing valuses are skipped.<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span><span style="color: #000000;">&#41;</span>;
	
	Curve cc4<span style="color: #000000;">&#40;</span>cb, nMissing, nSrcOffset, CURVECOPY_REPLACE_MISSING_INSIDE, i1, i2<span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;CURVECOPY_REPLACE_MISSING_INSIDE,<span style="color: #666666; font-weight: bold;">\n</span> NMissing=%d, nSrcoffset index =&#160;%d<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, nMissing, nSrcOffset<span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Note: Only inside missing values are replaced by averages.<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span><span style="color: #000000;">&#41;</span>;
	
	Curve cc5<span style="color: #000000;">&#40;</span>cb, nMissing, nSrcOffset, CURVECOPY_SCAN_OVER_MISSING_FROM_LEFT <span style="color: #000040;">|</span> CURVECOPY_REPLACE_MISSING_INSIDE, i1, i2<span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;CURVECOPY_SCAN_OVER_MISSING_FROM_LEFT  | CURVECOPY_REPLACE_MISSING_INSIDE,<span style="color: #666666; font-weight: bold;">\n</span> NMissing=%d, nSrcoffset index =&#160;%d<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, nMissing, nSrcOffset<span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Note: CURVECOPY_REPLACE_MISSING_INSIDE does not work correctly if CURVECOPY_SCAN_OVER_MISSING_FROM_LEFT is also set and there are missing valuse on the left.<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span><span style="color: #000000;">&#41;</span>;
	
	Curve cc6<span style="color: #000000;">&#40;</span>cb, nMissing, nSrcOffset, CURVECOPY_SCAN_OVER_MISSING_FROM_LEFT <span style="color: #000040;">|</span> CURVECOPY_SCAN_OVER_MISSING_FROM_RIGHT <span style="color: #000040;">|</span> CURVECOPY_REPLACE_MISSING_INSIDE, i1, i2<span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;CURVECOPY_SCAN_OVER_MISSING_FROM_LEFT | CURVECOPY_SCAN_OVER_MISSING_FROM_RIGHT | CURVECOPY_REPLACE_MISSING_INSIDE,<span style="color: #666666; font-weight: bold;">\n</span> NMissing=%d, nSrcoffset index =&#160;%d<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, nMissing, nSrcOffset<span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Note: CURVECOPY_REPLACE_MISSING_INSIDE does not work correctly if CURVECOPY_SCAN_OVER_MISSING_FROM_RIGHT is also set and there are missing valuse on the right.<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<p><b>EX11</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// The example test_Curve_xfromY tests the function x_from_y_after_peak, which uses the Curve constructor.</span>
<span style="color: #008000;">// This example assumes you have some single peak data, and a plot of the data is active.</span>
<span style="color: #0000ff;">static</span> <span style="color: #0000ff;">int</span> IndexAtYMax<span style="color: #000000;">&#40;</span>Dataset <span style="color: #000040;">&amp;</span>aa<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	BasicStats	stat;
	stat.<span style="color: #000000;">iMin</span> <span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;
	stat.<span style="color: #000000;">iMax</span> <span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;
	Data_sum<span style="color: #000000;">&#40;</span><span style="color: #000040;">&amp;</span>aa, <span style="color: #000040;">&amp;</span>stat<span style="color: #000000;">&#41;</span>;
	<span style="color: #0000ff;">return</span> stat.<span style="color: #000000;">iMax</span>;
<span style="color: #000000;">&#125;</span>

<span style="color: #0000ff;">double</span> x_from_y_after_peak<span style="color: #000000;">&#40;</span>DataPlot<span style="color: #000040;">&amp;</span> dp, <span style="color: #0000ff;">double</span> y<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	Curve crv<span style="color: #000000;">&#40;</span>dp<span style="color: #000000;">&#41;</span>;
	<span style="color: #008000;">// first make a copy so we can sort and smooth it</span>
	<span style="color: #0000ff;">int</span> nMissing;
	<span style="color: #0000ff;">int</span> nSrcOffset;
	<span style="color: #008000;">// this is a copy constructor to scan and skip all missing values in both X and Y</span>
	Curve cvcpy<span style="color: #000000;">&#40;</span>crv, nMissing, nSrcOffset, CURVECOPY_SKIP_MISSING_INSIDE<span style="color: #000000;">&#41;</span>;
	cvcpy.<span style="color: #000000;">Sort</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// just incase data not monotonically increasing in X</span>
	smooth<span style="color: #000000;">&#40;</span>cvcpy, <span style="color: #0000dd;">0</span> , <span style="color: #0000dd;">3</span>, <span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>;<span style="color: #008000;">// apply simple adj ave with 3 pts on left and right</span>
	<span style="color: #0000ff;">int</span> nYmax <span style="color: #000080;">=</span> IndexAtYMax<span style="color: #000000;">&#40;</span>cvcpy<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// index of Peak</span>
	
	<span style="color: #008000;">// now make a new curve starting from the peak</span>
	Curve cvcpy2<span style="color: #000000;">&#40;</span>cvcpy, nMissing, nSrcOffset, CURVECOPY_SKIP_MISSING_INSIDE, nYmax<span style="color: #000000;">&#41;</span>;
	<span style="color: #0000ff;">return</span> Curve_xfromY<span style="color: #000000;">&#40;</span> <span style="color: #000040;">&amp;</span>cvcpy2, y <span style="color: #000000;">&#41;</span>; 
<span style="color: #000000;">&#125;</span>

<span style="color: #008000;">// now you can try this by plotting some data with a single peak</span>
<span style="color: #008000;">// and enter a y value and get x after the peak</span>
<span style="color: #0000ff;">void</span> Curve_Curve_ex11<span style="color: #000000;">&#40;</span><span style="color: #0000ff;">double</span> y<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	DataPlot dp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>; 
	<span style="color: #0000ff;">double</span> x <span style="color: #000080;">=</span> x_from_y_after_peak<span style="color: #000000;">&#40;</span>dp, y<span style="color: #000000;">&#41;</span>;
	
	<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;for y =&#160;%g, x =&#160;%g<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, y, x<span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<p><b>EX12</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">void</span> Curve_Curve_ex12<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    <span style="color: #008000;">// Assumes Graph window with one or more data plots is active in Origin</span>
    GraphLayer    gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; 	<span style="color: #008000;">// Get active layer in project file</span>
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>gl<span style="color: #000000;">&#41;</span>                                 
    <span style="color: #000000;">&#123;</span>
        DataPlot dp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;      	<span style="color: #008000;">// Get first data plot in graph layer</span>
        <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>dp<span style="color: #000000;">&#41;</span>                              	<span style="color: #008000;">// If valid DataPlot...</span>
        <span style="color: #000000;">&#123;</span>
            Curve crv<span style="color: #000000;">&#40;</span>dp, <span style="color: #0000ff;">FALSE</span><span style="color: #000000;">&#41;</span>;       		<span style="color: #008000;">//If FALSE, it will affect the associated data plot </span>
            crv<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
        <span style="color: #000000;">&#125;</span>
    <span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>
<p><b>EX13</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">void</span> Curve_Curve_ex13<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    <span style="color: #008000;">// Assumes Graph window with one or more data plots is active in Origin</span>
    GraphLayer    gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;   <span style="color: #008000;">// Get active layer in project file</span>
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>gl<span style="color: #000000;">&#41;</span>                                 
    <span style="color: #000000;">&#123;</span>
        DataPlot dp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;          <span style="color: #008000;">// Get first data plot in graph layer</span>
        <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>dp<span style="color: #000000;">&#41;</span>                                  <span style="color: #008000;">// If valid DataPlot...</span>
        <span style="color: #000000;">&#123;</span>
        	XYRange xy;
			dp.<span style="color: #000000;">GetDataRange</span><span style="color: #000000;">&#40;</span>xy<span style="color: #000000;">&#41;</span>;
            Curve crv<span style="color: #000000;">&#40;</span>xy<span style="color: #000000;">&#41;</span>;               
            crv<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
        <span style="color: #000000;">&#125;</span>
    <span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Remark"></a><span class="mw-headline">Remark</span></h2>
<h2><a name="See_Also"></a><span class="mw-headline">See Also</span></h2>
<p><a href="../../OriginC/OriginC/Curve-Attach.html" title="OriginC:Curve-Attach">Curve::Attach</a>, <a href="../../OriginC/OriginC/Curve-Detach.html" title="OriginC:Curve-Detach">Curve::Detach</a>
</p>
<h2><a name="Header_to_Include"></a><span class="mw-headline">Header to Include</span></h2>
<p>curve.h
</p>





