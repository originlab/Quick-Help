<h1 class="firstHeading">2.2.5.3.4 Registry::GetValue</h1><p><span class="OIndex" style="display:none">GetValue</span>
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Syntax"><span class="tocnumber">2</span> <span class="toctext">Syntax</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Parameters"><span class="tocnumber">3</span> <span class="toctext">Parameters</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Return"><span class="tocnumber">4</span> <span class="toctext">Return</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Examples"><span class="tocnumber">5</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Remark"><span class="tocnumber">6</span> <span class="toctext">Remark</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#See_Also"><span class="tocnumber">7</span> <span class="toctext">See Also</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Header_to_Include"><span class="tocnumber">8</span> <span class="toctext">Header to Include</span></a></li>
</ul>
</div>

<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>Retrieves the data for a specified value name associated with a subkey.
</p><p><br />
Retrieves the data for a specified value name associated with a subkey.
</p><p><br />
Retrieves the data for a specified value name associated with a subkey.
</p>
<h2><a name="Syntax"></a><span class="mw-headline">Syntax</span></h2>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">BOOL</span> GetValue<span style="color: #000000;">&#40;</span> LPCSTR lpSubKey, LPCSTR lpValueName, DWORD <span style="color: #000040;">&amp;</span> dwValue <span style="color: #000000;">&#41;</span></pre>
<p><br />
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">BOOL</span> GetValue<span style="color: #000000;">&#40;</span> LPCSTR lpSubKey, LPCSTR lpValueName, string <span style="color: #000040;">&amp;</span> strValue <span style="color: #000000;">&#41;</span></pre>
<p><br />
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">BOOL</span> GetValue<span style="color: #000000;">&#40;</span> LPCSTR lpSubKey, LPCSTR lpValueName, LPBYTE lpData, LPDWORD lpcbData, LPDWORD lpType <span style="color: #000080;">=</span> <span style="color: #0000ff;">NULL</span> <span style="color: #000000;">&#41;</span></pre>
<h2><a name="Parameters"></a><span class="mw-headline">Parameters</span></h2>
<dl><dt> lpSubKey</dt>
<dd>[input]Pointer to a null-terminated string containing the name of the subkey to open.</dd>
<dt> lpValueName</dt>
<dd>[input]Pointer to a string containing the name of the value to query.</dd>
<dd>If this parameter is NULL or an empty string, "", the function retrieves</dd>
<dd>the type and data for the key's unnamed or default value, if any.</dd>
<dt> dwValue</dt>
<dd>[output]A DWORD that receives the value of the data.</dd></dl>
<p><br />
</p>
<dl><dt> lpSubKey</dt>
<dd>[input]Pointer to a null-terminated string containing the name of the subkey to open.</dd>
<dt> lpValueName</dt>
<dd>[input]Pointer to a string containing the name of the value to query.</dd>
<dd>If this parameter is NULL or an empty string, "", the function retrieves</dd>
<dd>the type and data for the key's unnamed or default value, if any.</dd>
<dt> strValue</dt>
<dd>[output]A string that receives the value of the data.</dd></dl>
<p><br />
</p>
<dl><dt> lpSubKey</dt>
<dd>[input]Pointer to a null-terminated string containing the name of the subkey to open.</dd>
<dt> lpValueName</dt>
<dd>[input]Pointer to a string containing the name of the value to query.</dd>
<dd>If this parameter is NULL or an empty string, "", the function retrieves</dd>
<dd>the type and data for the key's unnamed or default value, if any.</dd>
<dt> lpData</dt>
<dd>[output]Pointer to a buffer that receives the value of the data. This parameter can be NULL if the data is not required.</dd>
<dt> lpcbData</dt>
<dd>[output]Pointer to a variable that specifies the size, in bytes, of the buffer pointed to by the lpData parameter.</dd>
<dd>When the function returns, this variable contains the size of the data copied to lpData.</dd>
<dt> lpType</dt>
<dd>[output]Pointer to a variable that receives the type of data associated with the specified value, The lpType parameter can be NULL if the type is not required.</dd></dl>
<h2><a name="Return"></a><span class="mw-headline">Return</span></h2>
<p>TRUE if key value pair is in registry, FALSE if not
</p><p><br />
TRUE if key value pair is in registry, FALSE if not
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p><b>EX1</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">void</span> Registry_GetValue_ex1<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    DWORD dwCntrl;
    Registry myRegAccess<span style="color: #000000;">&#40;</span>HKEY_CLASSES_ROOT<span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> myRegAccess.<span style="color: #000000;">HasKey</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;a<span style="color: #666666; font-weight: bold;">\\</span>b<span style="color: #666666; font-weight: bold;">\\</span>c&quot;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
        myRegAccess.<span style="color: #000000;">GetValue</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;a<span style="color: #666666; font-weight: bold;">\\</span>b<span style="color: #666666; font-weight: bold;">\\</span>c&quot;</span>, <span style="color: #ff00ff;">&quot;Control&quot;</span>, dwCntrl<span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<p><br />
<b>EX2</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">void</span> Registry_GetValue_ex2<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    string strLabel;
    Registry myRegAccess<span style="color: #000000;">&#40;</span>HKEY_CLASSES_ROOT<span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> myRegAccess.<span style="color: #000000;">HasKey</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;a<span style="color: #666666; font-weight: bold;">\\</span>b<span style="color: #666666; font-weight: bold;">\\</span>c&quot;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
        myRegAccess.<span style="color: #000000;">GetValue</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;a<span style="color: #666666; font-weight: bold;">\\</span>b<span style="color: #666666; font-weight: bold;">\\</span>c&quot;</span>, <span style="color: #ff00ff;">&quot;Label&quot;</span>, strLabel<span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<p><br />
<b>EX3</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#define</span> MY_BUFSIZE <span style="color: #0000dd;">8</span>
<span style="color: #0000ff;">void</span> Registry_GetValue_ex3<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    byte szValue<span style="color: #000000;">&#91;</span>MY_BUFSIZE<span style="color: #000000;">&#93;</span>;
    DWORD dwBufLen <span style="color: #000080;">=</span> MY_BUFSIZE;
    string strSubKey <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Classes<span style="color: #666666; font-weight: bold;">\\</span>CLSID<span style="color: #666666; font-weight: bold;">\\</span>{B0F21977-8AAB-4632-A73D-528B909C5663}<span style="color: #666666; font-weight: bold;">\\</span>InProcServer32&quot;</span>;

    Registry myRegAccess<span style="color: #000000;">&#40;</span>HKEY_CLASSES_ROOT<span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> myRegAccess.<span style="color: #000000;">HasKey</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;a<span style="color: #666666; font-weight: bold;">\\</span>b<span style="color: #666666; font-weight: bold;">\\</span>c&quot;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
        myRegAccess.<span style="color: #000000;">GetValue</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;a<span style="color: #666666; font-weight: bold;">\\</span>b<span style="color: #666666; font-weight: bold;">\\</span>c&quot;</span>, strSubKey, <span style="color: #000000;">&#40;</span>LPBYTE<span style="color: #000000;">&#41;</span>szValue, <span style="color: #000040;">&amp;</span>dwBufLen<span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Remark"></a><span class="mw-headline">Remark</span></h2>
<h2><a name="See_Also"></a><span class="mw-headline">See Also</span></h2>
<h2><a name="Header_to_Include"></a><span class="mw-headline">Header to Include</span></h2>
<p>origin.h
</p>





