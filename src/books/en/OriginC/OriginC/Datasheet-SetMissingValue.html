<h1 class="firstHeading">2.2.4.12.22 Datasheet::SetMissingValue</h1><p><span class="OIndex" style="display:none">SetMissingValue</span>
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Syntax"><span class="tocnumber">2</span> <span class="toctext">Syntax</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Parameters"><span class="tocnumber">3</span> <span class="toctext">Parameters</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Return"><span class="tocnumber">4</span> <span class="toctext">Return</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Examples"><span class="tocnumber">5</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Remark"><span class="tocnumber">6</span> <span class="toctext">Remark</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#See_Also"><span class="tocnumber">7</span> <span class="toctext">See Also</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Header_to_Include"><span class="tocnumber">8</span> <span class="toctext">Header to Include</span></a></li>
</ul>
</div>

<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>Set Missing Value to each Column or MatrixObjects in the specified range
This function will not change internal data type, should just set missing value if nType matchs and immediately return if not
</p>
<h2><a name="Syntax"></a><span class="mw-headline">Syntax</span></h2>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">int</span> SetMissingValue<span style="color: #000000;">&#40;</span> <span style="color: #0000ff;">int</span> nType, LPVOID pVal, <span style="color: #0000ff;">int</span> nC1 <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>, <span style="color: #0000ff;">int</span> nC2 <span style="color: #000080;">=</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span> <span style="color: #000000;">&#41;</span></pre>
<h2><a name="Parameters"></a><span class="mw-headline">Parameters</span></h2>
<dl><dt> nType</dt>
<dd>[input] internal data type that the missing value, FSI_REAL, FSI_SHORT etc</dd>
<dt> pVal</dt>
<dd>[input] pointer to the missing value</dd>
<dt> nC1</dt>
<dd>[input] starting column or matrixobject index, 0 offset</dd>
<dt> nC2</dt>
<dd>[input] ending column or matrixobject index, -1 to the end</dd></dl>
<h2><a name="Return"></a><span class="mw-headline">Return</span></h2>
<p>return 0 if success, &gt; 0 with 1-offset col index where it failed
</p><p>return &lt; 0 error code when col/mat type does not match nType and other error codes.
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p><b>EX1</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">//Set the value of 1E-10 cells to missing value.</span>
<span style="color: #0000ff;">void</span> Datasheet_SetMissingValue_Ex1<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    Worksheet wks;
    wks.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>wks<span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        <span style="color: #0000ff;">int</span> nType <span style="color: #000080;">=</span> FSI_MIXED;
        <span style="color: #0000ff;">double</span> dMissing <span style="color: #000080;">=</span> 1E<span style="color: #000040;">-</span>10;
        <span style="color: #0000ff;">int</span> nRet <span style="color: #000080;">=</span> wks.<span style="color: #000000;">SetMissingValue</span><span style="color: #000000;">&#40;</span>nType, <span style="color: #000040;">&amp;</span>dMissing<span style="color: #000000;">&#41;</span>;
        
        string strMessage <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Succeed to set missing value to workbook &quot;</span> <span style="color: #000040;">+</span> wks.<span style="color: #000000;">GetPage</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>.<span style="color: #000000;">GetName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>nRet <span style="color: #000080;">&gt;</span> <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>
            strMessage <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Failed to set the &quot;</span> <span style="color: #000040;">+</span> ftoa<span style="color: #000000;">&#40;</span>nRet<span style="color: #000000;">&#41;</span> <span style="color: #000040;">+</span> <span style="color: #ff00ff;">&quot;th Column&quot;</span>;
        <span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>nRet <span style="color: #000080;">&lt;</span> <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>
            strMessage <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;col/mat type does not match nType or other error&quot;</span>;
        
        <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;%s<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, strMessage<span style="color: #000000;">&#41;</span>;
    <span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Remark"></a><span class="mw-headline">Remark</span></h2>
<h2><a name="See_Also"></a><span class="mw-headline">See Also</span></h2>
<h2><a name="Header_to_Include"></a><span class="mw-headline">Header to Include</span></h2>
<p>origin.h
</p>





