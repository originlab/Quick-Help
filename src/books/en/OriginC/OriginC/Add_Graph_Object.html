<h1 class="firstHeading">3.4.1 Add Graph Object</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Version_Info"><span class="tocnumber">1</span> <span class="toctext">Version Info</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Remark"><span class="tocnumber">2</span> <span class="toctext">Remark</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Add_Text"><span class="tocnumber">3</span> <span class="toctext">Add Text</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Add_Line"><span class="tocnumber">4</span> <span class="toctext">Add Line</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Add_Rectangle"><span class="tocnumber">5</span> <span class="toctext">Add Rectangle</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Add_Curved_Arrow_Tool"><span class="tocnumber">6</span> <span class="toctext">Add Curved Arrow Tool</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Add_Polygon_Tool"><span class="tocnumber">7</span> <span class="toctext">Add Polygon Tool</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Add_Polypolygon"><span class="tocnumber">8</span> <span class="toctext">Add Polypolygon</span></a></li>
</ul>
</div>

<p><br />
</p>
<h2><a name="Version_Info"></a><span class="mw-headline">Version Info</span></h2>
<p class="version" >Minimum Origin Version Required: Origin 8 SR0</p>
<h2><a name="Remark"></a><span class="mw-headline">Remark</span></h2>
<p>We can create Graph Object like line, text, retangle on graph, worksheet or matrix window. More details about GraphObject class please reference to <a href="../../OriginC/Category/GraphObject_(class).html" title="Category:GraphObject (class)">GraphObject</a> and <a href="../../OriginC/Category/GraphLayer_(class).html" title="Category:GraphLayer (class)">GraphLayer</a> and <a href="../../OriginC/Category/PolyPolylineGraphObject_(class).html" title="Category:PolyPolylineGraphObject (class)">PolyPolylineGraphObject</a>
</p>
<h2><a name="Add_Text"></a><span class="mw-headline">Add Text</span></h2>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">void</span> AddText<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    GraphPage gp;
    gp.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Origin&quot;</span><span style="color: #000000;">&#41;</span>;
    GraphLayer gl <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// get the first layer</span>
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>gl<span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
    	<span style="color: #008000;">// add a Text named MyText</span>
        GraphObject    	go <span style="color: #000080;">=</span> gl.<span style="color: #000000;">CreateGraphObject</span><span style="color: #000000;">&#40;</span>GROT_TEXT<span style="color: #000000;">&#41;</span>;
        go.<span style="color: #000000;">SetName</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;MyText&quot;</span><span style="color: #000000;">&#41;</span>;
        <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> go <span style="color: #000000;">&#41;</span>
        <span style="color: #000000;">&#123;</span>
        	go.<span style="color: #000000;">Text</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;New Label&quot;</span>;
        <span style="color: #000000;">&#125;</span>        
        gl.<span style="color: #000000;">GetPage</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>.<span style="color: #000000;">Refresh</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Add_Line"></a><span class="mw-headline">Add Line</span></h2>
<p>Keep a graph window ative and run below <b>AddLine</b> function to add one vertical line and one horizontal line.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">void</span> AddLine<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> gl <span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>		
		<span style="color: #008000;">// add vertical line and set position</span>
		GraphObject goVLine <span style="color: #000080;">=</span> gl.<span style="color: #000000;">CreateGraphObject</span><span style="color: #000000;">&#40;</span>GROT_LINE<span style="color: #000000;">&#41;</span>;
		goVLine.<span style="color: #000000;">SetName</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;vline&quot;</span><span style="color: #000000;">&#41;</span>;
		goVLine.<span style="color: #000000;">X</span> <span style="color: #000080;">=</span> gl.<span style="color: #000000;">X</span>.<span style="color: #000000;">From</span> <span style="color: #000040;">+</span> <span style="color: #000000;">&#40;</span>gl.<span style="color: #000000;">X</span>.<span style="color: #000000;">To</span> <span style="color: #000040;">-</span> gl.<span style="color: #000000;">X</span>.<span style="color: #000000;">From</span><span style="color: #000000;">&#41;</span> <span style="color: #000040;">/</span> <span style="color: #0000dd;">2</span>; <span style="color: #008000;">// set the init position of vertical line</span>
		
		<span style="color: #008000;">// set direction, script</span>
		string strScript <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;type -a &quot;</span> <span style="color: #000040;">+</span> <span style="color: #ff00ff;">&quot; <span style="color: #666666; font-weight: bold;">\&quot;</span>X = $(vline.X)<span style="color: #666666; font-weight: bold;">\&quot;</span> &quot;</span>; <span style="color: #008000;">// set this script, moving vertical line will print out X pos to Command window.</span>
		SetLineFormat<span style="color: #000000;">&#40;</span>goVLine, LN_VERTICAL, strScript, GRCT_MOVE<span style="color: #000000;">&#41;</span>;		
		
		
		<span style="color: #008000;">// add horizontal line and set position</span>
		GraphObject goHLine <span style="color: #000080;">=</span> gl.<span style="color: #000000;">CreateGraphObject</span><span style="color: #000000;">&#40;</span>GROT_LINE<span style="color: #000000;">&#41;</span>;
		goHLine.<span style="color: #000000;">SetName</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;hline&quot;</span><span style="color: #000000;">&#41;</span>;			
		goHLine.<span style="color: #000000;">Y</span> <span style="color: #000080;">=</span> gl.<span style="color: #000000;">Y</span>.<span style="color: #000000;">From</span> <span style="color: #000040;">+</span> <span style="color: #000000;">&#40;</span>gl.<span style="color: #000000;">Y</span>.<span style="color: #000000;">To</span> <span style="color: #000040;">-</span> gl.<span style="color: #000000;">Y</span>.<span style="color: #000000;">From</span><span style="color: #000000;">&#41;</span> <span style="color: #000040;">/</span> <span style="color: #0000dd;">2</span>;	<span style="color: #008000;">// set the init position of horizontal line</span>
		
		<span style="color: #008000;">// set direction, script</span>
		strScript <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;type -a &quot;</span> <span style="color: #000040;">+</span> <span style="color: #ff00ff;">&quot; <span style="color: #666666; font-weight: bold;">\&quot;</span>Y = $(hline.Y)<span style="color: #666666; font-weight: bold;">\&quot;</span> &quot;</span>; <span style="color: #008000;">// set this script, moving horizontal line will print out Y pos to Command window.</span>
		SetLineFormat<span style="color: #000000;">&#40;</span>goHLine, LN_HORIZONTAL, strScript, GRCT_MOVE<span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span>

<span style="color: #008000;">// set line object properties, script, format, color, width, attach mode, direction...</span>
<span style="color: #0000ff;">void</span> SetLineFormat<span style="color: #000000;">&#40;</span>GraphObject<span style="color: #000040;">&amp;</span> goLine, <span style="color: #0000ff;">int</span> nDirection, string strScript, <span style="color: #0000ff;">int</span> nExecMode<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	goLine.<span style="color: #000000;">Attach</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;<span style="color: #008000;">// 2, layer and scale</span>
	
	Tree tr;		
	tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Span</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; <span style="color: #008000;">// 1 to span over the whole layer</span>
	tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Direction</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> nDirection; <span style="color: #008000;">// vertical or horizontal	</span>
	tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Color</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> SYSCOLOR_RED;
	tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Width</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;
	tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Event</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> nExecMode;
	tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Script</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> strScript; <span style="color: #008000;">// set script, run it after the Event specified by nExecMode</span>
	
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> goLine.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">&#40;</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span> <span style="color: #008000;">// 0 means no error</span>
	<span style="color: #000000;">&#123;</span>
		<span style="color: #0000ff;">bool</span> bRet <span style="color: #000080;">=</span> goLine.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">&#40;</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// return true if applied format successfully</span>
	<span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Add_Rectangle"></a><span class="mw-headline">Add Rectangle</span></h2>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">void</span> AddRectangle<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	GraphPage gp;
	gp.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Origin&quot;</span><span style="color: #000000;">&#41;</span>;
	
	GraphLayer gl <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;	
	GraphObject goRect <span style="color: #000080;">=</span> gl.<span style="color: #000000;">CreateGraphObject</span><span style="color: #000000;">&#40;</span>GROT_RECT<span style="color: #000000;">&#41;</span>;	
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Add_Curved_Arrow_Tool"></a><span class="mw-headline">Add Curved Arrow Tool</span></h2>
<p>This example shows how to add a curved arrow line on graph window, and how to change vertices of curve arrow line. In the following function, if replace GROBJ_TN_LINE4 to GROT_POLYLINE, the graph object will be Polyline.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>..\Originlab\grobj_utils.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span>
<span style="color: #0000ff;">void</span> graph_object_line4_ex<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	GraphPage gp;
	gp.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;origin&quot;</span><span style="color: #000000;">&#41;</span>;
	GraphLayer gl <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;	

	GraphObject go;
	go <span style="color: #000080;">=</span> gl.<span style="color: #000000;">CreateGraphObject</span><span style="color: #000000;">&#40;</span>GROBJ_TN_LINE4<span style="color: #000000;">&#41;</span>;
	
	go.<span style="color: #000000;">Attach</span> <span style="color: #000080;">=</span> ATTACH_TO_SCALE;
	
	Tree tr;
	tr <span style="color: #000080;">=</span> go.<span style="color: #000000;">GetFormat</span><span style="color: #000000;">&#40;</span>FPB_DATA, FOB_ALL, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;
	
	<span style="color: #008000;">// to take a look on default position</span>
	vector vx0, vy0;
	vx0 <span style="color: #000080;">=</span> tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Data</span>.<span style="color: #000000;">X</span>.<span style="color: #000000;">dVals</span>;
	vy0 <span style="color: #000080;">=</span> tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Data</span>.<span style="color: #000000;">Y</span>.<span style="color: #000000;">dVals</span>;
	
	<span style="color: #008000;">// to set the proper position for four points</span>
	vector vx <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">2.2</span>, <span style="color: #0000dd;">4.7</span>, <span style="color: #0000dd;">6.58</span>, <span style="color: #0000dd;">7.16</span><span style="color: #000000;">&#125;</span>;
	vector vy <span style="color: #000080;">=</span><span style="color: #000000;">&#123;</span><span style="color: #0000dd;">5.7</span>, <span style="color: #0000dd;">4.22</span>, <span style="color: #0000dd;">5.12</span>, <span style="color: #0000dd;">7.35</span><span style="color: #000000;">&#125;</span>;
	tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Data</span>.<span style="color: #000000;">X</span>.<span style="color: #000000;">dVals</span> <span style="color: #000080;">=</span> vx;
	tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Data</span>.<span style="color: #000000;">Y</span>.<span style="color: #000000;">dVals</span> <span style="color: #000080;">=</span> vy;
    tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Arrow</span>.<span style="color: #000000;">End</span>.<span style="color: #000000;">Style</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; <span style="color: #008000;">// add arrow to the end</span>
	
	<span style="color: #0000ff;">int</span> nErr <span style="color: #000080;">=</span> go.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">&#40;</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>nErr <span style="color: #000080;">==</span> <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		go.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">&#40;</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">&#125;</span>
	<span style="color: #0000ff;">else</span>
	<span style="color: #000000;">&#123;</span>
		out_int<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;err = &quot;</span>, nErr<span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Add_Polygon_Tool"></a><span class="mw-headline">Add Polygon Tool</span></h2>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>..\Originlab\grobj_utils.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span>
<span style="color: #0000ff;">void</span> graph_object_create_polygon_ex<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    GraphPage gp;
    gp.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;origin&quot;</span><span style="color: #000000;">&#41;</span>;
    GraphLayer gl <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;    
 
    GraphObject go;
    go <span style="color: #000080;">=</span> gl.<span style="color: #000000;">CreateGraphObject</span><span style="color: #000000;">&#40;</span>GROT_POLYGON<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// create polygon by type id</span>
 
    go.<span style="color: #000000;">Attach</span> <span style="color: #000080;">=</span> ATTACH_TO_SCALE;
 
    Tree tr;
    tr <span style="color: #000080;">=</span> go.<span style="color: #000000;">GetFormat</span><span style="color: #000000;">&#40;</span>FPB_DATA, FOB_ALL, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;<span style="color: #008000;">// FPB_DATA bit to control the accessing of vertices of graph object</span>
 
    <span style="color: #008000;">// When polygon is just created, there are no vertices, so need to set them</span>
    <span style="color: #008000;">// The size of vx and vy vectors below will determine the number of points of the graph object</span>
    Tree trNew;
    vector vx <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">2.4</span>, <span style="color: #0000dd;">4.6</span>, <span style="color: #0000dd;">7.3</span>, <span style="color: #0000dd;">6.8</span><span style="color: #000000;">&#125;</span>;
    vector vy <span style="color: #000080;">=</span><span style="color: #000000;">&#123;</span><span style="color: #0000dd;">4.8</span>, <span style="color: #0000dd;">7.9</span>, <span style="color: #0000dd;">7.2</span>, <span style="color: #0000dd;">1.6</span><span style="color: #000000;">&#125;</span>;
    trNew.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Data</span>.<span style="color: #000000;">X</span>.<span style="color: #000000;">dVals</span> <span style="color: #000080;">=</span> vx;
    trNew.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Data</span>.<span style="color: #000000;">Y</span>.<span style="color: #000000;">dVals</span> <span style="color: #000080;">=</span> vy;
 
    <span style="color: #0000ff;">int</span> nErr <span style="color: #000080;">=</span> go.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">&#40;</span>trNew.<span style="color: #000000;">Root</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>nErr <span style="color: #000080;">==</span> <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        go.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">&#40;</span>trNew, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #000000;">&#125;</span>
    <span style="color: #0000ff;">else</span>
    <span style="color: #000000;">&#123;</span>
        out_int<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;err = &quot;</span>, nErr<span style="color: #000000;">&#41;</span>;
    <span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Add_Polypolygon"></a><span class="mw-headline">Add Polypolygon</span></h2>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> make_circle<span style="color: #000000;">&#40;</span>vector<span style="color: #000040;">&amp;</span> vx, vector<span style="color: #000040;">&amp;</span> vy, <span style="color: #0000ff;">int</span> nSize, <span style="color: #0000ff;">double</span> x0, <span style="color: #0000ff;">double</span> y0, <span style="color: #0000ff;">double</span> rr<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	vx.<span style="color: #000000;">SetSize</span><span style="color: #000000;">&#40;</span>nSize<span style="color: #000000;">&#41;</span>;
	vy.<span style="color: #000000;">SetSize</span><span style="color: #000000;">&#40;</span>nSize<span style="color: #000000;">&#41;</span>;

	<span style="color: #0000ff;">double</span> inc <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>.<span style="color: #000040;">*</span> pi<span style="color: #000040;">/</span>nSize;
	<span style="color: #0000ff;">double</span> ang<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;
	<span style="color: #0000ff;">for</span><span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; ii <span style="color: #000080;">&lt;</span>nSize; ii<span style="color: #000040;">++</span>, ang<span style="color: #000040;">+</span><span style="color: #000080;">=</span> inc<span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		vx<span style="color: #000000;">&#91;</span>ii<span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> x0 <span style="color: #000040;">+</span> rr<span style="color: #000040;">*</span> <span style="color: #000000;">sin</span><span style="color: #000000;">&#40;</span>ang<span style="color: #000000;">&#41;</span>;
		vy<span style="color: #000000;">&#91;</span>ii<span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> y0 <span style="color: #000040;">+</span> rr<span style="color: #000040;">*</span> <span style="color: #000000;">cos</span><span style="color: #000000;">&#40;</span>ang<span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span>

<span style="color: #0000ff;">void</span> many_circles<span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> nRegNum <span style="color: #000080;">=</span> <span style="color: #0000dd;">100</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #0000ff;">double</span> x1, x2, y1, y2, x0, y0, rr;
	x1 <span style="color: #000080;">=</span> gl.<span style="color: #000000;">X</span>.<span style="color: #000000;">From</span>, x2 <span style="color: #000080;">=</span> gl.<span style="color: #000000;">X</span>.<span style="color: #000000;">To</span>;
	y1 <span style="color: #000080;">=</span> gl.<span style="color: #000000;">Y</span>.<span style="color: #000000;">From</span>, y2 <span style="color: #000080;">=</span> gl.<span style="color: #000000;">Y</span>.<span style="color: #000000;">To</span>;

	PolyPolylineGraphObject go;
	go <span style="color: #000080;">=</span> gl.<span style="color: #000000;">CreateGraphObject</span><span style="color: #000000;">&#40;</span>GROT_POLYPOLYGON, <span style="color: #ff00ff;">&quot;PP&quot;</span><span style="color: #000000;">&#41;</span>;
	go.<span style="color: #000000;">Attach</span> <span style="color: #000080;">=</span> ATTACH_TO_SCALE;
	<span style="color: #008000;">// Set Label for polypolygon</span>
	go.<span style="color: #000000;">SetDrawOption</span><span style="color: #000000;">&#40;</span>POLYPOLYLINE_DRAW_OPTION_NEED_TEXT<span style="color: #000000;">&#41;</span>;

	vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">double</span><span style="color: #000080;">&gt;</span> vx, vy; 
	<span style="color: #0000ff;">for</span><span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; ii <span style="color: #000080;">&lt;</span> nRegNum&#160;; ii <span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		x0 <span style="color: #000080;">=</span> x1 <span style="color: #000040;">+</span> <span style="color: #000000;">&#40;</span>x2<span style="color: #000040;">-</span>x1<span style="color: #000000;">&#41;</span> <span style="color: #000040;">*</span> rnd<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
		y0 <span style="color: #000080;">=</span> y1 <span style="color: #000040;">+</span> <span style="color: #000000;">&#40;</span>y2<span style="color: #000040;">-</span>y1<span style="color: #000000;">&#41;</span> <span style="color: #000040;">*</span>rnd<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
		rr <span style="color: #000080;">=</span> <span style="color: #000000;">&#40;</span>x2<span style="color: #000040;">-</span>x1<span style="color: #000000;">&#41;</span><span style="color: #000040;">/</span><span style="color: #0000dd;">50</span> <span style="color: #000040;">+</span> rnd<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000040;">*</span> <span style="color: #000000;">&#40;</span>x2<span style="color: #000040;">-</span>x1<span style="color: #000000;">&#41;</span><span style="color: #000040;">/</span><span style="color: #0000dd;">100</span>;
		make_circle<span style="color: #000000;">&#40;</span>vx, vy, <span style="color: #0000dd;">40</span>, x0, y0, rr<span style="color: #000000;">&#41;</span>;
		go.<span style="color: #000000;">AddPolyline</span><span style="color: #000000;">&#40;</span>vx, vy<span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">&#125;</span>
	
	Tree tr;
	tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Fill</span>.<span style="color: #000000;">Color</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> INDEX_COLOR_TRANSPARENT;
	tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Border</span>.<span style="color: #000000;">Color</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> SYSCOLOR_YELLOW;
	tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Border</span>.<span style="color: #000000;">Width</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0.2</span>;
	
	tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">States</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> GOC_NO_SELECT;
	
	<span style="color: #0000ff;">int</span> nRet <span style="color: #000080;">=</span> go.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">&#40;</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">&#41;</span>;
	go.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">&#40;</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;

	gl.<span style="color: #000000;">GetPage</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>.<span style="color: #000000;">Refresh</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;done&quot;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>






