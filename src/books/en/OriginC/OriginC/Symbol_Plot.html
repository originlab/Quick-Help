<h1 class="firstHeading">3.3.5 Symbol Plot</h1><p>To run the following examples, please run the LabTalk script below first to prepare a new workbook with the "Group.DAT" data. Make sure that the new created workbook should be active before running each example.
</p>
<pre class="lt" style="font-family:monospace;">newbook;  <span style="color: #008000;">// create a new workbook</span>
fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Graphing\Group.DAT&quot;</span>;  <span style="color: #008000;">// file path</span>
impasc;  <span style="color: #008000;">// import the file to the new workbook</span></pre>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Simple_Scatter_Plot"><span class="tocnumber">1</span> <span class="toctext">Simple Scatter Plot</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Scatter_Central_Plot"><span class="tocnumber">2</span> <span class="toctext">Scatter Central Plot</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Y_Error_Plot"><span class="tocnumber">3</span> <span class="toctext">Y Error Plot</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#XY_Error_Plot"><span class="tocnumber">4</span> <span class="toctext">XY Error Plot</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Bubble_Plot"><span class="tocnumber">5</span> <span class="toctext">Bubble Plot</span></a></li>
</ul>
</div>

<h2><a name="Simple_Scatter_Plot"></a><span class="mw-headline">Simple Scatter Plot</span></h2>
<p class="version" >Minimum Origin Version Required: Origin 8 SR2</p>
<p>This example is used to create a simple scatter plot with some changes on the symbol type, size, color, etc..
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">void</span> simple_scatter_plot<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// get worksheet with group.dat data</span>
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #000040;">!</span>wks <span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Please activate worksheet with group.dat data!&quot;</span><span style="color: #000000;">&#41;</span>;
		<span style="color: #0000ff;">return</span>;
	<span style="color: #000000;">&#125;</span>
	
	<span style="color: #008000;">// plot simple scatter plot</span>
	DataRange dr;
	dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">0</span>, <span style="color: #ff00ff;">&quot;X&quot;</span><span style="color: #000000;">&#41;</span>;
	dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">1</span>, <span style="color: #ff00ff;">&quot;Y&quot;</span><span style="color: #000000;">&#41;</span>;
	
	GraphPage gp;
	gp.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;scatter&quot;</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// create scatter graph</span>
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #000040;">!</span>gp <span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Failed to create scatter plot!&quot;</span><span style="color: #000000;">&#41;</span>;
		<span style="color: #0000ff;">return</span>;
	<span style="color: #000000;">&#125;</span>
	
	GraphLayer gl <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
	
	<span style="color: #0000ff;">int</span> nPlot <span style="color: #000080;">=</span> gl.<span style="color: #000000;">AddPlot</span><span style="color: #000000;">&#40;</span>dr, IDM_PLOT_SCATTER<span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// add plot to layer</span>
	
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> nPlot <span style="color: #000080;">&gt;=</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">&#41;</span>  <span style="color: #008000;">// if add plot successfully</span>
	<span style="color: #000000;">&#123;</span>
		DataPlot dp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
		dp.<span style="color: #000000;">SetSymbol</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">12</span><span style="color: #000000;">&#41;</span>;   <span style="color: #008000;">// set symbol shape: empty circle</span>
		dp.<span style="color: #000000;">SetColor</span><span style="color: #000000;">&#40;</span>SYSCOLOR_BLUE<span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// set color: blue</span>
		
		Tree trFormat;
		trFormat.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Symbol</span>.<span style="color: #000000;">Size</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">12</span>; <span style="color: #008000;">// set size: 12</span>
		trFormat.<span style="color: #000000;">Root</span>.<span style="color: #000000;">DropLines</span>.<span style="color: #000000;">Vertical</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000ff;">true</span>;  <span style="color: #008000;">// add vertical droplines</span>
		<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> dp.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">&#40;</span>trFormat.<span style="color: #000000;">Root</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
		<span style="color: #000000;">&#123;</span>
			dp.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">&#40;</span>trFormat, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;
		<span style="color: #000000;">&#125;</span>
		
		gl.<span style="color: #000000;">Rescale</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Scatter_Central_Plot"></a><span class="mw-headline">Scatter Central Plot</span></h2>
<p class="version" >Minimum Origin Version Required: Origin 8 SR5</p>
<p>This example is used to create a scatter central plot with some changes on the symbol color and shape.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">void</span> scatter_central_plot<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// get worksheet with group.dat data</span>
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #000040;">!</span>wks <span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Please activate worksheet with group.dat data!&quot;</span><span style="color: #000000;">&#41;</span>;
		<span style="color: #0000ff;">return</span>;
	<span style="color: #000000;">&#125;</span>
	
	<span style="color: #008000;">// plot scatter central plot</span>
	DataRange dr;
	dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">0</span>, <span style="color: #ff00ff;">&quot;X&quot;</span><span style="color: #000000;">&#41;</span>;
	dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">1</span>, <span style="color: #ff00ff;">&quot;Y&quot;</span><span style="color: #000000;">&#41;</span>;
	
	GraphPage gp;
	gp.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;ScatterCentral&quot;</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// create scatter central graph</span>
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #000040;">!</span>gp <span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Failed to create scatter central plot!&quot;</span><span style="color: #000000;">&#41;</span>;
		<span style="color: #0000ff;">return</span>;
	<span style="color: #000000;">&#125;</span>
	
	GraphLayer gl <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
	
	<span style="color: #0000ff;">int</span> nPlot <span style="color: #000080;">=</span> gl.<span style="color: #000000;">AddPlot</span><span style="color: #000000;">&#40;</span>dr, IDM_PLOT_SCATTER<span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// add plot to layer</span>
	
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> nPlot <span style="color: #000080;">&gt;=</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">&#41;</span>  <span style="color: #008000;">// if add plot successfully</span>
	<span style="color: #000000;">&#123;</span>
		DataPlot dp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
		dp.<span style="color: #000000;">SetSymbol</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">110</span><span style="color: #000000;">&#41;</span>;   <span style="color: #008000;">// set symbol shape: sphere</span>
		dp.<span style="color: #000000;">SetColor</span><span style="color: #000000;">&#40;</span>SYSCOLOR_RED<span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// set color: red</span>
			
		gl.<span style="color: #000000;">Rescale</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Y_Error_Plot"></a><span class="mw-headline">Y Error Plot</span></h2>
<p class="version" >Minimum Origin Version Required: Origin 8.1 SR1</p>
<p>This example is used to create a Y error plot. It also changes some formats of the symbols and error bars.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">void</span> y_error_plot<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// get worksheet with group.dat data</span>
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #000040;">!</span>wks <span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Please activate worksheet with group.dat data!&quot;</span><span style="color: #000000;">&#41;</span>;
		<span style="color: #0000ff;">return</span>;
	<span style="color: #000000;">&#125;</span>
	
	<span style="color: #008000;">// plot simple scatter plot</span>
	DataRange dr;
	dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">0</span>, <span style="color: #ff00ff;">&quot;X&quot;</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// X column</span>
	dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">1</span>, <span style="color: #ff00ff;">&quot;Y&quot;</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// Y column</span>
	dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">3</span>, <span style="color: #ff00ff;">&quot;ED&quot;</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// Error column</span>
	
	GraphPage gp;
	gp.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Errbar&quot;</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// create error bar</span>
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #000040;">!</span>gp <span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Failed to create scatter central plot!&quot;</span><span style="color: #000000;">&#41;</span>;
		<span style="color: #0000ff;">return</span>;
	<span style="color: #000000;">&#125;</span>
	
	GraphLayer gl <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
	
	<span style="color: #0000ff;">int</span> nPlot <span style="color: #000080;">=</span> gl.<span style="color: #000000;">AddPlot</span><span style="color: #000000;">&#40;</span>dr, IDM_PLOT_SCATTER<span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// add plot to layer</span>
	
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> nPlot <span style="color: #000080;">&gt;=</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">&#41;</span>  <span style="color: #008000;">// if add plot successfully</span>
	<span style="color: #000000;">&#123;</span>
		<span style="color: #0000ff;">for</span><span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> nPlot<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>; nPlot<span style="color: #000080;">&lt;</span>gl.<span style="color: #000000;">DataPlots</span>.<span style="color: #000000;">Count</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; nPlot<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span>  <span style="color: #008000;">// set format for plots in the layer</span>
		<span style="color: #000000;">&#123;</span>
			DataPlot dp;
			<span style="color: #0000ff;">switch</span> <span style="color: #000000;">&#40;</span>nPlot<span style="color: #000000;">&#41;</span>
			<span style="color: #000000;">&#123;</span>
				<span style="color: #0000ff;">case</span> <span style="color: #0000dd;">0</span><span style="color: #000000;">:</span>
					dp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// scatter plot</span>
					
					dp.<span style="color: #000000;">SetColor</span><span style="color: #000000;">&#40;</span>SYSCOLOR_RED<span style="color: #000000;">&#41;</span>;   <span style="color: #008000;">// set color</span>
					
					Column colSize;					
					colSize <span style="color: #000080;">=</span> wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// column C</span>
					dp.<span style="color: #000000;">SetModifier</span><span style="color: #000000;">&#40;</span>COLDESIG_SIZE, colSize<span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// column C as size</span>
					
					Tree trFormat;					
					trFormat.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Symbol</span>.<span style="color: #000000;">Scale</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>.;  <span style="color: #008000;">// scaling factor</span>
					trFormat.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Symbol</span>.<span style="color: #000000;">Shape</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>;   <span style="color: #008000;">// symbol shape: diamond</span>
					trFormat.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Symbol</span>.<span style="color: #000000;">Interior</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;  <span style="color: #008000;">// interior: empty</span>
					
					<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> dp.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">&#40;</span>trFormat.<span style="color: #000000;">Root</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>
						dp.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">&#40;</span>trFormat, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;	
						
					<span style="color: #0000ff;">break</span>;
				<span style="color: #0000ff;">case</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">:</span>
					dp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// error bar</span>
					
					Tree trFormat;					
					trFormat.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Line</span>.<span style="color: #000000;">Color</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> SYSCOLOR_BLUE;  <span style="color: #008000;">// set color</span>
					trFormat.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Line</span>.<span style="color: #000000;">Width</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>.;     <span style="color: #008000;">// set line width</span>
					
					<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> dp.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">&#40;</span>trFormat.<span style="color: #000000;">Root</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>
						dp.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">&#40;</span>trFormat, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// apply theme tree</span>
								
					<span style="color: #0000ff;">break</span>;
			<span style="color: #000000;">&#125;</span>
		<span style="color: #000000;">&#125;</span>
		
		gl.<span style="color: #000000;">Rescale</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="XY_Error_Plot"></a><span class="mw-headline">XY Error Plot</span></h2>
<p class="version" >Minimum Origin Version Required: Origin 8 SR1</p>
<p>This example is capable of creating a scatter plot with X and Y error bars. The formats of symbols, X and Y error bars are modified too, including symbol shape, size, color, width of error bar, etc..
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">void</span> xy_error_plot<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// get worksheet with group.dat data</span>
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #000040;">!</span>wks <span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Please activate worksheet with group.dat data!&quot;</span><span style="color: #000000;">&#41;</span>;
		<span style="color: #0000ff;">return</span>;
	<span style="color: #000000;">&#125;</span>
	
	Curve crv<span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
		
	GraphPage gp;
	gp.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Scatter&quot;</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// create scatter</span>
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #000040;">!</span>gp <span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Failed to create scatter central plot!&quot;</span><span style="color: #000000;">&#41;</span>;
		<span style="color: #0000ff;">return</span>;
	<span style="color: #000000;">&#125;</span>
	
	GraphLayer gl <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
	
	<span style="color: #0000ff;">int</span> nScatterPlot <span style="color: #000080;">=</span> gl.<span style="color: #000000;">AddPlot</span><span style="color: #000000;">&#40;</span>crv, IDM_PLOT_SCATTER<span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// add plot to layer</span>
	
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> nScatterPlot <span style="color: #000080;">&gt;=</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">&#41;</span>  <span style="color: #008000;">// if add plot successfully</span>
	<span style="color: #000000;">&#123;</span>
		Column colXErrBar<span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// column C</span>
		<span style="color: #0000ff;">int</span> nXErrPlot <span style="color: #000080;">=</span> gl.<span style="color: #000000;">AddXErrBar</span><span style="color: #000000;">&#40;</span>crv, colXErrBar<span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// add column C as X error</span>
		
		Column colYErrBar<span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// column D</span>
		<span style="color: #0000ff;">int</span> nYErrPlot <span style="color: #000080;">=</span> gl.<span style="color: #000000;">AddErrBar</span><span style="color: #000000;">&#40;</span>crv, colYErrBar<span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// add column D as Y error</span>
		
		<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> nXErrPlot <span style="color: #000080;">&gt;=</span> <span style="color: #0000dd;">0</span> <span style="color: #000040;">&amp;&amp;</span> nYErrPlot <span style="color: #000080;">&gt;=</span> <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>
		<span style="color: #000000;">&#123;</span>
			<span style="color: #0000ff;">for</span><span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> nPlot<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>; nPlot<span style="color: #000080;">&lt;</span>gl.<span style="color: #000000;">DataPlots</span>.<span style="color: #000000;">Count</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; nPlot<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span>
			<span style="color: #000000;">&#123;</span>
				DataPlot dp;
				
				<span style="color: #0000ff;">switch</span> <span style="color: #000000;">&#40;</span>nPlot<span style="color: #000000;">&#41;</span>
				<span style="color: #000000;">&#123;</span>
					<span style="color: #0000ff;">case</span> <span style="color: #0000dd;">0</span><span style="color: #000000;">:</span>  <span style="color: #008000;">// set format for scatter plot</span>
						dp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
						dp.<span style="color: #000000;">SetColor</span><span style="color: #000000;">&#40;</span>SYSCOLOR_RED<span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// set color</span>
						
						Tree trFormat;
						trFormat.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Symbol</span>.<span style="color: #000000;">Shape</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>;  <span style="color: #008000;">// set shape: diamond</span>
						trFormat.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Symbol</span>.<span style="color: #000000;">Interior</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;  <span style="color: #008000;">// interior: empty</span>
						trFormat.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Symbol</span>.<span style="color: #000000;">Size</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">12</span>;  <span style="color: #008000;">// set size: 12</span>
						
						<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> dp.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">&#40;</span>trFormat.<span style="color: #000000;">Root</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>
							dp.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">&#40;</span>trFormat, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// apply theme format tree</span>
							
						<span style="color: #0000ff;">break</span>;
					<span style="color: #0000ff;">case</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">:</span>  <span style="color: #008000;">// set format for X error bar</span>
						dp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// X error bar</span>
						
						Tree trFormat;					
						trFormat.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Line</span>.<span style="color: #000000;">Color</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> SYSCOLOR_MAGENTA;  <span style="color: #008000;">// set color</span>
						trFormat.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Line</span>.<span style="color: #000000;">Width</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>.;     <span style="color: #008000;">// set line width</span>
						
						<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> dp.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">&#40;</span>trFormat.<span style="color: #000000;">Root</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>
							dp.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">&#40;</span>trFormat, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// apply theme tree</span>
						
						<span style="color: #0000ff;">break</span>;
					<span style="color: #0000ff;">case</span> <span style="color: #0000dd;">2</span><span style="color: #000000;">:</span>  <span style="color: #008000;">// set format for Y error bar</span>
						dp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// Y error bar</span>
						
						Tree trFormat;					
						trFormat.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Line</span>.<span style="color: #000000;">Color</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> SYSCOLOR_BLUE;  <span style="color: #008000;">// set color</span>
						trFormat.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Line</span>.<span style="color: #000000;">Width</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>.;     <span style="color: #008000;">// set line width</span>
						
						<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> dp.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">&#40;</span>trFormat.<span style="color: #000000;">Root</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>
							dp.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">&#40;</span>trFormat, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// apply theme tree</span>
						
						<span style="color: #0000ff;">break</span>;
				<span style="color: #000000;">&#125;</span>
			<span style="color: #000000;">&#125;</span>
		<span style="color: #000000;">&#125;</span>
			
		gl.<span style="color: #000000;">Rescale</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Bubble_Plot"></a><span class="mw-headline">Bubble Plot</span></h2>
<p class="version" >Minimum Origin Version Required: Origin 8.1 SR1</p>
<p>This example is used to create a bubble plot. Mean while, the sizes and colors of the bubbles are set by existing columns.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">void</span> bubble_plot<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #000040;">!</span>wks <span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
       out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Pls activate worksheet with group.dat data&quot;</span><span style="color: #000000;">&#41;</span>;
       <span style="color: #0000ff;">return</span>;
    <span style="color: #000000;">&#125;</span>
    
    <span style="color: #008000;">// plot bubble</span>
    DataRange dr;
    dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">0</span>, <span style="color: #ff00ff;">&quot;X&quot;</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// X column</span>
    dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">1</span>, <span style="color: #ff00ff;">&quot;Y&quot;</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// Y column</span>
 
    GraphPage gp;
    gp.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;bubble&quot;</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// create bubble plot </span>
    GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
 
    <span style="color: #0000ff;">int</span> nPlot <span style="color: #000080;">=</span> gl.<span style="color: #000000;">AddPlot</span><span style="color: #000000;">&#40;</span>dr, IDM_PLOT_SCATTER<span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> nPlot <span style="color: #000080;">&gt;=</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">&#41;</span>  <span style="color: #008000;">// add plot successfully</span>
    <span style="color: #000000;">&#123;</span>
       DataPlot dp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
       Column colSize <span style="color: #000080;">=</span> wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>;
       dp.<span style="color: #000000;">SetModifier</span><span style="color: #000000;">&#40;</span>COLDESIG_SIZE, colSize<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// column C as Size</span>
 
       Column colColor <span style="color: #000080;">=</span> wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>;
       dp.<span style="color: #000000;">SetModifier</span><span style="color: #000000;">&#40;</span>COLDESIG_COLOR, colColor<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// column D as Color Map</span>
 
       gl.<span style="color: #000000;">Rescale</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; 
    <span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>






