<h1 class="firstHeading">2.2.4.46.59 Worksheet::PutRecordset</h1><p><span class="OIndex" style="display:none">PutRecordset</span>
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Syntax"><span class="tocnumber">2</span> <span class="toctext">Syntax</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Parameters"><span class="tocnumber">3</span> <span class="toctext">Parameters</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Return"><span class="tocnumber">4</span> <span class="toctext">Return</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Examples"><span class="tocnumber">5</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Remark"><span class="tocnumber">6</span> <span class="toctext">Remark</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#See_Also"><span class="tocnumber">7</span> <span class="toctext">See Also</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Header_to_Include"><span class="tocnumber">8</span> <span class="toctext">Header to Include</span></a></li>
</ul>
</div>

<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>Put data from a recordset into an Origin worksheet
</p>
<h2><a name="Syntax"></a><span class="mw-headline">Syntax</span></h2>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">BOOL</span> PutRecordset<span style="color: #000000;">&#40;</span> Object <span style="color: #000040;">&amp;</span> objrs, <span style="color: #0000ff;">int</span> nRowBegin <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>, <span style="color: #0000ff;">int</span> nNumRows <span style="color: #000080;">=</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, <span style="color: #0000ff;">int</span> nColBegin <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>, <span style="color: #0000ff;">int</span> nOptions <span style="color: #000080;">=</span> LAYWKGETRECORDSET_BY_COLUMN_INDEX, <span style="color: #0000ff;">int</span> <span style="color: #000040;">*</span> pnErrorCode <span style="color: #000080;">=</span> <span style="color: #0000ff;">NULL</span>, POSTREADRS postReadRS <span style="color: #000080;">=</span> <span style="color: #0000ff;">NULL</span> <span style="color: #000000;">&#41;</span></pre>
<p><br />
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">BOOL</span> PutRecordset<span style="color: #000000;">&#40;</span> _VARIANT <span style="color: #000040;">&amp;</span> varobjrs, <span style="color: #0000ff;">int</span> nRowBegin <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>, <span style="color: #0000ff;">int</span> nNumRows <span style="color: #000080;">=</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, <span style="color: #0000ff;">int</span> nColBegin <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>, <span style="color: #0000ff;">int</span> nOptions <span style="color: #000080;">=</span> LAYWKGETRECORDSET_BY_COLUMN_INDEX, <span style="color: #0000ff;">int</span> <span style="color: #000040;">*</span> pnErrorCode <span style="color: #000080;">=</span> <span style="color: #0000ff;">NULL</span>, POSTREADRS postReadRS <span style="color: #000080;">=</span> <span style="color: #0000ff;">NULL</span> <span style="color: #000000;">&#41;</span></pre>
<h2><a name="Parameters"></a><span class="mw-headline">Parameters</span></h2>
<dl><dt> objrs</dt>
<dd>[input] The recordset.</dd>
<dt> nRowBegin</dt>
<dd>[input] The starting row in the worksheet. default is 0.</dd>
<dt> nNumRows</dt>
<dd>[input] Total number of records to retrieve,or &lt; 0 to retrieve all available.</dd>
<dd>default is -1.</dd>
<dt> nColBegin</dt>
<dd>[input] Applies only to the options LAYWKGETRECORDSET_BY_COLUMN_INDEX with or without LAYWKGETRECORDSET_BY_COLUMN_INDEX and LAYWKGETRECORDSET_SET_COLUMN_NAME bits</dd>
<dd>the column in worksheet from which to begin. default is 0.</dd>
<dt> nOptions</dt>
<dd>[input] Options from LAYWKGETRECORDSET_BY_COLUMN_INDEX , etc (OC_const.h).						// beginning with the starting column nColBegin retrieve all fields (will add columns as necessary)</dd>
<dd>default is LAYWKGETRECORDSET_BY_COLUMN_INDEX</dd>
<dt> pnErrorCode</dt>
<dd>[output,optional] if supplied, *pnErrorCode receives additional error info as values from PUTRSET_* enumeration</dd></dl>
<p><br />
</p>
<dl><dt> varobjrs</dt>
<dd>[input] The recordset.</dd>
<dt> nRowBegin</dt>
<dd>[input] The starting row in the worksheet. default is 0.</dd>
<dt> nNumRows</dt>
<dd>[input] Total number of records to retrieve,or -1 to retrieve all available. default is -1.</dd>
<dt> nColBegin</dt>
<dd>[input] Applies only to the options LAYWKGETRECORDSET_BY_COLUMN_INDEX and LAYWKGETRECORDSET_BY_COLUMN_INDEX_WITH_COLUMN_RENAMING</dd>
<dd>the column in worksheet from which to begin. default is 0.</dd>
<dt> nOptions</dt>
<dd>[input] Options from LAYWKGETRECORDSET_BY_COLUMN_INDEX, etc (OC_const.h).</dd>
<dd>default is LAYWKGETRECORDSET_BY_COLUMN_INDEX.</dd>
<dt> pnErrorCode</dt>
<dd>[output,optional] if supplied, *pnErrorCode receives additional error info as values from PUTRSET_* enumeration</dd>
<dt> postReadRS</dt>
<dd>[input,optional] (8.1SR2) if supplied, postReadRS-&gt;nCodePage holds the code page to be used when converting string values from database. If postReadRS-&gt;nCodePage &gt; 0, the code page value postReadRS-&gt;nCodePage is used. If postReadRS-&gt;nCodePage &lt; 0, the current code page used in Origin for various string manipulations (which might be different from OS code page) is used. If postReadRS-&gt;nCodePage == 0 (same as postReadRS == NULL), then the current OS code page is used.</dd></dl>
<h2><a name="Return"></a><span class="mw-headline">Return</span></h2>
<p>TRUE for success; otherwise FALSE.
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p><b>EX1</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// SQL Server access to data</span>
<span style="color: #008000;">// Must have server and edit connection string to suit your system</span>
<span style="color: #0000ff;">int</span> Worksheet_PutRecordset_Ex1<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    Object ocrs;
    ocrs <span style="color: #000080;">=</span> CreateObject<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;ADODB.Recordset&quot;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">try</span>
    <span style="color: #000000;">&#123;</span>
        ocrs.<span style="color: #000000;">open</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;select * from customers&quot;</span>, <span style="color: #ff00ff;">&quot;Provider=SQLOLEDB; Data Source=myServer; Initial Catalog=northwind; User ID=myID; Password=myPassword;&quot;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #000000;">&#125;</span>
    <span style="color: #0000ff;">catch</span><span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> nErr<span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Failed to open&quot;</span><span style="color: #000000;">&#41;</span>;
        <span style="color: #0000ff;">return</span> <span style="color: #0000dd;">0</span>;
    <span style="color: #000000;">&#125;</span>
    Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #008000;">// Put the recordset into worksheet:</span>
    <span style="color: #0000ff;">BOOL</span> bRet;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>wks<span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        bRet <span style="color: #000080;">=</span> wks.<span style="color: #000000;">PutRecordset</span><span style="color: #000000;">&#40;</span>ocrs, <span style="color: #0000dd;">0</span>, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">0</span>, LAYWKGETRECORDSET_BY_COLUMN_INDEX <span style="color: #000040;">|</span> LAYWKGETRECORDSET_SET_COLUMN_NAME<span style="color: #000000;">&#41;</span>;
    <span style="color: #000000;">&#125;</span>
    <span style="color: #0000ff;">return</span> <span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span><span style="color: #000000;">&#41;</span>bRet;
<span style="color: #000000;">&#125;</span></pre>
<p><b>EX2</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Retrieve data from Office Sample database and put into a worksheet</span>
<span style="color: #008000;">// Must have Jet Engine and database installed - edit path as needed</span>
<span style="color: #0000ff;">void</span> Worksheet_PutRecordset_Ex2<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    Object ocrs;
    ocrs <span style="color: #000080;">=</span> CreateObject<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;ADODB.Recordset&quot;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #000040;">!</span>ocrs <span style="color: #000000;">&#41;</span>
        <span style="color: #0000ff;">return</span>;
    string strConn;
    strConn <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:<span style="color: #666666; font-weight: bold;">\P</span>rogram Files<span style="color: #666666; font-weight: bold;">\M</span>icrosoft Office<span style="color: #666666; font-weight: bold;">\O</span>ffice<span style="color: #666666; font-weight: bold;">\S</span>amples<span style="color: #666666; font-weight: bold;">\N</span>orthwind.mdb&quot;</span>;
    string strQuery <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;select * from customers&quot;</span>;
    ocrs.<span style="color: #000000;">CursorLocation</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>; <span style="color: #008000;">//set as adUseClient, which will make recordset reading faster.</span>
    <span style="color: #0000ff;">try</span>
    <span style="color: #000000;">&#123;</span>
        ocrs.<span style="color: #000000;">open</span><span style="color: #000000;">&#40;</span> strQuery, strConn, <span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #000000;">&#125;</span>
    <span style="color: #0000ff;">catch</span><span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> nErr<span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Failed to open&quot;</span><span style="color: #000000;">&#41;</span>;
        <span style="color: #0000ff;">return</span>;
    <span style="color: #000000;">&#125;</span>
    Worksheet wks<span style="color: #000000;">&#40;</span>Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> wks.<span style="color: #000000;">IsValid</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
        <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> wks.<span style="color: #000000;">PutRecordset</span><span style="color: #000000;">&#40;</span>ocrs<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
            <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Success to put dataset into worksheet!&quot;</span><span style="color: #000000;">&#41;</span>;
        <span style="color: #0000ff;">else</span>
            <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Fail to put dataset into worksheet!&quot;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">else</span>
        <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Workbook not active<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<p><br />
<b>EX3</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">void</span> Worksheet_PutRecordset_Ex3<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    Object ocrs;
    ocrs <span style="color: #000080;">=</span> CreateObject<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;ADODB.Recordset&quot;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">try</span>
    <span style="color: #000000;">&#123;</span>
        ocrs.<span style="color: #000000;">open</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;select * from customers&quot;</span>, <span style="color: #ff00ff;">&quot;Provider=SQLOLEDB; Data Source=myServer; Initial Catalog=northwind; User ID=myID; Password=myPassword;&quot;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #000000;">&#125;</span>
    <span style="color: #0000ff;">catch</span><span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> nErr<span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Failed to open&quot;</span><span style="color: #000000;">&#41;</span>;
        <span style="color: #0000ff;">return</span>;
    <span style="color: #000000;">&#125;</span>
    Worksheet wks<span style="color: #000000;">&#40;</span>Project.<span style="color: #000000;">WorksheetPages</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>.<span style="color: #000000;">GetName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #008000;">// Put the recordset into worksheet:</span>
    <span style="color: #0000ff;">BOOL</span> bRet <span style="color: #000080;">=</span> wks.<span style="color: #000000;">PutRecordset</span><span style="color: #000000;">&#40;</span>ocrs, <span style="color: #0000dd;">0</span>, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">0</span>, LAYWKGETRECORDSET_BY_COLUMN_INDEX <span style="color: #000040;">|</span> LAYWKGETRECORDSET_SET_COLUMN_LABEL<span style="color: #000000;">&#41;</span>;
    out_int<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;bRet = &quot;</span>, bRet<span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Remark"></a><span class="mw-headline">Remark</span></h2>
<p>It is recommended to use the <a href="../../OriginC/OriginC/Worksheet-ReadRecordset.html" title="OriginC:Worksheet-ReadRecordset">ReadRecordset</a> method instead as it returns the error code, while this older method returns BOOL, even though the error code can also be obtained in another argument.
</p><p>Notes: The performance depends on how the recordset is opened, as controlled by CursorLocation (adUseClient, or adUseServer, see in query_utils.h). For reading into worksheet, usually set CursorLocation as adUseCient is enough, which will cause CursorType be set as adOpenStatic, which means that any other application's update into source database will not affect this recordset once it is open. It is like the recordset is open as read-only. See <a class="external text" href="http://msdn.microsoft.com/en-us/library/office/aa140098(v=office.10).aspx" target="_blank">CursorType</a>, <a class="external text" href="http://msdn.microsoft.com/en-us/library/ee252442(v=bts.10).aspx" target="_blank">CursorLocation</a> for more details.
</p>
<h2><a name="See_Also"></a><span class="mw-headline">See Also</span></h2>
<p><a href="../../OriginC/OriginC/Worksheet-ReadRecordset.html" title="OriginC:Worksheet-ReadRecordset">Worksheet::ReadRecordset</a> |
<a href="../../OriginC/OriginC/Worksheet-WriteRecordset.html" title="OriginC:Worksheet-WriteRecordset">Worksheet::WriteRecordset</a>
</p>
<h2><a name="Header_to_Include"></a><span class="mw-headline">Header to Include</span></h2>
<p>origin.h
</p>





