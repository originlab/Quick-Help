<h1 class="firstHeading">2.1.18.9 ocmath_gridding_weighted_average</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Syntax"><span class="tocnumber">2</span> <span class="toctext">Syntax</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Parameters"><span class="tocnumber">3</span> <span class="toctext">Parameters</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Return"><span class="tocnumber">4</span> <span class="toctext">Return</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Examples"><span class="tocnumber">5</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Remark"><span class="tocnumber">6</span> <span class="toctext">Remark</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#See_Also"><span class="tocnumber">7</span> <span class="toctext">See Also</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Header_to_Include"><span class="tocnumber">8</span> <span class="toctext">Header to Include</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Reference"><span class="tocnumber">9</span> <span class="toctext">Reference</span></a></li>
</ul>
</div>

<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>This gridding function search neighborhood data points within specified radius. And then estimate the grid point value by weighted averaged method.
</p>
<h2><a name="Syntax"></a><span class="mw-headline">Syntax</span></h2>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">int</span> ocmath_gridding_weighted_average<span style="color: #000000;">&#40;</span> <span style="color: #0000ff;">int</span> nSize, <span style="color: #0000ff;">const</span> <span style="color: #0000ff;">double</span> <span style="color: #000040;">*</span> pX, <span style="color: #0000ff;">const</span> <span style="color: #0000ff;">double</span> <span style="color: #000040;">*</span> pY, <span style="color: #0000ff;">const</span> <span style="color: #0000ff;">double</span> <span style="color: #000040;">*</span> pZ, <span style="color: #0000ff;">int</span> nOutSize, <span style="color: #0000ff;">const</span> <span style="color: #0000ff;">double</span> <span style="color: #000040;">*</span> pXout, <span style="color: #0000ff;">const</span> <span style="color: #0000ff;">double</span> <span style="color: #000040;">*</span> pYout, <span style="color: #0000ff;">double</span> <span style="color: #000040;">*</span> pZout, <span style="color: #0000ff;">double</span> dRadius, <span style="color: #0000ff;">int</span> nMethod <span style="color: #000080;">=</span> WEIGHTED_AVERAGE_SQUARE <span style="color: #000000;">&#41;</span></pre>
<h2><a name="Parameters"></a><span class="mw-headline">Parameters</span></h2>
<dl><dt> nSize</dt>
<dd>[input] the size of the input data</dd>
<dt> pX</dt>
<dd>[input] double pointer to the array which specify the x-coordinate of the raw data.</dd>
<dt> pY</dt>
<dd>[input] double pointer to the array which specify the y-coordinate of the raw data.</dd>
<dt> pZ</dt>
<dd>[input] double pointer to the array which specify the responded z-value of the raw data.</dd>
<dt> nOutSize</dt>
<dd>[input] the size of the output data.</dd>
<dt> pXout</dt>
<dd>[input] double pointer to the array which specify the x-coordinate of the grid.</dd>
<dt> pYout</dt>
<dd>[input] double pointer to the array which specify the y-coordinate of the grid.</dd>
<dt> pZout</dt>
<dd>[output] double pointer to the array the get the value of the grid.</dd>
<dt> dRadius</dt>
<dd>[input] searching radius, points within the area will be used for counting the gridding value.</dd>
<dt> nMethod</dt>
<dd>[input] specify the method used for counting the weight.</dd></dl>
<h2><a name="Return"></a><span class="mw-headline">Return</span></h2>
<p>Returns OE_NOERROR if succeed, error codes otherwise.
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p><b>EX1</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">//Suppose you have an active worksheet with three columns which are designated as XYZ.</span>
<span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>wks2mat.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span>
<span style="color: #0000ff;">#define</span> NUM_ROWS <span style="color: #0000dd;">11</span>
<span style="color: #0000ff;">#define</span> NUM_COLS <span style="color: #0000dd;">11</span>
<span style="color: #0000ff;">int</span> ocmath_gridding_weighted_average_ex1<span style="color: #000000;">&#40;</span><span style="color: #0000ff;">double</span> dRadius, <span style="color: #0000ff;">int</span> nMethod<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    Worksheet wks<span style="color: #000080;">=</span>Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;

    Dataset dx<span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>, dy<span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>, dz<span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>;
    vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">double</span><span style="color: #000080;">&gt;</span> vx <span style="color: #000080;">=</span> dx, vy <span style="color: #000080;">=</span> dy, vz <span style="color: #000080;">=</span> dz;
    <span style="color: #0000ff;">double</span> dxMin, dxMax;
    <span style="color: #0000ff;">double</span> dyMin, dyMax;
    vx.<span style="color: #000000;">GetMinMax</span><span style="color: #000000;">&#40;</span>dxMin, dxMax<span style="color: #000000;">&#41;</span>;
    vy.<span style="color: #000000;">GetMinMax</span><span style="color: #000000;">&#40;</span>dyMin, dyMax<span style="color: #000000;">&#41;</span>;
    
    MatrixLayer ml;
    ml.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    MatrixObject mo <span style="color: #000080;">=</span> ml.<span style="color: #000000;">MatrixObjects</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
    mo.<span style="color: #000000;">SetXY</span><span style="color: #000000;">&#40;</span>dxMin, dyMin, dxMax, dyMax<span style="color: #000000;">&#41;</span>;
    mo.<span style="color: #000000;">SetNumCols</span><span style="color: #000000;">&#40;</span>NUM_COLS<span style="color: #000000;">&#41;</span>;
    mo.<span style="color: #000000;">SetNumRows</span><span style="color: #000000;">&#40;</span>NUM_ROWS<span style="color: #000000;">&#41;</span>;
    matrix<span style="color: #000040;">&amp;</span> mat <span style="color: #000080;">=</span> mo.<span style="color: #000000;">GetDataObject</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;

    vector vXGrid<span style="color: #000000;">&#40;</span>NUM_ROWS <span style="color: #000040;">*</span> NUM_COLS<span style="color: #000000;">&#41;</span>, vYGrid<span style="color: #000000;">&#40;</span>NUM_ROWS <span style="color: #000040;">*</span> NUM_COLS<span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">int</span> iRet <span style="color: #000080;">=</span> ocmath_mat_to_regular_xyz<span style="color: #000000;">&#40;</span><span style="color: #0000ff;">NULL</span>, NUM_ROWS, NUM_COLS, dxMin, dxMax, dyMin, dyMax, vXGrid, vYGrid, <span style="color: #0000ff;">NULL</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">if</span> <span style="color: #000000;">&#40;</span>iRet <span style="color: #000080;">&lt;=</span> <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> 
        <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Thin plate spline: failed to create XY gridding!<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span><span style="color: #000000;">&#41;</span>;
        <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span>;
    <span style="color: #000000;">&#125;</span>
    
    ocmath_gridding_weighted_average<span style="color: #000000;">&#40;</span>
                    vx.<span style="color: #000000;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>,vx, vy, vz, 
                    NUM_ROWS <span style="color: #000040;">*</span> NUM_COLS, vXGrid, vYGrid, mat, 
                    dRadius, nMethod<span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">return</span> <span style="color: #0000dd;">0</span>;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Remark"></a><span class="mw-headline">Remark</span></h2>
<h2><a name="See_Also"></a><span class="mw-headline">See Also</span></h2>
<h2><a name="Header_to_Include"></a><span class="mw-headline">Header to Include</span></h2>
<p>wks2mat.h
</p>
<h2><a name="Reference"></a><span class="mw-headline">Reference</span></h2>






