<h1 class="firstHeading">2.3.1.27 GETN_CUSTOM_BUTTON</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Name"><span class="tocnumber">1</span> <span class="toctext">Name</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Declaration"><span class="tocnumber">2</span> <span class="toctext">Declaration</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Remark"><span class="tocnumber">3</span> <span class="toctext">Remark</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Parameters"><span class="tocnumber">4</span> <span class="toctext">Parameters</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Return"><span class="tocnumber">5</span> <span class="toctext">Return</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Examples"><span class="tocnumber">6</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#See_Also"><span class="tocnumber">7</span> <span class="toctext">See Also</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Header_to_Include"><span class="tocnumber">8</span> <span class="toctext">Header to Include</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Reference"><span class="tocnumber">9</span> <span class="toctext">Reference</span></a></li>
</ul>
</div>

<h2><a name="Name"></a><span class="mw-headline">Name</span></h2>
<p>GETN_CUSTOM_BUTTON
</p>
<h2><a name="Declaration"></a><span class="mw-headline">Declaration</span></h2>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#define</span>	GETN_CUSTOM_BUTTON<span style="color: #000000;">&#40;</span>_STR<span style="color: #000000;">&#41;</span>		_tmpNode.<span style="color: #000000;">SetAttribute</span><span style="color: #000000;">&#40;</span>STR_CUSTOM_BUTTONS_ATTRIB, _STR<span style="color: #000000;">&#41;</span></pre>
<h2><a name="Remark"></a><span class="mw-headline">Remark</span></h2>
<p>This macro is used to add custom button on GetN Dialog.
</p>
<h2><a name="Parameters"></a><span class="mw-headline">Parameters</span></h2>
<dl><dt> _STR</dt>
<dd>[input] button string.</dd></dl>
<pre class="oc" style="font-family:monospace;">make string like <span style="color: #ff00ff;">&quot;OK=Import&quot;</span> to <span style="color: #000000;">rename</span> label of OK button to <span style="color: #ff00ff;">&quot;Import&quot;</span>
make string like <span style="color: #ff00ff;">&quot;OK=&quot;</span> to hide OK button
make string like <span style="color: #ff00ff;">&quot;OK=|Cancel=Close|Apply=Plot|Undo&quot;</span> to hide OK button, <span style="color: #000000;">rename</span> <span style="color: #ff00ff;">&quot;Cancel&quot;</span> to <span style="color: #ff00ff;">&quot;Close&quot;</span>, show <span style="color: #ff00ff;">&quot;Apply&quot;</span> and <span style="color: #000000;">rename</span> it to <span style="color: #ff00ff;">&quot;Plot&quot;</span>, show <span style="color: #ff00ff;">&quot;Undo&quot;</span> button
make string like <span style="color: #ff00ff;">&quot;Import|Update&quot;</span> to add two customize buttom <span style="color: #ff00ff;">&quot;Import&quot;</span> <span style="color: #000040;">&amp;</span> <span style="color: #ff00ff;">&quot;Update&quot;</span>, and OK <span style="color: #000040;">&amp;</span> Cancel button will also shown
make string like <span style="color: #ff00ff;">&quot;OK=|Cancel=|Import|Update&quot;</span> to add two customize buttom and also hidden OK <span style="color: #000040;">&amp;</span> Cancel button</pre>
<h2><a name="Return"></a><span class="mw-headline">Return</span></h2>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p><b>EX1</b>
</p>
<dl><dt>This example shows how to hide the OK|Cancel buttons</dt></dl>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>GetNbox.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span>
<span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>..\OriginLab\DialogEx.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span>
<span style="color: #0000ff;">void</span> GETN_CUSTOM_BUTTON_ex1<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	GETN_TREE<span style="color: #000000;">&#40;</span>tr<span style="color: #000000;">&#41;</span>
	GETN_CUSTOM_BUTTON<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;OK=|Cancel=&quot;</span><span style="color: #000000;">&#41;</span>
	GETN_STRLIST<span style="color: #000000;">&#40;</span>WksName, <span style="color: #ff00ff;">&quot;Worksheet Name&quot;</span>, <span style="color: #ff00ff;">&quot;one&quot;</span>, <span style="color: #ff00ff;">&quot;one|two|three|four|five&quot;</span><span style="color: #000000;">&#41;</span>	GETN_OPTION_EVENT_EX<span style="color: #000000;">&#40;</span>_update_name<span style="color: #000000;">&#41;</span>
	GetNBox<span style="color: #000000;">&#40;</span>tr, _L<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Name&quot;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span>

<span style="color: #0000ff;">static</span> <span style="color: #0000ff;">bool</span> _update_name<span style="color: #000000;">&#40;</span>TreeNode<span style="color: #000040;">&amp;</span> myTree, <span style="color: #0000ff;">int</span> nRow, <span style="color: #0000ff;">int</span> nCol, TreeNode<span style="color: #000040;">&amp;</span> trNode, DWORD dwCntrl, <span style="color: #0000ff;">int</span> nType, WndContainer<span style="color: #000040;">&amp;</span> theDlg<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	<span style="color: #0000ff;">if</span> <span style="color: #000000;">&#40;</span> GETNEVENT_ON_INIT <span style="color: #000040;">!</span><span style="color: #000080;">=</span> dwCntrl <span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		out_str<span style="color: #000000;">&#40;</span>myTree.<span style="color: #000000;">WksName</span>.<span style="color: #000000;">strVal</span><span style="color: #000000;">&#41;</span>;
		theDlg.<span style="color: #000000;">SendMessage</span><span style="color: #000000;">&#40;</span>WM_CLOSE<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// close the dialog</span>
	<span style="color: #000000;">&#125;</span>	
	<span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span>;
<span style="color: #000000;">&#125;</span></pre>
<p><b>EX2</b>
</p>
<dl><dt>This example shows how to customize the Apply button with UTF-8 encoding Unicode character</dt>
<dt>and set tooltips to the buttons</dt></dl>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>GetNbox.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span>
<span style="color: #0000ff;">void</span> GETN_CUSTOM_BUTTON_ex2<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>	
	GETN_TREE<span style="color: #000000;">&#40;</span>tr<span style="color: #000000;">&#41;</span>
	GETN_STR<span style="color: #000000;">&#40;</span>WksName, <span style="color: #ff00ff;">&quot;Worksheet Name&quot;</span>, <span style="color: #ff00ff;">&quot;Sheet2&quot;</span><span style="color: #000000;">&#41;</span> 
	
	<span style="color: #008000;">//hide OK button, change Apply button to lighting icon, change Cancel to Close</span>
	GETN_CUSTOM_BUTTON<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;OK=|Apply=<span style="color: #666666; font-weight: bold;">\x</span>e2<span style="color: #666666; font-weight: bold;">\x</span>9a<span style="color: #666666; font-weight: bold;">\x</span>a1|Cancel=Close&quot;</span><span style="color: #000000;">&#41;</span> <span style="color: #008000;">//UTF-8: \xe2\x9a\xa1</span>
	
	<span style="color: #008000;">//set button tool tips, this should follow custom button string</span>
	tr.<span style="color: #000000;">SetAttribute</span><span style="color: #000000;">&#40;</span>STR_CUSTOM_BUTTONS_TOOLTIP_ATTRIB, _L<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;|Add...&quot;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;
	
	GetNBox<span style="color: #000000;">&#40;</span> tr, <span style="color: #0000ff;">NULL</span>, <span style="color: #ff00ff;">&quot;Add Sheet&quot;</span>, <span style="color: #0000ff;">NULL</span>, <span style="color: #0000ff;">NULL</span>, <span style="color: #0000ff;">true</span>, AddSheetDlg_Apply<span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span>

<span style="color: #0000ff;">static</span> <span style="color: #0000ff;">bool</span>	AddSheetDlg_Apply<span style="color: #000000;">&#40;</span>TreeNode<span style="color: #000040;">&amp;</span> tr<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	WorksheetPage wp <span style="color: #000080;">=</span> Project.<span style="color: #000000;">Pages</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span><span style="color: #000040;">!</span>wp<span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		Worksheet wks;
		wks.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;origin&quot;</span><span style="color: #000000;">&#41;</span>;
		wks.<span style="color: #000000;">SetName</span><span style="color: #000000;">&#40;</span>tr.<span style="color: #000000;">WksName</span>.<span style="color: #000000;">strVal</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">&#125;</span>
	<span style="color: #0000ff;">else</span>
	<span style="color: #000000;">&#123;</span>	
		wp.<span style="color: #000000;">AddLayer</span><span style="color: #000000;">&#40;</span>tr.<span style="color: #000000;">WksName</span>.<span style="color: #000000;">strVal</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">&#125;</span>
	
	<span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span>;
<span style="color: #000000;">&#125;</span></pre>
<p><b>EX3</b>
</p>
<dl><dt>this example show how to work on more than one custom buttons</dt></dl>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>GetNbox.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span>
<span style="color: #0000ff;">void</span> GETN_CUSTOM_BUTTON_ex3<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>	
	GETN_TREE<span style="color: #000000;">&#40;</span>tr<span style="color: #000000;">&#41;</span>
	GETN_STR<span style="color: #000000;">&#40;</span>WksName, <span style="color: #ff00ff;">&quot;Worksheet Name&quot;</span>, <span style="color: #ff00ff;">&quot;Sheet2&quot;</span><span style="color: #000000;">&#41;</span> 
	
	<span style="color: #008000;">//add 2 custom buttons</span>
	GETN_CUSTOM_BUTTON<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Add|Delete&quot;</span><span style="color: #000000;">&#41;</span>
	
	GetNBox<span style="color: #000000;">&#40;</span>tr, _GetN_event_func<span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span>

<span style="color: #0000ff;">static</span> <span style="color: #0000ff;">int</span> _GetN_event_func<span style="color: #000000;">&#40;</span>TreeNode<span style="color: #000040;">&amp;</span> trGetN, <span style="color: #0000ff;">int</span> nRow, <span style="color: #0000ff;">int</span> nEvent, DWORD<span style="color: #000040;">&amp;</span> dwEnables, LPCSTR lpcszNodeName, WndContainer<span style="color: #000040;">&amp;</span> getNContainer, string<span style="color: #000040;">&amp;</span> strAux, string<span style="color: #000040;">&amp;</span> strErrMsg<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>GETNE_ON_CUSTOM_BUTTON1 <span style="color: #000080;">==</span> nEvent<span style="color: #000000;">&#41;</span> 
	<span style="color: #000000;">&#123;</span>
		out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Add&quot;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">&#125;</span>
	
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>GETNE_ON_CUSTOM_BUTTON2 <span style="color: #000080;">==</span> nEvent<span style="color: #000000;">&#41;</span> 
	<span style="color: #000000;">&#123;</span>
		out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Delete&quot;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">&#125;</span>
	
	<span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span>;
<span style="color: #000000;">&#125;</span></pre>
<p><b>EX4</b>
</p>
<dl><dt>this example show how to use <b>PEVENT_GETN_RET_FORCE_UPDATE</b> and <b>PEVENT_GETN_RET_TO_CLOSE</b> as the return value in custom buttons' event function</dt></dl>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>GetNbox.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span>
<span style="color: #0000ff;">void</span> GETN_CUSTOM_BUTTON_ex4<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>	
	GETN_TREE<span style="color: #000000;">&#40;</span>tr<span style="color: #000000;">&#41;</span>
	GETN_STR<span style="color: #000000;">&#40;</span>WksName, <span style="color: #ff00ff;">&quot;Worksheet Name&quot;</span>, <span style="color: #ff00ff;">&quot;Sheet2&quot;</span><span style="color: #000000;">&#41;</span> 
	GETN_NUM<span style="color: #000000;">&#40;</span>CountNum, <span style="color: #ff00ff;">&quot;&quot;</span>, <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span> GETN_SHOW<span style="color: #000000;">&#40;</span><span style="color: #0000ff;">FALSE</span><span style="color: #000000;">&#41;</span>
	
	<span style="color: #008000;">//add 2 custom buttons</span>
	GETN_CUSTOM_BUTTON<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Update|Advanced&quot;</span><span style="color: #000000;">&#41;</span>
	
	GetNBox<span style="color: #000000;">&#40;</span>tr, _GetN_event_func<span style="color: #000000;">&#41;</span>;
	out_tree<span style="color: #000000;">&#40;</span>tr<span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span>

<span style="color: #0000ff;">static</span> <span style="color: #0000ff;">int</span> _GetN_event_func<span style="color: #000000;">&#40;</span>TreeNode<span style="color: #000040;">&amp;</span> trGetN, <span style="color: #0000ff;">int</span> nRow, <span style="color: #0000ff;">int</span> nEvent, DWORD<span style="color: #000040;">&amp;</span> dwEnables, LPCSTR lpcszNodeName, WndContainer<span style="color: #000040;">&amp;</span> getNContainer, string<span style="color: #000040;">&amp;</span> strAux, string<span style="color: #000040;">&amp;</span> strErrMsg<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	<span style="color: #008000;">//button1 &quot;Update&quot; event, to update &quot;Worksheet Name&quot; value</span>
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>GETNE_ON_CUSTOM_BUTTON1 <span style="color: #000080;">==</span> nEvent<span style="color: #000000;">&#41;</span> 
	<span style="color: #000000;">&#123;</span>
		trGetN.<span style="color: #000000;">CountNum</span>.<span style="color: #000000;">nVal</span> <span style="color: #000040;">+</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
		trGetN.<span style="color: #000000;">WksName</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Update&quot;</span> <span style="color: #000040;">+</span> trGetN.<span style="color: #000000;">CountNum</span>.<span style="color: #000000;">nVal</span>;
		<span style="color: #0000ff;">return</span> PEVENT_GETN_RET_FORCE_UPDATE; <span style="color: #008000;">// force getn dlg update</span>
	<span style="color: #000000;">&#125;</span>
	
	<span style="color: #008000;">//button2 &quot;Advanced&quot; event, to close getn dlg and show message box</span>
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>GETNE_ON_CUSTOM_BUTTON2 <span style="color: #000080;">==</span> nEvent<span style="color: #000000;">&#41;</span> 
	<span style="color: #000000;">&#123;</span>
		string strLT <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;;type -b Advanced&quot;</span>;
		LT_execute<span style="color: #000000;">&#40;</span>strLT<span style="color: #000000;">&#41;</span>;
		<span style="color: #0000ff;">return</span> PEVENT_GETN_RET_TO_CLOSE; <span style="color: #008000;">// close getn dlg</span>
	<span style="color: #000000;">&#125;</span>
	
	<span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span>;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="See_Also"></a><span class="mw-headline">See Also</span></h2>
<p><a href="../../OriginC/OriginC/GETN_OPTION_EVENT_EX.html" title="OriginC:GETN OPTION EVENT EX">GETN_OPTION_EVENT_EX</a>
</p>
<h2><a name="Header_to_Include"></a><span class="mw-headline">Header to Include</span></h2>
<p>GetNBox.h
</p>
<h2><a name="Reference"></a><span class="mw-headline">Reference</span></h2>






