<h1 class="firstHeading">1.18.1.1 Built-in Dialog Boxes</h1><p><br />
<span class="OIndex" style="display:none">Dialog Boxes</span>
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Input_BoxNumeric_BoxString_BoxInput_NumericInput_String"><span class="tocnumber">1</span> <span class="toctext">Input Box<span class="OIndex" style="display:none">Numeric Box</span><span class="OIndex" style="display:none">String Box</span><span class="OIndex" style="display:none">Input Numeric</span><span class="OIndex" style="display:none">Input String</span></span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Message_Box"><span class="tocnumber">2</span> <span class="toctext"><span class="OIndex">Message Box</span></span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Progress_Box"><span class="tocnumber">3</span> <span class="toctext"><span class="OIndex">Progress Box</span></span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#File_Dialogs"><span class="tocnumber">4</span> <span class="toctext">File Dialogs</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="#File_Open_Dialog"><span class="tocnumber">4.1</span> <span class="toctext"><span class="OIndex">File Open Dialog</span></span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Multiple_Files_Open_Dialog"><span class="tocnumber">4.2</span> <span class="toctext">Multiple Files Open Dialog</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#File_SaveAs_Dialog"><span class="tocnumber">4.3</span> <span class="toctext"><span class="OIndex">File SaveAs Dialog</span></span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Path_Browser_Dialog"><span class="tocnumber">4.4</span> <span class="toctext"><span class="OIndex">Path Browser Dialog</span></span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="Input_BoxNumeric_BoxString_BoxInput_NumericInput_String"></a><span class="mw-headline">Input Box<span class="OIndex" style="display:none">Numeric Box</span><span class="OIndex" style="display:none">String Box</span><span class="OIndex" style="display:none">Input Numeric</span><span class="OIndex" style="display:none">Input String</span></span></h2>
<p>Input boxes are used to solicit textual information from program users. The global function <i>InputBox</i> is used to open an input box.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// enter string</span>
string strName <span style="color: #000080;">=</span> InputBox<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Please enter your name&quot;</span>, <span style="color: #ff00ff;">&quot;&quot;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Name is&#160;%s.<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, strName<span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// enter numeric</span>
<span style="color: #0000ff;">double</span> dVal <span style="color: #000080;">=</span> InputBox<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span>, <span style="color: #ff00ff;">&quot;Please enter a value&quot;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Value is&#160;%g.<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, dVal<span style="color: #000000;">&#41;</span>;</pre>
<h2><a name="Message_Box"></a><span class="mw-headline"><span class="OIndex">Message Box</span></span></h2>
<p>Message boxes are used to convey information, or to prompt a user with a limited number of choices.  The information presented is considered important enough to require the user's attention before they are allowed to continue.
</p><p>The first example shows a simple OK message box to inform the user that their file has downloaded successfully.
</p>
<pre class="oc" style="font-family:monospace;">string strTitle <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;File Download&quot;</span>;
string strMsg <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Your file downloaded successfully.&quot;</span>;
MessageBox<span style="color: #000000;">&#40;</span>GetWindow<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>, strMsg, strTitle, MB_OK<span style="color: #000000;">&#41;</span>;</pre>
<p>The next example shows an OK-Cancel message box with an exclamation icon to warn the user that they will not be able to undo an action.  This gives the user a choice to proceed or to cancel their action.
</p>
<pre class="oc" style="font-family:monospace;">string strTitle <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Delete Data&quot;</span>;
string strMsg <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;You will not be able to undo this change.&quot;</span>;
<span style="color: #0000ff;">int</span> nMB <span style="color: #000080;">=</span> MB_OKCANCEL<span style="color: #000040;">|</span>MB_ICONEXCLAMATION;
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> IDOK <span style="color: #000080;">==</span> MessageBox<span style="color: #000000;">&#40;</span>GetWindow<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>, strMsg, strTitle, nMB<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
    out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Data has been deleted&quot;</span><span style="color: #000000;">&#41;</span>;</pre>
<p>The next example shows a Yes-No message box with a question mark icon.  This is being used to ask the user if they want to continue with their action.
</p>
<pre class="oc" style="font-family:monospace;">string strTitle <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Close Windows&quot;</span>;
string strMsg <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Are you sure you want to close all windows?&quot;</span>;
<span style="color: #0000ff;">int</span> nMB <span style="color: #000080;">=</span> MB_YESNO<span style="color: #000040;">|</span>MB_ICONQUESTION;
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> IDYES <span style="color: #000080;">==</span> MessageBox<span style="color: #000000;">&#40;</span>GetWindow<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>, strMsg, strTitle, nMB<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
    out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;All windows have been closed.&quot;</span><span style="color: #000000;">&#41;</span>;</pre>
<p>The next example shows a private reminder message dialog. An Ini file is used to initialize the dialog. Each section in the ini file is used for a single message. 
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000; font-style: regular;">/* Example Dialog.ini file in UFF.
[MyMessage]
;Title = My Reminder
Msg = This is my message.
;Btns = 4 for Yes No buttons
Btns = 4
*/</span>
<span style="color: #0000ff;">void</span> PrivateReminderMessage_ex1<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
   string iniFileName <span style="color: #000080;">=</span> GetOriginPath<span style="color: #000000;">&#40;</span>ORIGIN_PATH_USER<span style="color: #000000;">&#41;</span> <span style="color: #000040;">+</span> <span style="color: #ff00ff;">&quot;Dialog.ini&quot;</span>;
   <span style="color: #0000ff;">int</span> nRet <span style="color: #000080;">=</span> PrivateReminderMessage<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;MyMessage&quot;</span>, iniFileName<span style="color: #000000;">&#41;</span>;
   <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;User chose&#160;%d<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, nRet<span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Progress_Box"></a><span class="mw-headline"><span class="OIndex">Progress Box</span></span></h2>
<p>A progress box is a small dialog box that indicates the software is busy processing data. This dialog box contains a progress bar for showing the fraction of the completed processing. The progress dialog box is usually used in iterative loops.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">int</span> iMax <span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span>, iMin <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
progressBox prgbBox<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;This is a ProgressBox example:&quot;</span><span style="color: #000000;">&#41;</span>;
prgbBox.<span style="color: #000000;">SetRange</span><span style="color: #000000;">&#40;</span>iMin, iMax<span style="color: #000000;">&#41;</span>;

<span style="color: #0000ff;">for</span> <span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> ii<span style="color: #000080;">=</span>iMin; ii<span style="color: #000080;">&lt;=</span>iMax; ii<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>prgbBox.<span style="color: #000000;">Set</span><span style="color: #000000;">&#40;</span>ii<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>
        <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Hi, it is now at&#160;%d.<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, ii<span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">else</span> 
    <span style="color: #000000;">&#123;</span>
        out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;User abort!&quot;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Click Cancel button to abort</span>
        <span style="color: #0000ff;">break</span>;
    <span style="color: #000000;">&#125;</span>
    LT_execute<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;sec -p 0.5&quot;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="File_Dialogs"></a><span class="mw-headline">File Dialogs</span></h2>
<p>Origin C provides functions for all the common file and path dialogs.  This includes dialogs that prompt the user to open a single file, open multiple files, save a file, and choose a folder.  The following sections show you how to use these dialogs in your own applications.
</p>
<h3><a name="File_Open_Dialog"></a><span class="mw-headline"><span class="OIndex">File Open Dialog</span></span></h3>
<pre class="oc" style="font-family:monospace;">StringArray saFiletypes<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>;
saFiletypes<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;[Project (*.OPJ)] *.OPJ&quot;</span>;
saFiletypes<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;[Old version (*.ORG)] *.ORG&quot;</span>;
saFiletypes<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;[Worksheets (*.OGW)] *.OGW&quot;</span>;

string strPath <span style="color: #000080;">=</span> GetOpenBox<span style="color: #000000;">&#40;</span> saFiletypes, GetAppPath<span style="color: #000000;">&#40;</span><span style="color: #0000ff;">false</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>; 
out_str<span style="color: #000000;">&#40;</span>strPath<span style="color: #000000;">&#41;</span>;</pre>
<h3><a name="Multiple_Files_Open_Dialog"></a><span class="mw-headline">Multiple Files Open Dialog</span></h3>
<pre class="oc" style="font-family:monospace;">StringArray saFilePaths;
StringArray saFileTypes<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>;    
saFileTypes<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;[Project (*.OPJ)] *.OPJ&quot;</span>;
saFileTypes<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;[Old version (*.ORG)] *.ORG&quot;</span>;
saFileTypes<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;[Worksheets (*.OGW)] *.OGW&quot;</span>;

<span style="color: #008000;">// Press Ctrl or Shirt key to choose multiple files</span>
<span style="color: #0000ff;">int</span> iNumSelFiles <span style="color: #000080;">=</span> GetMultiOpenBox<span style="color: #000000;">&#40;</span>saFilePaths, saFileTypes, GetAppPath<span style="color: #000000;">&#40;</span><span style="color: #0000ff;">false</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;</pre>
<h3><a name="File_SaveAs_Dialog"></a><span class="mw-headline"><span class="OIndex">File SaveAs Dialog</span></span></h3>
<pre class="oc" style="font-family:monospace;">string strDefaultFilename <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Origin&quot;</span>;
FDLogUseGroup nFDLogUseGroup <span style="color: #000080;">=</span> FDLOG_ASCII; <span style="color: #008000;">// ASCII file group </span>

string strPath <span style="color: #000080;">=</span> GetSaveAsBox<span style="color: #000000;">&#40;</span>nFDLogUseGroup,GetAppPath<span style="color: #000000;">&#40;</span><span style="color: #0000ff;">false</span><span style="color: #000000;">&#41;</span>,strDefaultFilename<span style="color: #000000;">&#41;</span>;
out_str<span style="color: #000000;">&#40;</span> strPath <span style="color: #000000;">&#41;</span>;</pre>
<h3><a name="Path_Browser_Dialog"></a><span class="mw-headline"><span class="OIndex">Path Browser Dialog</span></span></h3>
<pre class="oc" style="font-family:monospace;">string strPath <span style="color: #000080;">=</span> BrowseGetPath<span style="color: #000000;">&#40;</span>GetAppPath<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000040;">+</span> <span style="color: #ff00ff;">&quot;OriginC<span style="color: #666666; font-weight: bold;">\\</span>&quot;</span>, <span style="color: #ff00ff;">&quot;This is an example&quot;</span><span style="color: #000000;">&#41;</span>;
out_str<span style="color: #000000;">&#40;</span>strPath<span style="color: #000000;">&#41;</span>;</pre>






