<h1 class="firstHeading">1.5.1 Base Matrix Book Operation</h1><p>The Origin C <a href="../../OriginC/Category/MatrixPage_(class).html" title="Category:MatrixPage (class)">MatrixPage</a> class provides methods and properties common to Origin matrix books. This class is derived from <a href="../../OriginC/Category/Page_(class).html" title="Category:Page (class)">Page</a> class, from which it inherits its methods and properties. And matrixbook has the same data structure level with <a href="../../OriginC/Category/WorksheetPage_(class).html" title="Category:WorksheetPage (class)">WorksheetPage</a> in Origin, both are windows. So, they contain lots of similar operations.
</p>
<h2><a name="Workbook-like_Operations"></a><span class="mw-headline">Workbook-like Operations</span></h2>
<p>Both matrixbook and workbook are windows, and they share lots of similar operations, and the <a href="../../OriginC/OCGuide/Basic_Workbook_Operation.html" title="OCGuide:Basic Workbook Operation">Basic Workbook Operation</a> chapter can be referred to.
</p>
<ol>
<li>Create New MatrixBook<br />
The same <a href="../../OriginC/OriginC/Page-Create.html" title="OriginC:Page-Create">Create</a> method is used.
<pre class="oc" style="font-family:monospace;">MatrixPage matPg;
matPg.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Origin&quot;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// create a matrixbook using the Origin template</span></pre>
</li>
<li>Open Matrixbook<br />
The difference to open a matrixbook by <a href="../../OriginC/OriginC/Worksheet-Open.html" title="OriginC:Worksheet-Open">Open</a> method is that the extension of a matrixbook is <i>ogm</i>.
</li>
<li>Access Matrixbook<br />
There are multiple ways to access an existing matrixbook and the methods used are the same as workbooks. The <a href="../../OriginC/Category/Project_(class).html" title="Category:Project (class)">Project</a> class contains a collection of all the matrixbooks in the project. The following example shows how to loop through them.

<pre class="oc" style="font-family:monospace;">foreach<span style="color: #000000;">&#40;</span>MatrixPage matPg in Project.<span style="color: #000000;">MatrixPages</span><span style="color: #000000;">&#41;</span>
    out_str<span style="color: #000000;">&#40;</span>matPg.<span style="color: #000000;">GetName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// output matrixbook name</span></pre>
<p>You can also access a matrixbook by passing its index to the <a href="../../OriginC/OriginC/Collection-Item.html" title="OriginC:Collection-Item">Item</a> method of the <a href="../../OriginC/Category/Collection_(class).html" title="Category:Collection (class)">Collection</a> class.
</p>
<pre class="oc" style="font-family:monospace;">MatrixPage matPg;
matPg <span style="color: #000080;">=</span> Project.<span style="color: #000000;">MatrixPages</span>.<span style="color: #000000;">Item</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>matPg<span style="color: #000000;">&#41;</span> <span style="color: #008000;">// if there is a 3rd matrixbook</span>
    out_str<span style="color: #000000;">&#40;</span>matPg.<span style="color: #000000;">GetName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// output matrixbook name</span></pre>
<p>If the matrixbook name is known, this matrixbook can be accessed by passing its name to the class constructor.
</p>
<pre class="oc" style="font-family:monospace;">MatrixPage matPg<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;MBook1&quot;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>matPg<span style="color: #000000;">&#41;</span> <span style="color: #008000;">// if there is a matrixbook named &quot;MBook1&quot;</span>
    matPg.<span style="color: #000000;">SetName</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;MyBook1&quot;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// rename the matrixbook</span></pre>
</li>
<li>Save Matrixbook<br />
The methods <a href="../../OriginC/OriginC/PageBase-SaveToFile.html" title="OriginC:PageBase-SaveToFile">SaveToFile</a> will be used for saving matrixbook as *.ogm file.

<pre class="oc" style="font-family:monospace;">MatrixPage matPg<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;MBook1&quot;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// Save matrixbook as OGM file</span>
<span style="color: #0000ff;">bool</span> bRet1 <span style="color: #000080;">=</span> matPg.<span style="color: #000000;">SaveToFile</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;D:<span style="color: #666666; font-weight: bold;">\\</span>&quot;</span> <span style="color: #000040;">+</span> matPg.<span style="color: #000000;">GetName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000040;">+</span> <span style="color: #ff00ff;">&quot;.ogm&quot;</span><span style="color: #000000;">&#41;</span>;</pre>
</li>
<li>Show or Hide Matrixbook<br />
This is the same as workbook's show and hide by using the <a href="../../OriginC/OriginC/OriginObject-Show.html" title="OriginC:OriginObject-Show">Show</a> property derived from <a href="../../OriginC/Category/OriginObject_(class).html" title="Category:OriginObject (class)">OriginObject</a> class.
</li>
<li>Activate Matrixbook<br />
To activate a workbook, the method <a href="../../OriginC/OriginC/PageBase-SetShow.html" title="OriginC:PageBase-SetShow">SetShow</a> can be used by passing parameter of value PAGE_ACTIVATE, which is the same as to activate a workbook.
<pre class="oc" style="font-family:monospace;">MatrixPage matPg<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;MBook1&quot;</span><span style="color: #000000;">&#41;</span>;
matPg.<span style="color: #000000;">SetShow</span><span style="color: #000000;">&#40;</span>PAGE_ACTIVATE<span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// Activate the matrixbook</span></pre>
</li>
<li>Delete Matrixbook<br />
The <a href="../../OriginC/OriginC/OriginObject-Destroy.html" title="OriginC:OriginObject-Destroy">Destroy</a> method can also be used to destroy (delete) a matrixbook.
<pre class="oc" style="font-family:monospace;">MatrixPage matPg;
matPg <span style="color: #000080;">=</span> Project.<span style="color: #000000;">MatrixPages</span>.<span style="color: #000000;">Item</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// get first matrixbook in project</span>
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> matPg <span style="color: #000000;">&#41;</span> <span style="color: #008000;">// if there is a matrixbook</span>
    matPg.<span style="color: #000000;">Destroy</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// delete the matrixbook</span></pre>
</li>
<li>Clone/Duplicate Matrixbook<br />
<span class="OIndex" style="display:none">Page, Clone</span><span class="OIndex" style="display:none">Duplicate Window</span>
The <a href="../../OriginC/OriginC/Page-Clone.html" title="OriginC:Page-Clone">Clone</a> method is also used to clone the matrix page.
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Duplicate &quot;MBook1&quot; window with data and style </span>
<span style="color: #008000;">// Before calling make sure these windows exist</span>
MatrixPage matPage<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;MBook1&quot;</span><span style="color: #000000;">&#41;</span>;
MatrixPage matPage1 <span style="color: #000080;">=</span> matPage.<span style="color: #000000;">Clone</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</pre>
</li>
<li>Name and Label Matrixbook<br />
To handle with matrixbook's short name, Long Name and Comments, Origin C provides the same ways as handling workbook's, including the inherited methods <a href="../../OriginC/OriginC/OriginObject-SetName.html" title="OriginC:OriginObject-SetName">SetName</a>, <a href="../../OriginC/OriginC/OriginObject-SetLongName.html" title="OriginC:OriginObject-SetLongName">SetLongName</a>, <a href="../../OriginC/OriginC/OriginObject-SetComments.html" title="OriginC:OriginObject-SetComments">SetComments</a>, and <a href="../../OriginC/OriginC/PageBase-Label.html" title="OriginC:PageBase-Label">Label</a> property.
</li>
</ol>
<h2><a name="Show_Image_Thumbnails"></a><span class="mw-headline">Show Image Thumbnails</span></h2>
<p>To show or hide image thumbnails, the method <a href="../../OriginC/OriginC/MatrixPage-ShowImageThumbnails.html" title="OriginC:MatrixPage-ShowImageThumbnails">MatrixPage::ShowImageThumbnails</a> is available.
</p>
<pre class="oc" style="font-family:monospace;">MatrixPage mp<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;tangent&quot;</span><span style="color: #000000;">&#41;</span>;
mp.<span style="color: #000000;">ShowImageThumbnails</span><span style="color: #000000;">&#40;</span><span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// Pass true to make thumbnail visible</span></pre>






