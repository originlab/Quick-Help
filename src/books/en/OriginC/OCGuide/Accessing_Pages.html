<h1 class="firstHeading">1.9.3 Accessing Pages</h1><p>Pages in Origin consist of workbooks, matrixbooks and graphs, and are the core objects in a project. Origin C allows you to access a page by name or by index, or access all instances of a particular page type in the current project using the <b>foreach</b> statement.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Access_a_Page_by_Name_and_Index"><span class="tocnumber">1</span> <span class="toctext">Access a Page by Name and Index</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Get_the_Active_Page_and_LayerProject.2C_Get_the_Active_LayerProject.2C_Get_the_Active_Page"><span class="tocnumber">2</span> <span class="toctext">Get the Active Page and Layer<span class="OIndex" style="display:none">Project, Get the Active Layer</span><span class="OIndex" style="display:none">Project, Get the Active Page</span></span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Activate_One_Page_Active_Page.2C_Page_Active"><span class="tocnumber">3</span> <span class="toctext">Activate One Page <span class="OIndex" style="display:none">Active Page, Page Active</span></span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Using_foreachforeach_StatementProject.2C_Loop_the_Existing_Windows"><span class="tocnumber">4</span> <span class="toctext">Using <b>foreach</b><span class="OIndex" style="display:none">foreach Statement</span><span class="OIndex" style="display:none">Project, Loop the Existing Windows</span></span></a></li>
</ul>
</div>

<h2><a name="Access_a_Page_by_Name_and_Index"></a><span class="mw-headline">Access a Page by Name and Index</span></h2>
<p><span class="OIndex" style="display:none">Project, Get the Existing Window</span>
All pages have names, which can be used to access them, as in the following example:
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Access a page by its name</span>
GraphPage gp1<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Graph1&quot;</span><span style="color: #000000;">&#41;</span>;	

<span style="color: #008000;">// Access a page by its zero based index</span>
GraphPage gp2 <span style="color: #000080;">=</span> Project.<span style="color: #000000;">GraphPages</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// 0 for first page</span></pre>
<h2><a name="Get_the_Active_Page_and_LayerProject.2C_Get_the_Active_LayerProject.2C_Get_the_Active_Page"></a><span class="mw-headline">Get the Active Page and Layer<span class="OIndex" style="display:none">Project, Get the Active Layer</span><span class="OIndex" style="display:none">Project, Get the Active Page</span></span></h2>
<p>In a workbook page, a layer is a worksheet; in a graph page, a layer is a pair of axes; in a matrix page, a layer is a matrixsheet.
</p><p>If you want to access the page associated with a particular layer, such as the active layer, it can be done with the <b><a href="../../OriginC/OriginC/Layer-GetPage.html" title="OriginC:Layer-GetPage">Layer::GetPage</a></b> method: 
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// get active layer</span>
GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// get active page from layer</span>
GraphPage gp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">GetPage</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</pre>
<h2><a name="Activate_One_Page_Active_Page.2C_Page_Active"></a><span class="mw-headline">Activate One Page <span class="OIndex" style="display:none">Active Page, Page Active</span></span></h2>
<p>If want to activate a window, you can use PageBase::SetShow(PAGE_ACTIVATE) to cause the window to be activated.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// attach to a graph window named Graph2</span>
GraphPage gp<span style="color: #000000;">&#40;</span> <span style="color: #ff00ff;">&quot;Graph2&quot;</span> <span style="color: #000000;">&#41;</span>; 

<span style="color: #008000;">// set the window to be active</span>
gp.<span style="color: #000000;">SetShow</span><span style="color: #000000;">&#40;</span> PAGE_ACTIVATE <span style="color: #000000;">&#41;</span>;</pre>
<h2><a name="Using_foreachforeach_StatementProject.2C_Loop_the_Existing_Windows"></a><span class="mw-headline">Using <b>foreach</b><span class="OIndex" style="display:none">foreach Statement</span><span class="OIndex" style="display:none">Project, Loop the Existing Windows</span></span></h2>
<p>The <b>foreach</b> statement simplifies the process of looping through all the items in a collection.  The project contains all the pages in various collections.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Loop through all workbook pages in the current project</span>
<span style="color: #008000;">// and output the name of each page.</span>
foreach<span style="color: #000000;">&#40;</span> WorksheetPage wksPage in Project.<span style="color: #000000;">WorksheetPages</span> <span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    out_str<span style="color: #000000;">&#40;</span>wksPage.<span style="color: #000000;">GetName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Loop through all matrixbook pages in the current project</span>
<span style="color: #008000;">// and output the name of each page.</span>
foreach<span style="color: #000000;">&#40;</span> MatrixPage matPage in Project.<span style="color: #000000;">MatrixPages</span> <span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    out_str<span style="color: #000000;">&#40;</span>matPage.<span style="color: #000000;">GetName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Loop through all graph pages in the current project</span>
<span style="color: #008000;">// and output the name of each page.</span>
foreach<span style="color: #000000;">&#40;</span> GraphPage gp in Project.<span style="color: #000000;">GraphPages</span> <span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    out_str<span style="color: #000000;">&#40;</span>gp.<span style="color: #000000;">GetName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Loop through all pages in the current project</span>
<span style="color: #008000;">// and output the name of each page.</span>
foreach<span style="color: #000000;">&#40;</span> PageBase pg in Project.<span style="color: #000000;">Pages</span> <span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    out_str<span style="color: #000000;">&#40;</span>pg.<span style="color: #000000;">GetName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>






