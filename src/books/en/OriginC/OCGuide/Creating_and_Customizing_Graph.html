<h1 class="firstHeading">1.7.1 Creating and Customizing Graph</h1><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Creating_Graph_WindowGraph_Page.2C_CreateTemplate"><span class="tocnumber">1</span> <span class="toctext">Creating Graph Window<span class="OIndex" style="display:none">Graph Page, Create</span><span class="OIndex" style="display:none">Template</span></span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Getting_Graph_Page_FormatGraph_Page.2C_Get_Format"><span class="tocnumber">2</span> <span class="toctext">Getting Graph Page Format<span class="OIndex" style="display:none">Graph Page, Get Format</span></span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Setting_Graph_Page_Format"><span class="tocnumber">3</span> <span class="toctext">Setting Graph Page Format</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Getting_Graph_Layer_FormatGraph_Layer.2C_Get_Format"><span class="tocnumber">4</span> <span class="toctext">Getting Graph Layer Format<span class="OIndex" style="display:none">Graph Layer, Get Format</span></span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Setting_Graph_Layer_Format"><span class="tocnumber">5</span> <span class="toctext">Setting Graph Layer Format</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Show_Additional_LinesGraph_Layer.2C_Show_Additional_Lines"><span class="tocnumber">6</span> <span class="toctext">Show Additional Lines<span class="OIndex" style="display:none">Graph Layer, Show Additional Lines</span></span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Show_Grid_LinesGraph_Layer.2C_Grid_Lines"><span class="tocnumber">7</span> <span class="toctext">Show Grid Lines<span class="OIndex" style="display:none">Graph Layer, Grid Lines</span></span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Setting_Axis_ScaleGraph_Layer.2C_Scale_Settings"><span class="tocnumber">8</span> <span class="toctext">Setting Axis Scale<span class="OIndex" style="display:none">Graph Layer, Scale Settings</span></span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Getting_Axis_FormatGraph_Layer.2C_Axis_Properties"><span class="tocnumber">9</span> <span class="toctext">Getting Axis Format<span class="OIndex" style="display:none">Graph Layer, Axis Properties</span></span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#Setting_Axis_LabelGraph_Layer.2C_Axis_Label_Properties"><span class="tocnumber">10</span> <span class="toctext">Setting Axis Label<span class="OIndex" style="display:none">Graph Layer, Axis Label Properties</span></span></a></li>
<li class="toclevel-1 tocsection-11"><a href="#Show_Top_AxisGraph_Layer.2C_Show.2FHide_Axis"><span class="tocnumber">11</span> <span class="toctext">Show Top Axis<span class="OIndex" style="display:none">Graph Layer, Show/Hide Axis</span></span></a></li>
<li class="toclevel-1 tocsection-12"><a href="#Customizing_Axis_TicksGraph_Layer.2C_Axis_Ticks_Properties"><span class="tocnumber">12</span> <span class="toctext">Customizing Axis Ticks<span class="OIndex" style="display:none">Graph Layer, Axis Ticks Properties</span></span></a></li>
<li class="toclevel-1 tocsection-13"><a href="#Customizing_Tick_LabelsGraph_Layer.2C_Axis_Tick_Label_Properties"><span class="tocnumber">13</span> <span class="toctext">Customizing Tick Labels<span class="OIndex" style="display:none">Graph Layer, Axis Tick Label Properties</span></span></a></li>
<li class="toclevel-1 tocsection-14"><a href="#Change_Scale_Factor"><span class="tocnumber">14</span> <span class="toctext">Change Scale Factor</span></a></li>
</ul>
</div>

<h2><a name="Creating_Graph_WindowGraph_Page.2C_CreateTemplate"></a><span class="mw-headline">Creating Graph Window<span class="OIndex" style="display:none">Graph Page, Create</span><span class="OIndex" style="display:none">Template</span></span></h2>
<p>The <b>Create</b> method is used for creating new graphs. 
</p>
<pre class="oc" style="font-family:monospace;">GraphPage gp;
gp.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;3D&quot;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// create a graph using the 3D template</span></pre>
<h2><a name="Getting_Graph_Page_FormatGraph_Page.2C_Get_Format"></a><span class="mw-headline">Getting Graph Page Format<span class="OIndex" style="display:none">Graph Page, Get Format</span></span></h2>
<pre class="oc" style="font-family:monospace;">GraphPage gp<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Graph1&quot;</span><span style="color: #000000;">&#41;</span>;

Tree tr;
tr <span style="color: #000080;">=</span> gp.<span style="color: #000000;">GetFormat</span><span style="color: #000000;">&#40;</span>FPB_ALL, FOB_ALL, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;
out_tree<span style="color: #000000;">&#40;</span>tr<span style="color: #000000;">&#41;</span>;</pre>
<h2><a name="Setting_Graph_Page_Format"></a><span class="mw-headline">Setting Graph Page Format</span></h2>
<p><span class="OIndex" style="display:none">Graph Page, Background</span><span class="OIndex" style="display:none">Graph Page, Gradient Control</span>The following example code shows how to set page background color as a gradient in two colors.
</p>
<pre class="oc" style="font-family:monospace;">Tree tr;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Background</span>.<span style="color: #000000;">BaseColor</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> SYSCOLOR_RED;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Background</span>.<span style="color: #000000;">GradientControl</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Background</span>.<span style="color: #000000;">GradientColor</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> SYSCOLOR_BLUE;

GraphPage gp<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Graph1&quot;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> gp.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">&#40;</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
	gp.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">&#40;</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;</pre>
<h2><a name="Getting_Graph_Layer_FormatGraph_Layer.2C_Get_Format"></a><span class="mw-headline">Getting Graph Layer Format<span class="OIndex" style="display:none">Graph Layer, Get Format</span></span></h2>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;

Tree tr;
tr <span style="color: #000080;">=</span> gl.<span style="color: #000000;">GetFormat</span><span style="color: #000000;">&#40;</span>FPB_ALL, FOB_ALL, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;
out_tree<span style="color: #000000;">&#40;</span>tr<span style="color: #000000;">&#41;</span>;</pre>
<h2><a name="Setting_Graph_Layer_Format"></a><span class="mw-headline">Setting Graph Layer Format</span></h2>
<p><span class="OIndex" style="display:none">Graph Layer, Border</span><span class="OIndex" style="display:none">Graph Layer, Fill Color</span>
The following example code shows how to set the background of a graph layer object to Black Line format.
</p>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;

Tree tr;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Background</span>.<span style="color: #000000;">Border</span>.<span style="color: #000000;">Color</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> SYSCOLOR_BLACK;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Background</span>.<span style="color: #000000;">Border</span>.<span style="color: #000000;">Width</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Background</span>.<span style="color: #000000;">Fill</span>.<span style="color: #000000;">Color</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> SYSCOLOR_WHITE;

<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> gl.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">&#40;</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
	gl.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">&#40;</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;</pre>
<h2><a name="Show_Additional_LinesGraph_Layer.2C_Show_Additional_Lines"></a><span class="mw-headline">Show Additional Lines<span class="OIndex" style="display:none">Graph Layer, Show Additional Lines</span></span></h2>
<p>This example shows how to show additional lines, the Y=0/X=0 line, and the opposite line.
</p>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
Axis axesX <span style="color: #000080;">=</span> gl.<span style="color: #000000;">XAxis</span>;	

axesX.<span style="color: #000000;">Additional</span>.<span style="color: #000000;">ZeroLine</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; <span style="color: #008000;">// Show Y = 0 line</span>
axesX.<span style="color: #000000;">Additional</span>.<span style="color: #000000;">OppositeLine</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; <span style="color: #008000;">// Show X Axes opposite line</span></pre>
<h2><a name="Show_Grid_LinesGraph_Layer.2C_Grid_Lines"></a><span class="mw-headline">Show Grid Lines<span class="OIndex" style="display:none">Graph Layer, Grid Lines</span></span></h2>
<p>This example shows how to set gridlines to show, and how to color them.
</p><p>Color values can be an index into Origin's internal color palette or an RGB value.  See <a href="../../OriginC/OCGuide/Data_Types_and_Variables.html#Color" title="OCGuide:Data Types and Variables">Color</a> in the <a href="../../OriginC/OCGuide/Data_Types_and_Variables.html" title="OCGuide:Data Types and Variables">Data Types and Variables</a> section for more information about working with color values.
</p>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
Axis axisY <span style="color: #000080;">=</span> gl.<span style="color: #000000;">YAxis</span>;
Tree tr;	

<span style="color: #008000;">// Show major grid</span>
TreeNode trProperty <span style="color: #000080;">=</span> tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Grids</span>.<span style="color: #000000;">HorizontalMajorGrids</span>.<span style="color: #000000;">AddNode</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Show&quot;</span><span style="color: #000000;">&#41;</span>;
trProperty.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Grids</span>.<span style="color: #000000;">HorizontalMajorGrids</span>.<span style="color: #000000;">Color</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> RGB2OCOLOR<span style="color: #000000;">&#40;</span>RGB<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">100</span>, <span style="color: #0000dd;">100</span>, <span style="color: #0000dd;">220</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Grids</span>.<span style="color: #000000;">HorizontalMajorGrids</span>.<span style="color: #000000;">Style</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; <span style="color: #008000;">// Solid</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Grids</span>.<span style="color: #000000;">HorizontalMajorGrids</span>.<span style="color: #000000;">Width</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;

<span style="color: #008000;">// Show minor grid</span>
trProperty <span style="color: #000080;">=</span> tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Grids</span>.<span style="color: #000000;">HorizontalMinorGrids</span>.<span style="color: #000000;">AddNode</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Show&quot;</span><span style="color: #000000;">&#41;</span>;
trProperty.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Grids</span>.<span style="color: #000000;">HorizontalMinorGrids</span>.<span style="color: #000000;">Color</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> SYSCOLOR_GREEN; <span style="color: #008000;">// Green</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Grids</span>.<span style="color: #000000;">HorizontalMinorGrids</span>.<span style="color: #000000;">Style</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>; <span style="color: #008000;">// Dot</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Grids</span>.<span style="color: #000000;">HorizontalMinorGrids</span>.<span style="color: #000000;">Width</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0.3</span>;

<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> axisY.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">&#40;</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	<span style="color: #0000ff;">bool</span> bRet <span style="color: #000080;">=</span> axisY.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">&#40;</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Setting_Axis_ScaleGraph_Layer.2C_Scale_Settings"></a><span class="mw-headline">Setting Axis Scale<span class="OIndex" style="display:none">Graph Layer, Scale Settings</span></span></h2>
<p>This example shows how to set scale parameters, increment, type and so on.
</p>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
Axis axesX <span style="color: #000080;">=</span> gl.<span style="color: #000000;">XAxis</span>;  
 
axesX.<span style="color: #000000;">Scale</span>.<span style="color: #000000;">From</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
axesX.<span style="color: #000000;">Scale</span>.<span style="color: #000000;">To</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
axesX.<span style="color: #000000;">Scale</span>.<span style="color: #000000;">IncrementBy</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; <span style="color: #008000;">// 0=increment by value; 1=number of major ticks</span>
axesX.<span style="color: #000000;">Scale</span>.<span style="color: #000000;">Value</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0.2</span>; <span style="color: #008000;">// Increment value</span>
axesX.<span style="color: #000000;">Scale</span>.<span style="color: #000000;">Type</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;<span style="color: #008000;">// Linear </span>
axesX.<span style="color: #000000;">Scale</span>.<span style="color: #000000;">Rescale</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; <span style="color: #008000;">// Rescake type</span>
axesX.<span style="color: #000000;">Scale</span>.<span style="color: #000000;">RescaleMargin</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">8</span>; <span style="color: #008000;">// precent 8</span></pre>
<p>This example shows how to set scale major ticks number for Y axis.
</p>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
Axis axesY <span style="color: #000080;">=</span> gl.<span style="color: #000000;">YAxis</span>; 

axesY.<span style="color: #000000;">Scale</span>.<span style="color: #000000;">IncrementBy</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; <span style="color: #008000;">// 0: increment by value; 1: number of major ticks</span>
axesY.<span style="color: #000000;">Scale</span>.<span style="color: #000000;">MajorTicksCount</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>;</pre>
<h2><a name="Getting_Axis_FormatGraph_Layer.2C_Axis_Properties"></a><span class="mw-headline">Getting Axis Format<span class="OIndex" style="display:none">Graph Layer, Axis Properties</span></span></h2>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
Axis axisX <span style="color: #000080;">=</span> gl.<span style="color: #000000;">XAxis</span>;

<span style="color: #008000;">// Get all axis format settings to tree</span>
Tree tr;
tr <span style="color: #000080;">=</span> axisX.<span style="color: #000000;">GetFormat</span><span style="color: #000000;">&#40;</span>FPB_ALL, FOB_ALL, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;
out_tree<span style="color: #000000;">&#40;</span>tr<span style="color: #000000;">&#41;</span>;</pre>
<h2><a name="Setting_Axis_LabelGraph_Layer.2C_Axis_Label_Properties"></a><span class="mw-headline">Setting Axis Label<span class="OIndex" style="display:none">Graph Layer, Axis Label Properties</span></span></h2>
<p>An axis label is an ordinary text object and is accessed in Origin C using the GraphObject class.  On a default graph the X axis is named XB and the Y axis is named YL.  The following code shows how to access the X and Y axis labels and assumes a default graph is the active page.
</p>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;    <span style="color: #008000;">// Get active graph layer</span>

GraphObject grXL <span style="color: #000080;">=</span> gl.<span style="color: #000000;">GraphObjects</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;XB&quot;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Get X axis label</span>
GraphObject grYL <span style="color: #000080;">=</span> gl.<span style="color: #000000;">GraphObjects</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;YL&quot;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Get Y axis label</span></pre>
<p>Now that we have access to the axis labels we can change their values.  The following code sets the X axis label directly and sets the Y axis label indirectly by linking it to a LabTalk string variable.  Linking to a LabTalk variable requires the label's Programming Control option "Link to variables" to be turned on.  This option is on by default.
</p>
<pre class="oc" style="font-family:monospace;">grXL.<span style="color: #000000;">Text</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;My New X Asis Label&quot;</span>;

LT_set_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;abc$&quot;</span>, <span style="color: #ff00ff;">&quot;My String Variable&quot;</span><span style="color: #000000;">&#41;</span>;
grYL.<span style="color: #000000;">Text</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;%(abc$)&quot;</span>;</pre>
<p><span class="OIndex" style="display:none">Graph Layer, Refresh</span>To make sure the label changes appear, it may be necessary to refresh the graph page.  With our GraphLayer object we can refresh the page with the following code.
</p>
<pre class="oc" style="font-family:monospace;">gl.<span style="color: #000000;">GetPage</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>.<span style="color: #000000;">Refresh</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</pre>
<h2><a name="Show_Top_AxisGraph_Layer.2C_Show.2FHide_Axis"></a><span class="mw-headline">Show Top Axis<span class="OIndex" style="display:none">Graph Layer, Show/Hide Axis</span></span></h2>
<p>This example shows how to show X top axes.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Show axes and ticks</span>
Tree tr;	
TreeNode trProperty <span style="color: #000080;">=</span> tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Ticks</span>.<span style="color: #000000;">TopTicks</span>.<span style="color: #000000;">AddNode</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Show&quot;</span><span style="color: #000000;">&#41;</span>;
trProperty.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;

<span style="color: #008000;">// Show tick labels</span>
trProperty <span style="color: #000080;">=</span> tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Labels</span>.<span style="color: #000000;">TopLabels</span>.<span style="color: #000000;">AddNode</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Show&quot;</span><span style="color: #000000;">&#41;</span>;
trProperty.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;

GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
Axis axesX <span style="color: #000080;">=</span> gl.<span style="color: #000000;">XAxis</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> axesX.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">&#40;</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	<span style="color: #0000ff;">bool</span> bRet <span style="color: #000080;">=</span> axesX.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">&#40;</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Customizing_Axis_TicksGraph_Layer.2C_Axis_Ticks_Properties"></a><span class="mw-headline">Customizing Axis Ticks<span class="OIndex" style="display:none">Graph Layer, Axis Ticks Properties</span></span></h2>
<p>This example shows how to set the format in the Axis dialog -&gt; Title &amp; Format tab.
</p>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
Axis axesX <span style="color: #000080;">=</span> gl.<span style="color: #000000;">XAxis</span>;	

Tree tr;
<span style="color: #008000;">// Set ticks color as Auto, depend on the color of data plot</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Ticks</span>.<span style="color: #000000;">BottomTicks</span>.<span style="color: #000000;">Color</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> INDEX_COLOR_AUTOMATIC;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Ticks</span>.<span style="color: #000000;">BottomTicks</span>.<span style="color: #000000;">Width</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Ticks</span>.<span style="color: #000000;">BottomTicks</span>.<span style="color: #000000;">Major</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; <span style="color: #008000;">// 0: In and Out</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Ticks</span>.<span style="color: #000000;">BottomTicks</span>.<span style="color: #000000;">Minor</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>; <span style="color: #008000;">// 2: Out</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Ticks</span>.<span style="color: #000000;">BottomTicks</span>.<span style="color: #000000;">Style</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; <span style="color: #008000;">// Solid</span>

<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> axesX.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">&#40;</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
    <span style="color: #0000ff;">bool</span> bRet <span style="color: #000080;">=</span> axesX.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">&#40;</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;</pre>
<h2><a name="Customizing_Tick_LabelsGraph_Layer.2C_Axis_Tick_Label_Properties"></a><span class="mw-headline">Customizing Tick Labels<span class="OIndex" style="display:none">Graph Layer, Axis Tick Label Properties</span></span></h2>
<p>This example shows how to set tick labels with custom positions. It performs the same action as going in the Axis dialog Custom Tick Labels tab.
</p>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
Axis axesX <span style="color: #000080;">=</span> gl.<span style="color: #000000;">XAxis</span>;

Tree tr;
<span style="color: #008000;">// Show axes begin and end as scale value</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Labels</span>.<span style="color: #000000;">BottomLabels</span>.<span style="color: #000000;">Custom</span>.<span style="color: #000000;">Begin</span>.<span style="color: #000000;">Type</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;	
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Labels</span>.<span style="color: #000000;">BottomLabels</span>.<span style="color: #000000;">Custom</span>.<span style="color: #000000;">End</span>.<span style="color: #000000;">Type</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;

<span style="color: #008000;">// Set special point as Manual type with the special value and text.</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Labels</span>.<span style="color: #000000;">BottomLabels</span>.<span style="color: #000000;">Custom</span>.<span style="color: #000000;">Special</span>.<span style="color: #000000;">Type</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Labels</span>.<span style="color: #000000;">BottomLabels</span>.<span style="color: #000000;">Custom</span>.<span style="color: #000000;">Special</span>.<span style="color: #000000;">Label</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Mid&quot;</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Labels</span>.<span style="color: #000000;">BottomLabels</span>.<span style="color: #000000;">Custom</span>.<span style="color: #000000;">Special</span>.<span style="color: #000000;">Value</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">12</span>;

<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> axesX.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">&#40;</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	<span style="color: #0000ff;">bool</span> bRet <span style="color: #000080;">=</span> axesX.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">&#40;</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Change_Scale_Factor"></a><span class="mw-headline">Change Scale Factor</span></h2>
<p>This example shows how to scale the font size and line thickness when page size changed by changing scale factor.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">void</span> change_graph_and_font_size<span style="color: #000000;">&#40;</span><span style="color: #0000ff;">double</span> dNewWidth <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	GraphPage gp <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>.<span style="color: #000000;">GetPage</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	Tree tr1;tr1 <span style="color: #000080;">=</span> gp.<span style="color: #000000;">GetFormat</span><span style="color: #000000;">&#40;</span>FPB_ALL, FOB_ALL, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #0000ff;">double</span> dOldWidth <span style="color: #000080;">=</span> tr1.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimension</span>.<span style="color: #000000;">Width</span>.<span style="color: #000000;">dVal</span>;
	<span style="color: #0000ff;">double</span> factor <span style="color: #000080;">=</span> dOldWidth<span style="color: #000040;">/</span>tr1.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimension</span>.<span style="color: #000000;">Height</span>.<span style="color: #000000;">dVal</span>;
	Tree tr2;
	tr2.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimension</span>.<span style="color: #000000;">Width</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> dNewWidth;
	tr2.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimension</span>.<span style="color: #000000;">Height</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> dNewWidth <span style="color: #000040;">/</span> factor;
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> gp.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">&#40;</span>tr2.<span style="color: #000000;">Root</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		gp.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">&#40;</span>tr2, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;
		string strScript;
		<span style="color: #008000;">//page -afu&#160;: Change Scale Factor</span>
		<span style="color: #008000;">//win -z0&#160;: fit page to window size</span>
		strScript.<span style="color: #000000;">Format</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;page -AFU&#160;%f;win -z0&quot;</span>, <span style="color: #000040;">-</span>dNewWidth<span style="color: #000040;">/</span>dOldWidth<span style="color: #000000;">&#41;</span>;
		gp.<span style="color: #000000;">LT_execute</span><span style="color: #000000;">&#40;</span>strScript<span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>
<table class="note">

<tr>
<td><b>Note:</b>
<p>In this case, tr1 is only used to get current dimension value and does not apply new value.
</p>
<dl><dt>It's because tr1 also has graph object position settingsï¼Œwhich are outdated if you want to change graph dimension.</dt>
<dt>The correct way is to apply dimension setting only and graph object position will automatically update.</dt></dl>
</td></tr></table>






