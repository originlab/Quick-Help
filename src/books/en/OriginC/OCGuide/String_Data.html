<h1 class="firstHeading">1.8.2 String Data</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#String_Variables_String.2C_Define_Variables"><span class="tocnumber">1</span> <span class="toctext">String Variables <span class="OIndex" style="display:none">String, Define Variables</span></span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Convert_String_to_NumericString.2C_Convert_to_IntegerString.2C_Convert_to_DoubleString.2C_Convert_to_Complex"><span class="tocnumber">2</span> <span class="toctext">Convert String to Numeric<span class="OIndex" style="display:none">String, Convert to Integer</span><span class="OIndex" style="display:none">String, Convert to Double</span><span class="OIndex" style="display:none">String, Convert to Complex</span></span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Append_Numeric.2FString_to_another_String"><span class="tocnumber">3</span> <span class="toctext">Append Numeric/String to another String</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Find_Sub_String"><span class="tocnumber">4</span> <span class="toctext">Find Sub String</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Replace_Sub_String"><span class="tocnumber">5</span> <span class="toctext">Replace Sub String</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Path_String_Functions"><span class="tocnumber">6</span> <span class="toctext">Path String Functions</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#File_Path_StringString.2C_Check_Path_StringString.2C_Extract_File_Name_from_Full_Path"><span class="tocnumber">6.1</span> <span class="toctext">File Path String<span class="OIndex" style="display:none">String, Check Path String</span><span class="OIndex" style="display:none">String, Extract File Name from Full Path</span></span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Origin_System_PathString.2C_Origin_System_FolderString.2C_User_File_FolderUser_File_Folder"><span class="tocnumber">6.2</span> <span class="toctext"><span class="OIndex">Origin System Path</span><span class="OIndex" style="display:none">String, Origin System Folder</span><span class="OIndex" style="display:none">String, User File Folder</span><span class="OIndex" style="display:none">User File Folder</span></span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="String_Variables_String.2C_Define_Variables"></a><span class="mw-headline">String Variables <span class="OIndex" style="display:none">String, Define Variables</span></span></h2>
<pre class="oc" style="font-family:monospace;">string str1; <span style="color: #008000;">// Declare a string variable named str1</span>
str1 <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;New York&quot;</span>; <span style="color: #008000;">// Assigns to str1 a character sequence</span>

string str2 <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Tokyo&quot;</span>; <span style="color: #008000;">// Declare a string variable and assignment</span>

<span style="color: #008000;">// Declare a character array and initialize with a character sequence</span>
<span style="color: #0000ff;">char</span> ch<span style="color: #000000;">&#91;</span><span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;This is a test!&quot;</span>; 

<span style="color: #008000;">// Declare a character array, set size and initialize with a character sequence</span>
<span style="color: #0000ff;">char</span> chArr<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">255</span><span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Big World.&quot;</span>;</pre>
<h2><a name="Convert_String_to_NumericString.2C_Convert_to_IntegerString.2C_Convert_to_DoubleString.2C_Convert_to_Complex"></a><span class="mw-headline">Convert String to Numeric<span class="OIndex" style="display:none">String, Convert to Integer</span><span class="OIndex" style="display:none">String, Convert to Double</span><span class="OIndex" style="display:none">String, Convert to Complex</span></span></h2>
<pre class="oc" style="font-family:monospace;">string str <span style="color: #000080;">=</span> PI; <span style="color: #008000;">// Assigns a numeric value to string variable</span>

<span style="color: #008000;">// Convert string to numeric</span>
<span style="color: #0000ff;">double</span> dd <span style="color: #000080;">=</span> <span style="color: #000000;">atof</span><span style="color: #000000;">&#40;</span>str, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;
out_double<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;dd=&quot;</span>, dd<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// dd=3.14159</span>

<span style="color: #008000;">// Convert string to complex</span>
str <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;1+2.5i&quot;</span>;
complex cc <span style="color: #000080;">=</span> atoc<span style="color: #000000;">&#40;</span>str<span style="color: #000000;">&#41;</span>; 
out_complex<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;cc = &quot;</span>, cc<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// cc = 1.000000+2.500000i</span>

<span style="color: #008000;">// Convert string to int</span>
str <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;100&quot;</span>;
<span style="color: #0000ff;">int</span> nn <span style="color: #000080;">=</span> <span style="color: #000000;">atoi</span><span style="color: #000000;">&#40;</span>str<span style="color: #000000;">&#41;</span>;
out_int<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;nn = &quot;</span>, nn<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// nn = 100</span></pre>
<h2><a name="Append_Numeric.2FString_to_another_String"></a><span class="mw-headline">Append Numeric/String to another String</span></h2>
<p><span class="OIndex" style="display:none">String, Append String</span><span class="OIndex" style="display:none">String, Append Numeric</span>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Append numeric or string to another string</span>
<span style="color: #008000;">// In Origin C, support use '+' to add a numeric/string type const or variable 	</span>
string str <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;The area is &quot;</span> <span style="color: #000040;">+</span> <span style="color: #0000dd;">30.7</span>; <span style="color: #008000;">// Append a double type const to string</span>

str <span style="color: #000040;">+</span><span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>; <span style="color: #008000;">// Append a string const to string variable</span>

<span style="color: #0000ff;">int</span> nLength <span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span>;
str <span style="color: #000040;">+</span><span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;The length is &quot;</span> <span style="color: #000040;">+</span> nLength; <span style="color: #008000;">// Append a int type variable to string</span>

out_str<span style="color: #000000;">&#40;</span>str<span style="color: #000000;">&#41;</span>;</pre>
<h2><a name="Find_Sub_String"></a><span class="mw-headline">Find Sub String</span></h2>
<p><span class="OIndex" style="display:none">String, Find</span><span class="OIndex" style="display:none">String, Get Sub String</span>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Find and get sub string</span>
string str <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;[Book1]Sheet1!A:C&quot;</span>;
<span style="color: #0000ff;">int</span> begin <span style="color: #000080;">=</span> str.<span style="color: #000000;">Find</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">']'</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Find and return the index of ']'</span>
begin<span style="color: #000040;">++</span>; <span style="color: #008000;">// Move to the next character of ]</span>

<span style="color: #0000ff;">int</span> end <span style="color: #000080;">=</span> str.<span style="color: #000000;">Find</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">'!'</span>, begin<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Find and return the index of '!'</span>
end<span style="color: #000040;">--</span>; <span style="color: #008000;">// Move the previous character of&#160;!</span>

<span style="color: #008000;">// Get the sub string with the begin index and substring length</span>
<span style="color: #0000ff;">int</span> nLength <span style="color: #000080;">=</span> end <span style="color: #000040;">-</span> begin <span style="color: #000040;">+</span> <span style="color: #0000dd;">1</span>;
string strSheetName <span style="color: #000080;">=</span> str.<span style="color: #000000;">Mid</span><span style="color: #000000;">&#40;</span>begin, nLength<span style="color: #000000;">&#41;</span>; 
out_str<span style="color: #000000;">&#40;</span>strSheetName<span style="color: #000000;">&#41;</span>;<span style="color: #008000;">// Should output &quot;Sheet1&quot;</span></pre>
<h2><a name="Replace_Sub_String"></a><span class="mw-headline">Replace Sub String</span></h2>
<p><span class="OIndex" style="display:none">String, Replace</span>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Find and replace one character</span>
string str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;A+B+C+&quot;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #0000ff;">int</span> nCount <span style="color: #000080;">=</span> str.<span style="color: #000000;">Replace</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">'+'</span>,<span style="color: #ff00ff;">'-'</span><span style="color: #000000;">&#41;</span>;
out_int<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;&quot;</span>, nCount<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// nCount will be 3</span>
out_str<span style="color: #000000;">&#40;</span>str<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// &quot;A-B-C-&quot; </span>

<span style="color: #008000;">// Find and replace a character string</span>
str <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;I am a student.<span style="color: #666666; font-weight: bold;">\n</span>I am a girl.&quot;</span>;
nCount <span style="color: #000080;">=</span> str.<span style="color: #000000;">Replace</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;I am&quot;</span>, <span style="color: #ff00ff;">&quot;You are&quot;</span><span style="color: #000000;">&#41;</span>;
out_int<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;&quot;</span>, nCount<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// nCount will be 2</span>
out_str<span style="color: #000000;">&#40;</span>str<span style="color: #000000;">&#41;</span>;</pre>
<h2><a name="Path_String_Functions"></a><span class="mw-headline">Path String Functions</span></h2>
<h3><a name="File_Path_StringString.2C_Check_Path_StringString.2C_Extract_File_Name_from_Full_Path"></a><span class="mw-headline">File Path String<span class="OIndex" style="display:none">String, Check Path String</span><span class="OIndex" style="display:none">String, Extract File Name from Full Path</span></span></h3>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// string::IsFile is used to check the file if exist</span>
string strFile <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;D:<span style="color: #666666; font-weight: bold;">\\</span>TestFolder<span style="color: #666666; font-weight: bold;">\\</span>abc.txt&quot;</span>;
<span style="color: #0000ff;">bool</span> bb <span style="color: #000080;">=</span> strFile.<span style="color: #000000;">IsFile</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; 
<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;The file&#160;%s is&#160;%sexist.<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, strFile, bb&#160;? <span style="color: #ff00ff;">&quot;&quot;</span> <span style="color: #000000;">:</span> <span style="color: #ff00ff;">&quot;NOT &quot;</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// GetFilePath function is used to extract the path from a full path string</span>
string strPath <span style="color: #000080;">=</span> GetFilePath<span style="color: #000000;">&#40;</span>strFile<span style="color: #000000;">&#41;</span>;	
out_str<span style="color: #000000;">&#40;</span>strPath<span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// GetFileName function is used to extracts the file name part </span>
<span style="color: #008000;">// from a string of full path</span>
<span style="color: #0000ff;">bool</span> bRemoveExtension <span style="color: #000080;">=</span> <span style="color: #0000ff;">true</span>;
string strFileName <span style="color: #000080;">=</span> GetFileName<span style="color: #000000;">&#40;</span>strFile, bRemoveExtension<span style="color: #000000;">&#41;</span>;
out_str<span style="color: #000000;">&#40;</span>strFileName<span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// string::IsPath to check if the path is exist	</span>
bb <span style="color: #000080;">=</span> strPath.<span style="color: #000000;">IsPath</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
out_int<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;&quot;</span>, bb<span style="color: #000000;">&#41;</span>;</pre>
<h3><a name="Origin_System_PathString.2C_Origin_System_FolderString.2C_User_File_FolderUser_File_Folder"></a><span class="mw-headline"><span class="OIndex">Origin System Path</span><span class="OIndex" style="display:none">String, Origin System Folder</span><span class="OIndex" style="display:none">String, User File Folder</span><span class="OIndex" style="display:none">User File Folder</span></span></h3>
<pre class="oc" style="font-family:monospace;">string strSysPath <span style="color: #000080;">=</span> GetOriginPath<span style="color: #000000;">&#40;</span>ORIGIN_PATH_SYSTEM<span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Origin System Path:&#160;%s<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, strSysPath<span style="color: #000000;">&#41;</span>;

string strUserPath <span style="color: #000080;">=</span> GetOriginPath<span style="color: #000000;">&#40;</span>ORIGIN_PATH_USER<span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;User File Path:&#160;%s<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, strUserPath<span style="color: #000000;">&#41;</span>;</pre>






