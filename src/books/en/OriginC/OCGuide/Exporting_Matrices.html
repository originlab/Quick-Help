<h1 class="firstHeading">1.11.3 Exporting Matrices</h1><p>An Origin Matrix can be exported to an ASCII data file or an image file.
</p>
<h2><a name="Export_Matrix_to_ASCII_Data_FileExport_Data_from_Matrix_to_ASCII_File"></a><span class="mw-headline">Export Matrix to ASCII Data File<span class="OIndex" style="display:none">Export Data from Matrix to ASCII File</span></span></h2>
<p>The following example shows how to export ASCII data from the active matrix window to a *.txt file. You need to add <i>#include &lt;oExtFile.h&gt;</i> for the <b><a href="../../OriginC/OriginC/Export_matrix_ascii_data_(global_function).html" title="OriginC:Export matrix ascii data (global function)">export_matrix_ascii_data</a></b> function. 
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">file</span>     ff;
<span style="color: #0000ff;">if</span> <span style="color: #000000;">&#40;</span> <span style="color: #000040;">!</span>ff.<span style="color: #000000;">Open</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;C:<span style="color: #666666; font-weight: bold;">\\</span>ExpMatData.txt&quot;</span>, <span style="color: #0000ff;">file</span><span style="color: #000000;">::</span><span style="color: #000000;">modeCreate</span><span style="color: #000040;">|</span><span style="color: #0000ff;">file</span><span style="color: #000000;">::</span><span style="color: #000000;">modeWrite</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
    <span style="color: #0000ff;">return</span>; <span style="color: #008000;">//fail to open file for write        </span>

string 		strRange;
MatrixLayer ml <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
ml.<span style="color: #000000;">GetRangeString</span><span style="color: #000000;">&#40;</span>strRange<span style="color: #000000;">&#41;</span>;

LPCSTR     		lpcszSep <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;<span style="color: #666666; font-weight: bold;">\t</span>&quot;</span>;
vector<span style="color: #000080;">&lt;</span>string<span style="color: #000080;">&gt;</span> 	vXLabels, vYLabels; <span style="color: #008000;">// empty means no label</span>
DWORD     		dwCntrl <span style="color: #000080;">=</span> GDAT_FULL_PRECISION <span style="color: #000040;">|</span> GDAT_MISSING_AS_DASHDASH;

<span style="color: #008000;">// return 0 for no error</span>
<span style="color: #0000ff;">int</span> nErr <span style="color: #000080;">=</span> export_matrix_ascii_data<span style="color: #000000;">&#40;</span><span style="color: #000040;">&amp;</span>ff, strRange, ml.<span style="color: #000000;">GetNumRows</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>,
        ml.<span style="color: #000000;">GetNumCols</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>, lpcszSep, <span style="color: #000040;">&amp;</span>vXLabels, <span style="color: #000040;">&amp;</span>vYLabels, dwCntrl<span style="color: #000000;">&#41;</span>;</pre>
<h2><a name="Export_Image_from_Matrix_to_Image_File"></a><span class="mw-headline"><span class="OIndex">Export Image from Matrix to Image File</span></span></h2>
<p>The following example shows how to export a matrix to an image file. 
</p><p>Prior to running the following example, the image_utils.c file need to be loaded and compiled. This can be done from script with the following command or just add this file to your workspace.
</p>
<pre class="oc" style="font-family:monospace;">run.<span style="color: #000000;">LoadOC</span><span style="color: #000000;">&#40;</span>Originlab\image_utils.<span style="color: #000000;">c</span><span style="color: #000000;">&#41;</span>;</pre>
<p>And need to add <i>#include &lt;image_utils.h&gt;</i> for the <b><a href="../../OriginC/OriginC/Export_Matrix_to_image_(global_function).html" title="OriginC:Export Matrix to image (global function)">export_Matrix_to_image</a></b> function.
</p>
<pre class="oc" style="font-family:monospace;">MatrixLayer ml <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
MatrixObject mo <span style="color: #000080;">=</span> ml.<span style="color: #000000;">MatrixObjects</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
export_Matrix_to_image<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;c:<span style="color: #666666; font-weight: bold;">\\</span>matrixImg.jpg&quot;</span>, <span style="color: #ff00ff;">&quot;jpg&quot;</span>, mo<span style="color: #000000;">&#41;</span>;</pre>






