<h1 class="firstHeading">1.12.3.3 Multiple Regression</h1><p>Origin uses the <b><a href="../../OriginC/OriginC/Ocmath_multiple_linear_regression_(global_function).html" title="OriginC:Ocmath multiple linear regression (global function)">ocmath_multiple_linear_regression</a></b> function to perform multiple linear regression. This function allows to specify the weight of data and linear regression options. After running this function successfully, output details will include fitting parameters, regression statistics, ANOVA statistics, covariance and correlation matrix of estimate, and etc.
</p><p>In the following sections, we will learn how to perform multiple linear regression by using this function.
</p>
<h2><a name="Perform_Multiple_Linear_Regression"></a><span class="mw-headline">Perform <span class="OIndex">Multiple Linear Regression</span></span></h2>
<p>To perform multiple linear regression, please import the desired data, here will use three independents and one dependent.
</p><p>1. Load data for multiple linear regression. All the independent data should be stored in a matrix, and dependent data in a vector.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// 1. get data for multiple linear regression</span>
Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #000040;">!</span>wks <span style="color: #000000;">&#41;</span>
    <span style="color: #0000ff;">return</span>; <span style="color: #008000;">// please make sure a worksheet with data is active </span>

DataRange dr;
dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;X&quot;</span>, wks, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">0</span>, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// first three columns</span>
dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Y&quot;</span>, wks, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">3</span>, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// the fourth column</span>

matrix mX;  
dr.<span style="color: #000000;">GetData</span><span style="color: #000000;">&#40;</span>mX, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// get data of first three columns to matrix</span>

vector vY;
dr.<span style="color: #000000;">GetData</span><span style="color: #000000;">&#40;</span><span style="color: #000040;">&amp;</span>vY, <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// get data of the fourth column</span></pre>
<p>2. Declare and initialize the parameters that will be passed to the function.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// 2. prepare input and output variables</span>
UINT nOSizeN <span style="color: #000080;">=</span> mX.<span style="color: #000000;">GetNumRows</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// number of observations</span>
UINT nVSizeM <span style="color: #000080;">=</span> mX.<span style="color: #000000;">GetNumCols</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// total number of independent variables</span>

LROptions stLROptions;  <span style="color: #008000;">// use to set linear regression options</span>
stLROptions.<span style="color: #000000;">UseReducedChiSq</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;

FitParameter stFitParameters<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">4</span><span style="color: #000000;">&#93;</span>; <span style="color: #008000;">// should be nVSizeM+1</span>
UINT nFitSize <span style="color: #000080;">=</span> nVSizeM<span style="color: #000040;">+</span><span style="color: #0000dd;">1</span>;  <span style="color: #008000;">// size of FitParameter</span>

RegStats stRegStats;  <span style="color: #008000;">// use to get regression statistics</span>
RegANOVA stRegANOV;  <span style="color: #008000;">// use to get anova statistics</span></pre>
<p>3. Pass the prepared parameters to the function and perform multiple linear regression.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// 3. perform multiple linear regression, here we are not going to get </span>
<span style="color: #008000;">// the covariance and correlation matrix of estimate, and no weight is used.</span>
<span style="color: #0000ff;">int</span> nRet <span style="color: #000080;">=</span> ocmath_multiple_linear_regression<span style="color: #000000;">&#40;</span>mX, nOSizeN, nVSizeM, vY, <span style="color: #0000ff;">NULL</span>, 
		<span style="color: #0000dd;">0</span>, <span style="color: #000040;">&amp;</span>stLROptions, stFitParameters, nFitSize, <span style="color: #000040;">&amp;</span>stRegStats, <span style="color: #000040;">&amp;</span>stRegANOV<span style="color: #000000;">&#41;</span>;
            
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> nRet <span style="color: #000040;">!</span><span style="color: #000080;">=</span> STATS_NO_ERROR <span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>   
    out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Error&quot;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">return</span>;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Output_the_Results"></a><span class="mw-headline">Output the Results</span></h2>
<p>After finishing the calculation, the results may need to output to somewhere for presentation, such as Script Window, Result Log, Worksheet, etc.
</p><p>Please refer to the <b><a href="../../OriginC/OCGuide/Linear_Fitting.html#Result_to_Output_Window" title="OCGuide:Linear Fitting">Result to Output Window</a></b> and <b><a href="../../OriginC/OCGuide/Linear_Fitting.html#Result_to_Worksheet" title="OCGuide:Linear Fitting">Result to Worksheet</a></b> section in the chapter <b><a href="../../OriginC/OCGuide/Linear_Fitting.html" title="OCGuide:Linear Fitting">Analysis and Applications: Curve Fitting: Linear Fitting</a></b> for more details about how to output the results.
</p>





