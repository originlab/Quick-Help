<h1 class="firstHeading">1.7.5 Creating and Accessing Graphical Objects</h1><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Creating_Graphical_ObjectGraph_Object.2C_Create"><span class="tocnumber">1</span> <span class="toctext">Creating Graphical Object<span class="OIndex" style="display:none">Graph Object, Create</span></span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Setting_PropertiesGraph_Object.2C_General_Properties"><span class="tocnumber">2</span> <span class="toctext">Setting Properties<span class="OIndex" style="display:none">Graph Object, General Properties</span></span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Setting_Position_and_SizeGraph_Object.2C_ResizeGraph_Object.2C_Position"><span class="tocnumber">3</span> <span class="toctext">Setting Position and Size<span class="OIndex" style="display:none">Graph Object, Resize</span><span class="OIndex" style="display:none">Graph Object, Position</span></span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Updating_Attach_PropertyGraph_Object.2C_Attach_Property"><span class="tocnumber">4</span> <span class="toctext">Updating Attach Property<span class="OIndex" style="display:none">Graph Object, Attach Property</span></span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Getting_and_Setting_Disable_PropertyGraph_Object.2C_Disable_Moving_and_Selection"><span class="tocnumber">5</span> <span class="toctext">Getting and Setting Disable Property<span class="OIndex" style="display:none">Graph Object, Disable Moving and Selection</span></span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Programming_ControlGraph_Object.2C_Programming_Control"><span class="tocnumber">6</span> <span class="toctext">Programming Control<span class="OIndex" style="display:none">Graph Object, Programming Control</span></span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Updating_LegendLegend_UpdateGraph_Layer.2C_Legend"><span class="tocnumber">7</span> <span class="toctext">Updating Legend<span class="OIndex" style="display:none">Legend Update</span><span class="OIndex" style="display:none">Graph Layer, Legend</span></span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Adding_Table_Object_on_GraphGraph_Layer.2C_Add_Worksheet_Table"><span class="tocnumber">8</span> <span class="toctext">Adding Table Object on Graph<span class="OIndex" style="display:none">Graph Layer, Add Worksheet Table</span></span></a></li>
</ul>
</div>

<h2><a name="Creating_Graphical_ObjectGraph_Object.2C_Create"></a><span class="mw-headline">Creating Graphical Object<span class="OIndex" style="display:none">Graph Object, Create</span></span></h2>
<p>Add a Graphical Object, for example: text, or a rectangle or line.
</p><p><span class="OIndex" style="display:none">Graph Object, Add Rectangle</span><span class="OIndex" style="display:none">Graph Object, Add Text Label</span>The following example shows how to add a rectangle to the active graph. For other Graph object types see GROT_* (for example: GROT_TEXT, GROT_LINE, GROT_POLYGON) in the oc_const.h file.
</p>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
string strName <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;MyRect&quot;</span>;
GraphObject goRect <span style="color: #000080;">=</span> gl.<span style="color: #000000;">CreateGraphObject</span><span style="color: #000000;">&#40;</span>GROT_RECT, strName<span style="color: #000000;">&#41;</span>;</pre>
<p>Add a text label on the current graph window:
</p>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
GraphObject go <span style="color: #000080;">=</span> gl.<span style="color: #000000;">CreateGraphObject</span><span style="color: #000000;">&#40;</span>GROT_TEXT, <span style="color: #ff00ff;">&quot;MyText&quot;</span><span style="color: #000000;">&#41;</span>;		
go.<span style="color: #000000;">Text</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;This is a test&quot;</span>;</pre>
<p><span class="OIndex" style="display:none">Graph Object, Add Line</span><span class="OIndex" style="display:none">Graph Object, Set Line Position</span>The example below shows how to add an arrow to a graph. The object type of an arrow is GROT_LINE, the same type as a line. And for both lines and arrows, the number of data points required is 2.
</p>
<pre class="oc" style="font-family:monospace;">GraphPage gp;
gp.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
GraphLayer gl <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;

string strName <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;MyArrow&quot;</span>; <span style="color: #008000;">// the name of the graph object</span>
GraphObject go <span style="color: #000080;">=</span> gl.<span style="color: #000000;">CreateGraphObject</span><span style="color: #000000;">&#40;</span>GROT_LINE, strName<span style="color: #000000;">&#41;</span>;

go.<span style="color: #000000;">Attach</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>; <span style="color: #008000;">// change attach mode to Layer and Scale</span>

Tree tr;		
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimension</span>.<span style="color: #000000;">Units</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>; <span style="color: #008000;">// Set unit as Scale</span>

<span style="color: #008000;">// Set position by scale value</span>
vector vx <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">2</span>, <span style="color: #0000dd;">6</span><span style="color: #000000;">&#125;</span>;
vector vy <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">6</span>, <span style="color: #0000dd;">2</span><span style="color: #000000;">&#125;</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Data</span>.<span style="color: #000000;">X</span>.<span style="color: #000000;">dVals</span> <span style="color: #000080;">=</span> vx;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Data</span>.<span style="color: #000000;">Y</span>.<span style="color: #000000;">dVals</span> <span style="color: #000080;">=</span> vy;	

tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Arrow</span>.<span style="color: #000000;">Begin</span>.<span style="color: #000000;">Style</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Arrow</span>.<span style="color: #000000;">End</span>.<span style="color: #000000;">Style</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;

<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> go.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">&#40;</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	go.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">&#40;</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<p><span class="OIndex" style="display:none">Graph Object, Add Curve Arrow</span>The example below shows how to add a curved arrow to a graph. For a curved arrow, the number of data points required is 4.
</p>
<pre class="oc" style="font-family:monospace;">GraphPage gp;
gp.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
GraphLayer gl <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;

string strName <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;MyArrow&quot;</span>; <span style="color: #008000;">// the name of the graph object</span>
GraphObject go <span style="color: #000080;">=</span> gl.<span style="color: #000000;">CreateGraphObject</span><span style="color: #000000;">&#40;</span>GROT_LINE4, strName<span style="color: #000000;">&#41;</span>;

go.<span style="color: #000000;">Attach</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>; <span style="color: #008000;">// change attach mode to Layer and Scale</span>

Tree tr;		
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimension</span>.<span style="color: #000000;">Units</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>; <span style="color: #008000;">// Set unit as Scale</span>

<span style="color: #008000;">// Set position by scale value</span>
vector vx <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">2</span>, <span style="color: #0000dd;">4</span>, <span style="color: #0000dd;">6</span>, <span style="color: #0000dd;">5</span><span style="color: #000000;">&#125;</span>;
vector vy <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">7</span>, <span style="color: #0000dd;">6.9</span>, <span style="color: #0000dd;">6.8</span>, <span style="color: #0000dd;">2</span><span style="color: #000000;">&#125;</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Data</span>.<span style="color: #000000;">X</span>.<span style="color: #000000;">dVals</span> <span style="color: #000080;">=</span> vx;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Data</span>.<span style="color: #000000;">Y</span>.<span style="color: #000000;">dVals</span> <span style="color: #000080;">=</span> vy;	

tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Arrow</span>.<span style="color: #000000;">Begin</span>.<span style="color: #000000;">Style</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Arrow</span>.<span style="color: #000000;">End</span>.<span style="color: #000000;">Style</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;

<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> go.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">&#40;</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	go.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">&#40;</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Setting_PropertiesGraph_Object.2C_General_Properties"></a><span class="mw-headline">Setting Properties<span class="OIndex" style="display:none">Graph Object, General Properties</span></span></h2>
<p>Set Properties for a Graphical Object, for example, text font, color, line width.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Set color and font for graph object	</span>
GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
GraphObject goText <span style="color: #000080;">=</span> gl.<span style="color: #000000;">GraphObjects</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Text&quot;</span><span style="color: #000000;">&#41;</span>;
goText.<span style="color: #000000;">Text</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;This is a test&quot;</span>;
goText.<span style="color: #000000;">Attach</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>; <span style="color: #008000;">// Attach to layer scale	</span>

Tree tr;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Color</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> SYSCOLOR_RED; <span style="color: #008000;">// the color of text</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Font</span>.<span style="color: #000000;">Bold</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; 
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Font</span>.<span style="color: #000000;">Italic</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Font</span>.<span style="color: #000000;">Underline</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Font</span>.<span style="color: #000000;">Size</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">30</span>; <span style="color: #008000;">// font size of text</span>

<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> goText.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">&#40;</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	<span style="color: #0000ff;">bool</span> bRet <span style="color: #000080;">=</span> goText.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">&#40;</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Setting_Position_and_SizeGraph_Object.2C_ResizeGraph_Object.2C_Position"></a><span class="mw-headline">Setting Position and Size<span class="OIndex" style="display:none">Graph Object, Resize</span><span class="OIndex" style="display:none">Graph Object, Position</span></span></h2>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
GraphObject go <span style="color: #000080;">=</span> gl.<span style="color: #000000;">GraphObjects</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Rect&quot;</span><span style="color: #000000;">&#41;</span>;
go.<span style="color: #000000;">Attach</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>; <span style="color: #008000;">// Attach to layer scale	</span>

<span style="color: #008000;">// Move text object to the layer left top</span>
Tree tr;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimension</span>.<span style="color: #000000;">Units</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> UNITS_SCALE;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimension</span>.<span style="color: #000000;">Left</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> gl.<span style="color: #000000;">X</span>.<span style="color: #000000;">From</span>; <span style="color: #008000;">// Left</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimension</span>.<span style="color: #000000;">Top</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> gl.<span style="color: #000000;">Y</span>.<span style="color: #000000;">To</span><span style="color: #000040;">/</span><span style="color: #0000dd;">2</span>; <span style="color: #008000;">// Top</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimension</span>.<span style="color: #000000;">Width</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> <span style="color: #000000;">&#40;</span>gl.<span style="color: #000000;">X</span>.<span style="color: #000000;">To</span> <span style="color: #000040;">-</span> gl.<span style="color: #000000;">X</span>.<span style="color: #000000;">From</span><span style="color: #000000;">&#41;</span><span style="color: #000040;">/</span><span style="color: #0000dd;">2</span>; <span style="color: #008000;">// Width</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimension</span>.<span style="color: #000000;">Height</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> <span style="color: #000000;">&#40;</span>gl.<span style="color: #000000;">Y</span>.<span style="color: #000000;">To</span> <span style="color: #000040;">-</span> gl.<span style="color: #000000;">Y</span>.<span style="color: #000000;">From</span><span style="color: #000000;">&#41;</span><span style="color: #000040;">/</span><span style="color: #0000dd;">2</span>; <span style="color: #008000;">// Height</span>

<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> go.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">&#40;</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	<span style="color: #0000ff;">bool</span> bRet <span style="color: #000080;">=</span> go.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">&#40;</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Updating_Attach_PropertyGraph_Object.2C_Attach_Property"></a><span class="mw-headline">Updating Attach Property<span class="OIndex" style="display:none">Graph Object, Attach Property</span></span></h2>
<p>The attach property has 3 choices, Page, Layer Frame, and Layer Scale.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Attach graph object to the different object:</span>
<span style="color: #008000;">// 0 for layer, when move layer, graph object will be moved together;</span>
<span style="color: #008000;">// 1 for page, when move layer, not effect on graph object;</span>
<span style="color: #008000;">// 2 for layer scale, when change the scale, the position of graph object</span>
<span style="color: #008000;">// will be changed according.</span>
go.<span style="color: #000000;">Attach</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;</pre>
<h2><a name="Getting_and_Setting_Disable_PropertyGraph_Object.2C_Disable_Moving_and_Selection"></a><span class="mw-headline">Getting and Setting Disable Property<span class="OIndex" style="display:none">Graph Object, Disable Moving and Selection</span></span></h2>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// To check disable properties, for example, movable, selectable.</span>
Tree tr;
tr <span style="color: #000080;">=</span> go.<span style="color: #000000;">GetFormat</span><span style="color: #000000;">&#40;</span>FPB_OTHER, FOB_ALL, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;
DWORD 	dwStats <span style="color: #000080;">=</span> tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">States</span>.<span style="color: #000000;">nVal</span>;

<span style="color: #008000;">// To check vertical and horizontal movement.</span>
<span style="color: #008000;">// More property bits, see GOC_* in oc_const.h file.</span>
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #000000;">&#40;</span>dwStats <span style="color: #000040;">&amp;</span> GOC_NO_VMOVE<span style="color: #000000;">&#41;</span> <span style="color: #000040;">&amp;&amp;</span> <span style="color: #000000;">&#40;</span>dwStats <span style="color: #000040;">&amp;</span> GOC_NO_HMOVE<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;This graph object cannot be move&quot;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Programming_ControlGraph_Object.2C_Programming_Control"></a><span class="mw-headline">Programming Control<span class="OIndex" style="display:none">Graph Object, Programming Control</span></span></h2>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// 1. Add a line</span>
GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
GraphObject go <span style="color: #000080;">=</span> gl.<span style="color: #000000;">CreateGraphObject</span><span style="color: #000000;">&#40;</span>GROT_LINE<span style="color: #000000;">&#41;</span>;
go.<span style="color: #000000;">Attach</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>; <span style="color: #008000;">// Set attach mode to layer scale</span>
go.<span style="color: #000000;">X</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>; <span style="color: #008000;">// Set init position to X = 5</span>

<span style="color: #008000;">// 2. Set line properties</span>
Tree tr;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Direction</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>; <span style="color: #008000;">// 1 for Horizontal, 2 for vertical</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Span</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; <span style="color: #008000;">// Span to layer </span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Color</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> SYSCOLOR_RED; <span style="color: #008000;">// Line color</span>

<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> go.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">&#40;</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>	
<span style="color: #000000;">&#123;</span>
	go.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">&#40;</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span>

<span style="color: #008000;">// 3. Set event mode and LT script. </span>
<span style="color: #008000;">// Move line will print out line position, x scale value.</span>
Tree trEvent;
trEvent.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Event</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> GRCT_MOVE;<span style="color: #008000;">// More other bits, see GRCT_* in oc_const.h</span>
trEvent.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Script</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;type -a $(this.X)&quot;</span>;

<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> go.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">&#40;</span>trEvent.<span style="color: #000000;">Root</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>	
<span style="color: #000000;">&#123;</span>
	go.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">&#40;</span>trEvent, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Updating_LegendLegend_UpdateGraph_Layer.2C_Legend"></a><span class="mw-headline">Updating Legend<span class="OIndex" style="display:none">Legend Update</span><span class="OIndex" style="display:none">Graph Layer, Legend</span></span></h2>
<p>A legend is a graphical object named "Legend" on a graph window. After adding/removing data plots, we can use the <b><a href="../../OriginC/OriginC/Legend_update_(global_function).html" title="OriginC:Legend update (global function)">legend_update</a></b> function to refresh the legend according to the current data plots.
</p>
<pre class="oc" style="font-family:monospace;"> 
<span style="color: #008000;">// Simple usage here, just used to refresh legend. </span>
<span style="color: #008000;">// Search this function in OriginC help to see the description of other arguments </span>
<span style="color: #008000;">// for more usages.</span>
legend_update<span style="color: #000000;">&#40;</span>gl<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// gl is a GraphLayer object</span></pre>
<h2><a name="Adding_Table_Object_on_GraphGraph_Layer.2C_Add_Worksheet_Table"></a><span class="mw-headline">Adding Table Object on Graph<span class="OIndex" style="display:none">Graph Layer, Add Worksheet Table</span></span></h2>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// 1. Create the worksheet with Table template</span>
Worksheet wks;
wks.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Table&quot;</span>, CREATE_HIDDEN<span style="color: #000000;">&#41;</span>; 
WorksheetPage wksPage <span style="color: #000080;">=</span> wks.<span style="color: #000000;">GetPage</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// 2. Set table size and fill in text</span>
wks.<span style="color: #000000;">SetSize</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span>, <span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>;
wks.<span style="color: #000000;">SetCell</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">0</span>, <span style="color: #ff00ff;">&quot;1&quot;</span><span style="color: #000000;">&#41;</span>;
wks.<span style="color: #000000;">SetCell</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">1</span>, <span style="color: #ff00ff;">&quot;Layer 1&quot;</span><span style="color: #000000;">&#41;</span>;

wks.<span style="color: #000000;">SetCell</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">0</span>, <span style="color: #ff00ff;">&quot;2&quot;</span><span style="color: #000000;">&#41;</span>;
wks.<span style="color: #000000;">SetCell</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">1</span>, <span style="color: #ff00ff;">&quot;Layer 2&quot;</span><span style="color: #000000;">&#41;</span>;

wks.<span style="color: #000000;">SetCell</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span>, <span style="color: #0000dd;">0</span>, <span style="color: #ff00ff;">&quot;3&quot;</span><span style="color: #000000;">&#41;</span>;
wks.<span style="color: #000000;">SetCell</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span>, <span style="color: #0000dd;">1</span>, <span style="color: #ff00ff;">&quot;Layer 3&quot;</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">//3. Add table as link to graph</span>
GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;	
GraphObject grTable <span style="color: #000080;">=</span> gl.<span style="color: #000000;">CreateLinkTable</span><span style="color: #000000;">&#40;</span>wksPage.<span style="color: #000000;">GetName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>, wks<span style="color: #000000;">&#41;</span>;</pre>






