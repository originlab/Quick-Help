<h1 class="firstHeading">1.7.4 Managing Layers</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Creating_a_Panel_Plot"><span class="tocnumber">1</span> <span class="toctext">Creating a Panel Plot</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Creating_a_6_Panel_GraphGraph_Page.2C_Layer_Arrangement"><span class="tocnumber">1.1</span> <span class="toctext">Creating a 6 Panel Graph<span class="OIndex" style="display:none">Graph Page, Layer Arrangement</span></span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Creating_and_Plotting_into_a_6_Panel_GraphGraph_Page.2C_Plotting_Separated_Data_in_Multiple_Layers"><span class="tocnumber">1.2</span> <span class="toctext">Creating and Plotting into a 6 Panel Graph<span class="OIndex" style="display:none">Graph Page, Plotting Separated Data in Multiple Layers</span></span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4"><a href="#Adding_Layers_to_a_Graph_WindowGraph_Page.2C_Add_Layer"><span class="tocnumber">2</span> <span class="toctext">Adding Layers to a Graph Window<span class="OIndex" style="display:none">Graph Page, Add Layer</span></span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Hiding_Layers_Except_Active_One"><span class="tocnumber">3</span> <span class="toctext">Hiding Layers Except Active One</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Arranging_the_LayersGraph_Page.2C_Layer_Arrangement"><span class="tocnumber">4</span> <span class="toctext">Arranging the Layers<span class="OIndex" style="display:none">Graph Page, Layer Arrangement</span></span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Moving_a_LayerGraph_Page.2C_Move_Layer"><span class="tocnumber">5</span> <span class="toctext">Moving a Layer<span class="OIndex" style="display:none">Graph Page, Move Layer</span></span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Resizing_a_LayerGraph_Page.2C_Resize_Layer"><span class="tocnumber">6</span> <span class="toctext">Resizing a Layer<span class="OIndex" style="display:none">Graph Page, Resize Layer</span></span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Swap_two_LayersGraph_Page.2C_Swap_Layers"><span class="tocnumber">7</span> <span class="toctext">Swap two Layers<span class="OIndex" style="display:none">Graph Page, Swap Layers</span></span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#Aligning_LayersLayer.2C_Alignment"><span class="tocnumber">8</span> <span class="toctext">Aligning Layers<span class="OIndex" style="display:none">Layer, Alignment</span></span></a></li>
<li class="toclevel-1 tocsection-11"><a href="#Linking_LayersGraph_Page.2C_Linking_Layers"><span class="tocnumber">9</span> <span class="toctext">Linking Layers<span class="OIndex" style="display:none">Graph Page, Linking Layers</span></span></a></li>
<li class="toclevel-1 tocsection-12"><a href="#Setting_Layer_UnitGraph_Layer.2C_Dimension"><span class="tocnumber">10</span> <span class="toctext">Setting Layer Unit<span class="OIndex" style="display:none">Graph Layer, Dimension</span></span></a></li>
</ul>
</div>

<h2><a name="Creating_a_Panel_Plot"></a><span class="mw-headline">Creating a Panel Plot</span></h2>
<h3><a name="Creating_a_6_Panel_GraphGraph_Page.2C_Layer_Arrangement"></a><span class="mw-headline">Creating a 6 Panel Graph<span class="OIndex" style="display:none">Graph Page, Layer Arrangement</span></span></h3>
<p>The following example will create a new graph window with 6 layers, arranged as 2 columns and 3 rows.  This function can be run independent of what window is active.  
</p>
<pre class="oc" style="font-family:monospace;">GraphPage gp;
gp.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Origin&quot;</span><span style="color: #000000;">&#41;</span>;

<span style="color: #0000ff;">while</span><span style="color: #000000;">&#40;</span>gp.<span style="color: #000000;">Layers</span>.<span style="color: #000000;">Count</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">&lt;</span> <span style="color: #0000dd;">6</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	gp.<span style="color: #000000;">AddLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span>

graph_arrange_layers<span style="color: #000000;">&#40;</span>gp, <span style="color: #0000dd;">3</span>, <span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>;</pre>
<h3><a name="Creating_and_Plotting_into_a_6_Panel_GraphGraph_Page.2C_Plotting_Separated_Data_in_Multiple_Layers"></a><span class="mw-headline">Creating and Plotting into a 6 Panel Graph<span class="OIndex" style="display:none">Graph Page, Plotting Separated Data in Multiple Layers</span></span></h3>
<p>The following example will import some data into a new workbook, create a new graph window with 6 layers, arranged as 2 columns and 3 rows, and loop through each layer (panel), plotting the imported data.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Import data file to worksheet</span>
ASCIMP  	ai;
Worksheet 	wks;
string	strDataFile <span style="color: #000080;">=</span> GetOpenBox<span style="color: #000000;">&#40;</span>FDLOG_ASCII, GetAppPath<span style="color: #000000;">&#40;</span><span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>AscImpReadFileStruct<span style="color: #000000;">&#40;</span>strDataFile,<span style="color: #000040;">&amp;</span>ai<span style="color: #000000;">&#41;</span> <span style="color: #000080;">==</span> <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>		
	wks.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Origin&quot;</span><span style="color: #000000;">&#41;</span>;
	wks.<span style="color: #000000;">ImportASCII</span><span style="color: #000000;">&#40;</span>strDataFile, ai<span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span>

<span style="color: #008000;">// Add XY data from worksheet to graph each layers</span>
GraphPage gp<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Graph1&quot;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// the graph has the 3x2 panel layers created above</span>
<span style="color: #0000ff;">int</span> index <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
foreach<span style="color: #000000;">&#40;</span>GraphLayer gl in gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	DataRange dr;
	dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">0</span>, <span style="color: #ff00ff;">&quot;X&quot;</span><span style="color: #000000;">&#41;</span>;
	dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>wks, index<span style="color: #000040;">+</span><span style="color: #0000dd;">1</span>, <span style="color: #ff00ff;">&quot;Y&quot;</span><span style="color: #000000;">&#41;</span>;
	
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> gl.<span style="color: #000000;">AddPlot</span><span style="color: #000000;">&#40;</span>dr, IDM_PLOT_LINE<span style="color: #000000;">&#41;</span> <span style="color: #000080;">&gt;=</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">&#41;</span>
		gl.<span style="color: #000000;">Rescale</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	
	index<span style="color: #000040;">++</span>;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Adding_Layers_to_a_Graph_WindowGraph_Page.2C_Add_Layer"></a><span class="mw-headline">Adding Layers to a Graph Window<span class="OIndex" style="display:none">Graph Page, Add Layer</span></span></h2>
<p>The following example will add an independent right Y axis scale.  A new layer is added, displaying only the right Y axis.  It is linked in dimension and the X axis is linked to the current active layer at the time the layer is added.  The new added layer becomes the active layer.
</p><p>Before compiling the following codes, you need to add graph_utils.c to your current workspace. Run Labtalk command "Run.LoadOC(Originlab\graph_utils.c)" to do this.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>..\Originlab\graph_utils.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span><span style="color: #008000;">// Needed for page_add_layer function</span>

GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
GraphPage gp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">GetPage</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;

<span style="color: #0000ff;">bool</span> bBottom <span style="color: #000080;">=</span> <span style="color: #0000ff;">false</span>, bLeft <span style="color: #000080;">=</span> <span style="color: #0000ff;">false</span>, bTop <span style="color: #000080;">=</span> <span style="color: #0000ff;">false</span>, bRight <span style="color: #000080;">=</span> <span style="color: #0000ff;">true</span>;
<span style="color: #0000ff;">int</span> nLinkTo <span style="color: #000080;">=</span> gl.<span style="color: #000000;">GetIndex</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// New added layer link to the active layer</span>
<span style="color: #0000ff;">bool</span> bActivateNewLayer <span style="color: #000080;">=</span> <span style="color: #0000ff;">true</span>;

<span style="color: #0000ff;">int</span>	nLayerIndex <span style="color: #000080;">=</span> page_add_layer<span style="color: #000000;">&#40;</span>gp, bBottom, bLeft, bTop, bRight, 
ADD_LAYER_INIT_SIZE_POS_SAME_AS_PREVIOUS, bActivateNewLayer, nLinkTo<span style="color: #000000;">&#41;</span>;</pre>
<h2><a name="Hiding_Layers_Except_Active_One"></a><span class="mw-headline">Hiding Layers Except Active One</span></h2>
<pre class="oc" style="font-family:monospace;">GraphPage gp<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Graph1&quot;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> gp <span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	GraphLayer glActive <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// -1 to get active layer</span>
	
	foreach<span style="color: #000000;">&#40;</span>GraphLayer gl in gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> gl.<span style="color: #000000;">GetIndex</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000040;">!</span><span style="color: #000080;">=</span> glActive.<span style="color: #000000;">GetIndex</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
			gl.<span style="color: #000000;">Show</span><span style="color: #000000;">&#40;</span><span style="color: #0000ff;">false</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Arranging_the_LayersGraph_Page.2C_Layer_Arrangement"></a><span class="mw-headline">Arranging the Layers<span class="OIndex" style="display:none">Graph Page, Layer Arrangement</span></span></h2>
<p>The following example will arrange the existing layers on the active graph into two rows by three columns.  If the active graph does not already have 6 layers, it will not add any new layers.  It arranges only the layers that exist.  
</p>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
GraphPage gp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">GetPage</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;

<span style="color: #0000ff;">int</span> nRows <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>, nCols <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
graph_arrange_layers<span style="color: #000000;">&#40;</span>gp, nRows, nCols<span style="color: #000000;">&#41;</span>;</pre>
<h2><a name="Moving_a_LayerGraph_Page.2C_Move_Layer"></a><span class="mw-headline">Moving a Layer<span class="OIndex" style="display:none">Graph Page, Move Layer</span></span></h2>
<p>The following example will left align all layers in the active graph window, setting their position to be 15% from the left-hand side of the page.
</p>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
GraphPage gp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">GetPage</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;

<span style="color: #0000ff;">int</span> nRows <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span>.<span style="color: #000000;">Count</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #0000ff;">int</span> nCols <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;

stLayersGridFormat stFormat;
stFormat.<span style="color: #000000;">nXGap</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; <span style="color: #008000;">// the X direction gap of layers</span>
stFormat.<span style="color: #000000;">nYGap</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>; <span style="color: #008000;">// the Y direction gap of layers</span>
stFormat.<span style="color: #000000;">nLeftMg</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">15</span>; <span style="color: #008000;">// left margin</span>
stFormat.<span style="color: #000000;">nRightMg</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span>;
stFormat.<span style="color: #000000;">nTopMg</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span>;	
stFormat.<span style="color: #000000;">nBottomMg</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span>;

page_arrange_layers<span style="color: #000000;">&#40;</span>gp, nRows, nCols, <span style="color: #000040;">&amp;</span>stFormat<span style="color: #000000;">&#41;</span>;</pre>
<h2><a name="Resizing_a_LayerGraph_Page.2C_Resize_Layer"></a><span class="mw-headline">Resizing a Layer<span class="OIndex" style="display:none">Graph Page, Resize Layer</span></span></h2>
<p>The following example will resize the current layer to reduce the width and height to half of the original size.
</p><p>Before compiling the following codes, you need to add graph_utils.c to your current workspace. Run Labtalk command "Run.LoadOC(Originlab\graph_utils.c)" to do this.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>..\Originlab\graph_utils.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span> <span style="color: #008000;">// Needed for layer_set_size function</span>
GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// get the original size of graph layer</span>
<span style="color: #0000ff;">double</span> dWidth, dHeight;
layer_get_size<span style="color: #000000;">&#40;</span>gl, dWidth, dHeight<span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// resize layer</span>
dWidth <span style="color: #000040;">/</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
dHeight <span style="color: #000040;">/</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
layer_set_size<span style="color: #000000;">&#40;</span>gl, dWidth, dHeight<span style="color: #000000;">&#41;</span>;</pre>
<h2><a name="Swap_two_LayersGraph_Page.2C_Swap_Layers"></a><span class="mw-headline">Swap two Layers<span class="OIndex" style="display:none">Graph Page, Swap Layers</span></span></h2>
<p>The following example will swap the position on the page of layers indexed 1 and 2.
</p><p>Before compiling the following codes, you need to add graph_utils.c to your current workspace. Run Labtalk command "Run.LoadOC(Originlab\graph_utils.c)" to do this.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>..\Originlab\graph_utils.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span> <span style="color: #008000;">// Needed for layer_swap_position function</span>
GraphPage gp<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Graph1&quot;</span><span style="color: #000000;">&#41;</span>;
GraphLayer gl1 <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
GraphLayer gl2 <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;

layer_swap_position<span style="color: #000000;">&#40;</span>gl1, gl2<span style="color: #000000;">&#41;</span>;</pre>
<p>The following example will swap the position on the page of layers named Layer1 and Layer2.
</p>
<pre class="oc" style="font-family:monospace;">GraphPage gp<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Graph1&quot;</span><span style="color: #000000;">&#41;</span>;
GraphLayer gl1 <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Layer1&quot;</span><span style="color: #000000;">&#41;</span>;
GraphLayer gl2 <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Layer2&quot;</span><span style="color: #000000;">&#41;</span>;

layer_swap_position<span style="color: #000000;">&#40;</span>gl1, gl2<span style="color: #000000;">&#41;</span>;</pre>
<h2><a name="Aligning_LayersLayer.2C_Alignment"></a><span class="mw-headline">Aligning Layers<span class="OIndex" style="display:none">Layer, Alignment</span></span></h2>
<p>The following example will bottom align layer 2 with layer 1 in the active graph window.
</p><p>Before compiling the following codes, you need to add graph_utils.c to your current workspace. Run Labtalk command "Run.LoadOC(Originlab\graph_utils.c)" to do this.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>..\Originlab\graph_utils.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span> <span style="color: #008000;">// Needed for layer_aligns function</span>
<span style="color: #008000;">// Get the active graph page</span>
GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
GraphPage gp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">GetPage</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;

GraphLayer gl1 <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
GraphLayer gl2 <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Bottom align layer 2 with layer 1</span>
layer_aligns<span style="color: #000000;">&#40;</span>gl1, gl2, POS_BOTTOM<span style="color: #000000;">&#41;</span>;</pre>
<h2><a name="Linking_LayersGraph_Page.2C_Linking_Layers"></a><span class="mw-headline">Linking Layers<span class="OIndex" style="display:none">Graph Page, Linking Layers</span></span></h2>
<p>The following example will link all X axes in all layers in the active graph to the X axis of layer 1.  The Units will be set to a&#160;% of Linked Layer.
</p><p>Before compiling the following codes, you need to add graph_utils.c to your current workspace. Run Labtalk command "Run.LoadOC(Originlab\graph_utils.c)" to do this.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>..\Originlab\graph_utils.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span> <span style="color: #008000;">// Needed for layer_set_link function</span>
GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
GraphPage gp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">GetPage</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
GraphLayer gl1 <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Layer 1</span>

foreach<span style="color: #000000;">&#40;</span>GraphLayer glOne in gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	<span style="color: #0000ff;">int</span> nUnit <span style="color: #000080;">=</span> M_LINK; <span style="color: #008000;">// Set layer unit as&#160;% of linked layer</span>
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> glOne <span style="color: #000040;">!</span><span style="color: #000080;">=</span> gl1 <span style="color: #000000;">&#41;</span>
		layer_set_link<span style="color: #000000;">&#40;</span>glOne, gl1.<span style="color: #000000;">GetIndex</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>, LINK_STRAIGHT, LINK_NONE, <span style="color: #000040;">&amp;</span>nUnit<span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Setting_Layer_UnitGraph_Layer.2C_Dimension"></a><span class="mw-headline">Setting Layer Unit<span class="OIndex" style="display:none">Graph Layer, Dimension</span></span></h2>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">int</span> nUnit <span style="color: #000080;">=</span> M_PIXEL;
GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Get the current position</span>
<span style="color: #0000ff;">double</span> dPos<span style="color: #000000;">&#91;</span>TOTAL_POS<span style="color: #000000;">&#93;</span>;
gl.<span style="color: #000000;">GetPosition</span><span style="color: #000000;">&#40;</span>dPos<span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Convert position to the specified unit</span>
gl.<span style="color: #000000;">UnitsConvert</span><span style="color: #000000;">&#40;</span>nUnit, dPos<span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Set position with unit</span>
gl.<span style="color: #000000;">SetPosition</span><span style="color: #000000;">&#40;</span>dPos, nUnit<span style="color: #000000;">&#41;</span>;</pre>






