<h1 class="firstHeading">1.4.2 Compiling, Linking and Loading</h1><p><br />
Before you can access your Origin C functions, you will need to compile and link them (a process known as building) using <a href="../../OriginC/OCGuide/Create_and_Edit_an_Origin_C_File.html#Overview" title="OCGuide:Create and Edit an Origin C File">Code Builder</a>. 
</p><p>Once your functions compile and link without error, they are loaded automatically, and you will be able to access them from the current Origin session. To access your functions in future sessions of Origin you will need to ensure that they are reloaded and linked; a process that is fast and can be automated. 
</p><p>This chapter covers the manual and automated build process for Origin C source files and preprocessed files.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Compiling_and_LinkingCompile_and_Link_Source_Files"><span class="tocnumber">1</span> <span class="toctext">Compiling and Linking<span class="OIndex" style="display:none">Compile and Link Source Files</span></span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Add_the_File_to_the_WorkspaceWorkspace.2C_Load_Files"><span class="tocnumber">1.1</span> <span class="toctext">Add the File to the Workspace<span class="OIndex" style="display:none">Workspace, Load Files</span></span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Compile_the_File"><span class="tocnumber">1.2</span> <span class="toctext">Compile the File</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Build_the_Workspace"><span class="tocnumber">1.3</span> <span class="toctext">Build the Workspace</span></a>
<ul>
<li class="toclevel-3 tocsection-5"><a href="#Build_vs._Build_All"><span class="tocnumber">1.3.1</span> <span class="toctext">Build vs. Build All</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Automated_Building"><span class="tocnumber">2</span> <span class="toctext">Automated Building</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#Add_files_to_the_Project_FolderBuilding_Origin_C_File_with_Project"><span class="tocnumber">2.1</span> <span class="toctext">Add files to the Project Folder<span class="OIndex" style="display:none">Building Origin C File with Project</span></span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Add_files_to_the_User_.5BAutoLoad.5D_FolderBuilding_Origin_C_Files_under_Workspace_System_Folder"><span class="tocnumber">2.2</span> <span class="toctext">Add files to the User [AutoLoad] Folder<span class="OIndex" style="display:none">Building Origin C Files under Workspace System Folder</span></span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Build_Workspace_on_Origin_StartupBuilding_on_Startup"><span class="tocnumber">2.3</span> <span class="toctext">Build Workspace on Origin Startup<span class="OIndex" style="display:none">Building on Startup</span></span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Build_Individual_Source_File_on_Origin_Startup"><span class="tocnumber">2.4</span> <span class="toctext">Build Individual Source File on Origin Startup</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-11"><a href="#Building_by_ScriptBuilding_with_Dependent_Files"><span class="tocnumber">3</span> <span class="toctext"><span class="OIndex">Building by Script</span><span class="OIndex" style="display:none">Building with Dependent Files</span></span></a></li>
<li class="toclevel-1 tocsection-12"><a href="#Identifying_ErrorsBuilding.2C_Handle_Compiling_and_Linking_Error"><span class="tocnumber">4</span> <span class="toctext">Identifying Errors<span class="OIndex" style="display:none">Building, Handle Compiling and Linking Error</span></span></a></li>
</ul>
</div>

<h2><a name="Compiling_and_LinkingCompile_and_Link_Source_Files"></a><span class="mw-headline">Compiling and Linking<span class="OIndex" style="display:none">Compile and Link Source Files</span></span></h2>
<p>In order to make the functions defined in an Origin C source file or preprocessed file executable for the first time, the following steps are necessary:
</p>
<ul><li> Add the file to the Code Builder workspace</li>
<li> Compile the file</li>
<li> Link the file to all dependents, compiling dependents where necessary, and load the object files that are created.</li></ul>
<p>The act of compiling and linking all the files is referred to as building.
</p>
<h3><a name="Add_the_File_to_the_WorkspaceWorkspace.2C_Load_Files"></a><span class="mw-headline">Add the File to the Workspace<span class="OIndex" style="display:none">Workspace, Load Files</span></span></h3>
<p>Before a source file or preprocessed file can be compiled and linked, the file must be added to one of the <b>Code Builder</b> workspace folders: <a href="../../OriginC/OCGuide/Create_and_Edit_an_Origin_C_File.html#Code_Builder_Folder_Structure" title="OCGuide:Create and Edit an Origin C File">Project, User, System, or Temporary</a>.  Note that all source files are initially created or loaded into the User folder.
</p>
<h3><a name="Compile_the_File"></a><span class="mw-headline">Compile the File</span></h3>
<p>After adding the file to the workspace, it needs to be compiled (by clicking the <b>Compile <a  class="image"><img alt="Compile button.png" src="../images/Compiling,_Linking_and_Loading/Compile_button.png?v=16998" width="24"  /></a></b> button) to generate the object file, which will have the same name as the source/preprocessed file, but with the <b>OCB</b> file extension. In Origin versions 8.1 and later, the object file will be saved in the <b>Application Data</b> folder. In older versions the file was saved to the  <b>User&#160;Files\OCTemp</b> folder.
</p>
<h3><a name="Build_the_Workspace"></a><span class="mw-headline">Build the Workspace</span></h3>
<p>To build the active file and all its dependents, select the <b>Build</b> <a  class="image"><img alt="Build Button.png" src="../images/Compiling,_Linking_and_Loading/Build_Button.png?v=9379" width="24"  /></a> button, or select the <b>Rebuild All</b> <a  class="image"><img alt="Rebuild All button.png" src="../images/Compiling,_Linking_and_Loading/Rebuild_All_button.png?v=22497" width="22"  /></a> button to build all files in the workspace. The object file that is created will be automatically loaded into memory and linked so that the functions defined in the file are executable within Origin.
</p><p>Once the object file is generated, subsequent build processes will be much faster. If there are no changes to the built source/preprocessed file, <b>Code Builder</b> will load and link the object file directly, but not rebuild the file. 
</p>
<h4><a name="Build_vs._Build_All"></a><span class="mw-headline">Build vs. Build All</span></h4>
<p><b>Build</b>: All of the files in a given folder are compiled and linked when that folder is the active window in the Code Builder (or a dependent of the active window) and the Build toolbar button <a  class="image"><img alt="Button Build.png" src="../images/Compiling,_Linking_and_Loading/Button_Build.png?v=25125" width="22"  /></a> is clicked.
</p><p><b>Build All</b>: files in <i><b>all</b></i> Code Builder folders are compiled and linked when the Code Builder Rebuild All toolbar button <a  class="image"><img alt="Button Rebuild All.png" src="../images/Compiling,_Linking_and_Loading/Button_Rebuild_All.png?v=25127" width="22"  /></a> is clicked.
</p>
<h2><a name="Automated_Building"></a><span class="mw-headline">Automated Building</span></h2>
<p>Initially, all Origin C source or preprocessed files are created or opened in the User folder, and the discussion above gives details for manually building Origin C source files.  Many times, however, it is advantageous to automate the build process. This can be done by making use of Code Builder's folder structure, each with slightly different functionality, or by utilizing the <b>Build on Startup</b> option:
</p>
<h3><a name="Add_files_to_the_Project_FolderBuilding_Origin_C_File_with_Project"></a><span class="mw-headline">Add files to the Project Folder<span class="OIndex" style="display:none">Building Origin C File with Project</span></span></h3>
<p>When you add files to Code Builder's <b>Project folder</b>, they will be built automatically each time the associated Origin project is opened.
</p><p>You can add files to the <b>Project</b> folder using the following methods:
</p>
<ul><li> Right-click on the Project folder and choose <b>Add files</b>.</li>
<li> Drag a file from another Workspace folder and drop it on the Project folder.</li></ul>
<h3><a name="Add_files_to_the_User_.5BAutoLoad.5D_FolderBuilding_Origin_C_Files_under_Workspace_System_Folder"></a><span class="mw-headline">Add files to the User [AutoLoad] Folder<span class="OIndex" style="display:none">Building Origin C Files under Workspace System Folder</span></span></h3>
<p>Formerly, you could right-click on the <b>System</b> folder in Code Builder and <b>Add Files</b>. Since Origin 2015, you are prevented from adding user files to this folder. When you want your files to be compiled and linked automatically on Origin startup, you should add these files to the <b>User [Autoload]</b> folder. 
</p><p>You can add files to the <b>User [AutoLoad]</b> folder using the following methods:
</p>
<ul><li> Right-click on the User [AutoLoad] folder (in Code Builder) and choose <b>Add files</b>.</li>
<li> Drag a file from another Workspace folder and drop it on the User [AutoLoad] folder.</li>
<li> Using the <a class="external text" href="../../LabTalk/LabTalk/Run_(object).html#Methods:"><b>run.LoadOC()</b> object</a>.</li></ul>
<p><br />
</p>
<table class="note">

<tr>
<td><b>Note:</b> When you add files to the <b>User [AutoLoad]</b> folder, a section called <b>[OriginCAuto]</b> is added to the Origin.ini file in your <a class="external text" href="../../UserGuide/UserGuide/The_User_Files_Folder.html">User Files Folder</a>. To simultaneously remove files from <b>User [AutoLoad]</b> and remove the added <b>[OriginCAuto]</b> from your Origin.ini, run <a class="external text" href="../../LabTalk/LabTalk/Run_(command).html#-cra.3B_Remove_Temp_and_User_files_from_Code_Builder_Workspace">this LabTalk command</a>:
<pre class="lt" style="font-family:monospace;">run <span style="color: #000080;">-</span>cra <span style="color: #008000;">// does not affect System folder files</span></pre>
</td></tr></table>
<h3><a name="Build_Workspace_on_Origin_StartupBuilding_on_Startup"></a><span class="mw-headline">Build Workspace on Origin Startup<span class="OIndex" style="display:none">Building on Startup</span></span></h3>
<p>The <b>Build on Startup</b> option will build the most recently opened Code Builder workspace upon Origin startup. 
</p><p>When Origin starts it will examine the contents of the Origin C Workspace <b>System</b> folder and if it finds any changed files then it will try to compile and link them.  You also can have this procedure done to the files in the <b>User</b> folder by enabling the <b>Build on Startup</b> option.
</p>
<ol><li> Run Code Builder</li>
<li> If the Workspace view is not visible then choose <b>Workspace</b> on the <b>View</b> menu.</li>
<li> Right-click on <b>Origin C Workspace</b>.</li>
<li> If the <b>Build on Startup</b> item is not checked then click it.</li></ol>
<p>The next time you start Origin it will check the files in the User folder and try to compile and link any changed files.
</p>
<h3><a name="Build_Individual_Source_File_on_Origin_Startup"></a><span class="mw-headline">Build Individual Source File on Origin Startup</span></h3>
<p>The following steps show how to modify the Origin.ini to load and compile Origin C source files on startup.
</p>
<ol><li> Make sure Origin is not running. Open the Origin.ini file in your User Files Folder(type "%Y="&lt;Enter&gt; in the Script or Command window to locate your User File Folder). </li>
<li> In the <b>[Config]</b> section, uncomment (remove the leading ";") OgsN = OEvents. N here can be any unique number. Save and close this file.</li>
<li> Open OEvents.ogs under the Origin installation folder. Find the <b>[AfterCompileSystem]</b> section and add the following line as a new line <pre class="lt" style="font-family:monospace;">run.<span style="color: #000080;">LoadOC</span><span style="color: #000000;">&#40;</span>Originlab\AscImpOptions, <span style="color: #0000dd;">16</span><span style="color: #000000;">&#41;</span>;</pre> Save OEvents.ogs to your User Files Folder (same location as the Origin.ini file that you edited) and close your editor.</li>
<li> Restart Origin and open Code Builder. In the Temporary folder, there are 3 files. AscImpOptions depends on fu_utils.c and Import_utils.c, so the compiler compiles AscImp, along with the two files. For more details please search <b>run.LoadOC</b> in your Labtalk documentation.</li></ol>
<p><br />
Alternately, use the <i><b>User [AutoLoad] </b></i> folder in your Workspace. Files added in the folder will be automatically loaded on Origin startup (<a href="#Add_files_to_the_User_.5BAutoLoad.5D_FolderBuilding_Origin_C_Files_under_Workspace_System_Folder">see above</a>).
</p>
<h2><a name="Building_by_ScriptBuilding_with_Dependent_Files"></a><span class="mw-headline"><span class="OIndex">Building by Script</span><span class="OIndex" style="display:none">Building with Dependent Files</span></span></h2>
<p>When you want to call an Origin C function in LabTalk script, you need to make sure the source file has been compiled and linking is done. You can then use the LabTalk command <i>Run.LoadOC</i> to compile and link the specific source file. For example:
</p>
<ol><li>Choose File-&gt;New Workspace... to create a new workspace.  The Temporary folder should be empty now. </li>
<li>Run the following script in the Command Window... the <i>dragNdrop.c</i> file together with its dependent files all are loaded into the Temporary folder and compiled.
<pre class="lt" style="font-family:monospace;">if<span style="color: #000000;">&#40;</span>run.<span style="color: #000080;">LoadOC</span><span style="color: #000000;">&#40;</span>OriginLab\dragNdrop.<span style="color: #000080;">c</span>, <span style="color: #0000dd;">16</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">!</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
        type <span style="color: #ff00ff;">&quot;Failed to load dragNdrop.c!&quot;</span>;
        return <span style="color: #0000dd;">0</span>;
<span style="color: #000000;">&#125;</span></pre></li>
</ol>
<h2><a name="Identifying_ErrorsBuilding.2C_Handle_Compiling_and_Linking_Error"></a><span class="mw-headline">Identifying Errors<span class="OIndex" style="display:none">Building, Handle Compiling and Linking Error</span></span></h2>
<p>When you compile and link source files in Code Builder, the compiling and linking results are displayed in the Code Builder <b>Output</b> window.
</p><p>If the compiling and linking was successful, the <b>Output</b> window lists the source files that were compiled.  The <b>Done</b>! line indicates success. 
</p><p>If errors were encountered during the compiling and linking process, the <b>Output</b> window lists the file name, line number, and the error encountered.  You can double-click on the error line in the <b>Output</b> window to activate the source file and position the cursor on the line of code containing the error.<br />
</p><p><a  class="image"><img alt="Compiling originc.png" src="../images/Compiling,_Linking_and_Loading/Compiling_originc.png?v=44789" width="463"  /></a>
</p>





