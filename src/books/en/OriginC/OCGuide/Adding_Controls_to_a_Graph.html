<h1 class="firstHeading">1.18.4 Adding Controls to a Graph</h1><p><span class="OIndex" style="display:none">Graph Page, Attach a User Defined Dialog to It</span>
If you want to attach a dialog to a page, similar to a workbook's organizer or the top of a polar graph, then the <b>SetSplitters</b> method of the <b><a href="../../OriginC/Category/PageBase_(class).html" title="Category:PageBase (class)">PageBase</a></b> class can be used to accomplish this.
</p><p>To add a dialog bar to a page, <b>lpcszString</b> needs to include the dialog class name and the position (Left, Right, Top or Bottom) of the page window. Set <b>lpcszString</b> as NULL to remove the existing dialog bar.
</p><p>The following example shows how to add and remove user-created dialog on a Graph window. 
</p><p>The class of the user-defined dialog:
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>..\Originlab\DialogEx.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span>
<span style="color: #008000;">// OC_REGISTERED key word must allow the PageBase::SetSplitters method </span>
<span style="color: #008000;">// to find this class.</span>
<span style="color: #0000ff;">class</span> OC_REGISTERED MyGraphPolarBar <span style="color: #000000;">:</span> <span style="color: #0000ff;">public</span> Dialog
<span style="color: #000000;">&#123;</span>
<span style="color: #0000ff;">public</span><span style="color: #000000;">:</span>
	<span style="color: #008000;">// IDD_POLAR_CONTROL is dialog resource ID</span>
	<span style="color: #008000;">// Odlg8 is the name of dialog resource DLL file, if not specified path, </span>
	<span style="color: #008000;">//default path is \OriginC\Originlab.</span>
	MyGraphPolarBar<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">:</span>Dialog<span style="color: #000000;">&#40;</span>IDD_POLAR_CONTROL, <span style="color: #ff00ff;">&quot;Odlg8&quot;</span><span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
	<span style="color: #000000;">&#125;</span>	
	
	<span style="color: #0000ff;">BOOL</span> CreateWindow<span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> nID, HWND hWnd<span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>		
		<span style="color: #0000ff;">int</span> nRet <span style="color: #000080;">=</span> Dialog<span style="color: #000000;">::</span><span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span>hWnd, DLG_AS_CHILD<span style="color: #000000;">&#41;</span>;
		
		HWND hWndThis <span style="color: #000080;">=</span> GetSafeHwnd<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
		SetWindowLong<span style="color: #000000;">&#40;</span>hWndThis, GWL_ID, nID<span style="color: #000000;">&#41;</span>;
		<span style="color: #0000ff;">return</span> nRet;
	<span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span>;</pre>
<p>Add or remove dialog on a Graph window.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">void</span> Page_SplittersControl<span style="color: #000000;">&#40;</span><span style="color: #0000ff;">BOOL</span> bShow <span style="color: #000080;">=</span> <span style="color: #0000ff;">TRUE</span>, <span style="color: #0000ff;">int</span> nPos <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	Page pg <span style="color: #000080;">=</span> Project.<span style="color: #000000;">Pages</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Graph1&quot;</span><span style="color: #000000;">&#41;</span>;

	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> bShow <span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		<span style="color: #0000ff;">int</span> nPercent <span style="color: #000080;">=</span> <span style="color: #0000dd;">30</span>;
		string strDlgClass <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;MyGraphPolarBar&quot;</span>; <span style="color: #008000;">// the above dialog class</span>
		
		string	strConfig;
		<span style="color: #0000ff;">switch</span><span style="color: #000000;">&#40;</span>nPos<span style="color: #000000;">&#41;</span>
		<span style="color: #000000;">&#123;</span>
		<span style="color: #0000ff;">case</span> <span style="color: #0000dd;">0</span><span style="color: #000000;">:</span> <span style="color: #008000;">// Bottom</span>
			strConfig.<span style="color: #000000;">Format</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;r{%s}r[%s]&quot;</span>, <span style="color: #000000;">&#40;</span>string<span style="color: #000000;">&#41;</span>nPercent<span style="color: #000040;">+</span><span style="color: #ff00ff;">&quot;%&quot;</span>, strDlgClass<span style="color: #000000;">&#41;</span>;
			<span style="color: #0000ff;">break</span>;
		<span style="color: #0000ff;">case</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">:</span> <span style="color: #008000;">// Right</span>
			strConfig.<span style="color: #000000;">Format</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;c{%s}c[%s]&quot;</span>, <span style="color: #000000;">&#40;</span>string<span style="color: #000000;">&#41;</span>nPercent<span style="color: #000040;">+</span><span style="color: #ff00ff;">&quot;%&quot;</span>, strDlgClass<span style="color: #000000;">&#41;</span>;
			<span style="color: #0000ff;">break</span>;				
		<span style="color: #0000ff;">case</span> <span style="color: #0000dd;">2</span><span style="color: #000000;">:</span> <span style="color: #008000;">// Top</span>
			strConfig.<span style="color: #000000;">Format</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;r[%s]{%d}r&quot;</span>, strDlgClass, nPercent<span style="color: #000000;">&#41;</span>;
			<span style="color: #0000ff;">break</span>;
		<span style="color: #0000ff;">case</span> <span style="color: #0000dd;">3</span><span style="color: #000000;">:</span> <span style="color: #008000;">// Left</span>
			strConfig.<span style="color: #000000;">Format</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;c[%s]{%d}c&quot;</span>, strDlgClass, nPercent<span style="color: #000000;">&#41;</span>;
			<span style="color: #0000ff;">break</span>;
		<span style="color: #000000;">&#125;</span>				
		pg.<span style="color: #000000;">SetSplitters</span><span style="color: #000000;">&#40;</span>strConfig<span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">&#125;</span>
	<span style="color: #0000ff;">else</span>
		pg.<span style="color: #000000;">SetSplitters</span><span style="color: #000000;">&#40;</span><span style="color: #0000ff;">NULL</span><span style="color: #000000;">&#41;</span>;	<span style="color: #008000;">// remove dialog bar from page</span>
	
<span style="color: #000000;">&#125;</span></pre>






