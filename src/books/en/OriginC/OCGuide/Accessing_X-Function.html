<h1 class="firstHeading">1.16 Accessing X-Function</h1><p><span class="OIndex" style="display:none">Accessing X-Function</span>
Origin has many built-in <a class="external text" href="../../XFunction/Category/X-Functions.html">X-Functions</a>  for handling a variety of tasks.  X-Functions can be called from both LabTalk and Origin C.  This Section will show you how to call X-Functions from Origin C by using Origin C's XFBase class<span class="OIndex" style="display:none">XFBase Class</span>. This mechanism also can be used in calling one X-Function in another X-Function.
</p><p>The XFBase class is declared in the XFBase.h header file located in the Origin C System folder.  The XFBase.h header file is not included in the Origin.h header file so it has to be included separately in any Origin C file for the use of XFBase class.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>XFBase.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span></pre>
<h2><a name="Calling_the_impFile_X-Function_From_Origin_C"></a><span class="mw-headline">Calling the impFile X-Function From Origin C</span></h2>
<p>The procedure to use X-Functions in Origin C is as following:
</p>
<ol><li> Declare an object that is to be constructed from a specified X-Function</li>
<li> Assign arguments using the SetArg options from the X-Function object</li>
<li> Execute the X-Function using the Evaluate method of the X-Function object</li></ol>
<p>The following Origin C code defines a general function for importing files into Origin.  The function has two arguments: data file name and import filter file name. Additional arguments of the <a class="external text" href="../../XFunction/X-Function/ImpFile.html"><b>impFile</b></a> X-Function will use their default values.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">bool</span> call_impFile_XF<span style="color: #000000;">&#40;</span>LPCSTR lpcszDataFile, LPCSTR lpcszFilterFile<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    string strDataFile <span style="color: #000080;">=</span> lpcszDataFile;
    string strFilterFile <span style="color: #000080;">=</span> lpcszFilterFile;

    <span style="color: #008000;">// Create an instance of XFBase using the X-Function name.</span>
    XFBase xf<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;impFile&quot;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">if</span> <span style="color: #000000;">&#40;</span><span style="color: #000040;">!</span>xf<span style="color: #000000;">&#41;</span>
        <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span>;

    <span style="color: #008000;">// Set the 'fname' argument.</span>
    <span style="color: #0000ff;">if</span> <span style="color: #000000;">&#40;</span><span style="color: #000040;">!</span>xf.<span style="color: #000000;">SetArg</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;fname&quot;</span>, strDataFile<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>
        <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span>;

    <span style="color: #008000;">// Set the 'filtername' argument.</span>
    <span style="color: #0000ff;">if</span> <span style="color: #000000;">&#40;</span><span style="color: #000040;">!</span>xf.<span style="color: #000000;">SetArg</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;filtername&quot;</span>, strFilterFile<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>
        <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span>;

    <span style="color: #008000;">// Call XFBase's 'Evaluate' method to execute the X-Function</span>
    <span style="color: #0000ff;">if</span> <span style="color: #000000;">&#40;</span><span style="color: #000040;">!</span>xf.<span style="color: #000000;">Evaluate</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>
        <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span>;

    <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span>;
<span style="color: #000000;">&#125;</span></pre>
<p>The following Origin C code shows how to call the call_impFile_XF function defined above and use it to import an image file. 
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Import the Car bitmap located in Origin's Samples folder.</span>
string strImageFile <span style="color: #000080;">=</span> GetAppPath<span style="color: #000000;">&#40;</span><span style="color: #0000ff;">TRUE</span><span style="color: #000000;">&#41;</span> <span style="color: #000040;">+</span>
    <span style="color: #ff00ff;">&quot;Samples<span style="color: #666666; font-weight: bold;">\\</span>Image Processing and Analysis<span style="color: #666666; font-weight: bold;">\\</span>Car.bmp&quot;</span>;

<span style="color: #008000;">// Import the bitmap using the Image import filter.</span>
string strFilterFile <span style="color: #000080;">=</span> GetAppPath<span style="color: #000000;">&#40;</span><span style="color: #0000ff;">TRUE</span><span style="color: #000000;">&#41;</span> <span style="color: #000040;">+</span> <span style="color: #ff00ff;">&quot;Filters<span style="color: #666666; font-weight: bold;">\\</span>Image.oif&quot;</span>;

<span style="color: #008000;">// Call the function that will use the impFile X-Function.</span>
call_impFile_XF<span style="color: #000000;">&#40;</span>strImageFile, strFilterFile<span style="color: #000000;">&#41;</span>;</pre>
<table class="note">

<tr>
<td><b>Note:</b>
<ol><li>For more example on accessing X-Function, see <a href="../../OriginC/Category/Accessing_X-Functions.html" title="Category:Accessing X-Functions"><b>Help: Programming &gt; Origin C &gt; Examples &gt; Accessing X-Functions &gt; Accessing X-Function</b></a></li>
<li> For more information on X-Function, see <a class="external text" href="../../XFunction/Category/X-Functions.html"><b>Help: X-Functions</b></a></li></ol>
</td></tr></table>






