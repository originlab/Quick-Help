<h1 class="firstHeading">1.12.4 Signal Processing</h1><p><br />
<span class="OIndex" style="display:none">Signal Processing</span>Origin C provides a collection of global functions and NAG functions for signal processing, ranging from smoothing noisy data to <span class="OIndex">Fourier Transform</span><span class="OIndex HasShownIndex" style="display:none">FFT</span> (FFT), <span class="OIndex">Short-time FFT</span><span class="OIndex HasShownIndex" style="display:none">STFT</span>(STFT), <span class="OIndex">Convolution</span> and <span class="OIndex">Correlation</span>, <span class="OIndex">FFT Filtering</span>, and <span class="OIndex">Wavelet</span> analysis.
</p><p>The Origin C functions are under the Origin C help -&gt; Origin C Reference -&gt; Global Functions -&gt; Signal Processing category.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Smoothing"><span class="tocnumber">1</span> <span class="toctext"><span class="OIndex">Smoothing</span></span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#FFT"><span class="tocnumber">2</span> <span class="toctext">FFT</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#FFT_2"><span class="tocnumber">2.1</span> <span class="toctext">FFT</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Frequency_Spectrum"><span class="tocnumber">2.2</span> <span class="toctext">Frequency Spectrum</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#IFFT"><span class="tocnumber">2.3</span> <span class="toctext">IFFT</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#STFT"><span class="tocnumber">2.4</span> <span class="toctext">STFT</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-7"><a href="#FFT_Filtering"><span class="tocnumber">3</span> <span class="toctext">FFT Filtering</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Wavelet_Analysis"><span class="tocnumber">4</span> <span class="toctext">Wavelet Analysis</span></a></li>
</ul>
</div>

<h2><a name="Smoothing"></a><span class="mw-headline"><span class="OIndex">Smoothing</span></span></h2>
<p>The <b><a href="../../OriginC/OriginC/Ocmath_smooth_(global_function).html" title="OriginC:Ocmath smooth (global function)">ocmath_smooth</a></b> function support 3 methods: median filter, Savitzky-Golay smoothing and adjacent averaging smoothing.
</p>
<pre class="oc" style="font-family:monospace;">vector vSmooth; <span style="color: #008000;">// output</span>
vSmooth.<span style="color: #000000;">SetSize</span><span style="color: #000000;">&#40;</span>vSource.<span style="color: #000000;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">//do Savitzky-Golay smoothing, Left=Right=7, quadratic</span>
<span style="color: #0000ff;">int</span> nLeftpts <span style="color: #000080;">=</span> nRightpts <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;
<span style="color: #0000ff;">int</span> nPolydeg <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
<span style="color: #0000ff;">int</span> nRet <span style="color: #000080;">=</span> ocmath_smooth<span style="color: #000000;">&#40;</span>vSource.<span style="color: #000000;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>, vSource, vSmooth, nLeftpts, SMOOTH_SG, 
	EDGEPAD_NONE, nRightpts, nPolydeg<span style="color: #000000;">&#41;</span>;</pre>
<h2><a name="FFT"></a><span class="mw-headline">FFT</span></h2>
<p>Before using fft_* functions, you need to include fft_utils.h. 
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>fft_utils.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span></pre>
<h3><a name="FFT_2"></a><span class="mw-headline">FFT</span></h3>
<p><b><a href="../../OriginC/OriginC/Fft_real_(global_function).html" title="OriginC:Fft real (global function)">fft_real</a></b> performs a discrete Fourier transform(FFT_FORWARD) or inverse Fourier transform(FFT_BACKWARD). 
</p>
<pre class="oc" style="font-family:monospace;">fft_real<span style="color: #000000;">&#40;</span>vSig.<span style="color: #000000;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>, vSig, FFT_FORWARD<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// return 0 for no error</span></pre>
<h3><a name="Frequency_Spectrum"></a><span class="mw-headline">Frequency Spectrum</span></h3>
<p><b><a href="../../OriginC/OriginC/Fft_one_side_spectrum_(global_function).html" title="OriginC:Fft one side spectrum (global function)">fft_one_side_spectrum</a></b> is used to compute the one side spectrum of FFT Result.
</p>
<pre class="oc" style="font-family:monospace;">fft_one_side_spectrum<span style="color: #000000;">&#40;</span>vSig.<span style="color: #000000;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>, vSig<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// return 0 for no error</span></pre>
<h3><a name="IFFT"></a><span class="mw-headline">IFFT</span></h3>
<pre class="oc" style="font-family:monospace;">fft_real<span style="color: #000000;">&#40;</span>vSig.<span style="color: #000000;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>, vSig, FFT_BACKWARD<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// return 0 for no error</span></pre>
<h3><a name="STFT"></a><span class="mw-headline">STFT</span></h3>
<p>The <b><a href="../../OriginC/OriginC/Stft_real_(global_function).html" title="OriginC:Stft real (global function)">stft_real</a></b> function is used to perform a Short-Time-Fourier-Transform on 1d signal real data.
The <b><a href="../../OriginC/OriginC/Stft_complex_(global_function).html" title="OriginC:Stft complex (global function)">stft_complex</a></b> function is used to perform a Short-Time-Fourier-Transform on 1d signal complex data.
The following is an example for real data.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">int</span> nWinSize <span style="color: #000080;">=</span> <span style="color: #0000dd;">4</span>;
vector win<span style="color: #000000;">&#40;</span>nWinSize<span style="color: #000000;">&#41;</span>;
get_window_data<span style="color: #000000;">&#40;</span>RECTANGLE_WIN, nWinSize, win<span style="color: #000000;">&#41;</span>;

matrix stft;
<span style="color: #0000ff;">double</span> stime, sfreq;
vector sig <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">0</span><span style="color: #000000;">&#125;</span>;
stft_real<span style="color: #000000;">&#40;</span>sig, win, <span style="color: #0000dd;">0.1</span>, <span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">4</span>, stft, stime, sfreq<span style="color: #000000;">&#41;</span>;

<span style="color: #0000ff;">for</span> <span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; ii <span style="color: #000080;">&lt;</span> stft.<span style="color: #000000;">GetNumRows</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; ii<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    <span style="color: #0000ff;">for</span> <span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> jj <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; jj <span style="color: #000080;">&lt;</span> stft.<span style="color: #000000;">GetNumCols</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; jj<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span>
        <span style="color: #000000;">printf</span> <span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;%f<span style="color: #666666; font-weight: bold;">\t</span>&quot;</span>, stft<span style="color: #000000;">&#91;</span>ii<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#91;</span>jj<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #000000;">printf</span> <span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="FFT_Filtering"></a><span class="mw-headline">FFT Filtering</span></h2>
<p>Origin C supports multiple filter types for performing FFT Filtering, including: low pass, high pass, band pass, band block, threshold, and low pass parabolic. For example:
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">double</span> dFc <span style="color: #000080;">=</span> <span style="color: #0000dd;">6.5</span>;    
<span style="color: #0000ff;">int</span> iRet <span style="color: #000080;">=</span> fft_lowpass<span style="color: #000000;">&#40;</span>vecSignal, dFc, <span style="color: #000040;">&amp;</span>vecTime<span style="color: #000000;">&#41;</span>;</pre>
<h2><a name="Wavelet_Analysis"></a><span class="mw-headline">Wavelet Analysis</span></h2>
<p>In Origin C, you can call a NAG function to do Wavelet analysis. To see all wavelet functions, go to the Origin C Help -&gt; Origin C Reference -&gt; Global Function -&gt; NAG Functions -&gt; Accessing NAG Functions Category and Help -&gt; Wavelet category.
It is necessary to include the related header.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>..\OriginLab\wavelet_utils.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span></pre>
<p>The following is an example of a real type, one-dimensional, continuous wavelet transform.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">int</span> n <span style="color: #000080;">=</span> vX.<span style="color: #000000;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #0000ff;">int</span> ns <span style="color: #000080;">=</span> vScales.<span style="color: #000000;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
matrix mCoefs<span style="color: #000000;">&#40;</span>ns, n<span style="color: #000000;">&#41;</span>;

NagError fail;
nag_cwt_real<span style="color: #000000;">&#40;</span>Nag_Morlet, <span style="color: #0000dd;">5</span>, n, vX, ns, vScales, mCoefs, <span style="color: #000040;">&amp;</span>fail<span style="color: #000000;">&#41;</span>;</pre>






