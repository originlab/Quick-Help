<h1 class="firstHeading">1.10.3 Importing Videos</h1><p><span class="OIndex" style="display:none">Video</span><span class="OIndex" style="display:none">Import Video</span><span class="OIndex" style="display:none">Read Video</span><span class="OIndex" style="display:none">Extract Frame</span>
</p>
<h2><a name="Version_Info"></a><span class="mw-headline">Version Info</span></h2>
<p class="version" >Minimum Origin Version Required: Origin 93 SR0</p>
<p>Origin C provides the VideoReader class for reading a video file and importing frame(s) of video to matrix object(s). 
</p><p>To use the VideoReader class, the header file "VideoReader.h" needs to be included in your source code.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>..\OriginLab\VideoReader.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span></pre>
<p>With the VideoReader class you can open a video file and get the video's properties, such as frame count, frame rate (frame per second), current position, etc. It also provides methods for seeking frame, seeking time, and reading frame(s) into matrix object(s).
</p><p>The following example will create a new matrixbook, seek 10 frames into a video then load 100 frames into 100 matrix objects in the active matrixsheet by skipping every other frame.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>..\Originlab\VideoReader.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span>  <span style="color: #008000;">// Include the header file</span>
<span style="color: #0000ff;">void</span> Import_Video_Ex1<span style="color: #000000;">&#40;</span>string strFile <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;d:<span style="color: #666666; font-weight: bold;">\\</span>test.avi&quot;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span>
	MatrixLayer ml; 
	ml.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Origin&quot;</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// Create a matrixsheet for the frames</span>
	<span style="color: #0000ff;">char</span> str<span style="color: #000000;">&#91;</span>MAXLINE<span style="color: #000000;">&#93;</span>;
	VideoReader vr;  <span style="color: #008000;">// Declare a VideoReader</span>
	<span style="color: #000000;">strcpy</span><span style="color: #000000;">&#40;</span>str, strFile<span style="color: #000000;">&#41;</span>;
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span><span style="color: #000040;">!</span>vr.<span style="color: #000000;">Open</span><span style="color: #000000;">&#40;</span>str<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span>  <span style="color: #008000;">// Open the video file</span>
		out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Failed to open video file!&quot;</span><span style="color: #000000;">&#41;</span>;
		<span style="color: #0000ff;">return</span>;
	<span style="color: #000000;">&#125;</span>
	<span style="color: #008000;">// Get number of frames</span>
	<span style="color: #0000ff;">int</span> iFrameCount <span style="color: #000080;">=</span> <span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span><span style="color: #000000;">&#41;</span>vr.<span style="color: #000000;">GetFrameCount</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;%u frames<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>,iFrameCount<span style="color: #000000;">&#41;</span>;
	<span style="color: #008000;">// Starting frame</span>
	<span style="color: #0000ff;">int</span> iOffset <span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span>;
	<span style="color: #008000;">// Specify total frames to read</span>
	<span style="color: #0000ff;">int</span> iTotalFrames <span style="color: #000080;">=</span> <span style="color: #0000dd;">100</span>;
	<span style="color: #008000;">// Specify frames to skip between each read</span>
	<span style="color: #0000ff;">int</span> iSkip <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; <span style="color: #008000;">// Read every other frame</span>
	<span style="color: #0000ff;">bool</span> bRet <span style="color: #000080;">=</span> vr.<span style="color: #000000;">SeekFrame</span><span style="color: #000000;">&#40;</span>iOffset<span style="color: #000000;">&#41;</span>;
	vr.<span style="color: #000000;">ReadFrames</span><span style="color: #000000;">&#40;</span>ml, iTotalFrames, iSkip<span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// Read frames</span>
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>vr.<span style="color: #000000;">ReaderReady</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span>  
		vr.<span style="color: #000000;">Close</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// Close the video reader</span>
	<span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>
<p>In this example, time is used as the metric by which we seek and import with time skips..
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>..\Originlab\VideoReader.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span>  <span style="color: #008000;">// Include the header file</span>
<span style="color: #0000ff;">void</span> Import_Video_Ex2<span style="color: #000000;">&#40;</span>string strFile <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;d:<span style="color: #666666; font-weight: bold;">\\</span>test.avi&quot;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span>
	MatrixLayer ml; 
	ml.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Origin&quot;</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// Create a matrixsheet for the frames</span>
	<span style="color: #0000ff;">char</span> str<span style="color: #000000;">&#91;</span>MAXLINE<span style="color: #000000;">&#93;</span>;
	VideoReader vr;  <span style="color: #008000;">// Declare a VideoReader</span>
	<span style="color: #000000;">strcpy</span><span style="color: #000000;">&#40;</span>str, strFile<span style="color: #000000;">&#41;</span>;
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span><span style="color: #000040;">!</span>vr.<span style="color: #000000;">Open</span><span style="color: #000000;">&#40;</span>str<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span>  <span style="color: #008000;">// Open the video file</span>
		out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Failed to open video file!&quot;</span><span style="color: #000000;">&#41;</span>;
		<span style="color: #0000ff;">return</span>;
	<span style="color: #000000;">&#125;</span>
	<span style="color: #008000;">// Get number of frames</span>
	<span style="color: #0000ff;">int</span> iFrameCount <span style="color: #000080;">=</span> <span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span><span style="color: #000000;">&#41;</span>vr.<span style="color: #000000;">GetFrameCount</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #008000;">// Get frame rate</span>
	<span style="color: #0000ff;">double</span> dFPS <span style="color: #000080;">=</span> vr.<span style="color: #000000;">GetFPS</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #0000ff;">double</span> dRunningTime <span style="color: #000080;">=</span> iFrameCount <span style="color: #000040;">/</span> dFPS;
	<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;%u frames at&#160;%f fps with a running time of&#160;%f seconds<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>,
		iFrameCount, dFPS, dRunningTime<span style="color: #000000;">&#41;</span>;

	<span style="color: #008000;">// Setup for read</span>
	<span style="color: #0000ff;">double</span> dStartTime <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>; <span style="color: #008000;">// Begin reading at 5 seconds</span>
	<span style="color: #0000ff;">double</span> dSkipLength <span style="color: #000080;">=</span> <span style="color: #0000dd;">3.333</span>; <span style="color: #008000;">// Skip 3.333 seconds between reads</span>
	vr.<span style="color: #000000;">SeekFrame</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span><span style="color: #000000;">&#41;</span> dStartTime <span style="color: #000040;">*</span> dFPS<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Calculate frame start</span>
	<span style="color: #0000ff;">int</span> iSkip <span style="color: #000080;">=</span> <span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span><span style="color: #000000;">&#41;</span> dSkipLength <span style="color: #000040;">*</span> dFPS; <span style="color: #008000;">// Calculate frames to skip</span>
	<span style="color: #008000;">// Calculate number of frames to actually read</span>
	<span style="color: #0000ff;">int</span> iTotalFrames <span style="color: #000080;">=</span> <span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#40;</span> <span style="color: #000000;">&#40;</span>dRunningTime <span style="color: #000040;">-</span> dStartTime<span style="color: #000000;">&#41;</span> <span style="color: #000040;">*</span> dFPS<span style="color: #000000;">&#41;</span>
	<span style="color: #000040;">/</span> <span style="color: #000000;">&#40;</span>iSkip <span style="color: #000040;">+</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
	vr.<span style="color: #000000;">ReadFrames</span><span style="color: #000000;">&#40;</span>ml, iTotalFrames, iSkip<span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// Read frames</span>
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>vr.<span style="color: #000000;">ReaderReady</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span>  
		vr.<span style="color: #000000;">Close</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// Close the video reader</span>
	<span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>






