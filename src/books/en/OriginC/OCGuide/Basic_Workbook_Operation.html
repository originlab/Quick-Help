<h1 class="firstHeading">1.6.1.1 Basic Workbook Operation</h1><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Create_New_WorkbookWorkbook.2C_CreateMatrixbook.2C_CreateTemplateHidden_Page.2C_Create"><span class="tocnumber">1</span> <span class="toctext">Create New Workbook<span class="OIndex" style="display:none">Workbook, Create</span><span class="OIndex" style="display:none">Matrixbook, Create</span><span class="OIndex" style="display:none">Template</span><span class="OIndex" style="display:none">Hidden Page, Create</span></span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Open_Workbook"><span class="tocnumber">2</span> <span class="toctext">Open Workbook</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Access_Workbook"><span class="tocnumber">3</span> <span class="toctext">Access Workbook</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Save_Workbook"><span class="tocnumber">4</span> <span class="toctext">Save Workbook</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Show_or_Hide_Workbook"><span class="tocnumber">5</span> <span class="toctext">Show or Hide Workbook</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Activate_Workbook"><span class="tocnumber">6</span> <span class="toctext">Activate Workbook</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Delete_Workbook"><span class="tocnumber">7</span> <span class="toctext">Delete Workbook</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Clone.2FDuplicate_WorkbookPage_CloneClone_PagePage.2C_CloneDuplicate_Window"><span class="tocnumber">8</span> <span class="toctext">Clone/Duplicate Workbook<span class="OIndex" style="display:none">Page Clone</span><span class="OIndex" style="display:none">Clone Page</span><span class="OIndex" style="display:none">Page, Clone</span><span class="OIndex" style="display:none">Duplicate Window</span></span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Name_and_Label_Workbook"><span class="tocnumber">9</span> <span class="toctext">Name and Label Workbook</span></a></li>
</ul>
</div>

<h2><a name="Create_New_WorkbookWorkbook.2C_CreateMatrixbook.2C_CreateTemplateHidden_Page.2C_Create"></a><span class="mw-headline">Create New Workbook<span class="OIndex" style="display:none">Workbook, Create</span><span class="OIndex" style="display:none">Matrixbook, Create</span><span class="OIndex" style="display:none">Template</span><span class="OIndex" style="display:none">Hidden Page, Create</span></span></h2>
<p>The <a href="../../OriginC/OriginC/Page-Create.html" title="OriginC:Page-Create">Create</a> method is used for creating new workbooks. 
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// create a hidden workbook using the STAT template</span>
WorksheetPage wksPg;
wksPg.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;STAT&quot;</span>, CREATE_HIDDEN<span style="color: #000000;">&#41;</span>;</pre>
<h2><a name="Open_Workbook"></a><span class="mw-headline">Open Workbook</span></h2>
<p>If the workbook with data is saved (as extension of ogw), it can be opened by the <a href="../../OriginC/OriginC/Worksheet-Open.html" title="OriginC:Worksheet-Open">Open</a> method.
</p>
<pre class="oc" style="font-family:monospace;">Worksheet wks;  <span style="color: #008000;">// The Open method belongs to Worksheet</span>
string strOGW <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;D:<span style="color: #666666; font-weight: bold;">\\</span>Book1.ogw&quot;</span>;  <span style="color: #008000;">// Path of the workbook</span>
wks.<span style="color: #000000;">Open</span><span style="color: #000000;">&#40;</span>strOGW<span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// Open the workbook</span></pre>
<h2><a name="Access_Workbook"></a><span class="mw-headline">Access Workbook</span></h2>
<p>There are multiple ways to access an existing workbook. The <a href="../../OriginC/Category/Project_(class).html" title="Category:Project (class)">Project</a> class contains a collection of all the workbooks in the project. The following example shows how to loop through them.
</p>
<pre class="oc" style="font-family:monospace;">foreach<span style="color: #000000;">&#40;</span>WorksheetPage wksPg in Project.<span style="color: #000000;">WorksheetPages</span><span style="color: #000000;">&#41;</span>
    out_str<span style="color: #000000;">&#40;</span>wksPg.<span style="color: #000000;">GetName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// output workbook name</span></pre>
<p>You can also access a workbook by passing its index to the <a href="../../OriginC/OriginC/Collection-Item.html" title="OriginC:Collection-Item">Item</a> method of the <a href="../../OriginC/Category/Collection_(class).html" title="Category:Collection (class)">Collection</a> class.
</p>
<pre class="oc" style="font-family:monospace;">WorksheetPage wksPg;
wksPg <span style="color: #000080;">=</span> Project.<span style="color: #000000;">WorksheetPages</span>.<span style="color: #000000;">Item</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>wksPg<span style="color: #000000;">&#41;</span> <span style="color: #008000;">// if there is a 3rd workbook</span>
    out_str<span style="color: #000000;">&#40;</span>wksPg.<span style="color: #000000;">GetName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// output workbook name</span></pre>
<p>If the workbook name is known, this workbook can be accessed by passing its name to the class constructor.
</p>
<pre class="oc" style="font-family:monospace;">WorksheetPage wksPg<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Book1&quot;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>wksPg<span style="color: #000000;">&#41;</span> <span style="color: #008000;">// if there is a workbook named &quot;Book1&quot;</span>
    wksPg.<span style="color: #000000;">SetName</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;MyBook1&quot;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// rename the workbook</span></pre>
<h2><a name="Save_Workbook"></a><span class="mw-headline">Save Workbook</span></h2>
<p>Origin allows you to save a workbook with data to a file (*.ogw), or as a template without data (*.otw), and for the workbook with analysis, it is able to be saved as an analysis template (*.ogw). And methods <a href="../../OriginC/OriginC/PageBase-SaveToFile.html" title="OriginC:PageBase-SaveToFile">SaveToFile</a> and <a href="../../OriginC/OriginC/PageBase-SaveTemplate.html" title="OriginC:PageBase-SaveTemplate">SaveTemplate</a> are used for saving workbook as *.ogw and *.otw files respectively.
</p>
<pre class="oc" style="font-family:monospace;">WorksheetPage wksPg<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Book1&quot;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// Save workbook as OGW file</span>
<span style="color: #0000ff;">bool</span> bRet1 <span style="color: #000080;">=</span> wksPg.<span style="color: #000000;">SaveToFile</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;D:<span style="color: #666666; font-weight: bold;">\\</span>&quot;</span> <span style="color: #000040;">+</span> wksPg.<span style="color: #000000;">GetName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000040;">+</span> <span style="color: #ff00ff;">&quot;.ogw&quot;</span><span style="color: #000000;">&#41;</span>;  
<span style="color: #008000;">// Save workbook as OTW template</span>
<span style="color: #0000ff;">bool</span> bRet2 <span style="color: #000080;">=</span> wksPg.<span style="color: #000000;">SaveTemplate</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;D:<span style="color: #666666; font-weight: bold;">\\</span>&quot;</span> <span style="color: #000040;">+</span> wksPg.<span style="color: #000000;">GetName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000040;">+</span> <span style="color: #ff00ff;">&quot;.otw&quot;</span><span style="color: #000000;">&#41;</span>;</pre>
<h2><a name="Show_or_Hide_Workbook"></a><span class="mw-headline">Show or Hide Workbook</span></h2>
<p>The <a href="../../OriginC/Category/WorksheetPage_(class).html" title="Category:WorksheetPage (class)">WorksheetPage</a> class inherits the <a href="../../OriginC/OriginC/OriginObject-Show.html" title="OriginC:OriginObject-Show">Show</a> property from <a href="../../OriginC/Category/OriginObject_(class).html" title="Category:OriginObject (class)">OriginObject</a> class to show or hide itself.
</p>
<pre class="oc" style="font-family:monospace;">WorksheetPage wksPg<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Book1&quot;</span><span style="color: #000000;">&#41;</span>;
wksPg.<span style="color: #000000;">Show</span> <span style="color: #000080;">=</span> <span style="color: #0000ff;">false</span>;  <span style="color: #008000;">// Hide the workbook. If true, show the workbook</span></pre>
<h2><a name="Activate_Workbook"></a><span class="mw-headline">Activate Workbook</span></h2>
<p>To activate a workbook, the method <a href="../../OriginC/OriginC/PageBase-SetShow.html" title="OriginC:PageBase-SetShow">SetShow</a> can be used by passing parameter of value PAGE_ACTIVATE.
</p>
<pre class="oc" style="font-family:monospace;">WorksheetPage wksPg<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Book1&quot;</span><span style="color: #000000;">&#41;</span>;
wksPg.<span style="color: #000000;">SetShow</span><span style="color: #000000;">&#40;</span>PAGE_ACTIVATE<span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// Activate the workbook</span>
<span style="color: #008000;">// More operations can be done by passing different values, such as</span>
<span style="color: #008000;">// wksPg.SetShow(PAGE_HIDDEN);  // Hide the workbook</span>
<span style="color: #008000;">// wksPg.SetShow(PAGE_MINIMIZED);  // Minimize the workbook</span>
<span style="color: #008000;">// wksPg.SetShow(PAGE_MAXIMIZED);  // Maximize the workbook</span></pre>
<h2><a name="Delete_Workbook"></a><span class="mw-headline">Delete Workbook</span></h2>
<p>All of Origin C's internal classes are derived from the <a href="../../OriginC/Category/OriginObject_(class).html" title="Category:OriginObject (class)">OriginObject</a> class.  This class has a <a href="../../OriginC/OriginC/OriginObject-Destroy.html" title="OriginC:OriginObject-Destroy">Destroy</a> method that is used to destroy the object. Calling this method on a workbook will destroy it, together with all the sheets in the workbook, and all the columns in each sheet.
</p>
<pre class="oc" style="font-family:monospace;">WorksheetPage wksPg;
wksPg <span style="color: #000080;">=</span> Project.<span style="color: #000000;">WorksheetPages</span>.<span style="color: #000000;">Item</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// get first workbook in project</span>
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> wksPg <span style="color: #000000;">&#41;</span> <span style="color: #008000;">// if there is a workbook</span>
    wksPg.<span style="color: #000000;">Destroy</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// delete the workbook</span></pre>
<h2><a name="Clone.2FDuplicate_WorkbookPage_CloneClone_PagePage.2C_CloneDuplicate_Window"></a><span class="mw-headline">Clone/Duplicate Workbook<span class="OIndex" style="display:none">Page Clone</span><span class="OIndex" style="display:none">Clone Page</span><span class="OIndex" style="display:none">Page, Clone</span><span class="OIndex" style="display:none">Duplicate Window</span></span></h2>
<p>The <a href="../../OriginC/Category/WorksheetPage_(class).html" title="Category:WorksheetPage (class)">WorksheetPage</a> class (for a Workbook) is derived from the <a href="../../OriginC/Category/Page_(class).html" title="Category:Page (class)">Page</a> class. This class has a <a href="../../OriginC/OriginC/Page-Clone.html" title="OriginC:Page-Clone">Clone</a> method that is used to clone the source page.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Duplicate &quot;Book1&quot; window with data and style </span>
<span style="color: #008000;">// Before calling make sure these windows exist</span>
WorksheetPage wksPage<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Book1&quot;</span><span style="color: #000000;">&#41;</span>;
WorksheetPage wksPage1 <span style="color: #000080;">=</span> wksPage.<span style="color: #000000;">Clone</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</pre>
<h2><a name="Name_and_Label_Workbook"></a><span class="mw-headline">Name and Label Workbook</span></h2>
<p>For a workbook, there will be short name, Long Name, and Comments. The inherited methods, <a href="../../OriginC/OriginC/OriginObject-SetName.html" title="OriginC:OriginObject-SetName">SetName</a>, <a href="../../OriginC/OriginC/OriginObject-SetLongName.html" title="OriginC:OriginObject-SetLongName">SetLongName</a>, <a href="../../OriginC/OriginC/OriginObject-SetComments.html" title="OriginC:OriginObject-SetComments">SetComments</a>, which are defined in <a href="../../OriginC/Category/OriginObject_(class).html" title="Category:OriginObject (class)">OriginObject</a> class, can be used to control workbook's name (both short name and Long Name) and comments.
</p>
<pre class="oc" style="font-family:monospace;">WorksheetPage wksPg<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Book1&quot;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>wksPg<span style="color: #000000;">&#41;</span> 
<span style="color: #000000;">&#123;</span>
	wksPg.<span style="color: #000000;">SetName</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;MyBook&quot;</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// Rename workbook</span>
	wksPg.<span style="color: #000000;">SetLongName</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;This is Long Name&quot;</span>, <span style="color: #0000ff;">false</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// Set Long Name</span>
	wksPg.<span style="color: #000000;">SetComments</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Comments&quot;</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// Set Comments</span>
<span style="color: #000000;">&#125;</span></pre>
<p>Also, <a href="../../OriginC/OriginC/PageBase-Label.html" title="OriginC:PageBase-Label">Label</a> property is provided for changing Long Name. And <a href="../../OriginC/OriginC/PageBase-TitleShow.html" title="OriginC:PageBase-TitleShow">TitleShow</a> property is for how to show short name and Long Name on the workbook's title.
</p>
<pre class="oc" style="font-family:monospace;">WorksheetPage wksPg1<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Book2&quot;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>wksPg1<span style="color: #000000;">&#41;</span> 
<span style="color: #000000;">&#123;</span>
	wksPg1.<span style="color: #000000;">Label</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;My Label&quot;</span>;  <span style="color: #008000;">// Set Label (also called Long Name)</span>
	<span style="color: #008000;">// Show only Label on workbook's title</span>
	wksPg1.<span style="color: #000000;">TitleShow</span> <span style="color: #000080;">=</span> WIN_TITLE_SHOW_LABEL;  
	<span style="color: #008000;">// Show only short name on workbook's title</span>
	<span style="color: #008000;">// wksPg1.TitleShow = WIN_TITLE_SHOW_NAME;  </span>
	<span style="color: #008000;">// Show both short name and Label on workbook's title</span>
	<span style="color: #008000;">// wksPg1.TitleShow = WIN_TITLE_SHOW_BOTH;  </span>
<span style="color: #000000;">&#125;</span></pre>






