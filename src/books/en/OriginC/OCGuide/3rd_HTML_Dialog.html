<h1 class="firstHeading">1.18.1.5.3 HTML Dialog with a Graph</h1><p><span class="OIndex" style="display:none">HTML dialog with a graph</span><span class="OIndex" style="display:none">HTML Dialog</span>
</p>
<p class='urlname' style='display: none'>third-HTML-dialog</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Summary"><span class="tocnumber">1</span> <span class="toctext">Summary</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Sample_Files"><span class="tocnumber">2</span> <span class="toctext">Sample Files</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Preparation"><span class="tocnumber">3</span> <span class="toctext">Preparation</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Creating_an_HTML_Page_for_Dialog"><span class="tocnumber">4</span> <span class="toctext">Creating an HTML Page for Dialog</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Adding_JavaScript_Code_for_Dialog"><span class="tocnumber">5</span> <span class="toctext">Adding JavaScript Code for Dialog</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Creating_an_HTML_Dialog_with_Graph"><span class="tocnumber">6</span> <span class="toctext">Creating an HTML Dialog with Graph</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Calling_JavaScript_in_Origin_C"><span class="tocnumber">7</span> <span class="toctext">Calling JavaScript in Origin C</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Adding_JavaScript_Callable_Prototypes_in_Origin_C"><span class="tocnumber">8</span> <span class="toctext">Adding JavaScript Callable Prototypes in Origin C</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Adding_Labtalk_Callable_Prototypes_in_Origin_C"><span class="tocnumber">9</span> <span class="toctext">Adding Labtalk Callable Prototypes in Origin C</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#Launching_The_Dialog"><span class="tocnumber">10</span> <span class="toctext">Launching The Dialog</span></a></li>
</ul>
</div>

<h2><a name="Summary"></a><span class="mw-headline">Summary</span></h2>
<p>In this tutorial, you build a dailog works as follows:
</p>
<ol><li> There are three panels in the dialog, including a textbox in the left panel, a graph in the central panel and a blank right panel.</li>
<li> When a user moves the vertical line on the graph manually,  the program shows the x-value in the textbox.</li>
<li> Conversely, when the user enters an x-value in the textbox and hit the ENTER key, the program moves the vertical line to the specified position.</li></ol>
<p>You can learn how to:
</p>
<ol><li> How to contain a graph in HTML dialog.</li>
<li> How to resize the dialog as you pleased.</li>
<li> How to call Origin C in JavaScript. (You can also learn this from the tutorial <a href="../../OriginC/OCGuide/2nd_HTML_Dialog.html#Calling_Origin_C_Function_in_JavaScript" title="OCGuide:2nd HTML Dialog">Create a Calculator</a>.)</li>
<li> How to call JavaScript in Origin C.</li></ol>
<p>When you finish this tutorial, your dialog will look like the following picture except the different number:
</p>
<dl><dd><a  class="image"><img alt="Result.png" src="../images/3rd_HTML_Dialog/500px-Result.png?v=49382" width="500"   /></a></dd></dl>
<p class="version" >Minimum Origin Version Required: Origin 2017</p>
<h2><a name="Sample_Files"></a><span class="mw-headline">Sample Files</span></h2>
<ol><li> Composite Spectrum.opj: This is the OPJ that contains a graph to be shown in the dialog</li>
<li> Index.html: This is the HTML code for the html page.</li>
<li> DlgWithGraph.cpp: This is the Origin C code to call out the HTML dialog and achieve the communication between Origin C and JavaScript.</li>
<li> Background_image1.png: This is the first picture for the background of dialog .</li>
<li> Background_image2.jpg: This is the second picture for the background of dialog.</li></ol>
<table class="note">

<tr>
<td><b>Note:</b> You can download the sample file <a class="external text" href="http://blog.originlab.com/wp-content/uploads/2016/11/HTMLDlgExamples.zip" target="_blank">here</a>
</td></tr></table>
<h2><a name="Preparation"></a><span class="mw-headline">Preparation</span></h2>
<ol>
<li> New an Origin Project named Composite Spectrum.opj, and save it to the folder HTML Dialog with A Graph.
<li> Select <b>Data: Import from File: Single ASCII</b> from Origin menu to import the data \Samples\Curve Fitting\Composite Spectrum.dat.
<li> Highlight <b>Column B</b> to <b>Column D</b> and select <b>Plot: Multi-Y: Stacked Lines by Y</b> from menu to create a stacked line plot.
<li> Double click on <b>Graph1</b> to open <b>Plot Details</b> dialog, and then improve the format of <b>Graph 1</b> as you pleased.
<li> Click <b>Line Tool</b> button <a  class="image"><img alt="Button Line Tool.png" src="../images/3rd_HTML_Dialog/Button_Line_Tool.png?v=49473" width="34"  /></a> to add a vertical line (press SHIFT key and draw) to the graph.
<li> Right click on the vertical line and select <b>Propertiesâ€¦</b> in the context menu to bring up a dialog.
<li> Go to <b>Line</b> tab and <b>Arrow</b> tab to modify the format of the vertical line, and then go to <b>Dimensions</b> tab to only allow it to move horizontally.
<dl><dd><a  class="image"><img alt="Line Properties.png" src="../images/3rd_HTML_Dialog/Line_Properties.png?v=49611" width="700"  /></a></dd></dl>
<li> Go to <b>Programming</b> tab,  name your line object <b>Line</b>.
<li> Select <b>Moved</b> from the drop-down list of <b>Script Run After</b>, then type the following LabTalk script in the textbox.
<pre class="lt" style="font-family:monospace;">line_move<span style="color: #000000;">&#40;</span>this.<span style="color: #000080;">X</span><span style="color: #000000;">&#41;</span>;</pre>
<dl><dd><a  class="image"><img alt="Line Programming Tab.png" src="../images/3rd_HTML_Dialog/300px-Line_Programming_Tab.png?v=49589" width="300"   /></a></dd></dl>
<table class="note">

<tr>
<td><b>Note:</b> In this step, you set to trigger the function <code>line_move()</code> when a user moves the vertical line. This function <code>line_move()</code> will be created later in OriginC.
</td></tr></table>
<li> Open <b>Code Builder</b>, and then expand <b>Project</b> folder in <b>Workspace</b> window, double click ProjectEvents.OGS to open the file, and then add scripts inside the [AfterOpenDoc] section:

<pre class="lt" style="font-family:monospace;">if<span style="color: #000000;">&#40;</span>run.<span style="color: #000080;">LoadOC</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;%X\DlgWithGraph.cpp&quot;</span>, <span style="color: #0000dd;">16</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">==</span> <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    @G<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;<span style="color: #008000;">//graph background fill all so no gray band on either side</span>
    HTMLandGraphDlgEx; <span style="color: #008000;">//this is the function which launches the dialog</span>
<span style="color: #000000;">&#125;</span>
else
<span style="color: #000000;">&#123;</span>
   type <span style="color: #ff00ff;">&quot;Failed to load the dialog!&quot;</span>;
   return <span style="color: #0000dd;">0</span>;
<span style="color: #000000;">&#125;</span></pre>
<table class="note">

<tr>
<td><b>Note:</b> The scripts help to launch the dialog after this Origin project is opened. If you want to learn more about ProjectEvents Script, please go to <a class="external text" href="../../LabTalk/Script/ProjectEvents_Script.html">this page</a>.
</td></tr></table>
<li> Save the ProjectEvents.OGS in <b>Code Builder</b> and save the project in Origin.

</ol>
<h2><a name="Creating_an_HTML_Page_for_Dialog"></a><span class="mw-headline">Creating an HTML Page for Dialog</span></h2>
<p>When you create an HTML dialog, the first step is to design and create an HTML page for the dialog. 
</p>
<ol>
<li> Prepare two pictures for the background in the folder HTML Dialog with A Graph.
<li> Open <b>Code Builder</b>,  create a new HTML file and save as index.html to the folder HTML Dialog with A Graph.
<li> Copy the following code and paste it within the index.html:

<pre class="javascript" style="font-family:monospace;"><span style="color: #339933;">&lt;!</span>DOCTYPE html<span style="color: #339933;">&gt;</span>
<span style="color: #339933;">&lt;</span>html<span style="color: #339933;">&gt;</span>
    <span style="color: #339933;">&lt;</span>head<span style="color: #339933;">&gt;</span>
	<span style="color: #339933;">&lt;</span>meta charset<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;utf-8&quot;</span> <span style="color: #339933;">/&gt;</span>
        <span style="color: #339933;">&lt;</span>meta http<span style="color: #339933;">-</span>equiv<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;X-UA-Compatible&quot;</span> content<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;IE=Edge&quot;</span> <span style="color: #339933;">/&gt;</span>
	    <span style="color: #339933;">&lt;</span>style<span style="color: #339933;">&gt;</span>
	    body<span style="color: #009900;">&#123;</span>
	        background<span style="color: #339933;">-</span>image<span style="color: #339933;">:</span>url<span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;background_image1.png&quot;</span><span style="color: #009900;">&#41;</span>
	    <span style="color: #009900;">&#125;</span>
	    input<span style="color: #009900;">&#91;</span>type<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;text&quot;</span><span style="color: #009900;">&#93;</span> <span style="color: #009900;">&#123;</span>
	        font<span style="color: #339933;">-</span>size<span style="color: #339933;">:</span> 14px<span style="color: #339933;">;</span>
	    <span style="color: #009900;">&#125;</span>
	    input<span style="color: #009900;">&#91;</span>type<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;text&quot;</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">:</span>focus <span style="color: #009900;">&#123;</span>
	        outline<span style="color: #339933;">:</span> none<span style="color: #339933;">;</span>
	    <span style="color: #009900;">&#125;</span>
	    .<span style="color: #660066;">style</span><span style="color: #339933;">-</span><span style="color: #CC0000;">2</span> input<span style="color: #009900;">&#91;</span>type<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;text&quot;</span><span style="color: #009900;">&#93;</span> <span style="color: #009900;">&#123;</span>
	        padding<span style="color: #339933;">:</span> 3px<span style="color: #339933;">;</span>
	        border<span style="color: #339933;">:</span> solid 5px #c9c9c9<span style="color: #339933;">;</span>
	        transition<span style="color: #339933;">:</span> border 0.3s<span style="color: #339933;">;</span>
	    <span style="color: #009900;">&#125;</span>
	    .<span style="color: #660066;">style</span><span style="color: #339933;">-</span><span style="color: #CC0000;">2</span> input<span style="color: #009900;">&#91;</span>type<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;text&quot;</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">:</span>focus<span style="color: #339933;">,</span>
	    .<span style="color: #660066;">style</span><span style="color: #339933;">-</span><span style="color: #CC0000;">2</span> input<span style="color: #009900;">&#91;</span>type<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;text&quot;</span><span style="color: #009900;">&#93;</span>.<span style="color: #660066;">focus</span> <span style="color: #009900;">&#123;</span>
	        border<span style="color: #339933;">:</span> solid 5px #<span style="color: #CC0000;">969696</span><span style="color: #339933;">;</span>
	    <span style="color: #009900;">&#125;</span>		
	    #container <span style="color: #009900;">&#123;</span>
	        border<span style="color: #339933;">:</span> 3px solid #ffffff<span style="color: #339933;">;</span>
	        position<span style="color: #339933;">:</span> absolute<span style="color: #339933;">;</span>
	        left<span style="color: #339933;">:</span> <span style="color: #CC0000;">0</span><span style="color: #339933;">;</span>
	        right<span style="color: #339933;">:</span> <span style="color: #CC0000;">0</span><span style="color: #339933;">;</span>
	        bottom<span style="color: #339933;">:</span> <span style="color: #CC0000;">0</span><span style="color: #339933;">;</span>
	        top<span style="color: #339933;">:</span> <span style="color: #CC0000;">0</span><span style="color: #339933;">;</span>
	    <span style="color: #009900;">&#125;</span>
	    #leftcontainer <span style="color: #009900;">&#123;</span>
	        border<span style="color: #339933;">-</span>right<span style="color: #339933;">:</span> 3px solid #ffffff<span style="color: #339933;">;</span>
		width<span style="color: #339933;">:</span> 250px<span style="color: #339933;">;</span>
		height<span style="color: #339933;">:</span> <span style="color: #CC0000;">100</span><span style="color: #339933;">%;</span>
		<span style="color: #FF0000;">float</span><span style="color: #339933;">:</span> left<span style="color: #339933;">;</span>
	    <span style="color: #009900;">&#125;</span>
	    #rightcontainer <span style="color: #009900;">&#123;</span>
		border<span style="color: #339933;">-</span>left<span style="color: #339933;">:</span> 3px solid #ffffff<span style="color: #339933;">;</span>
		width<span style="color: #339933;">:</span> 250px<span style="color: #339933;">;</span>
		height<span style="color: #339933;">:</span> <span style="color: #CC0000;">100</span><span style="color: #339933;">%;</span>
		<span style="color: #FF0000;">float</span><span style="color: #339933;">:</span> right<span style="color: #339933;">;</span>
		text<span style="color: #339933;">-</span>align<span style="color: #339933;">:</span> center<span style="color: #339933;">;</span>
	    <span style="color: #009900;">&#125;</span>
	<span style="color: #339933;">&lt;/</span>style<span style="color: #339933;">&gt;</span>		
    <span style="color: #339933;">&lt;/</span>head<span style="color: #339933;">&gt;</span>

    <span style="color: #339933;">&lt;</span>body<span style="color: #339933;">&gt;</span>
	<span style="color: #339933;">&lt;</span>div id<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;container&quot;</span><span style="color: #339933;">&gt;</span>
	    <span style="color: #339933;">&lt;</span>div id<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;leftcontainer&quot;</span><span style="color: #339933;">&gt;</span>
                <span style="color: #339933;">&lt;</span>h2<span style="color: #339933;">&gt;&lt;</span>font color<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;ffffff&quot;</span><span style="color: #339933;">&gt;</span>X<span style="color: #339933;">-</span>Value<span style="color: #339933;">&lt;/</span>font<span style="color: #339933;">&gt;&lt;/</span>h2<span style="color: #339933;">&gt;</span>
		<span style="color: #339933;">&lt;</span>ul <span style="color: #FF0000;">class</span><span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;input-list style-2 clearfix&quot;</span><span style="color: #339933;">&gt;</span>
		    <span style="color: #339933;">&lt;</span>input type<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;text&quot;</span> name<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;XValue&quot;</span>  id<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;X&quot;</span> placeholder<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;X&quot;</span>  onkeydown <span style="color: #339933;">=</span> <span style="color: #3366CC;">&quot;&quot;</span><span style="color: #339933;">&gt;</span>
		<span style="color: #339933;">&lt;/</span>ul<span style="color: #339933;">&gt;</span>

		<span style="color: #339933;">&lt;</span>p<span style="color: #339933;">&gt;&lt;</span>font color<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;ffffff&quot;</span><span style="color: #339933;">&gt;*</span>Move the vertical line <span style="color: #000066; font-weight: bold;">in</span> graph<span style="color: #339933;">,</span> and <span style="color: #000066; font-weight: bold;">get</span> the x<span style="color: #339933;">-</span>value and y<span style="color: #339933;">-</span>values.<span style="color: #339933;">&lt;/</span>font<span style="color: #339933;">&gt;&lt;/</span>p<span style="color: #339933;">&gt;</span>
		<span style="color: #339933;">&lt;</span>p<span style="color: #339933;">&gt;&lt;</span>font color<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;ffffff&quot;</span><span style="color: #339933;">&gt;*</span>Enter x<span style="color: #339933;">-</span>value <span style="color: #000066; font-weight: bold;">in</span> textbox and hit ENTER key<span style="color: #339933;">,</span> then the vetical line will move to the specified position.<span style="color: #339933;">&lt;/</span>font<span style="color: #339933;">&gt;&lt;/</span>p<span style="color: #339933;">&gt;</span>
	    <span style="color: #339933;">&lt;/</span>div<span style="color: #339933;">&gt;</span>
 
	    <span style="color: #339933;">&lt;</span>div id<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;rightcontainer&quot;</span><span style="color: #339933;">&gt;</span>
		<span style="color: #339933;">&lt;</span>h3<span style="color: #339933;">&gt;</span> <span style="color: #339933;">&amp;</span>nbsp <span style="color: #339933;">&lt;/</span>h3<span style="color: #339933;">&gt;</span>
		<span style="color: #339933;">&lt;</span>h3<span style="color: #339933;">&gt;</span> <span style="color: #339933;">&amp;</span>nbsp <span style="color: #339933;">&lt;/</span>h3<span style="color: #339933;">&gt;</span>
		<span style="color: #339933;">&lt;</span>h3<span style="color: #339933;">&gt;&lt;</span>font color<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;ffffff&quot;</span><span style="color: #339933;">&gt;</span>You can place other controls on <span style="color: #000066; font-weight: bold;">this</span> side.<span style="color: #339933;">&lt;/</span>font<span style="color: #339933;">&gt;&lt;/</span>h3<span style="color: #339933;">&gt;</span>
	    <span style="color: #339933;">&lt;/</span>div<span style="color: #339933;">&gt;</span>
        <span style="color: #339933;">&lt;/</span>div<span style="color: #339933;">&gt;</span>
    <span style="color: #339933;">&lt;/</span>body<span style="color: #339933;">&gt;</span>
<span style="color: #339933;">&lt;/</span>html<span style="color: #339933;">&gt;</span></pre>
</ol>
<p>Once you finish this step, you can see the following page by opening the index.html with a web browser:
</p>
<dl><dd><a  class="image"><img alt="HTMLInit.png" src="../images/3rd_HTML_Dialog/400px-HTMLInit.png?v=49379" width="400"   /></a></dd></dl>
<h2><a name="Adding_JavaScript_Code_for_Dialog"></a><span class="mw-headline">Adding JavaScript Code for Dialog</span></h2>
<p>In this step, you add JavaScript code.
</p>
<ol>
<li> Copy the following JavaScript code and paste it inside the element &lt;script&gt; of your html file. 
<pre class="javascript" style="font-family:monospace;"><span style="color: #339933;">&lt;</span>script<span style="color: #339933;">&gt;</span>
    <span style="color: #000066; font-weight: bold;">var</span> vbg <span style="color: #339933;">=</span> <span style="color: #CC0000;">1</span><span style="color: #339933;">;</span><span style="color: #006600; font-style: italic;">//counter to alternate html backgroud</span>
    <span style="color: #000066; font-weight: bold;">function</span> lineMove<span style="color: #009900;">&#40;</span>xVal<span style="color: #009900;">&#41;</span> 
    <span style="color: #009900;">&#123;</span>
        <span style="color: #000066; font-weight: bold;">var</span> XValue <span style="color: #339933;">=</span> document.<span style="color: #660066;">getElementById</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;X&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
	XValue.<span style="color: #660066;">value</span> <span style="color: #339933;">=</span> xVal<span style="color: #339933;">;</span>
	<span style="color: #006600; font-style: italic;">//show html background change and graph not affected</span>
	<span style="color: #000066; font-weight: bold;">switch</span> <span style="color: #009900;">&#40;</span>vbg<span style="color: #009900;">&#41;</span>
	<span style="color: #009900;">&#123;</span>
	    <span style="color: #000066; font-weight: bold;">case</span> <span style="color: #CC0000;">1</span><span style="color: #339933;">:</span>
	        document.<span style="color: #660066;">body</span>.<span style="color: #660066;">style</span>.<span style="color: #660066;">backgroundImage</span> <span style="color: #339933;">=</span> <span style="color: #3366CC;">&quot;URL('background_image2.jpg')&quot;</span><span style="color: #339933;">;</span>
	        vbg <span style="color: #339933;">=</span> <span style="color: #CC0000;">2</span><span style="color: #339933;">;</span>
	    <span style="color: #000066; font-weight: bold;">break</span><span style="color: #339933;">;</span>
	    <span style="color: #000066; font-weight: bold;">case</span> <span style="color: #CC0000;">2</span><span style="color: #339933;">:</span>
		document.<span style="color: #660066;">body</span>.<span style="color: #660066;">style</span>.<span style="color: #660066;">backgroundImage</span> <span style="color: #339933;">=</span> <span style="color: #3366CC;">&quot;URL('background_image1.png')&quot;</span><span style="color: #339933;">;</span>
		vbg <span style="color: #339933;">=</span> <span style="color: #CC0000;">1</span><span style="color: #339933;">;</span>
	    <span style="color: #000066; font-weight: bold;">break</span><span style="color: #339933;">;</span>
	<span style="color: #009900;">&#125;</span>
    <span style="color: #009900;">&#125;</span>
			
    <span style="color: #000066; font-weight: bold;">function</span> enterXval<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>
    <span style="color: #009900;">&#123;</span>
	<span style="color: #000066; font-weight: bold;">var</span> XValue <span style="color: #339933;">=</span> document.<span style="color: #660066;">getElementById</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;X&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>			
        window.<span style="color: #660066;">external</span>.<span style="color: #660066;">ExtCall</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;OnEnterXvalToUpdateGraph&quot;</span><span style="color: #339933;">,</span> XValue.<span style="color: #660066;">value</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    <span style="color: #009900;">&#125;</span>
												
    <span style="color: #000066; font-weight: bold;">function</span> getGraphRect<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>
    <span style="color: #009900;">&#123;</span>			
	<span style="color: #000066; font-weight: bold;">var</span> leftDiv <span style="color: #339933;">=</span> document.<span style="color: #660066;">getElementById</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;leftcontainer&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
	<span style="color: #000066; font-weight: bold;">var</span> leftpos <span style="color: #339933;">=</span> leftDiv.<span style="color: #660066;">getBoundingClientRect</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>.<span style="color: #660066;">right</span><span style="color: #339933;">;</span>
	<span style="color: #000066; font-weight: bold;">var</span> toppos <span style="color: #339933;">=</span> leftDiv.<span style="color: #660066;">getBoundingClientRect</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>.<span style="color: #660066;">top</span><span style="color: #339933;">;</span>
	<span style="color: #000066; font-weight: bold;">var</span> bottompos <span style="color: #339933;">=</span> leftDiv.<span style="color: #660066;">getBoundingClientRect</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>.<span style="color: #660066;">bottom</span><span style="color: #339933;">;</span>
				
	<span style="color: #000066; font-weight: bold;">var</span> rightDiv <span style="color: #339933;">=</span> document.<span style="color: #660066;">getElementById</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;rightcontainer&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
	<span style="color: #000066; font-weight: bold;">var</span> rightpos <span style="color: #339933;">=</span> rightDiv.<span style="color: #660066;">getBoundingClientRect</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>.<span style="color: #660066;">left</span><span style="color: #339933;">;</span>
				
	<span style="color: #000066; font-weight: bold;">return</span> JSON.<span style="color: #660066;">stringify</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#123;</span>
	    left<span style="color: #339933;">:</span> leftpos <span style="color: #339933;">+</span> <span style="color: #CC0000;">20</span><span style="color: #339933;">,</span>
	    top<span style="color: #339933;">:</span> toppos <span style="color: #339933;">+</span> <span style="color: #CC0000;">20</span><span style="color: #339933;">,</span>
	    right<span style="color: #339933;">:</span> rightpos <span style="color: #339933;">-</span> <span style="color: #CC0000;">20</span><span style="color: #339933;">,</span>
	    bottom<span style="color: #339933;">:</span> bottompos <span style="color: #339933;">-</span> <span style="color: #CC0000;">20</span><span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span>
    <span style="color: #009900;">&#125;</span>
<span style="color: #339933;">&lt;/</span>script<span style="color: #339933;">&gt;</span></pre>
<table class="note">

<tr>
<td><b>Note:</b> This code adds functionality to the HTML page you created above:
<ul><li> <code>lineMove()</code>:Update the x-value in textbox when a user moves the vertical line </li>
<li> <code>enterXval()</code>: Respond to the event of a user hitting the ENTER key in textbox</li>
<li> <code>getGraphRect()</code>: Return a rectangular box in which the graph is shown</li></ul>
</td></tr></table>
<li>In order to capture the hitting ENTER event, add an <code>onkeydown</code> event handler inside the textbox tag of HTML code, so that the function <code>enterXval()</code> will be invoked when the user hits the ENTER key.
<dl><dd><pre class="javascript" style="font-family:monospace;"><span style="color: #339933;">&lt;</span>input type<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;text&quot;</span> name<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;XValue&quot;</span>  id<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;X&quot;</span> placeholder<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;X&quot;</span>  onkeydown <span style="color: #339933;">=</span> <span style="color: #3366CC;">&quot;javascript:if(event.keyCode == 13) enterXval();&quot;</span><span style="color: #339933;">&gt;</span></pre></dd></dl>
</ol>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/3rd_HTML_Dialog/Tip_icon.png?v=21427" width="57"  border="0" /></td><td><ol>
<li> In the function <code>lineMove()</code>,  a switch statement is recommended to add. As the comment said, you can see the graph overlaps the HTML page and is not affected even you change the background. 

<li> In the function <code>enterXval()</code>, <code>window.external.ExtCall</code> is used to call Origin C. You can learn more about <code>window.external.ExtCall</code> from <a href="../../OriginC/OCGuide/2nd_HTML_Dialog.html#Calling_Origin_C_Function_in_JavaScript" title="OCGuide:2nd HTML Dialog">here</a>.
</ol>
</td></tr></table>
<h2><a name="Creating_an_HTML_Dialog_with_Graph"></a><span class="mw-headline">Creating an HTML Dialog with Graph</span></h2>
<p>Now you are ready to edit the Origin C code to create an HTML dialog with a graph.
</p>
<ol>
<li> In <b>Code Builder</b>, create a new cpp file named DlgWithGraph.cpp under the folder HTML Dialog with A Graph.
<li> Include the needed headers.
<pre class="c" style="font-family:monospace;"><span style="color: #339933;">#include &lt;Origin.h&gt;</span>
<span style="color: #339933;">#include &lt;../OriginLab/DialogEx.h&gt;</span>
<span style="color: #339933;">#include &lt;../OriginLab/HTMLDlg.h&gt;</span>
<span style="color: #339933;">#include &lt;../OriginLab/GraphPageControl.h&gt;</span></pre>
<li> Define the GRAPH_CONTROL_ID.
<pre class="c" style="font-family:monospace;"><span style="color: #339933;">#define GRAPH_CONTROL_ID 1</span></pre>
<li> Derive a user defined HTML dialog class <code>HTMLandGraphDlg</code> from the class <code>HTMLDlg</code>, and point to the HTML page inside the method <code>GetInitURL()</code>.
<pre class="c" style="font-family:monospace;">class HTMLandGraphDlg<span style="color: #339933;">:</span> public HTMLDlg
<span style="color: #009900;">&#123;</span>
    protected<span style="color: #339933;">:</span>
        string GetInitURL<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #666666; font-style: italic;">//get the path of html file                    </span>
	<span style="color: #009900;">&#123;</span>
	    string strFile <span style="color: #339933;">=</span> __FILE__<span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//the name of current file</span>
	    <span style="color: #b1b100;">return</span> GetFilePath<span style="color: #009900;">&#40;</span>strFile<span style="color: #009900;">&#41;</span> <span style="color: #339933;">+</span> <span style="color: #ff0000;">&quot;index.html&quot;</span><span style="color: #339933;">;</span>
	<span style="color: #009900;">&#125;</span>
	string GetDialogTitle<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><span style="color: #b1b100;">return</span> <span style="color: #ff0000;">&quot;Vertical Cursor Example&quot;</span><span style="color: #339933;">;</span><span style="color: #009900;">&#125;</span> <span style="color: #666666; font-style: italic;">//set the title of dialog</span>
<span style="color: #009900;">&#125;</span><span style="color: #339933;">;</span></pre>
<li> Add event handler methods inside the class <code>HTMLandGraphDlg</code> to respond to the event, which is triggered when a user opens, resizes or closes the dialog.
<pre class="c" style="font-family:monospace;">private<span style="color: #339933;">:</span>
    GraphControl     m_gcCntrl<span style="color: #339933;">;</span>
protected<span style="color: #339933;">:</span>
    BOOL OnInitDialog<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #666666; font-style: italic;">//when the dialog is shown the first time, need to init the dialog</span>
    <span style="color: #009900;">&#123;</span>
        LT_execute<span style="color: #009900;">&#40;</span><span style="color: #ff0000;">&quot;;doc -m 0&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><span style="color: #666666; font-style: italic;">//hide Origin main window</span>
	HTMLDlg<span style="color: #339933;">::</span><span style="color: #202020;">OnInitDialog</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//Derive a dialog from HTMLDlg class</span>
	ModifyStyle<span style="color: #009900;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #339933;">,</span> WS_MAXIMIZEBOX<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><span style="color: #666666; font-style: italic;">//the generic HTML dialog resource did not have maximize button</span>
	RECT rr<span style="color: #339933;">;</span>
	m_gcCntrl.<span style="color: #202020;">CreateControl</span><span style="color: #009900;">&#40;</span>GetSafeHwnd<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <span style="color: #339933;">&amp;</span>rr<span style="color: #339933;">,</span> GRAPH_CONTROL_ID<span style="color: #339933;">,</span> WS_CHILD<span style="color: #339933;">|</span>WS_VISIBLE<span style="color: #339933;">|</span>WS_BORDER<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
		
	<span style="color: #666666; font-style: italic;">//set options to disable clicking on various components on a graph, you can find more in OC_const.h</span>
	DWORD 	dwNoClicks <span style="color: #339933;">=</span> NOCLICK_AXES <span style="color: #339933;">|</span> NOCLICK_DATA_PLOT <span style="color: #339933;">|</span> NOCLICK_LAYER <span style="color: #339933;">|</span> NOCLICK_TICKLABEL <span style="color: #339933;">|</span> NOCLICK_LAYERICON<span style="color: #339933;">;</span>
	GraphPage m_gp <span style="color: #339933;">=</span> Project.<span style="color: #202020;">GraphPages</span><span style="color: #009900;">&#40;</span><span style="color: #ff0000;">&quot;Graph1&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//this graph in the OPJ can be customized manually</span>
	<span style="color: #666666; font-style: italic;">//attach Graph1 in OPJ to GraphControl in dialog</span>
	BOOL bb <span style="color: #339933;">=</span> m_gcCntrl.<span style="color: #202020;">AttachPage</span><span style="color: #009900;">&#40;</span>m_gp<span style="color: #339933;">,</span> dwNoClicks<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>	
	<span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">true</span><span style="color: #339933;">;</span>
    <span style="color: #009900;">&#125;</span>

    BOOL OnDestroy<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>
    <span style="color: #009900;">&#123;</span>
	<span style="color: #666666; font-style: italic;">//for the developer, this allow the OPJ to be modified, </span>
        <span style="color: #666666; font-style: italic;">//and you can remove this part for the end users and just do LT_execute(&quot;;doc -ss;exit;&quot;)</span>
	bool bExitOrigin <span style="color: #339933;">=</span> MessageBox<span style="color: #009900;">&#40;</span>GetSafeHwnd<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> _L<span style="color: #009900;">&#40;</span><span style="color: #ff0000;">&quot;Are you sure you want to exit Origin?&quot;</span><span style="color: #009900;">&#41;</span> <span style="color: #339933;">,</span>_L<span style="color: #009900;">&#40;</span><span style="color: #ff0000;">&quot;Vertical Cursor Example&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> MB_YESNO<span style="color: #009900;">&#41;</span> <span style="color: #339933;">==</span> IDYES<span style="color: #339933;">;</span>
	<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span>bExitOrigin<span style="color: #009900;">&#41;</span>
	    LT_execute<span style="color: #009900;">&#40;</span><span style="color: #ff0000;">&quot;;doc -ss;exit;&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//exit Origin</span>
	<span style="color: #b1b100;">else</span>
	    LT_execute<span style="color: #009900;">&#40;</span><span style="color: #ff0000;">&quot;;doc -m 1&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//show Origin main window</span>
	<span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">true</span><span style="color: #339933;">;</span>
    <span style="color: #009900;">&#125;</span>

    <span style="color: #666666; font-style: italic;">//virtual</span>
    <span style="color: #666666; font-style: italic;">// when the dialog is ready, need to init the size and position of dialog</span>
    BOOL GetDlgInitSize<span style="color: #009900;">&#40;</span>int<span style="color: #339933;">&amp;</span> width<span style="color: #339933;">,</span> int<span style="color: #339933;">&amp;</span> height<span style="color: #009900;">&#41;</span> 
    <span style="color: #009900;">&#123;</span>
	width <span style="color: #339933;">=</span> <span style="color: #0000dd;">1024</span><span style="color: #339933;">;</span>
	height <span style="color: #339933;">=</span> <span style="color: #0000dd;">450</span><span style="color: #339933;">;</span>
	<span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">true</span><span style="color: #339933;">;</span>
    <span style="color: #009900;">&#125;</span>
    <span style="color: #666666; font-style: italic;">// when you resize the dialog, need to reinit the size and position of each control in dialog</span>
    BOOL OnDlgResize<span style="color: #009900;">&#40;</span><span style="color: #993333;">int</span> nType<span style="color: #339933;">,</span> <span style="color: #993333;">int</span> cx<span style="color: #339933;">,</span> <span style="color: #993333;">int</span> cy<span style="color: #009900;">&#41;</span> 
    <span style="color: #009900;">&#123;</span>
	<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span> <span style="color: #339933;">!</span>IsInitReady<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#41;</span>
	    <span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">false</span><span style="color: #339933;">;</span>
	<span style="color: #666666; font-style: italic;">// MoveControlsHelper	_temp(this); // you can uncomment this line, if the dialog flickers when you resize it</span>
	HTMLDlg<span style="color: #339933;">::</span><span style="color: #202020;">OnDlgResize</span><span style="color: #009900;">&#40;</span>nType<span style="color: #339933;">,</span> cx<span style="color: #339933;">,</span> cy<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//place html control in dialog</span>
		
	<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span> <span style="color: #339933;">!</span>IsHTMLDocumentCompleted<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#41;</span> <span style="color: #666666; font-style: italic;">//check the state of HTML control</span>
	    <span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">false</span><span style="color: #339933;">;</span>
		
	RECT rectGraph<span style="color: #339933;">;</span>
        <span style="color: #666666; font-style: italic;">//GetGraphRECT is a private function calling JavaScript to get a rectangular box to involve the graph control.</span>
        <span style="color: #666666; font-style: italic;">//You will get to how to call JavaScript in Origin C in the next section. </span>
	<span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span> <span style="color: #339933;">!</span>GetGraphRECT<span style="color: #009900;">&#40;</span>rectGraph<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> 
	    <span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">false</span><span style="color: #339933;">;</span>
	<span style="color: #666666; font-style: italic;">//overlap the GraphControl on the top of HTML control</span>
	m_gcCntrl.<span style="color: #202020;">SetWindowPos</span><span style="color: #009900;">&#40;</span>HWND_TOP<span style="color: #339933;">,</span> rectGraph.<span style="color: #202020;">left</span><span style="color: #339933;">,</span> rectGraph.<span style="color: #202020;">top</span><span style="color: #339933;">,</span>RECT_WIDTH<span style="color: #009900;">&#40;</span>rectGraph<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span>RECT_HEIGHT<span style="color: #009900;">&#40;</span>rectGraph<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <span style="color: #0000dd;">0</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> 
		
	<span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">true</span><span style="color: #339933;">;</span>
    <span style="color: #009900;">&#125;</span></pre>
<table class="note">

<tr>
<td><b>Note:</b> The graph will be attached in a new-created graph control when the method <code>OnInitDialog()</code> is triggered.
</td></tr></table>
<li> Map the dialog message inside the class <code>HTMLandGraphDlg</code> to specify which events will be handled and which function will be called to handle.
<pre class="c" style="font-family:monospace;">EVENTS_BEGIN_DERIV<span style="color: #009900;">&#40;</span>HTMLDlg<span style="color: #009900;">&#41;</span>
    ON_INIT<span style="color: #009900;">&#40;</span>OnInitDialog<span style="color: #009900;">&#41;</span>
    ON_DESTROY<span style="color: #009900;">&#40;</span>OnDestroy<span style="color: #009900;">&#41;</span>
    ON_SIZE<span style="color: #009900;">&#40;</span>OnDlgResize<span style="color: #009900;">&#41;</span>
    ON_RESTORESIZE<span style="color: #009900;">&#40;</span>OnRestoreSize<span style="color: #009900;">&#41;</span>
EVENTS_END_DERIV</pre>
</ol>
<h2><a name="Calling_JavaScript_in_Origin_C"></a><span class="mw-headline">Calling JavaScript in Origin C</span></h2>
<p>In this section, you need OriginC calling JavaScript to complete these two items:
</p>
<ul><li> The graph control should be moved to a right position along with the central panel when the user resizes the dialog, so you should call JavaScript to return a rectangular box in time.</li>
<li> The x-value in textbox should be updated when the user moves the vertical line, thus you should also call JavaScript to update the number.</li></ul>
<p><br />
In these section, you will use a member function <a href="../../OriginC/OriginC/DhtmlControl-GetScript.html" title="OriginC:DhtmlControl-GetScript"><code>GetScript()</code></a> of the <code>DHtmlControl</code> class to get a script engine interface.
</p>
<ol>
<li> Add the function <code>GetGraphRect()</code> inside the class <code>HTMLandGraphDlg</code> to call the JavaScript function <code>getGraphRECT()</code> you wrote in the fifth section:
<pre class="c" style="font-family:monospace;">private<span style="color: #339933;">:</span>
    BOOL GetGraphRECT<span style="color: #009900;">&#40;</span>RECT<span style="color: #339933;">&amp;</span> gcCntrlRect<span style="color: #009900;">&#41;</span> <span style="color: #666666; font-style: italic;">//this is the function to call JavaScript and get the position of GraphControl</span>
    <span style="color: #009900;">&#123;</span>
        <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span><span style="color: #339933;">!</span>m_dhtml<span style="color: #009900;">&#41;</span>
	    <span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">false</span><span style="color: #339933;">;</span>
	Object jsscript <span style="color: #339933;">=</span> m_dhtml.<span style="color: #202020;">GetScript</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
		
	<span style="color: #b1b100;">if</span><span style="color: #009900;">&#40;</span><span style="color: #339933;">!</span>jsscript<span style="color: #009900;">&#41;</span> <span style="color: #666666; font-style: italic;">//check the validity of returned COM object is always recommended</span>
	    <span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">false</span><span style="color: #339933;">;</span>
		
	string str <span style="color: #339933;">=</span> jsscript.<span style="color: #202020;">getGraphRECT</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>	
	    JSON.<span style="color: #202020;">FromString</span><span style="color: #009900;">&#40;</span>gcCntrlRect<span style="color: #339933;">,</span> str<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//convert a string to a structure</span>
	<span style="color: #b1b100;">return</span> <span style="color: #000000; font-weight: bold;">true</span><span style="color: #339933;">;</span>
    <span style="color: #009900;">&#125;</span></pre>
<li> Add the function <code>OnMoveVlineToUpdateHtml()</code> inside your Origin C class to call the function <code>lineMove()</code> in JavaScript:
<pre class="c" style="font-family:monospace;">public<span style="color: #339933;">:</span>
    <span style="color: #993333;">void</span> OnMoveVlineToUpdateHtml<span style="color: #009900;">&#40;</span><span style="color: #993333;">double</span> dVal<span style="color: #009900;">&#41;</span>
    <span style="color: #009900;">&#123;</span> 
        Object jsscript <span style="color: #339933;">=</span> m_dhtml.<span style="color: #202020;">GetScript</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
        <span style="color: #b1b100;">if</span><span style="color: #009900;">&#40;</span><span style="color: #339933;">!</span>jsscript<span style="color: #009900;">&#41;</span>
            <span style="color: #b1b100;">return</span><span style="color: #339933;">;</span>
        string strXValue <span style="color: #339933;">=</span> ftoa<span style="color: #009900;">&#40;</span>dVal<span style="color: #339933;">,</span> <span style="color: #ff0000;">&quot;*5*&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><span style="color: #666666; font-style: italic;">//limit to 5 significant digits and remove trailing zeros</span>
        jsscript.<span style="color: #202020;">lineMove</span><span style="color: #009900;">&#40;</span>strXValue<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    <span style="color: #009900;">&#125;</span></pre>
</ol>
<h2><a name="Adding_JavaScript_Callable_Prototypes_in_Origin_C"></a><span class="mw-headline">Adding JavaScript Callable Prototypes in Origin C</span></h2>
<p>In this section,  you add a method <code>OnEnterXvalToUpdateGraph()</code> inside your dialog class <code>HTMLandGraphDlg</code>, which is called in JavaScript function <code>enterXval()</code> in order to move the vertical line when the user enter an x-value and hit the ENTER key.
</p>
<ol>

<li> Add the method and DECLARE_DISPATCH_MAP inside your dialog class.
<pre class="c" style="font-family:monospace;">public<span style="color: #339933;">:</span>
    DECLARE_DISPATCH_MAP

    <span style="color: #993333;">void</span> OnEnterXvalToUpdateGraph<span style="color: #009900;">&#40;</span>string strXValue<span style="color: #009900;">&#41;</span>
    <span style="color: #009900;">&#123;</span>
        GraphPage gp <span style="color: #339933;">=</span> m_gcCntrl.<span style="color: #202020;">GetPage</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
        <span style="color: #b1b100;">if</span><span style="color: #009900;">&#40;</span><span style="color: #339933;">!</span>gp<span style="color: #009900;">&#41;</span>
	    <span style="color: #b1b100;">return</span><span style="color: #339933;">;</span>
	GraphLayer gl <span style="color: #339933;">=</span> gp.<span style="color: #202020;">Layers</span><span style="color: #009900;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
	<span style="color: #b1b100;">if</span><span style="color: #009900;">&#40;</span><span style="color: #339933;">!</span>gl<span style="color: #009900;">&#41;</span>
	    <span style="color: #b1b100;">return</span><span style="color: #339933;">;</span>
	<span style="color: #993333;">double</span> xVal <span style="color: #339933;">=</span> <a href="http://www.opengroup.org/onlinepubs/009695399/functions/atof.html"><span style="color: #000066;">atof</span></a><span style="color: #009900;">&#40;</span>strXValue<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
	<span style="color: #b1b100;">if</span><span style="color: #009900;">&#40;</span>NANUM <span style="color: #339933;">==</span> xVal<span style="color: #009900;">&#41;</span><span style="color: #666666; font-style: italic;">//user has not entered pure numeric</span>
	    <span style="color: #b1b100;">return</span><span style="color: #339933;">;</span>
	GraphObject vline<span style="color: #339933;">;</span> 
	vline <span style="color: #339933;">=</span> gl.<span style="color: #202020;">GraphObjects</span><span style="color: #009900;">&#40;</span><span style="color: #ff0000;">&quot;Line&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> <span style="color: #666666; font-style: italic;">//access the vertical line in the graph</span>
	<span style="color: #b1b100;">if</span><span style="color: #009900;">&#40;</span><span style="color: #339933;">!</span>vline<span style="color: #009900;">&#41;</span>
	    <span style="color: #b1b100;">return</span><span style="color: #339933;">;</span>
	vline.<span style="color: #202020;">X</span> <span style="color: #339933;">=</span> xVal<span style="color: #339933;">;</span>
    <span style="color: #009900;">&#125;</span></pre>
<li> Map the method of your OriginC dialog class to this HTML dialog.
<pre class="c" style="font-family:monospace;">BEGIN_DISPATCH_MAP<span style="color: #009900;">&#40;</span>HTMLandGraphDlg<span style="color: #339933;">,</span> HTMLDlg<span style="color: #009900;">&#41;</span>
    DISP_FUNCTION<span style="color: #009900;">&#40;</span>HTMLandGraphDlg<span style="color: #339933;">,</span> OnEnterXvalToUpdateGraph<span style="color: #339933;">,</span> VTS_VOID<span style="color: #339933;">,</span> VTS_STR<span style="color: #009900;">&#41;</span>
END_DISPATCH_MAP</pre>
<table class="note">

<tr>
<td><b>Note:</b> More details of DISP_FUNCTION can be found <a href="../../OriginC/OCGuide/2nd_HTML_Dialog.html#Adding_JavaScript_Callable_Prototypes_in_OriginC" title="OCGuide:2nd HTML Dialog">here</a>.
</td></tr></table>
</ol>
<h2><a name="Adding_Labtalk_Callable_Prototypes_in_Origin_C"></a><span class="mw-headline">Adding Labtalk Callable Prototypes in Origin C</span></h2>
<p>Youâ€™ve almost created a nice dialog, but it needs an additional item to finish it.
<br />
You must remember that you have written a script to call a function <code>line_move()</code> in LabTalk when you set your vertical line properties in <b>Properties</b> dialog. 
<br />
Now you should add this function in OriginC to be triggered when the vertical line is moved:
</p>
<pre class="c" style="font-family:monospace;"><span style="color: #993333;">static</span> HTMLandGraphDlg<span style="color: #339933;">*</span> s_pDlg <span style="color: #339933;">=</span> NULL<span style="color: #339933;">;</span><span style="color: #666666; font-style: italic;">// we need this such that dialog class can be used from LabTalk</span>

<span style="color: #666666; font-style: italic;">//this is the OC function to be called from LabTalk</span>
<span style="color: #993333;">void</span> line_move<span style="color: #009900;">&#40;</span><span style="color: #993333;">double</span> dVal<span style="color: #009900;">&#41;</span> <span style="color: #666666; font-style: italic;">//when the line moves, get the X-value and pass the value to JavaScript</span>
<span style="color: #009900;">&#123;</span>
   <span style="color: #b1b100;">if</span> <span style="color: #009900;">&#40;</span> s_pDlg <span style="color: #009900;">&#41;</span> <span style="color: #666666; font-style: italic;">//trigger only if move the line in this dialog</span>
		s_pDlg<span style="color: #339933;">-&gt;</span>OnMoveVlineToUpdateHtml<span style="color: #009900;">&#40;</span>dVal<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<span style="color: #009900;">&#125;</span></pre>
<table class="note">

<tr>
<td><b>Note:</b> In order for LabTalk to call the method within this dialog class, we need to declare a static <code>HTMLandGraphDlg</code> object.
</td></tr></table>
<h2><a name="Launching_The_Dialog"></a><span class="mw-headline">Launching The Dialog</span></h2>
<p>You are ready to launch the dialog.
</p>
<ol>
<li> Add a main function:
<pre class="c" style="font-family:monospace;"><span style="color: #993333;">void</span> HTMLandGraphDlgEx<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>
<span style="color: #009900;">&#123;</span>
    HTMLandGraphDlg dlg<span style="color: #339933;">;</span>
    s_pDlg <span style="color: #339933;">=</span> <span style="color: #339933;">&amp;</span>dlg<span style="color: #339933;">;</span>
    dlg.<span style="color: #202020;">DoModalEx</span><span style="color: #009900;">&#40;</span>GetWindow<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    s_pDlg <span style="color: #339933;">=</span> NULL<span style="color: #339933;">;</span>
<span style="color: #009900;">&#125;</span></pre>
<table class="note">

<tr>
<td><b>Note:</b> You should name the function the same with you wrote in ProjectEvents.OGS.
</td></tr></table>
<li> Save all the code and build it.
<li> Now, you double click the OPJ directly to lauch the dialog.
</ol>


