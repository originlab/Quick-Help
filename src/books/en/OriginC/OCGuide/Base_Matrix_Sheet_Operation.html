<h1 class="firstHeading">1.5.2.1 Basic Matrix Sheet Operation</h1><p>Examples in this section are similar to those found in the <a href="../../OriginC/OCGuide/Worksheet_Basic_Operation.html" title="OCGuide:Worksheet Basic Operation">Basic Worksheet Operation</a> section, because matrix sheet and worksheet are at the same level in the Origin object structure.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Add_New_Matrix_Sheet"><span class="tocnumber">1</span> <span class="toctext">Add New Matrix Sheet</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Activate_a_Matrixsheet"><span class="tocnumber">2</span> <span class="toctext">Activate a Matrixsheet</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Delete_Matrixsheet"><span class="tocnumber">3</span> <span class="toctext">Delete Matrixsheet</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Access_Matrixsheets_in_Matrixbookmatrixbook.2C_Get_One_Sheetmatrixbook.2C_Get_Name"><span class="tocnumber">4</span> <span class="toctext">Access Matrixsheets in Matrixbook<span class="OIndex" style="display:none">matrixbook, Get One Sheet</span><span class="OIndex" style="display:none">matrixbook, Get Name</span></span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Modify_Matrixsheet_Properties"><span class="tocnumber">5</span> <span class="toctext">Modify Matrixsheet Properties</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#Get_and_Set_Dimensions"><span class="tocnumber">5.1</span> <span class="toctext">Get and Set Dimensions</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Get_and_Set_Labels"><span class="tocnumber">5.2</span> <span class="toctext">Get and Set Labels</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Format_Matrixsheet"><span class="tocnumber">5.3</span> <span class="toctext">Format Matrixsheet</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Get_and_Set_Matrix_Cell_Text_Color"><span class="tocnumber">5.4</span> <span class="toctext">Get and Set Matrix Cell Text Color</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="Add_New_Matrix_Sheet"></a><span class="mw-headline">Add New Matrix Sheet</span></h2>
<p><span class="OIndex" style="display:none">Matrixbook, Add One Sheet</span><span class="OIndex" style="display:none">Matrixbook, Activate a Sheet</span>Add a matrixsheet in a matrixbook using the <a href="../../OriginC/OriginC/Page-AddLayer.html" title="OriginC:Page-AddLayer">AddLayer</a> method.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Access the matrixbook named &quot;MBook1&quot;</span>
MatrixPage mp<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;MBook1&quot;</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Add a new sheet to the matrixbook</span>
<span style="color: #0000ff;">int</span> index <span style="color: #000080;">=</span> mp.<span style="color: #000000;">AddLayer</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;New Matrix Sheet&quot;</span><span style="color: #000000;">&#41;</span>; 

<span style="color: #008000;">// Access the new matrixsheet</span>
MatrixLayer mlayerNew <span style="color: #000080;">=</span> mp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span>index<span style="color: #000000;">&#41;</span>;</pre>
<h2><a name="Activate_a_Matrixsheet"></a><span class="mw-headline">Activate a Matrixsheet</span></h2>
<p><span class="OIndex" style="display:none">Active Matrixsheet</span><span class="OIndex" style="display:none">Active Window</span><span class="OIndex" style="display:none">Active Workbook</span><span class="OIndex" style="display:none">Active Matrixbook</span>To make a matrixsheet in matrixbook to be activated, the function <a href="../../OriginC/OriginC/Set_active_layer_(global_function).html" title="OriginC:Set active layer (global function)">set_active_layer</a> can be used.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Access a matrixsheet by full name</span>
MatrixLayer mLayer<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;[MBook1]MSheet1&quot;</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Set this matrixsheet to be active</span>
set_active_layer<span style="color: #000000;">&#40;</span>mLayer<span style="color: #000000;">&#41;</span>;</pre>
<h2><a name="Delete_Matrixsheet"></a><span class="mw-headline">Delete Matrixsheet</span></h2>
<p>Use the <a href="../../OriginC/OriginC/OriginObject-Destroy.html" title="OriginC:OriginObject-Destroy">Destroy</a> method to delete a matrixsheet.
</p>
<pre class="oc" style="font-family:monospace;">MatrixLayer ly <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> ly <span style="color: #000000;">&#41;</span> <span style="color: #008000;">// If the active layer is a matrixsheet</span>
    ly.<span style="color: #000000;">Destroy</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Delete the matrixsheet</span></pre>
<h2><a name="Access_Matrixsheets_in_Matrixbookmatrixbook.2C_Get_One_Sheetmatrixbook.2C_Get_Name"></a><span class="mw-headline">Access Matrixsheets in Matrixbook<span class="OIndex" style="display:none">matrixbook, Get One Sheet</span><span class="OIndex" style="display:none">matrixbook, Get Name</span></span></h2>
<p>Similar to accessing worksheets in workbook, matrixsheets in matrixbook can also be accessed by the following ways.
</p>
<ol>
<li>By full layer name.</li>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Full matrixsheet name</span>
string strFullName <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;[MBook1]MSheet1!&quot;</span>;

<span style="color: #008000;">// Construct a matrixsheet instance and attach it to the named sheet</span>
MatrixLayer matLy1<span style="color: #000000;">&#40;</span>strFullName<span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Attach an existing matrixsheet instance to the named sheet</span>
matLy2.<span style="color: #000000;">Attach</span><span style="color: #000000;">&#40;</span>strFullName<span style="color: #000000;">&#41;</span>;</pre>
<li>A matrixbook constains a collection of matrix layers. Loop through all matrix layers in a specified matrixbook using the <b>foreach</b> statement.</li>
<pre class="oc" style="font-family:monospace;">MatrixPage matPage<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;MBook1&quot;</span><span style="color: #000000;">&#41;</span>;
foreach<span style="color: #000000;">&#40;</span>Layer ly in matPage.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#41;</span>
    out_str<span style="color: #000000;">&#40;</span>ly.<span style="color: #000000;">GetName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;</pre>
<li>Access a specified matrixsheet by its name or index.</li>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Assume there are at least two matrixsheets on the page MBook1,</span>
<span style="color: #008000;">// and they are named MSheet1 and MSheet2 separately.</span>
MatrixPage matPage<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;MBook1&quot;</span><span style="color: #000000;">&#41;</span>;
MatrixLayer lyFirst <span style="color: #000080;">=</span> matPage.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//by index</span>
MatrixLayer lySecond <span style="color: #000080;">=</span> matPage.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;MSheet2&quot;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//by name</span></pre>
</ol>
<h2><a name="Modify_Matrixsheet_Properties"></a><span class="mw-headline">Modify Matrixsheet Properties</span></h2>
<h3><a name="Get_and_Set_Dimensions"></a><span class="mw-headline">Get and Set Dimensions</span></h3>
<p>In Origin, all matrix objects in matrixsheet share the same dimension (the same number of columns and rows).
</p>
<ol>
<li>To get number of rows and columns in a matrixsheet, you can get the first matrix object of a matrixsheet, and then use the methods (<a href="../../OriginC/OriginC/MatrixObject-GetNumCols.html" title="OriginC:MatrixObject-GetNumCols">GetNumCols</a> and <a href="../../OriginC/OriginC/MatrixObject-GetNumRows.html" title="OriginC:MatrixObject-GetNumRows">GetNumRows</a>) in <a href="../../OriginC/Category/MatrixObject_(class).html" title="Category:MatrixObject (class)">MatrixObject</a> class.</li>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// get num rows and cols</span>
MatrixLayer ml <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Get active matrixsheet	</span>
MatrixObject mo <span style="color: #000080;">=</span> ml.<span style="color: #000000;">MatrixObjects</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Get the first matrix object</span>

<span style="color: #0000ff;">int</span> nNumRows <span style="color: #000080;">=</span> mo.<span style="color: #000000;">GetNumRows</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// Get the row number</span>
<span style="color: #0000ff;">int</span> nNumCols <span style="color: #000080;">=</span> mo.<span style="color: #000000;">GetNumCols</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// Get the column number</span></pre>
<li>To set dimensions of a matrixsheet, you can use the <a href="../../OriginC/OriginC/MatrixLayer-SetSize.html" title="OriginC:MatrixLayer-SetSize">MatrixLayer::SetSize</a> method.</li>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// set num rows and cols</span>
MatrixLayer ml <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Get active matrixsheet</span>
ml.<span style="color: #000000;">SetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">5</span>, <span style="color: #0000dd;">5</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// Set dimensions by 5x5</span></pre>
<li>Also, the <a href="../../OriginC/Category/MatrixObject_(class).html" title="Category:MatrixObject (class)">MatrixObject</a> class has provided the <a href="../../OriginC/OriginC/MatrixObject-SetSize.html" title="OriginC:MatrixObject-SetSize">SetSize</a> method for setting dimensions. However, please note, even this method is defined in <a href="../../OriginC/Category/MatrixObject_(class).html" title="Category:MatrixObject (class)">MatrixObject</a>, what it changes is the matrixsheet's dimension, because all matrix objects in the same matrixsheet have the same dimensions.</li>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// set num rows and cols</span>
MatrixLayer ml <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Get active matrixsheet	</span>
MatrixObject mo <span style="color: #000080;">=</span> ml.<span style="color: #000000;">MatrixObjects</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Get the first object</span>

<span style="color: #0000ff;">int</span> nNumRows <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>, nNumCols <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>;
mo.<span style="color: #000000;">SetSize</span><span style="color: #000000;">&#40;</span>nNumRows, nNumCols<span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// Set dimensions by 5x5</span></pre>
<li>Matrices have numbered columns and rows which are mapped to linearly spaced X and Y values. You can use the <a href="../../OriginC/OriginC/MatrixObject-SetXY.html" title="OriginC:MatrixObject-SetXY">SetXY</a> method to set the XY mapping coordinates. Note: this method is available by matrix object, however, the XY mapping is shared by all matrix objects in the same matrixsheet.</li>
<pre class="oc" style="font-family:monospace;">MatrixLayer ml <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// Get active layer</span>
MatrixObject mo <span style="color: #000080;">=</span> ml.<span style="color: #000000;">MatrixObjects</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// Get the first matrix object</span>
mo.<span style="color: #000000;">SetXY</span><span style="color: #000000;">&#40;</span><span style="color: #000040;">-</span><span style="color: #0000dd;">10</span>, <span style="color: #0000dd;">20</span>, <span style="color: #000040;">-</span><span style="color: #0000dd;">2.3</span>, <span style="color: #0000dd;">12.4</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// Set X from -10 to 20, and Y from -2.3 to 12.4</span></pre>
</ol>
<h3><a name="Get_and_Set_Labels"></a><span class="mw-headline">Get and Set Labels</span></h3>
<p>A matrix label includes a Long Name, Units, and Comments for X, Y, Z. The labels of X and Y are for all matrix objects in the matrixsheet, the label of Z is for each matrix object. The following code shows how to get and set the labels.
</p>
<ol>
<li>Set XY Labels<span class="OIndex" style="display:none">Matrixsheet, Get/Set Labels for XY</span></li>
<pre class="oc" style="font-family:monospace;">MatrixPage mp<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;MBook1&quot;</span><span style="color: #000000;">&#41;</span>;
MatrixLayer ml <span style="color: #000080;">=</span> mp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// the first matrixsheet	</span>

Tree tr;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimensions</span>.<span style="color: #000000;">X</span>.<span style="color: #000000;">LongName</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;X Values&quot;</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimensions</span>.<span style="color: #000000;">X</span>.<span style="color: #000000;">Unit</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;X Units&quot;</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimensions</span>.<span style="color: #000000;">X</span>.<span style="color: #000000;">Comment</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;X Comment&quot;</span>;

tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimensions</span>.<span style="color: #000000;">Y</span>.<span style="color: #000000;">LongName</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Y Values&quot;</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimensions</span>.<span style="color: #000000;">Y</span>.<span style="color: #000000;">Unit</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Y Units&quot;</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimensions</span>.<span style="color: #000000;">Y</span>.<span style="color: #000000;">Comment</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Y Comment&quot;</span>;

<span style="color: #008000;">// Note, set format on matrixsheet for XY labels.</span>
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> ml.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">&#40;</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
	ml.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">&#40;</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;</pre>
<li>Get XY Labels</li>
<pre class="oc" style="font-family:monospace;">MatrixPage mp<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;MBook1&quot;</span><span style="color: #000000;">&#41;</span>;
MatrixLayer ml <span style="color: #000080;">=</span> mp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// the first matrixsheet</span>

<span style="color: #008000;">// Note, get XY labels from matrixsheet, not matrix object.</span>
Tree tr;
tr <span style="color: #000080;">=</span> ml.<span style="color: #000000;">GetFormat</span><span style="color: #000000;">&#40;</span>FPB_ALL, FOB_ALL, <span style="color: #0000ff;">TRUE</span>, <span style="color: #0000ff;">TRUE</span><span style="color: #000000;">&#41;</span>;

TreeNode trX <span style="color: #000080;">=</span> tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimensions</span>.<span style="color: #000000;">X</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #000040;">!</span>trX.<span style="color: #000000;">LongName</span>.<span style="color: #000000;">IsEmpty</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;X Long Name:&#160;%s<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, trX.<span style="color: #000000;">LongName</span>.<span style="color: #000000;">strVal</span><span style="color: #000000;">&#41;</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #000040;">!</span>trX.<span style="color: #000000;">Unit</span>.<span style="color: #000000;">IsEmpty</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;X Unit:&#160;%s<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, trX.<span style="color: #000000;">Unit</span>.<span style="color: #000000;">strVal</span><span style="color: #000000;">&#41;</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #000040;">!</span>trX.<span style="color: #000000;">Comment</span>.<span style="color: #000000;">IsEmpty</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;X Comment:&#160;%s<span style="color: #666666; font-weight: bold;">\n</span><span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, trX.<span style="color: #000000;">Comment</span>.<span style="color: #000000;">strVal</span><span style="color: #000000;">&#41;</span>;

TreeNode <span style="color: #0000ff;">trY</span> <span style="color: #000080;">=</span> tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Dimensions</span>.<span style="color: #000000;">Y</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #000040;">!</span><span style="color: #0000ff;">trY</span>.<span style="color: #000000;">LongName</span>.<span style="color: #000000;">IsEmpty</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Y Long Name:&#160;%s<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, <span style="color: #0000ff;">trY</span>.<span style="color: #000000;">LongName</span>.<span style="color: #000000;">strVal</span><span style="color: #000000;">&#41;</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #000040;">!</span><span style="color: #0000ff;">trY</span>.<span style="color: #000000;">Unit</span>.<span style="color: #000000;">IsEmpty</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Y Unit:&#160;%s<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, <span style="color: #0000ff;">trY</span>.<span style="color: #000000;">Unit</span>.<span style="color: #000000;">strVal</span><span style="color: #000000;">&#41;</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #000040;">!</span><span style="color: #0000ff;">trY</span>.<span style="color: #000000;">Comment</span>.<span style="color: #000000;">IsEmpty</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Y Comment:&#160;%s<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, <span style="color: #0000ff;">trY</span>.<span style="color: #000000;">Comment</span>.<span style="color: #000000;">strVal</span><span style="color: #000000;">&#41;</span>;</pre>
<li>Set Z Labels<span class="OIndex" style="display:none">Matrixsheet, Get/Set Labels for Z</span></li>
<pre class="oc" style="font-family:monospace;">MatrixPage mp<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;MBook1&quot;</span><span style="color: #000000;">&#41;</span>;
MatrixLayer ml <span style="color: #000080;">=</span> mp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// the first matrixsheet</span>
MatrixObject mo <span style="color: #000080;">=</span> ml.<span style="color: #000000;">MatrixObjects</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;<span style="color: #008000;">// the first matrix object</span>

<span style="color: #008000;">// construct format tree and assign string value to tree nodes</span>
Tree tr;	
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">LongName</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Z Long Name&quot;</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Unit</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Z Units&quot;</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Comment</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Z Comment&quot;</span>;

<span style="color: #008000;">// Note, here apply format on matrix object to set Z labels, not matrixsheet.</span>
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> mo.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">&#40;</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span> <span style="color: #008000;">// add id for each tree node</span>
	mo.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">&#40;</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;	<span style="color: #008000;">// do apply</span></pre>
<li>Get Z Labels</li>
<pre class="oc" style="font-family:monospace;">MatrixPage mp<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;MBook1&quot;</span><span style="color: #000000;">&#41;</span>;
MatrixLayer ml <span style="color: #000080;">=</span> mp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// the first matrixsheet</span>
MatrixObject mo <span style="color: #000080;">=</span> ml.<span style="color: #000000;">MatrixObjects</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;

Tree tr;	
tr <span style="color: #000080;">=</span> mo.<span style="color: #000000;">GetFormat</span><span style="color: #000000;">&#40;</span>FPB_ALL, FOB_ALL, <span style="color: #0000ff;">TRUE</span>, <span style="color: #0000ff;">TRUE</span><span style="color: #000000;">&#41;</span>;

<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Z Short Name:&#160;%s<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">ShortName</span>.<span style="color: #000000;">strVal</span><span style="color: #000000;">&#41;</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #000040;">!</span>tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">LongName</span>.<span style="color: #000000;">IsEmpty</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span><span style="color: #008000;">// if not empty</span>
	<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Z Long Name is&#160;%s<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">LongName</span>.<span style="color: #000000;">strVal</span><span style="color: #000000;">&#41;</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #000040;">!</span>tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Unit</span>.<span style="color: #000000;">IsEmpty</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Z Unit is&#160;%s<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Unit</span>.<span style="color: #000000;">strVal</span><span style="color: #000000;">&#41;</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #000040;">!</span>tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Comment</span>.<span style="color: #000000;">IsEmpty</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Z Comment is&#160;%s<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Comment</span>.<span style="color: #000000;">strVal</span><span style="color: #000000;">&#41;</span>;</pre>
</ol>
<h3><a name="Format_Matrixsheet"></a><span class="mw-headline">Format Matrixsheet</span></h3>
<p>A matrixsheet can be formatted programmatically using a theme tree.
</p><p>The example below formats a block of cells in the active matrixsheet to have a blue background and light-magenta text.
</p>
<pre class="oc" style="font-family:monospace;">MatrixLayer ml <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
 
Tree tr;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">CommonStyle</span>.<span style="color: #000000;">Fill</span>.<span style="color: #000000;">FillColor</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> SYSCOLOR_BLUE;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">CommonStyle</span>.<span style="color: #000000;">Color</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> SYSCOLOR_LTMAGENTA;
 
DataRange dr;
dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #0000ff;">NULL</span>, ml, <span style="color: #0000dd;">2</span>, <span style="color: #0000dd;">2</span>, <span style="color: #0000dd;">5</span>, <span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// first row, col, last row, col</span>
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> dr.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">&#40;</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
    dr.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">&#40;</span>tr, <span style="color: #0000ff;">TRUE</span>, <span style="color: #0000ff;">TRUE</span><span style="color: #000000;">&#41;</span>;</pre>
<h3><a name="Get_and_Set_Matrix_Cell_Text_Color"></a><span class="mw-headline">Get and Set Matrix Cell Text Color</span></h3>
<p>The next example shows how to get and set the text color of a cell.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Wrap the 'set' code into a simpler utility function.</span>
<span style="color: #0000ff;">bool</span> setCellTextColor<span style="color: #000000;">&#40;</span>Datasheet<span style="color: #000040;">&amp;</span> ds, <span style="color: #0000ff;">int</span> row, <span style="color: #0000ff;">int</span> col, uint color<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    Grid grid;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #000040;">!</span>grid.<span style="color: #000000;">Attach</span><span style="color: #000000;">&#40;</span>ds<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
        <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span>;
    vector<span style="color: #000080;">&lt;</span>uint<span style="color: #000080;">&gt;</span> vTextColor<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
    vTextColor<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> color;
    <span style="color: #0000ff;">return</span> grid.<span style="color: #000000;">SetCellTextColors</span><span style="color: #000000;">&#40;</span>vTextColor, col, row, row<span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span>
 
<span style="color: #008000;">// Wrap the 'get' code into a simpler utility function.</span>
<span style="color: #0000ff;">bool</span> getCellTextColor<span style="color: #000000;">&#40;</span>Datasheet<span style="color: #000040;">&amp;</span> ds, <span style="color: #0000ff;">int</span> row, <span style="color: #0000ff;">int</span> col, uint<span style="color: #000040;">&amp;</span> color<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    Grid grid;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #000040;">!</span>grid.<span style="color: #000000;">Attach</span><span style="color: #000000;">&#40;</span>ds<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
        <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span>;
    vector<span style="color: #000080;">&lt;</span>uint<span style="color: #000080;">&gt;</span> vTextColor;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #000040;">!</span>grid.<span style="color: #000000;">GetCellTextColors</span><span style="color: #000000;">&#40;</span>vTextColor, col, row, row<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
        <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span>;
    color <span style="color: #000080;">=</span> vTextColor<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#93;</span>;
    <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span>;
<span style="color: #000000;">&#125;</span>
 
<span style="color: #008000;">// Simple function for testing the above utility functions.</span>
<span style="color: #0000ff;">void</span> testCellTextColor<span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> nRow <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>, <span style="color: #0000ff;">int</span> nCol <span style="color: #000080;">=</span> <span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    MatrixLayer ml <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #008000;">// nRow, nCol use LT/GUI indexing, 1-offset, but OC is 0-offset</span>
	<span style="color: #0000ff;">int</span> row <span style="color: #000080;">=</span> nRow<span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, col <span style="color: #000080;">=</span> nCol<span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>;
    setCellTextColor<span style="color: #000000;">&#40;</span>ml, row, col, SYSCOLOR_BLUE<span style="color: #000000;">&#41;</span>;
 
    uint color;
    getCellTextColor<span style="color: #000000;">&#40;</span>ml, row, col, color<span style="color: #000000;">&#41;</span>;
    <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;color ==&#160;%d<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, color<span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>






