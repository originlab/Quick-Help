<h1 class="firstHeading">1.9.4 Accessing Metadata</h1><p><br />
Metadata is information which refers to other data. Examples include the time at which data was originally collected, the operator of the instrument collecting the data and the temperature of a sample being investigated. Metadata can be stored in Projects, Pages, Layers and Columns.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Access_DataRangeProject.2C_Add_Range_VariableProject.2C_List_All_Range_Variables"><span class="tocnumber">1</span> <span class="toctext">Access DataRange<span class="OIndex" style="display:none">Project, Add Range Variable</span><span class="OIndex" style="display:none">Project, List All Range Variables</span></span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Access_Tree"><span class="tocnumber">2</span> <span class="toctext">Access Tree</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Access_a_Tree_in_a_ProjectProject.2C_Add_Tree_Variable"><span class="tocnumber">2.1</span> <span class="toctext">Access a Tree in a Project<span class="OIndex" style="display:none">Project, Add Tree Variable</span></span></a>
<ul>
<li class="toclevel-3 tocsection-4"><a href="#Add_Tree"><span class="tocnumber">2.1.1</span> <span class="toctext">Add Tree</span></a></li>
<li class="toclevel-3 tocsection-5"><a href="#Get_Tree"><span class="tocnumber">2.1.2</span> <span class="toctext">Get Tree</span></a></li>
<li class="toclevel-3 tocsection-6"><a href="#Get_the_Names_of_All_LabTalk_Trees"><span class="tocnumber">2.1.3</span> <span class="toctext">Get the Names of All LabTalk Trees</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-7"><a href="#Access_Tree_in_a_Worksheet"><span class="tocnumber">2.2</span> <span class="toctext">Access Tree in a Worksheet</span></a>
<ul>
<li class="toclevel-3 tocsection-8"><a href="#Add_Tree_2"><span class="tocnumber">2.2.1</span> <span class="toctext">Add Tree</span></a></li>
<li class="toclevel-3 tocsection-9"><a href="#Get_Tree_2"><span class="tocnumber">2.2.2</span> <span class="toctext">Get Tree</span></a></li>
<li class="toclevel-3 tocsection-10"><a href="#Get_the_Names_of_All_Trees"><span class="tocnumber">2.2.3</span> <span class="toctext">Get the Names of All Trees</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-11"><a href="#Access_Tree_in_a_Worksheet_Column"><span class="tocnumber">2.3</span> <span class="toctext">Access Tree in a Worksheet Column</span></a>
<ul>
<li class="toclevel-3 tocsection-12"><a href="#Add_Tree_3"><span class="tocnumber">2.3.1</span> <span class="toctext">Add Tree</span></a></li>
<li class="toclevel-3 tocsection-13"><a href="#Get_Tree_3"><span class="tocnumber">2.3.2</span> <span class="toctext">Get Tree</span></a></li>
<li class="toclevel-3 tocsection-14"><a href="#Get_the_Names_of_All_Trees_2"><span class="tocnumber">2.3.3</span> <span class="toctext">Get the Names of All Trees</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-15"><a href="#Access_Import_File_Tree_NodesImport_File.2C_Get_Storage_Tree_by_Name"><span class="tocnumber">2.4</span> <span class="toctext">Access Import File Tree Nodes<span class="OIndex" style="display:none">Import File, Get Storage Tree by Name</span></span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#Access_Report_Sheet_TreeReport_Sheet.2C_Get_Result_Tree"><span class="tocnumber">2.5</span> <span class="toctext">Access Report Sheet Tree<span class="OIndex" style="display:none">Report Sheet, Get Result Tree</span></span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="Access_DataRangeProject.2C_Add_Range_VariableProject.2C_List_All_Range_Variables"></a><span class="mw-headline">Access DataRange<span class="OIndex" style="display:none">Project, Add Range Variable</span><span class="OIndex" style="display:none">Project, List All Range Variables</span></span></h2>
<p>The Origin C Project class provides methods to add, get, and remove an Origin C DataRange object to and from the current project.
</p>
<pre class="oc" style="font-family:monospace;">Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;

DataRange dr;                   <span style="color: #008000;">// Construct the range object</span>
dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;X&quot;</span>, wks, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">0</span>, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Add whole worksheet to range</span>
dr.<span style="color: #000000;">SetName</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Range1&quot;</span><span style="color: #000000;">&#41;</span>;           <span style="color: #008000;">// Set range name</span>
<span style="color: #0000ff;">int</span> UID <span style="color: #000080;">=</span> dr.<span style="color: #000000;">GetUID</span><span style="color: #000000;">&#40;</span><span style="color: #0000ff;">TRUE</span><span style="color: #000000;">&#41;</span>;      <span style="color: #008000;">// Get Unique ID for the range object</span>

<span style="color: #0000ff;">int</span> nn <span style="color: #000080;">=</span> Project.<span style="color: #000000;">AddDataRange</span><span style="color: #000000;">&#40;</span>dr<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Add range to project</span></pre>
<p>In the Command Window or Script Window you can use the LabTalk command <b>list r</b> to list all the DataRange objects in the current project.
</p>
<h2><a name="Access_Tree"></a><span class="mw-headline">Access Tree</span></h2>
<h3><a name="Access_a_Tree_in_a_ProjectProject.2C_Add_Tree_Variable"></a><span class="mw-headline">Access a Tree in a Project<span class="OIndex" style="display:none">Project, Add Tree Variable</span></span></h3>
<h4><a name="Add_Tree"></a><span class="mw-headline">Add Tree</span></h4>
<p>This code declares a variable of type tree, assigns some data to nodes of the tree, and adds the tree to the current project.
</p>
<pre class="oc" style="font-family:monospace;">Tree tr;
tr.<span style="color: #000000;">FileInfo</span>.<span style="color: #000000;">name</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Test.XML&quot;</span>;
tr.<span style="color: #000000;">FileInfo</span>.<span style="color: #000000;">size</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">255</span>;

<span style="color: #008000;">// add tree variable to project</span>
<span style="color: #0000ff;">int</span> nNumTrees <span style="color: #000080;">=</span> Project.<span style="color: #000000;">AddTree</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Test&quot;</span>, tr<span style="color: #000000;">&#41;</span>; 
out_int<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;The number of trees in project: &quot;</span>, nNumTrees<span style="color: #000000;">&#41;</span>;</pre>
<p><br />
</p>
<h4><a name="Get_Tree"></a><span class="mw-headline">Get Tree</span></h4>
<p><span class="OIndex" style="display:none">Project, Get Tree Variable</span>
Likewise, a similar code extracts data stored in an existing tree variable named <i>Test</i> and puts it into a new tree variable named <i>trTest</i>:
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// get tree from project by name</span>
Tree trTest;
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> Project.<span style="color: #000000;">GetTree</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Test&quot;</span>, trTest<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
	out_tree<span style="color: #000000;">&#40;</span>trTest<span style="color: #000000;">&#41;</span>;</pre>
<h4><a name="Get_the_Names_of_All_LabTalk_Trees"></a><span class="mw-headline">Get the Names of All LabTalk Trees</span></h4>
<p><span class="OIndex" style="display:none">Project, Get the Names of All Tree Variables</span>
The <b><a href="../../OriginC/OriginC/Project-GetTreeNames.html" title="OriginC:Project-GetTreeNames">Project::GetTreeNames</a></b> method gets the names of all LabTalk tree variables in the project.  Here, the names are assigned to a string vector; the number of strings assigned is returned as an integer.
</p>
<pre class="oc" style="font-family:monospace;">vector<span style="color: #000080;">&lt;</span>string<span style="color: #000080;">&gt;</span> vsTreeNames;
<span style="color: #0000ff;">int</span> nNumTrees <span style="color: #000080;">=</span> Project.<span style="color: #000000;">GetTreeNames</span><span style="color: #000000;">&#40;</span>vsTreeNames<span style="color: #000000;">&#41;</span>;</pre>
<h3><a name="Access_Tree_in_a_Worksheet"></a><span class="mw-headline">Access Tree in a Worksheet</span></h3>
<p><b><a href="../../OriginC/OriginC/OriginObject-PutBinaryStorage.html" title="OriginC:OriginObject-PutBinaryStorage">OriginObject::PutBinaryStorage</a></b> is used to put a tree into many types of Origin object, for example, a WorksheetPage, Worksheet, Column, GraphPage, or MatrixPage.
</p>
<h4><a name="Add_Tree_2"></a><span class="mw-headline">Add Tree</span></h4>
<p><span class="OIndex" style="display:none">Worksheet, Add Tree Variable</span>
Keep an active worksheet window in the current project, to run the example code below. After running the code to add a user tree, right click on the title of the worksheet window, choose Show Organizer, and you will see the added user tree show up in the panel on the right.
</p>
<pre class="oc" style="font-family:monospace;">Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> wks <span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	Tree tr;
	tr.<span style="color: #000000;">name</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Jacky&quot;</span>;
	tr.<span style="color: #000000;">id</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">7856</span>;
	
	<span style="color: #008000;">// put tree with name wksTree to worksheet object</span>
	string strStorageName <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;wksTree&quot;</span>;
	wks.<span style="color: #000000;">PutBinaryStorage</span><span style="color: #000000;">&#40;</span>strStorageName, tr<span style="color: #000000;">&#41;</span>;	
<span style="color: #000000;">&#125;</span></pre>
<h4><a name="Get_Tree_2"></a><span class="mw-headline">Get Tree</span></h4>
<p><span class="OIndex" style="display:none">Worksheet, Get Tree Variable</span>
The <b><a href="../../OriginC/OriginC/OriginObject-GetBinaryStorage.html" title="OriginC:OriginObject-GetBinaryStorage">OriginObject::GetBinaryStorage</a></b> method is used to get a tree from an Origin object by name.
</p>
<pre class="oc" style="font-family:monospace;">Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> wks <span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>	
	Tree tr;
	string strStorageName <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;wksTree&quot;</span>;
	
	<span style="color: #008000;">// if the tree named wksTree is existed, return true.</span>
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> wks.<span style="color: #000000;">GetBinaryStorage</span><span style="color: #000000;">&#40;</span>strStorageName, tr<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
		out_tree<span style="color: #000000;">&#40;</span>tr<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// output tree </span>
<span style="color: #000000;">&#125;</span></pre>
<h4><a name="Get_the_Names_of_All_Trees"></a><span class="mw-headline">Get the Names of All Trees</span></h4>
<p><span class="OIndex" style="display:none">Worksheet, Get the Names of All Storages</span>
The <b><a href="../../OriginC/OriginC/OriginObject-GetStorageNames.html" title="OriginC:OriginObject-GetStorageNames">OriginObject::GetStorageNames</a></b> method gets the names of everything in storage in an Origin object. There are two storage types: INI and binary. Trees belong to binary storage, and the following example code shows how to get binary storage from a Worksheet.
</p>
<pre class="oc" style="font-family:monospace;">Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> wks <span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	<span style="color: #008000;">// get the names of all binary type storage </span>
	vector<span style="color: #000080;">&lt;</span>string<span style="color: #000080;">&gt;</span> vsNames;
	wks.<span style="color: #000000;">GetStorageNames</span><span style="color: #000000;">&#40;</span>vsNames, STORAGE_TYPE_BINARY<span style="color: #000000;">&#41;</span>; 
	
	<span style="color: #0000ff;">for</span><span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> nn <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; nn <span style="color: #000080;">&lt;</span> vsNames.<span style="color: #000000;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; nn<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span>
		out_str<span style="color: #000000;">&#40;</span>vsNames<span style="color: #000000;">&#91;</span>nn<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<h3><a name="Access_Tree_in_a_Worksheet_Column"></a><span class="mw-headline">Access Tree in a Worksheet Column</span></h3>
<p>For setting and getting a tree in a Worksheet Column, use the same methods for setting and getting a tree in a Worksheet, as described above.
</p>
<h4><a name="Add_Tree_3"></a><span class="mw-headline">Add Tree</span></h4>
<p><span class="OIndex" style="display:none">Column, Add Tree Variable</span>
</p>
<pre class="oc" style="font-family:monospace;">Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
Column col<span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;

Tree tr;
tr.<span style="color: #000000;">test</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;This is a column&quot;</span>;
tr.<span style="color: #000000;">value</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0.15</span>;

col.<span style="color: #000000;">PutBinaryStorage</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;colTree&quot;</span>, tr<span style="color: #000000;">&#41;</span>;</pre>
<h4><a name="Get_Tree_3"></a><span class="mw-headline">Get Tree</span></h4>
<p><span class="OIndex" style="display:none">Column, Get Tree Variable</span>
</p>
<pre class="oc" style="font-family:monospace;">Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
Column col<span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;

Tree tr;	
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> col.<span style="color: #000000;">GetBinaryStorage</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;colTree&quot;</span>, tr<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
	out_tree<span style="color: #000000;">&#40;</span>tr<span style="color: #000000;">&#41;</span>;</pre>
<h4><a name="Get_the_Names_of_All_Trees_2"></a><span class="mw-headline">Get the Names of All Trees</span></h4>
<p><span class="OIndex" style="display:none">Column, Get the Names of All Storages</span>
</p>
<pre class="oc" style="font-family:monospace;">Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
Column col<span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// get the names of all binary type storage </span>
vector<span style="color: #000080;">&lt;</span>string<span style="color: #000080;">&gt;</span> vsNames;
col.<span style="color: #000000;">GetStorageNames</span><span style="color: #000000;">&#40;</span>vsNames, STORAGE_TYPE_BINARY<span style="color: #000000;">&#41;</span>; 

<span style="color: #0000ff;">for</span><span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> nn <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; nn <span style="color: #000080;">&lt;</span> vsNames.<span style="color: #000000;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; nn<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span>
	out_str<span style="color: #000000;">&#40;</span>vsNames<span style="color: #000000;">&#91;</span>nn<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span>;</pre>
<h3><a name="Access_Import_File_Tree_NodesImport_File.2C_Get_Storage_Tree_by_Name"></a><span class="mw-headline">Access Import File Tree Nodes<span class="OIndex" style="display:none">Import File, Get Storage Tree by Name</span></span></h3>
<p>After importing data into a worksheet, Origin stores metadata in a special tree-like structure at the page level. Basic information about the file can be retrieved and put into a tree.
</p>
<pre class="oc" style="font-family:monospace;">Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
WorksheetPage wksPage <span style="color: #000080;">=</span> wks.<span style="color: #000000;">GetPage</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;

storage st;
st <span style="color: #000080;">=</span> wksPage.<span style="color: #000000;">GetStorage</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;system&quot;</span><span style="color: #000000;">&#41;</span>;   

Tree    tr;
tr <span style="color: #000080;">=</span> st;

<span style="color: #0000ff;">double</span> dDate <span style="color: #000080;">=</span> tr.<span style="color: #000000;">Import</span>.<span style="color: #000000;">FileDate</span>.<span style="color: #000000;">dVal</span>;    
<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;File Date:&#160;%s<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, get_date_str<span style="color: #000000;">&#40;</span>dDate, LDF_SHORT_AND_HHMMSS_SEPARCOLON<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;File Name:&#160;%s<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, tr.<span style="color: #000000;">Import</span>.<span style="color: #000000;">FileName</span>.<span style="color: #000000;">strVal</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;File Path:&#160;%s<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, tr.<span style="color: #000000;">Import</span>.<span style="color: #000000;">FilePath</span>.<span style="color: #000000;">strVal</span><span style="color: #000000;">&#41;</span>;</pre>
<h3><a name="Access_Report_Sheet_TreeReport_Sheet.2C_Get_Result_Tree"></a><span class="mw-headline">Access Report Sheet Tree<span class="OIndex" style="display:none">Report Sheet, Get Result Tree</span></span></h3>
<p>Analysis Report sheets are specially formatted Worksheets based on a tree structure. You can get the report tree from a report sheet as below.
</p>
<pre class="oc" style="font-family:monospace;">Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;

Tree trReport;
uint uid; <span style="color: #008000;">// to receive the UID of the report range</span>
<span style="color: #008000;">// true to translate the escaped operation strings(ex.&#160;?$OP:A=1) </span>
<span style="color: #008000;">// to real dataset name in the returned tree </span>
<span style="color: #0000ff;">bool</span> bTranslate <span style="color: #000080;">=</span> <span style="color: #0000ff;">true</span>; 
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> wks.<span style="color: #000000;">GetReportTree</span><span style="color: #000000;">&#40;</span>trReport, <span style="color: #000040;">&amp;</span>uid, <span style="color: #0000dd;">0</span>, GRT_TYPE_RESULTS, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	out_tree<span style="color: #000000;">&#40;</span>trReport<span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>






