<h1 class="firstHeading">1.7.3 Customizing Data Plots</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Adding_Data_MarkerGraph_Layer.2C_Add_Data_MarkerGraph_Layer.2C_Remove_Data_MarkerGraph_Layer.2C_Set_Data_Marker"><span class="tocnumber">1</span> <span class="toctext">Adding Data Marker<span class="OIndex" style="display:none">Graph Layer, Add Data Marker</span><span class="OIndex" style="display:none">Graph Layer, Remove Data Marker</span><span class="OIndex" style="display:none">Graph Layer, Set Data Marker</span></span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Setting_ColorGraph_Layer.2C_Set_Color_on_DataPlot"><span class="tocnumber">2</span> <span class="toctext">Setting Color<span class="OIndex" style="display:none">Graph Layer, Set Color on DataPlot</span></span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Getting_Format_TreeGraph_Layer.2C_Get_Format_on_DataPlot"><span class="tocnumber">3</span> <span class="toctext">Getting Format Tree<span class="OIndex" style="display:none">Graph Layer, Get Format on DataPlot</span></span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Setting_Format_on_Line_PlotGraph_Layer.2C_Set_Format_on_Line_Plot"><span class="tocnumber">4</span> <span class="toctext">Setting Format on Line Plot<span class="OIndex" style="display:none">Graph Layer, Set Format on Line Plot</span></span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Copying_Format_from_One_Data_Plot_to_AnotherCopy_FormatOrigin_Object.2C_Copy_Format"><span class="tocnumber">5</span> <span class="toctext">Copying Format from One Data Plot to Another<span class="OIndex" style="display:none">Copy Format</span><span class="OIndex" style="display:none">Origin Object, Copy Format</span></span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#Copying_Format_via_Theme_FileTheme_File"><span class="tocnumber">5.1</span> <span class="toctext">Copying Format via Theme File<span class="OIndex" style="display:none">Theme File</span></span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Copying_Format_via_Tree"><span class="tocnumber">5.2</span> <span class="toctext">Copying Format via Tree</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8"><a href="#Setting_Format_on_Scatter_PlotGraph_Layer.2C_Set_Format_on_Scatter_Plot"><span class="tocnumber">6</span> <span class="toctext">Setting Format on Scatter Plot<span class="OIndex" style="display:none">Graph Layer, Set Format on Scatter Plot</span></span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Setting_Format_on_Grouped_Line_.2B_Symbol_PlotsGraph_Layer.2C_Set_Format_on_Grouping_Plot"><span class="tocnumber">7</span> <span class="toctext">Setting Format on Grouped Line + Symbol Plots<span class="OIndex" style="display:none">Graph Layer, Set Format on Grouping Plot</span></span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#Setting_Colormap_Settings"><span class="tocnumber">8</span> <span class="toctext">Setting Colormap Settings</span></a></li>
</ul>
</div>

<h2><a name="Adding_Data_MarkerGraph_Layer.2C_Add_Data_MarkerGraph_Layer.2C_Remove_Data_MarkerGraph_Layer.2C_Set_Data_Marker"></a><span class="mw-headline">Adding Data Marker<span class="OIndex" style="display:none">Graph Layer, Add Data Marker</span><span class="OIndex" style="display:none">Graph Layer, Remove Data Marker</span><span class="OIndex" style="display:none">Graph Layer, Set Data Marker</span></span></h2>
<p>Origin C supports the following methods for customizing data markers.
</p>
<ul><li> <b><a href="../../OriginC/OriginC/DataPlot-AddDataMarkers.html" title="OriginC:DataPlot-AddDataMarkers">DataPlot::AddDataMarkers</a></b> to add a data marker on the data plot to select a sub range</li>
<li> <b><a href="../../OriginC/OriginC/DataPlot-SetDataMarkers.html" title="OriginC:DataPlot-SetDataMarkers">DataPlot::SetDataMarkers</a></b> to change the position of the present data marker</li>
<li> <b><a href="../../OriginC/OriginC/DataPlot-GetDataMarkers.html" title="OriginC:DataPlot-GetDataMarkers">DataPlot::GetDataMarkers</a></b> to get all existing data plots</li>
<li> <b><a href="../../OriginC/OriginC/DataPlot-RemoveDataMarker.html" title="OriginC:DataPlot-RemoveDataMarker">DataPlot::RemoveDataMarker</a></b> to remove the specified data marker. </li></ul>
<p>The following code shows how to add two data markers to the active graph window. 
</p>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
DataPlot dp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// the indices of the data markers</span>
vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> vnBegin <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">9</span><span style="color: #000000;">&#125;</span>;
vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> vnEnd <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">4</span>, <span style="color: #0000dd;">14</span><span style="color: #000000;">&#125;</span>;

<span style="color: #008000;">// to add two data markers</span>
<span style="color: #0000ff;">int</span> nRet <span style="color: #000080;">=</span> dp.<span style="color: #000000;">AddDataMarkers</span><span style="color: #000000;">&#40;</span>vnBegin, vnEnd<span style="color: #000000;">&#41;</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> nRet <span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Add data marker successfully.&quot;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<p>The code below shows how to change the position of the present data marker.
</p>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
DataPlot dp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// the indices of the data markers</span>
vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> vnBegin <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">11</span>, <span style="color: #0000dd;">2</span><span style="color: #000000;">&#125;</span>;
vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> vnEnd <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">19</span>, <span style="color: #0000dd;">5</span><span style="color: #000000;">&#125;</span>;
vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> vnIndices <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">0</span><span style="color: #000000;">&#125;</span>;

<span style="color: #008000;">// to add two data markers</span>
<span style="color: #0000ff;">int</span> nRet <span style="color: #000080;">=</span> dp.<span style="color: #000000;">SetDataMarkers</span><span style="color: #000000;">&#40;</span>vnBegin, vnEnd, vnIndices<span style="color: #000000;">&#41;</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> nRet <span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Set data marker successfully.&quot;</span><span style="color: #000000;">&#41;</span>;
	gl.<span style="color: #000000;">GetPage</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>.<span style="color: #000000;">Refresh</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Setting_ColorGraph_Layer.2C_Set_Color_on_DataPlot"></a><span class="mw-headline">Setting Color<span class="OIndex" style="display:none">Graph Layer, Set Color on DataPlot</span></span></h2>
<p>The following code shows how to set the color of the data plot.
</p>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
DataPlot dp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;

<span style="color: #0000ff;">bool</span> bRepaint <span style="color: #000080;">=</span> <span style="color: #0000ff;">true</span>;
dp.<span style="color: #000000;">SetColor</span><span style="color: #000000;">&#40;</span>SYSCOLOR_GREEN, bRepaint<span style="color: #000000;">&#41;</span>;</pre>
<h2><a name="Getting_Format_TreeGraph_Layer.2C_Get_Format_on_DataPlot"></a><span class="mw-headline">Getting Format Tree<span class="OIndex" style="display:none">Graph Layer, Get Format on DataPlot</span></span></h2>
<p><i>OriginObject::GetFormat</i> and <i>OriginObject::ApplyFormat</i> are used to get and set Origin object formats.  The following getting, setting and copying format mechanisms can be used for all Origin objects whose classes derive from the OriginObject base class (see Reference: <a href="../../OriginC/OCGuide/Class_Hierarchy.html" title="OCGuide:Class Hierarchy">Class Hierarchy</a>).  For example, the Origin objects can be objects of the <i>DataPlot</i> class, <i>Worksheet</i> class, <i>WorksheetPage</i> class, <i>MatrixLayer</i> class, <i>MatrixPage</i> class, <i>GraphLayer</i> class, or <i>GraphPage</i> class.
</p><p>The <i>DataPlot</i> class derives from the <i>DataObjectBase</i> class, and the <i>DataObjectBase</i> class derives from the <i>OriginObject</i> class, so we can call <i>DataPlot::GetFormat</i> to get the format tree structure. 
</p><p>There are two ways to see the format tree structure via the following code. 
</p>
<ul><li> Set a break point on the <i>GetFormat</i> line in the following code, activate one data plot, run the code, press F10 (Step Over) to execute the <i>GetFormat</i> line,  and see the details of the format tree in the Code Builder Local Variables Window <b>tr</b> variable. (press Alt+4 to open/hide the Local Variables window).</li>
<li> Use the last line, <i>out_tree(tr);</i>, to print out the format tree.</li></ul>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
DataPlot dp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">&#40;</span><span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Get the active data plot</span>
 
<span style="color: #008000;">// Different plot types(for example, Line, Box Chart...) have </span>
<span style="color: #008000;">// different structure in the format tree.</span>
Tree tr;
 
<span style="color: #008000;">// Get the format tree to see details of the tree structure.</span>
tr <span style="color: #000080;">=</span> dp.<span style="color: #000000;">GetFormat</span><span style="color: #000000;">&#40;</span>FPB_ALL, FOB_ALL, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;

out_tree<span style="color: #000000;">&#40;</span>tr<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// print out the format tree.</span></pre>
<h2><a name="Setting_Format_on_Line_PlotGraph_Layer.2C_Set_Format_on_Line_Plot"></a><span class="mw-headline">Setting Format on Line Plot<span class="OIndex" style="display:none">Graph Layer, Set Format on Line Plot</span></span></h2>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
DataPlot dp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">&#40;</span><span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Get the active data plot</span>
  
<span style="color: #008000;">// Set format on a line plot</span>
<span style="color: #008000;">// Note: See the previous section to get the structure of format tree</span>
Tree tr;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Line</span>.<span style="color: #000000;">Connect</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>; <span style="color: #008000;">// 2 for 2 point segment</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Line</span>.<span style="color: #000000;">Color</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> RGB2OCOLOR<span style="color: #000000;">&#40;</span>RGB<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">100</span>, <span style="color: #0000dd;">100</span>, <span style="color: #0000dd;">220</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Line</span>.<span style="color: #000000;">Width</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1.5</span>;
 
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> dp.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">&#40;</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    <span style="color: #0000ff;">bool</span> bRet <span style="color: #000080;">=</span> dp.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">&#40;</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>; 
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Copying_Format_from_One_Data_Plot_to_AnotherCopy_FormatOrigin_Object.2C_Copy_Format"></a><span class="mw-headline">Copying Format from One Data Plot to Another<span class="OIndex" style="display:none">Copy Format</span><span class="OIndex" style="display:none">Origin Object, Copy Format</span></span></h2>
<h3><a name="Copying_Format_via_Theme_FileTheme_File"></a><span class="mw-headline">Copying Format via Theme File<span class="OIndex" style="display:none">Theme File</span></span></h3>
<p>Getting and saving a format tree from a data plot into a theme file, then loading the theme file to a tree and applying the format tree to another data plot. 
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Save plot settings from Graph1 to a theme file</span>
GraphPage gpSource<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Graph1&quot;</span><span style="color: #000000;">&#41;</span>;
GraphLayer glSource <span style="color: #000080;">=</span> gpSource.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
DataPlot dpSource <span style="color: #000080;">=</span> glSource.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;

Tree tr;
tr <span style="color: #000080;">=</span> dpSource.<span style="color: #000000;">GetFormat</span><span style="color: #000000;">&#40;</span>FPB_ALL, FOB_ALL, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;
string strTheme <span style="color: #000080;">=</span> GetAppPath<span style="color: #000000;">&#40;</span><span style="color: #0000ff;">false</span><span style="color: #000000;">&#41;</span> <span style="color: #000040;">+</span> <span style="color: #ff00ff;">&quot;plotsettings.XML&quot;</span>;
tr.<span style="color: #000000;">Save</span><span style="color: #000000;">&#40;</span>strTheme<span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Load plot settings from a theme file to a tree, and apply format from </span>
<span style="color: #008000;">// tree to data plot object.</span>
GraphPage gpDest<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Graph2&quot;</span><span style="color: #000000;">&#41;</span>;
GraphLayer glDest <span style="color: #000080;">=</span> gpDest.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;	
DataPlot dpDest <span style="color: #000080;">=</span> glDest.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;

Tree tr2;
tr2.<span style="color: #000000;">Load</span><span style="color: #000000;">&#40;</span>strTheme<span style="color: #000000;">&#41;</span>;
dpDest.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">&#40;</span>tr2, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;</pre>
<h3><a name="Copying_Format_via_Tree"></a><span class="mw-headline">Copying Format via Tree</span></h3>
<p>Getting plot settings from one data plot to a tree, then apply settings from this tree to another data plot object. 
</p>
<pre class="oc" style="font-family:monospace;">GraphPage gpSource<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Graph1&quot;</span><span style="color: #000000;">&#41;</span>;
GraphLayer glSource <span style="color: #000080;">=</span> gpSource.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
DataPlot dpSource <span style="color: #000080;">=</span> glSource.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;

GraphPage gpDest<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Graph2&quot;</span><span style="color: #000000;">&#41;</span>;
GraphLayer glDest <span style="color: #000080;">=</span> gpDest.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;	
DataPlot dpDest <span style="color: #000080;">=</span> glDest.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Get format from source data plot</span>
Tree tr;
tr <span style="color: #000080;">=</span> dpSource.<span style="color: #000000;">GetFormat</span><span style="color: #000000;">&#40;</span>FPB_ALL, FOB_ALL, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Apply format to another data plot</span>
dpDest.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">&#40;</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;</pre>
<h2><a name="Setting_Format_on_Scatter_PlotGraph_Layer.2C_Set_Format_on_Scatter_Plot"></a><span class="mw-headline">Setting Format on Scatter Plot<span class="OIndex" style="display:none">Graph Layer, Set Format on Scatter Plot</span></span></h2>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
DataPlot dp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">&#40;</span><span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Get the active data plot  </span>

<span style="color: #008000;">// Set symbol format</span>
Tree tr;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Symbol</span>.<span style="color: #000000;">Size</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">12</span>; <span style="color: #008000;">// Size of symbol</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Symbol</span>.<span style="color: #000000;">Shape</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; <span style="color: #008000;">// Circle</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Symbol</span>.<span style="color: #000000;">Interior</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; <span style="color: #008000;">// Interior type</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Symbol</span>.<span style="color: #000000;">EdgeColor</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> SYSCOLOR_RED;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Symbol</span>.<span style="color: #000000;">FillColor</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> SYSCOLOR_BLUE;

<span style="color: #008000;">// Show vertical droplines</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">DropLines</span>.<span style="color: #000000;">Vertical</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">DropLines</span>.<span style="color: #000000;">VerticalColor</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> SYSCOLOR_LTGRAY;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">DropLines</span>.<span style="color: #000000;">VerticalStyle</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">DropLines</span>.<span style="color: #000000;">VerticalWidth</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1.5</span>;

<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> dp.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">&#40;</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    <span style="color: #0000ff;">bool</span> bRet <span style="color: #000080;">=</span> dp.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">&#40;</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>; 
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Setting_Format_on_Grouped_Line_.2B_Symbol_PlotsGraph_Layer.2C_Set_Format_on_Grouping_Plot"></a><span class="mw-headline">Setting Format on Grouped Line + Symbol Plots<span class="OIndex" style="display:none">Graph Layer, Set Format on Grouping Plot</span></span></h2>
<p>Use Origin C to set the format for grouped plots.  The same action can be completed by going into the Plot Details dialog, under the Group tab. The formats included Line Color, Symbol Type, Symbol Interior, and Line Style.
</p><p>The following example shows how to set format on Line and Symbol plots. This group is assumed to contain 4 data plots.
</p>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; 
GroupPlot gplot <span style="color: #000080;">=</span> gl.<span style="color: #000000;">Groups</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Get the first group in layer</span>

<span style="color: #008000;">// the Nester is an array of types of objects to do nested cycling in the group</span>
<span style="color: #008000;">// four types of setting to do nested cycling in the group</span>
vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> vNester<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>; 
vNester<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;  <span style="color: #008000;">// cycling line color in the group</span>
vNester<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;  <span style="color: #008000;">// cycling symbol type in the group</span>
vNester<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">8</span>;  <span style="color: #008000;">// cycling symbol interior in the group </span>
gplot.<span style="color: #000000;">Increment</span>.<span style="color: #000000;">Nester</span>.<span style="color: #000000;">nVals</span> <span style="color: #000080;">=</span> vNester;  <span style="color: #008000;">// set Nester of the grouped plot </span>

<span style="color: #008000;">// Put format settings to vector for 4 plots</span>
vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> vLineColor <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span>SYSCOLOR_BLUE, SYSCOLOR_OLIVE, SYSCOLOR_RED, 
		SYSCOLOR_CYAN<span style="color: #000000;">&#125;</span>;
vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> vSymbolShape <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">3</span>, <span style="color: #0000dd;">5</span>, <span style="color: #0000dd;">8</span><span style="color: #000000;">&#125;</span>;
vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> vSymbolInterior <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">2</span>, <span style="color: #0000dd;">5</span>, <span style="color: #0000dd;">0</span><span style="color: #000000;">&#125;</span>;

Tree tr;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Increment</span>.<span style="color: #000000;">LineColor</span>.<span style="color: #000000;">nVals</span> <span style="color: #000080;">=</span> vLineColor;  <span style="color: #008000;">// set line color to theme tree</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Increment</span>.<span style="color: #000000;">Shape</span>.<span style="color: #000000;">nVals</span> <span style="color: #000080;">=</span> vSymbolShape;  <span style="color: #008000;">// set symbol shape to theme tree</span>
<span style="color: #008000;">// set symbol interior to theme tree</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Increment</span>.<span style="color: #000000;">SymbolInterior</span>.<span style="color: #000000;">nVals</span> <span style="color: #000080;">=</span> vSymbolInterior;  

<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> gplot.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">&#40;</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>    
<span style="color: #000000;">&#123;</span>
	<span style="color: #0000ff;">bool</span> bb <span style="color: #000080;">=</span> gplot.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">&#40;</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;    <span style="color: #008000;">// apply theme tree</span>
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Setting_Colormap_Settings"></a><span class="mw-headline">Setting Colormap Settings</span></h2>
<p><span class="OIndex" style="display:none">Contour Graph, Get/Set Z Levels of Colormap</span>
<b>DataPlot</b> class has two overloaded methods to set colormap. 
</p>
<ul><li> DataPlot::SetColormap( const vector&lt;double&gt; &amp; vz, BOOL bLogScale = FALSE ) is just used to set Z level and scale type (log type or not). The values in <b>vz</b> argument are Z values. </li>
<li> DataPlot::SetColormap( TreeNode&amp; trColormap ) is used to set all colormap settings, for example, Z values, colors, line format and text label format.</li></ul>
<p>This example shows how to set up colormap Z levels on a Contour graph.
</p>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
DataPlot dp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Get original colormap Z levels</span>
vector vZs;
<span style="color: #0000ff;">BOOL</span> bLogScale <span style="color: #000080;">=</span> <span style="color: #0000ff;">FALSE</span>;
<span style="color: #0000ff;">BOOL</span> bRet <span style="color: #000080;">=</span> dp.<span style="color: #000000;">GetColormap</span><span style="color: #000000;">&#40;</span>vZs, bLogScale<span style="color: #000000;">&#41;</span>;
<span style="color: #0000ff;">int</span> nLevels <span style="color: #000080;">=</span> vZs.<span style="color: #000000;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;    

<span style="color: #008000;">// Decrease Z levels vector and set back to DataPlot</span>
<span style="color: #0000ff;">double</span> min, max;
vZs.<span style="color: #000000;">GetMinMax</span><span style="color: #000000;">&#40;</span>min, max<span style="color: #000000;">&#41;</span>;
<span style="color: #0000ff;">double</span> dChangeVal <span style="color: #000080;">=</span> <span style="color: #000000;">fabs</span><span style="color: #000000;">&#40;</span>max <span style="color: #000040;">-</span> min<span style="color: #000000;">&#41;</span> <span style="color: #000040;">*</span> <span style="color: #0000dd;">0.2</span>;
<span style="color: #0000ff;">bool</span> bIncrease <span style="color: #000080;">=</span> <span style="color: #0000ff;">true</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #000040;">!</span>bIncrease <span style="color: #000000;">&#41;</span>
	dChangeVal <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span> <span style="color: #000040;">-</span> dChangeVal;

min <span style="color: #000080;">=</span> min <span style="color: #000040;">-</span> dChangeVal;
max <span style="color: #000080;">=</span> max <span style="color: #000040;">-</span> dChangeVal;
<span style="color: #0000ff;">double</span> inc <span style="color: #000080;">=</span> <span style="color: #000000;">&#40;</span>max <span style="color: #000040;">-</span> min<span style="color: #000000;">&#41;</span> <span style="color: #000040;">/</span> nLevels;    
vZs.<span style="color: #000000;">Data</span><span style="color: #000000;">&#40;</span>min, max, inc<span style="color: #000000;">&#41;</span>;

dp.<span style="color: #000000;">SetColormap</span><span style="color: #000000;">&#40;</span>vZs<span style="color: #000000;">&#41;</span>;</pre>
<p>The following example shows how to set up colormap Z levels with log10 scale type.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">bool</span> plot_matrix<span style="color: #000000;">&#40;</span>LPCSTR lpsczMatPage, LPCSTR lpcszGraphTemplate <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;contour&quot;</span>
		, <span style="color: #0000ff;">int</span> nPlotID <span style="color: #000080;">=</span> IDM_PLOT_CONTOUR<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	<span style="color: #008000;">// Get the active matrix object from the specific matrix page</span>
	MatrixPage matPage <span style="color: #000080;">=</span> Project.<span style="color: #000000;">MatrixPages</span><span style="color: #000000;">&#40;</span>lpsczMatPage<span style="color: #000000;">&#41;</span>;
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #000040;">!</span>matPage <span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Invalid matrix page&quot;</span><span style="color: #000000;">&#41;</span>;
		<span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span>;
	<span style="color: #000000;">&#125;</span>
	<span style="color: #008000;">// get the active sheet in this matrix page</span>
	MatrixLayer ml <span style="color: #000080;">=</span> matPage.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>; 
	<span style="color: #008000;">// get the active matrix object in matrixsheet</span>
	MatrixObject mobj <span style="color: #000080;">=</span> ml.<span style="color: #000000;">MatrixObjects</span><span style="color: #000000;">&#40;</span><span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>; 	
	
	<span style="color: #008000;">// Create hidden graph page with template and add plot</span>
	<span style="color: #008000;">// Create as hidden to avoid unneeded drawing            </span>
	GraphPage gp;
	gp.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span>lpcszGraphTemplate, CREATE_HIDDEN<span style="color: #000000;">&#41;</span>;
	GraphLayer glay <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	
	<span style="color: #0000ff;">int</span> nPlot <span style="color: #000080;">=</span> glay.<span style="color: #000000;">AddPlot</span><span style="color: #000000;">&#40;</span>mobj, nPlotID<span style="color: #000000;">&#41;</span>;
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>nPlot <span style="color: #000080;">&lt;</span> <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;fail to add data plot to graph&quot;</span><span style="color: #000000;">&#41;</span>;
	    <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span>; 
	<span style="color: #000000;">&#125;</span>
	glay.<span style="color: #000000;">Rescale</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// rescale x y axes</span>
	     
	
	<span style="color: #008000;">// Construct Z levels vector</span>
	<span style="color: #0000ff;">int</span> nNewLevels <span style="color: #000080;">=</span> <span style="color: #0000dd;">4</span>;    
	<span style="color: #0000ff;">double</span> min <span style="color: #000080;">=</span> <span style="color: #0000dd;">0.1</span>, max <span style="color: #000080;">=</span> <span style="color: #0000dd;">100000</span>.;
	<span style="color: #0000ff;">double</span> step <span style="color: #000080;">=</span> <span style="color: #000000;">&#40;</span><span style="color: #000000;">log10</span><span style="color: #000000;">&#40;</span>max<span style="color: #000000;">&#41;</span> <span style="color: #000040;">-</span> <span style="color: #000000;">log10</span><span style="color: #000000;">&#40;</span>min<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span> <span style="color: #000040;">/</span> <span style="color: #000000;">&#40;</span>nNewLevels <span style="color: #000040;">-</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
	
	vector vLevels;
	vLevels.<span style="color: #000000;">SetSize</span><span style="color: #000000;">&#40;</span>nNewLevels<span style="color: #000000;">&#41;</span>;
	vLevels.<span style="color: #000000;">Data</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">log10</span><span style="color: #000000;">&#40;</span>min<span style="color: #000000;">&#41;</span>, <span style="color: #000000;">log10</span><span style="color: #000000;">&#40;</span>max<span style="color: #000000;">&#41;</span>, step<span style="color: #000000;">&#41;</span>;   
	vLevels <span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span><span style="color: #000040;">^</span>vLevels;	
	
	<span style="color: #008000;">// Setup z levels in percent, not real z values.</span>
	<span style="color: #008000;">// First value must be 0 and last value must be &lt; 100</span>
	vLevels <span style="color: #000080;">=</span> <span style="color: #0000dd;">100</span><span style="color: #000040;">*</span><span style="color: #000000;">&#40;</span>vLevels <span style="color: #000040;">-</span> min<span style="color: #000000;">&#41;</span><span style="color: #000040;">/</span><span style="color: #000000;">&#40;</span>max <span style="color: #000040;">-</span> min<span style="color: #000000;">&#41;</span>; 
	
	Tree tr;
	tr.<span style="color: #000000;">ColorMap</span>.<span style="color: #000000;">Details</span>.<span style="color: #000000;">Levels</span>.<span style="color: #000000;">dVals</span> <span style="color: #000080;">=</span> vLevels;
	tr.<span style="color: #000000;">ColorMap</span>.<span style="color: #000000;">ScaleType</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; <span style="color: #008000;">// 1 for log10</span>
	tr.<span style="color: #000000;">ColorMap</span>.<span style="color: #000000;">Min</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> min;
	tr.<span style="color: #000000;">ColorMap</span>.<span style="color: #000000;">Max</span>.<span style="color: #000000;">dVal</span> <span style="color: #000080;">=</span> max;
	
	DataPlot dp <span style="color: #000080;">=</span> glay.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">&#40;</span>nPlot<span style="color: #000000;">&#41;</span>;               
	<span style="color: #0000ff;">bool</span> bRet <span style="color: #000080;">=</span> dp.<span style="color: #000000;">SetColormap</span><span style="color: #000000;">&#40;</span>tr<span style="color: #000000;">&#41;</span>; 
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #000040;">!</span>bRet <span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;fail to set colormap&quot;</span><span style="color: #000000;">&#41;</span>;
		<span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span>;
	<span style="color: #000000;">&#125;</span>
	
	gp.<span style="color: #000000;">Label</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Plot created using template: &quot;</span> <span style="color: #000040;">+</span> <span style="color: #000000;">&#40;</span>string<span style="color: #000000;">&#41;</span>lpcszGraphTemplate;
	gp.<span style="color: #000000;">TitleShow</span> <span style="color: #000080;">=</span> WIN_TITLE_SHOW_BOTH;
	gp.<span style="color: #000000;">SetShow</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// show it when all it ready</span>
	
	<span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span>;
<span style="color: #000000;">&#125;</span></pre>
<p>Call the above <i>plot_matrix</i> function with <i>coutour</i> template and <i>IDM_PLOT_CONTOUR</i> plot id to plot contour graph and then set colormap on it.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">void</span> plot_contour_ex<span style="color: #000000;">&#40;</span>LPCSTR lpcszMatPage<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span> 
    plot_matrix<span style="color: #000000;">&#40;</span>lpcszMatPage, <span style="color: #ff00ff;">&quot;contour&quot;</span>, IDM_PLOT_CONTOUR<span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<p>Call the above <i>plot_matrix</i> function with <i>image</i> template and <i>IDM_PLOT_MATRIX_IMAGE</i> plot id to plot image graph and then set colormap on it.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">void</span> plot_image_ex<span style="color: #000000;">&#40;</span>LPCSTR lpcszMatPage<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span> 
    plot_matrix<span style="color: #000000;">&#40;</span>lpcszMatPage, <span style="color: #ff00ff;">&quot;image&quot;</span>, IDM_PLOT_MATRIX_IMAGE<span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<p><span class="OIndex" style="display:none">Contour Graph, Set Fill Color</span><span class="OIndex" style="display:none">Contour Graph, Set Line Style</span>The following example shows how to remove fill color, and set up line color, style, width and text labels on a Contour graph.
</p>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
DataPlot dp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
 
Tree tr;
dp.<span style="color: #000000;">GetColormap</span><span style="color: #000000;">&#40;</span>tr<span style="color: #000000;">&#41;</span>;
 
<span style="color: #008000;">// Remove fill color</span>
tr.<span style="color: #000000;">ColorFillControl</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
 
<span style="color: #008000;">// Set line color</span>
vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> vnLineColors;
vnLineColors <span style="color: #000080;">=</span> tr.<span style="color: #000000;">Details</span>.<span style="color: #000000;">LineColors</span>.<span style="color: #000000;">nVals</span>;
<span style="color: #0000ff;">int</span> nLevels <span style="color: #000080;">=</span> vnLineColors.<span style="color: #000000;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
vnLineColors.<span style="color: #000000;">Data</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>, nLevels, <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
tr.<span style="color: #000000;">Details</span>.<span style="color: #000000;">LineColors</span>.<span style="color: #000000;">nVals</span> <span style="color: #000080;">=</span> vnLineColors;
 
<span style="color: #008000;">// Set line style as Dash for all lines</span>
vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> vnLineStyles<span style="color: #000000;">&#40;</span>vnLineColors.<span style="color: #000000;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;
vnLineStyles <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
tr.<span style="color: #000000;">Details</span>.<span style="color: #000000;">LineStyles</span>.<span style="color: #000000;">nVals</span> <span style="color: #000080;">=</span> vnLineStyles;
 
<span style="color: #008000;">// Set line width for all lines</span>
vector vdLineWidths<span style="color: #000000;">&#40;</span>vnLineColors.<span style="color: #000000;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;
vdLineWidths <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;
tr.<span style="color: #000000;">Details</span>.<span style="color: #000000;">LineWidths</span>.<span style="color: #000000;">dVals</span> <span style="color: #000080;">=</span> vdLineWidths;    
 
<span style="color: #008000;">// Show/hide labels, show all except that the first two.</span>
vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> vnLabels<span style="color: #000000;">&#40;</span>vnLineColors.<span style="color: #000000;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;
vnLabels <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;    
vnLabels<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
vnLabels<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
tr.<span style="color: #000000;">Details</span>.<span style="color: #000000;">Labels</span>.<span style="color: #000000;">nVals</span> <span style="color: #000080;">=</span> vnLabels;    
 
<span style="color: #008000;">// Set back settings to graph</span>
dp.<span style="color: #000000;">SetColormap</span><span style="color: #000000;">&#40;</span>tr<span style="color: #000000;">&#41;</span>;</pre>
<p><span class="OIndex" style="display:none">Contour Graph, Set Style for Text Label</span><span class="OIndex" style="display:none">Font, Convert from Index to DWORD</span>This example shows how to set the format(i.e. color, size, bold, italic) of the text labels on a Contour graph.
</p>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
DataPlot dp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Get all properties of the related objects of the colormap data plot</span>
Tree tr;
tr <span style="color: #000080;">=</span> dp.<span style="color: #000000;">GetFormat</span><span style="color: #000000;">&#40;</span>FPB_ALL, FOB_ALL, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Show all labels</span>
vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> vnLabels;
vnLabels <span style="color: #000080;">=</span> tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">ColorMap</span>.<span style="color: #000000;">Details</span>.<span style="color: #000000;">Labels</span>.<span style="color: #000000;">nVals</span>;
vnLabels <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;<span style="color: #008000;">// 0 to hide, 1 to show</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">ColorMap</span>.<span style="color: #000000;">Details</span>.<span style="color: #000000;">Labels</span>.<span style="color: #000000;">nVals</span> <span style="color: #000080;">=</span> vnLabels;

<span style="color: #008000;">// Set the numeric format for labels</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">NumericFormats</span>.<span style="color: #000000;">Format</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; <span style="color: #008000;">// Decimal</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">NumericFormats</span>.<span style="color: #000000;">DigitsControl</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">NumericFormats</span>.<span style="color: #000000;">SignificantDigits</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>;<span style="color: #008000;">//DecimalPlaces</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">NumericFormats</span>.<span style="color: #000000;">Prefix</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;_&quot;</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">NumericFormats</span>.<span style="color: #000000;">Suffix</span>.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Label&quot;</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">NumericFormats</span>.<span style="color: #000000;">MinArea</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>; <span style="color: #008000;">// Labeling Criteria - Min Area(%)</span>

<span style="color: #008000;">// Set text format for labels</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Labels</span>.<span style="color: #000000;">Color</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> SYSCOLOR_BLUE;
<span style="color: #008000;">//FontFaceIndex_to_DWORD is used to convert font from GUI index to DWORD real value </span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Labels</span>.<span style="color: #000000;">Face</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> FontFaceIndex_to_DWORD<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>;<span style="color: #008000;">// choose the 3rd font in GUI</span>
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Labels</span>.<span style="color: #000000;">Size</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">20</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Labels</span>.<span style="color: #000000;">WhiteOut</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Labels</span>.<span style="color: #000000;">Bold</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Labels</span>.<span style="color: #000000;">Italic</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
tr.<span style="color: #000000;">Root</span>.<span style="color: #000000;">Labels</span>.<span style="color: #000000;">Underline</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;

<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> dp.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">&#40;</span>tr.<span style="color: #000000;">Root</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
	dp.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">&#40;</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;</pre>






