<h1 class="firstHeading">1.14.3 Accessing SQLite Database</h1><p><span class="OIndex" style="display:none">SQLite</span>
</p><p><br />
<b>SQLite</b> is a software library that implements a self-contained, serverless, zero-configuration, transactional SQL database engine, and it has become the most widely deployed SQL database in the world. Due to the excellent features, SQLite is now widely used in different applications and systems.
</p><p><b>SQLite3</b> is the latest version released. Origin provides DLLs for accessing  32-bit and 64-bit SQLite database from Origin C. It is necessary to include a header file that contains the prototypes of SQLite3 APIs:
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>oc_Sqlite.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span></pre>
<p>A simple example of how to use these functions is available at the end of the header file.
</p><p>Origin C also provides a wrapped class, <b>OSQLite</b>, that makes accessing SQLite much easier.  To use this Origin C class, the header file containing this class must be included, like:
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">//DataSet1.1.db is a database file, which contains a table named Originlab</span>
<span style="color: #008000;">//The table is created with the following statement</span>
<span style="color: #008000;">//CREATE TABLE OriginLab(ID INTEGER NOT NULL, NUMBER INTEGER NOT NULL, SALARY INTE</span>
<span style="color: #008000;">//GER NOT NULL, Data BLOB NOT NULL);</span>
<span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>..\Originlab\oSQLite.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span> <span style="color: #008000;">//required header file</span>
<span style="color: #0000ff;">#define</span>	STR_DATABASE_FILE	<span style="color: #ff00ff;">&quot;E:<span style="color: #666666; font-weight: bold;">\\</span>DataSet1.1.db&quot;</span>
<span style="color: #0000ff;">#define</span>	STR_QUERY_STRING	<span style="color: #ff00ff;">&quot;select * from Originlab limit 80&quot;</span>
<span style="color: #0000ff;">void</span> test_OSQLite<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	OSQLite sqlObj<span style="color: #000000;">&#40;</span>STR_DATABASE_FILE<span style="color: #000000;">&#41;</span>;	
	LPCSTR lpSQL <span style="color: #000080;">=</span> STR_QUERY_STRING;
	sqlObj.<span style="color: #000000;">Select</span><span style="color: #000000;">&#40;</span>lpSQL<span style="color: #000000;">&#41;</span>;
	Worksheet wks;
	wks.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Origin&quot;</span><span style="color: #000000;">&#41;</span>;
	sqlObj.<span style="color: #000000;">Import</span><span style="color: #000000;">&#40;</span>wks<span style="color: #000000;">&#41;</span>;
	<span style="color: #008000;">//after modify the data, may use the following code to export data</span>
	<span style="color: #008000;">//sqlObj.Export(&quot;OriginLab&quot;, wks);</span>
<span style="color: #000000;">&#125;</span></pre>
<p>Origin C supports put database query result to vector:
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>..\Originlab\oSQLite.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span>
<span style="color: #0000ff;">#define</span>	STR_DATABASE_FILE	<span style="color: #ff00ff;">&quot;E:<span style="color: #666666; font-weight: bold;">\\</span>DataSet1.1.db&quot;</span>
<span style="color: #0000ff;">#define</span>	STR_QUERY_STRING	<span style="color: #ff00ff;">&quot;select * from Originlab limit 80&quot;</span>
<span style="color: #0000ff;">void</span> test_OSQLite_ex2<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	OSQLite sqlObj<span style="color: #000000;">&#40;</span>STR_DATABASE_FILE<span style="color: #000000;">&#41;</span>;
	LPCSTR lpSQL <span style="color: #000080;">=</span> STR_QUERY_STRING;
	sqlObj.<span style="color: #000000;">Select</span><span style="color: #000000;">&#40;</span>lpSQL<span style="color: #000000;">&#41;</span>;
	vector<span style="color: #000080;">&lt;</span>string<span style="color: #000080;">&gt;</span> vsData;
	vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">double</span><span style="color: #000080;">&gt;</span> vdData;
	sqlObj.<span style="color: #000000;">GetFieldDataByName</span><span style="color: #000000;">&#40;</span><span style="color: #000040;">&amp;</span>vsData, <span style="color: #000040;">&amp;</span>vdData, <span style="color: #ff00ff;">&quot;ID&quot;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>






