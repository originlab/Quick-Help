<h1 class="firstHeading">1.18.1.4.1 Simple Hello World Dialog</h1><p><span class="OIndex" style="display:none">Hello World Dialog</span><span class="OIndex" style="display:none">Dialog Builder</span>
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Create_Resource_DLL_in_VC"><span class="tocnumber">1</span> <span class="toctext">Create Resource DLL in VC</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Create_by_Origin_Dialog_AppWizardDialog.2C_Resource_DLL_Created_by_Origin_Dialog_AppWizard"><span class="tocnumber">1.1</span> <span class="toctext">Create by Origin Dialog AppWizard<span class="OIndex" style="display:none">Dialog, Resource DLL Created by Origin Dialog AppWizard</span></span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Dialog.2C_Resource_DLL_Created_by_Win32_Dynamic-Link_LibraryCreate_by_Win32_Dynamic-Link_Library"><span class="tocnumber">1.2</span> <span class="toctext"><span class="OIndex" style="display:none">Dialog, Resource DLL Created by Win32 Dynamic-Link Library</span>Create by Win32 Dynamic-Link Library</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Dialog.2C_Resource_DLL_Created_by_Visual_Studio_2008Create_Resource-only_DLL_in_Visual_Studio_2008"><span class="tocnumber">1.3</span> <span class="toctext"><span class="OIndex" style="display:none">Dialog, Resource DLL Created by Visual Studio 2008</span>Create Resource-only DLL in Visual Studio 2008</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="#Use_Resource_DLL_in_Origin_CDialog.2C_Use_Resource_DLL_in_Origin_CModal_Dialog"><span class="tocnumber">2</span> <span class="toctext">Use Resource DLL in Origin C<span class="OIndex" style="display:none">Dialog, Use Resource DLL in Origin C</span><span class="OIndex" style="display:none">Modal Dialog</span></span></a></li>
</ul>
</div>

<h2><a name="Create_Resource_DLL_in_VC"></a><span class="mw-headline">Create Resource DLL in VC</span></h2>
<h3><a name="Create_by_Origin_Dialog_AppWizardDialog.2C_Resource_DLL_Created_by_Origin_Dialog_AppWizard"></a><span class="mw-headline">Create by Origin Dialog AppWizard<span class="OIndex" style="display:none">Dialog, Resource DLL Created by Origin Dialog AppWizard</span></span></h3>
<ol><li> Start Visual C++ 6.0, select File-&gt;New to open the New dialog. On the Projects tab, choose Origin Dialog AppWizard, set Project name to "ODialog", choose a Location and click OK.</li>
<li> Choose a simple dialog, and click Next. </li>
<li> Keep Origin C selected and click Finish, then click OK. The resource file with one simple dialog and the related source file and header file will be generated.</li>
<li> Click menu Build-&gt;Set Active Configuration to choose Debug or Release. </li>
<li> Choose menu Build-&gt;Builder ODialog.dll to create DLL.</li>
<li> Go to the file location specified above. Copy the DLL file to outside the Debug or Release folder, to keep the path of the DLL file the same as that of the ODialog.cpp file.</li>
<li> Open the ODialog.cpp file in Origin C Code Builder, compile, and run the DoMyDialog function to open the dialog.</li></ol>
<h3><a name="Dialog.2C_Resource_DLL_Created_by_Win32_Dynamic-Link_LibraryCreate_by_Win32_Dynamic-Link_Library"></a><span class="mw-headline"><span class="OIndex" style="display:none">Dialog, Resource DLL Created by Win32 Dynamic-Link Library</span>Create by Win32 Dynamic-Link Library</span></h3>
<p>This section describes how to create a Resource-only DLL in Visual C++ 6.0.
</p>
<ol><li> Start Visual C++ 6.0, select File-&gt;New to open the New dialog. On the Projects tab, choose Win32 Dynamic-Link Library as the project template, set the Project name as ODialog, choose a Location and click OK. In the dialog that appears, select a simple DLL project and click Finish. </li>
<li> Select Project-&gt;Settings to open the Project Settings dialog. On the Resources tab, set the Resource file name, like ODialog.res, and select the Language according to your software settings as English (United States), and click OK.</li>
<li> Select Insert-&gt;Resource to insert resources into the project. For a Dialog and controls on it, set dialog ID to IDD_OC_DIALOG. </li>
<li> Choose File-&gt;Save As to save the Resource Script file as ODialog.rc. Choose Project-&gt;Add To Project-&gt;Files, then choose the ODialog.rc file to add it to the project.</li>
<li> If the Language is not English, please do this step. In the Workspace view Resource tab, open the list tree, right click on IDD_OC_DIALOG, choose Properties, and then in the dialog choose Neutral for Language. </li>
<li> Build the whole project with Debug or Release configuration. The resulting DLL file is generated under the Debug or Release subfolder.</li></ol>
<h3><a name="Dialog.2C_Resource_DLL_Created_by_Visual_Studio_2008Create_Resource-only_DLL_in_Visual_Studio_2008"></a><span class="mw-headline"><span class="OIndex" style="display:none">Dialog, Resource DLL Created by Visual Studio 2008</span>Create Resource-only DLL in Visual Studio 2008</span></h3>
<p>This article describes in detail the general process of creating a Resource-only DLL in Visual Studio 2008. The following steps show how to build a Resource-only DLL with VS2008 that is accessible in Origin using Origin C.
</p>
<ol>
<li>Start Microsoft Visual Studio 2008.
<li>Select File-&gt;New-&gt;Project to create a new project.
<li>In the New Project dialog, choose Visual C++ as the programming language and Win32 Project as the template, type in the project name as "Welcome", select its location, like in the following picture, and click OK.<br /><a  class="image"><img alt="New Project vs2008.png" src="../images/Simple_Hello_World_Dialog/New_Project_vs2008.png?v=43574" width="540"  /></a></li>
<li>In the Win32 Application Wizard dialog, set Application type as DLL and click Finish.<br /><a  class="image"><img alt="App Settings vs2008.png" src="../images/Simple_Hello_World_Dialog/App_Settings_vs2008.png?v=43791" width="520"  /></a></li>
<li>Switch to the Resource View of the project, right click on the project name to add resources, choose a resource type and click New. <br /><a  class="image"><img alt="AddResource vs2008.png" src="../images/Simple_Hello_World_Dialog/AddResource_vs2008.png?v=43571" width="366"  /></a></li>
<li>Remember to set the Language property of the resource according to the environment in which your software will be installed; say English(United States) if your software is in English. <br /><a  class="image"><img alt="DlgProperty vs2008.png" src="../images/Simple_Hello_World_Dialog/DlgProperty_vs2008.png?v=43573" width="295"  /></a></li>
<li> Add more controls as required, configure the project as Debug or Release, and save the project. Then select Build&gt;Build Solution or Rebuild Solution to build the project.  You can now find a folder named "Debug" or "Release" generated under the solution folder, which contains the DLL. Files generated in this solution are as follows:<br /><a  class="image"><img alt="WelcomeFileTree.png" src="../images/Simple_Hello_World_Dialog/WelcomeFileTree.png?v=43575" width="517"  /></a></li>
</ol>
<h2><a name="Use_Resource_DLL_in_Origin_CDialog.2C_Use_Resource_DLL_in_Origin_CModal_Dialog"></a><span class="mw-headline">Use Resource DLL in Origin C<span class="OIndex" style="display:none">Dialog, Use Resource DLL in Origin C</span><span class="OIndex" style="display:none">Modal Dialog</span></span></h2>
<p>This section describes how to use the Resource-only DLL created in the section above.
</p>
<ol><li>Copy the DLL file to outside the Debug or Release folder, to keep the path of the DLL file the same as that of the resource.h file.</li>
<li>Start Origin and open Code Builder.</li>
<li>Create a new Origin C file named testODialog.c under the path of the DLL file. Add it to the current Workspace, and write testing code like the following. Run the OpenDlg function to open the dialog.
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>Dialog.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span>
<span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>..\Originlab\Resource.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span> <span style="color: #008000;">//ODialog resource header</span>

<span style="color: #0000ff;">class</span> MyDialog <span style="color: #000000;">:</span> <span style="color: #0000ff;">public</span> Dialog
<span style="color: #000000;">&#123;</span>
<span style="color: #0000ff;">public</span><span style="color: #000000;">:</span>
	<span style="color: #008000;">// Construct dialog with dialog ID and DLL name.</span>
	<span style="color: #008000;">// &quot;ODialog&quot; is the DLL file name.</span>
	<span style="color: #008000;">// Not specify path, means the DLL file under the same path of this </span>
	<span style="color: #008000;">// Origin C file.</span>
	<span style="color: #008000;">// If the DLL located at other place, should provide the full path </span>
	<span style="color: #008000;">// of the DLL file.</span>
	MyDialog<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">:</span> Dialog<span style="color: #000000;">&#40;</span>IDD_OC_DIALOG, <span style="color: #ff00ff;">&quot;ODialog&quot;</span><span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
	<span style="color: #000000;">&#125;</span>
 
<span style="color: #000000;">&#125;</span>;

<span style="color: #0000ff;">void</span> OpenDlg<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	MyDialog odlg;
	odlg.<span style="color: #000000;">DoModal</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
</li>
</ol>






