<h1 class="firstHeading">1.8.1 Numeric Data</h1><p><br />
This section gives examples of working with numeric data in Origin C.  Numeric data can be stored in variables of the following data types:
</p>
<ol><li> double</li>
<li> integer</li>
<li> vector</li>
<li> matrix</li></ol>
<p>Numeric data and strings can be stored in the nodes of a tree, provided the nodes have one of the data types above.
</p><p><b>Note</b>:Values such as 0.0, NANUM (missing value) and values between -1.0E-290 to 1.0E-290 will be evaluated to be <i>False</i> in logic statement. 
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Missing_Values"><span class="tocnumber">1</span> <span class="toctext"><span class="OIndex">Missing Values</span></span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Numeric.2C_Significant_DigitsNumeric.2C_Data_Comparison_DataPrecision_and_Comparison"><span class="tocnumber">2</span> <span class="toctext"><span class="OIndex" style="display:none">Numeric, Significant Digits</span><span class="OIndex" style="display:none">Numeric, Data Comparison Data</span>Precision and Comparison</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Convert_Numeric_to_StringNumeric.2C_Convert_to_String"><span class="tocnumber">3</span> <span class="toctext">Convert Numeric to String<span class="OIndex" style="display:none">Numeric, Convert to String</span></span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#VectorArray.2C_One-Dimensional"><span class="tocnumber">4</span> <span class="toctext"><span class="OIndex">Vector</span><span class="OIndex" style="display:none">Array, One-Dimensional</span></span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#MatrixArray.2C_Two-Dimensionals"><span class="tocnumber">5</span> <span class="toctext"><span class="OIndex">Matrix</span><span class="OIndex" style="display:none">Array, Two-Dimensionals</span></span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#TreeNode"><span class="tocnumber">6</span> <span class="toctext"><span class="OIndex">TreeNode</span></span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#ComplexComplex_Variable"><span class="tocnumber">7</span> <span class="toctext">Complex<span class="OIndex" style="display:none">Complex Variable</span></span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#DataRange"><span class="tocnumber">8</span> <span class="toctext">DataRange</span></a>
<ul>
<li class="toclevel-2 tocsection-9"><a href="#Data_Range_in_WorksheetWorksheet.2C_Data_Range_SelectionData_Range.2C_from_Worksheet"><span class="tocnumber">8.1</span> <span class="toctext">Data Range in Worksheet<span class="OIndex" style="display:none">Worksheet, Data Range Selection</span><span class="OIndex" style="display:none">Data Range, from Worksheet</span></span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Data_Range_in_MatrixsheetMatrix_Sheet.2C_Data_Range_SelectionData_Range.2C_from_Matrix"><span class="tocnumber">8.2</span> <span class="toctext">Data Range in Matrixsheet<span class="OIndex" style="display:none">Matrix Sheet, Data Range Selection</span><span class="OIndex" style="display:none">Data Range, from Matrix</span></span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Data_Range_in_GraphGraph_Layer.2C_Data_Range_SelectionData_Range.2C_from_Graph"><span class="tocnumber">8.3</span> <span class="toctext">Data Range in Graph<span class="OIndex" style="display:none">Graph Layer, Data Range Selection</span><span class="OIndex" style="display:none">Data Range, from Graph</span></span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Data_Range_ControlData_Selector"><span class="tocnumber">8.4</span> <span class="toctext"><span class="OIndex">Data Range Control</span><span class="OIndex" style="display:none">Data Selector</span></span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="Missing_Values"></a><span class="mw-headline"><span class="OIndex">Missing Values</span></span></h2>
<p>As important as numeric data is, it is also important to be able to represent missing data.  Origin C defines the <span class="OIndex">NANUM</span> macro for comparing and assigning values to missing data.  Missing values are only supported with the double data type.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">double</span> d <span style="color: #000080;">=</span> NANUM;
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> NANUM <span style="color: #000080;">==</span> d <span style="color: #000000;">&#41;</span>
    out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;The value is a missing value.&quot;</span><span style="color: #000000;">&#41;</span>;</pre>
<p>Origin C also provides the <b><a href="../../OriginC/OriginC/Is_missing_value_(global_function).html" title="OriginC:Is missing value (global function)">is_missing_value</a></b> function for testing if a value is a missing value.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> is_missing_value<span style="color: #000000;">&#40;</span>d<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
    out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;The value is a missing value.&quot;</span><span style="color: #000000;">&#41;</span>;</pre>
<h2><a name="Numeric.2C_Significant_DigitsNumeric.2C_Data_Comparison_DataPrecision_and_Comparison"></a><span class="mw-headline"><span class="OIndex" style="display:none">Numeric, Significant Digits</span><span class="OIndex" style="display:none">Numeric, Data Comparison Data</span>Precision and Comparison</span></h2>
<p>In the following example code, the <i>prec</i> and <i>round</i> functions are used to control the precision of double type numeric data.  The <i>is_equal</i> function is used to compare two pieces of double type numeric data.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">double</span> dVal <span style="color: #000080;">=</span> PI; <span style="color: #008000;">// PI defined as 3.1415926535897932384626</span>

<span style="color: #008000;">// convert the double value to have 6 significant digits</span>
<span style="color: #0000ff;">int</span> nSignificantDigits <span style="color: #000080;">=</span> <span style="color: #0000dd;">6</span>;
<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;%f<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, prec<span style="color: #000000;">&#40;</span>dVal, nSignificantDigits<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// force the double value to only have two decimal digits</span>
uint nDecimalPlaces <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
<span style="color: #0000ff;">double</span> dd <span style="color: #000080;">=</span> round<span style="color: #000000;">&#40;</span>dVal, nDecimalPlaces<span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;%f<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, dd<span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// compare two double values</span>
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> is_equal<span style="color: #000000;">&#40;</span>dd, <span style="color: #0000dd;">3.14</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;equal<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span>	
<span style="color: #0000ff;">else</span>
<span style="color: #000000;">&#123;</span>
	out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;not equal<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Convert_Numeric_to_StringNumeric.2C_Convert_to_String"></a><span class="mw-headline">Convert Numeric to String<span class="OIndex" style="display:none">Numeric, Convert to String</span></span></h2>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// assign int type numeric to string</span>
string str <span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span>;
out_str<span style="color: #000000;">&#40;</span>str<span style="color: #000000;">&#41;</span>;

<span style="color: #0000ff;">int</span> nn <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
str <span style="color: #000080;">=</span> nn;
out_str<span style="color: #000000;">&#40;</span>str<span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// convert double type numeric to string</span>
<span style="color: #0000ff;">double</span> dd <span style="color: #000080;">=</span> PI;	
str <span style="color: #000080;">=</span> ftoa<span style="color: #000000;">&#40;</span>dd, <span style="color: #ff00ff;">&quot;*&quot;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Use &quot;*&quot; for Origin's global setting in Options dialog</span>
out_str<span style="color: #000000;">&#40;</span>str<span style="color: #000000;">&#41;</span>;

str <span style="color: #000080;">=</span> ftoa<span style="color: #000000;">&#40;</span>dd, <span style="color: #ff00ff;">&quot;*8&quot;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Use &quot;*8&quot; for 8 significant</span>
out_str<span style="color: #000000;">&#40;</span>str<span style="color: #000000;">&#41;</span>;</pre>
<h2><a name="VectorArray.2C_One-Dimensional"></a><span class="mw-headline"><span class="OIndex">Vector</span><span class="OIndex" style="display:none">Array, One-Dimensional</span></span></h2>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// One-Dimensional array with basic data type, for example, double, int, string, </span>
<span style="color: #008000;">// complex.</span>
vector vx, vy;

<span style="color: #0000ff;">int</span> nMax <span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span>;	
vx.<span style="color: #000000;">Data</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>, nMax, <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// assign value to vx from 1 to 10 with increment 1</span>
vy.<span style="color: #000000;">SetSize</span><span style="color: #000000;">&#40;</span>nMax<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// set size(10) to vy</span>

<span style="color: #0000ff;">for</span><span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> nn <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; nn <span style="color: #000080;">&lt;</span> nMax; nn<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	vy<span style="color: #000000;">&#91;</span>nn<span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> rnd<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// assign random data to each item in vy</span>
	<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;index =&#160;%d, x =&#160;%g, y =&#160;%g<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, nn<span style="color: #000040;">+</span><span style="color: #0000dd;">1</span>, vx<span style="color: #000000;">&#91;</span>nn<span style="color: #000000;">&#93;</span>, vy<span style="color: #000000;">&#91;</span>nn<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Access the data in a worksheet window</span>
Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
Column col<span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;	

vector<span style="color: #000040;">&amp;</span> vec <span style="color: #000080;">=</span> col.<span style="color: #000000;">GetDataObject</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
vec <span style="color: #000080;">=</span> vec <span style="color: #000040;">*</span> <span style="color: #0000dd;">0.1</span>; <span style="color: #008000;">// Multiply 0.1 by each piece of data in vec</span>

vec <span style="color: #000080;">=</span> <span style="color: #000000;">sin</span><span style="color: #000000;">&#40;</span>vec<span style="color: #000000;">&#41;</span>;	<span style="color: #008000;">// Find the sine of each piece of data in vec</span></pre>
<h2><a name="MatrixArray.2C_Two-Dimensionals"></a><span class="mw-headline"><span class="OIndex">Matrix</span><span class="OIndex" style="display:none">Array, Two-Dimensionals</span></span></h2>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Two-Dimensional array with basic data type, for example, double, int, complex, </span>
<span style="color: #008000;">// but not string.</span>
matrix mat<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">5</span>, <span style="color: #0000dd;">6</span><span style="color: #000000;">&#41;</span>;

<span style="color: #0000ff;">for</span><span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; ii <span style="color: #000080;">&lt;</span> <span style="color: #0000dd;">5</span>; ii<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	<span style="color: #0000ff;">for</span><span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> jj <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; jj <span style="color: #000080;">&lt;</span> <span style="color: #0000dd;">6</span>; jj<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		mat<span style="color: #000000;">&#91;</span>ii<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#91;</span>jj<span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> ii <span style="color: #000040;">+</span> jj;
		<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;%g<span style="color: #666666; font-weight: bold;">\t</span>&quot;</span>, mat<span style="color: #000000;">&#91;</span>ii<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#91;</span>jj<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">&#125;</span>
	<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// new line</span>
<span style="color: #000000;">&#125;</span></pre>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Access the data in matrix window</span>
MatrixLayer ml <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
MatrixObject mo <span style="color: #000080;">=</span> ml.<span style="color: #000000;">MatrixObjects</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;

matrix<span style="color: #000040;">&amp;</span> mat <span style="color: #000080;">=</span> mo.<span style="color: #000000;">GetDataObject</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;	
mat <span style="color: #000080;">=</span> mat <span style="color: #000040;">+</span> <span style="color: #0000dd;">0.1</span>; <span style="color: #008000;">// Add 0.1 for the each data in matrix</span></pre>
<h2><a name="TreeNode"></a><span class="mw-headline"><span class="OIndex">TreeNode</span></span></h2>
<p>The Origin C TreeNode class provides several methods for constructing multi-level trees, traversing trees and accessing the value/attributes of tree nodes.
</p>
<pre class="oc" style="font-family:monospace;">Tree tr;

<span style="color: #008000;">// Access the value of a tree node</span>
TreeNode trName <span style="color: #000080;">=</span> tr.<span style="color: #000000;">AddNode</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Name&quot;</span><span style="color: #000000;">&#41;</span>;
trName.<span style="color: #000000;">strVal</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Jane&quot;</span>;

tr.<span style="color: #000000;">UserID</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span>;

vector<span style="color: #000080;">&lt;</span>string<span style="color: #000080;">&gt;</span> vsBooks <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #ff00ff;">&quot;C++&quot;</span>, <span style="color: #ff00ff;">&quot;MFC&quot;</span><span style="color: #000000;">&#125;</span>;
tr.<span style="color: #000000;">Books</span>.<span style="color: #000000;">strVals</span> <span style="color: #000080;">=</span> vsBooks;

out_tree<span style="color: #000000;">&#40;</span>tr<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// output tree</span></pre>
<h2><a name="ComplexComplex_Variable"></a><span class="mw-headline">Complex<span class="OIndex" style="display:none">Complex Variable</span></span></h2>
<pre class="oc" style="font-family:monospace;">complex cc<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1.5</span>, <span style="color: #0000dd;">2.2</span><span style="color: #000000;">&#41;</span>;

cc.<span style="color: #000000;">m_re</span> <span style="color: #000080;">=</span> cc.<span style="color: #000000;">m_re</span> <span style="color: #000040;">+</span><span style="color: #0000dd;">1</span>;
cc.<span style="color: #000000;">m_im</span> <span style="color: #000080;">=</span> cc.<span style="color: #000000;">m_im</span> <span style="color: #000040;">*</span> <span style="color: #0000dd;">0.1</span>;	

out_complex<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;cc = &quot;</span>, cc<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// output cc = 2.500000+0.220000i</span></pre>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Access complex dataset</span>
Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
Column col<span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> FSI_COMPLEX <span style="color: #000080;">==</span> col.<span style="color: #000000;">GetInternalDataType</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	vector<span style="color: #000080;">&lt;</span>complex<span style="color: #000080;">&gt;</span><span style="color: #000040;">&amp;</span> vcc <span style="color: #000080;">=</span> col.<span style="color: #000000;">GetDataObject</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	vcc<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0.5</span> <span style="color: #000040;">+</span> 3.6i;
<span style="color: #000000;">&#125;</span></pre>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Access complex matrix</span>
MatrixLayer ml <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
MatrixObject mo <span style="color: #000080;">=</span> ml.<span style="color: #000000;">MatrixObjects</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;

<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> FSI_COMPLEX <span style="color: #000080;">==</span> mo.<span style="color: #000000;">GetInternalDataType</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	matrix<span style="color: #000080;">&lt;</span>complex<span style="color: #000080;">&gt;</span><span style="color: #000040;">&amp;</span> mat <span style="color: #000080;">=</span> mo.<span style="color: #000000;">GetDataObject</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	mat<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span> <span style="color: #000040;">+</span> 2.5i;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="DataRange"></a><span class="mw-headline">DataRange</span></h2>
<p>The <b>DataRange</b> class is a versatile mechanism to get and put data in a Worksheet, Matrix or Graph window. 
</p>
<h3><a name="Data_Range_in_WorksheetWorksheet.2C_Data_Range_SelectionData_Range.2C_from_Worksheet"></a><span class="mw-headline">Data Range in Worksheet<span class="OIndex" style="display:none">Worksheet, Data Range Selection</span><span class="OIndex" style="display:none">Data Range, from Worksheet</span></span></h3>
<p>For a Worksheet, a data range can be specified by column/row index as one column, one row, any sub block range, one cell or entire Worksheet.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Construct a data range on the active worksheet, all columns and rows </span>
<span style="color: #008000;">// from 1st row to 5th row.</span>
Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #0000ff;">int</span> r1 <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>, c1 <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>, r2 <span style="color: #000080;">=</span> <span style="color: #0000dd;">4</span>, c2 <span style="color: #000080;">=</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>;

DataRange dr;
<span style="color: #008000;">// range name should be make sense, for example, &quot;X&quot;, &quot;Y&quot;, </span>
<span style="color: #008000;">// &quot;ED&quot;(Y error), &quot;Z&quot;. If the data range is not belong to dependent </span>
<span style="color: #008000;">// or independent type, default can be &quot;X&quot;.</span>
dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;X&quot;</span>, wks, r1, c1, r2, c2<span style="color: #000000;">&#41;</span>;</pre>
<p>Get data from data range to vector. <b><a href="../../OriginC/OriginC/DataRange-GetData.html" title="OriginC:DataRange-GetData">DataRange::GetData</a></b> supports multiple overloaded methods. For example:
</p>
<pre class="oc" style="font-family:monospace;">vector vData;
<span style="color: #0000ff;">int</span> index <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; <span style="color: #008000;">// range index</span>
dr.<span style="color: #000000;">GetData</span><span style="color: #000000;">&#40;</span><span style="color: #000040;">&amp;</span>vData, index<span style="color: #000000;">&#41;</span>;</pre>
<h3><a name="Data_Range_in_MatrixsheetMatrix_Sheet.2C_Data_Range_SelectionData_Range.2C_from_Matrix"></a><span class="mw-headline">Data Range in Matrixsheet<span class="OIndex" style="display:none">Matrix Sheet, Data Range Selection</span><span class="OIndex" style="display:none">Data Range, from Matrix</span></span></h3>
<p>For a Matrix window, the data range can be a matrix object index.
</p>
<pre class="oc" style="font-family:monospace;">MatrixLayer ml <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;

DataRange dr;
<span style="color: #0000ff;">int</span> nMatrixObjectIndex <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>ml, nMatrixObjectIndex, <span style="color: #ff00ff;">&quot;X&quot;</span><span style="color: #000000;">&#41;</span>;</pre>
<p>Get data from data range to matrix.
</p>
<pre class="oc" style="font-family:monospace;">matrix mat;
dr.<span style="color: #000000;">GetData</span><span style="color: #000000;">&#40;</span>mat<span style="color: #000000;">&#41;</span>;</pre>
<h3><a name="Data_Range_in_GraphGraph_Layer.2C_Data_Range_SelectionData_Range.2C_from_Graph"></a><span class="mw-headline">Data Range in Graph<span class="OIndex" style="display:none">Graph Layer, Data Range Selection</span><span class="OIndex" style="display:none">Data Range, from Graph</span></span></h3>
<p>For a Graph window, the data range can be one data plot, or a sub range of one data plot.
</p>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
DataPlot dp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Get active data plot</span>

DataRange dr;
<span style="color: #0000ff;">int</span> i1 <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; <span style="color: #008000;">// from the first data point</span>
<span style="color: #0000ff;">int</span> i2 <span style="color: #000080;">=</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span>; <span style="color: #008000;">// to the last data point</span>
dp.<span style="color: #000000;">GetDataRange</span><span style="color: #000000;">&#40;</span>dr, i1, i2<span style="color: #000000;">&#41;</span>;</pre>
<p>Get XY data from data plot to vector by data range object.
</p>
<pre class="oc" style="font-family:monospace;">vector vx, vy;
DWORD dwRules <span style="color: #000080;">=</span> DRR_GET_DEPENDENT;
dr.<span style="color: #000000;">GetData</span><span style="color: #000000;">&#40;</span>dwRules, <span style="color: #0000dd;">0</span>, <span style="color: #0000ff;">NULL</span>, <span style="color: #0000ff;">NULL</span>, <span style="color: #000040;">&amp;</span>vy, <span style="color: #000040;">&amp;</span>vx<span style="color: #000000;">&#41;</span>;</pre>
<h3><a name="Data_Range_ControlData_Selector"></a><span class="mw-headline"><span class="OIndex">Data Range Control</span><span class="OIndex" style="display:none">Data Selector</span></span></h3>
<p>OriginC supports a GetN dialog<span class="OIndex" style="display:none">GetN Data Selector Control</span> interactive control to choose a data range.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>GetNBox.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span>
<span style="color: #008000;">// Open a dialog to choose a range from one graph data plot.</span>
<span style="color: #008000;">// And construct a data range object by this selection.</span>
GETN_TREE<span style="color: #000000;">&#40;</span>tr<span style="color: #000000;">&#41;</span>	
GETN_INTERACTIVE<span style="color: #000000;">&#40;</span>Range1, <span style="color: #ff00ff;">&quot;Select Range&quot;</span>, <span style="color: #ff00ff;">&quot;&quot;</span><span style="color: #000000;">&#41;</span>	
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> GetNBox<span style="color: #000000;">&#40;</span>tr<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span> <span style="color: #008000;">// returns true if click OK button</span>
<span style="color: #000000;">&#123;</span>
	
	DataRange dr;
	dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Range1&quot;</span>, tr.<span style="color: #000000;">Range1</span>.<span style="color: #000000;">strVal</span><span style="color: #000000;">&#41;</span>;
	
	vector vData;
	<span style="color: #0000ff;">int</span> index <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; <span style="color: #008000;">// range index</span>
	dr.<span style="color: #000000;">GetData</span><span style="color: #000000;">&#40;</span><span style="color: #000040;">&amp;</span>vData, index<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// The data in vData is the selected data points</span>
<span style="color: #000000;">&#125;</span></pre>






