<h1 class="firstHeading">1.15.2 Running LabTalk Script</h1><p><span class="OIndex" style="display:none">LabTalk Variable, LabTalk Script, Execution in Origin C</span>
</p><p>The Origin C <b><a href="../../OriginC/OriginC/LT_execute_(global_function).html" title="OriginC:LT execute (global function)">LT_execute</a></b><span class="OIndex" style="display:none">LT_execute</span> global function allows you to run LabTalk script stored in a string.
<span class="OIndex" style="display:none">Worksheet, Set Column Width by LabTalk Command</span>The Format string method can be useful in passing Origin C variables into the LabTalk script:
</p>
<pre class="oc" style="font-family:monospace;">string strScript;
string strBook <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Book1&quot;</span>;
<span style="color: #0000ff;">int</span> iColStart <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>, iColEnd <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>;
strScript.<span style="color: #000000;">Format</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;win -a&#160;%s;plotxy&#160;%u:%u;&quot;</span>, strBook, iColStart, iColEnd<span style="color: #000000;">&#41;</span>;
LT_execute<span style="color: #000000;">&#40;</span>strScript<span style="color: #000000;">&#41;</span>;</pre>
<p>The next example calls the <i>LT_execute</i> method of the Layer class instead of the global <i>LT_execute</i> function.  When calling the global <i>LT_execute</i> function, the script runs and will operate on the active layer when no layer is specified by the script code.  When calling the <i>LT_execute</i> method of the Layer class, the script runs and will operate on the layer instance instead of the active layer.
</p>
<pre class="oc" style="font-family:monospace;">WorksheetPage wksPg<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Book1&quot;</span><span style="color: #000000;">&#41;</span>;
Worksheet wks <span style="color: #000080;">=</span> wksPg.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;

WorksheetPage wksPgActive;
wksPgActive.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Origin&quot;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// This page is now active</span>

LT_execute<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;wks.colWidth=16&quot;</span><span style="color: #000000;">&#41;</span>;    <span style="color: #008000;">// Set column widths of active layer</span>
wks.<span style="color: #000000;">LT_execute</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;wks.colWidth=8&quot;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Set column widths of Book1</span></pre>
<p>You can also use <i><a href="../../OriginC/OriginC/OriginObject-SetProp.html" title="OriginC:OriginObject-SetProp">OriginObject::SetProp</a></i> function to change the LabTalk object properties. You can find more in the <a href="../../OriginC/OriginC/OriginObject-SetProp.html#See_Also" title="OriginC:OriginObject-SetProp">See_Also</a> section.
</p>
<pre class="oc" style="font-family:monospace;">wks.<span style="color: #000000;">SetProp</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;colWidth&quot;</span>, <span style="color: #0000dd;">8</span><span style="color: #000000;">&#41;</span>;</pre>






