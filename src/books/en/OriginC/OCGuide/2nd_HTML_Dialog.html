<h1 class="firstHeading">1.18.1.5.2 Create a Calculator</h1><p><span class="OIndex" style="display:none">Calculator</span><span class="OIndex" style="display:none">HTML Dialog</span>
</p>
<p class='urlname' style='display: none'>second-HTML-dialog</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Summary"><span class="tocnumber">1</span> <span class="toctext">Summary</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Sample_Files"><span class="tocnumber">2</span> <span class="toctext">Sample Files</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Creating_an_HTML_Page_for_Calculator"><span class="tocnumber">3</span> <span class="toctext">Creating an HTML Page for Calculator</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Adding_Onclick_Event_Handlers_for_Buttons"><span class="tocnumber">4</span> <span class="toctext">Adding Onclick Event Handlers for Buttons</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Calling_OriginC_Function_in_JavaScript"><span class="tocnumber">5</span> <span class="toctext">Calling OriginC Function in JavaScript</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Creating_an_HTML_Dialog"><span class="tocnumber">6</span> <span class="toctext">Creating an HTML Dialog</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Adding_JavaScript_Callable_Prototypes_in_OriginC"><span class="tocnumber">7</span> <span class="toctext">Adding JavaScript Callable Prototypes in OriginC</span></a></li>
</ul>
</div>

<h2><a name="Summary"></a><span class="mw-headline">Summary</span></h2>
<p>In this tutorial, you build a calculator in which you can perform arithmetic operations (addition, subtraction, multiplication, and division). 
<br />
You can learn how to:
</p>
<ol><li> Trigger events to occur by using the controls inside HTML page.</li>
<li> Build event handler functions to respond to events by JavaScript.</li>
<li> Call OriginC function in JavaScript.</li>
<li> Perform basic arithmetic operations in OriginC.</li></ol>
<p>When you finish, your calculator will look like the following picture:
</p>
<dl><dd><a  class="image"><img alt="Calculator.png" src="../images/2nd_HTML_Dialog/Calculator.png?v=49411" width="250"  /></a></dd></dl>
<p class="version" >Minimum Origin Version Required: Origin 2017</p>
<h2><a name="Sample_Files"></a><span class="mw-headline">Sample Files</span></h2>
<ul><li> SimpleCalc.html: This is the HTML code for the html page.</li>
<li> Calculator.cpp: This is the OriginC code to call out the HTML dialog and perform arithmetic operations.</li></ul>
<table class="note">

<tr>
<td><b>Note:</b> You can download the sample file <a class="external text" href="https://blog.originlab.com/wp-content/uploads/2016/11/HTMLDlgExamples.zip" target="_blank">here</a>.
</td></tr></table>
<h2><a name="Creating_an_HTML_Page_for_Calculator"></a><span class="mw-headline">Creating an HTML Page for Calculator</span></h2>
<p>As the first step in developing this calculator, you create an HTML page and add equation display box, number input buttons, operator buttons, Calculate button and Clear button to this page.
</p>
<ol>
<li> Start Origin and open <b>Code Builder</b>, create a new HTML file named SimpleCalc.html and save it to a new folder named Simple Calculator.

<li> Within the SimpleCalc.html, construct a simple user interface for calculator by the following code:
<pre class="javascript" style="font-family:monospace;"><span style="color: #339933;">&lt;!</span>DOCTYPE html<span style="color: #339933;">&gt;</span>
<span style="color: #339933;">&lt;</span>html<span style="color: #339933;">&gt;</span>

    <span style="color: #339933;">&lt;</span>head<span style="color: #339933;">&gt;</span>
        <span style="color: #339933;">&lt;</span>meta charset<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;utf-8&quot;</span> <span style="color: #339933;">/&gt;</span>
	<span style="color: #339933;">&lt;</span>meta http<span style="color: #339933;">-</span>equiv<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;X-UA-Compatible&quot;</span> content<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;IE=Edge&quot;</span><span style="color: #339933;">/&gt;</span>
    <span style="color: #339933;">&lt;/</span>head<span style="color: #339933;">&gt;</span>

    <span style="color: #339933;">&lt;</span>body<span style="color: #339933;">&gt;</span>
        <span style="color: #339933;">&lt;!--</span>equation display textbox<span style="color: #339933;">--&gt;</span>
	<span style="color: #339933;">&lt;</span>div id<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;Equation&quot;</span> style<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;border:solid;height:20px;&quot;</span><span style="color: #339933;">&gt;&lt;/</span>div<span style="color: #339933;">&gt;</span>
        <span style="color: #339933;">&lt;/</span>br<span style="color: #339933;">&gt;</span>

        <span style="color: #339933;">&lt;!--</span>four arithmetic operations buttons<span style="color: #339933;">--&gt;</span>
	<span style="color: #339933;">&lt;</span>div id<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;Ops&quot;</span><span style="color: #339933;">&gt;</span>
        	<span style="color: #339933;">&lt;</span>input type<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;button&quot;</span> id<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;btnPlus&quot;</span> value<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;+&quot;</span><span style="color: #339933;">/&gt;</span>
        	<span style="color: #339933;">&lt;</span>input type<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;button&quot;</span> id<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;btnMinus&quot;</span> value<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;-&quot;</span><span style="color: #339933;">/&gt;</span>
        	<span style="color: #339933;">&lt;</span>input type<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;button&quot;</span> id<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;btnMultiply&quot;</span> value<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;X&quot;</span><span style="color: #339933;">/&gt;</span>
        	<span style="color: #339933;">&lt;</span>input type<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;button&quot;</span> id<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;btnDiv&quot;</span> value<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;/&quot;</span><span style="color: #339933;">/&gt;</span>
        <span style="color: #339933;">&lt;/</span>div<span style="color: #339933;">&gt;</span>
        <span style="color: #339933;">&lt;/</span>br<span style="color: #339933;">&gt;</span>

        <span style="color: #339933;">&lt;!--</span>number input buttons from <span style="color: #CC0000;">0</span> to <span style="color: #CC0000;">9</span><span style="color: #339933;">--&gt;</span>
        <span style="color: #339933;">&lt;</span>div id<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;Num789&quot;</span><span style="color: #339933;">&gt;</span>
        	<span style="color: #339933;">&lt;</span>input type<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;button&quot;</span> id<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;btn7&quot;</span> value<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;7&quot;</span><span style="color: #339933;">/&gt;</span>
        	<span style="color: #339933;">&lt;</span>input type<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;button&quot;</span> id<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;btn8&quot;</span> value<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;8&quot;</span><span style="color: #339933;">/&gt;</span>
        	<span style="color: #339933;">&lt;</span>input type<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;button&quot;</span> id<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;btn9&quot;</span> value<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;9&quot;</span><span style="color: #339933;">/&gt;</span>
        <span style="color: #339933;">&lt;/</span>div<span style="color: #339933;">&gt;</span>
        <span style="color: #339933;">&lt;</span>div id<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;Num456&quot;</span><span style="color: #339933;">&gt;</span>
        	<span style="color: #339933;">&lt;</span>input type<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;button&quot;</span> id<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;btn4&quot;</span> value<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;4&quot;</span><span style="color: #339933;">/&gt;</span>
        	<span style="color: #339933;">&lt;</span>input type<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;button&quot;</span> id<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;btn5&quot;</span> value<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;5&quot;</span><span style="color: #339933;">/&gt;</span>
        	<span style="color: #339933;">&lt;</span>input type<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;button&quot;</span> id<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;btn6&quot;</span> value<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;6&quot;</span><span style="color: #339933;">/&gt;</span>
        <span style="color: #339933;">&lt;/</span>div<span style="color: #339933;">&gt;</span>
        <span style="color: #339933;">&lt;</span>div id<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;Num123&quot;</span><span style="color: #339933;">&gt;</span>
        	<span style="color: #339933;">&lt;</span>input type<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;button&quot;</span> id<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;btn1&quot;</span> value<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;1&quot;</span><span style="color: #339933;">/&gt;</span>
        	<span style="color: #339933;">&lt;</span>input type<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;button&quot;</span> id<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;btn2&quot;</span> value<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;2&quot;</span><span style="color: #339933;">/&gt;</span>
        	<span style="color: #339933;">&lt;</span>input type<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;button&quot;</span> id<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;btn3&quot;</span> value<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;3&quot;</span><span style="color: #339933;">/&gt;</span>
        <span style="color: #339933;">&lt;/</span>div<span style="color: #339933;">&gt;</span>
	<span style="color: #339933;">&lt;</span>div id<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;Num0&quot;</span><span style="color: #339933;">&gt;</span>
		<span style="color: #339933;">&lt;</span>input type<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;button&quot;</span> id<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;btn0&quot;</span> value<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;0&quot;</span><span style="color: #339933;">/&gt;</span>
	<span style="color: #339933;">&lt;/</span>div<span style="color: #339933;">&gt;</span>
        <span style="color: #339933;">&lt;/</span>br<span style="color: #339933;">&gt;</span>

	<span style="color: #339933;">&lt;!--</span>calculation button and clear button	<span style="color: #339933;">--&gt;</span>
        <span style="color: #339933;">&lt;</span>div<span style="color: #339933;">&gt;</span>
        	<span style="color: #339933;">&lt;</span>input type<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;button&quot;</span> id<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;btnCalculate&quot;</span> value<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;Calculate&quot;</span><span style="color: #339933;">/&gt;</span>
        	<span style="color: #339933;">&lt;</span>input type<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;button&quot;</span> id<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;btnClear&quot;</span> value<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;Clear&quot;</span><span style="color: #339933;">/&gt;</span>
        <span style="color: #339933;">&lt;/</span>div<span style="color: #339933;">&gt;</span>
    <span style="color: #339933;">&lt;/</span>body<span style="color: #339933;">&gt;</span>

<span style="color: #339933;">&lt;/</span>html<span style="color: #339933;">&gt;</span></pre>
</ol>
<table class="note">

<tr>
<td><b>Note:</b> When editing is complete, you can check this page by opening it with any web browser.
</td></tr></table>
<h2><a name="Adding_Onclick_Event_Handlers_for_Buttons"></a><span class="mw-headline">Adding Onclick Event Handlers for Buttons</span></h2>
<p>The calculator works as follows:
</p>
<ol><li> When a user clicks number input buttons, the program shows the input number in the textbox.</li>
<li> Then the user clicks an operator button, the program appends the operator to the number inputted before.</li>
<li> Next the user click to input another number that is also appended in textbox.</li>
<li> At last, the user click Calculate button to evaluate the equation and result in the textbox.</li>
<li> The text in textbox can be erase by clicking Clear button at any time.</li></ol>
<p>In order to get your program to work that way, you need to add an <code>onclick</code> event handler to capture a click event from the users’ mouse on the button in the HTML page. This action usually results in a call to a JavaScript function which helps to perform the calculation.
</p><p>Taking the Calculate button <a  class="image"><img alt="Calculation button.png" src="../images/2nd_HTML_Dialog/Calculation_button.png?v=49421" width="62"  /></a> as an example:
</p>
<ol>

<li> Inside the element &lt; script &gt;, add the function <code>Invoke_Cal()</code>. Note that this function will be used to respond to the click button event by <code>onclick</code> event handler mentioned in Step 2.

<pre class="javascript" style="font-family:monospace;">    <span style="color: #339933;">&lt;</span>script<span style="color: #339933;">&gt;</span>
        <span style="color: #000066; font-weight: bold;">function</span> Invoke_Cal<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><span style="color: #009900;">&#125;</span> 
    <span style="color: #339933;">&lt;/</span>script<span style="color: #339933;">&gt;</span></pre>
<li> Add an onclick handler event inside the calculation button tag, so that the function <code>Invoke_Cal()</code> will be invoked if the user clicks this button.

<pre class="javascript" style="font-family:monospace;"><span style="color: #339933;">&lt;</span>input type<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;button&quot;</span> id<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;btnCalculate&quot;</span> value<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;Calculate&quot;</span> onclick<span style="color: #339933;">=</span><span style="color: #3366CC;">&quot;Invoke_Cal()&quot;</span><span style="color: #339933;">/&gt;</span></pre>
<li> Similar to the previous steps, you can add the <code>onclick</code> event handler inside every button to capture click event and add its corresponding JavaScript functions inside &lt;script&gt;.
</ol>
<h2><a name="Calling_OriginC_Function_in_JavaScript"></a><span class="mw-headline">Calling OriginC Function in JavaScript</span></h2>
<p>In this example, arithmetic operations are performed in OriginC in order to show you how to call OriginC in JavaScript.
</p><p>In JavaScript, you will use the function <code>window.external.ExtCall</code> to call into OriginC:
</p>
<pre class="javascript" style="font-family:monospace;">window.<span style="color: #660066;">external</span>.<span style="color: #660066;">ExtCall</span><span style="color: #009900;">&#40;</span>“OriginC <span style="">Function</span> Name”<span style="color: #339933;">,</span> Parameter1<span style="color: #339933;">,</span> Parameter2…<span style="color: #009900;">&#41;</span></pre>
<table class="note">

<tr>
<td><b>Note:</b>
<ol><li> Currently, no more than 5 parameters can be passed into ExtCall, including the OriginC function name. </li>
<li> The parameters that can be passed as input arguments of OriginC should only be primitive types, including bool, integer, double and string.</li></ol>
</td></tr></table>
<p>Now, you can modify the functions inside &lt;script&gt; as follows after you figure out how to call OriginC in JavaScript, and the complete code is available in the <a class="external text" href="http://blog.originlab.com/wp-content/uploads/2016/11/HTMLDlgExamples.zip" target="_blank">HTML sample file</a>.
</p>
<pre class="javascript" style="font-family:monospace;"><span style="color: #339933;">&lt;</span>script<span style="color: #339933;">&gt;</span>
    <span style="color: #000066; font-weight: bold;">var</span> PlusOp <span style="color: #339933;">=</span> <span style="color: #3366CC;">&quot;+&quot;</span><span style="color: #339933;">;</span>
    <span style="color: #000066; font-weight: bold;">var</span> MinusOp <span style="color: #339933;">=</span> <span style="color: #3366CC;">&quot;-&quot;</span><span style="color: #339933;">;</span>
    <span style="color: #000066; font-weight: bold;">var</span> MultiplyOp <span style="color: #339933;">=</span> <span style="color: #3366CC;">&quot;*&quot;</span><span style="color: #339933;">;</span>
    <span style="color: #000066; font-weight: bold;">var</span> DivOp <span style="color: #339933;">=</span> <span style="color: #3366CC;">&quot;/&quot;</span><span style="color: #339933;">;</span>

    <span style="color: #000066; font-weight: bold;">function</span> Invoke_AddOp<span style="color: #009900;">&#40;</span>strOp<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
    	<span style="color: #000066; font-weight: bold;">var</span> OriginStr <span style="color: #339933;">=</span> document.<span style="color: #660066;">getElementById</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'Equation'</span><span style="color: #009900;">&#41;</span>.<span style="color: #660066;">innerHTML</span><span style="color: #339933;">;</span>
        <span style="color: #006600; font-style: italic;">//Calling OriginC function AddOp to show the operator symbol in textbox</span>
    	<span style="color: #000066; font-weight: bold;">var</span> NewStr <span style="color: #339933;">=</span> window.<span style="color: #660066;">external</span>.<span style="color: #660066;">ExtCall</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;AddOp&quot;</span><span style="color: #339933;">,</span> OriginStr<span style="color: #339933;">,</span> strOp<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    	document.<span style="color: #660066;">getElementById</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'Equation'</span><span style="color: #009900;">&#41;</span>.<span style="color: #660066;">innerHTML</span> <span style="color: #339933;">=</span> NewStr<span style="color: #339933;">;</span>
    <span style="color: #009900;">&#125;</span>

    <span style="color: #000066; font-weight: bold;">function</span> Invoke_AddNum<span style="color: #009900;">&#40;</span>NewNum<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
    	<span style="color: #000066; font-weight: bold;">var</span> OriginStr <span style="color: #339933;">=</span> document.<span style="color: #660066;">getElementById</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'Equation'</span><span style="color: #009900;">&#41;</span>.<span style="color: #660066;">innerHTML</span><span style="color: #339933;">;</span>
        <span style="color: #006600; font-style: italic;">//Calling OriginC function AddNum to show the number input in textbox</span>
    	<span style="color: #000066; font-weight: bold;">var</span> NewStr <span style="color: #339933;">=</span> window.<span style="color: #660066;">external</span>.<span style="color: #660066;">ExtCall</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;AddNum&quot;</span><span style="color: #339933;">,</span> OriginStr<span style="color: #339933;">,</span> NewNum<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    	document.<span style="color: #660066;">getElementById</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'Equation'</span><span style="color: #009900;">&#41;</span>.<span style="color: #660066;">innerHTML</span> <span style="color: #339933;">=</span> NewStr<span style="color: #339933;">;</span>
    <span style="color: #009900;">&#125;</span>

    <span style="color: #000066; font-weight: bold;">function</span> Invoke_Cal<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
    	<span style="color: #000066; font-weight: bold;">var</span> Str <span style="color: #339933;">=</span> document.<span style="color: #660066;">getElementById</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'Equation'</span><span style="color: #009900;">&#41;</span>.<span style="color: #660066;">innerHTML</span><span style="color: #339933;">;</span>
        <span style="color: #006600; font-style: italic;">//Calling OriginC function Calculate to get the result of equation</span>
    	<span style="color: #000066; font-weight: bold;">var</span> Result <span style="color: #339933;">=</span> window.<span style="color: #660066;">external</span>.<span style="color: #660066;">ExtCall</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;Calculate&quot;</span><span style="color: #339933;">,</span> Str<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    	document.<span style="color: #660066;">getElementById</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'Equation'</span><span style="color: #009900;">&#41;</span>.<span style="color: #660066;">innerHTML</span> <span style="color: #339933;">=</span> Result<span style="color: #339933;">;</span>
    <span style="color: #009900;">&#125;</span>

    <span style="color: #000066; font-weight: bold;">function</span> Invoke_Clear<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
        <span style="color: #006600; font-style: italic;">//Calling OriginC function Clear to erase the text in textbox</span>
    	document.<span style="color: #660066;">getElementById</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'Equation'</span><span style="color: #009900;">&#41;</span>.<span style="color: #660066;">innerHTML</span> <span style="color: #339933;">=</span> window.<span style="color: #660066;">external</span>.<span style="color: #660066;">ExtCall</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">&quot;Clear&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    <span style="color: #009900;">&#125;</span>
<span style="color: #339933;">&lt;/</span>script<span style="color: #339933;">&gt;</span></pre>
<h2><a name="Creating_an_HTML_Dialog"></a><span class="mw-headline">Creating an HTML Dialog</span></h2>
<p>In this section, you edit and execute OriginC code to launch the calculator dialogue in Origin.
</p>
<ol>
<li> In <b>Code Builder</b>, create a new cpp file named Calculator.cpp under the path of SimpleCalc.html

<li> Include the needed headers.

<pre class="c" style="font-family:monospace;"><span style="color: #339933;">#include &lt;Origin.h&gt;</span>
<span style="color: #339933;">#include &lt;..\OriginLab\DialogEx.h&gt;</span>
<span style="color: #339933;">#include &lt;..\OriginLab\HTMLDlg.h&gt;</span></pre>
<li> Derive a user defined HTML dialog class from the class <code>HTMLDlg</code>

<pre class="c" style="font-family:monospace;">class OriginCalculatorDlg<span style="color: #339933;">:</span> public HTMLDlg 
<span style="color: #009900;">&#123;</span>
    public<span style="color: #339933;">:</span>
        string GetInitURL<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> 
            <span style="color: #009900;">&#123;</span> 
                <span style="color: #b1b100;">return</span> GetFilePath<span style="color: #009900;">&#40;</span>__FILE__<span style="color: #009900;">&#41;</span> <span style="color: #339933;">+</span> <span style="color: #ff0000;">&quot;SimpleCalc.html&quot;</span><span style="color: #339933;">;</span>
            <span style="color: #009900;">&#125;</span>
	string GetDialogTitle<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> 
            <span style="color: #009900;">&#123;</span>
                <span style="color: #b1b100;">return</span> <span style="color: #ff0000;">&quot;Simple Calculator&quot;</span><span style="color: #339933;">;</span>
            <span style="color: #009900;">&#125;</span>
<span style="color: #009900;">&#125;</span><span style="color: #339933;">;</span></pre>
<li> Add a main function <code>calc</code> which launches the calculator dialog.

<pre class="c" style="font-family:monospace;"><span style="color: #993333;">void</span> calc<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> 
<span style="color: #009900;">&#123;</span>
    OriginCalculatorDlg dlg<span style="color: #339933;">;</span>
    dlg.<span style="color: #202020;">DoModalEx</span><span style="color: #009900;">&#40;</span>GetWindow<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<span style="color: #009900;">&#125;</span></pre>
<li>Save all the code and build it, then execute the <code>calc()</code> function to open the dialog.
</ol>
<h2><a name="Adding_JavaScript_Callable_Prototypes_in_OriginC"></a><span class="mw-headline">Adding JavaScript Callable Prototypes in OriginC</span></h2>
<p>In this section, you add methods in your dialog class <code>OriginCalculatorDlg</code>, which are called in JavaScript to perform the basic arithmetic operations.
</p>
<ol>
<li> Add DECLARE_DISPATCH_MAP in your dialog class, which help JavaScript to locate the functions

<pre class="c" style="font-family:monospace;">public<span style="color: #339933;">:</span>
    DECLARE_DISPATCH_MAP</pre>
<li> Add the methods to perform arithmetic operations, show and clear the equation in textbox.

<pre class="c" style="font-family:monospace;"><span style="color: #666666; font-style: italic;">//when clicking any operator</span>
string OriginCalculatorDlg<span style="color: #339933;">::</span><span style="color: #202020;">AddOp</span><span style="color: #009900;">&#40;</span>string str<span style="color: #339933;">,</span> string strOp<span style="color: #009900;">&#41;</span> 
<span style="color: #009900;">&#123;</span>
    <span style="color: #b1b100;">return</span> str <span style="color: #339933;">+</span> <span style="color: #ff0000;">&quot; &quot;</span> <span style="color: #339933;">+</span> strOp <span style="color: #339933;">+</span> <span style="color: #ff0000;">&quot; &quot;</span><span style="color: #339933;">;</span>
<span style="color: #009900;">&#125;</span>
<span style="color: #666666; font-style: italic;">//when clicking any digits</span>
string OriginCalculatorDlg<span style="color: #339933;">::</span><span style="color: #202020;">AddNum</span><span style="color: #009900;">&#40;</span>string str<span style="color: #339933;">,</span> <span style="color: #993333;">int</span> NewNum<span style="color: #009900;">&#41;</span> 
<span style="color: #009900;">&#123;</span>
    <span style="color: #b1b100;">return</span> str <span style="color: #339933;">+</span> ftoa<span style="color: #009900;">&#40;</span>NewNum<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<span style="color: #009900;">&#125;</span>

<span style="color: #666666; font-style: italic;">//use LabTalk expression to evaluate</span>
<span style="color: #993333;">double</span> OriginCalculatorDlg<span style="color: #339933;">::</span><span style="color: #202020;">Calculate</span><span style="color: #009900;">&#40;</span>string str<span style="color: #009900;">&#41;</span> 
<span style="color: #009900;">&#123;</span>
    <span style="color: #993333;">double</span> dd<span style="color: #339933;">;</span>
    LT_evaluate<span style="color: #009900;">&#40;</span>str <span style="color: #339933;">,&amp;</span>dd<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span> 
    <span style="color: #b1b100;">return</span> dd<span style="color: #339933;">;</span>
<span style="color: #009900;">&#125;</span>

string OriginCalculatorDlg<span style="color: #339933;">::</span><span style="color: #202020;">Clear</span><span style="color: #009900;">&#40;</span><span style="color: #993333;">void</span><span style="color: #009900;">&#41;</span> 
<span style="color: #009900;">&#123;</span>
    <span style="color: #b1b100;">return</span> <span style="color: #ff0000;">&quot;&quot;</span><span style="color: #339933;">;</span>
<span style="color: #009900;">&#125;</span></pre>
<li> Declare the methods in your dialog class.

<pre class="c" style="font-family:monospace;">public<span style="color: #339933;">:</span>
    string AddOp<span style="color: #009900;">&#40;</span>string str<span style="color: #339933;">,</span> string strOp<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    string AddNum<span style="color: #009900;">&#40;</span>string str<span style="color: #339933;">,</span> <span style="color: #993333;">int</span> NewNum<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    <span style="color: #993333;">double</span> Calculate<span style="color: #009900;">&#40;</span>string str<span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
    string Clear<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></pre>
<li> Map the methods of your OriginC dialog class to the HTML dialog

<pre class="c" style="font-family:monospace;">BEGIN_DISPATCH_MAP<span style="color: #009900;">&#40;</span>OriginCalculatorDlg<span style="color: #339933;">,</span> HTMLDlg<span style="color: #009900;">&#41;</span>
    DISP_FUNCTION<span style="color: #009900;">&#40;</span>OriginCalculatorDlg<span style="color: #339933;">,</span> AddOp<span style="color: #339933;">,</span> VTS_STR<span style="color: #339933;">,</span> VTS_STR VTS_STR<span style="color: #009900;">&#41;</span>
    DISP_FUNCTION<span style="color: #009900;">&#40;</span>OriginCalculatorDlg<span style="color: #339933;">,</span> AddNum<span style="color: #339933;">,</span> VTS_STR<span style="color: #339933;">,</span> VTS_STR VTS_I4<span style="color: #009900;">&#41;</span>
    DISP_FUNCTION<span style="color: #009900;">&#40;</span>OriginCalculatorDlg<span style="color: #339933;">,</span> Calculate<span style="color: #339933;">,</span> VTS_R8<span style="color: #339933;">,</span> VTS_STR<span style="color: #009900;">&#41;</span>
    DISP_FUNCTION<span style="color: #009900;">&#40;</span>OriginCalculatorDlg<span style="color: #339933;">,</span> Clear<span style="color: #339933;">,</span> VTS_STR<span style="color: #339933;">,</span> VTS_VOID<span style="color: #009900;">&#41;</span>
END_DISPATCH_MAP</pre>
<table class="note">

<tr>
<td><b>Note:</b> The syntax of DISP_FUNCTION should be:
<pre class="c" style="font-family:monospace;">DISP_FUNCTION<span style="color: #009900;">&#40;</span>User<span style="color: #339933;">-</span>defined Dialog Class<span style="color: #339933;">,</span> Function Name<span style="color: #339933;">,</span> Type of Ouput<span style="color: #339933;">,</span> Type of Input Type of Input…<span style="color: #009900;">&#41;</span></pre>
<p>in which VTS_BOOL = bool, VTS_I4 = integer, VTS_R8 = double, VTS_STR = string and VTS_VOID = void.
</p>
</td></tr></table>
<li> Save the code and rebuilt it, then excute the calc() function again,  you can do simple calculation on this calculator now.</li>
</li>
</li>
</li>
</li>
</ol>






