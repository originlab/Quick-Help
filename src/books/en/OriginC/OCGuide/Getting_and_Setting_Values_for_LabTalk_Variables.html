<h1 class="firstHeading">1.15.1 Getting and Setting Values for LabTalk Variables</h1><p><span class="OIndex" style="display:none">LabTalk Variable, Get/Set in Origin C</span>
Origin C has the ability to get and set LabTalk numeric and string values and run LabTalk scripts.
</p>
<h2><a name="Getting_and_Setting_LabTalk_Numeric_Values"></a><span class="mw-headline">Getting and Setting LabTalk Numeric Values</span></h2>
<p>The Origin C <b><a href="../../OriginC/OriginC/LT_get_var_(global_function).html" title="OriginC:LT get var (global function)">LT_get_var</a></b><span class="OIndex" style="display:none">LT_get_var</span> and <b><a href="../../OriginC/OriginC/LT_set_var_(global_function).html" title="OriginC:LT set var (global function)">LT_set_var</a></b><span class="OIndex" style="display:none">LT_set_var</span> global functions are used for getting and setting LabTalk numeric values.  Numeric values include variables, system variables and object properties. Class member functions <b><a href="../../OriginC/OriginC/OriginObject-GetProp.html" title="OriginC:OriginObject-GetProp">OriginObject::GetProp</a></b> and <b><a href="../../OriginC/OriginC/OriginObject-SetProp.html" title="OriginC:OriginObject-SetProp">OriginObject::SetProp</a></b> can get and set object properties.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">double</span> dOriginVer;
LT_get_var<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;@V&quot;</span>, <span style="color: #000040;">&amp;</span>dOriginVer<span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Running Origin version&#160;%f<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, dOriginVer<span style="color: #000000;">&#41;</span>;</pre>
<p>This is how to set the minimum font size used in the Data Display window.
</p>
<pre class="oc" style="font-family:monospace;">LT_set_var<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;System.DataDisplay.MinFontSize&quot;</span>, <span style="color: #0000dd;">12</span><span style="color: #000000;">&#41;</span>;</pre>
<p>There are times when you will want to temporarily set a LabTalk variable, do some work, and then restore the LabTalk variable to its original value.  There are mainly two ways to do this. The first way is the long way to do it using <i>LT_get_var</i> and <i>LT_set_var</i>.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">double</span> dProgressBar;
LT_get_var<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;@NPO&quot;</span>, <span style="color: #000040;">&amp;</span>dProgressBar<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// get starting value</span>
LT_set_var<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;@NPO&quot;</span>, <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// set new value</span>
<span style="color: #008000;">//</span>
<span style="color: #008000;">// do some work</span>
<span style="color: #008000;">//</span>
LT_set_var<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;@NPO&quot;</span>, dProgressBar<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// restore starting value</span></pre>
<p>The next way is the simple way using the <i>LTVarTempChange</i> class. To use the class you simply pass the variable name and the temporary value. The constructor saves the starting value into a data member and sets the variable to the temporary value. The destructor will restore the variable to its starting value.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #000000;">&#123;</span>
    LTVarTempChange progressBar<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;@NPO&quot;</span>, <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #008000;">//</span>
    <span style="color: #008000;">// do some work</span>
    <span style="color: #008000;">//</span>
<span style="color: #000000;">&#125;</span></pre>
<p>This is how to set and get line object color.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">//This example assumes the active graph has a line object</span>
<span style="color: #0000ff;">void</span> SetProp_Ex1<span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> nColor <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>, string strName <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;line&quot;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    GraphLayer    gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    GraphObject    grobj;
    grobj <span style="color: #000080;">=</span> gl.<span style="color: #000000;">GraphObjects</span><span style="color: #000000;">&#40;</span>strName<span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">double</span> vv;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>grobj<span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        <span style="color: #0000ff;">int</span> nn <span style="color: #000080;">=</span> grobj.<span style="color: #000000;">SetProp</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;color&quot;</span>, nColor<span style="color: #000000;">&#41;</span>;
        out_int<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;SetProp return: &quot;</span>, nn<span style="color: #000000;">&#41;</span>;
        out_int<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;new color: &quot;</span>, grobj.<span style="color: #000000;">GetProp</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;color&quot;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #000000;">&#125;</span>
    <span style="color: #0000ff;">else</span>
        out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;no such obj&quot;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Getting_and_Setting_LabTalk_String_Values"></a><span class="mw-headline">Getting and Setting LabTalk String Values</span></h2>
<p>The Origin C <b><a href="../../OriginC/OriginC/LT_get_str_(global_function).html" title="OriginC:LT get str (global function)">LT_get_str</a></b><span class="OIndex" style="display:none">LT_get_str</span> and <b><a href="../../OriginC/OriginC/LT_set_str_(global_function).html" title="OriginC:LT set str (global function)">LT_set_str</a></b><span class="OIndex" style="display:none">LT_set_str</span> global functions are used for getting and setting LabTalk string values.  String values include variables, string substitution variables and object properties. Class member functions <b><a href="../../OriginC/OriginC/OriginObject-GetProp.html" title="OriginC:OriginObject-GetProp">OriginObject::GetProp</a></b> and <b><a href="../../OriginC/OriginC/OriginObject-SetProp.html" title="OriginC:OriginObject-SetProp">OriginObject::SetProp</a></b> can get and set object properties.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">char</span> szCustomDateFmt<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">200</span><span style="color: #000000;">&#93;</span>;
LT_get_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;System.Date.CustomFormat1$&quot;</span>, szCustomDateFmt, <span style="color: #0000dd;">200</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Custom Date Format 1: &#160;%s<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, szCustomDateFmt<span style="color: #000000;">&#41;</span>;</pre>
<p>This is how to set the font used in the Data Display window.
</p>
<pre class="oc" style="font-family:monospace;">LT_set_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;System.DataDisplay.Font$&quot;</span>, <span style="color: #ff00ff;">&quot;Courier&quot;</span><span style="color: #000000;">&#41;</span>;</pre>
<p>This is how to rename the active sheet of the active book.
</p>
<pre class="oc" style="font-family:monospace;">LT_set_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;wks.name$&quot;</span>, <span style="color: #ff00ff;">&quot;MySheet&quot;</span><span style="color: #000000;">&#41;</span>;</pre>






