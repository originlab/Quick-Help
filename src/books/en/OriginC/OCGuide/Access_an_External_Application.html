<h1 class="firstHeading">1.19.2 Access an External Application</h1><p><br />
The Microsoft Component Object Model (<span class="OIndex">COM</span>) is a software architecture that allows applications to be built from a binary software component, and it makes the development of software much easier and more effective.
</p><p><span class="OIndex" style="display:none">External Application, MS Excel</span><span class="OIndex" style="display:none">External Application, MS Word</span>Origin provides the capability for COM client programming, and it is supported only in <b>OriginPro</b>.  This mechanism uses <b>Object</b> type to represent all COM (automation server) objects. All COM objects can be initialized in two ways:
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">//by the CreateObject method</span>
Object oExcel;
oExcel <span style="color: #000080;">=</span> CreateObject<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Excel.Application&quot;</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">//by initialization from an existing COM object. </span>
Object oWorkBooks;
oWorkBooks <span style="color: #000080;">=</span> oExcel.<span style="color: #000000;">Workbooks</span>;</pre>
<p><span class="OIndex" style="display:none">Matlab</span><span class="OIndex" style="display:none">External Application, Execute Matlab Command</span>Origin C also provides a class to access <b>Matlab</b>, which enables communication between Origin and Matlab.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>Origin.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span>
<span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>externApps.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span> <span style="color: #008000;">//required header for the MATLAB class</span>
<span style="color: #0000ff;">void</span> test_Matlab<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    Matlab matlabObj<span style="color: #000000;">&#40;</span><span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span><span style="color: #000040;">!</span>matlabObj<span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;No MATLAB found&quot;</span><span style="color: #000000;">&#41;</span>;
        <span style="color: #0000ff;">return</span>;
    <span style="color: #000000;">&#125;</span>
 
    <span style="color: #008000;">//defines 3x5 matrix named ma</span>
    string strRet;
    strRet <span style="color: #000080;">=</span> matlabObj.<span style="color: #000000;">Execute</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;ma=[1 2 3 4 5; 
        4 5 6 7 8;10.3 4.5 -4.7 -23.2 -6.7]&quot;</span><span style="color: #000000;">&#41;</span>; 
    out_str<span style="color: #000000;">&#40;</span>strRet<span style="color: #000000;">&#41;</span>;<span style="color: #008000;">// show str from MATLAB</span>
 
    <span style="color: #008000;">// put matrix into Origin matrix</span>
    MatrixLayer matLayer;
    matLayer.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
    Matrix mao<span style="color: #000000;">&#40;</span>matLayer<span style="color: #000000;">&#41;</span>;
 
    <span style="color: #008000;">//Transfer MATLAB's matrix (ma) to Origin's mao matrix.</span>
    <span style="color: #0000ff;">BOOL</span> bRet <span style="color: #000080;">=</span> matlabObj.<span style="color: #000000;">GetMatrix</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;ma&quot;</span>, <span style="color: #000040;">&amp;</span>mao<span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<p>COM client programming in Origin C can be used to programmatically exchange data with MS Office applications. There is a comprehensive example demonstrating how to read data from Excel worksheets, plot a graph in Origin, and place it in a Word document. This example can be found in the <i>\Samples\COM Server and Client\MS Office\Client</i> subfolder in Origin.
</p><p>(<span class="OIndex" style="display:none">External Application, Database</span><span class="OIndex" style="display:none">Database, SQL</span>Origin C COM programming can also be used to communicate with databases by accessing an ActiveX Data Object (ADO), and there is a sample file demonstrating that SQL and Access databases can be imported to a worksheet, and subsequent data modifications returned to the database. For more information, see the file ADOSample.c in the <i>Samples\COM Server and Client\ADO\Client</i> subfolder of Origin.
</p>





