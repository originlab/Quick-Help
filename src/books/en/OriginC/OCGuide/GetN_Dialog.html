<h1 class="firstHeading">1.18.1.2 GetN Dialog</h1><p><span class="OIndex" style="display:none">GetN Simple Dialog</span>
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Simple_Dialog"><span class="tocnumber">1</span> <span class="toctext">Simple Dialog</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Controls"><span class="tocnumber">2</span> <span class="toctext">Controls</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Event_Handler"><span class="tocnumber">3</span> <span class="toctext">Event Handler</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Apply_Button"><span class="tocnumber">4</span> <span class="toctext">Apply Button</span></a></li>
</ul>
</div>

<h2><a name="Simple_Dialog"></a><span class="mw-headline">Simple Dialog</span></h2>
<p>There is an easy way to create a simple dialog using <a href="../../OriginC/Category/GetN_(OriginC).html" title="Category:GetN (OriginC)">GetN</a> macros and  <a href="../../OriginC/OriginC/GetNBox_(global_function).html" title="OriginC:GetNBox (global function)">GetNBox</a> function.
</p><p>The dialog looks below:
</p>
<div style="text-align: center;">
<p><a  class="image"><img alt="Creat simple dialog.png" src="../images/GetN_Dialog/Creat_simple_dialog.png?v=40853" width="368"  /></a>
</p>
</div>
<p>Run the following function to open the upper dialog:
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>GetNbox.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span>
<span style="color: #0000ff;">void</span> simple_dialog<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    GETN_BOX<span style="color: #000000;">&#40;</span>trRoot<span style="color: #000000;">&#41;</span>   <span style="color: #008000;">// define a Tree variable named &quot;trRoot&quot;</span>
    
    <span style="color: #008000;">// data range control</span>
    GETN_INTERACTIVE<span style="color: #000000;">&#40;</span>Input, <span style="color: #ff00ff;">&quot;Input data&quot;</span>, <span style="color: #ff00ff;">&quot;[Book1]Sheet1!A&quot;</span><span style="color: #000000;">&#41;</span>
    
    <span style="color: #008000;">// radio button</span>
    GETN_RADIO_INDEX_EX<span style="color: #000000;">&#40;</span>Operator, <span style="color: #ff00ff;">&quot;Operator&quot;</span>, <span style="color: #0000dd;">0</span>, <span style="color: #ff00ff;">&quot;Add|Subtract&quot;</span><span style="color: #000000;">&#41;</span>
    
    <span style="color: #008000;">// list box</span>
    GETN_LIST<span style="color: #000000;">&#40;</span>type, <span style="color: #ff00ff;">&quot;Operand&quot;</span>, <span style="color: #0000dd;">0</span>, <span style="color: #ff00ff;">&quot;Constant|Reference Data&quot;</span><span style="color: #000000;">&#41;</span>
    
    <span style="color: #008000;">// string edit box </span>
    GETN_STR<span style="color: #000000;">&#40;</span>Constant, <span style="color: #ff00ff;">&quot;Constant&quot;</span>, <span style="color: #ff00ff;">&quot;10&quot;</span><span style="color: #000000;">&#41;</span>
    
    <span style="color: #008000;">// choose a data range for reference data</span>
    GETN_INTERACTIVE<span style="color: #000000;">&#40;</span>Reference, <span style="color: #ff00ff;">&quot;Reference Data&quot;</span>, <span style="color: #ff00ff;">&quot;[Book1]Sheet1!B&quot;</span><span style="color: #000000;">&#41;</span>
    
    <span style="color: #008000;">// choose a column for output data</span>
    GETN_INTERACTIVE<span style="color: #000000;">&#40;</span>Output, <span style="color: #ff00ff;">&quot;Output data&quot;</span>, <span style="color: #ff00ff;">&quot;[Book1]Sheet1!C&quot;</span><span style="color: #000000;">&#41;</span>  

    <span style="color: #008000;">// bring up dialog</span>
    GetNBox<span style="color: #000000;">&#40;</span>trRoot <span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Controls"></a><span class="mw-headline">Controls</span></h2>
<p>The following table lists the commonly used controls. For more controls and style setup, please refer to <a href="../../OriginC/Category/GetN_(OriginC).html" title="Category:GetN (OriginC)">Origin C Reference: Macros: GetN</a>.
</p>
<table class="TableGrid" style="; border-spacing: 0px; border-spacing: 0px;" border="1">
<tr>
<th bgcolor="#EFEFEF" width="2%">Picture
</th>
<th bgcolor="#EFEFEF" width="18%">Name
</th></tr>
<tr>
<td align="center"> <a  class="image"><img alt="Radio.png" src="../images/GetN_Dialog/Radio.png?v=40861" width="14"  /></a>
</td>
<td>
<ul><li> <a href="../../OriginC/OriginC/GETN_RADIO_INDEX.html" title="OriginC:GETN RADIO INDEX">GETN_RADIO_INDEX</a> </li>
<li> <a href="../../OriginC/OriginC/GETN_RADIO_INDEX_EX.html" title="OriginC:GETN RADIO INDEX EX">GETN_RADIO_INDEX_EX</a></li></ul>
</td></tr>
<tr>
<td align="center"> <a  class="image"><img alt="Checkbox.png" src="../images/GetN_Dialog/Checkbox.png?v=40863" width="15"  /></a>
</td>
<td>
<ul><li><a href="../../OriginC/OriginC/GETN_CHECK.html" title="OriginC:GETN CHECK">GETN_CHECK</a></li></ul>
</td></tr>
<tr>
<td align="center"> <a  class="image"><img alt="Listbox.png" src="../images/GetN_Dialog/Listbox.png?v=40865" width="46"  /></a>
</td>
<td>
<ul><li><a href="../../OriginC/OriginC/GETN_LISTBOX.html" title="OriginC:GETN LISTBOX">GETN_LISTBOX</a> </li>
<li><a href="../../OriginC/OriginC/GETN_MULTISEL_LISTBOX.html" title="OriginC:GETN MULTISEL LISTBOX">GETN_MULTISEL_LISTBOX</a></li></ul>
</td></tr>
<tr>
<td align="center"> <a  class="image"><img alt="Button group.png" src="../images/GetN_Dialog/Button_group.png?v=40874" width="72"  /></a>
</td>
<td>
<ul><li><a href="../../OriginC/OriginC/GETN_BUTTON_GROUP.html" title="OriginC:GETN BUTTON GROUP">GETN_BUTTON_GROUP</a></li></ul>
</td></tr>
<tr>
<td align="center"> <a  class="image"><img alt="Button.png" src="../images/GetN_Dialog/Button.png?v=40868" width="78"  /></a>
</td>
<td>
<ul><li><a href="../../OriginC/OriginC/GETN_BUTTON.html" title="OriginC:GETN BUTTON">GETN_BUTTON</a></li></ul>
</td></tr>
<tr>
<td align="center"> <a  class="image"><img alt="Combo edit.png" src="../images/GetN_Dialog/Combo_edit.png?v=40895" width="70"  /></a>
<p><a  class="image"><img alt="Combo.png" src="../images/GetN_Dialog/Combo.png?v=40862" width="93"  /></a>
</p>
</td>
<td>
<ul><li><a href="../../OriginC/OriginC/GETN_COMBO.html" title="OriginC:GETN COMBO">GETN_COMBO</a>(for numeric)</li>
<li><a href="../../OriginC/OriginC/GETN_LIST.html" title="OriginC:GETN LIST">GETN_LIST</a>(for string, return the index of selection)</li>
<li><a href="../../OriginC/OriginC/GETN_STRLIST.html" title="OriginC:GETN STRLIST">GETN_STRLIST</a>(for string, return the selected text)</li>
<li><a href="../../OriginC/OriginC/GETN_STR_GROUP.html" title="OriginC:GETN STR GROUP">GETN_STR_GROUP</a>(multiple selections)</li></ul>
</td></tr>
<tr>
<td align="center"> <a  class="image"><img alt="Combo button.png" src="../images/GetN_Dialog/Combo_button.png?v=40864" width="109"  /></a>
</td>
<td>
<ul><li><a href="../../OriginC/OriginC/GETN_COMBO_BUTTON.html" title="OriginC:GETN COMBO BUTTON">GETN_COMBO_BUTTON</a></li></ul>
</td></tr>
<tr>
<td align="center"> <a  class="image"><img alt="Range.png" src="../images/GetN_Dialog/Range.png?v=40893" width="102"  /></a>
</td>
<td>
<ul><li><a href="../../OriginC/OriginC/GETN_RANGE.html" title="OriginC:GETN RANGE">GETN_RANGE</a></li></ul>
</td></tr>
<tr>
<td align="center"> <a  class="image"><img alt="Editbox.png" src="../images/GetN_Dialog/Editbox.png?v=40871" width="120"  /></a>
</td>
<td>
<ul><li><a href="../../OriginC/OriginC/GETN_STR.html" title="OriginC:GETN STR">GETN_STR</a>(for string)</li>
<li><a href="../../OriginC/OriginC/GETN_NUM.html" title="OriginC:GETN NUM">GETN_NUM</a>(for numeric)</li>
<li><a href="../../OriginC/OriginC/GETN_MULTILINE_TEXT.html" title="OriginC:GETN MULTILINE TEXT">GETN_MULTILINE_TEXT</a>(multiple lines text)</li></ul>
</td></tr>
<tr>
<td align="center"> <a  class="image"><img alt="SPINNOR DOUBLE.png" src="../images/GetN_Dialog/SPINNOR_DOUBLE.png?v=40881" width="138"  /></a>
</td>
<td>
<ul><li><a href="../../OriginC/OriginC/GETN_SPINNOR_DOUBLE.html" title="OriginC:GETN SPINNOR DOUBLE">GETN_SPINNOR_DOUBLE</a></li></ul>
</td></tr>
<tr>
<td align="center"> <a  class="image"><img alt="Slider.png" src="../images/GetN_Dialog/Slider.png?v=40880" width="150"  /></a>
</td>
<td>
<ul><li><a href="../../OriginC/OriginC/GETN_SLIDER.html" title="OriginC:GETN SLIDER">GETN_SLIDER</a></li>
<li><a href="../../OriginC/OriginC/GETN_SLIDEREDIT.html" title="OriginC:GETN SLIDEREDIT">GETN_SLIDEREDIT</a>(editable)</li></ul>
</td></tr>
<tr>
<td align="center"> <a  class="image"><img alt="Color.png" src="../images/GetN_Dialog/Color.png?v=40876" width="100"  /></a>
</td>
<td>
<ul><li><a href="../../OriginC/OriginC/GETN_COLOR.html" title="OriginC:GETN COLOR">GETN_COLOR</a></li></ul>
</td></tr>
<tr>
<td align="center"> <a  class="image"><img alt="Symbol.png" src="../images/GetN_Dialog/Symbol.png?v=40877" width="111"  /></a>
</td>
<td>
<ul><li><a href="../../OriginC/OriginC/GETN_SYMBOL.html" title="OriginC:GETN SYMBOL">GETN_SYMBOL</a></li></ul>
</td></tr>
<tr>
<td align="center"> <a  class="image"><img alt="SEPARATOR LINE.png" src="../images/GetN_Dialog/SEPARATOR_LINE.png?v=40879" width="115"  /></a>
</td>
<td>
<ul><li><a href="../../OriginC/OriginC/GETN_SEPARATOR_LINE.html" title="OriginC:GETN SEPARATOR LINE">GETN_SEPARATOR_LINE</a></li></ul>
</td></tr>
<tr>
<td align="center"> <a  class="image"><img alt="Data.png" src="../images/GetN_Dialog/Data.png?v=40883" width="102"  /></a>
</td>
<td>
<ul><li><a href="../../OriginC/OriginC/GETN_DATE.html" title="OriginC:GETN DATE">GETN_DATE</a></li></ul>
</td></tr>
<tr>
<td align="center"> <a  class="image"><img alt="Times.png" src="../images/GetN_Dialog/Times.png?v=40884" width="122"  /></a>
</td>
<td>
<ul><li><a href="../../OriginC/OriginC/GETN_TIME.html" title="OriginC:GETN TIME">GETN_TIME</a></li></ul>
</td></tr>
<tr>
<td align="center"> <a  class="image"><img alt="Password.png" src="../images/GetN_Dialog/Password.png?v=40878" width="167"  /></a>
</td>
<td>
<ul><li><a href="../../OriginC/OriginC/GETN_PASSWORD.html" title="OriginC:GETN PASSWORD">GETN_PASSWORD</a></li></ul>
</td></tr>
<tr>
<td align="center"> <a  class="image"><img alt="Input data.png" src="../images/GetN_Dialog/Input_data.png?v=40889" width="192"  /></a>
<p><a  class="image"><img alt="Data range.png" src="../images/GetN_Dialog/Data_range.png?v=40892" width="192"  /></a>
</p>
</td>
<td>
<ul><li><a href="../../OriginC/OriginC/GETN_XYRANGE.html" title="OriginC:GETN XYRANGE">GETN_XYRANGE</a></li>
<li><a href="../../OriginC/OriginC/GETN_XYRANGE_COMPLEX.html" title="OriginC:GETN XYRANGE COMPLEX">GETN_XYRANGE_COMPLEX</a></li>
<li><a href="../../OriginC/OriginC/GETN_XYZRANGE.html" title="OriginC:GETN XYZRANGE">GETN_XYZRANGE</a></li>
<li><a href="../../OriginC/OriginC/GETN_INTERACTIVE.html" title="OriginC:GETN INTERACTIVE">GETN_INTERACTIVE</a></li></ul>
</td></tr></table>
<h2><a name="Event_Handler"></a><span class="mw-headline">Event Handler</span></h2>
<p>In the above dialog box, you can add an event function like below function <i>node_event</i> to dynamicly show/hide a control, or reconstruct a combo list and so on. 
</p><p>Change the line in the above example function from
</p>
<pre class="oc" style="font-family:monospace;">GetNBox<span style="color: #000000;">&#40;</span>trRoot<span style="color: #000000;">&#41;</span>;</pre>
<p>to 
</p>
<pre class="oc" style="font-family:monospace;">GetNBox<span style="color: #000000;">&#40;</span>trRoot, node_event<span style="color: #000000;">&#41;</span>;</pre>
<p>Add an event fucntion as below:
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">int</span> node_event<span style="color: #000000;">&#40;</span>TreeNode<span style="color: #000040;">&amp;</span> trRoot, <span style="color: #0000ff;">int</span> nRow, <span style="color: #0000ff;">int</span> nEvent, DWORD<span style="color: #000040;">&amp;</span> dwEnables, 	
	LPCSTR lpcszNodeName, WndContainer<span style="color: #000040;">&amp;</span> getNContainer, string<span style="color: #000040;">&amp;</span> strAux, 
	string<span style="color: #000040;">&amp;</span> strErrMsg<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> lstrcmp<span style="color: #000000;">&#40;</span>lpcszNodeName, <span style="color: #ff00ff;">&quot;type&quot;</span><span style="color: #000000;">&#41;</span> <span style="color: #000040;">||</span> GETNE_ON_VALUE_CHANGE <span style="color: #000080;">==</span> nEvent 
    <span style="color: #000040;">||</span> GETNE_ON_INIT <span style="color: #000080;">==</span> nEvent <span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        trRoot.<span style="color: #000000;">Constant</span>.<span style="color: #000000;">Show</span> <span style="color: #000080;">=</span> <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> trRoot.<span style="color: #000000;">type</span>.<span style="color: #000000;">nVal</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// show Constant</span>
        trRoot.<span style="color: #000000;">Reference</span>.<span style="color: #000000;">Show</span> <span style="color: #000080;">=</span> <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span> <span style="color: #000080;">==</span> trRoot.<span style="color: #000000;">type</span>.<span style="color: #000000;">nVal</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// show reference</span>
    <span style="color: #000000;">&#125;</span>
    <span style="color: #0000ff;">return</span> <span style="color: #0000dd;">0</span>;   
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Apply_Button"></a><span class="mw-headline">Apply Button</span></h2>
<p>The default GetN Dialog has OK and Cancel buttons; the Apply button is optional. When the Apply button is displayed, and the user clicks this button, you may want to call the related event function to do something. 
</p><p>The following is an example showing how to display the Apply button on a GetN dialog, and call the event function <i>_apply_event</i> when the Apply button is clicked.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>GetNbox.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span>
<span style="color: #0000ff;">void</span> GETN_Apply_ex1<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    GETN_TREE<span style="color: #000000;">&#40;</span>tr<span style="color: #000000;">&#41;</span>    
    GETN_COLOR<span style="color: #000000;">&#40;</span>LineColor, <span style="color: #ff00ff;">&quot;Color&quot;</span>, <span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>
    <span style="color: #008000;">// the option to set color list to contain custom panel</span>
    GETN_COLOR_CHOICE_OPTIONS<span style="color: #000000;">&#40;</span>COLORLIST_CUSTOM <span style="color: #000040;">|</span> COLORLIST_SINGLE<span style="color: #000000;">&#41;</span> 
    
    <span style="color: #0000ff;">bool</span> bShowApply <span style="color: #000080;">=</span> <span style="color: #0000ff;">true</span>;
    <span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>GetNBox<span style="color: #000000;">&#40;</span>tr, <span style="color: #0000ff;">NULL</span>, <span style="color: #ff00ff;">&quot;Example&quot;</span>, <span style="color: #0000ff;">NULL</span>, GetWindow<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>, bShowApply, 
		_apply_event<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
    	out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Click OK&quot;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span>

<span style="color: #008000;">// The interface of apply button event function need to according to </span>
<span style="color: #008000;">// PAPPLY_FUNC typedef.</span>
<span style="color: #0000ff;">bool</span> _apply_event<span style="color: #000000;">&#40;</span>TreeNode<span style="color: #000040;">&amp;</span> tr<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    <span style="color: #0000ff;">int</span> nIndex <span style="color: #000080;">=</span> tr.<span style="color: #000000;">LineColor</span>.<span style="color: #000000;">nVal</span>;     
    UINT cr <span style="color: #000080;">=</span> color_index_to_rgb<span style="color: #000000;">&#40;</span>nIndex<span style="color: #000000;">&#41;</span>;
    <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Red =&#160;%d, Green =&#160;%d, Blue =&#160;%d<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, GetRValue<span style="color: #000000;">&#40;</span>cr<span style="color: #000000;">&#41;</span>, 
		GetGValue<span style="color: #000000;">&#40;</span>cr<span style="color: #000000;">&#41;</span>, GetBValue<span style="color: #000000;">&#40;</span>cr<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;
    <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span>;
<span style="color: #000000;">&#125;</span></pre>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/GetN_Dialog/Tip_icon.png?v=21427" width="57"  border="0" /></td><td><p>By default, the Apply button in a GetN dialog will become inactive after first click and won't be active again unless a change is made to the GetN dialog. If you want to keep the Apply button always active, set system variable @EAB = 0.
</p></td></tr></table>


