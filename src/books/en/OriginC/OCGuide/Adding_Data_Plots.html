<h1 class="firstHeading">1.7.2 Adding Data Plots</h1><p><br />
<span class="OIndex" style="display:none">Plotting, from Worksheet</span><b>Plots</b> or <b>Data plots</b> are representations of your data within a graph layer.  Each graph layer may contain one or more plots.
</p><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#2D_Plot_.28XY.2C_YErr.2C_Bar.2FColumn.29"><span class="tocnumber">1</span> <span class="toctext">2D Plot (XY, YErr, Bar/Column)</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Plot_XY_Scatter"><span class="tocnumber">1.1</span> <span class="toctext">Plot XY Scatter</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Attach_YErr_Plot"><span class="tocnumber">1.2</span> <span class="toctext">Attach YErr Plot</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Bar.2FColumn_Plot"><span class="tocnumber">1.3</span> <span class="toctext">Bar/Column Plot</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="#3D_Plot"><span class="tocnumber">2</span> <span class="toctext">3D Plot</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Contour_PlotGraph_Layer.2C_Add_Contour_PlotDataPlot.2C_Contour"><span class="tocnumber">3</span> <span class="toctext">Contour Plot<span class="OIndex" style="display:none">Graph Layer, Add Contour Plot</span><span class="OIndex" style="display:none">DataPlot, Contour</span></span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#Plot_XYZ_Contour"><span class="tocnumber">3.1</span> <span class="toctext">Plot XYZ Contour</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Plot_Color_Fill_Contour"><span class="tocnumber">3.2</span> <span class="toctext">Plot Color Fill Contour</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-9"><a href="#Image_PlotGraph_Layer.2C_Add_Matrix_Image_PlotDataPlot.2C_Image_Type"><span class="tocnumber">4</span> <span class="toctext">Image Plot<span class="OIndex" style="display:none">Graph Layer, Add Matrix Image Plot</span><span class="OIndex" style="display:none">DataPlot, Image Type</span></span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#Multi-AxesGraph_Layer.2C_Double-Y_Axes"><span class="tocnumber">5</span> <span class="toctext">Multi-Axes<span class="OIndex" style="display:none">Graph Layer, Double-Y Axes</span></span></a></li>
<li class="toclevel-1 tocsection-11"><a href="#Multi-Panels_.28Multi-Layer.2C_with_Shared_X-Axis.29Plotting_in_Multiple_Graph_LayersGraph_Layer.2C_Set_Ticks_and_TickLabels_as_Auto_ColorGraph_Page.2C_Arrange_Layers"><span class="tocnumber">6</span> <span class="toctext">Multi-Panels (Multi-Layer, with Shared X-Axis)<span class="OIndex" style="display:none">Plotting in Multiple Graph Layers</span><span class="OIndex" style="display:none">Graph Layer, Set Ticks and TickLabels as Auto Color</span><span class="OIndex" style="display:none">Graph Page, Arrange Layers</span></span></a></li>
</ul>
</div>

<h2><a name="2D_Plot_.28XY.2C_YErr.2C_Bar.2FColumn.29"></a><span class="mw-headline">2D Plot (XY, YErr, Bar/Column)</span></h2>
<h3><a name="Plot_XY_Scatter"></a><span class="mw-headline">Plot XY Scatter</span></h3>
<p><span class="OIndex" style="display:none">Graph Layer, Add XY Data Plot</span><span class="OIndex" style="display:none">Graph Layer, Rescale</span>The following code shows how to construct an XYYErr data range from the active worksheet, and then plot the data range in a newly created graph.
</p>
<pre class="oc" style="font-family:monospace;">Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;	

<span style="color: #008000;">// The range name must be X, Y, Z or ED(for YErr) to make sense.</span>
DataRange dr;
dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">0</span>, <span style="color: #ff00ff;">&quot;X&quot;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// 1st column for X data</span>
dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">1</span>, <span style="color: #ff00ff;">&quot;Y&quot;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// 2nd column for Y data</span>
dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">2</span>, <span style="color: #ff00ff;">&quot;ED&quot;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Optional, 3th column for Y Error data</span>

<span style="color: #008000;">// Create a graph window</span>
GraphPage gp;
gp.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Origin&quot;</span><span style="color: #000000;">&#41;</span>;
GraphLayer gl <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Get active layer</span>

<span style="color: #008000;">// Plot XY data range as scatter</span>
<span style="color: #008000;">// IDM_PLOT_SCATTER is plot type id, see other types plot id in oPlotIDs.h file.</span>
<span style="color: #0000ff;">int</span> nPlotIndex <span style="color: #000080;">=</span> gl.<span style="color: #000000;">AddPlot</span><span style="color: #000000;">&#40;</span>dr, IDM_PLOT_SCATTER<span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// Returns plot index (offset is 0), else return -1 for error</span>
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> nPlotIndex <span style="color: #000080;">&gt;=</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">&#41;</span> 
<span style="color: #000000;">&#123;</span>
	gl.<span style="color: #000000;">Rescale</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Rescale axes to show all data points</span>
<span style="color: #000000;">&#125;</span></pre>
<h3><a name="Attach_YErr_Plot"></a><span class="mw-headline">Attach YErr Plot</span></h3>
<p><span class="OIndex" style="display:none">Graph Layer, Add YErr Data Plot</span><span class="OIndex" style="display:none">DataPlot, Error Bar</span><span class="OIndex" style="display:none">Graph Layer, Get Active Data Plot</span>Attach YErr data to an existing XY data plot.
</p>
<pre class="oc" style="font-family:monospace;">GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
DataPlot dp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">&#40;</span><span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;	<span style="color: #008000;">// Get active data plot</span>

<span style="color: #008000;">// Get Y Error column</span>
WorksheetPage wksPage<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Book1&quot;</span><span style="color: #000000;">&#41;</span>;
Worksheet wks <span style="color: #000080;">=</span> wksPage.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
Column	colErrBar<span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>;	 

<span style="color: #008000;">// Plot Y Error column to the active data plot</span>
Curve	crv<span style="color: #000000;">&#40;</span>dp<span style="color: #000000;">&#41;</span>;
<span style="color: #0000ff;">int</span>		nErrPlotIndex <span style="color: #000080;">=</span> gl.<span style="color: #000000;">AddErrBar</span><span style="color: #000000;">&#40;</span>crv, colErrBar<span style="color: #000000;">&#41;</span>;
out_int<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;nErrPlotIndex = &quot;</span>, nErrPlotIndex<span style="color: #000000;">&#41;</span>;</pre>
<h3><a name="Bar.2FColumn_Plot"></a><span class="mw-headline">Bar/Column Plot</span></h3>
<p><span class="OIndex" style="display:none">Graph Layer, Add Bar/Column Plot</span><span class="OIndex" style="display:none">DataPlot, Bar/Column</span>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// before running make sure the active window is worksheet</span>
Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
DataRange dr;
dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">1</span>, <span style="color: #ff00ff;">&quot;Y&quot;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Construct data range with one column</span>

GraphPage gp;
gp.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;BAR&quot;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Create graph with the specified template</span>
GraphLayer gl <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Get active graph layer</span>

<span style="color: #0000ff;">int</span> index <span style="color: #000080;">=</span> gl.<span style="color: #000000;">AddPlot</span><span style="color: #000000;">&#40;</span>dr, IDM_PLOT_BAR<span style="color: #000000;">&#41;</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> index <span style="color: #000080;">&gt;=</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	out_str<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Plot bar&quot;</span><span style="color: #000000;">&#41;</span>;
	gl.<span style="color: #000000;">Rescale</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="3D_Plot"></a><span class="mw-headline">3D Plot</span></h2>
<p><span class="OIndex" style="display:none">Graph Layer, Add 3D Surface Plot</span><span class="OIndex" style="display:none">Matrixbook, Open OGM File in Window</span><span class="OIndex" style="display:none">Plotting, from Matrix</span>
Plot a 3D surface from a matrix on a graph window.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Prepare matrix data		</span>
MatrixLayer ml;
string strFile <span style="color: #000080;">=</span> GetAppPath<span style="color: #000000;">&#40;</span><span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span> <span style="color: #000040;">+</span> <span style="color: #ff00ff;">&quot;Samples<span style="color: #666666; font-weight: bold;">\\</span>Matrix Conversion and Gridding<span style="color: #666666; font-weight: bold;">\\</span>
2D Gaussian.ogm&quot;</span>;
ml.<span style="color: #000000;">Open</span><span style="color: #000000;">&#40;</span>strFile<span style="color: #000000;">&#41;</span>;
MatrixObject mo <span style="color: #000080;">=</span> ml.<span style="color: #000000;">MatrixObjects</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Create graph page with template</span>
GraphPage gp;
gp.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;CMAP&quot;</span><span style="color: #000000;">&#41;</span>; 
GraphLayer gl <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Plot 3D surface</span>
<span style="color: #0000ff;">int</span> nPlotIndex <span style="color: #000080;">=</span> gl.<span style="color: #000000;">AddPlot</span><span style="color: #000000;">&#40;</span>mo, IDM_PLOT_SURFACE_COLORMAP<span style="color: #000000;">&#41;</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> nPlotIndex<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	gl.<span style="color: #000000;">Rescale</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;3D Surface plotted successfully<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Contour_PlotGraph_Layer.2C_Add_Contour_PlotDataPlot.2C_Contour"></a><span class="mw-headline">Contour Plot<span class="OIndex" style="display:none">Graph Layer, Add Contour Plot</span><span class="OIndex" style="display:none">DataPlot, Contour</span></span></h2>
<h3><a name="Plot_XYZ_Contour"></a><span class="mw-headline">Plot XYZ Contour</span></h3>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Before running, make sure there are XYZ columns with data in the active</span>
<span style="color: #008000;">// worksheet window. Or you can import \Samples\Matrix Conversion and Gridding\</span>
<span style="color: #008000;">// XYZ Random Gaussian.dat into worksheet.</span>
Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
DataRange dr;
dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">0</span>, <span style="color: #ff00ff;">&quot;X&quot;</span><span style="color: #000000;">&#41;</span>;
dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">1</span>, <span style="color: #ff00ff;">&quot;Y&quot;</span><span style="color: #000000;">&#41;</span>;
dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">2</span>, <span style="color: #ff00ff;">&quot;Z&quot;</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Create graph with template</span>
GraphPage gp;	
gp.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;TriContour&quot;</span><span style="color: #000000;">&#41;</span>;	
GraphLayer gl <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Plot XYZ contour with type id</span>
<span style="color: #0000ff;">int</span> nPlot <span style="color: #000080;">=</span> gl.<span style="color: #000000;">AddPlot</span><span style="color: #000000;">&#40;</span>dr, IDM_PLOT_TRI_CONTOUR<span style="color: #000000;">&#41;</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> nPlot <span style="color: #000080;">&gt;=</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	gl.<span style="color: #000000;">Rescale</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;XYZ contour plotted successfully<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<h3><a name="Plot_Color_Fill_Contour"></a><span class="mw-headline">Plot Color Fill Contour</span></h3>
<pre class="oc" style="font-family:monospace;">MatrixLayer ml <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
MatrixObject mo <span style="color: #000080;">=</span> ml.<span style="color: #000000;">MatrixObjects</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Create graph window with template</span>
GraphPage gp;
gp.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;contour&quot;</span><span style="color: #000000;">&#41;</span>; 
GraphLayer gl <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;

<span style="color: #0000ff;">int</span> nPlot <span style="color: #000080;">=</span> gl.<span style="color: #000000;">AddPlot</span><span style="color: #000000;">&#40;</span>mo, IDM_PLOT_CONTOUR<span style="color: #000000;">&#41;</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> nPlot <span style="color: #000080;">&gt;=</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	gl.<span style="color: #000000;">Rescale</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Image_PlotGraph_Layer.2C_Add_Matrix_Image_PlotDataPlot.2C_Image_Type"></a><span class="mw-headline">Image Plot<span class="OIndex" style="display:none">Graph Layer, Add Matrix Image Plot</span><span class="OIndex" style="display:none">DataPlot, Image Type</span></span></h2>
<pre class="oc" style="font-family:monospace;">MatrixLayer ml <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
MatrixObject mo <span style="color: #000080;">=</span> ml.<span style="color: #000000;">MatrixObjects</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Create graph window with template</span>
GraphPage gp;
gp.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;image&quot;</span><span style="color: #000000;">&#41;</span>; 
GraphLayer gl <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;

<span style="color: #0000ff;">int</span> nPlot <span style="color: #000080;">=</span> gl.<span style="color: #000000;">AddPlot</span><span style="color: #000000;">&#40;</span>mo, IDM_PLOT_MATRIX_IMAGE<span style="color: #000000;">&#41;</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> nPlot <span style="color: #000080;">&gt;=</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	gl.<span style="color: #000000;">Rescale</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Multi-AxesGraph_Layer.2C_Double-Y_Axes"></a><span class="mw-headline">Multi-Axes<span class="OIndex" style="display:none">Graph Layer, Double-Y Axes</span></span></h2>
<p>The following example code shows how to show/hide and set format on the four axes - left, bottom, right, and top in one graph layer. 
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>..\Originlab\graph_utils.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span> <span style="color: #008000;">// needed for AXIS_*</span>
GraphLayer gl <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Show all axes and labels. 0 or 1, 1 for show.</span>
vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> vnAxes<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span>, vnLabels<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span>, vnTitles<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span>;
vnAxes<span style="color: #000000;">&#91;</span>AXIS_BOTTOM<span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
vnAxes<span style="color: #000000;">&#91;</span>AXIS_LEFT<span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
vnAxes<span style="color: #000000;">&#91;</span>AXIS_TOP<span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
vnAxes<span style="color: #000000;">&#91;</span>AXIS_RIGHT<span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;	
vnLabels <span style="color: #000080;">=</span> vnAxes;	

<span style="color: #008000;">// Show axis titles of left and bottom axes. 0 or 1, 1 for show.</span>
vnTitles<span style="color: #000000;">&#91;</span>AXIS_BOTTOM<span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
vnTitles<span style="color: #000000;">&#91;</span>AXIS_LEFT<span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
vnTitles<span style="color: #000000;">&#91;</span>AXIS_TOP<span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
vnTitles<span style="color: #000000;">&#91;</span>AXIS_RIGHT<span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;	

<span style="color: #008000;">// Set the major tick and minor tick of all axes as IN format</span>
<span style="color: #008000;">// See other TICK_* items in graph_utils.h.</span>
vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> vnMajorTicks<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span>, vnMinorTicks<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span>;
vnMajorTicks<span style="color: #000000;">&#91;</span>AXIS_BOTTOM<span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> TICK_IN;
vnMajorTicks<span style="color: #000000;">&#91;</span>AXIS_LEFT<span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> TICK_IN;
vnMajorTicks<span style="color: #000000;">&#91;</span>AXIS_TOP<span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> TICK_IN;
vnMajorTicks<span style="color: #000000;">&#91;</span>AXIS_RIGHT<span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> TICK_IN;		
vnMinorTicks <span style="color: #000080;">=</span> vnMajorTicks;

gl_smart_show_object<span style="color: #000000;">&#40;</span>gl, vnAxes, vnLabels, vnTitles, vnMajorTicks, vnMinorTicks<span style="color: #000000;">&#41;</span>;</pre>
<h2><a name="Multi-Panels_.28Multi-Layer.2C_with_Shared_X-Axis.29Plotting_in_Multiple_Graph_LayersGraph_Layer.2C_Set_Ticks_and_TickLabels_as_Auto_ColorGraph_Page.2C_Arrange_Layers"></a><span class="mw-headline">Multi-Panels (Multi-Layer, with Shared X-Axis)<span class="OIndex" style="display:none">Plotting in Multiple Graph Layers</span><span class="OIndex" style="display:none">Graph Layer, Set Ticks and TickLabels as Auto Color</span><span class="OIndex" style="display:none">Graph Page, Arrange Layers</span></span></h2>
<p>The following example shows how to construct multiple graph layers in one graph page, all layers sharing the x axis in one layer, then plot XY data sets one by one from a worksheet to each graph layer.
</p><p>Before compiling the following codes, you need to run this command to build the graph_utils.c file to your current workspace.
</p>
<pre class="lt" style="font-family:monospace;">run.<span style="color: #000080;">LoadOC</span><span style="color: #000000;">&#40;</span>Originlab\graph_utils.<span style="color: #000080;">c</span>, <span style="color: #0000dd;">16</span><span style="color: #000000;">&#41;</span>;</pre>
<p>Compile the following Origin C code. Before running, make sure there is a workbook named Book1, and it has one X column and at least two Y columns.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>..\Originlab\graph_utils.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span> <span style="color: #008000;">// needed for page_add_layer function</span>
<span style="color: #008000;">// Construct data range from Book1</span>
WorksheetPage wksPage<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Book1&quot;</span><span style="color: #000000;">&#41;</span>;
Worksheet wks <span style="color: #000080;">=</span> wksPage.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// get the first worksheet in Book1</span>
DataRange dr;
dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">0</span>, <span style="color: #ff00ff;">&quot;X&quot;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// 1st column as X data</span>
dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">1</span>, <span style="color: #ff00ff;">&quot;Y&quot;</span>, <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// 2nd column to last one for Y data</span>

<span style="color: #008000;">// Get the number of Y</span>
DWORD dwRules <span style="color: #000080;">=</span> DRR_GET_DEPENDENT <span style="color: #000040;">|</span> DRR_NO_FACTORS;
<span style="color: #0000ff;">int</span> nNumYs <span style="color: #000080;">=</span> dr.<span style="color: #000000;">GetNumData</span><span style="color: #000000;">&#40;</span>dwRules<span style="color: #000000;">&#41;</span>;	

<span style="color: #008000;">// Add more layers with right Axis and link to the 1st layer</span>
GraphPage gp;
gp.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Origin&quot;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #0000ff;">while</span> <span style="color: #000000;">&#40;</span> gp.<span style="color: #000000;">Layers</span>.<span style="color: #000000;">Count</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">&lt;</span> nNumYs <span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	page_add_layer<span style="color: #000000;">&#40;</span>gp, <span style="color: #0000ff;">false</span>, <span style="color: #0000ff;">false</span>, <span style="color: #0000ff;">false</span>, <span style="color: #0000ff;">true</span>, 
		ADD_LAYER_INIT_SIZE_POS_MOVE_OFFSET, <span style="color: #0000ff;">false</span>, <span style="color: #0000dd;">0</span>, LINK_STRAIGHT<span style="color: #000000;">&#41;</span>; 
<span style="color: #000000;">&#125;</span>

<span style="color: #008000;">// Loop and add plot from each XY data range to graph layer</span>
foreach<span style="color: #000000;">&#40;</span>GraphLayer gl in gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	<span style="color: #0000ff;">int</span> nLayerIndex <span style="color: #000080;">=</span> gl.<span style="color: #000000;">GetIndex</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	
	<span style="color: #008000;">// Get the sub XY range from dr</span>
	DataRange drOne;
	dr.<span style="color: #000000;">GetSubRange</span><span style="color: #000000;">&#40;</span>drOne, dwRules, nLayerIndex<span style="color: #000000;">&#41;</span>;		
	
	<span style="color: #008000;">// Plot one XY range to graph layer</span>
	<span style="color: #0000ff;">int</span> nPlot <span style="color: #000080;">=</span> gl.<span style="color: #000000;">AddPlot</span><span style="color: #000000;">&#40;</span>drOne, IDM_PLOT_LINE<span style="color: #000000;">&#41;</span>;
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> nPlot <span style="color: #000080;">&gt;=</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		DataPlot dp <span style="color: #000080;">=</span> gl.<span style="color: #000000;">DataPlots</span><span style="color: #000000;">&#40;</span>nPlot<span style="color: #000000;">&#41;</span>;
		dp.<span style="color: #000000;">SetColor</span><span style="color: #000000;">&#40;</span>nLayerIndex<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Set data plot as different color</span>

		<span style="color: #008000;">// Set the ticks and ticklabels of right Y axis auto color</span>
		gl.<span style="color: #000000;">YAxis</span>.<span style="color: #000000;">AxisObjects</span><span style="color: #000000;">&#40;</span>AXISOBJPOS_AXIS_SECOND<span style="color: #000000;">&#41;</span>.<span style="color: #000000;">RightTicks</span>.<span style="color: #000000;">Color</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> 
		gl.<span style="color: #000000;">YAxis</span>.<span style="color: #000000;">AxisObjects</span><span style="color: #000000;">&#40;</span>AXISOBJPOS_LABEL_SECOND<span style="color: #000000;">&#41;</span>.<span style="color: #000000;">RightLabels</span>.<span style="color: #000000;">Color</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> 
		INDEX_COLOR_AUTOMATIC;
				
		gl.<span style="color: #000000;">Rescale</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">&#125;</span>		
<span style="color: #000000;">&#125;</span></pre>






