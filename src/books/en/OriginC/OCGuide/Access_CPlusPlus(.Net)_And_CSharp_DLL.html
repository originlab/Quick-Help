<h1 class="firstHeading">1.19.1.2 Access CPlusPlus(.Net) And CSharp DLL</h1><p><br />
This chapter will introduce how to access the DLL created by C++(.Net) or C# in Origin C.
</p>
<h2><a name="Access_C.23_Class_DLL"></a><span class="mw-headline">Access C# Class DLL</span></h2>
<p>The following example shows how to create a DLL in Microsoft Visual Studio 2005 with C#, and then access it in Origin C. This Dll provides a class with properties and functions. Function Sum shows how to pass data array from Origin C vector to C# function.
</p>
<ol>
<li>Run Microsoft Visual Studio as administrator, select File -&gt; New -&gt; Project..., in New Project dialog, choose the settings as below:
<div><a  class="image"><img alt="Ocguide externaldll csharp1 newproject.png" src="../images/Access_CPlusPlus(.Net)_And_CSharp_DLL/Ocguide_externaldll_csharp1_newproject.png?v=43790" width="578"  /></a></div></li>
<li>Copy the following codes to cs file.
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">using</span> <span style="color: #000000;">System</span>;
<span style="color: #0000ff;">using</span> <span style="color: #000000;">System</span>.<span style="color: #000000;">Collections</span>.<span style="color: #000000;">Generic</span>;
<span style="color: #0000ff;">using</span> <span style="color: #000000;">System</span>.<span style="color: #000000;">Text</span>;
<span style="color: #0000ff;">using</span> <span style="color: #000000;">System</span>.<span style="color: #000000;">Runtime</span>.<span style="color: #000000;">InteropServices</span>;

<span style="color: #0000ff;">namespace</span> temp
<span style="color: #000000;">&#123;</span>
    <span style="color: #000000;">&#91;</span>Guid<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;4A5BFDFA-7D41-49d1-BB57-C6816E9EDC87&quot;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#93;</span>
    <span style="color: #0000ff;">public</span> interface INet_Temp
    <span style="color: #000000;">&#123;</span>
        <span style="color: #0000ff;">double</span> Celsius<span style="color: #000000;">&#123;</span> get; set; <span style="color: #000000;">&#125;</span>
        <span style="color: #0000ff;">double</span> Fahrenheit<span style="color: #000000;">&#123;</span> get; set; <span style="color: #000000;">&#125;</span>
 
        <span style="color: #0000ff;">double</span> GetCelsius<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
        <span style="color: #0000ff;">double</span> GetFahrenheit<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;

        <span style="color: #0000ff;">double</span> Sum<span style="color: #000000;">&#40;</span>object obj<span style="color: #000000;">&#41;</span>;
    <span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span>

<span style="color: #0000ff;">namespace</span> temp
<span style="color: #000000;">&#123;</span>
    <span style="color: #000000;">&#91;</span>Guid<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;2AE913C6-795F-49cc-B8DF-FAF7FBA49538&quot;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#93;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> NET_Temperature <span style="color: #000000;">:</span> INet_Temp
    <span style="color: #000000;">&#123;</span>
        <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">double</span> celsius;
        <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">double</span> fahrenheit;

        <span style="color: #0000ff;">public</span> NET_Temperature<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
        <span style="color: #000000;">&#123;</span>
        <span style="color: #000000;">&#125;</span>

        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">double</span> Celsius
        <span style="color: #000000;">&#123;</span>
            get<span style="color: #000000;">&#123;</span> <span style="color: #0000ff;">return</span> celsius; <span style="color: #000000;">&#125;</span>
            set <span style="color: #000000;">&#123;</span> celsius <span style="color: #000080;">=</span> value; fahrenheit <span style="color: #000080;">=</span> celsius <span style="color: #000040;">+</span> <span style="color: #0000dd;">273.5</span>;  <span style="color: #000000;">&#125;</span>
        <span style="color: #000000;">&#125;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">double</span> Fahrenheit
        <span style="color: #000000;">&#123;</span>
            get <span style="color: #000000;">&#123;</span> <span style="color: #0000ff;">return</span> fahrenheit; <span style="color: #000000;">&#125;</span>
            set <span style="color: #000000;">&#123;</span> fahrenheit <span style="color: #000080;">=</span> value; celsius <span style="color: #000080;">=</span> fahrenheit <span style="color: #000040;">-</span> <span style="color: #0000dd;">273.5</span>; <span style="color: #000000;">&#125;</span>
        <span style="color: #000000;">&#125;</span>

        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">double</span> GetCelsius<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
        <span style="color: #000000;">&#123;</span>
            <span style="color: #0000ff;">return</span> celsius;
        <span style="color: #000000;">&#125;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">double</span> GetFahrenheit<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
        <span style="color: #000000;">&#123;</span>
            <span style="color: #0000ff;">return</span> fahrenheit;
        <span style="color: #000000;">&#125;</span>      

        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">double</span> Sum<span style="color: #000000;">&#40;</span>object obj<span style="color: #000000;">&#41;</span>
        <span style="color: #000000;">&#123;</span>
            <span style="color: #0000ff;">double</span><span style="color: #000000;">&#91;</span><span style="color: #000000;">&#93;</span> arr <span style="color: #000080;">=</span> <span style="color: #000000;">&#40;</span><span style="color: #0000ff;">double</span><span style="color: #000000;">&#91;</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span>obj;
            <span style="color: #0000ff;">double</span> sum <span style="color: #000080;">=</span> <span style="color: #0000dd;">0.0</span>;
            <span style="color: #0000ff;">for</span> <span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> nn <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; nn <span style="color: #000080;">&lt;</span> arr.<span style="color: #000000;">Length</span>; nn<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span>
            <span style="color: #000000;">&#123;</span>
                sum <span style="color: #000040;">+</span><span style="color: #000080;">=</span> arr<span style="color: #000000;">&#91;</span>nn<span style="color: #000000;">&#93;</span>;
            <span style="color: #000000;">&#125;</span>
            <span style="color: #0000ff;">return</span> sum;
        <span style="color: #000000;">&#125;</span> 
    <span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre></li>
<li>Choose menu Tools -&gt; Create GUID, in opening dialog select Registry Format radio button, click New GUID button and then click Copy button. Paste this GUID to replace that one in [Guid("...")] in the above codes. Reproduce this action again to replace the second GUID in code. </li>
<li>Right click on the project and select Properties to open the property page. Go to Application tab, and click Assembly Information button, then check the check-box of Make assembly COM-Visible. If for 32 bit version, go to the Build tab, and select the check-box of Register for COM interop. If for 64 bit version, go to Build Events tab, and then copy and paste the following command line to the Post-build event command line text box. Press F6 to build solution. </li>
<pre class="oc" style="font-family:monospace;"><span style="color: #ff00ff;">&quot;%Windir%<span style="color: #666666; font-weight: bold;">\M</span>icrosoft.NET<span style="color: #666666; font-weight: bold;">\F</span>ramework64<span style="color: #666666; font-weight: bold;">\v</span>4.0.30319<span style="color: #666666; font-weight: bold;">\r</span>egasm&quot;</span> <span style="color: #ff00ff;">&quot;$(TargetPath)&quot;</span> <span style="color: #000040;">/</span>CodeBase</pre>
<li>Start Origin, open Code Builder, new a c file, then copy the following Origin C code to c file.
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">void</span> access_DLL<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	Object obj <span style="color: #000080;">=</span> CreateObject<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;temp.NET_Temperature&quot;</span><span style="color: #000000;">&#41;</span>;
	
	obj.<span style="color: #000000;">Celsius</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; <span style="color: #008000;">// access property</span>
	out_double<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;&quot;</span>, obj.<span style="color: #000000;">GetFahrenheit</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// access function</span>
	
	obj.<span style="color: #000000;">Fahrenheit</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">300</span>;
	out_double<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;&quot;</span>, obj.<span style="color: #000000;">GetCelsius</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;

	vector vec;
	vec.<span style="color: #000000;">Data</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">10</span>,<span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
	_VARIANT var <span style="color: #000080;">=</span> vec.<span style="color: #000000;">GetAs1DArray</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	out_double<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;&quot;</span>, obj.<span style="color: #000000;">Sum</span><span style="color: #000000;">&#40;</span>var<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre></li>
</ol>
<h2><a name="Access_C.23_and_C.2B.2B_Resource_DLL"></a><span class="mw-headline">Access C# and C++ Resource DLL</span></h2>
<p>The following shows how to create an ActiveX control by C#, and use it in a dialog in Origin C.
</p><p>Steps 1~7 shows how to create an C# ActiveX control in Microsoft Visual Studio 2005.
</p>
<ol>
<li>Start Microsoft Visual Studio 2005, choose File -&gt; New -&gt; Project... to open New Project dialog, do the following settings, then click OK button.
<div><a  class="image"><img alt="Ocguide externaldll csharp2 newproject.png" src="../images/Access_CPlusPlus(.Net)_And_CSharp_DLL/Ocguide_externaldll_csharp2_newproject.png?v=43794" width="572"  /></a></div>
</li>
<li>Copy the following codes to UserControl.cs file to add a protected override function to set control fill color and a public function to set control border.
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">using</span> <span style="color: #000000;">System</span>;
<span style="color: #0000ff;">using</span> <span style="color: #000000;">System</span>.<span style="color: #000000;">Collections</span>.<span style="color: #000000;">Generic</span>;
<span style="color: #0000ff;">using</span> <span style="color: #000000;">System</span>.<span style="color: #000000;">ComponentModel</span>;
<span style="color: #0000ff;">using</span> <span style="color: #000000;">System</span>.<span style="color: #000000;">Drawing</span>;
<span style="color: #0000ff;">using</span> <span style="color: #000000;">System</span>.<span style="color: #000000;">Data</span>;
<span style="color: #0000ff;">using</span> <span style="color: #000000;">System</span>.<span style="color: #000000;">Text</span>;
<span style="color: #0000ff;">using</span> <span style="color: #000000;">System</span>.<span style="color: #000000;">Windows</span>.<span style="color: #000000;">Forms</span>;
<span style="color: #0000ff;">using</span> <span style="color: #000000;">System</span>.<span style="color: #000000;">Runtime</span>.<span style="color: #000000;">InteropServices</span>;

<span style="color: #0000ff;">namespace</span> SampleControl
<span style="color: #000000;">&#123;</span>
    <span style="color: #000000;">&#91;</span>Guid<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;A31FE123-FD5C-41a1-9102-D25EBD5FDFAF&quot;</span><span style="color: #000000;">&#41;</span>,
    ComSourceInterfaces<span style="color: #000000;">&#40;</span>typeof<span style="color: #000000;">&#40;</span>UserEvents<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>,
    ClassInterface<span style="color: #000000;">&#40;</span>ClassInterfaceType.<span style="color: #000000;">None</span><span style="color: #000000;">&#41;</span>,<span style="color: #000000;">&#93;</span>
    <span style="color: #0000ff;">public</span> partial <span style="color: #0000ff;">class</span> UserControl1 <span style="color: #000000;">:</span> UserControl, UserControl1Interface
    <span style="color: #000000;">&#123;</span>
        <span style="color: #0000ff;">public</span> UserControl1<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
        <span style="color: #000000;">&#123;</span>
            InitializeComponent<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
        <span style="color: #000000;">&#125;</span>

        <span style="color: #0000ff;">protected</span> override <span style="color: #0000ff;">void</span> OnPaint<span style="color: #000000;">&#40;</span>PaintEventArgs pe<span style="color: #000000;">&#41;</span>
        <span style="color: #000000;">&#123;</span>
            Brush brush <span style="color: #000080;">=</span> <span style="color: #0000ff;">new</span> SolidBrush<span style="color: #000000;">&#40;</span>Color.<span style="color: #000000;">Beige</span><span style="color: #000000;">&#41;</span>;

            pe.<span style="color: #000000;">Graphics</span>.<span style="color: #000000;">FillRectangle</span><span style="color: #000000;">&#40;</span>brush, ClientRectangle<span style="color: #000000;">&#41;</span>;
        <span style="color: #000000;">&#125;</span>

        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> SetBorder<span style="color: #000000;">&#40;</span><span style="color: #0000ff;">bool</span> bSet<span style="color: #000000;">&#41;</span>
        <span style="color: #000000;">&#123;</span>
            <span style="color: #0000ff;">this</span>.<span style="color: #000000;">BorderStyle</span> <span style="color: #000080;">=</span> bSet&#160;? BorderStyle.<span style="color: #000000;">FixedSingle</span> <span style="color: #000000;">:</span>
                        BorderStyle.<span style="color: #000000;">None</span>;
            Refresh<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
        <span style="color: #000000;">&#125;</span>
    <span style="color: #000000;">&#125;</span>

    <span style="color: #008000;">//declare an Interface for the control settings</span>
    <span style="color: #000000;">&#91;</span>Guid<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;CCBD6133-813D-4dbb-BB91-16E3EFAE66B0&quot;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#93;</span>
    <span style="color: #0000ff;">public</span> interface UserControl1Interface
    <span style="color: #000000;">&#123;</span>
        <span style="color: #0000ff;">void</span> SetBorder<span style="color: #000000;">&#40;</span><span style="color: #0000ff;">bool</span> bSet<span style="color: #000000;">&#41;</span>;
    <span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre></li>
<li>Select Tools -&gt; Create GUID to open Create GUID dialog, choose Registry Format radio button, click New GUID and Copy button to copy the newly created GUID. Use the new GUID to replace the one in above code [Guid("...")].</li>
<li>Choose UserControl1.cs[Design] tab, in Properties window, click Events button <a  class="image"><img alt="Ocguide externaldll csharp2 eventbutton.png" src="../images/Access_CPlusPlus(.Net)_And_CSharp_DLL/Ocguide_externaldll_csharp2_eventbutton.png?v=31771" width="23"  /></a>, drag scroll bar to choose MouseClick and double click it to add mouse click event function into UserControl.cs file. Use the same method to add mouse double click event.</li>
<li>In UserControl1l.cs file, copy the following code outside UserControl1 class.
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">//declare delegates for events </span>
<span style="color: #0000ff;">public</span> delegate <span style="color: #0000ff;">void</span> MouseAction<span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> x, <span style="color: #0000ff;">int</span> y<span style="color: #000000;">&#41;</span>;</pre></li>
<li>In UserControl1 class, add the following implements.
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">public</span> event MouseAction OnUserClick;
<span style="color: #0000ff;">public</span> event MouseAction OnUserDbClick;

<span style="color: #0000ff;">private</span> <span style="color: #0000ff;">void</span> UserControl1_MouseClick<span style="color: #000000;">&#40;</span>object sender, MouseEventArgs e<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
      <span style="color: #0000ff;">if</span> <span style="color: #000000;">&#40;</span>OnUserClick <span style="color: #000040;">!</span><span style="color: #000080;">=</span> <span style="color: #0000ff;">null</span><span style="color: #000000;">&#41;</span>
      <span style="color: #000000;">&#123;</span>
          OnUserClick<span style="color: #000000;">&#40;</span>e.<span style="color: #000000;">X</span>, e.<span style="color: #000000;">Y</span><span style="color: #000000;">&#41;</span>;
      <span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span>

<span style="color: #0000ff;">private</span> <span style="color: #0000ff;">void</span> UserControl1_MouseDoubleClick<span style="color: #000000;">&#40;</span>object sender, MouseEventArgs e<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
      <span style="color: #0000ff;">if</span> <span style="color: #000000;">&#40;</span>OnUserDbClick <span style="color: #000040;">!</span><span style="color: #000080;">=</span> <span style="color: #0000ff;">null</span><span style="color: #000000;">&#41;</span>
      <span style="color: #000000;">&#123;</span>
          OnUserDbClick<span style="color: #000000;">&#40;</span>e.<span style="color: #000000;">X</span>, e.<span style="color: #000000;">Y</span><span style="color: #000000;">&#41;</span>;
      <span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre></li>
<li>Outside UserControl1 class, add the following interface.
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">//declare interface for events</span>
<span style="color: #000000;">&#91;</span>Guid<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;DA090A6F-FFAC-4a39-ACD3-351FA509CA86&quot;</span><span style="color: #000000;">&#41;</span>, 
    InterfaceType<span style="color: #000000;">&#40;</span>ComInterfaceType.<span style="color: #000000;">InterfaceIsIDispatch</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#93;</span>
<span style="color: #0000ff;">public</span> interface UserEvents
<span style="color: #000000;">&#123;</span>
    <span style="color: #000000;">&#91;</span>DispIdAttribute<span style="color: #000000;">&#40;</span>0x60020001<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#93;</span>
    <span style="color: #0000ff;">void</span> OnUserClick<span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> x, <span style="color: #0000ff;">int</span> y<span style="color: #000000;">&#41;</span>;

    <span style="color: #000000;">&#91;</span>DispIdAttribute<span style="color: #000000;">&#40;</span>0x60020002<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#93;</span>
    <span style="color: #0000ff;">void</span> OnUserDbClick<span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> x, <span style="color: #0000ff;">int</span> y<span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre></li>
<li>
Create a resource-only DLL in Visual Studio 2008 as explained in <a href="../../OriginC/OCGuide/Simple_Hello_World_Dialog.html#Create_Resource-only_DLL_in_Visual_Studio_2008" title="OCGuide:Simple Hello World Dialog">Dialog Builder: Simple Hello World Dialog: Create Resource-only DLL in Visual Studio 2008</a>
</li>
<li>
Use an ActiveX control in a dialog and show dialog by Origin C. In Origin Code Builder, create a c file, and copy the following code to it.
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">//Dialog and control Ids. Need change dialog id according to real case.</span>
<span style="color: #0000ff;">#define</span> IDD_DIALOG1                     <span style="color: #0000dd;">101</span>
<span style="color: #0000ff;">#define</span> IDC_DOTNET						<span style="color: #0000dd;">1000</span>

<span style="color: #008000;">//Exposed events from Control</span>
<span style="color: #0000ff;">#define</span>	ON_INTEROP_CLICK<span style="color: #000000;">&#40;</span>_idCntl, _ocFunc<span style="color: #000000;">&#41;</span>	
ON_ACTIVEX_EVENT<span style="color: #000000;">&#40;</span>0x60020001, _idCntl, _ocFunc, VTS_CTRL VTS_I4 VTS_I4<span style="color: #000000;">&#41;</span>

<span style="color: #0000ff;">#define</span>	ON_INTEROP_DBLCLICK<span style="color: #000000;">&#40;</span>_idCntl, _ocFunc<span style="color: #000000;">&#41;</span>	
ON_ACTIVEX_EVENT<span style="color: #000000;">&#40;</span>0x60020002, _idCntl, _ocFunc, VTS_CTRL VTS_I4 VTS_I4<span style="color: #000000;">&#41;</span>


<span style="color: #0000ff;">class</span> CDotNetComInteropDlg <span style="color: #000000;">:</span> <span style="color: #0000ff;">public</span> Dialog
<span style="color: #000000;">&#123;</span>
<span style="color: #0000ff;">public</span><span style="color: #000000;">:</span>
	CDotNetComInteropDlg<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;

	EVENTS_BEGIN
	ON_INIT<span style="color: #000000;">&#40;</span>OnInitDialog<span style="color: #000000;">&#41;</span> 
	<span style="color: #008000;">//Event handler entries for the exposed events</span>
	ON_INTEROP_CLICK<span style="color: #000000;">&#40;</span>IDC_DOTNET, OnClick<span style="color: #000000;">&#41;</span>
	ON_INTEROP_DBLCLICK<span style="color: #000000;">&#40;</span>IDC_DOTNET, OnDblClick<span style="color: #000000;">&#41;</span>
	EVENTS_END
	
	<span style="color: #0000ff;">BOOL</span> OnClick<span style="color: #000000;">&#40;</span>Control ctrl, <span style="color: #0000ff;">int</span> x, <span style="color: #0000ff;">int</span> y<span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Clicked at (%d,%d)<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, x,y<span style="color: #000000;">&#41;</span>;
		<span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span>;
	<span style="color: #000000;">&#125;</span>
	
	<span style="color: #0000ff;">BOOL</span> OnDblClick<span style="color: #000000;">&#40;</span>Control ctrl, <span style="color: #0000ff;">int</span> x, <span style="color: #0000ff;">int</span> y<span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		<span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;DblClicked at (%d,%d)<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, x,y<span style="color: #000000;">&#41;</span>;
		<span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span>;
	<span style="color: #000000;">&#125;</span>

	
	<span style="color: #0000ff;">BOOL</span> OnInitDialog<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	
	Control m_ctrlDotNet;
<span style="color: #000000;">&#125;</span>;


<span style="color: #008000;">// Do not specify DLL file path here. Assume the dll file under the same </span>
<span style="color: #008000;">// path with the current c file.</span>
CDotNetComInteropDlg<span style="color: #000000;">::</span><span style="color: #000000;">CDotNetComInteropDlg</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">:</span> Dialog<span style="color: #000000;">&#40;</span>IDD_DIALOG1, <span style="color: #ff00ff;">&quot;DialogBuilder.dll&quot;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	InitMsgMap<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span>


<span style="color: #0000ff;">BOOL</span> CDotNetComInteropDlg<span style="color: #000000;">::</span><span style="color: #000000;">OnInitDialog</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>	
	<span style="color: #008000;">//[Guid(&quot;A31FE123-FD5C-41a1-9102-D25EBD5FDFAF&quot;)]</span>
	GUID guid <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span>0xA31FE123, 0xFD5C, 0x41a1, 
		<span style="color: #000000;">&#123;</span>0x91, 0x02, 0xD2, 0x5E, 0xBD, 0x5F, 0xDF, 0xAF<span style="color: #000000;">&#125;</span><span style="color: #000000;">&#125;</span>;
	
	RECT rect <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">20</span>,<span style="color: #0000dd;">20</span>,<span style="color: #0000dd;">200</span>,<span style="color: #0000dd;">100</span><span style="color: #000000;">&#125;</span>;
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>m_ctrlDotNet.<span style="color: #000000;">CreateActiveXControl</span><span style="color: #000000;">&#40;</span>guid, WS_CHILD<span style="color: #000040;">|</span>WS_VISIBLE,
		rect, GetSafeHwnd<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>, IDC_DOTNET<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		<span style="color: #008000;">//Control intialization using the exposed interface of </span>
		<span style="color: #008000;">//the DotNet control</span>
		Object ctrlObj <span style="color: #000080;">=</span> m_ctrlDotNet.<span style="color: #000000;">GetActiveXControl</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
		ctrlObj.<span style="color: #000000;">SetBorder</span><span style="color: #000000;">&#40;</span><span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">&#125;</span>
	<span style="color: #0000ff;">return</span> <span style="color: #0000ff;">TRUE</span>;
<span style="color: #000000;">&#125;</span>

<span style="color: #0000ff;">void</span> Launch_CDotNetComInteropDlg<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	CDotNetComInteropDlg dlgDotNet;
	dlgDotNet.<span style="color: #000000;">DoModal</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
</li>
</ol>






