<h1 class="firstHeading">1.6.2.1 Worksheet Column Operation</h1><p>To perform operation on worksheet column, you can use <a href="../../OriginC/Category/Column_(class).html" title="Category:Column (class)">Column</a> class or <a href="../../OriginC/Category/Worksheet_(class).html" title="Category:Worksheet (class)">Worksheet</a> class.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Add_ColumnInsert_ColumnAdd_or_Insert_Column"><span class="tocnumber">1</span> <span class="toctext"><span class="OIndex" style="display:none">Add Column</span><span class="OIndex" style="display:none">Insert Column</span>Add or Insert Column</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Delete_Column"><span class="tocnumber">2</span> <span class="toctext"><span class="OIndex">Delete Column</span></span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Rename_and_Label_ColumnRename_ColumnColumn_Label"><span class="tocnumber">3</span> <span class="toctext">Rename and Label Column<span class="OIndex" style="display:none">Rename Column</span><span class="OIndex" style="display:none">Column Label</span></span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Hide.2FUnhide_ColumnHide_Column"><span class="tocnumber">4</span> <span class="toctext">Hide/Unhide Column<span class="OIndex" style="display:none">Hide Column</span></span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Move_and_Swap_Columns"><span class="tocnumber">5</span> <span class="toctext">Move and <span class="OIndex">Swap Column</span>s</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Add_Sparkline_to_Column"><span class="tocnumber">6</span> <span class="toctext">Add <span class="OIndex">Sparkline</span> to Column</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Data_Type.2C_Format.2C_SubFormatColumn_Properties"><span class="tocnumber">7</span> <span class="toctext">Data Type, Format, SubFormat<span class="OIndex" style="display:none">Column Properties</span></span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="#Get_.26_Set_Data_TypeColumn_Designation"><span class="tocnumber">7.1</span> <span class="toctext">Get &amp; Set Data Type<span class="OIndex" style="display:none">Column Designation</span></span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Get_.26_Set_Data_FormatColumn.2C_Data_Format"><span class="tocnumber">7.2</span> <span class="toctext">Get &amp; Set Data Format<span class="OIndex" style="display:none">Column, Data Format</span></span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Get_.26_Set_Data_SubformatColumn.2C_Data_SubFormat"><span class="tocnumber">7.3</span> <span class="toctext">Get &amp; Set Data Subformat<span class="OIndex" style="display:none">Column, Data SubFormat</span></span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="Add_ColumnInsert_ColumnAdd_or_Insert_Column"></a><span class="mw-headline"><span class="OIndex" style="display:none">Add Column</span><span class="OIndex" style="display:none">Insert Column</span>Add or Insert Column</span></h2>
<p>To add a column to the end of the worksheet, the <a href="../../OriginC/OriginC/Worksheet-AddCol.html" title="OriginC:Worksheet-AddCol">AddCol</a> method in <a href="../../OriginC/Category/Worksheet_(class).html" title="Category:Worksheet (class)">Worksheet</a> class is available, and also the <a href="../../OriginC/OriginC/Worksheet-InsertCol.html" title="OriginC:Worksheet-InsertCol">InsertCol</a> for inserting a column before a specified position.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Add column with default name</span>
<span style="color: #0000ff;">int</span> nColIndex <span style="color: #000080;">=</span> wks.<span style="color: #000000;">AddCol</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Add column with namestring strName;</span>
<span style="color: #0000ff;">int</span> nColIndex <span style="color: #000080;">=</span> wks.<span style="color: #000000;">AddCol</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;AA&quot;</span>, strName<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Returns the index of column </span>
<span style="color: #008000;">// If the column named AA already exist, name enumeration automatically </span>
out_str<span style="color: #000000;">&#40;</span>strName<span style="color: #000000;">&#41;</span>; 
Column col<span style="color: #000000;">&#40;</span>wks, nColIndex<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Construct column object by column index</span>


<span style="color: #008000;">// Insert a new column as the first column</span>
<span style="color: #0000ff;">int</span> nPos <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; <span style="color: #008000;">// The position to insert</span>
string strNewCreated; <span style="color: #008000;">// the real name of the new column </span>
<span style="color: #008000;">// The name will be auto enumerated if name MyCol already existed</span>
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> wks.<span style="color: #000000;">InsertCol</span><span style="color: #000000;">&#40;</span>nPos, <span style="color: #ff00ff;">&quot;MyCol&quot;</span>, strNewCreated<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
        <span style="color: #000000;">printf</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Insert column successfully, name is&#160;%s<span style="color: #666666; font-weight: bold;">\n</span>&quot;</span>, strNewCreated<span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Delete_Column"></a><span class="mw-headline"><span class="OIndex">Delete Column</span></span></h2>
<p>The <a href="../../OriginC/OriginC/Worksheet-DeleteCol.html" title="OriginC:Worksheet-DeleteCol">Worksheet::DeleteCol</a> method is capable of removing a column from worksheet.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Delete the column by index</span>
wks.<span style="color: #000000;">DeleteCol</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;</pre>
<h2><a name="Rename_and_Label_ColumnRename_ColumnColumn_Label"></a><span class="mw-headline">Rename and Label Column<span class="OIndex" style="display:none">Rename Column</span><span class="OIndex" style="display:none">Column Label</span></span></h2>
<p>To rename (short name) a column, Origin provides the <a href="../../OriginC/OriginC/OriginObject-SetName.html" title="OriginC:OriginObject-SetName">SetName</a> method.
</p>
<pre class="oc" style="font-family:monospace;">Column col <span style="color: #000080;">=</span> wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// Get the 1st column in worksheet</span>
<span style="color: #0000ff;">BOOL</span> bRet <span style="color: #000080;">=</span> col.<span style="color: #000000;">SetName</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;MyNewName&quot;</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// Rename the column</span></pre>
<p><span class="OIndex" style="display:none">Column Label</span><span class="OIndex" style="display:none">Worksheet</span>
Worksheet column labels support Long Name<span class="OIndex" style="display:none">Long Name Label</span>, Units<span class="OIndex" style="display:none">Units Label</span>, Comments<span class="OIndex" style="display:none">Comments Label</span>, Parameters<span class="OIndex" style="display:none">Parameters Label</span> and User-Defined labels<span class="OIndex" style="display:none">User Defined Labels</span>. We can use Origin C code to show/hide labels or to add text to the specified column label.
</p>
<pre class="oc" style="font-family:monospace;">Worksheet wks;
wks.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;    
 
Grid gg;
gg.<span style="color: #000000;">Attach</span><span style="color: #000000;">&#40;</span>wks<span style="color: #000000;">&#41;</span>;
 
<span style="color: #008000;">// if Parameters lable not show, show it.</span>
<span style="color: #0000ff;">bool</span> bShow <span style="color: #000080;">=</span> gg.<span style="color: #000000;">IsLabelsShown</span><span style="color: #000000;">&#40;</span>RCLT_PARAM<span style="color: #000000;">&#41;</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #000040;">!</span>bShow <span style="color: #000000;">&#41;</span>
        gg.<span style="color: #000000;">ShowLabels</span><span style="color: #000000;">&#40;</span>RCLT_PARAM<span style="color: #000000;">&#41;</span>;
 
wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>.<span style="color: #000000;">SetLongName</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;X Data&quot;</span><span style="color: #000000;">&#41;</span>;
wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>.<span style="color: #000000;">SetLongName</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Y Data&quot;</span><span style="color: #000000;">&#41;</span>;
 
wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>.<span style="color: #000000;">SetComments</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;This is a test&quot;</span><span style="color: #000000;">&#41;</span>;
 
wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>.<span style="color: #000000;">SetUnits</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;AA&quot;</span><span style="color: #000000;">&#41;</span>;
wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>.<span style="color: #000000;">SetUnits</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;BB&quot;</span><span style="color: #000000;">&#41;</span>;
 
<span style="color: #008000;">// put text to Parameters label for two columns.</span>
wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>.<span style="color: #000000;">SetExtendedLabel</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Param A&quot;</span>, RCLT_PARAM<span style="color: #000000;">&#41;</span>;
wks.<span style="color: #000000;">Columns</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>.<span style="color: #000000;">SetExtendedLabel</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Param B&quot;</span>, RCLT_PARAM<span style="color: #000000;">&#41;</span>;</pre>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Worksheet_Column_Operation/Tip_icon.png?v=21427" width="57"  border="0" /></td><td><p>RCLT_PARAM is the type of Parameters column label, other types see <i>OriginC\system\oc_const.h</i> file ROWCOLLABELTYPE enum.
</p></td></tr></table>
<h2><a name="Hide.2FUnhide_ColumnHide_Column"></a><span class="mw-headline">Hide/Unhide Column<span class="OIndex" style="display:none">Hide Column</span></span></h2>
<p>To hide/unhide column(s), you can use the <a href="../../OriginC/OriginC/Worksheet-ShowCol.html" title="OriginC:Worksheet-ShowCol">Workhseet::ShowCol</a> method.
</p>
<pre class="oc" style="font-family:monospace;">wks.<span style="color: #000000;">ShowCol</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">1</span>, <span style="color: #0000ff;">false</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// to hide column 1.</span></pre>
<h2><a name="Move_and_Swap_Columns"></a><span class="mw-headline">Move and <span class="OIndex">Swap Column</span>s</span></h2>
<p><span class="OIndex">Move Column</span>
To move columns or swap columns, the super class of <a href="../../OriginC/Category/Worksheet_(class).html" title="Category:Worksheet (class)">Worksheet</a> class, <a href="../../OriginC/Category/Datasheet_(class).html" title="Category:Datasheet (class)">Datasheet</a> class, provides the method <a href="../../OriginC/OriginC/Datasheet-MoveColumns.html" title="OriginC:Datasheet-MoveColumns">MoveColumns</a> and [[OriginC:Datasheet-SwapColumns|SwapColumns] respectively for such purposes.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Move three columns - starting with column 5 - to the first column</span>
<span style="color: #008000;">// Example requires first worksheet in project with at least 7 columns</span>
Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>wks<span style="color: #000000;">&#41;</span>
    wks.<span style="color: #000000;">MoveColumns</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">4</span>, <span style="color: #0000dd;">3</span>, MOVE_COL_TO_FIRST<span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Reverse the column order in the active worksheet</span>
<span style="color: #0000ff;">for</span><span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; ii <span style="color: #000080;">&lt;=</span> wks.<span style="color: #000000;">GetNumCols</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000040;">/</span> <span style="color: #0000dd;">2</span>&#160;; ii<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span>
    wks.<span style="color: #000000;">SwapColumns</span><span style="color: #000000;">&#40;</span>ii <span style="color: #000040;">-</span> <span style="color: #0000dd;">1</span>, wks.<span style="color: #000000;">GetNumCols</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000040;">-</span> ii<span style="color: #000000;">&#41;</span>;</pre>
<h2><a name="Add_Sparkline_to_Column"></a><span class="mw-headline">Add <span class="OIndex">Sparkline</span> to Column</span></h2>
<p>To add sparkline to column(s), Origin C provides the <a href="../../OriginC/OriginC/Wks_set_show_labels_(global_function).html" title="OriginC:Wks set show labels (global function)">wks_set_show_labels</a> with the RCLT_SPARKLINE label type.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Configure active sheet to show Sampling Inverval and SparkLine in order</span>
<span style="color: #008000;">// append to the curernt Labels</span>
Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> vn <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span>RCLT_SAMPLE_RATE, RCLT_SPARKLINE<span style="color: #000000;">&#125;</span>; 
wks_add_show_labels<span style="color: #000000;">&#40;</span>wks, vn, <span style="color: #0000ff;">false</span><span style="color: #000000;">&#41;</span>;</pre>
<h2><a name="Data_Type.2C_Format.2C_SubFormatColumn_Properties"></a><span class="mw-headline">Data Type, Format, SubFormat<span class="OIndex" style="display:none">Column Properties</span></span></h2>
<h3><a name="Get_.26_Set_Data_TypeColumn_Designation"></a><span class="mw-headline">Get &amp; Set Data Type<span class="OIndex" style="display:none">Column Designation</span></span></h3>
<pre class="oc" style="font-family:monospace;">Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;	
Column col<span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Get column type, can be:</span>
<span style="color: #008000;">// 0: Y</span>
<span style="color: #008000;">// 1: None</span>
<span style="color: #008000;">// 2: Y Error</span>
<span style="color: #008000;">// 3: X</span>
<span style="color: #008000;">// 4: L</span>
<span style="color: #008000;">// 5: Z</span>
<span style="color: #008000;">// 6: X Error</span>
<span style="color: #0000ff;">int</span> nType <span style="color: #000080;">=</span> col.<span style="color: #000000;">GetType</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
out_int<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Type: &quot;</span>, nType<span style="color: #000000;">&#41;</span>;</pre>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Set column type. See more define OKDATAOBJ_DESIGNATION_* in oc_const.h</span>
col.<span style="color: #000000;">SetType</span><span style="color: #000000;">&#40;</span>OKDATAOBJ_DESIGNATION_Z<span style="color: #000000;">&#41;</span>;</pre>
<h3><a name="Get_.26_Set_Data_FormatColumn.2C_Data_Format"></a><span class="mw-headline">Get &amp; Set Data Format<span class="OIndex" style="display:none">Column, Data Format</span></span></h3>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Get and set data format</span>
<span style="color: #008000;">// The default format of column is OKCOLTYPE_TEXT_NUMERIC.</span>
<span style="color: #008000;">// Set the format of column to Date</span>
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> OKCOLTYPE_DATE <span style="color: #000040;">!</span><span style="color: #000080;">=</span> col.<span style="color: #000000;">GetFormat</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	col.<span style="color: #000000;">SetFormat</span><span style="color: #000000;">&#40;</span>OKCOLTYPE_DATE<span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<h3><a name="Get_.26_Set_Data_SubformatColumn.2C_Data_SubFormat"></a><span class="mw-headline">Get &amp; Set Data Subformat<span class="OIndex" style="display:none">Column, Data SubFormat</span></span></h3>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Get and set data subformat</span>
<span style="color: #008000;">// The options of the sub format will be different according to the above format,</span>
<span style="color: #008000;">// numeric, date, time and so on. </span>
<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> LDF_YYMMDD <span style="color: #000040;">!</span><span style="color: #000080;">=</span> col.<span style="color: #000000;">GetSubFormat</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	col.<span style="color: #000000;">SetSubFormat</span><span style="color: #000000;">&#40;</span>LDF_YYMMDD<span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>


