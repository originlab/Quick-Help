<h1 class="firstHeading">2.101 FAQ-988 How do I add cell formula in column label row during data importing?</h1><p class='urlname' style='display: none'>Add-Cell-Formula-during-Import</p>
<p class='faqID'>Last Update: 1/9/2019</p>
<p>It is a general idea to set column label rows by using cell formula for some after-process of data importing. However, Origin disables cell formula during import for the concern that your data may include text beginning with "=". If you really want to use cell formula during import, you can set <a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#E">@ESC</a> to 1 to turn on cell formula before running any of the after-import scripts. 
</p><p>For example, if you want to import data by <b>Import ASCII</b> tool and set Comment to be the difference between the maximum and minimum of that column, you can put the following scripts in the <b>Script after Each File Imported</b> box in the <b>impASC</b> dialog
</p>
<pre class="lt" style="font-family:monospace;">int nOld <span style="color: #000080;">=</span> @ESC; <span style="color: #008000;">//keep record of original value of @ESC</span>
@ESC <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; <span style="color: #008000;">//force cell formula enable</span>
<span style="color: #008000;">//start your code for after import process</span>
for<span style="color: #000000;">&#40;</span>int ii<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>; ii<span style="color: #000080;">&lt;=</span>wks.<span style="color: #000080;">ncols</span>; ii<span style="color: #000080;">++</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
Col<span style="color: #000000;">&#40;</span><span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>ii<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span>C<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;=Max(This)-Min(This)&quot;</span>;
<span style="color: #000000;">&#125;</span>
@ESC <span style="color: #000080;">=</span> nOld; <span style="color: #008000;">//restore @ESC to original value</span></pre>
<p><b>Note</b>: We must set the value of @ESC to 1 even if it is 1 already, because Origin will internally set it to 2 (by which cell formula is disable) temporarily during the importing.
</p>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>cell fomula, parameter row, calculation during import, label row, set label</span></p>






