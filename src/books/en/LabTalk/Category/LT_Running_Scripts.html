<h1 class="firstHeading">2.5.1 Running Scripts</h1><p class='urlname' style='display: none'>Running-Scripts</p>
<p><span class="OIndex" style="display:none">Run Script</span><span class="OIndex" style="display:none">script, execution</span> <span class="OIndex" style="display:none">script, run</span>The following sections document various ways to execute and/or store LabTalk scripts.  We begin by examining the relationship between scripts and the objects they work on.
</p>
<table class="catlist">

<tr>
<td><i><b>This section covers the following topics:</b></i>
<div class="CategoryTreeTag" data-ct-mode="20" data-ct-options="{&quot;mode&quot;:20,&quot;hideprefix&quot;:10,&quot;showcount&quot;:false,&quot;namespaces&quot;:false}"><li> <a class="CategoryTreeLabel  CategoryTreeLabelNs128 CategoryTreeLabelPage" href="../../LabTalk/Script/From_Script_and_Command_Window.html">From Script and Command Window</a></li>
		
		<li> <a class="CategoryTreeLabel  CategoryTreeLabelNs128 CategoryTreeLabelPage" href="../../LabTalk/Script/From_Files.html">From Files</a></li>
		
		<li> <a class="CategoryTreeLabel  CategoryTreeLabelNs128 CategoryTreeLabelPage" href="../../LabTalk/Script/From_Set_Values_Dialog.html">From Set Values Dialog</a></li>
		
		<li> <a class="CategoryTreeLabel  CategoryTreeLabelNs128 CategoryTreeLabelPage" href="../../LabTalk/Script/From_Worksheet_Script.html">From Worksheet Script</a></li>
		
		<li> <a class="CategoryTreeLabel  CategoryTreeLabelNs128 CategoryTreeLabelPage" href="../../LabTalk/Script/From_Script_Panel.html">From Script Panel</a></li>
		
		<li> <a class="CategoryTreeLabel  CategoryTreeLabelNs128 CategoryTreeLabelPage" href="../../LabTalk/Script/From_Graphical_Objects.html">From Graphical Objects</a></li>
		
		<li> <a class="CategoryTreeLabel  CategoryTreeLabelNs128 CategoryTreeLabelPage" href="../../LabTalk/Script/ProjectEvents_Script.html">ProjectEvents Script</a></li>
		
		<li> <a class="CategoryTreeLabel  CategoryTreeLabelNs128 CategoryTreeLabelPage" href="../../LabTalk/Script/From_Import_Wizard.html">From Import Wizard</a></li>
		
		<li> <a class="CategoryTreeLabel  CategoryTreeLabelNs128 CategoryTreeLabelPage" href="../../LabTalk/Script/From_Nonlinear_Fitter.html">From Nonlinear Fitter</a></li>
		
		<li> <a class="CategoryTreeLabel  CategoryTreeLabelNs128 CategoryTreeLabelPage" href="../../LabTalk/Script/From_an_External_Application.html">From an External Application</a></li>
		
		<li> <a class="CategoryTreeLabel  CategoryTreeLabelNs128 CategoryTreeLabelPage" href="../../LabTalk/Script/From_Console.html">From Console</a></li>
		
		<li> <a class="CategoryTreeLabel  CategoryTreeLabelNs128 CategoryTreeLabelPage" href="../../LabTalk/Script/On_A_Timer.html">On A Timer</a></li>
		
		<li> <a class="CategoryTreeLabel  CategoryTreeLabelNs128 CategoryTreeLabelPage" href="../../LabTalk/Script/On_Starting_Origin.html">On Starting or Exiting Origin</a></li>
		
		<li> <a class="CategoryTreeLabel  CategoryTreeLabelNs128 CategoryTreeLabelPage" href="../../LabTalk/Script/From_a_Custom_Menu_Item.html">From a Custom Menu Item</a></li>
		
		<li> <a class="CategoryTreeLabel  CategoryTreeLabelNs128 CategoryTreeLabelPage" href="../../LabTalk/Script/From_a_Toolbar_Button.html">From a Toolbar Button</a></li>
		
		</div>
</td></tr></table>
<p><b><span class="OIndex">Active Window</span><span class="OIndex HasShownIndex" style="display:none">window, active</span> Default</b>
</p><p>When working on an <a href="../../LabTalk/Category/Origin_Objects.html" title="Category:Origin Objects">Origin Object</a>, like a workbook or graph page, a script always operates on the active window by default. If the window is inactive, you may use <a href="../../LabTalk/LabTalk/Window_Options_to_Activate.html" title="LabTalk:Window Options to Activate">win -a</a> to activate it. 
</p>
<pre class="lt" style="font-family:monospace;">win <span style="color: #000080;">-</span>a book2;		<span style="color: #008000;">// Activate the window named book2</span>
col<span style="color: #000000;">&#40;</span>b<span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">10</span><span style="color: #000000;">&#125;</span>;	<span style="color: #008000;">// Fill 1 to 10 on column B of book2</span></pre>
<p>However, working on active windows with <i>win -a</i> may not be stable. In the execution sequence of the script, switching active windows or layers may have delay and may lead to unpredictable outcome.  
</p><p>It is preferable to always use <a href="../../LabTalk/LabTalk/Window_Options_Other.html#-o" title="LabTalk:Window Options Other">win -o <i>winName</i> {<i>script</i>}</a><span class="OIndex" style="display:none">Script, for specified window</span> to enclose the script, then Origin will temporarily set the window you specified as the active window (internally) and execute the enclosed script exclusively on that window. For example, the following code will create a new project, fill the default book with some data, and make a plot and then go back to add a new sheet into that book and make a second plot with the data from the second sheet:
</p>
<pre class="lt" style="font-family:monospace;">doc <span style="color: #000080;">-</span>s;doc <span style="color: #000080;">-</span>n;<span style="color: #008000;">//new project with default worksheet</span>
string bk<span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #000080;">%</span>H;<span style="color: #008000;">//save its book short name</span>
<span style="color: #008000;">//fill some data and make new plot</span>
wks.<span style="color: #000080;">ncols</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>;col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>data<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">10</span><span style="color: #000000;">&#41;</span>;col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>normal<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">10</span><span style="color: #000000;">&#41;</span>;
plotxy <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> o<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>new<span style="color: #000080;">&gt;</span>;
<span style="color: #008000;">//now the newly created graph is the active window</span>
<span style="color: #008000;">//but we want to run some script on the original workbook </span>
win <span style="color: #000080;">-</span>o bk<span style="color: #000080;">$</span> <span style="color: #000000;">&#123;</span>
  newsheet xy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;XYY&quot;</span>;
  col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>data<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span>,<span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">0.1</span><span style="color: #000000;">&#41;</span>;col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">*</span><span style="color: #0000dd;">2</span>;col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">*</span><span style="color: #0000dd;">3</span>;
  plotxy <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">:</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">200</span> o<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>new<span style="color: #000080;">&gt;</span>;
<span style="color: #000000;">&#125;</span></pre>
<p>Please note that <i>win -o</i> is the only LabTalk command that allows a <span class="OIndex">string variable</span> to be used. As seen above, we did not have to write 
</p>
<pre class="lt" style="font-family:monospace;">win <span style="color: #000080;">-</span>o <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>bk<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span></pre>
<p>as this particular command is used so often that it has been modified since Origin 8.0 to allow <a href="../../LabTalk/LabTalk/Data_Types_and_Variables.html#String_Variables" title="LabTalk:Data Types and Variables">string variables</a>. In all other places you must use the <a href="../../LabTalk/LabTalk/String_Substitution.html" title="LabTalk:String Substitution">%( ) substitution notation</a> if a string variable is used as an argument to a LabTalk command.
</p><p><b>Where to Run LabTalk Scripts</b>
</p><p>While there are many places in Origin that scripts can be stored and run, they are not all equally likely.  The following sub-sections have been arranged in an assumed order of prevalence based on typical use.  
</p><p>The first two, on (1) <a href="../../LabTalk/Script/From_Script_and_Command_Window.html" title="Script:From Script and Command Window">Running Scripts from the Script and Command Windows</a> and (2) <a href="../../LabTalk/Script/From_Files.html" title="Script:From Files">Running Scripts from Files</a>, will be used much more often than the others for those who primarily script.  If you only read two sub-sections in this chapter, it should be those.  The others can be read on an as-needed basis.
</p>



