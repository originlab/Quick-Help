<h1 class="firstHeading">3.7.5.102 Wks.Col</h1><p class='urlname' style='display: none'>Wks-Col-obj</p>
<p><br />
<b>wks.col</b><span class="OIndex" style="display:none">Object, Column</span> objects refer to columns in a worksheet or matrix objects in a matrix sheet. These objects contain properties that read or write <span class="OIndex">column attribute</span>s such as names, units, types, etc. and methods that set the filter, formula, etc.<br />
</p><p>There are two syntaxes to refer to this object.
</p>
<dl><dd><ul><li> <b>wks.col</b> -- active column (E.g. wks.col=2 set 2nd column to be active column. wks.col.lname$="Data" set 2nd column's long name.) </li>
<li> <b>wks.col<i>N</i></b>  -- <i>N</i>th column (E.g. wks.col2.lname$="Data" set 2nd column's long name.)</li></ul></dd></dl>
<p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#PropertiesColumn_Property"><span class="tocnumber">1</span> <span class="toctext">Properties<span class="OIndex" style="display:none">Column Property</span></span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#MethodsColumn_Method"><span class="tocnumber">2</span> <span class="toctext">Methods<span class="OIndex" style="display:none">Column Method</span></span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Examples"><span class="tocnumber">3</span> <span class="toctext">Examples</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Edit_Column_Attributes"><span class="tocnumber">3.1</span> <span class="toctext">Edit Column Attributes</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Set_Custom_Date_Format"><span class="tocnumber">3.2</span> <span class="toctext">Set Custom Date Format</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Loop_through_columns_and_set_column_attributes"><span class="tocnumber">3.3</span> <span class="toctext">Loop through columns and set column attributes</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="PropertiesColumn_Property"></a><span class="mw-headline">Properties<span class="OIndex" style="display:none">Column Property</span></span></h2>
<table class="simple">
<tr>
<th width="110">Property
</th>
<th width="50">Type
</th>
<th width="50">Access
</th>
<th width="540">Description
</th></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-comment.html" title="LabTalk:Wks.col-comment">wks.col.comment$</a>
</td>
<td> string
</td>
<td> Read/write
</td>
<td> Column Comment row header string value.
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-categorical.sort.html" title="LabTalk:Wks.col-categorical.sort">wks.col.categorical.sort</a>
</td>
<td> numeric
</td>
<td> Read/Write
</td>
<td> Read or set the sort method for column <i>n</i>: 0 = unsorted, 1 = ascending, 2 = descending and 3 = customizable (arbitrary).
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-categorical.type.html" title="LabTalk:Wks.col-categorical.type">wks.col.categorical.type</a>
</td>
<td> numeric
</td>
<td> Read/Write
</td>
<td> Read or set the type for column <i>n</i>
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-cmap.palette.html" title="LabTalk:Wks.col-cmap.palette">wks.col.cmap.palette$</a>
</td>
<td> string
</td>
<td> Read/Write
</td>
<td> Read or set the color palette for the matrix object.
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-digitMode.html" title="LabTalk:Wks.col-digitMode">wks.col.digitMode</a>
</td>
<td> numeric
</td>
<td> Read/write
</td>
<td> Set the digit display mode: 0 = display all, 1 = set the decimal places, and 2 = set the significant digits.
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-digits.html" title="LabTalk:Wks.col-digits">wks.col.digits</a>
</td>
<td> numeric
</td>
<td> Read/write
</td>
<td> Number of decimal places when <code>wks.col.digitMode = 1</code>, number of significant digits when <code>wks.col.digitmode = 2</code>: 0 = display all, <i>n</i> = display <i>n</i>.
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-edit.html" title="LabTalk:Wks.col-edit">wks.col.edit</a>
</td>
<td> numeric
</td>
<td> Read/write
</td>
<td> Adds one of the following controls to each cell in the column: check box, list box, combobox
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-evenx.html" title="LabTalk:Wks.col-evenx">wks.col.evenx</a>
</td>
<td> numeric
</td>
<td> Read/write
</td>
<td> Read or set column <i>n</i> to be using Sample Interval: 0 = not using Sample Interval, 1 = using Sample Interval with Internal X Initial value = 0 and Increment value = 1.
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-filter.html" title="LabTalk:Wks.col-filter">wks.col.filter<br />wks.col.filter$</a>
</td>
<td> numeric/string
</td>
<td> Read/write
</td>
<td> Add or remove a filter. <br />Set or get filter query string. It must set the filter type to advance.
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-filterenabled.html" title="LabTalk:Wks.col-filterenabled">wks.col.filterenabled</a>
</td>
<td> numeric
</td>
<td> Read/write
</td>
<td> Enable or disable a filter. 1 = enable filter, and 0 = disable filter.
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-filterprescript.html" title="LabTalk:Wks.col-filterprescript">wks.col.filterprescript$</a>
</td>
<td> string
</td>
<td> Read/write
</td>
<td> Set or get before query script.
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-filterx.html" title="LabTalk:Wks.col-filterx">wks.col.filterx$</a>
</td>
<td> string
</td>
<td> Read/write
</td>
<td> Set and get the variable used to represent the column.
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-format.html" title="LabTalk:Wks.col-format">wks.col.format</a>
</td>
<td> numeric
</td>
<td> Read/write
</td>
<td> Column format: 1 = Numeric, 2 = Text, 3 = Time, 4 = Date, 5 = Month, 6 = Day of Week, 7 = Text and Numeric, 8 = Color and 9 = Binary as listed in the Format drop-down list in the Worksheet Column Format dialog box.
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-formula.html" title="LabTalk:Wks.col-formula">wks.col.formula$</a>
</td>
<td> string
</td>
<td> Read/write
</td>
<td> Column formula as in <b>Set (Column) Values</b> or in <b>F(x)=</b> label row (see also <a href="../../LabTalk/LabTalk/Column_Label_Row_Characters.html" title="LabTalk:Column Label Row Characters">Column Label Row Characters</a>).
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-formularange.html" title="LabTalk:Wks.col-formularange">wks.col.formularange$</a>
</td>
<td> string
</td>
<td> Read
</td>
<td> Column formula range as in <b>Set (Column) Values</b>.
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-image.html" title="LabTalk:Wks.col-image">wks.col.image</a>
</td>
<td> numeric
</td>
<td> Read
</td>
<td> Get matrix object info:
<p>0 = no image
<br />
1 = has image
<br />
2 = gray scale image 
<br />
3 = image view
</p>
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-index.html" title="LabTalk:Wks.col-index">wks.col.index</a>
</td>
<td> numeric
</td>
<td> Read/write
</td>
<td> Column index counting from left to right. Use this property to reorder worksheet column.
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-iscat.html" title="LabTalk:Wks.col-iscat">wks.col.iscat</a>
</td>
<td> numeric
</td>
<td> Read/write
</td>
<td> Read or set column is Categorical or not. 0 = Column type is not Categorical, 1 = Column type is Categorical.
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-label.html" title="LabTalk:Wks.col-label">wks.col.label$</a>
</td>
<td> string
</td>
<td> Read/write
</td>
<td> Column label access for versions before 8.0. Still supporte to control long name, units and comments in a single call.
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-lname.html" title="LabTalk:Wks.col-lname">wks.col.lname$</a>
</td>
<td> string
</td>
<td> Read/write
</td>
<td>String value for the long name of column or matrix object.
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-missing.html" title="LabTalk:Wks.col-missing">wks.col.missing</a>
</td>
<td> numeric
</td>
<td> Read/write
</td>
<td> Custom missing value. This property allow setting custom missing value such that non-double columns can have missing value support.
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-name.html" title="LabTalk:Wks.col-name">wks.col.name$</a>
</td>
<td> string
</td>
<td> Read/write
</td>
<td> Column short name
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-nCols.html" title="LabTalk:Wks.col-nCols">wks.col.nCols</a>
</td>
<td> numeric
</td>
<td> Read/write
</td>
<td> Number of columns for Matrix Object; for worksheet column, always 1.
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-nRows.html" title="LabTalk:Wks.col-nRows">wks.col.nRows</a>
</td>
<td> numeric
</td>
<td> Read/write
</td>
<td> Number of rows
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-numerictype.html" title="LabTalk:Wks.col-numerictype">wks.col.numerictype</a>
</td>
<td> numeric
</td>
<td> Read/write
</td>
<td> Column numeric type
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-py.html" title="LabTalk:Wks.col-py">wks.col.py$</a>
</td>
<td> string
</td>
<td> Read/write
</td>
<td> Contents of Python Formula tab in <b>Set (Column) Values</b>
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-script.html" title="LabTalk:Wks.col-script">wks.col.script$</a>
</td>
<td> string
</td>
<td> Read/write
</td>
<td> Contents of Before Formula Script tab in <b>Set (Column) Values</b>
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-subformat.html" title="LabTalk:Wks.col-subformat">wks.col.subformat</a>
</td>
<td> numeric
</td>
<td> Read/write
</td>
<td> Subformat options as listed in the <b>Display</b> drop-down list of the Worksheet Column Format dialog box (select from main menu <b>Format: Column ...</b> to open this dialog).
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-svrm.html" title="LabTalk:Wks.col-svrm">wks.col.svrm</a>
</td>
<td> numeric
</td>
<td> Read/write
</td>
<td> Set Value Recalculate Mode for the column formula (in any) of the column. 0=none,1=auto,2=manual.
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-tWidth.html" title="LabTalk:Wks.col-tWidth">wks.col.tWidth</a>
</td>
<td> numeric
</td>
<td> Read/write
</td>
<td> The number of characters that can be entered in a Text column.
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-type.html" title="LabTalk:Wks.col-type">wks.col.type</a>
</td>
<td> numeric
</td>
<td> Read/write
</td>
<td> Column type: 1 = Y, 2 = disregard, 3 = Y Error, 4 = X, 5 = Label, 6 = Z, and 7 = X Error.
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-unit.html" title="LabTalk:Wks.col-unit">wks.col.unit$</a>
</td>
<td> string
</td>
<td> Read/write
</td>
<td> Units row header
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-width.html" title="LabTalk:Wks.col-width">wks.col.width</a>
</td>
<td> numeric
</td>
<td> Read/write
</td>
<td> Width of a single worksheet column (e.g. "col1"), in units of characters.
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-x1.html" title="LabTalk:Wks.col-x1">wks.col.x1</a>
</td>
<td> numeric
</td>
<td> Read/write
</td>
<td> Get/Set matrix object 1st column mapping coordinates
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-x2.html" title="LabTalk:Wks.col-x2">wks.col.x2</a>
</td>
<td> numeric
</td>
<td> Read/write
</td>
<td> Get/Set matrix object last column mapping coordinates
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-xinit.html" title="LabTalk:Wks.col-xinit">wks.col.xinit</a>
</td>
<td> numeric
</td>
<td> Read/write
</td>
<td> Internal X Initial value for column. The XINIT, XINC and XUNITS appear in the Sampling Interval row header if displayed.
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-xinc.html" title="LabTalk:Wks.col-xinc">wks.col.xinc</a>
</td>
<td> numeric
</td>
<td> Read/write
</td>
<td> Internal X Increment value for column.
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-xuints.html" title="LabTalk:Wks.col-xuints">wks.col.xuints$</a>
</td>
<td> string
</td>
<td> Read/write
</td>
<td> Internal X Units string for column.
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-xname.html" title="LabTalk:Wks.col-xname">wks.col.xname$</a>
</td>
<td> string
</td>
<td> Read/write
</td>
<td> Internal X Name string for column. The XNAME and XUNITS appear as the X Axis Title on plots of this column.
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-y1.html" title="LabTalk:Wks.col-y1">wks.col.y1</a>
</td>
<td> numeric
</td>
<td> Read/write
</td>
<td> Get/Set matrix object 1st row mapping coordinates
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-y2.html" title="LabTalk:Wks.col-y2">wks.col.y2</a>
</td>
<td> numeric
</td>
<td> Read/write
</td>
<td> Get/Set matrix object last row mapping coordinates
</td></tr></table>
<h2><a name="MethodsColumn_Method"></a><span class="mw-headline">Methods<span class="OIndex" style="display:none">Column Method</span></span></h2>
<p><span class="OIndex" style="display:none">Layer method</span>
</p>
<table class="simple" width="100%">
<tr>
<th width="25%">Method
</th>
<th width="75%">Description
</th></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-filter(method).html" title="LabTalk:Wks.col-filter(method)">wks.col.filter</a>
</td>
<td> Open the filter dialog
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-setbinary.html" title="LabTalk:Wks.col-setbinary">wks.col.setbinary</a>
</td>
<td> Set binary auto convert.
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-setformat.html" title="LabTalk:Wks.col-setformat">wks.col.setformat</a>
</td>
<td> Setformat method combines functionalities of the format and subformat methods, additionally allowing custom formats to be specified.
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-setformula.html" title="LabTalk:Wks.col-setformula">wks.col.setformula</a>
</td>
<td> Set the column formula.
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.col-findX.html" title="LabTalk:Wks.col-findX">wks.col.findX</a>
</td>
<td> Returns corresponding X column index
</td></tr></table>
<h2><a name="Examples"></a><span class="mw-headline"><font color="chocolate">Examples</font></span></h2>
<h3><a name="Edit_Column_Attributes"></a><span class="mw-headline">Edit Column Attributes</span></h3>
<p>Set active column <b>wks.col</b> and then edit the attributes of it.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Set the active column to 2.</span>
wks.<span style="color: #000080;">col</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;

<span style="color: #008000;">// Set the active column's(col2) long name as Time.</span>
wks.<span style="color: #000080;">col</span>.<span style="color: #000080;">LNAME</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Time&quot;</span>;</pre>
<p>Alternatively, add index after wks.col to change the column attributes.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//Set column 1's long name as Time</span>
wks.<span style="color: #000080;">col1</span>.<span style="color: #000080;">LNAME</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Time;

<span style="color: #008000;">// You can reference another book, but the target sheet must still be active</span>
<span style="color: #008000;">// Set column 5 in the active sheet of Book5 to be an X column</span>
Book5<span style="color: #000080;">!</span>wks.<span style="color: #000080;">col5</span>.<span style="color: #000080;">type</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">4</span>;

<span style="color: #008000;">// col0 to refer to last column</span>
<span style="color: #008000;">//set last column formula</span>
wks.<span style="color: #000080;">col0</span>.<span style="color: #000080;">formula</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;A&quot;</span>;</pre>
<h3><a name="Set_Custom_Date_Format"></a><span class="mw-headline">Set Custom Date Format</span></h3>
<p>This script sets the format of column 2 of the active worksheet to a custom date format.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Surround non-date characters in specifier by single quotes:</span>
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">SetFormat</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">4</span>, <span style="color: #0000dd;">22</span>, yyyy<span style="color: #ff00ff;">'.'</span>MM<span style="color: #ff00ff;">'.'</span>dd<span style="color: #000000;">&#41;</span>;</pre>
<h3><a name="Loop_through_columns_and_set_column_attributes"></a><span class="mw-headline">Loop through columns and set column attributes</span></h3>
<p>This script will loop through columns 2 to 10 and set each column long name.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Set the number of columns to 10</span>
wks.<span style="color: #000080;">ncols</span><span style="color: #000080;">=</span><span style="color: #0000dd;">10</span>;

for <span style="color: #000000;">&#40;</span>i<span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>; i<span style="color: #000080;">&lt;=</span>wks.<span style="color: #000080;">ncols</span>; i<span style="color: #000080;">++</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>

   wks.<span style="color: #000080;">col</span><span style="color: #000080;">=</span>i;  <span style="color: #008000;">//set active column</span>
   wks.<span style="color: #000080;">col</span>.<span style="color: #000080;">lname</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Data$(i-1)&quot;</span>;   <span style="color: #008000;">//set active column's long name as</span>

  <span style="color: #008000;">//wks.col$(i).lname$=&quot;Data$(i-1) will also work</span>
<span style="color: #000000;">&#125;</span></pre>






