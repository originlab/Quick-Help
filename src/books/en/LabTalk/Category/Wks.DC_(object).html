<h1 class="firstHeading">3.7.5.104 Wks.DC</h1><p class='urlname' style='display: none'>wks-dc-object</p>
<p>Data Connector added to a worksheet are handled as objects in Origin. The <span class="OIndex">column attribute</span>s can be accessed and changed using the properties in the table below.
</p>
<table class="note">
<tr>
<td><b>Note:</b>
<p>For workbook level controls of Data Connector, please refer to <a href="../../LabTalk/LabTalk/Wbk_(object).html" title="LabTalk:Wbk (object)">Wbk object</a>.
</p>
</td></tr></table>
<h2><a name="Properties"></a><span class="mw-headline">Properties</span></h2>
<table class="simple">
<tr>
<th width="110">Property
</th>
<th width="70">Access
</th>
<th width="540">Description
</th></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.DC-auto.html" title="LabTalk:Wks.DC-auto">wks.DC.auto</a>
</td>
<td> Read/write<br />numeric
</td>
<td> Set/Get auto import status
</td></tr>
<tr>
<td><a href="../../LabTalk/LabTalk/Wks.DC-c1.html" title="LabTalk:Wks.DC-c1">wks.DC.c1<br />wks.DC.c2</a>
</td>
<td>Read/write<br />numeric
</td>
<td>Range of columns imported: <b>c1</b> is the beginning column and <b>c2</b> is the ending column.
</td></tr>
<tr>
<td><a href="../../LabTalk/LabTalk/Wks.DC-cntrl.html" title="LabTalk:Wks.DC-cntrl">wks.DC.cntrl</a>
</td>
<td>Read/write<br />numeric
</td>
<td><font color="red">Origin 2024b</font> Import option.
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.DC-Flags.html" title="LabTalk:Wks.DC-Flags">wks.DC.Flags</a>
</td>
<td>Read/write<br />numeric
</td>
<td>Append data rows in imported file to active worksheet. As of Origin 2021, for Data Connector = Text/CSV only
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.DC-Ignore.html" title="LabTalk:Wks.DC-Ignore">wks.DC.Ignore</a>
</td>
<td>Read/Write<br />numeric
</td>
<td>Ignore Data Connector icon. 0 = Data Connector icon is usable, 1 = Data Connector icon is neither selectable nor usable.
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.DC-optn.html" title="LabTalk:Wks.DC-optn">wks.DC.optn$</a>
</td>
<td> Read/write<br />string
</td>
<td> Get or set connector settings as a string. Supported only for CSV, Excel etc connector types using its own GetN dialog.
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.DC-Path.html" title="LabTalk:Wks.DC-Path">wks.DC.Path$</a>
</td>
<td>Read/Write<br />string
</td>
<td>Absolute path of Connector Data Source, both for local files and for web data as long as the local cache has not expired or been cleared.
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.DC-Script.html" title="LabTalk:Wks.DC-Script">wks.DC.Script$</a>
</td>
<td>Read/Write<br />string
</td>
<td>Get or set <b>Post Import Scripts</b>.
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.DC-Sel.html" title="LabTalk:Wks.DC-Sel">wks.DC.Sel$</a>
</td>
<td>Read/Write<br />string
</td>
<td>Specify the selection of sheets/table inside the data source. Use for file formats such as NetCDF or TDMS.
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.DC-Source.html" title="LabTalk:Wks.DC-Source">wks.DC.Source$</a>
</td>
<td>Read/write<br />string
</td>
<td>Relative path of data source.
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.DC-Sstatus.html" title="LabTalk:Wks.DC-Sstatus">wks.DC.Sstatus</a>
</td>
<td>Read Only
</td>
<td>Source Status
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.DC-SType.html" title="LabTalk:Wks.DC-SType">wks.DC.SType</a>
</td>
<td> Read/write<br />numeric
</td>
<td> Data source type.
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.DC-Valid.html" title="LabTalk:Wks.DC-Valid">wks.DC.Valid</a>
</td>
<td> Read/write<br />numeric
</td>
<td> Check the status of Data Connector added to the worksheet
</td></tr></table>
<h2><a name="Methods"></a><span class="mw-headline">Methods</span></h2>
<table class="simple">
<tr>
<th width="110">Method
</th>
<th width="70">Access
</th>
<th width="540">Description
</th></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.DC-Add.html" title="LabTalk:Wks.DC-Add">wks.DC.Add(sel$)</a>
</td>
<td> Read/write<br />numeric
</td>
<td> Add selected table <i>sel$</i> to active sheet.
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.DC-Allow.html" title="LabTalk:Wks.DC-Allow">wks.DC.Allow()</a>
</td>
<td> Read/write<br />numeric
</td>
<td> Check if the worksheet is used as the destination of a Data Connector.
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.DC-Import.html" title="LabTalk:Wks.DC-Import">wks.DC.Import()</a>
</td>
<td> Read/write<br />numeric
</td>
<td> Import data into current sheet, without opening the Import Options dialog.
</td></tr>
<tr>
<td> <a href="../../LabTalk/LabTalk/Wks.DC-Reset.html" title="LabTalk:Wks.DC-Reset">wks.DC.Reset()</a>
</td>
<td> Read/write<br />numeric
</td>
<td> Clear imported data. The connection will remain.
</td></tr></table>
<h2><a name="Examples"></a><span class="mw-headline"><font color="chocolate">Examples</font></span></h2>
<p><i><b>EX1</b></i>
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//This example shows how to import a CSV file by Data Connector</span>
newbook;
wbook.<span style="color: #000080;">dc</span>.<span style="color: #000080;">add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;CSV&quot;</span><span style="color: #000000;">&#41;</span>;
wks.<span style="color: #000080;">dc</span>.<span style="color: #000080;">source</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>System.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span><span style="color: #000080;">+</span><span style="color: #ff00ff;">&quot;Samples\Batch Processing\T275K.csv&quot;</span>;
wks.<span style="color: #000080;">dc</span>.<span style="color: #000080;">import</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</pre>
<p><i><b>EX2</b></i>
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// This example shows how to import multiple CSV files into one worksheet appending by rows</span>
newbook;
string fname, path<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Batch Processing\&quot;</span>; 
findfiles fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>fname<span style="color: #000080;">$</span> ext<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;*.csv&quot;</span>;

int num <span style="color: #000080;">=</span> fname.<span style="color: #000080;">GetNumTokens</span><span style="color: #000000;">&#40;</span>CRLF<span style="color: #000000;">&#41;</span>;
wbook.<span style="color: #000080;">dc</span>.<span style="color: #000080;">add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;CSV&quot;</span><span style="color: #000000;">&#41;</span>;
loop<span style="color: #000000;">&#40;</span>ii,<span style="color: #0000dd;">1</span>,num<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
next<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> fname.<span style="color: #000080;">GetToken</span><span style="color: #000000;">&#40;</span>ii, CRLF<span style="color: #000000;">&#41;</span><span style="color: #000080;">$</span>;
if <span style="color: #000000;">&#40;</span>ii<span style="color: #000080;">==</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	wks.<span style="color: #000080;">dc</span>.<span style="color: #000080;">flags</span><span style="color: #000080;">=</span><span style="color: #0000dd;">256</span>;	<span style="color: #008000;">// turn on append rows mode</span>
<span style="color: #000000;">&#125;</span>
wks.<span style="color: #000080;">dc</span>.<span style="color: #000080;">source</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>next<span style="color: #000080;">$</span>;
Tree tr1<span style="color: #000080;">=</span>wks.<span style="color: #000080;">dc</span>.<span style="color: #000080;">optn</span><span style="color: #000080;">$</span>;
tr1.<span style="color: #000080;">settings</span>.<span style="color: #000080;">partial</span>.<span style="color: #000080;">SetAttribute</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Use&quot;</span>, <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
tr1.<span style="color: #000080;">settings</span>.<span style="color: #000080;">partial</span>.<span style="color: #000080;">row</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;2&quot;</span>; <span style="color: #008000;">// import 2nd row for each file</span>
tr1.<span style="color: #000080;">ToString</span><span style="color: #000000;">&#40;</span>wks.<span style="color: #000080;">dc</span>.<span style="color: #000080;">optn</span><span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>;
wks.<span style="color: #000080;">dc</span>.<span style="color: #000080;">import</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>






