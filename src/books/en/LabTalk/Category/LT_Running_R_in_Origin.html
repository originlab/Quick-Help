<h1 class="firstHeading">2.16 Running R in Origin</h1><p class='urlname' style='display: none'>LT-Running-R</p>
<p>There are a couple of ways to interact with R from Origin. 
</p>
<ul>
<li> Using <a class="external text" href="../../UserGuide/Category/R_Console_and_Rserve_Console.html">the <b>R Console</b> and the <b>Rserve Console</b></a>. These tools allow Origin users to issue R commands within the Origin environment and transfer data between the two applications either using a dialog interface, or by using commands. For examples, see <a class="external text" href="../../UserGuide/UserGuide/Data_Analysis_in_Origin_with_R_Console.html"><b>Data Analysis in Origin with R Console</b></a>.</li>
<li>Using the LabTalk objects <a href="../../LabTalk/LabTalk/R_(object).html" title="LabTalk:R (object)"><b>R</b></a> and <a href="../../LabTalk/LabTalk/Rserve_(object).html" title="LabTalk:Rserve (object)"><b>RS (RServe) </b></a>. The R and RS LabTalk objects can execute R commands and pass variables and datasets between Origin and R.
</ul>
<p><br />
To make use of the <b>R</b> object and <b>R Console</b>, you need to have R installed locally. To use the <b>RS</b> object and the <b>Rserve Console</b>, you will need to have the R packages installed on the server side, and communicate to the server computer with Origin on the client side. 
</p>
<ul><li> For information on obtaining and installing R locally, see <a class="external text" href="../../UserGuide/Category/R_Console_and_Rserve_Console.html">this topic</a>.</li>
<li> For information on setting up an R server, see <a class="external text" href="../../UserGuide/UserGuide/Setup_R_Server.html">this topic</a>.</li></ul>
<p><br />
</p>
<p class="version" >Minimum Origin Version Required: 2016 SR0</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Execute_R_Command_in_Script_Window"><span class="tocnumber">1</span> <span class="toctext">Execute R Command in Script Window</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Initialize_R_or_RS"><span class="tocnumber">1.1</span> <span class="toctext">Initialize R or RS</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Execute_R_and_RS_command"><span class="tocnumber">1.2</span> <span class="toctext">Execute R and RS command</span></a>
<ul>
<li class="toclevel-3 tocsection-4"><a href="#Execute_R.2FRS_command_example"><span class="tocnumber">1.2.1</span> <span class="toctext">Execute R/RS command example</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-5"><a href="#Execute_.R_file"><span class="tocnumber">1.3</span> <span class="toctext">Execute .R file</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Send_Origin_Dataset_to_R_Console"><span class="tocnumber">1.4</span> <span class="toctext">Send Origin Dataset to R Console</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Receive_R_Variable_as_Origin_Dataset"><span class="tocnumber">1.5</span> <span class="toctext">Receive R Variable as Origin Dataset</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Pass_Variables_between_Labtalk_and_R"><span class="tocnumber">1.6</span> <span class="toctext">Pass Variables between Labtalk and R</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-9"><a href="#Utilizing_R_Console_or_Rserve_Console"><span class="tocnumber">2</span> <span class="toctext">Utilizing R Console or Rserve Console</span></a></li>
</ul>
</div>

<h2><a name="Execute_R_Command_in_Script_Window"></a><span class="mw-headline">Execute R Command in Script Window</span></h2>
<p>We can use LabTalk objects <b>R</b> and <b>RS</b> to execute R commands and pass variables between LabTalk and R. The examples below work for both R and RServe (replace "R" with "RS"). 
</p>
<h3><a name="Initialize_R_or_RS"></a><span class="mw-headline">Initialize R or RS</span></h3>
<p>Before running R command in Labtalk, you can initialize the R application by running:
</p>
<pre class="lt" style="font-family:monospace;">if<span style="color: #000000;">&#40;</span> R.<span style="color: #000080;">Init</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">&lt;</span><span style="color: #0000dd;">0</span> <span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		type <span style="color: #000080;">-</span>b <span style="color: #ff00ff;">&quot;Please install R software first.&quot;</span>;
		return;
	<span style="color: #000000;">&#125;</span></pre>
<p>in the Script Window.
</p><p>To initialize the RS object, please refer to Script below, and view <a class="external text" href="../../UserGuide/UserGuide/Setup_R_Server.html">this page</a> for parameters setting.
</p>
<pre class="lt" style="font-family:monospace;">if<span style="color: #000000;">&#40;</span>RS.<span style="color: #000080;">Init</span><span style="color: #000000;">&#40;</span><span style="color: #000080;">***</span>.<span style="color: #000080;">***</span>.<span style="color: #000080;">**</span>.<span style="color: #000080;">**</span>, <span style="color: #0000dd;">12306</span>, user, password<span style="color: #000000;">&#41;</span><span style="color: #000080;">&lt;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>  <span style="color: #008000;">// Address is Rserve PC IP, e.g: 192.168.18.75</span>
	<span style="color: #000000;">&#123;</span>
		type <span style="color: #000080;">-</span>b <span style="color: #ff00ff;">&quot;Initialize failed.&quot;</span>;
		return;
	<span style="color: #000000;">&#125;</span></pre>
<h3><a name="Execute_R_and_RS_command"></a><span class="mw-headline">Execute R and RS command</span></h3>
<p><b>Execute R command</b>
</p>
<pre class="lt" style="font-family:monospace;">R.<span style="color: #000080;">Exec</span><span style="color: #000000;">&#40;</span>rand<span style="color: #000080;">&lt;</span><span style="color: #000080;">-</span>sample<span style="color: #000000;">&#40;</span>x <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">6</span>, size <span style="color: #000080;">=</span> <span style="color: #0000dd;">50</span>, replace <span style="color: #000080;">=</span> TRUE<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;
R.<span style="color: #000080;">Exec</span><span style="color: #000000;">&#40;</span>rand<span style="color: #000000;">&#41;</span>;</pre>
<p>and perform analysis:
</p>
<pre class="lt" style="font-family:monospace;">R.<span style="color: #000080;">Exec</span><span style="color: #000000;">&#40;</span>sum<span style="color: #000080;">&lt;</span><span style="color: #000080;">-</span>summary<span style="color: #000000;">&#40;</span>rand<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;
R.<span style="color: #000080;">Exec</span><span style="color: #000000;">&#40;</span>sum<span style="color: #000000;">&#41;</span>;</pre>
<p>The summary could be shown in this way:
</p>
<pre class="lt" style="font-family:monospace;">Min. 1st Qu.  <span style="color: #000080;">Median</span>    Mean 3rd Qu.    <span style="color: #000080;">Max</span>. 
<span style="color: #0000dd;">1.00</span>    <span style="color: #0000dd;">2.00</span>    <span style="color: #0000dd;">3.50</span>    <span style="color: #0000dd;">3.56</span>    <span style="color: #0000dd;">5.00</span>    <span style="color: #0000dd;">6.00</span></pre>
<p><b>Execute Multiple R Command Lines</b>
</p>
<pre class="lt" style="font-family:monospace;">R.<span style="color: #000080;">Exec</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;array&lt;-1:25;dim(array)&lt;-c(5,5);array&quot;</span><span style="color: #000000;">&#41;</span> <span style="color: #008000;">// Run multiple R command lines separated by semicolon</span></pre>
<p><b>Execute RS command</b>
</p>
<pre class="lt" style="font-family:monospace;">string fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Curve Fitting\Sensor01.dat&quot;</span>;
impasc;
range r1 <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">2</span>;

<span style="color: #008000;">//send data from worksheet to R vector</span>
RS.<span style="color: #000080;">Send</span><span style="color: #000000;">&#40;</span><span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>r1<span style="color: #000000;">&#41;</span>, RR, <span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">//send the range to R data.frame</span>
 
RS.<span style="color: #000080;">Exec</span><span style="color: #000000;">&#40;</span>fit<span style="color: #000080;">&lt;</span><span style="color: #000080;">-</span>lm<span style="color: #000000;">&#40;</span>RR<span style="color: #000080;">$</span>Sensor.<span style="color: #000080;">Output</span>~RR<span style="color: #000080;">$</span>Displacement<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">//perform linear fit</span>
RS.<span style="color: #000080;">Exec</span><span style="color: #000000;">&#40;</span>fit<span style="color: #000000;">&#41;</span>;</pre>
<h4><a name="Execute_R.2FRS_command_example"></a><span class="mw-headline">Execute R/RS command example</span></h4>
<p>In addition, a practical example is introduced in this page <a href="../../LabTalk/LabTalk/Perform_Logistic_regression_in_R_by_using_LabTalk.html" title="LabTalk:Perform Logistic regression in R by using LabTalk"><b>Perform Logistic regression in R by using LabTalk</b></a>.
</p>
<h3><a name="Execute_.R_file"></a><span class="mw-headline">Execute .R file</span></h3>
<p>If you want to execute a *.R file in your computer, you can use the syntax below in Script Window:
</p>
<pre class="lt" style="font-family:monospace;">R.<span style="color: #000080;">Exec</span><span style="color: #000000;">&#40;</span>source<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;.R file path&quot;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;</pre>
<p>For example:
</p>
<pre class="lt" style="font-family:monospace;">R.<span style="color: #000080;">Exec</span><span style="color: #000000;">&#40;</span>source<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;D:\\RData\\test.R&quot;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;</pre>
<h3><a name="Send_Origin_Dataset_to_R_Console"></a><span class="mw-headline">Send Origin Dataset to R Console</span></h3>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//Active a workbook</span>
R.<span style="color: #000080;">Send</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;1!1&quot;</span>, arr1, <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Send Column 1 in Sheet 1 current workbook to R as variable ''array'' (type vector)</span></pre>
<pre class="lt" style="font-family:monospace;">range rx<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>; <span style="color: #008000;">// Use range notation rx to refer to column 1 in active worksheet</span>
R.<span style="color: #000080;">Send</span><span style="color: #000000;">&#40;</span><span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>rx<span style="color: #000000;">&#41;</span>, rlabel, <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Send column 1 to R as variable rlabel (type vector)</span></pre>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Suppose the values of first columns are: 1, 2, 3, --</span>
range rr <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; <span style="color: #008000;">// Refer to first column in active worksheet</span>
R.<span style="color: #000080;">Send</span><span style="color: #000000;">&#40;</span><span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>rr<span style="color: #000000;">&#41;</span>, temp, <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Send first column as R variable temp</span></pre>
<h3><a name="Receive_R_Variable_as_Origin_Dataset"></a><span class="mw-headline">Receive R Variable as Origin Dataset</span></h3>
<pre class="lt" style="font-family:monospace;">R.<span style="color: #000080;">Receive</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;1!1&quot;</span>,RMat,<span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span> <span style="color: #008000;">// Receive R Matrix Variable RMat to first matrix object in current matrixbook and first matrix sheet</span>
R.<span style="color: #000080;">Receive</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;1!1&quot;</span>,df<span style="color: #000080;">$</span>vec1,<span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//Receive data member 'vec1' in R data frame 'df' to column as a vector</span></pre>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//Suppose there is a logical vector temp with value [1] FALSE FALSE TRUE</span>
range rl<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
R.<span style="color: #000080;">Receive</span><span style="color: #000000;">&#40;</span><span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>rl<span style="color: #000000;">&#41;</span>,temp,<span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Column 1 in active sheet would be 0,0,1 instead</span></pre>
<h3><a name="Pass_Variables_between_Labtalk_and_R"></a><span class="mw-headline">Pass Variables between Labtalk and R</span></h3>
<p><a href="../../LabTalk/LabTalk/R_(object).html" title="LabTalk:R (object)"><b>R</b></a> and <a href="../../LabTalk/LabTalk/Rserve_(object).html" title="LabTalk:Rserve (object)"><b>RS</b></a> objects have four member functions: <b>GetReal</b>, <b>SetReal</b>, <b>GetStr</b>, and <b>SetStr</b> which are used to pass numeric and string variables between Labtalk and R, for example:
</p><p>You define numeric or string variable in R Serve Console,
</p>
<pre class="lt" style="font-family:monospace;">Rvar<span style="color: #000080;">=</span><span style="color: #0000dd;">16</span>
Rstr<span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;height&quot;</span>
e1<span style="color: #000080;">=</span>list<span style="color: #000000;">&#40;</span>name<span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Apple&quot;</span>, a<span style="color: #000080;">=</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span></pre>
<p>You can pass value to LabTalk variable in this way:
</p>
<pre class="lt" style="font-family:monospace;">R.<span style="color: #000080;">GetReal</span><span style="color: #000000;">&#40;</span>LTVar, Rvar<span style="color: #000000;">&#41;</span>
R.<span style="color: #000080;">GetStr</span><span style="color: #000000;">&#40;</span>LTStr<span style="color: #000080;">$</span>, Rstr<span style="color: #000000;">&#41;</span>
<span style="color: #008000;">//pass a real number in a R list 'e1' to a Labtalk variable</span>
R.<span style="color: #000080;">GetReal</span><span style="color: #000000;">&#40;</span>LTVar,e1<span style="color: #000080;">$</span>a<span style="color: #000000;">&#41;</span>;</pre>
<p>Or you define a numeric or string variable in LabTalk, you can pass the value to R variable in this way:
</p>
<pre class="lt" style="font-family:monospace;">R.<span style="color: #000080;">SetReal</span><span style="color: #000000;">&#40;</span>LTVar2, Rvar<span style="color: #000000;">&#41;</span>
R.<span style="color: #000080;">SetStr</span><span style="color: #000000;">&#40;</span>LTStr2<span style="color: #000080;">$</span>, Rstr<span style="color: #000000;">&#41;</span></pre>
<h2><a name="Utilizing_R_Console_or_Rserve_Console"></a><span class="mw-headline">Utilizing R Console or Rserve Console</span></h2>
<p>We can use the R Console (or Rserve Console ) to run R commands directly in the dialog input box, then, pass the resulting values into an Origin worksheet using buttons <b>&lt;&lt;</b> and <b>&gt;&gt;</b>. Data can be exchanged in multiple formats (vector, matrix, data.frame) between R and Origin worksheet (or matrix sheet) by using R console (or Rserve Console).<br />
The following graph shows how to generate random data with a binomial distribution and pass it to an Origin worksheet. 
</p>
<dl><dd><a  class="image"><img alt="R Send Data.png" src="../images/LT_Running_R_in_Origin/R_Send_Data.png?v=32442" width="743"  /></a></dd></dl>






