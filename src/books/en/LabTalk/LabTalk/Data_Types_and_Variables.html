<h1 class="firstHeading">2.3.1.1 Data Types and Variables</h1><p class='urlname' style='display: none'>Data-Types-and-vars</p>
<p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#LabTalk_Data_TypesData_TypeVariable"><span class="tocnumber">1</span> <span class="toctext">LabTalk Data Types<span class="OIndex" style="display:none">Data Type</span><span class="OIndex" style="display:none">Variable</span></span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Numeric"><span class="tocnumber">1.1</span> <span class="toctext">Numeric</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Dataset"><span class="tocnumber">1.2</span> <span class="toctext">Dataset</span></a>
<ul>
<li class="toclevel-3 tocsection-4"><a href="#Temporary_Loose_Dataset"><span class="tocnumber">1.2.1</span> <span class="toctext">Temporary Loose Dataset</span></a></li>
<li class="toclevel-3 tocsection-5"><a href="#Project_Level_Loose_Dataset"><span class="tocnumber">1.2.2</span> <span class="toctext">Project Level Loose Dataset</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-6"><a href="#String"><span class="tocnumber">1.3</span> <span class="toctext">String</span></a>
<ul>
<li class="toclevel-3 tocsection-7"><a href="#String_Variables"><span class="tocnumber">1.3.1</span> <span class="toctext">String Variables</span></a></li>
<li class="toclevel-3 tocsection-8"><a href="#String_RegistersString_Register"><span class="tocnumber">1.3.2</span> <span class="toctext">String Registers<span class="OIndex" style="display:none">String Register</span></span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-9"><a href="#StringArray"><span class="tocnumber">1.4</span> <span class="toctext">StringArray</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Range"><span class="tocnumber">1.5</span> <span class="toctext">Range</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Tree"><span class="tocnumber">1.6</span> <span class="toctext">Tree</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Graphic_Objects"><span class="tocnumber">1.7</span> <span class="toctext">Graphic Objects</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-13"><a href="#Variables"><span class="tocnumber">2</span> <span class="toctext">Variables</span></a>
<ul>
<li class="toclevel-2 tocsection-14"><a href="#Variable_Naming_RulesVariable_Naming_Rule"><span class="tocnumber">2.1</span> <span class="toctext">Variable Naming Rules<span class="OIndex" style="display:none">Variable Naming Rule</span></span></a></li>
<li class="toclevel-2 tocsection-15"><a href="#Handling_Variable_Name_ConflictsVariable_Name_Conflict"><span class="tocnumber">2.2</span> <span class="toctext">Handling Variable Name Conflicts<span class="OIndex" style="display:none">Variable Name Conflict</span></span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#Listing_and_Deleting_VariablesList_VariablesDelete_Variable"><span class="tocnumber">2.3</span> <span class="toctext">Listing and Deleting Variables<span class="OIndex" style="display:none">List Variables</span><span class="OIndex" style="display:none">Delete Variable</span></span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-17"><a href="#Scope_of_Variables"><span class="tocnumber">3</span> <span class="toctext">Scope of Variables</span></a>
<ul>
<li class="toclevel-2 tocsection-18"><a href="#Project_Variables"><span class="tocnumber">3.1</span> <span class="toctext">Project Variables</span></a></li>
<li class="toclevel-2 tocsection-19"><a href="#Session_Variablesscope.2C_session"><span class="tocnumber">3.2</span> <span class="toctext">Session Variables<span class="OIndex" style="display:none">scope, session</span></span></a></li>
<li class="toclevel-2 tocsection-20"><a href="#Local_Variablesscope.2C_local"><span class="tocnumber">3.3</span> <span class="toctext">Local Variables<span class="OIndex" style="display:none">scope, local</span></span></a></li>
<li class="toclevel-2 tocsection-21"><a href="#Making_Local_Variables_and_Functions_Available_in_the_Session_scope.2C_forcing_change_of"><span class="tocnumber">3.4</span> <span class="toctext">Making Local Variables and Functions Available in the Session <span class="OIndex" style="display:none">scope, forcing change of</span></span></a></li>
<li class="toclevel-2 tocsection-22"><a href="#Summary_Table:_Scope_of_Variables"><span class="tocnumber">3.5</span> <span class="toctext">Summary Table: Scope of Variables</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="LabTalk_Data_TypesData_TypeVariable"></a><span class="mw-headline">LabTalk Data Types<span class="OIndex" style="display:none">Data Type</span><span class="OIndex" style="display:none">Variable</span></span></h2>
<p>LabTalk supports 9 data types:
</p>
<table class="simple">

<tr>
<th> Type
</th>
<th> Comment
</th></tr>
<tr>
<td> Double
</td>
<td> Double-precision floating-point number
</td></tr>
<tr>
<td> Integer
</td>
<td> Integers
</td></tr>
<tr>
<td> Constant
</td>
<td> Numeric data type that value cannot be changed once declared
</td></tr>
<tr>
<td> Dataset
</td>
<td> Array of numeric values
</td></tr>
<tr>
<td> String
</td>
<td> Sequences of characters
</td></tr>
<tr>
<td> StringArray
</td>
<td> Array of strings
</td></tr>
<tr>
<td> Range
</td>
<td> Refers to a specific region of Origin object (workbook, worksheet, etc.)
</td></tr>
<tr>
<td> Tree
</td>
<td> Emulates data with a set of branches and leaves
</td></tr>
<tr>
<td> Graphic Object
</td>
<td> Objects like labels, arrows, lines, and other user-created graphic elements
</td></tr></table>
<h3><a name="Numeric"></a><span class="mw-headline">Numeric</span></h3>
<p>LabTalk supports three <span class="OIndex">numeric data type</span>s: <b>double</b>, <b>int</b>, and <b>const</b>.
</p>
<ol><li> <span class="OIndex">Double</span>: double-precision floating-point number; this is the default variable type in Origin.</li>
<li> <span class="OIndex">Integer</span>: integers (<b>int</b>) are stored as double in LabTalk; truncation is performed during assignment.</li>
<li> <span class="OIndex">Constant</span>: constants (<b>const</b>) are a third numeric data type in LabTalk.  Once declared, the value of a <b>constant</b> cannot be changed. From Origin 2016, <b>constant</b> is auto-saved to orgvar.ogs once declared. It means that the <b>constant</b> will be saved as "System Variable" and available whenever a new Origin session is conducting.</li></ol>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Declare a new variable of type double:</span>
double dd <span style="color: #000080;">=</span> <span style="color: #0000dd;">4.5678</span>;
<span style="color: #008000;">// Declare a new integer variable:</span>
int vv <span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span>;
<span style="color: #008000;">// Declare a new constant:</span>
const em <span style="color: #000080;">=</span> <span style="color: #0000dd;">0.5772157</span>;</pre>
<p><b>Note</b>: 
</p>
<ul><li> To use a constant after open a new Origin session, you will need to define the constant in the CONST.CNF file under User File Folder.</li>
<li> LabTalk does not have a <b>complex</b> datatype. A column can be set as Numeric Complex and basic operations (+,-,*,/) work between columns or using literal values. While functions are available for extracting real and imaginary parts of a complex column value or literal expression, you should use <b>Origin C</b> if you need <b>complex</b> variables.</li></ul>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Direct, literal expression:</span>
<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000080;">-</span>13i<span style="color: #000000;">&#41;</span> <span style="color: #000080;">/</span> <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">7</span><span style="color: #000080;">+</span>2i<span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span>; 
<span style="color: #008000;">// (3-13i) / (7+2i)=-0.094339622641509-1.8301886792453i</span>
<span style="color: #008000;">// Assign literal expression to complex column</span>
col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000080;">-</span>13i<span style="color: #000000;">&#41;</span> <span style="color: #000080;">*</span> <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">7</span><span style="color: #000080;">+</span>2i<span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// Get Real part of complex column or literal expression</span>
dReal1 <span style="color: #000080;">=</span> imreal<span style="color: #000000;">&#40;</span>col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span>;
dReal2 <span style="color: #000080;">=</span> imreal<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000080;">-</span>13i<span style="color: #000000;">&#41;</span> <span style="color: #000080;">+</span> <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">7</span><span style="color: #000080;">+</span>2i<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// Get imaginary part of complex column or literal expression</span>
dImag1 <span style="color: #000080;">=</span> imaginary<span style="color: #000000;">&#40;</span>col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span>;
dImag2 <span style="color: #000080;">=</span> imaginary<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000080;">-</span>13i<span style="color: #000000;">&#41;</span> <span style="color: #000080;">-</span> <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">7</span><span style="color: #000080;">+</span>2i<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;</pre>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Data_Types_and_Variables/Alert_icon.png?v=0" width="57"  border="0" /></td><td><p>Values such as 0.0, NANUM (missing value) and values between -1.0E-290 to 1.0E-290 will be evaluated to be <i>False</i> in logic statement. For instance, LabTalk command will return a value 0 (False) instead of 1 (True). 
</p>
<pre class="lt" style="font-family:monospace;">type <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span><span style="color: #000080;">-</span>1e<span style="color: #000080;">-</span>290?<span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Returns 0 (False)</span>
type <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">/</span><span style="color: #0000dd;">0</span>?<span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Returns 0 (False), where 1/0 == NANUM</span></pre>
	</td>
	</tr>
	</table>
<h3><a name="Dataset"></a><span class="mw-headline">Dataset</span></h3>
<p>The <span class="OIndex">Dataset</span> data type is designed to hold an array of numeric values. 
</p>
<h4><a name="Temporary_Loose_Dataset"></a><span class="mw-headline">Temporary Loose Dataset</span></h4>
<p>When you declare a <a href="../../LabTalk/LabTalk/Datasets_(object).html" title="LabTalk:Datasets (object)"><b>dataset</b></a> variable it is stored internally as a local, <span class="OIndex">temporary loose dataset</span>.  Temporary means it will not be saved with the Origin project; loose means it is not affiliated with a particular worksheet.  Temporary loose datasets are used for computation only, and cannot be used for plotting.
</p><p>The following brief example demonstrates the use of this data type (<a href="../../LabTalk/LabTalk/Datasets_(object).html#Getting_and_Setting_Size" title="LabTalk:Datasets (object)">Dataset type declaration</a> and <a href="../../LabTalk/LabTalk/Numeric_to_String_Conversion.html" title="LabTalk:Numeric to String Conversion">$() Substitution Notation</a> are used in this example):
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Declare a dataset 'aa' with values from 1-10, </span>
<span style="color: #008000;">// with an increment of 0.2: </span>
dataset aa<span style="color: #000080;">=</span><span style="color: #000000;">&#123;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">0.2</span><span style="color: #000000;">:</span><span style="color: #0000dd;">10</span><span style="color: #000000;">&#125;</span>; 

<span style="color: #008000;">// Declare integer 'nSize',</span>
<span style="color: #008000;">// and assign to it the length of the new array: </span>
int nSize <span style="color: #000080;">=</span> aa.<span style="color: #000080;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Output the number of values in 'aa' to the Script Window: </span>
type <span style="color: #ff00ff;">&quot;aa has $(nSize) values&quot;</span>;</pre>
<h4><a name="Project_Level_Loose_Dataset"></a><span class="mw-headline">Project Level Loose Dataset</span></h4>
<p>When you create a dataset by vector assignment (without declaration) or by using the <a href="../../LabTalk/LabTalk/Create_(command).html" title="LabTalk:Create (command)">Create (Command)</a> it becomes a <span class="OIndex">project level loose dataset</span>, which can be used for computation or plotting.
</p><p>Create a project-level loose dataset by assignment,
</p>
<pre class="lt" style="font-family:monospace;">bb <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">10</span><span style="color: #000000;">:</span><span style="color: #0000dd;">2</span><span style="color: #000000;">:</span><span style="color: #0000dd;">100</span><span style="color: #000000;">&#125;</span></pre>
<p>Or by using the <b><a href="../../LabTalk/LabTalk/Create_(command).html" title="LabTalk:Create (command)">Create</a> command</b>:
</p>
<pre class="lt" style="font-family:monospace;">create <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>strWks<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">-</span>wdn <span style="color: #0000dd;">10</span> aa bb;</pre>
<p>For more on project-level and local-level variables see the section below on <a href="#Scope_of_Variables">Scope of Variables</a>.
</p><p>For more on working with Datasets, see <a href="../../LabTalk/LabTalk/Datasets_(object).html" title="LabTalk:Datasets (object)">Datasets</a>.
</p><p>For more on working with&#160;%( ), see <a href="../../LabTalk/LabTalk/Numeric_to_String_Conversion.html" title="LabTalk:Numeric to String Conversion">$( ) Substitution - Numeric to String Conversion</a>.
</p>
<h3><a name="String"></a><span class="mw-headline">String</span></h3>
<p>LabTalk supports string handling in two ways: string variables and string registers.
</p>
<h4><a name="String_Variables"></a><span class="mw-headline">String Variables</span></h4>
<p><span class="OIndex">String variable</span>s may be created by declaration and assignment or by assignment alone (depending on the desired <a href="../../LabTalk/LabTalk/Data_Types_and_Variables.html#Scope_of_Variables" title="LabTalk:Data Types and Variables">variable scope</a>), and are denoted in LabTalk by a name comprised of continuous characters (see <a href="#Variable_Naming_RulesVariable_Naming_Rule">Naming Rules</a> below) followed by a <b>$</b>-sign (i.e., <i>stringName$</i>):
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create a string with local/session scope by declaration and assignment</span>

<span style="color: #008000;">// Creates a string named &quot;greeting&quot;, </span>
<span style="color: #008000;">// and assigns to it the value &quot;Hello&quot;:  </span>
string greeting<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Hello&quot;</span>;

<span style="color: #008000;">// $ termination is optional in declaration, mandatory for assignment</span>
string FirstName, LastName; 
FirstName<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Isaac;
LastName<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Newton;

<span style="color: #008000;">// Create a project string by assignment without declaration: </span>
greeting2<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;World&quot;</span>;<span style="color: #008000;">//project scope and saved with OPJ</span>

<span style="color: #008000;">// string variable can make use of string class methods</span>
string str<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Johann Sebastian Bach;
str.<span style="color: #000080;">Find</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">'Sebastian'</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>;

<span style="color: #008000;">// Define literal strings</span>
<span style="color: #008000;">// The syntax &lt;[&lt; indicates the start of literal strings</span>
<span style="color: #008000;">// The syntax &gt;]&gt; indicates the end of literal strings</span>
<span style="color: #008000;">// Can be used to include special symbols like double quotation marks in a string</span>
string s1<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">&lt;</span><span style="color: #000000;">&#91;</span><span style="color: #000080;">&lt;</span>a<span style="color: #ff00ff;">&quot;b'&quot;</span>;<span style="color: #ff00ff;">&quot;c&quot;</span><span style="color: #000080;">&gt;</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">&gt;</span>;
s1<span style="color: #000080;">$</span><span style="color: #000080;">=</span>;
<span style="color: #008000;">//Should return a&quot;b'&quot;;&quot;c&quot;</span>

<span style="color: #008000;">//Use literal strings in X-Function arguments</span>
<span style="color: #008000;">// Fill in three rows in the current selected worksheet column</span>
patternT text<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span><span style="color: #000000;">&#91;</span><span style="color: #000080;">&lt;</span><span style="color: #ff00ff;">&quot;Sample A&quot;</span> <span style="color: #ff00ff;">&quot;Sample B&quot;</span> <span style="color: #ff00ff;">&quot;Sample C&quot;</span><span style="color: #000080;">&gt;</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">&gt;</span>;</pre>
<p>For more information on working with string variables, see the <a href="../../LabTalk/Script/String_Processing.html" title="Script:String Processing">String Processing</a> section.
</p>
<h4><a name="String_RegistersString_Register"></a><span class="mw-headline">String Registers<span class="OIndex" style="display:none">String Register</span></span></h4>
<p>Strings may be stored in <a href="../../LabTalk/LabTalk/String_registers.html" title="LabTalk:String registers">String registers</a>, denoted by a leading&#160;%-sign followed by a letter of the alphabet (i.e.,&#160;%A-%Z). String Registers are always global in scope.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000; font-style: regular;">/* Assign to the string register&#160;%A the string &quot;Hello World&quot;: */</span>
<span style="color: #000080;">%</span>A <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Hello World&quot;</span>;</pre>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Data_Types_and_Variables/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>For current versions of Origin, we encourage the use of string variables for working with strings, as they are supported by several useful built-in methods; for more, see <a href="../../LabTalk/LabTalk/String_(object).html" title="LabTalk:String (object)">String(Object)</a>.  If, however, you are already using string registers, see <a href="../../LabTalk/LabTalk/String_registers.html" title="LabTalk:String registers">String Registers</a> for complete documentation on their use. 
</p></td></tr></table>
<p><br />
</p>
<h3><a name="StringArray"></a><span class="mw-headline">StringArray</span></h3>
<p>The <span class="OIndex">StringArray</span> data type handles arrays of strings in the same way that the <a href="../../LabTalk/LabTalk/Datasets_(object).html" title="LabTalk:Datasets (object)">Datasets</a> data type handles arrays of numbers.  Like the String data type, StringArray is supported by several built-in methods; for more, see <a href="../../LabTalk/LabTalk/StringArray_(object).html" title="LabTalk:StringArray (object)">StringArray (Object)</a>.
</p><p>The following example demonstrates the use of StringArray: 
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Declare string array named &quot;aa&quot;,</span>
<span style="color: #008000;">// and use built-in methods Add, and GetSize: </span>
StringArray aa;             <span style="color: #008000;">// aa is an empty string array</span>
aa.<span style="color: #000080;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Boston&quot;</span><span style="color: #000000;">&#41;</span>;           <span style="color: #008000;">// aa now has one element: &quot;Boston&quot;</span>
aa.<span style="color: #000080;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;New York&quot;</span><span style="color: #000000;">&#41;</span>;         <span style="color: #008000;">// aa has a second element: &quot;New York&quot;</span>

<span style="color: #008000; font-style: regular;">/* Prints &quot;aa has 2 strings in it:&quot; then each string. */</span> 
type <span style="color: #ff00ff;">&quot;aa has $(aa.GetSize()) strings in it:&quot;</span>; 
loop<span style="color: #000000;">&#40;</span>ii,<span style="color: #0000dd;">1</span>,aa.<span style="color: #000080;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	ty aa.<span style="color: #000080;">GetAt</span><span style="color: #000000;">&#40;</span>ii<span style="color: #000000;">&#41;</span><span style="color: #000080;">$</span>;
<span style="color: #000000;">&#125;</span></pre>
<p><br />
</p>
<h3><a name="Range"></a><span class="mw-headline">Range</span></h3>
<p>The <span class="OIndex">range</span> data type allows functional access to many data-related Origin objects, referring to a specific region in a workbook, worksheet, graph, layer, or window.
</p><p>The general syntax is:
</p><p><b>range <i>rangeName</i> = [<i>WindowName</i>]<i>LayerNameOrIndex</i>!<i>DataRange[subRange]</i></b>
</p><p>which can be made specific to data in a workbook, matrix, or graph:
</p><p><b>range <i>rangeName</i> = [<i>BookName</i>]<i>SheetNameOrIndex</i>!<i>ColumnNameOrIndex</i>[<i>RowBegin</i>:<i>RowEnd</i>]</b> 
</p><p><b>range <i>rangeName</i> = [<i>MatrixBookName</i>]<i>MatrixSheetNameOrIndex</i>!<i>MatrixObjectNameOrIndex[CellBegin:CellEnd]</i></b>
</p><p><b>range <i>rangeName</i> =[<i>GraphName</i>]<i>LayerNameOrIndex</i>!<i>DataPlotIndex[RowBegin:RowEnd]</i></b>
</p><p>The special syntax <b>[??]</b> is used to create a range variable to access a loose dataset.
</p><p>For example:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Access Column 3 on Book1, Sheet2:</span>
range cc <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>Book1<span style="color: #000000;">&#93;</span>Sheet2<span style="color: #000080;">!</span>Col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>; 
<span style="color: #008000;">// Access second curve on Graph1, layer1:  </span>
range ll <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>Graph1<span style="color: #000000;">&#93;</span>Layer1<span style="color: #000080;">!</span><span style="color: #0000dd;">2</span>; 
<span style="color: #008000;">// Access second matrix object on MBook1, MSheet1:      </span>
range mm <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>MBook1<span style="color: #000000;">&#93;</span>MSheet1<span style="color: #000080;">!</span><span style="color: #0000dd;">2</span>;
<span style="color: #008000;">// Access loose dataset tmpdata_a:      </span>
range xx <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>??<span style="color: #000000;">&#93;</span><span style="color: #000080;">!</span>tmpdata_a;</pre>
<p><b>Notes</b>: 
</p>
<ul><li> CellRange can be a single cell, (part of) a row or column, a group of cells, or a non-contiguous selection of cells. </li>
<li> Worksheets, Matrixsheets, and Graph Layers can each be referenced by name or index.</li>
<li> You can define a <a href="../../LabTalk/LabTalk/Range_Notation.html#Range_Variable" title="LabTalk:Range Notation">range variable</a> to represent an <a href="../../LabTalk/Category/Origin_Objects.html" title="Category:Origin Objects">origin object</a>, or use range directly as an <a href="../../LabTalk/LabTalk/Range_Notation.html#Range_as_X-Function_Arguments" title="LabTalk:Range Notation">X-Function argument</a>. </li>
<li> Many more details on the <b>range data type</b> and uses of <b>range variables</b> can be found in the <a href="../../LabTalk/LabTalk/Range_Notation.html" title="LabTalk:Range Notation">Range Notation</a>.</li></ul>
<h3><a name="Tree"></a><span class="mw-headline">Tree</span></h3>
<p>LabTalk supports the standard <span class="OIndex">tree data type</span>, which emulates a tree structure with a set of branches and leaves.  The branches contain leaves, and the leaves contain data.  Both branches and leaves are called nodes.
</p>
<dl><dd><b>Leaf</b>: A node that has no children, so it can contain a value</dd>
<dd><b>Branch</b>: A node that has child nodes and does not contain a value</dd></dl>
<p>A leaf node may contain a variable that is of <b>numeric</b>, <b>string</b>, or <b>dataset</b> (vector) type.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Declare an empty tree</span>
tree report;        
<span style="color: #008000;">// Tree nodes are added automatically during assignment:</span>
<span style="color: #008000;">//report two has 2 branches, each branche has two leaves</span>
report.<span style="color: #000080;">user</span>.<span style="color: #000080;">name</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;dog&quot;</span>; <span style="color: #008000;">//string</span>
report.<span style="color: #000080;">user</span>.<span style="color: #000080;">age</span><span style="color: #000080;">=</span><span style="color: #0000dd;">22</span>; <span style="color: #008000;">// number</span>
report.<span style="color: #000080;">test</span>.<span style="color: #000080;">name</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;sensor&quot;</span>;
report.<span style="color: #000080;">test</span>.<span style="color: #000080;">temp</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">32.0</span>;

report.<span style="color: #000080;">=</span>; <span style="color: #008000;">//output the tree contents</span>

<span style="color: #008000;">// Save the tree contents to an XML string</span>
string strXML;
report.<span style="color: #000080;">ToString</span><span style="color: #000000;">&#40;</span>strXML<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>;
strXML<span style="color: #000080;">$</span><span style="color: #000080;">=</span>;

<span style="color: #008000;">// Declare a new tree 'newReport' and assign to it data from tree 'report': </span>
tree newReport <span style="color: #000080;">=</span> report; 
newReport.<span style="color: #000080;">user</span>.<span style="color: #000080;">name</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>;
newReport.<span style="color: #000080;">test</span>.<span style="color: #000080;">temp</span><span style="color: #000080;">=</span>;</pre>
<p><br />
Check if a tree, branch or leaf exists
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//Run after above script. Return 24 if exists. Otherwise return 0</span>
exist<span style="color: #000000;">&#40;</span>report<span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>; <span style="color: #008000;">//returns 24</span>
exist<span style="color: #000000;">&#40;</span>report.<span style="color: #000080;">user</span>.<span style="color: #000080;">name</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>; <span style="color: #008000;">//returns 24</span>
exist<span style="color: #000000;">&#40;</span>report.<span style="color: #000080;">test</span>.<span style="color: #000080;">temp</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>; <span style="color: #000080;">/</span>returns <span style="color: #0000dd;">24</span>
exist<span style="color: #000000;">&#40;</span>report.<span style="color: #000080;">test</span>.<span style="color: #000080;">x</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>; <span style="color: #008000;">//returns 0</span></pre>
<p><br />
Check if it's branch or leaf
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//returns 2 for branch, 1 for leaf, 0 for invalid</span>
report@<span style="color: #000080;">=</span> <span style="color: #008000;">//returns 2 tree itself is a branch</span>
report.<span style="color: #000080;">user</span>@<span style="color: #000080;">=</span>;   <span style="color: #008000;">// returns 2, branch</span>
report.<span style="color: #000080;">user</span>.<span style="color: #000080;">name</span>@<span style="color: #000080;">=</span>; <span style="color: #008000;">// returns 1, leaf</span>
report.<span style="color: #000080;">test</span>.<span style="color: #000080;">temp</span>@<span style="color: #000080;">=</span>; <span style="color: #008000;">// returns 1, leaf</span>
report.<span style="color: #000080;">test</span>.<span style="color: #000080;">speed</span>@<span style="color: #000080;">=</span>;<span style="color: #008000;">/// return 0, invalid</span></pre>
<p><br />
Trees are commonly used in Origin to set and store a set related of parameters. The tree data type is often used in X-Function's tree type argument, no matter it's input or output. 
</p><p>For example: when using <b>impasc</b> X-Function to import data into Origin, a tree type argument <a class="external text" href="../../XFunction/X-Function/Details_of_TreeNodes_in_Import_ASCII.html"><b>options</b></a> holds the parameters which determine how the import is performed. This is <b>options</b> tree is an input argument.
</p>
<pre class="lt" style="font-family:monospace;">string str<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Graphing\Group.dat&quot;</span>; 
impasc fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>str<span style="color: #000080;">$</span>
<span style="color: #008000; font-style: regular;">/* Start with new sheet */</span> 
options.<span style="color: #000080;">ImpMode</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span> 
<span style="color: #008000; font-style: regular;">/* Only import the first three columns */</span>
options.<span style="color: #000080;">Cols</span>.<span style="color: #000080;">NumCols</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span>;</pre>
<p><br />
<b>impinfo</b> X-Function has a tree type output argument <b>trInfo</b>
After importing data into a worksheet, the following script put the file info. into a tree variable 'fileInfo'.
</p>
<pre class="lt" style="font-family:monospace;">impinfo trInfo<span style="color: #000000;">:</span><span style="color: #000080;">=</span>fileInfo; 
fileInfo.<span style="color: #000080;">=</span> <span style="color: #008000;">//output all contents of the tree</span></pre>
<p><br />
Tree nodes can be strings or numbers. The following example shows how to copy tree nodes with string data and numeric data to worksheet columns:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//Import the data file into worksheet</span>
newbook;
string fn<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;\samples\statistics\automobile.dat&quot;</span>; 
impasc fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>fn<span style="color: #000080;">$</span>;
tree tr;
<span style="color: #008000;">//Perform discrte frequency counts on 2nd column, save results to tr</span>
discfreqs irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span> rd<span style="color: #000000;">:</span><span style="color: #000080;">=</span>tr;
newsheet name<span style="color: #000000;">:</span><span style="color: #000080;">=</span>Result; <span style="color: #008000;">//add a new worksheet with name 'Result'</span>
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> tr.<span style="color: #000080;">freqcount1</span>.<span style="color: #000080;">data1</span>; <span style="color: #008000;">// put 'data1' leaf (all strings) to 1st column</span>
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> tr.<span style="color: #000080;">freqcount1</span>.<span style="color: #000080;">count1</span>; <span style="color: #008000;">//put 'count1' leaf (numbers) to 2nd column</span></pre>
<p>Tree nodes can also be vectors. Prior to <b>Origin 8.1 SR1</b> the only way to access a vector in a Tree variable was to make a direct assignment, as shown in the example code below:
</p>
<pre class="lt" style="font-family:monospace;">tree tr;
<span style="color: #008000;">// If you assign a dataset to a tree node,</span>
<span style="color: #008000;">// it will be a vector node automatically:</span>
tr.<span style="color: #000080;">a</span><span style="color: #000080;">=</span>data<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">10</span><span style="color: #000000;">&#41;</span>; 
<span style="color: #008000;">// A vector treenode can be assigned to a column:</span>
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>tr.<span style="color: #000080;">a</span>; 
<span style="color: #008000;">// A vector treenode can be assigned to a loose dataset, which is</span>
<span style="color: #008000;">// convenient since a tree node cannot be used for direct calculations</span>
dataset temp<span style="color: #000080;">=</span>tr.<span style="color: #000080;">a</span>;
<span style="color: #008000;">// Perform calculation on the loose dataset:</span>
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>temp<span style="color: #000080;">*</span><span style="color: #0000dd;">2</span>;</pre>
<p><br />
You can access elements of a vector tree node directly, with statements such as:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Following the example immediately above,</span>
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> tr.<span style="color: #000080;">a</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#93;</span>;</pre>
<p>that assigns the third element of vector <b>tr.a</b> to the first row of column 3 in the current worksheet.
</p><p>You can also output analysis results to a tree variable, like the example below.
</p>
<pre class="lt" style="font-family:monospace;">newbook;
<span style="color: #008000;">//Import the data file into worksheet</span>
string fn<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;\samples\Signal Processing\fftfilter1.dat&quot;</span>; 
impasc fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>fn<span style="color: #000080;">$</span>;
tree mytr;
<span style="color: #008000;">//Perform FFT and save results to a tree variable</span>
fft1 ix<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> rd<span style="color: #000000;">:</span><span style="color: #000080;">=</span>mytr;
page.<span style="color: #000080;">active</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> mytr.<span style="color: #000080;">fft</span>.<span style="color: #000080;">real</span>;
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> mytr.<span style="color: #000080;">fft</span>.<span style="color: #000080;">imag</span>;</pre>
<p>More information on trees can be found in the chapter on Origin Projects,<a href="../../LabTalk/Script/Accessing_Metadata.html#Trees" title="Script:Accessing Metadata"><b>Accessing Metadata</b> section</a>.
</p>
<h3><a name="Graphic_Objects"></a><span class="mw-headline">Graphic Objects</span></h3>
<p>The new LabTalk variable type GObject allows the control of <span class="OIndex">graphic object</span>s in any book/layer.
</p><p>The general syntax is:
</p><p><font color="navy"><b>GObject <i>name</i> = [<i>GraphPageName</i>]<i>LayerIndex</i>!<i>ObjectName</i>;</b></font>
</p><p><font color="navy"><b>GObject <i>name</i> = [<i>GraphPageName</i>]<i>LayerName</i>!<i>ObjectName</i>;</b></font>
</p><p><font color="navy"><b>GObject <i>name</i> = <i>LayerName</i>!<i>ObjectName</i>;</b></font> // active graph 
</p><p><font color="navy"><b>GObject <i>name</i> = <i>LayerIndex</i>!<i>ObjectName</i>;</b></font> // active graph 
</p><p><font color="navy"><b>GObject <i>name</i> = <i>ObjectName</i>;</b></font> // active layer 
</p><p>You can declare GObject variables for both existing objects as well as for not-yet created objects.
</p><p>For example:
</p>
<pre class="lt" style="font-family:monospace;">GObject myLine <span style="color: #000080;">=</span> line1;
draw <span style="color: #000080;">-</span>n myLine <span style="color: #000080;">-</span>l <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">3</span>,<span style="color: #0000dd;">4</span><span style="color: #000000;">&#125;</span>;
win <span style="color: #000080;">-</span>t plot;
myLine.<span style="color: #000080;">X</span><span style="color: #000080;">+</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>; 
<span style="color: #008000; font-style: regular;">/* Even though myLine is in a different graph 
that is not active, you can still control it! */</span></pre>
<p>For a full description of Graphic Objects and their properties and methods, please see <a href="../../LabTalk/LabTalk/Graphic_Objects.html" title="LabTalk:Graphic Objects">Graphic Objects</a>.
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<p>A <span class="OIndex">variable</span> is simply an instance of a particular data type.  Every variable has a name, or identifier, which is used to assign data to it, or access data from it.  The assignment operator is the equal sign (=), and it is used to simultaneously create a variable (if it does not already exist) and assign a value to it.
</p>
<h3><a name="Variable_Naming_RulesVariable_Naming_Rule"></a><span class="mw-headline">Variable Naming Rules<span class="OIndex" style="display:none">Variable Naming Rule</span></span></h3>
<p>Variable, dataset, command, and macro names are referred to generally as identifiers.  When assigning identifiers in LabTalk:
</p>
<ul><li> Use any combination of letters and numbers, but note that:
<ul><li> the identifier cannot be more than 25 characters in length.</li>
<li> the first character cannot be a number. </li>
<li> the underscore character "_" has a special meaning in dataset names and should be avoided.</li></ul></li></ul>
<ul><li> Use the <a href="../../LabTalk/LabTalk/Exist_(function).html" title="LabTalk:Exist (function)"><b>Exist</b> (Function)</a> to check if an identifier is being used to name a window, macro, tool, dataset, or variable. </li></ul>
<ul><li> Note that several common identifiers are reserved for system use by Origin, please see <a href="../../LabTalk/LabTalk/System_Variables.html" title="LabTalk:System Variables">System Variables</a> for a complete list.</li></ul>
<ul><li> To avoid conflict with column short names in <a class="external text" href="../../UserGuide/UserGuide/Quick_Start_SetColumnValues.html#Column_Formula_Examples">column value calculations</a>, it is recommended that you use at least 4 characters when assigning variable names.</li></ul>
<h3><a name="Handling_Variable_Name_ConflictsVariable_Name_Conflict"></a><span class="mw-headline">Handling Variable Name Conflicts<span class="OIndex" style="display:none">Variable Name Conflict</span></span></h3>
<p>The <b>@ppv</b> system variable controls how Origin handles naming conflicts between project, session, and local variables.  Like all system variables, <b>@ppv</b> can be changed from script anytime and takes immediate effect.  
</p>
<table class="simple">
<tr>
<th> <b>Variable</b>
</th>
<th> <b>Description</b>
</th></tr>
<tr>
<td> @ppv=0
</td>
<td> This is the DEFAULT option and allows both session variables and local variables to use existing project variable names.  In the event of a conflict, session or local variables are used.
</td></tr>
<tr>
<td> @ppv=1
</td>
<td> This option makes declaring a session variable with the same name as an existing project variable illegal.  Upon loading a new project, session variables with a name conflict will be disabled until the project is closed or the project variable with the same name is deleted.
</td></tr>
<tr>
<td> @ppv=2
</td>
<td> This option makes declaring a local variable with the same name as an existing project variable illegal.  Upon loading of new project, local variables with a name conflict will be disabled until the project is closed or the project variable with the same name is deleted.
</td></tr>
<tr>
<td> @ppv=3
</td>
<td> This is the combination of @ppv=1 and @ppv=2. In this case, all session and local variables will not be allowed to use project variable names. If a new project is loaded, existing session or local variables of the same name will be disabled.
</td></tr></table>
<h3><a name="Listing_and_Deleting_VariablesList_VariablesDelete_Variable"></a><span class="mw-headline">Listing and Deleting Variables<span class="OIndex" style="display:none">List Variables</span><span class="OIndex" style="display:none">Delete Variable</span></span></h3>
<p>Use the LabTalk commands <b>list</b> and <b>del</b> for listing variables and deleting variables, respectively.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000; font-style: regular;">/* Use the LabTalk command &quot;list&quot; with various options to list 
variables; the list will print in the Script Window by default: */</span>

list a;       <span style="color: #008000;">// List all the session variables</span>
list v;       <span style="color: #008000;">// List all project and session variables</span>
list vs;      <span style="color: #008000;">// List all project and session string variables</span>
list vt;      <span style="color: #008000;">// List all project and session tree variables</span>

<span style="color: #008000;">// Use the LabTalk command &quot;del&quot; to delete variables:</span>

del <span style="color: #000080;">-</span>al <span style="color: #000080;">&lt;</span>variableName<span style="color: #000080;">&gt;</span>;  <span style="color: #008000;">// Delete specific local or session variable</span>
del <span style="color: #000080;">-</span>al <span style="color: #000080;">*</span>;               <span style="color: #008000;">// Delete all the local and session variables</span>

<span style="color: #008000;">// There is also a viewer for LabTalk variables:</span>
<span style="color: #008000;">// &quot;ed&quot; command can also open the viewer</span>
list;                     <span style="color: #008000;">// Open the LabTalk Variables Viewer</span></pre>
<p>Please see the <a href="../../LabTalk/LabTalk/List_(command).html" title="LabTalk:List (command)"><b>List</b> (Command)</a>, and <a href="../../LabTalk/LabTalk/Delete_(command).html" title="LabTalk:Delete (command)"><b>Del</b> (Command)</a> (in Language Reference: Command Reference) for all listing and deleting options.
</p><p>If no options are specified, running either the <a href="../../LabTalk/LabTalk/List_(command).html" title="LabTalk:List (command)">List</a> or <a href="../../LabTalk/LabTalk/Edit_(command).html" title="LabTalk:Edit (command)">Edit</a> command will open the LabTalk Variables and Functions dialog and list all variables and functions.
</p>
<h2><a name="Scope_of_Variables"></a><span class="mw-headline">Scope of Variables</span></h2>
<p>The way a variable is declared determines its <span class="OIndex">scope</span><span class="OIndex HasShownIndex" style="display:none">scope of variables</span>.  Variables created without declaration (only allowed for types <b>double</b>, <b>string</b>, and <b>dataset</b>) become Project variables and are saved with the Origin Project file.  Declared variables become Session or Local variables.  Scope in LabTalk consists of three (nested) levels of visibility: 
</p>
<ul><li> <a href="#Project_Variables">Project variables</a></li>
<li> <a href="#Session_Variablesscope.2C_session">Session variables</a></li>
<li> <a href="#Local_Variablesscope.2C_local">Local variables</a></li></ul>
<p><br />
In practical terms this means that (a) you can have multiple variables of the same name and (b) when that is the case, the value returned at any given time is dependent upon the current scope (see Session and Local variables, below).
</p>
<h3><a name="Project_Variables"></a><span class="mw-headline">Project Variables</span></h3>
<ul><li> <span class="OIndex">Project variables</span><span class="OIndex" style="display:none">variable, project</span> are saved with the Origin Project (*.OPJ).  Project variables are said to have <span class="OIndex">Project scope</span><span class="OIndex HasShownIndex" style="display:none">scope, project</span>. </li>
<li> Project variables are automatically created without declaration for variables of type <b>double</b>, <b>string</b>, and <b>dataset</b> as in:</li></ul>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Define a project (project scope) variable of type double:</span>
myvar <span style="color: #000080;">=</span> <span style="color: #0000dd;">3.5</span>;
<span style="color: #008000;">// Define a loose dataset (project scope):</span>
temp <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">3</span>,<span style="color: #0000dd;">4</span>,<span style="color: #0000dd;">5</span><span style="color: #000000;">&#125;</span>;
<span style="color: #008000;">// Define a project (project scope) variable of type string:    </span>
str<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Hello&quot;</span>;</pre>
<ul><li> All other variable types must be declared, which makes their default scope either Session or Local.  Note that you can make Local variables available as Session variables, <a href="#Making_Local_Variables_and_Functions_Available_in_the_Session_scope.2C_forcing_change_of">using the <b>@glob</b> system variable</a>, as described below.</li></ul>
<h3><a name="Session_Variablesscope.2C_session"></a><span class="mw-headline">Session Variables<span class="OIndex" style="display:none">scope, session</span></span></h3>
<ul><li> <span class="OIndex">Session variables</span><span class="OIndex" style="display:none">variable, session</span> are not saved with the Origin Project, and are available in the current Origin session across projects. Thus, once a Session variable has been defined, they exist until the Origin application is terminated or the variable is deleted. Session variables are defined with variable declarations: </li></ul>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Defines a variable of type double:</span>
double var1 <span style="color: #000080;">=</span> <span style="color: #0000dd;">4.5</span>; 
<span style="color: #008000;">// Define loose dataset:             </span>
dataset mytemp <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">3</span>,<span style="color: #0000dd;">4</span>,<span style="color: #0000dd;">5</span><span style="color: #000000;">&#125;</span>;</pre>
<p>You can have a Project variable and a Session variable of the same name. In such cases, the Session variable takes precedence:
</p>
<pre class="lt" style="font-family:monospace;">aa <span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span>;
type <span style="color: #ff00ff;">&quot;First, aa is a project variable equal to $(aa)&quot;</span>;
double aa <span style="color: #000080;">=</span> <span style="color: #0000dd;">20</span>;
type <span style="color: #ff00ff;">&quot;Then aa is a session variable equal to $(aa)&quot;</span>;
del <span style="color: #000080;">-</span>al aa;
type <span style="color: #ff00ff;">&quot;Now aa is project variable equal to $(aa)&quot;</span>;</pre>
<p>And the output is:
</p>
<pre class="lt" style="font-family:monospace;">First, aa is a project variable equal to <span style="color: #0000dd;">10</span>
Then aa is a session variable equal to <span style="color: #0000dd;">20</span>
Now aa is project variable equal to <span style="color: #0000dd;">10</span></pre>
<h3><a name="Local_Variablesscope.2C_local"></a><span class="mw-headline">Local Variables<span class="OIndex" style="display:none">scope, local</span></span></h3>
<p><span class="OIndex">Local variables</span><span class="OIndex HasShownIndex" style="display:none">variable, local</span> exist only within the current scope of a particular script.
</p><p>Script-level scope exists for scripts:
</p>
<ul><li> enclosed in curly braces {},</li>
<li> in separate <a href="../../LabTalk/Script/From_Files.html" title="Script:From Files">*.OGS</a> files or individual sections of *.OGS files,</li>
<li> inside the Set Column/Matrix Values Dialog, or</li>
<li> behind a custom button (Button Script).</li></ul>
<p>Local variables are declared and assigned values in the same way as Session variables: 
</p>
<pre class="lt" style="font-family:monospace;">loop<span style="color: #000000;">&#40;</span>i,<span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">10</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#123;</span>
     double a <span style="color: #000080;">=</span> <span style="color: #0000dd;">3.5</span>;
     const e <span style="color: #000080;">=</span> <span style="color: #0000dd;">2.718</span>;
     <span style="color: #008000;">// some other lines of script...</span>
<span style="color: #000000;">&#125;</span>
<span style="color: #008000;">// &quot;a&quot; and &quot;e&quot; exist only inside the code enclosed by {}</span></pre>
<p>It is possible to have Local variables with the same name as Session variables or Project variables.  In this case, the Local variable takes precedence over the Session or Project variable of the same name, within the scope of the script. For example, if you run the following script (Please refer to <a href="../../LabTalk/Script/From_Files.html" title="Script:From Files">Run LabTalk Script From Files</a> for details on how to run such script):
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">&#91;</span>Main<span style="color: #000000;">&#93;</span>
double aa <span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span>;
type <span style="color: #ff00ff;">&quot;In the main section, aa equals $(aa)&quot;</span>;
run.<span style="color: #000080;">section</span><span style="color: #000000;">&#40;</span>, section1<span style="color: #000000;">&#41;</span>;
run.<span style="color: #000080;">section</span><span style="color: #000000;">&#40;</span>, section2<span style="color: #000000;">&#41;</span>;

<span style="color: #000000;">&#91;</span>section1<span style="color: #000000;">&#93;</span>
double aa <span style="color: #000080;">=</span> <span style="color: #0000dd;">20</span>;
type <span style="color: #ff00ff;">&quot;In section1, aa equals $(aa)&quot;</span>;

<span style="color: #000000;">&#91;</span>section2<span style="color: #000000;">&#93;</span>
<span style="color: #008000;">// This section does not declare a local variable named 'aa'.</span>
<span style="color: #008000;">// A variable named 'aa' will be searched for in the following order:</span>
<span style="color: #008000;">// If a Session variable named 'aa' exists then it will be used.</span>
<span style="color: #008000;">// Else if a Project variable named 'aa' exists then it will be used.</span>
<span style="color: #008000;">// Else if this section is called from another section and the caller</span>
<span style="color: #008000;">//     section declared a local variable named 'aa' then it will be used.</span>
<span style="color: #008000;">// Else 'aa' will be a missing value.</span>
type <span style="color: #ff00ff;">&quot;In section2, aa equals $(aa)&quot;</span>;</pre>
<p>Origin will output:
</p>
<pre class="lt" style="font-family:monospace;">In the main section, aa equals <span style="color: #0000dd;">10</span>
In section1, aa equals <span style="color: #0000dd;">20</span>
In section2, aa equals <span style="color: #0000dd;">10</span></pre>
<h3><a name="Making_Local_Variables_and_Functions_Available_in_the_Session_scope.2C_forcing_change_of"></a><span class="mw-headline">Making Local Variables and Functions Available in the Session <span class="OIndex" style="display:none">scope, forcing change of</span></span></h3>
<p>At times you may want to define variables or functions in a <a href="../../LabTalk/Script/From_Files.html" title="Script:From Files">*.OGS</a> file, but then be able to use them from the Script Window, in a text label, etc. (normally, the Local variable or function ceases to exist when the OGS runs to completion). To do so, set the value of the <b>@glob</b> system variable to <b>1</b> (default value is <b>0</b>). This makes Local variables and functions in the OGS file available in the Session:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">&#91;</span>Main<span style="color: #000000;">&#93;</span>
@glob <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
<span style="color: #008000;">// the following declarations become available in the session</span>
range a <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>, b<span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
if<span style="color: #000000;">&#40;</span>a<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#93;</span> <span style="color: #000080;">&gt;</span> <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span> 
  <span style="color: #008000;">// begin a local scope</span>
  range c <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>; <span style="color: #008000;">// this declaration is still available in the session</span>
<span style="color: #000000;">&#125;</span></pre>
<p>Upon exiting the *.OGS, the <b>@glob</b> variable is automatically restored to its default value, <b>0</b>.
</p><p>Note that one can also control a block of code by placing @glob at the beginning and end, as in:
</p>
<pre class="lt" style="font-family:monospace;">@glob<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
double alpha<span style="color: #000080;">=</span><span style="color: #0000dd;">1.2</span>;
double beta<span style="color: #000080;">=</span><span style="color: #0000dd;">2.3</span>;
Function double myPeak<span style="color: #000000;">&#40;</span>double x, double x0<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
   double y <span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span><span style="color: #000080;">*</span>exp<span style="color: #000000;">&#40;</span><span style="color: #000080;">-</span><span style="color: #000000;">&#40;</span>x<span style="color: #000080;">-</span>x0<span style="color: #000000;">&#41;</span><span style="color: #000080;">^</span><span style="color: #0000dd;">2</span><span style="color: #000080;">/</span><span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span>;
   return y;
<span style="color: #000000;">&#125;</span>
@glob<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;
double gamma<span style="color: #000080;">=</span><span style="color: #0000dd;">3.45</span>;</pre>
<p>In the above script, variables alpha, beta, and the user-defined function myPeak will be available in the session. The variable gamma will not be available because it was declared after @glob was returned to its default value of 0.
</p>
<h3><a name="Summary_Table:_Scope_of_Variables"></a><span class="mw-headline">Summary Table: Scope of Variables</span></h3>
<table class="simple">
<tr>
<th>
</th>
<th width="10%">Data Type
</th>
<th width="10%">Declared?
</th>
<th width="20%">Where Defined
</th>
<th width="20%">Example
</th>
<th width="20%">Lifetime
</th></tr>
<tr>
<th> Constant
</th>
<td> constant
</td>
<td> Yes (const)
</td>
<td>
<ul><li>Script Window</li>
<li>Command Window</li>
<li>OGS File</li>
<li>Various GUI dialogs</li></ul>
</td>
<td> const av = 6.022×10<sup>23</sup>;
</td>
<td> While Origin runs. All constants are saved in orgvar.ogs.
</td></tr>
<tr>
<th> Project Variable
</th>
<td> double, <br />string, <br />dataset
</td>
<td> No
</td>
<td>
<ul><li>Script Window</li>
<li>Command Window</li>
<li>OGS File</li>
<li>Various GUI dialogs</li></ul>
</td>
<td> av = 6.022×10<sup>23</sup>;
</td>
<td> While the OPJ is open. <br />Saved with the OPJ.
</td></tr>
<tr>
<th> Session Variable
</th>
<td> all types
</td>
<td> Yes
</td>
<td>
<ul><li>Script Window</li>
<li>Command Window</li></ul>
</td>
<td> double av = 6.022×10<sup>23</sup>;
</td>
<td> While the session runs. <br />NOT saved with the OPJ.
</td></tr>
<tr>
<th> Local Variable
</th>
<td> all types
</td>
<td> Yes
</td>
<td>
<ul><li> OGS file</li>
<li> Various GUI dialogs</li></ul>
</td>
<td> double av = 6.022×10<sup>23</sup>;
</td>
<td> While the script runs.
</td></tr>
<tr>
<th> Local Variable <br />as <br />Session Variable
</th>
<td> all types
</td>
<td> Yes
</td>
<td>
<ul><li> OGS file</li>
<li> Various GUI dialogs</li></ul>
</td>
<td> <b>@glob=1</b>; <br />double av = 6.022×10<sup>23</sup>;
</td>
<td> While the session runs. <br />Can be saved with the OPJ (see <a href="../../LabTalk/Script/ProjectEvents_Script.html" title="Script:ProjectEvents Script">ProjectEvents.OGS</a>).
</td></tr></table>


