<h1 class="firstHeading">3.3.2.33.5 Options for Layer</h1><p class='urlname' style='display: none'>Layer_Options_for_Layer</p>
<p><br />
</p>
<h2><a name="-d"></a><span class="mw-headline">-d</span></h2>
<p><b>Syntax:</b> layer <b>-d</b>
</p><p>Delete the active layer, but keep data (in loose datasets).
</p><p>This will delete the sheet and if last sheet deleted, the book will be deleted as well.
</p><p>This command was expanded as follows:
</p>
<pre class="lt" style="font-family:monospace;">layer <span style="color: #000080;">-</span>d name; <span style="color: #008000;">// del layer/sheet in active page </span>
layer <span style="color: #000080;">-</span>d <span style="color: #000000;">&#91;</span>book<span style="color: #000000;">&#93;</span>sheet;<span style="color: #008000;">// general range notation</span></pre>
<p>Also supported are the accompanying d, k, and u switches,  
</p>
<pre class="lt" style="font-family:monospace;">layer <span style="color: #000080;">-</span>dd;  <span style="color: #008000;">// del active layer, delete data too</span>
layer <span style="color: #000080;">-</span>du;  <span style="color: #008000;">// del active layer, adding undo </span>
layer <span style="color: #000080;">-</span>dk;  <span style="color: #008000;">// del active layer, keeping book if last sheet is deleted</span>
layer <span style="color: #000080;">-</span>duk; <span style="color: #008000;">// del active layer, with both 'u' and 'k' options</span></pre>
<p><b>Notes</b>: 
</p>
<ul><li> <i>-duk</i> and <i>-dku</i> are the same</li>
<li> If <i>u</i> switch is used on non-active book, then it will first be activated before del, as only active book supports undo.</li></ul>
<p><br />
To delete the last sheet/layer in current window, generally you can use <a href="../../LabTalk/LabTalk/Page_(object).html#Properties:Page_Property" title="LabTalk:Page (object)">page.nlayers</a> to get the index of last layer/sheet:
</p>
<pre class="lt" style="font-family:monospace;">layer <span style="color: #000080;">-</span>d <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>page.<span style="color: #000080;">nlayers</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//page.nlayers is the number of sheets/layers in current page and also the index of the last sheet/layer.</span></pre>
<p>Since Origin 2021b, you can easily use <i>0</i> to specify the last sheet/layer, 
</p>
<pre class="lt" style="font-family:monospace;">layer <span style="color: #000080;">-</span>d <span style="color: #0000dd;">0</span>;</pre>
<h2><a name="-dk"></a><span class="mw-headline">-dk</span></h2>
<p><b>Syntax:</b> layer <b>-dk</b>
</p><p>Delete the active layer. The book is kept undeleted.
</p><p>This will delete the active layer from the active book and keep the book even if all sheets are deleted.
</p>
<h2><a name="-f"></a><span class="mw-headline">-f</span></h2>
<p><b>Syntax:</b> layer <b>-f</b>
</p><p>Duplicate a worksheet or matrixsheet.
</p>
<h2><a name="-h"></a><span class="mw-headline">-h</span></h2>
<p><b>Syntax:</b> layer <b>-h</b> <i>value</i>
</p><p>Hide or Show the layer. If <i>value</i> = 1, hide the layer. If <i>value</i> = 0, show the layer. This command does not automatically refresh the window display.
</p>
<h2><a name="-m"></a><span class="mw-headline">-m</span></h2>
<p><b>Syntax:</b> layer <b>-m</b>
</p><p>Open the Layer Clipping Margins dialog box for the active layer.
</p>
<h2><a name="-o"></a><span class="mw-headline">-o</span></h2>
<p><b>Syntax:</b> layer <b>-o</b> <i>layerNumber / layerName {script}</i>
</p><p>Execute (operate) the specified <i>script</i> for the specified layer.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Paste the current time on layer 2 of graph1</span>
layer <span style="color: #000080;">-</span>o <span style="color: #000000;">&#91;</span>graph1<span style="color: #000000;">&#93;</span><span style="color: #0000dd;">2</span> <span style="color: #000000;">&#123;</span>label <span style="color: #000080;">-</span>s <span style="color: #000080;">-</span>t <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>@D, D10<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#125;</span>

<span style="color: #008000;">// Fill data to column B on specified sheet</span>
newbook sheet<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span> result<span style="color: #000000;">:</span><span style="color: #000080;">=</span>bn<span style="color: #000080;">$</span>;
layer <span style="color: #000080;">-</span>o <span style="color: #000000;">&#91;</span>bn<span style="color: #000080;">$</span><span style="color: #000000;">&#93;</span>Sheet2 <span style="color: #000000;">&#123;</span>
	col<span style="color: #000000;">&#40;</span>b<span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>data<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">10</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span>;</pre>
<h2><a name="-s"></a><span class="mw-headline">-s</span></h2>
<p>Syntax: layer <b>-s</b> <i>n</i>
</p><p>Select the active layer in the active window.  The integer <i>n</i> specifies the layer number.  You can also set (and get) the active layer number using the <b><a href="../../LabTalk/LabTalk/Page_(object).html" title="LabTalk:Page (object)">page.active</a></b> object property.
</p><p><b>Example:</b>
</p><p>Given three layers, the following script sizes each layer to 20% of the page width and 80% of the page height. It arranges the layers 10% from the top of the page, starting at 8% in from the left, and separated by 12% of the full page.
</p>
<pre class="lt" style="font-family:monospace;">width <span style="color: #000080;">=</span> <span style="color: #0000dd;">20</span>;
height <span style="color: #000080;">=</span> <span style="color: #0000dd;">80</span>;
for <span style="color: #000000;">&#40;</span>ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; ii <span style="color: #000080;">&lt;=</span> <span style="color: #0000dd;">3</span>; ii<span style="color: #000080;">++</span><span style="color: #000000;">&#41;</span> 
      <span style="color: #000000;">&#123;</span>
            layer <span style="color: #000080;">-</span>s ii;
            layer width height <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">8</span><span style="color: #000080;">+</span><span style="color: #000000;">&#40;</span>ii<span style="color: #000080;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">*</span><span style="color: #000000;">&#40;</span>width<span style="color: #000080;">+</span><span style="color: #0000dd;">12</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span> <span style="color: #0000dd;">10</span>;
      <span style="color: #000000;">&#125;</span>;</pre>
<h2><a name="-tm"></a><span class="mw-headline">-tm</span></h2>
<p><b>Syntax:</b> layer <b>-tm <i>nrow</i> <i>ncol</i> bLabel</b>
</p><p>Return merged cell range:<br />
If cell at <i><b>nrow</b></i> and <i><b>ncol</b></i> is within a merged group of cells, the column and row range of the cells is returned (e.g. "cell merged range c1=1 c2=2 r1=4 r2=6").
</p>





