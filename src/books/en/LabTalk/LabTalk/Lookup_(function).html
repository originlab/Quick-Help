<h1 class="firstHeading">3.5.8.14 Lookup</h1><p class='urlname' style='display: none'>Lookup-func</p>
<p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1"><a href="#Syntax"><span class="tocnumber">2</span> <span class="toctext">Syntax</span></a></li>
<li class="toclevel-1"><a href="#Parameters"><span class="tocnumber">3</span> <span class="toctext">Parameters</span></a></li>
<li class="toclevel-1"><a href="#Return"><span class="tocnumber">4</span> <span class="toctext">Return</span></a></li>
<li class="toclevel-1"><a href="#Example"><span class="tocnumber">5</span> <span class="toctext">Example</span></a></li>
</ul>
</div>

<h2 class="ref"><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>This function searches for a string pattern <b>str</b> within a vector <b>vs</b> and, if found, returns a value from vector <b>vref</b> with the same index. Vector <b>vref</b> may be contain numeric or string values. By default, the function searches <b>vs</b> for the full string (<b>option</b> = 2). If no match if found and <b>vref</b> is numeric, the function returns a missing value ("--"); when <b>vref</b> contains strings, an empty string is returned.
</p><p>The function will return the closest match, using <b>option</b> =0 or =1, but <b>Lookup()</b> does not support wildcard characters. 
</p><p>This function also searches for a numeric value <b>dd</b> within a vector <b>vd</b> and, returns a value from vector <b>vref</b> with the same index. By default, the function seaches <b>vd</b> for the closest value (<b>option</b> = 2). If <b>option</b> = 0, it searchs for the closest value smaller than <b>dd</b>. If <b>option</b> = 1, it searchs for the closest value larger than <b>dd</b>. 
</p>
<h2 class="ref"><a name="Syntax"></a><span class="mw-headline">Syntax</span></h2>
<p>If <b>vref</b> contains numeric values,
</p>
<pre class="lt" style="font-family:monospace;"> double Lookup<span style="color: #000000;">&#40;</span>string str<span style="color: #000080;">$</span>, vector<span style="color: #000080;">&lt;</span>string<span style="color: #000080;">&gt;</span> vs, vector vref<span style="color: #000000;">&#91;</span>, int option, int Case<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span></pre>
<p>If <b>vref</b> contains string values,
</p>
<pre class="lt" style="font-family:monospace;"> string Lookup<span style="color: #000000;">&#40;</span>string str<span style="color: #000080;">$</span>, vector<span style="color: #000080;">&lt;</span>string<span style="color: #000080;">&gt;</span> vs, vector<span style="color: #000080;">&lt;</span>string<span style="color: #000080;">&gt;</span> vref<span style="color: #000000;">&#91;</span>, int option, int Case<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">$</span></pre>
<p>If search a numeric vector <b>vd</b>,
</p>
<pre class="lt" style="font-family:monospace;"> double Lookup<span style="color: #000000;">&#40;</span>double dd, vector vd, vector vref<span style="color: #000000;">&#91;</span>, int option, int Case<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span></pre>
<h2 class="ref"><a name="Parameters"></a><span class="mw-headline">Parameters</span></h2>
<p><b>str</b>
</p>
<dl><dd>is the string pattern to find in vector <b>vs</b>.</dd></dl>
<p><b>vs</b> 
</p>
<dl><dd>is the vector in which string pattern <b>str</b> is looked up. </dd></dl>
<p><b>dd</b>
</p>
<dl><dd>is the double value to find in vector <b>vd</b>.</dd></dl>
<p><b>vd</b>
</p>
<dl><dd>is the vector in which value <b>dd</b> is looked up.</dd></dl>
<p><b>vref</b>
</p>
<dl><dd>is the reference vector whose <i>n</i>th value will be returned. <i>n</i> is the index of string <b>str</b> within vector <b>vs</b>.</dd></dl>
<p><b>option</b>
</p>
<dl><dd>[optional] integer that specifies how the string is matched:
<ul><li> option = 2 (default), searches for a string that fully matches (see <b>Case</b>). </li>
<li> option = 0, vector <b>vs</b> is sorted in increasing order. If <b>str</b> is not found, the function will get the index of the nearest value smaller than <b>str</b>.</li>
<li> option = 1, vector <b>vs</b> is sorted in decreasing order. If <b>str</b> is not found, the function will get the index of the nearest value larger than <b>str</b>.</li></ul></dd></dl>
<p><b>Case</b>
</p>
<dl><dd>[optional] integer that specifies whether the search is case sensitive. 
<ul><li> case = 0 (default), the search is not case-sensitive.</li>
<li> case = 1, the search is case-sensitive.</li></ul></dd></dl>
<h2 class="ref"><a name="Return"></a><span class="mw-headline">Return</span></h2>
<p>If <b>str</b> is found in <b>vs</b>, returns a value in vector <b>vref</b> of the same row index.
</p><p>If <b>option</b> = 2, and <b>str</b> is not found, returns an empty string or missing value.
</p><p>If <b>option</b> = 0 and <b>str</b> is not found, returns the value corresponding to the nearest smaller value of <b>str</b>. If no smaller value of <b>str</b> exists, returns missing value (numeric) or empty string (string).
</p><p>If <b>option</b> = 1 and <b>str</b> is not found, returns the value corresponding to the nearest larger value of <b>str</b>. If no larger value of <b>str</b> exists, returns missing value (numeric) or empty string (string).
</p>
<h2 class="ref"><a name="Example"></a><span class="mw-headline">Example</span></h2>
<pre class="lt" style="font-family:monospace;">range aa<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span>col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span>;
range bb<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span>col<span style="color: #000000;">&#40;</span>B<span style="color: #000000;">&#41;</span>;
string str1<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Lookup<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;FSA&quot;</span>, aa, bb<span style="color: #000000;">&#41;</span><span style="color: #000080;">$</span>;
str1<span style="color: #000080;">$</span><span style="color: #000080;">=</span>;</pre>






