<h1 class="firstHeading">3.9.4 Last Used System Variables</h1><p class='urlname' style='display: none'>Last-Used-System-vars</p>
<p><span class="OIndex" style="display:none">System Variable</span><span class="OIndex" style="display:none">System Variable, Last Used</span><span class="OIndex" style="display:none">Last Used System Variable</span>Origin helps you keep track of the last used value of many objects in the project---such as the last LabTalk command issued, the last X-Function called, or the last Worksheet referenced---by automatically storing their values in <a href="../../LabTalk/LabTalk/Data_Types_and_Variables.html#String" title="LabTalk:Data Types and Variables">string variables</a>, and updating them appropriately as actions are carried out within the project.  
</p><p>To distinguish these variables from other types of string variables, a double-underscore is added to the beginning of the variable name (i.e., __REPORT$).  Issue the <a href="../../LabTalk/LabTalk/List_(command).html#vs.3B_List_all_string_variables" title="LabTalk:List (command)"><b>list vs</b> command</a> to see those active in your current project. 
</p><p>Like all string variables, their names should be followed by a dollar-sign, <b>$</b>, when accessing them.  As system variables, you should not attempt to assign a value to them (that is, treat them as READ ONLY).  
</p><p>The following table lists the most common variable names of this automatically-generated variety, their content type, an example of use, and a brief description of their content.  Keep in mind that these variables hold <i>most recent</i> values and are, therefore, constantly updated. 
<br /><br />
</p>
<table class="simple">
<tr>
<th> Name
</th>
<th> Content
</th>
<th> Example
</th>
<th> Description
</th></tr>
<tr>
<td> __FINDDEP$
</td>
<td> Worksheet Name
</td>
<td> [Sample]FindYfromX!
</td>
<td> Most recent Find Y from X table
</td></tr>
<tr>
<td> __FINDINDEP$
</td>
<td> Worksheet Name
</td>
<td> [Sample]FindXfromY!
</td>
<td> Most recent Find X from Y table
</td></tr>
<tr>
<td> __FITCURVE$
</td>
<td> Worksheet Name
</td>
<td> [Sample]FitNLCurve!
</td>
<td> Most recent fitted data
</td></tr>
<tr>
<td> __HEADER$
</td>
<td> String
</td>
<td> "ExponentialBaseline.dat"
</td>
<td> Last ASCII import file header string
</td></tr>
<tr>
<td> __LASTLTCMD$
<p align="right"><font color="red">(8.51 SR1)</font></p>
</td>
<td> Command
</td>
<td>&#160;%A=%A of&#160;%W&#160;%N
</td>
<td> Last LabTalk command issued
</td></tr>
<tr>
<td> __LASTMATRIX$
</td>
<td> MatrixBook name
</td>
<td> MBook1
</td>
<td> Last active matrixbook
</td></tr>
<tr>
<td> __LASTOGS$
</td>
<td> OGS file name
</td>
<td> D:\User Files Folder\Custom.ogs
</td>
<td> Last executed OGS file
</td></tr>
<tr>
<td> __LASTWKS$
</td>
<td> Workbook name
</td>
<td> Book1
</td>
<td> Last workbook referenced
</td></tr>
<tr>
<td> __NLDATA$
</td>
<td> Column or dataset name
</td>
<td> [Book1]Sheet1!2
</td>
<td> Non-Linear Fitter input data range
</td></tr>
<tr>
<td> __PAINTEGPEAK$
</td>
<td> Worksheet name
</td>
<td> [Book2]Integration_Result1!
</td>
<td> Peak Analyzer's peak-integration sheet
</td></tr>
<tr>
<td> __PAINTEGCURVE$
</td>
<td> Worksheet name
</td>
<td> [Book2]Integrated_Curve_Data1!
</td>
<td> Peak Analyzer's integrated curve data sheet
</td></tr>
<tr>
<td> __PABASELINE$
</td>
<td> Worksheet name
</td>
<td> [Book1]Sheet1!
</td>
<td> Peak Analyzer's baseline data sheet
</td></tr>
<tr>
<td> __PASUBTRACTED$
</td>
<td> Worksheet name
</td>
<td> [Book1]Sheet2!
</td>
<td> Peak Analyzer's subtracted curve data sheet
</td></tr>
<tr>
<td> __PAPEAKCENTER$
</td>
<td> Worksheet name
</td>
<td> [Book1]Sheet3!
</td>
<td> Peak Analyzer's peak-center data sheet
</td></tr>
<tr>
<td> __PEAK$
</td>
<td> Worksheet Name
</td>
<td> [Sample]PeakProperties!
</td>
<td> Most recent peak properties data
</td></tr>
<tr>
<td> __REPORT$
</td>
<td> Worksheet Name
</td>
<td> [Sample]FitNL!
</td>
<td> Last report sheet generated
</td></tr>
<tr>
<td> __RESIDUAL$
</td>
<td> Worksheet Name
</td>
<td> [Sample]FitNLCurve!
</td>
<td> Most recent residuals from fitting
</td></tr>
<tr>
<td> __SUBHEADER$
</td>
<td> String
</td>
<td> "Channel  Amplitude"
</td>
<td> Last ASCII import file subheader string
</td></tr>
<tr>
<td> __XF$
</td>
<td> X-Function Name
</td>
<td> impASC
</td>
<td> Last X-Function called
</td></tr></table>
<p>These strings are useful for further analysis.  For example, the following script assigns the location of the most recently generated fit curve to a range variable, which is then integrated to find the area under the fit curve:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Access Column 2 of the Worksheet storing the fit data</span>
range rd <span style="color: #000080;">=</span> <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>__FITCURVE<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span><span style="color: #0000dd;">2</span>; 
<span style="color: #008000;">// Integrate under the fit curve</span>
integ rd;
<span style="color: #008000;">// Display the area under the curve </span>
integ.<span style="color: #000080;">area</span><span style="color: #000080;">=</span>;</pre>






