<h1 class="firstHeading">3.3.2.25 GetPts</h1><p class='urlname' style='display: none'>GetPts-cmd</p>
<p>This command uses a Tools toolbar tool to get dataset values of the active dataset from the current graph window.
</p><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Syntax:"><span class="tocnumber">1</span> <span class="toctext">Syntax:</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Options:"><span class="tocnumber">2</span> <span class="toctext">Options:</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#no_option.3B_Get_npts_by_Data_Reader_tool"><span class="tocnumber">2.1</span> <span class="toctext">no option; Get <i>npts</i> by Data Reader tool</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#-a_npts_.5Bmessage.5D.3B_Get_the_XY_coordinate_value_by_Screen_Reader"><span class="tocnumber">2.2</span> <span class="toctext">-a <i>npts [message]</i>; Get the XY coordinate value by Screen Reader</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#-n_dataset_npts_.5Bmessage.5D.3B_Plot_each_point_up_and_including_npts.2Cand_put_successive_XY_value"><span class="tocnumber">2.3</span> <span class="toctext">-n <i>dataset npts [message]</i>; Plot each point up and including <i>npts</i>,and put successive XY value</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#-x_npts_.5Bmessage.5D.3B_Get_the_XY_coordinate_value_of_points"><span class="tocnumber">2.4</span> <span class="toctext">-x <i>npts [message]</i>; Get the XY coordinate value of points</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#-Y_npts_.5Bmessage.5D.3B_Get_the_XY_coordinate_value_of_points"><span class="tocnumber">2.5</span> <span class="toctext">-Y <i>npts [message]</i>; Get the XY coordinate value of points</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8"><a href="#Examples:"><span class="tocnumber">3</span> <span class="toctext">Examples:</span></a></li>
</ul>
</div>

<h2><a name="Syntax:"></a><span class="mw-headline"><font color="chocolate">Syntax:</font></span></h2>
<pre class="lt" style="font-family:monospace;">getpts <span style="color: #000000;">&#91;</span>options<span style="color: #000000;">&#93;</span> npts <span style="color: #000000;">&#91;</span><span style="color: #000000;">&#40;</span>message<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#93;</span></pre>
<p>The option determines which tool is used. Variables are stored in properties of the getpts object. Once a tool is selected, the PointProc macro is executed when the user double-clicks or presses ENTER.When <i>npts</i> is reached, the EndToolbox macro is executed.If another Tools toolbar tool is selected before <i>npts</i> is reached, the QuitToolbox macro is executed.
</p><p><br />
The message help text appears in the status bar.<i>Message</i> is not sent to the substitution processor for string substitution until PointProc is executed.  This means that your message text can contain real-time information.
</p><p>For a detailed discussion of the <span class="cmd">getpts</span> command, see the Notes and Examples sections that follow.
</p><p><b>Note on the <span class="cmd">getpts</span> command</b>
</p><p>The <span class="cmd">getpts</span> command behaves differently than the other <span class="cmd">'get'</span> commands.  For example, with the <span class="cmd">getnumber</span> command, first a dialog box opens and then the user makes a selection in that dialog box.  Any script after the <span class="cmd">getnumber</span> command is not executed until the user makes a selection.  This allows your script to take different routes depending on the user's selection.  However, after the <span class="cmd">getpts</span> command is executed, the next LabTalk statements are executed without waiting for any user input. 
</p><p>The <span class="cmd">getpts</span> command can be used in script when it is necessary for the user to pick points on their graph, and then perform some custom analysis.  If you use the <span class="cmd">getpts</span> command incorrectly, your script could complete before the user actually picks a point on their graph.  To avoid this problem and to help you understand the <span class="cmd">getpts</span> command, review the following information. 
</p><p>When using the <span class="cmd">getpts</span> command, data is entered by:
</p>
<ul><li>Double-clicking on a data point in the graph.</li></ul>
<ul><li>Clicking on a data point in the graph and then pressing ENTER.</li></ul>
<h2><a name="Options:"></a><span class="mw-headline"><font color="chocolate">Options:</font></span></h2>
<h3><a name="no_option.3B_Get_npts_by_Data_Reader_tool"></a><span class="mw-headline">no option; Get <i>npts</i> by Data Reader tool</span></h3>
<p><b>Syntax:</b> getpts <b>no option</b>
</p><p>Use the Data Reader tool to get <i>npts</i> from the dataset the user clicks on.Values are read into the following <a href="../../LabTalk/LabTalk/GetPts_(object).html" title="LabTalk:GetPts (object)">getpts</a> object properties:
</p><p>getpts.count -- Contains the number of selected points. 
</p><p>getpts.data$ -- Dataset name.
</p><p>getpts.xdata -- Dataset that holds each successive X position value.
</p><p>getpts.indexdata -- Dataset that holds the index value of each successive data point that is double-clicked.
</p>
<h3><a name="-a_npts_.5Bmessage.5D.3B_Get_the_XY_coordinate_value_by_Screen_Reader"></a><span class="mw-headline">-a <i>npts [message]</i>; Get the XY coordinate value by Screen Reader</span></h3>
<p><b>Syntax:</b> getpts <b>-a</b> <i>npts [message]</i>
</p><p>Use the Screen Reader tool to get the XY coordinate value of points in a graph window.Values are read into the getpts object properties.
</p>
<h3><a name="-n_dataset_npts_.5Bmessage.5D.3B_Plot_each_point_up_and_including_npts.2Cand_put_successive_XY_value"></a><span class="mw-headline">-n <i>dataset npts [message]</i>; Plot each point up and including <i>npts</i>,and put successive XY value</span></h3>
<p><b>Syntax:</b> getpts <b>-n</b> <i>dataset npts [message]</i> 
</p><p>Plot each point up to and including <i>npts</i>, and put each successive XY value into <i>dataset</i>.<i>Dataset</i> must already exist before you can use this option.
</p>
<h3><a name="-x_npts_.5Bmessage.5D.3B_Get_the_XY_coordinate_value_of_points"></a><span class="mw-headline">-x <i>npts [message]</i>; Get the XY coordinate value of points</span></h3>
<p><b>Syntax:</b> getpts <b>-x</b> <i>npts [message]</i>
</p><p>Use the Screen Reader tool to get the XY coordinate value of points in a graph window.  Restrict cursor movement to horizontal.Values are read into the getpts object properties.
</p>
<h3><a name="-Y_npts_.5Bmessage.5D.3B_Get_the_XY_coordinate_value_of_points"></a><span class="mw-headline">-Y <i>npts [message]</i>; Get the XY coordinate value of points</span></h3>
<p><b>Syntax:</b> getpts <b>-y</b> <i>npts [message]</i>
</p><p>Use the Screen Reader tool to get the XY coordinate value of points in a graph window.  Restrict cursor movement to vertical.Values are read into the getpts object properties.
</p>
<h2><a name="Examples:"></a><span class="mw-headline"><font color="chocolate">Examples:</font></span></h2>
<p>The <span class="cmd">getpts</span> command works as follows:
</p><p>First, the getpts.count object property is set to zero.  Next, the getpts.max object property is set to the number of requested points.  Lastly, the <span class="cmd">getpts</span> command runs the script in the [GetPtsNoDraw] section of the ORIGIN.OGS file.  
</p><p>The [GetPtsNoDraw] section of the file performs the following: 
</p>
<ol><li>Sets the dataset name for X position to _xpos. </li>
<li>Sets the dataset name for row index to _indx.</li>
<li>Sets the dataset name for reading points to the active dataset.</li>
<li>Creates the datasets (if needed) for X position and row index.</li>
<li>Defines the pointproc macro as follows: </li></ol>
<pre class="lt" style="font-family:monospace;">def PointProc
<span style="color: #000000;">&#123;</span>
      #<span style="color: #000080;">!</span>type click;
      <span style="color: #000080;">%</span>B <span style="color: #000080;">=</span> getpts.<span style="color: #000080;">xData</span><span style="color: #000080;">$</span>;
      <span style="color: #000080;">%</span>B<span style="color: #000000;">&#91;</span>getpts.<span style="color: #000080;">count</span><span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> x;
      <span style="color: #000080;">%</span>B <span style="color: #000080;">=</span> getpts.<span style="color: #000080;">indexData</span><span style="color: #000080;">$</span>;
      <span style="color: #000080;">%</span>B<span style="color: #000000;">&#91;</span>getpts.<span style="color: #000080;">count</span><span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> index;
      if <span style="color: #000000;">&#40;</span>getpts.<span style="color: #000080;">count</span> <span style="color: #000080;">&gt;=</span> getpts.<span style="color: #000080;">max</span><span style="color: #000000;">&#41;</span>
            <span style="color: #000000;">&#123;</span>
                  type end toolbox;
                  <span style="color: #000000;">&#123;</span>EndToolbox<span style="color: #000000;">&#125;</span>;
                  doTool <span style="color: #0000dd;">0</span>;
            <span style="color: #000000;">&#125;</span>
      else 
            doTool <span style="color: #000080;">-</span>next;
<span style="color: #000000;">&#125;</span>;</pre>
<p>The pointproc macro executes each time the user selects a data point - either by double-clicking on the point, or single-clicking and pressing ENTER.  Once the points are selected, Origin internally traps the selection, sets X to the selected X position and index to the row for this X value, and increments the getpts.count object property.  Then, the pointproc macro executes.  In this case, this causes the X value and row index to be added to the appropriate datasets.  The macro then tests to see if the getpts.count object value is greater than or equal to getpts.max.  If getpts.count is greater than getpts.max, then the endtoolbox macro executes and the cursor is switched back to a pointer (dotool 0). 
</p><p>The endtoolbox macro is normally not defined by Origin.  It is available so that you can define it to perform a custom routine.  For example, if your script prompts the user to pick points on the graph, and then the script performs some custom analysis, you could define the endtoolbox macro to set a data range for analysis using the Data Selector tool.  This tool sets the mks1 and mks2 variables to a row index which defines a region for analysis routines.  In such an example, you can define the endtoolbox macro to set these markers based on the information gathered by the getpts command, and then execute a command that both carries out an integration (or other analysis) and types the results to the Script window: 
</p>
<pre class="lt" style="font-family:monospace;">def EndToolBox <span style="color: #000000;">&#123;</span>
mks1 <span style="color: #000080;">=</span> _indx<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span>;
mks2 <span style="color: #000080;">=</span> _indx<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#93;</span>;
integrate <span style="color: #000080;">%</span>C;
type <span style="color: #000080;">-</span>a <span style="color: #ff00ff;">&quot;The Area under&#160;%C from $(_xpos[1])-$(_xpos[2]) is $(INTEG.AREA).&quot;</span>;
<span style="color: #000000;">&#125;</span>;</pre>
<p>In this macro definition, the integrate command puts its results in the integ object.  In particular, the calculated area is in the integ.area property.  Note that&#160;%C contains the active dataset name and the $() notation is used to evaluate a variable or expression and interpret the result as a string. 
</p><p>To test the getpts command with the endtoolbox macro, perform the following:
</p>
<ol><li>Plot some sample data.</li>
<li>Open the Script window and turn off script execution (Edit:Script Execution). </li>
<li>Type the endtoolbox macro definition into the Script window.</li>
<li>Type the following in the Script window:<br />getpts 2;</li>
<li>Turn script execution back on by reselecting Edit:Script Execution. </li>
<li>Highlight all the lines of script and press ENTER to execute the entire script.  </li></ol>
<p>The endtoolbox macro gets defined and getpts begins - allowing you (or the user) to select two points on the graph to mark a particular region.  The actual analysis is held off until getpts is done - which triggers the endtoolbox routine embedded in the pointproc macro.  When the last point is selected, the endtoolbox macro finally runs and the area is calculated with the results typed to the Script window.
</p><p>Redefining the Pointproc Macro
</p><p>Because the pointproc macro executes whenever the user selects a data point or a screen location, you can customize the pointproc macro to meet your specific application needs.  In the following script example, the user selects a data point on a graph, and then selects a location to display the X and Y coordinates of the selected data point.  For this example, you must first plot some data.  Then, with the graph window active, run the following script from the Script window:
</p>
<pre class="lt" style="font-family:monospace;">def pointproc <span style="color: #000000;">&#123;</span>
xx1<span style="color: #000080;">=</span>x;
yy1<span style="color: #000080;">=</span>y;
dotool <span style="color: #0000dd;">0</span>;
def pointproc <span style="color: #000000;">&#123;</span>
label <span style="color: #000080;">-</span>s <span style="color: #000080;">-</span>j <span style="color: #0000dd;">1</span> <span style="color: #000080;">-</span>a x y <span style="color: #ff00ff;">&quot;($(xx1),$(yy1))&quot;</span>;
dotool <span style="color: #0000dd;">0</span>;
<span style="color: #000000;">&#125;</span>;
dotool <span style="color: #0000dd;">2</span>;
<span style="color: #000000;">&#125;</span>;
dotool <span style="color: #0000dd;">3</span>;</pre>
<p>This script works as follows:  
</p>
<ol><li>First the pointproc macro is defined.  </li>
<li>After the macro definition (which includes a redefinition of pointproc), the Data Selector tool is activated (dotool 3).  </li>
<li>When the Data Selector tool is active, the user selects a data point (for example, a peak position).  </li>
<li>After selecting the data point, the pointproc macro runs (by default). </li>
<li>The pointproc macro assigns the X and Y values of the selected data point to the two variables (xx1 and yy1).</li>
<li>The pointproc macro temporarily makes the Pointer tool active, and then redefines the pointproc macro.  </li>
<li>The Screen Reader tool is activated (dotool 2).  </li>
<li>While the Screen Reader tool is active, the user selects a screen location for the data point label.</li>
<li>After selecting the location, by default the pointproc macro runs again (the second definition of it).  This results in a label displaying on the graph at the specified location.</li>
<li>The Pointer tool is reactivated.</li></ol>






