<h1 class="firstHeading">2.4.1.3 X-Function Execution Options</h1><p class='urlname' style='display: none'>XF-Execution-Options</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#X-Function_Option_SwitchesX-Function.2C_option_switch"><span class="tocnumber">1</span> <span class="toctext">X-Function Option Switches<span class="OIndex" style="display:none">X-Function, option switch</span></span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Examples"><span class="tocnumber">2</span> <span class="toctext">Examples</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Open_X-Function_DialogOpen_X-Function_DialogX-Function.2C_open_dialog"><span class="tocnumber">2.1</span> <span class="toctext">Open X-Function Dialog<span class="OIndex" style="display:none">Open X-Function Dialog</span><span class="OIndex" style="display:none">X-Function, open dialog</span></span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Using_a_Theme"><span class="tocnumber">2.2</span> <span class="toctext">Using a Theme</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Setting_Recalculate_Mode"><span class="tocnumber">2.3</span> <span class="toctext">Setting Recalculate Mode</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Open_X-Function_Builder"><span class="tocnumber">2.4</span> <span class="toctext">Open X-Function Builder</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Copy_Format_from_Input_to_Output"><span class="tocnumber">2.5</span> <span class="toctext">Copy Format from Input to Output</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Undo_the_Operation"><span class="tocnumber">2.6</span> <span class="toctext">Undo the Operation</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="X-Function_Option_SwitchesX-Function.2C_option_switch"></a><span class="mw-headline">X-Function Option Switches<span class="OIndex" style="display:none">X-Function, option switch</span></span></h2>
<p>The following <span class="OIndex">option switch</span><span class="OIndex HasShownIndex" style="display:none">switch</span>es are useful when accessing X-Functions from script:
</p>
<table class="simple">
<tr>
<th width="140"> Switch
</th>
<th width="90"> Full Name
</th>
<th> Function
</th></tr>
<tr>
<td> -cf
</td>
<td> --
</td>
<td> Copy column format of the input range, and apply it to the output range.
</td></tr>
<tr>
<td> -d
</td>
<td> -dialog
</td>
<td> Brings up a dialog to set X-Function parameters and generate script.
</td></tr>
<tr>
<td> -db
</td>
<td> --
</td>
<td> Variation of dialog; Brings up the X-Function dialog as a panel in the current window.
</td></tr>
<tr>
<td> -dc <i>IsCancel</i>
</td>
<td> --
</td>
<td> Variation of dialog; Brings up a dialog to select X-Function parameters. Set <i>IsCancel</i> to 0 if click the <b>OK</b> button, set to 1 if click the <b>Cancel</b> button. When clicking the <b>Cancel</b> button, no error message like <b>#User Abort!</b> dumps to Script Window and the script after X-Function can be executed.
</td></tr>
<tr>
<td> -e
</td>
<td> --
</td>
<td> Open the X-Function in the X-Function Builder. This works the same as the <a href="../../LabTalk/LabTalk/Edit_(command).html#-x.3B_Open_an_X-Function_in_X-Function_Builder" title="LabTalk:Edit (command)">edit -x</a> command.
</td></tr>
<tr>
<td> -h
</td>
<td> -help
</td>
<td> Prints the contents of the help file to the Script window.
</td></tr>
<tr>
<td> -he
</td>
<td> --
</td>
<td> Prints the contents of script example to the Script window.
</td></tr>
<tr>
<td> -hn
</td>
<td> --
</td>
<td> Loads and compiles the X-Function without doing anything else. If the X-Function has already been compiled and loaded, it will do nothing.
</td></tr>
<tr>
<td> -hs
</td>
<td> --
</td>
<td> Variation of -h; Prints only the Script Usage Examples.
</td></tr>
<tr>
<td> -ht
</td>
<td> --
</td>
<td> Variation of -h; Prints only the Treenode information, if any exists.
</td></tr>
<tr>
<td> -hv
</td>
<td> --
</td>
<td> Variation of -h; Prints only the Variable list.
</td></tr>
<tr>
<td> -hx
</td>
<td> --
</td>
<td> Variation of -h; Prints only the related X-Function information.
</td></tr>
<tr>
<td> -r &lt;option&gt;
</td>
<td> -recalculate
</td>
<td> Specify the recalculation mode: 0 = none; 1 = auto; 2 = manual:<a href="#Setting_Recalculate_Mode">Example</a>. Recalculate is not supported when output is the same as &lt;input&gt;.
</td></tr>
<tr>
<td> -s
</td>
<td> -silent
</td>
<td> Runs in silent mode; results are not sent to Results log.
</td></tr>
<tr>
<td> -sb
</td>
<td> --
</td>
<td> Variation of -s; suppresses error messages and Results log output.
</td></tr>
<tr>
<td> -se
</td>
<td> --
</td>
<td> Variation of -s; suppresses error messages, does not suppress Results log output.
</td></tr>
<tr>
<td> -sl
</td>
<td> -silent
</td>
<td> Same as -s.
</td></tr>
<tr>
<td> -sr
<p><font color="red">(Origin 2016 SR1)</font>
</p>
</td>
<td> --
</td>
<td> Variation of -s; suppresses result messages to the script window.
</td></tr>
<tr>
<td> -ss
</td>
<td> --
</td>
<td> Variation of -s; suppresses info messages to the script window.
</td></tr>
<tr>
<td> -sw
<p><font color="red">(Origin 2016 SR1)</font>
</p>
</td>
<td> --
</td>
<td> Variation of -s; suppresses warning messages to the script window.
</td></tr>
<tr>
<td> -t &lt;<i>Name</i>&gt;
</td>
<td> -theme
</td>
<td> Uses the designated preset theme.
</td></tr>
<tr>
<td> -u
<p><font color="red">(Origin 2024b)</font>
</p>
</td>
<td> -undo
</td>
<td> Specify whether the operation can be undone when running from script.
</td></tr></table>
<p><br />
For options with an existing <b>Full Name</b>, either the shortened switch name or the full name may be used in script.  For instance, for the X-Function <b>smooth</b>,
</p>
<pre class="lt" style="font-family:monospace;">smooth <span style="color: #000080;">-</span>h</pre>
<p>is the same as 
</p>
<pre class="lt" style="font-family:monospace;">smooth <span style="color: #000080;">-</span>help</pre>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<h3><a name="Open_X-Function_DialogOpen_X-Function_DialogX-Function.2C_open_dialog"></a><span class="mw-headline">Open X-Function Dialog<span class="OIndex" style="display:none">Open X-Function Dialog</span><span class="OIndex" style="display:none">X-Function, open dialog</span></span></h3>
<p>Use <b>-d</b> switch to open X-Function dialog so that user can inter interactively supply input and parameters
</p><p>The following script fills column 1 &amp; 2 with data,  use the -d switch to open the <a class="external text" href="../../XFunction/X-Function/Smooth.html">smooth</a> X-Function dialog, where user can preview result, adjust settings, etc. Upon clicking OK, the script will continue to plot column 2 and 3 as line graph. 
</p>
<pre class="lt" style="font-family:monospace;">col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>data<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">100</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//fill column 1 with row numbers.</span>
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>normal<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">100</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//fill column 2 with normalized data</span>
<span style="color: #008000;">//open dialog with input, method and number of points loaded. </span>
<span style="color: #008000;">//Play with settings in the dialog and click OK</span>
smooth <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> method<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span> npts<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">25</span> <span style="color: #000080;">-</span>d; 
<span style="color: #008000;">//plot Y columns (column 2 and 3) against X column in sheet (column 1) as line graph</span>
plotxy <span style="color: #000000;">&#40;</span>?,<span style="color: #0000dd;">2</span><span style="color: #000000;">:</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span> p<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">200</span>;</pre>
<h3><a name="Using_a_Theme"></a><span class="mw-headline">Using a Theme</span></h3>
<p>Use the <b>-t</b> switch to execute the x-function with saved dialog theme. Dialog theme is basically the settings of X-Function dialog, parameters and output. Usually input is excluded in theme file.
</p><p>The following steps shows how to save a dialog theme file and then use the -t switch to use it.
</p>
<ol>
<li> Select column 2 created after above script. Run the following script to open smooth dialog. Or u can choose <b>Analysis: Signal Processing: Smoothing: Open dialog...</b> menu
<pre class="lt" style="font-family:monospace;">smooth <span style="color: #000080;">-</span>d;</pre>
<li>Set the <b>Method</b> as <b>Adjacent-Averaging</b> and <b>Points of Window</b> as <b>5</b>. 
<li>Click the <b>&gt;</b> button next to <b>Dialog Theme</b> on the top and choose <b>Save As...</b>. Save the dialog settings as <b>FivePtAdjAve</b>.
<li>Cancel the dialog.
<li> Activate the workbook with data in previous script.
<li> Run the X-Function with -t switch to perform a smoothing with XY data in column 1 and 2 using the <span class="OIndex">theme</span> named <b>FivePtAdjAve</b>, which means <b>Method</b> as <b>Adjacent-Averaging</b> and <b>Points of Window</b> as <b>5</b>

<pre class="lt" style="font-family:monospace;">smooth <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">-</span>t FivePtAdjAve;</pre>
</ol>
<p><b>Note</b>: No need to specify the theme file path since Origin automatically saves and retrieves your themes from <i>User Files\Themes\AnalysisAndReportTable\</i>. You can share the theme file with others. They can drag and drop the theme file into Origin workspace to install it. Themes saved in one project (*.OPJ) will be available for use in other projects as well. <b>Start from Origin 2024, Origin will first look for your themes from current project folder. If not found, then from User File Folder. </b>
</p>
<h3><a name="Setting_Recalculate_Mode"></a><span class="mw-headline">Setting Recalculate Mode</span></h3>
<p>Use the <b>-r</b> switch to set recalculation mode of output. 
</p><p>Multiple switches can be used together. Two switches: <b>-t FivePtAdjAve</b> are used below to smooth with FivePtAdjAve theme and <b>-r 1</b> to set recalculation mode to auto
</p>
<pre class="lt" style="font-family:monospace;">smooth <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">-</span>t FivePtAdjAve <span style="color: #000080;">-</span>r <span style="color: #0000dd;">1</span>;</pre>
<p>The following script runs the <b><a class="external text" href="../../XFunction/X-Function/Freqcounts.html">freqcounts</a></b> X-Function with <b>-r 1</b> to automatically <span class="OIndex">recalculate</span> when data in the input column changes.
</p>
<pre class="lt" style="font-family:monospace;">newbook;
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>uniform<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">100</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">*</span><span style="color: #0000dd;">50</span>; <span style="color: #008000;">//generate uniformly distributed random data from 0 to 50.</span>
<span style="color: #008000;">//do frequency count with increment 5, recalculation mode set to auto</span>
freqcounts irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span> min<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> max<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">50</span> stepby<span style="color: #000000;">:</span><span style="color: #000080;">=</span>increment inc<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">5</span>
   end<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> count<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> center<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> cumulcount<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> rd<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">-</span>r <span style="color: #0000dd;">1</span>;</pre>
<h3><a name="Open_X-Function_Builder"></a><span class="mw-headline">Open X-Function Builder</span></h3>
<p>Help file dumped by -h switch can be overwhelming and hard to read, while other -he, -hv is too limited.
</p><p>So instead, user can use the -e switch to open the X-Function in X-Function Builder so that user can see all parameter in table view with full info.: input/output, data type, default value, etc, etc.
This is also the dialog for advanced users to learn the code of built-in X-Functions. By clicking <b>Edit X-Function in Code Builder</b> button in the dialog. the X-Function code shows in Code Builder. 
</p>
<pre class="lt" style="font-family:monospace;">smooth <span style="color: #000080;">-</span>e;</pre>
<h3><a name="Copy_Format_from_Input_to_Output"></a><span class="mw-headline">Copy Format from Input to Output</span></h3>
<p>Use the <b>-cf</b> switch to format the output data to match that of the input data:
</p><p>By default, all analysis results are output as datatype double. The following script makes the output data format to be short(2), which is the input data format.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Import a *.wav file; imported *.wav data format is short(2).</span>
fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Signal Processing\sample.wav&quot;</span>;
newbook s<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>; 
newsheet col<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>; 
impWav options.<span style="color: #000080;">SparkLines</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;

<span style="color: #008000;">//Perform lowpass fft_filter on col 1 of 1st sheet in current book with cutoff freq = 2000</span>
fft_filters <span style="color: #000080;">-</span>cf <span style="color: #000000;">&#91;</span><span style="color: #000080;">%</span>H<span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span> cutoff<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2000</span>  
oy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#40;</span><span style="color: #000080;">&lt;</span>input<span style="color: #000080;">&gt;</span>,<span style="color: #000080;">&lt;</span>new name<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Lowpass Sound Frequency&quot;</span><span style="color: #000080;">&gt;</span><span style="color: #000000;">&#41;</span>;</pre>
<h3><a name="Undo_the_Operation"></a><span class="mw-headline">Undo the Operation</span></h3>
<p>Use the <b>-u</b> switch to support undo the x-function operation when running from scripts.
</p><p>If a x-function is run from the dialog, by default the operation can be undone. But if it is run from scripts, we should use <b>-u</b> switch to support undo. The following scripts transpose the active worksheet and output the results to a new workbook and then undo the operation.
</p>
<pre class="lt" style="font-family:monospace;">wtranspose <span style="color: #000080;">-</span>u ow<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>new<span style="color: #000080;">&gt;</span>;
undo;</pre>






