<h1 class="firstHeading">4.1.3 Accessing Embedded Graphs</h1><p class='urlname' style='display: none'>Access-Embedded-Graphs</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#List_Embedded_Graphs"><span class="tocnumber">1</span> <span class="toctext">List Embedded Graphs</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#List_Embedded_Graphs_in_the_Project"><span class="tocnumber">1.1</span> <span class="toctext">List Embedded Graphs in the Project</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#List_Embedded_Graphs_in_Active_Worksheet_Cells"><span class="tocnumber">1.2</span> <span class="toctext">List Embedded Graphs in Active Worksheet Cells</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4"><a href="#Customize_the_Embedded_Graphs"><span class="tocnumber">2</span> <span class="toctext">Customize the Embedded Graphs</span></a></li>
</ul>
</div>

<h2><a name="List_Embedded_Graphs"></a><span class="mw-headline">List Embedded Graphs</span></h2>
<h3><a name="List_Embedded_Graphs_in_the_Project"></a><span class="mw-headline">List Embedded Graphs in the Project</span></h3>
<p>List all embedded/floating graph pages in the project, along with embedding information(Worksheet, Row, Column).
</p>
<pre class="lt" style="font-family:monospace;">doc <span style="color: #000080;">-</span>e P
<span style="color: #000000;">&#123;</span>
   string wkb<span style="color: #000080;">$</span>, name<span style="color: #000080;">$</span>;	
    if<span style="color: #000000;">&#40;</span>page.<span style="color: #000080;">IsEmbedded</span><span style="color: #000080;">==</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span> <span style="color: #008000;">// list all embedded graphs</span>
    <span style="color: #000000;">&#123;</span>
        wkb<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> page.<span style="color: #000080;">isEmbedded</span><span style="color: #000080;">$</span>;
        name<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>page.<span style="color: #000080;">label</span><span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>;
        if<span style="color: #000000;">&#40;</span>name.<span style="color: #000080;">Getlength</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">==</span><span style="color: #0000dd;">0</span> <span style="color: #000000;">&#41;</span> name<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">%</span>H;
	type <span style="color: #ff00ff;">&quot;The embedded graph is&#160;%(name$)&quot;</span>;
	type <span style="color: #ff00ff;">&quot;It is in&#160;%(wkb$)&quot;</span>;

    <span style="color: #000000;">&#125;</span>
    if<span style="color: #000000;">&#40;</span>page.<span style="color: #000080;">IsEmbedded</span><span style="color: #000080;">==</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> <span style="color: #008000;">// list all floating graphs</span>
    <span style="color: #000000;">&#123;</span>
        wkb<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> page.<span style="color: #000080;">isEmbedded</span><span style="color: #000080;">$</span>;
        name<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>page.<span style="color: #000080;">label</span><span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>;
        if<span style="color: #000000;">&#40;</span>name.<span style="color: #000080;">Getlength</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">==</span><span style="color: #0000dd;">0</span> <span style="color: #000000;">&#41;</span> name<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">%</span>H;
	type <span style="color: #ff00ff;">&quot;The floating graph is&#160;%(name$)&quot;</span>;
	type <span style="color: #ff00ff;">&quot;It is in&#160;%(wkb$)&quot;</span>;
    <span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>
<h3><a name="List_Embedded_Graphs_in_Active_Worksheet_Cells"></a><span class="mw-headline">List Embedded Graphs in Active Worksheet Cells</span></h3>
<p>The example below lists all graphs embedded in cells in the active worksheet. 
</p>
<table class="note">

<tr>
<td><b>Notes:</b> <a href="../../LabTalk/LabTalk/List_(command).html#eg.3B_List_all_embeded_graphs_in_active_worksheet" title="LabTalk:List (command)"><b>list -eg</b></a> can also dump all the name of embedded graphs in the active worksheet to the Script Window (both those embedded in cells and those "floating" on the worksheet page). Please note that the information got from <b>list -eg</b> can not be further processed.
</td></tr></table>
<pre class="lt" style="font-family:monospace;">range rA <span style="color: #000080;">=</span> <span style="color: #000080;">!</span>; <span style="color: #008000;">//define range of the active worksheet</span>
doc <span style="color: #000080;">-</span>e P <span style="color: #008000;">//loop over all graph window in project</span>
<span style="color: #000000;">&#123;</span>
    if<span style="color: #000000;">&#40;</span>page.<span style="color: #000080;">IsEmbedded</span><span style="color: #000080;">==</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span> <span style="color: #008000;">//if the graph is embedded in a worksheet cell</span>
    <span style="color: #000000;">&#123;</span>
        range rB <span style="color: #000080;">=</span> page.<span style="color: #000080;">isEmbedded</span><span style="color: #000080;">$</span>; <span style="color: #008000;">//define a range where the embedded graph locates</span>
        if <span style="color: #000000;">&#40;</span>rB.<span style="color: #000080;">GetLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">==</span> rA.<span style="color: #000080;">GetLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>  
	<span style="color: #000000;">&#123;</span>
		type <span style="color: #000080;">%</span>H;
	<span style="color: #000000;">&#125;</span>

    <span style="color: #000000;">&#125;</span>;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Customize_the_Embedded_Graphs"></a><span class="mw-headline">Customize the Embedded Graphs</span></h2>
<p>The example below re-scale each layer of a embedded graph to show all plots
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//Suppose Graph2 is an embedded graph in workbook.</span>
win <span style="color: #000080;">-</span>o Graph2
<span style="color: #000000;">&#123;</span>
	doc <span style="color: #000080;">-</span>e LW <span style="color: #008000;">//loop over all layers in the graph window</span>
	<span style="color: #000000;">&#123;</span>	
		Rescale;
	<span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>






