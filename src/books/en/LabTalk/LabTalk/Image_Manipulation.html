<h1 class="firstHeading">4.5.5 Image Manipulation</h1><p><br />
</p>
<h2><a name="RGB_Image_Matrix"></a><span class="mw-headline">RGB Image Matrix</span></h2>
<p>While a matrix contains information on how many rows and columns to display, it is internally stored as a linear array. This fact can be used to copy data from a matrix to a worksheet column as in this instance where we
</p>
<ol><li>Import an image file</li>
<li>Extract the Red, Green and Blue (RGB) channels (matrix to matrix)</li>
<li>Copy the channel data (matrix to column)</li>
<li>Construct a string representation of the RGB values</li></ol>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Point to a sample image and import</span>
fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> SYSTEM.<span style="color: #000080;">PATH</span>.<span style="color: #000080;">PROGRAM</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Image Processing and Analysis\Flower.jpg&quot;</span>;
impImage;
<span style="color: #008000;">// Split the RGB into separate Red, Green and Blue matrices</span>
imgRGBsplit r<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>RGBOUT<span style="color: #000000;">&#93;</span>RED<span style="color: #000080;">!</span><span style="color: #0000dd;">1</span> g<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>RGBOUT<span style="color: #000000;">&#93;</span>GREEN<span style="color: #000080;">!</span><span style="color: #0000dd;">1</span> b<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>RGBOUT<span style="color: #000000;">&#93;</span>BLUE<span style="color: #000080;">!</span><span style="color: #0000dd;">1</span>;
<span style="color: #008000;">// Create a new Workbook</span>
newbook;
wks.<span style="color: #000080;">ncols</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">4</span>;
wks.<span style="color: #000080;">col1</span>.<span style="color: #000080;">lname</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Red;
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">lname</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Green;
wks.<span style="color: #000080;">col3</span>.<span style="color: #000080;">lname</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Blue;
wks.<span style="color: #000080;">col4</span>.<span style="color: #000080;">lname</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> RGB;
<span style="color: #008000;">// Worksheet ranges</span>
range raDR <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>, raDG <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>, raDB <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;
<span style="color: #008000;">// Matrix ranges</span>
range raR <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>RGBOUT<span style="color: #000000;">&#93;</span>RED<span style="color: #000080;">!</span><span style="color: #0000dd;">1</span>;
range raG <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>RGBOUT<span style="color: #000000;">&#93;</span>GREEN<span style="color: #000080;">!</span><span style="color: #0000dd;">1</span>;
range raB <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>RGBOUT<span style="color: #000000;">&#93;</span>BLUE<span style="color: #000080;">!</span><span style="color: #0000dd;">1</span>;
<span style="color: #008000;">// Copy data from Matrix to Workbook by range assignment</span>
raDR <span style="color: #000080;">=</span> raR;
raDG <span style="color: #000080;">=</span> raG;
raDB <span style="color: #000080;">=</span> raB;
<span style="color: #008000;">// Create a string showing the RGB triplet</span>
col<span style="color: #000000;">&#40;</span>D<span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot; &quot;</span> <span style="color: #000080;">+</span> col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot; &quot;</span> <span style="color: #000080;">+</span> col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">$</span>;</pre>
<p><br />
</p>





