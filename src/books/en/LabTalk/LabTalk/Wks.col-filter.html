<h1 class="firstHeading">3.7.5.102.9 wks.col.filter</h1><p><span class="OIndex" style="display:none">filter</span>
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Syntax"><span class="tocnumber">1</span> <span class="toctext">Syntax</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Type"><span class="tocnumber">2</span> <span class="toctext">Type</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Access"><span class="tocnumber">3</span> <span class="toctext">Access</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Description"><span class="tocnumber">4</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Examples"><span class="tocnumber">5</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#See_also"><span class="tocnumber">6</span> <span class="toctext">See also</span></a></li>
</ul>
</div>

<h2><a name="Syntax"></a><span class="mw-headline">Syntax</span></h2>
<pre class="lt" style="font-family:monospace;">wks.<span style="color: #000080;">col</span>.<span style="color: #000080;">filter</span></pre>
<p><br />
</p>
<pre class="lt" style="font-family:monospace;">wks.<span style="color: #000080;">col</span>.<span style="color: #000080;">filter</span><span style="color: #000080;">$</span></pre>
<h2><a name="Type"></a><span class="mw-headline">Type</span></h2>
<p>numeric
</p><p><br />
string
</p>
<h2><a name="Access"></a><span class="mw-headline">Access</span></h2>
<p>Read/write
</p>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>Add or remove a filter. <br />
0 = remove filter <br />
1 = add filter <br />
2 = custom filter (read only) <br />
<br />
<b>Note:</b> Filter properties are set by using these filter related scripts, but the filter will not run automatically, and the method <a href="../../LabTalk/LabTalk/Wks_(object).html" title="LabTalk:Wks (object)">wks.runfilter()</a> needs to be called to run or re-apply the filter.
</p><p><br />
Set or get filter query string. It must set the filter type to advance. 
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p><b>EX1</b>
</p>
<dl><dt>This example shows how to set up a worksheet filter. In this example we have a column of temperatures where we wish only to show rows where the temperature is greater than 75. The last line of script allows the user to manually modify and reapply filter.</dt></dl>
<pre class="lt" style="font-family:monospace;">newbook;
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> data<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">31</span><span style="color: #000000;">&#41;</span>;
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>uniform<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">31</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">*</span><span style="color: #0000dd;">10</span><span style="color: #000080;">+</span><span style="color: #0000dd;">70</span>;
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">filter</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">filterx</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;temperature&quot;</span>; <span style="color: #008000;">// variable name we will use</span>
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">filter</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;temperature &gt; 75&quot;</span>; <span style="color: #008000;">// our filter condition</span>
wks.<span style="color: #000080;">runfilter</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">filter</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// open the associated filter dialog box to modify filter</span></pre>
<p><br />
<b>EX2</b>
</p>
<dl><dt>This example shows how to set column as categorical. This script imports data, filters the data, sets a column of data as categorical then sorts the filtered categories in ascending order using <code>wks.col.categorical.sort</code>. Ordering becomes important when creating the stack plot. Sorting in ascending order then plotting the stack "top to bottom" preserves alphabetical ordering of categories, from top to bottom.</dt></dl>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// import automobile.dat to a new book</span>
fn<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Statistics\automobile.dat&quot;</span>;
newbook;
impASC fn<span style="color: #000080;">$</span>;
<span style="color: #008000;">// apply filter to column = Make to show only Buick Chrysler GMC Lincoln Saturn</span>
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">filter</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">filterx</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> make;
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">filter</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;make=&quot;</span>Buick<span style="color: #ff00ff;">&quot; or make=&quot;</span>Chrysler<span style="color: #ff00ff;">&quot; or make=&quot;</span>GMC<span style="color: #ff00ff;">&quot; or make=&quot;</span>Lincoln<span style="color: #ff00ff;">&quot; or make=&quot;</span>Saturn<span style="color: #ff00ff;">&quot;&quot;</span>;
wks.<span style="color: #000080;">runfilter</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// set col(2) as categorical and sort in ascending order</span>
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">categorical</span>.<span style="color: #000080;">type</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>;
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">categorical</span>.<span style="color: #000080;">sort</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
<span style="color: #008000;">//refresh column filter</span>
wks.<span style="color: #000080;">runfilter</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// unstack worksheet to columns by make</span>
wunstackcol <span style="color: #000080;">-</span>r <span style="color: #0000dd;">2</span> irng1<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span><span style="color: #000080;">%</span>H<span style="color: #000000;">&#93;</span>automobile<span style="color: #000080;">!</span>C<span style="color: #ff00ff;">&quot;Power&quot;</span> irng2<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span><span style="color: #000080;">%</span>H<span style="color: #000000;">&#93;</span>automobile<span style="color: #000080;">!</span>B<span style="color: #ff00ff;">&quot;Make&quot;</span> nonstack<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> other<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span><span style="color: #000080;">%</span>H<span style="color: #000000;">&#93;</span>automobile<span style="color: #000080;">!</span>A<span style="color: #ff00ff;">&quot;Year&quot;</span> extract<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;
<span style="color: #008000;">// create stack plot of col(1) vs. col(2) to end, type=scatter</span>
plotstack iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">:</span>end<span style="color: #000000;">&#41;</span> plottype<span style="color: #000000;">:</span><span style="color: #000080;">=</span>scatter order<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> link<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> xlink<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;</pre>
<p><br />
<b>EX3</b>
</p>
<dl><dt>This example shows how to remove column filter</dt></dl>
<pre class="lt" style="font-family:monospace;">wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">filter</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
wks.<span style="color: #000080;">runfilter</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//force update even there is no filter</span></pre>
<h2><a name="See_also"></a><span class="mw-headline">See also</span></h2>
<p><a href="../../LabTalk/LabTalk/Wks.col-filterx.html" title="LabTalk:Wks.col-filterx">wks.col.filterx</a>, <a href="../../LabTalk/LabTalk/Wks.col-filter(method).html" title="LabTalk:Wks.col-filter(method)">wks.col.filter(method)</a>, <a href="../../LabTalk/LabTalk/Wks.col-categorical.type.html" title="LabTalk:Wks.col-categorical.type">wks.col.categorical.type</a>, <a href="../../LabTalk/LabTalk/Wks.col-categorical.sort.html" title="LabTalk:Wks.col-categorical.sort">wks.col.categorical.sort</a>
</p>





