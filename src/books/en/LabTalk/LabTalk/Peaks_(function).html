<h1 class="firstHeading">3.5.6.3 Peaks</h1><p class='urlname' style='display: none'>Peaks-func</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Syntax"><span class="tocnumber">2</span> <span class="toctext">Syntax</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Parameter"><span class="tocnumber">3</span> <span class="toctext">Parameter</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Return"><span class="tocnumber">4</span> <span class="toctext">Return</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Examples"><span class="tocnumber">5</span> <span class="toctext">Examples</span></a></li>
</ul>
</div>

<h2><a name="Description"></a><span class="mw-headline"><font color="chocolate">Description</font></span></h2>
<p>The peaks function returns a dataset containing indices of peaks found using <b>width</b> and <b>minht</b> as a criteria. <b>width</b> is the number of points on either side of the test point (and is treated as an integer) and <b>minht</b> is in Y axis units. A peak at a given index <i>i</i> is <b>minht</b> greater than the data value at <i>i-<b>width</b></i> or <i>i+<b>width</b></i>.
</p>
<h2><a name="Syntax"></a><span class="mw-headline"><font color="chocolate">Syntax</font></span></h2>
<pre class="lt" style="font-family:monospace;">dataset peaks<span style="color: #000000;">&#40;</span>dataset vd, int width, double minht<span style="color: #000000;">&#41;</span></pre>
<h2><a name="Parameter"></a><span class="mw-headline"><font color="chocolate">Parameter</font></span></h2>
<p><b>vd</b>
</p>
<dl><dd>a dataset, a range or column in Origin worksheet in which you want to find peak information.</dd></dl>
<p><b>width</b>
</p>
<dl><dd>the number of points on either side of the test point to take into account when determines a peak.</dd></dl>
<p><b>minht</b>
</p>
<dl><dd>the difference of height between the peak center data point with index <i>i</i> and the point at <i>i-<b>width</b></i> or <i>i-<b>width</b></i>.</dd></dl>
<h2><a name="Return"></a><span class="mw-headline"><font color="chocolate">Return</font></span></h2>
<p>Returns a dataset containing indices of peaks found in <b>vd</b>.
</p>
<h2><a name="Examples"></a><span class="mw-headline"><font color="chocolate">Examples</font></span></h2>
<p>With a worksheet active<br />
</p>
<pre class="lt" style="font-family:monospace;">col<span style="color: #000000;">&#40;</span>Peak Indices<span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> peaks<span style="color: #000000;">&#40;</span>col<span style="color: #000000;">&#40;</span>B<span style="color: #000000;">&#41;</span>, <span style="color: #0000dd;">3</span>, <span style="color: #0000dd;">9</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Columns are referenced by name</span></pre>
<p>With a graph active<br />
</p>
<pre class="lt" style="font-family:monospace;">Peaks_Index <span style="color: #000080;">=</span> peaks<span style="color: #000000;">&#40;</span><span style="color: #000080;">%</span>C, <span style="color: #0000dd;">5</span>, Y1 <span style="color: #000080;">+</span> .4 <span style="color: #000080;">*</span> <span style="color: #000000;">&#40;</span>Y2 <span style="color: #000080;">-</span> Y1<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//&#160;%C is the active plot curve</span></pre>
<p>Using Range notation<br />
</p>
<pre class="lt" style="font-family:monospace;">range rr1 <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>Peaks<span style="color: #000000;">&#93;</span>Sheet1<span style="color: #000080;">!</span>Index;
range rr2 <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>Book1<span style="color: #000000;">&#93;</span><span style="color: #ff00ff;">&quot;Sheet1&quot;</span><span style="color: #000080;">!</span>B;
rr1 <span style="color: #000080;">=</span> peaks<span style="color: #000000;">&#40;</span>rr2, <span style="color: #0000dd;">4</span>, <span style="color: #0000dd;">10</span><span style="color: #000000;">&#41;</span>;</pre>






