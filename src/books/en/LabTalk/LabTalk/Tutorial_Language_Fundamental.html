<h1 class="firstHeading">5.2 LabTalk Language Fundamentals</h1><p class='urlname' style='display: none'>Tutorial-Language-Fundamental</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Summary"><span class="tocnumber">1</span> <span class="toctext">Summary</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#What_You_Will_Learn"><span class="tocnumber">2</span> <span class="toctext">What You Will Learn</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Data_Types_and_Variables"><span class="tocnumber">2.1</span> <span class="toctext">Data Types and Variables</span></a>
<ul>
<li class="toclevel-3 tocsection-4"><a href="#Scope_of_Variables"><span class="tocnumber">2.1.1</span> <span class="toctext">Scope of Variables</span></a></li>
<li class="toclevel-3 tocsection-5"><a href="#String_registers"><span class="tocnumber">2.1.2</span> <span class="toctext">String registers</span></a></li>
<li class="toclevel-3 tocsection-6"><a href="#Dataset"><span class="tocnumber">2.1.3</span> <span class="toctext">Dataset</span></a></li>
<li class="toclevel-3 tocsection-7"><a href="#Range"><span class="tocnumber">2.1.4</span> <span class="toctext">Range</span></a></li>
<li class="toclevel-3 tocsection-8"><a href="#String_Array"><span class="tocnumber">2.1.5</span> <span class="toctext">String Array</span></a></li>
<li class="toclevel-3 tocsection-9"><a href="#Tree"><span class="tocnumber">2.1.6</span> <span class="toctext">Tree</span></a></li>
<li class="toclevel-3 tocsection-10"><a href="#System_Variable"><span class="tocnumber">2.1.7</span> <span class="toctext">System Variable</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-11"><a href="#Statements"><span class="tocnumber">2.2</span> <span class="toctext">Statements</span></a>
<ul>
<li class="toclevel-3 tocsection-12"><a href="#Quick_Output_Statement"><span class="tocnumber">2.2.1</span> <span class="toctext">Quick Output Statement</span></a></li>
<li class="toclevel-3 tocsection-13"><a href="#Assignment"><span class="tocnumber">2.2.2</span> <span class="toctext">Assignment</span></a></li>
<li class="toclevel-3 tocsection-14"><a href="#Command"><span class="tocnumber">2.2.3</span> <span class="toctext">Command</span></a></li>
<li class="toclevel-3 tocsection-15"><a href="#Control_Structures"><span class="tocnumber">2.2.4</span> <span class="toctext">Control Structures</span></a></li>
<li class="toclevel-3 tocsection-16"><a href="#LabTalk_Function"><span class="tocnumber">2.2.5</span> <span class="toctext">LabTalk Function</span></a></li>
<li class="toclevel-3 tocsection-17"><a href="#LabTalk_Object"><span class="tocnumber">2.2.6</span> <span class="toctext">LabTalk Object</span></a></li>
<li class="toclevel-3 tocsection-18"><a href="#X-Functions"><span class="tocnumber">2.2.7</span> <span class="toctext">X-Functions</span></a></li>
<li class="toclevel-3 tocsection-19"><a href="#Macro"><span class="tocnumber">2.2.8</span> <span class="toctext">Macro</span></a></li>
<li class="toclevel-3 tocsection-20"><a href="#Origin_C_Functions"><span class="tocnumber">2.2.9</span> <span class="toctext">Origin C Functions</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>

<h2><a name="Summary"></a><span class="mw-headline">Summary</span></h2>
<p>LabTalk supports variables of data types, statements and control structures. Some common to other programming languages while some are unique in Origin to easily perform tasks related to Origin's worksheet, graph, plot, etc. Using these variables with different statements is the basic idea of scripting in Origin.<br />
</p>
<h2><a name="What_You_Will_Learn"></a><span class="mw-headline">What You Will Learn</span></h2>
<p>This tutorial will show these fundamentals with various examples:
</p>
<ul><li>Define and use types of data types and variables</li>
<li>Run different statements
<ul><li>Commands</li>
<li>control structures</li>
<li>Run LabTalk functions including build user-defined LabTalk function</li>
<li>Read and set object properties and methods</li>
<li>Run X-Function</li>
<li>Define and use Macro</li>
<li>Build OriginC Function and Use it in LabTalk Script</li></ul></li></ul>
<p><br />
</p>
<h3><a name="Data_Types_and_Variables"></a><span class="mw-headline"><a href="../../LabTalk/LabTalk/Data_Types_and_Variables.html" title="LabTalk:Data Types and Variables">Data Types and Variables</a></span></h3>
<p>LabTalk supports nine data types: double, integer, constant, dataset, string, stringarray, range, tree and graphic objects. A variable used without a declaration is by default type <i>double</i> or <i>string</i> -- if it ends with $, it's a string variable, otherwise, it's a double variable
</p>
<h4><a name="Scope_of_Variables"></a><span class="mw-headline">Scope of Variables</span></h4>
<p>There are 3 scopes of variable: Session, project and local and it's determined by declaration.
</p>
<dl><dd><ul><li> Variables created without declaration (only allowed for types double, string, and dataset) become Project variables and are saved with the Origin Project file. </li>
<li> Declared variables become Session or Local variables. Session variables will be available as long as Origin isn't closed. </li>
<li> Variables declared in a <b>{ }</b> block are local variables and have a scope which is destroyed when leaving a block.</li></ul></dd></dl>
<ol>
<li> Define some project variables - use without declaration
<pre class="lt" style="font-family:monospace;">aa <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>; <span style="color: #008000;">//double variable since not declared</span>
str<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Hello&quot;</span>; <span style="color: #008000;">//string variable ends with $</span></pre>
<li> Define session variables - declare and then use
<pre class="lt" style="font-family:monospace;">double bb <span style="color: #000080;">=</span> <span style="color: #0000dd;">1.234</span>;  <span style="color: #008000;">//declare and assign</span>
double cc; <span style="color: #008000;">//declare</span>
cc <span style="color: #000080;">=</span> <span style="color: #0000dd;">9.876</span>; <span style="color: #008000;">//assign</span>
int nn; <span style="color: #008000;">//declare</span>
<span style="color: #008000;">//You must assign a value when declaring a constant</span>
<span style="color: #008000;">//And the constant value cannot be changed.</span>
const c1 <span style="color: #000080;">=</span> <span style="color: #0000dd;">0.5</span>; <span style="color: #008000;">//declare and assign</span></pre>
<li> Run the <a href="../../LabTalk/LabTalk/List_(command).html" title="LabTalk:List (command)"><b>list</b></a> command to open a <b>LabTalk Variable Viewer</b> to view, edit, add, and delete variables and their scopes.
<pre class="lt" style="font-family:monospace;">list;</pre>
<dl><dd><a  class="image"><img alt="Variable list.png" src="../images/Tutorial_Language_Fundamental/Variable_list.png?v=40905" width="707"  /></a></dd></dl>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Tutorial_Language_Fundamental/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>You can use the list and <a href="../../LabTalk/LabTalk/Delete_(command).html" title="LabTalk:Delete (command)"><b>delete</b></a> command with options to view and delete variables.
</p></td></tr></table> 
<li> Choose File: Save Project As to save the project as <b>LT.opju</b>
<li> Start a new project.
<li> Check project variables. They are not recognized.
<pre class="lt" style="font-family:monospace;">aa<span style="color: #000080;">=</span>; <span style="color: #008000;">//output Undefined variable: AA</span>
str<span style="color: #000080;">$</span><span style="color: #000080;">=</span>; <span style="color: #008000;">//output #Command Error!</span></pre>
<li> Check session variables. They will output values since in same Origin session.
<pre class="lt" style="font-family:monospace;">bb<span style="color: #000080;">=</span>; <span style="color: #008000;">//output bb=1.234</span>
cc<span style="color: #000080;">=</span>; <span style="color: #008000;">//output cc=9.876</span>
nn<span style="color: #000080;">=</span>; <span style="color: #008000;">//output nn=0</span>
c1<span style="color: #000080;">=</span>; <span style="color: #008000;">//output c1=0.5</span></pre>
<li> Close Origin and retart Origin (new session)
<li> Check all variables. Since new session and project isn't loaded, all the variables are not recognized.
<pre class="lt" style="font-family:monospace;">aa<span style="color: #000080;">=</span>; 
str<span style="color: #000080;">$</span><span style="color: #000080;">=</span>; 
bb<span style="color: #000080;">=</span>; 
cc<span style="color: #000080;">=</span>; 
nn<span style="color: #000080;">=</span>; 
c1<span style="color: #000080;">=</span>;</pre>
<li> Open LT.opju and check all variables. Only project variables are recognized.
<pre class="lt" style="font-family:monospace;">aa<span style="color: #000080;">=</span>; <span style="color: #008000;">//output aa=3</span>
str<span style="color: #000080;">$</span><span style="color: #000080;">=</span>; <span style="color: #008000;">//output Hello</span>
bb<span style="color: #000080;">=</span>; 
cc<span style="color: #000080;">=</span>; 
nn<span style="color: #000080;">=</span>; 
c1<span style="color: #000080;">=</span>;</pre>
</ol>
<h4><a name="String_registers"></a><span class="mw-headline"><a href="../../LabTalk/LabTalk/String_registers.html" title="LabTalk:String registers">String registers</a></span></h4>
<p>String Register was the only way to save strings before string variable was supported in Origin. We recommend using string variable though string register is still supported. Please note that some string registers are reserved for Origin use e.g.&#160;%H for current window name,&#160;%Y for User Files folder, etc.. Please use the unreserved string registers if you want to use it to save strings.
</p>
<ol>
<li>Assign string to string register
<pre class="lt" style="font-family:monospace;"> 
<span style="color: #000080;">%</span>A<span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Hello World&quot;</span>;
<span style="color: #000080;">%</span>A<span style="color: #000080;">=</span>;</pre>
<li>Define a string variable and then store it in a string register.</li>
<pre class="lt" style="font-family:monospace;">string greeting<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Good Morning&quot;</span>;
<span style="color: #000080;">%</span>B <span style="color: #000080;">=</span> greeting<span style="color: #000080;">$</span>;
greeting<span style="color: #000080;">$</span> <span style="color: #000080;">=</span>;
<span style="color: #000080;">%</span>B <span style="color: #000080;">=</span>;</pre> 
<li>Concatenate string register and string variables
<pre class="lt" style="font-family:monospace;"><span style="color: #000080;">%</span>J<span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;%A, &quot;</span> <span style="color: #000080;">+</span> greeting<span style="color: #000080;">$</span>;
<span style="color: #000080;">%</span>J<span style="color: #000080;">=</span>;</pre>
<li>Normally,&#160;% plus any letter is interpreted as one of 26 string registers. By prefixing a&#160;% symbol you can stop the substitution
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//Define a string variable with the text &quot;%B&quot; without recognizing it as a string register</span>
string str1<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">%%</span>B;
str1<span style="color: #000080;">$</span> <span style="color: #000080;">=</span>; <span style="color: #008000;">//should output&#160;%B</span></pre>
</ol>
<h4><a name="Dataset"></a><span class="mw-headline"><a href="../../LabTalk/LabTalk/Datasets_(object).html" title="LabTalk:Datasets (object)">Dataset</a></span></h4>
<p>Dataset type data is loose dataset not associated with any worksheet. They can be used in calculations and be assigned to worksheet columns. Project level dataset can be used for plotting while session level dataset can't be used for plotting.
</p>
<ol>
<li>Create a project-level loose dataset by assignment
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//define loose dataset</span>
temp <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">10</span>,<span style="color: #0000dd;">9</span>,<span style="color: #0000dd;">8</span>,<span style="color: #0000dd;">7</span>,<span style="color: #0000dd;">6</span><span style="color: #000000;">&#125;</span>;

<span style="color: #008000;">//output values</span>
temp<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">=</span>; <span style="color: #008000;">//output 1st value 10</span>
type <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>temp<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//output all values separated by space</span>

<span style="color: #008000;">//using dataset to do calculation</span>
temp2<span style="color: #000080;">=</span>sqrt<span style="color: #000000;">&#40;</span>temp<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//square root of temp</span>

<span style="color: #008000;">//Use plotxy X-Function to plot line+symbol graph, temp as X, temp2 as Y</span>
plotxy iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#40;</span>temp, temp2<span style="color: #000000;">&#41;</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">202</span>;

<span style="color: #008000;">//assign loose dataset to worksheet columns</span>
col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>temp; 
col<span style="color: #000000;">&#40;</span>B<span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>temp2;</pre>
<li>Besides define loose dataset by assignment, user can also create project level loose dataset by <b>create</b> command.
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//Create a XY loose dataset &quot;tmpdata&quot; and define row number as 5</span>
create tmpdata <span style="color: #000080;">-</span>wdn <span style="color: #0000dd;">5</span> X Y;</pre>
<p><b>Note:</b> As demonstrated in previous lessons that command can take options. Some options can also take arguments. E.g. The create command takes argument <b>tmpdata</b> and <b>-wdn</b> option. The <b>-wdn</b> option also takes argument <b>5 X Y</b> so tmpdata_X and tempdata_Y dataset are created with size of 5.
</p>
<li>Pass numeric values to tmpdata_X one by one.</li>
<pre class="lt" style="font-family:monospace;">tmpdata_X<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> .1;
tmpdata_X<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> .2;
tmpdata_X<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> .25;
tmpdata_X<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">4</span><span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> .4;
tmpdata_X<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">5</span><span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> .5;</pre>
<li>Pass the values into dataset tmpdata_Y by existing dataset.</li>
<pre class="lt" style="font-family:monospace;">tmpdata_Y <span style="color: #000080;">=</span> temp;</pre>
<li>Plot tempData as line+symbol graph:
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//plotXY is an X-Function</span>
plotxy iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span>tmpdata_Y plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">202</span>;</pre>
<li>Assign new values to dataset. Plot will update accordingly. 
<pre class="lt" style="font-family:monospace;">tmpdata_X<span style="color: #000080;">=</span>data<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0.1</span>,<span style="color: #0000dd;">0.5</span>, <span style="color: #0000dd;">0.1</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//assign 0.1, 0.2, ... 0.5 to tmpdata_X</span>
tmpdata_Y<span style="color: #000080;">=</span>sort<span style="color: #000000;">&#40;</span>normal<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">5</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">*</span><span style="color: #0000dd;">10</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//generate 5 random values and sort them, then assign to tmpdata_Y</span></pre>
<li>If declared, the dataset will be a session level variable.
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//create a session variable aa with numbers 1-10with increment of 0.5</span>
dataset aa <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">0.5</span><span style="color: #000000;">:</span><span style="color: #0000dd;">10</span><span style="color: #000000;">&#125;</span>; <span style="color: #008000;">//declare and assign</span></pre>
</ol>
<h4><a name="Range"></a><span class="mw-headline"><a href="../../LabTalk/LabTalk/Range_Notation.html" title="LabTalk:Range Notation">Range</a></span></h4>
<p>Inside your Origin Project, data exists in four primary places: in worksheet, in matrix, in a loose dataset, or in a graph. Range data type provides a consistent way to access them. 
The syntax is 
</p>
<dl><dd><ul><li> [Workbook]Sheet!Column</li>
<li> [Matrixbook]Matrixsheet!MatrixObject</li>
<li> [Graph]layer!Plot</li>
<li> [??]!LooseDatasetName</li></ul></dd></dl>
<p>Range variable can also refer to window, sheet, layer, subrange of data or a block of data across multiple columns or even sheets. This tutorial will only show some basic examples. You can learn more about it in the next <a href="../../LabTalk/LabTalk/Tutorial_Range_Notation.html" title="LabTalk:Tutorial Range Notation">Range Notation in LabTalk</a> Tutorial.
</p>
<ol>
<li> Define range variable and refer to column A on Sheet1 of Book1 window
<pre class="lt" style="font-family:monospace;">range rA <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>Book1<span style="color: #000000;">&#93;</span>Sheet1<span style="color: #000080;">!</span>Col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span>; 
rA.<span style="color: #000080;">=</span>; <span style="color: #008000;">//dump all properties</span>
rA.<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//dump all methods</span>
rA.<span style="color: #000080;">lname</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>; <span style="color: #008000;">//output long name</span>
rA.<span style="color: #000080;">nRows</span><span style="color: #000080;">=</span>; <span style="color: #008000;">//output number of rows</span>
rA.<span style="color: #000080;">unit</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;MM/DD/YYYY&quot;</span>; <span style="color: #008000;">//set unit as &quot;MM/DD/YYYY&quot;</span>
ra.<span style="color: #000080;">setformat</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span>;<span style="color: #008000;">//set column as Date</span></pre>
<li> Define range variable for columns on multiple sheets and do calculation
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Point to column 1 of sheets 1, 2, and 3 of the active workbook:</span>
<span style="color: #008000;">//for active book, [bookname] part can be skipped</span>
range aa <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span><span style="color: #000080;">!</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
range bb <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span><span style="color: #000080;">!</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
range cc <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span><span style="color: #000080;">!</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
cc <span style="color: #000080;">=</span> aa<span style="color: #000080;">+</span>bb; <span style="color: #008000;">//column contents will be updated</span></pre>
<li>The following example uses the plotxy X-Function to plot a graph, and then the smooth X-Function to smooth a subrange of the data.
<pre class="lt" style="font-family:monospace;">newbook;
fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;\Samples\Signal Processing\EMG Recording.dat&quot;</span>;
impasc;

<span style="color: #008000;">// Define two range variables for subranges of imported data</span>
<span style="color: #008000;">//rxy1 specifies subrange with X value from 5 to 5.5</span>
<span style="color: #008000;">//rxy2 specifies subrange with X value from 9.3 to 9.8</span>
range rxy1 <span style="color: #000080;">=</span> <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span>x5<span style="color: #000000;">:</span><span style="color: #0000dd;">5.5</span><span style="color: #000000;">&#93;</span>;
range rxy2 <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span><span style="color: #000000;">&#91;</span>x9.3<span style="color: #000000;">:</span><span style="color: #0000dd;">9.8</span><span style="color: #000000;">&#93;</span>; <span style="color: #008000;">//if X info not mentioned, it will use the associated X column for Y</span>
plotxy rxy1 plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">200</span>;  <span style="color: #008000;">// Plot line for the 1st XY subrange</span>
smooth <span style="color: #000080;">-</span>r <span style="color: #0000dd;">2</span> rxy2 method<span style="color: #000000;">:</span><span style="color: #000080;">=</span>le;  <span style="color: #008000;">// Smooth the 2nd XY subrange by Loess method</span></pre>
<p>The smooth result is put to rows 10601 -11601 in column C, the corresponding X in 1st column is from 9.3 to 9.8.
</p>
<li>Define range variable for sheet. Then define range variable for column on the sheet
<pre class="lt" style="font-family:monospace;">range rwks <span style="color: #000080;">=</span> sheet1<span style="color: #000080;">!</span>; <span style="color: #008000;">//sheet1</span>
rwks.<span style="color: #000080;">addcol</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//add a column.</span>
range rC<span style="color: #000080;">=</span>rwks<span style="color: #000080;">!</span>C; <span style="color: #008000;">//column C</span>
rC<span style="color: #000080;">=</span>data<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">5</span>,<span style="color: #0000dd;">10</span>, <span style="color: #0000dd;">0.5</span><span style="color: #000000;">&#41;</span>;</pre>
</ol>
<h4><a name="String_Array"></a><span class="mw-headline"><a href="../../LabTalk/LabTalk/StringArray_(object).html" title="LabTalk:StringArray (object)">String Array</a></span></h4>
<ol>
<li>Define a string array and add string members to it.</li>
<pre class="lt" style="font-family:monospace;">StringArray stra;
stra.<span style="color: #000080;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Hello&quot;</span><span style="color: #000000;">&#41;</span>;
stra.<span style="color: #000080;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;World&quot;</span><span style="color: #000000;">&#41;</span>;
stra.<span style="color: #000080;">getAt</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>; <span style="color: #008000;">//output Hello</span>
stra.<span style="color: #000080;">getAt</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>; <span style="color: #008000;">//output World</span></pre>
<li>Use the following script (a loop structure, which will be further introduced in the section below) to print out the strings in string array stra.</li>
<pre class="lt" style="font-family:monospace;">loop<span style="color: #000000;">&#40;</span>ii,<span style="color: #0000dd;">1</span>,stra.<span style="color: #000080;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
  string str<span style="color: #000080;">$</span><span style="color: #000080;">=</span>stra.<span style="color: #000080;">GetAt</span><span style="color: #000000;">&#40;</span>ii<span style="color: #000000;">&#41;</span><span style="color: #000080;">$</span>;
  str<span style="color: #000080;">$</span><span style="color: #000080;">=</span>;
<span style="color: #008000;">//It should return</span>
<span style="color: #008000;">//Hello</span>
<span style="color: #008000;">//World</span>
<span style="color: #000000;">&#125;</span></pre>
</ol>
<h4><a name="Tree"></a><span class="mw-headline">Tree</span></h4>
<p>LabTalk supports the standard tree data type, which emulates a tree structure with a set of branches and leaves  (both are called nodes). The branches contain leaves, and the leaves contain data.
</p>
<ol>
<li> Define a tree variable and add branches and leaves
<pre class="lt" style="font-family:monospace;">tree report;        
<span style="color: #008000;">// Tree nodes are added automatically during assignment:</span>
<span style="color: #008000;">//report two has 2 branches, each branche has two leaves</span>
report.<span style="color: #000080;">user</span>.<span style="color: #000080;">name</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Tom&quot;</span>; <span style="color: #008000;">//string</span>
report.<span style="color: #000080;">user</span>.<span style="color: #000080;">age</span><span style="color: #000080;">=</span><span style="color: #0000dd;">22</span>; <span style="color: #008000;">// number</span>
report.<span style="color: #000080;">=</span>; <span style="color: #008000;">//output the tree contents</span></pre>
<p><br />
The tree data type is often used in X-Function's tree type argument, no matter it's input or output.
</p>
<li> Get tree type output;
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//use impasc X-Function to import data</span>
string str<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Graphing\Group.dat&quot;</span>; 
impasc fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>str<span style="color: #000080;">$</span>
<span style="color: #008000;">//Get import information</span>
impinfo trInfo<span style="color: #000000;">:</span><span style="color: #000080;">=</span>fileInfo; <span style="color: #008000;">//impinfo. X-function has a tree output trInfo, assign it to a tree variable</span>
fileinfo.<span style="color: #000080;">info</span>.<span style="color: #000080;">filename</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>; <span style="color: #008000;">//output imported filename</span>
fileInfo.<span style="color: #000080;">=</span>; <span style="color: #008000;">//output all contents of the tree</span></pre>
</ol>
<h4><a name="System_Variable"></a><span class="mw-headline"><a href="../../LabTalk/LabTalk/System_Variables.html" title="LabTalk:System Variables">System Variable</a></span></h4>
<p>System variables are used to monitor or control Origin behavior.
E.g. the <b>@ASC</b> system variable to check and change the number of megabytes needed to trigger auto save checking.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//Run the following script line to get the variable value</span>
@ASC <span style="color: #000080;">=</span>&#160;;
<span style="color: #008000;">//Run the following script line to set the variable value to be 10 (MB)</span>
@ASC <span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span>;</pre>
<h3><a name="Statements"></a><span class="mw-headline">Statements</span></h3>
<h4><a name="Quick_Output_Statement"></a><span class="mw-headline">Quick Output Statement</span></h4>
<p>Use <b>=</b> to output the left hand side (LHS) expression, variable, string register, object property, function, system variable info. 
There are already many examples of using = to output variable values in previous section. 
</p><p>Below will show examples of There are already many examples of output variable, string register and object properties in above section. Here are some examples output calculation results
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #0000dd;">10</span><span style="color: #000080;">+</span><span style="color: #0000dd;">3</span><span style="color: #000080;">*</span><span style="color: #0000dd;">5</span><span style="color: #000080;">=</span>; <span style="color: #008000;">//output 10+3*5=25</span>

aa<span style="color: #000080;">=</span><span style="color: #0000dd;">8.1</span>;
aa<span style="color: #000080;">+</span>sqrt<span style="color: #000000;">&#40;</span>aa<span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>; <span style="color: #008000;">//output aa+sqrt(aa)=10.946049894152</span>

col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">-</span>mean<span style="color: #000000;">&#40;</span>col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>; <span style="color: #008000;">//calculation using col() and mean() functions</span>

range ra<span style="color: #000080;">=</span>A; 
ra<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">-</span>min<span style="color: #000000;">&#40;</span>ra<span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>; <span style="color: #008000;">//calculation expression using range variable</span>

dataset ds<span style="color: #000080;">=</span><span style="color: #000000;">&#123;</span><span style="color: #0000dd;">5.6</span>, <span style="color: #0000dd;">3.4</span>, <span style="color: #0000dd;">2.1</span>, <span style="color: #0000dd;">0.5</span><span style="color: #000000;">&#125;</span>;
total<span style="color: #000000;">&#40;</span>ds<span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>; <span style="color: #008000;">//output total(ds)=11.6 //calculation using total() function and dataset variable</span>

<span style="color: #008000;">//note: sum(ds) will return a dataset with cumulative sums {5.6, 9.0, 11.1, 11.6}</span>
sum<span style="color: #000000;">&#40;</span>ds<span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>; <span style="color: #008000;">//will return 5.6, 1st value in cumulative sum</span>
sum<span style="color: #000000;">&#40;</span>ds<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">=</span>; <span style="color: #008000;">//will return 11.6, last value in cumulative sum</span></pre>
<h4><a name="Assignment"></a><span class="mw-headline"><a href="../../LabTalk/LabTalk/Assignment_Statements.html" title="LabTalk:Assignment Statements">Assignment</a></span></h4>
<p>Expression (RHS, right-hand side) is evaluated and put into LHS (left-hand side). If LHS does not exist, it is created if possible, otherwise an error will be reported.
</p><p>Assign value to variable and output values
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//assign</span>
double min <span style="color: #000080;">=</span> <span style="color: #0000dd;">0.5</span>;
string filename<span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;sensor01.dat&quot;</span>;
dataset ds<span style="color: #000080;">=</span><span style="color: #000000;">&#123;</span><span style="color: #0000dd;">0.1</span>, <span style="color: #0000dd;">0.2</span>, <span style="color: #0000dd;">0.3</span><span style="color: #000000;">&#125;</span>;
range ra<span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>book1<span style="color: #000000;">&#93;</span>sheet1<span style="color: #000080;">!</span>A; <span style="color: #008000;">//range variable for column A in specified book and sheet</span>
ra<span style="color: #000080;">=</span>data<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">800</span>, <span style="color: #0000dd;">1000</span>, <span style="color: #0000dd;">10</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//fill it with 800 to 1000 with increment of 10</span>

<span style="color: #008000;">//output</span>
min <span style="color: #000080;">=</span>; <span style="color: #008000;">//output 0.5</span>
filename<span style="color: #000080;">$</span><span style="color: #000080;">=</span>; <span style="color: #008000;">//output sensor01.dat</span>
ds<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">=</span>; <span style="color: #008000;">//output 0.1, 1st value of ds</span>
ra<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">=</span>; <span style="color: #008000;">//output 900, 2nd value in column A</span></pre>
<p>Note: For dataset and range variable, need to use e.g. type <b>$(ds); type $(ra);</b> to output all values
</p><p>Read and write object properties
</p>
<pre class="lt" style="font-family:monospace;">wks.<span style="color: #000080;">name</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>; <span style="color: #008000;">//output current sheet name. For string property, use $ at the end</span>
wks.<span style="color: #000080;">name</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Data&quot;</span>; <span style="color: #008000;">//set </span>
wks.<span style="color: #000080;">ncols</span><span style="color: #000080;">=</span>&#160;; <span style="color: #008000;">//output number of columns in current sheet;</span>
wks.<span style="color: #000080;">ncols</span><span style="color: #000080;">=</span><span style="color: #0000dd;">10</span>; <span style="color: #008000;">//set number of columns to 10</span>
wks.<span style="color: #000080;">=</span>; <span style="color: #008000;">//list all wks object properties</span>
Col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">=</span>; <span style="color: #008000;">//return first value in column 1</span>
Col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">=</span>; <span style="color: #008000;">//return last value in column 1</span>
wks.<span style="color: #000080;">col1</span>.<span style="color: #000080;">=</span>; <span style="color: #008000;">//list all wks.col1 (1st column) object properties</span></pre>
<h4><a name="Command"></a><span class="mw-headline"><a href="../../LabTalk/LabTalk/Command_Statements.html" title="LabTalk:Command Statements">Command</a></span></h4>
<p>LabTalk command statements are similar to DOS batch commands in form of
</p>
<pre class="lt" style="font-family:monospace;">command <span style="color: #000080;">-</span>option argument<span style="color: #000000;">&#40;</span>s<span style="color: #000000;">&#41;</span>;</pre>
<dl><dd><ul><li> Depending on the command, the option and argument may be optional. </li>
<li> Options are always preceded by the dash "-" character. </li>
<li> Arguments are either a script or a data object. </li>
<li> For some commands, options can also take their own arguments.</li></ul></dd></dl>
<ol>
<li>The <b>type</b> command takes option (-n) and and argument (string to output)
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//Display string in a dialog box with Yes and No buttons</span>
type <span style="color: #000080;">-</span>n <span style="color: #ff00ff;">&quot;Do you want to continue?&quot;</span>;</pre>
<li>The <b>repeat</b> command takes two arguments the number of times to execute, and script to repeat
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//Prints &quot;Hello World&quot; in a dialog box three times.</span>
repeat <span style="color: #0000dd;">3</span> <span style="color: #000000;">&#123;</span>type <span style="color: #000080;">-</span>b <span style="color: #ff00ff;">&quot;Hello World&quot;</span><span style="color: #000000;">&#125;</span></pre>
<li>The <b>create</b> command takes argument tmpdata and -wdn option. The -wdn option also takes its own arguments 10 X Y so tmpdata_X and tempdata_Y dataset are created with size of 10.
<pre class="lt" style="font-family:monospace;">create tmpdata <span style="color: #000080;">-</span>wdn <span style="color: #0000dd;">10</span> X Y; 
tmpdata_X<span style="color: #000080;">=</span>normal<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">10</span><span style="color: #000000;">&#41;</span>; 
tmpdata_Y<span style="color: #000080;">=</span>tmpdata_X<span style="color: #000080;">-</span>mean<span style="color: #000000;">&#40;</span>tmpdata_X<span style="color: #000000;">&#41;</span>; 
type <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>tmpdata_X, .2<span style="color: #000000;">&#41;</span>; 
type <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>tmpdata_Y, .2<span style="color: #000000;">&#41;</span>;</pre>
</ol>
<h4><a name="Control_Structures"></a><span class="mw-headline">Control Structures</span></h4>
<p>LabTalk supports 3 control structures and they can be nested inside another. 
</p>
<dl><dd><ul><li> the sequence structure - statement are executed one after the other in the order in in which they are written.</li>
<li> the selection structure - selection statements/decision making statement to perform action based on condition. E.g. <b>if</b>, <b>if-else</b>, <b>switch</b>, <b>break</b>, <b>continue</b>. </li>
<li> the iteration structure - looping statement to perform statements repeatedly as long as condition remains true. E.g. <b>for</b>, <b>loop</b>, <b>repeat</b> and <b>doc -e</b> to loop through Origin objects, such as books, graphs, sheets, etc.</li></ul></dd></dl>
<p><br />
</p><p><b>Decision Making Statements</b>
</p><p>In an Origin project file, make sure there is one workbook, one graph window one matrix window and one Layout page. Activate them and run the following script one by one to determine window type by exist() function
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000080;">&lt;</span>lt<span style="color: #000080;">&gt;</span>
if<span style="color: #000000;">&#40;</span>exist<span style="color: #000000;">&#40;</span><span style="color: #000080;">%</span>H<span style="color: #000000;">&#41;</span><span style="color: #000080;">==</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>
      type <span style="color: #000080;">-</span>b <span style="color: #ff00ff;">&quot;A graph window is active&quot;</span>;
else
      if<span style="color: #000000;">&#40;</span>exist<span style="color: #000000;">&#40;</span><span style="color: #000080;">%</span>H<span style="color: #000000;">&#41;</span><span style="color: #000080;">==</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>
            type <span style="color: #000080;">-</span>b <span style="color: #ff00ff;">&quot;A worksheet is active&quot;</span>;
      else
            type <span style="color: #000080;">-</span>b <span style="color: #ff00ff;">&quot;Neither a graph nor worksheet is active&quot;</span>;</pre>
<p>The <b>switch</b> command is used when more than two possibilities are needed in a script. 
</p><p>For example the script above with the if-else structure can be modified as below:
</p>
<pre class="lt" style="font-family:monospace;">switch<span style="color: #000000;">&#40;</span>exist<span style="color: #000000;">&#40;</span><span style="color: #000080;">%</span>H<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    case <span style="color: #0000dd;">3</span><span style="color: #000000;">:</span>
       type <span style="color: #000080;">-</span>b <span style="color: #ff00ff;">&quot;A graph window is active&quot;</span>;
       break;
    case <span style="color: #0000dd;">2</span><span style="color: #000000;">:</span>
       type <span style="color: #000080;">-</span>b <span style="color: #ff00ff;">&quot;A worksheet is active&quot;</span>;
       break;
    case <span style="color: #0000dd;">5</span><span style="color: #000000;">:</span>
       type <span style="color: #000080;">-</span>b <span style="color: #ff00ff;">&quot;A Matrix is active&quot;</span>;
       break;
    default<span style="color: #000000;">:</span>
       type <span style="color: #000080;">-</span>b <span style="color: #ff00ff;">&quot;Neither a graph, worksheet nor matrix is active&quot;</span>;
       break;
<span style="color: #000000;">&#125;</span></pre>
<p><b>Loop Control Statements</b>
</p><p>Loop control allows the program to repetitively perform a set of actions as long as conditions are met. LabTalk provides four loop commands: <b>for</b>, <b>repeat</b>, <b>loop</b>, <b>doc -e</b>.
</p><p>The <b>for</b> loop is similar to C. 
</p>
<dl><dd>The syntax is <b>for (<i>expression1</i>; <i>expression2</i>; <i>expression3</i>) {<i>script</i>}</b></dd></dl>
<p>In this syntax, <i>expression1</i> specifies the initialization,  <i>expression2</i> is evaluated to determine whether to execute the <i>script</i>(if true) or to terminate the loop (if false), <i>expression3</i> is executed at the end of each loop, it is often the increment of a counter. Both <i>expression1</i> and <i>expression3</i> can consist of multiple statements separated by commas as in
</p>
<pre class="lt" style="font-family:monospace;">for<span style="color: #000000;">&#40;</span>ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>, jj <span style="color: #000080;">=</span> <span style="color: #0000dd;">9</span>; ii <span style="color: #000080;">&lt;=</span> <span style="color: #0000dd;">5</span>&#160;; ii<span style="color: #000080;">++</span>, jj<span style="color: #000080;">++</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
ty <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>ii<span style="color: #000000;">&#41;</span>, <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>jj<span style="color: #000000;">&#41;</span>, <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>ii<span style="color: #000080;">+</span>jj<span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<p>Execute the following <b>for</b> loop to output every 10th value in the loose dataset loopdata.
</p>
<pre class="lt" style="font-family:monospace;">dataset loopdata<span style="color: #000080;">=</span>normal<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">50</span><span style="color: #000000;">&#41;</span>;
for<span style="color: #000000;">&#40;</span>jj <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; jj <span style="color: #000080;">&lt;=</span> loopdata.<span style="color: #000080;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; jj <span style="color: #000080;">=</span> jj <span style="color: #000080;">+</span> <span style="color: #0000dd;">10</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
  loopdata<span style="color: #000000;">&#91;</span><span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>jj<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span>;
<span style="color: #000000;">&#125;</span></pre>
<p>The following shows using <b>for</b> loop to set columns as XYXY... and their long names
</p>
<pre class="lt" style="font-family:monospace;">wks.<span style="color: #000080;">ncols</span><span style="color: #000080;">=</span><span style="color: #0000dd;">10</span>;
for <span style="color: #000000;">&#40;</span>ii<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>; ii<span style="color: #000080;">&lt;=</span>wks.<span style="color: #000080;">ncols</span>; ii<span style="color: #000080;">++</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
   if <span style="color: #000000;">&#40;</span>mod<span style="color: #000000;">&#40;</span>ii,<span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">==</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>
   <span style="color: #000000;">&#123;</span>
       wks.<span style="color: #000080;">col</span><span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>ii<span style="color: #000000;">&#41;</span>.<span style="color: #000080;">type</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span>;
       wks.<span style="color: #000080;">col</span><span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>ii<span style="color: #000000;">&#41;</span>.<span style="color: #000080;">lname</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Time&quot;</span>;
   <span style="color: #000000;">&#125;</span>
   else 
   <span style="color: #000000;">&#123;</span>
      wks.<span style="color: #000080;">col</span><span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>ii<span style="color: #000000;">&#41;</span>.<span style="color: #000080;">lname</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Amplitude&quot;</span>; 
   <span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>
<p>The <b><a href="../../LabTalk/LabTalk/Repeat_(command).html" title="LabTalk:Repeat (command)">repeat</a></b> loop is used when a set of actions must be repeated without any alterations. 
</p>
<dl><dd>The syntax is: <b>repeat <i>numberOfTimes</i> {<i>script</i>}</b></dd></dl>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//create 6 new workbooks</span>
repeat <span style="color: #0000dd;">6</span> <span style="color: #000000;">&#123;</span> newbook;<span style="color: #000000;">&#125;</span></pre>
<p>The <b><a href="../../LabTalk/LabTalk/Loop_(command).html" title="LabTalk:Loop (command)">loop</a></b> is used when a single variable is being incremented by 1 with each successive loop.
</p>
<dl><dd>The syntax is: <b>loop (variable, startVal, endVal) {script}</b></dd></dl>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//Create a loose dataset (50 rows) which is not associated with a worksheet</span>
create loopdata <span style="color: #000080;">-</span>t <span style="color: #0000dd;">50</span>;
<span style="color: #008000;">//Pass values into the dataset with a loop</span>
loop<span style="color: #000000;">&#40;</span>ii, <span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">50</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
  loopdata<span style="color: #000000;">&#91;</span><span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>ii<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> ii<span style="color: #000080;">^</span><span style="color: #0000dd;">2</span>;
<span style="color: #000000;">&#125;</span> 

<span style="color: #008000;">//dump loopdata values</span>
type <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>loopdata<span style="color: #000000;">&#41;</span>;</pre>
<p><br />
The <b>doc -e</b> loop is used <a href="../../LabTalk/Script/Looping_Over_Objects.html" title="Script:Looping Over Objects">loop through Origin objects</a> (window, sheet, etc.) and execute script.
<b>doc</b> is the abbreviation for <b>document</b>. Remember for LabTalk commands, the command can be shorted as long as it's unique. 
</p>
<dl><dd>The syntax is: <b>doc -e object {script}</b></dd></dl>
<p>The following script loops through all graph windows and set legend background to shadow and refresh the graph
</p>
<pre class="lt" style="font-family:monospace;">doc <span style="color: #000080;">-</span>e LP
<span style="color: #000000;">&#123;</span>
  legend.<span style="color: #000080;">background</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>; <span style="color: #008000;">//set legend background to shadow</span>
  doc <span style="color: #000080;">-</span>uw; <span style="color: #008000;">//refresh window</span>
<span style="color: #000000;">&#125;</span></pre>
<p>The following script output the name of each dataset in the Origin project (including worksheet columns and project-level loose datasets).
</p>
<pre class="lt" style="font-family:monospace;">doc <span style="color: #000080;">-</span>e S
<span style="color: #000000;">&#123;</span>
  <span style="color: #000080;">%</span>C <span style="color: #000080;">=</span>;
<span style="color: #000000;">&#125;</span></pre>
<h4><a name="LabTalk_Function"></a><span class="mw-headline"><a href="../../LabTalk/LabTalk/Function_Statements.html" title="LabTalk:Function Statements">LabTalk Function</a></span></h4>
<p>Origin provides many built-in LabTalk functions to work with different types of data and object in Origin, such as string, math, statistics, date and time, data generation, lookup, logic, etc. User can also define LabTalk functions and call them in Script.
</p><p>The syntax to call LabTalk Functions
<i>FunctionName</i>(<i>Arg1</i> <i>Arg2</i> ... <i>ArgN</i>);
</p><p>Supported argument and return types:<b>string</b>, <b>double</b>, <b>int</b>, <b>dataset</b> and <b>tree</b>. Functions can be used in expressions and usually show on right hand side of assignment statement. But some functions can show on left hand side of assignement.
</p><p>Use the <b>Left( )</b> function to process strings 
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//Define a string variable and assign &quot;Hello World&quot; to it</span>
string str1<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Hello World&quot;</span>;
<span style="color: #008000;">//Use 'Left' function to get the left 5 characters the string</span>
string strLeft<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Left<span style="color: #000000;">&#40;</span>str1<span style="color: #000080;">$</span>,<span style="color: #0000dd;">5</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">$</span>;
strLeft<span style="color: #000080;">$</span> <span style="color: #000080;">=</span>&#160;; <span style="color: #008000;">//should return Hello</span></pre>
<p>Some functions can appear on the left side of an assignment, e.g. Col() function
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//Fill column A with data() function  </span>
col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> data<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">600</span>,<span style="color: #0000dd;">850</span>,<span style="color: #0000dd;">10</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//data() function creates a dataset from 600 to 850 in steps of 10</span></pre>
<p>Use <b>mean()</b>, <b>min()</b> and <b>max()</b> functions to calculate mean, min and max of column and output them by type command.
</p>
<pre class="lt" style="font-family:monospace;">for <span style="color: #000000;">&#40;</span>ii<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>; ii<span style="color: #000080;">&lt;=</span>wks.<span style="color: #000080;">ncols</span>; ii<span style="color: #000080;">++</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
   type <span style="color: #ff00ff;">&quot;Col $(ii): Mean -- $(mean(wcol(ii)), .2), Min -- $(min(wcol(ii)),.2), Max -- $(max(wcol(ii)),.2)&quot;</span>;
<span style="color: #000000;">&#125;</span></pre>
<p>User-Defined LabTalk Function
</p><p>Create user-defined functions with the syntax below:
</p><p><b>function <i>dataType</i> <i>funcName</i>(<i>Arg1</i> <i>Arg2</i> ... <i>ArgN</i>) {<i>script</i>;}</b>
</p>
<ol>
<li>First declare a user-defined numeric function by calling built-in functions. This function will generate a Julian date value from a random numeric value.</li>
<pre class="lt" style="font-family:monospace;">function double JDate<span style="color: #000000;">&#40;</span>double num<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
   <span style="color: #008000;">//Calculate an integral from the double number</span>
   int x <span style="color: #000080;">=</span> int<span style="color: #000000;">&#40;</span>exp<span style="color: #000000;">&#40;</span>num<span style="color: #000000;">&#41;</span><span style="color: #000080;">*</span><span style="color: #0000dd;">1000</span><span style="color: #000000;">&#41;</span>; 
   <span style="color: #008000;">//Generate the day, month and year integral with remainder function mod() </span>
   int iDay <span style="color: #000080;">=</span> mod<span style="color: #000000;">&#40;</span>x, <span style="color: #0000dd;">27</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">+</span> <span style="color: #0000dd;">1</span>;
   int iMonth <span style="color: #000080;">=</span> mod<span style="color: #000000;">&#40;</span>x, <span style="color: #0000dd;">11</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">+</span> <span style="color: #0000dd;">1</span>;
   int iYear <span style="color: #000080;">=</span> <span style="color: #0000dd;">2013</span> <span style="color: #000080;">-</span> mod<span style="color: #000000;">&#40;</span>x, <span style="color: #0000dd;">5</span><span style="color: #000000;">&#41;</span>;
   <span style="color: #008000;">//Define a string as MM/DD/YYYY</span>
   string jd<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>iMonth<span style="color: #000000;">&#41;</span><span style="color: #000080;">/</span><span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>iDay<span style="color: #000000;">&#41;</span><span style="color: #000080;">/</span><span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>iYear<span style="color: #000000;">&#41;</span>;
   <span style="color: #008000;">//Return the Julian date number from the string as the function result </span>
   <span style="color: #008000;">//The string will be substituted with&#160;%() notation</span>
   return date<span style="color: #000000;">&#40;</span><span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>jd<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<li>Call the user-defined function <b>JDate</b> to calculate a Julian date from a numeric value, e.g. 0.83. </li>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//calculate the Julian date and pass it to double variable jda</span>
double jda <span style="color: #000080;">=</span> JDate<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0.83</span><span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">//Output the numeric value of jda</span>
jda <span style="color: #000080;">=</span>;<span style="color: #008000;">//Should return 2455373</span>
<span style="color: #008000;">//Display the date with format MM/DD/YYYY</span>
type <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>jda, D0<span style="color: #000000;">&#41;</span>;<span style="color: #008000;">//Should display 6/26/2010</span></pre>
<li>Create a new workbook with 2 columns, right click on the first column (column A) and choose <b>Fill Column With:Normal Random Numbers</b> to fill in the column with random numeric values.</li>  
<p><b>Note:</b> You can also run the following script to get the random values filled in the first column with the csetvalue x-function:
</p>
<pre class="lt" style="font-family:monospace;">newbook;
wks.<span style="color: #000080;">nCols</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
csetvalue col<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> formula<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;grnd()&quot;</span>;</pre>
<li>Use the <b>JDate</b> function to calculate a Julian date in column B.</li>
<pre class="lt" style="font-family:monospace;">col<span style="color: #000000;">&#40;</span>B<span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> JDate<span style="color: #000000;">&#40;</span>col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;</pre>
<li>Change the column format to Date.</li>
<pre class="lt" style="font-family:monospace;">wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">format</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">4</span>;</pre>
</ol>
<h4><a name="LabTalk_Object"></a><span class="mw-headline"><a href="../../LabTalk/LabTalk/LabTalk_Objects.html" title="LabTalk:LabTalk Objects"> LabTalk Object</a></span></h4>
<p>There are many Origin LabTalk Object (visible or not visible) to control Origin and its elements. Object contains properties and methods (functions).
</p><p>E.g. <b>run</b> object isn't visible in workspace. Use it to run ogs file.
</p>
<dl><dd><ul><li> run.file(filename) to run the script before any section at the beginning of the ogs file.</li>
<li> run.section(filename, sectionname) to run the specified section in ogs file</li></ul></dd></dl>
<p>See the example in <b>Save Script as an OGS File and Run it</b> section in previous <a href="../../LabTalk/LabTalk/Tutorial_Get_Started.html" title="LabTalk:Tutorial Get Started">Getting Started tutorial</a>.
</p><p><br />
There are also many visible objects. Each workbook and graph window contains basic elements (objects). These objects each have pre-defined names and unique properties and methods that can be controlled using LabTalk. For a complete list of Origin objects, <a href="../../LabTalk/Category/Origin_Object_Reference_(Labtalk).html" title="Category:Origin Object Reference (Labtalk)">view the Help file</a>.
</p><p>E.g. each window has <b>page</b> object for the window. For graph window, there is also at least one <b>layer</b> object. 
</p><p>Have a graph window active and run the following to set window long name and anti-alising on so curves look smooth on screen
</p>
<pre class="lt" style="font-family:monospace;">page.<span style="color: #000080;">longname</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;My Chart&quot;</span>; <span style="color: #008000;">//set window long name</span>
page.<span style="color: #000080;">aa</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>; <span style="color: #008000;">//set anti-alising on</span></pre>
<p>All legend, axis title, label and graphic object also have properties and methods.
</p>
<pre class="lt" style="font-family:monospace;">legend.<span style="color: #000080;">SHOWFRAME</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;<span style="color: #008000;">//Turn legend object frame off by</span>
yl.<span style="color: #000080;">TEXT</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Power&quot;</span>; <span style="color: #008000;">//Rename left Y axis title</span>
yl.<span style="color: #000080;">color</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span>;<span style="color: #008000;">//Set left Y axis title color to blue</span></pre>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Tutorial_Language_Fundamental/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>For such legend, title, label, arrow, line, rectangle, circle objects on graph, hold down <b>Alt</b> key and double click on an object in graph to see the object name on <b>Programming</b> tab. Or in newer versions, right click Graph node in Object Manager window and choose <b>Show Graph Objects</b> to find the name.
</p></td></tr></table>
<p>There is at least one worksheet object <b>wks</b> in workbook. Each worksheet has column sub-objects (<b>col<i>n</i></b>) for each (nth) column.
Start a new worksheet and run the following to fill data, add column, set filter condition and apply the filter
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//fill column A with 600 to 850 with increment of 10</span>
col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> data<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">600</span>,<span style="color: #0000dd;">850</span>,<span style="color: #0000dd;">10</span><span style="color: #000000;">&#41;</span>; 

<span style="color: #008000;">//fill column B with with random numbers, number of data is same as col(A)</span>
col<span style="color: #000000;">&#40;</span>B<span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span>  normal<span style="color: #000000;">&#40;</span>wks.<span style="color: #000080;">col1</span>.<span style="color: #000080;">nrows</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// nrows of wks.col1 object</span>

<span style="color: #008000;">//Add a column</span>
wks.<span style="color: #000080;">addcol</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//addcol() method of wks object</span>
wcol<span style="color: #000000;">&#40;</span><span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>wks.<span style="color: #000080;">ncols</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span>B<span style="color: #000000;">&#41;</span><span style="color: #000080;">/</span>col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//ncols property of wks object</span>
wks.<span style="color: #000080;">col</span><span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>wks.<span style="color: #000080;">ncols</span><span style="color: #000000;">&#41;</span>.<span style="color: #000080;">type</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span> <span style="color: #008000;">//set last column as YError bar</span>

<span style="color: #008000;">//Set filter condition in col2</span>
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">filter</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;x&gt;0&quot;</span>; <span style="color: #008000;">//filter$ property of wks.coln object</span>

<span style="color: #008000;">//Apply the filter so only rows with positive value in col2 will show</span>
wks.<span style="color: #000080;">runfilter</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//runfilter() method of wks object</span></pre>
<p>Note: In above script both wks.col$(wks.ncols).type=3 and wks.col3.type=3 work but using the <b>wks.ncols</b> property is a better coding practice since it refers to last column. The <b>$(wks.ncols)</b> is a numeric substitution notation which means that the value of wks.ncols is evaluated first and then that value gets substituted before the LabTalk statement is executed.
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Tutorial_Language_Fundamental/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>Use <b>objectname.=</b> and <b>objectname.()</b> will dump all all available properties and methods. E.g. to see all wks object properties and methods, run 
</p>
<pre class="lt" style="font-family:monospace;">wks.<span style="color: #000080;">=</span>;
wks.<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</pre>
</td></tr></table>
<h4><a name="X-Functions"></a><span class="mw-headline"><a href="../../LabTalk/Category/X-Functions.html" title="Category:X-Functions">X-Functions</a></span></h4>
<p>Most of the dialogs and functions in Origin are based on X-Functions, which are callable from LabTalk
For example, if you select the <b>Analysis:Signal Processing:Smooth</b> menu, a dialog will open allowing you to smooth irregular and noisy data. You can tell the dialog is built by X-Function since the dialog title shows <b>Dialog name:X-Function name</b>.
</p><p>Not all X-Functions are associated with menu or toolbars so you may not be able to find all X-Functions from GUI. In such cases, the best approach is go to Help: Programming: X-Function and check the X-Function Reference with are organized by category.
</p><p>The syntax to call X-Function is as follows,
<b>xFunctionName [argument1:=&lt;range,name or value&gt; argument2:=&lt;range,name or value&gt; ... ][ -switch];</b>
</p><p>where the arguments and -switches may be optional depending on the X-Function. 
</p><p>The following script uses [<a class="external text" href="../../XFunction/X-Function/Newbook.html">newbook</a> x-function to create a new workbook with arguments to set book name and sheet number
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//The workbook will be named as Test1 (both long and short name)</span>
<span style="color: #008000;">//There'll be 5 worksheets in this workbook</span>
newbook name<span style="color: #000000;">:</span><span style="color: #000080;">=</span>Test1 sheet<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">5</span> option<span style="color: #000000;">:</span><span style="color: #000080;">=</span>lsname;</pre>
<p>X-Functions have a number of input and output variables. In this case, we specified name, sheet and option. For those we skipped, default value will be used.
</p><p>Some useful switch options to find info. of the x-function
</p>
<pre class="lt" style="font-family:monospace;">newbook <span style="color: #000080;">-</span>h;  <span style="color: #008000;">//dump help</span>
newbook <span style="color: #000080;">-</span>hv; <span style="color: #008000;">//dump variable list</span>
newbook <span style="color: #000080;">-</span>he; <span style="color: #008000;">//dump script example</span>
newbook <span style="color: #000080;">-</span>d; <span style="color: #008000;">//open X-Function dialog</span></pre>
<h4><a name="Macro"></a><span class="mw-headline"><a href="../../LabTalk/LabTalk/Macro_Statements.html" title="LabTalk:Macro Statements">Macro</a></span></h4>
<p>Associate a name with given script which can later be used as a command and include arguments.
</p><p>Define a simple macro and use it.
Run the following script first to define a macro named as <i>testmacro</i>
</p>
<pre class="lt" style="font-family:monospace;">def testmacro
<span style="color: #000000;">&#123;</span>
	repeat <span style="color: #000080;">%</span>1
	<span style="color: #000000;">&#123;</span>
		repeat <span style="color: #000080;">%</span>2
		<span style="color: #000000;">&#123;</span>
			type <span style="color: #000080;">-</span>l <span style="color: #ff00ff;">&quot;=&quot;</span>;
		<span style="color: #000000;">&#125;</span>
		type;
	<span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>
<p>Use the macro
</p>
<pre class="lt" style="font-family:monospace;">testmacro <span style="color: #0000dd;">2</span> <span style="color: #0000dd;">64</span>; <span style="color: #008000;">// 2 is substituted for&#160;%1 and 64 for&#160;%2</span></pre>
<h4><a name="Origin_C_Functions"></a><span class="mw-headline"><a href="../../LabTalk/Category/Origin_C_Functions.html" title="Category:Origin C Functions">Origin C Functions</a></span></h4>
<p>A function properly implemented with <a class="external text" href="../../OriginC/Category/Origin_C_Programming_Guide.html">Origin C</a> can be called by LabTalk script.
</p>
<ol>
<li>Open Code Builder and choose File: New...
<li>Choose C File and set File Name test and click OK.
<li>Start a new line at the bottom of the file and paste the following OC code
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">double</span> CubeRoot<span style="color: #000000;">&#40;</span><span style="color: #0000ff;">double</span> x<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span>x <span style="color: #000080;">&lt;</span> <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>
		<span style="color: #0000ff;">return</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">10</span><span style="color: #000040;">^</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">log10</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">abs</span><span style="color: #000000;">&#40;</span>x<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span><span style="color: #000040;">/</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #0000ff;">else</span>
		<span style="color: #0000ff;">return</span> <span style="color: #0000dd;">10</span><span style="color: #000040;">^</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">log10</span><span style="color: #000000;">&#40;</span>x<span style="color: #000000;">&#41;</span><span style="color: #000040;">/</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<li>Choose Build: Rebuild All.
<li> In Script window, run the following script to call the CubeRoot() function.
<pre class="lt" style="font-family:monospace;">double aa <span style="color: #000080;">=</span> CubeRoot<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">125</span><span style="color: #000000;">&#41;</span>; 
aa <span style="color: #000080;">=</span>&#160;;<span style="color: #008000;">//It should return aa=5</span>
Col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>data<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">100</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//fill column A with 1, 2, ... 100</span>
col<span style="color: #000000;">&#40;</span>B<span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>aa<span style="color: #000080;">*</span>CubeRoot<span style="color: #000000;">&#40;</span>Col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//set col(B) value by function and variable</span></pre>
</ol>


