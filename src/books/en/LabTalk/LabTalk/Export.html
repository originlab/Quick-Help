<h1 class="firstHeading">4.4.1 Export Graphs/Data/Videos</h1><p class='urlname' style='display: none'>general-export</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Export_Graphs"><span class="tocnumber">1</span> <span class="toctext">Export Graphs</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Export_graphs_using_Project_Explorer_folder_hierarchy_as_export_path"><span class="tocnumber">1.1</span> <span class="toctext">Export graphs using Project Explorer folder hierarchy as export path</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-3"><a href="#Export_Data"><span class="tocnumber">2</span> <span class="toctext">Export Data</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Export_all_worksheets_in_all_workbooks_in_all_folders_as_text_files"><span class="tocnumber">2.1</span> <span class="toctext">Export all worksheets in all workbooks in all folders as text files</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="#Export_Videos"><span class="tocnumber">3</span> <span class="toctext">Export Videos</span></a></li>
</ul>
</div>

<h2><a name="Export_Graphs"></a><span class="mw-headline">Export Graphs</span></h2>
<h3><a name="Export_graphs_using_Project_Explorer_folder_hierarchy_as_export_path"></a><span class="mw-headline">Export graphs using Project Explorer folder hierarchy as export path</span></h3>
<p>In this example, we will show how to create the same sub-folder hierarchy according to project folder structure, and export graphs into their own folders named after graph window long name. 
</p><p><b>Solution for Origin 2016 and later</b>:
<br />
</p>
<pre class="lt" style="font-family:monospace;">doc <span style="color: #000080;">-</span>e P
<span style="color: #000000;">&#123;</span>
	if<span style="color: #000000;">&#40;</span>page.<span style="color: #000080;">IsEmbedded</span><span style="color: #000080;">==</span><span style="color: #0000dd;">0</span><span style="color: #000080;">&amp;&amp;</span>exist<span style="color: #000000;">&#40;</span><span style="color: #000080;">%</span>H<span style="color: #000000;">&#41;</span><span style="color: #000080;">!</span><span style="color: #000080;">=</span><span style="color: #0000dd;">11</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span><span style="color: #008000;">//Skip over any embedded graphs or Layout windows</span>
		expGraph type<span style="color: #000000;">:</span><span style="color: #000080;">=</span>jpg filename<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;&lt;long name&gt;&quot;</span> path<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;&lt;Project Folder&gt;&lt;PE Path&gt;&quot;</span> theme<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>Original<span style="color: #000080;">&gt;</span> tr.<span style="color: #000080;">Margin</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>;
	<span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>
<p><b>Solution for Origin 2015 and earlier</b>:
<br />
</p>
<pre class="lt" style="font-family:monospace;">doc <span style="color: #000080;">-</span>e P <span style="color: #008000;">//loop over all graph-like objects</span>
<span style="color: #000000;">&#123;</span>
	if<span style="color: #000000;">&#40;</span>page.<span style="color: #000080;">IsEmbedded</span><span style="color: #000080;">==</span><span style="color: #0000dd;">0</span><span style="color: #000080;">&amp;&amp;</span>exist<span style="color: #000000;">&#40;</span><span style="color: #000080;">%</span>H<span style="color: #000000;">&#41;</span><span style="color: #000080;">!</span><span style="color: #000080;">=</span><span style="color: #0000dd;">11</span><span style="color: #000000;">&#41;</span>  <span style="color: #008000;">//Skip over any embedded graphs or Layout windows</span>
	<span style="color: #000000;">&#123;</span>
		string proj_path<span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #000080;">%</span>X; <span style="color: #008000;">//Get windows path of saved project;</span>
		<span style="color: #008000;">//type &quot;the project path is:&quot;+proj_path$;</span>
		window <span style="color: #000080;">-</span>a <span style="color: #000080;">%</span>H;	
		string graph_fullPath<span style="color: #000080;">$</span>;
		pe_path path<span style="color: #000000;">:</span><span style="color: #000080;">=</span>graph_fullPath<span style="color: #000080;">$</span>; <span style="color: #008000;">//Get graph project explorer path;</span>
		<span style="color: #000080;">%</span>A<span style="color: #000080;">=</span>graph_fullPath<span style="color: #000080;">$</span>;
		string graph_path<span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #000080;">%</span><span style="color: #000000;">&#91;</span><span style="color: #000080;">%</span>A,<span style="color: #000080;">&gt;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#93;</span>; <span style="color: #008000;">//remove the root folder name from path</span>
		<span style="color: #008000;">//type &quot;the graph path is:&quot;+graph_path$;</span>
		<span style="color: #008000;">//type &quot;graph title is:&quot;+%H;</span>
		string path<span style="color: #000080;">$</span><span style="color: #000080;">=</span>proj_path<span style="color: #000080;">$</span><span style="color: #000080;">+</span>graph_Path<span style="color: #000080;">$</span>; <span style="color: #008000;">//Concatenate above strings to create export folder;</span>
		path.<span style="color: #000080;">Replace</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;/&quot;</span>,<span style="color: #ff00ff;">&quot;\&quot;</span><span style="color: #000000;">&#41;</span>;
		expGraph type<span style="color: #000000;">:</span><span style="color: #000080;">=</span>jpg filename<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;&lt;long name&gt;&quot;</span> path<span style="color: #000000;">:</span><span style="color: #000080;">=</span>path<span style="color: #000080;">$</span> theme<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>Original<span style="color: #000080;">&gt;</span> tr.<span style="color: #000080;">Margin</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>;
	<span style="color: #000000;">&#125;</span>;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Export_Data"></a><span class="mw-headline">Export Data</span></h2>
<h3><a name="Export_all_worksheets_in_all_workbooks_in_all_folders_as_text_files"></a><span class="mw-headline">Export all worksheets in all workbooks in all folders as text files</span></h3>
<p>This example is to export all sheets in all workbooks within the project to a specified navigated path and name those data files as "WorkbookName_WorksheetName".
</p>
<pre class="lt" style="font-family:monospace;">fdlog.<span style="color: #000080;">openpath</span><span style="color: #000000;">&#40;</span>B<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// choose directory to store files</span>

doc <span style="color: #000080;">-</span>e W<span style="color: #000000;">&#123;</span>   <span style="color: #008000;">// loop over all workbooks in project</span>
    
       doc <span style="color: #000080;">-</span>e LW <span style="color: #008000;">// loop over all worksheets in workbook</span>
            <span style="color: #000000;">&#123;</span>
              string temp<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> wks.<span style="color: #000080;">name</span><span style="color: #000080;">$</span>; <span style="color: #008000;">// Get worksheet short name</span>
           <span style="color: #008000;">// string temp$ = wks.longname$; // Run this line to get worksheet long name</span>
              expASC type<span style="color: #000000;">:</span><span style="color: #000080;">=</span>text path<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000080;">%</span>B<span style="color: #000080;">%</span>H_<span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>temp<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span> shortname<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>; <span style="color: #008000;">// Export files as .txt files with column short names exported</span>
            <span style="color: #000000;">&#125;</span>;
<span style="color: #000000;">&#125;</span></pre>
<p>To loop over current active folder, you can replace <a href="../../LabTalk/LabTalk/Document_(command)&amp;action=edit&amp;redlink=1.html" class="new" title="LabTalk:Document (command) (page does not exist)"><i>doc -e W</i></a> with <a href="../../LabTalk/LabTalk/Document_(command)&amp;action=edit&amp;redlink=1.html" class="new" title="LabTalk:Document (command) (page does not exist)"><i>doc -ef W</i></a>. More examples of looping over different objects in Origin can be found <a href="../../LabTalk/Script/Looping_Over_Objects.html" title="Script:Looping Over Objects">here</a>.
</p><p>A variation on this example exports all worksheet columns to .dat files and organizes them using the project's <a class="external text" href="../../UserGuide/UserGuide/Project_Explorer.html"><b>Project Explorer</b></a> folder structure:
</p>
<pre class="lt" style="font-family:monospace;">string fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;%YMap Data.opju&quot;</span>;
doc <span style="color: #000080;">-</span>o <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>fname<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// opens project User Files\Map Data.opju</span>

doc <span style="color: #000080;">-</span>e W<span style="color: #000000;">&#123;</span>   <span style="color: #008000;">// loop over all workbooks in project</span>
    
       doc <span style="color: #000080;">-</span>e LW <span style="color: #008000;">// loop over all worksheets in workbook</span>
            <span style="color: #000000;">&#123;</span>
              string temp<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> wks.<span style="color: #000080;">name</span><span style="color: #000080;">$</span>; <span style="color: #008000;">// Get worksheet short name</span>
           <span style="color: #008000;">// string temp$ = wks.longname$; // Run this line to get worksheet long name</span>
              expASC path<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;&lt;Project Folder&gt;&lt;PE Path&gt;%(temp$)&quot;</span> shortname<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>; <span style="color: #008000;">// Export and organize files using PE folder structure</span>
            <span style="color: #000000;">&#125;</span>;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Export_Videos"></a><span class="mw-headline">Export Videos</span></h2>
<p class="version" >Minimum Origin Version Required: 9.0 SR0</p>
<p>This example creates a new matrixbook, set its values, and plots the matrix as a contour graph. This process will then loop 50 times and each time the matrix values will be adjusted and the graph updated. Each generated graph will be added to the video as a frame. When finished, a video with 50 frames will have been created.
</p><p>This example will show you how to change graphs in real-time and use the <a href="../../LabTalk/LabTalk/Vw_(object).html" title="LabTalk:Vw (object)">vw_(object)</a> in Labtalk script to create a video. Change the value "d:\test.avi" to work on your system.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create a matrix window</span>
string matbk<span style="color: #000080;">$</span>;
newbook mat<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> result<span style="color: #000000;">:</span><span style="color: #000080;">=</span>matbk<span style="color: #000080;">$</span>;
 
<span style="color: #008000;">// Point to matrix object in the sheet</span>
range rmat <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>matbk<span style="color: #000080;">$</span><span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #0000dd;">1</span>;
 
<span style="color: #008000;">// Set dimensions values and create a contour plot </span>
mdim c<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">100</span> r<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">100</span>;
double a<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>; 
string formula<span style="color: #000080;">$</span>; formula<span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;i*sin(a*x)-j*cos(y/a)&quot;</span>; 
msetvalue im<span style="color: #000000;">:</span><span style="color: #000080;">=</span>rmat formula<span style="color: #000000;">:</span><span style="color: #000080;">=</span>formula<span style="color: #000080;">$</span>; 
wo <span style="color: #000080;">-</span>p <span style="color: #0000dd;">226</span> contour; 
 
<span style="color: #008000;">// Customize contour plot </span>
layer.<span style="color: #000080;">cmap</span>.<span style="color: #000080;">zmin</span><span style="color: #000080;">=</span><span style="color: #000080;">-</span><span style="color: #0000dd;">250</span>;
layer.<span style="color: #000080;">cmap</span>.<span style="color: #000080;">zmax</span><span style="color: #000080;">=</span><span style="color: #0000dd;">250</span>;
layer.<span style="color: #000080;">cmap</span>.<span style="color: #000080;">nummajorlevels</span><span style="color: #000080;">=</span><span style="color: #0000dd;">10</span>; 
layer.<span style="color: #000080;">cmap</span>.<span style="color: #000080;">numminorlevels</span><span style="color: #000080;">=</span><span style="color: #0000dd;">9</span>;
layer.<span style="color: #000080;">cmap</span>.<span style="color: #000080;">setlevels</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>; 
layer.<span style="color: #000080;">cmap</span>.<span style="color: #000080;">updatescale</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; 
layer.<span style="color: #000080;">cmap</span>.<span style="color: #000080;">load</span><span style="color: #000000;">&#40;</span>Rainbow.<span style="color: #000080;">PAL</span><span style="color: #000000;">&#41;</span>;
 
<span style="color: #008000;">// Choose a codec. Any Four Character Code can be used but</span>
<span style="color: #008000;">// not all codecs are available on all computers.</span>
<span style="color: #008000;">// Here are a few examples:</span>
int codec <span style="color: #000080;">=</span> vw.<span style="color: #000080;">FourCC</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// uncompressed</span>
<span style="color: #008000;">//int codec = vw.FourCC(1, 0, 0, 0); // Microsoft Run Length Encoded</span>
<span style="color: #008000;">//int codec = vw.FourCC('c', 'v', 'i', 'd'); // Cinepak</span>
<span style="color: #008000;">//int codec = vw.FourCC('F', 'M', 'P', '4'); // MPEG4</span>
 
<span style="color: #008000;">// Create video writer. (fileName, codec, framesPerSec, width, height)</span>
int err <span style="color: #000080;">=</span> vw.<span style="color: #000080;">Create</span><span style="color: #000000;">&#40;</span>d<span style="color: #000000;">:</span>\test.<span style="color: #000080;">avi</span>, codec, <span style="color: #0000dd;">15</span>, <span style="color: #0000dd;">1024</span>, <span style="color: #0000dd;">768</span><span style="color: #000000;">&#41;</span>;
if<span style="color: #000000;">&#40;</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> err <span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	for<span style="color: #000000;">&#40;</span> a<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>; a<span style="color: #000080;">&lt;=</span><span style="color: #0000dd;">1.5</span>; a<span style="color: #000080;">+</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0.01</span> <span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		<span style="color: #000080;">%</span>C <span style="color: #000080;">-</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
		formula<span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;i*sin(a*x)-j*cos(y/a)+grnd()&quot;</span>;
		msetvalue im<span style="color: #000000;">:</span><span style="color: #000080;">=</span>rmat formula<span style="color: #000000;">:</span><span style="color: #000080;">=</span>formula<span style="color: #000080;">$</span>;
 
		<span style="color: #008000;">// Wait for graph window to redraw.</span>
		<span style="color: #008000;">// This allows watching the animation while creating the video file.</span>
		sec <span style="color: #000080;">-</span>pw <span style="color: #000080;">%</span>h;
 
		<span style="color: #008000;">// Write graph to video as a single frame.</span>
		err <span style="color: #000080;">=</span> vw.<span style="color: #000080;">WriteGraph</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
		if<span style="color: #000000;">&#40;</span> err <span style="color: #000000;">&#41;</span>
			break;
	<span style="color: #000000;">&#125;</span>
 
	<span style="color: #008000;">// Release the video writer.</span>
	vw.<span style="color: #000080;">Release</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
 
	if<span style="color: #000000;">&#40;</span> err <span style="color: #000000;">&#41;</span>
		type <span style="color: #ff00ff;">&quot;WriteGraph error $(err)&quot;</span>;
<span style="color: #000000;">&#125;</span>
else
	type <span style="color: #ff00ff;">&quot;VideoWriter Create error $(err).&quot;</span>;</pre>
<p><b>Note:</b> For more details about codecs, please refer to <a href="../../LabTalk/LabTalk/FourCC_Table.html" title="LabTalk:FourCC Table">FourCC Table</a>.
</p>





