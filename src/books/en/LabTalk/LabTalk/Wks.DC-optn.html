<h1 class="firstHeading">3.7.5.104.6 wks.DC.optn$</h1><p><span class="OIndex" style="display:none">optn</span>
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Syntax"><span class="tocnumber">1</span> <span class="toctext">Syntax</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Access"><span class="tocnumber">2</span> <span class="toctext">Access</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Description"><span class="tocnumber">3</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Examples"><span class="tocnumber">4</span> <span class="toctext">Examples</span></a></li>
</ul>
</div>

<h2><a name="Syntax"></a><span class="mw-headline">Syntax</span></h2>
<pre class="lt" style="font-family:monospace;">wks.<span style="color: #000080;">DC</span>.<span style="color: #000080;">optn</span><span style="color: #000080;">$</span></pre>
<h2><a name="Access"></a><span class="mw-headline">Access</span></h2>
<dl><dt>Read/write</dt>
<dt>string</dt></dl>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>Get or set connector settings as a string. Supported only for CSV, Excel etc connector types using its own GetN dialog.
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p><i><b>EX1</b></i>
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// import a “*.pil” file by specifying the main header ending text.</span>
String fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> “C<span style="color: #000000;">:</span>\Downloads\MyFiles\pilFiles\testfile<span style="color: #000080;">-</span><span style="color: #0000dd;">20201204</span>_151244.<span style="color: #000080;">pil</span>”;
dlgfile group<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;*.pil&quot;</span>;
wbook.<span style="color: #000080;">dc</span>.<span style="color: #000080;">add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;CSV&quot;</span><span style="color: #000000;">&#41;</span>;
wks.<span style="color: #000080;">dc</span>.<span style="color: #000080;">source</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> fname<span style="color: #000080;">$</span>;
Tree tr<span style="color: #000080;">=</span>wks.<span style="color: #000080;">dc</span>.<span style="color: #000080;">optn</span><span style="color: #000080;">$</span>;
tr.<span style="color: #000080;">settings</span>.<span style="color: #000080;">mainheader</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; <span style="color: #008000;">// Main header lines: -1=Auto, otherwise number of lines</span>
tr.<span style="color: #000080;">settings</span>.<span style="color: #000080;">endmh</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;&gt;END OF HEADER&quot;</span>;
tr.<span style="color: #000080;">settings</span>.<span style="color: #000080;">heading</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; <span style="color: #008000;">// Data has column name: 0=No, 1=Yes</span>
tr.<span style="color: #000080;">settings</span>.<span style="color: #000080;">unit</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; <span style="color: #008000;">// Data has units: 0=No, 1=Yes</span>
tr.<span style="color: #000080;">settings</span>.<span style="color: #000080;">comment1</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;<span style="color: #008000;">//no comment line</span>
tr.<span style="color: #000080;">tostring</span><span style="color: #000000;">&#40;</span>wks.<span style="color: #000080;">dc</span>.<span style="color: #000080;">optn</span><span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>;
wks.<span style="color: #000080;">dc</span>.<span style="color: #000080;">import</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</pre>
<p><i><b>EX2</b></i>
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//partial import HTML table and rename sheet by trimming prefix &quot;_&quot;</span>
newbook;
wbook.<span style="color: #000080;">dc</span>.<span style="color: #000080;">add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;HTML&quot;</span><span style="color: #000000;">&#41;</span>;
wbook.<span style="color: #000080;">dc</span>.<span style="color: #000080;">source</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;https://www.extremeweatherwatch.com/cities/boston/year-1993&quot;</span>;
wks.<span style="color: #000080;">dc</span>.<span style="color: #000080;">sel</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Tables/_2&quot;</span>;
Tree tr <span style="color: #000080;">=</span> wks.<span style="color: #000080;">dc</span>.<span style="color: #000080;">optn</span><span style="color: #000080;">$</span>;
tr.<span style="color: #000080;">partial_col</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;2 3&quot;</span>; <span style="color: #008000;">//partial import 2&amp;3 columns</span>
tr.<span style="color: #000080;">nameoptn</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;2:0&quot;</span>; <span style="color: #008000;">//trim head &quot;_&quot;</span>
tr.<span style="color: #000080;">ToString</span><span style="color: #000000;">&#40;</span>wks.<span style="color: #000080;">dc</span>.<span style="color: #000080;">optn</span><span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>;
wks.<span style="color: #000080;">dc</span>.<span style="color: #000080;">import</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</pre>






