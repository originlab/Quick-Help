<h1 class="firstHeading">3.5.7.11 Text/Format</h1><p class='urlname' style='display: none'>Text-Format-func</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1"><a href="#Syntax"><span class="tocnumber">2</span> <span class="toctext">Syntax</span></a></li>
<li class="toclevel-1"><a href="#Parameters"><span class="tocnumber">3</span> <span class="toctext">Parameters</span></a></li>
<li class="toclevel-1"><a href="#Return"><span class="tocnumber">4</span> <span class="toctext">Return</span></a></li>
<li class="toclevel-1"><a href="#Examples"><span class="tocnumber">5</span> <span class="toctext">Examples</span></a></li>
</ul>
</div>

<h2 class="ref"><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>Text function and Format function are equivalent except the default format used when the optional parameter <b>fmt$</b> is missing, see the details in the Parameters section below. Please note that Text function is accessible from <b>Set Column Value: F(x)</b> menu while Format is not. However, both work via LabTalk script. If you are using version 9.1 or later, we advise using the Text function.
</p><p>Text and Format convert double to string using one of  <a href="../../LabTalk/LabTalk/Origin_Formats.html" title="LabTalk:Origin Formats">these LabTalk formatting options</a>.
</p>
<h2 class="ref"><a name="Syntax"></a><span class="mw-headline">Syntax</span></h2>
<pre class="lt" style="font-family:monospace;">string dataString <span style="color: #000080;">=</span> Text<span style="color: #000000;">&#40;</span>double d<span style="color: #000000;">&#91;</span>, string fmt<span style="color: #000080;">$</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">$</span></pre>
<pre class="lt" style="font-family:monospace;">string dataString <span style="color: #000080;">=</span> Format<span style="color: #000000;">&#40;</span>double d<span style="color: #000000;">&#91;</span>, string fmt<span style="color: #000080;">$</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">$</span></pre>
<h2 class="ref"><a name="Parameters"></a><span class="mw-headline">Parameters</span></h2>
<p><b>d</b>
</p>
<dl><dd> A numeric of type double.</dd></dl>
<p><b>fmt$</b>
</p>
<dl><dd> A string specifying the output format. Option fmt$ formats output and will take <a href="../../LabTalk/LabTalk/Origin_Formats.html" title="LabTalk:Origin Formats">these values</a>. If fmt$ is not specified, Text function will use the column's format, while Format function will use Origin's global setting (which can be found by Preference: Option - Numeric Format). If fmt$ is set to the empty string "", both functions will use @SD significant digits, where @SD is a system variable (whose current value can be obtained by entering <code>@SD=;</code> in the Script Window).  For instance, the value "*3" for the string fmt$ will yield 3 significant digits in the returned string.  Use "*" to use Origin's global setting.</dd></dl>
<h2 class="ref"><a name="Return"></a><span class="mw-headline">Return</span></h2>
<p>Return the numeric <i>data</i> as a string in the format specified by fmt$.
</p>
<h2 class="ref"><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// specifying 3 significant figures</span>
string yy<span style="color: #000080;">$</span><span style="color: #000080;">=</span>Text<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2.01232</span>, <span style="color: #ff00ff;">&quot;*3&quot;</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">$</span>;  
yy<span style="color: #000080;">$</span><span style="color: #000080;">=</span>; <span style="color: #008000;">// will return 2.01</span>
<span style="color: #008000;">// convert input numeric into engineering format, with 3 significant figures</span>
string str<span style="color: #000080;">$</span><span style="color: #000080;">=</span>Format<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">123000</span>, <span style="color: #ff00ff;">&quot;E*3&quot;</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">$</span>;
str<span style="color: #000080;">$</span><span style="color: #000080;">=</span>; <span style="color: #008000;">//will return 123k</span></pre>
<pre class="lt" style="font-family:monospace;">@SD<span style="color: #000080;">=</span>;  <span style="color: #008000;">// get the current value stored in @SD</span>
@SD<span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>; <span style="color: #008000;">// reset the value in @SD to 2</span>

<span style="color: #008000;">// call text using the system default, @SD</span>
string yy<span style="color: #000080;">$</span><span style="color: #000080;">=</span>Text<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2.456789</span>, <span style="color: #ff00ff;">&quot;&quot;</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">$</span>;  
yy<span style="color: #000080;">$</span><span style="color: #000080;">=</span>; <span style="color: #008000;">// returns YY = 2.5</span></pre>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// convert date(d/mm/yyyy) to string in U.S. Regional settings format.</span>
string yy<span style="color: #000080;">$</span><span style="color: #000080;">=</span>Text<span style="color: #000000;">&#40;</span>Date<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">7</span><span style="color: #000080;">/</span><span style="color: #0000dd;">10</span><span style="color: #000080;">/</span><span style="color: #0000dd;">2014</span><span style="color: #000000;">&#41;</span>,D1<span style="color: #000000;">&#41;</span><span style="color: #000080;">$</span>;
yy<span style="color: #000080;">$</span><span style="color: #000080;">=</span>; <span style="color: #008000;">// returns yy = Thursday, July 10, 2014</span></pre>






