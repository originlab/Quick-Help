<h1 class="firstHeading">2.4.2.1 Loading and Compiling Origin C Functions</h1><p class='urlname' style='display: none'>Loading-and-Compiling-OC-Function</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Loading_and_Compiling_Origin_C_Function_or_WorkspaceCompile_Origin_CLoad_Origin_C"><span class="tocnumber">1</span> <span class="toctext">Loading and Compiling Origin C Function or Workspace<span class="OIndex" style="display:none">Compile Origin C</span><span class="OIndex" style="display:none">Load Origin C</span></span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Example"><span class="tocnumber">1.1</span> <span class="toctext">Example</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-3"><a href="#Adding_Origin_C_Source_Files_to_System_Folder"><span class="tocnumber">2</span> <span class="toctext">Adding Origin C Source Files to System Folder</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Adding_Origin_C_Files_to_Project_.28OPJ.29"><span class="tocnumber">3</span> <span class="toctext">Adding Origin C Files to Project (OPJ)</span></a></li>
</ul>
</div>

<h2><a name="Loading_and_Compiling_Origin_C_Function_or_WorkspaceCompile_Origin_CLoad_Origin_C"></a><span class="mw-headline">Loading and Compiling Origin C Function or Workspace<span class="OIndex" style="display:none">Compile Origin C</span><span class="OIndex" style="display:none">Load Origin C</span></span></h2>
<p>Before you call Origin C function from Origin, the function must be compiled and linked in the current Origin session. 
</p><p>To manually compile and link a source file, go to Code Builder first. Right click <b>User</b> node (or Project, etc. node when applies) on left panel to add the .c or .cpp file. Then use the toolbar buttons or menus to compile and build the it. 
</p><p>To programmatically compile and link a source file, or to programmatically build a workspace from a LabTalk script use the <b>run.loadOC</b> method of the LabTalk <a href="../../LabTalk/LabTalk/Run_(object).html" title="LabTalk:Run (object)"><b>run</b></a> object. 
</p>
<pre class="lt" style="font-family:monospace;">    err <span style="color: #000080;">=</span> run.<span style="color: #000080;">LoadOC</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;myFile&quot;</span>,<span style="color: #000000;">&#91;</span>option<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span>;</pre>
<h3><a name="Example"></a><span class="mw-headline">Example</span></h3>
<p>Use option to scan the .h files in the OC file being loaded, and all other dependent OC files are also loaded automatically:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Load and compile Origin C function in the file iw_filter.c</span>
<span style="color: #008000;">// with the option=16, so to also load all dependent Orign C</span>
<span style="color: #008000;">// files by scanning for .h files included in iw_filter.c</span>
if<span style="color: #000000;">&#40;</span>run.<span style="color: #000080;">LoadOC</span><span style="color: #000000;">&#40;</span>OriginLab\iw_filter.<span style="color: #000080;">c</span>, <span style="color: #0000dd;">16</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">!</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	type <span style="color: #ff00ff;">&quot;Failed to load iw_filter.c!&quot;</span>;
	return <span style="color: #0000dd;">0</span>;
<span style="color: #000000;">&#125;</span></pre>
<p>Now, open <b>Code Builder</b> by menu <b>View: Code Builder</b>, and in the <b>Workspace</b> panel (if not see this panel, open by <b>View: Workspace</b> menu item in <b>Code Builder</b>) of <b>Code Builder</b>, you can see the <i>iw_filter.c</i> file is under the <b>Temporary</b> folder.
</p>
<h2><a name="Adding_Origin_C_Source_Files_to_System_Folder"></a><span class="mw-headline">Adding Origin C Source Files to System Folder</span></h2>
<p>Once a file has been opened in Code Builder, one can simply drag and drop the file to the <b>System</b> branch of the Code Builder workspace. This will then ensure that the file will be loaded and compiled in each new Origin session. For more details, please refer to <a class="external text" href="../../UserGuide/UserGuide/The_Code_Builder.html">Code Builder</a> documentation.
</p><p>You can programmatically add a source file to the system folder so that it will be available anytime Origin is run.
</p>
<pre class="lt" style="font-family:monospace;">run.<span style="color: #000080;">addOC</span><span style="color: #000000;">&#40;</span>C<span style="color: #000000;">:</span>\Program Files\Originlab\Source Code\MyFunctions.<span style="color: #000080;">c</span><span style="color: #000000;">&#41;</span>;</pre>
<p>This can be useful when distributing tools to users or making permanently available functions that have been designed to work with <a class="external text" href="../../UserGuide/UserGuide/Create_a_User_Defined_Function_for_Set_Column_Values.html">Set Column Values</a>.
</p>
<h2><a name="Adding_Origin_C_Files_to_Project_.28OPJ.29"></a><span class="mw-headline">Adding Origin C Files to Project (OPJ)</span></h2>
<p>Origin C files (or files with any extension/type) can also be appended to the Origin project (OPJ) file itself. The file will then be saved with the OPJ and extracted when the project is opened. In case of Origin C files, the file is then also compiled and linked, and functions within the file are available for access. To append a file to the project, simply drag and drop the file to the <b>Project</b> branch of Code Builder or right-click on Project branch and add the file. For more details, please refer to <a class="external text" href="../../UserGuide/UserGuide/The_Code_Builder.html">Code Builder</a> documentation.
</p>





