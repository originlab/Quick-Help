<h1 class="firstHeading">3.5.8.22 WCol</h1><p class='urlname' style='display: none'>WCol-func</p>
<p>The wcol(colNumExpression) function can be used either on the left side or on the right side of an assignment. The wcol function always expects an argument evaluating to a column number (1 .. N).  
</p><p>When wcol() is on the left side of the assignment, the right hand side should normally be a vector, not a scalar value. In the special case where a column has an assigned size you can assign a scalar value which gets replicated for the entire column:
</p>
<pre class="lt" style="font-family:monospace;">wcol<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> data<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span>,<span style="color: #0000dd;">100</span>,<span style="color: #0000dd;">5</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Fills column one 0 to 100 in increments of 5</span>
wcol<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; <span style="color: #008000;">// Does nothing if column 2 is empty</span>
wcol<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> wcol<span style="color: #000000;">&#40;</span>int<span style="color: #000000;">&#40;</span>pi<span style="color: #000000;">&#41;</span><span style="color: #000080;">-</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// expression int(pi)-2 is 1, therefore this is same as wcol(2)=wcol(1); </span>
wcol<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; <span style="color: #008000;">// Since there is already value in wol(2), it will replace all values with 1</span></pre>
<p><b>Note:</b> In the Wcol(colNumExpression) function , since the argument is always interpreted as an expression, you can use any expression which evaluates to a positive integer making it useful for looping over columns with a variable for example.  This is different than the <b><a href="../../LabTalk/LabTalk/Col_(function).html" title="LabTalk:Col (function)">col(colNameOrNum)</a></b> function where the argument must a column name or a literal number.
</p>
<h2><a name="Function_Form:"></a><span class="mw-headline"><font color="chocolate">Function Form:</font></span></h2>
<pre class="lt" style="font-family:monospace;"> Wcol<span style="color: #000000;">&#40;</span>colNumExpression<span style="color: #000000;">&#41;</span></pre>
<h2><a name="Examples"></a><span class="mw-headline"><font color="chocolate">Examples</font></span></h2>
<pre class="lt" style="font-family:monospace;">for <span style="color: #000000;">&#40;</span>ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>; ii <span style="color: #000080;">&lt;=</span> <span style="color: #0000dd;">10</span>; ii <span style="color: #000080;">+</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span> 
<span style="color: #000000;">&#123;</span>
      wcol<span style="color: #000000;">&#40;</span>ii<span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> data<span style="color: #000000;">&#40;</span>ii, ii<span style="color: #000080;">+</span><span style="color: #0000dd;">10</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span>;</pre>
<p>In this case, if the worksheet contains only two columns, Origin creates new columns - the third to tenth column - as needed. Prior to <font color="red">Origin 8</font>, this script would not create columns if they did not exist.
</p><p>The following case shows how to set data, Long Name, Comments, and user parameters.
</p>
<pre class="lt" style="font-family:monospace;">newbook; 
wcol<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> data<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">6.3</span>, <span style="color: #0000dd;">0.1</span><span style="color: #000000;">&#41;</span>;
wcol<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> sin<span style="color: #000000;">&#40;</span>wcol<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// Set Long Name</span>
wcol<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span>L<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> X;
wcol<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span>L<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Sine;
<span style="color: #008000;">// Set Comments</span>
wcol<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span>C<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;X Values&quot;</span>;
wcol<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span>C<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Sine Function&quot;</span>;
<span style="color: #008000;">// Show the 1st user parameter row</span>
wks.<span style="color: #000080;">userParam1</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
<span style="color: #008000;">// Rename the user-defined worksheet header row</span>
wks.<span style="color: #000080;">userParam1</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Purpose;
<span style="color: #008000;">// Set the first parameter</span>
wcol<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span>Purpose<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Graphing;</pre>
<h2><a name="See_Also"></a><span class="mw-headline"><font color="chocolate">See Also</font></span></h2>
<ul><li> <a href="../../LabTalk/LabTalk/Col_(function).html" title="LabTalk:Col (function)">LabTalk:Col (function)</a></li></ul>






