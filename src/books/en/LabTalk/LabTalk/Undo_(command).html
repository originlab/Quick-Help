<h1 class="firstHeading">3.3.2.63 Undo</h1><p class='urlname' style='display: none'>Undo-cmd</p>
<p>This command provides a LabTalk interface to Origin's <b>Edit: Undo</b> menu command.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Syntax:"><span class="tocnumber">1</span> <span class="toctext">Syntax:</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Options:"><span class="tocnumber">2</span> <span class="toctext">Options:</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#no_option.3B_Undo_the_last_action"><span class="tocnumber">2.1</span> <span class="toctext">no option; Undo the last action</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#dataset.3B_Backup_dataset"><span class="tocnumber">2.2</span> <span class="toctext">dataset; Backup dataset</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#-dr.3B_Create_an_internal_copy_of_specified_dataset_range"><span class="tocnumber">2.3</span> <span class="toctext">-dr; Create an internal copy of specified dataset range</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#-dx.3B_Create_an_internal_copy_of_dataset"><span class="tocnumber">2.4</span> <span class="toctext">-dx; Create an internal copy of <i>dataset</i></span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#-wa.3B_Create_an_internal_copy_of_the_datasets_in_the_active_worksheet"><span class="tocnumber">2.5</span> <span class="toctext">-wa; Create an internal copy of the datasets in the active worksheet</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#-wc.3B_Create_an_internal_copy_of_the_datasets_in_the_specified_worksheet_wks"><span class="tocnumber">2.6</span> <span class="toctext">-wc; Create an internal copy of the datasets in the specified worksheet <i>wks</i></span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#-wr.3B_Create_an_internal_copy_of_the_selected_dataset_range_in_the_active_worksheet"><span class="tocnumber">2.7</span> <span class="toctext">-wr; Create an internal copy of the selected dataset range in the active worksheet</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-10"><a href="#Examples:"><span class="tocnumber">3</span> <span class="toctext">Examples:</span></a></li>
<li class="toclevel-1 tocsection-11"><a href="#See_Also:"><span class="tocnumber">4</span> <span class="toctext">See Also:</span></a></li>
</ul>
</div>

<h2><a name="Syntax:"></a><span class="mw-headline"><font color="chocolate">Syntax:</font></span></h2>
<pre class="lt" style="font-family:monospace;">undo <span style="color: #000000;">&#91;</span>option<span style="color: #000000;">&#93;</span> <span style="color: #000000;">&#91;</span>dataset<span style="color: #000000;">&#93;</span></pre>
<p>For an understanding of usage, review the sample scripts provided in the Examples section.
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Undo_(command)/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>Some actions in Origin do not add anything to the undo stack and are therefore not reversible. Some other actions will clear the undo stack. To find where this option is currently implemented, search the OGS files for "undo".
</p></td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Undo_(command)/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>For x-functions run from script, we should use <a href="../../LabTalk/LabTalk/X-Function_Execution_Options.html" title="LabTalk:X-Function Execution Options"><b>-u</b> switch</a> to support undo. e.g.
</p>
<pre class="lt" style="font-family:monospace;">wtranspose <span style="color: #000080;">-</span>u ow<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>new<span style="color: #000080;">&gt;</span>;
<span style="color: #008000;">//before running undo command below, can go to Edit menu to check Undo menu is enabled</span>
undo;</pre>
<p><br />
</p></td></tr></table>
<h2><a name="Options:"></a><span class="mw-headline"><font color="chocolate">Options:</font></span></h2>
<h3><a name="no_option.3B_Undo_the_last_action"></a><span class="mw-headline">no option; Undo the last action</span></h3>
<p>Undo the last action as clicking Edit: Undo menu.
</p>
<h3><a name="dataset.3B_Backup_dataset"></a><span class="mw-headline">dataset; Backup dataset</span></h3>
<p><b>Syntax</b>: undo <i>dataset</i>
</p><p>Backup <i>dataset</i> by creating an internal copy of <i>dataset</i>.
</p>
<h3><a name="-dr.3B_Create_an_internal_copy_of_specified_dataset_range"></a><span class="mw-headline">-dr; Create an internal copy of specified dataset range</span></h3>
<p><b>Syntax</b>: undo <b>-dr</b> <i>dataset i1 i2</i>
</p><p>Create an internal copy of the specified dataset range. The dataset range includes rows <i>i1</i> to <i>i2</i>.  To create an internal copy of a single data point, set <i>i1</i> = <i>i2</i>.  
Origin executes this command internally when a data point is deleted from the graph window using the <b>Data: Remove Bad Data Points</b> menu command.
</p>
<h3><a name="-dx.3B_Create_an_internal_copy_of_dataset"></a><span class="mw-headline">-dx; Create an internal copy of <i>dataset</i></span></h3>
<p><b>Syntax</b>: undo <b>-dx</b> <i>dataset</i>
</p><p>Create an internal copy of <i>dataset</i>. Origin executes this command internally when a data plot is (horizontally) translated using the <b>Analysis: Translate: Horizontal</b> menu command.
</p>
<h3><a name="-wa.3B_Create_an_internal_copy_of_the_datasets_in_the_active_worksheet"></a><span class="mw-headline">-wa; Create an internal copy of the datasets in the active worksheet</span></h3>
<p><b>Syntax</b>: undo <b>-wa</b>
</p><p>Create an internal copy of the datasets in the active worksheet. Origin executes this command internally when <b>Edit: Clear Worksheet</b> is selected.
</p>
<h3><a name="-wc.3B_Create_an_internal_copy_of_the_datasets_in_the_specified_worksheet_wks"></a><span class="mw-headline">-wc; Create an internal copy of the datasets in the specified worksheet <i>wks</i></span></h3>
<p><b>Syntax</b>: undo <b>-wc</b> <i>wks</i>
</p><p>Create an internal copy of the datasets in the specified worksheet <i>wks</i>. Origin executes this command internally when <b>Analysis: Sort</b> is selected.
</p>
<h3><a name="-wr.3B_Create_an_internal_copy_of_the_selected_dataset_range_in_the_active_worksheet"></a><span class="mw-headline">-wr; Create an internal copy of the selected dataset range in the active worksheet</span></h3>
<p><b>Syntax</b>: undo <b>-wr</b>
</p><p>Create an internal copy of the selected dataset range in the active worksheet. Origin executes this command internally when <b>Analysis: Normalize</b> is selected.
</p>
<h2><a name="Examples:"></a><span class="mw-headline"><font color="chocolate">Examples:</font></span></h2>
<p><b>Example 1</b>
</p>
<pre class="lt" style="font-family:monospace;">undo Data1_B;    <span style="color: #008000;">// Make an internal copy of Data1_B. </span>
Data1_B<span style="color: #000080;">+</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span>;
undo;    <span style="color: #008000;">// Undo the dataset modification.</span></pre>
<p><b>Example 2</b>
</p>
<pre class="lt" style="font-family:monospace;">undo <span style="color: #000080;">-</span>wr;    <span style="color: #008000;">// Make an internal copy of the selected range. </span>
Data1_B<span style="color: #000080;">/</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span>;
undo;</pre>
<p><b>Example 3</b>
</p>
<pre class="lt" style="font-family:monospace;">undo <span style="color: #000080;">-</span>wc Data1;  <span style="color: #008000;">// Make an internal copy of datasets in Data1. </span>
Data1_A<span style="color: #000080;">+</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span>;
Data1_B<span style="color: #000080;">+</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span>;
undo;    <span style="color: #008000;">// Undo the dataset modification.</span></pre>
<p><b>Example 4</b>
</p>
<pre class="lt" style="font-family:monospace;">undo <span style="color: #000080;">-</span>dr Data1_B <span style="color: #0000dd;">2</span> <span style="color: #0000dd;">2</span>;  <span style="color: #008000;">// Make an internal copy of the second data point. </span>
mark <span style="color: #000080;">-</span>d Data1_B <span style="color: #000080;">-</span>b <span style="color: #0000dd;">2</span> <span style="color: #000080;">-</span>e <span style="color: #0000dd;">2</span>;  <span style="color: #008000;">// Delete the second data point. </span>
undo;</pre>
<h2><a name="See_Also:"></a><span class="mw-headline"><font color="chocolate">See Also:</font></span></h2>
<p><a href="../../LabTalk/LabTalk/Clipboard_(command).html" title="LabTalk:Clipboard (command)">Clipboard (command)</a>
</p>

