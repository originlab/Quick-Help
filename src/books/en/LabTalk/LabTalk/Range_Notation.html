<h1 class="firstHeading">2.3.2.1 Range Notation</h1><p class='urlname' style='display: none'>Range-Notation</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Introduction_to_RangeRange_Notation"><span class="tocnumber">1</span> <span class="toctext">Introduction to Range<span class="OIndex" style="display:none">Range Notation</span></span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Declaration_and_SyntaxDeclare_Range"><span class="tocnumber">1.1</span> <span class="toctext">Declaration and Syntax<span class="OIndex" style="display:none">Declare Range</span></span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Access_Origin_ObjectAccess_Origin_Object_by_RangeRange.2C_Origin_Object"><span class="tocnumber">1.2</span> <span class="toctext">Access Origin Object<span class="OIndex" style="display:none">Access Origin Object by Range</span><span class="OIndex" style="display:none">Range, Origin Object</span></span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4"><a href="#Types_of_Range_Data"><span class="tocnumber">2</span> <span class="toctext">Types of Range Data</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="#Worksheet_DataRange.2C_Worksheet_Data"><span class="tocnumber">2.1</span> <span class="toctext">Worksheet Data<span class="OIndex" style="display:none">Range, Worksheet Data</span></span></a>
<ul>
<li class="toclevel-3 tocsection-6"><a href="#ColumnRange.2C_Column"><span class="tocnumber">2.1.1</span> <span class="toctext">Column<span class="OIndex" style="display:none">Range, Column</span></span></a></li>
<li class="toclevel-3 tocsection-7"><a href="#Page_and_SheetRange.2C_Page_and_Sheet"><span class="tocnumber">2.1.2</span> <span class="toctext">Page and Sheet<span class="OIndex" style="display:none">Range, Page and Sheet</span></span></a></li>
<li class="toclevel-3 tocsection-8"><a href="#Column_SubrangeRange.2C_Column_Subrange"><span class="tocnumber">2.1.3</span> <span class="toctext">Column Subrange<span class="OIndex" style="display:none">Range, Column Subrange</span></span></a></li>
<li class="toclevel-3 tocsection-9"><a href="#Block_of_CellsRange.2C_Block_of_Cells"><span class="tocnumber">2.1.4</span> <span class="toctext">Block of Cells<span class="OIndex" style="display:none">Range, Block of Cells</span></span></a></li>
<li class="toclevel-3 tocsection-10"><a href="#Option_Switch_-vOption_Switches"><span class="tocnumber">2.1.5</span> <span class="toctext">Option Switch <b>-v</b><span class="OIndex" style="display:none">Option Switches</span></span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-11"><a href="#Matrix_DataRange.2C_Matrix_Data"><span class="tocnumber">2.2</span> <span class="toctext">Matrix Data<span class="OIndex" style="display:none">Range, Matrix Data</span></span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Graph_DataRange.2C_Graph_Data"><span class="tocnumber">2.3</span> <span class="toctext">Graph Data<span class="OIndex" style="display:none">Range, Graph Data</span></span></a>
<ul>
<li class="toclevel-3 tocsection-13"><a href="#Option_Switches_-w.2C_-wx.2C_-wy_and_-wzOption_Switche"><span class="tocnumber">2.3.1</span> <span class="toctext">Option Switches <b>-w</b>, <b>-wx</b>, <b>-wy</b> and <b>-wz</b><span class="OIndex" style="display:none">Option Switche</span></span></a></li>
<li class="toclevel-3 tocsection-14"><a href="#Data_Selector_Ranges_on_a_GraphSelect_Range_on_Graph"><span class="tocnumber">2.3.2</span> <span class="toctext">Data Selector Ranges on a Graph<span class="OIndex" style="display:none">Select Range on Graph</span></span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-15"><a href="#Specifying_Subrange_Using_X_Values"><span class="tocnumber">2.4</span> <span class="toctext">Specifying Subrange Using X Values</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#Loose_Dataset"><span class="tocnumber">2.5</span> <span class="toctext">Loose Dataset</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-17"><a href="#Methods_of_Range"><span class="tocnumber">3</span> <span class="toctext">Methods of Range</span></a></li>
<li class="toclevel-1 tocsection-18"><a href="#Unique_Uses_of_Range"><span class="tocnumber">4</span> <span class="toctext">Unique Uses of Range</span></a>
<ul>
<li class="toclevel-2 tocsection-19"><a href="#Manipulating_Range_DataManipulate_RangeRange_Data_Manipulation"><span class="tocnumber">4.1</span> <span class="toctext">Manipulating Range Data<span class="OIndex" style="display:none">Manipulate Range</span><span class="OIndex" style="display:none">Range Data Manipulation</span></span></a></li>
<li class="toclevel-2 tocsection-20"><a href="#Dynamic_Range_AssignmentDynamic_Range_Assignment"><span class="tocnumber">4.2</span> <span class="toctext">Dynamic Range Assignment<span class="OIndex" style="display:none">Dynamic Range Assignment</span></span></a>
<ul>
<li class="toclevel-3 tocsection-21"><a href="#Define_a_New_Range_Using_an_Expression_for_Column_IndexDefine_Range"><span class="tocnumber">4.2.1</span> <span class="toctext">Define a New Range Using an Expression for Column Index<span class="OIndex" style="display:none">Define Range</span></span></a></li>
<li class="toclevel-3 tocsection-22"><a href="#Define_a_New_Range_Using_an_Existing_Range"><span class="tocnumber">4.2.2</span> <span class="toctext">Define a New Range Using an Existing Range</span></a></li>
<li class="toclevel-3 tocsection-23"><a href="#Refer_to_the_Last_Row.2C_Column_and_Sheet_Using_0"><span class="tocnumber">4.2.3</span> <span class="toctext">Refer to the Last Row, Column and Sheet Using 0</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-24"><a href="#X-Function_ArgumentX-Function_Argument.2C_RangeRange.2C_X-Function_Argument"><span class="tocnumber">4.3</span> <span class="toctext">X-Function Argument<span class="OIndex" style="display:none">X-Function Argument, Range</span><span class="OIndex" style="display:none">Range, X-Function Argument</span></span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-25"><a href="#Listing.2C_Deleting.2C_and_Converting_Range_Variables"><span class="tocnumber">5</span> <span class="toctext">Listing, Deleting, and Converting Range Variables</span></a>
<ul>
<li class="toclevel-2 tocsection-26"><a href="#Listing_Range_VariablesList_Range_Variable"><span class="tocnumber">5.1</span> <span class="toctext">Listing Range Variables<span class="OIndex" style="display:none">List Range Variable</span></span></a></li>
<li class="toclevel-2 tocsection-27"><a href="#Deleting_Range_VariablesDelete_Range_Variable"><span class="tocnumber">5.2</span> <span class="toctext">Deleting Range Variables<span class="OIndex" style="display:none">Delete Range Variable</span></span></a></li>
<li class="toclevel-2 tocsection-28"><a href="#Converting_Range_to_UIDRange_to_UIDUID.2C_Range"><span class="tocnumber">5.3</span> <span class="toctext">Converting Range to UID<span class="OIndex" style="display:none">Range to UID</span><span class="OIndex" style="display:none">UID, Range</span></span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-29"><a href="#Special_Notations_for_Range"><span class="tocnumber">6</span> <span class="toctext">Special Notations for Range</span></a>
<ul>
<li class="toclevel-2 tocsection-30"><a href="#Specifying_Multiple_Sheets"><span class="tocnumber">6.1</span> <span class="toctext">Specifying Multiple Sheets</span></a></li>
<li class="toclevel-2 tocsection-31"><a href="#XY_and_XYZ_Range"><span class="tocnumber">6.2</span> <span class="toctext">XY and XYZ Range</span></a></li>
<li class="toclevel-2 tocsection-32"><a href="#XY_Range_using_.23_and_.3F_for_X"><span class="tocnumber">6.3</span> <span class="toctext">XY Range using # and&#160;? for X</span></a></li>
<li class="toclevel-2 tocsection-33"><a href="#Tag_Notations_in_Range_Output"><span class="tocnumber">6.4</span> <span class="toctext">Tag Notations in Range Output</span></a></li>
<li class="toclevel-2 tocsection-34"><a href="#Composite_Range"><span class="tocnumber">6.5</span> <span class="toctext">Composite Range</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="Introduction_to_RangeRange_Notation"></a><span class="mw-headline">Introduction to Range<span class="OIndex" style="display:none">Range Notation</span></span></h2>
<p>Inside your Origin Project, data are stored in four primary places: in worksheet, in matrix, in graph, or as <a href="../../LabTalk/LabTalk/Data_Types_and_Variables.html#Dataset" title="LabTalk:Data Types and Variables">loose dataset</a>. Data in graphs are actually references to columns, matrices or loose datasets in plot form. There is no actual data stored in side graphs. 
</p><p>Before Origin 8.0, data were accessed via <a href="../../LabTalk/LabTalk/Datasets_(object).html" title="LabTalk:Datasets (object)">datasets</a> as well as <a href="../../LabTalk/LabTalk/Cell_(function).html" title="LabTalk:Cell (function)">cell()</a>, <a href="../../LabTalk/LabTalk/Col_(function).html" title="LabTalk:Col (function)">col()</a>, and <a href="../../LabTalk/LabTalk/WCol_(function).html" title="LabTalk:WCol (function)">wcol()</a> functions. But the functions can only be used to access data in active sheet in active window.
</p><p>Range data type is introduced since Origin 8.0 to provide a consistent way to access data in Origin projects. It can be used to access both data in active window and inactive window. 
</p><p>This tutorial demonstrates the creation and use of range variables for data in different places in Origin. 
</p><p><b>Note&#160;:</b> <i>Not all X-Functions can handle complexities of ranges such as multiple columns or noncontiguous data. Where logic or documentation does not indicate support, a little experimentation is in order.</i>
</p>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Range_Notation/Alert_icon.png?v=0" width="57"  border="0" /></td><td><p>Starting with <b>Orgin 2023</b>, range references to page names -- be they workbooks, matrices or graphs -- should be double-quoted for page Long Name and NOT double-quoted for page Short Name (double-quoting Long Name was previously required, double-quoting Short Name was allowed, but discouraged). The prohibition on double-quoting of Short Name extends to references by substitution (e.g. <b>[%H]</b> NOT <b>["%H"]</b>). This change means that page Long Name search will preferentially <i>search the active folder</i> for window Long Name. This prohibition allows for more robust page references when duplicating folders or appending projects. However, if you prefer the old behavior, you can roll back this change using system variable <a href="../../LabTalk/LabTalk/System_Variable_List.html#R" title="LabTalk:System Variable List"><b>@RQS</b></a>.
</p>
	</td>
	</tr>
	</table>
<h3><a name="Declaration_and_SyntaxDeclare_Range"></a><span class="mw-headline">Declaration and Syntax<span class="OIndex" style="display:none">Declare Range</span></span></h3>
<p>Range variable must be declared before use. But there is also the following uniqueness of it.
</p>
<dl><dd><ul><li> It must be initialized together with declaration so Origin knows what data it's referring to.</li>
<li> If you want to assign it to some other data, need to declare and initialize again.</li></ul></dd></dl>
<p>The syntax of declaration and initialization.
</p>
<dl><dd> <b>range [<i>-option</i>] <i>RangeName</i> = <i>RangeString</i></b></dd></dl>
<dl><dd><ul><li> The square brackets indicate that the option is optional.</li>
<li> For data in different places, the available option switches are different, please see the <b>Types of Range Data</b> section below for details.  </li>
<li> Range names follow <a href="../../LabTalk/LabTalk/Data_Types_and_Variables.html#Variable_Naming_Rules" title="LabTalk:Data Types and Variables">Origin variable naming rules</a>; please note that <a href="../../LabTalk/LabTalk/System_Variables.html#Numeric_System_Variables" title="LabTalk:System Variables">system variable names</a> should be avoided.</li>
<li> The <i><b>RangeString</b></i> changes depending on what type of object the range points to. But has a consistent notation of <b>[Window]SheetorLayer!ColumnorPlot[subrange]</b>. See details in <a href="#Types_of_Range_Data">Types of Range Data</a>.</li></ul></dd></dl>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Range_Notation/Alert_icon.png?v=0" width="57"  border="0" /></td><td><p>Range keyword is used exclusively to define range variables. It cannot be used as a general notation for data access on either side of an expression.
</p>
	</td>
	</tr>
	</table>
<h3><a name="Access_Origin_ObjectAccess_Origin_Object_by_RangeRange.2C_Origin_Object"></a><span class="mw-headline">Access Origin Object<span class="OIndex" style="display:none">Access Origin Object by Range</span><span class="OIndex" style="display:none">Range, Origin Object</span></span></h3>
<p>Range variable can be assigned to the following types of <a href="../../LabTalk/Category/Origin_Objects.html" title="Category:Origin Objects">Origin Objects</a>:
</p>
<dl><dd><ul><li><a class="external text" href="../../LabTalk/Category/Wks.Col_(object).html">column</a></li>
<li><a href="../../LabTalk/LabTalk/Wks_(object).html" title="LabTalk:Wks (object)">worksheet</a> </li>
<li><a href="../../LabTalk/LabTalk/Page_(object).html" title="LabTalk:Page (object)">page</a></li>
<li><a href="../../LabTalk/LabTalk/Layer_(object).html" title="LabTalk:Layer (object)">graph layer</a></li>
<li><a href="../../LabTalk/LabTalk/Datasets_(object).html" title="LabTalk:Datasets (object)">loose dataset</a> </li></ul></dd></dl>
<p>Once assigned, range variable will have all the properties and methods of the specified object. You can always use <i><b>rangeVariable.=</b></i> and <i><b>rangeVariable.()</b></i> to dump all accessible properties and methods
</p>
<pre class="lt" style="font-family:monospace;">range rA <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>Book1<span style="color: #000000;">&#93;</span>Sheet1<span style="color: #000080;">!</span>Col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//define range variable ra as  column A in Book1 Sheet1</span>
rA.<span style="color: #000080;">=</span>; <span style="color: #008000;">//dump all properties</span>
rA.<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//dump all methods</span>
rA.<span style="color: #000080;">lname</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>; <span style="color: #008000;">//output long name</span>
rA.<span style="color: #000080;">nRows</span><span style="color: #000080;">=</span>; <span style="color: #008000;">//output number of rows</span>
rA.<span style="color: #000080;">unit</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;MM/DD/YYYY&quot;</span>; <span style="color: #008000;">//set unit as &quot;MM/DD/YYYY&quot;</span>
ra.<span style="color: #000080;">setformat</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span>;<span style="color: #008000;">//set column as Date</span></pre>
<p><br />
A range may consist of some subset or some combination of standard Origin Objects.  Examples include:
</p>
<dl><dd><ul><li> <a href="../../LabTalk/LabTalk/Range_Notation.html#Column_SubrangeRange.2C_Column_Subrange" title="LabTalk:Range Notation">column subrange</a></li>
<li> <a href="../../LabTalk/LabTalk/Range_Notation.html#Block_of_CellsRange.2C_Block_of_Cells" title="LabTalk:Range Notation">block of cells</a></li>
<li> <a href="#XY_and_XYZ_Range">XY range</a></li>
<li> <a href="#XY_and_XYZ_Range">XYZ range</a></li>
<li> <a href="#Composite_Range">composite range</a></li></ul></dd></dl>
<h2><a name="Types_of_Range_Data"></a><span class="mw-headline">Types of Range Data</span></h2>
<h3><a name="Worksheet_DataRange.2C_Worksheet_Data"></a><span class="mw-headline">Worksheet Data<span class="OIndex" style="display:none">Range, Worksheet Data</span></span></h3>
<p>For worksheet data, <a href="#Declaration_and_SyntaxDeclare_Range"><i><b>RangeString</b></i></a> takes the form: 
</p><p><b>[<i>WorkBookName</i>]<i>SheetNameOrIndex</i>!<i>ColumnNameOrIndex</i>[<i>CellIndex</i>]</b>
</p>
<ul><li> <i><b>WorkBookName</b></i> and <i><b>SheetName</b></i> part can be skipped if referring to active book or active sheet </li>
<li> <i><b>WorkBookName</b></i> and <i><b>SheetName</b></i> refer to the corresponding <i>Short Name</i>, since <i>Short Name</i> is the default programming name. </li>
<li> To use <i>Long Name</i> in range notation for workbook or worksheet, you must put <i>Long Name</i> in double quotes as in ["MyBook"]"MySheet"!.</li>
<li> Conversely, DO NOT surround <i>Short Name</i> with double quotes (this includes in references like <a href="../../LabTalk/LabTalk/String_registers.html#.25_String_Registers" title="LabTalk:String registers">[<b>%H</b>]</a>). Prior to Origin 2023, this <i>may</i> have been accepted though it was not recommended. Starting with Origin 2023, double-quoting <i>Short Name</i> will likely fail. To roll back to previous behavior (allow double-quoted Short Name), see LT system variable <a href="../../LabTalk/LabTalk/System_Variable_List.html#R" title="LabTalk:System Variable List"><b>@RQS</b></a>.</li>
<li> Following the change to disallow double-quoting of Short Name, page Long Name search will preferentially search the active folder for window <b>Long Name</b>. This allows you to do such things as:</li></ul>
<dl><dd><ul><li> Duplicate folders and preserve within-folder operations such as those that rely on local variables defined in a workbook.</li>
<li> Save a Project Explorer folder as a project then later append that project to another project. When doing so, window Short Names are modified to avoid naming conflicts but operations that depend on window Long Names will not be affected.</li></ul></dd></dl>
<ul><li> <i><b>ColumnName</b></i> (no quotes) can be either the column <i>Long Name</i> or the <i>Short Name</i> (if Long Name has spaces, it must be double-quoted). </li>
<li> Since 2022b, column Long Name will be be case sensitive when <a href="../../LabTalk/LabTalk/System_Variable_List.html#L" title="LabTalk:System Variable List"><b>@LNCS=1</b></a>.</li></ul>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//Using long name</span>
range rPage <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span><span style="color: #ff00ff;">&quot;My Book&quot;</span><span style="color: #000000;">&#93;</span>; <span style="color: #008000;">//range variable for page</span>
range rSheet <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span><span style="color: #ff00ff;">&quot;My Book&quot;</span><span style="color: #000000;">&#93;</span><span style="color: #ff00ff;">&quot;My Sheet&quot;</span>; <span style="color: #008000;">//range variable for sheet</span>
range rA <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span><span style="color: #ff00ff;">&quot;My Book&quot;</span><span style="color: #000000;">&#93;</span><span style="color: #ff00ff;">&quot;My Sheet&quot;</span><span style="color: #000080;">!</span><span style="color: #ff00ff;">&quot;Amplitude&quot;</span>; <span style="color: #008000;">//range variable for column</span>

<span style="color: #008000;">//Using shor tname</span>
range rPage <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>Book1<span style="color: #000000;">&#93;</span>; <span style="color: #008000;">//range variable for page</span>
range rSheet <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>Book1<span style="color: #000000;">&#93;</span>Sheet1; <span style="color: #008000;">//range variable for sheet</span>
range rA <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>Book1<span style="color: #000000;">&#93;</span>Sheet1<span style="color: #000080;">!</span>B; <span style="color: #008000;">//range variable for column</span>

<span style="color: #008000;">//Using index in sheet and column part</span>
range rSheet <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>Book1<span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span>; <span style="color: #008000;">//range variable for sheet</span>
range rA <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>Book1<span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #0000dd;">2</span>; <span style="color: #008000;">//range variable for column</span>

<span style="color: #008000;">//Mix of long name, short name or index</span>
range rSheet <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span><span style="color: #ff00ff;">&quot;My Book&quot;</span><span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span>; <span style="color: #008000;">//long name for book, index for sheet</span>
range rA <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>Book1<span style="color: #000000;">&#93;</span><span style="color: #ff00ff;">&quot;My Sheet&quot;</span><span style="color: #000080;">!</span><span style="color: #0000dd;">2</span>; <span style="color: #008000;">//short name for book, long name for sheet, index for column</span>
range rB <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>Book1<span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #ff00ff;">&quot;Temparature&quot;</span>; <span style="color: #008000;">//short name for book, index for sheet, long name for column</span>

<span style="color: #008000;">//Other examples</span>
range rPage <span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span><span style="color: #000080;">%</span>H<span style="color: #000000;">&#93;</span>; <span style="color: #008000;">//%H is current window</span>
range rA<span style="color: #000080;">=</span><span style="color: #000080;">%</span>C; <span style="color: #008000;">//%C is current selection in sheet</span>
range rSheet <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span><span style="color: #000080;">%</span>H<span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span>; <span style="color: #008000;">//1st sheet in current window</span>
range rA<span style="color: #000080;">=</span>rSheet<span style="color: #000080;">!</span>A; <span style="color: #008000;">//build rA based on rSheet</span></pre>
<p>In any <i><b>RangeString</b></i>, a span of continuous sheets, columns, or rows can be specified by providing pairs of sheet, column, or row indices (respectively), separated by a colon, as in <b><i>index1</i>:<i>index2</i></b>.  The keyword <b>end</b> can replace <i><b>index2</b></i> to indicate that Origin should pick up all of the indicated objects.  For example:  
</p>
<pre class="lt" style="font-family:monospace;">range rs <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>Book1<span style="color: #000000;">&#93;</span><span style="color: #0000dd;">4</span><span style="color: #000000;">:</span>end<span style="color: #000080;">!</span>           <span style="color: #008000;">// Get sheets 4 through last</span>
range rd <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>Book2<span style="color: #000000;">&#93;</span>Sheet3<span style="color: #000080;">!</span><span style="color: #0000dd;">5</span><span style="color: #000000;">:</span><span style="color: #0000dd;">10</span>;     <span style="color: #008000;">// Get columns 5 through 10</span></pre>
<p>In the case of rows the indices must be surrounded by square brackets, so a full range assignment statement for several rows of a worksheet column looks like:
</p>
<pre class="lt" style="font-family:monospace;">range rc1 <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>Book1<span style="color: #000000;">&#93;</span>Sheet2<span style="color: #000080;">!</span>Col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">10</span><span style="color: #000000;">:</span>end<span style="color: #000000;">&#93;</span>;   <span style="color: #008000;">// Get rows 10 through last row. [10:0] also works</span>
range rc2 <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>Book1<span style="color: #000000;">&#93;</span>Sheet2<span style="color: #000080;">!</span>Col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">10</span><span style="color: #000000;">:</span><span style="color: #0000dd;">20</span><span style="color: #000000;">&#93;</span>;    <span style="color: #008000;">// Get rows 10 through 20</span></pre>
<p>The old way of accessing cell contents, via the <a href="../../LabTalk/LabTalk/Cell_(function).html" title="LabTalk:Cell (function)">Cell function</a> is still supported.
</p><p><br />
</p>
<h4><a name="ColumnRange.2C_Column"></a><span class="mw-headline">Column<span class="OIndex" style="display:none">Range, Column</span></span></h4>
<p>When declaring a range variable for a column on the <span class="OIndex">active worksheet</span>, the book and sheet part can be dropped.
Column short name, index, long name or col() can be used for column part as long as it be identified, 
</p>
<pre class="lt" style="font-family:monospace;">range r1 <span style="color: #000080;">=</span> col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//3rd column of active sheet</span>
range r2 <span style="color: #000080;">=</span> col<span style="color: #000000;">&#40;</span>C<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//column C of active sheet;</span>
range r3 <span style="color: #000080;">=</span> col<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Sensor Y&quot;</span><span style="color: #000000;">&#41;</span> <span style="color: #008000;">//column with long name &quot;Sensor Y&quot; of active sheet</span>
range aa<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;        <span style="color: #008000;">// col(1) of  active worksheet</span>
range bb<span style="color: #000080;">=</span>B;        <span style="color: #008000;">// col(B) of active worksheet</span>
range cc<span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Test A&quot;</span>; <span style="color: #008000;">// col with Long Name &quot;Test A&quot; of active worksheet</span></pre>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Range_Notation/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>An expression such as aa = 1! refers to the first sheet of the active book, while an expression such as aa = "1!" refers to a column in the current sheet with a Long Name of 1!. See the system variable <a href="../../LabTalk/LabTalk/System_Variable_List.html#R" title="LabTalk:System Variable List"><b>@RPQ</b></a> to control preserving or discarding quotes for range declaration.
</p></td></tr></table>
<p>Multiple range variables can be declared on the same line, separated by comma.  The above example could also have been written as:
</p>
<pre class="lt" style="font-family:monospace;">range aa <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>, bb <span style="color: #000080;">=</span> B, cc <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Test A&quot;</span>;</pre>
<p>Or if you need to declare multiple range variables in same specified sheet, you can put book &amp; sheet portion in the front:
</p>
<pre class="lt" style="font-family:monospace;">range <span style="color: #000000;">&#91;</span><span style="color: #ff00ff;">&quot;MyBook&quot;</span><span style="color: #000000;">&#93;</span>Sheet3 aa<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>, bb<span style="color: #000080;">=</span>B, cc<span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Test A&quot;</span>; <span style="color: #008000;">//columns in Sheet3 of Book with long name &quot;MyBook&quot;</span></pre>
<p>Because Origin does not force a column's Long Name to be unique (i.e., multiple columns in a worksheet can have the same Long Name), the Short Name and Long Name may be specified together to be more precise:
</p>
<pre class="lt" style="font-family:monospace;">range dd <span style="color: #000080;">=</span> D<span style="color: #ff00ff;">&quot;Test 4&quot;</span>;  <span style="color: #008000;">// Assign Col(D), Long Name 'Test 4', to a range</span></pre>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Range_Notation/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>Origin 2024b can create range with discontinuous columns with a new option switch <b>-s</b>:
</p>
<pre class="lt" style="font-family:monospace;">StringArray sa <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">4</span>,<span style="color: #0000dd;">6</span>,<span style="color: #0000dd;">8</span><span style="color: #000000;">&#125;</span>;
range <span style="color: #000080;">-</span>s rr<span style="color: #000080;">=</span>sa;
del rr;</pre>
</td></tr></table>
<p>Once you have a column range, use it to access and change the properties of a column:
</p>
<pre class="lt" style="font-family:monospace;">range rColumn <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>Book1<span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #0000dd;">2</span>;       <span style="color: #008000;">// Range is a Column</span>
rColumn.<span style="color: #000080;">digitMode</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;            <span style="color: #008000;">// Use Set Decimal Places for display</span>
rColumn.<span style="color: #000080;">digits</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;               <span style="color: #008000;">// Use 2 decimal places</span></pre>
<p>Or perform computations:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Point to column 1 of sheets 1, 2, and 3 of the active workbook:</span>
range aa <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span><span style="color: #000080;">!</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
range bb <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span><span style="color: #000080;">!</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
range cc <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span><span style="color: #000080;">!</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
cc <span style="color: #000080;">=</span> aa<span style="color: #000080;">+</span>bb;</pre>
<p>When assigning non-existing column to a range variable, the column will not show until value is assigned to it.
Same rule applies to column in non-existing sheet or book.
</p>
<pre class="lt" style="font-family:monospace;">newbook; <span style="color: #008000;">//start a new book, by default there are only two columns;</span>
range aa<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>, bb<span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>, cc<span style="color: #000080;">=</span><span style="color: #0000dd;">3</span>; <span style="color: #008000;">//assign 3 range variables 3 columns, 3rd column doesn't exist</span>
aa<span style="color: #000080;">=</span>data<span style="color: #000000;">&#123;</span><span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">10</span>, <span style="color: #0000dd;">0.5</span><span style="color: #000000;">&#125;</span>; <span style="color: #008000;">//assign values to aa</span>
bb<span style="color: #000080;">=</span>sin<span style="color: #000000;">&#40;</span>aa<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//assign values to bb</span>
cc<span style="color: #000080;">=</span>cos<span style="color: #000000;">&#40;</span>bb<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//assign values to cc, 3rd column shows</span></pre>
<p>If you wish to access column label rows using range, please see <a href="../../LabTalk/Script/Accessing_Metadata.html" title="Script:Accessing Metadata">Accessing Metadata</a> and the <a href="../../LabTalk/LabTalk/Column_Label_Row_Characters.html" title="LabTalk:Column Label Row Characters">Column Label Row Reference Table</a>.
</p>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Range_Notation/Alert_icon.png?v=0" width="57"  border="0" /></td><td><p>When performing arithmetic on data in different sheets, you need to use range variables.  Direct references to range strings are not yet supported.  For example, the script <b>Sheet3!col(1) = Sheet1!col(1) + Sheet2!col(1);</b> will not work! If you really need to write in a single line without having to declare range variables, then use <a href="../../LabTalk/LabTalk/String_Substitution.html#Calculation_Involving_Datasets_from_Another_Sheet" title="LabTalk:String Substitution"><span class="OIndex">Dataset Substitution</span></a>. 
</p>
	</td>
	</tr>
	</table>
<h4><a name="Page_and_SheetRange.2C_Page_and_Sheet"></a><span class="mw-headline">Page and Sheet<span class="OIndex" style="display:none">Range, Page and Sheet</span></span></h4>
<p>Besides a single column of data, a range can be used to access page and sheet objects:
</p><p>Use a range variable to access an entire workbook:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 'rPage' points to the workbook named 'Book1'</span>
range rPage <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>Book1<span style="color: #000000;">&#93;</span>; 
<span style="color: #008000;">// Set the Long Name of 'Book1' to &quot;My Analysis Worksheets&quot;                   </span>
rPage.<span style="color: #000080;">LongName</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> My Analysis Worksheets; 
rPage.<span style="color: #000080;">nlayers</span><span style="color: #000080;">=</span>; <span style="color: #008000;">//output number of sheets</span>
rPage.<span style="color: #000080;">active</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span>; <span style="color: #008000;">//set 3rd sheet to be active sheet</span></pre>
<p>Use a range variable to access a worksheet: 
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// 'rSheet' points to sheet with long name MySheet&quot; in book with ong Name MyBook</span>
range rSheet <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span><span style="color: #ff00ff;">&quot;MyBook&quot;</span><span style="color: #000000;">&#93;</span><span style="color: #ff00ff;">&quot;MySheet&quot;</span><span style="color: #000080;">!</span>;
rSheet.<span style="color: #000080;">name</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Statistics&quot;</span>;        <span style="color: #008000;">// Rename sheet short name to &quot;Statistics&quot;.</span>
page.<span style="color: #000080;">xlcolname</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;               <span style="color: #008000;">//Turn off Spreadsheet Cell Notation firstly</span>
rSheet.<span style="color: #000080;">AddCol</span><span style="color: #000000;">&#40;</span>StdDev<span style="color: #000000;">&#41;</span>;              <span style="color: #008000;">// Add a column named StdDev</span></pre>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Range_Notation/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>For the <a class="external text" href="../../UserGuide/UserGuide/Column_Short_Name_Restriction.html">Spreadsheet Cell Notation</a> in the workbook, please see <a class="external text" href="../../QuickHelp/QuickHelp/Turn_off_spreadsheet_cell_notation.html"><b>FAQ-849</b></a> for more information.
</p></td></tr></table>
<h4><a name="Column_SubrangeRange.2C_Column_Subrange"></a><span class="mw-headline">Column Subrange<span class="OIndex" style="display:none">Range, Column Subrange</span></span></h4>
<p>Use a range variable to address a column <span class="OIndex">subrange</span>, such as 
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// A subrange of col(a) in MyBook (Long Name) sheet2</span>
range cc <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span><span style="color: #ff00ff;">&quot;MyBook&quot;</span><span style="color: #000000;">&#93;</span>sheet2<span style="color: #000080;">!</span>col<span style="color: #000000;">&#40;</span>a<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">:</span><span style="color: #0000dd;">10</span><span style="color: #000000;">&#93;</span>;</pre>
<p>Or if the desired workbook and worksheet are active, the shortened notation can be used:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// A subrange of col(a) in book1 sheet2</span>
range cc <span style="color: #000080;">=</span> col<span style="color: #000000;">&#40;</span>a<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">:</span><span style="color: #0000dd;">10</span><span style="color: #000000;">&#93;</span>;</pre>
<p>Create subrange of another range
</p>
<pre class="lt" style="font-family:monospace;">range ra<span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>book1<span style="color: #000000;">&#93;</span>Sheet1<span style="color: #000080;">!</span>A;
range subra<span style="color: #000080;">=</span>ra<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">10</span><span style="color: #000000;">:</span><span style="color: #0000dd;">20</span><span style="color: #000000;">&#93;</span>;</pre>
<p>Perform computation or other operations on part of a column. For example:
</p>
<pre class="lt" style="font-family:monospace;">range r1<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">5</span><span style="color: #000000;">:</span><span style="color: #0000dd;">10</span><span style="color: #000000;">&#93;</span>;
range r2<span style="color: #000080;">=</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">6</span><span style="color: #000000;">&#93;</span>;
r1 <span style="color: #000080;">=</span> r2; <span style="color: #008000;">// copy values in row 1 to 6 of column 2 to rows 5 to 10 of column 1</span>
r1<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">=</span>; 
<span style="color: #008000;">// this should output value in row 5 of column 1, which equates to row 1 of column 2</span></pre>
<h4><a name="Block_of_CellsRange.2C_Block_of_Cells"></a><span class="mw-headline">Block of Cells<span class="OIndex" style="display:none">Range, Block of Cells</span></span></h4>
<p>Use a range to access a single cell or <span class="OIndex">block of cells</span> (may span many rows and columns) as in:
</p>
<pre class="lt" style="font-family:monospace;">range aa <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#93;</span>;  <span style="color: #008000;">// (column 1, row 2), a cell</span>
range bb <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">:</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">10</span><span style="color: #000000;">&#93;</span>;  <span style="color: #008000;">// (column 1, row 1) to (column 3 row 10)</span></pre>
<p><b>Note</b>: A range variable representing a block of cells can be used as an <a href="#X-Function_ArgumentX-Function_Argument.2C_RangeRange.2C_X-Function_Argument">X-Function argument</a> only, direct calculations are not supported.
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Range_Notation/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>Origin's <a href="../../LabTalk/LabTalk/Join_(function).html" title="LabTalk:Join (function)"><b>join()</b> function</a> can be used to join multiple non-contiguous ranges into a single dataset.
</p></td></tr></table>
<h4><a name="Option_Switch_-vOption_Switches"></a><span class="mw-headline">Option Switch <b>-v</b><span class="OIndex" style="display:none">Option Switches</span></span></h4>
<p><font color="red">Minimum Origin Version: 9.1 SR0</font>
</p><p>For worksheet data, you can use the <b>-v</b> switch to define a single block as a range and store its values in a temporary vector, so that the data assignment between blocks with same size but different block shape is possible (e.g. assign values from a row to a column would be possible).
</p><p>The following examples scales all entries in a particular row of columns in the workshet:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Scale 1st element of all columns except the last column, by a factor</span>
range <span style="color: #000080;">-</span>v r<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">:</span><span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>wks.<span style="color: #000080;">ncols</span><span style="color: #000080;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span>;
r<span style="color: #000080;">*</span><span style="color: #000080;">=</span><span style="color: #0000dd;">10</span>;
<span style="color: #008000;">// Scale 1st element of all columns</span>
range <span style="color: #000080;">-</span>v r<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">:</span>end<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span>;
r<span style="color: #000080;">*</span><span style="color: #000080;">=</span><span style="color: #0000dd;">10</span>;</pre>
<p>The following example illustrates how this option switch can be used. 
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//Import a sample data into a new book</span>
fname<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;\Samples\Statistics\automobile.dat&quot;</span>; 
newbook;
impasc;
<span style="color: #008000;">//Define a block as column B to C,all rows</span>
range <span style="color: #000080;">-</span>v r1 <span style="color: #000080;">=</span> B<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">:</span>C<span style="color: #000000;">&#91;</span>end<span style="color: #000000;">&#93;</span>;
<span style="color: #008000;">// Create a new sheet</span>
newsheet;
<span style="color: #008000;">//Define a block as column A to B sized</span>
range <span style="color: #000080;">-</span>v r2 <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">:</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#91;</span>r1.<span style="color: #000080;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">/</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#93;</span>; <span style="color: #008000;">// size of block is 2 columns x rows</span>
<span style="color: #008000;">//Assign the values in the first block to the second block</span>
r2 <span style="color: #000080;">=</span> r1;</pre>
<p>The vector stores data in column order and fills the destination block regardless of the 'shape':
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Import sample data into a new book</span>
fname<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;\Samples\Statistics\abrasion_raw.dat&quot;</span>; 
newbook;
impasc;
<span style="color: #008000;">// Define a block as column A &amp; B, all rows</span>
range <span style="color: #000080;">-</span>v ra1 <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">:</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#91;</span>end<span style="color: #000000;">&#93;</span>;
<span style="color: #008000;">// Create a new sheet</span>
newsheet;
<span style="color: #008000;">// Define a block as one column, using the ra1 block size</span>
range <span style="color: #000080;">-</span>v ra2 <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span>ra1.<span style="color: #000080;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#93;</span>;
<span style="color: #008000;">// Assign the values in the first block to the second block</span>
ra2 <span style="color: #000080;">=</span> ra1;
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span>L<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Combined;</pre>
<p><b>Note:</b> The columns defined by the target block must exist before the assignment is made.
</p>
<h3><a name="Matrix_DataRange.2C_Matrix_Data"></a><span class="mw-headline">Matrix Data<span class="OIndex" style="display:none">Range, Matrix Data</span></span></h3>
<p>For matrix data, the <i><b>RangeString</b></i> is
</p><p><b>[<i>MatrixBookName</i>]<i>MatrixSheetNameOrIndex</i>!<i>MatrixObject</i></b>
</p>
<table class="note">
<tr>
<td><b>Note:</b> The <i>MatrixBookName</i> and<i>MatrixSheetName</i> above used their corresponding <i>Short Name</i> since <i>Short Name</i> is the default programming name. To use <i>Long Name</i> in range notation for matrixbook or matrixsheet, you have to put <i>Long Name</i> in double quotes such as ["MyMatrixBook"]"MyMatrixSheet"!.
</td></tr></table>
<p>Variable assignment can be made using the follow syntax:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Second matrix object on MBook1, MSheet1</span>
range mm <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>MBook1<span style="color: #000000;">&#93;</span>MSheet1<span style="color: #000080;">!</span><span style="color: #0000dd;">2</span>;
<span style="color: #008000;">// Matrix object with Long Name MatObject1 on matrixsheet MatSheet1 (Long Name)</span>
<span style="color: #008000;">// on matrix book MatBook1 (Long Name)</span>
range mo <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span><span style="color: #ff00ff;">&quot;MatBook1&quot;</span><span style="color: #000000;">&#93;</span><span style="color: #ff00ff;">&quot;MatSheet1&quot;</span><span style="color: #000080;">!</span>Mat<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;MatObject1&quot;</span><span style="color: #000000;">&#41;</span>;</pre>
<p>Access the cell contents of a matrix range using the notation <b><i>RangeName</i>[<i>row</i>, <i>col</i>]</b>.  For example:
</p>
<pre class="lt" style="font-family:monospace;">range mm<span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>MBook1<span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #0000dd;">1</span>;    
mm<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">3</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">=</span><span style="color: #0000dd;">10</span>;</pre>
<p>If the matrix contains complex numbers, the string representing the complex number can be accessed as below:
</p>
<pre class="lt" style="font-family:monospace;">string str<span style="color: #000080;">$</span>;
str<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> mm<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">3</span>,<span style="color: #0000dd;">4</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span>;</pre>
<h3><a name="Graph_DataRange.2C_Graph_Data"></a><span class="mw-headline">Graph Data<span class="OIndex" style="display:none">Range, Graph Data</span></span></h3>
<p>For graph data, the <i><b>RangeString</b></i> is
</p><p><b>[<i>GraphWindowName</i>]<i>LayerNameOrIndex</i>!<i>DataPlot</i></b>
</p><p>An example assignment looks like
</p>
<pre class="lt" style="font-family:monospace;">range ll <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>Graph1<span style="color: #000000;">&#93;</span>Layer1<span style="color: #000080;">!</span><span style="color: #0000dd;">2</span>;       <span style="color: #008000;">// Second curve on Graph1, Layer1</span>
range mm <span style="color: #000080;">=</span> <span style="color: #000080;">%</span>C; <span style="color: #008000;">//Get the current active plot or selected plot</span></pre>
<h4><a name="Option_Switches_-w.2C_-wx.2C_-wy_and_-wzOption_Switche"></a><span class="mw-headline">Option Switches <b>-w</b>, <b>-wx</b>, <b>-wy</b> and <b>-wz</b><span class="OIndex" style="display:none">Option Switche</span></span></h4>
<p>For graph windows, you can use range -w<span class="OIndex" style="display:none">Range, Get plot Y</span> and range -wx<span class="OIndex" style="display:none">Range, Get plot X</span>, range -wy<span class="OIndex" style="display:none">Range, Get plot Y</span>, range -wz<span class="OIndex" style="display:none">Range, Get plot Z</span> options to get the worksheet column range of a plotted dataset.
</p><p>range -w always gets the worksheet range of the most dependent variable - which is the Y value for 2D plots and the Z value or matrix object for 3D plots. And since Origin 9.0 SR0, multiple ranges are supported for range -w.
</p><p>range -wx, range -wy, and range -wz will get the worksheet range of the corresponding X, Y and Z values, respectively.
</p><p>range -wx, range -wz <span style="color:red">Require Version: 9.0 SR0</span>
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Make a graph window the active window ...</span>
<span style="color: #008000;">// Get the worksheet range of the Y values of first dataplot: </span>
range <span style="color: #000080;">-</span>w rW <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
type <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>rw<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//output the rangestring</span>

<span style="color: #008000;">// Get the worksheet range of the corresponding X-values: </span>
range <span style="color: #000080;">-</span>wx rWx <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;

<span style="color: #008000;">//Get the worksheet range of the corresponding Y-values:</span>
range <span style="color: #000080;">-</span>wy rWy <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;

<span style="color: #008000;">//Get the worksheet range of the corresponding Z-values:</span>
range <span style="color: #000080;">-</span>wz rWz <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;

<span style="color: #008000;">// Get the graph range of the first dataplot:   </span>
range rG <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;      

<span style="color: #008000;">// Get the current selection (%C); will resolve data between markers.</span>
range <span style="color: #000080;">-</span>w rC <span style="color: #000080;">=</span> <span style="color: #000080;">%</span>C;</pre>
<p>Note that in the script above, <b>rW = [Book1]Sheet1!B</b> while <b>rG = [Graph1]1!1</b>.
</p>
<h4><a name="Data_Selector_Ranges_on_a_GraphSelect_Range_on_Graph"></a><span class="mw-headline">Data Selector Ranges on a Graph<span class="OIndex" style="display:none">Select Range on Graph</span></span></h4>
<p>You can use the Data Selector tool to select one or more ranges on a graph and to refer to them from LabTalk. For a single selected range, you can use the MKS1, MKS2 system variables. Starting with version 8.0 SR6, a new X-Function, <b>get_plot_sel</b>, has been added to get the selected ranges into a string that you can then parse.  The following example shows how to select each range on the current graph:
</p>
<pre class="lt" style="font-family:monospace;">string strRange;
get_plot_sel str<span style="color: #000000;">:</span><span style="color: #000080;">=</span>strRange;
StringArray sa;
sa.<span style="color: #000080;">Append</span><span style="color: #000000;">&#40;</span>strRange<span style="color: #000080;">$</span>,<span style="color: #ff00ff;">&quot;|&quot;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Tokenize it</span>
int nNumRanges <span style="color: #000080;">=</span> sa.<span style="color: #000080;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
if<span style="color: #000000;">&#40;</span>nNumRanges <span style="color: #000080;">==</span> <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	type <span style="color: #ff00ff;">&quot;there is nothing selected&quot;</span>;
	return;
<span style="color: #000000;">&#125;</span>
type <span style="color: #ff00ff;">&quot;Total of $(nNumRanges) ranges selected for&#160;%C&quot;</span>;
for<span style="color: #000000;">&#40;</span>int ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; ii <span style="color: #000080;">&lt;=</span> nNumRanges; ii<span style="color: #000080;">++</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	range <span style="color: #000080;">-</span>w xy <span style="color: #000080;">=</span> sa.<span style="color: #000080;">GetAt</span><span style="color: #000000;">&#40;</span>ii<span style="color: #000000;">&#41;</span><span style="color: #000080;">$</span>;
	string strWks<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Temp$(ii)&quot;</span>;
	create <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>strWks<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">-</span>wdn <span style="color: #0000dd;">10</span> aa bb;
	range fitxy <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>??<span style="color: #000000;">&#93;</span><span style="color: #000080;">!</span><span style="color: #000000;">&#40;</span><span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>strWks<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>_aa, <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>strWks<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>_bb<span style="color: #000000;">&#41;</span>;
	fitlr iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span>xy oy<span style="color: #000000;">:</span><span style="color: #000080;">=</span>fitxy;
	plotxy fitxy p<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">200</span> o<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>active<span style="color: #000080;">&gt;</span> c<span style="color: #000000;">:</span><span style="color: #000080;">=</span>color<span style="color: #000000;">&#40;</span>red<span style="color: #000000;">&#41;</span> rescale<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> legend<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;
	type <span style="color: #ff00ff;">&quot;%(xy) fit linear gives slope=$(fitlr.b)&quot;</span>;
<span style="color: #000000;">&#125;</span>
<span style="color: #008000;">// clear all the data markers when done</span>
mark <span style="color: #000080;">-</span>r;</pre>
<p>Additional documentation is available for the the <a href="../../LabTalk/LabTalk/Create_(command).html" title="LabTalk:Create (command)">Create (Command)</a> (for creating loose datasets), the <a href="#Loose_Dataset">[??] range notation</a> (for creating a range from a loose dataset), the <a class="external text" href="../../XFunction/X-Function/FitLR.html"><b>fitlr</b> X-Function</a>, and the <a href="../../LabTalk/LabTalk/StringArray_(object).html#Append" title="LabTalk:StringArray (object)">StringArray (Object)</a> (specifically, the <b>Append</b> method, which was introduced in Origin 8.0 SR6).
</p>
<h3><a name="Specifying_Subrange_Using_X_Values"></a><span class="mw-headline">Specifying Subrange Using X Values</span></h3>
<p>When working with an XY range, you can specify a subrange using the X values. The syntax is as follows:
</p>
<ol><li> From Worksheet
<dl><dd><b>[<i>WorkBookName</i>]<i>SheetNameOrIndex</i>!<i>YColumnNameOrIndex</i>[x<i>X1:X2</i>]</b></dd></dl></li></ol>
<p>Example:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Using Columns 1 and 2 for X and Y, specify subrange from x=0.15 to 0.2</span>
range rxy <span style="color: #000080;">=</span> <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span>x0.15<span style="color: #000000;">:</span><span style="color: #0000dd;">0.2</span><span style="color: #000000;">&#93;</span>;</pre>
<ol><li> From Graph
<dl><dd><b>[<i>GraphWindowName</i>]<i>LayerNameOrIndex</i>!<i>DataPlot</i>[x<i>X1:X2</i>]</b></dd></dl></li></ol>
<p>Example:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// XY subrange of the 2nd curve on Graph1, Layer1</span>
range rxy2 <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>Graph1<span style="color: #000000;">&#93;</span>Layer1<span style="color: #000080;">!</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#91;</span>x5<span style="color: #000000;">:</span><span style="color: #0000dd;">20</span><span style="color: #000000;">&#93;</span>;</pre>
<p>The following example uses the  <a class="external text" href="../../XFunction/X-Function/Plotxy.html">plotxy X-Function</a> to plot a graph, and then the <a class="external text" href="../../XFunction/X-Function/Smooth.html">smooth X-Function</a> to smooth a subrange of the data.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Import data into a new book</span>
newbook;
fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;\Samples\Signal Processing\EMG Recording.dat&quot;</span>;
impasc;

<span style="color: #008000;">// Define XY subrange, X from 5 to 5.5, and from 9.3 to 9.8</span>
range rxy1 <span style="color: #000080;">=</span> <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span>x5<span style="color: #000000;">:</span><span style="color: #0000dd;">5.5</span><span style="color: #000000;">&#93;</span>;
range rxy2 <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span><span style="color: #000000;">&#91;</span>x9.3<span style="color: #000000;">:</span><span style="color: #0000dd;">9.8</span><span style="color: #000000;">&#93;</span>;
plotxy rxy1 plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">200</span>;  <span style="color: #008000;">// Plot line for the 1st XY subrange</span>
smooth <span style="color: #000080;">-</span>r <span style="color: #0000dd;">2</span> rxy2 method<span style="color: #000000;">:</span><span style="color: #000080;">=</span>le;  <span style="color: #008000;">// Smooth the 2nd XY subrange by Loess method</span></pre>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Range_Notation/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>When specifying a subrange based on X values, the X data needs to be monotonic.
</p></td></tr></table>
<h3><a name="Loose_Dataset"></a><span class="mw-headline">Loose Dataset</span></h3>
<p><span class="OIndex">Loose Dataset</span>s are similar to columns in a worksheet but they don't have the overhead of the book-sheet-column organization. They are typically created with the <a href="../../LabTalk/LabTalk/Create_(command).html" title="LabTalk:Create (command)">create command</a>, or automatically created from an assignment statement without <a href="../../LabTalk/LabTalk/Datasets_(object).html" title="LabTalk:Datasets (object)">Dataset declaration</a>.
</p><p>The <i><b>RangeString</b></i> for a loose dataset is: 
</p><p><b>[??]!<i>LooseDatasetName</i></b>
</p><p>Assignment can be performed using the syntax:
</p>
<pre class="lt" style="font-family:monospace;">range xx <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>??<span style="color: #000000;">&#93;</span><span style="color: #000080;">!</span>tmpdata_a;       <span style="color: #008000;">// Loose dataset 'tmpdata_a'</span></pre>
<p>To show how this works, we use the <a class="external text" href="../../XFunction/X-Function/Plotxy.html"><b>plotxy</b> X-Function</a> to plot a graph of a loose dataset.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create 2 loose datasets</span>
create tmpdata <span style="color: #000080;">-</span>wd <span style="color: #0000dd;">50</span> a b;
tmpdata_a<span style="color: #000080;">=</span>data<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">50</span>,<span style="color: #0000dd;">1</span>,<span style="color: #000080;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
tmpdata_b<span style="color: #000080;">=</span>normal<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">50</span><span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// Declare the range and explicitly point to the loose dataset</span>
range aa<span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>??<span style="color: #000000;">&#93;</span><span style="color: #000080;">!</span><span style="color: #000000;">&#40;</span>tmpdata_a, tmpdata_b<span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// Make a scatter graph with it:</span>
plotxy aa;</pre>
<p><br />
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Range_Notation/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>Loose datasets belong to a <a href="../../LabTalk/LabTalk/Data_Types_and_Variables.html#Scope_of_Variables" title="LabTalk:Data Types and Variables">project</a>, so they are different from a Dataset variable, which is declared, and has either session or <a href="../../LabTalk/LabTalk/Data_Types_and_Variables.html#Local_Variables" title="LabTalk:Data Types and Variables">local scope</a>. <a href="../../LabTalk/LabTalk/Data_Types_and_Variables.html#Dataset" title="LabTalk:Data Types and Variables">Dataset variables</a> are also internally loose datasets but they are limited to use in calculations only; they cannot be used in making plots, for example.
</p></td></tr></table>
<h2><a name="Methods_of_Range"></a><span class="mw-headline">Methods of Range</span></h2>
<p>Once a range variable is created, the following methods can be used by this range
</p>
<table class="simple">
<tr>
<th width="120">Method
</th>
<th> Description
</th></tr>
<tr>
<td> range.getSize()
</td>
<td> Return the size of the range. This method works for a dataset range, such as column, matrix object, graph plot, block of cells, loose dataset, etc. Note that, for a block of cells, it only returns the size of the first sub column specified in the range declaration.
</td></tr>
<tr>
<td> range.setSize()
</td>
<td> Set the size of the range. This method works for a dataset range, such as column, matrix object, graph plot, block of cells, loose dataset, etc. If the range is block of cells, it only set the size for the first sub column specified in the range declaration.
</td></tr>
<tr>
<td> range.getLayer()
</td>
<td> If the range has an attached layer (graph layer, worksheet, or matrix layer), this method will return the <b>uid</b> of the layer, to get the name of the layer, you need the <b>$</b> sign after the method, such as "rng.getLayer()$ = ".
</td></tr>
<tr>
<td> range.getPage()
</td>
<td> If the range has an attached page (graph page, workbook, or matrixbook), this method will return the <b>uid</b> of the page, to get the name of the page, you need the <b>$</b> sign after the method, such as "rng.getPage()$ = ".
</td></tr>
<tr>
<td> range.getop()
</td>
<td> If the range is a column in a worksheet or plot in a graph, this method will return the <b>uid</b> of the operation attached to the range. If the range is a worksheet (including hierarchical sheet), it will return the first operation's <b>uid</b> attached to this sheet range.
</td></tr>
<tr>
<td> range.sub(<i>name</i>/<i>index</i>)
</td>
<td> This method is used to get a subrange from a data range by either specifying a <i>name</i> or <i>index</i>. This method is only useful for <a href="../../LabTalk/Script/Virtual_Matrix.html" title="Script:Virtual Matrix">virtual matrix</a>. For example, with a virtual matrix named as <i>ztitle</i>, you could use such expression <i>ztitle.sub(y);</i>(by name) or <i>ztitle.sub(1);</i> (by index) to return a dataset for the Y values, in addition, you may use such expression <i>ztitle.sub(y)[3]=;</i> or <i>ztitle.sub(y)[3]$=;</i> to return the 3rd value in this dataset.
</td></tr>
<tr>
<td> range.reverse()
</td>
<td> This method works for a dataset range, such as column, matrix object, graph plot, block of cells, loose dataset, etc. It will reverse the data order of the range. If the range is block of cells, it only reverses the data order of the first sub column specified in the range declaration. The X-Function, <a class="external text" href="../../XFunction/X-Function/Colreverse.html">colReverse</a>, will do the same thing.
</td></tr>
<tr>
<td> range.empty()
</td>
<td> This method works for the label area and the data area, such as column, matrix object, block of cells, label rows, etc. It would clear the data and label in the range. If the range is data area, the data in this range will be set to the missing value. In GUI, you can also right click on the selected range and then select Clear in the context menu.
</td></tr></table>
<h2><a name="Unique_Uses_of_Range"></a><span class="mw-headline">Unique Uses of Range</span></h2>
<h3><a name="Manipulating_Range_DataManipulate_RangeRange_Data_Manipulation"></a><span class="mw-headline">Manipulating Range Data<span class="OIndex" style="display:none">Manipulate Range</span><span class="OIndex" style="display:none">Range Data Manipulation</span></span></h3>
<p>A column range can be used to manipulate data directly.  One major advantage of using a range rather than the direct column name, is that you do not need to be concerned with which page or layer is active.
</p><p>For example:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Declare two range variables, v1 and v2:</span>
range <span style="color: #000000;">&#91;</span>Book1<span style="color: #000000;">&#93;</span>Sheet1 r1<span style="color: #000080;">=</span>Col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span>, r2<span style="color: #000080;">=</span>Col<span style="color: #000000;">&#40;</span>B<span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Same as col(A)=data(1,30) if [book1]sheet1 is active: </span>
r1 <span style="color: #000080;">=</span> data<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">30</span><span style="color: #000000;">&#41;</span>;                          
r2 <span style="color: #000080;">=</span> uniform<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">30</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Plot creates new window so [Book1]Sheet1 is NOT active:</span>
plotxy <span style="color: #0000dd;">2</span>;                                 
sec <span style="color: #000080;">-</span>p <span style="color: #0000dd;">1.5</span>;            <span style="color: #008000;">// Delay</span>
r2<span style="color: #000080;">/</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span>;                 <span style="color: #008000;">// But our range still works; col(A)/=4 does NOT!</span>
sec <span style="color: #000080;">-</span>p <span style="color: #0000dd;">1.5</span>;            <span style="color: #008000;">// Delay</span>
r2<span style="color: #000080;">+</span><span style="color: #000080;">=</span>.4;
sec <span style="color: #000080;">-</span>p <span style="color: #0000dd;">1.5</span>;            <span style="color: #008000;">// Delay</span>
r1<span style="color: #000080;">=</span><span style="color: #0000dd;">10</span><span style="color: #000080;">+</span>r1<span style="color: #000080;">/</span><span style="color: #0000dd;">3</span>;</pre>
<p>Direct calculations on a column range variable that addresses a range of cells is supported. For example:
</p>
<pre class="lt" style="font-family:monospace;">range aa <span style="color: #000080;">=</span> Col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">10</span><span style="color: #000000;">:</span><span style="color: #0000dd;">19</span><span style="color: #000000;">&#93;</span>; <span style="color: #008000;">// Row 10 to 19 of column A</span>
aa <span style="color: #000080;">+</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span>;                 <span style="color: #008000;">// All elements in aa increase by 10</span></pre>
<p>Support for sub ranges in a column has expanded.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Range consisting of column 1, rows 7 to 13 and column 2, rows 3 to 4</span>
<span style="color: #008000;">// Note use of parentheses and comma separator:</span>
range rs <span style="color: #000080;">=</span> <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">7</span><span style="color: #000000;">:</span><span style="color: #0000dd;">13</span><span style="color: #000000;">&#93;</span>, <span style="color: #0000dd;">2</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">:</span><span style="color: #0000dd;">4</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span>; 
del rs; <span style="color: #008000;">// Supported since 8.0 SR6</span>

<span style="color: #008000;">// Copying between sub ranges</span>
range r1 <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">85</span><span style="color: #000000;">:</span><span style="color: #0000dd;">100</span><span style="color: #000000;">&#93;</span>;
range r2 <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
<span style="color: #008000;">// Copy r1 to top of column 2</span>
r2 <span style="color: #000080;">=</span> r1; <span style="color: #008000;">// Supported in 8.1</span>
<span style="color: #008000;">// 8.1 also complete or incomplete copying to sub range</span>
range r2 <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">17</span><span style="color: #000000;">:</span><span style="color: #0000dd;">22</span><span style="color: #000000;">&#93;</span>;
r2 <span style="color: #000080;">=</span> r1; <span style="color: #008000;">// Only copies 6 values from r1</span>
range r2 <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">50</span><span style="color: #000000;">:</span><span style="color: #0000dd;">200</span><span style="color: #000000;">&#93;</span>;
r2 <span style="color: #000080;">=</span> r1; <span style="color: #008000;">// Copies only up to row 65 since source has only 16 values</span></pre>
<h3><a name="Dynamic_Range_AssignmentDynamic_Range_Assignment"></a><span class="mw-headline">Dynamic Range Assignment<span class="OIndex" style="display:none">Dynamic Range Assignment</span></span></h3>
<p>Sometimes it is beneficial to be able to create a new range in an automated way, at runtime, using a variable column number, or the name of another range variable.
</p>
<h4><a name="Define_a_New_Range_Using_an_Expression_for_Column_IndexDefine_Range"></a><span class="mw-headline">Define a New Range Using an Expression for Column Index<span class="OIndex" style="display:none">Define Range</span></span></h4>
<p>The <b><a href="../../LabTalk/LabTalk/WCol_(function).html" title="LabTalk:WCol (function)"><span class="OIndex">wcol()</span></a></b> function is used to allow runtime resolution of actual column index, as in
</p>
<pre class="lt" style="font-family:monospace;">int nn <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
range aa<span style="color: #000080;">=</span>wcol<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000080;">*</span>nn <span style="color: #000080;">+</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;</pre>
<h4><a name="Define_a_New_Range_Using_an_Existing_Range"></a><span class="mw-headline">Define a New Range Using an Existing Range</span></h4>
<p>The following lines of script demonstrate how to create one range based on another range variable using the <a href="../../LabTalk/LabTalk/String_Substitution.html" title="LabTalk:String Substitution"><span class="OIndex">%( ) substitution</span> notation</a> and <a href="../../LabTalk/LabTalk/Wks_(object).html" title="LabTalk:Wks (object)">wks (object) methods</a>. When the <b>%( )</b> substitution is used on a range variable, it is resolved to a rangestring. Sometimes <b>%()</b> can be skipped.
</p>
<pre class="lt" style="font-family:monospace;">range rpage<span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>book1<span style="color: #000000;">&#93;</span> <span style="color: #008000;">//define range variable for page</span>
range rwks <span style="color: #000080;">=</span> <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>rpage<span style="color: #000000;">&#41;</span>sheet1<span style="color: #000080;">!</span>; <span style="color: #008000;">//define rwks based on&#160;%(rpage)</span>

type <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>rwks<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//output rangestring [book1]sheet1! </span>

range r1<span style="color: #000080;">=</span> rwks<span style="color: #000080;">!</span>A; <span style="color: #008000;">//define r1 based on rwks,&#160;%() skipped though&#160;%(rwks)A also works</span>
type <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>r1<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//output rangestring [Book1]Sheet1!A</span>
r1<span style="color: #000080;">=</span>data<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span>,<span style="color: #0000dd;">100</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//fill r1 with 0, 2, 4, ..., 100</span>

range subr1<span style="color: #000080;">=</span>r1<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">10</span><span style="color: #000000;">:</span><span style="color: #0000dd;">20</span><span style="color: #000000;">&#93;</span> <span style="color: #008000;">//define subr1 based on r1,&#160;%() skipped though&#160;%(r1)[10:20] also works</span>
type <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>subr1<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//output rangestring [Book1]Sheet1!A[10:20]</span></pre>
<p>This method of constructing new range based on higher level range is very useful for code centralization. 
</p>
<pre class="lt" style="font-family:monospace;">rpage.<span style="color: #000080;">longname</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;My Book&quot;</span>; <span style="color: #008000;">//rename page long name</span>
rwks.<span style="color: #000080;">addcol</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;<span style="color: #008000;">//add a column to specified sheet</span>
range r2 <span style="color: #000080;">=</span> rwks<span style="color: #000080;">!</span>wcol<span style="color: #000000;">&#40;</span>rwks.<span style="color: #000080;">ncols</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//define r2 as last (rightmost) column in rwks</span>
r2<span style="color: #000080;">=</span>subr1; <span style="color: #008000;">//fill r2 with subr1 values</span></pre>
<h4><a name="Refer_to_the_Last_Row.2C_Column_and_Sheet_Using_0"></a><span class="mw-headline">Refer to the Last Row, Column and Sheet Using 0</span></h4>
<p>The <b>0</b> notation refers to the last index(last row, last column or last sheet) of a range with dynamic end. For example,
</p>
<pre class="lt" style="font-family:monospace;">range rsheet<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span><span style="color: #000080;">!</span>; <span style="color: #008000;">//last sheet</span>
range right <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #000080;">!</span><span style="color: #0000dd;">0</span>; <span style="color: #008000;">//last(rightmost) column in last sheet</span>
range sub <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #000080;">!</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">10</span><span style="color: #000000;">:</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#93;</span>; <span style="color: #008000;">///cells from row 0 to last row of last column in last sheet</span>
range r2 <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>Book1<span style="color: #000000;">&#93;</span>Sheet1<span style="color: #000080;">!</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">:</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#93;</span>; <span style="color: #008000;">//from 2nd col, 3rd row to last column, last row</span></pre>
<h3><a name="X-Function_ArgumentX-Function_Argument.2C_RangeRange.2C_X-Function_Argument"></a><span class="mw-headline">X-Function Argument<span class="OIndex" style="display:none">X-Function Argument, Range</span><span class="OIndex" style="display:none">Range, X-Function Argument</span></span></h3>
<p>Many X-functions use ranges as arguments. For example, the <i>stats</i> X-Function takes a vector as input and calculates descriptive statistics on the specified range. So you can type rangestring:
</p>
<pre class="lt" style="font-family:monospace;">stats <span style="color: #000000;">&#91;</span>Book1<span style="color: #000000;">&#93;</span>Sheet2<span style="color: #000080;">!</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span>end<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// stats on the second sheet of book1</span>
stats Col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>;                <span style="color: #008000;">// stats on column 2 of active worksheet</span>

<span style="color: #008000;">// stats on block of cells, col 1-2, row 5-10</span>
stats <span style="color: #0000dd;">1</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">5</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">:</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">10</span><span style="color: #000000;">&#93;</span>;</pre>
<p>Or first define the range variable and then use range variable as argument
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Defines a range variable for cells from row 3 to row 5 of col(2) on 1st and 2nd sheets, </span>
range aa <span style="color: #000080;">=</span> <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">!</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">:</span><span style="color: #0000dd;">5</span><span style="color: #000000;">&#93;</span>; 
<span style="color: #008000;">//run statistics on the range;</span>
stats aa;</pre>
<p>The input vector argument for this X-Function is then specified by a range variable.
</p><p>Some X-Functions use a special type of range called XYRange, which is essentially a composite range containing X and Y as well as error bar ranges.
<br />The general syntax for an XYRange is 
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">&#40;</span>rangeX, rangeY<span style="color: #000000;">&#41;</span></pre>
<p>but you can also skip the rangeX portion and use the standard range notation to specify an XYRange, in which case the default X data is assumed.
<br />The following two notations are identical for XYRange,
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">&#40;</span>, rangeY<span style="color: #000000;">&#41;</span>
rangeY</pre>
<p>For example, the integ1 X-Function takes both input and output XYRange, 
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// integrate col(1) as X and col(2) as Y,</span>
<span style="color: #008000;">// and put integral curve into columns 3 as X and 4 as Y</span>
integ1 iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> oy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span>,<span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// same as above except result integral curve output to col(3) as Y,</span>
<span style="color: #008000;">// and sharing input's X of col(1):</span>
integ1 iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span> oy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span>;</pre>
<h2><a name="Listing.2C_Deleting.2C_and_Converting_Range_Variables"></a><span class="mw-headline">Listing, Deleting, and Converting Range Variables</span></h2>
<h3><a name="Listing_Range_VariablesList_Range_Variable"></a><span class="mw-headline">Listing Range Variables<span class="OIndex" style="display:none">List Range Variable</span></span></h3>
<p>Use the <b><a href="../../LabTalk/LabTalk/List_(command).html" title="LabTalk:List (command)"><span class="OIndex">list</span></a></b> LabTalk command to print a list of names and their defined bodies of all session variables including the range variables. For example:
</p>
<pre class="lt" style="font-family:monospace;">list a; <span style="color: #008000;">// List all session variables</span></pre>
<p>If you issue this command in the <a href="../../LabTalk/Script/From_Script_and_Command_Window.html" title="Script:From Script and Command Window"><span class="OIndex">Command Window</span></a>, it prints a list such as:
</p>
<pre class="lt" style="font-family:monospace;">Session<span style="color: #000000;">:</span>
 <span style="color: #0000dd;">1</span>       MYRANGE   <span style="color: #000000;">&#91;</span>book1<span style="color: #000000;">&#93;</span>sheet1<span style="color: #000080;">!</span>col<span style="color: #000000;">&#40;</span>b<span style="color: #000000;">&#41;</span>
 <span style="color: #0000dd;">2</span>         MYSTR  <span style="color: #ff00ff;">&quot;abc&quot;</span>
 <span style="color: #0000dd;">3</span>            PI   <span style="color: #0000dd;">3.1415926535898</span></pre>
<p>As of Origin 8.1, more <a href="../../LabTalk/LabTalk/Command_Statements.html" title="LabTalk:Command Statements">switches</a> have been added (given below) to list particular session variables:
</p>
<table class="simple">
<tr>
<th> Option
</th>
<th> What Gets Listed
</th>
<th> Option
</th>
<th> What Gets Listed
</th></tr>
<tr>
<td> a
</td>
<td> All session variables
</td>
<td> aa
</td>
<td> String arrays (session)
</td></tr>
<tr>
<td> ac
</td>
<td> Constants (session)
</td>
<td> af
</td>
<td> Local Function (session)
</td></tr>
<tr>
<td> afc
</td>
<td> Local Function Full Content (session)
</td>
<td> afp
</td>
<td> Local Function Prototype (session)
</td></tr>
<tr>
<td> ag
</td>
<td> Graphic objects (session)
</td>
<td> ar
</td>
<td> Range variables (session)
</td></tr>
<tr>
<td> as
</td>
<td> String variables (session)
</td>
<td> at
</td>
<td> Tree variables (session)
</td></tr>
<tr>
<td> av
</td>
<td> Numeric variables (session)
</td>
<td> --
</td>
<td> --
</td></tr></table>
<h3><a name="Deleting_Range_VariablesDelete_Range_Variable"></a><span class="mw-headline">Deleting Range Variables<span class="OIndex" style="display:none">Delete Range Variable</span></span></h3>
<p>To delete a range variable, use the <b><a href="../../LabTalk/LabTalk/Delete_(command).html" title="LabTalk:Delete (command)"><span class="OIndex">del</span><span class="OIndex HasShownIndex" style="display:none">delete</span></a></b> LabTalk command with the -ra switch.  For example:
</p>
<pre class="lt" style="font-family:monospace;">range aa<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;  <span style="color: #008000;">// aa = Col(1) of the active worksheet</span>
range ab<span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>;  <span style="color: #008000;">// ab = Col(2) of the active worksheet</span>
range ac<span style="color: #000080;">=</span><span style="color: #0000dd;">3</span>;  <span style="color: #008000;">// ac = Col(3) of the active worksheet</span>
range bb<span style="color: #000080;">=</span><span style="color: #0000dd;">4</span>;  <span style="color: #008000;">// bb = Col(4) of the active worksheet</span>
list a;      <span style="color: #008000;">// list all session variables; will include aa, ab, ac, bb</span>
del <span style="color: #000080;">-</span>ra a<span style="color: #000080;">*</span>;  <span style="color: #008000;">// delete all range variables beginning with the letter &quot;a&quot;</span>

<span style="color: #008000;">// The last command will delete aa, ab, and ac.</span></pre>
<p>The table below lists options for deleting variables.
</p>
<table class="simple">
<tr>
<th> Option
</th>
<th> What Gets Deleted/Cleared
</th>
<th> Option
</th>
<th> What Gets Deleted/Cleared
</th></tr>
<tr>
<td> ra
</td>
<td> Any Local/Session variable
</td>
<td> al
</td>
<td> same as -ra
</td></tr>
<tr>
<td> rar
</td>
<td> Range variable
</td>
<td> ras
</td>
<td> String variable
</td></tr>
<tr>
<td> rav
</td>
<td> Numeric variable
</td>
<td> rac
</td>
<td> Constant
</td></tr>
<tr>
<td> rat
</td>
<td> Tree variable
</td>
<td> raa
</td>
<td> String array
</td></tr>
<tr>
<td> rag
</td>
<td> Graphic object
</td>
<td> raf
</td>
<td> Local/Session Function
</td></tr></table>
<h3><a name="Converting_Range_to_UIDRange_to_UIDUID.2C_Range"></a><span class="mw-headline">Converting Range to UID<span class="OIndex" style="display:none">Range to UID</span><span class="OIndex" style="display:none">UID, Range</span></span></h3>
<p>Each Origin Object has a short name, long name, and  <a href="../../LabTalk/LabTalk/LabTalk_Objects.html#Object_Name_and_Universal_Identifier_.28UID.29" title="LabTalk:LabTalk Objects"><span class="OIndex">universal identifier</span></a> (<span class="OIndex">UID</span>).  You can convert between range variables and their UIDs as well as obtain the names of pages and layers using the functions <b>range2uid</b>, <b>uid2name</b>, and <b>uid2range</b>.  See <a href="../../LabTalk/LabTalk/LabTalk_Objects.html" title="LabTalk:LabTalk Objects">LabTalk Objects</a> for examples of use.
</p>
<h2><a name="Special_Notations_for_Range"></a><span class="mw-headline">Special Notations for Range</span></h2>
<h3><a name="Specifying_Multiple_Sheets"></a><span class="mw-headline">Specifying Multiple Sheets</span></h3>
<p>When referring to multiple sheets, use the general form of the worksheet data range string, combined with commas and colons to specify the range.
</p><p><br />
<b>[<i>Workbook</i>](<i>SheetA</i>,<i>SheetN</i>:<i>SheetM</i>)!<i>colBegin</i>[<i>rowIndex</i>]:<i>colEnd</i>[<i>rowIndex</i>]</b>
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Basic combination of three ranges:</span>
<span style="color: #000000;">&#40;</span>range1, range2, range3<span style="color: #000000;">&#41;</span>  

<span style="color: #008000;">// Common column ranges from multiple sheets:</span>
<span style="color: #000000;">&#40;</span>sheet1,sheet2,sheet3<span style="color: #000000;">&#41;</span><span style="color: #000080;">!</span>range1
<span style="color: #000000;">&#40;</span>sheet1,sheet3<span style="color: #000000;">:</span><span style="color: #0000dd;">5</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">!</span>range1
 
<span style="color: #008000;">// Common column ranges from a range of sheets   </span>
<span style="color: #000000;">&#40;</span>sheet1<span style="color: #000000;">:</span>sheetn<span style="color: #000000;">&#41;</span><span style="color: #000080;">!</span>range1</pre>
<p>For example:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// plot A(X)B(Y) from two sheets into the same graph.</span>
plotxy <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">!</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>; 

<span style="color: #008000;">// Activate workbook again and add more sheets and fill them with data.</span>
<span style="color: #008000;">// Plot A(X)B(Y) from all sheets between row2 and row10:</span>
plotxy <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span>end<span style="color: #000000;">&#41;</span><span style="color: #000080;">!</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">:</span><span style="color: #0000dd;">10</span><span style="color: #000000;">&#93;</span>;</pre>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Appends every worksheet in the active workbook into a new sheet in the book.</span>
wappend irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span>end<span style="color: #000000;">&#41;</span><span style="color: #000080;">!</span>;</pre>
<p>A more general discussion of <a href="../../LabTalk/LabTalk/Range_Notation.html#Composite_Range" title="LabTalk:Range Notation">Composite Range</a> is given below.
</p>
<h3><a name="XY_and_XYZ_Range"></a><span class="mw-headline">XY and XYZ Range</span></h3>
<p>Designed as inputs to particular X-Functions, an <span class="OIndex">XY Range</span>  is an ordered pair designating two worksheet columns as XY data. And the XY subrange is able to be <a href="../../LabTalk/LabTalk/Range_Notation.html#Specifying_Subrange_Using_X_Values" title="LabTalk:Range Notation">specified by using X values</a>. Similarly, an (<span class="OIndex">XYZ Range</span>) is an ordered triple containing three worksheet columns representing XYZ data.
</p><p><br />
For instance, the <a class="external text" href="../../XFunction/X-Function/Fitpoly.html"><b>fitpoly</b> X-Function</a> takes an XY range for both input and output:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Fit a 2nd order polynomial to the XY data in columns 1 and 2;</span>
<span style="color: #008000;">// Put the coefficients into column 3 and the XY fit data in cols 4 and 5:</span>
fitpoly iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> polyorder<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span> coef<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span> oy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">4</span>,<span style="color: #0000dd;">5</span><span style="color: #000000;">&#41;</span>;</pre>
<h3><a name="XY_Range_using_.23_and_.3F_for_X"></a><span class="mw-headline">XY Range using # and&#160;? for X</span></h3>
<p>There are two special characters '?' and '#' introduced in <font color="red">(8.0 SR3)</font> for range as an X-Function argument. '?' indicates that the range is forced to use worksheet designation, and will fail if the range designation does not satisfy the requirement. '#' means that the range ignores designations and uses row number as the X designation.  However, if the Y column has even sampling information, that sampling information will be used to provide X.
</p><p>For example:
</p>
<pre class="lt" style="font-family:monospace;">plotxy <span style="color: #000000;">&#40;</span>?, <span style="color: #0000dd;">5</span><span style="color: #000000;">&#41;</span>;        <span style="color: #008000;">// if col(5) happens to be X column call fails</span>
plotxy <span style="color: #000000;">&#40;</span>#, <span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>;        <span style="color: #008000;">// plot col(3) as Y and use row number as X</span></pre>
<p>These notations are particularly handy in the <a class="external text" href="../../XFunction/X-Function/Plotxy.html"><b>plotxy</b> X-Function</a>, as demonstrated here:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Plot all columns in worksheet using their column designations:</span>
plotxy <span style="color: #000000;">&#40;</span>?,<span style="color: #0000dd;">1</span><span style="color: #000000;">:</span>end<span style="color: #000000;">&#41;</span>;</pre>
<h3><a name="Tag_Notations_in_Range_Output"></a><span class="mw-headline">Tag Notations in Range Output</span></h3>
<p>Many X-Functions have an output range that can be modified with tags, including <i>template</i>, <i>name</i>, and <i>index</i>.
Here is an example that can be used by the Discrete Frequency X-Function, <a class="external text" href="../../XFunction/X-Function/Discfreqs.html"><b>discfreqs</b></a>
</p>
<pre class="lt" style="font-family:monospace;">discfreqs irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> freq<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> rd<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;[Result]&lt;new template:=table.otw index:=3&gt;&quot;</span>;</pre>
<p>The output is directed to a Workbook named <b>Result</b> by loading a template named TABLE.OTW as the third sheet in the Result book.
</p><p>Support of tag notation depends on the particular X-Function, so verify tag notation is supported before including in production code.
</p>
<h3><a name="Composite_Range"></a><span class="mw-headline">Composite Range</span></h3>
<p>A <span class="OIndex">Composite Range</span> is a range consisting of multiple subranges.  You can construct composite ranges using the following syntax:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Basic combination of three ranges:</span>
<span style="color: #000000;">&#40;</span>range1, range2, range3<span style="color: #000000;">&#41;</span>         

<span style="color: #008000;">// Common column ranges from multiple sheets:</span>
<span style="color: #000000;">&#40;</span>sheet1,sheet2,sheet3<span style="color: #000000;">&#41;</span><span style="color: #000080;">!</span>range1
<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>，<span style="color: #0000dd;">2</span>，<span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">!</span>range1

<span style="color: #008000;">// Common column ranges from a range of sheets   </span>
<span style="color: #000000;">&#40;</span>sheet1<span style="color: #000000;">:</span>sheet3<span style="color: #000000;">&#41;</span><span style="color: #000080;">!</span>range1           
<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">!!</span>range1</pre>
<p>To show how this works, we will use the <a class="external text" href="../../XFunction/X-Function/Wcellcolor.html"><b>wcellcolor</b> X-Function</a> to show range and <a class="external text" href="../../XFunction/X-Function/Plotxy.html"><b>plotxy</b></a> to show XYRange. Assuming we are working 
on the active book/sheet, with at least four columns filled with 
numeric data:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// color several different blocks with blue color</span>
wcellcolor <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">:</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#93;</span>, <span style="color: #0000dd;">1</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">5</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">:</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">5</span><span style="color: #000000;">&#93;</span>, <span style="color: #0000dd;">2</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">7</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span> color<span style="color: #000000;">&#40;</span>blue<span style="color: #000000;">&#41;</span>; 

<span style="color: #008000;">// set font color as red on some of them</span>
wcellcolor <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">:</span><span style="color: #0000dd;">4</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">5</span><span style="color: #000000;">&#93;</span>, <span style="color: #0000dd;">2</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">6</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">:</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">7</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span> color<span style="color: #000000;">&#40;</span>red<span style="color: #000000;">&#41;</span> font;</pre>
<p>To try <b>plotxy</b>, we will put some numbers into the first sheet, add a new sheet, and put more numbers into the second sheet.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// plot A(X)B(Y) from both sheets into the same graph.</span>
plotxy <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">!</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>; 

<span style="color: #008000;">// Activate workbook again and add more sheets and fill them with data.</span>
<span style="color: #008000;">// Plot A(X)B(Y) from all sheets between row2 and row10:</span>
plotxy <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span>end<span style="color: #000000;">&#41;</span><span style="color: #000080;">!</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">:</span><span style="color: #0000dd;">10</span><span style="color: #000000;">&#93;</span>;</pre>
<p><b>Note</b>: There exists an inherent ambiguity between a composite range, composed of ranges <b>r1</b> and <b>r2</b> as in (<b>r1</b>,<b>r2</b>), and an <a href="#XY_and_XYZ_Range">XY range</a> composed of columns named <b>r1</b> and <b>r2</b>, i.e., (<b>r1</b>,<b>r2</b>).  Therefore, it is important that one keep in mind what type of object is assigned to a given range variable!
</p>

