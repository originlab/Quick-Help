<h1 class="firstHeading">4.5.1 Mathematics</h1><p class='urlname' style='display: none'>Mathematics</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Interpolate_Data_on_given_X_Vector"><span class="tocnumber">1</span> <span class="toctext">Interpolate Data on given X Vector</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Average_Curves"><span class="tocnumber">2</span> <span class="toctext">Average Curves</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#2D_Interpolate"><span class="tocnumber">3</span> <span class="toctext">2D Interpolate</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Polygon_Area"><span class="tocnumber">4</span> <span class="toctext">Polygon Area</span></a></li>
</ul>
</div>

<h2><a name="Interpolate_Data_on_given_X_Vector"></a><span class="mw-headline">Interpolate Data on given X Vector</span></h2>
<pre class="lt" style="font-family:monospace;">pe_mkdir Interp1 path<span style="color: #000000;">:</span><span style="color: #000080;">=</span>aa<span style="color: #000080;">$</span>;  <span style="color: #008000;">//make a folder in the project named Interp1</span>
pe_cd aa<span style="color: #000080;">$</span>; <span style="color: #008000;">//open the folder Interp1 in project</span>
	
fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Mathematics\Interpolation.dat&quot;</span>;
newbook;
newsheet cols<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span> xy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;XYXY&quot;</span>; 
impasc;

Range rTime1 <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; <span style="color: #008000;">// col(1) of active sheet</span>
Range rData1 <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>; <span style="color: #008000;">// col(2) of active sheet</span>
Range rTime2 <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>; <span style="color: #008000;">// col(3) </span>
Range rData2 <span style="color: #000080;">=</span> <span style="color: #0000dd;">4</span>; <span style="color: #008000;">// col(4) </span>

interp1 ix<span style="color: #000000;">:</span><span style="color: #000080;">=</span>rTime2 iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span> rData1 method<span style="color: #000000;">:</span><span style="color: #000080;">=</span> spline ox<span style="color: #000000;">:</span><span style="color: #000080;">=</span>rData2&#160;;

plotxy iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span>rData1 plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">200</span> color<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
plotxy iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span>rData2 plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">200</span> color<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;</pre>
<p>The following example calculate the spline interpolation and create line plot for the data imported from file. 
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//import data from the samples folder</span>
string fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Curve Fitting\Exponential Decay.dat&quot;</span>;
newbook s<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;
newsheet cols<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span> xy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;XYYY&quot;</span>; 
impasc;

<span style="color: #008000;">//interpolate on the specified columns</span>
for<span style="color: #000000;">&#40;</span>i<span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>;i<span style="color: #000080;">&lt;</span><span style="color: #0000dd;">5</span>;i<span style="color: #000080;">++</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#123;</span>
interp1xy <span style="color: #000080;">-</span>r <span style="color: #0000dd;">2</span> iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>ExponentialDe<span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!$</span><span style="color: #000000;">&#40;</span>i<span style="color: #000000;">&#41;</span> method<span style="color: #000000;">:</span><span style="color: #000080;">=</span>spline npts<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">200</span>;
<span style="color: #000000;">&#125;</span>

plotxy <span style="color: #000000;">&#40;</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">5</span><span style="color: #000000;">&#41;</span>,<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">6</span><span style="color: #000000;">&#41;</span>,<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">7</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">200</span>; <span style="color: #008000;">//create line plot</span></pre>
<h2><a name="Average_Curves"></a><span class="mw-headline">Average Curves</span></h2>
<p>This example shows how to average multiple XY data that are monotonic in X but do not necessarily share X values.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000; font-style: regular;">/*
The sample data used is in OriginPath\Samples\Spectroscopy\DSC\Data folder

1. Load the data to different worksheets of the same book
2. use avecurves XF to average the A(X)B(Y) of all the sheets.
3. put the result into a new sheet
4. Plot the original into one graph and the averaged data into another graph
*/</span>

<span style="color: #008000;">// Load the sample data to separated sheets, using existing </span>
<span style="color: #008000;">// loadDSC.ogs</span>
string LoadDSCogsPath<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\LabTalk Script Examples\LoadDSC.ogs&quot;</span>;
<span style="color: #000080;">%</span>A<span style="color: #000080;">=</span>LoadDSCogsPath<span style="color: #000080;">$</span>;
if<span style="color: #000000;">&#40;</span><span style="color: #000080;">!</span>run.<span style="color: #000080;">section</span><span style="color: #000000;">&#40;</span><span style="color: #000080;">%</span>A, Main, <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>
	break <span style="color: #0000dd;">1</span>;
<span style="color: #008000;">// Data should be loaded now into active book</span>
string dscBook<span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #000080;">%</span>H;
<span style="color: #008000;">// plot all the data A(X), B(Y) first</span>
plotxy <span style="color: #000000;">&#91;</span>dscBook<span style="color: #000080;">$</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span>end<span style="color: #000000;">&#41;</span><span style="color: #000080;">!</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">200</span>;

<span style="color: #008000;">// Perform average on all the sheets data using interp average method with linear interpolation</span>
avecurves iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>dscBook<span style="color: #000080;">$</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span>end<span style="color: #000000;">&#41;</span><span style="color: #000080;">!</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> rd<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span><span style="color: #000080;">&lt;</span>input<span style="color: #000080;">&gt;</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">&lt;</span>new name<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Averaged Data&quot;</span><span style="color: #000080;">&gt;</span><span style="color: #000080;">!</span> method<span style="color: #000000;">:</span><span style="color: #000080;">=</span>ave interp<span style="color: #000000;">:</span><span style="color: #000080;">=</span>linear;
<span style="color: #008000;">// plot the averaged as well</span>
plotxy <span style="color: #000000;">&#91;</span>dscBook<span style="color: #000080;">$</span><span style="color: #000000;">&#93;</span><span style="color: #ff00ff;">&quot;Averaged Data&quot;</span><span style="color: #000080;">!</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">200</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span><span style="color: #000080;">&lt;</span>new<span style="color: #000080;">&gt;</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">&lt;</span>new<span style="color: #000080;">&gt;</span><span style="color: #000080;">!</span>;</pre>
<h2><a name="2D_Interpolate"></a><span class="mw-headline">2D Interpolate</span></h2>
<p>2D Interpolation/Extrapolation can be performed on matrix by using X function <a class="external text" href="../../XFunction/X-Function/Minterp2.html">minterp2</a>.
</p>
<dl><dd><a  class="image"><img alt="Interpolate.png" src="../images/Mathematics/Interpolate.png?v=31963" width="600"  /></a></dd></dl>
<pre class="lt" style="font-family:monospace;">newbook name<span style="color: #000000;">:</span><span style="color: #000080;">=</span>MyMatrix1 mat<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
 
<span style="color: #008000;">//set matrix dimision and values</span>
matrix <span style="color: #000080;">-</span>ps DIM <span style="color: #0000dd;">20</span> <span style="color: #0000dd;">20</span>;
matrix <span style="color: #000080;">-</span>ps X <span style="color: #0000dd;">0</span> <span style="color: #0000dd;">1</span>;
matrix <span style="color: #000080;">-</span>ps Y <span style="color: #0000dd;">0</span> <span style="color: #0000dd;">1</span>;
matrix <span style="color: #000080;">-</span>v x<span style="color: #000080;">*</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">-</span>x<span style="color: #000000;">&#41;</span><span style="color: #000080;">*</span>cos<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">4</span><span style="color: #000080;">*</span>PI<span style="color: #000080;">*</span>x<span style="color: #000000;">&#41;</span><span style="color: #000080;">*</span>sin<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">4</span><span style="color: #000080;">*</span>PI<span style="color: #000080;">*</span>y<span style="color: #000080;">^</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">^</span><span style="color: #0000dd;">2</span>;
<span style="color: #008000;">//interpolation with spline method</span>
minterp2 <span style="color: #000080;">-</span>r <span style="color: #0000dd;">2</span> im<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>active<span style="color: #000080;">&gt;</span> cols<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">50</span> rows<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">50</span> xmin<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> xmax<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> ymin<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> ymax<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> om<span style="color: #000000;">:</span><span style="color: #000080;">=</span>Interp;
 
<span style="color: #008000;">//plot the original matrix into contour graph</span>
plotm im<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>MyMatrix1<span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">226</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>Contour<span style="color: #000080;">&gt;</span>;
layer.<span style="color: #000080;">cmap</span>.<span style="color: #000080;">load</span><span style="color: #000000;">&#40;</span>Fire.<span style="color: #000080;">pal</span>,<span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">//plot the results matrix into contour graph</span>
plotm im<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>Interp<span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">226</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span><span style="color: #000080;">&lt;</span>new<span style="color: #000080;">&gt;</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">&lt;</span>new<span style="color: #000080;">&gt;</span>;
layer.<span style="color: #000080;">cmap</span>.<span style="color: #000080;">load</span><span style="color: #000000;">&#40;</span>Fire.<span style="color: #000080;">pal</span>,<span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
sec <span style="color: #000080;">-</span>p <span style="color: #0000dd;">0.1</span>;
layer.<span style="color: #000080;">matmaxptsenabled</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>; <span style="color: #008000;">// Turn off speed mode</span></pre>
<h2><a name="Polygon_Area"></a><span class="mw-headline">Polygon Area</span></h2>
<p>Assume you have the hysteresis loop just like this graph, you can use the script below to calculate the area of the Polygon. 
</p>
<dl><dd><a  class="image"><img alt="Loop.png" src="../images/Mathematics/Loop.png?v=31977" width="332"  /></a></dd></dl>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//Active the graph</span>
type Dataset     Loop Area;
doc <span style="color: #000080;">-</span>e d <span style="color: #008000;">// Loop through all plots in active graph window</span>
<span style="color: #000000;">&#123;</span>
polyarea iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000080;">%</span>C type<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
type <span style="color: #000080;">%</span>C       <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>polyarea.<span style="color: #000080;">Area</span>,<span style="color: #000080;">%</span>2.2f<span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span>

<span style="color: #008000; font-style: regular;">/*Results table
Index     Loop Area
Book1_B      0.23
Book1_C      0.16
Book1_D      0.11
*/</span></pre>






