<h1 class="firstHeading">5.6 Debug LabTalk Script</h1><p class='urlname' style='display: none'>Tutorial-Debug</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Summary"><span class="tocnumber">1</span> <span class="toctext">Summary</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#What_You_Will_Learn"><span class="tocnumber">2</span> <span class="toctext">What You Will Learn</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Using_Code_Builder"><span class="tocnumber">3</span> <span class="toctext">Using Code Builder</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Using_Skills"><span class="tocnumber">4</span> <span class="toctext">Using Skills</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="#win_-o.3B_layer_-o"><span class="tocnumber">4.1</span> <span class="toctext">win -o; layer -o</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#type"><span class="tocnumber">4.2</span> <span class="toctext">type</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#echo"><span class="tocnumber">4.3</span> <span class="toctext">echo</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8"><a href="#Error_Handling"><span class="tocnumber">5</span> <span class="toctext">Error Handling</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#LabTalk_Script_Precedence"><span class="tocnumber">6</span> <span class="toctext">LabTalk Script Precedence</span></a></li>
</ul>
</div>

<h2><a name="Summary"></a><span class="mw-headline">Summary</span></h2>
<p>Origin provides various tools to help you to develop and debug your LabTalk scripts.
</p>
<h2><a name="What_You_Will_Learn"></a><span class="mw-headline">What You Will Learn</span></h2>
<p>This tutorial will show you how to:
</p>
<ul><li> Debug LabTalk script by using Code Builder.</li>
<li> Debug LabTalk script by using some useful skills.</li>
<li> Handle the error to make LabTalk script running without interruption.</li>
<li> Understand the concepts of LabTalk script precedence.</li></ul>
<h2><a name="Using_Code_Builder"></a><span class="mw-headline">Using Code Builder</span></h2>
<p>Once you save the LabTalk script in a section of a text file with *.OGS type, you can use Code Builder to debug the LabTalk script.
</p><p>Following is an example that show you how to use Code Buider to do debugging.
</p>
<ol><li> Open the *.ogs file in Code Builder. </li>
<li> Set a breakpoint to a line by moving the cursor to that line and pressing F9 (or selecting <b>Debug:Toggle Breakpoints</b> from the menu, or clicking the <b>Toggle Breakpoint</b> button <a  class="image"><img alt="Button Toggle Breakpoint new.png" src="../images/Tutorial_Debug/Button_Toggle_Breakpoint_new.png?v=24285" width="25"  /></a>), or just click on the margin to the left of the line number.
<dl><dd><a  class="image"><img alt="Debug LabTalk example 01.png" src="../images/Tutorial_Debug/Debug_LabTalk_example_01.png?v=24276" width="407"  /></a></dd></dl></li>
<li> Run the section. You can select the current section name or just put the cursor to the line of section name, and then click the <b>Execute Current Section</b> button <a  class="image"><img alt="Button Execute Current Section new.png" src="../images/Tutorial_Debug/Button_Execute_Current_Section_new.png?v=24286" width="25"  /></a> or select <b>Debug:Execute Current Section</b> from the menu to run up the code to the specified line. Also, you can use the <a href="../../LabTalk/LabTalk/Run_(object).html#Methods:" title="LabTalk:Run (object)">run.section</a> object method to run the section.</li>
<li> Click the <b>Step Into</b> button <a  class="image"><img alt="Button Step Into new.png" src="../images/Tutorial_Debug/Button_Step_Into_new.png?v=24287" width="24"  /></a>(or press F8, or select <b>Debug: Step Into</b> from menu) to execute the script step by step to check the logic error. 
<dl><dd><a  class="image"><img alt="Debug LabTalk example 02.png" src="../images/Tutorial_Debug/Debug_LabTalk_example_02.png?v=24280" width="444"  /></a></dd></dl></li>
<li> If there is another breakpoint, you can click the <b>Go</b> button <a  class="image"><img alt="Button Go new.png" src="../images/Tutorial_Debug/Button_Go_new.png?v=24288" width="27"  /></a> to run up the script to the next breakpoint. After you finish the debugging, click the <b>Stop Debugging</b> button <a  class="image"><img alt="Button Stop Debugging new.png" src="../images/Tutorial_Debug/Button_Stop_Debugging_new.png?v=24289" width="28"  /></a> to end up the debugging.</li></ol>
<p>If there is a command line calling an LabTalk function, LabTalk callable OC function, another section in the same ogs or different ogs, you can choose if execute the code one line at a time including the called function (or called section, called ogs).
</p><p><b>Step Into</b>
</p><p>The Step Into feature lets you step through a called function to check for logic errors in the function.
</p>
<ol><li> Set a breakpoint at the line that calls <b>getminmax()</b> function.</li>
<li> Step through your code line by line until you reach the function call.  While the program is paused at the function call line, click the <b>Step Into</b> button <a  class="image"><img alt="Button Step Into new.png" src="../images/Tutorial_Debug/Button_Step_Into_new.png?v=24287" width="24"  /></a> on the Debug toolbar or select <b>Debug:Step Into</b>.</li>
<li> The debugger executes the function call statement and then pauses execution at the first line of the called section. 
<dl><dd><a  class="image"><img alt="Debug LabTalk example 03.png" src="../images/Tutorial_Debug/Debug_LabTalk_example_03.png?v=25180" width="578"  /></a></dd></dl></li></ol>
<p><b>Step Over</b>
</p><p>However, you can also step over a called function.  To do this, pause the code execution at the function call line that you want to step over (either by setting a breakpoint or by executing line by line up to the function call).  While the program is paused at the function call line, click the <b>Step Over</b> button <a  class="image"><img alt="Button Step Over new.png" src="../images/Tutorial_Debug/Button_Step_Over_new.png?v=25183" width="25"  /></a> on the Debug toolbar or select <b>Debug:Step Over</b>.  
</p><p>The debugger executes the function call and then pauses after the function returns.  
</p>
<dl><dd><a  class="image"><img alt="Debug LabTalk example 04.png" src="../images/Tutorial_Debug/Debug_LabTalk_example_04.png?v=25184" width="567"  /></a></dd></dl>
<p><b>Step Out</b>
</p><p>When execution is paused inside a function, you can click the <b>Step Out</b> button <a  class="image"><img alt="Button Step Out new.png" src="../images/Tutorial_Debug/Button_Step_Out_new.png?v=25192" width="27"  /></a> on the Debug toolbar or select <b>Debug:Step Out</b> to step out of the function. 
</p><p><b>Run to Cursor</b>
</p><p>If no breakpoint interrupts the routine, click the <b>Run to Cursor</b> button <a  class="image"><img alt="Button Run to Cursor new.png" src="../images/Tutorial_Debug/Button_Run_to_Cursor_new.png?v=25193" width="25"  /></a> or select <b>Debug: Run to Cursor</b>, the script will run until it reaches the location where the cursor is set.
</p><p>Additionally, you can open a labtalk script in code builder by the ed.open() method.
For example, to open the specified script file at the specified section in a Code Builder window, you can write script as below.
</p>
<pre class="lt" style="font-family:monospace;">cd <span style="color: #0000dd;">2</span>; <span style="color: #008000;">//Switch to the labtalk sacript sample folder of Origin</span>
ed.<span style="color: #000080;">open</span><span style="color: #000000;">&#40;</span>summarize_data.<span style="color: #000080;">ogs</span>,main<span style="color: #000000;">&#41;</span>;</pre>
<h2><a name="Using_Skills"></a><span class="mw-headline">Using Skills</span></h2>
<h3><a name="win_-o.3B_layer_-o"></a><span class="mw-headline">win -o; layer -o</span></h3>
<p>Although the <a href="../../LabTalk/LabTalk/Window_(command)&amp;action=edit&amp;redlink=1.html" class="new" title="LabTalk:Window (command) (page does not exist)">win -o</a> and <a href="../../LabTalk/LabTalk/Layer_(command)&amp;action=edit&amp;redlink=1.html" class="new" title="LabTalk:Layer (command) (page does not exist)">layer -o</a> command s aren't related to debugging, they are very useful to avoid errors from happenning.
</p><p>When working on an Origin Object, like a workbook or graph page/layer, a script always operates on the active window by default. But sometimes, you don't want to activate the target window as switching active windows or layers may have delay and may lead to unpredictable outcome. In this case, you'd better to use win -o or layer -o to enclose the script.
</p>
<pre class="lt" style="font-family:monospace;">newbook; <span style="color: #008000;">//new a workbook.</span>
<span style="color: #008000;">//import file to workbook.</span>
string fn1<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Spectroscopy\XPS\BTABA.DAT&quot;</span>; 
impasc fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>fn1<span style="color: #000080;">$</span>;
string mybk<span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #000080;">%</span>H; <span style="color: #008000;">//save the workbook name</span>
plotxy <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> o<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>new<span style="color: #000080;">&gt;</span>; <span style="color: #008000;">//create a graph, the graph window is active.</span>
<span style="color: #008000;">//run the script in curly brace for the workbook window.</span>
win <span style="color: #000080;">-</span>o mybk<span style="color: #000080;">$</span> 
<span style="color: #000000;">&#123;</span>
  newsheet;
  string fn2<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Spectroscopy\XPS\BTATI.DAT&quot;</span>; 
  impasc fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>fn2<span style="color: #000080;">$</span>;
  plotxy <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> o<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>new<span style="color: #000080;">&gt;</span>;
<span style="color: #000000;">&#125;</span></pre>
<h3><a name="type"></a><span class="mw-headline">type</span></h3>
<p><b>Type</b> can be use to print out the contents of the specified script file (.OGS file) in the current directory to the Command (or Script) window.
</p><p>For example,
</p>
<pre class="lt" style="font-family:monospace;">cd <span style="color: #0000dd;">2</span>;
type autofit; <span style="color: #008000;">//print the labtalk example file autofot.ogs.</span></pre>
<h3><a name="echo"></a><span class="mw-headline">echo</span></h3>
<p>To debug and trace, the system variable, <a href="../../LabTalk/LabTalk/System_Variables.html#ECHO" title="LabTalk:System Variables">Echo</a> prints scripts or error messages to the Command window (or Script window when it is entered there).
</p><p>For example, run the follwoing script in Script window. 
</p>
<pre class="lt" style="font-family:monospace;">echo<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
string aa<span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;abc&quot;</span>;
double aa<span style="color: #000080;">=</span><span style="color: #0000dd;">100</span>;</pre>
<p>Not only the general error meaage will show, but also the script line with error.
</p>
<pre class="lt" style="font-family:monospace;">AA<span style="color: #000000;">:</span>already declared as string, cannot redeclare in the same scope<span style="color: #000080;">!</span>
Error<span style="color: #000000;">:</span>double aa<span style="color: #000080;">=</span><span style="color: #0000dd;">100</span>  <span style="color: #008000;">//The script line with error will show after runing echo=1.</span></pre>
<h2><a name="Error_Handling"></a><span class="mw-headline">Error Handling</span></h2>
<p>When there is an error in your LabTalk code, the code will be interrupted at the point of the error and not execute any lines after the error. If you want the script to continue executing without interruption, you can consider using curly braces around the line(s) with error(s).
</p><p>For instance, run the following script,
</p>
<pre class="lt" style="font-family:monospace;">newbook name<span style="color: #000000;">:</span><span style="color: #000080;">=</span>abc option<span style="color: #000000;">:</span><span style="color: #000080;">=</span>lsname;
wks.<span style="color: #000080;">ncols</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span>;
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>data<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">10</span><span style="color: #000000;">&#41;</span>;
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>normal<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">10</span><span style="color: #000000;">&#41;</span>;
plotxy;
win <span style="color: #000080;">-</span>a abc;
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">+</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>;</pre>
<p>Col(1) and Col(2) will be filled with data, but the script will stop executing at the line "plotxy;" as no input has been specified. So Col(3) will not be filled.
</p><p>If you surround the line "plotxy;" with curly braces as below, 
</p>
<pre class="lt" style="font-family:monospace;">newbook name<span style="color: #000000;">:</span><span style="color: #000080;">=</span>abc option<span style="color: #000000;">:</span><span style="color: #000080;">=</span>lsname;
wks.<span style="color: #000080;">ncols</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span>;
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>data<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">10</span><span style="color: #000000;">&#41;</span>;
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>normal<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">10</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#123;</span>plotxy;<span style="color: #000000;">&#125;</span>
win <span style="color: #000080;">-</span>a abc;
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">+</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>;</pre>
<p>the next line will execute and Col(3) will be filled.
</p><p>For more details about error handling, you can read <a href="../../LabTalk/Script/Error_Handling.html" title="Script:Error Handling">this page</a>.
</p>
<h2><a name="LabTalk_Script_Precedence"></a><span class="mw-headline">LabTalk Script Precedence</span></h2>
<p>When a user-defined Origin C function has same name as a labtalk ogs file, the labtalk ogs file has higher precedence.
</p><p>For instance, create an Origin C function, "precedence",
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">void</span> precedence<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
MessageBox<span style="color: #000000;">&#40;</span>GetWindow<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>, <span style="color: #ff00ff;">&quot;This message is from OC code!&quot;</span>, <span style="color: #ff00ff;">&quot;OC&quot;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<p>Compile this Origin C function and then run 
</p>
<pre class="oc" style="font-family:monospace;">precedence;</pre>
<p>in the Script window. A message box will pop up saying "This message is from OC code!".
</p><p>Then create an ogs file,  name it "precedence.ogs", and save it in the User File folder with the following script:
</p>
<pre class="lt" style="font-family:monospace;">type <span style="color: #000080;">-</span>b <span style="color: #ff00ff;">&quot;This message is from OGS file!&quot;</span>;</pre>
<p>After that, run the below script in Script window:
</p>
<pre class="lt" style="font-family:monospace;">cd <span style="color: #0000dd;">1</span>;  <span style="color: #008000;">// current working directory</span>
precedence;</pre>
<p>A message box will appear saying "This message is from OGS file!". It illustrates the labtalk script has higher precedence.
</p>





