<h1 class="firstHeading">5.4 Objects in LabTalk</h1><p class='urlname' style='display: none'>Tutorial-objs</p>
<p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Summary"><span class="tocnumber">1</span> <span class="toctext">Summary</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#What_Will_You_Learn"><span class="tocnumber">2</span> <span class="toctext">What Will You Learn</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Steps"><span class="tocnumber">3</span> <span class="toctext">Steps</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Read_and_Write_Object_Properties"><span class="tocnumber">3.1</span> <span class="toctext">Read and Write Object Properties</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Use_Method_to_Operate_Object"><span class="tocnumber">3.2</span> <span class="toctext">Use Method to Operate Object</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Create_and_Manipulate_Graphic_Objects"><span class="tocnumber">3.3</span> <span class="toctext">Create and Manipulate Graphic Objects</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="Summary"></a><span class="mw-headline">Summary</span></h2>
<p>LabTalk script programming provides access to various <a href="../../LabTalk/LabTalk/LabTalk_Objects.html" title="LabTalk:LabTalk Objects">object</a> <a href="../../LabTalk/LabTalk/LabTalk_Objects.html#Properties" title="LabTalk:LabTalk Objects">properties</a> and <a href="../../LabTalk/LabTalk/LabTalk_Objects.html#Methods" title="LabTalk:LabTalk Objects">methods</a>. 
</p><p>The syntax to access an object property is:
</p><p><i><b>objName.property</b></i>(for numeric properties)
</p><p>or
</p><p><i><b>objName.property$</b></i>(for text properties)
</p><p><br />
While the syntax to operate a method is:
</p><p><i><b>objName.method(arguments)</b></i>
</p><p><br />
Objects may share some general properties or methods, but each object usually has its own unique properties and methods. Refer to the complete  <a href="../../LabTalk/Category/Alphabetical_Listing_of_Objects_(Labtalk).html" title="Category:Alphabetical Listing of Objects (Labtalk)">list of objects</a> for details about a specific object.
</p><p>Many objects are visible components of an Origin project such as Workbooks, Worksheets, Worksheet Column or a Dataplot in a graph. The correspondence between some Origin object and their OPJ component is listed below:
</p>
<table class="dialogcontroltable">

<tr>
<th><a href="../../LabTalk/LabTalk/Page_(object).html" title="LabTalk:Page (object)">Page Object</a>
</th>
<td>Workbook/Graph Window/Matrixbook
</td></tr>
<tr>
<th><a href="../../LabTalk/LabTalk/Wks_(object).html" title="LabTalk:Wks (object)">Wks Object</a>
</th>
<td>Worksheet/Matrixsheet
</td></tr>
<tr>
<th><a href="../../LabTalk/LabTalk/Layer_(object).html" title="LabTalk:Layer (object)">Layer Object</a>
</th>
<td>Graph Layer/Worksheet/Matrixsheet
</td></tr>
<tr>
<th><a href="../../LabTalk/LabTalk/Wks.Col_(object)&amp;action=edit&amp;redlink=1.html" class="new" title="LabTalk:Wks.Col (object) (page does not exist)">Wks.Col Object</a>
</th>
<td>Worksheet Column
</td></tr>
<tr>
<th><a href="../../LabTalk/LabTalk/Mat_(object).html" title="LabTalk:Mat (object)">Mat Object</a>
</th>
<td>Matrix Object
</td></tr>
<tr>
<th><a href="../../LabTalk/LabTalk/Datasets_(object).html" title="LabTalk:Datasets (object)">Dataset Object</a>
</th>
<td>Loose Dataset (not visible except in certain dialogs)
</td></tr>
<tr>
<th><a href="../../LabTalk/LabTalk/Graphic_Objects.html" title="LabTalk:Graphic Objects">Graphic Object</a>
</th>
<td>Labels/Arrows/Lines/User-created Graphic Elements
</td></tr></table>
<p>Other objects are not visible in the interface, such as the INI object or the System object.
</p>
<h2><a name="What_Will_You_Learn"></a><span class="mw-headline">What Will You Learn</span></h2>
<p>This tutorial will show you how to:
</p>
<ul><li>Get a property value from an object</li>
<li>Change the property value for an object</li>
<li>Use a method to operate an object</li>
<li>Create and manipulate a <b>Graphic Object</b></li></ul>
<h2><a name="Steps"></a><span class="mw-headline">Steps</span></h2>
<h3><a name="Read_and_Write_Object_Properties"></a><span class="mw-headline">Read and Write Object Properties</span></h3>
<p><b>Returning a Property Value</b>
</p>
<ol><li>Open Origin and make sure the <b>Script Window</b> is open. (If not, click <b>Window:Script Window</b> or <b>Shift + Alt + 3</b> to open)</li>
<li>Click the <a  class="image"><img alt="Button New Workbook.png" src="../images/Tutorial_Objects/Button_New_Workbook.png?v=0" width="23"  /></a> button in the <b>Standard</b> toolbar to create a new workbook, right click its title bar and choose <b>Properties</b> to open the <b>Window Properties</b> window.</li>
<li>Change its <b>Long Name</b> to be <b>For Testing</b> and <b>Short Name</b> to be <b>Test</b>, click <b>OK</b> to apply setting and close this dialog.</li>
<li>Make sure the workbook window of <b>Test</b> is active, and run the following script in the script window:</li></ol>
<ol start="5">
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//Read the property value(short name) in script window</span>
page.<span style="color: #000080;">name</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span>&#160;;
<span style="color: #008000;">//Assign the text property value(long name) to a string variable</span>
string str1<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> page.<span style="color: #000080;">longname</span><span style="color: #000080;">$</span>&#160;;
<span style="color: #008000;">//Assign the numeric property value(page width) to a double variable</span>
double width <span style="color: #000080;">=</span> page.<span style="color: #000080;">width</span>;</pre>
<li>You can see that the workbook short name - <b>Test</b> - is output to the <b>Script Window</b>. The remaining properties have been read into variables and may be output by executing the following script:</li>
<pre class="lt" style="font-family:monospace;">str1<span style="color: #000080;">$</span> <span style="color: #000080;">=</span>&#160;;<span style="color: #008000;">//It should return &quot;For Testing&quot; in Script Window</span>
width <span style="color: #000080;">=</span>&#160;;<span style="color: #008000;">//It should return the numeric value of page width</span></pre>
</ol>
<p><b>Set a Property Value</b>
</p>
<ol>
<li>Activate the workbook <b>Test</b>, we will use the <a href="../../LabTalk/LabTalk/Wks_(object).html" title="LabTalk:Wks (object)">wks object</a> to modify the worksheet name by passing a string to the property:</li>
<pre class="lt" style="font-family:monospace;">wks.<span style="color: #000080;">name</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Test1&quot;</span>;<span style="color: #008000;">//The worksheet name will be changed to Test1</span></pre>
<p><b>Note:</b> in this case, you can also use the <a href="../../LabTalk/LabTalk/Layer_(object).html" title="LabTalk:Layer (object)">layer object</a> to change the worksheet name.
</p>
<li>Set the number of columns in this worksheet to be 5.</li>
<pre class="lt" style="font-family:monospace;">wks.<span style="color: #000080;">nCols</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>;</pre>
<li>Use the <a href="../../LabTalk/LabTalk/Wks.Col_(object)&amp;action=edit&amp;redlink=1.html" class="new" title="LabTalk:Wks.Col (object) (page does not exist)">wks.col object</a> to modify the worksheet column properties.</li>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Set the Column 2 Long Name using page Long Name</span>
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">lname</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> page.<span style="color: #000080;">longname</span><span style="color: #000080;">$</span>;
<span style="color: #008000;">// Make column 2 wider</span>
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">width</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">12</span>;
<span style="color: #008000;">// Set Column 3 to be an Error Bar column</span>
wks.<span style="color: #000080;">col3</span>.<span style="color: #000080;">type</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;</pre>
</ol>
<p><b>Define a Range as an Object and Use its Properties</b>
</p><p>As mentioned in the summary section, <a href="../../LabTalk/Category/Origin_Objects.html" title="Category:Origin Objects">Origin Objects</a> are visible in the graphical interface and primary components of the Origin project file (OPJ). 
</p><p>Generally, the active component will be used by default if nothing is specified, if you want to manipulate an inactive component, either specify their name/index, or define a range and map the range to this component.
</p>
<ol>
<li>Click <b>File:Open Sample Projects:2D and Contour Graphs</b> to open the sample project and in <b>Project Explorer</b> navigate to the <b>/Multi Axis and Multi Panel/3Ys Y-YY/</b> folder, activate the <b>3Ys Y-YY</b> graph window, make sure layer 3 is active (by default).</li>
<li>Run the following script to change the dimension unit for active layer (layer3) to be Inch, instead of&#160;% of page.</li>
<pre class="lt" style="font-family:monospace;">layer.<span style="color: #000080;">unit</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;</pre>
<li>Change the dimension unit for layer 2 to be inch as well, by specifying the graph window name (optional in this case as the graph window is activated) and layer index.</li>
<pre class="lt" style="font-family:monospace;"><span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>page.<span style="color: #000080;">name</span><span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">!</span>layer2.<span style="color: #000080;">unit</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;</pre>
<p><b>Note:</b> You can check whether the unit setting is correct by clicking <b>Format:Layer</b> to open the <b>Plot Details - Layer Properties</b> dialog, go to <b>Size/Speed</b> tab, the option of <b>Units</b> should be changed to <b>Inch</b> for both Layer 2 and Layer 3.
</p>
<li>Define a range variable <b>lay2</b> and map it to Layer 2.</li>
<pre class="lt" style="font-family:monospace;">range lay2 <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span><span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>page.<span style="color: #000080;">name</span><span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#93;</span>layer2<span style="color: #000080;">!</span>;</pre>
<li>This range variable <b>lay2</b> then holds all properties of Layer 2, run the following script to change its width to 5 inches, and fill its background with LT Gray:</li>
<pre class="lt" style="font-family:monospace;">lay2.<span style="color: #000080;">width</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>;
lay2.<span style="color: #000080;">color</span> <span style="color: #000080;">=</span> color<span style="color: #000000;">&#40;</span>LT Gray<span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">//or you can use color index to define the fill color</span>
<span style="color: #008000;">//for example the script below works the same as the previous one</span>
<span style="color: #008000;">//lay2.color = 19;</span></pre>
<li>Use the property of page object to activate Layer 1</li>
<pre class="lt" style="font-family:monospace;">page.<span style="color: #000080;">active</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;</pre>
<li>Map the current active layer (Layer 1) to another range variable <b>lay1</b></li>
<pre class="lt" style="font-family:monospace;">range lay1 <span style="color: #000080;">=</span> <span style="color: #000080;">!</span>;</pre>
<li>Use the layer.axis sub-object to change the y axis type of layer 1 to <b>Linear</b></li>
<pre class="lt" style="font-family:monospace;">lay1.<span style="color: #000080;">y</span>.<span style="color: #000080;">type</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;</pre>
</ol>
<h3><a name="Use_Method_to_Operate_Object"></a><span class="mw-headline">Use Method to Operate Object</span></h3>
<ol>
<li>In an empty Origin project file, click the <a  class="image"><img alt="Button New Workbook.png" src="../images/Tutorial_Objects/Button_New_Workbook.png?v=0" width="23"  /></a> button to create a new workbook.</li>
<li>Click the <a  class="image"><img alt="Import Single ASCII.png" src="../images/Tutorial_Objects/Import_Single_ASCII.png?v=0" width="26"  /></a> button to import the file <b>Categorical_Data_1.dat</b> under <i>&lt;Origin EXE Folder&gt;\Samples\Graphing\</i> path.</li>
<p><b>Note:</b> You can also run the following script to import the file.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//Create a new workbook</span>
newbook;
<span style="color: #008000;">//Import the file</span>
string fn<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Graphing\Categorical_Data_1.dat&quot;</span>;
impASC fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>fn<span style="color: #000080;">$</span>; 
<span style="color: #008000;">//system.path.program$ is the property of a non-visible object.</span></pre>
<li>Add a single column to the end of the worksheet with the name <b>B2</b>.
<pre class="lt" style="font-family:monospace;">page.<span style="color: #000080;">xlcolname</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; <span style="color: #008000;">// Turn off Spreadsheet Cell Notation firstly</span>
wks.<span style="color: #000080;">addcol</span><span style="color: #000000;">&#40;</span>B2<span style="color: #000000;">&#41;</span>;</pre>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Tutorial_Objects/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>For the <a class="external text" href="../../UserGuide/UserGuide/Column_Short_Name_Restriction.html">Spreadsheet Cell Notation</a> in the workbook, please see <a class="external text" href="../../QuickHelp/QuickHelp/Turn_off_spreadsheet_cell_notation.html"><b>FAQ-849</b></a> for more information.
</p></td></tr></table>
</li>
<li>Insert a column <b>A1</b> before column <b>B</b>.
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//Select column B as current column</span>
wks.<span style="color: #000080;">col</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
<span style="color: #008000;">//Insert column A2 before current column</span>
wks.<span style="color: #000080;">insert</span><span style="color: #000000;">&#40;</span>A2<span style="color: #000000;">&#41;</span>;</pre> 
</li>
<li>Control the display of column label rows with the <i>wks.labels( )</i> method.</li>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//Remove row of Sparklines and Comments, only keep Long Name and Units</span>
wks.<span style="color: #000080;">labels</span><span style="color: #000000;">&#40;</span><span style="color: #000080;">-</span>CS<span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">//Or you can run the script below instead to get the same result</span>
<span style="color: #008000;">//wks.labels(LU);</span></pre>
<li>Set the column long names and units if necessary.</li>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//Set long name for column A2 and B2(the 4th column)</span>
col<span style="color: #000000;">&#40;</span>A2<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span>L<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Abb. Direction&quot;</span>;
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span>L<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Description&quot;</span>;
<span style="color: #008000;">//Set units for column B</span>
col<span style="color: #000000;">&#40;</span>B<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span>U<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;km/h&quot;</span>;</pre>
<li>Adjust column width in order to display all texts in one row.</li>
<pre class="lt" style="font-family:monospace;">wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">width</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span>;
wks.<span style="color: #000080;">col4</span>.<span style="color: #000080;">width</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">17</span>;</pre>
<li>Use the methods for string array and put the strings of wind description into it.</li>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//Define string arrays</span>
StringArray aa, bb;
<span style="color: #008000;">//Add a string to the string array aa</span>
aa.<span style="color: #000080;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Strong gale&quot;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">//Copy the string array aa to bb</span>
bb.<span style="color: #000080;">Copy</span><span style="color: #000000;">&#40;</span>aa<span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">//Append bb to aa</span>
aa.<span style="color: #000080;">Append</span><span style="color: #000000;">&#40;</span>bb<span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">//Append the other four strings as dataset, use , as delimiter.</span>
aa.<span style="color: #000080;">Append</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Strong breeze,Fresh breeze,Moderate gale,Moderate breeze&quot;</span>, <span style="color: #ff00ff;">&quot;,&quot;</span><span style="color: #000000;">&#41;</span>;</pre>
<li>Copy the contents in the string array aa to column D</li>
<pre class="lt" style="font-family:monospace;">aa.<span style="color: #000080;">CopyTo</span><span style="color: #000000;">&#40;</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;</pre>
<li>Use the method to manipulate strings in the first column and put the abbreviation to the second column. A <b>for</b> loop is used to simplify script.</li>
<pre class="lt" style="font-family:monospace;">for<span style="color: #000000;">&#40;</span>int ii<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>; ii<span style="color: #000080;">&lt;=</span>wks.<span style="color: #000080;">maxRows</span>; ii<span style="color: #000080;">++</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
   string str1<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span><span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>ii<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span>;
   <span style="color: #008000;">//Get the first letter from the left</span>
   string str2<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> str1.<span style="color: #000080;">Left</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">$</span>;
   <span style="color: #008000;">//Make str2 to be upper case</span>
   str2.<span style="color: #000080;">MakeUpper</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
   col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span><span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>ii<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> str2<span style="color: #000080;">$</span>;
<span style="color: #000000;">&#125;</span></pre>
<p><b>Note:</b>You can also use the csetvalues x-function, or "Set Column Values" dialog to call the built-in string functions to achieve the same effect.
</p>
</ol>
<h3><a name="Create_and_Manipulate_Graphic_Objects"></a><span class="mw-headline">Create and Manipulate Graphic Objects</span></h3>
<ol>
<li>Create a new graph window and draw a line object.</li>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//Create a graph window</span>
win <span style="color: #000080;">-</span>t plot; 
<span style="color: #008000;">//Declare a GObject named myLine attached to 'line1'</span>
GObject myLine <span style="color: #000080;">=</span> line1;
<span style="color: #008000;">//Now create the object (list -o shows 'line1') </span>
draw <span style="color: #000080;">-</span>n myLine <span style="color: #000080;">-</span>l <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">6</span>,<span style="color: #0000dd;">4</span><span style="color: #000000;">&#125;</span>;</pre>
<li>Now you can use either myLine or line1 to control the object properties.</li>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//Change the line color to be red</span>
myLine.<span style="color: #000080;">color</span> <span style="color: #000080;">=</span> color<span style="color: #000000;">&#40;</span>red<span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">//Change the arrow end shape</span>
line1.<span style="color: #000080;">arrowEndShape</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
<span style="color: #008000;">//Enable move in both horizontal and vertical directions</span>
line1.<span style="color: #000080;">hMove</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
line1.<span style="color: #000080;">vMove</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;</pre>
<li>Add a text label named as "myText" to the graph, displaying text "Distance". The label will be put to a specified position.</li>
<pre class="lt" style="font-family:monospace;">label <span style="color: #000080;">-</span>p <span style="color: #0000dd;">20</span> <span style="color: #0000dd;">50</span> <span style="color: #000080;">-</span>n myText Distance;</pre>
<li>Change the properties of the text label.</li>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//Set the text label background to be Shadow</span>
myText.<span style="color: #000080;">background</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;</pre>
<li>Add a script to the text object, and let it run after redrawn.This script will update the text in label according to the calculated line length of the line1 object, and keep the offset with the line object.</li>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//Pre-define a string in order not to use substitution notation</span>
string str1<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;$&quot;</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;(sqrt((line1.y2-line1.y)^2+(line1.x2-line1.x)^2), .2)&quot;</span>;
<span style="color: #008000;">//Make sure the script will run after all event</span>
myText.<span style="color: #000080;">script</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>;
<span style="color: #008000;">//Add the script text to the object</span>
myText.<span style="color: #000080;">script</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;myText.text$ = &quot;</span>Line Length <span style="color: #000080;">=</span> <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>str1<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span><span style="color: #ff00ff;">&quot;; doc -uw;&quot;</span>;</pre>
<li>Right click on the line object and choose <b>Programming Control</b>, set <b>Script, Run After</b> to be <b>Sized</b> and type in the following script in the script edit box, so that every time the line object is re-sized(i.e. length changed), the text label will be redrawn:</li>
<pre class="lt" style="font-family:monospace;">myText.<span style="color: #000080;">draw</span><span style="color: #000000;">&#40;</span>global<span style="color: #000000;">&#41;</span>;</pre> 
<p><b>Note:</b> similarly, you can run script to do this instead of using the <b>Programming Control</b> dialog, the script would be:
</p>
<pre class="lt" style="font-family:monospace;">line1.<span style="color: #000080;">script</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;
line1.<span style="color: #000080;">script</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;myText.draw(global);&quot;</span>;</pre>
<li>Connect the myLine object and myText object:</li>
<pre class="lt" style="font-family:monospace;">line1.<span style="color: #000080;">Connect</span><span style="color: #000000;">&#40;</span>myText, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">2</span>, <span style="color: #0000dd;">6</span><span style="color: #000000;">&#41;</span>;</pre>
<li>If you move the line object in the graph, the text label will move together and if you resize it, the text will also automatically update according to the new line length.</li>
</ol>


