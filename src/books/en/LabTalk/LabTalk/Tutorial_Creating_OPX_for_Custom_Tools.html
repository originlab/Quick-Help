<h1 class="firstHeading">5.13 Creating OPX for Custom Tools with Labtalk</h1><p class='urlname' style='display: none'>Tutorial-Creating-OPX-for-Custom-Tools</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Summary"><span class="tocnumber">1</span> <span class="toctext">Summary</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#What_Will_You_Learn"><span class="tocnumber">2</span> <span class="toctext">What Will You Learn</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Steps"><span class="tocnumber">3</span> <span class="toctext">Steps</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Install_an_OPX_File"><span class="tocnumber">3.1</span> <span class="toctext">Install an OPX File</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Create_Custom_Buttons"><span class="tocnumber">3.2</span> <span class="toctext">Create Custom Buttons</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Create_OPX_File_for_Custom_Tools"><span class="tocnumber">3.3</span> <span class="toctext">Create OPX File for Custom Tools</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Edit_the_OPX_file"><span class="tocnumber">3.4</span> <span class="toctext">Edit the OPX file</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Share_the_OPX_file"><span class="tocnumber">3.5</span> <span class="toctext">Share the OPX file</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="Summary"></a><span class="mw-headline">Summary</span></h2>
<p>In Origin, it is possible to pack your own LabTalk script as an .opx file and share it with others. In addition, you could create a custom button calling the LabTalk script and also include this button in the .opx file for sharing.
</p>
<h2><a name="What_Will_You_Learn"></a><span class="mw-headline">What Will You Learn</span></h2>
<p>This tutorial will show you:
</p>
<ul><li>How to install an exiting OPX file</li>
<li>How to call the x-function using a LabTalk file(.OGS)</li>
<li>How to create the custom button(s) and export to a package file(.OPX) </li>
<li>How to update a file in the OPX and repack in the Package Manager</li>
<li>How to share the file with another machine</li></ul>
<h2><a name="Steps"></a><span class="mw-headline">Steps</span></h2>
<h3><a name="Install_an_OPX_File"></a><span class="mw-headline">Install an OPX File</span></h3>
<p>Drag and drop the OPX file <b>MyStatistics.opx</b> in the folder of <i>&lt;Origin Installation Directory&gt;/Samples/LabTalk Script Examples/</i>. This installed package includes four files:
</p>
<dl><dd><i>\OriginC\mystatistics.c</i></dd>
<dd><i>\OriginC\mystatistics.h</i></dd>
<dd><i>\X-Functions\Miscellaneous\normalitytest.OXF</i></dd>
<dd><i>\X-Functions\Miscellaneous\onettest.OXF</i></dd></dl>
<p>The folder structure of the files is also remembered in the package and will be recreated when the package is installed. 
<br />
</p>
<h3><a name="Create_Custom_Buttons"></a><span class="mw-headline">Create Custom Buttons</span></h3>
<p>In this section, you will learn how to use LabTalk script to call an X-Function (user-defined) and also how to create custom buttons which calls the LabTalk script file.
</p>
<ol>
<li><b>Create a OGS file to run the x-function</b>
<ul><li>Click on the <b>Code Builder</b> button.</li>
<li>In the <b>Code Builder</b> dialog, click on the <b>New</b> button to create a <b>LabTalk Script File</b> named <b>MyButton</b> in the User Files folder.</li>
<li>Enter the following script in it and save the file. Then close the <b>Code Build</b>.</li></ul>

<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Normality Test</span>
<span style="color: #000000;">&#91;</span>Normality<span style="color: #000000;">&#93;</span>
	normalitytest <span style="color: #000080;">-</span>d; 
		
<span style="color: #008000;">// One Sample t-Test</span>
<span style="color: #000000;">&#91;</span>ttest<span style="color: #000000;">&#93;</span>
	onettest <span style="color: #000080;">-</span>d;</pre>
<li><b>New a button group</b>
<br />
<ul><li>In the Origin menu, choose <b>View: Toolbars</b> to open the <b>Customize</b> dialog. </li>
<li>Go to the <b>Button Groups</b> tab, and click <b>New</b> button to open the <b>Create Button Group</b> dialog. </li>
<li>Set <i>MyButton</i> as the <b>Group Name</b>, select <i>6</i> in the <b>Number of Buttons</b> drop-down list , and choose the <i>Userdef.bmp</i> file from the User File Folder as <b>Bitmap</b>.</li></ul>
<a  class="image"><img alt="Create Button Group.png" src="../images/Tutorial_Creating_OPX_for_Custom_Tools/Create_Button_Group.png?v=25381" width="353"  /></a>
<ul><li>Click the <b>OK</b> button and save the <i>MyButton.ini</i> file to the default path. </li></ul>
<br />

<li>
<b>Setting the first button</b>
<br />
<ul><li>In the <b>Customize</b> dialog, select <b>MyButton</b> item from <b>Groups</b> list, and delete the first four buttons from <b>Buttons</b> panel. </li>
<li>Click to choose the <a  class="image"><img alt="Button1.png" src="../images/Tutorial_Creating_OPX_for_Custom_Tools/Button1.png?v=25317" width="21"  /></a>  button, then click <b>Settings</b> button from <b>Button</b> group to open the <b>Button Settings</b> dialog. </li>
<li>Choose <i>MyButton.ogs</i> as the <b>File Name</b>, type <i>Normality</i> in <b>Section Name</b> textbox, and make sure the following check-boxes are unchecked: <b>Matrix</b>, <b>Excel</b>, <b>Graph</b>,and  <b>Layout</b>. </li></ul>
<a  class="image"><img alt="Set Button1.png" src="../images/Tutorial_Creating_OPX_for_Custom_Tools/Set_Button1.png?v=25384" width="528"  /></a>
<ul><li>Click <b>OK</b> to close the dialog. </li></ul>
<br />

<li>
<b>Setting the second button</b>
<br />
<ul><li>Click to choose the <a  class="image"><img alt="Button2.png" src="../images/Tutorial_Creating_OPX_for_Custom_Tools/Button2.png?v=25318" width="22"  /></a>  button, then click <b>Settings</b> button from <b>Button</b> group to open the <b>Button Settings</b> dialog. </li>
<li>Choose <i>MyButton.ogs</i> as the <b>File Name</b>, type <i>ttest</i> in the <b>Section Name</b> textbox, and make sure the following check-boxes are unchecked: <b>Matrix</b>, <b>Excel</b>, <b>Graph</b>, and <b>Layout</b>. </li></ul>
<a  class="image"><img alt="Set Button2.png" src="../images/Tutorial_Creating_OPX_for_Custom_Tools/Set_Button2.png?v=25387" width="528"  /></a>
<ul><li>Click <b>OK</b> to close the dialog. </li></ul>
<br />
</ol>
<h3><a name="Create_OPX_File_for_Custom_Tools"></a><span class="mw-headline">Create OPX File for Custom Tools</span></h3>
<p>Now you have a custom tool which associated with several LabTalk script, X-Functions, and Origin C files, you can create an OPX file and share this custom tool with others:
</p>
<ol><li>Click Export to open the Export Button Group dialog, then click <b>Add File</b> button and choose these four files in the User Files folder</li></ol>
<dl><dd><i>\OriginC\mystatistics.c</i></dd>
<dd><i>\OriginC\mystatistics.h</i></dd>
<dd><i>\X-Functions\Miscellaneous\normalitytest.OXF</i></dd>
<dd><i>\X-Functions\Miscellaneous\onettest.OXF</i></dd></dl>
<p><a  class="image"><img alt="Export ButtonGroup.png" src="../images/Tutorial_Creating_OPX_for_Custom_Tools/Export_ButtonGroup.png?v=25386" width="296"  /></a>
</p>
<ol><li>Click <b>Export</b> button, then save the MyButton.OPX file to the User Files folder. </li>
<li>Close the <b>Customize</b> dialog.</li></ol>
<p><br />
</p>
<h3><a name="Edit_the_OPX_file"></a><span class="mw-headline">Edit the OPX file</span></h3>
<p>If you update the OC or X-function files that are packaged in the OPX file, you can update the OPX file by <b>Package Manager</b>.We assume the file <i>\X-Functions\Miscellaneous\normalitytest.OXF</i> has been updated, so we need to repack it in the OPX file.
</p>
<ol>
<li>
Select <b>Tool: Package Manager</b> in the main menu to open the dialog. In the dialog, select <b>File: Open</b> in the menu and open the <i>MyButton.OPX</i> file in the User Files folder.

<li>Click the <b>Repack Files</b> button to pack the files again.

<li>Under the <b>Package</b> node, update the <b>Version</b> to <b>2</b>.

<li>Choose <b>Save</b> on the <b>File</b> menu and close the dialog. 
</ol>
<h3><a name="Share_the_OPX_file"></a><span class="mw-headline">Share the OPX file</span></h3>
<p>You can share the OPX files to another user.
</p>
<ol>
<li>Copy the OPX file in the another machine, then drag and drop the <b>MyButton.opx</b> file in Origin. 

<li>When the package is installed successfully, you will find the new toolbar showing in the Origin. 

<li>Select <b>Tool: Package Manager</b> in the main menu to open the dialog. In the dialog, select <b>Tools: Browse Installed Package...</b> . Then the installed packages are listed in the dialog. You can browse the packages information such as name, version, and description, and uninstall the selected package if you wish. 
</ol>






