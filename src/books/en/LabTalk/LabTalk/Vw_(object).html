<h1 class="firstHeading">3.7.5.98 Vw</h1><p class='urlname' style='display: none'>Vw-obj</p>
<p><b>LabTalk Object Type:</b> 
</p>
<dl><dd><a href="../../LabTalk/Category/Origin_Object_Reference_(Labtalk).html" title="Category:Origin Object Reference (Labtalk)">External Object</a></dd></dl>
<p>The vw object does the following:
</p>
<ul><li>Creates a video and set its file name, file path and video dimensions.</li>
<li>Sets the compression method of the generated video and checks to see that the method is supported on the local computer.</li>
<li>Adds a specified graph as one or more frames, to write the video.</li></ul>
<p><br />
</p>
<h2><a name="Methods:"></a><span class="mw-headline"><font color="chocolate">Methods:</font></span></h2>
<table class="simple">
<tr>
<th width="180">Method
</th>
<th> Description
</th></tr>
<tr>
<td> <b>vw.Create(<i>fileName</i>, <i>codec</i>, <i>framepersec</i>, <i>width</i>, <i>height</i>)</b>
</td>
<td>
<p>Start creating a video with the specified file name (include complete file path), codec, frames per second (range from 0.001 to 120) and dimensions.<br />Return value:
</p>
<ul><li>0:successful.</li>
<li>Other values:failure and the value is the standard error code</li></ul>
</td></tr>
<tr>
<td> <b>vw.FourCC( )</b>
</td>
<td>
<p>Return the unique codec value from the four character code. The characters are case sensitive. For example: <b>vw.FourCC('F', 'M', 'P', '4')</b>. This value is used as the <i>codec</i> in vw.Create. See the <a href="../../LabTalk/LabTalk/FourCC_Table.html" title="LabTalk:FourCC Table">FourCC Table</a> for details.
</p>
</td></tr>
<tr>
<td> <b>vw.IsCodecInstalled(<i>int codec</i>)</b>
</td>
<td>
<p>Check whether the codec is supported on your computer.<br />Return value:
</p>
<ul><li>0:The compression method is not supported on the computer.</li>
<li>1:The compression method is supported on the computer. </li></ul>
</td></tr>
<tr>
<td><b>vw.WriteGraph(<i>WindowName</i>, <i>numFrames</i>)</b>
</td>
<td>
<p>Write a specified window to the video being created and, optionally, specify the number of frames. While generally intended for graph windows, the function works with workbooks, matrixbooks, graphs, function plots and layout windows. If the number of frames is not specified, then one frame is written. If WindowName is not specified, then the active window is written.<br />Return value:
</p>
<ul><li>0:successful.</li>
<li>Other values:failure and the value is the standard error code</li></ul>
</td></tr>
<tr>
<td><b>vw.Release( )</b>
</td>
<td>
<p>Release the video writer and generate the video using previously chosen settings and the written frames.<br />Return value:
</p>
<ul><li>0:successful.</li>
<li>1:failure</li></ul>
</td></tr></table>
<h2><a name="Examples:"></a><span class="mw-headline"><font color="chocolate">Examples:</font></span></h2>
<p>This script specifies a codec and checks to see that it is supported on the local computer. If not, the codec value is changed to 0, indicating no compression.
</p>
<pre class="lt" style="font-family:monospace;">int codec <span style="color: #000080;">=</span> vw.<span style="color: #000080;">FourCC</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">'F'</span>,<span style="color: #ff00ff;">'M'</span>,<span style="color: #ff00ff;">'P'</span>,<span style="color: #ff00ff;">'4'</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//The compression method of MPEG4</span>
if<span style="color: #000000;">&#40;</span>vw.<span style="color: #000080;">IsCodecInstalled</span><span style="color: #000000;">&#40;</span>codec<span style="color: #000000;">&#41;</span> <span style="color: #000080;">==</span> <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span> <span style="color: #008000;">//Check whether this compression method is supported</span>
codec <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; <span style="color: #008000;">//If it's not supported.</span>
<span style="color: #008000;">//Showing whether a compression method is chosen</span>
if<span style="color: #000000;">&#40;</span>codec<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
  type <span style="color: #ff00ff;">&quot;The compression method is MPEG4&quot;</span>;
<span style="color: #000000;">&#125;</span>
else
<span style="color: #000000;">&#123;</span>
  type <span style="color: #ff00ff;">&quot;MPEG4 not supported, no compression is chosen&quot;</span>;
<span style="color: #000000;">&#125;</span></pre>
<p>The following script shows how to create a video with existing graphs.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//Create a video example.avi under d:\ disk use default settings.</span>
int err <span style="color: #000080;">=</span> vw.<span style="color: #000080;">Create</span><span style="color: #000000;">&#40;</span>d<span style="color: #000000;">:</span>\example.<span style="color: #000080;">avi</span><span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">//Write existing graphs into the video if the video can be created.</span>
if<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> err<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    <span style="color: #008000;">//Write specified graphs to video as one or more frames.</span>
    vw.<span style="color: #000080;">WriteGraph</span><span style="color: #000000;">&#40;</span>Graph1,<span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>;<span style="color: #008000;">//Add Graph1 as 3 frames</span>
    vw.<span style="color: #000080;">WriteGraph</span><span style="color: #000000;">&#40;</span>Graph2,<span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>;<span style="color: #008000;">//Add Graph2 as 2 frames</span>
    vw.<span style="color: #000080;">WriteGraph</span><span style="color: #000000;">&#40;</span>Graph3,<span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;<span style="color: #008000;">//Add Graph3 as 1 frame</span>
    vw.<span style="color: #000080;">WriteGraph</span><span style="color: #000000;">&#40;</span> <span style="color: #000000;">&#41;</span>;<span style="color: #008000;">//Add the active graph as 1 frame by default</span>
<span style="color: #000000;">&#125;</span>
<span style="color: #008000;">//Release the video writer</span>
vw.<span style="color: #000080;">Release</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</pre>
<p><b>Note:</b> the <b>vw.Create( )</b> method does not have a default value for the first parameter: <i>fileName</i>. You need to specify it along with the full file path. Other parameters have default values: codec = 0 (no compression), framepersec = 1, width= 640, height=480. Also, each time you use the <b>vw.Create( )</b> method, you must use <b>vw.Release( )</b> to release the video writer before you use <b>vw.Create( )</b> again. So you cannot, for example, change the codec, frame rate or video dimensions in a single file.
</p><p><br />
There is also a <a href="../../LabTalk/LabTalk/Export.html#Export_Videos" title="LabTalk:Export">full example</a> of how to create graph animation.
</p>





