<h1 class="firstHeading">2.3.1.6 Functions</h1><p class='urlname' style='display: none'>Functions</p>
<p>Functions are the core of almost every programming language; the following introduces function syntax and use in LabTalk.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Built-In_Functions"><span class="tocnumber">1</span> <span class="toctext">Built-In Functions</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#User-Defined_Functions"><span class="tocnumber">2</span> <span class="toctext">User-Defined Functions</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Passing_Arguments_by_Reference"><span class="tocnumber">2.1</span> <span class="toctext">Passing Arguments by Reference</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4"><a href="#Dataset_Functions"><span class="tocnumber">3</span> <span class="toctext">Dataset Functions</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Fitting_Functions"><span class="tocnumber">4</span> <span class="toctext">Fitting Functions</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Scope_of_Functionsscope_of_a_function"><span class="tocnumber">5</span> <span class="toctext">Scope of Functions<span class="OIndex" style="display:none">scope of a function</span></span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#Examples:_Scope_of_Functions"><span class="tocnumber">5.1</span> <span class="toctext">Examples: Scope of Functions</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8"><a href="#Tutorial:_Using_Multiple_Function_Features"><span class="tocnumber">6</span> <span class="toctext">Tutorial: Using Multiple Function Features</span></a></li>
</ul>
</div>

<h2><a name="Built-In_Functions"></a><span class="mw-headline">Built-In Functions</span></h2>
<p>LabTalk supports many operations through <span class="OIndex">built-in function</span><span class="OIndex HasShownIndex" style="display:none">Function, Built-in</span>s, a listing and description of each can be found in <a href="../../LabTalk/Category/Function_Reference_(Labtalk).html" title="Category:Function Reference (Labtalk)">Function Reference</a>.  Functions are called with the following syntax:
</p><p><b><i>outputVariable</i> = <i>FunctionName</i>(Arg1, Arg2, ..., Arg N);</b>
</p><p>Below are a few examples of built-in functions in use.
</p><p>The <a href="../../LabTalk/LabTalk/Count_(function).html" title="LabTalk:Count (function)"><b>Count</b> (Function)</a> returns an integer count of the number of elements in a vector.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Return the number of elements in Column A of the active worksheet:</span>
int cc <span style="color: #000080;">=</span> count<span style="color: #000000;">&#40;</span>col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;</pre>
<p>The <a href="../../LabTalk/LabTalk/Ave_(function).html" title="LabTalk:Ave (function)"><b>Ave</b> (Function)</a> performs a group average on a dataset, returning the result as a range variable.
</p>
<pre class="lt" style="font-family:monospace;">range ra <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>Book1<span style="color: #000000;">&#93;</span>Sheet1<span style="color: #000080;">!</span>Col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span>;
range rb <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>Book1<span style="color: #000000;">&#93;</span>Sheet1<span style="color: #000080;">!</span>Col<span style="color: #000000;">&#40;</span>B<span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// Return the group-averaged values:</span>
rb <span style="color: #000080;">=</span> ave<span style="color: #000000;">&#40;</span>ra, <span style="color: #0000dd;">5</span><span style="color: #000000;">&#41;</span>;    <span style="color: #008000;">// 5 = group size</span></pre>
<p>The <a href="../../LabTalk/LabTalk/Sin_(function).html" title="LabTalk:Sin (function)"><b>Sin</b> (Function)</a> returns the sine of the input angle as type <b>double</b> (the units of the input angle are determined by the value of <b>system.math.angularunits</b>):
</p>
<pre class="lt" style="font-family:monospace;">system.<span style="color: #000080;">math</span>.<span style="color: #000080;">angularunits</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;  <span style="color: #008000;">// 1 = input in degrees</span>
double dd <span style="color: #000080;">=</span> sin<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">45</span><span style="color: #000000;">&#41;</span>;         <span style="color: #008000;">// ANS: DD = 0.7071</span></pre>
<p>For functions that return type is a dataset or stringarray, you can use [index] to get the corresponding data in the array and use it in expression.
</p><p>The <a href="../../LabTalk/LabTalk/Unique_(function).html" title="LabTalk:Unique (function)"><b>Unique</b> (Function)</a> returns a list of unique number or strings in specified dataset. 
</p>
<pre class="lt" style="font-family:monospace;">Col<span style="color: #000000;">&#40;</span>B<span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>unique<span style="color: #000000;">&#40;</span>col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span>, <span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//get unique numbers in column A, descending, 2nd arguement means descending</span>

<span style="color: #008000;">//2nd argument skipped so output will be ascending</span>
<span style="color: #008000;">//[index] - 1st value in output which is the smallest value</span>
Col<span style="color: #000000;">&#40;</span>C<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">=</span>unique<span style="color: #000000;">&#40;</span>col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span>; <span style="color: #008000;">//column C row 1 will be filled the smallest unique number found in A</span>

<span style="color: #008000;">//[0] is the last index so unique(Col(A))[0] will refer to biggest unique number found in A</span>
Col<span style="color: #000000;">&#40;</span>D<span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>Col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span><span style="color: #000080;">-</span>unique<span style="color: #000000;">&#40;</span>col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#93;</span>;</pre>
<h2><a name="User-Defined_Functions"></a><span class="mw-headline">User-Defined Functions</span></h2>
<p>Multi-argument <span class="OIndex">user-defined function</span><span class="OIndex HasShownIndex" style="display:none">Function, User Define</span>s has been supported in LabTalk since Origin 8.1. The syntax for user-defined functions is:
</p><p><b>function <i>dataType</i> <i>funcName</i>(<i>Arg1</i>, <i>Arg2</i>, ..., <i>ArgN</i>)</b>
<b>{<i>script</i>;}</b>
</p>
<p class="version" >Minimum Origin Version Required: 8.6 SR0</p>
<p>Note:
</p>
<ol>
<li>The function name should be less than 42 characters. 

<li>Both arguments and return values support <b>string, double, int, dataset</b>, and <b>tree</b> data types. The default argument type is <b>double</b>. The default return type is <b>int</b>.

<li>By default, arguments of user-defined functions are passed by value, meaning that argument values inside the function are <i>NOT</i> available outside of the function.  However, <a href="#Passing_Arguments_by_Reference">passing arguments by reference</a>, in which changes in argument values inside the function <i>WILL</i> be available outside of the function, is possible with the keyword <b>REF</b>.
</ol>
<p>Here are some simple cases of numeric functions:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// This function calculates the cube root of a number</span>
function double dCubeRoot<span style="color: #000000;">&#40;</span>double dVal<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    double xVal;
    if<span style="color: #000000;">&#40;</span>dVal<span style="color: #000080;">&lt;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span> xVal <span style="color: #000080;">=</span> <span style="color: #000080;">-</span>exp<span style="color: #000000;">&#40;</span>ln<span style="color: #000000;">&#40;</span><span style="color: #000080;">-</span>dVal<span style="color: #000000;">&#41;</span><span style="color: #000080;">/</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>;
    else xVal <span style="color: #000080;">=</span> exp<span style="color: #000000;">&#40;</span>ln<span style="color: #000000;">&#40;</span>dVal<span style="color: #000000;">&#41;</span><span style="color: #000080;">/</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>;
    return xVal;
<span style="color: #000000;">&#125;</span>
<span style="color: #008000;">// As shown here</span>
dcuberoot<span style="color: #000000;">&#40;</span><span style="color: #000080;">-</span><span style="color: #0000dd;">8</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>;</pre>
<p>The function below calculates the geometric mean of a dataset:
</p>
<pre class="lt" style="font-family:monospace;">function double dGeoMean<span style="color: #000000;">&#40;</span>dataset ds<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    double dG <span style="color: #000080;">=</span> ds<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span>; 
    for<span style="color: #000000;">&#40;</span>int ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>&#160;; ii <span style="color: #000080;">&lt;=</span> ds.<span style="color: #000080;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>&#160;; ii<span style="color: #000080;">++</span><span style="color: #000000;">&#41;</span>
        dG <span style="color: #000080;">*</span><span style="color: #000080;">=</span> ds<span style="color: #000000;">&#91;</span>ii<span style="color: #000000;">&#93;</span>; <span style="color: #008000;">// All values in dataset multiplied together</span>
    return exp<span style="color: #000000;">&#40;</span>ln<span style="color: #000000;">&#40;</span>dG<span style="color: #000000;">&#41;</span><span style="color: #000080;">/</span>ds.<span style="color: #000080;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span>
<span style="color: #008000;">// Argument is anything returning a datset</span>
dGeoMean<span style="color: #000000;">&#40;</span>col<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Raw Data&quot;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>;</pre>
<p>This example defines a function that accepts a range argument and returns the mean of the data in that range:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Calculate the mean of a range</span>
function double dsmean<span style="color: #000000;">&#40;</span>range ra<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
   stats ra;
   return stats.<span style="color: #000080;">mean</span>;
<span style="color: #000000;">&#125;</span>
<span style="color: #008000;">// Pass a range that specifies all columns ...</span>
<span style="color: #008000;">// in the first sheet of the active book:</span>
range rAll <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span>end<span style="color: #000000;">&#41;</span>;
dsMean<span style="color: #000000;">&#40;</span>rAll<span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>;</pre>
<p>This example defines a function that counts the occurrences of a particular weekday in a Date dataset:
</p>
<pre class="lt" style="font-family:monospace;">function int iCountDays<span style="color: #000000;">&#40;</span>dataset ds, int iDay<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    int iCount <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
    for<span style="color: #000000;">&#40;</span>int ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>&#160;; ii <span style="color: #000080;">&lt;=</span> ds.<span style="color: #000080;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>&#160;; ii<span style="color: #000080;">++</span><span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        if<span style="color: #000000;">&#40;</span>weekday<span style="color: #000000;">&#40;</span>ds<span style="color: #000000;">&#91;</span>ii<span style="color: #000000;">&#93;</span>, <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">==</span> iDay<span style="color: #000000;">&#41;</span> iCount<span style="color: #000080;">++</span>;
    <span style="color: #000000;">&#125;</span>
    return iCount;
<span style="color: #000000;">&#125;</span>
<span style="color: #008000;">// Here we count Fridays</span>
iVal <span style="color: #000080;">=</span> iCountDays<span style="color: #000000;">&#40;</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>,<span style="color: #0000dd;">6</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// 6 is Friday in weekday(data, 1) sense</span>
iVal<span style="color: #000080;">=</span>;</pre>
<p>Functions can also return datasets ..
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Get only negative values from a dataset</span>
function dataset dsSub<span style="color: #000000;">&#40;</span>dataset ds1<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    dataset ds2;
    int iRow <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
    for<span style="color: #000000;">&#40;</span>int ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>&#160;; ii <span style="color: #000080;">&lt;=</span> ds1.<span style="color: #000080;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>&#160;; ii<span style="color: #000080;">++</span><span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        if<span style="color: #000000;">&#40;</span>ds1<span style="color: #000000;">&#91;</span>ii<span style="color: #000000;">&#93;</span> <span style="color: #000080;">&lt;</span> <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>
        <span style="color: #000000;">&#123;</span>
            ds2<span style="color: #000000;">&#91;</span>iRow<span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> ds1<span style="color: #000000;">&#91;</span>ii<span style="color: #000000;">&#93;</span>;
            iRow<span style="color: #000080;">++</span>;
        <span style="color: #000000;">&#125;</span>
    <span style="color: #000000;">&#125;</span>
    return ds2;
<span style="color: #000000;">&#125;</span>
<span style="color: #008000;">// Assign all negative values in column 1 to column 2</span>
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> dsSub<span style="color: #000000;">&#40;</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;</pre>
<p>or strings ..
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Get all values in a dataset where a substring occurs</span>
function string strFind<span style="color: #000000;">&#40;</span>dataset ds, string strVal<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    string strTest, strResult;
    for<span style="color: #000000;">&#40;</span> int ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>&#160;; ii <span style="color: #000080;">&lt;=</span> ds.<span style="color: #000080;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>&#160;; ii<span style="color: #000080;">++</span> <span style="color: #000000;">&#41;</span>
    <span style="color: #000000;">&#123;</span>
        strTest<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> ds<span style="color: #000000;">&#91;</span>ii<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span>;
        if<span style="color: #000000;">&#40;</span> strTest.<span style="color: #000080;">Find</span><span style="color: #000000;">&#40;</span>strVal<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">&gt;</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">&#41;</span>
        <span style="color: #000000;">&#123;</span>
            strResult<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>strResult<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>CRLF<span style="color: #000000;">&#41;</span><span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>strTest<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>;
        <span style="color: #000000;">&#125;</span>
    <span style="color: #000000;">&#125;</span>
    return strResult<span style="color: #000080;">$</span>;
<span style="color: #000000;">&#125;</span>
<span style="color: #008000;">// Gather all instances in column 3 where &quot;hadron&quot; occurs</span>
string MyResults<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> strFind<span style="color: #000000;">&#40;</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>,<span style="color: #ff00ff;">&quot;hadron&quot;</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">$</span>; <span style="color: #008000;">// Note ending '$'</span>
MyResults<span style="color: #000080;">$</span><span style="color: #000080;">=</span>;</pre>
<h3><a name="Passing_Arguments_by_Reference"></a><span class="mw-headline">Passing Arguments by Reference</span></h3>
<p><span class="OIndex" style="display:none">Pass Arguments to Function</span>
This example demonstrates a function that returns a <b>tree</b> node value as an int (one element of a <a href="../../LabTalk/LabTalk/Data_Types_and_Variables.html" title="LabTalk:Data Types and Variables">tree variable</a>).  In addition, passing by reference is illustrated using the <b>REF</b> keyword.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Function definition:</span>
Function int GetMinMax<span style="color: #000000;">&#40;</span>range rr, ref double min, ref double max<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span>
  stats rr;
  <span style="color: #008000;">//after running the stats XF, a LabTalk tree variable with the</span>
  <span style="color: #008000;">//same name is created/updated</span>
  min <span style="color: #000080;">=</span> stats.<span style="color: #000080;">min</span>;
  max <span style="color: #000080;">=</span> stats.<span style="color: #000080;">max</span>;
  return stats.<span style="color: #000080;">N</span>;
<span style="color: #000000;">&#125;</span>

<span style="color: #008000;">// Call function GetMinMax to find min max for an entire worksheet:</span>
double y1,y2;
int nn <span style="color: #000080;">=</span> getminmax<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span>end,y1, y2<span style="color: #000000;">&#41;</span>;
type <span style="color: #ff00ff;">&quot;Worksheet has $(nn) points, min=$(y1), max=$(y2)&quot;</span>;</pre>
<p>See this <a href="../../LabTalk/LabTalk/Curve_Fitting.html#Fit_Multiple_Columns_in_a_Worksheet" title="LabTalk:Curve Fitting">detailed example</a> on using tree variables in LabTalk functions and passing variables by reference.
</p><p>Another example of passing string argument by reference is given below that shows that the $ termination should not be used in the function call:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//return range string of the 1st sheet</span>
<span style="color: #008000;">//actual new book shortname will be returned by Name$</span>
Function string GetNewBook<span style="color: #000000;">&#40;</span>int nSheets, ref string Name<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	newbook sheet<span style="color: #000000;">:</span><span style="color: #000080;">=</span> nSheets result<span style="color: #000000;">:</span><span style="color: #000080;">=</span>Name<span style="color: #000080;">$</span>;	
	string strRange<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;[%(Name$)]1!&quot;</span>;	
	return strRange<span style="color: #000080;">$</span>;
<span style="color: #000000;">&#125;</span></pre>
<p>When calling the above function, it is very important that the Name$ argument should not have the $, as shown below:
</p>
<pre class="lt" style="font-family:monospace;">string strName<span style="color: #000080;">$</span>;
string strR<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> GetNewBook<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>, strName<span style="color: #000000;">&#41;</span><span style="color: #000080;">$</span>;
strName<span style="color: #000080;">$</span><span style="color: #000080;">=</span>;
strR<span style="color: #000080;">$</span><span style="color: #000080;">=</span>;</pre>
<h2><a name="Dataset_Functions"></a><span class="mw-headline">Dataset Functions</span></h2>
<p>Origin also supports defining mathematical functions that accept arguments of type double and return type double. The general syntax for such functions is:
</p><p><b>funcName(X) = <i>expressionInvolvingX</i></b>.
</p><p>We call these <span class="OIndex">dataset function</span>s because when they are defined, a dataset by that name is created.  This dataset, associated with the function, is then saved as part of the Origin project.  Once defined, a dataset function can be referred to by name and used as you would a built-in LabTalk function.
</p><p>For example, enter the following script in the Script window to define a function named <b>Salary</b>:  
</p>
<pre class="lt" style="font-family:monospace;">Salary<span style="color: #000000;">&#40;</span>x<span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">52</span> <span style="color: #000080;">*</span> x</pre>
<p>Once defined, the function may be called anytime as in,
</p>
<pre class="lt" style="font-family:monospace;">Salary<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">100</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span></pre>
<p>which yields the result <b>Salary(100)=5200</b>.  In this case, the resulting dataset has only one element.  But if a vector (or dataset) were passed as an input argument, the output would be a dataset containing the same number of elements as the input.
</p><p>As with other datasets, user-defined dataset functions are listed in dialogs such as <b>Plot Setup</b> (and can be plotted like any other dataset), and in the <b>Available Data</b> list in dialogs such as <b>Layer n</b>.
</p><p>If a 2D graph layer is the active layer when a function is defined, then a dataset of 100 points is created using the X axis scale as the X range and the function dataset is automatically added to the plot layer.
</p><p>The <b>Function Graph Template</b> (FUNCTION.OTP, accessible from the <b>Standard</b> Toolbar or the <b>File: New</b> menu) also creates and plots dataset functions. 
</p><p>Origin's <b>Function Plots</b> feature allows new dataset functions to be easily created from any combination of built-in and user-defined functions.  In addition, the newly created function is immediately plotted for your reference.
</p><p>Access this feature in either of two ways: 
</p>
<ol><li> Click on the <b>New Function</b> button in the <b>Standard</b> toolbar, <a  class="image"><img alt="Button New Function.png" src="../images/Functions/Button_New_Function.png?v=0" width="23"  /></a></li>
<li> From the Origin drop-down menus, select <b>File: New</b> and select <b>Function</b> from the list of choices, and click <b>OK</b>.</li></ol>
<p>From there, in the <b>Function</b> tab of the <b>Plot Details</b> dialog that opens, enter the function definition, such as, <i>F1(x) = 5*sin(x)+1</i> and press <b>OK</b>. The function will be plotted in the graph.
</p><p>You may define another function by clicking on the <b>New Function</b> button in the graph and adding another function in <b>Plot Details</b>.  Press <b>OK</b>, and the new function plot will be added to the graph.  Repeat if more functions are desired.
</p>
<h2><a name="Fitting_Functions"></a><span class="mw-headline">Fitting Functions</span></h2>
<p>In addition to supporting many common functions, Origin also allows you to create your own fitting functions to be used in non-linear curve fitting.  User-defined fitting functions can also be used to generate new datasets, but calling them requires a special syntax:
<span class="OIndex" style="display:none">nlf</span><span class="OIndex" style="display:none">nlf_funcname</span><span class="OIndex" style="display:none">nlf_function</span><span class="OIndex" style="display:none">nlf_FitFuncName</span><span class="OIndex" style="display:none">fitting function</span><span class="OIndex" style="display:none">call a fitting function</span>
</p><p><b>nlf_FitFuncName(ds, <i>p1</i>, <i>p2</i>, ..., <i>pn</i>)</b>
</p><p>where the fitting function is named <b>FitFuncName</b>, <b>ds</b> is a dataset to be used as the independent variable, and <i>p1</i>--<i>pn</i> are the parameters of the fitting function.
</p><p>As a simple example, if you defined a simple straight-line fitting function called <b>MyLine</b> that expected a y-intercept and slope as input parameters (in that order), and you wanted column C in the active worksheet to be the independent variable (X), and column D to be used for the function output, enter:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Intercept = 0, Slope = 4</span>
Col<span style="color: #000000;">&#40;</span>D<span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> nlf_MyLine<span style="color: #000000;">&#40;</span>Col<span style="color: #000000;">&#40;</span>C<span style="color: #000000;">&#41;</span>, <span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span></pre>
<h2><a name="Scope_of_Functionsscope_of_a_function"></a><span class="mw-headline">Scope of Functions<span class="OIndex" style="display:none">scope of a function</span></span></h2>
<p>As with user-defined variables, user-defined functions have a scope that can be controlled. User-defined functions can be accessed from anywhere in the Origin project where LabTalk script is supported, provided the scope of definition is applicable to such usage. Thus for example, a function defined with preceding assignment <b>@glob=1</b> that returns type double or dataset, can be used in the <b>Set Values</b> dialog <b>Column Formula</b> panel. For more on scope, see <a href="../../LabTalk/LabTalk/Data_Types_and_Variables.html#Scope_of_Variables" title="LabTalk:Data Types and Variables">Data Types and Variables</a>. 
</p>
<ul><li> You can associate functions with a project by defining them in the project's <a href="../../LabTalk/Script/ProjectEvents_Script.html" title="Script:ProjectEvents Script">ProjectEvents.OGS</a> file. Using <b>@glob=1</b>, your function becomes available any time the project is opened (see <a href="#Tutorial:_Using_Multiple_Function_Features">this example</a>, below).</li>
<li> The scope of a function can be expanded for general use any time that Origin runs by defining the function using <b>@glob=1</b>, saving the function to an .ogs file in <a class="external text" href="../../QuickHelp/QuickHelp/What_is_the_User_Files_Folder.html">the <b>User Files Folder</b> (<b>UFF</b>)</a>, and calling the .ogs file from the <b>[Startup]</b> section of Origin.ini (also in the UFF), as discussed <a href="../../LabTalk/Script/On_Starting_Origin.html" title="Script:On Starting Origin">here</a>.</li></ul>
<h3><a name="Examples:_Scope_of_Functions"></a><span class="mw-headline">Examples: Scope of Functions</span></h3>
<p>Using  <b>@glob=1</b> to call the function anywhere.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">&#91;</span>Main<span style="color: #000000;">&#93;</span>
	@glob<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;  <span style="color: #008000;">// promote the following function to session level</span>
	function double dGeoMean<span style="color: #000000;">&#40;</span>dataset ds<span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
	    double dG <span style="color: #000080;">=</span> ds<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span>; 
	    for<span style="color: #000000;">&#40;</span>int ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>&#160;; ii <span style="color: #000080;">&lt;=</span> ds.<span style="color: #000080;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>&#160;; ii<span style="color: #000080;">++</span><span style="color: #000000;">&#41;</span>
	        dG <span style="color: #000080;">*</span><span style="color: #000080;">=</span> ds<span style="color: #000000;">&#91;</span>ii<span style="color: #000000;">&#93;</span>; <span style="color: #008000;">// All values in dataset multiplied together</span>
	    return exp<span style="color: #000000;">&#40;</span>ln<span style="color: #000000;">&#40;</span>dG<span style="color: #000000;">&#41;</span><span style="color: #000080;">/</span>ds.<span style="color: #000080;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">&#125;</span>
	<span style="color: #008000;">// can call the function in [main] section</span>
	dGeoMean<span style="color: #000000;">&#40;</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>;
<span style="color: #000000;">&#91;</span>section1<span style="color: #000000;">&#93;</span>
	<span style="color: #008000;">// the function can be called in this section too</span>
	dGeoMean<span style="color: #000000;">&#40;</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>;</pre>
<p>If the function is defined in a section of a <b>*.ogs</b> file without <b>@glob=1</b>, then it can only be called in its own section.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">&#91;</span>Main<span style="color: #000000;">&#93;</span>
	function double dGeoMean<span style="color: #000000;">&#40;</span>dataset ds<span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
	    double dG <span style="color: #000080;">=</span> ds<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span>; 
	    for<span style="color: #000000;">&#40;</span>int ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>&#160;; ii <span style="color: #000080;">&lt;=</span> ds.<span style="color: #000080;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>&#160;; ii<span style="color: #000080;">++</span><span style="color: #000000;">&#41;</span>
	        dG <span style="color: #000080;">*</span><span style="color: #000080;">=</span> ds<span style="color: #000000;">&#91;</span>ii<span style="color: #000000;">&#93;</span>; <span style="color: #008000;">// All values in dataset multiplied together</span>
	    return exp<span style="color: #000000;">&#40;</span>ln<span style="color: #000000;">&#40;</span>dG<span style="color: #000000;">&#41;</span><span style="color: #000080;">/</span>ds.<span style="color: #000080;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">&#125;</span>
	<span style="color: #008000;">// can call the function in [main] section</span>
	dGeoMean<span style="color: #000000;">&#40;</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>;
<span style="color: #000000;">&#91;</span>section1<span style="color: #000000;">&#93;</span>
	<span style="color: #008000;">// the function can NOT be called in this section</span>
	dGeoMean<span style="color: #000000;">&#40;</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>;  <span style="color: #008000;">// an error: Unknown function</span></pre>
<p>If the function is defined in a block without <b>@glob=1</b>, it can not be called outside this block.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">&#91;</span>Main<span style="color: #000000;">&#93;</span>
<span style="color: #000000;">&#123;</span>  <span style="color: #008000;">// define the function between braces</span>
	function double dGeoMean<span style="color: #000000;">&#40;</span>dataset ds<span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
	    double dG <span style="color: #000080;">=</span> ds<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span>; 
	    for<span style="color: #000000;">&#40;</span>int ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>&#160;; ii <span style="color: #000080;">&lt;=</span> ds.<span style="color: #000080;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>&#160;; ii<span style="color: #000080;">++</span><span style="color: #000000;">&#41;</span>
	        dG <span style="color: #000080;">*</span><span style="color: #000080;">=</span> ds<span style="color: #000000;">&#91;</span>ii<span style="color: #000000;">&#93;</span>; <span style="color: #008000;">// All values in dataset multiplied together</span>
	    return exp<span style="color: #000000;">&#40;</span>ln<span style="color: #000000;">&#40;</span>dG<span style="color: #000000;">&#41;</span><span style="color: #000080;">/</span>ds.<span style="color: #000080;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span>
	<span style="color: #008000;">// can Not call the function outside the braces</span>
	dGeoMean<span style="color: #000000;">&#40;</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>;  <span style="color: #008000;">// an error: Unknown function</span></pre>
<h2><a name="Tutorial:_Using_Multiple_Function_Features"></a><span class="mw-headline">Tutorial: Using Multiple Function Features</span></h2>
<p>The following mini <span class="OIndex">tutorial</span><span class="OIndex HasShownIndex" style="display:none">Function Tutorial</span> shows how to add a user-defined function at the Origin project level and then use that function to create function plots. 
</p>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Functions/Tutorial_icon.png?v=0" width="57"  border="0" />
	</td>
	<td><ol><li> Start a new Project and use <b>View: Code Builder</b> menu item to open Code Builder.</li>
<li> Expand the Project branch on the left panel tree and double-click to open the <b>ProjectEvents.OGS</b> file. This file exists by default in any new Project. </li>
<li> Under the <b>[AfterOpenDoc]</b> section, add the following lines of code:<br />@glob=1;<br />Function double myPeak(double x, double x0)<br />{<br />    double y = 10*exp(-(x-x0)^2/4);<br />   return y;<br />}</li>
<li> Save the file and close Code Builder.</li>
<li> In Origin, save the Project to a desired folder location. The OGS file is saved with the Project, so the user-defined function is available for use in the Project.</li>
<li> Open the just saved project again. This will trigger the <b>[AfterOpenDoc]</b> section to be executed and thus our myPeak function to be defined.</li>
<li> Click on the <b>New 2D Plot </b> toolbar button in the <b>Standard</b> toolbar or choose <b>File: New: Function Plot: 2D Function Plot...</b> menu.</li>
<li> In the edit box after <b>Y(x) =</b>, enter <b>myPeak(x, 3)</b> and press Add. The function will be plotted in a graph.</li>
<li> With the dialog still open, modify the function to be <b>myPeak(x,4)</b>. Make sure the bottom dropdown list shows <b>Add to Active Graph</b>. Click <b>Add</b> button. The modified function plot is added to the graph. </li>
<li> Save the project and share with others. Since the <b>myPeak</b> function is defined upon loading the project, it is always accessible in the project.</li></ol>
</td></tr></table>


