<h1 class="firstHeading">2.4.1.2 X-Function Input and Output</h1><p class='urlname' style='display: none'>XF-Input-and-Output</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#X-Function_Variables"><span class="tocnumber">1</span> <span class="toctext">X-Function Variables</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Special_Keywords_for_Range"><span class="tocnumber">2</span> <span class="toctext">Special Keywords for Range</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#ReportData_Output"><span class="tocnumber">3</span> <span class="toctext">ReportData Output</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Sending_ReportData_to_Worksheet"><span class="tocnumber">3.1</span> <span class="toctext">Sending ReportData to Worksheet</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Sending_ReportData_to_Tree_Variable"><span class="tocnumber">3.2</span> <span class="toctext">Sending ReportData to Tree Variable</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Assigning_Literal_Strings_to_X-function_Input"><span class="tocnumber">4</span> <span class="toctext">Assigning Literal Strings to X-function Input</span></a></li>
</ul>
</div>

<h2><a name="X-Function_Variables"></a><span class="mw-headline">X-Function Variables</span></h2>
<p><span class="OIndex" style="display:none">X-Function Variables</span><span class="OIndex" style="display:none">X-Function Input</span><span class="OIndex" style="display:none">Input, X-Function</span><span class="OIndex" style="display:none">X-Function Output</span><span class="OIndex" style="display:none">Output X-Function</span>
X-Functions accept <a href="../../LabTalk/LabTalk/Data_Types_and_Variables.html" title="LabTalk:Data Types and Variables">LabTalk variable types</a> (except StringArray) as arguments. In addition to LabTalk variables, X-Functions also use special variable types for more complicated data structures. 
</p><p>These special variable types work only as arguments<span class="OIndex" style="display:none">X-Function Argument</span><span class="OIndex" style="display:none">Argument, X-Function</span> to X-Functions, and are listed in the table below (Please see the <b>Special Keywords for Range</b> section below for more details about available key words.):
</p>
<table class="simple">
<tr>
<th> Variable Type</th>
<th> Description</th>
<th> Sample Constructions</th>
<th> Comment
</th></tr>
<tr>
<td> XYRange
</td>
<td>
<p>A combination of X, Y, and optional Y Error Bar data
</p>
</td>
<td>
<ol><li> (1,2)</li>
<li> &lt;new&gt;</li>
<li> (1,2:end)</li>
<li> (&lt;input&gt;,&lt;new&gt;)</li>
<li> [book2]sheet3!&lt;new&gt;</li></ol>
</td>
<td> For graph, use index directly to indicate plot range<br />(1,2) means 1st and 2nd plots on graph
</td></tr>
<tr>
<td> XYZRange
</td>
<td>
<p>A combination of X, Y, and Z data
</p>
</td>
<td>
<ol><li> (1,2,3)</li>
<li> &lt;new&gt;</li>
<li> [book2]sheet3!(1,&lt;new&gt;,&lt;new&gt;)</li></ol>
</td>
<td>
</td></tr>
<tr>
<td> ReportTree
</td>
<td>
<p>A Tree based object for a Hierarchical Report<br />Must be associated with a worksheet range or a LabTalk Tree variable
</p>
</td>
<td>
<ol><li> &lt;new&gt;</li>
<li> [&lt;input&gt;]&lt;new&gt;</li>
<li> [book2]sheet3</li></ol>
</td>
<td>
</td></tr>
<tr>
<td> ReportData
</td>
<td>
<p>A Tree based object for a collection of vectors<br />Must be associated with a worksheet range or a LabTalk Tree variable. Unlike ReportTree, ReportData outputs to a regular worksheet and thus can be used to append to the end of existing data in a worksheet. All the columns in a ReportData object must be grouped together.
</p>
</td>
<td>
<ol><li> &lt;new&gt;</li>
<li> [&lt;input&gt;]&lt;new&gt;</li>
<li> [book2]sheet3</li>
<li> [&lt;input&gt;]&lt;input&gt;!&lt;new&gt;</li></ol>
</td>
<td>
</td></tr></table>
<p>To understand these variable types better, please refer to the real examples in the <b>ReportData Output</b> section below, which have shown some concrete usages.
</p>
<h2><a name="Special_Keywords_for_Range"></a><span class="mw-headline">Special Keywords for Range</span></h2>
<p><span class="OIndex" style="display:none">Keyword for Range</span><span class="OIndex" style="display:none">Range Keyword</span>
</p>
<dl><dt>&lt;new&gt;</dt>
<dd>Adding/Creating a new object</dd>
<dt>&lt;active&gt;</dt>
<dd>Use the active object</dd>
<dt>&lt;input&gt;</dt>
<dd>Same as the input range in the same X-Function</dd>
<dt>&lt;same&gt;</dt>
<dd>Same as the previous variable in the X-Function</dd>
<dt>&lt;optional&gt;</dt>
<dd>Indicate the object is optional in input or output</dd>
<dt>&lt;none&gt;</dt>
<dd> No object will be created</dd></dl>
<h2><a name="ReportData_Output"></a><span class="mw-headline">ReportData Output</span></h2>
<p>Many X-Functions generate multiple output vectors in the form of a <b>ReportData</b> object.  Typically, a <span class="OIndex">ReportData</span> object is associated with a worksheet. Usually by default, it's the new sheet of same workbook as input data.
</p>
<h3><a name="Sending_ReportData_to_Worksheet"></a><span class="mw-headline">Sending ReportData to Worksheet</span></h3>
<p>If the output is set to a range, either the above special range, or regular worksheet or column range, or mix of both, the ReportData will output to a worksheet.
</p><p>The following script puts ReportData output to worksheets
E.g. 
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//To Sheet2 of Book2</span>
<span style="color: #008000;">//If the sheet doesn't exist, create it, </span>
<span style="color: #008000;">//If the sheet already exists, output from the 1st empty column</span>
fft1 rd<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>book2<span style="color: #000000;">&#93;</span>sheet3<span style="color: #000080;">!</span>; 
<span style="color: #008000;">// To new sheet of Book2 </span>
fft1 rd<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>book2<span style="color: #000000;">&#93;</span><span style="color: #000080;">&lt;</span>new<span style="color: #000080;">&gt;</span><span style="color: #000080;">!</span>;      
<span style="color: #008000;">// To column 4 of active sheet in active book</span>
fft1 rd<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span><span style="color: #000080;">&lt;</span>active<span style="color: #000080;">&gt;</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">&lt;</span>active<span style="color: #000080;">&gt;</span><span style="color: #000080;">!</span>Col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span>;  
<span style="color: #008000;">// To a new sheet in input data's workbook</span>
fft1 rd<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span><span style="color: #000080;">&lt;</span>input<span style="color: #000080;">&gt;</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">&lt;</span>new<span style="color: #000080;">&gt;</span><span style="color: #000080;">!</span>;</pre>
<p>Subsequent access to the data is more complicated, as you will need to write additional code to find these new columns.
</p>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/X-Function_Input_and_Output/Alert_icon.png?v=0" width="57"  border="0" /></td><td><p>Realize that output of the ReportData type will contain different amounts (columns) of data depending on the specific X-Function being used.  If you are sending the results to an existing sheet, be careful not to overwrite existing data with the ReportData columns that are generated.
</p>
	</td>
	</tr>
	</table>
<h3><a name="Sending_ReportData_to_Tree_Variable"></a><span class="mw-headline">Sending ReportData to Tree Variable</span></h3>
<p>Send ReportData to a <a href="../../LabTalk/LabTalk/Data_Types_and_Variables.html#Tree" title="LabTalk:Data Types and Variables">Tree variable</a> can avoid overhead of creating an worksheet to hold such output. 
</p><p>If the output is not one of the following range specification forms: <b>[Book]Sheet!</b>, <b>&lt;new&gt;</b>, or <b>&lt;active&gt;</b>, then it's automatically considered to be a LabTalk Tree name.
</p><p>E.g. the <b><a class="external text" href="../../XFunction/X-Function/Avecurves.html">avecurves</a></b> X-Function contains a ReportData output with two leaves: <b>aveX</b> and <b>aveY</b>. 
</p><p>The script below does average on data in worksheet and output ReportData to a tree variable. The tree variable contains two vector leaves. Assign these two leaves to dataset variables and then plot the dataset variables as line graph. No extra worksheet or columns are created for output the average result.
</p>
<pre class="lt" style="font-family:monospace;">col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>data<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">20</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">//fill col 1 with 1, 2, ... 20</span>
int nn <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>; 
loop<span style="color: #000000;">&#40;</span>i,<span style="color: #0000dd;">2</span>,nn<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#123;</span>wcol<span style="color: #000000;">&#40;</span>i<span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>normal<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">20</span><span style="color: #000000;">&#41;</span>;<span style="color: #000000;">&#125;</span>;  <span style="color: #008000;">//fill column 2 to 5 with normalized data</span>

<span style="color: #008000;">//do average curves of columns from 2 to 5. Put output to a Tree variable tr</span>
avecurves <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">:</span><span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>nn<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span> rd<span style="color: #000000;">:</span><span style="color: #000080;">=</span>tr; 
tr.<span style="color: #000080;">=</span>; <span style="color: #008000;">// to see the tree structure with contents, aveX and aveY are vectors</span>
<span style="color: #008000;">//assign tree leaves to a temporary dataset variables</span>
dataset avX <span style="color: #000080;">=</span> tr.<span style="color: #000080;">Result</span>.<span style="color: #000080;">aveX</span>;  
dataset avY <span style="color: #000080;">=</span> tr.<span style="color: #000080;">Result</span>.<span style="color: #000080;">aveY</span>;    

<span style="color: #008000;">// Plot col2 to 5 as scatter plot, using the default-X column in worksheet</span>
plotxy <span style="color: #000000;">&#40;</span>?,<span style="color: #0000dd;">2</span><span style="color: #000000;">:</span>nn<span style="color: #000000;">&#41;</span> p<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">201</span>;   

<span style="color: #008000;">//Add line plot with dataset variable avX as X and avY as Y to active graph</span>
plotxy <span style="color: #000000;">&#40;</span>avX, avY<span style="color: #000000;">&#41;</span> o<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>active<span style="color: #000080;">&gt;</span> p<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">200</span>;</pre>
<h2><a name="Assigning_Literal_Strings_to_X-function_Input"></a><span class="mw-headline">Assigning Literal Strings to X-function Input</span></h2>
<p><b>&lt;[&lt;</b> and <b>&gt;]&gt;</b> are introduced to assign labtalk literal string to input variables of x-function. It is useful if the input strings include string registers or special characters, such as <b>'</b>, <b>"</b> or <b>$</b> etc.
</p><p>The scripts below show the difference of using <b>&lt;[&lt;</b> and <b>&gt;]&gt;</b> or not in x-function variables
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000080;">%</span>A <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Mysplit&quot;</span>;
wsplit mode<span style="color: #000000;">:</span><span style="color: #000080;">=</span>ref ref<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>Book1<span style="color: #000000;">&#93;</span>Sheet1<span style="color: #000080;">!</span>A<span style="color: #ff00ff;">&quot;Fish&quot;</span> name<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;%A&quot;</span>;  <span style="color: #008000;">//Result sheet name is Mysplit</span>
wsplit mode<span style="color: #000000;">:</span><span style="color: #000080;">=</span>ref ref<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>Book1<span style="color: #000000;">&#93;</span>Sheet1<span style="color: #000080;">!</span>A<span style="color: #ff00ff;">&quot;Fish&quot;</span> name<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span><span style="color: #000000;">&#91;</span><span style="color: #000080;">&lt;</span><span style="color: #000080;">%</span>A<span style="color: #000080;">&gt;</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">&gt;</span>; <span style="color: #008000;">//Result sheet name is Fish </span>
<span style="color: #008000;">//the name is set as&#160;%A, which is a predefined variable as the name of reference column in XF</span></pre>
<p>The example below shows the usage of using <b>""</b> in x-function input
</p>
<pre class="lt" style="font-family:monospace;">patternT text<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span><span style="color: #000000;">&#91;</span><span style="color: #000080;">&lt;</span><span style="color: #ff00ff;">&quot;Sample A&quot;</span> <span style="color: #ff00ff;">&quot;Sample B&quot;</span> <span style="color: #ff00ff;">&quot;Sample C&quot;</span><span style="color: #000080;">&gt;</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">&gt;</span>;</pre>


