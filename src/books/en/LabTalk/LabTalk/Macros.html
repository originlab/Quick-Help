<h1 class="firstHeading">2.3.1.5 Macros</h1><p class='urlname' style='display: none'>Macros</p>
<h2><a name="Definition_of_the_Macros"></a><span class="mw-headline">Definition of the Macros</span></h2>
<p>The command syntax, 
</p>
<pre class="lt" style="font-family:monospace;">define macroName <span style="color: #000000;">&#123;</span>script<span style="color: #000000;">&#125;</span></pre>
<p>defines a macro called <i>macroName</i>, and associates it with the given <i>script</i>.  MacroName can then be used like a command, and invokes the given script.
</p><p>For example, the following script defines a macro that uses a loop to print a text string three times.  
</p>
<pre class="lt" style="font-family:monospace;">def hello 
<span style="color: #000000;">&#123;</span> 
      loop <span style="color: #000000;">&#40;</span>ii, <span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span> 
            <span style="color: #000000;">&#123;</span> type <span style="color: #ff00ff;">&quot;$(ii). Hello World&quot;</span>; <span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span>;</pre>
<p>Once the hello macro is defined, typing the word <i>hello</i> in the Script window results in the printout:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #0000dd;">1</span>. <span style="color: #000080;">Hello</span> World</pre>
<pre class="lt" style="font-family:monospace;"><span style="color: #0000dd;">2</span>. <span style="color: #000080;">Hello</span> World</pre>
<pre class="lt" style="font-family:monospace;"><span style="color: #0000dd;">3</span>. <span style="color: #000080;">Hello</span> World</pre>
<p>Once a macro is defined, you can also see the script associated with it by typing
</p>
<pre class="lt" style="font-family:monospace;">define macroName;</pre>
<h2><a name="Passing_Arguments_to_MacrosArgument.2C_MacroPass_Arguments_to_Macro"></a><span class="mw-headline">Passing Arguments to Macros<span class="OIndex" style="display:none">Argument, Macro</span><span class="OIndex" style="display:none">Pass Arguments to Macro</span></span></h2>
<p>Macros can take up to five arguments.  The&#160;%1-%5 syntax is used within the macro to access the value of each argument.  A macro can accept a number, string, variable, dataset, function, or script as an argument. Passing arguments to a macro is similar to <a href="../../LabTalk/Script/From_Files.html#Passing_Arguments_in_Scripts" title="Script:From Files">passing arguments to a script</a>.
</p><p>If arguments are passed to a macro, the macro can report the number of arguments using the <a href="#Macro_PropertyMacro_Property">macro.nArg</a> object property.
</p><p>For example, the following script defines a macro named <i>myDouble</i> that expects a single numeric argument.  The given argument is then multiplied by 2, and the result is printed.
</p>
<pre class="lt" style="font-family:monospace;">def myDouble <span style="color: #000000;">&#123;</span> type <span style="color: #ff00ff;">&quot;$(%1 * 2)&quot;</span>; <span style="color: #000000;">&#125;</span>;</pre>
<p>If you define this macro and then type the following in the Script window:
</p>
<pre class="lt" style="font-family:monospace;">myDouble <span style="color: #0000dd;">5</span></pre>
<p>Origin outputs the result to the Script Window:  
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #0000dd;">10</span></pre>
<p>You could modify this macro to take two arguments:
</p>
<pre class="lt" style="font-family:monospace;">def myDouble <span style="color: #000000;">&#123;</span> type <span style="color: #ff00ff;">&quot;$(%1 *&#160;%2)&quot;</span>; <span style="color: #000000;">&#125;</span>;</pre>
<p>Now, if you type the following in the Script window:
</p>
<pre class="lt" style="font-family:monospace;">myDouble <span style="color: #0000dd;">5</span> <span style="color: #0000dd;">4</span></pre>
<p>Origin outputs:  
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #0000dd;">20</span></pre>
<h2><a name="Macro_PropertyMacro_Property"></a><span class="mw-headline">Macro Property<span class="OIndex" style="display:none">Macro Property</span></span></h2>
<p>The macro object contains one property which stores the number of arguments passed to the macro.  
</p>
<table class="simple">
<tr>
<th> Property
</th>
<th> Access
</th>
<th> Description
</th></tr>
<tr>
<td> <b>Macro.nArg</b>
</td>
<td> Read only, numeric
</td>
<td> This property stores the number of arguments passed to the macro.
</td></tr></table>
<p>For example:
</p><p>The following script defines a macro called <i>TypeArgs</i>.  If three arguments are passed to the TypeArgs macro, the macro types the three arguments to the Script window. 
</p>
<pre class="lt" style="font-family:monospace;">Def TypeArgs 
<span style="color: #000000;">&#123;</span>
      if <span style="color: #000000;">&#40;</span>macro.<span style="color: #000080;">narg</span> <span style="color: #000080;">!</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>
      <span style="color: #000000;">&#123;</span>
            type <span style="color: #ff00ff;">&quot;Error! You must pass 3 arguments!&quot;</span>;
      <span style="color: #000000;">&#125;</span>
      else
      <span style="color: #000000;">&#123;</span>
            type <span style="color: #ff00ff;">&quot;The first argument passed was&#160;%1.&quot;</span>;
            type <span style="color: #ff00ff;">&quot;The second argument passed was&#160;%2.&quot;</span>;
            type <span style="color: #ff00ff;">&quot;The third argument passed was&#160;%3.&quot;</span>;
      <span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span>;</pre>
<p>If you define the <i>TypeArgs</i> macro as in the example, and then type the following in the Script window:  
</p>
<pre class="lt" style="font-family:monospace;">TypeArgs  One;</pre>
<p>Origin returns the following to the Script window:
</p>
<pre class="lt" style="font-family:monospace;">Error<span style="color: #000080;">!</span> You must pass <span style="color: #0000dd;">3</span> arguments<span style="color: #000080;">!</span></pre>
<p>If you define the <i>TypeArgs</i> macro as in the example, and then type the following in the Script window: 
</p>
<pre class="lt" style="font-family:monospace;">TypeArgs  One <span style="color: #000000;">&#40;</span>This is argument Two<span style="color: #000000;">&#41;</span> Three;</pre>
<p>Origin returns the following to the Script window:
</p>
<pre class="lt" style="font-family:monospace;">The first argument passed was One.
<span style="color: #000080;">The</span> second argument passed was This is argument Two.
<span style="color: #000080;">The</span> third argument passed was Three.</pre>






