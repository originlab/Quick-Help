<h1 class="firstHeading">3.7.5.101 Wks</h1><p class='urlname' style='display: none'>Wks-obj</p>
<p><br />
</p><p>The <i>WKS</i> object has properties and methods related to an Origin sheet (<b>Note:</b> A sheet can be either Worksheet or Matrixsheet). You can use <a href="../../LabTalk/LabTalk/Range_Notation.html" title="LabTalk:Range Notation">range notation</a> to define a <span class="OIndex">worksheet object</span>:
</p><p><b>range <i>wksObject</i> = [<i>winName</i>]<i>sheetName</i>!</b>
</p><p>If no range is specified, Origin will work on the active sheet. Once a worksheet (matrixsheet) object is defined, the object properties and methods can be accessed using the following syntax:
</p><p><b><i>wksObject</i>.<i>property</i><br /><i>wksObject</i>.<i>method</i>(<i>argument</i>)</b>
</p><p>For example:
</p>
<pre class="lt" style="font-family:monospace;">range rWa <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>Book2<span style="color: #000000;">&#93;</span>Sheet2<span style="color: #000080;">!</span>;     <span style="color: #008000;">// Define a worksheet object range</span>
rWa.<span style="color: #000080;">colSel</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;                <span style="color: #008000;">// Select the second column of that sheet</span>
rWa.<span style="color: #000080;">vGrids</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;                 <span style="color: #008000;">// Turn off vertical grid lines</span>
range rWb <span style="color: #000080;">=</span> <span style="color: #000080;">!</span>;                  <span style="color: #008000;">// Use the active worksheet as a range</span>
page.<span style="color: #000080;">xlcolname</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;            <span style="color: #008000;">// Turn off Spreadsheet Cell Notation firstly</span>
rWb.<span style="color: #000080;">AddCol</span><span style="color: #000000;">&#40;</span>NewColumn<span style="color: #000000;">&#41;</span>;          <span style="color: #008000;">// Add a new column</span>
NumColumns <span style="color: #000080;">=</span> rWb.<span style="color: #000080;">ncols</span>;         <span style="color: #008000;">// Find out how many columns</span></pre>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Wks_(object)/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>For the <a class="external text" href="../../UserGuide/UserGuide/Column_Short_Name_Restriction.html">Spreadsheet Cell Notation</a> in the workbook, please see <a class="external text" href="../../QuickHelp/QuickHelp/Turn_off_spreadsheet_cell_notation.html"><b>FAQ-849</b></a> for more information.
</p></td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Wks_(object)/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>Please see the <a class="external text" href="../../XFunction/X-Function/Wproperties.html"><b>wproperties</b></a> X-Function for Read/Write access to additional Worksheet properties. What's more, there are some X-Function can do the same things as <b>wks</b> object. For more information, please refer to <a href="../../LabTalk/Script/LabTalk-Supported_X-Functions.html#Worksheet" title="Script:LabTalk-Supported X-Functions">worksheet manipulation X-Functions</a>.
</p></td></tr></table>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#PropertiesWorksheet_Property"><span class="tocnumber">1</span> <span class="toctext">Properties<span class="OIndex" style="display:none">Worksheet Property</span></span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Methods"><span class="tocnumber">2</span> <span class="toctext">Methods</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Examples"><span class="tocnumber">3</span> <span class="toctext">Examples</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Work_with_Worksheet_Columns_and_Rows"><span class="tocnumber">3.1</span> <span class="toctext">Work with Worksheet Columns and Rows</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Display_Worksheet_Column_Labels"><span class="tocnumber">3.2</span> <span class="toctext">Display Worksheet Column Labels</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Get_the_unhidden_value_from_the_column_in_worksheet"><span class="tocnumber">3.3</span> <span class="toctext">Get the unhidden value from the column in worksheet</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-7"><a href="#See_Also"><span class="tocnumber">4</span> <span class="toctext">See Also</span></a></li>
</ul>
</div>

<h2><a name="PropertiesWorksheet_Property"></a><span class="mw-headline">Properties<span class="OIndex" style="display:none">Worksheet Property</span></span></h2>
<p>When operating on the active worksheet or matrixsheet, you can use <font color="navy"><i>wks</i>.<i>property</i></font> to access sheet properties; otherwise, range notation should be used.
</p>
<table class="simple">
<tr>
<th width="100">Property
</th>
<th width="70">Access
</th>
<th width="550">Description
</th></tr>
<tr>
<td> wks.AutoAddRows
</td>
<td> Read/write<br />integer
</td>
<td> Auto add rows when sheet is resized.
<p><i>Example</i>:
</p>
<pre class="lt" style="font-family:monospace;">range aa<span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>book1<span style="color: #000000;">&#93;</span>sheet2<span style="color: #000080;">!</span>;
<span style="color: #008000;">// Disable auto add rows to maintain fixed </span>
<span style="color: #008000;">// number of rows and columns</span>
aa.<span style="color: #000080;">AutoAddRows</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>; 
<span style="color: #008000;">// Setup the wks with 3x2</span>
aa.<span style="color: #000080;">nCols</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;aa.<span style="color: #000080;">nRows</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;</pre>
</td></tr>
<tr>
<td> wks.band
<p align="right"><font color="red">(2023)</font></p>
</td>
<td> Read/Write<br />integer
</td>
<td> Turn on/off banded rows: 0 = turn off banded rows; 1= turn on banded rows.
<p>Refer to <a href="../../LabTalk/LabTalk/System_Variable_List.html#U.2CV.2CW" title="LabTalk:System Variable List">system variable @WBC</a> to change the banded color, and <a href="../../LabTalk/LabTalk/System_Variable_List.html#U.2CV.2CW" title="LabTalk:System Variable List">@WBE</a> to switch the fill-color rows between odd and even.
</p>
</td></tr>
<tr>
<td> wks.c1, c2, r1, r2
</td>
<td> Read only<br />integer
</td>
<td> Selection range. First and last columns and rows.
</td></tr>
<tr>
<td> wks.catI
</td>
<td> Read/write<br />
</td>
<td> Toggle display of <a class="external text" href="../../QuickHelp/QuickHelp/How_to_show_category_indices.html">category indices or categories</a>: 0 = display categories, 1 = display indices.
</td></tr>
<tr>
<td> wks.cName<i>n</i>$
</td>
<td> Read only<br />string
</td>
<td> The <i>n</i>th worksheet column short name. See <code>wks.cnamemode</code> to operate on specific column types. (See also: <a class="external text" href="../../LabTalk/Category/Wks.Col_(object).html">Wks.Col (Object)</a>)
</td></tr>
<tr>
<td> wks.cNameMode
</td>
<td> Read/write<br />integer
</td>
<td> Its value determines the columns that <code>wks.cnamen$</code> operates on. Set <code>wks.cnamemode</code> to the following values: 0 = all columns, 1 = numeric columns, 2 = text columns, 4 = text and numeric (mixed) columns, and 64 = columns in the selection range. Set <code>wks.cnamemode = 128</code> to return the full dataset name to <code>wks.cnamen$</code>.
</td></tr>
<tr>
<td> wks.col
</td>
<td> Read/write<br />integer
</td>
<td> Active column (worksheet) or active object (matrix). See also: The <a href="../../LabTalk/Category/Wks.Col_(object).html" title="Category:Wks.Col (object)">Wks.Col (Object)</a> properties.
</td></tr>
<tr>
<td> wks.colWidth
</td>
<td> Read/write<br />integer
</td>
<td>
<p>Column width of the active worksheet. 
</p><p>Also see the <a class="external text" href="../../XFunction/X-Function/Wcolwidth.html"><b>wcolwidth</b></a> X-Function or <a class="external text" href="../../LabTalk/Category/Wks.Col_(object).html#Properties_and_Methods.7B.7B.23Index:.7CColumn_Method.7D.7D">wks.col.width</a> both of which can be used to set the width of individual columns.
</p>
</td></tr>
<tr>
<td> wks.DB
<p align="right"><font color="red">(2023b)</font></p>
</td>
<td> Read/write<br />integer
</td>
<td> Database import. See also: The <a href="../../LabTalk/LabTalk/Wks.DB_(object).html" title="LabTalk:Wks.DB (object)">Wks.DB object</a> properties.
</td></tr>
<tr>
<td> wks.DC
<p align="right"><font color="red">(2019b SR0)</font></p>
</td>
<td> Read/write<br />integer
</td>
<td> Data Connector. See also: The <a href="../../LabTalk/Category/Wks.DC_(object).html" title="Category:Wks.DC (object)">Wks.DC object</a> properties.
</td></tr>
<tr>
<td> wks.epd
</td>
<td> Read/write<br />
</td>
<td> specify if exclude current worksheet when do plotting with Layer Contents and Plot Setup etc graphing related dialogs. 1= tag this sheet as Exclude from plotting dialog; 0 = relief the exclude tag.
<p>You use the <a href="../../LabTalk/LabTalk/System_Variable_List.html#T" title="LabTalk:System Variable List">system variable @TCE</a> to indicate the tagged(excluded) sheet name with desired color, such as @TCE=Color(255, 60, 60);.
</p>
</td></tr>
<tr>
<td> wks.export
</td>
<td> Read/write<br />
</td>
<td> Worksheet export settings; enter <b>wks.export.=</b> for sub-methods.
</td></tr>
<tr>
<td> wks.font
</td>
<td> Read/write<br />integer
</td>
<td> Font (by index) of the Standard name style in the sheet. You can use the <a href="../../LabTalk/LabTalk/Font_(function).html" title="LabTalk:Font (function)">font(name)</a> function to get a font's index, like <code>wks.font = font(Courier New);</code>
</td></tr>
<tr>
<td> wks.frozen$
</td>
<td> Read/write<br />string
</td>
<td>Set or read the range of frozen cols and/or rows or unfreeze cols/rows:
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// The following is equivalent to the user selecting cell D4 and clicking the Freeze Panes Mini Toolbar button.</span>
wks.<span style="color: #000080;">frozen</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;C 3&quot;</span>; <span style="color: #008000;">// freeze cols A to C, rows 1 to 3</span>
wks.<span style="color: #000080;">frozen</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;&quot;</span>; <span style="color: #008000;">// unfreeze cols A to C, rows 1 to 3</span></pre>
</td></tr>
<tr>
<td> wks.fSize
</td>
<td> Read/write<br />float
</td>
<td> Font size of the Standard name style in the sheet, like <code> wks.fsize = 12;</code>
</td></tr>
<tr>
<td> wks.hasDC
<p align="right"><font color="red">(2019b SR0)</font></p>
</td>
<td> Read only<br />bool
</td>
<td> Return whether the workbook/worksheet has a Data Connector:
<p>0 = workbook doesn't have Data Connector, <br />
1 = worksheet is used by a Data Connector as the output (destination sheet), <br />
2 = worksheet is not used by any Data Connector as the output. Iin this case, the worksheet may contain a Data Connector but doesn't build a valid connection. To check if the worksheet is used by a Data Connector as output or not, use "wks.DC.Valid".
</p>
</td></tr>
<tr>
<td> wks.hGrids<br />wks.vGrids
</td>
<td> Read/write<br />integer
</td>
<td> Display horizontal and vertical grid: 1 = enable, 0 = disable.<b>&#8224;</b>
</td></tr>
<tr>
<td> wks.hiddenRows
<p align="right"><font color="red">(2019 SR0)</font></p>
</td>
<td> Read Only<br />integer
</td>
<td> Return the number of hidden rows in the worksheet. wks.hiddenRows == wks.maxRows - wks.visibleRows.
</td></tr>
<tr>
<td> wks.hierarchical
</td>
<td> Read Only<br />integer
</td>
<td> Read whether the worksheet is hierarchical (i.e. contains collapsible nodes and tables such as an analysis report sheet does) or not: 1=hierarchical, 0=flat sheet.
</td></tr>
<tr>
<td> wks.gap
<p align="right"><font color="red">(2021b)</font></p>
</td>
<td> Read/write<br />integer
</td>
<td> Gap between the window title bar and the top of the sheet. Use this area to do such things as place text objects or custom buttons that run script. Gap is measured in units of text point size (e.g. entering "20" creates a gap that will accommodate 20 point text).
</td></tr>
<tr>
<td> wks.ignorehidden
</td>
<td> Read/write<br />
</td>
<td> Treatment of hidden rows in plotting and analysis operations:
<p>0 = Include data in hidden rows on plotting and analysis.<br />
1 = (default) Ignore hidden rows on plotting and analysis.
</p>
</td></tr>
<tr>
<td> wks.image
</td>
<td> Read/write<br />
</td>
<td> Matrix view settings, 0 = Data Mode and 1 = Image Mode.
</td></tr>
<tr>
<td> wks.import
</td>
<td> Read/write<br />
</td>
<td> Worksheet import settings; enter <b>wks.import.=</b> for sub-methods.
</td></tr>
<tr>
<td> wks.index
</td>
<td> Read/write<br />integer
</td>
<td> Worksheet index in workbook, i.e. 1,2,3, etc.
<p>Use this property to reorder worksheets. For example:
</p>
<pre class="lt" style="font-family:monospace;">newbook sheet<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span>; <span style="color: #008000;">// Create a 4 sheets workbook;</span>
wks.<span style="color: #000080;">index</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>; <span style="color: #008000;">// Move &quot;Sheet1&quot; to the 3nd worksheet;</span></pre>
<p><b>Note:</b> This property is <i>Read Only</i> before <font color="red">8.5.0 SR1</font>. 
</p>
</td></tr>
<tr>
<td> wks.isc
</td>
<td> Read/write<br />
</td>
<td> Sheet-level control of column width on import for both Import Wizard and Data Connectors:
<p>0 = Do not adjust column width on import.<br />
1 = (default) Follow the value of system variable <a href="../../LabTalk/LabTalk/System_Variable_List.html#H.2CI.2CJ.2CK" title="LabTalk:System Variable List"><b>@ISC</b></a>.
</p>
</td></tr>
<tr>
<td> wks.joinMode
</td>
<td> Read/write<br />integer
</td>
<td> Set/get the worksheet join mode. Values may be the following:
<p>0 = enumerate when column names match. Append when matching rows are not found.
</p><p>1 = drop when column names match. Append when matching rows are not found.
</p><p>2 = enumerate when column names match. Drop when matching rows are not found.<br />
3 = drop when column names match. Drop when matching rows are not found.<br />
See the <code>wks.join()</code> method. 
</p>
</td></tr>
<tr>
<td> wks.khra
<p align="right"><font color="red">(2018 SR0)</font></p>
</td>
<td> Read/write<br />bool
</td>
<td> When the X column of a column/bar graph contains text, this text is used to label major ticks, ordered by row index. Prior to Origin 2018, when applying a worksheet data filter, plots registered the vacant ticks and labels of filtered data, though the data points were not plotted. This was changed in Origin 2018 so that ticks associated with filtered data no longer display. This only applies to X columns that contain text and are NOT <a class="external text" href="../../UserGuide/UserGuide/Displaying_Supporting_Data_in_Worksheet_Header_Rows.html#Categories">Set as Categorical</a>. 0 (default) = hide filtered data labels, 1 = restore old behavior and show data labels even though data are filtered.
</td></tr>
<tr>
<td> wks.loadedgrid
</td>
<td> Read/write<br />integer
</td>
<td> 0 if grid not loaded; 1 if grid loaded.
</td></tr>
<tr>
<td> wks.lock
<p align="right"><font color="red">(2023)</font></p>
</td>
<td>Read/Write<br />integer
</td>
<td> Protect/Lock worksheet: 1 = True, 0 = False.
<p>Set exception for protected worksheet by system variable <a href="../../LabTalk/LabTalk/System_Variable_List.html#U.2CV.2CW" title="LabTalk:System Variable List">@WPO</a>.
</p>
</td></tr>
<tr>
<td> wks.longname$
</td>
<td> Read/write<br />string
</td>
<td> Long name of worksheet. Beginning with Origin 2020b, "Long Name" = "Label".
</td></tr>
<tr>
<td> wks.maxRows
</td>
<td> Read only<br />integer
</td>
<td> Scan all columns and find the largest row index that has value. You can setup a worksheet with <code>wks.nRows</code>, but before filling it with values, <code>wks.maxRows</code> will still be zero. To reduce the size of a worksheet, use wks.nRows, as this property is only to get the longest column row size.
</td></tr>
<tr>
<td> wks.multiX
</td>
<td> Read only<br />integer
</td>
<td> Multiple X columns: 1 = Yes, 0 = No.
</td></tr>
<tr>
<td> wks.name$
</td>
<td> Read/write<br />string
</td>
<td> Worksheet name.
</td></tr>
<tr>
<td> wks.nancolor
</td>
<td> Read/write<br />integer
</td>
<td> Matrix image view missing value color.
</td></tr>
<tr>
<td> wks.nMats
</td>
<td> Read/write<br />integer
</td>
<td> Number of matrix objects in a matrixsheet.
</td></tr>
<tr>
<td> wks.nCols
</td>
<td> Read/write<br />integer
</td>
<td> Number of columns in the worksheet. Before Origin 8, this property was Read-Only
</td></tr>
<tr>
<td> wks.nRows
</td>
<td> Read/write<br />integer
</td>
<td> Number of rows in the worksheet. Before Origin 8, this property was Read-Only. See also: <code>wks.maxRows</code>.
</td></tr>
<tr>
<td> wks.rhw
</td>
<td> Read/write<br />integer
</td>
<td> Row heading width in units of 1/10 of cell height.
<p><i>Example</i>:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Set to about 5 char height</span>
range aa<span style="color: #000080;">=</span><span style="color: #0000dd;">2</span><span style="color: #000080;">!</span>; <span style="color: #008000;">// 2nd sheet of active book</span>
aa.<span style="color: #000080;">rhw</span><span style="color: #000080;">=</span><span style="color: #0000dd;">50</span>;</pre>
</td></tr>
<tr>
<td> wks.sel
</td>
<td> Read only<br />integer
</td>
<td> Selection flags. The hex return number indicates what is selected in the worksheet. Values may be the following, or a combination of these bits: 0 = none, 1 = editing cell, 2 = column, 4 = row, 8 = range, and 16 = 1 column.
</td></tr>
<tr>
<td> wks.upc
</td>
<td> Read only<br />integer
</td>
<td> Count of User Parameters
</td></tr>
<tr>
<td> wks.useFont
</td>
<td> Read/write<br />integer
</td>
<td> Font usage: 1 = use selected font, 0 = use system font.
</td></tr>
<tr>
<td> wks.userParam<i>n</i>
</td>
<td> Read/write<br />integer
</td>
<td> Show/hide specified User Parameter. For example:
<pre class="lt" style="font-family:monospace;">wks.<span style="color: #000080;">UserParam1</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>; <span style="color: #008000;">// Show the first user parameter</span></pre>
</td></tr>
<tr>
<td> wks.userParam<i>n</i>$
</td>
<td> Read/write<br />string
</td>
<td> Access the User Parameter's name. For example:
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Set parameter name as &quot;Site Index&quot;</span>
wks.<span style="color: #000080;">UserParam1</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Site Index&quot;</span>;</pre>
</td></tr>
<tr>
<td> wks.View
<p align="right"><font color="red">(2020b)</font></p>
</td>
<td> Read/write<br />integer
</td>
<td> Turn worksheet <a class="external text" href="../../UserGuide/UserGuide/Column_List_View.html">Column List View</a> on or off: 0 = standard view, 1 = Column List View.
</td></tr>
<tr>
<td> wks.VisibleCols
</td>
<td> Read only<br />integer
</td>
<td> Number of visible columns (not include the hidden columns) in the worksheet.
</td></tr>
<tr>
<td> wks.VisibleRows
</td>
<td> Read only<br />integer
</td>
<td> Number of visible rows (not include the hidden rows) in the worksheet.
</td></tr>
<tr>
<td> wks.x(y).comments$
</td>
<td> Read/write<br />string
</td>
<td> The Comments for X/Y coordinates of the matrix.
</td></tr>
<tr>
<td> wks.x(y).longname$
</td>
<td> Read/write<br />string
</td>
<td> The Long Name for X/Y coordinates of the matrix.
</td></tr>
<tr>
<td> wks.x(y).units$
</td>
<td> Read/write<br />string
</td>
<td> The Units for X/Y coordinates of the matrix.
</td></tr></table>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Wks_(object)/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p><b>&#8224;</b>wks.merge() is for label only , and there is no LabTalk property or command for merging selected worksheet cells but you can accomplish this by capturing the menu id of the <b>Merge cells</b> toolbar button and using it with the <a href="../../LabTalk/LabTalk/Menu_(command).html#-e.3B_Execute_the_menu_command_with_the_specified_ID" title="LabTalk:Menu (command)"><b>menu -e</b></a> command.
</p></td></tr></table>
<h2><a name="Methods"></a><span class="mw-headline">Methods</span></h2>
<p><span class="OIndex" style="display:none">Worksheet Method</span>
</p>
<table class="simple">
<tr>
<th width="350">Method
</th>
<th width="540">Description
</th></tr>
<tr>
<td> wks.AddButton(<i>objname</i>, <i>label</i>)
</td>
<td> Add a button to the gap on the top of the worksheet
</td></tr>
<tr>
<td> wks.addCol(<i>name</i>)
</td>
<td> Add a single named column to the end of the worksheet. If <i>name</i> is not specified, a generic name is chosen.
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Wks_(object)/Alert_icon.png?v=0" width="57"  border="0" /></td><td><p>If you have specified the column name, you might need to turn off the <a class="external text" href="../../UserGuide/UserGuide/Column_Short_Name_Restriction.html">Spreadsheet Cell Notation</a> in the workbook, you can see <a class="external text" href="../../QuickHelp/QuickHelp/Turn_off_spreadsheet_cell_notation.html"><b>FAQ-849</b></a> for more information.
</p>
	</td>
	</tr>
	</table>
</td></tr>
<tr>
<td> wks.colSel(<i>colNum</i>, <i>n</i>)
</td>
<td> Column selection. If <i>n</i> = 1, select the <i>colNum</i> column. If <i>n</i> = 0, deselect the <i>colNum</i> column.
</td></tr>
<tr>
<td> wks.copy(<i>strRegister</i>, <i>Col</i>, <i>Row</i>)
</td>
<td> Copy(<i>Z</i>): Copy entire wks into <a href="../../LabTalk/LabTalk/String_registers.html" title="LabTalk:String registers">string register</a>&#160;%Z. (It is recommended that you use&#160;%Z which can hold up to 6,290 characters. If the text is too large, it is not copied and no error occurs.) See also: <code>wks.paste()</code>.<br />Copy(<i>Z</i>, <i>n</i>): copy all rows of column <i>n</i>.<br />Copy(<i>Z</i>, 0, <i>n</i>):  copy all columns of row <i>n</i>.<br />See the <a class="external text" href="../../XFunction/X-Function/Colcopy.html">colcopy</a>, <a class="external text" href="../../XFunction/X-Function/Colcopy.html">colcopy</a>, <a class="external text" href="../../XFunction/X-Function/Wcopy.html">wcopy</a> and <a class="external text" href="../../XFunction/X-Function/Wrcopy.html">wrcopy</a> X-Functions for more options.
</td></tr>
<tr>
<td> wks.deleteRows(<i>rowBegin</i>[,<i>numRows</i>, <i>colBegin</i>, <i>colEnd</i>])<br />wks.deleteRows([<i>rowBegin</i>,<i>Undo</i>])
</td>
<td>
<p>Delete a range of rows. Specifying only <i>rowBegin</i> deletes <i>rowBegin</i> in all columns in the worksheet. <br />Adding option <i>numRows</i> deletes <i>numRows</i> from <i>rowBegin</i>, in all columns. <br />Use <i>colBegin</i> and <i>colEnd</i> to limit deletion of rows to specified columns, from (a) <i>colBegin</i> to the last column in the sheet (<i>colEnd</i> not specified), or (b) from <i>colBegin</i> to <i>colEnd</i>. 
</p><p>If <i>rowBegin</i> is not specified or set to 0, selected range will be deleted. In this case, <i>Undo</i> will determine whether to support undo: 0 = do not support undo (default), 1 = support undo. For example, 
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// delete seleted rows without undo</span>
wks.<span style="color: #000080;">DeleteRows</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; 

<span style="color: #008000;">// select rows where column B &lt; 5000 or contains missing, and then delete them</span>
wxt test<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;col(B)&lt;5000 or IsNA(col(B))&quot;</span> sel<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
wks.<span style="color: #000080;">DeleteRows</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span>,<span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;</pre> 
<p>See more examples <a href="../../LabTalk/Script/Basic_Worksheet_Column_Operation.html#Insert_or_Delete_Rows_in_Columns" title="Script:Basic Worksheet Column Operation">here</a>. <br />Also, see <b>wks.insertRows</b>, below.
</p>
</td></tr>
<tr>
<td> wks.delHidden([<i>RowCol</i>, <i>Undo</i>])
<p align="right"><font color="red">(2023b)</font></p>
</td>
<td> Delete hidden row(s) or column(s) in current worksheet.  <i>RowCol</i> determines whether to delete hidden rows or columns: 0 = row (default), 1 = column; while <i>Undo</i> determines whether to support undo: 0 = do not support undo (default), 1 = support undo. For example, following codes delete rows where col(B)&lt;5000 in the current worksheet:
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// add a filter to hide all rows where col(B) &lt; 5000</span>
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">filter</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">filter</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;x&gt;5000&quot;</span>;
wks.<span style="color: #000080;">runfilter</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// delete hidden rows</span>
wks.<span style="color: #000080;">DelHidden</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span>,<span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">filter</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;
wks.<span style="color: #000080;">nrows</span><span style="color: #000080;">=</span>wks.<span style="color: #000080;">maxrows</span>;</pre> 
<p><b>Note</b>: <code>wks.DelHidden()</code> is disabled in <a class="external text" href="../../UserGuide/UserGuide/Column_List_View.html">column list view</a>.
</p>
</td></tr>
<tr>
<td> wks.findLabels(<i>ind</i>, <i>K</i>[,<i>n</i>])
</td>
<td> Finds an apparent label in a column of data (Origin worksheet or Excel workbook. If an Excel worksheet is active, make sure that the internal data has been updated (as with layer -s) before use). <br /><i>ind</i> = (required) index of the column in which to find label; <br /><i>K</i> = (required) global string variable letter to store the found label string; <br /><i>n</i> = (optional) 0 to disregard selection, 1 to consider selection inside the column if only a range of rows inside the column is selected (if nothing in the column is selected or if the whole column is selected, treat as 0) By default (i.e. if n is omitted), it is considered to be 0.
</td></tr>
<tr>
<td> wks.findX(<i>col</i>)<br />wks.findX(<i>colIndex</i>,0)
</td>
<td> Finds the corresponding X column of specified Y column <i>col'</i>, and returns X column index. If <i>col</i> is X column, it will returns value &lt;=0. For example,
<pre class="lt" style="font-family:monospace;">i<span style="color: #000080;">=</span>wks.<span style="color: #000080;">findX</span><span style="color: #000000;">&#40;</span>B<span style="color: #000000;">&#41;</span>;
i<span style="color: #000080;">=</span>;<span style="color: #008000;">//return 1</span>
i<span style="color: #000080;">=</span>wks.<span style="color: #000080;">findX</span><span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span>;
i<span style="color: #000080;">=</span>;<span style="color: #008000;">//return -3 since Col(A) is X column</span></pre>
<p>For any column (no matter Y column or not), use <b>wks.findX(<i>colInex</i>,0)</b> to ignore column designation and reture corresponding X column index.
</p>
</td></tr>
<tr>
<td> wks.hasfilter()
</td>
<td> Test whether there are filters applied in the worksheet. If yes, return 1, else return 0. For more details about filter property scripts, please see <a href="../../LabTalk/LabTalk/Wks.Col_(object)&amp;action=edit&amp;redlink=1.html" class="new" title="LabTalk:Wks.Col (object) (page does not exist)">wks.col.filter</a>.
</td></tr>
<tr>
<td> wks.insert(<i>name list</i>)
</td>
<td> Insert the list of columns at the current location. The current column position is specified by <code>wks.col</code>. The list consists of one or more desired column names separated by spaces. If a column name is already used, it is automatically enumerated.
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Wks_(object)/Alert_icon.png?v=0" width="57"  border="0" /></td><td><p>The specified column names might not able to be applied to the newly-added columns if <a class="external text" href="../../UserGuide/UserGuide/Column_Short_Name_Restriction.html">Spreadsheet Cell Notation</a> is enabled in the workbook. So if you want to apply the specified column names to columns' short name, you need turn off the <b>Spreadsheet Cell Notation</b> before running the <b>wks.insert</b> command. See <a class="external text" href="../../QuickHelp/QuickHelp/Turn_off_spreadsheet_cell_notation.html"><b>FAQ-849</b></a> for more information.
</p>
	</td>
	</tr>
	</table>
</td></tr>
<tr>
<td> wks.insertRows(<i>rowBegin</i>[,<i>numRows</i>, <i>colBegin</i>, <i>colEnd</i>])
</td>
<td> Insert a range of rows. Specifying only <i>rowBegin</i> inserts one row before <i>rowBegin</i> in all columns in the worksheet. <br />Adding option <i>numRows</i> inserts <i>numRows</i> from <i>rowBegin</i>, in all columns. <br />Use <i>colBegin</i> and <i>colEnd</i> to limit insertion of rows to specified columns, from (a) <i>colBegin</i> to the last column in the sheet (<i>colEnd</i> not specified), or (b) from <i>colBegin</i> to <i>colEnd</i>. <br />See <a href="../../LabTalk/Script/Basic_Worksheet_Column_Operation.html#Insert_or_Delete_Rows_in_Columns" title="Script:Basic Worksheet Column Operation">examples</a>. <br />Also, see <b>wks.deleteRows</b>, above.
</td></tr>
<tr>
<td> wks.isColHidden(<i>colNum</i>)
</td>
<td> Test whether the column (specified by column number, <i>colNum</i>), is hidden. If hidden, return 1, and 0 for else.
</td></tr>
<tr>
<td> wks.isColSel([<i>colNum</i>])
</td>
<td> If <i>colNum</i> is included as an argument, the method returns the selection state of <i>colNum</i>. 0 = the column isn't selected. 1 = entire column is selected. 2 = a range of the column is selected. <br />If <i>colNum</i> is not included as an argument, this method returns the number of columns selected (partial and entire selections).
</td></tr>
<tr>
<td> wks.isRowHidden(<i>rowNum</i>)
</td>
<td> Test whether the row (specified by row number, <i>rowNum</i>), is hidden. If hidden, return 1, and 0 for else.
</td></tr>
<tr>
<td> [ToWks!]wks.join(FromWks)
</td>
<td> Join the worksheet specified by <i>FromWks</i> to the worksheet specified by <i>ToWks</i>. This method adds the columns of <i>FromWks</i> to <i>ToWks</i> according to the method specified by <i>wks.joinmode</i>.
<p>If <i>ToWks</i> is not specified, then the currently active worksheet is used.
</p>
</td></tr>
<tr>
<td> wks.labels(str)
</td>
<td> Control the display of worksheet column labels. No argument = do not show any labels, otherwise a string containing <a href="../../LabTalk/LabTalk/Column_Label_Row_Characters.html" title="LabTalk:Column Label Row Characters">column label row characters</a>, for example:
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Show Long Name and Comments, if they are not empty</span>
wks.<span style="color: #000080;">labels</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// Do not show any label rows</span>
wks.<span style="color: #000080;">labels</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// When import adds Units, move Units between Long Name and Comments, F(x)= to bottom</span>
wks.<span style="color: #000080;">labels</span><span style="color: #000000;">&#40;</span>@<span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// Set to show long name, units and comments</span>
wks.<span style="color: #000080;">labels</span><span style="color: #000000;">&#40;</span>LUC<span style="color: #000000;">&#41;</span>
<span style="color: #008000;">// Show Comments, User Parameter 1, and Long Name</span>
wks.<span style="color: #000080;">labels</span><span style="color: #000000;">&#40;</span>CD1L<span style="color: #000000;">&#41;</span></pre>
<p>The prefixes <b>+</b>, <b>-</b> and <b>*</b> were added in <font color="red">Origin 8 SR2</font>.<br />
The prefixes <b>&lt;</b> and <b>&gt;</b> were added in <font color="red">Origin 2017</font>.<br />
<code>wks.labels(@)</code> added in <font color="red">Origin 2020b</font>.<br />
The prefixes <b>#</b> was added in <font color="red">Origin 2024b</font>.<br />
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// To remove Units</span>
wks.<span style="color: #000080;">labels</span><span style="color: #000000;">&#40;</span><span style="color: #000080;">-</span>U<span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// To insert Sample Rate and Sparklines at the top</span>
wks.<span style="color: #000080;">labels</span><span style="color: #000000;">&#40;</span><span style="color: #000080;">+</span>ES<span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// To append Units to the bottom</span>
wks.<span style="color: #000080;">labels</span><span style="color: #000000;">&#40;</span><span style="color: #000080;">*</span>U<span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// To move F(x)= to the bottom</span>
wks.<span style="color: #000080;">labels</span><span style="color: #000000;">&#40;</span><span style="color: #000080;">&gt;</span>O<span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">//To move Comments to the top</span>
wks.<span style="color: #000080;">labels</span><span style="color: #000000;">&#40;</span><span style="color: #000080;">&lt;</span>C<span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">//To clear the content and hide the User Parameter 1 label row</span>
wks.<span style="color: #000080;">labels</span><span style="color: #000000;">&#40;</span>#D1<span style="color: #000000;">&#41;</span>;</pre>
<p>Note that you can also use <b>+</b> and <b>*</b> to "move" (add) a label row to top or bottom. The characters <b>&lt;</b> and <b>&gt;</b> will do nothing if the label row is not already shown.
</p>
</td></tr>
<tr>
<td> wks.merge(<i>Label</i>, <i>option</i>)
</td>
<td> Merge adjacent label cells containing the same text.
<pre class="lt" style="font-family:monospace;">wks.<span style="color: #000080;">merge</span><span style="color: #000000;">&#40;</span>L,<span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;<span style="color: #008000;">//merge LN</span>
wks.<span style="color: #000080;">merge</span><span style="color: #000000;">&#40;</span>L,<span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;<span style="color: #008000;">//unmerge LN</span>
wks.<span style="color: #000080;">merge</span><span style="color: #000000;">&#40;</span>L,<span style="color: #000080;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>;<span style="color: #008000;">//return 1 if LN merged, 0 if not.</span></pre>
</td></tr>
<tr>
<td> wks.paste(<i>strRegister</i>, <i>Col</i>, <i>Row</i>)
</td>
<td> Paste the contents of a <a href="../../LabTalk/LabTalk/String_registers.html" title="LabTalk:String registers">string register</a> (specified without the&#160;%) into the cell beginning at (<i>Col</i>, <i>Row</i>).
</td></tr>
<tr>
<td> wks.runfilter()
</td>
<td> Run or re-apply filter. runfilter(2) to force run even there is no filter. For more details on filter property scripts, please see <a href="../../LabTalk/LabTalk/Wks.Col_(object)&amp;action=edit&amp;redlink=1.html" class="new" title="LabTalk:Wks.Col (object) (page does not exist)">wks.col.filter</a>.
</td></tr>
<tr>
<td> wks.reorder(<i>arg1</i>, [<i>arg2</i>])
</td>
<td> Reorder columns.
<p>arg1 = -1: reverse current order
</p>
<pre class="lt" style="font-family:monospace;">wks.<span style="color: #000080;">reorder</span><span style="color: #000000;">&#40;</span><span style="color: #000080;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//reverse order</span></pre>
<p>arg1 = column index, arg2 is its new index
</p>
<pre class="lt" style="font-family:monospace;">wks.<span style="color: #000080;">reorder</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">5</span><span style="color: #000000;">&#41;</span> <span style="color: #008000;">//moves 2nd column to be the 5th column</span>
wks.<span style="color: #000080;">reorder</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span>, <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span> <span style="color: #008000;">//moves 2nd column to be the last column</span>
wks.<span style="color: #000080;">reorder</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span>,<span style="color: #000080;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span> <span style="color: #008000;">//moves 2nd column to be next-to-last column</span>
wks.<span style="color: #000080;">reorder</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span>, <span style="color: #000080;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span> <span style="color: #008000;">//moves the last column to be next-to-last column</span>
wks.<span style="color: #000080;">reorder</span><span style="color: #000000;">&#40;</span><span style="color: #000080;">-</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span> <span style="color: #008000;">//moves next-to-last column to be the first column</span></pre>
<p>arg1 = dataset: specify orders
</p>
<pre class="lt" style="font-family:monospace;">dataset vv <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">4</span>,<span style="color: #0000dd;">3</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">&#125;</span>;
wks.<span style="color: #000080;">reorder</span><span style="color: #000000;">&#40;</span>vv<span style="color: #000000;">&#41;</span>;</pre>
</td></tr>
<tr>
<td>wks.setaslabel(<i>type</i>, <i>rowNum</i>, <i>label</i>, <i>append</i>)
</td>
<td>Set or append one row as LongName, Unit, Comment, etc.
<p><i>type</i>&#160;: Label type , L, C, U, P, etc.
</p><p><i>rowNum</i>&#160;: The Number of the row to set as label (This row will not be removed); -1 = remove the active row when you set it as the label (Note: you need to select the row before running this script). 
</p><p><i>label</i>&#160;: 1 = select the label row, 0 = select the data row. 
</p><p><i>append</i>&#160;: 1 = append the content in the selected row to label (Only works for Long Name and Comments); 0 = use the content in the selected row to replace the original content.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//Set the second label row as the Long name.</span>
wks.<span style="color: #000080;">SetAsLabel</span><span style="color: #000000;">&#40;</span>L,<span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">//Append the fourth data row to the Comment.</span>
wks.<span style="color: #000080;">SetAsLabel</span><span style="color: #000000;">&#40;</span>C,<span style="color: #0000dd;">4</span>,<span style="color: #0000dd;">0</span>,<span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">//Set the first data row as the Unit.</span>
<span style="color: #008000;">//(The first data row should be active, </span>
<span style="color: #008000;">// and it will be removed after running the script).</span>
worksheet <span style="color: #000080;">-</span>s <span style="color: #0000dd;">0</span> <span style="color: #0000dd;">1</span> <span style="color: #0000dd;">0</span> <span style="color: #0000dd;">1</span>;  
wks.<span style="color: #000080;">SetAsLabel</span><span style="color: #000000;">&#40;</span>U,<span style="color: #000080;">-</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">0</span>,<span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;</pre>
</td></tr>
<tr>
<td> wks.sortCols(<i>char</i>, <i>c1</i>, <i>c2</i>, <i>order</i>, <i>skipHidden</i>)
</td>
<td> Sort worksheet columns by string content of one or more column label rows. The method returns 0 if it succeeds.
<p>All arguments except <i>char</i> are optional:<br />
</p><p><i>char</i> = one or more of these <a href="../../LabTalk/LabTalk/Column_Label_Row_Characters.html#Column_Label_Row_Properties" title="LabTalk:Column Label Row Characters">column row label characters</a>. If multiple <i>char</i> are given, sorting is nested.<br />
<i>c1</i> = starting column to sort. If <i>c1</i> and <i>c2</i> are omitted or if <i>c1</i>=0 and <i>c2</i>=-1, entire workhseet is sorted<br />
<i>c2</i> = ending column to sort<br />
<i>order</i> = a (ascending order) or d (descending order). If <i>order</i> is omitted, sort ascending<br />
<i>skipHidden</i> = a numeric value. If non-zero, skip hidden columns during sort. If 0 or omitted, do not skip hidden columns. 
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// sort worksheet columns on column Long Name, in ascending order</span>
wks.<span style="color: #000080;">sortCols</span><span style="color: #000000;">&#40;</span>L<span style="color: #000000;">&#41;</span>; 
<span style="color: #008000;">// nested sort User-defined Parameter (a) &gt; Long Name (d), all cols, skip hidden</span>
wks.<span style="color: #000080;">sortCols</span><span style="color: #000000;">&#40;</span>D1L,,,ad,<span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;</pre>
</td></tr>
<tr>
<td> wks.template( <i>FileName</i>[,[<i>WinName</i>],NumRows])
</td>
<td> Apply the template named <i>FileName</i> to &lt;NumRows&gt; rows of window <i>WinName</i>
</td></tr>
<tr>
<td> wks.GetNextVisibleRow(<i>n</i>)
</td>
<td> Find the next visible row starting from the given row <i>n</i>. The GetNextVisibleRow(<i>n</i>) will check the rows after row <i>n</i> one by one, it outputs the row index if a visible row was found. So wks.GetNextVisibleRow(0) will give you the first visible row.
</td></tr>
<tr>
<td> wks.userparam(str)
</td>
<td> Return index of the specified User Parameter, 0 if not found. For example:
<pre class="lt" style="font-family:monospace;">wks.<span style="color: #000080;">userparam</span><span style="color: #000000;">&#40;</span>Location<span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>;<span style="color: #008000;">// return User Parameter &quot;Location&quot;'s index</span></pre>
<p>Add new User Parameter.<br />
</p>
<pre class="lt" style="font-family:monospace;">wks.<span style="color: #000080;">userparam</span><span style="color: #000000;">&#40;</span><span style="color: #000080;">++</span>Factor<span style="color: #000000;">&#41;</span> <span style="color: #008000;">// add User Parameter &quot;Factor&quot;</span></pre>
</td></tr></table>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<h3><a name="Work_with_Worksheet_Columns_and_Rows"></a><span class="mw-headline">Work with Worksheet Columns and Rows</span></h3>
<p>When a new worksheet is <a class="external text" href="../../XFunction/X-Function/Newsheet.html">created</a>, there are 2 columns and 32 rows by default. To read or set the number of worksheet columns and rows, you can use the <b>wks.ncols</b> and <b>wks.nrows</b> properties.
</p>
<pre class="lt" style="font-family:monospace;">newsheet; <span style="color: #008000;">// Add a new worksheet</span>
wks.<span style="color: #000080;">ncols</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>; <span style="color: #008000;">// Set the number of columns to 5</span>
wks.<span style="color: #000080;">nrows</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">100</span>; <span style="color: #008000;">// Set the number of rows to 100</span></pre>
<p>Note that Origin will delete columns beyond (i.e., to the right of) the number you specify. So, in general, it is safer to use the <b>wks.addCol()</b> method to add columns.
</p>
<pre class="lt" style="font-family:monospace;">page.<span style="color: #000080;">xlcolname</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; <span style="color: #008000;">// Turn off Spreadsheet Cell Notation firstly</span>
wks.<span style="color: #000080;">addCol</span><span style="color: #000000;">&#40;</span>Does<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Add a column with short name 'Does'</span></pre>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Wks_(object)/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>For the <a class="external text" href="../../UserGuide/UserGuide/Column_Short_Name_Restriction.html">Spreadsheet Cell Notation</a> in the workbook, please see <a class="external text" href="../../QuickHelp/QuickHelp/Turn_off_spreadsheet_cell_notation.html"><b>FAQ-849</b></a> for more information.
</p></td></tr></table>
<p>Regarding worksheet rows, two properties are similar, <b>wks.maxRows</b> and <b>wks.nRows</b>. The former finds the largest row index in the worksheet that has a value, while the latter sets or reads the number of rows in the worksheet. The following script illustrates how to use these two properties:
</p>
<pre class="lt" style="font-family:monospace;">newbook; <span style="color: #008000;">// Create a new workbook</span>
col<span style="color: #000000;">&#40;</span>b<span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">10</span><span style="color: #000000;">&#125;</span>; <span style="color: #008000;">// Fill 10 numbers to column B</span>
wks.<span style="color: #000080;">maxRows</span> <span style="color: #000080;">=</span>&#160;; <span style="color: #008000;">// Returns 10</span>
wks.<span style="color: #000080;">nRows</span> <span style="color: #000080;">=</span>&#160;; <span style="color: #008000;">// Returns 32</span></pre>
<h3><a name="Display_Worksheet_Column_Labels"></a><span class="mw-headline">Display Worksheet Column Labels</span></h3>
<p>This script creates an empty table for the average temperature in different cities. In this example, we will create a user-defined parameter and show the worksheet long name, unit and the user-defined parameter.
</p>
<pre class="lt" style="font-family:monospace;">range ww <span style="color: #000080;">=</span> <span style="color: #000080;">!</span>;  <span style="color: #008000;">// Define a range, on active worksheet</span>
ww.<span style="color: #000080;">name</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Average Temperature&quot;</span>;  <span style="color: #008000;">// Rename the worksheet</span>
ww.<span style="color: #000080;">ncols</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">13</span>;  <span style="color: #008000;">// Set total number of columns</span>
ww.<span style="color: #000080;">userParam1</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Month;  <span style="color: #008000;">// Define a new user parameter label</span>
<span style="color: #008000;">// Show the worksheet long name, unit and a user parameter</span>
ww.<span style="color: #000080;">labels</span><span style="color: #000000;">&#40;</span>LUD1<span style="color: #000000;">&#41;</span>;  
Col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span>L<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> City;  <span style="color: #008000;">// Set column long name</span>
stringarray month <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #ff00ff;">&quot;Jun.&quot;</span>, <span style="color: #ff00ff;">&quot;Feb.&quot;</span>, <span style="color: #ff00ff;">&quot;Mar.&quot;</span>, <span style="color: #ff00ff;">&quot;Apr.&quot;</span>, <span style="color: #ff00ff;">&quot;May.&quot;</span>, <span style="color: #ff00ff;">&quot;Jun.&quot;</span>, 
                   <span style="color: #ff00ff;">&quot;July&quot;</span>, <span style="color: #ff00ff;">&quot;Aug.&quot;</span>, <span style="color: #ff00ff;">&quot;Sep.&quot;</span>, <span style="color: #ff00ff;">&quot;Oct.&quot;</span>, <span style="color: #ff00ff;">&quot;Nov.&quot;</span>, <span style="color: #ff00ff;">&quot;Dec.&quot;</span><span style="color: #000000;">&#125;</span>;
loop<span style="color: #000000;">&#40;</span>ii, <span style="color: #0000dd;">2</span>, <span style="color: #0000dd;">13</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	Col<span style="color: #000000;">&#40;</span><span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>ii<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span>L<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Temperature;  <span style="color: #008000;">// Set column long name</span>
	Col<span style="color: #000000;">&#40;</span><span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>ii<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span>U<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> \<span style="color: #000080;">+</span><span style="color: #000000;">&#40;</span>o<span style="color: #000000;">&#41;</span>F;  <span style="color: #008000;">// Set column unit</span>
        <span style="color: #008000;">// Set column user parameter</span>
	Col<span style="color: #000000;">&#40;</span><span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>ii<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span>D1<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> month.<span style="color: #000080;">getAt</span><span style="color: #000000;">&#40;</span>ii<span style="color: #000080;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">$</span>;  
<span style="color: #000000;">&#125;</span></pre>
<h3><a name="Get_the_unhidden_value_from_the_column_in_worksheet"></a><span class="mw-headline">Get the unhidden value from the column in worksheet</span></h3>
<p>1. Assume some of values are hidden by Filter in worksheet, the script below will list the unhidden value in the column.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//with the worksheet active</span>
for <span style="color: #000000;">&#40;</span>int ii<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>; ii <span style="color: #000080;">&lt;=</span> wks.<span style="color: #000080;">nrows</span>; ii<span style="color: #000080;">++</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#123;</span>
if<span style="color: #000000;">&#40;</span>wks.<span style="color: #000080;">isRowHidden</span><span style="color: #000000;">&#40;</span>ii<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#123;</span>       <span style="color: #008000;">//continue id there is a hidden row</span>
  ii <span style="color: #000080;">=</span> wks.<span style="color: #000080;">GetNextVisibleRow</span><span style="color: #000000;">&#40;</span>ii<span style="color: #000000;">&#41;</span>;   <span style="color: #008000;">//get the 1st not hidden row number after this hidden row</span>
  col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span><span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>ii<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">=</span>;  
<span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span>;</pre>
<p>2. The second example shows how the function GetNextVisibleRow works, assume we have a worksheet as shown below:
</p>
<dl><dd><dl><dd><a  class="image"><img alt="Bookhide.png" src="../images/Wks_(object)/Bookhide.png?v=32684" width="227"  /></a></dd></dl></dd></dl>
<p>Run the script with the worksheet active: 
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//with the worksheet active</span>
type <span style="color: #ff00ff;">&quot;The 1st visable row is $(wks.GetNextVisibleRow(0))&quot;</span>;
loop<span style="color: #000000;">&#40;</span>ii,<span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#123;</span>
a<span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>ii<span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>wks.<span style="color: #000080;">GetNextVisibleRow</span><span style="color: #000000;">&#40;</span>ii<span style="color: #000000;">&#41;</span>;
type <span style="color: #ff00ff;">&quot;The 1st visible row after row $(ii) is $(a$(ii))&quot;</span>;
<span style="color: #000000;">&#125;</span></pre>
<p>The results output:
</p>
<pre class="lt" style="font-family:monospace;">The 1st visible row is <span style="color: #0000dd;">1</span>
The 1st visible row after row <span style="color: #0000dd;">1</span> is <span style="color: #0000dd;">3</span>
The 1st visible row after row <span style="color: #0000dd;">2</span> is <span style="color: #0000dd;">3</span>
The 1st visible row after row <span style="color: #0000dd;">3</span> is <span style="color: #0000dd;">5</span></pre>
<h2><a name="See_Also"></a><span class="mw-headline">See Also</span></h2>
<p><a href="../../LabTalk/Script/LabTalk-Supported_X-Functions.html#Worksheet" title="Script:LabTalk-Supported X-Functions">Worksheet Manipulation X-Functions</a>
</p>

