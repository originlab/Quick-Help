<h1 class="firstHeading">2.7.2.3 Converting Worksheet to Matrix</h1><p>You may need to re-organize your data by converting from worksheet to matrix, or vice versa, for certain analysis or graphing needs. This page provides information and examples of converting worksheet to matrix, and please refer to <a href="../../LabTalk/Script/Converting_Matrix_to_Worksheet.html" title="Script:Converting Matrix to Worksheet">Converting Matrix to Worksheet</a> for the "vice versa" case.
</p>
<h2><a name="Worksheet_to_Matrix"></a><span class="mw-headline">Worksheet to Matrix</span></h2>
<p>Data contained in a worksheet can be converted to a matrix using a set of 
<a class="external text" href="../../LabTalk/Script/LabTalk-Supported_X-Functions.html#Gridding">Gridding X-Functions</a>. 
</p><p>The <a class="external text" href="../../XFunction/X-Function/W2m.html">w2m</a> X-Function converts matrix-like worksheet data directly into a matrix. Data in source worksheet can contain the X or Y coordinate values in the first column, first row, or a header row. However, because the coordinates in a matrix should be uniform spaced, you should have uniformly spaced X/Y values in the source worksheet.
</p><p>If your X/Y coordinate values are not uniform spaced, you should use the  <a href="../../LabTalk/Script/Virtual_Matrix.html" title="Script:Virtual Matrix">Virtual Matrix</a> feature instead of converting to a matrix.
</p><p>The following example show how to perform direct worksheet to matrix conversion:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create a new workbook</span>
newbook;
<span style="color: #008000;">// Import sample data</span>
string fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span>
	<span style="color: #ff00ff;">&quot;\samples\Matrix Conversion and Gridding\DirectXY.dat&quot;</span>;
impasc;
<span style="color: #008000;">// Covert worksheet to matrix, first row will be X and first column will be Y</span>
w2m xy<span style="color: #000000;">:</span><span style="color: #000080;">=</span>xcol xlabel<span style="color: #000000;">:</span><span style="color: #000080;">=</span>row1 ycol<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
<span style="color: #008000;">// Show X/Y values in the matrix window</span>
page.<span style="color: #000080;">cntrl</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;</pre>
<p>When your worksheet data is organized in XYZ column form, you should use Gridding to convert such data into a matrix. Many gridding methods are available, which will interpolate your source data and generate a uniformly spaced array of values with the X and Y dimensions specified by you.
</p><p>The following example converts XYZ worksheet data by Renka-Cline gridding method, and then creates a 3D graph from the new matrix.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create a new workbook without sheets</span>
newbook;
<span style="color: #008000;">// Import sample data</span>
string fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span>
	<span style="color: #ff00ff;">&quot;\samples\Matrix Conversion and Gridding\XYZ Random Gaussian.dat&quot;</span>;
impasc;
<span style="color: #008000;">// Convert worksheet data into a 20 x 20 matrix by Renka-Cline gridding method</span>
xyz_renka <span style="color: #0000dd;">3</span> <span style="color: #0000dd;">20</span> <span style="color: #0000dd;">20</span>;
<span style="color: #008000;">// Plot a 3D color map graph</span>
worksheet <span style="color: #000080;">-</span>p <span style="color: #0000dd;">242</span> cmap;</pre>






