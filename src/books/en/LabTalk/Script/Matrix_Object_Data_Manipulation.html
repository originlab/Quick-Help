<h1 class="firstHeading">2.8.3.2 Matrix Object Data Manipulation</h1><p>In addition to the <a href="../../LabTalk/LabTalk/Matrix_(command).html" title="LabTalk:Matrix (command)">matrix</a> command, Origin provides X-Functions for performing specific operations on matrix object data. In this section we present examples of X-Functions that available used to work with matrix object data.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Set_Values_in_Matrix_Object"><span class="tocnumber">1</span> <span class="toctext">Set Values in Matrix Object</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Copy_Matrix_DataCopy_Matrix"><span class="tocnumber">2</span> <span class="toctext">Copy Matrix Data<span class="OIndex" style="display:none">Copy Matrix</span></span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Conversion_between_Matrix_Object_and_Vector"><span class="tocnumber">3</span> <span class="toctext">Conversion between Matrix Object and Vector</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Conversion_between_Numeric_Data_and_Image_Data"><span class="tocnumber">4</span> <span class="toctext">Conversion between Numeric Data and Image Data</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Manipulate_Matrix_Object_with_Complex_Values"><span class="tocnumber">5</span> <span class="toctext">Manipulate Matrix Object with Complex Values</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Transform_Matrix_Object_Data"><span class="tocnumber">6</span> <span class="toctext">Transform Matrix Object Data</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#Crop_or_extract_from_Data_or_Image_Matrix"><span class="tocnumber">6.1</span> <span class="toctext">Crop or extract from Data or Image Matrix</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Expand_Data_Matrix"><span class="tocnumber">6.2</span> <span class="toctext">Expand Data Matrix</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Flip_Data_or_Image_Matrix"><span class="tocnumber">6.3</span> <span class="toctext">Flip Data or Image Matrix</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Rotate_Data_or_Image_Matrix"><span class="tocnumber">6.4</span> <span class="toctext">Rotate Data or Image Matrix</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Shrink_Data_Matrix"><span class="tocnumber">6.5</span> <span class="toctext">Shrink Data Matrix</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Transpose_Data_Matrix"><span class="tocnumber">6.6</span> <span class="toctext">Transpose Data Matrix</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-13"><a href="#Split_RGB_Image_into_Separate_Channels"><span class="tocnumber">7</span> <span class="toctext">Split RGB Image into Separate Channels</span></a></li>
<li class="toclevel-1 tocsection-14"><a href="#Use_Temporary_Matrix_Object_as_Intermediate_Analysis_Result"><span class="tocnumber">8</span> <span class="toctext">Use Temporary Matrix Object as Intermediate Analysis Result</span></a></li>
</ul>
</div>

<h2><a name="Set_Values_in_Matrix_Object"></a><span class="mw-headline">Set Values in Matrix Object</span></h2>
<p><span class="OIndex" style="display:none">set matrix value</span>Matrix cell values can be set either using the <a class="external text" href="../../LabTalk/LabTalk/Matrix_(command).html#-v.3B_Fill_the_matrix_with_values_from_the_expression">matrix -v</a> command or the <a class="external text" href="../../XFunction/X-Function/Msetvalue.html">msetvalue</a> X-Function. The matrix -v command works only on an active matrix object, whereas the X-Function can set values in any matrixsheet.
</p><p>This example shows how to set matrix values and then turn on display of image thumbnails in the matrix window.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create a matrixbook</span>
newbook mat<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>; 
int nmats <span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span>; 
range msheet<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span>;
<span style="color: #008000;">// Set the number of matrix objects</span>
msheet.<span style="color: #000080;">Nmats</span> <span style="color: #000080;">=</span> nmats;
<span style="color: #008000;">// Set value to the first matrix object </span>
matrix <span style="color: #000080;">-</span>v x<span style="color: #000080;">+</span>y;
range mm<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>; mm.<span style="color: #000080;">label</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;x+y&quot;</span>; 
double ff<span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>; 
<span style="color: #008000;">// Loop over other objects</span>
loop<span style="color: #000000;">&#40;</span>i, <span style="color: #0000dd;">2</span>, nmats<span style="color: #000080;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> 
	msheet.<span style="color: #000080;">active</span> <span style="color: #000080;">=</span> i; 
	ff <span style="color: #000080;">=</span> <span style="color: #000000;">&#40;</span>i<span style="color: #000080;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">/</span><span style="color: #000000;">&#40;</span>nmats<span style="color: #000080;">-</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #008000;">// Set values</span>
	matrix <span style="color: #000080;">-</span>v <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">5</span><span style="color: #000080;">/</span>ff<span style="color: #000000;">&#41;</span><span style="color: #000080;">*</span>sin<span style="color: #000000;">&#40;</span>x<span style="color: #000000;">&#41;</span> <span style="color: #000080;">+</span> ff<span style="color: #000080;">*</span><span style="color: #0000dd;">20</span><span style="color: #000080;">*</span>cos<span style="color: #000000;">&#40;</span>y<span style="color: #000000;">&#41;</span>; 
	<span style="color: #008000;">// Set LongName </span>
	range aa<span style="color: #000080;">=</span><span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>i<span style="color: #000000;">&#41;</span>; 
	aa.<span style="color: #000080;">label</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;$(5/ff,*3)*sin(x) + $(ff*20)*cos(y)&quot;</span>; 
<span style="color: #000000;">&#125;</span>
<span style="color: #008000;">// Fill last one with random values</span>
msheet.<span style="color: #000080;">active</span> <span style="color: #000080;">=</span> nmats; 
matrix <span style="color: #000080;">-</span>v rnd<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; 
range mm<span style="color: #000080;">=</span><span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>nmats<span style="color: #000000;">&#41;</span>; mm.<span style="color: #000080;">label</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;random&quot;</span>;
<span style="color: #008000;">// Display thumbnail images in window</span>
matrix <span style="color: #000080;">-</span>it;</pre>
<h2><a name="Copy_Matrix_DataCopy_Matrix"></a><span class="mw-headline">Copy Matrix Data<span class="OIndex" style="display:none">Copy Matrix</span></span></h2>
<p>The <a class="external text" href="../../XFunction/X-Function/Mcopy.html">mcopy</a> X-Function is used to <span class="OIndex">copy matrix</span><span class="OIndex HasShownIndex" style="display:none">matrix, copy</span> data.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Copy data from mbook1 into another matrix, mbook2.</span>
mcopy im<span style="color: #000000;">:</span><span style="color: #000080;">=</span>mbook1 om<span style="color: #000000;">:</span><span style="color: #000080;">=</span>mbook2; <span style="color: #008000;">// This command auto-redimensions the target</span></pre>
<h2><a name="Conversion_between_Matrix_Object_and_Vector"></a><span class="mw-headline">Conversion between Matrix Object and Vector</span></h2>
<p>Two X-Functions, <a class="external text" href="../../XFunction/X-Function/M2v.html">m2v</a> and <a class="external text" href="../../XFunction/X-Function/V2m.html">v2m</a>, are available for converting matrix data into a vector, and vector data into a matrix, respectively. Origin uses row-major ordering for storing a matrix, but both functions allow for column-major ordering to be specified as well.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Copy the whole matrix, column by column, into a worksheet column</span>
m2v method<span style="color: #000000;">:</span><span style="color: #000080;">=</span>m2v direction<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col;
<span style="color: #008000;">// Copy data from col(1) into specified matrix object</span>
v2m ix<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span> method<span style="color: #000000;">:</span><span style="color: #000080;">=</span>v2row om<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>Mbook1<span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #0000dd;">1</span>;</pre>
<h2><a name="Conversion_between_Numeric_Data_and_Image_Data"></a><span class="mw-headline">Conversion between Numeric Data and Image Data</span></h2>
<p>In Origin, matrices can contain image data (i.e., RGB) or numeric data (i.e., integer). The following functions are available to convert between the two formats. 
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Convert a grayscale image to a numeric data matrix</span>
img2m img<span style="color: #000000;">:</span><span style="color: #000080;">=</span>mat<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span> om<span style="color: #000000;">:</span><span style="color: #000080;">=</span>mat<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> type<span style="color: #000000;">:</span><span style="color: #000080;">=</span>byte; 
<span style="color: #008000;">// Convert a numeric matrix to a grayscale image</span>
m2img bits<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">16</span>;</pre>
<h2><a name="Manipulate_Matrix_Object_with_Complex_Values"></a><span class="mw-headline">Manipulate Matrix Object with Complex Values</span></h2>
<p>X-Functions for manipulating a matrix with complex values include <a class="external text" href="../../XFunction/X-Function/Map2c.html">map2c</a>, <a class="external text" href="../../XFunction/X-Function/Mc2ap.html">mc2ap</a>, <a class="external text" href="../../XFunction/X-Function/Mri2c.html">mri2c</a>, and <a class="external text" href="../../XFunction/X-Function/Mc2ri.html">mc2ri</a>. These X-Functions can merge two matrices (amplitude and phase, or real and imaginary) into one complex matrix, or split a complex matrix into amplitude/phase or real/imaginary components.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Combine Amplitude and Phase into Complex</span>
map2c am<span style="color: #000000;">:</span><span style="color: #000080;">=</span>mat<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span> pm<span style="color: #000000;">:</span><span style="color: #000080;">=</span>mat<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> cm<span style="color: #000000;">:</span><span style="color: #000080;">=</span>mat<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>; 
<span style="color: #008000;">// Combine Real and imaginary in different matrices to complex in new matrix</span>
mri2c rm<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>MBook1<span style="color: #000000;">&#93;</span>MSheet1<span style="color: #000080;">!</span>mat<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span> im<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>MBook2<span style="color: #000000;">&#93;</span>MSheet1<span style="color: #000080;">!</span>mat<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span> cm<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>new<span style="color: #000080;">&gt;</span>;
<span style="color: #008000;">// Convert complex numbers to two new matrix with amplitude and phase respectively</span>
mc2ap cm<span style="color: #000000;">:</span><span style="color: #000080;">=</span>mat<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span> am<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>new<span style="color: #000080;">&gt;</span> pm<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>new<span style="color: #000080;">&gt;</span>; 
<span style="color: #008000;">// Convert complex numbers to two matrix objects with real part and imaginary part</span>
mc2ri cm<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>MBook1<span style="color: #000000;">&#93;</span>MSheet1<span style="color: #000080;">!</span>Complex rm<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>Split<span style="color: #000000;">&#93;</span>Real im<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>Split<span style="color: #000000;">&#93;</span>Imaginary;</pre>
<h2><a name="Transform_Matrix_Object_Data"></a><span class="mw-headline">Transform Matrix Object Data</span></h2>
<p>Use the following X-Functions to physically alter the dimensions or contents of a matrix. In the transformations below, except the flipping matrix object, others may change the dimensions of its matrixsheet, which will make the change on other matrix objects in this matrixsheet.
</p>
<h3><a name="Crop_or_extract_from_Data_or_Image_Matrix"></a><span class="mw-headline">Crop or extract from Data or Image Matrix</span></h3>
<p>When a matrix contains an image in a matrix, the X-Function <a class="external text" href="../../XFunction/X-Function/MCrop.html">mcrop</a> can be used to extract or crop to a rectangular region of the matrix.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Crop an image matrix to 50 by 25 beginning from 10 pixels </span>
<span style="color: #008000;">// from the left and 20 pixels from the top.</span>
mcrop x<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">10</span> y<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">20</span> w<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">50</span> h<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">25</span> im<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>active<span style="color: #000080;">&gt;</span> om<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>input<span style="color: #000080;">&gt;</span>; <span style="color: #008000;">// &lt;input&gt; will crop</span>
<span style="color: #008000;">// Extract the central part of an image matrix to a new image matrix</span>
<span style="color: #008000;">// Matrix window must be active</span>
matrix <span style="color: #000080;">-</span>pg DIM px py;
dx <span style="color: #000080;">=</span> nint<span style="color: #000000;">&#40;</span>px<span style="color: #000080;">/</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>;
dy <span style="color: #000080;">=</span> nint<span style="color: #000000;">&#40;</span>py<span style="color: #000080;">/</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>;
mcrop x<span style="color: #000000;">:</span><span style="color: #000080;">=</span>dx y<span style="color: #000000;">:</span><span style="color: #000080;">=</span>dy h<span style="color: #000000;">:</span><span style="color: #000080;">=</span>dy w<span style="color: #000000;">:</span><span style="color: #000080;">=</span>dx om<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>new<span style="color: #000080;">&gt;</span>; <span style="color: #008000;">// &lt;new&gt; will extract</span></pre>
<h3><a name="Expand_Data_Matrix"></a><span class="mw-headline">Expand Data Matrix</span></h3>
<p>The X-Function <a class="external text" href="../../XFunction/X-Function/Mexpand.html">mexpand</a> can expand a data matrix using specified column and row factors. Biquadratic interpolation is used to calculate the values for the new cells.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Expand the active matrix with both factor of 2</span>
mexpand cols<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span> rows<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>;</pre>
<h3><a name="Flip_Data_or_Image_Matrix"></a><span class="mw-headline">Flip Data or Image Matrix</span></h3>
<p>The X-Function <a class="external text" href="../../XFunction/X-Function/Mflip.html">mflip</a> can flip a matrix horizontally or vertically to produce its mirror matrix. 
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Flip a matrix vertically</span>
mflip flip<span style="color: #000000;">:</span><span style="color: #000080;">=</span>vertical;

<span style="color: #008000;">// Can also use the &quot;matrix&quot; command</span>
matrix <span style="color: #000080;">-</span>c h;  <span style="color: #008000;">// horizontally</span>
matrix <span style="color: #000080;">-</span>c v;  <span style="color: #008000;">// vertically</span></pre>
<h3><a name="Rotate_Data_or_Image_Matrix"></a><span class="mw-headline">Rotate Data or Image Matrix</span></h3>
<p>With the X-Function <a class="external text" href="../../XFunction/X-Function/Mrotate90.html">mrotate90</a>, you can rotate a matrix 90/180 degrees clockwise or counterclockwise. 
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Rotate the matrix 90 degrees clockwize</span>
mrotate90 degree<span style="color: #000000;">:</span><span style="color: #000080;">=</span>cw90;

<span style="color: #008000;">// Can also use the &quot;matrix&quot; command to rotate matrix 90 degrees</span>
matrix <span style="color: #000080;">-</span>c r;</pre>
<h3><a name="Shrink_Data_Matrix"></a><span class="mw-headline">Shrink Data Matrix</span></h3>
<p>The X-Function <a class="external text" href="../../XFunction/X-Function/Mshrink.html">mshrink</a> can shrink a data matrix by specified row and column factors.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Shrink the active matrix by column factor of 2, and row factor of 1</span>
mshrink cols<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span> rows<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;</pre>
<h3><a name="Transpose_Data_Matrix"></a><span class="mw-headline">Transpose Data Matrix</span></h3>
<p>The X-Function <a class="external text" href="../../XFunction/X-Function/Mtranspose.html">mtranspose</a> can be used to transpose a matrix. 
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Transpose the second matrix object of [MBook1]MSheet1!</span>
mtranspose im<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>MBook1<span style="color: #000000;">&#93;</span>MSheet1<span style="color: #000080;">!</span><span style="color: #0000dd;">2</span>;

<span style="color: #008000;">// Can also use the &quot;matrix&quot; command to transpose a matrix</span>
matrix <span style="color: #000080;">-</span>t;</pre>
<h2><a name="Split_RGB_Image_into_Separate_Channels"></a><span class="mw-headline">Split RGB Image into Separate Channels</span></h2>
<p>The <a class="external text" href="../../XFunction/X-Function/ImgRGBsplit.html">imgRGBsplit</a> X-Functions splits color images into separate R, G, B channels. For example:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Split channels creating separate matrices for red, green and blue</span>
imgRGBsplit img<span style="color: #000000;">:</span><span style="color: #000080;">=</span>mat<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span> r<span style="color: #000000;">:</span><span style="color: #000080;">=</span>mat<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> g<span style="color: #000000;">:</span><span style="color: #000080;">=</span>mat<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span> b<span style="color: #000000;">:</span><span style="color: #000080;">=</span>mat<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span> colorize<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;
<span style="color: #008000;">// Split channels and apply red, green, blue palettes to the result matrices</span>
imgRGBsplit img<span style="color: #000000;">:</span><span style="color: #000080;">=</span>mat<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span> r<span style="color: #000000;">:</span><span style="color: #000080;">=</span>mat<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> g<span style="color: #000000;">:</span><span style="color: #000080;">=</span>mat<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span> b<span style="color: #000000;">:</span><span style="color: #000080;">=</span>mat<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span> colorize<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;</pre>
<p>Please see <a href="../../LabTalk/Script/LabTalk-Supported_X-Functions.html#Image" title="Script:LabTalk-Supported X-Functions">Image Processing X-Functions</a> for further information on image handling.
</p>
<h2><a name="Use_Temporary_Matrix_Object_as_Intermediate_Analysis_Result"></a><span class="mw-headline">Use Temporary Matrix Object as Intermediate Analysis Result</span></h2>
<p>Sometimes user may not want to create a new Matrixbook for output in X-Function each time when performing intermediate matrix analysis operations. He can create a temporary matrix in a hidden Matrixbook for intermediate output, and delete the Matrixbook when it is not needed in next operation.
</p>
<ul><li> Example 1</li></ul>
<p>This example shows how to save intermediate image operation result in a temporary Matrixbook, and delete it in the next step.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//Import an image into Origin's Matrixbook</span>
string fn<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Image Processing and Analysis\white camellia.jpg&quot;</span>; 
impImage fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>fn<span style="color: #000080;">$</span>;
<span style="color: #008000;">//Create a hidden Matrixbook</span>
newbook hidden<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> mat<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
<span style="color: #000080;">%</span>A <span style="color: #000080;">=</span> bkname<span style="color: #000080;">$</span>;
<span style="color: #008000;">//Perform Auto Level operation and save the output in the hidden Matrixbook</span>
imgAutoLevel oimg<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span><span style="color: #000080;">%</span>A<span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span> cl<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>optional<span style="color: #000080;">&gt;</span>;
<span style="color: #008000;">//Apply Median filter on the image from Auto Level operation</span>
imgMedian d<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span> img<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span><span style="color: #000080;">%</span>A<span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span> oimg<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>new<span style="color: #000080;">&gt;</span>;
<span style="color: #008000;">//Delete the intermediate matrix</span>
win <span style="color: #000080;">-</span>cd <span style="color: #000080;">%</span>A;</pre>
<ul><li> Example 2</li></ul>
<p>In this example, a median filter was applied on a matrix, and the volume was calculated after the minimum was subtracted. All intermediate matrix results were saved in a hidden temporary Matrixbook, and the Matrixbook was deleted after it was not needed.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//Open a sample Matrixbook</span>
string fn<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Matrix Conversion and Gridding\2D Gaussian.ogm&quot;</span>;
doc <span style="color: #000080;">-</span>o <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>fn<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">//Create a temporary hidden Matrixbook</span>
newbook hidden<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> mat<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
<span style="color: #000080;">%</span>A <span style="color: #000080;">=</span> bkname<span style="color: #000080;">$</span>;
range rm <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span><span style="color: #000080;">%</span>A<span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span>;
<span style="color: #008000;">//Add two matrix objects to receive two intermediate matrix results</span>
rm.<span style="color: #000080;">nmats</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
<span style="color: #008000;">//Apply a median filter on a matrix</span>
medianflt2 n<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span> po<span style="color: #000000;">:</span><span style="color: #000080;">=</span>RepeatPadding om<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span><span style="color: #000080;">%</span>A<span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span>mat<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">//Subtract the minimum</span>
msetvalue im<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span><span style="color: #000080;">%</span>A<span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span>mat<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> formula<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;mat(1)-z0&quot;</span> script<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;double z0; mstats im:=mat(1) min:=z0;&quot;</span>;
<span style="color: #008000;">//Integrate the matrix</span>
double dv;
integ2 im<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span><span style="color: #000080;">%</span>A<span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span>mat<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> integral<span style="color: #000000;">:</span><span style="color: #000080;">=</span>dv;
win <span style="color: #000080;">-</span>cd <span style="color: #000080;">%</span>A;</pre>






