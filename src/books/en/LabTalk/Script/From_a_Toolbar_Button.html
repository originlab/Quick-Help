<h1 class="firstHeading">2.5.1.15 From a Toolbar Button</h1><p class='urlname' style='display: none'>From-a-Toolbar-Button</p>
<p><span class="OIndex" style="display:none">Run Script from Toolbar Buttons</span><span class="OIndex" style="display:none">script, from a toolbar button</span>
LabTalk script files can also be run from buttons on the Origin <span class="OIndex">toolbar</span>.  In <a href="../../LabTalk/Script/Getting_Started_with_LabTalk.html#Custom_Routine" title="Script:Getting Started with LabTalk">Getting Started with LabTalk</a> chapter, we have introduced how to run Custom Routine from a toolbar button, here we will introduce more details. Three files enable this to happen:
</p>
<ol><li> A bitmap file that defines the appearance of the button.  Use one of the set of <a href="#Custom_Buttons_Available_in_Origin">buttons provided in Origin</a> or <a href="#Creating_a_Bitmap_File_for_a_New_Button">create your own</a>.</li>
<li> A LabTalk script file that will be executed when the user clicks the button. </li>
<li> An INI file that stores information about the button or button group.  Origin creates the INI file for you, when you follow the procedure below. </li></ol>
<p><br />
We will assume for now that you have a bitmap image file (BMP) that will define the button itself (if you are interested in creating one, example steps are given <a href="#Creating_a_Bitmap_File_for_a_New_Button">below</a>).
</p><p>First, use <b>CodeBuilder</b> (select <a  class="image"><img alt="Button Code Builder.png" src="../images/From_a_Toolbar_Button/Button_Code_Builder.png?v=0" width="23"  /></a> on the Origin Standard Toolbar to open) or other text editor, to develop your LabTalk script (OGS) file.  Save the file with the OGS extension.  You may divide a single script file into several sections, and associate each section with a different toolbar button.  
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Putting_a_Button_on_an_Origin_Toolbar"><span class="tocnumber">1</span> <span class="toctext">Putting a Button on an Origin Toolbar</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Match_the_Button_with_a_LabTalk_Script_.28OGS.29_File"><span class="tocnumber">2</span> <span class="toctext">Match the Button with a LabTalk Script (OGS) File</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Custom_Buttons_Available_in_Origin"><span class="tocnumber">3</span> <span class="toctext">Custom Buttons Available in Origin</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Creating_a_Bitmap_File_for_a_New_Button"><span class="tocnumber">4</span> <span class="toctext">Creating a Bitmap File for a New Button</span></a></li>
</ul>
</div>

<h2><a name="Putting_a_Button_on_an_Origin_Toolbar"></a><span class="mw-headline">Putting a Button on an Origin Toolbar</span></h2>
<p>To put the button on an Origin toolbar, use this procedure:
</p>
<ol><li> In Origin, select <b>View:Toolbars</b> to open the Customize Toolbar dialog.</li>
<li> Make the <b>Button Groups</b> Tab active.</li>
<li> Click the <b>New</b> button in the <b>Button Group</b> to open the Create Button Group dialog.</li>
<li> Enter a new Group Name.</li>
<li> Enter the Number of Buttons for this new Group.</li>
<li> Click the Browse button to locate your bitmap file. This file should be in your User directory.</li>
<li> Click <b>OK</b>.</li>
<li> The <b>Save As</b> dialog will open. Enter the same name as that of your bitmap file. Click <b>OK</b> to save the INI file. You will now see that your group has been added to the Groups list and your button(s) is now visible.</li></ol>
<p>When creating a custom button group for export to an OPX file, consider saving your button group's initialization file, bitmap file(s), script file(s), and any other support files to a user-created subfolder in your <b>User Files</b> folder. When another Origin user installs your OPX file, your custom subfolder will automatically be created in the user's <b>User Files</b> folder, and this subfolder will contain the files for the custom button group. This allows you to keep your custom files separate from other Origin files.
</p>
<h2><a name="Match_the_Button_with_a_LabTalk_Script_.28OGS.29_File"></a><span class="mw-headline">Match the Button with a LabTalk Script (OGS) File</span></h2>
<ol><li> Click on the button to select it.</li>
<li> Click the Settings button, to open the Button Settings dialog.</li>
<li> Click the Browse button to locate your OGS file.</li>
<li> Enter the Section Name of the OGS file and any arguments in the Argument List.</li>
<li> Enter something descriptive in the Tool Tip Text text box.</li>
<li> Enter a status bar message in the Status Bar text box.</li>
<li> Click <b>OK</b>.</li>
<li> Repeat these steps for each of the buttons in your Button Group.</li>
<li> Drag the first button out onto your Origin workspace.  A toolbar is created.  You can now drag all other buttons onto this toolbar. </li></ol>
<h2><a name="Custom_Buttons_Available_in_Origin"></a><span class="mw-headline">Custom Buttons Available in Origin</span></h2>
<p>The following dialog can be accessed from the <b>View: Toolbars</b> menu option in Origin. On the <b>Button Groups</b> tab, scroll down to select the <b>User Defined</b> group:
</p><p><a  class="image"><img alt="CustomToolbarOptions.png" src="../images/From_a_Toolbar_Button/CustomToolbarOptions.png?v=0" width="461"  /></a>
<br />
<br />
</p><p>Drag any of these buttons onto the Origin toolbar to begin using them.  Use the procedure outlined above to associate a script with a given button.
</p>
<h2><a name="Creating_a_Bitmap_File_for_a_New_Button"></a><span class="mw-headline">Creating a Bitmap File for a New Button</span></h2>
<p>To create a bitmap file, using any program that allows you to edit and save a bitmap image (BMP) such as Window's Paint.  The following steps will help you get started:
</p><p><br />  
</p>
<ol><li> Using the bitmap for the built-in user defined toolbar is a good place to begin.  In Windows Paint, select <b>File:Open</b>, browse to your User Files folder and select <b>Userdef.bmp</b>.  </li>
<li> Set the image size.  Select <b>Image:Attributes</b>. The height needs to remain at 16 and should not be changed.  Each button is 16 pixels high by 16 pixels wide.  If your toolbar will be only 2 buttons then change the width to 32.  The width is always 16 times the number of buttons, with a maximum of 10 buttons or a width of 160. </li>
<li> Select <b>View:Zoom:Custom:800%</b>.  The image is now large enough to work with.</li>
<li> Select <b>View:Zoom:Show Grid</b>.  You can now color each pixel.  The fun begins - create a look for each button.   </li>
<li> Select <b>File:Save As</b>, enter a new File name but leave the <b>Save as type</b> to <b>16 Color Bitmap</b>.</li></ol>






