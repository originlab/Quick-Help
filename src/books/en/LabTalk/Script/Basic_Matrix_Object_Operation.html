<h1 class="firstHeading">2.8.3.1 Basic Matrix Object Operation</h1><p>A matrixsheet can have multiple matrix objects, which share the same dimensions. A matrix object is analogous to a worksheet column and can be added or deleted, etc. The following sections provide some practical examples on the basic operations of matrix object.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Add_or_Insert_Matrix_Object"><span class="tocnumber">1</span> <span class="toctext">Add or Insert Matrix Object</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Activate_Matrix_Object"><span class="tocnumber">2</span> <span class="toctext">Activate Matrix Object</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Switch_Between_Image_Mode_and_Data_Mode"><span class="tocnumber">3</span> <span class="toctext">Switch Between Image Mode and Data Mode</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Set_Labels"><span class="tocnumber">4</span> <span class="toctext">Set Labels</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Delete_Matrix_Object"><span class="tocnumber">5</span> <span class="toctext">Delete Matrix Object</span></a></li>
</ul>
</div>

<h2><a name="Add_or_Insert_Matrix_Object"></a><span class="mw-headline">Add or Insert Matrix Object</span></h2>
<p>It allows to set the number of matrix objects in the matrixsheet by using <a href="../../LabTalk/LabTalk/Wks_(object).html" title="LabTalk:Wks (object)">wks.nmats</a>, so to add matrix objects. Also, the method <a href="../../LabTalk/LabTalk/Wks_(object).html" title="LabTalk:Wks (object)">wks.addcol()</a> can be used to add a matrix object.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Set the number of matrix objects in the matrixsheet to 5</span>
wks.<span style="color: #000080;">nmats</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>;
<span style="color: #008000;">// Add a new matrix object to a matrixsheet</span>
wks.<span style="color: #000080;">addCol</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// Add a named matrix object to a matrixsheet</span>
wks.<span style="color: #000080;">addCol</span><span style="color: #000000;">&#40;</span>Channel2<span style="color: #000000;">&#41;</span>;</pre>
<p>By default, the 1st matrix object in matrixsheet is the current matrix object, you can use the <a href="../../LabTalk/LabTalk/Wks_(object).html" title="LabTalk:Wks (object)">wks.col</a> property. And the method <a href="../../LabTalk/LabTalk/Wks_(object).html" title="LabTalk:Wks (object)">wks.insert()</a> will insert matrix object before the current matrix object.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create a new matrixbook, and show image thumbnails</span>
newbook mat<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
matrix <span style="color: #000080;">-</span>it <span style="color: #0000dd;">1</span>;

<span style="color: #008000;">// Insert a matrix object before the 1st one in the active matrixsheet</span>
wks.<span style="color: #000080;">insert</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Set the 2nd matrix object to be the current one</span>
wks.<span style="color: #000080;">col</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;

<span style="color: #008000;">// Insert a matrix object before the 2nd one</span>
wks.<span style="color: #000080;">insert</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</pre>
<h2><a name="Activate_Matrix_Object"></a><span class="mw-headline">Activate Matrix Object</span></h2>
<p>To activate a matrix object in the active matrixsheet, the <b>wks.active</b> is available.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create a new matrixbook</span>
newbook mat<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;

<span style="color: #008000;">// Add two more matrix objects to the active matrixsheet</span>
wks.<span style="color: #000080;">addCol</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
wks.<span style="color: #000080;">addCol</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Show image thumbnails</span>
matrix <span style="color: #000080;">-</span>it <span style="color: #0000dd;">1</span>;

<span style="color: #008000;">// Activate the second matrix object</span>
wks.<span style="color: #000080;">active</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;</pre>
<h2><a name="Switch_Between_Image_Mode_and_Data_Mode"></a><span class="mw-headline">Switch Between Image Mode and Data Mode</span></h2>
<p>The <a href="../../LabTalk/LabTalk/Matrix_(command).html" title="LabTalk:Matrix (command)">matrix</a> command has provided the option for switching between image mode and data mode of the matrix object. Only the active matrix object appears in the matrixsheet.
</p>
<pre class="lt" style="font-family:monospace;">matrix <span style="color: #000080;">-</span>ii <span style="color: #0000dd;">1</span>;  <span style="color: #008000;">// Show image mode</span>
matrix <span style="color: #000080;">-</span>ii <span style="color: #0000dd;">0</span>;  <span style="color: #008000;">// Show data mode</span></pre>
<h2><a name="Set_Labels"></a><span class="mw-headline">Set Labels</span></h2>
<p>For each matrix object, you can set Long Name, Comments, and Units, by using <a href="../../LabTalk/LabTalk/Range_Notation.html" title="LabTalk:Range Notation">Range Notation</a>, which is a matrix object.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create a new matrixbook</span>
newbook mat<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;

<span style="color: #008000;">// Set number of matrix object of 1st matrixsheet to be 3</span>
wks.<span style="color: #000080;">nMats</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;

<span style="color: #008000;">// Show image thumbnails</span>
matrix <span style="color: #000080;">-</span>it <span style="color: #0000dd;">1</span>;

<span style="color: #008000;">// Activate 1st matrix object</span>
wks.<span style="color: #000080;">active</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;

<span style="color: #008000;">// Set Long Name, Units, and Comments</span>
range rx <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;  <span style="color: #008000;">// 1st matrix object of the active matrixsheet</span>
rx.<span style="color: #000080;">lname</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> X;  <span style="color: #008000;">// Long Name = X</span>
rx.<span style="color: #000080;">unit</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> cm;  <span style="color: #008000;">// Unit = cm</span>
rx.<span style="color: #000080;">comment</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;X Direction&quot;</span>;  <span style="color: #008000;">// Comment = &quot;X Direction&quot;</span>

<span style="color: #008000;">// Do the same thing for matrix object 2 and 3</span>
wks.<span style="color: #000080;">active</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
range ry <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
ry.<span style="color: #000080;">label</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Y;  <span style="color: #008000;">// Long Name can also be set in this way</span>
ry.<span style="color: #000080;">unit</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> cm;
ry.<span style="color: #000080;">comment</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Y Direction&quot;</span>;
wks.<span style="color: #000080;">active</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;
range rz <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;
rz.<span style="color: #000080;">label</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Z;
rz.<span style="color: #000080;">unit</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Pa;
rz.<span style="color: #000080;">comment</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Pressure;</pre>
<h2><a name="Delete_Matrix_Object"></a><span class="mw-headline">Delete Matrix Object</span></h2>
<p>To delete a matrix object, you can use the <a href="../../LabTalk/LabTalk/Delete_(command).html" title="LabTalk:Delete (command)">delete</a> command.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Delete a matrix object by range</span>
range rs<span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>mbook1<span style="color: #000000;">&#93;</span>msheet1<span style="color: #000080;">!</span><span style="color: #0000dd;">1</span>;  <span style="color: #008000;">// The first matrix object</span>
del rs;
<span style="color: #008000;">// or delete a matrix object by name</span>
range rs<span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>mbook1<span style="color: #000000;">&#93;</span>msheet1<span style="color: #000080;">!</span>Channel2;  <span style="color: #008000;">// The object named Channel2</span>
del rs;</pre>






