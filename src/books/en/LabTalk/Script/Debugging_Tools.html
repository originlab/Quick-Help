<h1 class="firstHeading">2.5.2.2 Debugging Tools</h1><p class='urlname' style='display: none'>Debugging-Tools</p>
<p><span class="OIndex" style="display:none">Debug Script</span>Origin provides various tools to help you to develop and debug your LabTalk scripts.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Code_Builder_.28Origin_feature.29"><span class="tocnumber">1</span> <span class="toctext">Code Builder (Origin feature)</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Ed_.28object.29"><span class="tocnumber">2</span> <span class="toctext">Ed (object)</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Open_the_Code_BuilderOpen_the_Code_Builder"><span class="tocnumber">2.1</span> <span class="toctext">Open the Code Builder<span class="OIndex" style="display:none">Open the Code Builder</span></span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Open_a_Specific_File_in_Code_Builder"><span class="tocnumber">2.2</span> <span class="toctext">Open a Specific File in Code Builder</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Open_a_File_on_a_Pre-Saved_Path"><span class="tocnumber">2.3</span> <span class="toctext">Open a File on a Pre-Saved Path</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#LabTalk_Variables_and_Functions_Dialog"><span class="tocnumber">3</span> <span class="toctext">LabTalk Variables and Functions Dialog</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Echo_.28system_variable.29"><span class="tocnumber">4</span> <span class="toctext">Echo (system variable)</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#.23.21script_.28special_syntax.29"><span class="tocnumber">5</span> <span class="toctext">#!<i>script</i> (special syntax)</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#.7Bscript.7D_.28special_syntax.29"><span class="tocnumber">6</span> <span class="toctext">{<i>script</i>} (special syntax)</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#.40B.28system_variable.29.2C_System.Debug_.28object_property.29"><span class="tocnumber">7</span> <span class="toctext">@B(system variable), System.Debug (object property)</span></a></li>
<li class="toclevel-1 tocsection-11"><a href="#.40OC_.28system_variable.29"><span class="tocnumber">8</span> <span class="toctext">@OC (system variable)</span></a></li>
<li class="toclevel-1 tocsection-12"><a href="#.40V.28system_variable.29.2C_System.Version.28object_property.29"><span class="tocnumber">9</span> <span class="toctext">@V(system variable),  System.Version(object property)</span></a></li>
<li class="toclevel-1 tocsection-13"><a href="#.40VDF_.28system_variable.29"><span class="tocnumber">10</span> <span class="toctext">@VDF (system variable)</span></a></li>
<li class="toclevel-1 tocsection-14"><a href="#VarName.3D_.28command.29"><span class="tocnumber">11</span> <span class="toctext"><i>VarName= (command)</i></span></a></li>
<li class="toclevel-1 tocsection-15"><a href="#LabTalk:List_.28command.29"><span class="tocnumber">12</span> <span class="toctext">LabTalk:List (command)</span></a></li>
<li class="toclevel-1 tocsection-16"><a href="#ErrorProc_.28macro.29"><span class="tocnumber">13</span> <span class="toctext">ErrorProc (macro)</span></a></li>
<li class="toclevel-1 tocsection-17"><a href="#NotReady_.28macro.29"><span class="tocnumber">14</span> <span class="toctext">NotReady (macro)</span></a></li>
<li class="toclevel-1 tocsection-18"><a href="#Type_.3CogsFileName.3E_.28command.29"><span class="tocnumber">15</span> <span class="toctext">Type &lt;ogsFileName&gt; (command)</span></a></li>
<li class="toclevel-1 tocsection-19"><a href="#Log_to_a_File"><span class="tocnumber">16</span> <span class="toctext">Log to a File</span></a></li>
</ul>
</div>

<h2><a name="Code_Builder_.28Origin_feature.29"></a><span class="mw-headline">Code Builder (Origin feature)</span></h2>
<p><b><span class="OIndex">Code Builder</span></b> is Origin's integrated development environment to debug LabTalk scripts, Origin C code, X-Function code and fitting functions coded in Origin C. In Code Builder, use various convenient debugging tools like setting up break points, step-by-step execution and inspection of variable values. Code Builder can be opened by the <a href="#Ed_.28object.29">ed.open()</a> method. 
</p><p>To learn how to use the Code Builder, see the <b>Code Builder User's Guide</b> in the Programming help file.
</p><p>Here is an example showing how to debug LabTalk script in Code Builder.
</p>
<ol>
<li>Open an OGS file by running the following script.</li>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Open an ogs file in Code Builder</span>
file<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\LabTalk Script Examples\ave_traces.ogs&quot;</span>;
ed.<span style="color: #000080;">open</span><span style="color: #000000;">&#40;</span><span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>file<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;</pre>
<li>Set a break point on line 22 in the open file, by clicking on the margin to the left of this line:</li>
<pre class="lt" style="font-family:monospace;">fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Data Manipulation\not_monotonic_multicurve.dat&quot;</span>;</pre>
<p>The break point will look like this:
</p><p><a  class="image"><img alt="LT Debugging Break Point.png" src="../images/Debugging_Tools/LT_Debugging_Break_Point.png?v=27111" width="685"  /></a>
</p>
<li>Place the cursor on line 12 - the <b>[Main]</b> section - then select menu <b>Debug: Execute Current Section</b>. The <b>[Main]</b> section code will run and stop at the line with the break point.</li>
<p><a  class="image"><img alt="LT Debugging Break Point Stop.png" src="../images/Debugging_Tools/LT_Debugging_Break_Point_Stop.png?v=27112" width="692"  /></a>
</p>
<li>Now press F10 to execute the remaining script line by line. Code Builder provides the <b>Watch</b> window to view the value of a variable during debugging. For example, after pressing F10 once, open the <b>Watch</b> window by menu item <b>View: Watch</b> if it is not opened yet. Then type <i>fname$</i> in the left cell of the table in this window, the value will show in the right cell of the same row.</li>
<p><a  class="image"><img alt="LT Debugging Watch.png" src="../images/Debugging_Tools/LT_Debugging_Watch.png?v=27113" width="537"  /></a>
</p>
<li>To execute the remaining script, press F5. It will complete unless encountering another break point.</li>
</ol>
<h2><a name="Ed_.28object.29"></a><span class="mw-headline"><a href="../../LabTalk/LabTalk/Ed_(object).html" title="LabTalk:Ed (object)">Ed (object)</a></span></h2>
<p>The <a href="../../LabTalk/LabTalk/Ed_(object).html" title="LabTalk:Ed (object)"><b>Ed</b> (object)</a> provides <span class="OIndex">script access  to Code Builder</span><span class="OIndex HasShownIndex" style="display:none">Ed Object</span><span class="OIndex" style="display:none">Code Builder, script access</span>, a dedicated editor for LabTalk script and Origin C code.  
</p><p>The <b>ed</b> object methods are:
</p>
<table class="simple">
<tr>
<th> Method
</th>
<th> Brief Description
</th></tr>
<tr>
<td> ed.open()
</td>
<td> Open the Code Builder window.
</td></tr>
<tr>
<td> ed.open(fileName)
</td>
<td> Open the specified file in the Code Builder window.
</td></tr>
<tr>
<td> ed.open(fileName, sectionName)
</td>
<td> Open the specified OGS file at the specified section in the Code Builder window. (Defaults to file beginning if section not found.)
</td></tr></table>
<h3><a name="Open_the_Code_BuilderOpen_the_Code_Builder"></a><span class="mw-headline">Open the Code Builder<span class="OIndex" style="display:none">Open the Code Builder</span></span></h3>
<pre class="lt" style="font-family:monospace;">ed.<span style="color: #000080;">open</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span></pre>
<h3><a name="Open_a_Specific_File_in_Code_Builder"></a><span class="mw-headline">Open a Specific File in Code Builder</span></h3>
<p>The following command opens the file <b>myscript.ogs</b>  
</p>
<pre class="lt" style="font-family:monospace;">ed.<span style="color: #000080;">open</span><span style="color: #000000;">&#40;</span>E<span style="color: #000000;">:</span>\myfolder\myscript.<span style="color: #000080;">ogs</span><span style="color: #000000;">&#41;</span></pre>
<h3><a name="Open_a_File_on_a_Pre-Saved_Path"></a><span class="mw-headline">Open a File on a Pre-Saved Path</span></h3>
<p><span class="OIndex" style="display:none">Open a File</span>
Use the <a href="../../LabTalk/Script/From_Files.html#Setting_the_Path" title="Script:From Files"><b>cd</b></a> X-Function to first switch to the particular folder:
</p>
<pre class="lt" style="font-family:monospace;">cd <span style="color: #0000dd;">2</span>;
ed.<span style="color: #000080;">open</span><span style="color: #000000;">&#40;</span>autofit.<span style="color: #000080;">ogs</span><span style="color: #000000;">&#41;</span>;</pre>
<h2><a name="LabTalk_Variables_and_Functions_Dialog"></a><span class="mw-headline"><a href="../../LabTalk/LabTalk/Edit_(command).html" title="LabTalk:Edit (command)">LabTalk Variables and Functions Dialog</a></span></h2>
<p><span class="OIndex" style="display:none">LabTalk Variables Dialog</span><span class="OIndex" style="display:none">Ed Command</span><span class="OIndex" style="display:none">list command</span><span class="OIndex" style="display:none">variables viewer</span><span class="OIndex" style="display:none">functions viewer</span>
</p><p>The <a href="../../LabTalk/LabTalk/List_(command).html" title="LabTalk:List (command)"><b>list</b> command with no options</a> as well as the <a href="../../LabTalk/LabTalk/Edit_(command).html" title="LabTalk:Edit (command)"><b>ed</b> command</a> (different than the <a href="#Ed_.28object.29"><b>ed</b> object</a>) opens the LabTalk Variables dialog, which is a table of  attributes for all variables in the current project.  The attributes are variable name, value, type, subtype, property, plot information, and description.
</p><p>This is a useful tool for script programmers as the current values and properties of variables can be viewed in real time.  Additionally, variables can be sorted by any of their attributes, alphabetically in the case of text descriptors, numerically in the case of numeric values.  
</p><p>Check boxes exist on the right-hand side of the dialog that allow you to see any subset of the entire variable list.
</p><p><a  class="image"><img alt="ListEdDialog VariableFunctionViewer.png" src="../images/Debugging_Tools/ListEdDialog_VariableFunctionViewer.png?v=0" width="570"  /></a>
<br />
<br />
</p>
<h2><a name="Echo_.28system_variable.29"></a><span class="mw-headline">Echo (system variable)</span></h2>
<p>To debug and trace, this system variable, <b><a href="../../LabTalk/LabTalk/System_Variables.html#ECHO" title="LabTalk:System Variables"><span class="OIndex">Echo</span></a></b> prints scripts or error messages to the Command window (or Script window when entered there). To enable echo, type:
</p><p><b>echo = <i>Number</i></b>
</p><p>in the Script window (where <i>Number</i> is one of the following): 
</p>
<table class="simple">
<tr>
<th> Number
</th>
<th> Description
</th></tr>
<tr>
<td> 1
</td>
<td> Display commands that generate an error;
</td></tr>
<tr>
<td> 2
</td>
<td> Display scripts that have been sent to the queue for delayed execution;
</td></tr>
<tr>
<td> 4
</td>
<td> Display scripts that involve commands;
</td></tr>
<tr>
<td> 8
</td>
<td> Display scripts that involve assignments;
</td></tr>
<tr>
<td> 16
</td>
<td> Display macros.
</td></tr></table>
<p>These values are bits that can be combined to produce cumulative effects.  For example, echo = 12 displays both command and assignment scripts.  Echo = 7 (includes echo = 1, echo = 2, and echo = 4) is useful for following script execution during menu command selection.  To disable echo, type echo = 0 in the Script window
</p>
<h2><a name=".23.21script_.28special_syntax.29"></a><span class="mw-headline">#!<i>script</i> (special syntax)</span></h2>
<p><span class="OIndex">Embed debugging statement</span>s in your script using this notation. The # character tells the LabTalk interpreter to ignore the text until the end of the line. However, when followed by the&#160;! character, the script is executed if the <a href="../../LabTalk/LabTalk/System_Variables.html#Other_System_Control" title="LabTalk:System Variables">@B system variable</a> (or <a href="../../LabTalk/LabTalk/System_(object).html" title="LabTalk:System (object)">System.Debug</a> object property) is set to 1. The following example illustrates this option:
</p>
<pre class="lt" style="font-family:monospace;">@B <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
range rr <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>Book1<span style="color: #000000;">&#93;</span>Sheet1<span style="color: #000080;">!</span>col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// Range to column A</span>
for <span style="color: #000000;">&#40;</span>ii<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>; ii<span style="color: #000080;">&lt;=</span><span style="color: #0000dd;">10</span>; ii<span style="color: #000080;">+</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span>
  #<span style="color: #000080;">!</span>ii<span style="color: #000080;">=</span>; rr<span style="color: #000000;">&#91;</span>ii<span style="color: #000000;">&#93;</span><span style="color: #000080;">=</span>;  <span style="color: #008000;">// Embedded debugging script</span>
  rr<span style="color: #000000;">&#91;</span>ii<span style="color: #000000;">&#93;</span><span style="color: #000080;">+</span><span style="color: #000080;">=</span>ii<span style="color: #000080;">*</span><span style="color: #0000dd;">10</span>;
<span style="color: #000000;">&#125;</span>
@B <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
#<span style="color: #000080;">!</span>type <span style="color: #000080;">-</span>a This line will not execute</pre>
<p>The script sets @B equal to 1 to allow #! lines to execute.
By setting @B to 0 , the last line will not execute.
</p>
<h2><a name=".7Bscript.7D_.28special_syntax.29"></a><span class="mw-headline">{<i>script</i>} (special syntax)</span></h2>
<p>An error in your LabTalk code will cause the code to stop at the point of the error and not execute any statements after the error. In cases where you would like the script to continue executing in such cases, you can use curly braces to define where error handling should begin and resume. For instance, in the following script, 
</p>
<pre class="lt" style="font-family:monospace;">type Start;
impasc fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>BadFileName;
type End;</pre>
<p>the word <b>Start</b> will print to the Script Window, but if <b>BadFileName</b> cannot be found, the script will stop executing at that point, and the word <b>End</b> will not print.
</p><p>If, however, you surround the line in question with curly braces (i.e., {}), as in,
</p>
<pre class="lt" style="font-family:monospace;">type Start;
<span style="color: #000000;">&#123;</span>
   impasc fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>BadFileName;
<span style="color: #000000;">&#125;</span>
type End;</pre>
<p>then <b>End</b> will print whether or not <b>BadFileName</b> is properly imported.
</p><p>You can catch this condition with a variable:
</p>
<pre class="lt" style="font-family:monospace;">@LT <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>; <span style="color: #008000;">// use in 2017 SR2 and later, remove this line for earlier versions</span>
flag <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
<span style="color: #000000;">&#123;</span>
   impasc fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>MyFile;
   flag <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
<span style="color: #000000;">&#125;</span>
if<span style="color: #000000;">&#40;</span>flag<span style="color: #000000;">&#41;</span>
   type Error ocurred;
else
   type OK;</pre>
<p>A similar situation occurs when a section in an OGS file fails. Code will silently return to the calling context. Use the above variable method to identify that code failed. In this case, the brackets are not needed:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">&#91;</span>Called Section<span style="color: #000000;">&#93;</span>
flag <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
BadCommand; <span style="color: #008000;">// This line errors and silently returns</span>
flag <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;  <span style="color: #008000;">// flag (which must be global variable) is 1, then above code failed.</span></pre>
<h2><a name=".40B.28system_variable.29.2C_System.Debug_.28object_property.29"></a><span class="mw-headline"><a href="../../LabTalk/LabTalk/System_Variables.html#Other_System_Control" title="LabTalk:System Variables">@B(system variable)</a>, <a href="../../LabTalk/LabTalk/System_(object).html" title="LabTalk:System (object)">System.Debug (object property)</a></span></h2>
<p>@B system variable controls the Debug mode to execute the LabTalk statements that begin with <b>#!</b>&#160;:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #0000dd;">1</span> <span style="color: #000080;">=</span> enable
<span style="color: #0000dd;">0</span> <span style="color: #000080;">=</span> disable</pre>
<p>It is equivalent to the <b><a href="../../LabTalk/LabTalk/System_(object).html" title="LabTalk:System (object)">System.Debug</a></b> object property.
</p>
<h2><a name=".40OC_.28system_variable.29"></a><span class="mw-headline"><a href="../../LabTalk/LabTalk/System_Variables.html#MISC." title="LabTalk:System Variables">@OC (system variable)</a></span></h2>
<p>@OC system variable controls whether or not you can call Origin C functions from LabTalk.  
</p>
<table class="simple">
<tr>
<th> Value
</th>
<th> Description
</th></tr>
<tr>
<td> @OC = 1 (default)
</td>
<td> Origin C functions <b>CAN</b> be called
</td></tr>
<tr>
<td> @OC = 0
</td>
<td> Origin C functions <b>CANNOT</b> be called
</td></tr></table>
<h2><a name=".40V.28system_variable.29.2C_System.Version.28object_property.29"></a><span class="mw-headline"><a href="../../LabTalk/LabTalk/System_Variables.html#SYSTEM_CONTROL" title="LabTalk:System Variables">@V(system variable)</a>,  <a href="../../LabTalk/LabTalk/System_(object).html" title="LabTalk:System (object)">System.Version(object property)</a></span></h2>
<p>@V indicates the Origin version number. @V and System.Version object property are equivalent.
</p>
<h2><a name=".40VDF_.28system_variable.29"></a><span class="mw-headline"><a href="../../LabTalk/LabTalk/System_Variables.html#MISC." title="LabTalk:System Variables">@VDF (system variable)</a></span></h2>
<p>If you set @VDF = 1, when you open a project file (.OPJ), Origin will report the Origin version in which the file was saved.
</p>
<h2><a name="VarName.3D_.28command.29"></a><span class="mw-headline"><i>VarName= (command)</i></span></h2>
<p>This command examines the value of any variable. Embed this in your script to display intermediate variable values in the Script window during script execution.
</p><p><b>Example 1</b>
</p><p>The following command prints out the value of myHight variable:
</p>
<pre class="lt" style="font-family:monospace;">myHight<span style="color: #000080;">=</span></pre>
<h2><a name="LabTalk:List_.28command.29"></a><span class="mw-headline"><a href="../../LabTalk/LabTalk/List_(command).html" title="LabTalk:List (command)">LabTalk:List (command)</a></span></h2>
<p>The list command is used to examine your system environment. For example, the list s command displays all datasets (including temporary datasets) in the project.
</p>
<h2><a name="ErrorProc_.28macro.29"></a><span class="mw-headline"><a href="../../LabTalk/LabTalk/ErrorProc_(macro).html" title="LabTalk:ErrorProc (macro)">ErrorProc (macro)</a></span></h2>
<p>The ErrorProc macro is useful for error trapping.
</p><p>The ErrorProc macro is triggered ...
</p>
<ul><li> when the LabTalk interpreter detects a #Command Error.</li>
<li> when you click the Cancel button in any dialog box.</li>
<li> when you click the No button in dialog boxes that do not have a Cancel button.  </li></ul>
<p>The ErrorProc macro is deleted immediately after it is triggered and executed.
</p>
<h2><a name="NotReady_.28macro.29"></a><span class="mw-headline"><a href="../../LabTalk/LabTalk/NotReady_(macro).html" title="LabTalk:NotReady (macro)">NotReady (macro)</a></span></h2>
<p>This macro displays the message "This operation is still under development..." in a dialog box with an OK button.
</p>
<h2><a name="Type_.3CogsFileName.3E_.28command.29"></a><span class="mw-headline"><a href="../../LabTalk/LabTalk/Type_(command).html" title="LabTalk:Type (command)">Type &lt;ogsFileName&gt; (command)</a></span></h2>
<p>This variant of the <i>type</i> command prints out the contents of a specified script file (.OGS) in the current directory to the Command (or Script) window. Note that the file extension .OGS in ogsFileName may be omitted. The file name cannot include a path and must be in the working directory. 
</p><p>Examples:
</p><p>The following script prints the contents of D: \temp\mytemp1.ogs and C:\myogs\hello.ogs.
</p>
<pre class="lt" style="font-family:monospace;">cd D<span style="color: #000000;">:</span>\Temp;
type mytemp1.<span style="color: #000080;">ogs</span>; <span style="color: #008000;">// Extension included</span>
cd C<span style="color: #000000;">:</span>\temp;
type hello; <span style="color: #008000;">// Extension omitted</span></pre>
<h2><a name="Log_to_a_File"></a><span class="mw-headline">Log to a File</span></h2>
<p>To output the log information to a file, the <a href="../../LabTalk/LabTalk/Type_(command).html" title="LabTalk:Type (command)">type</a> command is available. <a href="../../LabTalk/LabTalk/Type_(command).html#-gb.3B_Type_text_to_a_file" title="LabTalk:Type (command)">type -gb</a> will specify the log file to output to, and begin the output routine. Then <a href="../../LabTalk/LabTalk/Type_(command).html#-ge.3B_End_typing_text_to_file" title="LabTalk:Type (command)">type -ge</a> will end the routine and stop logging to the file. For example:
</p>
<pre class="lt" style="font-family:monospace;">type <span style="color: #000080;">-</span>gb <span style="color: #000080;">%</span>Ylog.<span style="color: #000080;">txt</span>;  <span style="color: #008000;">// Start typing text to a file, log.txt, if not exist, create it</span>
type aa;  <span style="color: #008000;">// Write aa</span>
type bb;  <span style="color: #008000;">// Write bb</span>
type cc;  <span style="color: #008000;">// Write cc</span>
type <span style="color: #000080;">-</span>ge;  <span style="color: #008000;">// End writing</span></pre>
<p>This can be particularly useful when your script is creating a large volume of output to the Script Window since it has only a 30000 byte buffer.
</p>





