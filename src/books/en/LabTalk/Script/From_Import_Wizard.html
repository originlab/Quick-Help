<h1 class="firstHeading">2.5.1.8 From Import Wizard</h1><p class='urlname' style='display: none'>From-Import-Wizard</p>
<p><span class="OIndex" style="display:none">Run Script from Import Wizard</span><span class="OIndex" style="display:none">script, import wizard/filter</span>The <span class="OIndex">Import Wizard</span> can be used to import ASCII, Binary or custom file formats (when using a custom program written in Origin C). The Wizard can save a filter in select locations and can include script that runs after the import occurs. Once created, the filter can be used to import data and automatically execute script. This same functionality applies when you drag a file from Explorer and drop onto Origin if <b>Filter Manager</b> has support for the file type.
</p><p>For example,
</p>
<ol>
<li> Start the Import Wizard.</li>
<li> Browse to the Origin Samples\Spectroscopy folder and choose <b>Peaks with Base.DAT</b>.</li>
<li> Click Add, then click OK.</li>
<li> Click Next six times to get to the <i>Save Filters</i> page.</li>
<li> Check <b>Save Filter</b> checkbox.</li>
<li> Enter an appropriate Filter file name, such as <b>Subtract Base and Find Peaks</b>.</li>
<li> Check <b>Specify advanced filter options</b> checkbox.</li>
<li> Click Next.</li>
<li> Paste the following into the text box:</li>
<pre class="lt" style="font-family:monospace;">range raTime <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;              <span style="color: #008000;">// Get the Time column as a range</span>
range raAmp <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;               <span style="color: #008000;">// Get the Amp column as a range</span>
range raBase <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;              <span style="color: #008000;">// Get the Base column as a range</span>
page.<span style="color: #000080;">xlcolname</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;            <span style="color: #008000;">// Turn off Spreadsheet Cell Notation firstly</span>
wks.<span style="color: #000080;">addcol</span><span style="color: #000000;">&#40;</span>Subtracted<span style="color: #000000;">&#41;</span>;        <span style="color: #008000;">// Create a column called Subtracted</span>
range raSubtracted <span style="color: #000080;">=</span> <span style="color: #0000dd;">4</span>;        <span style="color: #008000;">// Get the Subtracted column as a range</span>
raSubtracted <span style="color: #000080;">=</span> raAmp <span style="color: #000080;">-</span> raBase; <span style="color: #008000;">// Subtract Base from Amp</span>
pkFind iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span>;              <span style="color: #008000;">// Find peaks in the Subtracted data</span>
range raPeaks <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>;             <span style="color: #008000;">// Get the peak index column as a range</span>
for<span style="color: #000000;">&#40;</span> idx <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; idx <span style="color: #000080;">&lt;=</span> raPeaks.<span style="color: #000080;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>&#160;; idx<span style="color: #000080;">++</span> <span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    pkidx <span style="color: #000080;">=</span> raPeaks<span style="color: #000000;">&#91;</span>idx<span style="color: #000000;">&#93;</span>;
    ty Peak found at <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>raTime<span style="color: #000000;">&#91;</span>pkidx<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span> with height of <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>raSubtracted<span style="color: #000000;">&#91;</span>pkidx<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/From_Import_Wizard/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>For the <a class="external text" href="../../UserGuide/UserGuide/Column_Short_Name_Restriction.html">Spreadsheet Cell Notation</a> in the workbook, please see <a class="external text" href="../../QuickHelp/QuickHelp/Turn_off_spreadsheet_cell_notation.html"><b>FAQ-849</b></a> for more information.
</p></td></tr></table>
</li>
<li>Click Finish.</li>
</ol>
<p><br />
<br />
This is what happens:
</p>
<ul><li> The filter is saved.</li>
<li> The import runs using this filter.</li>
<li> After the import, the script runs which creates the subtracted data and the <b><a class="external text" href="../../XFunction/X-Function/PkFind.html">pkFind</a></b> function locates peak indices. Results are typed to the Script Window.</li></ul>


