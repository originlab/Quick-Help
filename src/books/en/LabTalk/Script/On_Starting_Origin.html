<h1 class="firstHeading">2.5.1.13 On Starting or Exiting Origin</h1><p class='urlname' style='display: none'>On-Starting-Origin</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Defining_Global_Constants.2C_Variables_and_Functions"><span class="tocnumber">1</span> <span class="toctext">Defining Global Constants, Variables and Functions</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Defining_global_constants_and_variables"><span class="tocnumber">1.1</span> <span class="toctext">Defining global constants and variables</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Defining_a_global_function"><span class="tocnumber">1.2</span> <span class="toctext">Defining a global function</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4"><a href="#Using_OEvents.ogs_to_Trigger_Events"><span class="tocnumber">2</span> <span class="toctext">Using OEvents.ogs to Trigger Events</span></a></li>
</ul>
</div>

<h3><a name="Defining_Global_Constants.2C_Variables_and_Functions"></a><span class="mw-headline">Defining Global Constants, Variables and Functions</span></h3>
<p>Use the <b>[Startup]</b> section of the Origin.ini to define global constants, variables and functions for use any time you run Origin. 
</p><p>See these topics for more information on scope:
</p>
<ul><li> <a href="../../LabTalk/LabTalk/Data_Types_and_Variables.html#Scope_of_Variables" title="LabTalk:Data Types and Variables">Scope of Variables</a></li>
<li> <a href="../../LabTalk/LabTalk/Functions.html#Scope_of_Functionsscope_of_a_function" title="LabTalk:Functions">Scope of Functions</a></li></ul>
<h4><a name="Defining_global_constants_and_variables"></a><span class="mw-headline">Defining global constants and variables</span></h4>
<p>See FAQ-286 for information on <a class="external text" href="../../QuickHelp/QuickHelp/How_do_I_define_global_constants.html#Constants_and_Variables_for_use_across_Origin_sessions">defining constants and variables for use across Origin sessions</a>.
</p>
<h4><a name="Defining_a_global_function"></a><span class="mw-headline">Defining a global function</span></h4>
<ol>
<li>If Origin is running, exit the program.</li>
<li>Start a fresh page in a text editor (e.g. Notepad) and enter the following information:</li>
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">&#91;</span>Main<span style="color: #000000;">&#93;</span>
@global <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
<span style="color: #008000;">// This function calculates the cube root of a number</span>
function double dCubeRoot<span style="color: #000000;">&#40;</span>double dVal<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    double xVal;
    if<span style="color: #000000;">&#40;</span>dVal<span style="color: #000080;">&lt;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span> xVal <span style="color: #000080;">=</span> <span style="color: #000080;">-</span>exp<span style="color: #000000;">&#40;</span>ln<span style="color: #000000;">&#40;</span><span style="color: #000080;">-</span>dVal<span style="color: #000000;">&#41;</span><span style="color: #000080;">/</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>;
    else xVal <span style="color: #000080;">=</span> exp<span style="color: #000000;">&#40;</span>ln<span style="color: #000000;">&#40;</span>dVal<span style="color: #000000;">&#41;</span><span style="color: #000080;">/</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>;
    return xVal;
<span style="color: #000000;">&#125;</span>
@global <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;</pre>
<li>Name and save the file to your <a class="external text" href="../../QuickHelp/QuickHelp/What_is_the_User_Files_Folder.html">the <b>User Files Folder</b> (<b>UFF</b>)</a>, using an .OGS file extension (e.g. myLTFuncs.ogs).
<li>Browse to your Origin.ini file in your UFF and open this file in your text editor.</li>
<li>Locate the <b>[Startup]</b> section of the file and add the name of the .OGS file you just created using the following form:
<pre class="lt" style="font-family:monospace;">FileN<span style="color: #000080;">=</span>myLTFuncs.<span style="color: #000080;">ogs</span></pre>
<p>... where <i>N</i> is 1,2,3,etc.
</p>
<li> Save your changes to Origin.ini.</li>
<li>To check the availability of your function, run Origin, open the Script Window and enter the name of the function, followed by a value in parentheses and "=", then press ENTER.
<pre class="lt" style="font-family:monospace;">dCubeRoot<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">8</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span></pre>
<p>Origin returns:
</p>
<pre class="lt" style="font-family:monospace;">dCubeRoot<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">8</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span></pre>
</ol>
<p>See this topic for more information on the <a href="../../LabTalk/LabTalk/Functions.html#Scope_of_Functionsscope_of_a_function" title="LabTalk:Functions">Scope of Functions</a>.
</p>
<h3><a name="Using_OEvents.ogs_to_Trigger_Events"></a><span class="mw-headline">Using OEvents.ogs to Trigger Events</span></h3>
<p>When the Origin application is launched, there are multiple events that are triggered. Your LabTalk script can be set to execute with each event using the <i>OEvents.OGS</i> file. This <i>OEvents.OGS</i> file includes several sections that indicate when to run the script,  such as, <b><i>[AfterCompileSystem]</i></b>, <b><i>[BeforeOpenDoc]</i></b>, and <b><i>[OnExitOrigin]</i></b>.
</p><p>The following example demonstrates cleaning the history panel of Command Window on existing Origin.<br /> 
(Note that Origin C functions can not be run in the <b><i>[OnExitOrigin]</i></b> section. If you want to trigger events on exiting Origin, always use LabTalk commands.)
</p>
<ol>
<li> Copy the <i>OEvents.OGS</i> file from the Origin EXE folder to your User Files Folder.  Alternatively, when opening the file from the EXE folder just make sure to then save it to your User Files Folder.</li>
<li> In the section named <b><i>[OnExitOrigin]</i></b>, add the following  script:
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Delete the files, which keep the history of command window, from the User File folder</span>
del <span style="color: #000080;">-</span>f <span style="color: #ff00ff;">&quot;%YUpDown_Buffer.txt&quot;</span>;
del <span style="color: #000080;">-</span>f <span style="color: #ff00ff;">&quot;%YLTHistory.txt&quot;</span>;</pre>
</li>
<li>
To run sections in <i>OEvents.OGS</i>, you also need to edit the <i>Origin.ini</i> file in your User Files Folder. Close Origin if running, and then edit your <i>Origin.ini</i> and uncomment (remove the ";") in the line under the <i><b>[Config]</b></i> section, so that it is as below:

<pre class="ini" style="font-family:monospace;"><span style="color: #000099;">Ogs1</span> <span style="color: #000066; font-weight:bold;">=</span><span style="color: #660066;"> OEvents</span>
<span style="color: #666666; font-style: italic;">; Ogs2 = OEvents</span>
<span style="color: #666666; font-style: italic;">; Origin can trigger multiple system events</span>
<span style="color: #666666; font-style: italic;">; Uncomment this line and implement event handlers in OEvents.ogs</span></pre>
<table class="note">

<tr>
<td><b>Note:</b> More than one event handler file may exist in <i>Origin.ini</i> and the name is not restricted to OEvents.OGS.
</td></tr></table>
</li>
<li> Close Origin and restart a new Origin session to check whether the history panel of <b>Command Window</b> is clean.
</li>
</ol>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/On_Starting_Origin/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>Origin C functions can be run from other sections of <i>OEvents.OGS</i> such as <b><i>[BeforeOpenDoc]</i></b>. <a class="external text" href="../../OriginC/OCGuide/Compiling,_Linking_and_Loading.html#Build_Individual_Source_File_on_Origin_Startup">View the <b>Compiling, Linking and Loading</b> page in <b>Origin C Programming Guide</b> for an example</a>. 
</p><p>Please note that If you need to call Origin C functions from your custom script associated with events, you need to ensure that the Origin C file is compiled and the functions are available for script access. See <a class="external text" href="../../LabTalk/LabTalk/Loading_and_Compiling_Origin_C_Function.html">Loading and Compiling Origin C Functions</a> for details.
</p></td></tr></table>


