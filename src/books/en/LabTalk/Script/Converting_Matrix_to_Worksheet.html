<h1 class="firstHeading">2.8.3.3 Converting Matrix to Worksheet</h1><p>You may need to re-organize your data by converting from matrix to worksheet, or vice versa, for certain analysis or graphing needs. This page provides information and examples of converting matrix to worksheet, and please refer to <a href="../../LabTalk/Script/Converting_Worksheet_to_Matrix.html" title="Script:Converting Worksheet to Matrix">Converting Worksheet to Matrix</a> for the "vice versa" case.
</p>
<h2><a name="Matrix_to_Worksheet"></a><span class="mw-headline">Matrix to Worksheet</span></h2>
<p>Data in a matrix can also be converted to a worksheet by using the <a class="external text" href="../../XFunction/X-Function/M2w.html">m2w</a> X-Function. This X-Function can directly convert data into worksheet, with or without X/Y mapping, or convert data by rearranging the values into XYZ columns in the worksheet.
</p><p>The following example shows how to convert matrix into worksheet, and plot graphs using different methods according the form of the worksheet data.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create a new matrixbook</span>
win <span style="color: #000080;">-</span>t matrix;
<span style="color: #008000;">// Set matrix dimension and X/Y values</span>
mdim cols<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">21</span> rows<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">21</span> x1<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> x2<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">10</span> y1<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> y2<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">100</span>;
<span style="color: #008000;">// Show matrix X/Y values</span>
page.<span style="color: #000080;">cntrl</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
<span style="color: #008000;">// Set matrix Z values</span>
msetvalue formula<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;nlf_Gauss2D(x, y, 0, 1, 5, 2, 50, 20)&quot;</span>;
<span style="color: #008000;">// Hold the matrix window name</span>
<span style="color: #000080;">%</span>P <span style="color: #000080;">=</span> <span style="color: #000080;">%</span>H;
<span style="color: #008000;">// Covert matrix to worksheet by Dierct method</span>
m2w ycol<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> xlabel<span style="color: #000000;">:</span><span style="color: #000080;">=</span>row1;
<span style="color: #008000;">// Plot graph from worksheet using Virtual Matrix</span>
plotvm irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span> format<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> ztitle<span style="color: #000000;">:</span><span style="color: #000080;">=</span>MyGraph type<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">242</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>new template<span style="color: #000000;">:</span><span style="color: #000080;">=</span>cmap<span style="color: #000080;">&gt;</span>;
<span style="color: #008000;">// Convert matrix to XYZ worksheet data</span>
sec <span style="color: #000080;">-</span>p <span style="color: #0000dd;">2</span>;
win <span style="color: #000080;">-</span>a <span style="color: #000080;">%</span>P;
m2w im<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000080;">!</span><span style="color: #0000dd;">1</span> method<span style="color: #000000;">:</span><span style="color: #000080;">=</span>xyz;
<span style="color: #008000;">// Plot a 3D Scatter</span>
worksheet <span style="color: #000080;">-</span>s <span style="color: #0000dd;">3</span>;
worksheet <span style="color: #000080;">-</span>p <span style="color: #0000dd;">240</span> 3D;</pre>
<p>If the matrix data is converted directly to worksheet cells, you can then plot such worksheet data using the <a href="../../LabTalk/Script/Virtual_Matrix.html" title="Script:Virtual Matrix">Virtual Matrix</a> feature.
</p>





