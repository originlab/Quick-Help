<h1 class="firstHeading">2.13.1.1 Average Multiple Curves</h1><p class='urlname' style='display: none'>Average-Curves</p>
<p><span class="OIndex" style="display:none">Average Curves</span>Multiple curves (XY data pairs) can be averaged to create a single curve, using the <b><a class="external text" href="../../XFunction/X-Function/Avecurves.html">avecurves</a></b> X-Function. This X-Function provides several options such as using the input X values for the output curve, or generating uniformly spaced X values for the output and then interpolating the input Y data before averaging.
</p><p>The following example demonstrates averaging with linear interpolation:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Load sample data using existing 'loadDSC.ogs' script</span>
string fpath<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Samples\LabTalk Script Examples\LoadDSC.ogs&quot;</span>;
string LoadPath<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> fpath<span style="color: #000080;">$</span>;
<span style="color: #008000;">// If the data does not load properly, then stop script execution. </span>
if<span style="color: #000000;">&#40;</span><span style="color: #000080;">!</span>run.<span style="color: #000080;">section</span><span style="color: #000000;">&#40;</span><span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>LoadPath<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>, Main, <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span> break <span style="color: #0000dd;">1</span>;
<span style="color: #008000;">// Data should now be loaded now into the active workbook ...</span>
<span style="color: #008000;">// Get the name of the active workbook,&#160;%H points to the active workbook</span>
string dscBook<span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #000080;">%</span>H;  

<span style="color: #008000;">// Perform average on all data using linear interpolation</span>
avecurves iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>dscBook<span style="color: #000080;">$</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span>end<span style="color: #000000;">&#41;</span><span style="color: #000080;">!</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> 
          rd<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span><span style="color: #000080;">&lt;</span>input<span style="color: #000080;">&gt;</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">&lt;</span>new name<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Averaged Data&quot;</span><span style="color: #000080;">&gt;</span><span style="color: #000080;">!</span> 
          method<span style="color: #000000;">:</span><span style="color: #000080;">=</span>ave 
          interp<span style="color: #000000;">:</span><span style="color: #000080;">=</span>linear;</pre>
<p>Once averaged, the data and the result can be plotted:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// plot all the data and the averaged curve, using the plotxy X-Function:</span>
plotxy <span style="color: #000000;">&#91;</span>dscBook<span style="color: #000080;">$</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span>end<span style="color: #000000;">&#41;</span><span style="color: #000080;">!</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">200</span>;</pre>






