<h1 class="firstHeading">2.10.1 Importing Data</h1><p class='urlname' style='display: none'>Importing-Data</p>
<p><span class="OIndex" style="display:none">Import Data</span><span class="OIndex" style="display:none">Data Import</span>The following examples demonstrate importing of data from external files.  The examples import ASCII files, but the scripts can be adjusted for filetype (e.g. MATLAB). Syntax and supporting commands will be the same.  Since these examples import Origin sample files, they can be typed or pasted directly into the Script or Command window and run.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Import_an_ASCII_Data_File_Into_a_Worksheet_or_Matrix"><span class="tocnumber">1</span> <span class="toctext">Import an ASCII Data File Into a Worksheet or Matrix</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Data_Connector_Methods"><span class="tocnumber">1.1</span> <span class="toctext">Data Connector Methods</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#X-Function_Methods"><span class="tocnumber">1.2</span> <span class="toctext">X-Function Methods</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4"><a href="#Import_ASCII_Data_with_Options_Specified"><span class="tocnumber">2</span> <span class="toctext">Import ASCII Data with Options Specified</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Import_Multiple_Data_Files"><span class="tocnumber">3</span> <span class="toctext">Import Multiple Data Files</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#Data_Connector_Methods_2"><span class="tocnumber">3.1</span> <span class="toctext">Data Connector Methods</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#X-Function_Methods_2"><span class="tocnumber">3.2</span> <span class="toctext">X-Function Methods</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8"><a href="#Import_an_ASCII_File_to_Worksheet_and_Convert_to_Matrix"><span class="tocnumber">4</span> <span class="toctext">Import an ASCII File to Worksheet and Convert to Matrix</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Related:_the_Open_Command"><span class="tocnumber">5</span> <span class="toctext">Related: the Open Command</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#Import_with_Themes_and_Filters"><span class="tocnumber">6</span> <span class="toctext">Import with Themes and Filters</span></a>
<ul>
<li class="toclevel-2 tocsection-11"><a href="#Import_with_a_Theme"><span class="tocnumber">6.1</span> <span class="toctext">Import with a Theme</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Import_with_an_Import_Wizard_Filter_File"><span class="tocnumber">6.2</span> <span class="toctext">Import with an Import Wizard Filter File</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-13"><a href="#Import_from_a_Database"><span class="tocnumber">7</span> <span class="toctext">Import from a Database</span></a></li>
</ul>
</div>

<h2><a name="Import_an_ASCII_Data_File_Into_a_Worksheet_or_Matrix"></a><span class="mw-headline">Import an ASCII Data File Into a Worksheet or Matrix</span></h2>
<h3><a name="Data_Connector_Methods"></a><span class="mw-headline">Data Connector Methods</span></h3>
<p>This is a simple example of single file import using a <a class="external text" href="../../UserGuide/Category/Data_Connector.html">Data Connector</a>.
</p>
<pre class="lt" style="font-family:monospace;">string path<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Import and Export\ASCII CSV with Quotes.csv&quot;</span>;
newbook;
wbook.<span style="color: #000080;">dc</span>.<span style="color: #000080;">add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;CSV&quot;</span><span style="color: #000000;">&#41;</span>;
wks.<span style="color: #000080;">dc</span>.<span style="color: #000080;">source</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> path<span style="color: #000080;">$</span>;
wks.<span style="color: #000080;">dc</span>.<span style="color: #000080;">import</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</pre>
<p>See complete list of <a class="external text" href="../../LabTalk/LabTalk/Wks.DC_(object).html">wks.dc objects</a> and <a class="external text" href="../../LabTalk/LabTalk/Wbk.DC_(object).html">wbk.dc objects</a>
</p>
<h3><a name="X-Function_Methods"></a><span class="mw-headline">X-Function Methods</span></h3>
<p>This example imports an <span class="OIndex">ASCII</span> file (in this case having a <b>*.txt</b> extension) into the active worksheet or matrix.  Another X-Function, <a class="external text" href="../../XFunction/X-Function/FindFiles.html"><b>findfiles</b></a>, is used to find a specific file in a directory (assigned to the string <b>path$</b>) that contains many other files.  The output of the findfiles X-Function is a string variable containing the desired filename(s), and is assigned, by default, to a variable named <b>fname$</b>.  Not coincidentally, the default input argument for the <a class="external text" href="../../XFunction/X-Function/ImpASC.html"><b>impASC</b></a> X-Function is a string variable called <b>fname$</b>.
</p>
<pre class="lt" style="font-family:monospace;">string path<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Import and Export\&quot;</span>;
findfiles ext<span style="color: #000000;">:</span><span style="color: #000080;">=</span>matrix_data_with_xy.<span style="color: #000080;">txt</span>;
impASC;</pre>
<h2><a name="Import_ASCII_Data_with_Options_Specified"></a><span class="mw-headline">Import ASCII Data with Options Specified</span></h2>
<p>This example makes use of many advanced options of the <a class="external text" href="../../XFunction/X-Function/ImpASC.html"><b>impASC</b></a> X-Function.  It imports a file to a new book, which will be renamed by the options of the <b>impASC</b> X-Function.  Notice that there is only one semi-colon (following all <b>options</b> assignments) indicating that all are part of the call to <b>impASC</b>. 
</p>
<pre class="lt" style="font-family:monospace;">string fn<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Spectroscopy\HiddenPeaks.dat&quot;</span>; 
impasc fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>fn<span style="color: #000080;">$</span> 
options.<span style="color: #000080;">ImpMode</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span>                        <span style="color: #008000; font-style: regular;">/* start with a new book */</span>
options.<span style="color: #000080;">Sparklines</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>                     <span style="color: #008000; font-style: regular;">/* turn off sparklines */</span>
options.<span style="color: #000080;">Names</span>.<span style="color: #000080;">AutoNames</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>                <span style="color: #008000; font-style: regular;">/* turn off auto rename */</span>
options.<span style="color: #000080;">Names</span>.<span style="color: #000080;">FNameToSht</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>               <span style="color: #008000; font-style: regular;">/* rename sheet to file name */</span>
options.<span style="color: #000080;">Miscellaneous</span>.<span style="color: #000080;">LeadingZeros</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;    <span style="color: #008000; font-style: regular;">/* remove leading zeros */</span></pre>
<h2><a name="Import_Multiple_Data_Files"></a><span class="mw-headline">Import Multiple Data Files</span></h2>
<h3><a name="Data_Connector_Methods_2"></a><span class="mw-headline">Data Connector Methods</span></h3>
<p>This example demonstrates importing multiple CSV files to a new workbook, using a <a class="external text" href="../../UserGuide/Category/Data_Connector.html">Data Connector</a>. The scripts creates a new workbook for each file.
</p>
<pre class="lt" style="font-family:monospace;">string folder<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Batch Processing\&quot;</span>;
string files<span style="color: #000080;">$</span>;
findfiles path<span style="color: #000000;">:</span><span style="color: #000080;">=</span>folder<span style="color: #000080;">$</span> ext<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;.csv&quot;</span> fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>files<span style="color: #000080;">$</span>;
int num <span style="color: #000080;">=</span> files.<span style="color: #000080;">GetNumTokens</span><span style="color: #000000;">&#40;</span>CRLF<span style="color: #000000;">&#41;</span>;
for <span style="color: #000000;">&#40;</span>int ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; ii <span style="color: #000080;">&lt;=</span> num; ii<span style="color: #000080;">++</span> <span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span>
	newbook;wbook.<span style="color: #000080;">dc</span>.<span style="color: #000080;">add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;CSV&quot;</span><span style="color: #000000;">&#41;</span>;
	wks.<span style="color: #000080;">dc</span>.<span style="color: #000080;">source</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> files.<span style="color: #000080;">gettoken</span><span style="color: #000000;">&#40;</span>ii, CRLF<span style="color: #000000;">&#41;</span><span style="color: #000080;">$</span>;
	wks.<span style="color: #000080;">dc</span>.<span style="color: #000080;">Import</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<p>This example imports the same files into a single workbook.
</p>
<pre class="lt" style="font-family:monospace;">string folder<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Batch Processing\&quot;</span>;
string files<span style="color: #000080;">$</span>;
findfiles path<span style="color: #000000;">:</span><span style="color: #000080;">=</span>folder<span style="color: #000080;">$</span> ext<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;.csv&quot;</span> fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>files<span style="color: #000080;">$</span>;
int num <span style="color: #000080;">=</span> files.<span style="color: #000080;">GetNumTokens</span><span style="color: #000000;">&#40;</span>CRLF<span style="color: #000000;">&#41;</span>;
newbook;
page.<span style="color: #000080;">nlayers</span> <span style="color: #000080;">=</span> num;
wbook.<span style="color: #000080;">dc</span>.<span style="color: #000080;">add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;CSV&quot;</span><span style="color: #000000;">&#41;</span>;
for <span style="color: #000000;">&#40;</span>int ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; ii <span style="color: #000080;">&lt;=</span> num; ii<span style="color: #000080;">++</span> <span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span>
	page.<span style="color: #000080;">active</span> <span style="color: #000080;">=</span> ii;
	wks.<span style="color: #000080;">dc</span>.<span style="color: #000080;">sel</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;&quot;</span>;<span style="color: #008000;">//needs to be before source, helps connect the sheet</span>
	wks.<span style="color: #000080;">dc</span>.<span style="color: #000080;">source</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> files.<span style="color: #000080;">gettoken</span><span style="color: #000000;">&#40;</span>ii, CRLF<span style="color: #000000;">&#41;</span><span style="color: #000080;">$</span>;
<span style="color: #000000;">&#125;</span>
wbook.<span style="color: #000080;">dc</span>.<span style="color: #000080;">Import</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</pre>
<p>This example partially imports CSV with wks.dc.optn$ setting by tree
</p>
<pre class="lt" style="font-family:monospace;">wbook.<span style="color: #000080;">dc</span>.<span style="color: #000080;">add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;CSV&quot;</span><span style="color: #000000;">&#41;</span>;
string str1<span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;%@O&quot;</span>;
str1<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> str1.<span style="color: #000080;">GetFilePath</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">$</span>;
str1<span style="color: #000080;">$</span> <span style="color: #000080;">+</span><span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Samples\Statistics\automobile.dat&quot;</span>;
wks.<span style="color: #000080;">dc</span>.<span style="color: #000080;">source</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>str1<span style="color: #000080;">$</span>;

Tree tr1<span style="color: #000080;">=</span>wks.<span style="color: #000080;">dc</span>.<span style="color: #000080;">optn</span><span style="color: #000080;">$</span>;
tr1.<span style="color: #000080;">settings</span>.<span style="color: #000080;">partial</span>.<span style="color: #000080;">SetAttribute</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Use&quot;</span>, <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
tr1.<span style="color: #000080;">settings</span>.<span style="color: #000080;">partial</span>.<span style="color: #000080;">col</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;1:3&quot;</span>;
tr1.<span style="color: #000080;">ToString</span><span style="color: #000000;">&#40;</span>wks.<span style="color: #000080;">dc</span>.<span style="color: #000080;">optn</span><span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>;<span style="color: #008000;">//convert tree to string</span>
wks.<span style="color: #000080;">dc</span>.<span style="color: #000080;">import</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</pre>
<h3><a name="X-Function_Methods_2"></a><span class="mw-headline">X-Function Methods</span></h3>
<p>This example demonstrates importing multiple data files to a new workbook; starting a new worksheet for each file.
</p>
<pre class="lt" style="font-family:monospace;">string fns, path<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Curve Fitting\&quot;</span>; 
findfiles fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>fns<span style="color: #000080;">$</span> ext<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;step1*.dat&quot;</span>;   <span style="color: #008000;">// find matching files in 'path$'</span>
int n <span style="color: #000080;">=</span> fns.<span style="color: #000080;">GetNumTokens</span><span style="color: #000000;">&#40;</span>CRLF<span style="color: #000000;">&#41;</span>;      <span style="color: #008000;">// Number of files found</span>
string bkName<span style="color: #000080;">$</span>;
newbook s<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> result<span style="color: #000000;">:</span><span style="color: #000080;">=</span>bkName<span style="color: #000080;">$</span>;
impasc fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>fns<span style="color: #000080;">$</span>                  <span style="color: #008000;">// impasc has many options</span>
options.<span style="color: #000080;">ImpMode</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span>     		    <span style="color: #008000;">// start with new sheet </span>
options.<span style="color: #000080;">Sparklines</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span> 		    <span style="color: #008000;">// add sparklines if &lt; 50 cols</span>
options.<span style="color: #000080;">Cols</span>.<span style="color: #000080;">NumCols</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span>  	    <span style="color: #008000;">// only import first three columns </span>
options.<span style="color: #000080;">Names</span>.<span style="color: #000080;">AutoNames</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> 	    <span style="color: #008000;">// turn off auto rename </span>
options.<span style="color: #000080;">Names</span>.<span style="color: #000080;">FNameToBk</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>          <span style="color: #008000;">// do not rename the workbook </span>
options.<span style="color: #000080;">Names</span>.<span style="color: #000080;">FNameToSht</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>         <span style="color: #008000;">// rename sheet to file name </span>
options.<span style="color: #000080;">Names</span>.<span style="color: #000080;">FNameToShtFrom</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span>     <span style="color: #008000;">// trim file name after 4th letter</span>
options.<span style="color: #000080;">Names</span>.<span style="color: #000080;">FNameToBkComm</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>      <span style="color: #008000;">// add file name to workbook comment</span>
options.<span style="color: #000080;">Names</span>.<span style="color: #000080;">FNameToColComm</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>     <span style="color: #008000;">// add file name to columns comments</span>
options.<span style="color: #000080;">Names</span>.<span style="color: #000080;">FPathToComm</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>        <span style="color: #008000;">// include file path to comments</span>
orng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>bkName<span style="color: #000080;">$</span><span style="color: #000000;">&#93;</span>A1<span style="color: #000080;">!</span>A<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">:</span>C<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#93;</span>&#160;;</pre>
<h2><a name="Import_an_ASCII_File_to_Worksheet_and_Convert_to_Matrix"></a><span class="mw-headline">Import an ASCII File to Worksheet and Convert to Matrix</span></h2>
<p>This example shows two more helpful X-Functions working in conjunction with <a class="external text" href="../../XFunction/X-Function/ImpASC.html"><b>impASC</b></a>; they are <a class="external text" href="../../XFunction/X-Function/DlgFile.html"><b>dlgFile</b></a>, which generates a dialog for choosing a specific file to import, and <a class="external text" href="../../XFunction/X-Function/W2m.html"><b>w2m</b></a> which specifies the conversion of a worksheet to a matrix. 
It should be noted that the <b>w2m</b> X-Function expects linearly increasing Y values in the first column and linearly increasing X values in the first row: test this with <b>matrix_data_with_xy.txt</b> in the <b>Samples\Import and Export\</b> folder.
</p>
<pre class="lt" style="font-family:monospace;">dlgfile g<span style="color: #000000;">:</span><span style="color: #000080;">=</span>ascii; <span style="color: #008000;">// Open file dialog</span>
impAsc; <span style="color: #008000;">// Import selected file</span>
<span style="color: #008000;">// Use the worksheet-to-matrix X-Function, 'w2m', to do the conversion</span>
w2m xy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> ycol<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> xlabel<span style="color: #000000;">:</span><span style="color: #000080;">=</span>row1</pre>
<h2><a name="Related:_the_Open_Command"></a><span class="mw-headline">Related: the Open Command</span></h2>
<p>Another way to bring data into Origin is with the <a href="../../LabTalk/LabTalk/Open_(command).html" title="LabTalk:Open (command)"><b>Open</b> (Command)</a>.
</p><p>Open has several options, one of which allows a file to be open for viewing in a notes window:
</p>
<dl><dd><font color="navy"><i>open -n fileName [winName]</i></font></dd></dl>
<p>This line of script opens the ASCII file <i>fileName</i> to a <b>notes</b> window.  If the optional <i>winName</i> is not specified, a new <b>notes</b> window will be created.
</p><p>To demonstrate with an existing file, try the following:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000080;">%</span>b <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Import and Export\ASCII simple.dat&quot;</span>;
open <span style="color: #000080;">-</span>n <span style="color: #ff00ff;">&quot;%b&quot;</span>;</pre>
<h2><a name="Import_with_Themes_and_Filters"></a><span class="mw-headline">Import with Themes and Filters</span></h2>
<h3><a name="Import_with_a_Theme"></a><span class="mw-headline">Import with a Theme</span></h3>
<p>When importing from the Origin GUI, you can save your import settings to a <b><span class="OIndex">theme</span><span class="OIndex HasShownIndex" style="display:none">Import Data Theme</span> file</b>.  Such theme files have a *.OIS extension and are saved in the <b>\Themes\AnalysisAndReportTable\</b> subfolder of the Origin <b>User Files Folder</b> (UFF).  They can then be accessed using an X-Function with the <b>-t</b> <a href="../../LabTalk/LabTalk/X-Function_Execution_Options.html" title="LabTalk:X-Function Execution Options">option switch</a>.  The import is performed according to the settings saved in the theme file specified.
</p>
<pre class="lt" style="font-family:monospace;">string fn<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Spectroscopy\HiddenPeaks.dat&quot;</span>; 
<span style="color: #008000;">// Assume that a theme file named &quot;My Theme.OIS&quot; exists </span>
impasc fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>fn<span style="color: #000080;">$</span> <span style="color: #000080;">-</span>t <span style="color: #ff00ff;">&quot;My Theme&quot;</span>;</pre>
<h3><a name="Import_with_an_Import_Wizard_Filter_File"></a><span class="mw-headline">Import with an Import Wizard Filter File</span></h3>
<p>Custom importing of ASCII files and simple binary files can be performed using the <b>Import Wizard</b> GUI tool. This tool allows extraction of variables from file name and header, and further customization of the import including running a script segment at the end of the import, which can be used to perform post-processing of imported data.  All settings in the GUI can be saved as an <b>Import Filter File</b> to disk.  Such files have extension of <b>.OIF</b> and can be saved in multiple locations.
</p><p>Once an <b>import wizard <span class="OIndex">filter</span> file</b> has been created, the <a class="external text" href="../../XFunction/X-Function/ImpFile.html"><b>impfile</b></a> X-Function can be used to access the filter and perform custom importing using the settings saved in the filter file.
</p>
<pre class="lt" style="font-family:monospace;">string fname<span style="color: #000080;">$</span>, path<span style="color: #000080;">$</span>, filtername<span style="color: #000080;">$</span>;
<span style="color: #008000;">// point to file path</span>
path<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Import and Export\&quot;</span>;
<span style="color: #008000;">// find files that match specification</span>
findfiles ext<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;S*.dat&quot;</span>;
<span style="color: #008000;">// point to Import Wizard filter file</span>
string str<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Samples\Import and Export\VarsFromFileNameAndHeader.oif&quot;</span>;
filtername<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> str<span style="color: #000080;">$</span>;  
<span style="color: #008000;">// import all files using filter in data folder </span>
impfile location<span style="color: #000000;">:</span><span style="color: #000080;">=</span>data;</pre>
<h2><a name="Import_from_a_Database"></a><span class="mw-headline">Import from a Database</span></h2>
<p>Origin provides four functions for <span class="OIndex">Database</span> Queries. The basic functionality of Database importing is encapsulated in two functions as shown in this example using the standard Northwind database provided by Microsoft Office:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// The dbedit function allows you to create the query and connection</span>
<span style="color: #008000;">// strings and attach these details to a worksheet</span>
dbedit exec<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>
sql<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Select Customers.CompanyName, Orders.OrderDate,
[Order Details].Quantity, Products.ProductName From
((Customers Inner Join Orders On Customers.CustomerID = Orders.CustomerID)
Inner Join [Order Details] On Orders.OrderID = [Order Details].OrderID)
Inner Join Products On Products.ProductID = [Order Details].ProductID&quot;</span>
connect<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Provider=Microsoft.Jet.OLEDB.4.0;User ID=;
Data Source=C:\Program Files\Microsoft Office\OFFICE11\SAMPLES\Northwind.mdb;
Mode=Share Deny None;Extended Properties=&quot;</span><span style="color: #ff00ff;">&quot;;
Jet OLEDB:System database=&quot;</span><span style="color: #ff00ff;">&quot;;
Jet OLEDB:Registry Path=&quot;</span><span style="color: #ff00ff;">&quot;;
Jet OLEDB:Database Password=***;
Jet OLEDB:Engine Type=5;
Jet OLEDB:Database Locking Mode=1;
Jet OLEDB:Global Partial Bulk Ops=2;
Jet OLEDB:Global Bulk Transactions=1;
Jet OLEDB:New Database Password=&quot;</span><span style="color: #ff00ff;">&quot;;
Jet OLEDB:Create System Database=False;
Jet OLEDB:Encrypt Database=False;
Jet OLEDB:Don't Copy Locale on Compact=False;
Jet OLEDB:Compact Without Replica Repair=False;
Jet OLEDB:SFP=False;Password=&quot;</span>

<span style="color: #008000;">// The dbimport function is all that's needed to complete the import</span>
dbimport;</pre>
<p>Two additional functions allow you to retrieve the details of your connection and query strings and execute a Preview/Partial import.
</p>
<table class="simple">
<tr>
<th> Name
</th>
<th> Brief Description
</th></tr>
<tr>
<td> <a class="external text" href="../../XFunction/X-Function/DbEdit.html">dbEdit</a>
</td>
<td>
<p>Create, Edit, Load or Remove a query in a worksheet.
</p>
</td></tr>
<tr>
<td> <a class="external text" href="../../XFunction/X-Function/DbImport.html">dbImport</a>
</td>
<td>
<p>Execute the database query stored in a specific worksheet.
</p>
</td></tr>
<tr>
<td> <a class="external text" href="../../XFunction/X-Function/DbInfo.html">dbInfo</a>
</td>
<td>
<p>Read the sql string and the connection string contained in a database query in a worksheet.
</p>
</td></tr>
<tr>
<td> <a class="external text" href="../../XFunction/X-Function/DbPreview.html">dbPreview</a>
</td>
<td>
<p>Execute a limited import (defaults to 50 rows) of a query. Useful in testing to verify that your query is returning the information you want.
</p>
</td></tr>
</table>






