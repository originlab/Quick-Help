<h1 class="firstHeading">2.1 Getting Started with LabTalk</h1><p class='urlname' style='display: none'>Getting-Started-with-LT</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Hello_WorldHello_World"><span class="tocnumber">1</span> <span class="toctext">Hello World<span class="OIndex" style="display:none">Hello World</span></span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Using_.3D_to_Get_Quick_OutputQuick_Output"><span class="tocnumber">2</span> <span class="toctext">Using = to Get Quick Output<span class="OIndex" style="display:none">Quick Output</span></span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Simple_Useful_CommandsSimple_Commands"><span class="tocnumber">3</span> <span class="toctext">Simple Useful Commands<span class="OIndex" style="display:none">Simple Commands</span></span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Worksheet"><span class="tocnumber">3.1</span> <span class="toctext">Worksheet</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Graph"><span class="tocnumber">3.2</span> <span class="toctext">Graph</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Other_Ways_to_Execute_Script"><span class="tocnumber">4</span> <span class="toctext">Other Ways to Execute Script</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#Custom_RoutineCustom_Routine_Button"><span class="tocnumber">4.1</span> <span class="toctext">Custom Routine<span class="OIndex" style="display:none">Custom Routine</span> Button</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Custom_Menu_Item"><span class="tocnumber">4.2</span> <span class="toctext">Custom Menu Item</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Button_in_a_Graph"><span class="tocnumber">4.3</span> <span class="toctext">Button in a Graph</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-10"><a href="#Script_Example"><span class="tocnumber">5</span> <span class="toctext">Script Example</span></a></li>
<li class="toclevel-1 tocsection-11"><a href="#Using_CTRL_.2B_SHIFT_to_capture_Menu_Command_and_Toolbar_Button_Script"><span class="tocnumber">6</span> <span class="toctext">Using CTRL + SHIFT to capture Menu Command and Toolbar Button Script</span></a>
<ul>
<li class="toclevel-2 tocsection-12"><a href="#Example"><span class="tocnumber">6.1</span> <span class="toctext">Example</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-13"><a href="#Where_to_Go_from_Here.3F"><span class="tocnumber">7</span> <span class="toctext">Where to Go from Here?</span></a></li>
</ul>
</div>

<h2><a name="Hello_WorldHello_World"></a><span class="mw-headline">Hello World<span class="OIndex" style="display:none">Hello World</span></span></h2>
<p>We begin with a classic example to show you how to <a href="../../LabTalk/Category/LT_Running_Scripts.html" title="Category:LT Running Scripts">execute LabTalk script</a>.
We use LabTalk <a href="../../LabTalk/LabTalk/Command_Statements.html" title="LabTalk:Command Statements">command</a> <b><a href="../../LabTalk/LabTalk/Type_(command).html" title="LabTalk:Type (command)">type</a></b> in the example. Please note that Origin's LabTalk commands are case insensitive.
</p>
<ol>
<li>Open Origin, and from the <b>Window</b> menu, select the <b>Script Window</b> option.  The <b><a href="../../LabTalk/Script/From_Script_and_Command_Window.html" title="Script:From Script and Command Window"><span class="OIndex">Script Window</span></a></b> will open.</li>
<li>In this window, type the following text and then press Enter: 
<pre class="lt" style="font-family:monospace;">type <span style="color: #ff00ff;">&quot;Hello World&quot;</span></pre>
<li>Origin adds a <a href="../../LabTalk/LabTalk/Using_Semicolons_in_LabTalk.html" title="LabTalk:Using Semicolons in LabTalk">semicolon</a>, <b>;</b>, at the end of the line and also executes that line of script.
<li> This line of script outputs <b>Hello World</b> directly beneath your command.
<li>To run this line of script again, place the cursor anywhere before&#160;; on the line and press Enter.
</ol>
<p><br />
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Getting_Started_with_LabTalk/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>Commands can be abbreviated as long as it's unique. Both the following work.
</p>
<pre class="lt" style="font-family:monospace;">typ <span style="color: #ff00ff;">&quot;Hello Word&quot;</span></pre>
<pre class="lt" style="font-family:monospace;">ty <span style="color: #ff00ff;">&quot;Hello World&quot;</span></pre>
</td></tr></table>
<p><br />
Now let us see how to execute multiple lines of script from the script window:
</p>
<ol>
<li>Make a workbook window active since the following script outputs workbook information.
<li>In <b><a href="../../LabTalk/Script/From_Script_and_Command_Window.html" title="Script:From Script and Command Window"><span class="OIndex">Script Window</span></a></b> window, paste the following lines of script separated by <b>;</b>
<pre class="lt" style="font-family:monospace;">type <span style="color: #ff00ff;">&quot;The current workbook is&#160;%h&quot;</span>;
type <span style="color: #ff00ff;">&quot;This book has $(page.nlayers) sheet(s)&quot;</span>;
type <span style="color: #ff00ff;">&quot;There are $(wks.ncols) columns in the active sheet&quot;</span>;</pre>
<li> Highlight all lines (if using mouse, drag and select all lines of script, or if using keyboard, put cursor at either the beginning or the end of the script, hold <b>Shift</b> key and press up/down arrow keys to select all lines of script).
<li>Press Enter to execute all selected lines of script. 
<li>It will output the current workbook name, how many number of sheets in book, and how many columns in active sheet similar to the following text:
<pre class="lt" style="font-family:monospace;">The current workbook is Book1
This book has <span style="color: #0000dd;">1</span> sheet<span style="color: #000000;">&#40;</span>s<span style="color: #000000;">&#41;</span>
There are <span style="color: #0000dd;">2</span> columns in the active sheet</pre>
</ol>
<p>In the above example, we used the <b><a href="../../LabTalk/LabTalk/String_registers.html#String_Registers_as_System_Variables" title="LabTalk:String registers">%H</a></b> String Register that holds the currently active window name (which could be a workbook, a matrix, or a graph). We then used the <b><a href="../../LabTalk/LabTalk/Page_(object).html" title="LabTalk:Page (object)">page</a></b> and <b><a href="../../LabTalk/LabTalk/Wks_(object).html" title="LabTalk:Wks (object)">wks</a></b> <a href="../../LabTalk/LabTalk/LabTalk_Objects.html" title="LabTalk:LabTalk Objects">LabTalk Objects</a> to get the number of sheets in the book and the number of columns in the sheet. The <b>$()</b> is a <a href="../../LabTalk/Category/Substitution_Notation.html" title="Category:Substitution Notation"><span class="OIndex">substitution notation</span>s</a> which tells Origin to evaluate the expression within the <b>()</b> and return its value.
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Getting_Started_with_LabTalk/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>When typing multiple lines of script in the Script Window yourself, 
</p>
<dl><dd><ol><li> Add&#160;; and then press Enter key to avoid execution of the line. Origin will just start a new line for you to continue the typing. At the end, select all lines and press Enter to execute them together.</li>
<li> Or uncheck <b>Edit: Script Execution</b>. Type in the lines to avoid executing any lines by mistake. At the end, check <b>Edit: Script Execution</b>. Select all lines and press Enter to execute them together.</li></ol></dd></dl>
</td></tr></table>
<h2><a name="Using_.3D_to_Get_Quick_OutputQuick_Output"></a><span class="mw-headline">Using = to Get Quick Output<span class="OIndex" style="display:none">Quick Output</span></span></h2>
<p>The <b>=</b> character is typically used as an <a href="../../LabTalk/LabTalk/Operators.html" title="LabTalk:Operators"><span class="OIndex">assignment operator</span></a>, with a left- and right-hand side. When the right-hand side is missing, the interpreter will evaluate the expression on the left of the <b>=</b> character and print the result in the script window. 
</p><p>Evaluation math expression on left and print result <a href="../../LabTalk/LabTalk/Interactive_Execution.html" title="LabTalk:Interactive Execution"><span class="OIndex">interactively</span></a>.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #0000dd;">3</span> <span style="color: #000080;">+</span> <span style="color: #0000dd;">5</span> <span style="color: #000080;">=</span></pre>
<p>Origin computes the result and displays it in the next line:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #0000dd;">3</span> <span style="color: #000080;">+</span> <span style="color: #0000dd;">5</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">8</span></pre>
<p>Output string register and Origin object properties 
</p>
<pre class="lt" style="font-family:monospace;"> 
<span style="color: #000080;">%</span>H <span style="color: #000080;">=</span>; <span style="color: #008000;">//current window name</span>
wks.<span style="color: #000080;">ncols</span><span style="color: #000080;">=</span>; <span style="color: #008000;">//number of columns</span>
wks.<span style="color: #000080;">col1</span>.<span style="color: #000080;">name</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>; <span style="color: #008000;">//1st column's short name</span></pre>
<p>Suppose the current window is Book1 with 1 sheet and 2 columns, executing the above script will output
</p>
<pre class="lt" style="font-family:monospace;">Book1
wks.<span style="color: #000080;">ncols</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>
A</pre>
<p>In the following example, we introduce the concept of <a href="../../LabTalk/LabTalk/Data_Types_and_Variables.html" title="LabTalk:Data Types and Variables"><span class="OIndex">variables</span></a> in LabTalk. Variable names are <b>case insensitive</b>. Entering the following <a href="../../LabTalk/LabTalk/Assignment_Statements.html" title="LabTalk:Assignment Statements">assignment statement</a> in the script window:
</p>
<pre class="lt" style="font-family:monospace;">double A <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span></pre>
<p>creates a variable A and initializes its value to 2. Then you can perform some <a href="../../LabTalk/LabTalk/Arithmetic_Statement.html" title="LabTalk:Arithmetic Statement">arithmetic</a> on variable A, such as multiplying by PI (a <a href="../../LabTalk/LabTalk/Operators.html#Define_a_constant" title="LabTalk:Operators">constant</a> defined in Origin, <img src="../images/Getting_Started_with_LabTalk/math-b8838e6c7f4a9479d7deaef96e8dfd57.png?v=0" title="\;\pi" alt="\;\pi" class="tex"/>) and assign the result back to A:
</p>
<pre class="lt" style="font-family:monospace;">A <span style="color: #000080;">=</span> A<span style="color: #000080;">*</span>PI</pre>
<p>To display the current value of A, type:
</p>
<pre class="lt" style="font-family:monospace;">A <span style="color: #000080;">=</span></pre>
<p>Press Enter and Origin responds with:
</p>
<pre class="lt" style="font-family:monospace;">A <span style="color: #000080;">=</span> <span style="color: #0000dd;">6.2831853071796</span></pre>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Getting_Started_with_LabTalk/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>There is <a href="../../LabTalk/LabTalk/List_(command).html" title="LabTalk:List (command)">List</a> command to view a list of variables and their values. Type the following command and press Enter:
</p>
<pre class="lt" style="font-family:monospace;">list</pre>
<p>Origin will open the <b>LabTalk Variables and Functions</b> dialog that lists all variables.
</p><p>You can also get a dump of a specific type of variables, for example
</p>
<pre class="lt" style="font-family:monospace;">list v</pre>
<p>to list the numeric <a href="../../LabTalk/LabTalk/Data_Types_and_Variables.html" title="LabTalk:Data Types and Variables">variables</a>.
</p></td></tr></table>
<h2><a name="Simple_Useful_CommandsSimple_Commands"></a><span class="mw-headline">Simple Useful Commands<span class="OIndex" style="display:none">Simple Commands</span></span></h2>
<h3><a name="Worksheet"></a><span class="mw-headline">Worksheet</span></h3>
<pre class="lt" style="font-family:monospace;">newbook; <span style="color: #008000;">//create a workbook</span>
wks.<span style="color: #000080;">ncols</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span>; <span style="color: #008000;">//set worksheet has 3 columns</span></pre>
<pre class="lt" style="font-family:monospace;">col<span style="color: #000000;">&#40;</span>B<span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span><span style="color: #000080;">*</span>col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//set col(B)'s value by col(A)</span></pre>
<h3><a name="Graph"></a><span class="mw-headline">Graph</span></h3>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//select a Y column firstly</span>
plotxy; <span style="color: #008000;">//use the selected Y column and its X column to plot</span></pre>
<pre class="lt" style="font-family:monospace;">layer.<span style="color: #000080;">x</span>.<span style="color: #000080;">from</span><span style="color: #000080;">=</span><span style="color: #0000dd;">5</span>; <span style="color: #008000;">//set X axis from value</span></pre>
<h2><a name="Other_Ways_to_Execute_Script"></a><span class="mw-headline">Other Ways to Execute Script</span></h2>
<p>In previous examples, you saw how to execute script from the <b><a href="../../LabTalk/Script/From_Script_and_Command_Window.html" title="Script:From Script and Command Window"><span class="OIndex">Script Window</span></a></b>. Origin provides several other ways to organize and execute LabTalk script. These are outlined in detail in the <b><a href="../../LabTalk/Category/LT_Running_and_Debugging_LabTalk_Scripts.html" title="Category:LT Running and Debugging LabTalk Scripts">Running and Debugging LabTalk Scripts</a></b> chapter. Here we take a quick look at a few of the methods to execute script: (1) from the <b>Custom Routine</b> <a href="../../LabTalk/Script/From_a_Toolbar_Button.html" title="Script:From a Toolbar Button">toolbar button</a>, (2) from a <a href="../../LabTalk/Script/From_a_Custom_Menu_Item.html" title="Script:From a Custom Menu Item">custom menu item</a>, and (3) from a <a href="../../LabTalk/Script/From_Graphical_Objects.html" title="Script:From Graphical Objects">button in a graph page</a>.
</p>
<h3><a name="Custom_RoutineCustom_Routine_Button"></a><span class="mw-headline">Custom Routine<span class="OIndex" style="display:none">Custom Routine</span> Button</span></h3>
<p>Origin provides a convenient way to save script and run it with the push of a toolbar button.
</p>
<ol>
<li>While holding down <b>Ctrl+Shift</b> on your keyboard, press the <b>Custom Routine</b> button ( <a  class="image"><img alt="Button Custom Routine.png" src="../images/Getting_Started_with_LabTalk/Button_Custom_Routine.png?v=0" width="23"  /></a> ) located in the <a class="external text" href="../../UserGuide/UserGuide/The_Standard_Toolbar.html">Standard Toolbar</a>.</li>
<li>This opens <b><a href="../../LabTalk/Script/Debugging_Tools.html" title="Script:Debugging Tools">Code Builder</a></b>, Origin's native script editor.  The file being edited is called <b>Custom.ogs</b>.   The code has one <a href="../../LabTalk/LabTalk/Flow_of_Control.html#Sections_in_a_Script_File" title="LabTalk:Flow of Control">section</a>, <b>[Main]</b>, and contains one line of script: 
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">&#91;</span>Main<span style="color: #000000;">&#93;</span>
type <span style="color: #000080;">-</span>b <span style="color: #000080;">$</span>General.<span style="color: #000080;">Userbutton</span>;</pre>
<p>Replace that line with the following:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">&#91;</span>Main<span style="color: #000000;">&#93;</span>
type <span style="color: #000080;">-</span>b <span style="color: #ff00ff;">&quot;Hello World&quot;</span>;</pre>
Then press the <b>Save</b> ( <a  class="image"><img alt="Button Save Project.png" src="../images/Getting_Started_with_LabTalk/Button_Save_Project.png?v=0" width="23"  /></a> ) button in the <b>Code Builder</b> window.  </li>
<li>Now go back to the Origin application window and click the <a  class="image"><img alt="Button Custom Routine.png" src="../images/Getting_Started_with_LabTalk/Button_Custom_Routine.png?v=0" width="23"  /></a> button (keyboard shortcut: <b>ALT + F5</b>). </li>
</ol>
<p>Origin will again output the text Hello World, but this time, because of the <b>-b</b> switch used with the <b><a href="../../LabTalk/LabTalk/Type_(command).html" title="LabTalk:Type (command)">type</a></b> command, the text will be presented in a pop-up window.
</p>
<h3><a name="Custom_Menu_Item"></a><span class="mw-headline">Custom Menu Item</span></h3>
<p>LabTalk script can be executed from a custom menu item.
</p>
<ol>
<li>Select the menu item <b>Preferences: Custom Menu Organizer...</b> to open the <b><a class="external text" href="../../UserGuide/UserGuide/The_Custom_Menu_Organizer_Dialog_Box.html">Custom Menu Organizer</a></b> dialog.
</li>
<li>Make the <b>Add Custom Menu</b> tab active. Then right-click inside the left panel and select <b>New Main Popup</b> from the context menu.
</li>
<li>In the right panel, enter a name for <b>Popup Text</b>, such as <b>My Menu</b>. then click outside of the edit box.
</li>
<li>Select <b>My Menu</b> from the left panel, and then right click on it, and select <b>Add Item</b> from the context menu.
</li>
<li>In the right panel, change the <b>Item Text</b> to <b>Hello World</b>, then add the following script to the <b>LabTalk Script</b> text box:
</li>
<pre class="lt" style="font-family:monospace;">type <span style="color: #000080;">-</span>b <span style="color: #ff00ff;">&quot;Hello World&quot;</span>;</pre>
<li>Click the <b>Close</b> button, and in the window that pops up, press <b>Yes</b> to save the menu changes as <b>Default</b> menu. In the file dialog that opens, press <b>Save</b> to save the file with the default name to the default folder (<a class="external text" href="../../UserGuide/UserGuide/The_User_Files_Folder.html">User Files Folder</a>).
</li>
<li>A new menu named <b>My Menu</b> should now appear in the menu bar, to the left of the <b>Window</b> menu. Click on this new menu item, and then click on the <b>Hello World</b> entry in the drop-down. A Hello World dialog will pop up.
</ol>
<h3><a name="Button_in_a_Graph"></a><span class="mw-headline">Button in a Graph</span></h3>
<p>Origin also provides the ability to add a button to a graph or worksheet, and then execute LabTalk script by pushing that button. This allows for script to be saved with a specific project or window.
</p>
<ol>
<li>Press the <b>New Graph</b> button ( <a  class="image"><img alt="Button New Graph.png" src="../images/Getting_Started_with_LabTalk/Button_New_Graph.png?v=25499" width="23"  /></a> ) located in the <a class="external text" href="../../UserGuide/UserGuide/The_Standard_Toolbar.html">Standard Toolbar</a> to create a new graph.
</li>
<li>Press the <b>Text Tool</b> button ( <a  class="image"><img alt="Button Text Tool.png" src="../images/Getting_Started_with_LabTalk/Button_Text_Tool.png?v=0" width="23"  /></a> ) in the <a class="external text" href="../../UserGuide/UserGuide/The_Tools_Toolbar.html">Tools Toolbar</a>, and then click on the newly created graph and type the text <b>My Button</b>. Then click outside the text to finish editing the text.
</li>
<li>Right click on the text to bring up the context menu, and then select <b>Programming Control</b> to open the <b><a href="../../LabTalk/LabTalk/Graphic_Objects.html" title="LabTalk:Graphic Objects">Programming Control</a></b> dialog.
</li>
<li>In the dialog, select <b>Button Up</b> from the <b>Script, Run After:</b> drop-down list, and then type the following script in the edit box:
</li>
<pre class="lt" style="font-family:monospace;">type <span style="color: #000080;">-</span>b <span style="color: #ff00ff;">&quot;Hello World&quot;</span>;</pre>
<li>Click OK to close the dialog. Now the text label becomes a button. Click the button. A Hello World dialog will pop up.
</li>
</ol>
<h2><a name="Script_Example"></a><span class="mw-headline">Script Example</span></h2>
<p>We now present a script example that walks you through a particular scenario of <a href="../../LabTalk/Category/LT_Importing.html" title="Category:LT Importing">importing</a> and processing data, and then saving the project. This example uses several LabTalk language features such as <b><a href="../../LabTalk/LabTalk/Command_Statements.html" title="LabTalk:Command Statements">Commands</a></b>, <b><a href="../../LabTalk/LabTalk/LabTalk_Objects.html" title="LabTalk:LabTalk Objects">Objects</a></b>, and <b><a href="../../LabTalk/Category/X-Functions.html" title="Category:X-Functions">X-Functions</a></b>. You will learn more details about these language features in subsequent chapters.
</p><p><b>NOTE:</b> We will use the <b><a href="../../LabTalk/Script/From_Script_and_Command_Window.html" title="Script:From Script and Command Window"><span class="OIndex">Script Window</span></a></b> to execute these statements. To execute a single line of code, make sure that you leave out the <b>;</b> at the end before pressing Enter. For multiple lines of code, at the end of each line, press Enter after the <b>;</b> to continue entering the next line. After you have typed in all lines, select them all and then press Enter to execute.
</p><p>Let's start with a new project using the <b><a href="../../LabTalk/LabTalk/Document_(command)&amp;action=edit&amp;redlink=1.html" class="new" title="LabTalk:Document (command) (page does not exist)">doc</a></b> command and the <b>-n</b> switch. If the current project needs saving, this command will prompt user to save.
</p>
<pre class="lt" style="font-family:monospace;">doc <span style="color: #000080;">-</span>n</pre>
<p>Now let's import a data file from the Samples folder. We will first use the <b><a class="external text" href="../../XFunction/X-Function/DlgFile.html">dlgfile</a></b> X-function to locate the desired file:
</p>
<pre class="lt" style="font-family:monospace;">dlgfile gr<span style="color: #000000;">:</span><span style="color: #000080;">=</span>ASCII</pre>
<p>Then select the file <b>S15-125-03.dat</b> from the <b>\Samples\Import and Export</b> sub folder located in your Origin installation folder, and click <b>Open</b>.
</p><p>The above process will load the file path and name into a variable named <b>fname$</b>. You can examine the value of this variable by typing:
</p>
<pre class="lt" style="font-family:monospace;">fname<span style="color: #000080;">$</span><span style="color: #000080;">=</span></pre>
<p>Now let's import this files into the active workbook. We will use the <b><a class="external text" href="../../XFunction/X-Function/ImpASC.html">impasc</a></b> X-Function with options to control naming, so that the file name does not get assigned to the workbook:
</p>
<pre class="lt" style="font-family:monospace;">impasc Options.<span style="color: #000080;">Names</span>.<span style="color: #000080;">FNameToBk</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span></pre>
<p>Now we want to perform some data processing of the <b>Position</b> column. We first define a <a href="../../LabTalk/LabTalk/Range_Notation.html" title="LabTalk:Range Notation">range variable</a> to point to this column.:
</p>
<pre class="lt" style="font-family:monospace;">range rpos <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Position&quot;</span></pre>
<p>Since the column we select is also the 4th column in the current worksheet, we can also use index number to specify it.
</p>
<pre class="lt" style="font-family:monospace;">range rpos <span style="color: #000080;">=</span> <span style="color: #0000dd;">4</span></pre>
<p>You can check what range variables are currently defined, using this command:
</p>
<pre class="lt" style="font-family:monospace;">list a</pre>
<p>We now normalize the column so that the values go from 0 to 100. To check what X-Functions are available for normalization, we can use the command:
</p>
<pre class="lt" style="font-family:monospace;">lx <span style="color: #000080;">*</span>norm<span style="color: #000080;">*</span></pre>
<p>The above command will dump X-Functions where the name contains <b>norm</b>. There are several X-Functions for normalizing data. For our current purpose we will use the <b><a class="external text" href="../../XFunction/X-Function/Rnormalize.html">rnormalize</a></b> X-Function. 
</p><p>To get help on the syntax for this particular X-Function, you can type:
</p>
<pre class="lt" style="font-family:monospace;">rnormalize <span style="color: #000080;">-</span>h</pre>
<p>to dump the information, or type:
</p>
<pre class="lt" style="font-family:monospace;">help rnormalize</pre>
<p>to open the help file.
</p><p>Let us now normalize the position column:
</p>
<pre class="lt" style="font-family:monospace;">rnormalize irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span>rpos method<span style="color: #000000;">:</span><span style="color: #000080;">=</span>range100 orng<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>input<span style="color: #000080;">&gt;</span></pre>
<p>The normalized data will be placed in the same column, replacing the original data, as we set the <a class="external text" href="../../XFunction/X-Function/Output_Notations.html">output range variable</a> <b>orng</b> to be <b>&lt;input&gt;</b>.
</p><p>When using X-Functions, you can <a href="../../LabTalk/Script/X-Functions_Overview.html" title="Script:X-Functions Overview">leave out the variable names</a>, if they are specified in the correct order. The above line of code can therefore be written as:
</p>
<pre class="lt" style="font-family:monospace;">rnormalize rpos range100 orng<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>input<span style="color: #000080;">&gt;</span></pre>
<p>The reason we still specified the name <b>orng</b> is because there are other variables that precede this particular variable, which are not relevant to our current calculation and were therefore not included in the command.
</p><p><br />
Now let's do some changes to the folder in the project. There are several X-Functions for <a href="../../LabTalk/Script/Managing_the_Project.html" title="Script:Managing the Project">managing project</a> folders, and we will use some of them:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Get the name of the current worksheet</span>
string name<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> wks.<span style="color: #000080;">name</span><span style="color: #000080;">$</span>;
<span style="color: #008000;">// go to root folder</span>
pe_cd ..;
<span style="color: #008000;">// rename Folder1 to be the same as worksheet</span>
pe_rename Folder1 name<span style="color: #000080;">$</span>;</pre>
<p>Now let's list all the sub folders and workbooks under the root folder:
</p>
<pre class="lt" style="font-family:monospace;">pe_dir</pre>
<p>Finally, let's save the <a href="../../LabTalk/Script/Managing_the_Project.html" title="Script:Managing the Project">Origin Project</a> to the <a class="external text" href="../../UserGuide/UserGuide/The_User_Files_Folder.html">User Files Folder</a>. The location of the user files folder is stored in the string register <b><a href="../../LabTalk/LabTalk/String_registers.html" title="LabTalk:String registers">%Y</a></b>. You can examine where your User Files Folder is by checking this variable:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000080;">%</span>Y <span style="color: #000080;">=</span></pre>
<p>Now let's use the <b><a href="../../LabTalk/LabTalk/Save_(command).html" title="LabTalk:Save (command)">save</a></b> command to save our project to User Files Folder, with the name MyProject.opj.
</p>
<pre class="lt" style="font-family:monospace;">save <span style="color: #000080;">%</span>yMyProject</pre>
<p>In the above command <b>%Y</b> will be replaced with the User Files Folder path, and thus our project will be saved in the correct location.
</p>
<h2><a name="Using_CTRL_.2B_SHIFT_to_capture_Menu_Command_and_Toolbar_Button_Script"></a><span class="mw-headline">Using CTRL + SHIFT to capture Menu Command and Toolbar Button Script</span></h2>
<p>Many of the actions of menu commands and toolbar buttons in Origin's graphical user interface (GUI) are implemented in LabTalk script. When this is the case, you can locate and view this script in the following way:
</p>
<ol><li> Press CTRL + SHIFT on your keyboard and hold.</li>
<li> Click on the menu command or toolbar button.</li></ol>
<p>This, then, becomes a source of usable LabTalk Script that you can incorporate into your custom routines.
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Getting_Started_with_LabTalk/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>Origin 2024b support CTRL + SHIFT to capture Mini Toolbar Button Script 
</p></td></tr></table>
<h3><a name="Example"></a><span class="mw-headline">Example</span></h3>
<ol><li> Open a new workbook, select columns A and B, then right-click and choose <b>Fill Columns With</b>: <b>Row Numbers</b>. </li>
<li> With your worksheet active, press CTRL + SHIFT and click the <b>Scatter</b> toolbar button <a  class="image"><img alt="Button Scatter.png" src="../images/Getting_Started_with_LabTalk/Button_Scatter.png?v=0" width="22"  /></a>  (or choose <b>Plot</b> &gt; <b>2D</b>: <b>Scatter</b>: <b>Scatter</b>).</li></ol>
<p>This does two things:
</p>
<ul><li> Opens Code Builder (Origin's Integrated Development Environment) to the line in Plot.ogs (an Origin system script file) to the section that executes the toolbar button or menu command.</li>
<li> Writes the menu id and run.section command out to the Script Window.</li></ul>
<pre class="lt" style="font-family:monospace;">Menu id<span style="color: #000080;">=</span><span style="color: #0000dd;">33248</span> <span style="color: #000000;">&#40;</span>0x81e0<span style="color: #000000;">&#41;</span>
run.<span style="color: #000080;">section</span><span style="color: #000000;">&#40;</span>Plot,Scatter<span style="color: #000000;">&#41;</span></pre>
<p>Information from both of these lines of script can be reused in your own scripts, to create a line plot. To see this at work, make sure that the workbook with your two columns of highlighted row numbers is still active, then go to the Script Window (<b>Window</b>: <b>Script Window</b>), type either of the following, then press Enter:
</p>
<pre class="lt" style="font-family:monospace;">menu <span style="color: #000080;">-</span>e <span style="color: #0000dd;">33248</span></pre>
<pre class="lt" style="font-family:monospace;">run.<span style="color: #000080;">section</span><span style="color: #000000;">&#40;</span>Plot, Scatter<span style="color: #000000;">&#41;</span></pre>
<p><br />
<i><b>For more information, see these topics:</b></i>
</p>
<ul><li> <a class="external text" href="../../QuickHelp/QuickHelp/How_to_open_the_dialog_in_Origin_by_using_LabTalk_Script.html">FAQ-666 How to open the dialog in Origin by using LabTalk Script?</a>.</li>
<li> <a href="../../LabTalk/LabTalk/Menu_(command).html#-d.3B_Delete_the_menu_command_at_position_position_in_the_active_menu" title="LabTalk:Menu (command)">The menu command's "-e" switch</a>.</li>
<li> Origin's <a href="../../LabTalk/LabTalk/Run_(object).html#Properties:" title="LabTalk:Run (object)">run.section</a> method.</li></ul>
<h2><a name="Where_to_Go_from_Here.3F"></a><span class="mw-headline">Where to Go from Here?</span></h2>
<p>The answer to this question is the subject of the rest of the LabTalk Scripting Guide.  The examples above only scratch the surface, but have hopefully provided enough information for you to get a quick start and excited to learn more. The next chapter lists various resources available for learning LabTalk.
</p>

