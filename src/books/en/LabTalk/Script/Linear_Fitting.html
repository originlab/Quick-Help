<h1 class="firstHeading">2.13.3.1 Linear, Polynomial and Multiple Regression</h1><p class='urlname' style='display: none'>Linear-Fitting</p>
<p><span class="OIndex" style="display:none">Fit Line</span><span class="OIndex" style="display:none">Fit Polynomial</span><span class="OIndex" style="display:none">Regression</span><span class="OIndex" style="display:none">Multiple Regression</span>
</p><p>In LabTalk scripts, three simple quick use X-Functions, <b><a class="external text" href="../../XFunction/X-Function/FitLR.html">fitLR</a></b>, <b><a class="external text" href="../../XFunction/X-Function/Fitpoly.html">fitPoly</a></b>, and <b><a class="external text" href="../../XFunction/X-Function/FitMR.html">fitMR</a></b>, are available for performing linear regression, polynomial regression, and multiple linear regression, respectively. And the <b>-h</b> switch can be used to see the argument list.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Linear_Regression"><span class="tocnumber">1</span> <span class="toctext">Linear Regression</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Polynomial_Regression"><span class="tocnumber">2</span> <span class="toctext">Polynomial Regression</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Multiple_Linear_Regression"><span class="tocnumber">3</span> <span class="toctext">Multiple Linear Regression</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Run_Operation_Classes_to_Perform_Regression"><span class="tocnumber">4</span> <span class="toctext">Run Operation Classes to Perform Regression</span></a></li>
</ul>
</div>

<h2><a name="Linear_Regression"></a><span class="mw-headline">Linear Regression</span></h2>
<p><span class="OIndex" style="display:none">Linear Fit</span><span class="OIndex" style="display:none">Linear Regression</span>
<b><a class="external text" href="../../XFunction/X-Function/FitLR.html">fitLR</a></b> finds a best fit straight line to a given dataset.
</p>
<pre class="lt" style="font-family:monospace;">newbook;  <span style="color: #008000;">// create a new book</span>

<span style="color: #008000;">// file name</span>
string strFile<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Curve Fitting\Linear Fit.dat&quot;</span>;  
impasc fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>strFile<span style="color: #000080;">$</span>;  <span style="color: #008000;">// import the data</span>
int nn <span style="color: #000080;">=</span> wks.<span style="color: #000080;">ncols</span>; 
wks.<span style="color: #000080;">addcol</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// Add a new column</span>
wks.<span style="color: #000080;">col</span><span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>nn<span style="color: #000080;">+</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>.<span style="color: #000080;">lname</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> FitData;  <span style="color: #008000;">// Assign a long name to the new column</span>

<span style="color: #008000;">// perform linear fit on the first ten points of column 1 (X) and column 2 (Y)</span>
<span style="color: #008000;">// and the fitted data is output to FitData column</span>
fitLR iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> oy<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;FitData&quot;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// a tree object named fitLR is created, and contains the output values</span>
fitLR.<span style="color: #000080;">a</span> <span style="color: #000080;">=</span>&#160;;  <span style="color: #008000;">// output the fitted intercept</span>
fitLR.<span style="color: #000080;">b</span> <span style="color: #000080;">=</span>&#160;;  <span style="color: #008000;">// output the fitted slope</span>
fitLR.<span style="color: #000080;">=</span>&#160;;  <span style="color: #008000;">// output all the results, which include fitted intercept and slope</span></pre>
<p>More examples about linear regression can be found in <a href="../../LabTalk/LabTalk/Curve_Fitting.html#Linear_Fit" title="LabTalk:Curve Fitting">Curve Fitting sample page</a>, or under <b>Fitting</b> category in <b>XF Script Dialog</b> (press F11 to open).
</p>
<h2><a name="Polynomial_Regression"></a><span class="mw-headline">Polynomial Regression</span></h2>
<p><span class="OIndex" style="display:none">Polynomial Fit</span>
Polynomial fitting is a special case wherein the fitting function is mathematically non-linear, but an analytical (non-iterative) solution is obtained. In LabTalk, <b><a class="external text" href="../../XFunction/X-Function/Fitpoly.html">fitPoly</a></b> is used to control polynomial fitting.
</p>
<pre class="lt" style="font-family:monospace;">newbook;  <span style="color: #008000;">// create a new book;</span>

<span style="color: #008000;">// file name</span>
string strFile<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Curve Fitting\Polynomial Fit.dat&quot;</span>;
impasc fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>strFile<span style="color: #000080;">$</span>;  <span style="color: #008000;">// import data</span>

page.<span style="color: #000080;">xlcolname</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; <span style="color: #008000;">// turn off Spreadsheet Cell Notation firstly</span>
wks.<span style="color: #000080;">addcol</span><span style="color: #000000;">&#40;</span>PolyCoef<span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// add a new column for polynomial coefficients</span>
wks.<span style="color: #000080;">addcol</span><span style="color: #000000;">&#40;</span>FittedX<span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// add a new column for fitted X values</span>
wks.<span style="color: #000080;">addcol</span><span style="color: #000000;">&#40;</span>FittedY<span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// add a new column for fitted Y values</span>

<span style="color: #008000;">// perform polynomial fitting on column 1 (X) and column 3 (Y)</span>
<span style="color: #008000;">// polynomial order is 3</span>
fitPoly iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span> polyorder<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span> coef<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span>PolyCoef<span style="color: #000000;">&#41;</span> oy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#40;</span>col<span style="color: #000000;">&#40;</span>FittedX<span style="color: #000000;">&#41;</span>,col<span style="color: #000000;">&#40;</span>FittedY<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// the results are stored in the tree named fitPoly, output it</span>
fitPoly.<span style="color: #000080;">=</span>&#160;;</pre>
<p>Additionally, <b><a class="external text" href="../../XFunction/X-Function/Fitpoly.html">fitPoly</a></b> provides the outputs for adjusted residual sum of squares, coefficient of determination, and errors in polynomial coefficients. For more detailed examples, please refer to <a href="../../LabTalk/LabTalk/Curve_Fitting.html#Polynomial_Fit" title="LabTalk:Curve Fitting">Curve Fitting sample page</a>, or  <b>Fitting</b> category in <b>XF Script Dialog</b> (press F11 to open).
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Linear_Fitting/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>For the <a class="external text" href="../../UserGuide/UserGuide/Column_Short_Name_Restriction.html">Spreadsheet Cell Notation</a> in the workbook, please see <a class="external text" href="../../QuickHelp/QuickHelp/Turn_off_spreadsheet_cell_notation.html"><b>FAQ-849</b></a> for more information.
</p></td></tr></table>
<h2><a name="Multiple_Linear_Regression"></a><span class="mw-headline">Multiple Linear Regression</span></h2>
<p>Multiple linear regression studies the relationship between several predictor variables and a response variable, which is an extension of simple linear regression.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// create a new book and import some data</span>
newbook;
fn<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Curve Fitting\Multiple Linear Regression.dat&quot;</span>;
impasc fn<span style="color: #000080;">$</span>;
page.<span style="color: #000080;">xlcolname</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; <span style="color: #008000;">//turn off Spreadsheet Cell Notation firstly</span>
wks.<span style="color: #000080;">addcol</span><span style="color: #000000;">&#40;</span>FitValue<span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// add a column for fitted values of dependent</span>

<span style="color: #008000;">// perform multiple linear regression</span>
<span style="color: #008000;">// column D is dependent, and column A, B, and C are independents</span>
<span style="color: #008000;">// the output results are stored in a tree, tr</span>
fitMR dep<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span>D<span style="color: #000000;">&#41;</span> indep<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span><span style="color: #000000;">:</span>col<span style="color: #000000;">&#40;</span>C<span style="color: #000000;">&#41;</span> mrtree<span style="color: #000000;">:</span><span style="color: #000080;">=</span>tr odep<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span>FitValue<span style="color: #000000;">&#41;</span>;
tr.<span style="color: #000080;">=</span>&#160;;  <span style="color: #008000;">// output the result tree</span></pre>
<p>For more examples, please refer to <a href="../../LabTalk/LabTalk/Curve_Fitting.html" title="LabTalk:Curve Fitting">Curve Fitting sample page</a>, or <b>Fitting</b> category in <b>XF Script Dialog</b> (press F11 to open).
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Linear_Fitting/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>For the <a class="external text" href="../../UserGuide/UserGuide/Column_Short_Name_Restriction.html">Spreadsheet Cell Notation</a> in the workbook, please see <a class="external text" href="../../QuickHelp/QuickHelp/Turn_off_spreadsheet_cell_notation.html"><b>FAQ-849</b></a> for more information.
</p></td></tr></table>
<h2><a name="Run_Operation_Classes_to_Perform_Regression"></a><span class="mw-headline">Run Operation Classes to Perform Regression</span></h2>
<p>The X-Functions depicted above are for simple quick use only to perform linear, polynomial and multiple regression. That is to say, some quantities are not available when using these three X-Functions. For full access to all quantities, the X-Function <b><a class="external text" href="../../XFunction/X-Function/Xop.html">xop</a></b> is provided to invoke the internal menu commands (operation commands), so to run the corresponding operation classes to perform regression. The following example shows how to use the X-Function <b><a class="external text" href="../../XFunction/X-Function/Xop.html">xop</a></b> to perform linear fit, and generate a report.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// create a new book and import data</span>
newbook;
fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Curve Fitting\Linear Fit.dat&quot;</span>;
impasc fname<span style="color: #000080;">$</span>;

tree lrGUI;  <span style="color: #008000;">// GUI tree for linear fit</span>
<span style="color: #008000;">// initialize the GUI tree, with the FitLinear class</span>
xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>init classname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>FitLinear iotrgui<span style="color: #000000;">:</span><span style="color: #000080;">=</span>lrGUI;

<span style="color: #008000;">// specify the input data in the GUI tree</span>
lrGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Range1</span>.<span style="color: #000080;">X</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span>;
lrGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Range1</span>.<span style="color: #000080;">Y</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> col<span style="color: #000000;">&#40;</span>C<span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// perform linear fit and generate a report with the prepared GUI tree</span>
xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>report iotrgui<span style="color: #000000;">:</span><span style="color: #000080;">=</span>lrGUI;

xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>cleanup;  <span style="color: #008000;">// clean up linear fit operation objects after fitting</span></pre>


