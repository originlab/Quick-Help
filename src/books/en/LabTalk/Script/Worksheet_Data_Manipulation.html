<h1 class="firstHeading">2.7.2.2 Worksheet Data Manipulation</h1><p class='urlname' style='display: none'>Worksheet-Data-Manipulation</p>
<p><br />
</p><p><br />
In this section we present examples of X-Functions for basic data processing. For direct access to worksheet data, see <a href="../../LabTalk/LabTalk/Range_Notation.html#Worksheet_Data" title="LabTalk:Range Notation">Range Notation</a>.
<span class="OIndex" style="display:none">worksheet</span>
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Copy_Worksheet_Data"><span class="tocnumber">1</span> <span class="toctext">Copy Worksheet Data</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Copy_a_Worksheet"><span class="tocnumber">1.1</span> <span class="toctext">Copy a Worksheet</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Copy_a_Range_of_CellsCopy_Range"><span class="tocnumber">1.2</span> <span class="toctext">Copy a Range of Cells<span class="OIndex" style="display:none">Copy Range</span></span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4"><a href="#Reduce_Worksheet_Data"><span class="tocnumber">2</span> <span class="toctext">Reduce Worksheet Data</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="#Examples"><span class="tocnumber">2.1</span> <span class="toctext">Examples</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Extract_Worksheet_Data"><span class="tocnumber">3</span> <span class="toctext">Extract Worksheet Data</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#Output_To_New_Workbook"><span class="tocnumber">3.1</span> <span class="toctext">Output To New Workbook</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Use_Wildcard_Search"><span class="tocnumber">3.2</span> <span class="toctext">Use Wildcard Search</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-9"><a href="#Delete_Worksheet_Data"><span class="tocnumber">4</span> <span class="toctext">Delete Worksheet Data</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#Sort_Worksheet"><span class="tocnumber">5</span> <span class="toctext">Sort Worksheet</span></a></li>
<li class="toclevel-1 tocsection-11"><a href="#Split_Worksheet"><span class="tocnumber">6</span> <span class="toctext">Split Worksheet</span></a></li>
<li class="toclevel-1 tocsection-12"><a href="#Unstack.2FStack_Categorical_Data"><span class="tocnumber">7</span> <span class="toctext">Unstack/Stack Categorical Data</span></a>
<ul>
<li class="toclevel-2 tocsection-13"><a href="#Unstack_Worksheet_Columns"><span class="tocnumber">7.1</span> <span class="toctext">Unstack Worksheet Columns</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#Stack_Worksheet_Columns"><span class="tocnumber">7.2</span> <span class="toctext">Stack Worksheet Columns</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-15"><a href="#Pivot_Table"><span class="tocnumber">8</span> <span class="toctext">Pivot Table</span></a></li>
<li class="toclevel-1 tocsection-16"><a href="#Worksheet_Filter"><span class="tocnumber">9</span> <span class="toctext">Worksheet Filter</span></a></li>
</ul>
</div>

<h2><a name="Copy_Worksheet_Data"></a><span class="mw-headline">Copy Worksheet Data</span></h2>
<h3><a name="Copy_a_Worksheet"></a><span class="mw-headline">Copy a Worksheet</span></h3>
<p>The <a class="external text" href="../../XFunction/X-Function/Wcopy.html">wcopy</a> X-Function is used to create a <span class="OIndex">copy worksheet</span><span class="OIndex HasShownIndex" style="display:none">worksheet, copy</span> of the specified worksheet. 
</p><p>The following example duplicates the current worksheet, creating a new workbook with the copied worksheet:
</p>
<pre class="lt" style="font-family:monospace;">wcopy <span style="color: #0000dd;">1</span><span style="color: #000080;">!</span> <span style="color: #000000;">&#91;</span><span style="color: #000080;">&lt;</span>new<span style="color: #000080;">&gt;</span><span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span>;</pre>
<h3><a name="Copy_a_Range_of_CellsCopy_Range"></a><span class="mw-headline">Copy a Range of Cells<span class="OIndex" style="display:none">Copy Range</span></span></h3>
<p>The <a class="external text" href="../../XFunction/X-Function/Wrcopy.html">wrcopy</a> X-Function is used to copy a range of cells from one worksheet to another.  It also allows you to specify a source row to be used as the Long Names in the destination worksheet.
</p><p>The following script copies rows from 5 to 9 of [book1]sheet1! to a worksheet named CopiedValues in Book1 (if the worksheet does not exist it will be created), and assigns the values in row 4 from [book1]sheet1! to the long name of the destination worksheet, [book1]CopiedValues!
</p>
<pre class="lt" style="font-family:monospace;">wrcopy iw<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>book1<span style="color: #000000;">&#93;</span>sheet1<span style="color: #000080;">!</span> r1<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">5</span> r2<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">10</span> name<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span> ow<span style="color: #000000;">:</span><span style="color: #000080;">=</span>CopiedValues<span style="color: #000080;">!</span>;</pre>
<p>To copy column and matrix object, please refer to <a href="../../LabTalk/Script/Worksheet_Column_Data_Manipulation.html#Copy_Column" title="Script:Worksheet Column Data Manipulation">Copy Column</a> and <a href="../../LabTalk/Script/Matrix_Object_Data_Manipulation.html#Copy_Matrix_Data" title="Script:Matrix Object Data Manipulation">Copy Matrix Data</a> respectively.
</p>
<h2><a name="Reduce_Worksheet_Data"></a><span class="mw-headline">Reduce Worksheet Data</span></h2>
<p><span class="OIndex" style="display:none">Reduce Worksheet Data</span><span class="OIndex" style="display:none">worksheet, reduce data</span>
</p><p>Origin has several data reducing X-Functions like <a class="external text" href="../../XFunction/X-Function/Reduce_ex.html">reduce_ex</a>, <a class="external text" href="../../XFunction/X-Function/Reducedup.html">reducedup</a>, <a class="external text" href="../../XFunction/X-Function/Reducerows.html">reducerows</a> and <a class="external text" href="../../XFunction/X-Function/Reducexy.html">reducexy</a>. These X-Functions provide different ways of creating a smaller dataset from a larger one.  Which one you choose will depend on what type of input data you have, and what type of output data you want.
</p>
<h3><a name="Examples"></a><span class="mw-headline">Examples</span></h3>
<p>The following script will create a new X and Y column where the Y will be the mean value for each of the duplicate X values.
</p>
<pre class="lt" style="font-family:monospace;">reducedup col<span style="color: #000000;">&#40;</span>B<span style="color: #000000;">&#41;</span>;</pre>
<p>The following script will reduce the active selection (which can be multiple columns or an entire worksheet, independent of X or Y plotting designation) by a factor of 3.  It will remove rows 2 and 3 and then rows 5 and 6, leaving rows 1 and 4, etc.  By default, the reduced values will go to a new worksheet.
</p>
<pre class="lt" style="font-family:monospace;">reducerows npts<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span>;</pre>
<p>The following script will average every <i>n</i> numbers (5 in the example below) in column A and output the average of each group to column B.  It is the same as the <a href="../../LabTalk/LabTalk/Ave_(function).html" title="LabTalk:Ave (function)">ave</a> LabTalk function, which would be written as col(b)=ave(col(a),5):
</p>
<pre class="lt" style="font-family:monospace;">reducerows irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span> npts<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">5</span> method<span style="color: #000000;">:</span><span style="color: #000080;">=</span>ave rd<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span>b<span style="color: #000000;">&#41;</span>;</pre>
<h2><a name="Extract_Worksheet_Data"></a><span class="mw-headline">Extract Worksheet Data</span></h2>
<p><span class="OIndex" style="display:none">worksheet, extract data</span><span class="OIndex" style="display:none">Extract Worksheet Data</span>
</p><p>Partial data from a worksheet can be extracted using conditions involving the data columns, using the <a class="external text" href="../../XFunction/X-Function/Wxt.html"><b>wxt</b></a> X-function.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Import a sample data file</span>
newbook;
string fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;samples\statistics\automobile.dat&quot;</span>;
impasc;
<span style="color: #008000;">// Define range using some of the columns</span>
range rYear<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>, rMake<span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>, rHP<span style="color: #000080;">=</span><span style="color: #0000dd;">3</span>;
type <span style="color: #ff00ff;">&quot;Number of rows in raw data sheet= $(rYear.GetSize())&quot;</span>;
<span style="color: #008000;">// Define a condition string and extract data </span>
<span style="color: #008000;">// to a new named sheet in the same book</span>
string strCond<span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;rYear &gt;= 1996 and rHP&lt;70 and rHP&gt;60 and rMake[i]$=Honda&quot;</span>;
wxt test<span style="color: #000000;">:</span><span style="color: #000080;">=</span>strCond<span style="color: #000080;">$</span> ow<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Extracted Rows&quot;</span><span style="color: #000080;">!</span> num<span style="color: #000000;">:</span><span style="color: #000080;">=</span>nExtRows;
type <span style="color: #ff00ff;">&quot;Number of rows extracted = $(nExtRows)&quot;</span>;</pre>
<h3><a name="Output_To_New_Workbook"></a><span class="mw-headline">Output To New Workbook</span></h3>
<p>You can also direct the output to a new workbook, instead of a new worksheet in the existing workbook, by changing the following line:
</p>
<pre class="lt" style="font-family:monospace;">wxt test<span style="color: #000000;">:</span><span style="color: #000080;">=</span>strCond<span style="color: #000080;">$</span> ow<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span><span style="color: #000080;">&lt;</span>new name<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Result&quot;</span><span style="color: #000080;">&gt;</span><span style="color: #000000;">&#93;</span><span style="color: #ff00ff;">&quot;Extracted&quot;</span><span style="color: #000080;">!</span> num<span style="color: #000000;">:</span><span style="color: #000080;">=</span>nExtRows;</pre>
<p>As you can see, the only difference from the earlier code is that we have added the workbook part of the range notation for the <b>ow</b> variable, with the <b>&lt;new&gt;</b> keyword. (show links and indexing to &lt;new&gt; modifiers, options, like template, name, etc)
</p>
<h3><a name="Use_Wildcard_Search"></a><span class="mw-headline">Use Wildcard Search</span></h3>
<p>LabTalk uses * and&#160;? characters for <span class="OIndex">wildcard</span> in string comparison. You can try changing the <b>strCond</b> as follows:
</p>
<pre class="lt" style="font-family:monospace;">string strCond<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;rYear &gt;= 1996 and rHP&lt;70 and rHP&gt;60 and rMake[i]$=*o*&quot;</span>;</pre>
<p>to see all the other makes of cars with the letter <b>o</b>.
</p>
<h2><a name="Delete_Worksheet_Data"></a><span class="mw-headline">Delete Worksheet Data</span></h2>
<p><span class="OIndex" style="display:none">Delete Worksheet Data</span>
</p><p>Deleting the <i>N</i>th row can be accomplished with the <a class="external text" href="../../XFunction/X-Function/Reducerows.html"><b>reducerows</b></a> X-Function, described above.
</p><p>This example demonstrates deleting every <i>N</i>th column in a worksheet using a <a href="../../LabTalk/LabTalk/Flow_of_Control.html" title="LabTalk:Flow of Control">for-loop</a>: 
</p>
<pre class="lt" style="font-family:monospace;">int ndel <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>; <span style="color: #008000;">// change this number as needed;</span>
int ncols <span style="color: #000080;">=</span> wks.<span style="color: #000080;">ncols</span>;
int nlast <span style="color: #000080;">=</span> ncols <span style="color: #000080;">-</span> mod<span style="color: #000000;">&#40;</span>ncols, ndel<span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// Need to delete from the right to the left</span>
for<span style="color: #000000;">&#40;</span>int ii <span style="color: #000080;">=</span> nlast; ii <span style="color: #000080;">&gt;</span> <span style="color: #0000dd;">0</span>; ii <span style="color: #000080;">-</span><span style="color: #000080;">=</span> ndel<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
   delete wcol<span style="color: #000000;">&#40;</span><span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>ii<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Sort_Worksheet"></a><span class="mw-headline">Sort Worksheet</span></h2>
<p><span class="OIndex" style="display:none">Sort Worksheet</span><span class="OIndex" style="display:none">worksheet, sort</span>
</p><p>The following example shows how to perform nested sorting of data in a worksheet using the <a class="external text" href="../../XFunction/X-Function/Wsort.html"><b>wsort</b></a> X-Function:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Start a new book and import a sample file</span>
newbook;
string fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Statistics\automobile.dat&quot;</span>;
impasc;
<span style="color: #008000;">// Set up vectors to specify nesting of columns and order of sorting;</span>
<span style="color: #008000;">// Sort nested: primary col 2, then col 1, then col 3:</span>
dataset dsCols <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">2</span>, <span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">3</span><span style="color: #000000;">&#125;</span>;

<span style="color: #008000;">// Sort col2 ascending, col 1 ascending, col 3 descending:   </span>
dataset dsOrder <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">0</span><span style="color: #000000;">&#125;</span>;  

wsort nestcols<span style="color: #000000;">:</span><span style="color: #000080;">=</span>dsCols order<span style="color: #000000;">:</span><span style="color: #000080;">=</span>dsOrder;</pre>
<h2><a name="Split_Worksheet"></a><span class="mw-headline">Split Worksheet</span></h2>
<p>Origin provides the X-Function, <a class="external text" href="../../XFunction/X-Function/Wsplit.html">wsplit</a>, for the purpose of splitting one worksheet's columns into multiple worksheets.
</p><p>The example below is going to import multiple CSV files, and then get the Amplitude data from all the data file into a worksheet, and then convert this worksheet to matrix to make a contour plot.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create a new workbook</span>
newbook;

<span style="color: #008000;">// Find all csv files in the specified folder</span>
string strPath<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Batch Processing\&quot;</span>;
findfiles path<span style="color: #000000;">:</span><span style="color: #000080;">=</span>strPath<span style="color: #000080;">$</span> fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>csvFiles<span style="color: #000080;">$</span> ext<span style="color: #000000;">:</span><span style="color: #000080;">=</span>csv;

<span style="color: #008000;">// Import all found csv files into one worksheet</span>
impCSV 	fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>csvFiles<span style="color: #000080;">$</span>  <span style="color: #008000;">// All found csv files</span>
	options.<span style="color: #000080;">Mode</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>  <span style="color: #008000;">// From second file, start new column</span>
	options.<span style="color: #000080;">names</span>.<span style="color: #000080;">FNameToSht</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>  <span style="color: #008000;">// Not rename worksheet</span>
	options.<span style="color: #000080;">names</span>.<span style="color: #000080;">FNameToBk</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>  <span style="color: #008000;">// Not rename workbook</span>
	options.<span style="color: #000080;">HeaderLines</span>.<span style="color: #000080;">SubHeaderLines</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>  <span style="color: #008000;">// Two subheader lines</span>
	options.<span style="color: #000080;">HeaderLines</span>.<span style="color: #000080;">LongNames</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>  <span style="color: #008000;">// First subheader line is LongName</span>
	options.<span style="color: #000080;">HeaderLines</span>.<span style="color: #000080;">Units</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>;  <span style="color: #008000;">// Second subheader line is Units</span>

<span style="color: #008000;">// Split the worksheet according to the Long Name</span>
<span style="color: #008000;">// The columns with the same Long Name will be in the same result worksheet</span>
<span style="color: #008000;">// All the result worksheets will be in the same new workbook</span>
wsplit mode<span style="color: #000000;">:</span><span style="color: #000080;">=</span>label label<span style="color: #000000;">:</span><span style="color: #000080;">=</span>L;

<span style="color: #008000;">// Activate the Amplitude worksheet</span>
page.<span style="color: #000080;">active</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Amplitude;

<span style="color: #008000;">// Convert the Amplitude worksheet to matrix directly</span>
w2m;

<span style="color: #008000;">// Make a contour for the amplitude</span>
worksheet <span style="color: #000080;">-</span>p <span style="color: #0000dd;">226</span> contour;</pre>
<h2><a name="Unstack.2FStack_Categorical_Data"></a><span class="mw-headline">Unstack/Stack Categorical Data</span></h2>
<p><span class="OIndex" style="display:none">Unstack Data</span><span class="OIndex" style="display:none">Stack Data</span>
</p>
<h3><a name="Unstack_Worksheet_Columns"></a><span class="mw-headline">Unstack Worksheet Columns</span></h3>
<p>At times unstacking categorical data is desirable for analysis and/or plotting purposes.  The <a class="external text" href="../../XFunction/X-Function/Wunstackcol.html">wunstackcol</a> X-Function is the most convenient way to perform this task from script.
</p><p>In this example, categorical data is imported, and we want to unstack the data by a particular category, which we specify with the input range <b>irng2</b>.  The data to be displayed (by category) is referenced by input range <b>irng1</b>.  In this example, the column ranges are input directly, but range variables can also be used.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Import automobile data </span>
newbook; 
string fpath<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;\Samples\Statistics\Automobile.dat&quot;</span>; 
string fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> fpath<span style="color: #000080;">$</span>; 
impasc;

<span style="color: #008000;">// Unstack all other columns using automobile Make, stored in col 2</span>
<span style="color: #008000;">// Place &quot;Make&quot; in Comments row of output sheet</span>
wunstackcol irng1<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">3</span><span style="color: #000000;">:</span><span style="color: #0000dd;">7</span><span style="color: #000000;">&#41;</span> irng2<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span> label<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Comments&quot;</span>;</pre>
<p>The result is a new worksheet with the unstacked data.
</p>
<h3><a name="Stack_Worksheet_Columns"></a><span class="mw-headline">Stack Worksheet Columns</span></h3>
<p>Staking categorical data is something like reverse operation of unstacking categorical data. In the original dataset, samples belong to different groups is stored in different columns. After stacking, the samples will be in different rows in the same column, with an additional column in the worksheet providing the group information. You can use <a class="external text" href="../../XFunction/X-Function/Wstackcol.html">wstackcol</a> to stack worksheet columns.
</p><p>In the following example, we open a workbook with categorical data first. And then with the first worksheet activated, and stack column B, C, and D by rows, including another column to be A. 
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Open a workbook</span>
string strBook<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span>;
strBook<span style="color: #000080;">$</span> <span style="color: #000080;">+</span><span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Samples\Statistics\Body.ogw&quot;</span>;
doc <span style="color: #000080;">-</span>o <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>strBook<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Stack column B, C, D in Male worksheet</span>
<span style="color: #008000;">// Include column A as another column</span>
<span style="color: #008000;">// Method is By Rows</span>
wstackcol irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">:</span><span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span> tr.<span style="color: #000080;">identifiers</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#123;</span>L<span style="color: #000000;">&#125;</span> include<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> method<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;</pre>
<p>The result is a new worksheet in the same workbook with the stacked data.
</p>
<h2><a name="Pivot_Table"></a><span class="mw-headline">Pivot Table</span></h2>
<p>The <a class="external text" href="../../XFunction/X-Function/Wpivot.html">wpivot</a> X-Function is available for the purpose of quickly summarizing the data, so to analyze, compare, and detect the relationships in the data. That is an easy way to present data information.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create a new workbook</span>
<span style="color: #008000;">// And import a data file</span>
newbook;
fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Statistics\HouseholdCareSamples.xls&quot;</span>;
impExcel lname<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;

<span style="color: #008000;">// Make sure &quot;HQ Family Mart&quot; worksheet is activate</span>
<span style="color: #008000;">// And make a copy of this worksheet</span>
page.<span style="color: #000080;">active</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;HQ Family Mart&quot;</span>;
wcopy ow<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span><span style="color: #000080;">&lt;</span>new<span style="color: #000080;">&gt;</span><span style="color: #000000;">&#93;</span><span style="color: #ff00ff;">&quot;HQ Family Mart&quot;</span><span style="color: #000080;">!</span>;

<span style="color: #008000;">// Pivot table, row source is Make</span>
<span style="color: #008000;">// Column source is Brand, and data is Number in shelf</span>
<span style="color: #008000;">// The result will show the number of products in shelf</span>
<span style="color: #008000;">// for different brands and different makes</span>
wpivot 	row<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span>D<span style="color: #000000;">&#41;</span> col<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span>F<span style="color: #000000;">&#41;</span> data<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span>K<span style="color: #000000;">&#41;</span> 
	method<span style="color: #000000;">:</span><span style="color: #000080;">=</span>sum total<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> sort_total<span style="color: #000000;">:</span><span style="color: #000080;">=</span>no sum<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;

<span style="color: #008000;">// Activate the source data worksheet</span>
page.<span style="color: #000080;">active</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;HQ Family Mart&quot;</span>;

<span style="color: #008000;">// Pivot table, row source, column source and data column are the same</span>
<span style="color: #008000;">// For the smaller values, it will combine them across columns</span>
<span style="color: #008000;">// by 10% of the total</span>
<span style="color: #008000;">// In the result worksheet, the column info. is put to user-defined parameter rows</span>
<span style="color: #008000;">// The row name is the name of column's Long Name in source worksheet</span>
wpivot 	row<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span>D<span style="color: #000000;">&#41;</span> 
	col<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span>F<span style="color: #000000;">&#41;</span>
	data<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span>K<span style="color: #000000;">&#41;</span>
	method<span style="color: #000000;">:</span><span style="color: #000080;">=</span>sum total<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> sort_total<span style="color: #000000;">:</span><span style="color: #000080;">=</span>no sum<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> 
	dir<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col threshold<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">10</span>  <span style="color: #008000;">// Combine smaller values across column, by 10%</span>
	<span style="color: #008000;">// Put column info (from column's Long Name) to user-defined parameters row</span>
	pos<span style="color: #000000;">:</span><span style="color: #000080;">=</span>udl udlabel<span style="color: #000000;">:</span><span style="color: #000080;">=</span>L;</pre>
<h2><a name="Worksheet_Filter"></a><span class="mw-headline">Worksheet Filter</span></h2>
<p><span class="OIndex">Worksheet Filter</span> (<span class="OIndex">Data Filter</span>) in Origin is column-based filter to reduce rows of worksheet data by using the specified condition, so to hide the undesired rows for relevant data analysis and graphing. Three data formats are supported: numeric, text and date/time. In LabTalk, you can use the <a href="../../LabTalk/LabTalk/Wks.Col_(object)&amp;action=edit&amp;redlink=1.html" class="new" title="LabTalk:Wks.Col (object) (page does not exist)">wks.col</a> (wks.col.filter, wks.col.filter$, wks.col.filterenabled, wks.col.filterprescript$, and wks.col.filterx$) object to handle the data filter. And to run/re-apply the filter, use the <a href="../../LabTalk/LabTalk/Wks_(object).html#Methods" title="LabTalk:Wks (object)">wks.runfilter()</a> method.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create a new workbook, and import the data</span>
newbook;
string fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Statistics\Automobile.dat&quot;</span>;
impasc;

<span style="color: #008000;">// Set data filter for column 1, numeric type</span>
wks.<span style="color: #000080;">col1</span>.<span style="color: #000080;">filter</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;  <span style="color: #008000;">// Add filter</span>
wks.<span style="color: #000080;">col1</span>.<span style="color: #000080;">filterx</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> year;  <span style="color: #008000;">// Set the variable &quot;year&quot; to represent column 1</span>
<span style="color: #008000;">// Set filter condition, between 1995 and 2000</span>
wks.<span style="color: #000080;">col1</span>.<span style="color: #000080;">filter</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;year.between(1995,2000)&quot;</span>;  

<span style="color: #008000;">// Set data filter for column 2, text type</span>
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">filter</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;  <span style="color: #008000;">// Add filter</span>
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">filterx</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> make;  <span style="color: #008000;">// Set the variable &quot;make&quot; to represent column 2</span>
<span style="color: #008000;">// Set before query script</span>
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">filterprescript</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;string strFavorite$ = GMC&quot;</span>;
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">filter</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;make = strFavorite$&quot;</span>;  <span style="color: #008000;">// Set filter query string</span>

<span style="color: #008000;">// Run the worksheet filter</span>
wks.<span style="color: #000080;">runfilter</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Disable the filter in column 1</span>
wks.<span style="color: #000080;">col1</span>.<span style="color: #000080;">filterenabled</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;

<span style="color: #008000;">// Re-apply the worksheet filter</span>
wks.<span style="color: #000080;">runfilter</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</pre>
<p>To detect whether there is filter in a worksheet, you can use the <a href="../../LabTalk/LabTalk/Wks_(object).html#Methods" title="LabTalk:Wks (object)">wks.hasfilter()</a> method.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// If the active worksheet has filter, return 1, otherwise, return 0</span>
wks.<span style="color: #000080;">hasfilter</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span>&#160;;</pre>






