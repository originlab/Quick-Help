<h1 class="firstHeading">2.7.1.1 Basic Workbook Operation</h1><p>You can manipulate workbooks with the <a href="../../LabTalk/LabTalk/Page_(object).html" title="LabTalk:Page (object)">Page</a> object and <a href="../../LabTalk/LabTalk/Window_(command)&amp;action=edit&amp;redlink=1.html" class="new" title="LabTalk:Window (command) (page does not exist)">Window</a> command. You can also use <a href="../../LabTalk/Script/LabTalk-Supported_X-Functions.html#Data_Manipulation" title="Script:LabTalk-Supported X-Functions">Data Manipulation X-Functions</a>. With these tools, you can create new worksbooks, duplicate workbooks, save workbook as template, etc. Some practical examples are provided below.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Create_New_Workbook"><span class="tocnumber">1</span> <span class="toctext">Create New Workbook</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Open_Workbook"><span class="tocnumber">2</span> <span class="toctext">Open Workbook</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Save_Workbook"><span class="tocnumber">3</span> <span class="toctext">Save Workbook</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Close_Workbook"><span class="tocnumber">4</span> <span class="toctext">Close Workbook</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Show_or_Hide_Workbook"><span class="tocnumber">5</span> <span class="toctext">Show or Hide Workbook</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Name_and_Label_Workbook"><span class="tocnumber">6</span> <span class="toctext">Name and Label Workbook</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Activate_Workbook"><span class="tocnumber">7</span> <span class="toctext">Activate Workbook</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Delete_Workbook"><span class="tocnumber">8</span> <span class="toctext">Delete Workbook</span></a></li>
</ul>
</div>

<h2><a name="Create_New_Workbook"></a><span class="mw-headline">Create New Workbook</span></h2>
<p>The <a class="external text" href="../../XFunction/X-Function/Newbook.html">newbook</a> X-Function can be used to create new workbook. With the arguments of this X-Function, you can specify the newly created workbook with Long Name, number of sheets, template to use, whether hidden, etc.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//Create a new workbook with the Long Name &quot;MyResultBook&quot;</span>
newbook MyResultBook;

<span style="color: #008000;">// Create a new workbook with 3 worksheets</span>
<span style="color: #008000;">// and use &quot;MyData&quot; as Long Name and short name</span>
newbook name<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;MyData&quot;</span> sheet<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span> option<span style="color: #000000;">:</span><span style="color: #000080;">=</span>lsname;

<span style="color: #008000;">// Create a new hidden workbook</span>
<span style="color: #008000;">// and the workbook name is stored in myBkName$ variable</span>
newbook hidden<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> result<span style="color: #000000;">:</span><span style="color: #000080;">=</span>myBkName<span style="color: #000080;">$</span>;
<span style="color: #008000;">// Output workbook name</span>
myBkName<span style="color: #000080;">$</span> <span style="color: #000080;">=</span>&#160;;

<span style="color: #008000;">// By default, the built-in template &quot;Origin&quot; is used to </span>
<span style="color: #008000;">// create the new workbook, you can also use a specified template</span>
<span style="color: #008000;">// Create a new workbook with the XYZ template</span>
newbook template<span style="color: #000000;">:</span><span style="color: #000080;">=</span>XYZ;</pre>
<p>Also, the command <a href="../../LabTalk/LabTalk/Window_(command)&amp;action=edit&amp;redlink=1.html" class="new" title="LabTalk:Window (command) (page does not exist)">win -ti</a> is capable of creating a minimized new workbook from a template file.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create a new wookbook from the FFT template</span>
<span style="color: #008000;">// and Long Name and short name to be MyFFT, then minimize it</span>
win <span style="color: #000080;">-</span>ti wks FFT MyFFT;</pre>
<h2><a name="Open_Workbook"></a><span class="mw-headline">Open Workbook</span></h2>
<p>If the workbook with data is saved (as extension of ogw), it can be opened by the <a href="../../LabTalk/LabTalk/Document_(command)&amp;action=edit&amp;redlink=1.html" class="new" title="LabTalk:Document (command) (page does not exist)">doc -o</a> command.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// The path of the workbook to open</span>
string strName<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span>;
strName<span style="color: #000080;">$</span> <span style="color: #000080;">+</span><span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Samples\Graphing\Automobile Data.ogw&quot;</span>;
<span style="color: #008000;">// Open the workbook</span>
doc <span style="color: #000080;">-</span>o <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>strName<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>;</pre>
<h2><a name="Save_Workbook"></a><span class="mw-headline">Save Workbook</span></h2>
<p>Origin allows you to save a workbook with data to a file (*.ogw), or as a template without data (*.otw), and for the workbook with analysis, it is able to be saved as an analysis template (*.ogw).
</p>
<ol>
<li>The command <a href="../../LabTalk/LabTalk/Save_(command).html#-i.3B_Save_the_active_worksheet.2C_graph.2C_or_matrix_window_to_a_file" title="LabTalk:Save (command)">save -i</a> is able to save the active workbook with data to an ogw file.
</li>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create a new workbook</span>
newbook;
<span style="color: #008000;">// Fill some data to col(1)</span>
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> uniform<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">32</span><span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// Save this workbook with data to MyData.ogw under User Files Folder</span>
save <span style="color: #000080;">-</span>i <span style="color: #000080;">%</span>YMyData.<span style="color: #000080;">ogw</span>;</pre>
<li>The X-Function <a class="external text" href="../../XFunction/X-Function/Template_saveas.html">template_saveas</a> is used to save workbook as a template.
</li>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create a new workbook with 3 sheets</span>
newbook sheet<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span>;
<span style="color: #008000;">// Save this workbook as a template named My3SheetsBook</span>
<span style="color: #008000;">// in User Files Folder (default)</span>
template_saveas template<span style="color: #000000;">:</span><span style="color: #000080;">=</span>My3SheetsBook;</pre>
<li>To save a workbook with analysis, the command <a href="../../LabTalk/LabTalk/Save_(command).html#-ik.3B_Save_the_active_workbook_as_an_analysis_template" title="LabTalk:Save (command)">save -ik</a> can be used.
</li>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create a project</span>
string strOpj<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Analysis.opj&quot;</span>;
doc <span style="color: #000080;">-</span>o <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>strOpj<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Activate the workbook to be saved as analysis template</span>
win <span style="color: #000080;">-</span>a Book1J;

<span style="color: #008000;">// Save this workbook as an analysis template</span>
<span style="color: #008000;">// name MyAnalysis.ogw under User Files Folder</span>
save <span style="color: #000080;">-</span>ik <span style="color: #000080;">%</span>YMyAnalysis.<span style="color: #000080;">ogw</span>;</pre>
</ol>
<h2><a name="Close_Workbook"></a><span class="mw-headline">Close Workbook</span></h2>
<p>To close workbook, just click the Close button in the top right corner of the workbook. And this behovior is done by command <a href="../../LabTalk/LabTalk/Window_(command)&amp;action=edit&amp;redlink=1.html" class="new" title="LabTalk:Window (command) (page does not exist)">win -ca</a>, and a dialog pops up to prompt user to delete or hide the workbook.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create a workbook, and name is stored in MyBook$ variable</span>
newbook result<span style="color: #000000;">:</span><span style="color: #000080;">=</span>MyBook<span style="color: #000080;">$</span>;

<span style="color: #008000;">// Simulate the Close button clicking</span>
win <span style="color: #000080;">-</span>ca <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>MyBook<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>;</pre>
<p>To close the workbook directly without prompting, and delete all the data, you can use command <a href="../../LabTalk/LabTalk/Window_(command)&amp;action=edit&amp;redlink=1.html" class="new" title="LabTalk:Window (command) (page does not exist)">win -cd</a>. And this is the same with <a href="../../LabTalk/Script/Basic_Workbook_Operation.html#Delete_Workbook" title="Script:Basic Workbook Operation">Delete Workbook</a> below.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create a new workbook for closing</span>
newbook;

<span style="color: #008000;">// close this workbook without prompting, and delete all the data</span>
win <span style="color: #000080;">-</span>cd <span style="color: #000080;">%</span>H;</pre>
<h2><a name="Show_or_Hide_Workbook"></a><span class="mw-headline">Show or Hide Workbook</span></h2>
<p>There are three switches, <i>-ch</i>, <i>-h</i>, and <i>-hc</i>, in <a href="../../LabTalk/LabTalk/Window_(command)&amp;action=edit&amp;redlink=1.html" class="new" title="LabTalk:Window (command) (page does not exist)">win</a> command for showing or hiding workbook. 
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create 3 workbooks for hiding</span>
newbook name<span style="color: #000000;">:</span><span style="color: #000080;">=</span>MyBook1 option<span style="color: #000000;">:</span><span style="color: #000080;">=</span>lsname;  <span style="color: #008000;">// first workbook, MyBook1</span>
newbook name<span style="color: #000000;">:</span><span style="color: #000080;">=</span>MyBook2 option<span style="color: #000000;">:</span><span style="color: #000080;">=</span>lsname;  <span style="color: #008000;">// second workbook, MyBook2</span>
newbook name<span style="color: #000000;">:</span><span style="color: #000080;">=</span>MyBook3 option<span style="color: #000000;">:</span><span style="color: #000080;">=</span>lsname;  <span style="color: #008000;">// third workbook, MyBook3;</span>

<span style="color: #008000;">// Use -ch to hide the active workbook, MyBook3</span>
<span style="color: #008000;">// And the View Mode in Project Explorer is Hidden</span>
win <span style="color: #000080;">-</span>ch <span style="color: #0000dd;">1</span>;

<span style="color: #008000;">// Use -hc to hide the first workbook (not the active one), MyBook1</span>
<span style="color: #008000;">// And the View Mode in Project Explorer is Hidden</span>
win <span style="color: #000080;">-</span>hc <span style="color: #0000dd;">1</span> MyBook1;

<span style="color: #008000;">// Use -h to hide the second workbook (active workbook), MyBook2</span>
<span style="color: #008000;">// The View Mode in Project Explorer is still Normal</span>
win <span style="color: #000080;">-</span>h <span style="color: #0000dd;">1</span>;

<span style="color: #008000;">// Actually, MyBook2 is still the active workbook</span>
<span style="color: #008000;">// It is able to show it by:</span>
win <span style="color: #000080;">-</span>h <span style="color: #0000dd;">0</span>;

<span style="color: #008000;">// To show MyBook1 and MyBook3, need to use the -hc switch to specify</span>
<span style="color: #008000;">// the workbook name</span>
win <span style="color: #000080;">-</span>hc <span style="color: #0000dd;">0</span> MyBook1;
win <span style="color: #000080;">-</span>hc <span style="color: #0000dd;">0</span> MyBook3;</pre>
<h2><a name="Name_and_Label_Workbook"></a><span class="mw-headline">Name and Label Workbook</span></h2>
<p>For a workbook, there will be short name, Long Name, and Comments. You can rename (short name) a workbook with <a href="../../LabTalk/LabTalk/Window_(command)&amp;action=edit&amp;redlink=1.html" class="new" title="LabTalk:Window (command) (page does not exist)">win -r</a> command, and use the <a href="../../LabTalk/LabTalk/Page_(object).html" title="LabTalk:Page (object)">page</a> object to control Long Name and Comments, including how to show the workbook title (short name, Long Name, or both).
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create a new workbook with name of &quot;Data&quot;, </span>
<span style="color: #008000;">// and show both in workbook title</span>
<span style="color: #008000;">// both short name and Long Name are the same</span>
<span style="color: #008000;">// workbook title only shows short name</span>
newbook name<span style="color: #000000;">:</span><span style="color: #000080;">=</span>Data option<span style="color: #000000;">:</span><span style="color: #000080;">=</span>lsname;

<span style="color: #008000;">// Rename the workbook to &quot;RawData&quot;</span>
win <span style="color: #000080;">-</span>r Data RawData;

<span style="color: #008000;">// Change Long Name to be &quot;FFT Data&quot;</span>
page.<span style="color: #000080;">longname</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;FFT Data&quot;</span>;
<span style="color: #008000;">// Add Comments, &quot;1st group data for fft&quot;</span>
page.<span style="color: #000080;">comments</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;1st group data for fft&quot;</span>;

<span style="color: #008000;">// Let the workbook title shows Long Name only</span>
page.<span style="color: #000080;">title</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;  <span style="color: #008000;">// 1 = Long Name, 2 = short name, 3 = both</span></pre>
<h2><a name="Activate_Workbook"></a><span class="mw-headline">Activate Workbook</span></h2>
<p>To activate a workbook, the command <a href="../../LabTalk/LabTalk/Window_(command)&amp;action=edit&amp;redlink=1.html" class="new" title="LabTalk:Window (command) (page does not exist)">win -a</a> can be used.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// The path of project to be opened</span>
string strOpj<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span>;
strOpj<span style="color: #000080;">$</span> <span style="color: #000080;">+</span><span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Samples\Curve Fitting\Intro_to_Nonlinear_Curve_Fit_Tool.opj&quot;</span>;
<span style="color: #008000;">// Open the project</span>
doc <span style="color: #000080;">-</span>o <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>strOpj<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Activate workbook, Book1, in the second subfolder of the project</span>
win <span style="color: #000080;">-</span>a Book1;

<span style="color: #008000;">// It also can put the workbook name into a variable</span>
<span style="color: #008000;">// Variable for the name of workbook, Gaussian, in the project</span>
string strGau<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Gaussian;
<span style="color: #008000;">// Activate the Gaussian workbook in the first subfolder</span>
win <span style="color: #000080;">-</span>a <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>strGau<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>;</pre>
<p>Most Origin commands operate on the active window, so you may be tempted to use <i>win -a</i> to activate a workbook and then run script after it to assume the active workbook. This will work in simple codes but for longer script, there might be timing issues and we recommend that you use <a href="../../LabTalk/LabTalk/Window_(command)&amp;action=edit&amp;redlink=1.html" class="new" title="LabTalk:Window (command) (page does not exist)">window -o <i>winName</i> {<i>script</i>}</a> instead. See <a href="../../LabTalk/Category/LT_Running_Scripts.html" title="Category:LT Running Scripts">A Note about Object that a Script Operates upon</a> for more detail explanation.
</p>
<h2><a name="Delete_Workbook"></a><span class="mw-headline">Delete Workbook</span></h2>
<p>To delete a workbook, you can use the <a href="../../LabTalk/LabTalk/Window_(command)&amp;action=edit&amp;redlink=1.html" class="new" title="LabTalk:Window (command) (page does not exist)">win -c</a> command, and this command will delete the workbook directly without prompts.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// The path of project to be opened</span>
string strOpj<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Curve Fitting\2D Bin and Fit.opj&quot;</span>;
<span style="color: #008000;">// Open the project</span>
doc <span style="color: #000080;">-</span>o <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>strOpj<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// Delete workbook, Book1, from the project</span>
win <span style="color: #000080;">-</span>c Book1;

<span style="color: #008000;">// To delete an active workbook, the workbook name can be omitted</span>
<span style="color: #008000;">// Or using&#160;%H to refer to the workbook name</span>
win <span style="color: #000080;">-</span>a MatrixFit1;  <span style="color: #008000;">// Activate the workbook MatrixFit1</span>
win <span style="color: #000080;">-</span>c;  <span style="color: #008000;">// Delete the workbook</span>
<span style="color: #008000;">// Or using this one</span>
<span style="color: #008000;">// win -c&#160;%H;</span>

<span style="color: #008000;">// It also allows to delete a workbook whose name is stored in a variable</span>
<span style="color: #008000;">// Create a new workbook using newbook X-Function</span>
<span style="color: #008000;">// And the name of this workbook is stored in string variable ToDel$</span>
newbook result<span style="color: #000000;">:</span><span style="color: #000080;">=</span>ToDel<span style="color: #000080;">$</span>;
<span style="color: #008000;">// delete the workbook created just now</span>
win <span style="color: #000080;">-</span>c <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>ToDel<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>;</pre>






