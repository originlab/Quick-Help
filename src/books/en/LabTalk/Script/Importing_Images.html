<h1 class="firstHeading">2.10.2 Importing Images</h1><p class='urlname' style='display: none'>Importing-Images</p>
<p><span class="OIndex" style="display:none">Import Image</span><span class="OIndex" style="display:none">Image Import</span>The <a class="external text" href="../../XFunction/X-Function/ImpImage.html">ImpImage</a> X-Function supports importing image files into Origin from script.  By default, the image is stored in Origin as an image (i.e., RGB values).  You have the option to convert the image to grayscale.
</p><p>Multiple-file importing is supported. By default, multiple images will be appended to the target page by creating new layers.  If importing to a matrix, each matrix-layer will be renamed to the corresponding imported file's name.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Import_Image_to_Matrix_and_Convert_to_Data"><span class="tocnumber">1</span> <span class="toctext">Import Image to Matrix and Convert to Data</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Import_Single_Image_to_Matrix"><span class="tocnumber">2</span> <span class="toctext">Import Single Image to Matrix</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Import_Multiple_Images_to_Matrixbook"><span class="tocnumber">3</span> <span class="toctext">Import Multiple Images to Matrixbook</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Import_Image_to_Graph_Layer"><span class="tocnumber">4</span> <span class="toctext">Import Image to Graph Layer</span></a></li>
</ul>
</div>

<h2><a name="Import_Image_to_Matrix_and_Convert_to_Data"></a><span class="mw-headline">Import Image to Matrix and Convert to Data</span></h2>
<p>This example imports a single image file to a matrix and then converts the (RGB color) image to grayscale values, storing them in a new matrix.
</p>
<pre class="lt" style="font-family:monospace;">newbook mat<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;              <span style="color: #008000;">// Create a new matrixbook</span>
fpath<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Samples\Image Processing and Analysis\car.bmp&quot;</span>;
string fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> fpath<span style="color: #000080;">$</span>;

<span style="color: #008000;">// Imports the image on path 'fname$' to the active window </span>
<span style="color: #008000;">//(the new matrixbook)</span>
impimage;    
  
<span style="color: #008000;">// Converts the image to grayscale values,and puts them in a new matrix  </span>
<span style="color: #008000;">// 'type' specifies bit-depth:  0=short (2-byte/16-bit, default); </span>
<span style="color: #008000;">// 1=byte (1-byte/8-bit)                                        </span>
img2m type<span style="color: #000000;">:</span><span style="color: #000080;">=</span>byte;</pre>
<h2><a name="Import_Single_Image_to_Matrix"></a><span class="mw-headline">Import Single Image to Matrix</span></h2>
<p>This example imports a series of *.TIF images into a new Matrixbook.  As an alternative to the <a class="external text" href="../../XFunction/X-Function/Img2m.html"><b>img2m</b></a> X-Function (shown above), the keyboard shortcuts <b>Ctrl+Shift+d</b> and <b>Ctrl+Shift+i</b> toggle between the matrix data and image representations of the file.
</p>
<pre class="lt" style="font-family:monospace;">newbook mat<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
fpath<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Samples\Image Processing and Analysis\&quot;</span>;
string fns, path<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> fpath<span style="color: #000080;">$</span>;
<span style="color: #008000;">// Find the files whose names begin with 'myocyte'</span>
findfiles fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>fns<span style="color: #000080;">$</span> ext<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;myocyte*.tif&quot;</span>;
<span style="color: #008000;">// Import each file into a new sheet (options.Mode = 4)                 </span>
impimage options.<span style="color: #000080;">Mode</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span> fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>fns<span style="color: #000080;">$</span>;</pre>
<h2><a name="Import_Multiple_Images_to_Matrixbook"></a><span class="mw-headline">Import Multiple Images to Matrixbook</span></h2>
<p>This example imports a folder of JPG images to different Matrixbooks.
</p>
<pre class="lt" style="font-family:monospace;">string pth1<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;C:\Documents and Settings\All Users\&quot;</span>
string pth2<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Documents\My Pictures\Sample Pictures\&quot;</span>;
string fns, path<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> pth1<span style="color: #000080;">$</span> <span style="color: #000080;">+</span> pth2<span style="color: #000080;">$</span>;
<span style="color: #008000;">// Find all *.JPG files (in 'path$', by default)</span>
findfiles fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>fns<span style="color: #000080;">$</span> ext<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;*.jpg&quot;</span>;   
<span style="color: #008000;">// Assign the number of files found to integer variable 'n'</span>
<span style="color: #008000;">// 'CRLF' ==&gt; files separated by a 'carriage-return line-feed'    </span>
int n <span style="color: #000080;">=</span> fns.<span style="color: #000080;">GetNumTokens</span><span style="color: #000000;">&#40;</span>CRLF<span style="color: #000000;">&#41;</span>;            
string bkName<span style="color: #000080;">$</span>;
string fname<span style="color: #000080;">$</span>;
<span style="color: #008000;">// Loop through all files, importing each to a new matrixbook</span>
for<span style="color: #000000;">&#40;</span>int ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; ii<span style="color: #000080;">&lt;=</span>n; ii<span style="color: #000080;">++</span><span style="color: #000000;">&#41;</span>               
<span style="color: #000000;">&#123;</span>
    fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> fns.<span style="color: #000080;">GetToken</span><span style="color: #000000;">&#40;</span>ii, CRLF<span style="color: #000000;">&#41;</span><span style="color: #000080;">$</span>;

    <span style="color: #008000;">//create a new matrix page</span>
    newbook s<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> mat<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> result<span style="color: #000000;">:</span><span style="color: #000080;">=</span>bkName<span style="color: #000080;">$</span>;   
    <span style="color: #008000;">//import image to the first layer of the matrix page,</span>
    <span style="color: #008000;">//defaut file name is fname$ </span>
    impimage orng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>bkName<span style="color: #000080;">$</span><span style="color: #000000;">&#93;</span>msheet1;       
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Import_Image_to_Graph_Layer"></a><span class="mw-headline">Import Image to Graph Layer</span></h2>
<p>You also can import an Image to an existing GraphLayer.  Here the image is only for display (the data will not be visible, unless it is converted to a matrix, see next example).
</p>
<pre class="lt" style="font-family:monospace;">string fpath<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Samples\Image Processing and Analysis\cell.jpg&quot;</span>;
string fn<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> fpath<span style="color: #000080;">$</span>;
insertImg2g fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>fn<span style="color: #000080;">$</span> ipg<span style="color: #000000;">:</span><span style="color: #000080;">=</span>graph1;</pre>






