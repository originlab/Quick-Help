<h1 class="firstHeading">2.12.2 Accessing Metadata</h1><p class='urlname' style='display: none'>Accessing-Metadata</p>
<p><span class="OIndex">Metadata</span> is information which refers to other data. Examples include the time at which data was originally collected, the operator of the instrument collecting the data and the temperature of a sample being investigated. Metadata can be stored in Projects, Pages, Layers and Columns.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Column_Label_Rows"><span class="tocnumber">1</span> <span class="toctext">Column Label Rows</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Read.2FWrite_Column_Label_Rows"><span class="tocnumber">1.1</span> <span class="toctext">Read/Write Column Label Rows</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Create_and_Name_User_Parameter_Rows"><span class="tocnumber">1.2</span> <span class="toctext">Create and Name User Parameter Rows</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Show.2FHide_Column_LabelsColumn_Label"><span class="tocnumber">1.3</span> <span class="toctext">Show/Hide Column Labels<span class="OIndex" style="display:none">Column Label</span></span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="#Even_Sampling_Interval"><span class="tocnumber">2</span> <span class="toctext">Even Sampling Interval</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#Accessing_the_Sampling_Interval_Column_Label_Row"><span class="tocnumber">2.1</span> <span class="toctext">Accessing the Sampling Interval Column Label Row</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Sampling_Interval_by_X-Function"><span class="tocnumber">2.2</span> <span class="toctext">Sampling Interval by X-Function</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8"><a href="#Trees"><span class="tocnumber">3</span> <span class="toctext">Trees</span></a>
<ul>
<li class="toclevel-2 tocsection-9"><a href="#Access_Import_File_Tree_Nodes"><span class="tocnumber">3.1</span> <span class="toctext">Access Import File Tree Nodes</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Access_Report_Page_Tree"><span class="tocnumber">3.2</span> <span class="toctext">Access Report Page Tree</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#User_Tree_in_Page_Storage"><span class="tocnumber">3.3</span> <span class="toctext">User Tree in Page Storage</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#User_Tree_in_a_Worksheet"><span class="tocnumber">3.4</span> <span class="toctext">User Tree in a Worksheet</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#User_Tree_in_a_Worksheet_Column"><span class="tocnumber">3.5</span> <span class="toctext">User Tree in a Worksheet Column</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#ROI"><span class="tocnumber">3.6</span> <span class="toctext">ROI</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="Column_Label_Rows"></a><span class="mw-headline">Column Label Rows</span></h2>
<p>Metadata is most visible in a worksheet where column headers may contain information such as <span class="OIndex">Long Name</span> (L), <span class="OIndex">Units</span> (U), <span class="OIndex">Comments</span>(C), <span class="OIndex">Sampling Interval</span> and various <span class="OIndex">Parameter rows</span>, including <span class="OIndex">User-Defined parameters</span>.
</p><p>The row indices for column label rows are assigned to characters, which are given in the <a href="../../LabTalk/LabTalk/Column_Label_Row_Characters.html" title="LabTalk:Column Label Row Characters">Column Label Row reference table</a>.  Examples of use follow.
</p>
<h3><a name="Read.2FWrite_Column_Label_Rows"></a><span class="mw-headline">Read/Write Column Label Rows</span></h3>
<p>At times you may want to capture or set the Column Label Rows<span class="OIndex" style="display:none">Column Label Row</span> or <span class="OIndex">Column Header</span> string from script.  Access the label row by using the corresponding label row characters as a row index. 
</p><p><b>Note</b>: Numeric cell access does not supported to use label row characters.
</p><p>Here are a few examples of reading and writing column header strings:
</p>
<pre class="lt" style="font-family:monospace;">Book1_A<span style="color: #000000;">&#91;</span>L<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Time;   <span style="color: #008000;">// Set the Long Name of column A to '''Time'''</span>
Book1_A<span style="color: #000000;">&#91;</span>U<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> sec;    <span style="color: #008000;">// Set the Units of column A to '''sec'''</span>
string strC<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span>C<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span>;   <span style="color: #008000;">// Read the Comments of column2 into strC$</span>
<span style="color: #008000;">// Get value from first system parameter row</span>
double syspar1 <span style="color: #000080;">=</span> <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span>p1<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>;</pre>
<pre class="lt" style="font-family:monospace;">Col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span>L<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Temperature&quot;</span>;   <span style="color: #008000;">// set Col(1) long name to &quot;Temperature&quot;</span>
range bb <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;               <span style="color: #008000;">// declare a range variable for Col(2)</span>
<span style="color: #008000;">// Set the long name of Col(2) to that of Col(1) with the string &quot; Data&quot; </span>
<span style="color: #008000;">// appended</span>
bb<span style="color: #000000;">&#91;</span>L<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>Col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span>L<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span><span style="color: #000080;">+</span><span style="color: #ff00ff;">&quot; Data&quot;</span>;</pre>
<p><b>Note</b>: For Origin 8.0, LabTalk variables took precedence over Column Label Row characters, for example:
</p>
<pre class="lt" style="font-family:monospace;">int L <span style="color: #000080;">=</span> <span style="color: #0000dd;">4</span>;    <span style="color: #008000;">// For Origin 8.0 and earlier ...</span>
Col<span style="color: #000000;">&#40;</span>B<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span>L<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>   <span style="color: #008000;">// Returns the value in row 4 of Col(B), as a string</span></pre>
<p>But for Origin 8.1, this has been changed so that the column label rows (L, U, C, etc.) will take precedence:
</p>
<pre class="lt" style="font-family:monospace;">int L <span style="color: #000080;">=</span> <span style="color: #0000dd;">4</span>;    <span style="color: #008000;">// For Origin 8.1 ...</span>
Col<span style="color: #000000;">&#40;</span>B<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span>L<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>   <span style="color: #008000;">// Returns the Long Name of Col(B), as a string</span></pre>
<h3><a name="Create_and_Name_User_Parameter_Rows"></a><span class="mw-headline">Create and Name User Parameter Rows</span></h3>
<p>The following example shows how to create and access user parameter rows
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Show the first user parameter row</span>
wks.<span style="color: #000080;">userParam1</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;   
<span style="color: #008000;">// Assign the 1st user parameter row a custom name</span>
wks.<span style="color: #000080;">userParam1</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Temperature&quot;</span>;   
<span style="color: #008000;">// Write to a specific user parameter row of a column</span>
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span>Temperature<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;96.8&quot;</span>;   
<span style="color: #008000;">// Get a user-defined parameter row value</span>
double temp <span style="color: #000080;">=</span> <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span>Temperature<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>;</pre>
<h3><a name="Show.2FHide_Column_LabelsColumn_Label"></a><span class="mw-headline">Show/Hide Column Labels<span class="OIndex" style="display:none">Column Label</span></span></h3>
<p>You can set which column header rows are displayed and in what order by <a href="../../LabTalk/LabTalk/Wks_(object).html#Display_Worksheet_Column_Labels" title="LabTalk:Wks (object)">wks.labels</a> object method.  For the active worksheet, this script specifies the following column header rows (in the order given): Long Name, Unit, the first System-Parameter, the First User-Parameter, and Comments:
</p>
<pre class="lt" style="font-family:monospace;">range ww <span style="color: #000080;">=</span> <span style="color: #000080;">!</span>;
ww.<span style="color: #000080;">labels</span><span style="color: #000000;">&#40;</span>LUP1D1C<span style="color: #000000;">&#41;</span>;</pre>
<h2><a name="Even_Sampling_Interval"></a><span class="mw-headline">Even Sampling Interval</span></h2>
<p>Origin users can set the sampling interval (X) for a data series (Y) to something other than the corresponding row numbers of the data points (default).
</p>
<h3><a name="Accessing_the_Sampling_Interval_Column_Label_Row"></a><span class="mw-headline">Accessing the Sampling Interval Column Label Row</span></h3>
<p>When this is done, a special header row is created to remind the user of the custom interval (and initial value) applied.  To access the text in this header row, simply use the <b>E</b> row-index character.  This header is effectively read-only and cannot be set to an arbitrary string, but the properties from which this string is composed may be changed with either column properties (see the <a href="../../LabTalk/Category/Wks.Col_(object).html" title="Category:Wks.Col (object)">wks.col object</a>) or the <a class="external text" href="../../XFunction/X-Function/Colint.html">colint X-Function</a>. 
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Read the Sampling Interval header text of Column 1 to a string variable</span>
string sampInt<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span>E<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span>;  
<span style="color: #008000;">// If an initial value of 2 and increment of 0.5 was set for Col(1),</span>
<span style="color: #008000;">// the output will be:</span>
sampInt<span style="color: #000080;">$</span><span style="color: #000080;">=</span>;                       <span style="color: #008000;">// &quot;x0 = 2&quot;</span>
                                 <span style="color: #008000;">// &quot;dx = 0.5&quot;</span></pre>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Accessing_Metadata/Tutorial_icon.png?v=0" width="57"  border="0" />
	</td>
	<td><p>To see a Sampling Interval header, you can try the following steps:
</p>
<ol><li> Create a new worksheet and delete the X-column</li>
<li> Right-click at the top of the remaining column (i.e., B(Y)), such that then entire column is selected, and select <b>Set Sampling Interval</b> from the drop-down menu.  </li>
<li> Set the initial and step values to something other than 1.  </li>
<li> Click OK, and you will see a new header row created which lists the values you specified.  </li></ol>
<p>The next example demonstrates how to do this from script, using X-functions.
</p><p>Also, when you import certain types of data, e.g. <i>*.wav</i>, the sampling interval will show as a header row.  
</p></td></tr></table>
<h3><a name="Sampling_Interval_by_X-Function"></a><span class="mw-headline">Sampling Interval by X-Function</span></h3>
<p>Sampling Interval is special in that its display is formatted for the user's information. Programmatically, it is accessed as follows
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Use full formal notation of an X-Function</span>
colint rng<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span> x0<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">68</span> inc<span style="color: #000000;">:</span><span style="color: #000080;">=</span>.25 units<span style="color: #000000;">:</span><span style="color: #000080;">=</span>Degrees lname<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Temperature&quot;</span>;
<span style="color: #008000;">// which in shorthand notation is </span>
colint <span style="color: #0000dd;">1</span> <span style="color: #0000dd;">68</span> .25 Degrees <span style="color: #ff00ff;">&quot;Temperature&quot;</span>;</pre>
<p>The initial value and increment can be read back using worksheet column properties:
</p>
<pre class="lt" style="font-family:monospace;">double XInitial <span style="color: #000080;">=</span> wks.<span style="color: #000080;">col1</span>.<span style="color: #000080;">xinit</span>;
double XIncrement <span style="color: #000080;">=</span> wks.<span style="color: #000080;">col1</span>.<span style="color: #000080;">xinc</span>;
string XUnits<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> wks.<span style="color: #000080;">col1</span>.<span style="color: #000080;">xunits</span><span style="color: #000080;">$</span>;
string XName<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> wks.<span style="color: #000080;">col1</span>.<span style="color: #000080;">xname</span><span style="color: #000080;">$</span>;</pre>
<p><b>Note</b>: While these properties will show up in a listing of column properties (Enter <b>wks.col1.= </b> in the Script window to display the property names for column 1), unless a sampling interval is established:
</p>
<ul><li> The strings <b>wks.col1.xunits$</b> and <b>wks.col1.xname$</b> will have no value. </li>
<li> The numeric values <b>wks.col1.xinit</b> and <b>wks.col1.xinc</b> will each have a value of 1, corresponding to the initial value and increment of the row numbers.</li></ul>
<p><br />
</p>
<h2><a name="Trees"></a><span class="mw-headline">Trees</span></h2>
<p><span class="OIndex">Tree</span>s are a data type supported by LabTalk, and we also  consider trees a form of metadata since they give structure to existing data. They were briefly introduced in the section dealing with <a href="../../LabTalk/LabTalk/Data_Types_and_Variables.html#Tree" title="LabTalk:Data Types and Variables">Data Types and Variables</a>, but appear again because of their importance to X-functions.
</p><p>Many X-functions input and output data in tree form.  And since X-functions are one of the primary tools accessible from LabTalk script, it is important to recognize and use tree variables effectively.
</p>
<h3><a name="Access_Import_File_Tree_Nodes"></a><span class="mw-headline">Access Import File Tree Nodes</span></h3>
<p>After importing data into a worksheet, Origin stores metadata in a special tree-like structure <a href="../../LabTalk/LabTalk/Page_(object).html" title="LabTalk:Page (object)">(page.info)</a> at the page level. Basic information about the file can be retrieved directly from this structure:
</p>
<pre class="lt" style="font-family:monospace;">string strName, strPath;
double dDate;
<span style="color: #008000;">// Get the file name, path and date from the structure</span>
strName<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> page.<span style="color: #000080;">info</span>.<span style="color: #000080;">system</span>.<span style="color: #000080;">import</span>.<span style="color: #000080;">filename</span><span style="color: #000080;">$</span>;
strPath<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> page.<span style="color: #000080;">info</span>.<span style="color: #000080;">system</span>.<span style="color: #000080;">import</span>.<span style="color: #000080;">filepath</span><span style="color: #000080;">$</span>;
dDate <span style="color: #000080;">=</span> page.<span style="color: #000080;">info</span>.<span style="color: #000080;">system</span>.<span style="color: #000080;">import</span>.<span style="color: #000080;">filedate</span>;
<span style="color: #008000;">// Both&#160;% and $ substitution methods are used</span>
ty File <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>strPath<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>strName<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>, dated <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>dDate,D10<span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Starting with Origin 2019b, there is easier output of formatted file date.</span>
strDate<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> page.<span style="color: #000080;">info</span>.<span style="color: #000080;">SYSTEM</span>.<span style="color: #000080;">IMPORT</span>.<span style="color: #000080;">FILEDATE</span><span style="color: #000080;">$</span>;
<span style="color: #008000;">//Generates a date-time string using the D9 date format.</span></pre>
<p>This tree structure includes a tree with additional information about the import. This tree can be extracted as a tree variable using an X-Function:
</p>
<pre class="lt" style="font-family:monospace;">Tree MyFiles;
impinfo ipg<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>Book2<span style="color: #000000;">&#93;</span> tr<span style="color: #000000;">:</span><span style="color: #000080;">=</span>MyFiles;
MyFiles.<span style="color: #000080;">=</span>; <span style="color: #008000;">// Dump the contents of the tree to the script Window</span></pre>
<p>Note: The contents of the <i>impinfo</i> tree will depend on the function used to import.
</p><p>If you import multiple files into one workbook (using either New Sheets, New Columns or New Rows) then you need to load a particular tree for each file as the Organizer only displays the system metadata from the last import:
</p>
<pre class="lt" style="font-family:monospace;">Tree trFile;
int iNumFiles;
<span style="color: #008000;">// Use the function first to find the number of files</span>
impinfo trInfo<span style="color: #000000;">:</span><span style="color: #000080;">=</span>trFile fcount<span style="color: #000000;">:</span><span style="color: #000080;">=</span>iNumFiles;
<span style="color: #008000;">// Now loop through all files - these are indexed from 0</span>
for<span style="color: #000000;">&#40;</span> idx <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>&#160;; idx <span style="color: #000080;">&lt;</span> iNumFiles&#160;; idx<span style="color: #000080;">++</span> <span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
   <span style="color: #008000;">// Get the tree for the next file</span>
   impinfo findex<span style="color: #000000;">:</span><span style="color: #000080;">=</span>idx trInfo<span style="color: #000000;">:</span><span style="color: #000080;">=</span>trFile;
   string strFileName, strLocation;
   <span style="color: #008000;">// </span>
   strFileName<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> trFile.<span style="color: #000080;">Info</span>.<span style="color: #000080;">FileName</span><span style="color: #000080;">$</span>;
   strLocation<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> trFile.<span style="color: #000080;">Info</span>.<span style="color: #000080;">DataRange</span><span style="color: #000080;">$</span>;
   ty File <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>strFileName<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span> was imported into <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>strLocation<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<h3><a name="Access_Report_Page_Tree"></a><span class="mw-headline">Access Report Page Tree</span></h3>
<p>Analysis Report pages are specially formatted Worksheets based on a tree structure. You can get this structure into a <a href="../../LabTalk/LabTalk/Data_Types_and_Variables.html#Tree" title="LabTalk:Data Types and Variables">tree variable</a> using the <a class="external text" href="../../XFunction/X-Function/Getresults.html">getresults X-Function</a> and extract results.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Import an Origin Sample file</span>
string fpath<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Samples\Curve Fitting\Gaussian.dat&quot;</span>;
string fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> SYSTEM.<span style="color: #000080;">PATH</span>.<span style="color: #000080;">PROGRAM</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> fpath<span style="color: #000080;">$</span>;
impasc;
<span style="color: #008000;">// Run a Gauss fit of the data and create a Report sheet</span>
nlbegin <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> gauss;
nlfit;
nlend <span style="color: #0000dd;">1</span> <span style="color: #0000dd;">1</span>;
<span style="color: #008000;">// An automatically-created string variable, __REPORT$, </span>
<span style="color: #008000;">// holds the name of the last Report sheet created:</span>
string strLastReport<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> __REPORT<span style="color: #000080;">$</span>;
<span style="color: #008000;">// This is the X-Function which gets the Report into a tree</span>
getresults tr<span style="color: #000000;">:</span><span style="color: #000080;">=</span>MyResults iw<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>strLastReport<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// So now we can access those results</span>
ty Variable\tValue\tError;
separator <span style="color: #0000dd;">3</span>;
ty y0\t<span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>MyResults.<span style="color: #000080;">Parameters</span>.<span style="color: #000080;">y0</span>.<span style="color: #000080;">Value</span><span style="color: #000000;">&#41;</span>\t<span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>MyResults.<span style="color: #000080;">Parameters</span>.<span style="color: #000080;">y0</span>.<span style="color: #000080;">Error</span><span style="color: #000000;">&#41;</span>;
ty xc\t<span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>MyResults.<span style="color: #000080;">Parameters</span>.<span style="color: #000080;">xc</span>.<span style="color: #000080;">Value</span><span style="color: #000000;">&#41;</span>\t<span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>MyResults.<span style="color: #000080;">Parameters</span>.<span style="color: #000080;">xc</span>.<span style="color: #000080;">Error</span><span style="color: #000000;">&#41;</span>;
ty w\t<span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>MyResults.<span style="color: #000080;">Parameters</span>.<span style="color: #000080;">w</span>.<span style="color: #000080;">Value</span><span style="color: #000000;">&#41;</span>\t<span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>MyResults.<span style="color: #000080;">Parameters</span>.<span style="color: #000080;">w</span>.<span style="color: #000080;">Error</span><span style="color: #000000;">&#41;</span>;
ty A\t<span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>MyResults.<span style="color: #000080;">Parameters</span>.<span style="color: #000080;">A</span>.<span style="color: #000080;">Value</span><span style="color: #000000;">&#41;</span>\t<span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>MyResults.<span style="color: #000080;">Parameters</span>.<span style="color: #000080;">A</span>.<span style="color: #000080;">Error</span><span style="color: #000000;">&#41;</span>;</pre>
<h3><a name="User_Tree_in_Page_Storage"></a><span class="mw-headline">User Tree in Page Storage</span></h3>
<p>Information can be stored in a workbook, matrixbook or graph page using a tree structure <a href="../../LabTalk/LabTalk/Page_(object).html" title="LabTalk:Page (object)">(page.tree)</a>. The following example shows how to create a section and add subsections and values to the active page storage area.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Add values to a treenode;</span>
page.<span style="color: #000080;">tree</span>.<span style="color: #000080;">experiment</span>.<span style="color: #000080;">sample</span>.<span style="color: #000080;">RunNumber</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">45</span>;
page.<span style="color: #000080;">tree</span>.<span style="color: #000080;">experiment</span>.<span style="color: #000080;">sample</span>.<span style="color: #000080;">Temperature</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">273.8</span>; 
<span style="color: #008000;">// Add values to another treenode;</span>
page.<span style="color: #000080;">tree</span>.<span style="color: #000080;">experiment</span>.<span style="color: #000080;">detector</span>.<span style="color: #000080;">Type</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;InGaAs&quot;</span>;
page.<span style="color: #000080;">tree</span>.<span style="color: #000080;">experiment</span>.<span style="color: #000080;">detector</span>.<span style="color: #000080;">Cooling</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Liquid Nitrogen&quot;</span>;
page.<span style="color: #000080;">tree</span>.<span style="color: #000080;">=</span>
<span style="color: #008000; font-style: regular;">/*
Output: 
    EXPERIMENT
         +---SAMPLE
         |    +---RUNNUMBER = 45
         |    \---TEMPERATURE = 273.8
         \---DETECTOR
              +---TYPE = InGaAs
              \---COOLING = Liquid Nitrogen
*/</span></pre>
<p>Once the information has been stored, it can be retrieved by simply dumping the storage contents:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Dump entire contents of page storage</span>
page.<span style="color: #000080;">tree</span>.<span style="color: #000080;">=</span>;
<span style="color: #008000;">// or programmaticaly accessed</span>
temperature <span style="color: #000080;">=</span> page.<span style="color: #000080;">tree</span>.<span style="color: #000080;">experiment</span>.<span style="color: #000080;">sample</span>.<span style="color: #000080;">temperature</span>;
string type<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> page.<span style="color: #000080;">tree</span>.<span style="color: #000080;">experiment</span>.<span style="color: #000080;">detector</span>.<span style="color: #000080;">Type</span><span style="color: #000080;">$</span>;
ty Using <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>type<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span> at <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>temperature<span style="color: #000000;">&#41;</span>K;</pre>
<p>You can view such trees in the page Organizer for Workbooks and Matrixbooks.
</p>
<h3><a name="User_Tree_in_a_Worksheet"></a><span class="mw-headline">User Tree in a Worksheet</span></h3>
<p>Trees stored at the Page level in a Workbook can be accessed no matter what Sheet is active. You can also store trees at the sheet level:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Here we add two trees to the active sheet</span>
wks.<span style="color: #000080;">tree</span>.<span style="color: #000080;">add</span><span style="color: #000000;">&#40;</span>Input<span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// Dynamically create a branch and value</span>
wks.<span style="color: #000080;">tree</span>.<span style="color: #000080;">input</span>.<span style="color: #000080;">Min</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
<span style="color: #008000;">// Add another value</span>
wks.<span style="color: #000080;">tree</span>.<span style="color: #000080;">input</span>.<span style="color: #000080;">max</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
<span style="color: #008000;">// Add second tree</span>
wks.<span style="color: #000080;">tree</span>.<span style="color: #000080;">add</span><span style="color: #000000;">&#40;</span>Output<span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// and two more values</span>
wks.<span style="color: #000080;">tree</span>.<span style="color: #000080;">output</span>.<span style="color: #000080;">min</span> <span style="color: #000080;">=</span> <span style="color: #000080;">-</span><span style="color: #0000dd;">100</span>;
wks.<span style="color: #000080;">tree</span>.<span style="color: #000080;">output</span>.<span style="color: #000080;">max</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">100</span>;

<span style="color: #008000;">// Now dump the trees</span>
wks.<span style="color: #000080;">tree</span>.<span style="color: #000080;">=</span>;
<span style="color: #008000;">// or access it</span>
ty Input <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>wks.<span style="color: #000080;">tree</span>.<span style="color: #000080;">input</span>.<span style="color: #000080;">min</span><span style="color: #000000;">&#41;</span> to <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>wks.<span style="color: #000080;">tree</span>.<span style="color: #000080;">input</span>.<span style="color: #000080;">max</span><span style="color: #000000;">&#41;</span>;
ty Output <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>wks.<span style="color: #000080;">tree</span>.<span style="color: #000080;">output</span>.<span style="color: #000080;">min</span><span style="color: #000000;">&#41;</span> to <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>wks.<span style="color: #000080;">tree</span>.<span style="color: #000080;">output</span>.<span style="color: #000080;">max</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Access a sheet-level tree using a range</span>
range rs <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>Book7<span style="color: #000000;">&#93;</span>Sheet2<span style="color: #000080;">!</span>;
rs<span style="color: #000080;">!</span>wks.<span style="color: #000080;">tree</span>.<span style="color: #000080;">=</span>;</pre>
<p>You can view such trees in the page Organizer for Workbooks and Matrixbooks.
</p>
<h3><a name="User_Tree_in_a_Worksheet_Column"></a><span class="mw-headline">User Tree in a Worksheet Column</span></h3>
<p>Individual worksheet columns can also contain metadata stored in tree format.  Assigning and retrieving tree nodes is very similar to the page-level tree.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create a COLUMN tree</span>
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">tree</span>.<span style="color: #000080;">add</span><span style="color: #000000;">&#40;</span>Batch<span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// Add a branch</span>
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">tree</span>.<span style="color: #000080;">batch</span>.<span style="color: #000080;">addsection</span><span style="color: #000000;">&#40;</span>Mix<span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// and two values in the branch</span>
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">tree</span>.<span style="color: #000080;">batch</span>.<span style="color: #000080;">mix</span>.<span style="color: #000080;">ratio</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;20:15:2&quot;</span>;
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">tree</span>.<span style="color: #000080;">batch</span>.<span style="color: #000080;">mix</span>.<span style="color: #000080;">BatchNo</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">113210</span>;
<span style="color: #008000;">// Add branch dynamically and add values</span>
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">tree</span>.<span style="color: #000080;">batch</span>.<span style="color: #000080;">Line</span>.<span style="color: #000080;">No</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">7</span>;
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">tree</span>.<span style="color: #000080;">batch</span>.<span style="color: #000080;">Line</span>.<span style="color: #000080;">Date</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span><span style="color: #000080;">/</span><span style="color: #0000dd;">15</span><span style="color: #000080;">/</span><span style="color: #0000dd;">2010</span>; 

<span style="color: #008000;">// Dump the tree to the Script Window</span>
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">tree</span>.<span style="color: #000080;">=</span>;
<span style="color: #008000;">// Or access the tree</span>
batch <span style="color: #000080;">=</span> wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">tree</span>.<span style="color: #000080;">batch</span>.<span style="color: #000080;">mix</span>.<span style="color: #000080;">batchno</span>;
string strDate<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">tree</span>.<span style="color: #000080;">batch</span>.<span style="color: #000080;">Line</span>.<span style="color: #000080;">Date</span><span style="color: #000080;">$</span>;
ty Batch <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>batch<span style="color: #000000;">&#41;</span> made on <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>strDate<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#91;</span><span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>date<span style="color: #000000;">&#40;</span><span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>strDate<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#93;</span>;</pre>
<p>You can view these trees in the Column Properties dialog on the User Tree tab.
</p>
<h3><a name="ROI"></a><span class="mw-headline">ROI</span></h3>
<p>If a Region Of Interest (ROI) box is created from SVG, ROI created from brain atlas SVG for example, the metadata can be saved and accessed by binary storage tree <b>roi.info.tree</b>.
</p>
<table class="simple">
<tr>
<th width="20%"> Tree Node
</th>
<th> Description
</th></tr>
<tr>
<td> <b>roi.info.tree.longname$</b>
</td>
<td> Assign and retrieve ROI Long Name.
<p>For ROI box craeated from a SVG image, the acronym name will be set as ROI name and the full name is stroed into Long Name, which can also be retrieved by this byte. 
</p>
</td></tr>
<tr>
<td> <b>roi.info.tree.svg$</b>
</td>
<td> Access SVG name. Also accessible by user tree, e.g. <b>layer.info.tree.<i>BrainAtlas</i>.SVG$</b> in <b>Book Organizer</b>.
</td></tr>
<tr>
<td> <b>roi.info.tree.slice$</b>
</td>
<td> Access slice name for the ROI. Also accessible by user tree <b>layer.info.tree.slice$</b> in <b>Book Organizer</b>.
</td></tr></table>


