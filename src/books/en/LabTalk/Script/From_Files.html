<h1 class="firstHeading">2.5.1.2 From Files</h1><p class='urlname' style='display: none'>From-Files</p>
<p><span class="OIndex" style="display:none">Run Script from File</span>LabTalk <span class="OIndex">script</span> usually requires an Origin Object and are thus restricted to an open project. Scripts can also be saved to a file on disk to be called from any project. Script files can be called with up to five arguments. This section outlines the use of LabTalk scripts saved to a file.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Creating_and_Saving_Script_FilesSave_Script_Filescript_files.2C_creating.2FsavingCreate_Script_File"><span class="tocnumber">1</span> <span class="toctext">Creating and Saving Script Files<span class="OIndex" style="display:none">Save Script File</span><span class="OIndex" style="display:none">script files, creating/saving</span><span class="OIndex" style="display:none">Create Script File</span></span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#The_OGS_File_Extension"><span class="tocnumber">2</span> <span class="toctext">The OGS File Extension</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Sections_in_an_OGS_FileSectionScript_Section"><span class="tocnumber">3</span> <span class="toctext">Sections in an OGS File<span class="OIndex" style="display:none">Section</span><span class="OIndex" style="display:none">Script Section</span></span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Running_an_OGS_File"><span class="tocnumber">4</span> <span class="toctext">Running an OGS File</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Passing_Arguments_in_ScriptsArgument.2C_Script_FilePass_Arguments_in_Script"><span class="tocnumber">5</span> <span class="toctext">Passing Arguments in Scripts<span class="OIndex" style="display:none">Argument, Script File</span><span class="OIndex" style="display:none">Pass Arguments in Script</span></span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#Passing_Numeric_Variables_by_ReferencePass_Variables_by_Reference"><span class="tocnumber">5.1</span> <span class="toctext">Passing Numeric Variables by Reference<span class="OIndex" style="display:none">Pass Variables by Reference</span></span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Passing_Numeric_Variables_by_ValuePass_Variables_by_Value"><span class="tocnumber">5.2</span> <span class="toctext">Passing Numeric Variables by Value<span class="OIndex" style="display:none">Pass Variables by Value</span></span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8"><a href="#Guidelines_for_Naming_OGS_Files_and_Sections"><span class="tocnumber">6</span> <span class="toctext">Guidelines for Naming OGS Files and Sections</span></a>
<ul>
<li class="toclevel-2 tocsection-9"><a href="#When_Using_the_Run.section.28.29_Method"><span class="tocnumber">6.1</span> <span class="toctext">When Using the Run.section() Method</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#When_Using_the_Command_Method"><span class="tocnumber">6.2</span> <span class="toctext">When Using the Command Method</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Section_Name_Rules_.28When_Using_Either_Method.29"><span class="tocnumber">6.3</span> <span class="toctext">Section Name Rules (When Using Either Method)</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-12"><a href="#Setting_the_Path"><span class="tocnumber">7</span> <span class="toctext">Setting the Path</span></a></li>
<li class="toclevel-1 tocsection-13"><a href="#Running_LabTalk_from_Origin_C"><span class="tocnumber">8</span> <span class="toctext">Running LabTalk from Origin C</span></a></li>
</ul>
</div>

<h2><a name="Creating_and_Saving_Script_FilesSave_Script_Filescript_files.2C_creating.2FsavingCreate_Script_File"></a><span class="mw-headline">Creating and Saving Script Files<span class="OIndex" style="display:none">Save Script File</span><span class="OIndex" style="display:none">script files, creating/saving</span><span class="OIndex" style="display:none">Create Script File</span></span></h2>
<p>LabTalk scripts can be created and saved from any text editor, including Origin's <span class="OIndex">Code Builder</span>. To access Code Builder, select the <a  class="image"><img alt="Button Code Builder.png" src="../images/From_Files/Button_Code_Builder.png?v=0" width="23"  /></a> icon from the Standard Toolbar.  Create a new document of type LabTalk Script File and type or paste your code into the editor window and then save with a desired filename  and path (use the default <a href="#The_OGS_File_Extension">OGS file extension</a>).
</p>
<h2><a name="The_OGS_File_Extension"></a><span class="mw-headline">The OGS File Extension</span></h2>
<p>LabTalk scripts can be saved to files and given any extension, but for maximum flexibility they are given the <span class="OIndex">OGS file</span> extension, and are therefore also known as <b>OGS files</b>.  You may save script files to any accessible folder in your file system, but specific locations may provide additional advantages.  If an OGS file is located in your <span class="OIndex">User Files Folder</span>, you will not have to provide a <a href="#Setting_the_Path">path</a> when running your script.
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/From_Files/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>An OGS file can also be attached to the Origin Project (OPJ) rather than saving it to disk.  The file can be added to the <b>Project</b> node in Code Builder and will then be saved with the project. Drag the filename from the User folder and drop into the Project folder. Script sections in such attached OGS files can be called using the <a href="../../LabTalk/LabTalk/Run_(object).html#Methods:" title="LabTalk:Run (object)"><b>run.section()</b> object method</a> similar to calling sections in a file saved on disk. Only the file name needs to be specified, as Origin will first look for the file in the project itself and execute the code if filename and section are found as attachments to the project. 
</p></td></tr></table>
<h2><a name="Sections_in_an_OGS_FileSectionScript_Section"></a><span class="mw-headline">Sections in an OGS File<span class="OIndex" style="display:none">Section</span><span class="OIndex" style="display:none">Script Section</span></span></h2>
<p>Script execution is easier to follow and debug when the code is written in a modular way.  To support modular scripting, LabTalk script files can be divided into sections, which are declared by placing the desired section name in square brackets [ ] on its own line:
</p>
<dl><dd><font color="navy">[<i>SectionName</i>]</font></dd></dl>
<p>Lines of script under the section declaration belong to that section. Execution of LabTalk in a  section ends when another section declaration is met, when a return statement is executed or when a Command Error occurs. The framework of a typical multi-section OGS file might look like the following:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">&#91;</span>Main<span style="color: #000000;">&#93;</span>
<span style="color: #008000;">// Script Lines</span>
ty In section Main;

<span style="color: #000000;">&#91;</span>Section <span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span>
<span style="color: #008000;">// Script Lines</span>
ty In section <span style="color: #0000dd;">1</span>;

<span style="color: #000000;">&#91;</span>Section <span style="color: #0000dd;">2</span><span style="color: #000000;">&#93;</span>
<span style="color: #008000;">// Script Lines</span>
ty In section <span style="color: #0000dd;">2</span>;</pre>
<p>Note here that <b>ty</b> issues the <b>type</b> command, which is possible since no other commands in Origin begin with the letters 'ty'.
</p>
<h2><a name="Running_an_OGS_File"></a><span class="mw-headline">Running an OGS File</span></h2>
<p><span class="OIndex" style="display:none">Run an OGS File</span>
</p><p>Use the <a href="../../LabTalk/LabTalk/Run_(object).html" title="LabTalk:Run (object)"><b>run</b> object</a> to execute script files.
</p>
<dl><dd><i><a href="../../LabTalk/LabTalk/Run_(object).html" title="LabTalk:Run (object)">run.section(OGSFileName, SectionName[,arg1 arg2 ... arg5])</a></i> </dd></dl>
<dl><dd><i><a href="../../LabTalk/LabTalk/Run_(object).html" title="LabTalk:Run (object)">run.file(OGSFileName)</a></i> </dd></dl>
<table class="note">

<tr>
<td><b>Important Note:</b>
<p>Because they are more robust, it is <i>strongly suggested</i> that you use <b>run.file()</b> or <b>run.section()</b> methods to execute LabTalk OGS files, rather than the older <a href="../../LabTalk/LabTalk/OGSFileName_(command).html" title="LabTalk:OGSFileName (command)"><b>command</b> object</a> or <a href="../../LabTalk/LabTalk/Run_(command).html#no_option.3B_Run_the_script_file_scriptfileName" title="LabTalk:Run (command)"><b>run</b> command</a> methods.
</p><p>When using the <a href="../../LabTalk/LabTalk/Run_(object).html" title="LabTalk:Run (object)"><b>run</b> object</a>, if the OGS file is in the User Files Folder, you do not need to specify a path to the file. If it is in a subfolder of the UFF, use a relative path. If it is outside the UFF, use a full path to the file.
</p>
</td></tr></table>
<p><br />
Thus, if you save a file called <b>test.ogs</b> to your Origin User Files folder:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Runs test.ogs with run.file() syntax:</span>
run.<span style="color: #000080;">file</span><span style="color: #000000;">&#40;</span>test<span style="color: #000000;">&#41;</span>
<span style="color: #008000;">// Runs only section1 of test.ogs with run.section() syntax:</span>
run.<span style="color: #000080;">section</span><span style="color: #000000;">&#40;</span>test, section1<span style="color: #000000;">&#41;</span></pre>
<p>if the file <b>test.ogs</b> is saved under <b>D:\OgsFiles</b>:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Runs test.ogs with run.file() syntax:</span>
run.<span style="color: #000080;">file</span><span style="color: #000000;">&#40;</span>D<span style="color: #000000;">:</span>\OgsFiles\test<span style="color: #000000;">&#41;</span>
<span style="color: #008000;">// Runs only section1 of test.ogs with run.section() syntax:</span>
run.<span style="color: #000080;">section</span><span style="color: #000000;">&#40;</span>D<span style="color: #000000;">:</span>\OgsFiles\test, section1<span style="color: #000000;">&#41;</span></pre>
<p><b>Note:</b> A different means to run an OGS file is to recognize it as an object. After saving the OGS file, you need to run the <b><a class="external text" href="../../XFunction/X-Function/Cd.html">cd</a></b> X-Function (<code>cd 1;</code>) to change to the folder where the file was saved or use <b>dir</b> to list files in the <i>current working folder</i> - if that is where the file is. Otherwise, Origin does not detect the file and will not see it as a runnable command.
</p><p>After Origin recognizes an OGS filename as an object, run the OGS file by entering its name or name.sectionname into the Script Window or Command Window. If either the file name or section name contains a space quotes must surround both. For example:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Run a LabTalk Script named 'My Script.ogs' located in the folder </span>
<span style="color: #008000;">//'D:\OgsFiles'.</span>

<span style="color: #008000;">// Change the current directory to 'D:\OgsFiles'</span>
cd D<span style="color: #000000;">:</span>\OgsFiles; <span style="color: #008000;">// This causes Origin to scan that folder for OGS files</span>
<span style="color: #008000;">// This runs the code in section 'Beta Test' of 'My Scripts.ogs'</span>
<span style="color: #008000;">// passing three arguments separated by spaces (protected by quotes where needed)</span>
<span style="color: #ff00ff;">&quot;My Scripts.Beta Test&quot;</span> <span style="color: #ff00ff;">&quot;Redundant Test&quot;</span> <span style="color: #0000dd;">5</span> <span style="color: #ff00ff;">&quot;Output Averages&quot;</span>;</pre>
<p>There are many examples in Origin's <b>Samples\LabTalk Script Examples</b> folder which can be accessed by executing:
</p>
<pre class="lt" style="font-family:monospace;">cd <span style="color: #0000dd;">2</span>;</pre>
<h2><a name="Passing_Arguments_in_ScriptsArgument.2C_Script_FilePass_Arguments_in_Script"></a><span class="mw-headline">Passing Arguments in Scripts<span class="OIndex" style="display:none">Argument, Script File</span><span class="OIndex" style="display:none">Pass Arguments in Script</span></span></h2>
<p>When you use the <b><a href="../../LabTalk/LabTalk/Run_(object).html" title="LabTalk:Run (object)">run.section()</a></b> object method to call a script file (or one of its sections) or a macro, you can pass arguments with the call.  Arguments can be literal text, numbers, numeric variables, or string variables.  
</p><p>When passing arguments to script file sections or to macros:
</p>
<ul><li>The section call or the macro call must include a space between each argument being passed. When using run.section, a comma must separate the section name from the first argument only.</li></ul>
<ul><li>When you pass literal text or string variables as arguments, each argument must be surrounded by quotation marks (in case the argument contains more than one word, or is a negative value).  Passing numbers or numeric variables doesn't require quotation mark protection, except when passing negative values. </li></ul>
<ul><li>You can pass up to five arguments, separated by <b>Space</b>, to script file sections or macros. In the script file section or macro definition, argument placeholders receive the passed arguments.  These placeholders are&#160;%1,&#160;%2,&#160;%3,&#160;%4, and&#160;%5. The <span class="OIndex">placeholder</span> for the first passed argument is&#160;%1, the second is&#160;%2, etc. These placeholders work like string variables in that they are substituted prior to execution of the command in which they are embedded. The number of arguments passed is contained in <i>macro.narg</i>.</li></ul>
<p>As an example of passing literal text as an argument that is received by&#160;%1,&#160;%2, etc.,
Suppose a TEST.OGS file includes the following section:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">&#91;</span>output<span style="color: #000000;">&#93;</span>
type <span style="color: #ff00ff;">&quot;%1&#160;%2&#160;%3&quot;</span>;</pre>
<p>and you execute the following script:
</p>
<pre class="lt" style="font-family:monospace;">run.<span style="color: #000080;">section</span><span style="color: #000000;">&#40;</span>test.<span style="color: #000080;">ogs</span>, output, <span style="color: #ff00ff;">&quot;Hello World&quot;</span> from LabTalk<span style="color: #000000;">&#41;</span>;</pre>
<p>Here,&#160;%1 holds "Hello World",&#160;%2 holds "from", and&#160;%3 holds "LabTalk".  After string substitution, Origin outputs 
</p>
<pre class="lt" style="font-family:monospace;">Hello World from LabTalk</pre>
<p>to the Script window.  If you had omitted the quotation marks from the script file section call, then&#160;%1 would hold "Hello",&#160;%2 would hold "World", and&#160;%3 would hold "from".  Origin would then output 
</p>
<pre class="lt" style="font-family:monospace;">Hello World from</pre>
<h3><a name="Passing_Numeric_Variables_by_ReferencePass_Variables_by_Reference"></a><span class="mw-headline">Passing Numeric Variables by Reference<span class="OIndex" style="display:none">Pass Variables by Reference</span></span></h3>
<p>Passing numeric variable arguments by reference allows the code in the script file section or macro to change the value of the variable.  
</p><p>For example, suppose your application used the variable <b>LastRow</b> to hold the row number of the last row in column B that contains a value.  Furthermore, suppose that the current value of<b> LastRow</b> is 10.  If you pass the variable <b>LastRow</b> to a script file section whose code appends five values to column B (starting at the current last row), after appending the values, the script file section could increment the value of the <b>LastRow</b> variable so that the updated value of <b>LastRow</b> is 15.  
</p><p>See example:
</p><p>If a TEST.OGS file includes the following section:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">&#91;</span>adddata<span style="color: #000000;">&#93;</span>	
	loop <span style="color: #000000;">&#40;</span>n, <span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">5</span><span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
	    <span style="color: #000080;">%</span>1<span style="color: #000000;">&#91;</span><span style="color: #000080;">%</span>2 <span style="color: #000080;">+</span> n<span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">100</span>;
	<span style="color: #000000;">&#125;</span>;
	<span style="color: #000080;">%</span>2 <span style="color: #000080;">=</span> <span style="color: #000080;">%</span>2 <span style="color: #000080;">+</span> <span style="color: #000000;">&#40;</span>n <span style="color: #000080;">-</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
	return <span style="color: #0000dd;">0</span>;</pre>
<p>And you execute the following script:
</p>
<pre class="lt" style="font-family:monospace;">col<span style="color: #000000;">&#40;</span>b<span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> data<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">10</span><span style="color: #000000;">&#41;</span>;   <span style="color: #008000;">// fill data1_b with values</span>
get col<span style="color: #000000;">&#40;</span>b<span style="color: #000000;">&#41;</span> <span style="color: #000080;">-</span>e lastrow;  <span style="color: #008000;">// store last row of values in lastrow</span>
run.<span style="color: #000080;">section</span><span style="color: #000000;">&#40;</span>test.<span style="color: #000080;">ogs</span>, adddata, col<span style="color: #000000;">&#40;</span>b<span style="color: #000000;">&#41;</span> lastrow<span style="color: #000000;">&#41;</span>;
lastrow <span style="color: #000080;">=</span>&#160;;</pre>
<p>Then <b>LastRow</b> is passed by reference and then updated to hold the value 15.
</p>
<h3><a name="Passing_Numeric_Variables_by_ValuePass_Variables_by_Value"></a><span class="mw-headline">Passing Numeric Variables by Value<span class="OIndex" style="display:none">Pass Variables by Value</span></span></h3>
<p>Passing numeric variable arguments by value is accomplished by using the <a href="../../LabTalk/LabTalk/Numeric_to_String_Conversion.html" title="LabTalk:Numeric to String Conversion">$() substitution</a> notation.  This notation forces the interpreter to evaluate the argument before sending it to the script file section or macro.  This technique is useful for sending the value of a calculation for future use.  If the calculation were sent by <a href="#Passing_Numeric_Variables_by_ReferencePass_Variables_by_Reference">reference</a>, the entire expression would require calculation each time it was interpreted.
</p><p>In the following script file example, numeric variable <i>var</i> is passed by reference and by value.&#160;%1 will hold the argument that is passed by reference and&#160;%2 will hold the argument that is passed by value. Additionally, a string variable (%A) consisting of two words is sent by value as a single argument to&#160;%3.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">&#91;</span>typing<span style="color: #000000;">&#93;</span>
	type <span style="color: #000080;">-</span>b <span style="color: #ff00ff;">&quot;The value of&#160;%1 =&#160;%2&#160;%3&quot;</span>;
	return <span style="color: #0000dd;">0</span>;</pre>
<p>Save the section to <i>Test.OGS</i> and run the following script on command window:
</p>
<pre class="lt" style="font-family:monospace;">var <span style="color: #000080;">=</span> <span style="color: #0000dd;">22</span>;
<span style="color: #000080;">%</span>A <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;degrees Celsius&quot;</span>;
run.<span style="color: #000080;">section</span><span style="color: #000000;">&#40;</span>test.<span style="color: #000080;">ogs</span>, typing, var <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>var<span style="color: #000000;">&#41;</span> <span style="color: #ff00ff;">&quot;%A&quot;</span><span style="color: #000000;">&#41;</span>;</pre>
<p>Then a dialog box pop-up and says: "The value of var = 22 degrees Celsius".
</p>
<h2><a name="Guidelines_for_Naming_OGS_Files_and_Sections"></a><span class="mw-headline">Guidelines for Naming OGS Files and Sections</span></h2>
<p>Naming rules for OGS script files differ based on how they will be called.  The section above discusses the two primary methods: calling using the <b>run.section()</b> method or the <b>command</b> method which entails calling directly from the Script or Command window (not recommended).
</p>
<h3><a name="When_Using_the_Run.section.28.29_Method"></a><span class="mw-headline">When Using the <a href="../../LabTalk/LabTalk/Run_(object).html" title="LabTalk:Run (object)">Run.section()</a> Method</span></h3>
<ul><li> There is no restriction on the length or type of characters used to name the OGS file.</li>
<li> Specifying the filename extension is optional for files with the OGS extension.</li>
<li> When using run.section( ) inside an OGS file to call another section of that same OGS file, the filename may be omitted, for instance:</li></ul>
<pre class="lt" style="font-family:monospace;"><span style="color: #000000;">&#91;</span>main<span style="color: #000000;">&#93;</span>
run.<span style="color: #000080;">section</span><span style="color: #000000;">&#40;</span> , calculate<span style="color: #000000;">&#41;</span>;

<span style="color: #000000;">&#91;</span>calculate<span style="color: #000000;">&#93;</span>
cc <span style="color: #000080;">=</span> aa <span style="color: #000080;">+</span> bb;</pre>
<h3><a name="When_Using_the_Command_Method"></a><span class="mw-headline">When Using the Command Method</span></h3>
<ul><li> The name of the OGS file must conform to the restrictions on command names: 25 characters or fewer, must not begin with a number or special character, must not contain spaces or underscore characters.</li>
<li> The filename extension <i>must</i> be OGS and must <i>not</i> be specified.</li></ul>
<h3><a name="Section_Name_Rules_.28When_Using_Either_Method.29"></a><span class="mw-headline">Section Name Rules (When Using Either Method)</span></h3>
<ul><li> When SectionName is omitted,</li></ul>
<dl><dd><ol><li> Origin looks for a section named <b>[Main]</b> and executes it if found</li>
<li> If no <b>[Main]</b> section is found, but code without a section name exists at the beginning of the file, then that code is executed.</li>
<li> Otherwise Origin does nothing and does not report an error.</li></ol></dd></dl>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/From_Files/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>Do not give an OGS file the same name as an existing <a href="../../LabTalk/Category/Alphabetical_Listing_of_Functions_(LabTalk).html" title="Category:Alphabetical Listing of Functions (LabTalk)">Origin function</a> or <a class="external text" href="../../XFunction/X-Function/Alphabetic_List_to_X-Functions.html">X-Function</a>!
</p></td></tr></table>
<h2><a name="Setting_the_Path"></a><span class="mw-headline">Setting the Path</span></h2>
<p>In Origin 7.5, script files (*.OGS) could be run from both the <b>Origin System</b> and <b>User Files</b> folders, and these are the <span class="OIndex">current working directory</span><span class="OIndex" style="display:none">current working folder</span> by default. If your script file resides there, there is no need to change the <span class="OIndex">path</span><span class="OIndex HasShownIndex" style="display:none">Set Path</span>. If the script file was not located in either of these two folders, the full path needed to be specified in the <a href="../../LabTalk/LabTalk/Run_(object).html#Methods:" title="LabTalk:Run (object)">run.section() object method</a>. Since Origin 8, the idea of the <span class="OIndex">Current Working Folder</span> (CWF) was introduced, allowing you to run your own script files and X-Functions located in the CWF you have specified.
</p><p>Per MS-DOS convention, Origin uses the <a class="external text" href="../../XFunction/X-Function/Cd.html">cd</a><span class="OIndex" style="display:none">cd</span> X-Function to display the CWF:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Entering this command displays the current working folder </span>
<span style="color: #008000;">// in the Script Window. </span>
cd</pre>
<p>and unless it has been changed, the output is similar to:
</p>
<pre>
current working directory:
C:\Documents and Settings\User\My Documents\OriginLab\Origin8.1\User Files\ 
</pre>
<p>However, if you write many scripts, you will want to organize them into folders, and call these scripts from where they reside.  Also, Origin provides sample scripts that you may want to run from their respective directories.
</p><p>In the case or run.section( ) scripts can reside in subfolders of the User Files Folder and you can use relative referencing such as:
</p>
<pre class="lt" style="font-family:monospace;">run.<span style="color: #000080;">section</span><span style="color: #000000;">&#40;</span>subfolder1\scriptA,main<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// ScriptA.ogs is in subfolder1</span>
run.<span style="color: #000080;">section</span><span style="color: #000000;">&#40;</span>subfolder2\scriptA,main<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// ScriptA.ogs is in subfolder2</span></pre>
<p>You can set the Current Working Folder from script.  For example, to run an OGS file named <b>ave_curves.ogs</b>, located in the Origin system sub-folder <b>Samples\LabTalk Script Examples</b>, enter the following:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create a string variable to hold the complete path to the desired</span>
<span style="color: #008000;">//script file</span>
<span style="color: #008000;">// by appending folder path to Origin system path:</span>
path<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\LabTalk Script Examples\&quot;</span>;
<span style="color: #008000;">// Make the desired path the current directory.</span>
cd path<span style="color: #000080;">$</span>;
<span style="color: #008000;">// Call the function</span>
ave_curves;</pre>
<p>You can create a set of pre-defined paths. The <a class="external text" href="../../XFunction/X-Function/Cdset.html">cdset</a> X-Function is used to list all the pre-defined paths and add/change the CWF. By typing
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// The 'cdset' command displays pre-defined paths </span>
<span style="color: #008000;">//in the Script Window. </span>
cdset</pre>
<p>you should see three paths like below if you have not changed them yet.
</p>
<pre>
1 = C:\Documents and Settings\User\My Documents\OriginLab\Origin8.1\User Files\
2 = C:\Program Files\OriginLab\Origin81\Samples\LabTalk Script Examples\
3 = C:\Program Files\OriginLab\Origin81\ 
</pre>
<p>If you want to set the second path above to be the CWF, just type:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Changes the CWF to the folder path specified</span>
<span style="color: #008000;">// by pre-defined path #2.</span>
cd <span style="color: #0000dd;">2</span></pre>
<p>To add a new path to pre-defined folder set, first change to the new path, making it the CWF, then add it to the set by using <b>cdset</b> X-Function with the specified index. For example:
</p>
<pre class="lt" style="font-family:monospace;">cd D<span style="color: #000000;">:</span>\Files\Filetype\Script;  <span style="color: #008000;">// Set this new path as CWF</span>
<span style="color: #008000;">// Add this path to pre-defined folder list, to the 4th postion (index 4)</span>
<span style="color: #008000;">// If there already is a path with index 4, it will be over-written</span>
cdset <span style="color: #0000dd;">4</span>;
<span style="color: #008000;">// If the CWF is changed manually, it can now be reset to </span>
<span style="color: #008000;">// 'D:\Files\Filetype\Script\' by entering 'cd 4'.</span></pre>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/From_Files/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>A few tips for working with the <b>cdset</b> command:
</p>
<ul><li> Folder paths added to the pre-defined set in one project are saved for use with other projects.  </li>
<li> To see the current paths displayed to the Script Window, enter 'cdset' by itself on a line in the Script Window.</li>
<li> Up to 9 pre-defined paths are supported.</li>
<li> Indices can be assigned out of order.</li>
<li> A new path, assigned to an index for which a current path exists, will overwrite the current path.</li></ul>
</td></tr></table>
<p>As the three default pre-defined paths show above, the second one contains several sample script files (with the <b>OGS</b> extension). Similar to DOS, you can go to this folder by <i>cd 2</i>, then see the valid OGS using the <a class="external text" href="../../XFunction/X-Function/Dir.html">dir</a> X-Function, and then run any available script file in this folder, such as:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Set 2nd folder as the CWF</span>
cd <span style="color: #0000dd;">2</span>;
<span style="color: #008000;">// List all ogs and X-Function in the CWF</span>
dir;
<span style="color: #008000;">// Run a script file</span>
<span style="color: #008000;">// Note that the file extension is not needed when calling it</span>
autofit;</pre>
<p>You can also load the script file in the CWF into Code Builder by using <a href="../../LabTalk/LabTalk/Ed_(object).html" title="LabTalk:Ed (object)">ed.open()</a> method. Such as:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// In this case, the OGS extension on the filename is required!</span>
ed.<span style="color: #000080;">open</span><span style="color: #000000;">&#40;</span>pick_bad_data.<span style="color: #000080;">ogs</span><span style="color: #000000;">&#41;</span></pre>
<h2><a name="Running_LabTalk_from_Origin_C"></a><span class="mw-headline">Running LabTalk from Origin C</span></h2>
<p>Besides running .OGS files directly, LabTalk commands and scripts can also be run from Origin C. For more information, please refer to <a class="external text" href="../../OriginC/Category/LabTalk_Interface_(global_function).html">LabTalk Interface</a> global function of Origin C help document.
</p>

