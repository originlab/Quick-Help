<h1 class="firstHeading">2.13.1.2 Differentiation</h1><p class='urlname' style='display: none'>Differentiation</p>
<h2><a name="Finding_the_DerivativeCalculusDifferentiation"></a><span class="mw-headline">Finding the Derivative<span class="OIndex" style="display:none">Calculus</span><span class="OIndex" style="display:none">Differentiation</span></span></h2>
<p>The following example shows how to calculate the derivative of a dataset.  Note that the <b><a class="external text" href="../../XFunction/X-Function/Differentiate.html">differentiate</a></b> X-Function is used, and that it allows higer-order <span class="OIndex">derivative</span>s as well:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Import the data</span>
newbook; 
fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;\Samples\Spectroscopy\HiddenPeaks.dat&quot;</span>;
impasc;

<span style="color: #008000;">// Calculate the 1st and 2nd derivatives of the data in Column 2:</span>

<span style="color: #008000;">// Output defaults to the next available column, Column 3</span>
differentiate iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span>Col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>;      
<span style="color: #008000;">// Output goes into Column 4 by default       </span>
differentiate iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span>Col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> order<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>;    

<span style="color: #008000;">// Plot the source data and the results</span>

<span style="color: #008000;">// Each plot uses Column 1 as its x-values</span>
plotstack iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>, <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>, <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span> order<span style="color: #000000;">:</span><span style="color: #000080;">=</span>top;</pre>
<h2><a name="Finding_the_Derivative_with_Smoothing"></a><span class="mw-headline">Finding the Derivative with Smoothing</span></h2>
<p>The <b><a class="external text" href="../../XFunction/X-Function/Differentiate.html">differentiate</a></b> X-Function also allows you to obtain the derivatives using Savitsky-Golay <span class="OIndex">smoothing</span>. If you want to use this capability, set the <b>smooth</b> variable to 1. Then you can customize the smoothing by specifying the polynomial order and the points of window used in the Savitzky-Golay smoothing method.  The example below illustrates this.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Import a sample data with noise</span>
newbook;
fpath<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;\Samples\Signal Processing\fftfilter1.DAT&quot;</span>; 
fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> fpath<span style="color: #000080;">$</span>;
impasc;
bkname<span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #000080;">%</span>h;

<span style="color: #008000;">// Differentiate using Savitsky-Golay smoothing</span>
differentiate iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> smooth<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> poly<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> npts<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">30</span>;

<span style="color: #008000;">// Plot the source data and the result</span>
newpanel row<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>;
plotxy iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>bkname<span style="color: #000080;">$</span><span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #0000dd;">2</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">200</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;	
plotxy iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>bkname<span style="color: #000080;">$</span><span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #0000dd;">3</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">200</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>;</pre>






