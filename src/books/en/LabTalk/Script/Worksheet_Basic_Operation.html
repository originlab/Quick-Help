<h1 class="firstHeading">2.7.2.1 Basic Worksheet Operation</h1><p class='urlname' style='display: none'>Worksheet-Basic-Operation</p>
<p>The basic worksheet operations include  adding worksheet to workbook, activating a worksheet, getting and setting worksheet properties, deleting worksheet, etc. And these operations can be done by using <a href="../../LabTalk/LabTalk/Page_(object).html" title="LabTalk:Page (object)">Page</a> and <a href="../../LabTalk/LabTalk/Wks_(object).html" title="LabTalk:Wks (object)">Wks</a> objects, together with some <a href="../../LabTalk/Script/LabTalk-Supported_X-Functions.html#Data_Manipulation" title="Script:LabTalk-Supported X-Functions">Data Manipulation X-Functions</a>. Some practical examples are provided below.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Add_New_Worksheet"><span class="tocnumber">1</span> <span class="toctext">Add New Worksheet</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Activate_a_Worksheet"><span class="tocnumber">2</span> <span class="toctext">Activate a Worksheet</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Modify_Worksheet_Properties"><span class="tocnumber">3</span> <span class="toctext">Modify Worksheet Properties</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Using_Worksheet_Object"><span class="tocnumber">3.1</span> <span class="toctext">Using Worksheet Object</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Using_X-Functions"><span class="tocnumber">3.2</span> <span class="toctext">Using X-Functions</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Delete_Worksheet"><span class="tocnumber">4</span> <span class="toctext">Delete Worksheet</span></a></li>
</ul>
</div>

<h2><a name="Add_New_Worksheet"></a><span class="mw-headline">Add New Worksheet</span></h2>
<p>The <a class="external text" href="../../XFunction/X-Function/Newsheet.html"><b>newsheet</b></a> X-Function can be used to add new worksheets to a workbook.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create a new workbook with 3 worksheets, </span>
<span style="color: #008000;">// and use &quot;mydata&quot; as long name and short name</span>
newbook name<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;mydata&quot;</span> sheet<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span> option<span style="color: #000000;">:</span><span style="color: #000080;">=</span>lsname;
<span style="color: #008000;">// Add a worksheet named &quot;source&quot; with 4 columns to current workbook</span>
newsheet name<span style="color: #000000;">:</span><span style="color: #000080;">=</span>source cols<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span>;</pre>
<h2><a name="Activate_a_Worksheet"></a><span class="mw-headline">Activate a Worksheet</span></h2>
<p><span class="OIndex" style="display:none">Active Worksheet</span><span class="OIndex" style="display:none">Active Window</span><span class="OIndex" style="display:none">Active Workbook</span><span class="OIndex" style="display:none">Active Matrixbook</span><span class="OIndex" style="display:none">Active Column</span><a href="../../LabTalk/Category/LT_Workbooks.html" title="Category:LT Workbooks">Workbook</a> is an Origin object that contains worksheets which then contain columns. 
Worksheets in a workbook are internally layers in a <a href="../../LabTalk/LabTalk/Page_(object).html" title="LabTalk:Page (object)">page</a>. In other words, a worksheet is derived from a layer object and a workbook derived from a page object. The active layer in a page is represented by the <i>page.active</i> or <i>page.active$</i> property, and thus it is used to active a worksheet.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create a new workbook with 4 worksheets</span>
newbook sheet<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span>;

page.<span style="color: #000080;">active</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;	<span style="color: #008000;">// Active worksheet by index</span>
page.<span style="color: #000080;">active</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> sheet3;	<span style="color: #008000;">// Active worksheet by name</span></pre>
<h2><a name="Modify_Worksheet_Properties"></a><span class="mw-headline">Modify Worksheet Properties</span></h2>
<h4><a name="Using_Worksheet_Object"></a><span class="mw-headline">Using Worksheet Object</span></h4>
<p>When a worksheet is active, you can type <b>wks.=</b> and press Enter to list all <a href="../../LabTalk/LabTalk/Wks_(object).html" title="LabTalk:Wks (object)">worksheet properties</a>. Most of these properties are writable so you can modify it directly. For example:
<span class="OIndex" style="display:none">Rename worksheet</span>
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Rename the active worksheet</span>
wks.<span style="color: #000080;">name</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Raw Data;
<span style="color: #008000;">// Set the number of columns to 4</span>
wks.<span style="color: #000080;">ncols</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">4</span>;
<span style="color: #008000;">// Modify the column width to 8 character</span>
wks.<span style="color: #000080;">colwidth</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">8</span>;
<span style="color: #008000;">// Show the first user-defined parameter on worksheet header</span>
wks.<span style="color: #000080;">userparam1</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;</pre>
<p>Two properties, wks.maxRows and wks.nRows are similar. The former one find the largest row index that has value in the worksheet, while the later set or read the number of rows in the worksheet. You can see the different in the following script.
</p>
<pre class="lt" style="font-family:monospace;">newbook;  <span style="color: #008000;">// Create a new workbook</span>
col<span style="color: #000000;">&#40;</span>b<span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">10</span><span style="color: #000000;">&#125;</span>;  <span style="color: #008000;">// Set column B with 1-10 for the first ten rows</span>
wks.<span style="color: #000080;">maxRows</span> <span style="color: #000080;">=</span>&#160;;
wks.<span style="color: #000080;">nRows</span> <span style="color: #000080;">=</span>&#160;;</pre>
<p>Origin outputs 10 for wks.maxRows; while outputs 32 for wks.nRows.
</p><p>If the worksheet is not the active one, you can specify the full worksheet name (including workbook name) before <b>wks</b> object, the syntax is
</p><p><b>[<i>WorkbookName</i>]<i>WorksheetNameOrIndex</i>!wks</b>
</p><p>Or you can use the range of the worksheet. For example
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Open a project</span>
string strOpj<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span>;
strOpj<span style="color: #000080;">$</span> <span style="color: #000080;">+</span><span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Samples\COM Server and Client\Basic Stats on Data.opj&quot;</span>;
doc <span style="color: #000080;">-</span>o <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>strOpj<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>;

wks.<span style="color: #000080;">nCols</span> <span style="color: #000080;">=</span>&#160;;  <span style="color: #008000;">// Output number of columns in the active worksheet</span>
<span style="color: #008000;">// Output number of columns in the worksheet [RawData]Data!</span>
<span style="color: #000000;">&#91;</span>RawData<span style="color: #000000;">&#93;</span>Data<span style="color: #000080;">!</span>wks.<span style="color: #000080;">nCols</span> <span style="color: #000080;">=</span>&#160;;  
<span style="color: #008000;">// Output the name of the first worksheet in RawData workbook</span>
<span style="color: #000000;">&#91;</span>RawData<span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span>wks.<span style="color: #000080;">name</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span>&#160;;  

<span style="color: #008000;">// Use range</span>
range rWks <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>RawData<span style="color: #000000;">&#93;</span>Data<span style="color: #000080;">!</span>;  <span style="color: #008000;">// Range for the Data worksheet in RawData workbook</span>
rWks.<span style="color: #000080;">userparam1</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;  <span style="color: #008000;">// Show the first user-defined parameter in worksheet</span></pre>
<h4><a name="Using_X-Functions"></a><span class="mw-headline">Using X-Functions</span></h4>
<p>Besides <a href="../../LabTalk/LabTalk/Wks_(object).html" title="LabTalk:Wks (object)">wks object</a>, you can also use X-Functions to modify worksheet properties. These X-Function names are usually with the starting letter "w". Such as <a class="external text" href="../../XFunction/X-Function/Wcolwidth.html">wcolwidth</a>, <a class="external text" href="../../XFunction/X-Function/Wcellformat.html">wcellformat</a> and <a class="external text" href="../../XFunction/X-Function/Wclear.html">wclear</a>, etc. So we can also resize the column with as below without using wks.colwidth:
</p>
<pre class="lt" style="font-family:monospace;">wcolwidth <span style="color: #0000dd;">2</span> <span style="color: #0000dd;">10</span>; <span style="color: #008000;">// Set the 2nd column width to 10</span></pre>
<h2><a name="Delete_Worksheet"></a><span class="mw-headline">Delete Worksheet</span></h2>
<p><span class="OIndex" style="display:none">Delete Worksheet</span>
The <b><a href="../../LabTalk/LabTalk/Layer_(command)&amp;action=edit&amp;redlink=1.html" class="new" title="LabTalk:Layer (command) (page does not exist)">layer -d</a></b> command can be used to delete a worksheet or graph layer.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create a new workbook with 6 worksheets</span>
<span style="color: #008000;">// Workbook name is stored into MyBook$</span>
<span style="color: #008000;">// And the first worksheet will be the active one</span>
newbook sheet<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">6</span> result<span style="color: #000000;">:</span><span style="color: #000080;">=</span>MyBook<span style="color: #000080;">$</span>;

<span style="color: #008000;">// Add a new worksheet with name of &quot;My Sheet&quot;</span>
newsheet name<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;My Sheet&quot;</span>;

page.<span style="color: #000080;">active</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;  <span style="color: #008000;">// Activate the first worksheet</span>
layer <span style="color: #000080;">-</span>d;  <span style="color: #008000;">// Delete the active worksheet</span>

<span style="color: #008000;">// Delete a worksheet by index</span>
<span style="color: #008000;">// Delete the third worksheet (or layer) in the active workbook (or graph)</span>
layer <span style="color: #000080;">-</span>d <span style="color: #0000dd;">3</span>;

<span style="color: #008000;">// Delete a worksheet by name</span>
layer <span style="color: #000080;">-</span>d <span style="color: #ff00ff;">&quot;Sheet5&quot;</span>;

<span style="color: #008000;">// Delete a specified worksheet by range</span>
range rs <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span><span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>MyBook<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#93;</span><span style="color: #ff00ff;">&quot;My Sheet&quot;</span><span style="color: #000080;">!</span>;  <span style="color: #008000;">// Define a range to a specified worksheet</span>
layer <span style="color: #000080;">-</span>d rs;

<span style="color: #008000;">// Delete a worksheet whose name is stored in a string variable</span>
string strSheet<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Sheet3&quot;</span>;
layer <span style="color: #000080;">-</span>d <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>strSheet<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>;</pre>
<p>To delete a worksheet whose name is stored in a string variable, there are some special string variables for some special worksheets, for example:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//__report$ holds the name of the last report sheet Origin created</span>
layer <span style="color: #000080;">-</span>d <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>__report<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>;</pre>
<p>The variable <b>__report$</b> is an example of a system-created string variable that records the last-used instance of a particular object. A list of such variables can be found in <a href="../../LabTalk/LabTalk/Last_Used_System_Variables.html" title="LabTalk:Last Used System Variables">Reference Tables</a>.
</p>





