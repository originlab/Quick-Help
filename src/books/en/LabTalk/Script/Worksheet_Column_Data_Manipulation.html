<h1 class="firstHeading">2.7.3.2 Worksheet Column Data Manipulation</h1><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Basic_Operation"><span class="tocnumber">1</span> <span class="toctext">Basic Operation</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Basic_ArithmeticArithmetic"><span class="tocnumber">1.1</span> <span class="toctext">Basic Arithmetic<span class="OIndex" style="display:none">Arithmetic</span></span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#FunctionsFunction"><span class="tocnumber">1.2</span> <span class="toctext">Functions<span class="OIndex" style="display:none">Function</span></span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4"><a href="#Set_Formula_for_ColumnSet_Column_Values"><span class="tocnumber">2</span> <span class="toctext">Set Formula for Column<span class="OIndex" style="display:none">Set Column Values</span></span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Copy_ColumnCopy_Column"><span class="tocnumber">3</span> <span class="toctext">Copy Column<span class="OIndex" style="display:none">Copy Column</span></span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Sort_Column"><span class="tocnumber">4</span> <span class="toctext">Sort Column</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Reverse_Column"><span class="tocnumber">5</span> <span class="toctext">Reverse Column</span></a></li>
</ul>
</div>

<h2><a name="Basic_Operation"></a><span class="mw-headline">Basic Operation</span></h2>
<p>Once you have loaded or created some numeric data, here are some script examples of things you may want to do.
</p>
<h3><a name="Basic_ArithmeticArithmetic"></a><span class="mw-headline">Basic Arithmetic<span class="OIndex" style="display:none">Arithmetic</span></span></h3>
<p>Most often data is stored in columns and you want to perform various operations on that data in a row-wise fashion.  You can do this in two ways in your LabTalk scripts: (1) through direct statements with operators or (2) using ranges.  For example, you want to add the value in each row of column A to its corresponding value in column B, and put the resulting values in column C:
</p>
<pre class="lt" style="font-family:monospace;">Col<span style="color: #000000;">&#40;</span>C<span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> Col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span> <span style="color: #000080;">+</span> Col<span style="color: #000000;">&#40;</span>B<span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// Add </span>
Col<span style="color: #000000;">&#40;</span>D<span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> Col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span> <span style="color: #000080;">*</span> Col<span style="color: #000000;">&#40;</span>B<span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// Multiply</span>
Col<span style="color: #000000;">&#40;</span>E<span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> Col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span> <span style="color: #000080;">/</span> Col<span style="color: #000000;">&#40;</span>B<span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// Divide</span></pre>
<p>The <b>-</b> and <b>^</b> operators work the just as above for subtraction and exponentiation respectively.
</p><p>You can also perform the same operations on columns from different sheets with range variables:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Point to column 1 of sheets 1, 2 and 3</span>
range aa <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span><span style="color: #000080;">!</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
range bb <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span><span style="color: #000080;">!</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
range cc <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span><span style="color: #000080;">!</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
cc <span style="color: #000080;">=</span> aa<span style="color: #000080;">+</span>bb;
cc <span style="color: #000080;">=</span> aa<span style="color: #000080;">^</span>bb;
cc <span style="color: #000080;">=</span> aa<span style="color: #000080;">/</span>bb;</pre>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Worksheet_Column_Data_Manipulation/Alert_icon.png?v=0" width="57"  border="0" /></td><td><p>When performing arithmetic on data in different sheets, you need to use range variables.  Direct references to range strings are not supported.  For example, the script <b>Sheet3!col(1) = Sheet1!col(1) + Sheet2!col(1);</b> will not work!
</p>
	</td>
	</tr>
	</table>
<h3><a name="FunctionsFunction"></a><span class="mw-headline">Functions<span class="OIndex" style="display:none">Function</span></span></h3>
<p>In addition to standard operators, LabTalk supports many common functions for working with your data, from trigonometric functions like <b><a href="../../LabTalk/LabTalk/Sin_(function).html" title="LabTalk:Sin (function)">sin</a></b> and <b><a href="../../LabTalk/LabTalk/Cos_(function).html" title="LabTalk:Cos (function)">cos</a></b> to Bessel functions to functions that generate statistical distributions like <b><a href="../../LabTalk/LabTalk/Uniform_(function).html" title="LabTalk:Uniform (function)">uniform</a></b> and <b><a href="../../LabTalk/LabTalk/Poisson_(function).html" title="LabTalk:Poisson (function)">Poisson</a></b>.  All LabTalk functions work with single-number arguments of course, but many are also "vectorized" in that they work on worksheet columns, loose datasets, and matrices as well.  Take the trigonometric function <b>sin</b> for example: 
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Find the sine of a number:</span>
double xx <span style="color: #000080;">=</span> sin<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0.3572</span><span style="color: #000000;">&#41;</span></pre>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Find the sine of a column of data (row-wise):</span>
Col<span style="color: #000000;">&#40;</span>B<span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> sin<span style="color: #000000;">&#40;</span>Col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span></pre>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Find the sine of a matrix of data (element-wise):</span>
<span style="color: #000000;">&#91;</span>MBook2<span style="color: #000000;">&#93;</span> <span style="color: #000080;">=</span> sin<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#91;</span>MBook1<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span></pre>
<p>As an example of a function whose primary job is to generate data consider the <b>uniform</b> function, which in one form takes as input <i>N</i>, the number of values to create, and then generates <i>N</i> uniformly distributed random numbers between 0 and 1:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000; font-style: regular;">/* Fill the first 20 rows of Column B 
   with uniformly distributed random numbers: */</span>
Col<span style="color: #000000;">&#40;</span>B<span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> uniform<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">20</span><span style="color: #000000;">&#41;</span>;</pre>
<p>For a complete list of functions supported by LabTalk see <a href="../../LabTalk/Category/Alphabetical_Listing_of_Functions_(LabTalk).html" title="Category:Alphabetical Listing of Functions (LabTalk)"> Alphabetic Listing of Functions</a>.
</p>
<h2><a name="Set_Formula_for_ColumnSet_Column_Values"></a><span class="mw-headline">Set Formula for Column<span class="OIndex" style="display:none">Set Column Values</span></span></h2>
<p><span class="OIndex" style="display:none">Set Column Value</span><span class="OIndex" style="display:none">Formula</span><span class="OIndex" style="display:none">Set Formula</span>
</p><p>In the Origin GUI, the Set Column Values dialog can be used to generate or transform data in worksheet columns using a specified formula. Such transformation can also be performed in LabTalk by using the <a class="external text" href="../../XFunction/X-Function/Csetvalue.html">csetvalue</a> X-Function. Here are some examples on how to set column value using LabTalk.
</p>
<pre class="lt" style="font-family:monospace;">newbook;
wks.<span style="color: #000080;">ncols</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;
<span style="color: #008000;">// Fill column 1 with random numbers</span>
csetvalue formula<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;rnd()&quot;</span> col<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
<span style="color: #008000;">// Transform data in column 1 to integer number between 0 ~ 100</span>
csetvalue formula<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;int(col(1)*100)&quot;</span> col<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>;
<span style="color: #008000;">// Specify Before Formula Script when setting column value</span>
<span style="color: #008000;">// and set recalculate mode to Manual</span>
csetvalue formula<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;mm - col(2)&quot;</span> col<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span> script<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;int mm = max(col(2))&quot;</span> recalculate<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>;
string str<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span><span style="color: #000080;">%</span>h<span style="color: #000000;">&#93;</span><span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>page.<span style="color: #000080;">active</span><span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">!</span>;
newsheet cols<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
<span style="color: #008000;">// Use range variables to refer to a column in another sheet</span>
csetvalue f<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;r1/r2&quot;</span> c<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> s<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;range r1=%(str$)2; range r2=%(str$)3;&quot;</span> r<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;</pre>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Worksheet_Column_Data_Manipulation/Alert_icon.png?v=0" width="57"  border="0" /></td><td><p>When logic statement is used to set formula for columns, values such as 0.0, NANUM (missing value) and values between -1.0E-290 to 1.0E-290 will be evaluated to be <i>False</i>. For instance, LabTalk command will return a value 0 (False) instead of 1 (True). 
</p>
<pre class="lt" style="font-family:monospace;">type <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span><span style="color: #000080;">-</span>1e<span style="color: #000080;">-</span>290?<span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Returns 0 (False)</span>
type <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">/</span><span style="color: #0000dd;">0</span>?<span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Returns 0 (False), where 1/0 == NANUM</span></pre>
	</td>
	</tr>
	</table>
<h2><a name="Copy_ColumnCopy_Column"></a><span class="mw-headline">Copy Column<span class="OIndex" style="display:none">Copy Column</span></span></h2>
<p>The <a class="external text" href="../../XFunction/X-Function/Colcopy.html">colcopy</a> X-Function copies column(s) of data including column label rows and column format such as date or text and numeric.
</p><p>The following example copies columns two through four of the active worksheet to columns one through three of sheet1 in book2:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Both the data and format as well as each column long name, </span>
<span style="color: #008000;">// units and comments gets copied:</span>
colcopy irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">:</span><span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span> orng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>book2<span style="color: #000000;">&#93;</span>sheet1<span style="color: #000080;">!</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span> data<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> 
        format<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> lname<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> units<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> comments<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;</pre>
<h2><a name="Sort_Column"></a><span class="mw-headline">Sort Column</span></h2>
<p>To sort a specified column, you can use <a class="external text" href="../../XFunction/X-Function/Wsort.html">wsort</a> X-Function. And when using this X-Function to sort just one column, the arguments <b>c1</b> and <b>c2</b> should be the same column in worksheet, and the <b>bycol</b> also needs to be the same as <b>c1</b>.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create a new workbook</span>
newbook;

<span style="color: #008000;">// Fill first column with row number, and second column with uniform random number</span>
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">32</span><span style="color: #000000;">&#125;</span>;
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> uniform<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">32</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Sort column 2 descending</span>
wsort c1<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span> c2<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span> bycol<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span> descending<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;</pre>
<h2><a name="Reverse_Column"></a><span class="mw-headline">Reverse Column</span></h2>
<p>The X-Function <a class="external text" href="../../XFunction/X-Function/Colreverse.html">colreverse</a> is available for reversing column. 
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create a new workbook</span>
newbook;

<span style="color: #008000;">// Fill first column with row number, and second column with uniform random number</span>
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">32</span><span style="color: #000000;">&#125;</span>;
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> uniform<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">32</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Reverse column 1 by using index</span>
colreverse rng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;  <span style="color: #008000;">// colreverse rng:=col(A);  // this also works</span>

<span style="color: #008000;">// Reverse column 2 by using range variable</span>
range rr <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
colreverse rng<span style="color: #000000;">:</span><span style="color: #000080;">=</span>rr;</pre>


