<h1 class="firstHeading">2.9.2 Formatting Graphs</h1><p class='urlname' style='display: none'>Formatting-Graphs</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Graph_Window"><span class="tocnumber">1</span> <span class="toctext">Graph Window</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Page_Properties"><span class="tocnumber">2</span> <span class="toctext">Page Properties</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Layer_Properties"><span class="tocnumber">3</span> <span class="toctext">Layer Properties</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Fill_the_Layer_Background_Color"><span class="tocnumber">3.1</span> <span class="toctext">Fill the Layer Background Color</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Set_Speed_Mode_Properties"><span class="tocnumber">3.2</span> <span class="toctext">Set Speed Mode Properties</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Update_the_Legend"><span class="tocnumber">3.3</span> <span class="toctext">Update the Legend</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-7"><a href="#Axis_PropertiesAxis_Property"><span class="tocnumber">4</span> <span class="toctext">Axis Properties<span class="OIndex" style="display:none">Axis Property</span></span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Data_Plot_Properties"><span class="tocnumber">5</span> <span class="toctext">Data Plot Properties</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Legend_and_Label"><span class="tocnumber">6</span> <span class="toctext">Legend and Label</span></a></li>
</ul>
</div>

<h2><a name="Graph_Window"></a><span class="mw-headline">Graph Window</span></h2>
<p>A <span class="OIndex">graph</span> window is comprised of a visual page, with an associated <a href="../../LabTalk/LabTalk/Page_(object).html" title="LabTalk:Page (object)"><b>Page</b> (Object)</a>.  Each graph page contains at least one visual layer, with an associated <a href="../../LabTalk/LabTalk/Layer_(object).html" title="LabTalk:Layer (object)"><b>layer</b> object</a>.  The graph layer contains a set of X Y axes with associated <b><a href="../../LabTalk/LabTalk/Layer.Axis_(object).html" title="LabTalk:Layer.Axis (object)">layer.x</a></b> and <b><a href="../../LabTalk/LabTalk/Layer.Axis_(object).html" title="LabTalk:Layer.Axis (object)">layer.y</a></b> objects, which are sub-objects of the <b>layer</b> object.
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Formatting_Graphs/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>When you have a range variable mapped to a graph page or graph layer, you can use that variable name in place of the word <b>page</b> or <b>layer</b>.
</p></td></tr></table>
<h2><a name="Page_Properties"></a><span class="mw-headline">Page Properties</span></h2>
<p>The <b><a href="../../LabTalk/LabTalk/Page_(object).html" title="LabTalk:Page (object)">page</a></b> object is used to access and modify properties of the active graph window.  To output a list of all properties of this object:
</p>
<pre class="lt" style="font-family:monospace;">page.<span style="color: #000080;">=</span></pre>
<p>The list will contain both numeric and text properties.  When setting a text (string) property value, the <b>$</b> follows the property name.
</p><p>To read the Short name of the active window:
</p>
<pre class="lt" style="font-family:monospace;">page.<span style="color: #000080;">name</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Graph3&quot;</span>;</pre>
<p>To read the Long name of the active window:
</p>
<pre class="lt" style="font-family:monospace;">page.<span style="color: #000080;">longname</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;This name can contain spaces&quot;</span>;</pre>
<p>You can also access Graph properties<span class="OIndex" style="display:none">graph property</span> or attributes using a range variable instead of the <b>page</b> object.  The advantage is that using a range variable works whether or not the desired graph is active.
</p><p>The example below sets the <span class="OIndex">active graph layer</span> to layer 2, using a range variable to point to the desired graph by name.  Once declared, the range variable can be used in place of <b>page</b>:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//Create a Range variable that points to your graph</span>
range rGraph <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>Graph3<span style="color: #000000;">&#93;</span>;
<span style="color: #008000;">//The range now has properties of the page object</span>
rGraph.<span style="color: #000080;">active</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>;</pre>
<h2><a name="Layer_Properties"></a><span class="mw-headline">Layer Properties</span></h2>
<p>The <b><a href="../../LabTalk/LabTalk/Layer_(object).html" title="LabTalk:Layer (object)">layer</a></b> object is used to access and modify properties of the <span class="OIndex">graph layer</span>.
</p><p>To set the graph layer dimensions:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//Set the layer area units to cm</span>
layer.<span style="color: #000080;">unit</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span>;
<span style="color: #008000;">//Set the Width</span>
layer.<span style="color: #000080;">width</span><span style="color: #000080;">=</span><span style="color: #0000dd;">5</span>;
<span style="color: #008000;">//Set the Height </span>
layer.<span style="color: #000080;">height</span><span style="color: #000080;">=</span><span style="color: #0000dd;">5</span>;</pre>
<h3><a name="Fill_the_Layer_Background_Color"></a><span class="mw-headline">Fill the Layer Background Color</span></h3>
<p>The <b><a class="external text" href="../../XFunction/X-Function/Laycolor.html">laycolor</a></b> X-Function is used to fill the layer background color.  The value you pass to the function for color, corresponds to Origin's <a href="../../LabTalk/LabTalk/List_of_Colors.html" title="LabTalk:List of Colors">color list</a> as seen in the Plot Details dialog (1=black, 2=red, 3=green, etc).
</p><p>To fill the background color of layer 1 as green:
</p>
<pre class="lt" style="font-family:monospace;">laycolor layer<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> color<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span>;</pre>
<h3><a name="Set_Speed_Mode_Properties"></a><span class="mw-headline">Set Speed Mode Properties</span></h3>
<p>The <a class="external text" href="../../XFunction/X-Function/Speedmode.html"><b>speedmode</b> X-Function</a> is used to set layer <span class="OIndex">speed mode</span> properties.
</p>
<h3><a name="Update_the_Legend"></a><span class="mw-headline">Update the Legend</span></h3>
<p>The <a class="external text" href="../../XFunction/X-Function/Legendupdate.html"><b>legendupdate</b> X-Function</a> is used to update or reconstruct the <span class="OIndex">graph legend</span> on the page/layer.
</p>
<h2><a name="Axis_PropertiesAxis_Property"></a><span class="mw-headline">Axis Properties<span class="OIndex" style="display:none">Axis Property</span></span></h2>
<p>The <b><a href="../../LabTalk/LabTalk/Layer.Axis_(object).html" title="LabTalk:Layer.Axis (object)">layer.x</a></b> and <b><a href="../../LabTalk/LabTalk/Layer.Axis_(object).html" title="LabTalk:Layer.Axis (object)">layer.y</a></b> sub-object of the <b>layer</b> object is used to modify properties of the axes.
</p><p>To modify the X scale of the active layer:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//Set the scale to Log10</span>
layer.<span style="color: #000080;">x</span>.<span style="color: #000080;">type</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
<span style="color: #008000;">//Set the start value</span>
layer.<span style="color: #000080;">x</span>.<span style="color: #000080;">from</span> <span style="color: #000080;">=</span> .001;
<span style="color: #008000;">//Set the end value</span>
layer.<span style="color: #000080;">x</span>.<span style="color: #000080;">to</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1000</span>;
<span style="color: #008000;">//Set the increment value</span>
layer.<span style="color: #000080;">x</span>.<span style="color: #000080;">inc</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;</pre>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Formatting_Graphs/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>If you wish to work with the Y scale, then simply change the x in the above script to a y. If you wish to work with a layer that is not active, you can specify the layer index, layer<i>N</i>.x.from.  Example:  layer3.y.from = 0; 
</p></td></tr></table>
<p>The <b><a href="../../LabTalk/LabTalk/Axis_(command).html" title="LabTalk:Axis (command)">Axis</a></b> command can also be used to access the settings in the Axis dialog.
</p><p>To change the X Axis Tick Labels to use the values from column C, given a plot of col(B) vs. col(A) with text in col(C), from Sheet1 of Book1: 
</p>
<pre class="lt" style="font-family:monospace;">range aa <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>Book1<span style="color: #000000;">&#93;</span>Sheet1<span style="color: #000080;">!</span>col<span style="color: #000000;">&#40;</span>C<span style="color: #000000;">&#41;</span>;
axis <span style="color: #000080;">-</span>ps X T aa;</pre>
<h2><a name="Data_Plot_Properties"></a><span class="mw-headline">Data Plot Properties</span></h2>
<p>The <a href="../../LabTalk/Category/Set_(command).html" title="Category:Set (command)"><b>Set</b> (Command)</a> is used to change the attributes of a <span class="OIndex">data plot</span>. The following example shows how the <b><span class="OIndex">Set</span></b> command works by changing the properties of the same dataplot several times. In the script, we use <a href="../../LabTalk/LabTalk/Second_(command).html" title="LabTalk:Second (command)">sec command</a> to pause one second before changing <span class="OIndex">plot style</span>s.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Make up some data</span>
newbook;
col<span style="color: #000000;">&#40;</span>a<span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">5</span><span style="color: #000000;">&#125;</span>;
col<span style="color: #000000;">&#40;</span>b<span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> col<span style="color: #000000;">&#40;</span>a<span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// Create a scatter plot</span>
plotxy col<span style="color: #000000;">&#40;</span>b<span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Set symbol size</span>
<span style="color: #008000;">//&#160;%C is the active dataset</span>
sec <span style="color: #000080;">-</span>p <span style="color: #0000dd;">1</span>;
set <span style="color: #000080;">%</span>C <span style="color: #000080;">-</span>z <span style="color: #0000dd;">20</span>;
<span style="color: #008000;">// Set symbol shape</span>
sec <span style="color: #000080;">-</span>p <span style="color: #0000dd;">1</span>;
set <span style="color: #000080;">%</span>C <span style="color: #000080;">-</span>k <span style="color: #0000dd;">3</span>;
<span style="color: #008000;">// Set symbol color</span>
sec <span style="color: #000080;">-</span>p <span style="color: #0000dd;">1</span>;
set <span style="color: #000080;">%</span>C <span style="color: #000080;">-</span>c color<span style="color: #000000;">&#40;</span>blue<span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// Connect the symbols</span>
sec <span style="color: #000080;">-</span>p <span style="color: #0000dd;">1</span>;
set <span style="color: #000080;">%</span>C <span style="color: #000080;">-</span>l <span style="color: #0000dd;">1</span>;
<span style="color: #008000;">// Change plot line color</span>
sec <span style="color: #000080;">-</span>p <span style="color: #0000dd;">1</span>;
set <span style="color: #000080;">%</span>C <span style="color: #000080;">-</span>cl color<span style="color: #000000;">&#40;</span>red<span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// Set line width to 4 points</span>
sec <span style="color: #000080;">-</span>p <span style="color: #0000dd;">1</span>;
set <span style="color: #000080;">%</span>C <span style="color: #000080;">-</span>w <span style="color: #0000dd;">2000</span>;
<span style="color: #008000;">// Change solid line to dash</span>
sec <span style="color: #000080;">-</span>p <span style="color: #0000dd;">1</span>;
set <span style="color: #000080;">%</span>C <span style="color: #000080;">-</span>d <span style="color: #0000dd;">1</span>;</pre>
<p>Here is another example which plots into a template, <i>DoubleY</i>, with two layers, and then sets dataplot style for the dataplot in the second layer:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Importing data</span>
newbook;
string fn<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Curve Fitting\Enzyme.dat&quot;</span>; 
impasc fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>fn<span style="color: #000080;">$</span>;
<span style="color: #008000;">//declare active worksheet range</span>
range rr <span style="color: #000080;">=</span> <span style="color: #000080;">!</span>;
<span style="color: #008000;">//plot into a template</span>
plotxy iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">200</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span><span style="color: #000080;">&lt;</span>new template<span style="color: #000000;">:</span><span style="color: #000080;">=</span>DoubleY<span style="color: #000080;">&gt;</span><span style="color: #000000;">&#93;</span>;
<span style="color: #008000;">//plot into second layer of active graph, which is graph created from line above</span>
plotxy iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>rr<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">200</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span><span style="color: #000080;">!</span>;
<span style="color: #008000;">//declare range for first dataplot in layer 2</span>
range r2 <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span><span style="color: #000080;">!</span><span style="color: #0000dd;">1</span>;
<span style="color: #008000;">//set line to dash</span>
set r2 <span style="color: #000080;">-</span>d <span style="color: #0000dd;">1</span>;</pre>
<h2><a name="Legend_and_Label"></a><span class="mw-headline">Legend and Label</span></h2>
<p>Formatting the Legend and Label are discussed on <a href="../../LabTalk/Script/Creating_and_Accessing_Graphical_Objects.html" title="Script:Creating and Accessing Graphical Objects">Creating and Accessing Graphical Objects</a>.
</p>

