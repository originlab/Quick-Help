<h1 class="firstHeading">2.11.3 Exporting Matrices</h1><p class='urlname' style='display: none'>Exporting-Matrices</p>
<p><span class="OIndex" style="display:none">Export Matrix</span><span class="OIndex" style="display:none">Matrix Export</span>Matrices can store image data as well as non-image data in Origin.  In fact, <i>all</i> images in Origin are stored as matrices, whether or not they are rendered as a picture or displayed as pixel values.  A <span class="OIndex">matrix</span> can be exported no matter which type of content it holds.
</p><p>Exporting matrices with script is achieved with two X-Functions: <b>expMatAsc</b> for a non-image matrix and <b>expImage</b> for an image matrix.
</p>
<h2><a name="Exporting_a_Non-Image_Matrix"></a><span class="mw-headline">Exporting a Non-Image Matrix</span></h2>
<p>To export a matrix that holds non-image data to an ASCII file use the <a class="external text" href="../../XFunction/X-Function/ExpMatASC.html"><b>expMatAsc</b> X-Function</a>.  Allowed export extenstions are *.dat (type:=0), *.txt (type:=1), *.csv (type:=2), and all file types (type:=3).
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Export a matrix (in Matrix Book 1, Matrix Sheet 1) to a file of </span>
<span style="color: #008000;">// the *.csv type named TEST.CSV with xy-gridding turned on.</span>

expMatASC im<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>MBook1<span style="color: #000000;">&#93;</span>MSheet1 type<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span> path<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;D:\TEST.CSV&quot;</span> xygrid<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;</pre>
<p>See the page <b>Export Graphs/Data/Videos</b>, for <a href="../../LabTalk/LabTalk/Export.html#Export_Data" title="LabTalk:Export">more data export examples</a>.
</p>
<h2><a name="Exporting_an_Image_Matrix"></a><span class="mw-headline">Exporting an Image Matrix</span></h2>
<p>Matrix windows in Origin can contain multiple sheets, and each sheet can contain multiple matrix objects.  A matrix object can contain an image as RGB values (default, reported as three numbers in a single matrix cell, each matrix cell corresponds to a pixel), or as gray-scale data (a single gray-scale number in each matrix cell). 
</p><p>For example, a user could import an image into a matrix object (as RGB values) and later convert it to gray-scale data (i.e., the gray-scale pixel values) using the <b>Image</b> menu.  Whether the matrix object contains RGB or gray-scale data, the contents of the matrix can be exported as an image file to disk, using the <a class="external text" href="../../XFunction/X-Function/ExpImage.html"><b>expImage</b> X-Function</a>.  For example, the following script command exports the first matrix object in Sheet 1 of matrixbook MBook 1:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Export the image matrix as a *.tif image:</span>
expImage im<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>MBook1<span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #0000dd;">1</span> type<span style="color: #000000;">:</span><span style="color: #000080;">=</span>tif fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;c:\flower&quot;</span></pre>
<p>When exporting to a raster-type image format (includes JPEG, GIF, PNG, TIF), one may want to specify the bit-depth as well as the resolution (in dots-per-inch, DPI).  This is achieved with the <b>expImage</b> options tree, <b>tr</b>.  The X-Function call specifying these options might look like this:
</p>
<pre class="lt" style="font-family:monospace;">expImage im<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>MBook1<span style="color: #000000;">&#93;</span>MSheet1<span style="color: #000080;">!</span> type<span style="color: #000000;">:</span><span style="color: #000080;">=</span>png fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;D:\TEST.PNG&quot;</span>
tr.<span style="color: #000080;">PNG</span>.<span style="color: #000080;">bitsperpixel</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;24-bit Color&quot;</span>
tr.<span style="color: #000080;">PNG</span>.<span style="color: #000080;">dotsperinch</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">300</span>;</pre>
<p><a class="external text" href="../../XFunction/X-Function/Details_of_Image_Settings_in_Export_Image.html">All nodes of the tree <b>tr</b></a>, are described in the online or product (CHM) help.
</p>





