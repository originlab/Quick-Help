<h1 class="firstHeading">2.5.1.6 From Graphical Objects</h1><p class='urlname' style='display: none'>From-Graphical-objs</p>
<p><span class="OIndex" style="display:none">Run Script from Graphic Object</span><span class="OIndex">Graphic Object</span>s (text, lines and shapes) can be tied to events and contain <span class="OIndex">script</span> that runs on those events or by using the run method for those objects. Since graphical objects are attached to a page, they are saved in Templates, Window files and Project files.
</p>
<h2><a name="Buttons"></a><span class="mw-headline">Buttons</span></h2>
<p>Some of your scripts may be used so often that you would like to automate their execution by assigning one or more of them to a button on the Origin project's graphical-user interface (GUI).  To do so, follow the steps below:
</p><p>From a new open Origin project:
</p>
<ol><li> Select the <b>Text</b> tool <a  class="image"><img alt="Button Text Tool.png" src="../images/From_Graphical_Objects/Button_Text_Tool.png?v=0" width="23"  /></a> from the <b>Tools</b> toolbar to the left side of the project window. </li>
<li> Click on an open space on your graph or worksheet (on a worksheet, click in the gray area to the right of the last column).  This will put you into edit mode.  Type "Hello" in the text object and click outside the object. You have now created a label for the button.</li>
<li> Hold down the ALT key while double-clicking on the text object that you just created.  The object dialog opens to the <b>Programming</b> tab.</li>
<li> Note that there is an object <b>Name</b> in the upper left of the dialog. Change this to <i>Greeting</i>.</li>
<li> In the lower text box, enter this script:<pre class="lt" style="font-family:monospace;">type <span style="color: #000080;">-</span>b <span style="color: #ff00ff;">&quot;Hello World&quot;</span>;</pre></li>
<li> From the <b>Script Run After</b> drop-down list, select <b>Button Up</b>, and click <b>OK</b>.</li>
<li> You have now created a button that, when pressed, executes your script and prints "Hello World" in a pop-up window.</li></ol>
<p>Unlike a text script that exists only in the <b>Script Window</b>, this button and the script that it runs will be saved when you save your Origin project.
</p><p>The script behind any graphic object can be run using its name and the run method. Open the Script Window (<b>Window: Script Window</b>) and type:
</p>
<pre class="lt" style="font-family:monospace;">greeting.<span style="color: #000080;">run</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span></pre>
<p>and press Enter.
</p>
<h2><a name="Lines"></a><span class="mw-headline">Lines</span></h2>
<p>Here is a script that creates a vertical line on a graph that can be moved to report the interpolated value of your data at the X position represented by the line:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create a vertical line on our graph</span>
draw <span style="color: #000080;">-</span>n MyCursor <span style="color: #000080;">-</span>l <span style="color: #000080;">-</span>v <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>x1<span style="color: #000080;">+</span><span style="color: #000000;">&#40;</span>x2<span style="color: #000080;">-</span>x1<span style="color: #000000;">&#41;</span><span style="color: #000080;">/</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>;
MyCursor.<span style="color: #000080;">HMOVE</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;               <span style="color: #008000;">// Allow horizontal movement</span>
MyCursor.<span style="color: #000080;">color</span> <span style="color: #000080;">=</span> color<span style="color: #000000;">&#40;</span>orange<span style="color: #000000;">&#41;</span>;   <span style="color: #008000;">// Change color to orange</span>
MyCursor.<span style="color: #000080;">linewidth</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;           <span style="color: #008000;">// Make line thicker</span>
<span style="color: #008000;">// Add a label to the graph</span>
label <span style="color: #000080;">-</span>sl <span style="color: #000080;">-</span>a <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>MyCursor.<span style="color: #000080;">x</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>Y2<span style="color: #000080;">+</span><span style="color: #0000dd;">0.05</span><span style="color: #000080;">*</span><span style="color: #000000;">&#40;</span>Y2<span style="color: #000080;">-</span>Y1<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">-</span>n MyLabel <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span><span style="color: #000080;">%</span>C<span style="color: #000000;">&#40;</span>MyCursor.<span style="color: #000080;">x</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// Assign a script to the line ..</span>
MyCursor.<span style="color: #000080;">script</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;MyLabel.x = MyCursor.x;
MyLabel.y = Y2 + MyLabel.dy;
doc -uw;&quot;</span>;
<span style="color: #008000;">// .. and make the script run after the line is moved</span>
MyCursor.<span style="color: #000080;">Script</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;</pre>
<h2><a name="Other_Objects"></a><span class="mw-headline">Other Objects</span></h2>
<p>Any Graphical Object (text, lines and shapes) can have an attached script that runs when an event occurs.
</p><p>In this example, a rectangle (named RECT) on a graph is set to have a script run when the rectangle is either Moved or Sized.
</p>
<ol>
<li> Use the Rectangle tool on the <b>Tools</b> toolbar to draw a rectangle on a graph.
<li> Use the Back(data) tool on the <b>Object Edit</b> toolbar to push the rectangle behind the data.
<li> Hold down the Alt key and double-click on the rectangle to open <b>Programming Control</b>. Note that the objects name is Rect.
<li> Enter the following script:
<pre class="lt" style="font-family:monospace;"><span style="color: #000080;">%</span>B <span style="color: #000080;">=</span> <span style="color: #000080;">%</span>C;
<span style="color: #000080;">%</span>A <span style="color: #000080;">=</span> xof<span style="color: #000000;">&#40;</span><span style="color: #000080;">%</span>B<span style="color: #000000;">&#41;</span>;
dataset dsRect;
dsRect <span style="color: #000080;">=</span> <span style="color: #000000;">&#40;</span><span style="color: #000000;">&#40;</span><span style="color: #000080;">%</span>A <span style="color: #000080;">&gt;=</span> rect.<span style="color: #000080;">x1</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">&amp;&amp;</span> <span style="color: #000000;">&#40;</span><span style="color: #000080;">%</span>A <span style="color: #000080;">&lt;=</span> rect.<span style="color: #000080;">x2</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">&amp;&amp;</span> 
          <span style="color: #000000;">&#40;</span><span style="color: #000080;">%</span>B <span style="color: #000080;">&gt;=</span> rect.<span style="color: #000080;">y3</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">&amp;&amp;</span> <span style="color: #000000;">&#40;</span><span style="color: #000080;">%</span>B <span style="color: #000080;">&lt;=</span> rect.<span style="color: #000080;">y1</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>?<span style="color: #000080;">%</span>B<span style="color: #000000;">:</span><span style="color: #0000dd;">0</span><span style="color: #000080;">/</span><span style="color: #0000dd;">0</span>;
stats dsRect;
delete dsRect;
type <span style="color: #000080;">-</span>a Mean of <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>stats.<span style="color: #000080;">mean</span><span style="color: #000000;">&#41;</span>;</pre>
<li> Choose the <b>Moved or Sized</b> event in the Script, Run After drop down list.
<li> Click OK.
</ol>
<p>When you Move or Resize this rectangle, the script calculates the mean of all the points within the rectangle and types the result to the Script Window. You can also define a Graphic Object range and run the script like:
</p>
<pre class="lt" style="font-family:monospace;">GObject gobj <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>Graph1<span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span>rect;
gobj.<span style="color: #000080;">run</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</pre>






