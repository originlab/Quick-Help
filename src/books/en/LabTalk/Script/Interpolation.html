<h1 class="firstHeading">2.13.1.4 Interpolation</h1><p class='urlname' style='display: none'>Interpolation</p>
<p>Interpolation is one of the more common mathematical functions performed on data, and Origin supports interpolation in two ways: (1) interpolation of single values and datasets through range notation and (2) interpolation of entire curves by X-Functions.  
</p><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Interpolation_at_Given_Index_Values"><span class="tocnumber">1</span> <span class="toctext">Interpolation at Given Index Values</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Finding_Interpolated_Y_at_Given_X_Values"><span class="tocnumber">2</span> <span class="toctext">Finding Interpolated Y at Given X Values</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Using_XY_Range"><span class="tocnumber">2.1</span> <span class="toctext">Using XY Range</span></a>
<ul>
<li class="toclevel-3 tocsection-4"><a href="#From_Worksheet_Data"><span class="tocnumber">2.1.1</span> <span class="toctext">From Worksheet Data</span></a></li>
<li class="toclevel-3 tocsection-5"><a href="#From_Graph"><span class="tocnumber">2.1.2</span> <span class="toctext">From Graph</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-6"><a href="#Using_Arbitrary_Dataset"><span class="tocnumber">2.2</span> <span class="toctext">Using Arbitrary Dataset</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-7"><a href="#Creating_Interpolated_CurvesInterpolated_Curves"><span class="tocnumber">3</span> <span class="toctext">Creating Interpolated Curves<span class="OIndex" style="display:none">Interpolated Curves</span></span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="#X-Functions_for_Interpolation_of_Curves"><span class="tocnumber">3.1</span> <span class="toctext">X-Functions for Interpolation of Curves</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Using_Existing_X_Dataset"><span class="tocnumber">3.2</span> <span class="toctext">Using Existing X Dataset</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Uniformly_Spaced_X_Output"><span class="tocnumber">3.3</span> <span class="toctext">Uniformly Spaced X Output</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Interpolating_Non-Monotonic_Data"><span class="tocnumber">3.4</span> <span class="toctext">Interpolating Non-Monotonic Data</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-12"><a href="#Matrix_InterpolationMatrix_Interpolation"><span class="tocnumber">4</span> <span class="toctext">Matrix Interpolation<span class="OIndex" style="display:none">Matrix Interpolation</span></span></a></li>
</ul>
</div>

<h2><a name="Interpolation_at_Given_Index_Values"></a><span class="mw-headline">Interpolation at Given Index Values</span></h2>
<p><span class="OIndex" style="display:none">Interpolation given index</span>
</p><p>The following example show how to perform interpolation at given index values to find interpolated y values.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Using datasets</span>
dataset d1<span style="color: #000080;">=</span><span style="color: #000000;">&#123;</span><span style="color: #0000dd;">10</span>,<span style="color: #0000dd;">20</span>,<span style="color: #0000dd;">30</span>,<span style="color: #0000dd;">40</span>,<span style="color: #0000dd;">50</span>,<span style="color: #0000dd;">60</span>,<span style="color: #0000dd;">70</span>,<span style="color: #0000dd;">80</span>,<span style="color: #0000dd;">90</span>,<span style="color: #0000dd;">100</span><span style="color: #000000;">&#125;</span>;
dataset d2<span style="color: #000080;">=</span><span style="color: #000000;">&#123;</span><span style="color: #0000dd;">3</span>,<span style="color: #0000dd;">7</span>,<span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">6</span>,<span style="color: #0000dd;">8</span><span style="color: #000000;">&#125;</span>;
dataset d3;
d3<span style="color: #000080;">=</span>d1<span style="color: #000000;">&#40;</span>d2<span style="color: #000000;">&#41;</span>;    <span style="color: #008000;">// Perform interpolation of d1 at index values from d2</span>
type <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>d3<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//d3={30,70,20,60,80};</span>

<span style="color: #008000;">// Using ranges</span>
newbook;
wks.<span style="color: #000080;">ncols</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;
range r1 <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;  <span style="color: #008000;">// Column 1 in active worksheet</span>
r1 <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">10</span>,<span style="color: #0000dd;">20</span>,<span style="color: #0000dd;">30</span>,<span style="color: #0000dd;">40</span>,<span style="color: #0000dd;">50</span>,<span style="color: #0000dd;">60</span>,<span style="color: #0000dd;">70</span>,<span style="color: #0000dd;">80</span>,<span style="color: #0000dd;">90</span>,<span style="color: #0000dd;">100</span><span style="color: #000000;">&#125;</span>;
range r2 <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;  <span style="color: #008000;">// Column 2 in active worksheet to put index values;</span>
r2 <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">3</span>,<span style="color: #0000dd;">7</span>,<span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">6</span>,<span style="color: #0000dd;">8</span><span style="color: #000000;">&#125;</span>;
range r3 <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;  <span style="color: #008000;">// Column 3 in active worksheet;</span>
r3 <span style="color: #000080;">=</span> r1<span style="color: #000000;">&#40;</span>r2<span style="color: #000000;">&#41;</span>; 

<span style="color: #008000;">// Using columns</span>
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#40;</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;</pre>
<h2><a name="Finding_Interpolated_Y_at_Given_X_Values"></a><span class="mw-headline">Finding Interpolated Y at Given X Values</span></h2>
<h3><a name="Using_XY_Range"></a><span class="mw-headline">Using XY Range</span></h3>
<p>An XY Range (<a href="../../LabTalk/LabTalk/Range_Notation.html#Specifying_Subrange_Using_X_Values" title="LabTalk:Range Notation">subrange specified by X values</a> is available) once declared can be used as a function.  The argument to this function can be a scalar - which returns a scalar - or a vector - which returns a vector.  In either case, the X dataset should be increasing or decreasing.  For example:
</p>
<pre class="lt" style="font-family:monospace;">newbook;
wks.<span style="color: #000080;">ncols</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">4</span>;
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> data<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">0</span>,<span style="color: #000080;">-</span>.05<span style="color: #000000;">&#41;</span>;
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> gauss<span style="color: #000000;">&#40;</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>,<span style="color: #0000dd;">0</span>,.5,.2,<span style="color: #0000dd;">100</span><span style="color: #000000;">&#41;</span>;
range rxy <span style="color: #000080;">=</span> <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>;
rxy<span style="color: #000000;">&#40;</span>.67<span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>;
range newx <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>; <span style="color: #008000;">// Use column as X column data</span>
newx <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">0.3333</span>, <span style="color: #0000dd;">0.6667</span>, <span style="color: #0000dd;">1.0</span><span style="color: #000000;">&#125;</span>; <span style="color: #008000;">// Create our new X data</span>
range newy <span style="color: #000080;">=</span> <span style="color: #0000dd;">4</span>; <span style="color: #008000;">// This is the empty column we will interpolate into</span>
newy <span style="color: #000080;">=</span> rxy<span style="color: #000000;">&#40;</span>newx<span style="color: #000000;">&#41;</span>;</pre>
<p>You can then use such range variables as a function with the following form:
</p><p><b>XYRangeVariable(RangeVariableOrScalar[,<i>connect</i>[,<i>param</i>]])</b>
</p><p>where <i>connect</i> is one of the following options:
</p>
<dl><dt>line</dt>
<dd> straight line connection</dd>
<dt>spline</dt>
<dd> spline connection </dd>
<dt>bspline</dt>
<dd> b-spline connection</dd></dl>
<p>and <i>param</i> is smoothing parameter, which applies only to bspline connection method. If <i>param</i>=-1, then a simple bspline is used, which will give same result as bspline line connection type in line plots. If 'param<i> &gt;=0, the NAG <b>nag_1d_spline_function</b> is used.</i>
</p>
<table class="note">

<tr>
<td><b>Notes:</b> When using XY range interpolation, you should guarantee there are no duplicated <i><b>x</b></i> values if you specify <i><b>spline</b></i> or <i><b>bspline</b></i> as the connection method. Instead, you can use interpolation X-Functions.
</td></tr></table>
<h4><a name="From_Worksheet_Data"></a><span class="mw-headline">From Worksheet Data</span></h4>
<p>The following examples show how to perform interpolation using range as function, with data from a worksheet as the argument.
</p><p><b>Example1:</b>
The following code illustrates the usage of the various smoothing parameters for <b>bspline</b>:
</p>
<pre class="lt" style="font-family:monospace;">col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>data<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">9</span><span style="color: #000000;">&#41;</span>;              <span style="color: #008000;">// Fill column 1 with row data</span>
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>normal<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">9</span><span style="color: #000000;">&#41;</span>;              <span style="color: #008000;">// Fill column 2 with random values</span>
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>data<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">9</span>,<span style="color: #0000dd;">0.01</span><span style="color: #000000;">&#41;</span>;         <span style="color: #008000;">// Fill Col(3) with desired X values</span>
wks.<span style="color: #000080;">col3</span>.<span style="color: #000080;">type</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">4</span>;             
range bb<span style="color: #000080;">=</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>;                <span style="color: #008000;">// Declare range using cols 1,2;</span>
<span style="color: #008000;">// Compute interpolated values using different parameter settings</span>
loop<span style="color: #000000;">&#40;</span>i, <span style="color: #0000dd;">4</span>, <span style="color: #0000dd;">10</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span>
   wcol<span style="color: #000000;">&#40;</span>i<span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>bb<span style="color: #000000;">&#40;</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>, bspline, <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>i<span style="color: #000080;">*</span><span style="color: #0000dd;">0.1</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<p><b>Example2:</b>
<span class="OIndex" style="display:none">Finding Y given X</span>
With an XY range, new Y values can be obtained at any X value using code such as:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Generate some data</span>
newbook;
wcol<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span><span style="color: #000000;">&#123;</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">2</span>, <span style="color: #0000dd;">3</span>, <span style="color: #0000dd;">4</span><span style="color: #000000;">&#125;</span>;
wcol<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span><span style="color: #000000;">&#123;</span><span style="color: #0000dd;">2</span>, <span style="color: #0000dd;">3</span>, <span style="color: #0000dd;">5</span>, <span style="color: #0000dd;">6</span><span style="color: #000000;">&#125;</span>;
<span style="color: #008000;">// Define XYrange</span>
range rr <span style="color: #000080;">=</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// Find Y value by linear interpolation at a specified X value.</span>
rr<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1.23</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span>&#160;;    <span style="color: #008000;">// ANS: rr(1.23)=2.23</span>
<span style="color: #008000;">// Find Y value by linear interpolation for an array of X values.</span>
wcol<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span><span style="color: #000000;">&#123;</span><span style="color: #0000dd;">1.5</span>, <span style="color: #0000dd;">2.5</span>, <span style="color: #0000dd;">3.5</span><span style="color: #000000;">&#125;</span>;
range rNewX <span style="color: #000080;">=</span> col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// Add new column to hold the calculated Y values</span>
wks.<span style="color: #000080;">addcol</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
wcol<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> rr<span style="color: #000000;">&#40;</span>rNewX<span style="color: #000000;">&#41;</span>;</pre>
<p><b>Example3:</b>
<span class="OIndex" style="display:none">Finding X given Y</span>
To find X values given Y values, simply reverse the arguments in the examples above.  In the case of finding X given Y, the Y dataset should be increasing or decreasing.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Generate some data</span>
newbook;
wcol<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span><span style="color: #000000;">&#123;</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">2</span>, <span style="color: #0000dd;">3</span>, <span style="color: #0000dd;">4</span><span style="color: #000000;">&#125;</span>;
wcol<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span><span style="color: #000000;">&#123;</span><span style="color: #0000dd;">2</span>, <span style="color: #0000dd;">3</span>, <span style="color: #0000dd;">5</span>, <span style="color: #0000dd;">6</span><span style="color: #000000;">&#125;</span>;
<span style="color: #008000;">// Define XYrange</span>
range rr <span style="color: #000080;">=</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//swapping the X and Y</span>
<span style="color: #008000;">// Find X value by linear interpolation at a specified Y value.</span>
rr<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2.23</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span>&#160;;    <span style="color: #008000;">// ANS: rr(2.23)=1.23;</span>
<span style="color: #008000;">// Add new column to hold the calculated X values</span>
wks.<span style="color: #000080;">addcol</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
range rNewX <span style="color: #000080;">=</span> wcol<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// Find X value by linear interpolation for an array of Y values:</span>
wcol<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span><span style="color: #000000;">&#123;</span><span style="color: #0000dd;">2.5</span>, <span style="color: #0000dd;">3.5</span>, <span style="color: #0000dd;">5.5</span><span style="color: #000000;">&#125;</span>;
range rNewY <span style="color: #000080;">=</span> wcol<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span>;
rNewX <span style="color: #000080;">=</span> rr<span style="color: #000000;">&#40;</span>rNewY<span style="color: #000000;">&#41;</span>;</pre>
<h4><a name="From_Graph"></a><span class="mw-headline">From Graph</span></h4>
<p>You can also use range interpolation when a graph page is active.
</p><p><b>Example 1:</b>
Interpolate an array of values.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Define range on active plot:</span>
range rg <span style="color: #000080;">=</span> <span style="color: #000080;">%</span>C; 
<span style="color: #008000;">// Interpolate for a scalar value using the line connection style:</span>
rg<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3.54</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>;
<span style="color: #008000;">// Interpolate for an array of values:</span>
<span style="color: #008000;">// Give the location of the new X values:</span>
range newX <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>Book2<span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #0000dd;">1</span>;
<span style="color: #008000;">// Give the location where the new Y values (output) should go:</span>
range newY <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>Book2<span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #0000dd;">2</span>;
<span style="color: #008000;">// Compute the new Y values:</span>
newY <span style="color: #000080;">=</span> rg<span style="color: #000000;">&#40;</span>newX<span style="color: #000000;">&#41;</span>;</pre>
<p><b>Example 2:</b>
Specify the interpolation method.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Define range on specific plot:</span>
range <span style="color: #000080;">-</span>wx rWx <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;     <span style="color: #008000;">// Use X of 2nd plot in active layer</span>
range <span style="color: #000080;">-</span>w rWy <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;      <span style="color: #008000;">// Use Y of 2nd plot in active layer</span>
range rr <span style="color: #000080;">=</span> <span style="color: #000000;">&#40;</span>rWx,rWy<span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// Construct an XY range from two ranges</span>
<span style="color: #008000;">// Give the location where the new X values (output) should go:</span>
range newX <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>Book2<span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #0000dd;">1</span>;
newX <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">5</span>,<span style="color: #0000dd;">15</span>,<span style="color: #0000dd;">25</span><span style="color: #000000;">&#125;</span>;
range newY1 <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>Book2<span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #0000dd;">2</span>; <span style="color: #008000;">// Range for new Y</span>
range newY2 <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>Book2<span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #0000dd;">3</span>; <span style="color: #008000;">// Range for new Y</span>
<span style="color: #008000;">// Find new Y values by linear interpolation for an array of X values:</span>
newY1 <span style="color: #000080;">=</span> rr<span style="color: #000000;">&#40;</span>newX<span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// Find new Y values by bspline interpolation for an array of X values:</span>
newY2 <span style="color: #000080;">=</span> rr<span style="color: #000000;">&#40;</span>newX,bspline<span style="color: #000000;">&#41;</span>;</pre>
<h3><a name="Using_Arbitrary_Dataset"></a><span class="mw-headline">Using Arbitrary Dataset</span></h3>
<p>For two arbitrary datasets with the same length, where both are increasing or decreasing, Origin allows you to interpolate from one dataset to the other at a given value. The datasets can be a range variable, dataset variable, or column. The form to perform such interpolation is:
</p><p><b>dataset1(value, dataset2)</b>
</p><p>which will perform interpolation on the group of XY data constructed by <b>dataset2</b> and <b>dataset1</b>, and it will return the so-called Y (<b>dataset1</b>) value at the given so-called X (<b>dataset2</b>) <b>value</b>. For example:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Using datasets</span>
dataset ds1 <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">2</span>, <span style="color: #0000dd;">3</span>, <span style="color: #0000dd;">4</span><span style="color: #000000;">&#125;</span>;
dataset ds2 <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">2</span>, <span style="color: #0000dd;">3</span>, <span style="color: #0000dd;">5</span>, <span style="color: #0000dd;">6</span><span style="color: #000000;">&#125;</span>;
<span style="color: #008000;">// Return interpolated value in ds2 where X in ds1 is 1.23</span>
ds2<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1.23</span>, ds1<span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span>&#160;;  <span style="color: #008000;">// Return 2.23</span>
<span style="color: #008000;">// Return interpolated value in ds1 where X in ds2 is 5.28</span>
ds1<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">5.28</span>, ds2<span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span>&#160;;  <span style="color: #008000;">// Return 3.28</span>

<span style="color: #008000;">// Using ranges</span>
newbook;
wks.<span style="color: #000080;">ncols</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;
range r1 <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;  <span style="color: #008000;">// Column 2 in active worksheet</span>
r1 <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">2</span>, <span style="color: #0000dd;">3</span>, <span style="color: #0000dd;">4</span><span style="color: #000000;">&#125;</span>;
range r2 <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;  <span style="color: #008000;">// Column 3 in active worksheet;</span>
r2 <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">2</span>, <span style="color: #0000dd;">3</span>, <span style="color: #0000dd;">5</span>, <span style="color: #0000dd;">6</span><span style="color: #000000;">&#125;</span>;
r2<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1.23</span>, r1<span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span>&#160;;
r1<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">5.28</span>, r2<span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span>&#160;;

<span style="color: #008000;">// Using columns</span>
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1.23</span>, col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span>&#160;;
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">5.28</span>, col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span>&#160;;</pre>
<h2><a name="Creating_Interpolated_CurvesInterpolated_Curves"></a><span class="mw-headline">Creating Interpolated Curves<span class="OIndex" style="display:none">Interpolated Curves</span></span></h2>
<h3><a name="X-Functions_for_Interpolation_of_Curves"></a><span class="mw-headline">X-Functions for Interpolation of Curves</span></h3>
<p>Origin provides three X-Functions for interpolating XY data and creating a new output XY data pair:
</p>
<table class="simple">
<tr>
<th> Name</th>
<th> Brief Description
</th></tr>
<tr>
<td> <a class="external text" href="../../XFunction/X-Function/Interp1xy.html">interp1xy</a>
</td>
<td>
<p>Perform interpolation of XY data and generate output at uniformly spaced X
</p>
</td></tr>
<tr>
<td> <a class="external text" href="../../XFunction/X-Function/Interp1.html">interp1</a>
</td>
<td>
<p>Perform interpolation of XY data and generate output at a given set of X values
</p>
</td></tr>
<tr>
<td> <a class="external text" href="../../XFunction/X-Function/Interp1trace.html">interp1trace</a>
</td>
<td>
<p>Perform interpolation of XY data that is not monotonic in X
</p>
</td></tr>
</table>
<h3><a name="Using_Existing_X_Dataset"></a><span class="mw-headline">Using Existing X Dataset</span></h3>
<p>The following example shows how to use an existing X dataset to find interpolated Y values:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create a new workbook with specific column designations</span>
newbook sheet<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;
newsheet cols<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span> xy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;XYXY&quot;</span>; 
<span style="color: #008000;">// Import a sample data file</span>
fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Mathematics\Interpolation.dat&quot;</span>;
impasc;

<span style="color: #008000;">// Interpolate the data in col(1) and col(2) with the X values in col(3)</span>
range rResult<span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span>;
interp1 ix<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span> iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#40;</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>, col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span> method<span style="color: #000000;">:</span><span style="color: #000080;">=</span>linear ox<span style="color: #000000;">:</span><span style="color: #000080;">=</span>rResult;

<span style="color: #008000;">//Plot the original data and the result</span>
plotxy iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">202</span> color<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
plotxy iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span>rResult plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">202</span> color<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span> size<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">5</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;</pre>
<h3><a name="Uniformly_Spaced_X_Output"></a><span class="mw-headline">Uniformly Spaced X Output</span></h3>
<p>The following example performs interpolation by generating uniformly spaced X output:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//Create a new workbook and import a data file</span>
fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Mathematics\Sine Curve.dat&quot;</span>;
newbook;
impasc;

<span style="color: #008000;">//Interpolate the data in column 2</span>
interp1xy iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> method<span style="color: #000000;">:</span><span style="color: #000080;">=</span>bspline npts<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">50</span>; 
range rResult <span style="color: #000080;">=</span> col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">//Plot the original data and the result</span>
plotxy iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">202</span> color<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
plotxy iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span>rResult plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">202</span> color<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span> size<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">5</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;</pre>
<h3><a name="Interpolating_Non-Monotonic_Data"></a><span class="mw-headline">Interpolating Non-Monotonic Data</span></h3>
<p>The following example performs trace interpolation on data where X is not monotonic:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//Create a new workbook and import the data file</span>
fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Mathematics\circle.dat&quot;</span>;
newbook;
impasc;

<span style="color: #008000;">//Interpolate the circular data in column 2 with trace interpolation</span>
interp1trace iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span>Col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> method<span style="color: #000000;">:</span><span style="color: #000080;">=</span>bspline; 
range rResult<span style="color: #000080;">=</span> col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">//Plot the original data and the result</span>
plotxy iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">202</span> color<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
plotxy iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span>rResult plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">202</span> color<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span> size<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;</pre>
<p>Note that the interpolation X-Functions can also be used for extrapolating Y values outside of the X range of the input data.
</p>
<h2><a name="Matrix_InterpolationMatrix_Interpolation"></a><span class="mw-headline">Matrix Interpolation<span class="OIndex" style="display:none">Matrix Interpolation</span></span></h2>
<p>The <b><a class="external text" href="../../XFunction/X-Function/Minterp2.html">minterp2</a></b> X-Function can be used to perform interpolation/extrapolation of matrices.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create a new matrixbook and import sample data;</span>
newbook mat<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
filepath<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Samples\Matrix Conversion and Gridding\Direct.dat&quot;</span>;
string fname<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> filepath<span style="color: #000080;">$</span>;
impasc;
<span style="color: #008000;">// Interpolate to a matrix with 10 times the x and y size of the original</span>
range rin <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; <span style="color: #008000;">// point to matrix with input data;</span>
int nx, ny;
nx <span style="color: #000080;">=</span> rin.<span style="color: #000080;">ncols</span> <span style="color: #000080;">*</span> <span style="color: #0000dd;">10</span>;
ny <span style="color: #000080;">=</span> rin.<span style="color: #000080;">nrows</span> <span style="color: #000080;">*</span> <span style="color: #0000dd;">10</span>;
minterp2 method<span style="color: #000000;">:</span><span style="color: #000080;">=</span>bicubic cols<span style="color: #000000;">:</span><span style="color: #000080;">=</span>nx rows<span style="color: #000000;">:</span><span style="color: #000080;">=</span>ny&#160;;</pre>
<p>OriginPro also offers the <b><a class="external text" href="../../XFunction/X-Function/Interp3.html">interp3</a></b> X-Function which can be used to perform interpolation on 4-dimensional scatter data.
</p><p>Origin 2022 makes it easier to get 2D interpolation Z values from a named range
</p>
<pre class="lt" style="font-family:monospace;">range mm<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #0000dd;">1</span>;
mm<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">=</span>;   <span style="color: #008000;">//to get element by index</span>
mm<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1.5</span>, <span style="color: #0000dd;">1.7</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>;    <span style="color: #008000;">// return interpolated value, matrix XY mapping</span>
mm<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1.5</span>, <span style="color: #0000dd;">1.7</span>, spline<span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>; <span style="color: #008000;">//3rd argument supports same items as XF minterp2</span></pre>






