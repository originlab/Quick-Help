<h1 class="firstHeading">2.7.3.1 Basic Worksheet Column Operation</h1><p>To perform operations on worksheet columns, in most situations, you can use <a href="../../LabTalk/LabTalk/Wks.Col_(object)&amp;action=edit&amp;redlink=1.html" class="new" title="LabTalk:Wks.Col (object) (page does not exist)">wks.col</a> object, or the <a href="../../LabTalk/LabTalk/Range_Notation.html" title="LabTalk:Range Notation">Range Notation</a> to the column object. 
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Add_ColumnInsert_ColumnAdd_or_Insert_Column"><span class="tocnumber">1</span> <span class="toctext"><span class="OIndex" style="display:none">Add Column</span><span class="OIndex" style="display:none">Insert Column</span>Add or Insert Column</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Insert_or_Delete_Rows_in_Columns"><span class="tocnumber">2</span> <span class="toctext">Insert or Delete Rows in Columns</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Move_ColumnMove_Column"><span class="tocnumber">3</span> <span class="toctext">Move Column<span class="OIndex" style="display:none">Move Column</span></span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Rename_and_Label_ColumnRename_ColumnColumn_Label"><span class="tocnumber">4</span> <span class="toctext">Rename and Label Column<span class="OIndex" style="display:none">Rename Column</span><span class="OIndex" style="display:none">Column Label</span></span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Hide.2FUnhide_ColumnHide_Column"><span class="tocnumber">5</span> <span class="toctext">Hide/Unhide Column<span class="OIndex" style="display:none">Hide Column</span></span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Swap_Column"><span class="tocnumber">6</span> <span class="toctext"><span class="OIndex">Swap Column</span></span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Modify_Column_Formats"><span class="tocnumber">7</span> <span class="toctext">Modify <span class="OIndex">Column Format</span>s</span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="#Plot_Designation"><span class="tocnumber">7.1</span> <span class="toctext"><span class="OIndex">Plot Designation</span></span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Column_Width"><span class="tocnumber">7.2</span> <span class="toctext"><span class="OIndex">Column Width</span></span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Data_Format_and_Display"><span class="tocnumber">7.3</span> <span class="toctext"><span class="OIndex">Data Format</span> and Display</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-11"><a href="#Add_Sparkline_to_Column"><span class="tocnumber">8</span> <span class="toctext">Add <span class="OIndex">Sparkline</span> to Column</span></a></li>
<li class="toclevel-1 tocsection-12"><a href="#Delete_Column"><span class="tocnumber">9</span> <span class="toctext"><span class="OIndex">Delete Column</span></span></a></li>
</ul>
</div>

<h2><a name="Add_ColumnInsert_ColumnAdd_or_Insert_Column"></a><span class="mw-headline"><span class="OIndex" style="display:none">Add Column</span><span class="OIndex" style="display:none">Insert Column</span>Add or Insert Column</span></h2>
<p>To add a column to the end of the worksheet, you can use the <a href="../../LabTalk/LabTalk/Wks_(object).html#Methods" title="LabTalk:Wks (object)">wks.addCol()</a> method, which will add a column with the specified name, if the specified name is used or ignored, a generic name is chosen for the newly added column.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create a new workbook</span>
newbook;
<span style="color: #008000;">//Turn off &quot;Spreadsheet Cell Notation&quot; (SCN)</span>
page.<span style="color: #000080;">xlcolname</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
<span style="color: #008000;">// Add a new column to the end, with name of Result</span>
wks.<span style="color: #000080;">addCol</span><span style="color: #000000;">&#40;</span>Result<span style="color: #000000;">&#41;</span>;</pre>
<p>The method above is only able to add one column to the end at a time. If you are going to add a multiple columns, you can add columns by setting the number of columns in the worksheet with the <a href="../../LabTalk/LabTalk/Wks_(object).html#Properties" title="LabTalk:Wks (object)">wks.nCols</a> property. For example, the script below will add 3 columns to the end of the active worksheet with the generic names (Note: it is not able to specify the names in this way, please refer to <b>Rename and Label Column</b> section below).
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create a new workbook</span>
newbook;

<span style="color: #008000;">// Add 3 columns to the end of worksheet</span>
wks.<span style="color: #000080;">nCols</span> <span style="color: #000080;">=</span> wks.<span style="color: #000080;">nCols</span> <span style="color: #000080;">+</span> <span style="color: #0000dd;">3</span>;</pre>
<p>Besides adding columns to the end of the worksheet, it is also capable of inserting numbers of columns before the current column. First of all, it needs to specify which column (by 1-based index) is the current column using <a href="../../LabTalk/LabTalk/Wks_(object).html#Properties" title="LabTalk:Wks (object)">wks.col</a> property, and then using <a href="../../LabTalk/LabTalk/Wks_(object).html#Methods" title="LabTalk:Wks (object)">wks.insert()</a> method to <span class="OIndex">insert column</span>(s) before the current column. In the method, you need to specify a list of column names separated by space.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create a new workbook</span>
newbook;

<span style="color: #008000;">// Set column 2 to be the current column</span>
wks.<span style="color: #000080;">col</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
<span style="color: #008000;">//Turn off &quot;Spreadsheet Cell Notation&quot; (SCN)</span>
page.<span style="color: #000080;">xlcolname</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
<span style="color: #008000;">// Insert 3 column before column 2, with the specify column names</span>
wks.<span style="color: #000080;">insert</span><span style="color: #000000;">&#40;</span>DataX DataY Result<span style="color: #000000;">&#41;</span>;</pre>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Basic_Worksheet_Column_Operation/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>For the <a class="external text" href="../../UserGuide/UserGuide/Column_Short_Name_Restriction.html">Spreadsheet Cell Notation</a> in the workbook, please see <a class="external text" href="../../QuickHelp/QuickHelp/Turn_off_spreadsheet_cell_notation.html"><b>FAQ-849</b></a> for more information.
</p></td></tr></table>
<h2><a name="Insert_or_Delete_Rows_in_Columns"></a><span class="mw-headline">Insert or Delete Rows in Columns</span></h2>
<p><span class="OIndex" style="display:none">Insert Worksheet Rows</span><span class="OIndex" style="display:none">Delete Worksheet Rows</span><span class="OIndex" style="display:none">Rows, Insert</span><span class="OIndex" style="display:none">Rows, Delete</span>
To delete or insert rows in worksheet columns, you can use the <a class="external text" href="../../LabTalk/LabTalk/Wks_(object).html#Methods">wks.deleteRows() or wks.insertRows() methods</a>.
</p><p>The syntax is as follows ...
</p><p>wks.deleteRows(<i>rowBegin</i>[,<i>numRows</i>, <i>colBegin</i>, <i>colEnd</i>])<br />
wks.insertRows(<i>rowBegin</i>[,<i>numRows</i>, <i>colBegin</i>, <i>colEnd</i>])
</p><p>... with arguments inside the square brackets being optional.
</p><p>Examples are given below:
</p>
<pre class="lt" style="font-family:monospace;">wks.<span style="color: #000080;">deleteRows</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Delete the third row in all columns</span>
wks.<span style="color: #000080;">deleteRows</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span>, <span style="color: #0000dd;">5</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Delete 5 rows beginning with the third row in all columns:</span>
wks.<span style="color: #000080;">deleteRows</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span>, <span style="color: #0000dd;">5</span>, <span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Delete 5 rows beginning with the third row in columns from the second to the end</span>
wks.<span style="color: #000080;">deleteRows</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span>, <span style="color: #0000dd;">5</span>, <span style="color: #0000dd;">2</span>, <span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Delete 5 rows beginning with the third row in columns 2 to 4</span>

wks.<span style="color: #000080;">insertRows</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Insert a row in front of the third row in all columns</span>
wks.<span style="color: #000080;">insertRows</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span>, <span style="color: #0000dd;">5</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Insert 5 rows in front of the third row in all columns</span>
wks.<span style="color: #000080;">insertRows</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span>, <span style="color: #0000dd;">5</span>, <span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Insert 5 rows in front of the third row in columns from the second to the end </span>
wks.<span style="color: #000080;">insertRows</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span>, <span style="color: #0000dd;">5</span>, <span style="color: #0000dd;">2</span>, <span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Insert 5 rows in front of the third row in columns 2 to 4</span></pre>
<p>Note that the <a class="external text" href="../../XFunction/X-Function/Wdelrows.html">wdelrows</a> X-Function can also be used to delete worksheet rows.
</p>
<h2><a name="Move_ColumnMove_Column"></a><span class="mw-headline">Move Column<span class="OIndex" style="display:none">Move Column</span></span></h2>
<p>The <a class="external text" href="../../XFunction/X-Function/Colmove.html">colmove</a> X-Function allows you to move column(s) of data within a worksheet.  It accepts an explicitly stated range (as opposed to a range variable), and the type of move operation as inputs. 
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Make the first column the last (left to right) in the worksheet:</span>
colmove rng<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span> operation<span style="color: #000000;">:</span><span style="color: #000080;">=</span>last; 

<span style="color: #008000;">// Move columns 2-4 to the leftmost position in the worksheet:</span>
colmove rng<span style="color: #000000;">:</span><span style="color: #000080;">=</span>Col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">:</span>Col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span> operation<span style="color: #000000;">:</span><span style="color: #000080;">=</span>first;</pre>
<h2><a name="Rename_and_Label_ColumnRename_ColumnColumn_Label"></a><span class="mw-headline">Rename and Label Column<span class="OIndex" style="display:none">Rename Column</span><span class="OIndex" style="display:none">Column Label</span></span></h2>
<p>To rename (short name) a column, Origin provides the <a href="../../LabTalk/LabTalk/Wks.Col_(object)&amp;action=edit&amp;redlink=1.html" class="new" title="LabTalk:Wks.Col (object) (page does not exist)">wks.col</a> object with the <i>name$</i> property. Also, the <a href="../../LabTalk/LabTalk/Column_Label_Row_Characters.html" title="LabTalk:Column Label Row Characters">Column Label Row Characters</a>, <i><b>G</b></i>, is able to rename column short name.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create a new workbook</span>
newbook;

<span style="color: #008000;">// Rename column 1 to DataX</span>
wks.<span style="color: #000080;">col1</span>.<span style="color: #000080;">name</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> DataX;
<span style="color: #008000;">// Rename column 2 to DataY by using range</span>
range rY <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;  <span style="color: #008000;">// range to column 2</span>
rY.<span style="color: #000080;">name</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> DataY;

<span style="color: #008000;">// Add a new column</span>
wks.<span style="color: #000080;">addCol</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// Turn off &quot;Spreadsheet Cell Notation&quot; (SCN) </span>
page.<span style="color: #000080;">xlcolname</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; 
<span style="color: #008000;">// Rename it with &quot;G&quot;</span>
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span>G<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Result&quot;</span>;</pre>
<p>The <a href="../../LabTalk/LabTalk/Column_Label_Row_Characters.html" title="LabTalk:Column Label Row Characters">Column Label Row Characters</a> are the convenient way to access the column labels, including Long Name, Units, Comments, Column Parameters, User-Defined Parameters, etc.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create a new workbook</span>
newbook result<span style="color: #000000;">:</span><span style="color: #000080;">=</span>BkName<span style="color: #000080;">$</span>;

<span style="color: #008000;">// Show the following label rows:</span>
<span style="color: #008000;">// Long Name, Units, Comments, 1st Column Parameter</span>
<span style="color: #008000;">// and 1st User-Defined Parameter</span>
wks.<span style="color: #000080;">labels</span><span style="color: #000000;">&#40;</span>LUCP1D1<span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Ranges to column 1 and 2</span>
range r1 <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span><span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>BkName<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #0000dd;">1</span>;
range r2 <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span><span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>BkName<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #0000dd;">2</span>;
<span style="color: #008000;">// Set Long Name by using col</span>
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span>L<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Time;
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span>L<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Voltage;
<span style="color: #008000;">// Set Units by using range</span>
r1<span style="color: #000000;">&#91;</span>U<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Sec;
r2<span style="color: #000000;">&#91;</span>U<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> V;
<span style="color: #008000;">// Set Comments by using range</span>
r1<span style="color: #000000;">&#91;</span>C<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Sample1;
r2<span style="color: #000000;">&#91;</span>C<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Sample1;
<span style="color: #008000;">// Set Column Parameters by using range</span>
r1<span style="color: #000000;">&#91;</span>P1<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Machine1&quot;</span>;
r2<span style="color: #000000;">&#91;</span>P1<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Machine1&quot;</span>;

<span style="color: #008000;">// Rename the 1st User-Defined Parameter</span>
wks.<span style="color: #000080;">UserParam1</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Current;

<span style="color: #008000;">// Set Current label row</span>
r1<span style="color: #000000;">&#91;</span>Current<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> 1mA;
r2<span style="color: #000000;">&#91;</span>Current<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> 1mA;</pre>
<h2><a name="Hide.2FUnhide_ColumnHide_Column"></a><span class="mw-headline">Hide/Unhide Column<span class="OIndex" style="display:none">Hide Column</span></span></h2>
<p>To hide/unhide column(s), you can use the <a class="external text" href="../../XFunction/X-Function/Colhide.html">colHide</a> X-Function.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create a new workbook</span>
newbook;

<span style="color: #008000;">// Set worksheet column number to 6</span>
wks.<span style="color: #000080;">nCols</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">6</span>;

<span style="color: #008000;">// Hide the second column</span>
colHide <span style="color: #0000dd;">2</span> hide;

<span style="color: #008000;">// Hide the 3rd and 5th columns</span>
colHide <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span>, <span style="color: #0000dd;">5</span><span style="color: #000000;">&#41;</span> hide;</pre>
<p>To show (unhide) column(s), it just changes the second argument from <i>hide</i> to <i>unhide</i>.
</p>
<h2><a name="Swap_Column"></a><span class="mw-headline"><span class="OIndex">Swap Column</span></span></h2>
<p>The <a class="external text" href="../../XFunction/X-Function/Colswap.html">colSwap</a> X-Function is used to swap two specified columns.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create a new workbook</span>
newbook;

<span style="color: #008000;">// Swap the position of the 1st and 2nd columns</span>
colSwap <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>;</pre>
<p>The specified two columns is not needed to be adjacent.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create a new workbook</span>
newbook;

<span style="color: #008000;">// Set number of columns to be 6</span>
wks.<span style="color: #000080;">ncols</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">6</span>;

<span style="color: #008000;">// Swap the 2nd and 4th columns</span>
colswap <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span>, <span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span>;</pre>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Basic_Worksheet_Column_Operation/Alert_icon.png?v=0" width="57"  border="0" /></td><td><p>To swap two columns, if <a class="external text" href="../../UserGuide/UserGuide/Column_Short_Name_Restriction.html">Spreadsheet Cell Notation</a> is enabled in the workbook, you might not able to see the exchange of the column short names as the short names are always assigned from A~Z successively and automatically; if you want to exchange the column short names, you might need disable the <b>Spreadsheet Cell Notation</b> before running the <b>colswap</b> command. See <a class="external text" href="../../QuickHelp/QuickHelp/Turn_off_spreadsheet_cell_notation.html"><b>FAQ-849</b></a> for more information.
</p>
	</td>
	</tr>
	</table>
<h2><a name="Modify_Column_Formats"></a><span class="mw-headline">Modify <span class="OIndex">Column Format</span>s</span></h2>
<h3><a name="Plot_Designation"></a><span class="mw-headline"><span class="OIndex">Plot Designation</span></span></h3>
<p>Plot designation for a column determines how the selected data will be handled by default for plotting and data analysis. Plot designation includes X, Y, Z, Z Error, Y Error, Label, etc. And you can change it by using <a href="../../LabTalk/LabTalk/Wks.Col_(object)&amp;action=edit&amp;redlink=1.html" class="new" title="LabTalk:Wks.Col (object) (page does not exist)">wks.col.type</a>.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Import data</span>
newbook;
string fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span>;
fname<span style="color: #000080;">$</span> <span style="color: #000080;">+</span><span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Samples\Matrix Conversion and Gridding\XYZ Random Gaussian.dat&quot;</span>;
impasc;

<span style="color: #008000;">// Set column designation (column type)</span>
wks.<span style="color: #000080;">col</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;  <span style="color: #008000;">// Set column 3 to be current column</span>
wks.<span style="color: #000080;">col</span>.<span style="color: #000080;">type</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">6</span>;  <span style="color: #008000;">// Z</span>

<span style="color: #008000;">// Select the 3rd column (Z column)</span>
worksheet <span style="color: #000080;">-</span>s <span style="color: #0000dd;">3</span> <span style="color: #0000dd;">1</span> <span style="color: #0000dd;">3</span> <span style="color: #000080;">-</span><span style="color: #0000dd;">1</span>;
<span style="color: #008000;">// Make a color map surface with the template based on OpenGL</span>
worksheet <span style="color: #000080;">-</span>p <span style="color: #0000dd;">103</span> glcmap;</pre>
<h3><a name="Column_Width"></a><span class="mw-headline"><span class="OIndex">Column Width</span></span></h3>
<p>To set column width, the <a class="external text" href="../../XFunction/X-Function/Wcolwidth.html">wcolwidth</a> X-Function is available, or use <a href="../../LabTalk/LabTalk/Wks.Col_(object)&amp;action=edit&amp;redlink=1.html" class="new" title="LabTalk:Wks.Col (object) (page does not exist)">wks.col.width</a>.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Open a workbook</span>
string strPath<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span>;
strPath<span style="color: #000080;">$</span> <span style="color: #000080;">+</span><span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Samples\Graphing\Automobile Data.ogw&quot;</span>;
doc <span style="color: #000080;">-</span>o <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>strPath<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// To make column 2 show all the numbers but not ###</span>
<span style="color: #008000;">// Set width of column 2 to 6 characters</span>
wcolwidth irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> width<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">6</span>;</pre>
<h3><a name="Data_Format_and_Display"></a><span class="mw-headline"><span class="OIndex">Data Format</span> and Display</span></h3>
<p>Setting a correct data format for a column helps to display the data in the column correctly, also helps to perform operations, such plotting, data analysis, etc. properly. There are many data format available for a column, such as Numeric, Text, Date, Time, Month, Day of Week, etc. To set format, please use <a href="../../LabTalk/LabTalk/Wks.Col_(object)&amp;action=edit&amp;redlink=1.html" class="new" title="LabTalk:Wks.Col (object) (page does not exist)">wks.col</a> object's <i>format</i> property.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Import data</span>
newbook;
string fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span>;
fname<span style="color: #000080;">$</span> <span style="color: #000080;">+</span><span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Samples\Signal Processing\Average Sunspot.dat&quot;</span>;
impasc;

<span style="color: #008000;">// Set column 2 to Numeric (current is Text &amp; Numeric)</span>
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">format</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;  <span style="color: #008000;">// Numeric = 1</span>

<span style="color: #008000;">// Enable digit mode to be &quot;Set Decimal Places&quot;</span>
<span style="color: #008000;">// and set number of decimal places to 2</span>
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">digitMode</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;  <span style="color: #008000;">// Set Decimal Places</span>
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">digits</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;  <span style="color: #008000;">// Two decimal places</span></pre>
<p>The following examples are showing the corresponding settings for different format.
</p>
<ol>
<li>Numeric</li>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Import data</span>
newbook;
string fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span>;
fname<span style="color: #000080;">$</span> <span style="color: #000080;">+</span><span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Samples\Curve Fitting\Enzyme.dat&quot;</span>;
impasc;

<span style="color: #008000;">// Set column 2 to Numeric (current is Text &amp; Numeric)</span>
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">format</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;  <span style="color: #008000;">// Numeric = 1</span>
<span style="color: #008000;">// Set display format with comma</span>
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">subformat</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">4</span>;  <span style="color: #008000;">// Display as Decimal: 1,000</span>
<span style="color: #008000;">// Data type to be short int</span>
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">numerictype</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;


<span style="color: #008000;">// Do the same for column 3</span>
wks.<span style="color: #000080;">col3</span>.<span style="color: #000080;">format</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;  <span style="color: #008000;">// Numeric = 1</span>
<span style="color: #008000;">// Set display format with comma</span>
wks.<span style="color: #000080;">col3</span>.<span style="color: #000080;">subformat</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">4</span>;  <span style="color: #008000;">// Display as Decimal: 1,000</span>
<span style="color: #008000;">// Data type to be short int</span>
wks.<span style="color: #000080;">col3</span>.<span style="color: #000080;">numerictype</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;</pre>
<li>Date</li>
<p>For Date and Time format, if the data stored in a column is not Julian day numbers (looks like Date and Time format, actually is text), we cannot set the format as Date or Time directly, or the look-like-Date-and-Time-format text will become missing value or something incorrect. To avoid this issue, Origin provides the <b><a href="../../LabTalk/LabTalk/Wks.Col_(object)&amp;action=edit&amp;redlink=1.html" class="new" title="LabTalk:Wks.Col (object) (page does not exist)">wks.col.setformat()</a></b> method.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Import data</span>
newbook;
string fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span>;
fname<span style="color: #000080;">$</span> <span style="color: #000080;">+</span><span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Samples\Import and Export\Custom Date and Time.dat&quot;</span>;
impasc;

<span style="color: #008000;">// Set format of column 1 to be Date</span>
<span style="color: #008000;">// with a custom display format, which is like</span>
<span style="color: #008000;">// the current text display in the column</span>
wks.<span style="color: #000080;">col1</span>.<span style="color: #000080;">setformat</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">4</span>, <span style="color: #0000dd;">22</span>, dd<span style="color: #ff00ff;">'.'</span>MM<span style="color: #ff00ff;">'.'</span>yyyy HH<span style="color: #ff00ff;">':'</span>mm<span style="color: #ff00ff;">':'</span>ss<span style="color: #ff00ff;">'.'</span>##<span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// Set a familiar display format yyyy/MM/dd HH:mm:ss</span>
wks.<span style="color: #000080;">col1</span>.<span style="color: #000080;">subformat</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">11</span>;</pre>
<li>Time</li>
<p>Please refer to the description about Date above.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Import data</span>
newbook;
string fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span>;
fname<span style="color: #000080;">$</span> <span style="color: #000080;">+</span><span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Samples\Import and Export\IRIG Time.dat&quot;</span>;
impasc;

<span style="color: #008000;">// Set format of column 1 to be Time</span>
wks.<span style="color: #000080;">col1</span>.<span style="color: #000080;">format</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;  <span style="color: #008000;">// Time = 3</span>
<span style="color: #008000;">// Display IRIG Time format DDD:HH:mm:ss.##</span>
wks.<span style="color: #000080;">col1</span>.<span style="color: #000080;">subformat</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">16</span>;</pre>
<li>Month</li>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Set column 1 format as Month</span>
<span style="color: #008000;">// And show the whole name of month</span>
wks.<span style="color: #000080;">col1</span>.<span style="color: #000080;">format</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">5</span>;  <span style="color: #008000;">// Month = 5</span>
wks.<span style="color: #000080;">col1</span>.<span style="color: #000080;">subformat</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;  <span style="color: #008000;">// Show the whole month's name</span></pre>
<li>Day of Week</li>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Set column 1 format as Day of Week</span>
<span style="color: #008000;">// And show only the first letter of each day of week</span>
wks.<span style="color: #000080;">col1</span>.<span style="color: #000080;">format</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">6</span>;  <span style="color: #008000;">// Day of Week = 6</span>
wks.<span style="color: #000080;">col1</span>.<span style="color: #000080;">subformat</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;  <span style="color: #008000;">// Show the first letter of each day of week</span></pre>
</ol>
<h2><a name="Add_Sparkline_to_Column"></a><span class="mw-headline">Add <span class="OIndex">Sparkline</span> to Column</span></h2>
<p>The <a class="external text" href="../../XFunction/X-Function/Sparklines.html">sparklines</a> X-Function is used to add sparklines to the specified columns in the worksheet.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Open a workbook</span>
string strPath<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span>;
strPath<span style="color: #000080;">$</span> <span style="color: #000080;">+</span><span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Samples\Graphing\Automobile Data.ogw&quot;</span>;
doc <span style="color: #000080;">-</span>o <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>strPath<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Turn on sparklines for all columns except the ones with &quot;Year&quot; Long Name</span>
for<span style="color: #000000;">&#40;</span>ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>; ii <span style="color: #000080;">&lt;=</span> wks.<span style="color: #000080;">nCols</span>; ii<span style="color: #000080;">+</span><span style="color: #000080;">=</span><span style="color: #0000dd;">5</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	sparklines sel<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> c1<span style="color: #000000;">:</span><span style="color: #000080;">=</span>ii c2<span style="color: #000000;">:</span><span style="color: #000080;">=</span>ii<span style="color: #000080;">+</span><span style="color: #0000dd;">3</span>;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Delete_Column"></a><span class="mw-headline"><span class="OIndex">Delete Column</span></span></h2>
<p>The <a href="../../LabTalk/LabTalk/Delete_(command).html" title="LabTalk:Delete (command)">delete</a> command is capable of removing a column from worksheet.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create a workbook</span>
newbook;

<span style="color: #008000;">// Delete column B</span>
delete col<span style="color: #000000;">&#40;</span>B<span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Add a new worksheet with 4 columns</span>
newsheet cols<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span>;

<span style="color: #008000;">// Delete column 3 by using range</span>
range r1 <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;  <span style="color: #008000;">// column 3 in the newly added worksheet</span>
delete r1;

<span style="color: #008000;">// Delete multiple columns by using range</span>
newsheet cols<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">6</span>;
range r2 <span style="color: #000080;">=</span> <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">3</span>,<span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// assign multiple columns to the range</span>
delete r2;</pre>
<p>If the column(s) you want to delete is (are) at the end of the worksheet, you can just set the number of worksheet columns to delete it (them), by using <a href="../../LabTalk/LabTalk/Wks_(object).html#Properties" title="LabTalk:Wks (object)">wks.nCols</a>.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Open a workbook</span>
string strPath<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span>;
strPath<span style="color: #000080;">$</span> <span style="color: #000080;">+</span><span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Samples\Graphing\Automobile Data.ogw&quot;</span>;
doc <span style="color: #000080;">-</span>o <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>strPath<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Delete last 20 columns from the opened worksheet</span>
wks.<span style="color: #000080;">nCols</span> <span style="color: #000080;">=</span> wks.<span style="color: #000080;">nCols</span><span style="color: #000080;">-</span><span style="color: #0000dd;">20</span>;</pre>


