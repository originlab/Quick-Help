<h1 class="firstHeading">2.9.1 Creating Graphs</h1><p class='urlname' style='display: none'>Creating-Graphs</p>
<p><span class="OIndex" style="display:none">Plot Graph</span><span class="OIndex" style="display:none">Create Graph</span>
Creating <span class="OIndex">graph</span>s is probably the most commonly performed operation in Origin. Origin provides a collection of X-Function and LabTalk functions for this purpose. You can find all X-Functions used for plotting under the <a class="external text" href="../../XFunction/Category/Plotting.html"><b>Plotting</b> category</a> and can list them by typing the following command:
</p>
<pre class="lt" style="font-family:monospace;">lx cat<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;plotting&quot;</span>;</pre>
<p>Some X-Functions are general tools to plot graph from a specific kinds of data, for example <b>plotxy</b> to plot graphs from XY range data, and <b>plotm</b> to plot graph from matrix data. Some are used to plot a special plot type, for example <b>plotgboxraw</b> to plot a grouped box plot from raw data, and <b>plotpiper</b> to create a piper plot. Please refer to <a class="external text" href="../../XFunction/Category/Plotting.html">plotting category</a> for details of each X-Function.
</p><p>The following sections give examples of two X-Functions that allow you to create graphs directly from LabTalk scripts: <b>plotxy</b> and <b>plotgroup</b>. Once a <span class="OIndex">plot</span> is created, you can use object properties, like <a href="../../LabTalk/LabTalk/Page_(object).html" title="LabTalk:Page (object)">page</a>, <a href="../../LabTalk/LabTalk/Layer_(object).html" title="LabTalk:Layer (object)">layer</a>, <a href="../../LabTalk/LabTalk/Layer.Axis_(object).html" title="LabTalk:Layer.Axis (object)">axis</a> objects, and <a href="../../LabTalk/Category/Set_(command).html" title="Category:Set (command)">set command</a> to <a href="../../LabTalk/Script/Formatting_Graphs.html" title="Script:Formatting Graphs">format the graph</a>.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Creating_a_Graph_with_the_PLOTXY_X-Function"><span class="tocnumber">1</span> <span class="toctext">Creating a Graph with the PLOTXY X-Function</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Plotting_X_Y_data"><span class="tocnumber">1.1</span> <span class="toctext">Plotting X Y data</span></a>
<ul>
<li class="toclevel-3 tocsection-3"><a href="#Input_XYRange_referencing_the_X_and_Y"><span class="tocnumber">1.1.1</span> <span class="toctext">Input XYRange referencing the X and Y</span></a></li>
<li class="toclevel-3 tocsection-4"><a href="#Input_XYRange_referencing_just_the_Y"><span class="tocnumber">1.1.2</span> <span class="toctext">Input XYRange referencing just the Y</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-5"><a href="#Plotting_X_YY_data"><span class="tocnumber">1.2</span> <span class="toctext">Plotting X YY data</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Plotting_XY_XY_data"><span class="tocnumber">1.3</span> <span class="toctext">Plotting XY XY data</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Plotting_using_worksheet_column_designations"><span class="tocnumber">1.4</span> <span class="toctext">Plotting using worksheet column designations</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Plotting_a_subset_of_a_column"><span class="tocnumber">1.5</span> <span class="toctext">Plotting a subset of a column</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Plotting_into_a_graph_template"><span class="tocnumber">1.6</span> <span class="toctext">Plotting into a graph template</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Plotting_into_an_existing_graph_layer"><span class="tocnumber">1.7</span> <span class="toctext">Plotting into an existing graph layer</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Creating_a_new_graph_layerCreate_LayerGraph_Layer"><span class="tocnumber">1.8</span> <span class="toctext">Creating a new graph layer<span class="OIndex" style="display:none">Create Layer</span><span class="OIndex" style="display:none">Graph Layer</span></span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Creating_a_Double-Y_GraphDouble-Y_Graph"><span class="tocnumber">1.9</span> <span class="toctext">Creating a Double-Y Graph<span class="OIndex" style="display:none">Double-Y Graph</span></span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-13"><a href="#Create_Graph_Groups_with_the_PLOTGROUP_X-FunctionGraph_Groups"><span class="tocnumber">2</span> <span class="toctext">Create Graph Groups with the PLOTGROUP X-Function<span class="OIndex" style="display:none">Graph Groups</span></span></a></li>
<li class="toclevel-1 tocsection-14"><a href="#Create_3D_Graphs_with_Worksheet_-p_CommandGraph.2C_3D"><span class="tocnumber">3</span> <span class="toctext">Create 3D Graphs with Worksheet -p Command<span class="OIndex" style="display:none">Graph, 3D</span></span></a></li>
<li class="toclevel-1 tocsection-15"><a href="#Create_3D_Graph_and_Contour_Graphs_from_Virtual_MatrixVirtual_Matrix"><span class="tocnumber">4</span> <span class="toctext">Create 3D Graph and Contour Graphs from Virtual Matrix<span class="OIndex" style="display:none">Virtual Matrix</span></span></a></li>
<li class="toclevel-1 tocsection-16"><a href="#Create_Circular_Dendrogram"><span class="tocnumber">5</span> <span class="toctext">Create Circular Dendrogram</span></a></li>
<li class="toclevel-1 tocsection-17"><a href="#Installing_and_Uninstalling_a_Graph_Template_Via_LabTalkInstalling_Graph_Template"><span class="tocnumber">6</span> <span class="toctext">Installing and Uninstalling a Graph Template Via LabTalk<span class="OIndex" style="display:none">Installing Graph Template</span></span></a></li>
</ul>
</div>

<h2><a name="Creating_a_Graph_with_the_PLOTXY_X-Function"></a><span class="mw-headline">Creating a Graph with the PLOTXY X-Function</span></h2>
<p><a class="external text" href="../../XFunction/X-Function/Plotxy.html"><b>plotxy</b></a> is an X-Function used for general purpose plotting.  It is used to create a new <span class="OIndex">graph window</span>, plot into a <span class="OIndex">graph template</span>, or plot into a new <span class="OIndex">graph layer</span>.  It has a syntax common to all X-Functions:
</p><p><b>plotxy</b> option1:=<i>optionValue</i> option2:=<i>optionValue</i> ... option<i>N</i>:=<i>optionValue</i>
</p><p>All possible options and values are summarized in the <a class="external text" href="../../XFunction/X-Function/Plotxy.html">X-Function help for <b>plotxy</b></a>.  Since it is somewhat non-intuitive, the <b>plot</b> option and its most common values are summarized here:
</p>
<table class="simple">
<tr>
<th> plot:=
</th>
<th> Plot Type
</th></tr>
<tr>
<td> 200
</td>
<td> Line
</td></tr>
<tr>
<td> 201
</td>
<td> Scatter
</td></tr>
<tr>
<td> 202
</td>
<td> Line+symbol
</td></tr>
<tr>
<td> 203
</td>
<td> column
</td></tr></table>
<p>All of the possible values for the <b>plot</b> option can be found in the <a href="../../LabTalk/LabTalk/Plot_Type_IDs.html" title="LabTalk:Plot Type IDs">Plot Type IDs</a>.
</p>
<h3><a name="Plotting_X_Y_data"></a><span class="mw-headline">Plotting X Y data</span></h3>
<h4><a name="Input_XYRange_referencing_the_X_and_Y"></a><span class="mw-headline">Input XYRange referencing the X and Y</span></h4>
<p>The following example plots the first two columns of data in the active worksheet, where the first column will be plotted as X and the second column as Y, as a line plot. 
</p>
<pre class="lt" style="font-family:monospace;">plotxy iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">200</span>;</pre>
<h4><a name="Input_XYRange_referencing_just_the_Y"></a><span class="mw-headline">Input XYRange referencing just the Y</span></h4>
<p>The following example plots the second column of data in the active worksheet, as Y against its associated X, as a line plot. When you do not explicitly specify the X, Origin will use the the X-column that is associated with that Y-column in the worksheet, or if there is no associated X-column, then an &lt;auto&gt; X will be used.  By default, &lt;auto&gt; X is row number.
</p>
<pre class="lt" style="font-family:monospace;">plotxy iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">200</span>;</pre>
<h3><a name="Plotting_X_YY_data"></a><span class="mw-headline">Plotting X YY data</span></h3>
<p>The following example plots the first three columns of data from Book1, Sheet1, where the first column will be plotted as X and the second and third columns as Y, as a grouped scatter plot.
</p>
<pre class="lt" style="font-family:monospace;">plotxy iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>Book1<span style="color: #000000;">&#93;</span>Sheet1<span style="color: #000080;">!</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">:</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">201</span>;</pre>
<h3><a name="Plotting_XY_XY_data"></a><span class="mw-headline">Plotting XY XY data</span></h3>
<p>The following example plots the first four columns of data in the active worksheet, where the first column will be plotted as X against the second column as Y and the third column as X against the fourth column as Y, as a grouped line+symbol plot.
</p>
<pre class="lt" style="font-family:monospace;">plotxy iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>,<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span>,<span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">202</span>;</pre>
<h3><a name="Plotting_using_worksheet_column_designations"></a><span class="mw-headline">Plotting using worksheet column designations</span></h3>
<p>The following example plots all columns in the active worksheet, using the worksheet column plotting designations, as a column plot.  '?' indicates to use the worksheet designations; '1:end' indicates to plot all the columns. 
</p>
<pre class="lt" style="font-family:monospace;">plotxy iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#40;</span>?,<span style="color: #0000dd;">1</span><span style="color: #000000;">:</span>end<span style="color: #000000;">&#41;</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">203</span>;</pre>
<h3><a name="Plotting_a_subset_of_a_column"></a><span class="mw-headline">Plotting a subset of a column</span></h3>
<p>The following example plots rows 1-12 of all columns in the active worksheet, as a grouped line plot.
</p>
<pre class="lt" style="font-family:monospace;">plotxy iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">:</span>end<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">12</span><span style="color: #000000;">&#93;</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">200</span>;</pre>
<p>Note: Please refer to <a href="../../LabTalk/LabTalk/Range_Notation.html#Specifying_Subrange_Using_X_Values" title="LabTalk:Range Notation">Specifying Subrange Using X Values</a> for more details on subset.
</p>
<h3><a name="Plotting_into_a_graph_template"></a><span class="mw-headline">Plotting into a graph template</span></h3>
<p>The following example plots the first column as theta(X) and the second column as r(Y) in the active worksheet, into the <i>polar</i> plot graph template, and the graph window is named <i>MyPolarGraph</i>.  
</p>
<pre class="lt" style="font-family:monospace;">plotxy <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">192</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span><span style="color: #000080;">&lt;</span>new template<span style="color: #000000;">:</span><span style="color: #000080;">=</span>polar name<span style="color: #000000;">:</span><span style="color: #000080;">=</span>MyPolarGraph<span style="color: #000080;">&gt;</span><span style="color: #000000;">&#93;</span>;</pre>
<h3><a name="Plotting_into_an_existing_graph_layer"></a><span class="mw-headline">Plotting into an existing graph layer</span></h3>
<p>The following example plots columns 10-20 in the active worksheet, using column plotting designations, into the second layer of Graph1.  These columns can all be Y columns and they will still plot against the associated X column in the worksheet.
</p>
<pre class="lt" style="font-family:monospace;">plotxy iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#40;</span>?,<span style="color: #0000dd;">10</span><span style="color: #000000;">:</span><span style="color: #0000dd;">20</span><span style="color: #000000;">&#41;</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>Graph1<span style="color: #000000;">&#93;</span><span style="color: #0000dd;">2</span><span style="color: #000080;">!</span>;</pre>
<h3><a name="Creating_a_new_graph_layerCreate_LayerGraph_Layer"></a><span class="mw-headline">Creating a new graph layer<span class="OIndex" style="display:none">Create Layer</span><span class="OIndex" style="display:none">Graph Layer</span></span></h3>
<p>The following example adds a new Bottom-X Left-Y layer to the active graph window, plotting the first column as X and the third column as Y from Book1, Sheet2, as a line plot.  When a graph window is active and the output graph layer is not specified, a new layer is created.
</p>
<pre class="lt" style="font-family:monospace;">plotxy iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>Book1<span style="color: #000000;">&#93;</span>Sheet2<span style="color: #000080;">!</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">200</span>;</pre>
<h3><a name="Creating_a_Double-Y_GraphDouble-Y_Graph"></a><span class="mw-headline">Creating a Double-Y Graph<span class="OIndex" style="display:none">Double-Y Graph</span></span></h3>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Import data file</span>
string fpath<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Samples\Import and Export\S15-125-03.dat&quot;</span>;
string fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> fpath<span style="color: #000080;">$</span>;
impASC;

<span style="color: #008000;">// Remember Book and Sheet names</span>
string bkname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> page.<span style="color: #000080;">name</span><span style="color: #000080;">$</span>;
string shname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> layer.<span style="color: #000080;">name</span><span style="color: #000080;">$</span>;

<span style="color: #008000;">// Plot the first and second columns as X and Y </span>
<span style="color: #008000;">// The worksheet is active, so can just specify column range</span>
plotxy iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">202</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span><span style="color: #000080;">&lt;</span>new template<span style="color: #000000;">:</span><span style="color: #000080;">=</span>doubleY<span style="color: #000080;">&gt;</span><span style="color: #000000;">&#93;</span>;

<span style="color: #008000;">// Plot the first and third columns as X and Y into the second layer</span>
<span style="color: #008000;">// Now that the graph window is the active window, need to specify Book </span>
<span style="color: #008000;">//and Sheet</span>
plotxy iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>bkname<span style="color: #000080;">$</span><span style="color: #000000;">&#93;</span>shname<span style="color: #000080;">$!</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">202</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>;</pre>
<h2><a name="Create_Graph_Groups_with_the_PLOTGROUP_X-FunctionGraph_Groups"></a><span class="mw-headline">Create Graph Groups with the PLOTGROUP X-Function<span class="OIndex" style="display:none">Graph Groups</span></span></h2>
<p>According to the grouping variables (datasets), <a class="external text" href="../../XFunction/X-Function/Plotgroup.html"><b>plotgroup</b></a> X-Function  creates grouped plots for page, layer or dataplot. To work properly, the worksheet should be sorted by the graph group data first, then the layer group data and finally the dataplot group data. 
</p><p>This example shows how to plot by group.  
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Establish a path to the sample data</span>
fn<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Statistics\body.dat&quot;</span>;
newbook;
impASC fn<span style="color: #000080;">$</span>;      <span style="color: #008000;">// Import into new workbook</span>

<span style="color: #008000;">// Sort worksheet--Sorting is very important!</span>
wsort bycol<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span>;

<span style="color: #008000;">// Plot by group</span>
plotgroup iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">4</span>,<span style="color: #0000dd;">5</span><span style="color: #000000;">&#41;</span> pgrp<span style="color: #000000;">:</span><span style="color: #000080;">=</span>Col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>;</pre>
<p>This next example creates graph windows based on one group
and graph layers based on a second group:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Bring in Sample data</span>
fn<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Graphing\Categorical Data.dat&quot;</span>;
newbook;
impASC fn<span style="color: #000080;">$</span>;
<span style="color: #008000;">// Sort</span>
dataset sortcol <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">4</span>,<span style="color: #0000dd;">3</span><span style="color: #000000;">&#125;</span>; <span style="color: #008000;">// sort by drug, then gender</span>
dataset sortord <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">1</span><span style="color: #000000;">&#125;</span>; <span style="color: #008000;">// both ascending sort</span>
wsort nest<span style="color: #000000;">:</span><span style="color: #000080;">=</span>sortcol ord<span style="color: #000000;">:</span><span style="color: #000080;">=</span>sortord;
<span style="color: #008000;">// Plot each drug in a separate graph with gender separated by layer</span>
plotgroup iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span> pgrp<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span>drug<span style="color: #000000;">&#41;</span> lgrp<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span>gender<span style="color: #000000;">&#41;</span>;</pre>
<p>Note&#160;: Each group variable is optional. For example, you could use one group variable to organize data into layers by omitting Page Group and Data Group. The same sort order is important for whichever options you do use.
</p>
<h2><a name="Create_3D_Graphs_with_Worksheet_-p_CommandGraph.2C_3D"></a><span class="mw-headline">Create 3D Graphs with Worksheet -p Command<span class="OIndex" style="display:none">Graph, 3D</span></span></h2>
<p>To create 3D Graphs, use the  <a class="external text" href="../../LabTalk/LabTalk/Worksheet_(command).html#-p.3B_Plot_the_current_worksheet_selection_in_the_nth_graph_type_into_the_template">Worksheet (command) (-p switch)</a>. 
</p><p>First, create a simple 3D scatter plot:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create a new book</span>
newbook r<span style="color: #000000;">:</span><span style="color: #000080;">=</span>bkn<span style="color: #000080;">$</span>;
<span style="color: #008000;">// Run script on bkn$</span>
win <span style="color: #000080;">-</span>o bkn<span style="color: #000080;">$</span> <span style="color: #000000;">&#123;</span>
	<span style="color: #008000;">// Import sample data</span>
	string fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span>
		<span style="color: #ff00ff;">&quot;\samples\Matrix Conversion and Gridding&quot;</span> <span style="color: #000080;">+</span>
		<span style="color: #ff00ff;">&quot;\XYZ Random Gaussian.dat&quot;</span>;
	impasc;
	<span style="color: #008000;">// Save new book name</span>
	bkn<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">%</span>H;
	<span style="color: #008000;">// Change column type to Z</span>
	wks.<span style="color: #000080;">col3</span>.<span style="color: #000080;">type</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">6</span>;
	<span style="color: #008000;">// Select column 3</span>
	worksheet <span style="color: #000080;">-</span>s <span style="color: #0000dd;">3</span>;
	<span style="color: #008000;">// Plot a 3D scatter graph by template named &quot;3d&quot;</span>
	worksheet <span style="color: #000080;">-</span>p <span style="color: #0000dd;">240</span> 3d;
<span style="color: #000000;">&#125;</span>;</pre>
<p>You can also create 3D color map or 3D mesh graph. 3D graphs can be plotted either <a href="#Create_3D_Graph_and_Contour_Graphs_from_Virtual_MatrixVirtual_Matrix">from worksheet</a> or matrix. And you may need to do <a class="external text" href="../../LabTalk/Script/LabTalk-Supported_X-Functions.html#Gridding"><b><span class="OIndex">gridding</span></b></a> before plotting.
</p><p>We can run the following script after above example and create a 3D wire frame plot from matrix:
</p>
<pre class="lt" style="font-family:monospace;">win <span style="color: #000080;">-</span>o bkn<span style="color: #000080;">$</span> <span style="color: #000000;">&#123;</span>
	<span style="color: #008000;">// Gridding by Shepard method</span>
	xyz_shep <span style="color: #0000dd;">3</span>;
	<span style="color: #008000;">// Plot 3D wire frame graph;</span>
	worksheet <span style="color: #000080;">-</span>p <span style="color: #0000dd;">242</span> wirefrm;
<span style="color: #000000;">&#125;</span>;</pre>
<h2><a name="Create_3D_Graph_and_Contour_Graphs_from_Virtual_MatrixVirtual_Matrix"></a><span class="mw-headline">Create 3D Graph and Contour Graphs from Virtual Matrix<span class="OIndex" style="display:none">Virtual Matrix</span></span></h2>
<p>Origin can also create 3D graphs, such as 3D color map, contour, or 3D mesh, etc., from worksheet by the <a class="external text" href="../../XFunction/X-Function/Plotvm.html">plotvm</a> X-Function. This function creates a <a href="../../LabTalk/Script/Virtual_Matrix.html" title="Script:Virtual Matrix">virtual matrix</a>, and then plot from such matrix. For example:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create a new workbook and import sample data</span>
newbook;
string fname<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Graphing\VSurface 1.dat&quot;</span>;
impasc;
<span style="color: #008000;">// Treat entire sheet as a Virtual Matrix and create a colormap surface plot</span>
plotvm irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span> format<span style="color: #000000;">:</span><span style="color: #000080;">=</span>xacross rowpos<span style="color: #000000;">:</span><span style="color: #000080;">=</span>selrow1 colpos<span style="color: #000000;">:</span><span style="color: #000080;">=</span>selcol1
 ztitle<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;VSurface 1&quot;</span> type<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">242</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>new template<span style="color: #000000;">:</span><span style="color: #000080;">=</span>cmap<span style="color: #000080;">&gt;</span>;
<span style="color: #008000;">// Change X axis scale to log</span>
<span style="color: #008000;">// Nonlinear axis type supported for 3D graphs created from virtual matrix</span>
LAYER.<span style="color: #000080;">X</span>.<span style="color: #000080;">type</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>;</pre>
<p><br />
</p>
<h2><a name="Create_Circular_Dendrogram"></a><span class="mw-headline">Create Circular Dendrogram</span></h2>
<p>Creating Circular Dendrogram menu is not support the Origin GUI. If you want to plot this graph type,  you can do <b>Hierarchical Cluster Analysis</b> to create the graph, or use the following script:
</p>
<pre class="lt" style="font-family:monospace;">run.<span style="color: #000080;">section</span><span style="color: #000000;">&#40;</span>plot, CircularPhyTree<span style="color: #000000;">&#41;</span>; 

run.<span style="color: #000080;">section</span><span style="color: #000000;">&#40;</span>plot, CircularBinPhyTree<span style="color: #000000;">&#41;</span>;</pre>
<p>This sample shows how to plot this kind of graph:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Import data file</span>
newbook;
string fpath<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Samples\Graphing\US Mean Temperature.dat&quot;</span>;
string fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> fpath<span style="color: #000080;">$</span>;
impASC;
<span style="color: #008000;">// Hierarchical Cluster Analysis</span>
hcluster <span style="color: #000080;">-</span>r <span style="color: #0000dd;">2</span> irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>USMeanTempera<span style="color: #000000;">&#93;</span><span style="color: #ff00ff;">&quot;US Mean Temperature&quot;</span><span style="color: #000080;">!</span>D<span style="color: #ff00ff;">&quot;January&quot;</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">:</span>O<span style="color: #ff00ff;">&quot;December&quot;</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">100</span><span style="color: #000000;">&#93;</span> link<span style="color: #000000;">:</span><span style="color: #000080;">=</span>ward number<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span> center<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
<span style="color: #008000;">// Highlight datasets</span>
page.<span style="color: #000080;">active</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Cluster Plot Data1&quot;</span>&#160;;
worksheet <span style="color: #000080;">-</span>s <span style="color: #0000dd;">1</span> <span style="color: #0000dd;">0</span> <span style="color: #0000dd;">3</span> <span style="color: #0000dd;">0</span>;
<span style="color: #008000;">// Create graph</span>
run.<span style="color: #000080;">section</span><span style="color: #000000;">&#40;</span>plot, CircularPhyTree<span style="color: #000000;">&#41;</span>;</pre>
<p><br />
</p>
<h2><a name="Installing_and_Uninstalling_a_Graph_Template_Via_LabTalkInstalling_Graph_Template"></a><span class="mw-headline">Installing and Uninstalling a Graph Template Via LabTalk<span class="OIndex" style="display:none">Installing Graph Template</span></span></h2>
<p>You can use LabTalk to install or uninstall a graph template using the following commands ( the graph template file must exist in your User Files Folder). When uninstalling, the file is not moved from your User Files Folder.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// To install</span>
run.<span style="color: #000080;">section</span><span style="color: #000000;">&#40;</span>dofile.<span style="color: #000080;">ogs</span>, OnInstallTemplate, <span style="color: #ff00ff;">&quot;%YMyTemplate.otpu&quot;</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// To uninstall</span>
run.<span style="color: #000080;">section</span><span style="color: #000000;">&#40;</span>dofile.<span style="color: #000080;">ogs</span>, OnUnInstallTemplate, <span style="color: #ff00ff;">&quot;%YMyTemplate.otpu&quot;</span><span style="color: #000000;">&#41;</span>;</pre>






