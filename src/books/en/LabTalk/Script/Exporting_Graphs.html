<h1 class="firstHeading">2.11.2 Exporting Graphs</h1><p class='urlname' style='display: none'>Exporting-Graphs</p>
<p><span class="OIndex" style="display:none">Export Graph</span><span class="OIndex" style="display:none">Graph Export</span>Here are three examples of exporting graphs using the X-Function <a class="external text" href="../../XFunction/X-Function/ExpGraph.html"><b>expGraph</b></a> called from LabTalk:
</p>
<h2><a name="Export_a_Graph_with_Specific_Width_and_Resolution_.28DPI.29"></a><span class="mw-headline">Export a Graph with Specific Width and Resolution (DPI)</span></h2>
<p>Export a graph as an <span class="OIndex">image</span> using the <b>expGraph</b> X-Function.  The image size options are stored in the nodes of tree variable named <b>tr1</b>, while resolution options (for all raster type images) are stored in a tree named <b>tr2</b>.
</p><p>One common application is to export a graph to a desired image format specifying <i>both</i> the width of the image and the <span class="OIndex">resolution</span>.  For example, consider a journal that requires, for a two-column article, that graphs be sent as high-resolution (1200 <span class="OIndex">DPI</span>), *.tif files that are 3.2 inches wide: 
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Export the active graph window to D:\TestImages\TEST.TIF.</span>
<span style="color: #008000;">// Width = 3.2 in, Resolution = 1200 DPI</span>

expGraph type<span style="color: #000000;">:</span><span style="color: #000080;">=</span>tif path<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;D:\TestImages&quot;</span> filename<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;TEST&quot;</span> 
	 tr1.<span style="color: #000080;">unit</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>
	 tr1.<span style="color: #000080;">width</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3.2</span>
	 tr2.<span style="color: #000080;">tif</span>.<span style="color: #000080;">dotsperinch</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1200</span>;</pre>
<p>Possible values for tr1.unit are:
</p>
<ul><li> 0 = inch </li>
<li> 1 = cm </li>
<li> 2 = pixel </li>
<li> 3 = page ratio</li></ul>
<p><b>Note</b>: this is a good example of accessing data stored in a tree structure to specify a particular type of output.  <a class="external text" href="../../UserGuide/UserGuide/The_Export_Graph_Dialog_Box.html#Image_Size">The full documentation for <b>tr1</b></a> can be found in the online and product (CHM) help. 
</p>
<h2><a name="Exporting_All_Graphs_in_the_Project"></a><span class="mw-headline">Exporting All Graphs in the Project</span></h2>
<p>Exporting all of the graphs from an Origin Project can be achieved by combining the <a href="../../LabTalk/LabTalk/Document_Options_Others.html#-e" title="LabTalk:Document Options Others"><b>doc -e</b> command</a>, which loops over all specified objects in a project with the <b>expGraph</b> X-Function.  
</p><p>For example, to export all graphs in the current project as a bitmap (BMP) image, as above:
</p>
<pre class="lt" style="font-family:monospace;">doc <span style="color: #000080;">-</span>e P
<span style="color: #000000;">&#123;</span>
  <span style="color: #008000;">//&#160;%H is a string register that holds the name of the active window.</span>
  expGraph type<span style="color: #000000;">:</span><span style="color: #000080;">=</span>bmp path<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;d:\TestImages&quot;</span> filename<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000080;">%</span>H 
           tr1.<span style="color: #000080;">unit</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>  
           tr1.<span style="color: #000080;">width</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">640</span>;
<span style="color: #000000;">&#125;</span></pre>  
<p>Several examples of <b>doc -e</b> can be found in <a href="../../LabTalk/Script/Looping_Over_Objects.html" title="Script:Looping Over Objects">Looping Over Objects</a>.
</p>
<h2><a name="Exporting_Graph_with_Path_and_File_Name"></a><span class="mw-headline">Exporting Graph with Path and File Name</span></h2>
<p>The <a href="../../LabTalk/LabTalk/String_registers.html" title="LabTalk:String registers">string registers</a>,&#160;%G and&#160;%X, hold the current project file name and path. Combine with the <a href="../../LabTalk/LabTalk/Label_(command).html" title="LabTalk:Label (command)">label command</a>, you can place these information on page while exporting a graph. For example:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Path of the project</span>
string proPath<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Graphing\Multi-Curve Graphs.opj&quot;</span>;
<span style="color: #008000;">// Open the project</span>
doc <span style="color: #000080;">-</span>o <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>proPath<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// Add file path and name to graph</span>
win <span style="color: #000080;">-</span>a Graph1;
label <span style="color: #000080;">-</span>s <span style="color: #000080;">-</span>px <span style="color: #0000dd;">0</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">-</span>n ForPrintOnly \v<span style="color: #000000;">&#40;</span><span style="color: #000080;">%</span>X<span style="color: #000080;">%</span>G.<span style="color: #000080;">opj</span><span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// Export graph to disk D</span>
expGraph type<span style="color: #000000;">:</span><span style="color: #000080;">=</span>png filename<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000080;">%</span>H path<span style="color: #000000;">:</span><span style="color: #000080;">=</span>D<span style="color: #000000;">:</span>\;
<span style="color: #008000;">// Delete the file path and name </span>
label <span style="color: #000080;">-</span>r ForPrintOnly;</pre>






