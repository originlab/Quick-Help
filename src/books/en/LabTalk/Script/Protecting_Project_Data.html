<h1 class="firstHeading">2.12.4 Protecting Project Data</h1><p class='urlname' style='display: none'>Protecting_Project_Data</p>
<p>LabTalk commands to enable various protections on worksheets and workbooks were introduced in Origin 9.1. This included a project-level <b>Admin</b> mode to control who could modify object-level protections. You can control protection attributes of Origin objects (e.g. a workbook) without involving Admin mode, but any such protections are not secured. Anyone can run LabTalk commands to remove these protections. 
</p><p>To secure protection, you must setup an <b>Admin</b> password for the Origin project and then Origin object protections cannot be altered until the correct password is entered. When security is not an issue (e.g. you just want to prevent accidental modification or deletion of a certain book or sheet) you can add object-level protections without an Admin password. For more information on setting up an Admin password, see <a href="../../LabTalk/Script/Protecting_Project_Data.html#Password_Protection_against_Modifying_the_OPJ:_Admin_Mode" title="Script:Protecting Project Data">Admin Mode</a>.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Project-level_Protections"><span class="tocnumber">1</span> <span class="toctext">Project-level Protections</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Password_Protection_Against_Opening_the_OPJ"><span class="tocnumber">1.1</span> <span class="toctext">Password Protection Against Opening the OPJ</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Password_Protection_against_Modifying_the_OPJ:_Admin_Mode"><span class="tocnumber">1.2</span> <span class="toctext">Password Protection against Modifying the OPJ: Admin Mode</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#App_Title_Bar_Indication_of_Admin_Mode"><span class="tocnumber">1.3</span> <span class="toctext">App Title Bar Indication of Admin Mode</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Admin_Mode_and_Saving_the_OPJ"><span class="tocnumber">1.4</span> <span class="toctext">Admin Mode and Saving the OPJ</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Worksheet-_and_Workbook-level_Protections"><span class="tocnumber">2</span> <span class="toctext">Worksheet- and Workbook-level Protections</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#Layer_and_Page_Protection_Flags"><span class="tocnumber">2.1</span> <span class="toctext">Layer and Page Protection Flags</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Layer_and_Page_Protection_Examples"><span class="tocnumber">2.2</span> <span class="toctext">Layer and Page Protection Examples</span></a>
<ul>
<li class="toclevel-3 tocsection-9"><a href="#Examples:_Setting_worksheet_write_access_flags"><span class="tocnumber">2.2.1</span> <span class="toctext">Examples: Setting worksheet write access flags</span></a></li>
<li class="toclevel-3 tocsection-10"><a href="#Examples:_Setting_workbook_write_access_flags"><span class="tocnumber">2.2.2</span> <span class="toctext">Examples: Setting workbook write access flags</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-11"><a href="#Print_out_current_protection_flags"><span class="tocnumber">2.3</span> <span class="toctext">Print out current protection flags</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Exclusion_Zones_on_a_Read-Only_Sheet"><span class="tocnumber">2.4</span> <span class="toctext">Exclusion Zones on a Read-Only Sheet</span></a>
<ul>
<li class="toclevel-3 tocsection-13"><a href="#Commands_to_manage_Exclusion_Zones"><span class="tocnumber">2.4.1</span> <span class="toctext">Commands to manage Exclusion Zones</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-14"><a href="#Protecting_Graphs"><span class="tocnumber">2.5</span> <span class="toctext">Protecting Graphs</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="#Script_Example"><span class="tocnumber">2.6</span> <span class="toctext">Script Example</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="Project-level_Protections"></a><span class="mw-headline">Project-level Protections</span></h2>
<p>There are two types of project-level password protections:
</p>
<ul><li> You can add a password to the Origin project and prevent unauthorized persons from opening the OPJ.  This method is accessible both <a class="external text" href="../../UserGuide/UserGuide/Protecting_Origin_Projects.html#Password_Protection_Against_Opening_the_OPJ">from the GUI</a> and from LabTalk script.</li>
<li> You can add an Admin password to the project and prevent unauthorized editing of the OPJ. This method does not restrict access to the OPJ; nor does it prevent a user from editing and saving the OPJ to a new file name. This method is LabTalk script-accessible only.</li></ul>
<h3><a name="Password_Protection_Against_Opening_the_OPJ"></a><span class="mw-headline">Password Protection Against Opening the OPJ</span></h3>
<p>When this type of password protection is enabled, you must enter a password to open the Origin project (OPJ). This applies to opening by appending, opening by script, etc. 
To password protect a project from being opened without permission:
</p>
<ul><li> With the project file open, open the Script window or Command window and type</li></ul>
<pre class="lt" style="font-family:monospace;">doc <span style="color: #000080;">-</span>pwd</pre>
<p>This opens the Password dialog where you can set or change the project password.
</p>
<ul><li> For GUI access to this feature, click <b>Tools: Protection: Protect Project</b> and enter a password.</li></ul>
<h3><a name="Password_Protection_against_Modifying_the_OPJ:_Admin_Mode"></a><span class="mw-headline">Password Protection against Modifying the OPJ: Admin Mode</span></h3>
<p>The concept of an Admin mode has been added to the Origin Project. Once a project is protected by an Admin password, the project cannot be modified, nor can workbook and worksheet protection features be changed without being logged into the OPJ as Admin. 
</p><p>To establish Admin protections for the OPJ, open the Script window and type:
</p>
<pre class="lt" style="font-family:monospace;">doc <span style="color: #000080;">-</span>pwa <span style="color: #000000;">&#91;</span>password<span style="color: #000000;">&#93;</span> <span style="color: #008000;">//adds Admin password ''password'' to the OPJ</span></pre>
<p>As indicated by the square brackets, choosing a password is optional. If you do not choose a password, you will not be required to supply one when logging into Admin mode.
</p><p>Once you have created a password, or accepted the default ("origin"), log into Admin mode by entering the following at the command line:
</p>
<pre class="lt" style="font-family:monospace;">doc <span style="color: #000080;">-</span>pw <span style="color: #000000;">&#91;</span>password<span style="color: #000000;">&#93;</span> <span style="color: #008000;">// log into Admin Mode. If password was specifed, give password</span></pre> 
<p>Additional commands:
</p>
<pre class="lt" style="font-family:monospace;">doc <span style="color: #000080;">-</span>pwx <span style="color: #008000;">// logout of Admin Mode. No access to protections</span></pre>
<pre class="lt" style="font-family:monospace;">doc <span style="color: #000080;">-</span>pwr <span style="color: #008000;">// remove password. Must be logged in to execute</span></pre>
<pre class="lt" style="font-family:monospace;">doc <span style="color: #000080;">-</span>pwta <span style="color: #008000;">// list all books &amp; sheets with protections enabled</span></pre>
<table class="note">

<tr>
<td>For complete documentation on the <b>document</b> command see the <a class="external text" href="../../LabTalk/LabTalk/Document_(command).html">document</a> command.
</td></tr></table>
<h3><a name="App_Title_Bar_Indication_of_Admin_Mode"></a><span class="mw-headline">App Title Bar Indication of Admin Mode</span></h3>
<p>The Origin title bar indicates the Admin state of the Origin project:
</p>
<ul><li> No Admin mode for OPJ (normal mode).</li></ul>
<dl><dd> <a  class="image"><img alt="No admin mode.png" src="../images/Protecting_Project_Data/No_admin_mode.png?v=30894" width="205"  /></a></dd></dl>
<ul><li> Admin mode enabled for OPJ but user is not logged in as Admin.</li></ul>
<dl><dd> <a  class="image"><img alt="Exist admin mode.png" src="../images/Protecting_Project_Data/Exist_admin_mode.png?v=30891" width="215"  /></a></dd></dl>
<ul><li> Admin mode enabled for OPJ and user is logged in as Admin.</li></ul>
<dl><dd> <a  class="image"><img alt="Login admin mode1.png" src="../images/Protecting_Project_Data/Login_admin_mode1.png?v=30896" width="209"  /></a></dd></dl>
<h3><a name="Admin_Mode_and_Saving_the_OPJ"></a><span class="mw-headline">Admin Mode and Saving the OPJ</span></h3>
<p>Once a project has Admin mode enabled, it cannot be overwritten from Origin without logging in. When an Admin-enabled OPJ is open, you may modify the OPJ in an  unprotected area (see <a href="../../LabTalk/Script/Protecting_Project_Data.html#Worksheet-_and_Workbook-level_Protections" title="Script:Protecting Project Data">Workbook- and Worksheet-level Protections</a>) without logging in and you will see an asterisk(*) appended to the file name in the Origin title bar. 
</p>
<ul><li> Unmodified file</li></ul>
<dl><dd> <a  class="image"><img alt="Admin mode clean.png" src="../images/Protecting_Project_Data/Admin_mode_clean.png?v=30906" width="132"  /></a></dd></dl>
<ul><li> Modified file</li></ul>
<dl><dd> <a  class="image"><img alt="Admin mode dirty.png" src="../images/Protecting_Project_Data/Admin_mode_dirty.png?v=30907" width="138"  /></a></dd></dl>
<p>The asterisk indicates that the OPJ has been modified, but you will not be able to save the OPJ unless you log in before saving. You can exit the OPJ without saving and without logging in.
</p>
<h2><a name="Worksheet-_and_Workbook-level_Protections"></a><span class="mw-headline">Worksheet- and Workbook-level Protections</span></h2>
<p>The following protections can be applied without establishing an <a href="../../LabTalk/Script/Protecting_Project_Data.html#Password_Protection_against_Modifying_the_OPJ:_Admin_Mode" title="Script:Protecting Project Data">Admin mode</a>. However, note that without Admin mode, there is nothing to prevent others with file access from removing these protections.
</p><p>Protections can be applied or removed at the sheet level using the following command syntax:
</p>
<pre class="lt" style="font-family:monospace;">layer <span style="color: #000080;">-</span>lw hex<span style="color: #000000;">&#40;</span>hex value<span style="color: #000000;">&#41;</span></pre>
<p>Protections can be applied or removed at the book level using the following command syntax:
</p>
<pre class="lt" style="font-family:monospace;">page <span style="color: #000080;">-</span>lw hex<span style="color: #000000;">&#40;</span>hex value<span style="color: #000000;">&#41;</span></pre>
<p>There is a general inheritance rule on protection flags: Once you set protection on a book, then all sheets inside the book will inherent the flags from the book. The exception to this rule is the <b>Delete</b> flag. You must separately control book and sheet deletion flags (i.e. You may not want to allow book deletion, but still allow deletion of individual sheets).
</p>
<h3><a name="Layer_and_Page_Protection_Flags"></a><span class="mw-headline">Layer and Page Protection Flags</span></h3>
<p>For layer or page protections, <i>hex value</i> takes on the following:
</p>
<table class="simple">
<tr>
<th> Hex Value
</th>
<th> Description
</th></tr>
<tr>
<td> --
</td>
<td>Turn on all protection bits.
</td></tr>
<tr>
<td>0
</td>
<td>Remove all protections from the active worksheet/workbook.
</td></tr>
<tr>
<td>2
</td>
<td> <b>Data</b>: Include all the cells in a worksheet, data cells or label cells.
</td></tr>
<tr>
<td> 80
</td>
<td> <b>Structure</b>: Keep the columns in the sheet unchanged. Prevent insert/delete columns or moving columns, but allow rows to be changed.
</td></tr>
<tr>
<td> 100
</td>
<td> <b>Rename</b>: Prevent changing sheet name (not supported for workbook).
</td></tr>
<tr>
<td> 400
</td>
<td> <b>Delete</b>: Prevent object from being deleted.
</td></tr></table>
<table class="note">

<tr>
<td><b>Note:</b> Before applying protections, please read  <a href="../../LabTalk/Script/Protecting_Project_Data.html#Commands_to_manage_Exclusion_Zones" title="Script:Protecting Project Data">the note on Exclusion Zones</a>.
</td></tr></table>
<h3><a name="Layer_and_Page_Protection_Examples"></a><span class="mw-headline">Layer and Page Protection Examples</span></h3>
<p>The following examples demonstrate that multiple protection flags can be combined (hex values are additive) to give greater control over what is protected. 
</p>
<h4><a name="Examples:_Setting_worksheet_write_access_flags"></a><span class="mw-headline">Examples: Setting worksheet write access flags</span></h4>
<pre class="lt" style="font-family:monospace;">lay <span style="color: #000080;">-</span>lw hex<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">82</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//set active sheet to protect data and structure</span>
lay <span style="color: #000080;">-</span>lw; <span style="color: #008000;">//protect everything</span>
lay <span style="color: #000080;">-</span>lw <span style="color: #0000dd;">2</span>; <span style="color: #008000;">//protect only data</span>
lay <span style="color: #000080;">-</span>lw hex<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">180</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//no insert/del cols/rows, no sheet rename</span>
lay <span style="color: #000080;">-</span>lw <span style="color: #0000dd;">0</span>; <span style="color: #008000;">//remove all protections on the current sheet</span></pre>
<p>... where <i>hex value</i> is derived from values in <a href="../../LabTalk/Script/Protecting_Project_Data.html#Layer_and_Page_Protection_Flags" title="Script:Protecting Project Data">the above table</a>.
</p>
<h4><a name="Examples:_Setting_workbook_write_access_flags"></a><span class="mw-headline">Examples: Setting workbook write access flags</span></h4>
<pre class="lt" style="font-family:monospace;">page <span style="color: #000080;">-</span>lw; <span style="color: #008000;">//lock book and all sheets, no changes, cannot delete book or sheets</span>
page <span style="color: #000080;">-</span>lw hex<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">482</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//lock delete, structure change and data edit</span>

<span style="color: #008000;">// prepare the book for locking active sheet but </span>
<span style="color: #008000;">// allow analysis results to be added to book</span>
lay <span style="color: #000080;">-</span>lw hex<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">582</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//no del, no rename, no add/insert/move col/rows, no edit</span>

page <span style="color: #000080;">-</span>lw hex<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">400</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//no del book</span></pre>
<p>... where <i>hex value</i> is derived from values in <a href="../../LabTalk/Script/Protecting_Project_Data.html#Layer_and_Page_Protection_Flags" title="Script:Protecting Project Data">the above table</a>.
</p>
<table class="note">

<tr>
<td><b>Note</b>: As of Origin 2015 SR1, the command ...
<pre class="lt" style="font-family:monospace;">page <span style="color: #000080;">-</span>lw; <span style="color: #008000;">// lock book and all sheets</span></pre>
<p>... does not prevent renaming of the workbook.
</p>
</td></tr></table>
<h3><a name="Print_out_current_protection_flags"></a><span class="mw-headline">Print out current protection flags</span></h3>
<pre class="lt" style="font-family:monospace;">layer <span style="color: #000080;">-</span>lt <span style="color: #008000;">// print out current sheet protection flags</span></pre>
<pre class="lt" style="font-family:monospace;">page <span style="color: #000080;">-</span>lt <span style="color: #008000;">// print out current page protection flags</span></pre>
<table class="note">

<tr>
<td>
<ul><li> For complete documentation on the <b>layer</b> command see the <a class="external text" href="../../LabTalk/LabTalk/Layer_(command).html">layer</a> command.</li>
<li> For complete documentation on the <b>page</b> command see the <a class="external text" href="../../LabTalk/LabTalk/Page_(command).html">page</a> command.</li></ul>
</td></tr></table>
<h3><a name="Exclusion_Zones_on_a_Read-Only_Sheet"></a><span class="mw-headline">Exclusion Zones on a Read-Only Sheet</span></h3>
<p>When you have locked a worksheet from modifications, all the cells in the sheet become read-only. There may be instances -- e.g. you are setting up a sheet as a form -- where you want users to be able to selectively modify the sheet. The following explains how to create and manage sheet <b>Exclusion Zones</b>.
</p>
<h4><a name="Commands_to_manage_Exclusion_Zones"></a><span class="mw-headline">Commands to manage Exclusion Zones</span></h4>
<pre class="lt" style="font-family:monospace;">layer <span style="color: #000080;">-</span>les n</pre>
<p>... where <i>n</i> can be one of the following:
</p>
<table class="simple">
<tr>
<th> Value
</th>
<th> Description
</th></tr>
<tr>
<td>0
</td>
<td>Clear all Exclusion Zones from the active sheet.
</td></tr>
<tr>
<td>1
</td>
<td>Add the current selection, one range or multiple via CTRL+select, as new Exclusion Zones.
</td></tr>
<tr>
<td>2
</td>
<td>List the Exclusion Zones in the Script window.
</td></tr></table>
<table class="note">

<tr>
<td> <b>Note:</b> You can only make Exclusion Zone modifications when the sheet is unprotected. To set the sheet up as a form, you should (1) add all the needed Exclusion Zones, then (2) protect the sheet from modification with <b>lay -lw</b>
</td></tr></table>
<h3><a name="Protecting_Graphs"></a><span class="mw-headline">Protecting Graphs</span></h3>
<p>Although the script commands outlined here were implemented for workbooks and worksheets, the <b>Delete</b> flag is general and can be used to protect graphs, as in the following example:
</p>
<pre class="lt" style="font-family:monospace;">repeat <span style="color: #0000dd;">10</span> <span style="color: #000000;">&#123;</span>win <span style="color: #000080;">-</span>t plot<span style="color: #000000;">&#125;</span>; <span style="color: #008000;">//create 10 graph windows</span>
win <span style="color: #000080;">-</span>o graph4 <span style="color: #000000;">&#123;</span>page <span style="color: #000080;">-</span>lw hex<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">400</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#125;</span>; <span style="color: #008000;">//set graph4 protection</span>
doc <span style="color: #000080;">-</span>e P <span style="color: #000000;">&#123;</span>win <span style="color: #000080;">-</span>c<span style="color: #000000;">&#125;</span>; <span style="color: #008000;">//loop to delete all graph in opj. Graph4 will be protected.</span></pre>
<h3><a name="Script_Example"></a><span class="mw-headline">Script Example</span></h3>
<p>The following script sets up a workbook with a locked data sheet and protects the workbook from deletion. The OPJ can then be saved and shared with others who can view, graph, and analyze the data, but cannot edit or delete. 
</p><p>Analysis results are output to additional sheets, so routines that generate output such as <b>Smooth</b> should be configured to send output to another sheet, as the data sheet in this example will be protected from modifications.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Import a sample file</span>
newbook;
string fname<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span><span style="color: #000080;">+</span><span style="color: #ff00ff;">&quot;Samples\Curve Fitting\Gaussian.dat&quot;</span>;
impasc;
<span style="color: #008000;">// Set password and login - change mypwd to your desired password string</span>
doc <span style="color: #000080;">-</span>pwa mypwd;
doc <span style="color: #000080;">-</span>pw mypwd;
<span style="color: #008000;">// Protect data sheet structure, prevent editing, deleting</span>
lay <span style="color: #000080;">-</span>lw hex<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">482</span><span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// Protect page from deletion</span>
page <span style="color: #000080;">-</span>lw hex<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">400</span><span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// logout</span>
doc <span style="color: #000080;">-</span>pwx;
<span style="color: #008000;">// Now you can save the OPJ and others can view data, graph, and also analyze</span>
<span style="color: #008000;">// Analysis results can go into new sheets, not new cols in same sheet</span></pre>






