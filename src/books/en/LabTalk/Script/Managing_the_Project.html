<h1 class="firstHeading">2.12.1 Managing the Project</h1><p class='urlname' style='display: none'>Managing-the-Project</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#The_DOCUMENT_CommandManage_ProjectProject_Management"><span class="tocnumber">1</span> <span class="toctext">The DOCUMENT Command<span class="OIndex" style="display:none">Manage Project</span><span class="OIndex" style="display:none">Project Management</span></span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Start_a_New_ProjectStart_a_New_Project"><span class="tocnumber">1.1</span> <span class="toctext">Start a New Project<span class="OIndex" style="display:none">Start a New Project</span></span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Open.2FSave_a_project"><span class="tocnumber">1.2</span> <span class="toctext">Open/Save a project</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Append_projectsAppend_projectorigin_project.2C_append"><span class="tocnumber">1.3</span> <span class="toctext">Append projects<span class="OIndex" style="display:none">Append project</span><span class="OIndex" style="display:none">origin project, append</span></span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Save.2FLoad_Child_WindowsSave_WindowLoad_Window"><span class="tocnumber">1.4</span> <span class="toctext">Save/Load Child Windows<span class="OIndex" style="display:none">Save Window</span><span class="OIndex" style="display:none">Load Window</span></span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Saving_External_Excel_Book"><span class="tocnumber">1.5</span> <span class="toctext">Saving External Excel Book</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Refresh_Windows"><span class="tocnumber">1.6</span> <span class="toctext">Refresh Windows</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8"><a href="#Project_Explorer_X-Functions"><span class="tocnumber">2</span> <span class="toctext">Project Explorer X-Functions</span></a></li>
</ul>
</div>

<h2><a name="The_DOCUMENT_CommandManage_ProjectProject_Management"></a><span class="mw-headline">The DOCUMENT Command<span class="OIndex" style="display:none">Manage Project</span><span class="OIndex" style="display:none">Project Management</span></span></h2>
<p><b><span class="OIndex">Document</span></b> is a native LabTalk command that lets you perform various operations related to the Origin Project. The syntax for the <a href="../../LabTalk/LabTalk/Document_(command)&amp;action=edit&amp;redlink=1.html" class="new" title="LabTalk:Document (command) (page does not exist)"><b>document</b> command</a> is
</p>
<pre class="lt" style="font-family:monospace;">document <span style="color: #000080;">-</span>option value;</pre>
<p>Notes:
</p>
<ul><li> <i>value</i> is not applicable for some options and is left out of the command</li>
<li> For additional capabilities please see the Doc (Object).</li></ul>
<p>Internally, Origin updates a property that indicates when a project has been modified. Attempting to Open a project when the current project has been modified normally triggers a prompt to Save the current project. The document command has options to control this property.
</p>
<h3><a name="Start_a_New_ProjectStart_a_New_Project"></a><span class="mw-headline">Start a New Project<span class="OIndex" style="display:none">Start a New Project</span></span></h3>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// WARNING! This will turn off the Save project prompt</span>
document <span style="color: #000080;">-</span>s; 
<span style="color: #008000;">// ''doc'' is short for ''document'' and ''n'' is short for ''new''</span>
doc <span style="color: #000080;">-</span>n;</pre>
<h3><a name="Open.2FSave_a_project"></a><span class="mw-headline">Open/Save a project</span></h3>
<p>Use the <a href="../../LabTalk/LabTalk/Document_(command)&amp;action=edit&amp;redlink=1.html" class="new" title="LabTalk:Document (command) (page does not exist)">doc -o command</a> to <span class="OIndex">open a project</span><span class="OIndex HasShownIndex" style="display:none">origin project, open/save</span> and the <a href="../../LabTalk/LabTalk/Save_(command).html" title="LabTalk:Save (command)">save command</a> to save it.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Open an Origin Project file</span>
string fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> SYSTEM.<span style="color: #000080;">PATH</span>.<span style="color: #000080;">PROGRAM</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Origin.opj&quot;</span>;
doc <span style="color: #000080;">-</span>o <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>fname<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>;   <span style="color: #008000;">// Abbreviation of ''document -open''</span>
<span style="color: #008000;">// Make some changes</span>
<span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>Data1,<span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> data<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span>,<span style="color: #0000dd;">100</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>Data1,<span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">100</span> <span style="color: #000080;">*</span> uniform<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">101</span><span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// Save the project with a new name in new location</span>
fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> SYSTEM.<span style="color: #000080;">PATH</span>.<span style="color: #000080;">APPDATA</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;My Project.opj&quot;</span>;
save <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>fname<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>;</pre>
<h3><a name="Append_projectsAppend_projectorigin_project.2C_append"></a><span class="mw-headline">Append projects<span class="OIndex" style="display:none">Append project</span><span class="OIndex" style="display:none">origin project, append</span></span></h3>
<p>Continuing with the previous script, we can Append other project file(s). Origin supports only one project file at a time so the existing project plus the appended project become the new project.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Append an Origin Project file to the current file</span>
fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> SYSTEM.<span style="color: #000080;">PATH</span>.<span style="color: #000080;">PROGRAM</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Origin.opj&quot;</span>;
doc <span style="color: #000080;">-</span>a <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>fname<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Abbreviation of ''document -append''</span>
<span style="color: #008000;">// Save the current project - which is still ''My Project.opj''</span>
save;
<span style="color: #008000;">// Save the current project with a new name to a new location</span>
save C<span style="color: #000000;">:</span>\Data Files\working.<span style="color: #000080;">opj</span>;</pre>
<h3><a name="Save.2FLoad_Child_WindowsSave_WindowLoad_Window"></a><span class="mw-headline">Save/Load Child Windows<span class="OIndex" style="display:none">Save Window</span><span class="OIndex" style="display:none">Load Window</span></span></h3>
<p>In Origin, a child window - such as a graph, workbook, matrix or Excel book - can be saved as a single file. Append can be used to add the file to another project. The appropriate extension is added automatically for Workbook, Matrix and Graph whereas you must specify .XLS for Excel windows.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// The save command acts on the active window</span>
save <span style="color: #000080;">-</span>i C<span style="color: #000000;">:</span>\Data\MyBook;</pre>
<p><b>Append</b> can be used to load Child Window Types&#160;:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Workbook(*.OGW), Matrix(*.OGM), Graph(*.OGG), Excel(*.XLS)</span>
dlgfile group<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000080;">*</span>.<span style="color: #000080;">ogg</span>; 
<span style="color: #008000;">// fname is the string variable set by the dlgfile X-Function</span>
doc <span style="color: #000080;">-</span>a <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>fname<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>;</pre>
<p>For Excel, you can specify that an Excel file should be imported rather than opened as Excel
</p>
<pre class="lt" style="font-family:monospace;">doc <span style="color: #000080;">-</span>ai <span style="color: #ff00ff;">&quot;C:\Data\Excel\Current Data.xls&quot;</span>;</pre>
<p>Notes windows are a special case with special option switch:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Save notes window named Notes1</span>
save <span style="color: #000080;">-</span>n Notes1 C<span style="color: #000000;">:</span>\Data\Notes\Today.<span style="color: #000080;">TXT</span>; 
<span style="color: #008000;">// Read text file into notes window named MyNotes</span>
open <span style="color: #000080;">-</span>n C<span style="color: #000000;">:</span>\Data\Notes\Today.<span style="color: #000080;">txt</span> MyNotes;</pre>
<h3><a name="Saving_External_Excel_Book"></a><span class="mw-headline">Saving External Excel Book</span></h3>
<p>This is introduced in Origin 8.1, to allow an externally linked <span class="OIndex">Excel book</span> to be saved using its current file name:
</p>
<pre class="lt" style="font-family:monospace;">save <span style="color: #000080;">-</span>i;</pre>
<h3><a name="Refresh_Windows"></a><span class="mw-headline">Refresh Windows</span></h3>
<p>You can <span class="OIndex">refresh window</span>s with the following command:
</p>
<pre class="lt" style="font-family:monospace;">doc <span style="color: #000080;">-</span>u;</pre>
<h2><a name="Project_Explorer_X-Functions"></a><span class="mw-headline">Project Explorer X-Functions</span></h2>
<p>The following X-Functions provide DOS-like commands to create, delete and navigate through the subfolders of the project:
</p>
<table class="simple">
<tr>
<th> Name
</th>
<th> Brief Description
</th></tr>
<tr>
<td> <a class="external text" href="../../XFunction/X-Function/Pe_dir.html">pe_dir</a>
</td>
<td>
<p>Show the contents of the active folder
</p>
</td></tr>
<tr>
<td> <a class="external text" href="../../XFunction/X-Function/Pe_cd.html">pe_cd</a>
</td>
<td>
<p>Change to another folder
</p>
</td></tr>
<tr>
<td> <a class="external text" href="../../XFunction/X-Function/Pe_move.html">pe_move</a>
</td>
<td>
<p>Move a Folder or Window
</p>
</td></tr>
<tr>
<td> <a class="external text" href="../../XFunction/X-Function/Pe_path.html">pe_path</a>
</td>
<td>
<p>Report the current path
</p>
</td></tr>
<tr>
<td> <a class="external text" href="../../XFunction/X-Function/Pe_rename.html">pe_rename</a>
</td>
<td>
<p>Rename a Folder or Window
</p>
</td></tr>
<tr>
<td> <a class="external text" href="../../XFunction/X-Function/Pe_mkdir.html">pe_mkdir</a>
</td>
<td>
<p>Create a Folder
</p>
</td></tr>
<tr>
<td> <a class="external text" href="../../XFunction/X-Function/Pe_rmdir.html">pe_rmdir</a>
</td>
<td>
<p>Delete a Folder
</p>
</td></tr>
</table>
<p>In this example&#160;:
</p>
<pre class="lt" style="font-family:monospace;">doc <span style="color: #000080;">-</span>s;                      <span style="color: #008000;">// Clear Origin's 'dirty' flag</span>
doc <span style="color: #000080;">-</span>n;                      <span style="color: #008000;">// Start a new project</span>
pe_cd <span style="color: #000080;">/</span>;                     <span style="color: #008000;">// Go to the top level</span>
pe_mkdir <span style="color: #ff00ff;">&quot;Test Subjects&quot;</span>;    <span style="color: #008000;">// Create a folder</span>
pe_cd <span style="color: #ff00ff;">&quot;Test Subjects&quot;</span>;       <span style="color: #008000;">// Navigate to that folder</span>
pe_mkdir <span style="color: #ff00ff;">&quot;Trials&quot;</span>;           <span style="color: #008000;">// Create a sub-folder</span>
pe_mkdir <span style="color: #ff00ff;">&quot;Results&quot;</span>;          <span style="color: #008000;">//  and another</span>
pe_cd <span style="color: #000080;">/</span>;                     <span style="color: #008000;">// Return to the top level</span>
pe_mkdir <span style="color: #ff00ff;">&quot;Control Subjects&quot;</span>; <span style="color: #008000;">// Create another folder</span>
pe_cd <span style="color: #ff00ff;">&quot;Control Subjects&quot;</span>;    <span style="color: #008000;">// Navigate to that folder</span>
pe_mkdir <span style="color: #ff00ff;">&quot;Trials&quot;</span>;           <span style="color: #008000;">// Create a sub-folder</span>
pe_mkdir <span style="color: #ff00ff;">&quot;Results&quot;</span>;          <span style="color: #008000;">//  and another</span>
pe_cd <span style="color: #000080;">/</span>;                     <span style="color: #008000;">// Return to the top level</span>
pe_mkdir <span style="color: #ff00ff;">&quot;Comparison&quot;</span>;       <span style="color: #008000;">// Create a folder</span></pre>
<p>we create a folder structure that looks like this in Project explorer&#160;:<br />
<a  class="image"><img alt="PE TREE.png" src="../images/Managing_the_Project/PE_TREE.png?v=27291" width="214"  /></a><br />
</p><p>Note that if you have <b>Open in Subfolder</b> enabled in Preference: Options&#160;: [Open/Close] then you will have an additional folder named <b>Folder1</b>.
</p>





