<h1 class="firstHeading">2.8.2.1 Basic Matrixsheet Operation</h1><p class='urlname' style='display: none'>Matrix-Basic-Operation</p>
<p>Examples in this section are similar to those found in the <a href="../../LabTalk/Script/Worksheet_Basic_Operation.html" title="Script:Worksheet Basic Operation">Basic Worksheet Operation</a> section, because many object properties and X-Functions apply to both Worksheets and Matrixsheets.  Note, however, that not all properties of the <b>wks</b> object apply to a matrixsheet, and one should verify before using a property in production code.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Add_New_Matrixsheet"><span class="tocnumber">1</span> <span class="toctext">Add New Matrixsheet</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Activate_a_Matrixsheet"><span class="tocnumber">2</span> <span class="toctext">Activate a Matrixsheet</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Modify_Matrixsheet_Properties"><span class="tocnumber">3</span> <span class="toctext">Modify Matrixsheet Properties</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Set_Dimensions"><span class="tocnumber">3.1</span> <span class="toctext">Set Dimensions</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Set_Labels"><span class="tocnumber">3.2</span> <span class="toctext">Set Labels</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Set_XY_Mapping"><span class="tocnumber">3.3</span> <span class="toctext">Set XY Mapping</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-7"><a href="#Delete_Matrixsheet"><span class="tocnumber">4</span> <span class="toctext">Delete Matrixsheet</span></a></li>
</ul>
</div>

<h2><a name="Add_New_Matrixsheet"></a><span class="mw-headline">Add New Matrixsheet</span></h2>
<p>The <a class="external text" href="../../XFunction/X-Function/Newsheet.html"><b>newsheet</b></a> X-Function with the <i>mat:=1</i> option can be used to add new matrixsheets to matrixbook.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create a new matrixbook with 3 matrixsheets, </span>
<span style="color: #008000;">// and use &quot;myMatrix&quot; as long name and short name</span>
newbook name<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;myMatrix&quot;</span> sheet<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span> option<span style="color: #000000;">:</span><span style="color: #000080;">=</span>lsname mat<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
<span style="color: #008000;">// Add a 100*100 matrixsheet named &quot;newMatrix&quot; to current matrixbook</span>
newsheet name<span style="color: #000000;">:</span><span style="color: #000080;">=</span>newMatrix cols<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">100</span> rows<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">100</span> mat<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;</pre>
<h2><a name="Activate_a_Matrixsheet"></a><span class="mw-headline">Activate a Matrixsheet</span></h2>
<p><span class="OIndex" style="display:none">Active Matrixsheet</span><span class="OIndex" style="display:none">Active Window</span><span class="OIndex" style="display:none">Active Workbook</span><span class="OIndex" style="display:none">Active Matrixbook</span>Similar to worksheets, matrixsheets are also layers in a <a href="../../LabTalk/LabTalk/Page_(object).html" title="LabTalk:Page (object)">page</a>, and <i>page.active</i> and <i>page.active$</i> properties can access matrixsheets. For example:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create a new matrixbook with 3 matrixsheets</span>
newbook sheet<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span> mat<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;

page.<span style="color: #000080;">active</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;	<span style="color: #008000;">// Activate a matrixsheet by layer number</span>
page.<span style="color: #000080;">active</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> MSheet3;	<span style="color: #008000;">// Activate a matrixsheet by name</span></pre>
<h2><a name="Modify_Matrixsheet_Properties"></a><span class="mw-headline">Modify Matrixsheet Properties</span></h2>
<p>To modify matrix properties, use the <a href="../../LabTalk/LabTalk/Wks_(object).html" title="LabTalk:Wks (object)">wks</a> object, which works on matrixsheets as well as worksheets. For example:
<span class="OIndex" style="display:none">Rename matrixsheet</span>
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Rename the matrixsheet</span>
wks.<span style="color: #000080;">name</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;New Matrix&quot;</span>;
<span style="color: #008000;">// Modify the column width</span>
wks.<span style="color: #000080;">colwidth</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">8</span>;</pre>
<h4><a name="Set_Dimensions"></a><span class="mw-headline">Set Dimensions</span></h4>
<p>Both the <a href="../../LabTalk/LabTalk/Wks_(object).html" title="LabTalk:Wks (object)">wks</a> object and the  <a class="external text" href="../../XFunction/X-Function/Mdim.html">mdim</a> X-Function can be used to set matrix dimensions:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Use the wks object to set dimension</span>
wks.<span style="color: #000080;">ncols</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">100</span>;
wks.<span style="color: #000080;">nrows</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">200</span>;
<span style="color: #008000;">// Use the mdim X-Function to set dimension</span>
mdim cols<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">100</span> rows<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">100</span>;</pre>
<p>For the case of multiple matrix objects contained in the same matrixsheet, note that all of the matrix objects must have the same dimensions.
</p>
<h4><a name="Set_Labels"></a><span class="mw-headline">Set Labels</span></h4>
<p>You can use wks.x(y).comments$/longname$/units$ to get/set x/y labels. See the <a href="../../LabTalk/LabTalk/Wks_(object).html" title="LabTalk:Wks (object)">wks</a> object for details.
Z labels can see <a class="external text" href="https://www.originlab.com/doc/en/LabTalk/guide/Basic-Matrix-Object-Operation#Set_Labels" target="_blank">this</a>.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//write the Long Name for X coordinates of the active matrix</span>
wks.<span style="color: #000080;">x</span>.<span style="color: #000080;">longname</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;time&quot;</span></pre>
<h4><a name="Set_XY_Mapping"></a><span class="mw-headline">Set XY Mapping</span></h4>
<p>Matrices have numbered columns and rows which are mapped to linearly spaced X and Y values. In LabTalk, you can use the <a class="external text" href="../../XFunction/X-Function/Mdim.html">mdim</a> X-Function to set the mapping.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// XY mapping of matrixsheet</span>
mdim cols<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">100</span> rows<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">100</span> x1<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span> x2<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span> y1<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span> y2<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">9</span>;</pre>
<p><br />
</p>
<h2><a name="Delete_Matrixsheet"></a><span class="mw-headline">Delete Matrixsheet</span></h2>
<p>Use the <a href="../../LabTalk/LabTalk/Layer_(command)&amp;action=edit&amp;redlink=1.html" class="new" title="LabTalk:Layer (command) (page does not exist)">layer -d</a> commands to delete matrixsheet. For example:
</p>
<pre class="lt" style="font-family:monospace;">layer <span style="color: #000080;">-</span>d;  <span style="color: #008000;">// delete the active layer, can be worksheet, matrixsheet or graph layer</span>
layer <span style="color: #000080;">-</span>d <span style="color: #0000dd;">3</span>;  <span style="color: #008000;">// by index, delete third matrixsheet in active matrixbook</span>
layer <span style="color: #000080;">-</span>d msheet1;  <span style="color: #008000;">// delete matrixsheet by name</span>
range rs <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>mbook1<span style="color: #000000;">&#93;</span>msheet3<span style="color: #000080;">!</span>;
layer <span style="color: #000080;">-</span>d rs;  <span style="color: #008000;">// delete matrixsheet by range</span>
<span style="color: #008000;">// the matrixbook name stored in a string variable</span>
string str<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> msheet2;
layer <span style="color: #000080;">-</span>d <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>str<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>;</pre>






