<h1 class="firstHeading">2.5.1.7 ProjectEvents Script</h1><p class='urlname' style='display: none'>ProjectEvents-Script</p>
<p><span class="OIndex" style="display:none">Run ProjectEvents Script</span><span class="OIndex" style="display:none">Script, Project events</span>
You may want to define functions, perform routine tasks, or execute a set of commands, upon opening, closing, or saving your Origin project.  In Origin, this is facilitated by a file named <span class="OIndex">ProjectEvents.ogs</span> that is attached to the Origin Project (OPJ) by default. 
</p><p>A template version of this file is shipped with Origin and is located in the <b>EXE</b> folder. This template file is attached to each new project. The file can be viewed and edited by opening <b>Code Builder</b> and expanding the <b>Project</b> node in the left panel. 
</p>
<h2><a name="Sections_of_ProjectEvents.ogs"></a><span class="mw-headline">Sections of ProjectEvents.ogs</span></h2>
<p>The <b>ProjectEvents.ogs</b> file, by default, contains three sections that correspond to three distinct events associated with the project:
</p>
<ol><li> AfterOpenDoc: This section will be executed immediately after the project is opened</li>
<li> BeforeCloseDoc: This section will be executed before the project is closed</li>
<li> BeforeSaveDoc: This section will be executed before the project is saved</li></ol>
<h2><a name="Utilizing_ProjectEvents.ogs"></a><span class="mw-headline">Utilizing ProjectEvents.ogs</span></h2>
<p>In order for this file and its contents to have an effect, a user needs to edit the file and save it in Code Builder, and then save the project. The next time the project is opened, the script code contained in this attached OGS file will be executed upon the specified event (given by the pre-defined section name).
</p><p>For example, if a user defines a new function in the [AfterOpenDoc] section of <b>ProjectEvents.ogs</b>, saves it (in Code Builder), and then saves the project in Origin, that function will be available (if defined to be <a href="../../LabTalk/LabTalk/Data_Types_and_Variables.html#Scope_of_Variables" title="LabTalk:Data Types and Variables">global</a>) for use any time the project is re-opened.  To make the function available in the current session place the cursor (in Code Builder) on the section name to execute, select the <b>Debug</b> drop-down menu, and select the <b>Execute Current Section</b> option.  Then in the Origin Script Window, issuing the <b>list a</b> command will confirm that the new function appears and is available for use in the project. 
</p><p>A brief tutorial in the <a href="../../LabTalk/LabTalk/Functions.html#Tutorial:_Using_Multiple_Function_Features" title="LabTalk:Functions">Functions</a> demonstrates the value of <b>ProjectEvents.ogs</b> when used in conjunction with LabTalk's dataset-based functions.
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/ProjectEvents_Script/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>You can add your own sections to this OGS file to save custom routines or project-specific script code. Such sections will not be event-driven, but can be accessed by name from any place that LabTalk script can be executed. For example, if you add a section to this file named [MyScript], the code in that section can be executed after opening the project by issuing this command from the script window:
</p><p>run.section(projectevents,myscript);
</p></td></tr></table>
<p>A ProjectEvents.ogs script can also be made to run by opening the associated Origin Project (OPJ) <a href="../../LabTalk/Script/From_Console.html#Run_OPJ-Based_Custom_Program_with_Command-Line_Control" title="Script:From Console">from a command console</a> external to Origin.
</p>

