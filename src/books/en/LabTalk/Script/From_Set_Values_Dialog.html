<h1 class="firstHeading">2.5.1.3 From Set Values Dialog</h1><p class='urlname' style='display: none'>From-Set-vals-Dialog</p>
<p><span class="OIndex" style="display:none">Run Script from Set Values Dialog</span><span class="OIndex" style="display:none">script, in set values dialog</span>The <span class="OIndex">Set Values Dialog</span> is useful when calculations on a column of data are based on functions that may include references to other datasets.
</p><p>The column designated by <b>Set Values</b> is filled with the result of an expression that you enter (the expression returns a dataset). The expression can be made to update automatically (Auto), when requested by the user (Manual), or not at all (None).
</p><p>For more complex calculations, where a single expression is not adequate, a <span class="OIndex">Before Formula Scripts</span><span class="OIndex" style="display:none">Script, Before Formula</span> panel in the dialog can include any LabTalk script.
</p><p>Auto and Manual updates create lock icons, <a  class="image"><img alt="Icon Recalculate Auto.png" src="../images/From_Set_Values_Dialog/Icon_Recalculate_Auto.png?v=0" width="14"  /></a> and <a  class="image"><img alt="Icon Recalculate Manual Green.png" src="../images/From_Set_Values_Dialog/Icon_Recalculate_Manual_Green.png?v=0" width="14"  /></a> respectively, at the top of the column. A green lock indicates updated data; A yellow lock <a  class="image"><img alt="Icon Recalculate Manual Yellow.png" src="../images/From_Set_Values_Dialog/Icon_Recalculate_Manual_Yellow.png?v=0" width="14"  /></a> indicates pending update; A red lock indicates broken functionality.
</p><p>In cases where the code is self-referencial (i.e. the column to be set is included in the calculation) the Auto and Manual options are reset to None.
</p><p>Below are two examples of script specifically for the Set Values Dialog.  Typically short scripts are entered in this dialog.
</p>
<h3><a name="Expression_using_another_column"></a><span class="mw-headline">Expression using another column</span></h3>
<p>While limited to expressions (the right side of an equation) as in:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// In column 3</span>
<span style="color: #008000;">// Scale a column - useful for fitting where very large </span>
<span style="color: #008000;">//or very small numbers are problematic</span>
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">*</span>1e6;</pre>
<p>the conditional expression can be useful in some situations:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Set negative values to zero</span>
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">&lt;</span><span style="color: #0000dd;">0</span>?<span style="color: #0000dd;">0</span><span style="color: #000000;">:</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>;</pre>
<h3><a name="Using_Before_Formula_Scripts_Section"></a><span class="mw-headline">Using Before Formula Scripts Section</span></h3>
<p>In the <b>Before Formula Scripts</b> section of the <b>Set Column Values</b> dialog, a script can be entered that will be executed by Origin just before the formula itself is executed.  This feature is useful for carrying out operations that properly setup the formula itself.  The following example demonstrates the use of such a script:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// In column BaseNormal</span>
<span style="color: #008000;">// In the expression section ..</span>
BN
<span style="color: #008000;">// In the Before Formula Scripts section ..</span>
range raR <span style="color: #000080;">=</span> col<span style="color: #000000;">&#40;</span>Reading<span style="color: #000000;">&#41;</span>;   <span style="color: #008000;">// The signal</span>
range raB <span style="color: #000080;">=</span> col<span style="color: #000000;">&#40;</span>Baseline<span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// The Baseline</span>
dataset BN;
BN <span style="color: #000080;">=</span> raR <span style="color: #000080;">-</span> raB;             <span style="color: #008000;">// Subtract the baseline from the signal</span>
stats BN;                   <span style="color: #008000;">// Get statistics of the result</span>
BN <span style="color: #000080;">/</span><span style="color: #000080;">=</span> <span style="color: #000000;">&#40;</span>stats.<span style="color: #000080;">max</span> <span style="color: #000080;">/</span> <span style="color: #0000dd;">100</span><span style="color: #000000;">&#41;</span>;    <span style="color: #008000;">// Normalize to maximum value of 100</span></pre>
<p>The following image is a screenshot of the code above entered into the <b>Set Column Values</b> dialog:
</p><p><br />
<a  class="image"><img alt="Set Column Values.png" src="../images/From_Set_Values_Dialog/Set_Column_Values.png?v=27289" width="383"  /></a>
</p>





