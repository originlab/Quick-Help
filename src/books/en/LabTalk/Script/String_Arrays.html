<h1 class="firstHeading">2.6.5 String Arrays</h1><p class='urlname' style='display: none'>String-Arrays</p>
<p>This example shows how to create a <a href="../../LabTalk/LabTalk/StringArray_(object).html" title="LabTalk:StringArray (object)"><span class="OIndex">string array</span></a>, add elements to it, sort, and list the contents of the array.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Import an existing sample file</span>
newbook;
fpath<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Samples\Data Manipulation\US Metropolitan Area Population.dat&quot;</span>;
string fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> fpath<span style="color: #000080;">$</span>;
impasc;

<span style="color: #008000;">// Loop over last column and find all states</span>
range rMetro<span style="color: #000080;">=</span><span style="color: #0000dd;">4</span>;
stringarray saStates;
for<span style="color: #000000;">&#40;</span> int ir<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>; ir<span style="color: #000080;">&lt;=</span>rMetro.<span style="color: #000080;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; ir<span style="color: #000080;">++</span> <span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	string strCell<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> rMetro<span style="color: #000000;">&#91;</span>ir<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span>;
	string strState<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> strCell.<span style="color: #000080;">GetToken</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span>,<span style="color: #ff00ff;">','</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">$</span>;
	<span style="color: #008000;">// Find instances of '-' in name</span>
	int nn <span style="color: #000080;">=</span> strState.<span style="color: #000080;">GetNumTokens</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;-&quot;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #008000;">// Add to States string array</span>
	for<span style="color: #000000;">&#40;</span> int ii<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>; ii<span style="color: #000080;">&lt;=</span>nn; ii<span style="color: #000080;">++</span> <span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		string str<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> strState.<span style="color: #000080;">GetToken</span><span style="color: #000000;">&#40;</span>ii, <span style="color: #ff00ff;">'-'</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">$</span>;
		<span style="color: #008000;">// Add if not already present</span>
		int nFind <span style="color: #000080;">=</span> saStates.<span style="color: #000080;">Find</span><span style="color: #000000;">&#40;</span>str<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>;
		if<span style="color: #000000;">&#40;</span> nFind <span style="color: #000080;">&lt;</span> <span style="color: #0000dd;">1</span> <span style="color: #000000;">&#41;</span>
			saStates.<span style="color: #000080;">Add</span><span style="color: #000000;">&#40;</span>str<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span>

<span style="color: #008000;">// Sort States string array and print out</span>
saStates.<span style="color: #000080;">Sort</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
for<span style="color: #000000;">&#40;</span>int ii<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>; ii<span style="color: #000080;">&lt;=</span>saStates.<span style="color: #000080;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; ii<span style="color: #000080;">++</span><span style="color: #000000;">&#41;</span>
	saStates.<span style="color: #000080;">GetAt</span><span style="color: #000000;">&#40;</span>ii<span style="color: #000000;">&#41;</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>;</pre>






