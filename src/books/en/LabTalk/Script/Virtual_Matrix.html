<h1 class="firstHeading">2.7.2.4 Virtual Matrix</h1><p class='urlname' style='display: none'>Virtual-Matrix</p>
<p><span class="OIndex" style="display:none">Virtual Matrix</span>
Data arranged in a group of worksheet cells can be treated as a matrix and various plots such as 3D Surface, 3D Bars, and Contour can be created from such data. This feature is referred to as Virtual Matrix. The X and Y coordinate values can be optionally contained in the block of data in the first column and row, or also in a header row of the worksheet. 
</p><p>Whereas Matrix objects in Origin only support linear mapping of X and Y coordinates, a virtual matrix supports nonlinear or unevenly spaced coordinates for X and Y.
</p><p>The virtual matrix is defined when data in the worksheet is used to create a plot. The <a class="external text" href="../../XFunction/X-Function/Plotvm.html">plotvm</a> X-Function should be used to create plots.
</p><p>The following example shows how to use the plot_vm X-Function:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create a new workbook and import sample data</span>
newbook;
string fname<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Graphing\VSurface 1.dat&quot;</span>;
impasc;
<span style="color: #008000;">// Treat entire sheet as a Virtual Matrix and create a colormap surface plot</span>
plotvm irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span> format<span style="color: #000000;">:</span><span style="color: #000080;">=</span>xacross rowpos<span style="color: #000000;">:</span><span style="color: #000080;">=</span>selrow1 colpos<span style="color: #000000;">:</span><span style="color: #000080;">=</span>selcol1
 ztitle<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;VSurface 1&quot;</span> type<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">242</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>new template<span style="color: #000000;">:</span><span style="color: #000080;">=</span>cmap<span style="color: #000080;">&gt;</span>;
<span style="color: #008000;">// Change X axis scale to log</span>
layer.<span style="color: #000080;">x</span>.<span style="color: #000080;">type</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>;</pre>






