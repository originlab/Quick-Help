<h1 class="firstHeading">1 Orglab</h1><p class='urlname' style='display: none'>Orglab</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Introduction"><span class="tocnumber">1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Download"><span class="tocnumber">2</span> <span class="toctext">Download</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Installation"><span class="tocnumber">3</span> <span class="toctext">Installation</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Upgrading_from_OrgLab8"><span class="tocnumber">4</span> <span class="toctext">Upgrading from OrgLab8</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Examples"><span class="tocnumber">5</span> <span class="toctext">Examples</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#C.23"><span class="tocnumber">5.1</span> <span class="toctext">C#</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="Introduction"></a><span class="mw-headline">Introduction</span></h2>
<p>OrgLab is a freely distributable COM library for directly creating Origin project files (OPJ or OPJU). Custom applications use COM technology to communicate with OrgLab.
</p><p>While OrgLab's COM interface appears to be the same as Origin's COM interface, it is important to understand that Orglab is <i>not a replacement</i> for Origin and not all of OrgLab's COM methods and properties will behave the same as those of Origin. 
</p><p>Additionally, OrgLab and Origin/OriginPro can be installed and running on the same computer because OrgLab is not dependent upon Origin/OriginPro when creating project files.
</p><p>Finally, by downloading, using, and/or distributing OrgLab, the user agrees to the terms of the OrgLab EULA. <b>Per the Orglab EULA:</b>
</p><p><b>"...Licensee may not resell, rent, lease, distribute or otherwise use the Developer Software in any way that would compete with OriginLab's Origin and OriginPro products."</b>
</p><p>Read the <a href="../../Orglab/Orglab/Orglab_EULA.html" title="Orglab:Orglab EULA">Orglab End-User License Agreement</a> for full details.
</p>
<h2><a name="Download"></a><span class="mw-headline">Download</span></h2>
<p>Download the latest OrgLab release (OrgLab9) from  <a class="external text" href="http://originlab.com/Orglab/dl.aspx" target="_blank">OrgLab Download</a>.
</p><p>OrgLab9 is 64-bit only and is distributed in a ZIP file containing 4 files:
</p>
<ul><li> OrgLab9.dll</li>
<li> orglab9.tlb</li>
<li> OrglabEULA.txt</li>
<li> ReadMe.txt</li></ul>
<p>When distributing OrgLab, these files must be included: OrgLab9.dll, orglab9.tlb, and OrglabEULA.txt.
</p>
<h2><a name="Installation"></a><span class="mw-headline">Installation</span></h2>
<p>Before installing OrgLab, you must install the <b> 64-bit (x64) Microsoft Visual C++ Redistributable for Visual Studio 2015, 2017 and 2019</b> from this page: <b><a class="external free" href="https://support.microsoft.com/en-us/help/2977003/the-latest-supported-visual-c-downloads" target="_blank">https://support.microsoft.com/en-us/help/2977003/the-latest-supported-visual-c-downloads</a></b>. <i>Note: if Origin 2020 or later is installed in the same computer, the redistributable should already be installed.</i>
</p><p>To install OrgLab itself:
</p>
<ol><li> Copy <b>OrgLab9.dll</b>, <b>orglab9.tlb</b>, and <b>OrglabEULA.txt</b> files to the desired destination folder.</li>
<li> Run Windows Command Prompt ('cmd.exe') as Administrator.</li>
<li> <code>cd</code> to the destination folder.</li>
<li> Run this command from the Command Prompt: <code>regsvr32 "orglab9.dll"</code></li>
<li> A message box will appear letting you know the registration has succeeded.</li></ol>
<h2><a name="Upgrading_from_OrgLab8"></a><span class="mw-headline">Upgrading from OrgLab8</span></h2>
<p>If you are upgrading from OrgLab8 to OrgLab9, you will have to modify your custom application and recompile it.
</p><p>For C++ projects, the following change must be made.
</p><p>Change this:
</p>
<pre class="oc" style="font-family:monospace;">CLSIDFromProgID<span style="color: #000000;">&#40;</span>L<span style="color: #ff00ff;">&quot;OrgLab8.Application&quot;</span>, <span style="color: #000040;">&amp;</span>clsid<span style="color: #000000;">&#41;</span>;</pre>
<p>To this:
</p>
<pre class="oc" style="font-family:monospace;">CLSIDFromProgID<span style="color: #000000;">&#40;</span>L<span style="color: #ff00ff;">&quot;OrgLab9.Application&quot;</span>, <span style="color: #000040;">&amp;</span>clsid<span style="color: #000000;">&#41;</span>;</pre>
<p>For C# and Visual Basic, the following change must be made.
</p><p>Change the OrgLab Type Library Reference from this:
</p>
<pre class="oc" style="font-family:monospace;">OriginLab Orglab8 Type Library;</pre>
<p>To this:
</p>
<pre class="oc" style="font-family:monospace;">OriginLab Type Library</pre>
<p><i>Note that version information is missing from the Type Library Reference. This is due to a defect in type library generation but it does not impact performance.</i>
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p>The following examples demonstrate uses for OrgLab.
</p><p>For more examples of communicating with OrgLab, please refer to the  <a class="external text" href="../../AutomationServer/Category/Origin_COM_Examples_(OriginCOM).html">Origin COM Examples</a>.
</p><p>A popular example demonstrates how to read and write an OGW file:
<a class="external text" href="../../AutomationServer/OriginCOM/Accessing_OGW.html">Accessing OGW</a>
</p>
<h3><a name="C.23"></a><span class="mw-headline">C#</span></h3>
<p><b>EX1</b>
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #008080; font-style: italic;">// Be sure to add 'OriginLab Type Library` (which is OrgLab9) to your project's References</span>
<span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">Origin</span><span style="color: #008000;">;</span>

<span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #6666cc; font-weight: bold;">void</span> Main<span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#91;</span><span style="color: #008000;">&#93;</span> args<span style="color: #008000;">&#41;</span>
<span style="color: #008000;">&#123;</span>
	<span style="color: #6666cc; font-weight: bold;">object</span> <span style="color: #0600FF; font-weight: bold;">Default</span> <span style="color: #008000;">=</span> <span style="color: #000000;">System</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Type</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Missing</span><span style="color: #008000;">;</span>

	Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">Application</span> originApp <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">Application</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>

	originApp<span style="color: #008000;">.</span><span style="color: #0000FF;">NewProject</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>

	<span style="color: #6666cc; font-weight: bold;">string</span> strPageName <span style="color: #008000;">=</span> originApp<span style="color: #008000;">.</span><span style="color: #0000FF;">CreatePage</span>
                     <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">int</span><span style="color: #008000;">&#41;</span>Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">PAGETYPES</span><span style="color: #008000;">.</span><span style="color: #0000FF;">OPT_WORKSHEET</span>, <span style="color: #0600FF; font-weight: bold;">Default</span>, <span style="color: #666666;">&quot;&quot;</span>, <span style="color: #FF0000;">2</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>

	originApp<span style="color: #008000;">.</span><span style="color: #0000FF;">Save</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;C:<span style="color: #008080; font-weight: bold;">\\</span>CreatedProject1.opj&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>   <span style="color: #008080; font-style: italic;">// Save as old opj format</span>
        originApp<span style="color: #008000;">.</span><span style="color: #0000FF;">Save</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;C:<span style="color: #008080; font-weight: bold;">\\</span>CreatedProject2.opju&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>  <span style="color: #008080; font-style: italic;">// Save as new opju format</span>

	originApp<span style="color: #008000;">.</span><span style="color: #0000FF;">Exit</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
<span style="color: #008000;">&#125;</span></pre>
<p><b>EX2</b>
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #008080; font-style: italic;">// Create, Save, and Load Project</span>
<span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #6666cc; font-weight: bold;">void</span> Main<span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#91;</span><span style="color: #008000;">&#93;</span> args<span style="color: #008000;">&#41;</span>
<span style="color: #008000;">&#123;</span>
    Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">Application</span> oApp <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">Application</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
 
    <span style="color: #008080; font-style: italic;">// Create and Save a Project with Only One Workbook</span>
    oApp<span style="color: #008000;">.</span><span style="color: #0000FF;">NewProject</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    oApp<span style="color: #008000;">.</span><span style="color: #0000FF;">CreatePage</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">int</span><span style="color: #008000;">&#41;</span>Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">PAGETYPES</span><span style="color: #008000;">.</span><span style="color: #0000FF;">OPT_WORKSHEET</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    oApp<span style="color: #008000;">.</span><span style="color: #0000FF;">Save</span><span style="color: #008000;">&#40;</span><span style="color: #000000;">System.<span style="color: #0000FF;">IO</span></span><span style="color: #008000;">.</span><span style="color: #0000FF;">Directory</span><span style="color: #008000;">.</span><span style="color: #0000FF;">GetCurrentDirectory</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">+</span> <span style="color: #666666;">@&quot;\OneWorkbook.opj&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
 
    <span style="color: #008080; font-style: italic;">// Load a Project, Add a Workbook, and Save As Another Project</span>
    oApp<span style="color: #008000;">.</span><span style="color: #0000FF;">NewProject</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    oApp<span style="color: #008000;">.</span><span style="color: #0000FF;">Load</span><span style="color: #008000;">&#40;</span><span style="color: #000000;">System.<span style="color: #0000FF;">IO</span></span><span style="color: #008000;">.</span><span style="color: #0000FF;">Directory</span><span style="color: #008000;">.</span><span style="color: #0000FF;">GetCurrentDirectory</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">+</span> <span style="color: #666666;">@&quot;\OneWorkbook.opj&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    oApp<span style="color: #008000;">.</span><span style="color: #0000FF;">CreatePage</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">int</span><span style="color: #008000;">&#41;</span>Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">PAGETYPES</span><span style="color: #008000;">.</span><span style="color: #0000FF;">OPT_WORKSHEET</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    oApp<span style="color: #008000;">.</span><span style="color: #0000FF;">Save</span><span style="color: #008000;">&#40;</span><span style="color: #000000;">System.<span style="color: #0000FF;">IO</span></span><span style="color: #008000;">.</span><span style="color: #0000FF;">Directory</span><span style="color: #008000;">.</span><span style="color: #0000FF;">GetCurrentDirectory</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">+</span> <span style="color: #666666;">@&quot;\TwoWorkbooks.opj&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
 
    oApp<span style="color: #008000;">.</span><span style="color: #0000FF;">Exit</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
<span style="color: #008000;">&#125;</span></pre>
<p><b>EX3</b>
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #008080; font-style: italic;">// Create Worksheet and Send Data to It</span>
<span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #6666cc; font-weight: bold;">void</span> Main<span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#91;</span><span style="color: #008000;">&#93;</span> args<span style="color: #008000;">&#41;</span>
<span style="color: #008000;">&#123;</span>
    <span style="color: #008080; font-style: italic;">// New Origin Project</span>
    Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">Application</span> oApp <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">Application</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    oApp<span style="color: #008000;">.</span><span style="color: #0000FF;">NewProject</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
 
    <span style="color: #008080; font-style: italic;">// Two Columns of Data: y = sin(x), x in [0, 10.0]</span>
    <span style="color: #6666cc; font-weight: bold;">double</span><span style="color: #008000;">&#91;</span>,<span style="color: #008000;">&#93;</span> data <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> <span style="color: #6666cc; font-weight: bold;">double</span><span style="color: #008000;">&#91;</span><span style="color: #FF0000;">101</span>, <span style="color: #FF0000;">2</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">;</span>
    <span style="color: #0600FF; font-weight: bold;">for</span> <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">int</span> i <span style="color: #008000;">=</span> <span style="color: #FF0000;">0</span><span style="color: #008000;">;</span> i <span style="color: #008000;">&lt;=</span> <span style="color: #FF0000;">100</span><span style="color: #008000;">;</span> i<span style="color: #008000;">++</span><span style="color: #008000;">&#41;</span>
    <span style="color: #008000;">&#123;</span>
        data<span style="color: #008000;">&#91;</span>i, <span style="color: #FF0000;">0</span><span style="color: #008000;">&#93;</span> <span style="color: #008000;">=</span> i <span style="color: #008000;">/</span> <span style="color: #FF0000;">10.0</span><span style="color: #008000;">;</span>
        data<span style="color: #008000;">&#91;</span>i, <span style="color: #FF0000;">1</span><span style="color: #008000;">&#93;</span> <span style="color: #008000;">=</span> Math<span style="color: #008000;">.</span><span style="color: #0000FF;">Sin</span><span style="color: #008000;">&#40;</span>data<span style="color: #008000;">&#91;</span>i, <span style="color: #FF0000;">0</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    <span style="color: #008000;">&#125;</span>
 
    <span style="color: #008080; font-style: italic;">// Create Worksheet</span>
    <span style="color: #6666cc; font-weight: bold;">string</span> wpname<span style="color: #008000;">;</span>
    wpname <span style="color: #008000;">=</span> oApp<span style="color: #008000;">.</span><span style="color: #0000FF;">CreatePage</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">int</span><span style="color: #008000;">&#41;</span>Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">PAGETYPES</span><span style="color: #008000;">.</span><span style="color: #0000FF;">OPT_WORKSHEET</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">Worksheet</span> wks <span style="color: #008000;">=</span> oApp<span style="color: #008000;">.</span><span style="color: #0000FF;">FindWorksheet</span><span style="color: #008000;">&#40;</span>wpname<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
 
    <span style="color: #008080; font-style: italic;">// Send Data to Worksheet</span>
    wks<span style="color: #008000;">.</span><span style="color: #0000FF;">SetData</span><span style="color: #008000;">&#40;</span>data<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
 
    <span style="color: #008080; font-style: italic;">// Set First Column as X</span>
    wks<span style="color: #008000;">.</span><span style="color: #0000FF;">Columns</span><span style="color: #008000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Type</span> <span style="color: #008000;">=</span> Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">COLTYPES</span><span style="color: #008000;">.</span><span style="color: #0000FF;">COLTYPE_X</span><span style="color: #008000;">;</span>
 
    <span style="color: #008080; font-style: italic;">//Save As .OPJ File and Exit</span>
    oApp<span style="color: #008000;">.</span><span style="color: #0000FF;">Save</span><span style="color: #008000;">&#40;</span><span style="color: #000000;">System.<span style="color: #0000FF;">IO</span></span><span style="color: #008000;">.</span><span style="color: #0000FF;">Directory</span><span style="color: #008000;">.</span><span style="color: #0000FF;">GetCurrentDirectory</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">+</span> <span style="color: #666666;">@&quot;\SendDataToNewWorksheet.opj&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    oApp<span style="color: #008000;">.</span><span style="color: #0000FF;">Exit</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
<span style="color: #008000;">&#125;</span></pre>
<p><b>EX4</b>
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #008080; font-style: italic;">// Create Matrix Page and Send Data to It</span>
<span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #6666cc; font-weight: bold;">void</span> Main<span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#91;</span><span style="color: #008000;">&#93;</span> args<span style="color: #008000;">&#41;</span>
<span style="color: #008000;">&#123;</span>
    Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">Application</span> oApp <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">Application</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    oApp<span style="color: #008000;">.</span><span style="color: #0000FF;">NewProject</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    <span style="color: #6666cc; font-weight: bold;">double</span><span style="color: #008000;">&#91;</span>,<span style="color: #008000;">&#93;</span> data <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> <span style="color: #6666cc; font-weight: bold;">double</span><span style="color: #008000;">&#91;</span><span style="color: #FF0000;">100</span>, <span style="color: #FF0000;">100</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">;</span>
    <span style="color: #0600FF; font-weight: bold;">for</span> <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">int</span> i <span style="color: #008000;">=</span> <span style="color: #FF0000;">0</span><span style="color: #008000;">;</span> i <span style="color: #008000;">&lt;</span> <span style="color: #FF0000;">100</span><span style="color: #008000;">;</span> i<span style="color: #008000;">++</span><span style="color: #008000;">&#41;</span>
        <span style="color: #0600FF; font-weight: bold;">for</span> <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">int</span> j <span style="color: #008000;">=</span> <span style="color: #FF0000;">0</span><span style="color: #008000;">;</span> j <span style="color: #008000;">&lt;</span> <span style="color: #FF0000;">100</span><span style="color: #008000;">;</span> j<span style="color: #008000;">++</span><span style="color: #008000;">&#41;</span>
            data<span style="color: #008000;">&#91;</span>i, j<span style="color: #008000;">&#93;</span> <span style="color: #008000;">=</span> i <span style="color: #008000;">*</span> j<span style="color: #008000;">;</span>
 
    <span style="color: #008080; font-style: italic;">// Create Matrix Page</span>
    <span style="color: #6666cc; font-weight: bold;">string</span> mpname <span style="color: #008000;">=</span> oApp<span style="color: #008000;">.</span><span style="color: #0000FF;">CreatePage</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">int</span><span style="color: #008000;">&#41;</span>Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">PAGETYPES</span><span style="color: #008000;">.</span><span style="color: #0000FF;">OPT_MATRIX</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">MatrixPage</span> mp <span style="color: #008000;">=</span> oApp<span style="color: #008000;">.</span><span style="color: #0000FF;">FindMatrixSheet</span><span style="color: #008000;">&#40;</span>mpname<span style="color: #008000;">&#41;</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Parent</span><span style="color: #008000;">;</span>
 
    <span style="color: #008080; font-style: italic;">// Number of Matrix Sheets: 3</span>
    <span style="color: #0600FF; font-weight: bold;">while</span> <span style="color: #008000;">&#40;</span>mp<span style="color: #008000;">.</span><span style="color: #0000FF;">Layers</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Count</span> <span style="color: #008000;">&lt;</span> <span style="color: #FF0000;">3</span><span style="color: #008000;">&#41;</span>
        mp<span style="color: #008000;">.</span><span style="color: #0000FF;">Layers</span><span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
 
    <span style="color: #0600FF; font-weight: bold;">foreach</span> <span style="color: #008000;">&#40;</span>Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">MatrixSheet</span> msht <span style="color: #0600FF; font-weight: bold;">in</span> mp<span style="color: #008000;">.</span><span style="color: #0000FF;">Layers</span><span style="color: #008000;">&#41;</span>
    <span style="color: #008000;">&#123;</span>
        msht<span style="color: #008000;">.</span><span style="color: #0000FF;">Name</span> <span style="color: #008000;">=</span> <span style="color: #666666;">&quot;MSheet&quot;</span> <span style="color: #008000;">+</span> msht<span style="color: #008000;">.</span><span style="color: #0000FF;">Index</span><span style="color: #008000;">.</span><span style="color: #0000FF;">ToString</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
 
        <span style="color: #008080; font-style: italic;">// Number of Matrix Object per Matrix Sheet: 4</span>
        msht<span style="color: #008000;">.</span><span style="color: #0000FF;">Mats</span> <span style="color: #008000;">=</span> <span style="color: #FF0000;">4</span><span style="color: #008000;">;</span>
 
        <span style="color: #008080; font-style: italic;">// Dimension: 100x100</span>
        msht<span style="color: #008000;">.</span><span style="color: #0000FF;">Cols</span> <span style="color: #008000;">=</span> <span style="color: #FF0000;">100</span><span style="color: #008000;">;</span>
        msht<span style="color: #008000;">.</span><span style="color: #0000FF;">Rows</span> <span style="color: #008000;">=</span> <span style="color: #FF0000;">100</span><span style="color: #008000;">;</span>
 
        <span style="color: #008080; font-style: italic;">// Send Data to Matrix Object</span>
        <span style="color: #0600FF; font-weight: bold;">foreach</span> <span style="color: #008000;">&#40;</span>Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">MatrixObject</span> mo <span style="color: #0600FF; font-weight: bold;">in</span> msht<span style="color: #008000;">.</span><span style="color: #0000FF;">MatrixObjects</span><span style="color: #008000;">&#41;</span>
            mo<span style="color: #008000;">.</span><span style="color: #0000FF;">SetData</span><span style="color: #008000;">&#40;</span>data<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    <span style="color: #008000;">&#125;</span>
 
    oApp<span style="color: #008000;">.</span><span style="color: #0000FF;">Save</span><span style="color: #008000;">&#40;</span><span style="color: #000000;">System.<span style="color: #0000FF;">IO</span></span><span style="color: #008000;">.</span><span style="color: #0000FF;">Directory</span><span style="color: #008000;">.</span><span style="color: #0000FF;">GetCurrentDirectory</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">+</span> <span style="color: #666666;">@&quot;\MatrixPage.opj&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    oApp<span style="color: #008000;">.</span><span style="color: #0000FF;">Exit</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
<span style="color: #008000;">&#125;</span></pre>
<p><b>EX5</b>
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #008080; font-style: italic;">// Get Data From Worksheet, Column, and Matrix Object</span>

<span style="color: #008080; font-style: italic;">// Suppose that there are at least two sheets in Book1,</span>
<span style="color: #008080; font-style: italic;">// and at least one matrix object in [MBook1]MSheet1!.</span>
<span style="color: #008080; font-style: italic;">// Assume there is no graph page with data plot existing </span>
<span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #6666cc; font-weight: bold;">void</span> Main<span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#91;</span><span style="color: #008000;">&#93;</span> args<span style="color: #008000;">&#41;</span>
<span style="color: #008000;">&#123;</span>
    Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">Application</span> oApp <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">Application</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
 
    <span style="color: #008080; font-style: italic;">// Make sure no graph page with data plot exists before loading opj</span>
    oApp<span style="color: #008000;">.</span><span style="color: #0000FF;">Load</span><span style="color: #008000;">&#40;</span><span style="color: #000000;">System.<span style="color: #0000FF;">IO</span></span><span style="color: #008000;">.</span><span style="color: #0000FF;">Directory</span><span style="color: #008000;">.</span><span style="color: #0000FF;">GetCurrentDirectory</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">+</span> <span style="color: #666666;">@&quot;\GetDataFromOPJ.opj&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
     
    <span style="color: #008080; font-style: italic;">// Current Layer of Book1 or MBook1</span>
    Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">Worksheet</span> wks <span style="color: #008000;">=</span> oApp<span style="color: #008000;">.</span><span style="color: #0000FF;">FindWorksheet</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;Book1&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">MatrixSheet</span> msht <span style="color: #008000;">=</span> oApp<span style="color: #008000;">.</span><span style="color: #0000FF;">FindMatrixSheet</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;MBook1&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
     
    <span style="color: #008080; font-style: italic;">// Data in [Book1]1</span>
    <span style="color: #6666cc; font-weight: bold;">object</span> wksData <span style="color: #008000;">=</span> wks<span style="color: #008000;">.</span><span style="color: #0000FF;">Parent</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Layers</span><span style="color: #008000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">.</span><span style="color: #0000FF;">GetData</span><span style="color: #008000;">&#40;</span><span style="color: #FF0000;">0</span>, <span style="color: #FF0000;">0</span>, <span style="color: #008000;">-</span><span style="color: #FF0000;">1</span>, <span style="color: #008000;">-</span><span style="color: #FF0000;">1</span>, Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">ARRAYDATAFORMAT</span><span style="color: #008000;">.</span><span style="color: #0000FF;">ARRAY1D_NUMERIC</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
     
    <span style="color: #008080; font-style: italic;">// Data in [Book1]2!1</span>
    <span style="color: #6666cc; font-weight: bold;">object</span> colData <span style="color: #008000;">=</span> wks<span style="color: #008000;">.</span><span style="color: #0000FF;">Parent</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Layers</span><span style="color: #008000;">&#91;</span><span style="color: #FF0000;">1</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Columns</span><span style="color: #008000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">.</span><span style="color: #0000FF;">GetData</span><span style="color: #008000;">&#40;</span>Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">ARRAYDATAFORMAT</span><span style="color: #008000;">.</span><span style="color: #0000FF;">ARRAY1D_STR</span>, <span style="color: #FF0000;">0</span>, <span style="color: #008000;">-</span><span style="color: #FF0000;">1</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
     
    <span style="color: #008080; font-style: italic;">// Data in [MBook1]1!1</span>
    <span style="color: #6666cc; font-weight: bold;">object</span> moData <span style="color: #008000;">=</span> msht<span style="color: #008000;">.</span><span style="color: #0000FF;">MatrixObjects</span><span style="color: #008000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">.</span><span style="color: #0000FF;">GetData</span><span style="color: #008000;">&#40;</span><span style="color: #FF0000;">0</span>, <span style="color: #FF0000;">0</span>, <span style="color: #008000;">-</span><span style="color: #FF0000;">1</span>, <span style="color: #008000;">-</span><span style="color: #FF0000;">1</span>, Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">ARRAYDATAFORMAT</span><span style="color: #008000;">.</span><span style="color: #0000FF;">ARRAY2D_NUMERIC</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
 
    oApp<span style="color: #008000;">.</span><span style="color: #0000FF;">Exit</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
<span style="color: #008000;">&#125;</span></pre>
<p><b>EX6</b>
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #008080; font-style: italic;">// Custom Column Label Row</span>
<span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #6666cc; font-weight: bold;">void</span> Main<span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#91;</span><span style="color: #008000;">&#93;</span> args<span style="color: #008000;">&#41;</span>
<span style="color: #008000;">&#123;</span>
    Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">Application</span> oApp <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">Application</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    oApp<span style="color: #008000;">.</span><span style="color: #0000FF;">NewProject</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
 
    <span style="color: #008080; font-style: italic;">// 1. Create Worksheet</span>
    Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">Worksheet</span> wks<span style="color: #008000;">;</span>
    <span style="color: #6666cc; font-weight: bold;">string</span> wksName <span style="color: #008000;">=</span> oApp<span style="color: #008000;">.</span><span style="color: #0000FF;">CreatePage</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">int</span><span style="color: #008000;">&#41;</span>Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">PAGETYPES</span><span style="color: #008000;">.</span><span style="color: #0000FF;">OPT_WORKSHEET</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    wks <span style="color: #008000;">=</span> oApp<span style="color: #008000;">.</span><span style="color: #0000FF;">FindWorksheet</span><span style="color: #008000;">&#40;</span>wksName<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    wks<span style="color: #008000;">.</span><span style="color: #0000FF;">Cols</span> <span style="color: #008000;">=</span> <span style="color: #FF0000;">1</span><span style="color: #008000;">;</span>
    wks<span style="color: #008000;">.</span><span style="color: #0000FF;">Rows</span> <span style="color: #008000;">=</span> <span style="color: #FF0000;">32</span><span style="color: #008000;">;</span>
 
    <span style="color: #008080; font-style: italic;">// 2. Show Label Rows: 'Long Name', 'Units', 'Comments', 'Sample Rate', and 2 'Parameters'</span>
    wks<span style="color: #008000;">.</span><span style="color: #0000FF;">set_LabelVisible</span><span style="color: #008000;">&#40;</span>Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">LABELTYPEVALS</span><span style="color: #008000;">.</span><span style="color: #0000FF;">LT_LONG_NAME</span>, <span style="color: #0600FF; font-weight: bold;">true</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    wks<span style="color: #008000;">.</span><span style="color: #0000FF;">set_LabelVisible</span><span style="color: #008000;">&#40;</span>Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">LABELTYPEVALS</span><span style="color: #008000;">.</span><span style="color: #0000FF;">LT_UNIT</span>, <span style="color: #0600FF; font-weight: bold;">true</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    wks<span style="color: #008000;">.</span><span style="color: #0000FF;">set_LabelVisible</span><span style="color: #008000;">&#40;</span>Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">LABELTYPEVALS</span><span style="color: #008000;">.</span><span style="color: #0000FF;">LT_COMMENT</span>, <span style="color: #0600FF; font-weight: bold;">true</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    wks<span style="color: #008000;">.</span><span style="color: #0000FF;">set_LabelVisible</span><span style="color: #008000;">&#40;</span>Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">LABELTYPEVALS</span><span style="color: #008000;">.</span><span style="color: #0000FF;">LT_SAMPLE_RATE</span>, <span style="color: #0600FF; font-weight: bold;">true</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    wks<span style="color: #008000;">.</span><span style="color: #0000FF;">set_LabelVisible</span><span style="color: #008000;">&#40;</span>Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">LABELTYPEVALS</span><span style="color: #008000;">.</span><span style="color: #0000FF;">LT_PARAM</span>, <span style="color: #0600FF; font-weight: bold;">true</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    wks<span style="color: #008000;">.</span><span style="color: #0000FF;">set_LabelVisible</span><span style="color: #008000;">&#40;</span>Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">LABELTYPEVALS</span><span style="color: #008000;">.</span><span style="color: #0000FF;">LT_PARAM</span> <span style="color: #008000;">+</span> <span style="color: #FF0000;">1</span>, <span style="color: #0600FF; font-weight: bold;">true</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
 
    <span style="color: #008080; font-style: italic;">// 3. Set Label Rows</span>
    wks<span style="color: #008000;">.</span><span style="color: #0000FF;">Columns</span><span style="color: #008000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">.</span><span style="color: #0000FF;">LongName</span> <span style="color: #008000;">=</span> <span style="color: #666666;">&quot;Long Name&quot;</span><span style="color: #008000;">;</span>
    wks<span style="color: #008000;">.</span><span style="color: #0000FF;">Columns</span><span style="color: #008000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Units</span> <span style="color: #008000;">=</span> <span style="color: #666666;">&quot;Units&quot;</span><span style="color: #008000;">;</span>
    wks<span style="color: #008000;">.</span><span style="color: #0000FF;">Columns</span><span style="color: #008000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Comments</span> <span style="color: #008000;">=</span> <span style="color: #666666;">&quot;Comments&quot;</span><span style="color: #008000;">;</span>
    wks<span style="color: #008000;">.</span><span style="color: #0000FF;">Columns</span><span style="color: #008000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Parameter</span><span style="color: #008000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #008000;">&#93;</span> <span style="color: #008000;">=</span> <span style="color: #666666;">&quot;Parameter 1&quot;</span><span style="color: #008000;">;</span>
    wks<span style="color: #008000;">.</span><span style="color: #0000FF;">Columns</span><span style="color: #008000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Parameter</span><span style="color: #008000;">&#91;</span><span style="color: #FF0000;">1</span><span style="color: #008000;">&#93;</span> <span style="color: #008000;">=</span> <span style="color: #666666;">&quot;Parameter 2&quot;</span><span style="color: #008000;">;</span>
 
    <span style="color: #008080; font-style: italic;">// 4. Even Sampling</span>
    wks<span style="color: #008000;">.</span><span style="color: #0000FF;">Columns</span><span style="color: #008000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">.</span><span style="color: #0000FF;">SetEvenSampling</span><span style="color: #008000;">&#40;</span><span style="color: #FF0000;">0.0</span>, <span style="color: #FF0000;">0.1</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
 
    <span style="color: #008080; font-style: italic;">// 5. Data</span>
    <span style="color: #6666cc; font-weight: bold;">double</span><span style="color: #008000;">&#91;</span><span style="color: #008000;">&#93;</span> data <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> <span style="color: #6666cc; font-weight: bold;">double</span><span style="color: #008000;">&#91;</span><span style="color: #FF0000;">32</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">;</span>
    <span style="color: #0600FF; font-weight: bold;">for</span> <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">int</span> i <span style="color: #008000;">=</span> <span style="color: #FF0000;">0</span><span style="color: #008000;">;</span> i <span style="color: #008000;">&lt;</span> <span style="color: #FF0000;">32</span><span style="color: #008000;">;</span> i<span style="color: #008000;">++</span><span style="color: #008000;">&#41;</span>
        data<span style="color: #008000;">&#91;</span>i<span style="color: #008000;">&#93;</span> <span style="color: #008000;">=</span> i <span style="color: #008000;">/</span> <span style="color: #FF0000;">5.0</span><span style="color: #008000;">;</span>
    wks<span style="color: #008000;">.</span><span style="color: #0000FF;">Columns</span><span style="color: #008000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">.</span><span style="color: #0000FF;">SetData</span><span style="color: #008000;">&#40;</span>data<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
 
    oApp<span style="color: #008000;">.</span><span style="color: #0000FF;">Save</span><span style="color: #008000;">&#40;</span><span style="color: #000000;">System.<span style="color: #0000FF;">IO</span></span><span style="color: #008000;">.</span><span style="color: #0000FF;">Directory</span><span style="color: #008000;">.</span><span style="color: #0000FF;">GetCurrentDirectory</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">+</span> <span style="color: #666666;">@&quot;\ColumLabelRows.opj&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    oApp<span style="color: #008000;">.</span><span style="color: #0000FF;">Exit</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
<span style="color: #008000;">&#125;</span></pre>
<p><b>EX7</b>
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #008080; font-style: italic;">// Custom Column Display Format</span>
<span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #6666cc; font-weight: bold;">void</span> Main<span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#91;</span><span style="color: #008000;">&#93;</span> args<span style="color: #008000;">&#41;</span>
<span style="color: #008000;">&#123;</span>
    Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">Application</span> oApp <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">Application</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    oApp<span style="color: #008000;">.</span><span style="color: #0000FF;">NewProject</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
 
    <span style="color: #6666cc; font-weight: bold;">double</span><span style="color: #008000;">&#91;</span>,<span style="color: #008000;">&#93;</span> data <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> <span style="color: #6666cc; font-weight: bold;">double</span><span style="color: #008000;">&#91;</span><span style="color: #FF0000;">32</span>, <span style="color: #FF0000;">3</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">;</span>
    <span style="color: #0600FF; font-weight: bold;">for</span> <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">int</span> i <span style="color: #008000;">=</span> <span style="color: #FF0000;">0</span><span style="color: #008000;">;</span> i <span style="color: #008000;">&lt;</span> <span style="color: #FF0000;">32</span><span style="color: #008000;">;</span> i<span style="color: #008000;">++</span><span style="color: #008000;">&#41;</span>
    <span style="color: #008000;">&#123;</span>
        data<span style="color: #008000;">&#91;</span>i, <span style="color: #FF0000;">0</span><span style="color: #008000;">&#93;</span> <span style="color: #008000;">=</span> i <span style="color: #008000;">/</span> <span style="color: #FF0000;">10.0</span><span style="color: #008000;">;</span>
        data<span style="color: #008000;">&#91;</span>i, <span style="color: #FF0000;">1</span><span style="color: #008000;">&#93;</span> <span style="color: #008000;">=</span> Math<span style="color: #008000;">.</span><span style="color: #0000FF;">Cos</span><span style="color: #008000;">&#40;</span>i <span style="color: #008000;">/</span> <span style="color: #FF0000;">10.0</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
        data<span style="color: #008000;">&#91;</span>i, <span style="color: #FF0000;">2</span><span style="color: #008000;">&#93;</span> <span style="color: #008000;">=</span> Math<span style="color: #008000;">.</span><span style="color: #0000FF;">Sin</span><span style="color: #008000;">&#40;</span>i <span style="color: #008000;">/</span> <span style="color: #FF0000;">10.0</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    <span style="color: #008000;">&#125;</span>
 
    <span style="color: #6666cc; font-weight: bold;">string</span> wpname <span style="color: #008000;">=</span> oApp<span style="color: #008000;">.</span><span style="color: #0000FF;">CreatePage</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">int</span><span style="color: #008000;">&#41;</span>Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">PAGETYPES</span><span style="color: #008000;">.</span><span style="color: #0000FF;">OPT_WORKSHEET</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">Worksheet</span> wks <span style="color: #008000;">=</span> oApp<span style="color: #008000;">.</span><span style="color: #0000FF;">FindWorksheet</span><span style="color: #008000;">&#40;</span>wpname<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    wks<span style="color: #008000;">.</span><span style="color: #0000FF;">SetData</span><span style="color: #008000;">&#40;</span>data<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
 
    <span style="color: #008080; font-style: italic;">// Display: Scientific 1E3</span>
    wks<span style="color: #008000;">.</span><span style="color: #0000FF;">Columns</span><span style="color: #008000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">.</span><span style="color: #0000FF;">DisplayFormat</span> <span style="color: #008000;">=</span> <span style="color: #FF0000;">1</span><span style="color: #008000;">;</span>
 
    <span style="color: #008080; font-style: italic;">// Digits: Set Decimal Places = 6</span>
    wks<span style="color: #008000;">.</span><span style="color: #0000FF;">Columns</span><span style="color: #008000;">&#91;</span><span style="color: #FF0000;">1</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">.</span><span style="color: #0000FF;">DigitMode</span> <span style="color: #008000;">=</span> Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">DIGITMOD</span><span style="color: #008000;">.</span><span style="color: #0000FF;">DIGITMODE_DECIMAL_DIGITS</span><span style="color: #008000;">;</span>
    wks<span style="color: #008000;">.</span><span style="color: #0000FF;">Columns</span><span style="color: #008000;">&#91;</span><span style="color: #FF0000;">1</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Digits</span> <span style="color: #008000;">=</span> <span style="color: #FF0000;">6</span><span style="color: #008000;">;</span>
 
    <span style="color: #008080; font-style: italic;">// Digits: Significant Digits = 6</span>
    wks<span style="color: #008000;">.</span><span style="color: #0000FF;">Columns</span><span style="color: #008000;">&#91;</span><span style="color: #FF0000;">2</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">.</span><span style="color: #0000FF;">DigitMode</span> <span style="color: #008000;">=</span> Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">DIGITMOD</span><span style="color: #008000;">.</span><span style="color: #0000FF;">DIGITMODE_SIGNIFICANT_DIGITS</span><span style="color: #008000;">;</span>
    wks<span style="color: #008000;">.</span><span style="color: #0000FF;">Columns</span><span style="color: #008000;">&#91;</span><span style="color: #FF0000;">2</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Digits</span> <span style="color: #008000;">=</span> <span style="color: #FF0000;">6</span><span style="color: #008000;">;</span>
 
    oApp<span style="color: #008000;">.</span><span style="color: #0000FF;">Save</span><span style="color: #008000;">&#40;</span><span style="color: #000000;">System.<span style="color: #0000FF;">IO</span></span><span style="color: #008000;">.</span><span style="color: #0000FF;">Directory</span><span style="color: #008000;">.</span><span style="color: #0000FF;">GetCurrentDirectory</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">+</span> <span style="color: #666666;">@&quot;\NumericFormat.opj&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    oApp<span style="color: #008000;">.</span><span style="color: #0000FF;">Exit</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
<span style="color: #008000;">&#125;</span></pre>
<p><b>EX8</b>
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #008080; font-style: italic;">// Meta Data in Organizer of Workbook</span>
<span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">System.Xml</span><span style="color: #008000;">;</span>

<span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #6666cc; font-weight: bold;">void</span> Main<span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#91;</span><span style="color: #008000;">&#93;</span> args<span style="color: #008000;">&#41;</span>
<span style="color: #008000;">&#123;</span>
    Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">Application</span> oApp <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">Application</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    oApp<span style="color: #008000;">.</span><span style="color: #0000FF;">NewProject</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
 
    <span style="color: #008080; font-style: italic;">// Meta Data</span>
    XmlDocument xmlDoc <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> XmlDocument<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    XmlNode Node<span style="color: #008000;">;</span>
    XmlElement topXML, Element<span style="color: #008000;">;</span>
    topXML <span style="color: #008000;">=</span> xmlDoc<span style="color: #008000;">.</span><span style="color: #0000FF;">CreateElement</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;data&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    Node <span style="color: #008000;">=</span> xmlDoc<span style="color: #008000;">.</span><span style="color: #0000FF;">AppendChild</span><span style="color: #008000;">&#40;</span>topXML<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    Node <span style="color: #008000;">=</span> Node<span style="color: #008000;">.</span><span style="color: #0000FF;">AppendChild</span><span style="color: #008000;">&#40;</span>xmlDoc<span style="color: #008000;">.</span><span style="color: #0000FF;">CreateElement</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;Instrument&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    Element <span style="color: #008000;">=</span> xmlDoc<span style="color: #008000;">.</span><span style="color: #0000FF;">CreateElement</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;SerialNumber&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    Element<span style="color: #008000;">.</span><span style="color: #0000FF;">InnerText</span> <span style="color: #008000;">=</span> <span style="color: #666666;">&quot;EQR-23456&quot;</span><span style="color: #008000;">;</span>
    Node <span style="color: #008000;">=</span> Node<span style="color: #008000;">.</span><span style="color: #0000FF;">AppendChild</span><span style="color: #008000;">&#40;</span>Element<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    Element <span style="color: #008000;">=</span> xmlDoc<span style="color: #008000;">.</span><span style="color: #0000FF;">CreateElement</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;UsageCount&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    Element<span style="color: #008000;">.</span><span style="color: #0000FF;">InnerText</span> <span style="color: #008000;">=</span> <span style="color: #666666;">&quot;2345&quot;</span><span style="color: #008000;">;</span>
    Node <span style="color: #008000;">=</span> Node<span style="color: #008000;">.</span><span style="color: #0000FF;">ParentNode</span><span style="color: #008000;">.</span><span style="color: #0000FF;">AppendChild</span><span style="color: #008000;">&#40;</span>Element<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
 
    <span style="color: #6666cc; font-weight: bold;">string</span> strXML <span style="color: #008000;">=</span> topXML<span style="color: #008000;">.</span><span style="color: #0000FF;">OuterXml</span><span style="color: #008000;">;</span>
 
    <span style="color: #008080; font-style: italic;">// Meta Data in a Workbook</span>
    <span style="color: #6666cc; font-weight: bold;">string</span> wpname <span style="color: #008000;">=</span> oApp<span style="color: #008000;">.</span><span style="color: #0000FF;">CreatePage</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">int</span><span style="color: #008000;">&#41;</span>Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">PAGETYPES</span><span style="color: #008000;">.</span><span style="color: #0000FF;">OPT_WORKSHEET</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    Origin<span style="color: #008000;">.</span><span style="color: #0000FF;">Worksheet</span> wks <span style="color: #008000;">=</span> oApp<span style="color: #008000;">.</span><span style="color: #0000FF;">FindWorksheet</span><span style="color: #008000;">&#40;</span>wpname<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    wks<span style="color: #008000;">.</span><span style="color: #0000FF;">SetMetaData</span><span style="color: #008000;">&#40;</span>strXML, <span style="color: #666666;">&quot;MetaData&quot;</span>, <span style="color: #0600FF; font-weight: bold;">true</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
 
    oApp<span style="color: #008000;">.</span><span style="color: #0000FF;">Save</span><span style="color: #008000;">&#40;</span><span style="color: #000000;">System.<span style="color: #0000FF;">IO</span></span><span style="color: #008000;">.</span><span style="color: #0000FF;">Directory</span><span style="color: #008000;">.</span><span style="color: #0000FF;">GetCurrentDirectory</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">+</span> <span style="color: #666666;">@&quot;\MetaData.opj&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    oApp<span style="color: #008000;">.</span><span style="color: #0000FF;">Exit</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
<span style="color: #008000;">&#125;</span></pre>






