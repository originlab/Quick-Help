<h1 class="firstHeading">2.2.1.6 xyz_renka</h1><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Brief_Information"><span class="tocnumber">1</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Command_Line_Usage"><span class="tocnumber">2</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#X-Function_Execution_Options"><span class="tocnumber">3</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Variables"><span class="tocnumber">4</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Description"><span class="tocnumber">5</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Examples"><span class="tocnumber">6</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#References"><span class="tocnumber">7</span> <span class="toctext">References</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Related_X-Functions"><span class="tocnumber">8</span> <span class="toctext">Related X-Functions</span></a></li>
</ul>
</div>

<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Convert XYZ data to matrix using Renka-Cline gridding
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
1. xyz_renka iz:=Col(3);
</p><p>2. xyz_renka iz:=Col(3) rows:=10 cols:=10;
</p><p>3. xyz_renka iz:=Col(3) om:=[MBook]MSheet!Mat(1);
</code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Input
</td>
<td>iz
</td>
<td>
<p>Input
</p><p>XYZRange
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td>
<p>Specifies the input XYZ range.
</p>
</td></tr>
<tr>
<td>Rows
</td>
<td>rows
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>20</center>
</td>
<td>
<p>Rows in the output matrix.
</p>
</td></tr>
<tr>
<td>Columns
</td>
<td>cols
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>20</center>
</td>
<td>
<p>Columns in the output matrix.
</p>
</td></tr>
<tr>
<td>Output Matrix
</td>
<td>om
</td>
<td>
<p>Output
</p><p>MatrixObject
</p>
</td>
<td> <center>&lt;new&gt;</center>
</td>
<td>
<p>The output matrix.
</p><p>See the syntax <a class="external text" href="../../XFunction/X-Function/Output_Notations.html">here</a>.
</p>
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>This function performs gridding based on the algorithm that Renka and Cline developed in 1984. It includes three main steps:
</p><p>1.  Triangulation:
</p>
<dl><dd>Connect all the data points to do a Thiessen triangulation in the <i>X</i>-<i>Y</i> plane, which means that the triangles in the plane are as nearly equiangular as possible.</dd></dl>
<p>2.  Gradient Estimation:
</p>
<dl><dd>Estimate a gradient in the <i>x</i>- and <i>y</i>-directions for each node as the partial derivatives of a quadratic function.</dd></dl>
<p>3.  Interpolation:
</p>
<dl><dd>For an arbitrary point <i>P</i>, compute the interpolated value using the data values and gradient estimates at each of the three vertices of the triangle which contains <i>P</i>.</dd></dl>
<p>For the 200~1000 data points and uniformly distributed case, Renka-Cline method could be a best choice.
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<ul><li> To run from the Command window</li></ul>
<ol><li> Import <i>XYZ Random Gaussian.dat</i> on the \S<i>amples</i>\<i>Matrix Conversion and Gridding</i> folder.</li>
<li> Type <b>xyz_renka</b> <b>3</b> in the command window. Or type <b>xyz_renka</b> <b>-d</b> to bring up the dialog.</li></ol>
<ul><li> Code Sample</li></ul>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000; font-style: regular;">/*
This example shows how convert random worksheet data into matrix by Renka-Cline gridding method.
The sample data is exe_path\Samples\Matrix Conversion and Gridding\XYZ Random Gaussian.dat
1. Load data to a new created workbook.
2. Random xyz gridding by Renka-Cline method.
3. Plot a wireframe graph.
*/</span>
<span style="color: #008000;">// Get sample data</span>
fn<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Matrix Conversion and Gridding\XYZ Random Gaussian.dat&quot;</span>;
newbook;
impASC fn<span style="color: #000080;">$</span>;
<span style="color: #008000;">// Set the third column as Z column</span>
wks.<span style="color: #000080;">col3</span>.<span style="color: #000080;">type</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">6</span>;

<span style="color: #008000;">// Convert worksheet data into matrix by Renka-Cline gridding method</span>
xyz_renka <span style="color: #0000dd;">3</span>;

<span style="color: #008000;">// Plot </span>
worksheet <span style="color: #000080;">-</span>p <span style="color: #0000dd;">242</span> wirefrm;</pre>
<h2><a name="References"></a><span class="mw-headline">References</span></h2>
<p>[1].  Robert J. Renka, <i>Interpolation of Data on the Surface of a Sphere</i>, 1984, ACM Transactions on Mathematical Software.
</p><p>[2].  Robert J. Renka, <i>A</i> <i>Triangle-based C1 Interpolation Method</i>, Rocky Mountain J. Math. Vol. 14, 1984, pp. 223-237.
</p>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">Related X-Functions</span></h2>
<p><a href="../../XFunction/X-Function/Xyz_regular.html" title="X-Function:Xyz regular">xyz_regular</a>, <strong class="selflink">xyz_renka</strong>, <a href="../../XFunction/X-Function/Xyz_shep.html" title="X-Function:Xyz shep">xyz_shep</a>, <a href="../../XFunction/X-Function/Xyz_shep_nag.html" title="X-Function:Xyz shep nag">xyz_shep_nag</a>, <a href="../../XFunction/X-Function/Xyz_sparse.html" title="X-Function:Xyz sparse">xyz_sparse</a>, <a href="../../XFunction/X-Function/Xyz_tps.html" title="X-Function:Xyz tps">xyz_tps</a>
</p>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>worksheet</span></p>






