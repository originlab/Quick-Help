<h1 class="firstHeading">2.2.3.47 wextract</h1><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">Menu Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Command_Line_Usage"><span class="tocnumber">3</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#X-Function_Execution_Options"><span class="tocnumber">4</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Variables"><span class="tocnumber">5</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Description"><span class="tocnumber">6</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Examples"><span class="tocnumber">7</span> <span class="toctext">Examples</span></a></li>
</ul>
</div>

<h2><a name="Menu_Information"></a><span class="mw-headline">Menu Information</span></h2>
<p>Worksheet Query...
</p>
<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Mask or extract data from worksheet using specified condition
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
</p>
<ol><li>wextract iy:=[Book1]Sheet1!col(A) settings.stAlias.Cols:=1 settings.stAlias.AliasNames:=A settings.stCondition.Condition:="A&lt;6" settings.Cols:=1;</li>
<li>wextract iy:=[USMetropolita]"US Metropolitan Area Population"!(1:end) settings.stAlias.Cols:="2|3" settings.stAlias.AliasNames:="S|D" settings.stCondition.Condition:="D&gt;500&amp;&amp;S&gt;1000" settings.stMethod.Method:=1 settings.Cols:="0|2|3";</li>
<li>wextract iy:=[Book1]Sheet1!col(A) settings.stAlias.Cols:=1 settings.stAlias.AliasNames:=A settings.stCondition.BeforeLoop:="j=1;" settings.stCondition.BeforeIfCondition:="if (i==col(B)[j]) {temp=col(A)[i];j=j+1;}" settings.stCondition.Condition:="A==temp" settings.Cols:=0;</li></ol>
<p></code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Input
</td>
<td>iy
</td>
<td>
<p>Input
</p><p>Range
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> Specify the input range.
</td></tr>
<tr>
<td>Settings
</td>
<td>settings
</td>
<td>
<p>Input
</p><p>TreeNode
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td> Specify the extract settings.  See more details in <a href="../../XFunction/X-Function/Details_of_TreeNodes_in_Wextract.html" title="X-Function:Details of TreeNodes in Wextract">this page</a>.
</td></tr>
<tr>
<td>Output
</td>
<td>oy
</td>
<td>
<p>Output
</p><p>Range
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td> Specify the output range.
<p>See the syntax <a class="external text" href="../../XFunction/X-Function/Output_Notations.html">here</a>.
</p>
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>This tool is in fact a script version of <a class="external text" href="../../UserGuide/UserGuide/Extract_Worksheet_Data.html">the <b>Extract Worksheet Data</b> tool</a>. It directs Origin to locate data in the specified worksheet based on a user-specified conditional expression. The located data values are extracted. In other words, these values can be copied to another worksheet or marked with a specified color.
</p><p>The settings variable can be used to customize the options for the operation. Please see <a href="../../XFunction/X-Function/Details_of_TreeNodes_in_Wextract.html" title="X-Function:Details of TreeNodes in Wextract">this page</a> for more details.
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p><b>Example 1: To extract the cells from Column B where the corresponding cells in in Column A are less than 6.</b>
</p><p>Create a new workbook and fill the first column with row numbers and the second column with 2, 4, 6... (twice of the row numbers).
</p><p><a  class="image"><img alt="XFunction Wextract1.png" src="../images/Wextract/XFunction_Wextract1.png?v=13999" width="249"  /></a>
</p><p>Type the following script in the command window.
</p>
<pre class="lt" style="font-family:monospace;">wextract iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>Book1<span style="color: #000000;">&#93;</span>Sheet1<span style="color: #000080;">!</span>col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span> settings.<span style="color: #000080;">stAlias</span>.<span style="color: #000080;">Cols</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>
settings.<span style="color: #000080;">stAlias</span>.<span style="color: #000080;">AliasNames</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span>A
settings.<span style="color: #000080;">stCondition</span>.<span style="color: #000080;">Condition</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;A&lt;6&quot;</span>
settings.<span style="color: #000080;">Cols</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;</pre>
<p>And the extracted data in Column B are shown in a new workbook.
</p><p><a  class="image"><img alt="XFunction Wextract2.png" src="../images/Wextract/XFunction_Wextract2.png?v=14000" width="250"  /></a>
</p><p><b>Example 2: </b>
</p><p>Select <b>Data: Import from File: Single ASCII</b> from the Origin menu. Import the file  \Samples\Data Manipulation\Us Metropolitan Area Population.dat.  The destination worksheet contains four columns: Population, Sq. Mi., Density, and Metropolitan Area.  To select  Metropolitan Areas in California where the Density is greater than 100 and output their Population, Density and Metropolitan Area to a new worksheet, you can type the following script in the command window.
</p>
<pre class="lt" style="font-family:monospace;">str1<span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;D&gt;100 AND M[i]$==&quot;</span><span style="color: #000080;">*</span>, CA<span style="color: #000080;">*</span><span style="color: #ff00ff;">&quot;&quot;</span>;

wextract iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>USMetropolita<span style="color: #000000;">&#93;</span><span style="color: #ff00ff;">&quot;US Metropolitan Area Population&quot;</span><span style="color: #000080;">!</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span>end<span style="color: #000000;">&#41;</span>
settings.<span style="color: #000080;">stAlias</span>.<span style="color: #000080;">Cols</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;3|4&quot;</span>
settings.<span style="color: #000080;">stAlias</span>.<span style="color: #000080;">AliasNames</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;D|M&quot;</span>
settings.<span style="color: #000080;">stCondition</span>.<span style="color: #000080;">Condition</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span>str1<span style="color: #000080;">$</span>
settings.<span style="color: #000080;">stMethod</span>.<span style="color: #000080;">Method</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>
settings.<span style="color: #000080;">Cols</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;0|2|3&quot;</span>;</pre>
<p>The extracted result is shown in a new worksheet of the USMetropolita workbook.
</p><p><a  class="image"><img alt="XFunction Wextract3.png" src="../images/Wextract/XFunction_Wextract3.png?v=14088" width="445"  /></a>
</p><p><b>Example 3: To extract the data from Column A whose row indices are contained in Column B.</b>
</p><p>Create a new workbook. Highlight Column A. Right-click on it and select <b>Fill Column with: Normal Random Numbers</b> from the short-cut menu. And fill column B with 2, 3, 5.
</p><p><a  class="image"><img alt="XFunction Wextract4.png" src="../images/Wextract/XFunction_Wextract4.png?v=14092" width="254"  /></a>
</p><p>Make sure the workbook is active. Type the following script in the command window.
</p>
<pre class="lt" style="font-family:monospace;">wextract iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span>
settings.<span style="color: #000080;">stAlias</span>.<span style="color: #000080;">Cols</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>
settings.<span style="color: #000080;">stAlias</span>.<span style="color: #000080;">AliasNames</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span>A
settings.<span style="color: #000080;">stCondition</span>.<span style="color: #000080;">BeforeLoop</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;j=1;&quot;</span>
settings.<span style="color: #000080;">stCondition</span>.<span style="color: #000080;">BeforeIfCondition</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;if (i==col(B)[j]) {temp=col(A)[i];j=j+1;}&quot;</span>
settings.<span style="color: #000080;">stCondition</span>.<span style="color: #000080;">Condition</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;A==temp&quot;</span>
settings.<span style="color: #000080;">Cols</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;</pre>
<p>And the 2nd, 3rd, 5th rows in Column A are extracted to a new workbook.
</p><p><a  class="image"><img alt="XFunction Wextract5.png" src="../images/Wextract/XFunction_Wextract5.png?v=14093" width="249"  /></a>
</p>





