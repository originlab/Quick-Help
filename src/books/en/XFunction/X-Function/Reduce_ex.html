<h1 class="firstHeading">2.2.24 reduce_ex</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">Menu Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Additional_Information"><span class="tocnumber">3</span> <span class="toctext">Additional Information</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Command_Line_Usage"><span class="tocnumber">4</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#X-Function_Execution_Options"><span class="tocnumber">5</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Variables"><span class="tocnumber">6</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Description"><span class="tocnumber">7</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Example"><span class="tocnumber">8</span> <span class="toctext">Example</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Algorithm"><span class="tocnumber">9</span> <span class="toctext">Algorithm</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#Related_X-Functions"><span class="tocnumber">10</span> <span class="toctext">Related X-Functions</span></a></li>
</ul>
</div>

<h2><a name="Menu_Information"></a><span class="mw-headline">Menu Information</span></h2>
<ul><li>When Workbook is active</li></ul>
<dl><dd><b>Worksheet: Reduce to Evenly Spaced X</b></dd></dl>
<ul><li>When Graph is active</li></ul>
<dl><dd><b>Analysis: Data Manipulation: Reduce to Evenly Spaced X</b></dd></dl>
<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Reduce XY data by resampling on X
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">Additional Information</span></h2>
<p><b>Minimum Origin Version Required</b>: 8.1 SR0
</p><p><br />
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
reduce_ex subgroup:=inter bins:=5 method:=yfirstxfirst
</code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Input
</td>
<td>iy
</td>
<td>
<p>Input
</p><p>XYRange
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> Specifies the input data range.
</td></tr>
<tr>
<td>SubGroup
</td>
<td>subgroup
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify the method to divide the source data into subgroups. After the dividing, each group of data points are merged into one data point.
<p>Option list:
</p>
<ul><li><i>ratio: Every N Points</i>
<dl><dd>Merge every N data points in the input range into one data point. You can specify the number N with the <b>rfactor</b> variable.</dd></dl></li>
<li><i>inter:By Sampling Interval </i>
<dl><dd>Merge data points according to the sampling interval. You can specify the sampling interval with the <b>dx</b> variable.</dd></dl></li>
<li><i>bins:By Number of Intervals</i>
<dl><dd>Merge data points according to the number of intervals. You can specify the number of intervals with the <b>bins</b> variable.</dd></dl></li>
<li><i>freq: By Frequency</i>
<dl><dd>Merge data points according to the frequency. You can specify the frequency with the <b>rfre</b> variable.</dd></dl></li></ul>
</td></tr>
<tr>
<td>Sampling Interval
</td>
<td>dx
</td>
<td>
<p>Input
</p><p>double
</p>
</td>
<td> <center>0.25</center>
</td>
<td> This is available only when <b>By Sampling Interval</b> is selected in <b>SubGroup</b>. Use it to specify the value of sampling interval.
</td></tr>
<tr>
<td>Interval Number
</td>
<td>bins
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>10</center>
</td>
<td> This is available only when <b>By Number of Intervals</b> is selected in <b>SubGroup</b>. Use it to specify the number of intervals.
</td></tr>
<tr>
<td>Resample Factor
</td>
<td>rfactor
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>4</center>
</td>
<td> This is available only when <b>Every N Points</b> is selected in <b>SubGroup</b>. It specifies the value of N.
</td></tr>
<tr>
<td>Resample Frequency
</td>
<td>rfre
</td>
<td>
<p>Input
</p><p>double
</p>
</td>
<td> <center>8</center>
</td>
<td> This is available only when <b>By Frequency</b> is selected in <b>SubGroup</b>. It specifies the resample frequency.
</td></tr>
<tr>
<td>X Start
</td>
<td>start
</td>
<td>
<p>Input
</p><p>double
</p>
</td>
<td> <center>&lt;auto&gt;</center>
</td>
<td> This is available only when <b>Every N Points</b>, <b>By Number of Intervals</b> or <b>By Frequency</b> is selected in <b>SubGroup</b>. Use it to specify the X value to start grouping.
</td></tr>
<tr>
<td>X End
</td>
<td>end
</td>
<td>
<p>Input
</p><p>double
</p>
</td>
<td> <center>&lt;auto&gt;</center>
</td>
<td> This is available only when <b>Every N Points</b>, <b>By Number of Intervals</b> or <b>By Frequency</b> is selected in <b>SubGroup</b>. Use it to specify the X value to end grouping.
</td></tr>
<tr>
<td>Sampling Method
</td>
<td>method
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> Specifies the method to pick the Y value for the merged data point in each group.
<p>Option list:
</p>
<ul><li><i>yfirstxfirst: First Point </i>
<dl><dd>Pick the Y value of the first data point in each group.</dd></dl></li>
<li><i>ymeanxbinc:Y Mean</i>
<dl><dd>Pick the mean of the Y values of the data points in each group. </dd></dl></li>
<li><i>yranxbinc: Random Y(X Average)</i>
<dl><dd>Pick a random number.</dd></dl></li></ul>
</td></tr>
<tr>
<td>Even Sampling Interval Tolerance(%)
</td>
<td>variation
</td>
<td>
<p>Input
</p><p>double
</p>
</td>
<td> <center>5</center>
</td>
<td> This is available only when you <b>Every N Points</b> is selected in <b>SubGroup</b>. Use it to specify the tolerance used to check whether the input X values are evenly spaced. For more details, please refer to the <a href="../../XFunction/X-Function/Reduce_ex.html#Algorithm" title="X-Function:Reduce ex">Algorithm</a> section below.
</td></tr>
<tr>
<td>Plot FFT for Preview
</td>
<td>plot
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specifies whether to plot the FFT results of the original data and the reduced data in the preview panel.
</td></tr>
<tr>
<td>Output
</td>
<td>oy
</td>
<td>
<p>Output
</p><p>XYRange
</p>
</td>
<td> <center>(&lt;autoX&gt;,&lt;new&gt;)</center>
</td>
<td> Specifies the output range. See the syntax of <a class="external text" href="../../XFunction/X-Function/Output_Notations.html">Output Notations</a>.
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>This X-Function is for reducing XY data into smaller size with evenly-spaced X values.
</p>
<h2><a name="Example"></a><span class="mw-headline">Example</span></h2>
<p><i><b>EX1</b></i>
</p><p>There is a dataset whose X values are not evenly spaced. The dataset contains 1000 data points. 
</p>
<dl><dd><a  class="image"><img alt="Reduce ex1.png" src="../images/Reduce_ex/Reduce_ex1.png?v=11800" width="394"  /></a></dd></dl>
<p>If you perform the following steps, you will get 100 points of them. The output data will be even-sampled:
</p>
<ol><li>Suppose the data is already in an Origin workbook. Highlight the data and then select <b>Plot: Symbol: Scatter</b> from the Origin menu to create a graph.
<dl><dd><a  class="image"><img alt="Reduce ex2.png" src="../images/Reduce_ex/Reduce_ex2.png?v=11799" width="421"  /></a></dd></dl></li>
<li>Make the graph active. Select <b>Analysis: Data Manipulation: Reduce to Evenly Spaced X</b> from the main menu to open the dialog box of the reduce_ex X-Function. </li>
<li>In the dialog box, check <b>Auto Preview</b> near the bottom .</li>
<li>Select <b>By Number of Intervals</b> with the <b>SubGroup</b> drop-down list. Then uncheck <b>Auto</b> next to the <b>Interval Number</b>, and enter <b>100 </b>.</li>
<li>Select <b>First Point</b> with the <b>Sampling Method</b> drop-down list.</li>
<li>Check <b>Plot FFT for Preview</b>. Then you can see the fft results of both the original data and reduced data.</li>
<li>Set <b>(&lt;new&gt;, &lt;new&gt;)</b> as output.
<dl><dd><a  class="image"><img alt="Reduce ex3.png" src="../images/Reduce_ex/Reduce_ex3.png?v=11798" width="752"  /></a></dd></dl></li>
<li>Click the <b>OK</b> button and you will see the results in the graph. The reduced data is next to the raw data in the input worksheet. And you can see that now the X values are evenly spaced.
<dl><dd><a  class="image"><img alt="Reduce ex4.png" src="../images/Reduce_ex/Reduce_ex4.png?v=11796" width="394"  /></a></dd></dl></li>
<li> Highlight X2 and Y2 columns in this workbook and then select<b> Plot: Symbol: Scatter</b> from the Origin menu to create a graph. You can see the shape is similar with the shape of the original data.
<dl><dd><a  class="image"><img alt="Reduce ex5.png" src="../images/Reduce_ex/Reduce_ex5.png?v=11795" width="421"  /></a></dd></dl></li></ol>
<p>You can also use the following script command to reduce the data points (suppose the input data is highlighted before the script is executed): 
</p>
<pre class="lt" style="font-family:monospace;">reduce_ex subgroup<span style="color: #000000;">:</span><span style="color: #000080;">=</span>bins bins<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">100</span> method<span style="color: #000000;">:</span><span style="color: #000080;">=</span>yfirstxfirst oy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#40;</span><span style="color: #000080;">&lt;</span>new<span style="color: #000080;">&gt;</span>,<span style="color: #000080;">&lt;</span>new<span style="color: #000080;">&gt;</span><span style="color: #000000;">&#41;</span>;</pre>
<p><i><b>EX2</b></i>
</p><p>Run following LabTalk scripts to import sample data <i>fitConv.dat</i> and reduce it by frequency.
</p>
<pre class="lt" style="font-family:monospace;">newbook&#160;;
fname<span style="color: #000080;">$</span><span style="color: #000080;">=</span>  system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span><span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Curve Fitting\fitConv.dat&quot;</span>&#160;;
impASC;
worksheet <span style="color: #000080;">-</span>s <span style="color: #0000dd;">2</span>;
reduce_ex <span style="color: #000080;">-</span>r <span style="color: #0000dd;">2</span> subgroup<span style="color: #000000;">:</span><span style="color: #000080;">=</span>freq;</pre>
<h2><a name="Algorithm"></a><span class="mw-headline">Algorithm</span></h2>
<ul><li> <b>Definition of Even Sampling Interval Tolerance</b></li></ul>
<p>When check whether the input X values are evenly spaced, it needs to specify a tolerance (from 0 to 1) for the even sampling interval. Here is the definition:
</p>
<ol><li> Suppose a ascending sorted X values is <img src="../images/Reduce_ex/math-324a4134393132d8cf5ce9cf50a56026.png?v=0" title="\left (x_1, x_2, x_3, ..., x_n \right )" alt="\left (x_1, x_2, x_3, ..., x_n \right )" class="tex"/>, where <img src="../images/Reduce_ex/math-7b8b965ad4bca0e41ab51de7b31363a1.png?v=0" title="n" alt="n" class="tex"/> is the size of this vector. And the specified tolerance is <img src="../images/Reduce_ex/math-d9734757e2e9d7363d18a5d238f419b4.png?v=0" title="tol" alt="tol" class="tex"/>.</li>
<li> Calculate the mean of increments of each adjacent values by <img src="../images/Reduce_ex/math-ffe7fa9316fe6c5be16cdc20066ea8d3.png?v=0" title="M_I = \frac {\sum_{k=2}^n \left ( x_k - x_{k-1} \right )}{n - 1}" alt="M_I = \frac {\sum_{k=2}^n \left ( x_k - x_{k-1} \right )}{n - 1}" class="tex"/>, where <img src="../images/Reduce_ex/math-f7a282bc81977a2a56781648ca1bfb35.png?v=0" title="k = 2, 3, ..., n \," alt="k = 2, 3, ..., n \," class="tex"/>.</li>
<li> Get a range by <img src="../images/Reduce_ex/math-d785af7e2ea08dd224ca61179851f283.png?v=0" title="M_I * \left ( 1 - tol \right )" alt="M_I * \left ( 1 - tol \right )" class="tex"/> and <img src="../images/Reduce_ex/math-06d0e72ef19a110aee239e58ed8b66f7.png?v=0" title="M_I * \left ( 1 + tol \right )" alt="M_I * \left ( 1 + tol \right )" class="tex"/>, that is, the range for testing is <img src="../images/Reduce_ex/math-b2214c3f900d5c281f7e854aabf331aa.png?v=0" title="[M_I * \left ( 1 - tol \right ) , M_I * \left ( 1 + tol \right ) ]" alt="[M_I * \left ( 1 - tol \right ) , M_I * \left ( 1 + tol \right ) ]" class="tex"/>, including both boundary values.</li>
<li> Test all the increments of each adjacent values to see whether all of them are in the range calculated from step 3, that is to say, for all increments, if satisfy <img src="../images/Reduce_ex/math-6ebf5179090ed2c1ffbbb0bda69085ad.png?v=0" title="M_I * \left ( 1 - tol \right ) \le x_k - x_{k-1} \le M_I * \left ( 1 + tol \right )" alt="M_I * \left ( 1 - tol \right ) \le x_k - x_{k-1} \le M_I * \left ( 1 + tol \right )" class="tex"/>, where <img src="../images/Reduce_ex/math-f7a282bc81977a2a56781648ca1bfb35.png?v=0" title="k = 2, 3, ..., n \," alt="k = 2, 3, ..., n \," class="tex"/>, we say this input X values are evenly spaced.</li></ol>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">Related X-Functions</span></h2>
<p><a href="../../XFunction/X-Function/Stats.html" title="X-Function:Stats">stats</a>, <a href="../../XFunction/X-Function/Reducexy.html" title="X-Function:Reducexy">reducexy</a>
</p>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>data reduction, sampling interval, frequency</span></p>






