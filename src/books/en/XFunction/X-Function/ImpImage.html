<h1 class="firstHeading">2.7.40 impImage</h1><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">Menu Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Command_Line_Usage"><span class="tocnumber">3</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#X-Function_Execution_Options"><span class="tocnumber">4</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Variables"><span class="tocnumber">5</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Description"><span class="tocnumber">6</span> <span class="toctext">Description</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#Details_on_Some_Dialog_Options"><span class="tocnumber">6.1</span> <span class="toctext">Details on Some Dialog Options</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8"><a href="#Examples"><span class="tocnumber">7</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Related_X-Functions"><span class="tocnumber">8</span> <span class="toctext">Related X-Functions</span></a></li>
</ul>
</div>

<h2><a name="Menu_Information"></a><span class="mw-headline">Menu Information</span></h2>
<p>Data: Import from File: Image to Matrix
</p><p>This X-Function supports file re-import. See <a class="external text" href="../../GettingStarted/OriginLab/Import_Data.html#Re-Importing_Data_Files">this topic</a> for details.
</p>
<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Import image file into a Matrix window
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
1. impImage fname:="C:\image\Sample.bmp";
</p><p>2. impImage fname:="c:\image\Sample.bmp" options.thumbnail:=0 options.FirstMode:=4 options.names.FNameToBk:=0;
</p><p>3. fname$="C:\Images\Sample.jpg";impImage;
</code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>File Name
</td>
<td>fname
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>fname$</center>
</td>
<td>
<p>Specify the filename of the image file to be imported.
</p>
</td></tr>
<tr>
<td>File Info
</td>
<td>info
</td>
<td>
<p>Input
</p><p>TreeNode
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td>
<p>This is for displaying the file information in the dialog. Please do not use this variable.
</p><p>Basic information of the file(s) (file size) to be imported is listed here.
</p>
</td></tr>
<tr>
<td>Import Options
</td>
<td>options
</td>
<td>
<p>Input
</p><p>TreeNode
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td>
<p>Use this to specify the import mode. Please see the Descriptions section for details.
</p>
</td></tr>
<tr>
<td>Output
</td>
<td>orng
</td>
<td>
<p>Output
</p><p>Range
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td>
<p>This is used to specify the output range.
See the syntax <a class="external text" href="../../XFunction/X-Function/Output_Notations.html">here</a>.
</p><p><b>Note:</b> Matrices can exist as standalone windows or they can be <a class="external text" href="../../UserGuide/UserGuide/Adding_Existing_Graphs_Matrixs_as_Sheets.html">embedded in a worksheet</a>. The <b>impImage</b> X-Function is programmed to recognize embedded matrices and to treat them as a matrix rather than as a worksheet. Thus, when the active worksheet contains an embedded matrix, <b>impImage</b> is able to output the imported image to the embedded matrix in the active workbook sheet. 
</p>
</td></tr>
<tr>
<td>Header Info
</td>
<td>finfo
</td>
<td>
<p>Output
</p><p>TreeNode
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td>
<p>This is for outputting the header information. It is hidden from the GUI. Users are not advised to use this variable.
</p>
</td></tr>
<tr>
<td>Filter
</td>
<td>trFilter
</td>
<td>
<p>Input
</p><p>TreeNode
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td>
<p>This is the TreeNode for filter. It is hidden from the GUI. Users are not advised to use this variable.
</p>
</td></tr>
<tr>
<td>File Index
</td>
<td>fIndex
</td>
<td>
<p>Output
</p><p>int
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td>
<p>This is for internal use only. 
</p>
</td></tr>
<tr>
<td>Repeat Import
</td>
<td>reimp
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>This is for internal use only. 
</p>
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>This X-Function can be used to import image files to Origin matrix. It is accessible when workbook, matrix, or graph window is active. Supported image file types include:
</p>
<dl><dd><ul><li> Bitmap (*.bmp)</li>
<li> Graphics Interchange Format (*.gif)</li>
<li> Joint Photographic Experts Group (*.jpg, *jpe, *jpeg)</li>
<li> Zsoft PC Paintbrush Bitmap (*.pcx)</li>
<li> Portable Network Graphics (*.png)</li>
<li> Truevision Targa (*.tga)</li>
<li> Adobe Photoshop (*.psd)</li>
<li> Tag Image File (*.tif, *tiff)</li>
<li> Windows MetaFile (*.wmf)</li>
<li> Enhanced MetaFile (*.emf)</li></ul></dd></dl>
<h3><a name="Details_on_Some_Dialog_Options"></a><span class="mw-headline">Details on Some Dialog Options</span></h3>
<dl><dd><ul><li><b>Import Options(info and options)</b></li></ul>
<dl><dd>Please see <a href="../../XFunction/X-Function/Details_of_TreeNodes_in_Import_Image.html" title="X-Function:Details of TreeNodes in Import Image">this page</a> for more details.</dd></dl></dd></dl>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p>The following example will show how to import multiple image files (which contain the same dimension) as the matrix objects into the matrix sheet.
</p>
<ol><li> Create a new project, then select menu <b>Data: Import from File: Image to Matrix</b> to open the images browser.</li>
<li> Select files from <i>myocyte1.tif</i> to <i>myocyte8.tif</i> in the folder <i>&lt;Origin Installation Folder&gt;\Samples\Image Processing and Analysis\</i> and click the <b>Add File(s)</b> button. Then click the <b>OK</b> button to reach the <b>impImage</b> dialog.</li>
<li> In the <b>impImage</b> dialog, change <b>1st File Import Mode</b> to <b>Start New Books</b>, then check the check-box <b>Include File Path when Renaming Book</b>, and other settings keep default, as the following image shows.
<dl><dd><a  class="image"><img alt="ImpImage example dialog.png" src="../images/ImpImage/ImpImage_example_dialog.png?v=80007" width="542"  /></a></dd></dl></li>
<li> Click the <b>OK</b> button, and all images are imported into the same matrix sheet. Please note that the sheet name and book name depend on the name of the last imported image, because every image is imported, it will rename the sheet name and book name with the file name.
<dl><dd><a  class="image"><img alt="ImpImage example result.png" src="../images/ImpImage/ImpImage_example_result.png?v=80008" width="398"  /></a></dd></dl></li></ol>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">Related X-Functions</span></h2>
<p><a href="../../XFunction/X-Function/Cd.html" title="X-Function:Cd">cd</a>, <a href="../../XFunction/X-Function/Impinfo.html" title="X-Function:Impinfo">impinfo</a>, <a href="../../XFunction/X-Function/FindFiles.html" title="X-Function:FindFiles">findFiles</a>, <a href="../../XFunction/X-Function/ImpFile.html" title="X-Function:ImpFile">impFile</a>
</p>





