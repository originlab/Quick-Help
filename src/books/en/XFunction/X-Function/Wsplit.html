<h1 class="firstHeading">2.2.3.69 wsplit</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">Menu Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Additional_Information"><span class="tocnumber">3</span> <span class="toctext">Additional Information</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Command_Line_Usage"><span class="tocnumber">4</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#X-Function_Execution_Options"><span class="tocnumber">5</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Variables"><span class="tocnumber">6</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Description"><span class="tocnumber">7</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Related_X-Functions"><span class="tocnumber">8</span> <span class="toctext">Related X-Functions</span></a></li>
</ul>
</div>

<h2><a name="Menu_Information"></a><span class="mw-headline">Menu Information</span></h2>
<p>Restructure: Split Worksheet
</p>
<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Split worksheet by rows/columns or values in reference column
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">Additional Information</span></h2>
<p><b>Minimum Origin Version Required</b>: Origin 8.6. 
</p><p>Split partial worksheet, split by Reference Columns and Preset Result Sheet Name require 2017b.
</p><p>Split by Reference Column according to the value and condition both requires 2021.
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
1. wsplit mode:=row row:=5;
</p><p>2. wsplit mode:=label label:=L keep:=1;
</p><p>3. wsplit mode:=ref ref:=[Book1]Sheet1!A name:=&lt;[&lt;%N_%V&gt;]&gt;;
</p><p>4. wsplit mode:=ref ref:=[Book1]Sheet1!D refmode:=change turnpoint:=pregroup refsort:=desc;
</p><p></code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Input Worksheet
</td>
<td>iw
</td>
<td>
<p>Input
</p><p>Worksheet
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> Specify the range to be split. May be an entire worksheet or a column range.
</td></tr>
<tr>
<td>Split Mode
</td>
<td>mode
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify the way in which the input worksheet is split.
<p>Option list:
</p>
<ul><li><i>col:By Number of Columns</i>
<dl><dd>Every <i>n</i> columns will be split into a new worksheet. Specify the number <i>n</i> in the <b>col</b>.</dd></dl></li>
<li><i>row:By Number of Rows</i>
<dl><dd>Every <i>n</i> rows will be split into a new worksheet. Specify the number <i>n</i> in the <b>row</b>.</dd></dl></li>
<li><i>label:By Column Label</i>
<dl><dd>Columns having the same label in a specified label row will be split into the same worksheet. Specify the column label row in the <b>label</b>. </dd></dl></li>
<li> <i>ref: By Reference Columns</i>
<dl><dd>Rows will be grouped and split to new worksheets, by value(s) and conditions in reference column(s). </dd></dl></li></ul>
</td></tr>
<tr>
<td>Number of Columns
</td>
<td>col
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>2</center>
</td>
<td> Available when <b>Split Mode</b> is <i>By Number of Columns</i>. Specify every <i>n</i> columns to create a new worksheet.
</td></tr>
<tr>
<td>Number of Rows
</td>
<td>row
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>2</center>
</td>
<td> Available when <b>Split Mode</b> is <i>By Number of Rows</i>. Specify every <i>n</i> rows to create a new worksheet
</td></tr>
<tr>
<td>Column Label
</td>
<td>label
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center></center>
</td>
<td> Available when <i>By Column Label</i> is selected for <b>Split Mode</b>. Specify the label row using its Label Row character.  Please refer to <a class="external text" href="../../LabTalk/LabTalk/Column_Label_Row_Characters.html">Column Label Row Characters</a> for the single character of each column label row.
</td></tr>
<tr>
<td> Reference Columns
</td>
<td> ref
</td>
<td>
<p>Input
</p><p>Range
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td> Available when <b>Split Mode</b> is <i>By Reference Columns</i>. Specify column(s) containing grouping variable(s).
</td></tr>
<tr>
<td>Split
</td>
<td>refmode
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>Specify how to split the worksheet rows according to the selected reference column.
</p><p>This control in only available when you selected single reference column in the <b>Reference Columns</b> box.
Option list:
</p>
<ul><li> <b>0=val:By Value</b>
<dl><dd> Split the worksheet rows according to the values in the reference column. That means the rows with same values in the reference column will be split and extracted to the result worksheets. Tolerance is allowed. This is selected by default.</dd></dl></li>
<li> <b>1=change:By Direction Change</b>
<dl><dd> Split the worksheet rows when the direction of the values in reference column changes, from ascending to descending, or vice versa.  </dd></dl></li>
<li> <b>2=reset:By Direction Reset</b>
<dl><dd> Split the worksheet rows when the ascending/descending values in reference column have been reset to the base.</dd></dl></li>
<li> <b>3=refval:By Value Change</b>
<dl><dd> Split the worksheet rows when the value in reference column changes. Tolerance is allowed. </dd></dl></li></ul>
</td></tr>
<tr>
<td>Tolerance
</td>
<td>tol
</td>
<td>
<p>Input
</p><p>double
</p>
</td>
<td> <center>1E-8</center>
</td>
<td> Available when <b>Split Mode</b> is <i>By Reference Columns</i> and <b>Split</b> is <i>By Value</i>/<i>By Value Change</i>. Specify the tolerance which will take into account when dertmine if the numeric values change.
</td></tr>
<tr>
<td>Include Turning Point in
</td>
<td>turnpoint
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> Specify how to deal with the turning points, to include them in the previous group or next group, when you selected <b>By Direction Change</b> for the <b>Split</b> control.
<p>Option list:
</p>
<ul><li> <b>0=pregroup:Previous Group</b>
<dl><dd> Include the turning points into the previous group when split the worksheet rows.</dd></dl></li>
<li> <b>1=nextgroup:Next Group</b>
<dl><dd> Include the turning points into the next group when split the worksheet rows. This is selected by default.</dd></dl></li></ul>
</td></tr>
<tr>
<td> Keep Reference Columns in Result
</td>
<td> keepref
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> Output Reference Column data with split result.
</td></tr>
<tr>
<td>Sort Result by Reference Columns
</td>
<td>refsort
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify whether to sort the result rows according to the corresponding values in the reference column when you checked <b>Keep Reference Columns in Result</b>. Please note, this check box is only available for the <b>Split</b> control set to <b>By Direction Change</b> or <b>By Direction Reset</b>.
<p>Option list:
</p>
<ul><li> <b>0=unsorted:Unsorted</b>
<dl><dd> Keep the original order of the rows, do not sort them.</dd></dl></li>
<li> <b>1=asc:Ascending</b>
<dl><dd> Sort the result rows in the result worksheet in ascending order of the corresponding values in the reference column.</dd></dl></li>
<li> <b>2=desc:Descending</b>
<dl><dd> Sort the result rows in the result worksheet in descending order of the corresponding values in the reference column.</dd></dl></li></ul>
</td></tr>
<tr>
<td> Exclude Missing Value
</td>
<td> missing
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> Exclude empty cells or cells containing Origin's missing value character ("--"), from output.
</td></tr>
<tr>
<td>Copy Column Formula to Result
</td>
<td>copyform
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> If original worksheet has column formula, specify how to deal with the formula.
<p>Option list:
</p>
<ul><li> <b>0=none:None</b>
<dl><dd>Do not copy the column formula</dd></dl></li>
<li> <b>1=copyexc:Copy and Execute</b>
<dl><dd>Copy column formula to the result sheets and execute it.</dd></dl></li>
<li> <b>2=copy:Copy Formula Text</b>
<dl><dd>Copy the text of column formula to the result sheets but not execute it. You will need to manually execute it later.</dd></dl></li></ul>
</td></tr>
<tr>
<td>Keep Short Name
</td>
<td>sn
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Determine whether to keep the column short names after splitting to new worksheets.
<p><b>Note</b> that from Origin 2017, <a class="external text" href="../../UserGuide/UserGuide/Column_Short_Name_Restriction.html">column Short Name is restricted</a> to alphabetical order and it cannot be edited, by default. So the <b>Keep Short Name</b> option is <a class="external text" href="../../UserGuide/UserGuide/Split_Worksheet.html">hidden in the GUI</a> (see note at the bottom of the page). The script user can output customized Short Names using <code>sn:=1</code>, regardless of the value of <a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#S">@SSG</a>.
</p>
</td></tr>
<tr>
<td>Retain 1st N Columns
</td>
<td>fixcol
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Available when <b>Split Mode</b> is <i>By Number of Columns</i> or <i>By Column Label</i>. Specify first <i>n</i> columns of the source Worksheet to keep them in all split result sheet. And these first <i>n</i> columns are excluded from splitting <i>By Number of Columns</i> or <i>By Column Label</i>.
</td></tr>
<tr>
<td>Keep Source Worksheet
</td>
<td>keep
</td>
<td>
<p>Input
int
</p>
</td>
<td> <center>1</center>
</td>
<td> Keep the source worksheet intact. Otherwise the source worksheet is deleted.
</td></tr>
<tr>
<td>Show Sparklines
</td>
<td>sparkline
</td>
<td>
<p>Input
int
</p>
</td>
<td> <center>1</center>
</td>
<td> Show Sparklines for the columns in the output worksheets.
</td></tr>
<tr>
<td>Output Worksheet
</td>
<td>owp
</td>
<td>
<p>Output
</p><p>WorksheetPage
</p>
</td>
<td> <center>&lt;new&gt;</center>
</td>
<td> Specify the output worksheet
</td></tr>
<tr>
<td>Preset Result Sheet Name
</td>
<td>name
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>%V</center>
</td>
<td>
<p>%N = ref name, LN if present, otherwise SN <br />
%C = ref dataset name<br />
%M = ref Comment <br />
%U = ref Units <br />
%V = ref cell values (grouping variable)
</p><p>Variables can be used in combination and incorporate arbitrary text (e.g.&#160;%N=%V). Whether used singly, in combination or with arbitrary text, variables must be protected as in the following example:
</p>
<pre class="lt" style="font-family:monospace;">wsplit mode<span style="color: #000000;">:</span><span style="color: #000080;">=</span>ref ref<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>Book1<span style="color: #000000;">&#93;</span>Sheet1<span style="color: #000080;">!</span>A name<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span><span style="color: #000000;">&#91;</span><span style="color: #000080;">&lt;</span><span style="color: #000080;">%</span>N_<span style="color: #000080;">%</span>V<span style="color: #000080;">&gt;</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">&gt;</span>;</pre>
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>This X-Function is used to split one worksheet's columns into multiple sheets, according to the method specified.
</p>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">Related X-Functions</span></h2>
<p><a href="../../XFunction/X-Function/Wsplit_book.html" title="X-Function:Wsplit book">wsplit_book</a>
</p>





