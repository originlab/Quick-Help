<h1 class="firstHeading">2.7.46 impMatlab</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">Menu Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Command_Line_Usage"><span class="tocnumber">3</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#X-Function_Execution_Options"><span class="tocnumber">4</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Variables"><span class="tocnumber">5</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Description"><span class="tocnumber">6</span> <span class="toctext">Description</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#Details_on_Some_Dialog_Options"><span class="tocnumber">6.1</span> <span class="toctext">Details on Some Dialog Options</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8"><a href="#Examples"><span class="tocnumber">7</span> <span class="toctext">Examples</span></a>
<ul>
<li class="toclevel-2 tocsection-9"><a href="#Example_1"><span class="tocnumber">7.1</span> <span class="toctext">Example 1</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Example_2"><span class="tocnumber">7.2</span> <span class="toctext">Example 2</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-11"><a href="#Related_X-Functions"><span class="tocnumber">8</span> <span class="toctext">Related X-Functions</span></a></li>
</ul>
</div>

<h2><a name="Menu_Information"></a><span class="mw-headline">Menu Information</span></h2>
<p>Data: Import from File: Matlab(Mat)
</p><p><br />
If you do not see this file type, choose <b>Data: Import from File: Add/Remove File Types...</b>
</p><p><a  class="image"><img alt="File Import Add Menu.png" src="../images/ImpMatlab/File_Import_Add_Menu.png?v=81194" width="475"  /></a>
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/ImpMatlab/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>To add drag &amp; drop support for a file type, see <a class="external text" href="../../UserGuide/UserGuide/Introduction_to_Import_Filters_Manager.html"><b>Import Filter Manager</b></a>.
</p></td></tr></table>
<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Import Matlab files
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
1. impMatlab fname:="c:\test.mat";
</p><p>2. impMatlab fname:="c:\data.mat" options.impMode:=1;
</p><p></code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>File Name
</td>
<td>fname
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>fname$</center>
</td>
<td> Filename (s) of the file (s) to be imported.
</td></tr>
<tr>
<td>File Info and Data Selection
</td>
<td>trfiles
</td>
<td>
<p>Input
</p><p>TreeNode
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td> This is used to show the file information. It allows to select which variable in the file to be imported.
</td></tr>
<tr>
<td>Import Options
</td>
<td>options
</td>
<td>
<p>Input
</p><p>TreeNode
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td> This is mainly used in the dialog, for tweaking the import options. Please see the Descriptions section for details.
</td></tr>
<tr>
<td>Output
</td>
<td>orng
</td>
<td>
<p>Output
</p><p>Range
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> This is used to specify the output range.
<p>See the syntax <a class="external text" href="../../XFunction/X-Function/Output_Notations.html">here</a>.
</p><p><b>Note:</b> Matrices can exist as standalone windows or they can be <a class="external text" href="../../UserGuide/UserGuide/Adding_Existing_Graphs_Matrixs_as_Sheets.html">embedded in a worksheet</a>. The <b>impMatlab</b> X-Function is programmed to recognize embedded matrices and to treat them as a matrix rather than as a worksheet. Thus, when the active worksheet contains an embedded matrix, <b>impMatlab</b> is able to output the imported data to the embedded matrix in the active workbook sheet. 
</p>
</td></tr>
<tr>
<td>Header Info
</td>
<td>trheader
</td>
<td>
<p>Output
</p><p>TreeNode
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td> This is for outputting the header information. It is hidden from the GUI. Users are not advised to use this variable.
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>This X-Function is used for importing Matlab data files. You can import multiple files at one time, and variables in each file are selectable for importing. The destination and stored structure can be specified too. 
</p><p>In Origin, variables in each Matlab data file are stored in the following ways: 
</p>
<ol><li>In the Workbook
<ul><li><b>Not Hierarchical Structure</b>: By default, all variables in each file will be stored in the same worksheet one-by-one. All will begin with the same row.</li>
<li><b>Hierarchical Structure</b>: Only the variable list is imported into a worksheet, and the individual variable names are displayed as linked text in the 1st column. Clicking on variable names will import the desired variables one-by-one in the new worksheets. </li></ul></li>
<li>In the Matrixbook
<dl><dd>Each variable will be stored in a matrix sheet.</dd></dl></li></ol>
<p><br />
</p>
<h4><a name="Details_on_Some_Dialog_Options"></a><span class="mw-headline">Details on Some Dialog Options</span></h4>
<ul><li><b>Import Options(options)</b></li></ul>
<dl><dd>Please see <a class="external text" href="../../XFunction/X-Function/Details_of_TreeNodes_in_Import_Matlab.html">this page</a> for more details.</dd></dl>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<h4><a name="Example_1"></a><span class="mw-headline">Example 1</span></h4>
<p>This example will show you how to import a Matlab file with structure data into hierarchical structure.
</p>
<ol>
<li>Create a new workbook and activate it.

<li>From the Origin main menu, select <b>Data: Import from File: Matlab (Mat)...</b>.

<li>In the <b>MatlabFiles</b> dialog, browse to <i>\Samples\Import and Export\Matdata_Struct.mat</i>, then click the <b>Add File(s)</b> button. 
Make sure to check the <b>Show Options Dialog</b> checkbox and click the <b>OK</b> button to open the <b>impMatlab</b> dialog.

<li>In the dialog box, note that the <b>Variables</b> box under the <b>File Info and Data Selection</b> branch is empty. Some variables in the MATLAB file are not supported by Origin. If you import your file using default settings, these variables will be skipped.
<br /><a  class="image"><img alt="ImpMatlab 01.png" src="../images/ImpMatlab/ImpMatlab_01.png?v=77700" width="492"  /></a>

<li>For the structure data in the MATLAB file, check the <b>Import into Hierarchical Structure</b> box under the <b>Import Options</b> branch. 
Note that the <b>File Info and Data Selection</b> branch, <b>Save File Info. in Workbook</b> and <b>Import Mode</b> options are now grayed out.
<br /><a  class="image"><img alt="ImpMatlab 02.png" src="../images/ImpMatlab/ImpMatlab_02.png?v=77701" width="492"  /></a>

<li>Click the <b>OK</b> button. The file will be imported. Next, click on the variable names to further import just the desired variables one-by-one, into new worksheets.
<br /><a  class="image"><img alt="ImpMatlab 03.png" src="../images/ImpMatlab/ImpMatlab_03.png?v=77702" width="545"  /></a>

</ol>
<h4><a name="Example_2"></a><span class="mw-headline">Example 2</span></h4>
<p>This example will show you how to import Matlab data files to matrixbook.
</p>
<ol>
<li>Create a new matrixbook and activate it.

<li>From the Origin main menu, select <b>Data: Import from File: Matlab (Mat)...</b>.

<li>In the <b>MatlabFiles</b> dialog, locate to <i> \Samples\Import and Export\</i> and select files <i>GaussianData.mat</i> and <i>Matdata_1.mat</i> (Press down the Ctrl key to select multiple files.), then click the <b>Add File(s)</b> button. Make sure to check the <b>Show Options Dialog</b> check-box and click the <b>OK</b> button to open the <b>impMatlab</b> dialog.

<li>In the dialog, you will find the variables of two files are listed under <b>File Info and Data Selection</b> branch. Choose <b>Start New Matrixsheets</b> as the <b>Import Mode</b>.
<br /><a  class="image"><img alt="ImpMatlab 05.png" src="../images/ImpMatlab/ImpMatlab_05.png?v=77703" width="539"  /></a>

<li>Click the <b>OK</b> button, the files will be imported as: 
<br /><a  class="image"><img alt="ImpMatlab 06.png" src="../images/ImpMatlab/ImpMatlab_06.png?v=77704" width="438"  /></a>
</ol>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">Related X-Functions</span></h2>
<p><a href="../../XFunction/X-Function/ImpFile.html" title="X-Function:ImpFile">impFile</a>, <a href="../../XFunction/X-Function/Impinfo.html" title="X-Function:Impinfo">impinfo</a>, <a href="../../XFunction/X-Function/ImpFileSel.html" title="X-Function:ImpFileSel">impFileSel</a>
</p>

