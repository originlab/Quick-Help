<h1 class="firstHeading">2.10.28 plotmatrix</h1><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Brief_Information"><span class="tocnumber">1</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#X-Function_Execution_Options"><span class="tocnumber">2</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Variables"><span class="tocnumber">3</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Description"><span class="tocnumber">4</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Examples"><span class="tocnumber">5</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Algorithm"><span class="tocnumber">6</span> <span class="toctext">Algorithm</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#References"><span class="tocnumber">7</span> <span class="toctext">References</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Related_X-Functions"><span class="tocnumber">8</span> <span class="toctext">Related X-Functions</span></a></li>
</ul>
</div>

<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Create a scatter matrix plot as embedded graphs in worksheet
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Input
</td>
<td>irng
</td>
<td>
<p>Input
</p><p>Range
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td>
<p>Specify the input data range.
</p>
</td></tr>
<tr>
<td>Confidence Ellipse
</td>
<td>ellipse
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td>
<p>Specify whether to add confidence ellipse for each graph based on the chosen confidence level. 
</p>
</td></tr>
<tr>
<td>Confidence Level in&#160;%
</td>
<td>conflevel
</td>
<td>
<p>Input
</p><p>double
</p>
</td>
<td> <center>95</center>
</td>
<td>
<p>This is only available when the <b>ellipse</b> variable is set to 1. Use it to specify the confidence level in percentage for the confidence ellipses. This value must be greater than 0 and less than 100
</p>
</td></tr>
<tr>
<td>Linear Fit
</td>
<td>fit
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>Specify whether to perform a linear fit to each pair of variables. When this is checked, the fitted line and the adjusted R^2 value will be added to each scatter graph. 
</p>
</td></tr>
<tr>
<td>Exclude Missing Values Listwise
</td>
<td>missing
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>Specify whether to exclude missing values listwisely. That is, exclude the entire row for all datasets if there are any missing values in this row. 
</p>
</td></tr>
<tr>
<td>Output Results
</td>
<td>rd
</td>
<td>
<p>Output
</p><p>ReportData
</p>
</td>
<td> <center>[&lt;input&gt;]&lt;new&gt;</center>
</td>
<td>
<p>This determines where the calculated data for the ellipse and the fit are stored. The default location is a new worksheet within the source workbook.
</p>
</td></tr>
<tr>
<td>Result Graph
</td>
<td>rt
</td>
<td>
<p>Output
</p><p>ReportTree
</p>
</td>
<td> <center>[&lt;input&gt;]&lt;new template:=graph&gt;</center>
</td>
<td>
<p>This determines where the graphs will be stored. The default location is a new worksheet based on the GRAPH.OTW template within the source workbook.
</p>
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>This X-Function can be used to create a scatter matrix of multiple variables with normal distributions, which can be used to determine if pairs of such variables correlate or not.
</p><p>Confidence ellipse can be added to each scatter plot. This helps you to judge the correlation of the pair of variables plotted in the graph.
</p><p>Linear fit can be performed to each scatter plot. The inclination angle of the fitted line indicates the direction of the correlation. If it is positive, this means that the increase of one variable is likely to cause the increase of the other variable. While a negative angle indicates a reverse relationship. The slope of the fit varies from -1 (perfectly negative correlation) to +1 (perfect positive correlation).
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create a Scatter Matrix using columns 2, 3 and 5 of the specified Worksheet</span>
newbook na<span style="color: #000000;">:</span><span style="color: #000080;">=</span>PlotMatrixEX op<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
wo <span style="color: #000080;">-</span>a <span style="color: #0000dd;">3</span>;   <span style="color: #008000;">// Add 3 columns</span>
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>data<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">30</span><span style="color: #000000;">&#41;</span>;
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>uniform<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">30</span><span style="color: #000000;">&#41;</span>;
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>normal<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">30</span><span style="color: #000000;">&#41;</span>;
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>uniform<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">30</span><span style="color: #000000;">&#41;</span>;
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">5</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>;
plotmatrix
  irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>PlotMatrixEX<span style="color: #000000;">&#93;</span>Sheet1<span style="color: #000080;">!</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">3</span>,<span style="color: #0000dd;">5</span><span style="color: #000000;">&#41;</span>
  ellipse<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>
  conflevel<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">50</span>
  fit<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
 
<span style="color: #008000;">// Here we create a new book with sheets for our data and our graphs.</span>
<span style="color: #008000;">// We then use this same book for gathering Scatter Matrix results</span>
<span style="color: #008000;">// for columns 1 and 2 in all sheets in our source book.</span>
newbook na<span style="color: #000000;">:</span><span style="color: #000080;">=</span>PMEx2 op<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
repeat <span style="color: #0000dd;">3</span> newsheet;
loop<span style="color: #000000;">&#40;</span>ii,<span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span>
    page.<span style="color: #000080;">active</span> <span style="color: #000080;">=</span> ii;     <span style="color: #008000;">// for each sheet</span>
    col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> uniform<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">25</span><span style="color: #000000;">&#41;</span>;
    col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> uniform<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">25</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span>
for<span style="color: #000000;">&#40;</span> ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>&#160;; ii <span style="color: #000080;">&lt;=</span> <span style="color: #0000dd;">4</span>&#160;; ii<span style="color: #000080;">++</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
  range rData <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>PMEx2<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>ii<span style="color: #000000;">&#41;</span><span style="color: #000080;">!</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>;
  plotmatrix
    irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span>rData
    ellipse<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>
    conflevel<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">50</span>
    fit<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>
    rd<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>STATS<span style="color: #000000;">&#93;</span>MyScatterData
    rt<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>STATS<span style="color: #000000;">&#93;</span>MyScatterGraphs;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Algorithm"></a><span class="mw-headline">Algorithm</span></h2>
<p>Assuming the pair of two variables <a  class="image"><img alt="Plotmatrix help English files image002.gif" src="../images/Plotmatrix/Plotmatrix_help_English_files_image002.gif?v=253" width="45"  /></a> follows bivariate normal distribution, we can study the relationship of the two variables by this test. The confidence ellipse is centered at <a  class="image"><img alt="Plotmatrix help English files image006.gif" src="../images/Plotmatrix/Plotmatrix_help_English_files_image006.gif?v=255" width="68"  /></a>, and the major semiaxis <a  class="image"><img alt="Plotmatrix help English files image008.gif" src="../images/Plotmatrix/Plotmatrix_help_English_files_image008.gif?v=256" width="16"  /></a> and major semiaxis <a  class="image"><img alt="Plotmatrix help English files image010.gif" src="../images/Plotmatrix/Plotmatrix_help_English_files_image010.gif?v=257" width="17"  /></a> are given by the following equations:
</p>
<dl><dt><a  class="image"><img alt="Plotmatrix help English files image012.gif" src="../images/Plotmatrix/Plotmatrix_help_English_files_image012.gif?v=258" width="271"  /></a></dt></dl>
<p>where <a  class="image"><img alt="Plotmatrix help English files image014.gif" src="../images/Plotmatrix/Plotmatrix_help_English_files_image014.gif?v=259" width="21"  /></a> and <a  class="image"><img alt="Plotmatrix help English files image014.gif" src="../images/Plotmatrix/Plotmatrix_help_English_files_image014.gif?v=259" width="21"  /></a> are the variances of <a  class="image"><img alt="Plotmatrix help English files image016.gif" src="../images/Plotmatrix/Plotmatrix_help_English_files_image016.gif?v=260" width="19"  /></a> and <a  class="image"><img alt="Plotmatrix help English files image018.gif" src="../images/Plotmatrix/Plotmatrix_help_English_files_image018.gif?v=261" width="15"  /></a>, <a  class="image"><img alt="Plotmatrix help English files image020.gif" src="../images/Plotmatrix/Plotmatrix_help_English_files_image020.gif?v=262" width="12"  /></a> is the correlation coefficient of <a  class="image"><img alt="Plotmatrix help English files image016.gif" src="../images/Plotmatrix/Plotmatrix_help_English_files_image016.gif?v=260" width="19"  /></a> and <a  class="image"><img alt="Plotmatrix help English files image018.gif" src="../images/Plotmatrix/Plotmatrix_help_English_files_image018.gif?v=261" width="15"  /></a>.
</p><p>For a given confidence level of <a  class="image"><img alt="Plotmatrix help English files image022.gif" src="../images/Plotmatrix/Plotmatrix_help_English_files_image022.gif?v=263" width="45"  /></a>, the constant <a  class="image"><img alt="Plotmatrix help English files image024.gif" src="../images/Plotmatrix/Plotmatrix_help_English_files_image024.gif?v=264" width="12"  /></a>is:
</p><p>1)  Confidence ellipse for the population mean:
</p>
<dl><dd><a  class="image"><img alt="Plotmatrix help English files image026.gif" src="../images/Plotmatrix/Plotmatrix_help_English_files_image026.gif?v=265" width="155"  /></a></dd></dl>
<p>2)  Confidence ellipse for prediction:
</p>
<dl><dt><a  class="image"><img alt="Plotmatrix help English files image028.gif" src="../images/Plotmatrix/Plotmatrix_help_English_files_image028.gif?v=266" width="189"  /></a></dt></dl>
<p>The inclination angle <a  class="image"><img alt="Plotmatrix help English files image030.gif" src="../images/Plotmatrix/Plotmatrix_help_English_files_image030.gif?v=267" width="17"  /></a> of the ellipse indicates the angle from the <a  class="image"><img alt="Plotmatrix help English files image016.gif" src="../images/Plotmatrix/Plotmatrix_help_English_files_image016.gif?v=260" width="19"  /></a> axis deasil. It is computed by the following equation:
</p>
<dl><dt><a  class="image"><img alt="Plotmatrix help English files image033.gif" src="../images/Plotmatrix/Plotmatrix_help_English_files_image033.gif?v=268" width="151"  /></a></dt></dl>
<h2><a name="References"></a><span class="mw-headline">References</span></h2>
<dl><dd>1.  Lewlaw R. Paradowski.1997. <i>Uncertainty Ellipses and Their Application to Interval Estimation of Emitter Position</i>, IEEE Transactions on aerospace and electronic systems. 33. Page:126-133</dd></dl>
<dl><dd>2.  J. Wesley Barnes. 2002. <i>Statistical Analysis for Engineers and Scientists</i>. Tsinghua University, China.</dd></dl>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">Related X-Functions</span></h2>
<p><a href="../../XFunction/X-Function/Corrcoef.html" title="X-Function:Corrcoef">corrcoef</a>
</p>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>confidence, ellipse, linear fit</span></p>






