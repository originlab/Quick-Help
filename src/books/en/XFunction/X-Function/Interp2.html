<h1 class="firstHeading">2.8.14 interp2</h1><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">Menu Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Additional_Information"><span class="tocnumber">3</span> <span class="toctext">Additional Information</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Command_Line_Usage"><span class="tocnumber">4</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#X-Function_Execution_Options"><span class="tocnumber">5</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Variables"><span class="tocnumber">6</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Description"><span class="tocnumber">7</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Algorithm"><span class="tocnumber">8</span> <span class="toctext">Algorithm</span></a>
<ul>
<li class="toclevel-2 tocsection-9"><a href="#Nearest_neighbor_interpolation"><span class="tocnumber">8.1</span> <span class="toctext">Nearest neighbor interpolation</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#.28Random.29Ordinary_Kriging_interpolation"><span class="tocnumber">8.2</span> <span class="toctext">(Random)Ordinary Kriging interpolation</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Random_Renka_Cline"><span class="tocnumber">8.3</span> <span class="toctext">Random Renka Cline</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Random_Shepard"><span class="tocnumber">8.4</span> <span class="toctext">Random Shepard</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#Random_TPS"><span class="tocnumber">8.5</span> <span class="toctext">Random TPS</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#Spline"><span class="tocnumber">8.6</span> <span class="toctext">Spline</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="#Triangle"><span class="tocnumber">8.7</span> <span class="toctext">Triangle</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#Weighting_average"><span class="tocnumber">8.8</span> <span class="toctext">Weighting average</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="#Comparison"><span class="tocnumber">8.9</span> <span class="toctext">Comparison</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-18"><a href="#Reference"><span class="tocnumber">9</span> <span class="toctext">Reference</span></a></li>
<li class="toclevel-1 tocsection-19"><a href="#Related_X-Functions"><span class="tocnumber">10</span> <span class="toctext">Related X-Functions</span></a></li>
</ul>
</div>

<h2><a name="Menu_Information"></a><span class="mw-headline">Menu Information</span></h2>
<p>Interpolate Z from XY
</p>
<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Perform interpolation on XYZ data at a given set of XY values
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">Additional Information</span></h2>
<p>Minimum Origin Version Required: 9.1 SR0
</p><p><br />
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
1.interp2 ixy:=[XYZRandomGaus]"XYZ Random Gaussian"!(D,E) ir:=[XYZRandomGaus]"XYZ Random Gaussian"!(A,B,C) method:=rk pts:=3 smooth:=4;
</code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>XY Values to Interpolate
</td>
<td>ixy
</td>
<td>
<p>Input
</p><p>XYRange
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td> Specify the input XY range for the given XY values.
</td></tr>
<tr>
<td>Input
</td>
<td>ir
</td>
<td>
<p>Input
</p><p>XYZRange
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> Specify the input XYZ range for the group of XYZ data.
</td></tr>
<tr>
<td>Method
</td>
<td>method
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify the interpolation method to be used. 8 methods are available.
<p>Option list:
</p>
<ul><li><i>nr:Nearest</i></li>
<li><i>rk:Random Kriging</i></li>
<li><i>rc:Renka Renka Cline</i></li>
<li><i>rs:Random Shepard</i></li>
<li><i>tps:Random TPS</i></li>
<li><i>sp:Spline</i></li>
<li><i>ta:Triangle</i></li>
<li><i>wa:Weight Average</i></li></ul>
<p>More details can be found in the <a href="#Algorithm">Algorithm</a> section below.
</p>
</td></tr>
<tr>
<td>Search Radius
</td>
<td>radius
</td>
<td>
<p>Input
</p><p>double
</p>
</td>
<td> <center>2</center>
</td>
<td> Specify a search radius. Only available when the <i>method</i> is either <i>Random Kriging</i> or <i>Weight Average</i>.
</td></tr>
<tr>
<td>Minimum Points
</td>
<td>pts
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>2</center>
</td>
<td> Specify a minimum number of points. Only available when the <i>method</i> is <i>Random Kriging</i>.
</td></tr>
<tr>
<td>Smoothing Factor
</td>
<td>smooth
</td>
<td>
<p>Input
</p><p>double
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td> Specify a Kriging or Spline smoothing factor. Only available when the <i>method</i> is either <i>Random Kriging</i> or <i>Spline</i>.
</td></tr>
<tr>
<td>Input Weight
</td>
<td>weight
</td>
<td>
<p>Input
</p><p>vector
</p>
</td>
<td> <center></center>
</td>
<td> Specify a vector as the weight. Only available when the <i>method</i> is <i>Spline</i>.
</td></tr>
<tr>
<td>Weight Function Locality Factor
</td>
<td>nw
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>9</center>
</td>
<td> Specify a weight function locality factor. Only available when the <i>method</i> is <i>Random Shepard</i>.
</td></tr>
<tr>
<td>Quadratic Interpolant Locality Factor
</td>
<td>nq
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>18</center>
</td>
<td> Specify a quadratic interpolant locality factor. Only available when the <i>method</i> is <i>Random Shepard</i>.
</td></tr>
<tr>
<td>Result of Interpolation
</td>
<td>oz
</td>
<td>
<p>Output
</p><p>vector
</p>
</td>
<td> <center>&lt;new&gt;</center>
</td>
<td> Specify where to output the interpolation result.
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>This X-Function is used to interpolate a group of existing xyz data to find z value for given (x,y), using one of eight (8) methods: Nearest, Random Kriging, Random Renka Cline, Random Shepard, Random TPS, Spline, Triangle and Weight Average. 
</p><p>In order to interpolate z from xy, using the <b>interp2</b> X-Function:
</p>
<ol>
<li>In <b>Script Window</b>, run
<pre class="lt" style="font-family:monospace;">interp2 <span style="color: #000080;">-</span>d;</pre>
to open the <b>interp2</b> dialog box.</li>
<li>Pick data (x,y) from worksheet as <b>XY Values To Interpolate</b>, and a range of xyz data as <b>Input</b> for interpolation.</li> 
<li>Select a <b>Method</b> from the drop-down menu.</li>
<li>Assign destination columns as <b>Result of Interpolation</b>.</li>
</ol>
<h2><a name="Algorithm"></a><span class="mw-headline">Algorithm</span></h2>
<p>Interp2 provides estimation of a variable at an unmeasured location from observed values at surrounding locations. There are 8 methods used in X-Function Interp2, the correspondence for each method and algorithm are listed in table below. 
</p>
<table class="dialogcontroltable">
<tr>
<th>Methods
</th>
<th>Algorithm
</th></tr>
<tr>
<td>Nearest
</td>
<td>Nearest-neighbor interpolation
</td></tr>
<tr>
<td>Random Kriging
</td>
<td>Ordinary Kriging interpolation
</td></tr>
<tr>
<td>Random Renka Cline
</td>
<td>Triangle-based Renka Cline interpolation
</td></tr>
<tr>
<td>Random Shepard
</td>
<td>Modification of Shepardâ€™s method interpolation
</td></tr>
<tr>
<td>Random TPS
</td>
<td>Random TPS interpolation
</td></tr>
<tr>
<td>Spline
</td>
<td>Bicubic B-spline interpolation
</td></tr>
<tr>
<td>Triangle
</td>
<td>Triangle-based Renka Cline interpolation
</td></tr>
<tr>
<td>Weight Average
</td>
<td>Inverse Distance Weighting interpolation
</td></tr></table>
<h3><a name="Nearest_neighbor_interpolation"></a><span class="mw-headline">Nearest neighbor interpolation</span></h3>
<p>In the nearest neighbor algorithm, it finds the nearest point of the given to-be-interpolated X and Y values, and then uses this found point's Z value as the interpolated result. This procedure does not include other neighboring points, that will yield a piece-wise-constant interpolation. This algorithm is so simple that its resulting surface is not smooth.
</p>
<h3><a name=".28Random.29Ordinary_Kriging_interpolation"></a><span class="mw-headline">(Random)Ordinary Kriging interpolation</span></h3>
<p>Origin has called this function <a class="external text" href="../../OriginC/OriginC/Ocmath_2d_kriging_scat_(global_function).html">ocmath_2d_kriging_scat</a> to perform ordinary Kriging interpolation. The basic procedure of ordinary Kriging is described as following.
</p><p>Assume <img src="../images/Interp2/math-97f71577a235052536405e4181dbf5cb.png?v=0" title="x_1, x_2, ..., x_n" alt="x_1, x_2, ..., x_n" class="tex"/> are a series of observed random points and <img src="../images/Interp2/math-f753d777102789bbc469e6941d6c51b1.png?v=0" title="z(x_1), z(x_2), ..., z(x_n)" alt="z(x_1), z(x_2), ..., z(x_n)" class="tex"/> are the measured values of the series points respectively. At a given point, <img src="../images/Interp2/math-3e0d691f3a530e6c7e079636f20c111b.png?v=0" title="x_0" alt="x_0" class="tex"/>, which is not measured yet, according to ordinary Kriging, the estimated value, <img src="../images/Interp2/math-1d9ebb4e035ddd08243a67427b57443d.png?v=0" title="z^*(x_0)" alt="z^*(x_0)" class="tex"/>, for this unmeasured point can be derived by a weighted linear combination of the measured points, which can be written as:
</p><p><img src="../images/Interp2/math-ae3994496a3226934f485304929e3a61.png?v=0" title="z^*(x_0) = \sum_{i=1}^nw_iz(x_i)" alt="z^*(x_0) = \sum_{i=1}^nw_iz(x_i)" class="tex"/>
</p><p>where <img src="../images/Interp2/math-aa38f107289d4d73d516190581397349.png?v=0" title="w_i" alt="w_i" class="tex"/> is the weight for its corresponding point.
</p><p>To get the estimated value, <img src="../images/Interp2/math-1d9ebb4e035ddd08243a67427b57443d.png?v=0" title="z^*(x_0)" alt="z^*(x_0)" class="tex"/>, for the unmeasured point <img src="../images/Interp2/math-3e0d691f3a530e6c7e079636f20c111b.png?v=0" title="x_0" alt="x_0" class="tex"/>, it needs to figure out the weight for each measured point, which has contribution to the calculation. 
</p><p>First of all, we need to assumed that the random function for the points is stationary, which makes sure the unbiasedness of result. That is to say, the expected value of the following expression needs to be zero.
</p><p><img src="../images/Interp2/math-2ca1e0b9fe3c0b4e671138aae4e41115.png?v=0" title="E[z^*(x_0)-z(x_0)] = E[\sum_{i=1}^nw_iz(x_i)-z(x_0)] = \sum_{i=1}^nw_iE[z(x_i)]-E[z(x_0)] =0" alt="E[z^*(x_0)-z(x_0)] = E[\sum_{i=1}^nw_iz(x_i)-z(x_0)] = \sum_{i=1}^nw_iE[z(x_i)]-E[z(x_0)] =0" class="tex"/>
</p><p>Obviously, <img src="../images/Interp2/math-bf5db65184bd9c61c3a398d53aa3c5fc.png?v=0" title="E[z(x_i)] = E[z(x_0)] = m" alt="E[z(x_i)] = E[z(x_0)] = m" class="tex"/> here, where <img src="../images/Interp2/math-6f8f57715090da2632453988d9a1501b.png?v=0" title="m" alt="m" class="tex"/> is the mean, so we get <img src="../images/Interp2/math-1f6bfaafdef1df7d3536a37d8424a8ce.png?v=0" title="\sum_{i=1}^nw_i = 1" alt="\sum_{i=1}^nw_i = 1" class="tex"/>.
</p><p>Secondly, it should satisfy the optimal variance for the error. That is to minimize the variance, which shows as the expression below.
</p><p><img src="../images/Interp2/math-d5c87c18840e2e654b0f8bfb4485a5d2.png?v=0" title="\sigma_0^2 = Var[z^*(x_0)-z(x_0)] &#10;= E[((z^*(x_0)-z(x_0))-E[z^*(x_0)-z(x_0)])^2] &#10;= E[(z^*(x_0)-z(x_0))^2] &#10;= E[(\sum_{i=1}^nw_iz(x_i)-z(x_0))^2] &#10;= E[(z(x_0))^2] - 2E[z(x_0)\sum_{i=1}^nw_iz(x_i)] + E[(\sum_{i=1}^nw_iz(x_i))^2]&#10;= C(x_0, x_0) - 2\sum_{i=1}^nw_iC(x_i, x_0) + \sum_{i=1}^n\sum_{j=1}^nw_iw_jC(x_i, x_j)&#10;= minimum" alt="\sigma_0^2 = Var[z^*(x_0)-z(x_0)] &#10;= E[((z^*(x_0)-z(x_0))-E[z^*(x_0)-z(x_0)])^2] &#10;= E[(z^*(x_0)-z(x_0))^2] &#10;= E[(\sum_{i=1}^nw_iz(x_i)-z(x_0))^2] &#10;= E[(z(x_0))^2] - 2E[z(x_0)\sum_{i=1}^nw_iz(x_i)] + E[(\sum_{i=1}^nw_iz(x_i))^2]&#10;= C(x_0, x_0) - 2\sum_{i=1}^nw_iC(x_i, x_0) + \sum_{i=1}^n\sum_{j=1}^nw_iw_jC(x_i, x_j)&#10;= minimum" class="tex"/>
</p><p>To minimize the above expression, the Lagrange parameter <img src="../images/Interp2/math-c9faf6ead2cd2c2187bd943488de1d0a.png?v=0" title="\mu" alt="\mu" class="tex"/> is introduced, and let:
</p><p><img src="../images/Interp2/math-3ad337f73dd5867cdb34c08c8a2d66d9.png?v=0" title="F = \sigma_0^2 - 2\mu (\sum_{i=1}^nw_i - 1)" alt="F = \sigma_0^2 - 2\mu (\sum_{i=1}^nw_i - 1)" class="tex"/>
</p><p>Calculate the partial first derivatives of the above equation with respect to <img src="../images/Interp2/math-aa38f107289d4d73d516190581397349.png?v=0" title="w_i" alt="w_i" class="tex"/> and <img src="../images/Interp2/math-c9faf6ead2cd2c2187bd943488de1d0a.png?v=0" title="\mu" alt="\mu" class="tex"/> and get:
</p><p><img src="../images/Interp2/math-7e299ed45d6faaa620af5108b3937850.png?v=0" title="\left\{\begin{matrix}\frac{\partial F}{\partial w_i} = 2\sum_{j=1}^nw_jC(x_i, x_j) - 2C(x_i, x_0) - 2\mu = 0&#10;\\ \frac{\partial F}{\partial \mu} = -2(\sum_{i=1}^nw_i-1) = 0&#10;\end{matrix}\right." alt="\left\{\begin{matrix}\frac{\partial F}{\partial w_i} = 2\sum_{j=1}^nw_jC(x_i, x_j) - 2C(x_i, x_0) - 2\mu = 0&#10;\\ \frac{\partial F}{\partial \mu} = -2(\sum_{i=1}^nw_i-1) = 0&#10;\end{matrix}\right." class="tex"/>
</p><p>Then we get the simplified one:
</p><p><img src="../images/Interp2/math-7a289b7cf34cb3fee6eb9326b8f53f3a.png?v=0" title="\left\{\begin{matrix}\sum_{j=1}^nw_jC(x_i, x_j) - \mu = C(x_i, x_0)&#10;\\ \sum_{i=1}^nw_i = 1&#10;\end{matrix}\right." alt="\left\{\begin{matrix}\sum_{j=1}^nw_jC(x_i, x_j) - \mu = C(x_i, x_0)&#10;\\ \sum_{i=1}^nw_i = 1&#10;\end{matrix}\right." class="tex"/>
</p><p>and <img src="../images/Interp2/math-ba81065a6646676fa8726518cd83d4ac.png?v=0" title="\sigma_0^2 = C(x_0, x_0) - \sum_{i=1}^nw_iC(x_i, x_0) + \mu" alt="\sigma_0^2 = C(x_0, x_0) - \sum_{i=1}^nw_iC(x_i, x_0) + \mu" class="tex"/>
</p><p>Let:
</p><p><img src="../images/Interp2/math-a2ce9a6cb1de416a3cc9c54d63bf317d.png?v=0" title="C = \begin{bmatrix}C(x_1, x_1) &amp; C(x_1, x_2) &amp; \cdots &amp; C(x_1, x_n) &amp; 1&#10;\\ C(x_2, x_1) &amp; C(x_2, x_2) &amp; \cdots &amp; C(x_2, x_n) &amp; 1&#10;\\ \vdots &amp; \vdots &amp; \: &amp; \vdots &amp; \vdots&#10;\\ C(x_n, x_1) &amp; C(x_n, x_2) &amp; \cdots &amp; C(x_n, x_n) &amp; 1&#10;\\ 1 &amp; 1 &amp; \cdots &amp; 1 &amp; 0&#10;\end{bmatrix},&#10;W = \begin{bmatrix}w_1 \\ w_2 \\ \vdots \\ w_n \\ -\mu\end{bmatrix},&#10;D = \begin{bmatrix}C(x_1, x_0) \\ C(x_2, x_0) \\ \vdots \\ C(x_n, x_0) \\ 1\end{bmatrix}&#10;" alt="C = \begin{bmatrix}C(x_1, x_1) &amp; C(x_1, x_2) &amp; \cdots &amp; C(x_1, x_n) &amp; 1&#10;\\ C(x_2, x_1) &amp; C(x_2, x_2) &amp; \cdots &amp; C(x_2, x_n) &amp; 1&#10;\\ \vdots &amp; \vdots &amp; \: &amp; \vdots &amp; \vdots&#10;\\ C(x_n, x_1) &amp; C(x_n, x_2) &amp; \cdots &amp; C(x_n, x_n) &amp; 1&#10;\\ 1 &amp; 1 &amp; \cdots &amp; 1 &amp; 0&#10;\end{bmatrix},&#10;W = \begin{bmatrix}w_1 \\ w_2 \\ \vdots \\ w_n \\ -\mu\end{bmatrix},&#10;D = \begin{bmatrix}C(x_1, x_0) \\ C(x_2, x_0) \\ \vdots \\ C(x_n, x_0) \\ 1\end{bmatrix}&#10;" class="tex"/>
</p><p>Then the partial first derivatives can be expanded and rewritten as matrix form, <img src="../images/Interp2/math-ff108b929d78cdee4ecec24309fabd35.png?v=0" title="C\cdot W = D" alt="C\cdot W = D" class="tex"/>
</p><p>To solve for the weights, multiply both sides of the matrix form by <img src="../images/Interp2/math-a47dc6dce0f5dcbdf98b9f9acaedbd10.png?v=0" title="C^{-1}" alt="C^{-1}" class="tex"/>, the inverse matrix of the <img src="../images/Interp2/math-0d61f8370cad1d412f80b84d143e1257.png?v=0" title="C" alt="C" class="tex"/> matrix, so to get <img src="../images/Interp2/math-0d1991e0e0459c51aed8bdf1b3e24c6b.png?v=0" title="W = C^{-1}\cdot D" alt="W = C^{-1}\cdot D" class="tex"/>.
</p><p>The final step is to decide the covariance. For all the above calculations are based on the assumption that the random variables in random function model all have the same mean and variance. Such assumption leads us to the relationship between the model variogram and the model covariance as following.
</p><p><img src="../images/Interp2/math-6c614358c8aad228784cd121545158ed.png?v=0" title="\gamma (x_i, x_j) = \frac{1}{2}E[(z(x_i)-z(x_j))^2] = \frac{1}{2}E[(z(x_i))^2] + \frac{1}{2}E[(z(x_j))^2] - E[z(x_i) \cdot z(x_j)] = E[z^2]-E[z(x_i) \cdot z(x_j)] = (E[z^2] - m^2)-(E[z(x_i) \cdot z(x_j)] - m^2) = \sigma^2-C(x_i, x_j)" alt="\gamma (x_i, x_j) = \frac{1}{2}E[(z(x_i)-z(x_j))^2] = \frac{1}{2}E[(z(x_i))^2] + \frac{1}{2}E[(z(x_j))^2] - E[z(x_i) \cdot z(x_j)] = E[z^2]-E[z(x_i) \cdot z(x_j)] = (E[z^2] - m^2)-(E[z(x_i) \cdot z(x_j)] - m^2) = \sigma^2-C(x_i, x_j)" class="tex"/>
</p><p><br />
Put this relationship equation to the partial first derivatives, we can get another form (the matrix form is similar):
</p><p><img src="../images/Interp2/math-c615089707a749496528a86b7867b46c.png?v=0" title="\left\{\begin{matrix}\sum_{j=1}^nw_j\gamma (x_i, x_j) + \mu =\gamma (x_i, x_0)&#10;\\ \sum_{i=1}^nw_i = 1&#10;\end{matrix}\right." alt="\left\{\begin{matrix}\sum_{j=1}^nw_j\gamma (x_i, x_j) + \mu =\gamma (x_i, x_0)&#10;\\ \sum_{i=1}^nw_i = 1&#10;\end{matrix}\right." class="tex"/>
</p><p>In Origin, the power model is used for estimating the varigram, which is:
</p><p><img src="../images/Interp2/math-3475e8bd03c599a5c584ce940dd85bed.png?v=0" title="\gamma (h) = \left\{\begin{matrix}0 \;\;\;\;\;\;\;\;\;\;\;\;\;\; |h| = 0&#10;\\ a + b|h|^\lambda \;\;\;\; |h| &gt; 0&#10;\end{matrix}\right." alt="\gamma (h) = \left\{\begin{matrix}0 \;\;\;\;\;\;\;\;\;\;\;\;\;\; |h| = 0&#10;\\ a + b|h|^\lambda \;\;\;\; |h| &gt; 0&#10;\end{matrix}\right." class="tex"/>
</p><p>where <img src="../images/Interp2/math-6d15f14cbcc8d335e7f317cbd3fe04af.png?v=0" title="a = 0, b = 1" alt="a = 0, b = 1" class="tex"/>, and <img src="../images/Interp2/math-2860c05f82192c0f31751cab337cbfb8.png?v=0" title="0 &lt; \lambda &lt; 2" alt="0 &lt; \lambda &lt; 2" class="tex"/>. <img src="../images/Interp2/math-2510c39011c5be704182423e3a695e91.png?v=0" title="h" alt="h" class="tex"/> can refer to the distance between <img src="../images/Interp2/math-1ba8aaab47179b3d3e24b0ccea9f4e30.png?v=0" title="x_i" alt="x_i" class="tex"/> and <img src="../images/Interp2/math-1f89889020cdc84d9e1c35237cb62f65.png?v=0" title="x_j" alt="x_j" class="tex"/>, so <img src="../images/Interp2/math-61957245cce023557f0dc99589c6060f.png?v=0" title="\gamma (h) = \gamma (x_i, x_j)" alt="\gamma (h) = \gamma (x_i, x_j)" class="tex"/>
</p><p>In the dialog of this X-Function, when this method is used, <img src="../images/Interp2/math-c6a6eb61fd9c6c913da73b3642ca147d.png?v=0" title="\lambda" alt="\lambda" class="tex"/> corresponds to the <b>Smoothing Factor</b>, and <b>Search Radius</b> (for the search radius) and <b>Minimum Points</b> (minimum points included for interpolation) correspond to the <i>radius</i> and <i>noctMin</i> parameters in function <a class="external text" href="http://www.originlab.com/doc/OriginC/ref/ocmath_2d_kriging_scat" target="_blank">ocmath_2d_kriging_scat</a> respectively.
</p>
<h3><a name="Random_Renka_Cline"></a><span class="mw-headline">Random Renka Cline</span></h3>
<p>The algorithm of the Random Renka Cline is based on <i><a class="external text" href="https://www.originlab.com/pdfs/nagcl09/manual/pdf/E01/e01sac.pdf" target="_blank">nag_2d_scat_interpolant</a></i> (e01sac) function provided by NAG. However, according to the <i>NAG Library: Advice on Replacement Calls for Withdrawn/Superseded Functions</i>, the <i><a class="external text" href="https://www.originlab.com/pdfs/nagcl09/manual/pdf/E01/e01sac.pdf" target="_blank">nag_2d_scat_interpolant</a></i> (e01sac) is replaced by <i><a class="external text" href="https://d2mvzyuse3lwjc.cloudfront.net/pdfs/NAG26/Manual/html/e01/e01sgc.html" target="_blank">nag_2d_shep_interp</a></i> (e01sgc) or <i><a class="external text" href="https://d2mvzyuse3lwjc.cloudfront.net/pdfs/NAG26/Manual/html/e01/e01sjc.html" target="_blank">nag_2d_triang_interp</a></i> (e01sjc). Thus, the Random Renka Cline method has the algorithm similar to Triangle method which based on <i><a class="external text" href="https://d2mvzyuse3lwjc.cloudfront.net/pdfs/NAG26/Manual/html/e01/e01sjc.html" target="_blank">nag_2d_triang_interp</a></i> (e01sjc), while the latter is recommended due to the smaller maximum interpolation errors could be obtained.
</p>
<h3><a name="Random_Shepard"></a><span class="mw-headline">Random Shepard</span></h3>
<p>Please refer to the <a class="external text" href="../../UserGuide/UserGuide/Gridding_Methods_for_Randomly_Spaced_Data.html#Shepard">(Random) Shepard</a> for algorithm introduction.
</p>
<h3><a name="Random_TPS"></a><span class="mw-headline">Random TPS</span></h3>
<p>Please refer to the <a class="external text" href="../../UserGuide/UserGuide/Gridding_Methods_for_Randomly_Spaced_Data.html#Thin_Plate_Spline_.28TPS.29">Random TPS</a> for algorithm introduction.
</p>
<h3><a name="Spline"></a><span class="mw-headline">Spline</span></h3>
<p>This method based on the <i><a class="external text" href="https://d2mvzyuse3lwjc.cloudfront.net/pdfs/NAG26/Manual/html/e02/e02ddc.html" target="_blank">nag_2d_spline_fit_scat</a></i> (e02ddc) which computes a bicubic spline approximation to a set of scattered data. 
</p>
<h3><a name="Triangle"></a><span class="mw-headline">Triangle</span></h3>
<p>This method involves firstly creating Delaunay triangles by connecting all data points. The triangles are as nearly equiangular as possible and no two triangles should intersect. Refer to <a class="external text" href="../../UserGuide/UserGuide/Creating_Contour_Graphs.html#Triangulation">this document</a> for the triangulation theory.
</p><p>After the triangulation been created, the triangle-based interpolation method computes a value at a point based only on data values and first partial derivatives at the three vertices of the triangle containing the point. It calls <a class="external text" href="https://d2mvzyuse3lwjc.cloudfront.net/pdfs/NAG26/Manual/html/e01/e01sjc.html" target="_blank">nag_2d_triang_interp</a> (e01sjc), which uses a method due to Renka and Cline. 
</p><p><br />
</p>
<h3><a name="Weighting_average"></a><span class="mw-headline">Weighting average</span></h3>
<p>The weighted average method is based on <a class="external text" href="../../OriginC/OriginC/Ocmath_gridding_weighted_average_(global_function).html">ocmath_gridding_weighted_average</a>. The unknown value <img src="../images/Interp2/math-7c8e639ee0f96691256a24e9353459a6.png?v=0" title="P(x_p, y_p, z_p)" alt="P(x_p, y_p, z_p)" class="tex"/> can be calculated from the surrounded true values <img src="../images/Interp2/math-52dbc3fd7d34cbe6ae695944dca0004d.png?v=0" title="Q_i" alt="Q_i" class="tex"/> within the specified search radius r. The interpolate value can be expressed by:
</p><p><img src="../images/Interp2/math-c3d89da1788e716717a103c968a9b94d.png?v=0" title="Z_p=\frac{\sum_{i=1}^{n}\frac{Z_i}{3d_i^2+1}}{\sum_{i=1}^{n}\frac{1}{3d_i^2+1}}" alt="Z_p=\frac{\sum_{i=1}^{n}\frac{Z_i}{3d_i^2+1}}{\sum_{i=1}^{n}\frac{1}{3d_i^2+1}}" class="tex"/>
</p><p><img src="../images/Interp2/math-d247f594c78d0d2be10fc6d82512cc4e.png?v=0" title="d_i" alt="d_i" class="tex"/> is the distance between <img src="../images/Interp2/math-44c29edb103a2872f519ad0c9a0fdaaa.png?v=0" title="P" alt="P" class="tex"/> and <img src="../images/Interp2/math-52dbc3fd7d34cbe6ae695944dca0004d.png?v=0" title="Q_i" alt="Q_i" class="tex"/>. If there is no value within the search radius, Zp will be missing value. Increasing the search radius means that each point is more interrelated to neighboring points, so to produce a smoother surface that may lose fine details.
</p>
<h3><a name="Comparison"></a><span class="mw-headline">Comparison</span></h3>
<p>Here we offer the comparison of the eight methods. We apply the eight methods to six functions from F1 to F6, which corresponds to exponential peak, cliff surface, saddle surface, gentle peak, steep peak, and sphere surface, respectively. The method is derived from Ref. 2.  The interpolation for 1089 points is based on 100 nodes uniform distribution. Mean error and Maximum error are average and max of the difference between real values and interpolated values for 1089 points, respectively. The bar chart for mean error and maximum error are shown below:
</p><p><a  class="image"><img alt="Analysis 3.png" src="../images/Interp2/Analysis_3.png?v=78135" width="800"  /></a>
</p><p>Function expressionï¼š
</p><p><img src="../images/Interp2/math-f279a48ea3841522396bbc6f10f6537f.png?v=0" title="F1: 0.75e^{-\frac{(9x-2)^2+(9y-2)^2}{4}}+0.75e^{\frac{-(9x+1)^2}{49}-\frac{9y+1}{10}}+0.5e^{-\frac{(9x-7)^2+(9y-3)^2}{4}}-0.2e^{-(9x-4)^2-(9y-7)^2}" alt="F1: 0.75e^{-\frac{(9x-2)^2+(9y-2)^2}{4}}+0.75e^{\frac{-(9x+1)^2}{49}-\frac{9y+1}{10}}+0.5e^{-\frac{(9x-7)^2+(9y-3)^2}{4}}-0.2e^{-(9x-4)^2-(9y-7)^2}" class="tex"/>
</p><p><img src="../images/Interp2/math-442e7cb498cbdd3e8a8cb11de7076b9c.png?v=0" title="F2: \frac{tanh(9y-9x)+1}{9}" alt="F2: \frac{tanh(9y-9x)+1}{9}" class="tex"/>
</p><p><img src="../images/Interp2/math-8a323f741771c259f3d0251ec3713ff5.png?v=0" title="F3: \frac{1.25+cos(5.4y)}{6+6(3x-1)^2}" alt="F3: \frac{1.25+cos(5.4y)}{6+6(3x-1)^2}" class="tex"/>
</p><p><img src="../images/Interp2/math-15b5909afabd4efcf3399e446cde9039.png?v=0" title="F4: e^{\frac{-(81/16)((x-0.5)^2+(y-0.5)^2)}{3}}" alt="F4: e^{\frac{-(81/16)((x-0.5)^2+(y-0.5)^2)}{3}}" class="tex"/>
</p><p><img src="../images/Interp2/math-b12a75f2b61e2745aa115538c148f83e.png?v=0" title="F5: e^{\frac{-(81/4)((x-0.5)^2+(y-0.5)^2)}{3}}" alt="F5: e^{\frac{-(81/4)((x-0.5)^2+(y-0.5)^2)}{3}}" class="tex"/>
</p><p><img src="../images/Interp2/math-c4ca4ef5e4f555321474d4e6f24a1aec.png?v=0" title="F6: \frac{\sqrt{64-81((x-0.5)^2+(y-0.5)^2}}{9}-0.5" alt="F6: \frac{\sqrt{64-81((x-0.5)^2+(y-0.5)^2}}{9}-0.5" class="tex"/>
</p>
<h2><a name="Reference"></a><span class="mw-headline">Reference</span></h2>
<ol><li> Isaaks and Srivastava. An Introduction to Applied Geostatistics, Chapter 12. Oxford University Press (1989)</li>
<li> R. J. Renka and A. K. Cline. A Triangle-Based <img src="../images/Interp2/math-e462b7e236c081548166a08ba6b20e24.png?v=0" title="C^1" alt="C^1" class="tex"/> Interpolation Method, Rocky Mountain Journal of Mathematics. 14, 223-237 (1984)</li>
<li> P. Dierckx. An Algorithm for Surface-Fitting with Spline Functions, IMA Journal of Numerical Analysis. 1, 267-283 (1981)</li></ol>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">Related X-Functions</span></h2>
<p><a href="../../XFunction/X-Function/Interpxyz.html" title="X-Function:Interpxyz">interpxyz</a>
</p>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>interpolate</span></p>






