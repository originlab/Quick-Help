<h1 class="firstHeading">2.2.11 levelcrossing</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Brief_Information"><span class="tocnumber">1</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Command_Line_Usage"><span class="tocnumber">2</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#X-Function_Execution_Options"><span class="tocnumber">3</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Variables"><span class="tocnumber">4</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Description"><span class="tocnumber">5</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Examples"><span class="tocnumber">6</span> <span class="toctext">Examples</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#Example1"><span class="tocnumber">6.1</span> <span class="toctext">Example1</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Example_2"><span class="tocnumber">6.2</span> <span class="toctext">Example 2</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Find X values at a given Y value
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
1. levelcrossing iy:=col(2) level:=2;
</p><p>2. levelcrossing iy:=col(2) level:=500 direction:=&lt;new&gt; xindex:=&lt;new&gt; type:=left pts:=2;
</code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Input
</td>
<td>iy
</td>
<td>
<p>Input
</p><p>XYRange
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> Specify the input dataset.
</td></tr>
<tr>
<td>Crossing Level
</td>
<td>level
</td>
<td>
<p>Input
</p><p>double
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify the Y value for the level. Then the X-Function will detect the crossings for this level.
</td></tr>
<tr>
<td>
</td>
<td>ncrossing
</td>
<td>
<p>Output
</p><p>int
</p>
</td>
<td> <center>&lt;new&gt;</center>
</td>
<td> Specify the output for the number of the crossing points. This variable is not shown in the dialog box, but you can get the value of this variable by running <code>levelcrossing.ncrossing=;</code> in the Command Window after executing this X-Function.
</td></tr>
<tr>
<td>X Values of Crossing
</td>
<td>oy
</td>
<td>
<p>Output
</p><p>vector
</p>
</td>
<td> <center>&lt;new&gt;</center>
</td>
<td> Specify the output for the X values of the crossing points, and designated as X column.
</td></tr>
<tr>
<td>Directions
</td>
<td>direction
</td>
<td>
<p>Output
</p><p>vector
</p>
</td>
<td> <center>&lt;new&gt;</center>
</td>
<td> Specify the output for the directions of the crossing behaviors, 1 for upward, -1 for downward, and 0 for differentiation is zero, and designated as Y column.
</td></tr>
<tr>
<td>X Indices
</td>
<td>xindex
</td>
<td>
<p>Output
</p><p>vector
</p>
</td>
<td> <center>&lt;new&gt;</center>
</td>
<td> Specify the output for the X indices of the crossing points, designated as Label column.
</td></tr>
<tr>
<td>Y Crossing Values
</td>
<td>yval
</td>
<td>
<p>Output
</p><p>vector
</p>
</td>
<td> <center>&lt;new&gt;</center>
</td>
<td> Specify the output for the Y values, which will all be the same as input level crossing value, designated as Y column.
</td></tr>
<tr>
<td>Nearest Type
</td>
<td>type
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify how to output the X index of the crossing point when the crossing point is interpolated but not the point of the original data.
<p>Option list:
</p>
<ul><li><i>any:Any</i>
<dl><dd>The index of the point, which is closest to the crossing point, will be output.</dd></dl></li>
<li><i>left:Left</i>
<dl><dd>The index of the point, which is to the "left" side of the crossing point, will be output.</dd></dl></li>
<li><i>right:Right</i>
<dl><dd>The index of the point, which is to the "right" side of the crossing point, will be output.</dd></dl></li></ul>
</td></tr>
<tr>
<td>Duration Points
</td>
<td>pts
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> This variable is used to control the output of a pair of level crossing points. The distance (indices) of the pair of points should not be less the specified duration, or both crossing points will be discarded. Only positive integer is acceptable. Duration should not be larger than Deadtime.
</td></tr>
<tr>
<td>Deadtime Points
</td>
<td>deadtime
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> This variable determines how a level crossing point is treated as valid and output.
<ul><li> The first found level crossing point will be treated as "valid". </li>
<li> If other crossing points are found in the deadtime distance (indices) following the first point, they will be considered as "invalid" and thus ignored. </li>
<li> If the next found crossing point is out of the deadtime distance (indices), 
<ul><li> if the point falls in the duration (indices) following the first point, both this point and the first will be considered as "invalid" and thus ignored. </li>
<li> if the point locates out of the duration (indices) following the first point, this point will be considered as "valid" and output.</li></ul></li></ul>
<p>... and so forth
</p><p>Only positive integer is acceptable.
</p>
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>This X-Function finds the locations (X values) where the input curve crosses a specified level. For example, if you set the level to be 0, the zero crossing points (where the curve passes 0) will be output. Such zero crossing points could be meaningful for some special curves. Outputs are selectable, including X values, X indices, crossing directions, and Y crossing values. Also, duration can be specified to get rid of some noise.
</p><p>Note that linear interpolation could be used to get the locations.
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<h3><a name="Example1"></a><span class="mw-headline">Example1</span></h3>
<p>In the following example, we will find the locations where the curve crosses 500.
</p>
<dl><dd><a  class="image"><img alt="Levelcrossing 1.png" src="../images/Levelcrossing/Levelcrossing_1.png?v=12443" width="421"  /></a> </dd></dl>
<ol><li> Use the Import Wizard to import the data <i>&lt;Origin Installation Directory&gt;\Samples\graphing\waterfall.dat</i> into an empty worksheet.</li>
<li> Highlight col(B) and open the <b>levelcrossing</b> dialog by entering <code>levelcrossing -d;</code> in the Command Window.</li>
<li> Enter <b>500</b> after <b>Crossing Level</b>. Other settings as following image shows.
<dl><dd><a  class="image"><img alt="Levelcrossing 2.png" src="../images/Levelcrossing/Levelcrossing_2.png?v=16488" width="389"  /></a></dd></dl></li>
<li> Click the <b>OK</b> button, four new columns will be added to the worksheet, and the X coordinates corresponding to the 500 level, crossing directions, the X indices and Y crossing values will be output there. 
<dl><dd><a  class="image"><img alt="Levelcrossing 3.png" src="../images/Levelcrossing/Levelcrossing_3.png?v=16489" width="435"  /></a> </dd></dl></li>
<li> Run <code>levelcrossing.ncrossing=;</code> in the Command Window, the number of intersection points will be shown as:</li></ol>
<pre>
  LEVELCROSSING.NCROSSING=8
</pre>
<h3><a name="Example_2"></a><span class="mw-headline">Example 2</span></h3>
<p>This example is to show you how the duration and deadtime effect the result you get.
</p>
<ol><li> Create a new workbook. Import data <i>&lt;Origin Installation Directory&gt;\Samples\Curve Fitting\Multiple Peaks.dat</i> by <b>Data: Import From Files: Single ASCII</b>.</li>
<li> Highlight col(C) and open the <b>levelcrossing</b> dialog by entering <code>levelcrossing -d;</code> in the Command Window.</li>
<li> Enter <b>100</b> for <b>Crossing Level</b>, <b>5</b> for <b>Duration Points</b>. Leave other settings as default.
<dl><dd><a  class="image"><img alt="Levelcrossing 4.png" src="../images/Levelcrossing/Levelcrossing_4.png?v=82788" width="417"  /></a></dd></dl></li>
<li> In the source worksheet, click the green lock and select <b>Change Parameters</b>. This time, enter <b>10</b> for <b>Duration Points</b> and <b>20</b> for <b>Deadtime Points</b>.
<dl><dd><a  class="image"><img alt="Levelcrossing 5.png" src="../images/Levelcrossing/Levelcrossing_5.png?v=82789" width="417"  /></a> </dd></dl></li></ol>
<p><br />
</p>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>crossing, threshold</span></p>






