<h1 class="firstHeading">2.7.9 expGraph</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">Menu Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Command_Line_Usage"><span class="tocnumber">3</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#X-Function_Execution_Options"><span class="tocnumber">4</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Variables"><span class="tocnumber">5</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Description"><span class="tocnumber">6</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Examples"><span class="tocnumber">7</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Related_X-Functions"><span class="tocnumber">8</span> <span class="toctext">Related X-Functions</span></a></li>
</ul>
</div>

<h2><a name="Menu_Information"></a><span class="mw-headline">Menu Information</span></h2>
<p>File&#160;: Export Graphs (Advanced)   
<br />(When Graph window is active)
</p>
<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Export graphs as raster or vector files
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
1. expGraph type:=jpg path:= "c:\image";  
</p><p>2. expGraph type:=bmp path:= "&lt;User Files Folder&gt;" tr1.width:=300 tr1.unit:=2; 
</p><p>3. expGraph pages:=graph2 type:=psd path:= "&lt;Project Folder&gt;&lt;PE Path&gt;" tr1.width:=50 tr1.unit:=3; 
</p><p>4. expGraph type:=pdf  overwrite:=rename export:=specified pages:=2!; //sheet range (index)
</p><p>5. expGraph type:=png filename:="&lt;long name&gt;" export:=specified pages:=col(A)[3]; // cell range
</p><p>6. expGraph -theme "5 Inch Width" type:=eps path:= "c:\image";
</p><p>7. expGraph type:=eps path:= "c:\image" tr.OpenGLGraph.AntiAlias:=2;
</p><p>8. expgraph -t &lt;book&gt; path:="c:\test" tr1.Unit:=2 tr1.Width:=600;
</p><p></code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Image Type
</td>
<td>type
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>eps</center>
</td>
<td> The exported image type for the file. The default option is Encapsulated Postscript (*.eps).
<p>Option list:
</p>
<ul><li><i>ai:AI</i> {0}</li></ul>
<dl><dd>Adobe Illustrator, vector format </dd>
<dd>Note: AI option is hidden from Origin 2017. To export graph as AI, set @HAI=0 first. Refer to <a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#H.2CI.2CJ.2CK">system variable list</a> for details.</dd></dl>
<ul><li><i>bmp:BMP</i> {1}</li></ul>
<dl><dd>Bitmap, raster format </dd></dl>
<ul><li><i>cgm:CGM</i> {2}</li></ul>
<dl><dd>Computer Graphics Metafile, vector format, note that this format is not supported in 64-bit version</dd></dl>
<ul><li><i>dxf:DXF</i> {3}</li></ul>
<dl><dd>AutoCAD Drawing Interchange, vector format, note that this format is not supported in 64-bit version</dd></dl>
<ul><li><i>emf:EMF</i> {4}</li></ul>
<dl><dd>Enhanced Metafile, vector format </dd></dl>
<ul><li><i>eps:EPS</i> {5}</li></ul>
<dl><dd>Encapsulated PostScript, vector format</dd></dl>
<ul><li><i>gif:GIF</i> {6}</li></ul>
<dl><dd>Graphics Image Format, raster format </dd></dl>
<ul><li><i>jpg:JPG</i> {7}</li></ul>
<dl><dd>JPEG, Joint Photographic Experts Group, raster format</dd></dl>
<ul><li><i>pcx:PCX</i> {8}</li></ul>
<dl><dd>Zsoft PC Paintbrush Bitmap, raster format</dd></dl>
<ul><li><i>pdf:PDF</i> {9}</li></ul>
<dl><dd>Portable Document Format, vector format </dd></dl>
<ul><li><i>png:PNG</i> {10}</li></ul>
<dl><dd>Portable Network Graphics, raster format </dd></dl>
<ul><li><i>psd:PSD</i> {11}</li></ul>
<dl><dd>Adobe PhotoShop, raster format</dd></dl>
<ul><li><i>tga:TGA</i> {12}</li></ul>
<dl><dd>Truevision Targa, raster format </dd></dl>
<ul><li><i>tif:TIF</i> {13}</li></ul>
<dl><dd>TIFF, Tag Image File, raster format </dd></dl>
<ul><li><i>wmf:WMF</i> {14}</li></ul>
<dl><dd>Windows Metafile, vector format</dd></dl>
<ul><li><i>svg:SVG</i> {15}</li></ul>
<dl><dd>Scalable Vector Graphics, vector format</dd></dl>
</td></tr>
<tr>
<td>Select Graph(s)
</td>
<td>export
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>page</center>
</td>
<td> Use this option to select the page(s) to be exported. The default option is Active Page.
<p>Option list:
</p>
<ul><li><i>page:Active Page</i></li></ul>
<dl><dd>the active graph page will be exported</dd></dl>
<ul><li><i>folder:All in Active Folder</i></li></ul>
<dl><dd>All the graph pages in active folder of the project (see this in Project Explorer) will be exported. The pages in subfolders will not be included. Hidden pages will also be included, while embedded graph pages in worksheet will not be included. </dd></dl>
<ul><li><i>recursive:All in Active Folder (Recursive)</i></li></ul>
<dl><dd>All the graph pages in active folder of the project (see this in Project Explorer) will be exported. The subfolders will be recursively included.</dd></dl>
<ul><li><i>open:All in Active Folder (Open)</i></li></ul>
<dl><dd>All the opened (not hidden) pages in active folder of the project will be exported.</dd></dl>
<ul><li><i>embed:All in Active Folder (Include Embedded)</i></li></ul>
<dl><dd>All the graph pages in active folder of the project (see this in Project Explorer) will be exported. Both hidden pages and embedded pages will be included.</dd></dl>
<ul><li><i>project:All in Project</i></li></ul>
<dl><dd>All the graph pages in the project will be exported. Hidden graph pages will be included while embedded pages will not.</dd></dl>
<ul><li><i>specified:Specified</i></li></ul>
<dl><dd>Other than the options above. Specify the pages in Graph Page below.</dd></dl>
</td></tr>
<tr>
<td>Graph Page
</td>
<td>pages
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> Select the graph pages in the project to be exported. Click the browse button to open Graph Browser to select the graph pages. The graph pages to be exported can be specified using cell ranges or sheet ranges to accommodate export of embedded graphs. See examples in <b>Command Line Usage</b>.
</td></tr>
<tr>
<td>Export as multi-page PDF file
</td>
<td>multipage
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Export the multiple graph pages to one PDF file with multi-pages.
</td></tr>
<tr>
<td>File Name(s)
</td>
<td>filename
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center></center>
</td>
<td> The name(s) for the exported image file(s).
<ul><li>&lt;Long Name&gt;: use the long name of the graph page as file name. </li>
<li>&lt;Short Name&gt;: use the short name of the graph page as file name.</li>
<li>Graph ##: use Graph + index (in the same order as listed in GraphPage) as file name.</li>
<li>Graph&lt;pound&gt;#: use "graph# + index" (in the same order as listed in the Graph Page list) and character "#"(represented by &lt;pound&gt;) combined together as file name.</li></ul>
<p>Note: 
</p>
<ol><li>File Name supports keyword combination, such as <i>&lt;longname&gt;-multi</i>, the long name of the graph and the string <i>-multi</i> will be used as the export file name.</li>
<li>&lt;pound&gt;, representing the character "#", can also be used without combining with graph index. For example, Set File Name(s) as <i>Graph&lt;pound&gt;2</i> then the display graph name would be <i>Graph#2</i>.</li></ol>
</td></tr>
<tr>
<td>Path
</td>
<td>path
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center></center>
</td>
<td> The file path to save the exported image file(s).
</td></tr>
<tr>
<td>Overwrite Existing
</td>
<td>overwrite
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>ask</center>
</td>
<td> To specify if the existing file(s) in the path should be overwritten. Ask is the default option.
<p>Option list:
</p>
<ul><li><i>rename:Auto Rename</i></li></ul>
<dl><dd>Auto rename with enumeration</dd></dl>
<ul><li><i>replace:Replace</i></li></ul>
<dl><dd>Replace the existing file(s)</dd></dl>
<ul><li><i>skip:Skip</i></li></ul>
<dl><dd>Skip the existing file(s)</dd></dl>
<ul><li><i>ask:Ask</i></li></ul>
<dl><dd>Pop up message box to ask if overwrite or not.</dd></dl>
</td></tr>
<tr>
<td>Graph Theme
</td>
<td>theme
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center></center>
</td>
<td> Graph theme which is used to applied on the exported pages
<p>Any Theme saved in the theme organizer can be used with this variable.
</p>
</td></tr>
<tr>
<td>Use Preference Options
</td>
<td>sysopts
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> Whether to use Page settings from Preference Option dialog.
<p>Default is used.
This is not visible in GUI and only used in script.
</p>
</td></tr>
<tr>
<td>Export Settings
</td>
<td>tr
</td>
<td>
<p>Input
</p><p>TreeNode
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td> Page settings for export
</td></tr>
<tr>
<td>Keep Original Size
</td>
<td>keepsize
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Whether to keep original graph size.
<p>Default is keep.
This is not visible in GUI and only used in script.
</p>
</td></tr>
<tr>
<td>Image Size
</td>
<td>tr1
</td>
<td>
<p>Input
</p><p>TreeNode
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td> Set the size for the exported image.
</td></tr>
<tr>
<td>Image Settings
</td>
<td>tr2
</td>
<td>
<p>Input
</p><p>TreeNode
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td> Set properties of the exported image.
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>This X-Function exports the graph(s) in Origin to various image file(s). It has a graphical user interface (GUI) with previews. In the left panel, there are settings for the functions. In the right, there are two tabs, one is Image, which displays a preview for the exported image, and the other is Graph, which displays a cloned graph page for the source page to be exported.
</p><p><b>Supported Formats</b>
</p><p>Totally 14 image file formats are supported for exporting to image file. These files fall into two categories:
</p>
<dl><dd><ul><li> <b>Raster Formats</b> define a fixed size array of (rows and columns) of colors. These formats take proportionately larger file space for increased detail and do not scale well. Raster file size is a function of resolution and color density. Raster formats are best used when you must reproduce graphs and layout pages with much detail and many colors, and where scalability is not a concern.</li>
<li> <b>Vector formats</b> contain instructions on how to draw an image and may contain additional information about size and resolution. These formats scale well (within limits), but must be interpreted by a target application, and this is subject to error. File size is proportional to the complexity of the image. Vector formats are best used for graphs and layout pages with little detail and few colors, or for applications where scalability is needed.</li></ul></dd></dl>
<p>The supported formats have been listed for the variable <b>Image Type</b> in the Variables section.
</p><p><b>Details on Some Dialog Options</b>
</p>
<dl><dd><ul><li><b>Export Settings (tr)</b></li></ul></dd></dl>
<dl><dd><dl><dd>Please see <a class="external text" href="../../XFunction/X-Function/Details_of_TreeNodes_in_Export_Graph.html#tr_.28Export_Settings.29"><b>Export Settings</b></a> for more details.</dd></dl></dd></dl>
<dl><dd><ul><li><b>Image Size (tr1)</b></li></ul>
<dl><dd>Please see <a class="external text" href="../../XFunction/X-Function/Details_of_TreeNodes_in_Export_Graph.html#tr1"><b>Image Size</b></a> for more details.</dd></dl></dd></dl>
<dl><dd><ul><li><b>Image Settings (tr2)</b></li></ul>
<dl><dd>Please see <a class="external text" href="../../XFunction/X-Function/Details_of_TreeNodes_in_Export_Graph.html#tr2"><b>Image Settings</b></a>  for more details.</dd></dl></dd></dl>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p>In this example, we will show how to create the same sub-folder hierarchy according to project folder structure, and export graphs into their own folders named after graph window long name. <br />
<b>Solution for Origin 2017 and later: </b>
<br />
Note that predefined path such as &lt;Project Folder&gt;&lt;PE Path&gt; was introduced in Origin 2017 to easily export graphs according to project folders in an opj file.
</p>
<pre class="lt" style="font-family:monospace;">doc <span style="color: #000080;">-</span>e P
<span style="color: #000000;">&#123;</span>
  if<span style="color: #000000;">&#40;</span>page.<span style="color: #000080;">IsEmbedded</span><span style="color: #000080;">==</span><span style="color: #0000dd;">0</span><span style="color: #000080;">&amp;&amp;</span>exist<span style="color: #000000;">&#40;</span><span style="color: #000080;">%</span>H<span style="color: #000000;">&#41;</span><span style="color: #000080;">!</span><span style="color: #000080;">=</span><span style="color: #0000dd;">11</span><span style="color: #000000;">&#41;</span> <span style="color: #008000;">//Skip over any embedded graphs or Layout windows</span>
    <span style="color: #000000;">&#123;</span>
      window <span style="color: #000080;">-</span>a <span style="color: #000080;">%</span>H; <span style="color: #008000;">//Activate graph window</span>
      expGraph type<span style="color: #000000;">:</span><span style="color: #000080;">=</span>jpg filename<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;&lt;long name&gt;&quot;</span> path<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;&lt;Project Folder&gt;&lt;PE Path&gt;&quot;</span> theme<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>Original<span style="color: #000080;">&gt;</span> tr.<span style="color: #000080;">Margin</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>;
    <span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>
<p><br />
<b>Solution for Origin 2016 and later: </b>
<br />
Note that string register&#160;%@P is only introduced since Origin 2016 SR2 which denotes the full Project Explorer path of the active folder.
</p>
<pre class="lt" style="font-family:monospace;">doc <span style="color: #000080;">-</span>e P
<span style="color: #000000;">&#123;</span>
  if<span style="color: #000000;">&#40;</span>page.<span style="color: #000080;">IsEmbedded</span><span style="color: #000080;">==</span><span style="color: #0000dd;">0</span><span style="color: #000080;">&amp;&amp;</span>exist<span style="color: #000000;">&#40;</span><span style="color: #000080;">%</span>H<span style="color: #000000;">&#41;</span><span style="color: #000080;">!</span><span style="color: #000080;">=</span><span style="color: #0000dd;">11</span><span style="color: #000000;">&#41;</span> <span style="color: #008000;">//Skip over any embedded graphs or Layout windows</span>
    <span style="color: #000000;">&#123;</span>
      window <span style="color: #000080;">-</span>a <span style="color: #000080;">%</span>H; <span style="color: #008000;">//Activate graph window</span>
      string a<span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #000080;">%</span>X; <span style="color: #008000;">//Get windows path of saved project</span>
      string b<span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #000080;">%</span>@P; <span style="color: #008000;">//Get graph project path </span>
      b.<span style="color: #000080;">Replace</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;/&quot;</span>,<span style="color: #ff00ff;">&quot;\&quot;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//Correct path notation</span>
      i<span style="color: #000080;">=</span>b.<span style="color: #000080;">delete</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>; 
      string path<span style="color: #000080;">$</span><span style="color: #000080;">=</span>a<span style="color: #000080;">$</span><span style="color: #000080;">+</span>b<span style="color: #000080;">$</span>; <span style="color: #008000;">//Concatenate above strings to create export folder path </span>
      expGraph type<span style="color: #000000;">:</span><span style="color: #000080;">=</span>jpg filename<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;&lt;long name&gt;&quot;</span> path<span style="color: #000000;">:</span><span style="color: #000080;">=</span>path<span style="color: #000080;">$</span> theme<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>Original<span style="color: #000080;">&gt;</span> tr.<span style="color: #000080;">Margin</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>;
    <span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre>
<p><br />
<b>Solution for Origin 2015 and earlier: </b>
</p>
<pre class="lt" style="font-family:monospace;">pe_cd <span style="color: #000080;">/</span>; <span style="color: #008000;">//move to root directory</span>
string root_folder<span style="color: #000080;">$</span>;
pe_path path<span style="color: #000000;">:</span><span style="color: #000080;">=</span>root_folder<span style="color: #000080;">$</span>; <span style="color: #008000;">//get directory path</span>
<span style="color: #008000;">//type root_folder$;</span>
int cs<span style="color: #000080;">=</span><span style="color: #000080;">%</span><span style="color: #000000;">&#91;</span>root_folder<span style="color: #000080;">$</span><span style="color: #000000;">&#93;</span>; <span style="color: #008000;">//get path length</span>
cs<span style="color: #000080;">=</span>cs<span style="color: #000080;">+</span><span style="color: #0000dd;">2</span>; <span style="color: #008000;">//add 2 probably due to spaces and similar </span>
<span style="color: #008000;">//cs=;</span>
doc <span style="color: #000080;">-</span>e P <span style="color: #008000;">//loop over all graph-like objects</span>
<span style="color: #000000;">&#123;</span>
	if<span style="color: #000000;">&#40;</span>page.<span style="color: #000080;">IsEmbedded</span><span style="color: #000080;">==</span><span style="color: #0000dd;">0</span><span style="color: #000080;">&amp;&amp;</span>exist<span style="color: #000000;">&#40;</span><span style="color: #000080;">%</span>H<span style="color: #000000;">&#41;</span><span style="color: #000080;">!</span><span style="color: #000080;">=</span><span style="color: #0000dd;">11</span><span style="color: #000000;">&#41;</span>  <span style="color: #008000;">//Skip over any embedded graphs or Layout windows</span>
	<span style="color: #000000;">&#123;</span>
		string proj_path<span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #000080;">%</span>X; <span style="color: #008000;">//Get windows path of saved project;</span>
		<span style="color: #008000;">//type &quot;the project path is:&quot;+proj_path$;</span>
		window <span style="color: #000080;">-</span>a <span style="color: #000080;">%</span>H;	
		string graph_fullPath<span style="color: #000080;">$</span>;
		pe_path path<span style="color: #000000;">:</span><span style="color: #000080;">=</span>graph_fullPath<span style="color: #000080;">$</span>; <span style="color: #008000;">//Get graph project explorer path;</span>
		<span style="color: #000080;">%</span>A<span style="color: #000080;">=</span>graph_fullPath<span style="color: #000080;">$</span>;
		string graph_path<span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #000080;">%</span><span style="color: #000000;">&#91;</span><span style="color: #000080;">%</span>A,<span style="color: #000080;">&gt;</span>cs<span style="color: #000000;">&#93;</span>; <span style="color: #008000;">//remove the root folder name from path</span>
		<span style="color: #008000;">//type &quot;the graph path is:&quot;+graph_path$;</span>
		<span style="color: #008000;">//type &quot;graph title is:&quot;+%H;</span>
		string path<span style="color: #000080;">$</span><span style="color: #000080;">=</span>proj_path<span style="color: #000080;">$</span><span style="color: #000080;">+</span>graph_Path<span style="color: #000080;">$</span>; <span style="color: #008000;">//Concatenate above strings to create export folder;</span>
		path.<span style="color: #000080;">Replace</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;/&quot;</span>,<span style="color: #ff00ff;">&quot;\&quot;</span><span style="color: #000000;">&#41;</span>;
		expGraph type<span style="color: #000000;">:</span><span style="color: #000080;">=</span>jpg filename<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;&lt;long name&gt;&quot;</span> path<span style="color: #000000;">:</span><span style="color: #000080;">=</span>path<span style="color: #000080;">$</span> theme<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>Original<span style="color: #000080;">&gt;</span> tr.<span style="color: #000080;">Margin</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>;
	<span style="color: #000000;">&#125;</span>;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">Related X-Functions</span></h2>
<p><a href="../../XFunction/X-Function/ExpImage.html" title="X-Function:ExpImage">expImage</a>, <a href="../../XFunction/X-Function/ExpWks.html" title="X-Function:ExpWks">expWks</a>
</p>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>publishing</span></p>






