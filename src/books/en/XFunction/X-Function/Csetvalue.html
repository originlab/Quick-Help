<h1 class="firstHeading">2.8.5 csetvalue</h1><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">Menu Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Additional_Information"><span class="tocnumber">3</span> <span class="toctext">Additional Information</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Command_Line_Usage"><span class="tocnumber">4</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#X-Function_Execution_Options"><span class="tocnumber">5</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Variables"><span class="tocnumber">6</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Description"><span class="tocnumber">7</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Examples"><span class="tocnumber">8</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Related_X-Functions"><span class="tocnumber">9</span> <span class="toctext">Related X-Functions</span></a></li>
</ul>
</div>

<h2><a name="Menu_Information"></a><span class="mw-headline">Menu Information</span></h2>
<p>Programmatic equivalent of <b>Column&#160;: Set Column Values...</b> menu option.
</p>
<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Set column values with custom formula
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">Additional Information</span></h2>
<p>Minimum Origin Version Required:Origin 8.5 SR0
</p><p>X-Function not designed for Auto GetN Dialog.
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
</p><p>1. csetvalue formula:="int(rnd()*100)"    //Set active column random number less than 100
</p><p>2. csetvalue col:=col(b) formula:="sin(Col(A))" script:="Col(A) = Data(0.1,6.2,0.1)" //Use built-in function in the before formula script
</p><p>3. csetvalue col:=sheet1!A[3:10] formula:="i*i" //Set values for a range with row index <b>i</b> as a variable
</p><p>4. csetvalue col:=col(B) formula:="total(col(A)[i-3:i+3])"; //Set values for a specified column by a sub-range from other column.  (" <b>i</b> " is the row index.)
</p><p>5. csetvalue col:=col(B) formula:="col(Sensor Amp)*0.5"; //When calling columns using column Long Name,e.g.,<i>Sensor Amp</i>, you should remove the quotation mark.
</code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Column
</td>
<td>col
</td>
<td>
<p>Input
</p><p>Range
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> Specify the target column in which the values will be input.
</td></tr>
<tr>
<td>Formula
</td>
<td>formula
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>"?"</center>
</td>
<td> Specify the formula to compute the values for the target column.
</td></tr>
<tr>
<td>Before Formula Script
</td>
<td>script
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>"?"</center>
</td>
<td> Specify LabTalk scripts and the scripts will be executed before the Formula has been executed.
</td></tr>
<tr>
<td>Recalculate Mode
</td>
<td>recalculate
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>2</center>
</td>
<td> Specify the Recalculate mode.
<p>Option list:
</p>
<ul><li><i>none:None</i>
<dl><dd>Do not update the output when the source data changes</dd></dl></li>
<li><i>auto:Auto</i>
<dl><dd>Automatically update the output when the source data changes</dd></dl></li>
<li><i>manual:Manual</i>
<dl><dd>Manually update the output when the source data changes</dd></dl></li></ul>
<p><br />
</p>
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>This X-Function is designed for realizing the same ability as the <a class="external text" href="../../UserGuide/Category/Using_Formulae_to_Set_or_Transform_Worksheet_Column_Values.html">Set Column Values</a> option in the Column menu, which is used to fill a column or part of a column with data.<br />
Note that use of <i>Recalculate</i> of <i>Auto</i> or <i>Manual</i> requires that the output is a different column than the input.
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p>This example is similar to the <a class="external text" href="../../UserGuide/UserGuide/Quick_Start_SetColumnValues.html">Quick Start Set Column Values</a> example, which shows you how to use the <b>csetvalue</b> example to input values for two columns in a worksheet. To use the following scripts, please first create a new project to make sure there is a worksheet called <b>Sheet1</b> in <b>Book1</b>.
</p>
<pre class="lt" style="font-family:monospace;">csetvalue col<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>Book1<span style="color: #000000;">&#93;</span>Sheet1<span style="color: #000080;">!</span>col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span> formula<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Data(-1,5,0.03)&quot;</span> <span style="color: #008000;">//Input values for Column A</span>
csetvalue col<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>Book1<span style="color: #000000;">&#93;</span>Sheet1<span style="color: #000080;">!</span>col<span style="color: #000000;">&#40;</span>b<span style="color: #000000;">&#41;</span> formula<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot; 1 + (5/(1.5*sqrt(PI/2)))*exp(-2*((col(a)-2)/1.5)^2)&quot;</span><span style="color: #008000;">//Input values for Column B</span></pre>
<p>This example shows to use the before formula script to call columns from other workbooks and set recalculation mode to automatically update results.
</p>
<pre class="lt" style="font-family:monospace;">newbook;
<span style="color: #000080;">%</span>A<span style="color: #000080;">=</span><span style="color: #000080;">%</span>H;<span style="color: #008000;">//store the workbook name of the newly created book.</span>
csetvalue col<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> formula<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Data(0,1,0.01)&quot;</span>;<span style="color: #008000;">//Set values for column A in the first new book</span>
newbook;
<span style="color: #000080;">%</span>B<span style="color: #000080;">=</span><span style="color: #000080;">%</span>H;<span style="color: #008000;">//store the workbook name of the newly created book.</span>
wks.<span style="color: #000080;">nCols</span><span style="color: #000080;">=</span><span style="color: #0000dd;">12</span>;
<span style="color: #008000;">//The following loop will set value for each column in the second new book with the value from the first new book</span>
for<span style="color: #000000;">&#40;</span>int ii<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>; ii<span style="color: #000080;">&lt;=</span><span style="color: #0000dd;">12</span>; ii<span style="color: #000080;">++</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
   csetvalue col<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span><span style="color: #000080;">%</span>A<span style="color: #000000;">&#93;</span>Sheet1<span style="color: #000080;">!</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> formula<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;sin(r1)+ii&quot;</span> script<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;range r1=[%A]Sheet1!col(1)&quot;</span> recalculate<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;<span style="color: #008000;">//Recalculation mode set to &quot;Auto&quot;</span>
   csetvalue col<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span><span style="color: #000080;">%</span>B<span style="color: #000000;">&#93;</span>Sheet1<span style="color: #000080;">!</span>col<span style="color: #000000;">&#40;</span><span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>ii<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span> formula<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;r2&quot;</span> script<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;range r2=[%A]Sheet1!col(2)&quot;</span> recalculate<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;<span style="color: #008000;">//Recalculation mode set to &quot;none&quot;</span>
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">Related X-Functions</span></h2>
<p><a href="../../XFunction/X-Function/Msetvalue.html" title="X-Function:Msetvalue">msetvalue</a>
</p>





