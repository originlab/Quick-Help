<h1 class="firstHeading">2.7.5 expASC</h1><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">Menu Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Command_Line_Usage"><span class="tocnumber">3</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#X-Function_Execution_Options"><span class="tocnumber">4</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Variables"><span class="tocnumber">5</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Description"><span class="tocnumber">6</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Examples"><span class="tocnumber">7</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Related_X-Functions"><span class="tocnumber">8</span> <span class="toctext">Related X-Functions</span></a></li>
</ul>
</div>

<h2><a name="Menu_Information"></a><span class="mw-headline">Menu Information</span></h2>
<p>File&#160;: Export&#160;: ASCII
</p>
<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Export worksheet data as ASCII file
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
1. expASC path:="c:\signal.dat";
</p><p>2. expASC type:=csv path:="c:\signal"; 
</p><p>3. expASC type:=dat path:="c:\signal" select:=1 separator:=cs; 
</p><p>4. expASC iw:=[book1]1 path:="c:\signal.dat";
</p><p></code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Input Worksheet
</td>
<td>iw
</td>
<td>
<p>Input
</p><p>Worksheet
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> Specify the worksheet to be exported. By default, the active worksheet is sued. This value cannot be changed in the dialog box.
</td></tr>
<tr>
<td>File Type
</td>
<td>type
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify the extension of the exported file.
<p>Option list:
</p>
<ul><li><i>dat:*.dat</i> {0}
<dl><dd>Export the ASCII data as a .dat file.</dd></dl></li>
<li><i>text:Text File(*.txt)</i> {1}
<dl><dd>Export the ASCII data as a .txt file</dd></dl></li>
<li><i>csv:*.csv</i> {2}
<dl><dd>Export the ASCII data as a .csv file.</dd></dl></li>
<li><i>all:All Files(*.*)</i> {3}
<dl><dd>Export the ASCII data to file name exactly as specified by the user.</dd></dl></li></ul>
<p>When you use .dat, .txt or .csv, that extension is added to the specified filename extension unless they match.
</p>
</td></tr>
<tr>
<td>File Path
</td>
<td>path
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>fname$</center>
</td>
<td> Specify the path and filename of output file.
</td></tr>
<tr>
<td>Encoding
</td>
<td>encoding
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify the encoding method of the exported file.
<p>Option list:
</p>
<ul><li><i>auto:Auto</i> (0), </li>
<li><i>ansi:ANSI</i> (1), </li>
<li><i>utf8:UTF-8</i> (2), </li>
<li><i>utf16le:Unicode</i> (3), </li>
<li><i>utf16be:Unicode Big Endian</i> (4)</li></ul>
<p>Note: when <i>auto</i> is choosen, the file will first be exported as UTF-8, then it will be inspected whether it can be converted to MBCS using the current code page. If yes, it will be converted, otherwise left it as UTF-8.
</p>
</td></tr>
<tr>
<td>Overwrite Existing
</td>
<td>overwrite
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>2</center>
</td>
<td> Specify whether to overwrite the existing file if there is an file with the same name as the exported file.
<p>Option list:
</p>
<ul><li><i>replace:Replace</i> {0}
<dl><dd>Replace the data in the existing file with the exported data.</dd></dl></li>
<li><i>append:Append</i> {1}
<dl><dd>Append the exported data to the existing file.</dd></dl></li></ul>
<p>If you use a value of 2 and the file exists you are presented with a dialog where you can choose to Replace, Append or rename the output file.
</p>
</td></tr>
<tr>
<td>Export Selected Data Only
</td>
<td>select
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> When this checkbox is selected, only the selected data will be exported. Note that the selection can be non-contiguous.
</td></tr>
<tr>
<td>Separator
</td>
<td>separator
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify the character used as separator or delimiter. This control is not available when <b>File Type</b> is set to <b>CSV</b>. In that case, comma will be used for separator unless overridden by the <b>csvsep</b> option.
<p>Option list:
</p>
<ul><li><i>tab:TAB</i> {0}
<dl><dd>Use Tab for delimiter.</dd></dl></li>
<li><i>comma:,</i> {1}
<dl><dd>Use comma for delimiter.</dd></dl></li>
<li><i>space:SPACE</i> {2}
<dl><dd>Use space for delimiter.</dd></dl></li>
<li><i>ct:,TAB</i> {3}
<dl><dd>Use comma and Tab for delimiter.</dd></dl></li>
<li><i>cs:,SPACE</i> {4}
<dl><dd>Use comma and space for delimiter.</dd></dl></li></ul>
</td></tr>
<tr>
<td>Separator
</td>
<td>csvsep
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>Comma</center>
</td>
<td>
<p>When the file type is CSV, this parameter sets separator to comma or semicolon.
</p><p><br />
Option list
</p>
<ul><li><i>Comma</i>
<dl><dd>Use comma for delimiter.</dd></dl></li>
<li><i>Semicolon</i>
<dl><dd>Use semicolon for delimiter.</dd></dl></li></ul>
</td></tr>
<tr>
<td>Include Short Name
</td>
<td>shortname
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify whether the Short name heading row will be exported.
</td></tr>
<tr>
<td>Include Long Name
</td>
<td>longname
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> Specify whether the Long name heading row will be exported.
</td></tr>
<tr>
<td>Include Units
</td>
<td>units
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> Specify whether the Unit heading row will be exported.
</td></tr>
<tr>
<td>Include Comments
</td>
<td>comment
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> Specify whether the Comments heading row will be exported.
</td></tr>
<tr>
<td>Include User Parameters
</td>
<td>userparam
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify whether the User Parameters rows will be exported.
</td></tr>
<tr>
<td>Include Sampling Interval
</td>
<td>sampinterv
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify whether the Sampling interval heading row will be exported.
</td></tr>
<tr>
<td>Include Parameters
</td>
<td>parameter
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify whether the Parameter heading row will be exported.
</td></tr>
<tr>
<td>Include Row Labels and Index
</td>
<td>rowlabel
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify whether the row labels and index numbers will be exported.
</td></tr>
<tr>
<td>Export with Full Precision
</td>
<td>precision
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> Specify whether data should be exported with full precision. The default value is true.
</td></tr>
<tr>
<td>Export Sampling Interval as New Column
</td>
<td>addxcol
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify whether to add a new time column to the output data for each column that has a sampling interval.
</td></tr>
<tr>
<td>Export Missing Values as "--"
</td>
<td>missing
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> Specify whether to export missing values as the "--" string.
</td></tr>
<tr>
<td>Ignore Ending Empty Columns
</td>
<td>empty
</td>
<td>int
</td>
<td>0
</td>
<td>Specify whether ignore the ending empty columns. When check this check box, the export will ignore all empty columns after the last column with data, meta data not considered, and column with all missing values are considered empty.
</td></tr>
<tr>
<td>Suffix for numbers in text cell
</td>
<td>suffix
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center></center>
</td>
<td> You can add suffix for numeric numbers in text columns. If you wish to do so (export phone and zip code for example), use this variable to specify the suffix.
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>The expASC function exports worksheet data as ASCII file.
</p><p>Note that the ASCII export is limited to data-only worksheets. Complex documents containing embedded information -- report sheets, worksheets with embedded or linked graphs (including sparklines) -- cannot be exported to ASCII files. If the worksheet to be exported has embedded images and graphs, those images and graphs will be ignored during exporting.
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p>This example is to export all sheets in all workbooks within the project to a specified navigated path and name those data files as "WorkbookName_WorksheetName".
</p>
<pre class="lt" style="font-family:monospace;">fdlog.<span style="color: #000080;">openpath</span><span style="color: #000000;">&#40;</span>B<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// choose directory to store files</span>
 
doc <span style="color: #000080;">-</span>e W<span style="color: #000000;">&#123;</span>   <span style="color: #008000;">// loop over all workbooks in project</span>
 
       doc <span style="color: #000080;">-</span>e LW <span style="color: #008000;">// loop over all worksheets in workbook</span>
            <span style="color: #000000;">&#123;</span>
              string temp<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> wks.<span style="color: #000080;">name</span><span style="color: #000080;">$</span>; <span style="color: #008000;">// Get worksheet short name</span>
           <span style="color: #008000;">// string temp$ = wks.longname$; // Run this line to get worksheet long name</span>
              expASC type<span style="color: #000000;">:</span><span style="color: #000080;">=</span>text path<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000080;">%</span>B<span style="color: #000080;">%</span>H_<span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>temp<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span> shortname<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>; <span style="color: #008000;">// Export files as .txt files with column short names exported</span>
            <span style="color: #000000;">&#125;</span>;
<span style="color: #000000;">&#125;</span></pre>
<p>A variation on this example exports all worksheet columns to .dat files and organizes them using the project's <a class="external text" href="../../UserGuide/UserGuide/Project_Explorer.html"><b>Project Explorer</b></a> folder structure:
</p>
<pre class="lt" style="font-family:monospace;">string fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;%YMap Data.opju&quot;</span>;
doc <span style="color: #000080;">-</span>o <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>fname<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// opens project User Files\Map Data.opju</span>

doc <span style="color: #000080;">-</span>e W<span style="color: #000000;">&#123;</span>   <span style="color: #008000;">// loop over all workbooks in project</span>
    
       doc <span style="color: #000080;">-</span>e LW <span style="color: #008000;">// loop over all worksheets in workbook</span>
            <span style="color: #000000;">&#123;</span>
              string temp<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> wks.<span style="color: #000080;">name</span><span style="color: #000080;">$</span>; <span style="color: #008000;">// Get worksheet short name</span>
           <span style="color: #008000;">// string temp$ = wks.longname$; // Run this line to get worksheet long name</span>
              expASC path<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;&lt;Project Folder&gt;&lt;PE Path&gt;%(temp$)&quot;</span> shortname<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>; <span style="color: #008000;">// Export and organize files using PE folder structure</span>
            <span style="color: #000000;">&#125;</span>;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">Related X-Functions</span></h2>
<p><a href="../../XFunction/X-Function/ImpASC.html" title="X-Function:ImpASC">impASC</a>, <a href="../../XFunction/X-Function/ExpMatASC.html" title="X-Function:ExpMatASC">expMatASC</a>, <a href="../../XFunction/X-Function/ExpPDFw.html" title="X-Function:ExpPDFw">expPDFw</a>
</p>





