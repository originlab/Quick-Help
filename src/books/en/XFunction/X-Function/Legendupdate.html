<h1 class="firstHeading">2.5.35 legendupdate</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">Menu Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Command_Line_Usage"><span class="tocnumber">3</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#X-Function_Execution_Options"><span class="tocnumber">4</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Variables"><span class="tocnumber">5</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Description"><span class="tocnumber">6</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Examples"><span class="tocnumber">7</span> <span class="toctext">Examples</span></a></li>
</ul>
</div>

<h2><a name="Menu_Information"></a><span class="mw-headline">Menu Information</span></h2>
<p>Graph: Update Legend
</p>
<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Update or reconstruct graph legend
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
1. legendupdate dest:=layer update:=reconstruct legend:=combine order:=ascend mode:=lu;
</code>
</p><p><br />
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Update Scope
</td>
<td>dest
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specifies where to apply the legend updates.
<p>Option list:
</p>
<ul><li><i>page:Whole Page</i>
<dl><dd>Update the legends on the whole active page.</dd></dl></li>
<li><i>layer:Active Layer</i>
<dl><dd>Update the legends on the active layer.</dd></dl></li>
<li><i>spepage:Specific Page</i>
<dl><dd>This is not visible in the dialog box. When this is selected, only the legends on the graph page specified by the <i>page</i> variable will be updated.</dd></dl></li>
<li><i>spelayer:Specific layer</i>
<dl><dd>This is not visible in the dialog box. When this is selected, only the legends on the graph layer specified by the <i>layer</i> variable will be updated.</dd></dl></li></ul>
</td></tr>
<tr>
<td>Update Mode
</td>
<td>update
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> Specifies whether to reconstruct or update the legend.
<p>Option list:
</p>
<ul><li><i>reconstruct:Reconstruct</i>
<dl><dd>Reconstruct the legend(s) according to the <b>Auto Legend Translation Mode</b> and <b>Order</b> variables.</dd>
<dd><b>Note:</b> It will restore the legend(s) format to the default setting. </dd></dl></li>
<li><i>update:Update</i>
<dl><dd>Update the information of existing legend(s) by the specified variable . </dd>
<dd><b>Note:</b> It will not change the format and structure of the existing legend(s).</dd></dl></li></ul>
</td></tr>
<tr>
<td>Legend
</td>
<td>legend
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> This is only available when <b>reconstruct</b> is selected for the <b>update</b> variable. Use this variable to specify the type of legend you want to reconstruct.
<p>Option list:
</p>
<ul><li><i>separate:Legend for each Graph</i>
<dl><dd>Construct a separate legend for each layer.</dd></dl></li>
<li><i>combine:One Legend for Whole Page</i>
<dl><dd>Construct a legend for all layers in the graph.</dd></dl></li></ul>
</td></tr>
<tr>
<td>Order
</td>
<td>order
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> This is only available when <b>reconstruct</b> is selected for the <b>update</b> variable. When a legend is reconstructed, information must be read from the graph layers. This variable controls the order to read the layers.
<p>Option list:
</p>
<ul><li><i>descend:Descending</i>
<dl><dd>Read information from the layers according to their indices in descending order.</dd></dl></li>
<li><i>ascend:Ascending</i>
<dl><dd>Read information from the layers according to their indices in ascending order.</dd></dl></li></ul>
</td></tr>
<tr>
<td>Plot Order within Layer
</td>
<td>porder
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> This is only available when <b>reconstruct</b> is selected for the <b>update</b> and <b>combine</b> is selected for the <b>legend</b> variable. This variable controls the plot order to read within a layer.
<p>Option list:
</p>
<ul><li><i>descend:Descending</i>
<dl><dd>Read plot information within a layer according to their indices in descending order.</dd></dl></li>
<li><i>ascend:Ascending</i>
<dl><dd>Read plot information within a layers according to their indices in ascending order.</dd></dl></li></ul>
</td></tr>
<tr>
<td>Auto Legend Translation Mode
</td>
<td>mode
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> LabTalk variable notations ("%(1)", "%(2)", etc.) is used to create legends. Origin automatically "translate" the notations into information when constructing a legend. This variable specifies the information that will be used to translate the notations.
<p>Option list:
</p>
<ul><li><i>comment:@LM:Use Comment (1st line)</i>
<dl><dd>The first line in the Comments row of the source data. Otherwise use the column Long Name. If neither Comments nor Long Name contains contents, use the Short Name of the corresponding column.</dd></dl></li>
<li><i>dr:@R:Data Range</i>
<dl><dd>The data range of the plot.</dd></dl></li>
<li><i>lu:@U:Long Name &amp; Units</i>
<dl><dd>The Long Names and Units of the source data. If Long Name contains no content, the column Short Name will be used instead</dd></dl></li>
<li><i>udpara:@LD:User Parameter 1</i>
<dl><dd>The first User Parameter row of the source data.</dd></dl></li>
<li><i>lname:@LA:Long Name</i>
<dl><dd>The Long Name of the source data.</dd></dl></li>
<li><i>sname:@LS:Short Name</i>
<dl><dd>The Short Name of the source data.</dd></dl></li>
<li><i>lpara:@LP:Parameter 1</i>
<dl><dd>The first system Parameter of the source data.</dd></dl></li>
<li><i>custom:Custom</i>
<dl><dd>The information specified by the <b>custom</b> variable.</dd></dl></li></ul>
</td></tr>
<tr>
<td>Legend Custom Format(@D,@LU etc)
</td>
<td>custom
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center></center>
</td>
<td>This is available only when <b>custom</b> is selected for the <b>mode</b> variable. You can add any literal before, after and in between the legend notations. <a class="external text" href="../../LabTalk/LabTalk/Text_Label_Options.html#Complete_List_of_.40Options">Notations</a> entered here will be used to translate.
</td></tr>
<tr>
<td>Additional Format (for @L, @V etc.)
</td>
<td>addon
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center></center>
</td>
<td>This is available only when <b>custom</b> is selected for <b>mode</b> and <i>@L</i>, <i>@V</i> or <i>@WT</i> is selected for <b>custom</b> variable. Specify <i>n</i>th row and/or <i>m</i>th column to complete notation of worksheet cell access. Refer to <a class="external text" href="../../LabTalk/LabTalk/Text_Label_Options.html#Complete_List_of_.40Options">Notations</a> for details.
</td></tr>
<tr>
<td>GraphPage
</td>
<td>page
</td>
<td>
<p>Input
</p><p>GraphPage
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td> This is only available when <b>dest</b> variable is set to <b>spepage</b>. Use it to specify a graph page. Then the legend(s) on the graph page will be updated.
</td></tr>
<tr>
<td>GraphLayer
</td>
<td>layer
</td>
<td>
<p>Input
</p><p>GraphLayer
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td> This is only available when <b>dest</b> variable is set to <b>spelayer</b>. Use it to specify a graph layer. Then the legend on the graph layer will be updated.
</td></tr>
<tr>
<td>Show Legend for Visible Plots Only
</td>
<td>hide
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td><center>1</center>
</td>
<td>Specify whether to show the hidden plot in legend
</td></tr>
<tr>
<td>Hide Legend for Fitted Curves
</td>
<td>fit
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td><center>0</center>
</td>
<td>Specify whether to hide the fitted curve(s) in legend or not
</td></tr>
<tr>
<td>Indicate Active Dataset
</td>
<td>indicate
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td><center>1</center>
</td>
<td>Specify whether to indicate the active dataset in the legend.
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>This X-function can be used to update or reconstruct legends on graphs or layers. It is accessible from menu with a graphical dialog. You can refer to <a class="external text" href="../../UserGuide/UserGuide/The_legendupdate_Dialog_Box.html">this online help</a> for the controls in graphical dialog.
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p>This example shows how to update graph legends. The sample data can be imported from <b>&lt;exe_path&gt;\Samples\Signal Processing\Signal with Shot Noise.dat</b>.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Get sample data</span>
fn<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Signal Processing\Signal with Shot Noise.dat&quot;</span>;
newbook;
impASC fn<span style="color: #000080;">$</span>;

<span style="color: #008000;">// Plot a line graph, </span>
<span style="color: #008000;">//the default legend uses both worksheet long name and unit as legend.</span>
plotxy col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;

<span style="color: #008000;">// Update legend;</span>
legendupdate mode<span style="color: #000000;">:</span><span style="color: #000080;">=</span>lu;</pre>






