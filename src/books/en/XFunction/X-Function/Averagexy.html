<h1 class="firstHeading">2.8.2 averagexy</h1><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">Menu Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Command_Line_Usage"><span class="tocnumber">3</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#X-Function_Execution_Options"><span class="tocnumber">4</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Variables"><span class="tocnumber">5</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Description"><span class="tocnumber">6</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Examples"><span class="tocnumber">7</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Algorithm"><span class="tocnumber">8</span> <span class="toctext">Algorithm</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Related_X-Functions"><span class="tocnumber">9</span> <span class="toctext">Related X-Functions</span></a></li>
</ul>
</div>

<h2><a name="Menu_Information"></a><span class="mw-headline">Menu Information</span></h2>
<p>The function has no menu option and can only called programmatically.
</p>
<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Average or concatenate multiple curves with option to customize output
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
</p>
<ol><li>averagexy iy:=(Plot(1), Plot(2)) method:=concatenate x:=myX y:=myY;</li>
<li>averagexy iy:=((1,2),(3, 4)) method:=ave avex:=common interp:=linear x:=5 y:=6;</li></ol>
<p></code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Input
</td>
<td>iy
</td>
<td>
<p>Input
</p><p>XYRange
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> Specifies multiple curves to be averaged or concatenated.
</td></tr>
<tr>
<td>Method
</td>
<td>method
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Average Method
<p>Option list:
</p>
<ul><li><i>ave:Average</i>
<dl><dd>Average the input curves by consolidating the same X values and averaging their corresponding Y values.</dd></dl></li>
<li><i>concatenate:Concatenate</i>
<dl><dd>Concatenates the input curves.</dd></dl></li></ul>
</td></tr>
<tr>
<td>Averaged X
</td>
<td>avex
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>2</center>
</td>
<td> This is available only when <b>Average</b> is selected for <b>Method</b>. It specifies the method to determine the X values of the averaged curve.
<p>Option list:
</p>
<ul><li><i>same:Same as Source X</i>
<dl><dd>Use the X values of all input curves as the averaged curve's X. X values within tolerance specified by <b>toler</b> will be treated as the same x and averaged.</dd></dl></li>
<li><i>common:Common X Range</i>
<dl><dd>Create an X dataset of <i>npts</i> from the largest minimum X of all datasets to the smallest maximum X of all datasets and calculate Y using the <i>interp</i> setting.</dd></dl></li>
<li><i>full:Full X Range</i>
<dl><dd>Create an X dataset of <i>npts</i> from the smallest minimum X of all datasets to the largest maximum X of all datasets and calculate Y using the <i>interp</i> setting.</dd></dl></li>
<li><i>custom:Custom</i>
<dl><dd>Create an X dataset of <i>npts</i> from <b>xmin</b> to <b>xmax</b> and calculate Y using the <i>interp</i> setting.</dd></dl></li>
<li><i>trace:Follow Curve Trace</i>
<dl><dd>Compute the X values of the averaged curve by <a class="external text" href="../../XFunction/X-Function/Interp1trace.html">trace interpolation</a>, which can create a new curve with a shape similar to the input curves. For more details, please refer to <a class="external text" href="../../XFunction/X-Function/Averagexy.html#Algorithm">Algorithm</a> below.</dd></dl></li></ul>
</td></tr>
<tr>
<td>Tolerance for Common X Values
</td>
<td>toler
</td>
<td>
<p>Input
</p><p>double
</p>
</td>
<td> <center>1e-8</center>
</td>
<td> This is available only when <b>Average</b> is selected for <b>method</b> and <b>same</b> is selected for <b>avex</b>. It is used to check if the X values of input curves are the same.
</td></tr>
<tr>
<td>Number of Points
</td>
<td>npts
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>&lt;auto&gt;</center>
</td>
<td> This is available when <b>Average</b> is selected for <b>Method</b> and <b>Averaged X</b> is not set to <b>Same as Source X</b>. It specifies the number of points of the interpolated curves. In the dialog box, it computes a number automatically if <b>Auto</b> is checked. You can also uncheck <b>Auto</b> and specify the values directly.
</td></tr>
<tr>
<td>X Minimum
</td>
<td>xmin
</td>
<td>
<p>Input
</p><p>double
</p>
</td>
<td> <center>&lt;auto&gt;</center>
</td>
<td> This is editable only when <b>Custom</b> is selected for <b>Average X</b>. It specifies the minimum X value of the averaged curve. In the dialog box, it computes a number automatically if <b>Auto</b> is checked. You can also uncheck <b>Auto</b> and specify the values directly. This variable is read-only if <b>Common X Range</b> or <b>Full X Range</b> is selected for <b>Averaged X</b>.
</td></tr>
<tr>
<td>X Maximum
</td>
<td>xmax
</td>
<td>
<p>Input
</p><p>double
</p>
</td>
<td> <center>&lt;auto&gt;</center>
</td>
<td> This is editable only when <b>Custom</b> is selected for <b>Average X</b>. It specifies the maximum X value of the averaged curve. In the dialog box, it computes a number automatically if <b>Auto</b> is checked. You can also uncheck <b>Auto</b> and specify the values directly. This variable is read-only if <b>Common X Range</b> or <b>Full X Range</b> is selected for <b>Averaged X</b>.
</td></tr>
<tr>
<td>Interpolate
</td>
<td>interp
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> This is available only when <b>Average X</b> is not set to <b>Same as Source X</b>. It specifies the <a class="external text" href="../../XFunction/X-Function/Interp1.html#Algorithm">method to interpolate</a> the Y values when averaging the input curves.
<p>Option list:
</p>
<ul><li><i>linear:Linear</i>
<dl><dd>Performs <a class="external text" href="../../XFunction/X-Function/Interp1.html#Algorithm">linear interpolation</a> on the X values.</dd></dl></li>
<li><i>spline:Spline</i>
<dl><dd>Performs <a class="external text" href="../../XFunction/X-Function/Interp1.html#Algorithm">spline interpolation</a> on the X values.</dd></dl></li>
<li><i>bspline:B-Spline</i>
<dl><dd>Performs <a class="external text" href="../../XFunction/X-Function/Interp1.html#Algorithm">B-Spline interpolation</a> on the X values.</dd></dl></li></ul>
</td></tr>
<tr>
<td>No Extrapolation
</td>
<td>extrap
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> This is available only when <b>Averaged X</b> is not set to <b>Full X Range</b>, <b>Custom</b>, and <b>Follow Curve Trace</b>. It is used to specify whether to extrapolate the curves when these curves have different X ranges.
</td></tr>
<tr>
<td>Sort X
</td>
<td>sortx
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> It is available only when <b>Concatenate</b> is selected for <b>Method</b>. It specifies the method to sort the X values of the averaged curve. Y values will be reordered accordingly.
<p>Option list:
</p>
<ul><li><i>none:None</i>
<dl><dd>Do not sort the X values.</dd></dl></li>
<li><i>ascend: Ascending</i>
<dl><dd>Sort the X values ascendingly.</dd></dl></li>
<li><i> descend: Descending</i>
<dl><dd>Sort the X values descendingly</dd></dl></li></ul>
</td></tr>
<tr>
<td>X
</td>
<td>x
</td>
<td>
<p>Output
</p><p>vector
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td> Specifies the column for output averaged X values.
</td></tr>
<tr>
<td>Y
</td>
<td>y
</td>
<td>
<p>Output
</p><p>vector
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td> Specifies the column for output averaged Y values.
</td></tr>
<tr>
<td>Std Dev
</td>
<td>sd
</td>
<td>
<p>Output
</p><p>vector
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td> This variable is available only when the <b>Method</b> is set to <b>Average</b>.  It specifies whether or not to compute the standard deviations of the averaged curve.
</td></tr>
<tr>
<td>Std Err
</td>
<td>se
</td>
<td>
<p>Output
</p><p>vector
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td> This variable is available only when the <b>Method</b> is set to <b>Average</b>.  It specifies whether or not to compute the standard errors of the averaged curve.
</td></tr>
<tr>
<td>N
</td>
<td>n
</td>
<td>
<p>Output
</p><p>vector
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td> This variable is available only when the <b>Method</b> is set to <b>Average</b>.  It specifies whether or not to compute the counts of input data points that correspond to each averaged X value.
</td></tr>
<tr>
<td>Minimum
</td>
<td>min
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> This variable is available only when the <b>Method</b> is set to <b>Average</b>. It specifies whether or not to output the minimum value.
</td></tr>
<tr>
<td>Maximum
</td>
<td>max
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> This variable is available only when the Method variable is set to Average. It specifies whether or not to output the maximum value.
</td></tr>
<tr>
<td>Minimum
</td>
<td>min
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> This variable is available only when the <b>Method</b> is set to <b>Average</b>. It specifies whether or not to output the minimum value.
</td></tr>
<tr>
<td>SD times 2
</td>
<td>sd2
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> This variable is available only when the Method variable is set to Average. It specifies whether or not to compute the standard deviation times 2.
</td></tr>
<tr>
<td>SD times 3
</td>
<td>sd3
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> This variable is available only when the Method variable is set to Average. It specifies whether or not to compute the standard deviation times 3.
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>This function calculates the average of the input curves or concatenates them, and then outputs the X, Y value as vectors, along with any other selected outputs.
</p><p>If the <b>Method</b> variable is set to <b>Concatenate</b>, the input ranges will be joined to form a larger data set. Otherwise, the averaged Y values for the input curves will be computed.
</p><p>The interpolation is performed on all the input curves' y values on a uniform X range for the averaged curve. Or, you can simply join the x values of all the input curves to form a larger data set. In this case, you can specify a tolerance and the minor differences in x values are ignored.
</p><p>If x values of input curves are not monotonic, the curves are sorted first and then Origin averages these monotonic curves.
For average computation, the standard deviations, standard errors and number of points that correspond to each X value can be also output.
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p>The following script command is used to average two curves data in the active worksheet using linear interpolation on the X values.
</p>
<pre class="lt" style="font-family:monospace;">averagexy iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#40;</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>,col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>,<span style="color: #000000;">&#40;</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>, col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span> method<span style="color: #000000;">:</span><span style="color: #000080;">=</span>ave avex<span style="color: #000000;">:</span><span style="color: #000080;">=</span>common x<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>new<span style="color: #000080;">&gt;</span> y<span style="color: #000000;">:</span><span style="color: #000080;">=</span> <span style="color: #000080;">&lt;</span>new<span style="color: #000080;">&gt;</span>;</pre>
<p>Then two columns are added to the input worksheet. One stores the x values and other stores the y values of the averaged curve.
</p>
<h2><a name="Algorithm"></a><span class="mw-headline">Algorithm</span></h2>
<p>When the <b>Method</b> variable is set to <b>Concatenate</b>, all the input ranges are simply joined together. Otherwise, average Y values are computed for the input curves. For computing the X values of the averaged curve, this X-Function provides five methods. 
</p><p>For more information about the method of computing the x values, please refer to the <a class="external text" href="../../XFunction/X-Function/Avecurves.html#algorithm">algorithm of avecurves</a>.
</p>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">Related X-Functions</span></h2>
<p><a href="../../XFunction/X-Function/Avecurves.html" title="X-Function:Avecurves">avecurves</a>
</p>





