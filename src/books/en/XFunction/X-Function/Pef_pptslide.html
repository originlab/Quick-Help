<h1 class="firstHeading">2.14.2.26 pef_pptslide</h1><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">Menu Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Additional_Information"><span class="tocnumber">3</span> <span class="toctext">Additional Information</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Command_Line_Usage"><span class="tocnumber">4</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#X-Function_Execution_Options"><span class="tocnumber">5</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Variables"><span class="tocnumber">6</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Description"><span class="tocnumber">7</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Examples"><span class="tocnumber">8</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Related_X-Functions"><span class="tocnumber">9</span> <span class="toctext">Related X-Functions</span></a></li>
</ul>
</div>

<h2><a name="Menu_Information"></a><span class="mw-headline">Menu Information</span></h2>
<p>Beginning with Origin 2021b, this routine is replaced in the user-interface by the <a class="external text" href="https://www.originlab.com/FileExchange/Details.aspx?fid=374" target="_blank">Send Graphs to PowerPoint App</a> that is pre-installed with the Origin software. The pef_pptslide X-Function remains a part of the Origin software and can be called via script or by typing the following in the Script Window:
</p>
<pre class="lt" style="font-family:monospace;">pef_pptslide <span style="color: #000080;">-</span>d; <span style="color: #008000;">// opens the pef_pptslide dialog box</span>
pef_pptslide <span style="color: #000080;">-</span>h; <span style="color: #008000;">// dumps parameters to the Script Window</span></pre>
<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Send selected graphs to PowerPoint
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">Additional Information</span></h2>
<p class="version" >Minimum Origin Version Required: 2016 SR0</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
1.pef_pptslide export:=recursive;
</p><p>2.pef_pptslide export:=open top:=10 left:=10 bottom:=10 right:=10 title:=bottom;
</p><p>3.pef_pptslide embed:=1 title:=top mode:=lname slide:=2 slidemode:=insert;
</p><p>4.pef_pptslide export:=page title:=top mode:=lname slidemode:=insert srcf:="C:\Program Files\OriginLab\Origin2016\Samples\Import and Export\Column_Plots_in_Sample_OPJ.pptx" dstf:=E:\MyOriginGraphs.pptx;
</p><p></code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Select Graph(s)
</td>
<td>export
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify which graph(s) to be exported to PowerPoint slides.
<p>Option list:
</p>
<ul><li><i>folder{0}:All in Active Folder</i>
<dl><dd> All the graph pages in active folder of the project (see this in Project Explorer) will be exported. The pages in subfolders will not be included. Hidden pages will also be included, while embedded graph pages in worksheet will not be included.</dd></dl></li>
<li><i>recursive{1}: All in Active Folder (Recursive)</i>
<dl><dd> All the graph pages in active folder of the project (see this in Project Explorer) will be exported. The subfolders will be recursively included.</dd></dl></li>
<li><i>open{2}: All in Active Folder (Open)</i>
<dl><dd> All the opened (not hidden) pages in active folder of the project will be exported.</dd></dl></li>
<li><i>project{3}: All in Project</i>
<dl><dd> All the graph pages in the project will be exported. Hidden graph pages will be included while embedded pages will not.</dd></dl></li>
<li><i>page{4}: Active Page</i>
<dl><dd> Currently active page will be exported.</dd></dl></li>
<li><i>specified{5} Specified</i>
<dl><dd> Other than the options above. Specify the pages in Graph Page below.</dd></dl></li></ul>
</td></tr>
<tr>
<td>Include Embedded Graphs
</td>
<td>embed
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify whether to export embedded graphs to PowerPoint slides.
</td></tr>
<tr>
<td>Insert Graphs as
</td>
<td>insert
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> Specify the form of graphs when exported to PowerPoint slides.
<p>Option list:
</p>
<ul><li><i>pic{0}:Picture</i>
<dl><dd>Export graphs to PowerPoint slides as pictures.</dd></dl></li>
<li><i>embed{1}:Embedded Object</i>
<dl><dd>Export graphs to PowerPoint slides as embedded objects.</dd></dl></li></ul>
</td></tr>
<tr>
<td>Top Margin (%)
</td>
<td>top
</td>
<td>
<p>Input
</p><p>double
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify the top margin of the slide.
</td></tr>
<tr>
<td>Left Margin (%)
</td>
<td>left
</td>
<td>
<p>Input
</p><p>double
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify the left margin of the slide.
</td></tr>
<tr>
<td>Bottom Margin (%)
</td>
<td>bottom
</td>
<td>
<p>Input
</p><p>double
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify the bottom margin of the slide.
</td></tr>
<tr>
<td>Right Margin (%)
</td>
<td>right
</td>
<td>
<p>Input
</p><p>double
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify the right margin of the slide.
</td></tr>
<tr>
<td>Keep Aspect Ratio
</td>
<td>keepratio
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> Specify whether to keep aspect ratio.
</td></tr>
<tr>
<td>Title Line
</td>
<td>title
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specifies how the title will be shown in the PowerPoint slides.
<p>Option list:
</p>
<ul><li><i>none{0}:None</i>
<dl><dd>Do not show the title. </dd></dl></li>
<li><i>top{1}:Top of Slide</i>
<dl><dd>Show the title at the top of screen.</dd></dl></li>
<li><i>bottom{2}:Bottom of Slide</i>
<dl><dd>Show the title at the bottom of screen. </dd></dl></li></ul>
</td></tr>
<tr>
<td>Title Mode
</td>
<td>mode
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> This variable is only available when the <i>title</i> variable is not 0. It specifies what should be used as the exported graph title in each slide.
<p>Option list:
</p>
<ul><li><i>custom{0}:Custom</i>
<dl><dd>Use a customized string(supports substitution notation) as title.</dd></dl></li>
<li><i>sname{1}:Window Short Name</i>
<dl><dd>Use the short name of each graph window as title.</dd></dl></li>
<li><i>lname{2}: Window Long Name</i>
<dl><dd>Use the long name of each graph window as title.</dd></dl></li>
<li><i>lsname{3}: Window Short and Long Name</i>
<dl><dd>Use the short name and long name of each graph window as title.</dd></dl></li>
<li><i>path{4}: Window Path</i>
<dl><dd>Use the file path of each graph window in <b>Project Explorer</b> as title.</dd></dl></li></ul>
</td></tr>
<tr>
<td>Custom Title String
</td>
<td>custom
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td> This variable is only writable when <i>mode</i> is set to <i>custom</i>. Used in specifying a custom string to be used as slide title.
</td></tr>
<tr>
<td>Starting Slide Index
</td>
<td>slide
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> Define the starting slide index number in the PowerPoint presentation file.
</td></tr>
<tr>
<td>Slide Mode
</td>
<td>slidemode
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> Specify the slide mode for exported graphs.
<p>Option list:
</p>
<ul><li><i>insert{0}: Start New</i>
<dl><dd> Starting new slide for each exported graph.</dd></dl></li>
<li><i>replace{1}: Overlay Existing</i>
<dl><dd> Replace existing slide(s).</dd></dl></li></ul>
</td></tr>
<tr>
<td>Load File/Template (Optional)
</td>
<td>srcf
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td> Specify a PowerPoint template file for the exported slides.
</td></tr>
<tr>
<td>Save File As (Optional)
</td>
<td>dstf
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td> Specify the path and name of the PowerPoint Presentation file (*.ppt;*.pptx;*.pptm), PowerPoint Show (*.pps;*.ppsx;*.ppsm) or Design Template (*.pot;*.potx;*.potm) to be saved. Slides will be exported to this file.
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>This function is capable of exporting specified graphs to PowerPoint slides. Each graph will be pasted into one slide in the PowerPoint file.
</p><p>It offers an option to allow you to select graphs within project, folders or subfolders and whether to skip the hidden graphs that are not shortcuts.
</p><p>The order of exportation is as following:
The graphs in the top folder will be exported first, then the graphs in subfolder will be exported. If there are more than one subfolder, alphabetical order will be applied to process the subfolders. For graphs in the same folder, the <a class="external text" href="../../UserGuide/UserGuide/Using_Project_Explorer_to_Manage_Your_Windows.html#Changing_the_order_of_the_graphs">slide indices</a> (index of <b>Slide</b> column in the <b>Project Explorer</b>, which can be change by dragging and dropping graphs in the <b>Project Explorer</b>.) of the graphs will be applied.
</p><p><b>Note</b>: To export graphs to PowerPoint slides, Microsoft Office must have been installed. If the version of Office is 2007, Office has to be upgraded to SP2. Or this X-Function will not work fine.
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p>The following example can be worked in two ways: The first part of the example uses the user-interface and the <b>pef_pptslide</b> X-Function dialog box. The second part shows the same example being entirely scripted.
</p>
<ol><li>Open the project named <i>&lt;Origin Installation Directory&gt;\Samples\Graphing\Customizing Graphs.opj</i>.</li>
<li>Highlight the root folder (<b>Customizing Graphs</b>) of the project.</li>
<li> Click <b>Window: Script Window</b> and at the prompt, type the following and press Enter:<br />
<dl><dd><pre class="lt" style="font-family:monospace;">pef_pptslide <span style="color: #000080;">-</span>d</pre>  </dd></dl></li>
<li>In the <b>pef_pptslide</b> dialog, change the settings as the following image shows. For <b>Load File/Template(Optional)</b> browse to and add <i>&lt;Origin Installation Directory&gt;\Samples\Import and Export\Column_Plots_in_Sample_OPJ.pptx</i>.</li>
<li> For <b>Save File As(Optional)</b>, enter some convenient path and name for your output ppt(x) file.
<dl><dd><a  class="image"><img alt="Pef pptslide example 02.png" src="../images/Pef_pptslide/Pef_pptslide_example_02.png?v=79740" width="434"  /></a></dd></dl></li>
<li>Click the <b>OK</b> button. The graphs in the project will be sent as embedded objects to the newly-created PowerPoint file. You can browse to and open the output file. Slides 3, 4 and 5 should appear as in the image below. Hint: if you lost track of your output file, you can find the save path by clicking on the <b>Messages Log</b> tab to the left side of your Origin workspace.
<dl><dd><a  class="image"><img alt="Pef pptslide example 03.png" src="../images/Pef_pptslide/Pef_pptslide_example_03.png?v=79741" width="826"  /></a></dd></dl></li></ol>
<p><br />
<i><b>Script Solution:</b></i>
</p>
<ol><li> Run Origin and (a) close any open projects and (b) make sure that your PowerPoint software is not running.</li>
<li> Copy the following script to the Script Window (<b>Window: Script Window</b>), highlight the entire script and press Enter.</li></ol>
<pre class="lt" style="font-family:monospace;">string outname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">%</span>YMyOriginGraphs.<span style="color: #000080;">pptx</span>;
string pptname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> SYSTEM.<span style="color: #000080;">PATH</span>.<span style="color: #000080;">PROGRAM</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Import and Export\Column_Plots_in_Sample_OPJ.pptx&quot;</span>;
string fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> SYSTEM.<span style="color: #000080;">PATH</span>.<span style="color: #000080;">PROGRAM</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Graphing\Customizing Graphs.opj&quot;</span>;
doc <span style="color: #000080;">-</span>o <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>fname<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>;
pef_pptslide export<span style="color: #000000;">:</span><span style="color: #000080;">=</span>recursive insert<span style="color: #000000;">:</span><span style="color: #000080;">=</span>pic top<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">5</span> left<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">5</span> bottom<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">5</span> right<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">5</span> keepratio<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> title<span style="color: #000000;">:</span><span style="color: #000080;">=</span>bottom mode<span style="color: #000000;">:</span><span style="color: #000080;">=</span>path slide<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span> slidemode<span style="color: #000000;">:</span><span style="color: #000080;">=</span>insert srcf<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;%(pptname$)&quot;</span> dstf<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;%(outname$)&quot;</span>;
type <span style="color: #000080;">-</span>b <span style="color: #ff00ff;">&quot;Your Script Has Completed!&quot;</span>;</pre>
<p>After the script runs, you should be able to browse to your \User Files (<b>Help: Open Folder: User Files</b>) and find your pptx file named as <i>MyOriginGraphs.pptx</i>.
</p>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">Related X-Functions</span></h2>
<p><a href="../../XFunction/X-Function/Pef_slideshow.html" title="X-Function:Pef slideshow">pef_slideshow</a>,<a href="../../XFunction/X-Function/Pemp_pptslide.html" title="X-Function:Pemp pptslide">pemp_pptslide</a>, <a href="../../XFunction/X-Function/Pef_slideshow.html" title="X-Function:Pef slideshow">pef_slideshow</a>
</p>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>publishing, export</span></p>






