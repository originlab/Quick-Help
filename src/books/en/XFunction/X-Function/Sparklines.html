<h1 class="firstHeading">2.2.3.26 sparklines</h1><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">Menu Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Command_Line_Usage"><span class="tocnumber">3</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#X-Function_Execution_Options"><span class="tocnumber">4</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Variables"><span class="tocnumber">5</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Description"><span class="tocnumber">6</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Examples"><span class="tocnumber">7</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Related_X-Functions"><span class="tocnumber">8</span> <span class="toctext">Related X-Functions</span></a></li>
</ul>
</div>

<h2><a name="Menu_Information"></a><span class="mw-headline">Menu Information</span></h2>
<p>Add or Update Sparklines
</p>
<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Add sparkline graph to columns
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
</p><p>1. sparklines logy:=1; 
</p><p>2. sparklines sel:=0 c1:=4 c2:=6; 
</p><p>3. sparklines iw:=[Book1]Sheet1! sel:=0 c1:=2 c2:=5;
</p><p>4. sparklines iw:=[Book1]Sheet1! sel:=0 c1:=6 c2:=8 plottype:=box; 
</p><p>5. sparklines plottype:=1;
</p><p>6. sparklines iw:=[Book1]Sheet1! sel:=0 c1:=6 c2:=8 template:=tabel row_height:=300 keepAspect:=0 label:=0 endpts:=0; 
</p><p></code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Input Worksheet
</td>
<td>iw
</td>
<td>
<p>Input
</p><p>Worksheet
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td>
<p>Specify the worksheet to manipulate. The default worksheet is the active worksheet.
</p>
</td></tr>
<tr>
<td>Selected Columns
</td>
<td>sel
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td>
<p>By default, this option is enabled, which automatically uses the selected columns as input. If the box is cleared, the columns or range to add sparklines to should be specified in <b>Column From</b> and <b>Column to</b> below. Sparklines will be added to the specified columns. 
</p>
</td></tr>
<tr>
<td>Column From
</td>
<td>c1
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td>
<p>Specify from which column to be manipulated.
</p>
</td></tr>
<tr>
<td>Column To
</td>
<td>c2
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>Specify to which column to be manipulated.
</p>
</td></tr>
<tr>
<td>Plot Type
</td>
<td>plottype
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td><center>0</center>
</td>
<td>
<p>Specify the plot type of the sparkline. 
<br />
Option list:
</p>
<ul><li><i>line:Line</i>
<dl><dd>Line</dd></dl></li>
<li><i>his:Histogram</i>
<dl><dd>Histogram</dd></dl></li>
<li><i>box:Box</i>
<dl><dd>Box chart</dd></dl></li></ul>
</td></tr>
<tr>
<td>Graph Template
</td>
<td>template
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>sparkline_label</center>
</td>
<td>
<p>Specify the template that will be used for the sparkline.
</p>
</td></tr>
<tr>
<td>Row Height (percent)
</td>
<td>row_height
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>200</center>
</td>
<td>
<p>Specify the sparkline row height. By default, it is double normal cell height.
</p>
</td></tr>
<tr>
<td>Keep Aspect Ratio
</td>
<td>keepAspect
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>Specify whether to keep aspect ratio of the sparklines. By default, this option is disabled and a change of aspect ratio in the graph will not show in the sparkline. If this box is selected, changing the aspect ratio of X and Y axes in the graph will change the aspect ratio on the sparkline. 
</p>
</td></tr>
<tr>
<td>Hide Annotations
</td>
<td>label
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td>
<p>If this box is checked, graph annotations are not shown in the sparkline. If the box is cleared, annotations will show. By default, annotations are hidden.
</p>
</td></tr>
<tr>
<td>Show First and Last Points
</td>
<td>endpts
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td>
<p>If this box is checked, the first and last points will be marked in the sparklines.
</p>
</td></tr>
<tr>
<td>Plot Y Against X
</td>
<td>xy
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>Specify whether to plot the Y data against the associated X dataset. If disabled, data are plotted against row numbers.
</p>
</td></tr>
<tr>
<td>Log10 X Scale
</td>
<td>logx
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>Use log10 for X scale type. It is available only when "Line" is selected for Plot Type.
</p>
</td></tr>
<tr>
<td>Log10 Y Scale
</td>
<td>logy
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>Use log10 for Y scale type.
</p>
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>The sparklines can display the profile of the data in any numeric or date/time column as a small graphical image that does not show associated x, y axes and labels etc. This feature is implemented according to the definition of sparklines by Edward Tufte. It gives the user a way to quickly view the general trend of the data across many Y columns in a sheet without having to create graph windows. Each Sparkline object is in fact an embedded graph which can be brought up for editing by double-clicking on the sparkline cell.
</p><p>The Sparklines X-function is used to add or update sparkline in worksheet columns. It is accessible from main menu <b>Column: Add or Update Sparklines</b> when a workbook is active; or by right-clicking on column(s) or sparkline cell and selecting <b>Add or Update Sparklines</b> from the context menu.
</p>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/Sparklines/Alert_icon.png?v=0" width="57"  border="0" /></td><td><p>Sparklines can, in large numbers, cause a slow-down in operations. If your project is difficult to work with and you suspect sparklines may be contributing, you can prevent sparkline creation and hide existing sparklines in the project using system variable <a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#S"><b>@SPK</b></a>. Additionally, you can delete sparklines from the current project using <a class="external text" href="../../LabTalk/LabTalk/Delete_(command).html#-spk.3B_Delete_all_project_sparklines"><b>delete -spk</b></a>.
</p>
	</td>
	</tr>
	</table>
<p><b> </b>
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p>In the command window, enter the following script:
</p><p><code>sparklines row_height:=300 keepAspect:=0 plottype:=his;</code>
</p><p>This will add a histogram as sparkline to the active column.
</p>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">Related X-Functions</span></h2>
<p><a href="../../XFunction/X-Function/InsertSparklines.html" title="X-Function:InsertSparklines">insertSparklines</a>, <a href="../../XFunction/X-Function/UpdateSparklines.html" title="X-Function:UpdateSparklines">UpdateSparklines</a>
</p>

