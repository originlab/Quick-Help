<h1 class="firstHeading">2.6.3.9 imgSubtractInterpBG(Pro)</h1><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">Menu Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Additional_Information"><span class="tocnumber">3</span> <span class="toctext">Additional Information</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#X-Function_Execution_Options"><span class="tocnumber">4</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Variables"><span class="tocnumber">5</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Description"><span class="tocnumber">6</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Examples"><span class="tocnumber">7</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Algorithm"><span class="tocnumber">8</span> <span class="toctext">Algorithm</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#References"><span class="tocnumber">9</span> <span class="toctext">References</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#Related_X-Functions"><span class="tocnumber">10</span> <span class="toctext">Related X-Functions</span></a></li>
</ul>
</div>

<h2><a name="Menu_Information"></a><span class="mw-headline">Menu Information</span></h2>
<p>Image: Arithmetic Transform: Subtract Interpolated Background
</p>
<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Subtract the background created with interpolation
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">Additional Information</span></h2>
<p>It is not accessible from script. This feature is OriginPro only.
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<td>
<p><b>Input Image</b>
</p>
</td>
<td>
<p>Specifies the input image to be manipulated. The default input is the active image.
</p>
</td></tr>
<tr>
<td>
<p><b>Anchor Num</b>
</p>
</td>
<td>
<p>Specifies the number of the anchors on the image. The anchors will be used to create the interpolated background.
</p>
</td></tr>
<tr>
<td>
<p><b>Background</b>
</p>
</td>
<td>
<p>Specifies whether or not the background is darker than the foreground.
</p>
</td></tr>
<tr>
<td>
<p><b>Output Matrix</b>
</p>
</td>
<td>
<p>Specifies the output matrix. By default, a new image will be created and used as output.
</p>
</td></tr>
<tr>
<td>
<p><b>Anchor Shape</b>
</p>
</td>
<td>
<p>Specifies the shape of the anchors (either ellipse or rectangle).
</p>
</td></tr>
<tr>
<td>
<p><b>Apply Auto Level</b>
</p>
</td>
<td>
<p>This checkbox specifies whether or not to apply auto color leveling to the image after subtracting the interpolated background
</p>
</td></tr>
<tr>
<td>
<p><b>Adjust Brightness</b>
</p>
</td>
<td>
<p>Specifies the increase/decrease of the brightness for the interpolated background. The value should be an integer between -10 and 10. A negative value will cause the brightness to be reduced while a positive value will result in brightness increase.
</p>
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>When analyzing the contents of an image, the background typically does not contain anything of interest. In fact, in many cases the background can interfere with your analysis. One way to deal with this is to subtract it from the image. Subtracting the background from the image can help to segment out the objects of interest and facilitate further processing.
</p><p>Often, we do not have a previously recorded background or an image of the background without any foreground objects. In this case, background subtract requires estimating the background with some algorithm and then subtracting it from the original image. Two tools provided by OriginPro are capable of performing this kind of background subtraction. They are <a href="../../XFunction/X-Function/ImgSubtractBg.html" title="X-Function:ImgSubtractBg"><b>Subtract Background</b></a> and <b>Subtract Interpolated Background</b>. The major difference between them is the algorithm which is used to generate the background.
</p><p>The <b>ImgSubtractInterpBG</b> X-Funtion, Subtract Interpolated Background tool in OriginPro subtracts the background that is created with interpolation. To create an interpolated background, the X, Y, and Z (Intensity) mean values within the anchor areas are computed. The background image is gridded from these XYZ values by the method of random matrix conversion based on the Thin Plain Spline (TPS) Algorithm. This tool also allows you to determine the anchor number, move and resize the anchors on the image to determine the interpolated background..
</p><p>Note that this function only supports gray scale images.
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p>The following example shows how to subtract an interpolated background from the input image:
</p>
<ol>
<li> Create a new matrix and import <b>Flower.jpg</b> under \Samples\Image Processing and Analysis folder into it.
<li> From the menu, select <b>Image: Conversion: Color to Gray</b>, set 8 as Gray Scale and click OK to convert the image into 8-bit gray scale.
<li> From the menu, select <b>Image: Arithmetic Transform: Subtract Interpolated Background</b> to open the function in the X-Function panel beside the input image.
<li> Change the settings, move and resize the <b>anchors</b> on the image, as shown as below:
<br /><a  class="image"><img alt="BKSubMethod2Setting.png" src="../images/ImgSubtractInterpBG/BKSubMethod2Setting.png?v=5268" width="549"  /></a>
<br />The interpolated background and the preview of the subtracted image will be shown in the new matrix book named <b>imgSubtractIn</b>:
<br />
<table class="NormalTable" style="; border: none; x-border-left: 1px table-solid; x-border-top: 1px table-solid; x-border-right: 1px table-solid; x-border-bottom: 1px table-solid; border-collapse: separate; border-spacing: 0px;background: #EFEFEF" border="1">
<tr>
<td>
<center><a  class="image"><img alt="BKSubMethod2Input.png" src="../images/ImgSubtractInterpBG/BKSubMethod2Input.png?v=5266" width="271"  /></a></center>
</td>
<td>
<center><a  class="image"><img alt="BKSubMethod2Ouput.png" src="../images/ImgSubtractInterpBG/BKSubMethod2Ouput.png?v=5267" width="273"  /></a></center>
</td></tr>
<tr>
<td>
<center><b>The original image</b></center>
</td>
<td>
<center><b>Preview output after subtracted</b></center>
</td></tr></table>
<li> Click <b>OK</b> button, the output image will be outputted into a new matrix book called <b>SubtractedBG</b>.
</ol>
<p>Note: OriginPro includes the ability to automatically recalculate the analysis result of the background subtractoperation any time you change the parameters or update your source data. In addition, the settings for the analysis routine can be saved to an analysis theme for later use with similar data.
</p>
<h2><a name="Algorithm"></a><span class="mw-headline">Algorithm</span></h2>
<p>To create an interpolated background, the X, Y, and Z (Intensity) mean values within the anchor areas will be computed, then the background image is gridded from these XYZ values by the method of random matrix conversion base on <b>Thin Plain spline (TPS)</b> algorithm.
</p><p>The computation of subtracting the interpolated background mainly uses <b>L_CombineBitmapExt</b> function from LEADTOOLS Main API. If <i>Brighter than the Foreground</i> is chosen as <b>Background</b>, the colors of the background will be inverted, and then the background and the input image will be combined with an adding operation. If <i>Darker than the Foreground</i> is chosen as <b>Background</b>, the background and the input image will be combined with a subtraction operation.
</p><p>For more information on how the image is inverted and how the two images are combined please refer to the LEADTOOLS Main API Help file, Version 14 and read the L_InvertBitmap and L_CombineBitmapExt topics.
</p>
<h2><a name="References"></a><span class="mw-headline">References</span></h2>
<p>LEADTOOLS Main API Help file, Version 14
</p>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">Related X-Functions</span></h2>
<p><a href="../../XFunction/X-Function/ImgSubtractBg.html" title="X-Function:ImgSubtractBg">imgSubtractBg</a>, <a href="../../XFunction/X-Function/ImgReplaceBg.html" title="X-Function:ImgReplaceBg">imgReplaceBg</a>, <a href="../../XFunction/X-Function/ImgAutoLevel.html" title="X-Function:ImgAutoLevel">imgAutoLevel</a>, <a href="../../XFunction/X-Function/ImgBrightness.html" title="X-Function:ImgBrightness">imgBrightness</a>
</p>





