<h1 class="firstHeading">2.7.56 imppClamp</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">Menu Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Command_Line_Usage"><span class="tocnumber">3</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#X-Function_Execution_Options"><span class="tocnumber">4</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Variables"><span class="tocnumber">5</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Description"><span class="tocnumber">6</span> <span class="toctext">Description</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#Details_on_Some_Dialog_Options"><span class="tocnumber">6.1</span> <span class="toctext">Details on Some Dialog Options</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Secondary_X-Function_controls"><span class="tocnumber">6.2</span> <span class="toctext">Secondary X-Function controls</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-9"><a href="#Examples"><span class="tocnumber">7</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#Related_X-Functions"><span class="tocnumber">8</span> <span class="toctext">Related X-Functions</span></a></li>
</ul>
</div>

<h2><a name="Menu_Information"></a><span class="mw-headline">Menu Information</span></h2>
<p>File: Import: pCLAMP (ABF, DAT)
</p><p><br />
If you do not see this file type, choose <b>File: Import: Add/Remove File Types...</b>
</p><p><a  class="image"><img alt="File Import Add Menu.png" src="../images/ImppClamp/File_Import_Add_Menu.png?v=81194" width="475"  /></a>
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/ImppClamp/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>To add drag &amp; drop support for a file type, see <a class="external text" href="../../UserGuide/UserGuide/Introduction_to_Import_Filters_Manager.html"><b>Import Filter Manager</b></a>.
</p></td></tr></table>
<p>This X-Function supports file re-import. See <a class="external text" href="../../GettingStarted/OriginLab/Import_Data.html#Re-Importing_Data_Files">this topic</a> for details.
</p>
<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Import pCLAMP file up to version 11 (ABF 2)
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
1. imppClamp; //import pclamp file specified in fname$
</p><p>2. imppClamp fname:="C:\pClampData\Sample.abf";
</p><p>3. imppClamp fname:="C:\pClampData\Sample.abf" orng:=col(1);
</code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>File Name
</td>
<td>fname
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>fname$</center>
</td>
<td> Filename of the file to be imported
</td></tr>
<tr>
<td>File Info And Data Selection
</td>
<td>trfiles
</td>
<td>
<p>Input
</p><p>TreeNode
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td> Treenode that specifies the information of the file and data. For more details, please refer to <a class="external text" href="../../XFunction/X-Function/Details_of_TreeNodes_in_Import_PClamp.html">trfiles</a>.
</td></tr>
<tr>
<td>Import Options
</td>
<td>options
</td>
<td>
<p>Input
</p><p>TreeNode
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td> Treenode that specifies importing options
</td></tr>
<tr>
<td>Output
</td>
<td>orng
</td>
<td>
<p>Output
</p><p>Range
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> This is used in the dialog for displaying the file information and the data information (channels and episodes) in the file. The channels and episodes can
<p>See the syntax <a class="external text" href="../../XFunction/X-Function/Output_Notations.html">here</a>.
</p>
</td></tr>
<tr>
<td>Header Info
</td>
<td>trheader
</td>
<td>
<p>Output
</p><p>TreeNode
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td> Use this to specify the output range.
</td></tr>
<tr>
<td>Repeat Import
</td>
<td>reimp
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>import</center>
</td>
<td> Control how to repeat import the data.
<p>Option list:
</p>
<ul><li><i>import:Import</i></li></ul>
<dl><dd>Import a new data file</dd></dl>
<ul><li><i>direct:Direct Reimport</i></li></ul>
<dl><dd>Reimport the data directly</dd></dl>
<ul><li><i>graph:Reimport From Graph</i></li></ul>
<dl><dd>Reimport the data from the graph</dd></dl>
</td></tr>
<tr>
<td>Theme Settings of FIle Info And Data Selection
</td>
<td>thm
</td>
<td>
<p>Input
</p><p>TreeNode
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td> This variable is not designed for users and not available in the GUI as well, which just used to improve the theme settings for the File Info variable and Data Selection variable.
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>This X-Function can be used to import pCLAMP (ABF, DAT, ab?) data file.
</p>
<h3><a name="Details_on_Some_Dialog_Options"></a><span class="mw-headline">Details on Some Dialog Options</span></h3>
<dl><dd><ul><li><b>Import Options(options)</b></li></ul>
<dl><dd>Please see <a class="external text" href="../../XFunction/X-Function/Details_of_TreeNodes_in_Import_PClamp.html">this page</a> for more details.</dd></dl></dd></dl>
<h3><a name="Secondary_X-Function_controls"></a><span class="mw-headline">Secondary X-Function controls</span></h3>
<p>When you import <b>pCLAMP</b> files, you can opt to open a special pCLAMP plotting panel on the left-side of the target workbook. 
</p>
<dl><dd><a  class="image"><img alt="Importing Third Party Files-1.png" src="../images/ImppClamp/Importing_Third_Party_Files-1.png?v=82819" width="346"  /></a></dd></dl>
<p>This is done by selecting <b>Show Control Panel for Making Plots</b> under the <b>Import Options</b> branch of the <b>imppClamp</b> dialog box. This panel provides controls for such things as plotting <b>channels</b> and <b>episodes</b>, or display of an auxiliary plot control panel on the graph window. The auxiliary panel's <b>Pick Value Line</b> (see the picture below) control allows you to drag a line on the graph to read plot values and save them to a workbook. 
</p>
<dl><dd><a  class="image"><img alt="Importing Third Party Files-2.png" src="../images/ImppClamp/Importing_Third_Party_Files-2.png?v=82820" width="300"  /></a></dd></dl>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p>This example creates a blank workbook named FILAVG by <a href="../../XFunction/X-Function/Newbook.html" title="X-Function:Newbook">newbook</a> X-Function.<br />
Then it creates new sheets by <a href="../../XFunction/X-Function/Newsheet.html" title="X-Function:Newsheet">newsheet</a> X-Function and imports pclamp data files with file name starting with filavg into sheets.<br />
It uses <a href="../../XFunction/X-Function/PlotpClamp.html" title="X-Function:PlotpClamp">plotpclamp</a> X-Function to plot the pclamp data and use <a href="../../XFunction/X-Function/G2w.html" title="X-Function:G2w">g2w</a> X-Function to merge the graphs into a new sheet in workbook.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">////Get Origin Program Files folder</span>
<span style="color: #000080;">%</span>A<span style="color: #000080;">=</span>SYSTEM.<span style="color: #000080;">PATH</span>.<span style="color: #000080;">PROGRAM</span><span style="color: #000080;">$</span>;
<span style="color: #008000;">//create a book to place pclamp data</span>
newbook s<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> name<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;FILAVG&quot;</span> result<span style="color: #000000;">:</span><span style="color: #000080;">=</span>bkn<span style="color: #000080;">$</span>;
<span style="color: #000080;">%</span>b<span style="color: #000080;">=</span>bkn<span style="color: #000080;">$</span>;
<span style="color: #008000;">//set the file1 which will be imported</span>
<span style="color: #008000;">//fname$=&quot;%ASamples\Import and Export\pClamp\FILAVG01.DAT&quot;;</span>
string fns, path<span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;%ASamples\Import and Export\pClamp&quot;</span>; 
findfiles fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>fns<span style="color: #000080;">$</span> ext<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;filavg*.dat&quot;</span>; 
<span style="color: #008000;">//findFiles will pack multiple files separated by \r\n, or CRLF</span>
int n <span style="color: #000080;">=</span> fns.<span style="color: #000080;">GetNumTokens</span><span style="color: #000000;">&#40;</span>CRLF<span style="color: #000000;">&#41;</span>;
int nShtID;
for<span style="color: #000000;">&#40;</span>int ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; ii <span style="color: #000080;">&lt;=</span>n; ii<span style="color: #000080;">++</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
      fname<span style="color: #000080;">$</span><span style="color: #000080;">=</span>fns.<span style="color: #000080;">GetToken</span><span style="color: #000000;">&#40;</span>ii, CRLF<span style="color: #000000;">&#41;</span><span style="color: #000080;">$</span>;
      newsheet b<span style="color: #000000;">:</span><span style="color: #000080;">=</span>bkn<span style="color: #000080;">$</span>;
      nShtID <span style="color: #000080;">=</span> range2UID<span style="color: #000000;">&#40;</span>sname<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>;
      <span style="color: #008000;">//wactive sheet:=uid2name(nShtID)$ book:=bkn$;</span>
       <span style="color: #008000;">//import the pclamp files</span>
      imppclamp options.<span style="color: #000080;">Sparklines</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> options.<span style="color: #000080;">XFbar</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> options.<span style="color: #000080;">names</span>.<span style="color: #000080;">FNameToBk</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;
      sname<span style="color: #000080;">$</span><span style="color: #000080;">=</span>uid2name<span style="color: #000000;">&#40;</span>nShtID<span style="color: #000000;">&#41;</span><span style="color: #000080;">$</span>;
       <span style="color: #008000;">//Plot </span>
      plotpclamp iw<span style="color: #000000;">:</span><span style="color: #000080;">=</span>sname<span style="color: #000080;">$</span> stimulur<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> scrollbar<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> ctrl<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;
      win <span style="color: #000080;">-</span>a <span style="color: #000080;">%</span>b;
<span style="color: #000000;">&#125;</span>
<span style="color: #008000;">//merge the result graphs into one book (better to the third sheet)</span>
g2w ow<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>new template<span style="color: #000000;">:</span><span style="color: #000080;">=</span>graphs name<span style="color: #000000;">:</span><span style="color: #000080;">=</span>graphs<span style="color: #000080;">&gt;</span> option<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span>;</pre>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">Related X-Functions</span></h2>
<p><a href="../../XFunction/X-Function/PlotpClamp.html" title="X-Function:PlotpClamp">plotpClamp</a>, <a href="../../XFunction/X-Function/Impinfo.html" title="X-Function:Impinfo">impinfo</a>, <a href="../../XFunction/X-Function/ImpFileSel.html" title="X-Function:ImpFileSel">impFileSel</a>
</p>

