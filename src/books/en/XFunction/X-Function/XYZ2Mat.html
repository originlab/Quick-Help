<h1 class="firstHeading">2.2.1.12 XYZ2Mat</h1><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">Menu Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Command_Line_Usage"><span class="tocnumber">3</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#X-Function_Execution_Options"><span class="tocnumber">4</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Variables"><span class="tocnumber">5</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Examples"><span class="tocnumber">6</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Description"><span class="tocnumber">7</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#More_Information"><span class="tocnumber">8</span> <span class="toctext">More Information</span></a>
<ul>
<li class="toclevel-2 tocsection-9"><a href="#settings_.28Gridding_Settings.29"><span class="tocnumber">8.1</span> <span class="toctext">settings (Gridding Settings)</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Algorithm"><span class="tocnumber">8.2</span> <span class="toctext">Algorithm</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#References"><span class="tocnumber">8.3</span> <span class="toctext">References</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-12"><a href="#Related_X-Functions"><span class="tocnumber">9</span> <span class="toctext">Related X-Functions</span></a></li>
</ul>
</div>

<h2><a name="Menu_Information"></a><span class="mw-headline">Menu Information</span></h2>
<p>Worksheet: Convert to Matrix: XYZ Gridding
</p>
<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Convert XYZ data to matrix
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
1. XYZ2Mat iz:=(col(a),col(b),col(c)) settings.ConvertToMatrix:=1 om:=&lt;new: Sparse&gt;;
</p><p>2. XYZ2Mat -r 2 iz:=[Book1]Sheet1!((A"x position",B"y position",C:F)) settings.ConvertToMatrix:=2;
</code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Input
</td>
<td>iz
</td>
<td>
<p>Input
</p><p>XYZRange
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> XYZ worksheet data which needs to convert into matrix by gridding. If multiple Z columns are specified, each Z column will be converted to a matrix object of the same matrix sheet.
</td></tr>
<tr>
<td>Gridding Settings
</td>
<td>settings
</td>
<td>
<p>Input
</p><p>TreeNode
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td> Settings for gridding XYZ worksheet data. Please refer to <a href="#settings_.28Gridding_Settings.29"><b>More Information</b> section</a> below for more details.
</td></tr>
<tr>
<td>Output Matrix
</td>
<td>om
</td>
<td>
<p>Output
</p><p>MatrixLayer
</p>
</td>
<td> <center>&lt;new&gt;</center>
</td>
<td> If this check-box is selected, it allows specifying a matrix for the output gridding data. <b>Output Matrix</b> and <b>Output Virtual Matrix</b> can only one be selected.
<p>See the syntax of <a class="external text" href="../../XFunction/X-Function/Output_Notations.html">Output Notations</a>.
</p>
</td></tr>
<tr>
<td>Output Virtual Matrix
</td>
<td>ovm
</td>
<td>
<p>Output
</p><p>Worksheet
</p>
</td>
<td> <center>&lt;new&gt;</center>
</td>
<td> If this check-box is selected, it allows specifying a worksheet for the output gridding data. And the output worksheet is arranged as a virtual matrix. <b>Output Matrix</b> and <b>Output Virtual Matrix</b> can only one be selected. And if input range contains multiple sets of Z columns, virtual matrix is not supported.
<p>See the syntax of <a class="external text" href="../../XFunction/X-Function/Output_Notations.html">Output Notations</a>.
</p>
</td></tr></table>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<ol><li>Create a new workbook and import the data <i>&lt;Origin Installation Directory&gt;\Samples\Matrix Conversion and Gridding\XYZ Random Gaussian.dat</i> into this workbook.</li>
<li>Highlight column C and select <b>Set As: Z</b> from the right-click menu to set column C as Z column.</li>
<li>Keep column C highlighted and select main menu <b>Worksheet: Convert to Matrix: XYZ Gridding</b> or run <code>XYZ2Mat -d;</code> in the Command Window to open the <b>XYZ Gridding</b> dialog.</li>
<li>Expand the <b>Gridding Settings</b> branch, choose <b>Random (Renka Cline)</b> from the <b>Gridding Method and Parameters</b> drop-down list, and <b>3D Color Map Surface</b> from the <b>Preview Plot Type</b> drop-down list. Check the <b>Preview</b> check-box to the left of the <b>OK</b> button. In the <b>Preview</b> panel, select the <b>Preview Result</b> tab to show the result in 3D color map surface graph.
<dl><dd><a  class="image"><img alt="Xyz2mat example dialog.png" src="../images/XYZ2Mat/Xyz2mat_example_dialog.png?v=83837" width="799"  /></a></dd></dl></li>
<li>Click the <b>OK</b> button to get the result as below.
<dl><dd><a  class="image"><img alt="Xyz2mat example result.png" src="../images/XYZ2Mat/Xyz2mat_example_result.png?v=83838" width="763"  /></a></dd></dl></li></ol>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>This X-Function convert XYZ worksheet data into matrix by XYZ Gridding. For more information, please refer to our User Guide: <a class="external text" href="../../UserGuide/Category/XYZ_Gridding_Methods.html">Description of XYZ Gridding Methods</a>.
</p>
<h2><a name="More_Information"></a><span class="mw-headline">More Information</span></h2>
<h3><a name="settings_.28Gridding_Settings.29"></a><span class="mw-headline">settings (Gridding Settings)</span></h3>
<p>The <b>settings (Gridding Settings)</b> tree specifies the XYZ gridding settings.
</p><p>Syntax:  <b>settings.<i>Treenode</i>:=&lt;value&gt;</b>
</p><p>Example: <i><b>settings.ConvertToMatrix:=2</b></i>
</p><p><br />
</p>
<table class="simple">
<tr>
<th width="20%">
</th>
<th> Treenode
</th>
<th> Type
</th>
<th> Default
</th>
<th> Description
</th></tr>
<tr>
<th rowspan="5">ExamData <br />(Data Examination)
</th>
<td>XStepTol (Tolerance for Even X Step)
</td>
<td>doule
</td>
<td>1E-8
</td>
<td rowspan="5"><a class="external text" href="../../UserGuide/UserGuide/The_XYZ_Gridding_Dialog_Box.html#Data_Examination">ExamData (Data Examination)</a>
</td></tr>
<tr>
<td>YStepTol (Tolerancce for Even Y Step)
</td>
<td>double
</td>
<td>1E-8
</td></tr>
<tr>
<td>XPrecision (Tolerance for Duplicate X)
</td>
<td>double
</td>
<td>1E-8
</td></tr>
<tr>
<td>YPrecision (Tolerance for Duplicate Y)
</td>
<td>double
</td>
<td>1E-8
</td></tr>
<tr>
<td>RemoveDuplicate (Replace Duplicate With)
</td>
<td>int
</td>
<td>0
</td></tr>
<tr>
<th rowspan="13">ConvertToMatrix<br />(Gridding Method and Parameters)
</th>
<td>columns (Columns)
</td>
<td>int
</td>
<td>20
</td>
<td rowspan="13"><a class="external text" href="../../UserGuide/UserGuide/The_XYZ_Gridding_Dialog_Box.html#Gridding_Method_and_Parameters">Gridding Method and Parameters</a>
</td></tr>
<tr>
<td>rows (Rows)
</td>
<td>int
</td>
<td>20
</td></tr>
<tr>
<td>QILF (Quadratic Interpolant Locality Factor)
</td>
<td>double
</td>
<td>18
</td></tr>
<tr>
<td>WFLF (Weight Function Locality Factor)
</td>
<td>double
</td>
<td>9
</td></tr>
<tr>
<td>searchradiu (Search Radius)
</td>
<td>doule
</td>
<td>2
</td></tr>
<tr>
<td>averadius
</td>
<td>double
</td>
<td>2
</td></tr>
<tr>
<td>minipoints (Minimum Points)
</td>
<td>double
</td>
<td>10
</td></tr>
<tr>
<td>maxipoints (Maximum Points)
</td>
<td>double
</td>
<td>100
</td></tr>
<tr>
<td>CorrelationSmoothing (Smoothing)
</td>
<td>int
</td>
<td>1
</td></tr>
<tr>
<td>TPSSmoothing (Smoothing)
</td>
<td>int
</td>
<td>0
</td></tr>
<tr>
<td>extrapolation (Extrapolation)
</td>
<td>int
</td>
<td>0
</td></tr>
<tr>
<td>outsizevalue (Outside Value)
</td>
<td>int
</td>
<td>0
</td></tr>
<tr>
<td>tolerance (Tolerance)
</td>
<td>double
</td>
<td>0.005
</td></tr>
<tr>
<th>advanced<br />(Advanced)
</th>
<td>SelectRange (Range Restriction)
</td>
<td>treenode
</td>
<td>
</td>
<td> <a class="external text" href="../../UserGuide/UserGuide/The_XYZ_Gridding_Dialog_Box.html#Advanced">Advanced</a>
<ul><li>xmin (X Minimum): 0</li>
<li>xmax (X Maximum): 0</li>
<li>ymin (Y Minimum): 0</li>
<li>ymax (Y Maximum): 0</li></ul>
</td></tr>
<tr>
<th>noextrapolation<br />(No Extrapolation outside Boundary)
</th>
<td>
</td>
<td>int
</td>
<td>0
</td>
<td><a class="external text" href="../../UserGuide/UserGuide/The_XYZ_Gridding_Dialog_Box.html#No_Extrapolation_outside_Boundary">No Extrapolation outside Boundary</a>
</td></tr>
<tr>
<th>previewplottype<br />(Preview Plot Type)
</th>
<td>
</td>
<td>int
</td>
<td>1
</td>
<td><a class="external text" href="../../UserGuide/UserGuide/The_XYZ_Gridding_Dialog_Box.html#Preview_Plot_Type">Preview Plot Type</a>
</td></tr></table>
<h3><a name="Algorithm"></a><span class="mw-headline">Algorithm</span></h3>
<ul><li><a class="external text" href="../../UserGuide/UserGuide/Gridding_of_Regularly_Spaced_Data.html#Checking_the_regularity_of_your_XY_data">Gridding of Regularly Spaced Data</a></li>
<li><a class="external text" href="../../UserGuide/UserGuide/Gridding_of_Sparse_or_Missing_Data.html">Gridding of Sparse or Missing Data</a></li>
<li><a class="external text" href="../../UserGuide/UserGuide/Gridding_Methods_for_Randomly_Spaced_Data.html">Gridding Methods for Randomly Spaced Data</a></li></ul>
<h3><a name="References"></a><span class="mw-headline"><a class="external text" href="../../UserGuide/UserGuide/References,_Matrix_Conversion_and_Gridding.html">References</a></span></h3>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">Related X-Functions</span></h2>
<p><a href="../../XFunction/X-Function/W2m.html" title="X-Function:W2m">w2m</a>, <a href="../../XFunction/X-Function/M2w.html" title="X-Function:M2w">m2w</a>, <a href="../../XFunction/X-Function/R2m.html" title="X-Function:R2m">r2m</a>, <a href="../../XFunction/X-Function/Wexpand2m.html" title="X-Function:Wexpand2m">wexpand2m</a>, <a href="../../XFunction/X-Function/Xyz_regular.html" title="X-Function:Xyz regular">xyz_regular</a>, <a href="../../XFunction/X-Function/Xyz_sparse.html" title="X-Function:Xyz sparse">xyz_sparse</a>, <a href="../../XFunction/X-Function/Xyz_shep.html" title="X-Function:Xyz shep">xyz_shep</a>, <a href="../../XFunction/X-Function/Xyz_shep_nag.html" title="X-Function:Xyz shep nag">xyz_shep_nag</a>, <a href="../../XFunction/X-Function/Xyz_renka.html" title="X-Function:Xyz renka">xyz_renka</a>, <a href="../../XFunction/X-Function/Xyz_renka_nag.html" title="X-Function:Xyz renka nag">xyz_renka_nag</a>, <a href="../../XFunction/X-Function/Xyz_tps.html" title="X-Function:Xyz tps">xyz_tps</a>
</p>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>worksheet, gridding</span></p>






