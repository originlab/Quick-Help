<h1 class="firstHeading">2.4.5 fitLR</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Brief_Information"><span class="tocnumber">1</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Additional_Information"><span class="tocnumber">2</span> <span class="toctext">Additional Information</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Command_Line_Usage"><span class="tocnumber">3</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#X-Function_Execution_Options"><span class="tocnumber">4</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Variables"><span class="tocnumber">5</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Description"><span class="tocnumber">6</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Examples"><span class="tocnumber">7</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Algorithm"><span class="tocnumber">8</span> <span class="toctext">Algorithm</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Related_X-Functions"><span class="tocnumber">9</span> <span class="toctext">Related X-Functions</span></a></li>
</ul>
</div>

<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Simple linear regression
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">Additional Information</span></h2>
<p>Minimum Origin Version Required for documented features: Origin 9.0
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<pre>
1. fitLR (1,2); // Fit using column 1 as X and 2 as Y
2. fitLR iy:=(1,2) N:=5;
3. fitLR (1,2) N:=-10;
4. fitLR iy:=(1,2) N:=-5 oy:=&lt;new&gt;;
5. fitLR iy:=(1,2) fixint:=1 intercept:=0; // Force fit through 0,0 (beginning with 9.0)
6. fitLR iy:=(1,2) fixslope:=1 slope:=0.667; // Force fit to slope of 0.667 (beginning with 9.0)
</pre>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Input
</td>
<td>iy
</td>
<td>
<p>Input
</p><p>XYRange
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td>
<p>This variable specifies the input data range.
</p>
</td></tr>

<tr>
<td>Fit Begin/End Points
</td>
<td>N
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>This variable specifies the number of points to use in the linear regression. When this value is zero, all points in the range are used. When the number is a positive integer, the <b>first</b> N points are used. When the number is a negative integer, the <b>last</b> N points are used.
</p>
</td></tr>

<tr>
<td>Fix Intercept
</td>
<td>fixint
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td><center>0</center>
</td>
<td>
<p>Check this to fix (1) the intercept in linear regression. Default (0) does not fix intercept.
</p>
</td></tr>

<tr>
<td>Fix Intercept At
</td>
<td>intercept
</td>
<td>
<p>Input
</p><p>double
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>Specify the value of fixed intercept. This value is ignored if <i>fixint</i> = 0.
</p>
</td></tr>

<tr>
<td>Fix Slope
</td>
<td>fixslope
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>Check this to fix (1) the slope in linear regression. Default (0) does not fix slope.
</p>
</td></tr>

<tr>
<td>Fix Slope At
</td>
<td>slope
</td>
<td>
<p>Input
</p><p>double
</p>
</td>
<td> <center>1</center>
</td>
<td>
<p>Specify the value of fixed slope. This value is ignored if <i>fixslope</i> = 0.
</p>
</td></tr>

<tr>
<td>Intercept
</td>
<td>a
</td>
<td>
<p>Output
</p><p>double
</p>
</td>
<td><center>&lt;unassigned&gt;</center>
</td>
<td>
<p>The fitted intercept.
</p>
</td></tr>

<tr>
<td>Slope
</td>
<td>b
</td>
<td>
<p>Output
</p><p>double
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td>
<p>The fitted slope.
</p>
</td></tr>

<tr>
<td>Intercept Error
</td>
<td>aerr
</td>
<td>
<p>Output
</p><p>double
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td>
<p>If defined, this variable will contain the intercept error.
</p>
</td></tr>
<tr>
<td>Slope Error
</td>
<td>berr
</td>
<td>
<p>Output
</p><p>double
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td>
<p>If defined, this variable will contain the slope error.
</p>
</td></tr>
<tr>
<td>R value
</td>
<td>r
</td>
<td>
<p>Output
</p><p>double
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td>
<p>If defined, this variable will contain the Adjusted residual sum of squares.
</p>
</td></tr>
<tr>
<td>Number of Actual Points Used
</td>
<td>pts
</td>
<td>
<p>Output
</p><p>int
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td>
<p>If defined, this variable will contain the number of points in the fit. This will be the number of points in the range when N = 0 is used to fit all points.
</p>
</td></tr>
<tr>
<td>Output
</td>
<td>oy
</td>
<td>
<p>Output
</p><p>XYRange
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td>
<p>This variable specifies the output range for creating the fit line datasets.
</p>
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>This X-Function calculates the slope and intercept of the linear regression line. Regardless of the settings for optional outputs, the function creates a Tree object named fitlr which contains these property values:<br />
fitlr.iy$<br />
fitlr.N<br />
fitlr.fixint<br />
fitlr.intercept<br />
fitlr.fixslope<br />
fitlr.slope<br />
fitlr.a<br />
fitlr.b<br />
fitlr.aerr<br />
fitlr.berr<br />
fitlr.r<br />
fitlr.pts<br />
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<ul><li> Code Sample</li></ul>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//Shows how to use fitLR on various ranges from provided sample data and dump the results</span>
<span style="color: #008000;">//Create a new workbook and import the sample file</span>
string ResultBook<span style="color: #000080;">$</span>;
newbook name<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Linear Regression Sample&quot;</span> sheet<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> result<span style="color: #000000;">:</span><span style="color: #000080;">=</span>ResultBook<span style="color: #000080;">$</span>;
impfile fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span><span style="color: #000080;">+</span><span style="color: #ff00ff;">&quot;Samples\Curve Fitting\Multiple Gaussians.dat&quot;</span>;

type <span style="color: #ff00ff;">&quot;The fit result of the first 25 points of curve B:&quot;</span>;
range aa <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>ResultBook<span style="color: #000080;">$</span><span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #0000dd;">2</span>;
fitLR iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span>aa n<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">25</span>;
fitLR.<span style="color: #000080;">b</span><span style="color: #000080;">=</span>;
fitLR.<span style="color: #000080;">a</span><span style="color: #000080;">=</span>;
type;

type <span style="color: #ff00ff;">&quot;The fit result of the last 25 points of curve C:&quot;</span>;
range bb <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>ResultBook<span style="color: #000080;">$</span><span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #0000dd;">3</span>;
fitLR iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span>bb n<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000080;">-</span><span style="color: #0000dd;">25</span>;
fitLR.<span style="color: #000080;">b</span><span style="color: #000080;">=</span>;
fitLR.<span style="color: #000080;">a</span><span style="color: #000080;">=</span>;
type;

type <span style="color: #ff00ff;">&quot;The fit result of the middle portion of the curve D:&quot;</span>;
range cc <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>ResultBook<span style="color: #000080;">$</span><span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">12</span><span style="color: #000000;">:</span><span style="color: #0000dd;">26</span><span style="color: #000000;">&#93;</span>;
fitLR iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span>cc fixint<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> intercept<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;  <span style="color: #008000;">// Force fit through 0,0</span>
fitLR.<span style="color: #000080;">b</span><span style="color: #000080;">=</span>;
fitLR.<span style="color: #000080;">a</span><span style="color: #000080;">=</span>;
type;

type <span style="color: #ff00ff;">&quot;The fit result  of the last 25 points of curve E:&quot;</span>;
range ee <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>ResultBook<span style="color: #000080;">$</span><span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">5</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">25</span><span style="color: #000000;">:</span><span style="color: #0000dd;">50</span><span style="color: #000000;">&#93;</span>;
fitLR iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span>ee fixslope<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> slope<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0.667</span>;  <span style="color: #008000;">// Force fit to slope of 0.667</span>
fitLR.<span style="color: #000080;">b</span><span style="color: #000080;">=</span>;
fitLR.<span style="color: #000080;">a</span><span style="color: #000080;">=</span>;</pre>
<h2><a name="Algorithm"></a><span class="mw-headline">Algorithm</span></h2>
<p>The slope of the linear regression is given by the:
</p>
<dl><dd><a  class="image"><img alt="FitLR help English files image004.gif" src="../images/FitLR/FitLR_help_English_files_image004.gif?v=939" width="143"  /></a> where <a  class="image"><img alt="FitLR help English files image006.gif" src="../images/FitLR/FitLR_help_English_files_image006.gif?v=940" width="91"  /></a> and <a  class="image"><img alt="FitLR help English files image008.gif" src="../images/FitLR/FitLR_help_English_files_image008.gif?v=941" width="92"  /></a></dd></dl>
<p>And the intercept:
</p>
<dl><dd><a  class="image"><img alt="FitLR help English files image010.gif" src="../images/FitLR/FitLR_help_English_files_image010.gif?v=942" width="317"  /></a></dd></dl>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">Related X-Functions</span></h2>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>curve fitting</span></p>






