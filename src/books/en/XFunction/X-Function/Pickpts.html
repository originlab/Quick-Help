<h1 class="firstHeading">2.5.43 pickpts</h1><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Brief_Information"><span class="tocnumber">1</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Additional_Information"><span class="tocnumber">2</span> <span class="toctext">Additional Information</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Command_Line_Usage"><span class="tocnumber">3</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#X-Function_Execution_Options"><span class="tocnumber">4</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Variables"><span class="tocnumber">5</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Description"><span class="tocnumber">6</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Examples"><span class="tocnumber">7</span> <span class="toctext">Examples</span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="#Output_pickpts_data_to_new_sheet"><span class="tocnumber">7.1</span> <span class="toctext">Output pickpts data to new sheet</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Output_data_to_existing_sheet"><span class="tocnumber">7.2</span> <span class="toctext">Output data to existing sheet</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Pick XY data points from a 2D graph.
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">Additional Information</span></h2>
<p><b>Minimum Origin Version Required</b>: 8.1 SR3
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<pre class="lt" style="font-family:monospace;"><span style="color: #0000dd;">1</span>. <span style="color: #000080;">pickpts</span> npts<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span>;
<span style="color: #0000dd;">2</span>. <span style="color: #000080;">pickpts</span> gp<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>Graph2<span style="color: #000000;">&#93;</span> npts<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">5</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>new<span style="color: #000080;">&gt;</span>;</pre>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Input Graph
</td>
<td>gp
</td>
<td>
<p>Input
</p><p>GraphPage
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> Specifies the graph to pick points from
</td></tr>
<tr>
<td>Number of Points to Get
</td>
<td>npts
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>10</center>
</td>
<td> Specifies the number of points to pick from the input graph
</td></tr>
<tr>
<td>Reader Type
</td>
<td>type
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specifies the type for picking points
<p>Option list:
</p>
<ul><li><i>data:Data Reader</i>
<dl><dd>Picks points in Data Reader mode. It only picks up data points existed in the source worksheet.</dd></dl></li>
<li><i>screen:Screen Reader</i>
<dl><dd>Picks points in Screen Reader mode. It allows you to pick up points located anywhere on the graph and reads their XY coordinates from graph.</dd></dl></li></ul>
</td></tr>
<tr>
<td>X Coordinates
</td>
<td>x
</td>
<td>
<p>Output
</p><p>vector
</p>
</td>
<td> <center>&lt;new&gt;</center>
</td>
<td> Specifies the output range for picked points’ X coordinates.
</td></tr>
<tr>
<td>Y Coordinates
</td>
<td>y
</td>
<td>
<p>Output
</p><p>vector
</p>
</td>
<td> <center>&lt;new&gt;</center>
</td>
<td> Specifies the output range for picked points’ Y coordinates
</td></tr>
<tr>
<td>Plot Name
</td>
<td>plot
</td>
<td>
<p>Output
</p><p>vector&lt;string&gt;
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td> Specifies the output range for plot name(s) of the picked data points. It is accessible only when Data Reader is selected for Reader Type.
</td></tr>
<tr>
<td>Point Index
</td>
<td>index
</td>
<td>
<p>Output
</p><p>vector
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td> Specifies the output range for data points’ indices. It is accessible only when Data Reader is selected for Reader Type.
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>This X-Function allows you to pick XY data points from a graph using the Data Reader type or Screen Reader type and gets related coordinate information.
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Pickpts/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>Starting with Origin 2018 SR0, there is <a class="external text" href="../../GettingStarted/OriginLab/Graphical_Exploration_of_Data.html#The_Data_Reader_Tool">a GUI tool</a> that uses the pickpts X-Function. The tool is opened by right-clicking on the data point tooltip that shows when you mouse over a data point in a line, scatter, line + symbol or column/bar chart.
</p></td></tr></table>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p>The following scripts shows how to pick data points from multiple layers.
</p>
<h3><a name="Output_pickpts_data_to_new_sheet"></a><span class="mw-headline">Output pickpts data to new sheet</span></h3>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// create a new worksheet window based on ORIGIN.OTW</span>
win <span style="color: #000080;">-</span>t; 
<span style="color: #008000;">// fill the worksheet with row numbers in the first two columns</span>
col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> data<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">10</span><span style="color: #000000;">&#41;</span>; 
col<span style="color: #000000;">&#40;</span>B<span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> data<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">10</span><span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// fill the third and forth columns with normal random numbers</span>
col<span style="color: #000000;">&#40;</span>C<span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> Normal<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">10</span><span style="color: #000000;">&#41;</span>;
col<span style="color: #000000;">&#40;</span>D<span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> Normal<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">10</span><span style="color: #000000;">&#41;</span>; 

<span style="color: #008000;">// highlight second to forth columns</span>
worksheet <span style="color: #000080;">-</span>s <span style="color: #0000dd;">2</span> <span style="color: #0000dd;">0</span> <span style="color: #0000dd;">4</span> <span style="color: #0000dd;">0</span>; 
<span style="color: #008000;">// plot a 3Ys_Y-Y-Y graph from the selected three columns</span>
run.<span style="color: #000080;">section</span><span style="color: #000000;">&#40;</span>Plot,3Ys_Y<span style="color: #000080;">-</span>Y<span style="color: #000080;">-</span>Y<span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// pick up 5 points from graph, and output their XY coordinates, plot names and indices</span>
pickpts npts<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">5</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>new<span style="color: #000080;">&gt;</span> index<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>new<span style="color: #000080;">&gt;</span>;</pre>
<p>With the graph active, double-click on data points of interest to select them:
</p>
<dl><dd><a  class="image"><img alt="Pickpts 01.gif" src="../images/Pickpts/Pickpts_01.gif?v=14943" width="506"  /></a></dd></dl>
<p>After the selection is done, the results are automatically output to a new worksheet:
</p>
<dl><dd><a  class="image"><img alt="Pickpts 02.gif" src="../images/Pickpts/Pickpts_02.gif?v=14944" width="413"  /></a></dd></dl>
<h3><a name="Output_data_to_existing_sheet"></a><span class="mw-headline">Output data to existing sheet</span></h3>
<p>In this example, we have a three panel (layer) graph, with each layer containing a plot of Assymmetric Gaussian data. We use pickpts to pick the peak point in each and output the result to Book2. Note that we are using a variable of type <a class="external text" href="../../LabTalk/LabTalk/Data_Types_and_Variables.html#StringArray"><b>StringArray</b></a> to store and output the plot names. Also, see <a class="external text" href="../../LabTalk/LabTalk/StringArray_(object).html">StringArray (object)</a>. 
</p><p><a  class="image"><img alt="Pickpts image2.png" src="../images/Pickpts/Pickpts_image2.png?v=79762" width="732"  /></a>
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// create datasets dsx and dsy</span>
dataset dsx, dsy;

<span style="color: #008000;">// create StringArray dsn</span>
StringArray dsn;

<span style="color: #008000;">// call the pickpts X-Function, use Data Reader to pick 3 points.</span>
<span style="color: #008000;">// Put X coordinates in dsx, y coordinates in dsy, point index in dsi, and plot name in dsn</span>
pickpts npts<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span> type<span style="color: #000000;">:</span><span style="color: #000080;">=</span>data x<span style="color: #000000;">:</span><span style="color: #000080;">=</span>dsx y<span style="color: #000000;">:</span><span style="color: #000080;">=</span>dsy index<span style="color: #000000;">:</span><span style="color: #000080;">=</span>dsi plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span>dsn;

<span style="color: #008000;">// define output sheet range with 4 columns</span>
range wks <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>Book2<span style="color: #000000;">&#93;</span>Sheet1<span style="color: #000080;">!</span>;
wks.<span style="color: #000080;">ncols</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span>;

<span style="color: #008000;">// assign long names to each column</span>
wks.<span style="color: #000080;">col1</span>.<span style="color: #000080;">lname</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> X Coordinate;
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">lname</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Y Coordinate;
wks.<span style="color: #000080;">col3</span>.<span style="color: #000080;">lname</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Plot Name;
wks.<span style="color: #000080;">col4</span>.<span style="color: #000080;">lname</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Point Index;

<span style="color: #008000;">// create range variables for each output variable</span>
range aa <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>Book2<span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #0000dd;">1</span>;
range bb <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>Book2<span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #0000dd;">2</span>;
range cc <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>Book2<span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #0000dd;">3</span>;
range dd <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>Book2<span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #0000dd;">4</span>;

<span style="color: #008000;">// output coordinate and index values to Book2</span>
aa <span style="color: #000080;">=</span> dsx;
bb <span style="color: #000080;">=</span> dsy;
dd <span style="color: #000080;">=</span> dsi;

<span style="color: #008000;">// copy StringArray dsn to range cc ([Book2]1!3;)</span>
dsn.<span style="color: #000080;">CopyTo</span><span style="color: #000000;">&#40;</span>cc<span style="color: #000000;">&#41;</span>;</pre>
<table class="note">

<tr>
<td><b>Note:</b> Since Origin 2017 SR0, we can also use a variable of type <a class="external text" href="../../LabTalk/LabTalk/Datasets_(object).html#Creating_a_DatasetCreate_Dataset"><b>Dataset</b></a> to store and output the plot name. For instance, we can change the above example as follows:
<ol>
<li>Create a Text &amp; Numberic dataset dsn to store the plot name.
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//Create a Text &amp; Numberic dataset instead of using StringArry</span>
dataset <span style="color: #000080;">-</span>a dsn;</pre>
<li>After pick the points, then output the plot name to Book2 directly.
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//Output the plot name directly instead of using the CopyTo method.</span>
cc <span style="color: #000080;">=</span> dsn;</pre>
</ol>
</td></tr></table>


