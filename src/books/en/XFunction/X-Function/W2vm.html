<h1 class="firstHeading">2.2.3.29 w2vm</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Brief_Information"><span class="tocnumber">1</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Additional_Information"><span class="tocnumber">2</span> <span class="toctext">Additional Information</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Command_Line_Usage"><span class="tocnumber">3</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#X-Function_Execution_Options"><span class="tocnumber">4</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Variables"><span class="tocnumber">5</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Description"><span class="tocnumber">6</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Related_X-Functions"><span class="tocnumber">7</span> <span class="toctext">Related X-Functions</span></a></li>
</ul>
</div>

<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Create a virtual matrix from worksheet data
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">Additional Information</span></h2>
<p><b>Minimum Origin Version Required</b>: 8.5.1
</p><p>The vmname, coltype, rowtype variables are introduced from Origin 2015.
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
1. w2vm irng:=[Book1]Sheet1 rowpos:=selrow1 colpos:=selcol1 ztitle:=VMObject;
</p><p>2. w2vm irng:=1!2[1]:4[3] rowpos:=3 label:=L colpos:=2 ztitle:=MyVM;
</code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Input
</td>
<td>irng
</td>
<td>
<p>Input
</p><p>Range
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> Specify Z values of the virtual matrix.
</td></tr>
<tr>
<td>Data Layout
</td>
<td>format
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify which way to set the X and Y values.
<p>Option list:
</p>
<ul><li><i>yacross:Y across columns</i>{0}
<dl><dd>Use a row as Y-values and a column as X-values. </dd></dl></li></ul>
<dl><dd></dd></dl>
<ul><li><i>xacross:X across columns</i>{1}
<dl><dd>Use a row as X-values and a column as Y-values. </dd></dl></li></ul>
</td></tr>
<tr>
<td>Y/X Values in
</td>
<td>rowpos
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>&lt;auto&gt;</center>
</td>
<td> Specify the row for Y(or X)-values. Whether Y or X-values are specified is determined by the value of format.
<p>Note that Y(or X)-values in the row should be in descending or ascending order. 
</p><p>Option list:
</p>
<ul><li><i>none:None</i>{0}
<dl><dd>Use column number in the selected range of cells from a worksheet as Y(or X)-values, which starts from 1. </dd></dl></li></ul>
<dl><dd></dd></dl>
<ul><li><i>selrow1:1st row in selection</i>{1}
<dl><dd>Use column number in the selected range of cells from a worksheet as Y(or X)-values, which starts from 1. </dd></dl></li></ul>
<dl><dd></dd></dl>
<ul><li><i>label:Column label</i>{2}
<dl><dd>Use the column labels in the worksheet as the Y(or X)-values. Column Label row is specified in <b>label</b>. Note that if only a range of a worksheet is specified in <b>irng</b>, only the corresponding part of the Column Label row in the worksheet is used as Y(or X)-values. </dd></dl></li></ul>
<dl><dd></dd></dl>
<ul><li><i>custom:Custom</i>{3}
<dl><dd>Specify a row in the worksheet. </dd></dl></li></ul>
<dl><dd></dd></dl>
</td></tr>
<tr>
<td>Y/X Range
</td>
<td>rowrng
</td>
<td>
<p>Input
</p><p>Range
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td> Specify a row for Y(or X)-values. <b>rowrng</b> should be specified only when <b>rowpos</b> is set to <b>Custom</b>.
<p>Note that <b>rowrng</b> should be in the same worksheet of <b>irng</b>. 
</p>
</td></tr>
<tr>
<td>Column Label
</td>
<td>label
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td> Specify a string for Column Label whose row is used as Y(or X)-values. label should be specified only when rowpos is set to <b>Column label</b>. It needs to use a single character to specify the column label row in script. Please refer to <a class="external text" href="../../LabTalk/LabTalk/Column_Label_Row_Characters.html">Column Label Row Characters</a> for the single character of each column label row.
</td></tr>
<tr>
<td>Format Y/X Data
</td>
<td>rowtype
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td>
<p>Specify the data format of the X/Y data. This variable is only accessible when the <b>rowpos</b> variable is not set to 0 (None). You can refer to supported <a class="external text" href="../../UserGuide/UserGuide/Numbers_in_Origin.html#Custom_Display_Format">Origin Formats notation</a> for details.
</p>
</td></tr>
<tr>
<td>X/Y Values in
</td>
<td>colpos
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>&lt;auto&gt;</center>
</td>
<td> Specify the column for X(or Y)-values. Whether X or Y-values are specified is determined by the value of format.
<p>Note that X(or Y)-values in the column should be in descending or ascending order. 
</p><p>Option list:
</p>
<ul><li><i>none:None</i>{0}
<dl><dd>Use row number in the selected range of cells from a worksheet as X(or Y)-values, which starts from 1. </dd></dl></li>
<li><i>selcol1:1st column in selection</i>{1}
<dl><dd>Use the first column in the selection as X(or Y) values. </dd></dl></li>
<li><i>wkscol1:1st column in worksheet</i>{2}
<dl><dd>Use the first column in the worksheet as X(or Y) values.</dd></dl></li>
<li><i>xcol:X column to left of selection</i>{3}
<dl><dd>Use the nearest X column to the left of the range of <b>irng</b> as X(or Y)-values. It can be specified only when there is at least one X column on the left side of the range of <b>irng</b>.</dd></dl></li>
<li><i>custom:Custom</i>{4}
<dl><dd>Specify a column in the worksheet. </dd></dl></li></ul>
<dl><dd></dd></dl>
</td></tr>
<tr>
<td>X/Y Range
</td>
<td>colrng
</td>
<td>
<p>Input
</p><p>Range
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td> Specify a column for X(or Y)-values. <b>colrng</b> should be specified only when <b>colpos</b> is set to <b>Custom</b>.
<p>Note that <b>colrng</b> should be in the same worksheet of <b>irng</b>. 
</p>
</td></tr>
<tr>
<td>Format X/Y Data
</td>
<td>coltype
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td>
<p>Specify the data format of the X/Y data. This variable is only accessible when <b>colpos</b> variable is not set to 0 (None). You can refer to supported <a class="external text" href="../../UserGuide/UserGuide/Numbers_in_Origin.html#Custom_Display_Format">Origin Formats notation</a> for details.
</p>
</td></tr>
<tr>
<td>X Title
</td>
<td>xtitle
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>X Title</center>
</td>
<td> Specify the X-axis title.
</td></tr>
<tr>
<td>Y Title
</td>
<td>ytitle
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>Y Title</center>
</td>
<td> Specify the Y-axis title.
</td></tr>
<tr>
<td>Z Title
</td>
<td>ztitle
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>Z Title</center>
</td>
<td> Specify the Z-axis title (or called long name of the virtual matrix).
</td></tr>
<tr>
<td>Virtual Matrix Name
</td>
<td>vmname
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td> Specify the name of virtual matrix.
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>This X-Function can be used to create a virtual matrix object from worksheet data. After the virtual matrix object has been created, it can be accessed in <b>Plot Details</b> dialog and <b>Layer Contents</b> dialog etc. to create a new graph.
</p>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">Related X-Functions</span></h2>
<p><a href="../../XFunction/X-Function/Plotvm.html" title="X-Function:Plotvm">plotvm</a>
</p>





