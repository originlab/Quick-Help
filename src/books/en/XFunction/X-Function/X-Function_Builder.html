<h1 class="firstHeading">1.1.2 X-Function Builder</h1><p><span class="OIndex" style="display:none">X-Function Builder</span>
Open X-Function Builder by clicking <b>Tools: X-Function Builder</b>. 
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#X-Function_Name"><span class="tocnumber">1</span> <span class="toctext">X-Function Name</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#X-Function_VariableX-Function_Variables"><span class="tocnumber">2</span> <span class="toctext"><span class="OIndex" style="display:none">X-Function Variable</span>X-Function Variables</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#X-Function_Variable_TypeVariable_Data_Type_and_Default_Value"><span class="tocnumber">3</span> <span class="toctext"><span class="OIndex" style="display:none">X-Function Variable Type</span>Variable Data Type and Default Value</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#X-Function_Dialog_ControlsControl_Types"><span class="tocnumber">4</span> <span class="toctext"><span class="OIndex" style="display:none">X-Function Dialog Controls</span>Control Types</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#X-Function_Option_StringsOption_String"><span class="tocnumber">5</span> <span class="toctext"><span class="OIndex" style="display:none">X-Function Option Strings</span>Option String</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#X-Function_Dialog_ThemeTheme_ID"><span class="tocnumber">6</span> <span class="toctext"><span class="OIndex" style="display:none">X-Function Dialog Theme</span>Theme ID</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#X-Function_Tree_ViewTree_View"><span class="tocnumber">7</span> <span class="toctext"><span class="OIndex" style="display:none">X-Function Tree View</span>Tree View</span></a></li>
</ul>
</div>

<h2><a name="X-Function_Name"></a><span class="mw-headline">X-Function Name</span></h2>
<p>Input the X-Function name in the X-Function edit box. 
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/X-Function_Builder/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>Do not give your X-Function the same name as an existing LabTalk macro, OGS file, LabTalk command, or LabTalk callable Origin C function. 
</p><p>If two or more of these have the same name, the priority order of calling is: LabTalk macros &gt; LabTalk OGS &gt; X-Function &gt; LabTalk callable Origin C functions &gt; LabTalk commands.
</p></td></tr></table>
<p><br />
</p>
<h2><a name="X-Function_VariableX-Function_Variables"></a><span class="mw-headline"><span class="OIndex" style="display:none">X-Function Variable</span>X-Function Variables</span></h2>
<table class="simple">
<tr>
<th> Name
</th>
<td>
<p>Specify the name of the variable. When the X-Function is executed by script, you have to assign values to variables using their names. Therefore, we recommend that you use shorter names and begin them with different characters.
</p>
</td></tr>
<tr>
<th> Label
</th>
<td>
<p>Specify a label for the variable. Special characters and white space are allowed. Displays on the X-Function dialog as control label.  If not specified, variable name will be used.
</p>
</td></tr>
<tr>
<th> Input/Output
</th>
<td>
<p>Specify whether the variable is used for input, output or both.
</p>
</td></tr>
<tr>
<th> Data Type
</th>
<td>
<p>Specify the variable data type. 
</p><p>More details can be referred to below in the <a href="../../XFunction/X-Function/X-Function_Builder.html#X-Function_Variable_TypeVariable_Data_Type_and_Default_Value" title="X-Function:X-Function Builder">Variable Data Type and Default Value</a> section.
</p>
</td></tr>
<tr>
<th> Data
</th>
<td>
<p>Specify the default value for the variable. More details can be referred to below in the <a href="../../XFunction/X-Function/X-Function_Builder.html#X-Function_Variable_TypeVariable_Data_Type_and_Default_Value" title="X-Function:X-Function Builder">Variable Data Type and Default Value</a> section.
</p>
</td></tr>
<tr>
<th> Control
</th>
<td>
<p>Specify the control for the variable in the dialog box (combo box, slider, etc.). 
</p><p>More details can be referred to below in the <a href="../../XFunction/X-Function/X-Function_Builder.html#X-Function_Dialog_ControlsControl_Types" title="X-Function:X-Function Builder">Control Types</a> section.
</p>
</td></tr>
<tr>
<th> Option String
</th>
<td>
<p>Specify an option string for the variable. You can apply advanced settings with option strings, such as grouping several variables together, enabling recalculation, etc.
More details can be referred to below in the <a href="../../XFunction/X-Function/X-Function_Builder.html#X-Function_Option_StringsOption_String" title="X-Function:X-Function Builder">Option String</a> section.
</p>
</td></tr>
<tr>
<th> Theme ID
</th>
<td>
<p>Specify the Theme ID for the variable. If not assigned, the Theme ID of the variable will refer to the index of the variable. The Theme ID is used in the theme file for the X-Function dialog.
</p><p>More details can be referred to below in the <a href="../../XFunction/X-Function/X-Function_Builder.html#X-Function_Dialog_ThemeTheme_ID" title="X-Function:X-Function Builder">Theme ID</a> section.
</p>
</td></tr></table>
<h2><a name="X-Function_Variable_TypeVariable_Data_Type_and_Default_Value"></a><span class="mw-headline"><span class="OIndex" style="display:none">X-Function Variable Type</span>Variable Data Type and Default Value</span></h2>
<p>X-Functions provide dozens of data types, as below.
</p>
<ol><li> <b>Basic Data Type</b> 
<ul><li> Types are double, string, int.</li>
<li> The default value can be 0 for numeric or kept empty for string type.</li></ul></li>
<li> <b>Origin Composite Data Type</b>
<ul><li> Types are vector, vector&lt;string&gt;, vector&lt;complex&gt;, and matrix. </li>
<li> For example, a vector can attach to a worksheet column as input or output. </li>
<li> The default value can be &lt;active&gt;, &lt;new&gt;, or &lt;unassigned&gt;.</li>
<li> For more details, please refer to the Origin C help <a class="external text" href="../../OriginC/Category/Composite_Data_Types_(class_category).html">Composite Data Types</a> book.</li></ul></li>
<li> <b>Origin Object Type</b> 
<ul><li> The types are Column, Range, GraphLayer and other Origin Object types.</li>
<li> The default value can be &lt;active&gt;, &lt;new&gt;, &lt;input&gt;, or &lt;unassigned&gt;. </li>
<li> Origin C provides the function <i>BOOL okxf_resolve_string_get_origin_object(LPCSTR lpcsz, OriginObject* pObj)</i> to get an Origin Object from a GetN tree string value.</li>
<li> For more details, please refer to the Origin C help <a class="external text" href="../../OriginC/Category/Internal_Origin_Objects_(class_category).html">Internal Origin Objects</a>] book.</li></ul></li>
<li> <b>TreeNode Type</b>
<ul><li> Types are TreeNode, ReportData, and ReportTree. TreeNode is input, ReportData and ReportTree are output.</li></ul></li>
<li> <b> Origin Graphical Object Control</b>
<ul><li> Types are ButtonInfo, LineInfo, TextInfo and so on. </li>
<li> To see the usage, open a built-in X-Function from OriginEXE\X-Functions\Data Manipulation\curve translate.OXF in X-Function Builder as an example.</li></ul></li>
<li> <b>Report Type</b>
<ul><li> Types are ReportData, and ReportTree.</li>
<li> See <a href="../../XFunction/X-Function/X-Function_ReportTree_Example.html" title="X-Function:X-Function ReportTree Example">X-Function ReportTree Example</a> in the <a href="../../XFunction/Category/X-Function_Examples.html" title="Category:X-Function Examples">X-Function Examples</a> chapter.</li></ul></li></ol>
<h2><a name="X-Function_Dialog_ControlsControl_Types"></a><span class="mw-headline"><span class="OIndex" style="display:none">X-Function Dialog Controls</span>Control Types</span></h2>
<p>After specifying the different control strings in the variables grid Control column in the X-Function Builder, we can easily create different types of user interface controls in the X-Function dialog.
</p>
<table class="simple">
<tr>
<th> Usage
</th>
<th> Data Type
</th>
<th> Control String
</th></tr>
<tr>
<td> Numeric Edit Box
</td>
<td> double
</td>
<td> &#160;
</td></tr>
<tr>
<td> Text Edit Box
</td>
<td> string
</td>
<td> &#160;
</td></tr>
<tr>
<td> Check Box
</td>
<td> int
</td>
<td> 0|1
</td></tr>
<tr>
<td> Combo Box
</td>
<td> int
</td>
<td>
<ul><li>string1|string2|string3</li>
<li>CaseA:string1|CaseB:string2|CaseC:string3</li></ul>
</td></tr>
<tr>
<td> Editable Combo Box
</td>
<td> string
</td>
<td> Keep empty in the Control column in the Variables grid, but add the codes below to the <i>xfname_before_execute function</i> to set the <b>var</b> variable control as an editable combo box.
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> nGetNDialog <span style="color: #000080;">&gt;</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">&#41;</span>
    trGetN.<span style="color: #000000;">var</span>.<span style="color: #000000;">SetAttribute</span><span style="color: #000000;">&#40;</span>STR_COMBO_ATTRIB, <span style="color: #ff00ff;">&quot;|aa|bb|cc&quot;</span><span style="color: #000000;">&#41;</span>;</pre>
</td></tr>
<tr>
<td> Radio Box
</td>
<td> int
</td>
<td> Radio:string1|string2|string3
</td></tr>
<tr>
<td> Slider
</td>
<td> int/double
</td>
<td> slider:start|end|nstep
</td></tr>
<tr>
<td> Color List
</td>
<td> int
</td>
<td>
<ul><li><i>ColorList</i>, 24 basic colors panel</li>
<li><i>Color0</i>, normal colors panel</li></ul>
</td></tr>
<tr>
<td> Graph Browser
</td>
<td> string
</td>
<td>
<ul><li><i>...Graph</i> for one graph</li>
<li><i>...Graphs</i> for multiple graphs</li></ul>
<p>Origin supports interface settings for the Graph Browser in an OriginC function, using the control string GraphBrowserFilter. See <a href="../../XFunction/X-Function/Open_Graph_Browser_Dialog_in_X-Function.html" title="X-Function:Open Graph Browser Dialog in X-Function">X-Function Graph Browser Dialog Example</a> for details.
</p>
</td></tr>
<tr>
<td> Text Edit Box with File Browser Button
</td>
<td> string
</td>
<td>
<ul><li><i>...File</i> for single file</li>
<li><i>...Files</i> for multiple files</li></ul>
</td></tr>
<tr>
<td> Text Edit Box with Path Browser Button
</td>
<td> string
</td>
<td>
<ul><li><i>...Path</i>, to open the select folder dialog</li>
<li><i>...Path2</i>,  to open the browse folder dialog</li></ul>
<p><b>Note</b>: Set system variable <a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#F.2CG">@FBL = 0</a> will toggle new/old folder browser, i.e. <font color="navy"><i>...Path</i></font> to open the browse folder dialog, while <font color="navy"><i>...Path2</i></font> to open the select folder dialog.
</p>
</td></tr>
<tr>
<td> Text Edit Box with Save As Browser Button
</td>
<td> string
</td>
<td><i>...Save</i>
</td></tr></table>
<h2><a name="X-Function_Option_StringsOption_String"></a><span class="mw-headline"><span class="OIndex" style="display:none">X-Function Option Strings</span>Option String</span></h2>
<p>We can set the special string in the Option String column to specify the action of a variable.  For example, setting the recalculate default mode, setting the number of decimal digits for a numeric control, or setting the default name of an output object. For more details, see <a href="../../XFunction/X-Function/X-Function_Option_Strings.html" title="X-Function:X-Function Option Strings">Reference: X-Function Option Strings</a>.
</p>
<h2><a name="X-Function_Dialog_ThemeTheme_ID"></a><span class="mw-headline"><span class="OIndex" style="display:none">X-Function Dialog Theme</span>Theme ID</span></h2>
<p>The Theme ID is used in the X-Function dialog theme file, and the default value is 0. If you keep the Theme ID of all the variables at 0(default), the Theme ID in the theme file will be converted according to the index of the variable, beginning from 1.
</p><p>When you want to insert a variable into an existing X-Function (to append a variable as the last, there's no need do this), in order to remain compatible with the existing theme file, you need to:
</p>
<ol><li> Before inserting the variable, change the Theme ID from 0 to the index of the variable.</li>
<li> Insert the variable. </li>
<li> Set the Theme ID for the inserted variable as the maximum to avoid repeats.</li></ol>
<h2><a name="X-Function_Tree_ViewTree_View"></a><span class="mw-headline"><span class="OIndex" style="display:none">X-Function Tree View</span>Tree View</span></h2>
<p>Click the Tree View button <a  class="image"><img alt="Ocguide xf treeview button.png" src="../images/X-Function_Builder/Ocguide_xf_treeview_button.png?v=77098" width="23"  /></a> to switch to tree view. The settings in Tree View are mainly used to create X-Function dialogs, add X-Functions to the Origin menu, and add documentation. See the next chapter, Customizing an X-Function, for details.
</p><p><a  class="image"><img alt="Ocguide xf treeview.png" src="../images/X-Function_Builder/Ocguide_xf_treeview.png?v=77105" width="534"  /></a>
</p>

