<h1 class="firstHeading">2.2.21 newbook</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Brief_Information"><span class="tocnumber">1</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Command_Line_Usage"><span class="tocnumber">2</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#X-Function_Execution_Options"><span class="tocnumber">3</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Variables"><span class="tocnumber">4</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Description"><span class="tocnumber">5</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Examples"><span class="tocnumber">6</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Related_X-Functions"><span class="tocnumber">7</span> <span class="toctext">Related X-Functions</span></a></li>
</ul>
</div>

<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Create a new workbook or matrix book
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
1. newbook name:="ASCII Data"; 
</p><p>2. newbook sheet:=0;  
</p><p>3. newbook name:="Experiment1" sheet:=4 hidden:=1;  
</p><p>4. newbook name:="curves" result:=bn$ option:=lsname; 
</p><p>5. newbook mat:=1; 
</code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Desired Book Name
</td>
<td>name
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>""</center>
</td>
<td>
<p>Specifies the desired name for the workbook. This name can be set to long name only or both long name and short name, depends on the option variable.
</p>
</td></tr>
<tr>
<td>Number of Sheets
</td>
<td>sheet
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>-1</center>
</td>
<td>
<p>Specifies the number of sheets in the workbook. -1 means number of sheets in the template will be used.
</p>
</td></tr>
<tr>
<td>Template
</td>
<td>template
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>"Origin"</center>
</td>
<td>
<p>Specifies the template to use.
</p>
</td></tr>
<tr>
<td>Actual Book Name
</td>
<td>result
</td>
<td>
<p>Output
</p><p>string
</p>
</td>
<td> <center>bkname</center>
</td>
<td>
<p>Specifies the string to store the short name of the created workbook.
</p>
</td></tr>
<tr>
<td>Create as Hidden
</td>
<td>hidden
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>Specifies whether or not the new workbook should be hidden after it is created (see <a class="external text" href="../../LabTalk/LabTalk/String_registers.html#.25.40_String_Registers">String Register,&#160;%@N</a>).
</p>
</td></tr>
<tr>
<td>Name Option
</td>
<td>option
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>lname</center>
</td>
<td>
<p>Specifies how to set the long name and short name of the workbook with the name variable.
<br />
Option list
</p>
<ul><li><i>lname:Long name only</i>
<dl><dd>Sets only the long name of the workbook to the desired book name.</dd></dl></li>
<li><i>lsname:Long and Short name</i>
<dl><dd>Sets both long name and short name of the workbook to the desired book name.</dd></dl></li>
<li><i>enumln:Enumerate Long Name to short name index</i>
<dl><dd>Sets long name of the workbook to the desired book name, and enumerates it to the same as short name index.</dd></dl></li></ul>
</td></tr>
<tr>
<td>New Matrix Book
</td>
<td>mat
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>Option of matrix book or workbook.
</p>
</td></tr>
<tr>
<td>Keep Sheet Name
</td>
<td>keep
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>Specifies whether or not keep the sheet name in template. If no, default enumeration will be used.
</p>
</td></tr>
<tr>
<td>Do not Create if Found
</td>
<td>chkname
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td>
<p>Check the name; do not create this newbook if it already exists. Setting chkname:=0 will create newbook and enumerate (i.e. newbook1, newbook2, etc.).
</p>
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>The newbook function creates a new workbook or matrix book. You can specify the number of sheets in the book, the book name and whether the workbook should be hidden. Note: If you have set the <i>option</i> variable to <i>Long and Short name</i> and specified a book name that coincides with the short name of an existing book, this X-Function will not create a new book, because two books cannot have the same short name.
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// newbook is used when you need to create a new Workbook.</span>
<span style="color: #008000;">// Begin with a new, empty folder</span>
pe_mkdir Example;
pe_cd Example;
<span style="color: #008000;">// Repeat three times</span>
loop<span style="color: #000000;">&#40;</span>ii,<span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	<span style="color: #008000;">// We only want one 'Results' workbook</span>
	if<span style="color: #000000;">&#40;</span> <span style="color: #000080;">!</span>exist<span style="color: #000000;">&#40;</span>Results<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		<span style="color: #008000;">// Based on ORIGIN.OTW</span>
		newbook name<span style="color: #000000;">:</span><span style="color: #000080;">=</span>Results template<span style="color: #000000;">:</span><span style="color: #000080;">=</span>origin sheet<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span> option<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
		<span style="color: #008000;">// We name the Sheets</span>
		layer1.<span style="color: #000080;">name</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> QC;
		layer2.<span style="color: #000080;">name</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> Standard;
	<span style="color: #000000;">&#125;</span>
	<span style="color: #008000;">// These names will enumerate</span>
	newbook name<span style="color: #000000;">:</span><span style="color: #000080;">=</span>Run option<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> result<span style="color: #000000;">:</span><span style="color: #000080;">=</span>bkname<span style="color: #000080;">$</span> template<span style="color: #000000;">:</span><span style="color: #000080;">=</span>bin chkname<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;
<span style="color: #000000;">&#125;</span>
win <span style="color: #000080;">-</span>s T;  <span style="color: #008000;">//Tile the windows horizontally</span></pre>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">Related X-Functions</span></h2>
<p><a href="../../XFunction/X-Function/Newsheet.html" title="X-Function:Newsheet">newsheet</a>
</p>





