<h1 class="firstHeading">2.2.26 reducerows</h1><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Brief_Information"><span class="tocnumber">1</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Additional_Information"><span class="tocnumber">2</span> <span class="toctext">Additional Information</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Command_Line_Usage"><span class="tocnumber">3</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#X-Function_Execution_Options"><span class="tocnumber">4</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Variables"><span class="tocnumber">5</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Description"><span class="tocnumber">6</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Examples"><span class="tocnumber">7</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Related_X-Functions"><span class="tocnumber">8</span> <span class="toctext">Related X-Functions</span></a></li>
</ul>
</div>

<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Reduce worksheet by stats on every n rows
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">Additional Information</span></h2>
<p><b>Minimum Origin Version Required</b>: 8.1 SR0
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
reducerows npts:=3 method:=first
</code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Input
</td>
<td>irng
</td>
<td>
<p>Input
</p><p>Range
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> Specifies the input data range.
</td></tr>
<tr>
<td>Number of Points
</td>
<td>npts
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>5</center>
</td>
<td> Specifies a group size&#160;: n. Then every n data points in the input range are merged into one data point.
</td></tr>
<tr>
<td>Merge by
</td>
<td>method
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specifies the value with into a group of data points are merged.
<p>Option list:
</p>
<ul><li><i>first:First Point</i>
<dl><dd>Replaces N data points with the first value in the group.</dd></dl></li>
<li><i>last:Last Point</i>
<dl><dd>Replaces N data points with the last value in the group.</dd></dl></li>
<li><i>ave:Average</i>
<dl><dd>Replaces N data points with the average of the group.</dd></dl></li>
<li><i>min:Min</i>
<dl><dd>Replaces N data points with the minimum of the group.</dd></dl></li>
<li><i>max:Max</i>
<dl><dd>Replaces N data points with the maximum of the group.</dd></dl></li>
<li><i>sum:Sum</i>
<dl><dd>Replaces N data points with the sum of the group.</dd></dl></li>
<li><i>sd:SD</i>
<dl><dd>Replaces N data points with the standard deviation of the group.</dd></dl></li></ul>
</td></tr>
<tr>
<td>Output
</td>
<td>rd
</td>
<td>
<p>Output
</p><p>ReportData
</p>
</td>
<td> <center>[&lt;input&gt;]&lt;new&gt;</center>
</td>
<td> Specifies the output range.
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>The reducerows X-Function replaces every N rows with basic statistics data.
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<ul><li> Code Sample</li></ul>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000; font-style: regular;">/*
Sometimes users may put the data to be averaged into one column, e.g.
x1 y1 
x1 y2 
(...148...) 
x1 y149 
x1 y150 

x2 y151 
x2 y152 
(...148...) 
x2 y299 
x2 y300 

x3 y301 
etc...
The reduce XF can be used to merge the data points that correspond to the same X value.
1. Generate the x column.
2. Put random numbers into y column.
3. Use reduce to merge the data.
4. Plot the original data and result data in the same layer.
*/</span>
<span style="color: #008000;">//Create a new workbook and add columns</span>
newbook result<span style="color: #000000;">:</span><span style="color: #000080;">=</span>bkname<span style="color: #000080;">$</span>;	
worksheet <span style="color: #000080;">-</span>a <span style="color: #0000dd;">2</span>;
wks.<span style="color: #000080;">col3</span>.<span style="color: #000080;">type</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span>;
<span style="color: #008000;">//Generate data for the x column</span>
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>data<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">99</span><span style="color: #000000;">&#41;</span>;
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>int<span style="color: #000000;">&#40;</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">/</span><span style="color: #0000dd;">10</span><span style="color: #000080;">+</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">//Generate random data for the y column</span>
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>uniform<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">100</span>, <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">//Reduce data points</span>
reducerows irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span> npts<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">10</span> rd<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>;
reducerows irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> npts<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">10</span> method<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span> rd<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">//Plot</span>
window <span style="color: #000080;">-</span>t p;  <span style="color: #008000;">//Open an empty graph window</span>
plotxy iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>bkname<span style="color: #000080;">$</span><span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #0000dd;">2</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">201</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>active<span style="color: #000080;">&gt;</span>;
plotxy iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>bkname<span style="color: #000080;">$</span><span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #0000dd;">4</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">200</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>active<span style="color: #000080;">&gt;</span>;</pre>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">Related X-Functions</span></h2>
<p><a href="../../XFunction/X-Function/Stats.html" title="X-Function:Stats">stats</a>, <a href="../../XFunction/X-Function/Reducexy.html" title="X-Function:Reducexy">reducexy</a>, <a href="../../XFunction/X-Function/Reducedup.html" title="X-Function:Reducedup">reducedup</a>
</p>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>data reduction, average, mean, sum, minimum, maximum, statistics</span></p>






