<h1 class="firstHeading">2.13.1.2 corrcoef(Pro)</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">Menu Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Additional_Information"><span class="tocnumber">3</span> <span class="toctext">Additional Information</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Command_Line_Usage"><span class="tocnumber">4</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#X-Function_Execution_Options"><span class="tocnumber">5</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Variables"><span class="tocnumber">6</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Examples"><span class="tocnumber">7</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#More_Information"><span class="tocnumber">8</span> <span class="toctext">More Information</span></a>
<ul>
<li class="toclevel-2 tocsection-9"><a href="#Details_of_Settings_TreeNode"><span class="tocnumber">8.1</span> <span class="toctext">Details of Settings TreeNode</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-10"><a href="#Related_X-Functions"><span class="tocnumber">9</span> <span class="toctext">Related X-Functions</span></a></li>
</ul>
</div>

<h2><a name="Menu_Information"></a><span class="mw-headline">Menu Information</span></h2>
<p>Statistics: Descriptive Statistics: Correlation Coefficient
</p>
<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Calculate correlation coefficients for two or more columns
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">Additional Information</span></h2>
<p>This feature is for OriginPro only.
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<pre>
1. corrcoef irng:= (wcol(1), wcol(2), wcol(3)) spearman:=1;
2. corrcoef irng:= (wcol(1):wcol(3)) scatter:=1;
3. corrcoef irng:= (col(a), col(b), col(c)) rt:= [book2]&lt;new name:=CorrCoef&gt; flag:=1;
4. corrcoef irng:= (col(a), col(b)) spearman:=1 kendall:=1 swks:=[&lt;input&gt;]&lt;new&gt; kwks:=[&lt;input&gt;]&lt;new&gt; flag:=1;
</pre>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Input
</td>
<td>irng
</td>
<td>
<p>Input
</p><p>Range
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> Specify the input data ranges, at least two ranges. Note that beginning with Origin 2020b, there is a shortened syntax that follows the form [Book]Sheet!(N1:N2), N1 = the beginning column index and N2 being the ending column index in a contiguous range of columns. More complex strings from non-contiguous data of the form [Book]Sheet!([Book]Sheet!N1:N2,[Book]Sheet!N3:N4) are also possible.
</td></tr>
<tr>
<td>Pearson
</td>
<td>pearson
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> Decide if Pearson's product moment correlation coefficient is computed.
</td></tr>
<tr>
<td>Spearman
</td>
<td>spearman
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Decide if Spearman Rank correlation coefficient is computed.
</td></tr>
<tr>
<td>Kendall
</td>
<td>kendall
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Decide if Kendall correlation coefficient is computed.
</td></tr>
<tr>
<td>Scatter plots
</td>
<td>scatter
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Indicate whether to produce scatter plots for each pair of ranges.
</td></tr>
<tr>
<td>Add Confidence Ellipse
</td>
<td>ellipse
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Decide whether the confidence ellipse is plotted.
</td></tr>
<tr>
<td>Confidence Level for Ellipse(%)
</td>
<td>conflevel
</td>
<td>
<p>Input
</p><p>double
</p>
</td>
<td> <center>95</center>
</td>
<td> Specify the confidence level for the confidence ellipses.
</td></tr>
<tr>
<td>Heatmap Plot
</td>
<td>heatmap
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> Specify to output the heatmap plot.
<p>Option List：
</p>
<ul><li><i>0=false</i></li>
<li><i>1=true</i></li></ul>
</td></tr>
<tr>
<td>Scatter Matrix Plot
</td>
<td>scatterMatrix
</td>
<td>
<p>Input
</p><p>TreeNode
</p>
</td>
<td> <center> </center>
</td>
<td> Specify to output the scatter matrix plot.
<p>Option List：
</p>
<ul><li><i>0=false</i></li>
<li><i>1=true</i></li></ul>
<p><br />See <a href="#Details_of_Settings_TreeNode">Details of Settings TreeNode section</a> for more details setting.
</p>
</td></tr>
<tr>
<td>Exclude Missing Values
</td>
<td>missing
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify how to exclude the missing values.
<p>Option list:
</p>
<ul><li><i>pairwise:Pairwise</i>
<dl><dd>Exclude the missing value pairwisely. That is, when computing correlation between two columns, the corresponding two entries will be excluded if there is any missing value.</dd></dl></li>
<li><i>listwise:Listwise</i>
<dl><dd>Exclude the missing value listwisely. That is, exclude the entire row for all dataset if there are any missing values.</dd></dl></li></ul>
</td></tr>
<tr>
<td>Plot Data
</td>
<td>rd
</td>
<td>
<p>Output
</p><p>ReportData
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td> Specify the output worksheet for scatter/ellipse data.
</td></tr>
<tr>
<td>Plots
</td>
<td>rtplot
</td>
<td>
<p>Output
</p><p>ReportTree
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td> Specify the report worksheet for scatter plots and confidence ellipse.
</td></tr>
<tr>
<td>Results
</td>
<td>rt
</td>
<td>
<p>Output
</p><p>ReportTree
</p>
</td>
<td> <center>[&lt;input&gt;]&lt;new&gt;</center>
</td>
<td> Specify the output worksheet for analysis results.
</td></tr>
<tr>
<td>Pearson Sheet
</td>
<td>pwks
</td>
<td>
<p>Output
</p><p>Worksheet
</p>
</td>
<td> <center>[&lt;input&gt;]&lt;new&gt;</center>
</td>
<td> Specify the output worksheet for Pearson Correlations.
</td></tr>
<tr>
<td>Spearman Sheet
</td>
<td>swks
</td>
<td>
<p>Output
</p><p>Worksheet
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td> Specify the output worksheet for Spearman Correlations.
</td></tr>
<tr>
<td>Kendall Sheet
</td>
<td>kwks
</td>
<td>
<p>Output
</p><p>Worksheet
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td> Specify the output worksheet for Kendall Correlations.
</td></tr>
<tr>
<td>Show Significance in Result Table
</td>
<td>sig
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> Specify whether to display Significance in Result Table in the report worksheet.
</td></tr>
<tr>
<td>Flag Significant Correlations
</td>
<td>flag
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>Specify whether to  mark the Correlation Coefficient value significant at the 0.05 level with asterisk in Result Table, and highlight the Correlation Coefficient value significant at the 0.05 level with red color in Pearson/Spearman/Kendall Sheet.
</td></tr></table>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<ul><li> Sample Code</li></ul>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000; font-style: regular;">/*
This example shows how to caculate three kinds of correlation coefficents, which are Pearson, 
Spearman and Kendall correlation coefficent,When the distributions of the two variables satisfy 
normality, we can use Pearson correlation coefficent to describe the relationship of the two 
variables.Contrariwise, we should use Spearman or Kendall correlation coefficent.
  OriginPath\Samples\Statistics folder.
1. Import the sample data into a book in Origin
2. use corrcoef XF to calculate the correlation coefficents
3. put the result into a new sheet
4. Plot the scatter into a new graph
*/</span>
<span style="color: #008000; font-style: regular;">/*Import the sample data into a new book*/</span>
string fname<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Statistics\correlations.dat&quot;</span>;
newbook;
impASC;
string bkn<span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #000080;">%</span>H;
<span style="color: #008000; font-style: regular;">/*New a sheet to store the results*/</span>
newsheet book<span style="color: #000000;">:</span><span style="color: #000080;">=</span>bkn<span style="color: #000080;">$</span> name<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Result&quot;</span> label<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;method|coefficent|Sig.&quot;</span>;

<span style="color: #008000; font-style: regular;">/*Use the corrcoef XF to calculate the correlation coefficent*/</span>
corrcoef irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>bkn<span style="color: #000080;">$</span><span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #000000;">&#40;</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>,col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span> pearson<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> rt<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>new name<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Pearson_Result&quot;</span><span style="color: #000080;">&gt;</span>;
corrcoef irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>bkn<span style="color: #000080;">$</span><span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #000000;">&#40;</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>,col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span> pearson<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> spearman<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> rt<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>new name<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Spearman_Result&quot;</span><span style="color: #000080;">&gt;</span>;
corrcoef irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>bkn<span style="color: #000080;">$</span><span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #000000;">&#40;</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>,col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span> pearson<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> kendall<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> rt<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>new name<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Kendall_Result&quot;</span><span style="color: #000080;">&gt;</span>;
plotxy iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>bkn<span style="color: #000080;">$</span><span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span>,<span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">201</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>new name<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Scatter Plot&quot;</span><span style="color: #000080;">&gt;</span>;

<span style="color: #008000;">//The first column of the new book is used to store the method of the correlation coefficent.</span>
<span style="color: #008000;">//The second one is exploited to store the coefficent, and the significant value is put in the third column. </span>
range method<span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>bkn<span style="color: #000080;">$</span><span style="color: #000000;">&#93;</span>Result<span style="color: #000080;">!</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
range coef<span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>bkn<span style="color: #000080;">$</span><span style="color: #000000;">&#93;</span>Result<span style="color: #000080;">!</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>;
range Sig<span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>bkn<span style="color: #000080;">$</span><span style="color: #000000;">&#93;</span>Result<span style="color: #000080;">!</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>;
method<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>Pearson;
method<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>Spearman;
method<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>Kendall;
getresults iw<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>bkn<span style="color: #000080;">$</span><span style="color: #000000;">&#93;</span>Pearson_Result tr<span style="color: #000000;">:</span><span style="color: #000080;">=</span>mytreePearson;
getresults iw<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>bkn<span style="color: #000080;">$</span><span style="color: #000000;">&#93;</span>Spearman_Result tr<span style="color: #000000;">:</span><span style="color: #000080;">=</span>mytreeSpearman;
getresults iw<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>bkn<span style="color: #000080;">$</span><span style="color: #000000;">&#93;</span>Kendall_Result tr<span style="color: #000000;">:</span><span style="color: #000080;">=</span>mytreeKendall;
coef<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">=</span>mytreePearson.<span style="color: #000080;">peasoncorr</span>.<span style="color: #000080;">corr1</span>.<span style="color: #000080;">c2</span>;
Sig<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">=</span>mytreePearson.<span style="color: #000080;">peasoncorr</span>.<span style="color: #000080;">Sig1</span>.<span style="color: #000080;">c2</span>;
coef<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">=</span>mytreeSpearman.<span style="color: #000080;">spearcorr</span>.<span style="color: #000080;">corr1</span>.<span style="color: #000080;">c2</span>;
Sig<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">=</span>mytreeSpearman.<span style="color: #000080;">spearcorr</span>.<span style="color: #000080;">Sig1</span>.<span style="color: #000080;">c2</span>;
coef<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">=</span>mytreeKendall.<span style="color: #000080;">kencorr</span>.<span style="color: #000080;">corr1</span>.<span style="color: #000080;">c2</span>;
Sig<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">=</span>mytreeKendall.<span style="color: #000080;">kencorr</span>.<span style="color: #000080;">Sig1</span>.<span style="color: #000080;">c2</span>;</pre>
<h2><a name="More_Information"></a><span class="mw-headline">More Information</span></h2>
<p>For more information, please refer to our User Guide.
</p>
<dl><dd><ul><li><a class="external text" href="../../UserGuide/Category/Correlation_Coefficient_(OriginPro_Only).html">Description</a> </li>
<li> <a class="external text" href="../../Tutorial/Tutorial/Descriptive_Statistics.html#Analyzing_the_Relationship_Between_Different_Indicators">Tutorial</a></li>
<li><a class="external text" href="../../UserGuide/UserGuide/Algorithm_(corrcoef).html">Algorithm</a></li></ul></dd></dl>
<h3><a name="Details_of_Settings_TreeNode"></a><span class="mw-headline">Details of Settings TreeNode</span></h3>
<p>The <b>scatterMatrix</b> tree specifies all setting options for the <b>corrcoef</b> X-Function. 
</p><p>Syntax: <b>scatterMatrix.<i>Treenode:=&lt;value&gt;</i></b>
</p><p>Example: <b>scatterMatrix.ellipse = 1</b> 
</p>
<table class="treetable">
<tr>
<th> Treenode
</th>
<th> Label
</th>
<th> Type
</th>
<th> Default
</th>
<th> Description
</th></tr>
<tr>
<td>ellipse
</td>
<td>Add Confidence Ellipse
</td>
<td>Input int
</td>
<td>0
</td>
<td>Specify whether to show the confidence ellipse for the Scatter Matrix plot.
<ul><li> 0=Not add confidence ellipse</li>
<li> 1=Add confidence ellipse </li></ul>
</td></tr>
<tr>
<td>conflevel
</td>
<td>Confidence Level for Ellipse（%）
</td>
<td>Input int
</td>
<td>95
</td>
<td>Specify the confidence level for ellipses. This value must be greater than 0 and less than 100.
</td></tr></table>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">Related X-Functions</span></h2>
<p><a href="../../XFunction/X-Function/Pcorrcoef.html" title="X-Function:Pcorrcoef">pcorrcoef</a>
</p>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>pearson, spearman, kendall</span></p>






