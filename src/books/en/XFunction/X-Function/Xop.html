<h1 class="firstHeading">2.14.15 xop</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Brief_Information"><span class="tocnumber">1</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Command_Line_Usage"><span class="tocnumber">2</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#X-Function_Execution_Options"><span class="tocnumber">3</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Variables"><span class="tocnumber">4</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Description"><span class="tocnumber">5</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Examples"><span class="tocnumber">6</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Related_X-Functions"><span class="tocnumber">7</span> <span class="toctext">Related X-Functions</span></a></li>
</ul>
</div>

<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Run operations such as NLFit, ANOVA etc using a tree
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p>See the Examples section for details.
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Execute Mode
</td>
<td>execute
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>init</center>
</td>
<td>
<p>It specifies the execute mode on the operation tree.
</p><p>Option list
</p>
<ul><li><i>init:Init Tree</i>
<dl><dd>This method is used to initialize a Tree.</dd></dl></li>
<li><i>update:Update Tree</i>
<dl><dd>This method is used to update a Tree.</dd></dl></li>
<li><i>run:Output Tree</i>
<dl><dd>This method is used to out a Tree.</dd></dl></li>
<li><i>report:Generate Report</i>
<dl><dd>This method is used to output a Tree and generate a report.</dd></dl></li>
<li><i>cleanup:Clean Operation Object</i>
<dl><dd>This method is used to clean up the Operation Object</dd></dl></li></ul>
</td></tr>
<tr>
<td>Class Name
</td>
<td>classname
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td>
<p>This variable specifies the class name.
</p><p>The available class names are:
</p>
<dl><dd><ul><li> DescStats: Statistics on Columns</li>
<li> DescStats_1: Statistics on Rows</li>
<li> NormalityTest: Normality Test</li>
<li> ANOVAOneWay: One-Way ANOVA</li>
<li> ANOVATwoWay: Two-Way ANOVA</li>
<li> ANOVAOneWayRM: One-Way Repeated Measures ANOVA</li>
<li> ANOVATwoWayRM: Two-Way Repeated Measures ANOVA</li>
<li> FitLinear: Fit Linear</li>
<li> FitPolynomial:Fit Polynomial</li>
<li> MR: Multilple Linear Regression</li>
<li> FitNL: Nonlinear Curve Fit</li>
<li> ROCCurve: ROC Curve</li></ul></dd></dl>
</td></tr>
<tr>
<td>GUI Tree
</td>
<td>iotrgui
</td>
<td>
<p>Input/Output
</p><p>TreeNode
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td>
<p>This variable specifies the input/output GUI tree. It varies according to different operation class.
</p>
</td></tr>
<tr>
<td>Out Tree
</td>
<td>otrresult
</td>
<td>
<p>Output
</p><p>TreeNode
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td>
<p>This variable specifies the output tree. It varies according to different operation class.
</p>
</td></tr>
<tr>
<td>Dialog Theme
</td>
<td>theme
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td>
<p>This variable specifies the dialog theme.
</p>
</td></tr>
<tr>
<td>Need Fit Baseline
</td>
<td>baseline
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>Specify whether to fit the Baseline.
</p>
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>Some analyses, such as NLFit, ANOVA, etc, are quite complicated and they have been implemented through a framework of Origin C called the operation framework.
</p><p>This framework allows complexities that the X-Function framework is not yet designed to handle. 
</p><p>On the other hand, the operation framework allows these operation based classes to be called from Origin C, and thus an X-Function (xop) has been created to run these operation classes. 
</p><p>Just like many other X-Functions, xop has been designed to be used in LabTalk.
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p>More examples on these two pages: <a class="external text" href="https://www.originlab.com/doc/LabTalk/Tutorials/Tutorial-Statistics" target="_blank">Statistics with Labtalk</a> and <a class="external text" href="https://www.originlab.com/doc/LabTalk/examples/Curve-Fitting" target="_blank">Analysis LabTalk Script Examples</a>
</p><p><b>Example 1: xop to run "Linear Fit"</b> from worksheet
</p><p>Perform a linear fit on A(X)B(Y) in the active sheet and generate a report sheet.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// first import some data</span>

filename<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Curve Fitting\Linear Fit.dat&quot;</span>;

newbook;

impASC filename<span style="color: #000080;">$</span>;

<span style="color: #008000;">// use the FitLinear class to create a GUI tree &quot;lrGUI&quot;</span>
tree lrGUI;
xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>init classname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>FitLinear iotrgui<span style="color: #000000;">:</span><span style="color: #000080;">=</span>lrGUI;

<span style="color: #008000;">// specify the input data in the GUI tree</span>

lrGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Range1</span>.<span style="color: #000080;">X</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>Col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span>;

lrGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Range1</span>.<span style="color: #000080;">Y</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>Col<span style="color: #000000;">&#40;</span>B<span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// specify some settings of the linear fit, for example, fix intercept to 0.1</span>

lrGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">Fit</span>.<span style="color: #000080;">FixIntercept</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;

lrGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">Fit</span>.<span style="color: #000080;">FixInterceptAt</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0.1</span>;

<span style="color: #008000;">// generate a linear fit report with the prepared GUI tree</span>

xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>report iotrgui<span style="color: #000000;">:</span><span style="color: #000080;">=</span>lrGUI;

<span style="color: #008000;">//Clean up operation objects after fit</span>

xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>cleanup;</pre>
<p><b>Example 2: xop to run "Linear Regression" from graph</b>
</p><p>Perform Linear Regression from a graph with multiple dataplots in a single layer and generate all fitted lines on graph.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// first import some data</span>
filename<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Curve Fitting\Linear Fit.dat&quot;</span>; 
newbook;
impASC filename<span style="color: #000080;">$</span>;


<span style="color: #008000;">//create a graph with the data</span>
range data <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span><span style="color: #000080;">&lt;</span>active<span style="color: #000080;">&gt;</span><span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">2</span><span style="color: #000000;">:</span> wcol<span style="color: #000000;">&#40;</span>wks.<span style="color: #000080;">ncols</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;
plotxy data plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">201</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>active<span style="color: #000080;">&gt;</span>;  <span style="color: #008000;">// Plot source data as scatter</span>


<span style="color: #008000;">//use the FitLinear class to create a GUI tree &quot;lrGUI&quot;</span>
tree lrGUI;  
<span style="color: #008000;">// initialize the GUI tree, with the FitLinear class</span>
xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>init classname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>FitLinear iotrgui<span style="color: #000000;">:</span><span style="color: #000080;">=</span>lrGUI;
 
<span style="color: #008000;">//Specify all data plots on graph to be input data in the GUI tree</span>
ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
doc <span style="color: #000080;">-</span>e d <span style="color: #008000;">//loop all plots in the active layer</span>
<span style="color: #000000;">&#123;</span>
	<span style="color: #000080;">%</span>A <span style="color: #000080;">=</span>  xof<span style="color: #000000;">&#40;</span><span style="color: #000080;">%</span>C<span style="color: #000000;">&#41;</span>;   <span style="color: #008000;">//Specify XY datasets</span>
	lrGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Range</span><span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>ii<span style="color: #000000;">&#41;</span>.<span style="color: #000080;">X</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">%</span>A;
	lrGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Range</span><span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>ii<span style="color: #000000;">&#41;</span>.<span style="color: #000080;">Y</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">%</span>C;	
	range rPlot <span style="color: #000080;">=</span> <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>ii<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//define a labtalk range for each dataplot</span>
	int uid <span style="color: #000080;">=</span> range2uid<span style="color: #000000;">&#40;</span>rPlot<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//get the uid of the range</span>
	lrGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Range</span><span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>ii<span style="color: #000000;">&#41;</span>.<span style="color: #000080;">SetAttribute</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;PlotObjUID&quot;</span>, <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>uid<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// set the uid for plot</span>
	ii <span style="color: #000080;">=</span> ii <span style="color: #000080;">+</span> <span style="color: #0000dd;">1</span>;
<span style="color: #000000;">&#125;</span>
<span style="color: #008000;">// perform linear fit and generate a report with the prepared GUI tree</span>
xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>report iotrgui<span style="color: #000000;">:</span><span style="color: #000080;">=</span>lrGUI;
<span style="color: #008000;">// clean up linear fit operation objects after fitting</span>
xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>cleanup;</pre>
<p><br />
<b>Example 3: xop to run "Statistics on Columns"</b>
</p><p>Perform descriptive statistics on data with grouping in the active sheet and create a report tree.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// first import the desirable data into a new book</span>

filename<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Statistics\body.dat&quot;</span>;

newbook;

impASC filename<span style="color: #000080;">$</span>;

<span style="color: #008000;">// use the DescStats class to create a GUI tree &quot;statGUI&quot;</span>
tree statGUI;
xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>init classname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>DescStats iotrgui<span style="color: #000000;">:</span><span style="color: #000080;">=</span>statGUI;

<span style="color: #008000;">// specify the input data in the GUI tree</span>

statGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Range1</span>.<span style="color: #000080;">X</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>Col<span style="color: #000000;">&#40;</span>height<span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// specify the grouping data</span>

statGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Range1</span>.<span style="color: #000080;">F</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>Col<span style="color: #000000;">&#40;</span>gender<span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// specify some settings of the Statistics on Columns,</span>

<span style="color: #008000;">// for example, you want to know who is the tallest in two kinds of genders respectively</span>

statGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">Quantities</span>.<span style="color: #000080;">quantiles</span>.<span style="color: #000080;">iMax</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;

<span style="color: #008000;">// generate a report tree with the prepared GUI tree</span>

xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>run iotrgui<span style="color: #000000;">:</span><span style="color: #000080;">=</span>statGUI otrresult<span style="color: #000000;">:</span><span style="color: #000080;">=</span>statOut;

<span style="color: #008000;">//Clean up operation objects after fit</span>

xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>cleanup;

<span style="color: #008000;">// show the report tree which includes the group labels to check the results</span>
statout.<span style="color: #000080;">list</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span>,<span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// Or you can get the results and the group labels by this way</span>
statout.<span style="color: #000080;">=</span>;
statout.<span style="color: #000080;">Statistics</span>.<span style="color: #000080;">c1</span>.<span style="color: #000080;">GetLabel</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>;
statout.<span style="color: #000080;">Statistics</span>.<span style="color: #000080;">c2</span>.<span style="color: #000080;">GetLabel</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>;</pre>
<p><b>Example 4: xop to run "One-Way ANOVA"</b>
</p><p>Perform One-Way ANOVA on raw form data and generate a report sheet.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">/// first import the desirable data into a new book</span>

filename<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Statistics\ANOVA\One-Way_ANOVA_raw.dat&quot;</span>;

newbook;

impASC filename<span style="color: #000080;">$</span>;

<span style="color: #008000;">// use the ANOVAOneWay class to create a GUI tree &quot;onewayGUI&quot;</span>
tree onewayGUI;
xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>init classname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>ANOVAOneWay iotrgui<span style="color: #000000;">:</span><span style="color: #000080;">=</span>onewayGUI;

<span style="color: #008000;">// need to update the GUI tree since by default data in the tree has an indexed data form.</span>

<span style="color: #008000;">// now we need a raw form GUI tree. </span>

<span style="color: #008000;">// It is an attribute in LT and needs to access by a special node &quot;.Use&quot;.</span>

onewayGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Use</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; <span style="color: #008000;">//0 for Indexed, 1 for Raw</span>

xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>update iotrgui<span style="color: #000000;">:</span><span style="color: #000080;">=</span>onewayGUI;

<span style="color: #008000;">// specify the input data in the updated GUI tree</span>

onewayGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Data</span>.<span style="color: #000080;">Factor_0</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>Col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span>;

onewayGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Data</span>.<span style="color: #000080;">Factor_1</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>Col<span style="color: #000000;">&#40;</span>B<span style="color: #000000;">&#41;</span>;

onewayGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Data</span>.<span style="color: #000080;">Factor_2</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>Col<span style="color: #000000;">&#40;</span>C<span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// generate a One-Way ANOVA report with the prepared GUI tree</span>

xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>report iotrgui<span style="color: #000000;">:</span><span style="color: #000080;">=</span>onewayGUI;

<span style="color: #008000;">//Clean up operation objects after fit</span>

xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>cleanup;</pre>
<p><b>Example 5: xop to run "Nonlinear Curve Fit"</b>
</p><p>Perform global nonlinear curve fit on A(X)B(Y)C(Y) in the active sheet and generate a report sheet.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//First import the desirable data into a new book</span>

filename<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Curve Fitting\Gaussian.dat&quot;</span>;

newbook;

impASC filename<span style="color: #000080;">$</span>;

<span style="color: #008000;">//Use the NLSF class to create a GUI tree &quot;nlGUI&quot;</span>
tree nlGUI;
xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>init classname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>FitNL iotrgui<span style="color: #000000;">:</span><span style="color: #000080;">=</span>nlGUI;

<span style="color: #008000;">//Specify function and input data, then update operation tree before fitting.</span>

nlGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">FunctionSelection</span>.<span style="color: #000080;">FunctionList</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Gauss&quot;</span>;

nlGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Range1</span>.<span style="color: #000080;">X</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>Col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span>;

nlGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Range1</span>.<span style="color: #000080;">Y</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>Col<span style="color: #000000;">&#40;</span>B<span style="color: #000000;">&#41;</span>;

nlGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Range2</span>.<span style="color: #000080;">X</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>Col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span>;

nlGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Range2</span>.<span style="color: #000080;">Y</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>Col<span style="color: #000000;">&#40;</span>C<span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">//Set fit mode as Global Fit</span>

<span style="color: #008000;">//It is an attribute in LT and needs to access by a special node &quot;.Use&quot;.</span>

nlGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Use</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span>;

xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>update iotrgui<span style="color: #000000;">:</span><span style="color: #000080;">=</span>nlGUI;

<span style="color: #008000;">//Change parameter table to show Fix and Dependency which are not shown by default</span>

nlGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">Quantities</span>.<span style="color: #000080;">Parameters</span>.<span style="color: #000080;">Fix</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;

nlGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">Quantities</span>.<span style="color: #000080;">Parameters</span>.<span style="color: #000080;">Dependency</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;

<span style="color: #008000;">//Fix y0 at value of 0 for both datasets</span>

nlGUI.<span style="color: #000080;">UserSettings</span>.<span style="color: #000080;">Parameters</span>.<span style="color: #000080;">Values</span>.<span style="color: #000080;">y0</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;

nlGUI.<span style="color: #000080;">UserSettings</span>.<span style="color: #000080;">Parameters</span>.<span style="color: #000080;">Fixed</span>.<span style="color: #000080;">y0</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;

nlGUI.<span style="color: #000080;">UserSettings</span>.<span style="color: #000080;">Parameters</span>.<span style="color: #000080;">Values</span>.<span style="color: #000080;">y0_2</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;

nlGUI.<span style="color: #000080;">UserSettings</span>.<span style="color: #000080;">Parameters</span>.<span style="color: #000080;">Fixed</span>.<span style="color: #000080;">y0_2</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;

<span style="color: #008000;">//Share w</span>

nlGUI.<span style="color: #000080;">UserSettings</span>.<span style="color: #000080;">Parameters</span>.<span style="color: #000080;">Share</span>.<span style="color: #000080;">w</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;

xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>report iotrgui<span style="color: #000000;">:</span><span style="color: #000080;">=</span>nlGUI;

<span style="color: #008000;">//Clean up operation objects after fit</span>

xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>cleanup;</pre>
<p><b>Example 6: xop to run "Multiple Linear Regression"</b>
</p><p>Perform Multiple Linear Regression on data with three independents and one dependent in the active sheet and generate a report sheet.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// first import some data</span>
filename<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Curve Fitting\Multiple Linear Regression.dat&quot;</span>;
newbook;
impASC filename<span style="color: #000080;">$</span>;

<span style="color: #008000;">// use the Multiple Linear Regression class to create a GUI tree &quot;mrGUI&quot;</span>
tree mrGUI;
xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>init classname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>MR iotrgui<span style="color: #000000;">:</span><span style="color: #000080;">=</span>mrGUI;

<span style="color: #008000;">// specify the input data in the GUI tree</span>
mrGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Range1</span>.<span style="color: #000080;">X</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span><span style="color: #000000;">:</span>col<span style="color: #000000;">&#40;</span>C<span style="color: #000000;">&#41;</span>;
mrGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Range1</span>.<span style="color: #000080;">Y</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span>D<span style="color: #000000;">&#41;</span>;
 
<span style="color: #008000;">// specify some settings</span>
<span style="color: #008000;">// to see the whole tree node, use command &quot;mrGUI.=&quot; after running this example</span>
mrGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">Quantities</span>.<span style="color: #000080;">Parameters</span>.<span style="color: #000080;">ConfInterval</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
mrGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">Quantities</span>.<span style="color: #000080;">Statistics</span>.<span style="color: #000080;">ReducedChiSq</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
mrGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">ResAnalysis</span>.<span style="color: #000080;">Stad</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
mrGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">Residuals</span>.<span style="color: #000080;">Graph3</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
mrGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">Residuals</span>.<span style="color: #000080;">Graph4</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
mrGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">Residuals</span>.<span style="color: #000080;">Graph5</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
mrGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">Residuals</span>.<span style="color: #000080;">Graph6</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
mrGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">Residuals</span>.<span style="color: #000080;">Graph7</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;

<span style="color: #008000;">// generate a report with the prepared GUI tree</span>
xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>report iotrgui<span style="color: #000000;">:</span><span style="color: #000080;">=</span>mrGUI;
 
<span style="color: #008000;">//Clean up operation objects</span>
xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>cleanup;</pre>
<p><b>Example 7: xop to set Positive State value for ROC curve</b>
</p>
<pre class="lt" style="font-family:monospace;">newbook;
fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Statistics\sodium.dat&quot;</span>;
impasc fname<span style="color: #000080;">$</span>;

xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>init classname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>ROCCurve iotrgui<span style="color: #000000;">:</span><span style="color: #000080;">=</span>rocGUI;

<span style="color: #008000;">// specify the input data in the GUI tree</span>
rocGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Range1</span>.<span style="color: #000080;">X</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;1!col(B)&quot;</span>;

<span style="color: #008000;">// specify the grouping data</span>
rocGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Range1</span>.<span style="color: #000080;">F</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;1!Col(A)&quot;</span>;

<span style="color: #008000;">/// StateValue is for old compatibility usage, the items are separated by space</span>
rocGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">CompControl</span>.<span style="color: #000080;">StateValue</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;RMSF&quot;</span>;
StringArray stateList <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #ff00ff;">&quot;RMSF&quot;</span><span style="color: #000000;">&#125;</span>;
rocGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">CompControl</span>.<span style="color: #000080;">StateList</span>.<span style="color: #000080;">SetStrArray</span><span style="color: #000000;">&#40;</span>stateList<span style="color: #000000;">&#41;</span>;

xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>report iotrgui<span style="color: #000000;">:</span><span style="color: #000080;">=</span>rocGUI;</pre>
<p><b>Example 8: use Units row as grouping when using XOP to do statistics on rows</b>
</p>
<pre class="lt" style="font-family:monospace;">tree statGUI;
xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>init classname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>DescStats_1 iotrgui<span style="color: #000000;">:</span><span style="color: #000080;">=</span>statGUI; 
statGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Range1</span>.<span style="color: #000080;">X</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">:</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//data</span>
statGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Range1</span>.<span style="color: #000080;">F</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;A[U]:D[U]&quot;</span>; <span style="color: #008000;">//grouping</span>
statGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">Output</span>.<span style="color: #000080;">Report</span>.<span style="color: #000080;">Book</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;&quot;</span>;		<span style="color: #008000;">//use this ONLY to create a new different book or set &quot;&quot; for active</span>
statGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">Output</span>.<span style="color: #000080;">Report</span>.<span style="color: #000080;">BookName</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;&quot;</span>; 	<span style="color: #008000;">// this is the book longname</span>
statGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">Output</span>.<span style="color: #000080;">Report</span>.<span style="color: #000080;">Sheet</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;&quot;</span>;   	<span style="color: #008000;">//use this only to create a new sheet or set &quot;&quot; for active</span>
statGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">Output</span>.<span style="color: #000080;">Report</span>.<span style="color: #000080;">SheetName</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;&quot;</span>;  	<span style="color: #008000;">//this is the sheet longnanme</span>
xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>Report iotrgui<span style="color: #000000;">:</span><span style="color: #000080;">=</span>statGUI otrresult<span style="color: #000000;">:</span><span style="color: #000080;">=</span>statOut;	<span style="color: #008000;">// use Execute:=RUN (to get tree only) or REPORT (to get usual Report)</span>
xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>cleanup;<span style="color: #008000;">// Clean up essential before running another calculation</span></pre>
<p><b>Example 9: xop to run "Statistics on Columns" on matrix object</b>
</p>
<pre class="lt" style="font-family:monospace;">tree statGUI;
xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>init classname<span style="color: #000000;">:</span><span style="color: #000080;">=</span>DescStats iotrgui<span style="color: #000000;">:</span><span style="color: #000080;">=</span>statGUI;
statGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">InputData</span>.<span style="color: #000080;">Range1</span>.<span style="color: #000080;">X</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>MBook1<span style="color: #000000;">&#93;</span>MSheet1<span style="color: #000080;">!</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">0</span>; <span style="color: #008000;">// all matrix objects</span>
statGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">Output</span>.<span style="color: #000080;">Report</span>.<span style="color: #000080;">Book</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Book1&quot;</span>; <span style="color: #008000;">// must not use default value, default is output to source book, but now source book is matrix</span>
statGUI.<span style="color: #000080;">GUI</span>.<span style="color: #000080;">Output</span>.<span style="color: #000080;">FlatOut</span>.<span style="color: #000080;">Book</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;&lt;report&gt;&quot;</span>; <span style="color: #008000;">//output to to the same book as report sheet</span>
xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>report iotrgui<span style="color: #000000;">:</span><span style="color: #000080;">=</span>statGUI; <span style="color: #008000;">//get report</span>
xop execute<span style="color: #000000;">:</span><span style="color: #000080;">=</span>cleanup; <span style="color: #008000;">// Clean up essential before running another calculation</span></pre>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">Related X-Functions</span></h2>






