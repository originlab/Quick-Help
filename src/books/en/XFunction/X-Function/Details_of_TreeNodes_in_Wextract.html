<h1 class="firstHeading">2.16.1.1 Details of TreeNodes in Wextract</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#settings"><span class="tocnumber">1</span> <span class="toctext">settings</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#stAlias"><span class="tocnumber">1.1</span> <span class="toctext">stAlias</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#stCondition"><span class="tocnumber">1.2</span> <span class="toctext">stCondition</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#stMethod"><span class="tocnumber">1.3</span> <span class="toctext">stMethod</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#stRowRange"><span class="tocnumber">1.4</span> <span class="toctext">stRowRange</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="settings"></a><span class="mw-headline">settings</span></h2>
<p>The <b>settings</b> tree specifies all settings for the <b>wextract</b> X-Function. 
</p><p>Syntax: <b>settings.<i>Treenode</i>:=&lt;value&gt;</b> 
</p><p>Example:
</p>
<ul><li><b>settings.Cols:=0</b> <b>settings.RecalMode:=0</b></li></ul>
<table class="treenode">
<tr>
<th width="4%">Treenode
</th>
<th width="4%">Label
</th>
<th width="4%">Type
</th>
<th width="4%">Default
</th>
<th width="32%">Description
</th></tr>
<tr>
<td>Cols
</td>
<td>Columns
</td>
<td>string
</td>
<td>
</td>
<td>Specify columns to be extracted. This must be specified if settings.stMethod.Method is not 0. Note that column index starts from 0 and if multiple columns are desired, separate them with "|". Examples:
<ul><li>settings.cols:=0  //Extract the first column</li>
<li>settings.cols:="0|1" //Extract the first and the second columns</li></ul>
</td></tr>
<tr>
<td>RecalMode
</td>
<td>Recalculate
</td>
<td>int
</td>
<td>0
</td>
<td>Specify the recalculate mode.
<ul><li>0: None</li>
<li>1: Auto</li>
<li>2: Manual</li></ul>
</td></tr></table>
<h3><a name="stAlias"></a><span class="mw-headline">stAlias</span></h3>
<p>The <b>stAlias</b> branch of the <b>settings</b> tree allows you to define aliases for columns. Then you can use these aliases to build the condition for the If test. 
</p><p>Syntax: <b>settings.stAlias.<i>Treenode</i>:= &lt;value&gt;</b> 
</p><p>Examples: 
</p>
<ul><li><b>settings.stAlias.Cols:=1 settings.stAlias.AliasNames:=A</b></li>
<li><b>settings.stAlias.Cols:="1|2" settings.stAlias.AliasNames:="V|A"</b></li></ul>
<table class="treetable">
<tr>
<th width="4%">Treenode
</th>
<th width="4%">Label
</th>
<th width="4%">Type
</th>
<th width="4%">Default
</th>
<th width="32%">Description
</th></tr>
<tr>
<td>Cols
</td>
<td>Columns
</td>
<td>string
</td>
<td>
</td>
<td>Specify the indices of columns for which aliases are defined. Note that column index starts from 1. If you want to define aliases for multiple columns, separate their index numbers with "|". Examples:
<ul><li>settings.stAlias.cols:="1"   //The first column</li>
<li>settings.stAlias.cols:="1|2" //The first and second columns</li></ul>
</td></tr>
<tr>
<td>AliasNames
</td>
<td>Alias Names
</td>
<td>string
</td>
<td>
</td>
<td>Specify aliases for the chosen columns in the settings.stAlias.Cols string. If multiple aliases are defined, separate them with "|". Examples:
<ul><li>settings.stAlias.AliasNames:="A" //The alias for the selected column is "A". </li>
<li>settings.stAlias.AliasNames:="A|B" //The aliases in the selected columns are "A" and "B", respectively.</li></ul>
</td></tr></table>
<h3><a name="stCondition"></a><span class="mw-headline">stCondition</span></h3>
<p>The <b>stCondition</b> branch of the <b>settings</b> tree specifies the condition for testing whether a row should be extracted and the scripts that will be executed before the select data loop and before the condition is tested. 
</p><p>Syntax: <b>settings.stCondition.<i>Treenode</i>:= &lt;value&gt;</b> 
</p><p>Examples: 
</p>
<dl><dd><b>settings.stCondition.Condition:="A&lt;5"</b> </dd>
<dd><b>settings.stCondition.BeforeLoop:="j=1;"</b> </dd>
<dd><b>settings.stCondition.BeforeIfCondition:="j=j+1;"</b></dd></dl>
<table class="treetable">
<tr>
<th width="5%">Treenode
</th>
<th width="10%">Label
</th>
<th width="5%">Type
</th>
<th width="5%">Default
</th>
<th width="32%">Description
</th></tr>
<tr>
<td>Condition
</td>
<td>Condition
</td>
<td>string
</td>
<td>
</td>
<td>Specify the condition to test whether a row should be extracted. If a data row meets the condition, if will be extracted.
</td></tr>
<tr>
<td>BeforeLoop
</td>
<td>Script Before Select Data Loop
</td>
<td>string
</td>
<td>
</td>
<td>Specify the script that will be executed before the selected data rows are tested to see if they meet the condition. See details <a class="external text" href="../../UserGuide/UserGuide/Extract_Worksheet_Data.html#Scripts">here</a>.
</td></tr>
<tr>
<td>BeforeIfCondition
</td>
<td>Script Before If Condition
</td>
<td>string
</td>
<td>
</td>
<td>Specify the script that will be executed in the loop, before a row if tested to see if it meets the condition. See details <a class="external text" href="../../UserGuide/UserGuide/Extract_Worksheet_Data.html#Scripts">here</a>.
</td></tr></table>
<h3><a name="stMethod"></a><span class="mw-headline">stMethod</span></h3>
<p>The <b>stMethod</b> branch of the <b>settings</b> tree specifies the output method. 
</p><p>Syntax: <b>settings.stMethod.<i>Treenode</i>:= &lt;value&gt;</b> 
</p><p>Examples: 
</p>
<dl><dd><b>settings.stMethod.Method:=2</b></dd>
<dd><b>settings.stMethod.ColFilter:=1</b></dd>
<dd><b>settings.stMethod.WksSpecified:=[Book1]Sheet2!</b></dd>
<dd><b>settings.stMethod.ColFrom:=1</b></dd>
<dd><b>settings.stMethod.ColTo:=2</b></dd>
<dd><b>settings.stMethod.Color:=1</b></dd></dl>
<table class="treetable">
<tr>
<th width="4%">Treenode
</th>
<th width="4%">Label
</th>
<th width="4%">Type
</th>
<th width="4%">Default
</th>
<th width="32%">Description
</th></tr>
<tr>
<td>Method
</td>
<td>Output Method
</td>
<td>int
</td>
<td>2
</td>
<td>Specify the output method. Options include
<ul><li>-2:Highlight the cells that meet the condition.</li>
<li>-1:Mask the cells that meet the condition.</li>
<li>0:Use a column to indicate whether the condition is satisfied for each row(1=true, 0=false).</li>
<li>1:Extract to a new worksheet.</li>
<li>2:Extract to a new workbook.</li>
<li>3:Extract to a specified worksheet.</li>
<li>4:Fill the cells that meet the condition with a specified color.</li></ul>
</td></tr>
<tr>
<td>ColFilter
</td>
<td>Column Filter
</td>
<td>int
</td>
<td> -1
</td>
<td>This is valid only when settings.stMethod.Method:=0. You can use this variable to specify the column for outputting the filtering result (0 for false and 1 for true). Column index starts from 0. If "-1" is used, a new column will be added to the source worksheet and used for outputting the filtering result.
</td></tr>
<tr>
<td>WksSpecified
</td>
<td>Worksheet
</td>
<td>range
</td>
<td>
</td>
<td>This is valid only when settings.stMethod.Method:=1. Use it to specify the worksheet for outputting the extracted rows. Note that if the oy variable of the X-Function is specified, oy will be used as the output range no matter what WksSpecified is.
</td></tr>
<tr>
<td>ColFrom
</td>
<td>Column From
</td>
<td>int
</td>
<td> -1
</td>
<td>This is valid only when settings.stMethod.Method:=1 or 2 or 3. It specifies the beginning column to output the extracted data. Column index starts from 0. Note that if the oy variable of the X-Function is specified, y will be used as the output range no matter what ColFrom is. Examples,
<ul><li>settings.stMethod.ColFrom:=0 //The first column.</li>
<li>settings.stMethod.ColFrom:-1 //The first empty column in the output worksheet.</li></ul>
</td></tr>
<tr>
<td>ColTo
</td>
<td>Column To
</td>
<td>int
</td>
<td> -1
</td>
<td>This is a redundant parameter. Please do not use it.
</td></tr>
<tr>
<td>Color
</td>
<td>Color
</td>
<td>int
</td>
<td>1
</td>
<td>This is valid only when settings.stMethod.Method:=4. It specify the index of the color (in <a class="external text" href="../../LabTalk/LabTalk/List_of_Colors.html">the color list</a>) used for filling the cells that meet the condition. Color index starts from 0.  Examples:
<ul><li>settings.stMethod.color:=0 //black</li>
<li>settings.stMethod.color:=1 //red </li></ul>
</td></tr></table>
<h3><a name="stRowRange"></a><span class="mw-headline">stRowRange</span></h3>
<p>The <b>stRowRange</b> branch of the <b>settings</b> tree specifies the row range from which data is extracted. 
</p><p>Syntax: <b>settings.stRowRange.<i>Treenode</i>:= &lt;value&gt;</b> 
</p><p>Example: 
</p>
<dl><dd><b>settings.stRowRange.RowFrom:=0</b> </dd>
<dd><b>settings.stRowRange.RowTo:=10</b></dd></dl>
<table class="treetable">
<tr>
<th width="4%">Treenode
</th>
<th width="4%">Label
</th>
<th width="4%">Type
</th>
<th width="4%">Default
</th>
<th width="32%">Description
</th></tr>
<tr>
<td>RowFrom
</td>
<td>Row From
</td>
<td>int
</td>
<td>0
</td>
<td>Specify the beginning row to extract data. Row index starts from 0. Examples:
<ul><li>settings.stRowRange.RowFrom:=0  //The first row.</li>
<li>settings.stRowRange.RowFrom:=2: //The third row.</li></ul>
</td></tr>
<tr>
<td>RowTo
</td>
<td>Row To
</td>
<td>int
</td>
<td> -1
</td>
<td>Specify the end row to extract data. Row index starts from 0. For example,
<ul><li>settings.stRowRange.RowTo:=3  //The fourth row.</li>
<li>settings.stRowRange.RowTo:=-1 //The last row.</li></ul>
</td></tr></table>






