<h1 class="firstHeading">1.1.1 Creating a Simple X-Function</h1><p><br />
<span class="OIndex" style="display:none">X-Function Builder</span>X-Functions are created with <a href="../../XFunction/X-Function/X-Function_Builder.html" title="X-Function:X-Function Builder">X-Function Builder</a>. You can open X-Function Builder by choosing the <b>Tools: X-Function Builder...</b> menu.
</p><p>The X-Function Builder dialog is shown below.
</p><p><a  class="image"><img alt="Ocguide xfdialog default.png" src="../images/Creating_a_Simple_X-Function/Ocguide_xfdialog_default.png?v=77101" width="413"  /></a>
</p>
<h2><a name="X-Function.2C_CreateCreating_X-Function"></a><span class="mw-headline"><span class="OIndex" style="display:none">X-Function, Create</span>Creating X-Function</span></h2>
<p>The steps below will walk you through the creation of an X-Function that will perform the task of copying data from one column to another column.
</p>
<ol>
<li>Select <b>Tools: X-Function Builder...</b> menu to open the builder.</li>
<li>Enter X-Function name <b>CopyCol</b> in X-Function box</li>
<li> Each variable and parameter of the X-Function should be on its own row. Right-click on the gray area below the table and choose <b>Add Variable</b> to add another more row.</li>
<li> This X-Function needs 2 variables to specify the input and output columns. Fill it out like the image below. Most columns are self-explanatory. </li>
<li>The <b>Data</b> column is for setting the default value. <b>&lt;active&gt;</b> means current selected column, <b>&lt;new&gt;</b> means new column. If set as shown, Calling CopyCol will copy current selected column to new column by default.</li>
<dl><dd><a  class="image"><img alt="Ocguide xfdialog.png" src="../images/Creating_a_Simple_X-Function/Ocguide_xfdialog.png?v=77102" width="413"  /></a></dd></dl>
<li>Click <a  class="image"><img alt="Ocguide xfdialog savebutton.png" src="../images/Creating_a_Simple_X-Function/Ocguide_xfdialog_savebutton.png?v=77100" width="23"  /></a> button to save the X-Function. The very first time you create an X-Function, the following reminder shows to copy the whole X-Function folder structure from system X-Functions area to your User-Files Folder. Choose the 2nd radio so that it will not popup again.</li>
<dl><dd> <a  class="image"><img alt="Copy xfunction structure.png" src="../images/Creating_a_Simple_X-Function/Copy_xfunction_structure.png?v=84524" width="449"  /></a></dd></dl>
<li>When the <b>Save As</b> dialog appears, navigate to X-Functions to see the whole X-Function folder structure. Pick an appropriate folder. E.g. CopyCol X-Function is to copy columns in worksheet. So pick <b>Data Manipulation &gt; Worksheet</b> folder to save the file. Usually the file name is the same as the X-Function name. So just click the <b>Save</b> button.</li>
<li>Click the <a  class="image"><img alt="Ocguide xf treeview button.png" src="../images/Creating_a_Simple_X-Function/Ocguide_xf_treeview_button.png?v=77098" width="23"  /></a> button to switch to the tree view. <span class="OIndex" style="display:none">X-Function, Control Labtalk Accessing</span> Make sure the <b>Labtalk</b> check box is checked so that so the X-Function can be used in the Script and Command Windows.</li>
<li>Set <b>Auto GetN Dialog</b> to <b>Simple GetNBox</b>. The Auto GetN Dialog provides the choice to use the X-Function with or without dialog and what type of dialog. Click Save button again to save the change.<br /><a  class="image"><img alt="Ocguide xfsimpledialog treeview.png" src="../images/Creating_a_Simple_X-Function/Ocguide_xfsimpledialog_treeview.png?v=77103" width="492"  /></a></li>
<li>Now we need to write the Origin C code that will do the work for our X-Function. Click on the Code Builder button <a  class="image"><img alt="Ocguide xfdialog codebuilderbutton.png" src="../images/Creating_a_Simple_X-Function/Ocguide_xfdialog_codebuilderbutton.png?v=77104" width="23"  /></a>.  This will open the X-Function in Code Builder where we can write our Origin C code. In the main function, add the following Origin C code:
<pre class="oc" style="font-family:monospace;">ocol <span style="color: #000080;">=</span> icol;</pre></li>
<li>Click the <b>Compile</b> button and then click the <b>Return to Dialog</b> button to go back to X-Function Builder.  Click <a  class="image"><img alt="Ocguide xfdialog savebutton.png" src="../images/Creating_a_Simple_X-Function/Ocguide_xfdialog_savebutton.png?v=77100" width="23"  /></a> button again.</li>
<li>Close the X-Function builder tool. </li>
<li>You can always reopen the tool and choose <b>Open</b> button to load a created X-Function to edit further.</li>
</ol>
<h2><a name="X-Function.2C_ExecutionUsing_X-Functions"></a><span class="mw-headline"><span class="OIndex" style="display:none">X-Function, Execution</span>Using X-Functions</span></h2>
<p>Now that we have successfully created our X-Function, we can test it.
</p>
<ol><li> Create a new a worksheet with two columns.  Fill column A and B with random numbers.</li>
<li> Highlight Column A by clicking the A(X) header.</li>
<li> In the Script or Command Window enter the X-Function name <b>CopyCol</b> without any variables after it and press Enter key to execute it with default settings.</li>
<li> It will create a new column and copy column A data to it.</li>
<li> Now highlight column B.</li>
<li> In Script window, enter <b>CopyCol -d</b> and press Enter key to open the X-Function with dialog.</li>
<li> This will open a Simple GetN style dialog as we specified when building the X-Function. The input and output are loaded with our default settings. Click the OK button.</li>
<li> It will create a new column with column B value copied.</li></ol>
<p>See <a class="external text" href="../../LabTalk/Category/X-Functions.html">X-Functions</a> for more explanation of X-Function and how to call it.
</p>





