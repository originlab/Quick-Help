<h1 class="firstHeading">2.14.2.15 op_change</h1><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Brief_Information"><span class="tocnumber">1</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Additional_Information"><span class="tocnumber">2</span> <span class="toctext">Additional Information</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Command_Line_Usage"><span class="tocnumber">3</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#X-Function_Execution_Options"><span class="tocnumber">4</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Variables"><span class="tocnumber">5</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Description"><span class="tocnumber">6</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Examples"><span class="tocnumber">7</span> <span class="toctext">Examples</span></a></li>
</ul>
</div>

<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Get/set/execute operation using a tree
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">Additional Information</span></h2>
<p>This X-Function is not designed for Auto GetN Dialog.
</p><p><b>Minimum Origin Version Required</b>: 8.1 SR2
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
1. op_change ir:=FitNL1! tr:=mytr;  // output the tree of an operation.
</p><p>2. op_change ir:=col(2) tr:=mytr op:=run; // Set the operation by a tree and run. 
</code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>
</td>
<td>ir
</td>
<td>
<p>Input
</p><p>Range
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td> Specifies the range that contains operation. This X-Function gets treenodes from or triggers the recalculation using settings specified in treenodes in this range.
</td></tr>
<tr>
<td>
</td>
<td>tr
</td>
<td>
<p>Input/Output
</p><p>TreeNode
</p>
</td>
<td> <center>&lt;none&gt;</center>
</td>
<td> Specifies the tree name to get or set operation settings.
</td></tr>
<tr>
<td>
</td>
<td>op
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specified the operation performed on the tree node
<p>Option list:
</p>
<ul><li><i>get:Get Tree</i>
<dl><dd>Gets settings from input operation object and store them in tree node</dd></dl></li>
<li><i>run:Set and Execute</i>
<dl><dd>Sets and executes the operation settings stored in tree node</dd></dl></li>
<li><i>set:Set Tree Only</i>
<dl><dd>Sets operation settings to tree node only</dd></dl></li></ul>
</td></tr>
<tr>
<td>
</td>
<td>result
</td>
<td>
<p>Output
</p><p>int
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td> Shows whether the execution succeeds or not. If result = 1, execution succeeds. If result = 0 or -1, execution fails.
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>After getting results of an operation, which allows recalculation, it is usually wanted to get access to the operation settings, change some of them and trigger a new recalculation. This X-Function allows you to obtain the operation settings from the input object and store them into a user-defined tree. You can reset the settings and execute the operation again. It is especially useful when you load an Analysis Template and want to change some settings for a new run of analysis.
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p>This example shows how do a smoothing and then modify input and some parameters and update the result with op_change X-Function.
</p>
<pre class="lt" style="font-family:monospace;">newbook;
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span><span style="color: #000000;">&#123;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">32</span><span style="color: #000000;">&#125;</span>; <span style="color: #008000;">//Fill first column with numbers from 1 to 32</span>
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">+</span>rnd<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//Fill second column with column 1's value plus random numbers.</span>
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">+</span><span style="color: #0000dd;">3</span><span style="color: #000080;">*</span>rnd<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//Create and fill third column with column 1's values plus 3 times random numbers</span>
worksheet <span style="color: #000080;">-</span>s <span style="color: #0000dd;">2</span> <span style="color: #0000dd;">0</span>; <span style="color: #008000;">//select 2nd column</span>
smooth <span style="color: #000080;">-</span>r <span style="color: #0000dd;">2</span>; <span style="color: #008000;">//do smoothing on selected column and set recalculation mode to manual</span>
op_change ir<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span> tr<span style="color: #000000;">:</span><span style="color: #000080;">=</span>mytree; <span style="color: #008000;">//get smooth settings to mytree </span>
mytree.<span style="color: #000080;">xfGetN</span>.<span style="color: #000080;">iy</span>.<span style="color: #000080;">Range1</span>.<span style="color: #000080;">Y</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;[%H]Sheet1!C&quot;</span>; <span style="color: #008000;">//change input Y value to be column C. Note: User can run mytree.= to see the contents in tree</span>
mytree.<span style="color: #000080;">xfGetN</span>.<span style="color: #000080;">npts</span><span style="color: #000080;">=</span><span style="color: #0000dd;">10</span>; <span style="color: #008000;">//change npt variable (points of window) to be 10</span>
op_change ir<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span> tr<span style="color: #000000;">:</span><span style="color: #000080;">=</span>mytree op<span style="color: #000000;">:</span><span style="color: #000080;">=</span>run; <span style="color: #008000;">//recalculate smoothing by using changed settings in mytree: col C as input and npts=10</span></pre>
<p>This example modifies the polynomial fitting's settings with op_change X-function.
</p>
<pre class="lt" style="font-family:monospace;">newbook name<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Curves&quot;</span> result<span style="color: #000000;">:</span><span style="color: #000080;">=</span>bkn<span style="color: #000080;">$</span>;
<span style="color: #008000;">// import file from Origin EXE path.</span>
string fn<span style="color: #000080;">$</span><span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;\Samples\Curve Fitting\Polynomial Fit.dat&quot;</span>&#160;;
impASC fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span> fn<span style="color: #000080;">$</span>
options.<span style="color: #000080;">sparklines</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> 
options.<span style="color: #000080;">FileStruct</span>.<span style="color: #000080;">NumericSeparator</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> 
options.<span style="color: #000080;">Names</span>.<span style="color: #000080;">FNameToSht</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> 
options.<span style="color: #000080;">Names</span>.<span style="color: #000080;">FNameToBk</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> 
options.<span style="color: #000080;">Names</span>.<span style="color: #000080;">FNameToBkComm</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;
<span style="color: #008000;">// use fitpoly X-function to carry out polynomial fit for the XY dataset in the first two columns.</span>
<span style="color: #008000;">// use the &quot;-r&quot; switch option to set the recalculation mode to &quot;Auto&quot;. </span>
fitpoly iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span><span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>bkn<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">!</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> polyorder<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span> 
        coef<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>new<span style="color: #000080;">&gt;</span> oy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span><span style="color: #000080;">&lt;</span>Input<span style="color: #000080;">&gt;</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">&lt;</span>new<span style="color: #000080;">&gt;</span><span style="color: #000080;">!</span><span style="color: #000080;">&lt;</span>new<span style="color: #000080;">&gt;</span> 
        AdjRSq<span style="color: #000000;">:</span><span style="color: #000080;">=</span>arsq RSqCOD<span style="color: #000000;">:</span><span style="color: #000080;">=</span>rsq <span style="color: #000080;">-</span>r <span style="color: #0000dd;">1</span>;
<span style="color: #008000;">// get a range variable that contains this operation, which will be used later. </span>
range r1 <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span><span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>bkn<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>page.<span style="color: #000080;">active</span><span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">!</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// get the setting in the operation as the tree variable mytree. </span>
op_change ir<span style="color: #000000;">:</span><span style="color: #000080;">=</span>r1 tr<span style="color: #000000;">:</span><span style="color: #000080;">=</span>mytree;
<span style="color: #008000;">// change the settings of the operation.</span>
<span style="color: #008000;">// change the input data</span>
mytree.<span style="color: #000080;">xfGetN</span>.<span style="color: #000080;">iy</span>.<span style="color: #000080;">Range1</span>.<span style="color: #000080;">Y</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;[%(bkn$)]1!C&quot;</span>;
<span style="color: #008000;">// change the polynomial order</span>
mytree.<span style="color: #000080;">xfGetN</span>.<span style="color: #000080;">polyorder</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>;
<span style="color: #008000;">// execute the operation again with the modified settings. </span>
op_change ir<span style="color: #000000;">:</span><span style="color: #000080;">=</span>r1 tr<span style="color: #000000;">:</span><span style="color: #000080;">=</span>mytree op<span style="color: #000000;">:</span><span style="color: #000080;">=</span>run;</pre>






