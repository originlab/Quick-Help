<h1 class="firstHeading">2.2.1.2 r2m</h1><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Brief_Information"><span class="tocnumber">1</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Command_Line_Usage"><span class="tocnumber">2</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#X-Function_Execution_Options"><span class="tocnumber">3</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Variables"><span class="tocnumber">4</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Description"><span class="tocnumber">5</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Examples"><span class="tocnumber">6</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Related_X-Functions"><span class="tocnumber">7</span> <span class="toctext">Related X-Functions</span></a></li>
</ul>
</div>

<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Convert range of worksheet cells to matrix
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
1. r2m irng:=[Book1]Sheet1!Col(1)[1]:Col(4)[5]
</p><p>2. r2m irng:=[Book1]Sheet1!Col(1)[1]:Col(4)[5] om:=[MBook1]MSheet1!Mat(1)
</code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Input
</td>
<td>irng
</td>
<td>
<p>Input
</p><p>Range
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td>
<p>Specifies input data range
</p>
</td></tr>
<tr>
<td>Data Format
</td>
<td>xy
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>noxy</center>
</td>
<td> Specify the X and Y coordinates
<p>Option list:
</p>
<ul><li><i>xcol:X across columns</i></li></ul>
<dl><dd>0. Specify that the X coordinates will be from row values of the source input data, across the columns.</dd></dl>
<ul><li><i>ycol:Y across columns</i></li></ul>
<dl><dd>1. Specify that the Y coordinates will be from row values of the source input data, across the columns.</dd></dl>
<ul><li><i>noxy:No  X and Y</i></li></ul>
<dl><dd>2. Directly the specifies input data range without specifying X and Y coordinates. X and Y coordinates will be integer values.</dd></dl>
</td></tr>
<tr>
<td>X Values in
</td>
<td>xlabel
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center></center>
</td>
<td> Available when <b>X across columns</b> is selected from <b>Data Format</b>. It can be the input data first data row or a column label row.
<p>Option list:
</p>
<ul><li><i>none:None</i></li></ul>
<dl><dd>Use matrix column indices as X coordinates.</dd></dl>
<ul><li><i>row1:First Row in Selection</i></li></ul>
<dl><dd>Use the values of the first data row as X coordinates.</dd></dl>
<ul><li><i>param:Column Label</i></li></ul>
<dl><dd>Use the values of a column label row as X coordinates.</dd></dl>
</td></tr>
<tr>
<td>Y Values in First Column
</td>
<td>ycol
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Available when <b>X across columns</b> is selected from <b>Data Format</b>. Check to use the first column values as Y coordinates.
</td></tr>
<tr>
<td>Y Values in
</td>
<td>ylabel
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center></center>
</td>
<td> Available when <b>Y across columns</b> is selected from <b>Data Format</b>. It can be the input data first data row or a column label row.
<p>Option list:
</p>
<ul><li><i>none:None</i></li></ul>
<dl><dd>Use matrix row indices as Y coordinates.</dd></dl>
<ul><li><i>row1:First Row in Selection</i></li></ul>
<dl><dd>Use the values of the first data row as Y coordinates.</dd></dl>
<ul><li><i>param:Column Label</i></li></ul>
<dl><dd>Use the values of a column label row as Y coordinates.</dd></dl>
</td></tr>
<tr>
<td>X Values in First Column
</td>
<td>xcol
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Available when <i>Y across columns</i> is selected from <b>Data Format</b>. Check to use the first column values as X coordinates.
</td></tr>
<tr>
<td>Column Label
</td>
<td>param
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center></center>
</td>
<td> This is only available when <i>Column Label</i> is selected from <b>X Values in</b> or <b>Y Values in</b>. Specify the label row to use as the X or Y coordinates using its Label Row character. Please refer to <a class="external text" href="../../LabTalk/LabTalk/Column_Label_Row_Characters.html">Column Label Row Characters</a> for the single character of each column label row.
</td></tr>
<tr>
<td>Even Spacing Relative Tolerance(%)
</td>
<td>tol
</td>
<td>
<p>Input
</p><p>double
</p>
</td>
<td> <center>5</center>
</td>
<td> Tolerance used to check for even spacing.
</td></tr>
<tr>
<td>Use Linear Fit Estimate for Coordinates
</td>
<td>lr
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> This checkbox specifies whether or not to use linear fit estimate for coordinates.
</td></tr>
<tr>
<td>Trim Missing
</td>
<td>trim
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> Determine whether to trim the missing rows or columns
</td></tr>
<tr>
<td>Output Matrix
</td>
<td>om
</td>
<td>
<p>Output
</p><p>MatrixObject
</p>
</td>
<td> <center>&lt;new&gt;</center>
</td>
<td>
<p>Specifies output matrix
</p><p>See the syntax <a class="external text" href="../../XFunction/X-Function/Output_Notations.html">here</a>.
</p>
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>This function converts a range of worksheet data into matrix directly, and assigns the matrix coordinates automatically. More information about worksheet to matrix conversion, please refer to the help of <i>w2m</i> X-Function.
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<ul><li> Run from the Command window</li></ul>
<p>1.  Import the file \<i>Samples</i>\<i>Matrix Conversion and Gridding\DirectXY.dat</i>.
</p><p>2.  Type the following script in command window: 
<code>r2m irng:=!Col(1)[1]:Col(4)[5];</code>
</p><p>After you executed the script, the appointed range of worksheet data was converted into matrix directly.
</p>
<ul><li> Code Sample</li></ul>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000; font-style: regular;">/*
This example shows how convert worksheet range data into matrix.
The sample data is exe_path\Samples\Matrix Conversion and Gridding\DirectXY.dat.
1. Load data to a new created workbook.
2. Convert worksheet range into matrix.
*/</span>
<span style="color: #008000;">// Get sample file name</span>
fn<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Matrix Conversion and Gridding\DirectXY.dat&quot;</span>;
<span style="color: #008000;">// New a workbook</span>
newbook;
<span style="color: #008000;">// Import data to active worksheet</span>
impASC fn<span style="color: #000080;">$</span>;

<span style="color: #008000;">// Convert worksheet range into matrix</span>
r2m irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000080;">!</span>Col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">:</span>Col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">5</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">6</span><span style="color: #000000;">&#93;</span>;</pre>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">Related X-Functions</span></h2>
<p><a href="../../XFunction/X-Function/M2v.html" title="X-Function:M2v">m2v</a>, <a href="../../XFunction/X-Function/W2m.html" title="X-Function:W2m">w2m</a>, <a href="../../XFunction/X-Function/Wexpand2m.html" title="X-Function:Wexpand2m">wexpand2m</a>
</p>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>direct, xyz, expand, gridding</span></p>






