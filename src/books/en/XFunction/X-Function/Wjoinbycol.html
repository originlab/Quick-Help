<h1 class="firstHeading">2.2.3.49 wjoinbycol</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Brief_Information"><span class="tocnumber">1</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Additional_Information"><span class="tocnumber">2</span> <span class="toctext">Additional Information</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Command_Line_Usage"><span class="tocnumber">3</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#X-Function_Execution_Options"><span class="tocnumber">4</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Variables"><span class="tocnumber">5</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Description"><span class="tocnumber">6</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Examples"><span class="tocnumber">7</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Related_X-Functions"><span class="tocnumber">8</span> <span class="toctext">Related X-Functions</span></a></li>
</ul>
</div>

<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Restructure: Join Multiple Sheets by Column
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">Additional Information</span></h2>
<p class="version" >Minimum Origin Version Required: 2015 SR0</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
1. wjoinbycol irng:=([Book1]Sheet1,[Book2]Sheet1) condition:="[Book1]Sheet1!A=[Book2]Sheet1!A"
</p><p>2. wjoinbycol irng:=([Book1]B1,[Book1]B2,[Book2]B1,[Book2]B2) condition:="[Book1]B1!A=[Book1]B2!A=[Book2]B1!A=[Book2]B2!A" unmatch:=1 combine:=0 missing:=1;
</p><p></code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p>Please refer to <a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">this page</a> for additional option switches when accessing the x-function from script.
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Input Worksheets
</td>
<td>irng
</td>
<td>
<p>Input
</p><p>Range
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td>
<p>Specify the input worksheet range. 
</p><p>The syntax is: <b>([<i>BookName1</i>]<i>SheetName1</i>!, [<i>BookName2</i>]<i>SheetName2</i>!)</b>.
</p>
</td></tr>
<tr>
<td>Matching Columns
</td>
<td>condition
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td>
<p>Specify the matching column condition to join the worksheets, parallel to the input worksheets defined by irng, use "=" as connector. So all values in the matching column(s) will be compared and the matched rows will be combined as the same row in the result worksheet.
</p><p>The full syntax is: <br /><b>[<i>BookName1</i>]<i>SheetName1</i>!<i>ColumnShortName1</i>=[<i>BookName2</i>]<i>SheetName2</i>!<i>ColumnShortName2</i></b>
</p><p>When a <b>Long Name</b> is shared among input sheets, you can enter only column Long Name or Short Name (Long Name will be used for matching first) without an equal sign "=". It means all columns with the specified name in all input sheets should match. For example, if "<i>Time</i>" is entered as <b>Matching Columns</b>, all values in column("Time") of all selected sheets will be compared and the matched rows will be combined as the same row in result worksheet. If there is no column("Time") in a worksheet, that sheet will be dropped. 
</p>
</td></tr>
<tr>
<td>Sort Output
</td>
<td>sort
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td><center>2</center>
</td>
<td>
<p>Control the order of mathed values in the result sheet.Three options are available:
</p>
<dl><dd>0 = <i>asc:Matching Columns -- Ascending</i> </dd>
<dd>1 = <i>desc:Matching Columns -- Descending</i> </dd>
<dd>2 = <i>preserve:Preserve 1st sheet order</i> </dd></dl>
<p>If <b>Merge Matched Columns as One</b> is not selected, <b>Matching Columns â€“ Ascending/Descending</b> will sort output columns rather than matching columns by the first sheet order.
</p>
</td></tr>
<tr>
<td>Drop Non-matches
</td>
<td>unmatch
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>Specify whether to drop the values that do not have a match. 
</p>
<dl><dd>0 = do not drop and fill in other columns for non-match values with missing values, </dd>
<dd>1 = drop non-matches</dd></dl>
</td></tr>
<tr>
<td>Drop Multiples
</td>
<td>multiple
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>This is supposed to be used when there are multiple matched cells for one value. It is used to specify whether to drop the other data rows other than the first match. 0 = do not drop, 1 = drop.
</p><p>When <i>multiple</i> is set to <b>1</b>, only the first match found will be included in the result worksheet. 
</p>
</td></tr>
<tr>
<td>Match with All Combinations
</td>
<td>combine
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td>
<p>This is also supposed to be used when there are multiple matched cells for one value. It is used to specify whether to show all possible combinations in result worksheet. 
</p>
<dl><dd>0 = do not show all combinations and fill in other columns without combinations with missing values, </dd>
<dd>1 = show all combinations</dd></dl>
</td></tr>
<tr>
<td>Merge Matched Columns as One
</td>
<td>merge
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td>
<p>Specify whether to keep only one matched column in the result worksheet. 
</p>
<dl><dd>0 = do not keep, there will be multiple matched columns in result sheet, </dd>
<dd>1 = keep only one matched column in the result worksheet. In this case, only one matching column will be shown in the result worksheet as the first column and the data columns will be arranged side by side.</dd></dl>
</td></tr>
<tr>
<td>Consider Missing Value
</td>
<td>missing
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>Specify whether to ignore rows with missing values in the matching columns. 
</p>
<dl><dd>0 = if there are missing values in matching column, the whole data row will be ignored in the result sheet, </dd>
<dd>1 = the missing values in the matching column(s) will be treated as a separate group.  </dd></dl>
</td></tr>
<tr>
<td>Dataset Identifier
</td>
<td>id
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>Specify source dataset indentifier.
<p>0 = None, 1 = Range, 2 = Book Name, 3 = Sheet Name, 4 = Use index constructed in <b>index</b> to identify dadtaset source, 5 = Show sheet label of source worksheet.
</p>
</td></tr>
<tr>
<td>Index
</td>
<td>index
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>&lt;auto&gt;</center>
</td>
<td>Available when id = 4. Specify the index of the identifier.
<p>Format is <b><i>start</i>:<i>increment</i></b>. For example, &gt;code?1:2&lt;/code&gt; will indentify source worksheet as 1,3,5,...
</p>
</td></tr>
<tr>
<td>Output Worksheet
</td>
<td>ow
</td>
<td>
<p>Output
</p><p>Worksheet
</p>
</td>
<td> <center>&lt;new&gt;</center>
</td>
<td>
<p>Specify the output range, see syntax <a href="../../XFunction/X-Function/Output_Notations.html" title="X-Function:Output Notations">here</a>.
</p>
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>This X-Function can be used via LabTalk script. It can be used to combine multiple worksheets into one, the combination will be determined by matching columns in each input worksheet. Several options are provided to determine how to treat special cases when combining (e.g. multiple matched cells, non-match values, missing values.etc). 
</p><p>If you want to combine two worksheets, you can also consider <a class="external text" href="../../UserGuide/UserGuide/Join_Worksheets_by_Column.html">Join Worksheets by Column tool</a>.
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p>The following example shows simple cases to combine worksheets with matching column, the data in the matching column is date.
</p>
<ol>
<li>Create a new Origin project file, use <b>Window:Script Window</b> to open the <b>Script Window</b>, run the following scripts to prepare the source data sheets:</li>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create new workbook with 2 worksheets</span>
newbook name<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;JoinWksEx&quot;</span> sheet<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span> option<span style="color: #000000;">:</span><span style="color: #000080;">=</span>lsname;
<span style="color: #008000;">// Fill in column A in Sheet 1 with patterned date from 2014/10/1 to 2014/10/25</span>
patternD irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>JoinWksEx<span style="color: #000000;">&#93;</span>Sheet1<span style="color: #000080;">!</span>col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span> from<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2456931</span> to<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2456955</span> unit<span style="color: #000000;">:</span><span style="color: #000080;">=</span>day;
<span style="color: #008000;">// Fill in column B in Sheet 1 with row index</span>
patternN irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>JoinWksEx<span style="color: #000000;">&#93;</span>Sheet1<span style="color: #000080;">!</span>col<span style="color: #000000;">&#40;</span>B<span style="color: #000000;">&#41;</span> to<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">25</span>;
<span style="color: #008000;">// Fill in column A in Sheet 2 with patterned date from 2014/10/10 to 2014/10/30 with a different display format</span>
patternD irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>JoinWksEx<span style="color: #000000;">&#93;</span>Sheet2<span style="color: #000080;">!</span>col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span> display<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">19</span> from<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2456940</span> to<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2456960</span> unit<span style="color: #000000;">:</span><span style="color: #000080;">=</span>day;
<span style="color: #008000;">// Fill in column B in Sheet 2 with patterned index from 10 to 30</span>
patternN irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>JoinWksEx<span style="color: #000000;">&#93;</span>Sheet2<span style="color: #000080;">!</span>col<span style="color: #000000;">&#40;</span>B<span style="color: #000000;">&#41;</span> from<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">10</span> to<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">30</span>;</pre>
<li>You should have a worksheet named as <i>JoinWksEx</i> with two worksheets and filled with some data, note that column A in both sheets (with date data) will be used as matching columns, and the display formats are different in the two sheets.</li>
<li>Now execute the <i>wjoinbycol</i> X-Function and get results for different cases:</li>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Case 1: combine with default settings, i.e. not to drop non-matches and merge matched column as one</span>
wjoinbycol irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>JoinWksEx<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#40;</span>Sheet1,Sheet2<span style="color: #000000;">&#41;</span> condition<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;[JoinWksEx]Sheet1!A=[JoinWksEx]Sheet2!A&quot;</span> ow<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span><span style="color: #000080;">&lt;</span>new<span style="color: #000080;">&gt;</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">&lt;</span>new<span style="color: #000080;">&gt;</span>;

<span style="color: #008000;">// Case 2: drop non-matches</span>
wjoinbycol irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>JoinWksEx<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#40;</span>Sheet1,Sheet2<span style="color: #000000;">&#41;</span> condition<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;[JoinWksEx]Sheet1!A=[JoinWksEx]Sheet2!A&quot;</span> unmatch<span style="color: #000000;">:</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span> ow<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span><span style="color: #000080;">&lt;</span>new<span style="color: #000080;">&gt;</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">&lt;</span>new<span style="color: #000080;">&gt;</span>;

<span style="color: #008000;">// Case 3: not to merge matched columns as one</span>
wjoinbycol irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>JoinWksEx<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#40;</span>Sheet1,Sheet2<span style="color: #000000;">&#41;</span> condition<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;[JoinWksEx]Sheet1!A=[JoinWksEx]Sheet2!A&quot;</span> merge<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> ow<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span><span style="color: #000080;">&lt;</span>new<span style="color: #000080;">&gt;</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">&lt;</span>new<span style="color: #000080;">&gt;</span>;</pre> 
</ol>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">Related X-Functions</span></h2>
<p><a href="../../XFunction/X-Function/WAppend.html" title="X-Function:WAppend">wappend</a>, <a href="../../XFunction/X-Function/Wjoinbylabel.html" title="X-Function:Wjoinbylabel">wjoinbylabel</a>, <a href="../../XFunction/X-Function/Wjoincols.html" title="X-Function:Wjoincols">Wjoincols</a>
</p>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>merge, combine</span></p>






