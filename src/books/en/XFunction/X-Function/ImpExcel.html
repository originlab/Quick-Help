<h1 class="firstHeading">2.7.33 impExcel</h1><p><br />
</p><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Brief_Information"><span class="tocnumber">1</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Command_Line_Usage"><span class="tocnumber">2</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#X-Function_Execution_Options"><span class="tocnumber">3</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Variables"><span class="tocnumber">4</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Description"><span class="tocnumber">5</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Examples"><span class="tocnumber">6</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Related_X-Functions"><span class="tocnumber">7</span> <span class="toctext">Related X-Functions</span></a></li>
</ul>
</div>

<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Import Excel 97-2003 files directly and import Excel 2007 or later with COM component.
</p><p><b>Note</b>: This is an older routine for importing Excel files. Users are encouraged to use the newer <a href="../../XFunction/X-Function/ImpMSExcel.html" title="X-Function:ImpMSExcel"><b>impMSExcel</b></a> X-Function (COM not used, therefore MS Excel need not be installed) or <a class="external text" href="../../UserGuide/Category/Data_Connector.html"><b>Data Connectors</b></a> (supports import of both local or web files).
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
1. fname$="sample.xls"; impExcel; // import the file sample.xls
</p><p>2. dlgfile g:=*.xls;impExcel cell:=0 l:=1 d:=NN; //import without format, 1st row as longname and set all cols to have no designation
</p><p>3. impExcel fname:="E:\Sample.xls" template:=MyTemplate.ogw; // Import the file sample.xls into the analysis template MyTemplate
</code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="TableGrid" style="; border-spacing: 0px; border-spacing: 0px;background: #EFEFEF" border="1">

<tr>
<td>
<center><b>Display Name</b></center>
</td>
<td>
<center><b>Variable Name</b></center>
</td>
<td>
<center><b>I/O</b></center>
<center><b>and</b></center>
<center><b>Type</b></center>
</td>
<td>
<center><b>Default Value</b></center>
</td>
<td>
<center><b> Description </b> </center>
</td></tr>
<tr>
<td>
<center>File Name</center>
</td>
<td>
<center>fname</center>
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td><center>fname$</center>
</td>
<td>
<p>Filename of the file to be imported.
</p>
</td></tr>
<tr>
<td>
<center>File Info And Data Selection</center>
</td>
<td>
<center>info</center>
</td>
<td>
<p>Input
</p><p>TreeNode
</p>
</td>
<td><center>&lt;unassigned&gt;</center>
</td>
<td>
<p>This is used in the dialog for displaying the basic information of the file.
</p>
</td></tr>

<tr>
<td>
<center>1st File Import Mode</center>
</td>
<td><center>firstmode</center>
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td><center>0</center>
</td>
<td>
<p>Specify the import mode of the first imported file.
</p><p>Option list
</p>
<ul><li><i>replace{0}:Replace Existing Data</i></li></ul>
<dl><dd>Import data by replacing the existing Excel data in target window. 
<dl><dd><b>Note</b>: It will detect if the target workbook has ever been imported Excel file(s). If yes, the exsiting worksheets will be replaced from first sheet(redundant sheets will be deleted, new sheets will be inserted if existing number of sheets is not enough.)&#160;; If no, only the active worksheet will be replaced by first sheet of imported Excel file, other existing worksheets will be kept and other sheets of imported Excel file will be imported by starting new sheets. </dd></dl></dd></dl>
<ul><li><i>column{1}:Start New Columns for each Sheet</i></li></ul>
<dl><dd>Create new columns for each sheet in the first Excel file that will be imported. </dd></dl>
<ul><li><i>book{3}:Start New Books</i></li></ul>
<dl><dd>Create new book for the first Excel file.</dd></dl>
<ul><li><i>sheet{4}:Start New Sheets</i></li></ul>
<dl><dd>Create new sheet for the first Excel file.</dd></dl>
</td></tr>

<tr>
<td>
<center>Multiple Files (except 1st) Import Mode</center>
</td>
<td>
<center>impmode</center>
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td><center>3</center>
</td>
<td>
<p>This is used to specify the import mode for the imported files except for the first one.
</p><p>Option list
</p>
<ul><li><i>column{1}:Start New Columns for Each Sheet</i></li></ul>
<dl><dd>Create new columns for each sheet in the Excel file(s) that will be imported.</dd></dl>
<ul><li><i>book{3}:Start New Books</i></li></ul>
<dl><dd>Create new book for each file that will be imported. If the Excel file has multiple sheets, each sheet will be imported into a new sheet of the same book.</dd></dl>
<ul><li><i>sheet{4}:Start New Sheets</i></li></ul>
<dl><dd>Create new sheets for each sheet that will be imported.</dd></dl>
</td></tr>

<tr>
<td>
<center>Template Name</center>
</td>
<td>
<center>template</center>
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td><center>&lt;default&gt;</center>
</td>
<td>
<p>During importing data, a workbook template (*.otw) or an analysis template (*.ogw) can be used. You can select a template  from the drop-down list, or click the browse button to locate one. By default, an Origin prototype workbook template <i><b>&lt;default&gt;</b></i> is used. Origin also provides a special template named <b>&lt;clone&gt;</b>, which allows importing data files into the worksheet/workbook cloned from active worksheet/workbook. <b>Note</b>: when importing a multi-sheets Excel book into the specified workbook template which contains empty worksheet(s), you can refer to <a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#H.2CI.2CJ.2CK">system variable @ISE</a> for additional control over importing behavior.
</p>
</td></tr>

<tr>
<td><center>Use Excel COM Component to Import</center>
</td>
<td><center>excel</center>
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td><center>1</center>
</td>
<td>
<p>Specify whether to use the COM component provided by Excel to import the file. You must have Excel installed to use this option.
</p>
</td></tr>

<tr>
<td>
<center>Import Cell Formats</center>
</td>
<td>
<center>cellformats</center>
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td><center>1</center>
</td>
<td>
<p>This is used to keep format of the imported cells the same as in Excel. This option is not available when using COM and Excel does not need to be installed on your computer. This option will fail if you try to import .XLSX or .XLSM files - both of which can only be imported using COM.
</p>
</td></tr>

<tr>
<td>
<center>Maximum Number of Empty Columns (-1 for all)</center>
</td>
<td>
<center>emptycols</center>
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td><center>0</center>
</td>
<td>
<p>This is used to specify the maximum number of empty columns.
</p>
</td></tr>
<tr>
<td><center>Exclude Empty Sheets</center>
</td>
<td><center>excludeempty</center>
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td><center>1</center>
</td>
<td>
<p>Specifies whether input the empty sheets into target window. If it is chekced, empty sheets will not appear in the <b>File Sheet(s)</b> branch in the <b>File Info and Data Selection</b> branch.
</p>
</td></tr>

<tr>
<td><center>Number of Main Header Lines</center>
</td>
<td><center>mainheader</center>
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td><center>0</center>
</td>
<td>
<p>Specify the number of the main header lines, which will be skipped upon importing.
</p>
</td></tr>

<tr>
<td><center>Number of Subheader Lines</center>
</td>
<td><center>subheader</center>
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td><center>&lt;auto&gt;</center>
</td>
<td>
<p>Specify the number of the subheader lines. When it is &lt;auto&gt;, it means that the total number of subheader lines is decided by following node:
</p>
<ul><li>Index of Rows for Short Name</li>
<li>Index of Rows for Long Name</li>
<li>Index of Rows for Unit</li>
<li>Index of Rows for Comment From</li>
<li>Index of Rows for Comment To</li></ul>
</td></tr>

<tr>
<td>
<center>Index of Rows for Short Name</center>
</td>
<td>
<center>sname</center>
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td><center>&lt;none&gt;</center>
</td>
<td>
<p>Specify the row index for column short name.
</p><p><b>Note:</b> 
</p><p>From Origin 2017 column Short Name is restricted to alphabetical order and it cannot be changed by default. So <b>Index of Rows for Short Name</b> option is hidden from GUI. If you want to set column Short Names while importing, you need to go to the target workbook, uncheck <b>Spreadsheet Cell Notation</b> checkbox in <a class="external text" href="../../UserGuide/UserGuide/Folder_and_Window_Properties_Dialog.html#The_Properties_tab">the <b>Properties</b> tab of <b>Window Properties</b> dialog</a> to enable editing column Short Name.
</p>
</td></tr>

<tr>
<td>
<center>Index of Rows for Long Name</center>
</td>
<td>
<center>lname</center>
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td><center>&lt;none&gt;</center>
</td>
<td>
<p>Specify the row index for column long name.
</p>
</td></tr>


<tr>
<td>
<center>Index of Rows for Unit</center>
</td>
<td>
<center>unit</center>
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td><center>&lt;none&gt;</center>
</td>
<td>
<p>Specify the row index for column unit.
</p>
</td></tr>


<tr>
<td>
<center>Index of Rows for Comment from</center>
</td>
<td>
<center>cmt1</center>
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td><center>&lt;none&gt;</center>
</td>
<td>
<p>Specify the start row index for column comments.
</p>
</td></tr>

<tr>
<td>
<center>Index of Rows for Comment to</center>
</td>
<td>
<center>cmt2</center>
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td><center>&lt;none&gt;</center>
</td>
<td>
<p>Specify the end row index for column comments.
</p>
</td></tr>

<tr>
<td>
<center>Index of Rows for Parameter from</center>
</td>
<td>
<center>para1</center>
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td><center>&lt;none&gt;</center>
</td>
<td>
<p>Specify the starting row index for system parameters.
</p>
</td></tr>

<tr>
<td>
<center>Index of Rows for Parameter to</center>
</td>
<td>
<center>para2</center>
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td><center>&lt;none&gt;</center>
</td>
<td>
<p>Specify the end row index for system parameters.
</p>
</td></tr>

<tr>
<td>
<center>Index of Rows for User Parameter from</center>
</td>
<td>
<center>udp1</center>
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td><center>&lt;none&gt;</center>
</td>
<td>
<p>Specify the starting row index for user parameters.
</p>
</td></tr>

<tr>
<td>
<center>Index of Rows for User Parameter to</center>
</td>
<td>
<center>udp2</center>
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td><center>&lt;none&gt;</center>
</td>
<td>
<p>Specify the end row index for user parameters.
</p>
</td></tr>

<tr>
<td>
<center>Remove Extra Rows</center>
</td>
<td>
<center>removerow</center>
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td><center>1</center>
</td>
<td>
<p>Specify whether to remove the heading rows (short name, long name, unit and comment) from the data rows. If this is selected, the heading rows will not be imported as data, but used only for setting the data rows. When Number of Subheader Lines is not &lt;auto&gt;, this control will be ignored.
</p>
</td></tr>

<tr>
<td>
<center>Column Designations</center>
</td>
<td>
<center>desig</center>
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td>
</td>
<td>
<p>Specify the column designations. The specified column designation will be applied to all sheet automatically. 
</p>
</td></tr>

<tr>
<td><center>Apply Header to All Sheets</center>
</td>
<td>
<center>allsheets</center>
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td><center>0</center>
</td>
<td>
<p>Specify whether apply the header to all Excel sheets.
</p>
</td></tr>

<tr>
<td>
<center>Import Options</center>
</td>
<td>
<center><a href="../../XFunction/X-Function/Details_of_TreeNodes_in_Import_Excel.html" title="X-Function:Details of TreeNodes in Import Excel">options</a></center>
</td>
<td>
<p>Input
</p><p>TreeNode
</p>
</td>
<td><center>&lt;unassigned&gt;</center>
</td>
<td>
<p>The branch <b>(Re)Naming Worksheet and Workbook</b>(<a href="../../XFunction/X-Function/Details_of_TreeNodes_in_Import_ASCII.html#Names" title="X-Function:Details of TreeNodes in Import ASCII">Options.Names</a>) is used to specify how to rename the worksheet and workbook.
<br />
Another branch <b>Partial Import</b>(<a href="../../XFunction/X-Function/Details_of_TreeNodes_in_Import_ASCII.html#PartImp" title="X-Function:Details of TreeNodes in Import ASCII">Options.PartImp</a>) is used to specify how to partially import the Excel files. For this X-Function, available sub tree nodes are: <i>partial</i>, <i>FirstCol</i>, <i>ReadCols</i>, <i>SkipCols</i>,<i>LastCol</i>.
</p>
</td></tr>


<tr>
<td>
<center>Output</center>
</td>
<td>
<center>orng</center>
</td>
<td>
<p>Output
</p><p>Range
</p>
</td>
<td><center>&lt;active&gt;</center>
</td>
<td>
<p>This is used to specify the output range.
</p>
</td></tr>


<tr>
<td>
<center>Header Information</center>
</td>
<td>
<center>finfo</center>
</td>
<td>
<p>Output
</p><p>TreeNode
</p>
</td>
<td><center>&lt;optional&gt;</center>
</td>
<td>
<p>This is for outputting the header information. It is hidden from the GUI. Users are not advised to use this variable.
</p>
</td></tr>
<tr>
<td>
<p>Sheet Names or Indexes
</p>
</td>
<td><center>sheet</center>
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center></center>
</td>
<td>
<p>Specify the Excel sheets to import. Use the colons to divide the sheet names or indexes. It is hidden from the GUI. Use of this variable is not advised. 
</p>
</td></tr>
<tr>
<td>
<p>Repeat Import
</p>
</td>
<td><center>reimp</center>
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>Specify whether the current import is a reimporting process. It is hidden from the GUI. Use of this variable is not advised. 
</p>
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>This X-Function is used for importing Microsoft Excel files. This works for .XLS files even if Excel is not installed, in which case COM is not used. Newer file formats ( .XLSX &amp; .XLSM ) require Excel.
</p><p>-  Menu: Select <b>Data: Import from File: Excel (XLS, XLSX, XLSM)...</b>
</p><p>-  Command window: type <b>impExcel</b> <b>-d</b> in command window.
</p><p>The imported Excel workbook can have more than one sheet. All sheets will be imported into separate Origin worksheets in the target workbook, using the same import settings.
</p><p>The first few rows of the imported Excel worksheet can be used to set the short names, long names, units and comments of the columns in Origin worksheet. You can specify these rows by setting non-zero row index numbers for them.
</p><p>From Origin 2015, re-import one or multiple sheets from Excel to Origin is supported. During Excel re-importing, a link is maintained so that Origin is able to use up-to-date data.
</p><p>To re-import Excel files, go to <b>Data: Re-Import Directly</b> or use Ctrl+4 keys to re-import Excel sheets with same settings as before. Or you can go to <b>Data: Re-Import...</b> to bring up dialog box to change import settings for files to be re-imported.
</p><p>You can also type command <b>reimport -d</b> in command window to re-import Excel files.
</p><p>From Origin 2016, you can import Excel workbook(s) into a prepared workbook template or analysis template to batch customize/analyze data in Excel books.
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p><b>Example 1</b>
</p><p>The following example imports an Excel file using factory default options:
</p>
<ol><li> In the Command Window, type the following command <pre class="lt" style="font-family:monospace;">impExcel <span style="color: #000080;">-</span>d;</pre> This opens the <b>Excel Files</b> dialog for you to choose the import file.</li>
<li> Browse to the folder where your data file is. Select the file and click the <b>Add File(s)</b> button. Click <b>OK</b> to close the dialog box.</li>
<li> In the <b>impExcel</b> dialog box, load <i><b>&lt;default&gt;</b></i> for theme. Click <b>Ok</b> to close the dialog.</li></ol>
<p><b>Example 2</b>
</p><p>The following script command imports an Excel file (c:\test.xls) without opening the dialog:
</p>
<pre class="lt" style="font-family:monospace;">fname<span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;c:\test.xls&quot;</span>;
impexcel;</pre>
<p><b>Example 3</b>
</p><p>The following script command imports the specified Excel sheets:
</p>
<pre class="lt" style="font-family:monospace;">newbook;
fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;c:\test.xls&quot;</span>;
impExcel sheet<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">3</span><span style="color: #000000;">:</span><span style="color: #0000dd;">5</span>; <span style="color: #008000;">//Import the first, the third and the fifth Excel sheets only</span>
newbook;
impExcel sheet<span style="color: #000000;">:</span><span style="color: #000080;">=</span>SheetName1<span style="color: #000000;">:</span>SheetName2; <span style="color: #008000;">//Import the Excel sheets named SheetName1 and SheetName2</span></pre>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">Related X-Functions</span></h2>
<p><a href="../../XFunction/X-Function/ImpFile.html" title="X-Function:ImpFile">impfile</a>, <a href="../../XFunction/X-Function/Impinfo.html" title="X-Function:Impinfo">impinfo</a>
</p>





