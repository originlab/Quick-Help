<h1 class="firstHeading">2.10.36 plotvm</h1><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Brief_Information"><span class="tocnumber">1</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Additional_Information"><span class="tocnumber">2</span> <span class="toctext">Additional Information</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Command_Line_Usage"><span class="tocnumber">3</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#X-Function_Execution_Options"><span class="tocnumber">4</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Variables"><span class="tocnumber">5</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Description"><span class="tocnumber">6</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Example"><span class="tocnumber">7</span> <span class="toctext">Example</span></a></li>
</ul>
</div>

<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Create contour, image or heatmap plot from a range of worksheet cells
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">Additional Information</span></h2>
<p><b>Minimum Origin Version Required</b>: 8.5 SR0<br />
The option to hide the resulting graph became available in 9.0.
The vmname, coltype, rowtype variables are introduced from Origin 2015.
The dend to support dynamic end column/row are instroduced from Origin 2018b.
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
1. plotvm irng:=1!!5:dend;
</p><p>2. plotvm irng:=1! rowpos:=2 colpos:=2;
</p><p>3. plotvm irng:=1!2[3]:4[5] rowpos:=4 rowrng:=[1]:[1] colpos:=4 colrng:=1;
</p><p>4. plotvm irng:=1! ztitle:="VSurface 1" type:=242 ogl:=[&lt;new template:=cmap&gt;];
</p><p>5. plotvm irng:=1! rowpos:=label label:=L rowtype:=T0 colpos:=selcol1 coltype:=D0 ogl:=&lt;new template:=heatmap&gt;;
</p><p>6. plotvm irng:=VM1;  //Use virtual matrix "VM1" to create contour plot.
</code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Input
</td>
<td>irng
</td>
<td>
<p>Input
</p><p>Range
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td>
<p>Specify Z-values or an existing virtual matrix to plot. Use <i>dend</i> to speicfy the dynamic end column/row.
</p>
</td></tr>
<tr>
<td>Data Layout
</td>
<td>format
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>Specify which way to set the X- and Y-values.
</p>
<dl><dd><ul><li> 0: Y across columns</li></ul></dd></dl>
<p>Use a row as Y-values and a column as X-values.
</p>
<dl><dd><ul><li> 1: X across columns</li></ul></dd></dl>
<p>Use a row as X-values and a column as Y-values.
</p>
</td></tr>
<tr>
<td>Y Values in / X Values in
</td>
<td>rowpos
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>&lt;auto&gt;</center>
</td>
<td>
<p>Specify the row for Y(or X)-values. Whether Y or X-values are specified is determined by the value of <b>format</b>.
</p><p>Note that Y(or X)-values in the row should be in descending or ascending order.
</p>
<dl><dd><ul><li> 0: None</li></ul>
<dl><dd> Use column number in the selected range of cells from a worksheet as Y(or X)-values, which starts from 1.</dd></dl>
<ul><li> 1: 1st row in selection</li></ul>
<dl><dd> Use the first row in the selection as Y(or X)-values.</dd></dl>
<ul><li> 2: 1st row in worksheet</li></ul>
<dl><dd> Use the first row in the worksheet as Y(or X)-values. Note that if only a range of a worksheet is specified in <b>irng</b>, only the corresponding part of the first row in the worksheet is used as Y(or X)-values.</dd></dl>
<ul><li> 3: Column label</li></ul>
<dl><dd> Use the column labels in the worksheet as the Y(or X)-values. Column Label row is specified in <b>label</b>. Note that if only a range of a worksheet is specified in <b>irng</b>, only the corresponding part of the Column Label row in the worksheet is used as Y(or X)-values.</dd></dl>
<ul><li> 4: Custom</li></ul>
<dl><dd> Specify a row in the worksheet.</dd></dl></dd></dl>
</td></tr>
<tr>
<td>Y Range
</td>
<td>rowrng
</td>
<td>
<p>Input
</p><p>Range
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td>
<dl><dd>Specify a row for Y(or X)-values. <b>rowrng</b> should be specified only when <b>rowpos</b> is set to 4.</dd>
<dd>Note that <b>rowrng</b> should be in the same worksheet of <b>irng</b>.</dd></dl>
</td></tr>
<tr>
<td>Column Label
</td>
<td>label
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td>
<p>Specify a string for Column Label whose row is used as Y(or X)-values. <b>label</b> should be specified only when <b>rowpos</b> is set to 3.
</p>
<dl><dd><ul><li>"Long Name"{L}:Long Name
<dl><dd>Use Long Name row as Y(or X)-values.</dd></dl></li>
<li>"Units"{U}:Units
<dl><dd>Use Units row as Y(or X)-values.</dd></dl></li>
<li>"Comments"{C}:Comments
<dl><dd>Use Comments row as Y(or X)-values.</dd></dl></li>
<li>&lt;custom&gt;:Parameters 1
<dl><dd>Use Parameters 1 row as Y(or X)-values.</dd></dl></li></ul></dd></dl>
<p>Note: It needs to use a single character to specify the column label row in script. Please refer to <a class="external text" href="../../LabTalk/LabTalk/Column_Label_Row_Characters.html">Column Label Row Characters</a> for the single character of each column label row.
</p>
</td></tr>
<tr>
<td>Format Y/X Data
</td>
<td>rowtype
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td>
<p>Specify the data format of the X/Y data. This variable is only accessible when the <b>rowpos</b> variable is not set to 0 (None). You can refer to supported <a class="external text" href="../../UserGuide/UserGuide/Numbers_in_Origin.html#Custom_Display_Format">Origin Formats notation</a> for details.
</p>
</td></tr>
<tr>
<td>X Values in / Y Values in
</td>
<td>colpos
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>&lt;auto&gt;</center>
</td>
<td>
<p>Specify the column for X(or Y)-values. Whether X or Y-values are specified is determined by the value of <b>format</b>.
</p><p>Note that X(or Y)-values in the column should be in descending or ascending order.
</p>
<dl><dd><ul><li> 0: None</li></ul>
<dl><dd> Use row number in the selected range of cells from a worksheet as X(or Y)-values, which starts from 1.</dd></dl>
<ul><li> 1: 1st column in selection</li></ul>
<dl><dd> Use the first column in the selection as X(or Y)-values.</dd></dl>
<ul><li> 2: 1st column in worksheet</li></ul>
<dl><dd> Use the first column in the worksheet as X(or Y)-values. Note that if only a range of a worksheet is specified in <b>irng</b>, only the corresponding part of the first column in the worksheet is used as X(or Y)-values.</dd></dl>
<ul><li> 3: X column to the left of the selection</li></ul>
<dl><dd> Use the nearest X column to the left of the range of <b>irng</b> as X(or Y)-values. It can be specified only when there is at least one X column on the left side of the range of <b>irng</b>.</dd></dl>
<ul><li> 4: Custom</li></ul>
<dl><dd> Specify a column in the worksheet.</dd></dl></dd></dl>
</td></tr>
<tr>
<td>X Range
</td>
<td>colrng
</td>
<td>
<p>Input
</p><p>Range
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td>
<dl><dd>Specify a column for X(or Y)-values. <b>colrng</b> should be specified only when <b>colpos</b> is set to 4.</dd>
<dd>Note that <b>colrng</b> should be in the same worksheet of <b>irng</b>.</dd></dl>
</td></tr>
<tr>
<td>Format X/Y Data
</td>
<td>coltype
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td>
<p>Specify the data format of the X/Y data. This variable is only accessible when <b>colpos</b> variable is not set to 0 (None). You can refer to supported <a class="external text" href="../../UserGuide/UserGuide/Numbers_in_Origin.html#Custom_Display_Format">Origin Formats notation</a> for details.
</p>
</td></tr>
<tr>
<td>X Title
</td>
<td>xtitle
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>X Title</center>
</td>
<td>
<p>Specify the X-axis title. 
</p>
</td></tr>
<tr>
<td>Y Title
</td>
<td>ytitle
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>Y Title</center>
</td>
<td>
<p>Specify the Y-axis title.
</p>
</td></tr>
<tr>
<td>Z Title
</td>
<td>ztitle
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>Z Title</center>
</td>
<td>
<p>Specify the Z-axis title.
</p>
</td></tr>
<tr>
<td>Virtual Matrix Name
</td>
<td>vmname
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>VM1</center>
</td>
<td>
<p>Specify the name of virtual matrix.
</p>
</td></tr>
<tr>
<td>Plot Type
</td>
<td>type
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>226</center>
</td>
<td>
<p>Specify the plot type for 3D or contour graph.
</p><p>For details about plot types, see <a class="external text" href="../../LabTalk/LabTalk/Worksheet_(command).html#-p.3B_Plot_the_current_worksheet_selection_in_the_nth_graph_type_into_the_template">Plot Types in Labtalk</a>.
</p>
</td></tr>
<tr>
<td>Hide Newly Created Graph
</td>
<td>hide
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>Specify whether to hide the newly created graph. Note that this option is hidden in the dialog. One can only assign its value through Labtalk script.
</p>
</td></tr>
<tr>
<td>
</td>
<td>ogl
</td>
<td>
<p>Output
</p><p>GraphLayer
</p>
</td>
<td> <center>[&lt;new template:=contour&gt;]</center>
</td>
<td>
<p>Specify the graph layer to add plots.
See the syntax <a class="external text" href="../../XFunction/X-Function/Output_Notations.html">here</a>.
</p>
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>This X-Function plots 3D or contour graph from a range of cells in a worksheet as a virtual matrix. It provides several options to define Y(or X)-values.
</p><p>Note that <b>plotvm</b> supports uneven x or y spacing of values to plot 3D or contour graph.
</p><p>For details about the use of <b>plotvm</b> dialog in Origin's menu, see <a class="external text" href="../../UserGuide/UserGuide/Creating_3D_and_Contour_Graphs_from_Virtual_Matrix.html">Creating 3D and Contour Graphs from Virtual Matrix</a>.
</p>
<h2><a name="Example"></a><span class="mw-headline">Example</span></h2>
<p>The following script uses the X-Function <b>plotvm</b> to plot a contour plot from a worksheet with Y-values in the first row and X-values in the first column.
</p>
<pre class="lt" style="font-family:monospace;">impASC fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span><span style="color: #000080;">+</span><span style="color: #ff00ff;">&quot;Samples\Graphing\VSurface 1.dat&quot;</span>;
plotvm irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span> rowpos<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span> colpos<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>;</pre>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>virtual matrix</span></p>






