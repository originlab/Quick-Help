<h1 class="firstHeading">2.2.30 text2cols</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Brief_Information"><span class="tocnumber">1</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Additional_Information"><span class="tocnumber">2</span> <span class="toctext">Additional Information</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Command_Line_Usage"><span class="tocnumber">3</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#X-Function_Execution_Options"><span class="tocnumber">4</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Variables"><span class="tocnumber">5</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Description"><span class="tocnumber">6</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Examples"><span class="tocnumber">7</span> <span class="toctext">Examples</span></a></li>
</ul>
</div>

<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Take a delimited string and parse it to separate columns.
</p><p>See <a class="external text" href="../../LabTalk/Script/LabTalk-Supported_Functions.html#Lookup_.26_Reference_Functions">LabTalk Supported Functions</a> for <b>CatIndex</b>, and <b>Catrows</b>.
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">Additional Information</span></h2>
<p>Dialog box not available from a menu command in the user interface. As with any X-Function dialog, open the Script or Command Window, type the following and press ENTER.
</p>
<pre class="lt" style="font-family:monospace;">text2cols <span style="color: #000080;">-</span>d</pre>
<p>For script access, see <i>Command Line Usage</i>, next.
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
text2cols ix:=[Book2]Sheet1!B delimiter:=pipe; // take pipe-separated strings in [Book2]Sheet1!B as input, output values to separate columns in new sheet
</code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Text Column
</td>
<td>ix
</td>
<td> Input<br />vector&lt;string&gt;
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> Text Column. Cell(s) contain a string of delimited values. Delimiter must be one of those listed for Delimiter.
</td></tr>
<tr>
<td>Delimiter
</td>
<td>delimiter
</td>
<td> Input<br />int
</td>
<td> <center>0</center>
</td>
<td> Delimiter, allowed values: <br />
<ul><li> 0=comma:Comma</li>
<li> 1=semicolon:Semicolon</li>
<li> 2=pipe:Pipe</li>
<li> 3=space:White Space</li></ul>
</td></tr>
<tr>
<td>Include Other Column(s)
</td>
<td>nosplit
</td>
<td> Input<br />int
</td>
<td> <center>0</center>
</td>
<td> Copy over other columns with the output?
<ul><li> 0 = false</li>
<li> 1 = true</li></ul>
</td></tr>
<tr>
<td>Other Column(s)
</td>
<td>other
</td>
<td> Input<br />range
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td> Other columns to be copied over with output (parsed data).
</td></tr>
<tr>
<td>Output
</td>
<td>rd
</td>
<td> Output<br />ReportData
</td>
<td> <center>[input]&lt;new&gt;</center>
</td>
<td> Output. Delimited string is parsed to separate cells (columns).
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>This X-Function takes a cell or column of delimited values and parses them to new columns.
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p>This example imports an ASCII file containing categorical data, uses the <a class="external text" href="../../LabTalk/LabTalk/Catrows_(function).html"><b>catrows()$</b></a> function to obtain row indices for each category, then outputs those row indices to new columns. The resulting sheet <i>text2cols</i> lists row indices for each category.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// create an empty book and import the file automobile.dat into the new book</span>
newbook; string fname<span style="color: #000080;">$</span><span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Statistics\automobile.dat&quot;</span>;
impASC;
<span style="color: #008000;">// set column 2 as categorical and sort it in ascending order</span>
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">categorical</span>.<span style="color: #000080;">type</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>;
wks.<span style="color: #000080;">col2</span>.<span style="color: #000080;">categorical</span>.<span style="color: #000080;">sort</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
<span style="color: #008000;">// get column 2 into range variable rA</span>
range rA <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>automobile<span style="color: #000000;">&#93;</span>automobile<span style="color: #000080;">!</span><span style="color: #ff00ff;">&quot;Make&quot;</span>;
<span style="color: #008000;">// create a new book and use category function to copy categories in rA to column A of newbook</span>
<span style="color: #008000;">// to column B, add row indices of occurrence for each category, as a pipe-separated list </span>
newbook;
col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>category<span style="color: #000000;">&#40;</span>rA<span style="color: #000000;">&#41;</span><span style="color: #000080;">$</span>;
col<span style="color: #000000;">&#40;</span>B<span style="color: #000000;">&#41;</span><span style="color: #000080;">=</span>catrows<span style="color: #000000;">&#40;</span>rA<span style="color: #000000;">&#41;</span><span style="color: #000080;">$</span>;
<span style="color: #008000;">// taking pipe-separated strings in [Book2]Sheet1!B as input, output values to new sheet in &lt;input&gt;.</span>
text2cols ix<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>Book2<span style="color: #000000;">&#93;</span>Sheet1<span style="color: #000080;">!</span>B delimiter<span style="color: #000000;">:</span><span style="color: #000080;">=</span>pipe nosplit<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> other<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span>Book2<span style="color: #000000;">&#93;</span>Sheet1<span style="color: #000080;">!</span>A;</pre>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>string processing, category, catindex, catrows</span></p>






