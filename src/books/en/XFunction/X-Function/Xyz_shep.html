<h1 class="firstHeading">2.2.1.8 xyz_shep</h1><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Brief_Information"><span class="tocnumber">1</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Command_Line_Usage"><span class="tocnumber">2</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#X-Function_Execution_Options"><span class="tocnumber">3</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Variables"><span class="tocnumber">4</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Description"><span class="tocnumber">5</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Examples"><span class="tocnumber">6</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Algorithm"><span class="tocnumber">7</span> <span class="toctext">Algorithm</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#References"><span class="tocnumber">8</span> <span class="toctext">References</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Related_X-Functions"><span class="tocnumber">9</span> <span class="toctext">Related X-Functions</span></a></li>
</ul>
</div>

<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Convert XYZ data to matrix using Shepard gridding
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
1. xyz_shep iz:=Col(3);
</p><p>2. xyz_shep iz:=Col(3) rows:=10 cols:=10;
</p><p>3. xyz_shep iz:=Col(3) q:=13 w:=19;
</p><p>4. xyz_shep iz:=Col(3) om:=[MBook]MSheet!Mat(1);
</code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Input
</td>
<td>iz
</td>
<td>
<p>Input
</p><p>XYZRange
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td>
<p>Specifies the input XYZ range.
</p>
</td></tr>
<tr>
<td>Rows
</td>
<td>rows
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>20</center>
</td>
<td>
<p>Rows in the output matrix.
</p>
</td></tr>
<tr>
<td>Columns
</td>
<td>cols
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>20</center>
</td>
<td>
<p>Columns in the output matrix.
</p>
</td></tr>
<tr>
<td>Quadratic
</td>
<td>q
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>13</center>
</td>
<td>
<p>The quadratic interplant locality factor, which is used to calculate the influence radius of local approximate quadratic fitted function for each node. By default, q equals to 13. Modifying these factors could increase gridding accuracy, though note that the computation time can be greatly increased for large values (i.e. values that decrease the locality of the method.)
</p>
</td></tr>
<tr>
<td>Weight
</td>
<td>w
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>19</center>
</td>
<td>
<p>The weight function locality factor, which is used to calculate the weighting radius for each node. By default, w equals to 19. Modifying these factors could increase gridding accuracy, though note that the computation time can be greatly increased for large values (i.e. values that decrease the locality of the method.)
</p>
</td></tr>
<tr>
<td>Output Matrix
</td>
<td>om
</td>
<td>
<p>Output
</p><p>MatrixObject
</p>
</td>
<td> <center>&lt;new&gt;</center>
</td>
<td>
<p>Specify the output matrix object.
</p><p>See the syntax <a class="external text" href="../../XFunction/X-Function/Output_Notations.html">here</a>.
</p>
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>This function performs modified Shepard gridding method which described by Renka<sup>[1]</sup>. This is a distance-based method and improves the Shepard's method by some local strategies. During gridding, only the data points that lying within certain ranges, <img src="../images/Xyz_shep/math-506f857fb8933b36a7562355ad11e1d1.png?v=0" title="R_q" alt="R_q" class="tex"/> and <img src="../images/Xyz_shep/math-3e54a02dbea9158ae1a97b8bed4c4a1a.png?v=0" title="R_w" alt="R_w" class="tex"/>, to the grid nodes are considered. To make it easier for setting, two integers, <img src="../images/Xyz_shep/math-a7ff05f950658cbc36712bd63bb9151a.png?v=0" title="N_q" alt="N_q" class="tex"/> and <img src="../images/Xyz_shep/math-8e1051771a00db4e26742cde057266dd.png?v=0" title="N_w" alt="N_w" class="tex"/> are used to calculate <img src="../images/Xyz_shep/math-506f857fb8933b36a7562355ad11e1d1.png?v=0" title="R_q" alt="R_q" class="tex"/> and <img src="../images/Xyz_shep/math-3e54a02dbea9158ae1a97b8bed4c4a1a.png?v=0" title="R_w" alt="R_w" class="tex"/> (parameters <i>q</i> and <i>w</i> of the function, and called <i>Quadratic Interplant Locality Factor</i> and <i>Weight Function Locality Factor</i>, respectively). Increase the value of <img src="../images/Xyz_shep/math-a7ff05f950658cbc36712bd63bb9151a.png?v=0" title="N_q" alt="N_q" class="tex"/> and <img src="../images/Xyz_shep/math-8e1051771a00db4e26742cde057266dd.png?v=0" title="N_w" alt="N_w" class="tex"/> will make the calculation more global, vice versa. Generally speaking, setting <img src="../images/Xyz_shep/math-a7ff05f950658cbc36712bd63bb9151a.png?v=0" title="N_q" alt="N_q" class="tex"/> and <img src="../images/Xyz_shep/math-8e1051771a00db4e26742cde057266dd.png?v=0" title="N_w" alt="N_w" class="tex"/> works quite well.
</p><p>The value of <img src="../images/Xyz_shep/math-506f857fb8933b36a7562355ad11e1d1.png?v=0" title="R_q" alt="R_q" class="tex"/> and <img src="../images/Xyz_shep/math-3e54a02dbea9158ae1a97b8bed4c4a1a.png?v=0" title="R_w" alt="R_w" class="tex"/> in this function is varied for each node. There is another similar X-Function <i>xyz_shep_nag</i> which described by Franke and Nielson<sup>[2]</sup> uses a fixed <img src="../images/Xyz_shep/math-506f857fb8933b36a7562355ad11e1d1.png?v=0" title="R_q" alt="R_q" class="tex"/> and <img src="../images/Xyz_shep/math-3e54a02dbea9158ae1a97b8bed4c4a1a.png?v=0" title="R_w" alt="R_w" class="tex"/> calculation.
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<ul><li> To run from Command window</li></ul>
<ol><li> Import <i>XYZ Random Gaussian.dat</i> on the \S<i>amples</i>\<i>Matrix Conversion and Gridding</i> folder.</li>
<li> Type <code>xyz_shep 3</code> in the command window. Or type <code>xyz_shep -d</code> to bring up the dialog.</li></ol>
<ul><li> Code Sample</li></ul>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000; font-style: regular;">/*
This example shows how convert random worksheet data into matrix by Shepard gridding method.
The sample data is exe_path\Samples\Matrix Conversion and Gridding\XYZ Random Gaussian.dat
1. Load data to a new created workbook.
2. Random xyz gridding by Shepard method.
3. Plot a contour graph.
*/</span>
<span style="color: #008000;">// Get sample data</span>
fn<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Matrix Conversion and Gridding\XYZ Random Gaussian.dat&quot;</span>;
newbook;
impASC fn<span style="color: #000080;">$</span>;
<span style="color: #008000;">// Set the third column as Z column</span>
wks.<span style="color: #000080;">col3</span>.<span style="color: #000080;">type</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">6</span>;

<span style="color: #008000;">// Convert worksheet data into matrix by Shepard gridding method</span>
xyz_shep <span style="color: #0000dd;">3</span>;

<span style="color: #008000;">// Plot </span>
worksheet <span style="color: #000080;">-</span>p <span style="color: #0000dd;">226</span> contour;</pre>
<h2><a name="Algorithm"></a><span class="mw-headline">Algorithm</span></h2>
<p>This is a distance-based weighted gridding method which interpolate data by:
</p><p><a  class="image"><img alt="Xyz shep help English files image002.gif" src="../images/Xyz_shep/Xyz_shep_help_English_files_image002.gif?v=590" width="155"  /></a>,
</p><p>where <img src="../images/Xyz_shep/math-65d8a7a479560f4cef7438864cbfd20e.png?v=0" title="F_i" alt="F_i" class="tex"/> is the underlying function at nodes (<img src="../images/Xyz_shep/math-1ba8aaab47179b3d3e24b0ccea9f4e30.png?v=0" title="x_i" alt="x_i" class="tex"/>, <img src="../images/Xyz_shep/math-8d62e469fb30ed435a668eb5c035b1f6.png?v=0" title="y_i" alt="y_i" class="tex"/>), and <img src="../images/Xyz_shep/math-540bdf656419f2a308d7ad1571c664a0.png?v=0" title="W_i" alt="W_i" class="tex"/>(<i>x</i>, <i>y</i>) is the weights. To make the function more local, <img src="../images/Xyz_shep/math-65d8a7a479560f4cef7438864cbfd20e.png?v=0" title="F_i" alt="F_i" class="tex"/> and <img src="../images/Xyz_shep/math-540bdf656419f2a308d7ad1571c664a0.png?v=0" title="W_i" alt="W_i" class="tex"/> are calculated only by the data points lying in the circle with center (<img src="../images/Xyz_shep/math-1ba8aaab47179b3d3e24b0ccea9f4e30.png?v=0" title="x_i" alt="x_i" class="tex"/>, <img src="../images/Xyz_shep/math-8d62e469fb30ed435a668eb5c035b1f6.png?v=0" title="y_i" alt="y_i" class="tex"/>) and some radius <i>R</i>..
</p><p>Firstly, the weights are defined as:
</p><p><a  class="image"><img alt="Xyz shep help English files image004.gif" src="../images/Xyz_shep/Xyz_shep_help_English_files_image004.gif?v=591" width="151"  /></a>.
</p><p>Given a radius (<img src="../images/Xyz_shep/math-3e54a02dbea9158ae1a97b8bed4c4a1a.png?v=0" title="R_w" alt="R_w" class="tex"/>, the relative weight (<img src="../images/Xyz_shep/math-0df9cc6763484db7df8a7418bff18a65.png?v=0" title="w_k" alt="w_k" class="tex"/> is:
</p><p><a  class="image"><img alt="Xyz shep help English files image006.gif" src="../images/Xyz_shep/Xyz_shep_help_English_files_image006.gif?v=592" width="128"  /></a> for
</p><p><a  class="image"><img alt="Xyz shep help English files image008.gif" src="../images/Xyz_shep/Xyz_shep_help_English_files_image008.gif?v=593" width="239"  /></a>,
</p><p>and (<img src="../images/Xyz_shep/math-7516b96678349ed002f1931a294f577c.png?v=0" title="d_k" alt="d_k" class="tex"/> is the Euclidean distance between (<i>x</i>, <i>y</i>) and (<img src="../images/Xyz_shep/math-83b08453f4197d78025b7af0f4b71186.png?v=0" title="x_k" alt="x_k" class="tex"/>, <img src="../images/Xyz_shep/math-250de32696532bcb35869b1d0f7813c9.png?v=0" title="y_k" alt="y_k" class="tex"/>):
</p><p><a  class="image"><img alt="Xyz shep help English files image010.gif" src="../images/Xyz_shep/Xyz_shep_help_English_files_image010.gif?v=594" width="148"  /></a>.
</p><p>For any (<img src="../images/Xyz_shep/math-3e54a02dbea9158ae1a97b8bed4c4a1a.png?v=0" title="R_w" alt="R_w" class="tex"/> &gt;0, we have:
</p><p><a  class="image"><img alt="Xyz shep help English files image012.gif" src="../images/Xyz_shep/Xyz_shep_help_English_files_image012.gif?v=595" width="184"  /></a>
</p><p><a  class="image"><img alt="Xyz shep help English files image014.gif" src="../images/Xyz_shep/Xyz_shep_help_English_files_image014.gif?v=596" width="100"  /></a>.
</p><p>Secondly, the nodal function (<img src="../images/Xyz_shep/math-65d8a7a479560f4cef7438864cbfd20e.png?v=0" title="F_i" alt="F_i" class="tex"/> is replaced by a local approximation function <img src="../images/Xyz_shep/math-246c34c550a7977ad4c582df9b57f0b6.png?v=0" title="Q_k" alt="Q_k" class="tex"/>:
</p><p><a  class="image"><img alt="Xyz shep help English files image016.gif" src="../images/Xyz_shep/Xyz_shep_help_English_files_image016.gif?v=597" width="360"  /></a>
</p><p>(<img src="../images/Xyz_shep/math-246c34c550a7977ad4c582df9b57f0b6.png?v=0" title="Q_k" alt="Q_k" class="tex"/> is the weighted least-square quadratic fitted function to the data located within (<img src="../images/Xyz_shep/math-506f857fb8933b36a7562355ad11e1d1.png?v=0" title="R_q" alt="R_q" class="tex"/> of nodal points. So the coefficients minimize:
</p><p><a  class="image"><img alt="Xyz shep help English files image018.gif" src="../images/Xyz_shep/Xyz_shep_help_English_files_image018.gif?v=598" width="404"  /></a>
</p><p>for
</p><p><a  class="image"><img alt="Xyz shep help English files image020.gif" src="../images/Xyz_shep/Xyz_shep_help_English_files_image020.gif?v=599" width="357"  /></a>.
</p><p>It can be seen above that the interpolate function is a local approximation function and depends on the radius of influence about nodal points, (<img src="../images/Xyz_shep/math-506f857fb8933b36a7562355ad11e1d1.png?v=0" title="R_q" alt="R_q" class="tex"/> and (<img src="../images/Xyz_shep/math-3e54a02dbea9158ae1a97b8bed4c4a1a.png?v=0" title="R_w" alt="R_w" class="tex"/>. In this method, (<img src="../images/Xyz_shep/math-506f857fb8933b36a7562355ad11e1d1.png?v=0" title="R_q" alt="R_q" class="tex"/> and (<img src="../images/Xyz_shep/math-3e54a02dbea9158ae1a97b8bed4c4a1a.png?v=0" title="R_w" alt="R_w" class="tex"/> are varied for each nodal point to make the calculation more accurate. Given two integers (<img src="../images/Xyz_shep/math-a7ff05f950658cbc36712bd63bb9151a.png?v=0" title="N_q" alt="N_q" class="tex"/> and (<img src="../images/Xyz_shep/math-8e1051771a00db4e26742cde057266dd.png?v=0" title="N_w" alt="N_w" class="tex"/>, (<img src="../images/Xyz_shep/math-506f857fb8933b36a7562355ad11e1d1.png?v=0" title="R_q" alt="R_q" class="tex"/> and (<img src="../images/Xyz_shep/math-3e54a02dbea9158ae1a97b8bed4c4a1a.png?v=0" title="R_w" alt="R_w" class="tex"/> are chosen just large enough to include (<img src="../images/Xyz_shep/math-a7ff05f950658cbc36712bd63bb9151a.png?v=0" title="N_q" alt="N_q" class="tex"/> and (<img src="../images/Xyz_shep/math-8e1051771a00db4e26742cde057266dd.png?v=0" title="N_w" alt="N_w" class="tex"/> nodes.
</p>
<h2><a name="References"></a><span class="mw-headline">References</span></h2>
<p>[1].  Renka, R. J., <i>Multivariate Interpolation of Large Sets of Scattered Data</i>. ACM Transactions on Mathematical Software, Vol. 14, No. 2, June 1988, pp:139-148.
</p><p>[2].  Franke R and Nielson G. <i>smooth Interpolation of Large Sets of Scattered Data</i>. Internat. J.Num. Methods Engrg. 1980, 15 pp:1691-1704.
</p>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">Related X-Functions</span></h2>
<p><a href="../../XFunction/X-Function/Xyz_regular.html" title="X-Function:Xyz regular">xyz_regular</a>, <a href="../../XFunction/X-Function/Xyz_renka.html" title="X-Function:Xyz renka">xyz_renka</a>, <a href="../../XFunction/X-Function/Xyz_renka_nag.html" title="X-Function:Xyz renka nag">xyz_renka_nag</a>, <a href="../../XFunction/X-Function/Xyz_shep_nag.html" title="X-Function:Xyz shep nag">xyz_shep_nag</a>, <a href="../../XFunction/X-Function/Xyz_sparse.html" title="X-Function:Xyz sparse">xyz_sparse</a>, <a href="../../XFunction/X-Function/Xyz_tps.html" title="X-Function:Xyz tps">xyz_tps</a>
</p>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>worksheet</span></p>






