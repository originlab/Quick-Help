<h1 class="firstHeading">2.2.3.35 wcellfmt</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Brief_Information"><span class="tocnumber">1</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Additional_Information"><span class="tocnumber">2</span> <span class="toctext">Additional Information</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Command_Line_Usage"><span class="tocnumber">3</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#X-Function_Execution_Options"><span class="tocnumber">4</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Variables"><span class="tocnumber">5</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Description"><span class="tocnumber">6</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Examples"><span class="tocnumber">7</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Related_X-Functions"><span class="tocnumber">8</span> <span class="toctext">Related X-Functions</span></a></li>
</ul>
</div>

<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Get or set worksheet cell properties using a tree
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">Additional Information</span></h2>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
1. wcellFmt tr:=cfmt; cfmt.=;
</p><p>2. wcellFmt tr:=cfmt; cfmt.FillColor=2; cfmt.Size=18; wcellFmt execute:=1 tr:=cfmt;
</code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Input Range
</td>
<td>irng
</td>
<td>
<p>Input
</p><p>Range
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td>
<p>Specify the input range.
</p>
</td></tr>
<tr>
<td>Execute Mode
</td>
<td>execute
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>get</center>
</td>
<td>
<p>Get or set cell properties.
<br />
Option list
</p>
<ul><li><i>get:Get format tree</i>
<dl><dd>Get the cell properties.</dd></dl></li>
<li><i>set:Set format for modified nodes</i>
<dl><dd>Set format for modified nodes.</dd></dl></li>
<li><i>all:Set format for all nodes</i>
<dl><dd>Set format for all nodes.</dd></dl></li></ul>
</td></tr>
<tr>
<td>GUI Tree
</td>
<td>tr
</td>
<td>
<p>Input/Output
</p><p>TreeNode
</p>
</td>
<td> <center></center>
</td>
<td>
<p>The cell property tree.
</p>
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>This X-Function can be used to get the worksheet cell properties tree <b>tr</b> (execute:=0), or set the worksheet properties tree <b>tr</b> (execute:=1).
</p><p>See X-Function <b>wproperties</b>, the section on <a href="../../XFunction/X-Function/Wproperties.html#TextControl" title="X-Function:Wproperties"><b>TextControl</b></a>.
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<pre class="lt" style="font-family:monospace;">  <span style="color: #008000;">//set selected cells' Filled Color to green</span>
  Tree cfmt;
  wcellFmt tr<span style="color: #000000;">:</span><span style="color: #000080;">=</span>cfmt;<span style="color: #008000;">//default is to get</span>
  cfmt.<span style="color: #000080;">FillColor</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>;
  wcellFmt exec<span style="color: #000000;">:</span><span style="color: #000080;">=</span>set tr<span style="color: #000000;">:</span><span style="color: #000080;">=</span>cfmt;</pre>
<pre class="lt" style="font-family:monospace;">  <span style="color: #008000;">//set cell's Fill Color to green without pre-selecting  </span>
  Tree cfmt;
  wcellFmt <span style="color: #0000dd;">2</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">:</span><span style="color: #0000dd;">5</span><span style="color: #000000;">&#93;</span> get cfmt;
  cfmt.<span style="color: #000080;">FillColor</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>;
  wcellFmt <span style="color: #0000dd;">2</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">:</span><span style="color: #0000dd;">5</span><span style="color: #000000;">&#93;</span> set cfmt;</pre>
<pre class="lt" style="font-family:monospace;">  
  <span style="color: #008000;">//the following will dump the tree from selected cells</span>
  Tree cfmt;
  wcellFmt tr<span style="color: #000000;">:</span><span style="color: #000080;">=</span>cfmt;
  cfmt.<span style="color: #000080;">=</span>;</pre>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Imports three spectra and creates a 10-level heatmap of sorts for Y data in worksheet.</span>

<span style="color: #008000;">// Import three data files from Origins Samples Folder.</span>
newbook;
impASC fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;C:\Program Files\OriginLab\Origin2018\Samples\Batch Processing\T275K.csv
C:\Program Files\OriginLab\Origin2018\Samples\Batch Processing\T305K.csv
C:\Program Files\OriginLab\Origin2018\Samples\Batch Processing\T335K.csv&quot;</span> options.<span style="color: #000080;">ImpMode</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;

<span style="color: #008000;">// Delete extra X columns.</span>
for <span style="color: #000000;">&#40;</span>int ii <span style="color: #000080;">=</span> wks.<span style="color: #000080;">ncols</span> <span style="color: #000080;">-</span><span style="color: #0000dd;">1</span>; ii <span style="color: #000080;">&gt;</span> <span style="color: #0000dd;">2</span>; ii <span style="color: #000080;">-</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span>
	delete wcol<span style="color: #000000;">&#40;</span>ii<span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Create a StringArray of 10 hex colors.</span>
string strColors<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;#A000C8|#6E00DC|#1E3CFF|#00A0FF|#00C8C8|#00DC00|#E6DC32|#E6AF2D|#FA3C3C|#F00082&quot;</span>;
StringArray sa;
sa.<span style="color: #000080;">Append</span><span style="color: #000000;">&#40;</span>strColors<span style="color: #000080;">$</span>, <span style="color: #000080;">|</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Get the cell format for col 1, row 1 into a Tree variable.</span>
Tree trFmt;
wcellFmt irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span> exec<span style="color: #000000;">:</span><span style="color: #000080;">=</span>get tr<span style="color: #000000;">:</span><span style="color: #000080;">=</span>trFmt;

<span style="color: #008000;">// Preserve original font size from format Tree.</span>
double dFontSize <span style="color: #000080;">=</span> trFmt.<span style="color: #000080;">Size</span>;

<span style="color: #008000;">// Get min and max values for all values Y columns.</span>
stats ix<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">:</span>end<span style="color: #000000;">&#41;</span>;
double dMin <span style="color: #000080;">=</span> stats.<span style="color: #000080;">min</span>;
double dMax <span style="color: #000080;">=</span> stats.<span style="color: #000080;">max</span>;

<span style="color: #008000;">// Loop through every Y column.</span>
int nCols <span style="color: #000080;">=</span> wks.<span style="color: #000080;">ncols</span>;
for <span style="color: #000000;">&#40;</span>int ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>; ii <span style="color: #000080;">&lt;=</span> nCols; ii<span style="color: #000080;">++</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	<span style="color: #008000;">// Get a range to current column and skip if column is empty.</span>
	range rng <span style="color: #000080;">=</span> wcol<span style="color: #000000;">&#40;</span>ii<span style="color: #000000;">&#41;</span>;
	if <span style="color: #000000;">&#40;</span><span style="color: #000080;">!</span>rng.<span style="color: #000080;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>
		continue;

	<span style="color: #008000;">// Create a temporary dataset of values in current column</span>
	<span style="color: #008000;">// normalized (1-10) based on min and max values of all cells in sheet.</span>
	dataset ds <span style="color: #000080;">=</span> round<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span> <span style="color: #000080;">+</span> <span style="color: #000000;">&#40;</span>rng <span style="color: #000080;">-</span> dMin<span style="color: #000000;">&#41;</span> <span style="color: #000080;">*</span> <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">10</span> <span style="color: #000080;">-</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">/</span> <span style="color: #000000;">&#40;</span>dMax <span style="color: #000080;">-</span> dMin<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;

	<span style="color: #008000;">// Loop through every row in current column.</span>
	int nSize <span style="color: #000080;">=</span> ds.<span style="color: #000080;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	for<span style="color: #000000;">&#40;</span>jj <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; jj <span style="color: #000080;">&lt;=</span> nSize; jj<span style="color: #000080;">++</span><span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		<span style="color: #008000;">// Apply modified font size to format Tree based</span>
		<span style="color: #008000;">// on normalized cell value.</span>
		trFmt.<span style="color: #000080;">Size</span> <span style="color: #000080;">=</span> dFontSize <span style="color: #000080;">+</span> ds<span style="color: #000000;">&#91;</span>jj<span style="color: #000000;">&#93;</span>;

		<span style="color: #008000;">// Apply Hex background color to format Tree based</span>
		<span style="color: #008000;">// on normalized cell value.</span>
		string str<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> sa.<span style="color: #000080;">GetAt</span><span style="color: #000000;">&#40;</span>ds<span style="color: #000000;">&#91;</span>jj<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">$</span>;
		trFmt.<span style="color: #000080;">FillColor</span> <span style="color: #000080;">=</span> color<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;%(str$)&quot;</span><span style="color: #000000;">&#41;</span>;

		<span style="color: #008000;">// Apply format Tree to the cell.</span>
		wcellFmt irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span>rng<span style="color: #000000;">&#91;</span>jj<span style="color: #000000;">&#93;</span> exec<span style="color: #000000;">:</span><span style="color: #000080;">=</span>set tr<span style="color: #000000;">:</span><span style="color: #000080;">=</span>trFmt;
	<span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span>
<span style="color: #008000;">//Resize worksheet based on col and row size.</span>
wautosize hw<span style="color: #000000;">:</span><span style="color: #000080;">=</span>b;</pre>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">Related X-Functions</span></h2>






