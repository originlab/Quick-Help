<h1 class="firstHeading">1.2.1 Putting an X-Function in the Product Menu</h1><p><span class="OIndex" style="display:none">X-Function, Add to Origin Menu</span>
</p><p>Putting an X-Function into the Origin menu involves the following two steps:
</p>
<ul><li> Modifying basic settings in the X-Function Builder Tree View</li>
<li> Putting the X-Function into the specified main menu and sub menu</li></ul>
<p>Then, in the menu, choose <b>Preference: Menu: Full Menus</b>, or restart Origin to auto-scan the changes for all X-Functions and add the newly added X-Function to the menu. Please refer to X-Function Builder's documentation for more details.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Setup_in_Tree_View"><span class="tocnumber">1</span> <span class="toctext">Setup in Tree View</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Menu_Accessible"><span class="tocnumber">2</span> <span class="toctext">Menu Accessible</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Default_Menu"><span class="tocnumber">2.1</span> <span class="toctext">Default Menu</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#User_Defined_Menu"><span class="tocnumber">2.2</span> <span class="toctext">User Defined Menu</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="Setup_in_Tree_View"></a><span class="mw-headline">Setup in Tree View</span></h2>
<p>To make your X-Function show properly in the menu, the following settings in X-Function Builder are required:
</p>
<ol><li> Open the X-Function in X-Function Builder.</li>
<li> Switch to Tree View mode, in the Usage Context branch.
<ul><li> Choose <b>Main Menus</b> for Menus.</li>
<li> Check the <b>Windows</b> check box.</li>
<li> Check one or several window types: Worksheet, Graph, or Matrix.</li></ul></li></ol>
<h2><a name="Menu_Accessible"></a><span class="mw-headline">Menu Accessible</span></h2>
<p>Once the X-Function is set up in Tree View, you can put the X-Function into the specified menu. Origin enables the user's X-Function to be accessible from the two kinds of menus:
</p>
<ul><li> Default menu</li></ul>
<p>(This mechanism has a few limitations: you need to put the X-Function into the specified file folder, and the X-Function name needs to follow the specified prefix.  Also, it is not easy to control its location in the menu. The next mechanism, a user defined menu, will solve all these problems.)
</p>
<ul><li> User defined menu</li></ul>
<h3><a name="Default_Menu"></a><span class="mw-headline">Default Menu</span></h3>
<p>X-Functions are accessible from a specified default menu if they are saved in the proper sub-folder of the <b>X-Functions</b> folder under the User folder.
</p>
<ul><li> All X-Functions in the subfolders below will be shown in the menu.</li></ul>
<table class="simple">
<tr>
<th> Folder
</th>
<th> Menu
</th></tr>
<tr>
<td> Signal Processing\
</td>
<td> <b>Analysis: Signal Processing</b>
</td></tr>
<tr>
<td>Spectroscopy\
</td>
<td><b>Analysis: Spectroscopy</b>
</td></tr>
<tr>
<td>Mathematics\
</td>
<td><b>Analysis: Mathematics</b>
</td></tr>
<tr>
<td>Statistics\
</td>
<td><b>Statistics</b>
</td></tr></table>
<ul><li> All X-Functions with the specified prefix in the subfolders below will be shown in the menu.</li></ul>
<table class="simple">
<tr>
<th> Folder
</th>
<th> Prefix
</th>
<th> Menu
</th></tr>
<tr>
<td rowspan="2">Import and Export\
</td>
<td>imp*
</td>
<td> <b>File: Import</b>
</td></tr>
<tr>
<td> exp*
</td>
<td><b>File: Export</b>
</td></tr>
<tr>
<td rowspan="2">Data Manipulation\
</td>
<td>w*
</td>
<td><b>Worksheet</b>
</td></tr>
<tr>
<td>col*
</td>
<td><b>Column</b>
</td></tr>
<tr>
<td>Database Access\
</td>
<td>db*
</td>
<td><b>File: Database Access</b>
</td></tr></table>
<ul><li> The X-Functions in the Miscellaneous, Data Exploration, and Utilities folders will never be shown in the menu, except if the user directly modifies the XML file, the process for which will be described in the next section.</li></ul>
<h3><a name="User_Defined_Menu"></a><span class="mw-headline">User Defined Menu</span></h3>
<p>In addition to adding X-Functions to default menus, the user is able to put X-Functions into user-defined menus by editing the XML files under the OriginExePath\Themes\Menus folder. There are two XML files under this folder: ConfMenus.xml is used to control the Origin main menu, and ContextMenus.xml is for the context menu.
</p><p><i><b><u>Example</u></b></i>
</p><p>The following is a complete example that shows how to add a user-defined X function to a new sub menu, <b>OC Guide Tools</b>, under Origin's <b>Analysis</b> main menu. The user-defined menu is the mid in <b>Analysis:Fitting</b> and <b>Analysis:Signal Processing</b>.
</p>
<ol>
<li>Create a folder <b>OC Guide</b> under the path <i>&lt;User Files Folder&gt;\X-Functions\</i>.</li>
<li>Create a user-defined X function following <a href="../../XFunction/X-Function/Creating_a_Simple_X-Function.html" title="X-Function:Creating a Simple X-Function">this example</a>, but name it as <b>MyAnalysis</b> and make sure it is saved under the path <i>&lt;User Files Folder&gt;\X-Functions\OC Guide\</i>.</li>
<li>Open the <b>MyAnalysis</b> X-Function in X-Function Builder. Switch to Tree View, in the Usage Context branch, set Menus as Main Menus, check the Windows check box, and check the Worksheet check box under the Windows branch.</li>
<li>Type some text into the Description edit box, for example, "&amp;Custom Dialog". &amp; is used to access the quick selection menu with the keyboard. Click Save to save changes to the X-Function and close X-Function Builder.</li>
<li>Open <b>ConfMenus.xml</b> in an XML editor, for example, <a class="external text" href="http://symbolclick.com/index.htm" target="_blank">XML Marker</a>.</li>
<li>Choose <b>wks -&gt; wksAnalysis -&gt; wfit</b> in the left panel.</li>
<li> Copy the following and paste it into the right panel after &lt;wfit...&gt;&lt;/wfit&gt;, then click Save.
<pre>
&lt;testmenu1 Label = &quot;OC Guide Tools&quot; popup = &quot;1&quot;&gt;
        &lt;efg Label = &quot;&quot;&gt;
            &lt;name&gt;*&lt;/name&gt;
            &lt;auxopts&gt;2162688.&lt;/auxopts&gt;
            &lt;catsubcat DataID = &quot;74&quot;&gt;OC Guide&lt;/catsubcat&gt;
        &lt;/efg&gt;
&lt;/testmenu1&gt;
</pre>
</li>
<li>Close Origin and restart. Activate a worksheet and, in the menu, choose Analysis.  Menu Test:Custom Dialog will display.<div><a  class="image"><img alt="Ocguide xf put to menu.png" src="../images/Putting_an_X-Function_in_the_Product_Menu/Ocguide_xf_put_to_menu.png?v=77123" width="320"  /></a></div>
</li>
</ol>






