<h1 class="firstHeading">2.2.4.1 wpivot</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">Menu Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Additional_Information"><span class="tocnumber">3</span> <span class="toctext">Additional Information</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Command_Line_Usage"><span class="tocnumber">4</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#X-Function_Execution_Options"><span class="tocnumber">5</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Variables"><span class="tocnumber">6</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Description"><span class="tocnumber">7</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Examples"><span class="tocnumber">8</span> <span class="toctext">Examples</span></a></li>
</ul>
</div>

<h2><a name="Menu_Information"></a><span class="mw-headline">Menu Information</span></h2>
<p>Restructure: Pivot Table
</p>
<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Create pivot table to summarize worksheet data
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">Additional Information</span></h2>
<p class="version" >Minimum Origin Version Required: Origin 2015 SR0 </p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
wpivot row:=col(4) col:=col(6) data:=col(11) method:=sum total:=1 sort_total:=descend sum:=1;
</p><p>wpivot row:=(col(4):col(5)) col:=col(8) data:=col(9) method:=sum total:=1 sort_total:=no sum:=1 sort_col:=des;
</p><p>wpivot row:=(col(4),col(6)) col:=col(8) method:=count dir:=col vmode:=limitValTotal threshold:=3;
</code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Pivot Table Row Source
</td>
<td>row
</td>
<td>
<p>Input
</p><p>Range
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> Specify the range that will be used as the row source of the Pivot Table. Every distinct value of the selected range will correspond to a row in the pivot table. For example, if the table row source contains 5 cells and the values are "East", "South", "West", "South" and "East", there will be 3 rows in the pivot table. To do this analysis, you must active or specify at least 1 column for the row source.
<p>There are three popular options:
</p>
<ul><li> col(1)
<dl><dd> select column 1 as row source</dd></dl></li>
<li> (col(1):col(3))
<dl><dd> select from column 1 up to column 3 three columns as row source</dd></dl></li>
<li> (col(1), col(3))
<dl><dd> select column 1 and column 3 two columns as row source</dd></dl></li></ul>
</td></tr>
<tr>
<td>Pivot Table Column Source
</td>
<td>col
</td>
<td>
<p>Input
</p><p>Range
</p>
</td>
<td> <center></center>
</td>
<td> Specify the range that will be used as the column source of the Pivot Table. Every distinct value of the selected range will correspond to a column in the pivot table. To do this analysis, you must specify at least 1 column for the column source. Options syntax follows Pivot Table Row Source.
</td></tr>
<tr>
<td>Pivot Table Data Source
</td>
<td>data
</td>
<td>
<p>Input
</p><p>Range
</p>
</td>
<td> <center></center>
</td>
<td> This is available only when <b>Count</b> is <b>not</b> selected for <b>Summarize by</b> (the Method variable). It provides the data values to be summarized.
</td></tr>
<tr>
<td>Summarize by
</td>
<td>method
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify the way to summarize the data.
<p>Option list:
</p>
<ul><li><i>count:Count</i> {0}
<dl><dd>Output the count of each Row/Column pair. </dd></dl></li></ul>
<dl><dd></dd></dl>
<ul><li><i>sum:Sum</i> {1}
<dl><dd>Output the sum of each Row/Column pair. </dd></dl></li></ul>
<dl><dd></dd></dl>
<ul><li><i>mean:Mean</i> {2}
<dl><dd>Output the mean of each Row/Column pair.</dd></dl></li>
<li><i>min:Min</i> {3}
<dl><dd>Output the minimum value of each Row/Column pair.</dd></dl></li>
<li><i>max:Max</i> {4}
<dl><dd>Output the maximum value of each Row/Column pair. </dd></dl></li></ul>
<dl><dd></dd></dl>
</td></tr>
<tr>
<td>Combine Direction
</td>
<td>dir
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> This variable defines whether to combine the count/sum/mean/min/max for smaller values into an "others" column/row.
<p><br />
Option list:
</p>
<ul><li><i>none:None</i> {0}
<dl><dd>Do not combine any values</dd></dl></li>
<li><i>col:Column</i> {1}
<dl><dd>Combine the columns for the smaller values. </dd></dl></li>
<li><i>row:Row</i> {2}
<dl><dd>Combine the rows for the smaller values. </dd></dl></li></ul>
<dl><dd></dd></dl>
</td></tr>
<tr>
<td>Mode
</td>
<td>vmode
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify the mode for qualifying smaller values. This option applies only when <i>dir</i> is set to Column (1) or Row (2).
<p><br />
Option list:
</p>
<ul><li><i>perTotal:By Percent of Grand Total{0}</i>
<dl><dd>Merge columns/rows whose Total value is less than <i>threshold</i> percent of the Grand Total. </dd></dl></li></ul>
<dl><dd></dd></dl>
<ul><li><i>perRefRow:By Percent of Reference Row/Col{1}</i>
<dl><dd>Merge columns/rows whose value is less than <i>threshold</i> percent of the Total of the reference row/column (<i>refrow</i>).</dd></dl></li></ul>
<dl><dd></dd></dl>
<ul><li><i>limitValTotal:Top n of Grand Total{2}</i>
<dl><dd>Merge columns/rows whose Total values are <b>not</b> among the top N values. That is, show top N values and merge all others.</dd></dl></li></ul>
<dl><dd></dd></dl>
<ul><li><i>limitValRefRow:Top n of Reference Row/Col{3}</i>
<dl><dd>Merge columns/rows whose values in the reference row/column are <b>not</b> among the top N. </dd></dl></li></ul>
<dl><dd></dd></dl>
</td></tr>
<tr>
<td>Reference Row/Col
</td>
<td>refrow
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td> Specify the reference row/column when either <b>By Percent of Reference Row/Column</b> or <b>Top N of Reference Row/Column</b> is selected for Mode.
</td></tr>
<tr>
<td>Threshold
</td>
<td>threshold
</td>
<td>
<p>Input
</p><p>double
</p>
</td>
<td> <center></center>
</td>
<td> Specify the percent or number for merging smaller values when either <b>By Percent of Grand Total</b> or <b>By Percent of Reference Row/Column</b> is selected for Mode
</td></tr>
<tr>
<td>Value Label
</td>
<td>label
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>Others</center>
</td>
<td> Specify the label for the column/row which is formed by merging the smaller value columns/rows.
</td></tr>
<tr>
<td>Totals for Rows
</td>
<td>total
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify whether to add a <b>Row Total</b> column. Each cell in this column contains the sum of the data in the same row.
</td></tr>
<tr>
<td>Sort Output Rows
</td>
<td>sort_total
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> Specify the method used to sort the rows in the pivot table.
<p>Option list:
</p>
<ul><li><i>no:Row Labels Ascending{0}</i>
<dl><dd>Sort the rows according to the Row Labels in ascending order. </dd></dl></li></ul>
<dl><dd></dd></dl>
<ul><li><i>descend:Descending by Row Totals{1}</i>
<dl><dd>Sort Row Totals in descending order. </dd></dl></li></ul>
<dl><dd></dd></dl>
<ul><li><i>ascend:Ascending by Row Totals{2}</i>
<dl><dd>Sort Row Totals in ascending order. </dd></dl></li></ul>
<dl><dd></dd></dl>
<ul><li><i>ldescend:Row Labels Descending{3}</i>
<dl><dd>Sort the rows according to the Row Labels in descending order. </dd></dl></li></ul>
<dl><dd></dd></dl>
<ul><li><i>none:None{4}</i>
<dl><dd>Do not sort the rows. </dd></dl></li></ul>
</td></tr>
<tr>
<td>Totals for Columns
</td>
<td>sum
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify whether to add a <b>Column Total</b> row. Each cell in this row contains the sum of the data in the same column.
</td></tr>
<tr>
<td>Sort Output Columns
</td>
<td>sort_col
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify the method used to sort the columns in the pivot table.
<p>Option list:
</p>
<ul><li><i>lasc:Column Labels Ascending{0}</i>
<dl><dd>Sort the columns according to the Column Labels in ascending order. </dd></dl></li></ul>
<dl><dd></dd></dl>
<ul><li><i>ldes:Column Labels Descending{1}</i>
<dl><dd>Sort the columns according to the Column Labels in descending order. </dd></dl></li>
<li><i>asc:Ascending by Column Totals{2}</i>
<dl><dd>Sort <b>Column Totals</b> in ascending order. </dd></dl></li></ul>
<dl><dd></dd></dl>
<ul><li><i>des:Descending by Column Totals{3}</i>
<dl><dd>Sort <b>Column Totals</b> in descending order. </dd></dl></li></ul>
<dl><dd></dd></dl>
<ul><li><i>no:None{4}</i>
<dl><dd>Do not sort the columns.</dd></dl></li></ul>
</td></tr>
<tr>
<td>Normalize by Column Totals
</td>
<td>normalize
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify whether to normalize the output data by the <b>Column Totals</b>.
<p>Option list:
</p>
<ul><li><i>no:None{0}</i>
<dl><dd>Do not normalize the data.</dd></dl></li>
<li><i>frac:Fraction{1}</i>
<dl><dd>Normalize the data in each column by the column total and show them in fraction notation. </dd></dl></li></ul>
<dl><dd></dd></dl>
<ul><li><i>perc:Percent{2}</i>
<dl><dd>Normalize the data in each column by the column total and show them in percent notation. </dd></dl></li></ul>
<dl><dd></dd></dl>
</td></tr>
<tr>
<td>Show Zeros when Empty
</td>
<td>zero
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> Specify whether to show missing values in the pivot table as zeros.
</td></tr>
<tr>
<td>Row Source Extra Values
</td>
<td>exrow
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td>' character. This is useful when you must have a standard report, but your data does not include some values.
</td></tr>
<tr>
<td>Column Source Extra Values
</td>
<td>excol
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td>' character. This is useful when you must have a standard report, but your data does not include some values.
</td></tr>
<tr>
<td>Put Column Info. to
</td>
<td>pos
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> Specify where to output column source info in Pivot Table.
<p>Options List
</p>
<ul><li><i>name:Long Name{0}</i>
<dl><dd>Output source info into Long Name row.</dd></dl></li>
<li><i>comments:Comments{1}</i>
<dl><dd> Output source info into Comments row.</dd></dl></li>
<li><i>append:Append to Column's Long Name{2}</i>
<dl><dd> Append source info to current Column's Long Name. </dd></dl></li>
<li><i>udl:User Defined Parameters{3}</i>
<dl><dd> Output source info into User Defined Parameters row. By selecting this item, you can specify the identity in the following drop list to substitute the characters of "User Defined Parameters" displayed in <b>Column Label Rows</b>.</dd></dl></li></ul>
</td></tr>
<tr>
<td>From Column
</td>
<td>udlabel
</td>
<td>
<p>Input 
</p><p>string
</p>
</td>
<td>&lt;unassigned&gt;
</td>
<td>
<p>Specify the identifier of the pivot table column label row. Available only when pos:=3 or udl.
Option list:
</p>
<ul><li><i>G:Short Name</i></li>
<li><i>L:Long Name</i></li>
<li><i>C:Comments</i></li>
<li><i>U:Units</i></li>
<li><i>&lt;custom&gt;</i></li></ul>
<p>&lt;custom&gt; corresponds to the name of user defined parameters.
</p>
</td></tr>

<tr>
<td>Output Result Table to
</td>
<td>rd
</td>
<td>
<p>Output
</p><p>ReportData
</p>
</td>
<td> <center>[&lt;input&gt;]&lt;new&gt;</center>
</td>
<td>Specify where to output result table.
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>This X-Function allows you to specify two or more columns to create a pivot table to visualize data summarization by a number of options including statistics of a third column.
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p>About the detail examples, please refer to the <a class="external text" href="../../Tutorial/Tutorial/Pivot_Table.html">Pivot Table tutorial</a> page.
</p>





