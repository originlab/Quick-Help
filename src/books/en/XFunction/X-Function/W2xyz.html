<h1 class="firstHeading">2.2.3.30 w2xyz</h1><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">Menu Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Additional_Information"><span class="tocnumber">3</span> <span class="toctext">Additional Information</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Command_Line_Usage"><span class="tocnumber">4</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#X-Function_Execution_Options"><span class="tocnumber">5</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Variables"><span class="tocnumber">6</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Description"><span class="tocnumber">7</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Examples"><span class="tocnumber">8</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Related_X-Functions"><span class="tocnumber">9</span> <span class="toctext">Related X-Functions</span></a></li>
</ul>
</div>

<h2><a name="Menu_Information"></a><span class="mw-headline">Menu Information</span></h2>
<p>Worksheet: Convert to XYZ
</p>
<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Convert worksheet data to XYZ format
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">Additional Information</span></h2>
<p><b>Minimum Origin Version Required</b>: 8.0 SR3, updated in 8.5.1 SR0
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
1. w2xyz iw:=[book1]sheet1! format:=xcol xlabel:=row1 ycol:=1;
</p><p>2. w2xyz format:=xcol xlabel:=param param:=P ycol:=1;
</p><p>3. w2xyz -r 2 range:=rng format:=ycol ylabel:=sel1 xcol:=sel1 trim:=1;
</code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Convert Range
</td>
<td>range
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Convert Range
<p>Option list:
</p>
<ul><li> <i>wks:Entire Worksheet</i> 
<dl><dd> 0 = Select the entire worksheet.</dd></dl></li>
<li> <i>rng:Specified Ranges</i>
<dl><dd> 1 = Use the specified range.</dd></dl></li></ul>
</td></tr>
<tr>
<td>Input Worksheet
</td>
<td>iw
</td>
<td>
<p>Input
</p><p>Worksheet
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> Specify the input worksheet that has the data to be converted.
</td></tr>
<tr>
<td>Input
</td>
<td>irng
</td>
<td>
<p>Input
</p><p>Range
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> Specify the input range to be converted.
</td></tr>
<tr>
<td>Data Format
</td>
<td>format
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>2</center>
</td>
<td> Specify the format of the source data.
<p>Option list:
</p>
<ul><li><i>xcol:X across columns</i>
<dl><dd>The X values are across columns.</dd></dl></li>
<li><i>ycol:Y across columns</i>
<dl><dd>The Y values are across columns.</dd></dl></li>
<li><i>noxy:No  X and Y</i>
<dl><dd>There is no X or Y values in the worksheet. The indices of columns and rows will be the output for X and Y values respectively. </dd></dl></li></ul>
</td></tr>
<tr>
<td>X Values in
</td>
<td>xlabel
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify where the X values are. It is available when the Data Format is X across columns.
<p>Option list:
</p>
<ul><li><i>none:None</i>
<dl><dd>There are no X values in the worksheet. The indices of columns will be the X values.</dd></dl></li>
<li><i>row1:First Data Row</i>
<dl><dd>The data in the first row will be the X values.</dd></dl></li>
<li><i>param:Column Label</i>
<dl><dd>Use the column label row to specify the X values. </dd></dl></li>
<li> <i>sel1:First Data Row in Selection</i>
<dl><dd>Use the data row to specify the X values. Convert Range must be <i>Specified Ranges</i> <i>and</i> Data Format is <i>X across columns</i> or <i>Y across columns</i>.</dd></dl></li></ul>
</td></tr>
<tr>
<td>Y Values in
</td>
<td>ylabel
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify where the Y values are. It is available when the Data Format is Y across columns.
<p>Option list:
</p>
<ul><li><i>none:None</i>
<dl><dd>There are no Y values in the worksheet. The indices of columns will be the Y values.</dd></dl></li>
<li><i>row1:First Data Row</i>
<dl><dd>The data in the first row will be the Y values.</dd></dl></li>
<li><i>param:Column Label</i>
<dl><dd>Use the column label row to specify the Y values. </dd></dl></li>
<li> <i>sel1:First Data Row in Selection</i>
<dl><dd>Use the data row to specify the Y values. Convert Range must be <i>Specified Ranges</i> <i>and</i> Data Format is <i>X across columns</i> or <i>Y across columns</i>.</dd></dl></li></ul>
</td></tr>
<tr>
<td>Column Label
</td>
<td>param
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center></center>
</td>
<td> This is only available when <i>Column Label</i> is selected from <b>X Values in</b> or <b>Y Values in</b>. Specify the label row to use as the X or Y coordinates using its Label Row character.  Please refer to <a class="external text" href="../../LabTalk/LabTalk/Column_Label_Row_Characters.html">Column Label Row Characters</a> for the single character of each column label row.
</td></tr>
<tr>
<td>X Values in First Column
</td>
<td>xcol
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify whether the X values are in the first column. It is available when the Data Format is Y across columns.
</td></tr>
<tr>
<td>Y Values in First Column
</td>
<td>ycol
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify whether the Y values are in the first column. It is available when the Data Format is X across columns.
</td></tr>
<tr>
<td>Trim Missing
</td>
<td>trim
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Determine whether to trim the missing rows or columns. If, in converting to XYZ any of the coordinates is missing, specifying this option will exclude the data point.
<ul><li> 0 = false</li>
<li> 1 = true</li></ul>
</td></tr>
<tr>
<td>Output
</td>
<td>oz
</td>
<td>
<p>Output
</p><p>XYZRange
</p>
</td>
<td> <center>[&lt;input&gt;]&lt;new&gt;!(&lt;new&gt;,&lt;new&gt;,&lt;new&gt;)</center>
</td>
<td> Specify three columns for the output XYZ range. These three columns can be in different worksheets and workbooks.
<p>See the syntax of <a class="external text" href="../../XFunction/X-Function/Output_Notations.html">Output Notations</a>.
</p>
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>This X-Function is used to convert matrix-like worksheet data (virtual matrix) into XYZ column form. X coordinates are usually arranged in the first row and Y coordinates in the first column, or vice versa. It does not require the X and Y coordinates to be evenly-spaced. If XY coordinates are not included, column and row index are used. Z values can be numeric or text (as wll as categorical data).
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<ol>
<li>The following source data has X coordinates in the first row and Y coordinates in the first column:

<dl><dd><br /><a  class="image"><img alt="W2xyz example source.png" src="../images/W2xyz/W2xyz_example_source.png?v=13241" width="393"  /></a><br /><br /></dd></dl>

To convert into XYZ form, make above worksheet active and then select <b>Worksheet: Convert to XYZ</b> from the Origin menu or run <code>w2xyz -d;</code> in Command Window to open the dialog of the w2xyz X-Function.

<li>In <b>Conversion Options</b> branch of this dialog, choose <b>X across columns</b> in the <b>Data Format</b> drop-down list. Then select <b>First Data Row</b> in the <b>X Values in</b> drop-down list and check the check box behind <b>Y Values in First Column</b>.

<dl><dd><br /><a  class="image"><img alt="W2xyz example dialog.png" src="../images/W2xyz/W2xyz_example_dialog.png?v=16543" width="380"  /></a><br /><br /></dd></dl>

<li>Click the <b>OK</b> button to perform the conversion. You will get the following output worksheet.

<dl><dd><br /><a  class="image"><img alt="W2xyz example result.png" src="../images/W2xyz/W2xyz_example_result.png?v=13239" width="322"  /></a></dd></dl>
</ol>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">Related X-Functions</span></h2>
<p><a href="../../XFunction/X-Function/W2m.html" title="X-Function:W2m">w2m</a>, <a href="../../XFunction/X-Function/R2m.html" title="X-Function:R2m">r2m</a>, <a href="../../XFunction/X-Function/M2w.html" title="X-Function:M2w">m2w</a>
</p>





