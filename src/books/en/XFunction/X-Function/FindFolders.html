<h1 class="firstHeading">2.14.1.8 findFolders</h1><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Brief_Information"><span class="tocnumber">1</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Command_Line_Usage"><span class="tocnumber">2</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#X-Function_Execution_Options"><span class="tocnumber">3</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Variables"><span class="tocnumber">4</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Description"><span class="tocnumber">5</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Examples"><span class="tocnumber">6</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Related_X-Functions"><span class="tocnumber">7</span> <span class="toctext">Related X-Functions</span></a></li>
</ul>
</div>

<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Search for folders
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
1. findFolders path:="C:\c";
</p><p>2. findFolders path:="C:\c" addpath:=1;
</code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>path to look for subfolders
</td>
<td>path
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>path$</center>
</td>
<td>
<p>input path to look for subfolders
</p>
</td></tr>
<tr>
<td>add root path to all resulting folder
</td>
<td>addpath
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>add root path to all resulting folder or not
</p>
</td></tr>
<tr>
<td>number of sub folders found
</td>
<td>n
</td>
<td>
<p>Output
</p><p>int
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td>
<p>output the number of sub folders found
</p>
</td></tr>
<tr>
<td>result folder names separated by CRLF
</td>
<td>folder
</td>
<td>
<p>Output
</p><p>string
</p>
</td>
<td> <center>folder$</center>
</td>
<td>
<p>output result file names separated by CRLF
</p>
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>This X-Function is used to search folders in specific path and conditions.
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p>This example shows:
</p>
<ol><li> Opens a dialog by <a href="../../XFunction/X-Function/DlgPath.html" title="X-Function:DlgPath">dlgPath</a> X-Function to pick a path</li>
<li> Find all subfolders under it by FindFolders X-Function</li>
<li> Use <a class="external text" href="../../LabTalk/LabTalk/String_(object).html#GetToken"><b>GetToken</b></a> to separate the folder names using <a class="external text" href="../../LabTalk/LabTalk/LabTalk_Keywords.html">CRLF</a> as separator.</li>
<li> Create same subfolder structure by <a href="../../XFunction/X-Function/Pe_mkdir.html" title="X-Function:Pe mkdir">pe_mkdir</a> X-function under the current Project Explorer folder of current OPJ</li></ol>
<pre class="lt" style="font-family:monospace;">dlgPath;<span style="color: #008000;">// Open a dialog to pick path. Selected folder name will be saved in path$</span>
type <span style="color: #000080;">-</span>a <span style="color: #ff00ff;">&quot;You have choosen &quot;</span> <span style="color: #000080;">+</span> path<span style="color: #000080;">$</span>;

findFolders;<span style="color: #008000;">// find subfolders under path specified in path$. All found path will be put to folder$, separated by CRLF, by default full path is not added</span>

if<span style="color: #000000;">&#40;</span>folder.<span style="color: #000080;">GetLength</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">&lt;</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	type <span style="color: #ff00ff;">&quot;No subfolders found&quot;</span>;
	break <span style="color: #0000dd;">1</span>;
<span style="color: #000000;">&#125;</span>
int nn <span style="color: #000080;">=</span> folder.<span style="color: #000080;">GetNumTokens</span><span style="color: #000000;">&#40;</span>CRLF<span style="color: #000000;">&#41;</span>;
type <span style="color: #ff00ff;">&quot;$(nn) subfolders found&quot;</span>;
string strTemp<span style="color: #000080;">$</span>;
for<span style="color: #000000;">&#40;</span>int ii <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; ii <span style="color: #000080;">&lt;=</span>nn; ii<span style="color: #000080;">++</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	strTemp<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> folder.<span style="color: #000080;">GetToken</span><span style="color: #000000;">&#40;</span>ii, CRLF<span style="color: #000000;">&#41;</span><span style="color: #000080;">$</span>;
	pe_mkdir strTemp<span style="color: #000080;">$</span>; <span style="color: #008000;">//Create these folders under current folder in Project Explorer of Origin.</span>
<span style="color: #000000;">&#125;</span></pre>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">Related X-Functions</span></h2>
<p><a href="../../XFunction/X-Function/FindFiles.html" title="X-Function:FindFiles">FindFiles</a>
</p>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>root, subfolder</span></p>






