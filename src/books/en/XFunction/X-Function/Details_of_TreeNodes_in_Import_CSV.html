<h1 class="firstHeading">2.16.3.7 Details of TreeNodes in Import CSV</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#options"><span class="tocnumber">1</span> <span class="toctext">options</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Names"><span class="tocnumber">1.1</span> <span class="toctext">Names</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#HeaderLines"><span class="tocnumber">1.2</span> <span class="toctext">HeaderLines</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#partial"><span class="tocnumber">1.3</span> <span class="toctext">partial</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Script"><span class="tocnumber">1.4</span> <span class="toctext">Script</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="options"></a><span class="mw-headline">options</span></h2>
<p>The <b>Options</b> tree specifies all import options for the <b>impCSV</b> X-Function.
</p><p>Syntax:  <b>Options.<i>Treenode</i>:=&lt;value&gt;</b>
</p><p>Example: <b>Options.decimal:=1</b>
</p>
<table class="treetable">
<tr>
<th> Treenode
</th>
<th> Label
</th>
<th> Type
</th>
<th> Default
</th>
<th> Description
</th></tr>
<tr>
<td>decimal
</td>
<td>Delimiter
</td>
<td>int
</td>
<td>0
</td>
<td>Specify a delimiter. Options include:
<ul><li>0: Comma 
<dl><dd>Data columns are delimited by comma.</dd></dl></li>
<li>1: Semicolon 
<dl><dd>Data columns are delimited by semicolon.</dd></dl></li>
<li>2: Auto
<dl><dd>Data columns are delimited by auto-determined delimiter.</dd></dl></li></ul>
</td></tr>
<tr>
<td>FirstMode
</td>
<td>1st File Import Mode
</td>
<td>int
</td>
<td>0
</td>
<td>Specify the import mode for the 1st file. Options include:
<ul><li>0: Replace Existing Data 
<dl><dd>The data that exists in the target window will be wiped out. And the new data will be imported into it. </dd></dl></li>
<li>3: Start New Books 
<dl><dd>Create a new book for the file that will be imported. </dd></dl></li>
<li>4: Start New Sheets 
<dl><dd>Create a new sheet for the file that will be imported. </dd></dl></li>
<li>1: Start New Columns 
<dl><dd>Add new columns to the target worksheet and import the data into the new columns.</dd></dl></li>
<li>2: Start New Rows 
<dl><dd>Add new rows to the target worksheet and import the data into the new rows.</dd></dl></li></ul>
</td></tr>
<tr>
<td>Mode
</td>
<td>Multi-File (except 1st) Import Mode
</td>
<td>int
</td>
<td>4
</td>
<td>Specify the import mode from the list for the files other than 1st. Options include:
<ul><li>3: Start New Books 
<dl><dd>Create a new book for the file that will be imported. </dd></dl></li>
<li>4: Start New Sheets 
<dl><dd>Create a new sheet for the file that will be imported. </dd></dl></li>
<li>1: Start New Columns 
<dl><dd>Add new columns to the target worksheet and import the data into the new columns.</dd></dl></li>
<li>2: Start New Rows 
<dl><dd>Add new rows to the target worksheet and import the data into the new rows. </dd></dl></li></ul>
</td></tr>
<tr>
<td>WinTemplate
</td>
<td>Template Name
</td>
<td>String
</td>
<td>&lt;default&gt;
</td>
<td>This option is available when the <b>Import Mode</b> is <b>Start New Sheets</b> or <b>Start New Books</b>. Specify the template to import the file to a new book or new sheet. A special template <i><b>&lt;clone&gt;</b></i> can be used to specify current workbook or matrix book as template to import files.
</td></tr>
<tr>
<td>Sparklines
</td>
<td>Add Sparklines
</td>
<td>int
</td>
<td>2
</td>
<td>Specify whether to add sparklines for the data. Option list:
<ul><li>0: No
<dl><dd>Do not add sparklines.</dd></dl></li>
<li>1: Yes
<dl><dd>Add sparklines.</dd></dl></li>
<li>2: Yes(if less than 50 columns)
<dl><dd>Add sparklines if there are less than 50 columns.</dd></dl></li></ul>
</td></tr>
<tr>
<td>nAutoSize
</td>
<td>Auto Resize Cells
</td>
<td>int
</td>
<td>1
</td>
<td>Resize the cells of the worksheet automatically.
<p>Options include:
</p>
<ul><li>0: No
<dl><dd>Do not resize the cells.</dd></dl></li>
<li>1: Width
<dl><dd>Just reset the width of the cells automatically.</dd></dl></li>
<li>2: Height
<dl><dd>Just reset the height of the cells automatically.</dd></dl></li>
<li>3: Width and Height
<dl><dd>Reset both the width and height of the cells automatically.</dd></dl></li></ul>
</td></tr>
<tr>
<td>DataWriteProtection
</td>
<td>Data Protection
</td>
<td>int
</td>
<td>0
</td>
<td>Specify the imported data whether allow to be modified.
<p>Options include:
</p>
<ul><li>0: No
<dl><dd>The imported data can be modified.</dd></dl></li>
<li>1: Read Only
<dl><dd> The imported data is not allowed to be edited and sorted</dd></dl></li>
<li>2: Allow Sorting Only
<dl><dd>The imported data is not allowed to be edited, but can be sorted.</dd></dl></li></ul>
</td></tr>
<tr>
<td>DateFormat
</td>
<td>Custom Data Format
</td>
<td>double
</td>
<td>
</td>
<td>Select a date format from the drop-down list, or type in a custom date format string. For more details, please see the [ <b>Custom Date Format</b>] page.
<p>Options include:
</p>
<ul><li>&lt;none&gt;</li>
<li>yyyy'-'MM'-'dd HH':'mm':'ss</li>
<li>yyyy'-'MM'-'dd HH':'mm':'ss'.'###</li>
<li>yyyy'-'MM'-'dd hh':'mm':'ss tt</li>
<li>dd'/'MM'/'yyyy</li>
<li>dd'-'MM'-'yy</li>
<li>MM'/'dd'/'yyyy</li>
<li>MM'-'dd'-'yy</li>
<li>yy'/'MM'/'dd</li>
<li>yy'.'MM'.'dd</li>
<li>dd'.'MM'.'yy</li>
<li>yyyyMMdd</li>
<li>dd'-'MMM'-'yy</li></ul>
</td></tr>
<tr>
<td>KeepDestColFmt
</td>
<td>Keep target column format
</td>
<td>int
</td>
<td>0
</td>
<td>Specify whether to keep target column format.
</td></tr></table>
<h3><a name="Names"></a><span class="mw-headline">Names</span></h3>
<p>The <b>Names</b> branch of the <b>Options</b> tree specifies how to name the worksheet and workbook.
</p><p>Syntax: <b>Options.Names.<i>Treenode:= &lt;value&gt;</i></b>
</p><p>Example:
</p>
<dl><dd><b>Options.Names.FNameToSht:=1</b>  </dd>
<dd><b>Options.Names.FNameToShtFrom:=1</b>  </dd>
<dd><b>Options.Names.FNameToShtTo:=4</b>  </dd></dl>
<table class="treetable">
<tr>
<th> Treenode
</th>
<th> Label
</th>
<th> Type
</th>
<th> Default
</th>
<th> Description
</th></tr>
<tr>
<td>AutoNames
</td>
<td>Auto Rename Using File Name
</td>
<td>int
</td>
<td>0
</td>
<td>If it is checked, Origin will use the default settings to rename the worksheet and workbook name, which is:
<ul><li>Use the whole filename (not including the file extension) as worksheet name.</li>
<li>Use the whole filename (including the file extension) as workbook name if current workbook is empty or the import mode is <b>Replace Existing Data</b>.</li></ul>
</td></tr>
<tr>
<td>FNameToSht
</td>
<td>Rename Sheet with (Partial) Filename
</td>
<td>int
</td>
<td>1
</td>
<td>Check this to use part of the filename as worksheet name.
</td></tr>
<tr>
<td>FNameToShtFrom
</td>
<td>Trim Filename From
</td>
<td>int
</td>
<td>1
</td>
<td>Specify the start of the name.
</td></tr>
<tr>
<td>FNameToShtTo
</td>
<td>Trim Filename To
</td>
<td>int
</td>
<td>0
</td>
<td>Specify the end of the name.
</td></tr>
<tr>
<td>FNameToBk
</td>
<td>Rename Book with (Partial) Filename
</td>
<td>int
</td>
<td>1
</td>
<td>Check this to use part of the filename as workbook name.
</td></tr>
<tr>
<td>FNameToBkFrom
</td>
<td>Trim Filename From
</td>
<td>int
</td>
<td>1
</td>
<td>Specify the start of the name.
</td></tr>
<tr>
<td>FNameToBkTo
</td>
<td>Trim Filename To
</td>
<td>int
</td>
<td>0
</td>
<td>Specify the end of the name.
</td></tr>
<tr>
<td>FNameToBkLnOnly
</td>
<td>Rename Long Name for Book only
</td>
<td>int
</td>
<td>0
</td>
<td>Check this to rename the long name for workbook only.
</td></tr>
<tr>
<td>FPathToBk
</td>
<td>Include File Path when Renaming Book
</td>
<td>int
</td>
<td>0
</td>
<td>Specify if the file path should be included for the workbook name.
</td></tr>
<tr>
<td>FNameToBkComm
</td>
<td>Append Filename to Workbook Comment
</td>
<td>int
</td>
<td>1
</td>
<td>Specify if the filename should be appended to the workbook comment.
</td></tr>
<tr>
<td>FNameToWksComm
</td>
<td>Appen Filename to Worksheet Comment
</td>
<td>int
</td>
<td>0
</td>
<td>Specify if the filename should be appended to the worksheet comment.
</td></tr>
<tr>
<td>FNameToColComm
</td>
<td>Append Filename to Column Comment
</td>
<td>int
</td>
<td>0
</td>
<td>Specify if the filename should be appended to the column comment.
</td></tr>
<tr>
<td>FNameToUDL
</td>
<td>Add Filename User Parameters Row
</td>
<td>int
</td>
<td>0
</td>
<td>Specify whether to put the file name to user parameter row SourceFile
</td></tr>
<tr>
<td>FPathToComm
</td>
<td>Include File Path when Appending Filename
</td>
<td>int
</td>
<td>0
</td>
<td>When this is checked, the import file path is appended to the workbook's comment and/or Comments row.
</td></tr></table>
<table class="note">

<tr>
<td><b>Notes:</b>
<p>From Origin 8.6, minus value is supported in <b>FNameToBkFrom</b> and <b>FNameToBkTo</b> to count the end of the name from the last character of the file name. It can be used to trim the file extension when you rename workbook. For example, if you want to import a csv file named <i>sample.csv</i>, you can specify the setting as below to trim the extension "<i>.csv</i>" when renaming the workbook name:
</p>
<dl><dd>Options.Names.FNameToBkFrom:=1</dd>
<dd>Options.Names.FNameToBkTo:=-4</dd></dl>
</td></tr></table>
<h3><a name="HeaderLines"></a><span class="mw-headline">HeaderLines</span></h3>
<p>The <b>HeaderLines</b> branch of the <b>Options</b> tree specifies the header information of the data file.
</p><p>Syntax: <b>Options.HeaderLines.<i>Treenode:= &lt;value&gt;</i></b>
</p><p>Example: <b>Options.HeaderLines.SNames:= 1</b> 
</p>
<table class="treetable">
<tr>
<th> Treenode
</th>
<th> Label
</th>
<th> Type
</th>
<th> Default
</th>
<th> Description
</th></tr>
<tr>
<td>MainHdrLns
</td>
<td>Number of Main Header Lines(exclude subheader lines)
</td>
<td>int
</td>
<td>0
</td>
<td>Some files -- particularly those generated by lab instrumentation -- will have, at the top of the file, some header information that typically identifies the instrument, the operator, the date, the sample number, etc. These are the main header lines. It is used to specify where main header lines are.
</td></tr>
<tr>
<td>AutoSubHeaderLines
</td>
<td>Auto Determine Subheader Lines
</td>
<td>int
</td>
<td>1
</td>
<td>Select this check box to have Origin automatically determine the number of subheader lines. Note that it does not determine the structure of the subheader lines (e.g., which line is for long names and which is for units). If you want to manually specify the number, clear this check box.
</td></tr>
<tr>
<td>SubHeaderLines
</td>
<td>Number of Subheader Lines
</td>
<td>int
</td>
<td>0
</td>
<td>It is used to specify the number of subheader lines of file.
</td></tr>
<tr>
<td>ShortNames
</td>
<td>Short Names
</td>
<td>int
</td>
<td>0
</td>
<td>Specify which line of the file header to use for the short names of the worksheet row heading. Note that the number starts from the beginning of subheader lines rather than that of the whole header lines. Same for the settings below.
<p><b>Note</b> that from Origin 2017 column Short Name is restricted to alphabetical order and it cannot be edited by default. So <b>Short Name</b> option is hidden from GUI. If you want to rename column Short Names, you will need to go to the target workbook, uncheck <b>Spreadsheet Cell Notation</b> checkbox in <a class="external text" href="../../UserGuide/UserGuide/Folder_and_Window_Properties_Dialog.html#The_Properties_tab">the <b>Properties</b> tab of <b>Window Properties</b> dialog</a> to enable editing column Short Name.
</p>
</td></tr>
<tr>
<td>LongNames
</td>
<td>Long Names
</td>
<td>int
</td>
<td>0
</td>
<td>Specify the line for long names.
</td></tr>
<tr>
<td>Units
</td>
<td>Units
</td>
<td>int
</td>
<td>0
</td>
<td>Specify the line for units.
</td></tr>
<tr>
<td>CommentsFrom
</td>
<td>Comments From
</td>
<td>int
</td>
<td>0
</td>
<td>Specify the line which the comments start from.
</td></tr>
<tr>
<td>CommentsTo
</td>
<td>Comments to
</td>
<td>int
</td>
<td>0
</td>
<td>Specify the line which the comments end with.
</td></tr>
<tr>
<td>ParamsFrom
</td>
<td>System Parameters From
</td>
<td>int
</td>
<td>0
</td>
<td>Specify the line which the system parameters start from.
</td></tr>
<tr>
<td>ParamsTo
</td>
<td>System Parameters To
</td>
<td>int
</td>
<td>0
</td>
<td>Specify the line which the system parameters end with.
</td></tr>
<tr>
<td>UserParamsFrom
</td>
<td>User Parameters From
</td>
<td>int
</td>
<td>0
</td>
<td>Specify the line which the user parameters start from.
</td></tr>
<tr>
<td>UserParamsTo
</td>
<td>User Parameters To
</td>
<td>int
</td>
<td>0
</td>
<td>Specify the line which the user parameters end with.
</td></tr></table>
<h3><a name="partial"></a><span class="mw-headline">partial</span></h3>
<p>The <b>partial</b> branch of the <b>Options</b> tree specifies how to partially import the file.
</p><p>Syntax: <b>Options.PartImp.<i>Treenode:= &lt;value&gt;</i></b>
</p><p>Example: 
</p>
<dl><dd><b>Options.partial.Partial:=1</b>  </dd>
<dd><b>Options.partial.FirstCol:=1</b>  </dd>
<dd><b>Options.partial.LastCol:=3</b> </dd></dl>
<table class="treetable">
<tr>
<th> Treenode
</th>
<th> Label
</th>
<th> Type
</th>
<th> Default
</th>
<th> Description
</th></tr>
<tr>
<td>Partial
</td>
<td>Partial Import
</td>
<td>int
</td>
<td>0
</td>
<td>Set it to 0 to disable partial import; set it to 1 or 2 to enable partial import. 1 means apply partial import settings to all files and 2 means apply partial import settings to all files except 1st file.
</td></tr>
<tr>
<td>FirstCol
</td>
<td>Start Column
</td>
<td>int
</td>
<td>1
</td>
<td>This is only available when Partial is enabled(set to 1 or 2). Specify the begin column for partial import.
</td></tr>
<tr>
<td>ReadCols
</td>
<td>Read Columns
</td>
<td>int
</td>
<td>1
</td>
<td>This is only available when Partial is enabled(set to 1 or 2) and "Skip columns" is larger than 0. Specify how many columns to read before skipping column(s) for partial import.
<p>Note that When you specify a number l for <b>Read Columns</b> and a number k for <b>Skip Columns</b>, l columns are imported while k columns are skipped for every l+k columns. 
</p>
</td></tr>
<tr>
<td>SkipCols
</td>
<td>Skip Columns
</td>
<td>int
</td>
<td>0
</td>
<td>This is only available when Partial is enabled(set to 1 or 2). Specify how many columns to skip after each reading for partial import.
</td></tr>
<tr>
<td>LastCol
</td>
<td>To Column
</td>
<td>int
</td>
<td>0
</td>
<td>This is only available when Partial is enabled(set to 1 or 2). Specify the end column for partial import.
</td></tr>
<tr>
<td>FirstSample
</td>
<td>From Row
</td>
<td>int
</td>
<td>1
</td>
<td>Specify the start row of the file to be imported. This is only available when Partial is enabled(set to 1 or 2).
</td></tr>
<tr>
<td>ReadSamples
</td>
<td>Read Rows
</td>
<td>int
</td>
<td>0
</td>
<td>This works with <b>Skip Rows</b>. It is only available when Partial is enabled(set to 1 or 2) and <b>Skip Rows</b> is larger than zero.
<p>Note that When you specify a number l for <b>Read Rows</b> and a number k for <b>Skip Rows</b>, l rows are imported while k rows are skipped for every l+k rows. 
</p>
</td></tr>
<tr>
<td>SkipSamples
</td>
<td>Skip Rows
</td>
<td>int
</td>
<td>1
</td>
<td>Some rows can be skipped according to the setting. This is only available when Partial is enabled(set to 1 or 2).
</td></tr>
<tr>
<td>LastSample
</td>
<td>To Row
</td>
<td>int
</td>
<td>0
</td>
<td>Specify the end row of the file to be imported. This is only available when Partial is enabled(set to 1 or 2).
</td></tr></table>
<h3><a name="Script"></a><span class="mw-headline">Script</span></h3>
<p>The <b>Script</b> branch of the <b>Options</b> tree specifies the LabTalk scripts to run after file(s) being imported.
</p><p>Syntax: <b>options.scripts.Treenode:= &lt;<i>string</i>&gt;</b>
</p><p>Example: <br />
//Plot second column for each imported file &#160;: <br />
<b>options.scripts.ScriptAfterEachImport:="plotxy 2;";</b> <br />  
</p><p>//When all files being imported, loop over all worksheets in all workbooks and delete first 500 rows from column 1 to column 4.
<br />
<b>options.scripts.ScriptAfterAllImport:=" doc -ef W { doc -e LW { range aa =1[1]:4[500]; del aa;}}";<br /></b>
</p><p><br />
</p>
<table class="treetable">
<tr>
<th> Treenode
</th>
<th> Label
</th>
<th> Type
</th>
<th> Default
</th>
<th> Description
</th></tr>
<tr>
<td>ScriptAfterEachImport
</td>
<td>Script after Each File Imported
</td>
<td>string
</td>
<td>"?"
</td>
<td>Specify LabTalk scripts that will be executed after each imported file.
</td></tr>
<tr>
<td>ScriptAfterAllImport
</td>
<td>Script after All Files Imported
</td>
<td>string
</td>
<td>"?"
</td>
<td>Specify LabTalk scripts that will be executed only after all files being imported.
</td></tr></table>






