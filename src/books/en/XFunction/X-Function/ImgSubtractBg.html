<h1 class="firstHeading">2.6.3.8 imgSubtractBg(Pro)</h1><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">Menu Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Additional_Information"><span class="tocnumber">3</span> <span class="toctext">Additional Information</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Command_Line_Usage"><span class="tocnumber">4</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#X-Function_Execution_Options"><span class="tocnumber">5</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Variables"><span class="tocnumber">6</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Description"><span class="tocnumber">7</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Examples"><span class="tocnumber">8</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Algorithm"><span class="tocnumber">9</span> <span class="toctext">Algorithm</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#References"><span class="tocnumber">10</span> <span class="toctext">References</span></a></li>
<li class="toclevel-1 tocsection-11"><a href="#Related_X-Functions"><span class="tocnumber">11</span> <span class="toctext">Related X-Functions</span></a></li>
</ul>
</div>

<h2><a name="Menu_Information"></a><span class="mw-headline">Menu Information</span></h2>
<p>Image: Arithmetic Transform: Subtract Background 
</p>
<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Subtract image background
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">Additional Information</span></h2>
<p>This feature is for OriginPro only.
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
1. imgSubtractBg r:=80;
</p><p>2. imgSubtractBg r:=50 s:=s2 i:=80;
</p><p>3. imgSubtractBg s:=s8 bg:=bright oimg:=mat(2); 
</p><p></code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Input Matrix
</td>
<td>img
</td>
<td>
<p>Input
</p><p>Image
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td>
<p>Specifies the input image. The default input is the active image.
</p>
</td></tr>
<tr>
<td>Rolling Ball
</td>
<td>r
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>20</center>
</td>
<td>
<p>Specifies the radius (in pixels) of the ball that will roll over the entire image to determine the background.
</p>
</td></tr>
<tr>
<td>Shrink Size
</td>
<td>s
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>radius</center>
</td>
<td>
<p>Specifies how to shrink the input image internally. If the image is minimized, the computation speed will increase, but the accuracy will decrease. Note that the shrinking will not affect the input image.
<br />
Option list
</p>
<ul><li><i>radius:Depend on Radius</i>
<dl><dd>Shrinks the input image depending on the radius of the rolling ball.</dd></dl></li>
<li><i>s0:No Shrink</i>
<dl><dd>Does not shrink the input image.</dd></dl></li>
<li><i>s2:Shrink 1/2</i>
<dl><dd>Resizes the input image to half width and height.</dd></dl></li>
<li><i>s4:Shrink 1/4</i>
<dl><dd>Resizes the input image to quarter width and height.</dd></dl></li>
<li><i>s8:Shrink 1/8</i></li></ul>
<p>Resizes the input image to eighth width and height
</p>
</td></tr>
<tr>
<td>Brightness
</td>
<td>i
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>100</center>
</td>
<td>
<p>Specifies a brightness factor for increasing or decreasing the brightness of the image. Valid values range from 0 to 400.
</p>
</td></tr>
<tr>
<td>Background
</td>
<td>bg
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>dark</center>
</td>
<td>
<p>Specifies whether or not the background is darker than the foreground.
<br />
Option list
</p>
<ul><li><i>dark:Darker than the Foreground</i>
<dl><dd>The background is darker than the foreground.</dd></dl></li>
<li><i>bright:Brighter than the Foreground</i>
<dl><dd>The background is brighter than the foreground.</dd></dl></li></ul>
</td></tr>
<tr>
<td>Show
</td>
<td>show
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>result</center>
</td>
<td>
<p>Specifies whether to show the subtraction result or the background in the output image.
<br />
Option list
</p>
<ul><li><i>result:Result</i>
<dl><dd>The output image shows the result of the subtraction between the background and the original image.</dd></dl></li>
<li><i>bg:Background</i>
<dl><dd>The output bitmap shows only the background.</dd></dl></li></ul>
</td></tr>
<tr>
<td>Output Image
</td>
<td>oimg
</td>
<td>
<p>Output
</p><p>Image
</p>
</td>
<td> <center>&lt;new&gt;</center>
</td>
<td>
<p>Specifies the output image. By default, a new image will be created and used as output.
</p><p>See the syntax <a class="external text" href="../../XFunction/X-Function/Output_Notations.html">here</a>.
</p>
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>When analyzing the contents of an image, the background typically does not contain anything of interest. In fact, in many cases the background can interfere with your analysis. One way to deal with this is to subtract it from the image. Subtracting the background from the image can help to segment out the objects of interest and facilitate further processing.
</p><p>Often, we do not have a previously recorded background or an image of the background without any foreground objects. In this case, background subtract requires estimating the background with some algorithm and then subtracting it from the original image. Two tools provided by OriginPro are capable of performing this kind of background subtraction. They are <b>Subtract Background</b> and <a href="../../XFunction/X-Function/ImgSubtractInterpBG.html" title="X-Function:ImgSubtractInterpBG"><b>Subtract Interpolated Background</b></a>. The major difference between them is the algorithm which is used to generate the background.
</p><p>With <b>ImgSubtractBg</b> X-function, the Subtract Background tool in OriginPro, you can subtract a background that is generated by the "rolling ball" algorithm from an input image. This algorithm interprets the input image as a 3-D surface with the z axis to be the intensity of the image. Next, it rolls a 3-D ball beneath the surface. Finally, the background is constructed by these points of the 3-D ball which are tangent to the surface. Note that it only works well for simple background, where the background is significantly brighter or darker than the foreground.
</p><p>The tool uses a copy of the input image to generate the background, which may be shrunk according to the Shrink Size option. In addition, you can control the radius of the rolling ball. Both the size of the copy image and the radius of the rolling ball can affect the computation speed and the quality of the subtraction. Furthermore, you can determine the brightness of the output image. It is also allowed to specify whether to show the subtraction result or the background in the output image.
</p>
<dl><dd><a  class="image"><img alt="BKSubMethod1Setting2.png" src="../images/ImgSubtractBg/BKSubMethod1Setting2.png?v=79789" width="390"  /></a></dd></dl>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p>In this example, we use the <i>imgSubtractBg</i> function to subtract the background from the input image:
</p>
<ol><li> When the input image is active, select <b>Image: Arithmetic Transform: Subtract Background</b>. This opens the dialog of the X-Function.</li>
<li> In the X-Function dialog, change the settings as the screenshot below and click <b>OK</b> to close the dialog.<br /><a  class="image"><img alt="ImgSubtractBg help English files image002.jpg" src="../images/ImgSubtractBg/ImgSubtractBg_help_English_files_image002.jpg?v=1157" width="440"  /></a><br /> A new image is created as a result. We can see that the background is subtracted from the input image and the output image is brighter than the input.</li></ol>
<dl><dd><table class="TableGrid" style="border: none; x-border-left: 1px table-solid; x-border-top: 1px table-solid; x-border-right: 1px table-solid; x-border-bottom: 1px table-solid; border-collapse: separate; border-spacing: 0px; border-spacing: 0px" border="1">
<tr>
<td>
<center><a  class="image"><img alt="ImgSubtractBg help English files image004.jpg" src="../images/ImgSubtractBg/ImgSubtractBg_help_English_files_image004.jpg?v=1158" width="261"  /></a></center>
</td>
<td>
<center><a  class="image"><img alt="ImgSubtractBg help English files image006.jpg" src="../images/ImgSubtractBg/ImgSubtractBg_help_English_files_image006.jpg?v=1159" width="262"  /></a></center>
</td></tr>
<tr>
<td>
<center>Input image</center>
</td>
<td>
<center>Output image</center>
</td></tr></table></dd></dl>
<p><br />
Note: OriginPro includes the ability to automatically recalculate the analysis result of the background subtractoperation any time you change the parameters or update your source data. In addition, the settings for the analysis routine can be saved to an analysis theme for later use with similar data.
</p>
<h2><a name="Algorithm"></a><span class="mw-headline">Algorithm</span></h2>
<p>The computation mainly uses L_SubtractBackgroundBitmap() function from LEADTOOLS Main API. Please refer to the LEADTOOLS Main API Help file, Version 14 and read the L_SubtractBackgroundBitmap topic.
</p>
<h2><a name="References"></a><span class="mw-headline">References</span></h2>
<p>LEADTOOLS Main API Help file, Version 14
</p>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">Related X-Functions</span></h2>
<p><a href="../../XFunction/X-Function/ImgReplaceBg.html" title="X-Function:ImgReplaceBg">imgReplaceBg</a>, <a href="../../XFunction/X-Function/ImgSubtractInterpBG.html" title="X-Function:ImgSubtractInterpBG">imgSubtractInterpBG</a>, <a href="../../XFunction/X-Function/ImgMathfun.html" title="X-Function:ImgMathfun">imgMathfun</a>, <a href="../../XFunction/X-Function/ImgPixlog.html" title="X-Function:ImgPixlog">imgPixlog</a>
</p>





