<h1 class="firstHeading">2.2.1.3 w2m</h1><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">Menu Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Additional_Information"><span class="tocnumber">3</span> <span class="toctext">Additional Information</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Command_Line_Usage"><span class="tocnumber">4</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#X-Function_Execution_Options"><span class="tocnumber">5</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Variables"><span class="tocnumber">6</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Description"><span class="tocnumber">7</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Examples"><span class="tocnumber">8</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Related_X-Functions"><span class="tocnumber">9</span> <span class="toctext">Related X-Functions</span></a></li>
</ul>
</div>

<h2><a name="Menu_Information"></a><span class="mw-headline">Menu Information</span></h2>
<p>Worksheet&#160;: Convert to Matrix&#160;: Direct...
</p>
<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Convert entire worksheet to matrix
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">Additional Information</span></h2>
<p>This feature is updated in 8.0 SR4. For more details, please refer to <a class="external text" href="http://www.originlab.com/doc/ReleaseNotes" target="_blank">Release Notes</a>.
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
1. w2m iw:=[Book1]Sheet1! xy:=noxy;
</p><p>2. w2m trim:=1;
</p><p>3. w2m iw:=[Book1]Sheet2;
</p><p>4. w2m om:=[MBook1]MSheet2;
</p><p>5. w2m [Book2]1 [MBook3]MSheet2!Mat(1);
</p><p>6. w2m iw:=[book1]sheet1! xy:=xcol xlabel:=param param:=L;
</code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Input Worksheet
</td>
<td>iw
</td>
<td>
<p>Input
</p><p>Worksheet
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> Specify the worksheet to be converted
</td></tr>
<tr>
<td>Data Format
</td>
<td>xy
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>noxy</center>
</td>
<td> Specify the X and Y coordinates
<p>Option list:
</p>
<ul><li><i>xcol:X across columns</i></li></ul>
<dl><dd>0. Specify that the X coordinates will be from row values of the source worksheet, across the columns.</dd></dl>
<ul><li><i>ycol:Y across columns</i></li></ul>
<dl><dd>1. Specify that the Y coordinates will be from row values of the source worksheet, across the columns.</dd></dl>
<ul><li><i>noxy:No  X and Y</i></li></ul>
<dl><dd>2. Directly convert the entire worksheet without specifying X and Y coordinates. X and Y coordinates will be integer values.</dd></dl>
</td></tr>
<tr>
<td>X Values in
</td>
<td>xlabel
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center></center>
</td>
<td> Available when <b>X across columns</b> is selected from <b>Data Format</b>. It can be the worksheet first data row or a column label row.
<p>Option list:
</p>
<ul><li><i>none:None</i></li></ul>
<dl><dd>Use matrix column indices as X coordinates.</dd></dl>
<ul><li><i>row1:First Data Row</i></li></ul>
<dl><dd>Use the values of the first data row as X coordinates.</dd></dl>
<ul><li><i>param:Use Parameter</i></li></ul>
<dl><dd>Use the values of a column label row as X coordinates.</dd></dl>
</td></tr>
<tr>
<td>Y Values in First Column
</td>
<td>ycol
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Available when <b>X across columns</b> is selected from <b>Data Format</b>. Check to use the first column values as Y coordinates.
</td></tr>
<tr>
<td>Y Values in
</td>
<td>ylabel
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center></center>
</td>
<td> Available when <b>Y across columns</b> is selected from <b>Data Format</b>. It can be the worksheet first data row or a column label row.
<p>Option list:
</p>
<ul><li><i>none:None</i></li></ul>
<dl><dd>Use matrix row indices as Y coordinates.</dd></dl>
<ul><li><i>row1:First Row</i></li></ul>
<dl><dd>Use the values of the first data row as Y coordinates.</dd></dl>
<ul><li><i>param:Use Parameter</i></li></ul>
<dl><dd>Use the values of a column label row as Y coordinates.</dd></dl>
</td></tr>
<tr>
<td>X Values in First Column
</td>
<td>xcol
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Available when <i>Y across columns</i> is selected from <b>Data Format</b>. Check to use the first column values as X coordinates.
</td></tr>
<tr>
<td>Column Label
</td>
<td>param
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center></center>
</td>
<td> This is only available when <i>Column Label</i> is selected from <b>X Values in</b> or <b>Y Values in</b>. Specify the label row to use as the X or Y coordinates using its Label Row character. Please refer to <a class="external text" href="../../LabTalk/LabTalk/Column_Label_Row_Characters.html">Column Label Row Characters</a> for the single character of each column label row.
</td></tr>
<tr>
<td>Even Spacing Relative Tolerance(%)
</td>
<td>tol
</td>
<td>
<p>Input
</p><p>double
</p>
</td>
<td> <center>5</center>
</td>
<td> Tolerance used to check for even spacing.
</td></tr>
<tr>
<td>Use Linear Fit Estimate for Coordinates
</td>
<td>lr
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> This checkbox specifies whether or not to use linear fit estimate for coordinates.
</td></tr>
<tr>
<td>Trim Missing
</td>
<td>trim
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> Determine whether to trim the missing rows or columns
</td></tr>
<tr>
<td>Output Matrix
</td>
<td>om
</td>
<td>
<p>Output
</p><p>MatrixObject
</p>
</td>
<td> <center>&lt;new&gt;</center>
</td>
<td> Specify the output matrix
<p>See the syntax of <a class="external text" href="../../XFunction/X-Function/Output_Notations.html">Output_Notations</a>.
</p>
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>This X-Function is capable of converting worksheet data into matrix. 
</p><p>The matrix displays a single data set of Z values and characterized by:
</p>
<dl><dd><ul><li> Numbered columns which are mapped to <i>linearly</i> spaced X values.</li>
<li> Numbered rows which are mapped to <i>linearly</i> spaced Y values.</li></ul></dd></dl>
<p><br />
By default, Origin displays the column and row numbers in the column and row headings (left figure below). To display X and Y values (right figure below), select <b>View: Show X/Y</b> from menu.
</p>
<dl><dd><a  class="image"><img alt="W2m help English files image002.png" src="../images/W2m/W2m_help_English_files_image002.png?v=16529" width="352"  /></a> <a  class="image"><img alt="W2m help English files image004.png" src="../images/W2m/W2m_help_English_files_image004.png?v=16530" width="352"  /></a></dd></dl>
<p><br />
If convert the worksheet without specifying X or Y values, Origin will convert worksheet values directly to matrix and assign the matrix coordinates automatically. To reset the coordinates, select <b>Matrix: Set Dimension/Labels</b> from menu. If the worksheet contains X or Y coordinates information in worksheet cells or worksheet column label rows, which organized like:
</p>
<dl><dd><a  class="image"><img alt="W2m help English files image18.png" src="../images/W2m/W2m_help_English_files_image18.png?v=16531" width="450"  /></a></dd></dl>
<p><br />
The new matrix X and Y coordinates can be set by these values. (Note: the X and Y coordinate values should be even spaced).
</p><p>For example:
</p>
<ol><li> If X data values are in the 1st row and Y data values are in the 1st column, the X-Function creates a (<i>columns</i> -1) by (<i>rows</i> -1) matrix of Z values like:
<dl><dd><a  class="image"><img alt="W2m help English files image19.png" src="../images/W2m/W2m_help_English_files_image19.png?v=16532" width="450"  /></a></dd></dl></li>
<li> If Y values in the worksheet label rows and X values are not specified, the X-Function creates a matrix like:
<dl><dd><a  class="image"><img alt="W2m help English files image20.png" src="../images/W2m/W2m_help_English_files_image20.png?v=16533" width="423"  /></a></dd></dl></li></ol>
<p>Note that in this case, the output matrix is transposed during conversion.
</p><p>If there are missing values for entire rows or columns in the worksheet, check the <b>Trim Missing</b> box will trim the missing row or column.
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<ul><li> Code Sample</li></ul>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000; font-style: regular;">/*
This example shows how convert worksheet data into matrix.
The sample data is exe_path\Samples\Matrix Conversion and Gridding\DirectXY.dat.
1. Load data to a new created workbook.
2. Convert worksheet data into matrix, using first row as X and first column as Y.
*/</span>
<span style="color: #008000;">// Get sample data</span>
fn<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Matrix Conversion and Gridding\DirectXY.dat&quot;</span>;
newbook;
impASC fn<span style="color: #000080;">$</span>;

<span style="color: #008000;">// Convert worksheet data into matrix, using first row as X and first column as Y</span>
w2m xy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> xlabel<span style="color: #000000;">:</span><span style="color: #000080;">=</span>row1 ycol<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;</pre>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">Related X-Functions</span></h2>
<p><a href="../../XFunction/X-Function/M2w.html" title="X-Function:M2w">m2w</a>, <a href="../../XFunction/X-Function/R2m.html" title="X-Function:R2m">r2m</a>, <a href="../../XFunction/X-Function/Wexpand2m.html" title="X-Function:Wexpand2m">wexpand2m</a>
</p>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>coordinates, labels</span></p>






