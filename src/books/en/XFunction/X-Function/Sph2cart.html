<h1 class="firstHeading">2.8.28 sph2cart</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Brief_Information"><span class="tocnumber">1</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Additional_Information"><span class="tocnumber">2</span> <span class="toctext">Additional Information</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Command_Line_Usage"><span class="tocnumber">3</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#X-Function_Execution_Options"><span class="tocnumber">4</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Variables"><span class="tocnumber">5</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Description"><span class="tocnumber">6</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Algorithm"><span class="tocnumber">7</span> <span class="toctext">Algorithm</span></a></li>
</ul>
</div>

<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Convert spherical coordinates to Cartesian
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">Additional Information</span></h2>
<p>Minimum Origin Version Required:9.1 SR0
</p><p><br />
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
1. sph2cart format:=virmat iw:=[Book1]Sheet1! omx:=&lt;new&gt;!&lt;new&gt; omy:=&lt;same&gt;!&lt;new&gt; omz:=&lt;same&gt;!&lt;new&gt;;//Convert the virtual matrix data in Book1 Sheet1 and output the three matrix objects for X Y Z to the same matrix sheet.
</p><p>2. sph2cart ir:=[Book1]Sheet1!(A,B,C)[1:3] unit:=1 oz:=&lt;new&gt;!(&lt;new&gt;,&lt;new&gt;,&lt;new&gt;);//Convert the XYZ worksheet column data and output the resulting XYZ data to a new worksheet as XYZ columns.
</p><p>3. sph2cart format:=mats ima:=[MBook1]MSheet1!1 ime:=[MBook2]MSheet1!1 imr:=[MBook3]MSheet1!1;//Convert three matrix objects in different matrix books and output three matrix books for converted X, Y and Z data.
</p><p></code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Data Format
</td>
<td>format
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify the input data format. The input is presumed to use a spherical coordinate system.
<p>Option list:
</p>
<ul><li><i>xyz:XYZ</i>{0}
<dl><dd>Specify input data format as three columns in worksheet with plot designations of XYZ.</dd></dl></li>
<li><i>virmat:Virtual matrix</i>{1}
<dl><dd>Specify input data format as virtual matrix.</dd></dl></li>
<li><i>mat:Matrix object</i>{2}
<dl><dd>Specify input data format as one matrix object.</dd></dl></li>
<li><i>mats:Three matrices in a layer</i>{3}
<dl><dd>Specify input data format as three matrix objects. The three matrix objects need to have the same dimensions.</dd></dl></li></ul>
</td></tr>
<tr>
<td>Input
</td>
<td>ir
</td>
<td>
<p>Input
</p><p>XYZRange
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> This variable is only valid when the <i>format</i> variable is set to <i>xyz</i>. It is used to specify the input XYZ data range.
</td></tr>
<tr>
<td>Azimuth
</td>
<td>ima
</td>
<td>
<p>Input
</p><p>MatrixObject
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> This variable is only valid when the <i>format</i> variable is set to <i>mats</i>. It is used to specify the input matrix object for Azimuth data.
</td></tr>
<tr>
<td>Elevation
</td>
<td>ime
</td>
<td>
<p>Input
</p><p>MatrixObject
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> This variable is only valid when the <i>format</i> variable is set to <i>mats</i>. It is used to specify the input matrix object for Elevation data.
</td></tr>
<tr>
<td>Radius
</td>
<td>imr
</td>
<td>
<p>Input
</p><p>MatrixObject
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> This variable is valid when the <i>format</i> variable is set to <i>mat</i> or <i>mats</i>. If the <i>format</i> was <i>mat</i>, this variable specifies the input matrix object. If the <i>format</i> was <i>mats</i>, it then specifies the input matrix object for the Radius data.
</td></tr>
<tr>
<td>Input
</td>
<td>iw
</td>
<td>
<p>Input
</p><p>Worksheet
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> This variable is only valid when the <i>format</i> variable is set to <i>virmat</i>. It is used to specify the worksheet range of the virtual matrix.
</td></tr>
<tr>
<td>Angle Data
</td>
<td>angle
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> This variable is only valid when the <i>format</i> variable is set to <i>virmat</i> or <i>mat</i>. It specifies how the Azimuth and Elevation values are considered to be arranged in the source data.
<p>Option list:
</p>
<ul><li><i>0:Azimuth Across Columns</i>
<dl><dd>If the <i>format</i> is <i>virmat</i>, use a row as Azimuth values and the first data column as Elevation values. The row for Azimuth value can be specified by the <i>Azimuth Values in</i> variable.</dd>
<dd>If the <i>format</i> is <i>mat</i>, use the X values of the matrix as Azimuth values, and Y values as Elevation values.</dd></dl></li>
<li><i>1:Elevation Across Columns</i>
<dl><dd>If the <i>format</i> is <i>virmat</i>, use a row as Elevation values and the first data column as Azimuth values. The row for Elevation value can be specified by the <i>Elevation Values in</i> variable.</dd>
<dd>If the <i>format</i> is <i>mat</i>, use the X values of the matrix as Elevation values, and Y values as Azimuth values.</dd></dl></li></ul>
</td></tr>
<tr>
<td>Azimuth Values in
</td>
<td>alabel
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> This variable is only valid when the <i>angle</i> variable is set to <i>0</i>(Azimuth Across Columns). It specifies the data source of Azimuth values.
<p>Option list:
</p>
<ul><li><i>first:First Data Row</i>{0}
<dl><dd>Use the first data row in input worksheet as Azimuth values.</dd></dl></li>
<li><i>second:Column Label</i>{1}
<dl><dd>Use the values in a column label row as Azimuth values. The column label row can be specified by the <i>param</i> variable.</dd></dl></li></ul>
</td></tr>
<tr>
<td>Elevation Values in
</td>
<td>elabel
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>This variable is only valid when the <i>angle</i> variable is set to <i>1</i>(Elevation Across Columns). It specifies the data source of Elevation values.
</p><p>Option list:
</p>
<ul><li><i>first:First Data Row</i>{0}
<dl><dd>Use the first data row in input worksheet as Elevation values.</dd></dl></li>
<li><i>second:Column Label</i>{1}
<dl><dd>Use the values in a column label row as Elevation values. The column label row can be specified by the <b>param</b> variable.</dd></dl></li></ul>
</td></tr>
<tr>
<td>Column Label
</td>
<td>param
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> This variable is only valid when the <i>alabel</i> or <i>elabel</i> variable is set to <i>second</i> or <i>1</i> (Column Label). It specifies the column label row to be used as Azimuth or Elevation data.
<p>Option list:
</p>
<ul><li><i>longname:Long Name</i>{0}
<dl><dd>Use the values in Long Name row as Azimuth/Elevation data.</dd></dl></li>
<li><i>units:Units</i>{1}
<dl><dd>Use the values in Units row as Azimuth/Elevation data.</dd></dl></li>
<li><i>comments:Comments</i>{2}
<dl><dd>Use the values in Comments row as Azimuth/Elevation data.</dd></dl></li></ul>
</td></tr>
<tr>
<td>Angular Unit
</td>
<td>unit
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> This variable specifies the Azimuth unit for input data.
<p>Option list:
</p>
<ul><li><i>0:Radian</i>
<dl><dd>The input data is expressed in Radians.</dd></dl></li>
<li><i>1:Degree</i>
<dl><dd>The input data is expressed in Degrees.</dd></dl></li></ul>
</td></tr>
<tr>
<td>X
</td>
<td>omx
</td>
<td>
<p>Output
</p><p>MatrixObject
</p>
</td>
<td> <center>&lt;new&gt;</center>
</td>
<td> This variable is valid when the <i>format</i> variable is NOT set to <i>XYZ</i>. It specifies where to output the converted X value. The converted X value will be the Z value in this output matrix object.
</td></tr>
<tr>
<td>Y
</td>
<td>omy
</td>
<td>
<p>Output
</p><p>MatrixObject
</p>
</td>
<td> <center>&lt;new&gt;</center>
</td>
<td> This variable is valid when the <i>format</i> variable is NOT set to <i>XYZ</i>. It specifies where to output the converted Y value. The converted Y value will be the Z value in this output matrix object.
</td></tr>
<tr>
<td>Z
</td>
<td>omz
</td>
<td>
<p>Output
</p><p>MatrixObject
</p>
</td>
<td> <center>&lt;new&gt;</center>
</td>
<td> This variable is valid when the <i>format</i> variable is NOT set to <i>XYZ</i>. It specifies where to output the converted Z value. The converted Z value will be the Z value in this output matrix object.
</td></tr>
<tr>
<td>Output
</td>
<td>oz
</td>
<td>
<p>Output
</p><p>XYZRange
</p>
</td>
<td> <center>&lt;new&gt;</center>
</td>
<td> This variable is only valid when the <i>format</i> variable is set to <i>XYZ</i>. It specifies the worksheet range to output the converted XYZ data.
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>This tool is used to convert data in spherical coordinates to Cartesian coordinates. The input data can be XYZ worksheet columns, a virtual matrix, one matrix object, or three matrix objects with the same dimensions.
</p><p>You can run the following command in the Script Window or Command Window to bring up the GUI dialog box for this tool:
</p>
<pre class="lt" style="font-family:monospace;">sph2cart <span style="color: #000080;">-</span>d;</pre>
<p><a  class="image"><img alt="Sph2cart dialog.png" src="../images/Sph2cart/Sph2cart_dialog.png?v=77421" width="363"  /></a>
</p>
<h2><a name="Algorithm"></a><span class="mw-headline">Algorithm</span></h2>
<p>The spherical coordinates are defined by <img src="../images/Sph2cart/math-0d7145c5b6c1f28cc984f30558c1fee0.png?v=0" title="\left (r, \theta, \phi \right )" alt="\left (r, \theta, \phi \right )" class="tex"/>, in which <img src="../images/Sph2cart/math-4b43b0aee35624cd95b910189b3dc231.png?v=0" title="r" alt="r" class="tex"/> is the radius (the distance between the origin and the data point), <img src="../images/Sph2cart/math-1ed346930917426bc46d41e22cc525ec.png?v=0" title="\phi" alt="\phi" class="tex"/> is the elevation (the angular displacement of the data point from the XY plane, expressed in Radians) and <img src="../images/Sph2cart/math-2554a2bb846cffd697389e5dc8912759.png?v=0" title="\theta" alt="\theta" class="tex"/> is the azimuth (the angular displacement of the data point from the X axis in the positive direction, i.e. X &gt; 0, expressed in Radians). The image below illustrates how each of the three variables is defined:
</p><p><a  class="image"><img alt="Spherical CS 01.png" src="../images/Sph2cart/Spherical_CS_01.png?v=77418" width="459"  /></a>
</p><p>The source data for azimuth, elevation and radius vary by input data format:
</p>
<table class="simple">
<tr>
<th> Input Data Format
</th>
<th> Azimuth
</th>
<th> Elevation
</th>
<th> Radius
</th></tr>
<tr>
<td align="center"> <b>XYZ</b>
</td>
<td> X column
</td>
<td> Y column
</td>
<td> Z column
</td></tr>
<tr>
<td align="center"> <b>Virtual Matrix/One Matrix Object</b>
</td>
<td> X value of the virtual matrix/matrix object
</td>
<td> Y value of the virtual matrix/matrix object
</td>
<td> Z value of the virtual matrix/matrix object
</td></tr>
<tr>
<td align="center"> <b>Three Matrix Objects</b>
</td>
<td> Z value in the matrix object which is selected for Azimuth
</td>
<td> Z value in the matrix object which is selected for Elevation
</td>
<td> Z value in the matrix object which is selected for Radius
</td></tr></table>
<p>Input data are converted from spherical coordinates to Cartesian coordinates, using the following:
</p><p><img src="../images/Sph2cart/math-abc5d9ae973e3024c12523f50b7e98c7.png?v=0" title="&#10;x = r \ast cos\left ( \phi  \right ) \ast cos \left ( \theta  \right );&#10;" alt="&#10;x = r \ast cos\left ( \phi  \right ) \ast cos \left ( \theta  \right );&#10;" class="tex"/>
</p><p><img src="../images/Sph2cart/math-bf19b127f9953cf4a3bece5bddb88e21.png?v=0" title="&#10;y = r \ast cos\left ( \phi  \right ) \ast sin \left ( \theta  \right );&#10;" alt="&#10;y = r \ast cos\left ( \phi  \right ) \ast sin \left ( \theta  \right );&#10;" class="tex"/>
</p><p><img src="../images/Sph2cart/math-7ff6c70cd5252461cd3496c399919a55.png?v=0" title="&#10;z = r \ast sin\left ( \phi  \right )&#10;" alt="&#10;z = r \ast sin\left ( \phi  \right )&#10;" class="tex"/>
</p>





