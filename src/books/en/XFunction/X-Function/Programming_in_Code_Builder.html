<h1 class="firstHeading">1.1.3 Programming in Code Builder</h1><p><span class="OIndex" style="display:none">X-Function, Coding in Code Builder</span>
Click on the Code Builder button <a  class="image"><img alt="Ocguide xfdialog codebuilderbutton.png" src="../images/Programming_in_Code_Builder/Ocguide_xfdialog_codebuilderbutton.png?v=77104" width="23"  /></a> to  open the X-Function in Code Builder, where we can write our Origin C code.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Editor_Window"><span class="tocnumber">1</span> <span class="toctext">Editor Window</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Include_Header_Files"><span class="tocnumber">2</span> <span class="toctext">Include Header Files</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Search_Paths"><span class="tocnumber">2.1</span> <span class="toctext">Search Paths</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#X-Function.2C_Auto_Compile_Dependent_FilesAuto_Compile_Dependent_Files"><span class="tocnumber">2.2</span> <span class="toctext"><span class="OIndex" style="display:none">X-Function, Auto Compile Dependent Files</span>Auto Compile Dependent Files</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="#X-Function.2C_Add_Internal_FunctionsDefine_Internal_Functions"><span class="tocnumber">3</span> <span class="toctext"><span class="OIndex" style="display:none">X-Function, Add Internal Functions</span>Define Internal Functions</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#X-Function.2C_Main_FunctionMain_Function"><span class="tocnumber">4</span> <span class="toctext"><span class="OIndex" style="display:none">X-Function, Main Function</span>Main Function</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#X-Function.2C_Event_Handling_FunctionsEvent_Handling_Functions"><span class="tocnumber">5</span> <span class="toctext"><span class="OIndex" style="display:none">X-Function, Event Handling Functions</span>Event Handling Functions</span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="#before_executeX-Function.2C_before_execute"><span class="tocnumber">5.1</span> <span class="toctext">before_execute<span class="OIndex" style="display:none">X-Function, before_execute</span></span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#make_treeX-Function.2C_make_tree"><span class="tocnumber">5.2</span> <span class="toctext">make_tree<span class="OIndex" style="display:none">X-Function, make_tree</span></span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#event1_and_event1_ex"><span class="tocnumber">5.3</span> <span class="toctext">event1 and event1_ex</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#X-Function.2C_Event_Handler_Functions_in_Preview_DialogGetNGraphPreview_Event_Handler_Functions"><span class="tocnumber">5.4</span> <span class="toctext"><span class="OIndex" style="display:none">X-Function, Event Handler Functions in Preview Dialog</span>GetNGraphPreview Event Handler Functions</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#X-Function.2C_Event_Handler_Functions_in_Image_DialogGetNImageBox_Event_Handler_Functions"><span class="tocnumber">5.5</span> <span class="toctext"><span class="OIndex" style="display:none">X-Function, Event Handler Functions in Image Dialog</span>GetNImageBox Event Handler Functions</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-13"><a href="#X-Function.2C_Error_HandlingError_Handling"><span class="tocnumber">6</span> <span class="toctext"><span class="OIndex" style="display:none">X-Function, Error Handling</span>Error Handling</span></a>
<ul>
<li class="toclevel-2 tocsection-14"><a href="#X-Function.2C_Display_Error_Message_on_DialogDisplay_an_Error_Message_in_the_Dialog"><span class="tocnumber">6.1</span> <span class="toctext"><span class="OIndex" style="display:none">X-Function, Display Error Message on Dialog</span>Display an Error Message in the Dialog</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="#X-Function.2C_Output_Error_MessageOutput_Error_Message"><span class="tocnumber">6.2</span> <span class="toctext"><span class="OIndex" style="display:none">X-Function, Output Error Message</span>Output Error Message</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="Editor_Window"></a><span class="mw-headline">Editor Window</span></h2>
<p>There are two buttons near the top of the editor window: a Compile button<a  class="image"><img alt="Ocguide XF Compile Button.PNG" src="../images/Programming_in_Code_Builder/Ocguide_XF_Compile_Button.PNG?v=77099" width="92"  /></a> and a Return to Dialog button<a  class="image"><img alt="Ocguide XF Returntodialog Button.PNG" src="../images/Programming_in_Code_Builder/Ocguide_XF_Returntodialog_Button.PNG?v=77108" width="92"  /></a>.  The Compile button is used to compile your X-Function's Origin C code.  The Return to Dialog button will close the editor window and return you to the X-Function Builder dialog.
</p><p>In the editor you will notice some of the Origin C code has a gray background.  These parts of the code are read-only and cannot be changed.  The X-Function framework generated these parts of the code and they are in a required syntax.
</p>
<h2><a name="Include_Header_Files"></a><span class="mw-headline">Include Header Files</span></h2>
<p>You can include additional header files in your X-Function's Origin C code.  While not required, it is recommended that you include your additional header files near the top of the file, after the following line:
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">//put additional include files here</span></pre>
<p>This recommendation is to help keep the file organized and to be consistent with other X-Functions.
</p>
<h3><a name="Search_Paths"></a><span class="mw-headline">Search Paths</span></h3>
<p><span class="OIndex" style="display:none">X-Function, Include Header Files</span>When you include files using the &lt; and &gt; brackets, then those files are included from the Origin C System folder located in the Origin installation folder.  You can still provide a relative path to move above the System folder.  These brackets behave the same when compiling .c and .cpp files in Origin C.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Include fft_utils.h located in the &quot;OriginC\System&quot; folder.</span>
<span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>fft_utils.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span>

<span style="color: #008000;">// Include abffiles.h located in the &quot;OriginC\OriginLab&quot; folder</span>
<span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>..\OriginLab\abffiles.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span> <span style="color: #008000;">// relative path</span></pre>
<p>When you include files using double quotes, then those files are included from the "OriginC\X-Functions" folder in your "User Files" folder.  This behavior is different than when you compile a .c or .cpp file in Origin C.  This different behavior is necessary because X-Functions are installed in a location maintained by Origin.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Include myOtherHeader.h located in the &quot;OriginC\X-Functions&quot;</span>
<span style="color: #008000;">// folder of the &quot;User Files&quot; folder.</span>
<span style="color: #0000ff;">#include</span> <span style="color: #ff00ff;">&quot;myOtherHeader.h&quot;</span></pre>
<p>If you specify an absolute path between double quotes, then that file will be included regardless of where the file is located.
</p>
<h3><a name="X-Function.2C_Auto_Compile_Dependent_FilesAuto_Compile_Dependent_Files"></a><span class="mw-headline"><span class="OIndex" style="display:none">X-Function, Auto Compile Dependent Files</span>Auto Compile Dependent Files</span></h3>
<p>In X-Function Builder's Tree View there is an option named Auto Compile Dependent Files.  When this option is turned on it will cause the compiler to check for a .c or .cpp file sharing a name with an included .h file.  If a .c or .cpp file is found then it will be loaded and compiled too.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Include graph_utils.h located in the &quot;OriginC\Originlab&quot; folder</span>
<span style="color: #008000;">// If Auto Compile Dependent Files is turned on</span>
<span style="color: #008000;">// then graph_utils.c, located in the same folder, will be loaded and compiled</span>
<span style="color: #0000ff;">#include</span> <span style="color: #000080;">&lt;</span>..\Originlab\graph_utils.<span style="color: #000000;">h</span><span style="color: #000080;">&gt;</span></pre>
<h2><a name="X-Function.2C_Add_Internal_FunctionsDefine_Internal_Functions"></a><span class="mw-headline"><span class="OIndex" style="display:none">X-Function, Add Internal Functions</span>Define Internal Functions</span></h2>
<p>In order to provide more clarity and readability, to make your code easier for future understanding and maintenance, it is recommended that you break a long function into functionally independent and well-structured short functions, which is also proposed in some other programming languages. In an X-Function, you can add these short functions in as internal functions with the keyword <i>static</i> after the following line.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">//put your own support static functions here</span></pre>
<p>For example, in many X-Functions with lots of interaction from the GUI, many codes will be needed in <i>xfname</i>_event1( ), and then you can add a static function, similiar to Origin's interp1 X-Function. 
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> _update_method_show<span style="color: #000000;">&#40;</span>TreeNode<span style="color: #000040;">&amp;</span> trGetN<span style="color: #000000;">&#41;</span></pre>
<p>As you can see, it is also recommended that you use an underscore to separate the components in a function name.
</p>
<h2><a name="X-Function.2C_Main_FunctionMain_Function"></a><span class="mw-headline"><span class="OIndex" style="display:none">X-Function, Main Function</span>Main Function</span></h2>
<p>The main function is where you put all the code that performs the primary tasks of your X-Function.
</p><p>Your X-Function's main function will have the same name you gave your X-Function in X-Function Builder.  For example, if you named your X-Function <b>myXFunc</b> then the main function will also be named <b>myXFunc</b>.
</p><p>The arguments passed to the main function are the variables listed in the X-Function Builder dialog.  All the variables set as Input are passed in as constant references while the variables set as Output or Input/Output are passed in as writable references.
</p>
<h2><a name="X-Function.2C_Event_Handling_FunctionsEvent_Handling_Functions"></a><span class="mw-headline"><span class="OIndex" style="display:none">X-Function, Event Handling Functions</span>Event Handling Functions</span></h2>
<p>Your X-Function's source code contains functions used for handling various events.  The name of each event handler function is prefixed with the X-Function's name followed by an underscore character followed by the event name.  For example; if your X-Function's name is <b>myXFunc</b> then the <b>before_execute</b> event handler function will be named <b>myXFunc_before_execute</b>.
</p><p>The following is a list of events:
</p>
<ul><li> before_execute</li>
<li> event1</li>
<li> event1_ex</li>
<li> make_tree</li></ul>
<p>By default all the event handler functions are empty.  You only need to add code to an event handler function when you want to change the default behavior or do some additional processing during an event.
</p><p>The following sections provide more details about each of the event handler functions including their purpose, parameters passed in, and return type.
</p>
<h3><a name="before_executeX-Function.2C_before_execute"></a><span class="mw-headline">before_execute<span class="OIndex" style="display:none">X-Function, before_execute</span></span></h3>
<p>This function will be called before execution of the main function and will be called two or three times.
</p><p><b>Prototype</b> 
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">void</span> xfname_before_execute<span style="color: #000000;">&#40;</span>TreeNode<span style="color: #000040;">&amp;</span> trGetN, <span style="color: #0000ff;">int</span> nGetNDialog, <span style="color: #0000ff;">int</span><span style="color: #000040;">&amp;</span> nRet, <span style="color: #0000ff;">int</span> dwCntrl<span style="color: #000000;">&#41;</span></pre>
<p><b>Parameters</b>
</p><p><u>trGetN</u>
</p><p>A TreeNode containing the variables passed to the X-Function.
</p><p><u>nGetNDialog</u>
</p><p>An integer value indicating when the function is being called.
</p><p>A value greater than zero indicates the function is being called before showing its dialog.  This happens when choosing <b>Open Dialog</b> from a menu, programmatically calling the X-Function with the <b>-d</b> option, or choosing <b>Change Parameters</b> for a manual recalculate.
</p>
<table class="simple">
<tr>
<th>Value
</th>
<th>Before Opening Dialog for...
</th></tr>
<tr>
<td>1
</td>
<td>Simple GetNBox
</td></tr>
<tr>
<td>2
</td>
<td>GetNGraphBox with Preview
</td></tr>
<tr>
<td>3
</td>
<td>GetNImageBox
</td></tr></table>
<p>A value of -1 indicates the dialog was closed by the user clicking the OK button.
</p><p>A value of zero indicates the main function is about to be called.
</p><p><u>nRet</u>
</p><p>This option can control the execution states of the X-Function.
</p>
<pre class="oc" style="font-family:monospace;">XFEVT_PROCEED         <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span> <span style="color: #008000;">// Follow with normal execution</span>
XFEVT_ABORT           <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span> <span style="color: #008000;">// Abort execution</span>
XFEVT_PROCEED_NO_DLG  <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span> <span style="color: #008000;">// Execute silently without opening dialog.</span></pre>
<p><u>dwCntrl</u>
</p><p>This option can be used to determine how this X-Function is accessed. Possible values are enumerated as:
</p>
<pre class="oc" style="font-family:monospace;">LTXF_FROM_GUI_MENU              <span style="color: #008000;">// Accessed from menu</span>
LTXF_FROM_GUI_PROMPT            <span style="color: #008000;">// Accessed from command window</span>
LTXF_FROM_AUTO_UPDATE           <span style="color: #008000;">// Accessed for Auto-update</span>
LTXF_FROM_FUNCTION              <span style="color: #008000;">// Accessed from Origin C function</span>
LTXF_THEME_USED                 <span style="color: #008000;">// Theme is used</span>
LTXF_CHANGE_PARAM               <span style="color: #008000;">// Accessed for Change Parameters</span></pre>
<p>The following example shows how to check if the X-Function is accessed from the command window and a theme is also used (type <b><i>xfname</i> -t <i>themename</i></b> in the command window). 
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span><span style="color: #000040;">!</span><span style="color: #000000;">&#40;</span>dwCntrl <span style="color: #000040;">&amp;</span> LTXF_FROM_GUI_PROMPT<span style="color: #000000;">&#41;</span> <span style="color: #000040;">&amp;&amp;</span> <span style="color: #000000;">&#40;</span>dwCntrl <span style="color: #000040;">&amp;</span> LTXF_THEME_USED<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    <span style="color: #008000;">// handle this case</span>
<span style="color: #000000;">&#125;</span></pre>
<h3><a name="make_treeX-Function.2C_make_tree"></a><span class="mw-headline">make_tree<span class="OIndex" style="display:none">X-Function, make_tree</span></span></h3>
<p>This function is called once for each TreeNode variable passed to the X-Function.  The calls occur before the <b>before_execute</b> function is called.
</p><p><b>Prototype</b>
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">int</span> xfname_make_tree<span style="color: #000000;">&#40;</span>TreeNode<span style="color: #000040;">&amp;</span> tr, LPCSTR lpcszVarName<span style="color: #000000;">&#41;</span></pre>
<p><b>Return</b>
</p><p>Return zero to update the dialog or -1 to not update the dialog.  The default behavior returns -1.
</p><p><b>Parameters</b>
</p><p><u>tr</u>
</p><p>The TreeNode to be created, which should have been defined as an input TreeNode type variable of the X-Function.
</p><p><u>lpcszVarName</u>
</p><p>The name of the TreeNode variable.
</p>
<h3><a name="event1_and_event1_ex"></a><span class="mw-headline">event1 and event1_ex</span></h3>
<p><span class="OIndex" style="display:none">X-Function, event1</span>These are the primary event handling functions.  They will be called by any event, such as dialog initialization, changes to any settings in the dialog, button clicking, and more.  These functions are only used in X-Functions with a simple GetN dialog.  X-Functions with a graph preview or an image preview use a different set of event handler functions and are discussed in a later section.
</p><p><b>Prototype</b> 
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">int</span> xfname_event1<span style="color: #000000;">&#40;</span>TreeNode<span style="color: #000040;">&amp;</span> trGetN, <span style="color: #0000ff;">int</span> nRow, <span style="color: #0000ff;">int</span> nEventID, DWORD<span style="color: #000040;">&amp;</span> dwEnables,
    LPCSTR lpcszNodeName, WndContainer<span style="color: #000040;">&amp;</span> DynaCntrlContainer,
    string<span style="color: #000040;">&amp;</span> strAux, string<span style="color: #000040;">&amp;</span> strErrMsg<span style="color: #000000;">&#41;</span></pre>
<p><b>Return</b>
</p><p>If returning true, the dialog will be updated.
</p><p><b> Parameters</b>
</p><p><u>trGetN</u>
</p><p>This is the tree node of the variables defined in the X-Function.
</p><p><u>nRow</u>
</p><p>The index of the row of the value-changed control node in TreeNode <i>trGetN</i>. The value will be -1 when the event is not 'control value changed'.
</p><p><u>nEventID</u>
</p><p>Event type ID. For example, GETNE_ON_INIT, GETNE_ON_THEME.
</p><p><u>dwEnables</u>
</p><p>This parameter is used to enable or disable the OK, Apply or other custom button. It is true by default, and will usually be set to false when the user's settings are invalid, so as to disable the OK or Apply button.
</p><p><u>lpcszNodeName</u>
</p><p>If the event is generated by a control change in the dialog, it will be the variable name of this control. Otherwise, it will be an empty string.
</p><p><u>DynaCntrlContainer</u>
</p><p>X-Function dialog window container.
</p><p><u>strAux</u>
</p><p>This parameter is the auxiliary string, which is for advanced usage. Please refer to the header file &lt;Origin Installation Directory&gt;\OriginC\System\GetNBox.h for more details like the following definition.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">#define</span> DLG_NEED_CHANGE_GRID <span style="color: #ff00ff;">&quot;GETN_CHANGE_GRID&quot;</span>
<span style="color: #0000ff;">#define</span> GETN_CHANGE_GRID  set_aux_value<span style="color: #000000;">&#40;</span>strAux, DLG_NEED_CHANGE_GRID<span style="color: #000000;">&#41;</span>;</pre>
<p><u>strErrMsg</u>
</p><p>This is the string message that will be shown in the bottom of the dialog. It is usually used to notify the user of any errors that occurred during the input of variable values.
</p>
<h3><a name="X-Function.2C_Event_Handler_Functions_in_Preview_DialogGetNGraphPreview_Event_Handler_Functions"></a><span class="mw-headline"><span class="OIndex" style="display:none">X-Function, Event Handler Functions in Preview Dialog</span>GetNGraphPreview Event Handler Functions</span></h3>
<p>The <b>event1</b> and <b>event1_ex</b> event handler functions are not used by X-Functions that have a graph preview dialog.  Instead you use the <b>GetNGraphPreview</b> functions.
</p>
<ul><li> GetNGraphPreview_OnInitGrid</li></ul>
<dl><dd>This event function is used to initialize the controls on the dialog. </dd></dl>
<ul><li>GetNGraphPreview_OnInitGraph</li></ul>
<dl><dd>This event function is used to initialize the preview graph.</dd></dl>
<ul><li> GetNGraphPreview_OnUpdateGraph</li></ul>
<dl><dd>This event function is used to update the preview graph on other events, for example, GUI changed.</dd></dl>
<ul><li> GetNGraphPreview_OnChange</li></ul>
<dl><dd>Any change will trigger this event function, and this function will decide whether to update the preview graph or update the dialog on this change.</dd></dl>
<ul><li> GetNGraphPreview_OnDialogSetup</li></ul>
<ul><li> GetNGraphPreview_OnDestroy</li></ul>
<ul><li> GetNGraphPreview_OnCustomButton</li></ul>
<p><br />
See the <b><a href="../../XFunction/X-Function/Creating_Graph_Preview_GetN_Dialog.html" title="X-Function:Creating Graph Preview GetN Dialog">Creating Graph Preview GetN Dialog</a></b> section for an example of how to create an X-Function with a graph preview dialog.
</p>
<h3><a name="X-Function.2C_Event_Handler_Functions_in_Image_DialogGetNImageBox_Event_Handler_Functions"></a><span class="mw-headline"><span class="OIndex" style="display:none">X-Function, Event Handler Functions in Image Dialog</span>GetNImageBox Event Handler Functions</span></h3>
<p>The <b>event1</b> and <b>event1_ex</b> event handler functions are not used by X-Functions that have an image preview dialog.  Instead you use the <b>GetNImageBox</b> functions.
</p>
<ul><li> GetNImageBox_OnInit</li></ul>
<dl><dd> The event function called when the image GetN dialog is open. The function can decide whether to update the dialog, enable/disable the OK button or show an error message on the bottom of the dialog after calling.</dd></dl>
<ul><li> GetNImageBox_OnChange</li></ul>
<dl><dd> The event function called whenever any control on the dialog is modified by the user. This function can decide whether to update the dialog, update the image preview, enable/disable the OK button, or show an error message on the bottom of the dialog.</dd></dl>
<p>See the <b><a href="../../XFunction/X-Function/Creating_Image_GetN_Dialog.html" title="X-Function:Creating Image GetN Dialog">Creating Image GetN Dialog</a></b> section for an example of how to create an X-Function with an image preview dialog.
</p>
<h2><a name="X-Function.2C_Error_HandlingError_Handling"></a><span class="mw-headline"><span class="OIndex" style="display:none">X-Function, Error Handling</span>Error Handling</span></h2>
<h3><a name="X-Function.2C_Display_Error_Message_on_DialogDisplay_an_Error_Message_in_the_Dialog"></a><span class="mw-headline"><span class="OIndex" style="display:none">X-Function, Display Error Message on Dialog</span>Display an Error Message in the Dialog</span></h3>
<p>When a user passes a bad value to your X-Function and also passes the <b>-d</b> option, or enters a bad value in the X-Function's dialog, you can display an error message in the dialog by setting the strErrMsg argument passed into the event handler function.
</p><p>Which event handler function is called depends on the GetN Dialog your X-Function uses.
</p>
<table class="simple">
<tr>
<th>GetN Dialog Used
</th>
<th>Event Handler Function
</th></tr>
<tr>
<td>Simple GetNBox
</td>
<td>xfname_event1
</td></tr>
<tr>
<td>GetNGraphBox with Preview
</td>
<td>GetNGraphPreview_OnChange
</td></tr>
<tr>
<td>GetNImageBox
</td>
<td>GetNImageBox_OnChange
</td></tr></table>
<p>Let us assume we have an X-Function that accepts an integer variable named <b>x1</b>.  The following code snippet, inserted into the appropriate event handler function, checks the <b>x1</b> variable's value to see if it is less than zero or greater than 100.  If it is then it sets the strErrMsg to an appropriate message to display in the dialog, and also disables the OK button.  If the value is within the accepted range then it simply makes sure the OK button is enabled.
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> trGetN.<span style="color: #000000;">x1</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">&lt;</span> <span style="color: #0000dd;">0</span> <span style="color: #000040;">||</span> <span style="color: #0000dd;">100</span> <span style="color: #000080;">&lt;</span> trGetN.<span style="color: #000000;">x1</span>.<span style="color: #000000;">nVal</span> <span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
    strErrMsg <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;x1 is out of range.  Must be from zero to 100.&quot;</span>;
    bOKEnable <span style="color: #000080;">=</span> <span style="color: #0000ff;">false</span>;
<span style="color: #000000;">&#125;</span>
<span style="color: #0000ff;">else</span>
    bOKEnable <span style="color: #000080;">=</span> <span style="color: #0000ff;">true</span>;</pre>
<h3><a name="X-Function.2C_Output_Error_MessageOutput_Error_Message"></a><span class="mw-headline"><span class="OIndex" style="display:none">X-Function, Output Error Message</span>Output Error Message</span></h3>
<p>When an X-Function is being called programmatically and its dialog is not going to be shown, then you need another way to notify the user of any errors that may occur.  Origin C has defined macros to output an error message to the Results Log, Command Window or Script Window.  It is strongly recommended that you use these macros instead of out_str or printf.
</p><p>The <span class="OIndex">XF_WARN macros</span><span class="OIndex" style="display:none">X-Function, Output Warning Message</span> are used to output warning messages and do not terminate execution.  All three macros accept a string as the first argument, containing the warning message.  The two macros that accept additional arguments assume the warning message is also a format string for outputting one or two values.
</p>
<ul><li> XF_WARN(msg)</li>
<li> XF_WARN_EX(msg, arg1)</li>
<li> XF_WARN_EX2(msg, arg1, arg2)</li></ul>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Assume the following:</span>
<span style="color: #008000;">// #define MIN_DATA_POINTS 5</span>
<span style="color: #008000;">// int nNumPts = 3;</span>
<span style="color: #008000;">// string strWksName = &quot;Book1&quot;;</span>
XF_WARN<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Too few data points.&quot;</span><span style="color: #000000;">&#41;</span>;
XF_WARN_EX<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Number of data points less than&#160;%d.&quot;</span>, MIN_DATA_POINTS<span style="color: #000000;">&#41;</span>;
XF_WARN_EX<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Worksheet named&#160;%s was not found.&quot;</span>, strWksName<span style="color: #000000;">&#41;</span>;
XF_WARN_EX2<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Only&#160;%d data points, need at least&#160;%d.&quot;</span>, nNumPts, MIN_DATA_POINTS<span style="color: #000000;">&#41;</span>;</pre>
<p>The <span class="OIndex">XF_TRACE macro</span> is similar to the XF_WARN macros in that it does not terminate execution.  It also takes a message for the first argument, but it allows any number of additional arguments.
</p>
<ul><li> XF_TRACE(msg, ...)</li></ul>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Assume the following:</span>
<span style="color: #008000;">// #define MIN_DATA_POINTS 5</span>
<span style="color: #008000;">// int nNumPts = 3;</span>
<span style="color: #008000;">// string strWksName = &quot;Book1&quot;;</span>
XF_TRACE<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Only&#160;%d data points found in&#160;%s, need at least&#160;%d.&quot;</span>,
    nNumPts, strWksName, MIN_DATA_POINTS<span style="color: #000000;">&#41;</span>;</pre>
<p>The <span class="OIndex">XF_THROW macros</span><span class="OIndex" style="display:none">X-Function, Handle Runtime Error</span> terminate execution, but everything else about them is the same as the XF_WARN macros.  All three macros accept a string containing the warning message as the first argument.  The two macros that accept additional arguments assume the warning message is also a format string for outputting one or two values.
</p>
<ul><li> XF_THROW(msg)</li>
<li> XF_THROW_EX(msg, arg1)</li>
<li> XF_THROW_EX2(msg, arg1, arg2)</li></ul>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">// Assume the following:</span>
<span style="color: #008000;">// #define MIN_DATA_POINTS 5</span>
<span style="color: #008000;">// int nNumPts = 3;</span>
<span style="color: #008000;">// string strWksName = &quot;Book1&quot;;</span>
XF_THROW<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Too few data points.&quot;</span><span style="color: #000000;">&#41;</span>;
XF_THROW_EX<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Number of data points less than&#160;%d.&quot;</span>, MIN_DATA_POINTS<span style="color: #000000;">&#41;</span>;
XF_THROW_EX<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Worksheet named&#160;%s was not found.&quot;</span>, strWksName<span style="color: #000000;">&#41;</span>;
XF_THROW_EX2<span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Only&#160;%d data points, need at least&#160;%d.&quot;</span>, nNumPts, MIN_DATA_POINTS<span style="color: #000000;">&#41;</span>;</pre>






