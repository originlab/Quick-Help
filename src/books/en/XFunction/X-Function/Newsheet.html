<h1 class="firstHeading">2.2.22 newsheet</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Brief_Information"><span class="tocnumber">1</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Command_Line_Usage"><span class="tocnumber">2</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#X-Function_Execution_Options"><span class="tocnumber">3</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Variables"><span class="tocnumber">4</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Description"><span class="tocnumber">5</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Examples"><span class="tocnumber">6</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Related_X-Functions"><span class="tocnumber">7</span> <span class="toctext">Related X-Functions</span></a></li>
</ul>
</div>

<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Add a new sheet to workbook or matrix book
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
1. newsheet name:="ASCII Data"; 
</p><p>2. newsheet cols:=6 xy:="XYE"; 
</p><p>3. newsheet labels:="This is 1st column|This is 2nd Column|This is 3rd Column"; 
</p><p>4. newsheet book:=Book1 template:=fft;
</p><p>5. newsheet n:="my test" c:=5 r:=1000 xy:=Y o:=sname$ a:=0;//5x1000 sheet without activating
</code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Workbook to Add Sheet
</td>
<td>book
</td>
<td>
<p>Input
</p><p>Page
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td>
<p>Specifies the book to add a new sheet. The default is the active book.
</p>
</td></tr>
<tr>
<td>Desired Sheet Name
</td>
<td>name
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>"Sheet1"</center>
</td>
<td>
<p>Specifies the desired name for the new sheet.
</p>
</td></tr>
<tr>
<td>Column Labels
</td>
<td>labels
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>""</center>
</td>
<td>
<p>Specifies the long names of the columns in the new sheet. If there are multiple columns, the long names should be separated with "|".
</p>
</td></tr>
<tr>
<td>Number of Columns
</td>
<td>cols
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>-1</center>
</td>
<td>
<p>Specifies the number of columns in the new sheet.
</p>
</td></tr>
<tr>
<td>Number of Rows
</td>
<td>rows
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>-1</center>
</td>
<td>
<p>Specifies the number of rows in the new sheet.
</p>
</td></tr>
<tr>
<td>Set Column Designations
</td>
<td>xy
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>""</center>
</td>
<td>
<p>Specifies the column designations for all data columns. For example, if you enter XY, the plot designations of the columns will be set to the repeating pattern of "YXYXY...". In this string, each character corresponds to the designation of one column, as shown below:
</p><p>'X' - X
</p><p>'Y' - Y
</p><p>'Z' - Z
</p><p>'E' - Y Error
</p><p>'L' - Label
</p><p>'M' - X Error
</p><p>'N' - Disregard
</p>
</td></tr>
<tr>
<td>Template
</td>
<td>template
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>"origin"</center>
</td>
<td>
<p>Specifies the template that will be used for creating the new sheet.
</p>
</td></tr>
<tr>
<td>Use if sheet existed
</td>
<td>use
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>If this variable is set to 1 and an existing sheet has the desired sheet name, the X-Function will not create a new sheet. If this variable is set to 0, a new sheet will be created even if a sheet with the desired name is found.
</p>
</td></tr>
<tr>
<td>Sheet in template
</td>
<td>sheet
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>""</center>
</td>
<td>
<p>Specifies the name of the sheet to use when the template has multiple sheets.
</p>
</td></tr>
<tr>
<td>Actual Sheet Name
</td>
<td>outname
</td>
<td>
<p>Output
</p><p>string
</p>
</td>
<td> <center>sname$</center>
</td>
<td>
<p>Specifies the output for the actual sheet name.
</p>
</td></tr>
<tr>
<td>New Matrix Sheet
</td>
<td>mat
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>Specifies whether or not the new sheet is a matrix sheet. By default, this is set to false and this X-Function adds a workbook sheet.
</p>
</td></tr>
<tr>
<td>Activate New Sheet
</td>
<td>active
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td>
<p>Activate the new sheet.
</p>
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>The newsheet function adds a new sheet to a specified workbook/matrix book.
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// New sheets can be created along with named columns</span>
<span style="color: #008000;">// If the active window is not a Workbook, create one</span>
if<span style="color: #000000;">&#40;</span> exist<span style="color: #000000;">&#40;</span><span style="color: #000080;">%</span>H<span style="color: #000000;">&#41;</span> <span style="color: #000080;">!</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span> <span style="color: #000000;">&#41;</span> newbook;
<span style="color: #008000;">// Get the name of the active Workbook</span>
string name<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> page.<span style="color: #000080;">name</span><span style="color: #000080;">$</span>;
<span style="color: #008000;">// Create an extra workbook to show that command can specify target book</span>
newbook;
<span style="color: #008000;">// Repeat this command 8 times</span>
<span style="color: #008000;">// use:=0 will force enumeration of sheet names</span>
repeat <span style="color: #0000dd;">8</span> <span style="color: #000000;">&#123;</span>
   newsheet book<span style="color: #000000;">:</span><span style="color: #000080;">=</span>name<span style="color: #000080;">$</span> name<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Week 1&quot;</span> labels<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Time|Monday|Tuesday|Wednesday|Thursday|Friday&quot;</span> rows<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">24</span> xy<span style="color: #000000;">:</span><span style="color: #000080;">=</span>XYYYYY active<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> use<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;
<span style="color: #000000;">&#125;</span>
<span style="color: #008000;">// Switch to the Workbook we were modifying</span>
win <span style="color: #000080;">-</span>a <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>name<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// and make the fourth sheet we created active</span>
page.<span style="color: #000080;">active</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;Week 4&quot;</span>;</pre>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">Related X-Functions</span></h2>
<p><a href="../../XFunction/X-Function/Newbook.html" title="X-Function:Newbook">newbook</a>
</p>





