<h1 class="firstHeading">2.16.3.22 Details of TreeNodes in Import MSExcel</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Options"><span class="tocnumber">1</span> <span class="toctext">Options</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Names"><span class="tocnumber">1.1</span> <span class="toctext">Names</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Headers"><span class="tocnumber">1.2</span> <span class="toctext">Headers</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Partials"><span class="tocnumber">1.3</span> <span class="toctext">Partials</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Scripts"><span class="tocnumber">1.4</span> <span class="toctext">Scripts</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="Options"></a><span class="mw-headline">Options</span></h2>
<p>The <b>Options</b> tree specifies all import options for the <b>impMSExcel</b> X-Function.
</p><p>Syntax:  <b>Options.<i>.Treenode</i>:=&lt;value&gt;</b>
</p><p>Example: 
</p>
<dl><dd> <b>Options.sparklines:=1</b> <br /> </dd>
<dd> <b>Options.ColDesignations:=3(XYZ)</b> </dd></dl>
<table class="treetable">
<tr>
<th> Treenode
</th>
<th> Label
</th>
<th> Type
</th>
<th> Default
</th>
<th> Description
</th></tr>
<tr>
<td>FirstMode
</td>
<td>1st File Import Mode
</td>
<td>int
</td>
<td>0
</td>
<td>Specify the import mode of the first imported file. Option list:
<ul><li>0: Replace Existing Data
<dl><dd>The data existing in the target window will be deleted, and the new data will be imported.</dd></dl></li>
<li>3: Start New Books
<dl><dd>Create a new book for the first file imported. </dd></dl></li>
<li>4: Start New Sheets
<dl><dd>Create a new sheet for the first file imported.</dd></dl></li>
<li>1: Start New Columns for Each Sheet
<dl><dd>Append new columns to the target worksheet for each sheet of the first imported file.</dd></dl></li>
<li>7: Start New Books for Each Sheet
<dl><dd> Import each sheet in the first Excel file into a new book.</dd></dl></li></ul>
</td></tr>
<tr>
<td>Mode
</td>
<td>Multi-File (except 1st) Import Mode
</td>
<td>int
</td>
<td>3
</td>
<td>Specify the import mode of files except the 1st one. Option list:
<ul><li>3: Start New Books
<dl><dd>Create a new book for the file that that will be imported. </dd></dl></li>
<li>4: Start New Sheets
<dl><dd>Create a new sheet for the file that will be imported.</dd></dl></li>
<li>1: Start New Columns for Each Sheet
<dl><dd>Append new columns to the target worksheet for the imported file.</dd></dl></li>
<li>7: Start New Books for Each Sheet
<dl><dd> Import each sheet in file(s) following the first Excel file, into a new book.</dd></dl></li></ul>
</td></tr>
<tr>
<td>PageTemplate
</td>
<td>Template Name
</td>
<td>String
</td>
<td>&lt;default&gt;
</td>
<td>Specify the template to import the file to a new book or new sheet.  This option is available when the <b>Import Mode</b> is set to <b>Replace Existing Data</b>, <b>Start New Sheets</b> or <b>Start New Books</b>. By default, an Origin prototype workbook template <i><b>&lt;default&gt;</b></i> is used. A special template named <i><b>&lt;clone&gt;</b></i> is also available from the drop-down list which uses active workbook as the template to import files into the duplications of current worksheet/workbook.
</td></tr>
<tr>
<td>ColDesignations
</td>
<td>Column Designations
</td>
<td>string
</td>
<td>
</td>
<td>Specify the <a class="external text" href="../../UserGuide/UserGuide/Set_Column_Designation.html">plot designations</a>. Refer to <a class="external text" href="../../UserGuide/UserGuide/Set_Column_Designation.html#Set_Designation_During_Data_Importing">this help page</a> for more details of column designation syntax (including as how to repeat designations). The specified column designation will be applied to all imported sheets automatically.
</td></tr>
<tr>
<td>sparklines
</td>
<td>Add Sparklines
</td>
<td>int
</td>
<td>1
</td>
<td>Specify whether to add sparklines for the data. Option list:
<ul><li>0: No
<dl><dd>Do not add sparklines.</dd></dl></li>
<li>1: Yes
<dl><dd>Add sparklines.</dd></dl></li>
<li>2: Yes(if less than 50 columns)
<dl><dd>Add sparklines if there are less than 50 columns.</dd></dl></li></ul>
</td></tr>
<tr>
<td>cellfmts
</td>
<td>Import Cell Formats
</td>
<td>int
</td>
<td>0
</td>
<td>Specify whether to import cell formats (text color, font, cell height, .etc) in the Excel file.
</td></tr>
<tr>
<td>emptycols
</td>
<td>Maximum Number of Empty Columns (-1 for all)
</td>
<td>int
</td>
<td>0
</td>
<td>Specify the maximum number of empty columns.
</td></tr>
<tr>
<td>excludeempty
</td>
<td>Exclude Empty Sheets
</td>
<td>int
</td>
<td>1
</td>
<td>Specifies whether input the empty sheets into target window. If it is chekced, empty sheets will not appear in the <b>File Sheet(s)</b> branch in the <b>File Info</b> branch.
</td></tr>
<tr>
<td>sheet
</td>
<td>Note that this tree node is hidden from the GUI
</td>
<td>string
</td>
<td>
</td>
<td>Specify the Excel sheets to import. Use colons (":") to divide the sheet names or indexes. See <a href="../../XFunction/X-Function/ImpExcel.html#Examples" title="X-Function:ImpExcel">Example 3</a>.
</td></tr>
<tr>
<td>allsheets
</td>
<td>Apply Header to All Sheets
</td>
<td>int
</td>
<td>0
</td>
<td>Specify whether apply the header settings to all Excel sheets.
</td></tr></table>
<h3><a name="Names"></a><span class="mw-headline">Names</span></h3>
<p>The <b>Names</b> branch of the <b>Options</b> tree specifies how to name the worksheet and workbook.
</p><p>Syntax: <b>Options.Names.Treenode:= &lt;<i>value</i>&gt;</b>
</p><p>Example: <br />
//Rename workbook with partial filename &#160;: <br />
<b>Options.Names.FNameToBk:=1</b> <br />  
<b>Options.Names.FNameToBkFrom:=1</b> <br />   
<b>Options.Names.FNameToBkTo:=4</b> <br />  
</p>
<table class="treetable">
<tr>
<th> Treenode
</th>
<th> Label
</th>
<th> Type
</th>
<th> Default
</th>
<th> Description
</th></tr>
<tr>
<td>AutoNames
</td>
<td>Auto Rename using file name
</td>
<td>int
</td>
<td>0
</td>
<td>If it is checked, Origin will use the default settings to rename the worksheet and workbook name, which is using the whole filename (includes the file extension) as workbook name.
</td></tr>
<tr>
<td>RenameSht
</td>
<td>Rename Sheet with
</td>
<td>int
</td>
<td>1
</td>
<td>Specify use what to rename Origin worksheet, None = 0, Excel Sheet Name = 1, Excel File Name = 2, Excel File and Sheet Name = 3.
</td></tr>
<tr>
<td>FNameToBk
</td>
<td>Rename Book with (Partial) Filename
</td>
<td>int
</td>
<td>1
</td>
<td>Enable this to use part of the file name as the workbook name.
</td></tr>
<tr>
<td>FNameToBkFrom
</td>
<td>Trim Filename From
</td>
<td>int
</td>
<td>1
</td>
<td>Specify the start of the name.
</td></tr>
<tr>
<td>FNameToBkTo
</td>
<td>Trim Filename To
</td>
<td>int
</td>
<td>0
</td>
<td>Specify the end of the name.
</td></tr>
<tr>
<td>FNameToBkLnOnly
</td>
<td>Rename Long Name for Book only
</td>
<td>int
</td>
<td>0
</td>
<td>Check this to rename the long name for book only.
</td></tr>
<tr>
<td>FPathToBk
</td>
<td>Include File Path when Renaming Book
</td>
<td>int
</td>
<td>0
</td>
<td>Specify if the file path should be included for the workbook name.
</td></tr>
<tr>
<td>FNameToBkComm
</td>
<td>Append Filename to Workbook Comment
</td>
<td>int
</td>
<td>1
</td>
<td>Specify if the filename should be appended to the workbook comment.
</td></tr>
<tr>
<td>FNameToWksComm
</td>
<td>Append Filename to Worksheet Comment
</td>
<td>int
</td>
<td>0
</td>
<td>Specify if the filename should be appended to the worksheet comment.
</td></tr>
<tr>
<td>FNameToColComm
</td>
<td>Append Filename to Column Comment
</td>
<td>int
</td>
<td>0
</td>
<td>Specify if the filename should be appended to the column comment.
</td></tr>
<tr>
<td>FNameToUDL
</td>
<td>Add Filename User Parameters Row
</td>
<td>int
</td>
<td>0
</td>
<td>Specify if the file name should be put to the column User Parameter row "SourceFile".
</td></tr>
<tr>
<td>FPathToComm
</td>
<td>Include File Path when Appending Filename
</td>
<td>int
</td>
<td>0
</td>
<td>When this is enabled, the import file path is included to the appended file name (so as file extension).
</td></tr>
<tr>
<td>sheetname2col
</td>
<td>Add Sheetname User Parameter Row
</td>
<td>int
</td>
<td>0
</td>
<td>Specify if the sheet name should be put to the column User Parameter row "SourceSheet".
</td></tr></table>
<table class="note">

<tr>
<td><b>Notes:</b>
<p>From Origin 8.6, minus value is supported in <b>Trim Filename From</b> and <b>Trim Filename To</b> to count the end of the name from the last character of the file name. It can be used to trim the file extension. For example, if you want to import an Excel book named <i>sample.xls</i>, you can specify as follow to trim the extension "<i>.xls</i>":
</p>
<dl><dd><b>Trim Filename From</b>: 1</dd>
<dd><b>Trim Filename To</b>: -4</dd></dl>
</td></tr></table>
<h3><a name="Headers"></a><span class="mw-headline">Headers</span></h3>
<p>The <b>Headers</b> branch of the <b>Options</b> tree specifies the header information of the imported file.
</p><p>Syntax: <b>Options.Hdr.Treenode:= &lt;<i>value</i>&gt;</b>
</p><p>Example: <br />
//Specify the 1st row of the imported file as Long Name: <br />
<b>Options.Headers.LongName:= 1;</b> <br />  
</p>
<table class="treetable">
<tr>
<th> Treenode
</th>
<th> Label
</th>
<th> Type
</th>
<th> Default
</th>
<th> Description
</th></tr>
<tr>
<td>MainHeaderLines
</td>
<td>Number of Main Header Lines(exclude subheader lines)
</td>
<td>int
</td>
<td>0
</td>
<td>Some files, particularly those generated by lab instrumentation, contain header information identfying, for example, the instrument, operator, date, and sample number. These are the main header lines. MainHeaderLines is used to specify where the main header lines are located.
</td></tr>
<tr>
<td>SubHeaderLines
</td>
<td>Number of Subheader Lines
</td>
<td>int
</td>
<td>0
</td>
<td>Specify the number of subheader lines in the file.
</td></tr>
<tr>
<td>LongName
</td>
<td>Long Name
</td>
<td>int
</td>
<td>0
</td>
<td>Specify the lines for long name.
</td></tr>
<tr>
<td>Unit
</td>
<td>Units
</td>
<td>int
</td>
<td>0
</td>
<td>Specify the line for unit.
</td></tr>
<tr>
<td>CommentFrom
</td>
<td>Comments From
</td>
<td>int
</td>
<td>0
</td>
<td>Specify the line from which the comments start.
</td></tr>
<tr>
<td>CommentTo
</td>
<td>Comments To
</td>
<td>int
</td>
<td>0
</td>
<td>Specify the line at which the comments end.
</td></tr>
<tr>
<td>ParametersFrom
</td>
<td>System Parameters From
</td>
<td>int
</td>
<td>0
</td>
<td>Specify the line from which the system parameters start.
</td></tr>
<tr>
<td>ParametersTo
</td>
<td>System Parameters To
</td>
<td>int
</td>
<td>0
</td>
<td>Specify the line at which the system parameters end.
</td></tr>
<tr>
<td>UserParametersFrom
</td>
<td>User Parameters From
</td>
<td>int
</td>
<td>0
</td>
<td>Specify the line from which the user parameters start.
</td></tr>
<tr>
<td>UserParametersTo
</td>
<td>User Parameters To
</td>
<td>int
</td>
<td>0
</td>
<td>Specify the line at which the user parameters end.
</td></tr></table>
<h3><a name="Partials"></a><span class="mw-headline">Partials</span></h3>
<p>The <b>Partials</b> branch of the <b>Options</b> tree specifies how to partially import the file.
</p><p>Syntax: <b>Options.Partials.<i>Treenode:= &lt;value&gt;</i></b>
</p><p>Example: 
</p>
<dl><dd><b>Options.Partials.Partial:=1</b>  </dd>
<dd><b>Options.Partials.FirstCol:=1</b>    </dd>
<dd><b>Options.Partials.LastCol:=3</b> </dd>
<dd><b>Options.Partials.Partial_Cols.ColRanges:="1 3 5 7:10 12:0"</b></dd></dl>
<table class="treetable">
<tr>
<th> Treenode
</th>
<th> Label
</th>
<th> Type
</th>
<th> Default
</th>
<th> Description
</th></tr>
<tr>
<td>Partial
</td>
<td>Partial Import
</td>
<td>int
</td>
<td>1
</td>
<td>Specify whether to enable partial import. Option list:
<ul><li>1: All Files
<dl><dd>Apply partial import settings to all files.</dd></dl></li>
<li>2: From 2nd File On
<dl><dd>Apply partial import settings to all files except the 1st file.</dd></dl></li></ul>
</td></tr>
<tr>
<td>FirstCol
</td>
<td>From Column
</td>
<td>int
</td>
<td>1
</td>
<td>Specify the beginning column for a partial import.
</td></tr>
<tr>
<td>LastCol
</td>
<td>To Column
</td>
<td>int
</td>
<td>0
</td>
<td>Specify the end column for a partial import. Note that "0" = last column.
</td></tr>
<tr>
<td>Partial_Cols.ColRanges
</td>
<td>Custom
</td>
<td>string
</td>
<td>&lt;optional&gt;
</td>
<td>Enter a range of columns <i>enclosed in quotes</i>, using this notation:
<p><br />
For <b>Custom</b>, use the following characters in building your import string:
</p>
<dl><dd><ul><li>spaces separate individual column or row indices.</li>
<li>colon(:) separates <b>From</b> and <b>To</b>. </li>
<li>vertical bar(|) = "read <i>n</i> cols/rows".</li>
<li>dash(-) = "skip".</li>
<li>tilde(~) = "except".</li>
<li>comma(,) = "and"</li></ul></dd>
<dd><i><b>Examples</b></i>
<dl><dd><b>1 3 7</b> import cols/rows 1,3 and 7.</dd>
<dd><b>1:100,~50:60</b> import cols/rows from 1 to 100, except 50 to 60.</dd>
<dd><b>1:200|3-2</b> import cols/rows from 1 to 200 by reading 3 then skipping 2. </dd>
<dd><b>1:1000,~200:300,250:260</b> import cols/rows 1 to 1000, skipping 200 to 300 with the exception of 250 to 260. </dd>
<dd><b>1:100|3-7,5:100|2-8</b> imports cols/rows 1 to 100, read 3 then skip 7 AND import cols/rows 5 to 100, read 2 then skip 8. The "AND" combination generates a repeating pattern of read 3, skip 1, read 2, skip 4 for every 10 cols/rows. </dd></dl></dd></dl>
</td></tr>
<tr>
<td>FirstRow
</td>
<td>From Row
</td>
<td>int
</td>
<td>1
</td>
<td>Specify the start row for a partial import.
</td></tr>
<tr>
<td>LastRow
</td>
<td>To Row
</td>
<td>int
</td>
<td>0
</td>
<td>Specify the end row for a partial import. Note that "0" = last row.
</td></tr>
<tr>
<td>Partial_Rows.RowRanges
</td>
<td>Custom
</td>
<td>string
</td>
<td>&lt;optional&gt;
</td>
<td>See partial_cols.ColRanges
</td></tr></table>
<h3><a name="Scripts"></a><span class="mw-headline">Scripts</span></h3>
<p>The <b>Scripts</b> branch of the <b>Options</b> tree specifies the LabTalk scripts to run after file(s) being imported.
</p><p>Syntax: <b>options.scripts.Treenode:= &lt;<i>string</i>&gt;</b>
</p><p>Example: <br />
//Plot second column for each imported file &#160;: <br />
<b>options.scripts.ScriptAfterEachImport:="plotxy 2;";</b> <br />  
</p><p>//When all files being imported, loop over all worksheets in all workbooks and delete first 500 rows from column 1 to column 4.
<br />
<b>options.scripts.ScriptAfterAllImport:=" doc -ef W { doc -e LW { range aa =1[1]:4[500]; del aa;}}";<br /></b>
</p><p><br />
</p>
<table class="treetable">
<tr>
<th> Treenode
</th>
<th> Label
</th>
<th> Type
</th>
<th> Default
</th>
<th> Description
</th></tr>
<tr>
<td>ScriptAfterEachImportt
</td>
<td>Script after Each File Imported
</td>
<td>string
</td>
<td>"?"
</td>
<td>Specify LabTalk scripts that will be executed after each file imported.
</td></tr>
<tr>
<td>ScriptAfterAllImport
</td>
<td>Script after All Files Imported
</td>
<td>string
</td>
<td>"?"
</td>
<td>Specify LabTalk scripts that will be executed only after all files being imported.
</td></tr></table>






