<h1 class="firstHeading">2.10.37 plotxy</h1><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Brief_Information"><span class="tocnumber">1</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Additional_Information"><span class="tocnumber">2</span> <span class="toctext">Additional Information</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Command_Line_Usage"><span class="tocnumber">3</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#X-Function_Execution_Options"><span class="tocnumber">4</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Variables"><span class="tocnumber">5</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Description"><span class="tocnumber">6</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Examples"><span class="tocnumber">7</span> <span class="toctext">Examples</span></a></li>
</ul>
</div>

<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Create plot from XY data by specifying plot type and properties
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">Additional Information</span></h2>
<p><b>Minimum Origin Version Required</b>: Origin 8 SR0, updated in Origin 8.5.1 SR0. The option to hide the created graph is available starting with 9.0.
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<pre>
1. plotxy iy:=(1,2);
2. plotxy iy:=(1,2,3);  // Plot col(2) with col(3) as error bar
3. plotxy iy:=[Book1]2!(1,3) o:=[Graph1]1!;
4. plotxy (?,1:end);
5. plotxy [Book1]2!(#, 3);
6. plotxy (1:3)!(1,2) plot:=200; // Plot col(2) of the 1~3 sheet in the active workbook.
7. plotxy ((1,2[1:6]),(1,2[7:12]),(1,2[13:18])) plot:=202 ogl:=[&lt;new template:=doubley name:=SamplePlot&gt;]; 
    // Plot 3 ranges of col(2) into a specified graph template and name the graph as SamplePlot.
8. plotxy (1,3) ogl:=2; // Plot the col(3) into layer 2.
9. plotxy (1,2) plot:=186 ogl:=&lt;new template:=PolarXrYTheta&gt;;  // Polar r(X) theta(Y)
10. plotxy (1,2) plot:=192 ogl:=&lt;new template:=Polar&gt;;  // Polar theta(X) r(Y)
11. plotxy iy:=[Book2]&quot;Sheet1&quot;!(Col(1),Col(5)[60]:Col(8)[80]) plot:=200 ogl:=[Graph11]1!; 
    //showing how to plot data from column 5, row 60 to column 8, row 80
</pre>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Input
</td>
<td>iy
</td>
<td>
<p>Input
</p><p>XYRange
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td>
<p>Specifies the input data, including X column, Y column, Y error column.
</p>
</td></tr>
<tr>
<td>Plot Type
</td>
<td>plot
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>201</center>
</td>
<td>
<p>Specifies the plot type. The most common are 200, line; 201, scatter; 202, line + symbol.  For the list of all plot types, see <a class="external text" href="../../LabTalk/LabTalk/Plot_Type_IDs.html">Plot Type IDs</a>. Note: only the plot types for XY range can be used.
</p>
</td></tr>
<tr>
<td>Symbol Size (Pts)
</td>
<td>size
</td>
<td>
<p>Input
</p><p>double
</p>
</td>
<td> <center>-1</center>
</td>
<td>
<p>Specifies the symbol size in points. Here the default value is -1, which means that the size will always follow the symbol size specified in the template automatically. 
</p>
</td></tr>
<tr>
<td>Rescale
</td>
<td>rescale
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td>
<p>Specifies whether to rescale the graph (1) or not (0).
</p>
</td></tr>
<tr>
<td>Legend
</td>
<td>legend
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td>
<p>Specifies whether to generate the legend on graph.<br />
legend:=0 option only works if a template does NOT have a saved Legend object. <br />
legend:=1 generates a legend in regardless whether the template has a Legend or not.
</p>
</td></tr>
<tr>
<td>Plot Color
</td>
<td>color
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>Specifies the color of plots. This only works on Line, Symbol and Line+Symbol graphs. Color may be an index into Origin's Color List&#160;: 1 (Black), 2 (Red), up to 24 (Dark Gray) or up to 40 if you have defined the 16 Custom Colors in the Color dialog. Additionally, you can use the color function to assign any RGB color, as in<br />
plotxy iy:=(1,2) plot:=200 color:=color(240,208,0)
</p>
</td></tr>
<tr>
<td> Hide Newly Created Graph
</td>
<td> hide
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td><center>0</center>
</td>
<td>Specify whether to hide the newly created graph (1) or not (0).
</td></tr>
<tr>
<td> Layer to Plot into
</td>
<td> ogl
</td>
<td>
<p>Output
</p><p>GraphLayer
</p>
</td>
<td> <center>&lt;new&gt;</center>
</td>
<td>
<p>Specifies the graph layer to add plots.
</p><p>Use <a class="external text" href="../../XFunction/X-Function/Output_Notations.html">range</a> syntax.
</p>
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>This function plots data from specified range, which can include Y error column. You can specify the plot type and symbol size. You can also specify whether to show the legend and whether to rescale the graph.
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<ul><li> There are special notation '?' and '#' in the range as the parameter. '?' indicates that the range is forced to use worksheet designation, and will fail if the range designation does not satisfy the requirement, and '#' means that the range ignores designations and use row number as X designation. For example,</li></ul>
<pre class="lt" style="font-family:monospace;">plotxy <span style="color: #000000;">&#40;</span>?, <span style="color: #0000dd;">5</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// if col(5) happens to be X column call fails</span>
plotxy <span style="color: #000000;">&#40;</span>#, <span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// plot col(3) as Y and use row number as X</span></pre>
<ul><li> To make a plot with Y error, one more column can be added into the input range as Y error. For example:</li></ul>
<pre class="lt" style="font-family:monospace;">plotxy iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">2</span>, <span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// plot col(2) vs col(1), with col(3) as Y error</span></pre>
<ul><li> The built-in specialized graph templates can be also used to make plots. For example:</li></ul>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// plot polar graph</span>
plotxy <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">186</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>new template<span style="color: #000000;">:</span><span style="color: #000080;">=</span>PolarXrYTheta<span style="color: #000080;">&gt;</span>;  <span style="color: #008000;">// Polar r(X) theta(Y)</span>
plotxy <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">192</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>new template<span style="color: #000000;">:</span><span style="color: #000080;">=</span>Polar<span style="color: #000080;">&gt;</span>;  <span style="color: #008000;">// Polar theta(X) r(Y)</span></pre>
<ul><li> The following example shows how to add a curve into specified graph layer.</li></ul>
<pre class="lt" style="font-family:monospace;">newbook;
string fn<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> System.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Curve Fitting\Exponential Decay.dat&quot;</span>;
impasc fn<span style="color: #000080;">$</span>;
string bn<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #000080;">%</span>H;
int nCols <span style="color: #000080;">=</span> wks.<span style="color: #000080;">ncols</span>;
win <span style="color: #000080;">-</span>t Plot;	<span style="color: #008000;">// Create an empty plot</span>
loop <span style="color: #000000;">&#40;</span>ii, <span style="color: #0000dd;">2</span>, nCols<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	<span style="color: #008000;">// Add dataset into a layer</span>
	plotxy <span style="color: #000000;">&#91;</span>bn<span style="color: #000080;">$</span><span style="color: #000000;">&#93;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!$</span><span style="color: #000000;">&#40;</span>ii<span style="color: #000000;">&#41;</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">201</span> rescale<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> color<span style="color: #000000;">:</span><span style="color: #000080;">=</span>ii ogl<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000080;">!</span><span style="color: #0000dd;">1</span>;
<span style="color: #000000;">&#125;</span>
<span style="color: #008000;">// Group the curves</span>
layer <span style="color: #000080;">-</span>g;</pre>
<ul><li> The following example shows how to plot a 3D waterfall graph, you can use <a class="external text" href="../../LabTalk/LabTalk/Set_(command).html#-lgcb.3B_Set_colormap_for_3D_waterfall">set</a> command to control the color mapping.</li></ul>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// plot waterfall graph</span>
plotxy iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">:</span><span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">210</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>new template<span style="color: #000000;">:</span><span style="color: #000080;">=</span>glWater3D<span style="color: #000080;">&gt;</span>; 
<span style="color: #008000;">//Y color mapping</span>
plotxy iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">:</span><span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">210</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>new template<span style="color: #000000;">:</span><span style="color: #000080;">=</span>glWater3D<span style="color: #000080;">&gt;</span>;
set <span style="color: #000080;">%</span>C <span style="color: #000080;">-</span>LGCB <span style="color: #0000dd;">0</span>;	
<span style="color: #008000;">//Z color mapping</span>
plotxy iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">:</span><span style="color: #0000dd;">4</span><span style="color: #000000;">&#41;</span> plot<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">210</span> ogl<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>new template<span style="color: #000000;">:</span><span style="color: #000080;">=</span>glWater3D<span style="color: #000080;">&gt;</span>;
set <span style="color: #000080;">%</span>C <span style="color: #000080;">-</span>LGCB <span style="color: #0000dd;">3</span>;</pre>
<ul><li> Sample Code</li></ul>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Start with a new Book</span>
newbook;
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> data<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">30</span><span style="color: #000000;">&#41;</span>;
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> normal<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">30</span><span style="color: #000000;">&#41;</span>;
col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">=</span> uniform<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">30</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Auto-creation of column 3</span>
<span style="color: #008000;">// Remember Book and Sheet names</span>
string bkname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> page.<span style="color: #000080;">name</span><span style="color: #000080;">$</span>;
string shname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> layer.<span style="color: #000080;">name</span><span style="color: #000080;">$</span>;

<span style="color: #008000;">// Since sheet is active, we can specify column range</span>
plotxy <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">2</span><span style="color: #000000;">:</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Remember ranges within our Book and Sheet</span>
range r1 <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>bkname<span style="color: #000080;">$</span><span style="color: #000000;">&#93;</span>shname<span style="color: #000080;">$!</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">15</span><span style="color: #000000;">&#93;</span>;
range r2 <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>bkname<span style="color: #000080;">$</span><span style="color: #000000;">&#93;</span>shname<span style="color: #000080;">$!</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">16</span><span style="color: #000000;">:</span>end<span style="color: #000000;">&#93;</span>;
<span style="color: #008000;">// Now that graph is active window, need to specify Book and Sheet</span>
plotxy <span style="color: #000000;">&#91;</span>bkname<span style="color: #000080;">$</span><span style="color: #000000;">&#93;</span>shname<span style="color: #000080;">$!</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">15</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span>,<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">16</span><span style="color: #000000;">:</span><span style="color: #0000dd;">30</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Creates second layer</span>
<span style="color: #008000;">// or use range which knows its Book and Sheet</span>
plotxy iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span>r1 ogl<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>;
plotxy iy<span style="color: #000000;">:</span><span style="color: #000080;">=</span>r2 ogl<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>;

page.<span style="color: #000080;">active</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span>;
color <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;
doc <span style="color: #000080;">-</span>e DY <span style="color: #000000;">&#123;</span>
   set <span style="color: #000080;">%</span>C <span style="color: #000080;">-</span>c <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>color<span style="color: #000000;">&#41;</span>;
   color<span style="color: #000080;">++</span>;
<span style="color: #000000;">&#125;</span>
layarrange row<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span> col<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> ygap<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">7</span> left<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">12</span> right<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">12</span> top<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">10</span> bottom<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">15</span>;
legendupdate update<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> legend<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> mode<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;</pre>






