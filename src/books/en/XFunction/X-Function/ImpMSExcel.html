<h1 class="firstHeading">2.7.49 impMSExcel</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">Menu Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Command_Line_Usage"><span class="tocnumber">3</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#X-Function_Execution_Options"><span class="tocnumber">4</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Variables"><span class="tocnumber">5</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Description"><span class="tocnumber">6</span> <span class="toctext">Description</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#Options_Tree_Details"><span class="tocnumber">6.1</span> <span class="toctext">Options Tree Details</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8"><a href="#Examples"><span class="tocnumber">7</span> <span class="toctext">Examples</span></a>
<ul>
<li class="toclevel-2"><a href="#Example_1"><span class="tocnumber">7.1</span> <span class="toctext">Example 1</span></a></li>
<li class="toclevel-2"><a href="#Example_2"><span class="tocnumber">7.2</span> <span class="toctext">Example 2</span></a></li>
<li class="toclevel-2"><a href="#Example_3"><span class="tocnumber">7.3</span> <span class="toctext">Example 3</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-9"><a href="#Related_X-Functions"><span class="tocnumber">8</span> <span class="toctext">Related X-Functions</span></a></li>
</ul>
</div>

<h2><a name="Menu_Information"></a><span class="mw-headline">Menu Information</span></h2>
<p>Data: Import from File: Excel (XLS, XLSX, XLSM)...
</p><p>This X-Function supports file re-import. See <a class="external text" href="../../GettingStarted/OriginLab/Import_Data.html#Re-Importing_Data_Files">this topic</a> for details.
</p>
<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Import Excel (XLS, XLSX....) files directly into Origin, without the need for Excel.
</p><p>Note that prior to Origin 2017, Origin used another Excel X-Function (see <a href="../../XFunction/X-Function/ImpExcel.html" title="X-Function:ImpExcel">impExcel</a>) which launched Excel in the background in order to import XLSX files.
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
1. fname$="sample.xls"; impMSExcel; // import the file sample.xls
</p><p>2. impMSExcel fname:="c:\test1.xlsxt%(crlf)c:\test2.xlsx" options.sparklines:=1 options.Mode:=4 options.Headers.LongName:=1 options.Headers.Units:=2;
</p><p></code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="TableGrid" style="; border-spacing: 0px; border-spacing: 0px;background: #EFEFEF" border="1">

<tr>
<th>
<center><b>Display Name</b></center>
</th>
<th>
<center><b>Variable Name</b></center>
</th>
<th>
<center><b>I/O</b></center>
<center><b>and</b></center>
<center><b>Type</b></center>
</th>
<th>
<center><b>Default Value</b></center>
</th>
<th>
<center><b> Description </b> </center>
</th></tr>
<tr>
<td>
<center>File Name</center>
</td>
<td>
<center>fname</center>
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td><center>fname$</center>
</td>
<td>
<p>Filename of the file to be imported.
</p>
</td></tr>
<tr>
<td>
<center>File Info</center>
</td>
<td>
<center>trfiles</center>
</td>
<td>
<p>Input
</p><p>TreeNode
</p>
</td>
<td><center>&lt;unassigned&gt;</center>
</td>
<td>
<p>This is used in the dialog for displaying the file size. The information is detected by Origin automatically.
</p>
</td></tr>
<tr>
<td>
<center>Import Options</center>
</td>
<td>
<center><a href="../../XFunction/X-Function/Details_of_TreeNodes_in_Import_MSExcel.html" title="X-Function:Details of TreeNodes in Import MSExcel">options</a></center>
</td>
<td>
<p>Input
</p><p>TreeNode
</p>
</td>
<td><center>&lt;unassigned&gt;</center>
</td>
<td>
<p>This is mainly used in the dialog, for tweaking the import options.
</p><p>See more details in Description
</p>
</td></tr>
<tr>
<td>
<center>Output</center>
</td>
<td>
<center>orng</center>
</td>
<td>
<p>Output
</p><p>Range
</p>
</td>
<td><center>&lt;active&gt;</center>
</td>
<td>
<p>This is used to specify the output range.
</p>
</td></tr>
<tr>
<td>
<center>Header Info</center>
</td>
<td>
<center>trheader</center>
</td>
<td>
<p>Output
</p><p>TreeNode
</p>
</td>
<td><center>&lt;optional&gt;</center>
</td>
<td>
<p>This is for outputting the header information. It is hidden from the GUI. Users are not advised to use this variable.
</p>
</td></tr>
<tr>
<td>
<p>Repeat Import
</p>
</td>
<td><center>reimp</center>
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>Specify whether the current import is a reimporting process. It is hidden from the GUI. Use of this variable is not advised. 
</p>
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>This X-Function is used for importing Microsoft Excel files. It doesn't use COM and thus works for .XLS .XLSX and .XLSM files even if Excel is not installed. 
</p>
<ul><li>  Menu: Select <b>Data: Import from File: Excel (XLS, XLSX, XLSM)...</b></li>
<li>  Command window: type <pre class="lt" style="font-family:monospace;">impMSExcel <span style="color: #000080;">-</span>d</pre> in command window.</li></ul>
<p>The imported Excel workbook can have more than one sheet. All sheets will be imported into separate Origin worksheets in the target workbook, using the same import settings. See Options Tree Details section for details of import settings
</p><p>From Origin 2015, re-import one or multiple sheets from Excel to Origin is supported. During Excel re-importing, a link is maintained so that Origin is able to use up-to-date data. To re-import Excel files, 
</p>
<ul><li> go to <b>Data: Re-Import Directly</b> or use Ctrl+4 keys to re-import Excel sheets with same settings as before. </li>
<li> go to <b>Data: Re-Import...</b> to bring up dialog box to change import settings for files to be re-imported.</li>
<li> type command <pre class="lt" style="font-family:monospace;">reimport <span style="color: #000080;">-</span>d</pre> in command window to re-import Excel files.</li></ul>
<p>Origin 2016 introduce a &lt;clone&gt; template, which allows you to import Excel workbook(s) into a prepared workbook template or analysis template to batch customize/analyze data in Excel books. See details in Options Tree Details section.
</p>
<h3><a name="Options_Tree_Details"></a><span class="mw-headline">Options Tree Details</span></h3>
<dl><dd><ul><li><b>Import Options Tree</b></li></ul>
<dl><dd>Please see the <a href="../../XFunction/X-Function/Details_of_TreeNodes_in_Import_MSExcel.html" title="X-Function:Details of TreeNodes in Import MSExcel">impMSExcel Options Treenode Information page</a> for details on the many import options available.</dd></dl></dd></dl>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<h3><a name="Example_1"></a><span class="mw-headline">Example 1</span></h3>
<p>The following example imports an Excel file using factory default options:
</p>
<ol><li> Start with a new workbook. From the Origin menu, select <b>Data: Import from File: Excel (XLS, XLSX, XLSM)... </b> This opens the <b>Excel Files</b> dialog for you to choose the import file.</li>
<li> Select file <i>&lt;Origin install folder&gt;/Samples/Import and Export/United States Energy (1980-2013).xls</i>. Click <b>Add File(s)</b> button. Make sure <b>Show Options dialog</b> is checked and click <b>OK</b>.</li>
<li> In the <b>impMSExcel</b> dialog box that opens, specify the header lines as image below. Click <b>Ok</b> to import the Excel file.</li></ol>
<dl><dd><a  class="image"><img alt="ImportMSExcel 01.png" src="../images/ImpMSExcel/ImportMSExcel_01.png?v=79981" width="456"  /></a></dd></dl>
<h3><a name="Example_2"></a><span class="mw-headline">Example 2</span></h3>
<p>The following script command imports an Excel file (c:\test.xls) without opening the dialog:
</p>
<pre class="lt" style="font-family:monospace;">newbook;
string fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Graphing\Excel Data.xls&quot;</span>;
impMSExcel options.<span style="color: #000080;">cellfmts</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> options.<span style="color: #000080;">headers</span>.<span style="color: #000080;">MainHeaderLines</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> options.<span style="color: #000080;">headers</span>.<span style="color: #000080;">SubHeaderLines</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> options.<span style="color: #000080;">headers</span>.<span style="color: #000080;">LongName</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>; <span style="color: #008000;">//copy cell format of Excel file while importing</span></pre>
<h3><a name="Example_3"></a><span class="mw-headline">Example 3</span></h3>
<p>The following script command imports the specified Excel sheets:
</p>
<pre class="lt" style="font-family:monospace;">newbook;
string fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;c:\test.xls&quot;</span>;
impMSExcel options.<span style="color: #000080;">sheet</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span><span style="color: #000000;">:</span><span style="color: #0000dd;">3</span><span style="color: #000000;">:</span><span style="color: #0000dd;">5</span>; <span style="color: #008000;">//Import the first, the third and the fifth Excel sheets only</span>
newbook;
impMSExcel options.<span style="color: #000080;">sheet</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span>SheetName1<span style="color: #000000;">:</span>SheetName2; <span style="color: #008000;">//Import the Excel sheets named SheetName1 and SheetName2</span></pre>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">Related X-Functions</span></h2>
<p><a href="../../XFunction/X-Function/ImpFile.html" title="X-Function:ImpFile">impfile</a>, <a href="../../XFunction/X-Function/Impinfo.html" title="X-Function:Impinfo">impinfo</a>, <a href="../../XFunction/X-Function/ImpExcel.html" title="X-Function:ImpExcel">impExcel</a>
</p>





