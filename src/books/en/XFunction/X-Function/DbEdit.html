<h1 class="firstHeading">2.3.1 dbEdit</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Brief_Information"><span class="tocnumber">1</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Additional_Information"><span class="tocnumber">2</span> <span class="toctext">Additional Information</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Command_Line_Usage"><span class="tocnumber">3</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#X-Function_Execution_Options"><span class="tocnumber">4</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Variables"><span class="tocnumber">5</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Description"><span class="tocnumber">6</span> <span class="toctext">Description</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#ODS_file"><span class="tocnumber">6.1</span> <span class="toctext">ODS file</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#ODQ_file"><span class="tocnumber">6.2</span> <span class="toctext">ODQ file</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Connection_String"><span class="tocnumber">6.3</span> <span class="toctext">Connection String</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-10"><a href="#Related_X-Functions"><span class="tocnumber">7</span> <span class="toctext">Related X-Functions</span></a></li>
</ul>
</div>

<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Open SQL Editor dialog
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">Additional Information</span></h2>
<p>X-Function not designed for Auto GetN Dialog.
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
</p>
<ol><li>dbEdit execute:=change;</li>
<li>dbEdit execute:=load fname:="%Ystars.ods" iw:=[book2]sheet1!;</li>
<li>dbEdit sql:="Select Stars.Name, Stars.LightYears From Stars";</li></ol>
<p></code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Command Options
</td>
<td>execute
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify the database operation performed to the worksheet.
<p>Option list:
</p>
<ul><li><i>change:Create/Modify Query</i>
<dl><dd>Open the <b>SQL Editor</b> dialog to create or modify the query.</dd></dl></li>
<li><i>askrem:Remove Query with User Confirmation</i>
<dl><dd>Remove query from worksheet with user's confirmation.</dd></dl></li>
<li><i>load:Load Query File</i>
<dl><dd>Load a query (.ODQ or .ODS) file to the worksheet. The name of the file should be specified with the <b>fname</b> variable.</dd></dl></li>
<li><i>remove:Remove Query</i>
<dl><dd>Remove the query from the worksheet.</dd></dl></li>
<li><i>new:Create New Connection</i>
<dl><dd>Add a database connection icon to the active worksheet and open the SQL Editor with "Data Connector" button configuration.</dd></dl></li>
<li><i>wks:Connector Mode</i>
<dl><dd>Edit an existing database query in the active worksheet. SQL Editor will have "Data Connector" button configuration.</dd></dl></li></ul>
</td></tr>
<tr>
<td>Input ODQ or ODS file path
</td>
<td>fname
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>""</center>
</td>
<td> When the <b>execute</b> variable is <b>Load</b>, you can use this variable to specify the path of the .odq or .ods file to be loaded.
</td></tr>
<tr>
<td>Worksheet
</td>
<td>iw
</td>
<td>
<p>Input
</p><p>Worksheet
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> Specify the worksheet to operate on.
</td></tr>
<tr>
<td>New SQL string
</td>
<td>sql
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>""</center>
</td>
<td> Specify a new SQL string to write into the current query in the worksheet.
</td></tr>
<tr>
<td>New Connection string
</td>
<td>connect
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>""</center>
</td>
<td> Specify a new connection string to write into the current query in the worksheet.
</td></tr>
<tr>
<td>Import Option
</td>
<td>option
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify the way to import data.
<p>Option list:
</p>
<ul><li><i>ado:Use ADO Object to Import Data</i>
<dl><dd>Use the ADO object to import data. </dd></dl></li>
<li><i>odbc:Use ODBC to Import Data</i>
<dl><dd>Use ODBC to import data.</dd></dl></li></ul>
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>This tool opens the <b>SQL Editor</b> dialog to create a database query or remove/load/edit a database query.
</p><p><i>Note: <b>ODS</b> and <b>ODQ</b> files discussed below are plain text files that can be viewed and edited in <b>NotePad</b>.</i>
</p>
<h3><a name="ODS_file"></a><span class="mw-headline">ODS file</span></h3>
<p>A <b>Data Source</b> file. An.ODS file contains the <b><i>connection string</i></b> that allows Origin to open a connection to database. The file contains information like the name of the server, where the database is, the user ID and password needed to connect to the server, and so on.
</p><p>You can create an .ODS file from the <b>File: Save Connection As...</b> menu in <b>SQL Editor</b>. Below is an example for SQL Server database:
</p><p><font color="navy">
[DataSource]<br />
Provider=SQLOLEDB.1;Password=abc123;Persist Security Info=True;User ID=tester;Initial Catalog=Northwind;Data Source=MYSQLSERVER;Use Procedure for Prepare=1;Auto Translate=True;Packet Size=4096;Workstation ID=MYSQLSERVER;Use Encryption for Data=False;Tag with column collation when possible=False
</font>
</p>
<h3><a name="ODQ_file"></a><span class="mw-headline">ODQ file</span></h3>
<p>The <b>Data Query</b> file. The .ODQ file contains both the <b><i>connection string</i></b> and the <b><i>SQL query</i></b> used to retrieve information from the database.
</p><p>You can create an .ODQ file from the <b>File: Save Connection and Query As...</b> menu in <b>SQL Editor</b>. Below is an example for Oracle database:
</p><p><font color="navy">
[DataSource]<br />
Provider=OraOLEDB.Oracle.1;Password=tiger;Persist Security Info=True;User ID=scott;Data Source=orcl;Extended Properties=""
</p><p>[SQL]<br />
Select SCOTT.DEPT.DNAME, SCOTT.DEPT.LOC, SCOTT.EMP.ENAME, SCOTT.EMP.JOB, SCOTT.EMP.SAL<br />
From SCOTT.DEPT Inner Join SCOTT.EMP On SCOTT.DEPT.DEPTNO = SCOTT.EMP.DEPTNO
</p><p>[UseODBC]<br />
ADO
</font>
</p>
<h3><a name="Connection_String"></a><span class="mw-headline">Connection String</span></h3>
<p>The two examples above show that either an ODS or ODQ file contains the connection string in the <b><i>[DataSource]</i></b> section. And you can also find this string in the the <b>SQL Editor</b> by selecting <b>File: Show Connection String</b> or <b>File: Edit Connection String...</b>.
</p><p>When performing query by Script (or Origin C), the key is to use this connection string to setup the database connection, and then submit a query. So, before querying any data, you should use the <b>SQL Editor</b> to get a connection string from a manually created connection/query, then copy and use this string in your code.
</p>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">Related X-Functions</span></h2>
<p><a href="../../XFunction/X-Function/DbImport.html" title="X-Function:DbImport">dbImport</a>, <a href="../../XFunction/X-Function/DbInfo.html" title="X-Function:DbInfo">dbInfo</a>, <a href="../../XFunction/X-Function/DbPreview.html" title="X-Function:DbPreview">dbPreview</a>
</p>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>database, query</span></p>






