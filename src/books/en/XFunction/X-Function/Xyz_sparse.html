<h1 class="firstHeading">2.2.1.10 xyz_sparse</h1><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Brief_Information"><span class="tocnumber">1</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Command_Line_Usage"><span class="tocnumber">2</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#X-Function_Execution_Options"><span class="tocnumber">3</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Variables"><span class="tocnumber">4</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Description"><span class="tocnumber">5</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Examples"><span class="tocnumber">6</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Related_X-Functions"><span class="tocnumber">7</span> <span class="toctext">Related X-Functions</span></a></li>
</ul>
</div>

<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Convert XYZ sparse data to matrix
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
1. xyz_sparse iz:=Col(3) rows:=3 cols:=5;
</p><p>2. xyz_sparse iz:=Col(3) rows:=3 cols:=5 om:=[MyMatrix]Sheet1!Mat(1);
</code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Input
</td>
<td>iz
</td>
<td>
<p>Input
</p><p>XYZRange
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td>
<p>Specifies the input XYZ range.
</p>
</td></tr>
<tr>
<td>Rows
</td>
<td>rows
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>20</center>
</td>
<td>
<p>Rows in the output matrix.
</p>
</td></tr>
<tr>
<td>Columns
</td>
<td>cols
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>20</center>
</td>
<td>
<p>Columns in the output matrix.
</p>
</td></tr>
<tr>
<td>Output Matrix
</td>
<td>om
</td>
<td>
<p>Output
</p><p>MatrixObject
</p>
</td>
<td> <center>&lt;new&gt;</center>
</td>
<td>
<p>The output matrix.
</p><p>See the syntax <a class="external text" href="../../XFunction/X-Function/Output_Notations.html">here</a>.
</p>
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>The Sparse XYZ worksheet to matrix conversion is similar to the Regular XYZ conversion (i.e. X and Y data values must be regularly spaced), except that in the case of the Sparse conversion, missing XY pairs are acceptable. Using proper X and Y step setting, sparse method will fill the value in the grid nodes like:
</p>
<dl><dt><a  class="image"><img alt="Xyz sparse image7.gif" src="../images/Xyz_sparse/Xyz_sparse_image7.gif?v=614" width="453"  /></a></dt></dl>
<p>After conversion, Origin will generate the following matrix:
</p>
<dl><dt><a  class="image"><img alt="Xyz sparse image8.gif" src="../images/Xyz_sparse/Xyz_sparse_image8.gif?v=612" width="251"  /></a></dt></dl>
<p>With the sparse matrix, you can create a 3D plot with Z values plotted only at select XY values, as in this 3D bar plot:
</p>
<dl><dt><a  class="image"><img alt="Xyz sparse image9.gif" src="../images/Xyz_sparse/Xyz_sparse_image9.gif?v=613" width="190"  /></a></dt></dl>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<ul><li> To run from Command window</li></ul>
<ol><li>  Import the file \S<i>amples</i>\<i>Matrix Conversion and Gridding\Sparse.dat</i>.</li>
<li>  Type <code>xyz_sparse iz: = Col(3) rows: = 3 cols: = 5</code> in the command window.</li></ol>
<ul><li> Code Sample</li></ul>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000; font-style: regular;">/*
This example shows how convert sparse worksheet data into matrix.
The sample data is exe_path\Samples\Matrix Conversion and Gridding\Sparse.dat
1. Load data to a new created workbook.
2. Random xyz gridding by sparse method.
3. Plot 3D bars.
*/</span>

<span style="color: #008000;">// Get sample data</span>
fn<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Matrix Conversion and Gridding\Sparse.dat&quot;</span>;
newbook;
impASC fn<span style="color: #000080;">$</span>;
<span style="color: #008000;">// Set the third column as Z column</span>
wks.<span style="color: #000080;">col3</span>.<span style="color: #000080;">type</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">6</span>;

<span style="color: #008000;">// Convert worksheet data into matrix by sparse gridding method</span>
xyz_sparse iz<span style="color: #000000;">:</span><span style="color: #000080;">=</span>Col<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">3</span><span style="color: #000000;">&#41;</span> rows<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span> cols<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">5</span>;

<span style="color: #008000;">// Plot </span>
worksheet <span style="color: #000080;">-</span>p <span style="color: #0000dd;">242</span> 3Dbars;</pre>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">Related X-Functions</span></h2>
<p><a href="../../XFunction/X-Function/Xyz_regular.html" title="X-Function:Xyz regular">xyz_regular</a>, <a href="../../XFunction/X-Function/Xyz_renka.html" title="X-Function:Xyz renka">xyz_renka</a>, <a href="../../XFunction/X-Function/Xyz_renka_nag.html" title="X-Function:Xyz renka nag">xyz_renka_nag</a>, <a href="../../XFunction/X-Function/Xyz_shep.html" title="X-Function:Xyz shep">xyz_shep</a>, <a href="../../XFunction/X-Function/Xyz_shep_nag.html" title="X-Function:Xyz shep nag">xyz_shep_nag</a>, <a href="../../XFunction/X-Function/Xyz_tps.html" title="X-Function:Xyz tps">xyz_tps</a>
</p>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>worksheet</span></p>






