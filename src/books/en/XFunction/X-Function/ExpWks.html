<h1 class="firstHeading">2.7.19 expWks</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">Menu Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Command_Line_Usage"><span class="tocnumber">3</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#X-Function_Execution_Options"><span class="tocnumber">4</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Variables"><span class="tocnumber">5</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Description"><span class="tocnumber">6</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Examples"><span class="tocnumber">7</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Related_X-Functions"><span class="tocnumber">8</span> <span class="toctext">Related X-Functions</span></a></li>
</ul>
</div>

<h2><a name="Menu_Information"></a><span class="mw-headline">Menu Information</span></h2>
<p>File&#160;: Export&#160;: As Image File
</p>
<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Export the active sheet as raster or vector image file
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
expWks type:=jpg export:=active path:="c:\temp\"; 
</p><p></code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Image Type
</td>
<td>type
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>eps</center>
</td>
<td>
<p>Specifies the image type for the exported file. The default option is Encapsulated Postscript (*.eps).
<br />
Option list
</p>
<ul><li><i>ai:AI</i>
<dl><dd>Adobe Illustrator, vector format</dd></dl></li>
<li><i>bmp:BMP</i>
<dl><dd>Bitmap, raster format</dd></dl></li>
<li><i>emf:EMF</i>
<dl><dd>Enhanced Metafile, vector format</dd></dl></li>
<li><i>eps:EPS</i>
<dl><dd>Encapsulated PostScript, vector format</dd></dl></li>
<li><i>gif:GIF</i>
<dl><dd>Graphics Interchange Format, raster format</dd></dl></li>
<li><i>jpg:JPG</i>
<dl><dd>JPEG, Joint Photographic Experts Group, raster format</dd></dl></li>
<li><i>pcx:PCX</i>
<dl><dd>Zsoft PC Paintbrush Bitmap, raster format</dd></dl></li>
<li><i>pdf:PDF</i>
<dl><dd>Portable Document Format, vector format</dd></dl></li>
<li><i>png:PNG</i>
<dl><dd>Portable Network Graphics, raster format</dd></dl></li>
<li><i>psd:PSD</i>
<dl><dd>Adobe PhotoShop, raster format</dd></dl></li>
<li><i>tga:TGA</i>
<dl><dd>Truevision Targa, raster format</dd></dl></li>
<li><i>tif:TIF</i>
<dl><dd>TIFF, Tag Image File, raster format</dd></dl></li>
<li><i>wmf:WMF</i>
<dl><dd>Windows Metafile, vector format</dd></dl></li>
<li><i>cgm:CGM</i>
<dl><dd>Computer Graphics Metafile, vector format (Only for 32bit version)</dd></dl></li>
<li><i>dxf:DXF</i>
<dl><dd>AutoCAD Drawing Interchange, vector format (Only for 32bit version)</dd></dl></li>
<li><i>svg: SVG</i>
<dl><dd>Scalable Vector Graphics, vector format</dd></dl></li></ul>
</td></tr>
<tr>
<td>Select Sheet(s)
</td>
<td>export
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>active</center>
</td>
<td>
<p>Use this option to select the worksheet(s) to be exported. By default, the active sheet will be exported.
<br />
Option list
</p>
<ul><li><i>active</i>:Current Sheet</li></ul>
<dl><dd> The active worksheet will be exported</dd></dl>
<ul><li><i>book</i>:Sheets in Book</li></ul>
<dl><dd> All the worksheets in active workbook will be exported</dd></dl>
<ul><li><i>folder</i>:Sheets in Folder</li></ul>
<dl><dd>All the worksheets in active folder of the project (see this in Project Explorer) will be exported. The worksheets in the subfolders will not be included.</dd></dl>
<ul><li><i>recursive</i>:Sheets in Folder (recursively)</li></ul>
<dl><dd>All the worksheets in active folder of the project (see this in Project Explorer) will be exported. The worksheets in the subfolders will be included.</dd></dl>
<ul><li><i>project</i>:Sheets in Project</li></ul>
<dl><dd>All the worksheet in the project will be exported. </dd></dl>
<ul><li><i>specified</i>:The specified sheet</li></ul>
<dl><dd> It makes the "Worksheets" edit box editable, allowing you to choose the specific worksheets to be exported.</dd></dl>
</td></tr>
<tr>
<td>Worksheets
</td>
<td>pages
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td>
<p>This edit box lists the worksheets that will be exported. If <b>Specified</b> is selected in the <b>Export</b> drop-down list, this edit box will be editable, allowing you to choose the specific worksheets to be exported. In this case, you can click the <b>Browse</b> button to the right of this edit box to open the <b>Project Browser</b> dialog for selecting the worksheets. If other options are selected in the <b>Export</b> drop-down list, this edit box will be read-only.
</p>
</td></tr>
<tr>
<td>File Name(s)
</td>
<td>filename
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>&lt;Long Name&gt;</center>
</td>
<td>
<p>Specifies how to name the exported image file(s). Options include:
</p>
<ul><li>&lt;Long Name&gt;: Uses the long names of the worksheets as the file names of the exported images.</li>
<li>&lt;Short Name&gt;: Uses the short names of the worksheets as the file names of the exported images.</li>
<li>&lt;Sheet Name&gt;: Uses the sheet names of the worksheets as the file names of the exported images.</li>
<li>wks##: Uses filenames like "wks01", "wks02"....</li>
<li>wks&lt;pound&gt;#:Use "wks# + index" (filenames like "wks#1", "wks#2"....) and character "#"(represented by &lt;pound&gt;) as file name.</li></ul>
<p>Note: 
</p>
<ol><li>File Name supports keyword combination, such as <i>&lt;longname&gt;-multi</i>, the long name of the worksheet and the string <i>-multi</i> will be used as the export file name.</li>
<li>&lt;pound&gt;, representing the character "#", can also be used without combining with worksheet index. For example, Set File Name(s) as <i>Wks&lt;pound&gt;2</i> then the file name would be <i>Wks#2</i>.</li></ol>
</td></tr>
<tr>
<td>Path
</td>
<td>path
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center></center>
</td>
<td>
<p>Specifies the file path for the exported image file(s).
</p>
</td></tr>
<tr>
<td>Overwrite Existing
</td>
<td>overwrite
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>ask</center>
</td>
<td>
<p>To specify if the existing file(s) in the path should be overwrote.
<br />
Option list
</p>
<ul><li><i>rename:Auto Rename</i>
<dl><dd>Renames the exported file automatically.</dd></dl></li>
<li><i>replace:Replace</i>
<dl><dd>Replaces the existing file with the exported file.</dd></dl></li>
<li><i>skip:Skip</i>
<dl><dd>Skips the exporting of this file.</dd></dl></li>
<li><i>ask:Ask</i>
<dl><dd>Asks the user to decide the operation.</dd></dl></li></ul>
</td></tr>
<tr>
<td>Use Preference Options
</td>
<td>sysopts
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td>
<p>Whether to use Page settings from Preference Option dialog. 
Default is used. This is not visible in GUI and only used in script. 
</p>
</td></tr>
<tr>
<td>Export Settings
</td>
<td>tr
</td>
<td>
<p>Input
</p><p>TreeNode
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td>
<p>Specifies the export settings.
<br />
See more details in Description table
</p>
</td></tr>
<tr>
<td>Keep Original Size
</td>
<td>keepsize
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Whether to keep original worksheet size.
<p>Default is keep. This is not visible in GUI and only used in script.
</p>
</td></tr>
<tr>
<td>Image Size
</td>
<td>tr1
</td>
<td>
<p>Input
</p><p>TreeNode
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td>
<p>Specifies the image size.
<br />
See more details in Description table
</p>
</td></tr>
<tr>
<td>Image Settings
</td>
<td>tr2
</td>
<td>
<p>Input
</p><p>TreeNode
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td>
<p>Specifies the image settings.
<br />
See more details in Description table
</p>
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>This tool exports worksheets as image files.
</p><p>The dialog box of this tool has a preview pane to the right. You can customize the settings in the left and then see the effects in the preview pane.
</p><p><br />
<b>Details on Some Dialog Options</b>
</p>
<dl><dd><ul><li><b>Export Settings (tr)</b></li></ul></dd></dl>
<dl><dd><dl><dd>Please see <a class="external text" href="../../XFunction/X-Function/Details_of_TreeNodes_in_Export_Worksheet.html#The_Export_Settings_Branch">this page</a> for more details.</dd></dl></dd></dl>
<dl><dd><ul><li><b>Image Size (tr1)</b></li></ul>
<dl><dd>Please see <a class="external text" href="../../XFunction/X-Function/Details_of_TreeNodes_in_Export_Worksheet.html#The_Image_Size_Branch">this page</a> for more details.</dd></dl></dd></dl>
<dl><dd><ul><li><b>Image Settings (tr2)</b></li></ul>
<dl><dd>Please see <a class="external text" href="../../XFunction/X-Function/Details_of_TreeNodes_in_Export_Worksheet.html#The_Image_Settings_Branch">this page</a> for more details.</dd></dl></dd></dl>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<dl><dd>1.  The following script command will export the active worksheet as a JPG file:</dd></dl>
<dl><dd><dl><dd><code>expWks type:=jpg export:=active path:="c:\temp\";</code></dd></dl></dd></dl>
<dl><dd>2.  The following example will export a worksheet as a JPG file from the dialog:</dd></dl>
<dl><dd><dl><dd>a. Active the worksheet to be exported.</dd></dl></dd></dl>
<dl><dd><dl><dd>b. Select <b>File: Export: As Image File</b> from the menu. This opens the dialog box of the <b>expWks</b> X-Function.</dd></dl></dd></dl>
<dl><dd><dl><dd>c. Select the <b>Joint Photographic Experts Group (*.jpg)</b> with the <b>Image Type</b> drop-down list.</dd></dl></dd></dl>
<dl><dd><dl><dd>d. Enter <b>c:\temp</b> for <b>Path.</b></dd></dl></dd></dl>
<dl><dd><dl><dd>e. Expand the <b>Image Sizes</b> branch and select <b>page ratio</b> for <b>Specify Size in</b>. Enter <b>50</b> for <b>Ratio (%)</b>. You can see <b>Current Size</b> is changed.</dd></dl></dd></dl>
<dl><dd><dl><dd>f. Click <b>OK</b> to export the worksheet.</dd></dl></dd></dl>
<dl><dd>3.  Using tree node options</dd></dl>
<dl><dd><dl><dd>expWks type:=tif export:=active filename:="&lt;long name&gt;" path:=D:\ overwrite:=ask</dd>
<dd>tr.BorderWid:=0 tr.OpenGLGraph.AntiAlias:=1 tr.Area:=1.</dd>
<dd>tr1.Unit:=1 tr1.Rescaling:=0.</dd>
<dd>tr2.TIF.DotsPerInch:=100 tr2.TIF.ColorSpace:=CMYK tr2.TIF.Compression:=PackBits;</dd></dl></dd></dl>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">Related X-Functions</span></h2>
<p><a href="../../XFunction/X-Function/ExpImage.html" title="X-Function:ExpImage">expImage</a>
</p>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>publishing</span></p>






