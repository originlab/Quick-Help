<h1 class="firstHeading">2.7.25 impASC</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">Menu Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Description"><span class="tocnumber">2</span> <span class="toctext">Brief Description</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Additional_Information"><span class="tocnumber">3</span> <span class="toctext">Additional Information</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Command_Line_Usage"><span class="tocnumber">4</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#X-Function_Execution_Options"><span class="tocnumber">5</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Variables"><span class="tocnumber">6</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Description"><span class="tocnumber">7</span> <span class="toctext">Description</span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="#When_to_use_this_function.3F"><span class="tocnumber">7.1</span> <span class="toctext">When to use this function?</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Options_Tree_Details"><span class="tocnumber">7.2</span> <span class="toctext">Options Tree Details</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-10"><a href="#Examples"><span class="tocnumber">8</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-11"><a href="#Related_X-Functions"><span class="tocnumber">9</span> <span class="toctext">Related X-Functions</span></a></li>
</ul>
</div>

<h2><a name="Menu_Information"></a><span class="mw-headline">Menu Information</span></h2>
<p>File&#160;: Import&#160;: Single/Multiple ASCII...
</p><p>This X-Function supports file re-import. See <a class="external text" href="../../GettingStarted/OriginLab/Import_Data.html#Re-Importing_Data_Files">this topic</a> for details.
</p>
<h2><a name="Brief_Description"></a><span class="mw-headline">Brief Description</span></h2>
<p>Import ASCII file/files.
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">Additional Information</span></h2>
<p>This feature was updated in Origin 8.5 SR0.
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
1. impASC fname:="c:\nitrogen.txt" options.sparklines:=0;
</p><p>2. impasc fname:="c:\vartest1.dat%(crlf)c:\vartest2.dat" options.impmode:=4; 
</p><p></code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>File Name
</td>
<td>fname
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>fname$</center>
</td>
<td> Specify the filename of the file to be imported.
</td></tr>
<tr>
<td>Launch Option
</td>
<td>menu
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> This variable is only for controlling menus, and is not actually used by this X-Function.
<p><br />
Option list:
</p>
<ul><li><i>single:&amp;Single ASCII </i>
<dl><dd>Single ASCII</dd></dl></li>
<li><i>multiple:&amp;Multiple ASCII</i>
<dl><dd>Multiple ASCII</dd></dl></li></ul>
</td></tr>
<tr>
<td>File Info
</td>
<td>trfiles
</td>
<td>
<p>Input
</p><p>TreeNode
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td> This is used in the dialog for displaying basic file information. The information is automatically detected by Origin.
</td></tr>
<tr>
<td>Import Options
</td>
<td><a href="../../XFunction/X-Function/Details_of_TreeNodes_in_Import_ASCII.html" title="X-Function:Details of TreeNodes in Import ASCII">options</a>
</td>
<td>
<p>Input
</p><p>TreeNode
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td> Specify the import options in the dialog. See more details in the Description section.
</td></tr>
<tr>
<td>Output
</td>
<td>orng
</td>
<td>
<p>Output
</p><p>Range
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> Use this to specify the output range.
<p>See the syntax <a class="external text" href="../../XFunction/X-Function/Output_Notations.html">documented here</a>.
</p>
</td></tr>
<tr>
<td>Header Info
</td>
<td>trheader
</td>
<td>
<p>Output
</p><p>TreeNode
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td> Output header information. This variable is for internal use only. Please do not use.
</td></tr>
<tr>
<td>Import Filter
</td>
<td>trFilter
</td>
<td>
<p>Input
</p><p>TreeNode
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td> Specify the filter options in the dialog. This variable is for internal use only. Please do not use.
</td></tr>
<tr>
<td>File Info Storage Index
</td>
<td>findex
</td>
<td>
<p>Output
</p><p>int
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td> Specify the index number for file information storage in the target workbook.
</td></tr>
<tr>
<td>Repeat Import
</td>
<td>reimp
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify whether the current import is a reimporting process. Use of this variable is not advised.
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>This function will import ASCII file/files by setting the options in the dialog. It can be accessed from menu, toolbar or command window.
</p>
<h3><a name="When_to_use_this_function.3F"></a><span class="mw-headline">When to use this function?</span></h3>
<p>Origin now provides three tools for importing ASCII files: <b>Import Wizard</b>, <b>Import Single ASCII</b>, and <b>Import Multiple ASCII</b>.
</p><p><b>Import Single ASCII</b> and <b>Import Multiple ASCII</b> are most useful when you are familiar with the data structure of the file being imported.  
</p><p>If you do not have detailed knowledge of the fileâ€™s structure, the <b>Import Wizard</b> may be a better choice.  The <b>Import Wizard</b> is powerful and versatile, and provides many import options, as well as a Preview pane for monitoring settings.
</p>
<h3><a name="Options_Tree_Details"></a><span class="mw-headline">Options Tree Details</span></h3>
<dl><dd><ul><li><b>Import Options Tree</b></li></ul>
<dl><dd>Please see the <a class="external text" href="../../XFunction/X-Function/Details_of_TreeNodes_in_Import_ASCII.html">impASC Options Treenode Information page</a> for details on the many import options available.</dd></dl></dd></dl>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p>Because there are many options for importing an ASCII file, this function is most likely to be accessed through a dialog. However, it can be accessed from a script for automatically importing files. In this section, some simple examples are introduced for accessing <b>impAsc</b> from both dialog and script:
</p>
<ul><li><b>Access impASC through the dialog</b></li></ul>
<dl><dd>The following steps show how to import a file by auto-determining header lines.
<ol><li>Create a new workbook.</li>
<li>Open the impASC dialog through one of these methods: type <i><code>impASC -d;</code></i> in the command window; click the <b>Import Multiple ASCII</b> button in the toolbar; or, in the main menu, click <b>File</b>, point to <b>Import</b>, and then click <b>Multiple ASCII</b>. </li>
<li>Browse to the file you wish to import (in this case, <i>&lt;Origin Installation Folder&gt;</i>\<b>Samples\Import and Export\S15-125-03.dat</b>).  Click <b>OK</b>.</li>
<li>In the impASC dialog, click the <b>arrow button</b> next to <b>Dialog Theme</b> and select <b>System Default</b>.</li>
<li>Under<b> Import Options</b>, expand the <b>Header Lines</b> node.  Ensure that <b>Auto Determine Subheader Lines</b> is selected. </li>
<li>Click <b>OK</b> to import the file. The file should be imported into the workbook, and the Long Name, Units, and Sparklines should be correctly set.</li></ol></dd></dl>
<ul><li><b>Access impASC from script</b></li></ul>
<p>1. Basic usage
</p>
<pre class="lt" style="font-family:monospace;">impASC fname<span style="color: #000000;">:</span><span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span><span style="color: #000080;">+</span><span style="color: #ff00ff;">&quot;Samples\Import and Export\S15-125-03.dat&quot;</span>;</pre>
<p>2. The following script will first use the X-Function dlgFile to open a dialog for browsing to a single file, and the file name will be stored in a string variable called <b>fname$</b>. ImpASC can then be used without specifying the parameter <b>fname</b>.
</p>
<pre class="lt" style="font-family:monospace;">dlgFile;
impASC;</pre>
<p>3. As impASC supports the import of multiple files, normally this function can be used together with the X-Function findFiles.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//set the data folder,</span>
string path<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span><span style="color: #000080;">+</span><span style="color: #ff00ff;">&quot;Samples\Import and Export&quot;</span>;
<span style="color: #008000;">// you can also use dlgPath to browse the path for the folder, the path will be stored as path$</span>
<span style="color: #008000;">// dlgPath;</span>
<span style="color: #008000;">// navigate to the data folder</span>
cd path<span style="color: #000080;">$</span>;
<span style="color: #008000;">// find all files that match s*.dat</span>
findFiles ext<span style="color: #000000;">:</span><span style="color: #000080;">=</span>s<span style="color: #000080;">*</span>.<span style="color: #000080;">dat</span>;
<span style="color: #008000;">// import the files</span>
impASC;</pre>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">Related X-Functions</span></h2>
<p><a href="../../XFunction/X-Function/ImpFile.html" title="X-Function:ImpFile">impFile</a>, <a href="../../XFunction/X-Function/Impinfo.html" title="X-Function:Impinfo">impinfo</a>, <a href="../../XFunction/X-Function/DlgPath.html" title="X-Function:DlgPath">dlgPath</a>, <a href="../../XFunction/X-Function/DlgFile.html" title="X-Function:DlgFile">dlgFile</a>, <a href="../../XFunction/X-Function/FindFiles.html" title="X-Function:FindFiles">findFiles</a>, <a href="../../XFunction/X-Function/Cd.html" title="X-Function:Cd">cd</a>
</p>





