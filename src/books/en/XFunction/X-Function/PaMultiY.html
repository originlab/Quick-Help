<h1 class="firstHeading">2.12.5 paMultiY</h1><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">Menu Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Command_Line_Usage"><span class="tocnumber">3</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#X-Function_Execution_Options"><span class="tocnumber">4</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Variables"><span class="tocnumber">5</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Description"><span class="tocnumber">6</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Example"><span class="tocnumber">7</span> <span class="toctext">Example</span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="#Create_an_Analysis_Theme"><span class="tocnumber">7.1</span> <span class="toctext">Create an Analysis Theme</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Perform_Batch_Processing_with_the_Theme"><span class="tocnumber">7.2</span> <span class="toctext">Perform Batch Processing with the Theme</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-10"><a href="#Related_X-Functions"><span class="tocnumber">8</span> <span class="toctext">Related X-Functions</span></a></li>
</ul>
</div>

<h2><a name="Menu_Information"></a><span class="mw-headline">Menu Information</span></h2>
<p>Batch Peak Analysis Using Theme
</p>
<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Perform batch processing of multiple spectra using peak analyzer theme
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
1. paMultiY iy:=[MultiplePeaks]Sheet1!(A,B:E) theme:="IntegratePeaks";
</p><p>2. paMultiY iy:=[MultiplePeaks]Sheet1!(A,B:E) theme:="IntegratePeaks" number:=2 clear:=1;
</p><p>3. paMultiY iy:=[MultiplePeaks]Sheet1!(A,B:E) theme:="myPeaksfit" initvalues:=1;
</code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Input
</td>
<td>iy
</td>
<td>
<p>Input
</p><p>XYRange
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> Specify the input datasets. Note that beginning with Origin 2020b, there is a shortened syntax that follows the form [Book]Sheet!(X,Y1:YN), X = the common X column and Y1:YN = a contiguous range of Y columns to the right of the X column. More complex strings from non-contiguous data of the form [Book]Sheet!((X,Y1:YN),(X,YM:YO)) are also possible.
</td></tr>
<tr>
<td>Theme
</td>
<td>theme
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td> Specify the theme that used to perform peak analysis.
</td></tr>
<tr>
<td>Result Sheet
</td>
<td>append
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> The peak analysis on each dataset will generate a workbook. You can choose a worksheet in the workbook with this variable and the information in the worksheet will be appended to the Output Sheet.
<p>Option list:
</p>
<ul><li><i>none:&lt;none&gt;</i>
<dl><dd>With this option, peak analysis will be performed on each dataset but the data of the Result Sheet will not be appended to the Output Sheet. </dd></dl></li></ul>
<dl><dd></dd></dl>
<ul><li><i>integrate:Integrate Results</i>
<dl><dd>It is available only when the theme is saved by using Integrate Peaks in Peak Analyzer.</dd></dl></li>
<li><i>baseline:Baseline</i>
<dl><dd>It is available only when the theme is saved by using Create Baseline in Peak Analyzer. </dd></dl></li></ul>
<dl><dd></dd></dl>
<ul><li><i>peak_centers:Peak Centers</i>
<dl><dd>It is available only when the theme is saved by using Find Peaks in Peak Analyzer.</dd></dl></li>
<li><i>peak_properties:Peak Properties</i>
<dl><dd>It is available only when the theme is saved by using Fit Peaks in Peak Analyzer. </dd></dl></li></ul>
<dl><dd></dd></dl>
</td></tr>
<tr>
<td>Include Fit Statistics in Report
</td>
<td>fitresult
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> Specify whether include the Fit statistics in the result report. It is invisible in GUI if append mode is by column.
</td></tr>
<tr>
<td>Output Sheet
</td>
<td>ow
</td>
<td>
<p>Output
</p><p>Worksheet
</p>
</td>
<td> <center>[Summary]Results!</center>
</td>
<td> Specify the worksheet for outputting the result of the peak analysis performed to each input dataset.
</td></tr>
<tr>
<td>Delete Intermediate Result
</td>
<td>remove
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> Specify whether to delete the intermediate analysis outputs that are generated by performing the peak analysis on the input datasets.
</td></tr>
<tr>
<td>Dataset Identifier
</td>
<td>dataid
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>Range</center>
</td>
<td> Specify full range, long name, units or user-defined parameters of input data as the dataset name in the summary report.
</td></tr>
<tr>
<td>Designation
</td>
<td>desig
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>&lt;auto&gt;</center>
</td>
<td> Specify the resource of Dataset Identifier, decide to get it from the X column or Y column of the range
</td></tr>
<tr>
<td>Starting Row of Output Sheet
</td>
<td>number
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> Specify the starting row of the Output worksheet from which the results are appended.
</td></tr>
<tr>
<td>Clear Output Sheet on Start
</td>
<td>clear
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> Specify whether to clear the Output Sheet before appending results to it.
</td></tr>
<tr>
<td>Append Label Rows (1st File)
</td>
<td>label
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify whether to append label rows of the first Result Sheet into the Output Sheet.
</td></tr>
<tr>
<td>Append by
</td>
<td>mode
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify the way to append the data to Output Sheet.
<p>Option list:
</p>
<ul><li><i>rows:Rows</i>
<dl><dd>Append the data by rows.</dd></dl></li>
<li><i>cols:Columns</i>
<dl><dd>Append the data by columns. </dd></dl></li></ul>
<dl><dd></dd></dl>
</td></tr>
<tr>
<td>Sequentially Initialize Parameter Values
</td>
<td>initvalues
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> When this option is selected, the peak information saved in theme will only be applied to 1st dataset in the batch processing. subsequent dataset will use peak initialization values form previous dataset's fitting result.
</td></tr>
<tr>
<td>Script Before Each Process
</td>
<td>beforescript
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td> Scripts in this edit box will be executed before peak analysis performed on each one of the input datasets.
<p>Note that:
</p><p><b>_rx</b> refers to the range of i-th x dataset 
<b>_ry</b> refers to the range of i-th y dataset 
<b>_skip</b> determines if i-th file/dataset will be skipped
</p>
</td></tr>
<tr>
<td>Script after Each Process
</td>
<td>loopscript
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td> The script in this edit box will be executed each time peak analysis is performed on one of the input datasets.
<p>Note that:
<b>_i</b> refers to the index of i-th file/dataset 
</p>
</td></tr>
<tr>
<td>Script at the End
</td>
<td>endscript
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>&lt;unassigned&gt;</center>
</td>
<td> The Scripts in this edit box will be executed after peak analysis has been performed on all of the input datasets.
</td></tr>
<tr>
<td>Use Background Instance(s) to Process
</td>
<td>instance
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> Run multiple Origin processes to increase processing speed. We suggest to set the value to be the number of logical cores of your computer minus 1 to reach the maximum benefit. That is, if the number of logical cores is 8, set the value to be 7
<p><br />
To know the logical cores of your computer. type following script in the "Script Window" and press Enter to run it.
<br />
<code>
@logprocs= 
</code>
</p><p><br />
</p>
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>This X-Function performs peak fitting to multiple datasets with the same set of settings. The settings must be saved to a analysis theme file in advanced. Results perform to different datasets can be summarized in a summary worksheet.
</p>
<h2><a name="Example"></a><span class="mw-headline">Example</span></h2>
<p>The following example will first create an analysis theme and then show you how to use this X-Function to perform peak analysis on multiple datasets.
</p><p>This example shows you how to create an analysis theme in the Peak Analyzer and then use the theme
</p>
<h3><a name="Create_an_Analysis_Theme"></a><span class="mw-headline">Create an Analysis Theme</span></h3>
<ol><li>Create a worksheet and import the <i>Multiple Peaks.data</i> in the <b>Samples\Curve Fitting</b> folder.</li>
<li>Highlight column B and select <b>Analysis: Peak and Baseline: Peak Analyzer</b> to open the <b>Peak Analyzer</b>. </li>
<li>Select <b>Integrate Peaks</b> in the <b>Goal</b> group and then click the <b>Next</b> button 4 times to go to the <b>Integrate Peaks</b> page. </li>
<li>Click the triangular button in the upper right corner of the dialog and select <b>Save As</b>. Type <b>MyIntegratePeaks</b> in the <b>Theme Name</b> edit box. Click the <b>OK</b> button to close this dialog and then click <b>Finish</b> to integrate peaks.</li></ol>
<h3><a name="Perform_Batch_Processing_with_the_Theme"></a><span class="mw-headline">Perform Batch Processing with the Theme</span></h3>
<p>Select the <b>Multiple Peaks</b> worksheet and highlight all the Y columns. Then select <b>Analysis: Peak and Baseline: Batch Peak Analysis using Theme</b> to open the dialog. Then set the dialog as the following image shows. Click the <b>OK</b> button to perform the analysis. 
</p>
<dl><dd><a  class="image"><img alt="BatchPeakAnalysis.png" src="../images/PaMultiY/BatchPeakAnalysis.png?v=83818" width="521"  /></a></dd></dl>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">Related X-Functions</span></h2>
<p><a href="../../XFunction/X-Function/BatchProcess.html" title="X-Function:BatchProcess">X-Function:BatchProcess</a>, <a href="../../XFunction/X-Function/Blauto.html" title="X-Function:Blauto">blauto</a>, <a href="../../XFunction/X-Function/Fitpeaks.html" title="X-Function:Fitpeaks">fitpeaks</a>, <a href="../../XFunction/X-Function/Pa.html" title="X-Function:Pa">pa</a>, <a href="../../XFunction/X-Function/PkFind.html" title="X-Function:PkFind">pkFind</a>, <a href="../../XFunction/X-Function/NLfitpeaks.html" title="X-Function:NLfitpeaks">NLfitpeaks</a>
</p>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>spectrum, summary report</span></p>






