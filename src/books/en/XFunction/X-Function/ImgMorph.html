<h1 class="firstHeading">2.6.3.4 imgMorph(Pro)</h1><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">Menu Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Additional_Information"><span class="tocnumber">3</span> <span class="toctext">Additional Information</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Command_Line_Usage"><span class="tocnumber">4</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#X-Function_Execution_Options"><span class="tocnumber">5</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Variables"><span class="tocnumber">6</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Description"><span class="tocnumber">7</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Examples"><span class="tocnumber">8</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Algorithm"><span class="tocnumber">9</span> <span class="toctext">Algorithm</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#References"><span class="tocnumber">10</span> <span class="toctext">References</span></a></li>
<li class="toclevel-1 tocsection-11"><a href="#Related_X-Functions"><span class="tocnumber">11</span> <span class="toctext">Related X-Functions</span></a></li>
</ul>
</div>

<h2><a name="Menu_Information"></a><span class="mw-headline">Menu Information</span></h2>
<p>Image: Arithmetic Transform: Morphological Filter
</p>
<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Apply morphological filter to matrix or image
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">Additional Information</span></h2>
<p>This feature is for OriginPro only.
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
1. imgMorph op:=open emode:=diamond r:=5;
</p><p>2. imgMorph op:=erosion emode:=rec col:=5 row:=4;
</p><p></code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Input Image
</td>
<td>im
</td>
<td>
<p>Input
</p><p>MatrixObject
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td>
<p>Specifies the input image, which should be a numeric matrix, a grayscale image or a binary image. The default input is the active image.
</p>
</td></tr>
<tr>
<td>Output Image
</td>
<td>om
</td>
<td>
<p>Output
</p><p>MatrixObject
</p>
</td>
<td> <center>&lt;new&gt;</center>
</td>
<td>
<p>Specifies the output image. By default, a new image will be created and used as output.
See the syntax <a class="external text" href="../../XFunction/X-Function/Output_Notations.html">here</a>.
</p>
</td></tr>
<tr>
<td>Operation
</td>
<td>op
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>open</center>
</td>
<td>
<p>Specifies the morphological operation to perform.
<br />
Option list
</p>
<ul><li><i>dilation:Dilation</i>
<dl><dd>Incorporates each object all the background points that are in contact of it, causing the object to grow in size. This operation can be used to removing holes in segmented objects.</dd></dl></li>
<li><i>erosion:Erosion</i>
<dl><dd>Decreases the size of the objects by one pixel all around its perimeter. This operation can be used to remove objects that are too small.</dd></dl></li>
<li><i>open:Open</i>
<dl><dd>Performs erosion and then dilation on the objects. Small and thin objects can be removed, without significantly changing the areas of the larger objects.</dd></dl></li>
<li><i>close:Close</i>
<dl><dd>Performs dilation and then erosion on the objects. Small holes in objects can be filled and nearby objects can be connected. However, the areas of the objects are not affected significantly.</dd></dl></li></ul>
</td></tr>
<tr>
<td>Flat Element
</td>
<td>flat
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td>
<p>Specifies whether or not to use a flat structuring element.
</p>
</td></tr>
<tr>
<td>Height Matrix
</td>
<td>hm
</td>
<td>
<p>Input
</p><p>MatrixObject
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td>
<p>This variable is available only when Flat Element is set to 0. It specifies the matrix that has the heights of the structuring element.
</p>
</td></tr>
<tr>
<td>Create Element
</td>
<td>emode
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>rec</center>
</td>
<td>
<p>Specifies the structuring element.
<br />
Option list
</p>
<ul><li><i>arb:Arbitrary</i>
<dl><dd>Uses a matrix object to represent the structuring element. You can specify this matrix object with the Element variable.</dd></dl></li>
<li><i>diamond:Diamond</i>
<dl><dd>Creates a diamond-shaped object. You can specify its radius with the Radius variable.</dd></dl></li>
<li><i>line:Line</i>
<dl><dd>Creates a line object. You can specify its length and angle with two variables: Length and Angle.</dd></dl></li>
<li><i>octagon:Octagon</i>
<dl><dd>Creates an octagonal object. You can specify its radius with the Radius variable.</dd></dl></li>
<li><i>pair:Pair</i>
<dl><dd>Creates a structuring element containing a pair of dots. One dot locates in the center; the other one's location is determined by two variables: Row Offset and Column offset.</dd></dl></li>
<li><i>pl:Periodicline</i>
<dl><dd>Creates a structuring element that contains 2*p+1 dots, where p is determined by the Points in One Side variable. The relative positions of the dots are determined by another two variables: Row Offset and Column offset.</dd></dl></li>
<li><i>rec:Rectangle</i>
<dl><dd>Creates a rectangle object. You can specify its width and height with two variables: Column and Row.</dd></dl></li>
<li><i>square:Square</i>
<dl><dd>Creates a square object. You can specify its width with the Width variable.</dd></dl></li></ul>
</td></tr>
<tr>
<td>Element Matrix
</td>
<td>em
</td>
<td>
<p>Input/Output
</p><p>MatrixObject
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td>
<p>This variable is available only when the Create Element variable is set to Arbitrary. You can use it to specify a matrix object that represents the structuring element.
</p>
</td></tr>
<tr>
<td>Column
</td>
<td>col
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>3</center>
</td>
<td>
<p>This variable is available only when the Create Element variable is set to Rectangle. It specifies the width of the rectangle.
</p>
</td></tr>
<tr>
<td>Row
</td>
<td>row
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>3</center>
</td>
<td>
<p>This variable is available only when the Create Element variable is set to Rectangle. It specifies the height of the rectangle.
</p>
</td></tr>
<tr>
<td>Width
</td>
<td>w
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>3</center>
</td>
<td>
<p>This variable is available only when the Create Element variable is set to Square. It specifies the width of the square.
</p>
</td></tr>
<tr>
<td>Radius
</td>
<td>r
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>3</center>
</td>
<td>
<p>This variable is available only when the Create Element variable is set to either Diamond or Octagon. It specifies the radius of the structuring object.
</p>
</td></tr>
<tr>
<td>Row Offset
</td>
<td>roffset
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>This variable is available only when the Create Element variable is set to either Periodicline or Pair. It specifies the row offset between two adjacent members.
</p>
</td></tr>
<tr>
<td>Column Offset
</td>
<td>coffset
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>This variable is available only when the Create Element variable is set to either Periodicline or Pair. It specifies the column offset between two adjacent members.
</p>
</td></tr>
<tr>
<td>Length
</td>
<td>len
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>5</center>
</td>
<td>
<p>This variable is available only when the Create Element variable is set to line. It specifies the length of the line object.
</p>
</td></tr>
<tr>
<td>Angle (in degrees)
</td>
<td>deg
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>5</center>
</td>
<td>
<p>This variable is available only when the Create Element variable is set to line. It specifies the angle for the line object. The unit is degree.
</p>
</td></tr>
<tr>
<td>Points in One Side
</td>
<td>np
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>5</center>
</td>
<td>
<p>This variable is available only when the Create Element variable is set to Periodicline. It specifies a number p. And then, there will be 2*p+1 dots in the structuring element.
</p>
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<table class="noborder" width="90%">

<tr style="vertical-align:top">
<td>
<p>This X-Function is a tool for morphological image processing. It can be used on numeric matrices, grayscale images and binary images.
</p><p>Generally speaking, morphological image processing is performed by passing a structuring element over the image in a convolution-like operation. The output image is determined by the size and shape of the structuring element, as well as the operation chosen. Morphological Filter is a very important tool widely used in suppressing noise, image segmentation, etc.
</p><p>A structuring element can be of any shape and any size. It is a matrix consisting of only 0's and 1's, where the 1's defines the neighborhood. Using different shapes of structuring elements is likely to have different effects. And the selection of shape should be determined on a case-by-case basis. The rule of thumb is to choose a shape that is close to the geometric shape of the object of interest. The size of the structuring element is also influential. For example, in erosion operation, if you specify a larger size, only some larger elements in the image are preserved and more small elements are eliminated. If you specify a smaller size, the smaller elements and the details of the image will be more likely to be retained.
</p><p>Four morphological operations are available in this tool. They are <i>dilation</i>, <i>erosion</i>, <i>open</i> and <i>close</i>. Erosion decreases the size of the objects in the input image, while dilation increases the object sizes. Opening eliminates small and thin objects, leaving the large objects without significant changes in area. Closing fills small holes in objects and smoothes the object boundaries, but it does not change the area of the objects in a significant way. You can choose among these operations according to your need.
</p>
</td>
<td><a  class="image"><img alt="MorphSetting.png" src="../images/ImgMorph/MorphSetting.png?v=79780" width="316"  /></a>
</td></tr></table>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p>In this example, the input image contains several square objects with different sizes. We use the <i>imgMorph</i> X-Function to remove the small objects from it. The procedure is as follows:
</p>
<ol><li> Create a new matrix and imports the image file into it.</li>
<li> When the image is active, select <b>Image: Arithmetic Transform: Morphological Filter</b> from the menu to open the dialog of the X-Function.</li>
<li> In the X-Function dialog, change the settings as the screenshot below and click <b>OK</b><br /> to close the dialog.<br /><a  class="image"><img alt="ImgMorph help English files image002.jpg" src="../images/ImgMorph/ImgMorph_help_English_files_image002.jpg?v=1090" width="349"  /></a><br /> The output image and the structure elements are created. We can see that the output image only has large squares.</li></ol>
<dl><dd><table class="TableGrid" style="border: none; x-border-left: 1px table-solid; x-border-top: 1px table-solid; x-border-right: 1px table-solid; x-border-bottom: 1px table-solid; border-collapse: separate; border-spacing: 0px; border-spacing: 0px" border="1">
<tr>
<td>
<center><a  class="image"><img alt="ImgMorph help English files image004.jpg" src="../images/ImgMorph/ImgMorph_help_English_files_image004.jpg?v=1091" width="294"  /></a></center>
</td>
<td>
<center><a  class="image"><img alt="ImgMorph help English files image006.jpg" src="../images/ImgMorph/ImgMorph_help_English_files_image006.jpg?v=1092" width="294"  /></a></center>
</td></tr>
<tr>
<td>
<center>Input Image</center>
</td>
<td>
<center>Output Image</center>
</td></tr></table></dd></dl>
<p><br />
Structuring Element <br />
</p>
<dl><dd><a  class="image"><img alt="ImgMorph help English files image008.jpg" src="../images/ImgMorph/ImgMorph_help_English_files_image008.jpg?v=1093" width="393"  /></a></dd></dl>
<p><br />
Note: OriginPro includes the ability to automatically recalculate the analysis result of the Morphological Filter operation any time you change the parameters or update your source data. In addition, the settings for the analysis routine can be saved to an analysis theme for later use with similar data.
</p>
<h2><a name="Algorithm"></a><span class="mw-headline">Algorithm</span></h2>
<p>To perform morphological filter on the input image, the structuring element is passed over the image. Let B be the input image and S be the structuring element. We denote by Sxy the translated structuring element whose origin is located at the point (x,y).
</p><p>The output for erosion can be expressed as follows:
</p>
<dl><dd><a  class="image"><img alt="Erosion.png" src="../images/ImgMorph/Erosion.png?v=5282" width="115"  /></a></dd></dl>
<p>And the output for dilation is:
</p>
<dl><dd><a  class="image"><img alt="Dilation2.png" src="../images/ImgMorph/Dilation2.png?v=5281" width="146"  /></a></dd></dl>
<p>where <a  class="image"><img alt="Dilation s.png" src="../images/ImgMorph/Dilation_s.png?v=5283" width="17"  /></a> is reflection of set S, is defined as
</p>
<dl><dd><a  class="image"><img alt="Dilation reflection.png" src="../images/ImgMorph/Dilation_reflection.png?v=5286" width="129"  /></a>.</dd></dl>
<p>Open operation is carried out by performing erosion once and then dilation once. And closing is carried out by performing dilation once and then erosion once.
</p>
<h2><a name="References"></a><span class="mw-headline">References</span></h2>
<p>Kenneth R.Castleman.1996. <i>Digital Image Processing.</i> Prentice Hall, Upper Saddle River, NJ, USA.
</p>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">Related X-Functions</span></h2>
<p><a href="../../XFunction/X-Function/ImgUserfilter.html" title="X-Function:ImgUserfilter">imgUserfilter</a>
</p>





