<h1 class="firstHeading">2.6.3.6 imgReplaceBg(Pro)</h1><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">Menu Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Additional_Information"><span class="tocnumber">3</span> <span class="toctext">Additional Information</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Command_Line_Usage"><span class="tocnumber">4</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#X-Function_Execution_Options"><span class="tocnumber">5</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Variables"><span class="tocnumber">6</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Description"><span class="tocnumber">7</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Examples"><span class="tocnumber">8</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Algorithm"><span class="tocnumber">9</span> <span class="toctext">Algorithm</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#References"><span class="tocnumber">10</span> <span class="toctext">References</span></a></li>
<li class="toclevel-1 tocsection-11"><a href="#Related_X-Functions"><span class="tocnumber">11</span> <span class="toctext">Related X-Functions</span></a></li>
</ul>
</div>

<h2><a name="Menu_Information"></a><span class="mw-headline">Menu Information</span></h2>
<p>Image: Arithmetic Transform: Replace Background
</p>
<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Replace background color of image
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">Additional Information</span></h2>
<p>This feature is for OriginPro only.
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
</p><p>1. imgReplaceBg bgl:=100 bgh:=120 adj_b:=-70;
</p><p>2. imgReplaceBg fuzzi:=22 adj_b:=74 bg:=dark;
</p><p>3. imgReplaceBg oimg:=&lt;input&gt;;
</p><p></code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Input Matrix
</td>
<td>img
</td>
<td>
<p>Input
</p><p>Image
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td>
<p>Specifies the input image to be manipulated. The default input is the active image.
</p>
</td></tr>
<tr>
<td>Output Image
</td>
<td>oimg
</td>
<td>
<p>Output
</p><p>Image
</p>
</td>
<td> <center>&lt;new&gt;</center>
</td>
<td>
<p>Specifies the output image. By default, a new image will be created and used as output.
See the syntax <a class="external text" href="../../XFunction/X-Function/Output_Notations.html">here</a>.
</p>
</td></tr>
<tr>
<td>Low Threshold to Replace
</td>
<td>bgl
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>100</center>
</td>
<td>
<p>Specifies the lower threshold value of the color range to be replaced. The value should be an integer between 0 and 255. When the dialog of the X-Function is opened, this value will be automatically initialized according to the auto detected background of the input image.
</p>
</td></tr>
<tr>
<td>High Threshold to Replace
</td>
<td>bgh
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>200</center>
</td>
<td>
<p>Specifies the higher threshold value of the color range to be replaced. The value should be an integer between 0 and 255. When the dialog of the X-Function is opened, this value will be automatically initialized according to the auto detected background of the input image.
</p>
</td></tr>
<tr>
<td>Fuzziness
</td>
<td>fuzzi
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>50</center>
</td>
<td>
<p>Specifies the fuzziness value used for determining a color range around the specified color. The colors within this range are similar to the specified color and all of them will be replaced. Note that fuzziness value should be an integer between 1 and 100
</p>
</td></tr>
<tr>
<td>Adjust Brightness
</td>
<td>adj_b
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>50</center>
</td>
<td>
<p>Specifies the percentage increase/decrease of the brightness for the colors to be replaced. The value should be an integer between -100 and 100. A negative value will cause the brightness to be reduced while a positive value will result in brightness increase.
</p>
</td></tr>
<tr>
<td>Background
</td>
<td>bg
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>bright</center>
</td>
<td>
<p>Specifies whether or not the background is brighter than the foreground. This is used to initialize the thresholds when the dialog of the X-Function is opened.
<br />
Option list
</p>
<ul><li><i>dark:Darker than the Foreground</i>
<dl><dd>Choose this option when the background is in general darker than the foreground.</dd></dl></li>
<li><i>bright:Brighter than the Foreground</i>
<dl><dd>Choose this option when the background is in general brighter than the foreground.</dd></dl></li></ul>
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>This function in OriginPro picks a range of intensities to be the background and replace these intensities with new ones. 
</p><p>The background is the range of intensities between the lower threshold and the higher threshold, which can be automatically detected by analyzing the histogram of the image or be estimated roughly by the user. When the dialog of this function is opened, the lower and higher threshold of the background intensities range can be estimated roughly, and the estimates will be used as the initial values for two threshold variables. User can then adjust them to specify the color range to be replaced.
</p><p>In addition, user can opt to replace other intensities similar to the specified background intensities with the <b>Fuzziness</b> variable. With this feature, it is more likely to obtain a smooth output image. When this X-Function is executed, the intensities in the background will be replaced by adjusting their value of brightness with the variable <b>Adjust Brightness</b>.
</p>
<dl><dd><a  class="image"><img alt="ReplaceBKSetting2.png" src="../images/ImgReplaceBg/ReplaceBKSetting2.png?v=79786" width="375"  /></a></dd></dl>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<p>The following example shows you how a background was replaced by a background roughly estimated by the user.
</p>
<ol><li>  Create a new matrix and import <b>myocyte.tif</b> under \Samples\Image Processing and Analysis folder into it.</li>
<li>  Select <b>Image: Arithmetic Transform: Replace Background...</b> from the menu to open the dialog. Change the settings as shown below and click OK.</li></ol>
<dl><dd><a  class="image"><img alt="ImgReplaceBg help English files image002.jpg" src="../images/ImgReplaceBg/ImgReplaceBg_help_English_files_image002.jpg?v=1115" width="553"  /></a></dd></dl>
<p><b>The input image is replaced and the background is changed into a very bright color.</b>
</p>
<table class="TableGrid" style="border: none; x-border-left: 1px table-solid; x-border-top: 1px table-solid; x-border-right: 1px table-solid; x-border-bottom: 1px table-solid; border-collapse: separate; border-spacing: 0px; border-spacing: 0px" border="1">
<tr>
<td>
<center><a  class="image"><img alt="ImgReplaceBg help English files image004.jpg" src="../images/ImgReplaceBg/ImgReplaceBg_help_English_files_image004.jpg?v=1116" width="239"  /></a></center>
</td>
<td>
<center><a  class="image"><img alt="ImgReplaceBg help English files image006.jpg" src="../images/ImgReplaceBg/ImgReplaceBg_help_English_files_image006.jpg?v=1117" width="239"  /></a></center>
</td></tr>
<tr>
<td>
<center><b>The original image</b></center>
</td>
<td>
<center><b>The output image</b></center>
</td></tr></table>
<p><br />
Note: OriginPro includes the ability to automatically recalculate the analysis result of the Replace Background operation any time you change the parameters or update your source data. In addition, the settings for the analysis routine can be saved to an analysis theme for later use with similar data.
</p>
<h2><a name="Algorithm"></a><span class="mw-headline">Algorithm</span></h2>
<p>When the dialog of this X-Function is opened, the background of the input image is automatically detected. The detection is based on the histogram of the image: After the computation of the histogram, the peaks on the histogram curve are picked and two tallest peaks are identified. Either of these two peaks is chosen as the background, depending on the <b>Background</b> variable. If <i>Darker than the Foreground</i> is chosen, the peak that corresponds to a lower intensity will be regarded as the peak for the background. Otherwise, the peak that corresponds to a higher intensity will be regarded as the peak for the background. When the peak for the background is chosen, its intensity (x value at its center) will be regarded as the background intensity and the foot markers of this peak will be used to initialize the <b>Low</b> <b>Threshold</b> <b>to Replace</b> variable and the <b>High</b> <b>Threshold to Replace</b> variable.
</p><p>When this X-Function is executed, the color in the specified color range will be replaced by applying the adjusted brightness to the pixels within the range.
</p><p>For more information on how the histogram is calculated and how the color is replaced, please refer to the LEADTOOLS Main API Help file, Version 14 and read the L_GetBitmapHistogram and L_ColorReplaceBitmap topics.
</p>
<h2><a name="References"></a><span class="mw-headline">References</span></h2>
<p>LEADTOOLS Main API Help file, Version 14
</p>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">Related X-Functions</span></h2>
<p><a href="../../XFunction/X-Function/ImgColorReplace.html" title="X-Function:ImgColorReplace">imgColorReplace</a>, <a href="../../XFunction/X-Function/ImgBrightness.html" title="X-Function:ImgBrightness">imgBrightness</a>, <a href="../../XFunction/X-Function/ImgHistogram.html" title="X-Function:ImgHistogram">imgHistogram</a>
</p>





