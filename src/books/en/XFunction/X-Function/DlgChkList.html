<h1 class="firstHeading">2.14.2.6 dlgChkList</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Brief_Information"><span class="tocnumber">1</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Additional_Information"><span class="tocnumber">2</span> <span class="toctext">Additional Information</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Command_Line_Usage"><span class="tocnumber">3</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#X-Function_Execution_Options"><span class="tocnumber">4</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Variables"><span class="tocnumber">5</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Description"><span class="tocnumber">6</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Examples"><span class="tocnumber">7</span> <span class="toctext">Examples</span></a></li>
</ul>
</div>

<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>A simple checklist dialog that outputs user choices to worksheet
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">Additional Information</span></h2>
<p><b>Minimum Origin Version Required</b>: 8.5 SR0
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<pre>
Dataset vnStat;
// Creates a dialog with 2 checkboxes. The 1-based indices of the checked checkboxes is output to the Dataset.
dlgChkList  inames:=&quot;Descriptive Statistics|Normality Test&quot; osel:=vnStat;  

</pre>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Check Names
</td>
<td>inames
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>&quot;Case 1|Case 2|Case 3&quot;</center>
</td>
<td> String contains the text names for the checkboxes in the dialog. Individual texts are separated by '|' within the string.
</td></tr>
<tr>
<td>Dialog Title
</td>
<td>title
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>Checkbox List</center>
</td>
<td> The text that appears in the title bar for the dialog.
</td></tr>
<tr>
<td>Description
</td>
<td>desc
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>Please select the needed cases</center>
</td>
<td> A text description for the dialog. It is displayed above the checkboxes in the dialog.
</td></tr>
<tr>
<td>Choices
</td>
<td>ochks
</td>
<td>
<p>Input
</p><p>vector
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td> A vector (e.g. A Loose Dataset) specifying each checkbox's checked status.
<ul><li> 0: unchecked</li>
<li> 1: checked</li></ul>
</td></tr>
<tr>
<td>Selected Indices
</td>
<td>osel
</td>
<td>
<p>Output
</p><p>vector
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td> A vector containing the indices of the checked checkboxes once dialog closes. Unchecked ones are not included in vector. The index is 1-offset.
</td></tr>
<tr>
<td>Selected as a comma separated string
</td>
<td>olist
</td>
<td>
<p>Output
</p><p>string
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td> A string of selected checkbox indices separated by commas. Same as <b>osel</b> output variable but in a delimited-string form.
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>This X-Function opens a dialog with an arbitrary number of checkboxes whose texts are based on a delimited-string input variable. The status of the checked checkoxes is available once the dialog is closed. It can be used to provide interactive options in Labtalk script.
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<ul><li> Code Sample 1.</li></ul>
<p>In this example, the use of the <b>dlgChkList</b> X-function will not only be illustrated, but a <b><a class="external text" href="../../LabTalk/LabTalk/StringArray_(object).html">StringArray</a></b> will be used to build a list of checkbox texts, a <b><a class="external text" href="../../LabTalk/LabTalk/Datasets_(object).html">Loose Dataset</a></b> will be used to specify which checkboxes are checked by default, and the results will be iterated to output which checkboxes were checked.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Create StringArray of checkbox texts and Dataset of which are checked by default.</span>
StringArray saTexts;
Dataset dsDefaults;
<span style="color: #008000;">// Add texts to StringArray and default checked states to Dataset (0=unchecked, 1=checked).</span>
saTexts.<span style="color: #000080;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Option #1&quot;</span><span style="color: #000000;">&#41;</span>;
dsDefaults.<span style="color: #000080;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
saTexts.<span style="color: #000080;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Option #2&quot;</span><span style="color: #000000;">&#41;</span>;
dsDefaults.<span style="color: #000080;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
saTexts.<span style="color: #000080;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Option #3&quot;</span><span style="color: #000000;">&#41;</span>;
dsDefaults.<span style="color: #000080;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
saTexts.<span style="color: #000080;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Option #4&quot;</span><span style="color: #000000;">&#41;</span>;
dsDefaults.<span style="color: #000080;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
saTexts.<span style="color: #000080;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Option #5&quot;</span><span style="color: #000000;">&#41;</span>;
dsDefaults.<span style="color: #000080;">Add</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// Combine texts in StringArray into a single string variable with each option separated by a &quot;|&quot;.</span>
string strTexts<span style="color: #000080;">$</span>;
int nSize <span style="color: #000080;">=</span> saTexts.<span style="color: #000080;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
loop<span style="color: #000000;">&#40;</span>nn, <span style="color: #0000dd;">1</span>, nSize<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	strTexts<span style="color: #000080;">$</span> <span style="color: #000080;">+</span><span style="color: #000080;">=</span> saTexts.<span style="color: #000080;">GetAt</span><span style="color: #000000;">&#40;</span>nn<span style="color: #000000;">&#41;</span><span style="color: #000080;">$</span>;
	if <span style="color: #000000;">&#40;</span>nn <span style="color: #000080;">!</span><span style="color: #000080;">=</span> nSize<span style="color: #000000;">&#41;</span>
		strTexts<span style="color: #000080;">$</span> <span style="color: #000080;">+</span><span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;|&quot;</span>;
<span style="color: #000000;">&#125;</span>
<span style="color: #008000;">// Create a Dataset to hold the indices of the checkboxes that get checked while dialog is open. </span>
Dataset dsChecked;
<span style="color: #008000;">// Integer flag to determine if Cancel button was clicked in dialog.</span>
<span style="color: #008000;">// Must set it to true (1) to work properly.</span>
int nCancelled <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;

<span style="color: #008000;">// Surround X-Function call with braces to trap any error returned during execution.</span>
<span style="color: #008000;">// If user clicks the Cancel button, there would be an error generated. This will stop that behavior.</span>
<span style="color: #000000;">&#123;</span>
dlgChkList inames<span style="color: #000000;">:</span><span style="color: #000080;">=</span>strTexts<span style="color: #000080;">$</span> title<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Options Dialog&quot;</span> desc<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Select one or more options.&quot;</span> ochks<span style="color: #000000;">:</span><span style="color: #000080;">=</span>dsDefaults osel<span style="color: #000000;">:</span><span style="color: #000080;">=</span>dsChecked;
<span style="color: #008000;">// If user clicked the Cancel button, the following line will not run and nCancelled will remain equal to 1.</span>
nCancelled <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>;
<span style="color: #000000;">&#125;</span>
<span style="color: #008000;">// Test of user clicked the Cancel button and if so, stop script execution.</span>
if <span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span> <span style="color: #000080;">==</span> nCancelled<span style="color: #000000;">&#41;</span>
	return;

<span style="color: #008000;">// User did not click Cancel, so output the checked checkboxes by looping through the Dataset of indices</span>
<span style="color: #008000;">// and using the values from that Dataset to get the relevant Texts from the original StringArray.</span>
type <span style="color: #ff00ff;">&quot;You have checked:&quot;</span>;
int nSize <span style="color: #000080;">=</span> dsChecked.<span style="color: #000080;">GetSize</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
loop<span style="color: #000000;">&#40;</span>nn, <span style="color: #0000dd;">1</span>, nSize<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	<span style="color: #008000;">// Because GetAt() returns a string, don't forget to add a $ at end of function call.</span>
	type saTexts.<span style="color: #000080;">GetAt</span><span style="color: #000000;">&#40;</span>dsChecked<span style="color: #000000;">&#91;</span>nn<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">$</span>;
<span style="color: #000000;">&#125;</span></pre>
<ul><li> Code Sample 2.</li></ul>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// The following script allow user to pick a few sheets from the active book and do</span>
<span style="color: #008000;">// row average on each column and output the results into Mean,N, SD sheets in the same book</span>
<span style="color: #008000;">//prepare two sheets with data</span>
string fn1<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span><span style="color: #000080;">+</span><span style="color: #ff00ff;">&quot;Samples\Curve Fitting\Dose Response - Inhibitor.dat&quot;</span>;
string fn2<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span><span style="color: #000080;">+</span><span style="color: #ff00ff;">&quot;Samples\Curve Fitting\Dose Response - No Inhibitor.dat&quot;</span>;
newbook;
impASC fn1<span style="color: #000080;">$</span>;
newsheet;
impASC fn2<span style="color: #000080;">$</span>;
string sheets<span style="color: #000080;">$</span>;<span style="color: #008000;">// string to hold all sheet names from active book</span>
loop<span style="color: #000000;">&#40;</span>ii,<span style="color: #0000dd;">1</span>,page.<span style="color: #000080;">nLayers</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	range ss <span style="color: #000080;">=</span> <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>ii<span style="color: #000000;">&#41;</span><span style="color: #000080;">!</span>;
	if<span style="color: #000000;">&#40;</span>ii <span style="color: #000080;">&gt;</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span> sheets<span style="color: #000080;">$</span><span style="color: #000080;">+</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;|&quot;</span>;
	sheets<span style="color: #000080;">$</span> <span style="color: #000080;">+</span><span style="color: #000080;">=</span> ss.<span style="color: #000080;">name</span><span style="color: #000080;">$</span>;
<span style="color: #000000;">&#125;</span>
dataset vnSels;
string strSelShts;

dlgChkList i<span style="color: #000000;">:</span><span style="color: #000080;">=</span>sheets<span style="color: #000080;">$</span> olist<span style="color: #000000;">:</span><span style="color: #000080;">=</span>strSelShts osel<span style="color: #000000;">:</span><span style="color: #000080;">=</span>vnSels;

if<span style="color: #000000;">&#40;</span>strSelShts.<span style="color: #000080;">GetLength</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">&lt;</span> <span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	type <span style="color: #ff00ff;">&quot;No sheet selected&quot;</span>;
	return <span style="color: #0000dd;">0</span>;
<span style="color: #000000;">&#125;</span>
int nSel <span style="color: #000080;">=</span> vnSels<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span>;<span style="color: #008000;">// first selected sheet</span>
range s1 <span style="color: #000080;">=</span> <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>nSel<span style="color: #000000;">&#41;</span><span style="color: #000080;">!</span>;
int ncols<span style="color: #000080;">=</span>s1.<span style="color: #000080;">ncols</span>;<span style="color: #008000;">//save number of columns of first selected sheet</span>
<span style="color: #008000;">//ncols=;</span>
loop<span style="color: #000000;">&#40;</span>i,<span style="color: #0000dd;">1</span>,ncols<span style="color: #000000;">&#41;</span> 
<span style="color: #000000;">&#123;</span>
   rowstats <span style="color: #000000;">&#40;</span><span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>strSelShts<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">!</span>wcol<span style="color: #000000;">&#40;</span>i<span style="color: #000000;">&#41;</span> mean<span style="color: #000000;">:</span><span style="color: #000080;">=</span>Mean<span style="color: #000080;">!</span>wcol<span style="color: #000000;">&#40;</span>i<span style="color: #000000;">&#41;</span> n<span style="color: #000000;">:</span><span style="color: #000080;">=</span>N<span style="color: #000080;">!</span>wcol<span style="color: #000000;">&#40;</span>i<span style="color: #000000;">&#41;</span> sd<span style="color: #000000;">:</span><span style="color: #000080;">=</span>SD<span style="color: #000080;">!</span>wcol<span style="color: #000000;">&#40;</span>i<span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>






