<h1 class="firstHeading">2.13.3.3 hcluster(Pro)</h1><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">Menu Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Additional_Information"><span class="tocnumber">3</span> <span class="toctext">Additional Information</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Command_Line_Usage"><span class="tocnumber">4</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#X-Function_Execution_Options"><span class="tocnumber">5</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Variables"><span class="tocnumber">6</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Description"><span class="tocnumber">7</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Examples"><span class="tocnumber">8</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Algorithm"><span class="tocnumber">9</span> <span class="toctext">Algorithm</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#References"><span class="tocnumber">10</span> <span class="toctext">References</span></a></li>
<li class="toclevel-1 tocsection-11"><a href="#Related_X-Functions"><span class="tocnumber">11</span> <span class="toctext">Related X-Functions</span></a></li>
</ul>
</div>

<h2><a name="Menu_Information"></a><span class="mw-headline">Menu Information</span></h2>
<p>Statistics: Multivariate Analysis: Hierarchical Cluster Analysis
</p>
<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Perform hierarchical cluster analysis
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">Additional Information</span></h2>
<p>This feature is for OriginPro only.
</p><p>Minimum Origin Version Required:8.6
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
</p>
<ol><li> hcluster irng:=2:5 label:=1 number:=2;</li>
<li> hcluster irng:=4:15 obj:=1 number:=3;</li></ol>
<p></code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Variables
</td>
<td>irng
</td>
<td>
<p>Input
</p><p>Range
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> Select data range for the hierarchical cluster analysis. Note that beginning with Origin 2020b, there is a shortened syntax that follows the form [Book]Sheet!(N1:N2), N1 = the beginning column index and N2 being the ending column index in a contiguous range of columns. More complex strings from non-contiguous data of the form [Book]Sheet!([Book]Sheet!N1:N2,[Book]Sheet!N3:N4) are also possible.
</td></tr>
<tr>
<td>Observation Labels
</td>
<td>label
</td>
<td>
<p>Input
</p><p>Range
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td> Select labels for observations. If labels are chosen, they will be shown as ticks of X axis in the dendrogram. This option is enabled only when <i>obj</i> is <i>Observations</i>.
</td></tr>
<tr>
<td>Cluster
</td>
<td>obj
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify the type of objects to cluster.
<p>Option list:
</p>
<ul><li><i>Observations</i>
<dl><dd> Cluster observations.</dd></dl></li>
<li><i>Variables</i>
<dl><dd> Cluster variables.</dd></dl></li></ul>
</td></tr>
<tr>
<td>Cluster Method
</td>
<td>link
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>2</center>
</td>
<td> Select the linkage method to calculate the distance between a cluster and a new cluster. Values start from 0, but string values (such as <i>near</i>) are recommended for clarity.
<p>Option list:
</p>
<ul><li><i>near:Nearest neighbor</i>
<dl><dd> The minimum of two distances between a cluster and two clusters merged to a new cluster. Also called single linkage.</dd></dl></li>
<li><i>furth:Furthest neighbor</i>
<dl><dd> The maximum of distances between a cluster and two clusters merged to a new cluster. Also called complete linkage.</dd></dl></li>
<li><i>group:Group average</i>
<dl><dd> The mean of two distances between a cluster and two clusters merged to a new cluster.</dd></dl></li>
<li><i>centroid:Centroid</i>
<dl><dd> Clusters are produced that maximize the distance between the centers of clusters. </dd></dl></li>
<li><i>median:Median</i>
<dl><dd> The median distance between an item in one cluster and an item in the other cluster. </dd></dl></li>
<li><i>ward:Ward</i>
<dl><dd> Clusters are produced that minimize the within-cluster variance.</dd></dl></li></ul>
<p>To learn more about linkage methods, see <a class="external text" href="../../UserGuide/UserGuide/Algorithm_(Hierarchical_Cluster_Analysis).html#Linkage_Method">the algorithm of linkage methods</a>. 
</p>
</td></tr>
<tr>
<td>Distance Type
</td>
<td>dist1
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Select a distance type in the hierarchical cluster analysis when <i>obj</i> is <i>Observations</i>. Values start from 0, but string values (such as <i>euc</i>) are recommended for clarity.
<p>Option list:
</p>
<ul><li><i>euc:Euclidean</i>
<dl><dd> The square root of the sum of the squared differences between two observations. </dd></dl></li>
<li><i>squ:Squared Euclidean</i>
<dl><dd> The sum of the squared differences between two observations.</dd></dl></li>
<li><i>city:City block</i>
<dl><dd> The sum of the absolute differences between two observations. Also known as Manhattan distance. </dd></dl></li></ul>
</td></tr>
<tr>
<td>Distance Type
</td>
<td>dist2
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Select a distance type in the hierarchical cluster analysis when <i>obj</i> is <i>Variables</i>. Values start from 0, but string values (such as <i>corr</i>) are recommended for clarity.
<p>Option list:
</p>
<ul><li><i>corr:Correlation</i>
<dl><dd> The difference between 1 and the correlation of two variables. </dd></dl></li>
<li><i>abs:Absolute correlation</i>
<dl><dd> The difference between 1 and the absolute correlation of two variables.</dd></dl></li></ul>
</td></tr>
<tr>
<td>Standardize Variables
</td>
<td>std
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify the method to standardize variables. It is available only when <i>obj</i> is <i>Observations</i>. Values start from 0, but string values (such as <i>snd</i>) are recommended for clarity.
<p>Option list:
</p>
<ul><li><i>none:None</i>
<dl><dd> Variables are not standardized. </dd></dl></li>
<li><i>snd:Z scores (standardize to N(0, 1))</i>
<dl><dd> Variables are transformed to the standard normal distribution. </dd></dl></li>
<li><i>range:Normalize to (0, 1)</i>
<dl><dd> Variable are transformed to the range of 0 and 1</dd></dl></li></ul>
</td></tr>
<tr>
<td>Number of Clusters
</td>
<td>number
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> Specify the number of clusters.
</td></tr>
<tr>
<td>Find Clustroid by
</td>
<td>stat
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td><center>0</center>
</td>
<td>Specify the method to find the clustroid: the most/least representative variable/observation.
<p>Option list:
</p>
<ul><li><i>sd:Sum of distances</i>
<dl><dd> Find Clustroid using the sum of distances measured from all other observations/variables in the cluster.</dd></dl></li>
<li><i>md:Maximum distance</i>
<dl><dd> Find Clustroid using the Maximum distance among all distances measured from other observations/variables in the cluster. </dd></dl></li>
<li><i>ssd:Sum of squares of distances</i>
<dl><dd> Find Clustroid using the sum of the squares of distances measured from all other observations/variables in the cluster. </dd></dl></li></ul>
</td></tr>
<tr>
<td>Dissimilarity Matrix
</td>
<td>dissimilarity
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify whether to output the distance matrix. For a large number of objects, the distance matrix will be shown in a sheet instead of the report. 1 = Yes, 0 = No.
</td></tr>
<tr>
<td>Cluster Stages
</td>
<td>stage
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> Specify whether to output the cluster stages. 1 = Yes, 0 = No.
</td></tr>
<tr>
<td>Cluster Center
</td>
<td>center
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify whether to calculate cluster centers. It is available only when <i>obj</i> is <i>Observations</i>. 1 = Yes, 0 = No.
</td></tr>
<tr>
<td>Distance between Cluster Centers
</td>
<td>distc2c
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify whether to calculate the distances between cluster centers. It is available only when <i>obj</i> is <i>Observations</i>. 1 = Yes, 0 = No.
</td></tr>
<tr>
<td>Distance between Observations and Clusters
</td>
<td>disto2c
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify whether to calculate the distance between each observation and cluster centers. It is available only when <i>obj</i> is <i>Observations</i>. 1 = Yes, 0 = No.
</td></tr>
<tr>
<td>Dendrogram
</td>
<td>dendrogram
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> Specify whether to show the dendrogram. 1 = Yes, 0 = No.
</td></tr>
<tr>
<td>Show Dendrogram
</td>
<td>ngraph
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify whether to show the dendrogram in a single graph or in separate graphs for clusters. It is enabled only when dendrogram is 1. Values start from 0.
<p>Option list:
</p>
<ul><li> Show the dendrogram in a single graph. Different clusters are shown in different colors. </li>
<li> Show the dendrogram in separate graphs for clusters. Each graph represents a cluster.</li></ul>
</td></tr>
<tr>
<td>Orientation
</td>
<td>orient
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center> 0 </center>
</td>
<td> Specify the orientation of the dendrogram. Enabled only when <b>dendrogram</b> is <b>Yes</b>.
<p>Option List:
</p>
<ul><li><i>0: Vertical</i>
<dl><dd>Plot Dendrogram vertically.</dd></dl></li>
<li><i>1: Horizontal</i>
<dl><dd>Plot Dendrogram horizontally.</dd></dl></li>
<li><i>2: Circular</i>
<dl><dd>Plot circular Dendrogram</dd></dl></li></ul>
</td></tr>
<tr>
<td>Cluster Report
</td>
<td>rt
</td>
<td>
<p>Output
</p><p>ReportTree
</p>
</td>
<td> <center>&lt;new&gt;</center>
</td>
<td> Specify the sheet for the hierarchical cluster analysis report.
</td></tr>
<tr>
<td>Cluster Membership
</td>
<td>rd
</td>
<td>
<p>Output
</p><p>ReportData
</p>
</td>
<td> <center>&lt;new&gt;</center>
</td>
<td> Specify the sheet for cluster membership and distance between observations and clusters.
</td></tr>
<tr>
<td>Distance Matrix
</td>
<td>rddist
</td>
<td>
<p>Output
</p><p>ReportData
</p>
</td>
<td> <center>&lt;new&gt;</center>
</td>
<td> Specify the sheet for distance matrix when number of objects to cluster is very large. This variable is hidden in the dialog.
</td></tr>
<tr>
<td>Plot Data
</td>
<td>rdplot
</td>
<td>
<p>Output
</p><p>ReportData
</p>
</td>
<td> <center>&lt;new&gt;</center>
</td>
<td> Specify the sheet for plot data. This variable is hidden in the dialog.
</td></tr>
<tr>
<td>Clustroid Info
</td>
<td>clustroid
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> Specify the method to find the Clustroid Info: the most/least representative variable/observation
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>This function performs the <b>Hierarchical Cluster Analysis</b> on range data. For more information, see <a class="external text" href="../../UserGuide/Category/Cluster_Analysis.html">the Cluster Analysis</a>.
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<ol><li> Import the data file <b>\Samples\Graphing\US Mean Temperature.dat</b>.</li>
<li> Run the script.</li></ol>
<pre class="lt" style="font-family:monospace;">hcluster irng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">:</span><span style="color: #0000dd;">15</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">100</span><span style="color: #000000;">&#93;</span> number<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">5</span> rd<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000000;">&#91;</span><span style="color: #000080;">&lt;</span>input<span style="color: #000080;">&gt;</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">&lt;</span>input<span style="color: #000080;">&gt;</span> <span style="color: #000080;">-</span>r <span style="color: #0000dd;">2</span>;</pre>
<h2><a name="Algorithm"></a><span class="mw-headline">Algorithm</span></h2>
<p>See <a class="external text" href="../../UserGuide/UserGuide/Algorithm_(Hierarchical_Cluster_Analysis).html">the algorithm of <b>Hierarchical Cluster Analysis</b></a>.
</p>
<h2><a name="References"></a><span class="mw-headline">References</span></h2>
<p>See <a class="external text" href="../../UserGuide/UserGuide/Reference_(Cluster_Analysis).html">the reference of <b>Cluster Analysis</b></a>.
</p>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">Related X-Functions</span></h2>
<p><a href="../../XFunction/X-Function/Pca.html" title="X-Function:Pca">pca</a>, <a href="../../XFunction/X-Function/Kmeans.html" title="X-Function:Kmeans">kmeans</a>, <a href="../../XFunction/X-Function/Discrim.html" title="X-Function:Discrim">discrim</a>
</p>





