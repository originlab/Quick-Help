<h1 class="firstHeading">2.2.3.68 wsort</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Brief_Information"><span class="tocnumber">1</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Additional_Information"><span class="tocnumber">2</span> <span class="toctext">Additional Information</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Command_Line_Usage"><span class="tocnumber">3</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#X-Function_Execution_Options"><span class="tocnumber">4</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Variables"><span class="tocnumber">5</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Description"><span class="tocnumber">6</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Examples"><span class="tocnumber">7</span> <span class="toctext">Examples</span></a></li>
</ul>
</div>

<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Sort worksheet based on selected columns
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">Additional Information</span></h2>
<p>X-Function not designed for Auto GetN Dialog.
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<pre>
1. wsort descending:=1; 
2. wsort descending:=1 bycol:=2 c1:=1 c2:=3; 
3. wsort bycol:=1 irng:=(2[5]:3[8],5[5]:6[8]);
4. wsort bycol:=1 irng:=(1:2,4:end);
</pre>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Worksheet to do sorting
</td>
<td>w
</td>
<td>
<p>Input/Output
</p><p>Worksheet
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td>
<p>Specified worksheet to sort
</p>
</td></tr>
<tr>
<td>Sort By Column
</td>
<td>bycol
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td>
<p>Specified the column data as the sort criteria. It is used when you want to sort worksheet by one column.
</p>
</td></tr>
<tr>
<td>Decending or ascending
</td>
<td>descending
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>Specified sorting by descending or ascending order.
</p>
</td></tr>
<tr>
<td>sort numeric_suffix
</td>
<td>sortnumeric
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>Whether to Sort by Numeric Suffix
</p>
</td></tr>
<tr>
<td>Nested Sort Columns
</td>
<td>nestcols
</td>
<td>
<p>Input
</p><p>vector
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td>
<p>indices of columns used as sorting criteria. It is used when you want to sort worksheet by multiple columns 
</p>
</td></tr>
<tr>
<td>Sort Orders
</td>
<td>order
</td>
<td>
<p>Input
</p><p>vector
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td>
<p>sorting order index, 1 ascending, 0 descending. Its size should match the one of <b>Nested Sort Columns</b>.
</p>
</td></tr>
<tr>
<td>Column From
</td>
<td>c1
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td>
<p>Start index of columns selected for sorting. 
</p>
</td></tr>
<tr>
<td>Column To
</td>
<td>c2
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>End index of columns selected for sorting.
</p>
</td></tr>
<tr>
<td>Row From
</td>
<td>r1
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td>
<p>Start index of rows selected for sorting.
</p>
</td></tr>
<tr>
<td>Row To
</td>
<td>r2
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>End index of rows selected for sorting
</p>
</td></tr>
<tr>
<td>Missing is Largest
</td>
<td>missing
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>Whether the missing value as largest.
</p>
</td></tr>
<tr>
<td>Range to Sort
</td>
<td>irng
</td>
<td>
<p>Input
</p><p>range
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td>
<p>Specified ranges to sort. The range can be non-contiguous. If it has an effective value, c1, c2, r1, r2 will be ignored.
</p>
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>This function is used to sort the worksheet by some column <i>bycol</i> (as index). Or nested sorted by some columns <i>nestcols</i>, then we can also set descending or ascending by each column order. We can specified the range(start row, end row, start column, end column or range variable irng) to sort. We can also sort by numeric suffix column(as index).
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<ul><li> Code Sample</li></ul>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000; font-style: regular;">/*
This example uses the wsort X-Function to perform nested sorting. The data 
will be reordered so that the height column is in descending order. If there 
are multiple rows with the same height, these rows will be sorted by the 
weight column in ascending order.
1. Import the sample data into a book in Origin;
2. Sort the data with the wsort X-Function.
*/</span>
<span style="color: #008000;">//Create a new workbook</span>
newbook result<span style="color: #000000;">:</span><span style="color: #000080;">=</span>bkname<span style="color: #000080;">$</span>;	
<span style="color: #008000;">//Import a file</span>
path<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Statistics\&quot;</span>;
fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> path<span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;body.dat&quot;</span>;
impasc;

dataset sbc <span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">4</span>, <span style="color: #0000dd;">5</span><span style="color: #000000;">&#125;</span>; <span style="color: #008000;">//Select the columns for the primary sort and the secondary sort</span>
dataset sodr<span style="color: #000080;">=</span> <span style="color: #000000;">&#123;</span><span style="color: #0000dd;">0</span>, <span style="color: #0000dd;">1</span><span style="color: #000000;">&#125;</span>; <span style="color: #008000;">//Select the sort orders: col(4)--descending, col(5)--ascending</span>
wsort nestcols<span style="color: #000000;">:</span><span style="color: #000080;">=</span>sbc order<span style="color: #000000;">:</span><span style="color: #000080;">=</span>sodr; <span style="color: #008000;">//Perform the nested sorting</span></pre>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>nested sort</span></p>






