<h1 class="firstHeading">2.16.3.11 Details of TreeNodes in Import Excel</h1><p><br />
</p>
<h2><a name="Options"></a><span class="mw-headline">Options</span></h2>
<p>The <b>Options</b> tree specifies all import options for the <b>impExcel</b> X-Function.
</p><p>Syntax:  <b>Options.<i>.SubTree.Treenode</i>:=&lt;value&gt;</b>
</p><p>Example: <b>Options.Names.FNameToSht:=1</b> <br />  
</p><p><br />
</p>
<h3><a name="Names"></a><span class="mw-headline">Names</span></h3>
<p>The <b>Names</b> branch of the <b>Options</b> tree specifies how to name the worksheet and workbook.
</p><p>Syntax: <b>Options.Names.Treenode:= &lt;<i>value</i>&gt;</b>
</p><p>Example: <br />
//Rename worksheet with partial filename &#160;: <br />
<b>Options.Names.FNameToSht:=1</b> <br />  
<b>Options.Names.FNameToShtFrom:=1</b> <br />   
<b>Options.Names.FNameToShtTo:=4</b> <br />  
</p><p><br />
</p>
<table class="treetable">
<tr>
<th> Treenode
</th>
<th> Label
</th>
<th> Type
</th>
<th> Default
</th>
<th> Description
</th></tr>
<tr>
<td>AutoNames
</td>
<td>Auto Rename using file name
</td>
<td>int
</td>
<td>0
</td>
<td>If it is checked, Origin will use the default settings to rename the worksheet and workbook name, which is:
<ul><li>Use the whole filename (includes the file extension) as worksheet name.</li>
<li>Use the whole filename (includes the file extension) as workbook name if current workbook is empty or the import mode is <b>Replace Existing Data</b>.</li></ul>
</td></tr>
<tr>
<td>FNameToBk
</td>
<td>Rename Book with (Partial) Filename
</td>
<td>int
</td>
<td>1
</td>
<td>Check this to use part of the filename as workbook name.
</td></tr>
<tr>
<td>FNameToBkFrom
</td>
<td>Trim Filename From
</td>
<td>int
</td>
<td>1
</td>
<td>Specify the start of the name.
</td></tr>
<tr>
<td>FNameToBkTo
</td>
<td>Trim Filename To
</td>
<td>int
</td>
<td>0
</td>
<td>Specify the end of the name.
</td></tr>
<tr>
<td>FNameToBkLnOnly
</td>
<td>Rename Long Name for Book only
</td>
<td>int
</td>
<td>0
</td>
<td>Check this to rename the long name for book only.
</td></tr>
<tr>
<td>FPathToBk
</td>
<td>Include File Path when Renaming Book
</td>
<td>int
</td>
<td>0
</td>
<td>Specify if the file path should be included for the workbook name.
</td></tr>
<tr>
<td>FNameToBkComm
</td>
<td>Append Filename to Workbook Comment
</td>
<td>int
</td>
<td>1
</td>
<td>Specify if the filename should be appended to the workbook comment.
</td></tr>
<tr>
<td>FPathToComm
</td>
<td>Include path when appending filename
</td>
<td>int
</td>
<td>1
</td>
<td>When this is checked, the import file path is appended to the workbook's command and/or Comments row.
</td></tr></table>
<table class="note">

<tr>
<td><b>Notes:</b>
<p>From Origin 8.6, minus value is supported in <b>Trim Filename From</b> and <b>Trim Filename To</b> to count the end of the name from the last character of the file name. It can be used to trim the file extension. For example, if you want to import an Excel book named <i>sample.xls</i>, you can specify as follow to trim the extension "<i>.xls</i>":
</p>
<dl><dd><b>Trim Filename From</b>: 1</dd>
<dd><b>Trim Filename To</b>: -4</dd></dl>
</td></tr></table>
<p><br />
</p>
<h3><a name="Script"></a><span class="mw-headline">Script</span></h3>
<p>The <b>Script</b> branch of the <b>Options</b> tree specifies the LabTalk scripts to run after file(s) being imported.
</p><p>Syntax: <b>options.scripts.Treenode:= &lt;<i>string</i>&gt;</b>
</p><p>Example: <br />
//Plot second column for each imported file &#160;: <br />
<b>options.scripts.ScriptAfterEachImport:="plotxy 2;";</b> <br />  
</p><p>//When all files being imported, loop over all worksheets in all workbooks and delete first 500 rows from column 1 to column 4.
<br />
<b>options.scripts.ScriptAfterAllImport:=" doc -ef W { doc -e LW { range aa =1[1]:4[500]; del aa;}}";<br /></b>
</p><p><br />
</p>
<table class="treetable">
<tr>
<th> Treenode
</th>
<th> Label
</th>
<th> Type
</th>
<th> Default
</th>
<th> Description
</th></tr>
<tr>
<td>ScriptAfterEachImport
</td>
<td>Script after Each File Imported
</td>
<td>string
</td>
<td>"?"
</td>
<td>Specify LabTalk scripts that will be executed after each imported file.
</td></tr>
<tr>
<td>ScriptAfterAllImport
</td>
<td>Script after All Files Imported
</td>
<td>string
</td>
<td>"?"
</td>
<td>Specify LabTalk scripts that will be executed only after all files being imported.
</td></tr></table>






