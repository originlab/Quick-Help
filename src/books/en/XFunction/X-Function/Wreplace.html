<h1 class="firstHeading">2.2.3.63 wreplace</h1><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Brief_Information"><span class="tocnumber">1</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Command_Line_Usage"><span class="tocnumber">2</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#X-Function_Execution_Options"><span class="tocnumber">3</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Variables"><span class="tocnumber">4</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Description"><span class="tocnumber">5</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Examples"><span class="tocnumber">6</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Related_X-Functions"><span class="tocnumber">7</span> <span class="toctext">Related X-Functions</span></a></li>
</ul>
</div>

<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Find and replace cell value in a worksheet
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<pre>
1. wreplace find_value:=0 replace_value:=0 cond_value:=lt;
2. wreplace rng:=col(1) type:=str find_str:=&quot;a*c&quot; replace_str:=&quot;abc&quot; wildcards:=1;
3. wreplace col(A)[1]:end[40] find_value:=-- replace_value:=0;
</pre>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Input
</td>
<td>rng
</td>
<td>
<p>Input/Output
</p><p>Range
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> Specify the range to perform the replacing.
</td></tr>
<tr>
<td>Data Type
</td>
<td>type
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify the type of data to find and replace.
<p>Option list:
</p>
<ul><li><i>num:Numeric </i>
<dl><dd>To find and replace numeric data.</dd></dl></li>
<li><i>str:String</i>
<dl><dd>To find and replace string.</dd></dl></li></ul>
</td></tr>
<tr>
<td>Find What (-- for Missing Value)
</td>
<td>find_value
</td>
<td>
<p>Input
</p><p>double
</p>
</td>
<td> <center></center>
</td>
<td> This is only available when <b>Number</b> (num) is selected for <b>Data Type</b> (the <b>type</b> variable). Combined with the operator selected for the <b>Condition</b> variable, the value of this variable defines the condition used to find the values to be replaced. "--" stands for the missing value here.
</td></tr>
<tr>
<td>Find What
</td>
<td>find_str
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center></center>
</td>
<td> This is only available when <b>String</b> (str) is selected for <b>Data Type</b> (the <b>type</b> variable). Use it to specify the string to find.
</td></tr>
<tr>
<td>Condition
</td>
<td>cond_value
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> This is only available when <b>Number</b> (num) is selected for <b>Data Type</b> (the <b>type</b> variable). It specifies an operator. Combined with the value specified by <b>Find What</b> (the <b>find_value</b> variable), we can define the condition that is used to find the data to be replaced.
<p>Option list:
</p>
<ul><li><i>eq:Data=</i>
<dl><dd>Find data that is equal to the <i>Find What</i> value. </dd></dl></li>
<li><i>lt:Data&lt;</i>
<dl><dd>Find data that is less than the <i>Find What</i> value.</dd></dl></li>
<li><i>le:Data&lt;=</i>
<dl><dd>Find data that is not greater than the <i>Find What</i> value. </dd></dl></li>
<li><i>gt:Data&gt;</i>
<dl><dd>Find data that is greater than the <i>Find What</i> value. </dd></dl></li>
<li><i>ge:Data&gt;=</i>
<dl><dd>Find data that is not less then the <i>Find What</i> value. </dd></dl></li>
<li><i>ne:Data&lt;&gt;</i>
<dl><dd>Find data that is not equal to the <i>Find What</i> value. </dd></dl></li></ul>
</td></tr>
<tr>
<td>Replace With
</td>
<td>replace_value
</td>
<td>
<p>Input
</p><p>double
</p>
</td>
<td> <center></center>
</td>
<td> This is only available when <b>Number</b> (num) is selected for <b>Data Type</b> (the <b>type</b> variable). It specifies the new value with which all the found cells will be replaced.
</td></tr>
<tr>
<td>Replace With
</td>
<td>replace_str
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center></center>
</td>
<td> This is only available when <b>String</b> (str) is selected for <b>Data Type</b> (the <b>type</b> variable). It specifies the new string with which all the found strings will be replaced.
</td></tr>
<tr>
<td>Tolerance
</td>
<td>tolerance
</td>
<td>
<p>Input
</p><p>double
</p>
</td>
<td> <center>1E-8</center>
</td>
<td> This is only available when <b>Number</b> (num) is selected for <b>Data Type</b> (the <b>type</b> variable). It specifies the tolerance used to find the worksheet data to be replaced. If the absolute difference between the worksheet data value and the <b>Find What</b> value is less than the tolerance, these two values will be regarded as equal.
</td></tr>
<tr>
<td>Use Absolute Value
</td>
<td>use_abs
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> This is only available when <b>Number</b> (num) is selected for <b>Data Type</b> (the <b>type</b> variable). It specifies whether or not to use the absolute values of the worksheet data to test the given condition. This is disabled when <b>Condition</b> is "&gt;" or "&lt;" or "&lt;&gt;".
</td></tr>
<tr>
<td>Keep Sign if Condition True
</td>
<td>keep_sign
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> This is only available when <b>Number</b> (num) is selected for <b>Data Type</b> (the <b>type</b> variable). It specifies whether to keep the sign of the original value if the condition is true and the worksheet data is replaced.
</td></tr>
<tr>
<td>Set as Missing if Condition False
</td>
<td>set_missing
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> This is only available when <b>Number</b> (num) is selected for <b>Data Type</b> (the <b>type</b> variable). It specifies whether or not to set missing value to cells whose original values do not meet the condition.
</td></tr>
<tr>
<td>Match Whole Word Only
</td>
<td>cond_str
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> This is only available when <b>String</b> (str) is selected for <b>Data Type</b> (the <b>type</b> variable). It specifies whether the string to find should match the exact whole string you typed.
</td></tr>
<tr>
<td>Case Sensitive
</td>
<td>con_case
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> This is only available when <b>String</b> (str) is selected for <b>Data Type</b> (the <b>type</b> variable). It specifies whether the string search is case sensitive or not.
</td></tr>
<tr>
<td>Skip Link Cells
</td>
<td>skip_link
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify whether to skip cells that contain links.
</td></tr>
<tr>
<td>Use Wildcards
</td>
<td>wildcards
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify whether wildcards are allowed or not. If wildcards are used, "*" can stand for arbitrary string and "?" can stand for any arbitrary character.
</td></tr>
<tr>
<td>Include Label Rows
</td>
<td>label
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify whether to include column label rows (LongName, Unit, Comment, etc.) to search.
</td></tr>
<tr>
<td>
</td>
<td> undo
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify whether to allow undo.
</td></tr>
<tr>
<td>Look In
</td>
<td>lookin
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>6</center>
</td>
<td> Specify where to search the specified value or string.
<p>Option list:
</p>
<ul><li><i>active_sheet:Active Worksheet</i>
<dl><dd>The active worksheet will be searched.</dd></dl></li>
<li><i>active_book:Active Workbook</i>
<dl><dd>The active workbook will be searched.</dd></dl></li>
<li><i>all_in_active_folder:All Workbooks in Active Folder</i>
<dl><dd>All workbooks in the active folder will be searched. But those in the subfolders will not be searched.</dd></dl></li>
<li><i>recursive_in_active_folder:All Workbooks in Active Folder (Resursive)</i>
<dl><dd>All workbooks in the active folder will be searched, including those in the subfolders.</dd></dl></li>
<li><i>open_in_active_folder:All Workbooks in Active Folder (Open)</i>
<dl><dd>All non-hidden workbooks in the active folder will be searched. But those in the subfolders will not be searched.</dd></dl></li>
<li><i>all_in_project:All Workbooks in Project</i>
<dl><dd>All workbooks in the project will be searched.</dd></dl></li>
<li><i>specified:Specified Range</i>
<dl><dd>The range specified by the <b>rng</b> variable will be searched.</dd></dl></li></ul>
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>This X-Function is capable of finding and replacing texts or numbers in worksheet cells.
</p>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<ul><li> Code Sample</li></ul>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000; font-style: regular;">/*
This example uses the X-Function wreplace to find the negative values, and replace them with zero.
1. Import the sample data into a book in Origin;
2. Find and replace those negative values in the 
active sheet with zero.
*/</span>
<span style="color: #008000;">// Create a new workbook</span>
newbook;
<span style="color: #008000;">// Import a file</span>
string fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Curve Fitting\Multiple Peaks.dat&quot;</span>;
impasc;
<span style="color: #008000;">// Find and replace those negative values</span>
wreplace type<span style="color: #000000;">:</span><span style="color: #000080;">=</span>num find_value<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> cond_value<span style="color: #000000;">:</span><span style="color: #000080;">=</span>lt replace_value<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span> lookin<span style="color: #000000;">:</span><span style="color: #000080;">=</span>active_sheet;
<span style="color: #008000; font-style: regular;">/*
The following example will use the X-Function wreplace to 
replace the missing values with 1250.
1. Import the sample data into a book in Origin.
2. Replace missing values with 1250.
*/</span>
<span style="color: #008000;">// Create a new workbook</span>
newbook;
<span style="color: #008000;">// Import a file</span>
string fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Graphing\Box Chart.dat&quot;</span>;
impasc;

<span style="color: #008000;">// Replace the missing values with 1250</span>
wreplace rng<span style="color: #000000;">:</span><span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span>a<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">:</span>end<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">31</span><span style="color: #000000;">&#93;</span> find_value<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000080;">--</span> replace_value<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1250</span>;</pre>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">Related X-Functions</span></h2>
<p><a href="../../XFunction/X-Function/Mreplace.html" title="X-Function:Mreplace">mreplace</a>
</p>





