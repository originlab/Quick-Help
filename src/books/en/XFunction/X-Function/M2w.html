<h1 class="firstHeading">2.2.1.1 m2w</h1><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Menu_Information"><span class="tocnumber">1</span> <span class="toctext">Menu Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Brief_Information"><span class="tocnumber">2</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Additional_Information"><span class="tocnumber">3</span> <span class="toctext">Additional Information</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Command_Line_Usage"><span class="tocnumber">4</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#X-Function_Execution_Options"><span class="tocnumber">5</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Variables"><span class="tocnumber">6</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Description"><span class="tocnumber">7</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Examples"><span class="tocnumber">8</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Related_X-Functions"><span class="tocnumber">9</span> <span class="toctext">Related X-Functions</span></a></li>
</ul>
</div>

<h2><a name="Menu_Information"></a><span class="mw-headline">Menu Information</span></h2>
<p>Matrix: Convert to Worksheet 
</p>
<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Convert the Matrix data into a Worksheet
</p>
<h2><a name="Additional_Information"></a><span class="mw-headline">Additional Information</span></h2>
<p>Minimum Origin Version Required: Origin 8 SR0, updated in Origin 8.5.1
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<p><code>
1. m2w;
</p><p>2. m2w im:=[MBook1]MSheet1!Mat(1) ow:=[Book1]Sheet1!;
</p><p>3. m2w method:=direct xy:=xcol ycol:=1 xlabel:=row1; 
</p><p>4. m2w method:=xyz option:=yconst;
</p><p>5. m2w method:=xyz trim:=1;
</p><p>6. m2w -r 1 ims:=[MBook1]MSheet2! method:=xyz multi:=all;
</code>
</p>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Input Matrix
</td>
<td>im
</td>
<td>
<p>Input
</p><p>MatrixObject
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td>
<p>Specifies the source matrix object. 
</p>
</td></tr>
<tr>
<td>Input Matrix
</td>
<td>ims
</td>
<td>
<p>Input
</p><p>MatrixLayer
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td>
<p>Specifies the source matrix sheet. If you want to convert all objects in a Matrix sheet, you need to use the <b>ims</b> to specify the source instead of <b>im</b>.
<br />It is only available when <b>method:=xyz, multi:=1</b>.
</p>
</td></tr>
<tr>
<td>Method
</td>
<td>method
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>direct</center>
</td>
<td>
<p>Specifies the conversion method.<br />
Option list:<br />
</p>
<ul><li><i>direct:Direct</i>
<dl><dd>Direct conversion</dd></dl></li>
<li><i>xyz:XYZ Columns&lt;/nowiki&gt;</i>
<dl><dd>Creates a worksheet with XYZ columns.</dd></dl></li></ul>
</td></tr>
<tr>
<td>Data Format
</td>
<td>xy
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>xcol</center>
</td>
<td>
<p>This variable is available only when <b>Direct</b> is selected for <b>Method</b>. It specifies how to arrange the data in the target worksheet.<br />
Option list:
</p>
<ul><li><i>xcol:X across columns</i>
<dl><dd>Matrix values corresponding the same X value will be arranged in a column, while any two matrix values that correspond to different X values will be arranged in different columns. You may also opt to output the X values with the <b>X Values in</b> variable.</dd></dl></li>
<li><i> ycol:Y across columns</i>
<dl><dd>Matrix values corresponding the same Y value will be arranged in a column, while any two matrix values that correspond to different Y values will be arranged in different columns. You may also opt to output the Y values with the <b>Y</b> <b>Values in</b> variable.</dd></dl></li>
<li><i> noxy:No X and Y</i>
<dl><dd>Matrix X and Y values will not be output.</dd></dl></li></ul>
</td></tr>
<tr>
<td>Y Values in First Column
</td>
<td>ycol
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>This is available only when <b>X across columns</b> is selected for <b>Data Format</b>. It specifies whether to output the matrix Y values to the first column of the target worksheet.
</p>
</td></tr>
<tr>
<td>X Values in First Column
</td>
<td>xcol
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>This is available only when <b>Y across columns</b> is selected for <b>Data Format</b>. It specifies whether to output the matrix X values to the first column of the target worksheet.
</p>
</td></tr>
<tr>
<td>X Values in
</td>
<td>xlabel
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>none</center>
</td>
<td>
<p>This is available only when <b>X across columns</b> is selected for <b>Data Format</b>. It specifies whether to output the matrix X values and, if you want to output them, the place to save them.
<br />
Option list:
</p>
<ul><li><i>none:None</i>
<dl><dd>The matrix X values will not be output.</dd></dl></li>
<li><i>row1</i>:First Row
<dl><dd>Outputs the matrix X values to the first row of the target worksheet.</dd></dl></li>
<li><i> syspara:System Parameters</i>
<dl><dd>Outputs the matrix X values to the system parameter row of the target worksheet. See the <b>System Parameters</b> variable below.</dd></dl></li>
<li><i> userpara:User Defined </i>
<dl><dd>Outputs the matrix X values to a user parameter row of the target worksheet. See the <b>User Defined Parameter</b> variable below.</dd></dl></li></ul>
</td></tr>
<tr>
<td>Y Values in
</td>
<td>ylabel
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>none</center>
</td>
<td>
<p>This is available only when <b>Y across columns</b> is selected for <b>Data Format</b>. It specifies whether to output the matrix Y values and, if you want to output them, the place to save them.
<br />
Option list:
</p>
<ul><li><i>none:None</i>
<dl><dd>The matrix Y values will not be output.</dd></dl></li>
<li><i> row1:First Row</i>
<dl><dd>Outputs the matrix Y values to the first row of the target worksheet.</dd></dl></li>
<li><i> syspara:System Parameters</i>
<dl><dd>Outputs the matrix Y values to a system parameter row of the target worksheet. See the <b>System Parameters</b> variable below.</dd></dl></li>
<li><i> userpara:User Defined</i>
<dl><dd>Outputs the matrix Y values to a user parameter row of the target worksheet. See the <b>User Defined Parameter</b> variable below.</dd></dl></li></ul>
</td></tr>
<tr>
<td>System Parameters
</td>
<td>sysparam
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>p1</center>
</td>
<td>
<p>This is available only when <b>System Parameters</b> is selected for <b>X Values in</b> or <b>Y Values in</b>. It specifies the system parameter column label row that will be used to save the matrix X/Y values.
<br />
Option list:
</p>
<ul><li><i>p1: Parameter 1</i>
<dl><dd>The <b>Parameter 1</b> column label row.</dd></dl></li>
<li><i>p2: Parameter 2</i>
<dl><dd>The <b>Parameter 2</b> column label row.</dd></dl></li>
<li><i>p3: Parameter 3</i>
<dl><dd>The <b>Parameter 3</b> column label row.</dd></dl></li>
<li><i>p4: Parameter 4</i>
<dl><dd>The <b>Parameter 4</b> column label row.</dd></dl></li>
<li><i>p5: Parameter 5</i>
<dl><dd>The <b>Parameter 5</b> column label row.</dd></dl></li>
<li><i>p6: Parameter 6</i>
<dl><dd>The <b>Parameter 6</b> column label row.</dd></dl></li>
<li><i>p7: Parameter 7</i>
<dl><dd>The <b>Parameter 7</b> column label row.</dd></dl></li>
<li><i>p8: Parameter 8</i>
<dl><dd>The <b>Parameter 8</b> column label row.</dd></dl></li>
<li><i>p9: Parameter 9</i>
<dl><dd>The <b>Parameter 9</b> column label row.</dd></dl></li>
<li><i>p10: Parameter 10</i>
<dl><dd>The <b>Parameter 10</b> column label row.</dd></dl></li></ul>
</td></tr>
<tr>
<td>User Defined Parameter
</td>
<td>userdef
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center>UserDefined</center>
</td>
<td>
<p>This is available only when <b>System Parameters</b> is selected for <b>X Values in</b> or <b>Y Values in</b>. It specifies a user parameter row to save the matrix X/Y values.
</p>
</td></tr>
<tr>
<td>Convert on
</td>
<td>multi
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td>
<p>When there are multiple Matrix objects in a Matrix sheet, you can specify to convert one object only, or all objects.
<br />It is only available when <b>method:=xyz</b>
</p><p>Option List:
</p>
<ul><li> <i>0=single:Single Object Only</i>
<dl><dd> Only convert the first matrix object.</dd></dl></li>
<li> <i>1=all:All Objects</i>
<dl><dd> Convert all objects in the specified Matrix sheet.</dd></dl></li></ul>
<p><i><b>Note:</b></i> For these two options, the input variable is different.
</p>
</td></tr>
<tr>
<td>Option
</td>
<td>option
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>xconst</center>
</td>
<td>
<p>This variable is available only when <b>XYZ Columns</b> is selected for <b>Method</b>. It specifies how to sort the worksheet values.
<br />
Option list:
</p>
<ul><li><i>xconst</i>:X Const 1st
<dl><dd>Sorts values in the target worksheet by their X mapping values in the source matrix in ascending order first and then by their Y mapping values in ascending order.</dd></dl></li>
<li><i>yconst</i>:Y Const 1st
<dl><dd>Sorts values in the target worksheet by their Y mapping values in the source matrix in ascending order first and then by their X mapping values in ascending order.</dd></dl></li></ul>
</td></tr>
<tr>
<td>Trim Missing Values
</td>
<td>trim
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> This check-box is only available when <b>Method</b> is <b>XYZ Columns</b>. If checked, the missing values in the matrix will be skipped and not included in the result worksheet. If not, the missing values will also show in the result worksheet.
</td></tr>
<tr>
<td>Output Worksheet
</td>
<td>ow
</td>
<td>
<p>Output
</p><p>Worksheet
</p>
</td>
<td> <center>[&lt;new&gt;]&lt;new&gt;</center>
</td>
<td>
<p>Specifies the output worksheet.
</p><p>See the syntax <a class="external text" href="../../XFunction/X-Function/Output_Notations.html">here</a>.
</p>
</td></tr></table>
<h2><a name="Description"></a><span class="mw-headline">Description</span></h2>
<p>The matrix displays a single data set of Z values. It is characterized by:
</p>
<ul><li>numbered columns which are mapped to <i>linearly</i> spaced X values.</li></ul>
<ul><li>numbered rows which are mapped to <i>linearly</i> spaced Y values.</li></ul>
<p>By default, Origin displays the column and row numbers in the column and row headings (left figure). To display X and Y values (right figure) select <b>View: Show X/Y</b> from menu.
</p>
<dl><dd><a  class="image"><img alt="M2w image12.gif" src="../images/M2w/M2w_image12.gif?v=1213" width="455"  /></a></dd></dl>
<p>To convert a matrix into worksheet, there are two methods: direct conversion and creating a worksheet with XYZ columns.
</p><p><b>Direct conversion:</b>
</p><p>1. <i>No X and Y</i>
</p><p>Only the matrix cell values are converted.
</p>
<dl><dd><a  class="image"><img alt="M2w image13.gif" src="../images/M2w/M2w_image13.gif?v=1214" width="291"  /></a></dd></dl>
<p>2. <i>X across columns</i>
</p><p>Matrix values are arranged in worksheet columns according to their X mapping values: Matrix values corresponding the same X value will be arranged in the same column, while any two matrix values that correspond to different X values will be arranged in different columns.
</p><p>In this method, you can specify whether or not to output the matrix X/Y values to the first worksheet row/column, or to a worksheet label. The following example uses direct conversion and puts the X values in the first row and Y values in the first column of the target worksheet:
</p>
<dl><dd><a  class="image"><img alt="M2w image14.gif" src="../images/M2w/M2w_image14.gif?v=1215" width="371"  /></a></dd></dl>
<p>3. <i>Y across columns</i>:
</p><p>Matrix values are arranged in worksheet columns according to their Y mapping values: Matrix values corresponding the same Y value will be arranged in the same column, while any two matrix values that correspond to different Y values will be arranged in different columns.
</p><p>In this method, you can specify whether or not to output the matrix X/Y values to the first worksheet row/column, or to a worksheet label. The following example uses direct conversion and puts the Y values in the <b>Parameters 1</b> row and X values in the first column of the target worksheet:
</p>
<dl><dd><a  class="image"><img alt="M2w image15.png" src="../images/M2w/M2w_image15.png?v=84360" width="475"  /></a></dd></dl>
<p><b>Creating a worksheet with XYZ columns:</b>
</p><p>This method creates a worksheet with X, Y, and Z columns. The cell values of the matrix are converted to Z data in the worksheet. The corresponding X and Y column values in the worksheet are set with the X and Y mapping values in the matrix. And you can specify how to sort the converted worksheet with the <b>Option</b> variable.
</p><p>1. X Const 1st: Sorts values in the target worksheet by their X mapping values in the source matrix in ascending order first and then by their Y mapping values in ascending order.
</p>
<dl><dd><a  class="image"><img alt="M2w image16.gif" src="../images/M2w/M2w_image16.gif?v=1211" width="290"  /></a></dd></dl>
<p>2.  Y Const 1st: Sorts values in the target worksheet by their Y mapping values in the source matrix in ascending order first and then by their X mapping values in ascending order.
</p>
<dl><dd><a  class="image"><img alt="M2w image17.gif" src="../images/M2w/M2w_image17.gif?v=1212" width="294"  /></a></dd></dl>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<ul><li> Code Sample</li></ul>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000; font-style: regular;">/*
This example shows how convert matrix data into XYZ worksheet columns.
The sample data is exe_path\Samples\Matrix Conversion and Gridding\Direct.dat.
1. Load data to a new created matrix.
2. Convert matrix to XYZ worksheet data.
*/</span>
<span style="color: #008000;">// Get sample file name</span>
fn<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Matrix Conversion and Gridding\Direct.dat&quot;</span>;
<span style="color: #008000;">// Create a matrix window</span>
win <span style="color: #000080;">-</span>t matrix origin;
<span style="color: #008000;">// Import data to active matrix</span>
impASC fn<span style="color: #000080;">$</span>;

<span style="color: #008000;">// Convert active matrix to XYZ workshseet data, by X Const 1st option</span>
m2w m<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;</pre>
<h2><a name="Related_X-Functions"></a><span class="mw-headline">Related X-Functions</span></h2>
<p><a href="../../XFunction/X-Function/W2m.html" title="X-Function:W2m">w2m</a>, <a href="../../XFunction/X-Function/R2m.html" title="X-Function:R2m">r2m</a>, <a href="../../XFunction/X-Function/Wexpand2m.html" title="X-Function:Wexpand2m">wexpand2m</a>
</p>





