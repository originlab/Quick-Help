<h1 class="firstHeading">2.2.3.75 wxt</h1><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Brief_Information"><span class="tocnumber">1</span> <span class="toctext">Brief Information</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Command_Line_Usage"><span class="tocnumber">2</span> <span class="toctext">Command Line Usage</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#X-Function_Execution_Options"><span class="tocnumber">3</span> <span class="toctext">X-Function Execution Options</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Variables"><span class="tocnumber">4</span> <span class="toctext">Variables</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Examples"><span class="tocnumber">5</span> <span class="toctext">Examples</span></a></li>
</ul>
</div>

<h2><a name="Brief_Information"></a><span class="mw-headline">Brief Information</span></h2>
<p>Extract worksheet data using a condition
</p>
<h2><a name="Command_Line_Usage"></a><span class="mw-headline">Command Line Usage</span></h2>
<pre>
1. wxt test:=&quot;mod(col(c),2)==1&quot; ow:=&lt;new&gt;;
2. wxt test:=&quot;col(1)&lt;5&quot; sel:=1;
</pre>
<h2><a name="X-Function_Execution_Options"></a><span class="mw-headline">X-Function Execution Options</span></h2>
<p><a class="external text" href="../../LabTalk/LabTalk/X-Function_Execution_Options.html">Please refer to the page for additional option switches when accessing the x-function from script</a>
</p>
<h2><a name="Variables"></a><span class="mw-headline">Variables</span></h2>
<table class="xfvar">
<tr>
<th width="8%">Display<br />Name
</th>
<th width="8%">Variable<br />Name
</th>
<th width="8%">I/O<br />and<br />Type
</th>
<th width="8%">Default<br />Value
</th>
<th>Description
</th></tr>
<tr>
<td>Test Condition
</td>
<td>test
</td>
<td>
<p>Input
</p><p>string
</p>
</td>
<td> <center></center>
</td>
<td> Specify the test condition string.
</td></tr>
<tr>
<td>Worksheet to Extract
</td>
<td>iw
</td>
<td>
<p>Input
</p><p>Worksheet
</p>
</td>
<td> <center>&lt;active&gt;</center>
</td>
<td> Specify the input worksheet.
</td></tr>
<tr>
<td>Column From
</td>
<td>c1
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> Specify the beginning column of the range to perform the extraction.
</td></tr>
<tr>
<td>Column To
</td>
<td>c2
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>-1</center>
</td>
<td> Specify the end column of the range to perform the extraction.
</td></tr>
<tr>
<td>Row From
</td>
<td>r1
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>1</center>
</td>
<td> Specify the beginning row of the range to perform the extraction.
</td></tr>
<tr>
<td>Row To
</td>
<td>r2
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>-1</center>
</td>
<td> Specify the end row of the range to perform the extraction.
</td></tr>
<tr>
<td>Mark passed Cells
</td>
<td>sel
</td>
<td>
<p>Input
</p><p>int
</p>
</td>
<td> <center>0</center>
</td>
<td> Specify the way to mark the passed block of cells (cells that meet the test condition).
<p>Option list:
</p>
<ul><li><i>none:None</i>
<dl><dd>Donâ€™t select or mark the passed block of cells.</dd></dl></li>
<li><i>sel:Select Cells</i>
<dl><dd>Select/highlight the passed rows. </dd></dl></li>
<li><i>mask:Mask Cells</i>
<dl><dd>Mask the passed block of cells.</dd></dl></li></ul>
</td></tr>
<tr>
<td>Extracted
</td>
<td>ow
</td>
<td>
<p>Output
</p><p>Worksheet
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td> Specify the worksheet for output.
<p>See the syntax <a class="external text" href="../../XFunction/X-Function/Output_Notations.html">here</a>.
</p>
</td></tr>
<tr>
<td>On Off for Pass
</td>
<td>val
</td>
<td>
<p>Output
</p><p>vector
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td> The X-Function can output a vector to indicate whether the condition is satisfied for each row in the input worksheet: 1 for true and 0 for false. For example, if this vector has two elements, 1 and 0, it will mean that the first row in the input worksheet satisfies the test condition while the second row does not. You can specify this vector with the <b>val</b> variable.
</td></tr>
<tr>
<td>Indices of Pass
</td>
<td>pass
</td>
<td>
<p>Output
</p><p>vector
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td> Specify a vector which will hold the indices of the passed rows.
</td></tr>
<tr>
<td>Number of rows that pass
</td>
<td>num
</td>
<td>
<p>Output
</p><p>int
</p>
</td>
<td> <center>&lt;optional&gt;</center>
</td>
<td> Specify the output for the number of rows that pass.
<p><br />
</p>
</td></tr></table>
<h2><a name="Examples"></a><span class="mw-headline">Examples</span></h2>
<ul><li> Code Sample-1</li></ul>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//There are special considerations when the condition involves text strings. The following example shows a more complicated condition to select based on both a text column and a numeric column.</span>
<span style="color: #008000;">//import a sample file that has make of cars and their various characteristics</span>
fname<span style="color: #000080;">$</span><span style="color: #000080;">=</span>system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Statistics\automobile.dat&quot;</span>;
newbook;
impasc options.<span style="color: #000080;">sparklines</span><span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;
<span style="color: #008000;">// Select all rows in worksheet with make=Acura and Gas Mileage &gt; 11</span>
<span style="color: #008000;">// Use range variable to make query more readable than &quot;col(Make)[i]$&quot;</span>
range car<span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span>Make<span style="color: #000000;">&#41;</span>;
<span style="color: #008000;">// Using string variable to avoid having to write &quot;Acura&quot; inside &quot; &quot; </span>
string str<span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;Acura&quot;</span>;

<span style="color: #008000;">//wxt will translate &quot;=&quot; to &quot;==&quot;, &quot;and&quot; to &quot;&amp;&amp;&quot;</span>
wxt <span style="color: #ff00ff;">&quot;car=str$ and col(Gas Mileage)&gt;11&quot;</span> sel<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>; <span style="color: #008000;">// Select the rows</span>
wcellcolor c<span style="color: #000000;">:</span><span style="color: #000080;">=</span>color<span style="color: #000000;">&#40;</span>green<span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// Color those rows</span>
wcellsel; <span style="color: #008000;">// Clear the selection</span></pre>
<ul><li> Code Sample-2</li></ul>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000; font-style: regular;">/*
This example uses the wxt X-Function to extract records for females at the age of 14.
1. Import the sample data into a book in Origin;
2. Extract the found rows to a new sheet, output the row 
indexes and count the total number of these rows.
*/</span>
<span style="color: #008000;">//Create a new workbook</span>
newbook result<span style="color: #000000;">:</span><span style="color: #000080;">=</span>bkname<span style="color: #000080;">$</span>;	
<span style="color: #008000;">//Import a file</span>
path<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> system.<span style="color: #000080;">path</span>.<span style="color: #000080;">program</span><span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;Samples\Statistics\&quot;</span>;
fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> path<span style="color: #000080;">$</span> <span style="color: #000080;">+</span> <span style="color: #ff00ff;">&quot;body.dat&quot;</span>;
impasc;
<span style="color: #008000;">//Define two ranges for age column and gender column</span>
range a<span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span>age<span style="color: #000000;">&#41;</span>, g<span style="color: #000080;">=</span>col<span style="color: #000000;">&#40;</span>gender<span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">//Worksheet data extraction</span>
wxt test<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;g==&quot;</span>F<span style="color: #ff00ff;">&quot; &amp; a==14&quot;</span> ow<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>new<span style="color: #000080;">&gt;</span> pass<span style="color: #000000;">:</span><span style="color: #000080;">=&lt;</span>new<span style="color: #000080;">&gt;</span> num<span style="color: #000000;">:</span><span style="color: #000080;">=</span>PassCount;

type <span style="color: #000080;">-</span>b Number of found rows is <span style="color: #000080;">$</span><span style="color: #000000;">&#40;</span>PassCount<span style="color: #000000;">&#41;</span>;</pre>






