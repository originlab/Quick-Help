<h1 class="firstHeading">2.3 Plotting with a User-Defined Template</h1><p>In this tutorial, we will show you how to plot with a user-defined graph template in Labview. Make sure there is a graph template named <b>MyGraphTemplate</b> under path "C:\". (Hint: you can use the the graph template in <b>Tutorial: Customizing Graphs: Customizing a Graph</b>)
</p><p><br />
1. Run Origin. Make sure that there is a Workbook with the default "Book1" and "Sheet1". Fill the first two column with row numbers by selecting the two columns and right click, choose <b>Row Numbers</b> from <b>Fill Columns With</b>.
</p><p>2. Select <b>File: Import: Single ASCII</b> from the menu, then find <b>Linear Fit.dat</b> from <b>&lt;Origin installation folder&gt;\Samples\Curve Fitting\</b>  and make sure the <b>Show Options Dilalog</b> checkbox has been selected. Select <b>Start New Column</b> for <b>Import Options: Import Mode</b>.  Unwrap the <b>(Re)Naming Worksheet and Workbook</b> branch, disable the <b>Rename Sheet with(Partial) Filename</b> and the <b>Rename Book with(Partial) Filename</b> checkboxes. Then click <b>OK</b> button to import the file.
</p><p>3. Run Labview, create a new VI and active the Block Diagram window. Then choose <b>OA_ConnectToOrigin</b> VI <a  class="image"><img alt="OA ConnectToOrigin App.jpg" src="../images/Plotting_with_a_User-Defined_Template/OA_ConnectToOrigin_App.jpg?v=4868" width="32"  /></a> and place it to the window.
</p><p>4. Select and place <b>OA_FindWorksheet</b> VI <a  class="image"><img alt="OA FindWorksheet.jpg" src="../images/Plotting_with_a_User-Defined_Template/OA_FindWorksheet.jpg?v=0" width="34"  /></a>, then wire the <b>Origin.IOApplication</b> and <b>Error IO</b> connectors to the corresponding connectors of the <b>OA_ConnectToOrigin</b> VI. 
</p><p>5. Add a string constant and assign to it the string <b>[Book1]Sheet1</b>. Wire the string constant to the <b>Name</b> connector of <b>OA_FindWorksheet</b> VI.
</p><p>6. Select and place <b>OA_GetColumn</b> VI <a  class="image"><img alt="OA GetColumn.jpg" src="../images/Plotting_with_a_User-Defined_Template/OA_GetColumn.jpg?v=0" width="34"  /></a>, then wire the <b>Origin.Worksheet</b> and <b>Error IO</b> connectors to the corresponding connectors of the <b>OA_FindWorksheet</b> VI.
</p><p>7. Add a numeric constant and set it to 2, and wire it to the <b>Column Name/Index</b> connector of <b>OA_GetColumn</b> VI.
</p><p>8. Select and place <b>OA_Col-Setting</b> VI <a  class="image"><img alt="OA Col-Setting.jpg" src="../images/Plotting_with_a_User-Defined_Template/OA_Col-Setting.jpg?v=25123" width="42"  /></a>, then wire the <b>Origin.Column</b> and <b>Error IO</b> connectors to the corresponding connectors of the <b>OA_GetColumn</b> VI.
</p><p>9. Add a numeric constant and set it to 3, and wire it to the <b>Type</b> connector of <b>OA_Col-Setting</b> VI to set the type of column 2 to X, since Only XY type of plots are supported with <b>OA_PlotWksCols</b> VI.
</p><p>10. Select and place <b>OA_FindWorksheet</b> VI <a  class="image"><img alt="OA FindWorksheet.jpg" src="../images/Plotting_with_a_User-Defined_Template/OA_FindWorksheet.jpg?v=0" width="34"  /></a> again, then wire the <b>Origin.IOApplication</b> connector to the corresponding connectors of the first<b>OA_FindWorksheet</b> VI, and wire the <b>Error IO</b> connector to the corresponding connectors of the <b>OA_Col-Setting</b> VI.
</p><p>11. Add a string constant and assign to it the string <b>[Book1]Sheet1</b>. Wire the string constant to the <b>Name</b> connector of the second <b>OA_FindWorksheet</b> VI.
</p><p>12. Select and place <b>OA_NewEmptyGraph</b> VI <a  class="image"><img alt="OA NewEmptyGraph.png" src="../images/Plotting_with_a_User-Defined_Template/OA_NewEmptyGraph.png?v=5334" width="32"  /></a>, then wire the <b>Origin.IOApplication</b> and the <b>Error IO</b> to the corresponding connector of the second <b>OA_FindWorksheet</b> VI. 
</p><p>13. Add a string constant and assign to it the string <b>C:\MyGraphTemplate</b>. Wire the string constant to the <b>Template Name</b> connector of the second <b>OA_NewEmptyGraph</b> VI.
</p><p>14. Select and place <b>OA_PlotWksCols</b> VI <a  class="image"><img alt="OA PlotWksCols.png" src="../images/Plotting_with_a_User-Defined_Template/OA_PlotWksCols.png?v=5335" width="32"  /></a>, then wire the <b>Origin.Worksheet in</b> connector to the corresponding connector of the Second <b>OA_FindWorksheet</b> VI. Wire the <b>Origin.GraphLayer in</b> and <b>Error IO</b> connectors to the corresponding connector of <b>OA_NewEmptyGraph</b> VI. Then create three numeric constant and set them to <b>2</b>, <b>4</b>, <b>230</b>. Connect <b>2</b>, <b>4</b>, <b>230</b> to <b>c1</b>, <b>c2</b>, <b>plotType</b> connectors separately.
</p><p>15. When all of these are finished, the Block Diagram should look like:
</p>
<dl><dd><a  class="image"><img alt="TutorialUserTemp.jpg" src="../images/Plotting_with_a_User-Defined_Template/TutorialUserTemp.jpg?v=25122" width="600"  /></a></dd></dl>
<p>16. Click <b>Run</b> button to run this VI and then you can turn to Origin to see the result.
</p>





