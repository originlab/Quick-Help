<h1 class="firstHeading">2.7 Working with Origin Com And LabVIEW SubVIs</h1><p>Origin can function as an automation server whereby other applications communicate with Origin using methods and properties exposed by Origin. LabVIEW can support COM programming, so it can easily communicate with Origin using Origin COM.  Origin has equipped with some LabVIEW SubVIs, which can do some basic operations on worksheet, matrix, etc. But they are not enough when you are facing some complicated problems. In these situations, you may need to use Origin Com and the existed LabVIEW SubVIs together. This tutorial will show you how to work with Origin Com and LabVIEW SubVIs. 
</p><p>1. Run Labview, create a new VI and active the Block Diagram window. Then choose <b>OA_ConnectToOrigin</b> VI <a  class="image"><img alt="OA ConnectToOrigin App.jpg" src="../images/Working_with_Origin_Com_And_LabVIEW_SubVIs/OA_ConnectToOrigin_App.jpg?v=4868" width="32"  /></a> and place it to the window.
</p><p>2. Select and place <b>OA_NewWorksheet</b> VI <a  class="image"><img alt="OA NewWorksheet.png" src="../images/Working_with_Origin_Com_And_LabVIEW_SubVIs/OA_NewWorksheet.png?v=5326" width="32"  /></a>, then wire the <b>Origin.IOApplication</b> and <b>Error IO</b> connectors to the corresponding connectors of the <b>OA_ConnectToOrigin</b> VI.
</p><p>3.Move the Mouse Cursor to the <b>Origin.Worksheet</b> connector of the <b>OA_NewWorksheet</b> VI. When the shape of the Cursor become to <a  class="image"><img alt="Connector.png" src="../images/Working_with_Origin_Com_And_LabVIEW_SubVIs/Connector.png?v=5328" width="14"  /></a>, right click and choose <b>Create/ Property/ Cols</b> to create a <b>Property Node</b>. Then right click on it and choose <b>Change All To Write</b>. After that, the <b>Property Node</b>  will be like <a  class="image"><img alt="InvokeNodeCols.png" src="../images/Working_with_Origin_Com_And_LabVIEW_SubVIs/InvokeNodeCols.png?v=5329" width="94"  /></a>. Then wire  <b>reference</b> connector to <b>Origin.Worksheet</b> connector of <b>OA_NewWorksheet</b> VI. And wire <b>Error IO</b> connector to the corresponding connector of the <b>OA_NewWorksheet</b> VI too. 
</p><p><br />
4. Move the mouse to the <b>Origin.Worksheet</b> connector of the <b>Property Node</b> . When the shape of the mouse cursor is like  <a  class="image"><img alt="Connector.png" src="../images/Working_with_Origin_Com_And_LabVIEW_SubVIs/Connector.png?v=5328" width="14"  /></a>, right click and choose <b>Create/ Method/ Execute</b> to create another <b>Property Node</b>. The <b>Property Node</b>  will be like <a  class="image"><img alt="InvokeNodeExcute.png" src="../images/Working_with_Origin_Com_And_LabVIEW_SubVIs/InvokeNodeExcute.png?v=5331" width="94"  /></a>. Then wire  <b>reference</b> connector to <b>Origin.Worksheet</b> connector of previous <b>Property Node</b>. And wire <b>Error IO</b> connector to the corresponding connector too. Then add a string constant and set it to <b>impASC fname:= system.path.program$+"Samples\Import and Export\S15-125-03.dat"</b>, and then wire it to the <b>LabTalkStr</b> connector.
</p><p><br />
5. Select and place <b>OA_NewEmptyGraph</b> VI <a  class="image"><img alt="OA NewEmptyGraph.png" src="../images/Working_with_Origin_Com_And_LabVIEW_SubVIs/OA_NewEmptyGraph.png?v=5334" width="32"  /></a>, then wire the <b>Origin.IOApplication</b> to the corresponding connector of the <b>OA_ConnectToOrigin</b> VI. And wire the <b>Error IO</b> to the corresponding connector of the second <b>Property Node</b> VI. 
</p><p><br />
6. Select and place <b>OA_PlotWksCols</b> VI <a  class="image"><img alt="OA PlotWksCols.png" src="../images/Working_with_Origin_Com_And_LabVIEW_SubVIs/OA_PlotWksCols.png?v=5335" width="32"  /></a>, then wire the <b>Origin.Worksheet in</b> connector to the corresponding connector of the Second <b>Property Node</b>. Wire the <b>Origin.GraphLayer in</b> and <b>Error IO</b> connectors to the corresponding connector of <b>OA_NewEmptyGraph</b> VI. Then create two integer constant and set them to <b>0</b>, <b>-1</b>. Connect <b>0</b>,<b>-1</b> to <b>c1</b>,<b>c2</b> connectors separately.
</p><p><br />
7. When all of these are finished, the Block Diagram should look like:
</p>
<dl><dd><a  class="image"><img alt="OrigincomTutorial.png" src="../images/Working_with_Origin_Com_And_LabVIEW_SubVIs/OrigincomTutorial.png?v=5345" width="504"  /></a></dd></dl>
<p>8. Click <b>Run</b> button to run this VI and then you can turn to Origin to see the result.
</p>





