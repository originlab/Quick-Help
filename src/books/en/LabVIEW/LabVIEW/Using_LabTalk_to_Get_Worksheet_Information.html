<h1 class="firstHeading">2.8 Using LabTalk to Get Worksheet Information</h1><p><br />
</p><p>LabTalk is a high-level, full-featured programming language which has access to most of Origin's operation. So you can take the advantage of LabTalk to use it in LabVIEW to facilitate your work. This tutorial will show you how to run LabTalk scripts in LabVIEW to return the maximum numbers of the column and row that have data.
</p><p>1. Run Origin. If Origin is already running, start a new project. Make sure that there is a Workbook with the name <b>Book1</b> and a worksheet with the name <b>Sheet1</b>. 
</p><p>2. Add several columns in the worksheet, for example add 3 columns. Select a range of cells and right-click on it to select <b>Fill Range With: Row Number</b>. 
</p><p>3. Run LabVIEW and create a blank VI.
</p><p>4. Turn to <b>Block Diagram</b> window, and choose <b>OA_ConnectToOrigin</b> VI <a  class="image"><img alt="OA ConnectToOrigin App.jpg" src="../images/Using_LabTalk_to_Get_Worksheet_Information/OA_ConnectToOrigin_App.jpg?v=4868" width="32"  /></a> and place it to the window.
</p><p>5. Select and place <b>OA_FindWorksheet</b> VI <a  class="image"><img alt="OA FindWorksheet.jpg" src="../images/Using_LabTalk_to_Get_Worksheet_Information/OA_FindWorksheet.jpg?v=0" width="34"  /></a>, and then wire the <b>Origin.IOApplication</b> and <b>Error IO</b> connectors to the <b>OA_ConnectToOrigin</b> VI. 
</p><p>6. Add a string constant and assign to it the string <b>[Book1]Sheet1</b>, and then wire it to the <b>Name</b> connector of <b>OA_FindWorksheet</b> VI.
</p><p>7. Move the mouse to the <b>Origin.Worksheet</b> connector of the <b>OA_FindWorksheet.vi</b>. When the shape of the mouse cursor looks like  <a  class="image"><img alt="Connector.png" src="../images/Using_LabTalk_to_Get_Worksheet_Information/Connector.png?v=5328" width="14"  /></a>, right click on and choose <b>Create/ Method/ Execute</b> to create a <b>Property Node</b>. The <b>Property Node</b>  will look like <a  class="image"><img alt="InvokeNodeExcute.png" src="../images/Using_LabTalk_to_Get_Worksheet_Information/InvokeNodeExcute.png?v=5331" width="94"  /></a>. Then wire  <b>reference</b> connector to <b>Origin.Worksheet</b> connector. And wire <b>Error IO</b> connector to the corresponding connector too. Then add a string constant and input the following scripts into it. And then wire it to the <b>LabTalkStr</b> connector.
</p>
<pre class="lt" style="font-family:monospace;">maxRows <span style="color: #000080;">=</span>wks.<span style="color: #000080;">maxrows</span>;
j<span style="color: #000080;">=</span>wks.<span style="color: #000080;">ncols</span>;
for<span style="color: #000000;">&#40;</span>i<span style="color: #000080;">=</span>wks.<span style="color: #000080;">ncols</span>;i<span style="color: #000080;">&gt;</span><span style="color: #0000dd;">0</span>;i<span style="color: #000080;">--</span><span style="color: #000000;">&#41;</span> 
<span style="color: #000000;">&#123;</span>
  get wcol<span style="color: #000000;">&#40;</span>i<span style="color: #000000;">&#41;</span> <span style="color: #000080;">-</span>e v1;
  if<span style="color: #000000;">&#40;</span>v1<span style="color: #000080;">&gt;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span> break;
  j<span style="color: #000080;">=</span>i<span style="color: #000080;">-</span><span style="color: #0000dd;">1</span>;
<span style="color: #000000;">&#125;</span>;
maxCols <span style="color: #000080;">=</span> j;</pre>
<p>8. Then we will try to get the values of two variables: <b>maxRows</b> and <b>maxCols</b>. Select <b>All Functions/ Application Control</b> from <b>Functions</b> palette and place <b>Invoke Node</b> VI <a  class="image"><img alt="InvodeNode.png" src="../images/Using_LabTalk_to_Get_Worksheet_Information/InvodeNode.png?v=5102" width="62"  /></a> on the diagram. Then wire  <b>reference</b> connector to <b>Origin.IOApplication</b> connector of <b>OA_FindWorksheet</b> VI. And wire <b>Error IO</b> connector to the corresponding connector of the previous <b>Invoke Node</b> VI too. Right click on <b>Method</b> and choose <b>Methods/LTVar(get)</b> from the fly-out menu. Then add a string constant and set it to <b>maxRows</b>, and then wire it to the <b>LabTalkStr</b> connector. This VI should look like <a  class="image"><img alt="LTVar.png" src="../images/Using_LabTalk_to_Get_Worksheet_Information/LTVar.png?v=19577" width="106"  /></a>.
</p><p>9. Select <b>All Function/Numeric/ Conversion/ To Long Integer</b> to add the <b>To Long Integer</b> vi <a  class="image"><img alt="ConvertToInte.png" src="../images/Using_LabTalk_to_Get_Worksheet_Information/ConvertToInte.png?v=19580" width="27"  /></a> into the diagram. Wire its <b>Number</b> connector to the <b>LVar</b> connector of the <b>InvodeNode</b>. And remember to create an Indicate to its another connector.
</p><p>10. Then repeat the steps 8~9 to get the maximum number of columns (Please remember to change the string value to <b>maxCols</b>.). The Block Diagram should look like:
</p>
<dl><dd><a  class="image"><img alt="LabTalk Return WKS Info.png" src="../images/Using_LabTalk_to_Get_Worksheet_Information/LabTalk_Return_WKS_Info.png?v=19576" width="707"  /></a></dd></dl>
<p>11. Click <b>Run</b> button to run this VI and then you can turn to Front Panel to see the results.
</p>





