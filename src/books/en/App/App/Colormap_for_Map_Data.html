<h1 class="firstHeading">1.13 Colormap for Map Data</h1><p class='urlname' style='display: none'>Colormap-for-Map-Data</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Summary"><span class="tocnumber">1</span> <span class="toctext">Summary</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Tutorial"><span class="tocnumber">2</span> <span class="toctext">Tutorial</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#1._Import_Shapefile_Data"><span class="tocnumber">2.1</span> <span class="toctext">1. Import Shapefile Data</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#2._Reorder_Shapefile_Data"><span class="tocnumber">2.2</span> <span class="toctext">2. Reorder Shapefile Data</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#3._Create_Map_with_Colormap_of_Specified_Data"><span class="tocnumber">2.3</span> <span class="toctext">3. Create Map with Colormap of Specified Data</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#4._Customize_the_Graph"><span class="tocnumber">2.4</span> <span class="toctext">4. Customize the Graph</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><a name="Summary"></a><span class="mw-headline">Summary</span></h2>
<p>This <a class="external text" href="https://www.originlab.com/fileExchange/details.aspx?fid=334" target="_blank">Colormap for Map Data app</a> can be used to create a map with the Shapefile data and fill each region with colors mapping to specified values. This tutorial will show you how to plot a US map of 2016 Olympic game medals distribution over each state.
</p>
<h2><a name="Tutorial"></a><span class="mw-headline">Tutorial</span></h2>
<table class="note">

<tr>
<td><b>Notes:</b>
<p>This tutorial requires both <a class="external text" href="https://www.originlab.com/fileExchange/details.aspx?fid=334" target="_blank">Colormap for Map Data App</a> and <a class="external text" href="http://www.originlab.com/fileExchange/details.aspx?fid=285" target="_blank">Import Shapefile App</a> to be installed. 
</p>
</td></tr></table>
<h3><a name="1._Import_Shapefile_Data"></a><span class="mw-headline">1. Import Shapefile Data</span></h3>
<ol>
<li> Find out <b>Colormap for Map Data</b> app in Apps gallery (docked to the right of Origin workspace), right click on it and select <b>Show Samples Folder</b>. Under the folder there are 3 files: <i>cb_2015_us_state_20m.zip</i>, <i>US_medals.ogw</i>, and <i>colormap_US_medals.opj</i>. Unzip <i>cb_2015_us_state_20m.zip</i> to 8 files and among them there’s one Shapefile (<b>.shp</b> file). Shapefile is a popular data format for storing map data. Origin has provided the <b>Import Shapefile</b> app for importing such data. 
<li>Go back to Origin, create a new project by <b>File: New: Project</b>. Then in the Apps gallery, click the <b>Import Shapefile</b> app to bring up the import dialog.
<li>Within the dialog, 
<ul><li> select the <b>.shp</b> file unzipped in step 1 </li>
<li> check <b>Auto</b> checkbox of both <b>File Name (attribute)</b> and <b>File Name (projection)</b> </li>
<li> make sure <b>Output Data Points</b> checkbox is checked. </li>
<li> clear <b>Graph</b> checkbox </li></ul>
keep other settings the default values. Click <b>OK</b> to import.
<a  class="image"><img alt="Colormap for Map Data 1.png" src="../images/Colormap_for_Map_Data/Colormap_for_Map_Data_1.png?v=71288" width="860"  /></a>
</ol>
<h3><a name="2._Reorder_Shapefile_Data"></a><span class="mw-headline">2. Reorder Shapefile Data</span></h3>
<ol>
<li>Go to Book2 where the shapefile data is imported. Click the <b>Colormap for Map Data</b> app from the Apps Gallery. A toolbar with 2 buttons shows up.
<li>Click the 1st button to bring up the ReorderShapefileData dialog. Select NAME column (col(J)) for <b>Names for ID</b>, by clicking on <a  class="image"><img alt="Colormap for Map Data 2 1.png" src="../images/Colormap_for_Map_Data/Colormap_for_Map_Data_2_1.png?v=71322" width="22"  /></a> button.<br />
<a  class="image"><img alt="Colormap for Map Data 2.png" src="../images/Colormap_for_Map_Data/Colormap_for_Map_Data_2.png?v=71287" width="377"  /></a>
<li>Click <b>OK</b> to reorder the data based on state NAME.
<br />In the output worksheet <i>Shapefile Data Reordered</i>, there are 6 columns. The first 2 columns are the longitude and latitude of the map data respectively. You can put "Longitude" and "Latitude" to Long Name of column A and B. The 3rd column is the state ID that each coordinate corresponds to, and the 4th column is the ID of each state (5th column). If <b>Names for ID</b> is not specified in step 2, the 5th column will be empty. The last column is now empty, which is used to fill the values for mapping colors.
<br /><a  class="image"><img alt="Colormap for Map Data 3.png" src="../images/Colormap_for_Map_Data/Colormap_for_Map_Data_3.png?v=71323" width="600"  /></a>
</ol>
<h3><a name="3._Create_Map_with_Colormap_of_Specified_Data"></a><span class="mw-headline">3. Create Map with Colormap of Specified Data</span></h3>
<ol>
<li>Drag and drop <i>US_medals.ogw</i> file from the App sample folder into Origin’s workspace. A workbook, Book3 containing the US medal data is generated.
<li>Activate worksheet <i>[Book2]"Shapefile Data Reordered"</i>. Highlight the Value column (col(F)) and select <b>Column:Set Column Values…</b>
<li>In the <b>Set Values</b> dialog, type the following formula below <b>Col(F)=</b>&#160;:
<pre class="lt" style="font-family:monospace;">lookup<span style="color: #000000;">&#40;</span>E,<span style="color: #000000;">&#91;</span>Book3<span style="color: #000000;">&#93;</span>Sheet1<span style="color: #000080;">!</span>A,<span style="color: #000000;">&#91;</span>Book3<span style="color: #000000;">&#93;</span>Sheet1<span style="color: #000080;">!</span>B,<span style="color: #0000dd;">2</span><span style="color: #000000;">&#41;</span></pre>
<p>This will map the state medal numbers referring to the state column in this worksheet.
</p>
<li>With Book2 activated, click the 2nd button of the app’s toolbar, a graph of the map data is created. The color on the graph is now mapped to number of medals in column F, also the related labels are added to the corresponding regions.
<a  class="image"><img alt="Colormap for Map Data 4.png" src="../images/Colormap_for_Map_Data/Colormap_for_Map_Data_4.png?v=71326" width="800"  /></a>
</ol>
<h3><a name="4._Customize_the_Graph"></a><span class="mw-headline">4. Customize the Graph</span></h3>
<ol>
<li>Go to worksheet <i>Shapefile Data Reordered</i>, change the comments of column G to "Medals".
<br /><a  class="image"><img alt="Colormap for Map Data 5.png" src="../images/Colormap_for_Map_Data/Colormap_for_Map_Data_5.png?v=71328" width="577"  /></a>
<li>Go to the created graph. Double click on the X axis to bring up the <b>Axis</b> dialog. 
<ul><li> On Scale tab, set <b>From</b> = -130, and <b>To</b> = -60. </li>
<li> Select <b>Vertical</b> from the left panel, and set <b>From</b> = 20 and <b>To</b> = 55. </li></ul>
<br /><a  class="image"><img alt="Colormap for Map Data 5 2.png" src="../images/Colormap_for_Map_Data/Colormap_for_Map_Data_5_2.png?v=71329" width="827"  /></a>
<li>Under tabs Tick Labels, Title, Line and Ticks for bottom and left axis, clear <b>Show</b> checkbox. Click <b>OK</b>.
<li>Double click the plot to bring up the <b>Plot Details</b> dialog. Highlight Layer1 in the left panel. Go to the Size/Speed tab, check <b>Link Axis Length to Scale with X:Y Ratio 1</b>. Click <b>Apply</b>. This makes sure the map isn’t distorted.
<br /><a  class="image"><img alt="Colormap for Map Data 6.png" src="../images/Colormap_for_Map_Data/Colormap_for_Map_Data_6.png?v=71331" width="747"  /></a>
<li>To customize colormap levels and colors, select Plot on the left panel. Go to the Colormap tab in the right panel. Click on the <b>Level</b> header of the table to bring up the <b>Set Levels</b> dialog. In this dialog, set <b>From</b> = 1 and <b>To</b> = 60. Check <b># Major Levels</b> and input 6 for it. Click <b>OK</b> back to <b>Plot Details</b> dialog. 
<br /><a  class="image"><img alt="Colormap for Map Data 7.png" src="../images/Colormap_for_Map_Data/Colormap_for_Map_Data_7.png?v=71330" width="783"  /></a>
<li>Click the <b>Fill</b> header of the table to bring up the <b>Fill</b> dialog. Check <b>Load Palette</b> and select <b>BlueYellow</b>. Check <b>Flip Palette</b>. Click <b>OK</b>.  
<br /><a  class="image"><img alt="Colormap for Map Data 8.png" src="../images/Colormap_for_Map_Data/Colormap_for_Map_Data_8.png?v=71332" width="819"  /></a>
<li>Double click on the color scale to bring up the <b>Color Scale Control</b> dialog. In the dialog, 
<ul><li> select <b>Levels</b> from the left panel, check <b>Hide Head</b> and <b>Tail Levels</b>. </li>
<li> select <b>Labels</b> from the left, under <b>Display</b>, uncheck <b>Auto</b>. Check <b>Set Decimal Places</b> checkbox and input 0 for <b>Decimal Places</b>. </li>
<li> select <b>Layout</b> from the left, set <b>Layout</b> to <b>Separated</b>. </li>
<li> select <b>Title</b> from the left, check <b>Show</b> checkbox in the right panel </li></ul>
Click <b>OK</b> button. You can move and resize the color scale as desired.
<br /><a  class="image"><img alt="Colormap for Map Data 9.png" src="../images/Colormap_for_Map_Data/Colormap_for_Map_Data_9.png?v=71333" width="839"  /></a>
<li>As the final step, we are going to add Alaska and Hawaii to the graph. Activate the graph, click the duplicate button in the top tool bar twice to make two copies.
<br /><a  class="image"><img alt="Colormap for Map Data 10.png" src="../images/Colormap_for_Map_Data/Colormap_for_Map_Data_10.png?v=71301" width="367"  /></a>
<li>In the first copied graph, delete the color scale. Select <b>Format: Axis: X Axis…</b>. With <b>Horizontal</b> selected in the left panel, under the Scale tab, set the <b>From</b> = -195 and <b>To</b> = -125. Then select <b>Vertical</b> in the left, set <b>From</b> = 50 and <b>To</b> = 75. Click <b>OK</b>. Alaska is now shown in this graph.
<br /><a  class="image"><img alt="Colormap for Map Data 11.png" src="../images/Colormap_for_Map_Data/Colormap_for_Map_Data_11.png?v=71334" width="723"  /></a>
<li>Repeat previous step for the second graph copy. Set the <b>Horizontal</b> scale as <b>From</b> -195 <b>To</b> -120 and <b>Vertical</b> scale as <b>From</b> 5 <b>To</b> 30.  
<br /><a  class="image"><img alt="Colormap for Map Data 12.png" src="../images/Colormap_for_Map_Data/Colormap_for_Map_Data_12.png?v=71335" width="396"  /></a>
<li>Click merge button in the right side tool bar. In the <b>Merge Graph</b> dialog,
<ul><li>Click <b>...</b> button besides <b>Graphs</b> to open up the graph browser. Select all 3 graphs in the left panel and click <b>&gt;&gt;</b> button to move them to the right and then click <b>OK</b> to add them. </li>
<li>Set <b>Number of Rows</b> and <b>Number of Columns</b> to 1.  </li>
<li>Make sure <b>Link Source Graphs</b> is unchecked. </li></ul>
Click <b>OK</b>.
<br /><a  class="image"><img alt="Colormap for Map Data 13.png" src="../images/Colormap_for_Map_Data/Colormap_for_Map_Data_13.png?v=71336" width="800"  /></a>
<li>In the generated merged graph, move and resize the layer for Alaska and Hawaii as desired for better display.
<br /><a  class="image"><img alt="Colormap for Map Data 14.png" src="../images/Colormap_for_Map_Data/Colormap_for_Map_Data_14.png?v=71337" width="800"  /></a>
</ol>






