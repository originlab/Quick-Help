<h1 class="firstHeading">2.32 Design of Experiments (Pro)</h1><p class='urlname' style='display: none'>DOE</p>
<div class="toclimit-2"><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Summary"><span class="tocnumber">1</span> <span class="toctext">Summary</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Sample_OPJ"><span class="tocnumber">2</span> <span class="toctext">Sample OPJ</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Example_1:_2-Level_Factorial"><span class="tocnumber">3</span> <span class="toctext">Example 1: 2-Level Factorial</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Create_Desgin"><span class="tocnumber">3.1</span> <span class="toctext">Create Desgin</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Analyze_Design"><span class="tocnumber">3.2</span> <span class="toctext">Analyze Design</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Optimize_Response"><span class="tocnumber">3.3</span> <span class="toctext">Optimize Response</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-7"><a href="#Example_2:_Central_Composite"><span class="tocnumber">4</span> <span class="toctext">Example 2: Central Composite</span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="#Create_Desgin_2"><span class="tocnumber">4.1</span> <span class="toctext">Create Desgin</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Analyze_Design_2"><span class="tocnumber">4.2</span> <span class="toctext">Analyze Design</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Optimize_Response_2"><span class="tocnumber">4.3</span> <span class="toctext">Optimize Response</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-11"><a href="#Example_3:_Power_and_Sample_Size"><span class="tocnumber">5</span> <span class="toctext">Example 3: Power and Sample Size</span></a></li>
<li class="toclevel-1 tocsection-12"><a href="#Installing_the_APP"><span class="tocnumber">6</span> <span class="toctext">Installing the APP</span></a></li>
</ul>
</div>
</div>
<h2><a name="Summary"></a><span class="mw-headline">Summary</span></h2>
<p>The <a class="external text" href="https://www.originlab.com/fileExchange/details.aspx?fid=462" target="_blank">Design of Experiments app</a> is a tool for DOE. It is to design an experiment, fit a model to experimental data, and find best factor settings that optimize responses.
</p><p>The app requires R software (minimum required version 3.4.1) and packages (rsm, FrF2, qpcR). The packages  will be automatically installed when the App is launched the time. If not, please follow the steps of <a href="#Installing_the_APP"> Installing the app section</a> in this tutorial to trouble shoot.
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Design_of_Experiments/Tip_icon.png?v=8477" width="57"  border="0" /></td><td><p>This app has been improved and updated since Origin 2024, you can read <a class="external text" href="https://blog.originlab.com/doe-app-updates-for-originpro-2024" target="_blank">this blog</a> to learn the improvements.
</p></td></tr></table>
<h2><a name="Sample_OPJ"></a><span class="mw-headline">Sample OPJ</span></h2>
<ol><li> Right click on the app in Apps Gallery and choose <b>Show Samples Folder</b> from the context menu
<dl><dd><a  class="image"><img alt="DOESample.png" src="../images/Design_of_Experiments/180px-DOESample.png?v=70690" width="180"   /></a></dd></dl></li>
<li> Drag and drop the project file in the opened folder to Origin to open it</li></ol>
<p><br />
</p>
<h2><a name="Example_1:_2-Level_Factorial"></a><span class="mw-headline">Example 1: 2-Level Factorial</span></h2>
<h4><a name="Create_Desgin"></a><span class="mw-headline">Create Desgin</span></h4>
<ol><li> Click the <b>Design of Experiments</b> icon <a  class="image"><img alt="DOEAPP.png" src="../images/Design_of_Experiments/50px-DOEAPP.png?v=70668" width="50"   /></a> on <b>Apps Gallery</b></li>
<li> Click <b>Create Design</b> button and select <b>Factorial Design</b>.
<dl><dd> <a  class="image"><img alt="DOE Factorial.png" src="../images/Design_of_Experiments/500px-DOE_Factorial.png?v=70695" width="500"   /></a></dd></dl></li>
<li> Make sure <b>2-Level Factorial</b> and <b>Default Generators</b> is selected. In <b>Factors</b> tab, select 3 from <b>Number of Factors</b>. Enter factor names Temp, Dens and Reagent and select factor types (Numeric, Numeric and Text). Then Enter low and high values (Temp:50, 80; Dens:20, 30; Reagent: TypeA, TypeB).
<dl><dd> <a  class="image"><img alt="DOE Factorial Factors.png" src="../images/Design_of_Experiments/650px-DOE_Factorial_Factors.png?v=74004" width="650"   /></a></dd></dl></li>
<li> In <b>Settings'<i> tab, select </i></b><i>Full factorial</i> design. Enter 2 in <b>Number of Replicates</b>. Select 2 from <b>Number of Blocks</b> drop-down list.
<dl><dd><a  class="image" title="480"><img alt="480" src="../images/Design_of_Experiments/DOE_Factorial_Settings.png?v=74006" width="752"  /></a></dd></dl></li>
<li> In <b>Miscellaneous</b> Tab, enter 5 in <b>Seed for Randomization</b> text box. </li>
<li> Click <b>OK</b> to output the design table.
<dl><dd><a  class="image"><img alt="DOE Factorial Results.png" src="../images/Design_of_Experiments/500px-DOE_Factorial_Results.png?v=74007" width="500"   /></a></dd></dl></li></ol>
<h4><a name="Analyze_Design"></a><span class="mw-headline">Analyze Design</span></h4>
<ol><li> Add a new column on the design table and fill in response data. Use pH as <b>Long Name</b> 
<dl><dd><a  class="image"><img alt="DOE Factorial Results response.png" src="../images/Design_of_Experiments/500px-DOE_Factorial_Results_response.png?v=70708" width="500"   /></a></dd></dl></li>
<li> Click the <b>Design of Experiments</b> icon <a  class="image"><img alt="DOEAPP.png" src="../images/Design_of_Experiments/50px-DOEAPP.png?v=70668" width="50"   /></a> to bring up toolbar. Select <b>Analyze Design</b>
<dl><dd><a  class="image"><img alt="DOE Factorial. Analyze.png" src="../images/Design_of_Experiments/500px-DOE_Factorial._Analyze.png?v=70711" width="500"   /></a></dd></dl></li>
<li> In <b>Model</b> tab, select PH from <b>Response</b> drop-down list. Then select 2 from Model Order. Select <b>Include Blocks</b> in the Model.
<dl><dd><a  class="image"><img alt="DOE Factorial. Analyze Model.png" src="../images/Design_of_Experiments/500px-DOE_Factorial._Analyze_Model.png?v=70716" width="500"   /></a></dd></dl></li>
<li> In <b>Settings</b> tab, select <b>Main Effects</b> from <b>Means Table</b> drop-down list.</li>
<li> In <b>Quantities</b> tab, select <b>Coefficients</b>, <b>Standard Error</b>, <b>Confidence Limits</b>, <b>t-Value</b> and <b>Prob&gt;|t|</b> from <b>Coefficients Table</b> drop-down list.</li>
<li> In <b>Plots</b> tab, select <b>Cube Plot</b>, <b>Contour Plot</b>, <b>Surface Plot</b> and <b>2-way interaction plot</b>. In the <b>Settings of Cube Plot</b> group, choose Temp, Dens and Reagent as three factors. In the <b>Settings for Contour and Surface Plot</b> group, select Temp and Dens as factors for X and Y axis. Then select TypeA as value of Reagent. 
<dl><dd> <a  class="image"><img alt="DOE Factorial. Analyze Plots.png" src="../images/Design_of_Experiments/650px-DOE_Factorial._Analyze_Plots.png?v=70717" width="650"   /></a></dd></dl></li>
<li> Click <b>OK</b> to create analysis results.
<dl><dd><a  class="image"><img alt="DOE Factorial. Analyze Results.png" src="../images/Design_of_Experiments/500px-DOE_Factorial._Analyze_Results.png?v=70722" width="500"   /></a></dd></dl></li></ol>
<h4><a name="Optimize_Response"></a><span class="mw-headline">Optimize Response</span></h4>
<ol><li> Click the Design of Experiments icon <a  class="image"><img alt="DOEAPP.png" src="../images/Design_of_Experiments/50px-DOEAPP.png?v=70668" width="50"   /></a> on <b>Apps Gallery</b></li>
<li> Activate the analysis workbook we got in last section and click Optimize Response button <a  class="image"><img alt="DOE Optimize Icon.png" src="../images/Design_of_Experiments/80px-DOE_Optimize_Icon.png?v=70727" width="80"   /></a></li>
<li>  In the <b>Goal</b> tab, select <b>Minimize</b> as goal for PH. Enter 5 and 9 in Lower Limit and Upper Limit. 
<dl><dd><a  class="image"><img alt="DOE Optimize Goal.png" src="../images/Design_of_Experiments/600px-DOE_Optimize_Goal.png?v=70731" width="600"   /></a></dd></dl></li>
<li> Go to the <b>Settings</b> tab. In the row for factor Reagent, select <b>Hold at Value</b> for <b>Constraint</b>, select TypeA for Hold Value. Enable <b>Initial Value</b> button. Enter 60 and 25 in the rows for Temp and Dens respectively.
<dl><dd><a  class="image"><img alt="DOE Optimize Settings.png" src="../images/Design_of_Experiments/600px-DOE_Optimize_Settings.png?v=70733" width="600"   /></a></dd></dl></li>
<li> Click <b>OK</b> to generate optimization report.
<dl><dd> <a  class="image"><img alt="DOE Optimize Results.png" src="../images/Design_of_Experiments/600px-DOE_Optimize_Results.png?v=70735" width="600"   /></a></dd></dl></li>
<li> Double click <b>Optimization Plot</b> to bring up the graph window. Move vertical red lines to change factor values to view how they affect the composite desirability and the responses. Click <b>Reset</b> button to set values to optimal solution.
<dl><dd><a  class="image"><img alt="DOE Optimize Graph.png" src="../images/Design_of_Experiments/600px-DOE_Optimize_Graph.png?v=70736" width="600"   /></a></dd></dl></li></ol>
<h2><a name="Example_2:_Central_Composite"></a><span class="mw-headline">Example 2: Central Composite</span></h2>
<h4><a name="Create_Desgin_2"></a><span class="mw-headline">Create Desgin</span></h4>
<ol><li> Click the <b>Design of Experiments</b> icon <a  class="image"><img alt="DOEAPP.png" src="../images/Design_of_Experiments/50px-DOEAPP.png?v=70668" width="50"   /></a> on <b>Apps Gallery</b></li>
<li> Click <b>Create Design</b> button and select <b>Response Surface Design</b>.
<dl><dd> <a  class="image"><img alt="DOE RSD.png" src="../images/Design_of_Experiments/500px-DOE_RSD.png?v=70739" width="500"   /></a></dd></dl></li>
<li> Choose <b>Central Composite</b>. In  the <b>Factors</b> tab, select 3 from <b>Number of Continuous Factors</b> drop-down list. Enter factor names (Time, Temp and Catalyst). Then Enter low and high values (40-50, 80-90, and 0.02-0.03 respectively). Select 1 from <b>Number of Categorical Factors</b>  drop-down list. Enter Reagent in factor name. Then Enter level values (TypeA, TypeB).
<dl><dd> <a  class="image"><img alt="DOE RSD Factors.png" src="../images/Design_of_Experiments/600px-DOE_RSD_Factors.png?v=74010" width="600"   /></a></dd></dl></li>
<li> In the <b>Settings</b> tab, select second design(Blocks=2). 
<dl><dd><a  class="image"><img alt="DOE RSD Settings.png" src="../images/Design_of_Experiments/600px-DOE_RSD_Settings.png?v=74027" width="600"   /></a></dd></dl></li>
<li> In the <b>Miscellaneous</b> tab, turn off the <b>Randomize Design</b> button. </li>
<li> Click <b>OK</b> to output the design table.
<dl><dd><a  class="image"><img alt="DOE RSD Results.png" src="../images/Design_of_Experiments/600px-DOE_RSD_Results.png?v=70742" width="600"   /></a></dd></dl></li></ol>
<h4><a name="Analyze_Design_2"></a><span class="mw-headline">Analyze Design</span></h4>
<ol><li> Add two new columns on the design table and fill in response data. Use PH and Conductivity as Long Name.
<dl><dd><a  class="image"><img alt="DOE RSD Analyze Input.png" src="../images/Design_of_Experiments/600px-DOE_RSD_Analyze_Input.png?v=75087" width="600"   /></a></dd></dl></li>
<li> Click the <b>Design of Experiments</b> icon <a  class="image"><img alt="DOEAPP.png" src="../images/Design_of_Experiments/50px-DOEAPP.png?v=70668" width="50"   /></a> on <b>Apps Gallery</b></li>
<li> Activate the design table and click Analyze Design button <a  class="image"><img alt="DOE RSD Analyze Button.png" src="../images/Design_of_Experiments/80px-DOE_RSD_Analyze_Button.png?v=70745" width="80"   /></a></li>
<li> In the <b>Model</b> tab, select PH and Conductivity for <b>Response</b>. Then select <b>Linear + Squares</b> from <b>Model Type</b> drop-down list. Turn on <b>Include Blocks in the Model</b> button.
<dl><dd><a  class="image"><img alt="DOE RSD Analyze Model.png" src="../images/Design_of_Experiments/600px-DOE_RSD_Analyze_Model.png?v=70757" width="600"   /></a></dd></dl></li>
<li> In the <b>Quantities</b> tab, select Coefficients, Standard Error, Confidence Limits, t-Value and Prob&gt;|t| from <b>Coefficients Table</b> drop-down list</li>
<li> In the <b>Plots</b> tab, select <b>Contour Plot</b>, <b>Surface Plot</b>.  In the <b>Settings of Contour and Surface Plots</b> group, select Time and Temp as factors for X and Y axis. In the row for Catalyst, under Value, enter 0.02. In the row for Reagent, under Value, select TypeA. 
<dl><dd><a  class="image"><img alt="DOE RSD Analyze Plot.png" src="../images/Design_of_Experiments/600px-DOE_RSD_Analyze_Plot.png?v=70758" width="600"   /></a></dd></dl></li>
<li> Click <b>OK</b> to create analysis results.
<dl><dd><a  class="image"><img alt="DOE RSD Analyze Results.png" src="../images/Design_of_Experiments/700px-DOE_RSD_Analyze_Results.png?v=75088" width="700"   /></a></dd></dl></li></ol>
<h4><a name="Optimize_Response_2"></a><span class="mw-headline">Optimize Response</span></h4>
<ol><li> Click the Design of Experiments icon <a  class="image"><img alt="DOEAPP.png" src="../images/Design_of_Experiments/50px-DOEAPP.png?v=70668" width="50"   /></a> on <b>Apps Gallery</b></li>
<li> Activate the analysis workbook we got in last section and click Optimize Response button <a  class="image"><img alt="DOE Optimize Icon.png" src="../images/Design_of_Experiments/80px-DOE_Optimize_Icon.png?v=70727" width="80"   /></a></li>
<li> In the <b>Goal</b> tab, in the table, for PH, select Maximize as Goal and set 5 as Lower Limit and 9 as Upper Limit. For Conductivity, select Minimize as Goral. 350 as Lower Limit, and 550 as Under Upper Limit. 
<dl><dd> <a  class="image"><img alt="DOE RSD Optimize Goal.png" src="../images/Design_of_Experiments/700px-DOE_RSD_Optimize_Goal.png?v=70759" width="700"   /></a></dd>
<dd> In the <b>Settings</b> tab. for Temp, select <b>Constrain to Region</b> as Constrain. Enter 85 and 90 as Lower Bound and Upper Bound. </dd>
<dd> <a  class="image"><img alt="DOE RSD Optimize Setting.png" src="../images/Design_of_Experiments/700px-DOE_RSD_Optimize_Setting.png?v=70760" width="700"   /></a></dd></dl></li>
<li> Click <b>OK</b> to generate optimization report.
<dl><dd> <a  class="image"><img alt="DOE RSD Optimize Results.png" src="../images/Design_of_Experiments/650px-DOE_RSD_Optimize_Results.png?v=75101" width="650"   /></a></dd></dl></li>
<li> Double click <b>Optimization Plot</b> to bring up the graph window. Move vertical red lines to change factor values to view how they affect the composite desirability and the responses. Click <b>Reset</b> button to set values to optimal solution.
<dl><dd><a  class="image"><img alt="DOE RSD Optimize Graph.png" src="../images/Design_of_Experiments/650px-DOE_RSD_Optimize_Graph.png?v=75102" width="650"   /></a></dd></dl></li></ol>
<h2><a name="Example_3:_Power_and_Sample_Size"></a><span class="mw-headline">Example 3: Power and Sample Size</span></h2>
<ol><li> Click the <b>Design of Experiments</b> icon <a  class="image"><img alt="DOEAPP.png" src="../images/Design_of_Experiments/50px-DOEAPP.png?v=70668" width="50"   /></a> on <b>Apps Gallery</b></li>
<li> Click Power and Sample Size button <a  class="image"><img alt="DOE PSS Icon.png" src="../images/Design_of_Experiments/80px-DOE_PSS_Icon.png?v=70765" width="80"   /></a></li>
<li> Select <b>2-Level Factorial</b>. In the <b>Design</b> tab, select 3 from <b>Number of Factors</b> drop-down list. Choose <b>Full factorial</b> from <b>Fraction</b> drop-down list. Select 2 for <b>Number of Blocks</b>. Enter 0 in <b>Number of Terms Omitted from Model</b>. Turn in <b>Include Blocks in Model</b> button.
<dl><dd><a  class="image"><img alt="DOE PSS Design.png" src="../images/Design_of_Experiments/550px-DOE_PSS_Design.png?v=70766" width="550"   /></a></dd></dl></li>
<li> In the <b>Settings</b> tab, choose <b>Power</b> to calculate. Click plus button to add 1 level to <b>Replicates</b>  and enter 1 and 2 in each level. Enter 0.4 in <b>Effects</b>. Enter 0 in <b>Number of Center Points per Block</b>. Enter 0.2 in <b>Standard Deviation</b>. Click <b>OK</b>.
<dl><dd><a  class="image"><img alt="DOE PSS Settiings.png" src="../images/Design_of_Experiments/500px-DOE_PSS_Settiings.png?v=70767" width="500"   /></a></dd></dl></li>
<li> The results in the report indicates that you should have 2 replicates in order to get a power value of 0.92679.
<dl><dd><a  class="image"><img alt="DOE PSS Results.png" src="../images/Design_of_Experiments/480px-DOE_PSS_Results.png?v=70768" width="480"   /></a></dd></dl></li></ol>
<h2><a name="Installing_the_APP"></a><span class="mw-headline">Installing the APP</span></h2>
<ol><li> Make sure you install <b>R</b> software (later than 3.4.1)</li>
<li> Click the Design of Experiments icon <a  class="image"><img alt="DOEAPP.png" src="../images/Design_of_Experiments/50px-DOEAPP.png?v=70668" width="50"   /></a> on <b>Apps Gallery</b></li>
<li> The needed packages will be downloaded automatically. If failed, following message will be pop up in the <b>results log</b>
<dl><dd><a  class="image"><img alt="Failed Results Log.png" src="../images/Design_of_Experiments/500px-Failed_Results_Log.png?v=70676" width="500"   /></a></dd></dl></li>
<li> Open <b>R</b>, copy and paste the last two lines from <b>Results Log</b> to <b>R</b>, press Enter to run them.
<dl><dd><a  class="image"><img alt="Run R 01.png" src="../images/Design_of_Experiments/500px-Run_R_01.png?v=74025" width="500"   /></a></dd></dl></li>
<li> A dialog will be pop up for you to select a site,  then the needed packages will be downloaded automatically in R</li>
<li> Once the packages are successfully downloaded without error message , restart Origin</li></ol>


