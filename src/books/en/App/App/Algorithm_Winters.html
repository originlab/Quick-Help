<h1 class="firstHeading">2.2.4.4.2 Algorithm for Winter's Method</h1><p class='urlname' style='display: none'>TSA-Smooth-Winters-Algorithm</p>
<p>NAG function nag_tsa_exp_smooth (g13amc) is used to smooth with Winter's method[<a href="#Ref1">1</a>].
</p><p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Winter.27s_Method_Model"><span class="tocnumber">1</span> <span class="toctext">Winter's Method Model</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Initialization_Method"><span class="tocnumber">2</span> <span class="toctext">Initialization Method</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Forecast"><span class="tocnumber">3</span> <span class="toctext">Forecast</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Reference"><span class="tocnumber">4</span> <span class="toctext">Reference</span></a></li>
</ul>
</div>

<p><br />
</p>
<h2><a name="Winter.27s_Method_Model"></a><span class="mw-headline">Winter's Method Model</span></h2>
<ul><li> Multiplicative:</li></ul>
<dl><dd><img src="../images/Algorithm_Winters/math-5dea565e06b708c3be94a2592f333a91.png?v=0" title="L_t = \alpha (y_t / S_{t-p}) + (1- \alpha)(L_{t-1}+T_{t-1})" alt="L_t = \alpha (y_t / S_{t-p}) + (1- \alpha)(L_{t-1}+T_{t-1})" class="tex"/></dd></dl>
<dl><dd><img src="../images/Algorithm_Winters/math-95dcd87dccb2779af7ed1b1d030f53c0.png?v=0" title="T_t = \gamma (L_t - L_{t-1}) + (1- \gamma)T_{t-1}" alt="T_t = \gamma (L_t - L_{t-1}) + (1- \gamma)T_{t-1}" class="tex"/></dd></dl>
<dl><dd><img src="../images/Algorithm_Winters/math-c2528a85ade8a180495d0dac1939a557.png?v=0" title="S_t = \delta (y_t / L_t) + (1- \delta)S_{t-p}" alt="S_t = \delta (y_t / L_t) + (1- \delta)S_{t-p}" class="tex"/></dd></dl>
<dl><dd><img src="../images/Algorithm_Winters/math-c421f12d9513046de3d69e5f1e0cfa8c.png?v=0" title="\hat{y_t} = (L_{t-1} + T_{t-1}) S_{t-p}" alt="\hat{y_t} = (L_{t-1} + T_{t-1}) S_{t-p}" class="tex"/></dd></dl>
<dl><dd><img src="../images/Algorithm_Winters/math-5e294ff5ebd47ec445d68bf0e4628c32.png?v=0" title="y&#39;_t = L_{t-1} \times S_{t-p}" alt="y&#39;_t = L_{t-1} \times S_{t-p}" class="tex"/></dd></dl>
<ul><li> Additive:</li></ul>
<dl><dd><img src="../images/Algorithm_Winters/math-8bf2fbee6fba91b7a387399c9da60437.png?v=0" title="L_t = \alpha (y_t - S_{t-p}) + (1- \alpha)(L_{t-1}+T_{t-1})" alt="L_t = \alpha (y_t - S_{t-p}) + (1- \alpha)(L_{t-1}+T_{t-1})" class="tex"/></dd></dl>
<dl><dd><img src="../images/Algorithm_Winters/math-95dcd87dccb2779af7ed1b1d030f53c0.png?v=0" title="T_t = \gamma (L_t - L_{t-1}) + (1- \gamma)T_{t-1}" alt="T_t = \gamma (L_t - L_{t-1}) + (1- \gamma)T_{t-1}" class="tex"/></dd></dl>
<dl><dd><img src="../images/Algorithm_Winters/math-e2f8d9a674ff52961ff96c68bef3f1ba.png?v=0" title="S_t = \delta (y_t - L_t) + (1- \delta)S_{t-p}" alt="S_t = \delta (y_t - L_t) + (1- \delta)S_{t-p}" class="tex"/></dd></dl>
<dl><dd><img src="../images/Algorithm_Winters/math-6cf39e2f38a8ed3a1ee1c9f974ebce5a.png?v=0" title="\hat{y_t} = L_{t-1} + T_{t-1} + S_{t-p}" alt="\hat{y_t} = L_{t-1} + T_{t-1} + S_{t-p}" class="tex"/></dd></dl>
<dl><dd><img src="../images/Algorithm_Winters/math-343809fd69a523ba279da26e2eaf0825.png?v=0" title="y&#39;_t = L_{t-1} + S_{t-p}" alt="y&#39;_t = L_{t-1} + S_{t-p}" class="tex"/></dd></dl>
<dl><dd>where <img src="../images/Algorithm_Winters/math-e1d5c4b15afff9fbc5ee69f570286302.png?v=0" title="L_t" alt="L_t" class="tex"/> is the level(mean), <img src="../images/Algorithm_Winters/math-fe8d284cdd689b2553a5388a966b67c9.png?v=0" title="T_t" alt="T_t" class="tex"/> is the trend and <img src="../images/Algorithm_Winters/math-963123d6ba15e531cac42d449320e07c.png?v=0" title="S_t" alt="S_t" class="tex"/> is the seasonal component at time <img src="../images/Algorithm_Winters/math-e358efa489f58062f10dd7316b65649e.png?v=0" title="t" alt="t" class="tex"/> with <img src="../images/Algorithm_Winters/math-83878c91171338902e0fe0fb97a8c47a.png?v=0" title="p" alt="p" class="tex"/> being the seasonal order. The parameters, <img src="../images/Algorithm_Winters/math-7b7f9dbfea05c83784f8b85149852f08.png?v=0" title="\alpha" alt="\alpha" class="tex"/>, <img src="../images/Algorithm_Winters/math-77a3b715842b45e440a5bee15357ad29.png?v=0" title="\delta" alt="\delta" class="tex"/> and <img src="../images/Algorithm_Winters/math-ae539dfcc999c28e25a0f3ae65c1de79.png?v=0" title="\gamma" alt="\gamma" class="tex"/> control the weight of smoothing. <img src="../images/Algorithm_Winters/math-a568bf104397bd8311073893dff24222.png?v=0" title="y_t" alt="y_t" class="tex"/>, <img src="../images/Algorithm_Winters/math-be220b6d69bf6df768bf4c2f8c754480.png?v=0" title="\hat{y_t}" alt="\hat{y_t}" class="tex"/> and <img src="../images/Algorithm_Winters/math-52f4adf4af6ec1a247af4007a0b87793.png?v=0" title="y&#39;_t" alt="y&#39;_t" class="tex"/> are data value, fitted value and smoothed value at time <img src="../images/Algorithm_Winters/math-e358efa489f58062f10dd7316b65649e.png?v=0" title="t" alt="t" class="tex"/>.</dd></dl>
<h2><a name="Initialization_Method"></a><span class="mw-headline">Initialization Method</span></h2>
<ul><li> Intercept Difference between Groups</li></ul>
<dl><dd>Linear regression is carried out with the series as the dependent variable and the sequence 1,2,...,k as the independent variable. A separate intercept is used for each of the p seasonal groupings. The shared slope gives an estimate for <img src="../images/Algorithm_Winters/math-ab4ffa55f688360e0c12aef543c18351.png?v=0" title="T_0" alt="T_0" class="tex"/> and the mean of the intercepts is used as the estimate of <img src="../images/Algorithm_Winters/math-5944f94c330382d9a86e2cd4f393c07f.png?v=0" title="L_0" alt="L_0" class="tex"/>.</dd></dl>
<dl><dd>The seasonal parameters <img src="../images/Algorithm_Winters/math-b6015aa96c35aa343da7742210a5f4a9.png?v=0" title="S_{-j}" alt="S_{-j}" class="tex"/>, for <img src="../images/Algorithm_Winters/math-e171240720460c06f1cf87a791d448d5.png?v=0" title="j = 0,1,...,p-1" alt="j = 0,1,...,p-1" class="tex"/>, are estimated as the <img src="../images/Algorithm_Winters/math-83878c91171338902e0fe0fb97a8c47a.png?v=0" title="p" alt="p" class="tex"/> intercepts <img src="../images/Algorithm_Winters/math-5f59ad6911095659000a54cf3a8e2427.png?v=0" title="- L_0" alt="- L_0" class="tex"/>.</dd></dl>
<ul><li> Averaging First Period[<a href="#Ref2">2</a>]</li></ul>
<dl><dd>The level is the average of the first period. The slope is set to be the average of the slopes for each period in the first two period.</dd></dl>
<dl><dd><img src="../images/Algorithm_Winters/math-8794cc70af964abc1904da62fa3a1f5d.png?v=0" title="L_0 = (y_{1} + ... + y_{p}) / p " alt="L_0 = (y_{1} + ... + y_{p}) / p " class="tex"/></dd></dl>
<dl><dd><img src="../images/Algorithm_Winters/math-d4a70d5ac73c342b2292a3b143376ce4.png?v=0" title="T_0 = [(y_{p+1} + y_{p+2} + ... + y_{p+p}) - (y_{1} + y_{2} + ... + y_{p})] / p^2 " alt="T_0 = [(y_{p+1} + y_{p+2} + ... + y_{p+p}) - (y_{1} + y_{2} + ... + y_{p})] / p^2 " class="tex"/></dd></dl>
<dl><dd>The initial seasonal values <img src="../images/Algorithm_Winters/math-bd03e4b73140eeccc693c0969d43db1f.png?v=0" title="S_{-p+1},...,S_0" alt="S_{-p+1},...,S_0" class="tex"/> are calculated with <img src="../images/Algorithm_Winters/math-15ec230090686a4d574a0530d862b02c.png?v=0" title="y_i / L_0" alt="y_i / L_0" class="tex"/> for multiplicative seasonality, and <img src="../images/Algorithm_Winters/math-11f805137e847e84e42845b03b5b4e09.png?v=0" title="y_i - L_0" alt="y_i - L_0" class="tex"/> for additive seasonality.</dd></dl>
<ul><li> Fitting Detrended Data</li></ul>
<dl><dd>Multiplicative: Add data with <img src="../images/Algorithm_Winters/math-b5d17183aef40a17bf2810a0841b9056.png?v=0" title="2 \times (max-min)+2 \times abs(mean)" alt="2 \times (max-min)+2 \times abs(mean)" class="tex"/>. Fit a regression with linear trend to the first period of data (if <img src="../images/Algorithm_Winters/math-83878c91171338902e0fe0fb97a8c47a.png?v=0" title="p" alt="p" class="tex"/> is less than 4, at least first 4 points are used). The initial <img src="../images/Algorithm_Winters/math-ab4ffa55f688360e0c12aef543c18351.png?v=0" title="T_0" alt="T_0" class="tex"/> is set to the regression slope. The initial level <img src="../images/Algorithm_Winters/math-5944f94c330382d9a86e2cd4f393c07f.png?v=0" title="L_0" alt="L_0" class="tex"/> is set to the intercept subtracted by <img src="../images/Algorithm_Winters/math-b5d17183aef40a17bf2810a0841b9056.png?v=0" title="2 \times (max-min)+2 \times abs(mean)" alt="2 \times (max-min)+2 \times abs(mean)" class="tex"/>.</dd></dl>
<dl><dd>Additive: Fit a regression with linear trend to the first period of data (if <img src="../images/Algorithm_Winters/math-83878c91171338902e0fe0fb97a8c47a.png?v=0" title="p" alt="p" class="tex"/> is less than 4, at least first 4 points are used). Then the initial level <img src="../images/Algorithm_Winters/math-5944f94c330382d9a86e2cd4f393c07f.png?v=0" title="L_0" alt="L_0" class="tex"/> is set to the intercept, and the initial <img src="../images/Algorithm_Winters/math-ab4ffa55f688360e0c12aef543c18351.png?v=0" title="T_0" alt="T_0" class="tex"/> is set to the regression slope.</dd></dl>
<dl><dd>The initial seasonal values <img src="../images/Algorithm_Winters/math-bd03e4b73140eeccc693c0969d43db1f.png?v=0" title="S_{-p+1},...,S_0" alt="S_{-p+1},...,S_0" class="tex"/> are computed from the detrended data. Fit a regression with linear trend to the whole time series. The detrended data is calculated by subtracting (additive model) or dividing (multiplicative model) the trend. Perform a multiple linear regresstion to the detrended data with <img src="../images/Algorithm_Winters/math-83878c91171338902e0fe0fb97a8c47a.png?v=0" title="p" alt="p" class="tex"/> indicator variables. The coefficients of the regression model are used as the initial values for the seasonal indices.</dd></dl>
<h2><a name="Forecast"></a><span class="mw-headline">Forecast</span></h2>
<ul><li> Multiplicative:</li></ul>
<dl><dd><img src="../images/Algorithm_Winters/math-55bb93a8334a62cfa0375dde30c82a55.png?v=0" title="\hat{y}_{t+f} = ( L_t + f T_t )  S_{t-p}" alt="\hat{y}_{t+f} = ( L_t + f T_t )  S_{t-p}" class="tex"/></dd>
<dd><img src="../images/Algorithm_Winters/math-04d2c12aa5b057a3636a5be79011ffaf.png?v=0" title="var(\hat{y}_{t+f}) = var(\epsilon_t)(1 + \sum_{i=0}^{\infty}\sum_{j=0}^{p-1}(\psi_{j+ip}\frac{S_{t+f}}{S_{t+f-j}})^2)" alt="var(\hat{y}_{t+f}) = var(\epsilon_t)(1 + \sum_{i=0}^{\infty}\sum_{j=0}^{p-1}(\psi_{j+ip}\frac{S_{t+f}}{S_{t+f-j}})^2)" class="tex"/></dd>
<dd><img src="../images/Algorithm_Winters/math-c879c1c321d2a1aab7b9c5c109310828.png?v=0" title="\psi_i=\left\{\begin{array}{ll}0&amp;if\;i \geqslant f\cr\alpha + \alpha \gamma&amp;i\: mod \: p \neq 0\cr\alpha + \alpha \gamma + \delta(1-\alpha)&amp;Otherwise\end{array}\right." alt="\psi_i=\left\{\begin{array}{ll}0&amp;if\;i \geqslant f\cr\alpha + \alpha \gamma&amp;i\: mod \: p \neq 0\cr\alpha + \alpha \gamma + \delta(1-\alpha)&amp;Otherwise\end{array}\right." class="tex"/></dd>
<dd>where <img src="../images/Algorithm_Winters/math-f771db9eebc389ddddcdbc3bd294b5b0.png?v=0" title="var(\epsilon_t)" alt="var(\epsilon_t)" class="tex"/> is estimated as the mean deviation.</dd></dl>
<ul><li> Additive:</li></ul>
<dl><dd><img src="../images/Algorithm_Winters/math-45c29755b5dd49890f3636813eb9a54f.png?v=0" title="\hat{y}_{t+f} = L_t + f T_t + S_{t-p}" alt="\hat{y}_{t+f} = L_t + f T_t + S_{t-p}" class="tex"/></dd>
<dd><img src="../images/Algorithm_Winters/math-c66a13b0828cbc04aec6c475d95e318c.png?v=0" title="var(\hat{y}_{t+f}) = var(\epsilon_t)(1 + \sum_{i=1}^{f-1}\psi_i^2)" alt="var(\hat{y}_{t+f}) = var(\epsilon_t)(1 + \sum_{i=1}^{f-1}\psi_i^2)" class="tex"/></dd></dl>
<dl><dd>where <img src="../images/Algorithm_Winters/math-f771db9eebc389ddddcdbc3bd294b5b0.png?v=0" title="var(\epsilon_t)" alt="var(\epsilon_t)" class="tex"/> is estimated as the mean deviation.</dd></dl>
<h2><a name="Reference"></a><span class="mw-headline">Reference</span></h2>
<ol><li> <span id="Ref1"><span><a class="external text" href="https://d2mvzyuse3lwjc.cloudfront.net/pdfs/NAG26/Manual/html/g13/g13amc.html" target="_blank">nag_tsa_exp_smooth (g13amc)</a></li>
<li> <span id="Ref2"><span> Wongoutong, Chantha. (2021). Improvement of the Holt-Winters Multiplicative Method with a New Initial Value Settings Method.</span></li></ol>
<p></span>
</span>
</span>
</p>





