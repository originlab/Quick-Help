<h1 class="firstHeading">2.7 Time-Frequency Analysis</h1><p class='urlname' style='display: none'>Time-Frequency-Analysis</p>
<div class="toclimit-2"><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Summary"><span class="tocnumber">1</span> <span class="toctext">Summary</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Tutorial"><span class="tocnumber">2</span> <span class="toctext">Tutorial</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Algorithm"><span class="tocnumber">3</span> <span class="toctext">Algorithm</span></a></li>
</ul>
</div>
</div> 
<h2><a name="Summary"></a><span class="mw-headline">Summary</span></h2>
<p>This <a class="external text" href="https://www.originlab.com/fileExchange/details.aspx?fid=298" target="_blank">Time-Frequency Analysis app</a> can be used to perform time-frequency analysis based on continuous wavelet transform, including the following features:
</p>
<ol><li> Specify XY signal data, and get sampling interval from time (X) data automatically.</li>
<li> Specify frequency range for the continuous wavelet transform.</li>
<li> Wavelet types include Morlet, Derivative of Gaussian, and Mexican Hat.</li>
<li> Output calculated scale value and pseudo-frequency.</li>
<li> Output coefficient matrix and scalogram matrix.</li>
<li> Create graph with raw data as line plot, and coefficient or scalogram contour plot.</li>
<li> Support both scale vs time and frequency vs time contour plot.</li></ol>
<h2><a name="Tutorial"></a><span class="mw-headline">Tutorial</span></h2>
<ol>

<li>With an empty worksheet activated, run the following LabTalk script in Script Window (Open by menu Window: Script Window) to import data.
<pre class="lt" style="font-family:monospace;">fname<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;%@ATime-Frequency Analysis\bluejay.wav&quot;</span>;
impWav;</pre>
<dl><dd><a  class="image"><img alt="Time-Frequency Analysis 01.png" src="../images/Time-Frequency_Analysis/Time-Frequency_Analysis_01.png?v=74184" width="390"  /></a></dd></dl>
<li>Highlight column A of the imported data by clicking the column header, then launch the app by clicking the <b>Time-Frequency Analysis</b> icon  <a  class="image"><img alt="Time-Frequency Analysis icon.png" src="../images/Time-Frequency_Analysis/50px-Time-Frequency_Analysis_icon.png?v=74181" width="50"   /></a> from the Apps gallery.

<li>In the dialog, set <b>Frequency Range</b> from 1500 to 4000, and <b>Wave Number</b> to be 20.
<dl><dd><a  class="image"><img alt="Time-Frequency Analysis 02.png" src="../images/Time-Frequency_Analysis/Time-Frequency_Analysis_02.png?v=74185" width="410"  /></a></dd></dl>

<li>Click <b>OK</b> button to generate the results, including scales, pseudo-frequency, virtual matrix for coefficients, coefficient matrix, scalogram matrix, and a graph with raw data plot and contour of scalogram matrix.
<dl><dd><a  class="image"><img alt="Time-Frequency Analysis 03.png" src="../images/Time-Frequency_Analysis/Time-Frequency_Analysis_03.png?v=74186" width="672"  /></a></dd></dl>

<li>Focus on the created graph. Double click on the contour plot on the bottom layer to bring up the <b>Plot Details</b> dialog. Under the <b>Colormap/Contours</b> tab, click the <b>Level...</b> header of the table to set the levels, as the following image shows, setting <b>From</b> as 5e-4.
<dl><dd><a  class="image"><img alt="Time-Frequency Analysis 04.png" src="../images/Time-Frequency_Analysis/Time-Frequency_Analysis_04.png?v=74187" width="807"  /></a></dd></dl>

<li>Go back to <b>Plot Details</b> dialog and click <b>OK</b> button to finish the setting, and get the result graph.
<dl><dd><a  class="image"><img alt="Time-Frequency Analysis 05.png" src="../images/Time-Frequency_Analysis/Time-Frequency_Analysis_05.png?v=74188" width="672"  /></a></dd></dl>

</ol>
<h2><a name="Algorithm"></a><span class="mw-headline">Algorithm</span></h2>
<ol>
<li>Continuous wavelet transform
<br />Please refer to this page: <a class="external free" href="http://www.originlab.com/doc/Origin-Help/CWT-Algorithm" target="_blank">http://www.originlab.com/doc/Origin-Help/CWT-Algorithm</a>

<li>Scalogram calculation
<br />Assume coefficient matrix (calculated from continuous wavelet transform) is matCoef.
First we compute the product of matCoef multiplied by matCoef itself element by element, to generate matrix matProd.
Then we get the absolute value of each value in matProd, to generate matrix matProdAbs.
Then we calculate the sum of matProdAbs as sum.
Finally, the scalogram matrix, matScalogram is calcualted as 100*matProdAbs/sum.



</ol>






