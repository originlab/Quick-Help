<h1 class="firstHeading">2.56 Empirical Mode Decomposition (Pro)</h1><p class='urlname' style='display: none'>Empirical-mode-decomposition</p>
<div class="toclimit-2"><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Summary"><span class="tocnumber">1</span> <span class="toctext">Summary</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Tutorial"><span class="tocnumber">2</span> <span class="toctext">Tutorial</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Generating_data_of_skewed.2C_nonlinear_near-bed_wave"><span class="tocnumber">2.1</span> <span class="toctext">Generating data of skewed, nonlinear near-bed wave</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4"><a href="#Algorithm"><span class="tocnumber">3</span> <span class="toctext">Algorithm</span></a></li>
</ul>
</div>
</div> 
<h2><a name="Summary"></a><span class="mw-headline">Summary</span></h2>
<p>This <a class="external text" href="https://www.originlab.com/fileExchange/details.aspx?fid=613" target="_blank">Empirical Mode Decomposition app</a> can be used to perform Empirical Mode Decomposition, and Spectrum Analysis including Frequency Transform and Hilbert-Huang transform.
</p><p>The App requires Python library <b>emd</b>. The library and other dependent Python libraries will be automatically installed when the App is launched the time.
</p>
<h2><a name="Tutorial"></a><span class="mw-headline">Tutorial</span></h2>
<ol><li> Open a new project or a new workbook. Generate XY data with steps in <a href="#Generating_data_of_skewed.2C_nonlinear_near-bed_wave">section below</a>. We will get a skewed, nonlinear near-bed wave
<dl><dd> <a  class="image"><img alt="Emd input.png" src="../images/Empirical_Mode_Decomposition/500px-Emd_input.png?v=69997" width="500"   /></a></dd></dl></li>
<li> Highlight column B, and then click the Empirical Mode Decomposition icon, <a  class="image"><img alt="Emd icon.png" src="../images/Empirical_Mode_Decomposition/50px-Emd_icon.png?v=69999" width="50"   /></a>, from <b>Apps Gallery</b>.</li>
<li> When the dialog is open, switch to Sifting tab, clear the checkbox of <b>Maximum IMFs line</b>, and then set this parameter to 5.
<dl><dd> <a  class="image"><img alt="Emd sifting.png" src="../images/Empirical_Mode_Decomposition/400px-Emd_sifting.png?v=70005" width="400"   /></a></dd></dl></li>
<li> Go to <b>Spectrum Analysis</b> tab, select the <b>Hilbert-Huang Transform</b> checkbox, and then under <b>Hilbert-Huang Transform Options</b> group, clear <b>With Time Dimension (2D)</b> checkbox.
<dl><dd> <a  class="image"><img alt="Emd spectrum analysis.png" src="../images/Empirical_Mode_Decomposition/500px-Emd_spectrum_analysis.png?v=70006" width="500"   /></a></dd></dl></li>
<li> Click <b>Output</b> tab, and change <b>Output</b> to <b>New Book</b>.</li>
<li> Click <b>OK</b>.
<dl><dd> <a  class="image"><img alt="Emd results.png" src="../images/Empirical_Mode_Decomposition/600px-Emd_results.png?v=70007" width="600"   /></a></dd></dl></li></ol>
<h3><a name="Generating_data_of_skewed.2C_nonlinear_near-bed_wave"></a><span class="mw-headline">Generating data of skewed, nonlinear near-bed wave</span></h3>
<p>To simulate a non-linear waveform using <b>equation 9 in [1]</b>.
</p>
<table class="formula">

<tr>
<td><img src="../images/Empirical_Mode_Decomposition/math-7334efdefebc77cdd2e82e7e04e3e449.png?v=0" title="u(t)=U_wf\frac{\left [sin(\omega t)-\frac{r}{1+\sqrt{1-r^2}}\right ]}{[1-rsin(\omega t)]}" alt="u(t)=U_wf\frac{\left [sin(\omega t)-\frac{r}{1+\sqrt{1-r^2}}\right ]}{[1-rsin(\omega t)]}" class="tex"/>
</td>
<td> (9)
</td>
<td>
</td></tr></table>
<ol><li> Choose menu <b>Window: Script Window</b> to open <b>Script Window</b> if it is not yet open</li>
<li> Copy and paste scripts below in <b>Script Window</b>, highlight all lines and press Enter to run them</li></ol>
<pre class="lt" style="font-family:monospace;">range rx <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>Book1<span style="color: #000000;">&#93;</span>Sheet1<span style="color: #000080;">!</span>col<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// Column A range</span>
range ry <span style="color: #000080;">=</span> <span style="color: #000000;">&#91;</span>Book1<span style="color: #000000;">&#93;</span>Sheet1<span style="color: #000080;">!</span>col<span style="color: #000000;">&#40;</span>B<span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// Column B range</span>

sample_rate <span style="color: #000080;">=</span> <span style="color: #0000dd;">2000</span>;  <span style="color: #008000;">// Sampling frequency</span>
seconds <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>;  <span style="color: #008000;">// Number of seconds</span>
num_samples <span style="color: #000080;">=</span> sample_rate <span style="color: #000080;">*</span> seconds;  <span style="color: #008000;">// Number of samples</span>
f <span style="color: #000080;">=</span> <span style="color: #0000dd;">10</span>;  <span style="color: #008000;">// Fundamental frequency</span>
nonlin_deg <span style="color: #000080;">=</span> <span style="color: #0000dd;">0.25</span>;  <span style="color: #008000;">// Degree of non-linearity</span>
nonlin_phi <span style="color: #000080;">=</span> <span style="color: #000080;">-</span>pi <span style="color: #000080;">/</span> <span style="color: #0000dd;">4</span>;  <span style="color: #008000;">// Skew in non-linearity</span>

rx <span style="color: #000080;">=</span> data<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span>, seconds, seconds <span style="color: #000080;">/</span> <span style="color: #000000;">&#40;</span>num_samples<span style="color: #000080;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// Generate the time vector, and put it to column A</span>

<span style="color: #008000;">// The following is the equation 9 in [1]</span>
factor <span style="color: #000080;">=</span> sqrt<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #000080;">-</span>nonlin_deg<span style="color: #000080;">*</span>nonlin_deg<span style="color: #000000;">&#41;</span>; 
num <span style="color: #000080;">=</span> nonlin_deg <span style="color: #000080;">*</span> sin<span style="color: #000000;">&#40;</span>nonlin_phi<span style="color: #000000;">&#41;</span> <span style="color: #000080;">/</span> <span style="color: #0000dd;">1</span> <span style="color: #000080;">+</span> factor;
numerator <span style="color: #000080;">=</span> num <span style="color: #000080;">+</span> sin<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000080;">*</span>pi<span style="color: #000080;">*</span>f<span style="color: #000080;">*</span>rx<span style="color: #000000;">&#41;</span>;
denominator <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span> <span style="color: #000080;">-</span> nonlin_deg <span style="color: #000080;">*</span> cos<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000080;">*</span>pi<span style="color: #000080;">*</span>f<span style="color: #000080;">*</span>rx <span style="color: #000080;">+</span> nonlin_phi<span style="color: #000000;">&#41;</span>;
ry <span style="color: #000080;">=</span> factor <span style="color: #000080;">*</span> <span style="color: #000000;">&#40;</span>numerator <span style="color: #000080;">/</span> denominator<span style="color: #000000;">&#41;</span>;

ry <span style="color: #000080;">=</span> ry  <span style="color: #000080;">-</span> sin<span style="color: #000000;">&#40;</span><span style="color: #0000dd;">2</span><span style="color: #000080;">*</span>pi<span style="color: #000080;">*</span><span style="color: #0000dd;">0.1</span><span style="color: #000080;">*</span>rx<span style="color: #000000;">&#41;</span>;  <span style="color: #008000;">// Add part of cycle as a trend</span>
white_noise ry;  <span style="color: #008000;">// Add some noise</span></pre>
<p><br />
[1] Abreu, T., Silva, P. A., Sancho, F., &amp; Temperville, A. (2010). <i>Analytical approximate wave form for asymmetric waves. Coastal Engineering</i>, 57(7), 656â€“667. <a class="external free" href="https://doi.org/10.1016/j.coastaleng.2010.02.005" target="_blank">https://doi.org/10.1016/j.coastaleng.2010.02.005</a>
</p>
<h2><a name="Algorithm"></a><span class="mw-headline">Algorithm</span></h2>
<p><a class="external text" href="https://emd.readthedocs.io/en/stable/" target="_blank">EMD: Empirical Mode Decomposition</a>
</p>





