<h1 class="firstHeading">2.42 Neural Network Fitting(Pro)</h1><p class='urlname' style='display: none'>Neural-Network-Fitting</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Summary"><span class="tocnumber">1</span> <span class="toctext">Summary</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Sample_OPJ"><span class="tocnumber">2</span> <span class="toctext">Sample OPJ</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Example_1:_Two-Peaks_Curve_Fitting"><span class="tocnumber">3</span> <span class="toctext">Example 1: Two-Peaks Curve Fitting</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Example_2:_Fisher.27s_Iris_Data"><span class="tocnumber">4</span> <span class="toctext">Example 2: Fisher's Iris Data</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Installing_the_APP"><span class="tocnumber">5</span> <span class="toctext">Installing the APP</span></a></li>
</ul>
</div>

<h2><a name="Summary"></a><span class="mw-headline">Summary</span></h2>
<p>This <a class="external text" href="https://www.originlab.com/fileExchange/details.aspx?fid=540" target="_blank">Neural Network Fitting app</a> is used to fit data with neural network backpropagation. It trains a neural network to map between a set of inputs and output. The app can be used to predict response of independent variables.
</p><p>The app requires <b>R</b> software (minimum required version 3.4.1) and package <b>neuralnet</b>. The packages  will be automatically installed when the App is launched the time. If not, please follow the steps of <a href="#Installing_the_APP"> Installing the app section</a> in this tutorial to trouble shoot.
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Neural_Network_Fitting/Tip_icon.png?v=8477" width="57"  border="0" /></td><td><p>Origin provides another app <a class="external text" href="https://www.originlab.com/fileExchange/details.aspx?fid=581" target="_blank"><b>Neural Network Regression</b></a> to do the same work with Python packages.
</p></td></tr></table>
<h2><a name="Sample_OPJ"></a><span class="mw-headline">Sample OPJ</span></h2>
<ol><li> Right click on the app in Apps Gallery and choose <b>Show Samples Folder</b> from the context menu
<dl><dd><a  class="image"><img alt="NNR sample.png" src="../images/Neural_Network_Fitting/180px-NNR_sample.png?v=70362" width="180"   /></a></dd></dl></li>
<li> Drag and drop the project file in the opened folder to Origin to open it</li></ol>
<h2><a name="Example_1:_Two-Peaks_Curve_Fitting"></a><span class="mw-headline">Example 1: Two-Peaks Curve Fitting</span></h2>
<p>We have a curve with two peaks, and want to fit it with network backpropagation. We will then predict Y values from given X values.
</p>
<dl><dd><a  class="image"><img alt="Two peaks.png" src="../images/Neural_Network_Fitting/600px-Two_peaks.png?v=70336" width="600"   /></a></dd></dl>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Neural_Network_Fitting/Tip_icon.png?v=8477" width="57"  border="0" /></td><td><p>There is no fixed way for finding the best settings of the model. The settings often require several attempts based on your data, to optimize the results. 
</p></td></tr></table>
<ol><li> Make sure we opened folder <b>1. Two Peaks</b></li>
<li> Create a scatter plot graph from column A and B of Book5. Activate the graph and click on the <b>Neural Network Fitting</b> icon in the <b>Apps Gallery</b> to open the dialog</li>
<li> <b>Input</b> is filled automatically with the 1st plot on graph</li>
<li> In the <b>Options</b> tab, change the settings as below. and click <b>OK</b> button
<dl><dd> <a  class="image"><img alt="NNF Ex1 Options.png" src="../images/Neural_Network_Fitting/500px-NNF_Ex1_Options.png?v=71470" width="500"   /></a></dd></dl>
<ul><li> "2 3 4 3" is the number of neurons in each hidden layer. (The selection of an architecture for your neural network can only be done by trial and error. You can refer to <a class="external text" href="https://stats.stackexchange.com/questions/181/how-to-choose-the-number-of-hidden-layers-and-nodes-in-a-feedforward-neural-netw" target="_blank">the reference page</a> as a starting point.)</li>
<li> <b>Hyperbolic Tangent</b> is chosen as Activation Function because we are going to fit a nonlinear curve. Both <b>Hyperbolic Tangent</b> and <b>Logistic</b> are good for nonlinear curve with peaks. </li>
<li> Set <b>K = 5</b> which means split the data sample into 5 groups for cross-validation. In cross-validation, each training data is treated as the test data, and is excluded from training data to judge which group it should be classified to, and then verify whether the classification is correct or not. </li></ul></li>
<li> A new book with Neural Network Regression result is generated
<dl><dd><a  class="image"><img alt="NNF Ex1 Results.png" src="../images/Neural_Network_Fitting/600px-NNF_Ex1_Results.png?v=71462" width="600"   /></a></dd></dl></li>
<li> Now we are going to predict Y from given X values. Click the green lock on the report sheet and choose <b>Change Parameters</b> from the menu. </li>
<li> In the <b>Prediction</b> tab of the dialog, select Col(D) as <b>Independent Variables</b> and then click <b>OK</b>
<dl><dd> <a  class="image"><img alt="Nnr prediction.png" src="../images/Neural_Network_Fitting/400px-Nnr_prediction.png?v=70349" width="400"   /></a></dd></dl></li>
<li> We can find the predicted Y values in the sheet <b>FitData</b>
<dl><dd><a  class="image"><img alt="NNF Ex1 Prediction.png" src="../images/Neural_Network_Fitting/600px-NNF_Ex1_Prediction.png?v=71463" width="600"   /></a></dd></dl></li></ol>
<h2><a name="Example_2:_Fisher.27s_Iris_Data"></a><span class="mw-headline">Example 2: Fisher's Iris Data</span></h2>
<ol><li> Switch to folder <b>2.Fisher's Iris Data</b> in the <b>Project Explorer</b></li>
<li> Activate the workbook in the folder, click on the <b>Neural Network Fitting</b> icon in the <b>Apps Gallery</b> to open the dialog</li>
<li> In the <b>Input</b> tab, set <b>Independent Data</b> to be Column A ~ Column D, <b>Dependent Data</b> to be Column E</li>
<li> In the <b>Options</b> tab, set settings as below. Then click <b>OK</b> to generate results
<dl><dd><a  class="image"><img alt="NNF Ex2 Options.png" src="../images/Neural_Network_Fitting/500px-NNF_Ex2_Options.png?v=71466" width="500"   /></a></dd></dl>
<ul><li> "4 3 2" is the number neurons in each hidden layer. We have three group in independent variable so it is good to have three hidden layers.  (The selection of an architecture for your neural network can only be done by trial and error. You can refer to <a class="external text" href="https://stats.stackexchange.com/questions/181/how-to-choose-the-number-of-hidden-layers-and-nodes-in-a-feedforward-neural-netw" target="_blank">the reference page</a> as a starting point.)</li></ul></li>
<li> In the <b>Prediction</b> tab, select Col(G)~Col(J) as <b>Independent Variables</b> and then click <b>OK</b>
<dl><dd><a  class="image"><img alt="NNF Ex2 Prediction.png" src="../images/Neural_Network_Fitting/400px-NNF_Ex2_Prediction.png?v=71471" width="400"   /></a></dd></dl></li></ol>
<h2><a name="Installing_the_APP"></a><span class="mw-headline">Installing the APP</span></h2>
<ol><li> Make sure you install <b>R</b> software (later than 3.4.1)</li>
<li> Click the Neural Network Fitting icon <a  class="image"><img alt="NNF Icon.png" src="../images/Neural_Network_Fitting/50px-NNF_Icon.png?v=71474" width="50"   /></a> on <b>Apps Gallery</b></li>
<li> The needed package will be downloaded automatically. If failed, The messages will be pop up in the <b>results log</b></li>
<li> Open the <b>R</b> package, copy and paste the last two lines from <b>Results Log</b> to <b>R</b>, press Enter to run them</li>
<li> A dialog will be pop up for you to select a site,  then the needed packages will be downloaded automatically in R</li>
<li> Once the packages are successfully downloaded without error message , restart Origin</li></ol>


