<h1 class="firstHeading">4.2 Run Python from Graph Object</h1><p><br />
Python code can be stored in a graphical object placed on a graph, worksheet or matrixsheet. The code gets executed if certain event of the object is triggered which is same as running <a class="external text" href="https://www.originlab.com/doc/LabTalk/guide/From-Graphical-objs" target="_blank">Labtalk Script</a> behind an object. 
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Run_Python_from_Graph_Object/Tip_icon.png?v=21427" width="57"  border="0" /></td><td><p>In order for the script to be recognized as Python, it should begin with either of the following: #,''' (triple single-quote), &quot;&quot;&quot; (triple double-quote), import.
</p></td></tr></table>
<h2><a name="Run_Python_Script_From_a_Text_Object"></a><span class="mw-headline">Run Python Script From a Text Object</span></h2>
<ol>
<li>Create a new workbook.</li>
<li>Select the <b>Text</b> tool <a  class="image"><img alt="Button Text Tool.png" src="../images/Run_Python_from_Graph_Object/Button_Text_Tool.png?v=52954" width="23"  /></a> from the <b>Tools</b> toolbar to the left side of the project window. </li>
<li>Click on an open space on the worksheet (click in the gray area to the right of the last column). Type "Run" in the text object and click outside the object. You have now created a label for the button.</li>
<li>Hold down the ALT key while double-clicking on the text object that you just created.  The object dialog opens to the <b>Programming</b> tab.</li>
<li>In the lower text box, enter this script:</li>
<pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">import</span> pandas <span style="color: #ff7700;font-weight:bold;">as</span> pd
<span style="color: #ff7700;font-weight:bold;">import</span> originpro <span style="color: #ff7700;font-weight:bold;">as</span> op

data <span style="color: #000;">=</span> <span style="color: #000;">&#123;</span><span style="color: #0a0;">'Name'</span>:<span style="color: #000;">&#91;</span><span style="color: #0a0;">'Tom'</span><span style="color: #000;">,</span> <span style="color: #0a0;">'Jack'</span><span style="color: #000;">,</span> <span style="color: #0a0;">'Mike'</span><span style="color: #000;">,</span> <span style="color: #0a0;">'Alice'</span><span style="color: #000;">&#93;</span><span style="color: #000;">,</span>
        <span style="color: #0a0;">'Grade'</span>:<span style="color: #000;">&#91;</span><span style="color: #000;">99</span><span style="color: #000;">,</span> <span style="color: #000;">98</span><span style="color: #000;">,</span> <span style="color: #000;">95</span><span style="color: #000;">,</span> <span style="color: #000;">90</span><span style="color: #000;">&#93;</span><span style="color: #000;">&#125;</span>

df <span style="color: #000;">=</span> pd.<span style="color: #000;">DataFrame</span><span style="color: #000;">&#40;</span>data<span style="color: #000;">&#41;</span>
wks <span style="color: #000;">=</span> op.<span style="color: #000;">find_sheet</span><span style="color: #000;">&#40;</span><span style="color: #000;">&#41;</span>
wks.<span style="color: #000;">from_df</span><span style="color: #000;">&#40;</span>df<span style="color: #000;">&#41;</span></pre>
<li>From the <b>Script Run After</b> drop-down list, select <b>Button Up</b>, and click <b>OK</b>.</li>
<li>Press the button and import data into the worksheet.</li>
<p><a  class="image"><img alt="Python Button.png" src="../images/Run_Python_from_Graph_Object/300px-Python_Button.png?v=53551" width="300"   /></a>
</p>
</ol>


