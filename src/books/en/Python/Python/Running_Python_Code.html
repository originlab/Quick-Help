<h1 class="firstHeading">3 Running Python Code</h1><p class='urlname' style='display: none'>Running_Python_Code</p>
<p>The following sections document various ways to store and execute Python code in Origin.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#From_Python_Console"><span class="tocnumber">1</span> <span class="toctext">From Python Console</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#From_Code_Builder"><span class="tocnumber">2</span> <span class="toctext">From Code Builder</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#From_External_.py_File"><span class="tocnumber">3</span> <span class="toctext">From External .py File</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#From_.py_File_Attached_to_Project"><span class="tocnumber">4</span> <span class="toctext">From .py File Attached to Project</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#From_a_Button"><span class="tocnumber">5</span> <span class="toctext">From a Button</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Calling_Python_Functions"><span class="tocnumber">6</span> <span class="toctext">Calling Python Functions</span></a></li>
</ul>
</div>

<h2><a name="From_Python_Console"></a><span class="mw-headline">From Python Console</span></h2>
<p>The Python Console is ideal if you have <a href="../../Python/Python/RunPython_(Python).html#Run_Python_Command_in_Console" title="Python:RunPython (Python)">just a few lines of Python code to execute</a>. Intellisense is supported in the console, so it is also very useful to explore objects and methods available in the originpro package.
</p><p>Use the <b>Connectivity: Python Console...</b> menu in Origin to open Python Console window.
</p><p><a  class="image"><img alt="PythonConsoleIntens1.png" src="../images/Running_Python_Code/700px-PythonConsoleIntens1.png?v=53397" width="700"   /></a>
</p>
<h2><a name="From_Code_Builder"></a><span class="mw-headline">From Code Builder</span></h2>
<p>You can develop your Python code using <b>Code Builder</b>. Code highlighting, intellisense, and debugging are supported.
</p><p><a  class="image"><img alt="CodeBuilder Python.png" src="../images/Running_Python_Code/700px-CodeBuilder_Python.png?v=53268" width="700"   /></a>
</p><p>Use the <b>Connectivity: Open utitled.py...</b> menu in Origin to open Code Builder. Once you have edited your code, you can run the code by pressing the F5 key. It is not even necessary to save the code to a file prior to executing. The <b>Tools</b> menu in Code Builder has three entries specific for Python:
</p>
<ul><li><b>Python Packages</b>: Install, update or uninstall packages</li>
<li><b>Intellisense</b>: Turn intellisense on/off</li>
<li><b>Clean Python Packages</b>: Clean/remove compiled PYC files in User Files Folder</li></ul>
<p><br />
</p>
<h2><a name="From_External_.py_File"></a><span class="mw-headline">From External .py File</span></h2>
<p>You can run code saved in a <b>.py</b> file from anywhere in Origin where LabTalk Script is supported, such as the Script Window, using the <a class="external text" href="../../LabTalk/LabTalk/Run_(command).html">Run command</a>.
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Run code from file test.py saved in your User-Files Folder</span>
run <span style="color: #000080;">-</span>pyf test.<span style="color: #000080;">py</span>;

<span style="color: #008000;">// Run code from file saved in a specific folder</span>
string str<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">&quot;C:\temp\test.py&quot;</span>;
run <span style="color: #000080;">-</span>pyf <span style="color: #000080;">%</span><span style="color: #000000;">&#40;</span>str<span style="color: #000080;">$</span><span style="color: #000000;">&#41;</span>;</pre>
<p><br />
You can pass variables to your Python code from LabTalk script. Try the following:
</p>
<ol>
<li>From Origin, use the menu <b>Connectivity: Open untitled.py....</b>
<li>In Code Builder, on the right side, you will see a tab named <b>untitled.py</b>. Paste the following Python code:
<pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #000;">sys</span>
<span style="color: #ff7700;font-weight:bold;">if</span> __name__ <span style="color: #000;">==</span> <span style="color: #0a0;">'__main__'</span>:
    <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: #000;">&#40;</span><span style="color: #900090;">len</span><span style="color: #000;">&#40;</span><span style="color: #000;">sys</span>.<span style="color: #000;">argv</span><span style="color: #000;">&#41;</span><span style="color: #000;">&#41;</span>
    <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: #000;">&#40;</span><span style="color: #000;">sys</span>.<span style="color: #000;">argv</span><span style="color: #000;">&#91;</span><span style="color: #000;">1</span><span style="color: #000;">&#93;</span><span style="color: #000;">&#41;</span>
    <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: #000;">&#40;</span><span style="color: #000;">sys</span>.<span style="color: #000;">argv</span><span style="color: #000;">&#91;</span><span style="color: #000;">2</span><span style="color: #000;">&#93;</span><span style="color: #000;">&#41;</span></pre>
<li>Use the <b>File:Save As...</b> menu in Code Builder, and save the file as <b>test.py</b> to the default location, which is your User Files Folder.
<li>Go back to Origin and open the script window using the Origin menu <b>Window: Script Window</b>. Then paste the following lines of LabTalk script:
<pre class="lt" style="font-family:monospace;">double var1 <span style="color: #000080;">=</span> <span style="color: #0000dd;">123.456</span>;
string var2<span style="color: #000080;">$</span> <span style="color: #000080;">=</span> <span style="color: #ff00ff;">'hello'</span>;
run <span style="color: #000080;">-</span>pyf test.<span style="color: #000080;">py</span> <span style="color: #ff00ff;">&quot;$(var1)&quot;</span> <span style="color: #ff00ff;">&quot;%(var2$)&quot;</span>;</pre>
<li>Drag your mouse and select all three lines of the script code and press Enter key to execute.
<li>You should see the output:
<pre class="lt" style="font-family:monospace;"><span style="color: #0000dd;">3</span>
<span style="color: #0000dd;">123.456</span>
<span style="color: #ff00ff;">'hello'</span></pre>
</ol>
<h2><a name="From_.py_File_Attached_to_Project"></a><span class="mw-headline">From .py File Attached to Project</span></h2>
<p>The <b>.py</b> file containing your Python code can be attached to the Origin project. Once it is attached, you can execute the code using the script command:
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Execute Python code stored in file test.py attached to project</span>
run <span style="color: #000080;">-</span>pyp test.<span style="color: #000080;">py</span>;
<span style="color: #008000;">// Can leave out the .py extension</span>
run <span style="color: #000080;">-</span>pyp test;</pre>
<p><br />
To create and attach a file to the project, do the following:
</p>
<ol>
<li>Edit your Pyton code in Code Builder and save it to a file with desired name.
<li>Use the Code Builder menu <b>File: Add to Workspace</b>. Your file will now appear under the <b>User</b> branch of the Workspace tree on the left.
<li>Drag and drop your file from the User branch to the <b>Project</b> branch in the Workspace tree.
<li> Now the file is attached to the project. 
<li> Double click on this entry under the Project branch to open the code in a new tab on the right side to perform further edits.
<li> From Origin, save your project. The code file is now attached to the project and the code can be executed from anywhere in Origin where Labtalk script is supported.
</ol>
<h2><a name="From_a_Button"></a><span class="mw-headline">From a Button</span></h2>
<p>Python code can be stored in a button and gets executed on click. Check this <a href="../../Python/Python/Run_Python_from_Graph_Object.html" title="Python:Run Python from Graph Object">page</a> for details. 
</p>
<h2><a name="Calling_Python_Functions"></a><span class="mw-headline">Calling Python Functions</span></h2>
<p>Instead of running Python code, you can define Python functions and call the functions from Origin such as from <a href="../../Python/Python/Set_Column_Values.html" title="Python:Set Column Values">Column Formula</a>, <a class="external text" href="../../UserGuide/UserGuide/Importing_User_Defined_Data_Files.html">Import Wizard</a> and from <a href="../../Python/Python/NLFit_and_Peak_Analyzer.html" title="Python:NLFit and Peak Analyzer">Fitting Functions</a>.
</p>





