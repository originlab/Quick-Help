<h1 class="firstHeading">5.2 Worksheet</h1><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Import_CSV_with_Auto_Settings"><span class="tocnumber">1</span> <span class="toctext">Import CSV with Auto Settings</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Import_CSV_with_Selected_Rows"><span class="tocnumber">2</span> <span class="toctext">Import CSV with Selected Rows</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Import_Excel_Sheet"><span class="tocnumber">3</span> <span class="toctext">Import Excel Sheet</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Import_HTML_Table_from_the_Web"><span class="tocnumber">4</span> <span class="toctext">Import HTML Table from the Web</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Import_MATLAB"><span class="tocnumber">5</span> <span class="toctext">Import MATLAB</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Import_Multiple_Files_using_Pandas_into_One_Worksheet"><span class="tocnumber">6</span> <span class="toctext">Import Multiple Files using Pandas into One Worksheet</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Import_Two_Excel_Sheets"><span class="tocnumber">7</span> <span class="toctext">Import Two Excel Sheets</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Import_Using_a_Filter"><span class="tocnumber">8</span> <span class="toctext">Import Using a Filter</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Import_by_Setting_File_Header_Info"><span class="tocnumber">9</span> <span class="toctext">Import by Setting File Header Info</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#Manipulate_Columns_and_Make_Group_Plot"><span class="tocnumber">10</span> <span class="toctext">Manipulate Columns and Make Group Plot</span></a></li>
<li class="toclevel-1 tocsection-11"><a href="#Split_Dataset_to_Training_and_Testing_Data"><span class="tocnumber">11</span> <span class="toctext">Split Dataset to Training and Testing Data</span></a></li>
</ul>
</div>

<p>
<p>This folder contains examples of data import, worksheet manipulation, calculation and graphing with <strong>originpro</strong> package.<br />
For worksheet related functions in <strong>originpro</strong>, see <a href="https://docs.originlab.com/originpro/classoriginpro_1_1worksheet_1_1WSheet.html">worksheet</a>.<br />
For project related functions, see <a href="https://docs.originlab.com/originpro/namespaceoriginpro_1_1project.html">project</a>.</p>

</p>
<h2><a name="Import_CSV_with_Auto_Settings"></a><span class="mw-headline">Import CSV with Auto Settings</span></h2>
<pre class="python" style="font-family:monospace;"><span style="color: #0a0;">'''
This sample shows how to use from_file function to import text data to worksheet
'''</span>
<span style="color: #ff7700;font-weight:bold;">import</span> originpro <span style="color: #ff7700;font-weight:bold;">as</span> op

f <span style="color: #000;">=</span> op.<span style="color: #000;">path</span><span style="color: #000;">&#40;</span><span style="color: #0a0;">'e'</span><span style="color: #000;">&#41;</span>+r<span style="color: #0a0;">'Samples<span style="color: #000099; font-weight: bold;">\C</span>urve Fitting<span style="color: #000099; font-weight: bold;">\E</span>nzyme.dat'</span>

<span style="color: #d00; font-style: italic;">#assume active worksheet</span>
wks <span style="color: #000;">=</span> op.<span style="color: #000;">find_sheet</span><span style="color: #000;">&#40;</span><span style="color: #000;">&#41;</span>

<span style="color: #d00; font-style: italic;">#By default, CSV connector is used</span>
wks.<span style="color: #000;">from_file</span><span style="color: #000;">&#40;</span>f<span style="color: #000;">&#41;</span>

<span style="color: #ff7700;font-weight:bold;">print</span><span style="color: #000;">&#40;</span>wks.<span style="color: #000;">shape</span><span style="color: #000;">&#41;</span></pre>
<h2><a name="Import_CSV_with_Selected_Rows"></a><span class="mw-headline">Import CSV with Selected Rows</span></h2>
<pre class="python" style="font-family:monospace;"><span style="color: #0a0;">'''
This example shows how to do partial import with CSV data connector
'''</span>
<span style="color: #ff7700;font-weight:bold;">import</span> originpro <span style="color: #ff7700;font-weight:bold;">as</span> op

f <span style="color: #000;">=</span> op.<span style="color: #000;">path</span><span style="color: #000;">&#40;</span><span style="color: #0a0;">'e'</span><span style="color: #000;">&#41;</span>+r<span style="color: #0a0;">'Samples<span style="color: #000099; font-weight: bold;">\I</span>mport and Export<span style="color: #000099; font-weight: bold;">\S</span>15-125-03.dat'</span>
wks <span style="color: #000;">=</span> op.<span style="color: #000;">new_sheet</span><span style="color: #000;">&#40;</span><span style="color: #000;">&#41;</span>

<span style="color: #d00; font-style: italic;">#Use CSV connector which is the default</span>
<span style="color: #d00; font-style: italic;">#and connector will be removed after import</span>
dc <span style="color: #000;">=</span> op.<span style="color: #000;">Connector</span><span style="color: #000;">&#40;</span>wks<span style="color: #000;">&#41;</span>

<span style="color: #d00; font-style: italic;">#Specify the rows to import</span>
ss <span style="color: #000;">=</span> dc.<span style="color: #000;">settings</span><span style="color: #000;">&#40;</span><span style="color: #000;">&#41;</span>
partial <span style="color: #000;">=</span> ss<span style="color: #000;">&#91;</span><span style="color: #0a0;">'partial'</span><span style="color: #000;">&#93;</span>
partial<span style="color: #000;">&#91;</span>op.<span style="color: #000;">attrib_key</span><span style="color: #000;">&#40;</span><span style="color: #0a0;">'Use'</span><span style="color: #000;">&#41;</span><span style="color: #000;">&#93;</span><span style="color: #000;">=</span><span style="color: #0a0;">'1'</span>
partial<span style="color: #000;">&#91;</span><span style="color: #0a0;">'row'</span><span style="color: #000;">&#93;</span><span style="color: #000;">=</span><span style="color: #0a0;">'10:20'</span>

<span style="color: #d00; font-style: italic;">#import from rwo 10 to row 20</span>
dc.<span style="color: #000;">imp</span><span style="color: #000;">&#40;</span>f<span style="color: #000;">&#41;</span></pre>
<h2><a name="Import_Excel_Sheet"></a><span class="mw-headline">Import Excel Sheet</span></h2>
<pre class="python" style="font-family:monospace;"><span style="color: #0a0;">'''
This example shows how to Customize the Excel data connector.
1. Parse headerlines to column labels.
2. Import partial cols and rows.
3. Specify the spreadsheet to import.
'''</span>
<span style="color: #ff7700;font-weight:bold;">import</span> originpro <span style="color: #ff7700;font-weight:bold;">as</span> op

f <span style="color: #000;">=</span> op.<span style="color: #000;">path</span><span style="color: #000;">&#40;</span><span style="color: #0a0;">'e'</span><span style="color: #000;">&#41;</span>+r<span style="color: #0a0;">'Samples<span style="color: #000099; font-weight: bold;">\I</span>mport and Export<span style="color: #000099; font-weight: bold;">\P</span>artial Import.xlsx'</span>
wks <span style="color: #000;">=</span> op.<span style="color: #000;">new_sheet</span><span style="color: #000;">&#40;</span><span style="color: #000;">&#41;</span>

<span style="color: #d00; font-style: italic;">#Create data connector object</span>
dc <span style="color: #000;">=</span> op.<span style="color: #000;">Connector</span><span style="color: #000;">&#40;</span>wks<span style="color: #000;">,</span> dctype<span style="color: #000;">=</span><span style="color: #0a0;">'Excel'</span><span style="color: #000;">,</span> keep_DC<span style="color: #000;">=</span><span style="color: #900090;">True</span><span style="color: #000;">&#41;</span>
ss <span style="color: #000;">=</span> dc.<span style="color: #000;">settings</span><span style="color: #000;">&#40;</span><span style="color: #000;">&#41;</span>

<span style="color: #d00; font-style: italic;">#Headerlines to column label</span>
labels <span style="color: #000;">=</span> ss<span style="color: #000;">&#91;</span><span style="color: #0a0;">'labels'</span><span style="color: #000;">&#93;</span>
labels<span style="color: #000;">&#91;</span>op.<span style="color: #000;">attrib_key</span><span style="color: #000;">&#40;</span><span style="color: #0a0;">'Use'</span><span style="color: #000;">&#41;</span><span style="color: #000;">&#93;</span> <span style="color: #000;">=</span> <span style="color: #0a0;">'1'</span>
labels<span style="color: #000;">&#91;</span><span style="color: #0a0;">'longname'</span><span style="color: #000;">&#93;</span> <span style="color: #000;">=</span> <span style="color: #000;">1</span>
labels<span style="color: #000;">&#91;</span><span style="color: #0a0;">'unit'</span><span style="color: #000;">&#93;</span> <span style="color: #000;">=</span> <span style="color: #000;">2</span>

<span style="color: #d00; font-style: italic;">#Setting for partial import</span>
partial <span style="color: #000;">=</span> ss<span style="color: #000;">&#91;</span><span style="color: #0a0;">'partial'</span><span style="color: #000;">&#93;</span>
partial<span style="color: #000;">&#91;</span>op.<span style="color: #000;">attrib_key</span><span style="color: #000;">&#40;</span><span style="color: #0a0;">'Use'</span><span style="color: #000;">&#41;</span><span style="color: #000;">&#93;</span> <span style="color: #000;">=</span> <span style="color: #0a0;">'1'</span>
partial<span style="color: #000;">&#91;</span><span style="color: #0a0;">'col'</span><span style="color: #000;">&#93;</span> <span style="color: #000;">=</span> <span style="color: #0a0;">'1:3'</span>
partial<span style="color: #000;">&#91;</span><span style="color: #0a0;">'row'</span><span style="color: #000;">&#93;</span> <span style="color: #000;">=</span> <span style="color: #0a0;">'1:99'</span>

<span style="color: #d00; font-style: italic;">#Import the second spreadsheet 'expt2'</span>
dc.<span style="color: #000;">imp</span><span style="color: #000;">&#40;</span>f<span style="color: #000;">,</span> sel<span style="color: #000;">=</span><span style="color: #0a0;">'expt2'</span><span style="color: #000;">&#41;</span></pre>
<h2><a name="Import_HTML_Table_from_the_Web"></a><span class="mw-headline">Import HTML Table from the Web</span></h2>
<pre class="python" style="font-family:monospace;"><span style="color: #0a0;">'''
Despite the name, from_file can actually import from the web
This example shows using the HTML connector to import a specific table 
from a wikipedia web page
'''</span>
<span style="color: #ff7700;font-weight:bold;">import</span> originpro <span style="color: #ff7700;font-weight:bold;">as</span> op
fn <span style="color: #000;">=</span> <span style="color: #0a0;">'https://en.wikipedia.org/wiki/World_population'</span>
wks<span style="color: #000;">=</span>op.<span style="color: #000;">new_sheet</span><span style="color: #000;">&#40;</span><span style="color: #000;">&#41;</span>
wks.<span style="color: #000;">from_file</span><span style="color: #000;">&#40;</span>fn<span style="color: #000;">,</span> <span style="color: #900090;">True</span><span style="color: #000;">,</span> <span style="color: #0a0;">'HTML'</span><span style="color: #000;">,</span> <span style="color: #0a0;">'Tables/_6'</span><span style="color: #000;">&#41;</span></pre>
<h2><a name="Import_MATLAB"></a><span class="mw-headline">Import MATLAB</span></h2>
<pre class="python" style="font-family:monospace;"><span style="color: #0a0;">'''
This sample shows how to import MATLAB file.
You can try different selection by using GUI
'''</span>

<span style="color: #ff7700;font-weight:bold;">import</span> originpro <span style="color: #ff7700;font-weight:bold;">as</span> op
fn <span style="color: #000;">=</span> op.<span style="color: #000;">path</span><span style="color: #000;">&#40;</span><span style="color: #0a0;">'e'</span><span style="color: #000;">&#41;</span>+r<span style="color: #0a0;">'Samples<span style="color: #000099; font-weight: bold;">\I</span>mport and Export<span style="color: #000099; font-weight: bold;">\G</span>aussianData.mat'</span>
wks<span style="color: #000;">=</span>op.<span style="color: #000;">new_sheet</span><span style="color: #000;">&#40;</span><span style="color: #000;">&#41;</span>

wks.<span style="color: #000;">from_file</span><span style="color: #000;">&#40;</span>fn<span style="color: #000;">,</span> <span style="color: #900090;">True</span><span style="color: #000;">,</span> <span style="color: #0a0;">'MATLAB'</span><span style="color: #000;">,</span> <span style="color: #0a0;">'MATLAB/Data'</span><span style="color: #000;">&#41;</span></pre>
<h2><a name="Import_Multiple_Files_using_Pandas_into_One_Worksheet"></a><span class="mw-headline">Import Multiple Files using Pandas into One Worksheet</span></h2>
<pre class="python" style="font-family:monospace;"><span style="color: #0a0;">&quot;&quot;&quot;
This shows import text files using DataFrame instead of Origin's internal import
&quot;&quot;&quot;</span>
<span style="color: #ff7700;font-weight:bold;">import</span> originpro <span style="color: #ff7700;font-weight:bold;">as</span> op
<span style="color: #ff7700;font-weight:bold;">import</span> pandas <span style="color: #ff7700;font-weight:bold;">as</span> pd
<span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #000;">os</span>
fd <span style="color: #000;">=</span> op.<span style="color: #000;">path</span><span style="color: #000;">&#40;</span><span style="color: #0a0;">'e'</span><span style="color: #000;">&#41;</span> + r<span style="color: #0a0;">'Samples<span style="color: #000099; font-weight: bold;">\B</span>atch2'</span>
wks <span style="color: #000;">=</span> op.<span style="color: #000;">new_sheet</span><span style="color: #000;">&#40;</span><span style="color: #000;">&#41;</span>
col <span style="color: #000;">=</span> <span style="color: #000;">0</span>
<span style="color: #ff7700;font-weight:bold;">for</span> <span style="color: #900090;">file</span> <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: #000;">os</span>.<span style="color: #000;">listdir</span><span style="color: #000;">&#40;</span>fd<span style="color: #000;">&#41;</span>:
    df <span style="color: #000;">=</span> pd.<span style="color: #000;">read_table</span><span style="color: #000;">&#40;</span><span style="color: #000;">os</span>.<span style="color: #000;">path</span>.<span style="color: #000;">join</span><span style="color: #000;">&#40;</span>fd<span style="color: #000;">,</span> <span style="color: #900090;">file</span><span style="color: #000;">&#41;</span><span style="color: #000;">,</span> header<span style="color: #000;">=</span><span style="color: #000;">&#91;</span><span style="color: #000;">0</span><span style="color: #000;">,</span><span style="color: #000;">1</span><span style="color: #000;">,</span><span style="color: #000;">2</span><span style="color: #000;">&#93;</span><span style="color: #000;">&#41;</span>    
    wks.<span style="color: #000;">from_df</span><span style="color: #000;">&#40;</span>df<span style="color: #000;">,</span> col<span style="color: #000;">&#41;</span>
    wks.<span style="color: #000;">cols_axis</span><span style="color: #000;">&#40;</span><span style="color: #0a0;">'xy'</span><span style="color: #000;">,</span> col<span style="color: #000;">&#41;</span>
    wks.<span style="color: #000;">set_labels</span><span style="color: #000;">&#40;</span>df.<span style="color: #000;">columns</span>.<span style="color: #000;">get_level_values</span><span style="color: #000;">&#40;</span><span style="color: #000;">0</span><span style="color: #000;">&#41;</span><span style="color: #000;">,</span> <span style="color: #0a0;">'L'</span><span style="color: #000;">,</span> col<span style="color: #000;">&#41;</span>
    wks.<span style="color: #000;">set_labels</span><span style="color: #000;">&#40;</span>df.<span style="color: #000;">columns</span>.<span style="color: #000;">get_level_values</span><span style="color: #000;">&#40;</span><span style="color: #000;">1</span><span style="color: #000;">&#41;</span><span style="color: #000;">,</span> <span style="color: #0a0;">'U'</span><span style="color: #000;">,</span> col<span style="color: #000;">&#41;</span>
    <span style="color: #d00; font-style: italic;">#the sample data file has no comment for X column, so we need to remove the 'Unnamed: 0_level_2'</span>
    comments <span style="color: #000;">=</span> df.<span style="color: #000;">columns</span>.<span style="color: #000;">get_level_values</span><span style="color: #000;">&#40;</span><span style="color: #000;">2</span><span style="color: #000;">&#41;</span>.<span style="color: #000;">tolist</span><span style="color: #000;">&#40;</span><span style="color: #000;">&#41;</span>
    comments<span style="color: #000;">&#91;</span><span style="color: #000;">0</span><span style="color: #000;">&#93;</span> <span style="color: #000;">=</span> <span style="color: #0a0;">&quot;&quot;</span>
    wks.<span style="color: #000;">set_labels</span><span style="color: #000;">&#40;</span>comments<span style="color: #000;">,</span> <span style="color: #0a0;">'C'</span><span style="color: #000;">,</span> col<span style="color: #000;">&#41;</span>
    col <span style="color: #000;">=</span> wks.<span style="color: #000;">cols</span></pre>
<h2><a name="Import_Two_Excel_Sheets"></a><span class="mw-headline">Import Two Excel Sheets</span></h2>
<pre class="python" style="font-family:monospace;"><span style="color: #0a0;">'''
This example shows how to import a second sheet from an Exel file with multiple sheets.
'''</span>
<span style="color: #ff7700;font-weight:bold;">import</span> originpro <span style="color: #ff7700;font-weight:bold;">as</span> op

f <span style="color: #000;">=</span> op.<span style="color: #000;">path</span><span style="color: #000;">&#40;</span><span style="color: #0a0;">'e'</span><span style="color: #000;">&#41;</span>+r<span style="color: #0a0;">'Samples<span style="color: #000099; font-weight: bold;">\I</span>mport and Export<span style="color: #000099; font-weight: bold;">\U</span>nited States Energy (1980-2013).xls'</span>
wks <span style="color: #000;">=</span> op.<span style="color: #000;">new_sheet</span><span style="color: #000;">&#40;</span><span style="color: #000;">&#41;</span>

<span style="color: #d00; font-style: italic;">#Create data connector object</span>
dc <span style="color: #000;">=</span> op.<span style="color: #000;">Connector</span><span style="color: #000;">&#40;</span>wks<span style="color: #000;">,</span> dctype<span style="color: #000;">=</span><span style="color: #0a0;">'Excel'</span><span style="color: #000;">,</span> keep_DC<span style="color: #000;">=</span><span style="color: #900090;">False</span><span style="color: #000;">&#41;</span>

ss <span style="color: #000;">=</span> dc.<span style="color: #000;">settings</span><span style="color: #000;">&#40;</span><span style="color: #000;">&#41;</span>
<span style="color: #d00; font-style: italic;">#1st two rows are header, followed by column name and units</span>
ss<span style="color: #000;">&#91;</span><span style="color: #0a0;">'mainheader'</span><span style="color: #000;">&#93;</span><span style="color: #000;">=</span><span style="color: #000;">2</span><span style="color: #000;">;</span>
labels <span style="color: #000;">=</span> ss<span style="color: #000;">&#91;</span><span style="color: #0a0;">'labels'</span><span style="color: #000;">&#93;</span>
<span style="color: #d00; font-style: italic;">#labels branch use an attrtibute to turn on, so from a dict, </span>
<span style="color: #d00; font-style: italic;">#special node is needed to set internal tree attribute</span>
labels<span style="color: #000;">&#91;</span>op.<span style="color: #000;">attrib_key</span><span style="color: #000;">&#40;</span><span style="color: #0a0;">'Use'</span><span style="color: #000;">&#41;</span><span style="color: #000;">&#93;</span> <span style="color: #000;">=</span> <span style="color: #0a0;">'1'</span>
labels<span style="color: #000;">&#91;</span><span style="color: #0a0;">'longname'</span><span style="color: #000;">&#93;</span> <span style="color: #000;">=</span> <span style="color: #000;">1</span>
labels<span style="color: #000;">&#91;</span><span style="color: #0a0;">'unit'</span><span style="color: #000;">&#93;</span> <span style="color: #000;">=</span> <span style="color: #000;">2</span>

<span style="color: #d00; font-style: italic;">#Import the first sheet, which is &quot;oil&quot;</span>
dc.<span style="color: #000;">imp</span><span style="color: #000;">&#40;</span>f<span style="color: #000;">,</span> sel<span style="color: #000;">=</span><span style="color: #0a0;">'Oil'</span><span style="color: #000;">&#41;</span>

<span style="color: #d00; font-style: italic;">#Import a new Excel sheet as a new Origin sheet</span>
dc.<span style="color: #000;">new_sheet</span><span style="color: #000;">&#40;</span><span style="color: #0a0;">'Natural Gas'</span><span style="color: #000;">&#41;</span></pre>
<h2><a name="Import_Using_a_Filter"></a><span class="mw-headline">Import Using a Filter</span></h2>
<pre class="python" style="font-family:monospace;"><span style="color: #0a0;">'''
This example shows how to use a filter created from Import Wizard
'''</span>
<span style="color: #ff7700;font-weight:bold;">import</span> originpro <span style="color: #ff7700;font-weight:bold;">as</span> op

fn <span style="color: #000;">=</span> op.<span style="color: #000;">path</span><span style="color: #000;">&#40;</span><span style="color: #0a0;">'e'</span><span style="color: #000;">&#41;</span>+r<span style="color: #0a0;">'Samples<span style="color: #000099; font-weight: bold;">\I</span>mport and Export<span style="color: #000099; font-weight: bold;">\S</span>15-125-03.dat'</span>
wks<span style="color: #000;">=</span>op.<span style="color: #000;">new_sheet</span><span style="color: #000;">&#40;</span><span style="color: #000;">&#41;</span>
<span style="color: #d00; font-style: italic;">#use a filter in the same folder as the data file</span>
wks.<span style="color: #000;">from_file</span><span style="color: #000;">&#40;</span>fn<span style="color: #000;">,</span> <span style="color: #900090;">False</span><span style="color: #000;">,</span> <span style="color: #0a0;">'Import Filter'</span><span style="color: #000;">,</span><span style="color: #0a0;">'.<span style="color: #000099; font-weight: bold;">\V</span>arsFromFileNameAndHeader.oif'</span><span style="color: #000;">&#41;</span></pre>
<h2><a name="Import_by_Setting_File_Header_Info"></a><span class="mw-headline">Import by Setting File Header Info</span></h2>
<pre class="python" style="font-family:monospace;"><span style="color: #0a0;">'''
This example shows how to control file header. Typically the CSV connector can automatically
detect main header and column header info, but sometimes the automatic detection does not work
for certain file so you need to specify it yourself.
'''</span>
<span style="color: #ff7700;font-weight:bold;">import</span> originpro <span style="color: #ff7700;font-weight:bold;">as</span> op

wks <span style="color: #000;">=</span> op.<span style="color: #000;">new_sheet</span><span style="color: #000;">&#40;</span><span style="color: #000;">&#41;</span>
dc <span style="color: #000;">=</span> op.<span style="color: #000;">Connector</span><span style="color: #000;">&#40;</span>wks<span style="color: #000;">&#41;</span>
dc.<span style="color: #000;">source</span> <span style="color: #000;">=</span> op.<span style="color: #000;">path</span><span style="color: #000;">&#40;</span><span style="color: #0a0;">'e'</span><span style="color: #000;">&#41;</span>+r<span style="color: #0a0;">'Samples<span style="color: #000099; font-weight: bold;">\I</span>mport and Export<span style="color: #000099; font-weight: bold;">\F</span>1.dat'</span>
ss <span style="color: #000;">=</span> dc.<span style="color: #000;">settings</span><span style="color: #000;">&#40;</span><span style="color: #000;">&#41;</span>
ss<span style="color: #000;">&#91;</span><span style="color: #0a0;">'mainheader'</span><span style="color: #000;">&#93;</span><span style="color: #000;">=</span><span style="color: #000;">5</span>
ss<span style="color: #000;">&#91;</span><span style="color: #0a0;">'heading'</span><span style="color: #000;">&#93;</span><span style="color: #000;">=</span><span style="color: #000;">1</span>
ss<span style="color: #000;">&#91;</span><span style="color: #0a0;">'unit'</span><span style="color: #000;">&#93;</span><span style="color: #000;">=</span><span style="color: #000;">2</span>
<span style="color: #d00; font-style: italic;">#must not pass in filepath if you are controlling file header</span>
<span style="color: #d00; font-style: italic;">#if file is passed in, the auto detection code will kick in to wipe out the settings above</span>
dc.<span style="color: #000;">imp</span><span style="color: #000;">&#40;</span><span style="color: #000;">&#41;</span></pre>
<h2><a name="Manipulate_Columns_and_Make_Group_Plot"></a><span class="mw-headline">Manipulate Columns and Make Group Plot</span></h2>
<pre class="python" style="font-family:monospace;"><span style="color: #0a0;">'''
This sample shows how to prepare worksheet for plotting. 
'''</span>
<span style="color: #ff7700;font-weight:bold;">import</span> originpro <span style="color: #ff7700;font-weight:bold;">as</span> op

<span style="color: #d00; font-style: italic;">#Import Data File</span>
f <span style="color: #000;">=</span> op.<span style="color: #000;">path</span><span style="color: #000;">&#40;</span><span style="color: #0a0;">'e'</span><span style="color: #000;">&#41;</span>+r<span style="color: #0a0;">'Samples<span style="color: #000099; font-weight: bold;">\S</span>ignal Processing<span style="color: #000099; font-weight: bold;">\S</span>unspot.dat'</span>
wks <span style="color: #000;">=</span> op.<span style="color: #000;">new_sheet</span><span style="color: #000;">&#40;</span><span style="color: #000;">&#41;</span>
wks.<span style="color: #000;">from_file</span><span style="color: #000;">&#40;</span>f<span style="color: #000;">,</span> keep_DC<span style="color: #000;">=</span><span style="color: #900090;">False</span><span style="color: #000;">&#41;</span>

<span style="color: #d00; font-style: italic;">#Set worksheet property</span>
wks.<span style="color: #000;">cols</span><span style="color: #000;">=</span><span style="color: #000;">5</span>
wks.<span style="color: #000;">move_cols</span><span style="color: #000;">&#40;</span><span style="color: #000;">1</span><span style="color: #000;">,</span><span style="color: #000;">2</span><span style="color: #000;">,</span><span style="color: #000;">1</span><span style="color: #000;">&#41;</span> <span style="color: #d00; font-style: italic;">#Insert a date column</span>
wks.<span style="color: #000;">cols_axis</span><span style="color: #000;">&#40;</span><span style="color: #0a0;">'xyy'</span><span style="color: #000;">,</span><span style="color: #000;">2</span><span style="color: #000;">,</span><span style="color: #000;">4</span><span style="color: #000;">&#41;</span> <span style="color: #d00; font-style: italic;">#Set column designation</span>

<span style="color: #d00; font-style: italic;">#Set &quot;Date&quot; column property</span>
ncol<span style="color: #000;">=</span><span style="color: #000;">2</span>
wks.<span style="color: #000;">set_formula</span><span style="color: #000;">&#40;</span>ncol<span style="color: #000;">,</span><span style="color: #0a0;">'date(B$ + &quot;/1/&quot; + A$)'</span><span style="color: #000;">&#41;</span>
wks.<span style="color: #000;">set_label</span><span style="color: #000;">&#40;</span>ncol<span style="color: #000;">,</span> <span style="color: #0a0;">'Date'</span><span style="color: #000;">&#41;</span>
wks.<span style="color: #000;">as_date</span><span style="color: #000;">&#40;</span>ncol<span style="color: #000;">,</span><span style="color: #0a0;">&quot;yyyy/MM&quot;</span><span style="color: #000;">&#41;</span>

<span style="color: #d00; font-style: italic;">#Set &quot;Averaged Sunspot Number&quot; column property</span>
ncol<span style="color: #000;">=</span><span style="color: #000;">4</span>
wks.<span style="color: #000;">set_formula</span><span style="color: #000;">&#40;</span>ncol<span style="color: #000;">,</span><span style="color: #0a0;">'movavg(D,20,20)'</span><span style="color: #000;">&#41;</span>
wks.<span style="color: #000;">set_label</span><span style="color: #000;">&#40;</span>ncol<span style="color: #000;">,</span> <span style="color: #0a0;">'Averaged Sunspot Number'</span><span style="color: #000;">&#41;</span>

<span style="color: #d00; font-style: italic;">#Plot &quot;Sunspot Number&quot; vs &quot;Date&quot;</span>
gp <span style="color: #000;">=</span> op.<span style="color: #000;">new_graph</span><span style="color: #000;">&#40;</span><span style="color: #000;">&#41;</span>
gp<span style="color: #000;">&#91;</span><span style="color: #000;">0</span><span style="color: #000;">&#93;</span>.<span style="color: #000;">add_plot</span><span style="color: #000;">&#40;</span>f<span style="color: #0a0;">'{wks.lt_range()}!(3,4:5)'</span><span style="color: #000;">&#41;</span>  <span style="color: #d00; font-style: italic;"># Plot using data range</span>
gp<span style="color: #000;">&#91;</span><span style="color: #000;">0</span><span style="color: #000;">&#93;</span>.<span style="color: #000;">group</span><span style="color: #000;">&#40;</span><span style="color: #000;">&#41;</span>
gp<span style="color: #000;">&#91;</span><span style="color: #000;">0</span><span style="color: #000;">&#93;</span>.<span style="color: #000;">rescale</span><span style="color: #000;">&#40;</span><span style="color: #000;">&#41;</span></pre>
<h2><a name="Split_Dataset_to_Training_and_Testing_Data"></a><span class="mw-headline">Split Dataset to Training and Testing Data</span></h2>
<pre class="python" style="font-family:monospace;"><span style="color: #0a0;">'''
This example splits a dataset with multiple columns to two datasets named Train and Test, 
using the package sklearn. To check for and install if needed, 
open the Script Window (Shift+Alt+3), type the following and press Enter.
 pip -chk pandas sklearn
'''</span>
<span style="color: #ff7700;font-weight:bold;">import</span> numpy <span style="color: #ff7700;font-weight:bold;">as</span> np
<span style="color: #ff7700;font-weight:bold;">import</span> pandas <span style="color: #ff7700;font-weight:bold;">as</span> pd
<span style="color: #ff7700;font-weight:bold;">import</span> originpro <span style="color: #ff7700;font-weight:bold;">as</span> op
<span style="color: #ff7700;font-weight:bold;">from</span> sklearn.<span style="color: #000;">model_selection</span> <span style="color: #ff7700;font-weight:bold;">import</span> train_test_split

<span style="color: #d00; font-style: italic;"># Import data and get the independent and dependent data to X and y respectively</span>
ws<span style="color: #000;">=</span>op.<span style="color: #000;">new_sheet</span><span style="color: #000;">&#40;</span><span style="color: #000;">&#41;</span>
ws.<span style="color: #000;">from_file</span><span style="color: #000;">&#40;</span>fname<span style="color: #000;">=</span>op.<span style="color: #000;">path</span><span style="color: #000;">&#40;</span><span style="color: #0a0;">'e'</span><span style="color: #000;">&#41;</span>+r<span style="color: #0a0;">&quot;Samples<span style="color: #000099; font-weight: bold;">\S</span>tatistics<span style="color: #000099; font-weight: bold;">\F</span>isher's Iris Data.dat&quot;</span><span style="color: #000;">,</span> keep_DC<span style="color: #000;">=</span><span style="color: #900090;">False</span><span style="color: #000;">&#41;</span>

<span style="color: #d00; font-style: italic;"># Get first 4 columns as X</span>
X <span style="color: #000;">=</span> ws.<span style="color: #000;">to_df</span><span style="color: #000;">&#40;</span>c1<span style="color: #000;">=</span><span style="color: #000;">0</span><span style="color: #000;">,</span> numcols<span style="color: #000;">=</span><span style="color: #000;">4</span><span style="color: #000;">&#41;</span>  

<span style="color: #d00; font-style: italic;"># Get the last column as y</span>
y <span style="color: #000;">=</span> ws.<span style="color: #000;">to_df</span><span style="color: #000;">&#40;</span>c1<span style="color: #000;">=</span><span style="color: #000;">4</span><span style="color: #000;">,</span> numcols<span style="color: #000;">=</span><span style="color: #000;">1</span><span style="color: #000;">&#41;</span>  

<span style="color: #d00; font-style: italic;"># Split the dataset into train and test datasets</span>
<span style="color: #d00; font-style: italic;"># train dataset contains 70% samples, and test dataset contains 30% samples</span>
<span style="color: #d00; font-style: italic;"># shuffle the data before splitting</span>
X_train<span style="color: #000;">,</span> X_test<span style="color: #000;">,</span> y_train<span style="color: #000;">,</span> y_test <span style="color: #000;">=</span> train_test_split<span style="color: #000;">&#40;</span>X<span style="color: #000;">,</span> y<span style="color: #000;">,</span> test_size<span style="color: #000;">=</span><span style="color: #000;">0.3</span><span style="color: #000;">,</span> shuffle<span style="color: #000;">=</span><span style="color: #900090;">True</span><span style="color: #000;">,</span> random_state<span style="color: #000;">=</span><span style="color: #000;">1</span><span style="color: #000;">&#41;</span>

<span style="color: #d00; font-style: italic;"># Create worksheet for the splitted datasets</span>
wks <span style="color: #000;">=</span> op.<span style="color: #000;">new_sheet</span><span style="color: #000;">&#40;</span><span style="color: #0a0;">'w'</span><span style="color: #000;">,</span> <span style="color: #0a0;">'Split'</span><span style="color: #000;">&#41;</span>
Num <span style="color: #000;">=</span> X_train.<span style="color: #000;">columns</span>.<span style="color: #000;">shape</span><span style="color: #000;">&#91;</span><span style="color: #000;">0</span><span style="color: #000;">&#93;</span>
wks.<span style="color: #000;">from_list</span><span style="color: #000;">&#40;</span>Num<span style="color: #000;">,</span> y_train.<span style="color: #000;">iloc</span><span style="color: #000;">&#91;</span>:<span style="color: #000;">,</span> <span style="color: #000;">0</span><span style="color: #000;">&#93;</span>.<span style="color: #000;">tolist</span><span style="color: #000;">&#40;</span><span style="color: #000;">&#41;</span><span style="color: #000;">,</span> comments<span style="color: #000;">=</span><span style="color: #0a0;">'Train'</span><span style="color: #000;">,</span> lname<span style="color: #000;">=</span>y_train.<span style="color: #000;">columns</span><span style="color: #000;">&#91;</span><span style="color: #000;">0</span><span style="color: #000;">&#93;</span><span style="color: #000;">&#41;</span>
wks.<span style="color: #000;">from_list</span><span style="color: #000;">&#40;</span>Num*<span style="color: #000;">2</span>+<span style="color: #000;">1</span><span style="color: #000;">,</span> y_test.<span style="color: #000;">iloc</span><span style="color: #000;">&#91;</span>:<span style="color: #000;">,</span> <span style="color: #000;">0</span><span style="color: #000;">&#93;</span>.<span style="color: #000;">tolist</span><span style="color: #000;">&#40;</span><span style="color: #000;">&#41;</span><span style="color: #000;">,</span> comments<span style="color: #000;">=</span><span style="color: #0a0;">'Test'</span><span style="color: #000;">,</span> lname<span style="color: #000;">=</span>y_train.<span style="color: #000;">columns</span><span style="color: #000;">&#91;</span><span style="color: #000;">0</span><span style="color: #000;">&#93;</span><span style="color: #000;">&#41;</span>
<span style="color: #ff7700;font-weight:bold;">for</span> idx <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: #900090;">range</span><span style="color: #000;">&#40;</span>Num<span style="color: #000;">&#41;</span>:
    wks.<span style="color: #000;">from_list</span><span style="color: #000;">&#40;</span>idx<span style="color: #000;">,</span> X_train.<span style="color: #000;">iloc</span><span style="color: #000;">&#91;</span>:<span style="color: #000;">,</span> idx<span style="color: #000;">&#93;</span>.<span style="color: #000;">tolist</span><span style="color: #000;">&#40;</span><span style="color: #000;">&#41;</span><span style="color: #000;">,</span> comments<span style="color: #000;">=</span><span style="color: #0a0;">'Train'</span><span style="color: #000;">,</span> lname<span style="color: #000;">=</span>X_train.<span style="color: #000;">columns</span><span style="color: #000;">&#91;</span>idx<span style="color: #000;">&#93;</span><span style="color: #000;">&#41;</span>
    wks.<span style="color: #000;">from_list</span><span style="color: #000;">&#40;</span>Num+<span style="color: #000;">1</span>+idx<span style="color: #000;">,</span> X_test.<span style="color: #000;">iloc</span><span style="color: #000;">&#91;</span>:<span style="color: #000;">,</span> idx<span style="color: #000;">&#93;</span>.<span style="color: #000;">tolist</span><span style="color: #000;">&#40;</span><span style="color: #000;">&#41;</span><span style="color: #000;">,</span> comments<span style="color: #000;">=</span><span style="color: #0a0;">'Test'</span><span style="color: #000;">,</span> lname<span style="color: #000;">=</span>X_train.<span style="color: #000;">columns</span><span style="color: #000;">&#91;</span>idx<span style="color: #000;">&#93;</span><span style="color: #000;">&#41;</span></pre>






