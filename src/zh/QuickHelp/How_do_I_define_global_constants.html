<h1 class="firstHeading">4.1 FAQ-286 如何定义全局函数，全局变量和常量？</h1><p class='urlname' style='display: none'>Global-Constants</p>
<p class='faqID'>Last Update: 4/22/2021</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#.E5.8F.AF.E7.94.A8.E4.BA.8E_Origin_.E4.B8.8D.E5.90.8C.E8.BF.9B.E7.A8.8B.E4.B8.AD.E7.9A.84.E5.85.A8.E5.B1.80.E5.87.BD.E6.95.B0"><span class="tocnumber">1</span> <span class="toctext">可用于 Origin 不同进程中的全局函数</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#.E5.8F.AF.E7.94.A8.E4.BA.8E_Origin_.E4.B8.8D.E5.90.8C.E8.BF.9B.E7.A8.8B.E4.B8.AD.E7.9A.84.E5.85.A8.E5.B1.80.E5.8F.98.E9.87.8F.E5.92.8C.E5.B8.B8.E9.87.8F"><span class="tocnumber">2</span> <span class="toctext">可用于 Origin 不同进程中的全局变量和常量</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#.E7.94.A8.E4.BA.8E.E5.BD.93.E5.89.8D_Origin_.E8.BF.9B.E7.A8.8B.E4.B8.AD.E7.9A.84.E5.B8.B8.E9.87.8F.E5.92.8C.E5.8F.98.E9.87.8F"><span class="tocnumber">3</span> <span class="toctext">用于当前 Origin 进程中的常量和变量</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#.E7.94.A8.E4.BA.8E.E7.89.B9.E5.AE.9A.E7.9A.84_Origin_.E9.A1.B9.E7.9B.AE.E6.96.87.E4.BB.B6.E4.B8.AD.E7.9A.84.E5.B8.B8.E9.87.8F.E5.92.8C.E5.8F.98.E9.87.8F"><span class="tocnumber">4</span> <span class="toctext">用于特定的 Origin 项目文件中的常量和变量</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#.E7.94.A8.E4.BA.8E.E7.89.B9.E5.AE.9A.E5.B7.A5.E4.BD.9C.E8.A1.A8.E7.9A.84.E5.8F.98.E9.87.8F"><span class="tocnumber">5</span> <span class="toctext">用于特定工作表的变量</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#.E6.8B.9F.E5.90.88.E5.87.BD.E6.95.B0.E4.B8.AD.E7.9A.84.E5.B8.B8.E9.87.8F"><span class="tocnumber">6</span> <span class="toctext">拟合函数中的常量</span></a></li>
</ul>
</div>

<h2><a name=".E5.8F.AF.E7.94.A8.E4.BA.8E_Origin_.E4.B8.8D.E5.90.8C.E8.BF.9B.E7.A8.8B.E4.B8.AD.E7.9A.84.E5.85.A8.E5.B1.80.E5.87.BD.E6.95.B0"></a><span class="mw-headline">可用于 Origin 不同进程中的全局函数</span></h2>
<p>如果想定义一个可用于 Origin 不同进程中的全局函数，请参考<a class="external text" href="http://www.originlab.com/doc/LabTalk/guide/On-Starting-Origin#Defining_a_global_function" target="_blank">此页</a>.
</p><p>有关函数使用范围的更多信息，请参考<a class="external text" href="http://www.originlab.com/doc/LabTalk/guide/Functions#Scope_of_Functionsscope_of_a_function" target="_blank">此页</a>。
</p>
<h2><a name=".E5.8F.AF.E7.94.A8.E4.BA.8E_Origin_.E4.B8.8D.E5.90.8C.E8.BF.9B.E7.A8.8B.E4.B8.AD.E7.9A.84.E5.85.A8.E5.B1.80.E5.8F.98.E9.87.8F.E5.92.8C.E5.B8.B8.E9.87.8F"></a><span class="mw-headline">可用于 Origin 不同进程中的全局变量和常量</span></h2>
<p>启动Origin时，将读取用户文件文件夹中名为CONST.CNF的文本文件。 如果您有经常在工作中使用的数学常数，则CONST.CNF文件是定义它们的好地方，因为它们在Origin运行时将始终可用。
</p>
<ol>
<li>如果 Origin 正在运行，请退出程序。</li>
<li>在文本编辑器（例如 Notepad）中，打开User Files Folder (UFF)中的CONST.CNF 或者 启动新页面并输入以下信息：</li>
<pre class="lt" style="font-family:monospace;">const e <span style="color: #000080;">=</span> <span style="color: #0000dd;">2.718281828459045</span> <span style="color: #008000;">//Euler's number</span></pre>
<li>命名文件为CONST.CNF，保存到你的 <a href="../../QuickHelp/QuickHelp/What_is_the_User_Files_Folder.html" title="QuickHelp:What is the User Files Folder">User Files Folder (UFF)</a> 中。
<li> 如要检查常量和变量值，运行 Origin，打开 Script Window 并输入常量或变量的名称，再输入 "=" ，然后按 ENTER 键。
</ol>
<h2><a name=".E7.94.A8.E4.BA.8E.E5.BD.93.E5.89.8D_Origin_.E8.BF.9B.E7.A8.8B.E4.B8.AD.E7.9A.84.E5.B8.B8.E9.87.8F.E5.92.8C.E5.8F.98.E9.87.8F"></a><span class="mw-headline">用于当前 Origin 进程中的常量和变量</span></h2>
<p>如果想定义用于当前 Origin 进程中的常量和变量，你只需在 Script Window 中定义它们：
</p>
<ol>
<li>
选择菜单 <b>Window: Script Window</b>，打开 Script Window。
</li>
<li>
输入要定义的常量或变量赋值，然后在每行末尾按 <b>Enter</b> 键，例如：
<pre class="lt" style="font-family:monospace;">const myconst <span style="color: #000080;">=</span> <span style="color: #0000dd;">1.234</span>;
double myvar <span style="color: #000080;">=</span> <span style="color: #0000dd;">12.34</span>;
int mynum <span style="color: #000080;">=</span> <span style="color: #0000dd;">127</span>;</pre>
</li>
</ol>
<p>然后，在 Script Window 中任何的后续计算，或者在任何可以执行脚本的地方中，例如 <b>Set Column Values</b> 对话框，都可以访问这些常量和变量。
</p>
<h2><a name=".E7.94.A8.E4.BA.8E.E7.89.B9.E5.AE.9A.E7.9A.84_Origin_.E9.A1.B9.E7.9B.AE.E6.96.87.E4.BB.B6.E4.B8.AD.E7.9A.84.E5.B8.B8.E9.87.8F.E5.92.8C.E5.8F.98.E9.87.8F"></a><span class="mw-headline">用于特定的 Origin 项目文件中的常量和变量</span></h2>
<p>如果想定义用于特定的 Origin 项目文件中的常量和变量，你可以在附加到项目的 <b>ProjectEvents.OGS</b> 文件中定义它们：
</p>
<ol><li> 选择菜单 <b>View: Code Builder</b>，打开 <b>Code Builder</b>。并在左边的面板中，展开 <b>Project</b>，双击打开 <b>ProjectEvents.ogs</b>。</li>
<li> 在  <b>AfterOpenDoc</b> 部分，添加以下代码，然后保存文件，并保存项目文件。
<ul><li> @global=1;</li>
<li> 定义变量和常量</li></ul></li></ol>
<p><br />
这些常量和变量将是仅在当前项目可用的局部定义。
</p><p>以下简易教程介绍了如何在 Origin 项目级别添加用户定义的变量，并使用该变量。
</p>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_do_I_define_global_constants/Tutorial_icon.png?v=0" width="57"  border="0" />
	</td>
	<td><ol>
<li> 新建一个项目文件，选择菜单 <b>View: Code Builder</b>，打开 <b>Code Builder</b>。</li>
<li> 在左边的面板中，展开 <b>Project</b>，双击打开 <b>ProjectEvents.ogs</b>。默认情况下，此文件存在于任何新项目中。 </li>
<li> 在 <b>[AfterOpenDoc]</b> 部分下, 添加以下代码行:
<pre class="lt" style="font-family:monospace;">@global<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
double myconst <span style="color: #000080;">=</span> <span style="color: #0000dd;">20</span>;</pre> </li>
<li> 保存文件并关闭 Code Builder.</li>
<li> 在 Origin 中，将项目文件保存到所需的文件夹位置 .OGS 文件随项目文件一起保存，因此用户定义的变量可在此项目中使用。</li>
<li> 再次打开刚刚保存的项目。 这将触发执行 <b>[AfterOpenDoc]</b> 部分, 因而定义 myconst。</li>
<li> 点击选中工作表，并导入文件 Samples\Signal Processing\fftfilter1.DAT. </li>
<li> 在工作表中再添加一个新列。</li>
<li> 单击选中第3列的标题，然后单击右键，并选择 <b>Set Column Values...</b>。</li>
<li> 在打开的 <b>Set Values</b> 对话框中, 在编辑框中输入以下内容: <br />wcol(2)*myconst </li>
<li> 此时再次保存项目，再将其重新打开。在 Origin 菜单中选择 <b>Window: Script Window</b> </li>
<li> 在 <b>Script Window</b> 输入以下脚本，按 Enter 键以更改 myconst 的值，并触发重新计算。 
<pre class="lt" style="font-family:monospace;">myconst <span style="color: #000080;">=</span> <span style="color: #0000dd;">30</span>;; <span style="color: #008000;">//changes myconst value in this session only. Not saved in project</span>
run <span style="color: #000080;">-</span>auf <span style="color: #0000dd;">2</span> <span style="color: #0000dd;">1</span>; <span style="color: #008000;">//trigger recalculation</span></pre> </li>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_do_I_define_global_constants/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>有关 <i>run -auf</i> 命令更多的细节，请参考<a class="external text" href="../../LabTalk/LabTalk/Run_(command).html#-auf.3B_Trigger_all_recalculation">此页</a>
</p></td></tr></table>
</ol>
</td></tr></table>
<h2><a name=".E7.94.A8.E4.BA.8E.E7.89.B9.E5.AE.9A.E5.B7.A5.E4.BD.9C.E8.A1.A8.E7.9A.84.E5.8F.98.E9.87.8F"></a><span class="mw-headline">用于特定工作表的变量</span></h2>
<p>如果你需要定义一些用于特定工作表的变量，并且其他列中的计算结果也会随此变量的改变而更新，请按照下列步骤：
</p>
<ol><li> 在当前工作表或新工作表中添加一些列，并将变量名称放在第一列中，将变量值放在第二列中。 这些名称纯粹是提供参考。</li>
<li> 当使用 <b>Set Values</b> 对话框计算其他列的值时，你可以使用  <b>Before Formula Script</b> 面板，通过脚本指向变量列的指定单元格，以此来定义局部变量，然后在上面板的列公式中使用这些变量。如果将重新计算模式设置为 <b>Auto</b> 或 <b>Manual</b>，那么当你改变变量值的时候，被计算值将会自动重新计算。想了解更多信息，请参考 <b>Set Values</b> 对话框的<a class="external text" href="../../UserGuide/Category/Using_Formulae_to_Set_or_Transform_Worksheet_Column_Values.html">帮助页面</a></li></ol>
<h2><a name=".E6.8B.9F.E5.90.88.E5.87.BD.E6.95.B0.E4.B8.AD.E7.9A.84.E5.B8.B8.E9.87.8F"></a><span class="mw-headline">拟合函数中的常量</span></h2>
<p>在  <b>Fitting Function Builder</b> 向导的 <b>Variables and Parameters</b> 页面中，提供了一个用于定义常量的编辑框。然后，在定义函数主体和参数的页面中的 <b>Constants</b> 选项卡下，可以指定常量值。
</p><p>想了解更多信息，请参考 <a class="external text" href="../../LabTalk/LabTalk/Data_Types_and_Variables.html#Scope_of_Variables">变量范围的介绍</a>。
</p><p><br />
</p>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>variable, define variable, constants, functions, global variable, @glob, @global, project variable, ORGSYS.CNF, Set Values, Before Formula Script, ProjectEvents.OGS, Script Window，变量，定义变量，常量，函数，全局变量，项目变量，设置值，执行公式前运行脚本，脚本窗口</span></p>


