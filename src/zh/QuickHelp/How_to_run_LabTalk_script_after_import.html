<h1 class="firstHeading">2.18 FAQ-428 导入文件之后可以运行 LabTalk 脚本吗？</h1><p class='urlname' style='display: none'>run-script-after-import</p>
<p class='faqID'>Last Update: 4/20/2021</p>
<p><br />
以下几种方法都是展示如何完成导入操作之后运行 LabTalk 脚本以对数据进行后期处理（如计算，格式化，分析，绘图）：
</p>
<ul><li> 如果您使用任一种新的<a class="external text" href="../../UserGuide/Category/Data_Connector.html">数据连接器</a>导入方式，您可以把 LabTalk 脚本直接嵌入到工作表。把 Labtalk 脚本填入<a class="external text" href="../../UserGuide/UserGuide/Script_tab_of_Worksheet_Properties.html"><b>工作表属性</b> 对话框的 <b>脚本</b> 选项卡</a>中并设置在导入后运行（<b>n导入数据</b>）。此方法适用于以任何格式导入的文件数据。对于追求最大适用性的人来说是最好不过了，因为脚本可以与模板（.otwu）、工作簿（.ogwu）或项目文件（opju）一起保存。请参考 OriginLab 的<a class="external text" href="http://blog.originlab.com/worksheet-script-after-data-connector-to-modify-data" target="_blank">博客帖子</a>获取详细信息。</li>
<li> 如果您还在使用基于 X-Function 的老旧方式导入数据（如<a class="external text" href="../../UserGuide/UserGuide/Customizing_the_ASCII_Import_Options.html">impASC</a>），对于 ASCII，CSV，SPC 或 Excel 文件的导入，您可以将 LabTalk 脚本添加到他们对应的导入对话框中 (菜单 <b>数据：从文件导入</b> 打开)，设置好后还可以保存为 <a class="external text" href="../../UserGuide/UserGuide/Dialog_Themes.html">主题 (theme)</a> 以便下次使用。</li>
<li> 大多数文件类型都可以把文件拖拉进 Origin 来导入数据，对于这种导入方式， 可以通过 <a class="external text" href="../../UserGuide/UserGuide/Introduction_to_Import_Filters_Manager.html"><b>iwfilter</b> 对话框</a> 来将脚本存到过滤器 (filter) 中。以导入 Excel 文件为例。选择菜单 <b>Preferences: Import Filter Manager...</b> 并在 <b>Filter Manager</b> 对话框的 <b>Fliter</b> 列选择 <b>Excel</b>。确认勾选 <b>Support Drag and Drop</b> 复选框。选择菜单 <b>Edit</b> 打开 <b>Import and Export: iwfilter</b> 对话框，然后在 <b>General Import Setting</b> 里的 <b>Labtalk Script after Import</b> 框中键入你的 LabTalk 脚本。单击 <b>Save As</b> 命名并保存此过滤器 (.oif file) 到 <b>&lt;Origin User File Folder&gt;\Filters</b> 文件夹中。这样设置好之后， 把 <b>Excel</b> 文件拖拉到 Origin 中时，将会出现 <b>Select Filter</b> 对话框，选择刚才保存的过滤器 (filter) 并单击 <b>OK</b>， 之前在 <b>Script after ...</b> 框里设置的 LabTalk 脚本，会在导入之后自动运行（见下方的 <b>注意 1</b>)。用这种方法保存的过滤器 (filter), 无论是通过 <b>File：Open</b> 对话框还是 <a class="external text" href="../../UserGuide/UserGuide/Batch_Processing.html">批处理</a>工具（注意批处理对话框本身具有脚本选项）都能被同样地被使用。</li>
<li> 你也可以<a class="external text" href="../../UserGuide/UserGuide/Import_Wizard_Advanced_Options_Page.html">在使用导入向导 (Import Wizard) 的时候来添加后期处理脚本</a>并把这个设置 <a class="external text" href="../../UserGuide/UserGuide/Import_Wizard_Save_Filters_Page_(All_Data_Types).html">存为过滤器 (filter)</a> 。导入向导 (<b>Import Wizard</b>) 在导入具有复杂结构的文件 <b>ASCII</b> 文件时特别有用，然后也可以在导入二进制文件或其它 "用户自定义" 文件类型时使用。</li></ul>
<p><br />
<b>注意 1</b>: 此项操作将不适用于 <b>Famos</b>, <b>MDF</b> and <b>pClamp</b> 格式的文件<br />
<b>注意 2</b>: 选择<b>iwfilter</b>对话框的 <b> General Import Setting</b> 选项卡，勾选 <b>Open XF Dialog</b> 复选框，就可以在导入数据时，打开相应的导入对话框。
</p><p><br />
</p>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>LabTalk script, Post-Processing, Import Data, Import Filter, iwfilter, Worksheet Script, Worksheet Properties, Batch Processing，LabTalk脚本，后期处理，数据导入，过滤器导入，iwfilter，工作表脚本，工作表属性，批处理</span></p>






