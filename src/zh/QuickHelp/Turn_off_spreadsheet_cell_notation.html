<h1 class="firstHeading">2.81 FAQ-849 是否可以在工作簿中关闭或有选择地控制电子表格单元格表示法的使用？</h1><p class='urlname' style='display: none'>Turn-off-spreadsheet-cell-notation</p>
<p class='faqID'>Last Update: 11/16/2023</p>
<p><br />
从 Origin 2017 版开始，软件引入了一种简洁的 <a class="external text" href="../../UserGuide/UserGuide/Column_Short_Name_Restriction.html">"电子表格单元格表示法"（SCN）</a> ，可用于 <a class="external text" href="../../UserGuide/UserGuide/Quick_Start_SetColumnValues.html">Set Column Values</a> 和 <a class="external text" href="../../UserGuide/UserGuide/Displaying_Supporting_Data_in_Worksheet_Header_Rows.html#F.28x.29.3D">F(x)=</a> 的公式计算中。这种表示方法简化了公式的编写，并且可以支持 <a class="external text" href="../../UserGuide/UserGuide/Quick_Start_SetColumnValues.html#Spreadsheet_Cell_Notation_References_to_Other_Sheets_and_Books">引用其它工作表和工作簿</a> ，但是有时候可能更加习惯于使用传统的 "col()/wcol()" 表示法。本条帮助信息总结了如何控制电子表格单元格表示法（以下简写为 SCN）在工作簿和工程中的使用。
</p>
<h2><a name=".E5.A6.82.E4.BD.95.E5.BC.80.E5.90.AF.E6.88.96.E5.85.B3.E9.97.AD.E5.8D.95.E4.B8.AA.E5.B7.A5.E4.BD.9C.E7.B0.BF.E4.B8.AD.E7.9A.84_SCN"></a><span class="mw-headline">如何开启或关闭单个工作簿中的 SCN</span></h2>
<p>自引入以来，新建的工作簿默认启用 SCN。从 <b>Origin 2017</b> 到<b>Origin 2019</b>，在工作表的左上角都会显示图标 <a  class="image"><img alt="Spreadsheet cell notation mode.png" src="../images/Turn_off_spreadsheet_cell_notation/Spreadsheet_cell_notation_mode.png?v=4940" width="20"  /></a>，表示 SCN 已启用。从 Origin <b>2019b</b> 开始，因为增添表示了其他的新功能的图标，为了简化界面，默认情况下 SCN 图标会被隐藏。但是，与以往版本一样，对于新建的工作簿，SCN 还是默认开启的。
</p><p><br />
<b>要通过用户界面关闭SCN ...</b>
</p><p>右键单击工作簿窗口的标题栏，然后选择 <a class="external text" href="../../UserGuide/UserGuide/Folder_and_Window_Properties_Dialog.html#Window_Properties_dialog"><b>属性</b></a>。在 ‘’’属性’’’ 选项卡上，清除 ‘’’电子表格单元格表示法’’’ 复选框（该选项位于对话框的中下部）。
</p><p><br />
</p><p><b>也可以通过把以下 LabTalk 脚本语言设为 0 或 1 来进行控制</b>
</p>
<pre class="lt" style="font-family:monospace;">page.<span style="color: #000080;">xlcolname</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>; <span style="color: #008000;">// 0 = off, 1 = on.</span></pre>
<h2><a name=".E4.BD.BF.E7.94.A8_.40RCN_LabTalk_.E7.B3.BB.E7.BB.9F.E5.8F.98.E9.87.8F.E6.9D.A5.E6.8E.A7.E5.88.B6_SCN"></a><span class="mw-headline">使用 @RCN LabTalk 系统变量来控制 SCN</span></h2>
<p><b>Origin 2017</b>, @RCN = <i>7</i>（默认值）：默认情况下，点击工具栏上的 ‘’’新建工作簿’’’ <a  class="image"><img alt="Button New Workbook.png" src="../images/Turn_off_spreadsheet_cell_notation/Button_New_Workbook.png?v=4941" width="23"  /></a> 按钮所创建的新工作簿，或者在文件导入时，当前的工作簿的 SCN 是开启的情况下，导入所创建新工作簿，这两种情况下的新工作簿的 SCN 是开启的。此外，由大多数基于 X-Function 的分析对话框所创建的新工作簿也将启用 SCN，无论原始数据所在的工作簿是否打开了 SCN 。
</p><p><b>Origin 2019</b>, @RCN = <i>15</i>（默认值）：除了上面 Origin 2017 所述的情况之外，Origin 2019 及更高版本还对由 <code>win -t</code> 或 <code>newbook</code> 创建的窗口开启 SCN。这种新的默认行为可能会造成某些操作无效 - 例如，您可能会发现无法使用脚本来更改列的短名称（具体参见<a href="../../QuickHelp/QuickHelp/Set_column_names_in_script_using_wksaddCol_wkscolname.html" title="QuickHelp:Set column names in script using wksaddCol wkscolname"><b>FAQ-872</b></a>）。
</p><p>因此，如果您不希望在使用<code>win -t</code> 或 <code>newbook</code> 创建新窗口时启用 SCN，则需要在 <a class="external text" href="../../UserGuide/UserGuide/Customizing_Origin_using_System_Variables.html#Changing_the_Value_of_a_System_Variable">the <b>设置系统变量</b> 对话框</a>.中设置 <b>@RCN=7</b> 的值。每次 Origin 运行时都会读取 @RCN 的值，从而使得 Origin 像 2017 版本那样处理由by <code>win -t</code> 或 <code>newbook</code> 创建的窗口。
</p><p><br />
<b> @RCN 的值</b>
</p>
<ul><li> 0 = 在所有的新工作簿中都关闭 SCN。</li>
<li> 1 = 在使用工具栏中的 <b>New Workbook</b> 按钮创建的工作簿中关闭 SCN。</li>
<li> 2 = 当导入数据时，如果当前激活的工作表启用了 SCN，则新建的工作表也开启，否则也关闭。</li>
<li> 4 = 大多数基于 X-Function 的分析功能在 <a class="external text" href="../../UserGuide/UserGuide/Other_Tree_View_controls.html">树形视图模式</a> 下都有一个 <b>Auto Spreadsheet Cell Notation on New Book</b> 的复选框。当选中该复选框时，这一个功能将被启用。则不论当前激活的工作簿中是否启用了 SCN，而在 X-Function 输出结果的工作簿中都将启用 SCN。(不支持 <a class="external text" href="../../XFunction/X-Function/Wsplit.html">wsplit</a>, <a class="external text" href="../../XFunction/X-Function/Wsplit_book.html">wsplit_book</a>, <a class="external text" href="../../XFunction/X-Function/Merge_book.html">merge_book</a>, <a class="external text" href="../../XFunction/X-Function/Wmove_sheet.html">wmove_sheet</a>).</li>
<li> 8 = 2019版本新增值。对于由 LabTalk 命令 <code>win -t </code> 或X-Function <code>newbook</code> 创建的所有工作簿，默认开启 SCN。</li></ul>
<table class="note">

<tr>
<td><b>注意：</b> 此系统变量的值是遵循加分规则的 (例如，变量的默认值 @RCN = 7 表示在一致性分析工具中自动开启 RCN (+4)，导入数据与当前工作簿保持一致 (+2)，使用工具栏按钮新建工作表时启用 SCN  (+1))。但是对于由 LabTalk 命令 <code>win -t </code> 或X-Function <code>newbook</code> 创建的所有工作簿，SCN 都是关闭的。
</td></tr></table>
<h2><a name=".E5.85.A8.E5.B1.80.E5.9C.B0.E5.85.B3.E9.97.AD.E7.94.B5.E5.AD.90.E8.A1.A8.E6.A0.BC.E5.8D.95.E5.85.83.E6.A0.BC.E8.A1.A8.E7.A4.BA.E6.B3.95"></a><span class="mw-headline">全局地关闭电子表格单元格表示法</span></h2>
<p>当配置系统变量 @RCN 的值时，其实控制的是在<i>新建</i> 工作簿中的 SCN 的状态。但是，有一种方法可以关闭工程中所有已存在的工作簿中的 SCN 功能，也可以选择关闭所有新建的工作簿中的 SCN 功能。
<i><b>关闭当前工程中所有工作簿里的电子表格单元格表示法（SCN）：</b></i><br />
打开 Script Window 或者 Command Window，输入以下命令并按下 Enter：
</p>
<pre class="lt" style="font-family:monospace;">doc <span style="color: #000080;">-</span>e WW <span style="color: #000000;">&#123;</span>page.<span style="color: #000080;">xlcolname</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#125;</span></pre>
<p>注意，可以使用 <code>page.xlcolname=1</code> 启用 RCN 功能。详细的信息请参考 <a class="external text" href="../../LabTalk/LabTalk/Page_(object).html#Properties:Page_Property">LT page.xlcolname 对象的属性</a>。
</p><p><i><b>关闭当前工程中的所有工作簿以及以后新建工程中的工作簿里的 RCN 功能：</b></i><br />
打开 Script Window 或者 Command Window，输入以下命令并按下 Enter：
</p>
<pre class="lt" style="font-family:monospace;">ClrX</pre>
<p>执行 <code>ClrX</code> 宏指令主要完成了以下两项设置：
</p>
<dl><dd><ul><li>运行了以上提到的 <code>doc -e WW {page.xlcolname=0}</code> 脚本代码。这将关闭工程中所有工作簿的 RCN 功能。</li>
<li> 将 <a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#R">@RCN LT 系统变量</a>添加到 <a class="external text" href="../../UserGuide/UserGuide/Set_System_Variables_Dialog_Box.html#Adding_and_Setting_Values_of_System_Variables_by_LabTalk_Script"><b>Set System Variables</b> 对话框</a>中，并将值设为0。这将禁用了所有新建工作簿中的 RCN 功能，同时这项设置将持续有效 (除非在 Set System Variables 对话框中修改或者删除了 @RCN 的值)。</li></ul></dd></dl>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Turn_off_spreadsheet_cell_notation/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>注意，可以通过以下方法撤销以上宏指令所修改的内容：
</p>
<ol><li> 运行 <code>doc -e WW {page.xlcolname=1}</code> 代码。</li>
<li> 打开 <b>Set System Variables</b> 对话框，删除 <code>@RCN</code> 变量，或者将其值设为 <i>1</i>。</li></ol>
</td></tr></table>
<p><br />
<i><b>更多的详细信息请参考：</b></i>
</p>
<ul><li>  <a class="external text" href="../../LabTalk/LabTalk/ClrX_(macro).html">LT ClrX  宏指令</a>.</li>
<li> <a href="../../QuickHelp/QuickHelp/Set_column_names_in_script_using_wksaddCol_wkscolname.html" title="QuickHelp:Set column names in script using wksaddCol wkscolname">FAQ-872 如何在脚本中设置列名称，例如使用 wks.addCol 或 wks.col.name?</a></li></ul>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>short name, Set Values, Set Column Values, column formula, worksheet, new book，短名称，设置值，设置列值，列公式，工作表，新工作簿</span></p>


