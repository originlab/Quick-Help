<h1 class="firstHeading">3.31 FAQ-259 怎样对日期和时间类型数据进行拟合？</h1><p class='urlname' style='display: none'>Fit-Date-Time</p>
<p class='faqID'>Last Update: 10/31/2018</p>
<p>实验数据通常都跟时间有关，其可以以日期形式显示（如 4/1/2007）。Origin 在系统内部使用<a class="external text" href="../../UserGuide/UserGuide/Dates_and_Times_in_Origin.html">儒略日期值</a>来进行计算，这是一个很大的正数，如 2.45419E6。 因此， 对于正常有持续时间的实验来说，自变量的数据是儒略日期，这是很大的数，而每个数之间可能只有最后一到两个小数位会有不同。 这样，由于数值精度不足，非线性拟合中的 Levenberg-Marquardt 方法就很可能会不收敛。
</p><p>要对时间数据进行曲线拟合，可以将自变量 X 进行归一化 (全列减去最早的日期数）。从而，创建一个新的自变量 X-prime， <code>X-prime = X - Date(earliest date)</code> ，其中 <a class="external text" href="../../LabTalk/LabTalk/Date_(function).html">Date</a> 是 Origin 函数，用于将日历日期转换为儒略日期。然后，你可以使用此新 X 列和原始 Y 数据列执行曲线拟合操作。请注意，结果是归一化后 X 的值，即 X-prime 的值。进行曲线拟合后，需在原工作表的 X 列上加上相应的偏移量，再进行绘图才能把拟合曲线跟原来的散点图画在一起。此外，如果是时间序列数据，加回偏移值的 X 列类型应设置为 <b>Date</b> 类型。
</p><p>下面的示例说明了如何在 <b>Set Column Value</b> 对话框中使用 <a class="external text" href="../../LabTalk/LabTalk/Date_(function).html">Date()</a> 函数来创建归一化日期数据集：
</p>
<dl><dd><a  class="image"><img alt="Fitting Date and Time Data 01.png" src="../images/How_to_fit_date_and_time_data/Fitting_Date_and_Time_Data_01.png?v=4967" width="400"  /></a></dd></dl>
<p>这个归一化的方法， 在对仅在最后一两个有效数字上不同的大数值进行计算时，也可以使用。
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_to_fit_date_and_time_data/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p>注意，从Origin 2019开始，Origin支持<a class="external text" href="../../UserGuide/UserGuide/Dates_and_Times_in_Origin.html#Alternate_Date-Time_Systems_in_Origin">一个叫"<b>2018</b>"的时间系统</a>，这个时间系统中，“时间零点”被定义为Jan 1 2018 00:00。对于当代日期，这个日期时间系统在处理分数天（或者小时，分钟，秒等）时能够显着提高精度。
</p></td></tr></table>
<p><br />
<b>请参考</b>: 
</p>
<ul><li><a class="external text" href="../../UserGuide/UserGuide/Dates_and_Times_in_the_Worksheet.html">工作簿里的日期和时间数据</a></li>
<li><a class="external text" href="../../UserGuide/Category/Using_Formulae_to_Set_or_Transform_Worksheet_Column_Values.html">使用函数来设定或转换工作簿列数据的值</a></li>
<li> <a class="external text" href="../../LabTalk/Script/Date_and_Time_Data.html">在菜单 <b>Help:Programming</b> 选项中的日期/时间格式</a></li></ul>
<p><br />
</p>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>Date, Time, Curve Fit, Fitting, Time Series, Normalization，日期，时间，曲线拟合，拟合，时间序列，标准化（归一化））</span></p>


