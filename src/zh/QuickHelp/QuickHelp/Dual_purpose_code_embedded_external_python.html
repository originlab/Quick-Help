<h1 class="firstHeading">4.67 FAQ-1078 如何编写代码以便内置和外部Python可交换使用？</h1><p class='urlname' style='display: none'>Dual-purpose-code-embedded-external-python</p>
<p class='faqID'>Last Update: 4/21/2021</p>
<p>对于 Origin 内置的 Python 解析器和访问 Origin 的外部 Python 解析器，originpro 这个 Python 包的使用方式几乎一样。也就是说，您可以写出 <b>便携式脚本</b> 同时可以在这两个解析器上使用。
</p><p>但是，要写出这样的脚本，要额外增加两个内容。下面的代码就演示了这两个额外内容。当在外部 Python 解析器上运行时，这两点都只是以 originpro 为目标写。
</p><p>第一个额外内容是，Origin 启动后，要设置为可见，不能为后台运行，第二个就是要关闭 Origin。您的代码中使用到 originpro 包的代码就可以放在设置可见和关闭的代码之间，这样写出来的脚本就可以在内置和外部两个 Python 解析器上使用。
</p>
<pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">import</span> originpro <span style="color: #ff7700;font-weight:bold;">as</span> op

<span style="color: #d00; font-style: italic;"># 设置 Origin 可见，即不要在后台运行</span>
<span style="color: #d00; font-style: italic;"># 对外部 Python 非常重要</span>
<span style="color: #d00; font-style: italic;"># 不应该用于内置 Python</span>
<span style="color: #ff7700;font-weight:bold;">if</span> op.<span style="color: #000;">oext</span>:
    op.<span style="color: #000;">set_show</span><span style="color: #000;">&#40;</span><span style="color: #900090;">True</span><span style="color: #000;">&#41;</span>


<span style="color: #d00; font-style: italic;"># 基于 originpro 的代码写在这里</span>


<span style="color: #d00; font-style: italic;"># 关闭 Origin</span>
<span style="color: #d00; font-style: italic;"># 对外部 Python 是必须的，但不能用于内置 Python</span>
<span style="color: #ff7700;font-weight:bold;">if</span> op.<span style="color: #000;">oext</span>:
    op.<span style="color: #000;">exit</span><span style="color: #000;">&#40;</span><span style="color: #000;">&#41;</span></pre>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>Python, originpro, embedded, external, interpreter, portable, dual，内置，外部，解析器，便携式，双边</span></p>






