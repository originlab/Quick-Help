<h1 class="firstHeading">4.61 FAQ-872 为什么无法使用 LabTalk 脚本设置列名，例如使用 wks.addCol 或者 wks.col.name？</h1><p class='urlname' style='display: none'>Set-column-names-in-script</p>
<p class='faqID'>Last Update: 4/27/2020</p>
<p>从 Origin 2017 开始，工作簿支持使用简化的工作表单元格表示法，类似于 MS Excel 的单元格表示法。当您打开这种简化的单元格表示法模式后（该模式打开后会在工作簿左上角出现相应的标记 <a  class="image"><img alt="Spreadsheet cell notation mode.png" src="../images/Set_column_names_in_script_using_wksaddCol_wkscolname/Spreadsheet_cell_notation_mode.png?v=4940" width="20"  /></a>），<a class="external text" href="../../UserGuide/UserGuide/Column_Short_Name_Restriction.html">列的短命称将<b>无法被编辑和重新排序</b></a>即使使用LabTalk。
</p><p>在<b>Origin 2017</b>，<b>Origin 2018</b>和<b>Origin 2018b</b>，使用LabTalk命令（如 <code>win -t</code> 或者 X-Function <code>newbook</code>）创建工作簿时会默认关闭此项列命名的限制，但是从<b>Origin 2019</b>开始，这些工作薄中列命名限制会默认被<b>打开</b>。如果您使用 LabTalk 脚本编程， 请注意这个变化。
</p><p>如果要防止此类错误，您需要在对列名称重命名的代码前插入以下脚本：
</p>
<pre class="lt" style="font-family:monospace;">page.<span style="color: #000080;">XLColName</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>; <span style="color: #008000;">// remove column short name restriction</span></pre>
<p>如果您需要将相同的代码应用至 Origin 2017 之前的版本，那么您可在对列名称重命名的代码前插入：
</p>
<pre class="lt" style="font-family:monospace;">if<span style="color: #000000;">&#40;</span>@v<span style="color: #000080;">&gt;=</span><span style="color: #0000dd;">9.4</span><span style="color: #000000;">&#41;</span> page.<span style="color: #000080;">xlcolname</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;</pre>
<p><br />
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/Set_column_names_in_script_using_wksaddCol_wkscolname/Tip_icon.png?v=0" width="57"  border="0" /></td><td><p><b>如果您正在使用Origin2019或者更高的版本，想要不修改单独的脚本的情况下，确认列命名显示是被关闭的，您可以在系统变量对话框设置系统变量<code>@RCN=7</code>，然后运行<code>win -t</code>或者<code>newbook</code>。</b>
</p></td></tr></table>
<p><br />
<i><b>相关的 FAQ:</b></i>
</p>
<ul><li> <a href="../../QuickHelp/QuickHelp/Why_column_formula_not_update.html" title="QuickHelp:Why column formula not update">FAQ-847: 在插入列或者删除列时，为什么列公式不更新？</a></li>
<li> <a href="../../QuickHelp/QuickHelp/Turn_off_spreadsheet_cell_notation.html" title="QuickHelp:Turn off spreadsheet cell notation">FAQ-849: 在工作簿中可以关闭或者选择性使用电子表格单元格表示法吗？</a></li></ul>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>short name restriction, spreadsheet cell notation, reorder, 短命称限制，电子表格单元格表示法，重新排序</span></p>


