<h1 class="firstHeading">4.34 FAQ-394 在 Code Builder 没有打开的情况下如何加载和调用 Origin C 函数？</h1><p class='urlname' style='display: none'>Load-Call-Functions</p>
<p class='faqID'>Last Update: 7/10/2018</p>
<p>如果您需要在 Origin 中<a class="external text" href="../../Tutorial/Tutorial/Adding_New_Origin_C_Functions_to_Origin.html">调用 Origin C 函数</a>，那么在调用函数前您必须在当前的 Origin 进程中编译且链接您的函数。这一操作通常可以在 <b>Code Builder</b> 中完成。但是，在某些情况下，我们也会希望在 <b>Code Builder</b> 没有打开的情况下调用 Origin C 的函数，例如，在运行依赖于 Origin C 函数的 LabTalk 脚本的时候。我们可以使用 LabTalk run object 命令的 <a class="external text" href="../../LabTalk/LabTalk/Run_(object).html#Methods:">run.loadOC</a> 方法，用此方法来以编程方式的编译和链接源文件，或者以编程方式于 LabTalk 脚本中构建工作区域。
</p>
<pre class="lt" style="font-family:monospace;">err <span style="color: #000080;">=</span> run.<span style="color: #000080;">LoadOC</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;myFile&quot;</span>,<span style="color: #000000;">&#91;</span>option<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span>;</pre>
<p>例如，以下代码将通过使用 run.loadOC 的其中一个选项来扫描 Origin C 文件中被加载的各个头文件，并且为其自动加载其他相关的 Origin C 依赖文件。
</p>
<pre class="lt" style="font-family:monospace;">if<span style="color: #000000;">&#40;</span>run.<span style="color: #000080;">LoadOC</span><span style="color: #000000;">&#40;</span>OriginLab\iw_filter.<span style="color: #000080;">c</span>, <span style="color: #0000dd;">16</span><span style="color: #000000;">&#41;</span> <span style="color: #000080;">!</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	type <span style="color: #ff00ff;">&quot;Failed to load iw_filter.c!&quot;</span>;
	return <span style="color: #0000dd;">0</span>;
<span style="color: #000000;">&#125;</span></pre>
<p><br />
</p>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>load, call, oc, code builder, compile, 加载，调用，编译</span></p>






