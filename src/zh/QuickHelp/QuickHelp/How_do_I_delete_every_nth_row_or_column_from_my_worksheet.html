<h1 class="firstHeading">4.8 FAQ-367 如何从工作表中删除每个第 n 行或列？</h1><p class='urlname' style='display: none'>Del-Every-nth-Row-or-Col</p>
<p class='faqID'>Last Update: 8/10/2018</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#.E5.88.A0.E9.99.A4.E6.AF.8F.E4.B8.AA.E7.AC.AC_n_.E8.A1.8C.E6.88.96.E5.88.97"><span class="tocnumber">1</span> <span class="toctext">删除每个第 n 行或列</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#.E9.80.9A.E8.BF.87.E5.88.A0.E5.87.8F.E5.88.97.2F.E8.A1.8C.E5.AF.B9.E8.AF.9D.E6.A1.86"><span class="tocnumber">1.1</span> <span class="toctext">通过删减列/行对话框</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#.E9.80.9A.E8.BF.87.E5.BE.AA.E7.8E.AF.E8.84.9A.E6.9C.AC"><span class="tocnumber">1.2</span> <span class="toctext">通过循环脚本</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4"><a href="#.E4.BD.BF.E7.94.A8.E9.80.89.E6.8B.A9.E5.AF.B9.E8.AF.9D.E6.A1.86.E5.88.A0.E9.99.A4.E6.AF.8F.E7.AC.ACn.E5.88.97"><span class="tocnumber">2</span> <span class="toctext">使用选择对话框删除每第n列</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#.E4.BD.BF.E7.94.A8.E5.B7.A5.E4.BD.9C.E8.A1.A8.E6.9F.A5.E8.AF.A2.E5.AF.B9.E8.AF.9D.E6.A1.86.E5.88.A0.E9.99.A4.E6.AF.8F.E4.B8.AA.E7.AC.AC_n_.E8.A1.8C"><span class="tocnumber">3</span> <span class="toctext">使用工作表查询对话框删除每个第 n 行</span></a></li>
</ul>
</div>

<h2><a name=".E5.88.A0.E9.99.A4.E6.AF.8F.E4.B8.AA.E7.AC.AC_n_.E8.A1.8C.E6.88.96.E5.88.97"></a><span class="mw-headline">删除每个第 n 行或列</span></h2>
<h3><a name=".E9.80.9A.E8.BF.87.E5.88.A0.E5.87.8F.E5.88.97.2F.E8.A1.8C.E5.AF.B9.E8.AF.9D.E6.A1.86"></a><span class="mw-headline">通过删减列/行对话框</span></h3>
<p>如需删减列，选择<b>工作表：删减列</b>。这将打开<a class="external text" href="../../XFunction/X-Function/Wreducecols.html">wreducecols</a> X-Function。
</p><p>比如，你可以进行如下设置去删减当前工作表的每第5列（删掉1列然后跳过4列，从第5列开始）。
</p>
<dl><dd><a  class="image"><img alt="FQA367 Reduce Columns-CN.png" src="../images/How_do_I_delete_every_nth_row_or_column_from_my_worksheet/400px-FQA367_Reduce_Columns.png?v=0" width="400"   /></a></dd></dl>
<p>或者，你可以在<b>命令窗口</b>直接运行以下程序去执行以上操作：
</p>
<pre class="lt" style="font-family:monospace;">wreducecols skip<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span> start<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">5</span>;</pre>
<p>如需删除行，选择<b>工作表：删减行</b>。这将打开<a class="external text" href="../../XFunction/X-Function/Wreducerows.html"><b>wreducerows</b></a> X-Function。
</p><p>比如，按以下截图设置对话框，当前工作表的每个第4行将被删除（删除1行，跳过3行，从第4行开始）
</p>
<dl><dd><a  class="image"><img alt="FQA367 Reduce Rows-CN.png" src="../images/How_do_I_delete_every_nth_row_or_column_from_my_worksheet/400px-FQA367_Reduce_Rows.png?v=0" width="400"   /></a></dd></dl>
<p>或者，你可以在<b>命令窗口</b>直接运行以下程序去执行以上操作：
</p>
<pre class="lt" style="font-family:monospace;">wreducerows nrows<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span> skip<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">3</span> start<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span>;</pre>
<h3><a name=".E9.80.9A.E8.BF.87.E5.BE.AA.E7.8E.AF.E8.84.9A.E6.9C.AC"></a><span class="mw-headline">通过循环脚本</span></h3>
<p>激活工作表，打开<b>脚本窗口</b> (菜单项：<b>窗口：脚本窗口</b>)，复制粘贴下面的脚本行到脚本窗口，然后选择所有列，按Enter键执行。
</p><p>如需删除列：
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Delete every nth column, counting from the left</span>
int ndel <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>; <span style="color: #008000;">// change this number as needed;</span>

int ncols <span style="color: #000080;">=</span> wks.<span style="color: #000080;">ncols</span>;
int nlast <span style="color: #000080;">=</span> ncols <span style="color: #000080;">-</span> mod<span style="color: #000000;">&#40;</span>ncols, ndel<span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Start deleting from the right to the left</span>
for<span style="color: #000000;">&#40;</span>int ii <span style="color: #000080;">=</span> nlast; ii <span style="color: #000080;">&gt;</span> <span style="color: #0000dd;">0</span>; ii <span style="color: #000080;">-</span><span style="color: #000080;">=</span> ndel<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
   delete wcol<span style="color: #000000;">&#40;</span>ii<span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<p>删除行：
</p>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">// Delete every nth row, couting from the top</span>
int ndel <span style="color: #000080;">=</span> <span style="color: #0000dd;">3</span>; <span style="color: #008000;">// change this number as needed;</span>

int nrows <span style="color: #000080;">=</span> wks.<span style="color: #000080;">nrows</span>;
int nlast <span style="color: #000080;">=</span> nrows <span style="color: #000080;">-</span> mod<span style="color: #000000;">&#40;</span>nrows, ndel<span style="color: #000000;">&#41;</span>;

<span style="color: #008000;">// Start deleting from the bottom to the top</span>
for<span style="color: #000000;">&#40;</span>int ii <span style="color: #000080;">=</span> nlast; ii <span style="color: #000080;">&gt;</span> <span style="color: #0000dd;">0</span>; ii <span style="color: #000080;">-</span><span style="color: #000080;">=</span> ndel<span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
  wks.<span style="color: #000080;">DeleteRows</span><span style="color: #000000;">&#40;</span>ii<span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<h2><a name=".E4.BD.BF.E7.94.A8.E9.80.89.E6.8B.A9.E5.AF.B9.E8.AF.9D.E6.A1.86.E5.88.A0.E9.99.A4.E6.AF.8F.E7.AC.ACn.E5.88.97"></a><span class="mw-headline">使用选择对话框删除每第n列</span></h2>
<ol>
<li> 激活工作表，选择<b>编辑：选择...</b>菜单。
<li> 在打开的<b>选择</b>对话框，从<b>模式</b>下拉菜单选择<b>选择N列并跳过M列</b>，然后设置<b>N</b>, <b>M</b>和<b>开始列</b>。
<li> 点击<b>测试-当条件为真的选取</b>按钮去选择想要的列。点击<b>隐藏</b>退出对话框。
<li>在工作表中，右击被选中的列，选择<b>删除</b>上下文菜单。
</ol>
<p>比如，按下图设置对话框，将在激活工作表选择每第5列。（选择1列，跳过4列，从第5列开始）
</p>
<dl><dd><a  class="image"><img alt="FQA367 Select-CN.png" src="../images/How_do_I_delete_every_nth_row_or_column_from_my_worksheet/300px-FQA367_Select.png?v=0" width="300"   /></a></dd></dl>
<p>点击<b>测试-当条件为真的选取</b>按钮，然后<b>隐藏</b>按钮。回到工作表，通过选择右键<b>删除</b>菜单去删除这些列。这样每第5列将被删除。
</p>
<h2><a name=".E4.BD.BF.E7.94.A8.E5.B7.A5.E4.BD.9C.E8.A1.A8.E6.9F.A5.E8.AF.A2.E5.AF.B9.E8.AF.9D.E6.A1.86.E5.88.A0.E9.99.A4.E6.AF.8F.E4.B8.AA.E7.AC.AC_n_.E8.A1.8C"></a><span class="mw-headline">使用工作表查询对话框删除每个第 n 行</span></h2>
<ol>
<li>激活工作表，打开<a class="external text" href="../../Tutorial/Tutorial/Extract_Worksheet_Data.html">工作表查询</a>对话框，通过选择<b>工作表：工作表查询</b>菜单项。
<li> 在<b>条件</b>框内，输入<code>mod(i,3)==0</code> (参考<a class="external text" href="../../LabTalk/LabTalk/Mod_(function).html">mod函数</a>)，这意味着选择每第三行。然后点击<b>测试-当条件为真的选取</b>按钮去高亮选择这些行. 
<dl><dd><a  class="image"><img alt="FQA367 Worksheet Query-CN.png" src="../images/How_do_I_delete_every_nth_row_or_column_from_my_worksheet/400px-FQA367_Worksheet_Query.png?v=0" width="400"   /></a></dd></dl>
<li> 关闭这个对话框，使用右键<b>删除</b>菜单删除这些行。
</ol>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>remove, reduce，移除，减少</span></p>
<p class="version" >Minimum Origin Version Required: 2016 SR0</p>






