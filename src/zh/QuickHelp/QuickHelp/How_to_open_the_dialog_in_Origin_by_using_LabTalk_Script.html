<h1 class="firstHeading">4.47 FAQ-666 如何使用 LabTalk 脚本在 Origin 中打开对话框？</h1><p class='urlname' style='display: none'>Dialog-Labtalk</p>
<p class='faqID'>Last Update: 7/13/2018</p>
<p>Origin 的图形用户界面（GUI）中所包含的大量菜单和工具栏按钮是通过 LabTalk 脚本实现的。我们可以很容易查看或定位各个菜单和按钮对应所执行的脚本。这使得 Origin GUI 成为获取 LabTalk 脚本示例的绝佳来源。这些脚本文件可以作为示例进行研究，也可以在您自己的自定义脚本中使用。但是最好不要修改 Origin 自身的脚本文件，因为 Origin 也使用它们。如果您想要在 Origin 脚本文件的基础上修改并编辑成为自己的脚本文件，那么最安全的方法是将脚本复制粘贴到您自己的文件中然后再于您自己的文件中编辑它们。
</p><p>打开 <b>Script Window</b>，然后按住 <b>CTRL + SHIFT</b> 键的同时点击所需查看脚本的菜单或按钮。 Origin将在 <b>Script Window</b> 窗口中输出所选菜单或按钮的菜单 ID 和脚本（通常为 <code>run.section</code> 命令）。这种操作并未真正地执行所选菜单或按钮对应的脚本。在Origin中，（在许多情况下）菜单 ID 可以由 LabTalk 命令的 <code>menu -e ID</code> 执行。有关 <code>menu -e ID</code> 命令的更多信息，请参阅 <a class="external text" href="../../LabTalk/LabTalk/Menu_(command).html#-e.3B_Execute_the_menu_command_with_the_specified_ID">LabTalk 帮助</a>或 LabTalk 手册。请注意，菜单 ID 可能会因为版本的不同而发生变化，因此如果脚本发生兼容性的问题，那么请不要使用菜单 ID。
</p>
<pre class="lt" style="font-family:monospace;">run.<span style="color: #000080;">section</span><span style="color: #000000;">&#40;</span>fileName, section<span style="color: #000000;">&#41;</span></pre>
<p>该命令标识了所选的菜单或按钮所执行的脚本的位置。 其中，fileName 参数是脚本文件的路径和文件名，section 参数是文件中要执行的代码段。如果未指定文件的路径，那么该文件默认位于 Origin 的安装文件夹中。如果未指定文件的扩展名，那么默认为 .OGS 的扩展名。您可以使用任意的文本编辑器打开该文件，并搜索括在方括号中的 section 名称 - [section]，即可找到所选菜单和按钮将执行的对应的代码段。
</p><p>除了留意输出到 <b>Script Window</b> 的菜单 ID 和 <code>run.section</code> 命令，您还能发现相应的 OGS 文件将会在 <b>Code Builder</b> 中被打开，而且光标也会置于将要要执行的 section 的开头。
</p><p>例如，如果您在选择 <b>File: Open</b> 菜单的同时按住 <b>CTRL + SHIFT</b> 键，则以下文字将会被输出到 <b>Script Window</b>：
</p>
<pre class="lt" style="font-family:monospace;">Menu id<span style="color: #000080;">=</span><span style="color: #0000dd;">33996</span> <span style="color: #000000;">&#40;</span>0x84cc<span style="color: #000000;">&#41;</span>
run.<span style="color: #000080;">section</span><span style="color: #000000;">&#40;</span>FILE,Open<span style="color: #000000;">&#41;</span></pre>
<p>您也可以在位于 Origin 安装文件夹的 FILE.OGS 文件的 [Open] section 中看到将要被执行的脚本。 对于 Origin 7.5 及其以后的版本，Origin 还会在 <b>Code Builder</b> 中直接打开 FILE.OGS 文件，并且将光标置于 [Open] section 的开头。
</p>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'> LabTalk</span></p>






