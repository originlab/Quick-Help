<h1 class="firstHeading">4.16 FAQ-375 如何创建一个能直接运行 LabTalk 脚本宏的自定义工具栏按钮？</h1><p class='urlname' style='display: none'>Button-to-Run-LT-Script</p>
<p class='faqID'>Last Update: 7/9/2018</p>
<p>工具栏上的按钮能方便快捷地运行 LabTalk 脚本文件。要创建自定义按钮，您需要先准备3个文件来创建一组新的按钮组。第一个是 LabTalk 脚本文件（包含点击按钮时需要执行的脚本）。第二个是位图文件（包含了按钮上需要显示的图标）。第三个文件是INI文件（Origin将会帮助您自动创建）。
</p><p>INI文件存储了该按钮组的名称，按钮组图标的位图文件的名称以及该按钮组具有的按钮数目。
</p><p>若你需要创建一组自定义按钮组并将其导出为一个 .OPX 文件，请先于用户文件夹中新建一个子文件夹， 并将该按钮组的 INI 文件，位图文件，脚本文件和任何其他相关的支持文件保存该文件夹中。当另一个 Origin 用户安装了这个 .OPX 文件后，系统将会自动在该用户的用户文件文件夹中创建这一个子文件夹，而此子文件夹将包含该按钮组的所有所需文件。这种方法将使得自定义按钮组的文件与其他 Origin 文件区别开来。
</p><p>以下示例将完整展示创建一个自定义按钮的过程：
</p>
<ol><li> 使用 <b>Code Builder</b> 开发 LabTalk 脚本 OGS 文件。该文件可包含一段或多段脚本，并与一个或多个按钮相关联。</li>
<li> 使用应用程序如 Windows 的画图工具创建一个16色位图文件。您可以以内置的用户自定义工具栏位图文件（通常存放于用户文件夹中，如Userdef.bmp）为基础， 使用 Windows 的画图工具创建自己的位图文件。</li>
<li> 图像高度需固定为 16 像素（不能更改）。图像宽度应为所需按钮数量 x 16 像素， 即每个按钮高为 16 像素，宽为 16 像素。</li>
<li> 根据需要编辑每个按钮。</li>
<li> 将BMP文件保存为 16 色位图文件。</li>
<li> 返回 Origin，选择 <b>View: Toolbars</b> 以打开 <b>Customize Toolbar</b> 对话框。</li>
<li> 点击 <b>Button Groups</b> 选项卡。</li>
<li> 点击 <b>New</b> 按钮打开 <b>Create Button Group</b> 对话框。</li>
<li> 输入一个新的按钮组的名称。</li>
<li> 设置按钮的数目。</li>
<li> 点击 <b>Browse</b> 按钮并找到您的位图文件。若无改动原始路径，此文件应位于用户文件文件夹中。</li>
<li> 点击 <b>OK</b> 按钮。</li>
<li> 那么 <b>Save As</b> 对话框将会被打开，输入与您的位图文件相同的名称。点击 <b>OK</b> 按钮保存 INI 文件。此时您的按钮组将被添加到按钮组列表中。当您于列表中选中它时，您将可在右侧面板看到您的按钮。</li>
<li> 点击选中其中一个按钮。</li>
<li> 点击 <b>Settings</b> 按钮来打开 <b>Button Settings</b> 对话框。</li>
<li> 点击 <b>Browse</b> 按钮并找到您的 OGS 文件.</li>
<li> 输入此 OGS 文件与该按钮相关联的一段脚本名称于 <b>Section Name</b> 文本框以及其参数于 <b>Argument</b> 文本框。</li>
<li> 在 <b>Tool Tip Text</b> 文本框内输入按钮的简单介绍。</li>
<li> 在 <b>Status Bar</b> 文本框内输入显示于任务栏的消息。</li>
<li> 点击 <b>OK</b> 按钮.</li>
<li> 为按钮组的每一个按钮重复上述第 15 至 21 步。</li>
<li> 将第一个按钮拖到 Origin 工作区将会自动创建一个新的工具栏，然后可以将所有其他按钮拖到此工具栏上。</li></ol>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>automate, click, repeat, button, bitmap, custom, 自动化，点击，重复，按钮，位图，自定义</span></p>






