<h1 class="firstHeading">2.95 FAQ-941 为什么单元格公式不能正常运行？</h1><p class='urlname' style='display: none'>Why-are-cell-formulas-not-working</p>
<p class='faqID'>Last Update: 4/24/2019</p>
<p>Origin 2017 引入了 <a class="external text" href="../../UserGuide/UserGuide/Column_Short_Name_Restriction.html">"电子表格单元格表示法"</a> 可以用于 <b>Set (Column) Values</b> 对话框中基于行的计算。 Origin 2018 将这个用法扩展到了单元格层面，可以对单元格进行计算。
</p><p>有时，用户在菜单设置或 LabTalk 命令禁用了全部的或部分的单元格公式功能，并忘记了曾经进行的此项设置。之后，在尝试使用单元格公式时会发现其不起作用。
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#.E5.BF.85.E9.A1.BB.E5.9C.A8.E5.B7.A5.E4.BD.9C.E7.B0.BF.E4.B8.AD.E5.90.AF.E7.94.A8.E7.94.B5.E5.AD.90.E8.A1.A8.E6.A0.BC.E5.8D.95.E5.85.83.E6.A0.BC.E8.A1.A8.E7.A4.BA.E6.B3.95"><span class="tocnumber">1</span> <span class="toctext">必须在工作簿中启用电子表格单元格表示法</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#.E9.80.9A.E8.BF.87.E8.8F.9C.E5.8D.95.E8.AE.BE.E7.BD.AE.E6.88.96_LabTalk_.E5.91.BD.E4.BB.A4.E6.8E.A7.E5.88.B6.E5.8D.95.E5.85.83.E6.A0.BC.E5.85.AC.E5.BC.8F"><span class="tocnumber">2</span> <span class="toctext">通过菜单设置或 LabTalk 命令控制单元格公式</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#.E9.80.9A.E8.BF.87.E8.8F.9C.E5.8D.95.E8.AE.BE.E7.BD.AE.E6.8E.A7.E5.88.B6.E5.8D.95.E5.85.83.E6.A0.BC.E5.85.AC.E5.BC.8F"><span class="tocnumber">2.1</span> <span class="toctext">通过菜单设置控制单元格公式</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#.E9.80.9A.E8.BF.87_LabTalk_.E5.91.BD.E4.BB.A4.E6.8E.A7.E5.88.B6.E5.8D.95.E5.85.83.E6.A0.BC.E5.85.AC.E5.BC.8F"><span class="tocnumber">2.2</span> <span class="toctext">通过 LabTalk 命令控制单元格公式</span></a></li>
</ul>
</li>
</ul>
</div>

<h3><a name=".E5.BF.85.E9.A1.BB.E5.9C.A8.E5.B7.A5.E4.BD.9C.E7.B0.BF.E4.B8.AD.E5.90.AF.E7.94.A8.E7.94.B5.E5.AD.90.E8.A1.A8.E6.A0.BC.E5.8D.95.E5.85.83.E6.A0.BC.E8.A1.A8.E7.A4.BA.E6.B3.95"></a><span class="mw-headline">必须在工作簿中启用电子表格单元格表示法</span></h3>
<ul><li> 若要正常使用单元格公式计算，则必须在工作簿中启用<a class="external text" href="../../UserGuide/UserGuide/Column_Short_Name_Restriction.html">电子表格单元格表示法</a>。</li>
<li> <b>Origin 2017</b> 直至 <b>Origin 2019</b>， 如果已经启用了电子表格单元格表示法，则在工作表的左上角将会显示这个图标 <a  class="image"><img alt="Spreadsheet cell notation mode.png" src="../images/Why_are_cell_formulas_not_working/Spreadsheet_cell_notation_mode.png?v=4940" width="20"  /></a> 。从 <b>Origin 2019b</b> 开始，即使 SCN 是启用的， 在新建工作簿中这个图标也是隐藏的</li>
<li> 如果您在工作簿的左上角看到这样的图标 <a  class="image"><img alt="Button SCN OFF.png" src="../images/Why_are_cell_formulas_not_working/Button_SCN_OFF.png?v=8599" width="22"  /></a>（任意版本中），点选这个图标并在打开菜单中选择<b>电子表格单元格表示法(SCN)打开</b> 即可打开 SCN。</li>
<li> 电子表格单元格表示法可以在任何工作簿或者项目中打开，即使这些工作簿是用旧版本软件创建的。一旦这个工作表在 Origin 2017 或更高的版本中打开，在工作簿的标题栏上右击并选择 <b>Properties</b>。在 <b>Properties</b> 选项卡中，勾选 <b>Spreadsheet Cell Notation</b> 复选框并点击 <b>OK</b>。即可打开 SCN</li></ul>
<p><br />
请注意，可以使用LabTalk (脚本) 方法来禁用单个工作簿或者项目中所有工作簿的电子表格单元格表示法，与此相关的内容包含在 <a href="../../QuickHelp/QuickHelp/Turn_off_spreadsheet_cell_notation.html" title="QuickHelp:Turn off spreadsheet cell notation"><b>FAQ-849</b> 是否可以在工作簿中关闭或有选择地控制电子表格单元格表示法的使用？</a>中。
</p>
<h3><a name=".E9.80.9A.E8.BF.87.E8.8F.9C.E5.8D.95.E8.AE.BE.E7.BD.AE.E6.88.96_LabTalk_.E5.91.BD.E4.BB.A4.E6.8E.A7.E5.88.B6.E5.8D.95.E5.85.83.E6.A0.BC.E5.85.AC.E5.BC.8F"></a><span class="mw-headline">通过菜单设置或 LabTalk 命令控制单元格公式</span></h3>
<p>有很多种方法可以部分的或者完全的禁用 Origin 项目中的单元格公式 (详细信息请参考 <a href="../../QuickHelp/QuickHelp/Turn_off_cell_formula.html" title="QuickHelp:Turn off cell formula">FAQ-939</a> )。
</p>
<h4><a name=".E9.80.9A.E8.BF.87.E8.8F.9C.E5.8D.95.E8.AE.BE.E7.BD.AE.E6.8E.A7.E5.88.B6.E5.8D.95.E5.85.83.E6.A0.BC.E5.85.AC.E5.BC.8F"></a><span class="mw-headline">通过菜单设置控制单元格公式</span></h4>
<p>确保没有启用 <b>Edit Mode</b> 。
</p>
<ol><li>从菜单中选择 <b>Edit: Edit Mode</b>。</li>
<li>如果 <b>Edit Mode</b> 旁边被勾选，点击这个菜单以取消勾选。</li></ol>
<dl><dd><dl><dd><a  class="image"><img alt="Edit menu edit mode enabled.png" src="../images/Why_are_cell_formulas_not_working/Edit_menu_edit_mode_enabled.png?v=4953" width="208"  /></a></dd></dl></dd></dl>
<h4><a name=".E9.80.9A.E8.BF.87_LabTalk_.E5.91.BD.E4.BB.A4.E6.8E.A7.E5.88.B6.E5.8D.95.E5.85.83.E6.A0.BC.E5.85.AC.E5.BC.8F"></a><span class="mw-headline">通过 LabTalk 命令控制单元格公式</span></h4>
<p>请确保 LabTalk 系统变量 <code>@ESC = 1</code>。如果 <code>@ESC=0</code>，则单元格公式 (例如， "=A1+B1") 将会被视作文本，所以软件不会对表达式求解。即使工作簿属性中已经勾选了 <b>Spreadsheet Cell Notation</b> ，但是依然不能计算公式 (此时 <a  class="image"><img alt="Spreadsheet cell notation mode.png" src="../images/Why_are_cell_formulas_not_working/Spreadsheet_cell_notation_mode.png?v=4940" width="20"  /></a> 图标是没有显示的)。并且 <b>Edit Mode</b> 也是关闭状态。 
</p>
<ol>
<li>选择 <b>Window: Script Window</b>，输入以下代码并按下 Enter：</li>
<pre class="lt" style="font-family:monospace;">@esc<span style="color: #000080;">=</span></pre>
<li>如果 Origin 返回的值为 0 (@esc=0)，则输入以下代码并按下 Enter：</li>
<pre class="lt" style="font-family:monospace;">@esc<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span></pre>
</ol>
<p><br />
另外的，如果 <code>@ESC</code> 的返回值为 0，检查 <a href="../../QuickHelp/QuickHelp/How_do_I_permanently_change_the_value_of_a_system_variable.html" title="QuickHelp:How do I permanently change the value of a system variable"> <b>Set System Variables</b> 对话框</a> 中是否已经输入了变量 "ESC" 并将其值设为了 0：
</p>
<ol><li> 在主菜单中选择 <b>Preferences: System Variables</b> 打开 Set System Variables 对话框。</li></ol>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>calculation, spreadsheet, @RCN, @ESC, page.xlcolname, ClrX，计算，电子表格</span></p>






