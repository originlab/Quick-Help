<h1 class="firstHeading">3.102 FAQ-633 如何在两点之间画一条线并求出其斜率和 Y 轴截距？</h1><p class='urlname' style='display: none'>Two-Points-Slope</p>
<p class='faqID'>Last Update: 7/21/2018</p>
<p>此 LabTalk 脚本让用户在图上选择两个数据点，然后在它们之间绘制一条线，并在文本标签中显示其斜率和 y 轴截距值。
</p>
<pre class="lt" style="font-family:monospace;">def EndToolbox <span style="color: #000000;">&#123;</span>
   <span style="color: #000080;">%</span>A<span style="color: #000080;">=</span>getpts.<span style="color: #000080;">xdata</span><span style="color: #000080;">$</span>;
   <span style="color: #000080;">%</span>B<span style="color: #000080;">=</span>getpts.<span style="color: #000080;">data</span><span style="color: #000080;">$</span>;
   slope<span style="color: #000080;">=</span><span style="color: #000000;">&#40;</span><span style="color: #000080;">%</span>B<span style="color: #000000;">&#40;</span><span style="color: #000080;">%</span>A<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">-%</span>B<span style="color: #000000;">&#40;</span><span style="color: #000080;">%</span>A<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">/</span><span style="color: #000000;">&#40;</span><span style="color: #000080;">%</span>A<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#93;</span><span style="color: #000080;">-%</span>A<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">//计算两点的斜率</span>
   yintercept<span style="color: #000080;">=</span><span style="color: #000080;">%</span>B<span style="color: #000000;">&#40;</span><span style="color: #000080;">%</span>A<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span><span style="color: #000080;">-</span>slope<span style="color: #000080;">*%</span>A<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#93;</span>; <span style="color: #008000;">//计算截距</span>
   <span style="color: #000080;">%</span>Z<span style="color: #000080;">=</span><span style="color: #ff00ff;">&quot;slope=$(slope)
yintercept=$(yintercept)&quot;</span>;
   label <span style="color: #000080;">-</span>p <span style="color: #0000dd;">10</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">-</span>s <span style="color: #000080;">-</span>sa <span style="color: #000080;">-</span>n Ltext <span style="color: #000080;">%</span>Z; <span style="color: #008000;">//添加文本标签</span>
   Ltext.<span style="color: #000080;">background</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
   xb1<span style="color: #000080;">=</span><span style="color: #000080;">%</span>A<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span>;xb2<span style="color: #000080;">=</span><span style="color: #000080;">%</span>A<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#93;</span>;yb1<span style="color: #000080;">=</span><span style="color: #000080;">%</span>B<span style="color: #000000;">&#40;</span><span style="color: #000080;">%</span>A<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span>;yb2<span style="color: #000080;">=</span><span style="color: #000080;">%</span>B<span style="color: #000000;">&#40;</span><span style="color: #000080;">%</span>A<span style="color: #000000;">&#91;</span><span style="color: #0000dd;">2</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span>;
   draw <span style="color: #000080;">-</span>n Lline <span style="color: #000080;">-</span>l <span style="color: #000000;">&#123;</span>xb1,yb1,xb2,yb2<span style="color: #000000;">&#125;</span>;  <span style="color: #008000;">//在两点之间画一条直线</span>
   Lline.<span style="color: #000080;">color</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>;  <span style="color: #008000;">//将颜色设置为红色 </span>
   delete <span style="color: #000080;">-</span>v xb1;delete <span style="color: #000080;">-</span>v xb2;delete <span style="color: #000080;">-</span>v yb1;delete <span style="color: #000080;">-</span>v yb2;
   delete <span style="color: #000080;">-</span>v slope;delete <span style="color: #000080;">-</span>v yintercept;
   doc <span style="color: #000080;">-</span>uw;  <span style="color: #008000;">//window refresh</span>
<span style="color: #000000;">&#125;</span>
getpts <span style="color: #0000dd;">2</span>; <span style="color: #008000;">//使用数据阅读器选择两个点</span></pre>
<p>该脚本可以直接在 Script Window 中运行，也可以保持为 OGS 文件，然后在自定义的工具栏按钮中调用 OGS 文件来执行。
</p>
<table class="note">

<tr>
<td><b>注:</b> 该脚本是把所选的数据点所在的数据曲线作为一个寻值函数，对于给定的 X 值，脚本会在这条曲线中查找其所对应的 Y 值。如果你选择的数据点在曲线上存在重复的 X 值，则返回的 Y 值是在这条曲线中的第一个 X 值所对应的 Y 值。
</td></tr></table>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>LabTalk, Linear Curve Fit, 线性拟合</span></p>






