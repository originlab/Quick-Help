<h1 class="firstHeading">FAQ-988 Wie füge ich eine Zellenformel während des Datenimports in die Spaltenbeschriftungszeile ein?</h1>

  <p class='urlname' style='display: none'>Add-Cell-Formula-during-Import</p>

  <p class='faqID'>Letztes Update: 09.01.2019</p>

  <p>Im Allgemeinen können Spaltenbeschriftungszeilen mit Hilfe von Zellenformeln festgelegt werden, die für Prozesse nach dem Datenimport verwendet werden. Origin deaktiviert die Zellenformel jedoch während des Imports aus dem Grund, dass Ihre Daten Text enthalten könnten, der mit "=" beginnt. Wenn Sie wirklich eine Zellenformel während des Imports verwenden möchten, können Sie <a class="external text" href="../../LabTalk/LabTalk/System_Variable_List.html#E">@ESC</a> auf 1 setzen, um eine Zellenformel einzuschalten, bevor Sie eines der Skripte für nach dem Import ausführen.</p>

  <p>Wenn Sie zum Beispiel Daten mit dem Hilfsmittel <b>ASCII importieren</b> importieren möchten und den Kommentar darauf festlegen, dass er die Differenz zwischen dem Maximum und Minimum dieser Spalte darstellt, dann können Sie die folgenden Skripte im Feld <b>Skript nach jeder importierten Datei</b> im Dialog <b>impASC</b> eingeben.</p>
  <pre class="lt" style="font-family:monospace;">
int nOld <span style="color: #000080;">=</span> @ESC; <span style="color: #008000;">//keep record of original value of @ESC</span> @ESC <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; <span style="color: #008000;">//force cell formula enable</span> <span style="color: #008000;">//start your code for after import process</span> for<span style="color: #000000;">(</span>int ii<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>; ii<span style="color: #000080;">&lt;=</span>wks.<span style="color: #000080;">ncols</span>; ii<span style="color: #000080;">++</span><span style="color: #000000;">)</span> <span style="color: #000000;">{</span> Col<span style="color: #000000;">(</span><span style="color: #000080;">$</span><span style="color: #000000;">(</span>ii<span style="color: #000000;">)</span><span style="color: #000000;">)</span><span style="color: #000000;">[</span>C<span style="color: #000000;">]</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span><span style="color: #ff00ff;">"=Max(This)-Min(This)"</span>; <span style="color: #000000;">}</span> @ESC <span style="color: #000080;">=</span> nOld; <span style="color: #008000;">//restore @ESC to original value</span>
</pre>

  <p><b>Hinweis</b>: Wir müssen den Wert von @ESC auf 1 setzen, auch wenn er bereits 1 ist, weil Origin ihn während des Importierens intern temporär auf 2 setzt (wodurch die Zellenformel deaktiviert ist).</p>
  <hr class='keywordshr'>

  <p><span class='keywords'>Schlüsselwörter:</span><span class='keywordsInput'>Zellenformel, Parameterzeile, Berechnung während des Imports, Beschriftungszeile, Beschriftung festlegen</span></p>
