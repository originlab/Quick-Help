<h1 class="firstHeading">FAQ-286 Wie definiere ich globale Funktionen, globale Variablen und Konstanten?</h1>

  <p class='urlname' style='display: none'>Global-Constants</p>

  <p class='faqID'>Letztes Update: 02.03.2021</p>

  <div id="toc" class="toc">
    <div id="toctitle">
      <h2>Inhalt</h2>
    </div>

    <ul>
      <li class="toclevel-1 tocsection-1"><a href="#Global_Functions_for_use_across_Origin_sessions"><span class="tocnumber">1</span> <span class="toctext">Globale Funktionen zur Nutzung über mehrere Origin-Sitzungen hinweg</span></a></li>

      <li class="toclevel-1 tocsection-2"><a href="#Global_Constants_and_Variables_for_use_across_Origin_sessions"><span class="tocnumber">2</span> <span class="toctext">Globale Konstanten und Variablen zur Nutzung über mehrere Origin-Sitzungen hinweg</span></a></li>

      <li class="toclevel-1 tocsection-3"><a href="#Constants_and_Variables_in_the_current_Origin_Session"><span class="tocnumber">3</span> <span class="toctext">Konstanten und Variablen in der aktuellen Origin-Sitzung</span></a></li>

      <li class="toclevel-1 tocsection-4"><a href="#Constants_and_Variables_specific_to_an_Origin_Project"><span class="tocnumber">4</span> <span class="toctext">Konstanten und Variablen, die für ein Origin-Projekt spezifisch sind</span></a></li>

      <li class="toclevel-1 tocsection-5"><a href="#Variables_specific_to_a_Worksheet"><span class="tocnumber">5</span> <span class="toctext">Variablen, die für ein Arbeitsblatt spezifisch sind</span></a></li>

      <li class="toclevel-1 tocsection-6"><a href="#Constants_in_a_Fitting_Function"><span class="tocnumber">6</span> <span class="toctext">Konstanten in einer Anpassungsfunktion</span></a></li>
    </ul>
  </div>

  <h2><a name="Global_Functions_for_use_across_Origin_sessions"></a><span class="mw-headline">Globale Funktionen zur Nutzung über mehrere Origin-Sitzungen hinweg</span></h2>

  <p>Um eine globale Funktion zu definieren, die über mehrere Origin-Sitzungen hinweg verwendet werden soll, lesen Sie <a class="external text" href="http://www.originlab.com/doc/LabTalk/guide/On-Starting-Origin#Defining_a_global_function" target="_blank">diese Seite</a>.</p>

  <p>Weitere Informationen zum Umfang einer Funktion können Sie auf <a class="external text" href="http://www.originlab.com/doc/LabTalk/guide/Functions#Scope_of_Functionsscope_of_a_function" target="_blank">dieser Seite</a> nachlesen.</p>

  <h2><a name="Global_Constants_and_Variables_for_use_across_Origin_sessions"></a><span class="mw-headline">Globale Konstanten und Variablen zur Nutzung über mehrere Origin-Sitzungen hinweg</span></h2>

  <p>Beim Starten von Origin wird eine Textdatei im Anwenderdateiordner mit dem Namen CONST.CNF ausgelesen. Wenn Sie mathematische Konstanten haben, mit denen Sie regelmäßig im Rahmen Ihrer Arbeit zu tun haben, dann ist die Datei CONST.CNF ein guter Ort, um sie zu definieren, da sie hier immer zur Verfügung stehen, wenn Origin ausgeführt wird.</p>

  <ol>
    <li>Sollte Origin gerade ausgeführt werden, schließen Sie das Programm.</li>

    <li>Öffnen Sie die Datei CONST.CNF im Anwenderdateiordner oder öffnen Sie eine neue Seite in einem Texteditor (z. B. Notepad) und geben Sie die folgenden Informationen ein:</li>

    <li style="list-style: none">
      <pre class="lt" style="font-family:monospace;">
const e <span style="color: #000080;">=</span> <span style="color: #0000dd;">2.718281828459045</span> <span style="color: #008000;">//Euler's number</span>
</pre>
    </li>

    <li>Benennen Sie CONST.CNF und speichern Sie die Datei in Ihrem <a href="../../QuickHelp/QuickHelp/What_is_the_User_Files_Folder.html" title="QuickHelp:What is the User Files Folder">Anwenderdateiordner (UFF)</a>.</li>

    <li>Um die Konstanten und Variablenwerte zu überprüfen, führen Sie Origin aus, öffnen Sie das Skriptfenster und geben Sie den Namen der Konstanten oder Variablen ein, gefolgt von "=", und drücken Sie ENTER.</li>
  </ol>

  <h2><a name="Constants_and_Variables_in_the_current_Origin_Session"></a><span class="mw-headline">Konstanten und Variablen in der aktuellen Origin-Sitzung</span></h2>

  <p>Um Konstanten und Variablen für die aktuelle Sitzung von Origin zu definieren, können Sie sie einfach mit Hilfe des Skriptfensters definieren:</p>

  <ol>
    <li>Öffnen Sie das Skriptfenster über das Menü <b>Fenster: Skriptfenster</b>.</li>

    <li>Geben Sie die gewünschten Zuweisungen für Konstanten bzw. Variablen ein und drücken Sie <i>Enter</i> am Ende jeder Zeile, zum Beispiel:
      <pre>
const myconst = 1.234; double myvar = 12.34; int mynum = 127;
</pre>
    </li>
  </ol>

  <p>Danach kann für jegliche Berechnungen vom Skriptfenster bzw. von einem anderen Skript ausführenden Fenster wie dem Dialog <b>Werte setzen</b> aus auf diese Konstanten und Variablen zugegriffen werden.</p>

  <h2><a name="Constants_and_Variables_specific_to_an_Origin_Project"></a><span class="mw-headline">Konstanten und Variablen, die für ein Origin-Projekt spezifisch sind</span></h2>

  <p>Um Konstanten und Variablen zu definieren, die für ein Projekt spezifisch sind, können Sie dies in der an das Projekt angehängten Datei <b>ProjectEvents.OGS</b> tun:</p>

  <ol>
    <li>Öffnen Sie den <b>Code Builder</b> im Menü <b>Ansicht: Code Builder</b>, erweitern Sie im linken Bedienfeld den Baum <b>Projekt</b> und führen Sie einen Doppelklick aus, um <b>ProjectEvents.ogs</b> zu öffnen.</li>

    <li>Fügen Sie folgende Codes in den Abschnitt <b>AfterOpenDoc</b> ein und speichern Sie die Datei und das Projekt.

      <ul>
        <li>@global=1;</li>

        <li>Ihre Variablen und Konstanten definieren</li>
      </ul>
    </li>
  </ol>

  <p>Diese Definitionen sind dann lokal für das Projekt.</p>

  <p>Das folgende Mini-Tutorial zeigt, wie eine benutzerdefinierte Variable auf Origins Projektebene hinzugefügt und dann verwendet wird.</p>

  <table class="noborder">
    <tr>
      <td style="vertical-align:top" width="60"><img src="../images/How_do_I_define_global_constants/Tutorial_icon.png" width="57" border="0" alt=""></td>

      <td>
        <ol>
          <li>Öffnen Sie ein neues Projekt und wählen Sie <b>Ansicht: Code Builder</b> im Menü, um den Code Builder zu öffnen.</li>

          <li>Erweitern Sie den Zweig des Projekts im linken Feld und klicken Sie doppelt, um die Datei <b>ProjectEvents.OGS</b> zu öffnen. Diese Datei befindet sich standardmäßig in jedem neuen Projekt.</li>

          <li>Fügen Sie unter dem Abschnitt <b>[AfterOpenDoc]</b> die folgenden Codezeilen hinzu:
            <pre class="lt" style="font-family:monospace;">
@global<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>; double myconst <span style="color: #000080;">=</span> <span style="color: #0000dd;">20</span>;
</pre>
          </li>

          <li>Speichern Sie die Datei und schließen Sie den Code Builder.</li>

          <li>Speichern Sie in Origin das Projekt in einem gewünschten Ordner. Die OGS.Datei wird mit dem Projekt gespeichert, so dass die benutzerdefinierte Variable zur Verwendung in dem Projekt zur Verfügung steht.</li>

          <li>Öffnen Sie das gerade gespeicherte Projekt erneut. Dies führt dazu, dass der Abschnitt <b>[AfterOpenDoc]</b> ausgeführt und daher myconst definiert wird.</li>

          <li>Aktivieren Sie ein Arbeitsblatt und importieren Sie die Datei Samples\Signal Processing\fftfilter1.DAT.</li>

          <li>Fügen Sie eine weitere Spalte zu Ihrem Arbeitsblatt hinzu.</li>

          <li>Klicken Sie auf den Header der 3. Spalte, um diese zu markieren, klicken Sie dann mit der rechten Maustaste auf sie und wählen Sie <b>Spaltenwerte errechnen</b> im Kontextmenü.</li>

          <li>Geben Sie in dem sich öffnenden Dialog <b>Werte setzen</b> Folgendes in das Bearbeitungsfeld ein:<br>
          wcol(2)*myconst</li>

          <li>Speichern Sie jetzt das Projekt erneut und öffnen Sie es erneut. Wählen Sie <b>Fenster: Skriptfenster</b> im Menü.</li>

          <li>Geben Sie das Skript unten im <b>Skriptfenster</b> ein und drücken Sie Enter, um die Werte von myconst und die Auslösung der Neuberechnung zu ändern.
            <pre class="lt" style="font-family:monospace;">
myconst <span style="color: #000080;">=</span> <span style="color: #0000dd;">30</span>;; <span style="color: #008000;">//changes myconst value in this session only. Not saved in project</span> run <span style="color: #000080;">-</span>auf <span style="color: #0000dd;">2</span> <span style="color: #0000dd;">1</span>; <span style="color: #008000;">//trigger recalculation</span>
</pre>
          </li>

          <li style="list-style: none">
            <table class="noborder">
              <tr>
                <td style="vertical-align:top" width="60"><img src="../images/How_do_I_define_global_constants/Tip_icon.png" width="57" border="0" alt=""></td>

                <td>
                  <p>Weitere Einzelheiten zu dem Befehl <i>run -auf</i> können <a class="external text" href="../../LabTalk/LabTalk/Run_(command).html#-auf.3B_Trigger_all_recalculation">hier</a> nachgelesen werden.</p>
                </td>
              </tr>
            </table>
          </li>
        </ol>
      </td>
    </tr>
  </table>

  <h2><a name="Variables_specific_to_a_Worksheet"></a><span class="mw-headline">Variablen, die für ein Arbeitsblatt spezifisch sind</span></h2>

  <p>Wenn Sie Variablen definieren müssen, die für ein Arbeitsblatt spezifisch sind, und dann die Ergebnisse in anderen Spalten durch Ändern dieser Variable aktualisieren möchten, befolgen Sie folgende Schritte:</p>

  <ol>
    <li>Fügen Sie einige Spalten zu dem aktuellen oder einem neuen Blatt hinzu und geben Sie die Variablennamen in die erste Spalte und die Werte in die zweite Spalte ein. Die Namen dienen ausschließlich zur Referenz.</li>

    <li>Wenn Sie den Dialog <b>Werte setzen</b> zum Berechnen der Werte für andere Spalten nutzen, können Sie das Bedienfeld <b>Skript vor Anwenden der Formel</b> verwenden, um lokale Variablen in Ihrem Skript zu definieren, die auf spezifische Zellen Ihrer Variablenspalten hinweisen, und sie dann in Ihrer Spaltenformel im oberen Bedienfeld einbinden. Sollte der Neuberechnungsmodus auf Auto oder Manuell gesetzt sein, können Sie die Variablenwerte einfach ändern und die berechneten Werte aktualisieren. In der <a class="external text" href="../../UserGuide/Category/Using_Formulae_to_Set_or_Transform_Worksheet_Column_Values.html">Hilfe</a> zum Dialog <b>Werte setzen</b> finden Sie weitere Informationen.</li>
  </ol>

  <h2><a name="Constants_in_a_Fitting_Function"></a><span class="mw-headline">Konstanten in einer Anpassungsfunktion</span></h2>

  <p>Die Seite <b>Variablen und Parameter</b> des Assistenten <b>Fitfunktionen erstellen</b> enthält ein Bearbeitungsfeld zum Definieren von Konstanten. Die Konstanten können dann zugewiesene Werte auf der Registerkarte <b>Konstanten</b> der Seite sein, auf der der Funktionskörper und die Parameter definiert werden.</p>

  <p>Weitere Einzelheiten finden Sie unter <a class="external text" href="../../LabTalk/LabTalk/Data_Types_and_Variables.html#Scope_of_Variables">Umfang der Variablen</a>.</p>

  <p>&#160;</p>
  <hr class='keywordshr'>

  <p><span class='keywords'>Schlüsselwörter:</span><span class='keywordsInput'>Variable, Variable definieren, Konstanten, Funktionen, globale Variable, @glob, @global, Projektvariable, ORGSYS.CNF, Werte setzen, Skript vor Anwenden der Formel, ProjectEvents.OGS, Skriptfenster</span></p>
