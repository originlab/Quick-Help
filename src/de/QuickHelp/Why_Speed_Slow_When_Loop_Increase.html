<h1 class="firstHeading">FAQ-1135 Why is speed slower when loop increases?</h1>

  <p class='urlname' style='display: none'>Why_Speed_Slow_When_Loop_Increase</p>

  <p class='faqID'>Last Update: 5/6/2022</p>

  <p>Each loop is slower when number of loop increases if add columns and set designation take time when number of columns in the existing sheet is large:</p>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">//[Book1]1! already has 2450x3 columns</span>
rw<span style="color: #000080;">=</span><span style="color: #0000dd;">2450</span>;
sec;
loop <span style="color: #000000;">(</span>tt,<span style="color: #0000dd;">1</span>,<span style="color: #0000dd;">50</span><span style="color: #000000;">)</span> 
<span style="color: #000000;">{</span>
ncol <span style="color: #000080;">=</span> rw<span style="color: #000080;">*</span><span style="color: #0000dd;">3</span>;

<span style="color: #008000;">//access non-existent column, so it will add column</span>
range dis3<span style="color: #000080;">=</span><span style="color: #000000;">[</span>Book1<span style="color: #000000;">]</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span>col<span style="color: #000000;">(</span><span style="color: #000080;">$</span><span style="color: #000000;">(</span>ncol<span style="color: #000080;">+</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;  
range vel3<span style="color: #000080;">=</span><span style="color: #000000;">[</span>Book1<span style="color: #000000;">]</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span>col<span style="color: #000000;">(</span><span style="color: #000080;">$</span><span style="color: #000000;">(</span>ncol<span style="color: #000080;">+</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>; 
range vel3a<span style="color: #000080;">=</span><span style="color: #000000;">[</span>Book1<span style="color: #000000;">]</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span>col<span style="color: #000000;">(</span><span style="color: #000080;">$</span><span style="color: #000000;">(</span>ncol<span style="color: #000080;">+</span><span style="color: #0000dd;">3</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span>;

dis3<span style="color: #000000;">[</span>L<span style="color: #000000;">]</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>f<span style="color: #000080;">$</span><span style="color: #000000;">(</span>tt<span style="color: #000000;">)</span>dis;
vel3<span style="color: #000000;">[</span>L<span style="color: #000000;">]</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>f<span style="color: #000080;">$</span><span style="color: #000000;">(</span>tt<span style="color: #000000;">)</span>vel;
vel3a<span style="color: #000000;">[</span>L<span style="color: #000000;">]</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>f<span style="color: #000080;">$</span><span style="color: #000000;">(</span>tt<span style="color: #000000;">)</span>vela;

<span style="color: #008000;">//set designation take time when number of columns in the existing sheet is large</span>
dis3.<span style="color: #000080;">type</span><span style="color: #000080;">=</span><span style="color: #0000dd;">4</span>;
vel3.<span style="color: #000080;">type</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
vel3a.<span style="color: #000080;">type</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;

rw<span style="color: #000080;">=</span>rw<span style="color: #000080;">+</span><span style="color: #0000dd;">1</span>;
<span style="color: #000000;">}</span>;
</pre>

  <p>So we need to try to avoid above actions inside a loop, i.e. prepare the whole worksheet first before the loop:</p>
  <pre class="lt" style="font-family:monospace;">
int nloop <span style="color: #000080;">=</span> <span style="color: #0000dd;">50</span>;

<span style="color: #008000;">//specify the worksheet</span>
range rWa <span style="color: #000080;">=</span> <span style="color: #000000;">[</span>Book4<span style="color: #000000;">]</span><span style="color: #0000dd;">1</span><span style="color: #000080;">!</span>;
int oldcol <span style="color: #000080;">=</span> rWa.<span style="color: #000080;">nCols</span>;

<span style="color: #008000;">//add columns</span>
rWa.<span style="color: #000080;">nCols</span> <span style="color: #000080;">=</span> rWa.<span style="color: #000080;">nCols</span> <span style="color: #000080;">+</span> nloop<span style="color: #000080;">*</span><span style="color: #0000dd;">3</span>;

<span style="color: #008000;">//set designations</span>
coldesig desig<span style="color: #000000;">:</span><span style="color: #000080;">=</span>X2Y rng<span style="color: #000000;">:</span><span style="color: #000080;">=</span><span style="color: #000080;">%</span><span style="color: #000000;">(</span>rWa<span style="color: #000000;">)</span><span style="color: #000080;">$</span><span style="color: #000000;">(</span>oldcol<span style="color: #000080;">+</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span><span style="color: #000000;">:</span><span style="color: #000080;">$</span><span style="color: #000000;">(</span>rWa.<span style="color: #000080;">nCols</span><span style="color: #000000;">)</span>;

loop <span style="color: #000000;">(</span>tt,<span style="color: #0000dd;">1</span>,nloop<span style="color: #000000;">)</span> 
<span style="color: #000000;">{</span>
range dis3<span style="color: #000080;">=</span><span style="color: #000080;">%</span><span style="color: #000000;">(</span>rWa<span style="color: #000000;">)</span><span style="color: #000080;">$</span><span style="color: #000000;">(</span>oldcol<span style="color: #000080;">+</span><span style="color: #0000dd;">3</span><span style="color: #000080;">*</span>tt<span style="color: #000080;">-</span><span style="color: #0000dd;">2</span><span style="color: #000000;">)</span>;
range vel3<span style="color: #000080;">=</span><span style="color: #000080;">%</span><span style="color: #000000;">(</span>rWa<span style="color: #000000;">)</span><span style="color: #000080;">$</span><span style="color: #000000;">(</span>oldcol<span style="color: #000080;">+</span><span style="color: #0000dd;">3</span><span style="color: #000080;">*</span>tt<span style="color: #000080;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">)</span>;
range vel3a<span style="color: #000080;">=</span><span style="color: #000080;">%</span><span style="color: #000000;">(</span>rWa<span style="color: #000000;">)</span><span style="color: #000080;">$</span><span style="color: #000000;">(</span>oldcol<span style="color: #000080;">+</span><span style="color: #0000dd;">3</span><span style="color: #000080;">*</span>tt<span style="color: #000000;">)</span>;

dis3<span style="color: #000000;">[</span>L<span style="color: #000000;">]</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>f<span style="color: #000080;">$</span><span style="color: #000000;">(</span>tt<span style="color: #000000;">)</span>dis;
vel3<span style="color: #000000;">[</span>L<span style="color: #000000;">]</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>f<span style="color: #000080;">$</span><span style="color: #000000;">(</span>tt<span style="color: #000000;">)</span>vel;
vel3a<span style="color: #000000;">[</span>L<span style="color: #000000;">]</span><span style="color: #000080;">$</span><span style="color: #000080;">=</span>f<span style="color: #000080;">$</span><span style="color: #000000;">(</span>tt<span style="color: #000000;">)</span>vela;

<span style="color: #000000;">}</span>
</pre>

  <p> </p>
  <hr class='keywordshr'>

  <p><span class='keywords'>Keywords:</span><span class='keywordsInput'>LabTalk, loop</span></p>
