<h1 class="firstHeading">FAQ-633 Wie zeichne ich eine Linie zwischen zwei Punkten, um die Werte für Steigung und Schnittpunkt mit der Y-Achse zu finden?</h1>

  <p class='urlname' style='display: none'>Two-Points-Slope</p>

  <p class='faqID'>Letztes Update: 04.02.2015</p>

  <p>Mit diesem LabTalk-Skript können Anwender die zwei Datenpunkte grafisch auswählen. Sobald diese zwei Punkte gewählt sind, wird eine Linie zwischen ihnen gezeichnet und die Werte der Steigung und des Schnittpunkts mit der Y-Achse werden als eine Textbeschriftung im Diagramm angezeigt.</p>
  <pre class="lt" style="font-family:monospace;">
def EndToolbox <span style="color: #000000;">{</span> <span style="color: #000080;">%</span>A<span style="color: #000080;">=</span>getpts.<span style="color: #000080;">xdata</span><span style="color: #000080;">$</span>; <span style="color: #000080;">%</span>B<span style="color: #000080;">=</span>getpts.<span style="color: #000080;">data</span><span style="color: #000080;">$</span>; slope<span style="color: #000080;">=</span><span style="color: #000000;">(</span><span style="color: #000080;">%</span>B<span style="color: #000000;">(</span><span style="color: #000080;">%</span>A<span style="color: #000000;">[</span><span style="color: #0000dd;">2</span><span style="color: #000000;">]</span><span style="color: #000000;">)</span><span style="color: #000080;">-%</span>B<span style="color: #000000;">(</span><span style="color: #000080;">%</span>A<span style="color: #000000;">[</span><span style="color: #0000dd;">1</span><span style="color: #000000;">]</span><span style="color: #000000;">)</span><span style="color: #000000;">)</span><span style="color: #000080;">/</span><span style="color: #000000;">(</span><span style="color: #000080;">%</span>A<span style="color: #000000;">[</span><span style="color: #0000dd;">2</span><span style="color: #000000;">]</span><span style="color: #000080;">-%</span>A<span style="color: #000000;">[</span><span style="color: #0000dd;">1</span><span style="color: #000000;">]</span><span style="color: #000000;">)</span>; yintercept<span style="color: #000080;">=</span><span style="color: #000080;">%</span>B<span style="color: #000000;">(</span><span style="color: #000080;">%</span>A<span style="color: #000000;">[</span><span style="color: #0000dd;">2</span><span style="color: #000000;">]</span><span style="color: #000000;">)</span><span style="color: #000080;">-</span>slope<span style="color: #000080;">*%</span>A<span style="color: #000000;">[</span><span style="color: #0000dd;">2</span><span style="color: #000000;">]</span>; <span style="color: #000080;">%</span>Z<span style="color: #000080;">=</span><span style="color: #ff00ff;">"slope=$(slope) yintercept=$(yintercept)"</span>; label <span style="color: #000080;">-</span>p <span style="color: #0000dd;">10</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">-</span>s <span style="color: #000080;">-</span>sa <span style="color: #000080;">-</span>n Ltext <span style="color: #000080;">%</span>Z; Ltext.<span style="color: #000080;">background</span><span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>; xb1<span style="color: #000080;">=</span><span style="color: #000080;">%</span>A<span style="color: #000000;">[</span><span style="color: #0000dd;">1</span><span style="color: #000000;">]</span>;xb2<span style="color: #000080;">=</span><span style="color: #000080;">%</span>A<span style="color: #000000;">[</span><span style="color: #0000dd;">2</span><span style="color: #000000;">]</span>;yb1<span style="color: #000080;">=</span><span style="color: #000080;">%</span>B<span style="color: #000000;">(</span><span style="color: #000080;">%</span>A<span style="color: #000000;">[</span><span style="color: #0000dd;">1</span><span style="color: #000000;">]</span><span style="color: #000000;">)</span>;yb2<span style="color: #000080;">=</span><span style="color: #000080;">%</span>B<span style="color: #000000;">(</span><span style="color: #000080;">%</span>A<span style="color: #000000;">[</span><span style="color: #0000dd;">2</span><span style="color: #000000;">]</span><span style="color: #000000;">)</span>; draw <span style="color: #000080;">-</span>n Lline <span style="color: #000080;">-</span>l <span style="color: #000000;">{</span>xb1,yb1,xb2,yb2<span style="color: #000000;">}</span>; Lline.<span style="color: #000080;">color</span><span style="color: #000080;">=</span><span style="color: #0000dd;">2</span>;  <span style="color: #008000;">//set color to red</span> delete <span style="color: #000080;">-</span>v xb1;delete <span style="color: #000080;">-</span>v xb2;delete <span style="color: #000080;">-</span>v yb1;delete <span style="color: #000080;">-</span>v yb2; delete <span style="color: #000080;">-</span>v slope;delete <span style="color: #000080;">-</span>v yintercept; doc <span style="color: #000080;">-</span>uw;  <span style="color: #008000;">//window refresh</span> <span style="color: #000000;">}</span> getpts <span style="color: #0000dd;">2</span>; <span style="color: #008000;">//use data reader to select two points</span>
</pre>

  <p>Das Skript kann vom Skriptfenster aus ausgeführt oder in einer OGS-Datei gespeichert und dann mit einer Symbolleistenschaltfläche verbunden werden.</p>

  <table class="note">
    <tr>
      <td><b>Hinweis:</b> Das Skript verwendet einen Datensatz als eine Funktion, um den entsprechenden Y-Wert für einen gegebenen X-Wert zu finden. Gibt es duplizierte X-Werte, ist der wiedergegebene Wert der Y-Wert für den ersten gefundenen X-Wert.</td>
    </tr>
  </table>
  <hr class='keywordshr'>

  <p><span class='keywords'>Schlüsselwörter:</span><span class='keywordsInput'>LabTalk, Lineare Kurvenanpassung</span></p>
