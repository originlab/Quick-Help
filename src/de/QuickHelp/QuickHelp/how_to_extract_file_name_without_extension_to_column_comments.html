<h1 class="firstHeading">FAQ-870 Wie extrahiere ich den Dateinamen ohne Erweiterung in die Spaltenkommentare?</h1>

  <p class='urlname' style='display: none'>extract-filename-without-extension</p>

  <p class='faqID'>Letztes Update: 06.01.2019</p>

  <h2><a name="Origin_2017_SR2_and_higher"></a><span class="mw-headline">Origin 2017 SR2 und höher</span></h2>

  <p>Seit Origin 2017 SR2 können Sie im Zweig <b>Arbeitsblatt und Arbeitsmappe (um)benennen</b> von allen Importhilfsmitteln das Kontrollkästchen <b>Dateiname an Spaltenkommentar anhängen</b> aktivieren und das Kontrollkästchen <b>Den Dateipfad einbinden, wenn der Dateiname angehängt wird</b> deaktivieren, um den Dateinamen ohne Erweiterung in die Spalte Kommentare zu extrahieren.</p>

  <dl>
    <dd><a class="image"><img alt="Qh870 1.png" src="../images/How_to_extract_file_name_without_extension_to_column_comments/300px-Qh870_1.png" width="300"></a></dd>
  </dl>

  <table class="note">
    <tr>
      <td><b>Hinweise:</b> Wenn Sie beim Anhängen des Dateinamens an die Spalte Kommentare die Dateierweiterung einschließen möchten, können Sie den <a class="external text" href="../../UserGuide/UserGuide/Set_System_Variables_Dialog_Box.html">Dialog <b>Systemvariablen festlegen</b></a> verwenden. Wählen Sie <b>Einstellungen: Systemvariablen</b>, um den Dialog zu öffnen. Setzen Sie IFE auf <b>0</b>.</td>
    </tr>
  </table>

  <h2><a name="Origin_2017_SR1_and_older"></a><span class="mw-headline">Origin 2017 SR1 und älter</span></h2>

  <p>Bei älteren Versionen wird bei Aktivierung von "Dateiname an Spaltenkommentar anhängen" die Dateierweiterung standardmäßig eingebunden. Das heißt, Sie müssen Daten über den <b>Importassistenten</b> importieren. Dabei können Sie einen neuen Parameter in der Arbeitsmappe erstellen, der den Dateinamen ohne Dateierweiterung festlegt, und dann den Dateinamen aus der Parameterzeile in die Spalte Kommentare kopieren.</p>

  <ol>
    <li>Wählen Sie <b>Daten: Aus Datei importieren: Importassistent</b>.</li>

    <li>Wählen Sie Ihre Daten unter <b>Datenquelle</b> aus. Wählen Sie den gewünschten Importmodus unter <b>Importmodus</b> aus. Klicken Sie auf <b>Weiter</b>.</li>

    <li>Passen Sie die Einstellungen der Headerzeilen auf der Seite Headerzeilen nach Bedarf an. Klicken Sie auf <b>Weiter</b>.</li>

    <li>Aktivieren Sie unter <b>Extrahieren von Variablen aus Dateinamen und Dateiheader</b> die Kontrollkästchen <b>Bestimmen Sie den Speicherort von Variablennamen und Werten unter Verwendung von Trennzeichen</b> und <b>Anwenderparameterzeilen für jede Variable erstellen</b>. Wählen Sie <b>Weiter</b>.

      <dl>
        <dd><a class="image"><img alt="Qh870 2.png" src="../images/How_to_extract_file_name_without_extension_to_column_comments/350px-Qh870_2.png" width="350"></a></dd>
      </dl>
    </li>

    <li>Auf der folgenden Seite sollte das weiße Feld oben den Dateinamen mit und ohne Erweiterung auflisten. Wählen Sie unter <b>Variable</b> die hinzuzufügende Zeile. Wählen Sie <b>Variablenname eingeben</b> und legen Sie den Namen fest. Wählen Sie <b>Hinzufügen</b>. Dies legt Ihre neue Variable in dem grauen Feld fest. Wählen Sie <b>Weiter</b>.

      <dl>
        <dd><a class="image"><img alt="Qh870 3.png" src="../images/How_to_extract_file_name_without_extension_to_column_comments/450px-Qh870_3.png" width="450"></a></dd>
      </dl>
    </li>

    <li>Passen Sie, wie aufgefordert, die Datenspalten benutzerdefiniert an und überspringen Sie, wie aufgefordert, Spalteneinstellungen. Klicken Sie auf <b>Weiter</b>, um zur Seite Filter speichern zu gelangen.</li>

    <li>Unter <b>Filter speichern</b> können Sie diese Einstellung des Importassistenten speichern, so dass Sie diese Schritte nicht jedes Mal beim Importieren einer Datei wiederholen müssen. Aktivieren Sie <b>Filter speichern</b> und geben Sie unter <b>Filterbeschreibung</b> einen Namen für Ihren Filter ein.</li>

    <li>Um die Dateinamen in jeder Spalte innerhalb der neuen Parameter zu nehmen und in die Kommentarzeile einzugeben, aktivieren Sie das Kontrollkästchen <b>Erweiterte Filteroptionen festlegen</b>. Klicken Sie auf <b>Weiter</b>.</li>

    <li>Geben Sie im weißen Feld unter <b>Skript nach allen importierten Dateien</b> das Skript unten ein und klicken Sie dann auf <b>Fertigstellen</b>. Beachten Sie, dass <i>fname</i> die definierte Variable ist, die wir für den neuen erstellten Parameter vergeben haben:</li>
  </ol>
  <pre class="lt" style="font-family:monospace;">
<span style="color: #008000;">//The goal of this loop is to 1) place all the columns in fname row into the comments row and to 2) hide fname row</span> loop <span style="color: #000000;">(</span>j,<span style="color: #0000dd;">1</span>,wks.<span style="color: #000080;">ncols</span><span style="color: #000000;">)</span> <span style="color: #000000;">{</span> wcol<span style="color: #000000;">(</span>j<span style="color: #000000;">)</span><span style="color: #000000;">[</span>C<span style="color: #000000;">]</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span>wcol<span style="color: #000000;">(</span>j<span style="color: #000000;">)</span><span style="color: #000000;">[</span>fname<span style="color: #000000;">]</span><span style="color: #000080;">$</span>; <span style="color: #008000;">//places fname into comments</span> <span style="color: #000000;">}</span> wks.<span style="color: #000080;">UserParam1</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>; <span style="color: #008000;">//hides fname row in the workbook</span>
</pre>

  <p><br>
  Um diese Filtereinstellung erneut zu verwenden, wenn Sie den <b>Importassistenten</b> verwendne, müssen Sie anfangs <b>Passende Filter für Datentyp und Dateinamen anzeigen</b> unter <b>Importfilter</b> auswählen und dann den gewünschten Filter in der Auswahlliste <b>Importfilter für aktuellen Datentyp</b>.</p>

  <p>Wenn Sie die Schritte 8 und 9 nicht machen, wird der Dateiname in die neue Parameterzeile importiert. Wenn Sie zeichnen, führt die Legende automatisch die Spalten aus den Kommentaren auf. Um die Legende mit dem Dateinamen zu aktualisieren, müssen Sie entweder</p>

  <ul>
    <li>die Legende als Ihren neuen Parameter vordefinieren</li>
  </ul>

  <p>oder</p>

  <ul>
    <li>die neue Parameterzeile manuell kopieren und in die Kommentare einfügen.</li>
  </ul>
  <hr class='keywordshr'>

  <p><span class='keywords'>Schlüsselwörter:</span><span class='keywordsInput'>Dateiname extrahieren, Dateierweiterung kürzen</span></p>
