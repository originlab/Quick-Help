<h1 class="firstHeading">FAQ-872 Why can't I set column names in my script, e.g. using wks.addCol or wks.col.name?</h1>

  <p class='urlname' style='display: none'>Set-column-names-in-script</p>

  <p class='faqID'>Last Update: 9/25/2018</p>

  <p>Starting with <b>Origin 2017</b>, workbooks support a simplified worksheet cell notation, similar to MS Excel. When this cell notation is turned on -- indicated by this icon in the upper-left corner of the workbook page <a class="image"><img alt="Spreadsheet cell notation mode.png" src="../images/Set_column_names_in_script_using_wks.addCol_wks.col.name/Spreadsheet_cell_notation_mode.png" width="20"></a> -- <a class="external text" href="../../UserGuide/UserGuide/Column_Short_Name_Restriction.html">column Short Names are <i><b>not editable and cannot be reordered</b></i></a> even via LabTalk.</p>

  <p>In <b>Origin 2017</b>, <b>Origin 2018</b>, and <b>Origin 2018b</b>, workbooks created with LabTalk commands like <code>win -t</code> or the X-Function <code>newbook</code> have this column naming restriction turned off by default. But, starting with <b>Origin 2019</b>, those workbooks will have the column naming restriction turned <b>on</b> by default. This is a behavioral change that LabTalk scripters should take notice of.</p>

  <p>If you want this restriction turned off so you can change column short names in a workbook created by either the <code>win -t</code> command or the <code>newbook</code> X-Function, you should run the following line code (assuming the new book is active):</p>
  <pre class="lt" style="font-family:monospace;">
page.<span style="color: #000080;">XLColName</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>; <span style="color: #008000;">// remove column short name restriction</span>
</pre>

  <p>If you need the same code to work on Origin versions prior to 2017, then you can insert this variation before your renaming code:</p>
  <pre class="lt" style="font-family:monospace;">
if<span style="color: #000000;">(</span>@v<span style="color: #000080;">&gt;=</span><span style="color: #0000dd;">9.4</span><span style="color: #000000;">)</span> page.<span style="color: #000080;">xlcolname</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>;
</pre>

  <table class="noborder">
    <tr>
      <td style="vertical-align:top" width="60"><img src="../images/Set_column_names_in_script_using_wks.addCol_wks.col.name/Tip_icon.png" width="57" border="0" alt=""></td>

      <td>
        <p><b>If you are using Origin 2019 or later and want to make sure the column naming restriction is turned off for all calls to <code>win -t</code> or <code>newbook</code> without modifying each individual script, you can set the system variable <code>@RCN=7</code> in the System Variables dialog.</b></p>
      </td>
    </tr>
  </table>

  <p><br>
  <br>
  <i><b>Related FAQs:</b></i></p>

  <ul>
    <li><a href="../../QuickHelp/QuickHelp/Why_column_formula_not_update.html" title="QuickHelp:Why column formula not update">FAQ-847: Why are my column formulas not updating when I insert or delete columns?</a></li>

    <li><a href="../../QuickHelp/QuickHelp/Turn_off_spreadsheet_cell_notation.html" title="QuickHelp:Turn off spreadsheet cell notation">FAQ-849: Can I turn off or selectively control use of spreadsheet cell notation in my workbooks?</a></li>
  </ul>
  <hr class='keywordshr'>

  <p><span class='keywords'>Keywords:</span><span class='keywordsInput'>short name restriction, spreadsheet cell notation, reorder</span></p>
