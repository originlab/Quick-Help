<h1 class="firstHeading">2.85 FAQ-870 How to extract file name without extension to column comments?</h1><p class='urlname' style='display: none'>extract-filename-without-extension</p>
<p class='faqID'>Last Update: 1/7/2019</p>
<h2><a name="Origin_2017_SR2_and_higher"></a><span class="mw-headline">Origin 2017 SR2 and higher</span></h2>
<p>From Origin 2017 SR2, you can check <b>Append Filename to Column Comment</b> and uncheck <b>Include File Path when Appending Filename</b> under <b>(Re)naming Worksheet and Workbook</b> branch of any import tools to extract file name without extension to column Comments. 
</p>
<dl><dd> <a  class="image"><img alt="Qh870 1.png" src="../images/How_to_extract_file_name_without_extension_to_column_comments/300px-Qh870_1.png?v=51414" width="300"   /></a></dd></dl>
<table class="note">

<tr>
<td><b>Notes:</b>. If you want to include file extension when append file name to column Comments, you can use the <a class="external text" href="../../UserGuide/UserGuide/Set_System_Variables_Dialog_Box.html"><b>Set System Variables</b> dialog</a> for the job. Choose <b>Preferences: System Variables</b> to open the dialog. Set IFE to <b>0</b>.
</td></tr></table>
<h2><a name="Origin_2017_SR1_and_older"></a><span class="mw-headline">Origin 2017 SR1 and older</span></h2>
<p>For older versions, when checking "Append File name to Column Comments", file extension will be included by default. So you need to import data through <b>Import Wizard</b>, during which you can create a new parameter in the workbook that specifies the file name without file extension, and then copy file name from parameter row to column Comments. 
</p>
<ol><li> Select <b>Data: Import from File: Import Wizard</b>.</li>
<li> Select your data under <b>Data Source</b>. Select the desired import mode within <b>Import Mode</b>. Click <b>Next</b>.</li>
<li> Customize header lines settings on Header Lines page if needed. Click <b>Next</b>.</li>
<li> From <b>Extract variables from file names and file headers</b> select <b>Specify location of variable names and values using delimiters</b> checkbox and select <b>Create User Parameter rows for each variable</b>, Select <b>Next</b>. 
<dl><dd> <a  class="image"><img alt="Qh870 2.png" src="../images/How_to_extract_file_name_without_extension_to_column_comments/350px-Qh870_2.png?v=51421" width="350"   /></a></dd></dl></li>
<li> In the following page, the top white box should list the file name with and without the extension. Under <b>Variable</b>, select the line you wish to add. Select <b>Enter variable name</b> and specify the name. Select <b>Add</b>. This will specify your new variable in the grey box. Select <b>Next</b>.
<dl><dd> <a  class="image"><img alt="Qh870 3.png" src="../images/How_to_extract_file_name_without_extension_to_column_comments/450px-Qh870_3.png?v=51420" width="450"   /></a></dd></dl></li>
<li> Customize data column and skip column settings as prompted. Click <b>Next</b> under you see Save Filters page.</li>
<li> Under <b>Save filters</b>, you can save this import wizard setting so that you do not have to repeat these steps every time you import a file. Select <b>Save filter</b> checkbox and under <b>Filter Description</b> name your filter. </li>
<li> To take the file names in each column within the new parameter and put into the Comments row, select <b>Specify advanced filters options</b> checkbox. Click <b>Next</b>.</li>
<li> In the white box under <b>Script after All Files Imported</b> input the below script and then click <b>Finish</b>. Note <i>fname</i> is the defined variable we gave for the new parameter created: </li></ol>
<pre class="lt" style="font-family:monospace;"><span style="color: #008000;">//The goal of this loop is to 1) place all the columns in fname row into the comments row and to 2) hide fname row</span>
loop <span style="color: #000000;">&#40;</span>j,<span style="color: #0000dd;">1</span>,wks.<span style="color: #000080;">ncols</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
wcol<span style="color: #000000;">&#40;</span>j<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span>C<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span> <span style="color: #000080;">=</span>wcol<span style="color: #000000;">&#40;</span>j<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#91;</span>fname<span style="color: #000000;">&#93;</span><span style="color: #000080;">$</span>; <span style="color: #008000;">//places fname into comments</span>
<span style="color: #000000;">&#125;</span>
wks.<span style="color: #000080;">UserParam1</span><span style="color: #000080;">=</span><span style="color: #0000dd;">0</span>; <span style="color: #008000;">//hides fname row in the workbook</span></pre>
<p><br />
To use this filter setting again, when you select <b>Import Wizard</b> you must initially select <b>List filters applicable to both Data Type and file name</b> under <b>Import filter</b> and then select from <b>Import Filters to the current Data Type</b> drop-down to select the filter you want to use. 
</p><p>If you don't do steps 8 and 9, the file name will be imported into the new parameter row. When you plot, the legend automatically lists the columns from Comments. To update the legend with file name, you will need to either 
</p>
<ul><li> redefine the legend as your new parameter </li></ul>
<p>or  
</p>
<ul><li> Manually copy and paste the new parameter row into Comments. </li></ul>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>extract file name, trim file extension</span></p>






