<h1 class="firstHeading">3.85 FAQ-323 How to perform column calculation over a sliding window, such as moving average or moving standard deviation?</h1><p class='urlname' style='display: none'>cal-movavg-SCV</p>
<p class='faqID'>Last Update: 10/31/2022</p>
<h4><a name="Use_Built-in_Moving.2FRolling_Functions"></a><span class="mw-headline">Use Built-in Moving/Rolling Functions</span></h4>
<p>Origin provides several built-in functions that let you specify backward and/or forward window size:<br />
<a class="external text" href="../../LabTalk/LabTalk/Movavg_(function).html">Movavg</a>, 
<a class="external text" href="../../LabTalk/LabTalk/Emovavg_(function).html">Emovavg</a>, 
<a class="external text" href="../../LabTalk/LabTalk/Mmovavg_(function).html">Mmovavg</a>, 
<a class="external text" href="../../LabTalk/LabTalk/MovCoef_(function).html">Movcoef</a>, 
<a class="external text" href="../../LabTalk/LabTalk/Movrms_(function).html">Movrms</a>, 
<a class="external text" href="../../LabTalk/LabTalk/Movslope_(function).html">Movslope</a>, 
<a class="external text" href="../../LabTalk/LabTalk/Tmovavg_(function).html">Tmovavg</a>, and 
<a class="external text" href="../../LabTalk/LabTalk/Wmovavg_(function).html">Wmovavg</a>.
</p><p>For example, to use the <b>Movavg</b> function, in the <b>Set Values</b> dialog, do the following:
</p>
<ol><li> Select the column or cells where you want to put the result.</li>
<li> Select from menu <b>Column: Set Column Value...</b> to open the dialog (or press CTRL + Q from keyboard).</li>
<li> In the opened dialog, click <b>Function: Statistics: Movavg(vd,back,forward)</b> to auto-fill the movavg function in the column formula text box.</li>
<li> Replace <b>vd</b> with the range on which you want to compute a moving average.</li>
<li> Replace <b>back</b> with the backward offset respect to current position, and <b>forward</b> with the forward offset respect to current position.</li>
<li> Click the <b>OK</b> button.</li></ol>
<p><br />
</p>
<h4><a name="Modify_other_functions_to_be_Moving.2FRolling_Functions"></a><span class="mw-headline">Modify other functions to be Moving/Rolling Functions</span></h4>
<p>You can use sub-ranges in your Set Column Value formula to specify a sliding window.<br /><br />For example, to calculate the standard deviation over a window size of 11, you can specify sub-range in your formula, such as:
</p>
<pre class="lt" style="font-family:monospace;">StdDev<span style="color: #000000;">&#40;</span>A<span style="color: #000000;">&#91;</span>i<span style="color: #000080;">-</span><span style="color: #0000dd;">5</span><span style="color: #000000;">:</span>i<span style="color: #000080;">+</span><span style="color: #0000dd;">5</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span></pre>
<p>Calculating the moving standard deviation on large data sets may be very slow. In such cases, we can define the formula using embedded Python in Origin. In the example below, the <b>rolling()</b> function in the Pandas package is used which greatly expedites the calculation speed.
</p>
<dl><dd><br /><a  class="image"><img alt="PythonSVC.png" src="../images/How_do_I_calculate_a_moving_average/PythonSVC.png?v=70402" width="675"  /></a><br /><br /></dd></dl>
<p><br />
</p>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_do_I_calculate_a_moving_average/Tip_icon.png?v=8477" width="57"  border="0" /></td><td><p>Use the <b>Formula: Load Sample</b> menu in the <b>Set Values</b> dialog for examples on column value calculations.
</p></td></tr></table>
<p><br />
</p><p><br />
<br /><br />
Note: To calculate moving average on a plot, you can use <b>Analysis: Signal Processing: Smoothing</b> tool and set Method as Adjacent-Averaging.
</p>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>Moving, Rolling, Sliding, average, mean, standard deviation, std, SMA </span></p>


