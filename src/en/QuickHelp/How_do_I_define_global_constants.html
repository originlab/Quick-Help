<h1 class="firstHeading">4.1 FAQ-286 How do I define global functions, global variables, and constants?</h1><p class='urlname' style='display: none'>Global-Constants</p>
<p class='faqID'>Last Update: 6/3/2024</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Global_Functions_for_use_across_Origin_sessions"><span class="tocnumber">1</span> <span class="toctext">Global Functions for use across Origin sessions</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Global_Constants_and_Variables_for_use_across_Origin_sessions"><span class="tocnumber">2</span> <span class="toctext">Global Constants and Variables for use across Origin sessions</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Constants_and_Variables_in_the_current_Origin_Session"><span class="tocnumber">3</span> <span class="toctext">Constants and Variables in the current Origin Session</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Constants_and_Variables_specific_to_an_Origin_Project"><span class="tocnumber">4</span> <span class="toctext">Constants and Variables specific to an Origin Project</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Variables_specific_to_a_Worksheet"><span class="tocnumber">5</span> <span class="toctext">Variables specific to a Worksheet</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Constants_in_a_Fitting_Function"><span class="tocnumber">6</span> <span class="toctext">Constants in a Fitting Function</span></a></li>
</ul>
</div>

<h2><a name="Global_Functions_for_use_across_Origin_sessions"></a><span class="mw-headline">Global Functions for use across Origin sessions</span></h2>
<p>To define a global function for use across Origin sessions, view <a class="external text" href="http://www.originlab.com/doc/LabTalk/guide/On-Starting-Origin#Defining_a_global_function" target="_blank">this page</a>.
</p><p>For further information on scope of a function, refer to <a class="external text" href="http://www.originlab.com/doc/LabTalk/guide/Functions#Scope_of_Functionsscope_of_a_function" target="_blank">this page</a>.
</p>
<h2><a name="Global_Constants_and_Variables_for_use_across_Origin_sessions"></a><span class="mw-headline">Global Constants and Variables for use across Origin sessions</span></h2>
<p>When Origin starts, a text file in the user file folder named CONST.CNF is read. If you have mathematical constants that you regularly use in your work, the CONST.CNF file is a good place to define them, as they will always be available when Origin runs
</p>
<ol>
<li>If Origin is running, exit the program.</li>
<li>Open the CONST.CNF file under User File Folder or start a fresh page in a text editor (e.g. Notepad) and enter the following information:</li>
<pre class="lt" style="font-family:monospace;">const e <span style="color: #000080;">=</span> <span style="color: #0000dd;">2.718281828459045</span> <span style="color: #008000;">//Euler's number</span></pre>
<li>Name CONST.CNF and save the file to your <a href="../../QuickHelp/QuickHelp/What_is_the_User_Files_Folder.html" title="QuickHelp:What is the User Files Folder">User Files Folder (UFF)</a>. 
<li>To check your constant and variable values, run Origin, open the Script Window and type the name of the constant or variable, followed by "=" and press ENTER.
</ol>
<h2><a name="Constants_and_Variables_in_the_current_Origin_Session"></a><span class="mw-headline">Constants and Variables in the current Origin Session</span></h2>
<p>To define constants and variables for the current session of Origin, you can simply define them using the Script Window:
</p>
<ol>
<li>
Open Script Window using the menu <b>Window: Script Window</b>
</li>
<li>
Type desired constant or variable assignment and press <i>Enter</i> at end of each line, such as:
<pre>
const myconst = 1.234;
double myvar = 12.34;
int mynum = 127;
</pre>
</li>
</ol>
<p>Then any subsequent calculations in the script window, or any other location where script can be executed such as <b>Set Column Values</b> dialog, these constants and variables can be accessed.
</p>
<h2><a name="Constants_and_Variables_specific_to_an_Origin_Project"></a><span class="mw-headline">Constants and Variables specific to an Origin Project</span></h2>
<p>To define constants and variables specific to a project, you can define these in the <b>ProjectEvents.OGS</b> file attached to the project:
</p>
<ol><li> Open <b>Code Builder</b> from the <b>View: Code Builder</b> menu, and in the left panel, expand the <b>Project</b> tree and double-click to open <b>ProjectEvents.ogs</b></li>
<li>  Add following codes in the <b>AfterOpenDoc</b> section, and save the file and save the project
<ul><li> @global=1;</li>
<li> Define your variables and constants</li></ul></li></ol>
<p>These definitions will then be local to the project.
</p><p>The following mini tutorial shows how to add a user-defined variable at the Origin project level and then use that variable
</p>
<table class="noborder">
	<tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_do_I_define_global_constants/Tutorial_icon.png?v=0" width="57"  border="0" />
	</td>
	<td><ol>
<li> Start a new Project and use <b>View: Code Builder</b> menu item to open Code Builder.</li>
<li> Expand the Project branch on the left panel tree and double-click to open the <b>ProjectEvents.OGS</b> file. This file exists by default in any new Project. </li>
<li> Under the <b>[AfterOpenDoc]</b> section, add the following lines of code:
<pre class="lt" style="font-family:monospace;">@global<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span>;
double myconst <span style="color: #000080;">=</span> <span style="color: #0000dd;">20</span>;</pre> </li>
<li> Save the file and close Code Builder.</li>
<li> In Origin, save the Project to a desired folder location. The OGS file is saved with the Project, so the user-defined variable is available for use in the Project.</li>
<li> Open the just saved project again. This will trigger the <b>[AfterOpenDoc]</b> section to be executed and thus myconst to be defined.</li>
<li> Activate a worksheet and import the file Samples\Signal Processing\fftfilter1.DAT. </li>
<li> Add one more columns to the worksheet. </li>
<li> Click on the header of the 3rd column to select it, then right-click and select <b>Set Column Values...</b> from the context menu. </li>
<li> In the <b>Set Values</b> dialog that opens, enter the following in the edit box:<br />wcol(2)*myconst </li>
<li> Now save the Project again and re-open it. Choose <b>Window: Script Window</b> from Origin menu </li>
<li> Enter script below in the <b>Script Window</b> and press Enter to change the values of myconst and trigger recalculation. 
<pre class="lt" style="font-family:monospace;">myconst <span style="color: #000080;">=</span> <span style="color: #0000dd;">30</span>;; <span style="color: #008000;">//changes myconst value in this session only. Not saved in project</span>
run <span style="color: #000080;">-</span>auf <span style="color: #0000dd;">2</span> <span style="color: #0000dd;">1</span>; <span style="color: #008000;">//trigger recalculation</span></pre> </li>
<table class="noborder"><tr>
	<td style="vertical-align:top" width="60"><img src="../images/How_do_I_define_global_constants/Tip_icon.png?v=8477" width="57"  border="0" /></td><td><p>More details about <i>run -auf</i> command can be found <a class="external text" href="../../LabTalk/LabTalk/Run_(command).html#-auf.3B_Dirty_all_recalculation">here</a>.
</p></td></tr></table>
</ol>
</td></tr></table>
<h2><a name="Variables_specific_to_a_Worksheet"></a><span class="mw-headline">Variables specific to a Worksheet</span></h2>
<p>If you need to define some variables specific to a worksheet, and then update the results in other columns by changing this variable, follow these steps:
</p>
<ol><li> Add a couple of columns to the current sheet, or to a new sheet, and place the variable names in 1st column and the values in the 2nd column. The names are purely for reference.</li>
<li> When using <b>Set Values</b> dialog to compute values for other columns, you can then use the <b>Before Formula Script</b> panel to define local variables in your script to point to specific cells of your variables column, and then include them in your column formula in the upper panel. If the recalculation mode is set to Auto or Manual, then you can simply change the variable values and have the calculated values update. See the <a class="external text" href="../../UserGuide/Category/Using_Formulae_to_Set_or_Transform_Worksheet_Column_Values.html">help file section</a> on <b>Set Values</b> dialog for more information.</li></ol>
<h2><a name="Constants_in_a_Fitting_Function"></a><span class="mw-headline">Constants in a Fitting Function</span></h2>
<p>The <b>Variables and Parameters</b> page of the <b>Fitting Function Builder</b> wizard provides an edit box for defining constants. The constants can then be assigned values in the <b>Constants</b> tab of the page where the function body and the parameters are defined.
</p><p>For more details, please refer to <a class="external text" href="../../LabTalk/LabTalk/Data_Types_and_Variables.html#Scope_of_Variables">scope of variables</a>.
</p><p><br />
</p>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>variable, define variable, constants, functions, global variable, @glob, @global, project variable, ORGSYS.CNF, Set Values, Before Formula Script, ProjectEvents.OGS, Script Window</span></p>


