<h1 class="firstHeading">4.16 FAQ-375 How do I create custom toolbar buttons that run my script macros?</h1><p class='urlname' style='display: none'>Button-to-Run-LT-Script</p>
<p class='faqID'>Last Update: 4/12/2016</p>
<p>Buttons on a toolbar are a convenient way of running LabTalk script files. To create your own buttons, you need 3 files in order to create a new button group. The first is the LabTalk script file that contains the script that is executed when the user clicks a button. The second is the bitmap file that contains the image that is displayed on your button(s). The third file, automatically created for you, is an INI file.
</p><p>The INI file stores the name of the button group, the name of the bitmap file used to create the group, and the number of buttons that the group has.
</p><p>When creating a custom button group for export to an .OPX file, consider saving your button group's initialization file, bitmap file(s), script file(s), and any other support files to a user-created subfolder in your User Files Folder. When another Origin user installs your .OPX file, your custom subfolder will automatically be created in the user's User Files Folder, and this subfolder will contain the files for the custom button group. This allows you to keep your custom files separate from the other Origin files. 
</p><p>Please follow these steps to put everything together.
</p>
<ol><li> Use <b>Code Builder</b> to develop your LabTalk script OGS file, which contains one or more scripts, organized into different sections, to be associated with one or more buttons.</li>
<li> Create a bitmap file, using any program that will create a 16 color bitmap such as Window's Paint.</li>
<li> You can start with the built-in user defined toolbar bitmap with Window's Paint. Open <b>Userdef.bmp</b> found in your User Files Folder.  </li>
<li> The image height needs to remain at 16 and should not be changed. The image width should be 16 times the number of buttons needed. Each button is 16 pixels high by 16 pixels wide.</li>
<li> Edit each button as needed.</li>
<li> Save the BMP as a <b>16 Color Bitmap</b>.</li>
<li> In Origin, select <b>View: Toolbars</b> to open the Customize Toolbar dialog.</li>
<li> Click on the <b>Button Groups</b> tab.</li>
<li> Click the <b>New</b> button in the <b>Button Groups</b> to open the Create Button Group dialog.</li>
<li> Enter a new <b>Group</b> Name.</li>
<li> Specify the <b>Number of Buttons</b>.</li>
<li> Click the <b>Browse</b> button to locate your bitmap file. This file should be in your User Files Folder.</li>
<li> Click <b>OK</b>.</li>
<li> The Save As dialog will open. Enter the same name as that of your bitmap file. Click <b>OK</b> to save the INI file. Your group is added to the Groups list. When you select it you will see your button(s).</li>
<li> Click on one of the buttons to select it.</li>
<li> Click the <b>Settings</b> button, to open the Button Settings dialog.</li>
<li> Click the <b>Browse</b> button to locate your OGS file.</li>
<li> Enter the <b>Section Name</b> of the OGS file and any arguments in the <b>Argument</b> List.</li>
<li> Enter something descriptive in the <b>Tool Tip Text</b> box.</li>
<li> Enter a status bar message in the <b>Status Bar</b> text box.</li>
<li> Click <b>OK</b>.</li>
<li> Repeat steps 15-21 for each of the buttons in your Button Group.</li>
<li> Drag the first button out onto your Origin workspace.  A toolbar is created.  You can now drag all other buttons onto this toolbar. </li></ol>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>automate, click, repeat, button, bitmap, custom</span></p>






