<h1 class="firstHeading">2.17 FAQ-428 How to run LabTalk script after import?</h1><p class='urlname' style='display: none'>run-script-after-import</p>
<p class='faqID'>Last Update: 11/17/2020</p>
<p><br />
There are several options for running LabTalk script after import to do post-processing of data (calculations, formatting, analysis, plotting):
</p>
<ul><li> If you are using one of the new <a class="external text" href="../../UserGuide/Category/Data_Connector.html">Data Connector</a> import methods, you can embed LabTalk script directly in the worksheet. LabTalk script entered into <a class="external text" href="../../UserGuide/UserGuide/Script_tab_of_Worksheet_Properties.html">the <b>Script</b> tab of the <b>Worksheet Properties</b> dialog</a> can be set to run <b>After Import</b> (this method works with any imported data). This is a good solution for those seeking maximum portability as the script can be saved with a template (.otwu), with the workbook (.ogwu) or project file (opju). See this OriginLab <a class="external text" href="http://blog.originlab.com/worksheet-script-after-data-connector-to-modify-data" target="_blank">blog post</a> for details.</li>
<li> If you are using the older X-Function-based import routines (e.g <a class="external text" href="../../UserGuide/UserGuide/Customizing_the_ASCII_Import_Options.html">impASC</a>), you can add LabTalk script to the <b>Data: Import from File</b> dialogs for ASCII, CSV, SPC or Excel files, with the option of saving your settings as a <a class="external text" href="../../UserGuide/UserGuide/Dialog_Themes.html">dialog Theme</a>.</li>
<li> For most file types, you can  add script to a filter for drag-and-drop import using <a class="external text" href="../../UserGuide/UserGuide/Introduction_to_Import_Filters_Manager.html">the <b>iwfilter</b> dialog box</a>. Using Excel file import as an example, click <b>Preferences: Import Filter Manager...</b>  and select <b>Excel</b> in the <b>Filter</b> column of the <b>Filter Manager</b> dialog. Make sure the <b>Support Drag and Drop</b> checkbox is selected.  Click <b>Edit</b> to open the <b>Import and Export: iwfilter</b> dialog, then type your LabTalk script in the <b>Labtalk Script after Import</b> box under <b>General Import Setting</b>. Click <b>Save As</b> to name and save the filter (.oif file) to the <b>&lt;Origin User File Folder&gt;\Filters</b> folder. To use the import filter, drag-and-drop an Excel file to Origin, A <b>Select Filter</b> dialog will appear. Choose your saved filter and click <b>OK</b>. The LabTalk script in the "Script after ..." box will  be executed automatically on import (see <b>Note1</b> below). Any import filter added by this procedure can also be used when importing via the <b>File: Open</b> dialog or during <a class="external text" href="../../UserGuide/UserGuide/Batch_Processing.html">batch processing</a> import operations (note that the batchProcess dialog itself, offers scripting options).</li>
<li> You can also <a class="external text" href="../../UserGuide/UserGuide/Import_Wizard_Save_Filters_Page_(All_Data_Types).html">save an import filter</a> and add <a class="external text" href="../../UserGuide/UserGuide/Import_Wizard_Advanced_Options_Page.html">post-import scripting with the Import Wizard</a>. While this option will appeal mostly to those importing ASCII files -- particularly files of complex structure -- it can be used when importing binary and other "user-defined" data types.</li></ul>
<p><br />
<b>Note 1</b>:This operation is not applicable to <b>Famos</b>, <b>MDF</b> and <b>pClamp</b> file formats.<br />
<b>Note 2</b>: You can check the <b>Open XF Dialog</b> box under the <b> General Import Setting</b> section in the iwfilter dialog box and open the corresponding import dialog when importing data.
</p>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>LabTalk script, Post-Processing, Import Data, Import Filter, iwfilter, Worksheet Script, Worksheet Properties, Batch Processing</span></p>






