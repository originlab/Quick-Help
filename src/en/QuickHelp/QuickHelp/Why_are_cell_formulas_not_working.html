<h1 class="firstHeading">2.93 FAQ-941 Why are my cell formulas not working?</h1><p class='urlname' style='display: none'>Why-are-cell-formulas-not-working</p>
<p class='faqID'>Last Update: 1/8/2019</p>
<p><br />
Origin 2017 introduced <a class="external text" href="../../UserGuide/UserGuide/Column_Short_Name_Restriction.html">"Spreadsheet Cell Notation" (SCN)</a> for use in column-based calculations in the Set (Column) Values dialog box. Origin 2018 extended use of spreadsheet-like notations to cell formulas (cell-level calculations). 
</p><p>Occasionally, users disable all or part of the cell formula functionality, either via the GUI or LabTalk command and forget that they have done so. Later, they attempt to make use of the cell formulas, then find that they do not work. 
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Spreadsheet_Cell_Notation_Must_be_Enabled_in_the_Workbook"><span class="tocnumber">1</span> <span class="toctext">Spreadsheet Cell Notation Must be Enabled in the Workbook</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Controlling_Cell_Formulas_via_the_GUI_or_LabTalk_Command"><span class="tocnumber">2</span> <span class="toctext">Controlling Cell Formulas via the GUI or LabTalk Command</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Controlling_Cell_Formulas_via_the_GUI"><span class="tocnumber">2.1</span> <span class="toctext">Controlling Cell Formulas via the GUI</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Controlling_Cell_Formulas_via_LabTalk_Command"><span class="tocnumber">2.2</span> <span class="toctext">Controlling Cell Formulas via LabTalk Command</span></a></li>
</ul>
</li>
</ul>
</div>

<h3><a name="Spreadsheet_Cell_Notation_Must_be_Enabled_in_the_Workbook"></a><span class="mw-headline">Spreadsheet Cell Notation Must be Enabled in the Workbook</span></h3>
<ul><li> For cell formula calculations to work, <a class="external text" href="../../UserGuide/UserGuide/Column_Short_Name_Restriction.html">SCN</a> must be turned on in the workbook.</li>
<li> In versions <b>Origin 2017</b> through <b>Origin 2019</b>, SCN is ON by default for new workbooks and this icon <a  class="image"><img alt="Spreadsheet cell notation mode.png" src="../images/Why_are_cell_formulas_not_working/Spreadsheet_cell_notation_mode.png?v=48540" width="20"  /></a> displays in the upper-left corner of the worksheet when SCN is ON. Beginning with Origin <b>2019b</b>, this icon is hidden, though SCN remains ON, by default, for new workbooks.</li>
<li> If you see this icon <a  class="image"><img alt="Button SCN OFF.png" src="../images/Why_are_cell_formulas_not_working/Button_SCN_OFF.png?v=57832" width="22"  /></a> in the upper-left corner of the workbook (<i>ANY</i> version), right-click on the workbook title bar and choose <b>Properties</b>. On the <b>Properties</b> tab, check the <b>Spreadsheet Cell Notation</b> box and click <b>OK</b>.</li>
<li> Spreadsheet Cell Notation can be turned on in any book or project, even those that were created before Origin 2017. Right-click on the workbook title bar and choose <b>Properties</b>. On the <b>Properties</b> tab, check the <b>Spreadsheet Cell Notation</b> box and click <b>OK</b>. </li></ul>
<p><br />
Note that there are LabTalk (script) methods for disabling spreadsheet cell notation for a single book and for disabling it for every existing book in the project, including new books. These are covered in <a href="../../QuickHelp/QuickHelp/Turn_off_spreadsheet_cell_notation.html" title="QuickHelp:Turn off spreadsheet cell notation"><b>FAQ-849</b> Can I turn off or selectively control use of spreadsheet cell notation in my workbooks?</a>
</p>
<h3><a name="Controlling_Cell_Formulas_via_the_GUI_or_LabTalk_Command"></a><span class="mw-headline">Controlling Cell Formulas via the GUI or LabTalk Command</span></h3>
<p>There are several ways to partially or totally disable cell formulas in the Origin project (see <a href="../../QuickHelp/QuickHelp/Turn_off_cell_formula.html" title="QuickHelp:Turn off cell formula">FAQ-939</a> for details).
</p>
<h4><a name="Controlling_Cell_Formulas_via_the_GUI"></a><span class="mw-headline">Controlling Cell Formulas via the GUI</span></h4>
<p>Make sure that <b>Edit Mode</b> is not simply enabled:
</p>
<ol><li>From the menu, choose <b>Edit: Edit Mode</b>.</li>
<li>If there is a check mark beside <b>Edit Mode</b>, click the menu item to clear it.</li></ol>
<dl><dd><dl><dd><a  class="image"><img alt="Edit menu edit mode enabled.png" src="../images/Why_are_cell_formulas_not_working/Edit_menu_edit_mode_enabled.png?v=56648" width="208"  /></a></dd></dl></dd></dl>
<h4><a name="Controlling_Cell_Formulas_via_LabTalk_Command"></a><span class="mw-headline">Controlling Cell Formulas via LabTalk Command</span></h4>
<p>Make sure that LabTalk System Variable <code>@ESC = 1</code>. If <code>@ESC=0</code>, cell formulas (e.g. "=A1+B1") will be treated as simple text and expressions will not resolve. This will happen even if the workbook window's <b>Spreadsheet Cell Notation</b> box is checked and Origin's <b>Edit Mode</b> is turned off. 
</p>
<ol>
<li>Choose <b>Window: Script Window</b>, type the following and press Enter:</li>
<pre class="lt" style="font-family:monospace;">@esc<span style="color: #000080;">=</span></pre>
<li>If Origin returns a value of 0 (@esc=0), then type the following and press Enter:</li>
<pre class="lt" style="font-family:monospace;">@esc<span style="color: #000080;">=</span><span style="color: #0000dd;">1</span></pre>
</ol>
<p><br />
Also, if <code>@ESC</code> returns a value of 0, check <a href="../../QuickHelp/QuickHelp/How_do_I_permanently_change_the_value_of_a_system_variable.html" title="QuickHelp:How do I permanently change the value of a system variable">the <b>Set System Variables</b> dialog</a> to see if you have an "ESC" entry that is set to 0:
</p>
<ol><li> From the menu, choose <b>Preferences: System Variables</b> to open the Set System Variables dialog box.</li></ol>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>calculation, spreadsheet, @RCN, @ESC, page.xlcolname, ClrX</span></p>






