<h1 class="firstHeading">4.58 FAQ-810 How to create a waterfall graph from Origin C?</h1><p class='urlname' style='display: none'>waterfall-by-OC</p>
<p class='faqID'>Last Update: 1/4/2016</p>
<p>Please refer to the following example code:
</p>
<pre class="oc" style="font-family:monospace;"><span style="color: #008000;">//The function below is to plot a waterfall</span>
<span style="color: #008000;">//When bYColMap = TRUE, it will plot a waterfall color map to Y. </span>
<span style="color: #008000;">// When bYColMap = FALSE, it will plot a waterfall color map to Z. </span>

<span style="color: #0000ff;">void</span> plot_waterfall<span style="color: #000000;">&#40;</span><span style="color: #0000ff;">BOOL</span> bYColMap <span style="color: #000080;">=</span> <span style="color: #0000ff;">TRUE</span>, <span style="color: #0000ff;">int</span> nEndYCol <span style="color: #000080;">=</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	Worksheet wks <span style="color: #000080;">=</span> Project.<span style="color: #000000;">ActiveLayer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #000040;">!</span>wks <span style="color: #000000;">&#41;</span>
		<span style="color: #0000ff;">return</span>;	
	
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> nEndYCol <span style="color: #000080;">&lt;</span> <span style="color: #0000dd;">0</span> <span style="color: #000000;">&#41;</span> <span style="color: #008000;">// -1 means to the end column</span>
		nEndYCol <span style="color: #000080;">=</span> wks.<span style="color: #000000;">GetNumCols</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000040;">-</span> <span style="color: #0000dd;">1</span>;	
	
	<span style="color: #008000;">// create a graph window</span>
	GraphPage gp;
	gp.<span style="color: #000000;">Create</span><span style="color: #000000;">&#40;</span><span style="color: #ff00ff;">&quot;Waterfal&quot;</span><span style="color: #000000;">&#41;</span>;
	GraphLayer gl <span style="color: #000080;">=</span> gp.<span style="color: #000000;">Layers</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// get the first layer	</span>
	
	<span style="color: #008000;">// prepare DataRange</span>
	DataRange dr;
	dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>wks, <span style="color: #0000dd;">0</span>, <span style="color: #ff00ff;">&quot;X&quot;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// col(1): x column	</span>
	<span style="color: #0000ff;">for</span><span style="color: #000000;">&#40;</span><span style="color: #0000ff;">int</span> nYCol <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span>; nYCol <span style="color: #000080;">&lt;=</span> nEndYCol; nYCol<span style="color: #000040;">++</span><span style="color: #000000;">&#41;</span>		
		dr.<span style="color: #000000;">Add</span><span style="color: #000000;">&#40;</span>wks, nYCol, <span style="color: #ff00ff;">&quot;Y&quot;</span><span style="color: #000000;">&#41;</span>; <span style="color: #008000;">// add y columns into dr DataRange		</span>
	
	<span style="color: #008000;">// do plot</span>
	gl.<span style="color: #000000;">AddPlot</span><span style="color: #000000;">&#40;</span>dr, IDM_PLOT_LINE<span style="color: #000000;">&#41;</span>;	
	
	<span style="color: #008000;">// set colormap	</span>
	GroupPlot group;
	group <span style="color: #000080;">=</span> gl.<span style="color: #000000;">Groups</span><span style="color: #000000;">&#40;</span><span style="color: #0000dd;">0</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> group <span style="color: #000000;">&#41;</span>
	<span style="color: #000000;">&#123;</span>
		Tree tr;		
		tr.<span style="color: #000000;">Line</span>.<span style="color: #000000;">Color</span>.<span style="color: #000000;">nVal</span> <span style="color: #000080;">=</span> bYColMap&#160;? 0x60FFFF <span style="color: #000000;">:</span> 0x500000 <span style="color: #000040;">|</span> <span style="color: #000000;">&#40;</span> ModifyColBeg <span style="color: #000040;">+</span> <span style="color: #0000dd;">1</span> <span style="color: #000000;">&#41;</span>;
	
		<span style="color: #0000ff;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #0000dd;">0</span> <span style="color: #000080;">==</span> group.<span style="color: #000000;">UpdateThemeIDs</span><span style="color: #000000;">&#40;</span>tr<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>
			group.<span style="color: #000000;">ApplyFormat</span><span style="color: #000000;">&#40;</span>tr, <span style="color: #0000ff;">true</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #000000;">&#125;</span>
	
	gl.<span style="color: #000000;">Rescale</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre>
<p><br />
</p>
<hr class='keywordshr'><p><span class='keywords'>Keywords:</span><span class='keywordsInput'>waterfall, Origin C</span></p>






